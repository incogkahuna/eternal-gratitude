(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[93818],{2112:e=>{e.exports=function(){}},8760:(e,t,r)=>{var n=r(52990),o=r(15857),s=r(88218),i=r(60911),a=r(54052),l=r(90402);e.exports=function(e){return o(function(t){var r=t.length,o=r,c=n.prototype.thru;for(e&&t.reverse();o--;){var p=t[o];if("function"!=typeof p)throw new TypeError("Expected a function");if(c&&!d&&"wrapper"==i(p))var d=new n([],!0)}for(o=d?o:r;++o<r;){p=t[o];var u=i(p),h="wrapper"==u?s(p):void 0;d=h&&l(h[0])&&424==h[1]&&!h[4].length&&1==h[9]?d[i(h[0])].apply(d,h[3]):1==p.length&&l(p)?d[u]():d.thru(p)}return function(){var e=arguments,n=e[0];if(d&&1==e.length&&a(n))return d.plant(n).value();for(var o=0,s=r?t[o].apply(this,e):n;++o<r;)s=t[o].call(this,s);return s}})}},14115:(e,t,r)=>{"use strict";r.d(t,{D:()=>n});const n="Archived for plan conversion"},15857:(e,t,r)=>{var n=r(20819),o=r(55636),s=r(46350);e.exports=function(e){return s(o(e,void 0,n),e+"")}},16841:(e,t,r)=>{"use strict";r.r(t),r.d(t,{PlanTaskBoardPage:()=>Op});var n,o,s,i,a,l,c=r(78332),p=r(5099),d=r(64327),u=r(45795),h=r(96891),g=r(38629),m=r(96481);!function(e){e.MyDayNavButton="MyDayNavButton",e.MyDayTaskSuggestionsButton="MyDayTaskSuggestionsButton",e.MyTasksNavButton="MyTasksNavButton",e.MyTasksAllPivot="MyTasksAllPivot",e.MyPlansNavButton="MyPlansNavButton",e.MyPlansRecentPivot="MyPlansRecentPivot",e.MyPortfoliosNavButton="MyPortfoliosNavButton",e.MyPlansNewPlanButton="MyPlansNewPlanButton",e.LeftNavNewPlanButton="LeftNavNewPlanButton",e.BasicPlanGridViewPivot="BasicPlanGridViewPivot",e.BasicPlanBoardViewPivot="BasicPlanBoardViewPivot",e.BasicPlanScheduleViewPivot="BasicPlanScheduleViewPivot",e.BasicPlanChartsViewPivot="BasicPlanChartsViewPivot",e.BasicPlanGridViewSecondColumn="BasicPlanGridViewSecondColumn",e.BasicPlanShareButton="BasicPlanShareButton",e.BasicPlanMoreOptions="BasicPlanMoreOptions",e.BasicPlanFilters="BasicPlanFilters",e.MyTasksFilters="MyTasksFilters",e.BasicTaskDetailsMoreOptions="BasicTaskDetailsMoreOptions",e.BasicTaskDetailsStartDateCalendarIcon="BasicTaskDetailsStartDateCalendarIcon",e.PremiumPlanBoardViewPivot="premiumPlanBoardViewPivot",e.CopilotButton="CopilotButton",e.BottomRight="BottomRight",e.PlanShareButton="PlanShareButton",e.GsdHomeGoalsSection="GsdHomeGoalsSection",e.GsdHomeResourcesSection="GsdHomeResourcesSection"}(n||(n={})),function(e){e.PlannerExternal="88001031",e.PlannerSelfhostInternal="88001030"}(o||(o={})),function(e){e.MyDayOpen="MyDayOpen",e.MyTasksOpen="MyTasksOpen",e.MyPlansOpen="MyPlansOpen",e.BasicPlanViewOpen="BasicPlanViewOpen",e.BasicGridViewOpen="BasicGridViewOpen",e.BasicBoardViewOpen="BasicBoardViewOpen",e.BasicScheduleViewOpen="BasicScheduleViewOpen",e.BasicChartsViewOpen="BasicChartsViewOpen",e.PremiumGridViewOpen="PremiumGridViewOpen",e.PremiumBoardViewOpen="PremiumBoardViewOpen",e.PremiumChartsViewOpen="PremiumChartsViewOpen",e.PremiumGsdHomeViewOpen="PremiumGsdHomeViewOpen",e.PremiumGsdBoardViewOpen="PremiumGsdBoardViewOpen",e.PremiumGoalsViewOpen="PremiumGoalsViewOpen",e.PremiumTimelineViewOpen="PremiumTimelineViewOpen",e.PlanViewOpen="PlanViewOpen"}(s||(s={})),function(e){e.LinkRedirect="LinkRedirect",e.Trial="Trial",e.RequestFlow="RequestFlow",e.Dismiss="Dismiss",e.NextStep="NextStep"}(i||(i={})),function(e){e.IsRequestFlowEligible="IsRequestFlowEligible",e.IsTrialEligible="IsTrialEligible",e.IsNotEligible="IsNotEligible",e.HasPremiumTrial="HasPremiumTrial",e.HasPremiumPaid="HasPremiumPaid"}(a||(a={})),function(e){e.Dismiss="dismiss",e.Click="click",e.Conversion="conversion"}(l||(l={}));var C=r(5586),k=r(81206),b=r(91834);const T=[c.Yc.Bucket,c.Yc.Assignee,c.Yc.Progress,c.Yc.DueDate,c.Yc.Category,c.Yc.Priority];c.Yc.Plan,c.Yc.Progress,c.Yc.DueDate,c.Yc.Priority,c.Yc.Plan,c.Yc.Bucket,c.Yc.Assignee,c.Yc.Progress,c.Yc.DueDate,c.Yc.Priority,c.Yc.Plan,c.Yc.Progress,c.Yc.DueDate,c.Yc.Priority;var S,P,x,y,f,v,A,w,D,B=r(74844);!function(e){e.Dev="dev",e.PreProd="ppe",e.Demo="demo",e.DogfoodDev="dogfood-dev",e.DogfoodStaging="dogfood-staging",e.DogfoodAll="dogfood-all",e.ProdMSIT="production-msit",e.ProdBetaTAP="production-beta-tap",e.ProdAll="production-all",e.Gcc="gcc",e.Gcch="gcch",e.DoD="dod",e.AirGap="krp"}(S||(S={})),function(e){e.PlannerMobile="66375f6b-983f-4c2c-9701-d680650f588f",e.PlannerWeb="09abbdfd-ed23-44ee-a2d9-a627aa1c90f3",e.MSTeamsWeb="5e3ce6c0-2b1f-4285-8d4b-75ee78787346",e.MSTeamsDesktop="1fec8e78-bce4-4aaf-ab1b-5451cc387264",e.MicrosoftTeamsRetailService="75efb5bc-18a1-4e7b-8a66-2ad2503d79c6",e.MicrosoftPlannerClient="75f31797-37c9-498e-8dc9-53c16a36afca",e.DeprecatedSharepoint="00000003-0000-0ff1-ce00-000000000000",e.Sharepoint="08e18876-6177-487e-b8b5-cf950c1e598c",e.ProjectReplicationService="e62ee429-f250-4aef-a588-7b511fa9a67a",e.CentroService="00000006-0000-0ff1-ce00-000000000000",e.ToDo="5754bb84-f388-44f0-b3f7-9233a05bbb34",e.ApprovalApp="7c316234-ded0-4f95-8a83-8453d0876592"}(P||(P={})),function(e){e.Teams="Teams",e.Web="Web",e.Sharepoint="Sharepoint",e.Loop="Loop",e.Dynamics="Dynamics"}(x||(x={})),function(e){e.App="App",e.Tab="Tab",e.ConfigTab="ConfigTab",e.RemoveTab="RemoveTab",e.TaskFromMessage="TaskFromMessage",e.Component="Component"}(y||(y={})),function(e){e.Ppe="Ppe",e.Prod="Prod",e.Gcc="Gcc",e.Gcch="Gcch",e.Dod="Dod",e.Agc="Agc"}(f||(f={})),function(e){e.Eu="EU",e.Row="ROW"}(v||(v={})),function(e){e.SPWeb="SPWeb"}(A||(A={})),function(e){e.Board="Board"}(w||(w={})),function(e){e.Chrome="Chrome",e.Edge="Edge",e.Firefox="Firefox",e.IE="IE",e.Opera="Opera",e.Other="Other",e.Safari="Safari",e.Electron="Electron"}(D||(D={}));var E,I;!function(e){e[e.None=0]="None",e[e.CannotDeleteTasksNotCreatedBySelf=1]="CannotDeleteTasksNotCreatedBySelf"}(E||(E={})),function(e){e.delayOnRetryInMiliseconds=200,e.maxRetryTimeoutInMiliseconds=18e4,e.maxRetryCount=2}(I||(I={}));var F;!function(e){e.Basic="Basic",e.Premium="Premium",e.ToDo="ToDo"}(F||(F={}));class M{}M.RtlCultures=["ar","he","ur","ku","fa"],M.MomentCultures=["ar","ar-ly","ar-ma","ar-sa","ar-tn","bg","ca","cs","cy","da","de","de-at","el","en","en-au","en-ca","en-gb","en-ie","en-in","en-nz","es","es-do","et","eu","fi","fil","fr","fr-ca","fr-ch","gl","he","hi","hr","hu","id","is","it","ja","ka","kk","ko","lt","lv","ml","ms-my","nb","nl","nn","no","pl","pt","pt-br","ro","ru","sr-cyrl","sr","sk","sl","sv","th","tr","uk","vi","zh-cn","zh-hk","zh-tw"],M.DefaultMomentCulture="en";class L{}var N;L.sensitivityLabels="https://go.microsoft.com/fwlink?linkid=2106748",L.linkedPlans="https://aka.ms/linkedplans",L.lightWeightPlans="https://aka.ms/lightweightplans",L.m365Groups="https://go.microsoft.com/fwlink?linkid=2049051",L.guestAccess="https://go.microsoft.com/fwlink?linkid=871797",L.emailAndNotifications="https://go.microsoft.com/fwlink?linkid=866998",L.copyAndMoveTasks="https://go.microsoft.com/fwlink?linkid=872349",L.getStartedWithProjectForTheWeb="https://support.microsoft.com/office/get-started-with-project-for-the-web-50bf3e29-0f0d-4b7a-9d2c-7c78389b67ad",L.ieDeprecated="https://techcommunity.microsoft.com/t5/microsoft-365-blog/microsoft-365-apps-say-farewell-to-internet-explorer-11-and/ba-p/1591666",L.sharedPlans="https://go.microsoft.com/fwlink?linkid=2228058",L.missingFields="https://go.microsoft.com/fwlink/?linkid=2245039",L.addFormsRequirement="https://go.microsoft.com/fwlink/?linkid=2245040",L.usePlannerComponent="https://go.microsoft.com/fwlink/?linkid=2245448",L.projectP1SubscriptionPlanLearnMoreUrl="https://go.microsoft.com/fwlink/?linkid=2183548",L.projectP3SubscriptionPlanLearnMoreUrl="https://go.microsoft.com/fwlink/?linkid=2183549",L.projectP5SubscriptionPlanLearnMoreUrl="https://go.microsoft.com/fwlink/?linkid=2183649",L.projectLearnMoreUrl="https://go.microsoft.com/fwlink/?linkid=2261209",L.importPlanLearnMoreUrl="https://go.microsoft.com/fwlink/?linkid=2226056",L.plannerHelp="https://go.microsoft.com/fwlink/?linkid=2260017",L.licenseTerms="https://www.microsoft.com/servicesagreement",L.privacyStatement="https://privacy.microsoft.com/privacystatement",L.joinGroupAsMember="https://go.microsoft.com/fwlink/?linkid=2264502",L.trialTermsOfServiceUrl="https://go.microsoft.com/fwlink?linkid=2204238",L.fre="https://go.microsoft.com/fwlink/?linkid=2283523",L.sensitivityLabelsAndMicrosoft365Copilot="https://learn.microsoft.com/en-us/purview/sensitivity-labels#sensitivity-labels-and-microsoft-365-copilot",function(e){e.Dev="3434be72-1bba-427b-83ca-43daf2ee0d22",e.PPE="9c0fcd8d-7cca-466f-b549-9254dac9c036",e.Prod="com.microsoft.teamspace.tab.planner"}(N||(N={}));new Map([["Agc",[S.AirGap]],["Dod",[S.DoD]],["Gcc",[S.Gcc]],["Gcch",[S.Gcch]],["Ppe",[S.PreProd]],["Prod",[S.Demo,S.Dev,S.DogfoodDev,S.DogfoodStaging,S.DogfoodAll,S.ProdMSIT,S.ProdBetaTAP,S.ProdAll]]]);var R;!function(e){e.AppId=2204}(R||(R={}));var U=r(14115),O=r(45785);const H=r.p+"static/media/person-circle-dismiss-dark.ecaa4be43607c724d663.png",V=r.p+"static/media/person-circle-dismiss-light.9cba0563e2a78a02990c.png",G=r.p+"static/media/searchExclamDark.7df65dbbeef20727f66b.png",W=r.p+"static/media/searchExclamLight.dea5c5a45aaf17d877e4.png";var _=r(65043),z=r(49634),Z=r(9442),K=r(63485),q=r(11638),j=r(66783),Q=r(52195),Y=r(83108);const J="170px",X=(0,j.J9)((e,t)=>{const r={root:[(0,Y.gS)("row"),Y.cc,{height:"100%",width:"100%"}],elementContainer:[(0,Y.gS)("column"),Y.cc,{padding:"10px",maxWidth:"500px","> *":{textAlign:"center"}}],errorImage:{paddingBottom:"8px","> img":{height:"192px",width:"192px"}},errorText:{fontSize:Q.s.size16,paddingBottom:"8px",fontWeight:Q.BO.semibold},errorSubText:{fontSize:Q.s.size14,paddingBottom:"24px"},buttonContainer:[(0,Y.gS)("column"),Y.cc,{paddingBottom:"16px"}],primaryButton:{marginBottom:"8px",width:J},secondaryButton:{width:J},errorLinkSection:{paddingBottom:"24px",fontSize:Q.s.size12}};return(0,Q.TW)(r,t)}),$=(0,j.J9)(e=>({root:(0,Q.Zq)("errorView",e.root),elementContainer:(0,Q.Zq)("elementContainer",e.elementContainer),errorImage:(0,Q.Zq)("errorImage",e.errorImage),errorText:(0,Q.Zq)("errorText",e.errorText),errorSubText:(0,Q.Zq)("errorSubText",e.errorSubText),buttonContainer:(0,Q.Zq)("buttonContainer",e.buttonContainer),primaryButton:(0,Q.Zq)("primaryErrorButton",e.primaryButton),secondaryButton:(0,Q.Zq)("secondaryErrorButton",e.secondaryButton),errorLinkSection:(0,Q.Zq)("errorLinkSection",e.errorLinkSection)}));var ee=r(52861);function te(e){switch(e.name){case ee.w.TeamsLight:return!0;case ee.w.TeamsDark:case ee.w.TeamsContrast:default:return!1}}function re(e){let{errorText:t,errorSubText:r,imageLight:n,imageDark:o,primaryButtonProps:s,secondaryButtonProps:i,errorLinkDetails:a}=e;const l=(0,z.D)(),c=$(X(l)),[p,d]=_.useState(!1),u=a?_.createElement("div",{className:c.errorLinkSection},p?_.createElement("span",{className:"error-view-details-message"},a.message):_.createElement(Z.N,{className:"error-view-details-link",onClick:()=>{d(!0)}},a.linkText)):void 0;return _.createElement("div",{className:c.root},_.createElement("div",{className:c.elementContainer},_.createElement("div",{className:c.errorImage},_.createElement("img",{src:te(l)?n:o,alt:"",role:"presentation"})),_.createElement("div",{className:c.errorText,"aria-live":"assertive"},t),_.createElement("div",{className:c.errorSubText,"aria-live":"assertive"},r),u,_.createElement("div",{className:c.buttonContainer},!!s&&_.createElement(K.j,{className:c.primaryButton,onClick:s.onClick},s.label),!!i&&_.createElement(q.Y,{className:c.secondaryButton,onClick:i.onClick},i.label))))}function ne(e){let{strings:t,isTeamsTabView:r,isMyPlansPlan:n,planStatus:o,removeFromMyPlansButtonCallback:s,navigateToMyPlansButtonCallback:i}=e;const{planNotFoundText:a,planNotFoundBody:l,planNotFoundBodyTab:c,planInaccessibleText:p,planInaccessibleBody:d,planGenericErrorText:u,planGenericErrorBody:h,navigateToMyPlansButtonText:g,removeFromMyPlansButtonText:m}=t;let C,k,b,T,S=!1;const P=!r;switch(o){case O.Z.NotFound:b=a,T=r?c:l,S=n&&!r,k="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMAAAADACAMAAABlApw1AAADAFBMVEVHcEy+vLu+vbu9vLy9vLvBwb+9vLvNxbvIw77Hwr28vLu8vLy+vbu/vbu7u7q/vby8vLu/vr28vLy1tbW1tLW/vbypqqvz8vC+vbyeoKHe2tf+/f3GxcXCvbu+vLvLw7zCv7yjpKX49vXPx8Lu6+jr6ObCvbv39fPi3dvh3NrDvbv7+/rw7Or8+/vs6ebY1dLDv7zCvrzEwL3w7er9/f308e/EwLytq6vv7OrRxr3Cvrurqqrj3dvDv73m3dvg1c6qqqvOtqC3tbP/ekjy8O//d0n08vHs5+Xq5ePw7ez/ekvt6ujo4+Dn4d3v7Onx7+2933W63nHl3Nft6+srweP39fSXiGHq4t3s5eA2xeTk3trg19JByOTXzsnh2tfl2dPdzcXTycPi0cjc0sv/d0fPxL3k1s2SgmHYxrjcyb//f0mYiG/p3NPc1M/Tw7D/c0vs39jLv7e122zHubHCvr2XiGjH5YDC4Xnw6uOjlI65p5uRgnOVhn35mDq7q6K/sKf+hUXUw6ajmZ2um5Gfj4KVkpv/bEjJqqHMsqvfyLixdWXDtqxL0OrWvLOt2WSi1Vj/pG/z7eejfmy4f2/Ou6X/gVOWi42wo56Vd13V7pn6+vrx2NDLtZu7tbT5qD25oYO8kIN/fojN6IoAyumOyk2inqrDmY2GfHbTMBOyq6y8pY/8jD7/jVju5tq95Wz/jEzRx8zVz6zEn5gBn9CmbF6uiXqrln7CiHgdsuHOhWv/tYmEiGhvrTPby9fEsZCEfmn7Yz4AksWHipjri0D6m03wyr9/jQLNp5DkdCXuu6n6rVQAv+GCwzjJdWHd86zjopOrrrnNEgNVjBr/fR/rSTXm2+d/YWR4dHj4l1mbX0v1yVmlkmrcsKWJbE5XsQh9WyTM15ZwlrB6TE3cjX2Wydv7fD7yewV8hTrGtb8z0fBVKiZOjrK+Z1PSYkPB0NnwjBPxSgMhlBLESxcRGBJoyeSswHURy+m5usf8yXmRLykiZY5rts1bYziesZD/ZiRHcEx8GqIcAAABAHRSTlMAKxc2DgolAgQHE0sgG0QvYT17T6FWXtttKk0Q/qiI8ZE9MffDrZ4/c42xF+smm2O8x/bUIFvqeHvi3pHB0tyyoany//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A5wB15QAAIABJREFUeNrsmF1IW2kax4/RmMQYbSxSa611jTYdo9aPKlpqyy6hUXISIe42Nmmi2RBj0UhCEtBEEiZRppLeTBHjRSQjIsVAQXZoGChTwRsveuPN6EUpZUsv6izM1TCF9maf533PidoKO4xutrL55xirqfr8zv/5esMwOeWUU0455ZRTTjnllFNOX7AkohxATjnl9H8pEdGpDj6jU37rTxnD0eGeGoRM+E1ddY3fotqblacIgQu/oPnbQ6pT0hdPQ/y4vNSTqPWTnPCLRuVpIKDxX4F4IexBIiM+EYi6L5+Axl83SaM3Gt2GcYPB4HYbjZSh9gsnIPFLGiFUDYRvMAyN2O3Dw8P2kaFxN0Xo+KIJSPyiQXL7jSaD2T58f3QCNXp/eGTIbXzypROIxPDUSO6+zjBkHx6dmE88f55KpZ7PT9z/+8i4+wnAZT+LfvcUFSFAPalbHdz++xOJVDKZ2koktlLJVAIQgODJk0l06X+00fyO+Ctp/KYh+2gimU7FvF6P1zM/n0gmnwPB0DgQ1GXTAohazOs/QOD/ZBgoVZaF+F2jgacBj00BcsA1Mb+VTHEEk5VZtADDl6AOQRzBIaLxdxmNrBETaDgQ9SoUl1Cd8KFQcAQki7JnAUQFwQtBByDEn6cVNUrCMDojSAcA3pRH4cHw2xChGxCAIDExjJX8JGsWYPxCYQGIQ8gwfEZC4680gQMsANhDHsWlnpaLoJYesKC7GwiSyflR0ovaswRA4sfwub8m4hg+waCCVxjRDYMOACCF7N7uhuqK8nJpefmZipqG64BwSZFIbk3cHxmHMpBkCYDEXyT5/H0myWd2YKYxzBACDLJGg72lQirPJ5LLpWeqW7ovdSsmkqn5OWJBR1YsoAZA/LXn1Gr9ubrmK0rVERxc+JBrjBwBsI0abpWU5uXllaLyS/PlJWcuI0ECcohUQX12AEj8BUyl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",C="data:image/png;base64,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";break;case O.Z.Inaccessible:b=p,T=d,S=n&&!r,k=V,C=H;break;case O.Z.UnableToFetch:default:b=u,T=r||o===O.Z.UnableToFetch?"":h,k=W,C=G}let x,y;return S?(x={label:m,onClick:s},y={label:g,onClick:i}):P&&(x={label:g,onClick:i}),_.createElement(re,{imageDark:C,imageLight:k,errorText:b,errorSubText:T,primaryButtonProps:x,secondaryButtonProps:y})}var oe,se,ie,ae=r(38752),le=r(77508),ce=r(16112),pe=r(65818),de=r(44430),ue=r(76241),he=r(54320),ge=r.n(he),me=r(30210);function Ce(e,t){return e>-1&&0!==(e&t)}function ke(e,t){return e>-1&&0!==(e&t)}!function(e){e[e.EnableNone=0]="EnableNone",e[e.EnableYammer=1]="EnableYammer",e[e.EnableConversations=2]="EnableConversations",e[e.EnableMembers=4]="EnableMembers",e[e.EnableFiles=8]="EnableFiles",e[e.EnableNotebook=16]="EnableNotebook",e[e.EnableSites=32]="EnableSites",e[e.EnableAll=63]="EnableAll"}(oe||(oe={})),function(e){e[e.EnableNone=0]="EnableNone",e[e.EnableFavorite=1]="EnableFavorite",e[e.EnableCopy=2]="EnableCopy",e[e.EnableExport=4]="EnableExport",e[e.EnableCopyLink=8]="EnableCopyLink",e[e.EnableSettings=16]="EnableSettings",e[e.EnableCalendar=32]="EnableCalendar",e[e.EnableLeave=64]="EnableLeave",e[e.EnableJoin=128]="EnableJoin",e[e.EnableAll=255]="EnableAll"}(se||(se={})),function(e){e.getLinksCapabilitiesForContainer=function(e){return null==e?0:e.containerType===pe.K.Group?function(e){const t=e.unifiedGroupDetails;if(null==t)return 0;let r=56;t.isYammerGroup()?r|=1:ae.B.isGuestUser||(r|=6);return r}(e):0},e.getLinksCapabilitiesForPlan=function(e,t,r,n){let o=pe.K.Invalid;switch(null!=e?o=e.containerType:n&&(o=r),o){case pe.K.Group:return function(e){if(e.unifiedGroupDetails?.currentUserRelationToGroup===de.N.NonMember)return e.unifiedGroup.visibility===ue.X.Public?128:0;let t=30;e.unifiedGroupDetails&&!e.unifiedGroupDetails.isYammerGroup()&&(t|=1);const r=(e.unifiedGroupDetails?.owners&&e.unifiedGroupDetails.owners.length>1)??!1;(e.unifiedGroupDetails&&e.unifiedGroupDetails.currentUserRelationToGroup!==de.N.Owner||r)&&(t|=64);e.unifiedGroupDetails?.currentUserRelationToGroup!==de.N.Owner&&e.unifiedGroupDetails?.currentUserRelationToGroup!==de.N.Member||(t|=32);return t}(e);case pe.K.DriveItem:return 63;case pe.K.User:return 29;case pe.K.Roster:return function(e){let t=61;e>1&&(t|=64);return t}(t);default:return 0}},e.getContextLinkMenuItemForPlan=function(e,t,r,n,o){if(!ge()(t.contextDetails)){const s=(0,me.g)(e.contexts,r),i=ge()(s)?null:t.contextDetails[s];if(null!=i&&!ge()(i.url))return{key:s,name:n,href:i.url,target:"_blank",onClick:o}}return null}}(ie||(ie={}));var be,Te=r(22514);!function(e){e[e.DisableAll=0]="DisableAll",e[e.DisableNothing=1]="DisableNothing",e[e.DisablePlanChanges=2]="DisablePlanChanges"}(be||(be={}));class Se extends ce.${componentDidMount(){this.logFloodgateActivity(),this.logSharedContainersTelemetryOnPlanLoad()}componentDidUpdate(e){this.props.plan?.id!==e.plan?.id&&(this.isSharedContainersTelemetryLogged=!1,this.isMembersListOpenedLogged=!1,this.shouldLogMembersListOpened=!1),e.sharedContainersListProps!==this.props.sharedContainersListProps&&(this.logSharedContainersTelemetryOnPlanLoad(),this.logSharedContainersTelemetryOnMemberListOpen())}logFloodgateActivity(){const{disableMode:e,flights:t,hasAccessViaSharedContainer:r,plan:n,planContainer:o,planMembers:s}=this.props;ae.B.clientType!==u.s.Plex||ae.B.isUnoContext||Te.q.logFloodgateActivity(h.M.ProgressFilterActivity,this.context.traceLogger),ae.B.clientType===u.s.Plex&&!ae.B.isUnoContext&&t?.EnableImageRecommendations&&1===e&&n&&ke(ie.getLinksCapabilitiesForPlan(o??null,s.length,n.container.containerType,r??!1),se.EnableSettings)&&Te.q.logFloodgateActivity(h.M.SmartBackgroundActivity,this.context.traceLogger)}constructor(){super(...arguments),this.isSharedContainersTelemetryLogged=!1,this.isMembersListOpenedLogged=!1,this.shouldLogMembersListOpened=!1,this.headerMoreOptionsButtonRef=_.createRef(),this.openPlanSettingsPanel=(e,t)=>{this.props.callbacks.openPlanSettingsPanel?.(e,t)},this.openLeavePlanDialog=e=>{this.props.callbacks.openLeavePlanDialog?.(e)},this.onOpenMembersCallout=()=>{this.shouldLogMembersListOpened=!0,this.logSharedContainersTelemetryOnMemberListOpen()},this.logSharedContainersTelemetryOnMemberListOpen=()=>{!this.isMembersListOpenedLogged&&this.shouldLogMembersListOpened&&this.isSharedContainersListPropsLoaded()&&(this.isMembersListOpenedLogged=!0,this.context.usageLogger.logData(this.name(),h.M.MembersListOpenedWithSharedContainers,this.getSharedContainerTelemetryExtraData()))},this.logSharedContainersTelemetryOnPlanLoad=()=>{!this.isSharedContainersTelemetryLogged&&this.isSharedContainersListPropsLoaded()&&(this.isSharedContainersTelemetryLogged=!0,this.context.usageLogger.logData(this.name(),h.M.PlanLoadedWithSharedContainers,this.getSharedContainerTelemetryExtraData()))},this.isSharedContainersListPropsLoaded=()=>{const{plan:e,sharedContainersListProps:t}=this.props;return null!=t&&null!=e&&e.sharedWithContainers.length===t.sharedContainerItems.length+t.inaccessibleSharedContainerCount},this.getSharedContainerTelemetryExtraData=()=>{const{plan:e,sharedContainersListProps:t}=this.props;if(null==t||null==e)return;const r={planId:e.id};return t.inaccessibleSharedContainerCount>0&&(r.hasInaccessibleSharedContainers="true"),r}}}var Pe=r(53356),xe=r(20751),ye=r(33631),fe=r(77711),ve=r(52342),Ae=r(40520),we=r(54845),De=r(37535),Be=r(75104),Ee=r(86053);class Ie extends ce.${name(){return"WorkloadProvisioningDialog"}renderComponent(){let e="";switch(this.props.workloadName){case De.P[De.P.Conversations]:e=Ee.p.Strings.WorkloadProvisioningDialog_MissingWorkloadConversationsError;break;case De.P[De.P.People]:e=Ee.p.Strings.WorkloadProvisioningDialog_MissingWorkloadPeopleError;break;case De.P[De.P.Documents]:e=Ee.p.Strings.WorkloadProvisioningDialog_MissingWorkloadFileStorageError;break;case De.P[De.P.Notebook]:e=Ee.p.Strings.WorkloadProvisioningDialog_MissingWorkloadNotebookError;break;case De.P[De.P.Yammer]:e=Ee.p.Strings.WorkloadProvisioningDialog_MissingWorkloadYammerError;break;default:return null}return _.createElement(ve.l,{hidden:!1,onDismiss:this.props.onDismiss,dialogContentProps:{className:this.props.dialogContentClassName,type:Ae.h.normal,styles:(0,Be.XK)(this.props.theme)},styles:(0,Be.S9)(this.props.theme),modalProps:{className:this.props.dialogClassName,containerClassName:this.props.dialogContainerClassName,isBlocking:!1}},e,_.createElement(we.E,null,_.createElement(K.j,{onClick:this.props.onDismiss},Ee.p.Strings.WorkloadProvisioningDialog_MissingWorkloadErrorOkBtn)))}constructor(e,t){super(e,t),this.state={}}}var Fe=r(50724),Me=r(50605),Le=r(66151),Ne=r(56415),Re=r(8736),Ue=r(72943);const Oe="38px",He=(0,j.J9)((e,t,r)=>{const n=[(0,Le.gS)("column","nowrap"),(0,Le.aS)(e),(0,Ue.zI)(),{padding:`${Re.B.TopHeaderPaddingTop} ${Re.B.TopHeaderHorizontalPadding} ${Re.B.TopHeaderPaddingBottom}`,transition:"background 0.3s ease-in-out",height:"100%",overflowX:"auto","&.responsive":{overflowY:"hidden"}},e===le.Sx.SharePoint&&{backgroundColor:Ne.z.SharepointBackgroundColor(),transition:"background 0s linear"}],o=[(0,Le.gS)("row","nowrap"),{height:"100%"},e===le.Sx.SharePoint&&{flexBasis:`${Oe} !important`}],s=[Le.xK,(0,Le.Ml)(e),{fontSize:Q.s.small,borderColor:Ne.z.NeutralLight,padding:"1px 6px",borderRadius:"5px",border:"1px solid",textDecoration:"none",cursor:"pointer"}],i=[Le.$Z,(0,Le.gS)("row","nowrap"),{alignItems:"center","> .delinkIcon":[(0,Le.gS)("row","nowrap"),{"> .plannerDivider":[{color:Ne.z.NeutralQuaternaryAlt}],"> .plannerLinkDismiss":[(0,Le.bY)(e)]}]}],a=[Le.xK,(0,Le.$Z)(),(0,Le.aS)(e),{height:"32px",width:"32px",padding:"4px",cursor:"pointer"}],l=[(0,Le.$Z)(),(0,Le.gS)(),Le.cc,{marginRight:"2px",marginLeft:"12px",img:{height:"28px",width:"24px"}}],c=[(0,Le.GD)(),(0,Le.gS)("column","nowrap"),{"> div":(0,Le.gS)("row","nowrap")},(0,Le.aS)(e)],p={".teamsApp:not(.splitUI) &":{display:"none"},display:"inline-block",margin:"0px 40px 0px 12px",minWidth:"164px",maxWidth:"250px"},d=[(0,Le.gS)(),{alignItems:"center",button:[Le.xK,{paddingRight:"5px !important",display:"inline-block",cursor:"pointer"}],"> .secondaryIconSection":{fontSize:Q.s.size16}}],u=[(0,Le.gS)("row","nowrap"),{alignItems:"center","> .contextInfoSection":{"> *":(0,Le.GD)(),".fallbackContextInfoText":[(0,Le.q0)("ellipsis"),(0,Le.Ml)(e),{fontSize:Q.s.small}]}}],h=[(0,Le.$Z)("auto"),(0,Le.gS)("row","nowrap"),{margin:"0px 6px",height:Oe}],g={root:n,topHeaderLandmark:o,linkedBadgeDropdown:s,linkedBadgeItem:i,pivotsSection:[(0,Le.$Z)(),(0,Le.gS)("row","nowrap"),{"> div":(0,Le.gS)()}],appMoreOptionsButton:a,appLogo:l,nonIcon:c,primarySection:p,primaryTextSectionContainer:d,contextInfoSectionContainer:u,secondarySection:h,rightAlignedSection:[(0,Le.GD)("auto"),(0,Le.gS)("row","nowrap"),{alignItems:"center",height:Oe,"> .joinUnifiedGroup":[(0,Le.gS)("row","nowrap"),(0,Le.GD)(),{justifyContent:"flex-end"}],"> div:first-child":{flexGrow:"1",flexShrink:"0",justifyContent:"flex-end"}}]};return(0,Q.pB)(void 0,g,t)}),Ve=(0,j.J9)(e=>({root:(0,Q.Zq)("topHeader",e.root),topHeaderLandmark:(0,Q.Zq)("topHeaderLandmark",e.topHeaderLandmark),linkedBadgeDropdown:(0,Q.Zq)("linkedBadgeDropdown",e.linkedBadgeDropdown),linkedBadgeItem:(0,Q.Zq)("linkedBadgeItem",e.linkedBadgeItem),pivotsSection:(0,Q.Zq)("pivotsSection",e.pivotsSection),appMoreOptionsButton:(0,Q.Zq)("appMoreOptionsButton",e.appMoreOptionsButton),appLogo:(0,Q.Zq)("appLogo",e.appLogo),primaryTextSectionContainer:(0,Q.Zq)("primaryTextSectionContainer",e.primaryTextSectionContainer),contextInfoSectionContainer:(0,Q.Zq)("contextInfoSectionContainer",e.contextInfoSectionContainer),nonIcon:(0,Q.Zq)("nonIcon",e.nonIcon),primarySection:(0,Q.Zq)("primarySection",e.primarySection),secondarySection:(0,Q.Zq)("secondarySection",e.secondarySection),rightAlignedSection:(0,Q.Zq)("rightAlignedSection",e.rightAlignedSection)})),Ge=(0,j.J9)(e=>({root:{margin:"0px"},listItem:[(0,Le.Ml)(e),{"&:first-child > .ms-Breadcrumb-item":{paddingLeft:"0px"},"&:last-child > .ms-Breadcrumb-item":[(0,Le.Ml)(e),{fontWeight:"400",color:"inherit"}]}],item:[(0,Le.Ml)(e),{fontSize:Q.s.small,lineHeight:"inherit",padding:"0 5px"}],overflowButton:[(0,Le.Ml)(e),{"&:hover, &:active, &:hover:active, &.is-expanded":[(0,Le.Mi)(e),(0,Le.Ml)(e)],":focus-visible":[{outlineColor:"initial",outlineStyle:"auto"}],height:"14px"}]})),We=(0,j.J9)(e=>({root:{width:"24px",height:"24px"}}));var _e=r(75472);const ze="10px",Ze="2px",Ke=(0,j.J9)((e,t)=>{let r=[];r=t?[{marginLeft:"0px","> .icon":{fontSize:Q.s.small,marginRight:Re.B.TeamsPivotIconRightMargin,paddingBottom:Ze},"*:last-child:not(:only-child)":{marginRight:Re.B.TeamsPivotLabelRightMargin,marginLeft:"0px"},"&.isSelected,&:hover,&:active":[(0,Le._D)(e),{"> span":(0,Le._D)(e),fontWeight:Q.BO.regular}]},e===le.Sx.TeamsContrast&&{"&.isSelected":{color:Ne.z.TeamsContrastSelectedColor,"> span":{color:Ne.z.TeamsContrastSelectedColor}},"&:hover,&:active":{color:Ne.z.TeamsContrastHyperlinkColor,"> span":{color:Ne.z.TeamsContrastHyperlinkColor}}}]:[{":not(.isSelected):not(:hover) > *":{paddingBottom:Ze},"&:hover > *,&.isSelected > *":[(0,Le.T4)(e),{borderBottomStyle:"solid",borderBottomWidth:Ze}]},e===le.Sx.TeamsContrast&&{" &.isSelected > *":{borderBottomColor:Ne.z.TeamsContrastSelectedColor},"&:hover > *":{color:Ne.z.TeamsContrastHyperlinkColor,borderBottomColor:Ne.z.TeamsContrastHyperlinkColor}}];const n=[e===le.Sx.SharePoint&&{margin:`0px ${ze}`,"> *:not(.icon)":{color:Ne.z.SharepointTitleFontColor()}},{"> .icon":{display:"none"},"> .pivotLinkWithIcon":[(0,Le.gS)("row","nowrap"),{alignItems:"center","> i svg":{transform:"scale(0.7)",marginLeft:(0,Me.jI)()?"0px":"-4px",marginRight:(0,Me.jI)()?"-4px":"0px"}}]}];return{removable:[(0,Le.$Z)(),e===le.Sx.SharePoint&&{margin:`0px -${ze}`},{"> .pivotLink":n}],pivotLink:[r,(0,Le.gS)(),Le.cc,(0,Le.aS)(e),{fontSize:Q.s.medium,cursor:"pointer","> span":(0,Le.aS)(e),lineHeight:(0,_e.jz)(Oe)-3,margin:`0px ${(0,_e.vb)((0,_e.jz)("24px")/2-(0,_e.jz)("8px"))}`,"> *":[(0,Le.$Z)(),{margin:"0px 8px",":first-child:not(:only-child)":{marginLeft:"0px"},":last-child:not(:only-child)":{marginRight:"8px"},":only-child":{margin:"0px",paddingBottom:Ze}},e===le.Sx.SharePoint&&{margin:"0px"}],"&.isSelected":e===le.Sx.SharePoint&&{color:Ne.z.SharepointTitleFontColor()}}],icon:{marginTop:"3px",fontSize:"18px",height:"24px","> button":[Le.xK,(0,Le.aS)(e),{".plannerIcon":{cursor:"pointer"}}]}}}),qe=(0,j.J9)(e=>({removable:(0,Q.Zq)("removable",e.removable),pivotLink:(0,Q.Zq)("pivotLink",e.pivotLink),icon:(0,Q.Zq)("icon",e.icon)}));var je=r(4648),Qe=r(49560);class Ye extends ce.${name(){return"HeaderPivotLinks"}renderComponent(){const{pivotLinks:e,selectedPivotLinkIndex:t,renderTeamsPivotSection:r}=this.props,n=this.getClassNames();return r?this.renderTeamsPivotLinks(n):_.createElement("div",{className:n.removable,role:"tablist"},e.map((e,r)=>{const o=t===r,s=(0,je.A)(n.pivotLink,{isSelected:o});return _.createElement("a",{key:e.id,className:s,title:e.name,tabIndex:0,onClick:this.onLinkClick.bind(this,r),onKeyUp:this.handleOnKeyPress.bind(this,r),"aria-label":e.name,role:"tab","aria-selected":o},_.createElement("span",{className:n.icon},_.createElement(xe.I,e.iconProps)),_.createElement("span",{className:e.alwaysShowIcon?"pivotLinkWithIcon":void 0},e.alwaysShowIcon&&_.createElement(xe.I,e.iconProps),e.name))}))}renderTeamsPivotLinks(e){const t={};return this.props.pivotLinks.forEach((e,r)=>{t[e.id]=r}),_.createElement("div",{className:"altViewPivots"},this.props.pivotLinks.map((r,n)=>{const o=(0,je.A)(e.pivotLink,{isSelected:this.props.selectedPivotLinkIndex===t[r.id]});return _.createElement("a",{key:r.id,className:o,title:r.name,tabIndex:0,onClick:this.onLinkClick.bind(this,t[r.id]),onKeyUp:this.handleOnKeyPress.bind(this,t[r.id])},_.createElement("span",{className:e.icon},_.createElement(xe.I,r.iconProps)),_.createElement("span",null,r.name))}))}getClassNames(){return qe(Ke(this.props.theme,this.props.renderTeamsPivotSection??!1))}onLinkClick(e){const{onSelectPivotLink:t,pivotLinks:r}=this.props;t&&r&&t(this.props.pivotLinks[e])}handleOnKeyPress(e,t){const{onSelectPivotLink:r,pivotLinks:n}=this.props,o=Qe.a.getKey(t);o!==Fe.D.ENTER&&o!==Fe.D.SPACE||!r||!n||r(this.props.pivotLinks[e])}constructor(e,t){super(e,t)}}var Je=r(6017),Xe=r(98571);const $e=(0,j.J9)(e=>({root:[e===le.Sx.SharePoint&&{display:"none"},(0,Le.$Z)(),(e===le.Sx.LoopLight||e===le.Sx.LoopDark)&&{borderLeft:"solid thin",padding:"0 8px 0 12px"},e===le.Sx.LoopLight&&{borderLeftColor:Ne.z.NeutralLightGrey88},e===le.Sx.LoopDark&&{borderLeftColor:Ne.z.NeutralDarkGrey32}],moreContextMenuButton:[(0,Le.gS)(),Le.cc,(0,Le.aS)(e),{fontSize:Q.s.medium,cursor:"pointer","> span":[(0,Le.aS)(e)],"&:hover > *":{borderBottom:"none !important"}}]})),et=(0,j.J9)(e=>({root:(0,Q.Zq)("more",e.root),moreContextMenuButton:(0,Q.Zq)("moreContextMenuButton",e.moreContextMenuButton)}));var tt=r(59846);class rt extends ce.${name(){return"HeaderMoreOptions"}renderComponent(){const{moreOptionsContextMenuItems:e,moreOptionsTooltip:t}=this.props,r=this.getClassNames(),n=this.getPivotLinkClassNames(),o=_.createElement("button",{onClick:this.toggleLinksContextMenu.bind(this),"aria-haspopup":"true",title:t,"aria-label":Ee.p.Strings.PlannerHeader_MoreAriaLabel,ref:this.props.headerMoreOptionsButtonRef,id:"headerMoreOptionButton"},_.createElement(xe.I,tt.XP)),s=_.createElement(Xe.l,{shouldFocusOnMount:!0,items:e||[],directionalHint:Je.A.bottomAutoEdge,target:this.refs.secondaryLinksCommandButton,onDismiss:this.dismissLinksContextMenu.bind(this),appTheme:this.props.theme});return _.createElement("div",{className:r.root,ref:"secondaryLinksCommandButton"},_.createElement("div",{className:(0,je.A)(n.pivotLink,r.moreContextMenuButton),"aria-haspopup":!0},_.createElement("span",{className:n.icon},e&&e.length>0?o:null)),this.state.isLinksContextMenuVisible?s:null)}getClassNames(){return et($e(this.props.theme))}getPivotLinkClassNames(){return qe(Ke(this.props.theme))}toggleLinksContextMenu(){const{onOpenLinksContextMenu:e}=this.props;!this.state.isLinksContextMenuVisible&&e&&e(),this.setState(e=>({isLinksContextMenuVisible:!e.isLinksContextMenuVisible}))}dismissLinksContextMenu(){this.setState(e=>({isLinksContextMenuVisible:!1}))}constructor(e,t){super(e,t),this.state={isLinksContextMenuVisible:!1}}}function nt(e){switch(e){case c.Yc.Plan:return Ee.p.Strings.PlanHeader_GroupByDropDownPlanOption;case c.Yc.Assignee:return Ee.p.Strings.PlanHeader_GroupByDropDownAssignedToOption;case c.Yc.Bucket:return Ee.p.Strings.PlanHeader_GroupByDropDownBucketOption;case c.Yc.Progress:return Ee.p.Strings.PlanHeader_GroupByDropDownProgressOption;case c.Yc.DueDate:return Ee.p.Strings.Task_DueDateFieldText;case c.Yc.Category:return Ee.p.Strings.PlanHeader_GroupByDropDownCategoryOption;case c.Yc.Priority:return Ee.p.Strings.PlanHeader_GroupByDropDownPriorityOption;default:throw new Error(`Unexpected taskGroupingType: ${e}`)}}class ot extends ce.${name(){return"GroupByMenu"}renderComponent(){return _.createElement(Xe.l,{id:"groupByMenu",shouldFocusOnMount:!0,items:this.getMenuItems(),directionalHint:Je.A.bottomRightEdge,target:this.props.targetElement,onDismiss:this.props.onDismissGroupByMenu,appTheme:this.props.theme})}getMenuItems(){const{onGroupByChange:e,currentTaskGrouping:t,taskGroupingOptions:r}=this.props,n=[];for(const o of r)isNaN(Number(o))||n.push({key:c.Yc[o],name:nt(o),canCheck:!0,checked:t===o,onClick:e.bind(this,o)});return n}constructor(e,t){super(e,t),this.state={}}}var st=r(31537),it=r(25588);const at="28px",lt="8px",ct="56px",pt="36px",dt=(0,j.J9)((e,t)=>{const r={root:[(0,Le.GD)(),{fontSize:Q.s.medium,lineHeight:"20px",alignItems:"center",whiteSpace:"nowrap",maxWidth:"100%"}],itemText:[(0,Le.GD)(),{margin:"15px 0px",display:"inline-block",verticalAlign:"middle",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"normal"}],headerLink:[(0,Le.zt)(e),{textDecoration:"none"}],contextRow:[(0,Le.gS)("row"),(0,Le.GD)(),(0,Le.aS)(e),{whiteSpace:"nowrap",alignItems:"center",maxWidth:"100%"}],contextIcon:[(0,Le.$Z)(),{height:at,width:at,marginLeft:(0,_e.vb)((0,_e.jz)(Re.B.HeaderDropdownItemSpacing)/2),marginRight:Re.B.HeaderDropdownItemSpacing,"> .ms-Image > .ms-Image-image":[{maxWidth:at,maxHeight:at}]}],contextDetailsColumn:[(0,Le.GD)("auto"),(0,Le.gS)("column"),{padding:"10px 0px 11px 0px"}],customContextDetailsColumn:[(0,Le.GD)("auto"),(0,Le.gS)("column"),{padding:"8px"}],contextDetailsText:[(0,Le.aS)(e),{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",height:"19px",lineHeight:"16px"}],contextDetailsSecondaryText:[(0,Le.gS)("row","nowrap"),(0,Le.Ml)(e),{fontSize:Q.s.small,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",height:"16px",lineHeight:"14px",alignItems:"center","> .plannerLinkDismiss":[(0,Le.bY)(e),{marginRight:"5px"}]}]};return(0,Q.TW)(r,t)}),ut=(0,j.J9)(e=>({root:(0,Q.Zq)("ms-ContextualMenu-linkContent",e.root),itemText:(0,Q.Zq)("ms-ContextualMenu-itemText",e.itemText),headerLink:(0,Q.Zq)("headerLink",e.headerLink),contextRow:(0,Q.Zq)("ms-ContextualMenu-linkContent contextRow",e.contextRow),contextIcon:(0,Q.Zq)("contextIcon",e.contextIcon),contextDetailsColumn:(0,Q.Zq)("contextDetailsColumn",e.contextDetailsColumn),customContextDetailsColumn:(0,Q.Zq)("customContextDetailsColumn",e.customContextDetailsColumn),contextDetailsText:(0,Q.Zq)("contextDetailsText",e.contextDetailsText),contextDetailsSecondaryText:(0,Q.Zq)("ms-ContextualMenu-itemSecondaryText contextDetailsSecondaryText",e.contextDetailsSecondaryText)})),ht=(0,j.J9)(e=>({header:[(0,Le.aS)(e),{height:"70px",padding:`0px ${Re.B.HeaderDropdownItemSpacing}`}],subComponentStyles:{menuItem:gt(e)}})),gt=(0,j.J9)(e=>({item:{"&.button, &.link > div":[(0,Le.$Z)(),{height:ct,alignItems:"center"}],"&.customButton":[(0,Le.$Z)(),{height:pt,alignItems:"center","> .ms-ContextualMenu-link":{height:pt}}]},root:{height:ct,"&:hover":(0,Le.Mi)(e)}})),mt=(0,j.J9)(e=>{const t=[Le.xK,(0,Le.$Z)(),(0,Le.gS)("row","nowrap"),{alignItems:"center","> *":{marginLeft:lt},"> span:not(:last-child)":{marginRight:"0px"},"> .contextIcon > .ms-Image":[(0,Le.$Z)(),{height:at,width:at,".ms-Image-image":{height:"100%",width:"100%"}}],"> .ms-Label":[(0,Le.$Z)(),(0,Le.aS)(e),{fontSize:"13px",fontWeight:Q.BO.regular,cursor:"pointer"}],"&.link, &.button":{"> .ms-Label":{marginRight:lt,marginLeft:lt}},"&.button, &.dropdownMenu":{":hover":(0,Le.Mi)(e)},"&.link > .ms-Label":{":hover":{textDecoration:"underline"}}}];return(0,Q.Zq)("contextSplitButton",t)}),Ct="10px",kt=(0,j.J9)(e=>{const t=[(0,Le.$Z)(),(0,Le.gS)("row","nowrap"),{margin:`0px ${(0,_e.vb)(((0,_e.jz)(Re.B.TopHeaderIconHorizontalOffset)-(0,_e.jz)(Re.B.HeaderDropdownItemSpacing))/2+(0,_e.jz)("8px"))}`}],r=[(0,Le.$Z)(),(0,Le.aS)(e),{padding:"0px",fontSize:"13px",fontWeight:Q.BO.regular,marginLeft:"8px",cursor:"pointer","> span:first-child":{marginRight:"4px"},"> .value":[(0,Le.aS)(e),e===le.Sx.SharePoint&&{color:Ne.z.SharepointButtonHoverColor()}]}];return{root:t,dropdownMenu:[Le.xK,(0,Le.$Z)(),(0,Le.gS)("row","nowrap"),{alignItems:"center",cursor:"pointer",margin:`0px ${(0,_e.vb)(((0,_e.jz)(Re.B.HeaderDropdownItemSpacing)-(0,_e.jz)(Ct))/2)}`,height:"38px","&:hover":[(0,Le.Mi)(e),e===le.Sx.TeamsLight&&{backgroundColor:Ne.z.NeutralLight},{borderRadius:"2px"}],"> *":{margin:`0px ${(0,_e.vb)((0,_e.jz)(Ct)/2)}`},"> .ms-Label":r,"> .plannerDiamond":{marginRight:"-8px",marginTop:"3px",svg:{transform:"scale(0.7)"}}},e===le.Sx.TeamsContrast&&{backgroundColor:Ne.z.Black,color:Ne.z.White,"&:hover":{"> .ms-Label, > .ms-Label > .value":{color:Ne.z.Black}}}],dropdownIcon:[(0,Le.$Z)(),(0,Le.gS)("row","nowrap"),Le.cc,(0,Le.aS)(e),{marginRight:"8px","> .dropdownChevronIcon":{display:"inline"},"> .dropdownHiddenTextIcon":{display:"none"}}]}}),bt=(0,j.J9)(e=>({root:(0,Q.Zq)("dropdowns",e.root),dropdownMenu:(0,Q.Zq)("dropdownMenu",e.dropdownMenu),dropdownIcon:(0,Q.Zq)("dropDownIcon",e.dropdownIcon)}));var Tt=r(55491),St=r.n(Tt),Pt=r(21382),xt=r(6505),yt=r(99535),ft=r(81877);class vt extends ce.${name(){return"ContextDropdown"}renderComponent(){return this.renderSplitButton()}getHeaderDropdownClassNames(){return bt(kt(this.props.theme))}renderSplitButton(){const{onRenderLabel:e,className:t,theme:r,title:n}=this.props,o=this.generateSplitButtonProps();if(null==o)return null;if(e)return _.createElement("button",{className:t,ref:"contextCommandButton",onClick:this.toggleContextCallout,"aria-label":Pt.G(Ee.p.Strings.PlannerHeader_TitleContextDropdownAriaLabel,n),"aria-expanded":this.state.isContextCalloutVisible,"aria-haspopup":!0},e(o),this.state.isContextCalloutVisible&&this.renderContextCallout(o.dropdownItems));let s=(0,je.A)(mt(r),t);if(o.dropdownItems.length-1===1){const e=o.dropdownItems[1];return s=(0,je.A)(s,e.className),_.createElement("button",{className:s,ref:"link",onClick:t=>this.openLink(e,t),"aria-label":e.ariaLabel},_.createElement(xe.I,{...e.iconProps,className:"contextIcon"}),_.createElement(st.J,{className:"context-text"},e.fallbackText))}const i=this.getHeaderDropdownClassNames();s=(0,je.A)(s,i.dropdownMenu);const a=this.state.isContextCalloutVisible?Ee.p.Strings.PlannerHeader_RightSectionExpandedAriaLabel:Ee.p.Strings.PlannerHeader_RightSectionCollapsedAriaLabel;return _.createElement("button",{className:s,ref:"contextCommandButton",onClick:this.toggleContextCallout,"aria-label":Pt.G(Ee.p.Strings.PlanContextLinking_OpenLinkText,a)},_.createElement(xe.I,{...o.currentValueIconProps,className:(0,je.A)(o.currentValueIconProps?.className,"contextIcon")}),_.createElement(st.J,null,o.currentValue),_.createElement("span",{className:i.dropdownIcon},_.createElement(xe.I,tt.Ju),this.state.isContextCalloutVisible&&this.renderContextCallout(o.dropdownItems)))}renderContextCallout(e){const{theme:t,calloutProps:r,isBeakVisible:n,onRenderCallout:o}=this.props;return o?o(e):_.createElement(Xe.l,{calloutProps:{...r,calloutMaxWidth:257},className:"contextContextualMenu",shouldFocusOnMount:!0,contextualMenuItemAs:this.contextualMenuItemAs,items:e,directionalHint:Je.A.bottomRightEdge,target:this.refs.contextCommandButton,onDismiss:this.dismissContextCallout,isBeakVisible:n,appTheme:t,styles:ht(t)})}generateSplitButtonProps(){const{visibleContextKeys:e,contextMenuItemCallbacks:t}=this.props;if(e.length<1&&!t)return null;const r=[];let n,o=Ee.p.Strings.PlanContextLinking_OpenLinkText;if(e.length>0){r.push({key:"header",itemType:ye.G.Header,text:Ee.p.Strings.PlanContextLinking_MultipleLinkedContextsText,ariaLabel:Ee.p.Strings.PlanContextLinking_MultipleLinkedContextsAriaLabel,href:le.$j.linkedPlans,secondaryText:Ee.p.Strings.SharedComponents_LearnMoreLink,target:"_blank",canCheck:!1}),e.length>1&&r.push({key:"divider_1",itemType:ye.G.Divider});let s=!0;St()(e,t=>{const i=this.getContextMenuItemForContextKey(t);null!=i&&(r.push(i),s&&(1===e.length&&(o=i.text),n=i.iconProps,s=!1))}),t&&r.push({key:"divider_2",itemType:ye.G.Divider})}t&&(r.push({key:"planDetails",itemType:ye.G.Normal,className:"customButton",text:Ee.p.Strings.PlanHeader_PlanHeaderPlanSettings,ariaLabel:Ee.p.Strings.PlanHeader_PlanHeaderPlanSettings,onClick:()=>t.openPlanSettingsPanel(this.refs.contextCommandButton),canCheck:!1}),r.push({key:"copyLinkToPlan",itemType:ye.G.Normal,className:"customButton",text:Ee.p.Strings.PlanHeader_CopyLinkToPlanText,ariaLabel:Ee.p.Strings.PlanHeader_CopyLinkToPlanText,onClick:t.copyLinkToPlan,canCheck:!1}),t.copyPlan&&r.push({key:"copyPlan",itemType:ye.G.Normal,className:"customButton",text:Ee.p.Strings.PlanHeader_CopyPlanText,ariaLabel:Ee.p.Strings.PlanHeader_CopyPlanText,onClick:t.copyPlan,canCheck:!1}),t.iCalendar&&r.push({key:"iCalendar",itemType:ye.G.Normal,className:"customButton",text:Ee.p.Strings.PlanHeader_PublishPlanTasksToCalendar,ariaLabel:Ee.p.Strings.PlanHeader_PublishPlanTasksToCalendar,onClick:t.iCalendar,canCheck:!1}),t.exportPlanToExcel&&r.push({key:"exportPlanToExcel",itemType:ye.G.Normal,className:"customButton",text:Ee.p.Strings.PlanHeader_PlanHeaderExportPlanToExcel,ariaLabel:Ee.p.Strings.PlanHeader_PlanHeaderExportPlanToExcel,onClick:t.exportPlanToExcel,canCheck:!1}));return{currentValueIconProps:n,currentValue:o,dropdownItems:r}}getContextMenuItemForContextKey(e){const{contextDetails:t,contexts:r,title:n,planContainer:o}=this.props;if(null==r[e]||null==t||null==t[e])return null;let s=n,i="",a="",l="button";const c=r[e],p=o?.displayName??"",d=(0,ft.C)(c,p),u=t[e];switch(u.displayAs){case it.s.MeetingNotes:s=i=Ee.p.Strings.PlanContextLinking_MeetingNotes,a=Pt.G(Ee.p.Strings.PlanContextLinking_ExternalContextLinkAriaLabel,Ee.p.Strings.PlanContextLinking_MeetingNotes,Ee.p.Strings.PlanContextLinking_MicrosoftLoop),l="link";break;case it.s.LoopPage:a=Pt.G(Ee.p.Strings.PlanContextLinking_ExternalContextLinkAriaLabel,d,Ee.p.Strings.PlanContextLinking_MicrosoftLoop),i=Ee.p.Strings.PlanContextLinking_MicrosoftLoop;break;case it.s.SharePointPage:a=Pt.G(Ee.p.Strings.PlanContextLinking_ExternalContextLinkAriaLabel,d,Ee.p.Strings.PlanContextLinking_SharePoint),i=Ee.p.Strings.PlanContextLinking_OpenInSharePoint;break;case it.s.TeamsTab:a=Pt.G(Ee.p.Strings.PlanContextLinking_ExternalContextLinkAriaLabel,d,Ee.p.Strings.PlanContextLinking_Teams),i=Ee.p.Strings.PlanContextLinking_OpenInMicrosoftTeams;break;case it.s.Other:s=i=u.customLinkText??d,a=Pt.G(Ee.p.Strings.PlanContextLinking_ExternalContextLinkAriaLabel,s,Ee.p.Strings.PlanContextLinking_Other);break;default:return null}const h=u.status===yt.$.Delinked?Ee.p.Strings.PlanContextLinking_DelinkedContextSecondaryText:(0,ft.C)(c,p);return null!=u?.url&&null!=u.displayAs?{key:e,className:l,itemType:ye.G.Normal,text:s,fallbackText:i,ariaLabel:a,href:u?.url,onClick:this.logContextClick,data:{displayAs:u.displayAs,status:u.status},secondaryText:h,target:"_blank",iconProps:{imageProps:{src:(0,xt.qz)(u.displayAs,this.context.traceLogger)}}}:null}openLink(e,t){this.logContextClick(t,e),window.open(e.href,e.target)}constructor(e,t){super(e,t),this.contextualMenuItemAs=e=>{const t=ut(dt(this.props.theme));return e.item.itemType===ye.G.Header?_.createElement("div",{className:t.root,"aria-label":e.item.ariaLabel},_.createElement("span",{className:t.itemText},e.item.text," ",_.createElement(Z.N,{className:t.headerLink,href:e.item.href,target:e.item.target},e.item.secondaryText))):e.item.itemType===ye.G.Normal?e.item.data?_.createElement("div",{className:t.contextRow,"aria-label":e.item.ariaLabel},_.createElement(xe.I,{...e.item.iconProps,className:t.contextIcon}),_.createElement("div",{className:t.contextDetailsColumn},_.createElement("span",{className:t.contextDetailsText},e.item.text),_.createElement("span",{className:t.contextDetailsSecondaryText},e.item.data.status===yt.$.Delinked&&_.createElement(xe.I,tt.aA),e.item.secondaryText))):_.createElement("div",{className:t.contextRow,"aria-label":e.item.ariaLabel},_.createElement("div",{className:t.customContextDetailsColumn},_.createElement("span",{className:t.contextDetailsText},e.item.text))):null},this.toggleContextCallout=()=>{this.setState(e=>({isContextCalloutVisible:!e.isContextCalloutVisible}))},this.dismissContextCallout=()=>{this.setState({isContextCalloutVisible:!1})},this.logContextClick=(e,t)=>{const r={};null!=t?.data?.displayAs&&(r.displayAs=t.data.displayAs),this.logUsage("PlanContextClicked",r)},this.state={isContextCalloutVisible:!1}}}var At=r(58189),wt=r(94028),Dt=r(39410);const Bt=(0,j.J9)((e,t)=>{const r=(0,Le.GD)(),n=[(0,Le.$Z)(),{"> .plannerIcon":[(0,Le.$Z)(),(0,Le.aS)(e),{cursor:"pointer",fontSize:"16px",transition:"transform 0.2s ease-in-out",transform:"rotate(180deg)"},t&&{transform:"rotate(0deg)"}]}],o=[Le.xK,(0,Le.aS)(e),(0,Le.D1)(e),(0,Le.gS)(),{alignItems:"center",cursor:"pointer",height:"35px","> *":{fontSize:Q.s.medium,fontWeight:Q.BO.semibold}},e===le.Sx.TeamsContrast&&{backgroundColor:Ne.z.Black,color:Ne.z.White,borderColor:Ne.z.White,borderWidth:"1px 0px",borderStyle:"solid",boxSizing:"border-box",":focus, :hover":{borderColor:Ne.z.TeamsContrastHyperlinkColor,"> .sectionToggle > .plannerIcon":{color:Ne.z.TeamsContrastHyperlinkColor}}}];return{root:[(0,Le.gS)("column"),{flexShrink:0,paddingTop:"2px","> .sectionRowsContainer":(0,Le.gS)("column")}],header:o,title:r,sectionToggle:n}}),Et=(0,j.J9)((e,t)=>{const r=Bt(e,t);return{root:(0,Q.Zq)("filterSection",r.root),header:(0,Q.Zq)("header",r.header),title:(0,Q.Zq)("title",r.title),sectionToggle:(0,Q.Zq)("sectionToggle",r.sectionToggle)}});class It extends ce.${renderComponent(){const e=Pt.G(Ee.p.Strings.BaseTaskFilterSection_ToggleFilterSectionAriaLabel,this.getFilterTitleAriaLabel(),this.getAppliedFilterCount()),t=this.getClassNames();return _.createElement("div",{className:t.root},_.createElement("button",{className:t.header,"aria-label":e,"aria-expanded":!this.props.isCollapsed,onClick:this.props.toggleSection.bind(this),tabIndex:0},_.createElement("div",{className:t.title},Pt.G(this.props.sectionTitle,this.getAppliedFilterCount())),_.createElement("div",{className:t.sectionToggle},_.createElement(xe.I,tt.Ju))),this.props.isCollapsed?null:this.renderSectionFilterRows())}getAppliedFilterCount(){return this.props.currentTaskFilter.getFieldFilterCount(this.getFilterField()).toString()}getClassNames(){const{theme:e,isCollapsed:t}=this.props;return Et(e,t)}constructor(e,t){super(e,t)}}var Ft=r(9011),Mt=r(72721),Lt=r(40787),Nt=r(40729);const Rt="35px",Ut="44px",Ot="40px",Ht="28px",Vt=(0,j.J9)((e,t)=>{const r=Nt.d.isLoopTheme(e),n={root:[Le.xK,(0,Le.gS)(),{height:Rt,cursor:"pointer",padding:"0px 16px","> *":{lineHeight:Rt},":focus, :hover":[(0,Le.Mi)(e),e===le.Sx.TeamsContrast&&{color:Ne.z.Black},(0,Ue.cP)()],"&.iconFilterRow":Wt(e),"&.categoryFilterRow":{alignItems:"center"},"&.assignmentFilterRow":zt(e)},r&&{width:"100%",height:Re.B.LoopMenuItemHeight,borderRadius:Re.B.LoopSubItemBorderRadius,padding:Re.B.LoopMenuItemPadding,alignItems:"center",".textValue":[(0,Le.aS)(e),{fontWeight:Q.BO.regular}],".plannerCheckMark":(0,Le.sC)(e)}],textValue:[(0,Le.GD)(),(0,Le.q0)("ellipsis"),{fontSize:Q.s.medium,display:"block"}],indicator:[(0,Le.gS)(),(0,Le.$Z)(),{width:Rt,height:Rt,justifyContent:"flex-end","> .ms-Icon":[(0,Le._D)(e),{fontSize:"16px"}]}]};return(0,Q.TW)(n,t)}),Gt=(0,j.J9)(e=>({root:(0,Q.Zq)("filterRow",e.root),textValue:(0,Q.Zq)("textValue",e.textValue),indicator:(0,Q.Zq)("indicator",e.indicator)})),Wt=(0,j.J9)(e=>{const t=Nt.d.isLoopTheme(e);return{alignItems:"center","> .icon":{height:Rt,marginRight:t?Re.B.LoopMenuItemIconMarginRight:"16px","> .plannerIcon":{height:Rt},":not(i[class^='plannerProgress']):not(i[class^='plannerPriority'])":(0,Le.aS)(e)}}}),_t=(0,j.J9)(()=>({root:[(0,Le.$Z)(),{fontSize:Q.s.medium,maxWidth:"205px",height:"20px"}]})),zt=(0,j.J9)(e=>{const t=Nt.d.isLoopTheme(e);return[{":hover, :focus":{"> .photo > .plannerIcon":(0,Ue.hS)()},height:t?Ot:Ut,"> .photo":[(0,Le.$Z)(),{alignSelf:"center",width:t?Ot:Ut,"> .plannerIcon":[(0,Le.gS)(),(0,Le.zK)(e),(0,Le.aS)(e),{alignItems:"center",borderRadius:"50%",height:Ht,width:Ht,justifyContent:"center"}]}]},!t&&{"> *":{lineHeight:`${Ut} !important`},"> .indicator":{width:`${Ut} !important`,height:`${Ut} !important`},":last-child":{marginBottom:"18px"}},t&&{":hover":{"> .photo > .plannerIcon":(0,Le.NX)(e)}}]});class Zt extends ce.${name(){return"BaseFilterRow"}getStylesClassNames(){return Gt(Vt(this.props.theme,this.props.styles))}renderComponent(){const e=this.getStylesClassNames(),t=(0,je.A)(e.root,this.getClassName());return _.createElement("button",{className:t,onClick:this.props.onToggleFilter.bind(this),tabIndex:0,role:"checkbox","aria-checked":this.props.isSet},this.renderFilterRowIcon(),_.createElement("div",{className:e.textValue},this.props.text),_.createElement("div",{className:e.indicator},this.props.isSet?_.createElement(xe.I,tt.r8):null))}constructor(e,t){super(e,t)}}class Kt extends Zt{name(){return"AssignmentFilterRow"}renderFilterRowIcon(){const e=this.props.member.id!==c.lf.UnassignedUserId!=null?this.getMemberPersonaProps(this.props.member):null;return _.createElement("div",{className:"photo"},this.props.member.id!==c.lf.UnassignedUserId?_.createElement(Lt.f,{user:this.props.member,onLoad:this.props.onRenderPersona,containerId:`userContainer-filter-${this.props.member.id}`},_.createElement(Ft.F,e)):_.createElement(xe.I,tt.T$))}getClassName(){return"assignmentFilterRow"}getMemberPersonaProps(e){return{id:e.id,text:e.formattedDisplayName,secondaryText:e.mail,imageUrl:this.props.memberPhoto,size:Mt.WH.extraSmall}}constructor(e,t){super(e,t)}}var qt=r(50204),jt=r(141);class Qt extends It{name(){return h.M.AssignmentFilterSection}getFilterField(){return"assignments"}getFilterTitleAriaLabel(){return Ee.p.Strings.BaseTaskFilterSection_AssignmentFilterSectionName}renderSectionFilterRows(){const e=this.props.members.slice().sort(jt.k),t=qt.K.builder.fromUserResource({Id:c.lf.UnassignedUserId,DisplayName:Ee.p.Strings.PlannerApp_UnassignedText,JobTitle:null,ProxyAddresses:[],UserPrincipalName:"",UserType:null,PreferredLanguage:null}).build();return _.createElement("div",{className:"sectionRowsContainer"},this.renderAssignmentFilter(t),e.map(e=>this.renderAssignmentFilter(e)))}renderAssignmentFilter(e){return _.createElement(Kt,{key:e.id,text:e.formattedDisplayName,member:e,onToggleFilter:this.onFilterClicked.bind(this,e),memberPhoto:this.props.getUserPhoto(e.id)??void 0,isSet:this.props.currentTaskFilter.doesFilterValueExist(this.getFilterField(),e.id),onRenderPersona:this.props.onRenderPersona,theme:this.props.theme})}constructor(e,t){super(e,t),this.onFilterClicked=(e,t)=>{const r=this.getFilterField(),n=null!=e?e.id:null,o=this.props.currentTaskFilter.doesFilterValueExist(r,n),s=this.props.currentTaskFilter.toggleFilterValue(r,n);this.props.setTaskFilter(s,!1,o,[this.getFilterTitleAriaLabel(),e.displayName]),this.logUsage(h.M.FilterClicked,{filterRemoved:String(o)})}}}class Yt extends Zt{name(){return"FilterRow"}renderFilterRowIcon(){return null}getClassName(){return""}constructor(e,t){super(e,t)}}var Jt=r(70776);class Xt extends It{name(){return h.M.BucketFilterSection}getFilterField(){return"bucketId"}getFilterTitleAriaLabel(){return Ee.p.Strings.BaseTaskFilterSection_BucketFilterSectionName}renderSectionFilterRows(){const e=this.props.buckets||[];e.sort(Jt.k);const t=[];return e.forEach(e=>{t.push(this.renderBucketFilter(e))}),_.createElement("div",{className:"sectionRowsContainer"},t)}renderBucketFilter(e){return _.createElement(Yt,{key:e.id,text:e.title,onToggleFilter:this.onFilterClicked.bind(this,e),isSet:this.props.currentTaskFilter.doesFilterValueExist(this.getFilterField(),e.id),theme:this.props.theme})}constructor(e,t){super(e,t),this.onFilterClicked=(e,t)=>{const r=this.getFilterField(),n=this.props.currentTaskFilter.doesFilterValueExist(r,e.id),o=this.props.currentTaskFilter.toggleFilterValue(r,e.id);this.props.setTaskFilter(o,!1,n,[this.getFilterTitleAriaLabel(),e.title]),this.logUsage(h.M.FilterClicked,{filterRemoved:String(n)})}}}var $t=r(69412);class er extends Zt{name(){return"CategoryFilterRow"}renderFilterRowIcon(){return this.props.renderLabelTag?_.createElement($t.l,{key:this.props.categoryNumber,index:this.props.categoryNumber,title:this.props.categoryName,isCollapsed:!1,theme:this.props.theme,styles:_t()}):null!==this.props.categoryNumber?_.createElement("span",{className:(0,je.A)("category-"+this.props.categoryNumber,"categoryIcon")}):null}getClassName(){return"categoryFilterRow"}constructor(e,t){super(e,t)}}var tr=r(38780);class rr extends It{name(){return h.M.CategoryFilterSection}getFilterField(){return"appliedCategories"}getFilterTitleAriaLabel(){return Ee.p.Strings.BaseTaskFilterSection_LabelFilterSectionName}renderSectionFilterRows(){const{categories:e}=this.props,t=[this.renderCategoryFilterRow(-1,Ee.p.Strings.Labels_UnlabeledText),...e.map(e=>{let{categoryNumber:t,categoryName:r}=e;return null!=r&&""!==r||(r=tr.U.getLabelPlaceholderByIndex(t)),this.renderCategoryFilterRow(t,r)})];return _.createElement("div",{className:"sectionRowsContainer"},t)}renderCategoryFilterRow(e,t){const r=-1===e,n=r?null:e,o=r?t:"";return _.createElement(er,{key:e,text:o,categoryName:t,categoryNumber:e,onToggleFilter:this.onFilterClicked.bind(this,n,t),isSet:this.props.currentTaskFilter.doesFilterValueExist(this.getFilterField(),n),renderLabelTag:!r,theme:this.props.theme})}onFilterClicked(e,t){const r=this.getFilterField(),n=this.props.currentTaskFilter.doesFilterValueExist(r,e),o=this.props.currentTaskFilter.toggleFilterValue(r,e);this.props.setTaskFilter(o,!1,n,[this.getFilterTitleAriaLabel(),t]),this.logUsage(h.M.FilterClicked,{filterRemoved:String(n)})}constructor(e,t){super(e,t)}}class nr extends It{name(){return h.M.DueDateFilterSection}getFilterField(){return"dueDate"}getFilterTitleAriaLabel(){return Ee.p.Strings.BaseTaskFilterSection_DueDateFilterSectionName}renderSectionFilterRows(){const{options:e}=this.props;return!1===e.renderSection?null:_.createElement("div",{className:"sectionRowsContainer"},e.renderLateOption&&this.renderDateFilter(c.Tt.Late),e.renderTodayOption&&this.renderDateFilter(c.Tt.Today),e.renderTomorrowOption&&this.renderDateFilter(c.Tt.Tomorrow),e.renderThisWeekOption&&this.renderDateFilter(c.Tt.ThisWeek),e.renderNextWeekOption&&this.renderDateFilter(c.Tt.NextWeek),e.renderFutureOption&&this.renderDateFilter(c.Tt.Future),e.renderNoDateOption&&this.renderDateFilter(c.Tt.NoDate),e.renderSomeDateOption&&this.renderDateFilter(c.Tt.SomeDate))}renderDateFilter(e){return _.createElement(Yt,{text:this.getDateFilterTitle(e),onToggleFilter:this.onFilterClicked.bind(this,e),isSet:this.props.currentTaskFilter.doesFilterValueExist(this.getFilterField(),e),theme:this.props.theme})}getDateFilterTitle(e){switch(e){case c.Tt.NoDate:return Ee.p.Strings.PlannerApp_NoDateDueDateText;case c.Tt.Late:return Ee.p.Strings.PlannerApp_LateDueDateText;case c.Tt.Today:return Ee.p.Strings.PlannerApp_TodayDueDateText;case c.Tt.Tomorrow:return Ee.p.Strings.PlannerApp_TomorrowDueDateText;case c.Tt.ThisWeek:return Ee.p.Strings.PlannerApp_ThisWeekDueDateText;case c.Tt.NextWeek:return Ee.p.Strings.PlannerApp_NextWeekDueDateText;case c.Tt.Future:return Ee.p.Strings.PlannerApp_FutureDueDateText;case c.Tt.SomeDate:return Ee.p.Strings.PlannerApp_SomeDueDateText;default:throw new Error("UnsupportedException: filterValue")}}onFilterClicked(e,t){const r=this.getFilterField(),n=this.props.currentTaskFilter.doesFilterValueExist(r,e),o=this.props.currentTaskFilter.toggleFilterValue(r,e);this.props.setTaskFilter(o,!1,n,[this.getFilterTitleAriaLabel(),this.getDateFilterTitle(e)]),this.logUsage(h.M.FilterClicked,{dueDateCategory:c.Tt[e],filterRemoved:String(n)})}constructor(e,t){super(e,t)}}class or extends Zt{name(){return"IconFilterRow"}renderFilterRowIcon(){return _.createElement("div",{className:"icon"},this.props.iconProps&&_.createElement(xe.I,this.props.iconProps))}getClassName(){return"iconFilterRow"}constructor(e,t){super(e,t)}}var sr=r(24723),ir=r(67271);class ar extends It{name(){return h.M.PriorityFilterSection}getFilterField(){return"priority"}getFilterTitleAriaLabel(){return Ee.p.Strings.BaseTaskFilterSection_PriorityFilterSectionName}renderSectionFilterRows(){const{options:e}=this.props;if(!1===e.renderSection)return null;const t=[];return e.renderUrgentOption&&t.push(this.renderPriorityFilterRow(sr.gy.Urgent,Ee.p.Strings.Task_PriorityUrgentText)),e.renderImportantOption&&t.push(this.renderPriorityFilterRow(sr.gy.Important,Ee.p.Strings.Task_PriorityImportantText)),e.renderMediumOption&&t.push(this.renderPriorityFilterRow(sr.gy.Medium,Ee.p.Strings.Task_PriorityMediumText)),e.renderLowOption&&t.push(this.renderPriorityFilterRow(sr.gy.Low,Ee.p.Strings.Task_PriorityLowText)),_.createElement("div",{className:"sectionRowsContainer"},t)}renderPriorityFilterRow(e,t){const r=(0,ir._d)(e);return _.createElement(or,{key:e,text:t,iconProps:(0,xt.m4)(this.context.traceLogger,this.props.theme,e),onToggleFilter:this.onFilterClicked.bind(this,r,t),isSet:this.props.currentTaskFilter.doesFilterValueExist(this.getFilterField(),r),theme:this.props.theme})}onFilterClicked(e,t){const r=this.getFilterField(),n=this.props.currentTaskFilter.doesFilterValueExist(r,e),o=this.props.currentTaskFilter.toggleFilterValue(r,e);this.props.setTaskFilter(o,!1,n,[this.getFilterTitleAriaLabel(),t]),this.logUsage(h.M.FilterClicked,{priorityName:t,filterRemoved:String(n)})}constructor(e,t){super(e,t)}}var lr=r(94772);class cr extends It{name(){return h.M.ProgressFilterSection}getFilterField(){return"percentComplete"}getFilterTitleAriaLabel(){return Ee.p.Strings.BaseTaskFilterSection_ProgressFilterSectionName}renderSectionFilterRows(){const{options:e}=this.props;if(!1===e.renderSection)return null;const t=[];return e.renderNotStartedOption&&t.push(this.renderProgressFilterRow(lr.$.NotStarted,Ee.p.Strings.TaskCard_TaskNotStartedText)),e.renderInProgressOption&&t.push(this.renderProgressFilterRow(lr.$.InProgress,Ee.p.Strings.TaskCard_TaskInProgressText)),e.renderCompleteOption&&t.push(this.renderProgressFilterRow(lr.$.Complete,Ee.p.Strings.TaskCard_TaskCompletedText)),_.createElement("div",{className:"sectionRowsContainer"},t)}renderProgressFilterRow(e,t){const r=(0,ir.BK)(e);return _.createElement(or,{key:e,text:t,iconProps:(0,xt.Nu)(this.context.traceLogger,this.props.theme,e),onToggleFilter:this.onFilterClicked.bind(this,r,t),isSet:this.props.currentTaskFilter.doesFilterValueExist(this.getFilterField(),r),theme:this.props.theme})}onFilterClicked(e,t){const r=this.props.currentTaskFilter.doesFilterValueExist("percentComplete",e),n=this.props.currentTaskFilter.toggleFilterValue("percentComplete",e);this.props.setTaskFilter(n,!1,r,[this.getFilterTitleAriaLabel(),t]),this.logUsage(h.M.FilterClicked,{progressName:t,filterRemoved:String(r)})}constructor(e,t){super(e,t)}}var pr=r(72866),dr=r(93950),ur=r.n(dr),hr=r(49728);const gr="16px",mr=gr,Cr=(0,j.J9)((e,t)=>{const r={root:[(0,Le.NX)(e),{width:"300px",paddingTop:gr,"> .ms-Callout-main":[(0,Le.aS)(e),(0,Le.NX)(e),{"> div":[(0,Le.gS)("column"),{maxHeight:"70vh !important",overflowY:"hidden !important","> .ie11Scroll":{maxHeight:"58vh"}}]}]},e===le.Sx.SharePoint&&{".plannerProgressInProgress, .plannerProgressInProgressSmall":{color:Ne.z.SharepointBlueIconColor()},".plannerProgressComplete, .plannerProgressCompleteSmall":{color:Ne.z.SharepointCompleteColor()},".plannerPriorityUrgent, .plannerPriorityUrgentSmall":{color:Ne.z.SharepointHighPriIconColor()},".plannerPriorityImportant, .plannerPriorityImportantSmall":{color:Ne.z.SharepointHighPriIconColor()},".plannerPriorityMedium":{color:Ne.z.SharepointCompleteColor()},".plannerPriorityLow":{color:Ne.z.SharepointBlueIconColor()},".plannerRecurrence, .plannerRecurrenceSmall ":{color:Ne.z.SharepointHighPriIconColor()}}],filterHeader:[(0,Le.gS)(),{padding:`0px ${gr} 6px`,minHeight:"20px",justifyContent:"space-between","> .filterTitle":{fontSize:"17px",fontWeight:Q.BO.semibold,cursor:"default"},"> .clearFilters":[Le.xK,(0,Le._D)(e),e===le.Sx.SharePoint&&{color:Ne.z.SharepointTitleFontColor()},{cursor:"pointer"},e===le.Sx.TeamsContrast&&{":focus, :hover":{color:Ne.z.TeamsContrastHyperlinkColor}}]}],titleFilterBox:{height:"35px",margin:`0px ${mr} 6px`,".ms-TextField-fieldGroup":[(0,Le.Nc)(e),{".ms-TextField-field":[(0,Le.aS)(e),(0,Le.Oj)(e),e===le.Sx.TeamsContrast&&{backgroundColor:Ne.z.Black,border:`1px solid ${Ne.z.White}`},e!==le.Sx.SharePoint&&{borderRadius:"3px"}],":hover":[e!==le.Sx.TeamsContrast&&e!==le.Sx.SharePoint&&{borderColor:"transparent"}]}],"&.is-active":{"> .ms-TextField-wrapper > .ms-TextField-fieldGroup":[(0,Le.oO)(e),{"::after":{border:"none"}}]}},filterSections:[(0,Le.gS)("column"),{overflowY:"auto",".title":{paddingLeft:gr},".sectionToggle":{paddingRight:gr}}]};return(0,Q.TW)(r,t)}),kr=(0,j.J9)(e=>({root:(0,Q.Zq)("taskFilterCallout",e.root),filterHeader:(0,Q.Zq)("filterHeader",e.filterHeader),titleFilterBox:(0,Q.Zq)("titleFilterBox",e.titleFilterBox),filterSections:(0,Q.Zq)("filterSections",e.filterSections)}));class br extends ce.${name(){return h.M.TaskFilterCallout}renderComponent(){const{options:e}=this.props,t=this.getClassNames(),r=window.navigator.userAgent.indexOf("Trident/7.0")>0?(0,je.A)(t.filterSections,"ie11Scroll"):t.filterSections;return _.createElement(Dt.P,{id:"taskFilterCallout",target:this.props.targetElement,directionalHint:Je.A.bottomRightEdge,className:t.root,setInitialFocus:!1,isBeakVisible:!1,onDismiss:this.props.callbacks.onDismiss,gapSpace:0,role:"complementary"},_.createElement(At.Y,{isClickableOutsideFocusTrap:!0,forceFocusInsideTrap:!1},_.createElement("div",{className:t.filterHeader},_.createElement("div",{className:"filterTitle"},Ee.p.Strings.TaskFilterCallout_FilterTitle),_.createElement("button",{className:"clearFilters",onClick:this.clearFilters.bind(this),"aria-label":Ee.p.Strings.TaskFilterCallout_ClearFiltersAriaLabel},Ee.p.Strings.TaskFilterCallout_ClearFilters)),_.createElement(wt.A,{ariaLabel:Ee.p.Strings.TaskFilterCallout_FilterTextFieldAriaLabel,autoAdjustHeight:!0,autoFocus:!0,className:t.titleFilterBox,multiline:!1,placeholder:Ee.p.Strings.TaskFilterCallout_TitleFilterInputPlaceholderText,value:this.state.currentlyTypedText,resizable:!1,onChange:(e,t)=>{this.onFilterTextValueChanged(t??"")}}),_.createElement("div",{className:r},e.dueDateFilterOptions.renderSection&&this.renderDueDateFiltersSection(),e.priorityFilterOptions.renderSection&&this.renderPriorityFiltersSection(),e.progressFilterOptions.renderSection&&this.renderProgressFiltersSection(),e.labelFilterOptions.renderSection&&this.renderCategoryFiltersSection(),e.bucketFilterOptions.renderSection&&this.renderBucketFiltersSection(),e.assignmentFilterOptions.renderSection&&this.renderAssignmentFiltersSection())))}renderAssignmentFiltersSection(){const{users:e,currentTaskFilter:t,taskData:r,callbacks:n,theme:o}=this.props;if(!e)return null;const s=r?(0,hr.rA)(e,r,t):e;return _.createElement(Qt,{members:s,currentTaskFilter:t,sectionTitle:Ee.p.Strings.TaskFilterCallout_AssignmentSectionTitle,isCollapsed:this.state.isAssignmentSectionCollapsed,setTaskFilter:n.setTaskFilter,toggleSection:this.onAssignmentSectionToggle.bind(this),getUserPhoto:n.getUserPhoto,onRenderPersona:n.onRenderPersona,theme:o})}renderBucketFiltersSection(){return this.props.buckets?_.createElement(Xt,{buckets:this.props.buckets,currentTaskFilter:this.props.currentTaskFilter,sectionTitle:Ee.p.Strings.TaskFilterCallout_BucketSectionTitle,isCollapsed:this.state.isBucketSectionCollapsed,setTaskFilter:this.props.callbacks.setTaskFilter,toggleSection:this.onBucketSectionToggle.bind(this),theme:this.props.theme}):null}renderCategoryFiltersSection(){const{categories:e,currentTaskFilter:t,taskData:r,callbacks:n,theme:o}=this.props;if(!e)return null;const s=(0,hr.$p)(e,r,t);return _.createElement(rr,{categories:s,currentTaskFilter:t,sectionTitle:Ee.p.Strings.TaskFilterCallout_CategoryLabelSectionTitle,isCollapsed:this.state.isCategorySectionCollapsed,setTaskFilter:n.setTaskFilter,toggleSection:this.onCategorySectionToggle.bind(this),theme:o})}renderDueDateFiltersSection(){return _.createElement(nr,{options:this.props.options.dueDateFilterOptions,currentTaskFilter:this.props.currentTaskFilter,sectionTitle:Ee.p.Strings.TaskFilterCallout_DueDateSectionTitle,isCollapsed:this.state.isDueDateSectionCollapsed,setTaskFilter:this.props.callbacks.setTaskFilter,toggleSection:this.onDueDateSectionToggle.bind(this),theme:this.props.theme})}renderPriorityFiltersSection(){return _.createElement(ar,{options:this.props.options.priorityFilterOptions,currentTaskFilter:this.props.currentTaskFilter,sectionTitle:Ee.p.Strings.TaskFilterCallout_PrioritySectionTitle,isCollapsed:this.state.isPrioritySectionCollapsed,setTaskFilter:this.props.callbacks.setTaskFilter,toggleSection:this.onPrioritySectionToggle.bind(this),theme:this.props.theme})}renderProgressFiltersSection(){return _.createElement(cr,{options:this.props.options.progressFilterOptions,currentTaskFilter:this.props.currentTaskFilter,sectionTitle:Ee.p.Strings.TaskFilterCallout_ProgressSectionTitle,isCollapsed:this.state.isProgressSectionCollapsed,setTaskFilter:this.props.callbacks.setTaskFilter,toggleSection:this.onProgressSectionToggle.bind(this),theme:this.props.theme})}onFilterTextValueChanged(e){let t;this.logUsage(h.M.FilterByKeyword,{filterRemoved:String(""===e)}),t=""===e?this.props.currentTaskFilter.removeFilter("title"):this.props.currentTaskFilter.replaceFilter("title",new pr.d("title",[e])),this.setState(t=>({currentlyTypedText:e})),this.debouncedTextFilterCallback(t)}onAssignmentSectionToggle(){this.setState(e=>({isAssignmentSectionCollapsed:!e.isAssignmentSectionCollapsed}))}onBucketSectionToggle(){this.setState(e=>({isBucketSectionCollapsed:!e.isBucketSectionCollapsed}))}onDueDateSectionToggle(){this.setState(e=>({isDueDateSectionCollapsed:!e.isDueDateSectionCollapsed}))}onCategorySectionToggle(){this.setState(e=>({isCategorySectionCollapsed:!e.isCategorySectionCollapsed}))}onPrioritySectionToggle(){this.setState(e=>({isPrioritySectionCollapsed:!e.isPrioritySectionCollapsed}))}onProgressSectionToggle(){this.setState(e=>({isProgressSectionCollapsed:!e.isProgressSectionCollapsed}))}clearFilters(){this.logUsage(h.M.ClearFilters),this.props.callbacks.setTaskFilter(new pr.S,!0),this.setState(e=>({currentlyTypedText:""}))}getClassNames(){return kr(Cr(this.props.theme,this.props.styles))}constructor(e,t){super(e,t);const r=this.props.currentTaskFilter.filters.filter(e=>"title"===e.field)[0];this.state={currentlyTypedText:null!=r?.values[0]?r.values[0].toString():"",isAssignmentSectionCollapsed:!1,isBucketSectionCollapsed:!0,isDueDateSectionCollapsed:!1,isCategorySectionCollapsed:!0,isPrioritySectionCollapsed:!0,isProgressSectionCollapsed:!0},this.debouncedTextFilterCallback=ur()(e.callbacks.setTaskFilter,200)}}var Tr=r(54555),Sr=r(16701);const Pr="16px",xr=(0,j.J9)((e,t)=>{const r={root:[(0,Le.gS)("column"),(0,Le.NX)(e),{alignItems:"flex-start",maxHeight:"400px",maxWidth:"260px","> ul":[(0,Le.gS)("column"),{alignSelf:"center",width:"100%"}],".ms-ContextualMenu-item:hover":{".assignmentFilterNoResults":(0,Le.NX)(e)},".assignmentFilterNoResults":[(0,Le.aS)(e),{textAlign:"center",width:Re.B.MenuItemWidth,padding:"30px 0px"}]}],header:[(0,Le.gS)(),{width:Re.B.MenuItemWidth,height:"32px",alignItems:"center",padding:`${Re.B.LoopMenuItemPadding} 0px`,justifyContent:"space-between",fontSize:Q.s.small,fontWeight:Q.BO.semibold,"> .filterTitle":[(0,Le.aS)(e),{paddingLeft:Pr}],"> .clearFilters":[Le.xK,(0,Le._D)(e),(0,Ue.c3)(),{cursor:"pointer",paddingRight:Pr}]}],menuItems:[(0,Le.gS)(),{width:Re.B.MenuItemWidth,height:Re.B.LoopMenuItemHeight,alignItems:"center",alignSelf:"center",button:[(0,Le.gS)(),{borderRadius:Re.B.LoopSubItemBorderRadius,padding:Re.B.LoopMenuItemPadding,alignItems:"center",".ms-ContextualMenu-linkContent":{width:"100%"},".ms-ContextualMenu-submenuIcon":[(0,Le.$Z)(),{justifyContent:"flex-end"}]}]}]};return(0,Q.TW)(r,t)}),yr=(0,j.J9)(e=>({root:(0,Q.Zq)("taskFilterMenu",e.root),header:(0,Q.Zq)("header",e.header),menuItems:(0,Q.Zq)("menuItems",e.menuItems)})),fr=(0,j.J9)(e=>({root:[(0,Le.zK)(e),(0,Ue.kE)(),{width:Re.B.MenuItemWidth,height:Re.B.LoopMenuItemHeight,borderRadius:"8px",alignSelf:"center",border:"none",padding:Re.B.LoopMenuItemPadding,"&.is-active":[{"::after":[(0,Ue.lX)({border:"none !important"}),(0,Le.T4)(e),{borderRadius:Re.B.LoopSubItemBorderRadius}]}],"&.assignmentFilterSearchBox":{paddingLeft:"14px",margin:"12px 12px 0px 12px","> input":{marginLeft:"2px"},i:{marginLeft:"0px"}}}],icon:[(0,Le.A9)(e),{marginLeft:"2px",paddingLeft:"0px",span:{justifyContent:"flex-start"}}],field:[(0,Le.MJ)(e),(0,Le.aS)(e),{marginLeft:"4px"}],clearButton:{marginRight:"-6px"}}));var vr=r(86634),Ar=r(26727),wr=r.n(Ar);function Dr(e){switch(e){case c.Tt.NoDate:return Ee.p.Strings.PlannerApp_NoDateDueDateText;case c.Tt.Late:return Ee.p.Strings.PlannerApp_LateDueDateText;case c.Tt.Today:return Ee.p.Strings.PlannerApp_TodayDueDateText;case c.Tt.Tomorrow:return Ee.p.Strings.PlannerApp_TomorrowDueDateText;case c.Tt.ThisWeek:return Ee.p.Strings.PlannerApp_ThisWeekDueDateText;case c.Tt.NextWeek:return Ee.p.Strings.PlannerApp_NextWeekDueDateText;case c.Tt.Future:return Ee.p.Strings.PlannerApp_FutureDueDateText;case c.Tt.SomeDate:return Ee.p.Strings.PlannerApp_SomeDueDateText;default:throw new Error(`Unexpected DueDateCategory value: ${e}`)}}function Br(e){switch(e){case Sr.mW.DueDate:return Ee.p.Strings.BaseTaskFilterSection_DueDateFilterSectionName;case Sr.mW.Priority:return Ee.p.Strings.BaseTaskFilterSection_PriorityFilterSectionName;case Sr.mW.Progress:return Ee.p.Strings.BaseTaskFilterSection_ProgressFilterSectionName;case Sr.mW.Label:return Ee.p.Strings.BaseTaskFilterSection_LabelFilterSectionName;case Sr.mW.Bucket:return Ee.p.Strings.BaseTaskFilterSection_BucketFilterSectionName;case Sr.mW.Assignment:return Ee.p.Strings.BaseTaskFilterSection_AssignmentFilterSectionName;default:throw new Error(`Unexpected FilterTypes value: ${e}`)}}function Er(e,t,r){return Pt.G(Ee.p.Strings.BaseTaskFilterSection_ToggleFilterSectionAriaLabel,Br(e),Ir(t,r))}function Ir(e,t){return t.getFieldFilterCount(e)}function Fr(e,t,r){let n=e;const o=Ir(t,r);return o>0&&(n=n.concat(" (",o.toString(),")")),n}class Mr extends ce.${name(){return"TaskFilterMenu"}getClassNames(){return yr(xr(this.props.theme,this.props.styles))}renderComponent(){const e=this.getClassNames();return _.createElement(Xe.l,{className:e.root,items:this.getFilterMenuItems(e),directionalHint:Je.A.bottomRightEdge,target:this.props.targetElement,onDismiss:this.props.callbacks.onDismiss,onRestoreFocus:this.onRestoreFocus,onRenderMenuList:(t,r)=>this.renderMenuList(e,t,r),appTheme:this.props.theme,styles:this.props.contextualMenuStyles})}renderMenuList(e,t,r){return _.createElement(At.Y,{isClickableOutsideFocusTrap:!0,forceFocusInsideTrap:!1},_.createElement("div",{className:e.header},_.createElement("div",{className:"filterTitle"},Ee.p.Strings.TaskFiltering_FiltersMenuHeaderText),_.createElement("button",{className:"clearFilters",onClick:this.clearFilters.bind(this),"aria-label":Ee.p.Strings.TaskFiltering_ClearFiltersAriaLabel},Ee.p.Strings.TaskFiltering_ClearFilters)),!this.props.hideSearchBox&&_.createElement(Tr.G,{placeholder:Ee.p.Strings.TaskFiltering_TitleFilterInputPlaceholderText,ariaLabel:Ee.p.Strings.TaskFiltering_FilterTextFieldAriaLabel,iconProps:tt._x,clearButtonProps:{iconProps:tt.s5},value:this.state.currentlyTypedText,onChange:this.onFilterSearchBoxChange,styles:fr(this.props.theme)}),r?r(t):null)}clearFilters(){this.context.usageLogger.logData(h.M.TaskFilterMenu,h.M.ClearFilters),this.props.callbacks.setTaskFilter(new pr.S,!0),this.setState(e=>({currentlyTypedText:""}))}clearAssignmentFilter(){this.setState({currentlyTypedTextAssignment:""})}getFilterMenuItems(e){return[this.getDueDateMenuItem(e),this.getPriorityMenuItem(e),this.getProgressMenuItem(e),this.getLabelMenuItem(e),this.getBucketMenuItem(e),this.getAssignmentMenuItem(e)]}getBucketMenuItem(e){const{currentTaskFilter:t}=this.props,r=[],n=this.props.buckets||[];n.sort(Jt.k);for(const o of n)r.push({key:o.title,onRender:()=>this.renderBucketFilterRow(o)});return{key:Sr.mW.Bucket,name:Fr(Ee.p.Strings.Task_BucketIdFieldText,Sr.Gx.Bucket,t),ariaLabel:Er(Sr.mW.Bucket,Sr.Gx.Bucket,t),className:e.menuItems,iconProps:tt.fD,subMenuProps:{items:r,calloutProps:{className:"plannerAppCallout"},styles:(0,vr.Zo)(this.props.theme,this.props.contextualMenuStyles),onRestoreFocus:this.onRestoreFocus},submenuIconProps:tt.rK}}getLabelMenuItem(e){const{currentTaskFilter:t,taskData:r}=this.props,n=[],o=this.props.categories||[];n.push({key:"Unlabeled",onRender:()=>this.renderCategoryFilterRow(-1,Ee.p.Strings.Labels_UnlabeledText)});return(0,hr.$p)(o,r,t).forEach(e=>{let{categoryNumber:t,categoryName:r}=e;const o=r??tr.U.getLabelPlaceholderByIndex(t);n.push({key:o,onRender:()=>this.renderCategoryFilterRow(t,o)})}),{key:Sr.mW.Label,name:Fr(Ee.p.Strings.Task_LabelsFieldText,Sr.Gx.Label,t),ariaLabel:Er(Sr.mW.Label,Sr.Gx.Label,t),className:e.menuItems,iconProps:tt.Oi,subMenuProps:{items:n,calloutProps:{className:"plannerAppCallout"},styles:(0,vr.Zo)(this.props.theme,this.props.contextualMenuStyles),onRestoreFocus:this.onRestoreFocus},submenuIconProps:tt.rK}}onCategoryFilterClicked(e,t){this.context.usageLogger.logData(h.M.CategoryFilterSection,h.M.FilterClicked);const r=this.props.currentTaskFilter.doesFilterValueExist(Sr.Gx.Label,e),n=this.props.currentTaskFilter.toggleFilterValue(Sr.Gx.Label,e);this.props.callbacks.setTaskFilter(n,!1,r,[Br(Sr.mW.Label),t])}getAssignmentMenuItems(){const{members:e,currentTaskFilter:t,taskData:r}=this.props,n=[];let o=r?(0,hr.rA)(e,r,t):e;const{currentlyTypedTextAssignment:s}=this.state;if(s){if(o=o.filter(e=>-1!==e.formattedDisplayName.toLowerCase().indexOf(s.toLowerCase())).sort(jt.k),!o||ge()(o)){const e=_.createElement("div",{className:"assignmentFilterNoResults"},Ee.p.Strings.TaskFiltering_FilterNoResultsFound);return n.push({key:"noResults",onRender:()=>e}),n}}else{o=[qt.K.builder.fromUserResource({Id:c.lf.UnassignedUserId,DisplayName:Ee.p.Strings.PlannerApp_UnassignedText,JobTitle:null,ProxyAddresses:[],UserPrincipalName:"",UserType:null,PreferredLanguage:null}).build(),...o.slice().sort(jt.k)]}for(const i of o)n.push({key:i.id,text:i.formattedDisplayName,onRender:this.renderAssignmentFilterRow.bind(this,i)});return n}getAssignmentMenuItem(e){const{currentTaskFilter:t}=this.props;return{key:Sr.mW.Assignment,name:Fr(Ee.p.Strings.Task_AssignmentFieldText,Sr.Gx.Assignment,t),ariaLabel:Er(Sr.mW.Assignment,Sr.Gx.Assignment,t),className:e.menuItems,iconProps:tt.Nz,subMenuProps:{items:this.getAssignmentMenuItems(),onRenderMenuList:(t,r)=>this.renderAssignmentMenuList(e,t,r),calloutProps:{className:"plannerAppCallout"},styles:(0,vr.Zo)(this.props.theme,this.props.contextualMenuStyles),onRestoreFocus:this.onRestoreFocus},submenuIconProps:tt.rK}}renderAssignmentMenuList(e,t,r){return _.createElement(_.Fragment,null,_.createElement(Tr.G,{placeholder:Ee.p.Strings.TaskFiltering_AssignmentFilterInputPlaceholderText,ariaLabel:Ee.p.Strings.TaskFiltering_FilterTextFieldAriaLabel,className:"assignmentFilterSearchBox",iconProps:tt._x,clearButtonProps:{iconProps:tt.s5},value:this.state.currentlyTypedTextAssignment,onAbort:this.clearAssignmentFilter,onChange:this.onAssignmentFilterSearchBoxChange,styles:fr(this.props.theme)}),r?r(t):null)}getDueDateMenuItem(e){const{currentTaskFilter:t}=this.props,r=[],n=wr()(c.Tt).filter(e=>e!==c.Tt.SomeDate);for(const o of wr()(n))isNaN(Number(o))||r.push({key:o.toString(),onRender:this.renderDueDateFilterRow.bind(this,o)});return{key:Sr.mW.DueDate,name:Fr(Ee.p.Strings.Task_DueDateFieldText,Sr.Gx.DueDate,t),ariaLabel:Er(Sr.mW.DueDate,Sr.Gx.DueDate,t),className:e.menuItems,iconProps:tt.cx,subMenuProps:{calloutProps:{className:"plannerAppCallout"},items:r,styles:(0,vr.Zo)(this.props.theme,this.props.contextualMenuStyles),onRestoreFocus:this.onRestoreFocus},submenuIconProps:tt.rK}}getPriorityMenuItem(e){const{currentTaskFilter:t}=this.props,r=[{key:sr.gy.Urgent,text:Ee.p.Strings.Task_PriorityUrgentText},{key:sr.gy.Important,text:Ee.p.Strings.Task_PriorityImportantText},{key:sr.gy.Medium,text:Ee.p.Strings.Task_PriorityMediumText},{key:sr.gy.Low,text:Ee.p.Strings.Task_PriorityLowText}].map(e=>({key:e.key,onRender:this.renderPriorityFilterRow.bind(this,e.key,e.text)}));return{key:Sr.mW.Priority,name:Fr(Ee.p.Strings.Task_PriorityFieldText,Sr.Gx.Priority,t),ariaLabel:Er(Sr.mW.Priority,Sr.Gx.Priority,t),className:e.menuItems,iconProps:tt.iW,subMenuProps:{calloutProps:{className:"plannerAppCallout"},items:r,styles:(0,vr.Zo)(this.props.theme,this.props.contextualMenuStyles),onRestoreFocus:this.onRestoreFocus},submenuIconProps:tt.rK}}getProgressMenuItem(e){const{currentTaskFilter:t}=this.props,r=[{key:lr.$.NotStarted,text:Ee.p.Strings.TaskCard_TaskNotStartedText},{key:lr.$.InProgress,text:Ee.p.Strings.TaskCard_TaskInProgressText},{key:lr.$.Complete,text:Ee.p.Strings.TaskCard_TaskCompletedText}].map(e=>({key:e.key,onRender:this.renderProgressFilterRow.bind(this,e.key,e.text)}));return{key:Sr.mW.Progress,name:Fr(Ee.p.Strings.Task_ProgressFieldText,Sr.Gx.Progress,t),ariaLabel:Er(Sr.mW.Progress,Sr.Gx.Progress,t),className:e.menuItems,iconProps:tt.vE,subMenuProps:{calloutProps:{className:"plannerAppCallout"},items:r,styles:(0,vr.Zo)(this.props.theme,this.props.contextualMenuStyles),onRestoreFocus:this.onRestoreFocus},submenuIconProps:tt.rK}}renderPriorityFilterRow(e,t){const{theme:r,currentTaskFilter:n}=this.props,o=(0,ir._d)(e);return _.createElement(or,{key:e,text:t,iconProps:(0,xt.m4)(this.context.traceLogger,r,e),onToggleFilter:this.onPriorityFilterClicked.bind(this,o,t),isSet:n.doesFilterValueExist(Sr.Gx.Priority,o),theme:r})}onPriorityFilterClicked(e,t){this.context.usageLogger.logData(h.M.PriorityFilterSection,h.M.FilterClicked,{priorityName:e});const r=this.props.currentTaskFilter.doesFilterValueExist(Sr.Gx.Priority,e),n=this.props.currentTaskFilter.toggleFilterValue(Sr.Gx.Priority,e);this.props.callbacks.setTaskFilter(n,!1,r,[Br(Sr.mW.Priority),t])}renderProgressFilterRow(e,t){const r=(0,ir.BK)(e);return _.createElement(or,{key:e,text:t,iconProps:(0,xt.Nu)(this.context.traceLogger,this.props.theme,e),onToggleFilter:this.onProgressFilterClicked.bind(this,r,t),isSet:this.props.currentTaskFilter.doesFilterValueExist(Sr.Gx.Progress,r),theme:this.props.theme})}onProgressFilterClicked(e,t){this.context.usageLogger.logData(h.M.ProgressFilterSection,h.M.FilterClicked,{progressName:e});const r=this.props.currentTaskFilter.doesFilterValueExist(Sr.Gx.Progress,e),n=this.props.currentTaskFilter.toggleFilterValue(Sr.Gx.Progress,e);this.props.callbacks.setTaskFilter(n,!1,r,[Br(Sr.mW.Progress),t])}renderDueDateFilterRow(e){return _.createElement(or,{key:e,iconProps:(0,xt.OY)(e,this.context.traceLogger),text:Dr(e),onToggleFilter:this.onDueDateFilterClicked.bind(this,e),isSet:this.props.currentTaskFilter.doesFilterValueExist(Sr.Gx.DueDate,e),theme:this.props.theme})}onDueDateFilterClicked(e){this.context.usageLogger.logData(h.M.DueDateFilterSection,h.M.FilterClicked,{dueDateCategory:c.Tt[e]});const t=this.props.currentTaskFilter.doesFilterValueExist(Sr.Gx.DueDate,e),r=this.props.currentTaskFilter.toggleFilterValue(Sr.Gx.DueDate,e);this.props.callbacks.setTaskFilter(r,!1,t,[Br(Sr.mW.DueDate),Dr(e)])}renderAssignmentFilterRow(e){return _.createElement(Kt,{key:e.id,text:e.formattedDisplayName,member:e,onToggleFilter:this.onAssignmentFilterClicked.bind(this,e),memberPhoto:this.props.callbacks.getUserPhoto(e.id)??void 0,isSet:this.props.currentTaskFilter.doesFilterValueExist(Sr.Gx.Assignment,e.id),onRenderPersona:this.props.callbacks.onRenderPersona,theme:this.props.theme})}constructor(e,t){super(e,t),this.onFilterSearchBoxChange=(e,t)=>{this.context.usageLogger.logData(h.M.TaskFilterMenu,h.M.FilterByKeyword);const r=t??"";let n;n=""===r?this.props.currentTaskFilter.removeFilter("title"):this.props.currentTaskFilter.replaceFilter("title",new pr.d("title",[r])),this.props.callbacks.setTaskFilter(n),this.setState({currentlyTypedText:r})},this.onAssignmentFilterSearchBoxChange=(e,t)=>{this.setState({currentlyTypedTextAssignment:t??""})},this.renderBucketFilterRow=e=>_.createElement(Yt,{key:e.id,text:e.title,onToggleFilter:()=>this.onBucketFilterClicked(e),isSet:this.props.currentTaskFilter.doesFilterValueExist(Sr.Gx.Bucket,e.id),theme:this.props.theme}),this.onBucketFilterClicked=e=>{this.context.usageLogger.logData(h.M.BucketFilterSection,h.M.FilterClicked);const t=this.props.currentTaskFilter.doesFilterValueExist(Sr.Gx.Bucket,e.id),r=this.props.currentTaskFilter.toggleFilterValue(Sr.Gx.Bucket,e.id);this.props.callbacks.setTaskFilter(r,!1,t,[Br(Sr.mW.Bucket),e.title])},this.renderCategoryFilterRow=(e,t)=>{const r=-1===e,n=r?null:e,o=r?t:"";return _.createElement(er,{key:e,text:o,categoryName:t,categoryNumber:e,onToggleFilter:()=>this.onCategoryFilterClicked(n,t),isSet:this.props.currentTaskFilter.doesFilterValueExist(Sr.Gx.Label,n),renderLabelTag:!r,theme:this.props.theme})},this.onAssignmentFilterClicked=e=>{const t=null!=e?e.id:null,r=this.props.currentTaskFilter.doesFilterValueExist(Sr.Gx.Assignment,t),n=this.props.currentTaskFilter.toggleFilterValue(Sr.Gx.Assignment,t);this.props.callbacks.setTaskFilter(n,!1,r,[Br(Sr.mW.Assignment),e.displayName])},this.onRestoreFocus=e=>{e.originalElement?.focus()};const r=this.props.currentTaskFilter.filters.filter(e=>"title"===e.field)[0];this.state={currentlyTypedText:null!=r?.values[0]?r.values[0].toString():"",currentlyTypedTextAssignment:""}}}var Lr=r(65337),Nr=r(94850),Rr=r(17323);const Ur=(0,j.J9)((e,t,r)=>{const n={root:[{"&:focus, &:hover":[{".moreButton":{opacity:"1"}},(0,Le.Mi)(e),e===le.Sx.TeamsContrast&&{"> .memberCardContainer > .ms-Persona .ms-Persona-primaryText":{color:Ne.z.Black}}]},t&&{opacity:"0.5"}],memberCardContainer:[(0,Le.gS)(),{backgroundColor:"transparent",padding:"6px 24px","&:focus, &:hover":{"> .moreButton":{opacity:"1"}}}],moreButton:[Le.xK,(0,Le.$Z)(),{opacity:"0",cursor:"pointer","&.isMenuOpen":{display:"inline-block"},"&:focus":{opacity:"1"}}]};return(0,Q.TW)(n,r)}),Or=(0,j.J9)(e=>({root:(0,Q.Zq)("memberCard",e.root),memberCardContainer:(0,Q.Zq)("memberCardContainer",e.memberCardContainer),moreButton:(0,Q.Zq)("moreButton",e.moreButton)})),Hr=(0,j.J9)((e,t)=>{const r={root:[(0,Le.GD)(),{overflow:"hidden",cursor:"pointer"}],primaryText:[(0,Le.aS)(e),{"&:hover":(0,Le.aS)(e)}]};return(0,Q.TW)(r,t)});var Vr=r(62948);class Gr extends ce.${name(){return"Member"}renderComponent(){const e=this.props.isEditable?this.renderEditableMemberItem():this.renderReadOnlyMemberItem(),t=this.getClassNames(),r=(0,je.A)("plannerAppCallout",t.root),n=this.getPersonaProps(),o=_.createElement("div",{className:r,onKeyUp:this.handleKeyUpEvent.bind(this,n.id),"aria-label":n.text+" "+n.secondaryText,tabIndex:0,"data-is-focusable":!0,ref:this.memberFocusElement,role:"button"},e);return this.props.connectDragSource?this.props.connectDragSource(o)??o:o}cardSource(){return{beginDrag:e=>({user:e.user,userPhoto:e.userPhoto})}}cardCollect(e,t){return{isDragging:t.isDragging(),connectDragSource:e.dragSource(),connectDragPreview:e.dragPreview()}}getPersonaProps(){let e=this.props.personaProps;e||(e=this.getMemberPersonaProps());const t={...e};return t.onClick=this.highlightCardsAssignedToUser.bind(this,e.id),t}renderReadOnlyMemberItem(){const e=this.getPersonaProps();return _.createElement("div",{className:this.getClassNames().memberCardContainer},_.createElement(Lt.f,{user:this.props.user,onLoad:this.props.onRenderPersona,containerId:`userContainer-memberCard-${this.props.user?.id}`},_.createElement(Ft.F,{...e,styles:Hr(this.props.theme)})))}renderEditableMemberItem(){const e=this.getPersonaProps(),t=[{key:"remove",name:Ee.p.Strings.MembersList_RemoveMember,onClick:this.props.onRemoveUser}],r=_.createElement(Xe.l,{items:t,target:this.contextMenuLauncher,onDismiss:this.hideContextMenu.bind(this),directionalHint:Je.A.bottomAutoEdge,appTheme:this.props.theme}),n=this.getClassNames(),o=(0,je.A)(n.moreButton,{isMenuOpen:this.state.isContextMenuOpen});return _.createElement("div",{className:n.memberCardContainer},_.createElement(Lt.f,{user:this.props.user,onLoad:this.props.onRenderPersona,containerId:`userContainer-memberCard-${this.props.user?.id}`},_.createElement(Ft.F,{...e,styles:Hr(this.props.theme)})),_.createElement("button",{className:o,onClick:this.toggleContextMenu.bind(this),ref:this.resolveRef(this,"contextMenuLauncher"),title:Ee.p.Strings.MembersList_MoreButtonTooltipText,"aria-label":Ee.p.Strings.MembersList_MoreButtonTooltipText},_.createElement(xe.I,{...tt.XP,"data-is-focusable":!1})),this.state.isContextMenuOpen?r:null)}getMemberPersonaProps(){return{id:this.props.user.id,text:this.props.user.formattedDisplayName,secondaryText:this.props.user.mail,imageUrl:this.props.userPhoto,size:Mt.WH.extraSmall,onClick:this.highlightCardsAssignedToUser.bind(this,this.props.user.id)}}handleKeyUpEvent(e,t){Qe.a.getKey(t)===Fe.D.ENTER&&this.highlightCardsAssignedToUser(e)}highlightCardsAssignedToUser(e){this.props.highlightTasks&&this.props.highlightTasks(c.JS.Assignee,e)}toggleContextMenu(){this.setState(e=>({...e,isContextMenuOpen:!e.isContextMenuOpen}))}hideContextMenu(){this.setState(e=>({...e,isContextMenuOpen:!1}))}getClassNames(){const{theme:e,styles:t,isDragging:r}=this.props;return Or(Ur(e,!!r,t))}constructor(e,t){super(e,t),this.memberFocusElement=_.createRef(),this.state={isContextMenuOpen:!1}}}const Wr=(0,Vr.I)("memberCard",Gr.prototype.cardSource(),Gr.prototype.cardCollect)(Gr);var _r=r(9737),zr=r(89379),Zr=r(65804),Kr=r(19664);const qr="24px",jr={fontSize:Q.s.xLarge,fontWeight:Q.BO.semibold},Qr="280px",Yr="17px",Jr=(0,_e.vb)((0,_e.jz)(Qr)-2*(0,_e.jz)(Yr)),Xr=(0,j.J9)((e,t,r)=>{const n={root:{},sectionsContainer:[(0,Le.gS)("column"),{maxHeight:"80vh",overflowY:"auto","> .membersSection":[(0,Le.GD)("auto"),(0,Le.gS)("column"),{flexShrink:2,minHeight:t?"120px":"100px"}],"> .sharedContainersSection":[(0,Le.GD)("auto"),(0,Le.gS)("column"),{minHeight:"80px"}]}],membersTitle:[(0,Le.$Z)(),jr,{margin:`0px ${qr} ${(0,_e.vb)((0,_e.jz)(qr)/2)} ${qr}`,cursor:"default"}],membersListContainer:[(0,Le.GD)("auto"),{paddingTop:"1px",minHeight:t?"100px":"60px",maxHeight:"481px",overflowY:"auto","> .noViewMembersPermissionMessage":[(0,Le.Ml)(e),{margin:`0px ${qr}`}]}],noSuggestions:[(0,Le.aS)(e),{textAlign:"center",fontSize:Q.s.small,lineHeight:30,padding:"5px"}],addGuest:{marginBottom:"10px","> .addGuestBtn":[Le.xK,(0,Le.jU)(e),{color:Ne.z.White,cursor:"pointer",padding:`12px ${Yr}`,width:Jr}],"> .addGuestMicrocopy":{fontSize:Q.s.small,padding:`10px ${Yr}`},"> .addGuestHelpLink":[(0,Le.BP)(e),{display:"block",fontSize:Q.s.small,textDecoration:"none",padding:`10px ${Yr}`}]},suggestions:[(0,Le.aS)(e),(0,Le.NX)(e),{width:Qr,".ms-Suggestions-title":[(0,Le.aS)(e),(0,Le.NX)(e),{borderBottom:"none","> .addGuestHelpFooter":{fontSize:Q.s.medium,padding:`0 ${(0,_e.vb)((0,_e.jz)(Yr)-(0,_e.jz)("5px"))}`}}]}],suggestionsItem:[(0,Le.aS)(e),{padding:"5px",":hover":[(0,Le.Mi)(e),{".ms-Suggestions-itemButton.is-suggested":(0,Le.Mi)(e)}],".ms-Persona":{width:"100%"},".ms-Persona-primaryText":(0,Le.aS)(e),".ms-Persona-secondaryText":(0,Le.Ml)(e),".ms-Suggestions-itemButton.is-suggested":(0,Le.NX)(e)}]};return(0,Q.TW)(n,r)}),$r=(0,j.J9)(e=>({root:(0,Q.Zq)("membersList",e.root),sectionsContainer:(0,Q.Zq)("sectionsContainer",e.sectionsContainer),membersTitle:(0,Q.Zq)("membersTitle",e.membersTitle),membersListContainer:(0,Q.Zq)("membersListContainer",e.membersListContainer),noSuggestions:(0,Q.Zq)("noSuggestions",e.noSuggestions),addGuest:(0,Q.Zq)("addGuest",e.addGuest),suggestions:(0,Q.Zq)("suggestions",e.suggestions),suggestionsItem:(0,Q.Zq)("suggestionsItem",e.suggestionsItem)})),en=(0,j.J9)((e,t)=>{const r=Nt.d.isLoopTheme(e),n={root:[(0,Le.NX)(e),{width:"320px",padding:"16px 0px"},r&&{borderRadius:Re.B.LoopBorderRadius}],calloutMain:[(0,Le.aS)(e),(0,Le.NX)(e),{overflowY:"hidden"}]};return(0,Q.TW)(n,t)}),tn=(0,j.J9)((e,t)=>{const r=Nt.d.isLoopTheme(e),n={root:{margin:`0px ${qr} ${(0,_e.vb)((0,_e.jz)(qr)/2)} ${qr}`},text:{border:"none","::after":[r&&{borderRadius:Re.B.LoopSubItemBorderRadius},(0,Le.T4)(e)]},input:[(0,Le.aS)(e),(0,Le.zK)(e),(0,Le.Oj)(e),{minHeight:"34px"}]};return(0,Q.TW)(n,t)}),rn=(0,j.J9)(()=>({root:[(0,Le.GD)("auto")]}));var nn=r(63633);const on=(0,zr.Z)(),sn=(0,Zr.I)(e=>{let{sharedContainerItems:t,inaccessibleSharedContainerCount:r,theme:n,styles:o}=e;const s=t.length>0,i=r>0,a=t.length+r,l=on(o,{theme:n,hasMultipleListItems:s&&a>1});let c=null;s?c=Ee.p.Strings.SharedContainersList_PlanSharedWithFilesMessage:1===r?c=Ee.p.Strings.SharedContainersList_UnsharedFileFullMessageSingular:r>1&&(c=Pt.G(Ee.p.Strings.SharedContainersList_UnsharedFileFullMessagePlural,r)),c&&(c+=" ");const p=s?_.createElement("ul",null,t.map((e,t)=>_.createElement("li",{key:t},_.createElement(Kr.S,{styles:l.subComponentStyles.item,...e})))):null,d=s&&i?_.createElement("div",{className:l.inaccessibleFilesInfo},_.createElement("span",{className:"countBubble"},Pt.G(Ee.p.Strings.SharedContainersList_PlusNumberOfUnsharedFiles,r)),_.createElement("span",{className:"inaccessibleFilesText"},1===r?Ee.p.Strings.SharedContainersList_UnsharedFileMessageSingular:Ee.p.Strings.SharedContainersList_UnsharedFileMessagePlural)):null;return _.createElement("div",{className:l.root},_.createElement("div",{className:l.header},Ee.p.Strings.SharedContainersList_SharedWithHeader),_.createElement("div",{className:l.description},c,c&&_.createElement(Z.N,{href:le.$j.sharedPlans,target:"_blank",rel:"noopener noreferrer"},Ee.p.Strings.SharedComponents_LearnMoreLink)),(p||d)&&_.createElement("div",{className:l.itemsList},p,d))},e=>{let{theme:t,hasMultipleListItems:r}=e;const n=r?"64px":"40px";return{root:["sharedContainersList",(0,Le.gS)("column"),{marginTop:"12px"}],header:["header",(0,Le.$Z)(),{margin:`0 ${qr} 8px`,fontSize:Q.s.xLarge,fontWeight:Q.BO.semibold}],description:["description",(0,Le.$Z)(),(0,Le.Ml)(t),{margin:`0 ${qr}`}],itemsList:[(0,Le.GD)("auto"),{marginTop:"12px",minHeight:n,overflowY:"auto"}],inaccessibleFilesInfo:["inaccessibleFilesInfo",(0,Le.$Z)(),(0,Le.gS)(),Le.cc,{margin:`4px ${qr} 0`,height:nn.n,".countBubble":[(0,Le.$Z)(nn.s),(0,Le.wA)(t),{marginRight:"10px",lineHeight:nn.s,borderRadius:"50%",textAlign:"center",fontSizes:Q.s.small,fontWeight:Q.BO.semibold}],".inaccessibleFilesText":[(0,Le.GD)("auto"),(0,Le.Ml)(t)]}],subComponentStyles:{item:{root:{margin:`0 ${qr}`}}}}});var an=r(50723),ln=r.n(an),cn=r(32520),pn=r.n(cn),dn=r(19853),un=r.n(dn),hn=r(33411),gn=r.n(hn),mn=r(27559),Cn=r(28730);class kn extends ce.${name(){return h.M.MembersList}renderComponent(){let e;this.memberCardFocusElements={},e=this.props.canViewMembers?this.props.canAddMembers?this.renderMembersPeoplePicker():this.renderReadOnlyMembersList():this.renderNoViewMembersPermissionMessage();const t=this.getClassNames(),r=(0,je.A)("plannerAppCallout",t.root);return _.createElement(Dt.P,{id:"membersList",directionalHint:Je.A.bottomRightEdge,target:this.props.calloutTarget,onDismiss:this.props.callbacks.dismissMembersCallout,className:r,isBeakVisible:!1,gapSpace:0,ariaLabel:Ee.p.Strings.MembersList_MembersTitle,role:"complementary",layerProps:{eventBubblingEnabled:!0},onClick:this.stopPropagation,onKeyDown:this.stopPropagation,styles:en(this.props.theme,this.props.calloutStyles)},_.createElement(At.Y,{className:t.sectionsContainer,isClickableOutsideFocusTrap:!0},_.createElement("div",{className:"membersSection"},_.createElement("div",{className:t.membersTitle},Ee.p.Strings.MembersList_MembersTitle),_.createElement("div",{className:t.membersListContainer},e)),this.renderSharedContainersList()))}renderMembersPeoplePicker(){const e=gn()(this.getMembersToRender(),e=>this.getMemberPersonaProps(e)),t=this.getClassNames(),r={loadingText:Ee.p.Strings.MembersList_LoadingText,noResultsFoundText:Ee.p.Strings.MembersList_NoResultsFound,onRenderNoResultFound:this.renderNoResultsFound.bind(this),className:t.suggestions,suggestionsItemClassName:t.suggestionsItem};return _.createElement("div",{className:"membersPeoplePicker"},_.createElement(Rr.iG,{onResolveSuggestions:this.onSearchTextChanged.bind(this),onGetMoreResults:this.onSearchTextChanged.bind(this),getTextFromItem:e=>e.text??"",className:"addMembersPeoplePicker",pickerSuggestionsProps:r,onRenderItem:this.renderMemberItem.bind(this),onChange:this.onUsersChange.bind(this),selectedItems:e,inputProps:{placeholder:Ee.p.Strings.MembersList_AddMemberPlaceholder,role:"textbox",tabIndex:0},ref:this._peoplePickerRef,resolveDelay:200,onDismiss:e=>{e.defaultPrevented=!0},styles:tn(this.props.theme,this.props.peoplePickerStyles)}))}renderNoResultsFound(e,t){const r=this.getClassNames();return _.createElement("div",{className:r.noSuggestions},Ee.p.Strings.MembersList_NoResultsFound)}renderReadOnlyMembersList(){let e=!1;this.state.numMembersToRender<this.props.members.length&&(e=!0);const t=_.createElement(_.Fragment,null,gn()(this.getMembersToRender(),e=>_.createElement("div",{key:e.id,role:"listitem"},_.createElement(Wr,{isEditable:!1,user:e,userPhoto:this.props.callbacks.getUserPhoto(e.id)??void 0,highlightTasks:this.props.callbacks.highlightTasks,onRenderPersona:this.props.callbacks.onRenderPersona,theme:this.props.theme}))));return _.createElement(Lr.R,{className:"readOnlyMembersList",direction:Nr.E.vertical,isCircularNavigation:!1,role:"list"},_.createElement(_r.H,{id:"readOnlyMemberList",hasMoreItemsToRender:e,orientation:_r.Q.Vertical,onLastElementIsVisible:()=>this.onLastMemberVisible()},t))}onLastMemberVisible(){const e=this.state.numMembersToRender+this.membersPageSize;this.setState({numMembersToRender:e})}getMembersToRender(){return this.memoizeGetMembersToRender(this.props.members,this.state.numMembersToRender)}memoizeGetMembersToRender(e,t){const r=this.prevMembers!==e&&!un()(this.prevMembers,e);return r&&(this.sortedMembers=e.slice().sort((e,t)=>Cn.l.compareStringForDisplay(e.displayName,t.displayName)),this.prevMembers=e),(r||this.prevNumMembersToRender!==t)&&(this.renderedMembers=this.sortedMembers.slice(0,t),this.prevNumMembersToRender=t),this.renderedMembers}renderMemberItem(e){const t=!!this.props.canRemoveMembers&&(!!this.props.callbacks.canUserBeRemovedFromGroup&&this.props.callbacks.canUserBeRemovedFromGroup(e.item.id));let r=!1;e.index===this.state.numMembersToRender-1&&(r=!0);const n=_.createElement("div",{key:e.item.id,role:"listitem"},_.createElement(Wr,{isEditable:t,personaProps:e.item,user:this.getMembersToRender()[e.index],highlightTasks:this.props.callbacks.highlightTasks,onRemoveUser:()=>{this.updateFocusOnRemoval(e.item.id),e.onRemoveItem?.()},onRenderPersona:this.props.callbacks.onRenderPersona,ref:t=>{const r=t?.getDecoratedComponentInstance();r?.memberFocusElement?.current&&(this.memberCardFocusElements[e.item.id]={element:r.memberFocusElement.current,id:e.item.id})},theme:this.props.theme}));return _.createElement(_r.H,{id:"memberList",key:`memberListKey${e.item.id}`,hasMoreItemsToRender:r,orientation:_r.Q.Vertical,onLastElementIsVisible:()=>this.onLastMemberVisible()},n)}updateFocusOnRemoval(e){mn.n.ChangeFocusBeforeRemovalAlt(this.getMembersToRender(),()=>this._peoplePickerRef?.current?.focusInput?.(),e,e=>e.id,e=>this.memberCardFocusElements[e.id]?.element)}getMemberPersonaProps(e){return{id:e.id,text:e.formattedDisplayName,secondaryText:e.mail,imageUrl:this.props.callbacks.getUserPhoto(e.id)??void 0,size:Mt.WH.extraSmall}}onSearchTextChanged(e,t){const{getUserWithKeyword:r}=this.props.callbacks;return this.setState({inputText:e}),ge()(e)||e.length<le.c9.MinCharsNeededToSearch?[]:r?new Promise((t,n)=>{r(e).then(e=>{if(ge()(e))t([]);else{const r=ln()(e,e=>!(pn()(this.props.members,t=>t.id===e.id)>-1)&&!(!this.props.canAddGuests&&e.isGuest())),n=gn()(r,e=>this.getMemberPersonaProps(e));t(n)}})}):[]}onUsersChange(e){if(this.props.callbacks.addUserCallback){const t=this.props.members;for(let r=0;r<e.length;r++){if(-1===pn()(t,t=>t.id===e[r].id))return this.logUsage(h.M.AddMember),void this.props.callbacks.addUserCallback(e[r].id)}}if(this.props.callbacks.removeUserCallback){const t=this.getMembersToRender();for(let r=0;r<t.length;r++){if(-1===pn()(e,e=>e.id===t[r].id))return this.logUsage(h.M.RemoveMember),void this.props.callbacks.removeUserCallback(t[r].id)}}}renderNoViewMembersPermissionMessage(){return _.createElement("div",{className:"noViewMembersPermissionMessage"},Ee.p.Strings.MembersList_NonPlanMemberMessage)}renderSharedContainersList(){return null==this.props.sharedContainersListProps?null:_.createElement("div",{className:"sharedContainersSection"},_.createElement(sn,{...this.props.sharedContainersListProps,styles:rn()}))}getClassNames(){const{members:e,theme:t,styles:r}=this.props,n=e.length>1;return $r(Xr(t,n,r))}constructor(e,t){super(e,t),this._peoplePickerRef=_.createRef(),this.membersPageSize=10,this.prevMembers=[],this.prevNumMembersToRender=0,this.sortedMembers=[],this.renderedMembers=[],this.stopPropagation=e=>{e.stopPropagation()},this.state={inputText:"",numMembersToRender:this.membersPageSize}}}class bn extends ce.${name(){return"HeaderDropdowns"}renderComponent(){const{renderNewFilterMenu:e}=this.props.filtersDropdownProps,t=this.getClassNames();return _.createElement("div",{className:t.root},this.renderContextDropdown(),e?this.renderFiltersDropdown(t):this.renderMembersDropdown(t),e?this.renderGroupByDropdown(t):this.renderFiltersDropdown(t),e?this.renderMembersDropdown(t):this.renderGroupByDropdown(t))}getClassNames(){return bt(kt(this.props.theme))}renderContextDropdown(){const{contextMenuProps:e,renderContextDropdown:t}=this.props;return t&&null!=e&&null!=e.contextDetails?_.createElement(vt,e):null}renderMembersDropdown(e){const{renderMembersDropdown:t,membersDropdownProps:r}=this.props;return t&&null!=r?_.createElement("button",{className:(0,je.A)("members passive_2 active_3",e.dropdownMenu),ref:"membersCommandButton",onClick:r.toggleMembersCallout,title:Ee.p.Strings.PlannerHeader_MembersTooltipText,"aria-expanded":r.isMembersCalloutVisible,"aria-controls":"membersList",id:"plannerHeaderMemberButton"},_.createElement(st.J,null,Ee.p.Strings.PlannerHeader_MembersDropDownHeaderText),_.createElement("span",{className:e.dropdownIcon},_.createElement(xe.I,{...tt.Ju,className:(0,je.A)(tt.Ju.className,"dropdownChevronIcon")}),_.createElement(xe.I,{...tt.BW,className:(0,je.A)(tt.BW.className,"dropdownHiddenTextIcon")}),r.isMembersCalloutVisible&&this.renderMembersCallout())):null}renderFiltersDropdown(e){const{filtersDropdownProps:t}=this.props;if(!t.currentTaskFilter)return null;const r=Pt.G(Ee.p.Strings.PlannerHeader_FiltersTooltipText,t.currentTaskFilter.filterCount.toString());return _.createElement("button",{className:(0,je.A)("filters",e.dropdownMenu),ref:"filterCalloutCommandButton",onClick:this.toggleFilterCallout.bind(this),title:r,"aria-expanded":t.isFilterCalloutVisible,"aria-controls":"taskFilterCallout"},_.createElement(st.J,null,_.createElement("span",null,Ee.p.Strings.TaskFiltering_FiltersMenuHeaderText),_.createElement("span",null,Ee.p.Strings.PlannerHeader_FiltersMenuHeaderOpeningParentheses),_.createElement("span",{className:"value"},t.currentTaskFilter.filterCount.toString()),_.createElement("span",null,Ee.p.Strings.PlannerHeader_FiltersMenuHeaderClosingParentheses)),_.createElement("span",{className:e.dropdownIcon},_.createElement(xe.I,{...tt.Ju,className:(0,je.A)(tt.Ju.className,"dropdownChevronIcon")}),_.createElement(xe.I,{...tt.ao,className:(0,je.A)(tt.ao.className,"dropdownHiddenTextIcon")}),t.isFilterCalloutVisible?this.renderTaskFilterMenu():null))}renderMembersCallout(){const{membersDropdownProps:e,callbacks:t}=this.props;if(null==e)return null;const r=t,n={addUserCallback:r.onAddMember,dismissMembersCallout:e.dismissMembersCallout,getUserWithKeyword:r.getUserWithKeyword,getUserPhoto:r.getUserPhoto,canUserBeRemovedFromGroup:r.canUserBeRemovedFromContainer?r.canUserBeRemovedFromContainer:()=>!1,highlightTasks:r.highlightTasks,onRenderPersona:r.onRenderPersona,removeUserCallback:r.onRemoveMember};return _.createElement(kn,{callbacks:n,calloutTarget:this.refs.membersCommandButton,members:this.props.members??[],canAddGuests:e.canUserAddGuests??!1,canViewMembers:e.canUserViewMembers??!0,canAddMembers:e.canUserAddMembers??!1,canRemoveMembers:e.canUserRemoveMembers??!1,sharedContainersListProps:e.sharedContainersListProps,theme:this.props.theme})}renderTaskFilterMenu(){const{filtersDropdownProps:e,members:t,callbacks:r,theme:n}=this.props,{currentTaskFilter:o,taskData:s,buckets:i,planCategories:a,filterOptions:l,renderNewFilterMenu:c}=e;if(!o)return null;const p={getUserPhoto:r.getUserPhoto,setTaskFilter:r.setTaskFilter,onDismiss:this.dismissFilterCallout,onRenderPersona:r.onRenderPersona};return c?_.createElement(Mr,{targetElement:this.refs.filterCalloutCommandButton,callbacks:p,currentTaskFilter:o,taskData:s,members:t??[],categories:a,buckets:i,theme:n}):_.createElement(br,{targetElement:this.refs.filterCalloutCommandButton,callbacks:p,currentTaskFilter:o,taskData:s,buckets:i,users:t,categories:a,options:l??{assignmentFilterOptions:{renderSection:!1},bucketFilterOptions:{renderSection:!1},dueDateFilterOptions:{renderSection:!1,renderSomeDateOption:!1,renderFutureOption:!1,renderLateOption:!1,renderNoDateOption:!1,renderNextWeekOption:!1,renderThisWeekOption:!1,renderTodayOption:!1,renderTomorrowOption:!1},labelFilterOptions:{renderSection:!1},priorityFilterOptions:{renderSection:!0,renderUrgentOption:!0,renderImportantOption:!0,renderMediumOption:!0,renderLowOption:!0},progressFilterOptions:{renderSection:!0,renderCompleteOption:!0,renderInProgressOption:!0,renderNotStartedOption:!0}},theme:n})}toggleFilterCallout(){this.context.usageLogger.logData(this.name(),"Filter menu selected"),this.props.callbacks.onFilterCalloutVisibleChange(!this.props.filtersDropdownProps.isFilterCalloutVisible)}renderGroupByDropdown(e){const{groupByDropdownProps:t}=this.props;if(!t.taskGroupingOptions||ge()(t.taskGroupingOptions)||!t.currentTaskGrouping)return null;const r=nt(t.currentTaskGrouping);return _.createElement("button",{className:(0,je.A)("groupByMenu",e.dropdownMenu),ref:"groupByMenuCommandButton",onClick:this.toggleGroupByMenu,title:Ee.p.Strings.HeaderDropdowns_GroupByTooltipText,"aria-expanded":this.state.isGroupByMenuVisible,"aria-controls":"groupByMenu"},_.createElement(st.J,null,_.createElement("span",null,Ee.p.Strings.HeaderDropdowns_GroupByDropDownHeaderText),t.showGroupByMenuTitleValue?_.createElement("span",{className:"value"},r):null),_.createElement("span",{className:e.dropdownIcon},_.createElement(xe.I,{...tt.Ju,className:(0,je.A)(tt.Ju.className,"dropdownChevronIcon")}),_.createElement(xe.I,{...tt.DZ,className:(0,je.A)(tt.DZ.className,"dropdownHiddenTextIcon")}),this.state.isGroupByMenuVisible?_.createElement(ot,{currentTaskGrouping:t.currentTaskGrouping,taskGroupingOptions:t.taskGroupingOptions,targetElement:this.refs.groupByMenuCommandButton,onDismissGroupByMenu:this.dismissGroupByMenu,onGroupByChange:this.props.callbacks.onGroupByChange,theme:this.props.theme}):null))}constructor(e,t){super(e,t),this.dismissFilterCallout=()=>{this.props.callbacks.onFilterCalloutVisibleChange(!1),this.refs.filterCalloutCommandButton.focus()},this.toggleGroupByMenu=()=>{this.setState(e=>({isGroupByMenuVisible:!e.isGroupByMenuVisible}))},this.dismissGroupByMenu=()=>{this.setState(e=>({isGroupByMenuVisible:!1}))},this.state={isGroupByMenuVisible:!1}}}var Tn=r(56205),Sn=r(3902);const Pn=e=>({root:[(0,Le.$Z)("auto"),(0,Le.gS)("row","nowrap"),{margin:`0px ${(0,_e.vb)((0,_e.jz)("20px")-((0,_e.jz)(Re.B.TopHeaderIconHorizontalOffset)+(0,_e.jz)(Re.B.HeaderDropdownItemSpacing))/2)}`}],descriptiveOverflowButton:{lineHeight:"normal",backgroundColor:"transparent",".ms-Persona-initials > span":[(0,Le.aS)(e),(0,Ue.M8)()]}});class xn extends ce.${name(){return"HeaderFacepile"}renderComponent(){const{members:e,toggleMembersCallout:t,onRenderPersona:r,theme:n}=this.props,o=e.length,s=e.map(e=>this.getFacepileProps(e));let i="";return St()(e.slice(0,4),(e,t)=>{i+=e.displayName,t!==o-1&&3!==t&&(i+=Ee.p.Strings.TaskAssignmentControl_AssignControlAriaLabelListSeparator)}),_.createElement(Sn.g,{className:"facePileArray",personas:s,maxDisplayablePersonas:4,overflowButtonType:Tn.Z.descriptive,overflowButtonProps:{onClick:t,ariaLabel:Pt.G(Ee.p.Strings.PlannerHeader_OverflowButtonAriaLabel,s.length-4)},onRenderUserPersona:r,ariaLabel:i,customStyles:Pn(n)})}getFacepileProps(e){return{personaName:e.formattedDisplayName,imageUrl:this.props.getUserPhoto(e.id)??void 0,onClick:this.highlightCardsAssignedToUser.bind(this,e.id),data:{user:e}}}highlightCardsAssignedToUser(e){this.props.highlightTasks?.(c.JS.Assignee,e)}constructor(e,t){super(e,t),this.state={}}}var yn=r(79889),fn=r.n(yn),vn=r(44388);class An extends ce.${name(){return"Responsive"}componentDidMount(){this.resizeEventGroup.on(window,"resize",fn()(this.calculateClassName.bind(this))),this.calculateClassName()}componentWillUnmount(){this.resizeEventGroup.off()}renderComponent(){return _.createElement(this.props.elementTagName||"div",{ref:"responsiveContainer"},this.props.children)}calculateClassName(){let e=0,t="";if(null!=this.refs.responsiveContainer){this.isAdditive()&&(t=this.defaultClassName);do{t=this.isAdditive()?(0,je.A)(t,this.props.sizeClasses[e]):(0,je.A)(this.defaultClassName,this.props.sizeClasses[e]),this.refs.responsiveContainer.className=t,e++}while(e<this.props.sizeClasses.length&&this.refs.responsiveContainer.offsetWidth<this.refs.responsiveContainer.scrollWidth);this.refs.responsiveContainer.offsetWidth<this.refs.responsiveContainer.scrollWidth&&this.logUsage("ResponsiveTooSmall",{parentSize:this.refs.responsiveContainer.offsetWidth.toString(10),contentSize:this.refs.responsiveContainer.scrollWidth.toString(10)})}}isAdditive(){return this.props.isAdditive||!0}constructor(e,t){if(super(e,t),0===this.props.sizeClasses.length)throw new Error("InvalidArgumentException: sizeClasses must be of length 1 or greater");this.defaultClassName=(0,je.A)("responsive",this.props.className),this.state={className:this.defaultClassName},this.resizeEventGroup=new vn.g(this)}}var wn=r(44433),Dn=r(67239),Bn=r(96980);const En="12px",In="16px",Fn=(0,j.J9)((e,t)=>{const r=Nt.d.isLoopTheme(e),n={root:[e===le.Sx.Dark&&{".ms-Button-icon":{color:Ne.z.White}},{".ms-Callout-main":{borderRadius:r?Re.B.LoopBorderRadius:"initial"}}],content:[(0,Le.gS)("column"),{boxSizing:"border-box",width:"288px",padding:`${En} ${En} 0 28px`}],infoSectionContainer:[(0,Le.gS)("column"),{width:"232px",".infoSection":{"> .title":{fontWeight:Q.BO.bold,paddingBottom:"12px"},"> .description":{fontSize:Q.s.small,fontWeight:Q.BO.semilight,paddingBottom:"24px"}}}],closeButtonContainer:{alignSelf:"flex-end",".closeButton":{width:In,height:In,padding:"0px",".ms-Button-icon":{padding:"0px",margin:"0px"}}}};return(0,Q.TW)(n,t)}),Mn=(0,j.J9)(e=>({root:(0,Q.Zq)("planInfoCallout",e.root),content:(0,Q.Zq)("planInfoCallout-content",e.content),infoSectionContainer:(0,Q.Zq)("infoSectionContainer",e.infoSectionContainer),closeButtonContainer:(0,Q.Zq)("closeButtonContainer",e.closeButtonContainer)}));class Ln extends ce.${name(){return"PlanInfoCallout"}renderComponent(){const e=this.getClassNames();return _.createElement(Dt.P,{ariaLabel:Ee.p.Strings.PlanInfoCallout_CalloutAriaLabel,target:this.props.targetElement,directionalHint:Je.A.bottomLeftEdge,className:e.root,setInitialFocus:!0,isBeakVisible:!0,beakWidth:10,onDismiss:this.props.callbacks.onDismiss,gapSpace:5,styles:(0,vr.df)(this.props.theme)},_.createElement(At.Y,{elementToFocusOnDismiss:this.props.targetElement,isClickableOutsideFocusTrap:!0,className:e.content},_.createElement("div",{className:e.closeButtonContainer},_.createElement(Dn.K,{className:(0,je.A)("ms-TeachingBubble-closebutton","closeButton"),iconProps:tt.s5,title:Ee.p.Strings.PlanInfoCallout_CloseButtonText,ariaLabel:Ee.p.Strings.PlanInfoCallout_CloseButtonAriaLabel,onClick:this.props.callbacks.onDismiss,plannerTheme:this.props.theme})),_.createElement("div",{className:e.infoSectionContainer},this.renderPrivacySection(),this.renderClassificationSection(),this.renderSensitivitySection(),this.renderHasGuestsSection())))}renderPrivacySection(){const e=this.props.visibility===ue.X.Public?Ee.p.Strings.PlanCreateEditor_VisibilityMode_Public:this.props.hasSharedContainers?Ee.p.Strings.Plan_Group_PrivacyText_WithSharedContainers:Ee.p.Strings.PlanCreateEditor_VisibilityMode_Private;return _.createElement(Bn.K,{title:Ee.p.Strings.PlanInfoCallout_PrivacyTitle,description:e})}renderClassificationSection(){return!this.props.classification||this.props.sensitivity?null:_.createElement(Bn.K,{title:Ee.p.Strings.PlanInfoCallout_ClassificationTitle,description:this.props.classification})}renderSensitivitySection(){return this.props.sensitivity?_.createElement(Bn.K,{title:Ee.p.Strings.PlanInfoCallout_SensitivityTitle,description:this.props.sensitivity}):null}renderHasGuestsSection(){return this.props.hasGuests?_.createElement(Bn.K,{title:Ee.p.Strings.PlanInfoCallout_GuestsTitle,description:Ee.p.Strings.PlanInfoCallout_HasGuestsText}):null}getClassNames(){return Mn(Fn(this.props.theme,this.props.styles))}constructor(e,t){super(e,t)}}var Nn=r(94283);const Rn="48px",Un="19px",On=(0,j.J9)(e=>{const t=Nt.d.isLoopTheme(e);return{root:[(0,Le.$Z)(Rn),{position:"relative",margin:`5px ${Re.B.TopHeaderHorizontalPadding} 0px`,"> .icon":[(0,Le.gS)(),Le.cc,(0,Le.$Z)(Rn),(0,Ue.kE)(),{height:Rn,width:Rn,borderRadius:t&&"4px","&.circular":{borderRadius:"50%"}}],".icontext":{fontSize:"17px",fontWeight:"300",color:Ne.z.White,textAlign:"center"}}],badge:[(0,Le.gS)(),Le.cc,{backgroundColor:Ne.z.White,position:"absolute",top:(0,_e.vb)((0,_e.jz)(Rn)-(0,_e.jz)(Un)/2),right:(0,_e.vb)(0-(0,_e.jz)(Un)/2),borderRadius:"50%",height:Un,width:Un,".badgeContainer":[Le.xK,(0,Le.gS)(),Le.cc,{cursor:"pointer"}]}]}}),Hn=(0,j.J9)(e=>({root:(0,Q.Zq)("primaryIconSection",e.root),badge:(0,Q.Zq)("primaryIconBadge",e.badge)}));var Vn=r(36060),Gn=r(27678),Wn=r(44535);class _n extends ce.${name(){return"HeaderIcon"}renderComponent(){const{badgeIconAriaLabel:e,imageSource:t,isIconCircular:r,titleText:n}=this.props,o=this.getClassNames();let s;const i=e??"";if(t){const e=(0,je.A)("icon",{circular:r??!1});s=_.createElement("img",{src:t,className:e,tabIndex:i?0:-1,alt:i,title:i})}else{const e=(0,Vn.K)((0,Gn.wV)(n)),t=(0,je.A)("icon",e,{circular:r??!1});s=_.createElement("div",{className:t,tabIndex:i?0:-1,"aria-label":i,title:i},_.createElement("div",{className:"icontext"},Wn.$.parseInitialsFromName(n)))}return _.createElement("div",{className:o.root},s,this.renderBadge(o))}getClassNames(){return Hn(On(this.props.theme))}renderPlanInfoCallout(){const{hasSharedContainers:e,sensitivityLabels:t,planMembers:r,planContainer:n,theme:o}=this.props,s={onDismiss:this.dismissPlanInfoCallout};let i=!1;if(r)for(let l=0;l<r.length;l++)if(r[l].isGuest()){i=!0;break}const a=n?.unifiedGroup;return _.createElement(Ln,{callbacks:s,visibility:a?.visibility,classification:a?.classification,sensitivity:a?Nn.k.getFullSensitivityTitle(a.assignedSensitivityLabelId,t??null):"",targetElement:this.infoCalloutCommandButton,hasGuests:i,hasSharedContainers:e,theme:o})}constructor(e,t){super(e,t),this.renderBadge=e=>this.props.hideBadgeIcon?null:_.createElement("div",{className:e.badge},_.createElement("button",{className:"badgeContainer",tabIndex:0,onClick:this.togglePlanInfoCallout,ref:e=>this.infoCalloutCommandButton=e,"aria-label":Ee.p.Strings.PlanHeader_PlanInfoBadgeIconAriaLabel,"aria-haspopup":!0},_.createElement(xe.I,tt.DA),this.state.isPlanInfoCalloutVisible?this.renderPlanInfoCallout():null)),this.togglePlanInfoCallout=()=>{this.state.isPlanInfoCalloutVisible||this.logUsage("ViewPlanInfoCallout"),this.setState(e=>({isPlanInfoCalloutVisible:!e.isPlanInfoCalloutVisible}))},this.dismissPlanInfoCallout=()=>{this.setState(e=>({isPlanInfoCalloutVisible:!1}))},this.state={isPlanInfoCalloutVisible:!1}}}var zn=r(62264);const Zn=r.p+"static/media/planner.ada07f52318c532dc0d7d68dc36a9b7c.svg",Kn=(0,j.J9)(()=>({hidePersonas:{".facePileArray, .joinUnifiedGroup":{display:"none"},".rightAlignedSection":[(0,Le.$Z)(),{flexGrow:1,justifyContent:"flex-end"}],".secondarySection":[(0,Le.GD)("auto"),{flexShrink:0}],".dropdowns":{margin:"0px"}},hidePivotText:{".pivotsSection > .removable > .pivotLink":{"> *:not(.icon)":{display:"none"},"> .icon":{display:"inline"}}},hideTitle:{".nonIcon > * > .primarySection":{display:"none"}},hideDropdownText:{".dropdownMenu":{margin:`0px ${(0,_e.vb)((0,_e.jz)(Re.B.HeaderDropdownItemSpacing)/2)}`,"> *":{margin:"0px"},"> label":{display:"none"},".dropDownIcon":{"> .dropdownChevronIcon":{display:"none"},"> .dropdownHiddenTextIcon":{display:"inline"}},".plannerDiamond svg":{transform:"scale(1)"}}}})),qn=(0,j.J9)(e=>({hidePersonas:(0,Q.Zq)("hidePersonas",e.hidePersonas),hidePivotText:(0,Q.Zq)("hidePivotText",e.hidePivotText),hideTitle:(0,Q.Zq)("hideTitle",e.hideTitle),hideDropdownText:(0,Q.Zq)("hideDropdownText",e.hideDropdownText)}));var jn=r(98990),Qn=r.n(jn),Yn=r(80493),Jn=r(33268);class Xn extends Se{name(){return"PlanHeader"}getClassNames(){return Ve(He(this.props.theme,this.props.styles))}getResponsiveHeaderClassNames(){return qn(Kn())}renderComponent(){const{callbacks:e,disableMode:t,flights:r,plan:n,planContainer:o,hideFavoriteButton:s}=this.props,i=this.getClassNames(),a=this.renderPrimaryIconSection(),l=this.renderPrimaryTextSection(),c=r.EnableDocumentTasks&&o?.containerType===pe.K.DriveItem&&null!==e.getBreadcrumbUrl(o?.externalId)?this.renderSecondaryIconSection():null,p=s||t===be.DisableAll?null:this.renderToggleFavoriteButton(),d=this.renderPivotsSection(i),u=this.renderRightSection(i),h=this.renderBreadcrumbSection(),g=this.renderLinkedSection(i);let m="";const C=this.getBreadcrumbItemsInfo();m=ge()(C)?this.fallbackContextInfoProvider():C.map(e=>e.text).join();const k=this.getResponsiveHeaderClassNames(),b=["",k.hidePersonas,k.hideTitle,k.hidePivotText,k.hideDropdownText];this.props.isSlimView&&b.push("slimView");const T=this.props.hideTitleSection?null:_.createElement("div",{className:i.primarySection,tabIndex:0,"aria-label":Pt.G(Ee.p.Strings.PlannerHeader_PrimarySectionAriaLabel,this.props.plan.title,m)},_.createElement("div",{className:i.primaryTextSectionContainer},l,p,c),_.createElement("div",{className:i.contextInfoSectionContainer},_.createElement("div",{className:"contextInfoSection"},h),g));return _.createElement(fe.$,{planContainerId:n.id,onRender:e.onRenderPlanPhoto},_.createElement(An,{sizeClasses:b,isAdditive:!0,className:i.root},_.createElement(wn.H,{className:i.topHeaderLandmark,role:"banner","aria-label":Ee.p.Strings.PlannerHeader_TopHeaderLandmarkAriaLabel},a,_.createElement("div",{className:i.nonIcon},_.createElement("div",null,this.renderAppLogo(),T,_.createElement("div",{className:i.secondarySection},d),u)),this.props.children)),this.state.workloadNameToShowInMissingWorkloadErrorDialog&&_.createElement(Ie,{dialogClassName:"workloadErrorDialog",dialogContainerClassName:le.bI,dialogContentClassName:le.vt,workloadName:this.state.workloadNameToShowInMissingWorkloadErrorDialog,onDismiss:this.closeWorkloadErrorDialog.bind(this),theme:this.props.theme}))}renderPrimaryIconSection(){return this.props.hideTitleSection?null:_.createElement(_n,{hideBadgeIcon:this.props.hideBadgeIcon,badgeIconAriaLabel:this.props.callbacks.getBadgeIconAriaLabel?.(),imageSource:this.props.imageSource,isIconCircular:this.props.isIconCircular,titleText:this.props.plan.title,planMembers:this.props.planMembers??[],planContainer:this.props.planContainer??null,sensitivityLabels:this.props.sensitivityLabels??null,hasSharedContainers:this.props.plan.sharedWithContainers.length>0,theme:this.props.theme})}renderAppLogo(){return this.props.showAppLogo?_.createElement("div",{className:this.getClassNames().appLogo},_.createElement("img",{src:Zn,alt:"",role:"presentation"})):null}renderToggleFavoriteButton(){const{isCurrentPlanFavorite:e,theme:t}=this.props,r=e?tt.z$:tt.XR,n=e?Ee.p.Strings.PlanHeader_PlanHeaderRemovePinned:Ee.p.Strings.PlanHeader_PlanHeaderAddPinned;return _.createElement(Dn.K,{onClick:this.toggleFavoriteButtonClick,className:"toggleFavoriteIcon",iconProps:r,title:n,ariaLabel:n,plannerTheme:t,styles:We(t)})}renderPrimaryTextSection(){const{hideTitleSection:e,plan:t}=this.props;if(e)return null;const r=t.title;return _.createElement(zn.g,{onClickTitleButton:this.props.callbacks.onClickTitleButton,titleButtonAriaLabel:Pt.G(Ee.p.Strings.PlanHeader_PlanTitleButtonAriaLabel,r),titleText:r,theme:this.props.theme})}renderBreadcrumbSection(){const{contextDropdownProps:e,hideBreadcrumbMenu:t}=this.props;if(t||e&&e.visibleContextKeys.length>0)return null;const r=this.getBreadcrumbItemsInfo();if(ge()(r))return _.createElement("div",{className:"fallbackContextInfoText"},this.fallbackContextInfoProvider());const n=e?.visibleContextKeys&&e.visibleContextKeys.length>0?1:void 0;return _.createElement(Pe.Q,{items:r??[],className:"headerBreadCrumb",maxDisplayedItems:n,overflowAriaLabel:Ee.p.Strings.PlanHeader_BreadcrumbButtonOverflowAriaLabel,role:void 0,styles:Ge(this.props.theme)})}renderLinkedSection(e){const{contextDropdownProps:t,theme:r}=this.props;if(t&&t.visibleContextKeys.length>0){const n=_.createElement("span",{title:Ee.p.Strings.PlanContextLinking_MultipleLinkedContextsAriaLabel},Ee.p.Strings.PlanContextLinking_LinkedPlanBreadCrumbText),o=this.renderDelinkSection();return _.createElement(vt,{...t,className:e.linkedBadgeDropdown,isBeakVisible:!0,onRenderLabel:t=>_.createElement("div",{className:e.linkedBadgeItem},n,o),theme:r})}return null}renderDelinkSection(){const{contextDropdownProps:e}=this.props;if(e&&e.visibleContextKeys.length>0){const t=e.contextDetails;if(!t)return null;if(null!=Qn()(t,e=>e.status===yt.$.Delinked))return _.createElement("div",{className:"delinkIcon"},_.createElement(xe.I,tt.Zl),_.createElement(xe.I,tt.aA))}return null}renderSecondaryIconSection(){const e=Ee.p.Strings.PlanHeader_OpenDocumentInNewWindow;return _.createElement("button",{className:"secondaryIconSection",onClick:()=>{this.openOriginalDocument(this.props.plan)},"aria-label":e,title:e},_.createElement(xe.I,tt.XL))}renderPivotsSection(e){const{hidePlanNavLinks:t}=this.props;return t?null:_.createElement("div",{className:e.pivotsSection},_.createElement(Ye,{pivotLinks:this.getPrimaryPagePivotLinksInfo(),selectedPivotLinkIndex:this.findSelectedIndex(),onSelectPivotLink:this.onClickHeaderPivotLink,renderTeamsPivotSection:this.props.renderTeamsPivotSection,theme:this.props.theme}),!this.props.renderTeamsPivotSection&&_.createElement(rt,{moreOptionsContextMenuItems:this.getSecondaryLinksContextMenuInfo(),onOpenLinksContextMenu:this.props.callbacks.onOpenLinksContextMenu,moreOptionsTooltip:Ee.p.Strings.PlanHeader_MoreText,theme:this.props.theme,headerMoreOptionsButtonRef:this.headerMoreOptionsButtonRef}))}renderRightSection(e){const{planContainer:t,containerPermissions:r,userPermissions:n}=this.props;let o=!1;if(t?.containerType===pe.K.Group){const e=t;o=null!=e.unifiedGroupDetails&&e.unifiedGroup.visibility===ue.X.Public}const s=!this.isUserCurrentGroupMembership()&&o&&_.createElement("div",{className:"joinUnifiedGroup"},_.createElement(K.j,{className:"joinUnifiedGroupButton",onClick:this.props.callbacks.joinGroup.bind(this)},Ee.p.Strings.PlannerHeader_JoinUnifiedGroupButtonLabel)),i=null!=this.props.planMembers&&!this.props.hideMembers,a={assignmentFilterOptions:{renderSection:!0},bucketFilterOptions:{renderSection:!ge()(this.props.planBuckets)},dueDateFilterOptions:{renderSection:!0,renderFutureOption:!0,renderLateOption:!0,renderNextWeekOption:!0,renderThisWeekOption:!0,renderTodayOption:!0,renderTomorrowOption:!0,renderNoDateOption:!0,renderSomeDateOption:!1},labelFilterOptions:{renderSection:!0},priorityFilterOptions:{renderSection:!0,renderUrgentOption:!0,renderImportantOption:!0,renderMediumOption:!0,renderLowOption:!0},progressFilterOptions:{renderSection:!0,renderCompleteOption:!0,renderInProgressOption:!0,renderNotStartedOption:!0}};return _.createElement("div",{className:e.rightAlignedSection},s,i&&this.renderFacepile(),_.createElement(bn,{renderContextDropdown:!0,renderMembersDropdown:i,contextMenuProps:this.props.contextDropdownProps,membersDropdownProps:{canUserAddGuests:n?.canAddGuests,canUserViewMembers:r?.canViewMembers,canUserAddMembers:r?.canAddMembers,canUserRemoveMembers:r?.canRemoveMembers,sharedContainersListProps:this.props.sharedContainersListProps,isMembersCalloutVisible:this.state.isMembersCalloutVisible,toggleMembersCallout:this.toggleMembersCallout,dismissMembersCallout:this.dismissMembersCallout},filtersDropdownProps:{currentTaskFilter:this.props.currentTaskFilter,filterOptions:a,isFilterCalloutVisible:this.props.isFilterCalloutVisible,taskData:this.props.taskData,buckets:this.props.planBuckets,planCategories:this.props.planCategories},groupByDropdownProps:{showGroupByMenuTitleValue:this.props.showGroupByMenuTitleValue,currentTaskGrouping:this.props.currentTaskGrouping,taskGroupingOptions:this.props.taskGroupingOptions},members:this.props.planMembers,callbacks:this.props.callbacks,theme:this.props.theme}),this.renderAppMoreOptionsButton())}renderFacepile(){const{callbacks:e,planMembers:t}=this.props;return null==t||ge()(t)?null:_.createElement(xn,{members:t,getUserPhoto:e.getUserPhoto,toggleMembersCallout:this.toggleMembersCallout,onRenderPersona:e.onRenderPersona,highlightTasks:e.highlightTasks,theme:this.props.theme})}renderAppMoreOptionsButton(){if(null==this.props.callbacks.openAppAboutDialog)return null;const e=_.createElement(Xe.l,{appTheme:this.props.theme,items:[{key:"about",name:Ee.p.Strings.SharedComponents_TeamsHeader_About,onClick:this.props.callbacks.openAppAboutDialog}],target:this.moreButtonRef,onDismiss:this.closeAppMoreOptionsContextMenu});return _.createElement("div",{className:this.getClassNames().appMoreOptionsButton},_.createElement(Dn.K,{plannerTheme:this.props.theme,elementRef:this.moreButtonRef,iconProps:tt.XP,onClick:this.toggleAppMoreOptionsContextMenu,title:Ee.p.Strings.SharedComponents_MoreButtonTooltipText,ariaLabel:Ee.p.Strings.SharedComponents_MoreButtonTooltipText}),this.state.isAppMoreOptionsContextMenuVisible&&e)}getPrimaryPagePivotLinksInfo(){const{isTimelineVisible:e,showGoToProject:t}=this.props,r=[];return r.push({id:p.EC.PlanGrid,name:Ee.p.Strings.SharedComponents_PlanGridPageName,iconProps:tt.Dz}),r.push({id:p.EC.PlanTaskboard,name:Ee.p.Strings.SharedComponents_PlanTaskboardPageName,iconProps:tt.fD}),r.push({id:p.EC.PlanCharts,name:Ee.p.Strings.SharedComponents_PlanChartsPageName,iconProps:tt.V1}),r.push({id:p.EC.PlanSchedule,name:Ee.p.Strings.SharedComponents_PlanSchedulePageName,iconProps:tt.cx}),e&&r.push({id:p.EC.PlanTimeline,name:t?Ee.p.Strings.SharedComponents_PlanProjectPageName:Ee.p.Strings.SharedComponents_PlanTimelinePageName,iconProps:tt.aM,alwaysShowIcon:!0}),r}getSpoWorkloadUrl(e,t){const{sharepointDomainUrl:r}=this.props;return Pt.G(c.Lf.SharepointWorkloadUrlFormat,r,e,t)}getSecondaryLinksContextMenuInfo(){const{callbacks:e,disableMode:t,flights:r,isCurrentPlanFavorite:n,plan:o,planContainer:s,planMembers:i,sharepointDomainUrl:a,hasAccessViaSharedContainer:l,showCopyPlanToProjectLink:p}=this.props;if(this.props.hideSecondaryLinksContextMenu||null==s||ae.B.clientType===u.s.SharepointApp)return[];const d=[];if(t!==be.DisableAll&&null!=o&&s.containerType===pe.K.User){const e=ie.getLinksCapabilitiesForPlan(s,i.length,o.container.containerType,l);if(ke(e,se.EnableFavorite)){const e=n?Ee.p.Strings.PlanHeader_PlanHeaderRemovePinned:Ee.p.Strings.PlanHeader_PlanHeaderAddPinned;d.push({key:"ToggleFavorite",name:e,onClick:this.togglePlanFavorite.bind(this)})}return ke(e,se.EnableCopyLink)&&d.push({key:"copyLinkToPlan",name:Ee.p.Strings.PlanHeader_CopyLinkToPlanText,onClick:this.onClickCopyLinkToPlan.bind(this)}),ke(e,se.EnableSettings)&&t===be.DisableNothing&&d.push({key:"PlanSettings",name:Ee.p.Strings.PlanHeader_PlanHeaderPlanSettings,onClick:()=>this.openPlanSettingsPanel(o.id,this.headerMoreOptionsButtonRef.current??void 0)}),d}const h=ie.getLinksCapabilitiesForContainer(s);if(Ce(h,oe.EnableYammer)&&d.push({key:"Yammer",name:Ee.p.Strings.PlanHeader_PlanHeaderWorkloadYammer,onClick:this.handleWorkloadNavigation.bind(this,De.P[De.P.Yammer])}),Ce(h,oe.EnableConversations)&&d.push({key:"Conversations",name:Ee.p.Strings.PlanHeader_PlanHeaderWorkloadConversation,onClick:()=>{a?this.openLink(this.getSpoWorkloadUrl(s.externalId,De.P[De.P.Conversations]),"navigateToWorkloadConversations"):(this.context.traceLogger.logTrace(508036125,B.k.Warning,"SharepointDomainUrl is not available"),this.handleWorkloadNavigation(De.P[De.P.Conversations]))}}),Ce(h,oe.EnableMembers)&&d.push({key:"Members",name:Ee.p.Strings.PlanHeader_PlanHeaderWorkloadMembers,onClick:()=>{a?this.openLink(this.getSpoWorkloadUrl(s.externalId,"Members"),"navigateToWorkloadPeople"):(this.context.traceLogger.logTrace(508036124,B.k.Warning,"SharepointDomainUrl is not available"),this.handleWorkloadNavigation(De.P[De.P.People]))}}),Ce(h,oe.EnableFiles)&&d.push({key:"Files",name:Ee.p.Strings.PlanHeader_PlanHeaderWorkloadFiles,onClick:()=>{a?this.openLink(this.getSpoWorkloadUrl(s.externalId,De.P[De.P.Documents]),"navigateToWorkloadDocuments"):this.handleWorkloadNavigation(De.P[De.P.Documents])}}),Ce(h,oe.EnableNotebook)&&d.push({key:"Notebook",name:Ee.p.Strings.PlanHeader_PlanHeaderWorkloadNotebook,onClick:()=>{a?this.openLink(this.getSpoWorkloadUrl(s.externalId,De.P[De.P.Notebook]),"navigateToWorkloadNotebook"):this.handleWorkloadNavigation(De.P[De.P.Notebook])}}),Ce(h,oe.EnableSites)&&d.push({key:"Sites",name:Ee.p.Strings.PlanHeader_PlanHeaderWorkloadSites,onClick:()=>{this.openLink(Pt.G(c.Lf.SharepointSiteUrlFormat,a,s?.externalId),"navigateToWorkloadSites")}}),ge()(d)||d.push({key:"divider_1",name:"-",itemType:ye.G.Divider}),t!==be.DisableAll&&null!=o){const a=ie.getLinksCapabilitiesForPlan(s,i.length,o.container.containerType,l);if(ke(a,se.EnableFavorite)){const e=n?Ee.p.Strings.PlanHeader_PlanHeaderRemovePinned:Ee.p.Strings.PlanHeader_PlanHeaderAddPinned;d.push({key:"ToggleFavorite",name:e,onClick:this.togglePlanFavorite.bind(this)})}if(ke(a,se.EnableCopy)&&null!=e.onClickCopyPlan&&t===be.DisableNothing&&d.push({key:"CopyPlan",name:Ee.p.Strings.PlanHeader_CopyPlanText,onClick:()=>e.onClickCopyPlan(o.id)}),p&&d.push({key:"CopyPlanToProject",name:Ee.p.Strings.PlanHeader_CopyPlanToProjectText,onClick:()=>this.openLink((0,Jn.lo)(o.id),"navigateToImportPlanInProject")}),ke(a,se.EnableExport)&&this.showExportPlanToExcel()&&d.push({key:"ExportPlanToExcel",name:Ee.p.Strings.PlanHeader_PlanHeaderExportPlanToExcel,onClick:()=>e.onClickExportPlanToExcel(o.id)}),ke(a,se.EnableCopyLink)&&d.push({key:"copyLinkToPlan",name:Ee.p.Strings.PlanHeader_CopyLinkToPlanText,onClick:this.onClickCopyLinkToPlan.bind(this)}),ke(a,se.EnableSettings)&&t===be.DisableNothing&&d.push({key:"PlanSettings",name:Ee.p.Strings.PlanHeader_PlanHeaderPlanSettings,onClick:()=>this.openPlanSettingsPanel(o.id,this.headerMoreOptionsButtonRef.current??void 0)}),ke(a,se.EnableCalendar)&&null!=r&&r.ICalendar){const e=this.getCalendarLink();null!=e&&d.push(e)}ke(a,se.EnableLeave)&&d.push({key:"LeavePlan",name:Ee.p.Strings.PlanHeader_PlanHeaderLeavePlan,onClick:()=>this.openLeavePlanDialog(o.id)}),ke(a,se.EnableJoin)&&d.push({key:"Join",name:Ee.p.Strings.PlanHeader_PlanHeaderJoin,onClick:e.joinGroup.bind(this)})}return d}getCalendarLink(){const{callbacks:e,plan:t,planContainer:r,planDetails:n,userOutlookCalendarUrlToPublishTasks:o}=this.props;let s=null;return r?.containerType===pe.K.Group&&(s=r.unifiedGroupDetails)?s?.currentUserRelationToGroup===de.N.Owner?{key:"AddPlanToCalendar",name:Ee.p.Strings.PlanHeader_PublishPlanTasksToCalendar,onClick:e.openTasksICalendarDialog.bind(this,t.id)}:n&&s?.currentUserRelationToGroup===de.N.Member&&n.iCalendarPublishEnabled&&o?{key:"AddPlanToCalendar",name:Ee.p.Strings.PlanHeader_PublishPlanTasksToCalendar,onClick:()=>{this.context.usageLogger.logData("PlanHeader","publishPlanTasksToOutlookCalendar ",{planID:t.id}),Yn.b.safelyOpenExternalUrl(o,"_blank")}}:null:{key:"AddPlanToCalendar",name:Ee.p.Strings.PlanHeader_PublishPlanTasksToCalendar,onClick:e.openTasksICalendarDialog.bind(this,t.id)}}togglePlanFavorite(){const{callbacks:e,isCurrentPlanFavorite:t}=this.props;this.logUsage(t?h.M.RemoveFromFavorite:h.M.AddToFavorite),e.updatePlanFavoriteStatus(!t)}getBreadcrumbItemsInfo(){const{callbacks:e,flights:t,plan:r,planContainer:n}=this.props,o=(0,me.g)(r.contexts);if(n?.containerType!==pe.K.DriveItem&&ge()(o))return;const s=n?.displayName??"",i=[];if(t.EnableDocumentTasks&&n?.containerType===pe.K.DriveItem&&null!==e.getBreadcrumbUrl(n?.externalId))i.push({key:"DocPlanBreadcrumb",text:r.title,onClick:()=>this.openOriginalDocument(r)});else if(null!=o){const e=r.contexts[o],t=(0,ft.e)(e,s);St()(t,(e,t)=>{i.push({key:e+t,text:e})})}return i}findSelectedIndex(){const e=this;return pn()(this.getPrimaryPagePivotLinksInfo(),t=>t.id===e.props.currentPage)}isUserCurrentGroupMembership(){const{planContainer:e}=this.props;if(e?.containerType!==pe.K.Group)return!1;const t=e;return!(!t.unifiedGroup||!t.unifiedGroupDetails)&&t.unifiedGroupDetails.currentUserRelationToGroup!==de.N.NonMember}handleWorkloadNavigation(e){if(this.props.planContainer?.containerType!==pe.K.Group)return;const t=this.props.planContainer,r=t.unifiedGroupDetails?.getWorkloadUrl(e);this.context.traceLogger.logTrace(508036123,B.k.Info,`Workload navigation [Name=${e}][HasUrl=${!!r}]`),r?this.openLink(r,"navigateToWorkload"+e):this.showWorkloadErrorDialog(e)}openLink(e,t){this.logUsage(t),Yn.b.safelyOpenExternalUrl(e,"_blank")}openOriginalDocument(e){const t=this.props.callbacks.getBreadcrumbUrl(e.container.externalId);return t&&this.openLink(t,"openOriginalDocument")}showWorkloadErrorDialog(e){this.setState(t=>({workloadNameToShowInMissingWorkloadErrorDialog:e}))}closeWorkloadErrorDialog(){this.setState(e=>({workloadNameToShowInMissingWorkloadErrorDialog:null}))}onClickCopyLinkToPlan(){const{callbacks:e,plan:t}=this.props,r={planId:t.id};this.logUsage("copyPlanLinkPlanHeader",r),e.copyLinkToPlan(t.id)}showExportPlanToExcel(){const{callbacks:e,disableMode:t}=this.props,r=t===be.DisableNothing,n=null!=e.onClickExportPlanToExcel;return r&&n}constructor(e,t){super(e,t),this.moreButtonRef=_.createRef(),this.fallbackContextInfoProvider=()=>{const{planContainer:e,sensitivityLabels:t}=this.props;let r="";if(e?.containerType===pe.K.Group){const n=e;n.unifiedGroup&&(r=n.unifiedGroup.getDetailedInfo(t))}return r},this.toggleFavoriteButtonClick=()=>{this.logUsage(this.props.isCurrentPlanFavorite?h.M.RemoveFromFavorite:h.M.AddToFavorite),this.togglePlanFavorite()},this.dismissMembersCallout=()=>{this.setState(e=>({isMembersCalloutVisible:!1}))},this.toggleMembersCallout=()=>{this.setState(e=>{const t=!e.isMembersCalloutVisible;return t&&this.onOpenMembersCallout(),{isMembersCalloutVisible:t}})},this.toggleAppMoreOptionsContextMenu=()=>{this.setState(e=>({isAppMoreOptionsContextMenuVisible:!e.isAppMoreOptionsContextMenuVisible}))},this.closeAppMoreOptionsContextMenu=()=>{this.setState({isAppMoreOptionsContextMenuVisible:!1})},this.onClickHeaderPivotLink=e=>{const{callbacks:t}=this.props;switch(this.logUsage(e.id+"Clicked"),e.id){case p.EC.PlanTaskboard:t.navigateToPage(p.EC.PlanTaskboard);break;case p.EC.PlanCharts:t.navigateToPage(p.EC.PlanCharts);break;case p.EC.PlanSchedule:t.navigateToPage(p.EC.PlanSchedule);break;case p.EC.PlanGrid:t.navigateToPage(p.EC.PlanGrid);break;case p.EC.PlanTimeline:this.logUsage(h.M.PlanTimelineViewClicked),t.navigateToPage(p.EC.PlanTimeline)}},this.state={workloadNameToShowInMissingWorkloadErrorDialog:null,isMembersCalloutVisible:!1,isAppMoreOptionsContextMenuVisible:!1}}}var $n=r(96426),eo=r(93589),to=r(42463),ro=r(40488),no=r(57433),oo=r(11660),so=r(48709);const io=(0,j.J9)(e=>{let t="";switch(e){case le.Sx.Dark:t=Ne.z.NeutralPrimaryAlt;break;case le.Sx.Light:t=Ne.z.NeutralLighter;break;case le.Sx.TeamsLight:t=Ne.z.White;break;case le.Sx.TeamsDark:t=Ne.z.Black;break;case le.Sx.TeamsContrast:t=so.kd.gray150}return{backgroundColor:t}}),ao=(0,j.J9)(e=>{let t="";switch(e){case le.Sx.Dark:t=Ne.z.FontColorThemeLight;break;case le.Sx.Light:case le.Sx.TeamsLight:t=Ne.z.FontColorThemeDark;break;case le.Sx.SharePoint:t=Ne.z.SharepointButtonHoverColor();break;case le.Sx.TeamsDark:case le.Sx.TeamsContrast:t=Ne.z.White}return{color:t}}),lo=(0,j.J9)((e,t)=>({root:[(0,Le.gS)("row","nowrap"),{position:"relative"},e===le.Sx.TeamsLight&&{background:t?Re.B.HeaderlessTeamsBackgroundColor:Ne.z.TeamsLightBackgroundColor},e===le.Sx.TeamsDark&&{background:Ne.z.TeamsDarkBackgroundColor},e===le.Sx.TeamsContrast&&{backgroundColor:Ne.z.Black},e===le.Sx.SharePoint&&{background:Ne.z.SharepointBackgroundColor()}],background:[(0,Le.GD)(),(0,Le.gS)("row","nowrap"),Le.cc],columns:[(0,Le.gS)("row","nowrap"),(0,Le.$Z)(),{alignItems:"flex-start"}],column:[(0,Le.GD)("276px"),(0,Le.gS)("column","nowrap"),{alignItems:"stretch",width:"276px",margin:"0px 15px"}],addTaskButtonShadow:[io(e),e===le.Sx.SharePoint&&{border:"1px solid "+Ne.z.SharepointTextFontColor()},{marginBottom:"15px",height:"40px"}],taskCardShadow:[io(e),e===le.Sx.SharePoint&&{border:"1px solid "+Ne.z.SharepointTextFontColor()},{marginTop:"7px",height:"98px"}],foreground:[(0,Le.gS)("column","nowrap"),Le.cc,{position:"absolute",top:0,left:0,right:0,bottom:0}],mainText:[ao(e),{fontSize:Q.s.xxLarge,fontWeight:Q.BO.semibold,marginBottom:"7px"}],subText:[ao(e),{fontSize:Q.s.mediumPlus,fontWeight:Q.BO.semibold,marginBottom:"10px"}]})),co=(0,j.J9)((e,t)=>{const r=lo(e,t);return{root:(0,Q.Zq)("planCreationInProgressView",r.root),background:(0,Q.Zq)("background",r.background),columns:(0,Q.Zq)("columns",r.columns),column:(0,Q.Zq)("column",r.column),addTaskButtonShadow:(0,Q.Zq)("addTaskButtonShadow",r.addTaskButtonShadow),taskCardShadow:(0,Q.Zq)("taskCardShadow",r.taskCardShadow),foreground:(0,Q.Zq)("foreground",r.foreground),mainText:(0,Q.Zq)("mainText",r.mainText),subText:(0,Q.Zq)("subText",r.subText)}});class po extends ce.${name(){return"PlanCreationInProgressView"}renderComponent(){const e=this.getClassNames();return _.createElement("div",{className:e.root},_.createElement("div",{className:e.background},_.createElement("div",{className:e.columns},_.createElement("div",{className:e.column},_.createElement("div",{className:e.addTaskButtonShadow}),_.createElement("div",{className:e.taskCardShadow})),_.createElement("div",{className:e.column},_.createElement("div",{className:e.addTaskButtonShadow}),_.createElement("div",{className:e.taskCardShadow}),_.createElement("div",{className:e.taskCardShadow}),_.createElement("div",{className:e.taskCardShadow})),_.createElement("div",{className:e.column},_.createElement("div",{className:e.addTaskButtonShadow}),_.createElement("div",{className:e.taskCardShadow}),_.createElement("div",{className:e.taskCardShadow})))),_.createElement("div",{className:e.foreground},_.createElement("div",{className:e.mainText},Ee.p.Strings.PlanCreationInProgressView_MainText),_.createElement("div",{className:e.subText},Ee.p.Strings.PlanCreationInProgressView_SubText),_.createElement(K.j,{className:"redirectButton",onClick:()=>this.props.onClickNavigateToHub()},Ee.p.Strings.PlanCreationInProgressView_ReturnToHubButtonText)))}getClassNames(){const{theme:e}=this.props;return co(e,ae.B.headerlessMode)}constructor(e,t){super(e,t)}}class uo extends ce.${name(){return"PlaceholderHeader"}renderComponent(){const e=this.getResponsiveHeaderClassNames(),t=["",e.hidePersonas,e.hideTitle,e.hidePivotText,e.hideDropdownText];return _.createElement(An,{sizeClasses:t,isAdditive:!0,className:this.getClassNames().root})}getClassNames(){return Ve(He(this.props.theme,this.props.topHeaderStyles))}getResponsiveHeaderClassNames(){return qn(Kn())}constructor(e,t){super(e,t)}}var ho=r(80708),go=r(56128),mo=r(42870),Co=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ko=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.perfActionCreator=n.props.perfActionCreator,n.pageReadyActionDispatched=!1,n.dataFetchStartTime=(new Date).getTime(),n}return Co(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this.trySendPageReadyAction()},t.prototype.componentDidUpdate=function(t,r){e.prototype.componentDidUpdate.call(this,t,r),this.setTitle()},t.prototype.storeDidUpdate=function(){e.prototype.storeDidUpdate.call(this),this.trySendPageReadyAction()},t.prototype.getPageReadyExportName=function(){},t.prototype.getPageTitle=function(){return""},t.prototype.getPageReadyMetaTag=function(){},t.prototype.getPageReadyLoggingData=function(){},t.prototype.setTitle=function(){var e=this.getPageTitle();e&&(document.title=e)},t.prototype.trySendPageReadyAction=function(){!1===this.pageReadyActionDispatched&&this.checkForCriticalDataReady()&&(this.pageReadyActionDispatched=!0,this.perfActionCreator.pageReady(this.dataFetchStartTime,(new Date).getTime(),this.getPageReadyExportName(),this.getPageReadyMetaTag(),this.getPageReadyLoggingData()))},t}(mo.M),bo=r(56953);class To extends ko{logUsage(e,t,r){this.props.loggers.usageLogger.logData(this.name(),e,t,r)}logError(e,t,r){bo.v.logError(e,t,r,this.props.loggers.logHandler)}storeDidUpdate(){fn()(super.storeDidUpdate,le.c9.StoreUpdateThrottleThreshold).bind(this)()}async fetchCriticalData(e,t){(await e.viewActionCreatorProvider()).fetchViewData(e.viewPartitionKey)}fetchNonCriticalData(e,t){this.onViewCriticalDataFetchCompletion()}checkForCriticalDataReady(){const e=this.checkForCriticalViewDataReady();return e&&this.onViewCriticalDataFetchCompletion(),e}fetchCriticalDataWhenComponentDidUpdate(e,t){return super.fetchCriticalDataWhenComponentDidUpdate(e,t),this.props.viewPartitionKey!==e.viewPartitionKey}fetchNonCriticalDataWhenComponentDidUpdate(e,t){return super.fetchNonCriticalDataWhenComponentDidUpdate(e,t),this.props.viewPartitionKey!==e.viewPartitionKey}notifyInteractive(e){this.props.onPageInteractive?.(e)}getViewContext(){const{viewStore:e,viewPartitionKey:t}=this.props;return e.getViewContext(this.taskAccessContext,t)}async onSetLabelsCollapsedStateForView(e){const{viewPartitionKey:t,actionCreatorProviders:r}=this.props;(await r.viewTransformsActionCreator()).setCategoryLabelMode(this.taskAccessContext,e,t)}constructor(){super(...arguments),this.onCriticalDataReadyDispatched={},this.onViewCriticalDataFetchCompletion=async()=>{const{viewPartitionKey:e,viewActionCreatorProvider:t}=this.props;if(!this.onCriticalDataReadyDispatched[e]){this.onCriticalDataReadyDispatched[e]=!0;(await t()).onCriticalDataFetchCompletion(e),this.notifyInteractive()}},this.getTaskPermissions=e=>{const t=this.props.planStore.getPlan(e.planId);return this.props.permissionsStore.getTaskPermissions(e,t)},this.completedTaskClassifier=e=>e.isComplete(),this.onFilterMenuVisibleChange=e=>{this.setState({isFilterMenuVisible:e})},this.onUpdateTask=async(e,t)=>{this.props.loggers.usageLogger.logData(this.name(),h.M.TaskUpdated,{taskCreationSourceType:e.taskCreationSourceType??""});(await this.props.actionCreatorProviders.taskActionCreator()).updateTask(ho.F.builder.withTask(e).build(),ho.F.builder.withTask(t).build())},this.onUpdateTaskDetails=async(e,t)=>{(await this.props.actionCreatorProviders.taskActionCreator()).updateTaskDetails(e,t)},this.onUpdatePlanDetails=async(e,t)=>{(await this.props.actionCreatorProviders.planActionCreator()).updatePlanDetails(e,t)},this.onDeleteTask=async e=>{const t=this.props.taskStore.getTask(e),r=await this.props.actionCreatorProviders.taskActionCreator();t&&r.deleteTask(e,t.itemVersion)},this.onDeleteRecurringTaskClick=async(e,t)=>{(await this.props.actionCreatorProviders.dialogActionCreator()).openDeleteRecurringTaskDialog(e,t)},this.onOpenTaskDetailsEditor=async(e,t)=>{const{appContextStore:r,actionCreatorProviders:n,userStore:o,flights:s,taskStore:i}=this.props;(await n.dialogActionCreator()).openTaskDetails(e,this.taskAccessContext,t);const a=o.getUserDetailsById(r.getCurrentUserId());if(null==a)return;let l=!1;if(s.EnablePalauCoachmark){const t=i.getTask(e);l=t?.isProjectTask()??!1}if(!l&&!a.getHasSeenTaskDetails()&&ae.B.clientType!==u.s.Loop){(await n.walkthroughActionCreator()).setTeachingCallout(a,le.Ox.TaskDetails,null,null)}},this.onRenderPersona=async e=>{const t=this.props.userStore.getUserPhotoById(e.id);if(!t||t===le.S1.Photo){(await this.props.actionCreatorProviders.userActionCreator()).fetchUserPhoto(e)}},this.onShowAssigneeLimitError=async e=>{(await this.props.actionCreatorProviders.dialogActionCreator()).openAssigneeLimitErrorDialog(e)},this.onGroupByChange=async e=>{(await this.props.actionCreatorProviders.viewTransformsActionCreator()).setTaskGroupingState(this.taskAccessContext,e)},this.onFilterChange=async(e,t,r,n)=>{(await this.props.actionCreatorProviders.viewTransformsActionCreator()).setTaskFilter(this.getViewKey(),e,t,r,n)},this.getViewKey=()=>`${this.taskAccessContext}_${this.props.viewPartitionKey}`,this.onCopyTaskClick=async(e,t)=>{(await this.props.actionCreatorProviders.dialogActionCreator()).openCopyTaskDialog(e,t)},this.onMoveTaskClick=async(e,t)=>{(await this.props.actionCreatorProviders.dialogActionCreator()).openMoveTaskDialog(e,t)},this.onAssignTask=async(e,t,r,n)=>{const{taskStore:o,appContextStore:s,actionCreatorProviders:i,viewPartitionKey:a}=this.props;if(null==e||""===e)return;let l=o.getTask(t);null==l&&(l=(0,hr.YO)(t,a));const c=l.getClone();c&&(c.assignments[e]=new go.I(s.getCurrentUserId(),new Date));(await i.taskActionCreator()).assignTask({userId:e,originalTask:l,updatedTask:c,elementToFocusOnDismiss:r,onAssignSuccess:n})},this.onOpenAssignCallout=async e=>{const{planStore:t,userStore:r,actionCreatorProviders:n,groupDocumentsStore:o}=this.props,s=t.getPlan(e);if(null!=s){if(null==r.getContainerUsers(s.container.externalId)){(await n.userActionCreator()).fetchUsersForContainer(s.container)}if(null!=s.sharedWithContainers)for(const e of s.sharedWithContainers)if(e.containerType===pe.K.DriveItem&&null==o.getDriveItem(e.externalId)){(await n.groupDocumentsActionCreator()).fetchDriveItem(e.externalId)}}},this.getAssigneePool=e=>{const{taskStore:t,planStore:r,userStore:n}=this.props,o=t.getTask(e),s=o?r.getPlan(o.planId):null,i=s?.container;return i?n.getContainerUsers(i.externalId)??[]:[]},this.canUserAccessPlanViaSharedContainerOnly=e=>{const{permissionsStore:t,planStore:r}=this.props,n=r.getPlan(e);return null!=n&&(t.canAccessPlanViaSharedContainers(n.sharedWithContainers)&&!t.canAccessPlanViaHostContainer(n))},this.onDeleteBucket=async e=>{const{actionCreatorProviders:t,bucketStore:r,viewPartitionKey:n}=this.props,o=await t.bucketActionCreator();if("null"===e)o.deleteBucket(c.iR+n,"");else{const t=r.getBucket(e);o.deleteBucket(e,t?t.itemVersion:"")}},this.fetchReferencePreviewForTask=async e=>{(await this.props.actionCreatorProviders.taskActionCreator()).fetchReferencePreviewForTask(e)},this.onCopyLinkToTask=async e=>{(await this.props.actionCreatorProviders.taskActionCreator()).copyLinkToTask(e)},this.showInfoBanner=async e=>{(await this.props.actionCreatorProviders.notificationActionCreator()).showInfo(e)},this.alertUser=async(e,t,r)=>{(await this.props.actionCreatorProviders.notificationActionCreator()).enqueueHiddenToast(e,t,r)},this.getUsersWithKeyword=async e=>(await this.props.actionCreatorProviders.userActionCreator()).fetchUsersWithKeyword(e),this.navigateToPage=async(e,t,r,n)=>{(await this.props.actionCreatorProviders.navigationActionCreator()).navigate(e,t,r,n)},this.fetchPermissionsWithTaskContext=async e=>{(await this.props.actionCreatorProviders.containerActionCreator()).fetchPermissionsWithTaskContext(e)}}}const So=(0,j.J9)((e,t)=>{const r={root:[(0,Le.gS)("column","nowrap"),(0,Le.$Z)(Re.B.TopHeaderHeight),{padding:`${Re.B.TopHeaderPaddingTop} ${Re.B.TopHeaderHorizontalPadding} ${Re.B.TopHeaderPaddingBottom}`,overflowX:"auto","&.responsive":{overflowY:"hidden"}}],landmark:[(0,Le.gS)("row","nowrap"),{height:"100%"}],leftAlignedSection:[(0,Le.gS)("row","nowrap"),{alignItems:"center","> .primaryTextSection":{marginLeft:"12px",maxWidth:"220px"}}],rightAlignedSection:[(0,Le.GD)("auto"),(0,Le.gS)("row","nowrap"),{alignItems:"center","> div:first-child":{flexGrow:"1",flexShrink:"0",justifyContent:"flex-end"}}]};return(0,Q.TW)(r,t)}),Po=(0,j.J9)(e=>({root:(0,Q.Zq)("LoopPlanHeader",e.root),landmark:(0,Q.Zq)("LoopPlanHeaderLandmark",e.landmark),leftAlignedSection:(0,Q.Zq)("leftAlignedSection",e.leftAlignedSection),rightAlignedSection:(0,Q.Zq)("rightAlignedSection",e.rightAlignedSection)}));class xo extends Se{name(){return"LoopPlanHeader"}getClassNames(){return Po(So(this.props.theme,this.props.styles))}getResponsiveHeaderClassNames(){return qn(Kn())}renderComponent(){const{contextDropdownProps:e,imageSource:t,isIconCircular:r,hideBadgeIcon:n,showGroupByMenuTitleValue:o,currentTaskGrouping:s,taskGroupingOptions:i,currentTaskFilter:a,plan:l,planBuckets:c,planCategories:p,isFilterCalloutVisible:d,sharedContainersListProps:u,renderContextDropdown:h,renderMembersDropdown:g,callbacks:m,planMembers:C,planContainer:k,sensitivityLabels:b,userPermissions:T,containerPermissions:S,theme:P}=this.props,x=this.getClassNames(),y=this.getResponsiveHeaderClassNames(),f=["",y.hidePivotText,y.hideDropdownText,y.hideTitle],v=l.title;return _.createElement(fe.$,{planContainerId:l.id,onRender:m.onRenderPlanPhoto},_.createElement(An,{sizeClasses:f,isAdditive:!0,className:x.root},_.createElement(wn.H,{className:x.landmark,role:"banner"},_.createElement("div",{className:x.leftAlignedSection},_.createElement(_n,{badgeIconAriaLabel:m.getBadgeIconAriaLabel?.(),hideBadgeIcon:n,imageSource:t,isIconCircular:r,titleText:l.title,planMembers:C,planContainer:k??null,sensitivityLabels:b??null,hasSharedContainers:l.sharedWithContainers.length>0,theme:P}),_.createElement(zn.g,{onClickTitleButton:m.onClickTitleButton,titleButtonAriaLabel:Pt.G(Ee.p.Strings.PlanHeader_PlanTitleButtonAriaLabel,v),titleText:v,theme:P})),_.createElement("div",{className:x.rightAlignedSection},_.createElement(bn,{renderContextDropdown:h??!0,renderMembersDropdown:g??!0,contextMenuProps:e,membersDropdownProps:{canUserAddGuests:T?.canAddGuests,canUserViewMembers:S?.canViewMembers,canUserAddMembers:S?.canAddMembers,canUserRemoveMembers:S?.canRemoveMembers,sharedContainersListProps:u,isMembersCalloutVisible:this.state.isMembersCalloutVisible,toggleMembersCallout:this.toggleMembersCallout,dismissMembersCallout:this.dismissMembersCallout},filtersDropdownProps:{renderNewFilterMenu:!0,currentTaskFilter:a,buckets:c,planCategories:p,isFilterCalloutVisible:d,taskData:this.props.taskData},groupByDropdownProps:{showGroupByMenuTitleValue:o,currentTaskGrouping:s,taskGroupingOptions:i},members:C,callbacks:m,theme:P}),_.createElement(rt,{moreOptionsContextMenuItems:this.getMoreOptionsMenuItems(),moreOptionsTooltip:Ee.p.Strings.PlanHeader_MoreText,headerMoreOptionsButtonRef:this.headerMoreOptionsButtonRef,theme:P})))))}getMoreOptionsMenuItems(){const{disableMode:e,plan:t,planContainer:r,planMembers:n,hasAccessViaSharedContainer:o}=this.props;if(e===be.DisableAll||null==t)return[];const s=[],i=ie.getLinksCapabilitiesForPlan(r??null,n.length,t.container.containerType,o??!1);return ke(i,se.EnableSettings)&&s.push({key:"PlanSettings",name:Ee.p.Strings.PlanHeader_PlanHeaderPlanSettings,onClick:()=>this.openPlanSettingsPanel?.(t.id,this.headerMoreOptionsButtonRef.current??void 0)}),ke(i,se.EnableLeave)&&s.push({key:"LeavePlan",name:Ee.p.Strings.PlanHeader_PlanHeaderLeavePlan,onClick:()=>this.openLeavePlanDialog?.(t.id)}),s.push({key:"Help",name:Ee.p.Strings.PlanHeader_PlanHeaderHelp,onClick:()=>this.openHelpLink()}),s}constructor(e,t){super(e,t),this.dismissMembersCallout=()=>{this.setState(e=>({isMembersCalloutVisible:!1}))},this.toggleMembersCallout=()=>{this.setState(e=>{const t=!e.isMembersCalloutVisible;return t&&this.onOpenMembersCallout(),{isMembersCalloutVisible:t}})},this.openHelpLink=()=>{Yn.b.safelyOpenExternalUrl(le.$j.usePlannerComponent,"_blank")},this.state={isMembersCalloutVisible:!1}}}var yo=r(24369),fo=r(13706),vo=r(56851),Ao=r(67215),wo={root:"ms-TagItem",text:"ms-TagItem-text",close:"ms-TagItem-close",isSelected:"is-selected"};var Do,Bo=r(15199),Eo=(0,zr.Z)(),Io=(0,Zr.I)(function(e){var t=e.theme,r=e.styles,n=e.selected,o=e.disabled,s=e.enableTagFocusInDisabledPicker,i=e.children,a=e.className,l=e.index,c=e.onRemoveItem,p=e.removeButtonAriaLabel,d=e.title,u=void 0===d?"string"===typeof e.children?e.children:e.item.name:d,h=e.removeButtonIconProps,g=e.removeButtonProps,m=_.createRef(),C=Eo(r,{theme:t,className:a,selected:n,disabled:o}),k=(0,Bo.B)(),b=s?{"aria-disabled":o,tabindex:0}:{disabled:o};return _.createElement("div",{"data-selection-index":l,className:C.root,role:"listitem",key:l,onClick:function(){var e;null===(e=m.current)||void 0===e||e.focus()}},_.createElement("span",{className:C.text,title:u,id:"".concat(k,"-text")},i),_.createElement(fo.K,(0,vo.__assign)({componentRef:m,id:k,onClick:c},b,{iconProps:null!==h&&void 0!==h?h:{iconName:"Cancel"},styles:{icon:{fontSize:"12px"}},className:C.close,"aria-labelledby":"".concat(k,"-removeLabel ").concat(k,"-text")},g)),_.createElement("span",{id:"".concat(k,"-removeLabel"),hidden:!0},p))},function(e){var t,r,n,o,s,i,a=e.className,l=e.theme,c=e.selected,p=e.disabled,d=l.palette,u=l.effects,h=l.fonts,g=l.semanticColors,m=(0,Q.Km)(wo,l);return{root:[m.root,h.medium,(0,Q.gm)(l),{boxSizing:"content-box",flexShrink:"1",margin:2,height:26,lineHeight:26,cursor:"default",userSelect:"none",display:"flex",flexWrap:"nowrap",maxWidth:300,minWidth:0,borderRadius:u.roundedCorner2,color:g.inputText,background:d.neutralLighter,selectors:(t={":hover":[!p&&!c&&{color:d.neutralDark,background:d.neutralLight,selectors:{".ms-TagItem-close":{color:d.neutralPrimary}}},p&&{background:d.neutralLighter}]},t[Q.up]={border:"1px solid ".concat(c?"WindowFrame":"WindowText")},t)},p&&{selectors:(r={},r[Q.up]={borderColor:"GrayText"},r)},c&&!p&&[m.isSelected,{":focus-within":(n={background:d.themePrimary,color:d.white},n[Q.up]={color:"HighLightText",background:"Highlight"},n)}],a],text:[m.text,{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",minWidth:30,margin:"0 8px"},p&&{selectors:(o={},o[Q.up]={color:"GrayText"},o)}],close:[m.close,(0,Q.gm)(l,{borderColor:"transparent",inset:1,outlineColor:d.white}),{color:d.neutralSecondary,width:30,height:"100%",flex:"0 0 auto",borderRadius:(0,Me.jI)(l)?"".concat(u.roundedCorner2," 0 0 ").concat(u.roundedCorner2):"0 ".concat(u.roundedCorner2," ").concat(u.roundedCorner2," 0"),selectors:(s={":hover":{background:d.neutralQuaternaryAlt,color:d.neutralPrimary}},s[".".concat(m.isSelected," &:focus")]={color:d.white,background:d.themePrimary},s[":focus:hover"]={color:d.white,background:d.themeDark},s[":active"]={color:d.white,backgroundColor:d.themeDark},s)},p&&{selectors:(i={},i[".".concat(Ao._.msButtonIcon)]={color:d.neutralSecondary},i)}]}},void 0,{scope:"TagItem"}),Fo=r(27663),Mo=r(50861);!function(e){e.color0="rgb(104, 123, 33)",e.color1="rgb(76, 119, 168)",e.color2="rgb(177, 87, 144)",e.color3="rgb(0, 163, 0)",e.color4="rgb(30, 113, 69)",e.color5="rgb(217, 0, 128)",e.color6="rgb(126, 56, 120)",e.color7="rgb(96, 60, 186)",e.color8="rgb(0, 130, 129)",e.color9="rgb(0, 120, 212)",e.color10="rgb(43, 87, 151)",e.color11="rgb(196, 74, 38)",e.color12="rgb(185, 29, 71)",e.color13="rgb(226, 16, 16)"}(Do||(Do={}));const Lo=(0,j.J9)(e=>{if(null==Do[e])return"";const t={backgroundColor:Do[e]};return(0,Q.Zq)(t)});var No=r(66987),Ro=r(9117);const Uo=(0,j.J9)((e,t,r,n)=>{const o={borderRadius:"4px",width:`${t}px`,height:`${t}px`},s={root:[(0,Y.gS)(),(0,Y.GD)(),{justifyContent:"space-between",padding:"0 12px"}],initialsWrapper:[(0,Y.gS)(),Y.cc,(0,Ro.kE)(e),o],initialsText:{fontSize:Q.s.size10,fontWeight:Q.BO.semibold,color:No.J.White},subComponentStyles:{icon:{root:[(0,Ro.kE)(e),o,{"> svg":{width:`${r}px`,height:`${r}px`}}]},image:{root:o}}};return(0,Q.TW)(s,n)}),Oo=(0,j.J9)(e=>({root:(0,Q.Zq)("dynamic-icon",e.root),initialsWrapper:(0,Q.Zq)("initials-wrapper",e.initialsWrapper),initialsText:(0,Q.Zq)("initials-text",e.initialsText)}));var Ho=r(11597);const Vo=e=>{const{stateBasedIcons:t,focused:r,name:n,styles:o,size:s=24,iconSvgSize:i=20}=e,a=(0,z.D)(),l=Uo(a,s,i,o),{initialsWrapper:c,initialsText:p}=Oo(l),{image:d,icon:u}=l.subComponentStyles;if(null==t){if(null!=n){const e=(0,Ho.cc)(n),t=Lo(function(e){const t=(0,Ho.fV)(e,No.C);return t<0?"":"color"+t}(n));return _.createElement("div",{className:(0,je.A)(c,t)},_.createElement("span",{className:p},e))}return null}if("string"===typeof t)return _.createElement(Fo._,{styles:d,imageFit:Mo.N_.cover,src:t,alt:""});{const e=t;return r&&null!=e.focusedIcon?_.createElement(xe.I,{styles:u,...e.focusedIcon}):_.createElement(xe.I,{styles:u,...e.normalIcon})}};var Go;!function(e){e.Invalid="invalid",e.PlannerUser="plannerUser",e.Group="group",e.TeamsConversation="teamsConversation",e.DriveItem="driveItem",e.Roster="roster",e.Project="project",e.User="user",e.ToDo="todo"}(Go||(Go={}));var Wo=r(14638);const _o={subComponentStyles:{icon:{root:{background:"linear-gradient(224deg, #B377E0 1.02%, #5166D7 123.98%)",color:No.J.White,":hover":{color:No.J.White}}},image:{}}},zo=e=>{const{containerType:t,containerPhoto:r,focused:n=!1,showIconOnly:o,name:s,size:i=20,iconSvgSize:a=16}=e,l=(0,_.useMemo)(()=>o||t!==Go.Group?{normalIcon:Wo.mU,focusedIcon:Wo._P}:r,[t,r,o]);return _.createElement(Vo,{name:s,focused:n,stateBasedIcons:l,size:i,iconSvgSize:a,styles:_o})};var Zo=r(91900);const Ko=(0,j.J9)((e,t)=>{const r={root:[(0,Le.$Z)(),(0,Le.gS)("row","nowrap"),{alignItems:"center","> div":(0,Le.gS)(),paddingRight:"24px"}],linkedBadgeDropdown:[Le.xK,{color:e.palette.neutralSecondary,fontSize:Q.s.small,textDecoration:"none",cursor:"pointer"}],linkedBadgeItem:[Le.$Z,(0,Le.gS)("row","nowrap"),{alignItems:"center","> .delinkIcon":[(0,Le.gS)("row","nowrap"),{"> .plannerDivider":[{color:e.palette.neutralQuaternaryAlt}],"> .plannerLinkDismiss":{color:e.semanticColors.errorIcon}}],"> .plannerChevronDownSmall":{color:e.palette.neutralPrimary,marginLeft:"8px",":hover, :active":{color:e.palette.themePrimary}}}],dividerContainer:[(0,Le.gS)(),Le.cc,{".plannerChevronRightSmall":{color:e.palette.neutralSecondary,padding:"1px 4px 0px 4px"}}],planAvatar:[(0,Le.gS)(),{marginRight:"8px"}],planTitle:[(0,Le.gS)(),{fontWeight:Q.BO.bold,fontSize:Q.s.size16,paddingBottom:"4px"}],titleSideTag:[(0,Le.gS)(),{marginLeft:"8px",marginRight:"8px",fontSize:Q.s.size12,backgroundColor:e.palette.neutralLighter,"> .ms-TagItem-close":{display:"none"}}]};return(0,Q.pB)(void 0,r,t)}),qo=(0,j.J9)(e=>({root:(0,Q.Zq)("planTitleSection",e.root),linkedBadgeDropdown:(0,Q.Zq)("linkedBadgeDropdown",e.linkedBadgeDropdown),linkedBadgeItem:(0,Q.Zq)("linkedBadgeItem",e.linkedBadgeItem),dividerContainer:(0,Q.Zq)("dividerContainer",e.dividerContainer),planAvatar:(0,Q.Zq)("planAvatar",e.planAvatar),planTitle:(0,Q.Zq)("planTitle",e.planTitle),titleSideTag:(0,Q.Zq)("titleSideTag",e.titleSideTag)})),jo=e=>{const{theme:{palette:t}}=e;return{root:{margin:"0px"},listItem:[{"&:first-child > .ms-Breadcrumb-itemLink":{fontSize:Q.s.size14},"&:last-child > .ms-Breadcrumb-itemLink":{fontWeight:Q.BO.bold,fontSize:Q.s.size16,maxWidth:"30ch"}}],itemLink:{padding:"0px",":active, :active:hover, :hover":{background:"transparent",textDecoration:"underline"}},overflowButton:[{color:t.neutralSecondary,":focus-visible":[{outlineColor:"initial",outlineStyle:"auto"}],height:"14px"}]}},Qo=(0,j.J9)(e=>({root:{marginLeft:"8px",height:"24px",width:"24px",color:e.palette.neutralPrimary},rootPressed:{color:e.palette.themePrimary,backgroundColor:"inherit"}})),Yo=e=>{let{isCurrentPlanPinned:t,styles:r,theme:n,plan:o,imageSource:s,breadcrumbItems:i,contextDropdownProps:a,togglePlanPinUnpinStatus:l,isTeamsTabView:c,onRenderPlanPhoto:p,isReadOnly:d}=e;const u=(0,z.D)(),h=qo(Ko(u,r)),g=()=>a&&(a.visibleContextKeys.length>0||a.contextMenuItemCallbacks)?_.createElement(vt,{...a,className:h.linkedBadgeDropdown,isBeakVisible:!1,onRenderLabel:e=>_.createElement("div",{className:h.linkedBadgeItem},_.createElement(xe.I,tt.u2),(()=>{if(a&&a.visibleContextKeys.length>0){const e=a.contextDetails;if(!e)return null;if(null!=Qn()(e,e=>e.status===yt.$.Delinked))return _.createElement("div",{className:"delinkIcon"},_.createElement(xe.I,tt.Zl),_.createElement(xe.I,tt.aA))}return null})()),theme:n}):null,m=_.useCallback(()=>{const e=_.createElement("div",{className:h.planAvatar},_.createElement(zo,{containerType:o.container.containerType,containerPhoto:s,name:o.title}));return _.createElement(Zo.n,{containerId:o.id,onLoad:p},e)},[h.planAvatar,s,o,p]),C=_.useCallback(e=>_.createElement("div",{className:h.dividerContainer},_.createElement(xe.I,tt.gO),m()),[m,h.dividerContainer]),k=()=>{const e=Ee.p.Strings.UnoPlanHeader_ReadOnlyTag;return _.createElement(Io,{item:{key:e,name:e},index:0,tabIndex:0,id:"sideInfoTagItem",className:h.titleSideTag},e)};return c?_.createElement("div",{className:h.root},m(),_.createElement("div",{className:h.planTitle}," ",o.title," "),g(),d&&k()):_.createElement("div",{className:h.root},_.createElement(Pe.Q,{items:i,className:"planHeader-breadcrumb",maxDisplayedItems:2,overflowAriaLabel:"",dividerAs:C,styles:jo,onReduceData:()=>{}}),g(),(()=>{const e=t?Ee.p.Strings.PlanHeader_PlanHeaderRemovePinned:Ee.p.Strings.PlanHeader_PlanHeaderAddPinned,r=t?tt.s1:tt.ol;return _.createElement(oo.S,{hostClassName:"pin-button-tooltiphost",content:e,delay:yo.H.medium,directionalHint:Je.A.bottomRightEdge},_.createElement(fo.K,{onClick:l,className:"toggleFavoriteIcon",ariaLabel:e,styles:Qo(u),onRenderIcon:()=>_.createElement(_.Fragment,null,_.createElement(xe.I,{...r,className:(0,je.A)(r.className,"regularPin")}))}))})(),d&&k())};var Jo=r(29344),Xo=r(62672);const $o=(0,j.J9)(e=>({root:[(0,Y.gS)("row","nowrap"),{minWidth:"0",alignItems:"center",color:e.palette.neutralSecondary,marginLeft:"auto",marginTop:"-4px"}]})),es=(0,j.J9)(e=>({root:(0,Q.Zq)("overflowMenu",e.root)})),ts=(0,j.J9)(e=>({header:{color:e.palette.neutralPrimary,marginLeft:"-20px",".ms-ContextualMenu-icon":{color:e.palette.themeSecondary,marginTop:"8px",order:"2",paddingRight:"10px"}},container:{overflowY:"auto"}})),rs="upsellOverflowMenuButtonClassName",ns=e=>{let{menuItems:t,dropdownMenuTitle:r,iconButtonTitle:n}=e;const o=(0,z.D)(),[s,i]=_.useState(!1),a=es($o(o)),l=(0,_.useCallback)(()=>{if(!s)return null;const e=[{key:"AddPremiumViews",itemType:ye.G.Section,sectionProps:{title:{key:"AddPremiumViews",text:r,iconProps:Wo.aM},items:t}}];return _.createElement(Xo.l,{shouldFocusOnMount:!0,items:e,directionalHint:Je.A.bottomAutoEdge,target:`.${rs}`,onDismiss:()=>i(!1),styles:ts(o)})},[r,t,s,o]);return _.createElement("div",{className:a.root},_.createElement(fo.K,{title:n,className:rs,id:Jo.hN.HeaderMoreOptionsButton,iconProps:Wo.XP,onClick:()=>i(!s)}),l())};var os=r(40440),ss=r(37178),is=r(17066),as=r(27480),ls=r(87633);function cs(e,t){void 0===t&&(t=null);var r=_.useRef({ref:function(){var e=function(e){r.ref.current!==e&&(r.cleanup&&(r.cleanup(),r.cleanup=void 0),r.ref.current=e,null!==e&&(r.cleanup=r.callback(e)))};return e.current=t,e}(),callback:e}).current;return r.callback=e,r.ref}var ps=r(76682),ds=r(44828),us=function(e){var t=e.onOverflowItemsChanged,r=e.rtl,n=e.pinnedIndex,o=_.useRef(),s=_.useRef(),i=cs(function(e){var t=function(e,t){if("undefined"!==typeof ResizeObserver){var r=new ResizeObserver(t);return Array.isArray(e)?e.forEach(function(e){return r.observe(e)}):r.observe(e),function(){return r.disconnect()}}var n=function(){return t(void 0)},o=(0,ds.z)(Array.isArray(e)?e[0]:e);if(!o)return function(){};var s=o.requestAnimationFrame(n);return o.addEventListener("resize",n,!1),function(){o.cancelAnimationFrame(s),o.removeEventListener("resize",n,!1)}}(e,function(t){s.current=t?t[0].contentRect.width:e.clientWidth,o.current&&o.current()});return function(){t(),s.current=void 0}}),a=cs(function(e){return i(e.parentElement),function(){return i(null)}});return(0,ps.E)(function(){var e=i.current,l=a.current;if(e&&l){for(var c=[],p=0;p<e.children.length;p++){var d=e.children[p];d instanceof HTMLElement&&d!==l&&c.push(d)}var u=[],h=0;o.current=function(){var e=s.current;if(void 0!==e){for(var t=c.length-1;t>=0;t--){if(void 0===u[t]){var o=r?e-c[t].offsetLeft:c[t].offsetLeft+c[t].offsetWidth;t+1<c.length&&t+1===n&&(h=u[t+1]-o),t===c.length-2&&(h+=l.offsetWidth),u[t]=o+h}if(e>u[t])return void m(t+1)}m(0)}};var g=c.length,m=function(e){g!==e&&(g=e,t(e,c.map(function(t,r){return{ele:t,isOverflowing:r>=e&&r!==n}})))},C=void 0;if(void 0!==s.current){var k=(0,ds.z)(e);if(k){var b=k.requestAnimationFrame(o.current);C=function(){return k.cancelAnimationFrame(b)}}}return function(){C&&C(),m(c.length),o.current=void 0}}}),{menuButtonRef:a}},hs=r(78233),gs=r(9833),ms=function(e){function t(t){var r=e.call(this,t)||this;return(0,hs.f)(r),(0,gs.A)("PivotItem",t,{linkText:"headerText"}),r}return(0,vo.__extends)(t,e),t.prototype.render=function(){return _.createElement("div",(0,vo.__assign)({},(0,is.G1)(this.props,is.JM)),this.props.children)},t}(_.Component),Cs=(0,zr.Z)(),ks=function(e,t){var r={links:[],keyToIndexMapping:{},keyToTabIdMapping:{}};return _.Children.forEach(_.Children.toArray(e.children),function(n,o){if(bs(n)){var s=n.props,i=s.linkText,a=(0,vo.__rest)(s,["linkText"]),l=n.props.itemKey||o.toString();r.links.push((0,vo.__assign)((0,vo.__assign)({headerText:i},a),{itemKey:l})),r.keyToIndexMapping[l]=o,r.keyToTabIdMapping[l]=function(e,t,r,n){return e.getTabId?e.getTabId(r,n):t+"-Tab".concat(n)}(e,t,l,o)}else n&&(0,ss.R)("The children of a Pivot component must be of type PivotItem to be rendered.")}),r},bs=function(e){var t;return _.isValidElement(e)&&(null===(t=e.type)||void 0===t?void 0:t.name)===ms.name},Ts=_.forwardRef(function(e,t){var r,n=_.useRef(null),o=_.useRef(null),s=(0,Bo.B)("Pivot"),i=(0,os.k)(e.selectedKey,e.defaultSelectedKey),a=i[0],l=i[1],c=e.componentRef,p=e.theme,d=e.linkSize,u=e.linkFormat,h=e.overflowBehavior,g=e.overflowAriaLabel,m=e.focusZoneProps,C=e.overflowButtonAs,k={"aria-label":e["aria-label"],"aria-labelledby":e["aria-labelledby"]},b=(0,is.G1)(e,is.JM,["aria-label","aria-labelledby"]),T=ks(e,s);_.useImperativeHandle(c,function(){return{focus:function(){var e;null===(e=n.current)||void 0===e||e.focus()}}});var S=function(e){if(!e)return null;var t=e.itemCount,n=e.itemIcon,o=e.headerText;return _.createElement("span",{className:r.linkContent},void 0!==n&&_.createElement("span",{className:r.icon},_.createElement(xe.I,{iconName:n})),void 0!==o&&_.createElement("span",{className:r.text}," ",e.headerText),void 0!==t&&_.createElement("span",{className:r.count}," (",t,")"))},P=function(e,t,n,o){var s,i=t.itemKey,a=t.headerButtonProps,l=t.onRenderItemLink,c=e.keyToTabIdMapping[i],p=n===i;s=l?l(t,S):S(t);var d=t.headerText||"";d+=t.itemCount?" ("+t.itemCount+")":"",d+=t.itemIcon?" xx":"";var u=t.role&&"tab"!==t.role?{role:t.role}:{role:"tab","aria-selected":p};return _.createElement(ls.c,(0,vo.__assign)({},a,u,{id:c,key:i,className:(0,je.A)(o,p&&r.linkIsSelected),onClick:function(e){return x(i,e)},onKeyDown:function(e){return y(i,e)},"aria-label":t.ariaLabel,name:t.headerText,keytipProps:t.keytipProps,"data-content":d}),s)},x=function(e,t){t.preventDefault(),f(e,t)},y=function(e,t){t.which===as.c.enter&&(t.preventDefault(),f(e,t))},f=function(t,r){var n;if(l(t),T=ks(e,s),e.onLinkClick&&T.keyToIndexMapping[t]>=0){var i=T.keyToIndexMapping[t],a=_.Children.toArray(e.children)[i];bs(a)&&e.onLinkClick(a,r)}null===(n=o.current)||void 0===n||n.dismissMenu()};r=Cs(e.styles,{theme:p,linkSize:d,linkFormat:u});var v=function(){return null===(e=a)||void 0!==e&&void 0!==T.keyToIndexMapping[e]?a:T.links.length?T.links[0].itemKey:void 0;var e}(),A=v?T.keyToIndexMapping[v]:0,w=T.links.map(function(e){return P(T,e,v,r.link)}),D=_.useMemo(function(){return{items:[],alignTargetEdge:!0,directionalHint:Je.A.bottomRightEdge}},[]),B=us({onOverflowItemsChanged:function(e,t){t.forEach(function(e){var t=e.ele,r=e.isOverflowing;return t.dataset.isOverflowing="".concat(r)}),D.items=T.links.slice(e).filter(function(e){return e.itemKey!==v}).map(function(t,n){return t.role="menuitem",{key:t.itemKey||"".concat(e+n),onRender:function(){return P(T,t,v,r.linkInMenu)}}})},rtl:(0,Me.jI)(p),pinnedIndex:A}).menuButtonRef,E=C||ls.c;return _.createElement("div",(0,vo.__assign)({ref:t},b),_.createElement(Lr.R,(0,vo.__assign)({componentRef:n,role:"tablist"},k,{direction:Nr.E.horizontal},m,{className:(0,je.A)(r.root,null===m||void 0===m?void 0:m.className)}),w,"menu"===h&&_.createElement(E,{className:(0,je.A)(r.link,r.overflowMenuButton),elementRef:B,componentRef:o,menuProps:D,menuIconProps:{iconName:"More",style:{color:"inherit"}},ariaLabel:g,role:"tab"})),v&&T.links.map(function(t){return(!0===t.alwaysRender||v===t.itemKey)&&function(t,n){if(e.headersOnly||!t)return null;var o=T.keyToIndexMapping[t],s=T.keyToTabIdMapping[t];return _.createElement("div",{role:"tabpanel",hidden:!n,key:t,"aria-hidden":!n,"aria-labelledby":s,className:r.itemContainer},_.Children.toArray(e.children)[o])}(t.itemKey,v===t.itemKey)}))});Ts.displayName="Pivot";var Ss=r(42815),Ps={count:"ms-Pivot-count",icon:"ms-Pivot-icon",linkIsSelected:"is-selected",link:"ms-Pivot-link",linkContent:"ms-Pivot-linkContent",root:"ms-Pivot",rootIsLarge:"ms-Pivot--large",rootIsTabs:"ms-Pivot--tabs",text:"ms-Pivot-text",linkInMenu:"ms-Pivot-linkInMenu",overflowMenuButton:"ms-Pivot-overflowMenuButton"},xs=function(e,t,r){var n,o,s;void 0===r&&(r=!1);var i=e.linkSize,a=e.linkFormat,l=e.theme,c=l.semanticColors,p=l.fonts,d="large"===i,u="tabs"===a;return[p.medium,{color:c.actionLink,padding:"0 8px",position:"relative",backgroundColor:"transparent",border:0,borderRadius:0,selectors:{":hover":{backgroundColor:c.buttonBackgroundHovered,color:c.buttonTextHovered,cursor:"pointer"},":active":{backgroundColor:c.buttonBackgroundPressed,color:c.buttonTextHovered},":focus":{outline:"none"}}},!r&&[{display:"inline-block",lineHeight:44,height:44,marginRight:8,textAlign:"center",selectors:(n={},n[".".concat(Ss.Y2," &:focus, :host(.").concat(Ss.Y2,") &:focus")]={outline:"1px solid ".concat(c.focusBorder)},n[".".concat(Ss.Y2," &:focus:after, :host(.").concat(Ss.Y2,") &:focus:after")]={content:"attr(data-content)",position:"relative",border:0},n[":before"]={backgroundColor:"transparent",bottom:0,content:'""',height:2,left:8,position:"absolute",right:8,transition:"left ".concat(Q.cs.durationValue2," ").concat(Q.cs.easeFunction2,",\n                        right ").concat(Q.cs.durationValue2," ").concat(Q.cs.easeFunction2)},n[":after"]={color:"transparent",content:"attr(data-content)",display:"block",fontWeight:Q.BO.bold,height:1,overflow:"hidden",visibility:"hidden"},n)},d&&{fontSize:p.large.fontSize},u&&[{marginRight:0,height:44,lineHeight:44,backgroundColor:c.buttonBackground,padding:"0 10px",verticalAlign:"top",selectors:(o={":focus":{outlineOffset:"-2px"}},o[".".concat(Ss.Y2," &:focus::before, :host(.").concat(Ss.Y2,") &:focus::before")]={height:"auto",background:"transparent",transition:"none"},o["&:hover, &:focus"]={color:c.buttonTextCheckedHovered},o["&:active, &:hover"]={color:c.primaryButtonText,backgroundColor:c.primaryButtonBackground},o["&.".concat(t.linkIsSelected)]={backgroundColor:c.primaryButtonBackground,color:c.primaryButtonText,fontWeight:Q.BO.regular,selectors:(s={":before":{backgroundColor:"transparent",transition:"none",position:"absolute",top:0,left:0,right:0,bottom:0,content:'""',height:0},":hover":{backgroundColor:c.primaryButtonBackgroundHovered,color:c.primaryButtonText},":active":{backgroundColor:c.primaryButtonBackgroundPressed,color:c.primaryButtonText}},s[Q.up]=(0,vo.__assign)({fontWeight:Q.BO.semibold,color:"HighlightText",background:"Highlight"},(0,Q.Qg)()),s)},o[".".concat(Ss.Y2," &.").concat(t.linkIsSelected,":focus, :host(.").concat(Ss.Y2,") &.").concat(t.linkIsSelected,":focus")]={outlineColor:c.primaryButtonText},o)}]]]},ys=(0,Zr.I)(Ts,function(e){var t,r,n,o,s=e.className,i=e.linkSize,a=e.linkFormat,l=e.theme,c=l.semanticColors,p=l.fonts,d=(0,Q.Km)(Ps,l),u="large"===i,h="tabs"===a;return{root:[d.root,p.medium,Q.S8,{position:"relative",color:c.link,whiteSpace:"nowrap"},u&&d.rootIsLarge,h&&d.rootIsTabs,s],itemContainer:{selectors:{"&[hidden]":{display:"none"}}},link:(0,vo.__spreadArray)((0,vo.__spreadArray)([d.link],xs(e,d),!0),[(t={},t["&[data-is-overflowing='true']"]={display:"none"},t)],!1),overflowMenuButton:[d.overflowMenuButton,(r={visibility:"hidden",position:"absolute",right:0},r[".".concat(d.link,"[data-is-overflowing='true'] ~ &")]={visibility:"visible",position:"relative"},r)],linkInMenu:(0,vo.__spreadArray)((0,vo.__spreadArray)([d.linkInMenu],xs(e,d,!0),!0),[{justifyContent:"start",height:36,lineHeight:36,width:"100%"}],!1),linkIsSelected:[d.link,d.linkIsSelected,{fontWeight:Q.BO.semibold,selectors:(n={":before":{backgroundColor:c.inputBackgroundChecked,selectors:(o={},o[Q.up]={backgroundColor:"Highlight"},o)},":hover::before":{left:0,right:0}},n[Q.up]={color:"Highlight"},n)}],linkContent:[d.linkContent,{flex:"0 1 100%",selectors:{"& > * ":{marginLeft:4},"& > *:first-child":{marginLeft:0}}}],text:[d.text,{display:"inline-block",verticalAlign:"top"}],count:[d.count,{display:"inline-block",verticalAlign:"top"}],icon:d.icon}},void 0,{scope:"Pivot"});const fs=e=>{const{theme:{palette:t,semanticColors:r}}=e;return{root:[(0,Le.gS)("row","wrap")],link:{marginRight:"8px",color:t.neutralSecondary,":last-of-type":{marginRight:"4px"},[`@media (max-width: ${Re.B.UnoSmallScreenWidth})`]:{margin:"0xp",width:"36px",":hover":{backgroundColor:"transparent","::before":{backgroundColor:t.neutralTertiaryAlt},color:r.menuItemTextHovered}}},linkIsSelected:{"> span > .ms-TooltipHost > .ms-Pivot-linkContent > .ms-Pivot-icon":{color:t.themePrimary},"> span > .ms-TooltipHost > .ms-Pivot-linkContent > .ms-Pivot-text":{fontWeight:Q.BO.semibold,color:t.neutralPrimary},":hover":{"::before":{backgroundColor:t.themePrimary}}},icon:{"> i":{marginTop:"5px"}},text:{marginRight:"2px",[`@media (max-width: ${Re.B.UnoSmallScreenWidth})`]:{display:"none"}}}},vs={root:{display:"block",height:"100%"}},As=e=>{const{pivotItemProps:t,onSelectPivotItem:r,selectedPivotKey:n,showTooltip:o}=e,s=(e,t)=>{if(!e||!t)return null;const r=o?e.tooltipText:void 0;return _.createElement("div",{id:e.pivotElementId},_.createElement(oo.S,{styles:vs,content:r,componentRef:e.tooltipRef},t(e)))},i=_.useCallback((e,t)=>{if(t?.stopPropagation(),null!=e?.props?.itemKey){const t=e.props.itemKey;r(t)}},[r]);return _.createElement(ys,{headersOnly:!0,onLinkClick:i,styles:fs,selectedKey:n},t.map(e=>{return _.createElement(ms,{...e,key:e.itemKey,onRenderItemLink:s,headerButtonProps:{onFocus:(t=e.tooltipRef,()=>{t?.current&&t.current.show()})},ariaLabel:o?e.tooltipText:void 0});var t}))},ws=(0,j.J9)((e,t)=>{const r={root:[(0,Le.$Z)(),(0,Le.gS)("row","nowrap"),{alignItems:"center","> div":(0,Le.gS)()}]};return(0,Q.pB)(void 0,r,t)}),Ds=(0,j.J9)(e=>({root:(0,Q.Zq)("planViewsPivots",e.root)}));var Bs=r(66298);const Es=e=>{const t=(0,z.D)(),r=Ds(ws(t,e.styles)),{usageLogger:n}=(0,Bs.t)(),o=_.useRef(null),s=_.useRef(null),i=_.useRef(null),a=_.useRef(null),l=e.plan.container.containerType,c=ae.B.clientSettings.Flights.EnablePersonalPlanConversionUX?l!==pe.K.Group&&l!==pe.K.User:l!==pe.K.Group,d=ae.B.clientSettings.Flights.EnableUpsellOverflowMenuUpdate,u=()=>{const{onUpsellHookClick:t,showUpsellHooks:r}=e,n=[];return r&&(d||n.push({key:"AddMoreViews",name:Ee.p.Strings.SharedComponents_AddMoreViewsText,itemType:ye.G.Header,iconProps:tt.aM}),(d&&c||!d)&&n.push({key:p.EC.PlanTimeline,name:Ee.p.Strings.SharedComponents_PlanTimelinePageName,onClick:()=>t(p.EC.PlanTimeline),iconProps:tt.mF,disabled:c,canCheck:!0,checked:!1}),n.push({key:p.EC.PlanPeople,name:Ee.p.Strings.SharedComponents_PlanPeoplePageName,onClick:()=>t(p.EC.PlanPeople),iconProps:tt.CR,disabled:c,canCheck:!0,checked:!1}),n.push({key:p.EC.PlanGoals,name:Ee.p.Strings.SharedComponents_PlanGoalsPageName,onClick:()=>t(p.EC.PlanGoals),iconProps:tt.C,disabled:c,canCheck:!0,checked:!1}),n.push({key:p.EC.PlanAssignments,name:Ee.p.Strings.SharedComponents_PlanAssignmentsPageName,onClick:()=>t(p.EC.PlanAssignments),iconProps:tt.T6,disabled:c,canCheck:!0,checked:!1})),n},h=t=>{const{currentPage:r}=e;return t===r},g=u();return _.createElement("div",{className:r.root},_.createElement(As,{pivotItemProps:(()=>{const t=[];return t.push({headerText:Ee.p.Strings.SharedComponents_PlanGridPageName,itemIcon:h(p.EC.PlanGrid)?tt.SG.iconName:tt.CY.iconName,itemKey:p.EC.PlanGrid,tooltipText:Ee.p.Strings.SharedComponents_PlanGridPageName,tooltipRef:o,pivotElementId:Jo.hN.GridViewPivot}),t.push({headerText:Ee.p.Strings.SharedComponents_PlanTaskboardPageName,itemIcon:h(p.EC.PlanTaskboard)?tt.fN.iconName:tt.fD.iconName,itemKey:p.EC.PlanTaskboard,tooltipText:Ee.p.Strings.SharedComponents_PlanTaskboardPageName,tooltipRef:s,pivotElementId:Jo.hN.BoardViewPivot}),t.push({headerText:Ee.p.Strings.SharedComponents_PlanSchedulePageName,itemIcon:h(p.EC.PlanSchedule)?tt._o.iconName:tt.cx.iconName,itemKey:p.EC.PlanSchedule,tooltipText:Ee.p.Strings.SharedComponents_PlanSchedulePageName,tooltipRef:i,pivotElementId:Jo.hN.ScheduleViewPivot}),t.push({headerText:Ee.p.Strings.SharedComponents_PlanChartsPageName,itemIcon:h(p.EC.PlanCharts)?tt.OH.iconName:tt.iH.iconName,itemKey:p.EC.PlanCharts,tooltipText:Ee.p.Strings.SharedComponents_PlanChartsPageName,tooltipRef:a,pivotElementId:Jo.hN.ChartsViewPivot}),e.showUpsellHooks&&!c&&d&&t.push({headerText:Ee.p.Strings.SharedComponents_PlanTimelinePageName,itemIcon:tt.aM.iconName,itemKey:p.EC.PlanTimeline,tooltipText:Ee.p.Strings.SharedComponents_PlanTimelineTooltip,pivotElementId:Jo.hN.TimelineViewPivot}),t})(),onSelectPivotItem:t=>{const{navigateToPage:r}=e;n.logData(t,"Clicked"),t===p.EC.PlanTimeline&&d?e.onUpsellHookClick(p.EC.PlanTimeline):r(t)},selectedPivotKey:(()=>{const{currentPage:t,plan:r}=e;if(r.container.containerType===pe.K.User){return u().find(e=>e.key===t)?null:t}return t})(),showTooltip:e.showTooltip}),g.length>0&&!d&&_.createElement(rt,{moreOptionsContextMenuItems:g,moreOptionsTooltip:Ee.p.Strings.UnoPlanHeader_MoreViews,theme:e.theme}),g.length>0&&d&&_.createElement(ns,{menuItems:g,dropdownMenuTitle:Ee.p.Strings.UpsellOverflowMenu_DropdownTitle,iconButtonTitle:Ee.p.Strings.UnoPlanHeader_MoreViews}))},Is=(0,j.J9)((e,t)=>{const r={root:[(0,Le.gS)("row","nowrap"),{minWidth:"0",alignItems:"center",color:e.palette.neutralSecondary,marginLeft:"auto"}]};return(0,Q.pB)(void 0,r,t)}),Fs=(0,j.J9)(e=>({root:(0,Q.Zq)("overflowMenu",e.root)})),Ms="bpShowMoreHeaderButton",Ls=e=>{let{styles:t,theme:r,showFeedbackButton:n,onClickFeedback:o}=e;const s=(0,z.D)(),[i,a]=_.useState(!1),l=Fs(Is(s,t)),c=(0,_.useCallback)(()=>{if(!i)return null;const e=[{key:"help",text:Ee.p.Strings.PlanHeader_PlanHeaderHelp,iconProps:tt.uh,onClick:()=>{a(!1),Yn.b.safelyOpenExternalUrl(le.$j.plannerHelp,"_blank")}}];return n&&e.push({key:"feedback",text:Ee.p.Strings.UnoPlanHeader_FeedbackText,iconProps:tt.is,onClick:()=>{a(!1),o()}}),_.createElement(Xe.l,{shouldFocusOnMount:!0,items:e,directionalHint:Je.A.bottomAutoEdge,target:`.${Ms}`,appTheme:r,onDismiss:()=>a(!1)})},[o,r,n,i]);return _.createElement("div",{className:l.root},_.createElement(Dn.K,{title:Ee.p.Strings.PlannerHeader_MoreAriaLabel,className:Ms,iconProps:tt.uh,onClick:()=>a(!i),plannerTheme:r}),c())};var Ns=r(8784);const Rs=(0,j.J9)((e,t)=>{const r={root:[{border:"none",borderColor:e?.semanticColors.buttonBorder,height:"32px",padding:"0px",".ms-Icon":{margin:"0px"},".ms-Button-textContainer":{[`@media (max-width: ${Re.B.UnoLargeScreenWidth})`]:{display:"none"}}}]};return(0,Q.pB)(void 0,r,t)}),Us=(0,j.J9)(e=>({root:(0,Q.Zq)("diamondButton",e.root)})),Os=e=>{let{showTooltip:t,styles:r,showTrialStatusButton:n,showTrialStatusButtonText:o,isTrialActive:s,isSelfServiceEnabled:i,onClickTrialButton:a}=e;const l=(0,z.D)(),c=Us(Rs(l,r));if(!1===n)return null;const p=t?Ee.p.Strings.UnoPlanHeader_TrialTooltip:"";return _.createElement(oo.S,{content:p},_.createElement(Ns.r,{text:o?s?Ee.p.Strings.UnoPlanHeader_TrialButtonTextTrialActive:i?Ee.p.Strings.UnoPlanHeader_TrialButtonText:Ee.p.Strings.UnoPlanHeader_RequestSubscriptionButtonText:void 0,onClick:a,className:c.root,iconProps:tt.aM,id:C.Au}))},Hs=(0,j.J9)(e=>({root:{border:"none",background:"transparent",minWidth:"auto",padding:"0px",borderRadius:"4px",[`@media (max-width: ${Re.B.UnoLargeScreenWidth})`]:{padding:"0px 5px 0px 5px",minWidth:"32px"}},icon:{color:e.palette.neutralPrimary,display:"inline-block",margin:"0px",[`@media (max-width: ${Re.B.UnoLargeScreenWidth})`]:{marginRight:"0px"}},label:{color:e.palette.neutralPrimary,fontWeight:Q.BO.regular},textContainer:{[`@media (max-width: ${Re.B.UnoLargeScreenWidth})`]:{display:"none"}},menuIcon:{margin:"2px 0px 0px 0px",[`@media (max-width: ${Re.B.UnoLargeScreenWidth})`]:{display:"none !important"}}})),Vs=e=>{let{showCopilotButton:t,showTooltip:r,onClickCopilotButton:n}=e;const o=(0,z.D)();if(!1===t)return null;const s=r?Ee.p.Strings.UnoPlanHeader_CopilotText:"";return _.createElement(oo.S,{content:s},_.createElement(q.Y,{id:Jo.hN.CopilotButton,text:Ee.p.Strings.UnoPlanHeader_CopilotText,iconProps:Wo.H3,styles:Hs(o),onClick:n}))},Gs=(0,j.J9)((e,t)=>{const r={root:[(0,Le.gS)("row","nowrap"),{minWidth:"0",alignItems:"center",color:e.palette.neutralSecondary,marginLeft:"auto",paddingLeft:"32px",columnGap:"12px"}],statusIcon:{marginRight:"12px"}};return(0,Q.pB)(void 0,r,t)}),Ws=(0,j.J9)(e=>({root:(0,Q.Zq)("planStatusSection",e.root),statusIcon:(0,Q.Zq)("statusIcon",e.statusIcon)})),_s=(0,j.J9)(e=>({root:{border:`1px solid ${e.palette.neutralTertiaryAlt}`,background:"transparent",minWidth:"auto",padding:"5px 8px 5px 10px",borderRadius:"4px",[`@media (max-width: ${Re.B.UnoLargeScreenWidth})`]:{padding:"0px 5px 0px 5px",minWidth:"32px"}},icon:{color:e.palette.neutralPrimary,display:"inline-block",margin:"0px 2px 4px 0px",[`@media (max-width: ${Re.B.UnoLargeScreenWidth})`]:{marginRight:"0px"}},label:{color:e.palette.neutralPrimary,fontWeight:Q.BO.regular},textContainer:{[`@media (max-width: ${Re.B.UnoLargeScreenWidth})`]:{display:"none"}},menuIcon:{margin:"2px 0px 0px 0px",[`@media (max-width: ${Re.B.UnoLargeScreenWidth})`]:{display:"none !important"}}}));var zs=r(50840);const Zs=(0,j.J9)(e=>({root:{maxWidth:"343px",padding:"20px 24px",borderRadius:"2px",background:e.palette.white},calloutMain:{background:"transparent"}})),Ks=e=>{const t=(0,z.D)();return _.createElement(zs.P,{styles:Zs(t),...e},_.createElement("div",null,Ee.p.Strings.UnoPlanHeader_ViewMembersDisabledInfo))};var qs=r(25290);const js="shareButtonRef",Qs=e=>{let{showTooltip:t,showOverflowMenu:r,styles:n,plan:o,openSharePlanDialog:s,canViewMembers:i,copilotButtonProps:a,premiumPlanTrialButtonProps:l,headerOverflowMenuProps:c}=e;const p=(0,z.D)(),[d,u]=_.useState(!1),h=Ws(Gs(p,n)),g=o.id,m=o.container.containerType,C=_.useMemo(()=>(0,qs.DA)(),[]),k=(0,_.useCallback)(()=>{i?s(g):u(!d)},[i,d,s,g]);return _.createElement("div",{className:h.root},_.createElement(Vs,a),(()=>{if(m===pe.K.User)return _.createElement(oo.S,{id:C,content:Ee.p.Strings.UnoPlanHeader_PrivatePlanStatus},_.createElement(xe.I,{className:h.statusIcon,...tt.VW,"aria-labelledby":C,"aria-hidden":"false"}))})(),(()=>{const e=t?Ee.p.Strings.UnoPlanHeader_ShareTooltip:"";return _.createElement("div",null,_.createElement(oo.S,{content:e,id:"shareButtonTooltip"},_.createElement(q.Y,{text:Ee.p.Strings.UnoPlanHeader_ShareText,ariaLabel:Ee.p.Strings.UnoPlanHeader_ShareText,"aria-describedby":"shareButtonTooltip",iconProps:tt.lO,menuIconProps:tt.u2,styles:_s(p),onClick:k,className:js,id:Jo.hN.HeaderShareButton})),d&&_.createElement(Ks,{directionalHint:Je.A.bottomRightEdge,isBeakVisible:!1,gapSpace:0,onDismiss:()=>u(!d),target:`.${js}`}))})(),_.createElement(Os,l),r&&_.createElement(Ls,c))};var Ys=r(46851);const Js="32px",Xs="58px",$s=(0,j.J9)((e,t,r)=>{const n={root:[(0,Le.gS)("row","nowrap"),{backgroundColor:"inherit",marginBottom:Js}],unoPlanHeaderLandmark:t?[(0,Le.gS)("row","nowrap"),{width:"100%",boxShadow:Ys.f.depth4,borderBottom:`1px solid ${e.palette.neutralLight}`}]:[(0,Le.gS)("column","nowrap"),{width:"100%"}],pinButton:{width:"24px",height:"24px"}};return(0,Q.pB)(void 0,n,r)}),ei=(0,j.J9)(e=>({root:(0,Q.Zq)("unoPlanHeader",e.root),unoPlanHeaderLandmark:(0,Q.Zq)("unoPlanHeaderLandmark",e.unoPlanHeaderLandmark),pinButton:(0,Q.Zq)("unoPlanHeaderPinButton",e.pinButton)})),ti=(0,j.J9)((e,t,r)=>{const n={height:Xs,padding:`0 ${Js} 0 ${Js}`,overflowX:"auto"},o={root:t?[(0,Le.gS)("row","nowrap"),n]:[(0,Le.gS)("row","nowrap"),n,{boxShadow:Ys.f.depth4,borderBottom:`1px solid ${e.palette.neutralLight}`}]};return(0,Q.pB)(void 0,o,r)}),ri=(0,j.J9)(e=>({root:(0,Q.Zq)("planHeader",e.root)})),ni=e=>{const t=(0,z.D)(),r=ri(ti(t,e.isTeamsTabView,e.styles));return _.createElement("div",{className:r.root},_.createElement(Yo,e.planTitleSectionProps),_.createElement(Es,e.planViewPivotsProps),e.isTeamsTabView?null:_.createElement(Qs,e.planStatusSectionProps))};var oi=r(55563);const si=(0,j.J9)(e=>{const{theme:{semanticColors:t,palette:r}}=e;return{root:{background:t.menuBackground},subComponentStyles:{callout:{root:{backgroundColor:t.menuBackground,color:r.neutralPrimary,borderRadius:"2px",boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)"},beak:{background:t.menuBackground},beakCurtain:{borderRadius:"2px",background:t.menuBackground},calloutMain:{borderRadius:"2px",backgroundColor:t.menuBackground}},menuItem:ii}}}),ii=e=>{const{theme:{semanticColors:t,palette:r},expanded:n}=e;return{root:[n&&{backgroundColor:t.menuItemBackgroundPressed},{color:r.neutralPrimary,".ms-ContextualMenu-icon, .ms-ContextualMenu-checkmarkIcon, .ms-ContextualMenu-submenuIcon":{color:r.neutralPrimary},":focus, :hover":{backgroundColor:t.menuItemBackgroundHovered,color:r.neutralPrimary,".ms-ContextualMenu-icon, .ms-ContextualMenu-checkmarkIcon, .ms-ContextualMenu-submenuIcon":{color:r.neutralPrimary}}}],item:{":focus, :hover":{backgroundColor:t.menuItemBackgroundHovered},backgroundColor:t.menuBackground,marginLeft:"4px",marginRight:"4px",":first-of-type":{marginTop:"4px"},":last-of-type":{marginBottom:"6px"},"*":{boxSizing:"border-box"},button:[{borderRadius:"0px",height:"36px",width:"100%",marginBottom:"0px !important",":focus, :hover":{backgroundColor:t.menuItemBackgroundHovered,color:t.menuItemTextHovered}},n&&{backgroundColor:t.menuItemBackgroundPressed,color:t.menuItemTextHovered}]},checkmarkIcon:{color:r.neutralPrimary},icon:{marginRight:"12px",color:r.neutralPrimary}}},ai=(0,j.J9)(e=>({root:{backgroundColor:e.semanticColors.menuBackground},header:[{"> .clearFilters":{color:e.palette.themePrimary},"> .filterTitle":{color:e.palette.neutralPrimary}}]})),li=e=>{const t=_.useRef(),r=(0,z.D)(),[n,o]=_.useState(!1),s=_.useCallback(()=>{o(!n)},[n]),i=_.useCallback(()=>{o(!1),t.current.focus()},[]);return(()=>{const{currentTaskFilter:o,styles:a}=e;if(!o)return null;const l=o.filterCount>0?`${Ee.p.Strings.UnoPlanHeader_Filters}\n                    ${Ee.p.Strings.PlannerHeader_FiltersMenuHeaderOpeningParentheses}${o.filterCount.toString()}${Ee.p.Strings.PlannerHeader_FiltersMenuHeaderClosingParentheses}`:Ee.p.Strings.UnoPlanHeader_Filters,c=e.showTooltip?Ee.p.Strings.UnoPlanHeader_Filters:"";return _.createElement("span",{ref:t,id:Jo.hN.TaskFiltersButton},_.createElement(oo.S,{content:c},_.createElement(oi.z,{onClick:s,text:l,iconProps:tt.ao,styles:a,menuIconProps:tt.Ju,"aria-expanded":n}),n&&(()=>{const{members:n,theme:o,currentTaskFilter:s,taskData:a,buckets:l,planCategories:c,getUserPhoto:p,setTaskFilter:d,onRenderPersona:u,hideSearchBox:h}=e;if(!s)return null;const g={getUserPhoto:p,setTaskFilter:d,onRenderPersona:u,onDismiss:i};return _.createElement(Mr,{targetElement:t.current,callbacks:g,currentTaskFilter:s,taskData:a,members:n??[],categories:c,buckets:l,theme:o,hideSearchBox:h,contextualMenuStyles:si,styles:ai(r)})})()))})()},ci=e=>{const t=()=>{const{currentTaskGrouping:t,onGroupByChange:r}=e,n={items:[],shouldFocusOnMount:!1,directionalHint:Je.A.bottomRightEdge,styles:(0,vr.SH)(e.theme)};for(const o of e.taskGroupingOptions)isNaN(Number(o))||n.items.push({key:c.Yc[o],text:nt(o),canCheck:!0,checked:t===o,onClick:r.bind(void 0,o)});return n};return(()=>{const{taskGroupingOptions:r,currentTaskGrouping:n,onGroupByChange:o,styles:s}=e;if(!r||ge()(r)||!n)return null;const i={items:[],shouldFocusOnMount:!1,directionalHint:Je.A.bottomRightEdge};for(const e of r)isNaN(Number(e))||i.items.push({key:c.Yc[e],text:nt(e),canCheck:!0,checked:n===e,onClick:o.bind(void 0,e)});const a=nt(n),l=e.showTooltip?Pt.G(Ee.p.Strings.UnoPlanHeader_GroupByText,a):"";return _.createElement(oo.S,{content:l},_.createElement(oi.z,{iconProps:tt.JW,text:Pt.G(Ee.p.Strings.UnoPlanHeader_GroupByText,a),menuProps:t(),menuIconProps:tt.Ju,styles:s}))})()},pi=(0,j.J9)((e,t)=>{const r={root:[(0,Le.gS)("row","nowrap"),{alignItems:"center",columnGap:"12px",overflowX:"auto"}]};return(0,Q.pB)(void 0,r,t)}),di=(0,j.J9)(e=>({root:(0,Q.Zq)("planActionBar",e.root)})),ui=(0,j.J9)((e,t)=>{const r={padding:"0px",minHeight:"32px",[`@media (max-width: ${Re.B.UnoSmallScreenWidth})`]:t&&{minWidth:"36px"},backgroundColor:"inherit"},n={[`@media (max-width: ${Re.B.UnoSmallScreenWidth})`]:t&&{display:"none"}},o={marginLeft:"0px",marginRight:"0px",[`@media (max-width: ${Re.B.UnoSmallScreenWidth})`]:t&&{display:"none !important"}},s={[`@media (min-width: ${Re.B.UnoSmallScreenWidth})`]:{background:"transparent"},color:e.palette.themePrimary},i={background:"transparent",color:e.palette.themePrimary};return{root:r,rootExpanded:t?[s]:[i],rootHovered:t?[s]:[i],rootExpandedHovered:t?[s]:[i],rootPressed:t?[s]:[i],rootFocused:t?{[`@media (min-width: ${Re.B.UnoSmallScreenWidth})`]:{background:"transparent"}}:{background:"transparent"},textContainer:n,menuIcon:o,icon:{color:"inherit",display:"inline-block",marginBottom:"2px"},iconPressed:{color:e.palette.themePrimary}}}),hi=e=>{const t=(0,z.D)(),r=di(pi(t,e.styles));return _.createElement("div",{className:r.root},_.createElement(li,{taskData:e.taskData,buckets:e.buckets,planCategories:e.planCategories,currentTaskFilter:e.currentTaskFilter,setTaskFilter:e.setTaskFilter,getUserPhoto:e.getUserPhoto,onRenderPersona:e.onRenderPersona,members:e.members,theme:e.theme,styles:ui(t,!0),hideSearchBox:!e.isTeamsTabView,showTooltip:e.showTooltip}),_.createElement(ci,{taskGroupingOptions:e.taskGroupingOptions,currentTaskGrouping:e.currentTaskGrouping,onGroupByChange:e.onGroupByChange,theme:e.theme,styles:ui(t,!0),showTooltip:e.showTooltip}))},gi=e=>{const{theme:{palette:t}}=e;return{root:{minWidth:"200px",width:"280px",alignSelf:"center",border:"none",borderRadius:0,background:"transparent",borderBottom:`1px solid ${t.neutralSecondaryAlt}`,"&.is-active":[{"::after":{border:"none",borderBottom:`2px solid ${t.themePrimary}`,borderBottomRightRadius:"0px",borderBottomLeftRadius:"0px"}}]},icon:{color:t.neutralSecondary,marginTop:"6px"},clearButton:{},field:{color:t.neutralPrimary}}},mi=e=>{const{currentTaskFilter:t,setTaskFilter:r}=e,[n,o]=_.useState("");if(!t)return null;return _.createElement(Tr.G,{placeholder:Ee.p.Strings.TaskFiltering_TitleFilterInputPlaceholderText,ariaLabel:Ee.p.Strings.TaskFiltering_FilterTextFieldAriaLabel,iconProps:tt._x,value:n,onChange:(e,n)=>{const s=n??"";let i;i=""===s?t.removeFilter("title"):t.replaceFilter("title",new pr.d("title",[s])),r(i),o(s)},styles:gi})},Ci=(0,j.J9)((e,t,r)=>{const n={root:t?[(0,Le.gS)("row","nowrap"),{alignItems:"center",justifyContent:"space-between",height:Xs,padding:`0 ${Js} 0 ${Js}`,marginLeft:"auto",columnGap:"12px"}]:[(0,Le.gS)("row","nowrap"),{alignItems:"center",justifyContent:"space-between",height:Xs,padding:`0 ${Js} 0 ${Js}`}]};return(0,Q.pB)(void 0,n,r)}),ki=(0,j.J9)(e=>({root:(0,Q.Zq)("planViewHeader",e.root)})),bi=e=>{const t=(0,z.D)(),r=ki(Ci(t,e.isTeamsTabView,e.styles));return e.isTeamsTabView?_.createElement("div",{className:r.root},_.createElement(Vs,e.copilotButtonProps),_.createElement(hi,e.planActionBarProps),_.createElement(Os,e.premiumPlanTrialButtonProps),_.createElement(Ls,e.headerOverflowMenuProps)):_.createElement("div",{className:r.root},_.createElement(mi,e.filterSearchBoxProps),_.createElement(hi,e.planActionBarProps))},Ti=e=>{const t=(0,z.D)(),{root:r,unoPlanHeaderLandmark:n}=ei($s(t,e.isTeamsTabView));return _.createElement(An,{sizeClasses:[""],isAdditive:!0,className:r},_.createElement(wn.H,{className:n,role:"banner","aria-label":""},_.createElement(ni,e.planHeaderProps),_.createElement(bi,e.planViewHeaderProps)))};var Si=r(70149);const Pi=()=>(0,Si.L)(()=>r.e(21724).then(r.bind(r,31002))).then(e=>({default:e.PlanArchivedStateView})),xi=(0,_.lazy)(Pi),yi=(0,j.J9)((e,t,r)=>{const n=[(0,Le.Ph)(e,t),{"::before":[{content:"''",display:"block",width:"100%",height:"100%",position:"absolute",zIndex:"-1",top:"0",left:"0"},e===le.Sx.Light&&{background:"linear-gradient(to bottom, rgba(255, 255, 255, 1) 0%, rgba(255, 255, 255, 0.2) 50%)"},e===le.Sx.Dark&&{background:"linear-gradient(to bottom, rgba(0, 0, 0, 1) 0%, rgba(0, 0, 0, 0.2) 50%)"}]}],o=[(0,Le.Ph)(e,t),(0,Le.GD)()],s={root:n,planErrorView:[(0,Le.Ph)(e,t),(0,Le.gS)("column"),Le.cc,(0,Le.aS)(e),{padding:"10px","> *":{textAlign:"center"},"> .errorText":{fontSize:Q.s.xxLarge,paddingTop:"48px",paddingBottom:"28px"},"> .errorSubText":[{fontSize:Q.s.medium,paddingBottom:"88px"}],".buttonContainers":[(0,Le.gS)("row"),Le.cc,{"> .buttonContainer":{margin:"0px 10px"}}],".buttonContainer":[(0,Le.gS)("row"),Le.cc,{"> .redirectButton":[(0,Le.jU)(e),{width:"200px",height:"38px"}]}],"> .shrug":[(0,Le._D)(e),{fontSize:Q.s.superLarge,lineHeight:"1"}]}],unoPlanErrorView:o,pendingView:{"> .spinner":{display:"flex",height:"100%",width:"100%",alignItems:"center",justifyContent:"center"}},subComponentStyles:{topHeader:fi()}};return(0,Q.pB)(void 0,s,r)}),fi=(0,j.J9)(()=>({root:(0,Le.$Z)(Re.B.TopHeaderHeight)})),vi=(0,j.J9)(e=>({root:(0,Q.Zq)("planView",e.root),planErrorView:(0,Q.Zq)("planErrorView",e.planErrorView),unoPlanErrorView:(0,Q.Zq)("unoPlanErrorView",e.unoPlanErrorView),pendingView:(0,Q.Zq)("pendingView",e.pendingView)}));var Ai,wi,Di=r(62687),Bi=r(97139),Ei=r(39589),Ii=r(64696),Fi=r(17776),Mi=r(40468);!function(e){e[e.Invalid=0]="Invalid",e[e.Plan=1]="Plan"}(Ai||(Ai={})),function(e){e[e.Invalid=0]="Invalid",e[e.Excel=1]="Excel"}(wi||(wi={}));var Li,Ni=r(70252),Ri=r(31408),Ui=r(10871),Oi=r.n(Ui),Hi=r(28673),Vi=r.n(Hi),Gi=r(91733),Wi=r.n(Gi),_i=r(86178),zi=r.n(_i);function Zi(e){return zi().utc().year(e.year()).month(e.month()).date(e.date()).hour(10).minute(0).second(0).millisecond(0)}function Ki(e){switch(e){case Li.Late:return Zi(zi()().subtract(1,"day"));case Li.Today:return Zi(zi()());case Li.Tomorrow:return Zi(zi()().add(1,"day"));case Li.ThisWeek:return Zi(zi()().endOf("week"));case Li.NextWeek:return Zi(zi()().add(7,"days").endOf("week"));case Li.Future:return Zi(zi()().add(7,"days").endOf("week").add(1,"day"));case Li.NoDate:default:return null}}!function(e){e[e.Late=0]="Late",e[e.Today=1]="Today",e[e.Tomorrow=2]="Tomorrow",e[e.ThisWeek=3]="ThisWeek",e[e.NextWeek=4]="NextWeek",e[e.Future=5]="Future",e[e.NoDate=6]="NoDate"}(Li||(Li={}));var qi=r(98424),ji=r(79537),Qi=r(74719),Yi=r(99611),Ji=r(65528);class Xi extends To{getPageReadyMetaTag(){return ae.B.headerlessMode?"headerless":"fullpage"}componentDidUpdate(e,t){super.componentDidUpdate(e,t);const{viewPartitionKey:r,onPlanLoaded:n}=this.props;e.viewPartitionKey!==r&&(null==this.props.planStore.getPlan(r)&&(this.isPlanViewLoaded=!1),this.planViewLoadNotified=!1,this.shouldDispatchPlanViewOpenTriggerAction=!0),this.isPlanViewLoaded&&!this.planViewLoadNotified&&(n(r),this.planViewLoadNotified=!0),this.currentPageName!==this.name()&&(this.shouldDispatchPlanViewOpenTriggerAction=!0,this.currentPageName=this.name()),this.dispatchCampaignTriggerActionsOnUpdate()}componentDidMount(){super.componentDidMount();const{viewPartitionKey:e,onPlanLoaded:t}=this.props;this.isPlanViewLoaded&&!this.planViewLoadNotified&&(t(e),this.planViewLoadNotified=!0),this.currentPageName=this.name()}checkForCriticalViewDataReady(){const{viewPartitionKey:e,bucketStore:t,planStore:r,viewStore:n,taskStore:o}=this.props,s=null!=this.getTaskboardTaskFormatData(),i=null!=o.getTasksForPlan(e),a=n.getCurrentTaskGroupingState(this.taskAccessContext)!==c.Yc.Bucket||!ge()(t.getBucketsForPlan(e)),l=n.getCurrentTaskGroupingState(this.taskAccessContext)!==c.Yc.Category||null!=r.getPlanDetails(e);return!!(i&&a&&s&&l)&&(this.onViewCriticalDataFetchCompletion(),!0)}getTaskData(){const{taskStore:e,viewPartitionKey:t}=this.props;return e.getTasksForPlan(t)??[]}getTaskboardTaskFormatData(){const{viewPartitionKey:e,taskStore:t,viewStore:r}=this.props,n=r.getCurrentTaskGroupingState(this.taskAccessContext);return n!==c.Yc.Assignee&&n!==c.Yc.Bucket&&n!==c.Yc.Progress?[]:t.getTaskboardTaskFormattingForPlan(e,this.getCurrentTaskboardType())??[]}getCurrentTaskboardType(){switch(this.props.viewStore.getCurrentTaskGroupingState(this.taskAccessContext)){case c.Yc.Assignee:return Ni.s.AssignedTo;case c.Yc.Bucket:return Ni.s.Bucket;case c.Yc.Progress:return Ni.s.Progress;default:throw new Error("NotSupportedException: invalid type")}}progressBoardValueSetter(e,t,r,n,o,s){const i=t.setProperty("percentComplete",(0,ir.BK)(r)),a=this.getOrderHintForProgressBoard(n,e),l=this.getOrderHintForProgressBoard(o,e),c=qi.O.generateOrderHintBetween(a,l);let p=e[t.id];p||(p=Bi.j.builder.withPropertyBag({id:t.id,orderHint:void 0}).build());const d=p.setProperty("orderHint",c),u=Ei._.builder.withPropertyBag({progressBoardFormat:p}).build(),h=Ei._.builder.withPropertyBag({progressBoardFormat:d}).build();this.updateOnTaskDragAndDrop(t,i,u,h)}bucketBoardValueSetter(e,t,r,n,o,s){const i=t.setProperty("bucketId",r),a=this.getOrderHintForBucketBoard(n,e),l=this.getOrderHintForBucketBoard(o,e),c=qi.O.generateOrderHintBetween(a,l);let p=e[t.id];p||(p=Fi.g.builder.withPropertyBag({id:t.id,orderHint:void 0}).build());const d=p.setProperty("orderHint",c),u=Ei._.builder.withPropertyBag({bucketBoardFormat:p}).build(),h=Ei._.builder.withPropertyBag({bucketBoardFormat:d}).build();this.updateOnTaskDragAndDrop(t,i,u,h)}assignedToBoardValueSetter(e,t,r,n,o,s){const i=t.getClone();let a,l=!1,c=null,p=null,d=e[t.id];if(d)a=d.getClone();else{d=Ii.x.builder.withPropertyBag({id:t.id,unassignedOrderHint:void 0,orderHintsByAssignee:{}}).build();const s={};let i=null;St()(Vi()(t.assignments),e=>{i=qi.O.generateOrderHintBetween(i,null),s[e]=i}),a=Ii.x.builder.withPropertyBag({id:t.id,unassignedOrderHint:qi.O.generateOrderHintBetween(this.getOrderHintForAssigneeColumn(n,r,e),this.getOrderHintForAssigneeColumn(o,r,e)),orderHintsByAssignee:s}).build()}if(null!=s&&""!==s&&"null"!==s&&(-1!==i.getAssigneeIds().indexOf(s)&&(l=!0,c=s,delete i.assignments[s]),a.orderHintsByAssignee[s]&&delete a.orderHintsByAssignee[s]),null==r||""===r||"null"===r){if(i.getAssigneeIds().length>0){l=!0;i.getAssigneeIds().forEach(e=>{delete i.assignments[e],delete a.orderHintsByAssignee[e]})}a=a.setProperty("orderHintsByAssignee",{}),a=a.setProperty("unassignedOrderHint",qi.O.generateOrderHintBetween(this.getOrderHintForUnassignedColumn(n,e),this.getOrderHintForUnassignedColumn(o,e)))}else-1===i.getAssigneeIds().indexOf(r)&&(l=!0,p=r,i.assignments[r]=new go.I(this.props.appContextStore.getCurrentUserId(),new Date)),a.orderHintsByAssignee[r]=qi.O.generateOrderHintBetween(this.getOrderHintForAssigneeColumn(n,r,e),this.getOrderHintForAssigneeColumn(o,r,e));const u=Ei._.builder.withPropertyBag({assignedBoardFormat:d}).build(),h=Ei._.builder.withPropertyBag({assignedBoardFormat:a}).build();l?this.updateOnTaskDragAndDrop(t,i,u,h):this.updateOnTaskDragAndDrop(t,t,u,h),this.onAssignedToCardValueSetterUpdated(t,i,c,p,r,s)}async updateOnTaskDragAndDrop(e,t,r,n){this.state.isCardChangingCompletedSection&&(t=t.toggleCompletionState());(await this.props.actionCreatorProviders.taskActionCreator()).updateTask(ho.F.builder.withTask(e).withFormatData(r).build(),ho.F.builder.withTask(t).withFormatData(n).build()),this.state.isCardChangingCompletedSection&&this.setState({isCardChangingCompletedSection:!1})}getOrderHintForProgressBoard(e,t){return e&&t[e.id]?t[e.id].orderHint:null}getOrderHintForBucketBoard(e,t){return e&&t[e.id]?t[e.id].orderHint:null}getOrderHintForUnassignedColumn(e,t){return e&&t[e.id]?t[e.id].unassignedOrderHint:null}getOrderHintForAssigneeColumn(e,t,r){let n=null;if(e&&r[e.id]){n=(r[e.id].orderHintsByAssignee??{})[t]}return n||this.getOrderHintForUnassignedColumn(e,r)||""}setupCallbacks(){const{bucketStore:e,userStore:t}=this.props;this.taskCardCallbacks={onAssignTask:this.onAssignTask,getUser:t.getUserById.bind(t),getUserPhoto:t.getUserPhotoById.bind(t),getUsersWithKeyword:this.getUsersWithKeyword,getBuckets:e.getBucketsForPlan.bind(e),getAssigneePool:this.getAssigneePool,getFlights:()=>this.props.flights,getCanUserModifyAssigneePool:e=>{const t=this.props.taskStore.getTask(e);if(!t)return!1;const r=this.props.planStore.getPlan(t.planId);return null!=r&&(this.canUserAddMembers(r)||this.canUserAccessPlanViaSharedContainerOnly(t.planId))},getCanUserAccessPlanViaSharedContainerOnly:this.canUserAccessPlanViaSharedContainerOnly,onUpdateTask:this.onUpdateTask,onUpdateTaskDetails:this.onUpdateTaskDetails,getDocumentPreviewThumbnail:this.props.groupDocumentsStore.getDriveItemThumbnail.bind(this.props.groupDocumentsStore),showAssigneeLimitError:this.onShowAssigneeLimitError,openCopyTaskDialog:this.onCopyTaskClick,openMoveTaskDialog:this.onMoveTaskClick,openDeleteRecurringTaskDialog:this.onDeleteRecurringTaskClick,onCopyLinkToTask:this.onCopyLinkToTask,onRenderPersona:this.onRenderPersona,showInfoBanner:this.showInfoBanner,fetchTaskContainerPermissions:this.fetchPermissionsWithTaskContext,onOpenLink:this.context.openLinkCallback,setLabelsCollapsedState:e=>{this.onSetLabelsCollapsedStateForView(e)},alertUser:this.alertUser,onOpenAssignCallout:this.onOpenAssignCallout,addUserToContainer:()=>{},getAssigneeSuggestions:()=>[],isTaskOnMyDay:this.props.isTaskOnMyDay,toggleMyDayForTask:this.props.toggleMyDayForTask}}getViewClassNames(){return vi(this.getViewStyles())}getViewStyles(){return yi(this.props.appContextStore.getCurrentTheme(),ae.B.isUnoContext,this.props.styles)}getThemedPageStyles(e){if(ae.B.clientType!==u.s.Plex||ae.B.isUnoContext||!this.props.flights.EnableImageRecommendations)return{};let t={};if(null!=e){const r=this.props.planStore.getPlanDetails(e);null!=r?.background.overlayImage&&(t={backgroundImage:`url(${r.background.overlayImage})`,backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundSize:"cover",zIndex:0,position:"relative"})}return t}renderMessageBar(){const{viewPartitionKey:e,planStore:t,loggers:r,appContextStore:n}=this.props,o=t.getPlan(e),s=o?.isArchived;if(!s)return null;const i=o?.archivalInfo?.justification===U.D,a=n.getClientFlavor(),l=a===d.g.SharepointPage||a===d.g.SharepointWebpart;let c=null,p=Ee.p.Strings.NotificationBar_PlanReadOnlyInfo;return i?(l?(p=Ee.p.Strings.NotificationBar_PlanConvertedInfoForSharePoint,c=_.createElement($n.p,{onClick:()=>{const s=t.getPlanDetails(e);s&&function(e){const{plan:t,planDetails:r,projectAppId:n,currentRouteHash:o,loggers:s,target:i}=e;if(!t.isArchived)return!1;for(const a in r?.contextDetails){const e=r.contextDetails[a],l=t?.contexts[a]?.ownerAppId;if(a.startsWith("ConvertPlanToProject")&&l===n){if(null==e.url)return s.traceLogger.logTrace(507357128,Ji.TraceLevel.Error,"checkForArchivedOrConvertedPlan: URL undefined error for converted plan context"),!1;const t=new URLSearchParams(o.split("?")[1]);if("true"===t.get("admin"))return!1;const r=t.get("taskId");let n=e.url;return r&&(n=`${n}&taskId=${r}`),Yn.b.safelyOpenExternalUrl(n,i??"_self"),!1}}new URLSearchParams(o.split("?")[1]).get("admin")}({plan:o,planDetails:s,projectAppId:n.getECSSettings().ApplicationIds.Project,currentRouteHash:"",loggers:r,target:"_blank"})}},Ee.p.Strings.SharedComponents_OpenPlanButton)):(p=Ee.p.Strings.NotificationBar_PlanConvertingInfo,c=_.createElement($n.p,{onClick:()=>Yn.b.safelyOpenExternalUrl(L.importPlanLearnMoreUrl)},Ee.p.Strings.SharedComponents_LearnMoreLink)),_.createElement(eo.n,{messageBarType:to.H.info,"aria-label":Ee.p.Strings.NotificationBar_NotificationBarAriaLabel,actions:c??void 0,isMultiline:!1},_.createElement("span",null,p))):(o?.isArchived&&l&&(p=Ee.p.Strings.NotificationBar_PlanArchivedInfoForSharePoint),_.createElement(eo.n,{messageBarType:to.H.info,"aria-label":Ee.p.Strings.NotificationBar_NotificationBarAriaLabel},_.createElement("span",null,p)))}renderViewCommandBar(){const{appContextStore:e,bucketStore:t,containerStore:r,getSharepointDomainUrl:n,groupDocumentsStore:o,permissionsStore:s,planStore:i,showHeader:a,tenantStore:l,userOutlookCalendarUrlToPublishTasks:m,userStore:b,viewStore:T,taskStore:S,flights:P,isSlimView:x,viewPartitionKey:y,copyLinkToPlanUno:f,exportPlanToExcelUno:v}=this.props;if(!a)return null;const A=e.getCurrentTheme(),w=this.getViewStyles().subComponentStyles?.topHeader,D=i.getPlan(y);if(null==D){const e=i.getPlanStatus(y);return ae.B.isUnoContext&&null!==e?null:_.createElement(uo,{theme:A,topHeaderStyles:w})}const B=s.getPlanPermissions(D);let E=be.DisableNothing;const I=e.getClientFlavor();B.canEdit||B.canFavorite?(!B.canEdit&&B.canFavorite||I===d.g.TeamsPersonalApp)&&(E=be.DisablePlanChanges):E=be.DisableAll;const F=r.getContainer(D.container.externalId),M=F?s.getContainerPermissions(F):s.getDefaultContainerPermissions(D.container),L=M.canViewMembers?this.getContainerMembers(D.container.externalId):[],N=i.getPlanDetails(y),R={title:D.title,visibleContextKeys:this.getVisibleContextKeys(),contexts:D.contexts,contextDetails:N?.contextDetails,theme:A,planContainer:F},U=tr.U.getILabelArray(N?.categories||[],this.props.aggregatesStore.getLabelUsageCountsForPlan(y)).map(e=>e.name),O=S.getTasksForPlan(y)??[];if(I===d.g.LoopSinglePlanApp){const e={onAddMember:this.onAddMember,onRemoveMember:this.onRemoveUserFromPlan,canUserBeRemovedFromContainer:this.canUserBeRemovedFromContainer,getUserWithKeyword:this.getUsersWithKeyword,getUserPhoto:b.getUserPhotoById.bind(b),highlightTasks:this.onHighlightTasks,onRenderPersona:this.onRenderPersona,setTaskFilter:this.onFilterChange,onFilterCalloutVisibleChange:this.onFilterMenuVisibleChange,onGroupByChange:this.onGroupByChange,getBadgeIconAriaLabel:this.getBadgeIconAriaLabel,openPlanSettingsPanel:this.openPlanSettingsPanel,openLeavePlanDialog:this.openLeavePlanDialog,onClickTitleButton:this.onPlanTitleClick,openTasksICalendarDialog:this.openPlanTasksICalendarDialog.bind(D.id),onRenderPlanPhoto:this.onRenderPlanPhoto};return _.createElement(xo,{callbacks:e,renderContextDropdown:!0,renderMembersDropdown:null!=L,contextDropdownProps:R,imageSource:this.getPlanImage(),currentTaskFilter:T.getCurrentTaskFilter(this.getViewKey()),isFilterCalloutVisible:this.state.isFilterMenuVisible,currentTaskGrouping:T.getCurrentTaskGroupingState(this.taskAccessContext),taskGroupingOptions:this.taskGroupingOptions,showGroupByMenuTitleValue:!0,planMembers:L,planContainer:F,planBuckets:t.getBucketsForPlan(y)??[],planCategories:U,planDetails:N,plan:D,taskData:O,disableMode:E,sharedContainersListProps:this.getSharedContainersListProps(D),hasAccessViaSharedContainer:this.getHasAccessViaSharedContainer(D),sensitivityLabels:l.getCurrentSensitivityLabels(),userPermissions:s.getUserPermissions(),containerPermissions:M,flights:P,theme:A})}if(ae.B.isUnoContext){const r={};r[p.yx.GroupId]=D.container.externalId,r[p.yx.PlanId]=y;const n=I===d.g.TeamsTab,o=b.getCurrentUserProjectUpsellExperienceMode(this.props.showUpsellConversion??!1),i=this.props.isPlannerPremiumEnabled?.(),a={navigateToPage:e=>this.navigateToPage(e,r,void 0,p.jf.Other),onUpsellHookClick:e=>{this.logUsage(h.M.UpsellDialogOpenedFromViewPivots,{pageName:e}),this.openConvertPlan()},currentPage:this.name(),plan:D,showUpsellHooks:!!i&&(o!==C.M$.Disabled&&o!==C.M$.RequestAdmin||(this.props.showUpsellConversion??!1)&&s.hasWriteAccessToPremiumPlan()),showTooltip:e.getUnoCurrentPageFormFactorState()!==c.qk.Desktop,theme:A},m=[];n||m.push({key:"MyPlansBreadcrumb",text:Ee.p.Strings.UnoPlanHeader_MyPlans,onClick:()=>this.navigateToMyPlans()},{key:"PlanTitleBreadcrumb",text:D.title,onClick:()=>this.openPlanSettingsPanel(D.id)});const k=b.getFavoritePlansMRU();let S=!1;null!=k?.references&&(S=null!=k.references[y]);const P=async()=>{this.props.loggers.usageLogger.logData(S?h.M.RemoveFromFavorite:h.M.AddToFavorite,"Clicked");(await this.props.actionCreatorProviders.planActionCreator()).setPlanFavoriteStatus(D.id,!S);(await this.props.actionCreatorProviders.userActionCreator()).toggleUserFavoritePlanStatus(D)},x=!!F&&s?.canAccessICalendar(F);let w={openPlanSettingsPanel:e=>this.openPlanSettingsPanel(D.id,e),copyLinkToPlan:()=>f?.(this.getPlanRoutingDetails()),iCalendar:ae.B.clientSettings.Flights.Uno_EnableICalendar&&x&&!n?()=>this.openICalendarDialog(D.id):void 0};ae.B.clientSettings.Flights.Uno_EnableCopyPlan&&ke(ie.getLinksCapabilitiesForPlan(F,L.length,D.container.containerType,this.getHasAccessViaSharedContainer(D)),se.EnableCopy)&&(w={...w,copyPlan:this.copyPlan}),ae.B.clientSettings.Flights.Uno_EnableExportPlanToExcel&&v&&(w={...w,exportPlanToExcel:()=>v(D.id)});const B={breadcrumbItems:m,theme:A,contextDropdownProps:{...R,contextMenuItemCallbacks:w},isCurrentPlanPinned:S,plan:D,imageSource:this.getPlanImage(),togglePlanPinUnpinStatus:()=>P(),isTeamsTabView:n,onRenderPlanPhoto:this.onRenderPlanPhoto,isReadOnly:D.isArchived},E=b.getCurrentUserProjectSubscriptionStatus(),N=b.getCurrentUserProjectUpsellExperienceMode(e.getFlights().EnableTryProjectFeature),H={onClickFeedback:this.onClickFeedback,showFeedbackButton:l.getCurrentTenantFeedbackSettings()?.allowFeedback??!1,theme:A},V=ae.B.isUnoContext&&ae.B.clientType===u.s.Plex,G=null!=E&&((0,Yi.yJ)(E)||N===C.M$.GoToProject)&&E.highestTrialSubscription?.eligibilityStatus!==g.RG.Ineligible,W=(this.props.showUpsellConversion??!1)&&N===C.M$.OfferTrial&&D?.container.containerType===pe.K.Group,z=!W&&N===C.M$.OfferTrial,Z=!W&&N===C.M$.RequestAdmin,K=E?.highestTrialSubscription?.subscriptionStatus,q=K===g.gr.InGracePeriod||K===g.gr.Disabled||K===g.gr.Deprovisioned,j={showTrialStatusButton:!V&&(G||W||z||Z),showTrialStatusButtonText:!q,isTrialActive:null!=E&&E.highestTrialSubscription?.subscriptionStatus===g.gr.Active,isSelfServiceEnabled:N===C.M$.OfferTrial,onClickTrialButton:()=>this.onClickTrialButton(G,W,z,Z),showTooltip:e.getUnoCurrentPageFormFactorState()!==c.qk.Desktop},Q={showCopilotButton:this.props.showCopilotUpsellExperience??!1,onClickCopilotButton:this.onClickCopilotButton,showTooltip:e.getUnoCurrentPageFormFactorState()!==c.qk.Desktop},Y={planTitleSectionProps:B,planViewPivotsProps:a,planStatusSectionProps:{plan:D,planContainer:F,planMembersCount:L.length,showTooltip:e.getUnoCurrentPageFormFactorState()!==c.qk.Desktop,showOverflowMenu:!V,openSharePlanDialog:this.openSharePlanDialog,headerOverflowMenuProps:H,premiumPlanTrialButtonProps:j,copilotButtonProps:Q,canViewMembers:M.canViewMembers},isTeamsTabView:n},J={planActionBarProps:{theme:A,taskGroupingOptions:this.taskGroupingOptions,currentTaskGrouping:T.getCurrentTaskGroupingState(this.taskAccessContext),onGroupByChange:this.onGroupByChange,currentTaskFilter:T.getCurrentTaskFilter(this.getViewKey()),taskData:O,buckets:t.getBucketsForPlan(y)??[],planCategories:U,members:L,getUserPhoto:b.getUserPhotoById.bind(b),setTaskFilter:this.onFilterChange,onRenderPersona:this.onRenderPersona,isTeamsTabView:n,showTooltip:n&&e.getUnoCurrentPageFormFactorState()!==c.qk.Desktop},filterSearchBoxProps:{currentTaskFilter:T.getCurrentTaskFilter(this.getViewKey()),setTaskFilter:this.onFilterChange},headerOverflowMenuProps:H,premiumPlanTrialButtonProps:j,isTeamsTabView:n,copilotButtonProps:Q};return _.createElement(Ti,{planHeaderProps:Y,planViewHeaderProps:J,isTeamsTabView:n})}{const r=I===d.g.TeamsPersonalApp||P.EnableTeamsSplitUI&&I===d.g.TeamsTab,i=ae.B.clientType===u.s.Teams&&!r,a=F?.containerType===pe.K.Group?F:null,c=n?n(a?.unifiedGroupDetails??null):"",h={};h[p.yx.GroupId]=D.container.externalId,h[p.yx.PlanId]=y;const g=b.getUserDetailsById(e.getCurrentUserId())?.favoritePlans;let S=!1;null!=g?.references&&(S=null!=g.references[y]);const f=async e=>{(await this.props.actionCreatorProviders.planActionCreator()).setPlanFavoriteStatus(D.id,e)},v={navigateToPage:e=>this.navigateToPage(e,h,void 0,p.jf.Other),onGroupByChange:this.onGroupByChange,onAddMember:this.onAddMember,onRemoveMember:this.onRemoveUserFromPlan,canUserBeRemovedFromContainer:this.canUserBeRemovedFromContainer,highlightTasks:this.onHighlightTasks,getBreadcrumbUrl:e=>o.getDriveItem(e)?.url??null,getUserWithKeyword:this.getUsersWithKeyword,getUserPhoto:b.getUserPhotoById.bind(b),updatePlanFavoriteStatus:f,openPlanSettingsPanel:this.openPlanSettingsPanel,openLeavePlanDialog:this.openLeavePlanDialog,setTaskFilter:this.onFilterChange,joinGroup:async()=>{(await this.props.actionCreatorProviders.unifiedGroupActionCreator()).joinGroup(D.container.externalId)},copyLinkToPlan:async()=>{(await this.props.actionCreatorProviders.planActionCreator()).copyLinkToPlan(y)},onClickCopyPlan:e=>this.onOpenCopyPlanDialog(e),onClickExportPlanToExcel:e=>this.onExportPlanToExcel(e),onRenderPersona:this.onRenderPersona,onFilterCalloutVisibleChange:this.onFilterMenuVisibleChange,onRenderPlanPhoto:this.onRenderPlanPhoto,openAppAboutDialog:r?this.openTeamsAboutDialog:void 0,getBadgeIconAriaLabel:this.getBadgeIconAriaLabel,onClickTitleButton:this.onPlanTitleClick,openTasksICalendarDialog:this.openPlanTasksICalendarDialog.bind(D.id)},B=b.getCurrentUserProjectUpsellExperienceMode(P.EnableTryProjectFeature),H=B!==C.M$.Disabled,V=b.getCanCurrentUserCopyPlanToProject(P.EnableTryProjectFeature,e.getExperiment(k.b.UpsellImportPlan)===k.b.UpsellImportPlan_treatment,P.EnableImportPlanForTrialUsers,P.EnableImportPlanForProjectUsers);return _.createElement(Xn,{callbacks:v,currentPage:this.name(),currentTaskFilter:T.getCurrentTaskFilter(this.getViewKey()),isFilterCalloutVisible:this.state.isFilterMenuVisible,currentTaskGrouping:T.getCurrentTaskGroupingState(this.taskAccessContext),taskGroupingOptions:this.taskGroupingOptions,showGroupByMenuTitleValue:!0,sensitivityLabels:l.getCurrentSensitivityLabels(),plan:D,planBuckets:t.getBucketsForPlan(y)??[],planDetails:N,isCurrentPlanFavorite:S,flights:P,planMembers:L,planContainer:F,imageSource:this.getPlanImage(),taskData:O,userOutlookCalendarUrlToPublishTasks:m??"",sharepointDomainUrl:c??void 0,hideMembers:ae.B.clientType===u.s.Webpart||ae.B.clientType===u.s.SharepointApp||ae.B.clientType===u.s.Teams||D.container.containerType===pe.K.DriveItem,hideBadgeIcon:P.EnableDocumentTasks&&F?.containerType===pe.K.DriveItem,userPermissions:s.getUserPermissions(),containerPermissions:M,hidePlanNavLinks:!this.props.showPlanViewNavLinks,hideBreadcrumbMenu:!this.props.showPlanContext,hideTitleSection:!this.props.showPlanTitleSection,hideSecondaryLinksContextMenu:r,renderTeamsPivotSection:i,disableMode:E,planCategories:U,isSlimView:x,theme:A,styles:w,isTimelineVisible:H,showGoToProject:B===C.M$.GoToProject,showAppLogo:P.EnableTeamsSplitUI&&I===d.g.TeamsTab,sharedContainersListProps:this.getSharedContainersListProps(D),hasAccessViaSharedContainer:this.getHasAccessViaSharedContainer(D),contextDropdownProps:R,showCopyPlanToProjectLink:V})}}renderPartitionedView(e){const{viewPartitionKey:t,appContextStore:r,planStore:n}=this.props,o=n.getPlan(t),s=n.getPlanStatus(t);if(null==o)return null==s?ae.B.clientType===u.s.Teams?null:this.renderSpinner():ae.B.isUnoContext?this.renderUnoPlanErrorView(t,s):s===b.ZB.Inaccessible?this.renderRequestAccessPermissionView(o):this.renderPlanNotFoundErrorView();if(o.isBeingCreated())return this.renderCreationInProgressView(e);const i=r.getClientFlavor();if(o.isArchived&&(i===d.g.SharepointPage||i===d.g.SharepointWebpart))return this.renderArchivedPlanView(o,e);const a=n.getPlanDetails(t);if(a&&s===b.ZB.Stable){if(!Xi.openedPlans){const e=Mi.T.getSortedDisplayableContexts(o,a);let t;e.length>0&&(t=a.contextDetails[e[0].contextKey].displayAs??"");const r={planId:o.id};t&&(r.displayAs=t),this.logUsage(h.M.OpenPlan,r),this.props.loggers.traceLogger.logTrace(508065228,B.k.Info,`Open Plan Info,\n                        [containerType=${o?.container.containerType}]\n                        [creationProcessType=${o?.creationProcessInfo?.processType}]`),Xi.openedPlans=!0}}else Xi.openedPlans=!1;return this.isPlanViewLoaded=!0,this.renderPlanView()}renderRequestAccessPermissionView(e){if(null==this.props.getSharepointDomainUrl)return null;const t=e?this.props.containerStore.getContainer(e)?.unifiedGroupDetails:null,r=this.props.getSharepointDomainUrl(t),n=!!e&&this.props.containerStore.getContainer(e??"")?.containerType===pe.K.Group&&!!t&&!!r,o=ae.B.clientType===u.s.Plex&&!ae.B.isUnoContext,s=Ee.p.Strings.Errors_AskForAccessText,i=Ee.p.Strings.Errors_UnauthorizedAccessErrorSubTitle;return _.createElement(wn.H,{className:this.getViewClassNames().planErrorView,role:"main"},_.createElement("div",{className:"shrug","aria-label":Ee.p.Strings.SharedComponents_ShrugEmoticonLabel},"\xaf\\_(\u30c4)_/\xaf"),_.createElement("div",{className:"errorText",tabIndex:0,"aria-label":s},s),n&&_.createElement("div",{className:"errorSubText",tabIndex:0,"aria-label":i},i),_.createElement("div",{className:"buttonContainers"},n&&_.createElement("div",{className:"buttonContainer"},_.createElement(K.j,{className:"redirectButton",onClick:()=>{this.logUsage("requestGroupAccess",{groupId:e||""}),Yn.b.safelyOpenExternalUrl(Pt.G(c.Lf.SharepointSiteUrlFormat,r,e),"_blank")}},Ee.p.Strings.Errors_UnauthorizedAccessErrorButtonText)),o&&_.createElement("div",{className:"buttonContainer"},_.createElement(K.j,{className:"redirectButton",onClick:this.redirectToPlanList},Ee.p.Strings.Errors_PlanNotFoundButtonText))))}renderPlanNotFoundErrorView(){return this.renderPlanErrorView(Ee.p.Strings.Errors_PlanNotFoundErrorText,Ee.p.Strings.Errors_PlanNotFoundErrorBody)}renderCreationInProgressView(e){return _.createElement(po,{theme:e,onClickNavigateToHub:()=>this.navigateToPage(p.EC.PlanHub,{},!1,p.jf.Other)})}renderUnoPlanErrorView(e,t){const{appContextStore:r,userStore:n,removePlanFromMyPlans:o,isPlanInMyPlans:s}=this.props,i=r.getClientFlavor()===d.g.TeamsTab,a=null!=n.getCurrentUserDetails().recentPlans.references[e],l={planNotFoundText:Ee.p.Strings.Errors_UnoPlanNotFoundErrorText,planNotFoundBody:Ee.p.Strings.Errors_UnoPlanNotFoundErrorBody,planNotFoundBodyTab:Ee.p.Strings.Errors_UnoTabPlanNotFoundErrorBody,planInaccessibleText:Ee.p.Strings.Errors_UnoPlanInaccessibleErrorText,planInaccessibleBody:Ee.p.Strings.Errors_UnoPlanInaccessibleErrorBody,planGenericErrorText:Ee.p.Strings.Errors_UnoPlanGenericErrorText,planGenericErrorBody:Ee.p.Strings.Errors_UnoPlanGenericErrorBody,navigateToMyPlansButtonText:Ee.p.Strings.Errors_UnoPlanGoBackToPlansButtonText,removeFromMyPlansButtonText:Ee.p.Strings.Errors_UnoPlanRemoveFromRecentsButtonText};return _.createElement(wn.H,{className:this.getViewClassNames().unoPlanErrorView,role:"main"},_.createElement(ne,{strings:l,planStatus:(0,ir.gW)(t),isTeamsTabView:i,isMyPlansPlan:s?.(e)||a,removeFromMyPlansButtonCallback:async()=>{if(null!=o)o(e);else{(await this.props.actionCreatorProviders.planActionCreator()).removePlanFromRecents(e)}this.redirectToPlanList()},navigateToMyPlansButtonCallback:this.redirectToPlanList}))}renderPlanErrorView(e,t){const r=ae.B.clientType===u.s.Plex&&!ae.B.isUnoContext;return _.createElement(wn.H,{className:this.getViewClassNames().planErrorView,role:"main"},_.createElement("div",{className:"shrug","aria-label":Ee.p.Strings.SharedComponents_ShrugEmoticonLabel},"\xaf\\_(\u30c4)_/\xaf"),_.createElement("div",{className:"errorText",tabIndex:0,"aria-label":e},e),_.createElement("div",{className:"errorSubText",tabIndex:0,"aria-label":t},t),r&&_.createElement("div",{className:"buttonContainer"},_.createElement(K.j,{className:"redirectButton",onClick:this.redirectToPlanList},Ee.p.Strings.Errors_PlanNotFoundButtonText)))}renderArchivedPlanView(e,t){return _.createElement(xi,{plan:e,theme:t})}renderSpinner(){return _.createElement("div",{className:this.getViewClassNames().pendingView},_.createElement("div",{className:"spinner"},_.createElement(ro.y,{size:no.H.large})))}getSharedContainersListProps(e){const{appContextStore:t,groupDocumentsStore:r}=this.props;return(0,Qi.qg)({sharedWithContainers:e.sharedWithContainers,getDriveItemStatus:e=>r.getDriveItemStatus(e),getDriveItem:e=>r.getDriveItem(e)},t.getCurrentTheme(),this.props.loggers.traceLogger)}getHasAccessViaSharedContainer(e){const{groupDocumentsStore:t}=this.props;return(0,Qi.NL)({sharedWithContainers:e.sharedWithContainers,getDriveItemStatus:e=>t.getDriveItemStatus(e)})}onAssignedToCardValueSetterUpdated(e,t,r,n,o,s){}dispatchCampaignTriggerActionsOnUpdate(){const{dispatchCampaignTriggerActions:e}=this.props;if(!e||!this.shouldDispatchPlanViewOpenTriggerAction||!this.checkForCriticalDataReady())return;this.shouldDispatchPlanViewOpenTriggerAction=!1;const t=[s.PlanViewOpen,s.BasicPlanViewOpen];switch(this.name()){case p.EC.PlanTaskboard:t.push(s.BasicBoardViewOpen);break;case p.EC.PlanGrid:t.push(s.BasicGridViewOpen);break;case p.EC.PlanSchedule:t.push(s.BasicScheduleViewOpen);break;case p.EC.PlanCharts:t.push(s.BasicChartsViewOpen)}e(t)}constructor(){super(...arguments),this.isPlanViewLoaded=!1,this.planViewLoadNotified=!1,this.shouldDispatchPlanViewOpenTriggerAction=!0,this.taskAccessContext=Di.t.Plan,this.taskGroupingOptions=T,this.usageloggingConstant=h.M.PlanViewComponent,this.isGroupMember=null,this.loggedUnbucketedTasks=!1,this.categoryBoardValueSetter=(e,t,r,n,o)=>{let s=e.getClone(),i=!1;if(null!=o&&"null"!==o){const e=parseInt(o,10),t=s.appliedCategories.indexOf(e);-1!==t&&(i=!0,s.appliedCategories.splice(t,1),this.props.loggers.usageLogger.logData(this.usageloggingConstant,h.M.RemoveLabelFromTask))}if(null==t||"null"===t)s.appliedCategories.length>0&&(i=!0,s=s.setProperty("appliedCategories",[]),this.props.loggers.usageLogger.logData(this.usageloggingConstant,h.M.RemoveLabelFromTask));else{const e=parseInt(t,10);-1===s.appliedCategories.indexOf(e)&&(i=!0,s.appliedCategories.push(e),this.props.loggers.usageLogger.logData(this.usageloggingConstant,h.M.AddLabelToTask,{isNewLabel:String(e>5)}))}i&&this.updateOnTaskDragAndDrop(e,s)},this.dueDateBoardValueSetter=(e,t,r,n,o)=>{if(t?.toString()!==o?.toString()){const r=Ki(t);null==r&&e.recurrence?.isActive()&&this.logUsage(h.M.RecurrenceCanceledDueDate);const n=e.setDueDate(r);this.updateOnTaskDragAndDrop(e,n)}},this.priorityBoardValueSetter=(e,t,r,n,o)=>{if(t?.toString()!==o?.toString()){const r=e.setProperty("priority",(0,ir._d)(t));this.updateOnTaskDragAndDrop(e,r)}},this.completedSectionValueSetter=(e,t)=>{t!==this.completedTaskClassifier(e)&&this.setState({isCardChangingCompletedSection:!0})},this.canUserAddMembers=e=>{const{containerStore:t,permissionsStore:r}=this.props,n=t.getContainer(e.container.externalId);return(n?r.getContainerPermissions(n):r.getDefaultContainerPermissions(e.container)).canAddMembers},this.getTaskHighlightedType=e=>{const t={assigneeHighlighted:!1,wywaBorderHighlighted:this.props.wywaStore.isModifiedTask(e.id),wywaAnimated:this.props.wywaStore.isModifiedTask(e.id)&&this.props.wywaStore.getAnimatedModifiedTasks()};if(this.state.highlightField===c.JS.Assignee){const r=this.state.highlightValue;null!=e.assignments[r]&&(t.assigneeHighlighted=!0)}else t.assigneeHighlighted=!1;return t},this.onOpenCopyPlanDialog=async e=>{this.props.loggers.usageLogger.logData(this.usageloggingConstant,h.M.CopyPlanDialogOpened);(await this.props.actionCreatorProviders.dialogActionCreator()).openCopyPlan(e)},this.onCreateTask=async(e,t,r,n)=>{let o,s,i;const a=this.getTaskboardTaskFormatData(),l=Oi()(a,"id"),p=this.props.viewStore.getCurrentTaskGroupingState(this.taskAccessContext);switch(p){case c.Yc.Bucket:e=e.setProperty("bucketId",t),s=Fi.g.builder.withPropertyBag({id:e.id,orderHint:qi.O.generateOrderHintBetween(this.getOrderHintForBucketBoard(r,l),this.getOrderHintForBucketBoard(n,l))}).build();break;case c.Yc.Assignee:null!=t&&(e.assignments[t]=new go.I(this.props.appContextStore.getCurrentUserId(),new Date)),o=Ii.x.builder.withPropertyBag({id:e.id,unassignedOrderHint:qi.O.generateOrderHintBetween(this.getOrderHintForUnassignedColumn(r,l),this.getOrderHintForUnassignedColumn(n,l)),orderHintsByAssignee:Wi()(e.assignments,(e,t)=>qi.O.generateOrderHintBetween(this.getOrderHintForAssigneeColumn(r,t,l),this.getOrderHintForAssigneeColumn(n,t,l)))}).build();break;case c.Yc.Progress:e=e.setProperty("percentComplete",(0,ir.BK)(t)),i=Bi.j.builder.withPropertyBag({id:e.id,orderHint:qi.O.generateOrderHintBetween(this.getOrderHintForProgressBoard(r,l),this.getOrderHintForProgressBoard(n,l))}).build();break;case c.Yc.Category:null!=t&&(e=e.setProperty("appliedCategories",[t]));break;case c.Yc.DueDate:e=e.setDueDate(Ki(t));break;case c.Yc.Priority:e=e.setProperty("priority",(0,ir._d)(t));break;case c.Yc.Plan:case c.Yc.None:break;default:return void ji.f.unreachableCase(p,e=>{this.props.loggers.traceLogger.logTrace(508065227,B.k.Error,e)})}const d=Ei._.builder.withPropertyBag({assignedBoardFormat:o,bucketBoardFormat:s,progressBoardFormat:i}).build();(await this.props.actionCreatorProviders.taskActionCreator()).createTask(ho.F.builder.withTask(e).withFormatData(d).build())},this.onAddUserToContainer=async e=>{const t=this.props.planStore.getPlan(this.props.viewPartitionKey);if(null!=t?.container){(await this.props.actionCreatorProviders.userActionCreator()).addUsersToContainer([e],t.container)}},this.onRemoveUserFromPlan=async e=>{const{actionCreatorProviders:t,planStore:r,containerStore:n,viewPartitionKey:o}=this.props;if(null==e)return;const s=r.getPlan(o);if(null==s)return;const i=n.getContainer(s.container.externalId),a=i?this.getContainerMembers(i.externalId):[];let l=!1;for(let c=0;c<a.length;c++)if(a[c].id===e){l=!0;break}if(l)if(e===this.props.appContextStore.getCurrentUserId()){(await t.dialogActionCreator()).openLeavePlanDialog(s.id)}else{(await t.userActionCreator()).removeUserFromContainer(e,s.container)}},this.onHighlightTasks=async(e,t)=>{if(ae.B.clientType!==u.s.Loop){(await this.props.actionCreatorProviders.wywaActionCreator()).setAnimateModifiedTasks(!1)}this.setState(r=>r.highlightField!==e||r.highlightValue!==t?{highlightField:e,highlightValue:t}:{highlightField:null,highlightValue:null})},this.onExportPlanToExcel=async e=>{(await this.props.actionCreatorProviders.exportActionCreator()).requestExportOperation(e,wi.Excel,Ai.Plan)},this.onGetAssigneeSuggestion=(e,t)=>{const r=this.props.assigneeSuggestionStore?.getAssigneeSuggestions(e,null!=t?this.props.taskStore.getSimilarTasks(t):[]);if(null!=r){const e=[];for(const t of r){const r=this.props.userStore.getUserById(t.userId);null!=r&&e.push(new Ri.D(r,t.context,t.weight))}return e}return[]},this.getContainerMembers=e=>this.props.userStore.getContainerUsers(e)??[],this.onAddMember=async e=>{const t=this.getPlanContainer();if(null==t)return;(await this.props.actionCreatorProviders.userActionCreator()).addUsersToContainer([e],t.id)},this.getPlanContainer=()=>{const{viewPartitionKey:e,planStore:t,containerStore:r}=this.props,n=t.getPlan(e);return n&&r.getContainer(n.container.externalId)},this.canUserBeRemovedFromContainer=e=>{const t=this.getPlanContainer(),r=t?this.getContainerMembers(t.externalId):[];if(t?.containerType===pe.K.Roster)return r.length>1;if(t?.containerType!==pe.K.Group)return!1;const n=t;if(!n.unifiedGroup||!n.unifiedGroupDetails||!n.unifiedGroupDetails.owners)return!1;const o=n.unifiedGroupDetails.owners.length>1;return!(-1!==pn()(n.unifiedGroupDetails.owners,t=>t.id===e)&&!o)},this.onPlanTitleClick=e=>{const{viewPartitionKey:t,planStore:r,containerStore:n}=this.props,o=r.getPlan(t);if(null==o)return;const s=n.getContainer(o.container.externalId),i=s?this.getContainerMembers(s.externalId):[],a=ke(ie.getLinksCapabilitiesForPlan(s,i.length,o.container.containerType,this.getHasAccessViaSharedContainer(o)),se.EnableSettings);this.getPlanHeaderDisableMode(o)===be.DisableNothing&&a&&this.openPlanSettingsPanel(t,e)},this.openPlanSettingsPanel=async(e,t)=>{(await this.props.actionCreatorProviders.dialogActionCreator()).openPlanSettingsPanel(e,t)},this.copyPlan=()=>{this.onOpenCopyPlanDialog(this.props.viewPartitionKey)},this.navigateToMyPlans=async()=>{(await this.props.actionCreatorProviders.navigationActionCreator()).navigate(p.EC.PlanHub,{})},this.openConvertPlan=()=>{this.props.openConvertPlanModal?.()},this.openLeavePlanDialog=async e=>{(await this.props.actionCreatorProviders.dialogActionCreator()).openLeavePlanDialog(e)},this.getPlanHeaderDisableMode=e=>{const{permissionsStore:t,appContextStore:r}=this.props,n=t.getPlanPermissions(e);let o=be.DisableNothing;return n.canEdit||n.canFavorite?(!n.canEdit&&n.canFavorite||r.getClientFlavor()===d.g.TeamsPersonalApp)&&(o=be.DisablePlanChanges):o=be.DisableAll,o},this.openPlanTasksICalendarDialog=async e=>{(await this.props.actionCreatorProviders.dialogActionCreator()).openPublishTasksToCalenderDialog(e)},this.openTeamsAboutDialog=async()=>{(await this.props.actionCreatorProviders.dialogActionCreator()).openTeamsAboutDialog()},this.openSharePlanDialog=async e=>{(await this.props.actionCreatorProviders.dialogActionCreator()).openSharePlanDialog(e,[])},this.onClickTrialButton=async(e,t,r,n)=>{e?this.props.openUpsellStatusModal?.():t?this.props.openConvertPlanModal?.():r?this.props.openTryPremiumModal?.(C.vR.Header):n&&this.props.openRequestPremiumLicenseModal?.()},this.onClickCopilotButton=async()=>{const{userStore:e,permissionsStore:t}=this.props;switch(e.p3TrialEligibilityStatus()){case g.RG.EligibleForSelfService:return void this.props.openCopilotUpsellModal?.();case g.RG.EligibleToRequestOnly:return void this.props.openRequestPremiumLicenseModal?.()}const r=e.getCurrentUserProjectSubscriptionStatus(),n=r&&(0,Yi.yJ)(r),o=t.canAccessCopilot();n||!n&&o?this.props.openCopilotUpsellModal?.():this.props.openGetSubscriptionCallout?.()},this.onClickFeedback=async()=>{this.props.openInAppFeedback?.()},this.getPlanImage=()=>{const{planStore:e,containerStore:t,viewPartitionKey:r}=this.props,n=e.getPlan(r);if(null==n)return null;const o=e.getPlanDetails(r);return(0,xt.R6)(n,o,t.getContainerPhotoById.bind(t))},this.getBadgeIconAriaLabel=()=>{const{flights:e}=this.props,t=this.getPlanContainer();let r;if(e.EnableDocumentTasks&&t?.containerType===pe.K.DriveItem)r=Ee.p.Strings.PlanHeader_BadgeIconTextDocumentPlan;else if(t?.containerType===pe.K.Group){const e=t;r=e.unifiedGroup?e.unifiedGroup.visibility===ue.X.Public?Ee.p.Strings.PlanHeader_BadgeIconTextPublicPlan:Ee.p.Strings.PlanHeader_BadgeIconTextPrivatePlan:void 0}else t?.containerType===pe.K.Roster&&this.getVisibleContextKeys().length>0&&(r=Ee.p.Strings.PlanHeader_BadgeIconTextRosterPlan);return r},this.getVisibleContextKeys=()=>{const{viewPartitionKey:e,planStore:t}=this.props,r=t.getPlan(e),n=t.getPlanDetails(e),o=[];for(const s in n?.contextDetails)n?.contextDetails[s].isVisible()&&null!=r?.contexts[s]&&o.push(s);return o},this.getPlanRoutingDetails=()=>{const{viewPartitionKey:e,planStore:t}=this.props,r=t.getPlan(e);return{planId:e,planType:F.Basic,planName:r?.title}},this.renderUncategorizedBucketHeaderImage=()=>_.createElement(oo.S,{content:Ee.p.Strings.Bucket_NullBucketInfoIconText},_.createElement(xe.I,{...tt.an,"aria-label":Ee.p.Strings.Bucket_NullBucketInfoIconText,"aria-hidden":"false"})),this.redirectToPlanList=()=>{this.navigateToPage(p.EC.PlanHub,{},void 0,p.jf.Other)},this.openICalendarDialog=async e=>{this.props.loggers.usageLogger.logData(this.usageloggingConstant,h.M.ICalendarDialogOpened);(await this.props.actionCreatorProviders.dialogActionCreator()).openPublishTasksToCalenderDialog(e)},this.onRenderPlanPhoto=async()=>{const{viewPartitionKey:e,actionCreatorProviders:t}=this.props;(await t.unifiedGroupActionCreator()).ensureGroupPhotoForPlan(e)}}}Xi.contextType=m.Do,Xi.openedPlans=!1;var $i,ea=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ta=function(){return ta=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},ta.apply(this,arguments)};!function(e){e[e.Board=0]="Board",e[e.List=1]="List"}($i||($i={}));var ra=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.boardViewUlElementRef=_.createRef(),n.dragToScrollData={isDragging:!1,initialScrollValue:0},n.onPointerDown=function(e){n.props.enableDragToScroll&&n.boardViewUlElementRef.current&&e.target instanceof HTMLElement&&e.target.dataset.canDragToScroll&&"mouse"===e.pointerType&&0===e.button&&(n.boardViewUlElementRef.current.setPointerCapture(e.pointerId),n.dragToScrollData={isDragging:!0,initialScrollValue:n.boardViewUlElementRef.current.scrollLeft+e.clientX})},n.onPointerMove=function(e){n.dragToScrollData.isDragging&&n.boardViewUlElementRef.current&&e.clientX&&(e.preventDefault(),n.boardViewUlElementRef.current.scrollLeft=n.dragToScrollData.initialScrollValue-e.clientX)},n.onPointerUp=function(e){var t;null===(t=n.boardViewUlElementRef.current)||void 0===t||t.releasePointerCapture(e.pointerId),n.dragToScrollData.isDragging=!1},n.state={placeholderIndex:null,draggedColumnIndex:null},n._previousPointerPosition=null,n}return ea(t,e),t.prototype.name=function(){return"BoardView"},t.prototype.renderComponent=function(){var e=this,t=this.props.columnDefinitions.map(function(t,r){return e.renderBoardViewColumn(t,r)});if(this.props.isOver&&null!=this.state.placeholderIndex&&t.splice(this.state.placeholderIndex,0,_.createElement("li",{key:"placeholderColumn","data-dnd-role":"placeholder",className:this.props.placeholderColumnClassName})),null==this.props.connectDropTarget)throw new Error("connectDropTarget not defined");var r=this.props.enableDragToScroll?{onPointerDown:this.onPointerDown,onPointerMove:this.onPointerMove,onPointerUp:this.onPointerUp}:null;return this.props.connectDropTarget(_.createElement("div",{className:this.props.boardViewClassName},this.renderDragPreviews(),_.createElement("ul",ta({ref:this.boardViewUlElementRef},r),t,this.props.columnCreationEnabled?this.renderAddColumnControl():null)))},t.prototype.boardCollect=function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver()}},t.prototype.boardTarget=function(){return{drop:function(e,t,r){var n=r,o=n.props.callbacks.onColumnDrop;if(o){var s=n.state.placeholderIndex;if(null==t)throw new Error("monitor not defined");var i=t.getItem(),a=s===i.props.index+1?s-2:s-1,l=s===i.props.index&&i.props.index===n.props.columnDefinitions.length-1,c=n.props.columnDefinitions[s]&&!l?n.props.columnDefinitions[s].pivotValue:null,p=n.props.columnDefinitions[a]?n.props.columnDefinitions[a].pivotValue:null;o(i.props.pivotValue,p,c)}},hover:fn()(function(e,t,r){if(null==t)throw new Error("monitor not defined");var n=r,o=t.getClientOffset(),s=n.state.placeholderIndex;if(null!=o){var i=n.getDisplayMode()===$i.List?o.y:o.x,a=null===n._previousPointerPosition?0:i-n._previousPointerPosition;n._previousPointerPosition=i;var l=document.elementFromPoint(o.x,o.y);if(null!==(l=n.findTarget(l))){var c=parseInt(l.getAttribute("data-index")||"",10),p=l.getBoundingClientRect().top+l.getBoundingClientRect().bottom,d=l.getBoundingClientRect().left+l.getBoundingClientRect().right,u=i-(n.getDisplayMode()===$i.List?p:d)/2>=0;if((null===s||Math.abs(c-s)>1)&&u&&(c+=1),s===c&&(c+=1),!(a<0&&c===s+1||a>0&&c===s-1||0===a&&null!==s)&&null!==c&&c!==s){var h=t.getItem();n.setPlaceholder(c,h.props.index)}}}},50)}},t.prototype.findTarget=function(e){return null==e||"placeholder"===e.getAttribute("data-dnd-role")?null:("column"===e.getAttribute("data-dnd-role")||(e=e.parentElement,e=this.findTarget(e)),e)},t.prototype.setPlaceholder=function(e,t){this.setState({placeholderIndex:e,draggedColumnIndex:t})},t.prototype.renderDragPreviews=function(){return null},t.prototype.renderAddColumnControl=function(){return null},t.prototype.getDisplayMode=function(){return this.props.displayMode||$i.Board},t}(ce.$),na=r(46646),oa=r(11034),sa=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ia=function(e){function t(t,r){return e.call(this,t,r)||this}return sa(t,e),t.prototype.renderComponent=function(){return this.props.connectDragSource?this.props.connectDragSource(_.createElement("li",{className:this.props.className,style:{display:this.props.isDragging?"none":""},"data-index":this.props.index,"data-dnd-role":!0===this.props.disableDrag?void 0:"column"},this.renderColumnHeader(),this.renderColumnBody())):null},t.prototype.columnSource=function(){return{beginDrag:function(e){return{props:e}},canDrag:function(e){return!0!==e.disableDrag}}},t.prototype.columnCollect=function(e,t){return{isDragging:t.isDragging(),connectDragSource:e.dragSource()}},t.prototype.name=function(){return"BoardColumn"},t}(ce.$),aa=r(75886),la=r(11079),ca=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),pa=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n._previousPointerYPosition=null,n}return ca(t,e),t.prototype.renderComponent=function(){var e=this,t=this.renderSectionToggle(),r=this.renderAddButton(),n=this.props.data.map(function(t,r){return e.renderEntityCard(t,r)}),o=this.props.isOver?this.state.placeholderIndex:null;if(null!=o&&n.splice(o,0,_.createElement("div",{style:{position:"relative"},key:"placeholder",className:this.props.placeholderCardClassName,"data-dnd-role":"placeholder"},_.createElement("div",{style:{opacity:0,visibility:"hidden"}},this.renderEntityCard(this.props.isOver?this.state.draggedEntity:null,null)))),null==this.props.connectDropTarget)throw new Error("connectDropTarget not defined");return this.props.connectDropTarget(_.createElement("div",{className:this.props.columnGroupClassName,"data-dnd-role":"columnGroup"},this.props.isCollapsable?t:null,_.createElement("div",{"data-dnd-role":"topDropZone",className:this.props.topDropZoneClassName},null!=this.props.callbacks.addCardControlProvider?r:null),_.createElement("ul",{className:this.state.showSection?void 0:"hidden"},null!=this.props.callbacks.addCardControlProvider&&this.state.showAddEntityCard?this.renderAddCardControl():null,n),this.state.showSection?_.createElement("div",{"data-dnd-role":"bottomDropZone",className:this.props.bottomDropZoneClassName}):null))},t.prototype.groupTarget=function(){return{drop:function(e,t,r){var n=r,o=n.props.callbacks.valueSetter,s=n.state.placeholderIndex;if(n.onDrop(n.props,t,r),null==t)throw new Error("monitor not defined");if("card"===t.getItemType()){var i=t.getItem(),a=i.sourceColumnValue===n.props.columnValue&&i.secondaryGrouping===n.props.secondaryGrouping,l=void 0;l=a&&s===i.index+1?s-2:s-1;var c=!1;a&&(c=s===i.index&&i.index===n.props.data.length-1);var p=n.props.data[s]&&!c?n.props.data[s]:null,d=n.props.data[l]?n.props.data[l]:null,u=n.props.callbacks.secondaryValueSetter;u&&u(i.entity,n.props.secondaryGrouping,i.secondaryGrouping),o(i.entity,d,p,i.sourceColumnValue)}},hover:fn()(function(e,t,r){var n=r;if(n.onHover(e,t,r),null==t)throw new Error("monitor not defined");if("card"===t.getItemType()){var o=t.getItem(),s=t.getClientOffset();if(null==s)return;var i=null===n._previousPointerYPosition?0:s.y-n._previousPointerYPosition;n._previousPointerYPosition=s.y;var a=document.elementFromPoint(s.x,s.y);if((a=n.findTarget(a))&&"topDropZone"===a.getAttribute("data-dnd-role")&&n.setPlaceholder(0,o),a&&"bottomDropZone"===a.getAttribute("data-dnd-role")&&n.setPlaceholder(n.props.data.length,o),a&&"card"===a.getAttribute("data-dnd-role")){var l=s.y-(a.getBoundingClientRect().top+a.getBoundingClientRect().bottom)/2<=0,c=parseInt(a.getAttribute("data-index")||"",10),p=n.state.placeholderIndex;if((null===p||Math.abs(c-p)>1)&&!l&&(c+=1),p===c&&(c+=1),i<0&&c===p+1||i>0&&c===p-1||0===i&&null!==n.state.placeholderIndex)return;n.setPlaceholder(c,o)}a&&"sectionToggle"===a.getAttribute("data-dnd-role")&&(!1===n.state.showSection&&n.setState({showSection:!0}),n.setPlaceholder(0,o))}},50)}},t.prototype.groupCollect=function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver()}},t.prototype.name=function(){return"BoardColumnGroup"},t.prototype.findTarget=function(e){if(null==e)return null;var t=e.getAttribute("data-dnd-role");return"placeholder"===t?null:("card"===t||"columnGroup"===t||"sectionToggle"===t||null===t&&(e=e.parentElement,e=this.findTarget(e)),e)},t.prototype.setPlaceholder=function(e,t){this.setState({draggedEntity:t.entity,placeholderIndex:e})},t.prototype.renderSectionToggle=function(){return _.createElement("div",{className:"sectionToggle","data-dnd-role":"sectionToggle",onClick:this.toggleShowSection.bind(this)},_.createElement("div",{className:"icon"},_.createElement(xe.I,{iconName:"ChevronDown",className:this.state.showSection?"rotated":"straight"})),_.createElement("div",{className:"toggleText"},this.props.callbacks.sectionTitleProvider?this.props.callbacks.sectionTitleProvider(this.state.showSection):""),_.createElement("div",{className:"sectionItemCount"},this.props.data.length),_.createElement("div",{className:"labelSpacer"}))},t.prototype.renderAddButton=function(){return _.createElement("div",{className:"addButtonContainer"},_.createElement("button",{className:"addButton",onClick:this.toggleAddCardControl.bind(this)},_.createElement(xe.I,{iconName:"Add"})),_.createElement("div",{className:"labelSpacer"}))},t.prototype.toggleAddCardControl=function(){this.props.callbacks.addCardControlProvider&&this.setState({showAddEntityCard:!this.state.showAddEntityCard})},t.prototype.toggleShowSection=function(){!0===this.props.isCollapsable&&this.setState({showSection:!this.state.showSection})},t.prototype.onDrop=function(e,t,r){},t.prototype.onHover=function(e,t,r){},t}(ce.$),da=r(79966);const ua="44px",ha="15px",ga="12px",ma="30px",Ca="32px",ka=Re.B.ShadowMargin,ba="4px",Ta="5px",Sa="288px",Pa="260px",xa=(0,j.J9)(e=>{let t;switch(e){case le.Sx.LoopLight:t={boxShadow:Re.B.LoopLightRestShadow,backgroundColor:Ne.z.White,":hover":{backgroundColor:Ne.z.NeutralLightGrey96,boxShadow:Re.B.LoopLightHoverShadow},":active":{backgroundColor:Ne.z.NeutralLightGrey96,boxShadow:Re.B.LoopLightRestShadow}};break;case le.Sx.LoopDark:t={boxShadow:Re.B.LoopDarkRestShadow,backgroundColor:Ne.z.NeutralDarkGrey20,":hover":{backgroundColor:Ne.z.NeutralDarkGrey24,boxShadow:Re.B.LoopDarkHoverShadow},":active":{backgroundColor:Ne.z.NeutralDarkGrey24,boxShadow:Re.B.LoopDarkRestShadow}}}return t}),ya=(0,_e.vb)((0,_e.jz)(Sa)+(0,_e.jz)(Re.B.ScrollbarSpaceAround)),fa=(0,j.J9)((e,t,r,n,o)=>{let s=`0 ${ha}`;switch(e){case le.Sx.TeamsLight:case le.Sx.TeamsDark:case le.Sx.TeamsContrast:o||n||(s=`0 ${ma} 0 0`);break;case le.Sx.LoopLight:case le.Sx.LoopDark:s=`0 ${ga}`;case le.Sx.Light:case le.Sx.Dark:case le.Sx.SharePoint:}return[(0,Le.gS)("column"),e===le.Sx.SharePoint&&{outline:"none"},t===$i.Board&&[{padding:s},e===le.Sx.SharePoint&&{"&:nth-child(1)":{paddingLeft:"0px"},"&:nth-last-child(1)":{paddingRight:"0px"}}],t===$i.List&&{display:"table"},{boxSizing:"contentBox","> .columnContent":[(0,Le.gS)("column"),(0,Le.GD)("100%"),{marginLeft:`-${ka}`,marginRight:`-${ka}`}]},r&&{".columnContent":[{overflowX:"hidden",overflowY:"auto"}]}]}),va=(0,j.J9)(e=>{let t=Sa;switch(e){case le.Sx.LoopLight:case le.Sx.LoopDark:t=Pa;case le.Sx.Light:case le.Sx.Dark:case le.Sx.TeamsLight:case le.Sx.TeamsDark:case le.Sx.TeamsContrast:case le.Sx.SharePoint:}return{paddingLeft:ka,paddingRight:ka,"> .columnHeaderTitle":[(0,Le.$Z)(),(0,Le.gS)(),{width:t}]}}),Aa=(0,j.J9)((e,t)=>[(0,Le.GD)(),(0,Le.gS)(),(0,Le.q0)(),(0,Le.aS)(e),{height:Ca,lineHeight:Ca,margin:`0px -${Ta}`,fontSize:Q.s.medium,fontWeight:Q.BO.semibold,"> *":{margin:`0px ${Ta}`},"> .columnTitle":[(0,Le.GD)(),(0,Le.gS)(),{cursor:t?"default":"pointer",".plannerIcon":{display:"none"},"> h3":[Le.xK,(0,Le.GD)(),(0,Le.q0)()]}],"> .editColumnTextField":[(0,Le.GD)(),{".ms-TextField-field":{paddingLeft:"10px"}}]},(e===le.Sx.LoopLight||e===le.Sx.LoopDark)&&{paddingTop:Re.B.ShadowMargin}]),wa=e=>{switch(e){case le.Sx.Light:return Ne.z.NeutralLighter;case le.Sx.TeamsLight:return Ne.z.NeutralLight;case le.Sx.Dark:case le.Sx.TeamsDark:return Ne.z.DarkThemeAppBackgroundColor;case le.Sx.TeamsContrast:return Ne.z.Black;case le.Sx.SharePoint:return Ne.z.SharepointAddTaskButtonBackgroundColor();case le.Sx.LoopLight:return Ne.z.NeutralLighter;case le.Sx.LoopDark:return Ne.z.DarkThemeAppBackgroundColor;default:return""}},Da=(0,j.J9)(e=>{const t={root:{margin:`${ba} 0px`,position:"relative",width:"100%","&.ui-draggable-dragging":{opacity:"0.75"}},preview:{width:Sa}};return(0,Q.TW)(t,e)}),Ba=(0,j.J9)(e=>{const t=Da(e);return{root:(0,Q.Zq)("taskBoardCard",t.root),preview:(0,Q.Zq)("taskBoardCardPreview",t.preview)}});var Ea=r(17961),Ia=r.n(Ea),Fa=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ma=function(e){function t(t,r){return e.call(this,t,r)||this}return Fa(t,e),t.prototype.renderComponent=function(){return this.props.connectDragSource&&this.props.connectDropTarget?this.props.connectDragSource(this.props.connectDropTarget(_.createElement("div",{className:this.props.className,style:{display:this.props.isDragging?"none":""},"data-index":this.props.index,"data-dnd-role":"card","aria-posinset":this.props.taskBoardCardPositionInColumnGroup,"aria-setsize":this.props.totalTasksInColumnGroup},this.cardRenderer()))):null},t.prototype.cardSource=function(){return{beginDrag:function(e){return{entity:e.entity,index:e.index,sourceColumnValue:e.columnValue,secondaryGrouping:e.secondaryGrouping}}}},t.prototype.cardTarget=function(){return{drop:this.onDrop.bind(this)}},t.prototype.cardCollect=function(e,t){return{isDragging:t.isDragging(),connectDragSource:e.dragSource(),connectDragPreview:e.dragPreview()}},t.prototype.cardTargetCollect=function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver()}},t.prototype.name=function(){return"BoardCard"},t}(ce.$),La=r(64226);const Na=_.createContext({isLabelCollapsed:!1});var Ra=r(10859),Ua=r(9100),Oa=r(15987),Ha=function(){return Ha=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Ha.apply(this,arguments)},Va=function(e){return _.createElement(Ns.r,Ha({"aria-label":e.ariaLabel,tabIndex:e.isKeyboardFocusable?0:-1,"data-is-focusable":e.isKeyboardFocusable,title:e.ariaLabel},e),e.label)},Ga=r(51129);const Wa="6px",_a="12px",za="16px",Za="16px",Ka="18px",qa="10px",ja="236px",Qa=(0,_e.vb)((0,_e.jz)(ja)-(0,_e.jz)(Ka)),Ya="20px",Ja="2px",Xa="8px",$a="2px",el="85px",tl="32px",rl="4px",nl=`1px solid ${Ne.z.WywaLightColor}`,ol=`1px solid ${Ne.z.WywaDarkColor}`,sl=`1px solid ${Ne.z.WywaTeamsLightColor}`,il=`1px solid ${Ne.z.TeamsAppBrand00}`,al=`1px solid ${Ne.z.WywaTeamsDarkColor}`,ll=`1px solid ${Ne.z.HighContrastCyan}`,cl=(0,j.J9)((e,t,r,n,o,s,i,a)=>{const l=(0,Q.i7)({from:xl(e),to:yl(e)}),c=Nt.d.isLoopTheme(e),p={root:[(0,Le.gS)("row","nowrap"),{cursor:"pointer",":hover":[{".bottomBar .ms-Facepile-addButton":{opacity:"1"}},c&&[xa(e),{borderRadius:Re.B.LoopBorderRadius}]],"> .container":[Re.B.CardShadow,(0,Le.NX)(e),(0,Le.$Z)(),xa(e),(0,Le.gS)("row","nowrap"),{minHeight:"10px",borderRadius:Re.B.PlannerBorderRadius,width:"100%","> .textContent":(0,Le.GD)()},e===le.Sx.TeamsContrast&&!n&&{border:`1px solid ${Ne.z.White}`,":hover":{borderColor:Ne.z.TeamsContrastHyperlinkColor}},n&&yl(e),o&&[xl(e),{animation:`${l} 1s 3s forwards`}],c&&[xa(e),{borderRadius:Re.B.LoopBorderRadius}]]}],textContent:[(0,Le.gS)("column"),(0,Ue.kE)(),{cursor:"pointer",position:"relative",borderRadius:c?Re.B.LoopBorderRadius:`${Re.B.PlannerBorderRadius} ${Re.B.PlannerBorderRadius} 0 0`,":hover":[{"> .taskMenuSection > .indicator":[{opacity:"1"},c&&[(0,Le.zK)(e),{".plannerMore > span":(0,Ue.c3)()}]]}],"> .labels":[(0,Le.GD)("auto"),(0,Le.gS)("row"),{flexWrap:"wrap",justifyContent:"flex-start",padding:_a,paddingBottom:"0px",marginBottom:`-${Wa}`,"> :last-child":{marginRight:"0px"},"> li":{marginRight:Wa,marginBottom:Wa}}],"> .topBar":[(0,Le.GD)("auto"),(0,Le.gS)("column"),{justifyContent:"space-between",padding:_a,"> .titleRow":ul(e,r,o),"> .planName":pl(e),"> .bucketName":dl(e)}]},r&&[e===le.Sx.SharePoint&&{backgroundColor:Ne.z.SharepointAddTaskButtonBackgroundColor()},e===le.Sx.TeamsContrast&&{backgroundColor:Ne.z.Black}],s&&fl(e)],taskMenuSection:[(0,Le.gS)(),(0,Le.$Z)("auto"),(0,Le.Ml)(e),{fontSize:Q.s.small,right:"2px",top:"12px",lineHeight:Ya,letterSpacing:"0.75px",alignItems:"flex-start",margin:`0px ${Ja}`,position:"absolute","> .indicator":[(0,Le.gS)(),(0,Le.$Z)(),(0,Le.NX)(e),{fontSize:Q.s.xSmall,margin:`0px ${(0,_e.vb)((0,_e.jz)(Xa)/2-(0,_e.jz)(Ja))}`,padding:`0px ${$a}`,opacity:"0"}],"> .indicator.clickable":Tl(e),"> .indicator.menuOpen":[{opacity:"1"},c&&{":hover":[(0,Le.wA)(e),(0,Ue.cP)()]}],"> .indicator:focus":{opacity:"1"}}],thumbnail:[(0,Le.$Z)("162px"),(0,Le.gS)(),Le.cc,{textAlign:"center",wordWrap:"break-word",overflow:"hidden",borderRadius:`${Re.B.PlannerBorderRadius} ${Re.B.PlannerBorderRadius} 0 0`,"> .fallbackPreviewIcon":[{fontSize:tl,animation:`${Sl} 1s`,"> svg":{height:tl,width:tl}},e===le.Sx.TeamsContrast&&{color:Ne.z.White}],"> .previewImage > img.is-loaded":{maxWidth:"100%",minWidth:el,minHeight:el,pointerEvents:"none"},"&.real":[{borderBottom:"1px solid"},(0,Le.au)(e),Pl(e,r)],"&.placeholder":[{borderBottom:"1px solid"},Pl(e,r),(0,Le.au)(e),n&&(e===le.Sx.Dark||e===le.Sx.TeamsDark)&&{borderColor:so.kd.gray140},o&&e===le.Sx.TeamsContrast&&{borderColor:Ne.z.Black}]},r&&e===le.Sx.SharePoint&&{"& .real":{backgroundColor:Ne.z.SharepointAddTaskButtonBackgroundColor()}},r&&e===le.Sx.TeamsContrast&&{"& .real":{backgroundColor:Ne.z.Black}}],preview:[(0,Le.gS)(),{marginTop:"10px",fontSize:Q.s.size16,"> *":{flex:"0 1 auto",maxWidth:"100%"},"> .notesPreview":[(0,Le.Ml)(e),(0,Le.Gn)(),{fontSize:Q.s.small,wordWrap:"normal",maxHeight:"80px",marginLeft:"28px"},e===le.Sx.SharePoint&&{color:Ne.z.SharepointTitleFontColor()},e===le.Sx.TeamsContrast&&{color:Ne.z.White}],"> .referencePreviewDescription":[(0,Le.gS)(),{alignItems:"center","> .previewIcon":[(0,Le.$Z)(),{marginRight:"11px",marginLeft:"1px",padding:"0",height:za,width:za,"> .ms-Image > img":{height:za,width:za}},e===le.Sx.SharePoint&&{color:Ne.z.SharepointTitleFontColor()},e===le.Sx.TeamsContrast&&{color:Ne.z.White}],"> .previewCaption":[(0,Le.q0)(),{fontSize:Q.s.small,flex:"0 1 auto",minHeight:"16px"}],":hover > .previewCaption":[{textDecoration:"underline"},e===le.Sx.TeamsContrast&&{color:Ne.z.TeamsContrastHyperlinkColor}]}],"> .checklistPreview":hl(e,i)}],topBar:[(0,Le.gS)(),{"> .bucketName.disableUpdateBucket":{cursor:"default","> a:hover":{backgroundColor:"transparent"}}}],indicatorRow:[(0,Le.gS)(),(0,Le.$Z)("auto"),(0,Le.Ml)(e),{fontSize:Q.s.size12,lineHeight:Ya,marginTop:"16px",marginBottom:"-4px",letterSpacing:"0.75px","> *":[(0,Le.gS)(),{alignItems:"center",margin:`0px -${(0,_e.vb)((0,_e.jz)(Xa)/2+(0,_e.jz)($a))}`,"> .indicator":[(0,Le.gS)(),(0,Le.$Z)(),{margin:`0px ${(0,_e.vb)((0,_e.jz)(Xa)/2-(0,_e.jz)(Ja))}`,padding:`0px ${$a}`}]}],"> .leftSection":[(0,Le.GD)()]},o&&e===le.Sx.TeamsContrast&&{".indicator > .ms-Button > .ms-Button-flexContainer > .ms-Button-icon":{color:Ne.z.Black},".indicator > .ms-Button > .ms-Button-flexContainer > .ms-Button-textContainer > .ms-Button-label":{color:Ne.z.Black}}],requiredCompleteIcon:[(0,Le.$Z)(Ka),{marginRight:qa,marginBottom:"auto"}],bottomBar:[(0,Le.gS)("row"),{"&.noDisplayBottomBar":[{display:"none"}],transition:"color 0.167s ease-in-out, background 0.167s ease-in-out",borderTop:"1px solid",borderRadius:`0 0 ${Re.B.PlannerBorderRadius} ${Re.B.PlannerBorderRadius}`,"> .completedAssignment":[(0,Le.GD)(),{padding:"8px 14px",width:"100%",".ms-Persona-primaryText":[(0,Le.aS)(e)]}],"> .bottomBarLeftSection":[(0,Le.gS)(),{paddingLeft:"12px"," > .dueDateIndicator":{margin:"6px 0px"}}],"> .bottomBarRightSection":[(0,Le.gS)(),{right:"12px",position:"absolute",marginTop:"6px"}]},(0,Le.au)(e),r&&e===le.Sx.TeamsContrast&&[{backgroundColor:Ne.z.Black,color:Ne.z.White,borderTop:`1px solid ${Ne.z.NeutralLighter}`,":hover":{backgroundColor:Ne.z.Black,color:Ne.z.White}}],r&&e===le.Sx.SharePoint&&[{borderTop:`1px solid ${Ne.z.SharepointBackgroundColor()}`,backgroundColor:Ne.z.SharepointAddTaskButtonBackgroundColor()}],n&&(e===le.Sx.Dark||e===le.Sx.TeamsDark)&&{borderColor:so.kd.gray140},s&&fl(e)]};return(0,Q.TW)(p,t)}),pl=e=>[(0,Le.$Z)(),(0,Le.q0)(),(0,Le._D)(e),{fontSize:Q.s.small,fontWeight:Q.BO.semibold,marginBottom:"15px",marginTop:"-5px",textOverflow:"ellipsis",wordWrap:"break-word",minHeight:"16px"}],dl=e=>{const t=Nt.d.isLoopTheme(e);return[(0,Le.$Z)(),(0,Le.q0)(),{fontSize:Q.s.small,fontWeight:Q.BO.semibold,marginTop:"10px",textOverflow:"ellipsis",wordWrap:"break-word","> a":[(0,Le._D)(e),{padding:"4px",":hover":[(0,Le.zK)(e),e===le.Sx.TeamsContrast&&{backgroundColor:"transparent",color:Ne.z.TeamsContrastHyperlinkColor},t&&(0,Le.NX)(e)]},Tl(e)]}]},ul=(e,t,r)=>{const n=Nt.d.isLoopTheme(e);return[(0,Le.$Z)(),(0,Le.gS)("row"),{"> .completeButtonWithAnimation":[(0,Le.$Z)(Ka),{marginRight:qa}],"> .title":[(0,Le.aS)(e),(0,Le.$Z)(n?Qa:ja),{marginTop:"-1px",fontSize:Q.s.medium,fontWeight:Q.BO.regular,overflow:"hidden"},t&&[(0,Le.Ml)(e),{textDecoration:"line-through"}],r&&e===le.Sx.TeamsContrast&&{color:Ne.z.Black}],".toggleCheckLabel":[r&&e===le.Sx.TeamsContrast&&{color:Ne.z.Black}]}]},hl=(e,t)=>[(0,Le.GD)(),{marginLeft:"1px","*":{marginTop:"0px !important",marginLeft:"0px !important"},"> .checklistItem":[(0,Le.gS)(),(0,Le.q0)(),{height:Za,padding:"3px 0px 3px 3px","> .clickWrapper":{"> .checklistItemText":[(0,Le.Ml)(e),{maxWidth:"100%",".ms-Checkbox-text":[(0,Le.q0)("ellipsis"),(0,Le.Ml)(e),(0,Ue.M8)(),{":hover":[(0,Ue.M8)(),{textDecoration:"underline"}],fontSize:Q.s.small,lineHeight:Za,marginTop:"0px"},e===le.Sx.SharePoint&&{color:Ne.z.SharepointTitleFontColor()},e===le.Sx.TeamsContrast&&{color:Ne.z.White}]},e===le.Sx.TeamsContrast&&{color:Ne.z.White,"> .ms-Checkbox-label > .ms-Checkbox-checkbox":{borderColor:Ne.z.White,"> .ms-Checkbox-checkmark":{color:Ne.z.TeamsContrastHyperlinkColor},"&:hover":{borderColor:Ne.z.TeamsContrastHyperlinkColor}}},t&&{".ms-Checkbox-label span:hover":{textDecoration:"none"}}]}}],".ms-Checkbox-checkbox":[(0,Le.jI)(e),{margin:"0px",marginRight:"11px !important",borderRadius:"50%",flex:`0 0 ${Za}`,height:Za,width:Za,"> .ms-Checkbox-checkmark":{width:Ga.kT}}]}],gl=(0,j.J9)(e=>({root:(0,Q.Zq)("taskCard",e.root),textContent:(0,Q.Zq)("textContent",e.textContent),taskMenuSection:(0,Q.Zq)("taskMenuSection",e.taskMenuSection),thumbnail:(0,Q.Zq)("thumbnail",e.thumbnail),preview:(0,Q.Zq)("preview",e.preview),indicatorRow:(0,Q.Zq)("indicatorRow",e.indicatorRow),bottomBar:(0,Q.Zq)("bottomBar",e.bottomBar),topBar:(0,Q.Zq)("topBar",e.topBar),requiredCompleteIcon:(0,Q.Zq)("requiredCompleteIcon",e.requiredCompleteIcon)})),ml=(0,j.J9)(()=>{const e={maxHeight:"280px",maxWidth:Sa,".labelTagMenuButton":[Le.xK,(0,Le.gS)(),{paddingLeft:rl,paddingRight:(0,_e.vb)(2*(0,_e.jz)(rl)),alignItems:"center",cursor:"pointer",width:"100%",height:"32px","> .ms-ContextualMenu-checkmarkIcon":[(0,Le.$Z)(),(0,Le.gS)(),Le.cc,{margin:`0px ${rl}`}],"> .labelTag":[(0,Le.$Z)(),{marginLeft:rl,maxWidth:"234px"}]}]};return(0,Q.Zq)("taskCardContextMenu",e)}),Cl="24px",kl="6px",bl=(0,j.J9)((e,t)=>{const r=Nt.d.isLoopTheme(t);return{root:[(0,Le.GD)(),{width:"100%"}],assigneeRow:[e&&{":hover .addFriendIcon":{opacity:"1"}},{".ms-Facepile-member":{margin:"0px 4px",marginBottom:kl,".ms-Persona-primaryText":{maxWidth:"92px"}},".ms-Facepile-addButton":{marginBottom:kl,opacity:"0",borderRadius:"50%"},".ms-Facepile-addButton:focus":{opacity:"1"},".ms-Facepile-addButton:hover":[(0,Le.wA)(t)],".ms-Facepile-addButton i":{margin:"1px 2px 0px"},".ms-Facepile-descriptiveOverflowButton":{marginBottom:kl},".assignDiv .addFriendIcon":{marginLeft:"4px",marginRight:"0px"}}],addFriendIcon:[r?(0,Le.aS)(t):(0,Le._D)(t),{marginBottom:"3px",backgroundColor:"transparent",position:"absolute",bottom:"0px",opacity:"1",transition:"opacity 0.167s ease-in-out"}],assignDiv:{height:Cl,width:Cl," &:hover":[(0,Le.wA)(t),{borderRadius:"50%"}]}}}),Tl=(0,j.J9)(e=>{const t=Nt.d.isLoopTheme(e);return{borderRadius:t?"4px":"2px",":hover":[(0,Le.Mi)(e),t&&[(0,Le.wA)(e),(0,Ue.cP)(),{"> .plannerMore":[(0,Le._D)(e),{"> span":(0,Ue.cP)()}],".plannerIcon > span":(0,Ue.cP)()}]]}}),Sl=(0,Q.i7)({from:{opacity:0},to:{opacity:1}}),Pl=(0,j.J9)((e,t)=>{let r=so.kd.gray10;switch(e){case le.Sx.Dark:case le.Sx.TeamsDark:r=so.kd.gray170;break;case le.Sx.TeamsContrast:r=Ne.z.Black;break;case le.Sx.SharePoint:r=t?Ne.z.SharepointAddTaskButtonBackgroundColor():Ne.z.SharepointBackgroundColor();case le.Sx.Light:case le.Sx.TeamsLight:}return{backgroundColor:r}}),xl=(0,j.J9)(e=>{let t=Ne.z.WywaLightHighlightBackgroundColor,r=nl;switch(e){case le.Sx.Dark:t=Ne.z.WywaDarkHighlightBackgroundColor,r=ol;break;case le.Sx.TeamsLight:t=Ne.z.WywaTeamsLightHighlightBackgroundColor,r=sl;break;case le.Sx.TeamsDark:t=Ne.z.WywaTeamsDarkHighlightBackgroundColor,r=al;break;case le.Sx.TeamsContrast:t=Ne.z.TeamsContrastHyperlinkColor,r=ll;case le.Sx.Light:}return{backgroundColor:t,border:r}}),yl=(0,j.J9)(e=>{let t=Ne.z.White,r=nl;switch(e){case le.Sx.Dark:t=so.kd.gray160,r=ol;break;case le.Sx.TeamsLight:t=Ne.z.White,r=il;break;case le.Sx.TeamsDark:t=so.kd.gray160,r=al;break;case le.Sx.TeamsContrast:t=Ne.z.Black,r=ll;case le.Sx.Light:}return{backgroundColor:t,border:r}}),fl=(0,j.J9)(e=>{let t=Ne.z.NeutralTertiary;switch(e){case le.Sx.TeamsContrast:t=Ne.z.Black;case le.Sx.Light:case le.Sx.Dark:case le.Sx.TeamsLight:case le.Sx.TeamsDark:case le.Sx.SharePoint:}return{backgroundColor:t}}),vl=(0,j.J9)(e=>{const t=[(0,Le.GD)("auto"),Le.xK,(0,Le.Ml)(e),{fontSize:Q.s.xSmall,height:"100%"}],r=[(0,Le.Ml)(e),(0,Ue.M8)()],n=[(0,Ue.M8)(),(0,Le.Ml)(e),{padding:"0",margin:"2px",height:"100%"}];return{root:t,rootHovered:r,flexContainer:{padding:"0",margin:"0"},icon:n,iconHovered:n,iconPressed:n,textContainer:{letterSpacing:"0.75px",padding:"0 0 1px 0",margin:"0"},label:[(0,Le.Ml)(e),{fontSize:Q.s.xSmall,padding:"0",margin:"2px"}]}}),Al=(0,j.J9)((e,t,r)=>{const n=r&&Tl(e),o=e===le.Sx.TeamsContrast&&{color:Ne.z.White},s={color:e===le.Sx.TeamsContrast?Ne.z.Black:(0,Gn.eX)(e,t)},i={root:n,rootExpanded:o,iconHovered:s,iconPressed:s,iconExpandedHovered:s};return(0,Q.TW)(vl(e),i)}),wl=(0,j.J9)((e,t,r)=>{const n=[r&&Tl(e)],o=e===le.Sx.TeamsContrast&&{color:Ne.z.White},s={color:e===le.Sx.TeamsContrast?Ne.z.Black:(0,Gn.Bt)(e,t)},i={root:n,rootExpanded:o,iconHovered:s,iconPressed:s,iconExpandedHovered:s};return(0,Q.TW)(vl(e),i)}),Dl=e=>{const t=Math.max(e.numberOfAttachments,0),r=1===t?Ee.p.Strings.AttachmentIndicator_AttachmentsIndicatorAriaLabelSingular:Ee.p.Strings.AttachmentIndicator_AttachmentsIndicatorAriaLabelPlural,n=Pt.G(r,t),o=vl(e.appTheme);return _.createElement("div",{className:"attachment indicator",title:n},_.createElement(Va,{...e,ariaLabel:n,label:t.toString(),iconProps:tt.M$,styles:o}))},Bl=e=>{const t=Math.max(e.numChecklistItems,0),r=Math.max(e.numCompletedChecklistItems,0),n=Pt.G(Ee.p.Strings.ChecklistIndicator_ChecklistIndicatorAriaLabel,r,t),o=Pt.G(Ee.p.Strings.TaskEditor_ChecklistFraction,r,t),s=vl(e.appTheme);return _.createElement("div",{className:"checkList indicator",title:n},_.createElement(Va,{...e,ariaLabel:n,label:o,iconProps:tt.tF,styles:s}))},El=e=>{const t=vl(e.appTheme);return _.createElement("div",{className:"conversation indicator",title:e.ariaLabel},_.createElement(Va,{...e,ariaLabel:e.ariaLabel,iconProps:tt.CJ,styles:t}))};var Il=r(3176),Fl=r(55228),Ml=r(60601);const Ll=_.memo(e=>{const{attachment:t,theme:r,isFocusable:n,onAttachmentClick:o,onKeyDown:s}=e,i=Il.m.builder.fromTaskAttachment(t,"").build(),a=i.taskAttachmentRowItemType.taskAttachmentType,l=(0,Fl.$)(r,a);return _.createElement("a",{className:"referencePreviewDescription",title:i.url,"data-is-focusable":n,tabIndex:n?0:-1,onKeyDown:e=>{const t=Ml.$.getKey(e);t!==Fe.D.ENTER&&t!==Fe.D.SPACE||o(i.url,e),s(e)},onClick:e=>o(i.url,e)},_.createElement(Ra.$,{key:i.url,styles:l,taskAttachmentRowItem:i,className:"previewIcon",icons:Fl.b}),_.createElement("span",{className:"previewCaption"},i.alias))});var Nl=r(22344),Rl=r(5958);const Ul=(0,j.J9)((e,t)=>{const r=Nt.d.isLoopTheme(e),n={root:[(0,Le.gS)(),{display:"inline-flex",alignItems:"center",height:"24px",cursor:"default","&.clickable":{borderRadius:"2px",cursor:"pointer"},"&.clickable:hover":(0,Le.wA)(e),"&.isLate":[(0,Le.wM)(e),{borderRadius:r?"4px":"2px",transition:"background 0.167s ease-in-out","> .plannerIcon,.label":(0,Le.sS)(e)}]}],calendarIcon:[r?(0,Le.aS)(e):(0,Le._D)(e),{paddingLeft:"2px",paddingRight:"2px"}],calendarLabel:[(0,Le.aS)(e),{fontSize:Q.s.small,fontWeight:Q.BO.regular,paddingLeft:"2px",paddingRight:"8px"}],callout:(0,Rl.j)(e).callout};return(0,Q.TW)(n,t)}),Ol=(0,j.J9)(e=>({root:(0,Q.Zq)("dueDateIndicator",e.root),calendarIcon:(0,Q.Zq)("calendarIcon",e.calendarIcon),calendarLabel:(0,Q.Zq)("calendarLabel",e.calendarLabel),callout:(0,Q.Zq)("dueDateIndicatorCallout",e.callout)})),Hl=e=>{const{isItemVisible:t,toggleOnEvent:r,hideItem:n}=(()=>{const[e,t]=_.useState(!1);return{isItemVisible:e,toggleOnEvent:e=>{e?.preventDefault(),e?.stopPropagation(),t(e=>!e)},showItem:_.useCallback(()=>t(!0),[t]),hideItem:_.useCallback(()=>t(!1),[t])}})(),o=_.useRef(null),{ariaLabel:s,isKeyboardFocusable:i,task:a,taskPermissions:l,onKeyDown:c,onUpdateTask:p,appTheme:d,styles:u}=e,h=_.useCallback(e=>{const t=a.setDueDate(null==e?null:zi()(e));p(a,t),n()},[a,p,n]),g=_.useCallback(e=>{Qe.a.getKey(e)===Fe.D.ESCAPE&&n()},[n]),m=Ol(Ul(d,u)),C=_.useMemo(()=>(0,je.A)(m?.root,l.canEdit&&l.canUpdateDueDate?"clickable":null,{isLate:a.isLate()}),[a,l,m]),k=a.dueDate?a.getFormattedDueDate():Ee.p.Strings.TaskCard_DueDatePlaceholder;let b;return b=a.recurrence?.isActive()?tt.SO:tt.cx,_.createElement("div",{ref:o,className:C,"aria-label":s,title:s,"data-is-focusable":i,onClick:r,onKeyUp:g,onKeyDown:c,role:"button"},_.createElement(xe.I,{...b,className:(0,je.A)(m?.calendarIcon,b.className)}),_.createElement("span",{className:(0,je.A)(m?.calendarLabel,"label"),tabIndex:-1},k),l.canUpdateDueDate&&t&&_.createElement(Dt.P,{isBeakVisible:!1,gapSpace:0,doNotLayer:!1,target:o,directionalHint:Je.A.bottomLeftEdge,onDismiss:n,setInitialFocus:!0,className:Ol(Ul(d,u)).callout},_.createElement(At.Y,{isClickableOutsideFocusTrap:!0,forceFocusInsideTrap:!1},_.createElement(Nl.V,{onSelectDate:h,onDismiss:n,isMonthPickerVisible:!0,value:null!=a.dueDate?a.dueDate.toDate():void 0,today:new Date,theme:d}))))},Vl=e=>{const{priorityStrings:t,task:r,taskPermissions:n,appTheme:o,onUpdateTask:s}=e,{traceLogger:i}=(0,Bs.t)(),a=_.useCallback((e,t)=>{let n;switch(t.key){case sr.gy[sr.gy.Urgent]:n=r.setProperty("priority",(0,ir._d)(sr.gy.Urgent));break;case sr.gy[sr.gy.Important]:n=r.setProperty("priority",(0,ir._d)(sr.gy.Important));break;case sr.gy[sr.gy.Medium]:n=r.setProperty("priority",(0,ir._d)(sr.gy.Medium));break;case sr.gy[sr.gy.Low]:n=r.setProperty("priority",(0,ir._d)(sr.gy.Low));break;default:return}s(r,n)},[r,s]),l=_.useMemo(()=>[{key:sr.gy[sr.gy.Urgent],disabled:!n.canUpdatePriorityToUrgent,name:t.priorityUrgentText,onClick:a,iconProps:(0,xt.m4)(i,o,sr.gy.Urgent)},{key:sr.gy[sr.gy.Important],name:t.priorityImportantText,onClick:a,iconProps:(0,xt.m4)(i,o,sr.gy.Important)},{key:sr.gy[sr.gy.Medium],name:t.priorityMediumText,onClick:a,iconProps:(0,xt.m4)(i,o,sr.gy.Medium)},{key:sr.gy[sr.gy.Low],name:t.priorityLowText,onClick:a,iconProps:(0,xt.m4)(i,o,sr.gy.Low)}],[t,a,n,o,i]),[c,p]=_.useMemo(()=>{let e=(0,xt.m4)(i,o,sr.gy.Urgent,xt.lK.Small),n=t.priorityUrgentText;return(0,ir.aV)(r.priority)===sr.gy.Important&&(e=(0,xt.m4)(i,o,sr.gy.Important,xt.lK.Small),n=t.priorityImportantText),[e,n]},[r.priority,t,o,i]),d=Al(o,(0,ir.aV)(r.priority),n.canUpdatePriority);return _.createElement("div",{className:"priority indicator",title:p},_.createElement(Va,{...e,ariaLabel:p,iconProps:c,disabled:!n.canUpdatePriority,menuProps:{calloutProps:{className:"plannerAppCallout"},className:"contextualMenu",directionalHint:Je.A.bottomAutoEdge,items:l,styles:(0,vr.Zo)(o)},menuIconProps:{iconName:"",style:{display:"none"}},styles:d}))},Gl=e=>{const{usageLogger:t,traceLogger:r}=(0,Bs.t)(),{ariaLabel:n,progressState:o,progressStrings:s,task:i,appTheme:a,onUpdateTask:l,canUpdateProgress:c}=e,p=_.useCallback((e,r)=>{let n;switch(t.logData("ProgressIndicatorOnTaskCard",h.M.TaskProgressChanged,{taskCreationSourceType:i.taskCreationSourceType??""}),r.key){case lr.$.NotStarted:n=i.setProperty("percentComplete",(0,ir.BK)(lr.$.NotStarted));break;case lr.$.InProgress:n=i.setProperty("percentComplete",(0,ir.BK)(lr.$.InProgress));break;case lr.$.Complete:n=i.setProperty("percentComplete",(0,ir.BK)(lr.$.Complete));break;default:return}l(i,n)},[i,l,t]),d=_.useMemo(()=>(0,xt.Nu)(r,a,o??lr.$.InProgress,xt.lK.Small),[a,o,r]),u=_.useMemo(()=>[{key:lr.$.NotStarted,name:s.notStartedText,onClick:p,iconProps:(0,xt.Nu)(r,a,lr.$.NotStarted)},{key:lr.$.InProgress,name:s.inProgressText,onClick:p,iconProps:(0,xt.Nu)(r,a,lr.$.InProgress)},{key:lr.$.Complete,name:s.completedText,onClick:p,iconProps:(0,xt.Nu)(r,a,lr.$.Complete)}],[s,p,a,r]),g=wl(a,o??lr.$.InProgress,c);return _.createElement("div",{className:"progress indicator",title:n},_.createElement(Va,{...e,ariaLabel:n,disabled:!c,iconProps:d,menuProps:{calloutProps:{className:"plannerAppCallout"},className:"contextualMenu",directionalHint:Je.A.bottomAutoEdge,items:u,styles:(0,vr.Zo)(a)},menuIconProps:{iconName:"",style:{display:"none"}},styles:g}))};var Wl,_l=r(62530),zl=r(67058),Zl=r(54052),Kl=r.n(Zl);!function(e){function t(e,t){return e.index===t.index?0:e.index<t.index?-1:1}e.getLabelPlaceholder=function(e){return null==e.name||""===e.name?e.placeholderText:e.name},e.sortLabelsByUsageAndIndex=function(e){var r=e.filter(function(e){return e.usageCount&&e.usageCount>0}).sort(t),n=e.filter(function(e){return null==e.usageCount||e.usageCount<=0}).sort(t),o=[];return o.push.apply(o,r),o.push.apply(o,n),o},e.compareLabelsByIndex=t}(Wl||(Wl={}));var ql=r(35525);class jl extends ce.${name(){return"TaskContextMenu"}renderComponent(){const e=(0,je.A)("otherCommands indicator clickable",{menuOpen:this.state.isTaskContextMenuVisible});return _.createElement("div",{className:e,onClick:this.toggleOtherCommandsMenu.bind(this),title:Ee.p.Strings.TaskContextMenu_MoreButtonTooltipText,"aria-label":Ee.p.Strings.TaskContextMenu_MoreButtonTooltipText,"aria-expanded":this.state.isTaskContextMenuVisible,"aria-haspopup":!0,onKeyUp:this.handleOtherCommandsMenu.bind(this),onKeyDown:this.handleOnKeyDown.bind(this),"data-is-focusable":this.props.isFocusZoneEnabled,ref:null!=this.props.otherCommandsMenuCommandButton?this.props.otherCommandsMenuCommandButton:"TaskContextMenuButton",role:"button"},_.createElement(xe.I,tt.XP),this.state.isTaskContextMenuVisible?this.renderContextMenu():null)}renderContextMenu(){const e=[],{isTaskOnMyDay:t,toggleMyDayForTask:r}=this.props,n=this.props.task.getAssigneeIds().indexOf(ae.B.currentUserId)>-1;if(ae.B.isUnoContext&&n&&t&&r){const n=t(this.props.task.id),o=()=>{r(this.props.task.id)};e.push(((e,t)=>e?{key:ql.uU.RemoveFromMyDay,name:Ee.p.Strings.TaskContextMenu_RemoveFromMyDay,iconProps:tt.c6,title:Ee.p.Strings.TaskContextMenu_RemoveFromMyDayTooltip,onClick:t}:{key:ql.uU.AddToMyDay,name:Ee.p.Strings.TaskContextMenu_AddToMyDay,iconProps:tt.c6,title:Ee.p.Strings.TaskContextMenu_AddToMyDayTooltip,onClick:t})(n,o))}return this.renderLabelMenuItems(e),this.props.showAssign&&this.props.onClickAssign&&(0,ir.Fk)(this.props.task.percentComplete)!==lr.$.Complete&&e.push({key:"Assign",name:Ee.p.Strings.TaskContextMenu_AssignOption,iconProps:this.iconPropsWithDefaultColor(tt.lO),onClick:this.props.onClickAssign.bind(this)}),e.push({key:"CopyTask",name:Ee.p.Strings.TaskContextMenu_CopyTaskOption,iconProps:this.iconPropsWithDefaultColor(tt.RC),onClick:this.onClickCopyTask.bind(this),disabled:!this.props.showCopyTask}),this.props.showCopyLinkToTask&&e.push({key:"CopyLinkToTask",name:Ee.p.Strings.TaskContextMenu_CopyLinkToTaskOption,iconProps:this.iconPropsWithDefaultColor(tt.M8),onClick:this.onClickCopyLinkToTask.bind(this)}),e.push({key:"MoveTask",name:Ee.p.Strings.TaskContextMenu_MoveTaskOption,iconProps:this.iconPropsWithDefaultColor(tt.Nk),onClick:this.onClickMoveTask.bind(this),disabled:!this.props.config.enableMoveTaskOperation}),this.props.showTaskDetails&&this.props.openTaskDetails&&e.push({key:"TaskDetails",name:Ee.p.Strings.TaskContextMenu_TaskDetailsOption,onClick:this.props.openTaskDetails.bind(this,this.props.task.id,()=>{})}),this.props.showDelete&&e.push({key:"Delete",name:Ee.p.Strings.TaskContextMenu_DeleteOption,iconProps:this.iconPropsWithDefaultColor(tt.pJ),onClick:this.handleDelete}),_.createElement(Xe.l,{className:ml(),shouldFocusOnMount:!0,items:e,directionalHint:Je.A.bottomAutoEdge,target:null!=this.props.otherCommandsMenuCommandButton?this.props.otherCommandsMenuCommandButton.current:this.refs.TaskContextMenuButton,onDismiss:this.dismissOtherCommandsMenu.bind(this),appTheme:this.props.theme})}renderLabelMenuItems(e){if(!this.props.showLabel)return;let t=[];null!=this.props.labels&&(t=this.state.taskPlanLabels.map(e=>({key:e.index.toString(),data:e,onRender:this.onRenderLabelMenuItem}))),t.length>0&&e.push({key:"Labels",name:Ee.p.Strings.TaskContextMenu_LabelOption,iconProps:this.iconPropsWithDefaultColor(tt.Oi),subMenuProps:{calloutProps:{className:"plannerAppCallout"},items:t,styles:(0,vr.Zo)(this.props.theme)},submenuIconProps:this.iconPropsWithDefaultColor(tt.rK)})}handleOtherCommandsMenu(e){const t=Qe.a.getKey(e);t===this.lastKeyDown&&t===Fe.D.ENTER&&(e.stopPropagation(),this.toggleOtherCommandsMenu(e)),this.lastKeyDown=null}handleOnKeyDown(e){const t=Qe.a.getKey(e);t===Fe.D.ENTER&&e.stopPropagation(),this.lastKeyDown=t,this.props.disableFocusZone(e)}toggleCategory(e){const t=this.props.task.getClone(),r=t.appliedCategories.indexOf(e);r>-1?(t.appliedCategories.splice(r,1),this.logUsage(h.M.RemoveLabelFromTask)):(t.appliedCategories.push(e),this.logUsage(h.M.AddLabelToTask,{isNewLabel:String(e>5)})),this.props.onFocusContainer&&this.props.onFocusContainer(),this.props.onUpdateTask&&this.props.onUpdateTask(this.props.task,t)}toggleOtherCommandsMenu(e){e.stopPropagation();const{task:t,fetchTaskContainerPermissions:r,onOtherCommandsMenuOpened:n}=this.props;null!=t.creationSource?.publication&&r(t);const o=this.getSortedLabels();this.setState(e=>(e.isTaskContextMenuVisible||this.context.usageLogger.logData(this.name(),h.M.TaskCardContextMenuClicked,{taskCreationSourceType:t.taskCreationSourceType??""}),{isTaskContextMenuVisible:!e.isTaskContextMenuVisible,taskPlanLabels:o}),()=>{n&&n()})}getSortedLabels(){let e=this.props.labels??[];return e=Wl.sortLabelsByUsageAndIndex(e),e}onDeleteTask(){this.props.deleteTask?.(this.props.task.id)}onDeleteTaskSeries(){this.logUsage("DeleteRecurringTaskDialogOpened"),this.props.openDeleteRecurringTaskDialog?.(this.props.task.id)}dismissOtherCommandsMenu(){this.setState({isTaskContextMenuVisible:!1})}onClickCopyTask(){this.logUsage("CopyTaskDialogOpened"),this.props.openCopyTaskDialog&&this.props.openCopyTaskDialog(this.props.task.id)}onClickMoveTask(){this.logUsage("MoveTaskDialogOpened"),this.props.openMoveTaskDialog&&this.props.openMoveTaskDialog(this.props.task.id)}onClickCopyLinkToTask(){const e={taskId:this.props.task.id};this.logUsage("copyTaskLinkTaskCard",e),this.props.onCopyLinkToTask&&this.props.onCopyLinkToTask(this.props.task.id),this.props.onFocusContainer&&this.props.onFocusContainer()}constructor(e,t){super(e,t),this.onRenderLabelMenuItem=e=>{const t=e.data,{index:r}=t,n=(Kl()(this.props.task.appliedCategories)?this.props.task.appliedCategories:[]).indexOf(r)>-1,o=t.name||tr.U.getLabelPlaceholderByIndex(r),s={className:"ms-ContextualMenu-link labelTagMenuButton",name:o,"aria-posinset":e["aria-posinset"],"aria-setsize":e["aria-setsize"],"aria-checked":n};return _.createElement("button",{...s,onClick:e=>this.toggleCategory(r),role:"menuitemcheckbox"},n?_.createElement(xe.I,{...tt.r8,className:(0,je.A)("ms-ContextualMenu-checkmarkIcon",tt.r8.className)}):_.createElement(xe.I,{iconName:"",className:"ms-ContextualMenu-checkmarkIcon"}),_.createElement($t.l,{key:r,index:r,title:o,isCollapsed:!1,theme:this.props.theme}))},this.handleDelete=e=>this.props.task.recurrence?.isActive()?this.onDeleteTaskSeries():this.onDeleteTask(),this.iconPropsWithDefaultColor=e=>({...e,className:(0,je.A)("defaultIconColor",e.className)});const r=this.getSortedLabels();this.state={isTaskContextMenuVisible:!1,taskPlanLabels:r}}}const Ql=e=>{const t=vl(e.appTheme),r=Ee.p.Strings.TaskEditor_AppPoweredTasksOpenTaskButtonAriaLabel;return _.createElement("div",{className:"appPoweredTask indicator",title:r},_.createElement(Va,{...e,ariaLabel:r,iconProps:tt.Mt,styles:t}))};var Yl=r(46530),Jl=r(34648),Xl=r(13378),$l=r(8480),ec=r(70995),tc=r(69108),rc=r.n(tc),nc=r(47649),oc=r(79962),sc=r(80347),ic=r(71683),ac=r(78005);function lc(e){if(!e)return"";const t=(0,ac.fv)(e);return pc((new DOMParser).parseFromString(t,"text/html").body).trim().replace(/\n{2,}/g,"\n")}const cc=["BR","LI","P","DIV"];function pc(e){if(null==e)return"";if(e.nodeType===Node.TEXT_NODE)return e.textContent??"";if(e.nodeType===Node.ELEMENT_NODE){const t=e;let r="";cc.includes(t.tagName)&&(r+="\n");for(const e of t.childNodes)r+=pc(e);return r}return""}const dc={};var uc=r(75314),hc=r(36723);class gc extends ce.${name(){return"TaskCard"}logUsage(e,t,r){this.props.loggers.usageLogger.logData(this.name(),e,t,r)}logError(e,t,r){bo.v.logError(e,t,r,this.props.loggers.logHandler)}renderComponent(){const{task:e,highlightType:t,showPreview:r,isFocusZoneEnabled:n}=this.props;if(null==e)return null;const o=this.getClassNames(),s=(0,ir.Fk)(e.percentComplete),i=this.renderTaskMenu(o),a=this.renderTopBar(o),l=this.renderBottomBar(s,o),c=this.renderCategoryLabels(),p=(0,je.A)(o.root,"passive_0","active_2",{complete:s===lr.$.Complete},{wywaBorderHighlighted:t.wywaBorderHighlighted},{assigneeHighlighted:t.assigneeHighlighted},{wywaAnimated:!t.assigneeHighlighted&&t.wywaAnimated}),d=t.wywaBorderHighlighted||!t.assigneeHighlighted&&t.wywaAnimated?Ee.p.Strings.TaskCard_TaskChangedSinceLastVisit:"",u=e.title+d,h=_.createElement("div",{className:o.textContent,tabIndex:-1},r&&this.renderReferencePreviewThumbnail(o),i,c,a,l);return _.createElement(Lr.R,{direction:Nr.E.horizontal,isCircularNavigation:!0,disabled:!n},_.createElement("div",{className:p,"aria-label":u},_.createElement("div",{className:"container",ref:e=>this._containerRef=e},h)))}getAssignees(){return gn()(this.props.task.getAssigneeIds(),e=>{let t=this.props.callbacks.getUser(e);return t||(t=Yl._.getUnknownUser(e)),t})}renderCompleteButton(e,t){const{completeBtnRef:r,task:n,taskPermissions:o,isFocusZoneEnabled:s,theme:i,callbacks:a,taskDetails:l}=this.props,c=a.getFlights().TeamsTasksECS_enableMandatoryChecklist&&(0,uc.cl)(n,l),p=a.getFlights().TeamsTasksECS_enableMandatoryForms&&(0,uc.lj)(n,l),d=a.getFlights().TeamsTasksECS_enableMandatoryApprovals&&(0,uc.Zw)(n,l),u=a.getFlights().EnableAppPoweredTasks&&n.isAppPoweredTask()&&!n.isComplete();return c||p||d||u?_.createElement($l.S,{plannerTheme:i,directionalHint:Je.A.rightCenter,content:Ee.p.Strings.TaskEditor_ShowShouldCompleteRequirementsInfoLabel},_.createElement("img",{className:t.requiredCompleteIcon,tabIndex:-1,onClick:this.stopMouseClickEventPropagation,src:ec.A,"data-is-focusable":this.props.isFocusZoneEnabled,"aria-label":Ee.p.Strings.TaskEditor_ShowShouldCompleteRequirementsInfoLabel,role:"checkbox","aria-checked":e})):_.createElement(zl.N,{id:"completeButton"+n.id,isTaskCompleted:e,isFocusZoneEnabled:s,completeButtonRef:r,isDisabled:!o.canUpdateProgress,completeTaskButtonTabIndex:-1,onButtonClick:this.onTaskCardCompleteClick,disableTaskCardFocusZone:this.disableFocusZone,theme:i})}renderAssignmentBar(){const{callbacks:e,currentUserId:t,maxAssignees:r,task:n,taskPermissions:o,theme:s}=this.props,i=this.getAssignees(),a=e.getCanUserModifyAssigneePool(n.id)&&o.canEdit&&o.canAssign,l=(0,ir.Fk)(n.percentComplete);return _.createElement(Oa.UI,{layout:Oa.Yn.Compact,assignees:i,currentUserId:t,canEditAssignments:o.canAssign,canEditAccessPermissions:a,canGiveAccessToGuests:this.props.canAddGuests,canAssignToResourcesWithoutAccess:a,canAccessPlanViaSharedContainerOnly:e.getCanUserAccessPlanViaSharedContainerOnly(n.planId),minQueryTermLength:le.c9.MinCharsNeededToSearch,maxAssignees:r,maxDisplayablePersonas:le.eg.MaxDisplayablePersonasTaskCard,addIconPlacement:Oa.aq.BeforeAssignees,strings:{assignControlLauncherText:"",assignControlIconTitle:Ee.p.Strings.TaskAssignmentControl_AssignControlLauncherText,assignControlAssignToMeButtonText:Ee.p.Strings.TaskAssignmentControl_AssignToMeLabel,readonlyFieldPermissionsTooltip:Ee.p.Strings.SharedComponents_ReadonlyFieldPermissionsTooltip,assignControlAriaLabelSuffix:Ee.p.Strings.TaskAssignmentControl_AssignControlAriaLabelSuffix,assignControlAriaLabelPrefix:Ee.p.Strings.TaskAssignmentControl_AssignControlAriaLabelPrefix,assignControlAriaLabelPrefixNoAssignees:Ee.p.Strings.TaskAssignmentControl_AssignControlAriaLabelPrefixNoAssignees,assignControlListSeparator:Ee.p.Strings.TaskAssignmentControl_AssignControlAriaLabelListSeparator,assignControlAriaLabelConstruction:Ee.p.Strings.TaskAssignmentControl_AssignControlAriaLabelConstruction,assignmentFilterPlaceholderText:Ee.p.Strings.AssignmentPicker_AssignFilterPlaceholder,assignmentFilterAriaLabel:Ee.p.Strings.AssignmentPicker_AssignFilterPlaceholder,noResultsFoundText:Ee.p.Strings.AssignmentPicker_NoResultsFoundText,giveAccessTooltipText:Ee.p.Strings.AssignmentPicker_GiveAccessButtonAriaLabel,unassignUserButtonText:Ee.p.Strings.AssignmentPicker_UnassignUserButtonAriaLabel,assignedSectionHeader:Ee.p.Strings.AssignmentPicker_AssignedSectionHeader,queryLoadingText:Ee.p.Strings.AssignmentPicker_LoadingText,suggestedSectionHeader:Ee.p.Strings.AssignmentPicker_SuggestedSectionHeader,personaRoleGuest:Ee.p.Strings.AssignmentPicker_PersonaRoleGuest,personaRoleNonMember:Ee.p.Strings.AssignmentPicker_PersonaRoleNonMember,personaCompoundRole:Ee.p.Strings.AssignmentPicker_PersonaCompoundSubText,suggestedAssigneeMostAvailableUser:Ee.p.Strings.AssignmentPicker_SuggestedAssigneeMostAvailableUser,suggestedAssigneePlanTopAssignee:Ee.p.Strings.AssignmentPicker_SuggestedAssigneePlanTopAssignee,suggestedAssigneeSimilarTitle:Ee.p.Strings.AssignmentPicker_SuggestedAssigneeSimilarTitle,suggestedAssigneeUserTopAssignee:Ee.p.Strings.AssignmentPicker_SuggestedAssigneeUserTopAssignee},onRenderPersona:e.onRenderPersona,getUsersWithPlanAccess:this.getAssigneePool,getZeroTermQueryResults:this.getZeroTermQueryAssignmentResults,onAssignUser:this.onAssignUser,onUnassignUser:this.onUnassignUser,onGivePlanAccess:this.giveUserAccessToPlan,onOpenAssignCallout:this.onOpenAssignCallout,onCloseAssignCallout:this.onCloseAssignCallout,getSearchQueryResults:a?e.getUsersWithKeyword:void 0,getUserPhoto:e.getUserPhoto,showAssigneeLimitError:this.showAssigneeLimitError,alertUser:this.tenantSearchAlertUser,overflowButtonType:Tn.Z.descriptive,showPeoplePicker:this.state.isPeoplePickerVisible,targetElement:l!==lr.$.Complete&&null!==n.getAssigneeIds()&&n.getAssigneeIds().length>0?this._bottomBar||void 0:this._containerRef||void 0,theme:s,styles:bl(o.canAssign,s),allowMultiline:!1,hideSingleAssigneeDetails:!0})}renderCompletedTaskBottomBar(){const{task:e,callbacks:t}=this.props;if(null==e.completedBy||null==e.completedDate)return null;const r=sc.lz.FormatDate(e.completedDate);let n=this.props.callbacks.getUser(e.completedBy);null==n&&(n=Yl._.getUnknownUser(e.completedBy));const o={text:Pt.G(Ee.p.Strings.TaskCard_CompletedByOnDate,n.formattedDisplayName,r),imageUrl:t.getUserPhoto(n.id)||void 0,imageInitials:(0,oc.I)(n.displayName,(0,Me.jI)()),initialsColor:(0,Ua.X)({text:n.displayName}),size:Mt.WH.extraSmall,className:"completedBy"};return _.createElement("div",{className:"completedAssignment"},_.createElement(Lt.f,{user:n,onLoad:t.onRenderPersona,containerId:`userContainer-taskCard-${e.id}-${n.id}`},_.createElement(Ft.F,o)))}renderActiveTaskBottomBar(){const e=this.renderDueDateIndicator();return _.createElement(_.Fragment,null,_.createElement("div",{className:"bottomBarLeftSection"},e),_.createElement("div",{className:"bottomBarRightSection",onClick:this.preventDefault},this.renderAssignmentBar()))}renderTaskMenu(e){const t={enableMoveTaskOperation:this.props.taskPermissions.canEdit&&this.props.taskPermissions.canMove};return _.createElement("div",{className:e.taskMenuSection},_.createElement(jl,{config:t,task:this.props.task,labels:this.props.taskPlanLabels,showAssign:this.props.taskPermissions.canEdit&&this.props.taskPermissions.canAssign,showDelete:this.props.taskPermissions.canEdit&&this.props.taskPermissions.canDelete,showLabel:this.props.taskPermissions.canEdit&&this.props.taskPermissions.canUpdateAppliedLabels,showCopyTask:this.props.taskPermissions.canEdit&&this.props.taskPermissions.canCopy,showCopyLinkToTask:this.props.showCopyLinkToTask,openCopyTaskDialog:e=>{this.props.callbacks.openCopyTaskDialog(e,this.props.onFocusContainer)},openMoveTaskDialog:e=>{this.props.callbacks.openMoveTaskDialog(e,this.props.onFocusContainer)},openDeleteRecurringTaskDialog:e=>{this.props.callbacks.openDeleteRecurringTaskDialog(e,this.props.onFocusContainer)},onCopyLinkToTask:e=>{this.props.callbacks.onCopyLinkToTask(e)},deleteTask:e=>{this.props.onDelete(e)},onFocusContainer:()=>{this.props.onFocusContainer()},onUpdateTask:(e,t)=>{this.props.callbacks.onUpdateTask(e,t)},onClickAssign:()=>{this.onClickAssign()},onOtherCommandsMenuOpened:()=>{this.onOtherCommandsMenuOpened()},isTaskOnMyDay:this.props.callbacks.isTaskOnMyDay,toggleMyDayForTask:this.props.callbacks.toggleMyDayForTask,isFocusZoneEnabled:this.props.isFocusZoneEnabled,disableFocusZone:this.disableFocusZone,otherCommandsMenuCommandButton:this.props.moreBtnRef,fetchTaskContainerPermissions:this.props.callbacks.fetchTaskContainerPermissions,theme:this.props.theme}))}renderTopBar(e){const t=this.props.taskPlan,r=Pt.G(Ee.p.Strings.TaskCard_TaskTitleAriaLabel,this.props.task.title),n=_.createElement("div",{className:"titleRow"},this.renderCompleteButton(this.props.task.isComplete(),e),_.createElement("div",{className:"title","aria-label":r,role:"textbox"},this.props.task.title));let o=null;if(this.props.showPlanTitle){const e=null!=t?Pt.G(Ee.p.Strings.TaskCard_PlanTitleAriaLabel,t.title):void 0;o=_.createElement("div",{className:"planName","aria-label":e,role:null!=t?"textbox":void 0},t?.title)}const s=this.renderIndicatorRow(e);return _.createElement("div",{className:e.topBar,onClick:this.onCardClick},o,n,this.renderBucketTitle(),this.props.showPreview&&this.renderPreview(e),s)}renderBottomBar(e,t){const{task:r}=this.props,n=null!=r.dueDate,o=(0,je.A)(t.bottomBar,e===lr.$.Complete||n||null!==r.getAssigneeIds()&&r.getAssigneeIds().length>0?"":"noDisplayBottomBar");return _.createElement("div",{className:o,ref:this.resolveRef(this,"_bottomBar"),tabIndex:-1},e===lr.$.Complete&&r.completedBy&&r.completedDate?this.renderCompletedTaskBottomBar():this.renderActiveTaskBottomBar())}renderBucketTitle(){if(null==this.props.taskBucket||!this.props.showBucketTitle)return null;const e=this.props.taskPermissions.canUpdateBucket?"bucketName":"bucketName disableUpdateBucket";if(null!=this.props.callbacks.getBuckets){const t=[],r=null!=this.props.task.planId?this.props.callbacks.getBuckets(this.props.task.planId):[];null!=r&&r.sort((e,t)=>qi.O.compareOrderHints(t.orderHint,e.orderHint)),St()(r,e=>{t.push({key:e.id,name:e.title,onClick:this.setBucket})});const n=_.createElement(Xe.l,{shouldFocusOnMount:!0,items:t,className:"bucketContextualMenu",directionalHint:Je.A.bottomAutoEdge,target:this.refs.bucketMenuCommandButton,onDismiss:this.dismissBucketMenu,appTheme:this.props.theme});return _.createElement("div",{className:e,ref:"bucketMenuCommandButton",tabIndex:-1},_.createElement("a",{onClick:this.toggleBucketMenu,"data-is-focusable":"false"},this.props.taskBucket.title),this.state.isBucketMenuVisible?n:null)}return _.createElement("div",{className:e},this.props.taskBucket.title)}renderPreview(e){let t=null;switch(this.props.task.previewType){case Jl.X.CheckList:t=this.renderChecklistPreview();break;case Jl.X.Description:t=this.renderNotesPreview();break;case Jl.X.Reference:case Jl.X.Automatic:t=this.renderTaskReferencePreviewDescription();break;case Jl.X.NoPreview:break;default:ji.f.unreachableCase(this.props.task.previewType,e=>{this.props.loggers.traceLogger.logTrace(508077509,B.k.Error,e)})}return t?t&&_.createElement("div",{className:e.preview},t):null}renderChecklistPreview(){if(!this.props.taskDetails)return null;this._checklistItems=[];const e=!this.props.taskPermissions.canEdit||(0,aa.c)(this.props.taskPermissions.checklistPermissions,aa.j.DisableCheckedStateToggling),t=Xl.e.getSortedChecklistItems(this.props.taskDetails.checklist).filter(e=>!e.isChecked).slice(0,10).map(t=>_.createElement("div",{className:"checklistItem",key:t.id},_.createElement("div",{className:"clickWrapper",title:e?Ee.p.Strings.SharedComponents_ReadonlyFieldPermissionsTooltip:t.title,onClick:this.onIgnoreClick,onKeyUp:this.stopKeyUpPropagation},_.createElement(_l.S,{inputProps:{"data-is-focusable":!0},label:t.title,className:"checklistItemText",onChange:e=>this.onPreviewCheckboxChanged(t,e),componentRef:e=>{null!=e&&this._checklistItems.push({element:e,id:t.id})},disabled:e,appTheme:this.props.theme}))));return _.createElement("div",{className:"checklistPreview"},t)}renderNotesPreview(){const{taskDetails:e,callbacks:t}=this.props,r=t.getFlights().TeamsTasksECS_richTextEditorEnabled,n=e&&(r?e.notes?.content:e.description);return _.createElement("div",{className:"notesPreview"},n?r?(o=n,s=e.id,o?(dc[s]?.htmlString!==o&&(dc[s]={htmlString:o,plainText:lc(o)}),dc[s].plainText):""):(0,ic.o)(n):"");var o,s}renderTaskReferencePreviewDescription(){const e=this.props.task.getNumberOfVisibleReferences();if(!this.props.taskDetails)return e>0?_.createElement("div",{className:"referencePreviewDescription","data-is-focusable":"false"},_.createElement("span",{className:"previewCaption"})):null;const t=this.props.taskDetails.getReferenceWithLowestPriority();return this.isPreviewTypeReferenceOrAutomatic()&&t&&t.taskAttachmentType&&t?.taskAttachmentType.taskAttachmentType!==hc.Er.TeamsHostedApp?_.createElement(Ll,{theme:this.props.theme,isFocusable:this.props.isFocusZoneEnabled,attachment:t,onAttachmentClick:this.onAttachmentClick,onKeyDown:this.disableFocusZone}):null}renderReferencePreviewThumbnail(e){if(!this.isPreviewTypeReferenceOrAutomatic()||this.props.task.numberOfReferences<=0)return null;if(null==this.props.taskDetails)return _.createElement("div",{className:(0,je.A)(e.thumbnail,"placeholder")});const t=this.props.taskDetails.getReferenceWithLowestPriority();if(!t?.taskAttachmentType||t?.taskAttachmentType.taskAttachmentType===hc.Er.TeamsHostedApp)return null;const r=this.props.callbacks.getFlights().VideoLinkPreviews;if(r&&t.isGifAttachment())return _.createElement("img",{src:t.url,className:(0,je.A)(e.thumbnail,"real"),onClick:this.onAnimatedPreviewContentClick});if(r&&!t.hasKnownExtension())if(this.state.reactPlayerInstance){const r=this.state.reactPlayerInstance;if(t.taskAttachmentType.videoUrlParseResult.canPlay)return _.createElement("div",{className:(0,je.A)(e.thumbnail,"real"),onClick:this.onAnimatedPreviewContentClick},_.createElement("iframe",{sandbox:void 0,src:t.taskAttachmentType.videoUrlParseResult.embedUrl,allowFullScreen:!0,frameBorder:0}));if(r.canPlay(t.url))return _.createElement("div",{className:(0,je.A)(e.thumbnail,"real"),onClick:this.onAnimatedPreviewContentClick},_.createElement(r,{url:t.url,controls:!0}))}else this.loadReactPlayer();if(!this.props.taskPlan)return this.renderFallbackThumbnail(t,e);const n=this.props.callbacks.getDocumentPreviewThumbnail(this.props.taskPlan.container.externalId,t.url);return null==n||this.state.taskPreviewImageLoadState===Mo.P6.error?this.renderFallbackThumbnail(t,e):_.createElement("div",{className:(0,je.A)(e.thumbnail,"real")},_.createElement(Fo._,{className:"previewImage",shouldFadeIn:!0,imageFit:Mo.N_.none,src:n,alt:"",onLoadingStateChange:this.onImageLoadingStateChange}))}renderFallbackThumbnail(e,t){const r=Il.m.builder.fromTaskAttachment(e,"").build(),n=r.taskAttachmentRowItemType.taskAttachmentType,o=(0,Fl.$)(this.props.theme,n);return _.createElement("div",{className:(0,je.A)(t.thumbnail,"placeholder")},_.createElement(Ra.$,{key:r.url,styles:o,taskAttachmentRowItem:r,className:"fallbackPreviewIcon",icons:Fl.b}))}renderIndicatorRow(e){const{task:t,isFocusZoneEnabled:r,callbacks:n}=this.props,o=_.createElement(El,{ariaLabel:Ee.p.Strings.TaskCard_HasCommentsAriaLabel,isKeyboardFocusable:r,onKeyDown:this.disableFocusZone,appTheme:this.props.theme}),s=t.getNumberOfVisibleReferences(),i=_.createElement(Dl,{isKeyboardFocusable:r,numberOfAttachments:s,onKeyDown:this.disableFocusZone,appTheme:this.props.theme}),a=_.createElement(Bl,{isKeyboardFocusable:r,numChecklistItems:t.numberOfChecklistItems,numCompletedChecklistItems:t.numberOfChecklistItems-t.numberOfActiveChecklistItems,onKeyDown:this.disableFocusZone,appTheme:this.props.theme}),l=(0,ir.Fk)(t.percentComplete),c=(0,ir.aV)(t.priority);return _.createElement("div",{className:e.indicatorRow},_.createElement("div",{className:"leftSection"},c!==sr.gy.Low&&c!==sr.gy.Medium?this.renderPriorityIndicator():null,l!==lr.$.NotStarted&&l!==lr.$.Complete?this.renderInProgressIndicator():null,t.conversationThreadId&&null!==t.conversationThreadId?o:null,s>0?i:null,t.numberOfChecklistItems>0?a:null,n.getFlights().EnableAppPoweredTasks&&this.renderAppPoweredTaskIndicator()))}renderAppPoweredTaskIndicator(){return this.props.task.isAppPoweredTask()?_.createElement(Ql,{isKeyboardFocusable:this.props.isFocusZoneEnabled,onKeyDown:this.disableFocusZone,appTheme:this.props.theme}):null}renderPriorityIndicator(){const e={priorityUrgentText:Ee.p.Strings.Task_PriorityUrgentText,priorityImportantText:Ee.p.Strings.Task_PriorityImportantText,priorityMediumText:Ee.p.Strings.Task_PriorityMediumText,priorityLowText:Ee.p.Strings.Task_PriorityLowText};return _.createElement(Vl,{isKeyboardFocusable:this.props.isFocusZoneEnabled,priorityStrings:e,task:this.props.task,taskPermissions:this.props.taskPermissions,onKeyDown:this.disableFocusZone,onUpdateTask:this.props.callbacks.onUpdateTask,onMenuClick:this.onClickIndicator,appTheme:this.props.theme})}renderInProgressIndicator(){const e=Ee.p.Strings.TaskCard_TaskInProgressText,t={completedText:Ee.p.Strings.PlannerApp_CompletedText,inProgressText:Ee.p.Strings.PlannerApp_InProgressText,notStartedText:Ee.p.Strings.PlannerApp_NotStartedText};return _.createElement(Gl,{ariaLabel:e,canUpdateProgress:this.props.taskPermissions.canUpdateProgress,isKeyboardFocusable:this.props.isFocusZoneEnabled,progressStrings:t,task:this.props.task,onKeyDown:this.disableFocusZone,onUpdateTask:this.props.callbacks.onUpdateTask,onMenuClick:this.onClickIndicator,appTheme:this.props.theme})}renderDueDateIndicator(){let e;return e=this.props.task.dueDate?this.props.task.recurrence?.isActive()?Pt.G(Ee.p.Strings.TaskCard_RecurringDueDateAriaLabel,this.props.task.dueDate.format("LL")):Pt.G(Ee.p.Strings.TaskCard_DueDateAriaLabel,this.props.task.dueDate.format("LL")):Ee.p.Strings.AddTaskCard_DueDateText,this.props.taskPermissions.canUpdateDueDate||(e=Ee.p.Strings.SharedComponents_ReadonlyFieldPermissionsTooltip),_.createElement(Hl,{ariaLabel:e,isKeyboardFocusable:this.props.isFocusZoneEnabled,task:this.props.task,taskPermissions:this.props.taskPermissions,onKeyDown:this.disableFocusZone,onUpdateTask:this.props.callbacks.onUpdateTask,appTheme:this.props.theme})}renderCategoryLabels(){const{callbacks:e,isFocusZoneEnabled:t,task:r,taskPlanLabels:n}=this.props,o=r.appliedCategories.sort(Cn.l.compareNumbers);if(ge()(o)||0===n.length)return null;const s=[];St()(o,e=>{const t=n[e];null!=t&&s.push(Wl.getLabelPlaceholder(t))});const i=s.join(", ");return _.createElement("ul",{className:"labels","aria-label":i,"data-is-focusable":t,tabIndex:t?0:-1,onClick:e=>{e.screenX||e.screenY||e.stopPropagation()},onKeyUp:t=>{Qe.a.isButtonPress(t)&&(t.stopPropagation(),e.setLabelsCollapsedState(!this.context.isLabelCollapsed,r.planId))},onKeyDown:this.disableFocusZone},o.map(e=>this.renderLabel(e,this.context.isLabelCollapsed)))}renderLabel(e,t){const r=this.props.taskPlanLabels[e];return null==r?null:_.createElement("li",{key:e},_.createElement($t.l,{key:e,index:e,isHovered:this.state.labelsHovered,title:Wl.getLabelPlaceholder(r),isCollapsed:t,showBorder:this.state.labelsHovered&&!t,theme:this.props.theme,onClick:e=>{e.stopPropagation(),this.props.callbacks.setLabelsCollapsedState(!t,this.props.task.planId)},onMouseEnterCallback:()=>{this.setState({labelsHovered:!0})},onMouseLeaveCallback:()=>{this.setState({labelsHovered:!1})}}))}isPreviewTypeReferenceOrAutomatic(){return rc()([Jl.X.Reference,Jl.X.Automatic],this.props.task.previewType)>=0}onOtherCommandsMenuOpened(){this.onCloseAssignCallout()}onClickAssign(){this.state.isPeoplePickerVisible||this.setState({isPeoplePickerVisible:!0})}loadReactPlayer(){(0,Si.L)(()=>r.e(82707).then(r.bind(r,90961))).then(e=>{if(!e?.default)throw new Error("Invalid react-player import");this.setState({reactPlayerInstance:e.default})}).catch(e=>{this.props.loggers.traceLogger.logTrace(508077508,B.k.Error,`Failed to dynamically import react-player [Error=${ji.f.getMessage(e)}]`)})}getClassNames(){const{highlightType:e,task:t}=this.props,r=(0,ir.Fk)(t.percentComplete)===lr.$.Complete,n=e.wywaBorderHighlighted,o=!e.assigneeHighlighted&&e.wywaAnimated,s=e.assigneeHighlighted,i=!this.props.taskPermissions.canEdit||(0,aa.c)(this.props.taskPermissions.checklistPermissions,aa.j.DisableCheckedStateToggling);return gl(cl(this.props.theme,this.props.styles,r,n,o,s,i))}constructor(e,t){super(e,t),this.onCardClick=e=>{const{onTaskCardClick:t,task:r}=this.props;Qe.a.isButtonPress(e)&&null!=t&&(t(r.id),e.stopPropagation())},this.showAssigneeLimitError=()=>{this.props.callbacks.showAssigneeLimitError(this.props.task.id)},this.onOpenAssignCallout=()=>{this.setState({isPeoplePickerVisible:!0}),this.props.callbacks.onOpenAssignCallout&&this.props.callbacks.onOpenAssignCallout(this.props.task.planId),null!=this.props.task.creationSource?.publication&&this.props.callbacks.fetchTaskContainerPermissions(this.props.task)},this.onTaskCardCompleteClick=e=>{const{task:t,callbacks:r,loggers:n}=this.props;nc.v.create().setImmediate(()=>{const e=t.toggleCompletionState();r.onUpdateTask(t,e)}),t.isComplete()?n.usageLogger.logData(this.name(),h.M.TaskReactivateButtonClicked,{taskCreationSourceType:t.taskCreationSourceType??""}):n.usageLogger.logData(this.name(),h.M.TaskCompleteButtonClicked,{taskCreationSourceType:t.taskCreationSourceType??""})},this.disableFocusZone=e=>{Qe.a.getKey(e)===Fe.D.TAB&&this.props.disableFocusZone()},this.onIgnoreClick=e=>{e.stopPropagation()},this.stopKeyUpPropagation=e=>{e.stopPropagation()},this.stopMouseClickEventPropagation=e=>{e.stopPropagation()},this.onImageLoadingStateChange=e=>{this.setState({taskPreviewImageLoadState:e})},this.onAttachmentClick=(e,t)=>{if(t.stopPropagation(),t.preventDefault(),e){this.logUsage("ClickAttachment");try{this.props.callbacks.onOpenLink(this.props.taskDetails.references[e])}catch(r){this.props.callbacks.showInfoBanner(La.fc.UnopenableAttachmentLinkInfo)}}null!=this.props.task.creationSource?.publication&&this.props.callbacks.fetchTaskContainerPermissions(this.props.task)},this.onPreviewCheckboxChanged=(e,t)=>{const{taskDetails:r,callbacks:n,onFocusContainer:o,loggers:s}=this.props;if(t?.stopPropagation(),t?.preventDefault(),mn.n.ChangeFocusBeforeRemovalIFocusableAlt(this._checklistItems,o,e.id),null!=r){const t=r.checkChecklistItem(e.id,!0);n.onUpdateTaskDetails(r,t),s.usageLogger.logData("TaskCardChecklist","Checklist item is marked as complete")}},this.toggleBucketMenu=e=>{this.props.taskPermissions.canUpdateBucket&&(e.stopPropagation(),this.setState(e=>({isBucketMenuVisible:!e.isBucketMenuVisible})))},this.dismissBucketMenu=()=>{this.setState({isBucketMenuVisible:!1})},this.setBucket=(e,t)=>{const r=this.props.task.setProperty("bucketId",""!==t.key?t.key:null);this.props.callbacks.onUpdateTask(this.props.task,r),this.dismissBucketMenu()},this.getAssigneePool=()=>null==this.props.callbacks.getAssigneePool?[]:this.props.callbacks.getAssigneePool(this.props.task.id)||[],this.onAnimatedPreviewContentClick=e=>{e.stopProp()},this.onAssignUser=(e,t,r)=>{const{task:n,callbacks:o}=this.props;null!=n&&null!=o.onAssignTask&&-1===n.getAssigneeIds().indexOf(e)&&o.onAssignTask(e,n.id,t,r)},this.onUnassignUser=e=>{if(null!=this.props.task&&null!=this.props.callbacks.onUpdateTask&&-1!==this.props.task.getAssigneeIds().indexOf(e)){const t=this.props.task.getClone();delete t.assignments[e],ge()(t.assignments)&&this.state.isPeoplePickerVisible&&this.setState({isPeoplePickerVisible:!1}),this.props.callbacks.onUpdateTask(this.props.task,t)}},this.onCloseAssignCallout=()=>{this.setState({isPeoplePickerVisible:!1})},this.getZeroTermQueryAssignmentResults=()=>this.props.callbacks.getAssigneeSuggestions(this.props.task.planId,this.props.task),this.tenantSearchAlertUser=e=>{this.props.callbacks.alertUser("SharedComponents_TenantUserSearchResultsToastTitle",[e.toString()])},this.giveUserAccessToPlan=e=>{this.props.callbacks.addUserToContainer(e,this.props.task.planId)},this.preventDefault=e=>{e.preventDefault()},this.onClickIndicator=()=>{null!=this.props.task.creationSource?.publication&&this.props.callbacks.fetchTaskContainerPermissions(this.props.task)},this.state={isBucketMenuVisible:!1,taskPreviewImageLoadState:Mo.P6.notLoaded,isPeoplePickerVisible:!1,labelsHovered:!1,reactPlayerInstance:null}}}gc.contextType=Na;class mc extends Ma{renderComponent(){const e=Ba(this.props.styles),t=_.createElement("div",{key:this.props.entity.id,id:this.props.entity.id,className:e.root,style:{display:this.props.isDragging?"none":""},"data-index":this.props.index,"aria-label":this.props.entity.title,"aria-posinset":this.props.taskBoardCardPositionInColumnGroup+1,"aria-setsize":this.props.totalTasksInColumnGroup,"data-dnd-role":"card","data-is-focusable":!0,role:"listitem",onClick:this.onClick.bind(this),tabIndex:0,onKeyDown:this.handleOnKeyDown.bind(this),onKeyUp:this.handleOnKeyUp.bind(this),ref:e=>{this._taskBoardCardElement=e}},this.cardRenderer());return this.props.taskPermissions.canEdit&&this.props.connectDragSource&&this.props.connectDropTarget?this.props.connectDragSource(this.props.connectDropTarget(t))??t:t}cardSource(){return{beginDrag:e=>({entity:e.entity,index:e.index,sourceColumnValue:e.columnValue,secondaryGrouping:e.secondaryGrouping,props:e})}}componentDidUpdate(e,t){un()(t,this.state)&&un()(e,this.props)||t.enableFocusZone!==this.state.enableFocusZone||this.props.setRef(this._taskBoardCardElement,this.props.entity.id),e.isDragging!==this.props.isDragging&&this.props.onCardDragStateChange?.(this.props.isDragging??!1)}cardRenderer(){const{canAddGuests:e,currentUserId:t,entity:r,maxAssignees:n,onDelete:o,onTaskCardClick:s,showPlanTitle:i,showPreview:a,showCopyLinkToTask:l,taskBoardCardCallbacks:p,taskPermissions:d}=this.props,u={...p.taskCallbacks,onUpdateTask:(e,t)=>{this.onUpdateTask(e,t)}},h=p.getTaskHighlightedType(this.props.entity);this.props.isOver&&(h.assigneeHighlighted=!0);let g=[];const m=null!=r.planId?p.getTaskPlanDetails(r.planId):null,C=p.getTaskPlanLabelUsageCounts(r.planId);return g=tr.U.getILabelArray(m?.categories||[],C),_.createElement(gc,{key:r.id,task:r,taskBucket:null!=r.bucketId?p.getTaskBucket(r.bucketId):null,taskDetails:p.getTaskDetails(r.id),taskPlan:null!=r.planId?p.getTaskPlan(r.planId):null,taskPlanLabels:g,callbacks:u,showBucketTitle:!i&&p.getCurrentTaskGroupingState()!==c.Yc.Bucket,showPlanTitle:i,showPreview:a,showCopyLinkToTask:l,highlightType:h,isFocusZoneEnabled:this.state.enableFocusZone,maxAssignees:n,onDelete:o,onFocusContainer:()=>this.setFocusOnCard(),onTaskCardClick:s,completeBtnRef:this._completeBtnRef,moreBtnRef:this._moreBtnRef,disableFocusZone:this.disableFocusZone.bind(this),currentUserId:t,taskPermissions:d,canAddGuests:e,theme:this.props.theme,loggers:this.context})}onDrop(e,t,r){if(!t||"memberCard"!==t.getItemType())return;const n=t.getItem();if(-1===e.entity.getAssigneeIds().indexOf(n.user.id)){if(e.maxAssignees&&e.entity.getAssigneeIds().length>=e.maxAssignees)return void e.taskBoardCardCallbacks.showAssigneeLimitError(e.entity.id);const t=e.entity.getClone();t.assignments[n.user.id]=new go.I(e.currentUserId,new Date),e.taskBoardCardCallbacks.taskCallbacks.onUpdateTask(e.entity,t)}}onClick(){this.props.onTaskCardClick(this.props.entity.id)}handleOnKeyDown(e){e.stopPropagation(),e.target===e.currentTarget&&(this.lastKeyDown=e.keyCode)}disableFocusZone(){this.setState({enableFocusZone:!1})}handleOnKeyUp(e){e.stopPropagation();const{entity:t,columnValue:r,onKeyboardTaskReorder:n,onTaskCardClick:o,taskPermissions:s}=this.props;e.keyCode===this.lastKeyDown&&(e.keyCode===Fe.D.DOWN_ARROW&&e.ctrlKey&&s.canEdit?n&&n(r,t,!1):e.keyCode===Fe.D.UP_ARROW&&e.ctrlKey&&s.canEdit?n&&n(r,t,!0):e.keyCode===Fe.D.SPACE||e.keyCode===Fe.D.ENTER?o(t.id):e.keyCode===Fe.D.RIGHT_ARROW&&(e.preventDefault(),this.setState({enableFocusZone:!0},()=>{s.canEdit?this._completeBtnRef.current&&this._completeBtnRef.current.focus():this._moreBtnRef.current&&this._moreBtnRef.current.focus()}))),this.lastKeyDown=null}setFocusOnCard(){null!=this._taskBoardCardElement&&this._taskBoardCardElement.focus()}onUpdateTask(e,t){if(e.percentComplete!==t.percentComplete)switch((0,ir.Fk)(t.percentComplete)){case lr.$.NotStarted:this.props.taskBoardCardCallbacks.getCurrentTaskGroupingState()!==c.Yc.Progress&&(0,ir.Fk)(e.percentComplete)!==lr.$.Complete||null==this.props.restoreFocusOnMoveTask?this.setFocusOnCard():this.props.restoreFocusOnMoveTask(t.id);break;case lr.$.InProgress:break;case lr.$.Complete:null!=this.props.restoreFocusOnMoveTask&&this.props.restoreFocusOnMoveTask(t.id);break;default:return}this.props.taskBoardCardCallbacks.taskCallbacks.onUpdateTask(e,t)}constructor(e,t){super(e,t),this._completeBtnRef=_.createRef(),this._moreBtnRef=_.createRef(),this.state={enableFocusZone:!1}}}const Cc=Ia()((0,Vr.I)("card",mc.prototype.cardSource(),mc.prototype.cardCollect),(0,da.T)("memberCard",mc.prototype.cardTarget(),mc.prototype.cardTargetCollect))(mc),kc=(0,j.J9)(function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:$i.Board,n=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,i=arguments.length>6?arguments[6]:void 0,a=arguments.length>7?arguments[7]:void 0,l=arguments.length>8?arguments[8]:void 0,c=Sa;switch(e){case le.Sx.LoopLight:case le.Sx.LoopDark:c=Pa;case le.Sx.Light:case le.Sx.Dark:case le.Sx.TeamsLight:case le.Sx.TeamsDark:case le.Sx.TeamsContrast:case le.Sx.SharePoint:}const p={root:fa(e,r,o,a,l),columnHeader:[va(e),{"> .addButtonContainer":[(0,Le.$Z)(),(0,Le.gS)(),{marginBottom:"17px"}]}],titleSection:[Aa(e,n),r===$i.List&&[Le.cc,Sc(e),{borderRadius:"4px",margin:"4px 0",padding:"0 9px",height:"40px"}],{"> .headerImage":[(0,Le.$Z)(),(0,Le.gS)(),Le.cc],"> .editMenu":[(0,Le.$Z)(),{display:"block","button.editMenuLauncher":[Le.xK,{width:"24px",cursor:"pointer",opacity:0,":focus":{opacity:1}}],"& .stayOpen button.editMenuLauncher":{opacity:1}}],":hover":{"> .editMenu button.editMenuLauncher":{opacity:1}},"> .columnCollapseButton":[Le.xK,(0,Le.$Z)(),(0,Le.gS)(),{margin:`0 ${Ta}`,"> .plannerIcon":[(0,Le.$Z)(),{fontSize:Q.s.large,verticalAlign:"middle",cursor:"pointer",transition:"transform 0.2s ease-in-out",transform:i?"rotate(0deg)":"rotate(180deg)"}],":hover":[e===le.Sx.TeamsContrast&&{color:Ne.z.TeamsContrastHyperlinkColor}]}]}],addButton:bc(e,s),scrollable:[(0,Le.GD)("auto"),(0,Le.gS)("column"),i&&{display:"none "},(0,Le.Ss)(e),r===$i.Board&&!o&&{overflowY:"hidden",overflowX:"hidden",":hover":{overflowY:"auto"}},{marginTop:"-9px",paddingLeft:ka,paddingRight:ka,"> *":[(0,Le.$Z)(),{width:c,":last-child":{flex:"1 0 auto","> .listWrapper > .listboxGroup":{paddingBottom:"36px"}}}],"> .primarySection":{minHeight:"10px",paddingTop:Re.B.ShadowMargin}}]};return(0,Q.TW)(p,t)}),bc=(e,t)=>{let r=!0,n={},o="none",s="",i="",a="",l="40px",c=Re.B.PlannerBorderRadius,p=Sa;switch(e){case le.Sx.Light:break;case le.Sx.Dark:i=so.kd.gray170;break;case le.Sx.TeamsLight:i=so.kd.gray30;break;case le.Sx.TeamsDark:i=so.kd.gray150;break;case le.Sx.TeamsContrast:r=!1,o="1px solid "+Ne.z.White,s=Ne.z.Black,i=Ne.z.TeamsContrastHyperlinkColor,a=Ne.z.TeamsContrastHyperlinkColor;break;case le.Sx.SharePoint:break;case le.Sx.LoopLight:case le.Sx.LoopWorkspaceLight:case le.Sx.LoopDark:case le.Sx.LoopWorkspaceDark:l=ua,c=Re.B.LoopBorderRadius,p=Pa,n=xa(e)}return[(0,Le.$Z)(p),(0,Le.gS)(),Le.cc,(0,Ue.kE)(),(0,Le.NX)(e),(0,Le._D)(e),r&&Re.B.CardShadow,{height:l,marginTop:ba,padding:"0px 10px",border:o,borderRadius:c,boxSizing:"border-box",fontSize:Q.s.mediumPlus,font:"inherit",transition:"color 0.167s ease-in-out, background 0.167s ease-in-out",cursor:"pointer",":hover":[i&&{backgroundColor:i},s&&{color:s},a&&{borderColor:a}],"> .plannerIcon":[(0,Le.$Z)(),{padding:"0px 6px"}],"> .addTaskText":[(0,Le.GD)(),{padding:"0px 6px",fontSize:Q.s.medium}]},n]},Tc=(0,j.J9)(e=>({root:(0,Q.Zq)("taskBoardColumn",e.root),columnHeader:(0,Q.Zq)("columnHeader",e.columnHeader),addButton:(0,Q.Zq)("addButton",e.addButton),titleSection:(0,Q.Zq)("titleSection",e.titleSection),scrollable:(0,Q.Zq)("scrollable",e.scrollable)})),Sc=e=>{let t="";switch(e){case le.Sx.Light:t="rgba(255, 255, 255, 0.8)";break;case le.Sx.Dark:t="rgba(41, 40, 39, 0.8)"}return t?{backgroundColor:t}:{}},Pc="14px",xc=(0,j.J9)((e,t,r)=>{let n=Sa;switch(e){case le.Sx.LoopLight:case le.Sx.LoopDark:n=Pa;case le.Sx.Light:case le.Sx.Dark:case le.Sx.TeamsLight:case le.Sx.TeamsDark:case le.Sx.TeamsContrast:case le.Sx.SharePoint:}const o={root:[(0,Le.gS)("column"),{"> .addControlContainer":{marginTop:`-${Re.B.ShadowMargin}`,padding:`${ba} 0`}}],sectionToggleButton:[Le.xK,(0,Le.$Z)("40px"),(0,Le.gS)(),Le.cc,(0,Le.aS)(e),Sc(e),{width:n,marginTop:"0px",marginBottom:"6px",borderRadius:"4px",fontSize:Q.s.medium,cursor:"pointer","> .toggleText":[(0,Le.GD)("auto"),(0,Le.q0)("ellipsis"),{padding:`0 ${Pc}`,fontSize:Q.s.medium}],"> .sectionItemCount":[(0,Le.GD)()],"> .icon":[(0,Le.$Z)(),(0,Le.gS)(),Le.cc,{padding:`0 ${Pc}`,"> .plannerIcon":[(0,Le.$Z)(),{transition:"transform 0.2s ease-in-out",transform:r?"rotate(180deg)":"rotate(0deg)"}]}]}],placeholderCard:[{position:"absolute",width:n,marginTop:ba,marginBottom:ba,inset:0,backgroundColor:wa(e)},(e===le.Sx.LoopLight||e===le.Sx.LoopDark)&&{borderRadius:Re.B.LoopBorderRadius}],bottomDropZone:{flex:"1 1 auto",boxSizing:"border-box",height:"26px"},listBoxGroup:{position:"relative"},screenReaderOnly:{maxWidth:ya}};return(0,Q.TW)(o,t)}),yc=(0,j.J9)(e=>({root:(0,Q.Zq)("taskBoardColumnGroup",e.root),sectionToggleButton:(0,Q.Zq)("sectionToggleButton",e.sectionToggleButton),placeholderCard:(0,Q.Zq)("placeholderCard",e.placeholderCard),bottomDropZone:(0,Q.Zq)("bottomDropZone",e.bottomDropZone),screenReaderOnly:(0,Q.Zq)("screenReaderOnly",e.screenReaderOnly),listBoxGroup:(0,Q.Zq)("listBoxGroup",e.listBoxGroup)}));var fc=r(39068),vc=r(56434),Ac=r.n(vc),wc=r(91246),Dc=r(44459);class Bc extends pa{componentDidUpdate(e,t){let r=[],n=!1;if(e.data!==this.props.data){const t=e.data.slice(0,this.state.numCardsToRender);r=this.props.data.slice(0,this.state.numCardsToRender),n=!un()(r,t)}if(n&&!ge()(r)){const e=r.filter(e=>!wc.o.isPlexTempId(e.id));for(const t of e)this.props.fetchTaskPreview(t.id);return void(0,hr.qj)(e).map(e=>this.props.fetchPermissionsWithTaskContext(e))}if(t.numCardsToRender!==this.state.numCardsToRender&&!ge()(this.props.data)){const e=this.props.data.slice(t.numCardsToRender,this.state.numCardsToRender).filter(e=>!wc.o.isPlexTempId(e.id));for(const t of e)this.props.fetchTaskPreview(t.id);(0,hr.qj)(e).map(e=>this.props.fetchPermissionsWithTaskContext(e))}}renderComponent(){const e=this.getClassNames(),t=_.createElement("button",{className:e.sectionToggleButton,"data-dnd-role":"sectionToggle","aria-expanded":this.state.showSection,onClick:this.toggleShowSection},_.createElement("h4",{className:"toggleText"},this.props.callbacks.sectionTitleProvider?this.props.callbacks.sectionTitleProvider(this.state.showSection):""),_.createElement("div",{className:"sectionItemCount"},this.props.data.length),_.createElement("div",{className:"icon"},_.createElement(xe.I,tt.Ju)));this._taskBoardCards=[];const r=this.props.data.slice(0,this.state.numCardsToRender).map((e,t)=>this.renderEntityCard(e,t));this.props.isOver&&null!==this.state.placeholderIndex&&r.splice(this.state.placeholderIndex,0,_.createElement("div",{style:{position:"relative"},className:"placeholderCardContainer",key:"placeholder","data-dnd-role":"placeholder"},_.createElement("div",{style:{opacity:0,visibility:"hidden"}},_.createElement(Cc,{key:"placeholder card",index:null,entity:this.state.draggedEntity,columnValue:this.props.columnValue,taskBoardCardCallbacks:this.props.taskBoardCardCallbacks,maxAssignees:this.props.maxAssignees,showPreview:this.props.displayMode===$i.Board,showPlanTitle:this.props.showPlanTitleOnCard,showCopyLinkToTask:this.props.showCopyLinkToTask,secondaryGrouping:!1,onKeyboardTaskReorder:this.props.onKeyboardTaskReorder,onDelete:()=>{},onTaskCardClick:()=>{},setRef:()=>{},currentUserId:this.props.currentUserId,taskPermissions:{canAssign:!0,canDelete:!0,canEditDescription:!0,attachmentPermissions:la.I.DisableNone,canEditTitle:!0,canUpdateDueDate:!0,canUpdatePriority:!0,canUpdatePriorityToUrgent:!0,checklistPermissions:aa.j.DisableNone},canAddGuests:!0,theme:this.props.theme})),_.createElement("div",{className:e.placeholderCard})));let n=!1;this.props.data&&this.state.numCardsToRender<this.props.data.length&&(n=!0);let o="";this.props.modifiedTaskIds&&(1===this.props.modifiedTaskIds.length?o=Ee.p.Strings.TaskBoardColumn_ModifiedTasksSingularAriaLabel:this.props.modifiedTaskIds.length>1&&(o=Pt.G(Ee.p.Strings.TaskBoardColumn_ModifiedTasksPluralAriaLabel,this.props.modifiedTaskIds.length)));const s=this.props.canMoveTaskWithinSameColumn?Ee.p.Strings.TaskCard_MovableTaskCardAriaLabel:Ee.p.Strings.TaskCard_TaskCardAriaLabel,i=_.createElement("div",{className:(0,je.A)(this.props.columnGroupClassName,e.root),"data-dnd-role":"columnGroup","data-can-drag-to-scroll":"true",ref:this.resolveRef(this,"columnGroup")},this.props.isCollapsable?t:null,null!=this.props.callbacks.addCardControlProvider&&this.props.showAddEntityCard?this.renderAddCardControl():null,_.createElement("div",{className:"listWrapper"},this.state.showSection&&!ge()(r)?_.createElement("div",{className:(0,je.A)("listboxGroup",e.listBoxGroup),role:"list","data-can-drag-to-scroll":"true"},_.createElement("div",{className:(0,je.A)(fc.Z,e.screenReaderOnly)},o+this.props.columnName+s),_.createElement(_r.H,{id:"taskColumn",hasMoreItemsToRender:n,orientation:_r.Q.Vertical,onLastElementIsVisible:()=>this.handleInView()},r)):null),this.state.showSection?_.createElement("div",{"data-dnd-role":"bottomDropZone","data-can-drag-to-scroll":"true",className:e.bottomDropZone}):null);return this.props.disableColumnChanges||!this.props.connectDropTarget?i:this.props.connectDropTarget(i)??i}groupTarget(){const e=super.groupTarget();return{drop:(t,r,n)=>{if(t.disableDragInto&&"card"===r.getItemType()){if(r.getItem().sourceColumnValue!==t.columnValue)return}return e.drop?.(t,r,n)},hover:fn()((t,r,n)=>{if(t.disableCustomOrderCards){const e=n;if(e.onHover(t,r,n),"card"===r.getItemType()){const n=r.getItem(),o=r.getClientOffset();if(null==o)return;e._previousPointerYPosition=o.y;let s=document.elementFromPoint(o.x,o.y);s=e.findTarget(s);const i=Ac()(e.props.data);let a=i.indexOf(n.entity);-1===a&&(null!=t.findPlaceHolderIndex?a=t.findPlaceHolderIndex(i,e.props.columnValue,n.entity):(i.push(n.entity),i.sort(Dc.BY),a=i.indexOf(n.entity))),s&&"topDropZone"===s.getAttribute("data-dnd-role")&&e.setPlaceholder(a,n),s&&"bottomDropZone"===s.getAttribute("data-dnd-role")&&e.setPlaceholder(a,n),s&&"card"===s.getAttribute("data-dnd-role")&&e.setPlaceholder(a,n),s&&"sectionToggle"===s.getAttribute("data-dnd-role")&&(!1===e.state.showSection&&e.setState({showSection:!0}),e.setPlaceholder(a,n))}}else e.hover?.(t,r,n)},50),canDrop:(t,r)=>{if(t.taskBoardCardCallbacks.taskCallbacks.getFlights().EnableProjectTasksForPlannerWeb&&"card"===r.getItemType()&&r.getItem()){const e=r.getItem(),n=e.props.taskPermissions;if(e.sourceColumnValue!==t.columnValue&&n){const e=t.taskBoardCardCallbacks.getCurrentTaskGroupingState();if(e===c.Yc.Progress&&!n.canUpdateProgress)return!1;if(e===c.Yc.Priority&&!n.canUpdatePriority)return!1;if(e===c.Yc.DueDate&&!n.canUpdateDueDate)return!1;if(e===c.Yc.Bucket&&!n.canUpdateBucket)return!1;if(e===c.Yc.Assignee&&!n.canAssign)return!1;if(e===c.Yc.Category&&!n.canUpdateAppliedLabels)return!1}else if(e.sourceColumnValue===t.columnValue&&n){if(e.secondaryGrouping!==t.secondaryGrouping&&!n.canUpdateProgress)return!1}}return!e.canDrop||e.canDrop(t,r)}}}getLastTaskCard(){return ge()(this._taskBoardCards)?null:this._taskBoardCards[this._taskBoardCards.length-1].element}renderAddCardControl(){const e=this.props.callbacks.addCardControlProvider&&this.props.toggleAddCardControl?this.props.callbacks.addCardControlProvider(this.props.toggleAddCardControl.bind(this)):null;return _.createElement("div",{key:"addCardControl",className:"addControlContainer"},e)}renderEntityCard(e,t){return _.createElement(Cc,{key:e.id,index:t,entity:e,columnValue:this.props.columnValue,taskBoardCardCallbacks:this.props.taskBoardCardCallbacks,maxAssignees:this.props.maxAssignees,showPreview:this.props.displayMode===$i.Board,showPlanTitle:this.props.showPlanTitleOnCard,showCopyLinkToTask:this.props.showCopyLinkToTask,secondaryGrouping:this.props.secondaryGrouping,onKeyboardTaskReorder:this.props.onKeyboardTaskReorder,onDelete:e=>{this.restoreFocusOnMoveTask(e),this.props.taskBoardCardCallbacks.onDeleteTask(e)},onTaskCardClick:this.onClickTaskCard,setRef:(e,t)=>null!=e&&this._taskBoardCards.push({element:e,id:t}),restoreFocusOnMoveTask:this.restoreFocusOnMoveTask,currentUserId:this.props.currentUserId,taskPermissions:this.props.getTaskPermissions(e),totalTasksInColumnGroup:this.props.data.length,taskBoardCardPositionInColumnGroup:t,canAddGuests:this.props.canAddGuests,onCardDragStateChange:this.props.onCardDragStateChange,theme:this.props.theme})}handleInView(){this.setState({numCardsToRender:this.state.numCardsToRender+Bc.infiniteScrollIncrementSize})}getClassNames(){return yc(xc(this.props.theme,this.props.styles,this.state.showSection))}constructor(e,t){if(super(e,t),this.toggleShowSection=()=>{this.logUsage(h.M.ToggleColumnGroupSection,{sectionId:this.props.columnValue,isCollapsed:String(this.state.showSection),isCompleteSection:String(this.props.secondaryGrouping)}),super.toggleShowSection()},this.restoreFocusOnMoveTask=e=>{const t=null==this.props.altFocusElement?this.columnGroup:this.props.altFocusElement;mn.n.ChangeFocusBeforeRemovalIFocusable(this._taskBoardCards,t,e)},this.onClickTaskCard=e=>{this.props.data.forEach((t,r)=>{t.id===e&&(this._taskDetailsTaskIndex=r)}),this.props.openTaskDetails(e,e=>{this.onTaskDetailsEditorDismiss(e)})},this.onTaskDetailsEditorDismiss=e=>{mn.n.RestoreFocusAfterRemovalAlt(this._taskBoardCards.map(e=>e.element),()=>{this.props.altFocusElement&&this.props.altFocusElement.focus()},this._taskDetailsTaskIndex)},this.state={draggedEntity:null,placeholderIndex:null,showSection:!this.props.isCollapsable,showAddEntityCard:!1,numCardsToRender:Bc.infiniteScrollIncrementSize},!ge()(e.data)){const t=e.data.slice(0,this.state.numCardsToRender);for(const e of t)this.props.fetchTaskPreview(e.id);(0,hr.qj)(t).map(e=>this.props.fetchPermissionsWithTaskContext(e))}}}Bc.infiniteScrollIncrementSize=10;const Ec=(0,da.T)("card",Bc.prototype.groupTarget(),Bc.prototype.groupCollect)(Bc);var Ic,Fc=r(61804),Mc=function(){return Mc=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Mc.apply(this,arguments)};!function(e){e[e.None=0]="None",e[e.Dragging=1]="Dragging",e[e.Scrolling=2]="Scrolling"}(Ic||(Ic={}));var Lc=function(){function e(e,t){var r=this;if(this.options={maxScrollSpeed:1.2,maxSpeedZoneSize:20,maxScrollZoneSize:200,scrollZoneScale:.2,updateScrollSpeedThrottleInterval:50,minDragDistanceForScrolling:50},this.scrollState=Ic.None,this.hasPointerLeftDragStartArea=!1,this.xSpeed=0,this.ySpeed=0,this.canScrollX=!1,this.canScrollY=!1,this.updateScrollSpeed=fn()(function(){if(null!=r.pointerCoord&&null!=r.initialPointerCoord&&r.scrollState!==Ic.None){if(!r.hasPointerLeftDragStartArea){var e=r.initialPointerCoord,t=e.x,n=e.y,o=r.pointerCoord,s=o.x,i=o.y,a=Math.abs(s-t),l=Math.abs(i-n);if(a<r.options.minDragDistanceForScrolling&&l<r.options.minDragDistanceForScrolling)return;r.hasPointerLeftDragStartArea=!0}var c=r.element.getBoundingClientRect(),p=c.left,d=c.right,u=c.top,h=c.bottom,g=c.width,m=c.height,C=r.options,k=C.maxScrollSpeed,b=C.maxSpeedZoneSize,T=C.maxScrollZoneSize,S=C.scrollZoneScale;if(r.canScrollX&&u<r.pointerCoord.y&&r.pointerCoord.y<h){var P=Math.min(T,g*S);r.xSpeed=Nc(r.pointerCoord.x,p,d,P,b,k)}else r.xSpeed=0;if(r.canScrollY&&p<r.pointerCoord.x&&r.pointerCoord.x<d){var x=Math.min(T,m*S);r.ySpeed=Nc(r.pointerCoord.y,u,h,x,b,k)}else r.ySpeed=0;0!==r.xSpeed||0!==r.ySpeed?r.setScrollState(Ic.Scrolling):r.setScrollState(Ic.Dragging)}},this.options.updateScrollSpeedThrottleInterval),this.element=e,t&&(this.options=Mc(Mc({},this.options),t)),this.options.maxScrollSpeed<=0)throw new Error("maxScrollSpeed must be greater than 0");if(this.options.maxSpeedZoneSize<0)throw new Error("maxSpeedZoneSize cannot be negative");if(this.options.maxScrollZoneSize<0)throw new Error("maxScrollZoneSize cannot be negative");if(this.options.scrollZoneScale<=0||this.options.scrollZoneScale>.5)throw new Error("scrollZoneScale must be between 0 and 0.5");if(this.options.updateScrollSpeedThrottleInterval<0)throw new Error("updateScrollSpeedThrottleInterval cannot be negative");if(this.options.minDragDistanceForScrolling<0)throw new Error("minDragDistanceForScrolling cannot be negative")}return e.prototype.setIsDragging=function(e){e?this.scrollState===Ic.None&&this.setScrollState(Ic.Dragging):this.setScrollState(Ic.None)},e.prototype.setPointerCoord=function(e){null==this.initialPointerCoord&&(this.initialPointerCoord=e),this.pointerCoord=e,this.updateScrollSpeed()},e.prototype.setScrollState=function(e){this.scrollState!==e&&(this.scrollState===Ic.None?this.checkElementCanScroll():this.scrollState===Ic.Scrolling&&this.endScroll(),this.scrollState=e,e===Ic.None?this.resetState():e===Ic.Scrolling&&this.startScroll())},e.prototype.startScroll=function(){var e,t=this,r=function(n){if(t.scrollState===Ic.Scrolling){var o=null!=e?n-e:0;e=n;var s=t.xSpeed*o,i=t.ySpeed*o;0===s&&0===i||t.element.scrollBy(s,i),t.rafId=window.requestAnimationFrame(r)}};this.rafId=window.requestAnimationFrame(r)},e.prototype.endScroll=function(){null!=this.rafId&&(window.cancelAnimationFrame(this.rafId),this.rafId=null)},e.prototype.resetState=function(){this.xSpeed=0,this.ySpeed=0,this.pointerCoord=null,this.initialPointerCoord=null,this.hasPointerLeftDragStartArea=!1,this.canScrollX=!1,this.canScrollY=!1},e.prototype.checkElementCanScroll=function(){this.canScrollX=this.element.scrollWidth>this.element.clientWidth,this.canScrollY=this.element.scrollHeight>this.element.clientHeight},e}();function Nc(e,t,r,n,o,s){var i=t+n,a=r-n,l=n-o;return e<t+o?-s:e<i?-((i-e)/l*s):e>r-o?s:e>a?(e-a)/l*s:0}function Rc(e,t){var r=_.useContext(Fc.M).dragDropManager;if(!r)throw new Error("Unable to get dragDropManager from context. Wrap this in <DndProvider>.");_.useEffect(function(){if(null!=e.current){var n=new Lc(e.current,t),o=r.getMonitor(),s=o.subscribeToStateChange(function(){n.setIsDragging(o.isDragging())}),i=o.subscribeToOffsetChange(function(){var e=o.getClientOffset();e&&n.setPointerCoord(e)});return function(){s(),i()}}},[r,e,t])}const Uc=_.forwardRef((e,t)=>{const{scrollerOptions:r,...n}=e;return Rc(t,r),_.createElement("ul",{...n,ref:t})}),Oc=_.forwardRef((e,t)=>{const{scrollerOptions:r,...n}=e;return Rc(t,r),_.createElement("div",{...n,ref:t})});var Hc=r(8403),Vc=r(61460),Gc=r.n(Vc),Wc=r(22317);class _c extends ia{columnCollect(e,t){return{isDragging:t.isDragging(),connectDragSource:e.dragSource(),connectDragPreview:e.dragPreview()}}componentDidMount(){this.props.autoFocus&&!this.props.showAddEntityCard&&this.columnElement&&this.columnElement.focus()}renderComponent(){const e=this.getClassNames();let t="";this.props.modifiedTaskIds&&(1===this.props.modifiedTaskIds.length?t=Ee.p.Strings.TaskBoardColumn_ModifiedTasksSingularAriaLabel:this.props.modifiedTaskIds.length>1&&(t=Pt.G(Ee.p.Strings.TaskBoardColumn_ModifiedTasksPluralAriaLabel,this.props.modifiedTaskIds.length)));const r=_.createElement("li",{ref:this.resolveRef(this,"columnElement"),"data-is-focusable":!0,className:e.root,style:{display:this.props.isDragging?"none":""},"data-index":this.props.index,"data-dnd-role":!0===this.props.disableDrag?void 0:"column",id:`column_${this.props.pivotValue}`,tabIndex:0,"aria-label":this.props.disableDrag?Pt.G(Ee.p.Strings.TaskBoardColumn_ColumnTitleAriaLabel,this.props.title)+t:Pt.G(Ee.p.Strings.TaskBoardColumn_ColumnTitleAriaLabel,this.props.title)+t+Ee.p.Strings.TaskBoardColumn_ColumnAriaLabel,onKeyDown:this.onKeyDown},_.createElement(Wc.pL,{rootMargin:"500px"},this.renderColumnContentCallback.bind(this)));return this.props.disableColumnChanges||!this.props.connectDragPreview?r:this.props.connectDragPreview(r)??r}renderColumnHeader(){const e=this.getClassNames(),t=this.props.headerImage&&_.createElement("div",{className:"headerImage"},this.props.headerImage),r=Pt.G(Ee.p.Strings.TaskBoardColumn_AddButtonContainerAriaLabel,this.props.title),n=_.createElement("div",{className:"addButtonContainer"},_.createElement("div",{className:(0,je.A)(e.addButton,"active_0"),onClick:e=>{this.toggleAddCardControl(e)},onKeyPress:e=>{this.toggleAddCardControl(e)},"aria-label":r,role:"button",tabIndex:0,title:Ee.p.Strings.TaskBoardColumn_AddButtonContainerTooltipText,ref:this.resolveRef(this,"addTaskButtonElement")},_.createElement(xe.I,tt.D5),_.createElement("span",{className:"addTaskText"},Ee.p.Strings.TaskBoardColumn_AddTaskButtonText))),o=null!=this.props.callbacks.addCardControlProvider&&!this.props.disableColumnChanges&&!this.props.disableAddTask;return _.createElement("div",{className:e.columnHeader,draggable:!this.props.disableDrag},_.createElement("div",{className:"columnHeaderTitle passive_1"},_.createElement("div",{className:e.titleSection},t,this.renderColumnTitle(),this.renderEditMenu(),!!this.props.isCollapsable&&_.createElement("button",{className:"columnCollapseButton",onClick:e=>{this.toggleShowSection(e)},"aria-expanded":!this.state.isCollapsed,"aria-label":this.props.title},_.createElement(xe.I,{...tt.Ju,className:(0,je.A)(tt.Ju.className,this.state.isCollapsed?"straight":"rotated")})))),o&&n)}renderColumnBody(){const e=this.getClassNames(),t=this.props.enableAutoScrollOnDragItem?Oc:"div";return _.createElement(t,{className:e.scrollable,"data-can-drag-to-scroll":"true",ref:this.columnBodyRef},this.renderPrimarySection(),this.props.useSecondaryClassification?this.renderSecondarySection():null)}renderPrimarySection(){let e=this.props.data;this.props.useSecondaryClassification&&this.props.callbacks.secondaryClassifier&&(e=ln()(this.props.data,e=>!this.props.callbacks.secondaryClassifier(e)));const t={addCardControlProvider:this.props.callbacks.addCardControlProvider,valueSetter:this.props.callbacks.valueSetter,secondaryValueSetter:this.props.callbacks.secondaryValueSetter},r=this.addTaskButtonElement||this.props.emptyColumnFocusElement||this.columnElement,n=e.map(e=>e.id),o=this.props.modifiedTaskIds?Gc()(this.props.modifiedTaskIds,n):[];return _.createElement(Ec,{columnGroupClassName:"primarySection",columnName:this.props.title,columnValue:this.props.pivotValue,modifiedTaskIds:o,data:e,callbacks:t,isCollapsable:!1,maxAssignees:this.props.maxAssignees,displayMode:this.props.displayMode,showPlanTitleOnCard:this.props.showPlanTitleOnCard,showCopyLinkToTask:this.props.showCopyLinkToTask,taskBoardCardCallbacks:this.props.taskBoardCardCallbacks,onKeyboardTaskReorder:this.onKeyboardTaskReorder,showAddEntityCard:this.props.showAddEntityCard,toggleAddCardControl:()=>this.toggleAddCardControl(),secondaryGrouping:!1,disableCustomOrderCards:this.props.disableCustomOrderCards,disableDragInto:this.props.disableDragInto,findPlaceHolderIndex:this.props.findPlaceHolderIndex,altFocusElement:r??void 0,openTaskDetails:this.props.openTaskDetails,ref:this.resolveRef(this,"primaryTaskBoardColumnGroup"),fetchTaskPreview:this.props.fetchTaskPreview,currentUserId:this.props.currentUserId,disableColumnChanges:this.props.disableColumnChanges,getTaskPermissions:this.props.getTaskPermissions,canAddGuests:this.props.canAddGuests,theme:this.props.theme,canMoveTaskWithinSameColumn:this.props.canMoveTaskWithinSameColumn,fetchPermissionsWithTaskContext:this.props.fetchPermissionsWithTaskContext,onCardDragStateChange:this.onCardDragStateChange})}renderSecondarySection(){if(!this.props.callbacks.secondaryClassifier)return null;const e=ln()(this.props.data,e=>this.props.callbacks.secondaryClassifier(e));if(this._secondarySectionLength=e.length,0===this._secondarySectionLength)return null;const t={sectionTitleProvider:this.props.callbacks.secondarySectionTitleProvider,valueSetter:this.props.callbacks.valueSetter,secondaryValueSetter:this.props.callbacks.secondaryValueSetter},r=null==this.primaryTaskBoardColumnGroup?null:this.primaryTaskBoardColumnGroup.getDecoratedComponentInstance().getLastTaskCard(),n=null==r?this.addTaskButtonElement:r,o=e.map(e=>e.id),s=this.props.modifiedTaskIds?Gc()(this.props.modifiedTaskIds,o):[];return _.createElement(Ec,{columnGroupClassName:"secondarySection",columnName:this.props.title,columnValue:this.props.pivotValue,data:e,modifiedTaskIds:s,callbacks:t,isCollapsable:!0,maxAssignees:this.props.maxAssignees,displayMode:this.props.displayMode,showPlanTitleOnCard:this.props.showPlanTitleOnCard,showCopyLinkToTask:this.props.showCopyLinkToTask,taskBoardCardCallbacks:this.props.taskBoardCardCallbacks,onKeyboardTaskReorder:this.onKeyboardTaskReorder,showAddEntityCard:this.props.showAddEntityCard,secondaryGrouping:!0,disableCustomOrderCards:this.props.disableCustomOrderCards,findPlaceHolderIndex:this.props.findPlaceHolderIndex,openTaskDetails:this.props.openTaskDetails,altFocusElement:n??void 0,fetchTaskPreview:this.props.fetchTaskPreview,currentUserId:this.props.currentUserId,disableColumnChanges:this.props.disableColumnChanges,disableDragInto:this.props.disableDragInto,getTaskPermissions:this.props.getTaskPermissions,canAddGuests:this.props.canAddGuests,theme:this.props.theme,canMoveTaskWithinSameColumn:this.props.canMoveTaskWithinSameColumn,fetchPermissionsWithTaskContext:this.props.fetchPermissionsWithTaskContext,onCardDragStateChange:this.onCardDragStateChange})}renderColumnContentCallback(e){let{inView:t,ref:r}=e;return t||!this.props.bucketVirtualization||this.props.isDragging||this.state.isCardDragged?_.createElement("div",{ref:r,className:"columnContent"},this.props.connectDragSource?this.props.connectDragSource(this.renderColumnHeader()):this.renderColumnHeader(),this.renderColumnBody(),this.state.isDeleteDialogOpen?this.getDeleteDialog():null):_.createElement("div",{ref:r,className:"columnContent"})}renderEditMenu(){if(this.state.isEditingTitle||this.props.disableColumnChanges||!this.props.canEditTitle&&!this.props.canDeleteColumn&&!this.props.canMoveColumnLeft&&!this.props.canMoveColumnRight)return null;const e=_.createElement(Dn.K,{className:"editMenuLauncher",onClick:this.toggleEditMenu,iconProps:tt.XP,ariaLabel:Ee.p.Strings.TaskBoardColumn_MoreOptionsAriaLabel,title:Ee.p.Strings.TaskBoardColumn_MoreOptionsAriaLabel,"aria-expanded":this.state.isEditMenuVisible,"aria-haspopup":!0,elementRef:this.editMenuLauncher,plannerTheme:this.props.theme}),t=[];this.props.canEditTitle&&t.push({key:"Edit",name:Ee.p.Strings.TaskBoardColumn_RenameBucket,onClick:this.startEditingColumnTitle}),this.props.canDeleteColumn&&t.push({key:"Delete",name:Ee.p.Strings.TaskBoardColumn_DeleteBucket,onClick:this.openDeleteDialog}),this.props.canMoveColumnRight&&t.push({key:"MoveRight",name:Ee.p.Strings.TaskBoardColumn_MoveBucketRight,onClick:this.moveBucket.bind(this,!0)}),this.props.canMoveColumnLeft&&t.push({key:"MoveLeft",name:Ee.p.Strings.TaskBoardColumn_MoveBucketLeft,onClick:this.moveBucket.bind(this,!1)});const r=_.createElement(Xe.l,{shouldFocusOnMount:!0,items:t,directionalHint:Je.A.bottomAutoEdge,target:this.editMenuLauncher,onDismiss:this.dismissEditMenu,appTheme:this.props.theme}),n=(0,je.A)("editMenu",{stayOpen:this.state.isEditMenuVisible});return _.createElement("div",{className:n},e,this.state.isEditMenuVisible?r:null)}renderColumnTitle(){if(this.state.isEditingTitle)return _.createElement(na.A,{className:"editColumnTextField",autoComplete:"off",autoFocus:!0,tabIndex:0,placeholder:this.props.title,onKeyUp:this.columnTitleKeyUp,onKeyDown:this.columnTitleTextfieldKeyDown,onBlur:this.onTextFieldBlur,onChange:(e,t)=>{this.columnTitleChanged(t)},ariaLabel:Ee.p.Strings.TaskBoardColumn_EditTitleAriaLabel,value:this.state.updatedTitle,maxLength:Hc.f.TitleMaxLength,styleType:oa.u.Bucket,appTheme:this.props.theme});{const e=(0,je.A)("columnTitle",{readOnly:!this.props.canEditTitle||this.props.disableColumnChanges});return this.props.canEditTitle&&!this.props.disableColumnChanges?_.createElement("div",{className:e,tabIndex:0,onClick:this.startEditingColumnTitle,onKeyDown:this.startEditingColumnTitle,role:"button",title:this.props.title,ref:this.columnTitle},_.createElement("h3",null,this.props.title)):_.createElement("div",{className:e,title:this.props.title},_.createElement("h3",null,this.props.title))}}getDeleteDialog(){const e=(0,Be.S9)(this.props.theme),t=(0,Be.XK)(this.props.theme);return _.createElement(ve.l,{hidden:!this.state.isDeleteDialogOpen,onDismiss:this.dismissDeleteDialog.bind(this),dialogContentProps:{className:le.vt,type:Ae.h.normal,title:"null"===this.props.pivotValue?Ee.p.Strings.TaskBoardColumn_DeleteUncategorizedTitle:Pt.G(Ee.p.Strings.TaskBoardColumn_DeleteBucketText,this.props.title),subText:"null"===this.props.pivotValue?Ee.p.Strings.TaskBoardColumn_DeleteUncategorizedTasksSubtext:Ee.p.Strings.TaskBoardColumn_DeleteBucketTasksText,styles:t},styles:e,modalProps:{className:"deleteColumnDialog",containerClassName:le.bI,isBlocking:!1}},_.createElement(we.E,null,_.createElement(K.j,{onClick:this.deleteColumn},Ee.p.Strings.TaskBoardColumn_DeleteBucketButtonText),_.createElement(q.Y,{onClick:this.dismissDeleteDialog},Ee.p.Strings.TaskBoardColumn_CancelDelete)))}getClassNames(){const e=!this.props.canEditTitle||this.props.disableColumnChanges;return Tc(kc(this.props.theme,this.props.styles,this.props.displayMode,e,this.props.isSlimView,this.props.showAddEntityCard,this.state.isCollapsed,this.props.isTeamsSplitUI,ae.B.isUnoContext))}constructor(e,t){var r;super(e,t),r=this,this.editMenuLauncher=_.createRef(),this.columnTitle=_.createRef(),this.SET_FOCUS_TIMEOUT=60,this.columnBodyRef=_.createRef(),this.toggleAddCardControl=e=>{(null==e||Qe.a.isButtonPress(e))&&(this.props.callbacks.addCardControlProvider&&(this.props.showAddEntityCard&&this.addTaskButtonElement?(this.addTaskButtonElement.focus(),this.props.onCloseAddTaskCard()):this.props.onOpenAddTaskCardFromAddTaskButton(),this.props.toggleAddTaskFormVisibility(this.props.pivotValue)),null!=e&&e.stopPropagation())},this.toggleShowSection=e=>{null!=e&&(e.stopPropagation(),e.preventDefault());const t=this.props.pivotValue===lr.$.Complete;this.logUsage(h.M.ToggleColumnGroupSection,{sectionId:this.props.pivotValue,isCollapsed:String(!this.state.isCollapsed),isCompleteSection:String(t)}),this.setState(e=>({...e,isCollapsed:!e.isCollapsed}))},this.toggleEditMenu=()=>{this.setState(e=>({...e,isEditMenuVisible:!e.isEditMenuVisible}))},this.dismissEditMenu=()=>{this.setState(e=>({...e,isEditMenuVisible:!1}))},this.startEditingColumnTitle=e=>{e.stopPropagation(),Qe.a.isButtonPress(e)&&(this.props.setTaskBoardEditMode(Qc.Edit),this.setState(e=>({...e,isEditingTitle:!0,updatedTitle:this.props.title})))},this.onKeyDown=e=>{if(e.stopPropagation(),this.props.disableColumnChanges||!this.props.onReorderColumn)return;const t=!(0,Me.jI)();e.ctrlKey&&e.shiftKey&&e.keyCode===Fe.D.Period?(e.preventDefault(),this.props.onReorderColumn(this.props.pivotValue,t)):e.ctrlKey&&e.shiftKey&&e.keyCode===Fe.D.Comma&&(e.preventDefault(),this.props.onReorderColumn(this.props.pivotValue,!t))},this.onTextFieldBlur=e=>{this.updateColumnTitle(),this.dismissEditTitle(!1)},this.moveBucket=e=>{setTimeout(()=>{this.setFocusOnMoreMenu()},this.SET_FOCUS_TIMEOUT),this.props.onReorderColumn&&(e?this.props.onReorderColumn(this.props.pivotValue,!0):this.props.onReorderColumn(this.props.pivotValue,!1))},this.columnTitleKeyUp=e=>{e.stopPropagation()},this.columnTitleTextfieldKeyDown=e=>{const t=Qe.a.getKey(e);t===Fe.D.ESCAPE?this.dismissEditTitle():t===Fe.D.ENTER&&(this.updateColumnTitle(),this.dismissEditTitle())},this.columnTitleChanged=e=>{this.setState(t=>({...t,updatedTitle:e}))},this.updateColumnTitle=()=>{this.props.updateColumnTitle&&(this.state.updatedTitle&&""!==this.state.updatedTitle.trim()&&this.state.updatedTitle!==this.props.title&&this.props.updateColumnTitle(this.state.updatedTitle),""===this.state.updatedTitle&&this.props.taskBoardCardCallbacks.getCurrentTaskGroupingState()===c.Yc.Category&&this.state.updatedTitle!==this.props.title&&this.props.updateColumnTitle(""))},this.dismissEditTitle=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];r.props.setTaskBoardEditMode(Qc.Drag),r.setState(e=>({...e,isEditingTitle:!1,updatedTitle:r.props.title}),()=>{e&&r.columnTitle?.current?.focus()})},this.openDeleteDialog=()=>{this.setState(e=>({...e,isDeleteDialogOpen:!0}))},this.dismissDeleteDialog=()=>{this.setFocusOnMoreMenu(),this.setState(e=>({...e,isDeleteDialogOpen:!1}))},this.deleteColumn=()=>{this.setState(e=>({isDeleteDialogOpen:!1}),()=>{"null"===this.props.pivotValue&&this.context.usageLogger.logData("TaskBoardColumn",h.M.DeleteUncategorizedBucket),null!=this.props.onDeleteColumn&&this.props.onDeleteColumn(this.props.pivotValue)})},this.onKeyboardTaskReorder=(e,t,r)=>{if(!this.props.data)return;const n=this.getSortAfterBeforeTasks(t,r,this.props.data);null===n[0]&&null===n[1]||this.props.callbacks.valueSetter(t,n[0],n[1],e)},this.getSortAfterBeforeTasks=(e,t,r)=>{let n=null,o=null;const s=r.indexOf(e);if(t){if(0===s)return[o,n];for(let t=s-1;t>=0&&(e.isComplete()!==r[t].isComplete()||(n?o||(o=r[t]):n=r[t],!o||!n));t--);}else{if(s===r.length-1)return[o,n];for(let t=s+1;t<r.length&&(e.isComplete()!==r[t].isComplete()||(o?n||(n=r[t]):o=r[t],!o||!n));t++);}return[o,n]},this.setFocusOnMoreMenu=()=>{this.editMenuLauncher.current?this.editMenuLauncher.current.focus():null!=this.addTaskButtonElement&&this.addTaskButtonElement.focus()},this.onCardDragStateChange=e=>{this.setState({isCardDragged:e})},this._secondarySectionLength=0,this.state={showAddEntityCard:!1,isCollapsed:this.props.isCollapsed||!1,isEditingTitle:!1,updatedTitle:this.props.title,isEditMenuVisible:!1,isDeleteDialogOpen:!1,isCardDragged:!1}}}const zc=(0,Vr.I)("column",_c.prototype.columnSource(),_c.prototype.columnCollect)(_c),Zc="32px",Kc=(0,_e.vb)((0,_e.jz)(Re.B.TopHeaderIconHorizontalOffset)-(0,_e.jz)(ha)),qc=(0,j.J9)(function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:$i.Board,n=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0;const i=Nt.d.isLoopTheme(e);let a=ya,l=ha;switch(e){case le.Sx.LoopLight:case le.Sx.LoopDark:a=Pa,l=ga;break;case le.Sx.TeamsLight:case le.Sx.TeamsDark:case le.Sx.TeamsContrast:s||(l=ma);case le.Sx.Light:case le.Sx.Dark:case le.Sx.SharePoint:}const c={root:[(0,Le.GD)(),(0,Le.gS)(),r===$i.Board&&{"> ul.columnsList":{padding:s?`0 ${Kc} 0 15px`:`0 ${Kc}`},".sharepointApp &":{padding:`${Re.B.SharepointContentTopPadding} ${Re.B.SharepointHorizontalPadding} ${Re.B.SharepointContentBottomPadding}`}},r===$i.List&&{marginLeft:Re.B.ShadowMargin}],columnsList:[(0,Le.GD)(),r===$i.Board&&[(0,Le.gS)(),{overflowX:"auto",overflowY:"hidden","> li":[(0,Le.$Z)(a)]}],r===$i.List&&[(0,Le.gS)("column"),{"> li":[(0,Le.$Z)()]}]],createColumn:[fa(e,r,n,o,s),{"> .columnContent > .columnHeader":[va(e),{"> .columnHeaderTitle > .titleSection":[Aa(e,!1),i&&{overflow:"visible","> .columnTitle":[(0,Le.$Z)(),{".plannerIcon":[(0,Le.$Z)("auto"),(0,Le._D)(e),xa(e),(0,Ue.kE)(),{display:"flex",width:Zc,height:Zc,borderRadius:"8px"}],"> span":{display:"none"}}]}]}]}],addColumnButton:[Le.xK,(0,Le.aS)(e),{cursor:"pointer",":hover":[(0,Le.aS)(e)]}],placeholderColumn:[{width:a,padding:`0 ${l}`,boxSizing:"content-box",backgroundColor:wa(e),"> div":{opacity:0,visibility:"hidden"}},(e===le.Sx.LoopLight||e===le.Sx.LoopDark)&&{borderRadius:Re.B.LoopBorderRadius}]};return(0,Q.TW)(c,t)}),jc=(0,j.J9)(e=>({root:(0,Q.Zq)("taskBoardView",e.root),columnsList:(0,Q.Zq)("columnsList",e.columnsList),createColumn:(0,Q.Zq)("createColumn",e.createColumn),addColumnButton:(0,Q.Zq)("addColumnButton",e.addColumnButton),placeholderColumn:(0,Q.Zq)("placeholderColumn",e.placeholderColumn)}));var Qc;!function(e){e[e.Edit=0]="Edit",e[e.Drag=1]="Drag"}(Qc||(Qc={}));class Yc extends ra{renderComponent(){const e=this.getClassNames(),t=this.props.columnDefinitions;this._boardColumns=[];const r=t.map((e,t)=>this.renderBoardViewColumn(e,t)),n=null!=this.state.draggedColumnIndex?this.props.columnDefinitions[this.state.draggedColumnIndex]:null;this.props.isOver&&null!=this.state.placeholderIndex&&this.state.placeholderIndex>=0&&null!=n&&r.splice(this.state.placeholderIndex,0,_.createElement("li",{className:e.placeholderColumn,key:"placeholder","data-dnd-role":"placeholder"},_.createElement("div",null,this.renderBoardViewColumn(n,null))));const o=this.props.enableDragToScroll?{onPointerDown:this.onPointerDown,onPointerMove:this.onPointerMove,onPointerUp:this.onPointerUp}:null,s=this.props.enableAutoScrollOnDragItem?Uc:"ul",i=_.createElement("div",{className:e.root},_.createElement(s,{className:e.columnsList,ref:this.boardViewUlElementRef,...o},r,this.renderCreateColumn()));return this.props.disableColumnChanges||!this.props.connectDropTarget?i:this.props.connectDropTarget(i)??i}componentDidUpdate(e,t){this.shouldSetFocus&&this.addColumnButton&&(this.addColumnButton.focus(),this.shouldSetFocus=!1)}renderBoardViewColumn(e,t){const{callbacks:r}=this.props,n={secondaryClassifier:r.secondaryClassifier,secondarySectionTitleProvider:r.secondarySectionTitleProvider,secondaryValueSetter:r.secondaryValueSetter,valueSetter:(t,n,o,s)=>r.valueSetter(t,e.pivotValue,n,o,s),addCardControlProvider:r.addCardControlProvider?t=>r.addCardControlProvider(e.pivotValue,null,e.dataEntities?e.dataEntities[0]:null,()=>{},t):void 0},o=null!=e.pivotValue?e.pivotValue.toString():"null",s=null===e.pivotValue||0===this.state.interactionMode||!e.canEditTitle||!this.props.enableColumnMove||this.props.disableColumnChanges,i=this.props.enableColumnMove??!1,a=e.dataEntities?e.dataEntities.map(e=>e.id):[],l=this.props.modifiedTaskIds?Gc()(this.props.modifiedTaskIds,a):[];return _.createElement(zc,{autoFocus:this.props.autoFocus&&0===t,key:o,data:e.dataEntities,modifiedTaskIds:l,canEditTitle:e.canEditTitle,canDeleteColumn:e.canDeleteColumn,canMoveColumnRight:i&&e.canMoveColumnRight,canMoveColumnLeft:i&&e.canMoveColumnLeft,updateColumnTitle:e.onUpdateTitle,onDeleteColumn:e=>this.onDeleteColumn(e),onReorderColumn:(e,t)=>this.onReorderColumn(e,t),useSecondaryClassification:this.props.useSecondaryClassification,callbacks:n,taskBoardCardCallbacks:this.props.taskBoardCardCallbacks,title:e.title,pivotValue:o,index:t,disableDrag:s,setTaskBoardEditMode:this.setTaskBoardEditMode.bind(this),isCollapsable:e.isCollapsable,isCollapsed:e.isCollapsed,headerImage:e.headerImage,maxAssignees:this.props.maxAssignees,displayMode:this.props.displayMode,showPlanTitleOnCard:this.props.showPlanTitleOnCard,showCopyLinkToTask:this.props.showCopyLinkToTask,toggleAddTaskFormVisibility:this.props.toggleAddTaskFormVisibility,onOpenAddTaskCardFromAddTaskButton:this.props.onOpenAddTaskCardFromAddTaskButton,onCloseAddTaskCard:this.props.onCloseAddTaskCard,showAddEntityCard:!(!this.props.showAddEntityCardCallback||this.props.disableColumnChanges)&&this.props.showAddEntityCardCallback(o),disableAddTask:e.disableAddTask,disableCustomOrderCards:e.disableCustomOrderCards,disableDragInto:e.disableDragInto,findPlaceHolderIndex:e.findPlaceHolderIndex,openTaskDetails:this.props.openTaskDetails,emptyColumnFocusElement:this.props.emptyColumnFocusElement,ref:e=>{null!=e?.getDecoratedComponentInstance()&&this._boardColumns.push({element:e.getDecoratedComponentInstance().columnElement,id:o})},fetchTaskPreview:this.props.fetchReferencePreviewForTask,currentUserId:this.props.currentUserId,disableColumnChanges:this.props.disableColumnChanges,getTaskPermissions:this.props.getTaskPermissions,bucketVirtualization:this.props.bucketVirtualization,isSlimView:this.props.isSlimView,canAddGuests:this.props.canAddGuests,theme:this.props.theme,canMoveTaskWithinSameColumn:e.canMoveTaskWithinSameColumn,enableAutoScrollOnDragItem:this.props.enableAutoScrollOnDragItem,isTeamsSplitUI:this.props.isTeamsSplitUI,fetchPermissionsWithTaskContext:this.props.fetchPermissionsWithTaskContext})}setTaskBoardEditMode(e){this.setState(t=>({...t,interactionMode:e}))}renderCreateColumn(){if(this.props.columnCreationEnabled){const e=this.getClassNames();return _.createElement("li",{className:e.createColumn},_.createElement("div",{className:"columnContent","data-can-drag-to-scroll":"true"},_.createElement("div",{className:"columnHeader"},_.createElement("div",{className:"columnHeaderTitle"},_.createElement("h3",{className:"titleSection"},this.renderAddColumnControlArea())))))}return null}renderAddColumnControlArea(){if(this.props.disableColumnChanges)return null;const e=this.getClassNames();return this.state.showAddColumnControl?_.createElement("form",{onSubmit:this.createColumn.bind(this),autoComplete:"off",className:"editColumnTextField"},_.createElement(na.A,{className:"active_1",autoFocus:!0,tabIndex:0,placeholder:this.props.createColumnPlaceholder,onKeyUp:this.onCreateColumnKeyUp.bind(this),onBlur:this.createColumn.bind(this),onChange:(e,t)=>{this.columnNameChanged(t)},ariaLabel:this.props.createColumnButtonText,value:this.state.newColumnName,maxLength:Hc.f.TitleMaxLength,styleType:oa.u.Bucket,appTheme:this.props.theme})):_.createElement("button",{className:(0,je.A)("columnTitle",e.addColumnButton),onClick:this.toggleAddColumnControl.bind(this),ref:this.resolveRef(this,"addColumnButton"),title:Ee.p.Strings.TaskBoardColumn_AddNewBucket,"aria-label":Ee.p.Strings.TaskBoardColumn_AddNewBucket},_.createElement(xe.I,tt.D5),_.createElement("span",{className:"active_1"}," ",this.props.createColumnButtonText))}toggleAddColumnControl(){this.setState(e=>({...e,showAddColumnControl:!e.showAddColumnControl,newColumnName:"",interactionMode:1}))}onCreateColumnKeyUp(e){Qe.a.getKey(e)===Fe.D.ESCAPE&&this.dismissAddColumn()}createColumn(e){e.preventDefault(),""!==this.state.newColumnName&&null!=this.props.createColumnCallback&&this.props.createColumnCallback(this.state.newColumnName),this.dismissAddColumn()}dismissAddColumn(){null!=this.props.createColumnCallback&&(this.shouldSetFocus=!0),this.setState(e=>({...e,showAddColumnControl:!1,newColumnName:"",interactionMode:1}))}columnNameChanged(e){this.setState(t=>({...t,newColumnName:e}))}onReorderColumn(e,t){if(this.props.taskBoardCardCallbacks.getCurrentTaskGroupingState()!==c.Yc.Bucket)return;if(!this.props.callbacks.onColumnDrop)return;const r=this.props.columnDefinitions,n=pn()(r,t=>t.pivotValue===e);if(-1===n)return;let o=null,s=null;t?(s=r[n+1]?r[n+1].pivotValue:null,o=r[n+2]?r[n+2].pivotValue:null):(s=r[n-2]?r[n-2].pivotValue:null,o=r[n-1]?r[n-1].pivotValue:null),null==o&&null==s||this.props.callbacks.onColumnDrop(e,s,o)}onDeleteColumn(e){mn.n.ChangeFocusBeforeRemovalIFocusable(this._boardColumns,this.addColumnButton,e),null!=this.props.deleteColumnCallback&&this.props.deleteColumnCallback(e)}getClassNames(){return jc(qc(this.props.theme,this.props.styles,this.props.displayMode,this.props.isSlimView,this.props.isTeamsSplitUI,ae.B.isUnoContext))}constructor(e,t){super(e,t),this.shouldSetFocus=!1}}const Jc=(0,da.T)("column",Yc.prototype.boardTarget(),Yc.prototype.boardCollect)(Yc);var Xc=r(15018),$c=r(34717);const ep=Re.B.userBubbleDiameter,tp="3px",rp="5px",np="10px",op=Re.B.ShadowMargin,sp=(0,j.J9)((e,t)=>{const r=Nt.d.isLoopTheme(e);let n=Sa,o="228px",s=Re.B.PlannerBorderRadius;switch(e){case le.Sx.LoopLight:case le.Sx.LoopDark:n=Pa,o="200px",s=Re.B.LoopBorderRadius;case le.Sx.Light:case le.Sx.Dark:case le.Sx.TeamsLight:case le.Sx.TeamsDark:case le.Sx.TeamsContrast:case le.Sx.SharePoint:}const i={root:[(0,Le.gS)("column","nowrap"),(0,Le.NX)(e),(0,Ue.kE)(),{position:"relative",width:n,marginTop:op,borderRadius:s,".ms-Callout &":{marginTop:"0px"},".setFieldsSection":[(0,Le.$Z)(),{padding:"0px 16px"}]},e!==le.Sx.TeamsContrast&&{boxShadow:Re.B.hoverShadow},e===le.Sx.TeamsContrast&&{backgroundColor:Ne.z.Black,border:`1px solid ${Ne.z.White}`,boxSizing:"border-box"}],titleSection:[(0,Le.gS)("row"),(0,Le.$Z)(),{marginTop:"16px",marginBottom:(0,_e.vb)((0,_e.jz)(np)-(0,_e.jz)(tp)),"> .plannerIcon":[(0,Le.$Z)("20px"),{marginRight:np,color:Ne.z.NeutralTertiary},e===le.Sx.TeamsContrast&&{color:Ne.z.White}]}],textField:[(0,Le.$Z)(o),!r&&(0,Ue.kE)(),{".ms-Callout &":[(0,Le.$Z)("192px")],".ms-TextField-fieldGroup":(0,Le.nK)(e)}],property:[(0,Le.gS)(),(0,Le.$Z)(),(0,Le.aS)(e),!r&&(0,Ue.kE)(),{alignItems:"center",padding:`${tp} 0px ${r?"0px":tp} 0px`,minHeight:ep,fontSize:Q.s.medium,"> .launcher":[Le.xK,(0,Le.gS)("row","nowrap"),(0,Le.GD)(),{cursor:"pointer",alignItems:"center",width:"100%","> *":{margin:rp},"> i":[(0,Le.$Z)("20px"),{marginLeft:"0"}],"> span, > div":[(0,Le.GD)()]},r&&{":hover":[(0,Le._D)(e),(0,Ue.cP)({borderRadius:"4px"}),{".plannerIcon > span":(0,Ue.h8)()}]}]}],addTaskButton:[(0,Le.$Z)(r?"32px":"44px"),(0,Le.jU)(e),r&&{width:"236px",alignSelf:"center",marginBottom:"10px"},{fontSize:Q.s.medium,color:Ne.z.White,border:"none",marginTop:(0,_e.vb)((0,_e.jz)("14px")-(0,_e.jz)(tp)/2),borderRadius:r?Re.B.LoopButtonBorderRadius:`0 0 ${Re.B.PlannerBorderRadius} ${Re.B.PlannerBorderRadius}`,"&:hover":[{cursor:"pointer"},r&&(0,Ue.cP)()]}]};return(0,Q.TW)(i,t)}),ip=(0,j.J9)(e=>({root:(0,Q.Zq)("addTaskCard",e.root),titleSection:(0,Q.Zq)("titleSection",e.titleSection),textField:(0,Q.Zq)("addTaskTextField",e.textField),property:(0,Q.Zq)("property",e.property),addTaskButton:(0,Q.Zq)("addTaskButton",e.addTaskButton)})),ap=(0,j.J9)(e=>{const t=Nt.d.isLoopTheme(e);return{root:[(0,Le.GD)(),{width:"100%"},t&&{":hover":[(0,Ue.cP)({borderRadius:"4px"}),{".plannerIcon > span":(0,Ue.h8)()}]}],assigneeRow:[{"> .ms-Facepile-addButton i":{margin:"2px 10px 10px 0px"},"> .ms-Facepile":{margin:"6px 0px"}}],assignDiv:t&&{":hover":{"> .plannerIcon, .assignLabel":[(0,Le._D)(e),(0,Ue.h8)()]}},addFriendIcon:{margin:`${rp} 10px ${rp} 0px`}}});var lp=r(98352),cp=r(14740),pp=r.n(cp),dp=r(12759),up=r.n(dp),hp=r(97943);class gp extends ce.${name(){return"AddTaskCard"}renderComponent(){const e=this.getClassNames(),t=this.renderSetBucket(e),r=this.renderSetDueDate(e),n=this.renderAssignPicker(e);return _.createElement("div",{"aria-label":Ee.p.Strings.AddTaskCard_AddTaskFormAriaLabel,className:(0,je.A)(e.root,"walkthroughStep2"),ref:this.resolveRef(this,"addTaskCardElement"),onBlur:this.onAddTaskCardBlur,onClick:this.stopPropagation,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp},_.createElement("div",{className:"setFieldsSection"},this.renderTitleSection(e),!this.props.hideSetBucket&&t,!this.props.hideSetDueDate&&r,!this.props.hideSetAssignment&&n),_.createElement("button",{className:e.addTaskButton,onClick:this.createTask},Ee.p.Strings.AddTaskCard_AddTaskButtonText))}renderTitleSection(e){return _.createElement("div",{className:e.titleSection},_.createElement(xe.I,tt.vx),this.renderTextField(e.textField))}renderTextField(e){const t={className:e,autoFocus:this.props.autoFocus,tabIndex:0,placeholder:Ee.p.Strings.AddTaskCard_AddTaskPlaceholderText,onClick:this.stopPropagation,onKeyPress:this.createTask,onChange:(e,t)=>{this.taskNameChanged(t)},ariaLabel:Ee.p.Strings.AddTaskCard_TaskNameText,value:this.state.newTaskName,errorMessage:this.state.taskNameErrorMsg,styleType:oa.u.Dialog,maxLength:Xc.i.TitleMaxLength,appTheme:this.props.theme},r={uniqueIdentifier:this.state.newTaskId,...t,styles:(0,lp.pS)(t.appTheme,t.styleType),highlightStyle:(0,Le.H)(t.appTheme),onDateChange:this.onSmartControlDateChange};return this.props.renderSmartTextField&&this.state.showSmartTextField?this.props.renderSmartTextField(r):_.createElement(na.A,t)}renderSetBucket(e){if(0===this.props.buckets.length)return null;""===this.defaultBucketId&&(this.defaultBucketId=this.props.buckets[0].id);const t=[];let r=null;this.props.buckets.forEach(e=>{this.state.bucketId===e.id&&(r=e),t.push({key:e.id,name:e.title,checked:this.state.bucketId===e.id,onClick:this.setBucket})});const n=_.createElement(Xe.l,{shouldFocusOnMount:!0,items:t,directionalHint:Je.A.bottomAutoEdge,target:this._bucketMenuElement,onDismiss:this.dismissBucketMenu,appTheme:this.props.theme}),o=null==r?Ee.p.Strings.AddTaskCard_BucketText:r.title;return _.createElement("div",{className:(0,je.A)("addTaskBucket",e.property)},_.createElement("button",{className:"launcher",ref:e=>this._bucketMenuElement=e,onClick:this.toggleBucketMenu,title:o,"aria-label":Pt.G(Ee.p.Strings.AddTaskCard_BucketButtonAriaLabel,o)},_.createElement(xe.I,tt.fD),_.createElement("span",null,o)),this.state.isBucketMenuVisible?n:null)}renderSetDueDate(e){const t=null==this.state.dueDate?Ee.p.Strings.AddTaskCard_DueDateText:Pt.G(Ee.p.Strings.AddTaskCard_DueDateValueText,sc.lz.FormatDate(zi()(this.state.dueDate))),r=Ol(Ul(this.props.theme,this.props.styles)).callout;return _.createElement("div",{className:(0,je.A)("addTaskDueDate",e.property)},_.createElement("button",{className:"launcher",ref:e=>this._dueDateButtonElement=e,onClick:this.onDueDateClick,title:t},_.createElement(xe.I,tt.cx),_.createElement("span",null,t)),this.state.showCalendar&&_.createElement(Dt.P,{ariaLabel:Ee.p.Strings.TaskEditor_SelectEndDateAriaLabel,isBeakVisible:!1,className:(0,je.A)("ms-DatePicker-callout",r),gapSpace:0,doNotLayer:!1,role:"dialog",target:this._dueDateButtonElement,directionalHint:Je.A.bottomLeftEdge,onDismiss:this.onDueDateCalendarDismiss,setInitialFocus:!0},_.createElement(At.Y,{isClickableOutsideFocusTrap:!0},_.createElement(Nl.V,{onSelectDate:this.onSelectDueDate,onDismiss:this.onDueDateCalendarDismiss,isMonthPickerVisible:!1,value:null==this.state.dueDate?void 0:this.state.dueDate.toDate(),today:new Date,theme:this.props.theme}))))}renderAssignPicker(e){return _.createElement("div",{className:(0,je.A)("addTaskAssignee",e.property),ref:this.resolveRef(this,"addTaskAssignee")},this.renderAssignmentControl())}renderAssignmentControl(){const e=pp()(gn()(this.state.assignedToUserIds,e=>this.props.getUser(e)));return _.createElement(Oa.UI,{layout:Oa.Yn.Compact,assignees:e,currentUserId:this.props.currentUserId,canEditAssignments:!0,canEditAccessPermissions:this.props.canAddUser,canGiveAccessToGuests:this.props.canAddGuests,canAssignToResourcesWithoutAccess:this.props.canAddUser,canAccessPlanViaSharedContainerOnly:this.props.canAccessPlanViaSharedContainerOnly??!1,minQueryTermLength:le.c9.MinCharsNeededToSearch,maxAssignees:this.props.maxAssignees,maxDisplayablePersonas:le.eg.MaxDisplayablePersonasAddTaskCard,addIconPlacement:Oa.aq.BeforeAssignees,strings:{assignControlIconTitle:Ee.p.Strings.TaskAssignmentControl_AssignControlLauncherText,assignControlLauncherText:Ee.p.Strings.TaskAssignmentControl_AssignControlLauncherText,assignControlAssignToMeButtonText:Ee.p.Strings.TaskAssignmentControl_AssignToMeLabel,readonlyFieldPermissionsTooltip:Ee.p.Strings.SharedComponents_ReadonlyFieldPermissionsTooltip,assignControlAriaLabelSuffix:Ee.p.Strings.TaskAssignmentControl_AssignControlAriaLabelSuffix,assignControlAriaLabelPrefix:Ee.p.Strings.TaskAssignmentControl_AssignControlAriaLabelPrefix,assignControlAriaLabelPrefixNoAssignees:Ee.p.Strings.TaskAssignmentControl_AssignControlAriaLabelPrefixNoAssignees,assignControlListSeparator:Ee.p.Strings.TaskAssignmentControl_AssignControlAriaLabelListSeparator,assignControlAriaLabelConstruction:Ee.p.Strings.TaskAssignmentControl_AssignControlAriaLabelConstruction,assignmentFilterPlaceholderText:Ee.p.Strings.AssignmentPicker_AssignFilterPlaceholder,assignmentFilterAriaLabel:Ee.p.Strings.AssignmentPicker_AssignFilterPlaceholder,noResultsFoundText:Ee.p.Strings.AssignmentPicker_NoResultsFoundText,giveAccessTooltipText:Ee.p.Strings.AssignmentPicker_GiveAccessButtonAriaLabel,unassignUserButtonText:Ee.p.Strings.AssignmentPicker_UnassignUserButtonAriaLabel,assignedSectionHeader:Ee.p.Strings.AssignmentPicker_AssignedSectionHeader,queryLoadingText:Ee.p.Strings.AssignmentPicker_LoadingText,suggestedSectionHeader:Ee.p.Strings.AssignmentPicker_SuggestedSectionHeader,personaRoleGuest:Ee.p.Strings.AssignmentPicker_PersonaRoleGuest,personaRoleNonMember:Ee.p.Strings.AssignmentPicker_PersonaRoleNonMember,personaCompoundRole:Ee.p.Strings.AssignmentPicker_PersonaCompoundSubText,suggestedAssigneeMostAvailableUser:Ee.p.Strings.AssignmentPicker_SuggestedAssigneeMostAvailableUser,suggestedAssigneePlanTopAssignee:Ee.p.Strings.AssignmentPicker_SuggestedAssigneePlanTopAssignee,suggestedAssigneeSimilarTitle:Ee.p.Strings.AssignmentPicker_SuggestedAssigneeSimilarTitle,suggestedAssigneeUserTopAssignee:Ee.p.Strings.AssignmentPicker_SuggestedAssigneeUserTopAssignee},onRenderPersona:this.props.onRenderPersona,getUsersWithPlanAccess:()=>this.props.getAssigneePool()||[],getZeroTermQueryResults:this.getZeroTermQueryAssignmentResults,onAssignUser:this.onAssignUser,onUnassignUser:this.onUnassignUser,onGivePlanAccess:this.giveUserAccessToPlan,onOpenAssignCallout:this.onOpenAssignCallout,getSearchQueryResults:this.props.getUsersWithKeyword,getUserPhoto:this.props.getUserPhoto,showAssigneeLimitError:this.props.showAssigneeLimitError,alertUser:this.tenantSearchAlertUser,theme:this.props.theme,renderAssignToMeButton:this.props.enableSuggestedAssigneeUI,styles:ap(this.props.theme)})}alertUser(){this.props.alertUser("SharedComponents_AddTaskErrorToastTitle")}taskNameChanged(e){this.setState(t=>({newTaskName:e,taskNameErrorMsg:""!==e.trim()?"":t.taskNameErrorMsg}))}resetControl(){this.setState({newTaskId:wc.o.generate(),newTaskName:"",taskNameErrorMsg:"",bucketId:this.defaultBucketId,showCalendar:!1,dueDate:this.props.defaultDueDate,assignedToUserIds:[],showSmartTextField:!0})}isFormDirty(){return null!=this.state.newTaskName&&""!==this.state.newTaskName.trim()||!un()(this.state.dueDate,this.props.defaultDueDate)||!ge()(this.state.assignedToUserIds)||this.state.bucketId!==this.defaultBucketId}getClassNames(){return ip(sp(this.props.theme,this.props.styles))}constructor(e,t){super(e,t),this.onAddTaskCardBlur=e=>{const t=e.relatedTarget||document.activeElement;(0,hp.s)(this.addTaskCardElement,t)||t.className.indexOf("addButton")>=0||t.className.indexOf("addTaskButton")>=0||this.isFormDirty()||this.props.toggleAddCard(e)},this.toggleBucketMenu=e=>{e.stopPropagation(),this.setState(e=>({isBucketMenuVisible:!e.isBucketMenuVisible}))},this.setBucket=(e,t)=>{e.stopPropagation(),this.setState({bucketId:t.key,isBucketMenuVisible:!1})},this.dismissBucketMenu=()=>{this.setState({isBucketMenuVisible:!1})},this.onDueDateClick=e=>{e.stopPropagation(),this.setState(e=>({showCalendar:!e.showCalendar}))},this.onDueDateCalendarDismiss=()=>{this.setState({showCalendar:!1})},this.onSelectDueDate=e=>{this.setState({showCalendar:!1,dueDate:null!=e?sc.lz.ToUTC10am(zi()(e)):void 0,showSmartTextField:!1})},this.onSmartControlDateChange=e=>{this.setState({dueDate:e?sc.lz.ToUTC10am(zi()(e)):this.props.defaultDueDate})},this.onOpenAssignCallout=()=>{this.props.onOpenAssignCallout(this.props.planId)},this.onAssignUser=(e,t,r)=>{const{onAssignNonMember:n,getAssigneePool:o}=this.props,s=o()||[];this.setState(o=>{if(-1===o.assignedToUserIds.indexOf(e)){const i=()=>{o.assignedToUserIds.push(e),r?.()};Qn()(s,t=>t.id===e)?i():n?.(e,this.state.newTaskId,t,i)}return o});const i=this.props.getUser(e),a=null!=i?i.displayName:"";this.props.alertUser("SharedComponents_AssignUserToastTitle",[a])},this.onUnassignUser=e=>{this.setState(t=>{const r=t.assignedToUserIds.indexOf(e);return-1!==r&&t.assignedToUserIds.splice(r,1),t});const t=this.props.getUser(e),r=null!=t?t.displayName:"";this.props.alertUser("SharedComponents_UnassignUserToastTitle",[r])},this.createTask=e=>{const{currentUserId:t,planId:r,createTask:n}=this.props;e.stopPropagation();if(Qe.a.getKey(e)===Fe.D.ENTER||"click"===e.type){if(""===this.state.newTaskName.trim())return this.setState({taskNameErrorMsg:Ee.p.Strings.SharedComponents_AddTaskErrorToastTitle}),void this.alertUser();const o=up()(this.state.assignedToUserIds,(e,r)=>(e[r]=new go.I(t,new Date),e),{});n($c.Y.builder.withPropertyBag({id:this.state.newTaskId,title:this.state.newTaskName,planId:r,percentComplete:(0,ir.BK)(lr.$.NotStarted),bucketId:""!==this.state.bucketId?this.state.bucketId:null,dueDate:null==this.state.dueDate?void 0:zi()(this.state.dueDate),assignments:o}).build()),this.resetControl(),this.props.closeOnKeyPress&&this.props.toggleAddCard(e)}},this.onKeyDown=e=>{const t=Qe.a.getKey(e);this._lastKeyDown=null==e?null:t},this.onKeyUp=e=>{Qe.a.getKey(e)===Fe.D.ESCAPE&&this._lastKeyDown===Fe.D.ESCAPE&&this.props.toggleAddCard(e),this._lastKeyDown=null},this.stopPropagation=e=>{e.stopPropagation()},this.getZeroTermQueryAssignmentResults=()=>this.props.getAssigneeSuggestions(this.props.planId,$c.Y.builder.withPropertyBag({id:wc.o.generate(),title:this.state.newTaskName,planId:this.props.planId}).build()),this.tenantSearchAlertUser=e=>{this.props.alertUser("SharedComponents_TenantUserSearchResultsToastTitle",[e.toString()])},this.giveUserAccessToPlan=e=>{this.props.addUserToContainer(e,this.props.planId)},this.defaultBucketId="",0!==this.props.buckets.length&&(this.defaultBucketId=this.props.buckets[0].id),this.state={newTaskId:wc.o.generate(),newTaskName:"",taskNameErrorMsg:"",bucketId:this.defaultBucketId,isBucketMenuVisible:!1,showCalendar:!1,dueDate:e.defaultDueDate,assignedToUserIds:[],showSmartTextField:!0}}}const mp=(0,j.J9)((e,t)=>{const r={main:[{position:"relative",backgroundColor:Ne.z.ThemePrimary,boxSizing:"border-box",padding:"20px",width:"340px"},e===le.Sx.Light&&{color:Ne.z.White},e===le.Sx.Dark&&{color:Ne.z.NeutralLight}],header:{fontSize:Q.s.large},title:[e===le.Sx.Light&&{color:Ne.z.White},e===le.Sx.Dark&&{color:Ne.z.NeutralLight}],subText:[{fontSize:Q.s.medium,margin:"16px 0"},e===le.Sx.Light&&{color:Ne.z.White},e===le.Sx.Dark&&{color:Ne.z.NeutralLight}],actions:[(0,Le.gS)(),{alignItems:"center"}],left:(0,Le.GD)(),detail:{fontSize:Q.s.xSmall},right:[(0,Le.$Z)(),{"> .nextButton":[(0,Le.$Z)(),e===le.Sx.Light&&{backgroundColor:Ne.z.White,color:Ne.z.ThemePrimary},e===le.Sx.Dark&&{color:Ne.z.NeutralLight}]}]};return(0,Q.TW)(r,t)}),Cp=(0,j.J9)((e,t)=>{const r=mp(e,t);return{main:(0,Q.Zq)("walkthroughStep_main",r.main),header:(0,Q.Zq)("header",r.header),title:(0,Q.Zq)("title",r.title),subText:(0,Q.Zq)("subText",r.subText),actions:(0,Q.Zq)("actions",r.actions),left:(0,Q.Zq)("left",r.left),detail:(0,Q.Zq)("detail",r.detail),right:(0,Q.Zq)("right",r.right)}}),kp={border:"none",backgroundColor:Ne.z.ThemePrimary,boxShadow:"0px 0px 15px -5px rgba(0, 0, 0, 0.4)"},bp={root:kp,beak:kp},Tp=(0,j.J9)(e=>({root:[{position:"absolute",right:"0",top:"0"},e===le.Sx.Light&&{color:Ne.z.White},e===le.Sx.Dark&&{color:Ne.z.NeutralLight}]}));class Sp extends ce.${name(){return"WalkthroughStep"}renderComponent(){const e=this.getClassNames(),t=_.createElement(fo.K,{className:(0,je.A)("ms-TeachingBubble-closebutton","closeButton"),iconProps:tt.s5,title:Ee.p.Strings.WalkthroughStep_Walkthrough_CloseButtonText,ariaLabel:Ee.p.Strings.WalkthroughStep_Walkthrough_CloseButtonText,onClick:this.onSkipButtonDown.bind(this),styles:Tp(this.props.theme)});return _.createElement(Dt.P,{className:"walkthroughStep",target:this.props.target,gapSpace:this.props.gapSpace||0,directionalHint:this.props.direction||Je.A.bottomCenter,doNotLayer:null==this.props.doNotLayer||this.props.doNotLayer,setInitialFocus:!0,styles:bp},_.createElement("div",{className:e.main,tabIndex:0,"aria-label":Pt.G(Ee.p.Strings.WalkthroughStep_Walkthrough_CombinedTextAriaLabel,this.props.detail,this.props.title,this.props.subtitle)},_.createElement("div",{className:e.header},_.createElement("div",{className:e.title},this.props.title)),t,_.createElement("div",{className:"inner"},_.createElement("div",{className:"content"},_.createElement("div",{className:e.subText},this.props.subtitle)),_.createElement("div",{className:e.actions},_.createElement("div",{className:e.left},_.createElement("div",{className:e.detail},this.props.detail)),_.createElement("div",{className:e.right},this.props.showNextButton&&this.props.onNextClicked&&_.createElement(K.j,{className:"nextButton",onClick:this.props.onNextClicked.bind(this)},this.getNextButtonText()))))))}onSkipButtonDown(e){Qe.a.isButtonPress(e)&&this.props.onSkipClicked&&this.props.onSkipClicked()}getNextButtonText(){return this.props.isLastStep?Ee.p.Strings.WalkthroughStep_Walkthrough_FinishButtonText:Ee.p.Strings.WalkthroughStep_Walkthrough_NextButtonText}getClassNames(){const{theme:e,styles:t}=this.props;return Cp(e,t)}constructor(e,t){super(e,t)}}class Pp extends mo.M{name(){return h.M.PlannerWalkthrough}async fetchCriticalData(e,t){if(!this.fetchCriticalDataWhenComponentDidUpdate(e,t))return;let r=null;if(0!==e.tasks.length||e.currentUserDetails.getDidActiveWalkthrough()){if(0!==e.tasks.length&&!e.currentUserDetails.getDidPassiveWalkthrough()){if(!e.isFirstRunExperience||!e.isSessionFromTaskLink){(await this.props.actionCreatorProviders.walkthroughActionCreator()).startWalkthrough(le.hs.Passive),r=e.currentUserDetails.setFirstRunExperienceDataProperty("didPassiveWalkthrough",!0)}}}else{(await this.props.actionCreatorProviders.walkthroughActionCreator()).startWalkthrough(le.hs.Active),r=e.currentUserDetails.setFirstRunExperienceDataProperty("didActiveWalkthrough",!0).setFirstRunExperienceDataProperty("didPassiveWalkthrough",!0)}if(null!=r){(await this.props.actionCreatorProviders.userActionCreator()).updateUserDetails(e.currentUserDetails,r)}}fetchNonCriticalData(e,t){}renderComponent(){const e=this.getWalkthroughStepDetail();return null==e?null:_.createElement(Sp,e)}getWalkthroughStepDetail(){if(this.props.walkthroughStore.getCurrentWalkthroughMode()===le._9.Walkthrough){const e=this.props.walkthroughStore.getCurrentWalkthroughStepIndex();return null==e?null:this.getWalkthroughStep(this.props.walkthroughStore.getCurrentWalkthroughType(),e)}return null}checkForCriticalDataReady(){return!0}fetchCriticalDataWhenComponentDidUpdate(e,t){return null==this.props.walkthroughStore.getCurrentWalkthroughStepIndex()&&null!=this.props.currentUser&&null!=this.props.currentUserDetails&&null!=this.props.tasks&&null!=this.props.buckets&&0!==this.props.buckets.length&&null!=this.props.users&&0===this.props.currentUser.totalTasksCreated}async onNextClicked(){(await this.props.actionCreatorProviders.walkthroughActionCreator()).showNextStep()}async onSkipClicked(){(await this.props.actionCreatorProviders.walkthroughActionCreator()).skipWalkthrough(this.props.walkthroughStore.getCurrentWalkthroughType(),this.props.walkthroughStore.getCurrentWalkthroughStepIndex())}async onCompletion(){(await this.props.actionCreatorProviders.walkthroughActionCreator()).completeWalkthrough(this.props.walkthroughStore.getCurrentWalkthroughType())}getWalkthroughStep(e,t){if(e===le.hs.Active)switch(t){case 0:return{target:".active_0",title:Ee.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Active_Step0_Title,subtitle:Ee.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Active_Step0_Subtitle,detail:this.getDescriptionText(1,4),direction:Je.A.rightTopEdge,onSkipClicked:this.onSkipClicked.bind(this),gapSpace:30,theme:this.props.theme};case 1:return{target:".active_1",title:Ee.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Active_Step1_Title,subtitle:Ee.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Active_Step1_Subtitle,detail:this.getDescriptionText(2,4),direction:Je.A.bottomLeftEdge,onSkipClicked:this.onSkipClicked.bind(this),theme:this.props.theme};case 2:return{target:".active_2",title:Ee.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Active_Step2_Title,subtitle:Ee.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Active_Step2_Subtitle,detail:this.getDescriptionText(3,4),direction:Je.A.bottomLeftEdge,onSkipClicked:this.onSkipClicked.bind(this),theme:this.props.theme};case 3:return{target:".active_3",title:Ee.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Active_Step3_Title,subtitle:Ee.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Active_Step3_Subtitle,detail:this.getDescriptionText(4,4),direction:Je.A.rightCenter,isLastStep:!0,onSkipClicked:this.onSkipClicked.bind(this),theme:this.props.theme};default:return null}else{if(e!==le.hs.Passive)throw new Error("NotImplementedException: Unknown WalkthroughType requested");switch(t){case 0:return{target:".passive_0",title:Ee.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Passive_Step0_Title,subtitle:Ee.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Passive_Step0_Subtitle,detail:this.getDescriptionText(1,3),direction:Je.A.rightCenter,showNextButton:!0,onNextClicked:this.onNextClicked.bind(this),onSkipClicked:this.onSkipClicked.bind(this),theme:this.props.theme};case 1:return{target:".passive_1",title:Ee.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Passive_Step1_Title,subtitle:Ee.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Passive_Step1_Subtitle,detail:this.getDescriptionText(2,3),direction:Je.A.bottomLeftEdge,showNextButton:!0,onNextClicked:this.onNextClicked.bind(this),onSkipClicked:this.onSkipClicked.bind(this),theme:this.props.theme};case 2:return{target:".passive_2",title:Ee.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Passive_Step2_Title,subtitle:Ee.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Passive_Step2_Subtitle,detail:this.getDescriptionText(3,3),direction:Je.A.rightCenter,isLastStep:!0,showNextButton:!0,onNextClicked:this.onCompletion.bind(this),onSkipClicked:this.onSkipClicked.bind(this),theme:this.props.theme};default:return null}}}getDescriptionText(e,t){return Pt.G(Ee.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_StepDescription,e.toString(),t.toString())}constructor(e,t){super(e,t),this.state={}}}var xp=r(25246);const yp=`calc(100% - ${(0,_e.vb)((0,_e.jz)(Re.B.TopHeaderHeight)+(0,_e.jz)(Re.B.TopHeaderPaddingTop)+(0,_e.jz)(Re.B.TopHeaderPaddingBottom))})`,fp=`calc(100% - ${(0,_e.vb)((0,_e.jz)(Re.B.TopHeaderHeight)+(0,_e.jz)(Re.B.SharepointContentTopPadding))})`,vp=`calc(100% - ${(0,_e.vb)((0,_e.jz)(Re.B.TeamsTopHeaderHeight)+(0,_e.jz)(Re.B.TopHeaderPaddingTop)+(0,_e.jz)(Re.B.TeamsTopHeaderMargin))})`,Ap=(0,j.J9)((e,t,r,n)=>{const o=yi(e,r),s={root:[(0,Le.gS)("column","nowrap"),e!==le.Sx.SharePoint&&(0,Le.GD)(),e===le.Sx.SharePoint&&{minHeight:"800px"}],taskBoardViewLandmark:[(0,Le.GD)("0px"),(0,Le.gS)("column","nowrap"),t&&e===le.Sx.TeamsLight&&{background:Re.B.HeaderlessTeamsBackgroundColor},r&&{marginLeft:"16px"}]};return(0,Q.pB)(void 0,o,s,n)}),wp=(0,j.J9)(e=>({...vi(e),root:(0,Q.Zq)("planTaskBoardPage",e.root),taskBoardViewLandmark:(0,Q.Zq)("taskBoardViewLandmark",e.taskBoardViewLandmark)})),Dp=(0,j.J9)((e,t)=>({root:{position:"relative",width:"100%",height:e===le.Sx.SharePoint?fp:yp,".teamsApp &":{height:t?"100%":vp}},columnsList:{}}));var Bp=r(74065),Ep=r.n(Bp),Ip=(r(87424),r(9376),r(7670));function Fp(e,t,r,n,o,s,i){if(!e||!t)return[];const a=[],l=Oi()(r,"id");return(0,Ip.Fy)(e,t,l,o).forEach(e=>{const t=null!=e.pivotValue?l[e.pivotValue]??s(e.pivotValue):null,r=e,o=null==t&&null!=e.pivotValue;var c;r.canEditTitle=!1,r.isCollapsable=n,r.isCollapsed=!1,r.title=t?t.formattedDisplayName:null!=e.pivotValue?(c=e.pivotValue,(0,qs.W_)(c)?Ee.p.Strings.AssignmentPicker_PersonaRoleNonMember:Ee.p.Strings.PlannerApp_FormerUserName):Ee.p.Strings.PlannerApp_UnassignedText,r.disableAddTask=o,r.disableDragInto=o,r.headerImage=i&&t?i(t)??void 0:void 0,r.canMoveTaskWithinSameColumn=!0,a.push(r)}),a}function Mp(e,t,r,n,o,s,i,a){if(!e||!t||!r)return[];const l=[],c=a?(0,Ip.wA)(e,t,r):(0,Ip.M1)(e,t,r);if(1===c.length){if(null!=c[0].dataEntities&&0===c[0].dataEntities.length)return[];if(null==r)return[]}return i?.(c),c.forEach((e,t)=>{const i=e;if(null==e.pivotValue)i.canDeleteColumn=n,i.canEditTitle=!1,i.canMoveColumnLeft=!1,i.canMoveColumnRight=!1,i.title=Ee.p.Strings.Bucket_NullBucketLabel,i.headerImage=o();else{const o=Qn()(r,t=>t.id===e.pivotValue);null!=o&&(i.canDeleteColumn=n,i.canEditTitle=!!s,i.canMoveColumnLeft=1!==t,i.canMoveColumnRight=t!==c.length-1,i.title=o.title,i.onUpdateTitle=s?e=>{s(o,e)}:void 0)}i.isCollapsed=!1,i.isCollapsable=!n,i.canMoveTaskWithinSameColumn=!0,(null!=i.pivotValue||null!=i.dataEntities&&0!==i.dataEntities.length)&&l.push(i)}),l}function Lp(e,t,r,n,o,s){if(!t||!r)return[];const i=[];return(o!==Di.t.Plan&&null!=s?(0,Ip.PG)(t,n,s):(0,Ip.py)(t,r,n)).forEach(t=>{if(null==t.pivotValue)return void e.logTrace(507778442,B.k.Warning,"Null progress group pivot value");const r=t;r.canEditTitle=!1,r.isCollapsable=!n,r.isCollapsed=!1,r.title=$c.Y.getProgressTitle(t.pivotValue),r.canMoveTaskWithinSameColumn=!0,i.push(r)}),i}function Np(e,t,r,n,o,s){if(!e)return[];const i=[];return(0,Ip.Qc)(e,r).forEach(e=>{const a=e,l=e.pivotValue;if(a.canDeleteColumn=!1,a.canEditTitle=null!=l&&!!o,a.canMoveColumnLeft=!1,a.canMoveColumnRight=!1,a.isCollapsable=!n,a.isCollapsed=!1,null==l)a.title=Ee.p.Strings.Labels_UnlabeledText;else{const e=r[l];a.title=null!=e&&""!==e?e:tr.U.getLabelPlaceholderByIndex(l)}a.disableCustomOrderCards=!0,a.onUpdateTitle=o&&null!=l?e=>o(l,t,e):void 0,a.headerImage=s&&null!=l?s(l):void 0,a.canMoveTaskWithinSameColumn=!1,i.push(a)}),i}function Rp(e,t){const r=[];return(0,Ip.GU)(e).forEach(e=>{const n=e;n.canEditTitle=!1,n.canDeleteColumn=!1,n.canMoveColumnRight=!1,n.canMoveColumnLeft=!1,n.title=function(e){switch(e){case c.Tt.Future:return Ee.p.Strings.PlannerApp_FutureDueDateText;case c.Tt.Late:return Ee.p.Strings.PlannerApp_LateDueDateText;case c.Tt.NextWeek:return Ee.p.Strings.PlannerApp_NextWeekDueDateText;case c.Tt.NoDate:return Ee.p.Strings.PlannerApp_NoDateDueDateText;case c.Tt.ThisWeek:return Ee.p.Strings.PlannerApp_ThisWeekDueDateText;case c.Tt.Today:return Ee.p.Strings.PlannerApp_TodayDueDateText;case c.Tt.Tomorrow:return Ee.p.Strings.PlannerApp_TomorrowDueDateText;default:return""}}(n.pivotValue),n.isCollapsable=t,n.isCollapsed=!1,n.disableCustomOrderCards=!0,n.findPlaceHolderIndex=Ip.fS,n.canMoveTaskWithinSameColumn=!1,r.push(n)}),r}function Up(e,t){const r=[];return(0,Ip.K5)(e).forEach(e=>{const n=e;n.canEditTitle=!1,n.canDeleteColumn=!1,n.canMoveColumnRight=!1,n.canMoveColumnLeft=!1,n.title=$c.Y.getPriorityText(n.pivotValue),n.isCollapsable=t,n.isCollapsed=!1,n.disableCustomOrderCards=!0,n.findPlaceHolderIndex=Ip.pU,n.canMoveTaskWithinSameColumn=!1,r.push(n)}),r}class Op extends Xi{name(){return p.EC.PlanTaskboard}setupCallbacks(){super.setupCallbacks(),this.taskBoardCallbacks={getCurrentTaskGroupingState:()=>this.props.viewStore.getCurrentTaskGroupingState(this.taskAccessContext),getTaskBucket:e=>null!=e?this.props.bucketStore.getBucket(e):null,getTaskDetails:e=>null!=e?this.props.taskStore.getTaskDetails(e):null,getTaskGroupId:e=>null!=e?this.props.planStore.getContainerIdForPlan(e):null,getTaskPlan:e=>null!=e?this.props.planStore.getPlan(e):null,getTaskPlanDetails:e=>null!=e?this.props.planStore.getPlanDetails(e):null,getTaskPlanLabelUsageCounts:e=>this.props.aggregatesStore.getLabelUsageCountsForPlan(e),getTaskHighlightedType:this.getTaskHighlightedType,onDeleteTask:this.onDeleteTask,showAssigneeLimitError:this.onShowAssigneeLimitError,taskCallbacks:{isTaskOnMyDay:this.props.isTaskOnMyDay,toggleMyDayForTask:this.props.toggleMyDayForTask,...this.taskCardCallbacks}}}getViewClassNames(){return wp(this.getViewStyles())}getViewStyles(){return Ap(this.props.appContextStore.getCurrentTheme(),ae.B.headerlessMode,ae.B.isUnoContext,this.props.styles)}isAddTaskCardShowing(){return!0}generateColumnAddTaskPivotValue(){const{viewPartitionKey:e,loggers:t}=this.props,r=this.props.planStore.getPlan(e);if(null==r)return;const n=null==this.state?void 0:this.state.columnAddTaskPivotValue;if(void 0!==n)return n;const o=this.getTaskData();if(!this.checkForCriticalViewDataReady())return;if(0!==o.length)return null;const s=this.getTaskboardTaskFormatData()??[];let i=[];const a=this.props.viewStore.getCurrentTaskGroupingState(this.taskAccessContext);switch(a){case c.Yc.Bucket:i=Mp(o,Oi()(s,"id"),this.props.bucketStore.getBucketsForPlan(e),!0,this.renderUncategorizedBucketHeaderImage);break;case c.Yc.Progress:i=Lp(t.traceLogger,o,Oi()(s,"id"),!0,this.taskAccessContext);break;case c.Yc.Assignee:i=Fp(o,Oi()(s,"id"),this.getContainerMembers(r.container.externalId),!1,this.props.appContextStore.getCurrentUserId(),this.taskCardCallbacks.getUser,this.renderAssigneeHeaderImage);break;case c.Yc.Category:const n=this.props.planStore.getPlanDetails(e);i=Np(o,e,n?.categories??[],!0,this.onUpdateCategoryTitle);break;case c.Yc.DueDate:i=Rp(o,!1);break;case c.Yc.Priority:i=Up(o,!1);break;case c.Yc.None:case c.Yc.Plan:break;default:return void ji.f.unreachableCase(a,e=>{t.traceLogger.logTrace(508060124,B.k.Error,e)})}if(0!==i.length&&(0!==o.length||ae.B.clientType!==u.s.Webpart)){if(this.props.viewStore.getCurrentTaskGroupingState(this.taskAccessContext)===c.Yc.Bucket){let e=0;for(;null==i[e].pivotValue;)e++;return this.props.bucketStore.getBucketStatus(i[e].pivotValue)!==xp.v.Created?void 0:i[e].pivotValue}return null===i[0].pivotValue?"null":i[0].pivotValue?.toString()}}renderComponent(){const{viewPartitionKey:e,appContextStore:t}=this.props,r=ae.B.clientType!==u.s.Plex||ae.B.isUnoContext?null:this.renderWalkthrough(),n=this.getThemedPageStyles(e);return _.createElement(_.Fragment,null,_.createElement("div",{className:(0,je.A)(this.getViewClassNames().root),style:n},this.renderMessageBar(),this.renderViewCommandBar(),this.renderPartitionedView(t.getCurrentTheme()),r))}componentDidUpdate(e,t){super.componentDidUpdate(e,t);const{viewPartitionKey:r}=this.props;e.viewPartitionKey!==r&&(this.loggedUnbucketedTasks=!1,this.setState({columnAddTaskPivotValue:void 0}))}componentDidMount(){super.componentDidMount(),this.logUsage(h.M.PlanTaskBoard_Navigated);const{loggers:e}=this.props;ae.B.clientType!==u.s.Plex&&ae.B.clientType!==u.s.Teams||Te.q.logFloodgateActivity(h.M.LoadTaskBoard,e.traceLogger)}storeDidUpdate(){if(super.storeDidUpdate(),void 0===this.state.columnAddTaskPivotValue){const e=this.generateColumnAddTaskPivotValue();void 0!==e&&this.setState(t=>({...t,columnAddTaskPivotValue:e}))}}renderPlanView(){return this.renderTaskBoard()}renderTaskBoard(){const{flights:e,viewPartitionKey:t,loggers:r}=this.props,n=this.props.planStore.getPlan(t);if(null==n)return null;const o=this.props.viewStore.getCurrentTaskGroupingState(this.taskAccessContext),s=this.getTaskData(),i=this.getTaskboardTaskFormatData(),a=Oi()(i,"id"),l=this.props.viewStore.getCurrentTaskFilter(this.getViewKey()),p=this.props.viewStore.getFilterExceptions(),h=s.filter(e=>$c.Y.ApplyEntityFilter(e,l,p));let g;this.isAddTaskCardShowing()&&(g=this.generateAddCardControlProvider());const m={valueSetter:(e,t,r,n,o)=>{},secondaryClassifier:e=>!1,secondaryValueSetter:(e,t)=>{},secondarySectionTitleProvider:e=>Ee.p.Strings.PlannerApp_CompletedSectionText,onColumnDrop:async(e,t,r)=>{let n=null,s=null,i=null;if(null!=e&&o===c.Yc.Bucket){if(n=this.props.bucketStore.getBucket(e),null!=t&&(s=this.props.bucketStore.getBucket(t)),null!=r&&(i=this.props.bucketStore.getBucket(r)),null==n)return;const o=n.setProperty("orderHint",qi.O.generateOrderHintBetween(i?i.orderHint:null,s?s.orderHint:null));(await this.props.actionCreatorProviders.bucketActionCreator()).updateBucket(n,o)}},addCardControlProvider:g};let C,k=[],b=!1,T=!1,S=!1,P="",x="";const y=n?this.props.permissionsStore.getPlanPermissions(n):this.props.permissionsStore.getDefaultPlanPermissions();switch(o){case c.Yc.Bucket:T=!0,k=Mp(h,a,this.props.bucketStore.getBucketsForPlan(t),!0,this.renderUncategorizedBucketHeaderImage,this.onUpdateBucketTitle,this.logUnbucketedTasksCount),b=!0,m.valueSetter=(e,t,r,n,o)=>this.bucketBoardValueSetter(a,e,t,r,n,o),m.secondaryClassifier=this.completedTaskClassifier,m.secondaryValueSetter=this.completedSectionValueSetter,S=y.canAddBuckets,C=async e=>{let r=null;const n=Ep()(k);if(n){const e=this.props.bucketStore.getBucketsForPlan(t),o=Qn()(e,e=>e.id===n.pivotValue);r=o?o.orderHint:null}const o=Hc.f.builder.withPropertyBag({id:"",title:e,planId:t,orderHint:qi.O.generateOrderHintBetween(null,r)}).withLocallyUniqueId().build();(await this.props.actionCreatorProviders.bucketActionCreator()).createBucket(o)},x=Ee.p.Strings.PlannerApp_AddBucket,P=Ee.p.Strings.PlannerApp_AddBucketPlaceHolder;break;case c.Yc.Progress:k=Lp(r.traceLogger,h,a,!0,this.taskAccessContext),b=!1,m.valueSetter=(e,t,r,n,o)=>this.progressBoardValueSetter(a,e,t,r,n,o);break;case c.Yc.Assignee:k=Fp(h,a,this.getContainerMembers(n.container.externalId),!1,this.props.appContextStore.getCurrentUserId(),this.taskCardCallbacks.getUser,this.renderAssigneeHeaderImage),b=!0,m.valueSetter=(e,t,r,n,o)=>this.assignedToBoardValueSetter(a,e,t,r,n,o),m.secondaryClassifier=this.completedTaskClassifier,m.secondaryValueSetter=this.completedSectionValueSetter;break;case c.Yc.Category:const e=this.props.planStore.getPlanDetails(t)?.categories??[];k=Np(h,t,e,!0,this.onUpdateCategoryTitle,this.renderCategoryHeaderImage),b=!0,m.valueSetter=this.categoryBoardValueSetter,m.secondaryClassifier=this.completedTaskClassifier,m.secondaryValueSetter=this.completedSectionValueSetter;break;case c.Yc.DueDate:k=Rp(h,!1),b=!0,m.valueSetter=this.dueDateBoardValueSetter,m.secondaryClassifier=this.completedTaskClassifier,m.secondaryValueSetter=this.completedSectionValueSetter;break;case c.Yc.Priority:k=Up(h,!1),b=!0,m.valueSetter=this.priorityBoardValueSetter,m.secondaryClassifier=this.completedTaskClassifier,m.secondaryValueSetter=this.completedSectionValueSetter;break;case c.Yc.None:case c.Yc.Plan:break;default:ji.f.unreachableCase(o,e=>{this.props.loggers.traceLogger.logTrace(508060123,B.k.Error,e)})}const f=t,v=this.props.appContextStore.getClientFlavor(),A=this.props.appContextStore.getCurrentTheme();return _.createElement(Na.Provider,{value:this.getViewContext()},_.createElement(wn.H,{className:this.getViewClassNames().taskBoardViewLandmark,role:"main"},_.createElement(Jc,{autoFocus:ae.B.clientType!==u.s.Webpart&&this.props.autoFocus&&!this.state.isFilterMenuVisible,key:f,displayMode:$i.Board,columnCreationEnabled:S,createColumnCallback:C,createColumnButtonText:x,createColumnPlaceholder:P,columnDefinitions:k,modifiedTaskIds:this.props.wywaStore.getModifiedTaskIds(),deleteColumnCallback:o===c.Yc.Bucket?this.onDeleteBucket:void 0,enableColumnMove:T,useSecondaryClassification:b,maxAssignees:ae.B.clientSettings.MaxTaskAssignees,callbacks:m,taskBoardCardCallbacks:this.taskBoardCallbacks,toggleAddTaskFormVisibility:this.onToggleAddTaskFormVisibility,onOpenAddTaskCardFromAddTaskButton:this.onOpenAddTaskCardFromAddTaskButton,onCloseAddTaskCard:this.onCloseAddTaskCard,showAddEntityCardCallback:this.showAddEntityCardCallback,showPlanTitleOnCard:!1,showCopyLinkToTask:this.props.showCopyLinkToTask,openTaskDetails:this.onOpenTaskDetailsEditor,fetchReferencePreviewForTask:this.fetchReferencePreviewForTask,currentUserId:this.props.appContextStore.getCurrentUserId(),disableColumnChanges:!y.canEdit,getTaskPermissions:this.getTaskPermissions,bucketVirtualization:e.BucketVirtualization,isSlimView:this.props.isSlimView,canAddGuests:this.props.permissionsStore.getUserPermissions().canAddGuests,enableAutoScrollOnDragItem:e.EnableImprovedDragScroll,theme:A,enableDragToScroll:!0,isTeamsSplitUI:this.props.appContextStore.getFlights().EnableTeamsSplitUI&&(v===d.g.TeamsPersonalApp||v===d.g.TeamsTab),fetchPermissionsWithTaskContext:this.fetchPermissionsWithTaskContext,styles:Dp(A,ae.B.headerlessMode)})))}renderWalkthrough(){const{viewPartitionKey:e,planStore:t}=this.props,r=t.getPlan(e);return null==r?null:_.createElement(Pp,{buckets:this.props.bucketStore.getBucketsForPlan(e)??[],tasks:this.props.taskStore.getTasksForPlan(e)??[],users:this.getContainerMembers(r.container.externalId),currentUser:this.props.userStore.getCurrentUser(),currentUserDetails:this.props.userStore.getCurrentUserDetails(),dispatcherEventManagement:this.props.dispatcherEventManagement,walkthroughStore:this.props.walkthroughStore,actionCreatorProviders:this.props.actionCreatorProviders,isFirstRunExperience:this.props.isFirstRunExperience,isSessionFromTaskLink:this.props.isSessionFromTaskLink,theme:this.props.appContextStore.getCurrentTheme()})}constructor(e,t){super(e,t),this.generateAddCardControlProvider=()=>(e,t,r,n,o)=>{const s=this.props.planStore.getPlan(this.props.viewPartitionKey);if(null==s)return null;const i=this.props.viewStore.getCurrentTaskGroupingState(this.taskAccessContext),a=s.container.externalId,l=this.canUserAddMembers(s),d=this.canUserAccessPlanViaSharedContainerOnly(s.id),h=l||d,g=this.props.bucketStore.getBucketsForPlan(this.props.viewPartitionKey)??[];return g.sort(Jt.k),_.createElement(gp,{autoFocus:!!this.state.isAddTaskCardOpenedFromAddTaskButton||this.props.appContextStore.getLastRouteChangeSource()!==p.jf.LeftNav&&ae.B.clientType!==u.s.Webpart&&!this.state.isFilterMenuVisible,createTask:n=>{this.onCreateTask(n,e,t,r)},planId:this.props.viewPartitionKey,toggleAddCard:o,closeOnKeyPress:!1,canAddUser:l,canAccessPlanViaSharedContainerOnly:d,buckets:g,defaultDueDate:void 0,hideSetAssignment:i===c.Yc.Assignee,hideSetBucket:i===c.Yc.Bucket,hideSetDueDate:i===c.Yc.DueDate,getUser:this.taskCardCallbacks.getUser,getUserPhoto:this.taskCardCallbacks.getUserPhoto,getUsersWithKeyword:h?this.taskCardCallbacks.getUsersWithKeyword:void 0,getAssigneePool:a?this.getContainerMembers.bind(this,a):()=>[],maxAssignees:ae.B.clientSettings.MaxTaskAssignees,showAssigneeLimitError:this.onShowAssigneeLimitError,currentUserId:this.props.appContextStore.getCurrentUserId(),onRenderPersona:this.onRenderPersona,alertUser:this.alertUser,onOpenAssignCallout:this.onOpenAssignCallout,enableSuggestedAssigneeUI:this.props.flights.EnableSuggestedAssignee,addUserToContainer:this.onAddUserToContainer,canAddGuests:this.props.permissionsStore.getUserPermissions().canAddGuests,theme:this.props.appContextStore.getCurrentTheme(),getAssigneeSuggestions:this.onGetAssigneeSuggestion,onAssignNonMember:this.onAssignTask,renderSmartTextField:this.props.renderSmartTextField})},this.renderCategoryHeaderImage=e=>_.createElement($t.l,{index:e,isCollapsed:!1,title:"",showBorder:!0,theme:this.props.appContextStore.getCurrentTheme()}),this.renderAssigneeHeaderImage=e=>null==e?null:_.createElement(Lt.f,{user:e,onLoad:this.onRenderPersona,containerId:`userContainer-assigneeHeader-${e.id}`},_.createElement(Ft.F,{id:e.id,imageUrl:this.props.userStore.getUserPhotoById(e.id)||void 0,size:Mt.WH.size32,hidePersonaDetails:!0})),this.onToggleAddTaskFormVisibility=e=>{this.state.columnAddTaskPivotValue===e||null==e?this.setState(e=>({...e,columnAddTaskPivotValue:null})):this.setState(t=>({...t,columnAddTaskPivotValue:e}))},this.onOpenAddTaskCardFromAddTaskButton=async()=>{(await this.props.actionCreatorProviders.notificationActionCreator()).enqueueHiddenToast("SharedComponents_AddNewTaskButtonExpanded"),this.setState({isAddTaskCardOpenedFromAddTaskButton:!0})},this.onCloseAddTaskCard=async()=>{(await this.props.actionCreatorProviders.notificationActionCreator()).enqueueHiddenToast("SharedComponents_AddNewTaskButtonCollapsed"),this.setState({isAddTaskCardOpenedFromAddTaskButton:!1})},this.onUpdateBucketTitle=async(e,t)=>{const r=e.setProperty("title",t);(await this.props.actionCreatorProviders.bucketActionCreator()).updateBucket(e,r)},this.onUpdateCategoryTitle=async(e,t,r)=>{const n=this.props.planStore.getPlanDetails(t);if(!n||n.categories[e]===r)return;const o=n.categories.slice();o[e]=r;const s=n.setProperty("categories",o);(await this.props.actionCreatorProviders.planActionCreator()).updatePlanDetails(n,s)},this.logUnbucketedTasksCount=e=>{this.loggedUnbucketedTasks||null==e[0]||null==e[0].dataEntities||(this.props.loggers.usageLogger.logData(this.name(),"Unbucketed Tasks Count",{planId:this.props.viewPartitionKey,numTasks:String(e[0].dataEntities.length)}),this.loggedUnbucketedTasks=!0)},this.showAddEntityCardCallback=e=>this.state.columnAddTaskPivotValue===e,this.setupCallbacks(),this.state={highlightField:c.JS.None,highlightValue:void 0,columnAddTaskPivotValue:this.generateColumnAddTaskPivotValue(),isCardChangingCompletedSection:!1,isFilterMenuVisible:!1,isAddTaskCardOpenedFromAddTaskButton:!1}}}},17961:(e,t,r)=>{var n=r(8760)();e.exports=n},22867:(e,t,r)=>{var n=r(26600),o=n&&new n;e.exports=o},27530:e=>{e.exports={}},48991:(e,t,r)=>{var n=r(80523),o=r(52990),s=r(2112),i=r(54052),a=r(22761),l=r(79360),c=Object.prototype.hasOwnProperty;function p(e){if(a(e)&&!i(e)&&!(e instanceof n)){if(e instanceof o)return e;if(c.call(e,"__wrapped__"))return l(e)}return new o(e)}p.prototype=s.prototype,p.prototype.constructor=p,e.exports=p},52990:(e,t,r)=>{var n=r(21817),o=r(2112);function s(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}s.prototype=n(o.prototype),s.prototype.constructor=s,e.exports=s},54555:(e,t,r)=>{"use strict";r.d(t,{G:()=>y});var n=r(65804),o=r(56851),s=r(65043),i=r(89379),a=r(17066),l=r(27480),c=r(40440),p=r(56420),d=r(15199),u=r(13706),h=r(20751),g="SearchBox",m={root:{height:"auto"},icon:{fontSize:"12px"}},C={iconName:"Clear"},k={ariaLabel:"Clear text"},b=(0,i.Z)(),T=s.forwardRef(function(e,t){var r=e.ariaLabel,n=e.className,i=e.defaultValue,T=void 0===i?"":i,S=e.disabled,P=e.underlined,x=e.styles,y=e.labelText,f=e.placeholder,v=void 0===f?y:f,A=e.theme,w=e.clearButtonProps,D=void 0===w?k:w,B=e.disableAnimation,E=void 0!==B&&B,I=e.showIcon,F=void 0!==I&&I,M=e.onClear,L=e.onBlur,N=e.onEscape,R=e.onSearch,U=e.onKeyDown,O=e.iconProps,H=e.role,V=e.onChange,G=e.onChanged,W=s.useState(!1),_=W[0],z=W[1],Z=s.useRef(),K=(0,c.k)(e.value,T,function(e,t){e&&e.timeStamp===Z.current||(Z.current=null===e||void 0===e?void 0:e.timeStamp,null===V||void 0===V||V(e,t),null===G||void 0===G||G(t))}),q=K[0],j=K[1],Q=String(q),Y=s.useRef(null),J=s.useRef(null),X=(0,p.a)(Y,t),$=(0,d.B)(g,e.id),ee=D.onClick,te=b(x,{theme:A,className:n,underlined:P,hasFocus:_,disabled:S,hasInput:Q.length>0,disableAnimation:E,showIcon:F}),re=(0,a.G1)(e,a.QQ,["className","placeholder","onFocus","onBlur","value","role"]),ne=s.useCallback(function(e){var t;null===M||void 0===M||M(e),e.defaultPrevented||(j(""),null===(t=J.current)||void 0===t||t.focus(),e.stopPropagation(),e.preventDefault())},[M,j]),oe=s.useCallback(function(e){null===ee||void 0===ee||ee(e),e.defaultPrevented||ne(e)},[ee,ne]),se=s.useCallback(function(e){z(!1),null===L||void 0===L||L(e)},[L]),ie=function(e){j(e.target.value,e)};return function(e,t,r){s.useImperativeHandle(e,function(){return{focus:function(){var e;return null===(e=t.current)||void 0===e?void 0:e.focus()},blur:function(){var e;return null===(e=t.current)||void 0===e?void 0:e.blur()},hasFocus:function(){return r}}},[t,r])}(e.componentRef,J,_),s.createElement("div",{role:H,ref:X,className:te.root,onFocusCapture:function(t){var r;z(!0),null===(r=e.onFocus)||void 0===r||r.call(e,t)}},s.createElement("div",{className:te.iconContainer,onClick:function(){J.current&&(J.current.focus(),J.current.selectionStart=J.current.selectionEnd=0)},"aria-hidden":!0},s.createElement(h.I,(0,o.__assign)({iconName:"Search"},O,{className:te.icon}))),s.createElement("input",(0,o.__assign)({},re,{id:$,className:te.field,placeholder:v,onChange:ie,onInput:ie,onBlur:se,onKeyDown:function(e){switch(e.which){case l.c.escape:null===N||void 0===N||N(e),Q&&!e.defaultPrevented&&ne(e);break;case l.c.enter:R&&(R(Q),e.preventDefault(),e.stopPropagation());break;default:null===U||void 0===U||U(e),e.defaultPrevented&&e.stopPropagation()}},value:Q,disabled:S,role:"searchbox","aria-label":r,ref:J})),Q.length>0&&s.createElement("div",{className:te.clearButton},s.createElement(u.K,(0,o.__assign)({onBlur:se,styles:m,iconProps:C},D,{onClick:oe}))))});T.displayName=g;var S=r(52195),P=r(50605),x={root:"ms-SearchBox",iconContainer:"ms-SearchBox-iconContainer",icon:"ms-SearchBox-icon",clearButton:"ms-SearchBox-clearButton",field:"ms-SearchBox-field"};var y=(0,n.I)(T,function(e){var t,r,n,o,s,i=e.theme,a=e.underlined,l=e.disabled,c=e.hasFocus,p=e.className,d=e.hasInput,u=e.disableAnimation,h=e.showIcon,g=i.palette,m=i.fonts,C=i.semanticColors,k=i.effects,b=(0,S.Km)(x,i),T={color:C.inputPlaceholderText,opacity:1},y=g.neutralSecondary,f=g.neutralPrimary,v=g.neutralLighter,A=g.neutralLighter,w=g.neutralLighter;return{root:[b.root,m.medium,S.S8,{color:C.inputText,backgroundColor:C.inputBackground,display:"flex",flexDirection:"row",flexWrap:"nowrap",alignItems:"stretch",padding:"1px 0 1px 4px",borderRadius:k.roundedCorner2,border:"1px solid ".concat(C.inputBorder),height:32,selectors:(t={},t[S.up]={borderColor:"WindowText"},t[":hover"]={borderColor:C.inputBorderHovered,selectors:(r={},r[S.up]={borderColor:"Highlight"},r)},t[":hover .".concat(b.iconContainer)]={color:C.inputIconHovered},t)},!c&&d&&{selectors:(n={},n[":hover .".concat(b.iconContainer)]={width:4},n[":hover .".concat(b.icon)]={opacity:0,pointerEvents:"none"},n)},c&&["is-active",{position:"relative"},(0,S.Sq)(C.inputFocusBorderAlt,a?0:k.roundedCorner2,a?"borderBottom":"border")],h&&[{selectors:(o={},o[":hover .".concat(b.iconContainer)]={width:32},o[":hover .".concat(b.icon)]={opacity:1},o)}],l&&["is-disabled",{borderColor:v,backgroundColor:w,pointerEvents:"none",cursor:"default",selectors:(s={},s[S.up]={borderColor:"GrayText"},s)}],a&&["is-underlined",{borderWidth:"0 0 1px 0",borderRadius:0,padding:"1px 0 1px 8px"}],a&&l&&{backgroundColor:"transparent"},d&&"can-clear",p],iconContainer:[b.iconContainer,{display:"flex",flexDirection:"column",justifyContent:"center",flexShrink:0,fontSize:16,width:32,textAlign:"center",color:C.inputIcon,cursor:"text"},c&&{width:4},l&&{color:C.inputIconDisabled},!u&&{transition:"width ".concat(S.cs.durationValue1)},h&&c&&{width:32}],icon:[b.icon,{opacity:1},c&&{opacity:0,pointerEvents:"none"},!u&&{transition:"opacity ".concat(S.cs.durationValue1," 0s")},h&&c&&{opacity:1}],clearButton:[b.clearButton,{display:"flex",flexDirection:"row",alignItems:"stretch",cursor:"pointer",flexBasis:"32px",flexShrink:0,padding:0,margin:"-1px 0px",selectors:{"&:hover .ms-Button":{backgroundColor:A},"&:hover .ms-Button-icon":{color:f},".ms-Button":{borderRadius:(0,P.jI)(i)?"1px 0 0 1px":"0 1px 1px 0"},".ms-Button-icon":{color:y}}}],field:[b.field,S.S8,(0,S.CX)(T),{backgroundColor:"transparent",border:"none",outline:"none",fontWeight:"inherit",fontFamily:"inherit",fontSize:"inherit",color:C.inputText,flex:"1 1 0px",minWidth:"0px",overflow:"hidden",textOverflow:"ellipsis",paddingBottom:.5,selectors:{"::-ms-clear":{display:"none"}}},l&&{color:C.disabledText}]}},void 0,{scope:"SearchBox"})},60911:(e,t,r)=>{var n=r(27530),o=Object.prototype.hasOwnProperty;e.exports=function(e){for(var t=e.name+"",r=n[t],s=o.call(n,t)?r.length:0;s--;){var i=r[s],a=i.func;if(null==a||a==e)return i.name}return t}},62264:(e,t,r)=>{"use strict";r.d(t,{g:()=>u});var n=r(65043),o=r(16112),s=r(66783),i=r(52195),a=r(66151),l=r(56415);const c="34px",p=(0,s.J9)(e=>({root:[(0,a.q0)("ellipsis"),(0,a.aS)(e),{height:c,cursor:"default","> button":[a.xK,(0,a.q0)("ellipsis"),{cursor:"pointer",width:"100%",":hover > span":{borderBottom:`2px solid ${l.z.ThemeSecondary}`}}],"> .primaryTextSectionTitle":{fontSize:"17px",fontWeight:i.BO.semibold,lineHeight:c,margin:"auto"}}]})),d=(0,s.J9)(e=>({root:(0,i.Zq)("primaryTextSection",e.root)}));class u extends o.${name(){return"HeaderTitle"}renderComponent(){const{titleText:e,onClickTitleButton:t,titleButtonAriaLabel:r}=this.props,o=this.getClassNames();return n.createElement("div",{className:o.root,title:e},null!=t?n.createElement("button",{className:"primaryTextSectionTitle",onClick:this.onTitleClick,"aria-label":r,id:"primaryTextSectionTitleId",ref:this.titleButtonRef},n.createElement("span",null,e)):n.createElement("h2",{className:"primaryTextSectionTitle",id:"primaryTextSectionTitleId"},e))}getClassNames(){return d(p(this.props.theme))}constructor(e,t){super(e,t),this.titleButtonRef=n.createRef(),this.onTitleClick=()=>{this.props.onClickTitleButton?.(this.titleButtonRef.current??void 0)}}}},77711:(e,t,r)=>{"use strict";r.d(t,{$:()=>i});var n=r(65043),o=r(16112),s=r(91900);class i extends o.${renderComponent(){const{children:e,planContainerId:t,onRender:r}=this.props;return t?n.createElement(s.n,{containerId:t,onLoad:r},e):n.createElement(n.Fragment,null,e)}constructor(e,t){super(e,t),this.name=()=>"PlanPhotoContainer"}}},79360:(e,t,r)=>{var n=r(80523),o=r(52990),s=r(91980);e.exports=function(e){if(e instanceof n)return e.clone();var t=new o(e.__wrapped__,e.__chain__);return t.__actions__=s(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}},80523:(e,t,r)=>{var n=r(21817),o=r(2112);function s(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}s.prototype=n(o.prototype),s.prototype.constructor=s,e.exports=s},88218:(e,t,r)=>{var n=r(22867),o=r(75713),s=n?function(e){return n.get(e)}:o;e.exports=s},90402:(e,t,r)=>{var n=r(80523),o=r(88218),s=r(60911),i=r(48991);e.exports=function(e){var t=s(e),r=i[t];if("function"!=typeof r||!(t in n.prototype))return!1;if(e===r)return!0;var a=o(r);return!!a&&e===a[0]}},91900:(e,t,r)=>{"use strict";r.d(t,{n:()=>p});var n=r(65043),o=r(16112),s=r(22317),i=r(66783),a=r(52195);const l=(0,i.J9)(()=>({anchor:{minHeight:"1px"}})),c=(0,i.J9)(e=>({anchor:(0,a.Zq)("virtualContainer-anchor",e.anchor)}));class p extends o.${componentDidUpdate(e,t){e.containerId!==this.props.containerId&&this.setState({hasLoaded:!1})}renderComponent(){return n.createElement(n.Fragment,null,this.renderIntersectionObs(),this.props.children)}renderIntersectionObs(){const e=this.getClassNames();return n.createElement("div",{className:"virtualContainer-wrapper"},n.createElement(s.pL,{onChange:this.handleInView,triggerOnce:!0},n.createElement("div",{className:e.anchor})))}getClassNames(){return c(l())}constructor(e,t){super(e,t),this.name=()=>"VirtualContainer",this.handleInView=e=>{!this.state.hasLoaded&&e&&(this.props.onLoad(),this.setState({hasLoaded:!0}))},this.state={hasLoaded:!1}}}},96426:(e,t,r)=>{"use strict";r.d(t,{p:()=>p});var n=r(56851),o=r(65043),s=r(11638),i=r(47507),a=r(64819),l=r(52195),c=(0,r(66783).J9)(function(e,t){return(0,l.TW)({root:[(0,l.gm)(e,{inset:1,highContrastStyle:{outlineOffset:"-4px",outline:"1px solid Window"},borderColor:"transparent"}),{height:24}]},t)}),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.styles,r=e.theme;return o.createElement(s.Y,(0,n.__assign)({},this.props,{styles:c(r,t),onRenderDescription:i.K}))},t=(0,n.__decorate)([(0,a.T)("MessageBarButton",["theme","styles"],!0)],t)}(o.Component)}}]);
//# sourceMappingURL=plantaskboardpage.cfda1e3e.chunk.js.map