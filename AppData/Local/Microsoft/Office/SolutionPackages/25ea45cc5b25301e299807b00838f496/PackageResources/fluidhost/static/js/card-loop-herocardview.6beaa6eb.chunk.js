"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[40044],{1720:(e,t,a)=>{a.d(t,{u:()=>s});var r=a(28144),n=a(81536),o=a(48612);const s=(e,t,a,s,i,c,l,d,u,p)=>m=>{switch((0,n.v)(e,t,s)){case"Full":"openUrl"===m.type&&(0,r.X)(a,m.value,i,c,u);break;case"None":case"Limited":(0,o.l)(a,e,s,c,l,d,p)}}},11472:(e,t,a)=>{a.r(t),a.d(t,{default:()=>E});var r=a(41851),n=a(94308),o=a(24720),s=a(64867),i=a(92964),c=a(47137),l=a(13569),d=a(1720),u=a(25055),p=a(25526),m=a(15357),f=a(65043),h=(0,m.m)({lookupString:function(e){return function(){return e}}},"LocalizationComponentsStringProvider");h.Provider;var g,k=a(17122),y=a(96633),w=a(27663);!function(e){e.buttons="hero-card-buttons",e.image="hero-card-image",e.title="hero-card-title",e.subtitle="hero-card-subtitle"}(g||(g={}));const E=()=>{const{cardData:e,isVerificationRequired:t,appStatus:a}=(0,r.f)(),{baseCardPerfMarker:m,logger:E}=(0,n.g)(),{cardChannelProvider:v,metaOSProvider:C,urlHandlerProvider:S}=(0,o.g)(),{setAppStatus:P,setMessageData:b,setVerificationStatus:I}=(0,s.t)(),{theme:U}=(0,i.d)(),N=f.useContext(h),A=e.payload,O=A.tap,T=A.text||"",M=A.images,V=M?.[0],x=(0,l.O)(U),L=(0,d.u)(a,t,e.appId,e.verificationStatus,S,C,P,b,E,N);return f.useEffect(()=>{m.end(!0)},[m]),f.useEffect(()=>{(0,c.V)(a,t,e,v,C,E,I,b,P,N)},[a,v,e,t,C,P,b,I,N]),f.createElement(k.B,{key:"heroCardView","data-tid":"hero-card",tokens:{childrenGap:10},className:x.cardStack,onClick:O&&(e=>{try{e.stopPropagation(),L(O)}catch(t){}})},f.createElement(u.F,{className:x.cardTitle,content:A.title,datatid:g.title}),f.createElement(u.F,{className:x.cardSubTitle,content:A.subtitle,datatid:g.subtitle}),V&&f.createElement(y.a,null,f.createElement(w._,{"data-tid":g.image,src:V.url,alt:V.alt,className:x.heroImage})),T&&f.createElement(u.F,{className:x.cardText,content:T}),f.createElement(p.w,{actions:A.buttons||[],buttonClassName:x.cardButton,containerClassName:x.buttonStack,onClick:L,payload:A,datatid:g.buttons}))}},25526:(e,t,a)=>{a.d(t,{w:()=>i});var r=a(50317),n=a(17122),o=a(65043),s=a(35427);const i=e=>{const{actions:t,buttonClassName:a,containerClassName:i,onClick:c,payload:l,datatid:d}=e,u=(0,r.u)(t)?t.slice(0,6):t;return o.createElement(n.B,{horizontal:!0,"data-tid":d,wrap:!0,tokens:{childrenGap:20},className:i},u.map((e,t)=>o.createElement(n.B.Item,{key:t},o.createElement(s.r,{key:t,className:a,action:e,onClick:c,payload:l}))))}},26901:(e,t,a)=>{a.d(t,{Al:()=>o,Iq:()=>i,Md:()=>d,WK:()=>s,gy:()=>c});var r=a(82381);const n="medium";function o(e,t){try{const a=/^\/l\/stage\/([^/]+)\/([^/]+)$/,r=e.pathname.match(a);if(3!==r?.length||!r[1]||r[1]!==t){const e=new Error("Invalid StageView deep link");throw e.name="StageViewDeepLinkParseError",e}const n=t,o=e.searchParams.get("context"),s=decodeURIComponent(o??"");return{appId:t,deepLinkAppId:n,stageInfo:JSON.parse(s)}}catch(a){const e=new Error((0,r.r)(a,"Unable to parse StageView deep link"));throw e.name="StageViewDeepLinkParseError",e}}function s(e,t){try{const a=/^\/l\/task\/([^/]+)$/,r=e.pathname.match(a);if(2!==r?.length||!r[1]||r[1]!==t){const e=new Error("Invalid TaskModule deep link");throw e.name="TaskModuleDeepLinkParseError",e}const o=e.searchParams.get("card");return{appId:t,taskInfo:{title:e.searchParams.get("title")??void 0,width:l(e.searchParams.get("width")??n),height:l(e.searchParams.get("width")??n),url:e.searchParams.get("url")??void 0,card:o?JSON.parse(o):void 0,fallbackUrl:e.searchParams.get("fallbackUrl")??void 0,completionBotId:e.searchParams.get("completionBotId")??void 0}}}catch(a){const e=new Error((0,r.r)(a,"Unable to parse TaskModule deep link"));throw e.name="TaskModuleDeepLinkParseError",e}}function i(e){return e.startsWith("https://teams.microsoft.com/l/stage")}function c(e){return e.startsWith("https://teams.microsoft.com/l/task")}function l(e){let t="medium";if("string"===typeof e)switch(e=e.toLowerCase()){case"small":case"medium":case"large":t=e;break;default:t=n}else"number"===typeof e&&(t=e);return t}function d(e,t){let a;if("StageView"===t?a=e?.stageInfo?.websiteUrl:"TaskModule"===t&&(a=e?.taskInfo?.fallbackUrl),!a){const e=new Error("Fallback url is empty");throw e.name="OpenUrlActionError",e}return new URL(a)}},28144:(e,t,a)=>{a.d(t,{X:()=>c});var r=a(82381),n=a(26901);const o="noopener noreferrer";function s(e){return"http:"===e.protocol.toLowerCase()||"https:"===e.protocol.toLowerCase()?(window.open(e,"_blank",o),Promise.resolve(!0)):Promise.resolve(!1)}var i=a(46675);function c(e,t,a,o,c,l,d){let u="OpenUrl";try{if(!t||!(0,i.A)(t)){const e=new Error("Action url is empty or invalid");throw e.name="OpenUrlActionError",e}let r=new URL(t);if((0,n.Iq)(t)){u="StageView",c.logEvent("info","OpenUrlActionClicked",{actionType:u});const t=l?.getCustomProperty("deepLinkPayload"),a=t??(0,n.Al)(r,e);if(!a){const e=new Error("Payload is empty");throw e.name="OpenUrlActionError",e}if("function"===typeof o.openStageView)return a.onDismiss=()=>{d?.refreshCard()},void o.openStageView?.(a);c.logEvent("error","MetaOSHandlerNotImplemented",{message:`Handler: openStageView; OpenUrlActionType: ${u}`}),r=(0,n.Md)(a,u)}else if((0,n.gy)(t)){u="TaskModule",c.logEvent("info","OpenUrlActionClicked",{actionType:u});const t=l?.getCustomProperty("deepLinkPayload"),a=t??(0,n.WK)(r,e);if(!a){const e=new Error("Payload is empty");throw e.name="OpenUrlActionError",e}if("function"===typeof o.launchTaskModule)return a.onDismiss=()=>{d?.refreshCard()},void o.launchTaskModule?.(a);c.logEvent("error","MetaOSHandlerNotImplemented",{message:`Handler: launchTaskModule; OpenUrlActionType: ${u}`}),r=(0,n.Md)(a,u)}c.logEvent("info","OpenUrlActionClicked",{actionType:u}),a?a.onClick(r).then(e=>{e||s(r)}):s(r)}catch(p){c.logEvent("error","OpenUrlActionExecutionError",{actionType:u,message:(0,r.r)(p,"Error while executing OpenUrl action")})}}},35427:(e,t,a)=>{a.d(t,{r:()=>o});var r=a(11638),n=a(65043);const o=n.memo(e=>{const t=n.useRef(!1),{action:a,className:o,onClick:s}=e,[i,c]=n.useState(!1),l=n.useCallback(e=>t.current&&c(e),[]);n.useEffect(()=>(t.current=!0,()=>{t.current=!1}),[]);const d=n.useCallback(e=>{try{e.stopPropagation(),l(!0),s(a)}catch{}finally{l(!1)}},[s,a,l]);return n.createElement(r.Y,{className:o,text:a.title,disabled:i,onClick:d})});o.displayName="CardButton"},46675:(e,t,a)=>{function r(e){try{const t=new URL(e);return[!!t.origin,"https:"===t.protocol].every(e=>e)}catch{return!1}}a.d(t,{A:()=>r})},47137:(e,t,a)=>{a.d(t,{V:()=>n});var r=a(48612);const n=async(e,t,a,n,o,s,i,c,l,d)=>{const{verificationStatus:u}=a;if(t&&"Unknown"===u&&"Installed"===e&&a.signature)try{if(!a.updateExtension)throw s.logEvent("error","NoUpdateExtensionFound",{message:"No update extension found while verifying cards"}),new Error("No update extension found");const t={cardId:a.cardId,metaOSAppId:a.appId,signature:a.signature,content:JSON.stringify(a.payload),verificationStatus:a.verificationStatus,extension:{updateExtendedProps:{type:"updateExtendedProps",data:{...a.updateExtension.data,contentType:a.cardType}}}};if("function"===typeof n.cardVerify){const s=function(e){return e.cards[0].verificationStatus}(await n.cardVerify(t));i(s),(0,r.l)(a.appId,e,s,o,l,c,d)}}catch{}}},50317:(e,t,a)=>{function r(e){return Array.isArray(e)&&e?.length>0}a.d(t,{u:()=>r})},81536:(e,t,a)=>{a.d(t,{v:()=>r});const r=(e,t,a)=>t?"Installed"===e&&"Success"===a?"Full":"None":"Full"}}]);
//# sourceMappingURL=card-loop-herocardview.6beaa6eb.chunk.js.map