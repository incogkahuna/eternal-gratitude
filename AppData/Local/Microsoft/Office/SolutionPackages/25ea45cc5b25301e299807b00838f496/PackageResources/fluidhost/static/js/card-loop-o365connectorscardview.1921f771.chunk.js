"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[82689],{1720:(e,t,a)=>{a.d(t,{u:()=>c});var n=a(28144),r=a(81536),o=a(48612);const c=(e,t,a,c,i,s,l,d,m,u)=>p=>{switch((0,r.v)(e,t,c)){case"Full":"openUrl"===p.type&&(0,n.X)(a,p.value,i,s,m);break;case"None":case"Limited":(0,o.l)(a,e,c,s,l,d,u)}}},26901:(e,t,a)=>{a.d(t,{Al:()=>o,Iq:()=>i,Md:()=>d,WK:()=>c,gy:()=>s});var n=a(82381);const r="medium";function o(e,t){try{const a=/^\/l\/stage\/([^/]+)\/([^/]+)$/,n=e.pathname.match(a);if(3!==n?.length||!n[1]||n[1]!==t){const e=new Error("Invalid StageView deep link");throw e.name="StageViewDeepLinkParseError",e}const r=t,o=e.searchParams.get("context"),c=decodeURIComponent(o??"");return{appId:t,deepLinkAppId:r,stageInfo:JSON.parse(c)}}catch(a){const e=new Error((0,n.r)(a,"Unable to parse StageView deep link"));throw e.name="StageViewDeepLinkParseError",e}}function c(e,t){try{const a=/^\/l\/task\/([^/]+)$/,n=e.pathname.match(a);if(2!==n?.length||!n[1]||n[1]!==t){const e=new Error("Invalid TaskModule deep link");throw e.name="TaskModuleDeepLinkParseError",e}const o=e.searchParams.get("card");return{appId:t,taskInfo:{title:e.searchParams.get("title")??void 0,width:l(e.searchParams.get("width")??r),height:l(e.searchParams.get("width")??r),url:e.searchParams.get("url")??void 0,card:o?JSON.parse(o):void 0,fallbackUrl:e.searchParams.get("fallbackUrl")??void 0,completionBotId:e.searchParams.get("completionBotId")??void 0}}}catch(a){const e=new Error((0,n.r)(a,"Unable to parse TaskModule deep link"));throw e.name="TaskModuleDeepLinkParseError",e}}function i(e){return e.startsWith("https://teams.microsoft.com/l/stage")}function s(e){return e.startsWith("https://teams.microsoft.com/l/task")}function l(e){let t="medium";if("string"===typeof e)switch(e=e.toLowerCase()){case"small":case"medium":case"large":t=e;break;default:t=r}else"number"===typeof e&&(t=e);return t}function d(e,t){let a;if("StageView"===t?a=e?.stageInfo?.websiteUrl:"TaskModule"===t&&(a=e?.taskInfo?.fallbackUrl),!a){const e=new Error("Fallback url is empty");throw e.name="OpenUrlActionError",e}return new URL(a)}},28144:(e,t,a)=>{a.d(t,{X:()=>s});var n=a(82381),r=a(26901);const o="noopener noreferrer";function c(e){return"http:"===e.protocol.toLowerCase()||"https:"===e.protocol.toLowerCase()?(window.open(e,"_blank",o),Promise.resolve(!0)):Promise.resolve(!1)}var i=a(46675);function s(e,t,a,o,s,l,d){let m="OpenUrl";try{if(!t||!(0,i.A)(t)){const e=new Error("Action url is empty or invalid");throw e.name="OpenUrlActionError",e}let n=new URL(t);if((0,r.Iq)(t)){m="StageView",s.logEvent("info","OpenUrlActionClicked",{actionType:m});const t=l?.getCustomProperty("deepLinkPayload"),a=t??(0,r.Al)(n,e);if(!a){const e=new Error("Payload is empty");throw e.name="OpenUrlActionError",e}if("function"===typeof o.openStageView)return a.onDismiss=()=>{d?.refreshCard()},void o.openStageView?.(a);s.logEvent("error","MetaOSHandlerNotImplemented",{message:`Handler: openStageView; OpenUrlActionType: ${m}`}),n=(0,r.Md)(a,m)}else if((0,r.gy)(t)){m="TaskModule",s.logEvent("info","OpenUrlActionClicked",{actionType:m});const t=l?.getCustomProperty("deepLinkPayload"),a=t??(0,r.WK)(n,e);if(!a){const e=new Error("Payload is empty");throw e.name="OpenUrlActionError",e}if("function"===typeof o.launchTaskModule)return a.onDismiss=()=>{d?.refreshCard()},void o.launchTaskModule?.(a);s.logEvent("error","MetaOSHandlerNotImplemented",{message:`Handler: launchTaskModule; OpenUrlActionType: ${m}`}),n=(0,r.Md)(a,m)}s.logEvent("info","OpenUrlActionClicked",{actionType:m}),a?a.onClick(n).then(e=>{e||c(n)}):c(n)}catch(u){s.logEvent("error","OpenUrlActionExecutionError",{actionType:m,message:(0,n.r)(u,"Error while executing OpenUrl action")})}}},35427:(e,t,a)=>{a.d(t,{r:()=>o});var n=a(11638),r=a(65043);const o=r.memo(e=>{const t=r.useRef(!1),{action:a,className:o,onClick:c}=e,[i,s]=r.useState(!1),l=r.useCallback(e=>t.current&&s(e),[]);r.useEffect(()=>(t.current=!0,()=>{t.current=!1}),[]);const d=r.useCallback(e=>{try{e.stopPropagation(),l(!0),c(a)}catch{}finally{l(!1)}},[c,a,l]);return r.createElement(n.Y,{className:o,text:a.title,disabled:i,onClick:d})});o.displayName="CardButton"},46675:(e,t,a)=>{function n(e){try{const t=new URL(e);return[!!t.origin,"https:"===t.protocol].every(e=>e)}catch{return!1}}a.d(t,{A:()=>n})},47137:(e,t,a)=>{a.d(t,{V:()=>r});var n=a(48612);const r=async(e,t,a,r,o,c,i,s,l,d)=>{const{verificationStatus:m}=a;if(t&&"Unknown"===m&&"Installed"===e&&a.signature)try{if(!a.updateExtension)throw c.logEvent("error","NoUpdateExtensionFound",{message:"No update extension found while verifying cards"}),new Error("No update extension found");const t={cardId:a.cardId,metaOSAppId:a.appId,signature:a.signature,content:JSON.stringify(a.payload),verificationStatus:a.verificationStatus,extension:{updateExtendedProps:{type:"updateExtendedProps",data:{...a.updateExtension.data,contentType:a.cardType}}}};if("function"===typeof r.cardVerify){const c=function(e){return e.cards[0].verificationStatus}(await r.cardVerify(t));i(c),(0,n.l)(a.appId,e,c,o,l,s,d)}}catch{}}},50317:(e,t,a)=>{function n(e){return Array.isArray(e)&&e?.length>0}a.d(t,{u:()=>n})},81536:(e,t,a)=>{a.d(t,{v:()=>n});const n=(e,t,a)=>t?"Installed"===e&&"Success"===a?"Full":"None":"Full"},85226:(e,t,a)=>{a.r(t),a.d(t,{default:()=>U});var n=a(41851),r=a(94308),o=a(24720),c=a(64867),i=a(92964),s=a(47137),l=a(50317),d=a(1720),m=a(13569),u=a(25055),p=a(15357),f=a(65043),y=(0,p.m)({lookupString:function(e){return function(){return e}}},"LocalizationComponentsStringProvider");y.Provider;var h,g=a(17122);!function(e){e.activityImage="o365-connector-card-activity-image",e.activityTitle="o365-connector-card-activity-title",e.buttons="o365-connector-card-buttons",e.facts="o365-connector-card-fact",e.images="o365-connector-card-images",e.sectionTitle="o365-connector-card-section-title",e.title="o365-connector-card-title"}(h||(h={}));var k,E,v=a(35427);!function(e){e.Android="android",e.Default="default",e.IOS="iOS",e.Windows="windows"}(k||(k={})),function(e){e.OpenUri="OpenUri",e.ViewAction="ViewAction",e.HttpPOST="HttpPOST",e.ActionCard="ActionCard"}(E||(E={}));const w=e=>{switch(e["@type"]){case E.OpenUri:return{type:"openUrl",title:e.name,value:C(e)};case E.ViewAction:return{type:"openUrl",title:e.name,value:e?.target[0]};case E.ActionCard:case E.HttpPOST:default:return{type:"unknown",title:e.name,value:""}}},C=e=>{const t=e?.targets?.find(e=>e.os===k.Default);return t?.uri||""},S=f.memo(e=>{let{actions:t,buttonClassName:a,containerClassName:n,onClick:r,payload:o}=e;return f.createElement(g.B,{horizontal:!0,wrap:!0,tokens:{childrenGap:20},className:n},t.map((e,t)=>f.createElement(g.B.Item,{key:t},f.createElement(v.r,{className:a,"data-tid":h.buttons,action:w(e),onClick:r,key:t,payload:o}))))});S.displayName="O365ConnectorCardButtonContainer";var N=a(27663),I=a(97972),T=a(10615);const A=f.memo(e=>{const{fact:t,factClassName:a,textClassName:n}=e;return f.createElement(g.B,{horizontal:!0,tokens:{childrenGap:10}},f.createElement(T.E,{"data-tid":h.facts,className:a},f.createElement(I.I,{content:t?.name})),f.createElement(u.F,{className:n,content:t?.value}))});A.displayName="O365ConnectorCardFactRenderer";const P=f.memo(e=>{const{section:t,styles:a,payload:n,onCardAction:r}=e,o=(0,l.u)(t.images)?t.images?.map((e,t)=>f.createElement(g.B.Item,{key:t},f.createElement("div",null,e.image?f.createElement(N._,{key:t.toString(),src:e.image,"data-tid":h.images,height:160,width:160}):null))):null,c=(0,l.u)(t.facts)?t.facts?.map((e,t)=>f.createElement(g.B.Item,{key:t},f.createElement(A,{factClassName:a.factName,textClassName:a.cardText,fact:e}))):null,i=t.potentialAction&&f.createElement(S,{actions:t.potentialAction,buttonClassName:a.cardButton,containerClassName:a.buttonStack,onClick:r,payload:n});return f.createElement(g.B,{tokens:{childrenGap:10}},f.createElement(u.F,{className:a.cardSubTitle,content:e?.section?.title,datatid:h.sectionTitle}),f.createElement(O,{...e}),f.createElement(u.F,{className:a.cardText,content:e?.section?.text}),c,f.createElement(g.B,{horizontal:!0,tokens:{childrenGap:10},wrap:!0},o),i)});P.displayName="O365ConnectorCardSectionRenderer";const O=e=>{const{section:t,styles:a}=e;return f.createElement(g.B,{horizontal:!0,tokens:{childrenGap:10}},t.activityImage?f.createElement(N._,{key:t.activityImage,src:t.activityImage,"data-tid":h.activityImage,height:52,width:52}):null,f.createElement(g.B,{tokens:{childrenGap:10}},f.createElement(u.F,{className:a.cardSubTitle,content:t?.activityTitle,datatid:h.activityTitle}),f.createElement(u.F,{className:a.cardSubTitle,content:t.activitySubtitle}),f.createElement(u.F,{className:a.cardText,content:t.activityText})))},U=()=>{const{cardData:e,isVerificationRequired:t,appStatus:a}=(0,n.f)(),{baseCardPerfMarker:p,logger:k}=(0,r.g)(),{cardChannelProvider:E,metaOSProvider:v,urlHandlerProvider:w}=(0,o.g)(),{setAppStatus:C,setMessageData:N,setVerificationStatus:I}=(0,c.t)(),{theme:T}=(0,i.d)(),A=f.useContext(y),O=e.payload,U=O.potentialAction,b=(0,d.u)(a,t,e.appId,e.verificationStatus,w,v,C,N,k,A),x=(0,m.O)(T),V=(0,l.u)(O.sections)?O.sections.map((e,t)=>f.createElement(g.B.Item,{key:t},f.createElement(P,{section:e,styles:x,onCardAction:b,payload:O}))):null;return f.useEffect(()=>{p.end(!0)},[p]),f.useEffect(()=>{(0,s.V)(a,t,e,E,v,k,I,N,C,A)},[a,E,e,t,v,C,N,I,A]),f.createElement(g.B,{tokens:{childrenGap:10},className:x.cardStack},f.createElement(u.F,{className:x.cardTitle,content:O?.title,datatid:h.title}),f.createElement(u.F,{className:x.cardText,content:O?.text}),V,U&&f.createElement(S,{actions:U,buttonClassName:x.cardButton,containerClassName:x.buttonStack,onClick:b,payload:O}))}}}]);
//# sourceMappingURL=card-loop-o365connectorscardview.1921f771.chunk.js.map