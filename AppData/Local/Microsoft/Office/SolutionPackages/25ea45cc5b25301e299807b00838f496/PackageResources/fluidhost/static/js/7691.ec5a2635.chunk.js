(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[7691],{219:(e,t,n)=>{"use strict";var r;n.d(t,{x:()=>r}),function(e){e[e.Pending=1]="Pending",e[e.Failed=2]="Failed",e[e.Cancelled=3]="Cancelled",e[e.Succeeded=4]="Succeeded"}(r||(r={}))},514:(e,t,n)=>{"use strict";n.d(t,{g:()=>s});var r=n(32512);class s extends r.v{constructor(e,t,n,r){super(s.actionType,t,n,r),this.bucket=e}}s.actionType="PLW_CREATE_BUCKET_FAILED"},937:(e,t,n)=>{"use strict";n.d(t,{F:()=>l});var r=n(55491),s=n.n(r),i=n(16112),a=n(51171),o=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),l=function(e){function t(t,n){var r=e.call(this,t,n)||this;if(r.shouldRender=!1,!r.props.dispatcherEventManagement)throw new a.L("dispatcherEventManagement");return r.storesToSubscribeTo=[],s()(r.getAllStoresInProps(),function(e){r.addStoreToSubscribeTo(e)}),r.actionDispatchCompleteCallback=r.onActionDispatchComplete.bind(r),r}return o(t,e),t.prototype.componentDidMount=function(){s()(this.storesToSubscribeTo,function(e){e.store.subscribeToStore(e.callback)}),this.props.dispatcherEventManagement.addOnActionDispatchComplete(this.actionDispatchCompleteCallback)},t.prototype.componentWillUnmount=function(){s()(this.storesToSubscribeTo,function(e){e.store.unsubscribeFromStore(e.callback)}),this.props.dispatcherEventManagement.removeOnActionDispatchComplete(this.actionDispatchCompleteCallback)},t.prototype.logRender=function(e){},t.prototype.storeDidUpdate=function(){},t.prototype.addStoreToSubscribeTo=function(e){this.storesToSubscribeTo.push({store:e,callback:this.onStoreUpdate.bind(this)})},t.prototype.onStoreUpdate=function(){this.shouldRender=!0},t.prototype.onActionDispatchComplete=function(e){var t=this;this.shouldRender&&(this.forceUpdate(e&&e.length>0?function(){return t.logRender(e)}:void 0),this.storeDidUpdate(),this.shouldRender=!1)},t.prototype.getAllStoresInProps=function(){var e=[];return s()(this.props,function(t){t&&t.subscribeToStore&&t.unsubscribeFromStore&&e.push(t)}),e},t}(i.$)},1207:(e,t,n)=>{"use strict";n.d(t,{z:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{planId:this.planId,count:String(this.buckets.length)}}constructor(e,t){super(s.actionType),this.planId=e,this.buckets=t}}s.actionType="PLW_GET_BUCKETSFORPLAN_SUCCEEDED"},1623:(e,t,n)=>{"use strict";n.d(t,{t:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{localId:this.bucket.id}}constructor(e){super(s.actionType),this.bucket=e}}s.actionType="PLW_CREATE_BUCKET"},3756:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var r=n(75992);class s extends r.r{constructor(e){super(s.actionType),this.entityId=e}}s.actionType="AUGLOOP_FETCH_IMG_RECS"},4398:(e,t,n)=>{"use strict";n.d(t,{D:()=>r});var r=n(65043).createContext(void 0)},4576:(e,t,n)=>{"use strict";n.d(t,{o:()=>s});var r=n(75992);class s extends r.r{constructor(e){super(s.actionType),this.tenantFeedbackSettings=e}}s.actionType="PLW_GET_TENANTFEEDBACKSETTINGS_SUCCEEDED"},4757:(e,t,n)=>{var r=n(56552);e.exports=function(){return r.Date.now()}},5062:(e,t,n)=>{"use strict";n.d(t,{f:()=>h});var r=n(75992),s=n(28673),i=n.n(s),a=n(42907),o=n.n(a),l=n(56707),c=n.n(l),d=n(91733),u=n.n(d);class h extends r.r{loggingData(){const e=i()(this.containerPlanMapping).length,t=u()(this.containerPlanMapping,e=>e?.length??0),n=o()(c()(this.containerPlanMapping),"length");return{containerCount:String(e),planCountByContainer:JSON.stringify(t),totalPlanCount:String(n),containerType:String(this.containerType)}}constructor(e,t){super(h.actionType),this.containerPlanMapping=e,this.containerType=t}}h.actionType="PLW_RESOLVECONTAINERSTOPLANS_SUCCEEDED"},5583:(e,t,n)=>{"use strict";function r(e,t){return e.filter(e=>e.keyboardShortcutDescription.type===t)}n.d(t,{O:()=>r})},6189:(e,t,n)=>{"use strict";n.d(t,{y:()=>m});var r=n(98990),s=n.n(r),i=n(84048),a=n.n(i),o=n(37535),l=n(33411),c=n.n(l),d=n(50204),u=n(44430),h=n(91246);class p{build(){return new m(this)}fromUnifiedGroupDetailsResource(e){const t=c()(e.Owners,e=>d.K.builder.fromUserResource(e).build()),n='"value":"';let r;if(null!=e.OneDriveUrl){const t=e.OneDriveUrl.indexOf(n);r=0===t?e.OneDriveUrl:e.OneDriveUrl.substring(t+9,e.OneDriveUrl.length-2)}return this.withPropertyBag({creationOptions:e.CreationOptions,currentUserRelationToGroup:e.CurrentUserRelationToGroup,endpoints:e.Endpoints,id:e.Id,owners:t,oneDriveUrl:r})}withPropertyBag(e){return this.currentUserRelationToGroup=e.currentUserRelationToGroup,this.creationOptions=e.creationOptions||[],this.owners=e.owners||[],this.endpoints=e.endpoints||[],this.id=e.id,this.oneDriveUrl=e.oneDriveUrl||null,this}withUserRelationToGroup(e){return this.currentUserRelationToGroup=e,this}withLocallyUniqueId(){return this.id=h.o.generate(),this}constructor(){this.currentUserRelationToGroup=u.N.NonMember,this.id=""}}var g=n(33268);class m{static get builder(){return new p}toWebSerializable(){const e=this.owners.map(e=>e.toWebSerializable());return{CreationOptions:this.creationOptions,CurrentUserRelationToGroup:this.currentUserRelationToGroup,Endpoints:this.endpoints,Id:this.id,Owners:e,OneDriveUrl:this.oneDriveUrl}}isFullyProvisioned(){return this.isSharePointProvisioned()}isSharePointProvisioned(){return!!this.oneDriveUrl}isYammerGroup(){return a()(this.creationOptions,"YammerProvisioning")}getSharepointDomainUrl(){const e=this.oneDriveUrl;return e?"https://"+g.wS.extractHostname(e):null}getWorkloadUrl(e){switch(o.P[e]){case o.P.Yammer:if(this.isYammerGroup()){const e=s()(this.endpoints,e=>"Yammer"===e.ServiceName);return e?.ServiceEndpointUri??""}return"";case o.P.Documents:return this.oneDriveUrl;case o.P.Calendar:case o.P.Conversations:case o.P.Notebook:case o.P.People:default:return null}}constructor(e){this.creationOptions=e.creationOptions,this.currentUserRelationToGroup=e.currentUserRelationToGroup,this.endpoints=e.endpoints,this.id=e.id,this.owners=e.owners,this.oneDriveUrl=e.oneDriveUrl}}},6618:(e,t,n)=>{"use strict";n.d(t,{e:()=>h});var r=n(65804),s=n(56851),i=n(65043),a=n(89379),o=n(17066),l=n(28553),c=(0,a.Z)(),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.message,n=e.styles,r=e.as,a=void 0===r?"div":r,d=e.className,u=c(n,{className:d});return i.createElement(a,(0,s.__assign)({role:"status",className:u.root},(0,o.G1)(this.props,o.JM,["className"])),i.createElement(l.P,null,i.createElement("div",{className:u.screenReaderText},t)))},t.defaultProps={"aria-live":"polite"},t}(i.Component),u=n(52195),h=(0,r.I)(d,function(e){return{root:e.className,screenReaderText:u.dX}},void 0,{scope:"Announced"})},7304:(e,t,n)=>{"use strict";n.d(t,{h:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{sessionId:this.session.id,groupId:this.session.groupId,itemId:String(this.session.itemId),itemSize:String(this.session.itemSize),bytesSent:String(this.session.bytesSent),expirationTime:null!=this.session.expirationDateTime?this.session.expirationDateTime.toString():"null",hasWebUrl:String(!!this.session.webUrl),nextExpectedRanges:this.session.nextExpectedRanges?.toString()??""}}constructor(e){super(s.actionType),this.session=e}}s.actionType="PLW_UPLOAD_BYTES_TO_SESSION_SUCCEEDED"},7691:(e,t,n)=>{"use strict";n.r(t),n.d(t,{LoopPlanner:()=>ic,loopExport:()=>ac});var r=n(40656),s=n(75368),i=n(15834),a=n(33788),o=n(83125),l=n(65317),c=n(52059);var d=n(42455),u=n(96623),h=n(70579),p=n(65043),g=n(97950),m=n(21161),f=n(15507),y=n(77508),v=n(43746),k=n(81622);var T=n(52668),S=n(79889),b=n.n(S),I=n(91834),C=n(78332);class D{}D.LimitSecondsSinceLastTaskFetch=120,D.TaskAnimationDelay=5e3;var E=n(7811),P=n(42870),w=n(10912),x=n(98656),F=n(40488),A=n(57433),L=n(44388),_=n(70149);const U=()=>(0,_.L)(()=>Promise.all([n.e(26922),n.e(46441),n.e(57365),n.e(7670),n.e(76115),n.e(22514),n.e(50008),n.e(17323),n.e(93818)]).then(n.bind(n,16841))).then(e=>({default:e.PlanTaskBoardPage})),O=(0,p.lazy)(U);var B=n(64226),M=n(937);const N=()=>(0,_.L)(()=>n.e(83069).then(n.bind(n,56921))).then(e=>({default:e.NotificationBar})),R=(0,p.lazy)(N);var G=n(4648);class W extends M.F{name(){return"NotificationBarContainer"}renderComponent(){const e=this.props.notificationStore.getNotificationId();return p.createElement("div",{className:(0,G.A)("errorBar",{hidden:null==e})},null!=e&&p.createElement(p.Suspense,{fallback:p.createElement(p.Fragment,null)},p.createElement(R,{onDismiss:e===B.fc.GoneOffline?void 0:this.onDismiss,messageType:this.props.notificationStore.getMessageType(),notificationId:e,statusCode:this.props.notificationStore.getStatusCode(),statusText:this.props.notificationStore.getStatusText(),entityId:this.props.notificationStore.getEntityId(),stringParams:this.props.notificationStore.getStringParams(),correlationId:this.props.notificationStore.getCorrelationId(),timeStamp:this.props.notificationStore.getTimeStamp(),getBucket:this.props.bucketStore.getBucket.bind(this.props.bucketStore),getPlan:this.props.planStore.getPlan.bind(this.props.planStore),getTask:this.props.taskStore.getTask.bind(this.props.taskStore),getUser:this.props.userStore.getUserById.bind(this.props.userStore),theme:this.props.appContextStore.getCurrentTheme()})))}constructor(e,t){super(e,t),this.onDismiss=async()=>{const e=await this.props.notificationActionCreatorProvider();e.clearNotifications.bind(e)()},this.state={}}}const z=()=>(0,_.L)(()=>Promise.resolve().then(n.bind(n,75559))).then(e=>({default:e.ComponentErrorPage})),j=(0,p.lazy)(z),K=()=>(0,_.L)(()=>Promise.all([n.e(26922),n.e(46441),n.e(34167),n.e(57365),n.e(76115),n.e(22514),n.e(40135),n.e(50008),n.e(7509),n.e(24901)]).then(n.bind(n,8007))).then(e=>({default:e.LoopAppDialog})),H=(0,p.lazy)(K);var V=n(17920),Z=n(38752),q=n(96481),Y=n(8122),$=n(75992),J=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),X=function(e){function t(n,r){var s=e.call(this,t.type)||this;return s.pageName=n,s.appStartTime=r,s}return J(t,e),t.prototype.loggingData=function(){return{pageName:this.pageName}},t.type="APP_START",t}($.r),Q=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ee=function(e){function t(n,r,s,i,a){var o=e.call(this,t.type)||this;return o.dataFetchStartTime=n,o.dataFetchEndTime=r,o.exportName=s,o.metaTag=i,o.extraData=a,o}return Q(t,e),t.prototype.getExportName=function(){return this.exportName},t.type="PAGE_READY",t}($.r),te=n(51171),ne=function(){function e(e){this.dispatcher=e}return e.prototype.appStart=function(e,t){if(null==e)throw new te.L("pageName");if(null==t)throw new te.L("appStartTime");this.dispatcher.dispatchAction(new X(e,t))},e.prototype.pageReady=function(e,t,n,r,s){if(null==e)throw new te.L("dataFetchStart");if(null==t)throw new te.L("dataFetchEnd");this.dispatcher.dispatchAction(new ee(e,t,n,r,s))},e}(),re=n(95952),se=n(91181),ie=n(87952),ae=n(82025),oe=n(18647),le=n(32934),ce=n(51857),de=n(60653),ue=n(71964),he=n(26260),pe=n(97498),ge=n(29274),me=n(74427),fe=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ye=function(e){function t(n){var r=e.call(this,t.type)||this;return r.id=n,r}return fe(t,e),t.prototype.loggingData=function(){return{id:this.id}},t.type="CLEAR_TRANSACTION",t}($.r),ve=n(57860),ke=n(47204),Te=n(219),Se=n(15806),be=n(33745),Ie=n(42105),Ce=n.n(Ie),De=n(17478),Ee=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Pe=function(e){function t(t,n,r){void 0===t&&(t=32);var s=e.call(this)||this;return s.keyQueue=[],s.sizeLimit=Math.max(t,2),s.shouldLockItem=n,s.onRemoved=r,s}return Ee(t,e),t.prototype.set=function(t,n){e.prototype.set.call(this,t,n),this.maintainSize(t),this.shouldLockItem&&this.shouldLockItem(e.prototype.get.call(this,t))?this.lockItem(t):this.enqueueNewKey(t)},t.prototype.remove=function(t){Ce()(this.keyQueue,function(e){return e===t}),e.prototype.remove.call(this,t)},t.prototype.clear=function(){e.prototype.clear.call(this),this.keyQueue=[]},t.prototype.lockItem=function(e){Ce()(this.keyQueue,function(t){return t===e})},t.prototype.maintainSize=function(t){for(;this.count()>this.sizeLimit;){var n=this.keyQueue[0];if(!n||t===n)throw new Error("No suitable removal was found");var r=this.internalStorage[n];e.prototype.remove.call(this,n),this.onRemoved&&this.onRemoved(r)}},t.prototype.enqueueNewKey=function(e){Ce()(this.keyQueue,function(t){return t===e}),this.keyQueue.push(e)},t}(De.$),we=n(38921),xe=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Fe=function(e){function t(t){void 0===t&&(t=100);var n=e.call(this)||this;return n.transactionContainer=new Se.j(new Pe(t,n.shouldLockItem)),n}return xe(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"TransactionStore"},enumerable:!1,configurable:!0}),t.prototype.getTransaction=function(e){return this.transactionContainer.getItem(e)},t.prototype.handleAction=function(e){switch(e.type){case ge.S.type:this.handleBeginTransaction(e),this.publishStoreChangedEvent();break;case me.D.type:this.handleCancelTransaction(e.id,e.additionalData),this.publishStoreChangedEvent();break;case ye.type:this.handleClearTransaction(e),this.publishStoreChangedEvent();break;case ve.M.type:this.handleTransactionSucceeded(e),this.publishStoreChangedEvent();break;case ke.Y.type:this.handleTransactionFailed(e),this.publishStoreChangedEvent()}},t.prototype.handleBeginTransaction=function(e){var t={name:e.name,id:e.id,additionalData:e.additionalData,status:Te.x.Pending};this.transactionContainer.setItem(t.id,t)},t.prototype.handleCancelTransaction=function(e,t){var n=this.transactionContainer.getItem(e);if(!n)throw new we.v("TransactionStore: Tried to mark a transaction with id "+e+" as cancelled but the transaction did not exist.\n                Did you forget to fire the BeginTransactionAction?");n.additionalData=t,n.status=Te.x.Cancelled,this.transactionContainer.setItem(n.id,n),this.transactionContainer.updateModifiedDate(n.id)},t.prototype.handleClearTransaction=function(e){this.transactionContainer.removeItem(e.id)},t.prototype.handleTransactionSucceeded=function(e){var t=this.transactionContainer.getItem(e.id);if(!t)throw new we.v("TransactionStore: Tried to mark a transaction with id "+e.id+" as succeeded but the transaction did not exist.\n                Did you forget to fire the BeginTransactionAction?");t.additionalData=e.additionalData,t.status=Te.x.Succeeded,this.transactionContainer.setItem(t.id,t),this.transactionContainer.updateModifiedDate(t.id)},t.prototype.handleTransactionFailed=function(e){var t=this.transactionContainer.getItem(e.id);if(!t)throw new we.v("TransactionStore: Tried to mark a transaction with id "+e.id+" as failed but the transaction did not exist.\n                Did you forget to fire the BeginTransactionAction?");t.error=e.errorMessage,t.additionalData=e.additionalData,t.status=Te.x.Failed,this.transactionContainer.setItem(t.id,t),this.transactionContainer.updateModifiedDate(t.id)},t.prototype.shouldLockItem=function(e){if(!e||!e.item)return!1;switch(e.item.status){case Te.x.Pending:return!0;case Te.x.Cancelled:case Te.x.Failed:case Te.x.Succeeded:return!1}return!1},t}(be.z),Ae=n(13736),Le=n(67578),_e=n(13374),Ue=n(23881),Oe=n(70515),Be=n(12396),Me=n(31415),Ne=n(95783),Re=n(19853),Ge=n.n(Re),We=n(96891),ze=n(45078);class je extends be.z{get name(){return"PlannerDiffSyncStore"}getDiffSyncToken(){return this.diffSyncToken}getLastDiffSyncFeed(){return this.lastDiffSyncFeed}getLastDiffSyncTimestamp(){return this.lastDiffSyncFeedFetchTimestamp}isDiffSyncDisabled(){return this.isDisabled}isDiffSyncRequestScheduled(){return this.isRequestScheduled}getNumDiffsInLastFetch(){return this.numDiffsInLastFetch}isInErrorState(){return this.inErrorState}handleAction(e){let t=!1;switch(e.type){case Ae.K.actionType:t=this.handleDiffSyncFetchScheduledAction(e);break;case Le.s.actionType:t=this.handleDiffSyncFeedFetchFailure(e);break;case _e.Y.actionType:t=this.handleDiffSyncFeedFetchSuccess(e);break;case Ue.h.actionType:t=this.handleDiffSyncTokenFetchSuccess(e);break;case Oe.r.actionType:t=this.handleDisableDiffSync(e);break;case Be.q.actionType:t=this.handleEnableDiffSync(e);break;case Me.c.actionType:t=this.resetDiffSyncBackoff();break;default:return}t&&this.publishStoreChangedEvent()}handleDiffSyncFetchScheduledAction(e){return!this.isRequestScheduled&&(this.isRequestScheduled=!0,!0)}handleDiffSyncFeedFetchFailure(e){let t=!1;this.isRequestScheduled&&(this.isRequestScheduled=!1,t=!0);(null==this.lastDiffSyncFeedFetchTimestamp?null:this.lastDiffSyncFeedFetchTimestamp.valueOf())!==(null==e.timestamp?null:e.timestamp.valueOf())&&(this.lastDiffSyncFeedFetchTimestamp=e.timestamp,t=!0);const n=e.response?.status;return n!==ze.oT.SyncPointUnknown&&n!==Ne.t3.Gone||(this.loggers.usageLogger.logData(We.M.DiffSyncStore,We.M.DiffSyncCookieExpiredError),null!=this.diffSyncToken&&(this.diffSyncToken=null,t=!0)),n===Ne.t3.TooManyRequests||n===Ne.t3.BadGateway||n===Ne.t3.ServiceUnavailable||n===Ne.t3.GatewayTimeout?this.inErrorState||(this.inErrorState=!0,t=!0):this.inErrorState&&(this.inErrorState=!1,t=!0),t}handleDiffSyncFeedFetchSuccess(e){let t=!1;this.inErrorState&&(this.inErrorState=!1,t=!0),this.isRequestScheduled&&(this.isRequestScheduled=!1,t=!0);return(null==this.lastDiffSyncFeedFetchTimestamp?null:this.lastDiffSyncFeedFetchTimestamp.valueOf())!==(null==e.timestamp?null:e.timestamp.valueOf())&&(this.lastDiffSyncFeedFetchTimestamp=e.timestamp,t=!0),this.diffSyncToken!==e.diffSyncFeed.nextToken&&(this.diffSyncToken=e.diffSyncFeed.nextToken,t=!0),this.numDiffsInLastFetch!==e.diffSyncFeed.updates.length&&(this.numDiffsInLastFetch=e.diffSyncFeed.updates.length,t=!0),Ge()(this.lastDiffSyncFeed,e.diffSyncFeed)||(this.lastDiffSyncFeed=e.diffSyncFeed,t=!0),t}handleDiffSyncTokenFetchSuccess(e){return this.diffSyncToken!==e.diffSyncToken&&(this.diffSyncToken=e.diffSyncToken,!0)}handleDisableDiffSync(e){return!this.isDisabled&&(this.isDisabled=!0,!0)}handleEnableDiffSync(e){return!!this.isDisabled&&(this.isDisabled=!1,!0)}resetDiffSyncBackoff(){return this.numDiffsInLastFetch=-1,!0}constructor(e,t){super(),this.loggers=t,this.diffSyncToken=e,this.isDisabled=!1,this.isRequestScheduled=!1,this.lastDiffSyncFeed=null,this.lastDiffSyncFeedFetchTimestamp=null,this.numDiffsInLastFetch=-1,this.inErrorState=!1}}var Ke=n(98899),He=n(2423),Ve=n(58355);class Ze extends $.r{constructor(e){super(Ze.actionType),this.canConvert=e}}Ze.actionType="PLW_GET_PLAN_CONVERSION_PERMISSIONS_SUCCEEDED";var qe=n(93593),Ye=n(93407),$e=n(14070),Je=n(54205),Xe=n(71794),Qe=n(62076),et=n(99244);class tt extends $.r{loggingData(){return{planId:this.plan.id,bucketCount:String(this.buckets.length),taskCount:String(this.tasks.length),isLastPage:String(this.isLastPage)}}constructor(e,t,n,r){super(tt.actionType),this.plan=e,this.buckets=t,this.tasks=n,this.tasksContinuationToken=r,this.isLastPage=null==r}}tt.actionType="PLW_PREFETCH_PLAN_DATA_SUCCEEDED";var nt=n(75411),rt=n(51522),st=n(81576),it=n(69632),at=n(43068),ot=n(45498),lt=n(87337),ct=n(94600),dt=n(27921),ut=n(32185),ht=n(77992),pt=n(5062);class gt extends $.r{loggingData(){return{roadmap:JSON.stringify(this.userFeatureEntitlements.roadmap),modernProject:JSON.stringify(this.userFeatureEntitlements.premiumPlan),projectOnline:JSON.stringify(this.userFeatureEntitlements.projectOnline),projectOperations:JSON.stringify(this.userFeatureEntitlements.projectOperations)}}constructor(e){super(gt.actionType),this.userFeatureEntitlements=e}}gt.actionType="PLW_GET_USER_FEATURE_ENTITLEMENTS_SUCCEEDED";var mt,ft,yt=n(60878),vt=n(15434),kt=n(54456),Tt=n(73360),St=n(65818),bt=n(75886),It=n(11079);!function(e){e.title="Title",e.percentComplete="PercentComplete",e.assignment="Assignment",e.dueDate="DueDate",e.priority="Priority",e.startDate="StartDate"}(mt||(mt={})),function(e){e.ToComplete="ToComplete",e.ToNotComplete="ToNotComplete"}(ft||(ft={}));function Ct(e,t){for(const n of e)if(n.type===t)return 0===n.Modifiers.length;return!1}class Dt{build(){return new Et(this)}fromWebResource(e){return this.withPropertyBag({canComment:!0,canCopy:!0,canEdit:!0,canMove:!0,canUploadFiles:!0,canAssign:!Ct(e.rules,mt.assignment),canDelete:!0,checklistPermissions:bt.j.DisableNone,canEditDescription:!0,canEditTitle:!Ct(e.rules,mt.title),canUpdateDueDate:!Ct(e.rules,mt.dueDate),canUpdatePriority:!Ct(e.rules,mt.priority),canUpdatePriorityToUrgent:!Ct(e.rules,mt.priority),canUpdateProgress:!Ct(e.rules,mt.percentComplete),canUpdateAppliedLabels:!0,canUpdateBucket:!0,canUpdateStartDate:!Ct(e.rules,mt.startDate),canUpdateRecurrence:!0,canUpdatePreviewType:!0,attachmentPermissions:It.I.DisableNone})}fromGraphResource(e){return this.fromWebResource(e)}getDiffDataFromWebResource(e,t){throw new Error("Method not implemented.")}getDiffDataFromGraphResource(e,t){throw new Error("Method not implemented.")}withPropertyBag(e){return this.canComment=null!=e.canComment?e.canComment:this.canComment,this.canCopy=null!=e.canCopy?e.canCopy:this.canCopy,this.canEdit=null!=e.canEdit?e.canEdit:this.canEdit,this.canMove=null!=e.canMove?e.canMove:this.canMove,this.canUploadFiles=null!=e.canUploadFiles?e.canUploadFiles:this.canUploadFiles,this.canAssign=null!=e.canAssign?e.canAssign:this.canAssign,this.canDelete=null!=e.canDelete?e.canDelete:this.canDelete,this.checklistPermissions=null!=e.checklistPermissions?e.checklistPermissions:this.checklistPermissions,this.canEditDescription=null!=e.canEditDescription?e.canEditDescription:this.canEditDescription,this.canEditTitle=null!=e.canEditTitle?e.canEditTitle:this.canEditTitle,this.canUpdateDueDate=null!=e.canUpdateDueDate?e.canUpdateDueDate:this.canUpdateDueDate,this.canUpdatePriority=null!=e.canUpdatePriority?e.canUpdatePriority:this.canUpdatePriority,this.canUpdatePriorityToUrgent=null!=e.canUpdatePriorityToUrgent?e.canUpdatePriorityToUrgent:this.canUpdatePriorityToUrgent,this.canUpdateProgress=e.canUpdateProgress??this.canUpdateProgress,this.canUpdateAppliedLabels=e.canUpdateAppliedLabels??this.canUpdateAppliedLabels,this.canUpdateBucket=e.canUpdateBucket??this.canUpdateBucket,this.canUpdateStartDate=e.canUpdateStartDate??this.canUpdateStartDate,this.canUpdateRecurrence=e.canUpdateRecurrence??this.canUpdateRecurrence,this.canUpdatePreviewType=e.canUpdatePreviewType??this.canUpdatePreviewType,this.attachmentPermissions=null!=e.attachmentPermissions?e.attachmentPermissions:this.attachmentPermissions,this}constructor(){this.canComment=!0,this.canCopy=!0,this.canEdit=!0,this.canMove=!0,this.canUploadFiles=!0,this.canAssign=!0,this.canDelete=!0,this.checklistPermissions=bt.j.DisableNone,this.canEditDescription=!0,this.canEditTitle=!0,this.canUpdateDueDate=!0,this.canUpdatePriority=!0,this.canUpdatePriorityToUrgent=!0,this.canUpdateProgress=!0,this.canUpdateAppliedLabels=!0,this.canUpdateBucket=!0,this.canUpdateStartDate=!0,this.canUpdateRecurrence=!0,this.canUpdatePreviewType=!0,this.attachmentPermissions=It.I.DisableNone}}class Et{static get builder(){return new Dt}constructor(e){this.canComment=e.canComment,this.canCopy=e.canCopy,this.canEdit=e.canEdit,this.canMove=e.canMove,this.canUploadFiles=e.canUploadFiles,this.canAssign=e.canAssign,this.canDelete=e.canDelete,this.checklistPermissions=e.checklistPermissions,this.canEditDescription=e.canEditDescription,this.canEditTitle=e.canEditTitle,this.canUpdateDueDate=e.canUpdateDueDate,this.canUpdatePriority=e.canUpdatePriority,this.canUpdatePriorityToUrgent=e.canUpdatePriorityToUrgent,this.canUpdateProgress=e.canUpdateProgress,this.canUpdateAppliedLabels=e.canUpdateAppliedLabels,this.canUpdateBucket=e.canUpdateBucket,this.canUpdateStartDate=e.canUpdateStartDate,this.canUpdateRecurrence=e.canUpdateRecurrence,this.canUpdatePreviewType=e.canUpdatePreviewType,this.attachmentPermissions=e.attachmentPermissions}}var Pt=n(44430),wt=n(75252),xt=n(76241),Ft=n(67188),At=n(55491),Lt=n.n(At),_t=n(54320),Ut=n.n(_t),Ot=n(86178),Bt=n.n(Ot);var Mt=n(74844),Nt=n(38989);class Rt extends be.z{get name(){return"PlannerPermissionsStore"}getTaskPermissions(e,t){if(this.currentUsageMode===C.BH.Readonly||t?.isArchived)return this.buildAndMemoizeTaskPermissionsObject(!1,!1,bt.j.DisableAll,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,It.I.DisableAll);if(e.isProjectTask())return this.getProjectTaskPermissions(e);if(e.isAppPoweredTask())return this.getAppPoweredTaskPermissions();if(null==t)return this.buildAndMemoizeTaskPermissionsObject(!0,!0,bt.j.DisableNone,!0,!0,!0,!0,!0,!0,!0,!0,!1,!1,!0,!0,!0,!0,!0,!0,It.I.DisableNone);if(e.planId!==t.id)throw new Error("ArgumentError: task planId does not match the given plan's id");let n=!0,r=!0,s=bt.j.DisableNone,i=!0,a=!0,o=!0,l=!0,c=!0,d=!0,u=!0,h=!0,p=!0,g=!0,m=!0,f=!0,y=!0,v=!0,k=!0,T=!0,S=It.I.DisableNone;const b=this.canAccessPlan(t),I=null!=e.assignments[Z.B.currentUserId];b||(n=I,r=!1,s=I?bt.j.DisableNone:bt.j.DisableAll,i=I,a=I,o=I,l=I,c=I,d=I,u=I,m=I,f=I,y=I,v=I,k=I,T=I,S=I?It.I.DisableNone:It.I.DisableAll);const D=e.creationSource?.publication;if(null!=D){h=!1,p=!1,k=!1;const e=this.containerPermissions[D.id]?.[t.container.externalId]?.containerPermissions;if(null!=e)n=n&&e.canAssign,r=r&&e.canDelete,s|=e.checklistPermissions,i=i&&e.canEditDescription,a=a&&e.canEditTitle,o=o&&e.canUpdateDueDate,l=l&&e.canUpdatePriority,c=c&&e.canUpdatePriorityToUrgent,m=m&&e.canUpdateProgress,f=f&&e.canUpdateAppliedLabels,y=y&&e.canUpdateBucket,v=v&&e.canUpdateStartDate,k=k&&e.canUpdateRecurrence,T=T&&e.canUpdatePreviewType,S|=e.attachmentPermissions;else{r=!1;s=Z.B.isUnoContext?bt.j.DisableDelete|bt.j.DisableEditTitle|bt.j.DisablePromote|bt.j.DisableReorder|bt.j.DisableCreate:s}}const E=this.getContainerCapabilities(t.container.containerType);return d=d&&E.canEdit,g=g&&E.canUploadFiles,p=p&&E.canMoveTasks,u=u&&E.canComment,h=h&&E.canCopyTasks,this.userPolicies&wt.x.CannotDeleteTasksNotCreatedBySelf&&(r=r&&e.createdBy===Z.B.currentUserId),this.buildAndMemoizeTaskPermissionsObject(n,r,s,i,a,o,l,c,d,u,h,p,g,m,f,y,v,k,T,S)}getDefaultPlanPermissions(){return this.currentUsageMode===C.BH.Readonly?this.buildAndMemoizePlanPermissionsObject(!1,!1,!1,!1,!1,!1,!1,!1):this.buildAndMemoizePlanPermissionsObject()}getPlanPermissions(e){if(this.currentUsageMode===C.BH.Readonly||e.isArchived)return this.buildAndMemoizePlanPermissionsObject(!1,!1,!1,!1,!1,!1,!1,!1);if(e.isProjectPlan())return this.buildAndMemoizePlanPermissionsObject(!1,!1,!1,!1,!0,!1,!1,!1);const t=this.getContainerCapabilities(e.container.containerType),n=this.canAccessPlan(e);return this.buildAndMemoizePlanPermissionsObject(t.canAcceptTasks&&n,t.canAddTasks&&n,t.canCopyPlan&&n,t.canDelete&&n,t.canEdit&&n,!0,!0,t.canEdit&&n)}getBucketPermissions(e){return this.currentUsageMode===C.BH.Readonly?this.buildAndMemoizeBucketPermissionsObject(!1,!1):this.buildAndMemoizeBucketPermissionsObject(!0,!0)}getUserPermissions(){return this.currentUsageMode===C.BH.Readonly?this.buildAndMemoizeUserPermissionsObject(!1,!1,!1):this.buildAndMemoizeUserPermissionsObject(!0,this.canAddGuests(),this.canCreateGroup())}getDefaultContainerPermissions(e){let t=!0;return e?.containerType===St.K.Roster&&(t=this.containerIdToIsMemberMapping[e.externalId]??!0),this.buildAndMemoizeContainerPermissionsObject(!1,!1,t)}getContainerPermissions(e){let t=!0,n=!0;if(e.containerType===St.K.Roster&&(t=this.containerIdToIsMemberMapping[e.externalId]??!0,n=this.containerIdToIsMemberMapping[e.externalId]??!0),this.currentUsageMode===C.BH.Readonly)return this.buildAndMemoizeContainerPermissionsObject(!1,!1,t,!1);let r=!1,s=!1;if(this.getContainerCapabilities(e.containerType).canModifyMembership)if(e.containerType===St.K.Group){const t=e;null!=t.unifiedGroupDetails&&(s=t.unifiedGroupDetails.currentUserRelationToGroup===Pt.N.Owner,r=Z.B.isGuestUser||t.unifiedGroup.visibility!==xt.X.Public?t.unifiedGroupDetails.currentUserRelationToGroup===Pt.N.Owner:t.unifiedGroupDetails.currentUserRelationToGroup===Pt.N.Owner||t.unifiedGroupDetails.currentUserRelationToGroup===Pt.N.Member)}else e.containerType===St.K.Roster?(r=this.containerIdToIsMemberMapping[e.externalId]??!0,s=this.containerIdToIsMemberMapping[e.externalId]??!0):e.containerType===St.K.User?(r=!0,s=!1):(r=!0,s=!0);else e.containerType===St.K.User&&(r=!0,s=!1);return this.buildAndMemoizeContainerPermissionsObject(r,s,t,n)}getCurrentUsageMode(){return this.currentUsageMode}getExpiredPermissionsInfo(){const e=Bt()(),t=[];for(const n in this.containerPermissions)for(const r in this.containerPermissions[n]){this.containerPermissions[n][r].expiry.isBefore(e)&&t.push({containerId:r,publicationId:n})}return t}getExpiredTaskPermissionsInfo(){const e=Bt()(),t=[];for(const n in this.memoizedTaskPermissions){this.memoizedTaskPermissions[n].expiry.isBefore(e)&&t.push(n)}return t}getPremiumPlanFeatureEntitlements(){return this.userPremiumPlanFeatureEntitlements}arePermissionsMissingOrExpired(e,t){const n=Bt()(),r=this.containerPermissions[t]?.[e]?.expiry;return null==r||r.isBefore(n)}areTaskPermissionsMissingOrExpired(e){const t=Bt()(),n=this.memoizedTaskPermissions[e]?.expiry;return null==n||n.isBefore(t)}canAccessICalendar(e){if(e.containerType===St.K.User)return!0;if(e.containerType===St.K.Group){const t=e;if(t?.unifiedGroupDetails?.currentUserRelationToGroup===Pt.N.Owner)return!0}return!1}handleAction(e){let t=!1;switch(e.type){case nt.x.actionType:t=this.handleSetUsageModeAction(e);break;case ot.T.actionType:const n=e;t=this.handleGroupPlanResolutionSuccess(n);break;case pt.f.actionType:t=this.handleContainerPlanResolutionSuccess(e);break;case qe.Y.actionType:const r=e;t=this.handleDeletePlan(r.planId);break;case Ke.l.actionType:const s=e;t=this.handleDeletePlan(s.planId);break;case lt.s.actionType:t=this.handleDeleteUnifiedGroupSucceededAction(e);break;case Ye.A.actionType:const i=e;t=this.handleMultiplePlanFetch(i.plans);break;case $e.N.actionType:const a=e;t=this.handleMultiplePlanFetch(a.plans);break;case Je.O.actionType:const o=e;t=this.ensureMappingInStore(o.planEntitySet.plan.container.externalId,o.planEntitySet.id);break;case Xe.$.actionType:const l=e;t=this.ensureMappingInStore(l.planEntitySet.plan.container.externalId,l.planEntitySet.id);break;case tt.actionType:const c=e;t=this.ensureMappingInStore(c.plan.plan.container.externalId,c.plan.id);break;case Qe.V.actionType:const d=e;t=this.removeMappingInStore(d.planEntitySet.id);break;case et.t.actionType:const u=e;t=this.updateMappingInStore(u.planEntitySet.plan.container.externalId,u.localId,u.planEntitySet.id);break;case ct.P.actionType:t=this.handleGetUnifiedGroupDetailsSucceededAction(e);break;case ut.w.actionType:t=this.handleJoinUnifiedGroupSucceededAction(e);break;case ht.v.actionType:t=this.handleLeaveUnifiedGroupSucceededAction(e);break;case rt.D.actionType:t=this.handleToggleFlight(e);break;case at.Q.actionType:t=this.handleGetTenantGroupSettings(e);break;case dt.M.actionType:t=this.handleCheckCurrentUserToGroupsMembershipsSucceededAction(e);break;case Ve.D.actionType:t=this.handleBatchGetContainerPermissionsSucceededAction(e);break;case He.z.actionType:this.userPolicies=e.userDetails.userPolicies;break;case it.f.actionType:t=this.handleBatchGetTaskPermissionsSucceededAction(e);break;case st.R.actionType:t=this.handleBatchGetTaskPermissionsFailedAction(e);break;case yt.L.actionType:t=this.handleGetContainerSucceededAction(e);break;case vt.x.actionType:t=this.handleGetContainerFailedAction(e);break;case kt.v.actionType:t=this.handleGetDriveItemSucceededAction(e);break;case Tt.N.actionType:t=this.handleGetDriveItemFailedAction(e);break;case gt.actionType:t=this.handleGetUserFeatureEntitlementsSucceededAction(e);break;case Ze.actionType:t=this.handleGetPlanConversionPermissionsSucceededAction(e);break;default:return}t&&this.publishStoreChangedEvent()}canAccessPlanViaHostContainer(e){const t=this.planToContainerMapping[e.id];return null==t||(this.containerIdToIsMemberMapping[t]??!0)}canConvertBasicToPremiumPlan(){return this.canConvertBasicPlanToPremiumPlan}hasWriteAccessToPremiumPlan(){const e=this.userPremiumPlanFeatureEntitlements?.premiumPlan;return e?.accessType===Ft.HX.readWrite}canAccessPlan(e){const t=this.canAccessPlanViaHostContainer(e),n=this.canAccessPlanViaSharedContainers(e.sharedWithContainers);return t||n}handleBatchGetTaskPermissionsFailedAction(e){let t=!1;return e.rejectedEquivalenceSetIds.forEach(e=>{if(!this.memoizedTaskPermissions[e]){const n={equivalenceSetId:e,taskPermissions:Et.builder.withPropertyBag({canComment:!1,canCopy:!1,canEdit:!1,canMove:!1,canUploadFiles:!1,canAssign:!1,canDelete:!1,checklistPermissions:bt.j.DisableAll,canEditDescription:!1,canEditTitle:!1,canUpdateDueDate:!1,canUpdatePriority:!1,canUpdatePriorityToUrgent:!1,canUpdateProgress:!0,canUpdateAppliedLabels:!1,canUpdateBucket:!1,canUpdateStartDate:!1,canUpdateRecurrence:!1,canUpdatePreviewType:!1,attachmentPermissions:It.I.DisableAll}).build(),expiry:Bt()(0)};this.storeTaskPermissionsInfo(n),t=!0}}),t}handleBatchGetTaskPermissionsSucceededAction(e){return e.taskPermissionsSets.forEach(e=>{this.storeTaskPermissionsInfo(e)}),!0}storeTaskPermissionsInfo(e){return this.memoizedTaskPermissions[e.equivalenceSetId]=e,!0}handleBatchGetContainerPermissionsSucceededAction(e){return e.permissionsSets.forEach(e=>{this.storeContainerPermissionsInfo(e)}),!0}storeContainerPermissionsInfo(e){return null==this.containerPermissions[e.publicationId]&&(this.containerPermissions[e.publicationId]={}),this.containerPermissions[e.publicationId][e.containerId]=e,!0}handleCheckCurrentUserToGroupsMembershipsSucceededAction(e){const{requestGroupIds:t,returnedGroupIds:n}=e;return null!=this.tenantGroupSettings&&t.indexOf(this.tenantGroupSettings.GroupIdForMembershipChecking)>-1&&(this.tenantGroupSettings.handleCheckMembershipResponse(n.indexOf(this.tenantGroupSettings.GroupIdForMembershipChecking)>-1),!0)}handleSetUsageModeAction(e){return this.currentUsageMode!==e.usageMode&&(this.currentUsageMode=e.usageMode,!0)}handleGroupPlanResolutionSuccess(e){let t=!1;for(const n in e.groupPlanMapping){const r=e.groupPlanMapping[n]?.map(e=>e.id);r&&!Ut()(r)&&r.forEach(e=>{const r=this.planToContainerMapping[e];null!=r&&n===r||(this.planToContainerMapping[e]=n,t=!0)})}return t}handleContainerPlanResolutionSuccess(e){let t=!1;for(const n in e.containerPlanMapping){const r=e.containerPlanMapping[n]?.map(e=>e.id);r&&!Ut()(r)&&r.forEach(e=>{const r=this.planToContainerMapping[e];null!=r&&n===r||(this.planToContainerMapping[e]=n,t=!0)})}return t}handleDeletePlan(e){return!!this.planToContainerMapping[e]&&(delete this.planToContainerMapping[e],!0)}handleMultiplePlanFetch(e){let t=!1;return Lt()(e,e=>{t=this.ensureMappingInStore(e.plan.container.externalId,e.id)||t}),t}ensureMappingInStore(e,t){let n=!1;return this.planToContainerMapping[t]!==e&&(this.planToContainerMapping[t]=e,n=!0),n}removeMappingInStore(e){return delete this.planToContainerMapping[e],!0}updateMappingInStore(e,t,n){return delete this.planToContainerMapping[t],this.planToContainerMapping[n]=e,!0}handleDeleteUnifiedGroupSucceededAction(e){let t=!1;for(const n in this.planToContainerMapping)this.planToContainerMapping[n]===e.container.externalId&&(delete this.planToContainerMapping[n],t=!0);return t}handleGetUnifiedGroupDetailsSucceededAction(e){const t=e.unifiedGroupDetails;if(null==t)return!1;const n=this.containerIdToIsMemberMapping[t.id],r=t.currentUserRelationToGroup!==Pt.N.NonMember;return(null==n||n!==r)&&(this.containerIdToIsMemberMapping[t.id]=r,!0)}handleJoinUnifiedGroupSucceededAction(e){const t=this.containerIdToIsMemberMapping[e.containerId];return(null==t||!1===t)&&(this.containerIdToIsMemberMapping[e.containerId]=!0,!0)}handleLeaveUnifiedGroupSucceededAction(e){const t=this.containerIdToIsMemberMapping[e.containerId];return(null==t||!0===t)&&(this.containerIdToIsMemberMapping[e.containerId]=!1,!0)}handleToggleFlight(e){return null!=this.flights[e.flightKey]&&(this.flights[e.flightKey]=!this.flights[e.flightKey],!0)}handleGetTenantGroupSettings(e){return this.tenantGroupSettings=e.tenantGroupSettings,!0}handleGetContainerSucceededAction(e){const t=e.container;if(null==t)return!1;const n=this.containerIdToIsMemberMapping[t.externalId];return(null==n||!1===n)&&(this.containerIdToIsMemberMapping[t.externalId]=!0,!0)}handleGetContainerFailedAction(e){if(e.response?.status===Ne.t3.Forbidden){const t=this.containerIdToIsMemberMapping[e.containerId];if(null==t||!0===t)return this.containerIdToIsMemberMapping[e.containerId]=!1,!0}return!1}handleGetDriveItemSucceededAction(e){return!0!==this.driveItemVroomIdToHasAccessMapping[e.vroomId]&&(this.driveItemVroomIdToHasAccessMapping[e.vroomId]=!0,!0)}handleGetDriveItemFailedAction(e){if(e.response?.status===Ne.t3.Forbidden||e.response?.status===Ne.t3.NotFound){if(!1!==this.driveItemVroomIdToHasAccessMapping[e.vroomId])return this.driveItemVroomIdToHasAccessMapping[e.vroomId]=!1,!0}return!1}handleGetUserFeatureEntitlementsSucceededAction(e){return this.userPremiumPlanFeatureEntitlements=e.userFeatureEntitlements,!0}handleGetPlanConversionPermissionsSucceededAction(e){return this.canConvertBasicPlanToPremiumPlan!==e.canConvert&&(this.canConvertBasicPlanToPremiumPlan=e.canConvert,!0)}canAddGuests(){return null!=this.tenantGroupSettings&&(this.tenantGroupSettings.allowToAddGuests&&!Z.B.isGuestUser)}canCreateGroup(){return!!Z.B.isTenantAdmin||(null!=this.tenantGroupSettings?Z.B.isGuestUser?this.tenantGroupSettings.allowGuestsToBeGroupOwner&&this.tenantGroupSettings.CanCurrentUserCreateGroup:this.tenantGroupSettings.CanCurrentUserCreateGroup:!Z.B.isGuestUser)}getProjectTaskPermissions(e){const t=e.planId,n=this.memoizedTaskPermissions[t]?.taskPermissions;return this.buildAndMemoizeTaskPermissionsObject(n?.canAssign||!1,!1,bt.j.DisableAll,!1,n?.canEditTitle||!1,n?.canUpdateDueDate||!1,n?.canUpdatePriority||!1,n?.canUpdatePriorityToUrgent||!1,!0,!1,!1,!1,!1,n?.canUpdateProgress,!1,!1,n?.canUpdateStartDate||!1,!1,!1,It.I.DisableAll)}getAppPoweredTaskPermissions(){return this.buildAndMemoizeTaskPermissionsObject(!1,!1,bt.j.DisableAll,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,It.I.DisableAll)}canAccessPlanViaSharedContainers(e){return null!=e&&0!==e.length&&e.some(e=>e.containerType===St.K.DriveItem&&this.canAccessDriveItem(e.externalId))}canAccessDriveItem(e){return null!=e&&0!==e.length&&(this.driveItemVroomIdToHasAccessMapping[e]??!0)}buildAndMemoizeUserPermissionsObject(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=((e?1:0)|(t?1:0)<<1|(n?1:0)<<2).toString();if(null!=Rt.memoizedUserPermissions[r])return Rt.memoizedUserPermissions[r];const s={canEdit:e,canAddGuests:t,canCreateGroup:n};return Rt.memoizedUserPermissions[r]=s,s}buildAndMemoizeContainerPermissionsObject(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const s=((e?1:0)|(t?1:0)<<1|(n?1:0)<<2|(r?1:0)<<3).toString();if(null!=Rt.memoizedContainerPermissions[s])return Rt.memoizedContainerPermissions[s];const i={canAddMembers:e,canRemoveMembers:t,canViewMembers:n,canChangeSensitivity:r};return Rt.memoizedContainerPermissions[s]=i,i}buildAndMemoizePlanPermissionsObject(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],a=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],o=!(arguments.length>7&&void 0!==arguments[7])||arguments[7];const l=`${((e?1:0)|(t?1:0)<<1|(n?1:0)<<2|(r?1:0)<<3|(s?1:0)<<4|(i?1:0)<<5|(a?1:0)<<6|(o?1:0)<<7).toString()}`;if(null!=Rt.memoizedPlanPermissions[l])return Rt.memoizedPlanPermissions[l];const c={canAcceptTasks:e,canAddTasks:t,canCopy:n,canDelete:r,canEdit:s,canFavorite:i,canUpdateLabelDefinition:a,canAddBuckets:o};return Rt.memoizedPlanPermissions[l]=c,c}buildAndMemoizeBucketPermissionsObject(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=((e?1:0)|(t?1:0)<<1).toString();if(null!=Rt.memoizedBucketPermissions[n])return Rt.memoizedBucketPermissions[n];const r={canEditTitle:e,canUpdateOrderHint:t};return Rt.memoizedBucketPermissions[n]=r,r}buildAndMemoizeTaskPermissionsObject(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:bt.j.DisableNone,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],a=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],o=!(arguments.length>7&&void 0!==arguments[7])||arguments[7],l=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],c=!(arguments.length>9&&void 0!==arguments[9])||arguments[9],d=!(arguments.length>10&&void 0!==arguments[10])||arguments[10],u=!(arguments.length>11&&void 0!==arguments[11])||arguments[11],h=!(arguments.length>12&&void 0!==arguments[12])||arguments[12],p=!(arguments.length>13&&void 0!==arguments[13])||arguments[13],g=!(arguments.length>14&&void 0!==arguments[14])||arguments[14],m=!(arguments.length>15&&void 0!==arguments[15])||arguments[15],f=!(arguments.length>16&&void 0!==arguments[16])||arguments[16],y=!(arguments.length>17&&void 0!==arguments[17])||arguments[17],v=!(arguments.length>18&&void 0!==arguments[18])||arguments[18],k=arguments.length>19&&void 0!==arguments[19]?arguments[19]:It.I.DisableNone;const T=((e?1:0)|(t?1:0)<<1|(r?1:0)<<2|(s?1:0)<<3|(i?1:0)<<4|(a?1:0)<<5|(o?1:0)<<6|(l?1:0)<<7|(c?1:0)<<8|(d?1:0)<<9|(u?1:0)<<10|(h?1:0)<<11|(p?1:0)<<12|(g?1:0)<<13|(m?1:0)<<14|(f?1:0)<<15|(y?1:0)<<16|(v?1:0)<<17).toString()+n.toString()+k.toString();if(null!=this.memoizedTaskPermissions[T])return this.memoizedTaskPermissions[T].taskPermissions;const S={canAssign:e,canDelete:t,checklistPermissions:n,canEditDescription:r,canEditTitle:s,canUpdateDueDate:i,canUpdatePriority:a,canUpdatePriorityToUrgent:o,canEdit:l,canComment:c,canCopy:d,canMove:u,canUploadFiles:h,canUpdateProgress:p,canUpdateAppliedLabels:g,canUpdateBucket:m,canUpdateStartDate:f,canUpdateRecurrence:y,canUpdatePreviewType:v,attachmentPermissions:k};return this.memoizedTaskPermissions[T]={equivalenceSetId:"default",taskPermissions:S,expiry:Bt()([2500])},S}getContainerCapabilities(e){try{return function(e){switch(e){case St.K.Group:return{canAcceptTasks:!0,canAddTasks:!0,canComment:!0,canCopyPlan:!0,canCopyTasks:!0,canDelete:!0,canEdit:!0,canMoveTasks:!0,canUploadFiles:!0,canModifyMembership:!0};case St.K.Roster:return{canAcceptTasks:!0,canAddTasks:!0,canComment:!1,canCopyPlan:!0,canCopyTasks:!0,canDelete:!0,canEdit:!0,canMoveTasks:!0,canUploadFiles:!1,canModifyMembership:!0};case St.K.Project:return{canAcceptTasks:!1,canAddTasks:!1,canComment:!1,canCopyPlan:!1,canCopyTasks:!1,canDelete:!1,canEdit:!1,canMoveTasks:!1,canUploadFiles:!1,canModifyMembership:!1};case St.K.User:return{canAcceptTasks:!0,canAddTasks:!0,canComment:!1,canCopyPlan:!1,canCopyTasks:!0,canDelete:!0,canEdit:!0,canMoveTasks:!0,canUploadFiles:!1,canModifyMembership:!1};case St.K.DriveItem:case St.K.TeamsConversation:case St.K.PlannerUser:case St.K.ToDo:case St.K.Invalid:return{canAcceptTasks:!1,canAddTasks:!1,canComment:!1,canCopyPlan:!1,canCopyTasks:!1,canDelete:!1,canEdit:!1,canMoveTasks:!1,canUploadFiles:!1,canModifyMembership:!1};default:throw new Error(`Unknown container type: ${e}`)}}(e)}catch(t){return this.loggers.traceLogger.logTrace(507639452,Mt.k.Error,`getContainerCapabilities failed [Error=${Nt.f.getMessage(t)}]`),{canAcceptTasks:!1,canAddTasks:!1,canComment:!1,canCopyPlan:!1,canCopyTasks:!1,canDelete:!1,canEdit:!1,canMoveTasks:!1,canUploadFiles:!1,canModifyMembership:!1}}}constructor(e,t){super(),this.loggers=t,this.currentUsageMode=C.BH.Full,this.planToContainerMapping={},this.containerIdToIsMemberMapping={},this.driveItemVroomIdToHasAccessMapping={},this.containerPermissions={},this.memoizedTaskPermissions={},this.canConvertBasicPlanToPremiumPlan=!1,this.canAccessCopilot=()=>{const e=this.userPremiumPlanFeatureEntitlements?.premiumPlan;return e?.licenseLevel===Ft.eN.professional||e?.licenseLevel===Ft.eN.premium},this.userPolicies=e,this.flights={...Z.B.clientSettings.Flights}}}Rt.memoizedPlanPermissions={},Rt.memoizedUserPermissions={},Rt.memoizedContainerPermissions={},Rt.memoizedBucketPermissions={};var Gt=n(8149),Wt=n(70375),zt=n(59640),jt=n(93940),Kt=n(3756),Ht=n(48545),Vt=n(30263);class Zt extends be.z{get name(){return"PlannerIntelligenceStore"}getFileSuggestions(e){return this.fileSuggestions.getItem(e)??null}getFileSuggestionsMetadata(e){return this.fileSuggestionsMetadata.getItem(e)??null}getFileSuggestionsSeenState(e){return this.fileSuggestionsSeenStates[e]??null}getImageSuggestions(e){return this.imageSuggestions.getItem(e)??null}handleAction(e){let t=!1;switch(e.type){case Gt.C.actionType:t=this.handleFetchFileSuggestionsAction(e);break;case jt.v.actionType:t=this.handleFetchFileSuggestionsSucceededAction(e);break;case Wt.P.actionType:t=this.handleFetchFileSuggestionsFailedAction(e);break;case zt.N.actionType:t=this.handleFileSuggestionsSeenAction(e);break;case Kt.A.actionType:t=this.handleFetchImageRecommendationsAction(e);break;case Vt.T.actionType:t=this.handleFetchImageRecommendationsSucceededAction(e);break;case Ht.B.actionType:t=this.handleFetchImageRecommendationsFailedAction(e);break;default:return}t&&this.publishStoreChangedEvent()}handleFetchFileSuggestionsAction(e){return null!=this.fileSuggestions.getItem(e.entityId)&&(this.fileSuggestions.setItem(e.entityId,null),!0)}handleFetchFileSuggestionsSucceededAction(e){const t=this.fileSuggestions.getItem(e.entityId),n={traceId:e.fileSuggestions.fileResultReference.referenceId,cv:e.cv,logicalId:e.logicalId,resultSource:e.fileSuggestions.fileResultReference.resultSource};return this.fileSuggestionsMetadata.setItem(e.entityId,n),!Ge()(e.fileSuggestions.fileRecommendations,t)&&(this.fileSuggestions.setItem(e.entityId,e.fileSuggestions.fileRecommendations),!0)}handleFetchFileSuggestionsFailedAction(e){return null==this.fileSuggestions.getItem(e.taskId)&&(this.fileSuggestions.setItem(e.taskId,[]),!0)}handleFileSuggestionsSeenAction(e){const t=this.fileSuggestionsSeenStates[e.entityId];return t!==e.seen&&!0!==t&&(this.fileSuggestionsSeenStates[e.entityId]=e.seen,!0)}handleFetchImageRecommendationsAction(e){return null!=this.imageSuggestions.getItem(e.entityId)&&(this.imageSuggestions.removeItem(e.entityId),!0)}handleFetchImageRecommendationsSucceededAction(e){const t=this.imageSuggestions.getItem(e.entityId);if(null!=t&&t.query===e.query&&Ge()(e.results,t.results))return!1;const n={query:e.query,results:e.results};return this.imageSuggestions.setItem(e.entityId,n),!0}handleFetchImageRecommendationsFailedAction(e){const t=this.imageSuggestions.getItem(e.entityId);if(t?.query===e.query&&Ut()(t.results))return!1;const n={query:e.query,results:[]};return this.imageSuggestions.setItem(e.entityId,n),!0}constructor(){super(),this.fileSuggestionsSeenStates={},this.fileSuggestions=new Se.j,this.fileSuggestionsMetadata=new Se.j,this.imageSuggestions=new Se.j}}var qt=n(79799),Yt=n(41788),$t=n(98304),Jt=n(23359),Xt=n(99763),Qt=n(27197),en=n(33629),tn=function(){function e(e){this.array=null!==e&&void 0!==e?e:[]}return e.prototype.clone=function(){return new e(this.array.slice())},e.prototype.getCurrentLength=function(){return this.array.length},e.prototype.getValueAtIndex=function(e){var t;return null!==(t=this.array[e])&&void 0!==t?t:0},e.prototype.setValueAtIndex=function(e,t){this.array[e]=t},e}(),nn=n(94772),rn=n(67271);class sn{static BuildFromTaskSet(e,t){let n=0,r=0,s=0,i=0,a=0;for(const o of e)if(o.isLate())r++,a++;else switch((0,rn.Fk)(o.percentComplete)){case nn.$.NotStarted:r++,n++;break;case nn.$.Complete:s++;break;default:case nn.$.InProgress:r++,i++}return new sn(t,r,n,a,i,s)}handleTaskDeletion(e){let t=this.notStartedTasks,n=this.activeTasks,r=this.completedTasks,s=this.inProgressTasks,i=this.lateTasks;if(e.isLate())n--,i--;else switch((0,rn.Fk)(e.percentComplete)){case nn.$.NotStarted:n--,t--;break;case nn.$.Complete:r--;break;default:case nn.$.InProgress:n--,s--}return new sn(this.id,n,t,i,s,r)}handleTaskInsertion(e){let t=this.notStartedTasks,n=this.activeTasks,r=this.completedTasks,s=this.inProgressTasks,i=this.lateTasks;if(e.isLate())n++,i++;else switch((0,rn.Fk)(e.percentComplete)){case nn.$.NotStarted:n++,t++;break;case nn.$.Complete:r++;break;default:case nn.$.InProgress:n++,s++}return new sn(this.id,n,t,i,s,r)}handleTaskUpdate(e,t){return this.handleTaskDeletion(e).handleTaskInsertion(t)}handleAdditionalTaskData(e){let t=this.notStartedTasks,n=this.activeTasks,r=this.completedTasks,s=this.inProgressTasks,i=this.lateTasks;for(const a of e)if(a.isLate())n++,i++;else switch((0,rn.Fk)(a.percentComplete)){case nn.$.NotStarted:n++,t++;break;case nn.$.Complete:r++;break;default:case nn.$.InProgress:n++,s++}return new sn(this.id,n,t,i,s,r)}constructor(e,t,n,r,s,i){this.id=e,this.activeTasks=t,this.notStartedTasks=n,this.lateTasks=r,this.inProgressTasks=s,this.completedTasks=i}}var an=n(50723),on=n.n(an);class ln extends be.z{get name(){return"PlannerAggregatesStore"}getPlanAggregates(e){return this.planAggregates.getItem(e)??null}getLabelUsageCountsForPlan(e){return this.labelCountsByPlan.getItem(e)??new tn}handleAction(e){let t=!1;switch(e.type){case et.t.actionType:t=this.handlePlanCreation(e);break;case qe.Y.actionType:case Ke.l.actionType:t=this.handlePlanDeletion(e.planId);break;case qt.a.actionType:t=this.handleTasksForPlanFetchSuccess(e);break;case Yt.r.actionType:case $t.r.actionType:t=this.handlePlanTaskCreation(e.taskEntitySet.task);break;case Jt.U.actionType:const n=e;t=this.handlePlanTaskUpdate(n.originalTaskEntitySet.task,n.updatedTaskEntitySet.task);break;case Xt.T.actionType:const r=e;t=this.handlePlanTaskUpdate(r.originalTaskEntitySet.task,r.taskEntitySet.task);break;case Qt.o.actionType:case en.D.actionType:t=this.handlePlanTaskDeletion(e.deletedTaskEntitySet.task);break;default:return}t&&this.publishStoreChangedEvent()}handlePlanCreation(e){const t=e.planEntitySet.plan;return this.planAggregates.setItem(t.id,new sn(t.id,0,0,0,0,0)),this.labelCountsByPlan.setItem(t.id,new tn),!0}handlePlanDeletion(e){let t=!1;const n=this.planAggregates.getItem(e);null!==n&&void 0!==n&&(this.planAggregates.removeItem(e),t=!0);const r=this.labelCountsByPlan.getItem(e);return null!==r&&void 0!==r&&(this.labelCountsByPlan.removeItem(e),t=!0),t}handlePlanTaskCreation(e){if(null==e)return!1;let t=!1;const{planId:n}=e,r=this.planAggregates.getItem(n);if(null!==r&&void 0!==r){const n=r.handleTaskInsertion(e);this.planAggregates.setItem(e.planId,n),t=!0}const s=this.labelCountsByPlan.getItem(n);if(null!==s&&void 0!==s){const r=s.clone();e.appliedCategories.forEach(e=>{r.setValueAtIndex(e,r.getValueAtIndex(e)+1)}),this.labelCountsByPlan.setItem(n,r),t=!0}return t}handlePlanTaskDeletion(e){if(null==e)return!1;let t=!1;const{planId:n}=e,r=this.planAggregates.getItem(n);if(null!==r&&void 0!==r){const s=r.handleTaskDeletion(e);this.planAggregates.setItem(n,s),t=!0}const s=this.labelCountsByPlan.getItem(n);if(null!==s&&void 0!==s){const r=s.clone();e.appliedCategories.forEach(e=>{r.setValueAtIndex(e,r.getValueAtIndex(e)-1)}),this.labelCountsByPlan.setItem(n,r),t=!0}return t}handlePlanTaskUpdate(e,t){if(null==e||null==t)return!1;let n=!1;const{planId:r}=e,s=this.planAggregates.getItem(r);if(null!==s&&void 0!==s){const i=s.handleTaskUpdate(e,t);this.planAggregates.setItem(r,i),n=!0}const i=this.labelCountsByPlan.getItem(r);if(!Ge()(e.appliedCategories,t.appliedCategories)&&null!==i&&void 0!==i){const s=i.clone(),a=on()(t.appliedCategories,t=>e.appliedCategories.indexOf(t)<0),o=on()(e.appliedCategories,e=>t.appliedCategories.indexOf(e)<0);Lt()(a,e=>{s.setValueAtIndex(e,s.getValueAtIndex(e)+1)}),Lt()(o,e=>{s.setValueAtIndex(e,s.getValueAtIndex(e)-1)}),this.labelCountsByPlan.setItem(r,s),n=!0}return n}handleTasksForPlanFetchSuccess(e){const{isFirstPage:t,planId:n}=e;if(Ut()(n))return!1;const r=this.getPlanAggregates(n);if(!t&&null===r)throw new Error("AggregateException: original planAggregates not found in the store while isFirstPage is false");let s=this.labelCountsByPlan.getItem(n);if(!t&&(null===s||void 0===s))throw new Error("AggregateException: original LabelCounts not found in the store while isFirstPage is false");let i=!1;const a=e.tasks.map(e=>e.task);if(t)this.planAggregates.setItem(n,sn.BuildFromTaskSet(a,n)),i=!0;else{const e=r.handleAdditionalTaskData(a);Ge()(r,e)||(this.planAggregates.setItem(n,e),i=!0)}s=this.getLabelUsageCountsForPlan(n);const o=s.clone();return a.forEach(e=>{e.appliedCategories.forEach(e=>{o.setValueAtIndex(e,o.getValueAtIndex(e)+1)})}),t?(this.labelCountsByPlan.setItem(n,o),i=!0):Ge()(s,o)||(this.labelCountsByPlan.setItem(n,o),i=!0),i}constructor(){super(),this.planAggregates=new Se.j,this.labelCountsByPlan=new Se.j}}var cn=n(1207),dn=n(53734),un=n(1623),hn=n(514),pn=n(79670),gn=n(25744),mn=n(15765),fn=n(38227),yn=n(87450),vn=n(46219),kn=n(23821),Tn=n(48148),Sn=n(45698),bn=n(47572),In=n(21651),Cn=n(56434),Dn=n.n(Cn),En=n(56641),Pn=n.n(En),wn=n(56851);function xn(e){return"function"===typeof e}function Fn(e){var t=e(function(e){Error.call(e),e.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var An=Fn(function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map(function(e,t){return t+1+") "+e.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}});function Ln(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var _n=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var e,t,n,r,s;if(!this.closed){this.closed=!0;var i=this._parentage;if(i)if(this._parentage=null,Array.isArray(i))try{for(var a=(0,wn.__values)(i),o=a.next();!o.done;o=a.next()){o.value.remove(this)}}catch(p){e={error:p}}finally{try{o&&!o.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}else i.remove(this);var l=this.initialTeardown;if(xn(l))try{l()}catch(g){s=g instanceof An?g.errors:[g]}var c=this._finalizers;if(c){this._finalizers=null;try{for(var d=(0,wn.__values)(c),u=d.next();!u.done;u=d.next()){var h=u.value;try{Bn(h)}catch(m){s=null!==s&&void 0!==s?s:[],m instanceof An?s=(0,wn.__spreadArray)((0,wn.__spreadArray)([],(0,wn.__read)(s)),(0,wn.__read)(m.errors)):s.push(m)}}}catch(f){n={error:f}}finally{try{u&&!u.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}}if(s)throw new An(s)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)Bn(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&Ln(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&Ln(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}(),Un=_n.EMPTY;function On(e){return e instanceof _n||e&&"closed"in e&&xn(e.remove)&&xn(e.add)&&xn(e.unsubscribe)}function Bn(e){xn(e)?e():e.unsubscribe()}var Mn={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Nn={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var s=Nn.delegate;return(null===s||void 0===s?void 0:s.setTimeout)?s.setTimeout.apply(s,(0,wn.__spreadArray)([e,t],(0,wn.__read)(n))):setTimeout.apply(void 0,(0,wn.__spreadArray)([e,t],(0,wn.__read)(n)))},clearTimeout:function(e){var t=Nn.delegate;return((null===t||void 0===t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function Rn(e){Nn.setTimeout(function(){var t=Mn.onUnhandledError;if(!t)throw e;t(e)})}function Gn(){}var Wn=zn("C",void 0,void 0);function zn(e,t,n){return{kind:e,value:t,error:n}}var jn=null;function Kn(e){if(Mn.useDeprecatedSynchronousErrorHandling){var t=!jn;if(t&&(jn={errorThrown:!1,error:null}),e(),t){var n=jn,r=n.errorThrown,s=n.error;if(jn=null,r)throw s}}else e()}var Hn=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,On(t)&&t.add(n)):n.destination=Xn,n}return(0,wn.__extends)(t,e),t.create=function(e,t,n){return new Yn(e,t,n)},t.prototype.next=function(e){this.isStopped?Jn(function(e){return zn("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?Jn(zn("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?Jn(Wn,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(_n),Vn=Function.prototype.bind;function Zn(e,t){return Vn.call(e,t)}var qn=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(n){$n(n)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(n){$n(n)}else $n(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){$n(t)}},e}(),Yn=function(e){function t(t,n,r){var s,i,a=e.call(this)||this;xn(t)||!t?s={next:null!==t&&void 0!==t?t:void 0,error:null!==n&&void 0!==n?n:void 0,complete:null!==r&&void 0!==r?r:void 0}:a&&Mn.useDeprecatedNextContext?((i=Object.create(t)).unsubscribe=function(){return a.unsubscribe()},s={next:t.next&&Zn(t.next,i),error:t.error&&Zn(t.error,i),complete:t.complete&&Zn(t.complete,i)}):s=t;return a.destination=new qn(s),a}return(0,wn.__extends)(t,e),t}(Hn);function $n(e){var t;Mn.useDeprecatedSynchronousErrorHandling?(t=e,Mn.useDeprecatedSynchronousErrorHandling&&jn&&(jn.errorThrown=!0,jn.error=t)):Rn(e)}function Jn(e,t){var n=Mn.onStoppedNotification;n&&Nn.setTimeout(function(){return n(e,t)})}var Xn={closed:!0,next:Gn,error:function(e){throw e},complete:Gn},Qn="function"===typeof Symbol&&Symbol.observable||"@@observable";function er(e){return e}function tr(e){return 0===e.length?er:1===e.length?e[0]:function(t){return e.reduce(function(e,t){return t(e)},t)}}var nr=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r,s=this,i=(r=e)&&r instanceof Hn||function(e){return e&&xn(e.next)&&xn(e.error)&&xn(e.complete)}(r)&&On(r)?e:new Yn(e,t,n);return Kn(function(){var e=s,t=e.operator,n=e.source;i.add(t?t.call(i,n):n?s._subscribe(i):s._trySubscribe(i))}),i},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=rr(t))(function(t,r){var s=new Yn({next:function(t){try{e(t)}catch(n){r(n),s.unsubscribe()}},error:r,complete:t});n.subscribe(s)})},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[Qn]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return tr(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=rr(e))(function(e,n){var r;t.subscribe(function(e){return r=e},function(e){return n(e)},function(){return e(r)})})},e.create=function(t){return new e(t)},e}();function rr(e){var t;return null!==(t=null!==e&&void 0!==e?e:Mn.Promise)&&void 0!==t?t:Promise}var sr=Fn(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),ir=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return(0,wn.__extends)(t,e),t.prototype.lift=function(e){var t=new ar(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new sr},t.prototype.next=function(e){var t=this;Kn(function(){var n,r;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var s=(0,wn.__values)(t.currentObservers),i=s.next();!i.done;i=s.next()){i.value.next(e)}}catch(a){n={error:a}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}}})},t.prototype.error=function(e){var t=this;Kn(function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}})},t.prototype.complete=function(){var e=this;Kn(function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,n=this,r=n.hasError,s=n.isStopped,i=n.observers;return r||s?Un:(this.currentObservers=null,i.push(e),new _n(function(){t.currentObservers=null,Ln(i,e)}))},t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.hasError,r=t.thrownError,s=t.isStopped;n?e.error(r):s&&e.complete()},t.prototype.asObservable=function(){var e=new nr;return e.source=this,e},t.create=function(e,t){return new ar(e,t)},t}(nr),ar=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return(0,wn.__extends)(t,e),t.prototype.next=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)},t.prototype.error=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:Un},t}(ir),or=function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}return(0,wn.__extends)(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){var e=this,t=e.hasError,n=e.thrownError,r=e._value;if(t)throw n;return this._throwIfClosed(),r},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(ir);function lr(e){return function(t){if(function(e){return xn(null===e||void 0===e?void 0:e.lift)}(t))return t.lift(function(t){try{return e(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function cr(e,t,n,r,s){return new dr(e,t,n,r,s)}var dr=function(e){function t(t,n,r,s,i,a){var o=e.call(this,t)||this;return o.onFinalize=i,o.shouldUnsubscribe=a,o._next=n?function(e){try{n(e)}catch(r){t.error(r)}}:e.prototype._next,o._error=s?function(e){try{s(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,o._complete=r?function(){try{r()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,o}return(0,wn.__extends)(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(Hn);function ur(e,t){return void 0===t&&(t=er),e=null!==e&&void 0!==e?e:hr,lr(function(n,r){var s,i=!0;n.subscribe(cr(r,function(n){var a=t(n);!i&&e(s,a)||(i=!1,s=a,r.next(n))}))})}function hr(e,t){return e===t}class pr{get unwrap(){return this._subject.value}get listObservable(){return this._observable}update(e){this._itemIndex=this.createDictionaryIndexesFromArray(e),this.pushChange(Dn()(e))}upsert(e,t){if(!Pn()(e,t,this.customComparator)){const n=this.getKey(e),r=Dn()(t),s=this._itemIndex[n];if(null!=s){const e=Dn()(this.unwrap),t=this.getKey(r),i=this._itemIndex[t];if(n===t)e[s]=r;else if(null==i)e[s]=r,delete this._itemIndex[n],this._itemIndex[t]=s;else{const i=e.pop(),a=this.getKey(i);delete this._itemIndex[n],n!==a&&(e[s]=i,this._itemIndex[a]=s),e[this._itemIndex[t]]=r}this.pushChange(e)}}}add(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!Ut()(t)){let e=!1;const n=Dn()(this.unwrap);for(const r of Dn()(t)){const t=this.getKey(r);if(null==this._itemIndex[t]){const s=n.push(r);this._itemIndex[t]=s-1,e=!0}}e&&this.pushChange(n)}}remove(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!Ut()(t)){let e=!1;const n=Dn()(this.unwrap);for(const r of this.getKeys(t)){const t=this._itemIndex[r];if(null!=t){const s=n.pop(),i=this.getKey(s);r!==i&&(n[t]=s,this._itemIndex[i]=t),delete this._itemIndex[r],e=!0}}e&&this.pushChange(n)}}contains(e){return null!=this._itemIndex[this.getKey(e)]}pushChange(e){this._subject.next(e)}createDictionaryIndexesFromArray(e){return In.x.isCollectionOfIdentifiables(e)?e.filter(e=>null!=e.id).reduce((e,t,n)=>({...e,[t.id]:n}),{}):e.filter(e=>null!=e).reduce((e,t,n)=>({...e,[t]:n}),{})}getKey(e){return In.x.isIdentifiable(e)?e.id:e}getKeys(e){return In.x.isCollectionOfIdentifiables(e)?e.map(e=>e.id):e}constructor(e,t){this.customComparator=t,this._itemIndex=this.createDictionaryIndexesFromArray(e),this._subject=new or(Dn()(e)),this._observable=this._subject.asObservable().pipe(ur((e,t)=>Pn()(e,t,this.customComparator)))}}var gr=n(23096);class mr extends gr.w{get value(){return this._subject.value}get valueObservable(){return this._observable}pushDelta(e,t){super.pushDelta(e,t),this.pushChange()}revertDelta(e){super.revertDelta(e),this.pushChange()}commitDelta(e,t){super.commitDelta(e,t),this.pushChange()}updateBaseline(e){super.updateBaseline(e),this.pushChange()}restartStreams(){this._subject?.complete(),this._subject=new or(Dn()(this.getValue())),this._observable=this._subject.asObservable().pipe(ur((e,t)=>Pn()(e,t,this.customComparator)))}pushChange(){this._subject.next(Dn()(this.getValue()))}constructor(e,t){super(Dn()(e)),this.customComparator=t,this.restartStreams()}}var fr=n(80347),yr=n(91246),vr=n(54052),kr=n.n(vr);class Tr{static tryAddIdToIndex(e,t,n,r){if(!Ut()(n)){let s=t.getItem(n);if(null==s&&r&&(s=[]),null!=s){if(s.indexOf(e)<0)return s.push(e),t.setItem(n,s),!0}}return!1}static addItemToOrInitializeObservableContainer(e,t,n,r){if(!Ut()(n)){const s=t[n],i=kr()(e)?e:[e];null==s?t[n]=new pr(i,r):s.add(...i)}}static tryRemoveIdFromIndex(e,t,n){if(!Ut()(n)){const r=t.getItem(n);if(null!=r){const s=r.indexOf(e);if(s>=0)return r.splice(s,1),t.setItem(n,r),!0}}return!1}static tryUpdateIdInIndex(e,t,n,r){if(e===t)return!1;if(!Ut()(r)){const s=n.getItem(r);if(null!=s){const i=s.indexOf(e);if(i>=0)return s.splice(i,1),s.indexOf(t)<0&&s.push(t),n.setItem(r,s),!0}}return!1}static updateItemsInOrInitializeObservableContainer(e,t,n,r){if(!Ut()(n)){const s=t[n];null==s?t[n]=new pr(e,r):s.update(e)}}}var Sr=n(72749),br=n.n(Sr),Ir=n(33411),Cr=n.n(Ir),Dr=n(9376),Er=n.n(Dr),Pr=new nr(function(e){return e.complete()});var wr=function(e){return e&&"number"===typeof e.length&&"function"!==typeof e};function xr(e){return xn(null===e||void 0===e?void 0:e.then)}function Fr(e){return xn(e[Qn])}function Ar(e){return Symbol.asyncIterator&&xn(null===e||void 0===e?void 0:e[Symbol.asyncIterator])}function Lr(e){return new TypeError("You provided "+(null!==e&&"object"===typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var _r="function"===typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function Ur(e){return xn(null===e||void 0===e?void 0:e[_r])}function Or(e){return(0,wn.__asyncGenerator)(this,arguments,function(){var t,n,r;return(0,wn.__generator)(this,function(s){switch(s.label){case 0:t=e.getReader(),s.label=1;case 1:s.trys.push([1,,9,10]),s.label=2;case 2:return[4,(0,wn.__await)(t.read())];case 3:return n=s.sent(),r=n.value,n.done?[4,(0,wn.__await)(void 0)]:[3,5];case 4:return[2,s.sent()];case 5:return[4,(0,wn.__await)(r)];case 6:return[4,s.sent()];case 7:return s.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function Br(e){return xn(null===e||void 0===e?void 0:e.getReader)}function Mr(e){if(e instanceof nr)return e;if(null!=e){if(Fr(e))return s=e,new nr(function(e){var t=s[Qn]();if(xn(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")});if(wr(e))return r=e,new nr(function(e){for(var t=0;t<r.length&&!e.closed;t++)e.next(r[t]);e.complete()});if(xr(e))return n=e,new nr(function(e){n.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,Rn)});if(Ar(e))return Nr(e);if(Ur(e))return t=e,new nr(function(e){var n,r;try{for(var s=(0,wn.__values)(t),i=s.next();!i.done;i=s.next()){var a=i.value;if(e.next(a),e.closed)return}}catch(o){n={error:o}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}e.complete()});if(Br(e))return Nr(Or(e))}var t,n,r,s;throw Lr(e)}function Nr(e){return new nr(function(t){(function(e,t){var n,r,s,i;return(0,wn.__awaiter)(this,void 0,void 0,function(){var a,o;return(0,wn.__generator)(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),n=(0,wn.__asyncValues)(e),l.label=1;case 1:return[4,n.next()];case 2:if((r=l.sent()).done)return[3,4];if(a=r.value,t.next(a),t.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return o=l.sent(),s={error:o},[3,11];case 6:return l.trys.push([6,,9,10]),r&&!r.done&&(i=n.return)?[4,i.call(n)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(s)throw s.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})})(e,t).catch(function(e){return t.error(e)})})}function Rr(e){return e[e.length-1]}function Gr(e){return(t=Rr(e))&&xn(t.schedule)?e.pop():void 0;var t}function Wr(e,t,n,r,s){void 0===r&&(r=0),void 0===s&&(s=!1);var i=t.schedule(function(){n(),s?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(i),!s)return i}function zr(e,t){return void 0===t&&(t=0),lr(function(n,r){n.subscribe(cr(r,function(n){return Wr(r,e,function(){return r.next(n)},t)},function(){return Wr(r,e,function(){return r.complete()},t)},function(n){return Wr(r,e,function(){return r.error(n)},t)}))})}function jr(e,t){return void 0===t&&(t=0),lr(function(n,r){r.add(e.schedule(function(){return n.subscribe(r)},t))})}function Kr(e,t){if(!e)throw new Error("Iterable cannot be null");return new nr(function(n){Wr(n,t,function(){var r=e[Symbol.asyncIterator]();Wr(n,t,function(){r.next().then(function(e){e.done?n.complete():n.next(e.value)})},0,!0)})})}function Hr(e,t){if(null!=e){if(Fr(e))return function(e,t){return Mr(e).pipe(jr(t),zr(t))}(e,t);if(wr(e))return function(e,t){return new nr(function(n){var r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}(e,t);if(xr(e))return function(e,t){return Mr(e).pipe(jr(t),zr(t))}(e,t);if(Ar(e))return Kr(e,t);if(Ur(e))return function(e,t){return new nr(function(n){var r;return Wr(n,t,function(){r=e[_r](),Wr(n,t,function(){var e,t,s;try{t=(e=r.next()).value,s=e.done}catch(i){return void n.error(i)}s?n.complete():n.next(t)},0,!0)}),function(){return xn(null===r||void 0===r?void 0:r.return)&&r.return()}})}(e,t);if(Br(e))return function(e,t){return Kr(Or(e),t)}(e,t)}throw Lr(e)}function Vr(e,t){return t?Hr(e,t):Mr(e)}var Zr=Array.isArray,qr=Object.getPrototypeOf,Yr=Object.prototype,$r=Object.keys;function Jr(e){if(1===e.length){var t=e[0];if(Zr(t))return{args:t,keys:null};if((r=t)&&"object"===typeof r&&qr(r)===Yr){var n=$r(t);return{args:n.map(function(e){return t[e]}),keys:n}}}var r;return{args:e,keys:null}}var Xr=Array.isArray;function Qr(e){return t=function(t){return function(e,t){return Xr(t)?e.apply(void 0,(0,wn.__spreadArray)([],(0,wn.__read)(t))):e(t)}(e,t)},lr(function(e,r){var s=0;e.subscribe(cr(r,function(e){r.next(t.call(n,e,s++))}))});var t,n}function es(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Gr(e),r=function(e){return xn(Rr(e))?e.pop():void 0}(e),s=Jr(e),i=s.args,a=s.keys;if(0===i.length)return Vr([],n);var o=new nr(function(e,t,n){void 0===n&&(n=er);return function(r){ts(t,function(){for(var s=e.length,i=new Array(s),a=s,o=s,l=function(s){ts(t,function(){var l=Vr(e[s],t),c=!1;l.subscribe(cr(r,function(e){i[s]=e,c||(c=!0,o--),o||r.next(n(i.slice()))},function(){--a||r.complete()}))},r)},c=0;c<s;c++)l(c)},r)}}(i,n,a?function(e){return function(e,t){return e.reduce(function(e,n,r){return e[n]=t[r],e},{})}(a,e)}:er));return r?o.pipe(Qr(r)):o}function ts(e,t,n){e?Wr(n,e,t):t()}class ns extends be.z{get name(){return"PlannerBucketStore"}getBucket(e){return this.buckets[e]?.value??null}getBucketObservable(e){return this.buckets[e]?.valueObservable??Pr}getBucketWithoutPendingUpdates(e){return this.buckets[e]?.baseline??null}getBucketStatus(e){return this.buckets[e]?.status??null}getBucketsForPlan(e){const t=this.planBucketsIndex[e]?.unwrap;return null==t?null:Cr()(t,e=>{const t=this.getBucket(e);if(null==t)throw new Error("IndexCorruptionException: Indexed bucket not found in Bucket table");return t})}getBucketsForPlanObservable(e){return null==this.planBucketsIndex[e]&&(this.planBucketsIndex[e]=new pr([])),this.planBucketsIndex[e].listObservable.pipe((t=e=>Ut()(e)?function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Vr(e,Gr(e))}([]):es(e.map(e=>this.getBucketObservable(e))),lr(function(e,r){var s=null,i=0,a=!1,o=function(){return a&&!s&&r.complete()};e.subscribe(cr(r,function(e){null===s||void 0===s||s.unsubscribe();var a=0,l=i++;Mr(t(e,l)).subscribe(s=cr(r,function(t){return r.next(n?n(e,t,l,a++):t)},function(){s=null,o()}))},function(){a=!0,o()}))})),ur(Ge()));var t,n}handleAction(e){let t=!1;switch(e.type){case cn.z.actionType:t=this.handleBucketsForPlansFetchSuccess(e);break;case dn.g.actionType:t=this.handleFetchBucketSuccess(e);break;case un.t.actionType:t=this.handleBucketCreation(e);break;case hn.g.actionType:t=this.handleBucketCreationFailure(e);break;case pn.G.actionType:t=this.handleBucketCreationSuccess(e);break;case Tn.e.actionType:t=this.handleDiffSyncInsertBucket(e);break;case gn.e.actionType:t=this.handleBucketDeletion(e);break;case mn.V.actionType:t=this.handleBucketDeletionFailure(e);break;case fn.R.actionType:t=this.handleBucketDeletionSuccess(e);break;case Sn.a.actionType:t=this.handleDiffSyncDeleteBucket(e);break;case yn.A.actionType:t=this.handleBucketUpdate(e);break;case vn.T.actionType:t=this.handleBucketUpdateFailure(e);break;case kn.z.actionType:t=this.handleBucketUpdateSuccess(e);break;case bn.c.actionType:t=this.handleDiffSyncUpdateBucket(e);break;case tt.actionType:const n=e;t=this.handleBucketsForPlansFetchSuccess(new cn.z(n.plan.id,n.buckets));break;default:return}t&&this.publishStoreChangedEvent()}handleBucketsForPlansFetchSuccess(e){let t=!1,n=[];const r=this.planBucketsIndex[e.planId]?.unwrap;if(null!=r&&0!==r.length){const e=r.filter(e=>yr.o.isPlexTempId(e));n=br()(n,e)}Lt()(e.buckets,e=>{if(null!=e){n.push(e.id);const r=this.buckets[e.id];null==r?(t=!0,this.buckets[e.id]=new mr(e,(e,t)=>fr.lz.isEqualMomentCustomizer(e,t))):Ge()(r.baseline,e)||(r.updateBaseline(e),t=!0)}});const s=Er()(n),i=this.planBucketsIndex[e.planId]?.unwrap;return Ge()(i,s)||(Tr.updateItemsInOrInitializeObservableContainer(s,this.planBucketsIndex,e.planId),t=!0),t}handleFetchBucketSuccess(e){let t=!1;const n=e.bucket.id,r=e.bucket,s=this.buckets[n];return null==s?(t=!0,this.buckets[r.id]=new mr(r,(e,t)=>fr.lz.isEqualMomentCustomizer(e,t))):Ge()(s.baseline,r)||(s.updateBaseline(r),t=!0),Tr.addItemToOrInitializeObservableContainer(n,this.planBucketsIndex,r.planId),t}handleBucketCreation(e){const t=e.bucket.id;if(null!=this.buckets[t])throw new Error("AggregateException: bucket already exists in store");return this.buckets[t]=new mr(e.bucket,(e,t)=>fr.lz.isEqualMomentCustomizer(e,t)),Tr.addItemToOrInitializeObservableContainer(t,this.planBucketsIndex,e.bucket.planId),!0}handleBucketCreationFailure(e){const t=e.bucket.id,n=this.buckets[t];if(null==n)throw new Error("AggregateException: bucket not found in store");return this.planBucketsIndex[e.bucket.planId]?.remove(t),delete this.buckets[n.baseline.id],!0}handleBucketCreationSuccess(e){const t=e.localId,n=e.bucket.id,r=this.buckets[t];if(null==r)throw new Error("AggregateException: bucket not found in store");return delete this.buckets[r.baseline.id],r.restartStreams(),r.updateBaseline(e.bucket),this.buckets[n]=r,this.planBucketsIndex[e.bucket.planId]?.upsert(t,n),!0}handleDiffSyncInsertBucket(e){const t=e.bucket,n=t.id;if(this.buckets[n])throw new Error("AggregateException: bucket already exists in store");return this.buckets[n]=new mr(t,(e,t)=>fr.lz.isEqualMomentCustomizer(e,t)),Tr.addItemToOrInitializeObservableContainer(n,this.planBucketsIndex,t.planId),!0}handleBucketDeletion(e){const t=e.bucketId,n=this.buckets[t];if(null==n)throw new Error("AggregateException: bucket not found in store");return this.planBucketsIndex[n.baseline.planId]?.remove(n.baseline.id),n.softDelete(),!0}handleBucketDeletionFailure(e){const t=e.bucketId,n=this.buckets[t];if(null==n)throw new Error("AggregateException: bucket not found in store");return n.undelete(),Tr.addItemToOrInitializeObservableContainer(n.baseline.id,this.planBucketsIndex,n.baseline.planId),!0}handleBucketDeletionSuccess(e){const t=e.bucketId,n=this.buckets[t];if(null==n)throw new Error("AggregateException: bucket not found in store");return delete this.buckets[n.baseline.id],!0}handleDiffSyncDeleteBucket(e){const t=e.bucketId,n=this.buckets[t];if(null==n)throw new Error("AggregateException: bucket not found in store");return this.planBucketsIndex[n.baseline.planId]?.remove(t),delete this.buckets[n.baseline.id],!0}handleBucketUpdate(e){let t=!1;const n=this.buckets[e.bucket.id];if(null==n)throw new Error("AggregateException: bucket not found in store");return Ge()(n.value,e.bucket)||(n.pushDelta(e.bucket,e.updateKey),t=!0),t}handleBucketUpdateFailure(e){let t=!1;const n=this.buckets[e.bucket.id];if(null==n)throw new Error("AggregateException: bucket not found in store");return null!=n.getDelta(e.updateKey)&&(n.revertDelta(e.updateKey),t=!0),t}handleBucketUpdateSuccess(e){let t=!1;const n=this.buckets[e.bucket.id];if(null==n)throw new Error("AggregateException: bucket not found in store");return null!=n.getDelta(e.updateKey)&&(n.commitDelta(e.updateKey,e.bucket),t=!0),t}handleDiffSyncUpdateBucket(e){let t=!1;const n=this.buckets[e.bucket.id];if(null==n)throw new Error("AggregateException: bucket not found in store");return Ge()(n.baseline,e.bucket)||(n.updateBaseline(e.bucket),t=!0),t}constructor(){super(),this.buckets={},this.planBucketsIndex={}}}var rs=n(40655);class ss extends $.r{loggingData(){return{groupId:this.groupId,planCount:String(this.plans.length)}}constructor(e,t){super(ss.actionType),this.groupId=e,this.plans=t}}ss.actionType="PLW_GET_PLANSFORGROUP_SUCCEEDED";var is=n(75913),as=n(4597),os=n(9300),ls=n(12756),cs=n(39894),ds=n(6775);class us{get data(){return this._subject.value}get dataObservable(){return this._observable}update(e){this.pushChange(Dn()(e))}upsert(e,t){const n=Dn()(this.data);null!=n[e]&&Pn()(n[e],t,this.customComparator)||(n[e]=Dn()(t),this.pushChange(n))}remove(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!Ut()(t)){let e=!1;const n=Dn()(this.data);for(const r of t)n[r]&&(delete n[r],e=!0);e&&this.pushChange(n)}}pushChange(e){this._subject.next(e)}constructor(e,t){this.customComparator=t,this._subject=new or(Dn()(e??{})),this._observable=this._subject.asObservable().pipe(ur((e,t)=>Pn()(e,t,this.customComparator)))}}var hs=n(98990),ps=n.n(hs);class gs extends be.z{get name(){return"PlannerContainerMembershipStore"}getPlanIds(e){const t=this.userContainerPlanIds[e],n=[];for(const r in t?.data){const e=t.data[r].unwrap;null!=e&&n.push(...e.slice())}return n}getDocumentPlanIdsForUser(e){const t=this.userContainerPlanIds[e],n=t?.data[St.K.DriveItem]?.unwrap;return n?.slice()??null}getPlanIdsForContainer(e){const t=Dn()(this.containerToPlansMapping[e]?.unwrap);return null!=t?t:ps()(this.resolvedContainerIds,t=>t===e)?[]:null}getContainerHasBeenResolved(e){return-1!==this.resolvedContainerIds.indexOf(e)}getJoinedContainerIds(e){return this.userJoinedGroupContainerIds[e]?.unwrap??[]}isUserUsAndMsitTenantMember(){return this.isUSAndMsitTenantMember}handleAction(e){let t=!1;switch(e.type){case as.K.actionType:const n=e;t=this.handleOptimisticGroupCreation(n.unifiedGroup.id);break;case os.b.actionType:const r=e;t=this.handleFailedGroupCreation(r.localId);break;case ls.x.actionType:const s=e;t=this.handleSuccessfulGroupCreation(s.localId,s.unifiedGroup.id);break;case yt.L.actionType:t=this.handleGetContainerSucceededAction(e);break;case ct.P.actionType:t=this.handleGetUnifiedGroupDetailsSucceededAction(e);break;case cs.F.actionType:t=this.handleGetJoinedGroupsSucceededAction(e);break;case rs.A.actionType:t=this.handleGetContainersSucceededAction(e);break;case lt.s.actionType:t=this.handleDeleteUnifiedGroupSucceededAction(e);break;case ut.w.actionType:const i=e;t=this.addMembershipInStore(i.containerId,i.containerType);break;case ht.v.actionType:const a=e;t=this.removeMembershipInStore(a.containerId,a.containerType);break;case ss.actionType:const o=e;t=this.addPlansToUser(o.plans);break;case Xe.$.actionType:const l=e;t=this.ensureContainerMappingInStore(l.planEntitySet.plan.container,l.planEntitySet.id);break;case Ye.A.actionType:const c=e;t=this.handleMultiplePlanFetch(c.plans);break;case $e.N.actionType:const d=e;t=this.handleMultiplePlanFetch(d.plans);break;case is.C.actionType:const u=e;t=this.handleMultiplePlanFetch(u.plans);break;case Je.O.actionType:const h=e;t=this.ensureContainerMappingInStore(h.planEntitySet.plan.container,h.planEntitySet.id);break;case Qe.V.actionType:const p=e;t=this.removeMappingInStore(p.planEntitySet.plan.container.externalId,p.planEntitySet.id);break;case et.t.actionType:const g=e;t=this.updateMappingInStore(g.planEntitySet.plan.container,g.localId,g.planEntitySet.id);break;case qe.Y.actionType:const m=e;t=this.handleDeletePlan(m.planId,m.planContainer);break;case Ke.l.actionType:const f=e;t=this.handleDeletePlan(f.planId,f.planContainer);break;case ot.T.actionType:const y=e;t=this.handleGroupPlanResolutionSuccess(y);break;case pt.f.actionType:const v=e;t=this.handleContainerPlanResolutionSuccess(v);break;case tt.actionType:const k=e;t=this.ensureContainerMappingInStore(k.plan.plan.container,k.plan.id);break;case ds.e.actionType:t=this.handleCheckCurrentUserToUSMsitTenantMemberSucceededAction(e);break;default:return}t&&this.publishStoreChangedEvent()}addPlansToUser(e){let t=!1;return Lt()(e,e=>{t=this.addPlanIdToUserPlans(e.id,e.container.containerType)||t}),t}addPlanIdToUserPlans(e,t){let n=!1,r=this.userContainerPlanIds[Z.B.currentUserId];return r||(r=new us,this.userContainerPlanIds[Z.B.currentUserId]=r,n=!0),r.data[t]?r.data[t].contains(e)||(r.data[t].add(e),n=!0):(r.upsert(t,new pr([e])),n=!0),n}removePlanIdsFromStore(e,t){if(null==e||0===e.length)return!1;let n=!1;const r=this.userContainerPlanIds[Z.B.currentUserId];if(!r)return!1;const s=r.data[t];if(!s)return!1;for(const i of e)s.contains(i)&&(s.remove(i),n=!0);return n}handleCheckCurrentUserToUSMsitTenantMemberSucceededAction(e){return e.returnedGroupIds.indexOf(C.YR)>-1&&(this.isUSAndMsitTenantMember=!0,!0)}handleGroupPlanResolutionSuccess(e){let t=!1;for(const n in e.groupPlanMapping){const r=this.containerToPlansMapping[n]?.unwrap;ps()(this.resolvedContainerIds,e=>e===n)||this.resolvedContainerIds.push(n);const s=e.groupPlanMapping[n]?.map(e=>e.id);null==s?(delete this.containerToPlansMapping[n],t=!0):Ut()(s)?null!=r&&Ge()(r,[])||(Tr.updateItemsInOrInitializeObservableContainer([],this.containerToPlansMapping,n),t=!0):(null!=r&&Ge()(r,s)||(Tr.updateItemsInOrInitializeObservableContainer(s,this.containerToPlansMapping,n),t=!0),s.forEach(e=>{t=this.addPlanIdToUserPlans(e,St.K.Group)||t;const r=this.planToContainerMapping[e];null!=r&&n===r||(this.planToContainerMapping[e]=n,t=!0)}))}return t}handleContainerPlanResolutionSuccess(e){let t=!1;for(const n in e.containerPlanMapping){const r=this.containerToPlansMapping[n]?.unwrap;ps()(this.resolvedContainerIds,e=>e===n)||this.resolvedContainerIds.push(n);const s=e.containerPlanMapping[n]?.map(e=>e.id);null==s?(delete this.containerToPlansMapping[n],t=!0):Ut()(s)?null!=r&&Ge()(r,[])||(Tr.updateItemsInOrInitializeObservableContainer([],this.containerToPlansMapping,n),t=!0):(null!=r&&Ge()(r,s)||(Tr.updateItemsInOrInitializeObservableContainer(s,this.containerToPlansMapping,n),t=!0),s.forEach(r=>{t=this.addPlanIdToUserPlans(r,e.containerType)||t;const s=this.planToContainerMapping[r];null!=s&&n===s||(this.planToContainerMapping[r]=n,t=!0)}))}return t}handleDeletePlan(e,t){const n=this.planToContainerMapping[e];return!!n&&(this.containerToPlansMapping[n]?.remove(e),delete this.planToContainerMapping[e],this.removePlanIdsFromStore([e],t.containerType),!0)}handleOptimisticGroupCreation(e){const t=this.containerToPlansMapping[e]?.unwrap;if(null!=t&&Ge()(t,[])||Tr.updateItemsInOrInitializeObservableContainer([],this.containerToPlansMapping,e),this.userJoinedGroupContainerIds[St.K.Group]||(this.userJoinedGroupContainerIds[St.K.Group]=new pr([])),this.userJoinedGroupContainerIds[St.K.Group].contains(e))throw new Error("InvalidOperationException: group membership already exists");return this.userJoinedGroupContainerIds[St.K.Group].add(e),!0}handleFailedGroupCreation(e){if(!this.userJoinedGroupContainerIds[St.K.Group]?.contains(e))throw new Error("InvalidOperationException: groupId not found in store");return delete this.containerToPlansMapping[e],this.userJoinedGroupContainerIds[St.K.Group].remove(e),!0}handleSuccessfulGroupCreation(e,t){if(e===t)return!1;if(null==this.containerToPlansMapping[e])throw new Error("InvalidOperationException: mapping not found in store");if(!this.userJoinedGroupContainerIds[St.K.Group]?.contains(e))throw new Error("InvalidOperationException: oldGroupId not found in store");const n=this.containerToPlansMapping[e];return delete this.containerToPlansMapping[e],this.containerToPlansMapping[t]=n,ps()(this.resolvedContainerIds,e=>e===t)||this.resolvedContainerIds.push(t),this.userJoinedGroupContainerIds[St.K.Group].upsert(e,t),!0}handleMultiplePlanFetch(e){let t=!1;return Lt()(e,e=>{t=this.ensureContainerMappingInStore(e.plan.container,e.id)||t}),t}ensureContainerMappingInStore(e,t){const{externalId:n,containerType:r}=e;let s=!1;return r===St.K.Project||(this.containerToPlansMapping[n]?.contains(t)||(Tr.addItemToOrInitializeObservableContainer(t,this.containerToPlansMapping,n),yr.o.isPlexTempId(t)||this.addPlanIdToUserPlans(t,e.containerType),s=!0),null!=this.planToContainerMapping[t]&&this.planToContainerMapping[t]===n||(this.planToContainerMapping[t]=n,s=!0)),s}removeMappingInStore(e,t){if(null==this.containerToPlansMapping[e])throw new Error("UnexpectedException: relevant container's plan mapping list not found in mapping store");if(!this.containerToPlansMapping[e].contains(t))throw new Error("InvalidOperationException: plan not found in mapping list");return this.containerToPlansMapping[e].remove(t),delete this.planToContainerMapping[t],!0}updateMappingInStore(e,t,n){if(null==this.containerToPlansMapping[e.externalId])throw new Error("UnexpectedException: relevant container's plan mapping list not found in mapping store");if(!this.containerToPlansMapping[e.externalId].contains(t))throw new Error("InvalidOperationException: plan not found in mapping list");return t!==n&&(this.containerToPlansMapping[e.externalId].upsert(t,n),delete this.planToContainerMapping[t],this.planToContainerMapping[n]=e.externalId,this.addPlanIdToUserPlans(n,e.containerType),!0)}handleDeleteUnifiedGroupSucceededAction(e){let t=!1;this.userJoinedGroupContainerIds[St.K.Group]?this.userJoinedGroupContainerIds[St.K.Group].contains(e.container.externalId)&&(this.userJoinedGroupContainerIds[St.K.Group].remove(e.container.externalId),t=!0):this.userJoinedGroupContainerIds[St.K.Group]=new pr([]);const n=this.containerToPlansMapping[e.container.externalId]?.unwrap;return null!=n&&(this.removePlanIdsFromStore(n,e.container.containerType),n.forEach(e=>{delete this.planToContainerMapping[e]}),delete this.containerToPlansMapping[e.container.externalId],t=!0),t}addMembershipInStore(e,t){if(this.userJoinedGroupContainerIds[t]){if(this.userJoinedGroupContainerIds[t].contains(e))throw new Error("InvalidOperationException: group membership already exists")}else this.userJoinedGroupContainerIds[t]=new pr([]);return this.userJoinedGroupContainerIds[t].add(e),Lt()(this.containerToPlansMapping[e]?.unwrap,e=>{this.addPlanIdToUserPlans(e,t)}),!0}removeMembershipInStore(e,t){if(this.userJoinedGroupContainerIds[t]||(this.userJoinedGroupContainerIds[t]=new pr([])),!this.userJoinedGroupContainerIds[t].contains(e))throw new Error("InvalidOperationException: groupId not found in store");this.userJoinedGroupContainerIds[t].remove(e);const n=this.containerToPlansMapping[e]?.unwrap;return n&&this.removePlanIdsFromStore(n,t),!0}handleGetJoinedGroupsSucceededAction(e){let t=!1;return e.isFirstPage?(this.userJoinedGroupContainerIds[St.K.Group]=new pr(e.joinedGroups.map(e=>e.id)),t=!0):Lt()(e.joinedGroups,e=>{null!=e&&(this.userJoinedGroupContainerIds[St.K.Group].contains(e.id)||(this.userJoinedGroupContainerIds[St.K.Group].add(e.id),t=!0))}),t}handleGetContainersSucceededAction(e){let t=!1;return e.isFirstPage?(this.userJoinedGroupContainerIds[e.containerType]=new pr(e.containers.map(e=>e.externalId)),t=!0):Lt()(e.containers,n=>{this.userJoinedGroupContainerIds[e.containerType].contains(n.externalId)||(this.userJoinedGroupContainerIds[e.containerType].add(n.externalId),t=!0)}),t}handleGetContainerSucceededAction(e){const{externalId:t,containerType:n}=e.container;if(n===St.K.Group){const t=e.container;if(null==t.unifiedGroupDetails||t.unifiedGroupDetails.currentUserRelationToGroup===Pt.N.NonMember)return!1}return this.userJoinedGroupContainerIds[n]?!this.userJoinedGroupContainerIds[n].contains(t)&&(this.userJoinedGroupContainerIds[n].add(t),!0):(this.userJoinedGroupContainerIds[n]=new pr([t]),!0)}handleGetUnifiedGroupDetailsSucceededAction(e){return e.unifiedGroupDetails.currentUserRelationToGroup!==Pt.N.NonMember&&(this.userJoinedGroupContainerIds[St.K.Group]?!this.userJoinedGroupContainerIds[St.K.Group].contains(e.unifiedGroupDetails.id)&&(this.userJoinedGroupContainerIds[St.K.Group].add(e.unifiedGroupDetails.id),!0):(this.userJoinedGroupContainerIds[St.K.Group]=new pr([e.unifiedGroupDetails.id]),!0))}constructor(){super(),this.userJoinedGroupContainerIds={},this.userContainerPlanIds={},this.containerToPlansMapping={},this.planToContainerMapping={},this.resolvedContainerIds=[],this.isUSAndMsitTenantMember=!1}}var ms=n(28673),fs=n.n(ms),ys=n(55637),vs=n(88786),ks=n(32084),Ts=n(58245),Ss=n(19879),bs=n(72261),Is=n(77292),Cs=n(51873),Ds=n(95799),Es=n(9614),Ps=n(78751),ws=n(85224),xs=n(8165),Fs=n(24590),As=n(3519),Ls=n(86697),_s=n(65060),Us=n(31364),Os=n(44227),Bs=n(88457),Ms=n(6189);class Ns{get value(){return this._subject.value}get valueObservable(){return this._observable}update(e){this._subject.next(Dn()(e))}constructor(e,t){this.customComparator=t,this._subject=new or(Dn()(e)),this._observable=this._subject.asObservable().pipe(ur((e,t)=>Pn()(e,t,this.customComparator)))}}class Rs extends be.z{get name(){return"PlannerContainerStore"}getContainer(e){return this.containers[e]?.value??null}getContainers(e){return e.filter(e=>null!=this.containers[e]?.value).map(e=>this.containers[e].value)}getContainersByContainerType(e){const t=this.containerIdsByContainerType[e];return null==t?null:t.filter(e=>null!=this.containers[e]?.value).map(e=>this.containers[e].value)}getContainerConversationThread(e,t){const n=this.groupConversationThreads[e];return null!=n?n[t]?.unwrap??null:null}isThreadNotFound(e,t){const n=this.notFoundThreads[e];if(null==n)return!1;const r=n[t];return null!=r&&r}getContainerPhotoById(e){return this.groupPhotosContainer[e]?.value??null}handleAction(e){let t=!1;switch(e.type){case ks.x.actionType:this.handleCleanConversationThreadAction(e);break;case Os.A.actionType:t=this.handleCreateRosterContainerSucceededAction(e);break;case as.K.actionType:t=this.handleCreateUnifiedGroupAction(e);break;case os.b.actionType:t=this.handleCreateUnifiedGroupFailedAction(e);break;case ls.x.actionType:t=this.handleCreateUnifiedGroupSucceededAction(e);break;case ct.P.actionType:t=this.handleGetUnifiedGroupDetailsSucceededAction(e);break;case cs.F.actionType:t=this.handleGetJoinedGroupsSucceededAction(e);break;case Ts.W.actionType:t=this.handleGetGroupPhotosSuccess(e);break;case Ss.k.actionType:t=this.handleGetUnifiedGroupSensitivityLabelSucceededAction(e);break;case bs.c.actionType:t=!0;break;case Is.v.actionType:t=this.handleUpdateUnifiedGroup(e);break;case Cs.w.actionType:t=this.handleUpdateUnifiedGroupFailure(e);break;case Ds.U.actionType:t=this.handleUpdateUnifiedGroupSucceeded(e);break;case ys.G.actionType:t=this.handleUpdateContainerSucceededAction(e);break;case Es.H.actionType:t=this.handleDeleteUnifiedGroup(e);break;case Ps.W.actionType:t=this.handleDeleteUnifiedGroupFailure(e);break;case lt.s.actionType:t=this.handleDeleteUnifiedGroupSucceeded(e);break;case vs.D.actionType:t=this.handleGetConversationThreadPostSucceededAction(e);break;case ws.f.actionType:t=this.handleGetConversationThreadSucceededAction(e);break;case xs.q.actionType:t=this.handlePostConversationThreadReplyAction(e);break;case Fs.B.actionType:t=this.handleCreateConversationThreadAction(e);break;case As.M.actionType:t=this.handleCreateConversationThreadFailedAction(e);break;case Ls.E.actionType:t=this.handleCreateConversationThreadSucceededAction(e);break;case _s.d.actionType:t=this.handlePostConversationThreadReplyFailedAction(e);break;case Us.z.actionType:t=this.handlePostConversationThreadReplySucceededAction(e);break;case ut.w.actionType:t=this.handleJoinUnifiedGroupSucceededAction(e);break;case ht.v.actionType:t=this.handleLeaveUnifiedGroupSucceededAction(e);break;case yt.L.actionType:t=this.handleContainerSucceededAction(e);break;case rs.A.actionType:t=this.handleGetContainersSucceededAction(e);break;default:return}t&&this.publishStoreChangedEvent()}handleJoinUnifiedGroupSucceededAction(e){const t=this.getGroupStoreContainer(e.containerId),n=t?.unifiedGroupDetails??null;if(null==n)throw new Error("AggregateException: unifiedGroupDetails not found in store");let r=!1;if(n.currentUserRelationToGroup!==Pt.N.Member){const e=n.toWebSerializable();e.CurrentUserRelationToGroup=Pt.N.Member;const s=Ms.y.builder.fromUnifiedGroupDetailsResource(e).build(),i=new Bs.Z(n.id,t.unifiedGroup,s);this.containers[n.id].update(i),r=!0}return r}handleLeaveUnifiedGroupSucceededAction(e){const t=this.getGroupStoreContainer(e.containerId),n=t?.unifiedGroupDetails??null;if(null==n)throw new Error("AggregateException: unifiedGroupDetails not found in store");let r=!1;if(n.currentUserRelationToGroup!==Pt.N.NonMember){const e=n.toWebSerializable();e.CurrentUserRelationToGroup=Pt.N.NonMember;const s=Ms.y.builder.fromUnifiedGroupDetailsResource(e).build(),i=new Bs.Z(n.id,t.unifiedGroup,s);this.containers[n.id].update(i),r=!0}return r}handleDeleteUnifiedGroup(e){const t=this.getGroupStoreContainer(e.unifiedGroupId);if(null==(t?.unifiedGroup??null))throw new Error("AggregateException: unifiedGroup not found in store");return!0}handleDeleteUnifiedGroupFailure(e){const t=this.getGroupStoreContainer(e.unifiedGroupId);if(null==(t?.unifiedGroup??null))throw new Error("AggregateException: unifiedGroup not found in store");return!0}handleDeleteUnifiedGroupSucceeded(e){const t=this.getGroupStoreContainer(e.container.externalId),n=t?.unifiedGroup??null;if(null==n)throw new Error("AggregateException: unifiedGroup not found in store");return delete this.containers[n.id],!0}handleCreateRosterContainerSucceededAction(e){return this.containers[e.container.externalId]=new Ns(e.container),this.containerIdsByContainerType[St.K.Roster]=[...this.containerIdsByContainerType[St.K.Roster]??[],e.container.externalId],!0}handleCreateUnifiedGroupAction(e){const t=yr.o.isPlexTempId(e.unifiedGroup.id),n=new Bs.Z(e.unifiedGroup.id,e.unifiedGroup,null);return t&&null!=this.containers[e.unifiedGroup.id]||(this.containers[e.unifiedGroup.id]=new Ns(n)),!0}handleCreateUnifiedGroupFailedAction(e){if(null==this.getGroupStoreContainer(e.localId))throw new Error("AggregateException: group not found in store");return delete this.containers[e.localId],!0}handleCreateUnifiedGroupSucceededAction(e){if(null==this.containers[e.localId])throw new Error("AggregateException: group not found in store");if(e.localId===e.unifiedGroup.id)return!1;delete this.containers[e.localId];const t=new Bs.Z(e.unifiedGroup.id,e.unifiedGroup,null);return this.containers[e.unifiedGroup.id]=new Ns(t),!0}handleContainerSucceededAction(e){const t=this.containers[e.container.externalId];return e.container.containerType===St.K.Group?this.handleGetUnifiedGroupContainer(e.container):e.container.containerType===St.K.Roster?this.handleGetRosterContainer(e.container):null==t&&(this.containers[e.container.externalId]=new Ns(e.container),!0)}handleGetUnifiedGroupContainer(e){let t=!1;const n=e.unifiedGroup;if(null!=n){const e=this.getGroupStoreContainer(n.id),r=e?.unifiedGroup??null;null!=r&&Ge()(r,n)||(this.containers[n.id]=new Ns(new Bs.Z(n.id,n,e?.unifiedGroupDetails??null)),t=!0),null==this.groupConversationThreads[n.id]&&(this.groupConversationThreads[n.id]={},t=!0)}return t}handleGetRosterContainer(e){const t=this.getRosterStoreContainer(e.externalId);let n=!1;return null!=t&&Ge()(t,e)||(this.containers[e.externalId]=new Ns(e),n=!0),n}handleGetUnifiedGroupDetailsSucceededAction(e){let t=!1;const n=e.unifiedGroupDetails;if(null!=n){const e=this.getGroupStoreContainer(n.id);if(null==e)throw new Error("AggregateException: group not found in store");const r=e.unifiedGroupDetails;null!=r&&Ge()(r,n)||(this.containers[n.id]=new Ns(new Bs.Z(n.id,e.unifiedGroup,n)),t=!0),null==this.groupConversationThreads[n.id]&&(this.groupConversationThreads[n.id]={},t=!0)}return t}handleGetJoinedGroupsSucceededAction(e){let t=!1;return Lt()(e.joinedGroups,e=>{if(null!=e){const n=this.getGroupStoreContainer(e.id),r=n?.unifiedGroup??null;null!=r&&Ge()(r,e)||(this.containers[e.id]=new Ns(new Bs.Z(e.id,e,n?.unifiedGroupDetails??null)),t=!0),null==this.groupConversationThreads[e.id]&&(this.groupConversationThreads[e.id]={},t=!0)}}),t}handleGetGroupPhotosSuccess(e){const t=fs()(e.groupPhotos);let n=!1;return Lt()(t,t=>{const r=this.groupPhotosContainer[t]?.value;r!==e.groupPhotos[t]&&(null==r?this.groupPhotosContainer[t]=new Ns(e.groupPhotos[t]):this.groupPhotosContainer[t].update(e.groupPhotos[t]),n=!0)}),n}handleGetUnifiedGroupSensitivityLabelSucceededAction(e){const t=this.getGroupStoreContainer(e.groupId);let n=t?.unifiedGroup??null;if(null==n||null==t)throw new Error("AggregateException: unifiedGroup not found in store");let r=!1;return Ge()(n.assignedSensitivityLabelId,e.sensitivityLabelId)||(n=n.setProperty("assignedSensitivityLabelId",e.sensitivityLabelId),this.containers[n.id]=new Ns(new Bs.Z(n.id,n,t.unifiedGroupDetails)),r=!0),r}handleUpdateUnifiedGroup(e){const t=this.getGroupStoreContainer(e.group.id),n=t?.unifiedGroup??null;if(null==n)throw new Error("AggregateException: unifiedGroup not found in store");let r=!1;return Ge()(n,e.group)||(this.containers[n.id]=new Ns(new Bs.Z(n.id,e.group,t.unifiedGroupDetails)),r=!0),r}handleUpdateUnifiedGroupFailure(e){const t=this.getGroupStoreContainer(e.originalGroup.id),n=t?.unifiedGroup??null;if(null==n)throw new Error("AggregateException: unifiedGroup not found in store");let r=!1;return Ge()(n,e.originalGroup)||(this.containers[n.id]=new Ns(new Bs.Z(n.id,e.originalGroup,t.unifiedGroupDetails)),r=!0),r}handleUpdateUnifiedGroupSucceeded(e){const t=this.getGroupStoreContainer(e.group.id),n=t?.unifiedGroup??null;if(null==n)throw new Error("AggregateException: unifiedGroup not found in store");let r=!1;return Ge()(n,e.group)||(this.containers[n.id]=new Ns(new Bs.Z(n.id,e.group,t.unifiedGroupDetails)),r=!0),r}handleUpdateContainerSucceededAction(e){const t=this.getRosterStoreContainer(e.container.externalId);if(null==t)throw new Error("AggregateException: roster container not found in store");let n=!1;return Ge()(t,e.container)||(this.containers[t.externalId]=new Ns(e.container),n=!0),n}handleGetConversationThreadSucceededAction(e){let t=!1,n=this.groupConversationThreads[e.groupId];return null==n&&(n={},t=!0),null!=n[e.threadId]&&Ge()(n[e.threadId].unwrap,e.conversationThread)||(Tr.updateItemsInOrInitializeObservableContainer(e.conversationThread,n,e.threadId,fr.lz.isEqualMomentCustomizer),t=!0),t&&(this.groupConversationThreads[e.groupId]=n),t}handleCreateConversationThreadAction(e){const t=e.groupId,n=e.threadId;let r=this.groupConversationThreads[t];return null==r&&(r={}),Tr.addItemToOrInitializeObservableContainer(e.newPost,r,n,fr.lz.isEqualMomentCustomizer),this.groupConversationThreads[t]=r,!0}handleGetConversationThreadPostSucceededAction(e){let t=!1;const n=this.groupConversationThreads[e.groupId];if(null==n)return!1;const r=e.conversationThreadPost,s=n[e.threadId].unwrap,i=[];return null!==s&&(Lt()(s,e=>{e.id===r.id?i.push(r):i.push(e)}),Tr.updateItemsInOrInitializeObservableContainer(i,n,e.threadId,fr.lz.isEqualMomentCustomizer),t=!0),t&&(this.groupConversationThreads[e.groupId]=n),t}handleCreateConversationThreadFailedAction(e){let t=!1;const n=e.groupId,r=e.threadId,s=this.groupConversationThreads[n];if(null==s)return!1;return null!=s[r]&&(delete s[r],t=!0),t&&(this.groupConversationThreads[n]=s),t}handleCreateConversationThreadSucceededAction(e){const t=e.groupId,n=e.localThreadId,r=e.threadId,s=this.groupConversationThreads[t];if(null==s)throw new Error("NotFoundException: groupConversationThread");const i=s[n];return i.upsert(e.localPost,e.newPost),n!==r&&(delete s[n],s[r]=i),this.groupConversationThreads[t]=s,!0}handlePostConversationThreadReplyAction(e){const t=e.groupId,n=e.threadId,r=this.groupConversationThreads[t];return null==r||null==r[n]?(this.loggers.traceLogger.logTrace(507832320,Mt.k.Info,null==r?`PostConversationThreadReply groupThreads are null groupId=[${t}] threadId=[${n}]`:`PostConversationThreadReply thread is null groupId=[${t}] threadId=[${n}]`),!1):(r[n].add(e.newPost),this.groupConversationThreads[t]=r,!0)}handlePostConversationThreadReplyFailedAction(e){const t=e.groupId,n=e.threadId,r=this.groupConversationThreads[t];if(null==r)return this.loggers.traceLogger.logTrace(507832291,Mt.k.Warning,`PostConversationThreadReplyFailed groupThreads are null groupId=[${t}] threadId=[${n}]`),!1;const s=r[n];return null==s?(this.loggers.traceLogger.logTrace(507832290,Mt.k.Info,`PostConversationThreadReplyFailed thread is null groupId=[${t}] threadId=[${n}]`),!1):(s.remove(e.newPost),r[n]=s,this.groupConversationThreads[t]=r,!0)}handlePostConversationThreadReplySucceededAction(e){const t=e.groupId,n=e.threadId,r=this.groupConversationThreads[t];if(null==r||null==r[n])return this.loggers.traceLogger.logTrace(507832289,Mt.k.Warning,null==r?`PostConversationThreadReplySucceeded groupThreads are null groupId=[${t}] threadId=[${n}]`:`PostConversationThreadReplySucceeded thread is null groupId=[${t}] threadId=[${n}]`),!1;return r[n].upsert(e.localPost,e.newPost),this.groupConversationThreads[t]=r,!0}handleCleanConversationThreadAction(e){let t=this.groupConversationThreads[e.groupId];null==t&&(t={}),delete t[e.threadId],this.groupConversationThreads[e.groupId]=t;let n=this.notFoundThreads[e.groupId];n||(n={}),n[e.threadId]=!0,this.notFoundThreads[e.groupId]=n}handleGetContainersSucceededAction(e){let t=!1;e.isFirstPage&&(this.containerIdsByContainerType[e.containerType]=[],t=!0);const n=e.containers,r=n.map(e=>e.externalId),s=this.containerIdsByContainerType[e.containerType];return null==s?(this.containerIdsByContainerType[e.containerType]=r,t=!0):r.forEach(e=>{-1===s.indexOf(e)&&(s.push(e),t=!0)}),n.forEach(e=>{null==this.containers[e.externalId]&&(this.containers[e.externalId]=new Ns(e),t=!0)}),t}getGroupStoreContainer(e){const t=this.containers[e]?.value;return t?.containerType===St.K.Group?t:null}getRosterStoreContainer(e){const t=this.containers[e]?.value;return t?.containerType===St.K.Roster?t:null}constructor(e){super(),this.loggers=e,this.containers={},this.containerIdsByContainerType={},this.groupConversationThreads={},this.groupPhotosContainer={},this.notFoundThreads={}}}var Gs=n(53211),Ws=n(7574);class zs extends $.r{constructor(e){super(zs.actionType),this.planId=e}}zs.actionType="PLW_REMOVE_PLAN_FROM_RECOMMENDED_LIST";class js extends $.r{loggingData(){return{recommendedPlanCount:String(this.planIds.length)}}constructor(e){super(js.actionType),this.planIds=e}}js.actionType="PLW_SET_RECOMMENDED_PLANS";var Ks=n(35879),Hs=n(89190),Vs=n(28242),Zs=n(42045),qs=n(79387),Ys=n(51710),$s=n(73615);class Js extends $.r{constructor(e,t){super(Js.actionType),this.updatedPlanEntitySet=e,this.updateKey=t}}Js.actionType="PLW_MOVE_PLAN";class Xs extends $.r{constructor(e,t){super(Xs.actionType),this.movedPlanEntitySet=e,this.updateKey=t}}Xs.actionType="PLW_MOVE_PLAN_SUCCEEDED";class Qs extends $.r{constructor(e,t){super(Qs.actionType),this.planId=e,this.updateKey=t}}Qs.actionType="PLW_MOVE_PLAN_FAILED";var ei=n(63148),ti=n(87920),ni=n(24322),ri=n(40468),si=n(56707),ii=n.n(si);class ai extends be.z{get name(){return"PlannerPlanStore"}resolveLocalPlanId(e){return this.localIdToServiceIdMap[e]??null}deleteLocalPlanId(e){delete this.localIdToServiceIdMap[e]}getPlan(e){return this.plansByInternalId[e]?.value??null}getPlanStatus(e){return this.planStatusesByInternalId[e]??null}getPlanByExternalId(e,t){const n=In.x.generateEntityExternalId(e,t),r=this.externalIdToIdMap[n];return null==r?null:this.getPlan(r)}getRecommendedPlanIds(){return this.recommendedPlanIds.filter(e=>this.favoritedRecommendedPlanIds.indexOf(e)<0)}getPlanWithoutPendingUpdates(e){return this.plansByInternalId[e]?.baseline??null}getPlanDetails(e){return this.planDetails[e]?.value??null}getPlanDetailsWithoutPendingUpdates(e){return this.planDetails[e]?.baseline??null}getContainerIdForPlan(e){return this.plansByInternalId[e]?.baseline.container.externalId??null}getContainerIdForMovePlan(e){return this.movePlanStatus[e]?.containerId??null}getMovePlanStatus(e){return this.movePlanStatus[e]?.transactionStatus??void 0}handleAction(e){let t=!1;switch(e.type){case Je.O.actionType:const n=e;t=this.handleOptimisticPlanCreation(n);break;case Qe.V.actionType:const r=e;t=this.handlePlanCreationFailure(r);break;case et.t.actionType:const s=e;t=this.handlePlanCreationSuccess(s);break;case ss.actionType:const i=e;t=this.handlePlansFetch(i.plans);break;case Gs.Q.actionType:const a=e;t=this.handleStartPlanFetch(a.planId);break;case Xe.$.actionType:const o=e;t=this.handlePlanFetch(o.planEntitySet);break;case Ws.j.actionType:const l=e;t=this.handlePlanFetchFailure(l);break;case Ye.A.actionType:const c=e;t=this.handleMultiPlanFetch(c.plans);break;case $e.N.actionType:const d=e;t=this.handleMultiPlanFetch(d.plans);break;case is.C.actionType:const u=e;t=this.handleMultiPlanFetch(u.plans);break;case zs.actionType:const h=e;t=this.handleRecommendedPlanRemoval(h.planId);break;case js.actionType:const p=e;t=this.handleRecommendedPlansFetch(p.planIds);break;case ot.T.actionType:const g=e;ii()(g.groupPlanMapping).forEach(e=>{e?.forEach(e=>{t=this.handlePlanFetch(ri.T.builder.withPlan(e).build())||t})});break;case pt.f.actionType:const m=e;ii()(m.containerPlanMapping).forEach(e=>{e?.forEach(e=>{t=this.handlePlanFetch(ri.T.builder.withPlan(e).build())||t})});break;case Ks.U.actionType:const f=e;t=this.handleUpdatePlanEntityAction(f);break;case Hs.F.actionType:const y=e;t=this.handleUpdatePlanEntitySucceededAction(y);break;case Vs.R.actionType:const v=e;t=this.handleUpdatePlanEntityFailedAction(v);break;case ti.w.actionType:const k=e;t=this.handleUpdateUserDetailsAction(k);break;case Zs.Z.actionType:const T=e;t=this.handleDiffSyncUpdatePlanEntity(T);break;case qs.T.actionType:t=this.handleDiffSyncUpdatePlanDetails(e.details);break;case He.z.actionType:const S=e;t=this.handleUpdateUserDetailsAction(S);break;case Ys.H.actionType:t=this.handlePlanDeletion(e);break;case qe.Y.actionType:t=this.handlePlanDeletionSuccess(e);break;case $s.U.actionType:t=this.handlePlanDeletionFailure(e);break;case Ke.l.actionType:t=this.handleDiffSyncDeletePlan(e);break;case tt.actionType:const b=e;t=this.handlePlanFetch(b.plan);break;case ni.T.actionType:e.plans.forEach(e=>{t=this.handlePlanFetch(ri.T.builder.withPlan(e).build())||t});break;case Js.actionType:const I=e;t=this.handleMovePlanAction(I.updatedPlanEntitySet,I.updateKey);break;case Xs.actionType:const C=e;t=this.handleMovePlanSucceededAction(C.movedPlanEntitySet,C.updateKey);break;case Qs.actionType:const D=e;t=this.handleMovePlanFailedAction(D);break;case ei.Z.actionType:const E=e;t=this.handleUpdateStatusForMovePlanAction(E);break;default:return}t&&this.publishStoreChangedEvent()}handlePlanDeletion(e){const t=e.planId,n=this.plansByInternalId[t];if(null==n)throw new Error("AggregateException: plan not found in store");return n.softDelete(),!0}handlePlanDeletionFailure(e){const t=e.planId,n=this.plansByInternalId[t];if(null==n)throw new Error("AggregateException: plan not found in store");return n.undelete(),!0}handlePlanDeletionSuccess(e){const t=e.planId,n=this.plansByInternalId[t];if(null==n)throw new Error("AggregateException: plan not found in store");return this.deletePlanFromStore(n.baseline.id),-1!==this.recommendedPlanIds.indexOf(n.baseline.id)&&this.removePlanFromRecommendedList(n.baseline.id),!0}handleDiffSyncDeletePlan(e){const t=e.planId;let n=!1;const r=this.plansByInternalId[t];return null!=r&&(this.deletePlanFromStore(e.planId),-1!==this.recommendedPlanIds.indexOf(r.baseline.id)&&this.removePlanFromRecommendedList(r.baseline.id),n=!0),n}handleUpdatePlanEntityAction(e){let t=!1;const n=e.updatedLocalPlanEntitySet,r=this.plansByInternalId[n.plan.id];if(null==r)throw new Error("AggregateException: plan not found in store");if(Ge()(r.value,n.plan)||(r.pushDelta(n.plan,e.updateKey),t=!0),null!=n.planDetails){const r=this.planDetails[n.planDetails.id];if(null==r)throw new Error("AggregateException: plan details not found in store");Ge()(r.value,n.planDetails)||(r.pushDelta(n.planDetails,e.updateKey),t=!0)}return t}handleUpdatePlanEntityFailedAction(e){let t=!1;const n=e.originalPlanEntitySet,r=this.plansByInternalId[n.plan.id];if(null==r)throw new Error("AggregateException: plan not found in store");if(r.getDelta(e.updateKey)&&(r.revertDelta(e.updateKey),t=!0),n.planDetails){const r=this.planDetails[n.planDetails.id];if(null==r)throw new Error("AggregateException: plan details not found in store");r.getDelta(e.updateKey)&&(r.revertDelta(e.updateKey),t=!0)}return t}handleUpdatePlanEntitySucceededAction(e){let t=!1;const n=e.updatedPlanEntitySet,r=this.plansByInternalId[n.plan.id];if(null==r)throw new Error("AggregateException: plan not found in store");if(r.getDelta(e.updateKey)&&(r.commitDelta(e.updateKey,n.plan),t=!0),n.planDetails){const r=this.planDetails[n.planDetails.id];if(null==r)throw new Error("AggregateException: plan details not found in store");r.getDelta(e.updateKey)&&(r.commitDelta(e.updateKey,n.planDetails),t=!0)}return t}handleMovePlanAction(e,t){let n=!1;const r=this.plansByInternalId[e.plan.id];if(null==r)throw new Error("AggregateException: plan not found in store");return Ge()(r.value,e.plan)||(r.pushDelta(e.plan,t),this.movePlanStatus[e.plan.id]={containerId:e.plan.externalId,transactionStatus:Te.x.Pending},n=!0),n}handleMovePlanSucceededAction(e,t){let n=!1;const r=this.plansByInternalId[e.plan.id];if(null==r)throw new Error("AggregateException: plan not found in store");return r.getDelta(t)&&(r.commitDelta(t,e.plan),this.movePlanStatus[e.plan.id]={containerId:e.plan.container.externalId,transactionStatus:Te.x.Succeeded},n=!0),n}handleMovePlanFailedAction(e){const{planId:t,updateKey:n}=e,r=this.plansByInternalId[e.planId];if(null==r)throw new Error("AggregateException: plan not found in store");return!!r.getDelta(n)&&(r.revertDelta(n),this.movePlanStatus[t]={containerId:r.value.container.externalId,transactionStatus:Te.x.Failed},!0)}handleUpdateStatusForMovePlanAction(e){return null===e.planMoveData.containerId&&void 0===e.planMoveData.transactionStatus?delete this.movePlanStatus[e.planId]:this.movePlanStatus[e.planId]=e.planMoveData,!0}handleDiffSyncUpdatePlanEntity(e){const t=e.planEntitySet;let n=!1;const r=this.plansByInternalId[t.plan.id];return Ge()(r?.baseline,t.plan)||(null==r?this.plansByInternalId[t.plan.id]=new gr.w(t.plan):r.updateBaseline(t.plan),n=!0),t.planDetails&&(n=this.handleDiffSyncUpdatePlanDetails(t.planDetails)||n),n}handleDiffSyncUpdatePlanDetails(e){const t=this.planDetails[e.id];return!Ge()(t?.baseline,e)&&(null==t?this.planDetails[e.id]=new gr.w(e):t.updateBaseline(e),!0)}handleUpdateUserDetailsAction(e){let t=!1;const n=e.userDetails.favoritePlans.references,r=this.favoritedRecommendedPlanIds;return Lt()(this.recommendedPlanIds,e=>{if(null!=n[e])this.favoritedRecommendedPlanIds.indexOf(e)<0&&this.favoritedRecommendedPlanIds.push(e);else{const t=this.favoritedRecommendedPlanIds.indexOf(e);t>-1&&this.favoritedRecommendedPlanIds.splice(t,1)}}),Ge()(r,this.favoritedRecommendedPlanIds)||(t=!0),t}handlePlansFetch(e){let t=!1;return Lt()(e,e=>{if(null!=e){const n=this.plansByInternalId[e.id];null==n?(t=!0,this.addPlanToStoreIndexes(new gr.w(e))):Ge()(n.baseline,e)||(n.updateBaseline(e),t=!0)}}),t}handleRecommendedPlansFetch(e){let t=!1;for(const n of e)-1===this.recommendedPlanIds.indexOf(n)&&(this.recommendedPlanIds.push(n),t=!0);return t}handleRecommendedPlanRemoval(e){let t=!1;return this.recommendedPlanIds.indexOf(e)>-1&&(this.removePlanFromRecommendedList(e),t=!0),t}handleStartPlanFetch(e){let t=!1;return null!=this.planStatusesByInternalId[e]&&(delete this.planStatusesByInternalId[e],t=!0),t}handlePlanFetch(e){let t=!1;const n=this.plansByInternalId[e.id];if(null==n?(t=!0,this.addPlanToStoreIndexes(new gr.w(e.plan))):Ge()(n.baseline,e.plan)||(n.updateBaseline(e.plan),t=!0),null!=e.planDetails){const n=this.planDetails[e.id];null==n?(t=!0,this.planDetails[e.id]=new gr.w(e.planDetails)):Ge()(n.baseline,e.planDetails)||(n.updateBaseline(e.planDetails),t=!0)}return t}handlePlanFetchFailure(e){let t=!1;if(null==e.planId)return t;const n=this.planStatusesByInternalId[e.planId];return e.response?.status===Ne.t3.Forbidden?n!==I.ZB.Inaccessible&&(this.planStatusesByInternalId[e.planId]=I.ZB.Inaccessible,t=!0):e.response?.status===Ne.t3.NotFound?n!==I.ZB.NotFound&&(this.planStatusesByInternalId[e.planId]=I.ZB.NotFound,t=!0):n!==I.ZB.Failed&&(this.planStatusesByInternalId[e.planId]=I.ZB.Failed,t=!0),t}handleMultiPlanFetch(e){let t=!1;return e.forEach(e=>{t=this.handlePlanFetch(e)||t}),t}handleOptimisticPlanCreation(e){const t=e.planEntitySet;if(null!=this.plansByInternalId[t.id])throw new Error("AggregateException: plan already exists in store");return this.plansByInternalId[t.id]=new gr.w(t.plan),t.planDetails&&(this.planDetails[t.id]=new gr.w(t.planDetails)),!0}handlePlanCreationFailure(e){const t=e.planEntitySet,n=this.plansByInternalId[t.id];if(null==n)throw new Error("AggregateException: plan not found in store");return delete this.plansByInternalId[n.baseline.id],delete this.planDetails[n.baseline.id],!0}handlePlanCreationSuccess(e){const t=e.planEntitySet,n=e.localId,r=this.plansByInternalId[n];if(null==r)throw new Error("AggregateException: plan not found in store");this.deletePlanFromStore(n),r.updateBaseline(t.plan),this.addPlanToStoreIndexes(r);const s=this.planDetails[n];return delete this.planDetails[n],t.planDetails&&(null==s?this.planDetails[t.id]=new gr.w(t.planDetails):(s.updateBaseline(t.planDetails),this.planDetails[t.id]=s)),this.localIdToServiceIdMap[n]=t.plan.id,!0}addPlanToStoreIndexes(e){const t=e.value.id;this.plansByInternalId[t]=e,this.planStatusesByInternalId[t]=I.ZB.Stable;const n=e.value.externalId;null!=n&&(this.externalIdToIdMap[n]=t)}deletePlanFromStore(e){if(null==e)return;const t=this.plansByInternalId[e].value.externalId;delete this.planDetails[e],delete this.plansByInternalId[e],delete this.planStatusesByInternalId[e],null!=t&&delete this.externalIdToIdMap[t]}removePlanFromRecommendedList(e){const t=this.recommendedPlanIds.indexOf(e);-1!==t&&this.recommendedPlanIds.splice(t,1)}constructor(){super(),this.plansByInternalId={},this.planStatusesByInternalId={},this.planDetails={},this.localIdToServiceIdMap={},this.externalIdToIdMap={},this.recommendedPlanIds=[],this.favoritedRecommendedPlanIds=[],this.movePlanStatus={}}}var oi=n(74236),li=n(79757),ci=n(69292),di=n(96693),ui=n(40164),hi=n(45721),pi=n(26715),gi=n(23614),mi=n(80837),fi=n(77910),yi=n(55694),vi=n(45795),ki=n(16701),Ti=n(35525),Si=n(72866),bi=n(62687);class Ii{get(e){const t=this.cache.get(e);return t&&(this.cache.delete(e),this.cache.set(e,t)),t}set(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.max){const e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,t)}dump(){return Array.from(this.cache.entries()).map(e=>{let[t,n]=e;return{k:t,v:n}})}keys(){return Array.from(this.cache.keys())}load(e){this.cache.clear(),e.forEach(e=>{let{k:t,v:n}=e;this.set(t,n)})}delete(e){return this.cache.delete(e)}constructor(e){if(this.cache=new Map,e<=0)throw new Error("Max should be a positive number");this.max=e}}class Ci{get(e){return this.lruCache.get(e)}set(e,t){this.lruCache.set(e,t),this.persistCache()}load(e){this.lruCache.load(e)}keys(){return this.lruCache.keys()}delete(e){const t=this.lruCache.delete(e);return this.persistCache(),t}persistCache(){const e=this.lruCache.dump();this.persistedStorage.setItem(this.storageKey,JSON.stringify(e))}dump(){return this.lruCache.dump()}constructor(e,t,n){this.persistedStorage=e,this.storageKey=t,this.lruCache=new Ii(n)}}class Di extends be.z{get name(){return"PlannerViewStore"}hydrateFromPersistentStorage(){if(!this.persistedStorage)return;if(Z.B.clientType===vi.s.Plex&&!Z.B.isUnoContext&&Z.B.clientSettings.Flights.EnableViewPersistence){const e=this.getStorageKey(Di.TaskGroupingStateKey),t=this.persistedStorage?.getItem(e);if(null!=t)try{this.currentTaskGroupingState=JSON.parse(t),this.loggers.traceLogger.logTrace(506549205,Mt.k.Info,`Hydrated task grouping state [Store=${this.name}][Key=${e}]`)}catch(a){this.loggers.traceLogger.logTrace(507832288,Mt.k.Warning,`Hydration error [Store=ViewStore][Context=TaskGroupingState][Value=${t}]`)}}const e=this.getStorageKey(Di.TaskFiltersKey),t=this.persistedStorage.getItem(e);if(null!=t)try{const n=JSON.parse(t).map(e=>{const t=e.v.filters.map(e=>new Si.d(e.field,e.values));return{...e,v:new Si.S(t)}});this.taskFilterLRUCache.load(n),this.loggers.traceLogger.logTrace(506549204,Mt.k.Info,`Hydrated task filters [Store=${this.name}][Key=${e}]`)}catch(a){this.loggers.traceLogger.logTrace(506848709,Mt.k.Warning,`Hydration error [Store=${this.name}][Key=${e}]`)}const n=this.getStorageKey(Di.SortCriteriaKey),r=this.persistedStorage.getItem(n);if(null!=r)try{const e=JSON.parse(r).reduce((e,t)=>{const n=t.v.primary.field;return this.isValidTaskGridColumnId(n)&&e.push(t),e},[]);this.sortCriteriaLRUCache.load(e),this.loggers.traceLogger.logTrace(506549203,Mt.k.Info,`Hydrated sort criteria [Store=${this.name}][Key=${n}]`)}catch(a){this.loggers.traceLogger.logTrace(506835042,Mt.k.Warning,`Hydration error [Store=${this.name}][Key=${n}]`)}const s=this.getStorageKey(Di.GridColumnWidthKey),i=this.persistedStorage.getItem(s);if(null!=i)try{const e=JSON.parse(i).reduce((e,t)=>{const n=t.v,r={};Object.keys(n).forEach(e=>{this.isValidTaskGridColumnId(e)&&(r[e]=n[e])});const s={...t,v:r};return e.push(s),e},[]);this.gridColumnWidthLRUCache.load(e),this.loggers.traceLogger.logTrace(506549202,Mt.k.Info,`Hydrated grid column widths [Store=${this.name}][Key=${s}]`)}catch(a){this.loggers.traceLogger.logTrace(506783873,Mt.k.Warning,`Hydration error [Store=${this.name}][Key=${s}]`)}}getViewContext(e,t){return null==this.viewContexts[e][t]&&(this.viewContexts[e][t]={isLabelCollapsed:!1}),this.viewContexts[e][t]}getCurrentTaskGroupingState(e){return this.currentTaskGroupingState[e]}getCurrentTaskFilter(e){const t=this.taskFilterLRUCache.get(e);if(null==t){if(Z.B.clientSettings.Flights.Uno_EnableIrisCampaignCallouts&&Z.B.clientSettings.Flights.Uno_EnableDefaultTaskFilterIrisCallout)return new Si.S([]);const e=Z.B.isUnoContext?[ki._6]:[];return new Si.S(e)}return t}getFilterExceptions(){return this.filterExceptions}getSortCriteria(e){const t=this.sortCriteriaLRUCache.get(e);return null==t?null:t}getGridColumnWidths(e){const t=this.gridColumnWidthLRUCache.get(e);return t||null}handleAction(e){let t=!1;switch(e.type){case mi._.actionType:const n=e;t=this.handleSetCategoryLabelModeAction(n);break;case fi.O.actionType:t=this.handleSetTaskFilterAction(e);break;case yi.p.actionType:t=this.updateCurrentTaskGroupingState(e.accessContext,e.taskGrouping),t=this.clearFilterExceptions()||t;break;case oi.s.type:t=this.clearFilterExceptions();break;case li.M.actionType:const r=e;t=this.addTaskIdToFilterExceptions(r.taskEntitySet.id);break;case ci.N.actionType:const s=e;t=this.removeTaskIdFromFilterExceptions(s.taskEntitySet.id);break;case Yt.r.actionType:t=this.handleTaskCreationSuccess(e);break;case di.G.actionType:const i=e;t=this.addTaskIdToFilterExceptions(i.taskEntitySet.id);break;case ui.f.actionType:const a=e;t=this.addTaskIdToFilterExceptions(a.updatedTaskEntitySet.task.id);break;case hi.K.actionType:const o=e;t=this.removeTaskIdFromFilterExceptions(o.originalTaskEntitySet.task.id);break;case Fs.B.actionType:const l=e;t=this.addTaskIdToFilterExceptions(l.task.id);break;case As.M.actionType:const c=e;t=this.removeTaskIdFromFilterExceptions(c.task.id);break;case fn.R.actionType:const d=e;t=this.removeDeletedBucketFromTaskFilter(d.bucketId);break;case Sn.a.actionType:const u=e;t=this.removeDeletedBucketFromTaskFilter(u.bucketId);break;case pi.m.actionType:const h=e;t=this.handleSetSortCriteriaAction(h);break;case gi.J.actionType:const p=e;t=this.handleSetGridColumnWidthAction(p);break;default:return}t&&this.publishStoreChangedEvent()}handleSetCategoryLabelModeAction(e){return null==this.viewContexts[e.accessContext]&&(this.viewContexts[e.accessContext]={}),null==this.viewContexts[e.accessContext][e.contextEntityId]&&(this.viewContexts[e.accessContext][e.contextEntityId]={isLabelCollapsed:!1}),this.viewContexts[e.accessContext][e.contextEntityId].isLabelCollapsed!==e.isCollapsed&&(this.viewContexts[e.accessContext][e.contextEntityId]={...this.viewContexts[e.accessContext][e.contextEntityId],isLabelCollapsed:e.isCollapsed},!0)}updateCurrentTaskGroupingState(e,t){let n=!1;return this.currentTaskGroupingState[e]!==t&&(this.currentTaskGroupingState[e]=t,Z.B.clientType===vi.s.Plex&&!Z.B.isUnoContext&&Z.B.clientSettings.Flights.EnableViewPersistence&&this.persistedStorage?.setItem(this.getStorageKey(Di.TaskGroupingStateKey),JSON.stringify(this.currentTaskGroupingState)),n=!0),n}handleSetTaskFilterAction(e){const{viewKey:t,filter:n}=e;return!Ge()(n,this.taskFilterLRUCache.get(t))&&(this.taskFilterLRUCache.set(t,n),this.filterExceptions={},!0)}clearFilterExceptions(){return Object.keys(this.filterExceptions).length>0&&(this.filterExceptions={},!0)}handleTaskCreationSuccess(e){const t=e.localId,n=e.taskEntitySet.id,r=this.filterExceptions[t];return!!r&&(this.filterExceptions[n]=r,delete this.filterExceptions[t],!0)}addTaskIdToFilterExceptions(e){if(null==e)return!1;let t=!1;for(const n of this.taskFilterLRUCache.keys()){const e=this.taskFilterLRUCache.get(n);e&&e.filters.length>0&&(t=!0)}if(t){let t=this.filterExceptions[e];return this.filterExceptions[e]=t?++t:1,!0}return!1}removeTaskIdFromFilterExceptions(e){return null!=e&&(!!this.filterExceptions[e]&&(this.filterExceptions[e]--,0===this.filterExceptions[e]&&delete this.filterExceptions[e],!0))}removeDeletedBucketFromTaskFilter(e){let t=!1;for(const n of this.taskFilterLRUCache.keys()){const r=this.taskFilterLRUCache.get(n);if(r?.doesFilterValueExist("bucketId",e)){const s=r.toggleFilterValue("bucketId",e);this.taskFilterLRUCache.set(n,s),t=!0}}return t}handleSetSortCriteriaAction(e){const{viewId:t,sortCriteria:n}=e;return null==n?(this.sortCriteriaLRUCache.delete(t),!0):!Ge()(n,this.sortCriteriaLRUCache.get(t))&&(this.sortCriteriaLRUCache.set(t,n),!0)}handleSetGridColumnWidthAction(e){const{viewId:t,columnId:n,columnWidth:r}=e,s=this.gridColumnWidthLRUCache.get(t)??{};return s[n]!==r&&(s[n]=r,this.gridColumnWidthLRUCache.set(t,s),!0)}isValidTaskGridColumnId(e){return Object.values(Ti.xJ).includes(e)}getStorageKey(e){return`${Di.ViewStoreKey}-${e}`}constructor(e,t){super(),this.persistedStorage=e,this.loggers=t,this.viewContexts={},this.viewContexts[bi.t.Plan]={},this.viewContexts[bi.t.User]={},this.viewContexts[bi.t.Workspace]={},this.persistedStorage?this.taskFilterLRUCache=new Ci(this.persistedStorage,this.getStorageKey(Di.TaskFiltersKey),Z.B.clientSettings.ECSSettings.PersistedStorage.Limits.MaxTaskFilters):this.taskFilterLRUCache=new Ii(Z.B.clientSettings.ECSSettings.PersistedStorage.Limits.MaxTaskFilters),this.persistedStorage?this.sortCriteriaLRUCache=new Ci(this.persistedStorage,this.getStorageKey(Di.SortCriteriaKey),Z.B.clientSettings.ECSSettings.PersistedStorage.Limits.MaxSortCriteria):this.sortCriteriaLRUCache=new Ii(Z.B.clientSettings.ECSSettings.PersistedStorage.Limits.MaxSortCriteria),this.persistedStorage?this.gridColumnWidthLRUCache=new Ci(this.persistedStorage,this.getStorageKey(Di.GridColumnWidthKey),Z.B.clientSettings.ECSSettings.PersistedStorage.Limits.MaxGridColumnWidths):this.gridColumnWidthLRUCache=new Ii(Z.B.clientSettings.ECSSettings.PersistedStorage.Limits.MaxGridColumnWidths),this.filterExceptions={},this.currentTaskGroupingState={},this.currentTaskGroupingState[bi.t.Plan]=C.Yc.Bucket,this.currentTaskGroupingState[bi.t.User]=C.Yc.Progress,this.currentTaskGroupingState[bi.t.Workspace]=C.Yc.Plan,this.hydrateFromPersistentStorage()}}Di.ViewStoreKey="vstore",Di.TaskGroupingStateKey="tgs",Di.TaskFiltersKey="tf",Di.SortCriteriaKey="sc",Di.GridColumnWidthKey="gcw";var Ei=n(88458),Pi=n.n(Ei),wi=n(61460),xi=n.n(wi),Fi=n(92394),Ai=n.n(Fi),Li=n(30450),_i=n.n(Li),Ui=n(713),Oi=n(59393),Bi=n(66061),Mi=n(40699),Ni=n(69252),Ri=n(449),Gi=n(73322),Wi=n(48537),zi=n(14e3),ji=n(48475),Ki=n(90506),Hi=n(28571),Vi=n(31316),Zi=n(96020),qi=n(91393),Yi=n(41927),$i=n(43841),Ji=n(34631),Xi=n(10979),Qi=n(85230);class ea extends $.r{loggingData(){return{taskCount:String(this.tasks.length),isFirstPage:String(this.isFirstPage),isLastPage:String(this.isLastPage)}}constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];super(ea.actionType),this.userId=e,this.tasks=t,this.continuationToken=n,this.isFirstPage=r,this.isLastPage=null==n}}ea.actionType="PLW_PREFETCH_USER_TASKS_SUCCEEDED";var ta=n(34717),na=n(32561),ra=n(80708),sa=n(64696),ia=n(39589),aa=n(70252),oa=n(34677),la=n.n(oa),ca=n(36777),da=n.n(ca),ua=n(84048),ha=n.n(ua),pa=n(26727),ga=n.n(pa),ma=n(53988),fa=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ya=function(e){function t(t){var n=e.call(this,t)||this;return n.pendingUpdates=[],n}return fa(t,e),t.prototype.getUpdate=function(e){return ps()(this.pendingUpdates,function(t){return t.key===e})},t.prototype.removeUpdate=function(e){Ce()(this.pendingUpdates,function(t){return t.key===e})},t}(Se.w),va=function(e){function t(){var t=e.call(this)||this;return t.entityData=t.data,t}return fa(t,e),t.prototype.getItem=function(e){return this.applyDeltas(this.entityData.get(e))},t.prototype.getItemExcludeStatuses=function(e,t){if(null==e)return null;var n=this.entityData.get(e);return!n||ha()(t,n.status)?null:this.applyDeltas(n)},t.prototype.getAllItems=function(){var e=this;return Cr()(this.entityData.getAll(),function(t){return e.applyDeltas(t)})},t.prototype.getItemsWithFilter=function(e){var t=this;return ga()(this.data.getAll()).map(function(n){return t.applyDeltasWithFilter(n,e)}).filter(function(e){return void 0!==e})},t.prototype.getPendingUpdateCount=function(e){var t=this.entityData.get(e);return t?t.pendingUpdates.length:0},t.prototype.mergeItem=function(e,t){if(!e)throw new te.L("key");this.entityData.get(e)&&(la()(this.entityData.get(e).item,t),this.updateModifiedDate(e))},t.prototype.mergeItemIntoNewObject=function(e,t){if(!e)throw new te.L("key");if(this.entityData.get(e)){var n=this.entityData.get(e),r=la()({},n.item,t);n.item=r,this.updateModifiedDate(e)}},t.prototype.mergeClonedItemIntoNewObject=function(e,t){if(!e)throw new te.L("key");if(this.entityData.get(e)){var n=this.entityData.get(e),r=la()(Dn()(n.item),t);n.item=r,this.updateModifiedDate(e)}},t.prototype.removeAllItems=function(){e.prototype.removeAllItems.call(this),this.entityData=this.data},t.prototype.setItem=function(e,t){this.data.set(e,new ya(t))},t.prototype.pushUpdate=function(e,t,n){if(!t)throw new te.L("updatedObject");if(!e)throw new te.L("entityKey");if(!n)throw new te.L("updateKey");if(!this.entityData.get(e))throw new ma.c("entityKey","Cannot add an update to entity with key "+e+", the key does not exist");if(this.entityData.get(e).getUpdate(n))throw new ma.c("updateKey","An update with key "+n+" already exists on this entity with key "+e);var r=this.getItem(e);if(null==r)throw new Error("Can't get diff, item is null");var s=r.getDiff(t);s&&(this.entityData.get(e).pendingUpdates.push({diff:s,key:n,updateApplied:!1}),this.updateModifiedDate(e))},t.prototype.commitUpdate=function(e,t){if(!e)throw new te.L("entityKey");if(!t)throw new te.L("updateKey");if(!this.entityData.get(e))throw new ma.c("entityKey","Cannot commit an update to entity with key "+e+", the key does not exist");var n=this.entityData.get(e).getUpdate(t);if(!n)throw new ma.c("updateKey","Could not find an update with key "+t+" on entity with key "+e);this.updateModifiedDate(e),n.updateApplied=!0,this.safelyCommitDeltas(e,!0)},t.prototype.commitAndSetUpdate=function(e,t,n){if(!t)throw new te.L("updatedObject");if(!e)throw new te.L("entityKey");if(!n)throw new te.L("updateKey");if(!this.entityData.get(e))throw new ma.c("entityKey","Cannot commit an update to entity with key "+e+", the key does not exist");var r=this.entityData.get(e).getUpdate(n);r&&(r.updateApplied=!0,this.safelyCommitDeltas(e,!1)),this.entityData.get(e).item=t,this.updateModifiedDate(e)},t.prototype.revertUpdate=function(e,t){if(!e)throw new te.L("entityKey");if(!t)throw new te.L("updateKey");if(!this.entityData.get(e))throw new ma.c("entityKey","Cannot revert an update to entity with key "+e+", the key does not exist");this.entityData.get(e).removeUpdate(t),this.updateModifiedDate(e)},t.prototype.applyDeltas=function(e){if(e){if(e.pendingUpdates.length>0){var t=e.pendingUpdates.map(function(e){return e.diff});if(null==e.item)throw new Error("Can't apply diff, item is null");return e.item.applyDiffs.apply(e.item,t)}return e.item}},t.prototype.applyDeltasWithFilter=function(e,t){if(e){var n=e.item;if(e.pendingUpdates.length>0){var r=e.pendingUpdates.map(function(e){return e.diff});if(null==e.item)throw new Error("Can't apply diff, item is null");n=e.item.applyDiffs.apply(e.item,r)}if(t(n,e.status))return n}},t.prototype.safelyCommitDeltas=function(e,t){var n=this,r=[];Lt()(this.entityData.get(e).pendingUpdates,function(e){if(!e.updateApplied)return!1;r.push(e.key)}),Lt()(r,function(r){var s=n.entityData.get(e),i=s.getUpdate(r);if(i){if(t){if(null==s.item)throw new Error("Can't apply diff, item is null");s.item=s.item.applyDiffs(i.diff)}s.removeUpdate(r)}})},t}(Se.j);class ka extends va{mergeItem(e,t,n){if(this.entityData.get(e)){const r=this.entityData.get(e),s=r.item?.getClone()??null;null!=n?da()(s,t,n):la()(s,t),r.item=s,this.updateModifiedDate(e)}}getItemWithoutDeltas(e){const t=this.entityData.get(e);return null!=t?t.item:null}updateExists(e,t){const n=this.entityData.get(e);if(null!=n){if(null!=n.getUpdate(t))return!0}return!1}constructor(){super()}}var Ta,Sa=n(679),ba=n(31158);!function(e){e.getSimilarTasks=function(e,t){const n=Bt()().subtract(1,"M"),r=t.filter(t=>t.userContentLastModifiedDate?.isAfter(n)&&e.id!==t.id);if(0===r.length)return[];const s=[];for(let c=0;c<r.length;c++)s.push(r[c].title);const i=(0,ba.findBestMatch)(e.title,s),a=[];for(let c=0;c<r.length;c++)a.push({task:r[c],rating:i.ratings[c].rating});a.sort((e,t)=>t.rating-e.rating);const o=[],l=a.length<4?a.length:a.length/4;for(let c=0;c<l;c++)a[c].rating>=.5&&o.push(a[c].task);return o}}(Ta||(Ta={}));var Ia=n(73624),Ca=n(83574),Da=n(89469);class Ea extends be.z{get name(){return"PlannerTaskStore"}getTask(e){return this.tasks.getItem(e)||null}getSimilarTasks(e){const t=e.planId?this.getTasksForPlan(e.planId):[];return t&&0!==t?.length?Ta.getSimilarTasks(e,t):[]}getTaskWithoutPendingUpdates(e){return this.tasks.getItemWithoutDeltas(e)}getTasksForPlan(e){const t=this.planTasksIndex.getItem(e);return null==t?null:Cr()(t,t=>{const n=this.tasks.getItem(t);if(null==n)throw new Error(`IndexCorruptionException: Indexed task not found in Tasks table [TaskId=${t}][PlanId=${e}]`);return n})}getTasksForUser(e){return null==this.userTasksIndex.getItem(e)?null:Cr()(this.userTasksIndex.getItem(e),t=>{const n=this.tasks.getItem(t);if(null==n)throw new Error(`IndexCorruptionException: Indexed task not found in Tasks table [TaskId=${t}][UserId=${e}]`);return n})}getTasksForBucket(e){const t=this.bucketTasksIndex.getItem(e);return null==t?null:Cr()(t,t=>{const n=this.tasks.getItem(t);if(null==n)throw new Error(`IndexCorruptionException: Indexed task not found in Tasks table [TaskId=${t}][BucketId=${e}]`);return n})}getTaskDetails(e){return this.taskDetails.getItem(e)||null}getTaskDetailsWithoutPendingUpdates(e){return this.taskDetails.getItemWithoutDeltas(e)}getTaskboardTaskFormattingForPlan(e,t){if(null==this.planTasksIndex.getItem(e))return null;let n;switch(t){case aa.s.Bucket:n=this.taskboardTaskFormatForBucket;break;case aa.s.AssignedTo:n=this.taskboardTaskFormatForAssignedTo;break;case aa.s.Progress:n=this.taskboardTaskFormatForProgress;break;default:throw new Error("NotImplemented: cannot handle taskboard type "+t)}const r=Cr()(this.planTasksIndex.getItem(e),e=>e),s=Cr()(r,e=>n.getItem(e));return Ai()(s,void 0,null),r.length>0&&s.length<r.length?null:s}getTaskboardTaskFormatting(e){const t=this.taskboardTaskFormatForAssignedTo.getItem(e),n=this.taskboardTaskFormatForBucket.getItem(e),r=this.taskboardTaskFormatForProgress.getItem(e);return t||n||r?ia._.builder.withPropertyBag({assignedBoardFormat:t||void 0,bucketBoardFormat:n||void 0,progressBoardFormat:r||void 0}).build():null}getTaskboardTaskFormattingWithoutPendingUpdates(e){const t=this.taskboardTaskFormatForAssignedTo.getItemWithoutDeltas(e),n=this.taskboardTaskFormatForBucket.getItemWithoutDeltas(e),r=this.taskboardTaskFormatForProgress.getItemWithoutDeltas(e);return t||n||r?ia._.builder.withPropertyBag({assignedBoardFormat:t||void 0,bucketBoardFormat:n||void 0,progressBoardFormat:r||void 0}).build():null}getTaskApprovalDetails(e){return{data:this.taskApprovalDetails.getItem(e)||null,status:this.taskApprovalDetails.getItemStatus(e)??I.ZB.Stable}}isTaskApprovalOperationInProgress(e){return this.isApprovalOperationInProgress[e]??!1}handleAction(e){let t=!1;switch(e.type){case Ui.U.actionType:t=this.handleTaskEntitySetFetchSuccess(e);break;case Oi.q.actionType:t=this.handleTasksForPlanFetchFailure(e);break;case qt.a.actionType:t=this.handleTasksForPlanFetchSuccess(e);break;case Bi.y.actionType:t=this.handleTasksForUserFetchFailure(e);break;case Mi.e.actionType:t=this.handleTasksForUserFetchSuccess(e);break;case Ia.n.actionType:t=this.handleGetTaskApprovalDetails(e);break;case Ca.j.actionType:t=this.handleGetTaskApprovalDetailsSuccess(e);break;case Da.E.actionType:t=this.handleGetTaskApprovalDetailsFailure(e);break;case Ni.x.actionType:t=this.handleCancelTaskApprovalDetails(e);break;case Ri.O.actionType:t=this.handleUpdateTaskApprovalDetails(e);break;case Gi.Z.actionType:t=this.handleCreateTaskApprovalDetails(e);break;case Wi.W.actionType:t=this.handleCancelTaskApprovalDetailsFailure(e);break;case zi.L.actionType:t=this.handleUpdateTaskApprovalDetailsFailure(e);break;case ji.C.actionType:t=this.handleCreateTaskApprovalDetailsFailure(e);break;case li.M.actionType:t=this.handleTaskCreation(e);break;case ci.N.actionType:t=this.handleTaskCreationFailure(e);break;case Yt.r.actionType:t=this.handleTaskCreationSuccess(e);break;case $t.r.actionType:t=this.handleDiffSyncInsertTask(e);break;case qi.p.actionType:t=this.handleDiffSyncInsertTaskDetails(e.taskDetails);break;case Yi.F.actionType:t=this.handleDiffSyncInsertTaskFormats(e.taskFormats);break;case ui.f.actionType:const n=e;t=this.handleTaskUpdate(n.updatedTaskEntitySet.task,n.updatedTaskEntitySet.taskDetails,n.updatedTaskEntitySet.taskFormatData,n.updateKey);break;case hi.K.actionType:const r=e;t=this.handleTaskUpdateFailure(r.originalTaskEntitySet.task,r.originalTaskEntitySet.taskDetails,r.originalTaskEntitySet.taskFormatData,r.updateKey);break;case Jt.U.actionType:const s=e,i=ra.F.hasContentBeenModified(s.originalTaskEntitySet,s.updatedTaskEntitySet);t=this.handleTaskUpdateSuccess(s.updatedTaskEntitySet.task,s.updatedTaskEntitySet.taskDetails,s.updatedTaskEntitySet.taskFormatData,s.updateKey,i);break;case Xt.T.actionType:t=this.handleDiffSyncUpdateTask(e);break;case $i.V.actionType:t=this.handleDiffSyncUpdateTaskDetails(e.updatedTaskDetails);break;case Ji.V.actionType:t=this.handleDiffSyncUpdateTaskFormats(e.updatedFormats);break;case Ki.N.actionType:t=this.handleTaskDeletion(e);break;case Hi.a.actionType:t=this.handleTaskDeletionFailure(e);break;case Qt.o.actionType:t=this.handleTaskDeletionSuccess(e);break;case di.G.actionType:t=this.handleTaskUndeletion(e);break;case Vi.f.actionType:t=this.handleTaskUndeletionFailure(e);break;case Zi.N.actionType:t=this.handleTaskUndeletionSuccess(e);break;case en.D.actionType:t=this.handleDiffSyncDeleteTask(e);break;case fn.R.actionType:t=this.handleDeleteBucketSuccess(e);break;case et.t.actionType:t=this.handlePlanCreationSuccess(e);break;case Fs.B.actionType:const a=e;t=this.handleTaskUpdate(a.task,void 0,void 0,a.updateKey);break;case As.M.actionType:const o=e;t=this.handleTaskUpdateFailure(o.task,void 0,void 0,o.updateKey);break;case Ls.E.actionType:const l=e;t=this.handleTaskUpdateSuccess(l.updatedTask,void 0,void 0,l.updateKey,!0);break;case Xi.I.actionType:t=this.handleCreateUploadSession(e);break;case Qi.t.actionType:const c=e;t=this.handleUploadSessionFailed(c);break;case tt.actionType:const d=e;t=this.handleTasksForPlanFetchSuccess(new qt.a(d.plan.id,d.plan.plan.container.externalId,d.tasks,d.tasksContinuationToken,!0));break;case ea.actionType:const u=e;t=this.handleTasksForUserFetchSuccess(new Mi.e(u.userId,u.tasks,u.continuationToken,u.isFirstPage));break;default:return}t&&this.publishStoreChangedEvent()}handleGetTaskApprovalDetails(e){const t=e.taskId;return null!=t&&""!==t&&(this.taskApprovalDetails.setItemStatus(t,I.ZB.Updating),!0)}handleGetTaskApprovalDetailsSuccess(e){const{taskId:t,taskApprovalDetails:n}=e;if(!t||!n)return!1;const r=this.taskApprovalDetails.getItem(t);return null!=r&&Ge()(r,n)||this.taskApprovalDetails.setItem(t,n),this.taskApprovalDetails.setItemStatus(t,I.ZB.Stable),!0}handleGetTaskApprovalDetailsFailure(e){const{taskId:t}=e;return!!t&&(this.taskApprovalDetails.setItemStatus(t,I.ZB.Failed),!0)}handleCancelTaskApprovalDetails(e){const t=e.taskId;return this.setIsApprovalOperationInProgress(t,!0)}handleUpdateTaskApprovalDetails(e){const t=e.taskId;return this.setIsApprovalOperationInProgress(t,!0)}handleCreateTaskApprovalDetails(e){const t=e.taskId;return this.setIsApprovalOperationInProgress(t,!0)}handleCancelTaskApprovalDetailsFailure(e){const t=e.taskId;return this.setIsApprovalOperationInProgress(t,!1)}handleUpdateTaskApprovalDetailsFailure(e){const t=e.taskId;return this.setIsApprovalOperationInProgress(t,!1)}handleCreateTaskApprovalDetailsFailure(e){const t=e.taskId;return this.setIsApprovalOperationInProgress(t,!1)}setIsApprovalOperationInProgress(e,t){return null!=e&&""!==e&&(this.isApprovalOperationInProgress[e]=t,!0)}handleTasksForPlanFetchFailure(e){return null!=this.planTasksIndex.getItem(e.planId)&&(this.planTasksIndex.setItem(e.planId,null),!0)}handleTasksForPlanFetchSuccess(e){let t=!1;const n=[];t=this.tryUpdateTasks(e.tasks,n)||t;const r=this.planTasksIndex.getItem(e.planId);if(null==r)this.planTasksIndex.setItem(e.planId,n),t=!0;else if(n.length!==xi()(r,n).length){const s=_i()(r,n);this.planTasksIndex.setItem(e.planId,s),t=!0}return null!=e.accumulatedTaskIds&&(t=this.removeTasksForPlanNotIn(e.accumulatedTaskIds,e.planId)||t),t}handlePlanCreationSuccess(e){return this.planTasksIndex.setItem(e.planEntitySet.id,[]),!0}tryUpdateTasks(e,t){let n=!1;return Lt()(e,e=>{if(null!=e?.id&&null!=e.task){t.push(e.id);const r=this.tasks.getItem(e.id);null!=r&&r.isEqual(e.task)||(n=!0,this.tasks.setItem(e.id,e.task));this.tasks.getItemStatus(e.id)!==I.ZB.Stable&&(n=!0,this.tasks.setItemStatus(e.id,I.ZB.Stable));const s=Tr.tryAddIdToIndex(e.id,this.bucketTasksIndex,this.getBucketIndexKey(e.task),!0);n=n||s,null!=e.taskFormatData&&(n=this.setFormatData(e.taskFormatData)||n),null!=e.taskDetails&&(n=this.setTaskDetails(e.taskDetails)||n)}}),n}removeTasksForPlanNotIn(e,t){let n=!1;const r=this.planTasksIndex.getItem(t);if(null!=r){const t=r.filter(t=>{const n=e.indexOf(t)<0,r=yr.o.isPlexTempId(t)&&this.tasks.getItemStatus(t)===I.ZB.Creating;return n&&!r});Ut()(t)||(Lt()(t,e=>{const t=r.indexOf(e,0);r.splice(t,1)}),n=!0)}return n}handleTaskEntitySetFetchSuccess(e){let t=!1;const n=e.taskEntitySet.id,r=e.taskEntitySet.task;if(r&&null!=n){const e=this.tasks.getItem(n);null!=e&&Pn()(e,r,fr.lz.isEqualMomentCustomizer)||(t=!0,this.tasks.setItem(n,r));this.tasks.getItemStatus(n)!==I.ZB.Stable&&(t=!0,this.tasks.setItemStatus(n,I.ZB.Stable));const s=Tr.tryAddIdToIndex(n,this.bucketTasksIndex,this.getBucketIndexKey(r),!0);if(t=t||s,Lt()(r.getAssigneeIds(),e=>{const r=Tr.tryAddIdToIndex(n,this.userTasksIndex,e,!1);t=t||r}),r.planId){const e=Tr.tryAddIdToIndex(n,this.planTasksIndex,r.planId,!1);t=t||e}}const s=e.taskEntitySet.taskDetails;if(s&&null!=n){const e=this.taskDetails.getItem(n);null!=e&&Pn()(e,s,fr.lz.isEqualMomentCustomizer)||(t=this.setTaskDetails(s)||t)}const i=e.taskEntitySet.taskFormatData;return null!=i&&(t=this.setFormatData(i)||t),t}setFormatData(e){let t=!1;if(null!=e){const n=e.assignmentBoardFormat;if(n){const e=this.taskboardTaskFormatForAssignedTo.getItem(n.id);null!=e&&Pn()(e,n,fr.lz.isEqualMomentCustomizer)||(t=!0,this.taskboardTaskFormatForAssignedTo.setItem(n.id,n));this.taskboardTaskFormatForAssignedTo.getItemStatus(n.id)!==I.ZB.Stable&&(t=!0,this.taskboardTaskFormatForAssignedTo.setItemStatus(n.id,I.ZB.Stable))}const r=e.bucketBoardFormat;if(r){const e=this.taskboardTaskFormatForBucket.getItem(r.id);null!=e&&Pn()(e,r,fr.lz.isEqualMomentCustomizer)||(t=!0,this.taskboardTaskFormatForBucket.setItem(r.id,r));this.taskboardTaskFormatForBucket.getItemStatus(r.id)!==I.ZB.Stable&&(t=!0,this.taskboardTaskFormatForBucket.setItemStatus(r.id,I.ZB.Stable))}const s=e.progressBoardFormat;if(s){const e=this.taskboardTaskFormatForProgress.getItem(s.id);null!=e&&Pn()(e,s,fr.lz.isEqualMomentCustomizer)||(t=!0,this.taskboardTaskFormatForProgress.setItem(s.id,s));this.taskboardTaskFormatForProgress.getItemStatus(s.id)!==I.ZB.Stable&&(t=!0,this.taskboardTaskFormatForProgress.setItemStatus(s.id,I.ZB.Stable))}}return t}handleTasksForUserFetchFailure(e){return null!=this.userTasksIndex.getItem(e.userId)&&(this.userTasksIndex.setItem(e.userId,null),!0)}handleTasksForUserFetchSuccess(e){let t=!1;!0===e.isFirstPage&&(this.userTasksIndex.setItem(e.userId,[]),t=!0);const n=[];Lt()(e.tasks,e=>{if(null!=e?.id&&null!=e.task){n.push(e.id);const r=this.tasks.getItem(e.id);null!=r&&Pn()(r,e.task,fr.lz.isEqualMomentCustomizer)||(t=!0,this.tasks.setItem(e.id,e.task));this.tasks.getItemStatus(e.id)!==I.ZB.Stable&&(t=!0,this.tasks.setItemStatus(e.id,I.ZB.Stable));const s=Tr.tryAddIdToIndex(e.id,this.bucketTasksIndex,this.getBucketIndexKey(e.task),!0);t=t||s;const i=e.taskDetails;i&&(t=this.setTaskDetails(i)||t),null!=e.taskFormatData&&(t=this.setFormatData(e.taskFormatData)||t)}});const r=this.userTasksIndex.getItem(e.userId);if(null!=r&&!Ge()(r,n)){const s=_i()(r,n);this.userTasksIndex.setItem(e.userId,s),t=!0}return t}handleTaskCreation(e){const t=e.taskEntitySet.id;if(null==t)return!1;if(null!=this.tasks.getItem(t))throw new Error("AggregateException: task already exists in store");if(e.taskEntitySet.taskDetails){if(null!=this.taskDetails.getItem(t))throw new Error("AggregateException: task details already exists in store")}const n=yr.o.isPlexTempId(t);return e.taskEntitySet.task&&(Tr.tryAddIdToIndex(t,this.planTasksIndex,e.taskEntitySet.task.planId),Lt()(e.taskEntitySet.task.getAssigneeIds(),e=>{Tr.tryAddIdToIndex(t,this.userTasksIndex,e)}),Tr.tryAddIdToIndex(t,this.bucketTasksIndex,this.getBucketIndexKey(e.taskEntitySet.task),!0),this.tasks.setItem(t,e.taskEntitySet.task),this.tasks.setItemStatus(t,n?I.ZB.Creating:I.ZB.Stable)),e.taskEntitySet.taskFormatData&&(e.taskEntitySet.taskFormatData.assignmentBoardFormat&&(this.taskboardTaskFormatForAssignedTo.setItem(t,e.taskEntitySet.taskFormatData.assignmentBoardFormat),this.taskboardTaskFormatForAssignedTo.setItemStatus(t,n?I.ZB.Creating:I.ZB.Stable)),e.taskEntitySet.taskFormatData.bucketBoardFormat&&(this.taskboardTaskFormatForBucket.setItem(t,e.taskEntitySet.taskFormatData.bucketBoardFormat),this.taskboardTaskFormatForBucket.setItemStatus(t,n?I.ZB.Creating:I.ZB.Stable)),e.taskEntitySet.taskFormatData.progressBoardFormat&&(this.taskboardTaskFormatForProgress.setItem(t,e.taskEntitySet.taskFormatData.progressBoardFormat),this.taskboardTaskFormatForProgress.setItemStatus(t,n?I.ZB.Creating:I.ZB.Stable))),e.taskEntitySet.taskDetails&&(this.taskDetails.setItem(t,e.taskEntitySet.taskDetails),this.taskDetails.setItemStatus(t,n?I.ZB.Creating:I.ZB.Stable)),!0}handleTaskCreationFailure(e){const t=e.taskEntitySet.id;if(null==this.tasks.getItem(t))throw new Error("AggregateException: task not found in store");if(e.taskEntitySet.taskDetails){if(null==this.taskDetails.getItem(t))throw new Error("AggregateException: task details not found in store")}return e.taskEntitySet.task&&(Tr.tryRemoveIdFromIndex(t,this.planTasksIndex,e.taskEntitySet.task.planId),Lt()(e.taskEntitySet.task.getAssigneeIds(),e=>{Tr.tryRemoveIdFromIndex(t,this.userTasksIndex,e)}),Tr.tryRemoveIdFromIndex(t,this.bucketTasksIndex,this.getBucketIndexKey(e.taskEntitySet.task))),this.tasks.removeItem(t),e.taskEntitySet.taskFormatData&&(e.taskEntitySet.taskFormatData.assignmentBoardFormat&&this.taskboardTaskFormatForAssignedTo.removeItem(t),e.taskEntitySet.taskFormatData.bucketBoardFormat&&this.taskboardTaskFormatForBucket.removeItem(t),e.taskEntitySet.taskFormatData.progressBoardFormat&&this.taskboardTaskFormatForProgress.removeItem(t)),e.taskEntitySet.taskDetails&&this.taskDetails.removeItem(t),!0}handleTaskCreationSuccess(e){const t=e.localId,n=e.taskEntitySet.id;if(null==this.tasks.getItem(t))throw new Error("AggregateException: task not found in store");return e.taskEntitySet.task&&(Tr.tryUpdateIdInIndex(t,n,this.planTasksIndex,e.taskEntitySet.task.planId),Lt()(e.taskEntitySet.task.getAssigneeIds(),e=>{Tr.tryUpdateIdInIndex(t,n,this.userTasksIndex,e)}),Tr.tryUpdateIdInIndex(t,n,this.bucketTasksIndex,this.getBucketIndexKey(e.taskEntitySet.task)),this.tasks.removeItem(t),this.tasks.setItem(n,e.taskEntitySet.task),this.tasks.setItemStatus(n,I.ZB.Stable)),e.taskEntitySet.taskFormatData&&(e.taskEntitySet.taskFormatData.assignmentBoardFormat&&(this.taskboardTaskFormatForAssignedTo.getItem(t)&&this.taskboardTaskFormatForAssignedTo.removeItem(t),this.taskboardTaskFormatForAssignedTo.setItem(n,e.taskEntitySet.taskFormatData.assignmentBoardFormat),this.taskboardTaskFormatForAssignedTo.setItemStatus(n,I.ZB.Stable)),e.taskEntitySet.taskFormatData.bucketBoardFormat&&(this.taskboardTaskFormatForBucket.getItem(t)&&this.taskboardTaskFormatForBucket.removeItem(t),this.taskboardTaskFormatForBucket.setItem(n,e.taskEntitySet.taskFormatData.bucketBoardFormat),this.taskboardTaskFormatForBucket.setItemStatus(n,I.ZB.Stable)),e.taskEntitySet.taskFormatData.progressBoardFormat&&(this.taskboardTaskFormatForProgress.getItem(t)&&this.taskboardTaskFormatForProgress.removeItem(t),this.taskboardTaskFormatForProgress.setItem(n,e.taskEntitySet.taskFormatData.progressBoardFormat),this.taskboardTaskFormatForProgress.setItemStatus(n,I.ZB.Stable))),e.taskEntitySet.taskDetails&&(null!=this.taskDetails.getItem(t)&&this.taskDetails.removeItem(t),this.taskDetails.setItem(n,e.taskEntitySet.taskDetails),this.taskDetails.setItemStatus(n,I.ZB.Stable)),!0}handleDiffSyncInsertTask(e){const t=e.taskEntitySet.id;if(e.taskEntitySet.task){const n=e.taskEntitySet.task;if(null!=this.tasks.getItem(t))throw new Error("AggregateException: task already exists in store");Tr.tryAddIdToIndex(t,this.planTasksIndex,n.planId),Lt()(n.getAssigneeIds(),e=>{Tr.tryAddIdToIndex(t,this.userTasksIndex,e)}),Tr.tryAddIdToIndex(t,this.bucketTasksIndex,this.getBucketIndexKey(n),!0),this.tasks.setItem(t,n),this.tasks.setItemStatus(t,I.ZB.Stable)}return e.taskEntitySet.taskDetails&&this.handleDiffSyncInsertTaskDetails(e.taskEntitySet.taskDetails),e.taskEntitySet.taskFormatData&&this.handleDiffSyncInsertTaskFormats(e.taskEntitySet.taskFormatData),!0}handleDiffSyncInsertTaskDetails(e){if(null!=this.taskDetails.getItem(e.id))throw new Error("AggregateException: task details already exists in store");return this.taskDetails.setItem(e.id,e),this.taskDetails.setItemStatus(e.id,I.ZB.Stable),!0}handleDiffSyncInsertTaskFormats(e){const t=e.assignmentBoardFormat?.id??e.bucketBoardFormat?.id??e.progressBoardFormat?.id??null;if(null==t)return!1;if(e.assignmentBoardFormat){if(null!=this.taskboardTaskFormatForAssignedTo.getItem(t))throw new Error("AggregateException: assign format already exists in store");this.taskboardTaskFormatForAssignedTo.setItem(t,e.assignmentBoardFormat),this.taskboardTaskFormatForAssignedTo.setItemStatus(t,I.ZB.Stable)}if(e.bucketBoardFormat){if(null!=this.taskboardTaskFormatForBucket.getItem(t))throw new Error("AggregateException: bucket format already exists in store");this.taskboardTaskFormatForBucket.setItem(t,e.bucketBoardFormat),this.taskboardTaskFormatForBucket.setItemStatus(t,I.ZB.Stable)}if(e.progressBoardFormat){if(null!=this.taskboardTaskFormatForProgress.getItem(t))throw new Error("AggregateException: progress format already exists in store");this.taskboardTaskFormatForProgress.setItem(t,e.progressBoardFormat),this.taskboardTaskFormatForProgress.setItemStatus(t,I.ZB.Stable)}return!0}handleTaskDeletion(e){let t=!1;const n=e.deletedTaskEntitySet.id,r=this.tasks.getItem(n);if(null==r)throw new Error("AggregateException: task not found in store");const s=Tr.tryRemoveIdFromIndex(r.id,this.planTasksIndex,r.planId);t=s||t,Lt()(r.getAssigneeIds(),e=>{const n=Tr.tryRemoveIdFromIndex(r.id,this.userTasksIndex,e);t=n||t});const i=Tr.tryRemoveIdFromIndex(r.id,this.bucketTasksIndex,this.getBucketIndexKey(r));t=i||t;if(this.tasks.getItemStatus(r.id)!==I.ZB.Deleting&&(this.tasks.setItemStatus(r.id,I.ZB.Deleting),t=!0),this.taskboardTaskFormatForAssignedTo.getItem(r.id)){this.taskboardTaskFormatForAssignedTo.getItemStatus(r.id)!==I.ZB.Deleting&&(this.taskboardTaskFormatForAssignedTo.setItemStatus(r.id,I.ZB.Deleting),t=!0)}if(this.taskboardTaskFormatForBucket.getItem(r.id)){this.taskboardTaskFormatForBucket.getItemStatus(r.id)!==I.ZB.Deleting&&(this.taskboardTaskFormatForBucket.setItemStatus(r.id,I.ZB.Deleting),t=!0)}if(this.taskboardTaskFormatForProgress.getItem(r.id)){this.taskboardTaskFormatForProgress.getItemStatus(r.id)!==I.ZB.Deleting&&(this.taskboardTaskFormatForProgress.setItemStatus(r.id,I.ZB.Deleting),t=!0)}if(this.taskDetails.getItem(r.id)){this.taskDetails.getItemStatus(r.id)!==I.ZB.Deleting&&(this.taskDetails.setItemStatus(r.id,I.ZB.Deleting),t=!0)}return t}handleTaskDeletionFailure(e){let t=!1;const n=e.deletedTaskEntitySet.id,r=this.tasks.getItem(n);if(null==r)throw new Error("AggregateException: task not found in store");const s=Tr.tryAddIdToIndex(r.id,this.planTasksIndex,r.planId);t=t||s,Lt()(r.getAssigneeIds(),e=>{const n=Tr.tryAddIdToIndex(r.id,this.userTasksIndex,e);t=t||n});const i=Tr.tryAddIdToIndex(r.id,this.bucketTasksIndex,this.getBucketIndexKey(r));t=t||i;if(this.tasks.getItemStatus(r.id)!==I.ZB.Stable&&(this.tasks.setItemStatus(r.id,I.ZB.Stable),t=!0),this.taskboardTaskFormatForAssignedTo.getItem(r.id)){this.taskboardTaskFormatForAssignedTo.getItemStatus(r.id)!==I.ZB.Stable&&(this.taskboardTaskFormatForAssignedTo.setItemStatus(r.id,I.ZB.Stable),t=!0)}if(this.taskboardTaskFormatForBucket.getItem(r.id)){this.taskboardTaskFormatForBucket.getItemStatus(r.id)!==I.ZB.Stable&&(this.taskboardTaskFormatForBucket.setItemStatus(r.id,I.ZB.Stable),t=!0)}if(this.taskboardTaskFormatForProgress.getItem(r.id)){this.taskboardTaskFormatForProgress.getItemStatus(r.id)!==I.ZB.Stable&&(this.taskboardTaskFormatForProgress.setItemStatus(r.id,I.ZB.Stable),t=!0)}if(this.taskDetails.getItem(r.id)){this.taskDetails.getItemStatus(r.id)!==I.ZB.Stable&&(this.taskDetails.setItemStatus(r.id,I.ZB.Stable),t=!0)}return t}handleTaskDeletionSuccess(e){const t=e.deletedTaskEntitySet.id,n=this.tasks.getItem(t);if(null==n)throw new Error("AggregateException: task not found in store");return this.tasks.removeItem(n.id),this.taskboardTaskFormatForAssignedTo.getItem(n.id)&&this.taskboardTaskFormatForAssignedTo.removeItem(n.id),this.taskboardTaskFormatForBucket.getItem(n.id)&&this.taskboardTaskFormatForBucket.removeItem(n.id),this.taskboardTaskFormatForProgress.getItem(n.id)&&this.taskboardTaskFormatForProgress.removeItem(n.id),this.taskDetails.getItem(n.id)&&this.taskDetails.removeItem(n.id),Tr.tryRemoveIdFromIndex(n.id,this.planTasksIndex,n.planId),Lt()(n.getAssigneeIds(),e=>{Tr.tryRemoveIdFromIndex(n.id,this.userTasksIndex,e)}),Tr.tryRemoveIdFromIndex(n.id,this.bucketTasksIndex,this.getBucketIndexKey(n)),!0}handleTaskUndeletion(e){const t=e.taskEntitySet.id;if(null!=this.tasks.getItem(t))throw new Error("AggregateException: task already exists in store");if(e.taskEntitySet.taskDetails){if(null!=this.taskDetails.getItem(t))throw new Error("AggregateException: task details already exists in store")}return e.taskEntitySet.task&&(Tr.tryAddIdToIndex(t,this.planTasksIndex,e.taskEntitySet.task.planId),Lt()(e.taskEntitySet.task.getAssigneeIds(),e=>{Tr.tryAddIdToIndex(t,this.userTasksIndex,e)}),Tr.tryAddIdToIndex(t,this.bucketTasksIndex,this.getBucketIndexKey(e.taskEntitySet.task),!0),this.tasks.setItem(t,e.taskEntitySet.task),this.tasks.setItemStatus(t,I.ZB.Stable)),e.taskEntitySet.taskFormatData&&(e.taskEntitySet.taskFormatData.assignmentBoardFormat&&(this.taskboardTaskFormatForAssignedTo.setItem(t,e.taskEntitySet.taskFormatData.assignmentBoardFormat),this.taskboardTaskFormatForAssignedTo.setItemStatus(t,I.ZB.Stable)),e.taskEntitySet.taskFormatData.bucketBoardFormat&&(this.taskboardTaskFormatForBucket.setItem(t,e.taskEntitySet.taskFormatData.bucketBoardFormat),this.taskboardTaskFormatForBucket.setItemStatus(t,I.ZB.Stable)),e.taskEntitySet.taskFormatData.progressBoardFormat&&(this.taskboardTaskFormatForProgress.setItem(t,e.taskEntitySet.taskFormatData.progressBoardFormat),this.taskboardTaskFormatForProgress.setItemStatus(t,I.ZB.Stable))),e.taskEntitySet.taskDetails&&(this.taskDetails.setItem(t,e.taskEntitySet.taskDetails),this.taskDetails.setItemStatus(t,I.ZB.Stable)),!0}handleTaskUndeletionFailure(e){const t=e.taskEntitySet.id,n=this.tasks.getItem(t);if(null==n)throw new Error("AggregateException: task not found in store");if(e.taskEntitySet.taskDetails){if(null==this.taskDetails.getItem(n.id))throw new Error("AggregateException: task details not found in store")}return Tr.tryRemoveIdFromIndex(n.id,this.planTasksIndex,e.taskEntitySet.task.planId),Lt()(e.taskEntitySet.task.getAssigneeIds(),e=>{Tr.tryRemoveIdFromIndex(n.id,this.userTasksIndex,e)}),Tr.tryRemoveIdFromIndex(n.id,this.bucketTasksIndex,this.getBucketIndexKey(e.taskEntitySet.task)),this.tasks.removeItem(n.id),this.taskboardTaskFormatForAssignedTo.getItem(n.id)&&this.taskboardTaskFormatForAssignedTo.removeItem(n.id),this.taskboardTaskFormatForBucket.getItem(n.id)&&this.taskboardTaskFormatForBucket.removeItem(n.id),this.taskboardTaskFormatForProgress.getItem(n.id)&&this.taskboardTaskFormatForProgress.removeItem(n.id),this.taskDetails.getItem(n.id)&&this.taskDetails.removeItem(n.id),!0}handleTaskUndeletionSuccess(e){const t=e.taskEntitySet.id;if(null==this.tasks.getItem(t))throw new Error("AggregateException: task not found in store");return this.tasks.removeItem(t),e.taskEntitySet.task&&(this.tasks.setItem(t,e.taskEntitySet.task),this.tasks.setItemStatus(t,I.ZB.Stable)),e.taskEntitySet.taskFormatData&&(e.taskEntitySet.taskFormatData.assignmentBoardFormat&&(this.taskboardTaskFormatForAssignedTo.getItem(t)&&this.taskboardTaskFormatForAssignedTo.removeItem(t),this.taskboardTaskFormatForAssignedTo.setItem(t,e.taskEntitySet.taskFormatData.assignmentBoardFormat),this.taskboardTaskFormatForAssignedTo.setItemStatus(t,I.ZB.Stable)),e.taskEntitySet.taskFormatData.bucketBoardFormat&&(this.taskboardTaskFormatForBucket.getItem(t)&&this.taskboardTaskFormatForBucket.removeItem(t),this.taskboardTaskFormatForBucket.setItem(t,e.taskEntitySet.taskFormatData.bucketBoardFormat),this.taskboardTaskFormatForBucket.setItemStatus(t,I.ZB.Stable)),e.taskEntitySet.taskFormatData.progressBoardFormat&&(this.taskboardTaskFormatForProgress.getItem(t)&&this.taskboardTaskFormatForProgress.removeItem(t),this.taskboardTaskFormatForProgress.setItem(t,e.taskEntitySet.taskFormatData.progressBoardFormat),this.taskboardTaskFormatForProgress.setItemStatus(t,I.ZB.Stable))),e.taskEntitySet.taskDetails&&(null!=this.taskDetails.getItem(t)&&this.taskDetails.removeItem(t),this.taskDetails.setItem(t,e.taskEntitySet.taskDetails),this.taskDetails.setItemStatus(t,I.ZB.Stable)),!0}handleDiffSyncDeleteTask(e){const t=e.deletedTaskEntitySet.id,n=this.tasks.getItem(t);if(null==n)throw new Error("AggregateException: task not found in store");return Tr.tryRemoveIdFromIndex(t,this.planTasksIndex,n.planId),Lt()(n.getAssigneeIds(),e=>{Tr.tryRemoveIdFromIndex(t,this.userTasksIndex,e)}),Tr.tryRemoveIdFromIndex(t,this.bucketTasksIndex,this.getBucketIndexKey(n)),this.tasks.removeItem(t),this.taskDetails.getItem(t)&&this.taskDetails.removeItem(t),this.taskboardTaskFormatForAssignedTo.getItem(t)&&this.taskboardTaskFormatForAssignedTo.removeItem(t),this.taskboardTaskFormatForBucket.getItem(t)&&this.taskboardTaskFormatForBucket.removeItem(t),this.taskboardTaskFormatForProgress.getItem(t)&&this.taskboardTaskFormatForProgress.removeItem(t),!0}handleTaskUpdate(e,t,n,r){let s=!1;if(null!=e){const n=this.tasks.getItem(e.id);if(null==n)throw new Error("AggregateException: task not found in store");if(null!=t){const n=t.getPromotedProperties();e=e.setPromotedProperties(n)}Pn()(n,e,fr.lz.isEqualMomentCustomizer)||(this.tasks.pushUpdate(e.id,e,r),this.updateTaskIndexes(e.id,n,e),s=!0);this.tasks.getItemStatus(e.id)!==I.ZB.Updating&&(s=!0,this.tasks.setItemStatus(e.id,I.ZB.Updating))}if(null!=t){if(null==this.tasks.getItem(t.id))throw new Error("AggregateException: task not found in store");const e=this.taskDetails.getItem(t.id);if(null==e)throw new Error("AggregateException: task details not found in store");Pn()(e,t,fr.lz.isEqualMomentCustomizer)||(s=!0,this.taskDetails.pushUpdate(t.id,t,r));this.taskDetails.getItemStatus(t.id)!==I.ZB.Updating&&(s=!0,this.taskDetails.setItemStatus(t.id,I.ZB.Updating))}if(null!=n){if(n.assignmentBoardFormat){if(null==this.tasks.getItem(n.assignmentBoardFormat.id))throw new Error("AggregateException: task not found in store");const e=this.taskboardTaskFormatForAssignedTo.getItem(n.assignmentBoardFormat.id);if(null==e)throw new Error("AggregateException: task assign fmt not found in store");Pn()(e,n.assignmentBoardFormat,fr.lz.isEqualMomentCustomizer)||(this.taskboardTaskFormatForAssignedTo.pushUpdate(n.assignmentBoardFormat.id,n.assignmentBoardFormat,r),this.taskboardTaskFormatForAssignedTo.setItemStatus(n.assignmentBoardFormat.id,I.ZB.Updating),s=!0)}if(n.bucketBoardFormat){if(null==this.tasks.getItem(n.bucketBoardFormat.id))throw new Error("AggregateException: task not found in store");const e=this.taskboardTaskFormatForBucket.getItem(n.bucketBoardFormat.id);if(null==e)throw new Error("AggregateException: task bucket fmt not found in store");Pn()(e,n.bucketBoardFormat,fr.lz.isEqualMomentCustomizer)||(this.taskboardTaskFormatForBucket.pushUpdate(n.bucketBoardFormat.id,n.bucketBoardFormat,r),this.taskboardTaskFormatForBucket.setItemStatus(n.bucketBoardFormat.id,I.ZB.Updating),s=!0)}if(n.progressBoardFormat){if(null==this.tasks.getItem(n.progressBoardFormat.id))throw new Error("AggregateException: task not found in store");const e=this.taskboardTaskFormatForProgress.getItem(n.progressBoardFormat.id);if(null==e)throw new Error("AggregateException: task progress fmt not found in store");Pn()(e,n.progressBoardFormat,fr.lz.isEqualMomentCustomizer)||(this.taskboardTaskFormatForProgress.pushUpdate(n.progressBoardFormat.id,n.progressBoardFormat,r),this.taskboardTaskFormatForProgress.setItemStatus(n.progressBoardFormat.id,I.ZB.Updating),s=!0)}}return s}handleTaskUpdateFailure(e,t,n,r){let s=!1;if(null!=e){const t=this.tasks.getItem(e.id);if(null==t){if(yr.o.isPlexTempId(e.id))return!1;throw new Error("AggregateException: task not found in store")}this.tasks.updateExists(t.id,r)&&(this.tasks.revertUpdate(t.id,r),this.updateTaskIndexes(t.id,t,e),0===this.tasks.getPendingUpdateCount(t.id)&&this.tasks.setItemStatus(t.id,I.ZB.Stable),s=!0)}if(null!=t){if(null==this.taskDetails.getItem(t.id))throw new Error("AggregateException: task details not found in store");this.taskDetails.updateExists(t.id,r)&&(this.taskDetails.revertUpdate(t.id,r),0===this.taskDetails.getPendingUpdateCount(t.id)&&this.taskDetails.setItemStatus(t.id,I.ZB.Stable),s=!0)}if(null!=n){if(null!=n.assignmentBoardFormat){if(null==this.taskboardTaskFormatForAssignedTo.getItem(n.assignmentBoardFormat.id))throw new Error("AggregateException: assigned format not found in store");this.taskboardTaskFormatForAssignedTo.updateExists(n.assignmentBoardFormat.id,r)&&(this.taskboardTaskFormatForAssignedTo.revertUpdate(n.assignmentBoardFormat.id,r),0===this.taskboardTaskFormatForAssignedTo.getPendingUpdateCount(n.assignmentBoardFormat.id)&&this.taskboardTaskFormatForAssignedTo.setItemStatus(n.assignmentBoardFormat.id,I.ZB.Stable),s=!0)}if(null!=n.bucketBoardFormat){if(null==this.taskboardTaskFormatForBucket.getItem(n.bucketBoardFormat.id))throw new Error("AggregateException: bucket format not found in store");this.taskboardTaskFormatForBucket.updateExists(n.bucketBoardFormat.id,r)&&(this.taskboardTaskFormatForBucket.revertUpdate(n.bucketBoardFormat.id,r),0===this.taskboardTaskFormatForBucket.getPendingUpdateCount(n.bucketBoardFormat.id)&&this.taskboardTaskFormatForBucket.setItemStatus(n.bucketBoardFormat.id,I.ZB.Stable),s=!0)}if(null!=n.progressBoardFormat){if(null==this.taskboardTaskFormatForProgress.getItem(n.progressBoardFormat.id))throw new Error("AggregateException: progress format not found in store");this.taskboardTaskFormatForProgress.updateExists(n.progressBoardFormat.id,r)&&(this.taskboardTaskFormatForProgress.revertUpdate(n.progressBoardFormat.id,r),0===this.taskboardTaskFormatForProgress.getPendingUpdateCount(n.progressBoardFormat.id)&&this.taskboardTaskFormatForProgress.setItemStatus(n.progressBoardFormat.id,I.ZB.Stable),s=!0)}}return s}handleTaskUpdateSuccess(e,t,n,r,s){let i=!1;if(null!=e){let n=this.tasks.getItem(e.id);if(null==n)throw new Error("AggregateException: task not found in store");if(this.tasks.updateExists(n.id,r)&&(this.tasks.commitUpdate(n.id,r),n=this.tasks.getItem(e.id),i=!0),null==n)throw new Error("AggregateException: task not found in store");if(null!=t){const n=t.getPromotedProperties();e=e.setPromotedProperties(n)}if(!Pn()(n,e,fr.lz.isEqualMomentCustomizer)){const t=s?e.setContentModifiedProperties():e;this.tasks.mergeItem(n.id,t,ta.Y.mergeCustomizer),this.updateTaskIndexes(e.id,n,e),i=!0}this.tasks.getItemStatus(n.id)!==I.ZB.Stable&&0===this.tasks.getPendingUpdateCount(n.id)&&(this.tasks.setItemStatus(n.id,I.ZB.Stable),i=!0)}if(null!=t){if(null==this.tasks.getItem(t.id))throw new Error("AggregateException: task not found in store");let e=this.taskDetails.getItem(t.id);this.taskDetails.updateExists(t.id,r)&&(this.taskDetails.commitUpdate(t.id,r),e=this.taskDetails.getItem(t.id),0===this.taskDetails.getPendingUpdateCount(t.id)&&this.taskDetails.setItemStatus(t.id,I.ZB.Stable),i=!0),Ge()(e,t)||(null==e?this.taskDetails.setItem(t.id,t):this.taskDetails.mergeItem(e.id,t,na.U.mergeCustomizer),i=!0)}if(null!=n){if(null!=n.assignmentBoardFormat){if(null==this.tasks.getItem(n.assignmentBoardFormat.id))throw new Error("AggregateException: task not found in store");let e=this.taskboardTaskFormatForAssignedTo.getItem(n.assignmentBoardFormat.id);this.taskboardTaskFormatForAssignedTo.updateExists(n.assignmentBoardFormat.id,r)&&(this.taskboardTaskFormatForAssignedTo.commitUpdate(n.assignmentBoardFormat.id,r),0===this.taskboardTaskFormatForAssignedTo.getPendingUpdateCount(n.assignmentBoardFormat.id)&&this.taskboardTaskFormatForAssignedTo.setItemStatus(n.assignmentBoardFormat.id,I.ZB.Stable),e=this.taskboardTaskFormatForAssignedTo.getItem(n.assignmentBoardFormat.id),i=!0),Pn()(e,n.assignmentBoardFormat,fr.lz.isEqualMomentCustomizer)||(null==e?this.taskboardTaskFormatForAssignedTo.setItem(n.assignmentBoardFormat.id,n.assignmentBoardFormat):this.taskboardTaskFormatForAssignedTo.mergeItem(n.assignmentBoardFormat.id,n.assignmentBoardFormat,sa.x.mergeCustomizer),i=!0)}if(null!=n.bucketBoardFormat){if(null==this.tasks.getItem(n.bucketBoardFormat.id))throw new Error("AggregateException: task not found in store");let e=this.taskboardTaskFormatForBucket.getItem(n.bucketBoardFormat.id);this.taskboardTaskFormatForBucket.updateExists(n.bucketBoardFormat.id,r)&&(this.taskboardTaskFormatForBucket.commitUpdate(n.bucketBoardFormat.id,r),0===this.taskboardTaskFormatForBucket.getPendingUpdateCount(n.bucketBoardFormat.id)&&(this.taskboardTaskFormatForBucket.setItemStatus(n.bucketBoardFormat.id,I.ZB.Stable),i=!0),e=this.taskboardTaskFormatForBucket.getItem(n.bucketBoardFormat.id),i=!0),Pn()(e,n.bucketBoardFormat,fr.lz.isEqualMomentCustomizer)||(null==e?this.taskboardTaskFormatForBucket.setItem(n.bucketBoardFormat.id,n.bucketBoardFormat):this.taskboardTaskFormatForBucket.mergeItem(n.bucketBoardFormat.id,n.bucketBoardFormat,Sa.B.applyDiffMomentCustomizer),i=!0)}if(null!=n.progressBoardFormat){if(null==this.tasks.getItem(n.progressBoardFormat.id))throw new Error("AggregateException: task not found in store");let e=this.taskboardTaskFormatForProgress.getItem(n.progressBoardFormat.id);this.taskboardTaskFormatForProgress.updateExists(n.progressBoardFormat.id,r)&&(this.taskboardTaskFormatForProgress.commitUpdate(n.progressBoardFormat.id,r),0===this.taskboardTaskFormatForProgress.getPendingUpdateCount(n.progressBoardFormat.id)&&this.taskboardTaskFormatForProgress.setItemStatus(n.progressBoardFormat.id,I.ZB.Stable),e=this.taskboardTaskFormatForProgress.getItem(n.progressBoardFormat.id),i=!0),Pn()(e,n.progressBoardFormat,fr.lz.isEqualMomentCustomizer)||(null==e?this.taskboardTaskFormatForProgress.setItem(n.progressBoardFormat.id,n.progressBoardFormat):this.taskboardTaskFormatForProgress.mergeItem(n.progressBoardFormat.id,n.progressBoardFormat,Sa.B.applyDiffMomentCustomizer),i=!0)}}return i}handleDiffSyncUpdateTask(e){let t=!1;const n=e.taskEntitySet.task,r=e.taskEntitySet.taskDetails,s=e.taskEntitySet.taskFormatData,i=e.taskEntitySet.id;if(!i)throw new Error("ArgumentNullException: entitySetId");if(null!=n){const e=this.tasks.getItem(n.id);if(null==e)throw new Error("AggregateException: task not found in store");Pn()(e,n,fr.lz.isEqualMomentCustomizer)||(this.updateTaskIndexes(i,e,n),this.tasks.mergeItem(i,n,ta.Y.mergeCustomizer),t=!0);this.tasks.getItemStatus(i)!==I.ZB.Stable&&(this.tasks.setItemStatus(i,I.ZB.Stable),t=!0)}return r&&(t=this.handleDiffSyncUpdateTaskDetails(r)||t),s&&(t=this.handleDiffSyncUpdateTaskFormats(s)||t),t}handleDiffSyncUpdateTaskDetails(e){let t=!1;const n=e.id;if(null==this.tasks.getItem(n))throw new Error("AggregateException: task not found in store");const r=this.taskDetails.getItem(e.id);if(null!=r){Pn()(r,e,fr.lz.isEqualMomentCustomizer)||(r.approval?.approvalStatus!==e.approval?.approvalStatus&&!0===this.isApprovalOperationInProgress[n]&&this.setIsApprovalOperationInProgress(n,!1),this.taskDetails.mergeItem(n,e,na.U.mergeCustomizer),t=!0);this.taskDetails.getItemStatus(n)!==I.ZB.Stable&&(this.taskDetails.setItemStatus(n,I.ZB.Stable),t=!0);const s=this.promoteTaskDetailsProperties(e);t=t||s}return t}handleDiffSyncUpdateTaskFormats(e){let t=!1;if(e.assignmentBoardFormat){const n=e.assignmentBoardFormat.id;if(null==this.tasks.getItem(n))throw new Error("AggregateException: task not found in store");Pn()(this.taskboardTaskFormatForAssignedTo.getItem(n),e.assignmentBoardFormat,fr.lz.isEqualMomentCustomizer)||(null==this.taskboardTaskFormatForAssignedTo.getItem(n)?this.taskboardTaskFormatForAssignedTo.setItem(n,e.assignmentBoardFormat):this.taskboardTaskFormatForAssignedTo.mergeItem(n,e.assignmentBoardFormat,sa.x.mergeCustomizer),this.taskboardTaskFormatForAssignedTo.setItemStatus(n,I.ZB.Stable),t=!0)}if(e.bucketBoardFormat){const n=e.bucketBoardFormat.id;if(null==this.tasks.getItem(n))throw new Error("AggregateException: task not found in store");Pn()(this.taskboardTaskFormatForBucket.getItem(n),e.bucketBoardFormat,fr.lz.isEqualMomentCustomizer)||(null==this.taskboardTaskFormatForBucket.getItem(n)?this.taskboardTaskFormatForBucket.setItem(n,e.bucketBoardFormat):this.taskboardTaskFormatForBucket.mergeItem(n,e.bucketBoardFormat,Sa.B.applyDiffMomentCustomizer),this.taskboardTaskFormatForBucket.setItemStatus(n,I.ZB.Stable),t=!0)}if(e.progressBoardFormat){const n=e.progressBoardFormat.id;if(null==this.tasks.getItem(n))throw new Error("AggregateException: task not found in store");Pn()(this.taskboardTaskFormatForProgress.getItem(n),e.progressBoardFormat,fr.lz.isEqualMomentCustomizer)||(null==this.taskboardTaskFormatForProgress.getItem(n)?this.taskboardTaskFormatForProgress.setItem(n,e.progressBoardFormat):this.taskboardTaskFormatForProgress.mergeItem(n,e.progressBoardFormat,Sa.B.applyDiffMomentCustomizer),this.taskboardTaskFormatForProgress.setItemStatus(n,I.ZB.Stable),t=!0)}return t}handleDeleteBucketSuccess(e){return null!=this.bucketTasksIndex.getItem(e.bucketId)&&(this.bucketTasksIndex.removeItem(e.bucketId),!0)}handleCreateUploadSession(e){const t=e.updatedTaskDetails.id;return null!=this.taskDetails.getItem(t)&&this.handleTaskUpdate(void 0,e.updatedTaskDetails,void 0,e.updateKey)}handleUploadSessionFailed(e){const t=e.taskId,n=this.taskDetails.getItem(t);return!!n&&(null!=n.references[e.session.id]&&(delete n.references[e.session.id],this.handleTaskUpdateFailure(void 0,n,void 0,e.updateKey)))}setTaskDetails(e){let t=!1;const n=this.taskDetails.getItem(e.id);null!=n&&Pn()(n,e,fr.lz.isEqualMomentCustomizer)||(t=!0,this.taskDetails.setItem(e.id,e),this.tasks.getItem(e.id)&&this.promoteTaskDetailsProperties(e));return this.taskDetails.getItemStatus(e.id)!==I.ZB.Stable&&(t=!0,this.taskDetails.setItemStatus(e.id,I.ZB.Stable)),t}updateTaskIndexes(e,t,n){let r=!1;t.planId!==n.planId&&(r=!0,Tr.tryRemoveIdFromIndex(e,this.planTasksIndex,t.planId),Tr.tryAddIdToIndex(e,this.planTasksIndex,n.planId));const s=Pi()(t.getAssigneeIds(),n.getAssigneeIds());Lt()(s,t=>{const n=Tr.tryRemoveIdFromIndex(e,this.userTasksIndex,t);r=r||n});const i=Pi()(n.getAssigneeIds(),t.getAssigneeIds());if(Lt()(i,t=>{const n=Tr.tryAddIdToIndex(e,this.userTasksIndex,t);r=r||n}),t.bucketId!==n.bucketId){const s=Tr.tryRemoveIdFromIndex(e,this.bucketTasksIndex,this.getBucketIndexKey(t));r=r||s;const i=Tr.tryAddIdToIndex(e,this.bucketTasksIndex,this.getBucketIndexKey(n),!0);r=r||i}if(t.planId!==n.planId){if(t.planId){const n=Tr.tryRemoveIdFromIndex(e,this.planTasksIndex,t.planId);r=r||n}if(n.planId){const t=Tr.tryAddIdToIndex(e,this.planTasksIndex,n.planId,!0);r=r||t}}return r}getBucketIndexKey(e){return e.bucketId||C.iR+e.planId}promoteTaskDetailsProperties(e){const t=this.tasks.getItem(e.id);if(null==t)throw new Error("AggregateException: task not found in store for task details");const n=e.getPromotedProperties(),r=t.setPromotedProperties(n);return!Pn()(t,r,fr.lz.isEqualMomentCustomizer)&&(this.tasks.setItem(t.id,r),this.tasks.setItemStatus(t.id,I.ZB.Stable),!0)}constructor(){super(),this.tasks=new ka,this.taskDetails=new ka,this.taskApprovalDetails=new Se.j,this.isApprovalOperationInProgress={},this.taskboardTaskFormatForAssignedTo=new ka,this.taskboardTaskFormatForBucket=new ka,this.taskboardTaskFormatForProgress=new ka,this.planTasksIndex=new Se.j,this.userTasksIndex=new Se.j,this.bucketTasksIndex=new Se.j}}var Pa,wa=n(92296),xa=n(4576),Fa=n(80332),Aa=n(39202),La=n(33414),_a=n(48170),Ua=n(73438),Oa=n(33701),Ba=n(5312);!function(e){e.Feedback="office16;L_SendFeedback",e.Survey="office16;L_SendSurvey",e.FollowUp="office16;L_EmailCollection",e.LogCollection="office16;L_LogCollection",e.Screenshot="office16;L_Screenshot"}(Pa||(Pa={}));class Ma{constructor(e,t){if(this.allowFeedback=!e,this.allowSurvey=!e,this.allowFollowUp=!1,this.allowLogCollection=!1,this.allowScreenshot=!1,t&&!Ut()(t)&&!Ut()(t.value))for(let n=0;n<t.value.length;n++){const e=t.value[n];if(!Ut()(e)&&!Ut()(e.policiesPayload))for(let t=0;t<e.policiesPayload.length;t++){const n=e.policiesPayload[t];switch(n.settingId){case"office16;L_SendFeedback":this.allowFeedback="1"===n.value;break;case"office16;L_SendSurvey":this.allowSurvey="1"===n.value;break;case"office16;L_EmailCollection":this.allowFollowUp="1"===n.value;break;case"office16;L_LogCollection":this.allowLogCollection="1"===n.value;break;case"office16;L_Screenshot":this.allowScreenshot="1"===n.value}}}}}var Na=n(55337);class Ra extends be.z{get name(){return"PlannerTenantStore"}getCurrentTenantFeedbackSettings(){return this.currentTenantFeedbackSettings}getCurrentTenantGroupSettings(){return this.currentTenantGroupSettings}getCurrentSensitivityLabels(){return this.currentSensitivityLabels}getCurrentSensitivityPolicySettings(){return this.currentSensitivityPolicySettings}handleAction(e){let t=!1;switch(e.type){case dt.M.actionType:t=this.handleCheckCurrentUserToGroupsMembershipsSucceededAction(e);break;case xa.o.actionType:t=this.handleGetTenantFeedbackSettingsSucceededAction(e);break;case wa.E.actionType:t=this.handleGetTenantFeedbackSettingsFailedAction();break;case at.Q.actionType:t=this.handleGetTenantGroupSettingsSucceededAction(e);break;case Fa.a.actionType:t=this.handleGetTenantGroupSettingsFailedAction();break;case Oa._.actionType:t=this.handleSetGroupNamePrefixSuffixAction(e);break;case Aa.K.actionType:t=this.handleGetSensitivityLabelsSucceededAction(e);break;case La.e.actionType:t=this.handleGetSensitivityLabelsFailedAction(e);break;case _a.Y.actionType:t=this.handleGetSensitivityPolicySettingsSucceededAction(e);break;case Ua.A.actionType:t=this.handleGetSensitivityPolicySettingsFailedAction(e);break;default:return}t&&this.publishStoreChangedEvent()}handleCheckCurrentUserToGroupsMembershipsSucceededAction(e){return null!=this.currentTenantGroupSettings&&e.requestGroupIds.indexOf(this.currentTenantGroupSettings.GroupIdForMembershipChecking)>-1&&(this.currentTenantGroupSettings.handleCheckMembershipResponse(e.returnedGroupIds.indexOf(this.currentTenantGroupSettings.GroupIdForMembershipChecking)>-1),!0)}handleGetTenantFeedbackSettingsSucceededAction(e){return!Ge()(this.currentTenantFeedbackSettings,e.tenantFeedbackSettings)&&(this.currentTenantFeedbackSettings=e.tenantFeedbackSettings,!0)}handleGetTenantFeedbackSettingsFailedAction(){if(this.currentTenantFeedbackSettings)return!1;try{this.currentTenantFeedbackSettings=new Ma(!0)}catch(e){this.loggers.traceLogger.logTrace(507786915,Mt.k.Warning,`Failed to create restricted tenant feedback settings [Error=${e}]`)}return!0}handleGetTenantGroupSettingsSucceededAction(e){return!Ge()(this.currentTenantGroupSettings,e.tenantGroupSettings)&&(this.currentTenantGroupSettings=e.tenantGroupSettings,!0)}handleGetTenantGroupSettingsFailedAction(){return!this.currentTenantGroupSettings&&(this.currentTenantGroupSettings=Na.h.builder.withValidData().build(),!0)}handleSetGroupNamePrefixSuffixAction(e){let t=!1;return this.currentTenantGroupSettings&&(e.displayNamePrefix&&this.currentTenantGroupSettings.DisplayNamePrefix!==e.displayNamePrefix&&(this.currentTenantGroupSettings.DisplayNamePrefix=e.displayNamePrefix,t=!0),e.displayNameSuffix&&this.currentTenantGroupSettings.DisplayNameSuffix!==e.displayNameSuffix&&(this.currentTenantGroupSettings.DisplayNameSuffix=e.displayNameSuffix,t=!0),e.mailNicknamePrefix&&this.currentTenantGroupSettings.MailNicknamePrefix!==e.mailNicknamePrefix&&(this.currentTenantGroupSettings.MailNicknamePrefix=e.mailNicknamePrefix,t=!0),e.mailNicknameSuffix&&this.currentTenantGroupSettings.MailNicknameSuffix!==e.mailNicknameSuffix&&(this.currentTenantGroupSettings.MailNicknameSuffix=e.mailNicknameSuffix,t=!0)),t}handleGetSensitivityLabelsSucceededAction(e){return null==this.currentSensitivityLabels&&(this.currentSensitivityLabels=e.sensitivityLabels.sort((e,t)=>e.priority-t.priority),!0)}handleGetSensitivityLabelsFailedAction(e){return null==this.currentSensitivityLabels&&(this.currentSensitivityLabels=[],!0)}handleGetSensitivityPolicySettingsSucceededAction(e){return null==this.currentSensitivityPolicySettings&&(this.currentSensitivityPolicySettings=e.sensitivityPolicySettings,!0)}handleGetSensitivityPolicySettingsFailedAction(e){return null==this.currentSensitivityPolicySettings&&(this.currentSensitivityPolicySettings=new Ba.H,!0)}constructor(e){super(),this.loggers=e,this.currentTenantFeedbackSettings=null,this.currentTenantGroupSettings=null,this.currentSensitivityLabels=null,this.currentSensitivityPolicySettings=null}}var Ga=n(72438),Wa=n(49226),za=n(1414),ja=n(85262);class Ka extends $.r{loggingData(){return{walkthroughType:y.hs[this.walkthroughType]}}constructor(e){super(Ka.actionType),this.walkthroughType=e}}Ka.actionType="PLW_START_WALKTHROUGH";class Ha extends $.r{loggingData(){return{walkthroughType:y.hs[this.walkthroughType]}}constructor(e){super(Ha.actionType),this.walkthroughType=e}}Ha.actionType="PLW_COMPLETE_WALKTHROUGH";var Va=n(65980);class Za extends $.r{constructor(){super(Za.actionType)}}Za.actionType="PLW_SHOW_NEXTSTEP";class qa extends $.r{constructor(){super(qa.actionType)}}qa.actionType="PLW_SHOW_PREVIOUSSTEP";class Ya extends $.r{loggingData(){return{type:y.Ox[this.teachingCalloutType]}}constructor(e,t,n){super(Ya.actionType),this.teachingCalloutType=e,this.targetElement=t,this.messageParams=n}}Ya.actionType="PLW_SET_TEACHINGCALLOUT";class $a extends $.r{loggingData(){return{teachingCalloutType:y.Ox[this.teachingCalloutType]}}constructor(e){super($a.actionType),this.teachingCalloutType=e}}$a.actionType="PLW_DISMISS_TEACHINGCALLOUT";var Ja=n(12324),Xa=n(94078),Qa=n(57469);class eo extends be.z{get name(){return"PlannerWalkthroughStore"}getCurrentTeachingCalloutMessageParams(){return this._currentMessageParams}getCurrentTeachingCalloutTargetElement(){return this._currentTeachingCalloutTargetElement}getCurrentTeachingCalloutType(){return this._currentTeachingCalloutType}getCurrentWalkthroughMode(){return this._currentWalkthroughMode}getCurrentWalkthroughStepIndex(){return this._currentStepIndex}getCurrentWalkthroughType(){return this._walkthroughType}getDismissedTeachingCallouts(){return this._dismissedTeachingCallouts}hasSeenAlternateCarousel(){return this._hasSeenAlternateCarousel}handleAction(e){let t=!1;switch(e.type){case Ka.actionType:t=this.handleStartWalkthroughAction(e);break;case Ha.actionType:this._walkthroughType===y.hs.Passive&&this.loggers.usageLogger.logData(We.M.PlannerWalkthrough,We.M.PassiveWalkthroughCompleted),t=this.finishWalkthrough();break;case Va.u.actionType:t=this.skipWalkthrough(e.type);break;case Za.actionType:null!=this._currentStepIndex&&(this._currentStepIndex++,t=!0);break;case qa.actionType:null!=this._currentStepIndex&&0<this._currentStepIndex&&(this._currentStepIndex--,t=!0);break;case li.M.actionType:t=this.handleActiveWalkthroughCreateTask(e);break;case un.t.actionType:t=this.handleActiveWalkthroughCreateBucket(e);break;case ui.f.actionType:t=this.handleWalkthroughUpdateTask(e);break;case ja.V.actionType:t=this.handleActiveWalkthroughUpdateAddUser();break;case Ga.o.actionType:t=this.handleWalkthroughOpenModalDialog(e);break;case Wa.u.actionType:t=this.handlePassiveWalkthroughCloseModalDialog(e);break;case Ya.actionType:t=this.handleSetTeachingCalloutAction(e);break;case $a.actionType:const n=e;t=this.handleDismissCallout(n.teachingCalloutType);break;case za.C.actionType:t=this.skipWalkthrough(e.type),this._currentTeachingCalloutType!==y.Ox.None&&(t=this.handleDismissCallout(this._currentTeachingCalloutType)||t);break;default:return}t&&this.publishStoreChangedEvent()}initialize(){this._hasSeenAlternateCarousel=!1,this._dismissedTeachingCallouts=[];try{const e=new Qa.V(Ja.t.ElementId).getSetting(Ja.t.CurrentUserDetails),t=Xa.I.builder.fromWebResource(e).build();t.getHasSeenAssigneeReplaced()&&this._dismissedTeachingCallouts.push(y.Ox.AssigneeReplaced),t.getHasSeenTaskDetails()&&this._dismissedTeachingCallouts.push(y.Ox.TaskDetails)}catch(e){}}handleSetTeachingCalloutAction(e){let t=!1;return this._currentTeachingCalloutType!==e.teachingCalloutType&&(this._currentTeachingCalloutType=e.teachingCalloutType,t=!0),Ge()(this._currentTeachingCalloutTargetElement,e.targetElement)||(this._currentTeachingCalloutTargetElement=e.targetElement,t=!0),Ge()(this._currentMessageParams,e.messageParams)||(this._currentMessageParams=e.messageParams,t=!0),this._currentWalkthroughMode!==y._9.TeachingCallout&&(this._currentWalkthroughMode=y._9.TeachingCallout,null!=this._currentStepIndex&&this._walkthroughType===y.hs.Passive&&this._currentStepIndex++,t=!0),t}handleDismissCallout(e){let t=!1;return this._currentWalkthroughMode!==y._9.Walkthrough&&this._currentTeachingCalloutType!==y.Ox.TaskDetails&&(this._currentWalkthroughMode=y._9.Walkthrough,t=!0),this._currentTeachingCalloutType===e&&(this._currentTeachingCalloutType=y.Ox.None,t=!0),-1!==this._dismissedTeachingCallouts.indexOf(e)?t:(this._dismissedTeachingCallouts.push(e),!0)}handleStartWalkthroughAction(e){let t=!1;return e.walkthroughType===y.hs.None?null!=this._currentStepIndex&&(this._currentStepIndex=null,t=!0):(0!==this._currentStepIndex&&(this._currentStepIndex=0,e.walkthroughType===y.hs.Active?this.loggers.usageLogger.logData(We.M.PlannerWalkthrough,We.M.ActiveWalkthroughStep+(this._currentStepIndex+1)):this.loggers.usageLogger.logData(We.M.PlannerWalkthrough,We.M.PassiveWalkthroughStep+(this._currentStepIndex+1)),t=!0),this._currentWalkthroughMode!==y._9.Walkthrough&&(this._currentWalkthroughMode=y._9.Walkthrough,t=!0)),this._walkthroughType!==e.walkthroughType&&(this._walkthroughType=e.walkthroughType,t=!0),t}handleActiveWalkthroughCreateTask(e){return this._walkthroughType===y.hs.Active&&(0===this._currentStepIndex&&(this._currentStepIndex++,this.loggers.usageLogger.logData(We.M.PlannerWalkthrough,We.M.ActiveWalkthroughStep+(this._currentStepIndex+1)),!0))}handleActiveWalkthroughCreateBucket(e){return this._walkthroughType===y.hs.Active&&(1===this._currentStepIndex&&(this._currentStepIndex++,this.loggers.usageLogger.logData(We.M.PlannerWalkthrough,We.M.ActiveWalkthroughStep+(this._currentStepIndex+1)),!0))}handleWalkthroughUpdateTask(e){return this._currentWalkthroughMode===y._9.Walkthrough&&this._walkthroughType===y.hs.Active&&2===this._currentStepIndex?(this._currentStepIndex++,this.loggers.usageLogger.logData(We.M.PlannerWalkthrough,We.M.ActiveWalkthroughStep+(this._currentStepIndex+1)),!0):this._currentWalkthroughMode===y._9.TeachingCallout&&this._currentTeachingCalloutType===y.Ox.TaskDetails&&(this._currentTeachingCalloutType=y.Ox.None,-1===this._dismissedTeachingCallouts.indexOf(y.Ox.TaskDetails)&&this._dismissedTeachingCallouts.push(y.Ox.TaskDetails),!0)}handleActiveWalkthroughUpdateAddUser(){return this._walkthroughType===y.hs.Active&&(3===this._currentStepIndex&&(this.loggers.usageLogger.logData(We.M.PlannerWalkthrough,We.M.ActiveWalkthroughCompleted),this._currentStepIndex=null,this._walkthroughType=y.hs.None,!0))}handleWalkthroughOpenModalDialog(e){return e.dialogData.dialogType===pe.h.OnboardingCarousel&&!0===e.dialogData.isAlternate&&(this._hasSeenAlternateCarousel=!0,!0)}handlePassiveWalkthroughCloseModalDialog(e){return this._currentWalkthroughMode===y._9.TeachingCallout&&(this._currentTeachingCalloutType===y.Ox.TaskDetails?(this.handleDismissCallout(this._currentTeachingCalloutType),!0):this._currentTeachingCalloutType===y.Ox.None&&(this._currentWalkthroughMode=y._9.Walkthrough,!0))}skipWalkthrough(e){if(null!=this._currentStepIndex&&this._walkthroughType===y.hs.Active){const t=e===Va.u.actionType?We.M.ActiveWalkthroughSkipped:We.M.ActiveWalkthroughSkippedOnNavigate;this.loggers.usageLogger.logData(We.M.PlannerWalkthrough,t+(this._currentStepIndex+1))}else if(null!=this._currentStepIndex&&this._walkthroughType===y.hs.Passive){const t=e===Va.u.actionType?We.M.PassiveWalkthroughSkipped:We.M.PassiveWalkthroughSkippedOnNavigate;this.loggers.usageLogger.logData(We.M.PlannerWalkthrough,t+(this._currentStepIndex+1))}return this.finishWalkthrough()}finishWalkthrough(){let e=!1;return null!=this._currentStepIndex&&(e=!0,this._currentStepIndex=null,this._currentWalkthroughMode=y._9.Walkthrough),this._walkthroughType!==y.hs.None&&(this._walkthroughType=y.hs.None,e=!0),e}constructor(e){super(),this.loggers=e,this._currentMessageParams=[],this._currentStepIndex=null,this._currentTeachingCalloutType=y.Ox.None,this._currentTeachingCalloutTargetElement=null,this._currentWalkthroughMode=y._9.Walkthrough,this._walkthroughType=y.hs.None,this.initialize()}}var to=n(20977),no=n.n(to),ro=n(26410),so=n(81376),io=n(7304),ao=n(95201),oo=n(48496),lo=n(84824),co=n(49602),uo=n(45100),ho=n(51676),po=n(90548),go=n(65172),mo=n(21721);class fo extends be.z{get name(){return"PlannerGroupDocumentsStore"}getDocumentUploadSession(e){return this.groupDocumentUploadSessions.getItem(e)||null}getDriveItemsForGroup(e){return this.groupDocuments.getItem(e)||null}getDriveItemsForGroupFailureResult(e){return this.groupDocumentsFailures.getItem(e)||null}getDriveItemThumbnail(e,t){const n=this.driveItemsThumbnailList.getItem(e)||null;return null!=n?n[t]:null}getDriveItem(e){return this.driveItems.getItem(e)??null}getDriveItemStatus(e){return this.driveItems.getItemStatus(e)}getGroupFormResponse(e,t){const n=this.formResponses.getItem(e);return n?n[t]:null}handleAction(e){let t=!1;switch(e.type){case Xi.I.actionType:t=this.tryAddUploadSessionToStore(e.session,I.ZB.Creating);break;case Qi.t.actionType:t=this.tryRemoveUploadSessionFromStore(e.session.id);break;case ro.B.actionType:case so.$.actionType:case io.h.actionType:t=this.tryUpdateUploadSessionInStore(e.session,I.ZB.Stable);break;case ao.S.actionType:t=this.handleCancelUploadSessionAction(e);break;case oo.R.actionType:return void(t=this.handleCancelUploadSessionFailedAction(e));case lo.J.actionType:t=this.tryRemoveUploadSessionFromStore(e.sessionId);break;case co.W.actionType:t=this.handleGetGroupDocumentsSucceededAction(e);break;case mo.c.actionType:t=this.handleGetGroupDocumentsFailedAction(e);break;case kt.v.actionType:t=this.handleGetDriveItemSucceededAction(e);break;case Tt.N.actionType:t=this.handleGetDriveItemFailedAction(e);break;case uo.d.actionType:t=this.handleGetDriveItemThumbnailSucceededAction(e);break;case ho.z.actionType:t=this.handleGetDriveItemThumbnailFailedAction(e);break;case po.h.actionType:t=this.handleGetFormResponseSucceededAction(e);break;case go.f.actionType:t=this.handleGetFormResponseFailedAction(e);break;default:return}t&&this.publishStoreChangedEvent()}tryAddUploadSessionToStore(e,t){return null==this.groupDocumentUploadSessions.getItem(e.id)&&(this.groupDocumentUploadSessions.setItem(e.id,e),this.groupDocumentUploadSessions.setItemStatus(e.id,t),!0)}tryUpdateUploadSessionInStore(e,t){let n=!1;const r=this.groupDocumentUploadSessions.getItem(e.id);if(null!=r){Ge()(r,e)||(this.groupDocumentUploadSessions.setItem(e.id,e),n=!0);this.groupDocumentUploadSessions.getItemStatus(e.id)!==t&&(this.groupDocumentUploadSessions.setItemStatus(e.id,t),n=!0)}return n}tryRemoveUploadSessionFromStore(e){return null!=this.groupDocumentUploadSessions.getItem(e)&&(this.groupDocumentUploadSessions.removeItem(e),!0)}handleGetGroupDocumentsSucceededAction(e){let t=!1;const n=e.driveItems||[],r=e.folderId||fo.rootFolderId;let s=this.groupDocuments.getItem(e.groupId);s||(s={},t=!0),Ge()(s[r],n)||(s[r]=no()([...s[r]??[],...n],"id"),this.groupDocuments.setItem(e.groupId,s),t=!0);null!=this.groupDocumentsFailures.getItem(e.groupId)&&(this.groupDocumentsFailures.removeItem(e.groupId),t=!0);return this.groupDocuments.getItemStatus(e.groupId)!==I.ZB.Stable&&(this.groupDocuments.setItemStatus(e.groupId,I.ZB.Stable),t=!0),t}handleGetGroupDocumentsFailedAction(e){let t=!1;const{groupId:n,response:r}=e,s=null!=r?r.status:-1;return this.groupDocumentsFailures.getItem(n)!==s&&(this.groupDocumentsFailures.setItem(n,s),t=!0),t}handleGetDriveItemSucceededAction(e){let t=!1;const n=this.driveItems.getItem(e.vroomId);null!=n&&Ge()(n,e.driveItem)||(this.driveItems.setItem(e.vroomId,e.driveItem),t=!0);return this.driveItems.getItemStatus(e.vroomId)!==I.ZB.Stable&&(this.driveItems.setItemStatus(e.vroomId,I.ZB.Stable),t=!0),t}handleGetDriveItemFailedAction(e){let t=!1;if(e.response?.status===Ne.t3.Forbidden||e.response?.status===Ne.t3.NotFound){null!=this.driveItems.getItem(e.vroomId)&&(this.driveItems.setItem(e.vroomId,null),t=!0);this.driveItems.getItemStatus(e.vroomId)!==I.ZB.Inaccessible&&(this.driveItems.setItemStatus(e.vroomId,I.ZB.Inaccessible),t=!0)}return t}handleGetDriveItemThumbnailSucceededAction(e){let t=!1,n=this.driveItemsThumbnailList.getItem(e.groupId)||null;null==n&&(n={},t=!0),n[e.itemUrl]!==e.thumbnail&&(n[e.itemUrl]=e.thumbnail,this.driveItemsThumbnailList.setItem(e.groupId,n),t=!0);return this.driveItemsThumbnailList.getItemStatus(e.groupId)!==I.ZB.Stable&&(this.driveItemsThumbnailList.setItemStatus(e.groupId,I.ZB.Stable),t=!0),t}handleGetDriveItemThumbnailFailedAction(e){let t=!1,n=this.driveItemsThumbnailList.getItem(e.groupId)||null;null==n&&(n={},t=!0),""!==n[e.itemUrl]&&(n[e.itemUrl]="",this.driveItemsThumbnailList.setItem(e.groupId,n),t=!0);return this.driveItemsThumbnailList.getItemStatus(e.groupId)!==I.ZB.Stable&&(this.driveItemsThumbnailList.setItemStatus(e.groupId,I.ZB.Stable),t=!0),t}handleCancelUploadSessionAction(e){return this.groupDocumentUploadSessions.getItemStatus(e.sessionId)!==I.ZB.Deleting&&(this.groupDocumentUploadSessions.setItemStatus(e.sessionId,I.ZB.Deleting),!0)}handleCancelUploadSessionFailedAction(e){return this.groupDocumentUploadSessions.getItemStatus(e.sessionId)!==I.ZB.DeleteFailed&&(this.groupDocumentUploadSessions.setItemStatus(e.sessionId,I.ZB.DeleteFailed),!0)}handleGetFormResponseSucceededAction(e){let t=!1,n=this.formResponses.getItem(e.taskId)||null;null==n&&(n={},t=!0),n[e.formId]!==e.formResponse&&(n[e.formId]=e.formResponse,this.formResponses.setItem(e.taskId,n),t=!0);return this.formResponses.getItemStatus(e.taskId)!==I.ZB.Stable&&(this.formResponses.setItemStatus(e.taskId,I.ZB.Stable),t=!0),t}handleGetFormResponseFailedAction(e){let t=!1,n=this.formResponses.getItem(e.taskId)||null;null==n&&(n={},t=!0),null!=n[e.formId]&&(n[e.formId]=null,this.formResponses.setItem(e.taskId,n),t=!0);const r=this.formResponses.getItemStatus(e.taskId);return e.response?.status===Ne.t3.Forbidden||e.response?.status===Ne.t3.NotFound?r!==I.ZB.Inaccessible&&(this.driveItems.setItemStatus(e.taskId,I.ZB.Inaccessible),t=!0):r!==I.ZB.Stable&&(this.driveItemsThumbnailList.setItemStatus(e.taskId,I.ZB.Stable),t=!0),t}constructor(){super(),this.groupDocuments=new Se.j,this.driveItemsThumbnailList=new Se.j,this.driveItems=new Se.j,this.groupDocumentUploadSessions=new Se.j,this.groupDocumentsFailures=new Se.j,this.formResponses=new Se.j}}fo.rootFolderId="root";var yo=n(87424),vo=n.n(yo),ko=n(53672);class To extends $.r{loggingData(){return{toastId:this.toast.id,type:String(this.toast.type)}}constructor(e){super(To.actionType),this.toast=e}}To.actionType="ENQUEUE_ACTIVITY_TOAST";class So extends be.z{get name(){return"PlannerActivityNotificationStore"}getToasts(){let e=ga()(this.toastsContainer);return e=vo()(e,e=>e.createdDate),e}getVisibleToasts(){const e=this.getToasts();return on()(e,e=>e.type!==ce.Q.type)}handleAction(e){let t=!1;switch(e.type){case ko.n.actionType:t=this.handleDismissToastNotificationAction(e);break;case To.actionType:t=this.handleEnqueueActivityToastAction(e);break;default:return}t&&this.publishStoreChangedEvent()}handleDismissToastNotificationAction(e){let t=!1;return null!=this.toastsContainer[e.toastId]&&(t=!0,delete this.toastsContainer[e.toastId]),t}handleEnqueueActivityToastAction(e){return this.toastsContainer[e.toast.id]=e.toast,!0}constructor(){super(),this.toastsContainer={}}}var bo=n(14740),Io=n.n(bo),Co=n(19285),Do=n(23835),Eo=n(88080),Po=n(21845),wo=n(45679),xo=n(24367),Fo=n(42463),Ao=n(98502);class Lo extends be.z{get name(){return"PlannerNotificationStore"}getMessageType(){return this.messageType}getNotificationId(){return this.notificationId}getEntityId(){return this.entityId}getStatusCode(){return this.statusCode}getStatusText(){return this.statusText}getStringParams(){return this.stringParams}getCorrelationId(){if(this.response){const e=this.response.headers.get(ze.Yu.XCorrelationId);if(e)return e;const t=this.response.headers.get(ze.Qu.RequestId);return t||this.response.headers.get(ze.Yu.EdgeRef)}return null}getResponseText(){return this.response?.responseText??null}getReasonPhrase(){return this.response?.headers.get(ze.Yu.ReasonPhrase)??null}getAuthenticationChallengeResponse(){const e=this.response?.headers.get(ze.Yu.AuthenticationChallenge)??"";return Ao.g.tryParseAuthenticationChallengeResponse(this.getStatusCode()??-1,this.getReasonPhrase()??"",this.getResponseText()??"",e,this.loggers.traceLogger)}getTimeStamp(){return this.timestamp}getToasts(){let e=Io()(this.toastsContainer.getAllItems());return e=vo()(e,e=>e.createdDate),e}getVisibleToasts(){const e=this.getToasts();return on()(e,e=>e.type!==ce.Q.type)}handleAction(e){let t=!1;switch(e.type){case Co.Q.actionType:t=this.handleNotificationBarAction(Fo.H.error,e);break;case wo.e.actionType:t=this.handleNotificationBarAction(Fo.H.warning,e);break;case Do.i.actionType:t=this.handleNotificationBarAction(Fo.H.info,e);break;case Eo.t.actionType:t=this.handleNotificationBarAction(Fo.H.success,e);break;case Po.Y.actionType:t=this.handleClearNotificationAction();break;case ko.n.actionType:t=this.handleDismissToastNotificationAction(e);break;case xo.Z.actionType:t=this.handleEnqueueToastNotificationAction(e);break;case Ga.o.actionType:t=this.handleOpenModalDialogAction(e);break;default:return}t&&this.publishStoreChangedEvent()}handleNotificationBarAction(e,t){let n=!1;return this.messageType!==e&&(this.messageType=e,n=!0),this.notificationId!==t.notificationId&&(this.notificationId=t.notificationId,n=!0),this.entityId!==t.entityId&&(this.entityId=t.entityId||null,n=!0),this.statusCode!==t.statusCode&&(this.statusCode=t.statusCode??null,n=!0),this.statusText!==t.statusText&&(this.statusText=t.statusText||null,n=!0),this.response!==t.response&&(this.response=t.response||null,n=!0),Ge()(this.stringParams,t.stringParams)||(this.stringParams=t.stringParams||null,n=!0),this.timestamp!==t.timestamp&&(this.timestamp=t.timestamp,n=!0),n}handleClearNotificationAction(){let e=!1;return null!=this.notificationId&&(this.notificationId=null,e=!0),null!=this.entityId&&(this.entityId=null,e=!0),null!=this.statusCode&&(this.statusCode=null,e=!0),null!=this.statusText&&(this.statusText=null,e=!0),null!=this.stringParams&&(this.stringParams=null,e=!0),null!=this.response&&(this.response=null,e=!0),null!=this.timestamp&&(this.timestamp=null,e=!0),e}handleDismissToastNotificationAction(e){let t=!1;return null!=this.toastsContainer.getItem(e.toastId)&&(t=!0,this.toastsContainer.removeItem(e.toastId)),t}handleEnqueueToastNotificationAction(e){return this.toastsContainer.setItem(e.toast.id,e.toast),!0}handleOpenModalDialogAction(e){return e.dialogData.dialogType===pe.h.TaskDetails&&this.toastsContainer.getAllItems().length>0&&this.toastsContainer.removeAllItems(),!0}constructor(e){super(),this.loggers=e,this.toastsContainer=new Se.j,this.messageType=Fo.H.info,this.notificationId=null,this.entityId=null,this.statusCode=null,this.statusText=null,this.stringParams=null,this.response=null,this.timestamp=null}}var _o=n(56956),Uo=n.n(_o),Oo=n(92446),Bo=n(8842);class Mo extends be.z{get name(){return"PlannerSuiteNavStore"}getSuiteNavModel(){return this.suiteNavModel}handleAction(e){switch(e.type){case Bo.f.actionType:this.handleSuiteNavSuceeded(e.suiteNavModel),this.publishStoreChangedEvent();break;case Oo.f.actionType:this.handleSuiteNavFailed(),this.publishStoreChangedEvent()}}getUserCalendarWorkloadUrl(){let e=null;return this.suiteNavModel?.SuiteNavData?.AppsLinks&&Lt()(this.suiteNavModel.SuiteNavData.AppsLinks,t=>{if(t&&"ShellCalendar"===t.Id){let n=t.Url;n&&n.indexOf("/owa/?")>-1&&(n=n.replace("/owa/?","/calendar/addfromweb?")),e=n}}),e}getSharepointDomainUrl(e){if(this.suiteNavModel?.SuiteNavData){const e=this.suiteNavModel.SuiteNavData;if(e.SPO_RootSiteUrl)return Uo()(e.SPO_RootSiteUrl,"/");if(e.WorkloadLinks)for(const t of e.WorkloadLinks)if(t&&"ShellSites"===t.Id)return t.Url.substring(0,t.Url.indexOf(C.Lf.SiteWorkloadUrlSuffix))}if(null!=e){const t=e.getSharepointDomainUrl();if(t)return t}return null}handleSuiteNavSuceeded(e){e.SuiteNavData?.HelpLink&&(e.SuiteNavData.HelpLink.Url=Z.B.clientSettings.SuiteNavHelpUrl+e.SuiteNavData.HelpLink.Url),this.suiteNavModel=e}handleSuiteNavFailed(){this.suiteNavModel=null}constructor(){super(),this.suiteNavModel=null}}class No extends $.r{constructor(e){super(No.actionType),this.navigateToDifferentPlan=e}}No.actionType="SET_NAVIGATE_TO_DIFFERENT_PLAN";class Ro extends $.r{constructor(){super(Ro.actionType)}}Ro.actionType="SET_PLAN_LAST_ACCESS";class Go extends $.r{constructor(e){super(Go.actionType),this.animateModifiedTasks=e}}Go.actionType="SET_ANIMATE_MODIFIED_TASKS";class Wo extends $.r{constructor(e){super(Wo.actionType),this.modifiedTaskIds=e}}Wo.actionType="SET_MODIFIED_TASKS";var zo=n(5099),jo=n(35640),Ko=n.n(jo),Ho=n(47649);class Vo extends be.z{get name(){return"PlannerWywaStore"}handleAction(e){let t=!1;switch(e.type){case qt.a.actionType:t=this.handleTasksForPlanFetchSuccess(e);break;case No.actionType:t=this.handleSetNavigateToDifferentPlanAction(e);break;case Ro.actionType:t=this.handleSetPlanLastAccessAction(e);break;case Go.actionType:t=this.handleSetAnimateModifiedTasksAction(e);break;case oi.s.type:t=this.handleRouteChangeAction(e);break;case _e.Y.actionType:t=this.handleGetDiffSyncFeedSucceededAction(e);break;case Wo.actionType:t=this.handleSetModifiedTasksAction(e);break;case Ga.o.actionType:t=this.handleOpenModalDialog(e);break;case ee.type:t=this.handlePageReady(e);break;default:return}t&&this.publishStoreChangedEvent()}getNavigateToDifferentPlan(){return this.navigateToDifferentPlan}getCurrentPlanLastAccess(){return this.plansLastAccessAndFetch[this.currentPlanId]?this.plansLastAccessAndFetch[this.currentPlanId].planLastAccess:null}getCurrentPlanLastFetch(){return this.plansLastAccessAndFetch[this.currentPlanId]?this.plansLastAccessAndFetch[this.currentPlanId].planLastFetch:null}getPlanLastAccess(e){return this.plansLastAccessAndFetch[e]?this.plansLastAccessAndFetch[e].planLastAccess:null}getModifiedTaskIds(){return this.modifiedTaskIds}getAnimatedModifiedTasks(){return this.animateModifiedTasks}isModifiedTask(e){return this.modifiedTaskIds.some(t=>t===e)}handleTasksForPlanFetchSuccess(e){if(this.plansLastAccessAndFetch[e.planId]){if(e.isLastPage)return this.plansLastAccessAndFetch[e.planId].planLastFetch=Bt()(),!0}else if(e.isLastPage){const t={planLastAccess:null,planLastFetch:Bt()()};return this.plansLastAccessAndFetch[e.planId]=t,!0}return!1}handleSetNavigateToDifferentPlanAction(e){return this.navigateToDifferentPlan=e.navigateToDifferentPlan,!0}handleSetPlanLastAccessAction(e){return this.navigateToDifferentPlan=!1,this.plansLastAccessAndFetch[this.currentPlanId]?this.plansLastAccessAndFetch[this.currentPlanId].planLastAccess=Bt()().seconds(0):this.plansLastAccessAndFetch[this.currentPlanId]={planLastAccess:Bt()().seconds(0),planLastFetch:null},!0}handleSetAnimateModifiedTasksAction(e){return this.animateModifiedTasks!==e.animateModifiedTasks&&(this.animateModifiedTasks=e.animateModifiedTasks,!0)}handleRouteChangeAction(e){const t=e.pageName,n=t===zo.EC.PlanCharts||t===zo.EC.PlanSchedule||t===zo.EC.PlanTaskboard||t===zo.EC.PlanGrid;if(null==e.queryParameters||0===Ko()(e.queryParameters)||!n)return""!==this.currentPlanId&&(this.currentPlanId="",this.animateModifiedTasks=!1,this.modifiedTaskIds=[],!0);const r=e.queryParameters[zo.yx.PlanId];return this.currentPlanId!==r?(""!==r&&null==this.plansLastAccessAndFetch[r]&&(this.plansLastAccessAndFetch[r]={planLastAccess:null,planLastFetch:null}),this.currentPlanId=r,this.navigateToDifferentPlan=!0,this.modifiedTaskIds=[],this.animateModifiedTasks=!0,!0):!!this.animateModifiedTasks&&(this.animateModifiedTasks=!1,!0)}handleGetDiffSyncFeedSucceededAction(e){if(""!==this.currentPlanId){if(this.plansLastAccessAndFetch[this.currentPlanId])this.plansLastAccessAndFetch[this.currentPlanId].planLastAccess=Bt()().seconds(0);else{const e={planLastAccess:Bt()().seconds(0),planLastFetch:null};this.plansLastAccessAndFetch[this.currentPlanId]=e}return!0}return!1}handleSetModifiedTasksAction(e){return this.modifiedTaskIds=e.modifiedTaskIds,!0}handleOpenModalDialog(e){let t=!1;if(e.dialogData.dialogType===pe.h.TaskDetails){const n=e.dialogData.taskId;this.isModifiedTask(n)&&(this.loggers.usageLogger.logData(We.M.WywaStore,We.M.OpenTaskDetailsOfModifiedTask,{taskCreationSourceType:e.dialogData.taskCreationSource??""}),Ce()(this.modifiedTaskIds,e=>(e===n&&(t=!0),e===n))),this.loggers.usageLogger.logData(We.M.WywaStore,We.M.OpenTaskDetails,{taskCreationSourceType:e.dialogData.taskCreationSource??""})}return t}handlePageReady(e){if(!this.animateModifiedTasks)return!1;return Ho.v.create().setTimeout(()=>{this.animateModifiedTasks=!1},this.taskAnimationDelay),!1}constructor(e,t,n,r){super(),this.loggers=r,this.plansLastAccessAndFetch={},this.navigateToDifferentPlan=null!=n,this.currentPlanId=n??"",this.modifiedTaskIds=[],this.animateModifiedTasks=!1,this.taskAnimationDelay=t;for(const s in e){const t={planLastAccess:Bt()(e[s].lastAccess).seconds(0),planLastFetch:null};this.plansLastAccessAndFetch[s]=t}}}var Zo=n(94030),qo=n(32520),Yo=n.n(qo);class $o{get name(){return"PlannerAssigneeSuggestionStore"}getAssigneeSuggestions(e,t){const n=this.planAssigneeSuggestions[e];return null==n?[]:this.rankAssigneeSuggestions(this.addSimilarTaskAssignees(t,n))}handleAction(e){e.type===qt.a.actionType&&this.flights.EnableSuggestedAssignee&&this.handleGetTasksForPlan(e)}handleGetTasksForPlan(e){this.planTasks=e.tasks.map(e=>e.task);const t=e.planId,n={};return this.planTasks.forEach(e=>{e.getAssigneeIds().forEach(t=>{if(t!==this.currentUserID){const r=n[t]??{numActiveTasks:0,numTasksAssignedInPlan:0,numTasksAssignedByCurrentUser:0};r.numTasksAssignedInPlan++,(0,rn.Fk)(e.percentComplete)===nn.$.InProgress&&r.numActiveTasks++,e.createdBy===this.currentUserID&&r.numTasksAssignedByCurrentUser++,n[t]=r}})}),this.planAssigneeSuggestionData[t]=n,this.populatePlanAssigneeSuggestions(t),!0}populatePlanAssigneeSuggestions(e){let t=[],n=[],r=[];const s=[],i=this.planAssigneeSuggestionData[e]??{};for(const a in i){const e=i[a];if(null!=e){if(0!==e.numTasksAssignedByCurrentUser)if(0===t.length)t.push(a);else for(let n=0;n<=t.length;n++){const r=i[t[n]];if(0!==e.numTasksAssignedByCurrentUser){if(null!=r&&e.numTasksAssignedByCurrentUser>=r.numTasksAssignedByCurrentUser){t.splice(n,0,a);break}n===t.length-1&&t.push(a)}}if(0===n.length)n.push(a);else for(let t=0;t<=n.length;t++){const r=i[n[t]];if(null!=r&&e.numTasksAssignedInPlan>=r.numTasksAssignedInPlan){n.splice(t,0,a);break}t===n.length-1&&n.push(a)}if(0===r.length)r.push(a);else for(let t=0;t<=r.length;t++){const n=i[r[t]];if(null!=n&&e.numActiveTasks<=n.numActiveTasks){r.splice(t,0,a);break}t===r.length-1&&r.push(a)}}t.length>this.maxNumOfSuggestions&&(t=t.slice(0,this.maxNumOfSuggestions)),n.length>this.maxNumOfSuggestions&&(n=n.slice(0,this.maxNumOfSuggestions)),r.length>this.maxNumOfSuggestions&&(r=r.slice(0,this.maxNumOfSuggestions))}t.forEach(e=>{const n=Yo()(s,t=>t.userId===e);n>=0?s[n]={...s[n],weight:s[n].weight+this.usersTopAssigneesWeight-this.rankingDownIncrement*t.indexOf(e)}:s.push({userId:e,weight:this.usersTopAssigneesWeight-this.rankingDownIncrement*t.indexOf(e),context:Zo.n.UserTopAssignee})}),r.forEach(e=>{const t=Yo()(s,t=>t.userId===e);t>=0?s[t]={...s[t],weight:s[t].weight+this.mostAvailableAssigneesWeight-this.rankingDownIncrement*r.indexOf(e)}:s.push({userId:e,weight:this.mostAvailableAssigneesWeight-this.rankingDownIncrement*r.indexOf(e),context:Zo.n.MostAvailableUser})}),n.forEach(e=>{const t=Yo()(s,t=>t.userId===e);t>=0?s[t]={...s[t],weight:s[t].weight+this.plansTopAssigneesWeight-this.rankingDownIncrement*n.indexOf(e)}:s.push({userId:e,weight:this.plansTopAssigneesWeight-this.rankingDownIncrement*n.indexOf(e),context:Zo.n.PlanTopAssignee})}),this.planAssigneeSuggestions[e]=s}addSimilarTaskAssignees(e,t){const n=t.map(e=>({...e}));for(const r of e)r.getAssigneeIds().forEach(e=>{const t=Yo()(n,t=>t.userId===e);t>=0?(n[t].context===Zo.n.UserTopAssignee?n[t]={...n[t],weight:n[t].weight+this.similarTaskAssigneesWeight}:n[t]={...n[t],weight:n[t].weight+this.similarTaskAssigneesWeight,context:Zo.n.SimilarTaskTitle},n[t]={...n[t],weight:n[t].weight+this.similarTaskAssigneesWeight}):n.push({userId:e,weight:this.similarTaskAssigneesWeight,context:Zo.n.SimilarTaskTitle})});return n}rankAssigneeSuggestions(e){return e.sort((e,t)=>t.weight-e.weight),e.length>this.maxNumOfSuggestions&&(e=e.slice(0,this.maxNumOfSuggestions)),e}constructor(e){this.usersTopAssigneesWeight=1,this.similarTaskAssigneesWeight=.8,this.mostAvailableAssigneesWeight=.6,this.plansTopAssigneesWeight=.4,this.rankingDownIncrement=.05,this.maxNumOfSuggestions=5,this.planAssigneeSuggestionData={},this.planAssigneeSuggestions={},this.planTasks=[],this.flights={...Z.B.clientSettings.Flights},this.currentUserID=e}}var Jo=n(13328),Xo=n(88028);function Qo(e,t){if(null!=e){var n=[];Lt()(e,function(e,t){"extraData"===t?Lt()(e,function(e,t){n.push((0,Xo.by)(Jo.Bx.Eupl,t,String(e)))}):n.push((0,Xo.by)(Jo.Bx.Eupl,t,String(e)))}),t.log({type:Jo.Bx.Eupl,payload:n})}}function el(e,t){if(null!=e){var n=[];Lt()(e,function(e,t){n.push((0,Xo.by)(Jo.Bx.PageInit,t,String(e)))}),t.log({type:Jo.Bx.PageInit,payload:n})}}var tl=function(){function e(){}return e.init=function(e){!function(e,t){(0,Xo.$s)(e,el,t)}({screenWidth:window.screen.width,screenHeight:window.screen.availHeight,availableScreenWidth:window.screen.availWidth,availableScreenHeight:window.screen.availHeight,renderWidth:window.innerWidth,renderHeight:window.innerHeight,browserWidth:window.outerWidth,browserHeight:window.outerHeight,devicePixelRatio:window.devicePixelRatio?window.devicePixelRatio:0},e)},e}();function nl(e,t){if(null!=e){var n=[];Lt()(e,function(e,t){"extraData"===t?Lt()(Object(e),function(e,t){n.push((0,Xo.by)(Jo.Bx.Ptt,t,String(e)))}):n.push((0,Xo.by)(Jo.Bx.Ptt,t,String(e)))}),t.log({type:Jo.Bx.Ptt,payload:n})}}var rl,sl=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),il=function(e){function t(t){var n=e.call(this)||this;return n.logHandler=t,n.startTime=0,n.pageName="",n.previousPageName="",n.initialHttpRequestCount=0,n.euplLogged=!1,n.pageInitLogged=!1,n.routeChangesSeen=0,n.lastLargestHttpRequestReponseEnd=-1,n}return sl(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"PerformanceCollectionStore"},enumerable:!1,configurable:!0}),t.prototype.handleAction=function(e){switch(e.type){case X.type:this.setAppStart(e);break;case ee.type:this.pageReady(e);break;case oi.s.type:this.handleRouteChange(e)}},t.prototype.setAppStart=function(e){if(this.pageInitLogged)throw new Error("setAppStart() method cannot be called more than once.");this.pageInitLogged=!0,this.pageName=e.pageName,this.startTime=e.appStartTime,this.initialHttpRequestCount=this.getHttpRequestsLength(),tl.init(this.logHandler),this.publishStoreChangedEvent()},t.prototype.handleRouteChange=function(e){this.startTime=e.timestamp,this.previousPageName=this.pageName,this.pageName=e.pageName,this.routeChangesSeen++,this.publishStoreChangedEvent()},t.prototype.pageReady=function(e){var t,n,r=this.calculatePageTransitionTimeData(e);if(t=r,n=this.logHandler,(0,Xo.$s)(t,nl,n),this.shouldLogEupl()){var s=this.calculateMainPageRequestData();s.metaTag=e.metaTag||"",s.extraData=e.extraData||{},s.pageName=r.pageName,s.preDataFetch=r.preDataFetch,s.dataFetch=r.dataFetch,s.httpRequestCount=this.initialHttpRequestCount+r.httpRequestCount,s.euplFull=s.pltFull+s.appStart+r.pttFull,function(e,t){(0,Xo.$s)(e,Qo,t)}(s,this.logHandler)}this.euplLogged=!0,this.publishStoreChangedEvent()},t.prototype.shouldLogEupl=function(){return!this.euplLogged&&!(this.routeChangesSeen>1)},t.prototype.calculateMainPageRequestData=function(){var e={};if(null!=window.performance&&null!=window.performance.timing){var t=window.performance.timing;e.navigationStart=t.navigationStart,e.unloadEventStart=t.unloadEventStart,e.unloadEventEnd=t.unloadEventEnd,e.redirectStart=t.redirectStart,e.redirectEnd=t.redirectEnd,e.fetchStart=t.fetchStart,e.domainLookupStart=t.domainLookupStart,e.domainLookupEnd=t.domainLookupEnd,e.connectStart=t.connectStart,null!=t.secureConnectionStart&&0!==t.secureConnectionStart&&(e.secureConnectionStart=t.secureConnectionStart),e.connectEnd=t.connectEnd,e.requestStart=t.requestStart,e.responseStart=t.responseStart,e.responseEnd=t.responseEnd,e.domLoading=t.domLoading,e.domInteractive=t.domInteractive,e.domContentLoadedEventStart=t.domContentLoadedEventStart,e.domContentLoadedEventEnd=t.domContentLoadedEventEnd,e.domComplete=t.domComplete,e.loadEventStart=t.loadEventStart,e.loadEventEnd=t.loadEventEnd;var n=e.loadEventEnd>0?e.loadEventEnd:e.domComplete;e.pltFull=n-e.navigationStart,e.pltRedir=e.fetchStart-e.navigationStart,e.pltNetwork=e.responseEnd-e.fetchStart,e.pltDom=n-e.domLoading,e.pltNetworkDomGap=e.domLoading=e.responseEnd,e.appStart=this.startTime-n}return null!=window.performance&&null!=window.performance.navigation&&(e.redirCount=window.performance.navigation.redirectCount||0,e.navType=window.performance.navigation.type||-1),e},t.prototype.calculatePageTransitionTimeData=function(e){return{pageName:this.pageName,previousPageName:this.previousPageName,pttFull:e.dataFetchEndTime-this.startTime,preDataFetch:e.dataFetchStartTime-this.startTime,dataFetch:e.dataFetchEndTime-e.dataFetchStartTime,httpRequestCount:this.getHttpRequestsLength(),extraData:e.extraData}},t.prototype.getHttpRequestsLength=function(){var e=this,t=this.lastLargestHttpRequestReponseEnd,n=0;if(null!=window.performance&&null!=window.performance.getEntriesByType){var r=performance.getEntriesByType("resource");Lt()(r,function(r){null!=r.responseEnd&&r.responseEnd>e.lastLargestHttpRequestReponseEnd&&(r.responseEnd>t&&(t=r.responseEnd),n++)})}return this.lastLargestHttpRequestReponseEnd=t,n},t}(be.z),al=n(17942),ol=n(70596),ll=n(80493),cl=n(52195),dl=n(71484),ul="_png",hl="_svg",pl=[16,20,24,32,40,48,64,96];function gl(e,t){void 0===e&&(e="https://spoppe-b.azureedge.net/files/fabric-cdn-prod_20221015.001/assets/item-types/"),pl.forEach(function(n){!function(e,t,n){var r=Object.keys(dl.K),s={};r.forEach(function(n){var r=e+t+"/"+n;s[n+t+ul]=p.createElement("img",{src:r+".png",alt:""}),s[n+t+hl]=p.createElement("img",{src:r+".svg",alt:""}),s[n+t+"_1.5x"+ul]=p.createElement("img",{src:e+t+"_1.5x/"+n+".png",height:"100%",width:"100%",alt:""}),s[n+t+"_1.5x"+hl]=p.createElement("img",{src:e+t+"_1.5x/"+n+".svg",height:"100%",width:"100%",alt:""}),s[n+t+"_2x"+ul]=p.createElement("img",{src:e+t+"_2x/"+n+".png",height:"100%",width:"100%",alt:""}),s[n+t+"_3x"+ul]=p.createElement("img",{src:e+t+"_3x/"+n+".png",height:"100%",width:"100%",alt:""}),s[n+t+"_4x"+ul]=p.createElement("img",{src:e+t+"_4x/"+n+".png",height:"100%",width:"100%",alt:""})}),(0,cl.K1)({fontFace:{},style:{width:t,height:t,overflow:"hidden"},icons:s,mergeImageProps:!0},n)}(e,n,t)})}!function(e){e.isAuthenticationFailureNotification=function(e){const t=e.getNotificationId(),n=e.getStatusCode();return null!=t&&(t===B.fc.RefreshAuthTokenError||t===B.fc.RefreshAuthTokenIEError||t===B.fc.UnauthenticatedError||t===B.fc.UserInterationRequiredAuthError||401===n)}}(rl||(rl={}));class ml{getCurrentDelayInterval(){let e=Math.pow(this.baseInterval,this.exponentialBackOffFactor);return e>this.cutoff&&(e=this.cutoff),e}incrementThresholdCounter(){this.backoffCounter++,this.backoffCounter>=this.minThreshold&&this.exponentialBackOffFactor++}resetThresholdCounter(){this.backoffCounter=0,this.exponentialBackOffFactor=1}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;this.baseInterval=e,this.cutoff=t,this.minThreshold=n,this.backoffCounter=0,this.exponentialBackOffFactor=1}}class fl{isPageHidden(){return"hidden"===document.visibilityState}}var yl=n(40729),vl=n(82841),kl=n(48924),Tl=n(86053),Sl=n(79537);class bl{getItem(e){const t=this.getPrefixedKey(e);return this.storage.getItem(t)}setItem(e,t){try{const n=this.getPrefixedKey(e);this.storage.setItem(n,t)}catch(n){this.traceLogger.logTrace(507778500,Mt.k.Warning,`Persisted storage failure [Error=${Sl.f.getMessage(n)}][StackTrace=${Sl.f.getStackTrace(n)}]`)}}removeItem(e){const t=this.getPrefixedKey(e);return this.storage.removeItem(t)}getPrefixedKey(e){return`${bl.AppStorageKeyPrefix}-${Z.B.clientType}-${Z.B.currentUserId}-${e}`}constructor(e,t){this.storage=e,this.traceLogger=t}}bl.AppStorageKeyPrefix="planner";var Il,Cl=n(17090),Dl=n(46530),El=n(11910),Pl=n(24723),wl=n(12358),xl=n.n(wl),Fl=n(88880),Al=n(33268);!function(e){e[e.Creation=0]="Creation",e[e.Assignment=1]="Assignment",e[e.Unassignment=2]="Unassignment",e[e.Completion=3]="Completion",e[e.Publication=4]="Publication"}(Il||(Il={}));class Ll{generateFakeCreationPost(e){let t=this.getCurrentUser(),n=e.createdDate;const r=e.creationSource;if(r.publication){const e=this.getUser(r.publication.sourceTeamId);n=r.publication.lastModifiedTime,t=null!=e?e:Dl._.getUnknownUser(r.publication.sourceTeamId)}else if(null!=e.createdBy){const n=this.getUser(e.createdBy);t=null!=n?n:t=Dl._.getUnknownUser(e.createdBy)}const s=this.getCoreMessageTemplate(e.taskCreationSourceType===Pl.w3.Regular?0:4),i=Tl.p.Strings.TaskActivityFeed_TaskFeedPrincipal;let a=s.replace("{0}",i);return a=a.replace("{1}",xl()(e.title)),a='<div><font size="2"> <span style="font-size:10pt;">'+a+"</span></font></div>",El.L.builder.withPropertyBag({body:El.L.generatePostBody(a),hasAttachments:!1,conversationId:e.conversationThreadId??void 0,conversationThreadId:e.conversationThreadId??void 0,id:e.id,fromField:{emailAddress:{address:t.mail,name:t.displayName}},sender:{emailAddress:{address:t.mail,name:t.displayName}},createdDateTime:n}).build()}getTaskActivityFeed(e,t,n,r,s,i){let a="";const o=Tl.p.Strings.TaskActivityFeed_TaskFeedPrincipal;let l=null;if(null!=t.task){if(null==e){if(n===Cl.b.TaskAssignment||n===Cl.b.All){const e=t.task.getAssigneeIds();a=this.appendTaskAssignmentChangeMessage(a,t,o,e,!1)}n!==Cl.b.TaskCompleted&&n!==Cl.b.All||(a=this.appendTaskCompletionMessage(a,t,o))}else{if(n===Cl.b.TaskAssignment||n===Cl.b.All){const n=ta.Y.getAddedAssignees(e.task,t.task);a=this.appendTaskAssignmentChangeMessage(a,t,o,n,!1);const r=ta.Y.getRemovedAssignees(e.task,t.task);a=this.appendTaskAssignmentChangeMessage(a,t,o,r,!0)}n!==Cl.b.TaskCompleted&&n!==Cl.b.All||100!==e.task.percentComplete&&(a=this.appendTaskCompletionMessage(a,t,o))}if(a.length>0){a='<div><font size="2"><span style="font-size:10pt;">'+a+"</span></font></div>"+(null==t.task.conversationThreadId?Fl.i.getFirstCommentEmailContent(s,i,r.title):Fl.i.getCommentReplyEmailContent(s,t.task.title,i,r.title));const e=this.getCurrentUser();l=El.L.builder.withPropertyBag({body:El.L.generatePostBody(a),conversationId:void 0,conversationThreadId:void 0,hasAttachments:!1,fromField:{emailAddress:{address:e.mail,name:e.displayName}}}).withLocallyUniqueId().build()}}return null!=l&&this.traceLogger.logTrace(507778448,Mt.k.Info,"Generated task update activity feed"),l}getCoreMessageTemplate(e){let t="";switch(e){case 1:t=Tl.p.Strings.TaskActivityFeed_AssignmentFeedTemplate;break;case 2:t=Tl.p.Strings.TaskActivityFeed_UnassignmentFeedTemplate;break;case 3:t=Tl.p.Strings.TaskActivityFeed_CompletionFeedTemplate;break;case 0:t=Tl.p.Strings.TaskActivityFeed_CreationFeedTemplate;break;case 4:t=Tl.p.Strings.TaskActivityFeed_PublicationFeedTemplate}return t}appendTaskAssignmentChangeMessage(e,t,n,r,s){if(r.length<=0)return e;let i="";return r.forEach(e=>{let t=this.getUser(e);t||(t=Dl._.getUnknownUser(e)),i=i.concat((i.length>0?", ":"")+t.displayName)}),e.length>0&&(e=e.concat("<br>")),e=(e=(e=e.concat(this.getCoreMessageTemplate(s?2:1).replace("{0}",n))).replace("{2}",i)).replace("{1}",Al.wS.generateEntityHyperlink(t.task,B._n.Comment,B.rl.GroupMailbox,new Date))}appendTaskCompletionMessage(e,t,n){if(t.task.percentComplete<100||!t.task.completedBy)return e;e.length>0&&(e=e.concat("<br>"));const r=this.getUser(t.task.completedBy)??Dl._.getUnknownUser(t.task.completedBy);return e=(e=(e=e.concat(this.getCoreMessageTemplate(3).replace("{0}",n))).replace("{2}",r.displayName)).replace("{1}",Al.wS.generateEntityHyperlink(t.task,B._n.Comment,B.rl.GroupMailbox,new Date))}constructor(e,t,n){this.traceLogger=n,this.getUser=e,this.getCurrentUser=t}}class _l{readAsDataURL(e){this.fileReader.readAsDataURL(e)}constructor(){this.fileReader=new FileReader,this.fileReader.onerror=e=>{this.onerror(e)},this.fileReader.onload=e=>{this.onload(e)}}}var Ul=n(19864),Ol=n(53175),Bl=n(8403),Ml=n(53443),Nl=n(72761),Rl=n(17776),Gl=n(97139),Wl=n(99463),zl=n.n(Wl);class jl{onDiffSyncStoreUpdate(){const e=this.diffSyncStore.getLastDiffSyncFeed();if(null!=e&&e!==this.lastDiffSyncFeed){try{this.processFeedUpdates(e.updates)}catch(t){this.loggers.traceLogger.logTrace(507786944,Mt.k.Error,Nt.f.getMessage(t))}this.lastDiffSyncFeed=e}}async processFeedUpdates(e){const t=[];for(let n=0;n<e.length;n++)if(!t[n]){t[n]=!0;const r=e[n];switch(r.entityType){case Nl.I.Task:await this.processTaskUpdate(r,e,n,t);break;case Nl.I.TaskDetails:await this.processTaskDetailsUpdate(r,e,n,t);break;case Nl.I.Plan:await this.processPlanUpdate(r,e,n,t);break;case Nl.I.PlanDetails:await this.processPlanDetailsUpdate(r,e,n,t);break;case Nl.I.User:break;case Nl.I.UserDetails:await this.processUserDetailsUpdate(r,e,n,t);break;case Nl.I.TaskboardStatusFormatting:break;case Nl.I.TaskboardStatusTaskFormatting:await this.processTaskProgressFmtUpdate(r,e,n,t);break;case Nl.I.TaskboardAssignedToFormatting:break;case Nl.I.TaskboardAssignedToTaskFormatting:await this.processTaskAssignedToFmtUpdate(r,e,n,t);break;case Nl.I.Bucket:await this.processBucketUpdate(r,e,n,t);break;case Nl.I.TaskboardBucketFormatting:break;case Nl.I.TaskboardBucketTaskFormatting:await this.processTaskBucketFmtUpdate(r,e,n,t)}}this.shouldRecalculateRecommendedPlans&&this.recalculateRecommendedPlansOnAssignmentChanges(e)}async processTaskUpdate(e,t,n,r){const s=e.id,i=this.taskStore.getTask(s),a=this.taskStore.getTaskDetails(s),o=this.taskStore.getTaskboardTaskFormatting(s);if(e.updateType===Ml.U.Insert){if(i)return;const a=ta.Y.builder.newFromDifferentialUpdate(e).build();if(this.loadTaskMissingData(a))return;let o,l;const c=Yo()(t,e=>e&&e.entityType===Nl.I.TaskDetails&&e.id===s,n+1);let d,u,h;-1!==c?(o=na.U.builder.newFromDifferentialUpdate(t[c]).build(),r[c]=!0):this.retrieveTaskDetails(s);const p=Yo()(t,e=>e&&e.entityType===Nl.I.TaskboardAssignedToTaskFormatting&&e.id===s,n+1);-1!==p?(d=sa.x.builder.newFromDifferentialUpdate(t[p]).build(),r[p]=!0):this.retrieveTaskFormatsForTask(a,s,aa.s.AssignedTo);const g=Yo()(t,e=>e&&e.entityType===Nl.I.TaskboardBucketTaskFormatting&&e.id===s,n+1);-1!==g?(u=Rl.g.builder.newFromDifferentialUpdate(t[g]).build(),r[g]=!0):this.retrieveTaskFormatsForTask(a,s,aa.s.Bucket);const m=Yo()(t,e=>e&&e.entityType===Nl.I.TaskboardStatusTaskFormatting&&e.id===s,n+1);-1!==m?(h=Gl.j.builder.newFromDifferentialUpdate(t[m]).build(),r[m]=!0):this.retrieveTaskFormatsForTask(a,s,aa.s.Progress),(d||u||h)&&(l=ia._.builder.withPropertyBag({assignedBoardFormat:d,bucketBoardFormat:u,progressBoardFormat:h}).build());const f=ra.F.builder.withTask(a).withDetails(o).withFormatData(l).build(),y=this.applyMultipleTaskUpdates(f,t,n,r);(await this.actionCreatorProviders.diffSyncActionCreator()).applyInsertTask(y)}else if(e.updateType===Ml.U.Delete){if(null==i)return;const t=i.applyDifferentialUpdate(e);(await this.actionCreatorProviders.diffSyncActionCreator()).applyDeleteTask(ra.F.builder.withTask(t).build())}else if(e.updateType===Ml.U.Update)if(null==i){(await this.actionCreatorProviders.taskActionCreator()).fetchTaskEntityGroup(s,!0,!0)}else{let l;if(1===this.compareItemVersions(e.itemVersion,i.itemVersion)&&(l=i.applyDifferentialUpdate(e),this.loadTaskMissingData(l)),null==a&&this.retrieveTaskDetails(s),null==o&&(this.retrieveTaskFormats(s,aa.s.AssignedTo),this.retrieveTaskFormats(s,aa.s.Bucket),this.retrieveTaskFormats(s,aa.s.Progress)),l){const e=ra.F.builder.withTask(i).withDetails(a||void 0).withFormatData(o||void 0).build(),s=this.applyMultipleTaskUpdates(ra.F.builder.withTask(l).withDetails(a||void 0).withFormatData(o||void 0).build(),t,n,r);(await this.actionCreatorProviders.diffSyncActionCreator()).applyUpdateTask(e,s)}}}applyMultipleTaskUpdates(e,t,n,r){let s=e.task;s&&(s=this.processMultipleUpdates(s,n+1,t,r));let i=e.taskDetails;i&&(i=this.processMultipleUpdates(i,n+1,t,r));let a=e.taskFormatData;if(a){let e=a.assignmentBoardFormat;e&&(e=this.processMultipleUpdates(e,n+1,t,r));let s=a.bucketBoardFormat;s&&(s=this.processMultipleUpdates(s,n+1,t,r));let i=a.progressBoardFormat;i&&(i=this.processMultipleUpdates(i,n+1,t,r)),a=ia._.builder.withPropertyBag({assignedBoardFormat:e,bucketBoardFormat:s,progressBoardFormat:i}).build()}return ra.F.builder.withTask(s).withDetails(i).withFormatData(a).build()}processMultipleUpdates(e,t,n,r){let s=!1,i=e;for(let a=t;!s&&a<n.length;a++){const t=n[a];r[a]||t.id!==e.id||t.entityType!==e.entityType||(t.updateType===Ml.U.Update?1===this.compareItemVersions(t.itemVersion,i.itemVersion)&&(i=i.applyDifferentialUpdate(t),r[a]=!0):s=!0)}return i}async processTaskDetailsUpdate(e,t,n,r){const s=e.id,i=this.taskStore.getTask(s),a=this.taskStore.getTaskDetails(s);if(e.updateType===Ml.U.Insert){if(a)return;if(!i)return void this.retrieveTaskEntitySet(s);const o=na.U.builder.newFromDifferentialUpdate(e).build(),l=this.processMultipleUpdates(o,n+1,t,r);(await this.actionCreatorProviders.diffSyncActionCreator()).applyInsertTaskDetails(l)}else if(e.updateType===Ml.U.Update){if(!i||!a)return void this.retrieveTaskEntitySet(s);if(1!==this.compareItemVersions(e.itemVersion,a.itemVersion))return;const o=a.applyDifferentialUpdate(e),l=this.processMultipleUpdates(o,n+1,t,r);for(const e in l.references)if(!a.references[e]||a.references[e].previewPriority!==l.references[e].previewPriority){(await this.actionCreatorProviders.taskActionCreator()).fetchReferencePreviewForTask(s);break}if((await this.actionCreatorProviders.diffSyncActionCreator()).applyUpdateTaskDetails(a,l),l.approval!==a.approval){(await this.actionCreatorProviders.taskActionCreator()).fetchApprovalDetailsForTask(s)}}}async processBucketUpdate(e,t,n,r){const s=e.id,i=this.bucketStore.getBucket(s);if(e.updateType===Ml.U.Insert){if(i)return;const s=Bl.f.builder.newFromDifferentialUpdate(e).build();if(this.loadBucketMissingData(s))return;const a=this.processMultipleUpdates(s,n+1,t,r);(await this.actionCreatorProviders.diffSyncActionCreator()).applyInsertBucket(a)}else if(e.updateType===Ml.U.Delete){if(!i)return;(await this.actionCreatorProviders.diffSyncActionCreator()).applyDeleteBucket(s)}else if(e.updateType===Ml.U.Update){if(!i)return void this.retrieveBucket(s);if(1!==this.compareItemVersions(e.itemVersion,i.itemVersion))return;const a=i.applyDifferentialUpdate(e),o=this.processMultipleUpdates(a,n+1,t,r);(await this.actionCreatorProviders.diffSyncActionCreator()).applyUpdateBucket(o)}}async processPlanUpdate(e,t,n,r){const s=e.id,i=this.planStore.getPlan(s),a=this.planStore.getPlanDetails(s)||void 0;if(e.updateType===Ml.U.Delete){if(!i)return;const t=i.applyDifferentialUpdate(e);(await this.actionCreatorProviders.diffSyncActionCreator()).applyDeletePlan(t)}else if(e.updateType===Ml.U.Update){if(!i)return void this.retrievePlanEntitySet(s);let o=null;if(1===this.compareItemVersions(e.itemVersion,i.itemVersion)&&(o=i.applyDifferentialUpdate(e)),a||this.retrievePlanEntitySet(s),o){o=this.processMultipleUpdates(o,n+1,t,r),this.updateUserDetailsWithPlan(o,a);const e=a?this.processMultipleUpdates(a,n+1,t,r):void 0;(await this.actionCreatorProviders.diffSyncActionCreator()).applyUpdatePlan(ri.T.builder.withPlan(o).withDetails(e).build())}}}async processPlanDetailsUpdate(e,t,n,r){const s=e.id,i=this.planStore.getPlan(s),a=this.planStore.getPlanDetails(s);if(e.updateType===Ml.U.Update){if(!i||!a)return void this.retrievePlanEntitySet(s);if(1!==this.compareItemVersions(e.itemVersion,a.itemVersion))return;const o=a.applyDifferentialUpdate(e),l=this.processMultipleUpdates(o,n+1,t,r);(await this.actionCreatorProviders.diffSyncActionCreator()).applyUpdatePlanDetails(l)}}async processUserDetailsUpdate(e,t,n,r){if(e.updateType!==Ml.U.Update)return;const s=e.id,i=this.userStore.getUserDetailsById(s);if(!i)return;if(1!==this.compareItemVersions(e.itemVersion,i.itemVersion))return;const a=i.applyDifferentialUpdate(e),o=this.processMultipleUpdates(a,n+1,t,r);(await this.actionCreatorProviders.diffSyncActionCreator()).applyUpdateUserDetails(o)}async processTaskAssignedToFmtUpdate(e,t,n,r){const s=e.id,i=this.taskStore.getTask(s),a=this.taskStore.getTaskboardTaskFormatting(s);if(e.updateType===Ml.U.Insert){if(a?.assignmentBoardFormat)return;if(!i)return void this.retrieveTaskFormats(s,aa.s.AssignedTo);const o=sa.x.builder.newFromDifferentialUpdate(e).build(),l=this.processMultipleUpdates(o,n+1,t,r),c=ia._.builder.withPropertyBag({assignedBoardFormat:l}).build();(await this.actionCreatorProviders.diffSyncActionCreator()).applyInsertTaskFormatData(c)}else if(e.updateType===Ml.U.Update){if(!a?.assignmentBoardFormat)return void this.retrieveTaskFormats(s,aa.s.AssignedTo);if(1!==this.compareItemVersions(e.itemVersion,a.assignmentBoardFormat.itemVersion))return;const i=a.assignmentBoardFormat.applyDifferentialUpdate(e),o=this.processMultipleUpdates(i,n+1,t,r),l=ia._.builder.withPropertyBag({assignedBoardFormat:o}).build();(await this.actionCreatorProviders.diffSyncActionCreator()).applyUpdateTaskFormatData(a,l)}}async processTaskBucketFmtUpdate(e,t,n,r){const s=e.id,i=this.taskStore.getTask(s),a=this.taskStore.getTaskboardTaskFormatting(s);if(e.updateType===Ml.U.Insert){if(a?.bucketBoardFormat)return;if(!i)return void this.retrieveTaskFormats(s,aa.s.Bucket);const o=Rl.g.builder.newFromDifferentialUpdate(e).build(),l=this.processMultipleUpdates(o,n+1,t,r),c=ia._.builder.withPropertyBag({bucketBoardFormat:l}).build();(await this.actionCreatorProviders.diffSyncActionCreator()).applyInsertTaskFormatData(c)}else if(e.updateType===Ml.U.Update){if(!a?.bucketBoardFormat)return void this.retrieveTaskFormats(s,aa.s.Bucket);if(1!==this.compareItemVersions(e.itemVersion,a.bucketBoardFormat.itemVersion))return;const i=a.bucketBoardFormat.applyDifferentialUpdate(e),o=this.processMultipleUpdates(i,n+1,t,r),l=ia._.builder.withPropertyBag({bucketBoardFormat:o}).build();(await this.actionCreatorProviders.diffSyncActionCreator()).applyUpdateTaskFormatData(a,l)}}async processTaskProgressFmtUpdate(e,t,n,r){const s=e.id,i=this.taskStore.getTask(s),a=this.taskStore.getTaskboardTaskFormatting(s);if(e.updateType===Ml.U.Insert){if(a?.progressBoardFormat)return;if(!i)return void this.retrieveTaskFormats(s,aa.s.Progress);const o=Gl.j.builder.newFromDifferentialUpdate(e).build(),l=this.processMultipleUpdates(o,n+1,t,r),c=ia._.builder.withPropertyBag({progressBoardFormat:l}).build();(await this.actionCreatorProviders.diffSyncActionCreator()).applyInsertTaskFormatData(c)}else if(e.updateType===Ml.U.Update){if(!a?.progressBoardFormat)return void this.retrieveTaskFormats(s,aa.s.Progress);if(1!==this.compareItemVersions(e.itemVersion,a.progressBoardFormat.itemVersion))return;const i=a.progressBoardFormat.applyDifferentialUpdate(e),o=this.processMultipleUpdates(i,n+1,t,r),l=ia._.builder.withPropertyBag({progressBoardFormat:o}).build();(await this.actionCreatorProviders.diffSyncActionCreator()).applyUpdateTaskFormatData(a,l)}}async recalculateRecommendedPlansOnAssignmentChanges(e){const t=this.appContextStore.getCurrentUserId(),n=e.filter(e=>e.entityType===Nl.I.Task&&(e.updateType===Ml.U.Insert||e.updateType===Ml.U.Update));if(zl()(n,e=>{const n=e.getCreateDiffData().assignments;return n&&-1!==Object.keys(n).indexOf(t)})>-1){(await this.actionCreatorProviders.recommendedPlansActionCreator()).calculateRecommendedPlansForUser(t)}}async retrieveTaskEntitySet(e){(await this.actionCreatorProviders.taskActionCreator()).fetchTaskEntityGroup(e,!0)}retrieveTaskDetails(e){this.retrieveTaskEntitySet(e)}retrieveTaskFormats(e,t){const n=this.taskStore.getTask(e);n?this.retrieveTaskFormatsForTask(n,e,t):this.retrieveTaskEntitySet(e)}async retrieveTaskFormatsForTask(e,t,n){const r=this.taskStore.getTaskboardTaskFormattingForPlan(e.planId,n),s=await this.actionCreatorProviders.taskActionCreator();r?s.fetchTaskEntityGroup(t,!0):s.fetchTasksForPlan(e.planId,!0,!1)}async retrieveBucket(e){(await this.actionCreatorProviders.bucketActionCreator()).fetchBucket(e,!0)}async retrievePlanEntitySet(e){(await this.actionCreatorProviders.planActionCreator()).fetchPlan(e,!0)}async retrieveTasksForPlan(e){(await this.actionCreatorProviders.taskActionCreator()).fetchTasksForPlan(e,!0,!1)}async retrieveBucketsForPlan(e){(await this.actionCreatorProviders.bucketActionCreator()).fetchBucketsForPlan(e,!0)}loadTaskMissingData(e){let t=!1;const n=null!=e.planId?this.planStore.getPlan(e.planId):null;if(n||(this.retrievePlanEntitySet(e.planId),t=!0),null!=e.bucketId){if(!this.bucketStore.getBucket(e.bucketId)){const n=null!=e.planId?this.bucketStore.getBucketsForPlan(e.planId):[];null==e.planId||n&&0!==n.length?this.retrieveBucket(e.bucketId):this.retrieveBucketsForPlan(e.planId),t=!0}}const r=[];Lt()(e.getAssigneeIds(),e=>{this.userStore.getUserById(e)||r.push(e)}),r.length>0&&this.actionCreatorProviders.userActionCreator().then(e=>{n&&e.fetchUsersForContainer(n.container,void 0,!0),e.fetchUsers(r,!0)});const s=null!=e.planId?this.taskStore.getTasksForPlan(e.planId):null;return null==e.planId||s&&0!==s.length||(this.retrieveTasksForPlan(e.planId),t=!0),t&&s&&s.length>0&&this.retrieveTaskEntitySet(e.id),t}loadBucketMissingData(e){if(!this.planStore.getPlan(e.planId))return this.retrievePlanEntitySet(e.planId),this.retrieveBucketsForPlan(e.planId),!0;const t=this.bucketStore.getBucketsForPlan(e.planId);return(!t||0===t.length)&&(this.retrieveBucketsForPlan(e.planId),!0)}compareItemVersions(e,t){if(null==e&&null==t)return 0;if(null==e)return-1;if(null==t)return 1;if(e===t)return 0;const n=Number(t),r=Number(e);return isNaN(n)||isNaN(r)?e<t?-1:1:r===n?0:r<n?-1:1}async updateUserDetailsWithPlan(e,t){(await this.actionCreatorProviders.planActionCreator()).updateUserDetailsWithPlan(ri.T.builder.withPlan(e).withDetails(t).build())}constructor(e,t,n,r,s,i,a,o,l){this.loggers=o,this.actionCreatorProviders=e,this.appContextStore=t,this.bucketStore=n,this.diffSyncStore=r,this.planStore=s,this.taskStore=i,this.userStore=a,this.shouldRecalculateRecommendedPlans=l??!1,this.diffSyncStore.subscribeToStore(this.onDiffSyncStoreUpdate.bind(this))}}class Kl{async initializeDiffSyncLoop(){if(null==this.diffSyncStore.getDiffSyncToken()){(await this.diffSyncActionCreatorProvider()).fetchDiffSyncToken()}else this.onDiffSyncStoreUpdate()}async restartDiffSyncLoop(){if(this.backoffUtility.resetThresholdCounter(),this.tokenRetries=0,null==this.setTimeoutRef)return;this.async.clearTimeout(this.setTimeoutRef);const e=this.diffSyncStore.getDiffSyncToken(),t=await this.diffSyncActionCreatorProvider();null==e?t.fetchDiffSyncToken():(this.setTimeoutRef=this.async.setTimeout(()=>{this.setTimeoutRef=null,t.fetchDiffSyncFeed(e)},0),t.scheduleDiffSyncFetch())}getDelayInterval(){return this.diffSyncStore.isInErrorState()?this.postFailureRetryInterval:this.backoffUtility.getCurrentDelayInterval()}updateState(e){0===e?this.backoffUtility.incrementThresholdCounter():this.backoffUtility.resetThresholdCounter()}async scheduleDiffSyncFeedFetch(e){const t=this.diffSyncStore.getDiffSyncToken();if(null==t)return;const n=this.activityStore.getLastUserActivityTimestamp(),r=Bt()();if(n&&r.diff(n,"days")>y.c9.MaxDiffSyncInactiveDays){return void(await this.diffSyncStateActionCreatorProvider()).disableDiffSync(B.E$.Info)}if(!this.diffSyncStore.isDiffSyncRequestScheduled()&&!this.diffSyncStore.isDiffSyncDisabled()&&null==this.setTimeoutRef){const n=await this.diffSyncActionCreatorProvider();this.setTimeoutRef=this.async.setTimeout(()=>{this.setTimeoutRef=null,n.fetchDiffSyncFeed(t)},e),n.scheduleDiffSyncFetch()}}constructor(e,t,n,r,s,i,a,o,l){this.setTimeoutRef=null,this.maxTokenRetries=3,this.onDiffSyncStoreUpdate=async()=>{const e=this.diffSyncStore.getDiffSyncToken();if(this.updateState(this.diffSyncStore.getNumDiffsInLastFetch()),null!=e){this.tokenRetries=0;let e=this.diffSyncStore.getLastDiffSyncTimestamp();null==e&&(e=Bt()());const t=Bt().duration(Bt()().diff(e)).asSeconds();this.appContextStore.getFlights().EnableEnhancedPalauTelemetry&&this.loggers.traceLogger.logTrace(507838985,Mt.k.Info,`Time elapsed since last diff sync: [timeElapsed=${t}]`);const n=this.getDelayInterval(),r=t>n?0:1e3*n;!this.pageVisibilityStatusProvider.isPageHidden()||Bt().duration(Bt()().diff(e)).asHours()>Kl.INACTIVE_DIFFSYNC_FETCH_INTERVAL_IN_HOURS?this.scheduleDiffSyncFeedFetch(r):null==this.setTimeoutRef&&(this.setTimeoutRef=this.async.setTimeout(()=>{this.setTimeoutRef=null,this.onDiffSyncStoreUpdate()},1e3*n))}else if(this.tokenRetries++,this.tokenRetries<this.maxTokenRetries){(await this.diffSyncActionCreatorProvider()).fetchDiffSyncToken()}else{(await this.diffSyncStateActionCreatorProvider()).disableDiffSync(B.E$.Error)}},this.loggers=l,this.async=Ho.v.create(),this.diffSyncActionCreatorProvider=e,this.diffSyncStateActionCreatorProvider=t,this.diffSyncStore=n,this.appContextStore=r,this.backoffUtility=s,this.activityStore=i,this.tokenRetries=0,this.pageVisibilityStatusProvider=a;const{baseInterval:c,cutoff:d,backoffThreshold:u,retryInterval:h}=o,p=Math.random()*h*.1;this.postFailureRetryInterval=Math.ceil(h+p),this.diffSyncStore.subscribeToStore(this.onDiffSyncStoreUpdate),this.loggers.traceLogger.logTrace(507838986,Mt.k.Info,`Differential Sync Parameters: [BaseInterval=${c}][Cutoff=${d}][BackOffThreshold=${u}]`)}}Kl.INACTIVE_DIFFSYNC_FETCH_INTERVAL_IN_HOURS=1;class Hl{dispose(){this.planStore.unsubscribeFromStore(this.onStoreUpdateCallback)}async onPlanStoreUpdate(){if(!this.planTitle)return void(this.planTitle=this.planStore.getPlan(this.planId)?.title);const e=this.planStore.getPlan(this.planId);e?.title!==this.planTitle&&(this.planTitle=e?.title,e?.title&&this.planTitleUpdateCallback(e.title))}constructor(e,t,n){this.planId=e,this.planStore=t,this.planTitleUpdateCallback=n,this.onStoreUpdateCallback=()=>this.onPlanStoreUpdate(),this.planStore.subscribeToStore(this.onStoreUpdateCallback)}}class Vl extends P.M{name(){return"LoopSinglePlanApp"}logUsage(e,t,n){this.props.loggers.usageLogger.logData(this.name(),e,t,n)}componentDidMount(){super.componentDidMount(),this.resizeEvent.on(window,"resize",b()(()=>{this.onAppResize()},100)),this.onAppResize(),null!=Z.B.clientSettings.OpenNotificationSettingsEventName&&this.openNotificationsEvent.on(window,Z.B.clientSettings.OpenNotificationSettingsEventName,()=>{this.actionCreatorProviders.dialogActionCreator().then(e=>e.openNotificationSettings())}),this.startUserActivityTracking(),this.diffSyncWorker&&this.diffSyncWorker.initializeDiffSyncLoop()}componentWillUnmount(){super.componentWillUnmount(),this.resizeEvent.off(),this.openNotificationsEvent.off(),this.planTitleRefreshEmitterWorker.dispose()}fetchCriticalData(e,t){}fetchNonCriticalData(e,t){}renderComponent(){const{appContextStore:e,routeStore:t}=this.props,n=this.getPlannerLoopContainerId(),r=this.getPlannerMainContentId();if(e.getAppErrorCode()===E.Hg.DynamicImportError)return this.renderErrorPage();const s=t.getCurrentPage(),i=this.getAppClassName(),a=this.getPageToRender(),o=this.getDialogJsx(n);yl.d.applyTheme(document.body,e.getCurrentTheme());const l=this.renderNotificationBar(),c=this.renderToastContainer();return p.createElement("div",{id:n},p.createElement(x.N,{className:`${i} ${s}`},p.createElement(Ol.T,{value:this.props.loggers},p.createElement(Y.P,{value:{appRootElementId:r}},l,p.createElement("div",{className:"appContent",ref:this.appElementRef},p.createElement("div",{className:"content",id:r},a),o,c)))))}getPageToRender(){const{appContextStore:e,routeStore:t,loggers:n}=this.props,r=t.getCurrentPage();return(0,vl.F_)(r,n.logHandler),p.createElement(p.Suspense,{fallback:this.renderLoadingSpinner()},p.createElement(q.Pj,{value:this.state.attachmentBehaviorContext},p.createElement(O,{loggers:n,dispatcherEventManagement:this.props.dispatcherEventManagement,actionCreatorProviders:this.actionCreatorProviders,perfActionCreator:this.perfActionCreator,viewActionCreatorProvider:this.actionCreatorProviders.tasksByPlanViewActionCreator,appContextStore:e,aggregatesStore:this.aggregatesStore,bucketStore:this.bucketStore,containerMembershipStore:this.containerMembershipStore,permissionsStore:this.permissionsStore,planStore:this.planStore,taskStore:this.taskStore,containerStore:this.containerStore,userStore:this.props.userStore,viewStore:this.viewStore,walkthroughStore:this.walkthroughStore,groupDocumentsStore:this.groupDocumentsStore,wywaStore:this.wywaStore,tenantStore:this.tenantStore,assigneeSuggestionStore:this.assigneeSuggestionStore,viewPartitionKey:this.props.planId,showHeader:!0,showCopyLinkToTask:!0,isSlimView:this.isMobileView(),experimentAssignments:e.getExperiments(),flights:e.getFlights(),experiments:e.getExperiments(),onPageInteractive:this.props.onPageInteractive,isSessionFromTaskLink:e.isSessionFromTaskLink(),isFirstRunExperience:e.isFirstRunExperience(),onPlanLoaded:this.onPlanLoaded,showPlanViewNavLinks:!0,getSharepointDomainUrl:this.suiteNavStore.getSharepointDomainUrl.bind(this.suiteNavStore)})))}getAppClassName(){return(0,al.x)(this.props.appContextStore.getCurrentTheme())}initialize(){const{loggers:e,dispatcher:t,serviceProviders:n,userStore:r,planId:s,appContextStore:i,activityStore:a,logicModuleFactory:o,actionCreatorFactory:l,planTitleUpdateCallback:c}=this.props,d=()=>Z.B.clientSettings,u=new bl(window.localStorage,e.traceLogger);this.activityNotificationStore=new So,this.aggregatesStore=new ln,this.bucketStore=new ns,this.containerMembershipStore=new gs,this.containerStore=new Rs(e),this.diffSyncStore=new je(Z.B.diffSyncToken,e),this.groupDocumentsStore=new fo,this.intelligenceStore=new Zt,this.notificationStore=new Lo(e),this.permissionsStore=new Rt(r.getCurrentUserDetails().userPolicies,e),this.planStore=new ai,this.suiteNavStore=new Mo,this.taskStore=new Ea,this.tenantStore=new Ra(e),this.transactionStore=new Fe(I.Jj),this.viewStore=new Di(u,e),this.walkthroughStore=new eo(e);const h=r.getUserDetailsById(Z.B.currentUserId),p=null!=h?h.recentPlans.references:{},g=s;this.wywaStore=new Vo(p,D.TaskAnimationDelay,g,e),this.assigneeSuggestionStore=new $o(i.getCurrentUserId()),this.performanceCollectionStore=new il(e.logHandler);const m={appContextStore:i,bucketStore:this.bucketStore,containerMembershipStore:this.containerMembershipStore,groupDocumentsStore:this.groupDocumentsStore,planStore:this.planStore,taskStore:this.taskStore,tenantStore:this.tenantStore,containerStore:this.containerStore,userStore:r,walkthroughStore:this.walkthroughStore,activityNotificationStore:this.activityNotificationStore,activityStore:a,notificationStore:this.notificationStore,permissionsStore:this.permissionsStore,suiteNavStore:this.suiteNavStore,viewStore:this.viewStore,wywaStore:this.wywaStore};this.activityFeedProvider=new Ll(r.getUserById.bind(r),r.getCurrentUser.bind(r),e.traceLogger),this.logicModuleProviders={bucketModule:o.getBucketModuleProvider(t,n,m,d),configurationModule:o.getConfigurationModuleProvider(t,n,m,d),containerModule:o.getContainerModuleProvider(t,n,m,d),diffSyncModule:o.getDiffSyncModuleProvider(t,n,m,d),driveItemModule:o.getDriveItemModuleProvider(t,n,m,d),experimentationModule:o.getExperimentationModuleProvider(t,n),exportToExcelModule:()=>{throw e.traceLogger.logTrace(508077446,Mt.k.Warning,"exportToExcelModule not available in LoopsinglePlanApp"),new Error("exportToExcelModule not available in LoopSinglePlanApp")},intelligenceModule:o.getIntelligenceModuleProvider(t,n),linksModule:o.getLinksModuleProvider(t,n,m,d),permissionsModule:o.getPermissionModuleProvider(t,n,m,d),notificationModule:o.getNotificationModuleProvider(t,n,m,d),operationTrackingModule:o.getOperationTrackingModuleProvider(t,n,m,d),planModule:o.getPlanModuleProvider(t,n,m,d),projectModule:o.getProjectModuleProvider(t,n,m,d),taskModule:o.getTaskModuleProvider(t,n,m,d),telemetryModule:o.getTelemetryModuleProvider(t,n,m,d),templateModule:o.getTemplateModuleProvider(t,n,m,d),tenantModule:o.getTenantModuleProvider(t,n,m,d),unifiedGroupModule:o.getUnifiedGroupModuleProvider(t,n,m,d),userModule:o.getUserModuleProvider(t,n,m,d),teamsTasksModule:()=>{throw e.traceLogger.logTrace(508077445,Mt.k.Warning,"TeamsTasksModule not available in Loop Planner"),new Error("TeamsTasksModule not available in Loop Planner")},campaignModule:o.getCampaignModuleProvider(t,n)},this.actionCreatorProviders={bucketActionCreator:l.getBucketActionCreator(t,this.logicModuleProviders,m),experimentationActionCreator:l.getExperimentationActionCreator(t,this.logicModuleProviders.experimentationModule),notificationActionCreator:l.getNotificationActionCreator(t,m.appContextStore),planActionCreator:l.getPlanActionCreator(t,this.logicModuleProviders,m),taskActionCreator:l.getTaskActionCreator(t,m,this.logicModuleProviders,this.activityFeedProvider,this.getShareDeepLinkCallback()),tasksByAssigneeViewActionCreator:()=>{throw e.traceLogger.logTrace(508077444,Mt.k.Warning,"tasksByAssigneeViewActionCreator is not available in Loop Planner."),new Error("tasksByAssigneeViewActionCreator not available in LoopSinglePlanApp")},tasksByPlanViewActionCreator:l.getTasksByPlanViewActionCreator(t,m,this.logicModuleProviders),tasksByWorkspaceViewActionCreator:()=>{throw e.traceLogger.logTrace(508077443,Mt.k.Warning,"tasksByWorkspaceViewActionCreator is not available in Loop Planner."),new Error("tasksByWorkspaceViewActionCreator not available in LoopSinglePlanApp")},viewTransformsActionCreator:l.getViewTransformsActionCreator(t,m,this.logicModuleProviders),unifiedGroupActionCreator:l.getUnifiedGroupActionCreator(t,this.logicModuleProviders,m),userActionCreator:l.getUserActionCreator(t,this.logicModuleProviders,m),userPlansRetrievalActionCreator:l.getUserPlansRetrievalActionCreator(t,this.logicModuleProviders,m),walkthroughActionCreator:l.getWalkthroughActionCreator(t,m,this.logicModuleProviders),wywaActionCreator:l.getWywaActionCreator(t,m,this.logicModuleProviders),dialogActionCreator:l.getDialogActionCreator(t,this.logicModuleProviders,m),diffSyncActionCreator:l.getDiffSyncActionCreator(t,this.logicModuleProviders,m),diffSyncStateActionCreator:l.getDiffSyncStateActionCreator(t),tenantActionCreator:()=>{throw e.traceLogger.logTrace(508077442,Mt.k.Warning,"TenantActionCreator is not supported in Loop Planner."),new Error("TenantActionCreator is not supported in Loop Planner.")},navigationActionCreator:this.props.navigationActionCreatorProvider,containerActionCreator:l.getContainerActionCreator(t,this.logicModuleProviders,m),uiLayoutActionCreator:l.getUILayoutActionCreator(t),linksActionCreator:l.getLinksActionCreator(t,this.logicModuleProviders),exportActionCreator:l.getExportActionCreator(t,this.logicModuleProviders,m),intelligenceActionCreator:l.getIntelligenceActionCreator(t,this.logicModuleProviders,m),groupDocumentsActionCreator:l.getGroupDocumentsActionCreator(t,this.logicModuleProviders,m,new _l),activityActionCreator:l.getActivityActionCreator(t),operationsActionCreator:l.getOperationsActionCreator(t,this.logicModuleProviders,m),buildsActionCreator:l.getBuildsActionCreator(t,this.logicModuleProviders,m),settingsActionCreator:l.getSettingsActionCreator(t),prefetchActionCreator:l.getPrefetchActionCreator(t),templateActionCreator:l.getTemplateActionCreator(t,this.logicModuleProviders,m),teamsTasksActionCreator:()=>{throw e.traceLogger.logTrace(508077441,Mt.k.Warning,"TeamsTasksActionCreator not available in Loop Planner"),new Error("TeamsTasksActionCreator not available in Loop Planner")},suiteNavActionCreator:()=>{throw e.traceLogger.logTrace(508073246,Mt.k.Warning,"SuiteNavActionCreator not available in Loop Planner"),new Error("SuiteNavActionCreator not available in Loop Planner")},recommendedPlansActionCreator:()=>{throw e.traceLogger.logTrace(508070102,Mt.k.Warning,"RecommendedPlansActionCreator not available in Loop Planner"),new Error("RecommendedPlansActionCreator not available in Loop Planner")},irisActionCreator:()=>{throw e.traceLogger.logTrace(506545303,Mt.k.Warning,"IrisActionCreator not available in Loop Planner"),new Error("IrisActionCreator not available in Loop Planner")}},this.perfActionCreator=new ne(t),t.registerStore(this.aggregatesStore),t.registerStore(this.bucketStore),t.registerStore(this.containerMembershipStore),t.registerStore(this.groupDocumentsStore),t.registerStore(this.intelligenceStore),t.registerStore(this.notificationStore),t.registerStore(this.activityNotificationStore),t.registerStore(this.permissionsStore),t.registerStore(this.planStore),t.registerStore(this.suiteNavStore),t.registerStore(this.taskStore),t.registerStore(this.tenantStore),t.registerStore(this.transactionStore),t.registerStore(this.containerStore),t.registerStore(this.viewStore),t.registerStore(this.walkthroughStore),t.registerStore(this.diffSyncStore),t.registerStore(this.performanceCollectionStore);const f=Z.B.diffSyncParameters,y=new ml(f.baseInterval,f.cutoff,f.backoffThreshold);this.diffSyncWorker=new Kl(this.actionCreatorProviders.diffSyncActionCreator,this.actionCreatorProviders.diffSyncStateActionCreator,this.diffSyncStore,this.props.appContextStore,y,a,new fl,f,e),new jl(this.actionCreatorProviders,i,this.bucketStore,this.diffSyncStore,this.planStore,this.taskStore,r,e),this.planTitleRefreshEmitterWorker=new Hl(g,this.planStore,c)}checkForCriticalDataReady(){return!0}onOpenLink(e){ll.b.safelyOpenExternalUrl(e.url,"_blank")}renderNotificationBar(){return p.createElement(W,{dispatcherEventManagement:this.props.dispatcherEventManagement,notificationActionCreatorProvider:this.actionCreatorProviders.notificationActionCreator,bucketStore:this.bucketStore,notificationStore:this.notificationStore,planStore:this.planStore,taskStore:this.taskStore,userStore:this.props.userStore,appContextStore:this.props.appContextStore})}renderToastContainer(){return p.createElement(w.N,{dispatcherEventManagement:this.props.dispatcherEventManagement,toastStore:this.notificationStore,toastActionCreatorProvider:this.actionCreatorProviders.notificationActionCreator,toastLocation:w.t.BottomLeft,disableAutoDismiss:this.props.appContextStore.getCurrentDialogData().dialogType===pe.h.ToastManager,renderToastContent:(e,t,n,r)=>p.createElement(V.f,{toastType:t,onDismiss:n,data:r,theme:this.props.appContextStore.getCurrentTheme(),toastTypeWhitelist:this.toastTypeWhitelist}),layerProps:{className:"toast-layer",hostId:this.getPlannerMainContentId()}})}renderLoadingSpinner(){return p.createElement("div",{className:"page-spinner"},p.createElement(F.y,{size:A.H.large,className:"spinner",label:Tl.p.Strings.SharedComponents_StandBySpinner,styles:(0,ol.Zz)(this.props.appContextStore.getCurrentTheme())}))}isMobileView(){return this.props.appContextStore.getCurrentPageFormFactorState()===C.qk.Mobile}getShareDeepLinkCallback(){}startUserActivityTracking(){const e=b()(async()=>{const e=Bt()();(await this.actionCreatorProviders.activityActionCreator()).updateUserActivityTimestamp(e)},y.c9.UserActivitySamplingResolution),t=["click","dblclick","mousemove","mouseup","mousedown","mouseenter","keyup","keydown","keypress","submit","change","scroll","resize"];for(const n of t)document.addEventListener(n,e,{capture:!0})}getDialogJsx(e){const{appContextStore:t}=this.props,n=t.getCurrentDialogData()||{dialogType:pe.h.None},r=n.dialogType&&n.dialogType!==pe.h.None,s=rl.isAuthenticationFailureNotification(this.notificationStore);return r||s?p.createElement(p.Suspense,{fallback:p.createElement(p.Fragment,null)},p.createElement(H,{theme:t.getCurrentTheme(),dispatcherEventManagement:this.props.dispatcherEventManagement,experimentAssignments:this.props.appContextStore.getExperiments(),actionCreatorProviders:this.actionCreatorProviders,aggregatesStore:this.aggregatesStore,appContextStore:this.props.appContextStore,bucketStore:this.bucketStore,containerMembershipStore:this.containerMembershipStore,groupDocumentsStore:this.groupDocumentsStore,intelligenceStore:this.intelligenceStore,notificationStore:this.notificationStore,permissionsStore:this.permissionsStore,planStore:this.planStore,routeStore:this.props.routeStore,suiteNavStore:this.suiteNavStore,taskStore:this.taskStore,tenantStore:this.tenantStore,transactionStore:this.transactionStore,containerStore:this.containerStore,userStore:this.props.userStore,targetContainerElementId:e,activityFeedProvider:this.activityFeedProvider,toastTypeWhitelist:this.toastTypeWhitelist,openAppPoweredLinkCallBack:()=>{}})):null}renderErrorPage(){const e=this.props.appContextStore.getCurrentTheme(),t=this.props.reloadCallback||(()=>window.location.reload());return p.createElement(x.N,{className:(0,ol.Tk)(e)},p.createElement(p.Suspense,{fallback:this.renderLoadingSpinner()},p.createElement(j,{theme:e,ref:this.appElementRef,reloadCallback:t,errorMessageTitle:Tl.p.Strings.Errors_SomethingWentWrongErrorTitle,errorMessageBody:Tl.p.Strings.Errors_SomethingWentWrongErrorBody,reloadButtonText:Tl.p.Strings.Errors_ReloadButtonText,isReloadButtonDisplayed:!0})))}getPlannerMainContentId(){return(0,Ul.cL)(this.props.appContextStore.getAppInstanceId())}getPlannerLoopContainerId(){return(0,Ul.xZ)(this.props.appContextStore.getAppInstanceId())}constructor(e,t){super(e,t),this.toastTypeWhitelist=[re.N.type,se.g.type,ie.N.type,ae.W.type,le.z.type,oe.e.type,ce.Q.type,de.c.type,he.R.type,ue.f.type],this.appElementRef=p.createRef(),this.onAppResize=async()=>{const e=this.appElementRef.current;if(e){(await this.actionCreatorProviders.uiLayoutActionCreator()).windowResize(e.offsetHeight,e.offsetWidth)}},this.onPlanLoaded=e=>{this.actionCreatorProviders.planActionCreator().then(t=>{t.setPlanLastAccess(e,new Date)}).catch(()=>{})},gl(),this.initialize(),this.perfActionCreator.appStart(this.props.routeStore.getCurrentPage(),this.props.appStartTime),this.openNotificationsEvent=new L.g(this),this.resizeEvent=new L.g(this),this.state={attachmentBehaviorContext:{openLinkCallback:this.onOpenLink,openLinkInNewWindow:!1}}}}const Zl=(0,kl.y)(Vl);var ql=n(89608),Yl=n(75559);const $l=e=>{const{loopAppProps:t,viewRef:n,theme:r,getAppErrorCode:s,initializeComponent:i,onKeyDownHandler:a}=e,[o,l]=p.useState(s()),c=async()=>{await i();const e=s();l(e)};let d;if(o){const e=(0,ql.oK)(o,r,c);d=(0,h.jsx)(Yl.ComponentErrorPage,{...e})}else d=(0,h.jsx)(Zl,{...t});return(0,h.jsx)("div",{style:{position:"relative",height:o?"150px":"700px"},onKeyDown:a,role:"presentation",tabIndex:0,ref:n,children:d})};var Jl=n(27284),Xl=n(95996),Ql=n(59190);class ec extends Jl.EventEmitter{constructor(e,t,n,r,s,i){super(),this.loopAppProps=e,this.stylingProvider=t,this.onPlannerRendered=n,this.getAppErrorCode=r,this.initializeComponent=s,this.logger=i,this.viewRef=p.createRef(),this.keydownShortcuts=[],this.isFocused=!1,this.userActivityEventHandler=e=>{this.emit("userActivity"),this.removeHostingElementEventListeners()},this.removeHostingElementEventListeners=()=>{this.element?.removeEventListener("focus",this.userActivityEventHandler,{capture:!0}),this.element?.removeEventListener("scroll",this.userActivityEventHandler,{capture:!0}),this.element?.removeEventListener("click",this.userActivityEventHandler,{capture:!0})},this.moveFocusToHostingCanvas=()=>{this.hostComponent?.ComponentFocusable?.giveFocus(),this.isFocused=!1},this.setFocus=()=>!!this.viewRef.current&&(this.isFocused=!0,this.viewRef.current.focus(),!0),this.moveSelectionToHost=e=>{let t;t=this.previousLocation&&void 0!==this.previousLocation.x?{mode:m.Q.ip,direction:e,currentCoordinates:{x:this.previousLocation.x,y:void 0},currentSelection:this}:{mode:m.Q.ip,direction:e,currentSelection:this},this.hostComponent?.ComponentSelection?.setSelection(t),delete this.previousLocation,this.isFocused=!1},this.onKeyDownHandler=e=>{!function(e,t){const n=e.find(e=>function(e,t){const n=t.keyboardShortcutDescription;return n.type===e.type&&n.key===e.key&&!!n.altKey===e.altKey&&!!n.ctrlKey===e.ctrlKey&&!!n.metaKey===e.metaKey&&!!n.shiftKey===e.shiftKey}(t,e));if(void 0!==n)n.handler(t),t.stopPropagation(),t.preventDefault()}(this.keydownShortcuts,e)},this.onThemeChanged=()=>{const e=this.getPlannerTheme();this.loopAppProps.dispatcher.dispatchAction(new f.k(e))},this.getPlannerTheme=()=>{const e=this.stylingProvider?.themeProperties?.get(T.e);return e===T.L?y.Sx.LoopDark:y.Sx.LoopLight},this.stylingProvider&&(this.stylingProvider.on("themePropertiesChanged",this.onThemeChanged),this.onThemeChanged())}get UserActivityProvider(){return this}addUserActivityListener(){this.element?.addEventListener("focus",this.userActivityEventHandler,{capture:!0,once:!0}),this.element?.addEventListener("scroll",this.userActivityEventHandler,{capture:!0,once:!0}),this.element?.addEventListener("click",this.userActivityEventHandler,{capture:!0,once:!0})}get HTMLView(){return this}async dispose(){this.element&&(this.stylingProvider?.off("themePropertiesChanged",this.onThemeChanged),g.unmountComponentAtNode(this.element),delete this.element)}render(e){const t=a.m.start(Ql.yz.ViewRenderReady,this.logger);if(this.element=e,this.logger){const e=this.logger;this.UserActivityProvider.once("userActivity",()=>{(0,Xl.o4)(e,{eventName:"UserActiveInComponent"})}),this.addUserActivityListener()}const n={...this.loopAppProps,onPageInteractive:e=>{this.loopAppProps.onPageInteractive?.(e),t.setResult(!e)}},r=(0,h.jsx)($l,{loopAppProps:n,getAppErrorCode:this.getAppErrorCode,initializeComponent:this.initializeComponent,onKeyDownHandler:this.onKeyDownHandler,viewRef:this.viewRef,theme:this.getPlannerTheme()});return new Promise(n=>{g.render(r,e,()=>{this.onPlannerRendered();const e=this.getAppErrorCode();e&&t.setResult(!0,{appErrorCode:e}),n()})})}get ComponentFocusable(){return this}giveFocus(){return this.setFocus()}isComponentFocused(){return this.isFocused}setHostComponentFocusable(e){this.hostComponent={...this.hostComponent,ComponentFocusable:e}}get ComponentSelection(){return this}clearSelection(){delete this.previousLocation}setSelection(e){return this.previousLocation=e.currentCoordinates,this.setFocus()}setHostComponentSelection(e){this.hostComponent={...this.hostComponent,ComponentSelection:e}}get KeyboardShortcutEmitter(){return this}setShortcuts(e){const t=(n=this.moveSelectionToHost,r=this.moveFocusToHostingCanvas,[{handler:()=>{n(m.S.left)},keyboardShortcutDescription:{key:"ArrowLeft",isOverride:!0,type:"keydown"}},{handler:()=>{n(m.S.up)},keyboardShortcutDescription:{key:"ArrowUp",isOverride:!0,type:"keydown"}},{handler:()=>{n(m.S.right)},keyboardShortcutDescription:{key:"ArrowRight",isOverride:!0,type:"keydown"}},{handler:()=>{n(m.S.down)},keyboardShortcutDescription:{key:"ArrowDown",isOverride:!0,type:"keydown"}},{keyboardShortcutDescription:{key:"Home",type:"keydown"},handler:()=>n(m.S.lineBegin)},{keyboardShortcutDescription:{key:"End",type:"keydown"},handler:()=>n(m.S.lineEnd)},{keyboardShortcutDescription:{key:"PageUp",type:"keydown"},handler:()=>n(m.S.pageUp)},{keyboardShortcutDescription:{key:"PageDown",type:"keydown"},handler:()=>n(m.S.pageDown)},{keyboardShortcutDescription:{key:"Escape",type:"keydown"},handler:()=>r()}]);var n,r;this.keydownShortcuts=function(e,t,n){const r={componentCriticalShortcuts:[],hostOverrideShortcuts:(0,v.D)(t,!0),componentNormalShortcuts:[...e],hostNormalShortcuts:(0,v.D)(t,!1),componentLowShortcuts:[]};return(0,k.V)(r,n)}(t,e,"keydown")}}const tc=n.p+"static/media/planner.513ec4dc85112d1c0cbc2ac68c7d01fe.svg";var nc=n(52956);var rc=n(28184),sc=n(68639);class ic extends Jl.EventEmitter{constructor(e,t){super(),this.initialConfig=e,this.providers=t,this.entityName=Ql.AB,this.name=c.ZV,this.iconUrl=(0,nc.i)(tc).source,this.experienceType="Collaborative",this.planTitleUpdateCallback=e=>{this._title=e,this.emit("titleChanged",e)}}get ComponentInitializer(){return this}async initialize(){const e=a.m.start(Ql.yz.LoadPlannerComponent,void 0,{isAPerformanceMetric:!0});try{this._plannerDependency=await this.getDependencyPromise(),this._componentInfo=await this.getInfoPromise(),this._title=this._componentInfo.planTitle,this.title&&this.appErrorCode&&(this.appErrorCode=void 0),e.setResult(!0)}catch(t){throw(0,Ql.om)("LoopPlanner_initialize_error","Failed to initialize the component",Mt.k.Error,t),t}}get HTMLViewable(){return this}async getView(){const e=a.m.start(Ql.yz.RenderPlannerView,this.plannerDependency.logger,{isAPerformanceMetric:!0}),t=a.m.start(Ql.yz.GetPlannerView,this.plannerDependency.logger),n=t=>{e.setResult(!t)},r=()=>{(0,Ql.om)("LoopPlanner_render_success","Render component successfully",Mt.k.Info)},s=(new Date).getTime();try{const e=await(0,u.rQ)((0,u.Vf)(this.plannerDependency.tokenProvider,this.plannerDependency.userContext)),i=function(e){const t={hostname:"config.edge.skype.com",cloud:"Public",environment:"Prod"};switch(e){case"GCC-High":return{hostname:"config.ecs.gov.teams.microsoft.us",cloud:"GCCHigh",environment:"GCCH"};case"DoD":return{hostname:"config.ecs.dod.teams.microsoft.us",cloud:"DoD",environment:"DoD"};default:return t}}(this.plannerDependency.settingsProvider?.audience),a=await async function(e){let t=`https://${e.hostname||"config.edge.skype.com"}/config/v1/Planner/1.0.0.0?agents=PlannerWeb&Cloud=${e.cloud||"Public"}&Environment=${e.environment||"Prod"}&Platform=Web`;e.tenantId&&(t+=`&tenantId=${e.tenantId}`),e.userId&&(t+=`&userId=${e.userId}`);try{const e=await fetch(t);if(!e.ok)throw new Error(`Failed to fetch ECS settings: [Status: ${e.status}, StatusText: ${e.statusText}`);return(await e.clone().json()).PlannerWeb}catch(n){return(0,Ql.om)("fetchPlannerECSSettings","Failed to fetch PlannerECSSettings",Mt.k.Warning,n),{}}}({...i,tenantId:this.plannerDependency.userContext.tenantId,userId:e.id});await(0,d.bg)(e,a,this.plannerDependency);const o=(0,d.nH)(s,e,this.componentInfo.planId,this.plannerDependency,this.planTitleUpdateCallback),l=()=>this.appErrorCode,c=async()=>{await this.initialize()},h=new ec({...o,onPageInteractive:n},this.plannerDependency.stylingProvider,r,l,c,this.plannerDependency.logger);return t.setResult(!0),h}catch(i){throw(0,Ql.om)("LoopPlanner_getView_error","Failed to get view",Mt.k.Error,i),t.setResult(!1,void 0,i),i}}get ContentURL(){return this}async getContentURL(){return this.componentInfo.url}get LoopComponentUrl(){return this}async getLoopComponentUrl(){return this.componentInfo.url}get ComponentTelemetryMetadata(){return this}get ComponentProperties(){return this}get ComponentSerializable(){return this}async serialize(){throw Error("serialize is not implemented")}async rehydrate(e){throw Error("rehydrate is not implemented")}async getHtmlAsync(){const e=document.createElement("a");return e.href=this.componentInfo.url.href,e.textContent=this.componentInfo.planTitle??this.componentInfo.url.href,e.rel="noreferrer noopener",e.outerHTML}async getTextAsync(){return this.componentInfo.url.href}get ComponentTitle(){return this}get title(){return this._title}get LoopState(){return this}async isLoop(){return!0}async getDependencyPromise(){const e=this.providers;try{if(!e)throw Error("Missing Providers");const[t,n,r,s,i,a,d,u]=await Promise.all([e.TokenProvider,e.SettingsProvider,e.StylingProvider,e.UserContext,e.InternationalizationContext,e.LoopTelemetrySink,e.TelemetryConfig,e.NamespaceLogger]),h=u?new o.p(Ql.AB,u):void 0;if(!t)throw Error("Missing Token Providers");const p=n?.audience??c.CS,g={tenantId:await(0,sc.E)(t,s,p)};a&&!(0,Ql.pk)(n?.audience)&&(0,Ql.$N)(a,(0,Ql.eO)({userContext:g,settingsProvider:n,internationalizationContext:i,telemetryConfig:d})),Nt.f.setRedactionFunction(l.ku),Sl.f.setRedactionFunction(l.ku);return{tokenProvider:t,settingsProvider:n,stylingProvider:r,userContext:g,internationalizationContext:i,loopTelemetrySink:a,telemetryConfig:d,logger:h}}catch(t){throw(0,Ql.om)("getDependencyPromise","Failed to get Loop providers",Mt.k.Error,t),t}}get plannerDependency(){if(!this._plannerDependency)throw Error("Missing Planner Dependency");return this._plannerDependency}async getInfoPromise(){let e;const t=(0,u.Vf)(this.plannerDependency.tokenProvider,this.plannerDependency.userContext,this.plannerDependency.settingsProvider?.audience);if((0,r.I)(this.initialConfig,s.kW)){const r=this.initialConfig.creationData.data.url,s=(0,d.uD)(r);try{e={url:r,planId:s,planTitle:await(0,u.EW)(s,t)}}catch(n){this.appErrorCode=n.name,e={url:r,planId:s,planTitle:void 0}}}else e=await(0,rc.pL)(t,this.plannerDependency.internationalizationContext?.uiLocale);return e}get componentInfo(){if(!this._componentInfo)throw Error("Missing Component Info");return this._componentInfo}}const ac=new i.p(ic,{SettingsProvider:"SettingsProvider",StylingProvider:"StylingProvider",TokenProvider:"TokenProvider",UserContext:"UserContext",InternationalizationContext:"InternationalizationContext",LoopTelemetrySink:"LoopTelemetrySink",TelemetryConfig:"TelemetryConfig",NamespaceLogger:"NamespaceLogger"})},8122:(e,t,n)=>{"use strict";n.d(t,{P:()=>s,q:()=>r});const r=n(65043).createContext({appRootElementId:null}),s=r.Provider},8149:(e,t,n)=>{"use strict";n.d(t,{C:()=>s});var r=n(75992);class s extends r.r{constructor(e){super(s.actionType),this.entityId=e}}s.actionType="AUGLOOP_FETCH_FILE_SUG"},8253:(e,t,n)=>{"use strict";function r(e){return r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function s(e){var t=e.current;return null==t?null:t.decoratedRef?t.decoratedRef.current:t}function i(e){return(t=e)&&t.prototype&&"function"===typeof t.prototype.render||function(e){var t;return"Symbol(react.forward_ref)"===(null===e||void 0===e||null===(t=e.$$typeof)||void 0===t?void 0:t.toString())}(e);var t}function a(e,t){}function o(e){return"function"===typeof e}function l(){}function c(e){if(!function(e){return"object"===r(e)&&null!==e}(e))return!1;if(null===Object.getPrototypeOf(e))return!0;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function d(e,t){return"string"===typeof e||"symbol"===r(e)||!!t&&Array.isArray(e)&&e.every(function(e){return d(e,!1)})}n.d(t,{NE:()=>d,PQ:()=>s,Qd:()=>c,Tn:()=>o,Yy:()=>i,cl:()=>a,lQ:()=>l})},8820:(e,t,n)=>{var r=n(18902),s=n(75866),i=n(41558),a=n(50149),o=n(47574),l=n(58114),c=Math.min;e.exports=function(e,t,n){for(var d=n?i:s,u=e[0].length,h=e.length,p=h,g=Array(h),m=1/0,f=[];p--;){var y=e[p];p&&t&&(y=a(y,o(t))),m=c(y.length,m),g[p]=!n&&(t||u>=120&&y.length>=120)?new r(p&&y):void 0}y=e[0];var v=-1,k=g[0];e:for(;++v<u&&f.length<m;){var T=y[v],S=t?t(T):T;if(T=n||0!==T?T:0,!(k?l(k,S):d(f,S,n))){for(p=h;--p;){var b=g[p];if(!(b?l(b,S):d(e[p],S,n)))continue e}k&&k.push(S),f.push(T)}}return f}},8842:(e,t,n)=>{"use strict";n.d(t,{f:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{isFallBack:String(this.suiteNavModel.UseFallbackShell)}}constructor(e){super(s.actionType),this.suiteNavModel=e}}s.actionType="GET_SUITENAV_SUCCEEDED"},9614:(e,t,n)=>{"use strict";n.d(t,{H:()=>s});var r=n(75992);class s extends r.r{constructor(e){super(s.actionType),this.unifiedGroupId=e}}s.actionType="PLW_DELETE_UNIFIEDGROUP"},10912:(e,t,n)=>{"use strict";n.d(t,{N:()=>R,t:()=>D});var r,s,i,a=n(65043),o=n(35363),l=n(937),c=n(66783),d=n(52195),u=n(68417),h=(0,u.i)({from:{opacity:0},to:{opacity:1}}),p=(0,u.i)({from:{opacity:1},to:{opacity:0}}),g=(0,u.i)({from:{transform:"scale3d(1.15, 1.15, 1)"},to:{transform:"scale3d(1, 1, 1)"}}),m=(0,u.i)({from:{transform:"scale3d(1, 1, 1)"},to:{transform:"scale3d(0.9, 0.9, 1)"}}),f=(0,u.i)({from:{transform:"translate3d(0, 0, 0)"},to:{transform:"translate3d(-48px, 0, 0)"}}),y=(0,u.i)({from:{transform:"translate3d(0, 0, 0)"},to:{transform:"translate3d(48px, 0, 0)"}}),v=(0,u.i)({from:{transform:"translate3d(48px, 0, 0)"},to:{transform:"translate3d(0, 0, 0)"}}),k=(0,u.i)({from:{transform:"translate3d(-48px, 0, 0)"},to:{transform:"translate3d(0, 0, 0)"}}),T=(0,u.i)({from:{transform:"translate3d(0, 0, 0)"},to:{transform:"translate3d(0, -48px, 0)"}}),S=(0,u.i)({from:{transform:"translate3d(0, 0, 0)"},to:{transform:"translate3d(0, 48px, 0)"}}),b=(0,u.i)({from:{transform:"translate3d(0, 48px, 0)"},to:{transform:"translate3d(0, 0, 0)"}}),I=(0,u.i)({from:{transform:"translate3d(0, -48px, 0)"},to:{transform:"translate3d(0, 0, 0)"}});function C(e,t,n){return"".concat(e," ").concat(t," ").concat(n)}!function(e){e.duration1="100ms",e.duration2="200ms",e.duration3="300ms",e.duration4="400ms"}(r||(r={})),function(e){e.accelerate="cubic-bezier(0.9, 0.1, 1, 0.2)",e.decelerate="cubic-bezier(0.1, 0.9, 0.2, 1)",e.linear="cubic-bezier(0, 0, 1, 1)",e.standard="cubic-bezier(0.8, 0, 0.2, 1)"}(s||(s={})),function(e){e.fadeIn=C(h,r.duration1,s.linear),e.fadeOut=C(p,r.duration1,s.linear),e.scaleDownIn=C(g,r.duration3,s.decelerate),e.scaleDownOut=C(m,r.duration3,s.decelerate),e.slideLeftOut=C(f,r.duration1,s.accelerate),e.slideRightOut=C(y,r.duration1,s.accelerate),e.slideLeftIn=C(v,r.duration1,s.decelerate),e.slideRightIn=C(k,r.duration1,s.decelerate),e.slideUpOut=C(T,r.duration1,s.accelerate),e.slideDownOut=C(S,r.duration1,s.accelerate),e.slideUpIn=C(b,r.duration1,s.decelerate),e.slideDownIn=C(I,r.duration1,s.decelerate)}(i||(i={}));var D,E=n(25420),P="50px",w="20px",x=(0,c.J9)(function(e,t){var n={right:"0px",".base-toast":{marginRight:w}},r={left:"0px",".base-toast":{marginLeft:w}},s={top:P},a={bottom:P,flexDirection:"column-reverse"},o={root:[(0,E.gS)("column"),{position:"absolute",zIndex:"1",maxWidth:"100%"},e===D.BottomLeft&&[a,r],e===D.TopLeft&&[s,r],e===D.BottomRight&&[a,n],e===D.TopRight&&[s,n]],toast:{animation:i.fadeIn}};return(0,d.TW)(o,t)}),F=(0,c.J9)(function(e,t){var n=x(e,t);return{root:(0,d.Zq)("toast-container",n.root),toast:(0,d.Zq)("toast",n.toast)}}),A=n(33411),L=n.n(A),_=n(49874),U=n.n(_),O=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),B=function(){return B=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},B.apply(this,arguments)},M=function(e,t,n,r){return new(n||(n=Promise))(function(s,i){function a(e){try{l(r.next(e))}catch(t){i(t)}}function o(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,o)}l((r=r.apply(e,t||[])).next())})},N=function(e,t){var n,r,s,i,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(i){return function(o){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(s=2&i[0]?r.return:i[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,i[1])).done)return s;switch(r=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(s=(s=a.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){a.label=i[1];break}if(6===i[0]&&a.label<s[1]){a.label=s[1],s=i;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(i);break}s[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(o){i=[6,o],r=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,o])}}};!function(e){e[e.TopLeft=0]="TopLeft",e[e.TopRight=1]="TopRight",e[e.BottomLeft=2]="BottomLeft",e[e.BottomRight=3]="BottomRight"}(D||(D={}));var R=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.state={},r.pendingTimeouts={},r}return O(t,e),t.prototype.name=function(){return"ToastContainer"},t.prototype.renderComponent=function(){var e=this,t=this.props,n=t.layerProps,r=t.toastStore,s=t.maxDisplayableToasts,i=void 0===s?8:s,l=r&&r.getToasts(),c=this.getClassNames();return l&&l.length>0?a.createElement(o.W,B({},n),a.createElement("div",{className:c.root},L()(U()(l,i),function(t){return e.renderToastWithTimeout(t)}))):null},t.prototype.renderToastWithTimeout=function(e){var t,n=this,r=this.props,s=r.timeout,i=void 0===s?1e4:s,o=r.disableAutoDismiss,l=r.renderToastContent,c=null!==(t=e.timeout)&&void 0!==t?t:i;!o&&c>0?this.pendingTimeouts[e.id]||(this.pendingTimeouts[e.id]=this.async.setTimeout(function(){delete n.pendingTimeouts[e.id],n.onToastDismiss(e.id,!1)},c)):this.pendingTimeouts[e.id]&&(this.async.clearTimeout(this.pendingTimeouts[e.id]),delete this.pendingTimeouts[e.id]);var d=this.getClassNames();return a.createElement("div",{className:d.toast,key:e.id},l&&l(e.id,e.type,function(){return n.onToastDismiss(e.id,!0)},e.data))},t.prototype.onToastDismiss=function(e,t){return M(this,void 0,void 0,function(){var n,r,s;return N(this,function(i){switch(i.label){case 0:return n=this.props.toastActionCreatorProvider,this.pendingTimeouts[e]&&(this.async.clearTimeout(this.pendingTimeouts[e]),delete this.pendingTimeouts[e]),t?this.logUsage("userDismissedToast",{errorId:e}):this.logUsage("timeoutDismissedToast",{errorId:e}),(s=n)?[4,n()]:[3,2];case 1:s=i.sent(),i.label=2;case 2:return(r=s)&&r.dismissToast(e),[2]}})})},t.prototype.getClassNames=function(){return F(this.props.toastLocation,this.props.styles)},t}(l.F)},10979:(e,t,n)=>{"use strict";n.d(t,{I:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{sessionId:this.session.id,groupId:this.session.groupId,itemId:String(this.session.itemId),itemSize:String(this.session.itemSize),taskId:this.updatedTaskDetails.id,updateKey:this.updateKey}}constructor(e,t,n){super(s.actionType),this.session=e,this.updatedTaskDetails=t,this.updateKey=n}}s.actionType="PLW_CREATE_UPLOAD_SESSION"},11079:(e,t,n)=>{"use strict";var r;function s(e,t){return 0!==(e&t)}n.d(t,{I:()=>r,L:()=>s}),function(e){e[e.DisableNone=0]="DisableNone",e[e.DisableUpdateAttachments=1]="DisableUpdateAttachments",e[e.DisableEditPublishedAttachments=2]="DisableEditPublishedAttachments",e[e.DisableAddAttachment=4]="DisableAddAttachment",e[e.DisableAll=7]="DisableAll"}(r||(r={}))},12396:(e,t,n)=>{"use strict";n.d(t,{q:()=>s});var r=n(75992);class s extends r.r{constructor(){super(s.actionType)}}s.actionType="PLW_ENABLE_DIFFSYNC"},13374:(e,t,n)=>{"use strict";n.d(t,{Y:()=>s});var r=n(75992);class s extends r.r{isLoggingEnabled(){return!1}constructor(e,t){super(s.actionType),this.diffSyncFeed=e,this.timestamp=t}}s.actionType="PLW_GET_DIFFSYNCFEED_SUCCEEDED"},13736:(e,t,n)=>{"use strict";n.d(t,{K:()=>s});var r=n(75992);class s extends r.r{isLoggingEnabled(){return!1}constructor(){super(s.actionType)}}s.actionType="PLW_DIFFSYNCFETCH_SCHEDULED"},14070:(e,t,n)=>{"use strict";n.d(t,{N:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{recentPlanCount:String(this.plans.length)}}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(s.actionType),this.userId=e,this.plans=t,this.isFirstPage=n}}s.actionType="PLW_GET_RECENTPLANSFORUSER_SUCCEEDED"},15434:(e,t,n)=>{"use strict";n.d(t,{x:()=>s});var r=n(32512);class s extends r.v{constructor(e,t,n,r){super(s.actionType,e,t,n),this.containerId=r}}s.actionType="PLW_GET_CONTAINER_FAIL"},15765:(e,t,n)=>{"use strict";n.d(t,{V:()=>s});var r=n(32512);class s extends r.v{constructor(e,t,n,r){super(s.actionType,t,n,r),this.bucketId=e}}s.actionType="PLW_DELETE_BUCKET_FAILED"},17920:(e,t,n)=>{"use strict";n.d(t,{f:()=>P});var r=n(65043),s=n(51948),i=n(17066),a=n(13706),o=n(6618),l=n(16112),c=n(70768),d=n(66783),u=n(52195),h=n(25420),p="#ffffff",g=(0,d.J9)(function(e){var t={root:{fontSize:u.s.medium,display:"inline-flex",marginTop:"16px",padding:"14px 16px",minHeight:"48px",minWidth:"292px",maxWidth:"876px",alignItems:"center",backgroundColor:"#323130",color:p,borderRadius:"4px",boxShadow:"0 1.2px 3.6px 0 rgba(0, 0, 0, 0.11), 0 6.4px 14.4px 0 rgba(0, 0, 0, 0.13)",boxSizing:"border-box",overflow:"hidden"},content:{marginRight:"32px",display:"inline-flex",wordWrap:"break-word",wordBreak:"break-all",fontWeight:"300"},action:[(0,h.$Z)(),{marginRight:"16px",marginLeft:"auto",color:p,fontWeight:"500","> .action-link":{wordBreak:"break-all","> a":{cursor:"pointer",textDecoration:"none"}}}]};return(0,u.TW)(t,e)}),m=(0,d.J9)(function(e){var t=g(e);return{root:(0,u.Zq)("base-toast",t.root),content:(0,u.Zq)("base-toast-content",t.content),action:(0,u.Zq)("base-toast-action",t.action)}}),f=(0,d.J9)(function(e){var t={color:p,backgroundColor:"transparent"},n={root:[(0,h.$Z)(),t,{width:"auto",height:"auto",padding:"0",i:{margin:"0"}}],rootHovered:t,rootFocused:t,rootPressed:t};return(0,u.TW)(n,e)}),y=n(4648),v=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),k=function(){return k=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},k.apply(this,arguments)},T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onActionClick=function(){var e=t.props,n=e.onActionClick,r=e.onDismiss;n&&n(),r()},t}return v(t,e),t.prototype.name=function(){return"Toast"},t.prototype.renderComponent=function(){var e=this.props,t=e.className,n=e.mainContent,l=e.ariaAlertMessage,d=e.actionText,u=e.dismissIconProps,h=e.onDismiss,p=this.getClassNames(),g=(0,i.G1)(this.props,i.JM),m=window.navigator.userAgent.indexOf("Edg/")>-1;return r.createElement("div",k({},g,{className:(0,y.A)(p.root,t)}),r.createElement("div",{className:p.content},n),r.createElement("div",{className:p.action,style:{visibility:d?"visible":"hidden"}},r.createElement("span",{className:"action-link"},r.createElement("a",{onClick:this.onActionClick},d))),r.createElement(a.K,{className:"base-toast-dismiss",styles:this.getbuttonStyles(),iconProps:null!==u&&void 0!==u?u:{iconName:s.F.Cancel},onClick:h}),r.createElement(c.E,null,r.createElement("div",{role:"alert","aria-live":"assertive"},l)),!m&&r.createElement(o.e,{message:l}))},t.prototype.getClassNames=function(){return m(this.props.styles)},t.prototype.getbuttonStyles=function(){return f(this.props.buttonStyles)},t}(l.$),S=n(56415),b=n(77508);const I=(0,d.J9)(e=>{let t=S.z.ThemeTertiary;switch(e){case b.Sx.Light:t=S.z.ThemeLighter;break;case b.Sx.Dark:t=S.z.ThemePrimary;break;case b.Sx.TeamsLight:t=S.z.TeamsDarkPurple;break;case b.Sx.TeamsDark:t=S.z.TeamsPurple;break;case b.Sx.TeamsContrast:t=S.z.TeamsContrastHyperlinkColor;break;case b.Sx.SharePoint:t=S.z.SharepointBackgroundColor()}return{color:t}}),C=(0,d.J9)(e=>({root:[{a:I(e)},(e===b.Sx.Dark||e===b.Sx.TeamsDark)&&{backgroundColor:S.z.White,color:S.z.Black},e===b.Sx.TeamsContrast&&{backgroundColor:S.z.Black,color:S.z.White,border:`1px solid ${S.z.White}`},e===b.Sx.SharePoint&&{backgroundColor:S.z.SharepointTitleFontColor(),color:S.z.SharepointBackgroundColor()}]})),D=(0,d.J9)(e=>({root:[(e===b.Sx.Dark||e===b.Sx.TeamsDark)&&{color:S.z.Black},e===b.Sx.TeamsContrast&&{color:S.z.White},e===b.Sx.SharePoint&&{color:S.z.SharepointBackgroundColor()}],rootHovered:[e===b.Sx.SharePoint&&{backgroundColor:S.z.SharepointTitleFontColor()}]}));var E=n(59846);const P=e=>{const{toastType:t,onDismiss:n,data:s,theme:i,toastTypeWhitelist:a}=e;if(-1===a.indexOf(t))return null;const o=s.styles??C(i),l=s.buttonStyles??D(i);return r.createElement(T,{...s,styles:o,buttonStyles:l,onDismiss:n,dismissIconProps:E.s5})}},17942:(e,t,n)=>{"use strict";n.d(t,{V:()=>c,x:()=>l});var r=n(52195),s=n(66783),i=n(66151),a=n(70596),o=n(65006);const l=(0,s.J9)(e=>(0,r.Zq)("loopApp",[(0,i.gS)("column"),a.gK,o.Lx,{border:"0",width:"100%",height:"100%",position:"absolute",lineHeight:"normal",a:(0,i.BP)(e),"> .errorBar":{...(0,a.ZG)("& > .errorBar")},"> .appContent":[(0,i.gS)("row"),(0,i.GD)(),{"> *:nth-child(1)":[(0,i.gS)(),(0,i.GD)()]}],".plannerIcon":(0,i.gS)(),"*, :global(.plannerAppDialog *, .plannerAppCallout *)":(0,i.Ss)(e)}])),c={content:[o.Lx,{lineHeight:"normal",".plannerIcon":(0,i.gS)(),".editor-container i":{fontStyle:"italic"}}]}},19285:(e,t,n)=>{"use strict";n.d(t,{Q:()=>s});var r=n(25324);class s extends r.l{constructor(e,t,n,r,i,a,o){super(s.actionType,e,t,n,r,i,a,o)}}s.actionType="SHOW_ERROR_NOTIFICATION"},19864:(e,t,n)=>{"use strict";function r(e){return`planner-main-content-${e}`}function s(e){return`planner-loop-container-${e}`}n.d(t,{cL:()=>r,xZ:()=>s})},19879:(e,t,n)=>{"use strict";n.d(t,{k:()=>s});var r=n(75992);class s extends r.r{constructor(e,t){super(s.actionType),this.groupId=e,this.sensitivityLabelId=t}}s.actionType="PLW_GET_UNIFIEDGROUPSENSITIVITYLABEL_SUCCEEDED"},20977:(e,t,n)=>{var r=n(9096),s=n(64416);e.exports=function(e,t){return e&&e.length?s(e,r(t,2)):[]}},21161:(e,t,n)=>{"use strict";n.d(t,{Q:()=>s,S:()=>r});var r=function(e){return e.left="left",e.right="right",e.up="up",e.down="down",e.lineBegin="lineBegin",e.lineEnd="lineEnd",e.pageUp="pageUp",e.pageDown="pageDown",e}({}),s=function(e){return e[e.ip=0]="ip",e[e.fullRange=1]="fullRange",e[e.selectMe=2]="selectMe",e}({})},21721:(e,t,n)=>{"use strict";n.d(t,{c:()=>s});var r=n(32512);class s extends r.v{loggingData(){return{...super.loggingData(),groupId:this.groupId}}constructor(e,t,n,r){super(s.actionType,t,n,r),this.groupId=e}}s.actionType="GET_GROUP_DOCUMENTS_IN_FOLDER_FAILURE"},21845:(e,t,n)=>{"use strict";n.d(t,{Y:()=>s});var r=n(75992);class s extends r.r{constructor(){super(s.actionType)}}s.actionType="CLEAR_NOTIFICATIONS"},23614:(e,t,n)=>{"use strict";n.d(t,{J:()=>s});var r=n(75992);class s extends r.r{constructor(e,t,n){super(s.actionType),this.viewId=e,this.columnId=t,this.columnWidth=n}}s.actionType="PLW_SET_GRID_COLUMN_WIDTH"},23821:(e,t,n)=>{"use strict";n.d(t,{z:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{id:this.bucket.id,updateKey:this.updateKey}}constructor(e,t){super(s.actionType),this.bucket=e,this.updateKey=t}}s.actionType="PLW_UPDATE_BUCKET_SUCCEEDED"},23881:(e,t,n)=>{"use strict";n.d(t,{h:()=>s});var r=n(75992);class s extends r.r{isLoggingEnabled(){return!1}constructor(e){super(s.actionType),this.diffSyncToken=e}}s.actionType="PLW_GET_DIFFSYNCTOKEN_SUCCEEDED"},24322:(e,t,n)=>{"use strict";n.d(t,{T:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{planCount:String(this.plans.length)}}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(s.actionType),this.plans=e,this.isFirstPage=t}}s.actionType="PLW_GET_ROSTERPLANS_FOR_USER_SUCCEEDED"},25744:(e,t,n)=>{"use strict";n.d(t,{e:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{id:this.bucketId}}constructor(e){super(s.actionType),this.bucketId=e}}s.actionType="PLW_DELETE_BUCKET"},26260:(e,t,n)=>{"use strict";n.d(t,{R:()=>l});var r=n(33183),s=n(21382),i=n(54320),a=n.n(i),o=n(86053);class l extends r.M{name(){return"NotificationToast"}constructor(e,t,n){let i=o.p.Strings[e];a()(t)||(i=s.G(i,...t));const c=n?i+", "+n:i;super(l.type,{className:"",toastDataType:r.M.toastDataType,mainContent:c,ariaAlertMessage:c,onDismiss:()=>{}})}}l.type="NOTIFICATION_TOAST"},26410:(e,t,n)=>{"use strict";n.d(t,{B:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{sessionId:this.session.id,groupId:this.session.groupId,itemId:String(this.session.itemId),itemSize:String(this.session.itemSize),bytesSent:String(this.session.bytesSent),expirationTime:null!=this.session.expirationDateTime?this.session.expirationDateTime.toString():"null",updateKey:this.updateKey}}constructor(e,t){super(s.actionType),this.session=e,this.updateKey=t}}s.actionType="PLW_CREATE_UPLOAD_SESSION_SUCCEEDED"},26715:(e,t,n)=>{"use strict";n.d(t,{m:()=>s});var r=n(75992);class s extends r.r{constructor(e,t){super(s.actionType),this.viewId=e,this.sortCriteria=t}}s.actionType="PLW_SET_SORT_CRITERIA"},28242:(e,t,n)=>{"use strict";n.d(t,{R:()=>s});var r=n(32512);class s extends r.v{constructor(e,t,n,r,i){super(s.actionType,n,r,i),this.originalPlanEntitySet=e,this.updateKey=t}}s.actionType="PLW_UPDATE_PLANENTITYSET_FAILED"},30263:(e,t,n)=>{"use strict";n.d(t,{T:()=>s});var r=n(75992);class s extends r.r{constructor(e,t,n){super(s.actionType),this.entityId=e,this.query=t,this.results=n}}s.actionType="AUGLOOP_FETCH_IMG_RECS_SUCCEEDED"},30450:(e,t,n)=>{var r=n(80755),s=n(55647),i=n(64416),a=n(76272),o=s(function(e){return i(r(e,1,a,!0))});e.exports=o},31158:e=>{function t(e,t){if((e=e.replace(/\s+/g,""))===(t=t.replace(/\s+/g,"")))return 1;if(e.length<2||t.length<2)return 0;let n=new Map;for(let s=0;s<e.length-1;s++){const t=e.substring(s,s+2),r=n.has(t)?n.get(t)+1:1;n.set(t,r)}let r=0;for(let s=0;s<t.length-1;s++){const e=t.substring(s,s+2),i=n.has(e)?n.get(e):0;i>0&&(n.set(e,i-1),r++)}return 2*r/(e.length+t.length-2)}e.exports={compareTwoStrings:t,findBestMatch:function(e,n){if(!function(e,t){return"string"===typeof e&&(!!Array.isArray(t)&&(!!t.length&&!t.find(function(e){return"string"!==typeof e})))}(e,n))throw new Error("Bad arguments: First argument should be a string, second should be an array of strings");const r=[];let s=0;for(let a=0;a<n.length;a++){const i=n[a],o=t(e,i);r.push({target:i,rating:o}),o>r[s].rating&&(s=a)}const i=r[s];return{ratings:r,bestMatch:i,bestMatchIndex:s}}}},31415:(e,t,n)=>{"use strict";n.d(t,{c:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{operationId:this.operationId,ownerId:this.planOwner,clientOperationId:this.clientOperationId}}constructor(e,t,n){super(s.actionType),this.operationId=e,this.planOwner=t,this.clientOperationId=n}}s.actionType="PLW_COPY_PLAN_SUCCEEDED"},33414:(e,t,n)=>{"use strict";n.d(t,{e:()=>s});var r=n(32512);class s extends r.v{constructor(e,t,n){super(s.actionType,e,t,n)}}s.actionType="PLW_GET_SENSITIVITYLABELS_FAILED"},34631:(e,t,n)=>{"use strict";n.d(t,{V:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{id:this.updatedFormats.assignmentBoardFormat?.id??this.updatedFormats.bucketBoardFormat?.id??this.updatedFormats.progressBoardFormat?.id??""}}constructor(e,t){super(s.actionType),this.originalFormats=e,this.updatedFormats=t}}s.actionType="PLW_DIFFSYNC_UPDATE_TASK_FORMAT"},35525:(e,t,n)=>{"use strict";var r,s,i,a;n.d(t,{uU:()=>a,xJ:()=>r}),function(e){e.PercentComplete="percentComplete",e.Assignments="assignments",e.Title="title",e.Bucket="bucketId",e.StartDate="startDate",e.DueDate="dueDate",e.Priority="priority",e.MarkTaskAsCompleteColumnName="markTaskAsComplete",e.AddColumnColumnName="addColumn",e.Plan="plan",e.Labels="labels"}(r||(r={})),function(e){e.HeaderHeight=40,e.RowHeaderWidth=32,e.RowHeight=40,e.AddColumnWidth=164,e.MarkTaskAsCompleteColumnWidth=40,e.DefaultColumnWidth=144,e.AssignedToColumnWidth=180,e.PlanColumnWidth=180,e.TitleColumnWidth=378,e.UndefinedColumnWidth=0,e.LabelsColumnWidth=200}(s||(s={})),function(e){e.DefaultCellValue="",e.ToggleTaskCompletionColumnLeftPadding="0px",e.ToggleTaskCompletionColumnRightPadding="0px",e.ToggleTaskCompletionColumnTopPadding="13px",e.ToggleTaskCompletionColumnBottomPadding="11px"}(i||(i={})),function(e){e.AddToMyDay="addToMyDay",e.RemoveFromMyDay="removeFromMyDay",e.TaskDetails="taskDetails",e.CopyLinkToTask="copyLinkToTask",e.DeleteTask="deleteTask",e.MarkTaskAsComplete="markTaskAsComplete",e.ReactivateTask="markTaskAsIncomplete"}(a||(a={}))},35879:(e,t,n)=>{"use strict";n.d(t,{U:()=>s});var r=n(75992);class s extends r.r{constructor(e,t){super(s.actionType),this.updatedLocalPlanEntitySet=e,this.updateKey=t}}s.actionType="PLW_UPDATE_PLANENTITYSET"},37535:(e,t,n)=>{"use strict";var r;n.d(t,{P:()=>r}),function(e){e[e.Conversations=0]="Conversations",e[e.Calendar=1]="Calendar",e[e.People=2]="People",e[e.Documents=3]="Documents",e[e.Notebook=4]="Notebook",e[e.Yammer=5]="Yammer"}(r||(r={}))},38227:(e,t,n)=>{"use strict";n.d(t,{R:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{id:this.bucketId}}constructor(e){super(s.actionType),this.bucketId=e}}s.actionType="PLW_DELETE_BUCKET_SUCCEEDED"},39202:(e,t,n)=>{"use strict";n.d(t,{K:()=>s});var r=n(75992);class s extends r.r{constructor(e){super(s.actionType),this.sensitivityLabels=e}}s.actionType="PLW_GET_SENSITIVITYLABELS_SUCCEEDED"},40655:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(65818),s=n(75992);class i extends s.r{loggingData(){return{containerType:String(r.K),idCount:String(this.containers.length)}}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(i.actionType),this.containerType=e,this.containers=t,this.isFirstPage=n}}i.actionType="PLW_GET_IDSFORCONTAINERTYPE_SUCCEEDED"},40656:(e,t,n)=>{"use strict";function r(e,t){const n=e;return n?.creationData?.dataType===t&&void 0!==n.creationData.data}n.d(t,{I:()=>r})},40729:(e,t,n)=>{"use strict";n.d(t,{d:()=>r});var r,s=n(74844),i=n(56415),a=n(77508),o=n(79537);!function(e){function t(e){let t="theme-";switch(e){case a.Sx.Dark:t+="dark";break;case a.Sx.TeamsDark:t+="teamsdark";break;case a.Sx.TeamsLight:t+="teamslight";break;case a.Sx.TeamsContrast:t+="teamscontrast";break;case a.Sx.SharePoint:t+="sharepoint";break;case a.Sx.LoopLight:t+="looplight";break;case a.Sx.LoopDark:t+="loopdark";break;default:case a.Sx.Light:t+="light"}return t}function n(e){Object.keys(a.Sx).map(e=>a.Sx[e]).forEach(n=>{const r=t(n);e.classList.remove(r)})}function r(){if(null!=window.matchMedia){return window.matchMedia("(-ms-high-contrast: white-on-black)").matches}return!1}e.parseThemeClassname=t,e.removeAllThemeClassNames=n,e.applyTheme=function(e,r){const s=t(r);e.classList.contains(s)||(n(e),e.classList.toggle(s,!0))},e.getChartBorderColorForTheme=function(e,t){switch(e){case a.Sx.Light:case a.Sx.TeamsLight:case a.Sx.LoopLight:case a.Sx.LoopWorkspaceLight:return i.z.White;case a.Sx.Dark:case a.Sx.TeamsDark:case a.Sx.LoopDark:case a.Sx.LoopWorkspaceDark:return i.z.TeamsDark_Background;case a.Sx.TeamsContrast:return i.z.Black;case a.Sx.SharePoint:return i.z.SharepointBGColorForNonProcessableStyles();default:return o.f.unreachableCase(e,e=>{t.logTrace(507778460,s.k.Warning,e)}),i.z.White}},e.getChartFontColorForTheme=function(e,t){switch(e){case a.Sx.Light:case a.Sx.TeamsLight:case a.Sx.LoopLight:case a.Sx.LoopWorkspaceLight:return r()?i.z.White:i.z.Black;case a.Sx.Dark:case a.Sx.TeamsDark:case a.Sx.LoopDark:case a.Sx.LoopWorkspaceDark:case a.Sx.TeamsContrast:return i.z.White;case a.Sx.SharePoint:return r()?i.z.White:i.z.SharepointTextColorForNonProcessableStyles();default:return o.f.unreachableCase(e,e=>{t.logTrace(507778459,s.k.Warning,e)}),i.z.Black}},e.getChartGridColorForTheme=function(e,t){switch(e){case a.Sx.Light:case a.Sx.TeamsLight:case a.Sx.LoopLight:case a.Sx.LoopWorkspaceLight:return i.z.NeutralTertiaryAlt;case a.Sx.Dark:case a.Sx.TeamsDark:case a.Sx.LoopDark:case a.Sx.LoopWorkspaceDark:return i.z.TeamsDark_NeutralPrimary;case a.Sx.TeamsContrast:return i.z.White;case a.Sx.SharePoint:return i.z.SharepointTextColorForNonProcessableStyles();default:return o.f.unreachableCase(e,e=>{t.logTrace(507778458,s.k.Warning,e)}),i.z.NeutralTertiaryAlt}},e.getChartTooltipBgColorForTheme=function(e,t){switch(e){case a.Sx.Light:case a.Sx.TeamsLight:case a.Sx.LoopLight:case a.Sx.LoopWorkspaceLight:return r()?i.z.Black:"rgba(255, 255, 255, 0.8)";case a.Sx.SharePoint:return r()?i.z.Black:i.z.SharepointBGColorForNonProcessableStyles();case a.Sx.Dark:case a.Sx.TeamsDark:case a.Sx.LoopDark:case a.Sx.LoopWorkspaceDark:return"rgba(0, 0, 0, 0.8)";case a.Sx.TeamsContrast:return i.z.Black;default:return o.f.unreachableCase(e,e=>{t.logTrace(507778457,s.k.Warning,e)}),"rgba(255, 255, 255, 0.8)"}},e.getMeetingNotesColor=function(e,t){switch(e){case a.Sx.Light:case a.Sx.TeamsLight:case a.Sx.SharePoint:case a.Sx.LoopLight:case a.Sx.LoopWorkspaceLight:return i.z.MeetingNotesColorLight;case a.Sx.Dark:case a.Sx.TeamsDark:case a.Sx.LoopDark:case a.Sx.LoopWorkspaceDark:return i.z.MeetingNotesColorDark;case a.Sx.TeamsContrast:return i.z.HighContrastYellow;default:return o.f.unreachableCase(e,e=>{t.logTrace(507778456,s.k.Warning,e)}),i.z.MeetingNotesColorLight}},e.getLoopColor=function(e,t){switch(e){case a.Sx.Light:case a.Sx.TeamsLight:case a.Sx.SharePoint:return i.z.NeutralLightGrey26;case a.Sx.Dark:case a.Sx.TeamsDark:return i.z.LoopBrand100;case a.Sx.TeamsContrast:return i.z.HighContrastYellow;case a.Sx.LoopLight:case a.Sx.LoopWorkspaceLight:return i.z.NeutralLightGrey14;case a.Sx.LoopDark:case a.Sx.LoopWorkspaceDark:return i.z.White;default:return o.f.unreachableCase(e,e=>{t.logTrace(507778455,s.k.Warning,e)}),i.z.LoopLightP0}},e.getWordColor=function(e,t){switch(e){case a.Sx.Light:case a.Sx.TeamsLight:case a.Sx.SharePoint:case a.Sx.LoopLight:case a.Sx.LoopWorkspaceLight:return i.z.WordColorLight;case a.Sx.Dark:case a.Sx.TeamsDark:case a.Sx.LoopDark:case a.Sx.LoopWorkspaceDark:return i.z.WordColorDark;case a.Sx.TeamsContrast:return i.z.HighContrastYellow;default:return o.f.unreachableCase(e,e=>{t.logTrace(507778454,s.k.Warning,e)}),i.z.WordColorLight}},e.getExcelColor=function(e,t){switch(e){case a.Sx.Light:case a.Sx.TeamsLight:case a.Sx.SharePoint:case a.Sx.LoopLight:case a.Sx.LoopWorkspaceLight:return i.z.ExcelColorLight;case a.Sx.Dark:case a.Sx.TeamsDark:case a.Sx.LoopDark:case a.Sx.LoopWorkspaceDark:return i.z.ExcelColorDark;case a.Sx.TeamsContrast:return i.z.HighContrastYellow;default:return o.f.unreachableCase(e,e=>{t.logTrace(507778453,s.k.Warning,e)}),i.z.ExcelColorLight}},e.getPowerPointColor=function(e,t){switch(e){case a.Sx.Light:case a.Sx.TeamsLight:case a.Sx.SharePoint:case a.Sx.LoopLight:case a.Sx.LoopWorkspaceLight:return i.z.PowerPointColorLight;case a.Sx.Dark:case a.Sx.TeamsDark:case a.Sx.LoopDark:case a.Sx.LoopWorkspaceDark:return i.z.PowerPointColorDark;case a.Sx.TeamsContrast:return i.z.HighContrastYellow;default:return o.f.unreachableCase(e,e=>{t.logTrace(507778452,s.k.Warning,e)}),i.z.PowerPointColorLight}},e.getProjectColor=function(e,t){switch(e){case a.Sx.Light:case a.Sx.TeamsLight:case a.Sx.SharePoint:case a.Sx.LoopLight:case a.Sx.LoopWorkspaceLight:return i.z.ProjectColorLight;case a.Sx.Dark:case a.Sx.TeamsDark:case a.Sx.LoopDark:case a.Sx.LoopWorkspaceDark:return i.z.ProjectColorDark;case a.Sx.TeamsContrast:return i.z.HighContrastYellow;default:return o.f.unreachableCase(e,e=>{t.logTrace(507778451,s.k.Warning,e)}),i.z.ProjectColorLight}},e.getTeamsMessageColor=function(e,t){switch(e){case a.Sx.Light:case a.Sx.TeamsLight:case a.Sx.SharePoint:case a.Sx.LoopLight:case a.Sx.LoopWorkspaceLight:return i.z.TeamsAppBrand00;case a.Sx.Dark:case a.Sx.TeamsDark:case a.Sx.LoopDark:case a.Sx.LoopWorkspaceDark:return i.z.TeamsMessageDarkColor;case a.Sx.TeamsContrast:return i.z.HighContrastYellow;default:return o.f.unreachableCase(e,e=>{t.logTrace(507778450,s.k.Warning,e)}),i.z.TeamsAppBrand00}},e.isWindowsHighContrastWhiteOnBlack=r,e.isWindowsHighContrast=function(){if(null!=window.matchMedia){return window.matchMedia("(-ms-high-contrast)").matches}return!1},e.isLoopTheme=function(e){switch(e){case a.Sx.LoopLight:case a.Sx.LoopDark:case a.Sx.LoopWorkspaceLight:case a.Sx.LoopWorkspaceDark:return!0;default:return!1}}}(r||(r={}))},41927:(e,t,n)=>{"use strict";n.d(t,{F:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{id:this.taskFormats.assignmentBoardFormat?.id??this.taskFormats.bucketBoardFormat?.id??this.taskFormats.progressBoardFormat?.id??""}}constructor(e){super(s.actionType),this.taskFormats=e}}s.actionType="PLW_DIFFSYNC_INSERT_TASK_FORMAT"},42045:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{id:this.planEntitySet.id}}constructor(e){super(s.actionType),this.planEntitySet=e}}s.actionType="PLW_DIFFSYNC_UPDATE_PLAN"},42463:(e,t,n)=>{"use strict";var r;n.d(t,{H:()=>r}),function(e){e[e.info=0]="info",e[e.error=1]="error",e[e.blocked=2]="blocked",e[e.severeWarning=3]="severeWarning",e[e.success=4]="success",e[e.warning=5]="warning"}(r||(r={}))},42870:(e,t,n)=>{"use strict";n.d(t,{M:()=>i});var r=n(937),s=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=function(e){function t(t,n){return e.call(this,t,n)||this}return s(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this.fetchCriticalData(this.props,this.state)},t.prototype.componentDidUpdate=function(e,t){this.fetchCriticalDataWhenComponentDidUpdate(e,t)&&this.fetchCriticalData(this.props,this.state),this.fetchNonCriticalDataWhenComponentDidUpdate(e,t)&&this.checkForCriticalDataReady()&&this.fetchNonCriticalData(this.props,this.state)},t.prototype.fetchCriticalDataWhenComponentDidUpdate=function(e,t){return!1},t.prototype.fetchNonCriticalDataWhenComponentDidUpdate=function(e,t){return!1},t}(r.F)},43068:(e,t,n)=>{"use strict";n.d(t,{Q:()=>s});var r=n(75992);class s extends r.r{constructor(e){super(s.actionType),this.tenantGroupSettings=e}}s.actionType="PLW_GET_TENANTGROUPSETTINGS_SUCCEEDED"},43746:(e,t,n)=>{"use strict";function r(e,t){return e.filter(e=>!!e.keyboardShortcutDescription.isOverride===t)}n.d(t,{D:()=>r})},43841:(e,t,n)=>{"use strict";n.d(t,{V:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{id:this.updatedTaskDetails.id}}constructor(e,t){super(s.actionType),this.originalTaskDetails=e,this.updatedTaskDetails=t}}s.actionType="PLW_DIFFSYNC_UPDATE_TASK_DETAILS"},44227:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var r=n(75992);class s extends r.r{constructor(e){super(s.actionType),this.container=e}}s.actionType="PLW_CREATE_ROSTER_CONTAINER_SUCCESS"},44430:(e,t,n)=>{"use strict";var r;n.d(t,{N:()=>r}),function(e){e[e.NonMember=0]="NonMember",e[e.Member=1]="Member",e[e.Owner=2]="Owner"}(r||(r={}))},45100:(e,t,n)=>{"use strict";n.d(t,{d:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{groupId:this.groupId}}constructor(e,t,n){super(s.actionType),this.groupId=e,this.itemUrl=t,this.thumbnail=n}}s.actionType="PLW_GET_DRIVE_ITEM_THUMBNAIL_SUCCEEDED"},45679:(e,t,n)=>{"use strict";n.d(t,{e:()=>s});var r=n(25324);class s extends r.l{constructor(e,t,n,r,i,a,o){super(s.actionType,e,t,n,r,i,a,o)}}s.actionType="SHOW_WARNING_NOTIFICATION"},45698:(e,t,n)=>{"use strict";n.d(t,{a:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{id:this.bucketId}}constructor(e){super(s.actionType),this.bucketId=e}}s.actionType="PLW_DIFFSYNC_DELETE_BUCKET"},46219:(e,t,n)=>{"use strict";n.d(t,{T:()=>s});var r=n(32512);class s extends r.v{constructor(e,t,n,r,i){super(s.actionType,n,r,i),this.bucket=e,this.updateKey=t}}s.actionType="PLW_UPDATE_BUCKET_FAILED"},47572:(e,t,n)=>{"use strict";n.d(t,{c:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{id:this.bucket.id}}constructor(e){super(s.actionType),this.bucket=e}}s.actionType="PLW_DIFFSYNC_UPDATE_BUCKET"},47649:(e,t,n)=>{"use strict";n.d(t,{v:()=>s});var r=n(72799);class s{static create(){return new r.j(void 0,e=>{throw e})}}},48148:(e,t,n)=>{"use strict";n.d(t,{e:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{id:this.bucket.id}}constructor(e){super(s.actionType),this.bucket=e}}s.actionType="PLW_DIFFSYNC_INSERT_BUCKET"},48170:(e,t,n)=>{"use strict";n.d(t,{Y:()=>s});var r=n(75992);class s extends r.r{constructor(e){super(s.actionType),this.sensitivityPolicySettings=e}}s.actionType="PLW_GET_SENSITIVITYPOLICYSETTINGS_SUCCEEDED"},48496:(e,t,n)=>{"use strict";n.d(t,{R:()=>s});var r=n(32512);class s extends r.v{constructor(e,t,n,r){super(s.actionType,e,t,n),this.sessionId=r}}s.actionType="PLW_CANCEL_UPLOAD_SESSION_FAILED"},48545:(e,t,n)=>{"use strict";n.d(t,{B:()=>s});var r=n(32512);class s extends r.v{constructor(e,t,n,r,i){super(s.actionType,n,r,i),this.entityId=e,this.query=t}}s.actionType="AUGLOOP_FETCH_IMG_RECS_FAILED"},48924:(e,t,n)=>{"use strict";n.d(t,{y:()=>An});var r={};n.r(r),n.d(r,{FILE:()=>et,HTML:()=>rt,TEXT:()=>nt,URL:()=>tt});var s={};n.r(s),n.d(s,{FILE:()=>tn,HTML:()=>sn,TEXT:()=>rn,URL:()=>nn});var i=n(65043),a=n(38752),o=n(45795),l=n(70579),c=n(84945),d="dnd-core/INIT_COORDS",u="dnd-core/BEGIN_DRAG",h="dnd-core/PUBLISH_DRAG_SOURCE",p="dnd-core/HOVER",g="dnd-core/DROP",m="dnd-core/END_DRAG";function f(e,t){return{type:d,payload:{sourceClientOffset:t||null,clientOffset:e||null}}}function y(e){return y="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function v(e){return"object"===y(e)}var k={type:d,payload:{clientOffset:null,sourceClientOffset:null}};function T(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{publishSource:!0},r=n.publishSource,s=void 0===r||r,i=n.clientOffset,a=n.getSourceClientOffset,o=e.getMonitor(),l=e.getRegistry();e.dispatch(f(i)),function(e,t,n){(0,c.V)(!t.isDragging(),"Cannot call beginDrag while dragging."),e.forEach(function(e){(0,c.V)(n.getSource(e),"Expected sourceIds to be registered.")})}(t,o,l);var d=function(e,t){for(var n=null,r=e.length-1;r>=0;r--)if(t.canDragSource(e[r])){n=e[r];break}return n}(t,o);if(null!==d){var h=null;if(i){if(!a)throw new Error("getSourceClientOffset must be defined");!function(e){(0,c.V)("function"===typeof e,"When clientOffset is provided, getSourceClientOffset must be a function.")}(a),h=a(d)}e.dispatch(f(i,h));var p=l.getSource(d).beginDrag(o,d);if(null!=p){!function(e){(0,c.V)(v(e),"Item must be an object.")}(p),l.pinSource(d);var g=l.getSourceType(d);return{type:u,payload:{itemType:g,item:p,sourceId:d,clientOffset:i||null,sourceClientOffset:h||null,isSourcePublic:!!s}}}}else e.dispatch(k)}}function S(e){return function(){if(e.getMonitor().isDragging())return{type:h}}}function b(e,t){return null===t?null===e:Array.isArray(e)?e.some(function(e){return e===t}):e===t}function I(e){return function(t){var n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).clientOffset;!function(e){(0,c.V)(Array.isArray(e),"Expected targetIds to be an array.")}(t);var r=t.slice(0),s=e.getMonitor(),i=e.getRegistry();return function(e,t,n){(0,c.V)(t.isDragging(),"Cannot call hover while not dragging."),(0,c.V)(!t.didDrop(),"Cannot call hover after drop.");for(var r=0;r<e.length;r++){var s=e[r];(0,c.V)(e.lastIndexOf(s)===r,"Expected targetIds to be unique in the passed array.");var i=n.getTarget(s);(0,c.V)(i,"Expected targetIds to be registered.")}}(r,s,i),function(e,t,n){for(var r=e.length-1;r>=0;r--){var s=e[r];b(t.getTargetType(s),n)||e.splice(r,1)}}(r,i,s.getItemType()),function(e,t,n){e.forEach(function(e){n.getTarget(e).hover(t,e)})}(r,s,i),{type:p,payload:{targetIds:r,clientOffset:n||null}}}}function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach(function(t){E(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function P(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.getMonitor(),r=e.getRegistry();!function(e){(0,c.V)(e.isDragging(),"Cannot call drop while not dragging."),(0,c.V)(!e.didDrop(),"Cannot call drop twice during one drag operation.")}(n);var s=function(e){var t=e.getTargetIds().filter(e.canDropOnTarget,e);return t.reverse(),t}(n);s.forEach(function(s,i){var a=function(e,t,n,r){var s=n.getTarget(e),i=s?s.drop(r,e):void 0;(function(e){(0,c.V)("undefined"===typeof e||v(e),"Drop result must either be an object or undefined.")})(i),"undefined"===typeof i&&(i=0===t?{}:r.getDropResult());return i}(s,i,r,n),o={type:g,payload:{dropResult:D(D({},t),a)}};e.dispatch(o)})}}function w(e){return function(){var t=e.getMonitor(),n=e.getRegistry();!function(e){(0,c.V)(e.isDragging(),"Cannot call endDrag while not dragging.")}(t);var r=t.getSourceId();null!=r&&(n.getSource(r,!0).endDrag(t,r),n.unpinSource());return{type:m}}}function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function F(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var A=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),F(this,"store",void 0),F(this,"monitor",void 0),F(this,"backend",void 0),F(this,"isSetUp",!1),F(this,"handleRefCountChange",function(){var e=r.store.getState().refCount>0;r.backend&&(e&&!r.isSetUp?(r.backend.setup(),r.isSetUp=!0):!e&&r.isSetUp&&(r.backend.teardown(),r.isSetUp=!1))}),this.store=t,this.monitor=n,t.subscribe(this.handleRefCountChange)}var t,n,r;return t=e,n=[{key:"receiveBackend",value:function(e){this.backend=e}},{key:"getMonitor",value:function(){return this.monitor}},{key:"getBackend",value:function(){return this.backend}},{key:"getRegistry",value:function(){return this.monitor.registry}},{key:"getActions",value:function(){var e=this,t=this.store.dispatch,n=function(e){return{beginDrag:T(e),publishDragSource:S(e),hover:I(e),drop:P(e),endDrag:w(e)}}(this);return Object.keys(n).reduce(function(r,s){var i,a=n[s];return r[s]=(i=a,function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];var a=i.apply(e,r);"undefined"!==typeof a&&t(a)}),r},{})}},{key:"dispatch",value:function(e){this.store.dispatch(e)}}],n&&x(t.prototype,n),r&&x(t,r),e}();function L(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var _="function"===typeof Symbol&&Symbol.observable||"@@observable",U=function(){return Math.random().toString(36).substring(7).split("").join(".")},O={INIT:"@@redux/INIT"+U(),REPLACE:"@@redux/REPLACE"+U(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+U()}};function B(e){if("object"!==typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function M(e,t,n){var r;if("function"===typeof t&&"function"===typeof n||"function"===typeof n&&"function"===typeof arguments[3])throw new Error(L(0));if("function"===typeof t&&"undefined"===typeof n&&(n=t,t=void 0),"undefined"!==typeof n){if("function"!==typeof n)throw new Error(L(1));return n(M)(e,t)}if("function"!==typeof e)throw new Error(L(2));var s=e,i=t,a=[],o=a,l=!1;function c(){o===a&&(o=a.slice())}function d(){if(l)throw new Error(L(3));return i}function u(e){if("function"!==typeof e)throw new Error(L(4));if(l)throw new Error(L(5));var t=!0;return c(),o.push(e),function(){if(t){if(l)throw new Error(L(6));t=!1,c();var n=o.indexOf(e);o.splice(n,1),a=null}}}function h(e){if(!B(e))throw new Error(L(7));if("undefined"===typeof e.type)throw new Error(L(8));if(l)throw new Error(L(9));try{l=!0,i=s(i,e)}finally{l=!1}for(var t=a=o,n=0;n<t.length;n++){(0,t[n])()}return e}return h({type:O.INIT}),(r={dispatch:h,subscribe:u,getState:d,replaceReducer:function(e){if("function"!==typeof e)throw new Error(L(10));s=e,h({type:O.REPLACE})}})[_]=function(){var e,t=u;return(e={subscribe:function(e){if("object"!==typeof e||null===e)throw new Error(L(11));function n(){e.next&&e.next(d())}return n(),{unsubscribe:t(n)}}})[_]=function(){return this},e},r}var N=function(e,t){return e===t};function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach(function(t){W(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function W(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var z={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};function j(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z,r=arguments.length>1?arguments[1]:void 0,s=r.payload;switch(r.type){case d:case u:return{initialSourceClientOffset:s.sourceClientOffset,initialClientOffset:s.clientOffset,clientOffset:s.clientOffset};case p:return e=n.clientOffset,t=s.clientOffset,!e&&!t||e&&t&&e.x===t.x&&e.y===t.y?n:G(G({},n),{},{clientOffset:s.clientOffset});case m:case g:return z;default:return n}}var K="dnd-core/ADD_SOURCE",H="dnd-core/ADD_TARGET",V="dnd-core/REMOVE_SOURCE",Z="dnd-core/REMOVE_TARGET";function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach(function(t){$(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function $(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var J={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};function X(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J,r=arguments.length>1?arguments[1]:void 0,s=r.payload;switch(r.type){case u:return Y(Y({},n),{},{itemType:s.itemType,item:s.item,sourceId:s.sourceId,isSourcePublic:s.isSourcePublic,dropResult:null,didDrop:!1});case h:return Y(Y({},n),{},{isSourcePublic:!0});case p:return Y(Y({},n),{},{targetIds:s.targetIds});case Z:return-1===n.targetIds.indexOf(s.targetId)?n:Y(Y({},n),{},{targetIds:(e=n.targetIds,t=s.targetId,e.filter(function(e){return e!==t}))});case g:return Y(Y({},n),{},{dropResult:s.dropResult,didDrop:!0,targetIds:[]});case m:return Y(Y({},n),{},{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return n}}function Q(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;switch((arguments.length>1?arguments[1]:void 0).type){case K:case H:return e+1;case V:case Z:return e-1;default:return e}}var ee=[],te=[];function ne(){var e=arguments.length>1?arguments[1]:void 0;switch(e.type){case p:break;case K:case H:case Z:case V:return ee;default:return te}var t=e.payload,n=t.targetIds,r=void 0===n?[]:n,s=t.prevTargetIds,i=void 0===s?[]:s,a=function(e,t){var n=new Map,r=function(e){n.set(e,n.has(e)?n.get(e)+1:1)};e.forEach(r),t.forEach(r);var s=[];return n.forEach(function(e,t){1===e&&s.push(t)}),s}(r,i),o=a.length>0||!function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:N;if(e.length!==t.length)return!1;for(var r=0;r<e.length;++r)if(!n(e[r],t[r]))return!1;return!0}(r,i);if(!o)return ee;var l=i[i.length-1],c=r[r.length-1];return l!==c&&(l&&a.push(l),c&&a.push(c)),a}function re(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)+1}function se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?se(Object(n),!0).forEach(function(t){ae(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):se(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ae(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oe(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;return{dirtyHandlerIds:ne(r.dirtyHandlerIds,{type:s.type,payload:ie(ie({},s.payload),{},{prevTargetIds:(e=r,t="dragOperation.targetIds",n=[],t.split(".").reduce(function(e,t){return e&&e[t]?e[t]:n||null},e))})}),dragOffset:j(r.dragOffset,s),refCount:Q(r.refCount,s),dragOperation:X(r.dragOperation,s),stateId:re(r.stateId)}}function le(e,t){return{x:e.x-t.x,y:e.y-t.y}}function ce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function de(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}ee.__IS_NONE__=!0,te.__IS_ALL__=!0;var ue,he=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),de(this,"store",void 0),de(this,"registry",void 0),this.store=t,this.registry=n}var t,n,r;return t=e,n=[{key:"subscribeToStateChange",value:function(e){var t=this,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{handlerIds:void 0}).handlerIds;(0,c.V)("function"===typeof e,"listener must be a function."),(0,c.V)("undefined"===typeof n||Array.isArray(n),"handlerIds, when specified, must be an array of strings.");var r=this.store.getState().stateId;return this.store.subscribe(function(){var s=t.store.getState(),i=s.stateId;try{var a=i===r||i===r+1&&!function(e,t){return e!==ee&&(e===te||"undefined"===typeof t||(n=e,t.filter(function(e){return n.indexOf(e)>-1})).length>0);var n}(s.dirtyHandlerIds,n);a||e()}finally{r=i}})}},{key:"subscribeToOffsetChange",value:function(e){var t=this;(0,c.V)("function"===typeof e,"listener must be a function.");var n=this.store.getState().dragOffset;return this.store.subscribe(function(){var r=t.store.getState().dragOffset;r!==n&&(n=r,e())})}},{key:"canDragSource",value:function(e){if(!e)return!1;var t=this.registry.getSource(e);return(0,c.V)(t,"Expected to find a valid source. sourceId=".concat(e)),!this.isDragging()&&t.canDrag(this,e)}},{key:"canDropOnTarget",value:function(e){if(!e)return!1;var t=this.registry.getTarget(e);return(0,c.V)(t,"Expected to find a valid target. targetId=".concat(e)),!(!this.isDragging()||this.didDrop())&&b(this.registry.getTargetType(e),this.getItemType())&&t.canDrop(this,e)}},{key:"isDragging",value:function(){return Boolean(this.getItemType())}},{key:"isDraggingSource",value:function(e){if(!e)return!1;var t=this.registry.getSource(e,!0);return(0,c.V)(t,"Expected to find a valid source. sourceId=".concat(e)),!(!this.isDragging()||!this.isSourcePublic())&&this.registry.getSourceType(e)===this.getItemType()&&t.isDragging(this,e)}},{key:"isOverTarget",value:function(e){if(!e)return!1;var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shallow:!1}).shallow;if(!this.isDragging())return!1;var n=this.registry.getTargetType(e),r=this.getItemType();if(r&&!b(n,r))return!1;var s=this.getTargetIds();if(!s.length)return!1;var i=s.indexOf(e);return t?i===s.length-1:i>-1}},{key:"getItemType",value:function(){return this.store.getState().dragOperation.itemType}},{key:"getItem",value:function(){return this.store.getState().dragOperation.item}},{key:"getSourceId",value:function(){return this.store.getState().dragOperation.sourceId}},{key:"getTargetIds",value:function(){return this.store.getState().dragOperation.targetIds}},{key:"getDropResult",value:function(){return this.store.getState().dragOperation.dropResult}},{key:"didDrop",value:function(){return this.store.getState().dragOperation.didDrop}},{key:"isSourcePublic",value:function(){return Boolean(this.store.getState().dragOperation.isSourcePublic)}},{key:"getInitialClientOffset",value:function(){return this.store.getState().dragOffset.initialClientOffset}},{key:"getInitialSourceClientOffset",value:function(){return this.store.getState().dragOffset.initialSourceClientOffset}},{key:"getClientOffset",value:function(){return this.store.getState().dragOffset.clientOffset}},{key:"getSourceClientOffset",value:function(){return function(e){var t,n,r=e.clientOffset,s=e.initialClientOffset,i=e.initialSourceClientOffset;return r&&s&&i?le((n=i,{x:(t=r).x+n.x,y:t.y+n.y}),s):null}(this.store.getState().dragOffset)}},{key:"getDifferenceFromInitialOffset",value:function(){return function(e){var t=e.clientOffset,n=e.initialClientOffset;return t&&n?le(t,n):null}(this.store.getState().dragOffset)}}],n&&ce(t.prototype,n),r&&ce(t,r),e}(),pe=0;function ge(e){return ge="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ge(e)}function me(e,t){t&&Array.isArray(e)?e.forEach(function(e){return me(e,!1)}):(0,c.V)("string"===typeof e||"symbol"===ge(e),t?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}!function(e){e.SOURCE="SOURCE",e.TARGET="TARGET"}(ue||(ue={}));const fe="undefined"!==typeof n.g?n.g:self,ye=fe.MutationObserver||fe.WebKitMutationObserver;function ve(e){return function(){const t=setTimeout(r,0),n=setInterval(r,50);function r(){clearTimeout(t),clearInterval(n),e()}}}const ke="function"===typeof ye?function(e){let t=1;const n=new ye(e),r=document.createTextNode("");return n.observe(r,{characterData:!0}),function(){t=-t,r.data=t}}:ve;class Te{call(){try{this.task&&this.task()}catch(e){this.onError(e)}finally{this.task=null,this.release(this)}}constructor(e,t){this.onError=e,this.release=t,this.task=null}}const Se=new class{enqueueTask(e){const{queue:t,requestFlush:n}=this;t.length||(n(),this.flushing=!0),t[t.length]=e}constructor(){this.queue=[],this.pendingErrors=[],this.flushing=!1,this.index=0,this.capacity=1024,this.flush=()=>{const{queue:e}=this;for(;this.index<e.length;){const t=this.index;if(this.index++,e[t].call(),this.index>this.capacity){for(let t=0,n=e.length-this.index;t<n;t++)e[t]=e[t+this.index];e.length-=this.index,this.index=0}}e.length=0,this.index=0,this.flushing=!1},this.registerPendingError=e=>{this.pendingErrors.push(e),this.requestErrorThrow()},this.requestFlush=ke(this.flush),this.requestErrorThrow=ve(()=>{if(this.pendingErrors.length)throw this.pendingErrors.shift()})}},be=new class{create(e){const t=this.freeTasks,n=t.length?t.pop():new Te(this.onError,e=>t[t.length]=e);return n.task=e,n}constructor(e){this.onError=e,this.freeTasks=[]}}(Se.registerPendingError);function Ie(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ce(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function De(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,s,i=[],a=!0,o=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(l){o=!0,s=l}finally{try{a||null==n.return||n.return()}finally{if(o)throw s}}return i}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Ee(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ee(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Pe(e){var t=(pe++).toString();switch(e){case ue.SOURCE:return"S".concat(t);case ue.TARGET:return"T".concat(t);default:throw new Error("Unknown Handler Role: ".concat(e))}}function we(e){switch(e[0]){case"S":return ue.SOURCE;case"T":return ue.TARGET;default:(0,c.V)(!1,"Cannot parse handler ID: ".concat(e))}}function xe(e,t){var n=e.entries(),r=!1;do{var s=n.next(),i=s.done;if(De(s.value,2)[1]===t)return!0;r=!!i}while(!r);return!1}var Fe=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Ce(this,"types",new Map),Ce(this,"dragSources",new Map),Ce(this,"dropTargets",new Map),Ce(this,"pinnedSourceId",null),Ce(this,"pinnedSource",null),Ce(this,"store",void 0),this.store=t}var t,n,r;return t=e,n=[{key:"addSource",value:function(e,t){me(e),function(e){(0,c.V)("function"===typeof e.canDrag,"Expected canDrag to be a function."),(0,c.V)("function"===typeof e.beginDrag,"Expected beginDrag to be a function."),(0,c.V)("function"===typeof e.endDrag,"Expected endDrag to be a function.")}(t);var n=this.addHandler(ue.SOURCE,e,t);return this.store.dispatch(function(e){return{type:K,payload:{sourceId:e}}}(n)),n}},{key:"addTarget",value:function(e,t){me(e,!0),function(e){(0,c.V)("function"===typeof e.canDrop,"Expected canDrop to be a function."),(0,c.V)("function"===typeof e.hover,"Expected hover to be a function."),(0,c.V)("function"===typeof e.drop,"Expected beginDrag to be a function.")}(t);var n=this.addHandler(ue.TARGET,e,t);return this.store.dispatch(function(e){return{type:H,payload:{targetId:e}}}(n)),n}},{key:"containsHandler",value:function(e){return xe(this.dragSources,e)||xe(this.dropTargets,e)}},{key:"getSource",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,c.V)(this.isSourceId(e),"Expected a valid source ID."),t&&e===this.pinnedSourceId?this.pinnedSource:this.dragSources.get(e)}},{key:"getTarget",value:function(e){return(0,c.V)(this.isTargetId(e),"Expected a valid target ID."),this.dropTargets.get(e)}},{key:"getSourceType",value:function(e){return(0,c.V)(this.isSourceId(e),"Expected a valid source ID."),this.types.get(e)}},{key:"getTargetType",value:function(e){return(0,c.V)(this.isTargetId(e),"Expected a valid target ID."),this.types.get(e)}},{key:"isSourceId",value:function(e){return we(e)===ue.SOURCE}},{key:"isTargetId",value:function(e){return we(e)===ue.TARGET}},{key:"removeSource",value:function(e){var t,n=this;(0,c.V)(this.getSource(e),"Expected an existing source."),this.store.dispatch(function(e){return{type:V,payload:{sourceId:e}}}(e)),t=function(){n.dragSources.delete(e),n.types.delete(e)},Se.enqueueTask(be.create(t))}},{key:"removeTarget",value:function(e){(0,c.V)(this.getTarget(e),"Expected an existing target."),this.store.dispatch(function(e){return{type:Z,payload:{targetId:e}}}(e)),this.dropTargets.delete(e),this.types.delete(e)}},{key:"pinSource",value:function(e){var t=this.getSource(e);(0,c.V)(t,"Expected an existing source."),this.pinnedSourceId=e,this.pinnedSource=t}},{key:"unpinSource",value:function(){(0,c.V)(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null}},{key:"addHandler",value:function(e,t,n){var r=Pe(e);return this.types.set(r,t),e===ue.SOURCE?this.dragSources.set(r,n):e===ue.TARGET&&this.dropTargets.set(r,n),r}}],n&&Ie(t.prototype,n),r&&Ie(t,r),e}();function Ae(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=function(e){var t="undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__;return M(oe,e&&t&&t({name:"dnd-core",instanceId:"dnd-core"}))}(arguments.length>3&&void 0!==arguments[3]&&arguments[3]),s=new he(r,new Fe(r)),i=new A(r,s),a=e(i,t,n);return i.receiveBackend(a),i}var Le=n(61804),_e=["children"];function Ue(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,s,i=[],a=!0,o=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(l){o=!0,s=l}finally{try{a||null==n.return||n.return()}finally{if(o)throw s}}return i}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Oe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Oe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Oe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Be(e,t){if(null==e)return{};var n,r,s=function(e,t){if(null==e)return{};var n,r,s={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var Me=0,Ne=Symbol.for("__REACT_DND_CONTEXT_INSTANCE__"),Re=(0,i.memo)(function(e){var t=e.children,n=function(e){if("manager"in e){return[{dragDropManager:e.manager},!1]}var t=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ge(),n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,s=t;s[Ne]||(s[Ne]={dragDropManager:Ae(e,t,n,r)});return s[Ne]}(e.backend,e.context,e.options,e.debugMode),n=!e.context;return[t,n]}(Be(e,_e)),r=Ue(n,2),s=r[0],a=r[1];return(0,i.useEffect)(function(){if(a){var e=Ge();return++Me,function(){0===--Me&&(e[Ne]=null)}}},[]),(0,l.jsx)(Le.M.Provider,Object.assign({value:s},{children:t}),void 0)});function Ge(){return"undefined"!==typeof n.g?n.g:window}function We(e){var t=null;return function(){return null==t&&(t=e()),t}}function ze(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function je(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ke=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),je(this,"entered",[]),je(this,"isNodeInDocument",void 0),this.isNodeInDocument=t}var t,n,r;return t=e,(n=[{key:"enter",value:function(e){var t=this,n=this.entered.length;return this.entered=function(e,t){var n=new Set,r=function(e){return n.add(e)};e.forEach(r),t.forEach(r);var s=[];return n.forEach(function(e){return s.push(e)}),s}(this.entered.filter(function(n){return t.isNodeInDocument(n)&&(!n.contains||n.contains(e))}),[e]),0===n&&this.entered.length>0}},{key:"leave",value:function(e){var t,n,r=this.entered.length;return this.entered=(t=this.entered.filter(this.isNodeInDocument),n=e,t.filter(function(e){return e!==n})),r>0&&0===this.entered.length}},{key:"reset",value:function(){this.entered=[]}}])&&ze(t.prototype,n),r&&ze(t,r),e}(),He=We(function(){return/firefox/i.test(navigator.userAgent)}),Ve=We(function(){return Boolean(window.safari)});function Ze(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ye=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),qe(this,"xs",void 0),qe(this,"ys",void 0),qe(this,"c1s",void 0),qe(this,"c2s",void 0),qe(this,"c3s",void 0);for(var r=t.length,s=[],i=0;i<r;i++)s.push(i);s.sort(function(e,n){return t[e]<t[n]?-1:1});for(var a,o,l=[],c=[],d=[],u=0;u<r-1;u++)a=t[u+1]-t[u],o=n[u+1]-n[u],c.push(a),l.push(o),d.push(o/a);for(var h=[d[0]],p=0;p<c.length-1;p++){var g=d[p],m=d[p+1];if(g*m<=0)h.push(0);else{a=c[p];var f=c[p+1],y=a+f;h.push(3*y/((y+f)/g+(y+a)/m))}}h.push(d[d.length-1]);for(var v,k=[],T=[],S=0;S<h.length-1;S++){v=d[S];var b=h[S],I=1/c[S],C=b+h[S+1]-v-v;k.push((v-b-C)*I),T.push(C*I*I)}this.xs=t,this.ys=n,this.c1s=h,this.c2s=k,this.c3s=T}var t,n,r;return t=e,(n=[{key:"interpolate",value:function(e){var t=this.xs,n=this.ys,r=this.c1s,s=this.c2s,i=this.c3s,a=t.length-1;if(e===t[a])return n[a];for(var o,l=0,c=i.length-1;l<=c;){var d=t[o=Math.floor(.5*(l+c))];if(d<e)l=o+1;else{if(!(d>e))return n[o];c=o-1}}var u=e-t[a=Math.max(0,c)],h=u*u;return n[a]+r[a]*u+s[a]*h+i[a]*u*h}}])&&Ze(t.prototype,n),r&&Ze(t,r),e}();function $e(e){var t=1===e.nodeType?e:e.parentElement;if(!t)return null;var n=t.getBoundingClientRect(),r=n.top;return{x:n.left,y:r}}function Je(e){return{x:e.clientX,y:e.clientY}}function Xe(e,t,n,r,s){var i=function(e){var t;return"IMG"===e.nodeName&&(He()||!(null!==(t=document.documentElement)&&void 0!==t&&t.contains(e)))}(t),a=$e(i?e:t),o={x:n.x-a.x,y:n.y-a.y},l=e.offsetWidth,c=e.offsetHeight,d=r.anchorX,u=r.anchorY,h=function(e,t,n,r){var s=e?t.width:n,i=e?t.height:r;return Ve()&&e&&(i/=window.devicePixelRatio,s/=window.devicePixelRatio),{dragPreviewWidth:s,dragPreviewHeight:i}}(i,t,l,c),p=h.dragPreviewWidth,g=h.dragPreviewHeight,m=s.offsetX,f=s.offsetY,y=0===f||f;return{x:0===m||m?m:new Ye([0,.5,1],[o.x,o.x/l*p,o.x+p-l]).interpolate(d),y:y?f:function(){var e=new Ye([0,.5,1],[o.y,o.y/c*g,o.y+g-c]).interpolate(u);return Ve()&&i&&(e+=(window.devicePixelRatio-1)*g),e}()}}var Qe,et="__NATIVE_FILE__",tt="__NATIVE_URL__",nt="__NATIVE_TEXT__",rt="__NATIVE_HTML__";function st(e,t,n){var r=t.reduce(function(t,n){return t||e.getData(n)},"");return null!=r?r:n}function it(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var at=(it(Qe={},et,{exposeProperties:{files:function(e){return Array.prototype.slice.call(e.files)},items:function(e){return e.items},dataTransfer:function(e){return e}},matchesTypes:["Files"]}),it(Qe,rt,{exposeProperties:{html:function(e,t){return st(e,t,"")},dataTransfer:function(e){return e}},matchesTypes:["Html","text/html"]}),it(Qe,tt,{exposeProperties:{urls:function(e,t){return st(e,t,"").split("\n")},dataTransfer:function(e){return e}},matchesTypes:["Url","text/uri-list"]}),it(Qe,nt,{exposeProperties:{text:function(e,t){return st(e,t,"")},dataTransfer:function(e){return e}},matchesTypes:["Text","text/plain"]}),Qe);function ot(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ct=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),lt(this,"item",void 0),lt(this,"config",void 0),this.config=t,this.item={},this.initializeExposedProperties()}var t,n,r;return t=e,(n=[{key:"initializeExposedProperties",value:function(){var e=this;Object.keys(this.config.exposeProperties).forEach(function(t){Object.defineProperty(e.item,t,{configurable:!0,enumerable:!0,get:function(){return console.warn("Browser doesn't allow reading \"".concat(t,'" until the drop event.')),null}})})}},{key:"loadDataTransfer",value:function(e){var t=this;if(e){var n={};Object.keys(this.config.exposeProperties).forEach(function(r){n[r]={value:t.config.exposeProperties[r](e,t.config.matchesTypes),configurable:!0,enumerable:!0}}),Object.defineProperties(this.item,n)}}},{key:"canDrag",value:function(){return!0}},{key:"beginDrag",value:function(){return this.item}},{key:"isDragging",value:function(e,t){return t===e.getSourceId()}},{key:"endDrag",value:function(){}}])&&ot(t.prototype,n),r&&ot(t,r),e}();function dt(e){if(!e)return null;var t=Array.prototype.slice.call(e.types||[]);return Object.keys(at).filter(function(e){return at[e].matchesTypes.some(function(e){return t.indexOf(e)>-1})})[0]||null}function ut(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ht(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var pt=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),ht(this,"ownerDocument",null),ht(this,"globalContext",void 0),ht(this,"optionsArgs",void 0),this.globalContext=t,this.optionsArgs=n}var t,n,r;return t=e,(n=[{key:"window",get:function(){return this.globalContext?this.globalContext:"undefined"!==typeof window?window:void 0}},{key:"document",get:function(){var e;return null!==(e=this.globalContext)&&void 0!==e&&e.document?this.globalContext.document:this.window?this.window.document:void 0}},{key:"rootElement",get:function(){var e;return(null===(e=this.optionsArgs)||void 0===e?void 0:e.rootElement)||this.window}}])&&ut(t.prototype,n),r&&ut(t,r),e}();function gt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function mt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gt(Object(n),!0).forEach(function(t){yt(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gt(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ft(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var vt=function(){function e(t,n,r){var s=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),yt(this,"options",void 0),yt(this,"actions",void 0),yt(this,"monitor",void 0),yt(this,"registry",void 0),yt(this,"enterLeaveCounter",void 0),yt(this,"sourcePreviewNodes",new Map),yt(this,"sourcePreviewNodeOptions",new Map),yt(this,"sourceNodes",new Map),yt(this,"sourceNodeOptions",new Map),yt(this,"dragStartSourceIds",null),yt(this,"dropTargetIds",[]),yt(this,"dragEnterTargetIds",[]),yt(this,"currentNativeSource",null),yt(this,"currentNativeHandle",null),yt(this,"currentDragSourceNode",null),yt(this,"altKeyPressed",!1),yt(this,"mouseMoveTimeoutTimer",null),yt(this,"asyncEndDragFrameId",null),yt(this,"dragOverTargetIds",null),yt(this,"lastClientOffset",null),yt(this,"hoverRafId",null),yt(this,"getSourceClientOffset",function(e){var t=s.sourceNodes.get(e);return t&&$e(t)||null}),yt(this,"endDragNativeItem",function(){s.isDraggingNativeItem()&&(s.actions.endDrag(),s.currentNativeHandle&&s.registry.removeSource(s.currentNativeHandle),s.currentNativeHandle=null,s.currentNativeSource=null)}),yt(this,"isNodeInDocument",function(e){return Boolean(e&&s.document&&s.document.body&&s.document.body.contains(e))}),yt(this,"endDragIfSourceWasRemovedFromDOM",function(){var e=s.currentDragSourceNode;null==e||s.isNodeInDocument(e)||s.clearCurrentDragSourceNode()&&s.monitor.isDragging()&&s.actions.endDrag()}),yt(this,"handleTopDragStartCapture",function(){s.clearCurrentDragSourceNode(),s.dragStartSourceIds=[]}),yt(this,"handleTopDragStart",function(e){if(!e.defaultPrevented){var t=s.dragStartSourceIds;s.dragStartSourceIds=null;var n=Je(e);s.monitor.isDragging()&&s.actions.endDrag(),s.actions.beginDrag(t||[],{publishSource:!1,getSourceClientOffset:s.getSourceClientOffset,clientOffset:n});var r=e.dataTransfer,i=dt(r);if(s.monitor.isDragging()){if(r&&"function"===typeof r.setDragImage){var a=s.monitor.getSourceId(),o=s.sourceNodes.get(a),l=s.sourcePreviewNodes.get(a)||o;if(l){var c=s.getCurrentSourcePreviewNodeOptions(),d=Xe(o,l,n,{anchorX:c.anchorX,anchorY:c.anchorY},{offsetX:c.offsetX,offsetY:c.offsetY});r.setDragImage(l,d.x,d.y)}}try{null===r||void 0===r||r.setData("application/json",{})}catch(u){}s.setCurrentDragSourceNode(e.target),s.getCurrentSourcePreviewNodeOptions().captureDraggingState?s.actions.publishDragSource():setTimeout(function(){return s.actions.publishDragSource()},0)}else if(i)s.beginDragNativeItem(i);else{if(r&&!r.types&&(e.target&&!e.target.hasAttribute||!e.target.hasAttribute("draggable")))return;e.preventDefault()}}}),yt(this,"handleTopDragEndCapture",function(){s.clearCurrentDragSourceNode()&&s.monitor.isDragging()&&s.actions.endDrag()}),yt(this,"handleTopDragEnterCapture",function(e){if(s.dragEnterTargetIds=[],s.enterLeaveCounter.enter(e.target)&&!s.monitor.isDragging()){var t=e.dataTransfer,n=dt(t);n&&s.beginDragNativeItem(n,t)}}),yt(this,"handleTopDragEnter",function(e){var t=s.dragEnterTargetIds;(s.dragEnterTargetIds=[],s.monitor.isDragging())&&(s.altKeyPressed=e.altKey,t.length>0&&s.actions.hover(t,{clientOffset:Je(e)}),t.some(function(e){return s.monitor.canDropOnTarget(e)})&&(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=s.getCurrentDropEffect())))}),yt(this,"handleTopDragOverCapture",function(){s.dragOverTargetIds=[]}),yt(this,"handleTopDragOver",function(e){var t=s.dragOverTargetIds;if(s.dragOverTargetIds=[],!s.monitor.isDragging())return e.preventDefault(),void(e.dataTransfer&&(e.dataTransfer.dropEffect="none"));s.altKeyPressed=e.altKey,s.lastClientOffset=Je(e),null===s.hoverRafId&&"undefined"!==typeof requestAnimationFrame&&(s.hoverRafId=requestAnimationFrame(function(){s.monitor.isDragging()&&s.actions.hover(t||[],{clientOffset:s.lastClientOffset}),s.hoverRafId=null})),(t||[]).some(function(e){return s.monitor.canDropOnTarget(e)})?(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=s.getCurrentDropEffect())):s.isDraggingNativeItem()?e.preventDefault():(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="none"))}),yt(this,"handleTopDragLeaveCapture",function(e){s.isDraggingNativeItem()&&e.preventDefault(),s.enterLeaveCounter.leave(e.target)&&s.isDraggingNativeItem()&&setTimeout(function(){return s.endDragNativeItem()},0)}),yt(this,"handleTopDropCapture",function(e){var t;(s.dropTargetIds=[],s.isDraggingNativeItem())?(e.preventDefault(),null===(t=s.currentNativeSource)||void 0===t||t.loadDataTransfer(e.dataTransfer)):dt(e.dataTransfer)&&e.preventDefault();s.enterLeaveCounter.reset()}),yt(this,"handleTopDrop",function(e){var t=s.dropTargetIds;s.dropTargetIds=[],s.actions.hover(t,{clientOffset:Je(e)}),s.actions.drop({dropEffect:s.getCurrentDropEffect()}),s.isDraggingNativeItem()?s.endDragNativeItem():s.monitor.isDragging()&&s.actions.endDrag()}),yt(this,"handleSelectStart",function(e){var t=e.target;"function"===typeof t.dragDrop&&("INPUT"===t.tagName||"SELECT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable||(e.preventDefault(),t.dragDrop()))}),this.options=new pt(n,r),this.actions=t.getActions(),this.monitor=t.getMonitor(),this.registry=t.getRegistry(),this.enterLeaveCounter=new Ke(this.isNodeInDocument)}var t,n,s;return t=e,(n=[{key:"profile",value:function(){var e,t;return{sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,sourceNodeOptions:this.sourceNodeOptions.size,sourceNodes:this.sourceNodes.size,dragStartSourceIds:(null===(e=this.dragStartSourceIds)||void 0===e?void 0:e.length)||0,dropTargetIds:this.dropTargetIds.length,dragEnterTargetIds:this.dragEnterTargetIds.length,dragOverTargetIds:(null===(t=this.dragOverTargetIds)||void 0===t?void 0:t.length)||0}}},{key:"window",get:function(){return this.options.window}},{key:"document",get:function(){return this.options.document}},{key:"rootElement",get:function(){return this.options.rootElement}},{key:"setup",value:function(){var e=this.rootElement;if(void 0!==e){if(e.__isReactDndBackendSetUp)throw new Error("Cannot have two HTML5 backends at the same time.");e.__isReactDndBackendSetUp=!0,this.addEventListeners(e)}}},{key:"teardown",value:function(){var e,t=this.rootElement;void 0!==t&&(t.__isReactDndBackendSetUp=!1,this.removeEventListeners(this.rootElement),this.clearCurrentDragSourceNode(),this.asyncEndDragFrameId&&(null===(e=this.window)||void 0===e||e.cancelAnimationFrame(this.asyncEndDragFrameId)))}},{key:"connectDragPreview",value:function(e,t,n){var r=this;return this.sourcePreviewNodeOptions.set(e,n),this.sourcePreviewNodes.set(e,t),function(){r.sourcePreviewNodes.delete(e),r.sourcePreviewNodeOptions.delete(e)}}},{key:"connectDragSource",value:function(e,t,n){var r=this;this.sourceNodes.set(e,t),this.sourceNodeOptions.set(e,n);var s=function(t){return r.handleDragStart(t,e)},i=function(e){return r.handleSelectStart(e)};return t.setAttribute("draggable","true"),t.addEventListener("dragstart",s),t.addEventListener("selectstart",i),function(){r.sourceNodes.delete(e),r.sourceNodeOptions.delete(e),t.removeEventListener("dragstart",s),t.removeEventListener("selectstart",i),t.setAttribute("draggable","false")}}},{key:"connectDropTarget",value:function(e,t){var n=this,r=function(t){return n.handleDragEnter(t,e)},s=function(t){return n.handleDragOver(t,e)},i=function(t){return n.handleDrop(t,e)};return t.addEventListener("dragenter",r),t.addEventListener("dragover",s),t.addEventListener("drop",i),function(){t.removeEventListener("dragenter",r),t.removeEventListener("dragover",s),t.removeEventListener("drop",i)}}},{key:"addEventListeners",value:function(e){e.addEventListener&&(e.addEventListener("dragstart",this.handleTopDragStart),e.addEventListener("dragstart",this.handleTopDragStartCapture,!0),e.addEventListener("dragend",this.handleTopDragEndCapture,!0),e.addEventListener("dragenter",this.handleTopDragEnter),e.addEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.addEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.addEventListener("dragover",this.handleTopDragOver),e.addEventListener("dragover",this.handleTopDragOverCapture,!0),e.addEventListener("drop",this.handleTopDrop),e.addEventListener("drop",this.handleTopDropCapture,!0))}},{key:"removeEventListeners",value:function(e){e.removeEventListener&&(e.removeEventListener("dragstart",this.handleTopDragStart),e.removeEventListener("dragstart",this.handleTopDragStartCapture,!0),e.removeEventListener("dragend",this.handleTopDragEndCapture,!0),e.removeEventListener("dragenter",this.handleTopDragEnter),e.removeEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.removeEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.removeEventListener("dragover",this.handleTopDragOver),e.removeEventListener("dragover",this.handleTopDragOverCapture,!0),e.removeEventListener("drop",this.handleTopDrop),e.removeEventListener("drop",this.handleTopDropCapture,!0))}},{key:"getCurrentSourceNodeOptions",value:function(){var e=this.monitor.getSourceId(),t=this.sourceNodeOptions.get(e);return mt({dropEffect:this.altKeyPressed?"copy":"move"},t||{})}},{key:"getCurrentDropEffect",value:function(){return this.isDraggingNativeItem()?"copy":this.getCurrentSourceNodeOptions().dropEffect}},{key:"getCurrentSourcePreviewNodeOptions",value:function(){var e=this.monitor.getSourceId();return mt({anchorX:.5,anchorY:.5,captureDraggingState:!1},this.sourcePreviewNodeOptions.get(e)||{})}},{key:"isDraggingNativeItem",value:function(){var e=this.monitor.getItemType();return Object.keys(r).some(function(t){return r[t]===e})}},{key:"beginDragNativeItem",value:function(e,t){this.clearCurrentDragSourceNode(),this.currentNativeSource=function(e,t){var n=new ct(at[e]);return n.loadDataTransfer(t),n}(e,t),this.currentNativeHandle=this.registry.addSource(e,this.currentNativeSource),this.actions.beginDrag([this.currentNativeHandle])}},{key:"setCurrentDragSourceNode",value:function(e){var t=this;this.clearCurrentDragSourceNode(),this.currentDragSourceNode=e,this.mouseMoveTimeoutTimer=setTimeout(function(){var e;return null===(e=t.rootElement)||void 0===e?void 0:e.addEventListener("mousemove",t.endDragIfSourceWasRemovedFromDOM,!0)},1e3)}},{key:"clearCurrentDragSourceNode",value:function(){var e;return!!this.currentDragSourceNode&&(this.currentDragSourceNode=null,this.rootElement&&(null===(e=this.window)||void 0===e||e.clearTimeout(this.mouseMoveTimeoutTimer||void 0),this.rootElement.removeEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)),this.mouseMoveTimeoutTimer=null,!0)}},{key:"handleDragStart",value:function(e,t){e.defaultPrevented||(this.dragStartSourceIds||(this.dragStartSourceIds=[]),this.dragStartSourceIds.unshift(t))}},{key:"handleDragEnter",value:function(e,t){this.dragEnterTargetIds.unshift(t)}},{key:"handleDragOver",value:function(e,t){null===this.dragOverTargetIds&&(this.dragOverTargetIds=[]),this.dragOverTargetIds.unshift(t)}},{key:"handleDrop",value:function(e,t){this.dropTargetIds.unshift(t)}}])&&ft(t.prototype,n),s&&ft(t,s),e}(),kt=function(e,t,n){return new vt(e,t,n)},Tt=n(8253);const St=(e,t)=>({event:e,check:t});function bt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function It(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function Ct(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,Et(e,t,"get"))}function Dt(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,Et(e,t,"set"),n),n}function Et(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var Pt=new WeakMap;class wt{constructor(){It(this,Pt,{writable:!0,value:void 0}),bt(this,"register",e=>{Ct(this,Pt).push(e)}),bt(this,"unregister",e=>{let t;for(;-1!==(t=Ct(this,Pt).indexOf(e));)Ct(this,Pt).splice(t,1)}),bt(this,"backendChanged",e=>{for(const t of Ct(this,Pt))t.backendChanged(e)}),Dt(this,Pt,[])}}function xt(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function Ft(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function At(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,_t(e,t,"get"))}function Lt(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,_t(e,t,"set"),n),n}function _t(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var Ut=new WeakMap,Ot=new WeakMap,Bt=new WeakMap,Mt=new WeakMap,Nt=new WeakMap,Rt=new WeakMap,Gt=new WeakMap,Wt=new WeakMap,zt=new WeakMap,jt=new WeakMap,Kt=new WeakMap;class Ht{constructor(e,t,n){if(xt(this,Ut,{writable:!0,value:void 0}),xt(this,Ot,{writable:!0,value:void 0}),xt(this,Bt,{writable:!0,value:void 0}),xt(this,Mt,{writable:!0,value:void 0}),xt(this,Nt,{writable:!0,value:void 0}),xt(this,Rt,{writable:!0,value:(e,t,n)=>{var r,s;if(!n.backend)throw new Error("You must specify a 'backend' property in your Backend entry: ".concat(JSON.stringify(n)));const i=n.backend(e,t,n.options);let a=n.id;const o=!n.id&&i&&i.constructor;if(o&&(a=i.constructor.name),!a)throw new Error("You must specify an 'id' property in your Backend entry: ".concat(JSON.stringify(n),"\n        see this guide: https://github.com/louisbrunner/dnd-multi-backend/tree/master/packages/react-dnd-multi-backend#migrating-from-5xx"));if(o&&console.warn("Deprecation notice: You are using a pipeline which doesn't include backends' 'id'.\n        This might be unsupported in the future, please specify 'id' explicitely for every backend."),At(this,Bt)[a])throw new Error("You must specify a unique 'id' property in your Backend entry:\n        ".concat(JSON.stringify(n)," (conflicts with: ").concat(JSON.stringify(At(this,Bt)[a]),")"));return{id:a,instance:i,preview:null!==(r=n.preview)&&void 0!==r&&r,transition:n.transition,skipDispatchOnTransition:null!==(s=n.skipDispatchOnTransition)&&void 0!==s&&s}}}),Ft(this,"setup",()=>{if("undefined"!==typeof window){if(Ht.isSetUp)throw new Error("Cannot have two MultiBackends at the same time.");Ht.isSetUp=!0,At(this,Gt).call(this,window),At(this,Bt)[At(this,Ut)].instance.setup()}}),Ft(this,"teardown",()=>{"undefined"!==typeof window&&(Ht.isSetUp=!1,At(this,Wt).call(this,window),At(this,Bt)[At(this,Ut)].instance.teardown())}),Ft(this,"connectDragSource",(e,t,n)=>At(this,Kt).call(this,"connectDragSource",e,t,n)),Ft(this,"connectDragPreview",(e,t,n)=>At(this,Kt).call(this,"connectDragPreview",e,t,n)),Ft(this,"connectDropTarget",(e,t,n)=>At(this,Kt).call(this,"connectDropTarget",e,t,n)),Ft(this,"profile",()=>At(this,Bt)[At(this,Ut)].instance.profile()),Ft(this,"previewEnabled",()=>At(this,Bt)[At(this,Ut)].preview),Ft(this,"previewsList",()=>At(this,Ot)),Ft(this,"backendsList",()=>At(this,Mt)),xt(this,Gt,{writable:!0,value:e=>{At(this,Mt).forEach(t=>{t.transition&&e.addEventListener(t.transition.event,At(this,zt))})}}),xt(this,Wt,{writable:!0,value:e=>{At(this,Mt).forEach(t=>{t.transition&&e.removeEventListener(t.transition.event,At(this,zt))})}}),xt(this,zt,{writable:!0,value:e=>{const t=At(this,Ut);if(At(this,Mt).some(t=>!(t.id===At(this,Ut)||!t.transition||!t.transition.check(e))&&(Lt(this,Ut,t.id),!0)),At(this,Ut)!==t){var n;At(this,Bt)[t].instance.teardown(),Object.keys(At(this,Nt)).forEach(e=>{const t=At(this,Nt)[e];t.unsubscribe(),t.unsubscribe=At(this,jt).call(this,t.func,...t.args)}),At(this,Ot).backendChanged(this);const r=At(this,Bt)[At(this,Ut)];if(r.instance.setup(),r.skipDispatchOnTransition)return;const s=new(0,e.constructor)(e.type,e);null===(n=e.target)||void 0===n||n.dispatchEvent(s)}}}),xt(this,jt,{writable:!0,value:(e,t,n,r)=>At(this,Bt)[At(this,Ut)].instance[e](t,n,r)}),xt(this,Kt,{writable:!0,value:(e,t,n,r)=>{const s="".concat(e,"_").concat(t),i=At(this,jt).call(this,e,t,n,r);return At(this,Nt)[s]={func:e,args:[t,n,r],unsubscribe:i},()=>{At(this,Nt)[s].unsubscribe(),delete At(this,Nt)[s]}}}),!n||!n.backends||n.backends.length<1)throw new Error("You must specify at least one Backend, if you are coming from 2.x.x (or don't understand this error)\n        see this guide: https://github.com/louisbrunner/dnd-multi-backend/tree/master/packages/react-dnd-multi-backend#migrating-from-2xx");Lt(this,Ot,new wt),Lt(this,Bt,{}),Lt(this,Mt,[]),n.backends.forEach(n=>{const r=At(this,Rt).call(this,e,t,n);At(this,Bt)[r.id]=r,At(this,Mt).push(r)}),Lt(this,Ut,At(this,Mt)[0].id),Lt(this,Nt,{})}}Ft(Ht,"isSetUp",!1);const Vt=(e,t,n)=>new Ht(e,t,n);function Zt(e){let t=null;return()=>(null==t&&(t=e()),t)}class qt{enter(e){const t=this.entered.length;return this.entered=function(e,t){const n=new Set,r=e=>n.add(e);e.forEach(r),t.forEach(r);const s=[];return n.forEach(e=>s.push(e)),s}(this.entered.filter(t=>this.isNodeInDocument(t)&&(!t.contains||t.contains(e))),[e]),0===t&&this.entered.length>0}leave(e){const t=this.entered.length;var n,r;return this.entered=(n=this.entered.filter(this.isNodeInDocument),r=e,n.filter(e=>e!==r)),t>0&&0===this.entered.length}reset(){this.entered=[]}constructor(e){this.entered=[],this.isNodeInDocument=e}}const Yt=Zt(()=>/firefox/i.test(navigator.userAgent)),$t=Zt(()=>Boolean(window.safari));class Jt{interpolate(e){const{xs:t,ys:n,c1s:r,c2s:s,c3s:i}=this;let a=t.length-1;if(e===t[a])return n[a];let o,l=0,c=i.length-1;for(;l<=c;){o=Math.floor(.5*(l+c));const r=t[o];if(r<e)l=o+1;else{if(!(r>e))return n[o];c=o-1}}a=Math.max(0,c);const d=e-t[a],u=d*d;return n[a]+r[a]*d+s[a]*u+i[a]*d*u}constructor(e,t){const{length:n}=e,r=[];for(let p=0;p<n;p++)r.push(p);r.sort((t,n)=>e[t]<e[n]?-1:1);const s=[],i=[],a=[];let o,l;for(let p=0;p<n-1;p++)o=e[p+1]-e[p],l=t[p+1]-t[p],i.push(o),s.push(l),a.push(l/o);const c=[a[0]];for(let p=0;p<i.length-1;p++){const e=a[p],t=a[p+1];if(e*t<=0)c.push(0);else{o=i[p];const n=i[p+1],r=o+n;c.push(3*r/((r+n)/e+(r+o)/t))}}c.push(a[a.length-1]);const d=[],u=[];let h;for(let p=0;p<c.length-1;p++){h=a[p];const e=c[p],t=1/i[p],n=e+c[p+1]-h-h;d.push((h-e-n)*t),u.push(n*t*t)}this.xs=e,this.ys=t,this.c1s=c,this.c2s=d,this.c3s=u}}function Xt(e){const t=1===e.nodeType?e:e.parentElement;if(!t)return null;const{top:n,left:r}=t.getBoundingClientRect();return{x:r,y:n}}function Qt(e){return{x:e.clientX,y:e.clientY}}function en(e,t,n,r,s){const i=function(e){var t;return"IMG"===e.nodeName&&(Yt()||!(null===(t=document.documentElement)||void 0===t?void 0:t.contains(e)))}(t),a=Xt(i?e:t),o={x:n.x-a.x,y:n.y-a.y},{offsetWidth:l,offsetHeight:c}=e,{anchorX:d,anchorY:u}=r,{dragPreviewWidth:h,dragPreviewHeight:p}=function(e,t,n,r){let s=e?t.width:n,i=e?t.height:r;return $t()&&e&&(i/=window.devicePixelRatio,s/=window.devicePixelRatio),{dragPreviewWidth:s,dragPreviewHeight:i}}(i,t,l,c),{offsetX:g,offsetY:m}=s,f=0===m||m;return{x:0===g||g?g:new Jt([0,.5,1],[o.x,o.x/l*h,o.x+h-l]).interpolate(d),y:f?m:(()=>{let e=new Jt([0,.5,1],[o.y,o.y/c*p,o.y+p-c]).interpolate(u);return $t()&&i&&(e+=(window.devicePixelRatio-1)*p),e})()}}const tn="__NATIVE_FILE__",nn="__NATIVE_URL__",rn="__NATIVE_TEXT__",sn="__NATIVE_HTML__";function an(e,t,n){const r=t.reduce((t,n)=>t||e.getData(n),"");return null!=r?r:n}const on={[tn]:{exposeProperties:{files:e=>Array.prototype.slice.call(e.files),items:e=>e.items,dataTransfer:e=>e},matchesTypes:["Files"]},[sn]:{exposeProperties:{html:(e,t)=>an(e,t,""),dataTransfer:e=>e},matchesTypes:["Html","text/html"]},[nn]:{exposeProperties:{urls:(e,t)=>an(e,t,"").split("\n"),dataTransfer:e=>e},matchesTypes:["Url","text/uri-list"]},[rn]:{exposeProperties:{text:(e,t)=>an(e,t,""),dataTransfer:e=>e},matchesTypes:["Text","text/plain"]}};class ln{initializeExposedProperties(){Object.keys(this.config.exposeProperties).forEach(e=>{Object.defineProperty(this.item,e,{configurable:!0,enumerable:!0,get:()=>(console.warn(`Browser doesn't allow reading "${e}" until the drop event.`),null)})})}loadDataTransfer(e){if(e){const t={};Object.keys(this.config.exposeProperties).forEach(n=>{const r=this.config.exposeProperties[n];null!=r&&(t[n]={value:r(e,this.config.matchesTypes),configurable:!0,enumerable:!0})}),Object.defineProperties(this.item,t)}}canDrag(){return!0}beginDrag(){return this.item}isDragging(e,t){return t===e.getSourceId()}endDrag(){}constructor(e){this.config=e,this.item={},this.initializeExposedProperties()}}function cn(e){if(!e)return null;const t=Array.prototype.slice.call(e.types||[]);return Object.keys(on).filter(e=>{const n=on[e];return!!(null===n||void 0===n?void 0:n.matchesTypes)&&n.matchesTypes.some(e=>t.indexOf(e)>-1)})[0]||null}class dn{get window(){return this.globalContext?this.globalContext:"undefined"!==typeof window?window:void 0}get document(){var e;return(null===(e=this.globalContext)||void 0===e?void 0:e.document)?this.globalContext.document:this.window?this.window.document:void 0}get rootElement(){var e;return(null===(e=this.optionsArgs)||void 0===e?void 0:e.rootElement)||this.window}constructor(e,t){this.ownerDocument=null,this.globalContext=e,this.optionsArgs=t}}function un(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){un(e,t,n[t])})}return e}class pn{profile(){var e,t;return{sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,sourceNodeOptions:this.sourceNodeOptions.size,sourceNodes:this.sourceNodes.size,dragStartSourceIds:(null===(e=this.dragStartSourceIds)||void 0===e?void 0:e.length)||0,dropTargetIds:this.dropTargetIds.length,dragEnterTargetIds:this.dragEnterTargetIds.length,dragOverTargetIds:(null===(t=this.dragOverTargetIds)||void 0===t?void 0:t.length)||0}}get window(){return this.options.window}get document(){return this.options.document}get rootElement(){return this.options.rootElement}setup(){const e=this.rootElement;if(void 0!==e){if(e.__isReactDndBackendSetUp)throw new Error("Cannot have two HTML5 backends at the same time.");e.__isReactDndBackendSetUp=!0,this.addEventListeners(e)}}teardown(){const e=this.rootElement;var t;void 0!==e&&(e.__isReactDndBackendSetUp=!1,this.removeEventListeners(this.rootElement),this.clearCurrentDragSourceNode(),this.asyncEndDragFrameId&&(null===(t=this.window)||void 0===t||t.cancelAnimationFrame(this.asyncEndDragFrameId)))}connectDragPreview(e,t,n){return this.sourcePreviewNodeOptions.set(e,n),this.sourcePreviewNodes.set(e,t),()=>{this.sourcePreviewNodes.delete(e),this.sourcePreviewNodeOptions.delete(e)}}connectDragSource(e,t,n){this.sourceNodes.set(e,t),this.sourceNodeOptions.set(e,n);const r=t=>this.handleDragStart(t,e),s=e=>this.handleSelectStart(e);return t.setAttribute("draggable","true"),t.addEventListener("dragstart",r),t.addEventListener("selectstart",s),()=>{this.sourceNodes.delete(e),this.sourceNodeOptions.delete(e),t.removeEventListener("dragstart",r),t.removeEventListener("selectstart",s),t.setAttribute("draggable","false")}}connectDropTarget(e,t){const n=t=>this.handleDragEnter(t,e),r=t=>this.handleDragOver(t,e),s=t=>this.handleDrop(t,e);return t.addEventListener("dragenter",n),t.addEventListener("dragover",r),t.addEventListener("drop",s),()=>{t.removeEventListener("dragenter",n),t.removeEventListener("dragover",r),t.removeEventListener("drop",s)}}addEventListeners(e){e.addEventListener&&(e.addEventListener("dragstart",this.handleTopDragStart),e.addEventListener("dragstart",this.handleTopDragStartCapture,!0),e.addEventListener("dragend",this.handleTopDragEndCapture,!0),e.addEventListener("dragenter",this.handleTopDragEnter),e.addEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.addEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.addEventListener("dragover",this.handleTopDragOver),e.addEventListener("dragover",this.handleTopDragOverCapture,!0),e.addEventListener("drop",this.handleTopDrop),e.addEventListener("drop",this.handleTopDropCapture,!0))}removeEventListeners(e){e.removeEventListener&&(e.removeEventListener("dragstart",this.handleTopDragStart),e.removeEventListener("dragstart",this.handleTopDragStartCapture,!0),e.removeEventListener("dragend",this.handleTopDragEndCapture,!0),e.removeEventListener("dragenter",this.handleTopDragEnter),e.removeEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.removeEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.removeEventListener("dragover",this.handleTopDragOver),e.removeEventListener("dragover",this.handleTopDragOverCapture,!0),e.removeEventListener("drop",this.handleTopDrop),e.removeEventListener("drop",this.handleTopDropCapture,!0))}getCurrentSourceNodeOptions(){const e=this.monitor.getSourceId(),t=this.sourceNodeOptions.get(e);return hn({dropEffect:this.altKeyPressed?"copy":"move"},t||{})}getCurrentDropEffect(){return this.isDraggingNativeItem()?"copy":this.getCurrentSourceNodeOptions().dropEffect}getCurrentSourcePreviewNodeOptions(){const e=this.monitor.getSourceId();return hn({anchorX:.5,anchorY:.5,captureDraggingState:!1},this.sourcePreviewNodeOptions.get(e)||{})}isDraggingNativeItem(){const e=this.monitor.getItemType();return Object.keys(s).some(t=>s[t]===e)}beginDragNativeItem(e,t){this.clearCurrentDragSourceNode(),this.currentNativeSource=function(e,t){const n=on[e];if(!n)throw new Error(`native type ${e} has no configuration`);const r=new ln(n);return r.loadDataTransfer(t),r}(e,t),this.currentNativeHandle=this.registry.addSource(e,this.currentNativeSource),this.actions.beginDrag([this.currentNativeHandle])}setCurrentDragSourceNode(e){this.clearCurrentDragSourceNode(),this.currentDragSourceNode=e;this.mouseMoveTimeoutTimer=setTimeout(()=>{var e;return null===(e=this.rootElement)||void 0===e?void 0:e.addEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)},1e3)}clearCurrentDragSourceNode(){if(this.currentDragSourceNode){var e;if(this.currentDragSourceNode=null,this.rootElement)null===(e=this.window)||void 0===e||e.clearTimeout(this.mouseMoveTimeoutTimer||void 0),this.rootElement.removeEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0);return this.mouseMoveTimeoutTimer=null,!0}return!1}handleDragStart(e,t){e.defaultPrevented||(this.dragStartSourceIds||(this.dragStartSourceIds=[]),this.dragStartSourceIds.unshift(t))}handleDragEnter(e,t){this.dragEnterTargetIds.unshift(t)}handleDragOver(e,t){null===this.dragOverTargetIds&&(this.dragOverTargetIds=[]),this.dragOverTargetIds.unshift(t)}handleDrop(e,t){this.dropTargetIds.unshift(t)}constructor(e,t,n){this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.sourceNodes=new Map,this.sourceNodeOptions=new Map,this.dragStartSourceIds=null,this.dropTargetIds=[],this.dragEnterTargetIds=[],this.currentNativeSource=null,this.currentNativeHandle=null,this.currentDragSourceNode=null,this.altKeyPressed=!1,this.mouseMoveTimeoutTimer=null,this.asyncEndDragFrameId=null,this.dragOverTargetIds=null,this.lastClientOffset=null,this.hoverRafId=null,this.getSourceClientOffset=e=>{const t=this.sourceNodes.get(e);return t&&Xt(t)||null},this.endDragNativeItem=()=>{this.isDraggingNativeItem()&&(this.actions.endDrag(),this.currentNativeHandle&&this.registry.removeSource(this.currentNativeHandle),this.currentNativeHandle=null,this.currentNativeSource=null)},this.isNodeInDocument=e=>Boolean(e&&this.document&&this.document.body&&this.document.body.contains(e)),this.endDragIfSourceWasRemovedFromDOM=()=>{const e=this.currentDragSourceNode;null==e||this.isNodeInDocument(e)||this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag()},this.handleTopDragStartCapture=()=>{this.clearCurrentDragSourceNode(),this.dragStartSourceIds=[]},this.handleTopDragStart=e=>{if(e.defaultPrevented)return;const{dragStartSourceIds:t}=this;this.dragStartSourceIds=null;const n=Qt(e);this.monitor.isDragging()&&this.actions.endDrag(),this.actions.beginDrag(t||[],{publishSource:!1,getSourceClientOffset:this.getSourceClientOffset,clientOffset:n});const{dataTransfer:r}=e,s=cn(r);if(this.monitor.isDragging()){if(r&&"function"===typeof r.setDragImage){const e=this.monitor.getSourceId(),t=this.sourceNodes.get(e),s=this.sourcePreviewNodes.get(e)||t;if(s){const{anchorX:e,anchorY:i,offsetX:a,offsetY:o}=this.getCurrentSourcePreviewNodeOptions(),l=en(t,s,n,{anchorX:e,anchorY:i},{offsetX:a,offsetY:o});r.setDragImage(s,l.x,l.y)}}try{null===r||void 0===r||r.setData("application/json",{})}catch(i){}this.setCurrentDragSourceNode(e.target);const{captureDraggingState:t}=this.getCurrentSourcePreviewNodeOptions();t?this.actions.publishDragSource():setTimeout(()=>this.actions.publishDragSource(),0)}else if(s)this.beginDragNativeItem(s);else{if(r&&!r.types&&(e.target&&!e.target.hasAttribute||!e.target.hasAttribute("draggable")))return;e.preventDefault()}},this.handleTopDragEndCapture=()=>{this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag()},this.handleTopDragEnterCapture=e=>{var t;(this.dragEnterTargetIds=[],this.isDraggingNativeItem())&&(null===(t=this.currentNativeSource)||void 0===t||t.loadDataTransfer(e.dataTransfer));if(!this.enterLeaveCounter.enter(e.target)||this.monitor.isDragging())return;const{dataTransfer:n}=e,r=cn(n);r&&this.beginDragNativeItem(r,n)},this.handleTopDragEnter=e=>{const{dragEnterTargetIds:t}=this;if(this.dragEnterTargetIds=[],!this.monitor.isDragging())return;this.altKeyPressed=e.altKey,t.length>0&&this.actions.hover(t,{clientOffset:Qt(e)});t.some(e=>this.monitor.canDropOnTarget(e))&&(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=this.getCurrentDropEffect()))},this.handleTopDragOverCapture=e=>{var t;(this.dragOverTargetIds=[],this.isDraggingNativeItem())&&(null===(t=this.currentNativeSource)||void 0===t||t.loadDataTransfer(e.dataTransfer))},this.handleTopDragOver=e=>{const{dragOverTargetIds:t}=this;if(this.dragOverTargetIds=[],!this.monitor.isDragging())return e.preventDefault(),void(e.dataTransfer&&(e.dataTransfer.dropEffect="none"));this.altKeyPressed=e.altKey,this.lastClientOffset=Qt(e),null===this.hoverRafId&&"undefined"!==typeof requestAnimationFrame&&(this.hoverRafId=requestAnimationFrame(()=>{this.monitor.isDragging()&&this.actions.hover(t||[],{clientOffset:this.lastClientOffset}),this.hoverRafId=null}));(t||[]).some(e=>this.monitor.canDropOnTarget(e))?(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=this.getCurrentDropEffect())):this.isDraggingNativeItem()?e.preventDefault():(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="none"))},this.handleTopDragLeaveCapture=e=>{this.isDraggingNativeItem()&&e.preventDefault();this.enterLeaveCounter.leave(e.target)&&this.isDraggingNativeItem()&&setTimeout(()=>this.endDragNativeItem(),0)},this.handleTopDropCapture=e=>{var t;(this.dropTargetIds=[],this.isDraggingNativeItem())?(e.preventDefault(),null===(t=this.currentNativeSource)||void 0===t||t.loadDataTransfer(e.dataTransfer)):cn(e.dataTransfer)&&e.preventDefault();this.enterLeaveCounter.reset()},this.handleTopDrop=e=>{const{dropTargetIds:t}=this;this.dropTargetIds=[],this.actions.hover(t,{clientOffset:Qt(e)}),this.actions.drop({dropEffect:this.getCurrentDropEffect()}),this.isDraggingNativeItem()?this.endDragNativeItem():this.monitor.isDragging()&&this.actions.endDrag()},this.handleSelectStart=e=>{const t=e.target;"function"===typeof t.dragDrop&&("INPUT"===t.tagName||"SELECT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable||(e.preventDefault(),t.dragDrop()))},this.options=new dn(t,n),this.actions=e.getActions(),this.monitor=e.getMonitor(),this.registry=e.getRegistry(),this.enterLeaveCounter=new qt(this.isNodeInDocument)}}function gn(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),s=2;s<n;s++)r[s-2]=arguments[s];if("undefined"!==typeof process&&void 0===t)throw new Error("invariant requires an error message argument");if(!e){let e;if(void 0===t)e=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{let n=0;e=new Error(t.replace(/%s/g,function(){return r[n++]})),e.name="Invariant Violation"}throw e.framesToPop=1,e}}var mn;!function(e){e.mouse="mouse",e.touch="touch",e.keyboard="keyboard"}(mn||(mn={}));const fn=1,yn=0;function vn(e){return void 0===e.button||e.button===yn}function kn(e){return!!e.targetTouches}function Tn(e,t){return kn(e)?function(e,t){return 1===e.targetTouches.length?Tn(e.targetTouches[0]):t&&1===e.touches.length&&e.touches[0].target===t.target?Tn(e.touches[0]):void 0}(e,t):{x:e.clientX,y:e.clientY}}const Sn=(()=>{let e=!1;try{addEventListener("test",()=>{},Object.defineProperty({},"passive",{get:()=>(e=!0,!0)}))}catch(t){}return e})();class bn{get delay(){var e;return null!==(e=this.args.delay)&&void 0!==e?e:0}get scrollAngleRanges(){return this.args.scrollAngleRanges}get getDropTargetElementsAtPoint(){return this.args.getDropTargetElementsAtPoint}get ignoreContextMenu(){var e;return null!==(e=this.args.ignoreContextMenu)&&void 0!==e&&e}get enableHoverOutsideTarget(){var e;return null!==(e=this.args.enableHoverOutsideTarget)&&void 0!==e&&e}get enableKeyboardEvents(){var e;return null!==(e=this.args.enableKeyboardEvents)&&void 0!==e&&e}get enableMouseEvents(){var e;return null!==(e=this.args.enableMouseEvents)&&void 0!==e&&e}get enableTouchEvents(){var e;return null===(e=this.args.enableTouchEvents)||void 0===e||e}get touchSlop(){return this.args.touchSlop||0}get delayTouchStart(){var e,t,n,r;return null!==(r=null!==(n=null===(e=this.args)||void 0===e?void 0:e.delayTouchStart)&&void 0!==n?n:null===(t=this.args)||void 0===t?void 0:t.delay)&&void 0!==r?r:0}get delayMouseStart(){var e,t,n,r;return null!==(r=null!==(n=null===(e=this.args)||void 0===e?void 0:e.delayMouseStart)&&void 0!==n?n:null===(t=this.args)||void 0===t?void 0:t.delay)&&void 0!==r?r:0}get window(){return this.context&&this.context.window?this.context.window:"undefined"!==typeof window?window:void 0}get document(){var e;return(null===(e=this.context)||void 0===e?void 0:e.document)?this.context.document:this.window?this.window.document:void 0}get rootElement(){var e;return(null===(e=this.args)||void 0===e?void 0:e.rootElement)||this.document}constructor(e,t){this.args=e,this.context=t}}const In={[mn.mouse]:{start:"mousedown",move:"mousemove",end:"mouseup",contextmenu:"contextmenu"},[mn.touch]:{start:"touchstart",move:"touchmove",end:"touchend"},[mn.keyboard]:{keydown:"keydown"}};class Cn{profile(){var e;return{sourceNodes:this.sourceNodes.size,sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,targetNodes:this.targetNodes.size,dragOverTargetIds:(null===(e=this.dragOverTargetIds)||void 0===e?void 0:e.length)||0}}get document(){return this.options.document}setup(){const e=this.options.rootElement;e&&(gn(!Cn.isSetUp,"Cannot have two Touch backends at the same time."),Cn.isSetUp=!0,this.addEventListener(e,"start",this.getTopMoveStartHandler()),this.addEventListener(e,"start",this.handleTopMoveStartCapture,!0),this.addEventListener(e,"move",this.handleTopMove),this.addEventListener(e,"move",this.handleTopMoveCapture,!0),this.addEventListener(e,"end",this.handleTopMoveEndCapture,!0),this.options.enableMouseEvents&&!this.options.ignoreContextMenu&&this.addEventListener(e,"contextmenu",this.handleTopMoveEndCapture),this.options.enableKeyboardEvents&&this.addEventListener(e,"keydown",this.handleCancelOnEscape,!0))}teardown(){const e=this.options.rootElement;e&&(Cn.isSetUp=!1,this._mouseClientOffset={},this.removeEventListener(e,"start",this.handleTopMoveStartCapture,!0),this.removeEventListener(e,"start",this.handleTopMoveStart),this.removeEventListener(e,"move",this.handleTopMoveCapture,!0),this.removeEventListener(e,"move",this.handleTopMove),this.removeEventListener(e,"end",this.handleTopMoveEndCapture,!0),this.options.enableMouseEvents&&!this.options.ignoreContextMenu&&this.removeEventListener(e,"contextmenu",this.handleTopMoveEndCapture),this.options.enableKeyboardEvents&&this.removeEventListener(e,"keydown",this.handleCancelOnEscape,!0),this.uninstallSourceNodeRemovalObserver())}addEventListener(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=Sn?{capture:r,passive:!1}:r;this.listenerTypes.forEach(function(r){const i=In[r][t];i&&e.addEventListener(i,n,s)})}removeEventListener(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=Sn?{capture:r,passive:!1}:r;this.listenerTypes.forEach(function(r){const i=In[r][t];i&&e.removeEventListener(i,n,s)})}connectDragSource(e,t){const n=this.handleMoveStart.bind(this,e);return this.sourceNodes.set(e,t),this.addEventListener(t,"start",n),()=>{this.sourceNodes.delete(e),this.removeEventListener(t,"start",n)}}connectDragPreview(e,t,n){return this.sourcePreviewNodeOptions.set(e,n),this.sourcePreviewNodes.set(e,t),()=>{this.sourcePreviewNodes.delete(e),this.sourcePreviewNodeOptions.delete(e)}}connectDropTarget(e,t){const n=this.options.rootElement;if(!this.document||!n)return()=>{};const r=r=>{if(!this.document||!n||!this.monitor.isDragging())return;let s;switch(r.type){case In.mouse.move:s={x:r.clientX,y:r.clientY};break;case In.touch.move:var i,a;s={x:(null===(i=r.touches[0])||void 0===i?void 0:i.clientX)||0,y:(null===(a=r.touches[0])||void 0===a?void 0:a.clientY)||0}}const o=null!=s?this.document.elementFromPoint(s.x,s.y):void 0,l=o&&t.contains(o);return o===t||l?this.handleMove(r,e):void 0};return this.addEventListener(this.document.body,"move",r),this.targetNodes.set(e,t),()=>{this.document&&(this.targetNodes.delete(e),this.removeEventListener(this.document.body,"move",r))}}getTopMoveStartHandler(){return this.options.delayTouchStart||this.options.delayMouseStart?this.handleTopMoveStartDelay:this.handleTopMoveStart}installSourceNodeRemovalObserver(e){this.uninstallSourceNodeRemovalObserver(),this.draggedSourceNode=e,this.draggedSourceNodeRemovalObserver=new MutationObserver(()=>{e&&!e.parentElement&&(this.resurrectSourceNode(),this.uninstallSourceNodeRemovalObserver())}),e&&e.parentElement&&this.draggedSourceNodeRemovalObserver.observe(e.parentElement,{childList:!0})}resurrectSourceNode(){this.document&&this.draggedSourceNode&&(this.draggedSourceNode.style.display="none",this.draggedSourceNode.removeAttribute("data-reactid"),this.document.body.appendChild(this.draggedSourceNode))}uninstallSourceNodeRemovalObserver(){this.draggedSourceNodeRemovalObserver&&this.draggedSourceNodeRemovalObserver.disconnect(),this.draggedSourceNodeRemovalObserver=void 0,this.draggedSourceNode=void 0}constructor(e,t,n){this.getSourceClientOffset=e=>{const t=this.sourceNodes.get(e);return t&&function(e){const t=1===e.nodeType?e:e.parentElement;if(!t)return;const{top:n,left:r}=t.getBoundingClientRect();return{x:r,y:n}}(t)},this.handleTopMoveStartCapture=e=>{vn(e)&&(this.moveStartSourceIds=[])},this.handleMoveStart=e=>{Array.isArray(this.moveStartSourceIds)&&this.moveStartSourceIds.unshift(e)},this.handleTopMoveStart=e=>{if(!vn(e))return;const t=Tn(e);t&&(kn(e)&&(this.lastTargetTouchFallback=e.targetTouches[0]),this._mouseClientOffset=t),this.waitingForDelay=!1},this.handleTopMoveStartDelay=e=>{if(!vn(e))return;const t=e.type===In.touch.start?this.options.delayTouchStart:this.options.delayMouseStart;this.timeout=setTimeout(this.handleTopMoveStart.bind(this,e),t),this.waitingForDelay=!0},this.handleTopMoveCapture=()=>{this.dragOverTargetIds=[]},this.handleMove=(e,t)=>{this.dragOverTargetIds&&this.dragOverTargetIds.unshift(t)},this.handleTopMove=e=>{if(this.timeout&&clearTimeout(this.timeout),!this.document||this.waitingForDelay)return;const{moveStartSourceIds:t,dragOverTargetIds:n}=this,r=this.options.enableHoverOutsideTarget,s=Tn(e,this.lastTargetTouchFallback);if(!s)return;if(this._isScrolling||!this.monitor.isDragging()&&function(e,t,n,r,s){if(!s)return!1;const i=180*Math.atan2(r-t,n-e)/Math.PI+180;for(let a=0;a<s.length;++a){const e=s[a];if(e&&(null==e.start||i>=e.start)&&(null==e.end||i<=e.end))return!0}return!1}(this._mouseClientOffset.x||0,this._mouseClientOffset.y||0,s.x,s.y,this.options.scrollAngleRanges))return void(this._isScrolling=!0);var i,a,o,l;if(!this.monitor.isDragging()&&this._mouseClientOffset.hasOwnProperty("x")&&t&&(i=this._mouseClientOffset.x||0,a=this._mouseClientOffset.y||0,o=s.x,l=s.y,Math.sqrt(Math.pow(Math.abs(o-i),2)+Math.pow(Math.abs(l-a),2))>(this.options.touchSlop?this.options.touchSlop:0))&&(this.moveStartSourceIds=void 0,this.actions.beginDrag(t,{clientOffset:this._mouseClientOffset,getSourceClientOffset:this.getSourceClientOffset,publishSource:!1})),!this.monitor.isDragging())return;const c=this.sourceNodes.get(this.monitor.getSourceId());this.installSourceNodeRemovalObserver(c),this.actions.publishDragSource(),e.cancelable&&e.preventDefault();const d=(n||[]).map(e=>this.targetNodes.get(e)).filter(e=>!!e),u=this.options.getDropTargetElementsAtPoint?this.options.getDropTargetElementsAtPoint(s.x,s.y,d):this.document.elementsFromPoint(s.x,s.y),h=[];for(const g in u){if(!u.hasOwnProperty(g))continue;let e=u[g];for(null!=e&&h.push(e);e;)e=e.parentElement,e&&-1===h.indexOf(e)&&h.push(e)}const p=h.filter(e=>d.indexOf(e)>-1).map(e=>this._getDropTargetId(e)).filter(e=>!!e).filter((e,t,n)=>n.indexOf(e)===t);if(r)for(const g in this.targetNodes){const e=this.targetNodes.get(g);if(c&&e&&e.contains(c)&&-1===p.indexOf(g)){p.unshift(g);break}}p.reverse(),this.actions.hover(p,{clientOffset:s})},this._getDropTargetId=e=>{const t=this.targetNodes.keys();let n=t.next();for(;!1===n.done;){const r=n.value;if(e===this.targetNodes.get(r))return r;n=t.next()}},this.handleTopMoveEndCapture=e=>{this._isScrolling=!1,this.lastTargetTouchFallback=void 0,function(e){return void 0===e.buttons||0===(e.buttons&fn)}(e)&&(this.monitor.isDragging()&&!this.monitor.didDrop()?(e.cancelable&&e.preventDefault(),this._mouseClientOffset={},this.uninstallSourceNodeRemovalObserver(),this.actions.drop(),this.actions.endDrag()):this.moveStartSourceIds=void 0)},this.handleCancelOnEscape=e=>{"Escape"===e.key&&this.monitor.isDragging()&&(this._mouseClientOffset={},this.uninstallSourceNodeRemovalObserver(),this.actions.endDrag())},this.options=new bn(n,t),this.actions=e.getActions(),this.monitor=e.getMonitor(),this.sourceNodes=new Map,this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.targetNodes=new Map,this.listenerTypes=[],this._mouseClientOffset={},this._isScrolling=!1,this.options.enableMouseEvents&&this.listenerTypes.push(mn.mouse),this.options.enableTouchEvents&&this.listenerTypes.push(mn.touch),this.options.enableKeyboardEvents&&this.listenerTypes.push(mn.keyboard)}}const Dn=St("touchstart",e=>{const t=e;return null!==t.touches&&void 0!==t.touches}),En=(St("dragstart",e=>-1!==e.type.indexOf("drag")||-1!==e.type.indexOf("drop")),St("mousedown",e=>-1===e.type.indexOf("touch")&&-1!==e.type.indexOf("mouse")),{backends:[{id:"html5",backend:function(e,t,n){return new pn(e,t,n)},transition:St("pointerdown",e=>"mouse"==e.pointerType)},{id:"touch",backend:function(e){return new Cn(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})},options:{enableMouseEvents:!0},preview:!0,transition:Dn}]});var Pn=n(66783),wn=n(52195);const xn=(0,Pn.J9)(()=>(0,wn.Zq)("dndRoot",{height:"100%"}));let Fn;function An(e){return class extends i.Component{componentDidMount(){if(this.dndRootElementRef.current){(e=this.dndRootElementRef.current,e.parentElement?.closest(".dndRoot")??null)?this.setState({isSubDnDRootElement:!0}):this.setState({loopDndBackendOptions:{rootElement:this.dndRootElementRef.current}})}var e}render(){if(a.B.clientType===o.s.Loop||a.B.clientType===o.s.SharepointApp||a.B.clientType===o.s.Webpart){const{isSubDnDRootElement:t,loopDndBackendOptions:n}=this.state;return i.createElement("div",{className:xn(),ref:this.dndRootElementRef},t?i.createElement(e,{...this.props,ref:(0,Tt.Yy)(e)?this.ref:null}):n&&i.createElement(Re,{backend:kt,context:this.dndContext,options:n},i.createElement(e,{...this.props,ref:(0,Tt.Yy)(e)?this.ref:null})))}return i.createElement(Re,{backend:Vt,options:(Fn||(Fn=En,Fn.backends[0].transition=St("mousedown",e=>!(!e.type||-1!==e.type.indexOf("touch")||-1===e.type.indexOf("mouse"))&&(a.B.DndBackend="Html5",!0)),Fn.backends[1].transition=St("touchstart",e=>null!=e.touches&&(a.B.DndBackend="Touch",!0))),Fn)},i.createElement(e,{...this.props,ref:(0,Tt.Yy)(e)?this.ref:null}))}constructor(e){super(e),this.dndContext={clearTimeout:e=>window.clearTimeout(e)},this.ref=i.createRef(),this.dndRootElementRef=i.createRef(),this.state={}}}}},49602:(e,t,n)=>{"use strict";n.d(t,{W:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{groupId:this.groupId}}constructor(e,t,n){super(s.actionType),this.groupId=e,this.folderId=t,this.driveItems=n}}s.actionType="PLW_GET_GROUPDOCUMENTSINFOLDER_SUCCEEDED"},49634:(e,t,n)=>{"use strict";n.d(t,{D:()=>o});var r=n(65043),s=n(79969),i=n(22751),a=n(4398);var o=function(){var e=r.useContext(a.D),t=(0,s.m)(["theme"]).theme;return e||t||(0,i.a)({})}},49874:(e,t,n)=>{var r=n(53871),s=n(99140);e.exports=function(e,t,n){return e&&e.length?(t=n||void 0===t?1:s(t),r(e,0,t<0?0:t)):[]}},50046:(e,t,n)=>{var r=n(76272);e.exports=function(e){return r(e)?e:[]}},51676:(e,t,n)=>{"use strict";n.d(t,{z:()=>s});var r=n(32512);class s extends r.v{constructor(e,t,n,r,i){super(s.actionType,n,r,i),this.groupId=e,this.itemUrl=t}}s.actionType="PLW_GET_DRIVE_ITEM_THUMBNAIL_FAILED"},51710:(e,t,n)=>{"use strict";n.d(t,{H:()=>s});var r=n(75992);class s extends r.r{constructor(e){super(s.actionType),this.planId=e}}s.actionType="PLW_DELETE_PLAN"},51948:(e,t,n)=>{"use strict";var r;n.d(t,{F:()=>r}),function(e){e.Accept="Accept",e.AddEvent="AddEvent",e.AddFriend="AddFriend",e.Attach="Attach",e.Blocked="Blocked",e.Camera="Camera",e.Cancel="Cancel",e.Check="CheckMark",e.ChevronDownMed="ChevronDownMed",e.ChevronDownSmall="ChevronDownSmall",e.ChevronLeftMed="ChevronLeftMed",e.ChevronLeftSmall="ChevronLeftSmall",e.ChevronRightMed="ChevronRightMed",e.ChevronRightSmall="ChevronRightSmall",e.ChevronUpMed="ChevronUpMed",e.ChevronUpSmall="ChevronUpSmall",e.ChromeClose="ChromeClose",e.Clear="Clear",e.ClearFilter="ClearFilter",e.Completed="Completed",e.Copy="Copy",e.Cut="Cut",e.DateTime2="DateTime2",e.Delete="Trash",e.Document="Document",e.Down="Down",e.Diamond="Diamond",e.Edit="Edit",e.Emoji2="Emoji2",e.Error="Error",e.ErrorBadge="ErrorBadge",e.ExcelLogo="ExcelLogo",e.FabricOpenFolderHorizontal="FabricOpenFolderHorizontal",e.FavoriteStar="FavoriteStar",e.Filter="Filter",e.Folder="FabricFolder",e.Group="Group",e.Important="Important",e.Indent="IncreaseIndentLegacy",e.Info="Info",e.InsertRowsAbove="InsertRowsAbove",e.Link="Link",e.LocationDot="LocationDot",e.OneNoteLogo="OneNoteLogo",e.OpenPane="OpenPane",e.OpenPaneMirrored="OpenPaneMirrored",e.Outdent="DecreaseIndentLegacy",e.PaddingLeft="PaddingLeft",e.PaddingRight="PaddingRight",e.Paste="Paste",e.PDF="pdf",e.People="People",e.PeopleAdd="PeopleAdd",e.Photo="Photo2",e.PlugConnected="PlugConnected",e.Plus="Add",e.PowerPointLogo="PowerPointLogo",e.ProgressLoopOuter="ProgressLoopOuter",e.ProjectLogo="ProjectLogo32",e.PublicCalendar="PublicCalendar",e.Refresh="Refresh",e.Remove="Remove",e.RemoveLink="RemoveLink",e.Rename="Rename",e.ReplyMirrored="ReplyMirrored",e.RevToggleKey="RevToggleKey",e.Ringer="Ringer",e.RingerSolid="RingerSolid",e.Search="Search",e.SeeAll="ShowResults",e.Settings="Settings",e.SharepointLogo="SharepointLogo",e.StatusCircleBlock2="StatusCircleBlock2",e.StatusCircleCheckmark="StatusCircleCheckmark",e.StatusCircleExclamation="StatusCircleExclamation",e.TimelineProgress="TimelineProgress",e.Unfavorite="Unfavorite",e.Up="Up",e.VisioLogo="VisioLogo",e.Warning="Warning",e.WordLogo="WordLogo",e.ZoomIn="ZoomIn",e.ZoomOut="ZoomOut"}(r||(r={}))},53211:(e,t,n)=>{"use strict";n.d(t,{Q:()=>s});var r=n(75992);class s extends r.r{constructor(e){super(s.actionType),this.planId=e}}s.actionType="PLW_FETCH_PLAN"},53443:(e,t,n)=>{"use strict";var r;n.d(t,{U:()=>r}),function(e){e[e.Insert=0]="Insert",e[e.Delete=1]="Delete",e[e.Update=2]="Update",e[e.Purge=3]="Purge",e[e.Undelete=4]="Undelete"}(r||(r={}))},53672:(e,t,n)=>{"use strict";n.d(t,{n:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{toastId:this.toastId}}constructor(e){super(s.actionType),this.toastId=e}}s.actionType="DISMISS_TOAST_NOTIFICATION"},53734:(e,t,n)=>{"use strict";n.d(t,{g:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{id:this.bucket.id}}constructor(e){super(s.actionType),this.bucket=e}}s.actionType="PLW_GET_BUCKET_SUCCEEDED"},54205:(e,t,n)=>{"use strict";n.d(t,{O:()=>s});var r=n(75992);class s extends r.r{constructor(e){super(s.actionType),this.planEntitySet=e}}s.actionType="PLW_CREATE_PLAN"},54456:(e,t,n)=>{"use strict";n.d(t,{v:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{vroomId:this.vroomId}}constructor(e,t){super(s.actionType),this.vroomId=e,this.driveItem=t}}s.actionType="PLW_GET_DRIVE_ITEM_SUCCEEDED"},55637:(e,t,n)=>{"use strict";n.d(t,{G:()=>s});var r=n(75992);class s extends r.r{constructor(e){super(s.actionType),this.container=e}}s.actionType="PLW_UPDATE_CONTAINER_SUCCESS"},55694:(e,t,n)=>{"use strict";n.d(t,{p:()=>a});var r=n(75992),s=n(78332),i=n(62687);class a extends r.r{loggingData(){return{accessContext:String(i.t[this.accessContext]),taskGrouping:String(s.Yc[this.taskGrouping]),currentPage:this.currentPage}}constructor(e,t,n){super(a.actionType),this.accessContext=e,this.taskGrouping=t,this.currentPage=n}}a.actionType="SET_TASK_GROUPING"},56956:(e,t,n)=>{var r=n(38541),s=n(28189),i=n(76372),a=n(39115),o=n(41069),l=n(10143);e.exports=function(e,t,n){if((e=o(e))&&(n||void 0===t))return e.slice(0,l(e)+1);if(!e||!(t=r(t)))return e;var c=a(e),d=i(c,a(t))+1;return s(c,0,d).join("")}},58355:(e,t,n)=>{"use strict";n.d(t,{D:()=>a});var r=n(75992),s=n(86178),i=n.n(s);class a extends r.r{loggingData(){let e=0;for(const t of this.permissionsSets)t.expiry.isBefore(i()())&&e++;return{numPermissionsFetched:this.permissionsSets.length.toString(),numExpiredPermissionsFetched:e.toString()}}constructor(e){if(super(a.actionType),this.permissionsSets=e,this.permissionsSets.length<1)throw new Error("Permissions set has less than 1 entry")}}a.actionType="PLW_BATCH_GET_CONTAINER_PERMISSIONS_SUCCEEDED"},59640:(e,t,n)=>{"use strict";n.d(t,{N:()=>s});var r=n(75992);class s extends r.r{constructor(e,t){super(s.actionType),this.entityId=e,this.seen=t}}s.actionType="AUGLOOP_FILE_SUG_SEEN"},60878:(e,t,n)=>{"use strict";n.d(t,{L:()=>s});var r=n(75992);class s extends r.r{constructor(e){super(s.actionType),this.container=e}}s.actionType="PLW_GET_CONTAINER_SUCCESS"},61460:(e,t,n)=>{var r=n(50149),s=n(8820),i=n(55647),a=n(50046),o=i(function(e){var t=r(e,a);return t.length&&t[0]===e[0]?s(t):[]});e.exports=o},61804:(e,t,n)=>{"use strict";n.d(t,{M:()=>r});var r=(0,n(65043).createContext)({dragDropManager:void 0})},62076:(e,t,n)=>{"use strict";n.d(t,{V:()=>s});var r=n(32512);class s extends r.v{constructor(e,t,n,r){super(s.actionType,t,n,r),this.planEntitySet=e}}s.actionType="PLW_CREATE_PLAN_FAILED"},63148:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(75992);class s extends r.r{constructor(e,t){super(s.actionType),this.planId=e,this.planMoveData=t}}s.actionType="PLW_MOVE_PLAN_STATUS_UPDATE"},65006:(e,t,n)=>{"use strict";n.d(t,{Lx:()=>i,cJ:()=>a});var r=n(97002),s=n(66151);const i={"h1, h2, h3, h4, h5, h6":{margin:"0",fontWeight:"normal",display:"inline"},ul:{margin:"0",padding:"0"},li:{listStyleType:"none"}},a=e=>(0,r.Z)({":global(.plannerApp, .teamsApp, .sharepointApp, .webpartApp, .noAccessErrorPage, .plannerAppDialog, .plannerAppCallout)":{a:[(0,s.BP)(e)]},":global(::-webkit-scrollbar-thumb)":[(0,s.IB)(e),{borderRadius:s.XR}]})},65060:(e,t,n)=>{"use strict";n.d(t,{d:()=>s});var r=n(32512);class s extends r.v{constructor(e,t,n,r,i,a){super(s.actionType,r,i,a),this.groupId=e,this.threadId=t,this.newPost=n}}s.actionType="PLW_POSTREPLY_CONVERSATIONTHREAD_FAILED"},65172:(e,t,n)=>{"use strict";n.d(t,{f:()=>s});var r=n(32512);class s extends r.v{constructor(e,t,n,r,i){super(s.actionType,e,t,n),this.taskId=r,this.formId=i}}s.actionType="PLW_GET_FORM_RESPONSE_FAILED"},65980:(e,t,n)=>{"use strict";n.d(t,{u:()=>i});var r=n(75992),s=n(77508);class i extends r.r{loggingData(){return{walkthroughType:s.hs[this.walkthroughType],stepNumber:String(this.stepNumber)}}constructor(e,t){super(i.actionType),this.walkthroughType=e,this.stepNumber=t}}i.actionType="PLW_SKIP_WALKTHROUGH"},67188:(e,t,n)=>{"use strict";var r,s,i,a;n.d(t,{HX:()=>r,eN:()=>i}),function(e){e.noAccess="noAccess",e.readOnly="readOnly",e.restrictedReadWrite="restrictedReadWrite",e.readWrite="readWrite"}(r||(r={})),function(e){e.none="none",e.noModProjLicenseInTenant="noModProjLicenseInTenant",e.noRoadmapLicenseInTenant="noRoadmapLicenseInTenant",e.p1ProjectOnlineEssentials="p1ProjectOnlineEssentials"}(s||(s={})),function(e){e.basic="basic",e.basicPlus="basicPlus",e.standard="standard",e.professional="professional",e.premium="premium"}(i||(i={})),function(e){e.commercial="Commercial",e.commercialEducation="Commercial Education"}(a||(a={}));var o;!function(e){e.roadmap="roadmap",e.premiumPlan="premiumPlan",e.projectOnline="projectOnline",e.projectOperations="projectOperations"}(o||(o={}))},67578:(e,t,n)=>{"use strict";n.d(t,{s:()=>s});var r=n(32512);class s extends r.v{constructor(e,t,n,r){super(s.actionType,e,t,n),this.timestamp=r}}s.actionType="PLW_GET_DIFFSYNCFEED_FAILED"},69632:(e,t,n)=>{"use strict";n.d(t,{f:()=>a});var r=n(75992),s=n(86178),i=n.n(s);class a extends r.r{loggingData(){let e=0;for(const t of this.taskPermissionsSets)t.expiry.isBefore(i()())&&e++;return{numTaskPermissionsFetched:this.taskPermissionsSets.length.toString(),numTaskExpiredPermissionsFetched:e.toString()}}constructor(e){if(super(a.actionType),this.taskPermissionsSets=e,this.taskPermissionsSets.length<1)throw new Error("Task Permissions set has less than 1 entry")}}a.actionType="PLW_BATCH_GET_TASK_PERMISSIONS_SUCCEEDED"},70375:(e,t,n)=>{"use strict";n.d(t,{P:()=>s});var r=n(32512);class s extends r.v{constructor(e,t,n,r){super(s.actionType,t,n,r),this.taskId=e}}s.actionType="AUGLOOP_FETCH_FILE_SUG_FAILED"},70515:(e,t,n)=>{"use strict";n.d(t,{r:()=>s});var r=n(75992);class s extends r.r{constructor(){super(s.actionType)}}s.actionType="PLW_DISABLE_DIFFSYNC"},70596:(e,t,n)=>{"use strict";n.d(t,{Tk:()=>m,ZG:()=>h,Zz:()=>p,gK:()=>u});var r=n(52195),s=n(8736),i=n(77508),a=n(56415),o=n(66151),l=n(66783),c=n(65006),d=n(25420);const u={top:"0px",bottom:"0px",right:"0px",left:"0px",fontSize:r.s.mediumPlus},h=e=>({bottom:"0px",width:"100%",zIndex:s.B.ErrorBarZIndex,[`${e}.hidden`]:{display:"none"}}),p=(0,l.J9)(e=>({root:{marginTop:"48px"},circle:(0,o.Z_)(e),label:(0,o.aS)(e)})),g=(0,l.J9)(e=>((0,c.cJ)(e),[(0,d.gS)("column"),e===i.Sx.Dark&&{backgroundColor:a.z.DarkThemeAppBackgroundColor},e===i.Sx.Light&&{backgroundColor:a.z.White},{position:"absolute",inset:0,"> .suiteNav":[(0,d.$Z)(s.B.SuiteNavHeight),{background:a.z.Black}],"> .suiteNav.hidden":{display:"none"}}])),m=(0,l.J9)(e=>(0,r.Zq)("globalErrorPage",[g(e),(0,o.NX)(e)]))},70768:(e,t,n)=>{"use strict";n.d(t,{E:()=>o});var r=n(65043),s=n(16112),i=n(9850),a=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.name=function(){return"ScreenReaderOnly"},t.prototype.renderComponent=function(){var e=this.getClassNames();return r.createElement("div",{className:e.root},this.props.children)},t.prototype.getClassNames=function(){return(0,i.Z)((0,i.$)(this.props.styles))},t}(s.$)},71484:(e,t,n)=>{"use strict";n.d(t,{K:()=>r});var r={accdb:{extensions:["accdb","mdb"]},archive:{extensions:["7z","ace","arc","arj","dmg","gz","iso","lzh","pkg","rar","sit","tgz","tar","z"]},audio:{extensions:["aif","aiff","aac","alac","amr","ape","au","awb","dct","dss","dvf","flac","gsm","m4a","m4p","mid","mmf","mp3","oga","ra","rm","wav","wma","wv"]},calendar:{extensions:["ical","icalendar","ics","ifb","vcs"]},classifier:{extensions:["classifier"]},code:{extensions:["abap","ada","adp","ahk","as","as3","asc","ascx","asm","asp","awk","bash","bash_login","bash_logout","bash_profile","bashrc","bat","bib","bsh","build","builder","c","cbl","c++","capfile","cc","cfc","cfm","cfml","cl","clj","cls","cmake","cmd","coffee","config","cpp","cpt","cpy","cs","cshtml","cson","csproj","css","ctp","cxx","d","ddl","di","disco","dml","dtd","dtml","el","emakefile","erb","erl","f","f90","f95","fs","fsi","fsscript","fsx","gemfile","gemspec","gitconfig","go","groovy","gvy","h","h++","haml","handlebars","hbs","hcp","hh","hpp","hrl","hs","htc","hxx","idl","iim","inc","inf","ini","inl","ipp","irbrc","jade","jav","java","js","json","jsp","jsproj","jsx","l","less","lhs","lisp","log","lst","ltx","lua","m","mak","make","manifest","master","md","markdn","markdown","mdown","mkdn","ml","mli","mll","mly","mm","mud","nfo","opml","osascript","p","pas","patch","php","php2","php3","php4","php5","phtml","pl","pm","pod","pp","profile","ps1","ps1xml","psd1","psm1","pss","pt","py","pyw","r","rake","rb","rbx","rc","rdf","re","reg","rest","resw","resx","rhtml","rjs","rprofile","rpy","rss","rst","ruby","rxml","s","sass","scala","scm","sconscript","sconstruct","script","scss","sgml","sh","shtml","sml","svn-base","swift","sql","sty","tcl","tex","textile","tld","tli","tmpl","tpl","vb","vi","vim","vmg","webpart","wsp","wsdl","xhtml","xoml","xsd","xslt","yaml","yaws","yml","zsh"]},contact:{extensions:["vcf"]},csv:{extensions:["csv"]},desktopfolder:{},docset:{},documentsfolder:{},docx:{extensions:["doc","docm","docx","docb"]},dotx:{extensions:["dot","dotm","dotx"]},email:{extensions:["eml","msg","oft","ost","pst"]},exe:{extensions:["application","appref-ms","apk","app","appx","exe","ipa","msi","xap"]},favoritesfolder:{},folder:{},font:{extensions:["ttf","otf","woff"]},form:{},genericfile:{},html:{extensions:["htm","html","mht"]},ipynb:{extensions:["nnb","ipynb"]},link:{extensions:["lnk","link","url","website","webloc"]},linkedfolder:{},listitem:{},loop:{extensions:["fluid","loop"]},officescript:{extensions:["osts"]},splist:{},model:{extensions:["3ds","3mf","blend","cool","dae","df","dwfx","dwg","dxf","fbx","glb","gltf","holo","layer","layout","max","mcworld","mtl","obj","off","ply","skp","stp","stl","t","thl","x"]},mpp:{extensions:["mpp"]},mpt:{extensions:["mpt"]},multiple:{},one:{extensions:["note","one"]},onetoc:{extensions:["ms-one-stub","onetoc","onetoc2","onepkg"]},pbiapp:{},pdf:{extensions:["pdf"]},photo:{extensions:["arw","bmp","cr2","crw","dic","dicm","dcm","dcm30","dcr","dds","dib","dng","erf","gif","heic","heif","ico","jfi","jfif","jif","jpe","jpeg","jpg","jxr","kdc","mrw","nef","orf","pct","pict","png","pns","psb","psd","raw","tga","tif","tiff","wdp"]},photo360:{},picturesfolder:{},potx:{extensions:["pot","potm","potx"]},powerbi:{extensions:["pbids","pbix"]},ppsx:{extensions:["pps","ppsm","ppsx"]},pptx:{extensions:["ppt","pptm","pptx","sldx","sldm"]},presentation:{extensions:["odp","gslides","key"]},pub:{extensions:["pub"]},spo:{extensions:["aspx"]},sponews:{},spreadsheet:{extensions:["odc","ods","gsheet","numbers","tsv"]},rtf:{extensions:["epub","gdoc","odt","rtf","wri","pages"]},sharedfolder:{},playlist:{},sway:{},sysfile:{extensions:["bak","bin","cab","cache","cat","cer","class","dat","db","dbg","dl_","dll","ithmb","jar","kb","ldt","lrprev","pkpass","ppa","ppam","pdb","rom","thm","thmx","vsl","xla","xlam","xlb","xll"]},txt:{extensions:["dif","diff","readme","out","plist","properties","text","txt"]},vaultclosed:{},vaultopen:{},vector:{extensions:["ai","ait","cvs","dgn","gdraw","pd","emf","eps","fig","ind","indd","indl","indt","indb","ps","svg","svgz","wmf","oxps","xps","xd","sketch"]},video:{extensions:["3g2","3gp","3gp2","3gpp","asf","avi","dvr-ms","flv","m1v","m4v","mkv","mod","mov","mm4p","mp2","mp2v","mp4","mp4v","mpa","mpe","mpeg","mpg","mpv","mpv2","mts","ogg","qt","swf","ts","vob","webm","wlmp","wm","wmv","wmx"]},video360:{},vsdx:{extensions:["vdx","vsd","vsdm","vsdx","vsw","vdw"]},vssx:{extensions:["vss","vssm","vssx"]},vstx:{extensions:["vst","vstm","vstx","vsx"]},whiteboard:{extensions:["whiteboard","wbtx"]},xlsx:{extensions:["xlc","xls","xlsb","xlsm","xlsx","xlw"]},xltx:{extensions:["xlt","xltm","xltx"]},xml:{extensions:["xaml","xml","xsl"]},xsn:{extensions:["xsn"]},zip:{extensions:["zip"]}}},71794:(e,t,n)=>{"use strict";n.d(t,{$:()=>s});var r=n(75992);class s extends r.r{constructor(e){super(s.actionType),this.planEntitySet=e}}s.actionType="PLW_FETCH_PLAN_SUCCEEDED"},72261:(e,t,n)=>{"use strict";n.d(t,{c:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{groupNameValidationErrorCode:this.errorCode.toString()}}constructor(e){super(s.actionType),this.errorCode=e}}s.actionType="PLW_GROUPNAMESVALIDATION_SUCCEEDED"},72749:(e,t,n)=>{var r=n(48895),s=n(80755),i=n(91980),a=n(54052);e.exports=function(){var e=arguments.length;if(!e)return[];for(var t=Array(e-1),n=arguments[0],o=e;o--;)t[o-1]=arguments[o];return r(a(n)?i(n):[n],s(t,1))}},73360:(e,t,n)=>{"use strict";n.d(t,{N:()=>s});var r=n(32512);class s extends r.v{constructor(e,t,n,r){super(s.actionType,e,t,n),this.vroomId=r}}s.actionType="PLW_GET_DRIVE_ITEM_FAILURE"},73438:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var r=n(32512);class s extends r.v{constructor(e,t,n){super(s.actionType,e,t,n)}}s.actionType="PLW_GET_SENSITIVITYPOLICYSETTINGS_FAILED"},73615:(e,t,n)=>{"use strict";n.d(t,{U:()=>s});var r=n(32512);class s extends r.v{constructor(e,t,n,r){super(s.actionType,t,n,r),this.planId=e}}s.actionType="PLW_DELETE_PLAN_FAILED"},75411:(e,t,n)=>{"use strict";n.d(t,{x:()=>s});var r=n(75992);class s extends r.r{constructor(e){super(s.actionType),this.usageMode=e}}s.actionType="PLW_SET_USAGE_MODE"},75559:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ComponentErrorPage:()=>T});var r=n(93589),s=n(42463),i=n(56415),a=n(77508),o=n(52195),l=n(66783),c=n(66151);const d=(0,l.J9)(e=>{let t;switch(e){case a.Sx.LoopLight:t={border:`1px solid ${i.z.LoopLightErrorBannerBorder}`,backgroundColor:i.z.LoopLightErrorBannerBackground};break;case a.Sx.LoopDark:t={border:`1px solid ${i.z.LoopDarkErrorBanner}`,backgroundColor:i.z.LoopDarkErrorBannerBackground}}return t}),u=(0,l.J9)((e,t)=>{const n=[d(e),{alignItems:"center",height:"40px",padding:"2px 4px"}],r=[h(e),{".errorMessageTitle":{fontSize:o.s.medium,fontWeight:o.BO.semibold}}],s={root:{marginTop:"20px"},content:n,icon:h(e),iconContainer:{"> .plannerIcon":{display:"flex"}},innerText:r};return(0,o.TW)(s,t)}),h=(0,l.J9)(e=>{let t="";switch(e){case a.Sx.LoopLight:t=i.z.LoopLightErrorBannerText;break;case a.Sx.LoopDark:t=i.z.LoopDarkErrorBanner}return{color:t}}),p=(0,l.J9)(e=>{let t;switch(e){case a.Sx.LoopLight:t={border:`1px solid ${i.z.NeutralLightGrey82}`,backgroundColor:i.z.White,color:i.z.NeutralLightGrey14};break;case a.Sx.LoopDark:t={border:`1px solid ${i.z.NeutralDarkGrey40}`,backgroundColor:i.z.NeutralDarkGrey16,color:i.z.White}}return t});var g=n(89379),m=n(65804),f=n(59846),y=n(65043);const v=(0,g.Z)(),k=y.forwardRef((e,t)=>{let{reloadCallback:n,styles:i,theme:a,errorMessageTitle:o,errorMessageBody:l,reloadButtonText:c,isReloadButtonDisplayed:d,customMessageBarStyles:h}=e;const p=v(i,{theme:a}),g=y.createElement("div",{className:p.errorMessageTitle},o),m=y.createElement("div",{className:p.errorMessageBody},l),k=y.createElement("button",{className:p.reloadButton,onClick:n},c);return y.createElement("div",{className:p.root,ref:t},y.createElement(r.n,{messageBarType:s.H.error,isMultiline:!1,messageBarIconProps:f.qq,actions:d?k:void 0,styles:u(a,h)},g),m)}),T=(0,m.I)(k,e=>{let{theme:t}=e;return{root:["loopErrorPageContent",(0,c.aS)(t),(0,c.NX)(t),{height:"100%"}],errorMessageTitle:["errorMessageTitle",{fontSize:o.s.xLarge,fontFamily:"Segoe UI"}],errorMessageBody:["errorMessageBody",(0,c.aS)(t),{margin:"24px",fontSize:o.s.medium,fontWeight:o.BO.regular,fontFamily:"Segoe UI"}],reloadButton:["reloadButton",p(t),{cursor:"pointer",borderRadius:"4px",padding:"5px 8px"}]}})},75886:(e,t,n)=>{"use strict";var r;function s(e,t){return 0!==(e&t)}n.d(t,{c:()=>s,j:()=>r}),function(e){e[e.DisableNone=0]="DisableNone",e[e.DisableCheckedStateToggling=1]="DisableCheckedStateToggling",e[e.DisableReorder=2]="DisableReorder",e[e.DisableEditTitle=4]="DisableEditTitle",e[e.DisablePromote=8]="DisablePromote",e[e.DisableDelete=16]="DisableDelete",e[e.DisableCreate=32]="DisableCreate",e[e.DisableAll=63]="DisableAll"}(r||(r={}))},75913:(e,t,n)=>{"use strict";n.d(t,{C:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{recommendedDocumentPlanCount:String(this.plans.length)}}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(s.actionType),this.userId=e,this.plans=t,this.isFirstPage=n}}s.actionType="PLW_GET_RECOMMENDEDOCUMENTPLANS_SUCCEEDED"},76241:(e,t,n)=>{"use strict";var r;n.d(t,{X:()=>r}),function(e){e[e.Public=0]="Public",e[e.Private=1]="Private",e[e.HiddenMembership=2]="HiddenMembership"}(r||(r={}))},77910:(e,t,n)=>{"use strict";n.d(t,{O:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{viewKey:this.viewKey,filterCount:String(this.filter.filterCount)}}constructor(e,t){super(s.actionType),this.viewKey=e,this.filter=t}}s.actionType="SET_TASK_FILTER"},78751:(e,t,n)=>{"use strict";n.d(t,{W:()=>s});var r=n(32512);class s extends r.v{constructor(e,t,n,r){super(s.actionType,t,n,r),this.unifiedGroupId=e}}s.actionType="PLW_DELETE_UNIFIEDGROUP_FAILED"},79387:(e,t,n)=>{"use strict";n.d(t,{T:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{id:this.details.id}}constructor(e){super(s.actionType),this.details=e}}s.actionType="PLW_DIFFSYNC_UPDATE_PLAN_DETAILS"},79670:(e,t,n)=>{"use strict";n.d(t,{G:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{localId:this.localId,id:this.bucket.id}}constructor(e,t){super(s.actionType),this.bucket=e,this.localId=t}}s.actionType="PLW_CREATE_BUCKET_SUCCEEDED"},79889:(e,t,n)=>{var r=n(93950),s=n(46686);e.exports=function(e,t,n){var i=!0,a=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return s(n)&&(i="leading"in n?!!n.leading:i,a="trailing"in n?!!n.trailing:a),r(e,t,{leading:i,maxWait:t,trailing:a})}},80332:(e,t,n)=>{"use strict";n.d(t,{a:()=>s});var r=n(32512);class s extends r.v{constructor(e,t,n){super(s.actionType,e,t,n)}}s.actionType="PLW_GET_TENANTGROUPSETTINGS_FAILED"},80837:(e,t,n)=>{"use strict";n.d(t,{_:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{isCollapsed:String(this.isCollapsed)}}constructor(e,t,n){super(s.actionType),this.accessContext=e,this.isCollapsed=t,this.contextEntityId=n}}s.actionType="PLW_SET_CATEGORYLABEL_MODE"},81376:(e,t,n)=>{"use strict";n.d(t,{$:()=>s});var r=n(32512);class s extends r.v{constructor(e,t,n,r){super(s.actionType,e,t,n),this.session=r}}s.actionType="PLW_UPLOAD_BYTES_TO_SESSION_FAILED"},81576:(e,t,n)=>{"use strict";n.d(t,{R:()=>s});var r=n(75992);class s extends r.r{constructor(e){super(s.actionType),this.rejectedEquivalenceSetIds=e}}s.actionType="PLW_BATCH_GET_TASK_PERMISSIONS_FAILED"},81622:(e,t,n)=>{"use strict";n.d(t,{V:()=>s});var r=n(5583);function s(e,t){return[...void 0!==e.componentCriticalShortcuts?(0,r.O)(e.componentCriticalShortcuts,t):[],...void 0!==e.hostOverrideShortcuts?(0,r.O)(e.hostOverrideShortcuts,t):[],...void 0!==e.componentNormalShortcuts?(0,r.O)(e.componentNormalShortcuts,t):[],...void 0!==e.hostNormalShortcuts?(0,r.O)(e.hostNormalShortcuts,t):[],...void 0!==e.componentLowShortcuts?(0,r.O)(e.componentLowShortcuts,t):[]]}},84824:(e,t,n)=>{"use strict";n.d(t,{J:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{sessionId:this.sessionId}}constructor(e){super(s.actionType),this.sessionId=e}}s.actionType="PLW_CANCEL_UPLOAD_SESSION_SUCCEEDED"},84945:(e,t,n)=>{"use strict";function r(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),s=2;s<n;s++)r[s-2]=arguments[s];if(!e){var i;if(void 0===t)i=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var a=0;(i=new Error(t.replace(/%s/g,function(){return r[a++]}))).name="Invariant Violation"}throw i.framesToPop=1,i}}n.d(t,{V:()=>r})},85230:(e,t,n)=>{"use strict";n.d(t,{t:()=>s});var r=n(32512);class s extends r.v{constructor(e,t,n,r,i,a){super(s.actionType,e,t,n),this.session=r,this.taskId=i,this.updateKey=a}}s.actionType="PLW_UPLOAD_SESSION_FAILED"},87337:(e,t,n)=>{"use strict";n.d(t,{s:()=>s});var r=n(75992);class s extends r.r{constructor(e){super(s.actionType),this.container=e}}s.actionType="PLW_DELETE_UNIFIEDGROUP_SUCCEEDED"},87450:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{id:this.bucket.id,updateKey:this.updateKey}}constructor(e,t){super(s.actionType),this.bucket=e,this.updateKey=t}}s.actionType="PLW_UPDATE_BUCKET"},88080:(e,t,n)=>{"use strict";n.d(t,{t:()=>s});var r=n(25324);class s extends r.l{constructor(e,t,n,r,i,a,o){super(s.actionType,e,t,n,r,a,i,o)}}s.actionType="SHOW_SUCCESS_NOTIFICATION"},88457:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(65818),s=n(64836);class i extends s.m{constructor(e,t,n){super({externalId:e,containerType:r.K.Group},t.displayName),this.unifiedGroup=t,this.unifiedGroupDetails=n}}},89190:(e,t,n)=>{"use strict";n.d(t,{F:()=>s});var r=n(75992);class s extends r.r{constructor(e,t){super(s.actionType),this.updatedPlanEntitySet=e,this.updateKey=t}}s.actionType="PLW_UPDATE_PLANENTITYSET_SUCCEEDED"},90548:(e,t,n)=>{"use strict";n.d(t,{h:()=>s});var r=n(75992);class s extends r.r{constructor(e,t,n){super(s.actionType),this.taskId=e,this.formId=t,this.formResponse=n}}s.actionType="PLW_GET_FORM_RESPONSE_SUCCEEDED"},91393:(e,t,n)=>{"use strict";n.d(t,{p:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{id:this.taskDetails.id}}constructor(e){super(s.actionType),this.taskDetails=e}}s.actionType="PLW_DIFFSYNC_INSERT_TASK_DETAILS"},92296:(e,t,n)=>{"use strict";n.d(t,{E:()=>s});var r=n(32512);class s extends r.v{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";super(s.actionType,e,t,n)}}s.actionType="PLW_GET_TENANTFEEDBACKSETTINGS_FAILED"},92446:(e,t,n)=>{"use strict";n.d(t,{f:()=>s});var r=n(32512);class s extends r.v{constructor(e,t,n){super(s.actionType,e,t,n)}}s.actionType="GET_SUITENAV_FAILED"},93407:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{favoritePlanCount:String(this.plans.length)}}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(s.actionType),this.userId=e,this.plans=t,this.isFirstPage=n}}s.actionType="PLW_GET_FAVORITEPLANSFORUSER_SUCCEEDED"},93589:(e,t,n)=>{"use strict";n.d(t,{n:()=>A});var r,s=n(65804),i=n(56851),a=n(65043),o=n(89379),l=n(17066),c=n(4648),d=n(28553),u=n(13706),h=n(20751),p=n(42463),g=n(73172),m=n(15199),f=((r={})[p.H.info]="Info",r[p.H.warning]="Info",r[p.H.error]="ErrorBadge",r[p.H.blocked]="Blocked2",r[p.H.severeWarning]="Warning",r[p.H.success]="Completed",r),y=(0,o.Z)(),v=function(e){switch(e){case p.H.blocked:case p.H.error:case p.H.severeWarning:return"assertive"}return"polite"},k=function(e){switch(e){case p.H.blocked:case p.H.error:case p.H.severeWarning:return"alert"}return"status"},T=a.forwardRef(function(e,t){var n=(0,g.C)(!1),r=n[0],s=n[1].toggle,o=(0,m.B)("MessageBar"),T=e.actions,S=e.className,b=e.children,I=e.overflowButtonAriaLabel,C=e.dismissIconProps,D=e.styles,E=e.theme,P=e.messageBarType,w=void 0===P?p.H.info:P,x=e.onDismiss,F=void 0===x?void 0:x,A=e.isMultiline,L=void 0===A||A,_=e.truncated,U=e.dismissButtonAriaLabel,O=e.messageBarIconProps,B=e.role,M=e.delayedRender,N=void 0===M||M,R=e.expandButtonProps,G=e.onExpandButtonToggled,W=void 0===G?void 0:G,z=e.showExpandButton,j=a.useCallback(function(){s(),W&&W(!r)},[r,W,s]),K=(0,l.G1)(e,l.vt,["className","role"]),H=y(D,{theme:E,messageBarType:w||p.H.info,onDismiss:void 0!==F,actions:void 0!==T,truncated:_,isMultiline:L,expandSingleLine:r,className:S}),V={iconName:r?"DoubleChevronUp":"DoubleChevronDown"},Z=T||F?{"aria-describedby":o,role:"region"}:{},q=T?a.createElement("div",{className:H.actions},T):null,Y=F?a.createElement(u.K,{disabled:!1,className:H.dismissal,onClick:F,iconProps:C||{iconName:"Clear"},title:U,ariaLabel:U}):null;return a.createElement("div",(0,i.__assign)({ref:t,className:H.root},Z),a.createElement("div",{className:H.content},a.createElement("div",{className:H.iconContainer,"aria-hidden":!0},O?a.createElement(h.I,(0,i.__assign)({},O,{className:(0,c.A)(H.icon,O.className)})):a.createElement(h.I,{iconName:f[w],className:H.icon})),a.createElement("div",{className:H.text,id:o,role:B||k(w),"aria-live":v(w)},a.createElement("span",(0,i.__assign)({className:H.innerText},K),N?a.createElement(d.P,null,a.createElement("span",null,b)):a.createElement("span",null,b))),(z||!L&&!q&&_)&&a.createElement("div",{className:H.expandSingleLine},a.createElement(u.K,(0,i.__assign)({disabled:!1,className:H.expand,onClick:j,iconProps:V,ariaLabel:I,"aria-expanded":r},R))),!L&&q,!L&&Y&&a.createElement("div",{className:H.dismissSingleLine},Y),L&&Y),L&&q)});T.displayName="MessageBar";var S,b,I,C,D=n(52195),E={root:"ms-MessageBar",error:"ms-MessageBar--error",blocked:"ms-MessageBar--blocked",severeWarning:"ms-MessageBar--severeWarning",success:"ms-MessageBar--success",warning:"ms-MessageBar--warning",multiline:"ms-MessageBar-multiline",singleline:"ms-MessageBar-singleline",dismissalSingleLine:"ms-MessageBar-dismissalSingleLine",expandingSingleLine:"ms-MessageBar-expandingSingleLine",content:"ms-MessageBar-content",iconContainer:"ms-MessageBar-icon",text:"ms-MessageBar-text",innerText:"ms-MessageBar-innerText",dismissSingleLine:"ms-MessageBar-dismissSingleLine",expandSingleLine:"ms-MessageBar-expandSingleLine",dismissal:"ms-MessageBar-dismissal",expand:"ms-MessageBar-expand",actions:"ms-MessageBar-actions",actionsSingleline:"ms-MessageBar-actionsSingleLine"},P=((S={})[p.H.error]="errorBackground",S[p.H.blocked]="errorBackground",S[p.H.success]="successBackground",S[p.H.warning]="warningBackground",S[p.H.severeWarning]="severeWarningBackground",S[p.H.info]="infoBackground",S),w=((b={})[p.H.error]="errorIcon",b[p.H.blocked]="errorIcon",b[p.H.success]="successIcon",b[p.H.warning]="warningIcon",b[p.H.severeWarning]="severeWarningIcon",b[p.H.info]="infoIcon",b),x=((I={})[p.H.error]="#ff0000",I[p.H.blocked]="#ff0000",I[p.H.success]="#bad80a",I[p.H.warning]="#fff100",I[p.H.severeWarning]="#ff0000",I[p.H.info]="WindowText",I),F=((C={})[p.H.error]="#e81123",C[p.H.blocked]="#e81123",C[p.H.success]="#107c10",C[p.H.warning]="#966400",C[p.H.severeWarning]="#d83b01",C[p.H.info]="WindowText",C),A=(0,s.I)(T,function(e){var t,n,r,s,a,o,l,c,d,u,h,g=e.theme,m=e.className,f=e.onDismiss,y=e.truncated,v=e.isMultiline,k=e.expandSingleLine,T=e.messageBarType,S=void 0===T?p.H.info:T,b=g.semanticColors,I=g.fonts,C=(0,D.L6)(0,D.iD),A=(0,D.Km)(E,g),L={fontSize:D.fF.xSmall,height:10,lineHeight:"10px",color:b.messageText,selectors:(t={},t[D.up]=(0,i.__assign)((0,i.__assign)({},(0,D.Qg)()),{color:"WindowText"}),t)},_=[(0,D.gm)(g,{inset:1,highContrastStyle:{outlineOffset:"-6px",outline:"1px solid Highlight"},borderColor:"transparent"}),{flexShrink:0,width:32,height:32,padding:"8px 12px",selectors:{"& .ms-Button-icon":L,":hover":{backgroundColor:"transparent"},":active":{backgroundColor:"transparent"}}}];return{root:[A.root,I.medium,S===p.H.error&&A.error,S===p.H.blocked&&A.blocked,S===p.H.severeWarning&&A.severeWarning,S===p.H.success&&A.success,S===p.H.warning&&A.warning,v?A.multiline:A.singleline,!v&&f&&A.dismissalSingleLine,!v&&y&&A.expandingSingleLine,{background:b[P[S]],boxSizing:"border-box",color:b.messageText,minHeight:32,width:"100%",display:"flex",wordBreak:"break-word",selectors:(n={".ms-Link":{color:b.messageLink,selectors:{":hover":{color:b.messageLinkHovered}}}},n[D.up]=(0,i.__assign)((0,i.__assign)({},(0,D.Qg)()),{background:"transparent",border:"1px solid ".concat(x[S]),color:"WindowText"}),n[D.hT]={border:"1px solid ".concat(F[S])},n)},v&&{flexDirection:"column"},m],content:[A.content,(r={display:"flex",width:"100%",lineHeight:"normal"},r[C]={display:"grid",gridTemplateColumns:"auto 1fr auto",gridTemplateRows:"1fr auto",gridTemplateAreas:'\n            "icon text close"\n            "action action action"\n          '},r)],iconContainer:[A.iconContainer,(s={fontSize:D.fF.medium,minWidth:16,minHeight:16,display:"flex",flexShrink:0,margin:"8px 0 8px 12px"},s[C]={gridArea:"icon"},s)],icon:{color:b[w[S]],selectors:(a={},a[D.up]=(0,i.__assign)((0,i.__assign)({},(0,D.Qg)()),{color:"WindowText"}),a)},text:[A.text,(0,i.__assign)((0,i.__assign)({minWidth:0,display:"flex",flexGrow:1,margin:8},I.small),(o={},o[C]={gridArea:"text"},o.selectors=(l={},l[D.up]=(0,i.__assign)({},(0,D.Qg)()),l),o)),!f&&{marginRight:12}],innerText:[A.innerText,{lineHeight:16,selectors:{"& span a:last-child":{paddingLeft:4}}},y&&{overflow:"visible",whiteSpace:"pre-wrap"},!v&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},!v&&!y&&{selectors:(c={},c[C]={overflow:"visible",whiteSpace:"pre-wrap"},c)},k&&{overflow:"visible",whiteSpace:"pre-wrap"}],dismissSingleLine:[A.dismissSingleLine,(d={},d[C]={gridArea:"close"},d)],expandSingleLine:A.expandSingleLine,dismissal:[A.dismissal,_],expand:[A.expand,_],actions:[v?A.actions:A.actionsSingleline,(u={display:"flex",flexGrow:0,flexShrink:0,flexBasis:"auto",flexDirection:"row-reverse",alignItems:"center",margin:"0 12px 0 8px",forcedColorAdjust:"auto",MsHighContrastAdjust:"auto"},u[C]={gridArea:"action",marginRight:8,marginBottom:8},u.selectors={"& button:nth-child(n+2)":(h={marginLeft:8},h[C]={marginBottom:0},h)},u),v&&{marginBottom:8},f&&!v&&{marginRight:0}]}},void 0,{scope:"MessageBar"})},93593:(e,t,n)=>{"use strict";n.d(t,{Y:()=>s});var r=n(75992);class s extends r.r{constructor(e,t){super(s.actionType),this.planId=e,this.planContainer=t}}s.actionType="PLW_DELETE_PLAN_SUCCEEDED"},93940:(e,t,n)=>{"use strict";n.d(t,{v:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{cv:this.cv,logicalId:this.logicalId,traceId:this.fileSuggestions.fileResultReference.referenceId}}constructor(e,t,n,r){super(s.actionType),this.entityId=e,this.cv=t,this.logicalId=n,this.fileSuggestions=r}}s.actionType="AUGLOOP_FETCH_FILE_SUG_SUCCEEDED"},93950:(e,t,n)=>{var r=n(46686),s=n(4757),i=n(40801),a=Math.max,o=Math.min;e.exports=function(e,t,n){var l,c,d,u,h,p,g=0,m=!1,f=!1,y=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function v(t){var n=l,r=c;return l=c=void 0,g=t,u=e.apply(r,n)}function k(e){var n=e-p;return void 0===p||n>=t||n<0||f&&e-g>=d}function T(){var e=s();if(k(e))return S(e);h=setTimeout(T,function(e){var n=t-(e-p);return f?o(n,d-(e-g)):n}(e))}function S(e){return h=void 0,y&&l?v(e):(l=c=void 0,u)}function b(){var e=s(),n=k(e);if(l=arguments,c=this,p=e,n){if(void 0===h)return function(e){return g=e,h=setTimeout(T,t),m?v(e):u}(p);if(f)return clearTimeout(h),h=setTimeout(T,t),v(p)}return void 0===h&&(h=setTimeout(T,t)),u}return t=i(t)||0,r(n)&&(m=!!n.leading,d=(f="maxWait"in n)?a(i(n.maxWait)||0,t):d,y="trailing"in n?!!n.trailing:y),b.cancel=function(){void 0!==h&&clearTimeout(h),g=0,l=p=c=h=void 0},b.flush=function(){return void 0===h?u:S(s())},b}},94030:(e,t,n)=>{"use strict";var r;n.d(t,{n:()=>r}),function(e){e[e.UserTopAssignee=0]="UserTopAssignee",e[e.SimilarTaskTitle=1]="SimilarTaskTitle",e[e.MostAvailableUser=2]="MostAvailableUser",e[e.PlanTopAssignee=3]="PlanTopAssignee"}(r||(r={}))},94600:(e,t,n)=>{"use strict";n.d(t,{P:()=>s});var r=n(75992);class s extends r.r{constructor(e){super(s.actionType),this.unifiedGroupDetails=e}}s.actionType="PLW_GET_UNIFIEDGROUPDETAILS_SUCCEEDED"},95201:(e,t,n)=>{"use strict";n.d(t,{S:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{sessionId:this.sessionId}}constructor(e){super(s.actionType),this.sessionId=e}}s.actionType="PLW_CANCEL_UPLOAD_SESSION"},96481:(e,t,n)=>{"use strict";n.d(t,{Do:()=>r,Pj:()=>s});const r=n(65043).createContext({openLinkCallback:e=>{window.open(e.url)},openLinkInNewWindow:!1}),s=r.Provider;r.Consumer},98656:(e,t,n)=>{"use strict";n.d(t,{N:()=>w});var r=n(65043),s=n(4648),i=n(82014),a=n(49634),o=n(24718),l=n(63722),c=n(7666),d=n(19466),u=n(68417),h=0,p={reset:function(){l.nr.getInstance().onReset(function(){return h++})},getId:function(){return h},renderStyles:function(e,t){return(0,c.L)(Array.isArray(e)?e:[e],t)},renderFontFace:function(e,t){return(0,d.n)(e)},renderKeyframes:function(e){return(0,u.i)(e)}};var g=function(e){var t=new Map,n=new Set,s=function(e){var r=e.currentTarget,i=r.__id__;t.delete(i),r.removeEventListener("unload",s),n.delete(i)};return function(l){void 0===l&&(l={});var c,d=l.theme,u=(0,i.ox)();u&&(u.__id__=u.__id__||(0,o.O)(),c=u.__id__,n.has(c)||(n.add(c),u.addEventListener("unload",s)));var h=(0,a.D)();d=d||h;var g=p.getId(),m=[c,g,d],f=function(e,t){var n,r,s,i=t[0],a=t[1],o=t[2];return null===(s=null===(r=null===(n=e.get(i))||void 0===n?void 0:n.get(a))||void 0===r?void 0:r.get(o))||void 0===s?void 0:s.classMap}(t,m);if(r.useEffect(function(){return function(e,t){var n,r,s=t[0],i=t[1],a=t[2],o=null===(r=null===(n=e.get(s))||void 0===n?void 0:n.get(i))||void 0===r?void 0:r.get(a);o&&o.refCount++}(t,[c,g,d]),function(){return function(e,t){var n,r,s,i,a,o,l,c,d=t[0],u=t[1],h=t[2],p=null===(r=null===(n=e.get(d))||void 0===n?void 0:n.get(u))||void 0===r?void 0:r.get(h);p&&(p.refCount--,0===p.refCount&&(null===(i=null===(s=e.get(d))||void 0===s?void 0:s.get(u))||void 0===i||i.delete(h),0===(null===(o=null===(a=e.get(d))||void 0===a?void 0:a.get(u))||void 0===o?void 0:o.size)&&(null===(l=e.get(d))||void 0===l||l.delete(u),0===(null===(c=e.get(d))||void 0===c?void 0:c.size)&&e.delete(d))))}(t,[c,g,d])}},[c,g,d]),!f){var y=function(e){return"function"===typeof e}(e)?e(d):e;f=p.renderStyles(y,{targetWindow:u,rtl:!!d.rtl}),function(e,t,n){var r,s,i=t[0],a=t[1],o=t[2],l=null!==(r=e.get(i))&&void 0!==r?r:new Map;e.set(i,l);var c=null!==(s=l.get(a))&&void 0!==s?s:new Map;l.set(a,c),c.set(o,{classMap:n,refCount:0})}(t,m,f)}return f}}(function(e){var t=e.semanticColors,n=e.fonts;return{body:[{color:t.bodyText,background:t.bodyBackground,fontFamily:n.medium.fontFamily,fontWeight:n.medium.fontWeight,fontSize:n.medium.fontSize,MozOsxFontSmoothing:n.medium.MozOsxFontSmoothing,WebkitFontSmoothing:n.medium.WebkitFontSmoothing}]}});function m(e){var t=g(e),n=e.className,a=e.applyTo;!function(e,t){var n,s="body"===e.applyTo,a=null===(n=(0,i.ZY)())||void 0===n?void 0:n.body;r.useEffect(function(){if(s&&a){for(var e=0,n=t;e<n.length;e++){var r=n[e];r&&a.classList.add(r)}return function(){if(s&&a)for(var e=0,n=t;e<n.length;e++){var r=n[e];r&&a.classList.remove(r)}}}},[s,a,t])}(e,[t.root,t.body]),e.className=(0,s.A)(n,t.root,"element"===a&&t.body)}var f=n(56851),y=n(22090),v=n(32824),k=n(23956),T=n(80173),S=n(4398),b=function(e){var t=e.customizerContext,n=e.ref,s=e.theme,i=e.as||"div",a="string"===typeof e.as?(0,y._)(e.as,e):e.as===r.Fragment?{children:e.children}:(0,v.cJ)(e,["as"]);return r.createElement(S.D.Provider,{value:s},r.createElement(k.z.Provider,{value:t},r.createElement(T.N,{providerRef:n},r.createElement(i,(0,f.__assign)({},a)))))},I=n(4563),C=new Map,D=function(e){var t=e.theme,n=(0,a.D)(),s=e.theme=r.useMemo(function(){var e=(0,I.z)(n,t);return e.id=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=[],r=0,s=e;r<s.length;r++){var i=s[r];if(i){var a=i.id||C.get(i);a||(a=(0,o.O)(""),C.set(i,a)),n.push(a)}}return n.join("-")}(n,t),e},[n,t]);e.customizerContext=r.useMemo(function(){return{customizations:{inCustomizerContext:!0,settings:{theme:s},scopedSettings:s.components||{}}}},[s]),e.theme.rtl!==n.rtl&&(e.dir=e.theme.rtl?"rtl":"ltr")},E=n(52787),P=n(56420),w=r.forwardRef(function(e,t){var n=function(e,t){var n=(0,E.N)(t,e);return D(n),{state:n,render:b}}(e,{ref:(0,P.a)(t,r.useRef(null)),as:"div",applyTo:"element"}),s=n.render,i=n.state;return m(i),s(i)});w.displayName="ThemeProvider"},99244:(e,t,n)=>{"use strict";n.d(t,{t:()=>s});var r=n(75992);class s extends r.r{constructor(e,t){super(s.actionType),this.planEntitySet=e,this.localId=t}}s.actionType="PLW_CREATE_PLAN_SUCCEEDED"},99763:(e,t,n)=>{"use strict";n.d(t,{T:()=>s});var r=n(75992);class s extends r.r{loggingData(){return{id:this.taskEntitySet.id}}constructor(e,t){super(s.actionType),this.originalTaskEntitySet=e,this.taskEntitySet=t}}s.actionType="PLW_DIFFSYNC_UPDATE_TASK"}}]);
//# sourceMappingURL=7691.ec5a2635.chunk.js.map