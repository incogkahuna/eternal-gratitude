"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[75959],{5583:(e,t,i)=>{function n(e,t){return e.filter(e=>e.keyboardShortcutDescription.type===t)}i.d(t,{O:()=>n})},21161:(e,t,i)=>{i.d(t,{Q:()=>o,S:()=>n});var n=function(e){return e.left="left",e.right="right",e.up="up",e.down="down",e.lineBegin="lineBegin",e.lineEnd="lineEnd",e.pageUp="pageUp",e.pageDown="pageDown",e}({}),o=function(e){return e[e.ip=0]="ip",e[e.fullRange=1]="fullRange",e[e.selectMe=2]="selectMe",e}({})},40656:(e,t,i)=>{function n(e,t){const i=e;return i?.creationData?.dataType===t&&void 0!==i.creationData.data}i.d(t,{I:()=>n})},43746:(e,t,i)=>{function n(e,t){return e.filter(e=>!!e.keyboardShortcutDescription.isOverride===t)}i.d(t,{D:()=>n})},56887:(e,t,i)=>{i.r(t),i.d(t,{createPlannerLinkUnfurl:()=>bn,loopExport:()=>Sn,plannerLinkOptionalProviders:()=>kn});var n={};i.r(n),i.d(n,{activityButtonClassName:()=>Ie,activityButtonContainerClassName:()=>Me,containerHeightFromCardWidth:()=>je,contentContainerClassName:()=>He,descriptionClassName:()=>Pe,descriptionFadeClassName:()=>Ne,descriptionShimmerContainerClassName:()=>Te,embedCardClassName:()=>Ee,linkClassName:()=>Ae,logoClassName:()=>Ce,logoContainerClassName:()=>ke,selectionTextClass:()=>fe,shimmerFirstRowClassName:()=>Le,shimmerSecondRowClassName:()=>Fe,spinnerStyle:()=>we,svgLogoClassName:()=>xe,thumbnailClassName:()=>Ve,thumbnailContainerClassName:()=>Re,thumbnailHolderClassName:()=>De,titleBarClassName:()=>Se,titleClassName:()=>be,unfurlCardContainerClassName:()=>Ue,webChromeHeaderClassName:()=>Be});var o={};i.r(o),i.d(o,{logoClass:()=>Ye,logoClassName:()=>Je,pillContainer:()=>Ze,pillText:()=>Ge,spinnerStyle:()=>et,svgLogoClass:()=>Qe,svgLogoClassName:()=>Xe,titleText:()=>Ke});var r=i(40656);class a{constructor(e){this.target=e,this.proxyComponent=new Proxy(e,this),this.adapterState={proxyComponent:this.proxyComponent},this.activeAdapters=new Map}async initialize(e,t){this.viewAdapters=t;for(const i of e){const e=await i.factory(this.target,this.adapterState);e&&this.activeAdapters.set(i.key,e)}}getProxy(){return this.proxyComponent}get(e,t,i){if(this.viewAdapters&&"HTMLViewable"===t&&t in e){const n=Reflect.get(e,t,i),o=this.viewAdapters;return{HTMLViewable:n,getView:async()=>{const e=await n.getView(),t=new a(e);return await t.initialize(o),t.getProxy()}}}return t in e?Reflect.get(e,t,i):this.activeAdapters.get(t)}}async function s(e,t,i){let n=e;return(t&&t.length>0||i&&i.length>0)&&(n=await async function(e,t,i){const n=new a(e);return await n.initialize(t,i),n.getProxy()}(e,t??[],i)),n}class l{constructor(e,t,i,n){this.create=e,this.optionalProviders=t,this.contractAdapters=i,this.viewAdapters=n,this.type="LoopObject"}async instantiateLoopComponent(e,t){const i=this.optionalProviders&&t?.synthesize(this.optionalProviders,void 0)||void 0;return await s(await this.create(e,i),this.contractAdapters,this.viewAdapters)}}const d=new Map([["after","forward"],["before","backward"]]),c=new Map([["forward","after"],["backward","before"]]),h={key:"ComponentFocusable",factory:(e,t)=>{const i=t.proxyComponent.Focusable??e;if(i.Focusable)return{get ComponentFocusable(){return this},giveFocus:e=>!!i.Focusable&&i.Focusable.giveFocus(d.get(e)),isComponentFocused:()=>i.Focusable?.isFocused?.()??!1,setHostComponentFocusable(e){i.Focusable?.setHostFocusCallback?.(t=>{e.giveFocus(c.get(t))})}}}};var u=i(75368);const m={TokenProvider:"TokenProvider",CommandingSurface:"CommandingSurface",InternationalizationContext:"InternationalizationContext",NamespaceLogger:"NamespaceLogger",LoopTrustedTypesPolicy:"LoopTrustedTypesPolicy",SettingsProvider:"SettingsProvider",LinkService:"LinkService",OfficePolicyProvider:"OfficePolicyProvider",CommandBarTreeViewProvider:"CommandBarTreeViewProvider",UrlHandlerProvider:"UrlHandlerProvider",Theming:"Theming",AugmentationSessionContext:"AugmentationSessionContext"};var p=i(18504),g=i(70579),v=i(65043),f=i(97950),y=i(21161);class C{constructor(e){this.selectionHelper=e,this.moveSelectionToHost=e=>{if(!this.hostComponent)return!1;if(!this.previousLocation?.x)return this.hostComponent.setSelection({mode:y.Q.ip,direction:e,currentSelection:this});const t={mode:y.Q.ip,direction:e,currentCoordinates:{x:this.previousLocation.x,y:void 0},currentSelection:this};return!!this.hostComponent.setSelection(t)&&(delete this.previousLocation,!0)},this.handleKeyDirection=e=>{let t;switch(e.key){case"ArrowLeft":t=this.moveSelectionToHost(y.S.left);break;case"ArrowRight":t=this.moveSelectionToHost(y.S.right);break;case"ArrowUp":t=this.moveSelectionToHost(y.S.up);break;case"ArrowDown":t=this.moveSelectionToHost(y.S.down);break;default:return}t&&e.stopPropagation(),e.preventDefault()},this.ComponentSelection=this}setSelection(e){return this.previousLocation=e.currentCoordinates,this.selectionHelper.select(e)}setHostComponentSelection(e){this.hostComponent=e}clearSelection(){delete this.previousLocation,this.selectionHelper.clear?.()}}var x=i(33481);async function w(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;const n=i.navigator.clipboard?.write&&!(0,x.gm)();let o=!1;if(n)try{await async function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;const n={};e&&(n["text/plain"]=new Blob([e],{type:"text/plain"}));t&&(n["text/html"]=new Blob([t],{type:"text/html"}));return i.navigator.clipboard.write([new ClipboardItem(n)])}(e,t,i)}catch(r){if(!(r instanceof DOMException&&"NotAllowedError"===r.name))throw r;o=!0}n&&!o||function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;const n=i=>{const n=i?.clipboardData;n&&(t&&n.setData("text/html",t),e&&n.setData("text/plain",e),i.preventDefault(),i.stopImmediatePropagation())};i.document.addEventListener("copy",n);const o=i.document.execCommand("copy");if(i.document.removeEventListener("copy",n),!o)throw new Error("Copy execCommand unsuccessful")}(e,t,i)}var k=i(62573),b=i(27284),S=i.n(b);class P extends b.EventEmitter{constructor(e,t,i,n){super(),this.urlData=e,this.openLinkCallback=t,this.getCommandStrings=i,this.clipboardProvider=n,this.ComponentProduceCommands=this}async getCommands(e){const t=[],i=await this.getCommandStrings();return t.push({displayName:i.groupDisplayName||"",id:i.groupId||"liveComponentCommands",subMenuCommands:[{displayName:i.openLinkCommandDisplayName,id:"openLinkNewTab",icon:(0,k.t$)("FFXCOpen"),execute:()=>{this.openLinkCallback(!0)}},{displayName:i.copyLinkCommandDisplayName,id:"copyLink",icon:(0,k.t$)("FFXCLinkUrlRest"),execute:()=>this.clipboardProvider?w(this.clipboardProvider.getComponentTextForClipboard(),this.clipboardProvider.getComponentHtmlForClipboard()?.outerHTML):async function(e){return w(e,void 0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:window)}(this.urlData.url.href)}]}),t}}var L=i(43746),F=i(81622);function T(e,t,i){const n={componentCriticalShortcuts:[],hostOverrideShortcuts:(0,L.D)(t,!0),componentNormalShortcuts:[...e],hostNormalShortcuts:(0,L.D)(t,!1),componentLowShortcuts:[]};return(0,F.V)(n,i)}function N(e,t){const i=e.find(e=>function(e,t){const i=t.keyboardShortcutDescription;return i.type===e.type&&i.key===e.key&&!!i.altKey===e.altKey&&!!i.ctrlKey===e.ctrlKey&&!!i.metaKey===e.metaKey&&!!i.shiftKey===e.shiftKey}(t,e));if(void 0!==i)return i.handler(t),void t.preventDefault()}var A=i(98140);async function H(e,t){const i=await e.getCommands();if(t)for(const n of t())"linkOptionsCommand"===n.id&&i.push(n);return i}var B=i(95996),V=i(33788),D=i(83125);const R=["LoadingUI","MeaningfulRender","InteractiveReady"];class E{static start(e,t){const i=new D.p("ComponentPerf",t),n=new E(V.m.start("ComponentRender",i,{logSubactivityStartTimes:!1}));return n.addAdditionalProps({Component:e}),n}constructor(e){this.tracker=e,this.completeStages=new Set,R.forEach(t=>e.markSubActivityStart(t))}addAdditionalProps(e){this.tracker.addAdditionalProps(e)}endRenderingSubActivity(e){this.completeStages.has(e)||(this.tracker.markSubActivityEnd(e),this.completeStages.add(e))}endRendering(e,t,i,n){R.forEach(e=>{this.completeStages.has(e)||(this.endRenderingSubActivity(e),this.completeStages.add(e))}),this.tracker.setResult(e,t,i,n)}cancel(){this.tracker.cancel()}dispose(){this.tracker.dispose()}}var I=i(75460),M=i(57833);const j="LoadingState";class U extends b.EventEmitter{addAdditionalProps(e){this.perfTracker?.addAdditionalProps(e),this.viewRenderingActivity?.addAdditionalProps(e)}endRenderingSubActivity(){this.isFirstRender&&(this.isFirstRender=!1,this.perfTracker?.endRenderingSubActivity("LoadingUI"),this.viewRenderingActivity?.markSubActivityEnd(j))}endRenderingActivity(e,t){e&&this.addAdditionalProps({ViewMode:Number(e)}),t?(this.perfTracker?.cancel(),this.viewRenderingActivity?.cancel()):(this.perfTracker?.endRendering(!0),this.viewRenderingActivity?.setResult(!0)),this.viewRenderingActivity=void 0,this.perfTracker=void 0,this.viewRenderPromise?.resolve()}initializeRenderStageTrackers(){this.visualReadyTracker=(0,M.p)("visualReady",this),this.fullUiReadyTracker=(0,M.p)("fullUIReady",this),this.visualReadyTracker.start(),this.fullUiReadyTracker.start()}constructor(e,t,i,n,o,r,a,s){let l=arguments.length>8&&void 0!==arguments[8]&&arguments[8];super(),this.urlData=e,this.aLinkProviders=t,this.clipboardProvider=i,this.openLinkCallback=n,this.onRender=o,this.componentName=a,this.isComponentASourcedIframe=s,this.isPrintView=l,this.viewRef=v.createRef(),this.hostKeyboardShortcuts=[],this.isReadonly=!1,this.keydownShortcuts=[],this.keyupShortcuts=[],this.keypressShortcuts=[],this.getHostComponentCommands=void 0,this.disposeCalled=!1,this.isFirstRender=!0,this.userActivityBaseEventHandler=()=>{this.emit("userActivity"),this.removeHostingElementBaseEventListeners()},this.userActivityEventHandlerMouseLeave=e=>{this.isFocused()&&(this.emit("userActivity"),this.removeHostingElementSourcedIframeEventListeners())},this.removeHostingElementSourcedIframeEventListeners=()=>{this.removeHostingElementBaseEventListeners(),this.element instanceof HTMLIFrameElement?this.element.contentWindow?.removeEventListener("mouseleave",this.userActivityEventHandlerMouseLeave,{capture:!1}):this.element?.removeEventListener("mouseleave",this.userActivityEventHandlerMouseLeave,{capture:!1})},this.userActivityEventLogging=e=>{this.UserActivityProvider.once("userActivity",()=>{(0,B.o4)(e,{eventName:"UserActiveInComponent"})})},this.onKeyDownHandler=e=>{N(this.keydownShortcuts,e)},this.onKeyUpHandler=e=>{N(this.keyupShortcuts,e)},this.onKeyPressHandler=e=>{N(this.keypressShortcuts,e)},this.callbackToOpenLinkOnClick=(e,t)=>{this.openLinkCallback(e,t)},this.onClickHandler=e=>{this.clickCallback||(this.clickCallback=function(e,t,i,n,o){const r=[];return i&&r.push({shortcutDescription:{type:"contextmenu"},handler:async e=>{await i.show({clientX:e.clientX,clientY:e.clientY,commandGroups:await H(t,o),ownerDocument:window.document,topBarCommands:[],disableInitialFocus:(0,A.Fr)(),triggerByKeyboardEvent:2!==e.button})}}),(0,A.Fr)()&&(n||i)?r.push({shortcutDescription:{type:"click"},handler:async e=>n?n.display({mainBarCommands:await H(t,o)}):i?i.show({clientX:e.pageX,clientY:e.pageY,commandGroups:await H(t,o),ownerDocument:window.document,topBarCommands:[],disableInitialFocus:(0,A.Fr)(),triggerByKeyboardEvent:2!==e.button}):void 0}):(r.push({shortcutDescription:{type:"click",ctrlKey:!1},handler:async t=>e(!1,t)}),r.push({shortcutDescription:{type:"click",ctrlKey:!0},handler:async()=>e(!0)})),async e=>{const t=r.find(t=>function(e,t){let{shortcutDescription:i}=t;return i.type===e.type&&(void 0===i.button||i.button===e.button)&&(void 0===i.altKey||i.altKey===e.altKey)&&(void 0===i.ctrlKey||i.ctrlKey===e.ctrlKey)&&(void 0===i.metaKey||i.metaKey===e.metaKey)&&(void 0===i.shiftKey||i.shiftKey===e.shiftKey)}(e.nativeEvent,t));if(t)return e.preventDefault(),t.handler(e.nativeEvent)}}(this.callbackToOpenLinkOnClick,this.ComponentProduceCommands,this.aLinkProviders.CommandingSurface,this.aLinkProviders.CommandBarTreeViewProvider,this.getHostComponentCommands)),this.isFocused()||this.giveFocus(),this.clickCallback(e)},this.viewRenderingActivity=V.m.start("ViewRenderingMeasure",t.NamespaceLogger),this.perfTracker=E.start(a,t.NamespaceLogger),this.viewRenderingActivity.markSubActivityStart(j),this.addAdditionalProps({IsFirstView:r}),this.ComponentSelection=new C({select:()=>!!this.viewRef.current&&(this.viewRef.current.focus(),!0)}),this.ComponentProduceCommands=new P(this.urlData,this.openLinkCallback,this.getCommandStrings.bind(this),i),this.buildShortcutsHierarchy()}get HTMLView(){return this}async render(e,t){return this.element=e,this.viewRenderPromise=new I.c,this.element.addEventListener("keyup",this.onKeyUpHandler),this.element.addEventListener("keypress",this.onKeyPressHandler),void 0!==this.isComponentASourcedIframe&&(this.userActivityEventLogging(new D.p(this.componentName,this.aLinkProviders.NamespaceLogger)),this.isComponentASourcedIframe?this.addUserActivitySourcedIframeEventListeners():this.addUserActivityBaseEventListeners()),void 0!==t?.display&&(this.display=t.display,this.onRender(this.isInline())),t?.getComponentCommands&&(this.getHostComponentCommands=t.getComponentCommands),this.isPrintView?this.printView(e,t):this.renderView(e,t)}async dispose(){this.disposeCalled||(this.disposeCalled=!0,this.addAdditionalProps({IsUnendedActivity:!0}),this.endRenderingActivity(void 0,!0),this.hostKeyboardShortcuts=[],this.keydownShortcuts=[],this.keyupShortcuts=[],this.keypressShortcuts=[],this.element&&(this.element.removeEventListener("keyup",this.onKeyUpHandler),this.element.removeEventListener("keypress",this.onKeyPressHandler),this.disposeView(),this.element=void 0))}printView(e,t){const i=this.renderView(e,t),n=Promise.all([i,this.viewRenderPromise]),o=new Promise(e=>setTimeout(e,1e4));return Promise.race([n,o]).then()}isInline(){return"inline"===this.display}get Focusable(){return this}giveFocus(){return this.viewRef.current?.focus(),this.isFocused()}isFocused(){return!!this.element&&this.element.contains(document.activeElement)}setHostFocusCallback(e){this.moveFocusToHost=e}get ComponentRemovable(){return this}setComponentRemover(e){this.removerCallback=e,this.buildShortcutsHierarchy()}get KeyboardShortcutEmitter(){return this}setShortcuts(e){this.hostKeyboardShortcuts=e,this.buildShortcutsHierarchy()}addUserActivityBaseEventListeners(){this.element instanceof HTMLIFrameElement?(this.element.contentWindow?.addEventListener("focus",this.userActivityBaseEventHandler,{capture:!0,once:!0}),this.element.contentWindow?.addEventListener("scroll",this.userActivityBaseEventHandler,{capture:!0,once:!0}),this.element.contentWindow?.addEventListener("click",this.userActivityBaseEventHandler,{capture:!0,once:!0})):(this.element?.addEventListener("focus",this.userActivityBaseEventHandler,{capture:!0,once:!0}),this.element?.addEventListener("scroll",this.userActivityBaseEventHandler,{capture:!0,once:!0}),this.element?.addEventListener("click",this.userActivityBaseEventHandler,{capture:!0,once:!0}))}removeHostingElementBaseEventListeners(){this.element instanceof HTMLIFrameElement?(this.element.contentWindow?.removeEventListener("focus",this.userActivityBaseEventHandler,{capture:!0}),this.element.contentWindow?.removeEventListener("scroll",this.userActivityBaseEventHandler,{capture:!0}),this.element.contentWindow?.removeEventListener("click",this.userActivityBaseEventHandler,{capture:!0})):(this.element?.removeEventListener("focus",this.userActivityBaseEventHandler,{capture:!0}),this.element?.removeEventListener("scroll",this.userActivityBaseEventHandler,{capture:!0}),this.element?.removeEventListener("click",this.userActivityBaseEventHandler,{capture:!0}))}addUserActivitySourcedIframeEventListeners(){this.addUserActivityBaseEventListeners(),this.element instanceof HTMLIFrameElement?this.element.contentWindow?.addEventListener("mouseleave",this.userActivityEventHandlerMouseLeave,{capture:!1}):this.element?.addEventListener("mouseleave",this.userActivityEventHandlerMouseLeave,{capture:!1})}get UserActivityProvider(){return this}buildShortcutsHierarchy(){this.keydownShortcuts=T(this.getKeydownShortcuts(),this.hostKeyboardShortcuts,"keydown"),this.keyupShortcuts=T([],this.hostKeyboardShortcuts,"keyup"),this.keypressShortcuts=T([],this.hostKeyboardShortcuts,"keypress")}getKeydownShortcuts(){return e=this.clipboardProvider,t=e=>this.moveFocusToHost?.(e),i=this.ComponentSelection.moveSelectionToHost,n=this.openLinkCallback,o=this.removerCallback?()=>this.removerCallback?.(this):void 0,[{handler:()=>{t("forward")},keyboardShortcutDescription:{key:"Tab",isOverride:!0,type:"keydown"}},{handler:()=>{t("backward")},keyboardShortcutDescription:{key:"Tab",shiftKey:!0,isOverride:!0,type:"keydown"}},{handler:e=>{n(!1,e)},keyboardShortcutDescription:{key:"Enter",isOverride:!0,type:"keydown"}},{handler:e=>{n(!1,e)},keyboardShortcutDescription:{key:" ",isOverride:!0,type:"keydown"}},{handler:()=>{i(y.S.left)},keyboardShortcutDescription:{key:"ArrowLeft",isOverride:!0,type:"keydown"}},{handler:()=>{i(y.S.left)},keyboardShortcutDescription:{ctrlKey:!0,key:"ArrowLeft",isOverride:!0,type:"keydown"}},{handler:()=>{i(y.S.up)},keyboardShortcutDescription:{key:"ArrowUp",isOverride:!0,type:"keydown"}},{handler:()=>{i(y.S.up)},keyboardShortcutDescription:{ctrlKey:!0,key:"ArrowUp",isOverride:!0,type:"keydown"}},{handler:()=>{i(y.S.right)},keyboardShortcutDescription:{key:"ArrowRight",isOverride:!0,type:"keydown"}},{handler:()=>{i(y.S.right)},keyboardShortcutDescription:{ctrlKey:!0,key:"ArrowRight",isOverride:!0,type:"keydown"}},{handler:()=>{i(y.S.down)},keyboardShortcutDescription:{key:"ArrowDown",isOverride:!0,type:"keydown"}},{handler:()=>{i(y.S.down)},keyboardShortcutDescription:{ctrlKey:!0,key:"ArrowDown",isOverride:!0,type:"keydown"}},{keyboardShortcutDescription:{key:"Home",type:"keydown"},handler:()=>i(y.S.lineBegin)},{keyboardShortcutDescription:{key:"End",type:"keydown"},handler:()=>i(y.S.lineEnd)},{keyboardShortcutDescription:{key:"PageUp",type:"keydown"},handler:()=>i(y.S.pageUp)},{keyboardShortcutDescription:{key:"PageDown",type:"keydown"},handler:()=>i(y.S.pageDown)},{handler:async()=>{await w(e.getComponentTextForClipboard(),e.getComponentHtmlForClipboard()?.outerHTML)},keyboardShortcutDescription:{key:"c",ctrlKey:!0,isOverride:!0,type:"keydown"}}].concat(o?[{handler:()=>{t("backward"),o()},keyboardShortcutDescription:{key:"Backspace",isOverride:!0,type:"keydown"}},{handler:()=>{t("backward"),o()},keyboardShortcutDescription:{key:"Delete",isOverride:!0,type:"keydown"}}]:[]);var e,t,i,n,o}get ComponentLifecycle(){return this}get Lifecycle(){return this}setReadonly(e){this.isReadonly=e,this.emit("readonlyChanged",e)}get disposed(){return this.disposeCalled}get RenderStageEmitter(){return this}}const _=1,W=2;var $=i(52195),z=i(94040),O=i(90140);O.Ve.PinkRed10,O.Ve.Red20,O.Ve.Red10,O.Ve.RedOrange10,O.Ve.Orange30,O.Ve.Orange20,O.Ve.Orange10,O.Ve.Yellow20,O.Ve.Yellow10,O.Ve.OrangeYellow20,O.Ve.OrangeYellow10,O.Ve.YellowGreen10,O.Ve.Green20,O.Ve.Green10,O.Ve.GreenCyan10,O.Ve.Cyan30,O.Ve.Cyan20,O.Ve.Cyan10,O.Ve.CyanBlue20,O.Ve.CyanBlue10,O.Ve.Blue10,O.Ve.BlueMagenta30,O.Ve.BlueMagenta20,O.Ve.BlueMagenta10,O.Ve.Magenta20,O.Ve.Magenta10,O.Ve.MagentaPink20,O.Ve.MagentaPink10,O.Ve.Gray430,O.Ve.Gray180,O.Ve.Gray130,O.Ve.Gray100,O.Ve.Gray80,O.Ve.Gray70,O.Ve.Gray50,O.Ve.Gray40,O.Ve.Gray30,O.Ve.Gray20,O.Ve.Gray10,O.Ve.Gray4,O.Ve.Gray6,O.Ve.Gray5,O.Ve.Gray1,O.Ve.Away,O.Ve.DoNotDisturb,O.Ve.Online,O.Ve.Invisible,O.Ve.OutOfOffice,O.Ve.Warning,O.Ve.WarningIcon,O.Ve.SevereWarning,O.Ve.SevereWarningIcon,O.Ve.ErrorBlock,O.Ve.ErrorBlockIcon,O.Ve.ErrorBackground,O.Ve.ErrorBoxBackground,O.Ve.ErrorText,O.Ve.InfoText,O.Ve.DarkErrorBlock,O.Ve.DarkGrayErrorBackground,O.Ve.RedErrorText,O.Ve.GrayIcon,O.Ve.Success,O.Ve.SuccessIcon,O.Ve.themeDarker,O.Ve.themeDark,O.Ve.themeDarkAlt,O.Ve.themePrimary,O.Ve.themeSecondary,O.Ve.themeTertiary,O.Ve.themeLight,O.Ve.themeLighter,O.Ve.themeLighterAlt;const q={black:`var(${O.Ve.black}, #000000)`,neutralDark:`var(${O.Ve.neutralDark}, #201F1E)`,neutralPrimary:`var(${O.Ve.neutralPrimary}, #323130)`,neutralPrimaryAlt:`var(${O.Ve.neutralPrimaryAlt}, #3B3A39)`,neutralSecondary:`var(${O.Ve.neutralSecondary}, #605e5c)`,neutralSecondaryAlt:`var(${O.Ve.neutralSecondaryAlt}, #8A8886)`,neutralTertiary:`var(${O.Ve.neutralTertiary}, #A19F9D)`,neutralTertiaryAlt:`var(${O.Ve.neutralTertiaryAlt}, #C8C6C4)`,neutralQuaternary:`var(${O.Ve.neutralQuaternary}, #D2D0CE)`,neutralQuaternaryAlt:`var(${O.Ve.neutralQuaternaryAlt}, #E1DFDD)`,neutralQuaternaryAlt2:`var(${O.Ve.neutralQuaternaryAlt2}, #E0E0E0)`,neutralLight:`var(${O.Ve.neutralLight}, #EDEBE9)`,neutralLightAlt:`var(${O.Ve.neutralLightAlt}, #F5F5F5)`,neutralLighter:`var(${O.Ve.neutralLighter}, #F3F2F1)`,neutralLighterAlt:`var(${O.Ve.neutralLighterAlt}, #FAF9F8)`,white:`var(${O.Ve.white}, #FFFFFF)`},K=(O.Ve.yellowDark,O.Ve.yellow,O.Ve.yellowLight,O.Ve.orange,O.Ve.orangeLight,O.Ve.orangeLighter,O.Ve.redDark,O.Ve.red,O.Ve.magentaDark,O.Ve.magenta,O.Ve.magentaLight,O.Ve.purpleDark,O.Ve.purple,O.Ve.purpleLight,O.Ve.blueDark,O.Ve.blueMid,O.Ve.blue,O.Ve.blueAlt,O.Ve.blueLight,O.Ve.tealDark,O.Ve.teal,O.Ve.tealLight,O.Ve.greenDark,O.Ve.green,O.Ve.greenLight,O.Ve.SuggestionAcceptedBackground,O.Ve.SpellingSuggestionHoverHighlight,O.Ve.SpellingHoverTextColor,O.Ve.neutralPrimary,O.Ve.GrammarSuggestionHoverHighlight,O.Ve.GrammarHoverTextColor,O.Ve.neutralPrimary,O.Ve.HeadingDetectedHoverHighlight,O.Ve.HeadingDetectedHoverTextColor,O.Ve.neutralPrimary,O.Ve.EntityRecognitionUnderline,z.be.colorNeutralBackground7,O._D.TextSelectionBackgroundHovered,O.Ve.neutralPrimary,O.Ve.EntityRecognitionHoverTextColor,O.Ve.neutralPrimary,O.Ve.TaskRecognitionUnderline,O.Ve.TaskRecognitionHoverHighlight,O.Ve.TaskRecognitionHoverTextColor,O.Ve.neutralPrimary,O._D.BodyBackgroundWithAlpha,"Canvas"),Z="CanvasText",G="ButtonText",J="Highlight",X="HighlightText",Q="sans-serif",Y="Segoe UI",ee="Segoe UI Emoji",te=`var(${z.Jf.colorNeutralBackground4}, ${q.neutralLight})`,ie=`var(${z.Jf.colorNeutralBackground4Hover}, ${q.neutralLighter})`,ne=`var(${z.Jf.colorNeutralForeground1}, ${q.neutralPrimary})`,oe=`var(${z.Jf.colorStrokeFocus2}, var(${O.KM.FocusBorder}, ${q.neutralSecondaryAlt}))`,re=`var(${z.RC.fontFamilyBase}, var(${O.Fq.FontFamilyBody}, ${Y}, ${Q}))`,ae="100px",se=`var(${z.Jf.colorBrandBackground}, #8761F7)`,le=`var(${z.Jf.colorBrandBackground2}, #E1D4FC)`,de={circle:{borderTopColor:se,borderBottomColor:le,borderLeftColor:le,borderRightColor:le}},ce="@media (forced-colors: active)",he={forcedColorAdjust:"none",MsHighContrastAdjust:"none"},ue=`var(${z.Jf.colorNeutralBackground2}, ${q.neutralLighterAlt})`,me=`var(${z.Jf.colorNeutralBackground2Hover}, ${q.neutralLighter})`,pe=`var(${z.Jf.colorNeutralBackground2Selected}, ${q.neutralLight})`,ge=`var(${z.Jf.colorNeutralForeground2}, ${q.neutralPrimaryAlt})`,ve=`var(${z.Jf.colorNeutralStroke2}, ${q.neutralQuaternaryAlt})`,fe=(0,$.Zq)({"::selection":{background:"transparent !important"}}),ye=(0,$.Zq)({[ce]:{color:"inherit",...he}}),Ce=(0,$.Zq)(fe,{width:"100%",objectFit:"contain",color:ne},ye),xe=Ce,we=(0,$.Zq)(Ce),ke=(0,p.J)(e=>(0,$.Zq)({display:"flex",flex:"0 0 20px",overflow:"hidden"})),be=(0,p.J)(e=>(0,$.Zq)({fontFamily:re,fontWeight:600,fontSize:"14px",lineHeight:"20px",color:ne,whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},ye,fe)),Se=(0,p.J)(e=>(0,$.Zq)({display:"flex",flexDirection:"row",columnGap:"10px",alignContent:"center",alignItems:"center",height:"20px",overflow:"hidden"})),Pe=(0,p.J)(e=>(0,$.Zq)({color:ge,fontFamily:re,fontSize:"12px",height:"32px",lineHeight:"16px",textOverflow:"ellipsis",overflow:"hidden",backgroundClip:"text",display:"-webkit-box","-webkit-line-clamp":"2","-webkit-box-orient":"vertical",wordWrap:"break-word"},ye,fe)),Le=(0,$.Zq)({height:"8px",width:"100%",borderRadius:"100px",overflow:"hidden"},ye),Fe=(0,$.Zq)({height:"8px",width:"calc(100% - 40px)",borderRadius:"100px",overflow:"hidden"},ye),Te=(0,p.J)(e=>(0,$.Zq)({display:"flex",flexDirection:"column",gridRowGap:"8px",height:"32px",overflow:"hidden",alignContent:"center",justifyContent:"space-evenly"})),Ne=(0,p.J)(e=>(0,$.Zq)({zIndex:10,backgroundClip:"text"})),Ae=(0,p.J)(e=>(0,$.Zq)({textDecoration:"none",color:ge,fontFamily:re,fontSize:"10px",height:"14px",lineHeight:"14px",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},ye,fe)),He=(0,p.J)(e=>{let t={};switch(e){case"Third":case"Half":t={marginRight:"10px",marginBottom:"16px"};break;case"Full":t={marginRight:"20px",marginBottom:"16px"}}return(0,$.Zq)({display:"flex",flex:"1 1 auto",flexDirection:"column",gridRowGap:"8px",marginLeft:"16px",marginTop:"20px",minHeight:"30px",overflow:"hidden",...t})}),Be=(0,p.J)(e=>(0,$.Zq)({position:"relative",display:"flex",width:"100%",objectFit:"cover",flex:"0 0 auto"})),Ve=(0,p.J)(e=>(0,$.Zq)({position:"relative",display:"flex",width:"100%",height:"100%",objectFit:"cover",objectPosition:"center",flex:"1 1 auto"})),De=(0,p.J)(e=>(0,$.Zq)({position:"absolute",display:"flex",flexDirection:"column",background:"#FFFFFF",width:"calc(100% - 4px)",height:"Loading"===e?"180px":"calc(100% + 4px)",margin:"2px",borderRadius:"8px",boxSizing:"border-box",boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)",overflow:"hidden",selectors:{[ce]:{border:`1px solid ${Z}`,boxShadow:"none",...he}}})),Re=(0,p.J)(e=>{let t={};switch(e){case"Third":case"Half":t={flex:"0 0 131px",marginLeft:"10px",marginRight:"10px",marginTop:"5px",justifyContent:"center"};break;case"Full":t={flex:"0 0 180px",marginLeft:"20px",marginRight:"24px",marginTop:"28px"}}return(0,$.Zq)({position:"relative",display:"flex",overflow:"hidden",...t})}),Ee=(0,p.J)((e,t,i)=>{let n={},o="100%";switch(e){case"Third":case"Half":n={flexDirection:"column"};break;case"Full":n={flexDirection:"row"},i&&(o="60%")}return(0,$.Zq)({position:"relative",display:"flex",justifyContent:"space-between",background:ue,border:`1px solid ${ve}`,borderRadius:"8px",boxSizing:"border-box",width:"100%",height:"calc(100% - 16px)",marginTop:"8px",marginBottom:"8px",order:0,cursor:"Loading"===t?"progress":"pointer","& a":{textDecoration:"none",width:o,position:"relative"},selectors:{[ce]:{backgroundColor:K,color:Z,...he,"& a":{color:"inherit"}},":hover":{background:me,selectors:{[ce]:{color:X,backgroundColor:J,...he}}},":focus":{background:ue,border:`1px solid ${oe}`,boxShadow:`0px 0px 0px 1px ${oe}`,outline:"none",selectors:{[ce]:{background:K,boxShadow:`0px 0px 0px 1px ${J}`,borderColor:J,outlineColor:J,...he}}},":focus:hover":{background:me,selectors:{[ce]:{color:X,backgroundColor:J,...he}}},":active":{background:pe,selectors:{[ce]:{background:K,borderColor:J,...he}}}},...n})}),Ie=(0,p.J)(e=>(0,$.Zq)({width:"24px",height:"24px",background:"#FFFFFF",boxShadow:"0px 1px 2px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)",borderRadius:"100px",color:"#7635FF",overflow:"hidden",selectors:{":hover":{background:me,color:"#7635FF",selectors:{[ce]:{border:`1px solid ${Z}`,boxShadow:"none",color:G,...he}}},":active":{background:"#E0E0E0",color:"#7635FF",selectors:{[ce]:{border:`1px solid ${Z}`,boxShadow:`0px 0px 0px 2px ${J}`,color:G,...he}}},":focus":{background:"#FFFFFF",boxShadow:"0px 0px 0px 2px #F5F0FF",selectors:{[ce]:{boxShadow:`0px 0px 0px 2px ${J}`,border:`1px solid ${Z}`,...he}}},"::after":{outline:"none !important"},[ce]:{border:`1px solid ${Z}`,boxShadow:"none",color:G,...he}}})),Me=(0,p.J)(e=>(0,$.Zq)({position:"absolute",left:"calc(100% - 24px)",top:"24px"})),je=function(e){let t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i="138px";if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])){if(!t)return"92px";if("Full"!==e)return i}return"Full"!==e?t?"270px":"230px":i},Ue=(0,p.J)((e,t,i,n)=>{const o=je(e,i,n);let r="768px";return"Unauthed"===t&&(r="712px"),(0,$.Zq)({position:"relative",width:"100%",height:o,maxWidth:r,overflow:"visible",display:"inline-block"})}),_e=`var(${z.RC.fontFamilyBase}, var(${O.Fq.FontFamilyBody}, ${Y}, ${ee}, ${Q}))`,We=`var(${z.Jf.colorNeutralForeground1}, var(${O.KM.BodyText}, ${q.neutralPrimary}))`,$e={fontFamily:{customPropertyName:z.RC.fontFamilyBase,fallbackValue:_e},fontSize:{customPropertyName:O.Fq.FontSizeBody,fallbackValue:`var(${z.kZ.fontSizeBase300}, 14px)`},fontWeight:{customPropertyName:z.hW.fontWeightRegular,fallbackValue:`var(${O.Fq.FontWeightBody}, 400)`},color:{customPropertyName:O.KM.BodyText,fallbackValue:`var(${z.Jf.colorNeutralForeground1}, ${q.neutralPrimary})`},lineHeight:{customPropertyName:O.PB.LineHeightBody,fallbackValue:`var(${z.RG.lineHeightBase400}, 20px)`},outline:{customPropertyName:O.PB.OutlineBody},backgroundColor:{customPropertyName:z.Jf.colorNeutralBackground1,fallbackValue:`var(${O.KM.BodyBackground}, transparent)`}},ze=`var(${$e.fontSize.customPropertyName}, ${$e.fontSize.fallbackValue})`;O.Fq.FontFamilyHeading1,O.Fq.FontSizeHeading1,z.kZ.fontSizeHero800,z.hW.fontWeightSemibold,O.Fq.FontWeightHeading1,O.Ve.HeadingText,O.PB.MarginTopHeading1,O.PB.MarginBottomHeading1,O.PB.LineHeightHeading1,z.RG.lineHeightHero800,O.PB.OutlineHeading1,z.Jf.colorNeutralBackground1,O.KM.BodyBackground,O.Fq.FontFamilyHeading2,O.Fq.FontSizeHeading2,z.kZ.fontSizeBase600,z.hW.fontWeightSemibold,O.Fq.FontWeightHeading2,O.Ve.HeadingText,O.PB.MarginTopHeading2,O.PB.MarginBottomHeading2,O.PB.LineHeightHeading2,z.RG.lineHeightBase600,O.PB.OutlineHeading2,z.Jf.colorNeutralBackground1,O.KM.BodyBackground,O.Fq.FontFamilyHeading3,O.Fq.FontSizeHeading3,z.kZ.fontSizeBase500,z.hW.fontWeightSemibold,O.Fq.FontWeightHeading3,O.Ve.HeadingText,O.PB.MarginTopHeading3,O.PB.MarginBottomHeading3,O.PB.LineHeightHeading3,z.RG.lineHeightBase500,O.PB.OutlineHeading3,z.Jf.colorNeutralBackground1,O.KM.BodyBackground,O.Fq.FontSizeHeading4,z.kZ.fontSizeBase400,z.hW.fontWeightSemibold,O.Ve.HeadingText,O.PB.MarginTopHeading4,O.PB.MarginBottomHeading4,O.PB.LineHeightHeading4,z.RG.lineHeightBase400,O.PB.OutlineHeading4,z.Jf.colorNeutralBackground1,O.KM.BodyBackground,O.Fq.FontSizeHeading5,z.kZ.fontSizeBase300,z.hW.fontWeightSemibold,O.Ve.HeadingText,O.PB.MarginTopHeading5,O.PB.MarginBottomHeading5,O.PB.LineHeightHeading5,z.RG.lineHeightBase400,O.PB.OutlineHeading5,z.Jf.colorNeutralBackground1,O.KM.BodyBackground,O.Fq.FontSizeHeading6,z.kZ.fontSizeBase300,O.Ve.HeadingText,O.PB.MarginTopHeading6,O.PB.MarginBottomHeading6,O.PB.LineHeightHeading6,z.RG.lineHeightBase400,O.PB.OutlineHeading6,z.Jf.colorNeutralBackground1,O.KM.BodyBackground;var Oe=i(13261);const qe=(0,$.Zq)({fontFamily:re,color:ne,fontSize:ze,backgroundColor:"transparent","&:link,&:visited,&:hover,&:focus,&:active":{textDecoration:"none",color:"inherit",":hover":{color:ne,[ce]:{color:X}},[ce]:{...he}}}),Ke=(0,$.Zq)(qe,{width:"100%",color:"inherit",":focus":{textDecoration:"none",borderRadius:ae,outline:`${Oe.L.strokeWidthThick} solid`,outlineColor:Oe.L.colorStrokeFocus2,[ce]:{outlineColor:J,...he}},display:"inline-flex",alignItems:"baseline",textAlign:"left",fontStyle:"normal",fontWeight:"400",selectors:{[ce]:{...he}}}),Ze=(0,p.J)(e=>(0,$.Zq)({width:"100%",display:"inline-flex",alignItems:"baseline",lineHeight:`var(${O.PB.LineHeightBody}, normal)`,maxHeight:`var(${O.PB.LineHeightBody}, 22px)`,paddingInline:"6px",cursor:"pointer",userSelect:"none",backgroundColor:te,color:ne,borderRadius:ae,border:e?"none":`${Oe.L.strokeWidthThin} solid ${Oe.L.colorNeutralForeground4}`,selectors:{[ce]:{backgroundColor:K,color:Z,...he}},":hover":{border:`${Oe.L.strokeWidthThin} solid ${Oe.L.colorNeutralForeground4}`,backgroundColor:ie,selectors:{[ce]:{color:X,backgroundColor:J,...he}}}})),Ge=(0,$.Zq)(qe,{display:"inline",textAlign:"left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"324px",paddingInlineEnd:"4px",alignItems:"center",objectFit:"contain",selectors:{"::selection":{background:"transparent !important"},[ce]:{...he}}}),Je=(0,$.Zq)({objectFit:"contain",height:"100%",width:"100%"}),Xe=(0,$.Zq)({objectFit:"contain",display:"flex!important"}),Qe=(0,$.Zq)({width:ze,height:ze,alignSelf:"center",paddingRight:"4px",paddingLeft:"2px",flexShrink:"0",marginBottom:"0.1em",marginTop:"0.1em",display:"inline-table"}),Ye=(0,$.Zq)(Qe,{fontSize:"0px",display:"flex"}),et=(0,$.Zq)({});var tt=i(72955),it=i(40488),nt=i(57433);const ot="Link",rt="Card";const at="CanvasText",st=(0,$.Zq)({fill:"#F25022",selectors:{[ce]:{fill:at,...he}}}),lt=(0,$.Zq)({fill:"#80BA01",selectors:{[ce]:{fill:at,...he}}}),dt=(0,$.Zq)({fill:"#FFB902",selectors:{[ce]:{fill:at,...he}}}),ct=(0,$.Zq)({fill:"#02A4EF",selectors:{[ce]:{fill:at,...he}}}),ht=function(e){return(0,g.jsxs)("svg",{width:20,height:20,fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,"aria-hidden":"true",children:[(0,g.jsx)("path",{className:st,d:"M2 2h7v7H2z"}),(0,g.jsx)("path",{className:lt,d:"M11 2h7v7h-7z"}),(0,g.jsx)("path",{className:dt,d:"M11 11h7v7h-7z"}),(0,g.jsx)("path",{className:ct,d:"M2 11h7v7H2z"})]})},ut="UNFURL_CARD_ID_ICON",mt=e=>({type:"element",element:e}),pt=(e,t)=>{switch(e.type){case"image":return(0,g.jsx)("img",{className:t.logoClassName,src:e.source,alt:"","data-automation-id":ut,"data-testid":ut});case"icon":return(0,g.jsx)(tt.l8,{iconName:e.name,className:t.svgLogoClassName,"data-automation-id":ut,"data-testid":ut});case"element":return e.element}},gt=(e,t,i,r)=>{const a=t===rt?n:o;return 1===i||"Loading"===e?(0,g.jsx)(it.y,{className:a.spinnerStyle,size:nt.H.small,styles:de}):!r||"Unauthed"!==e&&i?i?pt(i,a):(0,g.jsx)(ht,{className:a.svgLogoClassName}):pt(r,a)};var vt=i(9442);const ft=e=>{const t=e.cardState??"Loaded",i=Ze("Loading"===t),n="Loading"===t?e.loadingText:"Unauthed"===t?e.unauthedText:e.title,o=v.useCallback(()=>{e.parentRef?.current?.focus()},[e.parentRef]),r=gt(t,ot,e.logoSrc,e.unauthedLogoSrc),a=!("img"===r.type);return(0,g.jsx)("div",{className:Ke,tabIndex:0,role:"link",onClick:e.onClick,onContextMenu:e.onClick,onKeyDown:e.onKeyDown,ref:e.parentRef,children:(0,g.jsx)("div",{className:i,"data-testid":"LinkPill-ContainerId",title:`${n}\n${e.link}`,children:(0,g.jsxs)("div",{className:Ke,children:[(0,g.jsx)("div",{className:a?Qe:Ye,"aria-hidden":!0,children:r}),(0,g.jsx)(vt.N,{"data-testid":"LinkPill-LinkId",className:Ge,href:e.link,rel:"noopener noreferrer",onFocus:o,children:(0,g.jsx)("span",{"data-testid":"LinkPill-TitleId",children:n})})]})})})};var yt=i(75923),Ct=i(78769),xt=i(40135);const wt="Canvas",kt=(0,$.Zq)({fill:"#CECECE",selectors:{[ce]:{fill:wt,...he}}}),bt=(0,$.Zq)({fill:"#F7F7F7",selectors:{[ce]:{fill:wt,...he}}}),St=(0,$.Zq)({fill:"none",selectors:{[ce]:{fill:"CanvasText",...he}}}),Pt=function(e){return(0,g.jsxs)("svg",{width:180,height:16,fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,"aria-hidden":"true",children:[(0,g.jsx)("path",{className:kt,d:"M0 0h180v16H0z"}),(0,g.jsx)("g",{filter:"url(#webChromeHeader_svg__filter0_i)",children:(0,g.jsx)("path",{className:bt,d:"M0 8h180v8H0z"})}),(0,g.jsx)("path",{className:bt,d:"M20 4a2 2 0 012-2h21a2 2 0 012 2v4H20V4z"}),(0,g.jsx)("g",{transform:"translate(-1, 2)",children:(0,g.jsx)("path",{className:St,d:"M20 5v1h1V5h-1zM0 5V4h-1v1h1zm0 8h-1v1h1v-1zm180 0v1h1v-1h-1zm0-8h1V4h-1v1zM45 5h-1v1h1V5zM21 2a1 1 0 011-1v-2a3 3 0 00-3 3h2zm0 3V2h-2v3h2zM0 6h20V4H0v2zm1 7V5h-2v8h2zm179-1H0v2h180v-2zm-1-7v8h2V5h-2zM45 6h135V4H45v2zm-1-4v3h2V2h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM22 1h21v-2H22v2z"})}),(0,g.jsx)("defs",{children:(0,g.jsxs)("filter",{id:"webChromeHeader_svg__filter0_i",x:0,y:8,width:180,height:8,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,g.jsx)("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),(0,g.jsx)("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),(0,g.jsx)("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,g.jsx)("feOffset",{dy:-.5}),(0,g.jsx)("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:-1,k3:1}),(0,g.jsx)("feColorMatrix",{values:"0 0 0 0 0.882353 0 0 0 0 0.882353 0 0 0 0 0.882353 0 0 0 1 0"}),(0,g.jsx)("feBlend",{in2:"shape",result:"effect1_innerShadow"})]})})]})};var Lt=i(11660),Ft=i(24369),Tt=i(13706),Nt=i(50840),At=i(95225);const Ht=function(e){return(0,g.jsx)("svg",{width:"1em",height:"1em",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,g.jsx)("path",{d:"M6.25 10a1.25 1.25 0 11-2.5 0 1.25 1.25 0 012.5 0zm5 0a1.25 1.25 0 11-2.5 0 1.25 1.25 0 012.5 0zM15 11.25a1.25 1.25 0 100-2.5 1.25 1.25 0 000 2.5z"})})},Bt=e=>{let{className:t}=e;return(0,g.jsxs)("svg",{width:"28",height:"29",viewBox:"0 0 28 29",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[(0,g.jsxs)("g",{filter:"url(#filter0_dd)",children:[(0,g.jsx)("rect",{x:"2",y:"2",width:"24",height:"24",rx:"12",fill:"white"}),(0,g.jsx)("path",{d:"M14 8C17.3137 8 20 10.6863 20 14C20 15.6772 18.8661 17 17.5 17C16.748 17 16.2155 16.6446 15.89 16.0146C15.4563 16.6143 14.8056 17 14 17C12.4709 17 11.5 15.6104 11.5 14C11.5 12.3896 12.4709 11 14 11C14.5919 11 15.1002 11.2082 15.5009 11.5569L15.5 11.5C15.5 11.2239 15.7239 11 16 11C16.2455 11 16.4496 11.1769 16.4919 11.4101L16.5 11.5V14C16.5 15.3628 16.8534 16 17.5 16C18.2767 16 19 15.1562 19 14C19 11.2386 16.7614 9 14 9C11.2386 9 9 11.2386 9 14C9 16.7614 11.2386 19 14 19C14.4161 19 14.8249 18.9493 15.2202 18.8502L15.514 18.7668L15.719 18.6968C15.9784 18.6019 16.2655 18.7351 16.3605 18.9944C16.4554 19.2537 16.3222 19.5409 16.0628 19.6358C15.9814 19.6657 15.8992 19.6937 15.8164 19.72C15.2338 19.9049 14.623 20 14 20C10.6863 20 8 17.3137 8 14C8 10.6863 10.6863 8 14 8ZM14 12C13.1156 12 12.5 12.8811 12.5 14C12.5 15.1189 13.1156 16 14 16C14.8844 16 15.5 15.1189 15.5 14C15.5 12.8811 14.8844 12 14 12Z",fill:"#7635FF"})]}),(0,g.jsx)("defs",{children:(0,g.jsxs)("filter",{id:"filter0_dd",x:"0",y:"0",width:"28",height:"29",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,g.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,g.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,g.jsx)("feOffset",{}),(0,g.jsx)("feGaussianBlur",{stdDeviation:"1"}),(0,g.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.12 0"}),(0,g.jsx)("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow"}),(0,g.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,g.jsx)("feOffset",{dy:"1"}),(0,g.jsx)("feGaussianBlur",{stdDeviation:"1"}),(0,g.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.14 0"}),(0,g.jsx)("feBlend",{mode:"normal",in2:"effect1_dropShadow",result:"effect2_dropShadow"}),(0,g.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect2_dropShadow",result:"shape"})]})})]})},Vt=(0,$.Zq)({display:"flex"});const Dt=e=>e;!function(e){const{icons:t}=e,i={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none",display:"flex",alignItems:"center"},icons:t};(0,$.qM)({disableWarnings:!0}),(0,$.K1)(i)}({icons:{FFXMoreHorizontal:(0,g.jsx)(Ht,{className:Vt}),FFXAtMention:(0,g.jsx)(Bt,{className:Vt})}});const Rt=(0,$.Zq)({display:"flex",alignItems:"center",justifyContent:"center"}),Et=(It="#808080",(0,$.Zq)({selectors:{":hover, :active":{color:"#712DFF"}},borderRadius:6},Rt,{color:It}));var It;Dt("FFXMoreHorizontal");const Mt={iconName:Dt("FFXAtMention"),className:Et};var jt=i(56851),Ut=i(66783),_t=(0,Ut.J9)(function(e,t,i,n){return{root:(0,$.Zq)(e.__shadowConfig__,"ms-ActivityItem",t,e.root,n&&e.isCompactRoot),pulsingBeacon:(0,$.Zq)(e.__shadowConfig__,"ms-ActivityItem-pulsingBeacon",e.pulsingBeacon),personaContainer:(0,$.Zq)(e.__shadowConfig__,"ms-ActivityItem-personaContainer",e.personaContainer,n&&e.isCompactPersonaContainer),activityPersona:(0,$.Zq)(e.__shadowConfig__,"ms-ActivityItem-activityPersona",e.activityPersona,n&&e.isCompactPersona,!n&&i&&2===i.length&&e.doublePersona),activityTypeIcon:(0,$.Zq)(e.__shadowConfig__,"ms-ActivityItem-activityTypeIcon",e.activityTypeIcon,n&&e.isCompactIcon),activityContent:(0,$.Zq)(e.__shadowConfig__,"ms-ActivityItem-activityContent",e.activityContent,n&&e.isCompactContent),activityText:(0,$.Zq)(e.__shadowConfig__,"ms-ActivityItem-activityText",e.activityText),commentText:(0,$.Zq)(e.__shadowConfig__,"ms-ActivityItem-commentText",e.commentText),timeStamp:(0,$.Zq)(e.__shadowConfig__,"ms-ActivityItem-timeStamp",e.timeStamp,n&&e.isCompactTimeStamp)}}),Wt="32px",$t="16px",zt="16px",Ot="13px",qt=(0,Ut.J9)(function(){return(0,$.i7)({from:{opacity:0},to:{opacity:1}})}),Kt=(0,Ut.J9)(function(){return(0,$.i7)({from:{transform:"translateX(-10px)"},to:{transform:"translateX(0)"}})}),Zt=(0,Ut.J9)(function(e,t,i,n,o,r){var a;void 0===e&&(e=(0,$.O4)());var s={animationName:$.T8.continuousPulseAnimationSingle(n||e.palette.themePrimary,o||e.palette.themeTertiary,"4px","28px","4px"),animationIterationCount:"1",animationDuration:".8s",zIndex:1},l={animationName:Kt(),animationIterationCount:"1",animationDuration:".5s"},d={animationName:qt(),animationIterationCount:"1",animationDuration:".5s"},c={root:[e.fonts.small,{display:"flex",justifyContent:"flex-start",alignItems:"flex-start",boxSizing:"border-box",color:e.palette.neutralSecondary},r&&i&&d],pulsingBeacon:[{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"0px",height:"0px",borderRadius:"225px",borderStyle:"solid",opacity:0},r&&i&&s],isCompactRoot:{alignItems:"center"},personaContainer:{display:"flex",flexWrap:"wrap",minWidth:Wt,width:Wt,height:Wt},isCompactPersonaContainer:{display:"inline-flex",flexWrap:"nowrap",flexBasis:"auto",height:$t,width:"auto",minWidth:"0",paddingRight:"6px"},activityTypeIcon:{height:Wt,fontSize:zt,lineHeight:zt,marginTop:"3px"},isCompactIcon:{height:$t,minWidth:$t,fontSize:Ot,lineHeight:Ot,color:e.palette.themePrimary,marginTop:"1px",position:"relative",display:"flex",justifyContent:"center",alignItems:"center",selectors:{".ms-Persona-imageArea":{margin:"-2px 0 0 -2px",border:"2px solid"+e.palette.white,borderRadius:"50%",selectors:(a={},a[$.up]={border:"none",margin:"0"},a)}}},activityPersona:{display:"block"},doublePersona:{selectors:{":first-child":{alignSelf:"flex-end"}}},isCompactPersona:{display:"inline-block",width:"8px",minWidth:"8px",overflow:"visible"},activityContent:[{padding:"0 8px"},r&&i&&l],activityText:{display:"inline"},isCompactContent:{flex:"1",padding:"0 4px",whiteSpace:"nowrap",textOverflow:"ellipsis",overflowX:"hidden"},commentText:{color:e.palette.neutralPrimary},timeStamp:[e.fonts.tiny,{fontWeight:400,color:e.palette.neutralSecondary}],isCompactTimeStamp:{display:"inline-block",paddingLeft:"0.3em",fontSize:"1em"}},h=t||{},u=h.__shadowConfig__,m=(0,jt.__rest)(h,["__shadowConfig__"]);return u?(0,$.TW)(u,c,m):(0,$.TW)(c,t)}),Gt=i(76115),Jt=i(72721),Xt=function(e){function t(t){var i=e.call(this,t)||this;return i._onRenderIcon=function(e){return e.activityPersonas?i._onRenderPersonaArray(e):i.props.activityIcon},i._onRenderActivityDescription=function(e){var t=i._getClassNames(e),n=e.activityDescription||e.activityDescriptionText;return n?v.createElement("span",{className:t.activityText},n):null},i._onRenderComments=function(e){var t=i._getClassNames(e),n=e.comments||e.commentText;return!e.isCompact&&n?v.createElement("div",{className:t.commentText},n):null},i._onRenderTimeStamp=function(e){var t=i._getClassNames(e);return!e.isCompact&&e.timeStamp?v.createElement("div",{className:t.timeStamp},e.timeStamp):null},i._onRenderPersonaArray=function(e){var t=i._getClassNames(e),n=null,o=e.activityPersonas;if(o[0].imageUrl||o[0].imageInitials){var r=[],a=o.length>1||e.isCompact,s=e.isCompact?3:4,l=void 0;e.isCompact&&(l={display:"inline-block",width:"10px",minWidth:"10px",overflow:"visible"}),o.filter(function(e,t){return t<s}).forEach(function(e,i){r.push(v.createElement(Gt.c,(0,jt.__assign)({},e,{key:e.key||i,className:t.activityPersona,size:a?Jt.WH.size16:Jt.WH.size32,style:l})))}),n=v.createElement("div",{className:t.personaContainer},r)}return n},i}return(0,jt.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.onRenderIcon,i=void 0===t?this._onRenderIcon:t,n=e.onRenderActivityDescription,o=void 0===n?this._onRenderActivityDescription:n,r=e.onRenderComments,a=void 0===r?this._onRenderComments:r,s=e.onRenderTimeStamp,l=void 0===s?this._onRenderTimeStamp:s,d=e.animateBeaconSignal,c=e.isCompact,h=this._getClassNames(this.props);return v.createElement("div",{className:h.root,style:this.props.style},(this.props.activityPersonas||this.props.activityIcon||this.props.onRenderIcon)&&v.createElement("div",{className:h.activityTypeIcon},d&&c&&v.createElement("div",{className:h.pulsingBeacon}),i(this.props)),v.createElement("div",{className:h.activityContent},o(this.props,this._onRenderActivityDescription),a(this.props,this._onRenderComments),l(this.props,this._onRenderTimeStamp)))},t.prototype._getClassNames=function(e){return _t(Zt(void 0,e.styles,e.animateBeaconSignal,e.beaconColorOne,e.beaconColorTwo,e.isCompact),e.className,e.activityPersonas,e.isCompact)},t}(v.Component);const Qt=(0,$.Zq)({paddingTop:"12px",paddingBottom:"12px",paddingLeft:"4px",paddingRight:"4px",cursor:"default",border:"1px solid transparent",selectors:{":hover":{backgroundColor:"#F5F5F5"}}});function Yt(e){return(0,g.jsx)("div",{children:e.activities.map(e=>{let{key:t,...i}=e;return(0,g.jsx)(Xt,{...i,className:Qt},t)})})}const ei={root:{border:`1px solid ${`var(${O.KM.MenuDivider}, #EBEBEB)`}`,boxSizing:"border-box"},content:{position:"relative",color:O._D.TooltipText,backgroundColor:O._D.TooltipBackground,fontFamily:`var(${O.Fq.FontFamilyBody}, ${Y})`,fontSize:"12px",maxHeight:"120px",maxWidth:"400px",overflow:"auto"}},ti=(0,$.Zq)({width:320,borderRadius:4}),ii=e=>{const[t,{setFalse:i,toggle:n}]=(0,At.e)(!1),o=`activityButton_${crypto.randomUUID()}`,r={styles:ei},a=`TooltipId-${crypto.randomUUID()}`;return(0,g.jsxs)("div",{className:Me(e.cardWidth),children:[(0,g.jsx)(Lt.S,{id:a,tooltipProps:r,content:"Click to see recent activity",hidden:t,closeDelay:Ft.H.medium,children:(0,g.jsx)(Tt.K,{id:o,className:Ie(e.cardWidth),onClick:n,iconProps:Mt,role:"button","aria-label":"Activity","aria-describedby":a,"aria-haspopup":"true","aria-expanded":t})}),t&&(0,g.jsx)(Nt.P,{className:ti,gapSpace:0,target:`#${o}`,onDismiss:i,setInitialFocus:!0,role:"status","aria-live":"polite",children:(0,g.jsx)(Yt,{activities:e.activities})})]})},ni=v.memo(e=>{const{cardState:t,cardWidth:i,showWebChromeHeader:n,src:o}=e,r=1===o?undefined:o;return(0,g.jsx)("div",{className:Re(i),"data-automation-id":"UNFURL_CARD_ID_THUMBNAIL","aria-hidden":"true",children:(0,g.jsx)("div",{className:De(t),children:"Loaded"===t&&(0,g.jsxs)(g.Fragment,{children:[n&&(0,g.jsx)(Pt,{className:Be(i)}),(0,g.jsx)("img",{className:Ve(i),src:r,alt:""})]})})})}),oi=v.memo(e=>{const t="Loading"===e.cardState?e.loadingText:"Unauthed"===e.cardState?e.unauthedText:e.title;return(0,g.jsxs)("div",{className:Se(e.cardWidth),children:[(0,g.jsx)("div",{className:ke(e.cardWidth),"aria-hidden":"true",children:gt(e.cardState,rt,e.logoSrc,e.unauthedLogoSrc)}),(0,g.jsx)("span",{title:t,className:be(e.cardWidth),"data-automation-id":"UNFURL_CARD_ID_TITLE",children:t})]})}),ri=v.memo(e=>{const t=[{type:Ct.w.line}],i=[{type:Ct.w.line}];return(0,g.jsx)("div",{className:Ne(e.cardWidth),children:"Loading"===e.cardState||1===e.description?(0,g.jsxs)("div",{className:Te(e.cardWidth),children:[(0,g.jsx)(xt.W,{className:Le,shimmerElements:t}),(0,g.jsx)(xt.W,{className:Fe,shimmerElements:i})]}):"Loaded"===e.cardState?(0,g.jsx)("div",{title:e.description,className:Pe(e.cardWidth),children:e.description}):void 0})}),ai=v.memo(e=>{const t="Unauthed"!==e.cardState&&!!e.description;return(0,g.jsxs)("div",{className:He(e.cardWidth),children:[(0,g.jsx)(oi,{cardWidth:e.cardWidth,cardState:e.cardState,logoSrc:e.logoSrc,title:e.title,unauthedLogoSrc:e.unauthedLogoSrc,loadingText:e.loadingText,unauthedText:e.unauthedText}),(0,g.jsxs)(g.Fragment,{children:[t&&(0,g.jsx)(ri,{cardWidth:e.cardWidth,cardState:e.cardState,description:e.description}),(0,g.jsx)("span",{title:e.fileMetadata,className:Ae(e.cardWidth),children:e.fileMetadata})]})]})}),si=v.memo(e=>{const t=e.cardState??"Loaded",[i,n]=v.useState(e.cardWidth),o="Loading"===t||1===e.thumbnailSrc,r="Loaded"===t&&!!e.thumbnailSrc&&1!==e.thumbnailSrc,a=o||r,s=(0,yt.w)(e=>{const t=e.contentRect.width,i=(o=t)&&o<=500&&o>250?"Half":o&&o<=250?"Third":"Full";var o;n(i)}),l=1===e.description?void 0:e.description;return(0,g.jsxs)("div",{className:Ue(i,t,a,!!e.description),ref:s,children:[(0,g.jsxs)("div",{className:Ee(i,t,a),tabIndex:0,role:"link","aria-describedby":l||e.title||e.link,onClick:e.onClick,onKeyDown:e.onKeyDown,onContextMenu:e.onClick,ref:e.parentRef,"data-automation-id":"UNFURL_CARD_ID_ARIA",children:[(0,g.jsx)("a",{href:e.link,children:(0,g.jsx)(ai,{cardWidth:i,title:e.title,description:e.description,link:e.link,logoSrc:e.logoSrc,fileMetadata:e.fileMetadata,cardState:t,unauthedLogoSrc:e.unauthedLogoSrc,loadingText:e.loadingText,unauthedText:e.unauthedText})}),a&&(0,g.jsx)(ni,{cardWidth:i,cardState:t,showWebChromeHeader:e.showWebChromeHeader,src:e.thumbnailSrc})]}),e.activities&&e.activities.length>0&&"Loaded"===t&&(0,g.jsx)(ii,{cardWidth:i,link:e.link,description:e.description,activities:e.activities})]})});var li=i(3444);const di=v.memo(e=>{const{url:t,metadata:i,logo:n,thumbnail:o,componentState:r,onClick:a,onKeyDown:s,viewMode:l}=e,d=v.useCallback(e=>{a(e)},[a]),c=v.useCallback(e=>{s(e)},[s]),h=function(e,t){if("Init"===e||1===t)return"Loading";if("AccessDenied"===e)return"Unauthed";if("NotFound"===e)return;return"Loaded"}(r,i),u=1===i?t:i?.title??t,m=1===i?t:i?.description??"",p="string"===typeof n?{type:"image",source:n}:n;return"Pill"===l?(0,g.jsx)(ft,{title:u,cardState:h,link:t,logoSrc:p,loadingText:e.loadingText,unauthedText:u,unauthedLogoSrc:mt((0,g.jsx)(li.EEN,{})),onClick:d,onKeyDown:c,parentRef:e.unfurlViewRef}):(0,g.jsx)(si,{title:u,description:m,link:t,thumbnailSrc:o,logoSrc:p,fileMetadata:t,cardWidth:"Full",cardState:h,onClick:d,onKeyDown:c,loadingText:e.loadingText,unauthedText:u,unauthedLogoSrc:mt((0,g.jsx)(li.EEN,{})),parentRef:e.unfurlViewRef})});var ci=i(31360),hi=i(50208);var ui=i(12553),mi=i(98256),pi=i(94664);const gi=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,n=e?.themeProperties??new Map;if(!function(e){return!!e?.themeProperties?.has("--colorNeutralForeground1")}(e)){let e;if(e=i?Object.keys(i).map(e=>({name:"--"+e,value:i[e]})):ui.c,t){const t=(0,mi.P)(n);e=e.concat(t),n=new Map(e.map(e=>[e.name,e.value]))}else n=new Map([...n,...new Map(e.map(e=>[e.name,e.value]))])}const o={};for(const[r,a]of n){o[r.startsWith("--")?r.slice(2):r]=a}return o};class vi{constructor(e,t,i){this.theming=e,this.translateTheme=t,this.parentTheme=i,this.listeners=new Set,this.internalThemePropertiesChangedListener=()=>{this.themeProperties=gi(this.theming,this.translateTheme,this.parentTheme),this.listeners.forEach(e=>e(this.themeProperties,this.theming))},this.themeProperties=gi(e,t,i)}onThemePropertiesChanged(e){return 0===this.listeners.size&&this.theming?.on("themePropertiesChanged",this.internalThemePropertiesChangedListener),this.listeners.add(e),()=>{this.listeners.delete(e),0===this.listeners.size&&this.theming?.off("themePropertiesChanged",this.internalThemePropertiesChangedListener)}}}const fi={},yi=new WeakMap,Ci=new WeakMap;function xi(e){let t;switch(t=e?"themeName"in e?e.themeName:e.themeProperties?.get("--ms-themeColorThemeName"):void 0,t){case"default":return"light";case"dark":return"dark";default:return}}function wi(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const i=(0,v.useRef)(e),n=(0,v.useContext)(pi.D),[o,r]=(0,v.useState)(()=>xi(e)),a=(0,v.useMemo)(()=>function(e,t,i){const n=e??fi,o=t?Ci:yi,r=o.get(n);if(r)return r;const a=new vi(e,t,i);return o.set(n,a),a}(e,t,n),[n,e,t]),[s,l]=(0,v.useState)(()=>a.themeProperties);return e!==i.current&&(i.current=e,l(a.themeProperties),r(xi(e))),(0,v.useEffect)(()=>{if(!e)return;const t=()=>r(xi(e));return e.on("themeNameChanged",t),()=>{e.off("themeNameChanged",t)}},[e]),(0,v.useEffect)(()=>a.onThemePropertiesChanged((e,t)=>{l(e),r(xi(t))}),[a]),[o,s]}function ki(e){let{theming:t,idPrefix:i,translateTheme:n=!0,...o}=e;const[r,a]=wi(t,n),s=v.useMemo(()=>({display:"contents",colorScheme:r,backgroundColor:"transparent",...o.style}),[r,o.style]),l=v.useMemo(()=>{return i+(e=1e4,e<=0?0:Math.floor(Math.random()*e)).toString();var e},[i]);return(0,g.jsx)(ci.LX,{value:l,children:(0,g.jsx)(hi.q,{...o,"data-testid":"ComponentFluentProviderId",theme:a,style:s,className:"loop-host"})})}class bi extends U{constructor(e,t,i,n,o,r,a,s,l,d){super(e,i,n,r,a,l,"GenericLinkUnfurl",!1,d),this.strings=t,this.providers=i,this.metadataPromise=o,this.onTitleDetermined=s,this.viewMode="Card",this.metadata=1,this.logo=1,this.thumbnail=1,this.timerExpired=!1,this.loadingRenderPromise=new I.c}async getCommandStrings(){return{copyLinkCommandDisplayName:this.strings.genericLinkCopyLinkCommandDisplayName,openLinkCommandDisplayName:this.strings.genericLinkOpenLinkCommandDisplayName}}async disposeView(){this.element&&(f.unmountComponentAtNode(this.element),delete this.element,this.providers.NamespaceLogger.send({category:"dispose",eventName:"DisposeView",viewMode:this.viewMode}))}getUrlAsString(){return this.urlData.url.href}async onLocaleUpdated(e){if(this.strings=e,this.element)return this.render(this.element)}convertViewTypeToCommonViewModeType(){switch(this.viewMode){case"Pill":return _;case"Card":return W;default:throw Error("Unknown view mode")}}internalRender(e,t){const i={theming:this.providers.Theming,idPrefix:"genericLinkUnfurl-"};f.render((0,g.jsx)(ki,{...i,children:(0,g.jsx)(di,{unfurlViewRef:this.viewRef,url:this.getUrlAsString(),metadata:this.metadata,logo:this.getLogoSrc(),thumbnail:this.getThumbnailSrc(),componentState:t,onClick:this.onClickHandler,onKeyDown:this.onKeyDownHandler,loadingText:this.strings.genericLinkLoadingText,element:this.element,viewMode:this.viewMode})}),e,()=>this.renderCallback())}async renderView(e){this.viewMode=this.isInline()?"Pill":"Card",this.initializeRenderStageTrackers(),this.renderIncrementally(e).then(()=>{this.timerExpired||(this.endRenderingActivity(this.convertViewTypeToCommonViewModeType()),this.fullUiReadyTracker?.end())}).catch(async e=>{});return setTimeout(async()=>{this.metadata&&1!==this.metadata||(this.timerExpired=!0,this.addAdditionalProps({TimerExpired:!0}),this.internalRender(e,"Found"),this.endRenderingActivity(this.convertViewTypeToCommonViewModeType()))},1e4),this.loadingRenderPromise}async renderIncrementally(e){const t=[this.loadMetadata(),this.loadLogo(),this.loadThumbnail(),this.startWithLoading()];for await(const i of async function*(e,t,i){let n=[];const o=e.map(e=>{const t=e.then(e=>{n.push(e)}).catch(t=>{i?.(e,t)}).finally(()=>{o.splice(o.indexOf(t),1)});return t});for(;o.length>0;)if(await Promise.race(o),t){if(0===n.length)continue;const e=n;n=[],yield e}else for(;n.length>0;){const e=n.shift();yield e}}(t,!0)){const t=this.aggregateStates(i);this.internalRender(e,t)}}async startWithLoading(){return Promise.resolve("Init")}async loadMetadata(){const e=await this.metadataPromise;return this.metadata=await e.metadata,this.onTitleDetermined(this.metadata.title),e.componentState}async loadLogo(){const e=await this.metadataPromise;return this.logo=await e.favicon,e.componentState}async loadThumbnail(){const e=await this.metadataPromise;return this.thumbnail=await e.thumbnail,e.componentState}getLogoSrc(){return void 0===this.logo||1===this.logo?this.logo:this.logo.favicon}getThumbnailSrc(){return void 0===this.thumbnail||1===this.thumbnail?this.thumbnail:this.thumbnail.thumbnail}aggregateStates(e){return e.includes("AccessDenied")?"AccessDenied":e.includes("Unauthed")?"Unauthed":e.includes("NotFound")?"NotFound":e.includes("Found")?"Found":"Init"}renderCallback(){this.loadingRenderPromise.resolve(),this.endRenderingSubActivity(),this.isFirstRender||this.visualReadyTracker?.end()}}var Si=i(12406);let Pi;const Li=e=>i(71663)(`./${e}/GenericLinkStrings.json`);function Fi(e){return function(e,t){return Pi?.locale!==t&&(Pi={locale:t,stringTablePromise:e(t).then(e=>(0,Si.$)(e,t)).catch(e=>{throw Pi=void 0,e})}),Pi.stringTablePromise}(Li,e)}var Ti=i(87624);function Ni(e,t){if(t.includes(e))throw new Error("Invalid parent path: nodeId already exists in parent path.");return[...t,e]}var Ai=i(48680);class Hi{constructor(e,t,i){this.settingsProviderPromise=t,this.augmentationSessionPromise=i,this.hasPathBeenSet=!1,this.componentHasBeenAdded=!1,this.augLoopFullPathPromise=new I.c,this.augmentationSessionContextDeferred=new I.c,this.augLoopId=e.customAugLoopId??crypto.randomUUID(),this.getComponentNode=e.getComponentNode??this.getComponentNodeDefault,this.getComponentDocumentProperties=e.getComponentDocumentProperties??this.getComponentDocumentPropertiesDefault,this.isMovable=!!e.isMovable}get AugmentationSessionContextNode(){return this}get nodeId(){return this.augLoopId}setParentPath(e){this.hasPathBeenSet?this.isMovable&&Promise.all([this.augLoopFullPathPromise,this.augmentationSessionPromise]).then(t=>{let[i,n]=t;const o=Ni(this.augLoopId,e);i.join()!==o.join()&&n&&(this.moveComponentInSessionModel(i,o,n),this.initializeAugLoopFullPath(e,!0))}).catch(()=>{}):this.initializeAugLoopFullPath(e)}moveComponentInSessionModel(e,t,i){i.removeContentNode(this.getContentNode(e)),i.addContentNode(this.getContentNode(t))}queueAddComponentToSessionModel(){this.componentHasBeenAdded||(this.componentHasBeenAdded=!0,Promise.all([this.augmentationSessionContextDeferred,this.augLoopFullPathPromise]).then(e=>{let[t,i]=e;t?this.emitAddOperation(t,i):this.componentHasBeenAdded=!1}).catch(()=>{this.componentHasBeenAdded=!1}))}updateComponentInSessionModel(e){e&&!this.componentHasBeenAdded||Promise.all([this.augmentationSessionContextDeferred,this.augLoopFullPathPromise]).then(e=>{let[t,i]=e;t&&t.updateContentNode(this.getContentNode(i))}).catch(()=>{})}removeComponentFromSessionModel(){Promise.all([this.augmentationSessionContextDeferred,this.augLoopFullPathPromise,this.settingsProviderPromise]).then(e=>{let[t,i,n]=e;t&&(function(e){return(0,Ai.AU)("augloop.clearComponentHasBeenAdded",!0,e)}(n)&&(this.componentHasBeenAdded=!1),t.removeContentNode(this.getContentNode(i)))}).catch(()=>{})}async getFullPath(){return this.augLoopFullPathPromise}getAugLoopId(){return this.augLoopId}signalComponentReadyForAugmentation(){this.hasPathBeenSet||this.initializeAugLoopFullPath(["session"])}getComponentNodeDefault(){return new Ti.rV({componentProperties:this.getComponentDocumentProperties()})}getComponentDocumentPropertiesDefault(){return{}}initializeAugLoopFullPath(e,t){this.hasPathBeenSet=!0,t&&(this.augLoopFullPathPromise=new I.c),this.augLoopFullPathPromise.resolve(Ni(this.augLoopId,e)),this.augmentationSessionContextDeferred.resolve(this.augmentationSessionPromise)}emitAddOperation(e,t){e.addContentNode(this.getContentNode(t))}getContentNode(e){return{parentPath:Bi(e),nodeId:this.augLoopId,body:this.getComponentNode()}}}function Bi(e){return e.slice(0,-1)}var Vi=i(56679),Di=i(97323),Ri=i(52563);class Ei{constructor(e){this.urlData=e,this.getComponentHtmlForClipboard=()=>{const e=document.createElement("a");return e.href=this.urlData.url.href,e.textContent=this.urlData.title??this.urlData.url.href,e.rel="noreferrer noopener",e},this.getComponentTextForClipboard=()=>this.urlData.url.href,this.ComponentClipboardProvider=this}}var Ii=i(34331);class Mi extends(S()){constructor(e,t,i){var n;if(super(),n=this,this.entityName=e,this.aLinkProviders=i,this.openLink=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;if(n.aLinkProviders.UrlHandlerProvider){if(e||!await n.aLinkProviders.UrlHandlerProvider.onClick(n.urlData.url,{},t))return void(0,Vi.M)(n.urlData.url.href)}else n.aLinkProviders.LinkService?await n.aLinkProviders.LinkService.openLink(n.urlData.url.href):(0,Vi.M)(n.urlData.url.href)},this.onRender=e=>{e&&this.addComponentNodeToSessionModel()},this.getComponentNodeDefault=()=>this.linkNode,this.updateComponentNode=e=>{const t=e??this.urlData.url.href;this.linkNode.content!==t&&(this.linkNode=new Ii.Ne({url:this.urlData.url.href,content:t}),this.augLoopSerializableHelpers.updateComponentInSessionModel(!0))},!(0,Di.N)(t.creationData.data.url))throw Error("link is not valid");this.urlData=t.creationData.data,this.ComponentClipboardProvider=new Ei(t.creationData.data),this.contentLocale=(0,Ri.rv)(i.InternationalizationContext?.uiLocale),this.linkNode=new Ii.Ne({url:this.urlData.url.href,content:this.urlData.title??this.urlData.url.href}),this.augLoopSerializableHelpers=new Hi({getComponentNode:this.getComponentNodeDefault.bind(this)},Promise.resolve(i.SettingsProvider),Promise.resolve(i.AugmentationSessionContext))}get ComponentTelemetryMetadata(){return this}get ContentURL(){return this}get ComponentProduceString(){return this}get LoopComponentUrl(){return this}get AugmentationSessionContextNode(){return this.augLoopSerializableHelpers}get Disposable(){return this}async getContentURL(){return this.urlData.url}get ComponentHasContentLocale(){return this}setLocale(e){if(!(0,Ri.Zd)(e))return;const t=(0,Ri.rv)(e);t!==this.contentLocale&&(this.contentLocale=t,this.onLocaleUpdated())}async getString(){return this.urlData.title}async getLoopComponentUrl(){return this.urlData.url}addComponentNodeToSessionModel(){this.augLoopSerializableHelpers.queueAddComponentToSessionModel()}dispose(){this.augLoopSerializableHelpers.removeComponentFromSessionModel()}get ComponentSerializable(){return this}getHtmlAsync(){return Promise.resolve(`<a href="${encodeURI(this.linkNode.url)}" >${function(e){const t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return e.replace(/[&<>"']/g,e=>t[e])}(this.linkNode.content)}</a>`)}async serialize(){return this.getHtmlAsync()}async rehydrate(e){throw new Error("Method not implemented.")}async writeXml(e){return e.startElement("a"),e.writeAttribute("href",this.linkNode.url),e.writeAttribute("style","padding-left: 6px; padding-right: 6px; border: 1px solid #707070; border-radius: 10px; text-decoration: none; background-color: #F0F0F0; color: #242424;"),e.writeText(this.linkNode.content),e.endElement(),Promise.resolve()}}const ji={scopes:["https://urlp-v2.asm.skype.com/URLPreview.Generate"],urlToFetch:"https://urlp.asm.skype.com/v1/url/info"},Ui=1,_i=2,Wi=3,$i=4,zi=1,Oi=2,qi=3;var Ki=i(40635);function Zi(e){return e>=200&&e<300}async function Gi(e,t,i,n,o){let r;try{r=await fetch(e,i)}catch{return void Yi("undefined"!==typeof window&&!window.navigator.onLine?Wi:$i,t,!1,o,n)}if(!r.ok)return void Yi(r.status,t,!1,o,n);const a=await r.blob();return new Promise((e,t)=>{const i=new FileReader;i.onloadend=()=>e(i.result),i.onerror=t,i.readAsDataURL(a)})}function Ji(e){return!!e.statusCode&&Zi(Number(e.statusCode))}async function Xi(e,t,i,n){const o=V.m.start("URLPreviewInfoRequest",n);let r;try{if(!await t)return;r=(await(0,Ki.y)(e)).result}catch{throw Yi(_i,zi,!1,o,i),new Error("URL Preview API failed, likely due to token issue, without making a call")}if(!r.ok&&r.status>=300)throw Yi(r.status,zi,404===r.status,o,i),new Error("URL Preview API returned an error response");const a=function(e,t){const i={url:e.url??t,title:e.title??e.url??t,faviconUri:e.favicon&&tn(e.favicon)?e.favicon:void 0,faviconMeta:e.favicon_meta,thumbnailUri:e.thumbnail&&tn(e.thumbnail)?e.thumbnail:void 0,thumbnailMeta:e.thumbnail_meta,description:e.description,contentType:e.content_type,statusCode:e.status_code,site:e.site,isDataPublic:nn(e)};return i.title=function(e,t){let i=e;if("sign in to your account"===i.toLowerCase()){const e=t.match(/https?:\/\/(?:www\.)?([^\/]+)/);e&&(i=e[1])}return i}(i.title,i.url),i}(await r.json(),e.url);return Ji(a)||o.addAdditionalProps({DataStatusCode:Number(a.statusCode)}),o.setResult(!0),a}function Qi(e,t,i,n,o,r){let a=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],s=!(arguments.length>7&&void 0!==arguments[7])||arguments[7];const l=function(e,t){const i=`?url=${encodeURIComponent(t)}`,n=ji;return{getToken:t=>{if(t)return e.getToken(n.scopes,t);throw Error("Options must be specified")},url:en(n.urlToFetch+i),requestInit:{method:"GET"}}}(e,t.url.href),d=async function(e,t,i){return function(e){return!!e}(e)&&await async function(e,t){if(!e)return!1;try{return await e.optionalConnectedExperiencesEnabled()}catch(i){t&&(0,B.hO)(t,{eventName:"checkOCSError"},i)}return!1}(t,i)}(e,i,o),c=l.getToken({request:{url:l.url,method:l.requestInit?.method?l.requestInit.method:"GET"}}).catch(e=>(o&&(0,B.hO)(o,{eventName:"FailedToFetchToken"},e),n?.addAdditionalProps({FailedToFetchToken:!0}),Promise.reject(e))),h=function(e,t,i,n,o,r){const a={url:t.url.href,title:t.title||t.url.href},s=Xi(e,i,n,o).catch(e=>(n?.setResult(!1,{message:`${_i}: ${e}`},e),a)).then(e=>e??a),l=r?.loadCache();if(l?.metadata)return n?.addAdditionalProps({UsedMetadataCache:!0}),{latest:s,fastest:Promise.resolve(l.metadata)};return{latest:s,fastest:s}}(l,t,d,n,o,r),u=function(e,t,i,n,o,r,a,s){const l=async function(e,t,i,n,o,r,a){if(!e)return void r?.addAdditionalProps({IsFaviconUrlPresent:!1});const s=await t,l=s.faviconMeta;if(!Ji(s)||!s.faviconUri||!l)return void r?.addAdditionalProps({IsFaviconUrlPresent:!1});const{token:d,authorizationHeader:c}=await n,h=await o;if(!d||!h)return void r?.addAdditionalProps({IsFaviconUrlPresent:!1});const u=V.m.start("URLPreviewFaviconRequest",a);try{const e={...i.requestInit,headers:{Authorization:c||`Bearer ${d}`}},t=await Gi(en(s.faviconUri),qi,e,u);if(!t)return;return u.setResult(!0),r?.addAdditionalProps({IsFaviconUrlPresent:!0}),{favicon:t,faviconMeta:l}}catch(m){return void u.setResult(!1,void 0,m)}}(e,t,i,n,o,r,a).catch(()=>{r?.addAdditionalProps({IsFaviconUrlPresent:!1})}),d=s?.loadCache();if(d?.favicon)return r?.addAdditionalProps({UsedFaviconCache:!0}),{latest:l,fastest:Promise.resolve(d.favicon)};return{latest:l,fastest:l}}(s,h.fastest,l,c,d,n,o,r),m=function(e,t,i,n,o,r,a,s){const l=async function(e,t,i,n,o,r,a){if(!e)return void r?.addAdditionalProps({IsThumbnailUrlPresent:!1});const s=await t,l=s.thumbnailMeta;if(!Ji(s)||!s.thumbnailUri||!l)return void r?.addAdditionalProps({IsThumbnailUrlPresent:!1});const{token:d,authorizationHeader:c}=await n,h=await o;if(!d||!h)return void r?.addAdditionalProps({IsThumbnailUrlPresent:!1});const u=V.m.start("URLPreviewThumbnailRequest",a);try{const e={...i.requestInit,headers:{Authorization:c||`Bearer ${d}`}},t=await Gi(en(s.thumbnailUri),Oi,e,u);if(!t)return;return u.setResult(!0),r?.addAdditionalProps({IsThumbnailUrlPresent:!0}),{thumbnail:t,thumbnailMeta:l}}catch(m){return void u.setResult(!1,void 0,m)}}(e,t,i,n,o,r,a).catch(()=>{r?.addAdditionalProps({IsThumbnailUrlPresent:!1})}),d=s?.loadCache();if(d?.thumbnail)return r?.addAdditionalProps({UsedThumbnailCache:!0}),{latest:l,fastest:Promise.resolve(d.thumbnail)};return{latest:l,fastest:l}}(a,h.fastest,l,c,d,n,o,r);return r&&Promise.all([h.latest,u.latest,m.latest]).then(e=>{let[t,i,o]=e;t.isDataPublic?r.saveCache({metadata:t,favicon:i,thumbnail:o}):n?.addAdditionalProps({ProtectedData:!0})}).catch(()=>{}),{metadata:h.fastest,favicon:u.fastest,thumbnail:m.fastest}}function Yi(e,t,i,n,o){n?.addAdditionalProps({ErrorCode:e}),n?.setResult(i),o?.addAdditionalProps({FailedRequest:t}),o?.setResult(i)}function en(e){const t=new URL(e);return"undefined"!==typeof window&&t.searchParams.set("origin",window.location.origin),t.href}function tn(e){return function(e){return e.startsWith("https://urlp.asm.skype.com/")||e.startsWith("https://urlp.sfbassets.com/urlpcdn/")||e.startsWith("https://ca-prod.asyncgw.teams.microsoft.com/")||e.startsWith("https://us-prod.asyncgw.teams.microsoft.com/")||e.startsWith("https://as-prod.asyncgw.teams.microsoft.com/")||e.startsWith("https://eu-prod.asyncgw.teams.microsoft.com/")||e.startsWith("https://fr-prod.asyncgw.teams.microsoft.com/")||e.startsWith("https://au-prod.asyncgw.teams.microsoft.com/")||e.startsWith("https://uk-prod.asyncgw.teams.microsoft.com/")||e.startsWith("https://in-prod.asyncgw.teams.microsoft.com/")||e.startsWith("https://jp-prod.asyncgw.teams.microsoft.com/")}(e)&&(0,Di.C)(e)}function nn(e){return!e.used_authentication}class on{sendWithNamespace(){}dispose(){}send(){}constructor(){this.NamespaceLogger=this}}class rn{async openLink(e){(0,Vi.M)(e)}constructor(){this.LinkService=this}}let an=!1;class sn{constructor(e){this.OfficePolicyProvider=this,e&&!an&&((0,B.Ot)(e,{eventName:"OfficePolicyProviderNotProvided"}),an=!0)}optionalConnectedExperiencesEnabled(){return Promise.resolve(!1)}getEnterpriseFeedbackPolicy(){return Promise.resolve({emailEnabled:!1,screenshotEnabled:!1,sendFeedbackEnabled:!1,connectedOfficeExperiencesEnabled:!1,contentEnabled:!1})}getPolicy(e){return Promise.resolve(void 0)}}var ln=i(78945),dn=i(75964);function cn(e,t){return hn(e,t,new Set)}function hn(e,t,i){if(!(un(e)&&un(t)))return e===t;if(i.has(e)&&i.has(t))return!0;i.add(e),i.add(t);const n=Object.keys(e),o=Object.keys(t);if(n.length!==o.length)return!1;for(const r of n){const n=e[r],o=t[r],a=un(n)&&un(o);if(a&&!hn(n,o,i)||!a&&n!==o)return!1}return!0}function un(e){return null!=e&&"object"===typeof e}function mn(e,t){return{loadCache:()=>e?.urlPreview,saveCache:i=>function(e,t,i){if(cn(i?.urlPreview,t))return;e(JSON.stringify({...i,urlPreview:t}))}(t,i,e),clearCache:()=>t(void 0)}}const pn=(0,p.J)(async e=>await Fi(e));class gn extends Mi{get HTMLViewable(){return this}get HTMLPrintable(){return this}get IViewLayout(){return{canInline:!0,IViewLayout:this}}get ComponentPersistentInputDataV2(){return this}constructor(e,t){super("GenericLinkUnfurl",e,t),this.providers=t,this.views=[],this.experienceType="PreviewCard",this.iconUrl=void 0,this.name=void 0;const i=mn(function(e){if(e)return(0,dn.X)(e)}(e.componentPersistentInputData),e=>this.emit("onPersistentInitialDataChange",e));this.metadataPromise=new ln.I(()=>async function(e,t,i,n,o){let r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];const a={componentState:"NotFound",metadata:Promise.resolve({url:e.url.href,title:e.title||e.url.href}),favicon:Promise.resolve(void 0),thumbnail:Promise.resolve(void 0)},s=V.m.start("URLPreviewRequest",n);try{const l=Qi(t,e,i,s,n,o,r,!0),d=await l.metadata,c=d.statusCode?Number(d.statusCode):-1;return Zi(c)?(function(e,t){t.title&&t.title!==t.url.href&&(e.title=t.title)}(d,e),Promise.all([l.metadata,l.favicon,l.thumbnail]).then(()=>s.setResult(!0)).catch(()=>{}),{...l,metadata:Promise.resolve(d),componentState:"Found"}):(s.setResult(404===c,{message:Ui}),a)}catch(l){return s.setResult(!1,{message:_i},l),{componentState:"Unauthed",metadata:Promise.resolve({url:e.url.href,title:e.title||e.url.href}),favicon:Promise.resolve(void 0),thumbnail:Promise.resolve(void 0)}}}(this.urlData,t.TokenProvider,t.OfficePolicyProvider,t.NamespaceLogger,i))}async getView(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=V.m.start("DurationComponentCreation",this.providers.NamespaceLogger),i=new bi(this.urlData,await this.getStrings(),this.providers,this.ComponentClipboardProvider,this.metadataPromise,this.openLink,this.onRender,this.updateComponentNode,0===this.views.length,e);return this.views.push(i),t.setResult(!0),this.addComponentNodeToSessionModel(),i}async getPrintView(){return this.getView(!0)}onLocaleUpdated(){(async()=>{Promise.all(this.views.map(async e=>e.onLocaleUpdated(await this.getStrings()))).catch(()=>{})})().catch(()=>{})}async getStrings(){return await pn(this.contentLocale)}get ComponentProperties(){return this}}async function vn(e,t){if(!t)throw Error("Missing providers");if(!(0,r.I)(e,u.kW))throw Error("Unexpected initial configuration");const[i,n,o,a,s,l,d,c,h,m,p]=await Promise.all([t.CommandingSurface,t.InternationalizationContext,t.NamespaceLogger,t.TokenProvider,t.LinkService,t.OfficePolicyProvider,t.CommandBarTreeViewProvider,t.UrlHandlerProvider,t.SettingsProvider,t.AugmentationSessionContext,t.Theming]),g=o?new D.p("GenericLinkUnfurl",o):new on;if(!a)throw Error("Missing TokenProvider");const v={CommandingSurface:i,InternationalizationContext:n,NamespaceLogger:g,TokenProvider:a,LinkService:s??(c?void 0:new rn),OfficePolicyProvider:l??new sn,CommandBarTreeViewProvider:d,UrlHandlerProvider:c,SettingsProvider:h,AugmentationSessionContext:m,Theming:p};return new gn(e,v)}new l(vn,m,[],[h]);var fn=i(28184),yn=i(59190),Cn=i(74844),xn=i(68639),wn=i(52059);const kn={UserContext:"UserContext",LoopTelemetrySink:"LoopTelemetrySink",TelemetryConfig:"TelemetryConfig",...m};async function bn(e,t){if(!t)throw Error("Missing Providers");let i;const[n,o,a,s,l,d]=await Promise.all([t.TokenProvider,t.UserContext,t.InternationalizationContext,t.SettingsProvider,t.LoopTelemetrySink,t.TelemetryConfig]);let c="";if((0,r.I)(e,u.kW))i=e;else{if(!n)throw Error("Missing Token Provider");const e=s?.audience??wn.CS;c=await(0,xn.E)(n,o,e);const t={tokenProvider:n,tenantId:c,audience:e},{url:r}=await(0,fn.pL)(t,a?.uiLocale);i={creationData:{dataType:u.kW,data:{url:r}}}}const h={tenantId:c};return l&&!(0,yn.pk)(s?.audience)&&(0,yn.$N)(l,(0,yn.eO)({userContext:h,settingsProvider:s,internationalizationContext:a,telemetryConfig:d})),(0,A.Fr)()&&(0,yn.om)("LoopPlannerLink_createPlannerLinkUnfurl","Creating link chiclet for Planner Component in mobile",Cn.k.Info),vn(i,t)}const Sn=new l(bn,kn,[],[h])},81622:(e,t,i)=>{i.d(t,{V:()=>o});var n=i(5583);function o(e,t){return[...void 0!==e.componentCriticalShortcuts?(0,n.O)(e.componentCriticalShortcuts,t):[],...void 0!==e.hostOverrideShortcuts?(0,n.O)(e.hostOverrideShortcuts,t):[],...void 0!==e.componentNormalShortcuts?(0,n.O)(e.componentNormalShortcuts,t):[],...void 0!==e.hostNormalShortcuts?(0,n.O)(e.hostNormalShortcuts,t):[],...void 0!==e.componentLowShortcuts?(0,n.O)(e.componentLowShortcuts,t):[]]}},85633:(e,t,i)=>{i.d(t,{j:()=>r});var n=i(65043),o=i(57987),r=function(){var e=(0,o.d)({});return n.useEffect(function(){return function(){for(var t=0,i=Object.keys(e);t<i.length;t++){var n=i[t];clearTimeout(n)}}},[e]),(0,o.d)({setTimeout:function(t,i){var n=setTimeout(t,i);return e[n]=1,n},clearTimeout:function(t){delete e[t],clearTimeout(t)}})}}}]);
//# sourceMappingURL=75959.d3e6b7f3.chunk.js.map