(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[15456],{5062:(e,t,r)=>{"use strict";r.d(t,{f:()=>g});var n=r(75992),o=r(28673),s=r.n(o),i=r(42907),a=r.n(i),c=r(56707),l=r.n(c),u=r(91733),p=r.n(u);class g extends n.r{loggingData(){const e=s()(this.containerPlanMapping).length,t=p()(this.containerPlanMapping,e=>e?.length??0),r=a()(l()(this.containerPlanMapping),"length");return{containerCount:String(e),planCountByContainer:JSON.stringify(t),totalPlanCount:String(r),containerType:String(this.containerType)}}constructor(e,t){super(g.actionType),this.containerPlanMapping=e,this.containerType=t}}g.actionType="PLW_RESOLVECONTAINERSTOPLANS_SUCCEEDED"},9614:(e,t,r)=>{"use strict";r.d(t,{H:()=>o});var n=r(75992);class o extends n.r{constructor(e){super(o.actionType),this.unifiedGroupId=e}}o.actionType="PLW_DELETE_UNIFIEDGROUP"},13728:(e,t,r)=>{var n=r(78420),o=r(96614),s=r(84570),i=r(6571),a=r(36140),c=r(28673),l=Object.prototype.hasOwnProperty,u=s(function(e,t){if(a(t)||i(t))o(t,c(t),e);else for(var r in t)l.call(t,r)&&n(e,r,t[r])});e.exports=u},14740:e=>{e.exports=function(e){for(var t=-1,r=null==e?0:e.length,n=0,o=[];++t<r;){var s=e[t];s&&(o[n++]=s)}return o}},15434:(e,t,r)=>{"use strict";r.d(t,{x:()=>o});var n=r(32512);class o extends n.v{constructor(e,t,r,n){super(o.actionType,e,t,r),this.containerId=n}}o.actionType="PLW_GET_CONTAINER_FAIL"},19879:(e,t,r)=>{"use strict";r.d(t,{k:()=>o});var n=r(75992);class o extends n.r{constructor(e,t){super(o.actionType),this.groupId=e,this.sensitivityLabelId=t}}o.actionType="PLW_GET_UNIFIEDGROUPSENSITIVITYLABEL_SUCCEEDED"},29274:(e,t,r)=>{"use strict";r.d(t,{S:()=>s});var n=r(75992),o=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),s=function(e){function t(r,n,o){var s=e.call(this,t.type)||this;return s.name=r,s.id=n,s.additionalData=o,s}return o(t,e),t.prototype.loggingData=function(){return{name:this.name,id:this.id}},t.type="BEGIN_TRANSACTION",t}(n.r)},39115:(e,t,r)=>{var n=r(45967),o=r(36311),s=r(50715);e.exports=function(e){return o(e)?s(e):n(e)}},40655:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(65818),o=r(75992);class s extends o.r{loggingData(){return{containerType:String(n.K),idCount:String(this.containers.length)}}constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(s.actionType),this.containerType=e,this.containers=t,this.isFirstPage=r}}s.actionType="PLW_GET_IDSFORCONTAINERTYPE_SUCCEEDED"},42907:(e,t,r)=>{var n=r(9096),o=r(99910);e.exports=function(e,t){return e&&e.length?o(e,n(t,2)):0}},44227:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(75992);class o extends n.r{constructor(e){super(o.actionType),this.container=e}}o.actionType="PLW_CREATE_ROSTER_CONTAINER_SUCCESS"},45234:e=>{e.exports=function(e){for(var t,r=[];!(t=e.next()).done;)r.push(t.value);return r}},45967:e=>{e.exports=function(e){return e.split("")}},47204:(e,t,r)=>{"use strict";r.d(t,{Y:()=>s});var n=r(75992),o=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),s=function(e){function t(r,n,o){var s=e.call(this,t.type)||this;return s.id=r,s.errorMessage=n,s.additionalData=o,s}return o(t,e),t.prototype.loggingData=function(){return{errorMessage:this.errorMessage,id:this.id}},t.type="TRANSACTION_FAILED",t}(n.r)},50715:e=>{var t="\\ud800-\\udfff",r="["+t+"]",n="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",o="\\ud83c[\\udffb-\\udfff]",s="[^"+t+"]",i="(?:\\ud83c[\\udde6-\\uddff]){2}",a="[\\ud800-\\udbff][\\udc00-\\udfff]",c="(?:"+n+"|"+o+")"+"?",l="[\\ufe0e\\ufe0f]?",u=l+c+("(?:\\u200d(?:"+[s,i,a].join("|")+")"+l+c+")*"),p="(?:"+[s+n+"?",n,i,a,r].join("|")+")",g=RegExp(o+"(?="+o+")|"+p+u,"g");e.exports=function(e){return e.match(g)||[]}},54439:(e,t,r)=>{"use strict";r.d(t,{j:()=>l});var n=r(29274),o=r(74427),s=r(57860),i=r(47204),a=r(74568),c=r(79947);class l{static beginTransaction(e,t,r){let{transactionId:o,name:s,logQos:i,action:c,additionalData:u}=t;if(!0===i){const e=new a.W({name:"Tx:"+s},r);l.qosEventsInFlight[o]=e}e.batchDispatchActions(new n.S(s,o,u),c)}static cancelTransaction(e,t){let{transactionId:r,action:n,additionalData:s}=t;const i=l.qosEventsInFlight[r];i&&(i.end({resultType:c.f.ExpectedFailure,extraData:s}),delete l.qosEventsInFlight[r]),e.batchDispatchActions(n,new o.D(r,s))}static completeTransaction(e,t){let{transactionId:r,action:n,additionalData:o}=t;const i=l.qosEventsInFlight[r];i&&(i.end({resultType:c.f.Success,extraData:o}),delete l.qosEventsInFlight[r]),e.batchDispatchActions(n,new s.M(r,o))}static completeTransactionWithBatch(e,t){let{transactionId:r,actions:n,additionalData:o}=t;const i=l.qosEventsInFlight[r];i&&(i.end({resultType:c.f.Success,extraData:o}),delete l.qosEventsInFlight[r]),e.batchDispatchActions(...n,new s.M(r,o))}static completeTransactionWithError(e,t){let{transactionId:r,errorMessage:n,action:o,additionalData:s}=t;const a=l.qosEventsInFlight[r];a&&(a.end({resultType:c.f.Failure,error:n,extraData:s}),delete l.qosEventsInFlight[r]),e.batchDispatchActions(o,new i.Y(r,n,s))}}l.qosEventsInFlight={}},55637:(e,t,r)=>{"use strict";r.d(t,{G:()=>o});var n=r(75992);class o extends n.r{constructor(e){super(o.actionType),this.container=e}}o.actionType="PLW_UPDATE_CONTAINER_SUCCESS"},56707:(e,t,r)=>{var n=r(9812),o=r(91980),s=r(26924),i=r(6571),a=r(90620),c=r(45234),l=r(54160),u=r(52074),p=r(39115),g=r(26727),d=n?n.iterator:void 0;e.exports=function(e){if(!e)return[];if(i(e))return a(e)?p(e):o(e);if(d&&e[d])return c(e[d]());var t=s(e);return("[object Map]"==t?l:"[object Set]"==t?u:g)(e)}},57860:(e,t,r)=>{"use strict";r.d(t,{M:()=>s});var n=r(75992),o=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),s=function(e){function t(r,n){var o=e.call(this,t.type)||this;return o.id=r,o.additionalData=n,o}return o(t,e),t.prototype.loggingData=function(){return{id:this.id}},t.type="TRANSACTION_SUCEEDED",t}(n.r)},60878:(e,t,r)=>{"use strict";r.d(t,{L:()=>o});var n=r(75992);class o extends n.r{constructor(e){super(o.actionType),this.container=e}}o.actionType="PLW_GET_CONTAINER_SUCCESS"},64805:(e,t,r)=>{"use strict";r.d(t,{J:()=>o});class n{get clientSettings(){return this.clientSettingsProvider()}constructor(e,t,r){this.dispatcher=e,this.clientSettingsProvider=t,this.loggers=r}}class o extends n{getCurrentViewIds(){const e=this.stores.appContextStore.getCurrentViewId();return e?[e]:void 0}constructor(e,t,r,n,o){super(e,n,o),this.webApiProviders=t,this.stores=r}}},74427:(e,t,r)=>{"use strict";r.d(t,{D:()=>s});var n=r(75992),o=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),s=function(e){function t(r,n){var o=e.call(this,t.type)||this;return o.id=r,o.additionalData=n,o}return o(t,e),t.prototype.loggingData=function(){return{id:this.id}},t.type="CANCEL_TRANSACTION",t}(n.r)},78400:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ContainerModule:()=>B,MAX_RETRIES_PER_GROUP:()=>V,POLL_INTERVAL:()=>M});var n=r(32512);class o extends n.v{constructor(e,t,r,n){super(o.actionType,e,t,r),this.groupId=n}}o.actionType="PLW_GET_UNIFIEDGROUP_FAILED";var s=r(94600);class i extends n.v{constructor(e,t,r,n){super(i.actionType,e,t,r),this.groupId=n}}i.actionType="PLW_GET_UNIFIEDGROUPDETAILS_FAILED";var a=r(19879),c=r(9614),l=r(87337),u=r(78751),p=r(85262),g=r(60166),d=r(65394),h=r(36131),T=r(68746),y=r(38110),f=r(40655),I=r(5062);class v extends n.v{constructor(e,t,r){super(v.actionType,e,t,r)}}v.actionType="PLW_RESOLVECONTAINERSTOPLANS_FAILED";var P=r(60878),C=r(15434),A=r(55637),E=r(44227),x=r(78332),S=r(64805),L=r(65818),w=r(64836);class G extends w.m{constructor(e){super({externalId:e,containerType:L.K.DriveItem})}}var m=r(88457);class _ extends w.m{constructor(e){super({externalId:e,containerType:L.K.User})}}var D=r(74844),F=r(14740),$=r.n(F),b=r(13728),k=r.n(b),R=r(98502),U=r(54439),j=r(38752),N=r(37084),O=r.n(N),W=r(82841);const V=20,M=3e4;class B extends S.J{get name(){return"ContainerModule"}async fetchContainer(e,t){const{containerType:r,externalId:n}=e;switch(r){case L.K.Group:try{const e=await this.fetchUnifiedGroupAsync(n);if(t){const t=await this.fetchUnifiedGroupDetailsAsync(n);return new m.Z(n,e,t)}return new m.Z(n,e,null)}catch(o){return Promise.reject(o)}case L.K.DriveItem:const e=new G(n);return this.dispatcher.dispatchAction(new P.L(e)),Promise.resolve(e);case L.K.User:const r=new _(j.B.currentUserId);return this.dispatcher.dispatchAction(new P.L(r)),Promise.resolve(r);case L.K.Roster:try{return await this.fetchRosterContainerAsync(n)}catch(o){return Promise.reject(o)}default:return Promise.reject(R.g.generateAjaxClientError(null,"Invalid container type"))}}async fetchContainers(e,t,r){if(e===L.K.User){const t=[{id:{externalId:j.B.currentUserId,containerType:L.K.User},externalId:j.B.currentUserId,containerType:L.K.User,displayName:""}];return this.dispatcher.dispatchAction(new f.A(e,t,!0)),{Results:t,NextContinuationToken:null}}this.loggers.traceLogger.logTrace(507897248,D.k.Verbose,`Fetch Containers [containerType=${e}]`);const n=e=>{if(e.nextContinuationToken)return null;const t=this.stores.containerStore.getContainersByContainerType(e.containerType);return null!=t?{data:{Results:t,NextContinuationToken:null}}:null};try{const o=await this.webApiProviders.taskService(),s=await o.getContainersAsync({containerType:e,nextContinuationToken:t},n,void 0,r);return this.loggers.traceLogger.logTrace(507897247,D.k.Verbose,`Fetch Containers Success [containerType=${e}]`),this.dispatcher.dispatchAction(new f.A(e,s.data.Results,null==t)),s.data}catch(o){const t=o;return this.loggers.traceLogger.logTrace(507897246,D.k.Warning,`Fetch Containers Failed [containerType=${e}]${(0,W.s8)(t)}`),Promise.reject(t)}}async resolveContainersToPlans(e,t,r){if(this.loggers.traceLogger.logTrace(507897245,D.k.Verbose,`Resolve Containers To Plans [containerType=${e}][containerExternalIds.length=${t.length}]`),0===t.length)return Promise.resolve({});const n=e=>{const t={};for(let r=0;r<e.containerIds.length;r++){const n=e.containerIds[r];if(!this.stores.containerMembershipStore.getContainerHasBeenResolved(n))return null;const o=this.stores.containerMembershipStore.getPlanIdsForContainer(n);if(null==o)return null;const s=o.map(e=>this.stores.planStore.getPlan(e));if(-1!==s.indexOf(null))return null;t[n]=$()(s)}return t},o=await this.webApiProviders.taskService(),s=this.stores.appContextStore.getApiBatchLimits().ResolveGroupsToPlansBatchedAsync,i=t.slice(),a=[];for(;i.length>0;){let t=[];t=i.length<=s?i.splice(0):i.splice(0,s),a.push(o.resolveContainerIdsToPlansBatchedAsync({containerType:e,containerIds:t},n,void 0,r).then(t=>(this.loggers.traceLogger.logTrace(507897244,D.k.Verbose,`Resolve Containers To Plans Batch Success [containerType=${e}]`),this.dispatcher.dispatchAction(new I.f(t,e)),Promise.resolve(t)),t=>(this.loggers.traceLogger.logTrace(507897243,D.k.Warning,`Resolve Containers to Plans Batch Failed [containerType=${e}]${(0,W.s8)(t)}`),this.dispatcher.dispatchAction(new v(t.response,t.response?.statusText??"",t.error?.message??"")),Promise.reject(t))))}const c=await Promise.allSettled(a),l={};let u;if(c.forEach(e=>{if("fulfilled"===e.status)null!=e.value&&k()(l,e.value);else if("rejected"===e.status){u=e;const t=u.reason?.response?.status??0,r=u.reason?.response?.statusText??"";this.loggers.traceLogger.logTrace(507897242,D.k.Warning,`Resolve Containers to Plans Failed [statusCode=${t}][statusText=${r}]`)}}),null==u)return this.loggers.traceLogger.logTrace(507897241,D.k.Verbose,`Resolve Containers To Plans Success [containerType=${e}][containerExternalIds.length=${t.length}]`),l;{const e=u.reason||R.g.generateAjaxClientError(null,"");return Promise.reject(e)}}async fetchUnifiedGroupAsync(e){if(this.loggers.traceLogger.logTrace(507897240,D.k.Verbose,`Ensure Group [groupId=${e}]`),!e)return this.loggers.traceLogger.logTrace(507897239,D.k.Warning,`Ensure Group Failed [groupId=${e}][Error=ArgumentNullException: groupId]`),Promise.reject(R.g.generateAjaxClientError(null,"ArgumentNullException: groupId"));const t=e=>{const t=this.stores.containerStore.getContainer(e.groupId),r=t?.containerType===L.K.Group?t:null;return r?.unifiedGroup??null},r=e+x.Ek.FetchGroup;U.j.beginTransaction(this.dispatcher,{name:"fetchGroup",transactionId:r},this.loggers.logHandler);try{const n=await this.webApiProviders.graph(),o=await n.getUnifiedGroupAsync({groupId:e},t);this.loggers.traceLogger.logTrace(507897238,D.k.Verbose,`Ensure Group Success [groupId=${e}]`);const s=new m.Z(o.id,o,null);return U.j.completeTransaction(this.dispatcher,{transactionId:r,action:new P.L(s)}),o}catch(n){const t=n;this.loggers.traceLogger.logTrace(507897237,D.k.Warning,`Ensure Group Failed [groupId=${e}]${(0,W.s8)(t)}`);const s=t.response?.status??0;return U.j.completeTransactionWithError(this.dispatcher,{transactionId:r,action:new o(t.response,t.response?.statusText??"",t.error?.message??"",e),errorMessage:"",additionalData:{statusCode:s}}),Promise.reject(t)}}async fetchUnifiedGroupDetailsAsync(e){if(this.loggers.traceLogger.logTrace(507897236,D.k.Verbose,`Ensure Group Details [groupId=${e}]`),!e)return this.loggers.traceLogger.logTrace(507897235,D.k.Warning,`Ensure Group Details Failed [groupId=${e}][Error=ArgumentNullException: groupId]`),Promise.reject(R.g.generateAjaxClientError(null,"ArgumentNullException: groupId"));const t=this.stores.containerStore.getContainer(e);if(t&&t.containerType===L.K.Group){const r=t;if(r.unifiedGroupDetails?.isFullyProvisioned())return this.loggers.traceLogger.logTrace(507897234,D.k.Verbose,`Ensure Group Details Success - group details fully provisioned [groupId=${e}]`),Promise.resolve(r.unifiedGroupDetails)}const r=e=>{const t=this.stores.containerStore.getContainer(e.groupId);if(t&&t.containerType===L.K.Group){const e=t;if(e.unifiedGroupDetails?.isFullyProvisioned())return e.unifiedGroupDetails}return null},n=this.getCurrentViewIds();try{const t=await this.webApiProviders.taskService(),o=await t.getUnifiedGroupDetailsAsync({groupId:e},r,n);return this.loggers.traceLogger.logTrace(507897233,D.k.Verbose,`Ensure Group Details Success [groupId=${e}]`),this.dispatcher.dispatchAction(new s.P(o)),o}catch(o){const t=o;return this.dispatcher.dispatchAction(new i(t.response,t.response?.statusText??"",t.error?.message??"",e)),this.loggers.traceLogger.logTrace(507897232,D.k.Warning,`Ensure Group Details Failed [groupId=${e}]${(0,W.s8)(t)}`),Promise.reject(t)}}async fetchGroupSensitivityLabelAsync(e){this.loggers.traceLogger.logTrace(507897231,D.k.Verbose,`Fetching Group Sensitivity Label [GroupId=${e}]`);try{const t=await this.webApiProviders.taskService(),r=await t.getUnifiedGroupSensitivityLabelAsync({groupId:e});return this.loggers.traceLogger.logTrace(507897230,D.k.Verbose,`Fetching Group Sensitivity Label - Success [GroupId=${e}]`),this.dispatcher.dispatchAction(new a.k(e,r)),r}catch(t){const r=t;return this.loggers.traceLogger.logTrace(507897229,D.k.Warning,`Fetching Group Sensitivity Label - Failure  [GroupId=${e}]${(0,W.s8)(r)}`),Promise.reject(r)}}async fetchRosterContainerAsync(e){if(this.loggers.traceLogger.logTrace(507897228,D.k.Verbose,`Fetching Roster Container [ContainerId=${e}]`),!e)return this.loggers.traceLogger.logTrace(507897227,D.k.Warning,`Fetching Roster Container Failed [ContainerId=${e}][Error=ArugumentNullException: containerId]`),Promise.reject(R.g.generateAjaxClientError(null,"ArgumentNullException: containerId"));const t=e=>{const t=this.stores.containerStore.getContainer(e.containerId);return t?.containerType===L.K.Roster?t:null};try{const r=await this.webApiProviders.taskService(),n=await r.getRosterContainerAsync({containerId:e},t);return this.loggers.traceLogger.logTrace(507897226,D.k.Verbose,`Fetching Roster Container - Success [ContainerId=${e}]`),this.dispatcher.dispatchAction(new P.L(n)),n}catch(r){const t=r;return this.loggers.traceLogger.logTrace(507897225,D.k.Warning,`Fetching Roster Container - Failure  [ContainerId=${e}]${(0,W.s8)(t)}`),this.dispatcher.dispatchAction(new C.x(t.response,t.response?.statusText??"",t.error?.message??"",e)),Promise.reject(t)}}pollForGroupFullyProvisioned(e){this.isPollingGroup[e.id]||(this.isPollingGroup[e.id]=!0,this.internalPollForGroupFullyProvisioned(e))}internalPollForGroupFullyProvisioned(e){if(e.isFullyProvisioned())return void delete this.isPollingGroup[e.id];const t=this.stores.appContextStore.getCurrentPlanId();(t?this.stores.planStore.getContainerIdForPlan(t):this.stores.appContextStore.getCurrentGroupId())===e.id?(this.retriesPerGroup[e.id]||(this.retriesPerGroup[e.id]=0),this.retriesPerGroup[e.id]<V?(this.retriesPerGroup[e.id]++,setTimeout(()=>{this.loggers.traceLogger.logTrace(507897224,D.k.Info,`Polling for group [Id=${e.id}][Retries=${this.retriesPerGroup[e.id]}][IsProvisioned=${e.isFullyProvisioned()}][SPO=${e.isSharePointProvisioned()}]`),this.fetchUnifiedGroupDetailsAsync(e.id).then(e=>this.internalPollForGroupFullyProvisioned(e)).catch(()=>{delete this.isPollingGroup[e.id]})},M)):delete this.isPollingGroup[e.id]):delete this.isPollingGroup[e.id]}async createRosterContainerAsync(){this.loggers.traceLogger.logTrace(507897223,D.k.Verbose,"Create Roster Container");try{const e=await this.webApiProviders.taskService(),t=await e.createPlannerRosterAsync({});return this.loggers.traceLogger.logTrace(507897222,D.k.Verbose,`Create Roster Container - Success [ContainerId=${t.externalId}]`),this.dispatcher.dispatchAction(new E.A(t)),t}catch(e){throw this.loggers.traceLogger.logTrace(507897221,D.k.Warning,`Create Roster Container - Failure ${(0,W.s8)(e)}`),e}}async setRosterContainerSensitivityLabelAsync(e){this.loggers.traceLogger.logTrace(507897220,D.k.Verbose,`Set Roster Sensitivity Label [ContainerId=${e.externalId}]`);try{const t=await this.webApiProviders.taskService(),r=await t.setRosterSensitivityLabelAsync({rosterContainer:e});return this.loggers.traceLogger.logTrace(507897219,D.k.Verbose,`Set Roster Container Sensitivity Label - Success [ContainerId=${e.externalId}]`),this.dispatcher.dispatchAction(new A.G(r)),r}catch(t){const r=t;return this.loggers.traceLogger.logTrace(507897218,D.k.Warning,`Set Roster Container Sensitivity Label - Failure  [ContainerId=${e.externalId}]${(0,W.s8)(r)}`),Promise.reject(r)}}async addUsersToContainerAsync(e,t){this.loggers.traceLogger.logTrace(507897217,D.k.Verbose,`Batch Add Users To Container [containerId=${e.externalId}][containerType=${e.containerType}]`),this.dispatcher.dispatchAction(new p.V(t,e.externalId));const r=this.stores.appContextStore.getApiBatchLimits().AddUsersToGroupMaxBatchSize,n=await this.webApiProviders.taskService();return new Promise((o,s)=>{const i=[];for(const a of O()(t,r)){const t=[];for(const r of a)t.push(n.addUserToContainer({container:e,userId:r}).then(()=>(this.loggers.traceLogger.logTrace(507897216,D.k.Verbose,`Add User To Container Success [containerId=${e.externalId}][containerType=${e.containerType}]`),this.dispatcher.dispatchAction(new g.$(r,e.externalId)),Promise.resolve()),t=>(this.loggers.traceLogger.logTrace(507897187,D.k.Warning,`Add User To Container Failed [containerId=${e.externalId}][containerType=${e.containerType}]${(0,W.s8)(t)}`),this.dispatcher.dispatchAction(new d.d(r,e.externalId,t.response,t.response?.statusText??"",t.error?.message??"")),Promise.reject(t))));i.push(Promise.allSettled(t).then(async e=>{let t;if(e.forEach(e=>{"rejected"===e.status&&(t=e)}),null!=t){const e=t.reason||R.g.generateAjaxClientError(null,"");return Promise.reject(e)}Promise.resolve()}))}Promise.allSettled(i).then(async e=>{let t;if(e.forEach(e=>{if("rejected"===e.status){t=e;const r=t.reason?.response?.status??0,n=t.reason?.response?.statusText??"";this.loggers.traceLogger.logTrace(507897186,D.k.Warning,`Add Users To Container Failed [statusCode=${r}][statusText=${n}]`)}}),null==t)o();else{const e=t.reason||R.g.generateAjaxClientError(null,"");s(e)}})})}async removeUserFromContainerAsync(e,t){this.loggers.traceLogger.logTrace(507897185,D.k.Verbose,`Remove User From Container [containerId=${e.externalId}][containerType=${e.containerType}]`),this.dispatcher.dispatchAction(new h.C(t,e.externalId));try{const r=await this.webApiProviders.taskService();return await r.removeUserFromContainer({container:e,userId:t}),this.loggers.traceLogger.logTrace(507897184,D.k.Verbose,`Remove User From Container Success [containerId=${e.externalId}][containerType=${e.containerType}]`),this.dispatcher.dispatchAction(new T.f(t,e.externalId)),Promise.resolve()}catch(r){const n=r;return this.loggers.traceLogger.logTrace(507897183,D.k.Warning,`Remove User From Container Failed [containerId=${e.externalId}][containerType=${e.containerType}]${(0,W.s8)(n)}`),this.dispatcher.dispatchAction(new y.R(t,e.externalId,n.response,n.response?.statusText??"",n.error?.message??"")),Promise.reject(n)}}deleteContainer(e){return e.containerType===L.K.Group?this.deleteGroupContainer(e):(this.loggers.traceLogger.logTrace(507897182,D.k.Warning,`Trying to delete non-group container [containerId=${e.externalId}][containerType=${e.containerType}]`),Promise.reject(R.g.generateAjaxClientError(null,"Trying to delete non-group container")))}async deleteGroupContainer(e){this.loggers.traceLogger.logTrace(507897181,D.k.Verbose,`Delete container [containerId=${e.externalId}][containerType=${e.containerType}]`),this.dispatcher.dispatchAction(new c.H(e.externalId));try{const t=await this.webApiProviders.taskService();return await t.deleteUnifiedGroupAsync({groupId:e.externalId}),this.loggers.traceLogger.logTrace(507897180,D.k.Verbose,`Delete container success [containerId=${e.externalId}][containerType=${e.containerType}]`),this.dispatcher.dispatchAction(new l.s(e)),Promise.resolve()}catch(t){const r=t,n=r.response?.status;return 404===n?(this.loggers.traceLogger.logTrace(507897179,D.k.Info,`Delete container failed - Not found [containerId=${e.externalId}][containerType=${e.containerType}]${(0,W.s8)(r)}`),this.dispatcher.dispatchAction(new l.s(e)),Promise.resolve()):(this.loggers.traceLogger.logTrace(507897178,D.k.Warning,`Delete container failed [containerId=${e.externalId}][containerType=${e.containerType}]${(0,W.s8)(r)}`),this.dispatcher.dispatchAction(new u.W(e.externalId,r.response,r.response?.statusText??"",r.error?.message??"")),Promise.reject(r))}}constructor(){super(...arguments),this.retriesPerGroup={},this.isPollingGroup={}}}},78751:(e,t,r)=>{"use strict";r.d(t,{W:()=>o});var n=r(32512);class o extends n.v{constructor(e,t,r,n){super(o.actionType,t,r,n),this.unifiedGroupId=e}}o.actionType="PLW_DELETE_UNIFIEDGROUP_FAILED"},87337:(e,t,r)=>{"use strict";r.d(t,{s:()=>o});var n=r(75992);class o extends n.r{constructor(e){super(o.actionType),this.container=e}}o.actionType="PLW_DELETE_UNIFIEDGROUP_SUCCEEDED"},88457:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(65818),o=r(64836);class s extends o.m{constructor(e,t,r){super({externalId:e,containerType:n.K.Group},t.displayName),this.unifiedGroup=t,this.unifiedGroupDetails=r}}},94600:(e,t,r)=>{"use strict";r.d(t,{P:()=>o});var n=r(75992);class o extends n.r{constructor(e){super(o.actionType),this.unifiedGroupDetails=e}}o.actionType="PLW_GET_UNIFIEDGROUPDETAILS_SUCCEEDED"},99910:e=>{e.exports=function(e,t){for(var r,n=-1,o=e.length;++n<o;){var s=t(e[n]);void 0!==s&&(r=void 0===r?s:r+s)}return r}}}]);
//# sourceMappingURL=containermodule.95432005.chunk.js.map