"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[71398],{11910:(e,t,i)=>{i.d(t,{L:()=>l});var s,a=i(86178),r=i.n(a),n=i(38752),o=i(54276);!function(e){e[e.Text=0]="Text",e[e.HTML=1]="HTML"}(s||(s={}));var d=i(91246);class h{build(){return new l(this)}fromPostResource(e){return this.withPropertyBag({body:null!=e.Body?{content:e.Body.Content,contentType:e.Body.ContentType===s.HTML?o.c.HTML:o.c.Text}:void 0,categories:e.Categories||void 0,changeKey:null!=e.ChangeKey?e.ChangeKey:void 0,conversationId:e.ConversationId||void 0,conversationThreadId:e.ConversationThreadId||void 0,createdDateTime:null!=e.CreatedDateTime?r()(e.CreatedDateTime):void 0,fromField:null!=e.From?{emailAddress:{address:e.From.EmailAddress.Address,name:e.From.EmailAddress.Name}}:void 0,hasAttachments:e.HasAttachments,id:e.Id,lastModifiedDateTime:null!=e.LastModifiedDateTime?r()(e.LastModifiedDateTime):void 0,receivedDateTime:null!=e.ReceivedDateTime?r()(e.ReceivedDateTime):void 0,sender:null!=e.Sender?{emailAddress:{address:e.Sender.EmailAddress.Address,name:e.Sender.EmailAddress.Name}}:void 0})}fromGraphPostResource(e,t){return this.withPropertyBag({body:null!=e.body?{content:e.body.content,contentType:"html"===e.body.contentType?o.c.HTML:o.c.Text}:void 0,categories:e.categories,changeKey:null!=e.changeKey?e.changeKey:void 0,conversationId:void 0,conversationThreadId:t,createdDateTime:null!=e.createdDateTime?r()(e.createdDateTime):void 0,fromField:null!=e.from?{emailAddress:{address:e.from.emailAddress.address,name:e.from.emailAddress.name}}:void 0,hasAttachments:e.hasAttachments,id:e.id,lastModifiedDateTime:null!=e.lastModifiedDateTime?r()(e.lastModifiedDateTime):void 0,receivedDateTime:null!=e.receivedDateTime?r()(e.receivedDateTime):void 0,sender:null!=e.sender?{emailAddress:{address:e.sender.emailAddress.address,name:e.sender.emailAddress.name}}:void 0,nextLink:e["@odata.nextLink"]})}withPropertyBag(e){return this.body=e.body||this.body,this.categories=e.categories||this.categories,this.changeKey=null!=e.changeKey?e.changeKey:this.changeKey,this.conversationId=e.conversationId||this.conversationId,this.conversationThreadId=e.conversationThreadId||this.conversationThreadId,this.createdDateTime=e.createdDateTime||this.createdDateTime,this.fromField=e.fromField||this.fromField,this.hasAttachments=null!=e.hasAttachments?e.hasAttachments:this.hasAttachments,this.id=e.id||this.id,this.lastModifiedDateTime=e.lastModifiedDateTime||this.lastModifiedDateTime,this.receivedDateTime=e.receivedDateTime||this.receivedDateTime,this.sender=e.sender||this.sender,this.nextLink=e.nextLink||this.nextLink,this}withLocallyUniqueId(){return this.id=d.o.generate(),this}constructor(){this.body=null,this.categories=[],this.id=d.o.generate(),this.hasAttachments=!1,this.fromField={emailAddress:{address:n.B.currentUserEmail,name:"CurrentUser"}}}}class l{static get builder(){return new h}static generatePostBody(e){return{content:e,contentType:o.c.HTML}}toWebSerializable(){return{Body:null!=this.body?{Content:this.body.content,ContentType:this.body.contentType===o.c.HTML?s.HTML:s.Text}:null,Categories:this.categories,ChangeKey:this.changeKey,ConversationId:this.conversationId,ConversationThreadId:this.conversationThreadId,CreatedDateTime:null!=this.createdDateTime?this.createdDateTime.toISOString():null,From:{EmailAddress:{Address:this.fromField.emailAddress.address,Name:this.fromField.emailAddress.name}},HasAttachments:this.hasAttachments,Id:this.id,LastModifiedDateTime:null!=this.lastModifiedDateTime?this.lastModifiedDateTime.toISOString():null,ReceivedDateTime:null!=this.receivedDateTime?this.receivedDateTime.toISOString():null,Sender:null!=this.sender?{EmailAddress:{Address:this.sender.emailAddress.address,Name:this.sender.emailAddress.name}}:null}}toGraphSerializable(){return{body:null!=this.body?{content:this.body.content,contentType:this.body.contentType}:null,categories:null!=this.categories?this.categories:void 0,changeKey:this.changeKey,createdDateTime:null!=this.createdDateTime?this.createdDateTime.toISOString():void 0,from:null!=this.fromField?{emailAddress:{address:this.fromField.emailAddress.address,name:this.fromField.emailAddress.name}}:void 0,hasAttachments:this.hasAttachments,id:this.id,lastModifiedDateTime:null!=this.lastModifiedDateTime?this.lastModifiedDateTime.toISOString():void 0,receivedDateTime:null!=this.receivedDateTime?this.receivedDateTime.toISOString():void 0,sender:null!=this.sender?{emailAddress:{address:this.sender.emailAddress.address,name:this.sender.emailAddress.name}}:void 0,singleValueExtendedProperties:[{id:l.transportTrafficTypeName,value:l.transportTrafficType},{id:l.transportTrafficSubTypeName,value:l.transportTrafficSubType}]}}constructor(e){this.body=e.body,this.categories=e.categories,this.changeKey=e.changeKey,this.conversationId=e.conversationId,this.conversationThreadId=e.conversationThreadId,this.createdDateTime=e.createdDateTime,this.fromField=e.fromField,this.hasAttachments=e.hasAttachments,this.id=e.id,this.lastModifiedDateTime=e.lastModifiedDateTime,this.receivedDateTime=e.receivedDateTime,this.sender=e.sender}}l.transportTrafficTypeName="String {00020386-0000-0000-C000-000000000046} Name X-MS-Exchange-Organization-TransportTrafficType",l.transportTrafficSubTypeName="String {00020386-0000-0000-C000-000000000046} Name X-MS-Exchange-Organization-TransportTrafficSubType",l.transportTrafficType="Email",l.transportTrafficSubType="PlannerComment"},45622:(e,t,i)=>{i.r(t),i.d(t,{ConversationsService:()=>m});var s=i(95783),a=i(45078),r=i(11910),n=i(94266),o=i(33411),d=i.n(o),h=i(86178),l=i.n(h),c=i(98502);class m extends n.R{async getGroupConversationThreadAsync(e){const t=`${this.hostDomain}/${this.v1UrlToken}/groups/${e.groupId}/threads/${e.threadId}/posts`,i=await this.ajaxClient.executeRequest(t,{telemetryConfig:this.getDefaultRequestTelemetryConfig("getGroupConversationThreadAsync")});try{const t=await i.clone().json();if(null==t)throw new Error("No conversation thread data returned");const s=t.value;return d()(s,t=>r.L.builder.fromGraphPostResource(t,e.threadId).build())}catch(s){throw c.g.generateAjaxClientError(i,s)}}async getGroupConversationThreadPostAsync(e){const t=`${this.hostDomain}/${this.v1UrlToken}/groups/${e.groupId}/threads/${e.threadId}/posts/${e.postId}`,i=await this.ajaxClient.executeRequest(t,{telemetryConfig:this.getDefaultRequestTelemetryConfig("getGroupConversationThreadPostAsync")});try{const t=await i.clone().json();if(null==t)throw new Error("No conversation thread data returned");const s=t;return r.L.builder.fromGraphPostResource(s,e.threadId).build()}catch(s){throw c.g.generateAjaxClientError(i,s)}}async createGroupConversationThreadAsync(e){const t=`${this.hostDomain}/${this.v1UrlToken}/groups/${e.groupId}/conversations`,i=e.newPost.toGraphSerializable(),n={topic:e.threadSubject.substring(0,200),threads:[{posts:[i]}]},o=await this.ajaxClient.executeRequest(t,{method:s.PJ.Post,body:JSON.stringify(n),headers:{[a.Lr.ContentType]:a.Mq.Json},telemetryConfig:this.getDefaultRequestTelemetryConfig("createGroupConversationThreadAsync")});try{const e=await o.clone().json();if(null==e?.threads?.[0]?.id)throw new Error("No post response returned");return i.createdDateTime=l()().toDate().toISOString(),r.L.builder.fromGraphPostResource(i,e.threads[0].id).withLocallyUniqueId().build()}catch(d){throw c.g.generateAjaxClientError(o,d)}}async postReplyInGroupConversationThreadAsync(e){const t=`${this.hostDomain}/${this.v1UrlToken}/groups/${e.groupId}/threads/${e.threadId}/reply`,i=e.newPost.toGraphSerializable();i.createdDateTime=l()().toDate().toISOString(),i.from=void 0,i.categories=void 0;const r={post:i};await this.ajaxClient.executeRequest(t,{method:s.PJ.Post,headers:{[a.Lr.ContentType]:a.Mq.Json},body:JSON.stringify(r),telemetryConfig:this.getDefaultRequestTelemetryConfig("postReplyInGroupConversationThreadAsync")})}constructor(e,t){super("ConversationsService",e,t)}}},54276:(e,t,i)=>{var s;i.d(t,{c:()=>s}),function(e){e.Text="text",e.HTML="html"}(s||(s={}))},94266:(e,t,i)=>{i.d(t,{R:()=>a});var s=i(45078);class a{appendSharepointAuthenticationChallengeHeaders(e){return e[s.Er.AuthenticationChallengeHeaderName]=s.Er.AuthenticationChallengeHeaderValue,e}getDefaultRequestTelemetryConfig(e){return{apiName:this.name,methodName:e,requestHeadersToLog:this.loggableRequestHeaders,responseHeadersToLog:this.loggableResponseHeaders}}extractSkipTokenFromNextLink(e){try{const t=new URL(e);return new URLSearchParams(t.search).get(this.skipTokenParam)}catch{return null}}constructor(e,t,i){this.name=e,this.hostDomain=t,this.ajaxClient=i,this.skipTokenKey="@odata.nextLink",this.skipTokenParam="$skiptoken",this.vBetaUrlToken="beta",this.v1UrlToken="v1.0",this.loggableRequestHeaders=[s.a8.ClientRequestId],this.loggableResponseHeaders=[s.Qu.RequestId,s.Qu.ClientRequestId,s.Qu.TCorrelationId]}}}}]);
//# sourceMappingURL=conversationsservice.6a7f5f1a.chunk.js.map