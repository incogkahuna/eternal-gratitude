"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[72567],{28553:(e,t,r)=>{r.d(t,{P:()=>a});var i=r(56851),n=r(65043),o=r(44828),a=function(e){function t(t){var r=e.call(this,t)||this;return r.state={isRendered:void 0===(0,o.z)()},r}return(0,i.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this,t=this.props.delay;this._timeoutId=window.setTimeout(function(){e.setState({isRendered:!0})},t)},t.prototype.componentWillUnmount=function(){this._timeoutId&&clearTimeout(this._timeoutId)},t.prototype.render=function(){return this.state.isRendered?n.Children.only(this.props.children):null},t.defaultProps={delay:0},t}(n.Component)},36599:(e,t,r)=>{r.d(t,{P:()=>a});var i=r(65043),n=r(83545),o=r(48043);class a extends i.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e){const t=new o.QW(n.NN.FluentUiError,e.stack);this.props.onRenderPromise.reject(t),this.props.onCompletePromise.reject(t)}render(){if(!this.state.hasError)return this.props.children;alert(this.props.stringTable.fluentUiErrorTitle)}}},40488:(e,t,r)=>{r.d(t,{y:()=>f});var i=r(65804),n=r(56851),o=r(65043),a=r(57433),s=r(89379),l=r(17066),d=r(28553),c=(0,s.Z)(),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.type,r=e.size,i=e.ariaLabel,s=e.ariaLive,m=e.styles,h=e.label,u=e.theme,p=e.className,g=e.labelPosition,f=i,b=(0,l.G1)(this.props,l.JM,["size"]),w=r;void 0===w&&void 0!==t&&(w=t===a.Q.large?a.H.large:a.H.medium);var x=c(m,{theme:u,size:w,className:p,labelPosition:g});return o.createElement("div",(0,n.__assign)({},b,{className:x.root}),o.createElement("div",{className:x.circle}),h&&o.createElement("div",{className:x.label},h),f&&o.createElement("div",{role:"status","aria-live":s},o.createElement(d.P,null,o.createElement("div",{className:x.screenReaderText},f))))},t.defaultProps={size:a.H.medium,ariaLive:"polite",labelPosition:"bottom"},t}(o.Component),h=r(52195),u=r(66783),p={root:"ms-Spinner",circle:"ms-Spinner-circle",label:"ms-Spinner-label"},g=(0,u.J9)(function(){return(0,h.i7)({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}})}),f=(0,i.I)(m,function(e){var t,r=e.theme,i=e.size,o=e.className,s=e.labelPosition,l=r.palette,d=(0,h.Km)(p,r);return{root:[d.root,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},"top"===s&&{flexDirection:"column-reverse"},"right"===s&&{flexDirection:"row"},"left"===s&&{flexDirection:"row-reverse"},o],circle:[d.circle,{boxSizing:"border-box",borderRadius:"50%",borderWidth:"1.5px",borderStyle:"solid",borderTopColor:l.themePrimary,borderRightColor:l.themeLight,borderBottomColor:l.themeLight,borderLeftColor:l.themeLight,animationName:g(),animationDuration:"1.3s",animationIterationCount:"infinite",animationTimingFunction:"cubic-bezier(.53,.21,.29,.67)",selectors:(t={},t[h.up]=(0,n.__assign)({borderTopColor:"Highlight"},(0,h.Qg)()),t)},i===a.H.xSmall&&["ms-Spinner--xSmall",{width:12,height:12}],i===a.H.small&&["ms-Spinner--small",{width:16,height:16}],i===a.H.medium&&["ms-Spinner--medium",{width:20,height:20}],i===a.H.large&&["ms-Spinner--large",{width:28,height:28}]],label:[d.label,r.fonts.small,{color:l.themePrimary,margin:"8px 0 0",textAlign:"center"},"top"===s&&{margin:"0 0 8px"},"right"===s&&{margin:"0 0 0 8px"},"left"===s&&{margin:"0 8px 0 0"}],screenReaderText:h.dX}},void 0,{scope:"Spinner"})},57433:(e,t,r)=>{var i,n;r.d(t,{H:()=>i,Q:()=>n}),function(e){e[e.xSmall=0]="xSmall",e[e.small=1]="small",e[e.medium=2]="medium",e[e.large=3]="large"}(i||(i={})),function(e){e[e.normal=0]="normal",e[e.large=1]="large"}(n||(n={}))},64681:(e,t,r)=>{r.d(t,{x:()=>w});var i=r(70579),n=r(65043),o=r(40488),a=r(52195),s=r(57433),l=r(53015),d=r(83545),c=r(48043),m=r(6766),h=r(74043),u=r(78632);const p="shareIframe",g="www.odwebp.svc.ms",f=`https://${g}/share`;let b;const w=n.memo(e=>{const{payloadPromise:t,onRenderPromise:r,onCompletePromise:a,stringTable:l,perfMarks:d,localization:h,renderState:u,setRenderState:w,onIframeDismiss:C,useEnterpriseEndpoint:E,shareMode:k,shareTelemetryProps:_}=e,[L,P]=n.useState(void 0),[T,j]=n.useState({width:(0,m._5)(m.Ic),height:m.GB}),N=n.useRef(null),R=n.useRef(null),I=n.useCallback(e=>{let{width:t,height:r}=e;j({width:(0,m._5)(t),height:r})},[]),D=n.useCallback(e=>{if(E){b=new URL(e).hostname;let t=`${e}/_layouts/15/sharedialog.aspx?crossdomain=true&migratedhosting=true&clientId=fluid&clickTime=${Date.now()}`;return t+=`&smkt=${h.locale}`,t}b=g;return`${f}?smkt=${h.locale}`},[E,h.locale]),z=n.useCallback(e=>{e&&e.focus()},[]),H=n.useCallback(e=>{e&&(e.submit(),d.payloadSendStartTime=performance.now())},[d]),M=n.useCallback(()=>{if(null!==N.current&&void 0!==L){const e=L.authToken,t=D(L.webAbsoluteUrl);N.current.target=p,N.current.method="POST",N.current.action=t;const r=document.createElement("input");r.type="text",r.value=e,r.name="access_token",r.hidden=!0,N.current.appendChild(r);const i=document.createElement("input");i.type="text",i.value=JSON.stringify(L),i.name="context",i.hidden=!0,N.current.appendChild(i),N.current.submit(),d.payloadSendStartTime=performance.now()}},[D,N,L,d]),U=E?M:H;n.useEffect(()=>{t.then(e=>{P(e);const t=((e,t)=>{let r="";return r=t?new URL(e).origin:f,"clipboard-read self "+r+"; clipboard-write self "+r})(e.webAbsoluteUrl,E);R.current&&(R.current.allow=t),U()}).catch(e=>{r.reject(e),a.reject(e)})},[t,L,a,r,U,E]),n.useEffect(()=>{a.catch(()=>{w(c.yp.Error)})},[a]),n.useEffect(()=>{const e=e=>{x(e,C,r,a,w,I,d,_)};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[]);const $=S(u,T.width,T.height),A=v(T.width,T.height);return(0,i.jsxs)(i.Fragment,{children:[u===c.yp.Loading&&(0,i.jsx)("div",{className:y(k),"aria-label":l.loadingMessage,ref:z,children:(0,i.jsx)(o.y,{size:s.H.large})}),u===c.yp.Error&&(0,i.jsx)("div",{"aria-label":l.shareDialogErrorMessage,children:l.shareDialogErrorMessage}),u!==c.yp.Error&&(0,i.jsxs)("div",{className:$,children:[E?(0,i.jsx)("form",{id:"shareform",ref:N}):L&&(0,i.jsx)("form",{id:"shareform",action:D(""),method:"post",target:p,ref:U,children:(0,i.jsx)("input",{type:"text",name:"context",defaultValue:JSON.stringify(L),style:{display:"none"}})}),(0,i.jsx)("iframe",{className:A,name:p,title:e.stringTable.shareIframeTitle,sandbox:void 0,role:"dialog",ref:R})]})]})}),x=(e,t,r,i,n,o,a,s)=>{const m=new URL(e.origin);if("https:"!==m.protocol||m.hostname!==b)return;const h=JSON.parse(e.data);switch(h.name){case"share_started":a.sharePointLoadStartTime=performance.now();break;case"share_ready":n(c.yp.Loaded),r.resolve(!0);break;case"share_resize":h&&(0,l.E)(h.width)&&(0,l.E)(h.height)&&0!==h.width&&0!==h.height&&o({width:h.width,height:h.height});break;case"share_dismiss":t();break;case"share_grantAccessCompleted":i.resolve(h?.successful);break;case"share_completed":s.odspShareCompletedReceived=!0,s.linkScope=h?.scope,(0,u.t)(25e3,[i]).then(e=>{e&&i.resolve(!0)}).catch(()=>{});break;case"share_error":const e=h?.error?h.error.toString():"error not provided",m=h?.errorCategory?h.errorCategory.toString():"error category not provided",p=h?.errorMessage?h.errorMessage:"error message not provided",g=new c.QW(d.NN.SpoShareError,p,e,m);r.reject(g),i.reject(g)}},y=e=>{switch(e){case h.n.atMention:return(0,a.Zq)({width:480,height:250,paddingBottom:50,display:"flex",justifyContent:"center",alignContent:"center",selectors:{":focus":{outline:"none"}}});case h.n.default:case h.n.copyLink:case h.n.manageAccess:default:return(0,a.Zq)({width:480,height:m.GB,paddingBottom:0,display:"flex",justifyContent:"center",alignContent:"center",selectors:{":focus":{outline:"none"}},"@media screen and (max-width: 430px)":{width:"100%"}})}},v=(e,t)=>(0,a.Zq)({width:e,height:t,border:"none","@media screen and (max-width: 430px)":{width:m.Ic}}),S=(e,t,r)=>(0,a.Zq)({width:e===c.yp.Loaded?t:0,height:e===c.yp.Loaded?r:0,overflow:"hidden","@media screen and (max-width: 430px)":{width:e===c.yp.Loaded?m.Ic:0}})}}]);
//# sourceMappingURL=72567.fa5a955d.chunk.js.map