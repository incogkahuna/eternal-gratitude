(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[55832],{12358:(e,t,n)=>{var r=n(95694),a=n(41069),o=/[&<>"']/g,l=RegExp(o.source);e.exports=function(e){return(e=a(e))&&l.test(e)?e.replace(o,r):e}},14983:(e,t,n)=>{"use strict";var r;n.d(t,{Er:()=>r,LP:()=>a,ig:()=>o}),function(e){e.Word="Word",e.Excel="Excel",e.PowerPoint="PowerPoint",e.OneNote="OneNote",e.Project="Project",e.Visio="Visio",e.Pdf="Pdf",e.Loop="Loop",e.Other="Other"}(r||(r={}));r.OneNote,r.Project,r.Visio;var a,o=["jpg","jpeg","png","gif","bmp"];!function(e){e.Stream="stream-video",e.Youtube="yt-video",e.Vimeo="vimeo-video",e.DailyMotion="dm-video",e.Facebook="fb-video"}(a||(a={}))},33268:(e,t,n)=>{"use strict";n.d(t,{XY:()=>k,lo:()=>f,sN:()=>S,wS:()=>P});var r=n(38752),a=n(8453),o=n(72761),l=n(40468),s=n(12358),i=n.n(s),c=n(54320),d=n.n(c),p=n(74844),u=n(74065),h=n.n(u),m=n(85855),g=n.n(m);class P{static getFavIconUrl(e){return"https://"+P.extractHostname(e)+"/favicon.ico"}static generateEntityHyperlink(e,t,n,r){switch(e.entityType){case o.I.Task:return this.generateTaskHyperLink(e,t,n,r);case o.I.Plan:return this.generatePlanHyperLink(e,t,n,r);default:throw new Error("NotSupportedException: entity.type")}}static generateEntityLink(e,t,n,r){switch(e.entityType){case o.I.Task:return this.generateTaskLink(e,t,n,r);case o.I.Plan:return this.generatePlanLink(e,t,n,r);default:throw new Error("NotSupportedException: entity.type")}}static generateOWAGroupEmailSettingsLink(e,t,n){if(d()(e))return n.logTrace(508047762,p.k.Warning,"Empty owa host. Hiding the whole owa link."),"";if(d()(t)||t.indexOf("@")<0||t.indexOf("@")!==t.lastIndexOf("@"))return`https://${e}`;{const n=t.split("@")[0];return`https://${e}/mail/group/${t.split("@")[1]}/${n}/action/EmailSettings`}}static extractHostname(e){let t="";return t=e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0],t=t.split(":")[0],t=t.split("?")[0],t=t.split("#")[0],t}static getPlanExternalUrl(e,t){const n=l.T.builder.withPlan(e).withDetails(t).build(),r=n.getCreationContextInfo()?.key;let a=null;return r&&(a=t.contextDetails[r].url??null),a}static generateTaskHyperLink(e,t,n,r){return'<a href="'+this.generateTaskLink(e,t,n,r)+'" target="_blank" rel="noopener noreferrer">'+i()(e.title)+"</a>"}static generatePlanHyperLink(e,t,n,r){return'<a href="'+this.generatePlanLink(e,t,n,r)+'" target="_blank" rel="noopener noreferrer">'+i()(e.title)+"</a>"}static generateTaskLink(e,t,n,o){return e.creationSource.external?.contextScenarioId===a.z.project&&e.creationSource.external?.webUrl?e.creationSource.external?.webUrl:this.generatePlannerLink(`${r.B.absoluteRedirectRoot}/Home/Task/${e.id}`,t,n,o)}static generatePlanLink(e,t,n,a){return this.generatePlannerLink(`${r.B.absoluteRedirectRoot}/Home/PlanViews/${e.id}`,t,n,a)}static generatePlannerLink(e,t,n,r){return`${e}?Type=${t}&Channel=${n}&CreatedTime=${621355968e9+1e4*r.getTime()}`}static getValidUrl(e){const t=P.formatUrlWithHttpUrlScheme(e);return P.validateUrl(t)}static formatUrlWithHttpUrlScheme(e){return P.getUrlScheme(e).toLowerCase()===P.httpScheme?P.ensureUrlScheme(e,P.httpScheme):P.ensureUrlScheme(e,P.httpsScheme)}static validateUrl(e){try{const t=new URL(e);if(!t.host||!t.hostname||!t.origin||"null"===t.origin||"http:"!==t.protocol&&"https:"!==t.protocol)return;return t.toString()}catch{return}}static getUrlScheme(e){const t=new RegExp("(.*)://.*","i").exec(e)||[];return h()(t)||""}static ensureUrlScheme(e,t){return`${t&&g()(t.split("://"))}://${P.removeUrlScheme(e)}`}static removeUrlScheme(e){const t=new RegExp("(http(s)?(:)?(//)?)*(.*)","i").exec(e)||[];return h()(t)||""}static getQueryParamValue(e,t){return new URLSearchParams(new URL(e).search).get(t)}}function f(e){return`${b()}hubnew?importPlanId=${e}`}function k(){return`${r.B.clientSettings.ECSSettings.ProjectServiceConfig.Hostname}trialFRE#templates`}function S(){return`${r.B.clientSettings.ECSSettings.ProjectServiceConfig.Hostname}trialFRE#templates/{0}`}function b(){return`${r.B.clientSettings.ECSSettings.ProjectServiceConfig.Hostname}${r.B.tenantDomain}/${r.B.culture}#/`}P.httpScheme="http",P.httpsScheme="https"},72037:e=>{e.exports=function(e){return function(t){return null==e?void 0:e[t]}}},85855:(e,t,n)=>{e.exports=n(96483)},91900:(e,t,n)=>{"use strict";n.d(t,{n:()=>d});var r=n(65043),a=n(16112),o=n(22317),l=n(66783),s=n(52195);const i=(0,l.J9)(()=>({anchor:{minHeight:"1px"}})),c=(0,l.J9)(e=>({anchor:(0,s.Zq)("virtualContainer-anchor",e.anchor)}));class d extends a.${componentDidUpdate(e,t){e.containerId!==this.props.containerId&&this.setState({hasLoaded:!1})}renderComponent(){return r.createElement(r.Fragment,null,this.renderIntersectionObs(),this.props.children)}renderIntersectionObs(){const e=this.getClassNames();return r.createElement("div",{className:"virtualContainer-wrapper"},r.createElement(o.pL,{onChange:this.handleInView,triggerOnce:!0},r.createElement("div",{className:e.anchor})))}getClassNames(){return c(i())}constructor(e,t){super(e,t),this.name=()=>"VirtualContainer",this.handleInView=e=>{!this.state.hasLoaded&&e&&(this.props.onLoad(),this.setState({hasLoaded:!0}))},this.state={hasLoaded:!1}}}},95694:(e,t,n)=>{var r=n(72037)({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});e.exports=r},96483:e=>{e.exports=function(e){return e&&e.length?e[0]:void 0}},99788:(e,t,n)=>{"use strict";n.r(t),n.d(t,{PlannerInsertionComponent:()=>Re,loopExport:()=>Te});var r=n(15834),a=n(70579),o=n(97950),l=n(65043),s=n(81540),i=n(28184),c=n(96623),d=n(67239),p=n(7509),u=n(3683),h=n(85849),m=n(44535),g=n(36060),P=n(27678);const f=e=>{const{getPlanImage:t,planName:n,className:r}=e,[a,o]=l.useState(null);let s;if(l.useEffect(()=>{t().then(e=>{o(e)})},[t]),null!=a)s=l.createElement("img",{src:a,alt:""});else{const e=m.$.parseInitialsFromName(n),t=(0,g.K)((0,P.wV)(n));s=l.createElement("span",{className:t},e)}return l.createElement("div",{className:r},s)};var k=n(91900),S=n(56415),b=n(93),v=n(66151),I=n(72943);var y=n(89379),E=n(65804);const C=(0,y.Z)(),x=(0,E.I)(e=>{let{fetchPlanData:t,getPlanImage:n,item:r,styles:a,theme:o}=e;const s=C(a,{theme:o}),[i,c]=l.useState(!1),d=l.useCallback(()=>{t(r.planId).then(()=>{c(!0)})},[r.planId,t]);return l.createElement(k.n,{containerId:r.planId,onLoad:d},i&&l.createElement("div",{className:s.root},l.createElement(f,{className:s.icon,getPlanImage:()=>n(r.planId),planName:r.planName}),l.createElement("span",null,r.planName)))},e=>{let{theme:t}=e;return{root:["planItem",(0,v.gS)(),(0,v.aS)(t),{display:"flex",alignItems:"center",cursor:"pointer"}],icon:["planIcon",(0,v.gS)(),{"> *":[{width:"20px",height:"20px",padding:"1px",borderRadius:"4px",textAlign:"center",color:S.z.White},(0,I.Al)({color:b.B.WindowText})],paddingRight:"10px"}]}});var L=n(50724),w=n(45099),N=n(77508),U=n(66783),D=n(52195);const M=(0,U.J9)(e=>({root:[(0,v.Ss)(e),{height:"200px"}],headerWrapper:{".ms-DetailsHeader":(0,v.fe)(e)}})),R=(0,U.J9)(e=>({root:{":hover":{background:"inherit"}},check:{display:"none"},title:[(0,v.aS)(e),{cursor:"auto"}],expand:[(0,v.aS)(e),{cursor:"pointer",":hover, :active, :focus":{background:"inherit"}}],headerCount:{display:"none"}})),T=(0,U.J9)(e=>({root:[{background:"inherit","&.is-selected":[O(e),(0,I.hS)(),{".is-row-header":{fontWeight:D.BO.regular},".planItem":(0,I.h8)(),":hover, :focus":[(0,I.hS)(),{".planItem":(0,I.h8)(),".planIcon > span":(0,I.kE)()}]}],":hover":{".planItem":(0,I.c3)(),".planIcon > span":(0,I.kE)()},".planIcon > span":(0,I.kE)()},W(e)]})),W=(0,U.J9)(e=>{let t;switch(e){case N.Sx.LoopLight:t={":hover, :focus":{backgroundColor:S.z.NeutralLighterAlt,color:S.z.NeutralPrimaryAlt}};break;case N.Sx.LoopDark:t={":hover, :focus":{backgroundColor:S.z.NeutralDarkGrey12,color:S.z.NeutralDarkGrey84}}}return t}),O=(0,U.J9)(e=>{let t;switch(e){case N.Sx.LoopLight:t={backgroundColor:S.z.LoopLightInsertPlanModalSelectedColor,color:S.z.NeutralPrimaryAlt,":focus, :hover":{backgroundColor:S.z.LoopLightInsertPlanModalSelectedColor,color:S.z.NeutralPrimaryAlt}};break;case N.Sx.LoopDark:t={backgroundColor:S.z.LoopDarkInsertPlanModalSelectedColor,color:S.z.NeutralPrimaryAlt,":focus, :hover":{backgroundColor:S.z.LoopDarkInsertPlanModalSelectedColor,color:S.z.NeutralPrimaryAlt}}}return t}),j=e=>{const{rowProps:t,onClickPlanItem:n,theme:r}=e,a=t.item,o=l.useCallback(e=>{e.keyCode!==L.D.ENTER&&e.keyCode!==L.D.SPACE||n(a.planId)},[n,a]);return l.createElement("div",{className:"planItemRow",onClick:()=>n(a.planId),onKeyDown:o},l.createElement(w.h,{...t,styles:T(r)}))};var _=n(59846),H=n(35375),z=n(87797),B=n(86053);const $=e=>({key:"plans",name:B.p.Strings.LoopInsertPlanModal_PlansListTitle,minWidth:200,maxWidth:200,isRowHeader:!0,isCollapsible:!1,onRender:e}),Y=(e,t)=>{const n=e?Object.keys(e.references).length:0,r=t?Object.keys(t.references).length:0,a=[];if(n>0){const e={key:"pinnedGroup",name:B.p.Strings.LoopInsertPlanModal_PinnedPlansTitle,startIndex:0,count:n};a.push(e)}if(r>0){const e={key:"recentGroup",name:B.p.Strings.LoopInsertPlanModal_RecentPlansTitle,startIndex:n,count:r,isCollapsed:n>0};a.push(e)}return a};function A(e){let{onClickPlanItem:t,fetchPlanData:n,getPlanImage:r,pinnedPlans:a,recentPlans:o,theme:s}=e;const[i,c]=(0,l.useState)(Y(a,o)),d=(0,l.useCallback)(e=>l.createElement(j,{rowProps:e,onClickPlanItem:t,theme:s}),[t,s]),m=(0,l.useCallback)(e=>e.planId,[]),g={headerProps:{styles:R(s),expandButtonIcon:_.rK.iconName}},P=l.useMemo(()=>((e,t)=>null==e&&null==t?[]:[...null==e?[]:Object.keys(e.references).map(t=>({planId:t,planName:e.references[t].title})).sort((t,n)=>H.j.CompareByAlpha(e.references[t.planId],e.references[n.planId])),...null==t?[]:Object.keys(t.references).filter(t=>!e||!(t in e.references)).map(e=>({planId:e,planName:t.references[e].title,lastAccessDate:t.references[e].lastAccess})).sort((e,n)=>z.S.CompareByDateAndAlpha(t.references[e.planId],t.references[n.planId]))])(a,o),[a,o]);return(0,l.useEffect)(()=>{c(e=>{const t=Y(a,o);return t.forEach(t=>{const n=e.find(e=>e.key===t.key);n&&(t.isCollapsed=n.isCollapsed)}),t})},[a,o]),l.createElement(p.R,{viewport:{height:200,width:400},getKey:m,setKey:"set",items:P,groups:i,columns:[$(e=>l.createElement(x,{item:e,fetchPlanData:n,getPlanImage:r,theme:s}))],groupProps:g,onRenderDetailsHeader:()=>null,onRenderRow:d,compact:!0,selectionMode:u.Qc.single,checkboxVisibility:h.GY.hidden,selectionPreservedOnEmptyClick:!0,styles:M(s)})}var V=n(9442);const F=(0,U.J9)(e=>{let{theme:t}=e;return{header:["loopInsertPlanHeader",(0,v.gS)(),(0,v.aS)(t),{justifyContent:"space-between"}],body:["loopInsertPlanBody",(0,v.gS)("column"),{padding:"2px"}],footer:["loopInsertPlanFooter",(0,v.gS)(),{justifyContent:"flex-end"}],titleSection:["titleSection",(0,v.gS)(),{".plannerLogo":{width:"25px",height:"25px",marginRight:"15px"},".title":{fontSize:"20px",fontWeight:"600",fontFamily:"Segoe UI"}}],infoSection:["infoSection",(0,v.gS)("column"),(0,v.Ml)(t)],planSecurityInfoSection:["planSecurityInfoSection",(0,v.gS)(),{padding:"20px 5px","> i":{paddingRight:"10px"}}],createNewPlanInfoSection:["createNewPlanInfoSection",{paddingBottom:"20px"}]}}),J=(0,U.J9)(e=>({main:[(0,v.Ph)(e),{height:"500px",width:"560px",borderRadius:"12px",padding:"30px",display:"flex"}],scrollableContent:[(0,v.gS)("column"),{justifyContent:"space-between"}]})),G=(0,U.J9)(e=>({root:[(0,v._D)(e),(0,I.c3)(),{cursor:"pointer",textDecoration:"underline",":hover, :focus":[(0,v._D)(e),(0,I.c3)(),{textDecoration:"underline"}]}]})),K={root:{width:140,borderRadius:6,paddingTop:10,paddingBottom:10,fontSize:14,fontWeight:600,cursor:"pointer"},rootHovered:[{backgroundColor:"inherit"},I.lZ],rootPressed:[{backgroundColor:"inherit"},I.lZ],labelHovered:(0,I.h8)()},Z=(0,U.J9)(e=>{const t={root:[{margin:"0 15px",border:"none","&:not(.is-disabled)":[X(e),(0,I.ji)(),(0,I.kE)(),{cursor:"pointer"}]},(0,I.kE)()],rootDisabled:[Q(e),(0,I.kE)()],rootHovered:[X(e),{border:"none"}],rootPressed:[X(e),{border:"none"}]};return(0,D.TW)(K,t)}),q=(0,U.J9)(e=>{const t={root:[(0,v.i9)(e),{marginRight:"16px",":hover":{span:(0,v.aS)(e)}}],rootHovered:{span:(0,v.aS)(e)}};return(0,D.TW)(K,t)}),Q=(0,U.J9)(e=>{let t;switch(e){case N.Sx.LoopLight:t={backgroundColor:S.z.NeutralLightGrey94,color:S.z.NeutralDarkGrey40};break;case N.Sx.LoopDark:t={backgroundColor:S.z.NeutralDarkGrey8,color:S.z.NeutralDarkGrey36}}return t}),X=(0,U.J9)(e=>{let t;switch(e){case N.Sx.LoopLight:t={backgroundColor:S.z.LoopBrand80,color:S.z.White};break;case N.Sx.LoopDark:t={backgroundColor:S.z.LoopBrand70,color:S.z.White}}return t});var ee=n(33268),te=n(80493);const ne=e=>{let{createNewPlanInfoString:t,plannerWebUrl:n,onClickPlannerWebUrlLink:r,className:a,theme:o}=e;const s=l.useCallback(()=>{r(),te.b.safelyOpenExternalUrl(n)},[n,r]),i=t.split("{0}");return 2!==i.length?null:l.createElement("span",{className:a},i[0],l.createElement(V.N,{href:n,onClick:s,styles:G(o),target:"_blank",rel:"noopener noreferrer"},ee.wS.removeUrlScheme(n)||"tasks.office.com"),i[1])};const re=n.p+"static/media/planner2.8e27f89bc2da530d3b02140677f5ae78.svg";var ae=n(20751),oe=n(46441),le=n(63485),se=n(11638);const ie=(0,y.Z)(),ce=(0,E.I)(e=>{let{pinnedPlans:t,recentPlans:n,plannerWebUrl:r,onClickPlannerWebUrlLink:a,fetchPlanData:o,getPlanImage:s,handleInsertPlan:i,onDismiss:c,modalProps:p,styles:u,theme:h}=e;const m=ie(u,{theme:h}),[g,P]=l.useState(null),f=l.useCallback(()=>{null!=g&&i(g)},[i,g]),k=l.useCallback(e=>{P(e)},[]);return l.createElement(oe.a,{...p,styles:J(h)},l.createElement("div",{className:m.header},l.createElement("div",{className:m.titleSection,role:"heading","aria-level":1},l.createElement("img",{className:"plannerLogo",src:re,role:"presentation"}),l.createElement("div",{className:"title"},B.p.Strings.LoopInsertPlanModal_ModalTitle)),l.createElement(d.K,{iconProps:_.s5,onClick:c,plannerTheme:h,ariaLabel:B.p.Strings.LoopInsertPlanModal_CloseButtonAriaLabel})),l.createElement("div",{className:m.body},l.createElement(A,{pinnedPlans:t,recentPlans:n,onClickPlanItem:k,fetchPlanData:o,getPlanImage:s,theme:h})),l.createElement("div",{className:m.infoSection},l.createElement("div",{className:m.planSecurityInfoSection},l.createElement(ae.I,_.I6),B.p.Strings.LoopInsertPlanModal_PlanSecurityInfo),l.createElement(ne,{createNewPlanInfoString:B.p.Strings.LoopInsertPlanModal_CreateNewPlanInfo,className:m.createNewPlanInfoSection,plannerWebUrl:r,onClickPlannerWebUrlLink:a,theme:h})),l.createElement("div",{className:m.footer},l.createElement(le.j,{onClick:f,disabled:null==g,styles:Z(h)},B.p.Strings.LoopInsertPlanModal_InsertButton),l.createElement(se.Y,{onClick:c,styles:q(h)},B.p.Strings.LoopInsertPlanModal_CancelButton)))},F);var de=n(7811);const pe=n.p+"static/media/loop-insert-plan-error.ebfdd5c45a1eb6916c23.webp",ue=n.p+"static/media/loop-insert-plan-no-plans.103217b5d81879ad1cfd.webp",he=(0,U.J9)(e=>{let{theme:t}=e;return{header:["header",(0,v.gS)(),(0,v.aS)(t),{justifyContent:"space-between"}],body:["loopInsertPlanBody",(0,v.gS)("column")],footer:["loopInsertPlanFooter",(0,v.gS)(),{justifyContent:"flex-end"}],title:["title",{fontSize:"20px",fontWeight:"600",fontFamily:"Segoe UI"}],message:["message",(0,v.Ml)(t),{textAlign:"center"}],image:["image",{width:"230px",height:"230px",alignSelf:"center",marginTop:"-20px",marginBottom:"20px"}]}}),me=(0,y.Z)(),ge=(0,E.I)(e=>{let{error:t,plannerWebUrl:n,onClickPlannerWebUrlLink:r,onDismiss:a,onRetry:o,styles:s,theme:i,modalProps:c}=e;const p=me(s,{theme:i}),u=Se(t);return l.createElement(oe.a,{...c,styles:J(i)},l.createElement("div",{className:p.header},l.createElement("div",{className:p.title},Pe(t)),l.createElement(d.K,{iconProps:_.s5,onClick:a,plannerTheme:i,ariaLabel:B.p.Strings.LoopInsertPlanModal_CloseButtonAriaLabel})),l.createElement("div",{className:p.body},l.createElement("img",{className:p.image,src:ke(t),role:"presentation"}),(()=>{const e=fe(t);return t===de.Yh.NoPlans?l.createElement(ne,{createNewPlanInfoString:e,className:p.message,plannerWebUrl:n,onClickPlannerWebUrlLink:r,theme:i}):l.createElement("div",{className:p.message},e)})()),l.createElement("div",{className:p.footer},u&&l.createElement(le.j,{onClick:o,styles:Z(i)},B.p.Strings.LoopInsertPlanErrorModal_RetryButton),l.createElement(se.Y,{onClick:a,styles:q(i)},u?B.p.Strings.LoopInsertPlanModal_CancelButton:B.p.Strings.LoopInsertPlanErrorModal_OkayButton)))},he),Pe=e=>{switch(e){case de.Yh.PlannerServiceDisabled:return B.p.Strings.LoopInsertPlanErrorModal_ErrorTitle_PlannerDisabled;case de.Yh.NoPlans:return B.p.Strings.LoopInsertPlanErrorModal_ErrorTitle_NoPlans;case de.Yh.Unknown:default:return B.p.Strings.LoopInsertPlanErrorModal_ErrorTitle_UnexpectedError}},fe=e=>{switch(e){case de.Yh.PlannerServiceDisabled:return B.p.Strings.LoopInsertPlanErrorModal_ErrorMessage_PlannerDisabled;case de.Yh.NoPlans:return B.p.Strings.LoopInsertPlanErrorModal_ErrorMessage_NoPlans;case de.Yh.Unknown:default:return B.p.Strings.LoopInsertPlanErrorModal_ErrorMessage_UnexpectedError}},ke=e=>{switch(e){case de.Yh.NoPlans:return ue;case de.Yh.PlannerServiceDisabled:case de.Yh.Unknown:default:return pe}},Se=e=>{switch(e){case de.Yh.PlannerServiceDisabled:case de.Yh.NoPlans:return!1;case de.Yh.Unknown:default:return!0}};var be=n(52956),ve=n(59498),Ie=n(95996),ye=n(59190),Ee=n(89404),Ce=n(16822);const xe=e=>{let{dependencies:t,resolvePlanUrl:n,theme:r,onModalInteractive:o}=e;const[d,p]=l.useState(!0),[u,h]=l.useState(null),[m,g]=l.useState(null),[P,f]=l.useState(null),{logger:k}=t,S=l.useRef(!1),b=l.useCallback(e=>{S.current||(S.current=!0,o(e))},[o]),v=l.useRef({}),I=l.useRef({}),y=l.useMemo(()=>(0,c.Vf)(t.tokenProvider,t.userContext,t.settingsProvider?.audience),[t]),E=e=>{e.name===ve.Hg.PlannerServiceBlockedError?f(de.Yh.PlannerServiceDisabled):f(de.Yh.Unknown)},C=l.useCallback(()=>{(0,c.zI)(y,k).then(e=>{let[t,n]=e;0===Object.keys(t.references).length&&0===Object.keys(n.references).length&&((0,Ie.Ot)(k,{eventName:ye.Fc.UsersHaveNoPlans}),f(de.Yh.NoPlans)),h(t),g(n)}).catch(e=>{(0,Ie.hO)(k,{eventName:ye.nb.GetPinnedAndRecentPlansFailed},e),E(e)})},[y,k]),x=l.useCallback(()=>{p(!1),n(void 0)},[n]),L=l.useMemo(()=>({isOpen:d}),[d]),w=l.useCallback(async e=>{try{let t=v.current[e];null==t&&(t=await(0,c.nT)(e,y,k),b(),((e,t)=>{v.current[e]=t})(e,t));const n=t.plan.container.externalId;let r=I.current[n];null==r&&(r=(0,be.R)(t.plan,t.planDetails,y,k),((e,t)=>{I.current[e]=t})(n,r))}catch(P){const n=null!=u?.references[e],r=null!=m?.references[e];n&&h(t=>t?t.removePlanReference(e):t),r&&g(t=>t?t.removePlanReference(e):t);!(P instanceof Ee.p||P instanceof Ce.N)&&(0,Ie.hO)(k,{eventName:ye.nb.FetchPlanDataFailed},P)}},[y,k,b,u,m]),N=l.useCallback(async e=>{const t=v.current[e];if(null==t)return null;const n=t.plan.container.externalId;return I.current[n]??null},[]),U=l.useCallback(()=>{(0,Ie.Ot)(k,{eventName:ye.Fc.PlannerWebUrlLinkClicked,eventSource:ye.my.InsertionModal})},[k]),D=l.useCallback(()=>{(0,Ie.Ot)(k,{eventName:ye.Fc.PlannerWebUrlLinkClicked,eventSource:ye.my.ErrorModal})},[k]),M=l.useCallback(e=>{const t=t=>{const r=t.plan.container.externalId,a=y.tenantId,o=(0,i.TX)(r,e,a,y.audience);n(o),(0,Ie.Ot)(k,{eventName:ye.Fc.PlanInserted})},r=v.current[e];null==r?(0,c.nT)(e,y,k).then(e=>{t(e)}).catch(e=>{E(e)}):t(r)},[n,y,k]),R=l.useCallback(()=>{f(null),C()},[C]),{modalAttributes:T}=(0,s.y)({trapFocus:!0});return l.useEffect(()=>{C()},[C]),l.useEffect(()=>{null!=P&&(P===de.Yh.NoPlans||P===de.Yh.PlannerServiceDisabled?b():b(new Error(P)))},[P,b]),l.useEffect(()=>{u&&m&&0===Object.keys(u.references).length&&0===Object.keys(m.references).length&&f(de.Yh.NoPlans)},[u,m]),(0,a.jsx)("div",{...T,children:P?(0,a.jsx)(ge,{error:P,plannerWebUrl:(0,i.P$)(y.audience),onClickPlannerWebUrlLink:D,onDismiss:x,onRetry:R,modalProps:L,theme:r}):(0,a.jsx)(ce,{pinnedPlans:u,recentPlans:m,handleInsertPlan:M,fetchPlanData:w,getPlanImage:N,plannerWebUrl:(0,i.P$)(y.audience),onClickPlannerWebUrlLink:U,onDismiss:x,modalProps:L,theme:r})})};var Le=n(52668);class we{constructor(e,t,n){this.dependencies=e,this.resolvePlanUrl=t,this.onViewRenderReady=n,this.getPlannerTheme=()=>{const e=this.dependencies.stylingProvider.themeProperties?.get(Le.e);return e===Le.L?N.Sx.LoopDark:N.Sx.LoopLight}}get HTMLView(){return this}async dispose(){this.element&&(o.unmountComponentAtNode(this.element),delete this.element)}async render(e){this.element=e;const t=(0,a.jsx)(xe,{dependencies:this.dependencies,resolvePlanUrl:this.resolvePlanUrl,theme:this.getPlannerTheme(),onModalInteractive:this.onViewRenderReady});o.render(t,e)}}var Ne=n(33788),Ue=n(83125),De=n(68639),Me=n(52059);class Re{constructor(e,t){this.providers=t,this.planUrlPromise=new Promise(e=>{this.resolvePlanUrl=e})}get ComponentInitializer(){return this}async initialize(){this.dependencies=await this.getDependenciesPromise()}get HTMLViewable(){return this}async getView(){if(!this.dependencies)throw new Error("Expected dependencies to be defined, got undefined");(0,Ie.Ot)(this.dependencies.logger,{eventName:ye.Fc.DiscoveryMenuPlannerClicked});const e=Ne.m.start(ye.Hl.RenderPlannerInsertionView,this.dependencies.logger,{isAPerformanceMetric:!0});return new we(this.dependencies,this.resolvePlanUrl,t=>{t?e.setResult(!1,{message:"ErrorInRenderPlannerInsertionView"},t):e.setResult(!0)})}get entityName(){return ye.Dg}get ComponentTelemetryMetadata(){return this}get LoopComponentUrl(){return this}async getLoopComponentUrl(){return await this.planUrlPromise}async getDependenciesPromise(){const e=this.providers;if(!e)throw new Error("Expected providers to be defined, got undefined");const[t,n,r,a,o]=await Promise.all([e.TokenProvider,e.UserContext,e.StylingProvider,e.SettingsProvider,e.NamespaceLogger]);if(!t)throw Error("Missing Token Providers");if(!r)throw Error("Missing Styling Provider");if(!o)throw Error("Missing Namespace Logger");const l=a?.audience??Me.CS;return{tokenProvider:t,userContext:{tenantId:await(0,De.E)(t,n,l)},settingsProvider:a,stylingProvider:r,logger:new Ue.p(ye.Dg,o)}}}const Te=new r.p(Re,{TokenProvider:"TokenProvider",UserContext:"UserContext",StylingProvider:"StylingProvider",SettingsProvider:"SettingsProvider",NamespaceLogger:"NamespaceLogger"})}}]);
//# sourceMappingURL=55832.10d319d1.chunk.js.map