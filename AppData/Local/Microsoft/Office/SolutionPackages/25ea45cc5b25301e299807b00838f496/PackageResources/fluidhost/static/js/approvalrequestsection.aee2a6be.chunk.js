"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[81514],{49784:(e,t,r)=>{r.r(t),r.d(t,{ApprovalRequestSection:()=>we});var o=r(16112),s=r(39410),n=r(66151),a=r(66783),i=r(52195),p=r(75472);const l="24px",c=(0,a.J9)((e,t)=>(0,i.TW)({addApproverPicker:[{borderRadius:"5px",height:"450px"}],compactPeoplePicker:[{width:"260px",marginTop:"15px",marginInline:"15px"}]},t)),d=(0,a.J9)((e,t)=>{const r={root:[(0,n.NX)(e),{padding:"16px 0px"}],calloutMain:[(0,n.aS)(e),(0,n.NX)(e),{overflowY:"hidden"}]};return(0,i.TW)(r,t)}),u=(0,a.J9)((e,t)=>{const r={root:[{margin:`0px ${l} ${(0,p.vb)((0,p.jz)(l)/2)} ${l}`}],text:{border:"none","::after":(0,n.T4)(e)},input:[(0,n.aS)(e),(0,n.zK)(e),(0,n.Oj)(e),{minHeight:"34px"}]};return(0,i.TW)(r,t)}),h=(0,a.J9)(e=>({addApproverPicker:(0,i.Zq)("addApproverPicker",e.addApproverPicker),compactPeoplePicker:(0,i.Zq)("compactPeoplePicker",e.compactPeoplePicker)}));var m=r(65043),v=r(50605),A=r(6017),g=r(17323),C=r(86053);const f={mostRecentlyUsedHeaderText:C.p.Strings.AddApprover_AddApproverPicker_Suggestions,noResultsFoundText:C.p.Strings.AddApprover_AddApproverPicker_NoResultsFound,loadingText:C.p.Strings.AddApprover_AddApproverPicker_Loading,showRemoveButtons:!1};class S extends o.${name(){return"AddApproverPicker"}renderComponent(){const e=this.getClassNames(),t=e=>this.props.peopleList.filter(t=>function(e,t){return 0===e.toLowerCase().indexOf(t.toLowerCase())}(t.text,e)),r=(0,v.jI)();return m.createElement(s.P,{isBeakVisible:!1,gapSpace:0,doNotLayer:!0,target:this.props.targetElement,directionalHint:r?A.A.leftTopEdge:A.A.rightTopEdge,className:e.addApproverPicker,styles:d(this.props.theme),onDismiss:this.props.onDismissPicker,setInitialFocus:!0},m.createElement(g.HQ,{className:e.compactPeoplePicker,onResolveSuggestions:(e,r,o)=>{if(e){let s=t(e);return s=x(s,r),s=o?s.slice(0,o):s,s}return[]},onEmptyResolveSuggestions:e=>x(this.props.peopleList,e),getTextFromItem:_,pickerSuggestionsProps:f,onChange:this.props.onSelectedPerson,styles:u(this.props.theme)}))}getClassNames(){return h(c(this.props.theme))}constructor(e,t){super(e,t),this.state={}}}function _(e){return e.text??""}function x(e,t){return e.filter(e=>!function(e,t){if(0===t?.length)return!1;return t.filter(t=>t.text===e.text).length>0}(e,t))}var D,k=r(65804),T=r(56851),y=r(89379),q=r(27480),R=r(78233),P=r(9833),b=r(17066);!function(e){e[e.normal=0]="normal",e[e.compact=1]="compact"}(D||(D={}));var I=r(82014),B=r(19487),N=(0,y.Z)(),E=m.createContext({}),w=function(e){function t(t){var r=e.call(this,t)||this;return r._rootElement=m.createRef(),r._onClick=function(e){r._onAction(e)},r._onKeyDown=function(e){e.which!==q.c.enter&&e.which!==q.c.space||r._onAction(e)},r._onAction=function(e){var t=r.props,o=t.onClick,s=t.onClickHref,n=t.onClickTarget,a=(0,B.k_)(r.context);o?o(e):!o&&s&&(n?a.open(s,n,"noreferrer noopener nofollow"):a.location.href=s,e.preventDefault(),e.stopPropagation())},(0,R.f)(r),(0,P.A)("DocumentCard",t,{accentColor:void 0}),r}return(0,T.__extends)(t,e),t.prototype.render=function(){var e,t=this.props,r=t.onClick,o=t.onClickHref,s=t.children,n=t.type,a=t.accentColor,i=t.styles,p=t.theme,l=t.className,c=(0,b.G1)(this.props,b.JM,["className","onClick","type","role"]),d=!(!r&&!o);this._classNames=N(i,{theme:p,className:l,actionable:d,compact:n===D.compact}),n===D.compact&&a&&(e={borderBottomColor:a});var u={role:this.props.role||(d?r?"button":"link":void 0),tabIndex:d?0:void 0};return m.createElement("div",(0,T.__assign)({ref:this._rootElement,role:"group",className:this._classNames.root,onKeyDown:d?this._onKeyDown:void 0,onClick:d?this._onClick:void 0,style:e},c),m.createElement(E.Provider,{value:u},s))},t.prototype.focus=function(){this._rootElement.current&&this._rootElement.current.focus()},t.defaultProps={type:D.normal},t.contextType=I._0,t}(m.Component),U=r(42815),M={root:"ms-DocumentCardPreview",icon:"ms-DocumentCardPreview-icon",iconContainer:"ms-DocumentCardPreview-iconContainer"},W={root:"ms-DocumentCardActivity",multiplePeople:"ms-DocumentCardActivity--multiplePeople",details:"ms-DocumentCardActivity-details",name:"ms-DocumentCardActivity-name",activity:"ms-DocumentCardActivity-activity",avatars:"ms-DocumentCardActivity-avatars",avatar:"ms-DocumentCardActivity-avatar"},L={root:"ms-DocumentCardTitle"},F={root:"ms-DocumentCardLocation"},O={root:"ms-DocumentCard",rootActionable:"ms-DocumentCard--actionable",rootCompact:"ms-DocumentCard--compact"},j=(0,k.I)(w,function(e){var t,r,o=e.className,s=e.theme,n=e.actionable,a=e.compact,p=s.palette,l=s.fonts,c=s.effects,d=(0,i.Km)(O,s);return{root:[d.root,{WebkitFontSmoothing:"antialiased",backgroundColor:p.white,border:"1px solid ".concat(p.neutralLight),maxWidth:"320px",minWidth:"206px",userSelect:"none",position:"relative",selectors:(t={":focus":{outline:"0px solid"}},t[".".concat(U.Y2," &:focus, :host(.").concat(U.Y2,") &:focus")]=(0,i.Sq)(p.neutralSecondary,c.roundedCorner2),t[".".concat(F.root," + .").concat(L.root)]={paddingTop:"4px"},t)},n&&[d.rootActionable,{selectors:{":hover":{cursor:"pointer",borderColor:p.neutralTertiaryAlt},":hover:after":{content:'" "',position:"absolute",top:0,right:0,bottom:0,left:0,border:"1px solid ".concat(p.neutralTertiaryAlt),pointerEvents:"none"}}}],a&&[d.rootCompact,{display:"flex",maxWidth:"480px",height:"108px",selectors:(r={},r[".".concat(M.root)]={borderRight:"1px solid ".concat(p.neutralLight),borderBottom:0,maxHeight:"106px",maxWidth:"144px"},r[".".concat(M.icon)]={maxHeight:"32px",maxWidth:"32px"},r[".".concat(W.root)]={paddingBottom:"12px"},r[".".concat(L.root)]={paddingBottom:"12px 16px 8px 16px",fontSize:l.mediumPlus.fontSize,lineHeight:"16px"},r)}],o]}},void 0,{scope:"DocumentCard"}),H=r(72799),V=r(44388),Z=(0,y.Z)(),J=function(e){function t(t){var r=e.call(this,t)||this;return r._titleElement=m.createRef(),r._truncateTitle=function(){r._needMeasurement&&r._async.requestAnimationFrame(r._truncateWhenInAnimation)},r._truncateWhenInAnimation=function(){var e=r.props.title,t=r._titleElement.current;if(t){var o=getComputedStyle(t);if(o.width&&o.lineHeight&&o.height){var s=t.clientWidth,n=t.scrollWidth;r._clientWidth=s;var a=Math.floor((parseInt(o.height,10)+5)/parseInt(o.lineHeight,10));t.style.whiteSpace="";var i=n/(parseInt(o.width,10)*a);if(i>1){var p=e.length/i-3;return r.setState({truncatedTitleFirstPiece:e.slice(0,p/2),truncatedTitleSecondPiece:e.slice(e.length-p/2)})}}}},r._shrinkTitle=function(){var e=r.state,t=e.truncatedTitleFirstPiece,o=e.truncatedTitleSecondPiece;if(t&&o){var s=r._titleElement.current;if(!s)return;(s.scrollHeight>s.clientHeight+5||s.scrollWidth>s.clientWidth)&&r.setState({truncatedTitleFirstPiece:t.slice(0,t.length-1),truncatedTitleSecondPiece:o.slice(1)})}},(0,R.f)(r),r._async=new H.j(r),r._events=new V.g(r),r._clientWidth=void 0,r.state={truncatedTitleFirstPiece:void 0,truncatedTitleSecondPiece:void 0},r}return(0,T.__extends)(t,e),t.prototype.componentDidUpdate=function(e){var t=this;if(this.props.title!==e.title&&this.setState({truncatedTitleFirstPiece:void 0,truncatedTitleSecondPiece:void 0}),e.shouldTruncate!==this.props.shouldTruncate){var r=(0,B.k_)(this.context);this.props.shouldTruncate?(this._truncateTitle(),this._async.requestAnimationFrame(this._shrinkTitle),this._events.on(r,"resize",this._updateTruncation)):this._events.off(r,"resize",this._updateTruncation)}else this._needMeasurement&&this._async.requestAnimationFrame(function(){t._truncateWhenInAnimation(),t._shrinkTitle()})},t.prototype.componentDidMount=function(){if(this.props.shouldTruncate){this._truncateTitle();var e=(0,B.k_)(this.context);this._events.on(e,"resize",this._updateTruncation)}},t.prototype.componentWillUnmount=function(){this._events.dispose(),this._async.dispose()},t.prototype.render=function(){var e=this,t=this.props,r=t.title,o=t.shouldTruncate,s=t.showAsSecondaryTitle,n=t.styles,a=t.theme,i=t.className,p=this.state,l=p.truncatedTitleFirstPiece,c=p.truncatedTitleSecondPiece;return this._classNames=Z(n,{theme:a,className:i,showAsSecondaryTitle:s}),o&&l&&c?m.createElement(E.Consumer,null,function(t){var o=t.role,s=t.tabIndex;return m.createElement("div",{className:e._classNames.root,ref:e._titleElement,title:r,tabIndex:s,role:o},l,"\u2026",c)}):m.createElement(E.Consumer,null,function(t){var o=t.role,s=t.tabIndex;return m.createElement("div",{className:e._classNames.root,ref:e._titleElement,title:r,tabIndex:s,role:o,style:e._needMeasurement?{whiteSpace:"nowrap"}:void 0},r)})},Object.defineProperty(t.prototype,"_needMeasurement",{get:function(){return!!this.props.shouldTruncate&&void 0===this._clientWidth},enumerable:!1,configurable:!0}),t.prototype._updateTruncation=function(){var e=this;this._timerId||(this._timerId=this._async.setTimeout(function(){delete e._timerId,e._clientWidth=void 0,e.setState({truncatedTitleFirstPiece:void 0,truncatedTitleSecondPiece:void 0})},250))},t.contextType=I._0,t}(m.Component),z=(0,k.I)(J,function(e){var t,r=e.theme,o=e.className,s=e.showAsSecondaryTitle,n=r.palette,a=r.fonts,p=r.effects;return{root:[(0,i.Km)(L,r).root,s?a.medium:a.large,{padding:"8px 16px",display:"block",overflow:"hidden",position:"relative",wordWrap:"break-word",height:s?"45px":"38px",lineHeight:s?"18px":"21px",color:s?n.neutralSecondary:n.neutralPrimary,selectors:(t={":focus":{outline:"0px solid"}},t[".".concat(U.Y2," &:focus, :host(.").concat(U.Y2,") &:focus")]=(0,i.Sq)(n.neutralSecondary,p.roundedCorner2),t)},o]}},void 0,{scope:"DocumentCardTitle"}),$=r(9011),Y=r(72721),G=r(63485),X=r(11638);const K="239px",Q=(0,a.J9)((e,t)=>{const r={addApproverDraft:[{borderRadius:"10px",".DraftTitle":{borderBottom:"1px solid lightgray",fontWeight:"bold",fontSize:"12px",width:K,height:"20px",backgroundColor:"rgba(0,0,0,0)"},".DraftPerson":[{margin:"10px",width:K}],".DraftButtonGroup":{marginBottom:"10px",width:K}}],draftButton:{borderRadius:"5px",marginLeft:"10px","&.ms-Button--primary":[(0,n.jU)(e)],"&.ms-Button--default":[(0,n.i9)(e)]}};return(0,i.TW)(r,t)}),ee=(0,a.J9)(e=>({addApproverDraft:(0,i.Zq)("addApproverDraft",e.addApproverDraft),draftButton:(0,i.Zq)("draftButton",e.draftButton)})),te="10px",re="10px",oe="12px",se=(0,a.J9)((e,t)=>{const r={titleSection:[(0,n.gS)(),(0,n.aS)(e),{".requiredMark":{color:(0,n.Qt)(e)},".labelTag":{marginRight:te,marginLeft:te}}],historySection:{marginTop:re,marginBottom:re},linkSection:[(0,n.NX)(e),(0,n.gS)(),{".addApproverText":[{textAlign:"start",marginLeft:"10px"}]}],retryButton:{"&.ms-Button--default":[(0,n.i9)(e)]},addApproverButton:[{"> button":[(0,n.BP)(e),(0,n.gS)(),{border:"none",background:"none",fontSize:i.s.medium,cursor:"pointer"}]}],approvalsSection:{margin:"20px 0px"}};return(0,i.TW)(r,t)}),ne=(0,a.J9)((e,t)=>{const r={root:[(0,n.aS)(e),(0,n.NX)(e),(0,n.au)(e),{".ms-DocumentCardTitle":(0,n.aS)(e),".ms-Persona-primaryText":(0,n.aS)(e),".ms-Persona-secondaryText":(0,n.aS)(e),width:"270px"}]};return(0,i.TW)(r,t)}),ae=(0,a.J9)(e=>({primaryText:{fontSize:oe,fontWeight:500,":hover":[(0,n.aS)(e)]},secondaryText:{fontSize:oe}})),ie=(0,a.J9)((e,t)=>{const r={label:[{margin:"0px"}]};return(0,i.TW)(r,t)}),pe=(0,a.J9)(e=>({titleSection:(0,i.Zq)("titleSection",e.titleSection),historySection:(0,i.Zq)("historySection",e.historySection),linkSection:(0,i.Zq)("linkSection",e.linkSection),retryButton:(0,i.Zq)("retryButton",e.retryButton),addApproverButton:(0,i.Zq)("addApproverButton",e.addApproverButton),approvalsSection:(0,i.Zq)("approvalsSection",e.approvalsSection)}));class le extends o.${name(){return"AddApproverDraft"}renderComponent(){const e=this.getClassNames();return m.createElement(j,{styles:ne(this.props.theme),className:e.addApproverDraft},m.createElement(z,{title:C.p.Strings.AddApprover_AddApproverDraft_SendApprovalRequestFor,className:"DraftTitle",styles:ne(this.props.theme)}),m.createElement($.F,{className:"DraftPerson",...this.props.selectedPerson,size:Y.WH.size32,presence:Y.As.online,styles:ae(this.props.theme)}),m.createElement("div",{className:"DraftButtonGroup"},m.createElement(G.j,{styles:ie(this.props.theme),className:e.draftButton,onClick:this.props.onSendRequest},C.p.Strings.AddApprover_AddApproverDraft_SendRequest),m.createElement(X.Y,{styles:ie(this.props.theme),className:e.draftButton,onClick:this.props.onDiscard},C.p.Strings.AddApprover_AddApproverDraft_Discard)))}getClassNames(){return ee(Q(this.props.theme))}constructor(e,t){super(e,t),this.state={}}}var ce,de,ue=r(38752),he=r(78332),me=r(98571),ve=r(67239),Ae=r(40520),ge=r(52342),Ce=r(54845),fe=r(80493),Se=r(48770);!function(e){e.Approve="Approve",e.Reject="Reject"}(ce||(ce={})),function(e){e.NotSpecified="NotSpecified",e.Owner="Owner",e.Approver="Approver",e.DelegatedAccess="DelegatedAccess"}(de||(de={}));var _e=r(59846);const xe="10px",De=(0,a.J9)((e,t)=>{const r={approvalCardDetail:[{borderRadius:"10px",".infoSection":[(0,n.gS)(),{margin:"5px",justifyContent:"space-between"}],".StatusText":[(0,n.au)(e),{borderBottomWidth:"1px",borderBottomStyle:"solid",fontWeight:"bold",fontSize:"14px",height:"20px"}],".personStatus":{float:"left",marginLeft:xe},".actionButtons":{marginTop:xe,marginBottom:xe,button:{marginLeft:xe}}}],moreButton:[(0,n.NX)(e),{float:"right",marginRight:xe}],dialog:[(0,n.aS)(e),{".ms-Dialog-main":{borderRadius:"10px"}}],dialogButton:{borderRadius:"5px","&.ms-Button--primary":[(0,n.jU)(e)],"&.ms-Button--default":[(0,n.i9)(e)]}};return(0,i.TW)(r,t)}),ke=(0,a.J9)(e=>({title:[(0,n.aS)(e),(0,n.NX)(e)],topButton:{".ms-Dialog-button":[(0,n.aS)(e),(0,n.NX)(e),{":hover":[(0,n.aS)(e),{backgroundColor:"transparent"}]}]},inner:[(0,n.aS)(e),(0,n.NX)(e)]})),Te=(0,a.J9)(e=>({approvalCardDetail:(0,i.Zq)("approvalCardDetail",e.approvalCardDetail),dialog:(0,i.Zq)("dialog",e.dialog),dialogButton:(0,i.Zq)("dialogButton",e.dialogButton),moreButton:(0,i.Zq)("moreButton",e.moreButton)}));class ye extends o.${name(){return"ApprovalCardDetail"}renderComponent(){const e=this.getClassNames(),t={imageUrl:this.props.showCardInfo.imageUrl,imageInitials:this.props.showCardInfo.imageInitials,text:this.convertStatusText().personText,secondaryText:this.props.showCardInfo.showPeople};return m.createElement(j,{styles:ne(this.props.theme),className:e.approvalCardDetail},m.createElement(z,{title:this.convertStatusText().titleText??"",className:"StatusText"}),m.createElement("div",{className:"infoSection"},m.createElement($.F,{className:"personStatus",...t,size:Y.WH.size40,styles:ae(this.props.theme)}),m.createElement("div",{ref:this._moreChoiceRef},m.createElement(ve.K,{className:e.moreButton,disabled:!this.props.enableMoreButtons,key:"more",iconProps:_e.XP,onClick:this.onTaskDialogMoreButtonClicked.bind(this),plannerTheme:this.props.theme}))),this.showApproverActions()?this.renderActionButtons():null,this.renderMoreOptionsContextMenu(),this.props.showCardInfo.status===Se.q.Requested?this.renderCancelDialog():this.props.showCardInfo.status===Se.q.Approved?this.renderClearDialog():null)}convertStatusText(){switch(this.props.showCardInfo.status){case Se.q.Requested:return{titleText:C.p.Strings.AddApprover_ApprovalCardDetail_StatusApprovalRequested,personText:C.p.Strings.AddApprover_ApprovalCardDetail_WaitingOn};case Se.q.Approved:return{titleText:C.p.Strings.AddApprover_ApprovalCardDetail_FinalStatusApproved,personText:C.p.Strings.AddApprover_ApprovalCardDetail_ApprovedBy};case Se.q.Rejected:case Se.q.Cancelled:case Se.q.UnknownFutureValue:default:return{titleText:C.p.Strings.AddApprover_AddApproverPicker_NAMark,personText:C.p.Strings.AddApprover_AddApproverPicker_NAMark}}}getClassNames(){return Te(De(this.props.theme))}onTaskDialogMoreButtonClicked(e){this.setState(e=>({...e,isDialogContextMenuOpen:!e.isDialogContextMenuOpen}))}renderMoreOptionsContextMenu(){if(!this.state.isDialogContextMenuOpen)return null;const e=[];switch(this.props.showCardInfo.status){case Se.q.Requested:e.push({key:"cancelRequest",name:C.p.Strings.AddApprover_ApprovalCardDetail_CancelRequest,title:C.p.Strings.AddApprover_ApprovalCardDetail_CancelRequest,iconProps:_e.s5,onClick:this.changeDialogCancelConfirmStatus.bind(this)}),this.props.userRole!==de.Approver&&this.props.userRole!==de.Owner||e.push({key:"viewInApp",name:C.p.Strings.AddApprover_ApprovalCardDetail_ViewInApprovalsApp,title:C.p.Strings.AddApprover_ApprovalCardDetail_ViewInApprovalsApp,iconProps:_e.M8,onClick:this.redirectToApprovalPage.bind(this)});break;case Se.q.Approved:e.push({key:"clearRequest",name:C.p.Strings.AddApprover_ApprovalCardDetail_ClearApprovalRequest,title:C.p.Strings.AddApprover_ApprovalCardDetail_ClearApprovalRequest,iconProps:_e.s5,onClick:this.changeDialogClearConfirmStatus.bind(this)}),this.props.userRole!==de.Approver&&this.props.userRole!==de.Owner||e.push({key:"viewInApp",name:C.p.Strings.AddApprover_ApprovalCardDetail_ViewInApprovalsApp,title:C.p.Strings.AddApprover_ApprovalCardDetail_ViewInApprovalsApp,iconProps:_e.M8,onClick:this.redirectToApprovalPage.bind(this)});case Se.q.Rejected:case Se.q.Cancelled:case Se.q.UnknownFutureValue:}return m.createElement(me.l,{shouldFocusOnMount:!0,target:this._moreChoiceRef.current,onDismiss:this.onMoreContextMenuDismiss.bind(this),directionalHint:A.A.bottomLeftEdge,items:e,appTheme:this.props.theme})}renderCancelDialog(){const e={type:Ae.h.normal,title:C.p.Strings.AddApprover_ApprovalCardDetail_CancelApprovalRequest,closeButtonAriaLabel:C.p.Strings.AddApprover_AddApproverPicker_CloseDialogAriaLabel,subText:C.p.Strings.AddApprover_ApprovalCardDetail_CancelApprovalRequestQuestion,styles:ke(this.props.theme)},t=this.getClassNames(),r={isBlocking:!0,className:t.dialog};return m.createElement(ge.l,{hidden:!this.state.isDialogCancelConfirmOpen,onDismiss:this.changeDialogCancelConfirmStatus.bind(this),dialogContentProps:e,modalProps:r,minWidth:this.dialogWidth},m.createElement(Ce.E,null,m.createElement(G.j,{onClick:this.onCancelApproval.bind(this),text:C.p.Strings.AddApprover_ApprovalCardDetail_YesCancel,className:t.dialogButton}),m.createElement(X.Y,{onClick:this.changeDialogCancelConfirmStatus.bind(this),text:C.p.Strings.AddApprover_ApprovalCardDetail_Close,className:t.dialogButton})))}renderClearDialog(){const e={type:Ae.h.normal,title:C.p.Strings.AddApprover_ApprovalCardDetail_ClearApprovalRequest,closeButtonAriaLabel:C.p.Strings.AddApprover_AddApproverPicker_CloseDialogAriaLabel,subText:C.p.Strings.AddApprover_ApprovalCardDetail_ClearApprovalRequestQuestion,styles:ke(this.props.theme)},t=this.getClassNames(),r={isBlocking:!0,className:t.dialog};return m.createElement(ge.l,{hidden:!this.state.isDialogClearConfirmOpen,onDismiss:this.changeDialogClearConfirmStatus.bind(this),dialogContentProps:e,modalProps:r},m.createElement(Ce.E,null,m.createElement(G.j,{onClick:this.onClearApproval.bind(this),text:C.p.Strings.AddApprover_ApprovalCardDetail_YesClear,className:t.dialogButton}),m.createElement(X.Y,{onClick:this.changeDialogClearConfirmStatus.bind(this),text:C.p.Strings.AddApprover_ApprovalCardDetail_Close,className:t.dialogButton})))}renderActionButtons(){const e=this.getClassNames();return m.createElement("div",{className:"actionButtons"},m.createElement(G.j,{styles:ie(this.props.theme),onClick:this.onUpdateApproval.bind(this,ce.Approve),text:C.p.Strings.AddApprover_ApprovalCardDetail_Approve,className:e.dialogButton}),m.createElement(X.Y,{styles:ie(this.props.theme),onClick:this.onUpdateApproval.bind(this,ce.Reject),text:C.p.Strings.AddApprover_ApprovalCardDetail_Reject,className:e.dialogButton}))}onMoreContextMenuDismiss(){this.setState({isDialogContextMenuOpen:!1})}changeDialogCancelConfirmStatus(){this.setState(e=>({...e,isDialogCancelConfirmOpen:!e.isDialogCancelConfirmOpen}))}changeDialogClearConfirmStatus(){this.setState(e=>({...e,isDialogClearConfirmOpen:!e.isDialogClearConfirmOpen}))}onCancelApproval(){this.props.onCancelApproval(),this.changeDialogCancelConfirmStatus()}onClearApproval(){this.props.onClearApproval(),this.changeDialogClearConfirmStatus()}onUpdateApproval(e){this.props.onUpdateApproval(e)}showApproverActions(){return this.props.showCardInfo.status===Se.q.Requested&&this.props.userRole===de.Approver}redirectToApprovalPage(){const e=`Default-${ue.B.tenantId}`,t=this.props.approvalId,r=this.props.userRole,o=encodeURIComponent(`{"subEntityId":"${`${r}:${t}:/providers/Microsoft.ProcessSimple/environments/approvalViews:${e}`}"}`),s=`https://${ue.B.clientSettings.TeamsSettings.TeamsHostName}/l/entity/${he.uc.ApprovalApp}/approvals?context=${o}`;fe.b.safelyOpenExternalUrl(s)}constructor(e,t){super(e,t),this.dialogWidth="600px",this._moreChoiceRef=m.createRef(),this.state={isDialogContextMenuOpen:!1,isDialogCancelConfirmOpen:!1,isDialogClearConfirmOpen:!1}}}var qe,Re=r(69412),Pe=r(40135),be=r(31537),Ie=r(20751),Be=r(21382),Ne=r(44535),Ee=r(91834);!function(e){e[e.Loading=0]="Loading",e[e.RetryButton=1]="RetryButton",e[e.Link=2]="Link",e[e.AddApproverDraft=3]="AddApproverDraft",e[e.ApprovalCardDetail=4]="ApprovalCardDetail",e[e.UnknownError=5]="UnknownError"}(qe||(qe={}));class we extends o.${name(){return"ApprovalRequestSection"}renderComponent(){const e=this.getClassNames(),t=this.generateApprovalCardDetailCardInfo(),r=this.getApprovalCardType();return 0===r?m.createElement(Pe.W,null):m.createElement("div",{className:e.approvalsSection},m.createElement("div",{className:e.titleSection},m.createElement(be.J,null,C.p.Strings.AddApprover_ApprovalRequestSection_ApprovalRequest,this.renderTitleMark(),this.renderStatusTag())),1===r&&this.renderRetryButton(),this.renderHistorySection(),2===r&&this.renderLinkSection(),3===r&&m.createElement(le,{theme:this.props.theme,selectedPerson:this.convertUserToApprovalPersona(this.props.selectedApprover),onDiscard:this.onDiscard,onSendRequest:this.onClickSendApprovalRequestButton}),4===r&&m.createElement(ye,{theme:this.props.theme,showCardInfo:t,approvalId:this.props.approvalInfo.approvalId,userRole:this.getUserRole(),onCancelApproval:this.onClickCancelApprovalRequestButton,onClearApproval:this.props.onClearApproval,onUpdateApproval:this.onClickUpdateApprovalRequestButton,enableMoreButtons:!this.props.isTaskCompleted}))}getApprovalCardType(){return this.props.isApprovalDataLoading||this.props.approvalDetailInfo?.status===Ee.ZB.Updating?0:this.props.approvalInfo?this.props.approvalDetailInfo?this.isApprovalDataValid()&&this.props.approvalInfo?.approvalStatus!==Se.q.Rejected&&this.props.approvalInfo?.approvalStatus!==Se.q.Cancelled?this.generateApprovalCardDetailCardInfo()?4:5:this.props.selectedApprover?3:2:1:this.props.selectedApprover?3:2}isApprovalDataValid(){return!(this.isApprovalError()||this.isApprovalDetailError()||!this.getApproverDisplayInfo())}isApprovalError(){return!this.props.approvalInfo?.approvalId||this.props.approvalInfo?.approvalStatus===Se.q.UnknownFutureValue}isApprovalDetailError(){return!this.props.approvalDetailInfo?.data||this.props.approvalDetailInfo?.status===Ee.ZB.DeleteFailed||this.props.approvalDetailInfo?.status===Ee.ZB.Failed||this.props.approvalDetailInfo?.status===Ee.ZB.Inaccessible}renderRetryButton(){return m.createElement("div",null,m.createElement(be.J,null,C.p.Strings.AddApprover_ApprovalRequestSection_ApprovalDetailAPIErrorMessage),m.createElement(X.Y,{className:this.getClassNames().retryButton,text:C.p.Strings.AddApprover_ApprovalRequestSection_Retry,onClick:this.props.onReloadApprovalData}))}renderTitleMark(){return this.props.approvalInfo?.approvalStatus===Se.q.Approved?m.createElement(Ie.I,_e.r8):m.createElement("text",{className:"requiredMark"},"*")}renderStatusTag(){let e=1,t=C.p.Strings.AddApprover_ApprovalRequestSection_Required;if(this.props.approvalInfo?.approvalId)switch(this.props.approvalInfo.approvalStatus){case Se.q.Requested:e=2,t=C.p.Strings.AddApprover_ApprovalRequestSection_Pending;break;case Se.q.Approved:e=3,t=C.p.Strings.AddApprover_ApprovalRequestSection_Approved;case Se.q.Cancelled:case Se.q.Rejected:case Se.q.UnknownFutureValue:}return m.createElement(Re.l,{index:e,isCollapsed:!1,title:t,showBorder:!1,theme:this.props.theme})}renderHistorySection(){if(!this.isApprovalDataValid())return null;const e=this.convertStatusText();return m.createElement("div",{className:this.getClassNames().historySection},m.createElement("b",null,e.resultText),e.requestText)}renderLinkSection(){return m.createElement("div",{className:this.getClassNames().linkSection},!this.props.selectedApprover&&this.renderAddApproverLink(),this.state.isPickerVisible&&this.renderAddApproverPicker())}renderAddApproverLink(){return m.createElement("div",{ref:this._linkButtonRef,className:this.getClassNames().addApproverButton},m.createElement("button",{onClick:this.onClickAddApproverLink},m.createElement(Ie.I,_e.D5),m.createElement("span",{className:"addApproverText"},C.p.Strings.AddApprover_AddApproverLink_AddAnApprover)))}renderAddApproverPicker(){return m.createElement(S,{theme:this.props.theme,peopleList:this.convertAssignees(),onSelectedPerson:this.onSelectedPerson,targetElement:this._linkButtonRef.current,onDismissPicker:this.onDismissApproverPicker})}generateApprovalCardDetailCardInfo(){const e=this.getApproverDisplayInfo();if(!this.props.approvalInfo?.approvalId||!e)return null;return{status:this.props.approvalInfo.approvalStatus,showPeople:e.approverName,imageUrl:e.approverImage,imageInitials:Ne.$.parseInitialsFromName(e.approverName)}}getApproverDisplayInfo(){const e=this.props.approvalDetailInfo?.data?.approvers??[];if(0===e.length||null===e[0])return null;const t=this.getUserInPrincipals(e[0]);return t?{approverName:t.displayName??"",approverImage:t.thumbnailPhoto??""}:null}getUserInPrincipals(e){return this.props.approvalDetailInfo?.data?.principals?.find(t=>t?.id===e)??null}convertStatusText(){const e=this.getApproverDisplayInfo(),t=this.props.approvalDetailInfo?.data,r=this.getUserInPrincipals(t?.owner?.id)?.displayName??"",o=e?.approverName??"",s=new Date(t.creationDate),n=s.toLocaleDateString(),a=s.toLocaleTimeString(),i=new Date(t.completionDate),p=i.toLocaleDateString(),l=i.toLocaleTimeString();switch(this.props.approvalInfo?.approvalStatus){case Se.q.Requested:return{resultText:"",requestText:Be.G(C.p.Strings.AddApprover_ApprovalRequestSection_RequestText_Requested,r,o,n,a)};case Se.q.Approved:return{resultText:Be.G(C.p.Strings.AddApprover_ApprovalRequestSection_ResultText_Approved,o,p,l),requestText:Be.G(C.p.Strings.AddApprover_ApprovalRequestSection_RequestText_Other,r,n,a)};case Se.q.Rejected:return{resultText:Be.G(C.p.Strings.AddApprover_ApprovalRequestSection_ResultText_Rejected,o,p,l),requestText:Be.G(C.p.Strings.AddApprover_ApprovalRequestSection_RequestText_Other,r,n,a)};case Se.q.Cancelled:return{resultText:Be.G(C.p.Strings.AddApprover_ApprovalRequestSection_ResultText_Cancelled,r,p,l),requestText:Be.G(C.p.Strings.AddApprover_ApprovalRequestSection_RequestText_Other,r,n,a)};case Se.q.UnknownFutureValue:default:return{resultText:C.p.Strings.AddApprover_ApprovalRequestSection_UnknownStatus_ErrorMessage,requestText:C.p.Strings.AddApprover_ApprovalRequestSection_UnknownStatus_ErrorMessage}}}convertAssignees(){return this.props.getAssigneePoolForApproval().map(e=>this.convertUserToApprovalPersona(e))}convertUserToApprovalPersona(e){const t=this.props.getUserPhoto(e.id);return{user:e,imageUrl:null==t?void 0:t,text:e.displayName}}getUserRole(){const e=this.props.approvalDetailInfo?.data,t=e?.owner,r=e?.approvers;return r?.includes(this.props.currentUserId)?de.Approver:t?.id===this.props.currentUserId?de.Owner:de.NotSpecified}getClassNames(){return pe(se(this.props.theme))}constructor(e,t){super(e,t),this._linkButtonRef=m.createRef(),this.onSelectedPerson=e=>{this.props.onSelectApprover(e.length>0?e[0].user:null),this.setState({isPickerVisible:!1})},this.onClickSendApprovalRequestButton=()=>{this.props.onSendApprovalRequest()},this.onDiscard=()=>{this.props.onSelectApprover(null)},this.onClickUpdateApprovalRequestButton=e=>{this.props.onUpdateApproval(e)},this.onClickCancelApprovalRequestButton=()=>{this.props.onCancelApproval()},this.onClickAddApproverLink=()=>{this.setState(e=>({...e,isPickerVisible:!e.isPickerVisible}))},this.onDismissApproverPicker=()=>{this.setState({isPickerVisible:!1})},this.state={isPickerVisible:!1}}}}}]);
//# sourceMappingURL=approvalrequestsection.aee2a6be.chunk.js.map