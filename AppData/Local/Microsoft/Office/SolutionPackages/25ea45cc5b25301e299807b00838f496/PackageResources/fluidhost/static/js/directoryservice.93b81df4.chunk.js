"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[33201],{61739:(e,i,t)=>{t.d(i,{Cx:()=>a,Ny:()=>n,n0:()=>o});var s=t(54320),r=t.n(s);function a(e){let i="";if(!r()(e))try{i=new URLSearchParams(new URL(e).search).get("$skiptoken")||""}catch(t){}return i}function n(e,i){return`startswith(${e}, '${t=i,encodeURIComponent(t).replace(/'/g,"''")}')`;var t}function o(e){const i="https://graph.microsoft.com/";return e&&0===e.indexOf(i)&&(e=e.substring(28)),e}},76241:(e,i,t)=>{var s;t.d(i,{X:()=>s}),function(e){e[e.Public=0]="Public",e[e.Private=1]="Private",e[e.HiddenMembership=2]="HiddenMembership"}(s||(s={}))},81704:(e,i,t)=>{t.d(i,{Vj:()=>l});var s=t(34677),r=t.n(s),a=t(38752),n=t(31028),o=t(98502);function l(e){return r()({maxRetryCount:a.B.clientSettings.RetrySettings.MaxRetryCount,maxRetryTimeoutInMiliseconds:a.B.clientSettings.RetrySettings.MaxRetryTimeout,delayOnRetryInMiliseconds:a.B.clientSettings.RetrySettings.RetryDelay,retryCheck:u},e)}async function u(e,i,t){return(0,n.g)(e)&&o.g.isRetryableResponse(i,t)}},92970:(e,i,t)=>{t.d(i,{E:()=>g});var s=t(17002),r=t.n(s),a=t(54320),n=t.n(a),o=t(36777),l=t.n(o),u=t(76241),c=t(91246);class h{build(){return new g(this)}fromUnifiedGroupResource(e){let i;switch(e.Visibility?.toLowerCase()??""){case"private":i=u.X.Private;break;case"hiddenmembership":i=u.X.HiddenMembership;break;default:i=u.X.Public}return this.withPropertyBag({assignedSensitivityLabelId:e.assignedSensitivityLabelId,autoSubscribeNewMembers:e.AutoSubscribeNewMembers,classification:e.Classification,description:e.Description,displayName:e.DisplayName,id:e.Id,imageSource:e.ImageSource,mail:e.Mail,mailNickname:e.MailNickname,visibility:i})}fromGraphResource(e){let i;switch(e.visibility?.toLowerCase()??""){case"hiddenmembership":i=u.X.HiddenMembership;break;case"private":i=u.X.Private;break;default:i=u.X.Public}return this.withPropertyBag({assignedSensitivityLabelId:null!=e.assignedLabels?.[0]?e.assignedLabels[0].labelId:"",autoSubscribeNewMembers:e.autoSubscribeNewMembers,classification:e.classification,description:e.description,displayName:e.displayName,id:e.id,imageSource:void 0,mail:e.mail,mailNickname:e.mailNickname,visibility:i})}withPropertyBag(e){if(null==u.X[e.visibility])throw new Error("InvalidArgumentException: propertyBag.visibility");return this.assignedSensitivityLabelId=e.assignedSensitivityLabelId??"",this.autoSubscribeNewMembers=e.autoSubscribeNewMembers??!1,this.classification=e.classification??"",this.description=e.description??"",this.displayName=e.displayName??"",this.id=e.id,this.imageSource=e.imageSource??"",this.mail=e.mail??"",this.mailNickname=e.mailNickname,this.visibility=e.visibility,this}withLocallyUniqueId(){return this.id=c.o.generate(),this}constructor(){this.id="",this.displayName="",this.mailNickname="",this.visibility=u.X.Private}}var d=t(94283),p=t(679),m=t(21382),y=t(86053);class g{static get builder(){return new h}setProperty(e,i){if("id"===e||"imageSource"===e||"mail"===e)throw new Error("ReadOnlyException: "+e);if("visibility"===e&&this.visibility===u.X.HiddenMembership)throw new Error("ForbiddenException: Cannot change visibility of hidden groups");const t=this.getClone();return t[e]=i,t}toWebSerializable(){return{assignedSensitivityLabelId:this.assignedSensitivityLabelId,AutoSubscribeNewMembers:this.autoSubscribeNewMembers,Classification:this.classification,Description:this.description,DisplayName:this.displayName,Id:this.id,ImageSource:this.imageSource,Mail:this.mail,MailNickname:this.mailNickname,Visibility:u.X[this.visibility]}}toGraphSerializable(){const e={autoSubscribeNewMembers:this.autoSubscribeNewMembers,classification:""===this.classification?null:this.classification,description:""===this.description?null:this.description,displayName:this.displayName,groupTypes:["Unified"],id:this.id,mailEnabled:!0,mailNickname:this.mailNickname,securityEnabled:!1,visibility:u.X[this.visibility]};return!n()(this.assignedSensitivityLabelId)&&(e.assignedLabels=[{labelId:this.assignedSensitivityLabelId}]),e}getDiff(e){return p.B.getDiff(this,e,p.B.getDiffMomentCustomizer)}applyDiffs(){for(var e=arguments.length,i=new Array(e),t=0;t<e;t++)i[t]=arguments[t];if(!r()(i,e=>null!=e))throw new Error("ArgumentException: diffs - Diffs array contains null elements");return i.length>0?l()(g.builder.build(),this,...i,p.B.applyDiffMomentCustomizer):this}getClone(){const e=this.toWebSerializable();return g.builder.fromUnifiedGroupResource(e).build()}getDetailedInfo(e){const i=this.visibility===u.X.Public?y.p.Strings.UnifiedGroup_Public:y.p.Strings.UnifiedGroup_Private;let t="";if(this.assignedSensitivityLabelId&&e){const i=d.k.getFullSensitivityTitle(this.assignedSensitivityLabelId,e);i&&(t=m.G(y.p.Strings.UnifiedGroup_ClassificationOrSensitivityInfo,i))}return!t&&this.classification&&(t=m.G(y.p.Strings.UnifiedGroup_ClassificationOrSensitivityInfo,this.classification)),m.G(y.p.Strings.UnifiedGroup_DetailedInfo,i,t).trim()}constructor(e){this.assignedSensitivityLabelId=e.assignedSensitivityLabelId,this.autoSubscribeNewMembers=e.autoSubscribeNewMembers,this.classification=e.classification,this.description=e.description,this.displayName=e.displayName,this.id=e.id,this.imageSource=e.imageSource,this.mail=e.mail,this.mailNickname=e.mailNickname,this.visibility=e.visibility}}g.DescriptionMaxLength=1e3},94266:(e,i,t)=>{t.d(i,{R:()=>r});var s=t(45078);class r{appendSharepointAuthenticationChallengeHeaders(e){return e[s.Er.AuthenticationChallengeHeaderName]=s.Er.AuthenticationChallengeHeaderValue,e}getDefaultRequestTelemetryConfig(e){return{apiName:this.name,methodName:e,requestHeadersToLog:this.loggableRequestHeaders,responseHeadersToLog:this.loggableResponseHeaders}}extractSkipTokenFromNextLink(e){try{const i=new URL(e);return new URLSearchParams(i.search).get(this.skipTokenParam)}catch{return null}}constructor(e,i,t){this.name=e,this.hostDomain=i,this.ajaxClient=t,this.skipTokenKey="@odata.nextLink",this.skipTokenParam="$skiptoken",this.vBetaUrlToken="beta",this.v1UrlToken="v1.0",this.loggableRequestHeaders=[s.a8.ClientRequestId],this.loggableResponseHeaders=[s.Qu.RequestId,s.Qu.ClientRequestId,s.Qu.TCorrelationId]}}},94283:(e,i,t)=>{t.d(i,{k:()=>h});var s=t(55491),r=t.n(s),a=t(54320),n=t.n(a),o=t(91246);class l{build(){return new h(this)}fromSensitivityLabelResource(e){const i=e.sublabels?.map(e=>(new l).fromSensitivityLabelResource(e));return this.withPropertyBag({id:e.id,name:e.name,displayName:e.displayName,description:e.description,toolTip:e.toolTip,isDefault:e.isDefault,priority:e.priority,groupAllowGuestUsers:e.groupAllowGuestUsers,groupPrivacy:e.groupPrivacy,sublabels:i})}fromGraphResource(e){const i=e.sublabels?.map(e=>(new l).fromGraphResource(e));let t=this.groupAllowGuestUsers,s=this.groupPrivacy;const r=e.labelActions;if(r&&!n()(r))for(const a of r)if("protectGroup"===a.name){t=a.allowGuestUsers??!1,s=a.privacy??this.groupPrivacy;break}return this.withPropertyBag({id:e.id,name:e.name,displayName:e.displayName,description:e.description,toolTip:e.toolTip,isDefault:e.isDefault,priority:e.priority,groupAllowGuestUsers:t,groupPrivacy:s,sublabels:i})}withPropertyBag(e){return this.id=e.id||this.id,this.name=e.name||this.name,this.displayName=e.displayName||this.displayName,this.description=e.description||this.description,this.toolTip=e.toolTip||this.toolTip,this.isDefault=e.isDefault??this.isDefault,this.priority=e.priority||this.priority,this.groupAllowGuestUsers=e.groupAllowGuestUsers??this.groupAllowGuestUsers,this.groupPrivacy=e.groupPrivacy||this.groupPrivacy,this.sublabels=e.sublabels||this.sublabels,this}withValidData(){return this.withPropertyBag({id:o.o.generate()})}constructor(){this.id="",this.name="",this.displayName="",this.description="",this.toolTip="",this.isDefault=!1,this.priority=0,this.groupAllowGuestUsers=!0,this.groupPrivacy="",this.sublabels=null}}var u=t(21382),c=t(86053);class h{static get builder(){return new l}static getDefaultSensitivityLabel(e){if(n()(e))return null;let i=null;return r()(e,e=>{if(e.isDefault?i=e:null!=e.sublabels&&r()(e.sublabels,e=>{if(e.isDefault)return i=e,!1}),null!=i)return!1}),i}static getSensitivityLabel(e,i){if(n()(e)||n()(i))return null;let t=null;return r()(i,i=>{if(i.id===e?t=i:null!=i.sublabels&&r()(i.sublabels,i=>{if(i.id===e)return t=i,!1}),null!=t)return!1}),t}static getParentSensitivityLabel(e,i){if(n()(e)||n()(i))return null;let t=null;return r()(i,i=>{if(null!=i.sublabels&&r()(i.sublabels,s=>{if(s.id===e)return t=i,!1}),null!=t)return!1}),t}static getFullSensitivityTitle(e,i){if(n()(e)||n()(i))return"";const t=h.getSensitivityLabel(e,i),s=h.getParentSensitivityLabel(e,i);return t&&s?u.G(c.p.Strings.SensitivityLabel_FullTitle,s.displayName,t.displayName):t?.displayName??""}constructor(e){this.id=e.id,this.name=e.name,this.displayName=e.displayName,this.description=e.description,this.toolTip=e.toolTip,this.isDefault=e.isDefault,this.priority=e.priority,this.groupAllowGuestUsers=e.groupAllowGuestUsers,this.groupPrivacy=e.groupPrivacy,this.sublabels=null,null!=e.sublabels&&(this.sublabels=[],e.sublabels.forEach(e=>{this.sublabels.push(new h(e))}))}}},98546:(e,i,t)=>{t.r(i),t.d(i,{DirectoryService:()=>y});var s=t(45078),r=t(95783),a=t(92970),n=t(50204),o=t(94266),l=t(54320),u=t.n(l),c=t(33411),h=t.n(c),d=t(98502),p=t(81704),m=t(61739);class y extends o.R{async getGroupAsync(e){const i=`${this.hostDomain}/${this.v1UrlToken}/groups/${e.groupId}?$select=assignedLabels,autoSubscribeNewMembers,classification,description,displayName,id,mail,mailNickname,visibility`,t=await this.ajaxClient.executeRequest(i,{telemetryConfig:this.getDefaultRequestTelemetryConfig("getGroupAsync")});try{const e=await t.clone().json();if(null==e)throw new Error("No unified group data returned");return a.E.builder.fromGraphResource(e).build()}catch(s){throw d.g.generateAjaxClientError(t,s)}}async getGroupPhotoAsync(e){const i=`${this.hostDomain}/${this.v1UrlToken}/groups/${e.groupId}/photo/$value`,t=await this.ajaxClient.executeRequest(i,{telemetryConfig:this.getDefaultRequestTelemetryConfig("getGroupPhotoAsync"),retryConfig:(0,p.Vj)({maxRetryCount:0})});try{const e=await t.clone().blob();if(0===e.size)throw new Error("No photo returned");return URL.createObjectURL(e)}catch(s){throw d.g.generateAjaxClientError(t,s)}}async getMembersOfGroupAsync(e){let i=`${this.hostDomain}/${this.v1UrlToken}/groups/${e.groupId}/members?$select=proxyAddresses,id,displayName,givenName,mail,preferredLanguage,surname,userPrincipalName,jobTitle,userType`;u()(e.skipToken)||(i=`${i}&$skiptoken=${e.skipToken}`);const t=await this.ajaxClient.executeRequest(i,{telemetryConfig:this.getDefaultRequestTelemetryConfig("getMembersOfGroupAsync")});try{const e=await t.clone().json();if(null==e)throw new Error("No users data returned");const i=e.value,s=(0,m.n0)(e[this.skipTokenKey]);let r="";if(!u()(s)){r=s.split("?")[1].split("&")[1].split("=")[1]}return{data:h()(i,e=>n.K.builder.fromGraphUserResource(e).build()),skipToken:r}}catch(s){throw d.g.generateAjaxClientError(t,s)}}async checkMemberGroupsForCurrentUserAsync(e){const i=`${this.hostDomain}/${this.v1UrlToken}/me/checkMemberGroups`,t={groupIds:e.groupIds},a=await this.ajaxClient.executeRequest(i,{method:r.PJ.Post,telemetryConfig:this.getDefaultRequestTelemetryConfig("checkMemberGroupsForCurrentUserAsync"),body:JSON.stringify(t),headers:{[s.Lr.ContentType]:s.Mq.Json}});try{const e=await a.clone().json();return null==e?Promise.reject(d.g.generateAjaxClientError(a,"No group ids returned")):e.value??[]}catch(n){throw d.g.generateAjaxClientError(a,n)}}async getUserAsync(e){const i=`${this.hostDomain}/${this.v1UrlToken}/users/${e.userId}?$select=id,displayName,givenName,jobTitle,mail,preferredLanguage,surname,userPrincipalName,proxyAddresses,userType`,t=await this.ajaxClient.executeRequest(i,{telemetryConfig:this.getDefaultRequestTelemetryConfig("getUserAsync")});try{const e=await t.clone().json();if(null==e)throw new Error("No data returned");return n.K.builder.fromGraphUserResource(e).build()}catch(s){throw d.g.generateAjaxClientError(t,s)}}async getUserPhotoAsync(e){const i=`${this.hostDomain}/${this.v1UrlToken}/users/${e.userId}/photo/$value`,t=await this.ajaxClient.executeRequest(i,{telemetryConfig:this.getDefaultRequestTelemetryConfig("getUserPhotoAsync"),retryConfig:(0,p.Vj)({maxRetryCount:0})});try{const e=await t.clone().blob();if(0===e.size)throw new Error("No photo returned");return URL.createObjectURL(e)}catch(s){throw d.g.generateAjaxClientError(t,s)}}async getUserLicensesAsync(e){const i=`${this.hostDomain}/${this.v1UrlToken}/users/${e.userId}/licenseDetails`,t=await this.ajaxClient.executeRequest(i,{telemetryConfig:this.getDefaultRequestTelemetryConfig("getLicensesForUserAsync")});try{const e=await t.clone().json();if(null==e)throw new Error("No data returned");return e.value}catch(s){throw d.g.generateAjaxClientError(t,s)}}async getJoinedGroupsAsync(e){const i=e?.skipToken;let t=`${this.hostDomain}/${this.v1UrlToken}/me/memberOf`;null!=i&&""!==i&&(t+=`${this.skipTokenParam}=${i}`);const s=await this.ajaxClient.executeRequest(t,{telemetryConfig:this.getDefaultRequestTelemetryConfig("getJoinedGroupsAsync")});try{const e=await s.clone().json();if(null==e)throw d.g.generateAjaxClientError(s,"No joined group data returned");const i=e.value.map(e=>a.E.builder.fromGraphResource(e).build());return{data:i,skipToken:e[this.skipTokenKey]?this.extractSkipTokenFromNextLink(e[this.skipTokenKey]):null}}catch(r){throw d.g.generateAjaxClientError(s,r)}}async addMemberToGroupAsync(e){const i=`${this.hostDomain}/${this.v1UrlToken}/groups/${e.groupId}/members/$ref`,t={"@odata.id":`${this.hostDomain}users/${e.userId}`};await this.ajaxClient.executeRequest(i,{method:r.PJ.Post,body:JSON.stringify(t),headers:{[s.Lr.ContentType]:s.Mq.Json},telemetryConfig:this.getDefaultRequestTelemetryConfig("addMemberToGroupAsync"),retryConfig:(0,p.Vj)({maxRetryCount:0})})}async removeMemberFromGroupAsync(e){const i=`${this.hostDomain}/${this.v1UrlToken}/groups/${e.groupId}/members/${e.userId}/$ref`;await this.ajaxClient.executeRequest(i,{method:r.PJ.Delete,telemetryConfig:this.getDefaultRequestTelemetryConfig("removeMemberFromGroupAsync")})}async deleteGroupAsync(e){const i=`${this.hostDomain}/${this.v1UrlToken}/groups/${e.groupId}`;await this.ajaxClient.executeRequest(i,{method:r.PJ.Delete,telemetryConfig:this.getDefaultRequestTelemetryConfig("deleteGroupAsync")})}constructor(e,i){super("DirectoryService",e,i)}}}}]);
//# sourceMappingURL=directoryservice.93b81df4.chunk.js.map