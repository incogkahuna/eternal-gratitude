"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[1303],{14983:(e,t,r)=>{var i;r.d(t,{Er:()=>i,LP:()=>o,ig:()=>a}),function(e){e.Word="Word",e.Excel="Excel",e.PowerPoint="PowerPoint",e.OneNote="OneNote",e.Project="Project",e.Visio="Visio",e.Pdf="Pdf",e.Loop="Loop",e.Other="Other"}(i||(i={}));i.OneNote,i.Project,i.Visio;var o,a=["jpg","jpeg","png","gif","bmp"];!function(e){e.Stream="stream-video",e.Youtube="yt-video",e.Vimeo="vimeo-video",e.DailyMotion="dm-video",e.Facebook="fb-video"}(o||(o={}))},23918:(e,t,r)=>{r.d(t,{Y:()=>f});var i=r(91675),o=r(51171),a=r(57718),n=r(86178),s=r.n(n),u=r(14983),d=function(){function e(){this.id=a.cM(),this.name="",this.fileType=u.Er.Other,this.url="",this.modifiedDate=s()(),this.childCount=-1,this.itemPath="/drive/root:"}return e.prototype.build=function(){return new f(this)},e.prototype.withPropertyBag=function(e){return this.id=e.id||this.id,this.name=e.name||this.name,this.fileType=e.fileType||this.fileType,this.url=e.url||this.url,this.modifiedDate=e.modifiedDate||this.modifiedDate,this.childCount=void 0!==e.childCount?e.childCount:this.childCount,this.itemPath=e.itemPath||this.itemPath,this},e.prototype.withDefaultValues=function(){return this.withPropertyBag({id:"driveItemId",name:"Item1",fileType:u.Er.Other,url:"driveItemUrl",modifiedDate:s()(),itemPath:"/drive/root:",childCount:-1})},e.prototype.fromGraphDriveItemResource=function(e){return this.withPropertyBag({id:e.id,name:e.name,fileType:e.folder?u.Er.Other:e.package?f.GetType(e.package.type):f.GetFileType(e.name),url:e.webUrl,modifiedDate:s()(e.lastModifiedDateTime),childCount:e.folder?e.folder.childCount:-1,itemPath:e.parentReference.path})},e}(),l=r(98990),c=r.n(l),m=r(55491),h=r.n(m),p=r(54320),g=r.n(p),f=function(){function e(e){if(g()(e.id))throw new o.L("id");if(g()(e.name))throw new o.L("name");if(g()(e.url))throw new o.L("url");this.id=e.id,this.name=e.name,this.url=e.url,this.fileType=e.fileType,this.description=e.description,this.modifiedDate=e.modifiedDate,this.childCount=e.childCount,this.itemPath=e.itemPath}return Object.defineProperty(e,"builder",{get:function(){return new d},enumerable:!1,configurable:!0}),e.GetType=function(e){switch(e.toLowerCase()){case"excel":return u.Er.Excel;case"onenote":return u.Er.OneNote;case"pdf":return u.Er.Pdf;case"powerpoint":return u.Er.PowerPoint;case"project":return u.Er.Project;case"visio":return u.Er.Visio;case"word":return u.Er.Word;case"loop":return u.Er.Loop;default:return u.Er.Other}},e.GetFileType=function(t){var r=u.Er.Other,o=t.slice(t.lastIndexOf(".")+1);return h()(i.t,function(t,i){c()(t,function(e){return e.toLowerCase()===o.toLowerCase()})&&(r=e.GetType(i))}),r},e}()},54276:(e,t,r)=>{var i;r.d(t,{c:()=>i}),function(e){e.Text="text",e.HTML="html"}(i||(i={}))},77014:(e,t,r)=>{r.r(t),r.d(t,{GraphApi:()=>w});var i=r(45078),o=r(95783),a=r(11755),n=r(23918),s=r(11910),u=r(92970),d=r(50204),l=r(65818),c=r(54320),m=r.n(c),h=r(33411),p=r.n(h),g=r(98502),f=r(81704),y=r(61739);class w extends a.K{async getUnifiedGroupAsync(e){const t=`${this._baseUrl}groups/${e.groupId}?$select=assignedLabels,autoSubscribeNewMembers,classification,description,displayName,id,mail,mailNickname,visibility`,r=await this.ajaxClient.executeRequest(t,{mode:"cors",telemetryConfig:{apiName:w.apiName,methodName:"getUnifiedGroupAsync"}});try{const t=await r.clone().json();if(null==t)throw new Error("No unified group data returned");return t.id=e.groupId,u.E.builder.fromGraphResource(t).build()}catch(i){throw g.g.generateAjaxClientError(r,i)}}async getMembersOfContainerAsync(e){switch(e.container.containerType){case l.K.Group:return await this.getMembersOfGroupAsync(e);case l.K.Roster:return await this.getMembersOfPlannerRosterAsync(e);default:return Promise.reject(g.g.generateAjaxClientError(new Response(i.MR.NotImplemented,{status:o.t3.NotImplemented,statusText:i.MR.NotImplemented})))}}async getUserAsync(e){const t=g.g.validateAjaxClientRequestParameters(e,["userId"]);if(null!==t)return Promise.reject(t);const r=`${this._baseUrl}users/${e.userId}?$select=id,displayName,givenName,jobTitle,mail,preferredLanguage,surname,userPrincipalName,proxyAddresses,userType`,i=await this.ajaxClient.executeRequest(r,{mode:"cors",telemetryConfig:{apiName:w.apiName,methodName:"getUserAsync"}});try{const e=await i.clone().json();if(null==e)throw new Error("No data returned");return d.K.builder.fromGraphUserResource(e).build()}catch(o){throw g.g.generateAjaxClientError(i,o)}}async resolveUsersAsync(e){const t=g.g.validateAjaxClientRequestParameters(e,["userIds"]);if(null!==t)return Promise.reject(t);const r=[];for(const i of e.userIds)r.push(this.getUserAsync({userId:i}));return await Promise.all(r)}async getConversationThreadAsync(e){const t=g.g.validateAjaxClientRequestParameters(e,["groupId","threadId"]);if(null!==t)return Promise.reject(t);const r=`${this._baseUrl}groups/${e.groupId}/threads/${e.threadId}/posts`,i=await this.ajaxClient.executeRequest(r,{mode:"cors",telemetryConfig:{apiName:w.apiName,methodName:"getConversationThreadAsync"}});try{const t=await i.clone().json();if(null==t)throw new Error("No conversation thread data returned");const r=t.value;return p()(r,t=>s.L.builder.fromGraphPostResource(t,e.threadId).build())}catch(o){throw g.g.generateAjaxClientError(i,o)}}async getUserPhoto(e){const t=`${this._baseUrl}users/${e.user.id}/photo/$value`,r=await this.ajaxClient.executeRequest(t,{mode:"cors",telemetryConfig:{apiName:w.apiName,methodName:"getUserPhoto"},retryConfig:(0,f.Vj)({maxRetryCount:0})});try{const e=await r.clone().blob();if(0===e.size)throw new Error("No photo returned");return URL.createObjectURL(e)}catch(i){throw g.g.generateAjaxClientError(r,i)}}async getConversationThreadPostAsync(e){const t=g.g.validateAjaxClientRequestParameters(e,["groupId","threadId","postId"]);if(null!==t)return Promise.reject(t);const r=`${this._baseUrl}groups/${e.groupId}/threads/${e.threadId}/posts/${e.postId}`,i=await this.ajaxClient.executeRequest(r,{telemetryConfig:{apiName:w.apiName,methodName:"getConversationThreadPostAsync"}});try{const t=await i.clone().json();if(null==t)throw new Error("No conversation thread post data returned");const r=t.value;return s.L.builder.fromGraphPostResource(r,e.threadId).build()}catch(o){throw g.g.generateAjaxClientError(i,o)}}async getGroupPhoto(e){const t=`${this._baseUrl}groups/${e.groupId}/photo/$value`,r=await this.ajaxClient.executeRequest(t,{mode:"cors",telemetryConfig:{apiName:w.apiName,methodName:"getGroupPhoto"},retryConfig:(0,f.Vj)({maxRetryCount:0})});try{const e=await r.clone().blob();if(0===e.size)throw new Error("No photo returned");return URL.createObjectURL(e)}catch(i){throw g.g.generateAjaxClientError(r,i)}}async getDriveItem(e){const t=g.g.validateAjaxClientRequestParameters(e,["driveId","itemId"]);if(null!==t)return Promise.reject(t);const r=`${this._baseUrl}drives/${e.driveId}/items/${e.itemId}`,i=await this.ajaxClient.executeRequest(r,{mode:"cors",telemetryConfig:{apiName:w.apiName,methodName:"getDriveItem"},headers:new Headers(this.appendSharepointAuthenticationChallengeHeaders({}))});try{const e=await i.clone().json();if(null==e)throw new Error("No drive item returned");return n.Y.builder.fromGraphDriveItemResource(e).build()}catch(o){throw g.g.generateAjaxClientError(i,o)}}async getGroupDocumentsInFolderPaged(e,t){const r=g.g.validateAjaxClientRequestParameters(e,["groupId"]);if(null!==r)return Promise.reject(r);const i=e.folderId?`/items/${e.folderId}/children`:"/root/children",o=e.skipToken||`${this._baseUrl}groups/${e.groupId}/drive${i}`,a=await this.ajaxClient.executeRequest(o,{mode:"cors",telemetryConfig:{apiName:w.apiName,methodName:"getGroupDocumentsInFolderPaged"},headers:new Headers(this.appendSharepointAuthenticationChallengeHeaders({}))});try{const e=await a.clone().json();if(null==e)throw new Error("No group documents returned");const t=e.value;return{data:p()(t,e=>n.Y.builder.fromGraphDriveItemResource(e).build()),skipToken:(0,y.n0)(e[this.skipTokenKey])}}catch(s){throw g.g.generateAjaxClientError(a,s)}}async getDriveItemThumbnail(e){const t=`${this._baseUrl}groups/${e.groupId}/drive/root:/${e.itemPath}:/thumbnails/0/large/url`,r=await this.ajaxClient.executeRequest(t,{mode:"cors",telemetryConfig:{apiName:w.apiName,methodName:"getDriveItemThumbnail"},retryConfig:(0,f.Vj)({maxRetryCount:0})});try{const e=await r.clone().json(),t=e?e.value:null;if(!t)throw new Error("No item thumbnail url returned");return t}catch(i){throw g.g.generateAjaxClientError(r,i)}}async shareDriveItemAsync(e){const t=g.g.validateAjaxClientRequestParameters(e,["driveId","itemId","userIds"]);if(null!==t)return Promise.reject(t);const r=`${this._baseUrl}drives/${e.driveId}/items/${e.itemId}/invite`,a=[];for(const i of e.userIds){const e={objectId:i};a.push(e)}const n={recipients:a,requireSignIn:!0,sendInvitation:!1,roles:["write"]};await this.ajaxClient.executeRequest(r,{method:o.PJ.Post,mode:"cors",telemetryConfig:{apiName:w.apiName,methodName:"shareDriveItemAsync"},body:JSON.stringify(n),headers:{[i.Lr.ContentType]:i.Mq.Json}})}async checkCurrentUserToGroupsMembershipsAsync(e){const t=g.g.validateAjaxClientRequestParameters(e,["groupIds"]);if(null!==t)return Promise.reject(t);const r=`${this._baseUrl}me/checkMemberGroups`,a={groupIds:e.groupIds},n=await this.ajaxClient.executeRequest(r,{method:o.PJ.Post,mode:"cors",telemetryConfig:{apiName:w.apiName,methodName:"checkCurrentUserToGroupsMembershipsAsync"},body:JSON.stringify(a),headers:{[i.Lr.ContentType]:i.Mq.Json}});try{const e=await n.clone().json();if(null==e)return Promise.reject(g.g.generateAjaxClientError(n,"No group ids returned"));let t=[];return e.value&&(t=e.value),t}catch(s){throw g.g.generateAjaxClientError(n,s)}}async getMembersOfGroupAsync(e){let t=`${this._baseUrl}groups/${e.container.externalId}/members?$select=proxyAddresses,id,displayName,givenName,mail,preferredLanguage,surname,userPrincipalName,jobTitle,userType`;m()(e.skipToken)||(t=`${t}&$skiptoken=${e.skipToken}`);const r=await this.ajaxClient.executeRequest(t,{mode:"cors",telemetryConfig:{apiName:w.apiName,methodName:"getMembersOfGroupContainerAsync"}});try{const e=await r.clone().json();if(null==e)throw new Error("No users data returned");const t=e.value,i=(0,y.Cx)(e[this.skipTokenKey]);return{data:p()(t,e=>d.K.builder.fromGraphUserResource(e).build()),skipToken:i}}catch(i){throw g.g.generateAjaxClientError(r,i)}}async getMembersOfPlannerRosterAsync(e){let t=`${this.betaBaseUrl}planner/rosters/${e.container.externalId}/members?$select=userId`;m()(e.skipToken)||(t=`${t}&$skiptoken=${e.skipToken}`);const r=await this.ajaxClient.executeRequest(t,{mode:"cors",telemetryConfig:{apiName:w.apiName,methodName:"getMembersOfRosterContainerAsync"}});try{const e=await r.clone().json();if(null==e)throw new Error("No users data returned");const t=e.value,i=(0,y.Cx)(e[this.skipTokenKey]),o=await Promise.all(p()(t,e=>this.getUserAsync({userId:e.userId})));return{data:o,skipToken:i}}catch(i){throw g.g.generateAjaxClientError(r,i)}}appendSharepointAuthenticationChallengeHeaders(e){return e[i.Er.AuthenticationChallengeHeaderName]=i.Er.AuthenticationChallengeHeaderValue,e}}w.apiName="GraphApi"},81704:(e,t,r)=>{r.d(t,{Vj:()=>u});var i=r(34677),o=r.n(i),a=r(38752),n=r(31028),s=r(98502);function u(e){return o()({maxRetryCount:a.B.clientSettings.RetrySettings.MaxRetryCount,maxRetryTimeoutInMiliseconds:a.B.clientSettings.RetrySettings.MaxRetryTimeout,delayOnRetryInMiliseconds:a.B.clientSettings.RetrySettings.RetryDelay,retryCheck:d},e)}async function d(e,t,r){return(0,n.g)(e)&&s.g.isRetryableResponse(t,r)}},91675:(e,t,r)=>{r.d(t,{t:()=>i});var i={Word:["docx","docm","doc","dotx","dotm"],Excel:["xlsx","xlsm","xlsb","xltx","xltm","xls","xlam","xla","xlw","xml"],PowerPoint:["pptx","pptm","ppt","potx","potm","pot","thmx","pps","ppsx","ppsm","ppsam","ppa"],OneNote:["one"],Project:["mpp","mpt","mpd"],Visio:["vsdx","vsd","vsdm","vssx","vssm","vstx","vstm"],Pdf:["pdf"],Loop:["loop","fluid"]}}}]);
//# sourceMappingURL=graphapi.d4977def.chunk.js.map