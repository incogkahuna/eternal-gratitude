"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[6363],{54555:(e,t,o)=>{o.d(t,{G:()=>N});var r=o(65804),n=o(56851),i=o(65043),a=o(89379),s=o(17066),l=o(27480),p=o(40440),d=o(56420),c=o(15199),u=o(13706),m=o(20751),h="SearchBox",g={root:{height:"auto"},icon:{fontSize:"12px"}},C={iconName:"Clear"},x={ariaLabel:"Clear text"},f=(0,a.Z)(),S=i.forwardRef(function(e,t){var o=e.ariaLabel,r=e.className,a=e.defaultValue,S=void 0===a?"":a,b=e.disabled,F=e.underlined,k=e.styles,N=e.labelText,B=e.placeholder,v=void 0===B?N:B,G=e.theme,E=e.clearButtonProps,y=void 0===E?x:E,D=e.disableAnimation,P=void 0!==D&&D,w=e.showIcon,I=void 0!==w&&w,L=e.onClear,T=e.onBlur,A=e.onEscape,R=e.onSearch,q=e.onKeyDown,z=e.iconProps,_=e.role,O=e.onChange,H=e.onChanged,W=i.useState(!1),Z=W[0],J=W[1],$=i.useRef(),V=(0,p.k)(e.value,S,function(e,t){e&&e.timeStamp===$.current||($.current=null===e||void 0===e?void 0:e.timeStamp,null===O||void 0===O||O(e,t),null===H||void 0===H||H(t))}),j=V[0],K=V[1],M=String(j),U=i.useRef(null),Y=i.useRef(null),Q=(0,d.a)(U,t),X=(0,c.B)(h,e.id),ee=y.onClick,te=f(k,{theme:G,className:r,underlined:F,hasFocus:Z,disabled:b,hasInput:M.length>0,disableAnimation:P,showIcon:I}),oe=(0,s.G1)(e,s.QQ,["className","placeholder","onFocus","onBlur","value","role"]),re=i.useCallback(function(e){var t;null===L||void 0===L||L(e),e.defaultPrevented||(K(""),null===(t=Y.current)||void 0===t||t.focus(),e.stopPropagation(),e.preventDefault())},[L,K]),ne=i.useCallback(function(e){null===ee||void 0===ee||ee(e),e.defaultPrevented||re(e)},[ee,re]),ie=i.useCallback(function(e){J(!1),null===T||void 0===T||T(e)},[T]),ae=function(e){K(e.target.value,e)};return function(e,t,o){i.useImperativeHandle(e,function(){return{focus:function(){var e;return null===(e=t.current)||void 0===e?void 0:e.focus()},blur:function(){var e;return null===(e=t.current)||void 0===e?void 0:e.blur()},hasFocus:function(){return o}}},[t,o])}(e.componentRef,Y,Z),i.createElement("div",{role:_,ref:Q,className:te.root,onFocusCapture:function(t){var o;J(!0),null===(o=e.onFocus)||void 0===o||o.call(e,t)}},i.createElement("div",{className:te.iconContainer,onClick:function(){Y.current&&(Y.current.focus(),Y.current.selectionStart=Y.current.selectionEnd=0)},"aria-hidden":!0},i.createElement(m.I,(0,n.__assign)({iconName:"Search"},z,{className:te.icon}))),i.createElement("input",(0,n.__assign)({},oe,{id:X,className:te.field,placeholder:v,onChange:ae,onInput:ae,onBlur:ie,onKeyDown:function(e){switch(e.which){case l.c.escape:null===A||void 0===A||A(e),M&&!e.defaultPrevented&&re(e);break;case l.c.enter:R&&(R(M),e.preventDefault(),e.stopPropagation());break;default:null===q||void 0===q||q(e),e.defaultPrevented&&e.stopPropagation()}},value:M,disabled:b,role:"searchbox","aria-label":o,ref:Y})),M.length>0&&i.createElement("div",{className:te.clearButton},i.createElement(u.K,(0,n.__assign)({onBlur:ie,styles:g,iconProps:C},y,{onClick:ne}))))});S.displayName=h;var b=o(52195),F=o(50605),k={root:"ms-SearchBox",iconContainer:"ms-SearchBox-iconContainer",icon:"ms-SearchBox-icon",clearButton:"ms-SearchBox-clearButton",field:"ms-SearchBox-field"};var N=(0,r.I)(S,function(e){var t,o,r,n,i,a=e.theme,s=e.underlined,l=e.disabled,p=e.hasFocus,d=e.className,c=e.hasInput,u=e.disableAnimation,m=e.showIcon,h=a.palette,g=a.fonts,C=a.semanticColors,x=a.effects,f=(0,b.Km)(k,a),S={color:C.inputPlaceholderText,opacity:1},N=h.neutralSecondary,B=h.neutralPrimary,v=h.neutralLighter,G=h.neutralLighter,E=h.neutralLighter;return{root:[f.root,g.medium,b.S8,{color:C.inputText,backgroundColor:C.inputBackground,display:"flex",flexDirection:"row",flexWrap:"nowrap",alignItems:"stretch",padding:"1px 0 1px 4px",borderRadius:x.roundedCorner2,border:"1px solid ".concat(C.inputBorder),height:32,selectors:(t={},t[b.up]={borderColor:"WindowText"},t[":hover"]={borderColor:C.inputBorderHovered,selectors:(o={},o[b.up]={borderColor:"Highlight"},o)},t[":hover .".concat(f.iconContainer)]={color:C.inputIconHovered},t)},!p&&c&&{selectors:(r={},r[":hover .".concat(f.iconContainer)]={width:4},r[":hover .".concat(f.icon)]={opacity:0,pointerEvents:"none"},r)},p&&["is-active",{position:"relative"},(0,b.Sq)(C.inputFocusBorderAlt,s?0:x.roundedCorner2,s?"borderBottom":"border")],m&&[{selectors:(n={},n[":hover .".concat(f.iconContainer)]={width:32},n[":hover .".concat(f.icon)]={opacity:1},n)}],l&&["is-disabled",{borderColor:v,backgroundColor:E,pointerEvents:"none",cursor:"default",selectors:(i={},i[b.up]={borderColor:"GrayText"},i)}],s&&["is-underlined",{borderWidth:"0 0 1px 0",borderRadius:0,padding:"1px 0 1px 8px"}],s&&l&&{backgroundColor:"transparent"},c&&"can-clear",d],iconContainer:[f.iconContainer,{display:"flex",flexDirection:"column",justifyContent:"center",flexShrink:0,fontSize:16,width:32,textAlign:"center",color:C.inputIcon,cursor:"text"},p&&{width:4},l&&{color:C.inputIconDisabled},!u&&{transition:"width ".concat(b.cs.durationValue1)},m&&p&&{width:32}],icon:[f.icon,{opacity:1},p&&{opacity:0,pointerEvents:"none"},!u&&{transition:"opacity ".concat(b.cs.durationValue1," 0s")},m&&p&&{opacity:1}],clearButton:[f.clearButton,{display:"flex",flexDirection:"row",alignItems:"stretch",cursor:"pointer",flexBasis:"32px",flexShrink:0,padding:0,margin:"-1px 0px",selectors:{"&:hover .ms-Button":{backgroundColor:G},"&:hover .ms-Button-icon":{color:B},".ms-Button":{borderRadius:(0,F.jI)(a)?"1px 0 0 1px":"0 1px 1px 0"},".ms-Button-icon":{color:N}}}],field:[f.field,b.S8,(0,b.CX)(S),{backgroundColor:"transparent",border:"none",outline:"none",fontWeight:"inherit",fontFamily:"inherit",fontSize:"inherit",color:C.inputText,flex:"1 1 0px",minWidth:"0px",overflow:"hidden",textOverflow:"ellipsis",paddingBottom:.5,selectors:{"::-ms-clear":{display:"none"}}},l&&{color:C.disabledText}]}},void 0,{scope:"SearchBox"})},67354:(e,t,o)=>{o.r(t),o.d(t,{AddFormRequirementDialog:()=>Ce,DialogState:()=>ge,FormOption:()=>he});var r=o(65043),n=o(96891),i=o(77508),a=o(16112),s=o(63485),l=o(66783),p=o(54845),d=o(31537),c=o(54555),u=o(58189),m=o(65337),h=o(94850),g=o(4648),C=o(20751),x=o(77711),f=o(36060),S=o(52195),b=o(72943),F=o(66151),k=o(56415),N=o(8736);const B=(0,l.J9)((e,t)=>{const o={groupListRoot:[{height:N.B.GroupListHeight,overflowY:"scroll"},e&&{maxHeight:N.B.CopyPlanPickerHeight,height:"auto"}],groupRow:[(0,F.gS)(),(0,b.kE)(),{justifyContent:"center",overflow:"hidden",position:"relative",alignItems:"center",cursor:"pointer",padding:`${N.B.GroupListPaddingBetweenElements} 0px`,"> *":{margin:`0px ${N.B.GroupListPaddingBetweenElements}`},"> .newGroupIcon":{fontSize:N.B.GroupInfoNewGroupIconFontSize,color:k.z.ThemePrimary},"> .virtualContainer-wrapper":{margin:0},"&:hover, &.selected":{backgroundColor:k.z.NeutralLight}},e&&{maxWidth:"100%",margin:"0px 0px",padding:`${N.B.SearchBarPadding} ${N.B.SearchBarPadding}`}],icon:[(0,F.gS)(),F.cc,(0,F.$Z)(N.B.GroupListIconPrimarySize),{color:k.z.White,fontSize:S.s.large,fontWeight:S.BO.regular,height:N.B.GroupListIconPrimarySize,width:N.B.GroupListIconPrimarySize}],groupContext:(0,F.GD)(),groupName:[(0,F.GD)(),(0,F.q0)("ellipsis"),{fontSize:S.s.medium,fontWeight:S.BO.semibold},e&&{lineHeight:N.B.GroupInfoLineHeight}],groupInfo:[(0,F.q0)("ellipsis"),{fontSize:S.s.small,color:k.z.NeutralSecondary}]};return(0,S.TW)(o,t)}),v=(0,l.J9)(e=>({groupListRoot:(0,S.Zq)("groupList",e.groupListRoot),groupRow:(0,S.Zq)("groupRow",e.groupRow),groupContext:(0,S.Zq)("groupContext",e.groupContext),icon:(0,S.Zq)("icon",e.icon),groupName:(0,S.Zq)("groupName",e.groupName),groupInfo:(0,S.Zq)("groupInfo",e.groupInfo)}));var G=o(54320),E=o.n(G),y=o(33411),D=o.n(y),P=o(44535),w=o(27678),I=o(86053),L=o(91246),T=o(59846);class A extends a.${name(){return"GroupList"}renderComponent(){const e=this.getClassNames();return r.createElement(m.R,{className:e.groupListRoot,direction:h.E.vertical},r.createElement("ul",{role:"listbox","aria-label":I.p.Strings.GroupList_GroupListAriaLabel},D()(this.props.groups,e=>{if(!E()(e.displayName))return this.renderGroupRow(e)})))}renderGroupRow(e){const{currentGroup:t,renderGroupContextInfo:o,sensitivityLabels:n,onClickGroupRow:i}=this.props,{groupRow:a,groupContext:s,groupName:l,groupInfo:p}=this.getClassNames(),d=this.renderGroupContainer(e),c=!!t&&e.id===t.id;return r.createElement("li",{className:(0,g.A)(a,c?"selected":""),key:e.id,"aria-label":e.displayName,"aria-selected":e===t,"tab-index":0,"data-is-focusable":!0,onClick:i.bind(this,e),role:"option"},d,r.createElement("div",{className:s},r.createElement("div",{className:l},e.displayName),o?r.createElement("div",{className:p},e.getDetailedInfo(n)):null))}renderGroupPhoto(e){const{icon:t}=this.getClassNames(),o=this.props.getGroupPhoto(e.id);if(o)return r.createElement("img",{src:o,className:t,alt:""});{const o=P.$.parseInitialsFromName(e.displayName),n=(0,f.K)((0,w.wV)(e.displayName));return r.createElement("span",{className:(0,g.A)(t,n)},o)}}renderGroupContainer(e){const{icon:t}=this.getClassNames();return L.o.isPlexTempId(e.id)?r.createElement("span",{className:(0,g.A)(t,"newGroupIcon")},r.createElement(C.I,T.D5)):r.createElement(x.$,{planContainerId:e.id,onRender:()=>this.props.onRenderGroup(e.id)},this.renderGroupPhoto(e))}getClassNames(){return v(B(this.props.isCopyPlanContext,this.props.styles))}constructor(e,t){super(e,t)}}var R=o(28680),q=o(75472);const z=(0,q.jz)(N.B.GroupPickerTotalHorizontalPadding)-(0,q.jz)(N.B.fabricHorizontalPadding)+"px",_=(0,l.J9)((e,t)=>{const{isCopyPlanContext:o}=e,r={groupPickerRoot:{fontSize:S.s.small,padding:o?"0px":`0px ${z} ${z}`},groupFilter:{padding:o?N.B.SearchBarPadding:`${N.B.SearchBarPadding} 0`},subComponentStyles:{searchBar:W(),groupList:B(o)}};return(0,R.p)(e,r,t)}),O={root:{"> h1":{fontSize:S.s.large,fontWeight:S.BO.bold}}},H={root:{fontSize:S.s.small,"> a":{textDecoration:"none",":hover":{textDecoration:"underline"}}}},W=(0,l.J9)(()=>({root:{fontWeight:S.BO.semibold,borderColor:"transparent",backgroundColor:k.z.NeutralLight}})),Z=(0,l.J9)(e=>({rootHovered:{backgroundColor:k.z.NeutralLight},root:[(0,F.aS)(e),{fontSize:S.s.medium,fontColor:k.z.NeutralPrimary,height:N.B.ButtonHeight,backgroundColor:k.z.NeutralLighter}]})),J=(0,l.J9)(e=>({groupPickerRoot:(0,S.Zq)("groupPickerDialog",e.groupPickerRoot),groupFilter:(0,S.Zq)("groupFilter",e.groupFilter)}));var $=o(21382);class V extends a.${componentDidUpdate(e){const t=this.getTextToAnnounce();if(this.state.textToAnnounce!==t||e.groups.length!==this.props.groups.length){const e=this.props.groups.filter(e=>{if(e.displayName.toLowerCase().match(this.currentSearchText.toLowerCase()))return e});""!==t&&this.props.alertUser("SharedComponents_GroupSearchResultCountAriaLabel",[e.length.toString(),this.currentSearchText]),this.setState({textToAnnounce:t,filteredGroups:e})}}name(){return n.M.GroupPicker}renderComponent(){const{groupPickerRoot:e,groupFilter:t}=this.getClassNames(),o=this.getStyles();return r.createElement("div",{className:e},r.createElement(u.Y,{isClickableOutsideFocusTrap:!0},this.props.hideHeaderFooter?null:this.renderGroupPickerDialogHeader(),r.createElement("div",{className:t},r.createElement(c.G,{styles:o.subComponentStyles.searchBar,ariaLabel:I.p.Strings.GroupPicker_SearchBoxAriaLabel,onChange:this.onChangeSearch.bind(this),placeholder:I.p.Strings.GroupPicker_SearchBoxPlaceholder,underlined:this.props.underlinedSearchBar})),this.renderGroupList(),this.props.hideHeaderFooter?null:r.createElement(p.E,null,r.createElement(s.j,{styles:Z(this.props.theme),className:"backButton",onClick:this.onClickBack.bind(this)},I.p.Strings.GroupPicker_BackButton))))}renderGroupPickerDialogHeader(){const e=r.createElement("a",{href:i.$j.m365Groups,target:"_blank",rel:"noopener noreferrer",onClick:this.onClickLink.bind(this)},I.p.Strings.GroupPicker_LearnMoreLinkText);return r.createElement("div",{className:"groupPickerDialogHeader"},r.createElement(d.J,{className:"groupPickerTitle",styles:O},r.createElement("h1",null,I.p.Strings.GroupPicker_DialogTitle)),r.createElement(d.J,{styles:H,className:"groupPickerSubtitle"},I.p.Strings.GroupPicker_DialogSubtitle," ",r.createElement("br",null)," ",e))}renderGroupList(){const{currentGroup:e,sensitivityLabels:t,renderGroupContextInfo:o,isCopyPlanContext:n,getGroupPhoto:i,onRenderGroup:a}=this.props,s=this.getStyles();return r.createElement(A,{styles:s.subComponentStyles.groupList,currentGroup:e,groups:this.state.filteredGroups,sensitivityLabels:t,onClickGroupRow:e=>this.onClickGroupRow(e),getGroupPhoto:e=>i(e),renderGroupContextInfo:o,isCopyPlanContext:n,onRenderGroup:a})}onClickGroupRow(e){this.props.setGroup(e),this.props.onDismiss&&this.props.onDismiss()}onClickBack(){this.props.setGroup(null),this.props.onDismiss&&this.props.onDismiss()}onClickLink(){this.context.usageLogger.logData(n.M.GroupPicker,n.M.GroupLinkClicked)}getTextToAnnounce(){return""===this.currentSearchText?"":$.G(I.p.Strings.SharedComponents_GroupSearchResultCountAriaLabel,this.state.filteredGroups.length,this.currentSearchText)}getStyles(){const{isCopyPlanContext:e,styles:t}=this.props,o=this.getStyleProps(e);return _(o,t)}getClassNames(){return J(this.getStyles())}constructor(e,t){super(e,t),this.currentSearchText="",this.onChangeSearch=(e,t)=>{this.currentSearchText=t||"";const o=this.props.groups.filter(e=>{if(e.displayName.toLowerCase().match(this.currentSearchText.toLowerCase()))return e});this.setState({filteredGroups:o})},this.getStyleProps=(0,l.J9)(e=>({isCopyPlanContext:e})),this.state={filteredGroups:this.props.groups,textToAnnounce:""}}}var j=o(40520),K=o(52342),M=o(40488),U=o(57433),Y=o(11638),Q=o(6017),X=o(42283),ee=o(46646),te=o(11034),oe=o(8480),re=o(39410),ne=o(39946),ie=o(86634),ae=o(48709);const se=(0,l.J9)((e,t,o)=>{const r=[(0,b.kE)({borderWidth:"1px"}),{fontSize:S.s.medium,border:"0px",borderBottom:"2px solid",width:"100%",height:"31px",":focus-visible":{outline:0,borderColor:(0,F.Nh)(e)},":disabled,:disabled:hover":{cursor:"default",opacity:"0.5",backgroundColor:k.z.NeutralLighter,borderColor:ae.kd.gray110},paddingLeft:"12px"},(0,F.aS)(e),(0,F.nK)(e)],n={":hover":{".defaultContent":(0,F.aS)(e)}},a=[(0,b.kE)({borderWidth:"1px"}),{borderColor:(0,F.Nh)(e),borderBottom:"2px solid"}],s=[r,{marginBottom:"15px",".groupSelectionDropdownIcon":{float:"right",lineHeight:"14px"},".defaultContent":[{float:"left"}],".groupContent":{float:"left"}},t?a:n],l={":hover":{backgroundColor:"transparent"},":disabled":[(0,F.A9)(e)],"&.ms-Button--primary":[(0,F.jU)(e)],"&.ms-Button--default":[(0,F.i9)(e)]},p=[(0,F.aS)(e),(0,F.dg)(e),{boxShadow:"rgba(0, 0, 0, 0.4) 0px 0px 5px 0px",borderRadius:"3px","> div":{flexGrow:"1"},"@media (min-width: 480px)":{maxWidth:"600px",minWidth:"510px"}},e===i.Sx.TeamsContrast&&{border:"1px solid "+k.z.White}],d=[(0,F.aS)(e)],c=[(0,F.Ml)(e),{"::after":e===i.Sx.TeamsContrast&&{color:k.z.White}}],u=[(0,F.gS)("row"),{alignItems:"center"}],m={marginBottom:"15px"},h=[c,{fontSize:S.s.small,marginBottom:"5px"}],g=[m,{":hover":{".ms-Dropdown-titleIsPlaceHolder":[(0,F.aS)(e)]},".ms-Label":{"::after":e===i.Sx.TeamsContrast&&{color:k.z.White}}}],C=[(0,F.gS)("column"),(0,F.aS)(e),{justifyContent:"center",textAlign:"center",fontSize:S.s.large,height:"250px",fontWeight:S.BO.semibold}],x={".ms-Dialog-button":[(0,F.aS)(e),{":hover":[(0,F.aS)(e),{backgroundColor:"transparent"}]}]};return(0,S.TW)({groupPickerButton:s,dialogContainer:p,dialogFooterButtons:l,dialogFooter:{paddingTop:"15px"},dialogTitle:d,label:c,labelWithInfoIcon:u,infoIcon:{display:"inline-block",verticalAlign:"middle"},inputField:m,labelDescription:h,dropdown:g,loadingSpinner:C,dialogTopButton:x,tooltip:{maxWidth:"250px"}},o)}),le={circle:{borderColor:`${k.z.TeamsAppBrand00} ${k.z.TeamsDarkPurple} ${k.z.TeamsDarkPurple}`,marginBottom:"10px"}},pe=(0,l.J9)(e=>{let t,o,r,n;switch(e){case i.Sx.TeamsDark:t=k.z.NeutralPrimaryAlt,o=k.z.TeamsHoverBackgroundColor,r=k.z.NeutralPrimaryAlt,n=k.z.TeamsHoverBackgroundColor;break;case i.Sx.TeamsContrast:t=k.z.HighContrastBlackSelectedTextBackground,o=k.z.Black,r=k.z.HighContrastYellow,n=k.z.Black;break;default:t=k.z.TeamsHoverBackgroundColor,o=k.z.NeutralDarkGrey24,r=k.z.TeamsHoverBackgroundColor,n=k.z.NeutralDarkGrey24}return{groupPickerRoot:{ul:{marginLeft:"0px",paddingLeft:"10px",marginTop:"0px",".selected":{backgroundColor:t,color:o}},li:{":hover":{backgroundColor:r,color:n}},img:{borderRadius:"5px"},padding:"0px"},groupFilter:{paddingTop:"15px",paddingBottom:"15px",paddingLeft:"25px",paddingRight:"25px"},subComponentStyles:{groupList:ce(e),searchBar:de()}}}),de=(0,l.J9)(()=>({root:{borderColor:"transparent",backgroundColor:"transparent"}})),ce=(0,l.J9)(e=>({groupListRoot:{maxHeight:"300px"},groupRow:[(0,F.gS)(),{backgroundColor:k.z.Black,maxWidth:"100%",margin:"0px 0px",padding:"10px 10px"}],icon:[(0,F.$Z)("52px"),{height:"52px",width:"52px"}],groupContext:{},groupInfo:{},groupName:{}})),ue=(0,l.J9)(e=>({title:e.dialogTitle,topButton:e.dialogTopButton})),me=(0,l.J9)(e=>({dialogContainer:(0,S.Zq)("dialogContainer",e.dialogContainer),dialogFooterButtons:(0,S.Zq)("dialogFooterButtons",e.dialogFooterButtons),dialogFooter:(0,S.Zq)("dialogFooter",e.dialogFooter),groupPickerButton:(0,S.Zq)("groupPickerButton",e.groupPickerButton),label:(0,S.Zq)("labelStyles",e.label),labelWithInfoIcon:(0,S.Zq)("labelWithInfoIcon",e.labelWithInfoIcon),infoIcon:(0,S.Zq)("infoIcon",e.infoIcon),inputField:(0,S.Zq)("inputField",e.inputField),labelDescription:(0,S.Zq)("labelDescription",e.labelDescription),dropdown:(0,S.Zq)("dropdown",e.dropdown),loadingSpinner:(0,S.Zq)("loadingSpinner",e.loadingSpinner),dialogTitle:(0,S.Zq)("dialogTitle",e.dialogTitle),dialogTopButton:(0,S.Zq)("dialogTopButton",e.dialogTopButton),tooltip:(0,S.Zq)("tooltip",e.tooltip)}));var he,ge;!function(e){e.CreateNewForm="CreateNewForm",e.AddExistingForm="AddExistingForm"}(he||(he={})),function(e){e.Normal="Normal",e.Loading="Loading",e.Error="Error"}(ge||(ge={}));class Ce extends a.${name(){return"AddFormRequirementDialog"}componentDidMount(){this.state.selectedGroup&&this.props.fetchFormsInGroup(this.state.selectedGroup.id)}componentDidUpdate(e,t){("CreateNewForm"===t.selectedFormOption&&"AddExistingForm"===this.state.selectedFormOption&&this.state.selectedGroup?.id||this.state.selectedGroup&&this.state.selectedGroup!==t.selectedGroup)&&this.props.fetchFormsInGroup(this.state.selectedGroup.id)}renderComponent(){const{dialogContainer:e}=this.getClassNames();let t,o,n=j.h.normal;switch(this.state.dialogState){case"Loading":o=void 0,t=this.renderLoading();break;case"Error":o=I.p.Strings.AddFormRequirementDialog_CreateFormErrorDialogTitle,t=this.renderError(),n=j.h.close;break;default:o=I.p.Strings.AddFormRequirementDialog_AddFormRequirementDialogTitle,t=this.renderDialogContent()}return r.createElement(K.l,{hidden:!1,onDismiss:this.props.onDismiss,dialogContentProps:{className:this.props.dialogContentClassName,closeButtonAriaLabel:I.p.Strings.AddFormRequirementDialog_CloseDialogAriaLabel,title:o,styles:ue(se(this.props.theme,this.state.showGroupPickerCallout,this.props.contentStyles)),type:n},modalProps:{className:this.props.dialogClassName,containerClassName:(0,g.A)(this.props.dialogContainerClassName,e),isBlocking:!1}},t)}renderDialogContent(){return r.createElement("div",null,this.renderGroupPickerButton(),this.state.showGroupPickerCallout&&this.renderGroupPickerCallout(),this.renderFormOptions(),this.isInitialInputValid()&&this.renderCreateNewFormInput(),this.isInitialInputValid()&&this.renderAddExistingFormInput(),this.renderFooter())}renderLoading(){const{loadingSpinner:e}=this.getClassNames(),t=I.p.Strings.AddFormRequirementDialog_CreateFormLoadingText;return r.createElement("div",{className:e},r.createElement(M.y,{size:U.H.large,ariaLabel:t,styles:le}),t)}renderError(){const{dialogFooterButtons:e,dialogFooter:t}=this.getClassNames();return r.createElement("div",null,I.p.Strings.AddFormRequirementDialog_CreateFormErrorText,r.createElement(p.E,{className:t},r.createElement(s.j,{className:(0,g.A)("saveButton",e),onClick:this.onSubmit},I.p.Strings.AddFormRequirementDialog_TryAgainButtonText)))}renderFooter(){const{dialogFooterButtons:e,dialogFooter:t}=this.getClassNames(),o="CreateNewForm"===this.state.selectedFormOption?I.p.Strings.AddFormRequirementDialog_CreateNewFormButtonText:I.p.Strings.AddFormRequirementDialog_AddExistingFormButtonText;return r.createElement(p.E,{className:t},this.isInitialInputValid()&&r.createElement(s.j,{className:(0,g.A)("saveButton",e),disabled:!this.isRequiredInputValid(),onClick:this.onSubmit},o),r.createElement(Y.Y,{className:(0,g.A)("cancelButton",e),onClick:this.props.onDismiss},I.p.Strings.SharedComponents_CancelButtonText))}isRequiredInputValid(){if(!this.state.selectedGroup)return!1;switch(this.state.selectedFormOption){case"CreateNewForm":return!!this.state.formDisplayName;case"AddExistingForm":return!!this.state.selectedExistingForm&&!!this.state.formDisplayName;default:return!1}}isInitialInputValid(){return!(!this.state.selectedGroup||!this.state.selectedFormOption)}renderGroupPickerButton(){const{groupPickerButton:e,labelWithInfoIcon:t,tooltip:o}=this.getClassNames(),n=r.createElement(r.Fragment,null,this.state.selectedGroup?r.createElement("div",{className:"groupContent"},this.state.selectedGroup?.displayName):r.createElement(r.Fragment,null,r.createElement("div",{className:"defaultContent"},I.p.Strings.AddFormRequirementDialog_GroupPickerPlaceholder),r.createElement("div",{className:"groupSelectionDropdownIcon"},r.createElement(C.I,T.Ju))));return r.createElement(r.Fragment,null,r.createElement("div",{className:t},r.createElement(d.J,{required:!0},I.p.Strings.AddFormRequirementDialog_GroupPickerLabel),r.createElement(oe.S,{plannerTheme:this.props.theme,directionalHint:Q.A.rightCenter,content:I.p.Strings.AddFormRequirementDialog_GroupPickerTooltipText,className:o},r.createElement(C.I,{...T.h_,tabIndex:0}))),r.createElement("button",{"aria-haspopup":!0,className:e,onClick:this.onGroupPickerButtonClicked,type:"button",ref:e=>this.groupPickerButton=e},n))}renderGroupPickerCallout(){const e={theme:this.props.theme,hideHeaderFooter:!0,renderGroupContextInfo:!1,currentGroup:this.state.selectedGroup,groups:this.props.groups,sensitivityLabels:null,getGroupPhoto:()=>null,setGroup:e=>{this.setState({selectedGroup:e})},onRenderGroup:()=>null,alertUser:()=>null,onDismiss:this.onGroupPickerCalloutDismiss};return r.createElement(re.P,{calloutWidth:this.groupPickerButton.getBoundingClientRect().width,isBeakVisible:!1,gapSpace:0,doNotLayer:!1,target:this.groupPickerButton,onDismiss:this.onGroupPickerCalloutDismiss,setInitialFocus:!0,styles:(0,ie.df)(this.props.theme)},r.createElement(V,{styles:pe(this.props.theme),...e}))}renderFormOptions(){const{dropdown:e}=this.getClassNames(),t=[{key:"CreateNewForm",text:I.p.Strings.AddFormRequirementDialog_CreateNewFormOption},{key:"AddExistingForm",text:I.p.Strings.AddFormRequirementDialog_AddExistingFormOption}];return r.createElement(X.t,{label:I.p.Strings.AddFormRequirementDialog_FormOptionsDropdownLabel,debounceInterval:200,appTheme:this.props.theme,options:t,placeholder:I.p.Strings.AddFormRequirementDialog_FormOptionsDropdownPlaceholder,required:!0,selectedKey:this.state.selectedFormOption,onChange:this.onFormOptionChanged,className:(0,g.A)(e,"formOptionsDropdown")})}renderCreateNewFormInput(){if("CreateNewForm"!==this.state.selectedFormOption)return null;const{labelWithInfoIcon:e,inputField:t,labelDescription:o}=this.getClassNames();return r.createElement("div",{className:"createNewFormInput"},r.createElement(d.J,{className:e,required:!0},I.p.Strings.AddFormRequirementDialog_FormDisplayNameInputLabel),r.createElement("div",{className:o},I.p.Strings.AddFormRequirementDialog_FormDisplayNameInputDescription),r.createElement(ee.A,{appTheme:this.props.theme,placeholder:I.p.Strings.AddFormRequirementDialog_FormDisplayNameInputPlaceholder,styleType:te.u.Dialog,className:t,onChange:(e,t)=>{this.setState({formDisplayName:t})},value:this.state.formDisplayName,maxLength:ne.l.TitleMaxLength}))}renderAddExistingFormInput(){if("AddExistingForm"!==this.state.selectedFormOption||!this.state.selectedGroup)return null;const{label:e,inputField:t,dropdown:o}=this.getClassNames();let n=[];const i=this.props.getFormsInGroup(this.state.selectedGroup.id);return i&&(n=i.map(e=>({key:e.id,text:e.title,data:e}))),r.createElement("div",{className:"addExistingFormInput"},r.createElement(X.t,{label:I.p.Strings.AddFormRequirementDialog_ExistingFormDropdownLabel,debounceInterval:200,appTheme:this.props.theme,placeholder:I.p.Strings.AddFormRequirementDialog_ExistingFormDropdownPlaceholder,options:n,required:!0,selectedKey:this.state.selectedExistingForm?.id,onChange:this.onExistingFormChanged,className:(0,g.A)(o,"existingFormsDropdown")}),r.createElement(d.J,{className:e,required:!0},I.p.Strings.AddFormRequirementDialog_FormDisplayNameInputLabel),r.createElement(ee.A,{appTheme:this.props.theme,placeholder:I.p.Strings.AddFormRequirementDialog_FormDisplayNameInputPlaceholder,styleType:te.u.Dialog,className:t,onChange:(e,t)=>{this.setState({formDisplayName:t})},value:this.state.formDisplayName}))}getClassNames(){const{theme:e,contentStyles:t}=this.props;return me(se(e,this.state.showGroupPickerCallout,t))}constructor(e,t){super(e,t),this.onSubmit=()=>{if(this.setState({dialogState:"Loading"}),"CreateNewForm"===this.state.selectedFormOption&&this.state.selectedGroup)this.props.onCreateForm(this.state.formDisplayName,this.state.selectedGroup.id).then(()=>{this.props.onDismiss(),this.setState({dialogState:"Normal"})}).catch(()=>{this.setState({dialogState:"Error"})});else if("AddExistingForm"===this.state.selectedFormOption&&this.state.selectedExistingForm){const e={...this.state.selectedExistingForm,title:this.state.formDisplayName};this.props.onAddExistingForm(e).then(()=>{this.props.onDismiss(),this.setState({dialogState:"Normal"})})}},this.onGroupPickerButtonClicked=()=>{this.setState(e=>({showGroupPickerCallout:!e.showGroupPickerCallout}))},this.onGroupPickerCalloutDismiss=()=>{this.setState({showGroupPickerCallout:!1})},this.onFormOptionChanged=(e,t)=>{this.setState({selectedFormOption:t.key})},this.onExistingFormChanged=(e,t)=>{this.setState({selectedExistingForm:t.data})},this.state={selectedFormOption:null,selectedExistingForm:null,selectedGroup:this.props.currentGroup??null,showGroupPickerCallout:!1,existingForms:[],formDisplayName:"",dialogState:"Normal"}}}},77711:(e,t,o)=>{o.d(t,{$:()=>a});var r=o(65043),n=o(16112),i=o(91900);class a extends n.${renderComponent(){const{children:e,planContainerId:t,onRender:o}=this.props;return t?r.createElement(i.n,{containerId:t,onLoad:o},e):r.createElement(r.Fragment,null,e)}constructor(e,t){super(e,t),this.name=()=>"PlanPhotoContainer"}}},91900:(e,t,o)=>{o.d(t,{n:()=>d});var r=o(65043),n=o(16112),i=o(22317),a=o(66783),s=o(52195);const l=(0,a.J9)(()=>({anchor:{minHeight:"1px"}})),p=(0,a.J9)(e=>({anchor:(0,s.Zq)("virtualContainer-anchor",e.anchor)}));class d extends n.${componentDidUpdate(e,t){e.containerId!==this.props.containerId&&this.setState({hasLoaded:!1})}renderComponent(){return r.createElement(r.Fragment,null,this.renderIntersectionObs(),this.props.children)}renderIntersectionObs(){const e=this.getClassNames();return r.createElement("div",{className:"virtualContainer-wrapper"},r.createElement(i.pL,{onChange:this.handleInView,triggerOnce:!0},r.createElement("div",{className:e.anchor})))}getClassNames(){return p(l())}constructor(e,t){super(e,t),this.name=()=>"VirtualContainer",this.handleInView=e=>{!this.state.hasLoaded&&e&&(this.props.onLoad(),this.setState({hasLoaded:!0}))},this.state={hasLoaded:!1}}}}}]);
//# sourceMappingURL=addformrequirementdialog.f8374a7d.chunk.js.map