"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[82368],{56373:(e,t,r)=>{r.r(t),r.d(t,{StreamEmbeddedRenderer:()=>It});var n=r(70579),i=r(65043);var o=r(91730),a=r(33587),s=r(12851),c=r(56090),l=r(92424),d=r(85540),u=r(80220),f=r(28679),p=r(67911);const h="playerInteractiveTimestamp";function m(){return{setIsReady(e,t,r){const n=t.playerInteractiveTimestamp;if(n){const t=n.timestamp,i=n.timeOrigin,o=performance.timeOrigin,a=Math.abs(r-o),s=Math.round(e.startTime-a),c=t+i-r;e.setResult(!0,{timeDrift:Math.round(a),hostTimeOrigin:o,hostVariableTimeOrigin:r,activityStartTimeWithDrift:s,[h]:Math.round(t),playerInteractiveTimestamp_timeOrigin:Math.round(i),playerInteractiveTimestamp_currentTimeScale:Math.round(c),activityStartTimeMs_performanceNow:Math.round(e.startTime),unfurlDurationMs_performanceNow:Math.round(c-e.startTime)})}}}}const v=[" ","Enter"],y=[...v,"Tab"];function b(e){return"warmData"in e}function g(e){return"simulateClick"in e}var w=r(82500);function _(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w.z.VideoLoadFromUnfurl;return e.activities.get(t)}var k=r(65021),S=r(20723),P=r(27200),I=r(1880);function T(e,t){return null!=t&&"undefined"!==typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}function A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var E=function(){function e(t,r,n,i,o,a,s,c){A(this,e),this.level=t,this.isExpected=r,this.scenario=n,this.knownError=i,this.originalError=o,this.message=a,this.playbackSessionId=s,this.hostSessionId=c}return e.createKnownError=function(t,r,n,i,o,a,s,c){return new e(t,r,n,i,o,a,s,c)},e.createGenericError=function(t,r,n,i,o,a,s){var c=!1;if(void 0!==(null===i||void 0===i?void 0:i.isExpected))c=i.isExpected,o=i.errorName;else if(i&&i.message){var l=function(e){return"'ResizeObserver' is undefined"===e||"'ResizeObserver' is not defined"===e||"ResizeObserver is not defined"===e||"Can't find variable: ResizeObserver"===e||"'IntersectionObserver' is undefined"===e||"IntersectionObserver is not defined"===e||"Can't find variable: IntersectionObserver"===e||"'PerformanceObserver' is undefined"===e||"'PerformanceObserver' is not defined"===e||"function is not a constructor (evaluating 'new EventTarget')"===e||"<safe>Unsupported browser</safe>"===e||!(!e||!e.includes("setstrings"))||!(!e||!e.includes("URL is not supported"))||"e.addEventListener is not a function. (In 'e.addEventListener(\"change\",m)', 'e.addEventListener' is undefined)"===e||"Object doesn't support property or method 'addEventListener'"===e||"Performance timeOrigin is not supported"===e}(i.message);l&&(c=!0)}return e.createKnownError(t,c,r,n,i,o,a,s)},e}();function O(e,t){return O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},O(e,t)}function U(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O(e,t)}function C(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function R(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){C(e,t,r[t])})}return e}function M(e){return M=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},M(e)}function x(e){return e&&"undefined"!==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function D(e,t){return!t||"object"!==x(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function N(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=M(e);if(t){var i=M(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return D(this,r)}}function V(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(l){return void r(l)}s.done?t(c):Promise.resolve(c).then(n,i)}function L(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function a(e){V(o,n,i,a,s,"next",e)}function s(e){V(o,n,i,a,s,"throw",e)}a(void 0)})}}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function j(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o=[],a=!0,s=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);a=!0);}catch(c){s=!0,i=c}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}}(e,t)||function(e,t){if(e){if("string"===typeof e)return F(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?F(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var G=r(56851);function W(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var B=function e(t){A(this,e),this.willBeUnregistered=!1,this.unregisterOnNextCall=!1,this.callback=t},H=function(){function e(t){A(this,e),this._observers=new Array,this.onCallbackError=t}var t=e.prototype;return t.subscribe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return function(){};var r=new B(e);return r.unregisterOnNextCall=!!t.unregisterOnFirstCall,this._observers.push(r),this.internalRemove.bind(this,r)},t.notify=function(e){var t=!0,r=!1,n=void 0;try{for(var i,o=this._observers[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if(!a.willBeUnregistered){try{a.callback(e)}catch(s){this.onCallbackError&&this.onCallbackError(s)}a.unregisterOnNextCall&&this.deferUnregister(a)}}}catch(c){r=!0,n=c}finally{try{t||null==o.return||o.return()}finally{if(r)throw n}}},t.unsubscribeAll=function(){this._observers.length=0},t.deferUnregister=function(e){var t=this;e.unregisterOnNextCall=!1,e.willBeUnregistered=!0,setTimeout(function(){t.internalRemove(e)},0)},t.internalRemove=function(e){var t=this._observers.indexOf(e);return-1!==t&&(this._observers.splice(t,1),!0)},e}(),z=function(){function e(t,r){A(this,e),this._observable=new H(r),this._value=t,this.onCallbackError=r}var t,r,n,i=e.prototype;return i.unsubscribeAll=function(){this._observable.unsubscribeAll()},i.subscribe=function(e,t){var r=!(null===t||void 0===t?void 0:t.ignoreCurrentValue);if(r)try{e(this._value)}catch(n){this.onCallbackError&&this.onCallbackError(n)}return(null===t||void 0===t?void 0:t.unregisterOnFirstCall)&&r?function(){}:this._observable.subscribe(e,t)},t=e,(r=[{key:"value",get:function(){return this._value},set:function(e){e!==this._value&&(this._value=e,this._observable.notify(e))}}])&&W(t.prototype,r),n&&W(t,n),e}();class K{addCallback(e){this._callbacks.push(e)}dispose(){let e;for(;e=this._callbacks.pop();)e.call(this._owner)}constructor(e){this._callbacks=[],this._owner=e}}function Q(e){return"function"===typeof e.dispose}function $(e,t){const r=e,n=r.dispose,i="function"===typeof n&&n.disposalChain||function(e){const t=new K(e),r=e.dispose,n=()=>{t.dispose(),r&&(e.dispose=r,e.dispose())};return e.dispose=n,n.disposalChain=t,t}(r);return i.addCallback(t),r}class J{attach(e){const t=""+ ++this._lastDisposableId,r=$(e,()=>{delete this._disposables[t]});return this._disposables[t]=r,r}dispose(){this.isDisposed||(this.isDisposed=!0);const e=this._disposables;for(const t of Object.keys(e)){const r=e[t];r&&Q(r)&&r.dispose(),delete e[t]}}constructor(){this._disposables={},this._lastDisposableId=0,this.isDisposed=!1}}var X=function(){function e(e){this._scope=new J,this._targetMap=new WeakMap,this._disposableMap=new WeakMap}return e.prototype.on=function(e,t,r){var n;if(q(e))n=e;else{var i=this._targetMap.get(e);i?n=i:(n=new EventTarget,this._targetMap.set(e,n))}n.addEventListener(t,r);var o=this._disposableMap.get(e);o||(o=new Map,this._disposableMap.set(e,o));var a=this._scope.attach({dispose:function(){n.removeEventListener(t,r)}});o.set(t,a)},e.prototype.off=function(e,t,r){var n;if(q(e))n=e;else{var i=this._targetMap.get(e);i&&(n=i)}var o=this._disposableMap.get(e);if(o){var a=o.get(t);a&&(a.dispose(),o.delete(t)),0===o.size&&this._disposableMap.delete(e)}n&&n.removeEventListener(t,r)},e.prototype.dispose=function(){this._scope.dispose()},e}();function q(e){return!!e.addEventListener}var Y=function(){function e(e){this._scope=new J,this._timeoutMap=new Map}return e.prototype.setTimeout=function(e,t){var r=this,n=setTimeout(function(){r._timeoutMap.delete(n),e()},t),i=this._scope.attach({dispose:function(){clearTimeout(n)}});return this._timeoutMap.set(n,i),n},e.prototype.clearTimeout=function(e){var t=this._timeoutMap.get(e);t&&(this._timeoutMap.delete(e),t.dispose())},e.prototype.dispose=function(){this._scope.dispose()},e}(),Z="unsupportedCommand",ee="handlerError",te="handlerRejection",re="acknowledgeTimeout",ne="resultTimeout",ie="setupTimeout",oe="canceled",ae="disposed",se=0,ce=function(){function e(e,t){void 0===t&&(t={});var r=this,n=new Map,i={onCommand:e.onCommand,onNotification:e.onNotification},o=e.initResources,a=e.initTimeoutMs,s=void 0===a?1e4:a,c=e.ackTimeoutMs,l=void 0===c?1e3:c,d=e.resultTimeoutMs,u=void 0===d?1e4:d,f=t.asyncType,p=void 0===f?Y:f,h=t.eventGroupType,m=void 0===h?X:h,v=this._scope=new J;v.attach(o);var y,b=this._async=v.attach(new p(this)),g=v.attach(new m(this));this._ackTimeoutMs=l,this._resultTimeoutMs=u,this._invokeCommandHandler=function(e){try{var t=i.onCommand&&i.onCommand(e);return t?Promise.resolve(t).catch(function(e){return{result:"error",error:{code:(e=e||{name:te,isExpected:!1,message:"Unknown error"}).code||e.name||te,message:e.message||"".concat(e)},isExpected:!!e.isExpected}}):Promise.resolve({result:"error",error:{code:Z,message:e.command},isExpected:!0})}catch(r){return Promise.resolve({result:"error",isExpected:!1,error:{code:ee,message:r&&"Name: ".concat(r.name,"; Message: ").concat(r.message||r)}})}},this._invokeNotificationHandler=function(e){try{i.onNotification&&i.onNotification(e)}catch(a){}};var w=this._port=new Promise(function(t,n){v.attach({dispose:function(){var e=new Error("Initialization canceled.");e.code=oe,n(e)}}),y=b.setTimeout(function(){var e=new Error("Initialization timed out after ".concat(s,"ms"));e.code=ie,n(e)},s),e.init(function(e){b.clearTimeout(y),v.attach({dispose:function(){e.close()}});g.on(e,"message",function(t){var n=t.data;if(n&&"object"===typeof n)return"acknowledge"===n.type?r._onAcknowledge(n):"command"===n.type?r._onCommand(e,n):"notification"===n.type?r._onNotification(n):"result"===n.type?r._onResult(n):void 0}),e.start(),t(e)},n)});this.ready=w.then(function(){},function(e){return r.dispose(),Promise.reject(e)}),this._signals=n}return e.prototype.dispose=function(){this._scope.dispose(),this._signals.forEach(function(e){e.resolve({result:"error",isExpected:!0,error:{code:oe,message:"Messenger disposed"}})}),this._signals.clear()},e.prototype.sendCommand=function(e,t){var r=this;if(void 0===t&&(t={}),this._scope.isDisposed)return Promise.resolve({result:"error",isExpected:!1,error:{code:ae,message:"disposed"}});var n=++se,i=t.timeoutDelayMs,o=void 0===i?this._resultTimeoutMs:i,a=t.acknowledgeTimeoutMs,s=void 0===a?this._ackTimeoutMs:a,c=t.transfer;return this._port.then(function(t){var i=r._async,a=new Promise(function(e){r._signals.set(n,{acknowledgeTimeout:i.setTimeout(function(){r._onResult(le(n,re))},s),resultTimeout:i.setTimeout(function(){r._onResult(le(n,ne))},o),resolve:e})});return t.postMessage({type:"command",id:n,data:e},c||[]),a})},e.prototype.sendNotification=function(e){this._scope.isDisposed||this._port.then(function(t){t.postMessage({type:"notification",data:e})})},e.prototype._onAcknowledge=function(e){var t=this._signals.get(e.id);t&&this._async.clearTimeout(t.acknowledgeTimeout)},e.prototype._onCommand=function(e,t){var r=t.id;e.postMessage({type:"acknowledge",id:r}),this._invokeCommandHandler(t.data).then(function(t){e.postMessage({type:"result",data:t,id:r})}).catch(function(e){})},e.prototype._onNotification=function(e){this._invokeNotificationHandler(e.data)},e.prototype._onResult=function(e){var t=e.id,r=this._async,n=this._signals,i=n.get(t);i&&(r.clearTimeout(i.acknowledgeTimeout),r.clearTimeout(i.resultTimeout),i.resolve(e.data)),n.delete(t)},e}();function le(e,t){return{id:e,data:{result:"error",error:{code:t,message:"Timed out"},isExpected:!1}}}const de={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let ue;const fe=new Uint8Array(16);function pe(){if(!ue&&(ue="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ue))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ue(fe)}const he=[];for(let Tt=0;Tt<256;++Tt)he.push((Tt+256).toString(16).slice(1));function me(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return he[e[t+0]]+he[e[t+1]]+he[e[t+2]]+he[e[t+3]]+"-"+he[e[t+4]]+he[e[t+5]]+"-"+he[e[t+6]]+he[e[t+7]]+"-"+he[e[t+8]]+he[e[t+9]]+"-"+he[e[t+10]]+he[e[t+11]]+he[e[t+12]]+he[e[t+13]]+he[e[t+14]]+he[e[t+15]]}const ve=function(e,t,r){if(de.randomUUID&&!t&&!e)return de.randomUUID();const n=(e=e||{}).random||(e.rng||pe)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return me(n)};var ye,be=(C(ye={},"SHAREPOINT_TOKEN","SPO"),C(ye,"MS_GRAPH_TOKEN","GRAPH"),C(ye,"MS_SUBSTRATE_TOKEN","SUBSTRATE"),C(ye,"MS_SUBSTRATE_SEARCH_TOKEN","SUBSTRATE_SEARCH"),C(ye,"MS_LOKI_TOKEN","LOKI"),ye);function ge(){return(ge=L(function(e,t,r){var n,i,o,a,s,c;return(0,G.__generator)(this,function(l){switch(l.label){case 0:if(!Object.prototype.hasOwnProperty.call(be,e.tokenType))return[3,4];n=e.tokenType,l.label=1;case 1:return l.trys.push([1,3,,4]),[4,t.getTokenAsync(be[n],r)];case 2:return i=l.sent(),[2,{result:"success",token:i}];case 3:return o=l.sent(),a="",s="","object"===("undefined"===typeof o?"undefined":x(o))&&null!==o&&(c=o,a=Object.prototype.hasOwnProperty.call(c,"code")&&"string"===typeof c.code?c.code:"",s=Object.prototype.hasOwnProperty.call(c,"message")&&"string"===typeof c.message?c.message:""),[2,{result:"error",isExpected:!1,error:{code:a,message:s}}];case 4:return[2,{result:"error",isExpected:!1,error:{code:"UnsupportedTokenType",message:"Unsupported token type"}}]}})})).apply(this,arguments)}var we=function(){function e(){A(this,e),this.playState=new z(void 0),this.isPlayerReady=new z(!1),this.lastUserAction=new H,this.currentTimeInSeconds=new z(void 0),this.muted=new z(void 0),this.volume=new z(void 0),this.mediaDurationInSeconds=new z(void 0),this.playbackSpeed=new z(void 0),this.title=new z(void 0),this.itemUrl=new z(void 0),this.playerBeforeUnload=new H}return e.prototype.dispose=function(){this.playState.unsubscribeAll(),this.isPlayerReady.unsubscribeAll(),this.lastUserAction.unsubscribeAll(),this.currentTimeInSeconds.unsubscribeAll(),this.muted.unsubscribeAll(),this.volume.unsubscribeAll(),this.mediaDurationInSeconds.unsubscribeAll(),this.playbackSpeed.unsubscribeAll(),this.title.unsubscribeAll(),this.itemUrl.unsubscribeAll(),this.playerBeforeUnload.unsubscribeAll()},e}(),_e=function(){function e(t,r,n,i,o){var a=this;A(this,e),this._ttlMs=new z(void 0),this._ttirMs=new z(void 0),this._playerInteractiveTimestamp=new z(void 0),this._pbsid=new z(void 0),this._latestValuesFromIframe={playState:void 0,currentTime:void 0,muted:void 0,volume:void 0,playbackSpeed:void 0},this.playerBeforeUnloadNotify=function(){a.externalPlayerApi.playerBeforeUnload.notify(!0)},this.crossWindow=t,this._tokenRetriever=r,this._embedUrl=n,this._onError=i,this._onTitleOrDisplayNameUpdate=o,this.externalPlayerApi=new we,this.playerStats={ttlMs:this._ttlMs,ttirMs:this._ttirMs,playerInteractiveTimestamp:this._playerInteractiveTimestamp,playbackSessionId:this._pbsid},this.subscribeToApiEvents(),window.addEventListener("beforeunload",this.playerBeforeUnloadNotify)}var t=e.prototype;return t.dispose=function(){window.removeEventListener("beforeunload",this.playerBeforeUnloadNotify),this.externalPlayerApi.dispose()},t.warmData=function(){return this.crossWindow.sendCommand({command:"one-player-warm-data"}).then(function(){return Promise.resolve()}).catch(function(e){throw E.createGenericError("warning","warmData","warmDataUnknown",e)})},t.loadPlayer=function(e){return this.crossWindow.sendCommand({command:e?"one-player-load-player-auto-play":"one-player-load-player"}).then(function(){return Promise.resolve()}).catch(function(e){throw E.createGenericError("fatal","loadPlayer","loadPlayerUnknown",e)})},t.onCommand=function(e){if("getToken"===e.command)return function(e,t,r){return ge.apply(this,arguments)}(e,this._tokenRetriever,this._embedUrl)},t.onNotification=function(e){switch(void 0===this._pbsid.value&&void 0!==e.pbsid&&(this._pbsid.value=e.pbsid),e.notification){case"one-player-duration":this.externalPlayerApi.mediaDurationInSeconds.value=e.durationInSeconds;break;case"one-player-volume":this._latestValuesFromIframe.volume=e.volume,this.externalPlayerApi.volume.value=e.volume;break;case"one-player-muted":this._latestValuesFromIframe.muted=e.isMuted,this.externalPlayerApi.muted.value=e.isMuted;break;case"one-player-current-time":this._latestValuesFromIframe.currentTime=e.currentTime,this.externalPlayerApi.currentTimeInSeconds.value=e.currentTime;break;case"one-player-playback-speed":this._latestValuesFromIframe.playbackSpeed=e.playbackSpeed,this.externalPlayerApi.playbackSpeed.value=e.playbackSpeed;break;case"one-player-first-interactive":void 0!==e.timestamp&&void 0!==e.timestampTimeOrigin&&(this._playerInteractiveTimestamp.value={timestamp:e.timestamp,timeOrigin:e.timestampTimeOrigin});break;case"one-player-player-ready":this.externalPlayerApi.isPlayerReady.value=!0===e.isReady,void 0!==e.ttlMs&&(this._ttlMs.value=e.ttlMs);break;case"one-player-play-state":var t="Playing"===e.playState?"Playing":"Paused";this._latestValuesFromIframe.playState=t,this.externalPlayerApi.playState.value=t,void 0!==e.ttirMs&&(this._ttirMs.value=e.ttirMs);break;case"one-player-fatal-playback-error":this._onError(e.onePlayerError||E.createGenericError("fatal","playback","playbackUnknown",e.error,void 0,e.pbsid,e.hsi));break;case"one-player-fatal-create-session-error":this._onError(e.onePlayerError||E.createGenericError("fatal","createSession","createSessionUnknown",e.error,void 0,e.pbsid,e.hsi));break;case"one-player-reconnect-host":this.loadAndConnectToOnePlayerCallback(this).catch(function(e){throw E.createGenericError("fatal","requestReconnect","errorReconnecting",e)});break;case"one-player-user-click-play":this.externalPlayerApi.lastUserAction.notify({action:"Play"});break;case"one-player-user-click-pause":this.externalPlayerApi.lastUserAction.notify({action:"Pause"});break;case"one-player-user-begin-seek":this.externalPlayerApi.lastUserAction.notify({action:"BeginSeek"});break;case"one-player-user-end-seek":if(void 0===e.targetTimeInSeconds)return void this._onError(E.createGenericError("warning","notification","targetTimeInSecondsUndefinedInEndSeekEvent",new Error("targetTimeInSeconds is undefined")));this.externalPlayerApi.lastUserAction.notify({action:"EndSeek",targetTimeInSeconds:e.targetTimeInSeconds});break;case"one-player-user-skip":if(void 0===e.targetTimeInSeconds)return void this._onError(E.createGenericError("warning","notification","targetTimeInSecondsUndefinedInSkipEvent",new Error("targetTimeInSeconds is undefined")));this.externalPlayerApi.lastUserAction.notify({action:"Skip",targetTimeInSeconds:e.targetTimeInSeconds});break;case"one-player-title-updated":this._onTitleOrDisplayNameUpdate(e.title),this.externalPlayerApi.title.value=e.title;break;case"one-player-item-url":this.externalPlayerApi.itemUrl.value=e.itemUrl;break;case"one-player-title-or-display-name-known":this._onTitleOrDisplayNameUpdate(e.value)}},t.subscribeToApiEvents=function(){var e=this;this.externalPlayerApi.playState.subscribe(function(t){t&&t!==e._latestValuesFromIframe.playState&&e.crossWindow.sendCommand({command:"Paused"===t?"one-player-pause":"one-player-play"}).catch(function(t){e._onError(E.createGenericError("warning","playback","enginePlayback",t,"could not send play/pause command"))})}),this.externalPlayerApi.currentTimeInSeconds.subscribe(function(t){void 0!==t&&t!==e._latestValuesFromIframe.currentTime&&e.crossWindow.sendCommand({command:"one-player-seek",position:t}).catch(function(t){e._onError(E.createGenericError("warning","playback","enginePlayback",t,"could not send seek command"))})}),this.externalPlayerApi.muted.subscribe(function(t){t!==e._latestValuesFromIframe.muted&&e.crossWindow.sendCommand({command:t?"one-player-mute":"one-player-unmute"}).catch(function(t){e._onError(E.createGenericError("warning","playback","enginePlayback",t,"could not send mute/unmute command"))})}),this.externalPlayerApi.volume.subscribe(function(t){t!==e._latestValuesFromIframe.volume&&e.crossWindow.sendCommand({command:"one-player-set-volume",volumeLevel:t}).catch(function(t){e._onError(E.createGenericError("warning","playback","enginePlayback",t,"could not send set-volume command"))})}),this.externalPlayerApi.playbackSpeed.subscribe(function(t){t!==e._latestValuesFromIframe.playbackSpeed&&e.crossWindow.sendCommand({command:"one-player-set-playback-speed",playbackSpeed:t}).catch(function(t){e._onError(E.createGenericError("warning","playback","enginePlayback",t,"could not send set-playback-speed command"))})})},e}(),ke=function(){function e(t,r,n,i,o){var a=this;if(A(this,e),this._channelId=ve(),this._onError=i,this._onTitleOrDisplayNameUpdate=o,null===r.contentWindow)throw new Error("The iframe's contentWindow is null");var s=window.location.origin&&"null"!==window.location.origin?window.location.origin:"*",c=new URL(t),l=new URLSearchParams(c.hash.slice(1));l.set("channelId",this._channelId),l.set("origin",s),c.hash=l.toString(),this._embedUrl=c.toString(),this._host=function(e,t){void 0===t&&(t={});var r=e.channelId,n=e.onReinitialize,i=e.origin,o=e.receiver,a=void 0===o?window:o,s=e.source,c=e.identifyParent,l=t.eventGroupType,d=void 0===l?X:l,u=t.messengerType,f=void 0===u?ce:u,p=new J,h=p.attach(new d(null));return new f({onCommand:e.onCommand,onNotification:e.onNotification,init:function(e,t){var o;if(c&&s){var l=setInterval(function(){var e={type:"identify-parent",channelId:r};s.postMessage(e,i)},100);o=p.attach({dispose:function(){clearInterval(l)}})}var d=!1;h.on(a,"message",function(t){var a,c,l=t.data;if(a=t.origin,c=i,(a&&c?a.toUpperCase()===c.toUpperCase():a===c)&&(!s||t.source===s)&&l&&"object"===typeof l&&"initialize"===l.type&&l.channelId===r){if(o&&o.dispose(),n){if(d)return n(),void h.dispose();d=!0}else h.dispose();var u=l.replyTo;u.postMessage({type:"activate"}),e(u)}})},initResources:p,initTimeoutMs:e.initTimeoutMs,ackTimeoutMs:e.ackTimeoutMs,resultTimeoutMs:e.resultTimeoutMs})}({identifyParent:!0,source:r.contentWindow,channelId:this._channelId.toString(),origin:new URL(t).origin,initTimeoutMs:4e4,onCommand:this.onCommand.bind(this),onNotification:this.onNotification.bind(this)}),this._host.ready.catch(function(e){i(E.createGenericError("fatal","createCrossWindowChannel","crossWindowChannelInitializationError",e,"could not initialize cross window channel")),a.dispose()}),this._tokenRetriever=n}var t=e.prototype;return t.createIframeApi=function(){this.iFrameApi=new _e(this._host,this._tokenRetriever,this._embedUrl,this._onError,this._onTitleOrDisplayNameUpdate),this._onNotificationCallback=this.iFrameApi.onNotification.bind(this.iFrameApi),this._onCommandCallback=this.iFrameApi.onCommand.bind(this.iFrameApi)},t.reconnectHost=function(e){e.crossWindow=this._host,this.iFrameApi=e,this._onNotificationCallback=this.iFrameApi.onNotification.bind(this.iFrameApi),this._onCommandCallback=this.iFrameApi.onCommand.bind(this.iFrameApi)},t.getDecoratedEmbedUrl=function(){return this._embedUrl},t.dispose=function(){this.iFrameApi.dispose(),this._host.dispose()},t.onCommand=function(e){return this._onCommandCallback(e)},t.onNotification=function(e){this._onNotificationCallback(e)},e}();function Se(e,t,r,n){return Pe.apply(this,arguments)}function Pe(){return(Pe=L(function(e,t,r,n){return(0,G.__generator)(this,function(i){return[2,new Promise(function(i,o){var a=!1,s=0,c=function(){a=!0,clearTimeout(s)};e.onload=function(){c(),i()},e.onerror=function(e){c(),o(e)};var l=e.contentDocument;l.body||l.createElement("body");var d=l.createElement("form");d.action=t,d.method="POST",d.style.visibility="hidden",d.target="_self";var u=l.createElement("input");if(u.type="hidden",u.name="access_token",u.value=r.token,d.appendChild(u),n){var f=l.createElement("input");u.type="hidden",u.name="SPOPacToken",u.value=n.token,d.appendChild(f)}l.body.appendChild(d),d.submit(),s=setTimeout(function(){a||o(new Error("Timeout error in iframe loading"))},4e4)})]})})).apply(this,arguments)}var Ie=function(){function e(t,r,n,i,o,a){var s=this,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Se;A(this,e),this.observer=void 0,this.isIframeConnected=new z(!1),this.defaultIframeTitle="Microsoft Stream video and audio player",this._hasNavigatedToAboutBlank=!1,this._iframe=document.createElement("iframe"),this._iframe.style.flex="1",this._iframe.style.border="none",o&&(this._iframe.allowFullscreen=!0),this._iframe.allow="autoplay *;clipboard-write *;",this._iframe.setAttribute("sandbox","allow-forms allow-scripts allow-same-origin allow-popups allow-downloads"),this._iframe.setAttribute("title",this.defaultIframeTitle);var l=this.onLoad.bind(this);this._iframe.addEventListener("load",l),this._embedUrl=t,this._containerDiv=r,this._tokenRetriever=n,this._onError=i,this._pacToken=a,this._navigateIframeToEmbedAsync=c,this._containerDiv.style.display="flex",this._containerDiv.appendChild(this._iframe),this.observer=new MutationObserver(function(){var e,t,r;(s.isIframeConnected.value=(null===(e=s._iframe)||void 0===e?void 0:e.isConnected)||!1,null===(t=s._iframe)||void 0===t?void 0:t.isConnected)&&(null===(r=s.observer)||void 0===r||r.disconnect())}),this._disposeActions=[function(){var e;s._iframe&&(s._containerDiv.removeChild(s._iframe),s._iframe.removeEventListener("load",l),s._iframe=void 0),null===(e=s.observer)||void 0===e||e.disconnect()}]}var t=e.prototype;return t.loadAndConnectToOnePlayer=function(e){var t=this;return L(function(){var r,n;return(0,G.__generator)(this,function(i){switch(i.label){case 0:if(void 0===t._iframe)throw new Error("Cannot load and connect to OnePlayer because the iframe has been disposed.");return[4,t.getSpoTokenAsync(t._embedUrl,t._tokenRetriever)];case 1:return r=i.sent(),t._embedUrl=t.adjustEmbedUrlHash(t._embedUrl,r),e&&t.reCreateIframeElement(),[4,t.waitForIframeConnected()];case 2:i.sent(),t._crossWindowChannel=new ke(t._embedUrl,t._iframe,t._tokenRetriever,t._onError,function(e){return t._onTitleOrDisplayNameUpdate(e)}),e?t._crossWindowChannel.reconnectHost(e):t._crossWindowChannel.createIframeApi(),t._disposeActions.push(function(){var e;return null===(e=t._crossWindowChannel)||void 0===e?void 0:e.dispose()}),t._embedUrl=t._crossWindowChannel.getDecoratedEmbedUrl(),i.label=3;case 3:return i.trys.push([3,5,,6]),[4,t._navigateIframeToEmbedAsync(t._iframe,t._embedUrl,r,t._pacToken)];case 4:return i.sent(),[3,6];case 5:if(n=i.sent(),t._crossWindowChannel.dispose(),T(n,E))throw n;throw E.createGenericError("fatal","loadIframe","navToEmbed",n);case 6:return[2,t._crossWindowChannel.iFrameApi]}})})()},t.dispose=function(){var e=!0,t=!1,r=void 0;try{for(var n,i=this._disposeActions[Symbol.iterator]();!(e=(n=i.next()).done);e=!0){(0,n.value)()}}catch(o){t=!0,r=o}finally{try{e||null==i.return||i.return()}finally{if(t)throw r}}this._disposeActions.length=1},t.reCreateIframeElement=function(){this._iframe&&(this.dispose(),this._hasNavigatedToAboutBlank=!1),this._iframe=document.createElement("iframe"),this._iframe.style.flex="1",this._iframe.style.border="none",this._iframe.allow="autoplay *;clipboard-write *;",this._iframe.setAttribute("sandbox","allow-forms allow-scripts allow-same-origin allow-popups"),this._iframe.setAttribute("title",this.defaultIframeTitle);var e=this.onLoad.bind(this);this._iframe.addEventListener("load",e),this._containerDiv.style.display="flex",this._containerDiv.appendChild(this._iframe)},t.waitForIframeConnected=function(){var e=this;return L(function(){return(0,G.__generator)(this,function(t){return[2,new Promise(function(t){var r;if(null===(r=e._iframe)||void 0===r?void 0:r.isConnected)t();else{var n=e.isIframeConnected.subscribe(function(e){e&&t()});e._disposeActions.push(function(){return n()})}})]})})()},t.onLoad=function(){try{var e,t,r,n;"about:blank"!==(null===(t=this._iframe)||void 0===t||null===(e=t.contentWindow)||void 0===e?void 0:e.location.href)&&(null===(n=this._iframe)||void 0===n||null===(r=n.contentWindow)||void 0===r?void 0:r.location.href)||(this._hasNavigatedToAboutBlank&&this._onError(E.createGenericError("fatal","loadIframe","iframeForciblyUnloaded",void 0,void 0)),this._hasNavigatedToAboutBlank=!0)}catch(i){T(i,DOMException)&&(this._hasNavigatedToAboutBlank=!0)}},t._onTitleOrDisplayNameUpdate=function(e){var t;null===(t=this._iframe)||void 0===t||t.setAttribute("title",e||this.defaultIframeTitle)},t.getSpoTokenAsync=function(e,t){return L(function(){var r;return(0,G.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,4,,5]),t.getTokenWithAuthTypeAsync?[2,t.getTokenWithAuthTypeAsync("SPO",e)]:[3,1];case 1:return[4,t.getTokenAsync("SPO",e)];case 2:return[2,{token:n.sent()}];case 3:return[3,5];case 4:throw r=n.sent(),E.createGenericError("fatal","loadIframe","getTokenFailed",r);case 5:return[2]}})})()},t.adjustEmbedUrlHash=function(e,t){var r=new URL(e),n=new URLSearchParams(r.hash.slice(1));return n.set("access_token",t.token),r.hash=n.toString(),r.toString()},e}(),Te=function(){function e(t){A(this,e),this._loaderOptionsBase=t}var t=e.prototype;return t.createPlaybackSession=function(e,t){var r=this;return L(function(){var n,i,o,a;return(0,G.__generator)(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,r.createPlaybackSessionInternal(e?"autoplayOn":"autoplayOff",t)];case 1:return n=j.apply(void 0,[s.sent(),2]),i=n[0],o=n[1],[2,{playbackApi:i.externalPlayerApi,dispose:o,playerStats:i.playerStats}];case 2:throw T(a=s.sent(),E)?a:E.createGenericError("fatal","loadIframe","iframeUnknown",a,void 0,t.hostSessionId);case 3:return[2]}})})()},t.createThumbnailHyperlinkOnlySession=function(e){var t=this;return L(function(){var r,n,i,o;return(0,G.__generator)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,t.createPlaybackSessionInternal("thumbnailHyperlinkOnly",e)];case 1:return r=j.apply(void 0,[a.sent(),2]),n=r[0],i=r[1],[2,{playbackApi:n.externalPlayerApi,playerStats:n.playerStats,dispose:i,simulateClick:function(){return n.loadPlayer(!0)}}];case 2:return o=a.sent(),[2,Promise.reject(o)];case 3:return[2]}})})()},t.createDeferredPlaybackSession=function(e){var t=this;return L(function(){var r,n,i,o,a;return(0,G.__generator)(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,t.createPlaybackSessionInternal("deferredLoad",e)];case 1:return r=j.apply(void 0,[s.sent(),2]),n=r[0],i=r[1],o=new z(void 0),n.externalPlayerApi.isPlayerReady.subscribe(function(e){e&&(o.value=n.externalPlayerApi)}),[2,{playbackApi:o,loadPlayer:function(e){return n.loadPlayer(e)},warmData:function(){return n.warmData()},dispose:i,playerStats:n.playerStats}];case 2:throw T(a=s.sent(),E)?(a.hostSessionId=e.hostSessionId,a):E.createGenericError("fatal","loadIframe","iframeUnknown",a,void 0,e.hostSessionId);case 3:return[2]}})})()},t.createOnePlayerIframe=function(e,t,r,n,i,o){return new Ie(e,t,r,n,i,o)},t.createPlaybackSessionInternal=function(e,t){var r=this;return L(function(){var n,i,o,a,s,c,l;return(0,G.__generator)(this,function(d){switch(d.label){case 0:return n=performance.now(),i={timeOrigin:Date.now()-n,timestamp:n},[4,r.getEmbedUrlAsync(t.videoId.videoUrl)];case 1:return o=d.sent(),o=r.adjustEmbedUrlQueryString(e,o,t,i),a=void 0,s=function(){try{null===a||void 0===a||a.dispose()}catch(e){throw T(e,E)?e:E.createGenericError("fatal","dispose","disposeUnknown",e,void 0,t.hostSessionId)}},c=function(e){t.onError(s,e)},[4,(a=r.createOnePlayerIframe(o,t.containerDiv,r._loaderOptionsBase.tokenRetriever,c,t.allowFullscreen,r._loaderOptionsBase.pacToken)).loadAndConnectToOnePlayer()];case 2:return(l=d.sent()).loadAndConnectToOnePlayerCallback=a.loadAndConnectToOnePlayer.bind(a),[2,[l,s]]}})})()},e}();const Ae="13.27.6";var Ee=function(e){U(r,e);var t=N(r);function r(e){return A(this,r),t.call(this,e)}var n=r.prototype;return n.adjustEmbedUrlQueryString=function(e,t,r,n){var i=new URL(t);i.searchParams.delete("access_token"),i.searchParams.set("auth","readwrite");var o,a,s=void 0,c=void 0,l=void 0;r.theme&&(s="light"===r.theme.name?1:0,c=r.theme.primaryColor,l=r.theme.fluentTheme);var d=JSON.stringify({ap:"autoplayOn"===e?1:0,dl:"deferredLoad"===e?1:void 0,ha:r.hostApp,hp:r.hostPlatform,hv:r.hostView,hc:r.hostComponent,hci:r.hostCorrelationId,het:r.hostExtraTelemetry,hra:r.hostReferrerApp,hrp:r.hostReferrerAppPlatform,hrv:r.hostReferrerView,hrm:r.hostReferrerMode,hrps:r.hostReferrerPlaybackSessionId,hvn:r.hostVersion,he:r.hostEnvironment,hm:r.hostMode,hsi:r.hostSessionId,hr:r.hostReferrer,hrs:r.hostReferrerScenario,lv:Ae,t0:null!==(o=r.hostTimestamps.t0.timestamp)&&void 0!==o?o:0,t0to:null!==(a=r.hostTimestamps.t0.timeOrigin)&&void 0!==a?a:performance.timeOrigin,tcs:n.timestamp,tcsto:n.timeOrigin,ust:s,pc:c,theme:l,ol:r.overrideLanguage,hvm:r.hideVideoMetadata,itf:r.enableVideoPlayerTabstopDuringPlayback?"rc":"ffe"});if(i.searchParams.set("embed",d),r.startTimeInSeconds||r.clipInformation){var u={playbackOptions:R({},r.startTimeInSeconds?{startTimeInSeconds:r.startTimeInSeconds}:{},r.clipInformation?{playbackModifier:{clipInformation:r.clipInformation}}:{})};i.searchParams.set("nav",JSON.stringify(u))}if(r.flightsUsed||r.flightsUnused){var f={flightsUsed:r.flightsUsed?r.flightsUsed.join(","):void 0,flightsUnused:r.flightsUnused?r.flightsUnused.join(","):void 0};i.searchParams.set("exp",JSON.stringify(f))}return i.toString()},n.getEmbedUrlAsync=function(e){if(-1!==e.indexOf("embed.aspx"))return Promise.resolve(e);throw E.createGenericError("fatal","loadIframe","unrecognizedVideoUrlFormat",void 0)},r}(Te);var Oe=function(e){U(r,e);var t=N(r);function r(e){return A(this,r),t.call(this,e)}var n=r.prototype;return n.adjustEmbedUrlQueryString=function(e,t,r,n){var i,o,a,s,c,l,d=new URL(t);d.searchParams.delete("access_token"),d.searchParams.set("auth","readwrite");var u=JSON.stringify({ha:r.hostApp,hp:r.hostPlatform,hv:r.hostView,hm:r.hostMode,hsi:r.hostSessionId,he:r.hostEnvironment,hc:r.hostComponent,hci:r.hostCorrelationId,het:r.hostExtraTelemetry,hra:r.hostReferrerApp,hrp:r.hostReferrerAppPlatform,hrv:r.hostReferrerView,hrm:r.hostReferrerMode,hrps:r.hostReferrerPlaybackSessionId,hr:r.hostReferrer,hrs:r.hostReferrerScenario,hvn:r.hostVersion,lv:Ae,t0:null!==(c=r.hostTimestamps.t0.timestamp)&&void 0!==c?c:0,t0to:null!==(l=r.hostTimestamps.t0.timeOrigin)&&void 0!==l?l:performance.timeOrigin,tcs:n.timestamp,tcsto:n.timeOrigin,dl:"deferredLoad"===e?1:void 0,ap:"autoplayOn"===e?1:void 0,thl:"thumbnailHyperlinkOnly"===e?1:void 0,thm:null===(i=r.theme)||void 0===i?void 0:i.name,pc:null===(o=r.theme)||void 0===o?void 0:o.primaryColor,flthm:null===(a=r.theme)||void 0===a?void 0:a.fluentTheme,ol:r.overrideLanguage,hvm:r.hideVideoMetadata,itf:r.enableVideoPlayerTabstopDuringPlayback?"rc":"ffe",pso:"highlights"===(null===(s=r.playSegmentsOptions)||void 0===s?void 0:s.mode)?"hl":void 0,dm:r.defaultMuted});if(d.searchParams.set("embed",u),r.startTimeInSeconds||r.clipInformation){var f={playbackOptions:R({},r.startTimeInSeconds?{startTimeInSeconds:r.startTimeInSeconds}:{},r.clipInformation?{playbackModifier:{clipInformation:r.clipInformation}}:{})};d.searchParams.set("nav",JSON.stringify(f))}if(r.flightsUsed||r.flightsUnused){var p={flightsUsed:r.flightsUsed?r.flightsUsed.join(","):void 0,flightsUnused:r.flightsUnused?r.flightsUnused.join(","):void 0};d.searchParams.set("exp",JSON.stringify(p))}return d.toString()},n.getEmbedUrlAsync=function(e){if(-1!==e.indexOf("streamembed.aspx"))return Promise.resolve(e);throw E.createGenericError("fatal","loadIframe","unrecognizedVideoUrlFormat",void 0,void 0)},r}(Te);var Ue=r(80789),Ce=r(16775);const Re="MSIE",Me="Chrome",xe="Firefox",De="Safari",Ne="Edge",Ve="Edge Chromium",Le="Electron",Fe="SkypeShell",je="PhantomJS",Ge="Opera",We="Windows",Be="Mac OS X",He="Windows Phone",ze="Windows RT",Ke="iOS",Qe="Android",$e="Linux",Je=/(windows|win32)/i,Xe=/ arm;/i,qe=/windows\sphone\s\d+\.\d+/i,Ye=/(macintosh|mac os x)/i,Ze=/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i,et=/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,tt=/android/i,rt={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},nt="([\\d,.]+)",it="Unknown";function ot(e,t){return t.indexOf(e)>-1}function at(e,t){if(t===Re)return function(e){const t=e.match(new RegExp(Re+" "+nt));if(t)return t[1];{const t=e.match(new RegExp("rv:"+nt));if(t)return t[1]}return""}(e);return function(e,t){let r=e;r===De&&(r="Version");const n=t.match(new RegExp(r+"/"+nt));if(n)return n[1];return}(t===Ve?"Edg":t,e)}const st=(e,t)=>{const r=e.match(new RegExp(t+" "+nt));return r?rt[r[1]]?rt[r[1]]:r[1]:it},ct=e=>{const t=e.match(new RegExp(Be+" ([\\d,_,.]+)"));if(t){const e=t[1].replace(/_/g,".");if(e){const t=(e=>e.indexOf(".")>-1?".":e.indexOf("_")>-1?"_":null)(e);if(t){return e.split(t)[0]}return e}}return it};let lt;function dt(){if(!lt){const e="undefined"!==typeof navigator?navigator.userAgent:"",t=function(e){return ot("OPR/",e)?Ge:ot(je,e)?je:ot(Ne,e)?Ne:ot("Edg",e)?Ve:ot(Le,e)?Le:ot(Me,e)?Me:ot("Trident",e)?Re:ot(xe,e)?xe:ot(De,e)?De:ot(Fe,e)?Fe:void 0}(e),r=void 0!==t?at(e,t):void 0,n=(e=>e.match(qe)?He:e.match(Xe)?ze:e.match(Ze)?Ke:e.match(tt)?Qe:e.match(et)?$e:e.match(Ye)?Be:e.match(Je)?We:it)(e),i=void 0!==n?((e,t)=>t===We?st(e,"Windows NT"):t===Qe?st(e,t):t===Be?ct(e):it)(e,n):void 0;lt={browserName:t,browserVersion:r,osName:n,osVersion:i}}return lt}const ut=()=>"undefined"===typeof window,ft=()=>!!window.chrome?.webview;function pt(){const{osName:e}=dt();return function(e){if(ut()||ft())switch(e){case"Android":return"Android";case"iOS":return"iOS";case"Linux":return"Linux";case"Mac OS X":return"Mac";case"Windows":return"Win32";default:return}return"Web"}(e)}function ht(e){const t=function(e){let t,r=pt()??"Native";switch(e){case Ce.C.ExchangeAppId:case Ce.C.MonarchAppId:case Ce.C.OwaAppId:t=Ce.b.Outlook,ft()&&(r="Desktop");break;case Ce.C.OfficeAppId:t="Win32"===r?Ce.b.Outlook:Ce.b.LoopApp;break;case Ce.C.LoopAppId:t=Ce.b.LoopApp}return{hostApp:t,hostPlatform:r}}(e),r=t.hostPlatform||"";return t.hostApp===Ce.b.LoopApp?{hostApp:"Loop",hostPlatform:r}:{hostApp:t.hostApp??e,hostPlatform:r}}var mt=r(73540);function vt(e){const t=e.searchParams.get("nav");if(t)try{const e=atob(t),{referralInfo:r}=JSON.parse(e);if(!r)return;const n=`${r.referralApp}${r.referralAppPlatform?`.${r.referralAppPlatform}`:""}`,i=`${r.referralView}${r.referralMode?`.${r.referralMode}`:""}${r.referralPlaybackSessionId?`.${r.referralPlaybackSessionId}`:""}`;return{hostReferrerApp:r.referralApp,hostReferrerAppPlatform:r.referralAppPlatform,hostReferrerView:r.referralView,hostReferrerMode:r.referralMode,hostReferrerPlaybackSessionId:r.referralPlaybackSessionId,hostReferrer:n,hostReferrerScenario:i}}catch{return}}function yt(e){return t=>{"Playing"===t?e.raiseIsPlaying():"Paused"===t&&e.raiseIsPaused()}}function bt(e,t){if(e.current?.dispose(),t.current){const e=t.current;for(;e.firstChild&&e.lastChild;)e.removeChild(e.lastChild)}}async function gt(e,t,r,n,i,o,a,s){let l=arguments.length>8&&void 0!==arguments[8]&&arguments[8],d=arguments.length>9?arguments[9]:void 0,u=arguments.length>10?arguments[10]:void 0,f=arguments.length>11?arguments[11]:void 0,p=arguments.length>12?arguments[12]:void 0,h=arguments.length>13?arguments[13]:void 0,m=arguments.length>14?arguments[14]:void 0,v=arguments.length>15?arguments[15]:void 0;const y=(0,mt.AL)(i.settingsProvider),b=y?v?.hostInformation?.hostApp??ht(r.AppID??"").hostApp:ht(r.AppID??"").hostApp,g=y?v?.hostInformation?.hostPlatform??ht(r.AppID??"").hostPlatform:ht(r.AppID??"").hostPlatform,_=await async function(e,t){return{tokenRetriever:{beginSilentSignOn:()=>{},getTokenAsync:async(r,n)=>{let i=[];try{t?.markSubActivityStart(w.n.OnePlayerTokenRetrieval);const r=S.P.SharePoint;i=(0,P.w)((0,I.$)(n),r);const o=await e.TokenProvider.getToken(i,{request:null});return t?.markSubActivityEnd(w.n.OnePlayerTokenRetrieval),o.token}catch(o){throw t?.markSubActivityEnd(w.n.OnePlayerTokenRetrieval,{[c.QK.OnePlayerTokenRetrieval]:"failed",tokenType:r}),o}}}}}(r,u),k=i.additionalTelemetryProperties.unfurlCorrelationId,A=i.additionalTelemetryProperties.variableTimeOrigin,O=(U=i.settingsProvider,(0,mt.q_)(U)?"P-X-1112345-4":(0,mt.pG)(U)?"P-X-1112345-2":(0,mt.uc)(U)?"P-X-1112345-1":"P-X-1112345-3");var U;const C=i.telemetryConfig?.scenarioStartTime,R=d&&d.PersistedProperties?.getPersistedProperties?.().hostScenarioStartTime,M=d&&d.PersistedProperties?.getPersistedProperties?.().codeVersion,x=function(e,t,r,n,i){if(t)return performance.now();if(e){const e=n??i;if(void 0!==e){const t=Date.now()-e;return performance.now()-t}}return r??performance.now()}((0,mt.xn)(i.settingsProvider),l,u?.startTime,"number"===typeof R?R:void 0,C),D=m?function(e,t){const r=e.searchParams.getAll("referrer"),n=e.searchParams.getAll("referrerScenario");if(0===r.length)return vt(e);if(1===r.length&&r[r.length-1].split(".")[0]===t)return vt(e);let i=r[r.length-1],o=n[n.length-1];i.split(".")[0]===t&&r.length>1&&(i=r[r.length-2],n.length>1&&(o=n[n.length-2]));const a=i.split(".")[0],s=i.split(".")[1];let c,l,d;return o&&(c=o.split(".")[0],l=o.split(".")[1],d=o.split(".")[2]),{hostReferrerApp:a,hostReferrerAppPlatform:s,hostReferrerView:c,hostReferrerMode:l,hostReferrerPlaybackSessionId:d,hostReferrer:i,hostReferrerScenario:o}}(m,b):void 0,N=y?v?.hostInformation?.hostView??p:p,V=y?v?.hostInformation?.playSegmentsOptions:void 0,L=!!(0,mt.oT)(i.settingsProvider)&&!0!==v?.disableFullscreen,F=Boolean(n.hideVideoMetadata);u?.addAdditionalProps({unfurlCorrelationId:k,isVideoHydratedInDetachedMode:l,t0TimeOrigin:A,t0:x,telemetryConfigScenarioStartTime:C,loggerScenarioStartTime:R,usedOnePlayerIframeConfigId:O,playerReloads:f.current}),f.current+=1;const j={videoId:{videoUrl:(0,mt.pG)(i.settingsProvider)?t:t.replace("embed.aspx","streamembed.aspx")},containerDiv:e,allowFullscreen:L,onError:(e,t)=>a(e,t,u),hostApp:b,hostPlatform:g,hostComponent:Ue.I,hostView:N??"",theme:o,hostSessionId:i.telemetryConfig?.hostSessionId||"",hostCorrelationId:k||"",hostMode:y?v?.hostInformation?.hostMode:void 0,hostEnvironment:"Prod",hostTimestamps:{t0:{timestamp:x,timeOrigin:A}},hostVersion:"string"===typeof M?M:"",hostReferrerApp:D?.hostReferrerApp,hostReferrerAppPlatform:D?.hostReferrerAppPlatform,hostReferrerView:D?.hostReferrerView,hostReferrerMode:D?.hostReferrerMode,hostReferrerPlaybackSessionId:D?.hostReferrerPlaybackSessionId,hostReferrer:D?.hostReferrer,hostReferrerScenario:D?.hostReferrerScenario,hideVideoMetadata:F,overrideLanguage:s,enableVideoPlayerTabstopDuringPlayback:!1,flightsUsed:[O],startTimeInSeconds:h,playSegmentsOptions:V};u?.markSubActivityEnd(w.n.TimeInPlaybackLoopComponent);const G=function(e,t){return(0,mt.pG)(t)?function(e){var t="beginSilentSignOn";try{return e.tokenRetriever.beginSilentSignOn(),t="iframeUnknown",new Ee(e)}catch(r){throw T(r,E)?r:E.createGenericError("fatal","loadIframe",t,r)}}(e):function(e){var t="beginSilentSignOn";try{return e.tokenRetriever.beginSilentSignOn(),t="iframeUnknown",new Oe(e)}catch(r){throw T(r,E)?r:E.createGenericError("fatal","loadIframe",t,r)}}(e)}(_,i.settingsProvider);return await((0,mt.RC)(i.settingsProvider)?function(e,t,r,n){const i="autoplayOn"===n,o="autoplayOff"===n,a="thumbnailHyperlinkOnly"===n;if("deferredLoad"===n)return(0,mt.pG)(r)?e.createPlaybackSession(!1,t):e.createDeferredPlaybackSession(t);return((0,mt.q_)(r)||(0,mt.pG)(r))&&(i||o)?e.createPlaybackSession(i||!1,t):(0,mt.uc)(r)||a?e.createThumbnailHyperlinkOnlySession(t):e.createDeferredPlaybackSession(t)}(G,j,i.settingsProvider,v?.loadMode):function(e,t,r){return(0,mt.q_)(r)||(0,mt.pG)(r)?e.createPlaybackSession(!1,t):(0,mt.uc)(r)?e.createThumbnailHyperlinkOnlySession(t):e.createDeferredPlaybackSession(t)}(G,j,i.settingsProvider))}class wt{constructor(e){this.isPlayerReady=new z(!1),this.playState=new z("Paused"),this.lastUserAction=new z({action:"Pause"}),this.currentTimeInSeconds=new z(void 0),this.muted=new z(void 0),this.volume=new z(void 0),this.mediaDurationInSeconds=new z(void 0),this.playbackSpeed=new z(void 0),this.title=new z(void 0),this.itemUrl=new z(void 0),this.playerBeforeUnload=new z(!1),this.playState.subscribe(t=>{"Playing"===t&&e.loadPlayer(!0).catch(e=>{throw e})})}cleanUp(){this.playState.unsubscribeAll()}}const _t={dark:"dark",light:"light",default:"light"};function kt(e){if(e.current){return getComputedStyle(e.current).getPropertyValue(k.Fj)||void 0}}var St=r(53696),Pt=r(93421);const It=e=>{let{embeddableUrl:t,playbackStateSetter:r,parentRef:h,setViewRootElement:S,endRenderingActivity:P,onKeyDownHandler:I,setIsPlayerReady:T,setError:A,updateTitle:E,strings:O,hostView:U,startTimeInSeconds:C,playerLoads:R,videoUrl:M}=e;const x=(0,d.U)(),D=(0,u.i)(),N=(0,f.I)(),V=(0,p._)(),L=(0,Pt.W)(),F=i.useRef(null),j=i.useRef(!1),G=i.useRef(null),W=i.useRef(null),B=i.useRef(null),H=i.useRef(void 0),[z,K]=i.useState(!1),Q=(0,o.b)(),$=(0,mt.zG)(D.settingsProvider),J=function(e,t){const r=(0,o.b)(),[n,a]=i.useState();return i.useEffect(()=>{const i=_t[r?.themeName||"light"],o="high-contrast"===r?.themeName?"teams-contrast":void 0,s=t&&void 0!==o;(e.current&&n?.name!==i||s)&&a({name:i,primaryColor:kt(e),fluentTheme:o})},[r,e,n?.name,t]),n}(F,$),X=(0,a.Ym)(),q=i.useMemo(m,[]),Y=!(0,mt.pG)(D.settingsProvider)&&!(0,mt.q_)(D.settingsProvider)&&!(0,mt.uc)(D.settingsProvider),Z=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const[r,n]=i.useState(!1),o=i.useRef(),a=(0,d.U)();return i.useEffect(()=>{if(!t)return;const e=new IntersectionObserver(e=>{n(e[0].isIntersecting)});return o.current=e,()=>e.disconnect()},[t]),i.useEffect(()=>{if(!t)return;const r=e.current;if(r){if(o.current){const e=o.current;return e.observe(r),()=>e.unobserve(r)}return()=>{}}(0,s.H)(void 0,a,"useVisibilityObserver",c.QK.MissingVisibilityElement)},[e,a,t]),{observer:o,isVisible:r}}(h,Y),ee=function(e){const[t,r]=i.useState(null),n=i.useRef(null),[o,a]=i.useState(void 0);i.useEffect(()=>{r(e.current)},[e]);const s=()=>{n.current?.disconnect()};return i.useEffect(()=>{if(t&&(s(),a(()=>t.isConnected),!t.isConnected))return n.current=new MutationObserver(()=>{a(()=>t.isConnected),t.isConnected&&s()}),n.current.observe(document.body,{subtree:!0,childList:!0}),()=>{s()}},[t]),o}(F),te=(0,mt.d5)(D.settingsProvider)&&ee,re=i.useCallback((e,t)=>{t&&e&&(T?.(!0),q.setIsReady(t,{playerInteractiveTimestamp:e},D.additionalTelemetryProperties.variableTimeOrigin))},[D,q,T]),ne=i.useCallback(e=>{if((e=>v.includes(e.key))(e)){e.preventDefault(),e.stopPropagation();const t=B.current;if(t&&g(t))return void(H.current?window.open(H.current,"_blank","noopener,noreferrer"):(W.current={...W.current,itemUrlUnsubscribe:t.playbackApi.itemUrl.subscribe(e=>{e&&(H.current=e,window.open(e,"_blank","noopener,noreferrer"))})},t.simulateClick()));"Playing"===r.getPlaybackState()?r.pause():r.play()}else(e=>y.includes(e.key))(e)||I(e)},[r,I]),ie=i.useCallback(()=>{(0,k.hS)(h.current,(0,mt.vd)(D.settingsProvider))},[h,D]),oe=i.useCallback(()=>{(0,k.Ig)(h.current,(0,mt.vd)(D.settingsProvider))},[h,D]),ae=i.useCallback((e,t)=>{r.initialize(e),W.current={...W.current,playStateUnsubscribe:e.playState.subscribe(yt(r)),titleUnsubscribe:e.title.subscribe(E),playerBeforeUnloadUnsubscribe:e.playerBeforeUnload.subscribe(t)}},[r,E]);return i.useEffect(()=>{if(!B.current)return;const e=B.current;b(e)&&Z.isVisible&&h.current&&(Z.observer.current?.unobserve(h.current),e.warmData().catch(e=>{(0,s.H)(e,x,"warmData",c.QK.OnePlayerWarmup)}))},[Z,x,h,z]),i.useEffect(()=>{const e=(e,t,r)=>{T?.(!0);const{level:n,isExpected:o,scenario:a,knownError:s,playbackSessionId:d}=t;"iframeForciblyUnloaded"===s?(B.current=null,e(),r?.markSubActivityStart(w.n.SetupIframeAfterIframeForciblyUnloaded),i(!1,r),r?.markSubActivityEnd(w.n.SetupIframeAfterIframeForciblyUnloaded)):(P(l.G.Embedded),r?.setResult(!1,{errorCode:c.QK.IframePlayerSetup,level:n,scenario:a,isExpected:o,playbackSessionId:d},s),"loadIframe"===a&&A&&A(new Error("loadIframe failed")))},n=e=>{if(e){const e=St.m.start(w.z.SetupIframeAfterBeforeUnload,x);D.activities.set(w.z.SetupIframeAfterBeforeUnload,e),bt(B,F),i(!1,e)}};function i(){let o=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=arguments.length>1?arguments[1]:void 0;if(void 0!==te){if((0,mt.d5)(D.settingsProvider)){if(null===F.current||void 0===J||!te)return void(te||(j.current=!0,a?.markSubActivityStart(w.n.VideoHydratedInDetachedMode)));j.current&&(j.current=!1,a?.markSubActivityEnd(w.n.VideoHydratedInDetachedMode))}else{if(null===F.current||void 0===J)return;if(!F.current.isConnected)return void function(e,t,r){r?.markSubActivityStart(w.n.VideoHydratedInDetachedMode);const n=document.createElement("iframe");n.height="0px",n.width="0px",n.style.visibility="hidden";const i=()=>{e.removeChild(n),r?.markSubActivityEnd(w.n.VideoHydratedInDetachedMode),t(!0,r),document.removeEventListener("load",i),document.removeEventListener("error",i)};n.addEventListener("load",i),n.addEventListener("error",i),e.appendChild(n)}(F.current,i,a)}if(R.current>0){const e=St.m.start(w.z.VideoReloadFromUnfurl,x);D.activities.set(w.z.VideoReloadFromUnfurl,e)}gt(F.current,t,V,L,D,J,e,X,o,x,R.current>0?_(D,w.z.VideoReloadFromUnfurl):a,R,U,C,M,N).then(e=>{if(P(l.G.Embedded),B.current=e,K(!0),S(G.current),W.current={playerStatsPlayerInteractiveTimestampUnsubscribe:e.playerStats.playerInteractiveTimestamp.subscribe(e=>{const t=R.current>1?_(D,w.z.VideoReloadFromUnfurl):a;re(e,t)})},b(e)){const t=new wt(e);r.initialize(t),W.current={...W.current,playbackApiUnsubscribe:e.playbackApi.subscribe(e=>{e&&(t.cleanUp(),ae(e,n))})}}else g(e)||ae(e.playbackApi,n)}).catch(e=>{T?.(!0),P(l.G.Embedded);const t=(e=>{const t=e=>"object"===typeof e&&null!==e;let r=e;if(t(e)&&"string"!==typeof e.message){const n=e.originalError;"string"===typeof n?r={...e,message:n}:t(n)&&"string"===typeof n.message&&(r={...e,message:n.message})}return r})(e);R.current>1&&_(D,w.z.VideoReloadFromUnfurl)?.setResult(!1,{errorCode:c.QK.IframePlayerSetup},t),a?.setResult(!1,{errorCode:c.QK.IframePlayerSetup},t),(0,s.H)(t,x,"setupIframePlayer",c.QK.IframePlayerSetup)})}}return i(!1,_(D,w.z.VideoLoadFromUnfurl)),()=>{var e;W.current&&(e=W.current,Object.values(e).forEach(e=>e())),bt(B,F)}},[te,t,V,x,D,r,P,J,S,re,q,ne,X,ae,T,A,U,C,R,M,N,L]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{ref:G,role:"link",tabIndex:0,onFocus:ie,onBlur:oe,onKeyDown:ne,"aria-label":O.onePlayerIframeHostContainerAriaLabel}),(0,n.jsx)("div",{ref:F,className:(0,k.qo)(Q?.theme.palette.themePrimary),"aria-label":O.onePlayerIframeHostContainerAriaLabel})]})}}}]);
//# sourceMappingURL=StreamEmbeddedRenderer.35694578.chunk.js.map