"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[40362],{3756:(e,t,o)=>{o.d(t,{A:()=>a});var n=o(75992);class a extends n.r{constructor(e){super(a.actionType),this.entityId=e}}a.actionType="AUGLOOP_FETCH_IMG_RECS"},3798:(e,t,o)=>{o.r(t),o.d(t,{IntelligenceModule:()=>h});var n,a=o(3756),i=o(48545),r=o(30263),s=o(93940),g=o(38752);!function(e){e.augLoopSubstrateRecommendationsFlight="substratereco"}(n||(n={}));var c=o(52071),u=o(41089),T=o(83324),p=o(18751),l=o(74844),m=o(55491),d=o.n(m);class h{get name(){return"IntelligenceModule"}async initialize(){this.loggers.traceLogger.logTrace(507897348,l.k.Verbose,"Initialize Augmentation Loop Runtime component");try{const e=await this.serviceProviders.augLoop();await e.initialize(this.onAnnotationResult,g.B.culture,n.augLoopSubstrateRecommendationsFlight),this.loggers.traceLogger.logTrace(507897347,l.k.Verbose,"Initialize Augmentation Loop Runtime component - Success")}catch(e){throw this.loggers.traceLogger.logTrace(507897346,l.k.Warning,`Initialize Augmentation Loop Runtime component - Failure [Error=${e}`),e}}async fetchImageRecommendationsAsync(e,t){this.loggers.traceLogger.logTrace(507897345,l.k.Verbose,`Fetch Image Recommendations [id=${e}]`),this.dispatcher.dispatchAction(new a.A(e));try{const o=await this.serviceProviders.augLoop();await o.getImageRecommendations(t,e),this.loggers.traceLogger.logTrace(507897344,l.k.Verbose,`Fetch Image Recommendations - Success [id=${e}]`)}catch(o){throw this.loggers.traceLogger.logTrace(507897315,l.k.Warning,`Fetch Image Recommendations - Failure [id=${e}][Error=${o}]`),this.dispatcher.dispatchAction(new i.B(e,t,null,o,"")),o}}async fetchFileRecommendationsAsync(e){this.entityIdToLogicalIdMap[e.id]=e.logicalId??"",this.loggers.traceLogger.logTrace(507897314,l.k.Verbose,`Get File Recommendations [taskId=${e.id}]`);try{const t=await this.serviceProviders.augLoop();await t.getFileRecommendations(e),this.loggers.traceLogger.logTrace(507897313,l.k.Verbose,`Get File Recommendations - Success [taskId=${e.id}]`)}catch(t){throw this.loggers.traceLogger.logTrace(507897312,l.k.Warning,`Get File Recommendations - Failure [taskId=${e.id}][Error=${t}]`),t}}async queueTextToImageTrace(e,t){this.loggers.traceLogger.logTrace(507897311,l.k.Verbose,`Queue Text To Image Trace [imageId=${e.id}]`);return(await this.serviceProviders.augLoop()).queueTextToImageTrace(e.id,e.cv,t,e.category)}async sendPendingTextToImageTraces(){this.loggers.traceLogger.logTrace(507897310,l.k.Verbose,"Send Pending Text To Image Trace");return(await this.serviceProviders.augLoop()).sendPendingTextToImageTraces()}async sendFileRecommendationFeedback(e,t,o,n,a,i){this.loggers.traceLogger.logTrace(507897309,l.k.Verbose,"Send File Recommendation Feedback");return(await this.serviceProviders.augLoop()).sendFileRecommendationFeedback(e,t,o,n,a,i)}onTextToImageAnnotationResult(e,t,o){const n=[];if(null==t.id){const t="TextToImageAnnotation operation does not have an id";return this.loggers.traceLogger.logTrace(507897307,l.k.Error,t),void this.dispatcher.dispatchAction(new i.B(o,e.content,null,t,""))}const a=t.id;d()(t.images,(e,o)=>{n.push({id:e.imageId,score:e.score,fullUrl:t.baseUrl+e.imageId,thumbnailUrl:t.baseUrl+e.thumbnailId,cv:a,category:e.category,altText:e.altText})}),this.loggers.traceLogger.logTrace(507897306,l.k.Verbose,`Received TextToImageAnnotations [cv=${a}]`),this.dispatcher.dispatchAction(new r.T(o,e.content,n))}constructor(e,t,o){this.dispatcher=e,this.serviceProviders=t,this.loggers=o,this.entityIdToLogicalIdMap={},this.onAnnotationResult=(e,t)=>{const o=t?.items;d()(o,t=>{if(t.body&&c.h.getTypeNameFor(t.body)===T.to.getTypeName()){if(null==e?.items[0]?.body||c.h.getTypeNameFor(e.items[0].body)!==p.KG.getTypeName())return void this.loggers.traceLogger.logTrace(507897308,l.k.Error,"Request operation does not match TextToImage result operation");const o=e.items[0].id,n=e.items[0].body,a=t.body;this.onTextToImageAnnotationResult(n,a,o)}if(t.body&&c.h.getTypeNameFor(t.body)===u.g.getTypeName()){const e=t.body,o=t.parentPath[t.parentPath.length-1],n=this.entityIdToLogicalIdMap[o]??"",a=e.id??"";this.loggers.usageLogger.logData(this.name,"Received FileRecommendations",{entityId:o,logicalId:n,cv:a,recommendationsCount:String(e.fileRecommendations.length)}),this.dispatcher.dispatchAction(new s.v(o,a,n,e))}})}}}},18751:(e,t,o)=>{o.d(t,{KG:()=>a});var n=o(52071),a=function(){function e(t){n.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_TextToImage_TextToImageSignal"},e.getBaseTypes=function(){return["AugLoop_TextToSuggestions_TextToSuggestionSignal","AugLoop_Signals_Signal"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();(function(){function e(t){n.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_TextToImage_TextToGettyImageSignal"},e.getBaseTypes=function(){return["AugLoop_Signals_Signal"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}})(),function(){function e(t){n.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_TextToImage_TextToMultiTierImageSignal"},e.getBaseTypes=function(){return["AugLoop_Signals_Signal"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}()},30263:(e,t,o)=>{o.d(t,{T:()=>a});var n=o(75992);class a extends n.r{constructor(e,t,o){super(a.actionType),this.entityId=e,this.query=t,this.results=o}}a.actionType="AUGLOOP_FETCH_IMG_RECS_SUCCEEDED"},41089:(e,t,o)=>{o.d(t,{g:()=>a});var n=o(52071),a=function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_PlannerFileRecommendations_PlannerTaskRecommendations"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()},48545:(e,t,o)=>{o.d(t,{B:()=>a});var n=o(32512);class a extends n.v{constructor(e,t,o,n,i){super(a.actionType,o,n,i),this.entityId=e,this.query=t}}a.actionType="AUGLOOP_FETCH_IMG_RECS_FAILED"},52071:(e,t,o)=>{o.d(t,{h:()=>n});class n{constructor(e){n.assign(n,this,e)}static getTypeName(){return"AugLoop_Core_SchemaObject"}static getBaseTypes(){return[]}static getTypeNameFor(e){return e&&e.H_?e.H_.T_:void 0}static getBaseTypesFor(e){return e&&e.H_&&e.H_.B_&&Array.isArray(e.H_.B_)?e.H_.B_:[]}static getAllTypesFor(e){const t=n.getTypeNameFor(e);return t?[t,...n.getBaseTypesFor(e)]:[]}static matchesTypesFor(e,t){if(!Array.isArray(t)||0===t.length)return!0;const o=n.getTypeNameFor(e),a=n.getBaseTypesFor(e);for(const n of t){if(n===o)return!0;if(a.indexOf(n)>=0)return!0}return!1}static assign(e,t,o){if(o)for(const n of Object.keys(o))t[n]=o[n];return t.H_=e.H_,t}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},83324:(e,t,o)=>{o.d(t,{to:()=>a});var n=o(52071),a=function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_TextToImage_TextToImageAnnotation"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();(function(){function e(t){n.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_TextToImage_TextToGettyImageAnnotation"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}})(),function(){function e(t){n.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_TextToImage_TextToMultiTierImageAnnotation"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}()},93940:(e,t,o)=>{o.d(t,{v:()=>a});var n=o(75992);class a extends n.r{loggingData(){return{cv:this.cv,logicalId:this.logicalId,traceId:this.fileSuggestions.fileResultReference.referenceId}}constructor(e,t,o,n){super(a.actionType),this.entityId=e,this.cv=t,this.logicalId=o,this.fileSuggestions=n}}a.actionType="AUGLOOP_FETCH_FILE_SUG_SUCCEEDED"}}]);
//# sourceMappingURL=intelligencemodule.ceabb14d.chunk.js.map