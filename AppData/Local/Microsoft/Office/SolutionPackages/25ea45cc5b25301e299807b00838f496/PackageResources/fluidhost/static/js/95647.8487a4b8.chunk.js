"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[95647],{95647:(t,e,o)=>{o.r(e),o.d(e,{CdnCodeLoaderFactory:()=>y,LoopRegistrationId:()=>n.J});var n=o(38314);function r(t){return new Promise(e=>setTimeout(()=>e(),t))}function s(t,e,o){return i(t,[],e,o)}function i(t,e,o,n){let s;const a=[t(e.length).then(t=>(s=t,!1))];return n&&n.timeoutMs>0&&a.push(r(n.timeoutMs).then(()=>!0)),Promise.race(a).then(a=>(a&&(s=n?.onTimeout()),!o||!o.filter(s)||e.length>=o.maxRetries?{result:s,tries:e}:r(o.backoffFn(e.length)).then(()=>(e.push(s),i(t,e,o,n)))))}async function a(t,e,o){return new Promise((n,r)=>{const s=t.document,i=s.createElement("script"),a=o?.trustedTypesPolicy?.createScriptURL(e,{allowedScriptOrigins:o.allowedOrigins})??e;i.src=a,i.async=!1,i.charset="utf-8",i.crossOrigin="anonymous",i.onload=n,i.onerror=()=>r(new Error(`Failed to download the script at url: ${e}, isUserOnline: ${t.navigator.onLine}`)),s.head.appendChild(i)})}var c,u=new Uint8Array(16);function d(){if(!c&&!(c="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return c(u)}const l=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const f=function(t){return"string"===typeof t&&l.test(t)};for(var h=[],p=0;p<256;++p)h.push((p+256).toString(16).substr(1));const m=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=(h[t[e+0]]+h[t[e+1]]+h[t[e+2]]+h[t[e+3]]+"-"+h[t[e+4]]+h[t[e+5]]+"-"+h[t[e+6]]+h[t[e+7]]+"-"+h[t[e+8]]+h[t[e+9]]+"-"+h[t[e+10]]+h[t[e+11]]+h[t[e+12]]+h[t[e+13]]+h[t[e+14]]+h[t[e+15]]).toLowerCase();if(!f(o))throw TypeError("Stringified UUID is invalid");return o};const w=function(t,e,o){var n=(t=t||{}).random||(t.rng||d)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,e){o=o||0;for(var r=0;r<16;++r)e[o+r]=n[r];return e}return m(n)};class g{constructor(t){this.audience=t.audience,this.windowContext=t.windowContext,this.trustedTypesPolicy=t.trustedTypesPolicy,this.settingsProvider=t.settingsProvider}canLoad(t){return t.packageName===n.J}async load(t){if(!this.canLoad(t))throw new Error("Incompatible loop code details.");const e=await this.determineCdnUrl(),o=this.trustedTypesPolicy&&{trustedTypesPolicy:await this.trustedTypesPolicy,allowedOrigins:["https://cdn.forms.office.net","https://forms.office.com","https://forms.static.microsoft"]};await((t,e,o)=>{let n=3;return function r(){return a(t,e,o).catch(()=>(n-=1,0===n?a(t,e,o):r()))}()})(this.windowContext,e,o);const r=this.windowContext[n.J];if(!r)throw new Error("Could not fetch loop module from the window object.");return{module:r,details:t}}async determineCdnUrl(){const t=this.getTargetEnvironment();let e=`https://cdn.forms.office.net/forms/loop/formsCodeLoaderDetails-${t}.json?r=${w()}`;this.getPollNewCDNEnabled()&&(e=`https://forms.office.com/cdn/loop/formsCodeLoaderDetails-static-${t}.json?r=${w()}`);const o=await function(t,e,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return s(()=>{const o=performance.now();return fetch(t,e).then(t=>{const e=t;return e.durationMs=Math.round(performance.now()-o),e}).catch(t=>({status:window.navigator.onLine?710:709,ok:!1,durationMs:Math.round(performance.now()-o)}))},o,{timeoutMs:n,onTimeout:()=>({status:707,ok:!1,durationMs:n})})}(e,{method:"GET"},{maxRetries:3,filter:(r=[500,599],t=>t&&r.includes(t.status)),backoffFn:(n=500,t=>n)});var n,r;if(!o.result.ok||200!==o.result.status)throw new Error(`Failed to fetch ${e}`);return(await o.result.json()).codeLoaderFile}getTargetEnvironment(){switch(this.audience){case"Automation":case"SyntheticTraffic":case"Local":case"Staging":return"staging";case"Dogfood":return"df";case"Microsoft":return"msft";default:return"prod"}}getPollNewCDNEnabled(){return this.settingsProvider?.getSetting("loopPoll.isloopPollNewCDNEnabled",!1,"FluidExperiences")??!1}}const y={instantiateLoopCodeLoader:t=>Promise.resolve(new g(t))}}}]);
//# sourceMappingURL=95647.8487a4b8.chunk.js.map