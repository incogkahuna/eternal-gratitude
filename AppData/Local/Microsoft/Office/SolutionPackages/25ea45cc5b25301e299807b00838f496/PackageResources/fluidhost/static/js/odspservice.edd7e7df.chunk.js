"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[15596],{10832:(e,t,i)=>{i.r(t),i.d(t,{OdspService:()=>m});var r=i(95783),n=i(45078),s=i(23918),o=i(26796),a=i(94266),d=i(33411),l=i.n(d),h=i(98502),u=i(91246),p=i(61739),c=i(89962);class m extends a.R{async getDriveItemAsync(e){const t=`${this.hostDomain}/${this.v1UrlToken}/drives/${e.driveId}/items/${e.itemId}`,i=await this.ajaxClient.executeRequest(t,{telemetryConfig:this.getDefaultRequestTelemetryConfig("getDriveItem"),headers:new Headers(this.appendSharepointAuthenticationChallengeHeaders({}))});try{const e=await i.clone().json();if(null==e)throw new Error("No drive item returned");return s.Y.builder.fromGraphDriveItemResource(e).build()}catch(r){throw h.g.generateAjaxClientError(i,r)}}async getDriveItemThumbnailAsync(e){const t=`${this.hostDomain}/${this.v1UrlToken}/groups/${e.groupId}/drive/root:/${e.itemPath}:/thumbnails/0/large/url`,i=await this.ajaxClient.executeRequest(t,{telemetryConfig:this.getDefaultRequestTelemetryConfig("getDriveItemThumbnail")});try{const e=await i.clone().json(),t=e?e.value:null;if(!t)throw new Error("No item thumbnail url returned");return t}catch(r){throw h.g.generateAjaxClientError(i,r)}}async getDocumentsInGroupFolderAsync(e){const t=e.folderId?`/items/${e.folderId}/children`:"/root/children",i=e.skipToken||`${this.hostDomain}/groups/${e.groupId}/drive${t}`,r=await this.ajaxClient.executeRequest(i,{telemetryConfig:this.getDefaultRequestTelemetryConfig("getDocumentsInGroupFolderAsync"),headers:new Headers(this.appendSharepointAuthenticationChallengeHeaders({}))});try{const e=await r.clone().json();if(null==e)throw new Error("No group documents returned");const t=e.value;return{data:l()(t,e=>s.Y.builder.fromGraphDriveItemResource(e).build()),skipToken:(0,p.n0)(e[this.skipTokenKey])}}catch(n){throw h.g.generateAjaxClientError(r,n)}}async createUploadSessionAsync(e){const t=`${this.hostDomain}/${this.v1UrlToken}/groups('${e.groupId}')/drive/root:/${encodeURIComponent(e.itemPath)}:/createUploadSession`,i=await this.ajaxClient.executeRequest(t,{method:r.PJ.Post,body:JSON.stringify({item:{"@microsoft.graph.conflictBehavior":"rename"}}),headers:{[n.Lr.ContentType]:n.Mq.Json},telemetryConfig:this.getDefaultRequestTelemetryConfig("createUploadSessionAsync")});try{const t=await i.clone().json();if(null==t)throw new Error("No response returned");return e.session=e.session.setProperty("uploadUrl",t.uploadUrl),e.session=e.session.setProperty("bytesSent",0),e.session=e.session.setProperty("expirationDateTime",t.expirationDateTime),e.session}catch(s){throw h.g.generateAjaxClientError(i,s)}}async uploadBytesToSessionAsync(e){const{b64Data:t,uploadSession:i,finalByteIndex:s,initialByteIndex:a,totalSize:d}=e,l=i.uploadUrl,p=(0,c.FI)(t),m=await this.ajaxClient.executeRequest(l,{method:r.PJ.Put,headers:{[n.Lr.ContentRange]:(0,c.X7)(a,s,d),[n.Lr.ContentType]:n.Mq.OctetStream},body:p,telemetryConfig:this.getDefaultRequestTelemetryConfig("uploadBytesToSessionAsync")});try{const e=await m.clone().json();if(null==e)throw new Error("No response returned");const t=e.id??null,r=e.name??null,n=e.size??null,a=e.expirationDateTime??i.expirationDateTime;return o.z.builder.withPropertyBag({bytesSent:s+1,expirationDateTime:a,groupId:i.groupId,id:i.id??u.o.generate(),itemId:t&&t!==i.itemId?t:i.itemId,itemName:r&&r!==i.itemName?r:i.itemName??"",itemSize:n&&n!==i.itemSize?n:i.itemSize??0,lastUploadRequestSucceeded:!0,uploadUrl:i.uploadUrl,name:i.name,webUrl:e.webUrl,nextExpectedRanges:e.nextExpectedRanges}).build()}catch(f){throw h.g.generateAjaxClientError(m,f)}}async cancelUploadSessionAsync(e){const{session:t}=e,i=t.uploadUrl;await this.ajaxClient.executeRequest(i,{method:r.PJ.Delete,telemetryConfig:this.getDefaultRequestTelemetryConfig("cancelUploadSessionAsync")})}async shareDriveItemAsync(e){const t=`${this.hostDomain}/${this.v1UrlToken}/drives/${e.driveId}/items/${e.itemId}/invite`,i=[];for(const r of e.userIds){const e={objectId:r};i.push(e)}const s={recipients:i,requireSignIn:!0,sendInvitation:!1,roles:["write"]};await this.ajaxClient.executeRequest(t,{method:r.PJ.Post,telemetryConfig:this.getDefaultRequestTelemetryConfig("shareDriveItemAsync"),body:JSON.stringify(s),headers:{[n.Lr.ContentType]:n.Mq.Json}})}constructor(e,t){super("OdspService",e,t)}}},14983:(e,t,i)=>{var r;i.d(t,{Er:()=>r,LP:()=>n,ig:()=>s}),function(e){e.Word="Word",e.Excel="Excel",e.PowerPoint="PowerPoint",e.OneNote="OneNote",e.Project="Project",e.Visio="Visio",e.Pdf="Pdf",e.Loop="Loop",e.Other="Other"}(r||(r={}));r.OneNote,r.Project,r.Visio;var n,s=["jpg","jpeg","png","gif","bmp"];!function(e){e.Stream="stream-video",e.Youtube="yt-video",e.Vimeo="vimeo-video",e.DailyMotion="dm-video",e.Facebook="fb-video"}(n||(n={}))},23918:(e,t,i)=>{i.d(t,{Y:()=>g});var r=i(91675),n=i(51171),s=i(57718),o=i(86178),a=i.n(o),d=i(14983),l=function(){function e(){this.id=s.cM(),this.name="",this.fileType=d.Er.Other,this.url="",this.modifiedDate=a()(),this.childCount=-1,this.itemPath="/drive/root:"}return e.prototype.build=function(){return new g(this)},e.prototype.withPropertyBag=function(e){return this.id=e.id||this.id,this.name=e.name||this.name,this.fileType=e.fileType||this.fileType,this.url=e.url||this.url,this.modifiedDate=e.modifiedDate||this.modifiedDate,this.childCount=void 0!==e.childCount?e.childCount:this.childCount,this.itemPath=e.itemPath||this.itemPath,this},e.prototype.withDefaultValues=function(){return this.withPropertyBag({id:"driveItemId",name:"Item1",fileType:d.Er.Other,url:"driveItemUrl",modifiedDate:a()(),itemPath:"/drive/root:",childCount:-1})},e.prototype.fromGraphDriveItemResource=function(e){return this.withPropertyBag({id:e.id,name:e.name,fileType:e.folder?d.Er.Other:e.package?g.GetType(e.package.type):g.GetFileType(e.name),url:e.webUrl,modifiedDate:a()(e.lastModifiedDateTime),childCount:e.folder?e.folder.childCount:-1,itemPath:e.parentReference.path})},e}(),h=i(98990),u=i.n(h),p=i(55491),c=i.n(p),m=i(54320),f=i.n(m),g=function(){function e(e){if(f()(e.id))throw new n.L("id");if(f()(e.name))throw new n.L("name");if(f()(e.url))throw new n.L("url");this.id=e.id,this.name=e.name,this.url=e.url,this.fileType=e.fileType,this.description=e.description,this.modifiedDate=e.modifiedDate,this.childCount=e.childCount,this.itemPath=e.itemPath}return Object.defineProperty(e,"builder",{get:function(){return new l},enumerable:!1,configurable:!0}),e.GetType=function(e){switch(e.toLowerCase()){case"excel":return d.Er.Excel;case"onenote":return d.Er.OneNote;case"pdf":return d.Er.Pdf;case"powerpoint":return d.Er.PowerPoint;case"project":return d.Er.Project;case"visio":return d.Er.Visio;case"word":return d.Er.Word;case"loop":return d.Er.Loop;default:return d.Er.Other}},e.GetFileType=function(t){var i=d.Er.Other,n=t.slice(t.lastIndexOf(".")+1);return c()(r.t,function(t,r){u()(t,function(e){return e.toLowerCase()===n.toLowerCase()})&&(i=e.GetType(r))}),i},e}()},26796:(e,t,i)=>{i.d(t,{z:()=>s});var r=i(57718),n=function(){function e(){this.bytesSent=0,this.groupId="",this.id=r.cM(),this.itemName="",this.itemSize=0,this.itemId="",this.lastUploadRequestSucceeded=!1,this.uploadUrl="",this.name="",this.webUrl="",this.nextExpectedRanges=void 0}return e.prototype.build=function(){return new s(this)},e.prototype.withPropertyBag=function(e){return this.bytesSent=e.bytesSent||this.bytesSent,this.expirationDateTime=e.expirationDateTime||this.expirationDateTime,this.groupId=e.groupId||this.groupId,this.id=e.id||this.id,this.itemId=e.itemId||this.itemId,this.itemName=e.itemName||this.itemName,this.itemSize=e.itemSize||this.itemSize,this.lastUploadRequestSucceeded=null!=e.lastUploadRequestSucceeded?e.lastUploadRequestSucceeded:this.lastUploadRequestSucceeded,this.uploadUrl=e.uploadUrl||this.uploadUrl,this.name=e.name||this.name,this.webUrl=e.webUrl||this.webUrl,this.nextExpectedRanges=e.nextExpectedRanges||this.nextExpectedRanges,this},e.prototype.withDefaultValues=function(){return this.id="DriveItemUploadSessionId",this.bytesSent=0,this.groupId="GroupId",this.itemId="itemId",this.itemName="sampleFile.txt",this.itemSize=28,this.uploadUrl="UploadURL",this.name="sampleFile.txt",this.expirationDateTime=new Date("2020-09-02"),this.webUrl="https://contoso.com/sites/group/sampleFile.txt",this.nextExpectedRanges=["26-"],this},e}(),s=function(){function e(e){this.bytesSent=e.bytesSent,this.expirationDateTime=e.expirationDateTime,this.groupId=e.groupId,this.id=e.id,this.itemId=e.itemId,this.itemName=e.itemName,this.itemSize=e.itemSize,this.lastUploadRequestSucceeded=e.lastUploadRequestSucceeded,this.uploadUrl=e.uploadUrl,this.name=e.name,this.webUrl=e.webUrl,this.nextExpectedRanges=e.nextExpectedRanges}return Object.defineProperty(e,"builder",{get:function(){return new n},enumerable:!1,configurable:!0}),e.prototype.getClone=function(){return e.builder.withPropertyBag({bytesSent:this.bytesSent,expirationDateTime:this.expirationDateTime,groupId:this.groupId,id:this.id,itemId:this.itemId,itemName:this.itemName||"",itemSize:this.itemSize||0,lastUploadRequestSucceeded:this.lastUploadRequestSucceeded,uploadUrl:this.uploadUrl,name:this.name,webUrl:this.webUrl,nextExpectedRanges:this.nextExpectedRanges}).build()},e.prototype.setProperty=function(e,t){if("id"===e)throw new Error("ReadOnlyException: "+e);var i=this.getClone();return i[e]=t,i},e}()},57718:(e,t,i)=>{function r(e){for(var t="";t.length<e;){var i=16*Math.random();t+=(i|=0).toString(16)}return t}i.d(t,{cM:()=>n});function n(){var e=[];e.push(r(8)),e.push(r(4));var t="4"+r(3);e.push(t);var i=r(4),n=parseInt(i[0],16);return n&=3,i=(n|=8).toString(16)+i.substr(1),e.push(i),e.push(r(12)),e.join("-")}},61739:(e,t,i)=>{i.d(t,{Cx:()=>s,Ny:()=>o,n0:()=>a});var r=i(54320),n=i.n(r);function s(e){let t="";if(!n()(e))try{t=new URLSearchParams(new URL(e).search).get("$skiptoken")||""}catch(i){}return t}function o(e,t){return`startswith(${e}, '${i=t,encodeURIComponent(i).replace(/'/g,"''")}')`;var i}function a(e){const t="https://graph.microsoft.com/";return e&&0===e.indexOf(t)&&(e=e.substring(28)),e}},91675:(e,t,i)=>{i.d(t,{t:()=>r});var r={Word:["docx","docm","doc","dotx","dotm"],Excel:["xlsx","xlsm","xlsb","xltx","xltm","xls","xlam","xla","xlw","xml"],PowerPoint:["pptx","pptm","ppt","potx","potm","pot","thmx","pps","ppsx","ppsm","ppsam","ppa"],OneNote:["one"],Project:["mpp","mpt","mpd"],Visio:["vsdx","vsd","vsdm","vssx","vssm","vstx","vstm"],Pdf:["pdf"],Loop:["loop","fluid"]}},94266:(e,t,i)=>{i.d(t,{R:()=>n});var r=i(45078);class n{appendSharepointAuthenticationChallengeHeaders(e){return e[r.Er.AuthenticationChallengeHeaderName]=r.Er.AuthenticationChallengeHeaderValue,e}getDefaultRequestTelemetryConfig(e){return{apiName:this.name,methodName:e,requestHeadersToLog:this.loggableRequestHeaders,responseHeadersToLog:this.loggableResponseHeaders}}extractSkipTokenFromNextLink(e){try{const t=new URL(e);return new URLSearchParams(t.search).get(this.skipTokenParam)}catch{return null}}constructor(e,t,i){this.name=e,this.hostDomain=t,this.ajaxClient=i,this.skipTokenKey="@odata.nextLink",this.skipTokenParam="$skiptoken",this.vBetaUrlToken="beta",this.v1UrlToken="v1.0",this.loggableRequestHeaders=[r.a8.ClientRequestId],this.loggableResponseHeaders=[r.Qu.RequestId,r.Qu.ClientRequestId,r.Qu.TCorrelationId]}}}}]);
//# sourceMappingURL=odspservice.edd7e7df.chunk.js.map