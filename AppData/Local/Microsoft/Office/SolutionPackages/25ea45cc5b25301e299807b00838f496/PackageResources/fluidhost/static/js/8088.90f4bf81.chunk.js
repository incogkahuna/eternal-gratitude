"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[8088],{8088:(e,t,s)=>{s.d(t,{js:()=>o,FX:()=>l,am:()=>r});var a=s(18206),i=s(98140),n=s(47860);(0,a.sG)(async function(e,t,s,i){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:360;const r=await(0,a.fV)(t=>e.getToken(["user.read"],t),`${"Consumer"===e.identityType?"https://graph.microsoft.com/beta/":""}me/photos/${n}x${n}/$value`,s,"GetMyPhoto",t,void 0,{signal:i},a.XM);return 200===r.status?URL.createObjectURL(await r.blob()):r.status},function(e,t,s,a){return arguments.length>4&&void 0!==arguments[4]?arguments[4]:360});const r=(0,a.sG)(async function(e,t,s,n,r,o){let u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:96;const l=await(0,a.fV)(t=>e.getToken(["user.readbasic.all"],t),`users/${t}/photos/${u}x${u}/$value`,s,"GetUserPhoto",n,r,{signal:o},a.XM);if(200===l.status){if((0,i.Fr)()){const e=new FileReader,s=new Promise(t=>{e.onloadend=function(){t(e.result)}});return e.readAsDataURL(await l.blob()),{userPrincipalName:t,pictureUrl:await s}}return{userPrincipalName:t,pictureUrl:URL.createObjectURL(await l.blob())}}return l.status},(e,t,s,a,i,n)=>`${t},${n}`);const o=(0,a.sG)(async(e,t,s)=>{if("Consumer"===e.identityType)return 404;const i=await(0,a.fV)(t=>e.getToken(["user.read"],t),"organization?$select=displayName",t,"GetMyCompanyName",s,void 0,void 0,a.XM);if(200===i.status){const e=await i.json(),t=e?.value?.[0]?.displayName;if(t)return t}return i.status},()=>"_");(0,a.sG)(async(e,t,s,i,n,r)=>{const o=await(0,a.fV)(t=>e.getToken(["user.readbasic.all"],t),`users/${encodeURIComponent(t)}?$select=id,displayName,mail,userPrincipalName,userType`,s,"GetUserDetails",i,n,{signal:r},a.XM);if(200===o.status){const{id:e,displayName:t,mail:s,userPrincipalName:a,userType:i}=await o.json();return{id:e,userPrincipalName:a,displayName:t,mail:s,userType:i}}return o.status},(e,t)=>t);let u;function l(e,t,s){return u||(u=(0,a.fV)(t=>e.getToken(["files.read"],t),"me/drive?select=owner,id,sharepointIds",s,"GetMyDrive",t,void 0,void 0,a.XM).then(async e=>{if(!e.ok)return void(u=void 0);const t=await e.json();if(!t.sharePointIds||!t.id)throw new Error("Unexpected response: missing drive info");return{url:t.sharePointIds.siteUrl,title:t.owner.user?.displayName??"",driveId:t.id,groupId:"",bannerImageUrl:"",id:t.sharePointIds.siteId}}).catch(e=>{throw u=void 0,e}),u)}(0,a.sG)(async(e,t,s,i)=>{if("Enterprise"!==t.identityType)return"";const n=await(0,a.fV)(e=>t.getToken(["user.readbasic.all"],e),`users/${e}?$select=givenName`,s,"GetUserGivenName",i,void 0,void 0,a.XM);if(200===n.status){const{givenName:e}=await n.json();if(e)return e}return n.status},e=>e),(0,a.sG)(async(e,t,s,i)=>{const r=["?$select=assignedLabels,displayName,mail","photo/$value"].map((t,s)=>({id:`request_${s}`,method:"GET",url:`groups/${e}/${t}`,headers:{"Content-Type":"application/json"}})),o=await async function(e,t,s,i,r,o,u){let l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,d=arguments.length>8?arguments[8]:void 0;const c=`${(0,n.o)(s)}/v1.0/$batch`,p=[];for(let n=0;n<e.length;n+=20){const m=e.slice(n,n+20),f={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({requests:m})},h=await(0,a.fV)(t,c,s,i,r,o,f,u,l,d);if(!h.ok)throw new Error(`Batch request failed with status code ${h.status}.`);const y=await h.json();p.push(...y.responses)}return p}(r,e=>t.getToken(["Group.Read.All"],e),s,"GetGroupDetails",i,void 0,a.XM,0,void 0),u=new Map(o.map(e=>[e.id,e])),l=u.get("request_0"),d=u.get("request_1");let c,p,m,f;if(200!==l?.status)return l?.status;{const e=l.body;c=e.displayName,p=e.assignedLabels,m=e.mail}if(200===d?.status){f=`data:image/png;base64,${d.body}`}return{displayName:c,assignedLabels:p,mail:m,photoUrl:f}},e=>e),(0,a.sG)(async(e,t,s,i)=>{const n=await(0,a.fV)(e=>t.getToken(["Group.Read.All"],e),`/groups?$select=displayName&$filter=startswith(mail, '${encodeURIComponent(e)}')`,s,"GetGroupDetailsFromMail",i,void 0,void 0,a.XM);if(200===n.status){const e=(await n.json()).value;if(e.length>0){return e[0]}return}return n.status},e=>e)}}]);
//# sourceMappingURL=8088.90f4bf81.chunk.js.map