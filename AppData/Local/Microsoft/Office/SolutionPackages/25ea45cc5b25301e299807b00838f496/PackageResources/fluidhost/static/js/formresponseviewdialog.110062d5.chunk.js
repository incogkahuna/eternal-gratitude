"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[42067],{715:(e,t,o)=>{var r;o.d(t,{x:()=>r}),function(e){e.Rating="Question.Rating",e.Date="Question.DateTime",e.FileUpload="Question.FileUpload",e.Choice="Question.Choice",e.Text="Question.TextField",e.Ranking="Question.Ranking",e.MatrixChoiceGroup="Question.MatrixChoiceGroup",e.MatrixChoice="Question.MatrixChoice",e.NetPromoterScore="Question.NPS"}(r||(r={}))},29610:(e,t,o)=>{o.r(t),o.d(t,{FormResponseViewDialog:()=>E});var r=o(65043),i=o(20751),n=o(27663),s=o(9442),a=o(52342),l=o(40520),c=o(62264),p=o(715),d=o(61035),m=o(77508),u=o(56415),h=o(8736),g=o(66783),x=o(52195),b=o(66151);const f=(0,g.J9)((e,t)=>{const o=[(0,b.aS)(e),(0,b.dg)(e),{boxShadow:"rgba(0, 0, 0, 0.4) 0px 0px 5px 0px",borderRadius:"3px","> div":{flexGrow:"1"},"@media (min-width: 480px)":{width:h.B.MainDialogWidth,maxWidth:h.B.MainDialogMaxWidth,minWidth:h.B.MainDialogMinWidth},button:[{width:"fit-content",height:"30px",backgroundColor:"transparent",padding:"5px 12px 5px 12px",":hover":{backgroundColor:"transparent !important"}}]},e===m.Sx.TeamsContrast&&{border:"1px solid "+u.z.White}],r=[(0,b._D)(e),{display:"flex",gap:"5px"}],i=[(0,b.gS)("column"),b.cc,(0,b.aS)(e),{textAlign:"center",fontSize:x.s.large,height:"250px",fontWeight:x.BO.semibold}],n={table:{borderCollapse:"separate",borderSpacing:0,padding:"0px 20px",width:"100%"},"table tr th, table tr td":{borderRight:`1px solid ${u.z.NeutralLightGrey82}`,borderBottom:`1px solid ${u.z.NeutralLightGrey82}`,padding:"8px 16px"},"table tr th:first-child, table tr td:first-child":{borderLeft:`1px solid ${u.z.NeutralLightGrey82}`},"table tr th":{borderTop:`1px solid ${u.z.NeutralLightGrey82}`,textAlign:"left"},"table tr:first-child th:first-child":{borderTopLeftRadius:"8px"},"table tr:first-child th:last-child":{borderTopRightRadius:"8px"},"table tr:last-child td:first-child":{borderBottomLeftRadius:"8px"},"table tr:last-child td:last-child":{borderBottomRightRadius:"8px"}},s=[e===m.Sx.TeamsContrast?{color:u.z.HighContrastBlackSelectedTextBackground}:(0,b._D)(e),{fontSize:x.s.medium,margin:"15px 10px",border:"none",cursor:"pointer"}],a=[(0,b.gS)("row"),{padding:"30px 20px",gap:"15px"}],l=[(0,b.$Z)("32px"),{height:"32px",width:"32px"}],c=[(0,b.$Z)("40px"),(0,b.i9)(e),{height:"40px",width:"40px",alignItems:"center",padding:"8px 0px 0px 8px",borderRadius:"2px",pointerEvents:"none"}],p=[(0,b.gS)("column"),{".primaryTextSection":{height:"28px"}}],d=[(0,b.gS)("column"),{gap:"15px",minWidth:"200px",".ms-Image-image":{maxWidth:"300px"}}];return(0,x.TW)({dialogContainer:o,loadingSpinner:i,dialogTopButton:[{right:"auto",padding:"15px 15px 0px"}],questionAnswerTable:n,backButton:r,submitAnotherResponseButton:s,formsHeaderSection:a,formsLogoIcon:l,formsMetadataSection:p,iconSection:c,fileUpload:d,tableColumn:{minWidth:"200px"}},t)}),T=(u.z.TeamsAppBrand00,u.z.TeamsDarkPurple,u.z.TeamsDarkPurple,(0,g.J9)(e=>({topButton:e.dialogTopButton}))),S=(0,g.J9)(e=>({dialogContainer:(0,x.Zq)("dialogContainer",e.dialogContainer),loadingSpinner:(0,x.Zq)("loadingSpinner",e.loadingSpinner),dialogTopButton:(0,x.Zq)("dialogTopButton",e.dialogTopButton),questionAnswerTable:(0,x.Zq)("questionAnswerTable",e.questionAnswerTable),backButton:(0,x.Zq)("backButton",e.backButton),submitAnotherResponseButton:(0,x.Zq)("submitAnotherResponseButton",e.submitAnotherResponseButton),formsHeaderSection:(0,x.Zq)("formsHeaderSection",e.formsHeaderSection),formsLogoIcon:(0,x.Zq)("formsLogoIcon",e.formsLogoIcon),formsMetadataSection:(0,x.Zq)("formsMetadataSection",e.formsMetadataSection),iconSection:(0,x.Zq)("iconSection",e.iconSection),fileUpload:(0,x.Zq)("fileUpload",e.fileUpload),tableColumn:(0,x.Zq)("tableColumn",e.tableColumn)}));var R=o(59846),C=o(4648),w=o(86053),B=o(21382),N=o(54052),k=o.n(N);const E=e=>{const{onDismiss:t,theme:o,contentStyles:m,getThumbnail:u,dialogContentClassName:h,dialogClassName:g,dialogContainerClassName:x,formWithQA:b,onSubmitAnotherResponseClick:N}=e,E=S(f(o,m)),y=r.useCallback((e,t)=>{if(!t)return null;const o=d.V.getLatestResponseAnswers(t);return o.find(t=>t.questionId===e.id)?.answer1??null},[]),q=()=>{if(!b)return null;const e=d.V.getLatestResponse(b),t=e?new Date(e.submitDate):"",n=e?.responderName;return r.createElement("div",{className:E.formsHeaderSection},r.createElement("div",{className:E.iconSection},r.createElement(i.I,{...R.U3,className:(0,C.A)(R.U3.className,E.formsLogoIcon)})),r.createElement("div",{className:E.formsMetadataSection},r.createElement(c.g,{titleText:b.displayName,theme:o}),t&&n&&B.G(w.p.Strings.FormResponseViewDialog_SubmissionMetadataText,n,t.toLocaleDateString(),t.toLocaleTimeString())))},A=()=>r.createElement("button",{className:E.submitAnotherResponseButton,type:"button",onClick:()=>N()},w.p.Strings.FormResponseViewDialog_SubmitAnotherResponseButtonText),D=()=>{if(!b)return null;const e=b.questions.sort((e,t)=>e.order-t.order).map(e=>L(e));return r.createElement("div",{className:E.questionAnswerTable},r.createElement("table",null,r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",null,r.createElement(c.g,{titleText:w.p.Strings.FormResponseViewDialog_QuestionColumnHeaderText,theme:o})),r.createElement("th",null,r.createElement(c.g,{titleText:w.p.Strings.FormResponseViewDialog_AnswerColumnHeaderText,theme:o})))),r.createElement("tbody",null,...e)))},L=e=>{const t=I(e);return r.createElement("tr",null,r.createElement("td",null,r.createElement("div",{className:E.tableColumn},e.title)),r.createElement("td",null,t))},I=e=>{const t=y(e,b);if(!t)return null;let o=t;switch(e.questionType){case p.x.Ranking:o=t.sort((e,t)=>e.answerOrder-t.answerOrder).map(e=>e.displayText).join(", ");break;case p.x.MatrixChoice:o=t.displayText??"";break;case p.x.FileUpload:const e=d.V.getImageUrls(t);return r.createElement("div",{className:E.fileUpload},e.map(e=>{const t=u(e);return t?r.createElement(n._,{key:e,src:t}):r.createElement(s.N,{key:e,href:e,target:"_blank",rel:"noopener noreferrer"},w.p.Strings.FormResponseViewDialog_OpenFileInSharepointLinkText)}));case p.x.Choice:try{const e=JSON.parse(t);o=k()(e)?e.join(", "):t}catch(i){o=t}break;case p.x.Text:case p.x.Rating:case p.x.Date:case p.x.NetPromoterScore:case p.x.MatrixChoiceGroup:default:o=t}return r.createElement("div",{className:E.tableColumn},o)};return r.createElement(a.l,{hidden:!1,onDismiss:t,dialogContentProps:{className:h,closeButtonAriaLabel:w.p.Strings.AddFormRequirementDialog_CloseDialogAriaLabel,styles:T(f(o,m)),type:l.h.normal,topButtonsProps:[{onRenderIcon:()=>r.createElement("div",{className:E.backButton,onClick:t},r.createElement(i.I,R.qb),w.p.Strings.FormResponseViewDialog_DialogHeaderBackButtonLabel)}]},modalProps:{className:g,containerClassName:(0,C.A)(x,E.dialogContainer),isBlocking:!1}},r.createElement("div",null,q(),D(),A()))}},61035:(e,t,o)=>{o.d(t,{V:()=>i});class r{constructor(e){this.id=e.id,this.order=e.order,this.title=e.title,this.titleRT=e.titleRT,this.subtitle=e.subtitle,this.subtitleRT=e.subtitleRT,this.questionType=e.questionType}}r.fromWebResource=e=>new r({id:e.id,order:e.order,title:e.title,titleRT:e.formsProRTQuestionTitle,subtitle:e.subtitle,subtitleRT:e.formsProRTSubtitle,questionType:e.type});class i{static getLatestResponse(e){return e.responses[0]}static getLatestResponseAnswers(e){let t=[];const o=this.getLatestResponse(e);if(o?.answers)try{t=JSON.parse(o.answers)}catch(r){throw new Error(`Failed to parse form response answers: ${o.answers}, Error: ${r}`)}return t}constructor(e){this.formId=e.formId,this.displayName=e.displayName,this.questions=e.questions,this.responses=e.responses,this.formWebUrl=e.formWebUrl,this.formResponse=e.formResponse}}i.getImageUrls=e=>{try{return JSON.parse(e).map(e=>e.link)}catch(t){throw new Error(`Failed to parse form response file upload answer: ${e}, Error: ${t}`)}},i.fromWebResource=e=>new i({formId:e.formId,displayName:e.displayName,questions:e.questions.map(e=>r.fromWebResource(e)),responses:e.responses,formWebUrl:e.formWebUrl,formResponse:e.formResponse})},62264:(e,t,o)=>{o.d(t,{g:()=>m});var r=o(65043),i=o(16112),n=o(66783),s=o(52195),a=o(66151),l=o(56415);const c="34px",p=(0,n.J9)(e=>({root:[(0,a.q0)("ellipsis"),(0,a.aS)(e),{height:c,cursor:"default","> button":[a.xK,(0,a.q0)("ellipsis"),{cursor:"pointer",width:"100%",":hover > span":{borderBottom:`2px solid ${l.z.ThemeSecondary}`}}],"> .primaryTextSectionTitle":{fontSize:"17px",fontWeight:s.BO.semibold,lineHeight:c,margin:"auto"}}]})),d=(0,n.J9)(e=>({root:(0,s.Zq)("primaryTextSection",e.root)}));class m extends i.${name(){return"HeaderTitle"}renderComponent(){const{titleText:e,onClickTitleButton:t,titleButtonAriaLabel:o}=this.props,i=this.getClassNames();return r.createElement("div",{className:i.root,title:e},null!=t?r.createElement("button",{className:"primaryTextSectionTitle",onClick:this.onTitleClick,"aria-label":o,id:"primaryTextSectionTitleId",ref:this.titleButtonRef},r.createElement("span",null,e)):r.createElement("h2",{className:"primaryTextSectionTitle",id:"primaryTextSectionTitleId"},e))}getClassNames(){return d(p(this.props.theme))}constructor(e,t){super(e,t),this.titleButtonRef=r.createRef(),this.onTitleClick=()=>{this.props.onClickTitleButton?.(this.titleButtonRef.current??void 0)}}}}}]);
//# sourceMappingURL=formresponseviewdialog.110062d5.chunk.js.map