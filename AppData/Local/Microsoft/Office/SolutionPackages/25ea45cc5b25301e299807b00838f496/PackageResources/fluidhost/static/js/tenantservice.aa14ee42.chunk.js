(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[96924],{39115:(e,t,i)=>{var s=i(45967),r=i(36311),a=i(50715);e.exports=function(e){return r(e)?a(e):s(e)}},45967:e=>{e.exports=function(e){return e.split("")}},50715:e=>{var t="\\ud800-\\udfff",i="["+t+"]",s="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",r="\\ud83c[\\udffb-\\udfff]",a="[^"+t+"]",l="(?:\\ud83c[\\udde6-\\uddff]){2}",n="[\\ud800-\\udbff][\\udc00-\\udfff]",u="(?:"+s+"|"+r+")"+"?",o="[\\ufe0e\\ufe0f]?",p=o+u+("(?:\\u200d(?:"+[a,l,n].join("|")+")"+o+u+")*"),h="(?:"+[a+s+"?",s,l,n,i].join("|")+")",c=RegExp(r+"(?="+r+")|"+h+p,"g");e.exports=function(e){return e.match(c)||[]}},56088:(e,t,i)=>{"use strict";i.r(t),i.d(t,{TenantService:()=>p});var s=i(94283),r=i(55337),a=i(5312),l=i(94266),n=i(98990),u=i.n(n),o=i(98502);class p extends l.R{async getSensitivityLabelsAsync(){const e=`${this.hostDomain}/${this.vBetaUrlToken}/me/informationProtection/sensitivityLabels?$filter=applicableTo+has+'site,unifiedGroup'`,t=await this.ajaxClient.executeRequest(e,{telemetryConfig:this.getDefaultRequestTelemetryConfig("getSensitivityLabelsAsync")});try{const e=await t.clone().json();if(null==e||!e.value)throw o.g.generateAjaxClientError(t,"No sensitivity labels returned");return e.value.map(e=>s.k.builder.fromGraphResource(e).build())}catch(i){throw o.g.generateAjaxClientError(t,i)}}async getSensitivityPolicySettingsAsync(){const e=`${this.hostDomain}/${this.vBetaUrlToken}/me/informationProtection/sensitivityPolicySettings?$filter=applicableTo+has+'site,unifiedGroup'`,t=await this.ajaxClient.executeRequest(e,{telemetryConfig:this.getDefaultRequestTelemetryConfig("getSensitivityPolicySettingsAsync")});try{const e=await t.clone().json();return a.H.fromGraphResource(e)}catch(i){return a.H.fromGraphResource(null)}}async getTenantGroupSettingsAsync(){const e=`${this.hostDomain}/${this.v1UrlToken}/groupSettings`,t=await this.ajaxClient.executeRequest(e,{telemetryConfig:this.getDefaultRequestTelemetryConfig("getTenantGroupSettingsAsync")});try{const e=await t.clone().json();if(null==e||!e.value)throw o.g.generateAjaxClientError(t,"No tenant group settings returned");const i=u()(e.value,e=>e.templateId===this.unifiedGroupTemplateId&&e.displayName===this.unifiedGroupDisplayName);return i?r.h.builder.fromGraphResource(i).build():r.h.builder.withPropertyBag({enableUnifiedGroupCreation:!0}).build()}catch(i){throw o.g.generateAjaxClientError(t,i)}}constructor(e,t){super("TenantService",e,t),this.unifiedGroupTemplateId="62375ab9-6b52-47ed-826b-58e47e0e304b",this.unifiedGroupDisplayName="Group.Unified"}}},94266:(e,t,i)=>{"use strict";i.d(t,{R:()=>r});var s=i(45078);class r{appendSharepointAuthenticationChallengeHeaders(e){return e[s.Er.AuthenticationChallengeHeaderName]=s.Er.AuthenticationChallengeHeaderValue,e}getDefaultRequestTelemetryConfig(e){return{apiName:this.name,methodName:e,requestHeadersToLog:this.loggableRequestHeaders,responseHeadersToLog:this.loggableResponseHeaders}}extractSkipTokenFromNextLink(e){try{const t=new URL(e);return new URLSearchParams(t.search).get(this.skipTokenParam)}catch{return null}}constructor(e,t,i){this.name=e,this.hostDomain=t,this.ajaxClient=i,this.skipTokenKey="@odata.nextLink",this.skipTokenParam="$skiptoken",this.vBetaUrlToken="beta",this.v1UrlToken="v1.0",this.loggableRequestHeaders=[s.a8.ClientRequestId],this.loggableResponseHeaders=[s.Qu.RequestId,s.Qu.ClientRequestId,s.Qu.TCorrelationId]}}},94283:(e,t,i)=>{"use strict";i.d(t,{k:()=>h});var s=i(55491),r=i.n(s),a=i(54320),l=i.n(a),n=i(91246);class u{build(){return new h(this)}fromSensitivityLabelResource(e){const t=e.sublabels?.map(e=>(new u).fromSensitivityLabelResource(e));return this.withPropertyBag({id:e.id,name:e.name,displayName:e.displayName,description:e.description,toolTip:e.toolTip,isDefault:e.isDefault,priority:e.priority,groupAllowGuestUsers:e.groupAllowGuestUsers,groupPrivacy:e.groupPrivacy,sublabels:t})}fromGraphResource(e){const t=e.sublabels?.map(e=>(new u).fromGraphResource(e));let i=this.groupAllowGuestUsers,s=this.groupPrivacy;const r=e.labelActions;if(r&&!l()(r))for(const a of r)if("protectGroup"===a.name){i=a.allowGuestUsers??!1,s=a.privacy??this.groupPrivacy;break}return this.withPropertyBag({id:e.id,name:e.name,displayName:e.displayName,description:e.description,toolTip:e.toolTip,isDefault:e.isDefault,priority:e.priority,groupAllowGuestUsers:i,groupPrivacy:s,sublabels:t})}withPropertyBag(e){return this.id=e.id||this.id,this.name=e.name||this.name,this.displayName=e.displayName||this.displayName,this.description=e.description||this.description,this.toolTip=e.toolTip||this.toolTip,this.isDefault=e.isDefault??this.isDefault,this.priority=e.priority||this.priority,this.groupAllowGuestUsers=e.groupAllowGuestUsers??this.groupAllowGuestUsers,this.groupPrivacy=e.groupPrivacy||this.groupPrivacy,this.sublabels=e.sublabels||this.sublabels,this}withValidData(){return this.withPropertyBag({id:n.o.generate()})}constructor(){this.id="",this.name="",this.displayName="",this.description="",this.toolTip="",this.isDefault=!1,this.priority=0,this.groupAllowGuestUsers=!0,this.groupPrivacy="",this.sublabels=null}}var o=i(21382),p=i(86053);class h{static get builder(){return new u}static getDefaultSensitivityLabel(e){if(l()(e))return null;let t=null;return r()(e,e=>{if(e.isDefault?t=e:null!=e.sublabels&&r()(e.sublabels,e=>{if(e.isDefault)return t=e,!1}),null!=t)return!1}),t}static getSensitivityLabel(e,t){if(l()(e)||l()(t))return null;let i=null;return r()(t,t=>{if(t.id===e?i=t:null!=t.sublabels&&r()(t.sublabels,t=>{if(t.id===e)return i=t,!1}),null!=i)return!1}),i}static getParentSensitivityLabel(e,t){if(l()(e)||l()(t))return null;let i=null;return r()(t,t=>{if(null!=t.sublabels&&r()(t.sublabels,s=>{if(s.id===e)return i=t,!1}),null!=i)return!1}),i}static getFullSensitivityTitle(e,t){if(l()(e)||l()(t))return"";const i=h.getSensitivityLabel(e,t),s=h.getParentSensitivityLabel(e,t);return i&&s?o.G(p.p.Strings.SensitivityLabel_FullTitle,s.displayName,i.displayName):i?.displayName??""}constructor(e){this.id=e.id,this.name=e.name,this.displayName=e.displayName,this.description=e.description,this.toolTip=e.toolTip,this.isDefault=e.isDefault,this.priority=e.priority,this.groupAllowGuestUsers=e.groupAllowGuestUsers,this.groupPrivacy=e.groupPrivacy,this.sublabels=null,null!=e.sublabels&&(this.sublabels=[],e.sublabels.forEach(e=>{this.sublabels.push(new h(e))}))}}}}]);
//# sourceMappingURL=tenantservice.aa14ee42.chunk.js.map