/*! For license information please see main.63d302ce.js.LICENSE.txt */
(()=>{var e={488:(e,t,r)=>{"use strict";r.d(t,{k:()=>o});const o={genericError:"genericError",throttlingError:"throttlingError",dataCorruptionError:"dataCorruptionError",dataProcessingError:"dataProcessingError",usageError:"usageError"}},899:(e,t,r)=>{"use strict";r.d(t,{Mg:()=>n,qn:()=>o,u0:()=>i,xE:()=>s});const o=window.external;function n(){return o.GetContext?o.GetContext().GetAppUILocale():void 0}function i(){var e;return(null===(e=o.GetContext())||void 0===e?void 0:e.GetCorrelationId())||""}function s(){const e=null===o||void 0===o?void 0:o.GetHostInfo(),[,t]=e.split("="),[r,n]=t.split("$"),i="string"===typeof n?n:"";return{appName:"string"===typeof r?r:"Unknown",appVersion:(null===o||void 0===o?void 0:o.GetContext().GetHostFullVersion())||"",platform:i}}},2875:(e,t,r)=>{"use strict";r.d(t,{AH:()=>n,O0:()=>i});var o=r(26631);const n=e=>o.Ss.from(e,"base64").toString("utf8"),i=e=>o.Ss.from(e,"utf8").toString("base64")},3503:(e,t,r)=>{"use strict";r.d(t,{f:()=>o});const o=new URLSearchParams("undefined"!==typeof location?location.search:"")},3542:(e,t,r)=>{"use strict";r.d(t,{DU:()=>i,Iy:()=>a});var o,n=r(96752);function i(e){o!==e&&(o=e)}function s(){return void 0===o&&(o="undefined"!==typeof document&&!!document.documentElement&&"rtl"===document.documentElement.getAttribute("dir")),o}function a(){return{rtl:s(),shadowConfig:n.ou}}o=s()},4041:(e,t,r)=>{"use strict";r.d(t,{$6:()=>o,Z_:()=>s});var o,n=r(15217);!function(e){e.wait="wait",e.viaHandle="viaHandle",e.payloadPending="payloadPending"}(o||(o={}));const i="ABCDEFGHIJKLMNOPQRSTUVWXYZ(abcdefghijklmnopqrstuvwxyz)0123456789";function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if("string"===typeof e)return e;(0,n.vA)(Number.isInteger(e)&&e>=0,2304);let r="",o=e;do{r=i[o%64]+r,o=Math.floor(o/64)-1}while(-1!==o);return t+r}},4311:(e,t,r)=>{"use strict";r.d(t,{RG:()=>u,ZQ:()=>h,fZ:()=>l});var o=r(69235),n=r(40635),i=r(18206),s=r(60138),a=r(56142),c=r(6971);const d=new s.z;async function l(){var e;const t=null!==(e=(await(0,c.E)()).graphEndpoint)&&void 0!==e?e:"https://graph.microsoft.com/",r=new URL(t+"v1.0/me/drive"),n=r.origin,s=await(0,i.z$)(e=>d.getTokenWithRetries([n],e),r.href);if(s.ok){const e=await s.json(),t=null===e||void 0===e?void 0:e.webUrl,r=t?t.split("/").slice(0,-1).join("/"):t;return{id:(null===e||void 0===e?void 0:e.id)||"",siteUrl:r||""}}throw new o.uV(`Unable to get the Sharepoint drive info. [${s.status} ${s.statusText}]`)}async function u(e){"string"===typeof e&&(e=new URL(e));const t=e.origin,r=`${t}/_api/v2.0/shares/${function(e){return"u!"+btoa(e).replace(/=+$/,"").replace("/","_").replace("+","-")}(e.href)}`;(0,a.Rm)("Getting file name from Sharepoint...");const i=(await(0,n.y)({url:r,getToken:e=>d.getTokenWithRetries([t],e)})).result;if(i.ok){const e=await i.json();return(null===e||void 0===e?void 0:e.name)||""}throw new o.uV(`Unable to get filename from Sharepoint. [${i.status} ${i.statusText}]`)}async function h(e){var t;const r=null!==(t=(await(0,c.E)()).graphEndpoint)&&void 0!==t?t:"https://graph.microsoft.com/",n=new URL(r+`v1.0/me/drive/special/${e}`),s=n.origin,a=await(0,i.z$)(e=>d.getTokenWithRetries([s],e),n.href);if(a.ok){const e=await a.json();return(null===e||void 0===e?void 0:e.name)||""}throw new o.uV(`Unable to get special folder name. [${a.status} ${a.statusText}]`)}},4563:(e,t,r)=>{"use strict";function o(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var o=0,i=t;o<i.length;o++){n(e||{},i[o])}return e}function n(e,t,r){for(var o in void 0===r&&(r=[]),r.push(t),t)if(t.hasOwnProperty(o)&&"__proto__"!==o&&"constructor"!==o&&"prototype"!==o){var i=t[o];if("object"!==typeof i||null===i||Array.isArray(i))e[o]=i;else{var s=r.indexOf(i)>-1;e[o]=s?i:n(e[o]||{},i,r)}}return r.pop(),e}r.d(t,{z:()=>s});var i=r(40695);function s(e,t){var r,n,s;void 0===t&&(t={});var a=o({},e,t,{semanticColors:(0,i.B)(t.palette,t.effects,t.semanticColors,void 0===t.isInverted?e.isInverted:t.isInverted)});if((null===(r=t.palette)||void 0===r?void 0:r.themePrimary)&&!(null===(n=t.palette)||void 0===n?void 0:n.accent)&&(a.palette.accent=t.palette.themePrimary),t.defaultFontStyle)for(var c=0,d=Object.keys(a.fonts);c<d.length;c++){var l=d[c];a.fonts[l]=o(a.fonts[l],t.defaultFontStyle,null===(s=null===t||void 0===t?void 0:t.fonts)||void 0===s?void 0:s[l])}return a}},5482:(e,t,r)=>{"use strict";r.d(t,{M4:()=>f,ZY:()=>p.ZY,qb:()=>p.qb,v6:()=>m});var o=r(89092),n=r(18731),i=r(11582),s=r(81793),a=r(56142),c=r(90293),d=r(94115),l=r(27377),u=r(64580),h=r(58443),g=r(69235),p=r(53783);const m="unknownError";function f(e,t,r){var p;let m;if(e instanceof g.uV)m=e.hydrateResult;else{const t=function(e){return(0,n.kN)(e)||(0,i.$T)(e)||(0,o.FX)(e)||(0,s.N2)(e)}(e);m=(0,u.G)(t)}var f;((0,a.vV)(`Unable to load the Fluid container or component. ${e}`),null===(p=r.LoadPerfTracker)||void 0===p||p.setFailure(e),r.sendTelemetryForFailure(d.y.LoadComponentError,m,e),(0,l._)(),t)&&(null===(f=document.getElementById(h.L0))||void 0===f||f.focus());c.ux&&(c.ux.notify=!0)}},5667:(e,t,r)=>{"use strict";r.d(t,{n:()=>l});var o=r(78796),n=r(48116),i=r(26308),s=r(87416),a=r(63990),c=r(25532);const d=new Set;function l(e,t){const r=new URL(e);if([o.i,n.t].includes(r.origin.toLowerCase()))return"consumers";const l=r.hostname.toLowerCase(),u=(0,i.v6)(l);return u?.guid?u.guid:u?u.hostname:(function(e,t){const r=new URL(e).hostname.toLowerCase();d.has(r)||(d.add(r),(0,a.l)(()=>{(0,c.J)(e,t).catch(()=>{}).finally(()=>d.delete(r))},{ensureExecution:!1}))}(e,t),(0,s.Xd)(e))}},6390:(e,t,r)=>{"use strict";r.d(t,{s:()=>o});const o={success:"green",warning:"orange",danger:"cranberry"}},6971:(e,t,r)=>{"use strict";r.d(t,{E:()=>i});var o=r(91947);let n;async function i(){return n||(n=(0,o.KE)()),n}},7428:(e,t,r)=>{"use strict";r.d(t,{xX:()=>o});const o=".gcdata"},7621:(e,t,r)=>{"use strict";r.d(t,{SC:()=>n,wJ:()=>o});const o=(e,t)=>i(new Map,e,t),n=(e,t)=>i(new WeakMap,e,t);function i(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return arguments.length<=0?void 0:arguments[0]};const o=function(o){for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];const a=r(...i);if(!o){const t=e.get(a);if(t)return t.then()}const c=t(...i);return e.set(a,c),c.catch(()=>{e.delete(a)}),c.then()};return{get:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return o(!1,...t)},forceFetch:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return o(!0,...t)},delete(){const t=r(...arguments);e.delete(t)}}}},8018:(e,t,r)=>{"use strict";r.d(t,{c:()=>o});class o{constructor(){this.completed=!1,this.p=new Promise((e,t)=>{this.res=e,this.rej=t})}get isCompleted(){return this.completed}get promise(){return this.p}resolve(e){void 0!==this.res&&(this.completed=!0,this.res(e))}reject(e){void 0!==this.rej&&(this.completed=!0,this.rej(e))}}},9580:(e,t,r)=>{"use strict";function o(e,t){const r=t.keyboardShortcutDescription;return r.type===e.type&&r.key===e.key&&!!r.altKey===e.altKey&&!!r.ctrlKey===e.ctrlKey&&!!r.metaKey===e.metaKey&&!!r.shiftKey===e.shiftKey}r.d(t,{X:()=>o})},11137:(e,t,r)=>{"use strict";r.d(t,{Y:()=>S});var o=r(85038),n=r(48219),i=r(54813),s=r(93586),a=r(93220),c=r(57471),d=r(41818),l=r(34445);async function u(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"SHA-1",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"hex";if(void 0===crypto.subtle)return r.e(13482).then(r.bind(r,94668)).then(async r=>r.hashFile(e,t,o));const n=await async function(e,t){const r=await crypto.subtle.digest(t,e);return new Uint8Array(r)}(e,t);return function(e,t){switch(t){case"hex":return Array.prototype.map.call(e,e=>e.toString(16).padStart(2,"0")).join("");case"base64":return l.fromByteArray(e)}}(n,o)}var h=r(27015),g=r(70530),p=r(27612);function m(e,t,r,o){const n=o?`versions/${o}/`:"";return`${(0,h.lA)(new URL(e))}/drives/${t}/items/${r}/${n}`}function f(e,t,r,o){return`${m(e,t,r,o)}opStream/snapshots`}function v(e,t,r,o){return`${m(e,t,r,o)}opStream/attachment`}function y(e,t,r,o){return`${m(e,t,r,o)}opStream/attachments`}function b(e,t,r,o){return`${m(e,t,r,o)}opStream`}class S{constructor(){}async resolve(e){if(e.headers?.[n.U.createNew]){const[t,r]=e.url.split("?"),o=new URLSearchParams(r),c=e.headers[n.U.createNew].fileName,d=o.get("driveId"),l=o.get("path"),u=o.get("containerPackageName");if(!(c&&t&&d&&null!==l&&void 0!==l))throw new i.OI("Proper new file params should be there",s.E.genericError,{driverVersion:p.z});return{endpoints:{snapshotStorageUrl:"",attachmentGETStorageUrl:"",attachmentPOSTStorageUrl:"",deltaStorageUrl:""},tokens:{},type:"fluid",odspResolvedUrl:!0,id:"odspCreateNew",url:`https://${t}?${r}&version=null`,siteUrl:t,hashedDocumentId:"",driveId:d,itemId:"",fileName:c,summarizer:!1,codeHint:{containerPackageName:u??void 0},fileVersion:void 0,shareLinkInfo:void 0,isClpCompliantApp:e.headers?.[a.t.isClpCompliantApp]}}const{siteUrl:t,driveId:r,itemId:c,path:l,containerPackageName:h,fileVersion:g}=function(e){const[t,r]=e.split("?"),o=new URLSearchParams(r),n=o.get("driveId"),i=o.get("itemId"),s=o.get("path"),a=o.get("containerPackageName"),c=o.get("fileVersion");if(null===n)throw new Error("ODSP URL did not contain a drive id");if(null===i)throw new Error("ODSP Url did not contain an item id");if(null===s)throw new Error("ODSP Url did not contain a path");return{siteUrl:t,driveId:decodeURIComponent(n),itemId:decodeURIComponent(i),path:decodeURIComponent(s),containerPackageName:a?decodeURIComponent(a):void 0,fileVersion:c?decodeURIComponent(c):void 0}}(e.url),m=await async function(e,t){const r=d.Ss.from(`${e}_${t}`);return encodeURIComponent(await u(r,"SHA-256","base64"))}(r,c);(0,o.vA)(!m.includes("/"),168);const S=`https://placeholder/placeholder/${m}/${C=l,C.startsWith("/")?C.slice(1):C}`;var C;const k=!!e.headers?.[n.U.summarizingClient];return{type:"fluid",odspResolvedUrl:!0,endpoints:{snapshotStorageUrl:f(t,r,c,g),attachmentPOSTStorageUrl:v(t,r,c,g),attachmentGETStorageUrl:y(t,r,c,g),deltaStorageUrl:b(t,r,c,g)},id:m,tokens:{},url:S,hashedDocumentId:m,siteUrl:t,driveId:r,itemId:c,dataStorePath:l,fileName:"",summarizer:k,codeHint:{containerPackageName:h},fileVersion:g,isClpCompliantApp:e.headers?.[a.t.isClpCompliantApp]}}async getAbsoluteUrl(e,t,r){const o=(0,g.Yn)(e);let n,i=t;var s;return""===t&&void 0!==o.dataStorePath&&(i=o.dataStorePath),i.startsWith("/")&&(i=i.slice(1)),r&&"name"in r?n=r.name:(s=r?.package,n="object"===typeof s&&"string"===typeof s?.name&&"object"===typeof s?.fluid?r?.package.name:r?.package),n=n??o.codeHint?.containerPackageName,(0,c.m)({...o,containerPackageName:n,dataStorePath:i})}}},11502:(e,t,r)=>{"use strict";var o;r.d(t,{e:()=>o}),function(e){e[e.Shared=0]="Shared",e[e.Plain=1]="Plain"}(o||(o={}))},11582:(e,t,r)=>{"use strict";r.d(t,{$T:()=>n});var o=r(37513);function n(e){if("object"===typeof e){const t=e;if(function(e){return e.errorType===o.a.genericError}(t))return o.a.genericError;if(function(e){return e.errorType===o.a.fileNotFoundOrAccessDeniedError}(t))return o.a.fileNotFoundOrAccessDeniedError;if(function(e){return e.errorType===o.a.authorizationError}(t))return o.a.authorizationError;if(function(e){return e.errorType===o.a.throttlingError}(t))return o.a.throttlingError}}},12283:(e,t,r)=>{"use strict";r.d(t,{d$:()=>n,vV:()=>s,wC:()=>i});var o=function(){var e=[];return{fireEvent:function(t){e.forEach(function(e){return e(t)})},addListener:function(t){t&&e.push(t)}}}();function n(){return o}function i(e,t,r){o.fireEvent({level:e,category:t,message:r})}function s(e,t,r){i(0,e,function(){var e=r instanceof Error?r.message:"";return"".concat(t,": ").concat(e)})}},12553:(e,t,r)=>{"use strict";r.d(t,{c:()=>a,y:()=>s});var o=r(94040),n=r(90140),i=r(31482);const s=new Map([[o.Jf.colorNeutralForeground1,[n.Ve.neutralPrimary,n.KM.ActionLink,n.KM.BodyText,n.KM.ButtonText,n.KM.ButtonTextChecked,n.KM.ButtonTextCheckedHovered,n.KM.ButtonTextHovered,n.KM.ButtonTextPressed,n.KM.InputText,n.KM.ListText,n.KM.ListTextColor,n.KM.MenuIcon,n.KM.MenuItemText,n.KM.MessageText]],[o.Jf.colorNeutralForeground1Hover,[n.Ve.neutralPrimary,n.KM.ActionLinkHovered,n.KM.InputTextHovered]],[o.Jf.colorNeutralForeground1Pressed,[n.Ve.neutralPrimary]],[o.Jf.colorNeutralForeground1Selected,[n.Ve.neutralPrimary,n.KM.BodyTextChecked]],[o.Jf.colorNeutralForeground2,[n.Ve.neutralSecondary,n.KM.BodySubtext]],[o.Jf.colorNeutralForeground2Hover,[n.Ve.neutralPrimary,n.KM.MenuItemTextHovered]],[o.Jf.colorNeutralForeground2Pressed,[n.Ve.neutralPrimary]],[o.Jf.colorNeutralForeground2Selected,[n.Ve.neutralPrimary]],[o.Jf.colorNeutralForeground2BrandHover,[n.Ve.themePrimary]],[o.Jf.colorNeutralForeground2BrandPressed,[n.Ve.themeDarkAlt]],[o.Jf.colorNeutralForeground2BrandSelected,[n.Ve.themePrimary]],[o.Jf.colorNeutralForeground3,[n.Ve.neutralTertiary,n.KM.InputIcon,n.KM.InputIconHovered,n.KM.MenuHeader]],[o.Jf.colorNeutralForeground3Hover,[n.Ve.neutralSecondary]],[o.Jf.colorNeutralForeground3Pressed,[n.Ve.neutralSecondary]],[o.Jf.colorNeutralForeground3Selected,[n.Ve.neutralSecondary]],[o.Jf.colorNeutralForeground3BrandHover,[n.Ve.themePrimary]],[o.Jf.colorNeutralForeground3BrandPressed,[n.Ve.themeDarkAlt]],[o.Jf.colorNeutralForeground3BrandSelected,[n.Ve.themePrimary]],[o.Jf.colorNeutralForeground4,[n.Ve.neutralQuaternary,n.KM.InputPlaceholderText]],[o.Jf.colorNeutralForegroundDisabled,[n.Ve.neutralTertiaryAlt,n.KM.ButtonTextDisabled,n.KM.DisabledBodySubtext,n.KM.DisabledBodyText,n.KM.DisabledText,n.KM.InputIconDisabled,n.KM.PrimaryButtonTextDisabled]],[o.Jf.colorBrandForegroundLink,[n.Ve.themeDarkAlt,n.KM.Link,n.KM.MessageLink]],[o.Jf.colorBrandForegroundLinkHover,[n.Ve.themeDark,n.KM.LinkHovered,n.KM.MessageLinkHovered]],[o.Jf.colorBrandForegroundLinkPressed,[n.Ve.themeDarker]],[o.Jf.colorBrandForegroundLinkSelected,[n.Ve.themeDarkAlt]],[o.Jf.colorNeutralForeground2Link,[n.Ve.neutralSecondary]],[o.Jf.colorNeutralForeground2LinkHover,[n.Ve.neutralPrimary]],[o.Jf.colorNeutralForeground2LinkPressed,[n.Ve.neutralPrimary]],[o.Jf.colorNeutralForeground2LinkSelected,[n.Ve.neutralPrimary]],[o.Jf.colorCompoundBrandForeground1,[n.Ve.themePrimary]],[o.Jf.colorCompoundBrandForeground1Hover,[n.Ve.themeDarkAlt]],[o.Jf.colorCompoundBrandForeground1Pressed,[n.Ve.themeDark]],[o.Jf.colorBrandForeground1,[n.Ve.themePrimary]],[o.Jf.colorBrandForeground2,[n.Ve.themeDarkAlt]],[o.Jf.colorNeutralForeground1Static,[n.Ve.neutralPrimary]],[o.Jf.colorNeutralForegroundInverted,[n.Ve.white]],[o.Jf.colorNeutralForegroundInvertedHover,[n.Ve.white]],[o.Jf.colorNeutralForegroundInvertedPressed,[n.Ve.white]],[o.Jf.colorNeutralForegroundInvertedSelected,[n.Ve.white]],[o.Jf.colorNeutralForegroundOnBrand,[n.Ve.white,n.KM.AccentButtonText,n.KM.InputForegroundChecked,n.KM.PrimaryButtonText,n.KM.PrimaryButtonTextHovered,n.KM.PrimaryButtonTextPressed]],[o.Jf.colorNeutralForegroundInvertedLink,[n.Ve.white]],[o.Jf.colorNeutralForegroundInvertedLinkHover,[n.Ve.white]],[o.Jf.colorNeutralForegroundInvertedLinkPressed,[n.Ve.white]],[o.Jf.colorNeutralForegroundInvertedLinkSelected,[n.Ve.white]],[o.Jf.colorNeutralForegroundInverted2,[n.Ve.white]],[o.Jf.colorBrandForegroundInverted,[n.Ve.themeSecondary]],[o.Jf.colorBrandForegroundInvertedHover,[n.Ve.themeTertiary]],[o.Jf.colorBrandForegroundInvertedPressed,[n.Ve.themeSecondary]],[o.Jf.colorBrandForegroundOnLight,[n.Ve.themePrimary]],[o.Jf.colorBrandForegroundOnLightHover,[n.Ve.themeDarkAlt]],[o.Jf.colorBrandForegroundOnLightPressed,[n.Ve.themeDark]],[o.Jf.colorBrandForegroundOnLightSelected,[n.Ve.themeDark]],[o.Jf.colorNeutralBackground1,[n.Ve.white,n.KM.BodyBackground,n.KM.BodyFrameBackground,n.KM.ButtonBackground,n.KM.CardStandoutBackground,n.KM.InputBackground,n.KM.ListBackground,n.KM.MenuBackground,n.KM.MenuItemBackgroundChecked]],[o.Jf.colorNeutralBackground1Hover,[n.Ve.neutralLighter,n.KM.BodyBackgroundHovered,n.KM.ButtonBackgroundCheckedHovered,n.KM.ButtonBackgroundHovered,n.KM.ListHeaderBackgroundHovered,n.KM.ListItemBackgroundHovered,n.KM.MenuItemBackgroundHovered,n.KM.MenuItemBackgroundPressed]],[o.Jf.colorNeutralBackground1Pressed,[n.Ve.neutralQuaternaryAlt,n.KM.ButtonBackgroundPressed,n.KM.ListHeaderBackgroundPressed]],[o.Jf.colorNeutralBackground1Selected,[n.Ve.neutralLight,n.KM.BodyBackgroundChecked,n.KM.ButtonBackgroundChecked,n.KM.ListItemBackgroundChecked,n.KM.ListItemBackgroundCheckedHovered]],[o.Jf.colorNeutralBackground2,[n.Ve.neutralLighterAlt,n.KM.BodyStandoutBackground,n.KM.DefaultStateBackground]],[o.Jf.colorNeutralBackground2Hover,[n.Ve.neutralLighter]],[o.Jf.colorNeutralBackground2Pressed,[n.Ve.neutralQuaternaryAlt]],[o.Jf.colorNeutralBackground2Selected,[n.Ve.neutralLight]],[o.Jf.colorNeutralBackground3,[n.Ve.neutralLighter]],[o.Jf.colorNeutralBackground3Hover,[n.Ve.neutralLight]],[o.Jf.colorNeutralBackground3Pressed,[n.Ve.neutralQuaternary]],[o.Jf.colorNeutralBackground3Selected,[n.Ve.neutralQuaternaryAlt]],[o.Jf.colorNeutralBackground4,[n.Ve.neutralLighter]],[o.Jf.colorNeutralBackground4Hover,[n.Ve.neutralLighterAlt]],[o.Jf.colorNeutralBackground4Pressed,[n.Ve.neutralLighter]],[o.Jf.colorNeutralBackground4Selected,[n.Ve.white]],[o.Jf.colorNeutralBackground5,[n.Ve.neutralLight]],[o.Jf.colorNeutralBackground5Hover,[n.Ve.neutralLighter]],[o.Jf.colorNeutralBackground5Pressed,[n.Ve.neutralLighter]],[o.Jf.colorNeutralBackground5Selected,[n.Ve.neutralLighterAlt]],[o.Jf.colorNeutralBackground6,[n.Ve.neutralLight]],[o.Jf.colorNeutralBackgroundInverted,[n.Ve.neutralSecondary]],[o.Jf.colorSubtleBackgroundHover,[n.Ve.neutralLighter]],[o.Jf.colorSubtleBackgroundPressed,[n.Ve.neutralQuaternaryAlt]],[o.Jf.colorSubtleBackgroundSelected,[n.Ve.neutralLight]],[o.Jf.colorNeutralBackgroundDisabled,[n.Ve.neutralLighter,n.KM.ButtonBackgroundDisabled,n.KM.DisabledBackground,n.KM.PrimaryButtonBackgroundDisabled]],[o.Jf.colorNeutralStencil1,[n.Ve.neutralLight]],[o.Jf.colorNeutralStencil2,[n.Ve.neutralLighterAlt]],[o.Jf.colorBrandBackground,[n.Ve.themePrimary,n.KM.AccentButtonBackground,n.KM.PrimaryButtonBackground]],[o.Jf.colorBrandBackgroundHover,[n.Ve.themeDarkAlt,n.KM.PrimaryButtonBackgroundHovered]],[o.Jf.colorBrandBackgroundPressed,[n.Ve.themeDarker,n.KM.PrimaryButtonBackgroundPressed]],[o.Jf.colorBrandBackgroundSelected,[n.Ve.themeDark]],[o.Jf.colorCompoundBrandBackground,[n.Ve.themePrimary,n.KM.InputBackgroundChecked]],[o.Jf.colorCompoundBrandBackgroundHover,[n.Ve.themeDarkAlt,n.KM.InputBackgroundCheckedHovered]],[o.Jf.colorCompoundBrandBackgroundPressed,[n.Ve.themeDark]],[o.Jf.colorBrandBackgroundStatic,[n.Ve.themePrimary]],[o.Jf.colorBrandBackground2,[n.Ve.themeLighterAlt]],[o.Jf.colorBrandBackgroundInverted,[n.Ve.white]],[o.Jf.colorBrandBackgroundInvertedHover,[n.Ve.themeLighterAlt]],[o.Jf.colorBrandBackgroundInvertedPressed,[n.Ve.themeLight]],[o.Jf.colorBrandBackgroundInvertedSelected,[n.Ve.themeLighter,n.KM.InputPlaceholderBackgroundChecked]],[o.Jf.colorNeutralStrokeAccessible,[n.Ve.neutralSecondary,n.KM.InputBorder]],[o.Jf.colorNeutralStrokeAccessibleHover,[n.Ve.neutralSecondary,n.KM.InputBorderHovered]],[o.Jf.colorNeutralStrokeAccessiblePressed,[n.Ve.neutralSecondary]],[o.Jf.colorNeutralStrokeAccessibleSelected,[n.Ve.themePrimary]],[o.Jf.colorNeutralStroke1,[n.Ve.neutralQuaternary,n.KM.ButtonBorder]],[o.Jf.colorNeutralStroke1Hover,[n.Ve.neutralTertiaryAlt]],[o.Jf.colorNeutralStroke1Pressed,[n.Ve.neutralTertiaryAlt]],[o.Jf.colorNeutralStroke1Selected,[n.Ve.neutralTertiaryAlt]],[o.Jf.colorNeutralStroke2,[n.Ve.neutralQuaternaryAlt,n.KM.BodyDivider,n.KM.BodyFrameDivider,n.KM.MenuDivider]],[o.Jf.colorNeutralStroke3,[n.Ve.neutralLighter]],[o.Jf.colorNeutralStrokeOnBrand,[n.Ve.white]],[o.Jf.colorNeutralStrokeOnBrand2,[n.Ve.white]],[o.Jf.colorNeutralStrokeOnBrand2Hover,[n.Ve.white]],[o.Jf.colorNeutralStrokeOnBrand2Pressed,[n.Ve.white]],[o.Jf.colorNeutralStrokeOnBrand2Selected,[n.Ve.white]],[o.Jf.colorBrandStroke1,[n.Ve.themePrimary]],[o.Jf.colorBrandStroke2,[n.Ve.themeLight]],[o.Jf.colorCompoundBrandStroke,[n.Ve.themePrimary,n.KM.InputFocusBorderAlt]],[o.Jf.colorCompoundBrandStrokeHover,[n.Ve.themeDarkAlt]],[o.Jf.colorCompoundBrandStrokePressed,[n.Ve.themeDark]],[o.Jf.colorNeutralStrokeDisabled,[n.Ve.neutralQuaternaryAlt,n.KM.ButtonBorderDisabled,n.KM.DisabledBorder]],[o.Jf.colorStrokeFocus2,[n.KM.FocusBorder]],[n.Ve.black,[o.Jf.colorStrokeFocus2,o.Jf.colorNeutralForeground1Selected]],[n.Ve.neutralDark,[o.Jf.colorNeutralForeground1Hover]],[n.Ve.neutralPrimary,[o.Jf.colorNeutralForeground1,o.Jf.colorNeutralStrokeAccessibleHover]],[n.Ve.neutralSecondary,[o.Jf.colorNeutralForeground2,o.Jf.colorNeutralForeground3,o.Jf.colorNeutralForeground4,o.Jf.colorNeutralStrokeAccessible]],[n.Ve.neutralSecondaryAlt,[o.Jf.colorNeutralStroke1]],[n.Ve.neutralTertiary,[o.Jf.colorNeutralForegroundDisabled]],[n.Ve.neutralLight,[o.Jf.colorNeutralBackground1Selected,o.Jf.colorNeutralBackground1Pressed,o.Jf.colorNeutralStroke2]],[n.Ve.neutralLighter,[o.Jf.colorNeutralStrokeDisabled,o.Jf.colorNeutralBackgroundDisabled,o.Jf.colorNeutralBackground1Hover]],[n.Ve.neutralLightAlt,[o.Jf.colorNeutralBackground2]],[n.Ve.neutralLight,[o.Jf.colorSubtleBackgroundPressed]],[n.Ve.neutralSecondary,[o.Jf.colorNeutralForeground2Selected]],[n.Ve.white,[o.Jf.colorStrokeFocus1,o.Jf.colorNeutralForegroundOnBrand,o.Jf.colorNeutralBackground1]],[n.Ve.themeDarker,[o.Jf.colorBrandForegroundLinkHover]],[n.Ve.themeDark,[o.Jf.colorCompoundBrandBackgroundHover,o.Jf.colorBrandBackgroundPressed]],[n.Ve.themeDarkAlt,[o.Jf.colorBrandBackgroundHover]],[n.Ve.themePrimary,[o.Jf.colorBrandBackground,o.Jf.colorCompoundBrandBackground,o.Jf.colorCompoundBrandStroke,o.Jf.colorBrandForegroundLink]],[n.Ve.themeLighter,[o.Jf.colorBrandBackgroundInvertedSelected]],[n.KM.AccentButtonBackground,[o.Jf.colorBrandBackground]],[n.KM.AccentButtonText,[o.Jf.colorNeutralForegroundOnBrand]],[n.KM.ActionLink,[o.Jf.colorNeutralForeground1]],[n.KM.ActionLinkHovered,[o.Jf.colorNeutralForeground1Hover]],[n.KM.BodyBackground,[o.Jf.colorNeutralBackground1]],[n.KM.BodyBackgroundChecked,[o.Jf.colorNeutralBackground1Selected]],[n.KM.BodyBackgroundHovered,[o.Jf.colorNeutralBackground1Hover]],[n.KM.BodyDivider,[o.Jf.colorNeutralStroke2]],[n.KM.BodyFrameBackground,[o.Jf.colorNeutralBackground1]],[n.KM.BodyFrameDivider,[o.Jf.colorNeutralStroke2]],[n.KM.BodyStandoutBackground,[o.Jf.colorNeutralBackground2]],[n.KM.BodySubtext,[o.Jf.colorNeutralForeground3]],[n.KM.BodyText,[o.Jf.colorNeutralForeground1]],[n.KM.BodyTextChecked,[o.Jf.colorNeutralForeground1Selected]],[n.KM.ButtonBackground,[o.Jf.colorNeutralBackground1]],[n.KM.ButtonBackgroundChecked,[o.Jf.colorNeutralBackground1Selected]],[n.KM.ButtonBackgroundCheckedHovered,[o.Jf.colorNeutralBackground1Hover]],[n.KM.ButtonBackgroundDisabled,[o.Jf.colorNeutralBackgroundDisabled]],[n.KM.ButtonBackgroundHovered,[o.Jf.colorNeutralBackground1Hover]],[n.KM.ButtonBackgroundPressed,[o.Jf.colorNeutralBackground1Pressed]],[n.KM.ButtonBorder,[o.Jf.colorNeutralStroke1]],[n.KM.ButtonBorderDisabled,[o.Jf.colorNeutralStrokeDisabled]],[n.KM.ButtonText,[o.Jf.colorNeutralForeground1]],[n.KM.ButtonTextChecked,[o.Jf.colorNeutralForeground1]],[n.KM.ButtonTextCheckedHovered,[o.Jf.colorNeutralForeground1]],[n.KM.ButtonTextDisabled,[o.Jf.colorNeutralForegroundDisabled]],[n.KM.ButtonTextHovered,[o.Jf.colorNeutralForeground1]],[n.KM.ButtonTextPressed,[o.Jf.colorNeutralForeground1]],[n.KM.CardStandoutBackground,[o.Jf.colorNeutralBackground1]],[n.KM.DefaultStateBackground,[o.Jf.colorNeutralBackground2]],[n.KM.DisabledBackground,[o.Jf.colorNeutralBackgroundDisabled]],[n.KM.DisabledBodySubtext,[o.Jf.colorNeutralForegroundDisabled]],[n.KM.DisabledBodySubtext,[o.Jf.colorNeutralForegroundDisabled]],[n.KM.DisabledBorder,[o.Jf.colorNeutralStrokeDisabled]],[n.KM.DisabledSubtext,[o.Jf.colorNeutralForegroundDisabled]],[n.KM.DisabledText,[o.Jf.colorNeutralForegroundDisabled]],[n.KM.FocusBorder,[o.Jf.colorStrokeFocus2]],[n.KM.InputBackground,[o.Jf.colorNeutralBackground1]],[n.KM.InputBackgroundChecked,[o.Jf.colorCompoundBrandBackground]],[n.KM.InputBackgroundCheckedHovered,[o.Jf.colorCompoundBrandBackgroundHover]],[n.KM.InputBorder,[o.Jf.colorNeutralStrokeAccessible]],[n.KM.InputBorderHovered,[o.Jf.colorNeutralStrokeAccessibleHover]],[n.KM.InputFocusBorderAlt,[o.Jf.colorCompoundBrandStroke]],[n.KM.InputForegroundChecked,[o.Jf.colorNeutralForegroundOnBrand]],[n.KM.InputIcon,[o.Jf.colorNeutralForeground3]],[n.KM.InputIconDisabled,[o.Jf.colorNeutralForegroundDisabled]],[n.KM.InputIconHovered,[o.Jf.colorNeutralForeground3]],[n.KM.InputPlaceholderBackgroundChecked,[o.Jf.colorBrandBackgroundInvertedSelected]],[n.KM.InputPlaceholderText,[o.Jf.colorNeutralForeground4]],[n.KM.InputText,[o.Jf.colorNeutralForeground1]],[n.KM.InputTextHovered,[o.Jf.colorNeutralForeground1Hover]],[n.KM.Link,[o.Jf.colorBrandForegroundLink]],[n.KM.LinkHovered,[o.Jf.colorBrandForegroundLinkHover]],[n.KM.ListBackground,[o.Jf.colorNeutralBackground1]],[n.KM.ListHeaderBackgroundHovered,[o.Jf.colorNeutralBackground1Hover]],[n.KM.ListHeaderBackgroundPressed,[o.Jf.colorNeutralBackground1Pressed]],[n.KM.ListItemBackgroundChecked,[o.Jf.colorNeutralBackground1Selected]],[n.KM.ListItemBackgroundCheckedHovered,[o.Jf.colorNeutralBackground1Selected]],[n.KM.ListItemBackgroundHovered,[o.Jf.colorNeutralBackground1Hover]],[n.KM.ListText,[o.Jf.colorNeutralForeground1]],[n.KM.ListTextColor,[o.Jf.colorNeutralForeground1]],[n.KM.MenuBackground,[o.Jf.colorNeutralBackground1]],[n.KM.MenuDivider,[o.Jf.colorNeutralStroke2]],[n.KM.MenuHeader,[o.Jf.colorNeutralForeground3]],[n.KM.MenuIcon,[o.Jf.colorNeutralForeground1]],[n.KM.MenuItemBackgroundChecked,[o.Jf.colorNeutralBackground1]],[n.KM.MenuItemBackgroundHovered,[o.Jf.colorNeutralBackground1Hover]],[n.KM.MenuItemBackgroundPressed,[o.Jf.colorNeutralBackground1Hover]],[n.KM.MenuItemText,[o.Jf.colorNeutralForeground1]],[n.KM.MenuItemTextHovered,[o.Jf.colorNeutralForeground2Hover]],[n.KM.MessageLink,[o.Jf.colorBrandForegroundLink]],[n.KM.MessageLinkHovered,[o.Jf.colorBrandForegroundLinkHover]],[n.KM.MessageText,[o.Jf.colorNeutralForeground1]],[n.KM.PrimaryButtonBackground,[o.Jf.colorBrandBackground]],[n.KM.PrimaryButtonBackgroundDisabled,[o.Jf.colorNeutralBackgroundDisabled]],[n.KM.PrimaryButtonBackgroundHovered,[o.Jf.colorBrandBackgroundHover]],[n.KM.PrimaryButtonBackgroundPressed,[o.Jf.colorBrandBackgroundPressed]],[n.KM.PrimaryButtonBorder,[o.Jf.colorTransparentStroke]],[n.KM.PrimaryButtonText,[o.Jf.colorNeutralForegroundOnBrand]],[n.KM.PrimaryButtonTextDisabled,[o.Jf.colorNeutralForegroundDisabled]],[n.KM.PrimaryButtonTextHovered,[o.Jf.colorNeutralForegroundOnBrand]],[n.KM.PrimaryButtonTextPressed,[o.Jf.colorNeutralForegroundOnBrand]]]),a=Object.keys(i.o).map(e=>({name:"--"+e,value:i.o[e]}))},13290:(e,t,r)=>{"use strict";r.d(t,{G:()=>n,S:()=>i});var o=r(44828);function n(e){var t=null;try{var r=(0,o.z)();t=r?r.sessionStorage.getItem(e):null}catch(n){}return t}function i(e,t){var r;try{null===(r=(0,o.z)())||void 0===r||r.sessionStorage.setItem(e,t)}catch(n){}}},13296:(e,t,r)=>{"use strict";r.d(t,{Cf:()=>l,k3:()=>s,qP:()=>c,wP:()=>d});var o=r(91947);const n="ms-ContextualMenu",i="ms-Callout";function s(e,t){e.defaultPrevented||"Escape"==e.key&&async function(e,t){const r=e.target;if(!r)return!1;if(r===a)return!t;if(a&&a.contains(r))return!1;if(function(e){for(;e;){var t;const r=null===(t=e)||void 0===t?void 0:t.className;if(r&&(r.indexOf(n)>-1||r.indexOf(i)>-1))return!0;e=e.parentElement}return!1}(r))return!1;return!0}(e,t).then(t=>{t&&((0,o.wL)(e.key),e.preventDefault())})}let a;function c(e){e&&(a=e)}function d(e){if(e.target&&a){const t=e.target;if(a.contains(t))return!0}return!1}function l(e){if(e.target&&a){return e.target===a}return!0}},13760:(e,t,r)=>{"use strict";t.b=void 0;var o=r(87987);Object.defineProperty(t,"b",{enumerable:!0,get:function(){return o.EventEmitter}})},14202:(e,t)=>{"use strict";var r=Symbol.for("react.element"),o=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),g=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,f={};function v(e,t,r){this.props=e,this.context=t,this.refs=f,this.updater=r||p}function y(){}function b(e,t,r){this.props=e,this.context=t,this.refs=f,this.updater=r||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var S=b.prototype=new y;S.constructor=b,m(S,v.prototype),S.isPureReactComponent=!0;var C=Array.isArray,k=Object.prototype.hasOwnProperty,w={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function T(e,t,o){var n,i={},s=null,a=null;if(null!=t)for(n in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(s=""+t.key),t)k.call(t,n)&&!P.hasOwnProperty(n)&&(i[n]=t[n]);var c=arguments.length-2;if(1===c)i.children=o;else if(1<c){for(var d=Array(c),l=0;l<c;l++)d[l]=arguments[l+2];i.children=d}if(e&&e.defaultProps)for(n in c=e.defaultProps)void 0===i[n]&&(i[n]=c[n]);return{$$typeof:r,type:e,key:s,ref:a,props:i,_owner:w.current}}function E(e){return"object"===typeof e&&null!==e&&e.$$typeof===r}var N=/\/+/g;function I(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function D(e,t,n,i,s){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var c=!1;if(null===e)c=!0;else switch(a){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case r:case o:c=!0}}if(c)return s=s(c=e),e=""===i?"."+I(c,0):i,C(s)?(n="",null!=e&&(n=e.replace(N,"$&/")+"/"),D(s,t,n,"",function(e){return e})):null!=s&&(E(s)&&(s=function(e,t){return{$$typeof:r,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,n+(!s.key||c&&c.key===s.key?"":(""+s.key).replace(N,"$&/")+"/")+e)),t.push(s)),1;if(c=0,i=""===i?".":i+":",C(e))for(var d=0;d<e.length;d++){var l=i+I(a=e[d],d);c+=D(a,t,n,l,s)}else if(l=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=g&&e[g]||e["@@iterator"])?e:null}(e),"function"===typeof l)for(e=l.call(e),d=0;!(a=e.next()).done;)c+=D(a=a.value,t,n,l=i+I(a,d++),s);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return c}function F(e,t,r){if(null==e)return e;var o=[],n=0;return D(e,o,"","",function(e){return t.call(r,e,n++)}),o}function B(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var L={current:null},x={transition:null},A={ReactCurrentDispatcher:L,ReactCurrentBatchConfig:x,ReactCurrentOwner:w};t.Children={map:F,forEach:function(e,t,r){F(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return F(e,function(){t++}),t},toArray:function(e){return F(e,function(e){return e})||[]},only:function(e){if(!E(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=n,t.Profiler=s,t.PureComponent=b,t.StrictMode=i,t.Suspense=l,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=A,t.cloneElement=function(e,t,o){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=m({},e.props),i=e.key,s=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,a=w.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(d in t)k.call(t,d)&&!P.hasOwnProperty(d)&&(n[d]=void 0===t[d]&&void 0!==c?c[d]:t[d])}var d=arguments.length-2;if(1===d)n.children=o;else if(1<d){c=Array(d);for(var l=0;l<d;l++)c[l]=arguments[l+2];n.children=c}return{$$typeof:r,type:e.type,key:i,ref:s,props:n,_owner:a}},t.createContext=function(e){return(e={$$typeof:c,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=T,t.createFactory=function(e){var t=T.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:d,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:B}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=x.transition;x.transition={};try{e()}finally{x.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return L.current.useCallback(e,t)},t.useContext=function(e){return L.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return L.current.useDeferredValue(e)},t.useEffect=function(e,t){return L.current.useEffect(e,t)},t.useId=function(){return L.current.useId()},t.useImperativeHandle=function(e,t,r){return L.current.useImperativeHandle(e,t,r)},t.useInsertionEffect=function(e,t){return L.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return L.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return L.current.useMemo(e,t)},t.useReducer=function(e,t,r){return L.current.useReducer(e,t,r)},t.useRef=function(e){return L.current.useRef(e)},t.useState=function(e){return L.current.useState(e)},t.useSyncExternalStore=function(e,t,r){return L.current.useSyncExternalStore(e,t,r)},t.useTransition=function(){return L.current.useTransition()},t.version="18.3.0"},14365:(e,t,r)=>{"use strict";r.d(t,{c:()=>o});const o=async e=>new Promise(t=>setTimeout(()=>t(),e))},14818:(e,t,r)=>{"use strict";r.d(t,{x:()=>o});const o="IFluidDependencySynthesizer"},14826:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});const o={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let n;const i=new Uint8Array(16);function s(){if(!n&&(n="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!n))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(i)}const a=[];for(let l=0;l<256;++l)a.push((l+256).toString(16).slice(1));function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return a[e[t+0]]+a[e[t+1]]+a[e[t+2]]+a[e[t+3]]+"-"+a[e[t+4]]+a[e[t+5]]+"-"+a[e[t+6]]+a[e[t+7]]+"-"+a[e[t+8]]+a[e[t+9]]+"-"+a[e[t+10]]+a[e[t+11]]+a[e[t+12]]+a[e[t+13]]+a[e[t+14]]+a[e[t+15]]}const d=function(e,t,r){if(o.randomUUID&&!t&&!e)return o.randomUUID();const n=(e=e||{}).random||(e.rng||s)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return c(n)}},14836:(e,t,r)=>{"use strict";r.d(t,{r:()=>s});var o=r(83125),n=r(5667),i=r(95720);function s(e,t){const r=t&&new o.p(i.Ak,t);return{claims:e.claims,forceRefresh:e.refresh,siteUrl:e.siteUrl,driveId:e.driveId,itemId:e.itemId,request:e.request||null,tenantId:e.tenantId||(0,n.n)(e.siteUrl,r)}}},15217:(e,t,r)=>{"use strict";function o(e,t){e||function(e){const t=new Error("number"===typeof e?`0x${e.toString(16).padStart(3,"0")}`:e);throw n(t),t}(t)}function n(e){for(const t of i)t(e)}r.d(t,{aT:()=>s,vA:()=>o});const i=new Set;function s(e){c(()=>{if(a){const t=e();if(!0!==t){const e=new Error(`Debug assert failed: ${t.toString()}`);throw n(e),e}}})}let a=!1;function c(e){}},15834:(e,t,r)=>{"use strict";r.d(t,{x:()=>be,p:()=>ye});var o=r(21856),n=r(61865);var i=r(39773);class s{get IFluidDataStoreRegistry(){return this}constructor(e){this.map=new Map;for(const t of e){if(this.map.has(t[0]))throw new i.eb("Duplicate entry names exist");this.map.set(t[0],t[1])}}async get(e){if(this.map.has(e))return this.map.get(e)}getSync(e){const t=this.map.get(e);if(!(e=>"object"===typeof e&&null!==e)(r=t)||!("then"in r)||"function"!==typeof r.then)return t;var r}}var a=r(15217),c=r(93023),d=r(19688);class l{constructor(){this.completed=!1,this.p=new Promise((e,t)=>{this.res=e,this.rej=t})}get isCompleted(){return this.completed}get promise(){return this.p}resolve(e){void 0!==this.res&&(this.completed=!0,this.res(e))}reject(e){void 0!==this.rej&&(this.completed=!0,this.rej(e))}}var u=r(78945),h=r(77565),g=r(27750),p=r(26631),m=r(97423),f=r(45852);function v(e,t,r){const o=[];for(const n of t){const t=`${e}${n.path}`;if(n.type===m.$.Blob){const e=n.value,i=(0,p.Xg)(e.contents,e.encoding),s=(0,f.A)();r.set(s,i);const a={mode:m.S[n.mode],path:t,sha:s,size:0,type:"blob",url:""};o.push(a)}else if(n.type===m.$.Tree){(0,a.vA)(n.type===m.$.Tree,257);const e=n.value,i={mode:m.S[n.mode],path:t,sha:"",size:-1,type:"tree",url:""};o.push(i);const s=v(`${t}/`,e.entries,r);o.push(...s)}}return o}function y(e,t){return{sha:"",tree:v("",e,t),url:""}}function b(e,t){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o={},n={id:e.sha,blobs:{},trees:{}};o[""]=n;for(const i of e.tree){const e=r?i.path.replace(/^\.app\//,""):i.path,n=e.lastIndexOf("/"),s=e.slice(0,Math.max(0,n)),a=e.slice(n+1),c=o[s];if("tree"===i.type){const t={id:i.sha,blobs:{},commits:{},trees:{}};c.trees[decodeURIComponent(a)]=t,o[e]=t}else{if("blob"!==i.type)throw new Error("Unknown entry type!!");c.blobs[decodeURIComponent(a)]=i.sha,t.set(i.sha,`/${e}`)}}return n}(y(e,t))}var S,C,k=r(60295);!function(e){e[e.Immediate=0]="Immediate",e[e.TurnBased=1]="TurnBased"}(S||(S={})),function(e){e[e.Async=2]="Async"}(C||(C={}));const w="NotVisible",P="LocallyVisible",T="GloballyVisible";var E=r(7428),N=r(24907),I=r(29951);class D{static getPathParts(e){const t=e.indexOf("?");return e.substring(0,t<0?e.length:t).split("/").reduce((e,t)=>(void 0!==t&&t.length>0&&e.push(decodeURIComponent(t)),e),[])}static create(e){return e instanceof D?e:new D(e)}constructor(e){this.request=e;const t=this.request.url.indexOf("?");this.query=t>=0?this.request.url.substring(t):"",void 0!==e.headers&&(this.headers=e.headers)}get url(){return this.request.url}get pathParts(){return void 0===this.requestPathParts&&(this.requestPathParts=D.getPathParts(this.url)),this.requestPathParts}isLeaf(e){return""===this.query&&this.pathParts.length===e}createSubRequest(e){const t=this.pathParts.length;if(e<0||e>t)throw new Error("incorrect sub-request");if(e===t&&this.url.includes("?"))return{url:`/${this.query}`,headers:this.headers};const r=`/${this.pathParts.slice(e).join("/")}`;return{url:""===this.query?r:`${r}/${this.query}`,headers:this.headers}}}var F=r(19984),B=r(4041),L=r(15894),x=r(52389);var A=r(17637),O=r(74621);var M=r(50178),_=r(86748);const R=Symbol();function H(e){return Array.isArray(e)&&R in e&&e[R]===R}function U(e,t,r){if(H(t))for(const{contents:o,metadata:n}of t)r(o,n);else r(e,t)}class j{get handler(){return(0,a.vA)(!!this._handler,375),this._handler}get connected(){return this._connected}constructor(e,t,r,o){this._connected=e,this.submitFn=t,this.dirty=r,this.isAttachedAndVisible=o}attach(e){(0,a.vA)(void 0===this._handler,376),this._handler=e}setConnectionState(e){this._connected=e,this.handler.setConnectionState(e)}processMessages(e){try{const t=function(e){const t=[];for(const r of e)if(H(r.localOpMetadata))for(const{contents:e,metadata:o}of r.localOpMetadata)t.push({contents:e,localOpMetadata:o,clientSequenceNumber:r.clientSequenceNumber});else t.push(r);return t}(e.messagesContent);this.handler.processMessages({...e,messagesContent:t})}catch(t){throw i.I9.wrapIfUnrecognized(t,"channelDeltaConnectionFailedToProcessMessages",e.envelope)}}reSubmit(e,t,r){U(e,t,(e,t)=>this.handler.reSubmit(e,t,r))}rollback(e,t){if(void 0===this.handler.rollback)throw new Error("Handler doesn't support rollback");U(e,t,this.handler.rollback.bind(this.handler))}applyStashedOp(e){try{return this.stashedOpMd=this.isAttachedAndVisible()?function(){const e=[];return Object.defineProperty(e,R,{value:R,writable:!1,enumerable:!0}),e}():void 0,this.handler.applyStashedOp(e),this.stashedOpMd}finally{this.stashedOpMd=void 0}}submit(e,t){void 0===this.stashedOpMd?this.submitFn(e,t):this.stashedOpMd.push({contents:e,metadata:t})}}function q(e){let t=e;return t.startsWith("/")&&(t=t.substr(1)),t.endsWith("/")&&(t=t.substr(0,t.length-1)),t.length>0?t.split("/"):[]}class z{static flattenTree(e,t,r){for(const[o,n]of Object.entries(t.trees))z.flattenTree(`${e}${o}/`,n,r);for(const[o,n]of Object.entries(t.blobs))r[`${e}${o}`]=n}constructor(e,t,r,o){this.tree=e,this.storage=t,this.logger=r,this.extraBlobs=o,this.flattenedTree={},void 0!==e&&z.flattenTree("",e,this.flattenedTree)}async contains(e){return void 0!==this.flattenedTree[e]}async readBlob(e){const t=await this.getIdForPath(e);(0,a.vA)(void 0!==t,2519);const r=void 0===this.extraBlobs?void 0:this.extraBlobs.get(t);if(void 0!==r)return r;const o=this.storage.readBlob(t);return o.catch(e=>this.logger.sendErrorEvent({eventName:"ChannelStorageBlobError"},e)),o}async list(e){let t=this.tree;const r=q(e);for(;void 0!==t&&r.length>0;){const e=r.shift();t=t.trees[e]}if(void 0===t||r.length>0)throw new Error("path does not exist");return Object.keys(t?.blobs??{})}getSnapshotTree(){return this.tree}async getIdForPath(e){return this.flattenedTree[e]}}const V=".attributes";function $(e,t,r,o,n,i,s,a){return{deltaConnection:new j(e,(e,r)=>t(e,r),r,o),objectStorage:new z(s,n,i,a)}}function G(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3?arguments[3]:void 0;const n=e.getAttachSummary(t,r,o);return(0,x.su)(n,V,JSON.stringify(e.attributes)),n}async function W(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0;const i=await e.summarize(t,r,o,n);return(0,x.su)(i,V,JSON.stringify(e.attributes)),i}async function J(e,t,r,o,n){let s;await t.objectStorage.contains(V)&&(s=await(0,_.P)(t.objectStorage,V));const a=s?s.type:n;if(void 0===a)throw new i.EW("channelTypeNotAvailable",(0,M.Df)({channelId:r,dataStoreId:e.id,dataStorePackagePath:e.packagePath.join("/"),channelFactoryType:a}));const c=o.get(a);if(void 0===c)throw new i.EW("channelFactoryNotRegisteredForGivenType",(0,M.Df)({channelId:r,dataStoreId:e.id,dataStorePackagePath:e.packagePath.join("/"),channelFactoryType:a}));return s=s??c.attributes,{factory:c,attributes:s}}async function K(e,t,r,o,n,i){return void 0!==t.snapshotFormatVersion&&t.snapshotFormatVersion!==r.attributes.snapshotFormatVersion&&n.sendTelemetryEvent({eventName:"ChannelAttributesVersionMismatch",...(0,M.Df)({channelType:t.type,channelSnapshotVersion:`${t.snapshotFormatVersion}@${t.packageVersion}`,channelCodeVersion:`${r.attributes.snapshotFormatVersion}@${r.attributes.packageVersion}`})}),r.load(e,i,o,t)}const Q={supportedFeatures:new Set,generation:0,pkgVersion:"unknown"};const Y="2.51.0",Z={pkgVersion:Y,generation:1},X={...Z,supportedFeatures:new Set},ee={minSupportedGeneration:0,requiredFeatures:[]};function te(e,t){const r=function(e,t){const r=t??Q;let o=!0;const n=[];r.generation<e.minSupportedGeneration&&(o=!1);for(const i of e.requiredFeatures)r.supportedFeatures.has(i)||n.push(i);return o&&0===n.length?{isCompatible:!0}:{isCompatible:!1,isGenerationCompatible:o,unsupportedFeatures:n.length>0?n:void 0}}(ee,e);if(!r.isCompatible){const o=new i.eb("DataStore is not compatible with Runtime",{errorDetails:JSON.stringify({dataStoreVersion:Z.pkgVersion,runtimeVersion:e?.pkgVersion,dataStoreGeneration:Z.generation,runtimeGeneration:e?.generation,minSupportedGeneration:ee.minSupportedGeneration,isGenerationCompatible:r.isGenerationCompatible,unsupportedFeatures:r.unsupportedFeatures})});throw t(),o}}var re,oe=r(98483);class ne{constructor(e,t,r,o,n){this.id=e,this.runtime=t,this.services=r,this.channelP=o,this._channel=n,this.globallyVisible=!1,this.pendingMessagesState={messageCollections:[],pendingCount:0},(0,a.vA)(!this.id.includes("/"),783)}get isGloballyVisible(){return this.globallyVisible}async getChannel(){return void 0===this._channel?this.channelP.then(e=>this._channel=e):this.channelP}get isLoaded(){return void 0!==this._channel}setConnectionState(e,t){this.globallyVisible&&this.isLoaded&&this.services.value.deltaConnection.setConnectionState(e)}processMessages(e){if((0,a.vA)(this.globallyVisible,723),this.isLoaded)this.services.value.deltaConnection.processMessages(e);else{(0,a.vA)(!e.local,393);const t={...e,messagesContent:[...e.messagesContent]};this.pendingMessagesState.messageCollections.push(t)}}reSubmit(e,t,r){(0,a.vA)(this.isLoaded,394),(0,a.vA)(this.globallyVisible,724),this.services.value.deltaConnection.reSubmit(e,t,r)}rollback(e,t){(0,a.vA)(this.isLoaded,750),(0,a.vA)(this.globallyVisible,751),this.services.value.deltaConnection.rollback(e,t)}async summarize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0;return W(await this.getChannel(),e,t,r)}getAttachSummary(e){return(0,a.vA)(void 0!==this._channel,397),G(this._channel,!0,!1,e)}getAttachGCData(e){return(0,a.vA)(void 0!==this._channel,2301),this._channel.getGCData(!0)}makeVisible(){if(this.globallyVisible)throw new Error("Channel is already globally visible");this.isLoaded&&((0,a.vA)(!!this._channel,402),this._channel.connect(this.services.value)),this.globallyVisible=!0}async getGCData(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(await this.getChannel()).getGCData(e)}updateUsedRoutes(e){}}class ie extends ne{constructor(e,t,r,o,n,s,a,c,d,l){super(e,r,new u.d(()=>{const e=new Map(l),t=ae(this.snapshotTree);return this.isSnapshotInOldFormatAndCollectBlobs(t,e)&&this.sanitizeSnapshot(t),$(o.connected,a,this.dirtyFn,()=>this.isGloballyVisible,n,s,t,e)}),new u.I(async()=>{try{const{attributes:e,factory:n}=await J(o,this.services.value,this.id,t),i=await K(r,e,n,this.services.value,s,this.id);for(const t of this.pendingMessagesState.messageCollections)this.services.value.deltaConnection.processMessages(t);return i}catch(e){throw i.I9.wrapIfUnrecognized(e,"rehydratedLocalChannelContextFailedToLoadChannel",void 0)}})),this.snapshotTree=d,this.dirtyFn=()=>{c(e)}}applyStashedOp(e){return this.services.value.deltaConnection.applyStashedOp(e)}isSnapshotInOldFormatAndCollectBlobs(e,t){let r=!1;const o=e.blobsContents;if(void 0!==o)for(const[n,i]of Object.entries(o))t.set(n,i),void 0!==e.blobs[n]&&(r=!0);for(const n of Object.values(e.trees))r=r||this.isSnapshotInOldFormatAndCollectBlobs(n,t);return r}sanitizeSnapshot(e){const t=new Map(Object.entries(e.blobs));for(const[r,o]of t.entries()){void 0===t.get(o)&&delete e.blobs[r]}for(const r of Object.values(e.trees))this.sanitizeSnapshot(r)}}class se extends ne{constructor(e,t,r,o,n,i,s){super(e.id,t,new u.d(()=>$(r.connected,i,this.dirtyFn,()=>this.isGloballyVisible,o,n)),Promise.resolve(e),e),this.channel=e,this.channel=e,this.dirtyFn=()=>{s(e.id)}}applyStashedOp(){throw new Error("no stashed ops on local channel")}}function ae(e){const t={...e,blobs:{...e.blobs},trees:{}};for(const[r,o]of Object.entries(e.trees))t.trees[r]=ae(o);return t}class ce{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;this.threshold=e,this.logger=t,this.thresholdMultiple=r}send(e,t){t<this.threshold||this.logger.sendPerformanceEvent({eventName:e,value:t})}sendIfMultiple(e,t){t===this.thresholdMultiple&&(this.logger.sendPerformanceEvent({eventName:e,value:t}),this.thresholdMultiple=2*this.thresholdMultiple)}}class de{constructor(e,t,r,o,n,i,s,c,l,h,g){this.id=i,this.isLoaded=!1,this.pendingMessagesState={messageCollections:[],pendingCount:0},(0,a.vA)(!this.id.includes("/"),784),this.subLogger=(0,M.pW)({logger:e.logger,namespace:"RemoteChannelContext"}),this.services=$(t.connected,o,()=>n(this.id),()=>e.attachState!==d.d.Detached,r,this.subLogger,s,l),this.channelP=new u.I(async()=>{const{attributes:r,factory:o}=await J(t,this.services,this.id,c,g),n=await K(e,r,o,this.services,this.subLogger,this.id);(0,a.vA)(void 0!==this.pendingMessagesState,2668);for(const e of this.pendingMessagesState.messageCollections)this.services.deltaConnection.processMessages(e);return this.thresholdOpsCounter.send("ProcessPendingOps",this.pendingMessagesState.pendingCount),this.channel=n,this.pendingMessagesState=void 0,this.isLoaded=!0,this.services.deltaConnection.setConnectionState(t.connected),this.channel}),this.summarizerNode=h(async(e,t,r,o)=>this.summarizeInternal(e,t,r,o),async e=>this.getGCDataInternal(e)),this.thresholdOpsCounter=new ce(de.pendingOpsCountThreshold,this.subLogger)}getChannel(){return this.channelP}setConnectionState(e,t){this.isLoaded&&this.services.deltaConnection.setConnectionState(e)}applyStashedOp(e){return(0,a.vA)(this.isLoaded,404),this.services.deltaConnection.applyStashedOp(e)}processMessages(e){const{envelope:t,messagesContent:r,local:o}=e;this.summarizerNode.invalidate(t.sequenceNumber),this.isLoaded?this.services.deltaConnection.processMessages(e):((0,a.vA)(!o,405),(0,a.vA)(void 0!==this.pendingMessagesState,2669),this.pendingMessagesState.messageCollections.push({...e,messagesContent:[...r]}),this.pendingMessagesState.pendingCount+=r.length,this.thresholdOpsCounter.sendIfMultiple("StorePendingOps",this.pendingMessagesState.pendingCount))}reSubmit(e,t,r){(0,a.vA)(this.isLoaded,406),this.services.deltaConnection.reSubmit(e,t,r)}rollback(e,t){(0,a.vA)(this.isLoaded,752),this.services.deltaConnection.rollback(e,t)}async summarize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0;return this.summarizerNode.summarize(e,t,r)}async summarizeInternal(e,t,r,o){const n=await this.getChannel();return{...await W(n,e,t,r,o),id:this.id}}async getGCData(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.summarizerNode.getGCData(e)}async getGCDataInternal(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(await this.getChannel()).getGCData(e)}updateUsedRoutes(e){this.summarizerNode.updateUsedRoutes([""])}}function le(e,t){const{ILayerCompatDetails:r}=e;return r?.supportedFeatures.has(t)??!1}de.pendingOpsCountThreshold=1e3,function(e){e.Attach="attach",e.ChannelOp="op"}(re||(re={}));const ue={readonlyInStagingMode:!0};class he extends c.X{get connected(){return this.dataStoreContext.connected}get clientId(){return this.dataStoreContext.clientId}get clientDetails(){return this.dataStoreContext.clientDetails}get isAttached(){return this.attachState!==d.d.Detached}get attachState(){return this._attachState}get absolutePath(){return(0,N.a)(this.id,this.routeContext)}get routeContext(){return this.dataStoreContext.IFluidHandleContext}get idCompressor(){return this.dataStoreContext.idCompressor}get IFluidHandleContext(){return this}get rootRoutingContext(){return this}get channelsRoutingContext(){return this}get objectsRoutingContext(){return this}get disposed(){return this._disposed}get logger(){return this.mc.logger}constructor(e,t,r,o,n){super(),this.dataStoreContext=e,this.sharedObjectRegistry=t,this.isReadOnly=()=>this._readonly,this._disposed=!1,this.contexts=new Map,this.pendingAttach=new Set,this.deferredAttached=new l,this.localChannelContextQueue=new Map,this.notBoundedChannelContextSet=new Set,this.pendingHandlesToMakeVisible=new Set,this.ILayerCompatDetails=X,this.pendingOpCount=function(){let e=0;return{get value(){return e},set value(t){(0,a.vA)(t>=0,3005),e=t}}}(),(0,a.vA)(!e.id.includes("/"),782),this.policies={...ue,...n};const{ILayerCompatDetails:i}=e;te(i,this.dispose.bind(this)),le(e,"notifiesReadOnlyState")?this._readonly=e.isReadOnly():(this._readonly=!0===this.dataStoreContext.deltaManager.readOnlyInfo.readonly,this.dataStoreContext.deltaManager.on("readonly",e=>this.notifyReadOnlyState(e))),this.submitMessagesWithoutEncodingHandles=le(e,"encodeHandlesInContainerRuntime"),(0,a.aT)(()=>void 0!==this.submitMessagesWithoutEncodingHandles),this.mc=(0,A.CL)({logger:e.baseLogger,namespace:"FluidDataStoreRuntime",properties:{all:{dataStoreId:(0,f.A)(),dataStoreVersion:Y}}}),this.id=e.id,this.options=e.options,this.deltaManagerInternal=e.deltaManager,this.quorum=e.getQuorum(),this.audience=e.getAudience();const s=e.baseSnapshot;if(void 0!==s?.trees)for(const[a,c]of Object.entries(s.trees)){if("_search"===a)continue;let t;e.isLocalDataStore?(t=this.createRehydratedLocalChannelContext(a,c),e.attachState===d.d.Detached?this.localChannelContextQueue.set(a,t):t.makeVisible()):t=new de(this,e,e.storage,(e,t)=>this.submitChannelOp(a,e,t),e=>this.setChannelDirty(e),a,c,this.sharedObjectRegistry,void 0,this.dataStoreContext.getCreateChildSummarizerNodeFn(a,{type:k.nL.FromSummary})),this.contexts.set(a,t)}this.entryPoint=new oe.a(new u.I(async()=>o(this)),"",this.objectsRoutingContext),this.attachListener(),this._attachState=e.attachState,this.visibilityState=r?e.attachState===d.d.Detached?P:T:w,r&&this.deferredAttached.resolve(),this.localChangesTelemetryCount=this.mc.config.getNumber("Fluid.Telemetry.LocalChangesTelemetryCount")??10,this.inStagingMode,this.isDirty}get inStagingMode(){return this.dataStoreContext.containerRuntime?.inStagingMode}get isDirty(){return this.pendingOpCount.value>0}get deltaManager(){return(0,I.P)(this.deltaManagerInternal)}dispose(){this._disposed||(this._disposed=!0,this.emit("dispose"),this.removeAllListeners())}async resolveHandle(e){return this.request(e)}async request(e){try{const r=D.create(e);if(0===r.pathParts.length&&!0===e.headers?.viaHandle)return{mimeType:"fluid/object",status:200,value:await this.entryPoint.get()};const o=r.pathParts[0];if("_channels"===o||"_custom"===o)return await this.request(r.createSubRequest(1));if(void 0!==o){const n=this.contexts.get(o);if(void 0!==n&&r.isLeaf(1))try{return{mimeType:"fluid/object",status:200,value:await n.getChannel()}}catch(t){return this.mc.logger.sendErrorEvent({eventName:"GetChannelFailedInRequest"},t),(0,F.wx)(500,`Failed to get Channel: ${t}`,e)}}return(0,F.or)(e)}catch(t){return(0,F.Yj)(t)}}async getChannel(e){this.verifyNotClosed();const t=this.contexts.get(e);if(void 0===t)throw new O.iq("Channel does not exist");return t.getChannel()}validateChannelId(e){if(e.includes("/"))throw new i.eb(`Id cannot contain slashes: ${e}`);if(e.startsWith("_"))throw new i.eb(`Id cannot start with underscore: ${e}`)}addChannel(e){const t=e.id;this.validateChannelId(t),this.verifyNotClosed(),(0,a.vA)(!this.contexts.has(t),2149);const r=e.attributes.type;if(void 0===this.sharedObjectRegistry.get(e.attributes.type))throw new Error(`Channel Factory ${r} not registered`);this.createChannelContext(e),this.identifyLocalChangeInSummarizer("DDSCreatedInSummarizer",t,r)}createChannel(e,t){let r;if(void 0===e){if(!0===this.mc.config.getBoolean("Fluid.Runtime.DisableShortIds"))r=(0,f.A)();else if(this.visibilityState===T){const e=this.dataStoreContext.containerRuntime.generateDocumentUniqueId?.()??(0,f.A)();r="number"===typeof e?(0,B.Z_)(2*e+1,"_"):e}else r=(0,B.Z_)(2*this.contexts.size,"_");(0,a.vA)(!r.includes("/"),2300)}else r=e,this.validateChannelId(r);this.verifyNotClosed(),(0,a.vA)(!this.contexts.has(r),377),(0,a.vA)(void 0!==t,521);const o=this.sharedObjectRegistry.get(t);if(void 0===o)throw new Error(`Channel Factory ${t} not registered`);const n=o.create(this,r);return this.createChannelContext(n),this.identifyLocalChangeInSummarizer("DDSCreatedInSummarizer",r,t),n}createChannelContext(e){this.notBoundedChannelContextSet.add(e.id);const t=new se(e,this,this.dataStoreContext,this.dataStoreContext.storage,this.logger,(t,r)=>this.submitChannelOp(e.id,t,r),e=>this.setChannelDirty(e));this.contexts.set(e.id,t)}createRehydratedLocalChannelContext(e,t,r){return new ie(e,this.sharedObjectRegistry,this,this.dataStoreContext,this.dataStoreContext.storage,this.logger,(t,r)=>this.submitChannelOp(e,t,r),e=>this.setChannelDirty(e),t,r)}bindChannel(e){(0,a.vA)(this.notBoundedChannelContextSet.has(e.id),379),this.notBoundedChannelContextSet.delete(e.id),this.isAttached?this.makeChannelLocallyVisible(e):this.pendingHandlesToMakeVisible.has((0,L.Fz)(e.handle))||(this.bind(e.handle),this.localChannelContextQueue.has(e.id)||this.localChannelContextQueue.set(e.id,this.contexts.get(e.id)))}makeVisibleAndAttachGraph(){if(this.visibilityState===w){this.visibilityState=P;for(const e of this.pendingHandlesToMakeVisible)e.attachGraph();this.pendingHandlesToMakeVisible.clear(),this.dataStoreContext.makeLocallyVisible()}}attachGraph(){this.makeVisibleAndAttachGraph()}bind(e){this.visibilityState===w?this.pendingHandlesToMakeVisible.add((0,L.Fz)(e)):(0,L.Fz)(e).attachGraph()}setConnectionState(e,t){this.verifyNotClosed();for(const[,r]of this.contexts)r.setConnectionState(e,t);!function(e,t,r,o,n){try{r?t.emit("connected",o):t.emit("disconnected",n)}catch(i){e.sendErrorEvent({eventName:"RaiseConnectedEventError"},i)}}(this.logger,this,e,t)}notifyReadOnlyState(e){this.verifyNotClosed(),e!==this._readonly&&(this._readonly=e,this.emit("readonly",e))}getQuorum(){return this.quorum}getAudience(){return this.audience}async uploadBlob(e,t){return this.verifyNotClosed(),this.dataStoreContext.uploadBlob(e,t)}createRemoteChannelContext(e,t){const r=new Map,o=b(e.snapshot.entries,r);return new de(this,this.dataStoreContext,this.dataStoreContext.storage,(t,r)=>this.submitChannelOp(e.id,t,r),e=>this.setChannelDirty(e),e.id,o,this.sharedObjectRegistry,r,this.dataStoreContext.getCreateChildSummarizerNodeFn(e.id,t),e.type)}processChannelMessages(e){let t;this.verifyNotClosed();let r=[];const{messagesContent:o,local:n,envelope:i}=e,s=()=>{if(void 0===t)return;const e=this.contexts.get(t);(0,a.vA)(!!e,2667),e.processMessages({envelope:i,messagesContent:r,local:n}),r=[]};for(const{contents:a,...c}of o){const e=a;t!==e.address&&s(),r.push({contents:e.contents,...c}),t=e.address}s()}processAttachMessages(e){const{envelope:t,messagesContent:r,local:o}=e;for(const{contents:n}of r){const e=n,r=e.id;if((0,x.eK)(e.snapshot,(e,o)=>{const n=`/${this.id}/${r}${"/"===e?"":e}`;this.dataStoreContext.addedGCOutboundRoute(n,o,t.timestamp)}),o)(0,a.vA)(this.pendingAttach.delete(r),380);else{(0,a.vA)(!this.contexts.has(r),381);const o={type:k.nL.FromAttach,sequenceNumber:t.sequenceNumber,snapshot:e.snapshot},n=this.createRemoteChannelContext(e,o);this.contexts.set(r,n)}}}processMessages(e){this.verifyNotClosed();const{envelope:t,local:r,messagesContent:o}=e;r&&(this.pendingOpCount.value-=o.length);try{switch(t.type){case re.ChannelOp:this.processChannelMessages(e);break;case re.Attach:this.processAttachMessages(e)}}catch(n){throw i.I9.wrapIfUnrecognized(n,"fluidDataStoreRuntimeFailedToProcessMessage",t)}for(const{contents:i,clientSequenceNumber:s}of o)this.emit("op",{...t,contents:i,clientSequenceNumber:s})}processSignal(e,t){this.emit("signal",e,t)}isChannelAttached(e){return!this.notBoundedChannelContextSet.has(e)&&!this.localChannelContextQueue.has(e)&&!this.pendingAttach.has(e)}getOutboundRoutes(){const e=[];for(const[t]of this.contexts)e.push(`${this.absolutePath}/${t}`);return e}updateGCNodes(e){e.addRouteToAllNodes(this.absolutePath),e.addNode("/",this.getOutboundRoutes())}async summarize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0;const o=new x.qt;return await this.visitContextsDuringSummary(async(n,i)=>{const s=await i.summarize(e,t,r);o.addWithStats(n,s)}),o.getSummaryTree()}async getGCData(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=new x.EI;return await this.visitContextsDuringSummary(async(r,o)=>{const n=await o.getGCData(e);t.prefixAndAddNodes(r,n.gcNodes)}),this.updateGCNodes(t),t.getGCData()}updateUsedRoutes(e){const t=function(e){const t=e.filter(e=>""!==e&&"/"!==e),r=new Map;for(const o of t){(0,a.vA)(o.startsWith("/"),1504);const e=o.split("/")[1];(0,a.vA)(void 0!==e,2475);const t=o.slice(e.length+1),n=r.get(e);void 0!==n?n.push(t):r.set(e,[t])}return r}(e);for(const[r]of t)(0,a.vA)(this.contexts.has(r),382);for(const[r,o]of this.contexts)o.updateUsedRoutes(t.get(r)??[])}getAttachSummary(e){const t=new x.qt;return this.visitLocalBoundContextsDuringAttach((r,o)=>{let n;if(o.isLoaded){const t=o.getAttachSummary(e);(0,a.vA)(t.summary.type===g.Z.Tree,384),n={stats:t.stats,summary:t.summary}}else(0,a.vA)(!!this.dataStoreContext.baseSnapshot,385),n=(0,x.jw)(this.dataStoreContext.baseSnapshot.trees[r]);t.addWithStats(r,n)}),t.getSummaryTree()}getAttachGCData(e){const t=new x.EI;return this.visitLocalBoundContextsDuringAttach((r,o)=>{if(o.isLoaded){const n=o.getAttachGCData(e);t.prefixAndAddNodes(r,n.gcNodes)}}),this.updateGCNodes(t),t.getGCData()}async visitContextsDuringSummary(e){for(const[t,r]of this.contexts){const o=this.isChannelAttached(t);(0,a.vA)(o,383),await e(t,r)}}visitLocalBoundContextsDuringAttach(e){this.attachGraph();const t=new Set;let r=-1;for(;r!==t.size;){r=t.size;for(const[r,o]of this.contexts){if(!(o instanceof ne))throw new O.iq("Should only be called with local channel handles");t.has(r)||this.notBoundedChannelContextSet.has(r)||(e(r,o),t.add(r))}}}submitMessage(e,t,r){this.submit(e,t,r)}submitSignal(e,t,r){this.verifyNotClosed(),this.dataStoreContext.submitSignal(e,t,r)}async waitAttached(){return this.deferredAttached.promise}makeChannelLocallyVisible(e){if(this.verifyNotClosed(),e.handle.isAttached)return;(0,L.Fz)(e.handle).attachGraph(),(0,a.vA)(this.isAttached,386),(0,a.vA)(this.visibilityState===T,720);const t=G(e,!0,!1),r=e.getGCData(!0);(0,x.su)(t,E.xX,JSON.stringify(r));const o=(0,x.ym)(t.summary),n={id:e.id,snapshot:o,type:e.attributes.type};this.pendingAttach.add(e.id),this.submit(re.Attach,n);this.contexts.get(e.id).makeVisible()}submitChannelOp(e,t,r){const o={address:e,contents:t};this.submit(re.ChannelOp,o,r)}submit(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;this.verifyNotClosed(),this.dataStoreContext.submitMessage(e,t,r),++this.pendingOpCount.value}reSubmit(e,t,r,o){switch(this.verifyNotClosed(),--this.pendingOpCount.value,e){case re.ChannelOp:{const e=t,n=this.contexts.get(e.address);(0,a.vA)(!!n,387),n.reSubmit(e.contents,r,o);break}case re.Attach:this.submit(e,t,r);break;default:(0,h.$)(e)}}rollback(e,t,r){switch(this.verifyNotClosed(),--this.pendingOpCount.value,e){case re.ChannelOp:{const e=t,o=this.contexts.get(e.address);(0,a.vA)(!!o,749),o.rollback(e.contents,r);break}default:throw new O.iq(`Can't rollback ${e} message`)}}async applyStashedOp(e){++this.pendingOpCount.value;const t=e?.type;switch(t){case re.Attach:{const t=e.content,r=new Map,o=b(t.snapshot.entries,r),n=this.createRehydratedLocalChannelContext(t.id,o,r);return await n.getChannel(),this.contexts.set(t.id,n),void(this.attachState===d.d.Detached?this.localChannelContextQueue.set(t.id,n):(n.makeVisible(),this.pendingAttach.add(t.id)))}case re.ChannelOp:{const t=e.content,r=this.contexts.get(t.address);return(0,a.vA)(!!r,388),await r.getChannel(),r.applyStashedOp(t.contents)}default:(0,h.$)(t)}}setChannelDirty(e){this.verifyNotClosed(),this.dataStoreContext.setChannelDirty(e)}attachListener(){this.setMaxListeners(Number.MAX_SAFE_INTEGER),this.dataStoreContext.once?.("attaching",()=>{this.setAttachState(d.d.Attaching)}),this.dataStoreContext.once?.("attached",()=>{this.setAttachState(d.d.Attached)})}verifyNotClosed(){if(this._disposed)throw new O.iq("Runtime is closed")}identifyLocalChangeInSummarizer(e,t,r){"summarizer"!==this.clientDetails.type||this.localChangesTelemetryCount<=0||(this.mc.logger.sendTelemetryEvent({eventName:e,...(0,M.Df)({channelType:r,channelId:t,fluidDataStoreId:this.id,fluidDataStorePackagePath:this.dataStoreContext.packagePath.join("/")}),stack:(0,O.aX)(30)}),this.localChangesTelemetryCount--)}setAttachState(e){switch(e){case d.d.Attaching:this.attachGraph(),this._attachState=d.d.Attaching,(0,a.vA)(this.visibilityState===P,721),this.visibilityState=T;for(const[,e]of this.localChannelContextQueue)e.makeVisible();this.localChannelContextQueue.clear(),this.deferredAttached.resolve(),this.emit("attaching");break;case d.d.Attached:(0,a.vA)(this.visibilityState===T,722),this._attachState=d.d.Attached,this.emit("attached");break;default:(0,h.$)(e,"unreached")}}}const ge=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:he;return class extends t{async request(t){const r=await super.request(t);return 404===r.status?e(t,this):r}}};async function pe(e){let{ctor:t,context:r,sharedObjectRegistry:o,optionalProviders:n,runtimeClassArg:i,existing:s,initialState:c,policies:d}=e,l=i;l=ge(async(e,t)=>{const r=await t.entryPoint.get();return(0,a.vA)(void 0!==r.request,1941),r.request(e)},l);const u=new l(r,o,s,async e=>((0,a.vA)(void 0!==g,1130),await g.finishInitialization(!0),g),d),h=r.scope,g=new t({runtime:u,context:r,providers:h.IFluidDependencySynthesizer?.synthesize(n,{})??{},initProps:c});return s||await g.finishInitialization(s),{instance:g,runtime:u}}class me{constructor(e,t,r,o,n,i){const a="string"===typeof e?{type:e,ctor:t,sharedObjects:r,optionalProviders:o,registryEntries:n,runtimeClass:i}:e;if(""===a.type)throw new Error("undefined type member");this.type=a.type,this.createProps={ctor:a.ctor,optionalProviders:a.optionalProviders??{},sharedObjectRegistry:new Map(a.sharedObjects?.map(e=>[e.type,e])),runtimeClassArg:a.runtimeClass??he,policies:a.policies},void 0!==a.registryEntries&&(this.registry=new s(a.registryEntries))}get IFluidDataStoreFactory(){return this}get IFluidDataStoreRegistry(){return this.registry}get registryEntry(){return[this.type,Promise.resolve(this)]}async instantiateDataStore(e,t){const{runtime:r}=await pe({...this.createProps,context:e,existing:t});return r}async createChildInstance(e,t,r){return this.createNonRootInstanceCore(e.containerRuntime,[...e.packagePath,this.type],t,r)}async createPeerInstance(e,t,r){return this.createNonRootInstanceCore(e.containerRuntime,e.packagePath,t,r)}async createInstance(e,t,r){return this.createNonRootInstanceCore(e,[this.type],t,r)}async createInstanceWithDataStore(e,t,r,o){const n=e.createDetachedDataStore(r??[this.type],o),{instance:i,runtime:s}=await pe({...this.createProps,context:n,existing:!1,initialState:t});return[i,await n.attachRuntime(this,s)]}async createRootInstance(e,t,r){const o=t.createDetachedDataStore([this.type]),{instance:n,runtime:i}=await pe({...this.createProps,context:o,existing:!1,initialState:r}),s=await o.attachRuntime(this,i);if("Success"!==await s.trySetAlias(e)){const r=await t.getAliasedDataStoreEntryPoint(e);return(0,a.vA)(void 0!==r,2273),await r.get()}return n}async createNonRootInstanceCore(e,t,r,o){const n=e.createDetachedDataStore(t,o);return this.createInstanceCore(n,r)}async createInstanceCore(e,t){const{instance:r,runtime:o}=await pe({...this.createProps,context:e,existing:!1,initialState:t});return await e.attachRuntime(this,o),r}}class fe extends me{constructor(e,t,r,i,s,a){const c="string"===typeof e?{type:e,ctor:t,sharedObjects:r,optionalProviders:i,registryEntries:s,runtimeClass:a}:{...e},d=c.sharedObjects=[...c.sharedObjects??[]];d.some(e=>e.type===o.m.Type)||d.push(o.B.getFactory()),d.some(e=>e.type===n.n.Type)||d.push(n.S.getFactory()),super(c)}}var ve=r(96076);class ye{ctor;optionalProviders;type="LoopObject";constructor(e,t){this.ctor=e,this.optionalProviders=t}async instantiateLoopComponent(e,t){const r=this.optionalProviders&&t?.synthesize(this.optionalProviders,void 0)||void 0;return new this.ctor(e,r)}}class be extends fe{registryEntries;constructor(e,t,r,o,n,i){const s="string"===typeof e?{type:e,ctor:t,sharedObjects:r,optionalProviders:o,registryEntries:n,runtimeClass:i}:e;super({...s,registryEntries:Se(s.registryEntries),runtimeClass:Ce(ke(s.runtimeClass))}),this.registryEntries=s.registryEntries}getSubComponentRegistryInfo(e){return this.registryEntries?.get(e)}get SubComponentRegistryDataProvider(){return this}get FluidDataObjectFactoryProvider(){return this}async createDataObject(e,t,r){const[o,n]=await this.createInstanceWithDataStore(e,t,r);return{entryPoint:o,dataStore:n}}}function Se(e){if(!e)return;const t=new Map;return e.forEach((e,r)=>{"FluidObject"===e.factory.type&&t.set(r,e.factory.factory)}),t}function Ce(){return ge(async(e,t)=>(await ve.C.getDataObject(t)).request(e),arguments.length>0&&void 0!==arguments[0]?arguments[0]:he)}function ke(){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:he;return class extends t{addBlob(e,t,r){const o=t.shift();if(void 0===o)throw new O.iq("Path can't be empty");let n={type:g.Z.Blob,content:r};e.stats.blobNodeCount++,e.stats.totalBlobSize+=r.length;for(const i of t.reverse())n={type:g.Z.Tree,tree:{[i]:n}},e.stats.treeNodeCount++;e.summary.tree[o]=n}async summarize(){const t=await super.summarize(...arguments);try{const r=await e(this);void 0!==r&&this.addBlob(t,r.path,r.content)}catch(r){throw i.I9.wrapIfUnrecognized(r,"mixinSummaryHandler")}return t}}}(async e=>{const t=(await ve.C.getDataObject(e)).SearchContent;if(void 0===t)return;const r=await t.getSearchContent();if(void 0===r)return;return{path:["_search","01"],content:r.endsWith("\n")?r:r+"\n"}},arguments.length>0&&void 0!==arguments[0]?arguments[0]:he)}},15851:(e,t,r)=>{"use strict";r.d(t,{Qq:()=>i,Tp:()=>n,hB:()=>o});var o=function(e){return e.Generic="Generic",e.Error="Error",e.UserAction="UserAction",e.Activity="Activity",e.DNM="DNM",e}({}),n=function(e){return e.Success="Success",e.Failure="Failure",e.Cancelled="Cancelled",e}({});const i={Bool:"Bool",Int64:"Int64",Double:"Double"}},15894:(e,t,r)=>{"use strict";r.d(t,{SA:()=>u,oh:()=>a,jP:()=>d,zF:()=>i,Fz:()=>l});const o="IFluidHandle",n=Symbol.for("FluidHandle-3978c7cf-4675-49ba-a20c-bf35efbf43da"),i=e=>"__fluid_handle__"===e?.type,s=e=>"payloadPending"in e&&!0===e.payloadPending;function a(e){return s(e)?{type:"__fluid_handle__",url:e.absolutePath,payloadPending:!0}:{type:"__fluid_handle__",url:e.absolutePath}}const c=!0;function d(e){if("object"!==typeof e||null===e)return!1;if(n in e)return!0;if(c&&o in e){const t=e[o];return"object"===typeof t&&null!==t&&o in t}return!1}function l(e){if(!(n in e)||!(n in e[n])){if(c&&o in e)return e[o];throw new TypeError("Invalid IFluidHandle")}return e[n]}class u{get IFluidHandle(){return this}get[n](){return this}}},16026:(e,t,r)=>{"use strict";function o(e,t,r){return void 0===e?e:t.stringify(e,r)}function n(e,t,r){return t.encode(e,r)}function i(e,t){return t.decode(e)}function s(e,t,r){return t.encode(e,r),e}r.d(t,{Dv:()=>n,KC:()=>o,Zb:()=>i,pM:()=>s})},16135:(e,t,r)=>{"use strict";function o(e){const t=n(e?.audience);return t||(e?.ring?e.ring:"Prod")}function n(e){switch(e){case"Development":return"Development";case"Staging":return"Staging";case"Dogfood":return"Dogfood";case"Preview":case"Microsoft":case"Production":return"Prod";case"GCC":return"Gcc";case"GCC-High":return"GccHigh";case"DoD":return"DoD";case"USNat":return"USNat";case"USSec":return"USSec";case"Gallatin":return"Gallatin";case"Bleu":return"Bleu";case"Delos":return"Delos";default:return}}function i(e){switch(e){case"Development":return{audience:"Development"};case"Staging":return{audience:"Staging"};case"Dogfood":return{audience:"Dogfood"};case"Gcc":return{audience:"GCC"};case"GccHigh":return{audience:"GCC-High"};case"DoD":return{audience:"DoD"};case"USNat":return{audience:"USNat"};case"USSec":return{audience:"USSec"};default:return{audience:"Production"}}}function s(e,t){return e?o(e):n(t)??"Prod"}r.d(t,{H9:()=>s,H_:()=>n,Rs:()=>o,mo:()=>i})},16281:e=>{"use strict";e.exports=JSON.parse('{"ControlClickToFollowLink":"Ctrl+Click to follow link","ClickToFollowLink":"Click to follow link","GettingThisReady":"Getting this ready...","NewLoopComponentFileName":"Loop component","CalloutTitle":"This is a Loop component","CalloutDescription":"You can edit this directly without sending a reply, and everyone will see changes in real time.","GotIt":"Got it","CustomPermissionsPanelPeopleOutsideWithLinkText_Default":"People outside this message with the link have access","CustomPermissionsPanelSpecificPermissionText_Default":"People in this message have access","CustomPermissionsPanelPeopleOutsideText_Default":"People outside this message have access","CustomPermissionsPanelSomePeopleText_Default":"Some people in this message have access","CustomPermissionsPanelPeopleOutsideWithLinkText_OneNote":"People in your organization with the link can edit. Please be cautious if you\'re working on a confidential or highly confidential document.","CustomPermissionsPanelSpecificPermissionText_OneNote":"People in your organization with the link can edit. Please be cautious if you\'re working on a confidential or highly confidential document.","CustomPermissionsPanelPeopleOutsideText_OneNote":"People in your organization with the link can edit. Please be cautious if you\'re working on a confidential or highly confidential document.","CustomPermissionsPanelSomePeopleText_OneNote":"People in your organization with the link can edit. Please be cautious if you\'re working on a confidential or highly confidential document."}')},16460:(e,t,r)=>{"use strict";r.d(t,{$R:()=>a,$h:()=>m,D4:()=>i,DP:()=>u,DS:()=>S,ED:()=>p,Lb:()=>s,Md:()=>C,QF:()=>d,U4:()=>h,Vg:()=>T,WU:()=>f,Yz:()=>g,fQ:()=>P,gC:()=>w,gp:()=>l,hj:()=>v,tM:()=>b,us:()=>k});var o=r(6971);class n extends EventTarget{constructor(){super()}}let i=function(e){return e.BackgroundChanged="BackgroundChanged",e.ContentPlayableStateUpdate="ContentPlayableStateUpdate",e.FluidComponentDataSaved="FluidComponentDataSaved",e.FocusEvent="FocusEvent",e.IsContentHeightLimitedChanged="IsContentHeightLimitedChanged",e.LinkPermissionChanged="LinkPermissionChanged",e.LinkProblemStateChanged="LinkProblemStateChanged",e.LinkUrlChanged="LinkUrlChanged",e.ReadOnlyChanged="ReadOnlyChanged",e.RequestDataToSave="RequestDataToSave",e.ShowLoopGlowBorder="ShowLoopGlowBorder",e.ThemeChanged="ThemeChanged",e}({}),s=function(e){return e[e.Unknown=0]="Unknown",e[e.Play=1]="Play",e[e.Pause=2]="Pause",e}({}),a=function(e){return e[e.None=0]="None",e[e.Warning=1]="Warning",e[e.Error=2]="Error",e}({});const c=new n;async function d(e){const t=await(0,o.E)();if(!t.version)return!1;switch(e){case i.LinkUrlChanged:case i.ThemeChanged:return t.version>=2;case i.LinkPermissionChanged:return t.version>=2&&t.version<=5;case i.LinkProblemStateChanged:return t.version>=5;case i.BackgroundChanged:return t.version>=6;case i.IsContentHeightLimitedChanged:return t.version>=15;case i.RequestDataToSave:case i.FluidComponentDataSaved:return t.version>=16;case i.ShowLoopGlowBorder:return t.version>=20;default:return!1}}function l(e){c.addEventListener(i.BackgroundChanged,e)}function u(e){c.addEventListener(i.ContentPlayableStateUpdate,e)}function h(e){c.addEventListener(i.FluidComponentDataSaved,e)}function g(e){c.removeEventListener(i.FluidComponentDataSaved,e)}function p(e){c.addEventListener(i.IsContentHeightLimitedChanged,e)}function m(e){c.addEventListener(i.LinkPermissionChanged,e)}function f(e){c.addEventListener(i.LinkProblemStateChanged,e)}function v(e){c.addEventListener(i.LinkUrlChanged,e)}function y(e,t){c.dispatchEvent(new CustomEvent(e,{detail:t}))}function b(e){c.addEventListener(i.RequestDataToSave,e)}function S(e){c.removeEventListener(i.RequestDataToSave,e)}function C(e){c.addEventListener(i.ShowLoopGlowBorder,e)}function k(e){c.addEventListener(i.FocusEvent,e)}function w(e){c.addEventListener(i.ReadOnlyChanged,e)}function P(e){c.addEventListener(i.ThemeChanged,e)}function T(){Object.defineProperty(window,"onNativeEvent",{value:y})}},17483:(e,t,r)=>{"use strict";r.d(t,{V:()=>o});const o={borderRadiusNone:"0",borderRadiusSmall:"2px",borderRadiusMedium:"4px",borderRadiusLarge:"6px",borderRadiusXLarge:"8px",borderRadiusCircular:"10000px"}},17637:(e,t,r)=>{"use strict";r.d(t,{CL:()=>f,G0:()=>u,Ln:()=>g,fG:()=>p,uz:()=>h});var o=r(78945),n=r(50178);const i=new o.d(()=>a(l())),s={getRawConfig:()=>{}},a=e=>void 0!==e&&null!==e?new u(void 0,{getRawConfig:t=>{try{return d(e.getItem(t)??void 0)?.raw}catch{return}}}):s;function c(e){switch(e){case"boolean":case"number":case"string":return!0;default:return!1}}function d(e){let t,r=e;if("string"===typeof e)try{r=JSON.parse(e),t={raw:e,string:e}}catch{}if(void 0===r)return t;const o=typeof r;if(c(o))return{...t,raw:e,[o]:r};if(Array.isArray(r)){const o=typeof r[0];if(!c(o))return t;for(const e of r)if(typeof e!==o)return t;return{...t,raw:e,[`${o}[]`]:r}}return t}const l=()=>{try{return globalThis.sessionStorage??void 0}catch{return}};class u{constructor(e){this.logger=e,this.configCache=new Map,this.orderedBaseProviders=[];const t=new Set;for(var r=arguments.length,o=new Array(r>1?r-1:0),n=1;n<r;n++)o[n-1]=arguments[n];const i=[...o];for(;i.length>0;){const e=i.shift();void 0!==e&&m(e)&&!t.has(e)&&(t.add(e),e instanceof u?i.push(...e.orderedBaseProviders):this.orderedBaseProviders.push(e))}}getBoolean(e){return this.getCacheEntry(e)?.boolean}getNumber(e){return this.getCacheEntry(e)?.number}getString(e){return this.getCacheEntry(e)?.string}getBooleanArray(e){return this.getCacheEntry(e)?.["boolean[]"]}getNumberArray(e){return this.getCacheEntry(e)?.["number[]"]}getStringArray(e){return this.getCacheEntry(e)?.["string[]"]}getRawConfig(e){return this.getCacheEntry(e)?.raw}getCacheEntry(e){if(!this.configCache.has(e)){for(const t of this.orderedBaseProviders){const r=d(t?.getRawConfig(e));if(void 0!==r)return this.configCache.set(e,r),this.logger?.send({category:"generic",eventName:"ConfigRead",...(0,n.Df)({configName:e,configValue:JSON.stringify(r)})}),r}this.configCache.set(e,{raw:void 0})}return this.configCache.get(e)}}function h(e){const t=e;return m(t?.config)&&void 0!==t?.logger}function g(e){return h(e)?e:p(e,i.value)}function p(e){if(h(e))throw new Error("Logger is already a monitoring context");const t=e;for(var r=arguments.length,o=new Array(r>1?r-1:0),n=1;n<r;n++)o[n-1]=arguments[n];return t.config=new u(e,...o),t.logger=e,t}function m(e){const t=e;return"function"===typeof t?.getRawConfig}function f(e){return g((0,n.pW)(e))}},18206:(e,t,r)=>{"use strict";r.d(t,{XM:()=>d,fV:()=>u,sG:()=>h,z$:()=>l});var o=r(93537),n=r(37805),i=r(40635),s=r(74405),a=r(47860),c=r(7621);const d={respectRetryAfterHeader:!0,maxRetries:3,filter:(0,o.sC)([503]),backoffFn:(0,n.Ed)(100)};async function l(e,t,r,o,n,i,s){return u(e,t,(arguments.length>10?arguments[10]:void 0)??"Production",r,o,n,i,s,arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,arguments.length>8?arguments[8]:void 0,arguments.length>9?arguments[9]:void 0)}async function u(e,t,r,o,n,c,d,l){let u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,h=arguments.length>9?arguments[9]:void 0,g=arguments.length>10?arguments[10]:void 0;const p={getToken:t=>{if(t)return e(t);throw Error("Options must be specified")},url:t.startsWith("http")?t:`${(0,a.o)(r)}/v1.0/${t}`,tenantId:c,requestInit:d,retryPolicy:l,timeoutMs:u,additionalRequestHeaders:g},m=n&&o?(0,i.g)({...p,logger:n,nameForLogging:o,doNotLogOnSuccess:h,getAdditionalProps:async(e,t)=>(0,s.u)(e)}):(0,i.y)(p);return(await m).result}function h(e,t){const r=(0,c.wJ)(e,t);return async function(){const e=await r.get(...arguments);return"number"===typeof e&&200!==e&&404!==e&&r.delete(...arguments),e}}},18731:(e,t,r)=>{"use strict";r.d(t,{kN:()=>i});var o=r(94794),n=r(53783);function i(e){if("object"===typeof e){const t=e;if(function(e){return e.errorType===n.ZY.ContainerUpgradeRequired&&e.error?.name===n.ZY.ContainerUpgradeRequired}(t))return n.ZY.ContainerUpgradeRequired;if(function(e){return e.errorType===o.D.genericError}(t))return o.D.genericError;if(function(e){return e.errorType===o.D.throttlingError}(t))return o.D.throttlingError;const r=function(e){return Object.values(n.qb).find(t=>t===e.name||t===e.errorType)}(t);if(r)return r}}},19466:(e,t,r)=>{"use strict";r.d(t,{n:()=>s});var o=r(3542),n=r(63722),i=r(28205);function s(e){var t=n.nr.getInstance(),r=(0,i.bz)((0,o.Iy)(),e);if(!t.classNameFromKey(r)){var s=t.getClassName();t.insertRule("@font-face{".concat(r,"}"),!0),t.cacheClassName(s,r,[],["font-face",r])}}},19688:(e,t,r)=>{"use strict";var o;r.d(t,{d:()=>o}),function(e){e.Detached="Detached",e.Attaching="Attaching",e.Attached="Attached"}(o||(o={}))},19813:(e,t,r)=>{"use strict";r.d(t,{JL:()=>o,Yr:()=>a,ZJ:()=>s,pU:()=>n,tG:()=>i});var o="@ms/whiteboard-container",n="Whiteboard",i="WhiteboardLoopComponent",s=200,a=600},19984:(e,t,r)=>{"use strict";r.d(t,{MD:()=>s,Yj:()=>i,or:()=>a,wx:()=>c});var o=r(15217),n=r(74621);function i(e){if(null!==e&&"object"===typeof e&&!0===e.errorFromRequestFluidObject){const t=e;return{mimeType:"text/plain",status:t.code,value:t.message,get stack(){return t.stack},headers:t.underlyingResponseHeaders}}const t=(0,n.oD)();return{mimeType:"text/plain",status:500,value:`${e}`,get stack(){return e?.stack??t.stack}}}function s(e,t){const r=e.value,o=(0,n.oD)();return{errorFromRequestFluidObject:!0,message:r,name:"Error",code:e.status,get stack(){return e.stack??o.stack},underlyingResponseHeaders:e.headers}}const a=e=>c(404,"not found",e);function c(e,t,r,i){(0,o.vA)(200!==e,411);const s=r.url?.split("?")[0],a=(0,n.oD)();return{mimeType:"text/plain",status:e,value:void 0===s?t:`${t}: ${s}`,get stack(){return a.stack},headers:i}}},20258:(e,t,r)=>{"use strict";r.d(t,{I:()=>n,d:()=>o});class o{constructor(e){this.valueGenerator=e,this._evaluated=!1}get evaluated(){return this._evaluated}get value(){return this._evaluated||(this._evaluated=!0,this._value=this.valueGenerator()),this._value}}class n{get[Symbol.toStringTag](){return"[object LazyPromise]"}constructor(e){this.execute=e}async then(e,t){return this.getPromise().then(...arguments)}async catch(e){return this.getPromise().catch(...arguments)}async finally(e){return this.getPromise().finally(...arguments)}async getPromise(){return void 0===this.result&&(this.result=this.execute()),this.result}}},20310:(e,t,r)=>{"use strict";r.d(t,{l:()=>o});const o=()=>globalThis.performance.now()},20611:(e,t,r)=>{"use strict";r.d(t,{Pb:()=>o,V$:()=>s,W3:()=>i,o1:()=>n});const o=432e6,n="snapshot",i="snapshotWithLoadingGroupId";function s(e){return`${e.file.docId}_${e.type}_${e.key}`}},20875:(e,t,r)=>{"use strict";r.d(t,{w:()=>s});var o=r(45799),n=r(98256);const i="--";function s(e){const t=e?(0,n.P)(e):void 0,r={10:"#29130b",20:"#4d2415",30:"#792000",40:"#99482b",50:"#a52c00",60:"#c33400",70:"#e06a3f",80:"#d83b01",90:"#dd4f1b",100:"#fe7948",110:"#ff865a",120:"#ff9973",130:"#e8825d",140:"#ffb498",150:"#f4beaa",160:"#f9dcd1"},s=(0,o.a)(r),a=(e,t)=>{const r=function(e){if(e.startsWith(i)){const t=e.replace(i,"");return`${t.charAt(0).toLowerCase()}${t.substring(1)}`}return e}(e);r&&s.hasOwnProperty(r)&&(s[r]=t)};if(t)for(const o of t)a(o.name,o.value);return s}},20930:(e,t,r)=>{"use strict";r.d(t,{m:()=>i});const o={PinkRed10:"--ms-themeColorPaletteSharedPinkRed10",Red20:"--ms-themeColorPaletteSharedRed20",Red10:"--ms-themeColorPaletteSharedRed10",RedOrange10:"--ms-themeColorPaletteSharedRedOrange10",Orange30:"--ms-themeColorPaletteSharedOrange30",Orange20:"--ms-themeColorPaletteSharedOrange20",Orange10:"--ms-themeColorPaletteSharedOrange10",Yellow20:"--ms-themeColorPaletteSharedYellow20",Yellow10:"--ms-themeColorPaletteSharedYellow10",OrangeYellow20:"--ms-themeColorPaletteSharedOrangeYellow20",OrangeYellow10:"--ms-themeColorPaletteSharedOrangeYellow10",YellowGreen10:"--ms-themeColorPaletteSharedYellowGreen10",Green20:"--ms-themeColorPaletteSharedGreen20",Green10:"--ms-themeColorPaletteSharedGreen10",GreenCyan10:"--ms-themeColorPaletteSharedGreenCyan10",Cyan30:"--ms-themeColorPaletteSharedCyan30",Cyan20:"--ms-themeColorPaletteSharedCyan20",Cyan10:"--ms-themeColorPaletteSharedCyan10",CyanBlue20:"--ms-themeColorPaletteSharedCyanBlue20",CyanBlue10:"--ms-themeColorPaletteSharedCyanBlue10",Blue10:"--ms-themeColorPaletteSharedBlue10",BlueMagenta30:"--ms-themeColorPaletteSharedBlueMagenta30",BlueMagenta20:"--ms-themeColorPaletteSharedBlueMagenta20",BlueMagenta10:"--ms-themeColorPaletteSharedBlueMagenta10",Magenta20:"--ms-themeColorPaletteSharedMagenta20",Magenta10:"--ms-themeColorPaletteSharedMagenta10",MagentaPink20:"--ms-themeColorPaletteSharedMagentaPink20",MagentaPink10:"--ms-themeColorPaletteSharedMagentaPink10",Gray430:"--ms-themeColorPaletteSharedGray430",Gray180:"--ms-themeColorPaletteSharedGray180",Gray130:"--ms-themeColorPaletteSharedGray130",Gray100:"--ms-themeColorPaletteSharedGray100",Gray80:"--ms-themeColorPaletteSharedGray80",Gray70:"--ms-themeColorPaletteSharedGray70",Gray50:"--ms-themeColorPaletteSharedGray50",Gray40:"--ms-themeColorPaletteSharedGray40",Gray30:"--ms-themeColorPaletteSharedGray30",Gray20:"--ms-themeColorPaletteSharedGray20",Gray10:"--ms-themeColorPaletteSharedGray10",Gray4:"--ms-themeColorPaletteSharedGray4",Gray6:"--ms-themeColorPaletteSharedGray6",Gray5:"--ms-themeColorPaletteSharedGray5",Gray1:"--ms-themeColorPaletteSharedGray1",Away:"--ms-themeColorPalettePresenceAway",DoNotDisturb:"--ms-themeColorPalettePresenceDoNotDisturb",Online:"--ms-themeColorPalettePresenceOnline",Invisible:"--ms-themeColorPalettePresenceInvisible",OutOfOffice:"--ms-themeColorPalettePresenceOutOfOffice",Warning:"--ms-themeColorPaletteMessagingWarning",WarningIcon:"--ms-themeColorPaletteMessagingWarningIcon",SevereWarning:"--ms-themeColorPaletteMessagingSevereWarning",SevereWarningIcon:"--ms-themeColorPaletteMessagingServereWarningIcon",ErrorBlock:"--ms-themeColorPaletteMessagingErrorBlock",ErrorBlockIcon:"--ms-themeColorPaletteMessagingErrorBlockIcon",ErrorBackground:"--ms-themeColorPaletteMessagingErrorBackground",ErrorBoxBackground:"--ms-themeColorPaletteMessagingErrorBoxBackground",ErrorText:"--ms-themeColorPaletteMessagingErrorText",InfoText:"--ms-themeColorPaletteMessagingInfoText",DarkErrorBlock:"--ms-themeColorPaletteMessagingDarkErrorBlock",GrayErrorBackground:"--ms-themeColorPaletteMessagingGrayErrorBackground",DarkGrayErrorBackground:"--ms-themeColorPaletteMessagingDarkGrayErrorBackground",GrayErrorText:"--ms-themeColorPaletteMessagingGrayErrorText",RedErrorText:"--ms-themeColorPaletteMessagingRedErrorText",GrayIcon:"--ms-themeColorPaletteMessagingGrayIcon",ButtonText:"--ms-themeColorPaletteMessagingButtonText",Success:"--ms-themeColorPaletteMessagingSuccess",SuccessIcon:"--ms-themeColorPaletteMessagingSuccessIcon",themeDarker:"--ms-themeColorPaletteThemeDarker",themeDark:"--ms-themeColorPaletteThemeDark",themeDarkAlt:"--ms-themeColorPaletteThemeDarkAlt",themePrimary:"--ms-themeColorPaletteThemePrimary",themeSecondary:"--ms-themeColorPaletteThemeSecondary",themeTertiary:"--ms-themeColorPaletteThemeTertiary",themeLight:"--ms-themeColorPaletteThemeLight",themeLighter:"--ms-themeColorPaletteThemeLighter",themeLighterAlt:"--ms-themeColorPaletteThemeLighterAlt",black:"--ms-themeColorPaletteBlack",neutralDark:"--ms-themeColorPaletteNeutralDark",neutralPrimary:"--ms-themeColorPaletteNeutralPrimary",neutralPrimaryAlt:"--ms-themeColorPaletteNeutralPrimaryAlt",neutralSecondary:"--ms-themeColorPaletteNeutralSecondary",neutralSecondaryAlt:"--ms-themeColorPaletteNeutralSecondaryAlt",neutralTertiary:"--ms-themeColorPaletteNeutralTertiary",neutralTertiaryAlt:"--ms-themeColorPaletteNeutralTertiaryAlt",neutralQuaternary:"--ms-themeColorPaletteNeutralQuaternary",neutralQuaternaryAlt:"--ms-themeColorPaletteNeutralQuaternaryAlt",neutralQuaternaryAlt2:"--ms-themeColorPaletteNeutralQuaternaryAlt2",neutralLight:"--ms-themeColorPaletteNeutralLight",neutralLightAlt:"--ms-themeColorPaletteNeutralLightAlt",neutralLighter:"--ms-themeColorPaletteNeutralLighter",neutralLighterAlt:"--ms-themeColorPaletteNeutralLighterAlt",white:"--ms-themeColorPaletteWhite",yellowDark:"--ms-themeColorPaletteAccentYellowDark",yellow:"--ms-themeColorPaletteAccentYellow",yellowLight:"--ms-themeColorPaletteAccentYellowLight",orange:"--ms-themeColorPaletteAccentOrange",orangeLight:"--ms-themeColorPaletteAccentOrangeLight",orangeLighter:"--ms-themeColorPaletteAccentOrangeLighter",redDark:"--ms-themeColorPaletteAccentRedDark",red:"--ms-themeColorPaletteAccentRed",magentaDark:"--ms-themeColorPaletteAccentMagentaDark",magenta:"--ms-themeColorPaletteAccentMagenta",magentaLight:"--ms-themeColorPaletteAccentMagentaLight",purpleDark:"--ms-themeColorPaletteAccentPurpleDark",purple:"--ms-themeColorPaletteAccentPurple",purpleLight:"--ms-themeColorPaletteAccentPurpleLight",blueDark:"--ms-themeColorPaletteAccentBlueDark",blueMid:"--ms-themeColorPaletteAccentBlueMid",blue:"--ms-themeColorPaletteAccentBlue",blueAlt:"--ms-themeColorPaletteAccentBlueAlt",blueLight:"--ms-themeColorPaletteAccentBlueLight",tealDark:"--ms-themeColorPaletteAccentTealDark",teal:"--ms-themeColorPaletteAccentTeal",tealLight:"--ms-themeColorPaletteAccentTealLight",greenDark:"--ms-themeColorPaletteAccentGreenDark",green:"--ms-themeColorPaletteAccentGreen",greenLight:"--ms-themeColorPaletteAccentGreenLight",SuggestionAcceptedBackground:"--ms-themeColorPaletteProofingSuggestionAcceptedBackground",SpellingSuggestionHoverHighlight:"--ms-themeColorPaletteProofingSpellingSuggestionHoverHighlight",SpellingHoverTextColor:"--ms-themeColorPaletteProofingSpellingHoverTextColor",GrammarSuggestionHoverHighlight:"--ms-themeColorPaletteProofingGrammarSuggestionHoverHighlight",GrammarHoverTextColor:"--ms-themeColorPaletteProofingGrammarHoverTextColor",HeadingDetectedHoverHighlight:"--ms-themeColorPaletteAnnotationsHeadingDetectedHoverHighlight",HeadingDetectedHoverTextColor:"--ms-themeColorPaletteAnnotationsHeadingDetectedHoverTextColor",TaskRecognitionUnderline:"--ms-themeColorPaletteAnnotationsTaskRecognitionUnderline",TaskRecognitionHoverHighlight:"--ms-themeColorPaletteAnnotationsTaskRecognitionHoverHighlight",TaskRecognitionHoverTextColor:"--ms-themeColorPaletteAnnotationsTaskRecognitionHoverTextColor",EntityRecognitionUnderline:"--ms-themeColorPaletteAnnotationsEntityRecognitionUnderline",EntityRecognitionHoverHighlight:"--ms-themeColorPaletteAnnotationsEntityRecognitionHoverHighlight",EntityRecognitionHoverTextColor:"--ms-themeColorPaletteAnnotationsEntityRecognitionHoverTextColor",Scrollbar:"--ms-themeColorScrollbar",ScrollbarPressed:"--ms-themeColorScrollbarPressed",HeadingText:"--ms-themeColorHeadingText"},n="--";function i(e){const t=[];e.black&&t.push([o.black,e.black]),e.white&&t.push([o.white,e.white]),e.greys&&t.push([o.neutralDark,e.greys[8]],[o.neutralPrimary,e.greys[14]],[o.neutralPrimaryAlt,e.greys[22]],[o.neutralSecondary,e.greys[36]],[o.neutralSecondaryAlt,e.greys[52]],[o.neutralTertiary,e.greys[62]],[o.neutralTertiaryAlt,e.greys[78]],[o.neutralQuaternary,e.greys[82]],[o.neutralQuaternaryAlt,e.greys[88]],[o.neutralLight,e.greys[92]],[o.neutralLighter,e.greys[96]],[o.neutralLighterAlt,e.greys[98]]),e.brandVariants&&t.push([o.themeDarker,e.brandVariants[40]],[o.themeDark,e.brandVariants[60]],[o.themeDarkAlt,e.brandVariants[70]],[o.themePrimary,e.brandVariants[80]],[o.themeSecondary,e.brandVariants[90]],[o.themeTertiary,e.brandVariants[120]],[o.themeLight,e.brandVariants[140]],[o.themeLighter,e.brandVariants[150]],[o.themeLighterAlt,e.brandVariants[160]]),Object.entries(e.fluentThemeV9).forEach(e=>{let[r,o]=e;const i=(s=r).startsWith(n)?s:`${n}${s}`;var s;t.push([i,o.toString()])});const r=[];for(const o of t)r.push({name:o[0],value:o[1]});return r}},21673:(e,t,r)=>{"use strict";r.d(t,{v:()=>n});var o=r(85038);class n{constructor(e){this.maxRequests=e,this.tasks=[],this.release=()=>{const e=this.tasks.shift();if(void 0!==e)return e();this.maxRequests++},(0,o.vA)(e>0,174)}get waitQueueLength(){return this.tasks.length}async acquire(){if(!(this.maxRequests>0))return new Promise(e=>{this.tasks.push(e)});this.maxRequests--}async schedule(e){return await this.acquire(),e().finally(this.release)}}},21856:(e,t,r)=>{"use strict";r.d(t,{m:()=>x,B:()=>A});var o=r(73105),n=r(93023),i=r(15217),s=r(77565),a=r(96516),c=r(86748);const d=0,l=1;class u{constructor(e,t){this.compareKeys=e,this.aug=t}makeNode(e,t,r,o){return{key:e,data:t,color:r,size:o}}isRed(e){return!!e&&e.color===d}nodeSize(e){return e?e.size:0}size(){return this.nodeSize(this.root)}isEmpty(){return!this.root}get(e){if(void 0!==e)return this.nodeGet(this.root,e)}nodeGet(e,t){let r=e;for(;r;){const e=this.compareKeys(t,r.key);if(e<0)r=r.left;else{if(!(e>0))return r;r=r.right}}}contains(e){return this.get(e)}gather(e,t){const r=[];return void 0!==e&&this.nodeGather(this.root,r,e,t),r}nodeGather(e,t,r,o){e&&(o.continueSubtree(e.left,r)&&this.nodeGather(e.left,t,r,o),o.matchNode(e,r)&&t.push(e),o.continueSubtree(e.right,r)&&this.nodeGather(e.right,t,r,o))}walkExactMatchesForward(e,t,r,o){this.nodeWalkExactMatchesForward(this.root,e,t,r,o)}nodeWalkExactMatchesForward(e,t,r,o,n){if(!e)return;const i=t(e);o(i)&&this.nodeWalkExactMatchesForward(e.left,t,r,o,n),0===i&&r(e),n(i)&&this.nodeWalkExactMatchesForward(e.right,t,r,o,n)}walkExactMatchesBackward(e,t,r,o){this.nodeWalkExactMatchesBackward(this.root,e,t,r,o)}nodeWalkExactMatchesBackward(e,t,r,o,n){if(!e)return;const i=t(e);n(i)&&this.nodeWalkExactMatchesBackward(e.right,t,r,o,n),0===i&&r(e),o(i)&&this.nodeWalkExactMatchesBackward(e.left,t,r,o,n)}put(e,t,r){void 0!==e&&(void 0===t?this.remove(e):(this.root=this.nodePut(this.root,e,t,r),this.root.color=l))}nodePut(e,t,r,o){let n=e;if(n){const e=this.compareKeys(t,n.key);if(e<0)n.left=this.nodePut(n.left,t,r,o);else if(e>0)n.right=this.nodePut(n.right,t,r,o);else if(o){const e=o(t,n.key,r,n.data);e.key&&(n.key=e.key),n.data=e.data??r}else n.data=r;return this.isRed(n.right)&&!this.isRed(n.left)&&(n=this.rotateLeft(n)),this.isRed(n.left)&&this.isRed(n.left.left)&&(n=this.rotateRight(n)),this.isRed(n.left)&&this.isRed(n.right)&&this.flipColors(n),n.size=this.nodeSize(n.left)+this.nodeSize(n.right)+1,this.aug&&this.updateLocal(n),n}return this.makeNode(t,r,d,1)}updateLocal(e){this.aug&&(this.isRed(e.left)&&this.aug.update(e.left),this.isRed(e.right)&&this.aug.update(e.right),this.aug.update(e))}nodeRemoveMin(e){let t=e;if(t.left)return this.isRed(t.left)||this.isRed(t.left.left)||(t=this.moveRedLeft(t)),t.left=this.nodeRemoveMin(t.left),this.balance(t)}remove(e){if(void 0!==e){if(!this.contains(e))return;this.removeExisting(e)}}removeExisting(e){this.isRed(this.root.left)||this.isRed(this.root.right)||(this.root.color=d),this.root=this.nodeRemove(this.root,e)}nodeRemove(e,t){let r=e;if(this.compareKeys(t,r.key)<0)this.isRed(r.left)||this.isRed(r.left.left)||(r=this.moveRedLeft(r)),r.left=this.nodeRemove(r.left,t);else{if(this.isRed(r.left)&&(r=this.rotateRight(r)),0===this.compareKeys(t,r.key)&&!r.right)return;if(this.isRed(r.right)||this.isRed(r.right.left)||(r=this.moveRedRight(r)),0===this.compareKeys(t,r.key)){const e=this.nodeMin(r.right);r.key=e.key,r.data=e.data,r.right=this.nodeRemoveMin(r.right)}else r.right=this.nodeRemove(r.right,t)}return this.balance(r)}floor(e){if(!this.isEmpty())return this.nodeFloor(this.root,e)}nodeFloor(e,t){if(e){const r=this.compareKeys(t,e.key);if(0===r)return e;if(r<0)return this.nodeFloor(e.left,t);return this.nodeFloor(e.right,t)??e}}ceil(e){if(!this.isEmpty())return this.nodeCeil(this.root,e)}nodeCeil(e,t){if(e){const r=this.compareKeys(t,e.key);if(0===r)return e;if(r>0)return this.nodeCeil(e.right,t);return this.nodeCeil(e.left,t)??e}}min(){if(this.root)return this.nodeMin(this.root)}nodeMin(e){return e.left?this.nodeMin(e.left):e}max(){if(this.root)return this.nodeMax(this.root)}nodeMax(e){return e.right?this.nodeMax(e.right):e}rotateRight(e){const t=e.left;return e.left=t.right,t.right=e,t.color=t.right.color,t.right.color=d,t.size=e.size,e.size=this.nodeSize(e.left)+this.nodeSize(e.right)+1,this.aug&&(this.updateLocal(e),this.updateLocal(t)),t}rotateLeft(e){const t=e.right;return e.right=t.left,t.left=e,t.color=t.left.color,t.left.color=d,t.size=e.size,e.size=this.nodeSize(e.left)+this.nodeSize(e.right)+1,this.aug&&(this.updateLocal(e),this.updateLocal(t)),t}oppositeColor(e){return e===l?d:l}flipColors(e){e.color=this.oppositeColor(e.color),e.left.color=this.oppositeColor(e.left.color),e.right.color=this.oppositeColor(e.right.color)}moveRedLeft(e){let t=e;return this.flipColors(t),this.isRed(t.right.left)&&(t.right=this.rotateRight(t.right),t=this.rotateLeft(t),this.flipColors(t)),t}moveRedRight(e){let t=e;return this.flipColors(t),this.isRed(t.left.left)&&(t=this.rotateRight(t),this.flipColors(t)),t}balance(e){let t=e;return this.isRed(t.right)&&(t=this.rotateLeft(t)),this.isRed(t.left)&&this.isRed(t.left.left)&&(t=this.rotateRight(t)),this.isRed(t.left)&&this.isRed(t.right)&&this.flipColors(t),t.size=this.nodeSize(t.left)+this.nodeSize(t.right)+1,this.aug&&this.aug.update(t),t}mapRange(e,t,r,o){this.nodeMap(this.root,e,t,r,o)}map(e,t){this.nodeMap(this.root,e,t)}keys(){const e=[],t={showStructure:!0,infix:t=>(e.push(t.key),!0)};return this.walk(t),e}walk(e){this.nodeWalk(this.root,e)}walkBackward(e){this.nodeWalkBackward(this.root,e)}nodeWalk(e,t){let r=!0;return e&&(t.pre&&(t.showStructure||e.color===l)&&(r=t.pre(e)),e.left&&(r=this.nodeWalk(e.left,t)),r&&t.infix&&(t.showStructure||e.color===l)&&(r=t.infix(e)),r&&(r=this.nodeWalk(e.right,t)),r&&t.post&&(t.showStructure||e.color===l)&&(r=t.post(e))),r}nodeWalkBackward(e,t){let r=!0;return e&&(t.pre&&(t.showStructure||e.color===l)&&(r=t.pre(e)),e.right&&(r=this.nodeWalkBackward(e.right,t)),r&&t.infix&&(t.showStructure||e.color===l)&&(r=t.infix(e)),r&&(r=this.nodeWalkBackward(e.left,t)),r&&t.post&&(t.showStructure||e.color===l)&&(r=t.post(e))),r}nodeMap(e,t,r,o,n){let i=o,s=n;if(!e)return!0;void 0===i&&(i=this.nodeMin(e).key),void 0===s&&(s=this.nodeMax(e).key);const a=this.compareKeys(i,e.key),c=this.compareKeys(s,e.key);let d=!0;return a<0&&(d=this.nodeMap(e.left,t,r,i,s)),d&&a<=0&&c>=0&&(d=t(e,r)),d&&c>0&&(d=this.nodeMap(e.right,t,r,i,s)),d}}var h,g,p=r(52389),m=r(16026),f=r(11502),v=r(39773),y=r(53316),b=r(55651);const S=y.posix,C="header",k=(e,t)=>w(e)?w(t)?e.seq===t.seq?e.clientSeq-t.clientSeq:e.seq-t.seq:-1:w(t)?1:e.seq===t.seq?e.clientSeq-t.clientSeq:e.seq-t.seq;function w(e){return e.seq>=0}class P{constructor(){this.indexToKey=new u(k),this.keyToIndex=new Map}set(e,t){this.indexToKey.put(t,e),this.keyToIndex.set(e,t)}has(e){return"string"===typeof e?this.keyToIndex.has(e):void 0!==this.indexToKey.get(e)}delete(e){if(this.has(e))if("string"===typeof e){const t=this.keyToIndex.get(e);this.keyToIndex.delete(e),this.indexToKey.remove(t)}else{const t=this.indexToKey.get(e)?.data;this.indexToKey.remove(e),this.keyToIndex.delete(t)}}keys(e){const t=[];return this.indexToKey.mapRange(r=>(e&&!e(r.data)||t.push(r.data),!0),t),t}get size(){return this.keyToIndex.size}}class T extends o.T6{get absolutePath(){return this.root.absolutePath}constructor(e,t,r){super(e,t,r,"fluid_directory_"),this[h]="SharedDirectory",this.root=new B({seq:0,clientSeq:0},new Set,this,this.runtime,this.serializer,S.sep,this.logger),this.messageHandlers=new Map,this.setMessageHandlers(),this.root.on("containedValueChanged",(e,t)=>{this.emit("containedValueChanged",e,t,this)}),this.root.on("subDirectoryCreated",(e,t)=>{this.emit("subDirectoryCreated",e,t,this)}),this.root.on("subDirectoryDeleted",(e,t)=>{this.emit("subDirectoryDeleted",e,t,this)})}get(e){return this.root.get(e)}set(e,t){return this.root.set(e,t),this}dispose(e){this.root.dispose(e)}get disposed(){return this.root.disposed}delete(e){return this.root.delete(e)}clear(){this.root.clear()}has(e){return this.root.has(e)}get size(){return this.root.size}forEach(e){this.root.forEach(e)}[(h=Symbol.toStringTag,Symbol.iterator)](){return this.root[Symbol.iterator]()}entries(){return this.root.entries()}countSubDirectory(){return this.root.countSubDirectory()}keys(){return this.root.keys()}values(){return this.root.values()}createSubDirectory(e){return this.root.createSubDirectory(e)}getSubDirectory(e){return this.root.getSubDirectory(e)}hasSubDirectory(e){return this.root.hasSubDirectory(e)}deleteSubDirectory(e){return this.root.deleteSubDirectory(e)}subdirectories(){return this.root.subdirectories()}getWorkingDirectory(e){const t=this.makeAbsolute(e);if(t===S.sep)return this.root;let r=this.root;const o=t.slice(1).split(S.sep);for(const n of o)if(r=r.getSubDirectory(n),!r)return;return r}summarizeCore(e,t){return this.serializeDirectory(this.root,e)}submitDirectoryMessage(e,t){this.submitLocalMessage(e,t)}onDisconnect(){}reSubmitCore(e,t){const r=e,o=this.messageHandlers.get(r.type);(0,i.vA)(void 0!==o,13),o.submit(r,t)}async loadCore(e){const t=await(0,c.P)(e,C),r=t;if(Array.isArray(r.blobs)){this.populate(r.content);const t=await Promise.all(r.blobs.map(async t=>(0,c.P)(e,t)));for(const e of t)this.populate(e)}else this.populate(t)}populate(e){const t=[];for(t.push([this.root,e]);t.length>0;){const[e,r]=t.pop();if(r.subdirectories){const o=new Map;for(const[n,i]of Object.entries(r.subdirectories)){let r,s=e.getSubDirectory(n);if(!s){const t=i.ci;if(void 0!==t&&t.csn>0){o.has(t.csn)||o.set(t.csn,0);let e=o.get(t.csn);r={seq:t.csn,clientSeq:e},o.set(t.csn,++e)}else r={seq:0,clientSeq:++e.localCreationSeq};s=new B(r,void 0===t?new Set:new Set(t.ccIds),this,this.runtime,this.serializer,S.join(e.absolutePath,n),this.logger),e.populateSubDirectory(n,s),e.ackedCreationSeqTracker.set(n,{...r})}t.push([s,i])}}if(r.storage)for(const[t,o]of Object.entries(r.storage)){const r=(0,m.Zb)(o,this.serializer);(0,b.R)(r,this.serializer,this.handle),e.populateStorage(t,r.value)}}}processCore(e,t,r){if(e.type===a.Go.Operation){const o=e.contents,n=this.messageHandlers.get(o.type);(0,i.vA)(void 0!==n,14),n.process(e,o,t,r)}}rollback(e,t){const r=e,o=this.getWorkingDirectory(r.path);o&&o.rollback(r,t)}makeAbsolute(e){return S.resolve(S.sep,e)}isSubDirectoryDeletePending(e){const t=this.makeAbsolute(e);if(t===S.sep)return!1;let r=this.root;const o=t.split(S.sep).slice(1);for(const n of o){if(r.isSubDirectoryDeletePending(n))return!0;if(r=r.getSubDirectory(n),void 0===r)return!0}return!1}setMessageHandlers(){this.messageHandlers.set("clear",{process:(e,t,r,o)=>{const n=this.getWorkingDirectory(t.path);n&&!this.isSubDirectoryDeletePending(t.path)&&n.processClearMessage(e,t,r,o)},submit:(e,t)=>{const r=this.getWorkingDirectory(e.path);r&&r.resubmitClearMessage(e,t)}}),this.messageHandlers.set("delete",{process:(e,t,r,o)=>{const n=this.getWorkingDirectory(t.path);n&&!this.isSubDirectoryDeletePending(t.path)&&n.processDeleteMessage(e,t,r,o)},submit:(e,t)=>{const r=this.getWorkingDirectory(e.path);r&&r.resubmitKeyMessage(e,t)}}),this.messageHandlers.set("set",{process:(e,t,r,o)=>{const n=this.getWorkingDirectory(t.path);if(n&&!this.isSubDirectoryDeletePending(t.path)){(0,b.R)(t.value,this.serializer,this.handle);const i=r?void 0:t.value.value;n.processSetMessage(e,t,i,r,o)}},submit:(e,t)=>{const r=this.getWorkingDirectory(e.path);r&&r.resubmitKeyMessage(e,t)}}),this.messageHandlers.set("createSubDirectory",{process:(e,t,r,o)=>{const n=this.getWorkingDirectory(t.path);n&&!this.isSubDirectoryDeletePending(t.path)&&n.processCreateSubDirectoryMessage(e,t,r,o)},submit:(e,t)=>{const r=this.getWorkingDirectory(e.path);r&&r.resubmitSubDirectoryMessage(e,t)}}),this.messageHandlers.set("deleteSubDirectory",{process:(e,t,r,o)=>{const n=this.getWorkingDirectory(t.path);n&&!this.isSubDirectoryDeletePending(t.path)&&n.processDeleteSubDirectoryMessage(e,t,r,o)},submit:(e,t)=>{const r=this.getWorkingDirectory(e.path);r&&r.resubmitSubDirectoryMessage(e,t)}})}applyStashedOp(e){const t=e,r=this.getWorkingDirectory(t.path);switch(t.type){case"clear":r?.clear();break;case"createSubDirectory":r?.createSubDirectory(t.subdirName);break;case"delete":r?.delete(t.key);break;case"deleteSubDirectory":r?.deleteSubDirectory(t.subdirName);break;case"set":(0,b.R)(t.value,this.serializer,this.handle),r?.set(t.key,t.value.value);break;default:(0,s.$)(t)}}serializeDirectory(e,t,r){const o=new p.qt;let n=0;const i=[],s=[],a={};for(s.push([e,a]);s.length>0;){const[e,r]=s.pop();r.ci=e.getSerializableCreateInfo();for(const[s,a]of e.getSerializedStorage(t)){r.storage||(r.storage={});const t={type:a.type,value:a.value&&JSON.parse(a.value)};if(a.value&&a.value.length>=8192){const r={};let a=r;if(e.absolutePath!==S.sep)for(const t of e.absolutePath.slice(1).split(S.sep)){const e={};a.subdirectories={[t]:e},a=e}a.storage={[s]:t};const c=`blob${n}`;n++,i.push(c),o.addBlob(c,JSON.stringify(r))}else r.storage[s]=t}for(const[t,o]of e.subdirectories()){r.subdirectories||(r.subdirectories={});const e={};r.subdirectories[t]=e,s.push([o,e])}}const c={blobs:i,content:a};return o.addBlob(C,JSON.stringify(c)),o.getSummaryTree()}}function E(e){return void 0!==e&&"number"===typeof e.pendingMessageId&&"edit"===e.type}function N(e){return void 0!==e&&"clear"===e.type&&"number"===typeof e.pendingMessageId&&"object"===typeof e.previousStorage}function I(e){return void 0!==e&&("createSubDir"===e.type||"deleteSubDir"===e.type)}function D(e){(0,i.vA)(null!==e,1711)}let F=!1;class B extends n.X{constructor(e,t,r,o,n,i,s){super(),this.seqData=e,this.clientIds=t,this.directory=r,this.runtime=o,this.serializer=n,this.absolutePath=i,this.logger=s,this._deleted=!1,this[g]="SubDirectory",this._storage=new Map,this._subdirectories=new Map,this.pendingKeys=new Map,this.pendingDeleteSubDirectoriesTracker=new Map,this.pendingCreateSubDirectoriesTracker=new Map,this.pendingMessageId=-1,this.pendingClearMessageIds=[],this.localCreationSeq=0,this.localCreationSeqTracker=new P,this.ackedCreationSeqTracker=new P}dispose(e){this._deleted=!0,this.emit("disposed",this)}undispose(){this._deleted=!1,this.emit("undisposed",this)}get disposed(){return this._deleted}throwIfDisposed(){if(this._deleted)throw new v.eb("Cannot access Disposed subDirectory")}has(e){return this.throwIfDisposed(),this._storage.has(e)}get(e){return this.throwIfDisposed(),this._storage.get(e)}set(e,t){if(this.throwIfDisposed(),void 0===e||null===e)throw new Error("Undefined and null keys are not supported");(0,m.pM)(t,this.serializer,this.directory.handle);const r=this.setCore(e,t,!0);if(!this.directory.isAttached())return this;const o={key:e,path:this.absolutePath,type:"set",value:{type:f.e[f.e.Plain],value:t}};return this.submitKeyMessage(o,r),this}countSubDirectory(){return this._subdirectories.size}createSubDirectory(e){if(this.throwIfDisposed(),void 0===e||null===e)throw new Error("SubDirectory name may not be undefined or null");if(e.includes(S.sep))throw new Error(`SubDirectory name may not contain ${S.sep}`);const t=this.createSubDirectoryCore(e,!0,this.getLocalSeq(),this.runtime.clientId??"detached"),r=this._subdirectories.get(e);if((0,i.vA)(void 0!==r,1450),!this.directory.isAttached())return r;if(t){const t={path:this.absolutePath,subdirName:e,type:"createSubDirectory"};this.submitCreateSubDirectoryMessage(t)}return r}getLocalSeq(){return this.directory.isAttached()?{seq:-1,clientSeq:++this.localCreationSeq}:{seq:0,clientSeq:++this.localCreationSeq}}getSubDirectory(e){return this.throwIfDisposed(),this._subdirectories.get(e)}hasSubDirectory(e){return this.throwIfDisposed(),this._subdirectories.has(e)}deleteSubDirectory(e){this.throwIfDisposed();const t=this.deleteSubDirectoryCore(e,!0);if(!this.directory.isAttached())return void 0!==t;if(void 0!==t){const r={path:this.absolutePath,subdirName:e,type:"deleteSubDirectory"};this.submitDeleteSubDirectoryMessage(r,t)}return void 0!==t}subdirectories(){this.throwIfDisposed();const e=[...this.ackedCreationSeqTracker.keys(),...this.localCreationSeqTracker.keys(e=>!this.ackedCreationSeqTracker.has(e))];if(e.length!==this._subdirectories.size)return F||(this.logger.sendTelemetryEvent({eventName:"inconsistentSubdirectoryOrdering",localKeyCount:this.localCreationSeqTracker.size,ackedKeyCount:this.ackedCreationSeqTracker.size,subdirNamesLength:e.length,subdirectoriesSize:this._subdirectories.size}),F=!0),this._subdirectories.entries();return{index:0,dirs:this._subdirectories,next(){if(this.index<e.length){const t=e[this.index++],r=this.dirs.get(t);return(0,i.vA)(void 0!==r,2220),{value:[t,r],done:!1}}return{value:void 0,done:!0}},[Symbol.iterator](){return this}}}getWorkingDirectory(e){return this.throwIfDisposed(),this.directory.getWorkingDirectory(this.makeAbsolute(e))}isSubDirectoryDeletePending(e){return!!this.pendingDeleteSubDirectoriesTracker.has(e)}delete(e){this.throwIfDisposed();const t=this.deleteCore(e,!0);if(!this.directory.isAttached())return void 0!==t;const r={key:e,path:this.absolutePath,type:"delete"};return this.submitKeyMessage(r,t),void 0!==t}clear(){if(this.throwIfDisposed(),!this.directory.isAttached())return void this.clearCore(!0);const e=new Map(this._storage);this.clearCore(!0);const t={path:this.absolutePath,type:"clear"};this.submitClearMessage(t,e)}forEach(e){this.throwIfDisposed(),this._storage.forEach((t,r)=>{e(t,r,this)})}get size(){return this.throwIfDisposed(),this._storage.size}entries(){return this.throwIfDisposed(),this._storage.entries()}keys(){return this.throwIfDisposed(),this._storage.keys()}values(){return this.throwIfDisposed(),this._storage.values()}[(g=Symbol.toStringTag,Symbol.iterator)](){return this.throwIfDisposed(),this.entries()}processClearMessage(e,t,r,o){if(this.throwIfDisposed(),this.isMessageForCurrentInstanceOfSubDirectory(e)){if(r){(0,i.vA)(N(o),15);const e=this.pendingClearMessageIds.shift();return void(0,i.vA)(e===o.pendingMessageId,810)}this.clearExceptPendingKeys(!1)}}processDeleteMessage(e,t,r,o){this.throwIfDisposed(),this.isMessageForCurrentInstanceOfSubDirectory(e)&&this.needProcessStorageOperation(t,r,o)&&this.deleteCore(t.key,r)}processSetMessage(e,t,r,o,n){this.throwIfDisposed(),this.isMessageForCurrentInstanceOfSubDirectory(e)&&this.needProcessStorageOperation(t,o,n)&&this.setCore(t.key,r,o)}processCreateSubDirectoryMessage(e,t,r,o){this.throwIfDisposed(),this.isMessageForCurrentInstanceOfSubDirectory(e)&&this.needProcessSubDirectoryOperation(e,t,r,o)&&(D(e.clientId),this.createSubDirectoryCore(t.subdirName,r,{seq:e.sequenceNumber,clientSeq:e.clientSequenceNumber},e.clientId))}processDeleteSubDirectoryMessage(e,t,r,o){this.throwIfDisposed(),this.isMessageForCurrentInstanceOfSubDirectory(e)&&this.needProcessSubDirectoryOperation(e,t,r,o)&&this.deleteSubDirectoryCore(t.subdirName,r)}submitClearMessage(e,t){this.throwIfDisposed();const r=++this.pendingMessageId;this.pendingClearMessageIds.push(r);const o={type:"clear",pendingMessageId:r,previousStorage:t};this.directory.submitDirectoryMessage(e,o)}resubmitClearMessage(e,t){(0,i.vA)(N(t),811);this.pendingClearMessageIds.shift()===t.pendingMessageId&&this.submitClearMessage(e,t.previousStorage)}getKeyMessageId(e){const t=++this.pendingMessageId,r=this.pendingKeys.get(e.key);return void 0===r?this.pendingKeys.set(e.key,[t]):r.push(t),t}submitKeyMessage(e,t){this.throwIfDisposed();const r={type:"edit",pendingMessageId:this.getKeyMessageId(e),previousValue:t};this.directory.submitDirectoryMessage(e,r)}resubmitKeyMessage(e,t){(0,i.vA)(E(t),813);const r=this.pendingKeys.get(e.key);if(void 0!==r){const o=r.indexOf(t.pendingMessageId);if(-1===o)return;r.splice(o,1),0===r.length&&this.pendingKeys.delete(e.key),this.submitKeyMessage(e,t.previousValue)}}incrementPendingSubDirCount(e,t){const r=e.get(t)??0;e.set(t,r+1)}decrementPendingSubDirCount(e,t){const r=e.get(t)??0;e.set(t,r-1),r<=1&&e.delete(t)}updatePendingSubDirMessageCount(e){"deleteSubDirectory"===e.type?this.incrementPendingSubDirCount(this.pendingDeleteSubDirectoriesTracker,e.subdirName):"createSubDirectory"===e.type&&this.incrementPendingSubDirCount(this.pendingCreateSubDirectoriesTracker,e.subdirName)}submitCreateSubDirectoryMessage(e){this.throwIfDisposed(),this.updatePendingSubDirMessageCount(e);this.directory.submitDirectoryMessage(e,{type:"createSubDir"})}submitDeleteSubDirectoryMessage(e,t){this.throwIfDisposed(),this.updatePendingSubDirMessageCount(e);const r={type:"deleteSubDir",subDirectory:t};this.directory.submitDirectoryMessage(e,r)}resubmitSubDirectoryMessage(e,t){(0,i.vA)(I(t),815),("createSubDir"!==t.type||this.pendingCreateSubDirectoriesTracker.has(e.subdirName))&&("deleteSubDir"!==t.type||this.pendingDeleteSubDirectoriesTracker.has(e.subdirName))&&("createSubDir"===t.type?(this.decrementPendingSubDirCount(this.pendingCreateSubDirectoriesTracker,e.subdirName),this.submitCreateSubDirectoryMessage(e)):(this.decrementPendingSubDirCount(this.pendingDeleteSubDirectoriesTracker,e.subdirName),this.submitDeleteSubDirectoryMessage(e,t.subDirectory)))}*getSerializedStorage(e){this.throwIfDisposed();for(const[t,r]of this._storage){const o=[t,(0,b.Q)(r,e,this.directory.handle)];yield o}}getSerializableCreateInfo(){this.throwIfDisposed();return{csn:this.seqData.seq,ccIds:[...this.clientIds]}}populateStorage(e,t){this.throwIfDisposed(),this._storage.set(e,t)}populateSubDirectory(e,t){this.throwIfDisposed(),this.registerEventsOnSubDirectory(t,e),this._subdirectories.set(e,t)}getLocalValue(e){return this.throwIfDisposed(),this._storage.get(e)}rollbackPendingMessageId(e,t,r){const o=e.get(t),n=o?.pop();if(!o||n!==r)throw new Error("Rollback op does not match last pending");0===o.length&&e.delete(t)}rollback(e,t){if(!(E(r=t)||N(r)||I(r)))throw new Error("Invalid localOpMetadata");var r;if("clear"===e.type&&"clear"===t.type){for(const[r,o]of t.previousStorage.entries())this.setCore(r,o,!0);const e=this.pendingClearMessageIds.pop();if(void 0===e||e!==t.pendingMessageId)throw new Error("Rollback op does match last clear")}else if("delete"!==e.type&&"set"!==e.type||"edit"!==t.type)if("createSubDirectory"===e.type&&"createSubDir"===t.type){const t=e.subdirName;(0,i.vA)(void 0!==t,2223),(0,i.vA)("string"===typeof t,2224),this.deleteSubDirectoryCore(t,!0),this.decrementPendingSubDirCount(this.pendingCreateSubDirectoriesTracker,t)}else{if("deleteSubDirectory"!==e.type||"deleteSubDir"!==t.type)throw new Error("Unsupported op for rollback");{const r=e.subdirName;(0,i.vA)(void 0!==r,2225),(0,i.vA)("string"===typeof r,2226),void 0!==t.subDirectory&&(this.undeleteSubDirectoryTree(t.subDirectory),this._subdirectories.set(r,t.subDirectory),w(t.subDirectory.seqData)?this.ackedCreationSeqTracker.set(r,{...t.subDirectory.seqData}):this.localCreationSeqTracker.set(r,{...t.subDirectory.seqData}),this.emit("subDirectoryCreated",r,!0,this)),this.decrementPendingSubDirCount(this.pendingDeleteSubDirectoriesTracker,r)}}else{const r=e.key;(0,i.vA)(void 0!==r,2221),(0,i.vA)("string"===typeof r,2222),void 0===t.previousValue?this.deleteCore(r,!0):this.setCore(r,t.previousValue,!0),this.rollbackPendingMessageId(this.pendingKeys,r,t.pendingMessageId)}}makeAbsolute(e){return S.resolve(this.absolutePath,e)}needProcessStorageOperation(e,t,r){const o=this.pendingClearMessageIds[0];if(void 0!==o){if(t){(0,i.vA)(void 0!==r&&E(r)&&r.pendingMessageId<o,16);const t=o,n=this.pendingKeys.get(e.key);if(void 0!==n){let r=0,o=n[r];for(;void 0!==o&&o<t;)r+=1,o=n[r];const i=n.splice(r);0===i.length?this.pendingKeys.delete(e.key):this.pendingKeys.set(e.key,i)}}return!1}const n=this.pendingKeys.get(e.key);return void 0!==n?(t&&((0,i.vA)(void 0!==r&&E(r),17),n[0]!==r.pendingMessageId&&this.logger.sendTelemetryEvent({eventName:"unexpectedPendingMessage",expectedPendingMessage:n[0],actualPendingMessage:r.pendingMessageId,expectedPendingMessagesLength:n.length}),n.shift(),0===n.length&&this.pendingKeys.delete(e.key)),!1):!t}isMessageForCurrentInstanceOfSubDirectory(e){return null!==e.clientId&&this.clientIds.has(e.clientId)||this.clientIds.has("detached")||-1!==this.seqData.seq&&this.seqData.seq<=e.referenceSequenceNumber}needProcessSubDirectoryOperation(e,t,r,o){D(e.clientId);const n=this.pendingDeleteSubDirectoriesTracker.get(t.subdirName),s=this.pendingCreateSubDirectoriesTracker.get(t.subdirName);if(void 0!==n&&n>0||void 0!==s&&s>0){if(r&&((0,i.vA)(I(o),18),"deleteSubDir"===o.type?((0,i.vA)(void 0!==n&&n>0,1730),this.decrementPendingSubDirCount(this.pendingDeleteSubDirectoriesTracker,t.subdirName)):"createSubDir"===o.type&&((0,i.vA)(void 0!==s&&s>0,1731),this.decrementPendingSubDirCount(this.pendingCreateSubDirectoriesTracker,t.subdirName))),"deleteSubDirectory"===t.type){const e=t=>{if(!t)return;t.clearExceptPendingKeys(r),t.seqData.seq=-1,t.seqData.clientSeq=-1,t.clientIds.clear();const o=t.subdirectories();for(const[r,n]of o)t.pendingCreateSubDirectoriesTracker.has(r)?e(n):t.deleteSubDirectoryCore(r,!1)},o=this._subdirectories.get(t.subdirName);this.ackedCreationSeqTracker.delete(t.subdirName),e(o)}if("createSubDirectory"===t.type){const o=this._subdirectories.get(t.subdirName);-1!==this.seqData.seq&&this.seqData.seq<=e.sequenceNumber&&(-1===o?.seqData.seq&&(o.seqData.seq=e.sequenceNumber,o.seqData.clientSeq=e.clientSequenceNumber,this.ackedCreationSeqTracker.has(t.subdirName)||this.pendingDeleteSubDirectoriesTracker.has(t.subdirName)||(this.ackedCreationSeqTracker.set(t.subdirName,{seq:e.sequenceNumber,clientSeq:e.clientSequenceNumber}),r&&this.localCreationSeqTracker.delete(t.subdirName))),void 0!==o&&!o.clientIds.has(e.clientId)&&o.seqData.seq<=e.sequenceNumber&&o.clientIds.add(e.clientId))}return!1}return!r}clearExceptPendingKeys(e){const t=new Map;for(const[r]of this.pendingKeys){const e=this._storage.get(r);void 0!==e&&t.set(r,e)}this.clearCore(e);for(const[r,o]of t.entries())this.setCore(r,o,!0)}clearCore(e){this._storage.clear(),this.directory.emit("clear",e,this.directory)}deleteCore(e,t){const r=this._storage.get(e),o=r;if(this._storage.delete(e)){const r={key:e,path:this.absolutePath,previousValue:o};this.directory.emit("valueChanged",r,t,this.directory);const n={key:e,previousValue:o};this.emit("containedValueChanged",n,t,this)}return r}setCore(e,t,r){const o=this._storage.get(e),n=o;this._storage.set(e,t);const i={key:e,path:this.absolutePath,previousValue:n};this.directory.emit("valueChanged",i,r,this.directory);const s={key:e,previousValue:n};return this.emit("containedValueChanged",s,r,this),o}createSubDirectoryCore(e,t,r,o){const n=this._subdirectories.get(e);if(void 0===n){const n=S.join(this.absolutePath,e),i=new B({...r},new Set([o]),this.directory,this.runtime,this.serializer,n,this.logger);return w(r)?this.ackedCreationSeqTracker.set(e,{...r}):this.localCreationSeqTracker.set(e,{...r}),this.registerEventsOnSubDirectory(i,e),this._subdirectories.set(e,i),this.emit("subDirectoryCreated",e,t,this),!0}return n.clientIds.add(o),!1}registerEventsOnSubDirectory(e,t){e.on("subDirectoryCreated",(e,r)=>{this.emit("subDirectoryCreated",S.join(t,e),r,this)}),e.on("subDirectoryDeleted",(e,r)=>{this.emit("subDirectoryDeleted",S.join(t,e),r,this)})}deleteSubDirectoryCore(e,t){const r=this._subdirectories.get(e);return void 0!==r&&(this._subdirectories.delete(e),this.ackedCreationSeqTracker.has(e)&&this.ackedCreationSeqTracker.delete(e),this.localCreationSeqTracker.has(e)&&this.localCreationSeqTracker.delete(e),this.disposeSubDirectoryTree(r),this.emit("subDirectoryDeleted",e,t,this)),r}disposeSubDirectoryTree(e){if(!e)return;const t=e.subdirectories();for(const[r,o]of t)this.disposeSubDirectoryTree(o);"function"===typeof e.dispose&&e.dispose()}undeleteSubDirectoryTree(e){e.undispose();for(const[t,r]of e.subdirectories())this.undeleteSubDirectoryTree(r)}}var L=r(90876);class x{get type(){return x.Type}get attributes(){return x.Attributes}async load(e,t,r,o){const n=new T(t,e,o);return await n.load(r),n}create(e,t){const r=new T(t,e,x.Attributes);return r.initializeLocal(),r}}x.Type="https://graph.microsoft.com/types/directory",x.Attributes={type:x.Type,snapshotFormatVersion:"0.1",packageVersion:L.z};const A=(0,o.Bm)(x)},21880:(e,t,r)=>{"use strict";r.d(t,{h:()=>Js});var o=r(69235),n=r(23989),i=r(25045);function s(e){let{documentServiceFactory:t,createDocumentRequest:r}=e;return{get FluidDocumentServiceFactoryProvider(){return this},documentServiceFactory:t,getCreateDocumentRequest:r,get Disposable(){return this},dispose:()=>{}}}var a=r(83125),c=r(75335);const d="16.8.2";var l=r(95720);function u(e){const t=Date.now(),r=(0,c.yb)(),{logger:o,...n}=e;return{logger:o&&new a.p(l.Ak,o,{owhVersion:d}),newConfig:n,perfMetadata:{fluidBootstrapperStartTime:t},documentHiddenTrackerId:r}}const h="fluid";function g(e){return e===h||"fluid-odsp"===e||"fluid-odsp-extended"===e||"fluid-odsp-expansive"===e}var p=r(33788),m=r(95996);const f={genericError:"genericError",throttlingError:"throttlingError",dataCorruptionError:"dataCorruptionError",dataProcessingError:"dataProcessingError",usageError:"usageError"},{dataCorruptionError:v,dataProcessingError:y,...b}=f,S={...b,genericNetworkError:"genericNetworkError",authorizationError:"authorizationError",fileNotFoundOrAccessDeniedError:"fileNotFoundOrAccessDeniedError",offlineError:"offlineError",unsupportedClientProtocolVersion:"unsupportedClientProtocolVersion",writeError:"writeError",fetchFailure:"fetchFailure",fetchTokenError:"fetchTokenError",incorrectServerResponse:"incorrectServerResponse",fileOverwrittenInStorage:"fileOverwrittenInStorage",deltaStreamConnectionForbidden:"deltaStreamConnectionForbidden",locationRedirection:"locationRedirection",fluidInvalidSchema:"fluidInvalidSchema",fileIsLocked:"fileIsLocked",outOfStorageError:"outOfStorageError"},C=()=>globalThis.performance.now(),k=10,w=20,P=30;Symbol.toStringTag;const T=new class{constructor(e){this.valueGenerator=e,this._evaluated=!1}get evaluated(){return this._evaluated}get value(){return this._evaluated||(this._evaluated=!0,this._value=this.valueGenerator()),this._value}}(()=>N(F())),E={getRawConfig:()=>{}},N=e=>void 0!==e&&null!==e?new B(void 0,{getRawConfig:t=>{try{return D(e.getItem(t)??void 0)?.raw}catch{return}}}):E;function I(e){switch(e){case"boolean":case"number":case"string":return!0;default:return!1}}function D(e){let t,r=e;if("string"===typeof e)try{r=JSON.parse(e),t={raw:e,string:e}}catch{}if(void 0===r)return t;const o=typeof r;if(I(o))return{...t,raw:e,[o]:r};if(Array.isArray(r)){const o=typeof r[0];if(!I(o))return t;for(const e of r)if(typeof e!==o)return t;return{...t,raw:e,[`${o}[]`]:r}}return t}const F=()=>{try{return globalThis.sessionStorage??void 0}catch{return}};class B{constructor(e){this.logger=e,this.configCache=new Map,this.orderedBaseProviders=[];const t=new Set;for(var r=arguments.length,o=new Array(r>1?r-1:0),n=1;n<r;n++)o[n-1]=arguments[n];const i=[...o];for(;i.length>0;){const e=i.shift();void 0!==e&&O(e)&&!t.has(e)&&(t.add(e),e instanceof B?i.push(...e.orderedBaseProviders):this.orderedBaseProviders.push(e))}}getBoolean(e){return this.getCacheEntry(e)?.boolean}getNumber(e){return this.getCacheEntry(e)?.number}getString(e){return this.getCacheEntry(e)?.string}getBooleanArray(e){return this.getCacheEntry(e)?.["boolean[]"]}getNumberArray(e){return this.getCacheEntry(e)?.["number[]"]}getStringArray(e){return this.getCacheEntry(e)?.["string[]"]}getRawConfig(e){return this.getCacheEntry(e)?.raw}getCacheEntry(e){if(!this.configCache.has(e)){for(const t of this.orderedBaseProviders){const r=D(t?.getRawConfig(e));if(void 0!==r)return this.configCache.set(e,r),this.logger?.send({category:"generic",eventName:"ConfigRead",...ge({configName:e,configValue:JSON.stringify(r)})}),r}this.configCache.set(e,{raw:void 0})}return this.configCache.get(e)}}function L(e){const t=e;return O(t?.config)&&void 0!==t?.logger}function x(e){return L(e)?e:A(e,T.value)}function A(e){if(L(e))throw new Error("Logger is already a monitoring context");const t=e;for(var r=arguments.length,o=new Array(r>1?r-1:0),n=1;n<r;n++)o[n-1]=arguments[n];return t.config=new B(e,...o),t.logger=e,t}function O(e){const t=e;return"function"===typeof t?.getRawConfig}function M(e){return x(ae(e))}const _={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let R;const H=new Uint8Array(16);function U(){if(!R&&(R="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!R))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return R(H)}const j=[];for(let Ks=0;Ks<256;++Ks)j.push((Ks+256).toString(16).slice(1));function q(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return j[e[t+0]]+j[e[t+1]]+j[e[t+2]]+j[e[t+3]]+"-"+j[e[t+4]]+j[e[t+5]]+"-"+j[e[t+6]]+j[e[t+7]]+"-"+j[e[t+8]]+j[e[t+9]]+"-"+j[e[t+10]]+j[e[t+11]]+j[e[t+12]]+j[e[t+13]]+j[e[t+14]]+j[e[t+15]]}const z=function(e,t,r){if(_.randomUUID&&!t&&!e)return _.randomUUID();const o=(e=e||{}).random||(e.rng||U)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=o[e];return t}return q(o)},V=e=>"string"===typeof e?.errorInstanceId;function $(e){return"string"===typeof e?.errorType&&"string"===typeof e?.message&&V(e)&&(t=e,"function"===typeof t?.getTelemetryProperties&&"function"===typeof t?.addTelemetryProperties);var t}const G=e=>null!==e&&!Array.isArray(e)&&"object"===typeof e;function W(e,t){const r={message:"string"===typeof e?.message?e.message:String(e)};if(G(e)){const{errorType:o,stack:n,name:i}=e;if("string"===typeof o&&(r.errorType=o),"string"===typeof n){const e="string"===typeof i?i:void 0;r.stack=((e,r)=>{if(!t)return e;const o=e.split("\n");return o.shift(),void 0!==r&&o.unshift(r),o.join("\n")})(n,e)}}return r}const J=e=>"function"===typeof e?.getTelemetryProperties;function K(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if($(e))return e.addTelemetryProperties(t.props??{}),e;const{message:r,stack:o}=W(e,!1),n=new oe({message:r,stack:o});if("object"===typeof e&&null!==e){const t=e;let r;"canRetry"in e&&(r??={},r.canRetry=t.canRetry),"retryAfterSeconds"in e&&(r??={},r.retryAfterSeconds=t.retryAfterSeconds),void 0!==r&&Object.assign(n,r)}"object"!==typeof e&&n.addTelemetryProperties({typeofError:typeof e});const i=te.typeCheck(e)?e.getTelemetryProperties():{untrustedOrigin:1};return n.addTelemetryProperties({...i,...t.props}),n}let Q;function Y(e){return function(e){const t=Error,r=t.stackTraceLimit;void 0!==e&&(t.stackTraceLimit=e);const o=new Error("<<generated stack>>");if(void 0===Q&&(Q=void 0!==o.stack),Q)return t.stackTraceLimit=r,o;try{throw o}catch(n){return t.stackTraceLimit=r,n}}(e).stack}function Z(e,t){const{message:r,stack:o}=W(e,!1),n=t(r);return void 0!==o&&X(n,o),ee(e)&&n.addTelemetryProperties({untrustedOrigin:1}),V(e)&&(n.overwriteErrorInstanceId(e.errorInstanceId),n.addTelemetryProperties({innerErrorInstanceId:e.errorInstanceId})),J(e)&&n.addTelemetryProperties(e.getTelemetryProperties()),n}function X(e,t){try{Object.assign(e,{stack:t})}catch{e.addTelemetryProperties({stack2:t})}}function ee(e){if(te.typeCheck(e)){if(e.errorType===re){const t=e.getTelemetryProperties();return 1===t.untrustedOrigin||Boolean(t.errorRunningExternalCode)}return!1}return!0}class te extends Error{get errorInstanceId(){return this._errorInstanceId}overwriteErrorInstanceId(e){this._errorInstanceId=e}constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;super(e),this.omitPropsFromLogging=r,this._errorInstanceId=z(),r.add("omitPropsFromLogging"),r.add("_errorInstanceId"),t&&this.addTelemetryProperties(t)}static typeCheck(e){return"object"===typeof e&&null!==e&&("function"===typeof e.addTelemetryProperties&&"function"===typeof e.getTelemetryProperties&&"string"===typeof e.errorInstanceId)}addTelemetryProperties(e){!function(e,t){for(const[r,o]of Object.entries(t))void 0===e[r]&&(e[r]=o)}(this,e)}getTelemetryProperties(){const e={};for(const t of Object.keys(this)){if(this.omitPropsFromLogging.has(t))continue;const r=this[t];e[t]=ue(r)}return{...e,stack:this.stack,message:this.message,errorInstanceId:this._errorInstanceId}}}const re="genericError";class oe extends te{constructor(e){super(e.message),this.errorType=re,void 0!==e.stack&&X(this,e.stack)}}var ne;function ie(e){return Math.floor(e)}!function(e){e.CodeArtifact="CodeArtifact",e.UserData="UserData"}(ne||(ne={}));class se{static sanitizePkgName(e){return e.replace("@","").replace("/","-")}static prepareErrorObject(e,t,r){const{message:o,errorType:n,stack:i}=W(t,!0);if(e.stack=i,e.error=o,e.errorType=n,J(t)){const r=t.getTelemetryProperties();for(const t of Object.keys(r))void 0===e[t]&&(e[t]=r[t])}void 0===e.stack&&r&&(e.stack=Y())}constructor(e,t){this.namespace=e,this.properties=t}sendTelemetryEvent(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:w;this.sendTelemetryEventCore({...e,category:e.category??"generic"},t,"error"===e.category?P:r)}sendTelemetryEventCore(e,t,r){const o=function(e){let{category:t,eventName:r,...o}=e;const n={category:t,eventName:r};for(const i of Object.keys(o))n[i]=ue(o[i]);return n}(e);void 0!==t&&se.prepareErrorObject(o,t,!1),"number"===typeof o.duration&&(o.duration=ie(o.duration)),this.send(o,r)}sendErrorEvent(e,t){this.sendTelemetryEventCore({error:e.eventName,...e,category:"error"},t,P)}sendPerformanceEvent(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:w;const o={...e,category:e.category??"performance"};this.sendTelemetryEventCore(o,t,"error"===o.category?P:r)}prepareEvent(e){const t="error"===e.category||void 0!==e.error,r={...e};return void 0!==this.namespace&&(r.eventName=`${this.namespace}${se.eventNamespaceSeparator}${r.eventName}`),this.extendProperties(r,t)}extendProperties(e,t){const r=e;if(this.properties){const e=[];e.push(this.properties.all),t&&e.push(this.properties.error);for(const t of e)if(void 0!==t)for(const[e,o]of Object.entries(t)){if(void 0!==r[e])continue;const t="function"===typeof o?o():o;void 0!==t&&(r[e]=t)}}return e}}se.eventNamespaceSeparator=":";function ae(e){return ce.create(e?.logger,e?.namespace,e?.properties)}class ce extends se{static create(e,t,r){if(e instanceof ce){const o={};for(const t of[e.properties,r])void 0!==t&&(void 0!==t.all&&(o.all={...o.all,...t.all}),void 0!==t.error&&(o.error={...o.error,...t.error}));const n=void 0===e.namespace?t:void 0===t?e.namespace:`${e.namespace}${se.eventNamespaceSeparator}${t}`,i=new ce(e.baseLogger,n,o);return!L(i)&&L(e)&&A(i,e.config),i}return new ce(e??{send(){}},t,r)}constructor(e,t,r){super(t,r),this.baseLogger=e,L(e)&&A(this,new B(this,e.config))}get minLogLevel(){return this.baseLogger.minLogLevel}shouldFilterOutEvent(e,t){return(t??w)<(this.baseLogger.minLogLevel??w)}send(e,t){this.shouldFilterOutEvent(e,t)||this.baseLogger.send(this.prepareEvent(e),t)}}class de extends se{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3?arguments[3]:void 0,n=void 0===t?void 0:{...t};if(!0===o){const e=n??={};r.filter(e=>e instanceof se).map(e=>e.properties??{}).forEach(t=>{Object.keys(t).forEach(r=>{e[r]={...t[r],...e?.[r]}})})}super(e,n),this.loggers=r,this._minLogLevelOfAllLoggers=w,this.calculateMinLogLevel()}get minLogLevel(){return this._minLogLevelOfAllLoggers}calculateMinLogLevel(){if(this.loggers.length>0){const e=[];for(const t of this.loggers)e.push(t.minLogLevel??w);this._minLogLevelOfAllLoggers=Math.min(...e)}}addLogger(e){void 0!==e&&null!==e&&(this.loggers.push(e),this.calculateMinLogLevel())}send(e){const t=this.prepareEvent(e);for(const r of this.loggers)r.send(t)}}class le{static start(e,t,r){return new le(e,t,r,!(arguments.length>3&&void 0!==arguments[3])||arguments[3])}static timedExec(e,t,r,o){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;const i=le.start(e,t,o,le.shouldReport(t,n));try{const e=r(i);return i.autoEnd(),e}catch(s){throw i.cancel(void 0,s),s}}static async timedExecAsync(e,t,r,o){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;const i=le.start(e,t,o,le.shouldReport(t,n));try{const e=await r(i);return i.autoEnd(),e}catch(s){throw i.cancel(void 0,s),s}}get duration(){return C()-this.startTime}constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{end:!0,cancel:"generic"},o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.logger=e,this.markers=r,this.emitLogs=o,this.startTime=C(),this.event={...t},this.markers.start&&this.reportEvent("start"),"object"===typeof window&&void 0!==window?.performance?.mark&&null!==window?.performance?.mark&&(this.startMark=`${t.eventName}-start`,window.performance.mark(this.startMark))}reportProgress(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"update";this.reportEvent(t,e)}autoEnd(){this.event&&this.markers.end&&this.reportEvent("end"),this.performanceEndMark(),this.event=void 0}end(e){this.reportEvent("end",e),this.performanceEndMark(),this.event=void 0}performanceEndMark(){if(void 0!==this.startMark&&this.event){const e=`${this.event.eventName}-end`;window.performance.mark(e),window.performance.measure(`${this.event.eventName}`,this.startMark,e),this.startMark=void 0}}cancel(e,t){void 0!==this.markers.cancel&&this.reportEvent("cancel",{category:this.markers.cancel,...e},t),this.event=void 0}reportEvent(e,t,r){if(!this.event)return;if(!this.emitLogs)return;const o={...this.event,...t};o.eventName=`${o.eventName}_${e}`,"start"!==e&&(o.duration=this.duration),this.logger.sendPerformanceEvent(o,r)}static shouldReport(e,t){const r=`.${e.category}.${e.eventName}`,o=le.eventHits.get(r)??0;return le.eventHits.set(r,o>=t?1:o+1),o%t===0}}function ue(e){return function(e){return"string"===typeof e?.tag}(e)?{value:he(e.value),tag:e.tag}:he(e)}function he(e){switch(typeof e){case"string":case"number":case"boolean":case"undefined":return e;case"object":return JSON.stringify(e);default:return console.error(`convertToBasePropertyTypeUntagged: INVALID PROPERTY (typed as ${typeof e})`),`INVALID PROPERTY (typed as ${typeof e})`}}le.eventHits=new Map;const ge=e=>((e,t)=>Object.entries(t).filter(e=>void 0!==e[1]).reduce((t,r)=>{const[o,n]=r;return t[o]="function"===typeof n?()=>({tag:e,value:n()}):{tag:e,value:n},t},{}))(ne.CodeArtifact,e);function pe(e){return"object"===typeof e&&null!==e&&e.errorType===S.locationRedirection}async function me(e,t,r,o){let n=t;const i=ae({logger:o,namespace:"LocationRedirection"});for(;;)try{return await e(n)}catch(s){if(!pe(s))throw s;i.sendTelemetryEvent({eventName:"LocationRedirectionError"});const e=s.redirectUrl;n={url:await r.getAbsoluteUrl(e,"",void 0),headers:n.headers}}}var fe=r(53783);function ve(e){if("object"!==typeof(t=e)||null===t)return!1;var t;const r=e.errorType,o=e.statusCode;return"fileNotFoundOrAccessDeniedError"===r&&404===o}var ye=r(75460),be=r(52563),Se=r(98140);var Ce,ke=r(60257);!function(e){e.Detached="Detached",e.Attaching="Attaching",e.Attached="Attached"}(Ce||(Ce={}));var we=r(78632);const Pe="Open",Te="PostBoot",Ee="FileOpenFailed",Ne="ComponentLoadError",Ie="ContainerConnectedTimeout",De="ContainerLoadError";var Fe=r(87804),Be=r(93586);const Le="Loading chunk\\s[a-zA-Z0-9_-]+\\sfailed";function xe(e,t,r,o,n,i,s){const c=new a.p("QoS",e);(0,m.hO)(c,{eventName:t,pillar:r,veto:o,errorType:n,isAce:!Ae(s),...i},s)}function Ae(e){if(!e)return!1;const t=e;return!(!t.errorType||![Fe.a.offlineError,Fe.a.fileNotFoundOrAccessDeniedError,Fe.a.authorizationError,Be.E.snapshotTooBig,Be.E.invalidFileNameError,Fe.a.fileOverwrittenInStorage,Ie].some(e=>e===t.errorType))||!(!t.message||!new RegExp(Le).test(t.message))}const Oe=(e,t,r)=>{(0,we.t)(6e4,[r]).then(r=>{if(r&&!e.closed){const e=Ie;xe(t,l.Qk,Te,"ContainerConnectFailed",e,{},{message:"Timed out while connecting the container",errorType:e}),(0,m.hO)(t,{eventName:l.Qk,errorType:e,isUserImpacting:!0},{message:"Timed out while connecting the container",errorType:e})}}).catch(()=>{})},Me=(e,t)=>{const r={},o=e.resolvedUrl;o&&"id"in o&&(r.docId=o.id),t.PersistedProperties?.addPersistedProperties(r)},_e=(e,t)=>{const r=new ye.c;e.attachState!==Ce.Attached?e.once("attached",()=>{Me(e,t),Oe(e,t,r)}):(Me(e,t),Oe(e,t,r)),e.once("closed",r=>{r&&(xe(t,l.Qk,Te,"PostBootContainerClosed",r.errorType,{},r),(0,m.hO)(t,{eventName:l.Qk,errorType:r.errorType||l.Qk,isUserImpacting:!0,isExpected:ve(r),isDirty:e.isDirty},r))}),e.once("connected",()=>{r.resolve()})};var Re,He=r(65317);class Ue{get Disposable(){return this}get NamespaceLogger(){return this}sendWithNamespace(e,t){this.runtimeLogger.sendWithNamespace(e,t)}send(e){let t=e;if("performance"===e.category){const r=e.duration,o=Date.now(),n="number"===typeof r?o-r:void 0;t={...this.perfMetadata,startTime:n,documentEverHidden:this.documentHiddenTrackerId&&(0,c.xl)(this.documentHiddenTrackerId)>-1,...t}}void 0===t.opMessageAgeMs&&"number"===typeof t.messageTimestamp&&(t={opMessageAgeMs:Date.now()-t.messageTimestamp,...t}),t.message&&(t.message=(0,He.ku)(t.message.toString())),t.stack&&(t.stack=(0,He.ku)(t.stack.toString())),t.error&&(t.error=(0,He.ku)(t.error.toString())),t.errorMessage&&(t.errorMessage=(0,He.ku)(t.errorMessage.toString())),t.responseMessage&&(t.responseMessage=(0,He.ku)(t.responseMessage.toString())),this.runtimeLogger.send(t)}dispose(){this.runtimeLogger.Disposable.dispose()}constructor(e,t,r,o){this.perfMetadata=t,this.documentHiddenTrackerId=r,this.runtimeLogger=new a.p("FluidRuntime",e,o)}}function je(e){e.closed||e.attachState!==Ce.Attached&&void 0!==e.attachState||e.connect()}!function(e){e[e.Disconnected=0]="Disconnected",e[e.EstablishingConnection=3]="EstablishingConnection",e[e.CatchingUp=1]="CatchingUp",e[e.Connected=2]="Connected"}(Re||(Re={}));var qe,ze=r(13760);class Ve extends ze.b{constructor(){super(),this.addListener=super.addListener.bind(this),this.on=super.on.bind(this),this.once=super.once.bind(this),this.prependListener=super.prependListener.bind(this),this.prependOnceListener=super.prependOnceListener.bind(this),this.removeListener=super.removeListener.bind(this),this.off=super.off.bind(this)}}!function(e){e.Detached="Detached",e.Attaching="Attaching",e.Attached="Attached"}(qe||(qe={}));const $e=e=>"object"===typeof e&&"string"===typeof e?.name&&"object"===typeof e?.fluid,Ge=e=>{const t=e;return"object"===typeof t&&("string"===typeof t?.package||$e(t?.package))&&(void 0===t?.config||"object"===typeof t?.config)};function We(e,t){e||function(e){throw new Error("number"===typeof e?`0x${e.toString(16).padStart(3,"0")}`:e)}(t)}const Je=e=>"object"===typeof e&&null!==e;function Ke(e){throw new Error(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Unreachable Case")}var Qe,Ye,Ze,Xe;!function(e){e.Tree=1,e.Blob=2,e.Handle=3,e.Attachment=4}(Qe||(Qe={})),function(e){e.NoOp="noop",e.ClientJoin="join",e.ClientLeave="leave",e.Propose="propose",e.Reject="reject",e.Accept="accept",e.Summarize="summarize",e.SummaryAck="summaryAck",e.SummaryNack="summaryNack",e.Operation="op",e.NoClient="noClient",e.RoundTrip="tripComplete",e.Control="control"}(Ye||(Ye={})),function(e){e.ClientJoin="join",e.ClientLeave="leave"}(Ze||(Ze={})),function(e){e.ThrottlingError="ThrottlingError",e.InvalidScopeError="InvalidScopeError",e.BadRequestError="BadRequestError",e.LimitExceededError="LimitExceededError"}(Xe||(Xe={}));const et=async e=>new Promise(t=>setTimeout(()=>t(),e));var tt;function rt(){return"object"===typeof navigator&&null!==navigator&&"boolean"===typeof navigator.onLine?navigator.onLine?tt.Online:tt.Offline:tt.Unknown}!function(e){e[e.Offline=0]="Offline",e[e.Online=1]="Online",e[e.Unknown=2]="Unknown"}(tt||(tt={}));class ot extends te{constructor(e,t,r){super(e,r),this.canRetry=t,this.errorType=S.genericNetworkError}}class nt extends te{constructor(e,t,r){super(e,{...t,statusCode:400}),this.errorType=nt.errorType,this.canRetry=!1,this.storageOnlyReason=r}}nt.errorType=S.deltaStreamConnectionForbidden;class it extends te{constructor(e,t,r,o){super(e,o),this.errorType=t,this.canRetry=r}}class st extends it{constructor(e,t,r){super(e,t,!1,r),this.errorType=t}}class at extends te{constructor(e,t,r){super(e,r),this.retryAfterSeconds=t,this.errorType=S.throttlingError,this.canRetry=!0}}const ct=e=>!0===e?.canRetry,dt=e=>void 0!==e?.retryAfterSeconds?1e3*e.retryAfterSeconds:void 0;async function lt(e,t,r,o){let n,i=!1,s=500,a=0;const c=C();let d;do{try{n=await e(o.cancel),i=!0}catch(l){if(!ct(l))throw r.sendTelemetryEvent({eventName:`${t}_cancel`,retry:a,duration:C()-c,fetchCallName:t},l),l;if(!0===o.cancel?.aborted)throw r.sendTelemetryEvent({eventName:`${t}_runWithRetryAborted`,retry:a,duration:C()-c,fetchCallName:t,reason:o.cancel.reason},l),new st("runWithRetry was Aborted",S.genericError,{driverVersion:"2.23.0",fetchCallName:t,reason:o.cancel.reason});0===a&&r.sendTelemetryEvent({eventName:`${t}_firstFailed`,duration:C()-c,fetchCallName:t},l),a++,d=l,s=gt(s,l),o.onRetry&&o.onRetry(s,l),await et(s)}}while(!i);return a>0&&r.sendTelemetryEvent({eventName:`${t}_lastError`,retry:a,duration:C()-c,fetchCallName:t},d),n}const ut=6e4,ht=8e3;function gt(e,t){const r=dt(t);let o=Math.max(r??0,2*e);return o=Math.min(o,$(t)&&!0===t.getTelemetryProperties().endpointReached?ut:ht),o}function pt(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];if(void 0===e?.tree||e.tree?.[".app"]?.type!==Qe.Tree||e.tree?.[".protocol"]?.type!==Qe.Tree)return!1;return 2===Object.keys(e.tree).filter(e=>!r.includes(e)).length}function mt(e){return void 0!==e&&"snapshotFormatV"in e&&1===e.snapshotFormatV}function ft(e){return mt(e)?e.snapshotTree:e}var vt=r(34445);function yt(e,t){switch(t){case"base64":return vt.fromByteArray(e);case"utf8":case"utf-8":case void 0:return(new TextDecoder).decode(e);default:throw new Error("invalid/unsupported encoding")}}const bt=(e,t)=>kt.from(e,t).buffer,St=(e,t)=>kt.from(e).toString(t);function Ct(e){const t=e;return e instanceof ArrayBuffer||"object"===typeof t&&null!==t&&"number"===typeof t.byteLength&&"function"===typeof t.slice&&void 0===t.byteOffset&&void 0===t.buffer}class kt extends Uint8Array{toString(e){return yt(this,e)}static from(e,t,r){if("string"===typeof e)return kt.fromString(e,t);if(null!==e&&"object"===typeof e&&Ct(e.buffer))return kt.fromArrayBuffer(e.buffer,e.byteOffset,e.byteLength);if(Ct(e))return kt.fromArrayBuffer(e,t,r);throw new TypeError("Input value was neither a string nor an ArrayBuffer.")}static fromArrayBuffer(e,t,r){const o=t??0,n=r??e.byteLength-o;if(o<0||o>e.byteLength||n<0||n+o>e.byteLength)throw new RangeError("Invalid range specified.");return new kt(e,o,n)}static fromString(e,t){switch(t){case"base64":{const t=this.sanitizeBase64(e),r=vt.toByteArray(t);return new kt(r.buffer)}case"utf8":case"utf-8":case void 0:{const t=(new TextEncoder).encode(e);return new kt(t.buffer)}default:throw new Error("invalid/unsupported encoding")}}static isBuffer(e){throw new Error("unimplemented")}static sanitizeBase64(e){let t=e;if(t=t.split("=")[0],t=t.replace(/[^\w+-/]/g,""),t.length%4!==0){t+=["","===","==","="][t.length%4]}return t}}async function wt(e,t){const r=await e.readBlob(t),o=St(r,"utf8");return JSON.parse(o)}class Pt extends te{constructor(e,t,r){super(e,r,new Set(["error"])),this.error=t,this.errorType=f.genericError}}class Tt extends te{constructor(e,t){super(e,{...t,usageError:!0}),this.errorType=f.usageError}}class Et extends te{constructor(e,t){super(e,{...t,dataProcessingError:1}),this.errorType=f.dataCorruptionError,this.canRetry=!1}}class Nt extends te{constructor(e,t){super(e,t),this.errorType=f.dataProcessingError,this.canRetry=!1}static create(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const n=Nt.wrapIfUnrecognized(e,t,r);return n.addTelemetryProperties(o),n}static wrapIfUnrecognized(e,t,r){const o=K(e,{props:{dataProcessingError:1,dataProcessingCodepath:t,...void 0===r?void 0:It(r)}});if(ee(o)||o.errorType===re){const e=Z(o,e=>new Nt(e));return e.addTelemetryProperties(o.getTelemetryProperties()),e}return o}}const It=e=>({messageClientId:null===e.clientId?"null":e.clientId,messageSequenceNumber:e.sequenceNumber,messageClientSequenceNumber:e.clientSequenceNumber,messageReferenceSequenceNumber:e.referenceSequenceNumber,messageMinimumSequenceNumber:e.minimumSequenceNumber,messageTimestamp:e.timestamp}),Dt="connected";class Ft extends Ve{constructor(e){super(),this.errorHandler=e}emit(e){try{for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return super.emit(e,...r)}catch(n){return this.errorHandler(e,n),!0}}}const Bt="object"===typeof self?self:globalThis,Lt=e=>((e,t)=>{const r=(t,r)=>(e.set(r,t),t),o=n=>{if(e.has(n))return e.get(n);const[i,s]=t[n];switch(i){case 0:case-1:return r(s,n);case 1:{const e=r([],n);for(const t of s)e.push(o(t));return e}case 2:{const e=r({},n);for(const[t,r]of s)e[o(t)]=o(r);return e}case 3:return r(new Date(s),n);case 4:{const{source:e,flags:t}=s;return r(new RegExp(e,t),n)}case 5:{const e=r(new Map,n);for(const[t,r]of s)e.set(o(t),o(r));return e}case 6:{const e=r(new Set,n);for(const t of s)e.add(o(t));return e}case 7:{const{name:e,message:t}=s;return r(new Bt[e](t),n)}case 8:return r(BigInt(s),n);case"BigInt":return r(Object(BigInt(s)),n);case"ArrayBuffer":return r(new Uint8Array(s).buffer,s);case"DataView":{const{buffer:e}=new Uint8Array(s);return r(new DataView(e),s)}}return r(new Bt[i](s),n)};return o})(new Map,e)(0),xt="",{toString:At}={},{keys:Ot}=Object,Mt=e=>{const t=typeof e;if("object"!==t||!e)return[0,t];const r=At.call(e).slice(8,-1);switch(r){case"Array":return[1,xt];case"Object":return[2,xt];case"Date":return[3,xt];case"RegExp":return[4,xt];case"Map":return[5,xt];case"Set":return[6,xt];case"DataView":return[1,r]}return r.includes("Array")?[1,r]:r.includes("Error")?[7,r]:[2,r]},_t=e=>{let[t,r]=e;return 0===t&&("function"===r||"symbol"===r)},Rt=function(e){let{json:t,lossy:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=[];return((e,t,r,o)=>{const n=(e,t)=>{const n=o.push(e)-1;return r.set(t,n),n},i=o=>{if(r.has(o))return r.get(o);let[s,a]=Mt(o);switch(s){case 0:{let t=o;switch(a){case"bigint":s=8,t=o.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+a);t=null;break;case"undefined":return n([-1],o)}return n([s,t],o)}case 1:{if(a){let e=o;return"DataView"===a?e=new Uint8Array(o.buffer):"ArrayBuffer"===a&&(e=new Uint8Array(o)),n([a,[...e]],o)}const e=[],t=n([s,e],o);for(const r of o)e.push(i(r));return t}case 2:{if(a)switch(a){case"BigInt":return n([a,o.toString()],o);case"Boolean":case"Number":case"String":return n([a,o.valueOf()],o)}if(t&&"toJSON"in o)return i(o.toJSON());const r=[],c=n([s,r],o);for(const t of Ot(o))!e&&_t(Mt(o[t]))||r.push([i(t),i(o[t])]);return c}case 3:return n([s,o.toISOString()],o);case 4:{const{source:e,flags:t}=o;return n([s,{source:e,flags:t}],o)}case 5:{const t=[],r=n([s,t],o);for(const[n,s]of o)(e||!_t(Mt(n))&&!_t(Mt(s)))&&t.push([i(n),i(s)]);return r}case 6:{const t=[],r=n([s,t],o);for(const n of o)!e&&_t(Mt(n))||t.push(i(n));return r}}const{message:c}=o;return n([s,{name:a,message:c}],o)};return i})(!(t||r),!!t,new Map,o)(e),o},Ht="function"===typeof structuredClone?(e,t)=>t&&("json"in t||"lossy"in t)?Lt(Rt(e,t)):structuredClone(e):(e,t)=>Lt(Rt(e,t));function Ut(e){const t=new URL(e);if("string"!==typeof t.pathname)throw new te("Failed to parse pathname");const r=t.search??"",o=/^\/([^/]*\/[^/]*)(\/?.*)$/.exec(t.pathname);return 3===o?.length?{id:o[1],path:o[2],query:r,version:t.searchParams.get("version")??void 0}:void 0}function jt(e,t){We(!pt(e),1448),We(!pt(t),1449);return{type:Qe.Tree,tree:{".protocol":t,".app":e}}}function qt(e){let t={};const r={blobs:{},trees:{},id:z(),unreferenced:e.unreferenced,groupId:e.groupId};for(const[o,n]of Object.entries(e.tree))switch(n.type){case Qe.Tree:{const e=qt(n);r.trees[o]=e.baseSnapshot,t={...t,...e.snapshotBlobs};break}case Qe.Attachment:r.blobs[o]=n.id;break;case Qe.Blob:{const e=z();r.blobs[o]=e;const i=n.content instanceof Uint8Array?yt(n.content):n.content;t[e]=i;break}case Qe.Handle:throw new te("No handles should be there in summary in detached container!!");default:Ke(n,`Unknown tree type ${n.type}`)}return{baseSnapshot:r,snapshotBlobs:t}}function zt(e){We(void 0!==e.sequenceNumber,2362);const t={};for(const[r,o]of e.blobContents.entries())t[r]=St(o,"utf8");return{baseSnapshot:e.snapshotTree,snapshotBlobs:t,snapshotSequenceNumber:e.sequenceNumber}}function Vt(e,t){const r={type:Qe.Tree,tree:{...t.tree}};r.tree[".protocol"]=e;return qt(r)}const $t=e=>{We(pt(e),2278);return Vt(e.tree[".protocol"],e.tree[".app"])};function Gt(e){return".protocol"in e.trees?e.trees[".protocol"]:e}const Wt=(e,t)=>{const r={};for(const[,n]of Object.entries(e.blobs))void 0!==t[n]&&(r[n]=bt(t[n],"utf8"));const o={};for(const[n,i]of Object.entries(e.trees))o[n]=Wt(i,t);return{...e,blobsContents:r,trees:o}};function Jt(e){return"object"===typeof e&&null!==e&&e?.errorType===S.deltaStreamConnectionForbidden}const Kt=e=>{let t;return function(){for(var r=arguments.length,o=new Array(r),n=0;n<r;n++)o[n]=arguments[n];return void 0!==t?function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(e,t)=>Object.is(e,t);return e===t||e.length===t.length&&e.every((e,o)=>r(e,t[o],o))}(t.args,o)?t.result:Promise.reject(new Tt("Subsequent calls cannot use different arguments.")):(t={args:o,result:e(...o).finally(()=>t=void 0)},t.result)}};async function Qt(e,t){if(void 0===t)return{minimumSequenceNumber:0,sequenceNumber:0};const r=".protocol"in t.trees?t.trees[".protocol"].blobs.attributes:t.blobs[".attributes"];return await wt(e,r)}class Yt extends Ve{constructor(){super(),this.members=new Map,super.setMaxListeners(0)}getSelf(){return void 0===this._currentClientId?void 0:{clientId:this._currentClientId,client:this.getMember(this._currentClientId)}}setCurrentClientId(e){if(this._currentClientId!==e){const t=this._currentClientId;this._currentClientId=e,this.emit("selfChanged",void 0===t?void 0:{clientId:t},{clientId:e,client:this.getMember(e)})}}addMember(e,t){if(this.members.has(e)){const r=this.members.get(e);We(JSON.stringify(r)===JSON.stringify(t),1202)}else this.members.set(e,t),this.emit("addMember",e,t)}removeMember(e){const t=this.members.get(e);return void 0!==t&&(this.members.delete(e),this.emit("removeMember",e,t),!0)}getMembers(){return new Map(this.members)}getMember(e){return this.members.get(e)}}var Zt,Xt;function er(e,t,r){const o={...t},n=r?.online;if(o.online="string"===typeof n?n:tt[rt()],"object"===typeof navigator&&null!==navigator){const e=navigator,t=e.connection??e.mozConnection??e.webkitConnection;null!==t&&"object"===typeof t&&(o.connectionType=t.type)}o.category=ct(r)?"generic":"error",e.sendTelemetryEvent(o,r)}function tr(e){return e.type===Ye.Operation}!function(e){e.DocRead="doc:read",e.DocWrite="doc:write",e.SummaryWrite="summary:write"}(Zt||(Zt={})),function(e){e.Never="Never",e.Disabled="Disabled",e.Enabled="Enabled"}(Xt||(Xt={}));const rr=e=>({name:$e(e?.package)?e?.package.name:e?.package});var or=r(71724);class nr extends Ve{get disposed(){return this.isDisposed}get paused(){return 0!==this.pauseCount}get length(){return this.q.length}get idle(){return void 0===this.processingPromise&&0===this.q.length}async waitTillProcessingDone(){return this.processingPromise??{count:0,duration:0}}constructor(e){super(),this.worker=e,this.isDisposed=!1,this.q=new or,this.pauseCount=1}dispose(){throw new Error("Not implemented.")}clear(){this.q.clear()}peek(){return this.q.peekFront()}toArray(){return this.q.toArray()}push(e){try{this.q.push(e),this.emit("push",e),this.ensureProcessing()}catch(t){this.emit("error",t)}}async pause(){this.pauseCount++,await this.waitTillProcessingDone()}resume(){We(this.pauseCount>0,244),this.pauseCount--,this.ensureProcessing()}ensureProcessing(){this.anythingToProcess()&&void 0===this.processingPromise&&(this.processingPromise=Promise.resolve().then(()=>{We(void 0!==this.processingPromise,895);const e=this.processDeltas();return We(void 0!==this.processingPromise,896),this.processingPromise=void 0,e}).catch(e=>(this.error=e,this.processingPromise=void 0,this.emit("error",e),{count:0,duration:0})),We(void 0!==this.processingPromise,897))}anythingToProcess(){return this.q.length>0&&!this.paused&&void 0===this.error}processDeltas(){const e=C();let t=0;for(;this.anythingToProcess();){const e=this.q.shift();t++,this.worker(e),this.emit("op",e)}const r=C()-e;return 0===this.q.length&&this.emit("idle",t,r),{count:t,duration:r}}}var ir=r(87987);const{EventEmitter:sr}=ir;class ar{constructor(e,t,r,o){this.sequenceNumber=e,this.key=t,this.value=r,this.local=o}}class cr extends Ve{get disposed(){return this.isDisposed}constructor(e){super(),this.isDisposed=!1,this.members=new Map(e),this.snapshotCache=e}snapshot(){return this.snapshotCache??=[...this.members],this.snapshotCache}addMember(e,t){We(!!e,2464),We(!this.members.has(e),2465),this.members.set(e,t),this.emit("addMember",e,t),this.snapshotCache=void 0}removeMember(e){We(!!e,2466),We(this.members.has(e),2467),this.members.delete(e),this.emit("removeMember",e),this.snapshotCache=void 0}getMembers(){return new Map(this.members)}getMember(e){return this.members.get(e)}dispose(){this.isDisposed=!0}}class dr extends Ve{get disposed(){return this.isDisposed}constructor(e,t){super(),this.sendProposal=t,this.isDisposed=!1,this.stateEvents=new sr,this.proposals=new Map(e.proposals.map(e=>{let[,t]=e;return[t.sequenceNumber,new ar(t.sequenceNumber,t.key,t.value,!1)]})),this.values=new Map(e.values),this.proposalsSnapshotCache=e.proposals,this.valuesSnapshotCache=e.values}snapshot(){return this.proposalsSnapshotCache??=[...this.proposals].map(e=>{let[t,r]=e;return[t,{sequenceNumber:t,key:r.key,value:r.value},[]]}),this.valuesSnapshotCache??=[...this.values],{proposals:this.proposalsSnapshotCache,values:this.valuesSnapshotCache}}has(e){return this.values.has(e)}get(e){return this.values.get(e)?.value}async propose(e,t){const r=this.sendProposal(e,t);if(r<0)throw this.emit("error",{eventName:"ProposalInDisconnectedState",key:e}),new Error("Can't propose in disconnected state");return new Promise((e,t)=>{let o;const n=(e,t)=>{e===r&&(o=t,this.stateEvents.off("localProposalSequenced",n),this.stateEvents.off("disconnected",s),this.stateEvents.on("localProposalApproved",i))},i=t=>{t===o&&(e(),c())},s=()=>{void 0===o&&this.stateEvents.once("connected",()=>{void 0===o&&(t(new Error("Client disconnected without successfully sending proposal")),c())})},a=()=>{t(new Error("QuorumProposals was disposed")),c()},c=()=>{this.stateEvents.off("localProposalSequenced",n),this.stateEvents.off("localProposalApproved",i),this.stateEvents.off("disconnected",s),this.stateEvents.off("disposed",a)};this.stateEvents.on("localProposalSequenced",n),this.stateEvents.on("disconnected",s),this.stateEvents.on("disposed",a)})}addProposal(e,t,r,o,n){We(!this.proposals.has(r),2468);const i=new ar(r,e,t,o);this.proposals.set(r,i),this.emit("addProposal",i),o&&this.stateEvents.emit("localProposalSequenced",n,r),this.proposalsSnapshotCache=void 0}updateMinimumSequenceNumber(e){const t=e.minimumSequenceNumber,r=[];for(const[o,n]of this.proposals)o<=t&&r.push(n);r.sort((e,t)=>e.sequenceNumber-t.sequenceNumber);for(const o of r){const t={approvalSequenceNumber:e.sequenceNumber,commitSequenceNumber:-1,key:o.key,sequenceNumber:o.sequenceNumber,value:o.value};this.values.set(t.key,t),this.valuesSnapshotCache=void 0;let r=!1,n=!1;for(const[,e]of this.proposals)if(e.key===t.key){if(n){r=!1;break}r=!0,n=!0}this.emit("approveProposal",t.sequenceNumber,t.key,t.value,t.approvalSequenceNumber),r&&this.emit("approveProposalComplete",t.sequenceNumber,t.key,t.value,t.approvalSequenceNumber),this.proposals.delete(o.sequenceNumber),this.proposalsSnapshotCache=void 0,o.local&&this.stateEvents.emit("localProposalApproved",o.sequenceNumber)}}setConnectionState(e){e?this.stateEvents.emit("connected"):this.stateEvents.emit("disconnected")}dispose(){this.isDisposed=!0,this.stateEvents.emit("disposed")}}class lr extends Ve{get disposed(){return this.isDisposed}constructor(e,t,r,o){super(),this.isDisposed=!1,this.quorumClients=new cr(e),this.quorumClients.on("addMember",(e,t)=>{this.emit("addMember",e,t)}),this.quorumClients.on("removeMember",e=>{this.emit("removeMember",e)}),this.quorumProposals=new dr({proposals:t,values:r},o),this.quorumProposals.on("addProposal",e=>{this.emit("addProposal",e)}),this.quorumProposals.on("approveProposal",(e,t,r,o)=>{this.emit("approveProposal",e,t,r,o)})}close(){this.removeAllListeners()}snapshot(){const e=this.quorumClients.snapshot(),{proposals:t,values:r}=this.quorumProposals.snapshot();return{members:e,proposals:t,values:r}}has(e){return this.quorumProposals.has(e)}get(e){return this.quorumProposals.get(e)}addMember(e,t){this.quorumClients.addMember(e,t)}removeMember(e){this.quorumClients.removeMember(e)}getMembers(){return this.quorumClients.getMembers()}getMember(e){return this.quorumClients.getMember(e)}async propose(e,t){return this.quorumProposals.propose(e,t)}addProposal(e,t,r,o,n){return this.quorumProposals.addProposal(e,t,r,o,n)}updateMinimumSequenceNumber(e){this.quorumProposals.updateMinimumSequenceNumber(e)}setConnectionState(e,t){this.quorumProposals.setConnectionState(e)}dispose(){throw new Error("Not implemented.")}}class ur{get quorum(){return this._quorum}constructor(e,t,r,o,n,i){this.minimumSequenceNumber=e,this.sequenceNumber=t,this._quorum=new lr(r,o,n,i)}get attributes(){return{minimumSequenceNumber:this.minimumSequenceNumber,sequenceNumber:this.sequenceNumber}}setConnectionState(e,t){this._quorum.setConnectionState(e,t)}snapshot(){return this._quorum.snapshot()}close(){this._quorum.close()}processMessage(e,t){if(e.sequenceNumber!==this.sequenceNumber+1)throw new Error(`Protocol state is not moving sequentially. Current is ${this.sequenceNumber}. Next is ${e.sequenceNumber}`);this.sequenceNumber=e.sequenceNumber,this.minimumSequenceNumber=e.minimumSequenceNumber;let r=!1;switch(e.type){case Ye.ClientJoin:{const t=e,r=JSON.parse(t.data),o={client:r.detail,sequenceNumber:t.sequenceNumber};this._quorum.addMember(r.clientId,o);break}case Ye.ClientLeave:{const t=e,r=JSON.parse(t.data);this._quorum.removeMember(r);break}case Ye.Propose:{"string"===typeof e.contents&&(e.contents=JSON.parse(e.contents));const o=e.contents;this._quorum.addProposal(o.key,o.value,e.sequenceNumber,t,e.clientSequenceNumber),r=!0;break}}return this._quorum.updateMinimumSequenceNumber(e),{immediateNoOp:r}}getProtocolState(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this._quorum.snapshot();return e&&(t.members=t.members.map(e=>{let[t,r]=e;return[t,{...r,client:{...r.client,user:{id:""}}}]})),{sequenceNumber:this.sequenceNumber,minimumSequenceNumber:this.minimumSequenceNumber,...t}}}var hr;!function(e){e.ClientJoin="join",e.ClientLeave="leave",e.Clear="clear"}(hr||(hr={}));class gr extends ur{constructor(e,t,r,o,n){super(e.minimumSequenceNumber,e.sequenceNumber,t.members,t.proposals,t.values,r),this.audience=o,this.shouldClientHaveLeft=n;for(const[i,s]of this.quorum.getMembers())o.addMember(i,s.client);this.quorum.on("addMember",(e,t)=>o.addMember(e,t.client)),this.quorum.on("removeMember",e=>o.removeMember(e))}processMessage(e,t){if(null!=e.clientId){if(void 0===this.quorum.getMember(e.clientId)&&e.type!==Ye.ClientJoin)throw new Error("Remote message's clientId is missing from the quorum");if(this.shouldClientHaveLeft(e.clientId)&&!function(e){return e.type===Ye.NoOp||e.type===Ye.Accept}(e))throw new Error("Remote message's clientId already should have left")}return super.processMessage(e,t)}processSignal(e){const t=e.content;switch(t.type){case hr.Clear:{const e=this.audience.getMembers();for(const[t,r]of e)"read"===r.mode&&this.audience.removeMember(t);break}case hr.ClientJoin:{const e=t.content;"read"===e.client.mode&&this.audience.addMember(e.clientId,e.client);break}case hr.ClientLeave:{const e=t.content;"read"===this.audience.getMember(e)?.mode&&this.audience.removeMember(e);break}}}}const pr={fatalConnectError:!0};function mr(e){return function(e,t,r){return void 0!==t.retryAfterMs&&t.canRetry?new at(e,t.retryAfterMs/1e3,r):new ot(e,t.canRetry,r)}(`Nack (${e.type}): ${e.message}`,{canRetry:403!==e.code,retryAfterMs:void 0===e.retryAfter?void 0:1e3*e.retryAfter},{statusCode:e.code,driverVersion:void 0})}const fr={mode:"read",details:{capabilities:{interactive:!0}},permission:[],user:{id:"storage-only client"},scopes:[]},vr="storage-only client";class yr extends Ve{constructor(e,t){super(),this.storageOnlyReason=e,this.readonlyConnectionReason=t,this.clientId=vr,this.claims={scopes:[Zt.DocRead]},this.mode="read",this.existing=!0,this.maxMessageSize=0,this.version="",this.initialMessages=[],this.initialSignals=[],this.initialClients=[{client:fr,clientId:vr}],this.serviceConfiguration={maxMessageSize:0,blockSize:0},this.checkpointSequenceNumber=void 0,this._disposed=!1}submit(e){this.emit("nack",this.clientId,e.map(e=>({operation:e,content:{message:"Cannot submit with storage-only connection",code:403}})))}submitSignal(e){this.emit("nack",this.clientId,{operation:e,content:{message:"Cannot submit signal with storage-only connection",code:403}})}get disposed(){return this._disposed}dispose(){this._disposed=!0}}function br(e){return e instanceof yr}const Sr=async()=>{if(!1===globalThis.navigator?.onLine&&void 0!==globalThis.addEventListener)return new Promise(e=>{const t=()=>{e(),globalThis.removeEventListener("online",t)};globalThis.addEventListener("online",t)})};class Cr{get connectionVerboseProps(){return this._connectionVerboseProps}get connectionMode(){return this.connection?.mode??"read"}get connected(){return void 0!==this.connection}get clientId(){return this.connection?.clientId}get connectionDetails(){return this._connectionDetails}get reconnectMode(){return this._reconnectMode}get maxMessageSize(){return this.connection?.serviceConfiguration?.maxMessageSize??16384}get version(){if(void 0===this.connection)throw new Error("Cannot check version without a connection");return this.connection.version}get serviceConfiguration(){return this.connection?.serviceConfiguration}get scopes(){return this.connection?.claims.scopes}get outbound(){return this._outbound}get connectionProps(){return void 0===this.connection?{...this._connectionProps,sentOps:this.clientSequenceNumber}:this._connectionProps}shouldJoinWrite(){const e=this.clientSequenceNumberObserved<this.clientSequenceNumber-this.localOpsToIgnore,t=this.containerDirty();return e!==t&&this.logger.sendTelemetryEvent({eventName:"DesiredConnectionModeMismatch",details:JSON.stringify({outstandingOps:e,isDirty:t})}),e||t}get readonly(){return this.readOnlyInfo.readonly}get readOnlyInfo(){let e,t=!1;return br(this.connection)&&(t=!0,e=this.connection.storageOnlyReason),t||this._forceReadonly||!0===this._readonlyPermissions?{readonly:!0,forced:this._forceReadonly,permissions:this._readonlyPermissions,storageOnly:t,storageOnlyReason:e}:{readonly:this._readonlyPermissions}}static detailsFromConnection(e,t){return{claims:e.claims,clientId:e.clientId,checkpointSequenceNumber:e.checkpointSequenceNumber,get initialClients(){return e.initialClients},mode:e.mode,serviceConfiguration:e.serviceConfiguration,version:e.version,reason:t}}constructor(e,t,r,o,n,i){this.serviceProvider=e,this.containerDirty=t,this.client=r,this.logger=n,this.props=i,this._forceReadonly=!1,this.pendingReconnect=!1,this.clientSequenceNumber=0,this.clientSequenceNumberObserved=0,this.localOpsToIgnore=0,this.connectFirstConnection=!0,this._connectionVerboseProps={},this._connectionProps={},this._disposed=!1,this.opHandler=(e,t)=>{const r=Array.isArray(t)?t:[t];this.props.incomingOpHandler(r,"opHandler")},this.signalHandler=e=>{const t=Array.isArray(e)?e:[e];this.props.signalHandler(t)},this.nackHandler=(e,t)=>{const r=t[0];if(!0===this._readonlyPermissions)return void this.props.closeHandler(((e,t)=>new st(e,S.writeError,t))("writeOnReadOnlyDocument",{driverVersion:void 0}));const o=mr(r.content);o.canRetry?this.reconnectOnError("write",o):this.props.closeHandler(o)},this.disconnectHandlerInternal=e=>{this.reconnectOnError(this.defaultReconnectionMode,e)},this.errorHandler=e=>{this.reconnectOnError(this.defaultReconnectionMode,e)},this.clientDetails=this.client.details,this.defaultReconnectionMode=this.client.mode,this._reconnectMode=o?Xt.Enabled:Xt.Never,this._outbound=new nr(e=>{if(void 0===this.connection)throw new Error("Attempted to submit an outbound message without connection");this.connection.submit(e)}),this._outbound.on("error",e=>{this.props.closeHandler(K(e))})}dispose(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this._disposed)return;this._disposed=!0,this._reconnectMode=Xt.Never,this._outbound.clear();const r={text:"Closing DeltaManager",error:e},o=this.readonly;this.disconnectFromDeltaStream(r),t&&this.set_readonlyPermissions(!0,o,r)}setAutoReconnect(e,t){We(e!==Xt.Never&&this._reconnectMode!==Xt.Never,632),this._reconnectMode=e,e!==Xt.Enabled&&this.disconnectFromDeltaStream(t)}forceReadonly(e){e!==this._forceReadonly&&this.logger.sendTelemetryEvent({eventName:"ForceReadOnly",value:e});const t=this.readonly;if(this._forceReadonly=e,t!==this.readonly){if(this._reconnectMode===Xt.Never)throw new Tt("API is not supported for non-connecting or closed container");let e=!1;!0===this.readonly&&(this.shouldJoinWrite()&&this.logger.sendErrorEvent({eventName:"ForceReadonlyPendingChanged"}),e=this.disconnectFromDeltaStream({text:"Force readonly"})),this.props.readonlyChangeHandler(this.readonly),e&&this.triggerConnect({text:"Force Readonly"},"read")}}set_readonlyPermissions(e,t,r){this._readonlyPermissions=e,t!==this.readonly&&this.props.readonlyChangeHandler(this.readonly,r)}connect(e,t){this.connectCore(e,t).catch(e=>{const t=K(e,{props:pr});this.props.closeHandler(t)})}async connectCore(e,t){We(!this._disposed,618);let r=t??this.defaultReconnectionMode;if(this.shouldJoinWrite()&&(r="write"),void 0!==this.connection||void 0!==this.pendingConnection){const e=this.connection?.mode??this.pendingConnection?.connectionMode;return void(e!==r&&this.logger.sendTelemetryEvent({eventName:"ConnectionModeMismatch",connected:void 0!==this.connection,mode:e,requestedMode:r,stack:Y()}))}const o=this.serviceProvider();let n;if(We(void 0!==o,679),this.props.establishConnectionHandler(e),!0===o.policies?.storageOnly)return n=new yr,this.setupNewSuccessfulConnection(n,"read",e),void We(void 0===this.pendingConnection,691);let i=500,s=0;const a=C();let c;const d=new AbortController,l=d.signal;for(this.pendingConnection={abort:()=>{d.abort()},connectionMode:r};void 0===n;){if(this._disposed)throw new Error("Attempting to connect a closed DeltaManager");if(!0===l.aborted)return void this.logger.sendTelemetryEvent({eventName:"ConnectionAttemptCancelled",attempts:s,duration:ie(C()-a),connectionEstablished:!1});s++;try{this.client.mode=r,n=await o.connectToDeltaStream({...this.client,mode:r}),n.disposed&&(this.logger.sendTelemetryEvent({eventName:"ReceivedClosedConnection"}),n=void 0),this.logger.sendTelemetryEvent({eventName:"ConnectionReceived",connected:void 0!==n&&!1===n.disposed},void 0,k)}catch(u){if(this.logger.sendTelemetryEvent({eventName:"ConnectToDeltaStreamException",connected:void 0!==n&&!1===n.disposed},void 0,k),Jt(u)){n=new yr(u.storageOnlyReason,{text:u.message,error:u}),r="read";break}if($(u)&&u.errorType===S.outOfStorageError){n=new yr(void 0,{text:u.message,error:u}),r="read";break}if(!ct(u)){const e=K(u,{props:pr});throw this.props.closeHandler(e),e}if(er(this.logger,{attempts:s,delay:i,eventName:"DeltaConnectionFailureToConnect",duration:ie(C()-a)},u),c=u,this.reconnectMode!==Xt.Enabled)return;const e=C(),t=dt(u);void 0===t&&!1===globalThis.navigator?.onLine||(i=gt(i,u)),void 0!==t&&this.props.reconnectionDelayHandler(i,u),await new Promise(e=>{setTimeout(e,i)}),await Sr(),this.logger.sendPerformanceEvent({eventName:"WaitBetweenConnectionAttempts",duration:C()-e,details:JSON.stringify({retryDelayFromError:t,delayMs:i})})}}if(s>1&&er(this.logger,{eventName:"MultipleDeltaConnectionFailures",attempts:s,duration:ie(C()-a)},c),!0===l.aborted||this._disposed)return n.dispose(),void this.logger.sendTelemetryEvent({eventName:"ConnectionAttemptCancelled",attempts:s,duration:ie(C()-a),connectionEstablished:!0});this.setupNewSuccessfulConnection(n,r,e)}triggerConnect(e,t){this.reconnectMode===Xt.Enabled&&this.connect(e,t)}disconnectFromDeltaStream(e){if(this.pendingReconnect=!1,void 0===this.connection)return void 0!==this.pendingConnection&&(this.cancelConnection(e),!0);We(void 0===this.pendingConnection,635);const t=this.connection;return this.connection=void 0,this._connectionDetails=void 0,t.off("op",this.opHandler),t.off("signal",this.signalHandler),t.off("nack",this.nackHandler),t.off("disconnect",this.disconnectHandlerInternal),t.off("error",this.errorHandler),t.off("pong",this.props.pongHandler),this._outbound.pause(),this._outbound.clear(),t.dispose(),this.props.disconnectHandler(e),this._connectionVerboseProps={},!0}cancelConnection(e){We(void 0!==this.pendingConnection,837),this.pendingConnection.abort(),this.pendingConnection=void 0,this.logger.sendTelemetryEvent({eventName:"ConnectionCancelReceived",reason:e.text}),this.props.cancelConnectionHandler({text:`Cancel Pending Connection due to ${e.text}`,error:e.error})}setupNewSuccessfulConnection(e,t,r){We(void 0===this.connection,230),We(!e.disposed,650),this.pendingConnection=void 0;const o=this.readonly;this.connection=e;const n=!e.claims.scopes.includes(Zt.DocWrite);if(e.mode!==t&&this.logger.sendTelemetryEvent({eventName:"ConnectionModeMismatch",requestedMode:t,mode:e.mode}),We(!n||"read"===this.connectionMode,232),this.set_readonlyPermissions(n,o,br(e)?e.readonlyConnectionReason:void 0),this._disposed)return void this.disconnectFromDeltaStream({text:"ConnectionManager already closed"});this._outbound.resume(),e.on("op",this.opHandler),e.on("signal",this.signalHandler),e.on("nack",this.nackHandler),e.on("disconnect",this.disconnectHandlerInternal),e.on("error",this.errorHandler),e.on("pong",this.props.pongHandler);const i=e.initialMessages.sort((e,t)=>e.sequenceNumber-t.sequenceNumber);let s=e.checkpointSequenceNumber;this._connectionVerboseProps={clientId:e.clientId,mode:e.mode},this._connectionProps={},void 0!==e.relayServiceAgent&&(this._connectionVerboseProps.relayServiceAgent=e.relayServiceAgent,this._connectionProps.relayServiceAgent=e.relayServiceAgent),this._connectionProps.socketDocumentId=e.claims.documentId,this._connectionProps.connectionMode=e.mode;let a=-1;i.length>0&&(this._connectionVerboseProps.connectionInitialOpsFrom=i[0].sequenceNumber,a=i[i.length-1].sequenceNumber,this._connectionVerboseProps.connectionInitialOpsTo=a+1,(void 0===s||s<a)&&(s=a)),this.props.incomingOpHandler(i,this.connectFirstConnection?"InitialOps":"ReconnectOps"),this._connectionDetails=Cr.detailsFromConnection(e,r),this._connectionDetails.checkpointSequenceNumber=s,this.props.connectHandler(this._connectionDetails),this.connectFirstConnection=!1;let c=[{clientId:null,content:JSON.stringify({type:hr.Clear})}];const d=(e.initialClients??[]).map(e=>({clientId:null,content:JSON.stringify({type:hr.ClientJoin,content:e})}));d.length>0&&(c=[...c,...d]),void 0!==e.initialSignals&&e.initialSignals.length>0&&(c=[...c,...e.initialSignals]),this.props.signalHandler(c)}reconnectOnError(e,t){this.reconnect(e,{text:t.message,error:t}).catch(this.props.closeHandler)}async reconnect(e,t){if(We(void 0!==this.connection,235),this.disconnectFromDeltaStream(t),!1===t.error?.canRetry&&this.logger.sendTelemetryEvent({eventName:"reconnectingDespiteFatalError",reconnectMode:this.reconnectMode},t.error),this.reconnectMode===Xt.Never&&this.props.closeHandler(),this._disposed||this.reconnectMode!==Xt.Enabled)return;const r=dt(t.error);void 0!==t.error&&void 0!==r&&(this.props.reconnectionDelayHandler(r,t.error),await new Promise(e=>{setTimeout(e,r)})),await Sr(),this.triggerConnect({text:void 0===t.error?`Reconnecting due to: ${t.text}`:"Reconnecting due to Error",error:t.error},e)}prepareMessageToSend(e){if(!0===this.readonly){We(!0===this.readOnlyInfo.readonly,496);const e=new Pt("deltaManagerReadonlySubmit",void 0,{readonly:this.readOnlyInfo.readonly,forcedReadonly:this.readOnlyInfo.forced,readonlyPermissions:this.readOnlyInfo.permissions,storageOnly:this.readOnlyInfo.storageOnly,storageOnlyReason:this.readOnlyInfo.storageOnlyReason});return void this.props.closeHandler(e)}return We(!!this.connection,228),this.lastSubmittedClientId!==this.connection?.clientId&&(this.lastSubmittedClientId=this.connection?.clientId,this.clientSequenceNumber=0,this.clientSequenceNumberObserved=0),tr(e)?this.localOpsToIgnore=0:this.localOpsToIgnore++,{...e,clientSequenceNumber:++this.clientSequenceNumber}}submitSignal(e,t){void 0===this.connection?this.logger.sendErrorEvent({eventName:"submitSignalDisconnected"}):this.connection.submitSignal(e,t)}sendMessages(e){We(this.connected,692),"read"!==this.connectionMode?(We(!this.pendingReconnect,693),this._outbound.push(e)):this.pendingReconnect||(this.pendingReconnect=!0,Promise.resolve().then(async()=>{this.pendingReconnect&&await this.reconnect("write",{text:"Switch to write"})}).catch(()=>{}))}beforeProcessingIncomingOp(e){if(We(this.clientId!==e.clientId||this.lastSubmittedClientId===e.clientId,238),void 0!==this.lastSubmittedClientId&&this.lastSubmittedClientId===e.clientId){const t=e.clientSequenceNumber;We(this.clientSequenceNumberObserved<t,239),We(t<=this.clientSequenceNumber,240),this.clientSequenceNumberObserved=t}if(e.type===Ye.ClientLeave){const t=e;JSON.parse(t.data)===this.clientId&&(this.logger.sendPerformanceEvent({eventName:"ReadConnectionTransition"}),this.reconnect("read",{text:"Switch to read"}).catch(e=>{this.logger.sendErrorEvent({eventName:"SwitchToReadConnection"},e)}))}}}const kr=2147483647;function wr(e,t,r){let o;if(t>kr){const n=t-kr;o=setTimeout(()=>wr(e,n,r),kr)}else o=setTimeout(()=>e(),Math.max(t,0));return r?.(o),o}class Pr{get hasTimer(){return!!this.runningState}constructor(e,t,r){this.defaultTimeout=e,this.defaultHandler=t,this.exceptionHandler=r,this.getCurrentTick=()=>Date.now()}start(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.defaultTimeout,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultHandler;this.startCore(e,t,e)}clear(){this.runningState&&(clearTimeout(this.runningState.timeout),this.runningState=void 0)}restart(e,t){if(this.runningState){const r=e??this.runningState.intendedDuration,o=t??this.runningState.restart?.handler??this.runningState.handler,n=this.calculateRemainingTime(this.runningState);r<n?this.start(r,o):r===n?(this.runningState.handler=o,this.runningState.restart=void 0,this.runningState.intendedDuration=r):this.runningState.restart={startTick:this.getCurrentTick(),duration:r,handler:o}}else this.start(e,t)}startCore(e,t,r){this.clear(),this.runningState={startTick:this.getCurrentTick(),duration:e,intendedDuration:r,handler:t,timeout:wr(()=>this.handler(),e,e=>{void 0!==this.runningState&&(this.runningState.timeout=e)})}}handler(){We(!!this.runningState,1892);const e=this.runningState.restart;if(void 0===e){const e=this.runningState.handler;this.clear();try{e()}catch(t){if(!this.exceptionHandler)throw t;this.exceptionHandler(t)}}else{const t=this.calculateRemainingTime(e);this.startCore(t,()=>e.handler(),e.duration)}}calculateRemainingTime(e){const t=this.getCurrentTick()-e.startTick;return e.duration-t}}class Tr{constructor(e,t){this.deltaManager=e,this.listener=t,this.caughtUp=!1,this.opHandler=e=>{!this.caughtUp&&e.sequenceNumber>=this.targetSeqNumber&&(this.caughtUp=!0,this.listener())},this._disposed=!1,this.targetSeqNumber=this.deltaManager.lastKnownSeqNumber,We(this.targetSeqNumber>=this.deltaManager.lastSequenceNumber,892),this.deltaManager.on("op",this.opHandler),this.opHandler({sequenceNumber:this.deltaManager.lastSequenceNumber})}get disposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this.deltaManager.off("op",this.opHandler))}}function Er(e,t,r){const o=e.mc.config;return function(e,t,r,o,n){const i=e=>new Dr(e,t,n);return e?new Ir(r,i,o):i(r)}(!0!==o.getBoolean("Fluid.Container.DisableCatchUpBeforeDeclaringConnected"),!0!==o.getBoolean("Fluid.Container.DisableJoinSignalWait"),e,t,r)}class Nr{constructor(e,t){this.inputs=e,this.pimpl=t(this)}get connectionState(){return this.pimpl.connectionState}get pendingClientId(){return this.pimpl.pendingClientId}get clientId(){return this.pimpl.clientId}containerSaved(){return this.pimpl.containerSaved()}dispose(){return this.pimpl.dispose()}initProtocol(e){return this.pimpl.initProtocol(e)}receivedDisconnectEvent(e){return this.pimpl.receivedDisconnectEvent(e)}establishingConnection(e){return this.pimpl.establishingConnection(e)}cancelEstablishingConnection(e){return this.pimpl.cancelEstablishingConnection(e)}receivedConnectEvent(e){return this.pimpl.receivedConnectEvent(e)}get logger(){return this.inputs.logger}get mc(){return this.inputs.mc}connectionStateChanged(e,t,r){return this.inputs.connectionStateChanged(e,t,r)}shouldClientJoinWrite(){return this.inputs.shouldClientJoinWrite()}get maxClientLeaveWaitTime(){return this.inputs.maxClientLeaveWaitTime}logConnectionIssue(e,t,r){return this.inputs.logConnectionIssue(e,t,r)}clientShouldHaveLeft(e){return this.inputs.clientShouldHaveLeft(e)}onCriticalError(e){return this.inputs.onCriticalError(e)}}class Ir extends Nr{constructor(e,t,r){super(e,t),this.deltaManager=r,this.transitionToConnectedState=()=>{We(this.pimpl.connectionState===Re.Connected,997),We(this._connectionState===Re.CatchingUp,998),this._connectionState=Re.Connected,this.inputs.connectionStateChanged(Re.Connected,Re.CatchingUp,{text:"caught up"})},this._connectionState=this.pimpl.connectionState}get connectionState(){return this._connectionState}connectionStateChanged(e,t,r){switch(e){case Re.Connected:return We(this._connectionState===Re.CatchingUp,993),We(void 0===this.catchUpMonitor,1003),void(this.catchUpMonitor=new Tr(this.deltaManager,this.transitionToConnectedState));case Re.Disconnected:this.catchUpMonitor?.dispose(),this.catchUpMonitor=void 0;break;case Re.EstablishingConnection:We(this._connectionState===Re.Disconnected,1746);break;case Re.CatchingUp:We(this._connectionState===Re.EstablishingConnection,995)}this._connectionState=e,this.inputs.connectionStateChanged(e,t,r)}}class Dr{get connectionState(){return this._connectionState}get clientId(){return this._clientId}get pendingClientId(){return this._pendingClientId}constructor(e,t,r){this.handler=e,this.readClientsWaitForJoinSignal=t,this._connectionState=Re.Disconnected,this._clientId=r;const o=e=>this.handler.onCriticalError(e);this.prevClientLeftTimer=new Pr(this.handler.maxClientLeaveWaitTime??3e5,()=>{We(this.connectionState!==Re.Connected,684),this.applyForConnectedState("timeout")},o),this.joinTimer=new Pr(0,()=>{if(this.connectionState!==Re.CatchingUp)return;const e={protocolInitialized:void 0!==this.protocol,pendingClientId:this.pendingClientId,clientJoined:this.hasMember(this.pendingClientId),waitingForLeaveOp:this.waitingForLeaveOp};this.handler.logConnectionIssue("read"===this.connection?.mode?"NoJoinSignal":"NoJoinOp","error",e)},o)}startjoinTimer(){We(!this.joinTimer.hasTimer,564),We(void 0!==this.connection,1203),this.joinTimer.start("write"===this.connection.mode?45e3:1e4)}stopjoinTimer(){We(this.joinTimer.hasTimer,565),this.joinTimer.clear()}get waitingForLeaveOp(){return this.prevClientLeftTimer.hasTimer}dispose(){We(!this.joinTimer.hasTimer,677),this.prevClientLeftTimer.clear()}containerSaved(){this.waitingForLeaveOp&&(this.prevClientLeftTimer.clear(),this.applyForConnectedState("containerSaved"))}receivedAddMemberEvent(e){e===this.pendingClientId&&(this.joinTimer.hasTimer?this.stopjoinTimer():this.shouldWaitForSelf()&&this.handler.logConnectionIssue("read"===this.connection?.mode?"ReceivedJoinSignal":"ReceivedJoinOp","generic"),this.waitingForLeaveOp&&(this.waitEvent=le.start(this.handler.logger,{eventName:"WaitBeforeClientLeave",details:JSON.stringify({waitOnClientId:this._clientId,hadOutstandingOps:this.handler.shouldClientJoinWrite()})})),this.applyForConnectedState("addMemberEvent"))}applyForConnectedState(e){if(We(void 0!==this.protocol,566),We(!this.waitingForLeaveOp||this.hasMember(this.clientId),738),this.pendingClientId!==this.clientId&&this.hasMember(this.pendingClientId)&&!this.waitingForLeaveOp)this.waitEvent?.end({source:e}),this.setConnectionState(Re.Connected);else{const t="timeout"===e&&this.connectionState!==Re.Disconnected;this.handler.logger.sendTelemetryEvent({eventName:"connectedStateRejected",category:t?"error":"generic",details:JSON.stringify({source:e,pendingClientId:this.pendingClientId,clientId:this.clientId,waitingForLeaveOp:this.waitingForLeaveOp,clientJoined:this.hasMember(this.pendingClientId)})})}}receivedRemoveMemberEvent(e){this.clientId===e&&this.waitingForLeaveOp&&(this.prevClientLeftTimer.clear(),this.applyForConnectedState("removeMemberEvent"))}receivedDisconnectEvent(e){this.connection=void 0,this.setConnectionState(Re.Disconnected,e)}cancelEstablishingConnection(e){We(this._connectionState===Re.EstablishingConnection,1747),We(void 0===this.connection,1748);const t=this._connectionState;this._connectionState=Re.Disconnected,this.handler.connectionStateChanged(Re.Disconnected,t,e)}establishingConnection(e){const t=this._connectionState;this._connectionState=Re.EstablishingConnection,this.handler.connectionStateChanged(Re.EstablishingConnection,t,{text:`Establishing Connection due to ${e.text}`,error:e.error})}shouldWaitForSelf(){return We(void 0!==this.connection,1204),"write"===this.connection.mode||this.readClientsWaitForJoinSignal}receivedConnectEvent(e){this.connection=e;const t=this._connectionState;this._connectionState=Re.CatchingUp,this._pendingClientId=e.clientId,this.handler.connectionStateChanged(Re.CatchingUp,t,e.reason),!this.hasMember(this._pendingClientId)&&this.shouldWaitForSelf()?this.startjoinTimer():this.waitingForLeaveOp||this.setConnectionState(Re.Connected)}setConnectionState(e,t){if(this.connectionState===e)return void this.handler.logger.sendErrorEvent({eventName:"setConnectionStateSame",value:e});const r=this._connectionState;this._connectionState=e;const o=void 0!==this._clientId&&void 0!==this.protocol?.quorum?.getMember(this._clientId);e===Re.Connected?(We(r===Re.CatchingUp,472),o&&this.handler.clientShouldHaveLeft(this._clientId),this._clientId=this.pendingClientId):e===Re.Disconnected&&(this.joinTimer.hasTimer&&this.stopjoinTimer(),o&&this.handler.shouldClientJoinWrite()&&!this.waitingForLeaveOp?this.prevClientLeftTimer.restart():this.handler.logger.sendTelemetryEvent({eventName:"noWaitOnDisconnected",details:JSON.stringify({clientId:this._clientId,inQuorum:o,waitingForLeaveOp:this.waitingForLeaveOp,hadOutstandingOps:this.handler.shouldClientJoinWrite()})})),this.handler.connectionStateChanged(this._connectionState,r,t),e===Re.Disconnected&&(this._pendingClientId=void 0)}get membership(){return this.readClientsWaitForJoinSignal?this.protocol?.audience:this.protocol?.quorum}initProtocol(e){this.protocol=e,this.membership?.on("addMember",(t,r)=>{We("read"===r.mode||void 0!==e.quorum.getMember(t),1205),this.receivedAddMemberEvent(t)}),this.membership?.on("removeMember",t=>{We(void 0===e.quorum.getMember(t),1206),this.receivedRemoveMemberEvent(t)}),this.hasMember(this.pendingClientId)&&this.receivedAddMemberEvent(this.pendingClientId),We(!this.waitingForLeaveOp,2461),void 0!==this._clientId&&void 0!==e.quorum?.getMember(this._clientId)&&this.prevClientLeftTimer.restart()}hasMember(e){return void 0!==this.membership?.getMember(e??"")}}const Fr={supportedFeatures:new Set,generation:0,pkgVersion:"unknown"};const Br="2.23.0",Lr={pkgVersion:Br,generation:1,supportedFeatures:new Set},xr={minSupportedGeneration:0,requiredFeatures:[]};function Ar(e,t){const r=function(e,t){const r=t??Fr;let o=!0;const n=[];r.generation<e.minSupportedGeneration&&(o=!1);for(const i of e.requiredFeatures)r.supportedFeatures.has(i)||n.push(i);return o&&0===n.length?{isCompatible:!0}:{isCompatible:!1,isGenerationCompatible:o,unsupportedFeatures:n.length>0?n:void 0}}(xr,e);if(!r.isCompatible){const o=new Tt("Loader is not compatible with Runtime",{errorDetails:JSON.stringify({loaderVersion:Lr.pkgVersion,runtimeVersion:e?.pkgVersion,loaderGeneration:Lr.generation,runtimeGeneration:e?.generation,minSupportedGeneration:xr.minSupportedGeneration,isGenerationCompatible:r.isGenerationCompatible,unsupportedFeatures:r.unsupportedFeatures})});throw t(o),o}}class Or{get clientId(){return this._getClientId()}get id(){return this._getContainerDiagnosticId()??""}get connected(){return this._getConnected()}get ILayerCompatDetails(){return Lr}constructor(e,t,r,o,n,i,s,a,c,d,l,u,h,g,p,m,f,v,y,b,S,C,k,w,P,T){this.options=e,this.scope=t,this.baseSnapshot=r,this._version=o,this.deltaManager=n,this.storage=i,this.quorum=s,this.audience=a,this.loader=c,this.submitFn=d,this.submitSummaryFn=l,this.submitBatchFn=u,this.submitSignalFn=h,this.disposeFn=g,this.closeFn=p,this.updateDirtyContainerState=m,this.getAbsoluteUrl=f,this._getContainerDiagnosticId=v,this._getClientId=y,this._getAttachState=b,this._getConnected=S,this.clientDetails=C,this.existing=k,this.taggedLogger=w,this.pendingLocalState=P,this.snapshotWithContents=T,this.supportedFeatures=new Map([["referenceSequenceNumbers",!0]])}getLoadedFromVersion(){return this._version}get attachState(){return this._getAttachState()}}class Mr extends te{constructor(e){super(e,{usageError:!0}),this.errorType=S.usageError,this.canRetry=!1}}class _r{constructor(e,t,r){this.internalStorageService=e,this.addProtocolSummaryIfMissing=t,this.shouldSummarizeProtocolTree=r,this.getSnapshotTree=e.getSnapshotTree.bind(e),this.getSnapshot=e.getSnapshot?.bind(e),this.getVersions=e.getVersions.bind(e),this.createBlob=e.createBlob.bind(e),this.readBlob=e.readBlob.bind(e),this.downloadSummary=e.downloadSummary.bind(e),this.dispose=e.dispose.bind(e)}get policies(){return this.internalStorageService.policies}get disposed(){return this.internalStorageService.disposed}async uploadSummaryWithContext(e,t){return this.shouldSummarizeProtocolTree()?this.internalStorageService.uploadSummaryWithContext(this.addProtocolSummaryIfMissing(e),t):this.internalStorageService.uploadSummaryWithContext(e,t)}}class Rr{constructor(e,t){this.internalStorageServiceP=e,this.logger=t,this._disposed=!1,this.internalStorageServiceP.then(e=>this.internalStorageService=e).catch(()=>{})}get policies(){if(this.internalStorageService)return this.internalStorageService.policies;throw new Error("storage service not yet instantiated")}get disposed(){return this._disposed}dispose(){this._disposed=!0}async getSnapshotTree(e,t){return this.runWithRetry(async()=>this.internalStorageServiceP.then(async r=>r.getSnapshotTree(e,t)),"storage_getSnapshotTree")}async getSnapshot(e){return this.runWithRetry(async()=>this.internalStorageServiceP.then(async t=>{if(void 0!==t.getSnapshot)return t.getSnapshot(e);throw new Tt("getSnapshot api should exist on internal storage in RetriableDocStorageService class")}),"storage_getSnapshot")}async readBlob(e){return this.runWithRetry(async()=>this.internalStorageServiceP.then(async t=>t.readBlob(e)),"storage_readBlob")}async getVersions(e,t,r,o){return this.runWithRetry(async()=>this.internalStorageServiceP.then(async n=>n.getVersions(e,t,r,o)),"storage_getVersions")}async uploadSummaryWithContext(e,t){return We(0===t.referenceSequenceNumber===(void 0===t.ackHandle),593),0!==t.referenceSequenceNumber?this.internalStorageServiceP.then(async r=>r.uploadSummaryWithContext(e,t)):this.runWithRetry(async()=>this.internalStorageServiceP.then(async r=>r.uploadSummaryWithContext(e,t)),"storage_uploadSummaryWithContext")}async downloadSummary(e){return this.runWithRetry(async()=>this.internalStorageServiceP.then(async t=>t.downloadSummary(e)),"storage_downloadSummary")}async createBlob(e){return this.runWithRetry(async()=>this.internalStorageServiceP.then(async t=>t.createBlob(e)),"storage_createBlob")}checkStorageDisposed(e,t){if(this._disposed)throw this.logger.sendTelemetryEvent({eventName:`${e}_abortedStorageDisposed`,fetchCallName:e},t),new Pt("Storage Service is disposed. Cannot retry",{canRetry:!1})}async runWithRetry(e,t){return lt(e,t,this.logger,{onRetry:(e,r)=>this.checkStorageDisposed(t,r)})}}class Hr{get summarizeProtocolTree(){return!0===this._summarizeProtocolTree}get loadedGroupIdSnapshots(){return this._loadedGroupIdSnapshots}constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0;this.logger=t,this.blobContents=r,this.loadingGroupIdSnapshotsFromPendingState=o,this.addProtocolSummaryIfMissing=n,this.enableSummarizeProtocolTree=i,this._loadedGroupIdSnapshots={},this.disposed=!1,this._storageService=new Ur(e,t)}dispose(e){this._storageService?.dispose?.(e),this.disposed=!0}connectToService(e){var t=this;if(!(this._storageService instanceof Ur))return;const r=e.connectToStorage(),o=this._storageService=new Rr(r,this.logger);this._storageService=new _r(o,function(){return t.logger.sendTelemetryEvent({eventName:"summarizeProtocolTreeEnabled"}),t.addProtocolSummaryIfMissing(...arguments)},()=>{const t=e.policies?.summarizeProtocolTree??this.enableSummarizeProtocolTree??!1;return this._summarizeProtocolTree!==t&&this.logger.sendTelemetryEvent({eventName:"isSummarizeProtocolTreeEnabled",details:{value:t}}),this._summarizeProtocolTree=t,this._summarizeProtocolTree})}loadSnapshotFromSnapshotBlobs(e){for(const[t,r]of Object.entries(e))this.blobContents[t]=r}clearPendingState(){this.loadingGroupIdSnapshotsFromPendingState=void 0}get policies(){try{return this._storageService.policies}catch{}}async getSnapshotTree(e,t){return this._storageService.getSnapshotTree(e,t)}async getSnapshot(e){let t;if(void 0!==this.loadingGroupIdSnapshotsFromPendingState&&void 0!==e?.loadingGroupIds){const r=this.loadingGroupIdSnapshotsFromPendingState[e.loadingGroupIds[0]];We(void 0!==r,2416),t=function(e,t){const r=new Map;for(const[o,n]of Object.entries(e.snapshotBlobs))r.set(o,bt(n,"utf8"));return{snapshotTree:e.baseSnapshot,blobContents:r,ops:[],sequenceNumber:t,latestSequenceNumber:void 0,snapshotFormatV:1}}(r,r.snapshotSequenceNumber)}else{if(void 0===this._storageService.getSnapshot)throw new Mr("getSnapshot api should exist in internal storage in ContainerStorageAdapter");t=await this._storageService.getSnapshot(e)}const r=e?.loadingGroupIds;if(We(void 0!==t.sequenceNumber,2417),void 0!==r)for(const o of r){(this._loadedGroupIdSnapshots[o]?.sequenceNumber??-1)<t.sequenceNumber&&(this._loadedGroupIdSnapshots[o]=t)}return t}async readBlob(e){const t=this.blobContents[e];if(void 0!==t){if("string"===typeof t){return bt(t,"utf8")}return t}return this._storageService.readBlob(e)}async getVersions(e,t,r,o){return this._storageService.getVersions(e,t,r,o)}async uploadSummaryWithContext(e,t){return this._storageService.uploadSummaryWithContext(e,t)}async downloadSummary(e){return this._storageService.downloadSummary(e)}async createBlob(e){return this._storageService.createBlob(e)}}class Ur{constructor(e,t){this.detachedStorage=e,this.logger=t,this.getSnapshotTree=this.notCalled,this.getSnapshot=this.notCalled,this.getVersions=this.notCalled,this.write=this.notCalled,this.uploadSummaryWithContext=this.notCalled,this.downloadSummary=this.notCalled}async createBlob(e){return this.verifyStorage().createBlob(e)}async readBlob(e){return this.verifyStorage().readBlob(e)}verifyStorage(){if(void 0===this.detachedStorage)throw new Mr("Real storage calls not allowed in Unattached container");return this.detachedStorage}get policies(){return this.notCalled()}notCalled(){this.verifyStorage();try{throw new Error("BlobOnlyStorage not implemented method used")}catch(e){throw this.logger.sendTelemetryEvent({eventName:"BlobOnlyStorageWrongCall"},e),e}}}const jr=".blobs",qr=".redirectTable";async function zr(e,t){const r={};if(mt(e)){const t=e.blobContents;for(const[e,o]of t.entries())r[e]=St(o,"utf8")}else await Vr(e,r,t);return r}async function Vr(e,t,r){let o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const n=[];for(const[i,s]of Object.entries(e.trees))o&&i===jr?n.push($r(s,t,r)):n.push(Vr(s,t,r,!1));for(const i of Object.values(e.blobs)){const e=await r.readBlob(i);t[i]=St(e,"utf8")}return Promise.all(n)}async function $r(e,t,r){const o=e.blobs[qr];We(void 0!==o,2510);const n=await r.readBlob(o);t[o]=St(n,"utf8")}const Gr={...f,clientSessionExpiredError:"clientSessionExpiredError"};class Wr extends te{constructor(e,t,r){super(e,r),this.retryAfterSeconds=t,this.errorType=Gr.throttlingError}static wrap(e,t,r){return function(e,t,r){const o=Z(e,t),n=o.errorInstanceId,i=n;return r.sendTelemetryEvent({eventName:"WrapError",errorInstanceId:n,wrappedByErrorInstanceId:i},e),o}(e,e=>new Wr(e,t),r)}}function Jr(e){if(tr(e))return!0;switch(e.type){case Ye.Propose:case Ye.Reject:case Ye.NoOp:case Ye.Accept:case Ye.Summarize:return!0;default:return!1}}class Kr extends Ft{get active(){return this._active()}get disposed(){return this._closed}get IDeltaSender(){return this}get inbound(){return this._inbound}get inboundSignal(){return this._inboundSignal}get initialSequenceNumber(){return this.initSequenceNumber}get lastSequenceNumber(){return this.lastProcessedSequenceNumber}get lastMessage(){return this.lastProcessedMessage}get lastKnownSeqNumber(){return this.lastObservedSeqNumber}get minimumSequenceNumber(){return this.minSequenceNumber}get hasCheckpointSequenceNumber(){return We(this.connectionManager.connected,223),void 0!==this._checkpointSequenceNumber}get maxMessageSize(){return this.connectionManager.maxMessageSize}get version(){return this.connectionManager.version}get serviceConfiguration(){return this.connectionManager.serviceConfiguration}get outbound(){return this.connectionManager.outbound}get readOnlyInfo(){return this.connectionManager.readOnlyInfo}get clientDetails(){return this.connectionManager.clientDetails}submit(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>4?arguments[4]:void 0;const n={contents:t,metadata:arguments.length>3?arguments[3]:void 0,referenceSequenceNumber:(arguments.length>5?arguments[5]:void 0)??this.lastProcessedSequenceNumber,type:e,compression:o};r||this.flush();const i=this.connectionManager.prepareMessageToSend(n);return void 0===i?-1:(We(Jr(i),1049),void 0!==t&&(this.opsSize+=t.length),this.messageBuffer.push(i),i.type===Ye.NoOp&&this.noOpCount++,this.emit("submitOp",i),r||this.flush(),i.clientSequenceNumber)}submitSignal(e,t){return this.connectionManager.submitSignal(e,t)}flush(){const e=this.messageBuffer;0!==e.length&&(this.messageBuffer=[],this.emit("prepareSend",e),1===e.length?We(void 0===e[0].metadata?.batch,969):(We(!0===e[0].metadata?.batch,970),We(!1===e[e.length-1].metadata?.batch,971)),this.connectionManager.sendMessages(e),We(0===this.messageBuffer.length,972))}get connectionProps(){return{sequenceNumber:this.lastSequenceNumber,opsSize:this.opsSize>0?this.opsSize:void 0,deltaManagerState:this._disposed?"disposed":this._closed?"closed":"open",...this.connectionManager.connectionProps}}logConnectionIssue(e){We(this.connectionManager.connected,568);const t=this.pending.sort((e,t)=>e.sequenceNumber-t.sequenceNumber);this.logger.sendTelemetryEvent({...e,fetchReason:this.fetchReason,lastQueuedSequenceNumber:this.lastQueuedSequenceNumber,lastProcessedSequenceNumber:this.lastProcessedSequenceNumber,lastObserved:this.lastObservedSeqNumber,...this.connectionManager.connectionVerboseProps,pendingOps:this.pending.length,pendingFirst:t[0]?.sequenceNumber,haveHandler:void 0!==this.handler,inboundLength:this.inbound.length,inboundPaused:this.inbound.paused})}constructor(e,t,r,o){super((e,t)=>{this.logger.sendErrorEvent({eventName:"DeltaManagerEventHandlerException",name:"string"===typeof e?e:void 0},t),this.close(K(t))}),this.serviceProvider=e,this.logger=t,this._active=r,this.pending=[],this.currentlyProcessingOps=!1,this.minSequenceNumber=0,this.lastQueuedSequenceNumber=0,this.lastObservedSeqNumber=0,this.lastProcessedSequenceNumber=0,this.noOpCount=0,this.lastClientSequenceNumber=0,this.opsSize=0,this.initSequenceNumber=0,this._closed=!1,this._disposed=!1,this.throttlingIdSet=new Set,this.timeTillThrottling=0,this.closeAbortController=new AbortController,this.deltaStorageDelayId=z(),this.deltaStreamDelayId=z(),this.messageBuffer=[];const n={incomingOpHandler:(e,t)=>{try{this.enqueueMessages(e,t)}catch(r){this.logger.sendErrorEvent({eventName:"EnqueueMessages_Exception"},r),this.close(K(r))}},signalHandler:e=>{for(const t of e)this._inboundSignal.push(t)},reconnectionDelayHandler:(e,t)=>this.emitDelayInfo(this.deltaStreamDelayId,e,t),closeHandler:e=>this.close(e),disconnectHandler:e=>this.disconnectHandler(e),connectHandler:e=>this.connectHandler(e),pongHandler:e=>this.emit("pong",e),readonlyChangeHandler:(e,t)=>{!function(e,t,r){try{for(var o=arguments.length,n=new Array(o>3?o-3:0),i=3;i<o;i++)n[i-3]=arguments[i];e.emit(r,...n)}catch(s){t.sendErrorEvent({eventName:"RaiseEventError",event:r},s)}}(this,this.logger,"readonly",e,t)},establishConnectionHandler:e=>this.establishingConnection(e),cancelConnectionHandler:e=>this.cancelEstablishingConnection(e)};this.connectionManager=o(n),this._inbound=new nr(e=>{this.processInboundMessage(e)}),this._inbound.on("error",e=>{this.close(Nt.wrapIfUnrecognized(e,"deltaManagerInboundErrorHandler",this.lastMessage))}),this._inboundSignal=new nr(e=>{if(void 0===this.handler)throw new Error("Attempted to process an inbound signal without a handler attached");this.handler.processSignal({...e,content:JSON.parse(e.content)})}),this._inboundSignal.on("error",e=>{this.close(K(e))})}cancelEstablishingConnection(e){this.emit("cancelEstablishingConnection",e)}establishingConnection(e){this.emit("establishingConnection",e)}connectHandler(e){this.refreshDelayInfo(this.deltaStreamDelayId);const t=this.connectionManager.connectionVerboseProps;t.connectionLastQueuedSequenceNumber=this.lastQueuedSequenceNumber,t.connectionLastObservedSeqNumber=this.lastObservedSeqNumber;const r=e.checkpointSequenceNumber;this._checkpointSequenceNumber=r,void 0!==r&&this.updateLatestKnownOpSeqNumber(r),We(0===this.messageBuffer.length,233),this.opsSize=0,this.noOpCount=0,this.emit("connect",e,void 0===r?void 0:this.lastObservedSeqNumber-this.lastSequenceNumber),void 0!==r?r>this.lastQueuedSequenceNumber&&this.fetchMissingDeltas("AfterConnection"):"read"===e.mode&&this.fetchMissingDeltas("AfterReadConnection")}async attachOpHandler(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"none",n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:t;if(this.initSequenceNumber=t,this.lastProcessedSequenceNumber=n,this.minSequenceNumber=e,this.lastQueuedSequenceNumber=n,this.lastObservedSeqNumber=n,We(void 0===this.handler,226),this.handler=r,We(!!this.handler,227),We(void 0===this.fetchReason,616),!this._closed){if(this._inbound.resume(),this._inboundSignal.resume(),"none"!==o){const e="cached"===o;await this.fetchMissingDeltasCore(`DocumentOpen_${o}`,e),e&&this.fetchMissingDeltas("PostDocumentOpen")}We(void 0!==this.fetchReason||0===this.pending.length,617)}}connect(e){const t=e.fetchOpsFromStorage??!0;!function(e,t,r){if(e)return!0;const o="string"===typeof r?{eventName:r,category:"error"}:{category:"error",...r};t.send(o)}(void 0!==this.handler||!t,this.logger,"CantFetchWithoutBaseline"),t&&this.fetchMissingDeltas(e.reason.text),this.connectionManager.connect(e.reason,e.mode)}async getDeltas(e,t,r,o,n){const i=this.serviceProvider();if(void 0===i)throw new Error("Delta manager is not attached");let s;if(void 0===this.deltaStorage&&(this.deltaStorage=await i.connectToDeltaStorage()),void 0===t)s=e=>e.sequenceNumber>=this.lastObservedSeqNumber;else{const o=t-1;if(this.lastQueuedSequenceNumber>=o)return void this.logger.sendPerformanceEvent({reason:r,eventName:"ExtraStorageCall",early:!0,from:e,to:t,...this.connectionManager.connectionVerboseProps});s=e=>e.sequenceNumber>=o}const a=new AbortController;let c=!1;const d=e=>{We(e.sequenceNumber===this.lastQueuedSequenceNumber,570),!c&&s(e)&&(a.abort("DeltaManager getDeltas fetch cancelled"),this._inbound.off("push",d))};try{this._inbound.on("push",d),We(null===this.closeAbortController.signal.onabort,488),this.closeAbortController.signal.addEventListener("abort",()=>a.abort(this.closeAbortController.signal.reason));const i=this.deltaStorage.fetchMessages(e,t,a.signal,n,r);for(;;){const e=await i.read();if(e.done)break;try{c=!0,o(e.value)}finally{c=!1}}}finally{a.signal.aborted&&this.logger.sendTelemetryEvent({eventName:"DeltaManager_GetDeltasAborted",fetchReason:r,reason:a.signal.reason}),this.closeAbortController.signal.onabort=null,this._inbound.off("push",d),We(!c,649)}}close(e){this._closed||(this._closed=!0,this.connectionManager.dispose(e,!0),this.clearQueues(),this.emit("closed",e))}dispose(e){if(!this._disposed){if(void 0!==e&&!$(e))throw new Tt("Error must be a Fluid error");this._disposed=!0,this._closed=!0,this.connectionManager.dispose(e,!1),this.clearQueues(),this.emit("disposed",e),this.removeAllListeners()}}clearQueues(){this.closeAbortController.abort("DeltaManager is closed"),this._inbound.clear(),this._inboundSignal.clear(),this._inbound.pause(),this._inboundSignal.pause(),this.pending=[]}refreshDelayInfo(e){this.throttlingIdSet.delete(e),0===this.throttlingIdSet.size&&(this.timeTillThrottling=0)}disconnectHandler(e){this.messageBuffer.length=0,this.emit("disconnect",e.text,e.error)}emitDelayInfo(e,t,r){const o=Date.now();if(this.throttlingIdSet.add(e),t>0&&o+t>this.timeTillThrottling){this.timeTillThrottling=o+t;const e=Wr.wrap(r,t/1e3,this.logger);this.emit("throttled",e)}}comparableMessagePayload(e){return`${e.clientId}-${e.type}-${e.minimumSequenceNumber}-${e.referenceSequenceNumber}-${e.timestamp}`}enqueueMessages(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(void 0===this.handler)return void(this.pending=[...this.pending,...e]);if(We(0===this.pending.length||void 0!==this.fetchReason,489),0===e.length)return;const o=e[0].sequenceNumber,n=e[e.length-1].sequenceNumber;if(n>this.lastQueuedSequenceNumber){let i=o-1;const s=i-this.lastQueuedSequenceNumber;let a,c,d=0,l=0;for(const t of e)t.sequenceNumber===i?d++:t.sequenceNumber!==i+1&&(l++,void 0===a&&(a=i+1)),i=t.sequenceNumber;0!==d||0!==l&&!r||s>0&&void 0===this.fetchReason?c="enqueueMessages":void 0!==this.fetchReason&&this.fetchReason!==t&&o<=this.lastQueuedSequenceNumber+1&&n>this.lastQueuedSequenceNumber&&(c="enqueueMessagesExtraFetch"),void 0!==c&&this.logger.sendPerformanceEvent({eventName:c,reason:t,previousReason:this.prevEnqueueMessagesReason,from:o,to:n+1,length:e.length,fetchReason:this.fetchReason,duplicate:d>0?d:void 0,initialGap:0===s?void 0:s,gap:l>0?l:void 0,firstMissing:a,dmInitialSeqNumber:this.initialSequenceNumber,...this.connectionManager.connectionVerboseProps})}this.updateLatestKnownOpSeqNumber(e[e.length-1].sequenceNumber);const i=this.previouslyProcessedMessage?.sequenceNumber;We(void 0===i||i===this.lastQueuedSequenceNumber,236);for(const s of e)if(s.sequenceNumber<=this.lastQueuedSequenceNumber){if(this.previouslyProcessedMessage?.sequenceNumber===s.sequenceNumber){const e=this.comparableMessagePayload(this.previouslyProcessedMessage),t=this.comparableMessagePayload(s);if(e!==t){const r=new st("Found two messages with the same sequenceNumber but different payloads. Likely to be a service issue",S.fileOverwrittenInStorage,{clientId:this.connectionManager.clientId,sequenceNumber:s.sequenceNumber,message1:e,message2:t,driverVersion:void 0});this.close(r)}}}else s.sequenceNumber===this.lastQueuedSequenceNumber+1?(this.lastQueuedSequenceNumber=s.sequenceNumber,this.previouslyProcessedMessage=s,this._inbound.push(s)):(this.pending.push(s),this.fetchMissingDeltas(t,s.sequenceNumber));this.prevEnqueueMessagesReason=this.pending.length>0?"unknown":t}processInboundMessage(e){const t=Date.now();We(!this.currentlyProcessingOps,943),this.currentlyProcessingOps=!0,this.lastProcessedMessage=e;const r="string"===typeof e.clientId;if(We(null===e.clientId||r,1050),!r&&Jr(e)&&e.type!==Ye.NoOp)throw new Et("Mismatch in clientId",{...It(e),messageType:e.type});if(void 0!==this.connectionManager.clientId&&this.connectionManager.clientId===e.clientId){e.type===Ye.NoOp&&this.noOpCount--;const t=e.clientSequenceNumber-this.lastClientSequenceNumber-1;if(this.noOpCount-=t,this.noOpCount<0)throw new Error(`gap in client sequence number: ${t}`);this.lastClientSequenceNumber=e.clientSequenceNumber}if(this.connectionManager.beforeProcessingIncomingOp(e),this.minSequenceNumber>e.minimumSequenceNumber)throw Nt.create("Invalid MinimumSequenceNumber from service - document may have been restored to previous state","DeltaManager.processInboundMessage",e,{clientId:this.connectionManager.clientId});const o=e.sequenceNumber-e.minimumSequenceNumber;if(o<0||0===o&&null!==e.clientId)throw new Et("MSN has to be lower than sequence #",It(e));if(this.minSequenceNumber=e.minimumSequenceNumber,e.sequenceNumber!==this.lastProcessedSequenceNumber+1)throw new Et("Found a non-Sequential sequenceNumber",{...It(e),clientId:this.connectionManager.clientId});if(this.lastProcessedSequenceNumber=e.sequenceNumber,We(this.lastProcessedSequenceNumber<=this.lastObservedSeqNumber,615),void 0===this.handler)throw new Error("Attempted to process an inbound message without a handler attached");this.handler.process(e),this.currentlyProcessingOps=!1;const n=Date.now();this.emit("op",e,n-t)}fetchMissingDeltas(e,t){this.fetchMissingDeltasCore(e,!1,t).catch(e=>{this.logger.sendErrorEvent({eventName:"fetchMissingDeltasException"},e)})}async fetchMissingDeltasCore(e,t,r){if(void 0===this.fetchReason)if(this._closed)this.logger.sendTelemetryEvent({eventName:"fetchMissingDeltasClosedConnection",reason:e});else if(void 0!==this.handler)try{let o=this.lastQueuedSequenceNumber+1;const n=this.previouslyProcessedMessage?.sequenceNumber;void 0!==n&&(We(n===this.lastQueuedSequenceNumber,242),We(o>1,243),o--);const i=`${e}_fetch`;this.fetchReason=i,await this.getDeltas(o,r,i,e=>{this.refreshDelayInfo(this.deltaStorageDelayId),this.enqueueMessages(e,i)},t)}catch(o){this.logger.sendErrorEvent({eventName:"GetDeltas_Exception"},o),this.close(K(o))}finally{this.refreshDelayInfo(this.deltaStorageDelayId),this.fetchReason=void 0,this.processPendingOps(e)}else We(0===this.lastQueuedSequenceNumber,619)}processPendingOps(e){if(this._closed)return;We(void 0!==this.handler,620);const t=this.pending.sort((e,t)=>e.sequenceNumber-t.sequenceNumber);this.pending=[],this.enqueueMessages(t,`${e}_pending`,!0),void 0===this.fetchReason&&this.lastQueuedSequenceNumber<this.lastObservedSeqNumber&&this.fetchMissingDeltas("OpsBehind")}updateLatestKnownOpSeqNumber(e){this.lastObservedSeqNumber<e&&(this.lastObservedSeqNumber=e)}}var Qr;!function(e){e.cache="fluid-cache",e.clientDetails="fluid-client-details",e.loadMode="loadMode",e.reconnect="fluid-reconnect",e.sequenceNumber="fluid-sequence-number",e.version="version"}(Qr||(Qr={}));var Yr=r(76522);const{debug:Zr}=Yr;class Xr{static mixinDebugLogger(e,t,r){const o=Zr(e),n=Zr(e);return n.log=function(){!0===o.enabled?Zr.log(...arguments):console.error(...arguments)},n.enabled=!0,i={namespace:e,loggers:[t,new Xr(o,n)],properties:r,tryInheritProperties:!0},new de(i.namespace,i.properties,i.loggers?.filter(e=>void 0!==e),i.tryInheritProperties);var i}constructor(e,t){this.debug=e,this.debugErr=t}send(e){const t={...e},r="error"===t.category;let o=r?this.debugErr:this.debug;const n=e.eventName.lastIndexOf(":"),i=e.eventName.slice(Math.max(0,n+1));n>0&&(o=o.extend(e.eventName.slice(0,n))),t.eventName=void 0;let s="";s=`tick=${ie(C())}`;const a=t.stack??"";let c;t.stack=void 0;try{c=JSON.stringify(t)}catch{t.error=void 0,c=JSON.stringify(t)}"{}"===c&&(c=""),r&&(o.enabled=!0),o(`${i} ${c} ${s} ${a}`)}}function eo(e){if(void 0===e)throw new Error("Object is not a IResolveUrl.")}class to{constructor(e,t){this.container=e,this.loader=t}async resolve(e){if(e.url.startsWith("/")){eo(this.container.resolvedUrl);return await this.container.clone({resolvedUrl:{...this.container.resolvedUrl},version:e.headers?.[Qr.version]??void 0,loadMode:e.headers?.[Qr.loadMode]},{canReconnect:e.headers?.[Qr.reconnect],clientDetailsOverride:e.headers?.[Qr.clientDetails]})}if(void 0===this.loader)throw new Error("Cannot resolve external containers");return this.loader.resolve(e)}}class ro{constructor(e){const{urlResolver:t,documentServiceFactory:r,codeLoader:o,options:n,scope:i,logger:s,detachedBlobStorage:a,configProvider:c,protocolHandlerBuilder:d}=e,l={loaderId:z(),loaderVersion:Br},u=A(Xr.mixinDebugLogger("fluid:telemetry",s,{all:l}),T.value,c);this.services={urlResolver:t,documentServiceFactory:r,codeLoader:o,options:n??{},scope:!1===n?.provideScopeLoader?{...i}:{...i,ILoader:this},detachedBlobStorage:a,protocolHandlerBuilder:d,subLogger:u.logger},this.mc=M({logger:this.services.subLogger,namespace:"Loader"})}async createDetachedContainer(e,t){return mo.createDetached({...t,...this.services},e)}async rehydrateDetachedContainerFromSnapshot(e,t){return mo.rehydrateDetachedFromSnapshot({...t,...this.services},e)}async resolve(e,t){const r=void 0===t?"Resolve":"ResolveWithPendingState";return le.timedExecAsync(this.mc.logger,{eventName:r},async()=>{return this.resolveCore(e,void 0===(r=t)?void 0:JSON.parse(r));var r})}async resolveCore(e,t){const r=await this.services.urlResolver.resolve(e);eo(r);const o=Ut(r.url);if(void 0===o)throw new Error(`Invalid URL ${r.url}`);if(void 0!==t){const e=Ut(t.url);if(e?.id!==o.id||e?.path.replace(/\/$/,"")!==o.path.replace(/\/$/,"")){const e=`URL ${r.url} does not match pending state URL ${t.url}`;throw new Error(e)}}return e.headers??={},e.headers[Qr.version]=o.version??e.headers[Qr.version],this.loadContainer(e,r,t)}async loadContainer(e,t,r){return mo.load({resolvedUrl:t,version:e.headers?.[Qr.version]??void 0,loadMode:e.headers?.[Qr.loadMode],pendingLocalState:r},{canReconnect:e.headers?.[Qr.reconnect],clientDetailsOverride:e.headers?.[Qr.clientDetails],...this.services})}}const oo=Symbol();function no(e){return Je(e)&&oo in e&&e[oo]===oo}function io(e){if(void 0!==e&&e.size>0&&no(e))return e.serialize()}class so extends Ve{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;super(),this.NoopCountFrequency=t,this.opsProcessedSinceOpSent=0,e!==Number.POSITIVE_INFINITY&&(this.timer=new Pr(e,()=>{0!==this.opsProcessedSinceOpSent&&this.emit("wantsNoop")}))}notifyMessageProcessed(e){tr(e)&&(this.opsProcessedSinceOpSent++,this.opsProcessedSinceOpSent===this.NoopCountFrequency&&queueMicrotask(()=>{this.opsProcessedSinceOpSent>=this.NoopCountFrequency&&(this.emit("wantsNoop"),We(0===this.opsProcessedSinceOpSent,579))}),void 0!==this.timer&&(1===this.opsProcessedSinceOpSent&&this.timer.restart(),We(this.timer.hasTimer,578)))}notifyDisconnect(){this.opsProcessedSinceOpSent=0}notifyMessageSent(){this.opsProcessedSinceOpSent=0}}var ao,co;!function(e){e[e.NoCaching=0]="NoCaching",e[e.Prefetch=1]="Prefetch"}(ao||(ao={})),function(e){e.default="default",e.noCache="noCache"}(co||(co={}));class lo{constructor(e,t,r,o,n,i,s,a){if(this.pendingLocalState=e,this.storageAdapter=r,this._offlineLoadEnabled=o,this.containerDirty=i,this.supportGetSnapshotApi=s,this.processedOps=[],this.lastSavedOpSequenceNumber=0,this.snapshotRefreshTimeoutMs=864e5,this.mc=M({logger:t,namespace:"serializedStateManager"}),this.snapshotRefreshTimeoutMs=a??this.snapshotRefreshTimeoutMs,this.refreshTimer=new Pr(this.snapshotRefreshTimeoutMs,()=>this.tryRefreshSnapshot()),e&&e.savedOps.length>0){const t=e.savedOps.length;this.lastSavedOpSequenceNumber=e.savedOps[t-1].sequenceNumber}n.on("saved",()=>this.updateSnapshotAndProcessedOpsMaybe())}get offlineLoadEnabled(){return this._offlineLoadEnabled}get refreshSnapshotP(){return this._refreshSnapshotP}addProcessedOp(e){this.offlineLoadEnabled&&(this.processedOps.push(e),this.updateSnapshotAndProcessedOpsMaybe())}async fetchSnapshot(e){if(void 0===this.pendingLocalState){const{baseSnapshot:t,version:r}=await uo(this.mc,this.storageAdapter,this.supportGetSnapshotApi(),e),o=ft(t);if(this.offlineLoadEnabled){const e=await zr(t,this.storageAdapter),r=await Qt(this.storageAdapter,o);this.snapshot={baseSnapshot:o,snapshotBlobs:e,snapshotSequenceNumber:r.sequenceNumber},this.refreshTimer.start()}return{baseSnapshot:t,version:r}}{const{baseSnapshot:e,snapshotBlobs:t}=this.pendingLocalState,r=await Qt(this.storageAdapter,e);this.snapshot={baseSnapshot:e,snapshotBlobs:t,snapshotSequenceNumber:r.sequenceNumber},this.tryRefreshSnapshot();const o=new Map;for(const[n,i]of Object.entries(t))o.set(n,bt(i,"utf8"));return{baseSnapshot:{sequenceNumber:this.snapshot.snapshotSequenceNumber,snapshotTree:e,blobContents:o,latestSequenceNumber:void 0,ops:[],snapshotFormatV:1},version:void 0}}}tryRefreshSnapshot(){!0===this.mc.config.getBoolean("Fluid.Container.enableOfflineSnapshotRefresh")&&void 0===this._refreshSnapshotP&&void 0===this.latestSnapshot&&(this._refreshSnapshotP=this.refreshLatestSnapshot(this.supportGetSnapshotApi()),this._refreshSnapshotP.catch(e=>{this.mc.logger.sendTelemetryEvent({eventName:"RefreshLatestSnapshotFailed",error:e})}).finally(()=>{this._refreshSnapshotP=void 0}))}async refreshLatestSnapshot(e){this.latestSnapshot=await async function(e,t,r){return le.timedExecAsync(e.logger,{eventName:"GetLatestSnapshotInfo"},async()=>{const o=await t.getVersions(null,1,"getLatestSnapshotInfo",co.noCache),{baseSnapshot:n}=await uo(e,t,r,o[0]?.id),i=ft(n),s=Date.now();return{baseSnapshot:i,snapshotBlobs:await zr(n,t),snapshotSequenceNumber:(await Qt(t,i)).sequenceNumber,snapshotFetchedTime:s}}).catch(()=>{})}(this.mc,this.storageAdapter,e);const t=Object.keys(this.storageAdapter.loadedGroupIdSnapshots);if(e&&t.length>0){We(void 0!==this.storageAdapter.getSnapshot,2418);We(void 0!==await this.storageAdapter.getSnapshot({versionId:void 0,scenarioName:"getLatestSnapshotInfo",cacheSnapshot:!1,loadingGroupIds:t,fetchSource:co.noCache}),2419)}return this.updateSnapshotAndProcessedOpsMaybe()}updateSnapshotAndProcessedOpsMaybe(){const e=this.latestSnapshot?.snapshotSequenceNumber;if(void 0===e||0===this.processedOps.length||this.processedOps[this.processedOps.length-1].sequenceNumber<this.lastSavedOpSequenceNumber||this.containerDirty())return-1;const t=this.processedOps[0].sequenceNumber,r=this.processedOps[this.processedOps.length-1].sequenceNumber;return e<t?(this.mc.logger.sendTelemetryEvent({eventName:"OldSnapshotFetchWhileRefreshing",snapshotSequenceNumber:e,firstProcessedOpSequenceNumber:t,lastProcessedOpSequenceNumber:r,stashedSnapshotSequenceNumber:this.snapshot?.snapshotSequenceNumber}),this.latestSnapshot=void 0,this.refreshTimer.restart()):e<=r&&(this.processedOps.splice(0,e-t+1),this.snapshot=this.latestSnapshot,this.latestSnapshot=void 0,this.refreshTimer.restart(),this.mc.logger.sendTelemetryEvent({eventName:"SnapshotRefreshed",snapshotSequenceNumber:e,firstProcessedOpSequenceNumber:t,newFirstProcessedOpSequenceNumber:0===this.processedOps.length?void 0:this.processedOps[0].sequenceNumber})),e}setInitialSnapshot(e){if(this.offlineLoadEnabled){We(void 0===this.snapshot,2359),We(void 0!==e,2360);const{baseSnapshot:t,snapshotBlobs:r}=e,o=".protocol"in t.trees?t.trees[".protocol"].blobs.attributes:t.blobs[".attributes"],n=JSON.parse(r[o]);We(0===n.sequenceNumber,2361),this.snapshot={...e,snapshotSequenceNumber:n.sequenceNumber},this.refreshTimer.start()}}async getPendingLocalState(e,t,r,o){return le.timedExecAsync(this.mc.logger,{eventName:"getPendingLocalState",details:{notifyImminentClosure:e.notifyImminentClosure,sessionExpiryTimerStarted:e.sessionExpiryTimerStarted,snapshotSequenceNumber:e.snapshotSequenceNumber,processedOpsSize:this.processedOps.length},clientId:t},async()=>{if(!this.offlineLoadEnabled)throw new Tt("Can't get pending local state unless offline load is enabled");We(void 0!==this.snapshot,2277);const n=await r.getPendingLocalState({...e,snapshotSequenceNumber:this.snapshot.snapshotSequenceNumber,sessionExpiryTimerStarted:this.snapshot.snapshotFetchedTime}),i={};let s=!1;const a=Object.entries(this.storageAdapter.loadedGroupIdSnapshots);if(a.length>0)for(const[e,t]of a)s=!0,i[e]=zt(t);const c={attached:!0,pendingRuntimeState:n,baseSnapshot:this.snapshot.baseSnapshot,snapshotBlobs:this.snapshot.snapshotBlobs,loadedGroupIdSnapshots:s?i:void 0,savedOps:this.processedOps,url:o.url,clientId:t};return JSON.stringify(c)})}}async function uo(e,t,r,o){const{snapshot:n,version:i}=r?await async function(e,t,r){const o=await(t.getSnapshot?.({versionId:r})),n=void 0===o?.snapshotTree.id?void 0:{id:o.snapshotTree.id,treeId:o.snapshotTree.id};void 0===o&&void 0!==r?e.logger.sendErrorEvent({eventName:"getSnapshotTreeFailed",id:r}):void 0!==o&&void 0===n?.id&&e.logger.sendErrorEvent({eventName:"getSnapshotFetchedTreeWithoutVersionId",hasVersion:void 0!==n});return{snapshot:o,version:n}}(e,t,o):await async function(e,t,r){const o=await t.getVersions(r??null,1),n=o[0];void 0===n&&void 0!==r&&e.logger.sendErrorEvent({eventName:"NoVersionFoundWhenSpecified",id:r});const i=await t.getSnapshotTree(n)??void 0;void 0===i&&void 0!==n?e.logger.sendErrorEvent({eventName:"getSnapshotTreeFailed",id:n.id}):void 0!==i&&void 0===n?.id&&e.logger.sendErrorEvent({eventName:"getSnapshotFetchedTreeWithoutVersionId",hasVersion:void 0!==n});return{snapshot:i,version:n}}(e,t,o);return We(void 0!==n,2276),{baseSnapshot:n,version:i}}const ho="saved";async function go(e){if(e.closed)throw new Tt("waitContainerToCatchUp: Container closed");return new Promise((t,r)=>{const o=e.deltaManager,n=t=>{e.off("closed",n);const o="Container closed while waiting to catch up";r(void 0===t?new Pt(o):Z(t,e=>new Pt(`${o}: ${e}`)))};e.on("closed",n);const i=()=>{We(e.connectionState===Re.CatchingUp||e.connectionState===Re.Connected,205);const r=o.hasCheckpointSequenceNumber,i=o.lastKnownSeqNumber;if(We(o.lastSequenceNumber<=i,614),o.lastSequenceNumber===i)return e.off("closed",n),void t(r);const s=a=>{i<=a.sequenceNumber&&(e.off("closed",n),t(r),o.off("op",s))};o.on("op",s)};if(e.connectionState===Re.Connected)return void i();const s=()=>{e.off(Dt,s),i()};e.on(Dt,s),e.connectionState===Re.Disconnected&&e.connect()})}const po="summarizer";class mo extends Ft{static async load(e,t){const{version:r,pendingLocalState:o,loadMode:n,resolvedUrl:i}=e,s=new mo(t,e);return le.timedExecAsync(s.mc.logger,{eventName:"Load",...n},async e=>new Promise((t,a)=>{const c={opsBeforeReturn:"cached"},d=o?{...n??c,opsBeforeReturn:void 0}:n??c,l=e=>{a(e??new Pt("Container closed without error during load"))};s.on("closed",l),s.load(r,d,i,o).finally(()=>{s.removeListener("closed",l)}).then(r=>{e.end({...r}),t(s)},e=>{const t=K(e);s.close(t),s.dispose(t),l(t)})}),{start:!0,end:!0,cancel:"generic"})}static async createDetached(e,t){const r=new mo(e);return le.timedExecAsync(r.mc.logger,{eventName:"CreateDetached"},async e=>(await r.createDetached(t),r),{start:!0,end:!0,cancel:"generic"})}static async rehydrateDetachedFromSnapshot(e,t){const r=new mo(e);return le.timedExecAsync(r.mc.logger,{eventName:"RehydrateDetachedFromSnapshot"},async e=>{const o=function(e){const t=JSON.parse(e);if(r=t,void 0!==r?.attached&&void 0!==r?.baseSnapshot&&void 0!==r?.snapshotBlobs&&void 0!==r?.hasAttachmentBlobs)return t;if(pt(t)){const{baseSnapshot:e,snapshotBlobs:r}=$t(t);return{attached:!1,baseSnapshot:e,snapshotBlobs:r,hasAttachmentBlobs:void 0!==t.tree[".hasAttachmentBlobs"]}}throw new Tt("Cannot rehydrate detached container. Incorrect format");var r}(t);return await r.rehydrateDetachedFromSnapshot(o),r},{start:!0,end:!0,cancel:"generic"})}setLoaded(){if("loading"===this._lifecycleState){this._lifecycleState="loaded",We(this.connectionState!==Re.Connected,2409),this.connectionStateHandler.initProtocol(this.protocolHandler);const e=this.readOnlyInfo.readonly??!1;this.setContextConnectedState(!1,e);const t=this._deltaManager.connectionManager;if(t.connected){const e=t.connectionDetails;We(void 0!==e,2410),this.connectionStateHandler.receivedConnectEvent(e)}}}get closed(){return"closing"===this._lifecycleState||"closed"===this._lifecycleState||this.disposed}get loaded(){return"loaded"===this._lifecycleState}get disposed(){return"disposing"===this._lifecycleState||"disposed"===this._lifecycleState}get runtime(){if(void 0===this._runtime)throw new Error("Attempted to access runtime before it was defined");return this._runtime}get protocolHandler(){if(void 0===this._protocolHandler)throw new Error("Attempted to access protocolHandler before it was defined");return this._protocolHandler}get connectionMode(){return this._deltaManager.connectionManager.connectionMode}get resolvedUrl(){return this.service?.resolvedUrl}get readOnlyInfo(){return this._deltaManager.readOnlyInfo}get containerMetadata(){return this._containerMetadata}forceReadonly(e){this._deltaManager.connectionManager.forceReadonly(e)}get deltaManager(){return this._deltaManager}get connectionState(){return this.connectionStateHandler.connectionState}get connected(){return this.connectionStateHandler.connectionState===Re.Connected}get clientId(){return this.protocolHandler.audience.getSelf()?.clientId}get isInteractiveClient(){return this.deltaManager.clientDetails.capabilities.interactive}supportGetSnapshotApi(){return!0===this.mc.config.getBoolean("Fluid.Container.UseLoadingGroupIdForSnapshotFetch2")&&!0===this.service?.policies?.supportGetSnapshotApi}getSpecifiedCodeDetails(){return this.getCodeDetailsFromQuorum()}getLoadedCodeDetails(){return this._loadedCodeDetails}getContainerPackageInfo(){return rr(this._loadedCodeDetails)}get audience(){return this.protocolHandler.audience}get isDirty(){return this._dirtyContainer}async getEntryPoint(){if(this._disposed)throw new Tt("The context is already disposed");return void 0!==this._runtime?this._runtime.getEntryPoint?.():new Promise((e,t)=>{const r=()=>{We(void 0!==this._runtime,1443),e(this._runtime.getEntryPoint?.()),this._lifecycleEvents.off("disposed",o)},o=()=>{t(new Error("ContainerContext was disposed")),this._lifecycleEvents.off("runtimeInstantiated",r)};this._lifecycleEvents.once("runtimeInstantiated",r),this._lifecycleEvents.once("disposed",o)})}constructor(e,t){super((e,t)=>{this.mc.logger.sendErrorEvent({eventName:"ContainerEventHandlerException",name:"string"===typeof e?e:void 0},t),this.close(K(t))}),this._lifecycleState="loading",this.inboundQueuePausedFromInit=!0,this.connectionCount=0,this.connectionTransitionTimes=[],this._dirtyContainer=!1,this.attachmentData={state:qe.Detached},this.clientsWhoShouldHaveLeft=new Set,this._containerMetadata={},this.setAutoReconnectTime=C(),this._lifecycleEvents=new Ve,this.verifyClosedAfterCalls=0,this._disposed=!1,this.attach=Kt(async(e,t)=>{await le.timedExecAsync(this.mc.logger,{eventName:"Attach"},async()=>{if("loaded"!==this._lifecycleState||this.attachmentData.state===qe.Attached)throw new Tt(`The Container is not in a valid state for attach [${this._lifecycleState}] and [${this.attachState}]`);const r=e=>{const t=K(e);return this.close(t),t.addTelemetryProperties({resolvedUrl:this.service?.resolvedUrl?.url}),t};let o=(async e=>{let{detachedBlobStorage:t,createOrGetStorageService:r,setAttachmentData:o,createAttachmentSummary:n,offlineLoadEnabled:i,initialAttachmentData:s}=e,a=s;void 0===a.blobs&&(a=void 0!==t&&t.size>0?{state:qe.Detached,blobs:"outstanding",redirectTable:new Map}:{state:qe.Attaching,summary:n(),blobs:"none"},o(a));const c=await r(a.summary);if("outstanding"===a.blobs){const{redirectTable:e}=a;for(We(!!t,590);e.size<t.size;){const r=t.getBlobIds().filter(t=>!e.has(t));for(const o of r){const r=await t.readBlob(o),n=await c.createBlob(r);e.set(o,n.id)}}o(a={state:qe.Attaching,summary:n(e),blobs:"done"})}We(a.state===qe.Attaching,2274),"done"===a.blobs&&await c.uploadSummaryWithContext(a.summary,{referenceSequenceNumber:0,ackHandle:void 0,proposalHandle:void 0});const d=i?$t(a.summary):void 0;return o(a={state:qe.Attached}),d})({initialAttachmentData:this.attachmentData,offlineLoadEnabled:this.serializedStateManager.offlineLoadEnabled,detachedBlobStorage:this.detachedBlobStorage,setAttachmentData:e=>{const t=this.attachmentData.state;this.attachmentData=e;const o=this.attachmentData.state;if(o!==t&&o!==qe.Detached)try{this.runtime.setAttachState(o),this.emit(o.toLocaleLowerCase())}catch(n){throw r(n)}},createAttachmentSummary:e=>{try{return We(0===this._deltaManager.inbound.length,214),jt(this.runtime.createSummary(e),this.captureProtocolSummary())}catch(t){throw r(t)}},createOrGetStorageService:async t=>{if(void 0===this.service){const r=await this.urlResolver.resolve(e);We(this.client.details.type!==po&&void 0!==r,708),this.service=await lt(async()=>this.serviceFactory.createContainer(t,r,this.subLogger,!1),"containerAttach",this.mc.logger,{cancel:this._deltaManager.closeAbortController.signal})}return this.storageAdapter.connectToService(this.service),this.storageAdapter}});!0!==this.mc.config.getBoolean("Fluid.Container.RetryOnAttachFailure")&&(o=o.catch(e=>{throw r(e)}));const n=await o;this.serializedStateManager.setInitialSnapshot(n),this.closed||(this.detachedBlobStorage?.dispose?.(),this.handleDeltaConnectionArg(t?.deltaConnection,{fetchOpsFromStorage:!1,reason:{text:"createDetached"}}))},{start:!0,end:!0,cancel:"generic"})}),this.getAbsoluteUrl=async e=>{if(void 0!==this.resolvedUrl)return this.urlResolver.getAbsoluteUrl(this.resolvedUrl,e,rr(this._loadedCodeDetails))},this.metadataUpdateHandler=e=>{this._containerMetadata={...this._containerMetadata,...e},this.emit("metadataUpdate",e)},this.updateDirtyContainerState=e=>{this._dirtyContainer!==e&&(this._dirtyContainer=e,this.emit(e?"dirty":ho))};const{canReconnect:r,clientDetailsOverride:o,urlResolver:n,documentServiceFactory:i,codeLoader:s,options:a,scope:c,subLogger:d,detachedBlobStorage:l,protocolHandlerBuilder:u}=e;this.connectionTransitionTimes[Re.Disconnected]=C();const h=t?.pendingLocalState;this._canReconnect=r??!0,this.clientDetailsOverride=o,this.urlResolver=n,this.serviceFactory=i,this.codeLoader=s,this.options={...a},this.scope=c,this.protocolHandlerBuilder=u??((e,t,r)=>new gr(e,t,r,new Yt,e=>this.clientsWhoShouldHaveLeft.has(e))),this.clone=async(t,r)=>mo.load(t,{...e,...r}),this._containerId=z(),this.client=mo.setupClient(this._containerId,a.client,this.clientDetailsOverride);const g=this.client.details.type,p=this.client.details.capabilities.interactive,m=`${p?"interactive":"noninteractive"}${void 0!==g&&""!==g?`/${g}`:""}`;this.subLogger=ae({logger:d,properties:{all:{clientType:m,containerId:this._containerId,docId:()=>this.resolvedUrl?.id,containerAttachState:()=>this.attachState,containerLifecycleState:()=>this._lifecycleState,containerConnectionState:()=>Re[this.connectionState],serializedContainer:void 0!==h},error:{dmInitialSeqNumber:()=>this._deltaManager?.initialSequenceNumber,dmLastProcessedSeqNumber:()=>this._deltaManager?.lastSequenceNumber,dmLastKnownSeqNumber:()=>this._deltaManager?.lastKnownSeqNumber,containerLoadedFromVersionId:()=>this._loadedFromVersion?.id,containerLoadedFromVersionDate:()=>this._loadedFromVersion?.date,dmLastMsqSeqNumber:()=>this.deltaManager?.lastMessage?.sequenceNumber,dmLastMsqSeqTimestamp:()=>this.deltaManager?.lastMessage?.timestamp,dmLastMsqSeqClientId:()=>null===this.deltaManager?.lastMessage?.clientId?"null":this.deltaManager?.lastMessage?.clientId,dmLastMsgClientSeq:()=>this.deltaManager?.lastMessage?.clientSequenceNumber,connectionStateDuration:()=>C()-this.connectionTransitionTimes[this.connectionState]}}}),this.mc=M({logger:this.subLogger,namespace:"Container"}),this._deltaManager=this.createDeltaManager(),this.connectionStateHandler=Er({logger:this.mc.logger,mc:x(d),connectionStateChanged:(e,t,r)=>{this.logConnectionStateChangeTelemetry(e,t,r),this.loaded&&this.propagateConnectionState(e===Re.Disconnected?r:void 0)},shouldClientJoinWrite:()=>this._deltaManager.connectionManager.shouldJoinWrite(),maxClientLeaveWaitTime:a.maxClientLeaveWaitTime,logConnectionIssue:(e,t,r)=>{const o=this.connectionMode;if(this._deltaManager.logConnectionIssue({eventName:e,mode:o,category:"loading"===this._lifecycleState?"generic":t,duration:C()-this.connectionTransitionTimes[Re.CatchingUp],...void 0===r?{}:{details:JSON.stringify(r)}}),We(this.loaded,2411),"read"===o&&"error"===t){const e={text:"NoJoinSignal"};this.disconnectInternal(e),this.connectInternal({reason:e,fetchOpsFromStorage:!1})}},clientShouldHaveLeft:e=>{this.clientsWhoShouldHaveLeft.add(e)},onCriticalError:e=>{this.close(K(e))}},this.deltaManager,h?.clientId),this.on(ho,()=>{this.connectionStateHandler.containerSaved()});const f=this.mc.config.getBoolean("Fluid.Container.summarizeProtocolTree2");this.detachedBlobStorage=l??(!0===this.mc.config.getBoolean("Fluid.Container.MemoryBlobStorageEnabled")?function(){const e=[];return{[oo]:oo,createBlob:async t=>({id:""+(e.push(t)-1)}),readBlob:async t=>e[Number(t)]??Promise.reject(new Error(`Blob not found: ${t}`)),get size(){return e.length},getBlobIds:()=>e.map((e,t)=>`${t}`),dispose:()=>e.splice(0),serialize:()=>JSON.stringify(e.map(e=>St(e,"utf8"))),initialize:t=>e.push(...t.map(e=>bt(e,"utf8")))}}():void 0),this.storageAdapter=new Hr(this.detachedBlobStorage,this.mc.logger,h?.snapshotBlobs,h?.loadedGroupIdSnapshots,e=>!0===pt(e)?e:jt(e,this.captureProtocolSummary()),f);const v=(this.isInteractiveClient&&this.mc.config.getBoolean("Fluid.Container.enableOfflineLoad"))??!0===a.enableOfflineLoad;this.serializedStateManager=new lo(h,this.subLogger,this.storageAdapter,v,this,()=>this._deltaManager.connectionManager.shouldJoinWrite(),()=>this.supportGetSnapshotApi(),this.mc.config.getNumber("Fluid.Container.snapshotRefreshTimeoutMs"));"object"===typeof document&&null!==document&&"function"===typeof document.addEventListener&&null!==document.addEventListener&&p&&(this.lastVisible=document.hidden?C():void 0,this.visibilityEventHandler=()=>{document.hidden?this.lastVisible=C():setTimeout(()=>{this.lastVisible=void 0},0)},document.addEventListener("visibilitychange",this.visibilityEventHandler))}getQuorum(){return this.protocolHandler.quorum}dispose(e){this.verifyClosedAfter(()=>this._deltaManager.dispose(e))}close(e){this.verifyClosedAfter(()=>this._deltaManager.close(e))}verifyClosedAfter(e){this.verifyClosedAfterCalls++;try{e()}finally{this.verifyClosedAfterCalls--}0===this.verifyClosedAfterCalls&&(We(this.connectionState===Re.Disconnected,207),We("closed"===this._lifecycleState||"disposed"===this._lifecycleState,788))}closeCore(e){We(!this.closed,789);try{try{this.mc.logger.sendTelemetryEvent({eventName:"ContainerClose",category:"loading"!==this._lifecycleState&&void 0!==e?"error":"generic"},e),this._lifecycleState="closing",void 0!==this.service?.off&&this.service?.off("metadataUpdate",this.metadataUpdateHandler),this._protocolHandler?.close(),this.connectionStateHandler.dispose()}catch(t){this.mc.logger.sendErrorEvent({eventName:"ContainerCloseException"},t)}this.emit("closed",e),void 0!==this.visibilityEventHandler&&document.removeEventListener("visibilitychange",this.visibilityEventHandler)}finally{this._lifecycleState="closed",this.client.details.type===po&&this.dispose(e)}}disposeCore(e){We(!this._disposed,1356),this._disposed=!0;try{try{this.mc.logger.sendTelemetryEvent({eventName:"ContainerDispose",category:this.closed||void 0===e?"generic":"error"},e),"closed"!==this._lifecycleState&&(this._lifecycleState="disposing"),this._protocolHandler?.close(),this.connectionStateHandler.dispose();const t=void 0===e?void 0:new Error(e.message);this._runtime?.dispose(t),this.storageAdapter.dispose(),this.service?.dispose(e)}catch(t){this.mc.logger.sendErrorEvent({eventName:"ContainerDisposeException"},t)}this.emit("disposed",e),this.removeAllListeners(),void 0!==this.visibilityEventHandler&&document.removeEventListener("visibilitychange",this.visibilityEventHandler)}finally{this._lifecycleState="disposed",this._lifecycleEvents.emit("disposed")}}async closeAndGetPendingLocalState(e){const t=await this.getPendingLocalStateCore({notifyImminentClosure:!0,stopBlobAttachingSignal:e});return this.close(),t}async getPendingLocalState(){return this.getPendingLocalStateCore({notifyImminentClosure:!1})}async getPendingLocalStateCore(e){if(this.closed||this._disposed)throw new Tt("Pending state cannot be retried if the container is closed or disposed");We(this.attachmentData.state===qe.Attached,209),We(void 0!==this.resolvedUrl&&"fluid"===this.resolvedUrl.type,210);return await this.serializedStateManager.getPendingLocalState(e,this.clientId,this.runtime,this.resolvedUrl)}get attachState(){return this.attachmentData.state}serialize(){if(this.attachmentData.state===qe.Attached||this.closed)throw new Tt("Container must not be attached or closed.");const e=this.attachmentData.state===qe.Attaching?this.attachmentData:void 0,t=e?.summary??jt(this.runtime.createSummary(),this.captureProtocolSummary()),{baseSnapshot:r,snapshotBlobs:o}=$t(t),n=void 0===e?void 0:this.runtime.getPendingLocalState();var i;We(!(Je(i=n)&&"then"in i&&"function"===typeof i.then),2275);const s={attached:!1,baseSnapshot:r,snapshotBlobs:o,pendingRuntimeState:n,hasAttachmentBlobs:void 0!==this.detachedBlobStorage&&this.detachedBlobStorage.size>0,attachmentBlobs:io(this.detachedBlobStorage)};return JSON.stringify(s)}setAutoReconnectInternal(e,t){if(this._deltaManager.connectionManager.reconnectMode===e)return;const r=C(),o=r-this.setAutoReconnectTime;this.setAutoReconnectTime=r,this.mc.logger.sendTelemetryEvent({eventName:e===Xt.Enabled?"AutoReconnectEnabled":"AutoReconnectDisabled",connectionMode:this.connectionMode,connectionState:Re[this.connectionState],duration:o}),this._deltaManager.connectionManager.setAutoReconnect(e,t)}connect(){if(this.closed)throw new Tt("The Container is closed and cannot be connected");if(this.attachState!==qe.Attached)throw new Tt("The Container is not attached and cannot be connected");this.connected||this.connectInternal({reason:{text:"DocumentConnect"},fetchOpsFromStorage:!1})}connectInternal(e){We(!this.closed,709),We(this.attachState===qe.Attached,710);const t=Xt.Enabled;this.setAutoReconnectInternal(t,e.reason),this.resumeInternal(e)}disconnect(){if(this.closed)throw new Tt("The Container is closed and cannot be disconnected");this.disconnectInternal({text:"DocumentDisconnect"})}disconnectInternal(e){We(!this.closed,711);const t=Xt.Disabled;this.setAutoReconnectInternal(t,e)}resumeInternal(e){We(!this.closed,217),this.inboundQueuePausedFromInit&&(We(this.loaded,2412),this.inboundQueuePausedFromInit=!1,this._deltaManager.inbound.resume(),this._deltaManager.inboundSignal.resume()),this.connectToDeltaStream(e)}async proposeCodeDetails(e){if(!Ge(e))throw new Error("Provided codeDetails are not IFluidCodeDetails");if(this.codeLoader.IFluidCodeDetailsComparer){const t=await this.codeLoader.IFluidCodeDetailsComparer.compare(e,this.getCodeDetailsFromQuorum());if(void 0!==t&&t<=0)throw new Error("Proposed code details should be greater than the current")}return this.protocolHandler.quorum.propose("code",e).then(()=>!0).catch(()=>!1)}async processCodeProposal(){const e=this.getCodeDetailsFromQuorum();if(await Promise.all([this._deltaManager.inbound.pause(),this._deltaManager.inboundSignal.pause()]),!0===await this.satisfies(e))return this._deltaManager.inbound.resume(),void this._deltaManager.inboundSignal.resume();const t=new Pt("Existing context does not satisfy incoming proposal");this.close(t)}async satisfies(e){if(void 0===this._loadedModule)return!1;const t=[],r=this.codeLoader;void 0!==r.IFluidCodeDetailsComparer&&t.push(r.IFluidCodeDetailsComparer);const o=this._loadedModule?.module.fluidExport;if(void 0!==o?.IFluidCodeDetailsComparer&&t.push(o.IFluidCodeDetailsComparer),0===t.length)return!1;for(const n of t){if(!1===await n.satisfies(this._loadedModule?.details,e))return!1}return!0}connectToDeltaStream(e){this._canReconnect&&this.client.details.capabilities.interactive||(e.mode="write"),this._deltaManager.connect(e)}async createDocumentService(e){const t=await e();return void 0!==t.on&&t.on("metadataUpdate",this.metadataUpdateHandler),t}async load(e,t,r,o){const n={phase1:C()};this.service=await this.createDocumentService(async()=>this.serviceFactory.createDocumentService(r,this.subLogger,this.client.details.type===po));const i={reason:{text:"DocumentOpen"},mode:!0===this.mc.config.getBoolean("Fluid.Container.ForceWriteConnection")||(o?.savedOps.length??0)>0?"write":"read",fetchOpsFromStorage:!1};void 0===t.deltaConnection&&this.connectToDeltaStream(i),this.storageAdapter.connectToService(this.service),this.attachmentData={state:qe.Attached},n.phase2=C();const{baseSnapshot:s,version:a}=await this.serializedStateManager.fetchSnapshot(e),c=ft(s);this._loadedFromVersion=a;const d=await Qt(this.storageAdapter,c),l=o?.savedOps[o.savedOps.length-1]?.sequenceNumber??d.sequenceNumber;let u;switch(t.opsBeforeReturn){case void 0:this.attachDeltaManagerOpHandler(d,"none"===t.deltaConnection?"none":"all",l);break;case"cached":case"all":u=this.attachDeltaManagerOpHandler(d,t.opsBeforeReturn,l);break;default:Ke(t.opsBeforeReturn)}await this.initializeProtocolStateFromSnapshot(d,this.storageAdapter,c),We(void 0===this.clientId,2413),void 0!==o?.clientId&&this.protocolHandler.audience.setCurrentClientId(o?.clientId),n.phase3=C();const h=this.getCodeDetailsFromQuorum();if(await this.instantiateRuntime(h,c,o?o?.pendingRuntimeState??{}:void 0,mt(s)?s:void 0),o){for(const e of o.savedOps)this.processRemoteMessage({...e,metadata:{...e.metadata,savedOp:!0}}),await(this.runtime.notifyOpReplay?.(e));o.savedOps=[],this.storageAdapter.clearPendingState()}if(this.closed||(void 0!==u&&(this._deltaManager.inbound.resume(),await le.timedExecAsync(this.mc.logger,{eventName:"WaitOps"},async()=>u),await le.timedExecAsync(this.mc.logger,{eventName:"WaitOpProcessing"},async()=>this._deltaManager.inbound.waitTillProcessingDone()),this._deltaManager.inbound.pause()),this.setLoaded(),this.handleDeltaConnectionArg(t.deltaConnection)),this.closed)throw new Error("Container was closed while load()");return n.end=C(),this.subLogger.sendTelemetryEvent({eventName:"LoadStagesTimings",details:JSON.stringify(n)},void 0,k),{sequenceNumber:d.sequenceNumber,version:a?.id,dmLastProcessedSeqNumber:this._deltaManager.lastSequenceNumber,dmLastKnownSeqNumber:this._deltaManager.lastKnownSeqNumber}}async createDetached(e){const t={sequenceNumber:0,minimumSequenceNumber:0};await this.attachDeltaManagerOpHandler(t);const r=[["code",{key:"code",value:e,approvalSequenceNumber:0,commitSequenceNumber:0,sequenceNumber:0}]];this.initializeProtocolState(t,{members:[],proposals:[],values:r}),await this.instantiateRuntime(e,void 0),this.setLoaded()}async rehydrateDetachedFromSnapshot(e){let{baseSnapshot:t,snapshotBlobs:r,hasAttachmentBlobs:o,attachmentBlobs:n,pendingRuntimeState:i}=e;o&&(void 0!==n&&function(e,t){if(!no(e))throw new Error("DetachedBlobStorage was not provided to the loader during serialize so cannot be provided during rehydrate.");We(0===e.size,2462);const r=JSON.parse(t);We(Array.isArray(r),2463),e.initialize(r)}(this.detachedBlobStorage,n),We(void 0!==this.detachedBlobStorage&&this.detachedBlobStorage.size>0,592));const s=Wt(t,r);this.storageAdapter.loadSnapshotFromSnapshotBlobs(r);const a=await Qt(this.storageAdapter,s);await this.attachDeltaManagerOpHandler(a);const c=Gt(s),d=await wt(this.storageAdapter,c.blobs.quorumValues);this.initializeProtocolState(a,{members:[],proposals:[],values:d});const l=this.getCodeDetailsFromQuorum();await this.instantiateRuntime(l,s,i),this.setLoaded()}async initializeProtocolStateFromSnapshot(e,t,r){const o={members:[],proposals:[],values:[]};if(void 0!==r){const e=Gt(r);[o.members,o.proposals,o.values]=await Promise.all([wt(t,e.blobs.quorumMembers),wt(t,e.blobs.quorumProposals),wt(t,e.blobs.quorumValues)])}this.initializeProtocolState(e,o)}initializeProtocolState(e,t){const r=this.protocolHandlerBuilder(e,t,(e,t)=>this.submitMessage(Ye.Propose,JSON.stringify({key:e,value:t}))),o=ae({logger:this.subLogger,namespace:"ProtocolHandler"});r.quorum.on("error",e=>{o.sendErrorEvent(e)}),r.quorum.on("addProposal",e=>{"code"!==e.key&&"code2"!==e.key||this.emit("codeDetailsProposed",e.value,e)}),r.quorum.on("approveProposal",(e,t,r)=>{"code"!==t&&"code2"!==t||(Ge(r)||this.mc.logger.sendErrorEvent({eventName:"CodeProposalNotIFluidCodeDetails"}),this.processCodeProposal().catch(e=>{const t=K(e);throw this.close(t),e}))}),this._protocolHandler=r}captureProtocolSummary(){const e=this.protocolHandler.snapshot();return{tree:{attributes:{content:JSON.stringify(this.protocolHandler.attributes),type:Qe.Blob},quorumMembers:{content:JSON.stringify(e.members),type:Qe.Blob},quorumProposals:{content:JSON.stringify(e.proposals),type:Qe.Blob},quorumValues:{content:JSON.stringify(e.values),type:Qe.Blob}},type:Qe.Tree}}getCodeDetailsFromQuorum(){const e=(e=>e.get("code")??e.get("code2"))(this.protocolHandler.quorum);return e}static setupClient(e,t,r){const o=void 0===t?{details:{capabilities:{interactive:!0}},mode:"read",permission:[],scopes:[],user:{id:""}}:Ht(t);return void 0!==r&&(o.details={...o.details,...r,capabilities:{...o.details.capabilities,...r?.capabilities}}),o.details.environment=[o.details.environment,` loaderVersion:${Br}`,` containerId:${e}`].join(";"),o}activeConnection(){return this.connectionState===Re.Connected&&"write"===this.connectionMode}createDeltaManager(){const e=()=>this.service,t=new Kr(e,ae({logger:this.subLogger,namespace:"DeltaManager"}),()=>this.activeConnection(),t=>new Cr(e,()=>this.isDirty,this.client,this._canReconnect,ae({logger:this.subLogger,namespace:"ConnectionManager"}),t));return t.inbound.pause(),t.inboundSignal.pause(),t.on("connect",(e,t)=>{We(this.connectionMode===e.mode,1207),this.loaded&&this.connectionStateHandler.receivedConnectEvent(e)}),t.on("establishingConnection",e=>{this.connectionStateHandler.establishingConnection(e)}),t.on("cancelEstablishingConnection",e=>{this.connectionStateHandler.cancelEstablishingConnection(e)}),t.on("disconnect",(e,t)=>{this.noopHeuristic?.notifyDisconnect();const r={text:e,error:t};this.loaded?this.connectionStateHandler.receivedDisconnectEvent(r):this.closed||this.connectionStateHandler.cancelEstablishingConnection(r)}),t.on("throttled",e=>{const t=e;!0!==t.logged&&this.mc.logger.sendTelemetryEvent({eventName:"ContainerWarning"},t),this.emit("warning",t)}),t.on("readonly",e=>{this.loaded&&this.setContextConnectedState(this.connectionState===Re.Connected,e),this.emit("readonly",e)}),t.on("closed",e=>{this.closeCore(e)}),t.on("disposed",e=>{this.disposeCore(e)}),t}async attachDeltaManagerOpHandler(e,t,r){return this._deltaManager.attachOpHandler(e.minimumSequenceNumber,e.sequenceNumber,{process:e=>this.processRemoteMessage(e),processSignal:e=>{this.processSignal(e)}},t,r)}logConnectionStateChangeTelemetry(e,t,r){const o=C();this.connectionTransitionTimes[e]=o;const n=o-this.connectionTransitionTimes[t];let i,s,a,c;e===Re.Disconnected?s=this._deltaManager.connectionManager.reconnectMode:e===Re.Connected?(i=o-this.connectionTransitionTimes[Re.Disconnected],i=ie(i)):e===Re.CatchingUp&&(a=this.deltaManager.lastKnownSeqNumber,this.deltaManager.hasCheckpointSequenceNumber&&this.loaded&&(c=a-this.deltaManager.lastSequenceNumber)),this.mc.logger.sendPerformanceEvent({eventName:`ConnectionStateChange_${Re[e]}`,from:Re[t],duration:n,durationFromDisconnected:i,reason:r?.text,connectionCount:this.connectionCount,pendingClientId:this.connectionStateHandler.pendingClientId,clientId:this.connectionStateHandler.clientId,autoReconnect:s,opsBehind:c,online:tt[rt()],lastVisible:void 0===this.lastVisible?void 0:C()-this.lastVisible,checkpointSequenceNumber:a,quorumSize:this._protocolHandler?.quorum.getMembers().size,audienceSize:this._protocolHandler?.audience.getMembers().size,isDirty:this.isDirty,...this._deltaManager.connectionProps},r?.error),e===Re.Connected&&this.connectionCount++}propagateConnectionState(e){const t=this.connectionState===Re.Connected;if(t){const e=this.connectionStateHandler.clientId;We(void 0!==e,2414),this.protocolHandler.audience.setCurrentClientId(e)}this.connectionState!==Re.Connected&&this.connectionState!==Re.Disconnected||(this.setContextConnectedState(t,this.readOnlyInfo.readonly??!1),this.protocolHandler.setConnectionState(t,this.clientId),function(e,t,r,o,n){try{r?t.emit(Dt,o):t.emit("disconnected",n)}catch(i){e.sendErrorEvent({eventName:"RaiseConnectedEventError"},i)}}(this.mc.logger,this,t,this.clientId,e?.text))}submitContainerMessage(e,t,r,o){switch(e){case Ye.Operation:return this.submitMessage(e,JSON.stringify(t),r,o);case Ye.Summarize:return this.submitSummaryMessage(t);default:{const t=new Pt("invalidContainerSubmitOpType",void 0,{messageType:e});return this.close(t),-1}}}submitBatch(e,t){let r=-1;for(const o of e)r=this.submitMessage(Ye.Operation,o.contents,!0,o.metadata,o.compression,t);return this._deltaManager.flush(),r}submitSummaryMessage(e,t){return void 0===e.details&&(e.details={}),e.details.includesProtocolTree=this.storageAdapter.summarizeProtocolTree,this.submitMessage(Ye.Summarize,JSON.stringify(e),!1,void 0,void 0,t)}submitMessage(e,t,r,o,n,i){return this.connectionState!==Re.Connected?(this.mc.logger.sendErrorEvent({eventName:"SubmitMessageWithNoConnection",type:e}),-1):(this.noopHeuristic?.notifyMessageSent(),this._deltaManager.submit(e,t,r,o,n,i))}processRemoteMessage(e){const t=this.clientId===e.clientId,r=this.protocolHandler.processMessage(e,t);if(this.runtime.process(e,t),this.serializedStateManager.addProcessedOp(e),this.activeConnection()){if(void 0===this.noopHeuristic){const e=this.deltaManager.serviceConfiguration;We(void 0!==e,740),this.noopHeuristic=new so(e.noopTimeFrequency,e.noopCountFrequency),this.noopHeuristic.on("wantsNoop",()=>{We(this.activeConnection(),577),this.submitMessage(Ye.NoOp)})}this.noopHeuristic.notifyMessageProcessed(e),!0===r.immediateNoOp&&this.submitMessage(Ye.Accept)}this.emit("op",e)}submitSignal(e,t){this._deltaManager.submitSignal(JSON.stringify(e),t)}processSignal(e){if(function(e){if(null===e.clientId){const t=e.content;return t.type===hr.Clear||t.type===hr.ClientJoin||t.type===hr.ClientLeave}return!1}(e))this.protocolHandler.processSignal(e);else{const t=this.clientId===e.clientId;this.runtime.processSignal(e,t)}}async instantiateRuntime(e,t,r,o){We(!1!==this._runtime?.disposed,221);const n=this.scope,i=new to(this,n.ILoader),s=await le.timedExecAsync(this.subLogger,{eventName:"CodeLoad"},async()=>this.codeLoader.load(e));this._loadedModule={module:s.module,details:s.details??e};const a=this._loadedModule.module.fluidExport,c=a?.IRuntimeFactory;if(void 0===c)throw new Error("Code package does not implement IRuntimeFactory");const d=void 0!==t,l=new Or(this.options,this.scope,t,this._loadedFromVersion,this._deltaManager,this.storageAdapter,this.protocolHandler.quorum,this.protocolHandler.audience,i,(e,t,r,o)=>this.submitContainerMessage(e,t,r,o),(e,t)=>this.submitSummaryMessage(e,t),(e,t)=>this.submitBatch(e,t),(e,t)=>this.submitSignal(e,t),e=>this.dispose(e),e=>this.close(e),this.updateDirtyContainerState,this.getAbsoluteUrl,()=>this.resolvedUrl?.id,()=>this.clientId,()=>this.attachState,()=>this.connected,this._deltaManager.clientDetails,d,this.subLogger,r,o),u=await le.timedExecAsync(this.subLogger,{eventName:"InstantiateRuntime"},async()=>c.instantiateRuntime(l,d));Ar(u.ILayerCompatDetails,e=>this.dispose(e)),this._runtime=u,this._lifecycleEvents.emit("runtimeInstantiated"),this._loadedCodeDetails=e}setContextConnectedState(e,t){!1===this._runtime?.disposed&&this.loaded&&this.runtime.setConnectionState(e&&!t,this.clientId)}handleDeltaConnectionArg(e,t){switch(We(this.loaded,2415),e){case void 0:t&&this.connectToDeltaStream(t);case"delayed":We(this.inboundQueuePausedFromInit,838),this.inboundQueuePausedFromInit=!1,this._deltaManager.inbound.resume(),this._deltaManager.inboundSignal.resume();break;case"none":break;default:Ke(e)}}}var fo=r(60835),vo=r(27284);class yo extends vo.EventEmitter{emit(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return super.emit(e,...r)}trackContainerEvents(){this.container.audience.on("addMember",this.addMemberEventHandler),this.container.audience.on("removeMember",this.removeMemberEventHandler),this.container.on("connected",this.connectedEventHandler),this.container.on("disconnected",this.disconnectedEventHandler),this.container.on("dirty",this.dirtyEventHandler),this.container.on("saved",this.savedEventHandler),this.container.on("readonly",this.readonlyEventHandler),this.container.on("closed",this.closedEventHandler),this.container.on("disposed",this.disposedEventHandler),this.container.on("warning",this.waringEventHandler)}trackComponentEvents(){const e=this.component.Lifecycle??this.component.ComponentLifecycle;e?.on("dirty",this.dirtyEventHandler),e?.on("readonlyChanged",this.readonlyEventHandler)}removeContainerListeners(){this.container.audience.off("addMember",this.addMemberEventHandler),this.container.audience.off("removeMember",this.removeMemberEventHandler),this.container.off("connected",this.connectedEventHandler),this.container.off("disconnected",this.disconnectedEventHandler),this.container.off("dirty",this.dirtyEventHandler),this.container.off("saved",this.savedEventHandler),this.container.off("readonly",this.readonlyEventHandler),this.container.off("closed",this.closedEventHandler),this.container.off("disposed",this.disposedEventHandler),this.container.off("warning",this.waringEventHandler)}removeComponentListeners(){const e=this.component.Lifecycle??this.component.ComponentLifecycle;e?.off("dirty",this.dirtyEventHandler),e?.off("readonlyChanged",this.readonlyEventHandler)}get ComponentLifecycle(){return this}get disposed(){return this.container.disposed||this._disposed}get isDirty(){return void 0!==this.component.Lifecycle?.isDirty?this.container.isDirty||this.component.Lifecycle.isDirty:this.container.isDirty}get isReadOnly(){const e=this.component.Lifecycle??this.component.ComponentLifecycle;return(this.container.readOnlyInfo.readonly||e?.isReadOnly)??!1}getReadonly(){const e=this.component.Lifecycle??this.component.ComponentLifecycle;return e?.getReadonly?.()??{isReadOnly:this.isReadOnly}}get Lifecycle(){return this}async waitForAllData(){await go(this.container)}get Disposable(){return this}dispose(){this._disposed=!0,this.component.Disposable?.dispose(),this.container.dispose()}get ConnectionManager(){return this}get isConnected(){return this.container.connectionState===Re.Connected}connect(){this.container.connect()}disconnect(){this.container.disconnect()}get CollaboratorInfo(){return this}get clientId(){return this.container.clientId}getMembers(){const e=new Map;return this.container.audience.getMembers().forEach((t,r)=>{const o=t.user;e.set(r,{id:o.id,name:o.name,email:o.email,joinTime:t.timestamp,isGuest:o.isGuest,mode:t.mode})}),e}get FluidMetadataProvider(){return this}getCodeDetails(){return this.container.getLoadedCodeDetails()}getSnapshot(){return this.container.serialize()}get LoopComponentUrl(){return this}async initializeLoopComponentUrl(e){if(!e)throw new Error("File name is required to initialize component url.");const t=await this.documentServiceFactoryProviderPromise;if(!t?.getCreateDocumentRequest)throw new Error("FluidDocumentServiceFactoryProvider.getCreateDocumentRequest is required to initialize component url");const r=await t.getCreateDocumentRequest(e);await this.container.attach(r)}async getLoopComponentUrl(){const e=this.documentUrl?this.documentUrl:await this.container.getAbsoluteUrl("/");if(e)return new URL(e)}get FluidShareLinkInfo(){return this}getShareLink(){const e=this.container.resolvedUrl;if(e&&(0,fo.g2)(e))return e.shareLinkInfo}constructor(e,t,r,o){super(),this.container=e,this.documentUrl=t,this.documentServiceFactoryProviderPromise=r,this.component=o,this.addMemberEventHandler=()=>{this.emit("membersChanged",!0)},this.removeMemberEventHandler=()=>{this.emit("membersChanged",!1)},this.connectedEventHandler=()=>{this.emit("connected")},this.disconnectedEventHandler=e=>{this.emit("disconnected",e)},this.dirtyEventHandler=()=>{this.emit("dirty")},this.savedEventHandler=()=>{this.emit("saved")},this.readonlyEventHandler=()=>{this.emit("readonlyChanged",this.getReadonly().isReadOnly)},this.closedEventHandler=e=>{this.emit("error",e)},this.disposedEventHandler=()=>{this.removeContainerListeners(),this.removeComponentListeners(),this.removeAllListeners(),this._disposed=!0,this.emit("disposed")},this.waringEventHandler=e=>{this.emit("warning",e)},this.trackContainerEvents(),this.trackComponentEvents(),this.container.forceReadonly&&(this.setReadonly=(e,t)=>{if(t){const t=this.component.Lifecycle??this.component.ComponentLifecycle;t?.setReadonly?.(e,!0)}else this.container.forceReadonly?.(e)}),this._disposed=!1}}const bo={ComponentLifecycle:"ComponentLifecycle",ConnectionManager:"ConnectionManager",CollaboratorInfo:"CollaboratorInfo",FluidMetadataProvider:"FluidMetadataProvider",LoopComponentUrl:"LoopComponentUrl",Disposable:"Disposable",FluidShareLinkInfo:"FluidShareLinkInfo",Lifecycle:"Lifecycle"};function So(e,t,r,o,n){const i={};let s;t&&function(e){return Object.keys(bo).some(t=>t in e)}(r)&&(s=new yo(t,n,o,e));for(const a of Object.keys(r)){const t=s&&a in s?{value:s[a]}:{value:e[a]};Object.defineProperty(i,a,t)}return i}class Co{static getPathParts(e){const t=e.indexOf("?");return e.substring(0,t<0?e.length:t).split("/").reduce((e,t)=>(void 0!==t&&t.length>0&&e.push(decodeURIComponent(t)),e),[])}static create(e){return e instanceof Co?e:new Co(e)}constructor(e){this.request=e;const t=this.request.url.indexOf("?");this.query=t>=0?this.request.url.substring(t):"",void 0!==e.headers&&(this.headers=e.headers)}get url(){return this.request.url}get pathParts(){return void 0===this.requestPathParts&&(this.requestPathParts=Co.getPathParts(this.url)),this.requestPathParts}isLeaf(e){return""===this.query&&this.pathParts.length===e}createSubRequest(e){const t=this.pathParts.length;if(e<0||e>t)throw new Error("incorrect sub-request");if(e===t&&this.url.includes("?"))return{url:`/${this.query}`,headers:this.headers};const r=`/${this.pathParts.slice(e).join("/")}`;return{url:""===this.query?r:`${r}/${this.query}`,headers:this.headers}}}async function ko(e,t,r,o){let n="/";if(o){const e=await t.resolve({url:o.url});if(!e)throw new Error(`Get undefined for resolvedUrl with ${o.url}`);const r=Ut(function(e){try{const t=new URL(e);if("fluid-odsp:"===t.protocol)return t.protocol="https",t.href}catch{}return e}(e.url));void 0!==r&&(n=`${r.path}${r.query}`)}const i={url:n,headers:r},s=await(e.getEntryPoint?.());if(s){const e={status:200,mimeType:"fluid/object",value:s};if("/"===i.url||""===i.url)return e;const t=await(s.UrlRouterFetcher?.getUrlRouter());return await(t?.request(Co.create(i)))??e}const a=e.runtime?.request;if(a&&"function"===typeof a)return a(i);throw new Error("Could not invoke the request via the legacy back-compat path: `container.runtime.request` not found.")}const wo="IFluidHandle",Po=Symbol.for("FluidHandle-3978c7cf-4675-49ba-a20c-bf35efbf43da"),To=!0;function Eo(e){if(!(Po in e)||!(Po in e[Po])){if(To&&wo in e)return e[wo];throw new TypeError("Invalid IFluidHandle")}return e[Po]}async function No(e,t,r,o,n,i,s,a,d){const u=p.m.start(l.a$,o,{addUserTiming:!0,isAPerformanceMetric:!0}),h=(0,c.yb)();let g;try{g=await async function(e,t,r,o,n,i,s){const a=p.m.start(l.ol,o,{addUserTiming:!0});let c;if(n){const o={...r?.headers,wait:!1,externalRequest:!1};if(c=await ko(e,t,o,r),404===c.status){je(e);const o={...r?.headers,externalRequest:!1};c=await ko(e,t,o,r)}}else{const o={...r?.headers,externalRequest:!1};c=await ko(e,t,o,r)}if(200!==c.status||"fluid/component"!==c.mimeType&&"fluid/object"!==c.mimeType||!c.value){const e=new fe.vU(`Component not found: status=${c.status}, value=${c.value}`,void 0,c.status,c.stack),t={externalRequest:!1,mimeType:c.mimeType};throw a.setResult(!1,t,e),e}const d=c.value;if(a.setResult(!0),s){const t=i?.synthesize({FluidDocumentServiceFactoryProvider:"FluidDocumentServiceFactoryProvider"},void 0);return So(d,e,s,t?.FluidDocumentServiceFactoryProvider,r?.url)}return d}(e,t,r,o,s,a)}catch(S){return function(e){(0,c.WN)(h),u.setResult(!1,void 0,e)}(S),Promise.reject(S)}const m=g.ComponentTelemetryMetadata,f=m?.entityName,v=void 0===g.IFluidLoadable?.handle?void 0:Eo(g.IFluidLoadable.handle).absolutePath,y=(0,c.xl)(h,!0),b=(0,c.xl)(i);if(u.setResult(!0,{...n,componentType:f,componentUrl:v,documentEverHidden:b>-1,documentHidden:y>-1}),s&&function(e,t,r){void 0===r||r<=0?je(e):Promise.race([(0,we.c)(r),t]).then(()=>{setTimeout(()=>{je(e)},50)}).catch(()=>{})}(e,void 0,0),d){const t=a?.synthesize({FluidDocumentServiceFactoryProvider:"FluidDocumentServiceFactoryProvider"},void 0);return So(g,e,d,t?.FluidDocumentServiceFactoryProvider,r?.url)}return g}var Io=r(92756),Do=r(16135),Fo=r(52841),Bo=r(82963);const Lo="@ms/office-fluid-container",xo="@ms/onenote-meetings",Ao="@ms/whiteboard-container",Oo="@fluidx/loop-page-container",Mo="@fluidx/copilot-board-container";var _o=r(74411),Ro=r(93537),Ho=r(37805),Uo=r(75812);const jo={maxRetries:3,filter:(0,Ro.sC)([429,503,709,710]),backoffFn:(0,Ho.Ed)(500)};function qo(e,t){return t?(0,Uo.R)(e,{method:"GET"},t.eventName,t.logger,t.doNotLogOnSuccess,jo,t.timeoutMs??0,t.getAdditionalProps):(0,Ro.J5)(e,{method:"GET"},jo)}var zo=r(69649);const Vo="codeLoaderStorage";function $o(){return(0,zo.P2)("fluidCodeLoaderCache",1,{async upgrade(e,t){e.createObjectStore(Vo).createIndex("lastUpdatedTime","lastUpdatedTime")},blocked:()=>{throw new Error("Could not open code loader cache DB since it is blocked by an older client that has the DB open")}})}function Go(e){return`${e.packageName}_${e.ring}`}function Wo(e,t){if(t.length>0&&"string"===typeof t[0]){const r=e.find(e=>!function(e,t){const r=new URL(e);return t.includes(r.origin)}(e,t));return void 0===r}return Jo(e,t)}function Jo(e,t){const r=function(e){const t=new Map;for(const r of e)for(const e of r.origin)if(void 0===r.paths)t.set(e,"ALL");else{const o=t.get(e);"ALL"===o||(void 0===o?t.set(e,r.paths.map(Ko)):t.set(e,o.concat(r.paths.map(Ko))))}return t}(t);return e.every(e=>{const t=new URL(e);if(t.pathname!==decodeURIComponent(t.pathname))return!1;const o=r.get(t.origin);if("ALL"===o)return!0;if(void 0===o)return!1;{const e=Ko(t.pathname);return o.some(t=>t.every((t,r)=>t===e[r]))}})}function Ko(e){return e.split("/").filter(e=>""!==e)}async function Qo(e,t,r){try{const r=await $o();await r.delete(Vo,Go({packageName:e,ring:t})),r.close()}catch(o){r&&(0,m.hO)(r,{eventName:"DeleteContainerDetailsFromCacheFailed",message:"DeleteContainerDetailsFromCache failed to delete container details from cache"},o)}}let Yo=24192e5;async function Zo(e,t,r,o,n){try{const i=await $o(),s=await i.get(Vo,Go({packageName:e,ring:t}));if(i.close(),s){const i=Date.now()-s.lastUpdatedTime;return i>Yo?{metadata:{cacheStatus:"expired",cacheAge:i},codeDetailsPackage:void 0}:Wo(o(s.codeDetailsPackage),r)?{metadata:{cacheStatus:"hit",cacheAge:i},codeDetailsPackage:s.codeDetailsPackage}:(Qo(e,t,n).catch(()=>{}),{metadata:{cacheStatus:"unsafe"},codeDetailsPackage:void 0})}}catch(i){n&&(0,m.hO)(n,{eventName:"GetCodeDetailsPackageFromCacheFailed",message:"GetCodeDetailsPackageFromCacheFailed failed return response"},i)}return{metadata:{cacheStatus:"miss"},codeDetailsPackage:void 0}}function Xo(e,t,r,o,n){const{getLatestContainerCodeDetails:i,upgradeNeeded:s,preCacheContainerCode:a}=r,d=r=>function(e,t,r,o,n,i,s,a,c){const d=o(r),l=d.then(async o=>{const s=await $o(),c=Go({packageName:t,ring:r}),d=await s.get(Vo,c);d&&d.codeDetailsPackage.version===i(o).version||n(e,o,a),await s.put(Vo,{codeDetailsPackage:i(o),lastUpdatedTime:Date.now()},c),s.close()}).catch(e=>{c&&(0,m.hO)(c,{eventName:"CodeDetailsFromNetworkAndUpdateCacheFailed",message:`Failed to update cache and return code details for ${t}`},e)});return{codePackagePromise:d.then(e=>{const t=s?s(e):void 0;return{...i(e),maxUnsupportedVersion:t}}),cacheUpdatePromise:l}}(e,t,r,i,a,e=>e.fluidCodeDetailsOverride.package,e=>e.maxUnsupportedContainerScriptVersion,n,o);return{getCodeDetailsPackage:(e,r)=>async function(e,t,r,o,n,i){const s=(0,c.yb)(),a=p.m.start("GetCodeDetailsPackage",i,{addUserTiming:!0}),d=Zo(e,t,r,n,i).then(e=>({method:"cache",cacheDetails:e})),l=o(t,r).then(e=>({method:"network",codeDetails:e})),u=await Promise.race([d,l]);let h={documentEverHidden:(0,c.xl)(s,!0)>-1,deploymentRing:t};if("cache"===u.method){const{cacheDetails:e}=u;if(h={...h,...e.metadata},e.codeDetailsPackage)return a.setResult(!0,{method:"cache",...h,packageVersion:e.codeDetailsPackage.version}),e.codeDetailsPackage}return l.then(e=>(a.setResult(!0,{method:"network",...h,packageVersion:e.codeDetails.version}),e.codeDetails))}(t,e,r,e=>d(e).codePackagePromise,e=>e.fluid.browser.umd.files,o),upgradeNeeded:async(e,r)=>{if(!s)return!1;const n=await s(e,r);return n&&(await Qo(t,e,o),d(e)),n},preCacheLatestContainerCode:async e=>await d(e).cacheUpdatePromise}}function en(e,t,r){const o=e.document,n=o.createDocumentFragment();t.forEach(e=>{const t=o.createElement("link");t.rel="prefetch",t.href=e,e.endsWith(".js")?(t.as="script",t.crossOrigin="anonymous",n.appendChild(t)):e.endsWith(".css")?(t.as="style",n.appendChild(t)):r&&(0,m.hO)(r,{eventName:"FluidXPrefetchAssetFailed",message:`Unsupported asset type for prefetching: ${e}`})}),o.head.appendChild(n)}function tn(e,t,r,o){const n=t.preload.manifest,i=[...n.assets];if(n.localizedAssets){const e=(0,be.rv)(r),t=n.localizedAssets[e];t&&i.push(...t)}en(e,i.map(e=>`${t.preload.jsBaseUrl}/${e}`),o)}async function rn(e,t){const r=t?{logger:t,eventName:"GetCodeLoadDetailsFromNetwork",doNotLogOnSuccess:!0}:void 0,o=await qo(e,r);if(o.result.ok)return o.result.json();throw new Error(`getCodeLoadDetailsFromNetwork: Failed to fetch: ${e}; StatusCode: ${o.result.status}`)}function on(e){return!isNaN(e)&&isFinite(e)}function nn(e,t,r){const o=parseFloat(e);if(!on(o))return!1;const n=parseFloat(t);return!!on(n)&&(o<=n||function(e){try{return JSON.parse(e)}catch(t){return[]}}(r).includes(o))}const sn=(e,t,r,o,n)=>Xo(e,t,{getLatestContainerCodeDetails:r,preCacheContainerCode:tn,upgradeNeeded:async(e,t)=>{try{const o=await r(e);return nn(t,o.maxUnsupportedContainerScriptVersion,o.unsupportedContainerScriptVersions)}catch{return!1}}},o,n),an={Automation:"https://whiteboard.office.com",Development:"https://dev.whiteboard.microsoft.com",Dogfood:"https://whiteboard.office.com",DoD:"https://whiteboard.apps.mil",GCC:"https://whiteboard.office.com","GCC-High":"https://whiteboard.office365.us",Local:"https://whiteboard.office.com",Microsoft:"https://whiteboard.office.com",Preview:"https://whiteboard.office.com",Production:"https://whiteboard.office.com",Staging:"https://app.int.whiteboard.microsoft.com",SyntheticTraffic:"https://whiteboard.office.com",USNat:"https://whiteboard.eaglex.ic.gov",USSec:"https://whiteboard.microsoft.scloud",Gallatin:"",Bleu:"",Delos:""};const cn=(e,t,r,o)=>sn(e,Lo,e=>async function(e,t,r){return rn(r?`${(0,_o.V)(e)}/container/versionless/_1cdn_bucketedcontent/officeContainerCodeLoadDetails.json`:`${(0,_o.o)(e)}/container/versionless/officeContainerCodeLoadDetails.json`,t)}(e,t,o),t,r);const dn=(e,t,r)=>sn(e,Oo,e=>async function(e,t){return rn(`${(0,_o.o)(e)}/loop-page-container/versionless/loopPageContainerCodeLoadDetails.json`,t)}(e,t),t,r),ln=(e,t,r)=>sn(e,Mo,e=>async function(e,t){const r=function(e){switch(e){case"Staging":case"Development":return"Staging";case"Gcc":case"GccHigh":case"DoD":case"Gallatin":case"Bleu":case"Delos":case"USNat":case"USSec":return e;default:return"Dogfood"}}(e);return rn(`${(0,_o.o)(r)}/copilot-board-container/versionless/copilotBoardContainerCodeLoadDetails.json`,t)}(e,t),t,r),un=e=>{const t=(0,Do.mo)(e??"Prod");return r=t.audience,an[r];var r},hn=e=>"object"===typeof e&&"string"===typeof e?.name&&"object"===typeof e?.fluid,gn=e=>hn(e)&&"string"===typeof e?.fluid?.browser?.umd?.library&&Array.isArray(e?.fluid?.browser?.umd?.files);var pn=r(32896);const mn=e=>{switch(e){case xo:case Lo:case"@msstream/experiences-fluid-embed":case"@office-start/space-container":case Ao:case Oo:case Mo:return e;default:return"(redacted)"}},fn="NPM",vn="CDN";function yn(e,t){return new Promise((r,o)=>{const n=e.document,i=n.createElement("link");return i.rel="stylesheet",i.type="text/css",i.href=t,i.onload=()=>{r()},i.onerror=()=>o(new Error(`Failed to download the style sheet at url: ${t}, isUserDefinitelyOffline: ${!e.navigator.onLine}`)),n.head.appendChild(i),i})}let bn=new WeakMap;const Sn=e=>"string"===typeof e.package?e.package:e.package.name,Cn="0.0.1",kn=e=>!Number.isNaN(e)&&Number.isFinite(e),wn=e=>{return"string"!==typeof e.package&&(t=e.package,gn(t)&&(t.version===Cn||kn(Number(t.version))))?{name:e.package.name,version:e.package.version===Cn?Cn:Number(e.package.version)}:void 0;var t};class Pn{get IRuntimeFactory(){return this}constructor(e,t){this.wrappedFactory=e,this.config=t}instantiateRuntime(e,t){return this.wrappedFactory.configure(this.config),this.wrappedFactory.instantiateRuntime(e,t)}}class Tn{get IFluidCodeDetailsComparer(){return this}tryFormActualCodeDetailsMapKey(e){const t=wn(e);if(void 0!==t)return`${t.version}|${t.name}`}getActualCodeDetails(e){const t=this.tryFormActualCodeDetailsMapKey(e);return void 0===t?void 0:this.actualCodeDetailsMap.get(t)}constructor(e){this.config=e,this.actualCodeDetailsMap=new Map,this.logger=e.logger}async load(e){const t=Sn(e),r=e.config,o=p.m.start("SimpleCodeLoaderLoad",this.logger,{addUserTiming:!0});try{const{windowContext:n,getBundledPackageFactoryOverride:i,disableCdnCodeLoadingFallback:s}=this.config;let a=s?void 0:bn.get(n);const c=a?.get(t);if(void 0!==c){const t=await c,n=t.fluidExport.ConfigurableRuntimeFactory,i=void 0!==n?{module:{fluidExport:new Pn(n,r)},details:e}:{module:t,details:e};return o.setResult(!0,{source:"InMemoryCache"}),i}let d=i?.(t);const l=d?"Bundled":"CDN";if(d)d.then(e=>{const r=e.fluidExport,o=r.CodeVersionDetailsProvider?.codeVersionDetails?.version;En(this.logger,{packageName:t,deliveryType:fn,codeVersion:o})}).catch(()=>{this.logger&&(0,m.hO)(this.logger,{eventName:"NpmCodeLoaderOverrideFailed",packageName:mn(t)})});else{if(s)throw new Error(`CDN code loading fallback set to false but no factory provided by host for container named ${mn(t)}`);this.logger&&(0,m.Ot)(this.logger,{eventName:"CodeLoaderFallbackToCDN",containerType:mn(t)}),d=this.loadInternal(e,this.logger)}s||(a||(a=new Map,bn.set(n,a),n!==window&&n.addEventListener("pagehide",e=>{e.persisted||bn.delete(n)})),a.set(t,d),d.catch(()=>a?.delete(t)));const u=await d,h=u.fluidExport.ConfigurableRuntimeFactory,g=void 0!==h?{module:{fluidExport:new Pn(h,r)},details:e}:{module:u,details:e};return o.setResult(!0,{source:l}),g}catch(n){throw o.setResult(!1,void 0,n),n}}async loadInternal(e,t){const{windowContext:r,trustedTypesPolicy:o,getFluidCodeVersionDetails:n}=this.config;let i;i="allowedCodeOrigins"in this.config?this.config.allowedCodeOrigins:this.config.allowedCodeSources.flatMap(e=>e.origin);const s=await this.getEffectiveFluidCodeDetailsPackage(e);if(En(t,{packageName:Sn(e),deliveryType:vn,codeVersion:s.version}),void 0===s)throw new Error(`Failed to get Fluid Package. Trying to load ContainerType: ${mn(e.package.name)}`);const a=s.fluid.browser.umd;if(!this.shouldLoad(a.files))throw new Error("Unsupported container files, check that CDN is on allow list");const c=this.tryFormActualCodeDetailsMapKey(e);if(void 0!==c&&"string"!==typeof e.package){const t={...e,package:{...e.package,...s}};this.actualCodeDetailsMap.set(c,t)}const d=o&&{trustedTypesPolicy:await o,allowedOrigins:i};await Promise.all(a.files.map(e=>{const t=e.toLowerCase();if(t.endsWith(".js"))return(0,pn.a)(r,e,d,"high");if(t.endsWith(".css"))return((e,t)=>{let r=3;return function o(){return yn(e,t).catch(()=>(r-=1,0===r?yn(e,t):o()))}()})(r,e);throw new Error(`Codeloader does not know how to load: ${e}`)}));const l=r[a.library];if(void 0===l)throw new Error(`Entry point of loaded package not a Fluid module. Trying to load ContainerType: ${mn(e.package.name)}`);const{CodeVersionDetailsProvider:u}=l.fluidExport;if(u){const e=n?.(s);e&&u.setCodeVersionDetails(e)}return l}async preCache(e){const{getFluidCodeDetailsPackageOverride:t,windowContext:r}=this.config;if(t){const o=await t(e);if(o){const e=o.fluid.browser.umd;if(!this.shouldLoad(e.files))throw new Error("Unsupported container files, check that CDN is on allow list");en(r,e.files,this.logger)}}}async getEffectiveFluidCodeDetailsPackage(e){const t="string"===typeof e.package?e.package:e.package.name,r=await(this.config.getFluidCodeDetailsPackageOverride?.(t))||e.package;if("string"===typeof r)throw new Error("Codeloader does not know how to load from this source");return function(e){if(!gn(e)||void 0===e.version)throw new Error("Codeloader does not know how to load from this source")}(r),r}shouldLoad(e){return"allowedCodeOrigins"in this.config?Wo(e,this.config.allowedCodeOrigins):Jo(e,this.config.allowedCodeSources)}async satisfies(e,t){const r=this.getActualCodeDetails(e);if(void 0===r)return!0;if("string"===typeof t.package||"string"===typeof r.package)return!0;const o=(e=>{const t=Number(e.maxUnsupportedVersion);return kn(t)?t:void 0})(t.package);if(void 0!==o){const e=wn(r)?.version;if(void 0!==e)return e===Cn||e>o}return!0}async compare(e,t){const r=wn(e);if(void 0===r)return;const o=wn(t);return void 0!==o&&r.name===o.name?r.version===o.version?0:r.version===Cn?-1:o.version===Cn?1:r.version-o.version:void 0}}function En(e,t){let{packageName:r,deliveryType:o,codeVersion:n}=t;if(!e)return;const i={eventName:"FluidCodeDetails",subCategory:"FluidCodeDetails",containerType:mn(r),deliveryType:o};n&&(i.codeVersion=n),(0,m.Ot)(e,i)}function Nn(e){const t=(0,Fo.Ar)()?.AllowListOverride;return t?(e&&(0,m.Ot)(e,{eventName:"CodeLoaderAllowListOverwritten",subCategory:"LocalStorageOverride"}),JSON.parse(t)):[]}class In{get IFluidCodeDetailsComparer(){return this.simpleCodeLoader}getActualCodeDetails(e){return this.simpleCodeLoader.getActualCodeDetails(e)}constructor(e){this.config=e;const t=e.additionalAllowedCodeOrigins??[],{windowContext:r,logger:o,localeHint:n,sdpEnabled:i}=this.config,s=o?.NamespaceLogger?new a.p("OfficeWebHost",o.NamespaceLogger):o;this.settingsProvider=e.settingsProvider;const c=cn(r,s,n,i),d=dn(r,s,n),l=ln(r,s,n),u={getCodeDetailsPackage:e=>{const t=un(e),r={name:Ao,version:"0.0.1",fluid:{browser:{umd:{files:[`${t}/root/index.fluid.js`],library:"microsoftWhiteboard"}}}};return Promise.resolve(r)}};this.containerCodeDetailsProviderMap=new Map([[Lo,c],[xo,c],[Oo,d],[Mo,l],[Ao,u]]),e.additionalCodeDetailsProviders?.forEach(e=>{let[t,r]=e;return this.containerCodeDetailsProviderMap.set(t,r)});const h=[...Nn(s),...t],g=[...(0,Bo.M)(this.config.containerEnvironment,this.settingsProvider),{origin:h,paths:void 0}],p={windowContext:e.windowContext,trustedTypesPolicy:e.trustedTypesPolicy,logger:s,getBundledPackageFactoryOverride:t=>{const r=e.locallyBundledPackageFactories?.get(t);return r?Promise.resolve(r):void 0},disableCdnCodeLoadingFallback:e.disableCdnCodeLoadingFallback,getFluidCodeDetailsPackageOverride:async t=>{const r=this.containerCodeDetailsProviderMap.get(t);if(r)return r.getCodeDetailsPackage(e.containerEnvironment,g)},getFluidCodeVersionDetails:t=>{const{containerEnvironment:r}=e,o=t.version,n=this.containerCodeDetailsProviderMap.get(t.name)?.upgradeNeeded;return{version:o,containerEnvironment:r||"Local",needUpgrade:n?()=>n(r,o):async()=>!1}}};this.simpleCodeLoader=new Tn({...p,allowedCodeSources:g})}async preCache(e){if(this.config.locallyBundledPackageFactories?.has(e))return;const t=this.containerCodeDetailsProviderMap.get(e);return t?.preCacheLatestContainerCode?t.preCacheLatestContainerCode(this.config.containerEnvironment):this.simpleCodeLoader.preCache(e)}async load(e){return this.simpleCodeLoader.load(e)}}class Dn{constructor(e){this.bohemiaConfig=e,this.instantiateFluidCodeLoader=async e=>{const t=e.dependencySynthesizer.synthesize({LoopTrustedTypesPolicy:"LoopTrustedTypesPolicy",NamespaceLogger:"NamespaceLogger",SettingsProvider:"SettingsProvider"},void 0),[r,o,n]=await Promise.all([t.LoopTrustedTypesPolicy,t.SettingsProvider,t.NamespaceLogger]);return new In({...this.bohemiaConfig,windowContext:e.windowContext,trustedTypesPolicy:r,settingsProvider:o,logger:n})}}get FluidCodeLoaderFactory(){return this}get Disposable(){return this}dispose(){}}var Fn=r(48680);class Bn{getRawConfig(e){const t=(0,Fn.AU)(e,null,this.settingsProvider);return null===t?void 0:t}constructor(e){this.settingsProvider=e}}var Ln=r(72376);async function xn(e,t){let r;const o=p.m.start(l.A8,t),n=new URL(e);try{const e=await(0,Uo.R)(`${n}`,{method:"GET"},"ContainerManifestFetch",t,!1,Ln._9,3e3);if(!e.result.ok)throw new Error(`Component manifest fetch returned an error response. status: ${e.result.status}: ${e.result.statusText}.`);r=await e.result.json()}catch(i){return void o.setResult(!1,{errorType:l.ps},i,{sampleEvent:!0})}return o.setResult(!0,void 0,void 0,{sampleEvent:!0}),r}const An="manifest",On="json";function Mn(e,t,r){const o=(0,Do.Rs)(e);if(r){const e="string"===typeof r?r:function(e,t){const r="http://localhost:8081",o="Staging"===e?"stg":"Dogfood"===e?"df":"prod";return`${r}/${o}/${An}.${t}.${On}`}(o,t);return e}const n=(0,_o.o)("Development"===o?"Staging":o);return`${n}/generic-loader/versionless/${An}.${t}.${On}`}async function _n(e,t){const r=t?{logger:t,eventName:"GetLoopComponentsManifestFromNetwork",doNotLogOnSuccess:!1}:void 0;return(await qo(e,r)).result}const Rn="LoadManifestFromCache",Hn="LoadManifestFromNetwork",Un="DownloadGLManifestError",jn="glManifest";function qn(e,t,r,o,n){return async function(e,t,r){let o,n;r.markSubActivityStart(Rn);try{o=await caches.open(jn),n=await o.match(e)}catch(i){r.markSubActivityEnd(Rn),r.addAdditionalProps({cacheError:zn(i)})}if(n?.ok){const i=await n.text();return r.markSubActivityEnd(Rn),_n(e,t).then(t=>t.ok?o?.put(e,t):void 0).catch(e=>{(0,m.hO)(t,{eventName:Un,isBackground:!0},e)}),[i,!0]}if(r.markSubActivityEnd(Rn),r.markSubActivityStart(Hn),n=await _n(e,t),r.markSubActivityEnd(Hn),n.ok){o?.put(e,n.clone()).catch(()=>{});return[await n.text(),!1]}throw new Error(`Failed to fetch manifest. Status code ${n.status}`)}(Mn(e,t,n),r,o)}function zn(e){return"string"===typeof e?e:e instanceof Error?e.message:e&&"object"===typeof e?e.toString():void 0}async function Vn(e,t,r){const o=r&&new a.p(l.Ak,r),n=p.m.start("GetContainerManifestEntries",o),i=(0,be.Zd)(e)?(0,be.rv)(e):be.q;try{const[e,r]=await qn(t??{audience:"Production"},i,o??new $n,n),s=function(e){return JSON.parse(e,(e,t)=>{if("urlRegexes"===e||"pathAndQueryParamRegexes"===e){if(Array.isArray(t))return t.map(e=>new RegExp(e));throw new Error(`Invalid value for urlRegexes: "${t}"`)}return t})}(e),a=function(e,t){const r="@ms/office-fluid-container",o=e.components.find(e=>e.registrationId===r);if(!o)return t&&(0,m.hO)(t,{eventName:"LpcRegistrationNotFound"}),[];const{createEntries:n,fluidCodeDetails:i}=o;if(!n)return t&&(0,m.hO)(t,{eventName:"LpcCreateEntriesNotFound"}),[];if(!i)return t&&(0,m.hO)(t,{eventName:"LpcFluidCodeDetailsNotFound"}),[];return n.map(e=>{const{displayName:t,description:r,keywords:o,icons:n,id:s,creationData:a}=e;return{codeDetails:{package:i,config:a},queryableData:{id:s,displayName:t,description:r,keywords:o??[],icon:n.default}}})}(s,o);return n.setResult(!0,{fromCache:r}),a}catch(s){throw n.setResult(!1,void 0,s),s}}class $n{get NamespaceLogger(){return this}send(){}sendWithNamespace(){}dispose(){}}const Gn="{locale}",Wn=[{genericUrl:"/officeContainerManifest.json",localizableUrl:`/officeContainerManifest.${Gn}.json`}];async function Jn(e,t,r,o,n){const i=r&&new a.p(l.Ak,r);if(o)return Vn(e,t,i);const s=await async function(e,t,r,o){const n=(0,be.Zd)(e)?(0,be.rv)(e):void 0,i=(0,Do.Rs)(t);return Promise.all(Wn.map(async e=>{const t="SDP"===o?(0,_o.V)(i)+"container/versionless/_1cdn_bucketedcontent/":(0,_o.o)(i)+"/container/versionless",s=t+e.genericUrl,a=t+e.localizableUrl;if(void 0!==n&&a){const e=await xn(a.replace(Gn,n),r);if(void 0!==e)return e}return xn(s,r)}))}(e,t,i,n);return function(e){const t=[];return e.forEach(e=>{if(void 0!==e){const r=e.fluidCodeDetailsPackage;e.configurations.forEach(e=>t.push({codeDetails:{package:r,config:e.config},queryableData:e.queryableData,heroConfiguration:e.heroConfiguration}))}}),t}(s)}const Kn=e=>"object"===typeof e&&"string"===typeof e?.name&&"object"===typeof e?.fluid;function Qn(e){if("string"!==typeof e.package&&Kn(e.package))return e.package.name}var Yn=r(78945),Zn=r(15851);const Xn="function"===typeof FinalizationRegistry;class ei{constructor(e,t,r,o){this.loggingDelay=e,this.subcategory=r,this.trackedObjectsGcTime=new Map,this.trackedObjects=new Set,Xn?(this.logger=new a.p("MemoryLeakTracker",t,o),this.finalizationRegistry=new FinalizationRegistry(e=>{this.trackedObjectsGcTime.set(e,globalThis.performance.now()),this.trackedObjectsGcTime.size===this.trackedObjects.size&&this.closeAndSendTelemetry()})):this.isDisposed=!0}get Disposable(){return this}dispose(){this.isDisposed=!0,this.loggingTimeout&&clearTimeout(this.loggingTimeout),this.logger?.Disposable.dispose(),this.logger=void 0}trackObject(e,t){this.isDisposed||(this.trackedObjects.add(e),this.finalizationRegistry?.register(t,e))}markParentAsClosed(){this.isDisposed||(this.parentClosedTime=globalThis.performance.now(),this.loggingTimeout=setTimeout(()=>this.closeAndSendTelemetry(),this.loggingDelay))}closeAndSendTelemetry(){const e={};for(const r of this.trackedObjects){const t=this.trackedObjectsGcTime.get(r);e[r]="number"===typeof t&&(!this.parentClosedTime||t-this.parentClosedTime)}const t=this.trackedObjects.size>0?this.trackedObjectsGcTime.size>0&&(!this.parentClosedTime||Math.max(...this.trackedObjectsGcTime.values())-this.parentClosedTime):void 0;this.logger?.send({category:Zn.hB.Generic,subCategory:this.subcategory,eventName:"MemoryCleanup",gcTimes:JSON.stringify(e),finalObjectGcTime:t,loggingDelay:this.loggingDelay}),this.Disposable.dispose()}}var ti=r(14818);function ri(e){return e?Object.keys(e).sort().join(","):""}class oi{constructor(){this.providers=new Map,this.memo=new Map,this.resolveLocalProvider=e=>{const t=this.providers.get(e);if(t)return"function"===typeof t?{get:()=>{if("function"===typeof t)return Promise.resolve(this.IFluidDependencySynthesizer).then(async e=>t(e)).then(t=>t?.[e])}}:{get:()=>new Yn.I(async()=>Promise.resolve(t).then(t=>{if(t)return t[e]}))}};for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.parents=t.filter(e=>void 0!==e)}get IFluidDependencySynthesizer(){return this}register(e,t){if(this.providers.has(e))throw new Error(`Attempting to register a provider of type ${String(e)} that already exists`);this.clearMemo(),this.providers.set(e,t)}unregister(e){this.providers.has(e)&&(this.providers.delete(e),this.clearMemo())}clearMemo(){this.memo.clear()}synthesize(e,t){const r=`required:${ri(t)},optional:${ri(e)}`;if(this.memo.has(r))return this.memo.get(r);const o={};return this.generateRequired(o,t),this.generateOptional(o,e),Object.defineProperty(o,ti.x,{get:()=>this}),this.memo.set(r,o),o}has(e,t){return!!this.providers.has(e)||!0!==t&&this.parents.some(t=>t.has(e))}generateRequired(e,t){if(void 0===t)return;const r=this.generate(e,t);if(0!==r.size){const e=Array.from(r).join(", ");throw new Error(`Object attempted to be created without registered required providers ${e}`)}}generateOptional(e,t){if(void 0===t)return;const r=this.generate(e,t);for(const o of r){const t={get:async()=>{}};Object.defineProperty(e,o,t)}}generate(e,t){const r=new Set(Object.keys(t));for(const o of r){const t=this.resolveLocalProvider(o);t&&(r.delete(o),Object.defineProperty(e,o,t))}for(const o of this.parents){const t={};for(const e of r)t[e]=e;const n=o.synthesize(t,void 0);for(const o of r){const t=Object.getOwnPropertyDescriptor(n,o);t&&(r.delete(o),Object.defineProperty(e,o,t))}}return r}}class ni{constructor(e,t){this.synthDependencies=new Map,this.dependencySynthesizer=new oi(e);const r=e?.synthesize({NamespaceLogger:"NamespaceLogger"},void 0);r?.NamespaceLogger?.then(e=>{e&&(this.memoryLeakTracker=new ei(t?.memoryLeakDetectionWaitTime??3e5,e,"LoopDependencyContainer"))}).catch(()=>{})}get IFluidDependencySynthesizer(){return this}register(e,t){let r;this.dependencySynthesizer.has("DataConnector")&&(r=this.dependencySynthesizer.synthesize({DataConnector:"DataConnector"},void 0)),this.dependencySynthesizer.register(e,new Yn.I(async()=>{const o=await Promise.resolve(t);if("DataConnector"!==e){const e=await(r?.DataConnector);e?.addComponentTracking(o)}return this.synthDependencies.set(e,o),this.memoryLeakTracker?.trackObject(e,o),o}))}registerIfNotAlreadyExists(e,t){this.dependencySynthesizer.has(e)||this.register(e,t)}synthesize(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.dependencySynthesizer.synthesize(e,t)}has(e){return this.dependencySynthesizer.has(e)}unregister(e){return this.dependencySynthesizer.unregister(e)}dispose(){for(const[e,t]of this.synthDependencies)t.Disposable.dispose(),this.unregister(e);this.synthDependencies.clear(),this.memoryLeakTracker?.markParentAsClosed()}}function ii(e,t){if(!t)return;const r=e?mn(e):"Unknown",o={};o.containerCodeDetailsName=r,t.PersistedProperties?.addPersistedProperties(o)}const si="FluidCodeLoaderFactory";function ai(e,t){(async()=>{const r=function(e){if(void 0!==e.getSpecifiedCodeDetails)return e.getSpecifiedCodeDetails();const t=e.getQuorum();return t.getMember("code")??t.getMember("code2")}(e);if(r){const o=t.getActualCodeDetails?.(r);if(o&&t.IFluidCodeDetailsComparer){const n=await t.IFluidCodeDetailsComparer.compare(r,o);void 0!==n&&n<0&&await e.proposeCodeDetails(o)}}})().catch(()=>{})}function ci(){const e=(0,Fo.Ar)()?.FluidCodeDetailsOverride;if(void 0!==e)return JSON.parse(e)}async function di(e,t,r,o,n,i,s,c){const d=new ni(n);s&&!d.has("NamespaceLogger")&&d.register("NamespaceLogger",new a.p(l.BN,s));const u={SettingsProvider:"SettingsProvider",FluidCodeLoaderFactory:si},h=d.synthesize(u,void 0);let[g,f]=await Promise.all([h.SettingsProvider,h.FluidCodeLoaderFactory]);if(!f){const e=await async function(e){let{hostConfig:t,dependencySynthesizer:r}=e;const o=r.synthesize({SettingsProvider:"SettingsProvider",InternationalizationContext:"InternationalizationContext"},void 0),[n,i]=await Promise.all([o.SettingsProvider,o.InternationalizationContext]),s=(0,Do.H9)(t.environment,n?.audience),a=i?.uiLocale||be.q;return new Dn({containerEnvironment:s,localeHint:a})}({hostConfig:r,dependencySynthesizer:d});d.registerIfNotAlreadyExists(si,e),f=e}const v=await f.instantiateFluidCodeLoader({windowContext:e,dependencySynthesizer:d});let y,b;if("Existing"===t.type&&(y=t.containerCodeHint),y){if(s&&(0,m.Ot)(s,{eventName:l.Ug}),void 0===r.loadCodeFromHint||r.loadCodeFromHint){const e=p.m.start(l.Qn,s,{addUserTiming:!0});v.load({package:y}).then(()=>{e.setResult(!0)}).catch(t=>{e.setResult(!1,void 0,t)})}(function(e){return"preCache"in e&&!!e.preCache})(v)&&(c?.addAdditionalProps({precachedContainerPackageName:mn(y)}),v.preCache(y).catch(e=>{s&&(0,m.hO)(s,{eventName:l.TK},e)}))}g&&(b=new Bn(g));const S={urlResolver:await o.urlResolver,documentServiceFactory:await o.documentServiceFactory,options:r.loaderOptions,scope:{IFluidDependencySynthesizer:d},codeLoader:v,logger:i,configProvider:b};return new ro(S)}async function li(e,t,r,o,n){const i={[Io.d.loadMode]:{opsBeforeReturn:"cached",deltaConnection:r.startContainerInPausedState?"none":"delayed"}};let s,a;const c=e.services.codeLoader;switch(t.type){case"Existing":{const o=t.containerRequest,n={url:o.url,headers:{...i,...o.headers}};a=t.containerCodeHint,s=e.resolve(n,r.pendingLocalState);break}case"DetachedFromCode":{const r=ci()||t.codeDetails;a=Qn(r),s=e.createDetachedContainer(r);break}case"DetachedFromSnapshot":s=e.rehydrateDetachedContainerFromSnapshot(t.snapshot);break;default:throw new Error("loadContainerProps type is invalid")}return ii(a,n),s.then(async e=>{!0===r.closeBeforeDisposing&&e.once("closed",t=>e.dispose(t)),r.startContainerInPausedState||je(e);const i=e.getSpecifiedCodeDetails(),s=i&&Qn(i);if("DetachedFromSnapshot"===t.type&&ii(s,n),o?.addAdditionalProps({containerPackageMatchedCodeHint:a===s}),e.deltaManager.active)ai(e,c);else{const t=()=>{e.deltaManager.active&&(ai(e,c),e.off("connected",t))};e.on("connected",t)}}).catch(()=>{}),s}const ui="ContainerLoadFailed",hi="ComponentLoadFailedOnContainerBoot";class gi extends Error{constructor(){super("The container could not be loaded because its hosting window has already been unloaded."),this.name=l._H,this.errorType=l._H}}function pi(e){switch(e){case"Automation":return 0;case"Local":return 1;case"Staging":return 2;case"Dogfood":return 3;case"Preview":return 4;case"Microsoft":case"SyntheticTraffic":return 5;case"Production":return 6;case"GCC":return 7;case"GCC-High":case"DoD":return 8;default:return}}const mi=e=>(0,Fn.AU)("owh.handleLocationRedirection",!0,e),fi=e=>{const t=function(e,t){const r=pi(e),o=pi(t??"Production");return void 0!==r&&void 0!==o&&o<=r}("Automation",e?.audience);return(0,Fn.AU)("useNestedDependencyContainer",t,e)};var vi=r(83397);class yi{constructor(e,t){this.settingsProvider=t,this.defaultIntervalInMin=60,this.heartbeatSendTimerId=void 0,this.heartbeatIntervalMs=60*this.defaultIntervalInMin*1e3,this.onUserActivityStateChanged=e=>{e?this.resume():this.stop()},this.stop=()=>{this.clearHeartbeatSendTimer()},this.resume=()=>{this.sendHeartbeatAndReQueue()},this.queueHeartbeat=()=>{this.heartbeatSendTimerId=window.setTimeout(()=>{this.sendHeartbeatAndReQueue()},this.heartbeatIntervalMs)},this.sendHeartbeatAndReQueue=()=>{this.heartbeatLogger&&(0,m.Ot)(this.heartbeatLogger,{eventName:"Heartbeat"}),this.queueHeartbeat()},this.clearHeartbeatSendTimer=()=>{window.clearTimeout(this.heartbeatSendTimerId),this.heartbeatSendTimerId=void 0},this.dispose=()=>{this.stop(),this.userActivityTracker.dispose(),this.heartbeatLogger=void 0},this.heartbeatLogger=new a.p("Heartbeat",e),this.heartbeatIntervalMs=60*(e=>(0,Fn.AU)("owh.HeartbeatIntervalInMin",60,e))(this.settingsProvider)*1e3,this.sendHeartbeatAndReQueue(),this.userActivityTracker=new vi.N(this.heartbeatIntervalMs,this.onUserActivityStateChanged)}}function bi(e){let{windowContextForLoader:t,dependencySynthesizer:r,hostConfig:o,logger:n,perfMetadata:i,documentEverHiddenTrackerID:s,containerRequest:a,driver:c,preCheckInfo:d,requiredProviderTypes:l}=e;Ti(c,o,r);const u={type:"Existing",containerRequest:a,containerCodeHint:d?.codeDetailsHint},{containerPromise:h,componentPromise:g}=c?wi(t,u,c,a,r,o,n,i,s,l,void 0):ki(t,u,a,r,o,n,i,s,l,void 0);return{container:h,component:g}}function Si(e,t,r,o,n,i,s){Ti(r,o,t.dependencySynthesizer);const{componentPromise:a,containerPromise:c}=r?wi(e,{type:"DetachedFromCode",codeDetails:t.codeDetails},r,void 0,t.dependencySynthesizer,o,n,i,s,t.requiredProviderTypes,t.loadTemplateProps):ki(e,{type:"DetachedFromCode",codeDetails:t.codeDetails},void 0,t.dependencySynthesizer,o,n,i,s,t.requiredProviderTypes,t.loadTemplateProps);return{component:a,container:c}}function Ci(e,t,r,o,n,i,s){Ti(r,o,t.dependencySynthesizer);const{componentPromise:a,containerPromise:c}=r?wi(e,{type:"DetachedFromSnapshot",snapshot:t.snapshot},r,void 0,t.dependencySynthesizer,o,n,i,s,t.requiredProviderTypes,void 0):ki(e,{type:"DetachedFromSnapshot",snapshot:t.snapshot},void 0,t.dependencySynthesizer,o,n,i,s,t.requiredProviderTypes,void 0);return{component:a,container:c}}function ki(e,t,r,o,n,i,s,a,d,u){const h=new ye.c,g=new ye.c;return async function(){const e=p.m.start(l.ih,i,{addUserTiming:!0}),t={...s,documentEverHidden:(0,c.xl)(a)>-1},{driverImplementationOverride:r}=n;if(r)return e.setResult(!0,{...t,driverType:"Override"}),r;const{DriverImplementation:d,FluidDocumentServiceFactoryProvider:u,FluidUrlResolverProvider:h}=o.synthesize({DriverImplementation:"DriverImplementation",FluidUrlResolverProvider:"FluidUrlResolverProvider",FluidDocumentServiceFactoryProvider:"FluidDocumentServiceFactoryProvider"},void 0),[g,m,f]=await Promise.all([d,h?.then(e=>e?.urlResolver),u?.then(e=>e?.documentServiceFactory)]);if(g)return e.setResult(!0,{...t,driverType:"SynthesizedLegacy"}),g;if(m&&f)return e.setResult(!0,{...t,driverType:"Synthesized"}),{documentServiceFactory:f,urlResolver:m};const v=new Error("Driver unavailable");throw e.setResult(!1,t,v),v}().then(async c=>{const l=wi(e,t,c,r,o,n,i,s,a,d,u);h.resolve(l.containerPromise),g.resolve(l.componentPromise)}).catch(e=>{h.reject(e),g.reject(e)}),{containerPromise:h,componentPromise:g}}function wi(e,t,r,o,n,i,s,a,d,u,h){const g=a.fluidBootstrapperStartTime,f="Existing"!==t.type&&{createNew:"DetachedFromCode"===t.type?"DetachedContainer":t.type};let v=o;const y=f&&{additionalPropsToLog:f}||void 0,b=n.synthesize({InternationalizationContext:"InternationalizationContext",SettingsProvider:"SettingsProvider"},void 0);Promise.resolve(b.InternationalizationContext).then(e=>{s&&(0,m.Ot)(s,{eventName:"HostLocaleContext",subCategory:"HostLocaleContext",uiLanguage:e?.uiLocale||be.q})}).catch(()=>{});const S=p.m.start(l.bU,s,{addUserTiming:!0,...y});s&&function(e){const t=navigator?.connection;(0,m.Ot)(e,{eventName:"Metadata",subCategory:"browserMetadata",doNotTrack:navigator.doNotTrack?navigator.doNotTrack:"false",documentHidden:document.hidden,networkType:t?.effectiveType,networkRoundTripTime:t?.rtt,cpuCoreCount:navigator.hardwareConcurrency,isMobile:(0,Se.Fr)(),timeStamp:Date.now()})}(s);const C=s&&new Ue(s,a,d),k=p.m.start(l.tR,s,{addUserTiming:!0,additionalPropsToLog:{LoadContainerType:t.type},isAPerformanceMetric:!0}),w=di(e,t,i,r,n,C,s,k),P=Promise.all([w,b.SettingsProvider]).then(e=>{let[r,o]=e;return mi(o)&&"Existing"===t.type?Promise.all([me(async e=>(t.containerRequest=e,v=e,li(r,t,i,k,s)),t.containerRequest,r.services.urlResolver,C),o]):Promise.all([li(r,t,i,k,s),o])}).then(t=>{let[r,o]=t;if(e.closed)throw function(e,t){t&&e.close(),e.dispose()}(r,!0===i.closeBeforeDisposing),new gi;if(!r.closed&&!r.disposed)try{const e=s&&new yi(s,o);r.once("disposed",()=>{e?.dispose()})}catch(n){s&&(0,m.hO)(s,{eventName:"FailedToStartHeartbeat"},Object.assign({errorType:"SettingsProviderFetchFailed"},n))}return r});P.then(e=>{s&&_e(e,s);const t=(0,c.xl)(d),r=k.startTimeSinceEpoch;k.setResult(!0,{...a,offsetFromFluidBootstrapperStartTime:(0,ke.q)(r,g),documentEverHidden:t>-1})}).catch(e=>{k.setResult(!1,{errorType:e.errorType},e),S.setResult(!1,{errorType:e.errorType||ui,isUserImpacting:!0},e),s&&xe(s,l.bU,Pe,Ee,e.errorType||Ne,{},e)});const T=P.then(e=>{if(!e)throw S.setResult(!1),s&&xe(s,l.bU,Pe,Ee,De),new Error("Failed to Load Container");const t=w.then(t=>No(e,t.services.urlResolver,v,s,a,d,i.startContainerInPausedState,n));let r=t;if(h?.fromExistingTemplateUrl){const e=async function(e,t,r,o,n,i){const s=p.m.start(l.F7,o,{addUserTiming:!0});return t.then(async t=>{s.markSubActivityStart("TemplateLoadContainer");const a=await li(t,{type:"Existing",containerRequest:{url:e.fromExistingTemplateUrl,headers:e.loadTemplateRequestHeaders}},r,void 0,o);return s.markSubActivityEnd("TemplateLoadContainer"),await go(a),s.markSubActivityStart("TemplateLoadComponent"),No(a,t.services.urlResolver,{url:e.fromExistingTemplateUrl},o,n,i,r.startContainerInPausedState).then(async e=>{if(s.markSubActivityEnd("TemplateLoadComponent"),!e?.ComponentSerializable)throw new fe.Ej("Component doesn't implement ComponentSerializable",l.ul);try{const t=await e.ComponentSerializable.serialize();return s.setResult(!0),t}catch(t){throw new fe.Ej("Component serialization failed",l.ii,t)}}).finally(()=>{a.dispose()})}).catch(e=>{throw s.setResult(!1,void 0,e),e.name=e.name||l.uT,e})}(h,w,i,s,a,d);r=t.then(t=>{const r=t.ComponentSerializable;if(!r)throw new fe.Ej("Component doesn't implement ComponentSerializable",l.ul);let o;return e.then(async e=>{if(o=p.m.start(l.P,s,{addUserTiming:!0}),void 0===e)throw new Error(l.md);return await r.rehydrate(e),o.setResult(!0),t}).catch(e=>{throw o?.setResult(!1,void 0,e),e})})}return r=r.then(t=>{if(u){const r=n.synthesize({FluidDocumentServiceFactoryProvider:"FluidDocumentServiceFactoryProvider"},void 0);return So(t,e,u,r.FluidDocumentServiceFactoryProvider,v?.url)}return t}),r.then(()=>{S.setResult(!0)}).catch(t=>{let r;t&&"errorType"in t&&"message"in t&&(r=t),e.dispose(r),S.setResult(!1,{errorType:t.errorType||"Error"!==t.name?t.name:hi,isUserImpacting:!0,isExpected:ve(t)},t),s&&xe(s,l.bU,Pe,Ee,t.errorType||t.name||Ne,{},t)}),r});return{containerPromise:P,componentPromise:T}}const Pi=new Error("Invalid configuration for driver. Please provide either a driver or \u0430 driverImplementationOverride.");function Ti(e,t,r){const o=e||t.driverImplementationOverride||function(e){return e.has("DriverImplementation")||["FluidUrlResolverProvider","FluidDocumentServiceFactoryProvider"].every(t=>e.has(t))}(r);if(!o)throw Pi}var Ei=r(11137),Ni=r(25418),Ii=r(50349);async function Di(e,t){if("Data"!==e.type||"URL"!==e.dataType)return;const r=e.data.url,o=await t;if(!o||o instanceof Ei.Y||o instanceof Ni.s)return function(e){const t=(0,Ii.Mh)(e);if(!t)return;let r;try{t?.siteUrl&&(r=new URL(t?.siteUrl).origin)}catch{}return{codeDetailsHint:t?.containerPackageName,criticalBootDomains:r?[r]:void 0}}(r);try{const e=await o.resolve({url:r.href});if("fluid"===e?.type)return{}}catch{}}class Fi{async instantiateLoopComponent(e){const{loopCodeLoader:t,dependencySynthesizer:r}=this.props,{registrationId:o}=e;if(!o)throw new Error("registrationId is required.");const n=await t.load({packageName:o}),i=new ni(r);this.logger&&i.register("NamespaceLogger",this.logger);const s="Data"===e.type?{creationData:e,manifestData:e.manifestData,componentPersistentInputData:e.componentPersistentInputData,storagePartitionKey:e.storagePartitionKey}:"Creation"===e.type?{creationData:{},manifestData:e.manifestData,componentPersistentInputData:e.componentPersistentInputData,storagePartitionKey:e.storagePartitionKey}:e;return n.module.loopExport.instantiateLoopComponent(s,i)}constructor(e){this.props=e,e.logger&&(this.logger=new a.p("LoopLoader",e.logger))}}async function Bi(e){const{loopComponentRouterInput:t,windowContextForLoader:r,dependencySynthesizer:o,config:n,logger:i,loopCodeLoaderFactory:s,requiredProviderTypes:a}=e,c=await async function(e,t,r,o,n){const{environment:i}=e,s=r.synthesize({InternationalizationContext:"InternationalizationContext",SettingsProvider:"SettingsProvider",TokenProvider:"TokenProvider",LoopTrustedTypesPolicy:"LoopTrustedTypesPolicy"},void 0),[a,c,d,l]=await Promise.all([s.InternationalizationContext,s.SettingsProvider,s.TokenProvider,s.LoopTrustedTypesPolicy]),u=a?.uiLocale,h={audience:i?.audience||"Production",localeHint:u||be.q,settingsProvider:c,windowContext:t,trustedTypesPolicy:l,tokenProvider:d,dependencySynthesizer:r,logger:o},g=await n.instantiateLoopCodeLoader(h);return new Fi({loopCodeLoader:g,dependencySynthesizer:r,logger:o})}(n,r,o,i,s),d=await c.instantiateLoopComponent(t);if(a){return So(d,void 0,a,o.synthesize({FluidDocumentServiceFactoryProvider:"FluidDocumentServiceFactoryProvider"},void 0).FluidDocumentServiceFactoryProvider,void 0)}return d}async function Li(e){const{windowContextForLoader:t,loopComponentRouterInput:r,dependencySynthesizer:o,config:n={},logger:i,perfMetadata:s,documentHiddenTrackerId:a,fluidRequestHeaders:c}=e,{registrationId:d,manifestData:l}=r;if(d&&!g(d)){const e={LoopCodeLoaderFactoryProvider:"LoopCodeLoaderFactoryProvider"},{LoopCodeLoaderFactoryProvider:s}=o.synthesize(e,void 0),a=await s,c=await(a?.getLoopCodeLoaderFactory());if(!c)throw new Error("loopCodeLoaderFactory is required for non-fluid components.");return{component:Bi({loopComponentRouterInput:r,windowContextForLoader:t,dependencySynthesizer:o,config:n,logger:i,loopCodeLoaderFactory:c}),container:Promise.resolve(void 0)}}if("Data"===r.type&&"URL"===r.dataType){let e;if(d&&g(d)&&(e=l&&"object"===typeof l?l:void 0),e||(e=await Di(r,async function(e){const{dependencySynthesizer:t,config:r}=e;if(r?.driverImplementationOverride)return r.driverImplementationOverride.urlResolver;const o={DriverImplementation:"DriverImplementation",FluidUrlResolverProvider:"FluidUrlResolverProvider"},{DriverImplementation:n,FluidUrlResolverProvider:i}=t.synthesize(o,void 0),[s,a]=await Promise.all([n,i]);return s?.urlResolver??a?.urlResolver}({dependencySynthesizer:o,config:n}))),!e)throw new Error("Failed to create Fluid component from the provided url.");ii(e.codeDetailsHint,i);return bi({windowContextForLoader:t,dependencySynthesizer:o,hostConfig:n,logger:i,perfMetadata:s,documentEverHiddenTrackerID:a,containerRequest:{url:r.data.url.href,headers:c},driver:void 0,preCheckInfo:e})}throw new Error("Failed to create component.")}function xi(e){const{windowContextForLoader:t,loopComponentRouterInput:r,dependencySynthesizer:o,config:n,logger:i,perfMetadata:s,documentHiddenTrackerId:a,requiredProviderTypes:d}=e,u={...n},h=u.driverImplementationOverride,f=p.m.start(l.m1,i,{addUserTiming:!0});if("Fluid"===r.type){if(i?.PersistedProperties){const e={isFluid:!0};i.PersistedProperties.addPersistedProperties(e)}const e=Qn(r.codeDetails);ii(e,i);try{if(r.pendingLocalState){const n=Ci(t,{dependencySynthesizer:o,snapshot:r.pendingLocalState,requiredProviderTypes:d},h,u,i,s,a);return f.setResult(!0,{packageName:e}),n}const n=Si(t,{dependencySynthesizer:o,codeDetails:r.codeDetails,loadTemplateProps:r.templateProps,requiredProviderTypes:d},h,u,i,s,a);return f.setResult(!0,{packageName:e}),n}catch(y){throw f.setResult(!1,{packageName:e},y),y}}const v=Li({...e,loopComponentRouterInput:r});if(i?.PersistedProperties){const{registrationId:e}=r,t=!e||g(e),o=(0,c.xl)(a),n=t?{isFluid:!0,documentEverHidden:o}:{isFluid:!1,loopRegistrationId:e,documentEverHidden:o};i.PersistedProperties.addPersistedProperties(n)}return{component:v.then(async e=>{const[t,n]=await Promise.all([e.container,e.component]);await async function(e,t){e.ComponentInitializer&&(t.markSubActivityStart("ComponentInitialize"),await e.ComponentInitializer.initialize(),t.markSubActivityEnd("ComponentInitialize"))}(n,f);const s=Oi(n);i?.PersistedProperties&&s&&i.PersistedProperties.addPersistedProperties({identityName:s}),f.setResult(!0),i&&function(e,t,r){const o=Oi(e);o&&!Ai.has(o)&&((0,m.Ot)(r,{eventName:"LoadComponentMetadata",identityName:o,source:t}),Ai.add(o))}(n,"owh-getLoopComponentInternal",i);const a=t&&"Data"===r.type&&"URL"===r.dataType?r.data.url.href:void 0;if(d){const e=o.synthesize({FluidDocumentServiceFactoryProvider:"FluidDocumentServiceFactoryProvider"},void 0);return So(n,t,d,e.FluidDocumentServiceFactoryProvider,a)}return n}).catch(e=>{throw f.setResult(!1,void 0,e),e}),container:v.then(e=>e.container).catch(e=>{throw f.setResult(!1,void 0,e),e})}}const Ai=new Set;function Oi(e){return e.ComponentTelemetryMetadata?.entityName}var Mi=r(20258);const _i=new Map;function Ri(e,t){t.then(async t=>{t?(t.attachState!==Ce.Attached&&await new Promise(e=>{t.once("attached",e)}),e.resolve(t.resolvedUrl)):e.resolve(void 0)}).catch(()=>{e.resolve(void 0)})}var Hi,Ui;!function(e){e.Generic="Generic",e.Error="Error",e.UserAction="UserAction",e.Activity="Activity",e.DNM="DNM"}(Hi||(Hi={})),function(e){e.Success="Success",e.Failure="Failure",e.Cancelled="Cancelled"}(Ui||(Ui={}));function ji(e,t){const r="LoopComponentLoader";if(e.has(r)&&window===t.windowContextForLoader)return e;const o=new ni(e);var n;return o.register(r,(n=t.windowContextForLoader,new zi(n))),o}function qi(e,t,o){const n=new ni(e);return n.register("NestedLoopComponentHosting",async function(e,t,o){const n="NestedLoopComponentHosting",i="NestedLoopComponentLoader",a=e.synthesize({SettingsProvider:"SettingsProvider",NestedLoopComponentHosting:n,NestedLoopComponentLoader:i},void 0),c=await a.NestedLoopComponentHosting,d=await a.NestedLoopComponentLoader,l=c?.getNestedDependencyContainer?.bind(c)??d?.getNestedDependencyContainer?.bind(d),u=fi(await a.SettingsProvider)?function(e,t,o){return n=>{if(!n.has("FluidDocumentServiceFactoryProvider"))return o&&(0,m.Ot)(o,{eventName:"NoFluidDocumentServiceFactoryForNestedDependencyContainer"}),t?.(n)??n;const i={SettingsProvider:"SettingsProvider",TokenProvider:"TokenProvider",UserContext:"UserContext"},a=n.synthesize(i,{FluidDocumentServiceFactoryProvider:"FluidDocumentServiceFactoryProvider"}),c=new ni(n),d=e.then(e=>{if(e&&(0,fo.g2)(e))return function(e,t,o){return new Mi.I(async()=>{const[n,i,s,a]=await Promise.all([e.FluidDocumentServiceFactoryProvider,e.SettingsProvider,e.TokenProvider,e.UserContext]);return Promise.all([r.e(8088),r.e(97160)]).then(r.bind(r,67866)).then(e=>new e.OdspFluidDocumentServiceFactory({hostDocumentServiceFactory:n,settingsProvider:i,tokenProvider:s,userContext:a},t,_i,o))})}({FluidDocumentServiceFactoryProvider:a.FluidDocumentServiceFactoryProvider,SettingsProvider:a.SettingsProvider,TokenProvider:a.TokenProvider,UserContext:a.UserContext},e,o);{const t=e?"ResolvedUrlNotOdsp":"ResolvedUrlUndefined";return(0,m.A$)(Hi.Generic,o,{eventName:t}),a.FluidDocumentServiceFactoryProvider.then(e=>s({documentServiceFactory:e.documentServiceFactory,createDocumentRequest:e.getCreateDocumentRequest}))}});return c.register("FluidDocumentServiceFactoryProvider",d),t?.(c)??c}}(t,l,o):l;return new Vi(u)}(e,t,o)),n}class zi{dispose(){}get LoopComponentLoader(){return this}get Disposable(){return this}async getLoopComponent(e){let{loopComponentRouterInput:t,dependencySynthesizer:r,fluidRequestHeaders:o,requiredProviderTypes:n}=e;const{logger:i,perfMetadata:s,documentHiddenTrackerId:a}=u({logger:await r.synthesize({NamespaceLogger:"NamespaceLogger"},void 0).NamespaceLogger}),c=new ye.c,d=xi({windowContextForLoader:this.windowContextForLoader,loopComponentRouterInput:t,dependencySynthesizer:qi(r,c,i),logger:i,perfMetadata:s,documentHiddenTrackerId:a,fluidRequestHeaders:o,requiredProviderTypes:n});return Ri(c,d.container),Promise.all([d.container,d.component]).then(e=>{let[t,r]=e;return r})}constructor(e){this.windowContextForLoader=e}}class Vi{get NestedLoopComponentHosting(){return this}getNestedDependencyContainer(e){return this.getNestedDependencyContainerImpl?this.getNestedDependencyContainerImpl(e):e}dispose(){}get Disposable(){return this}constructor(e){this.getNestedDependencyContainerImpl=e}}function $i(e){let{loopComponentRouterInput:t,dependencySynthesizer:r,config:o,fluidRequestHeaders:n,requiredProviderTypes:i}=e;const{logger:s,newConfig:a,perfMetadata:c,documentHiddenTrackerId:d}=u(o||{}),l=window;let h=ji(r,{windowContextForLoader:l});const g=new ye.c;h=qi(h,g,s);const p=xi({windowContextForLoader:l,loopComponentRouterInput:t,dependencySynthesizer:h,config:a,logger:s,perfMetadata:c,documentHiddenTrackerId:d,fluidRequestHeaders:n,requiredProviderTypes:i});return Ri(g,p.container),Promise.all([p.container,p.component]).then(e=>{let[t,r]=e;return r})}var Gi=r(58443),Wi=r(13296),Ji=r(56142),Ki=r(16460),Qi=r(91947);class Yi{constructor(e,t){this.isProvidingDataToSave=void 0,this.hasDataToSave=void 0,this.component=void 0,this.isProvidingDataToSave=!1,this.hasDataToSave=e,this.component=t}async startProvidingDataToSave(){this.isProvidingDataToSave||((0,Ji.Rm)("Will start providing data to save..."),(0,Ki.tM)(e=>{(0,Ji.Rm)("RequestDataToSave event"),this.onDataToSaveRequest(e)}),(0,Ki.U4)(()=>{(0,Ji.Rm)("FluidComponentSaved event"),this.onFluidComponentDataSaved()}),await(0,Qi.UT)(!0),this.isProvidingDataToSave=!0,this.hasDataToSave||this.detectWhenFluidComponentIsEdited())}async stopProvidingDataToSave(){this.isProvidingDataToSave&&((0,Ji.Rm)("Will stop providing data to save..."),await(0,Qi.UT)(!1),(0,Ki.DS)(this.onDataToSaveRequest),(0,Ki.Yz)(this.onFluidComponentDataSaved),this.isProvidingDataToSave=!1)}async onDataToSaveRequest(e){var t;const r=e.detail.requestId;let n=!1,i="";const s=await(null===(t=this.component.LoopComponentUrl)||void 0===t?void 0:t.getLoopComponentUrl());let a=!1;var c,d;if(s&&(a=!0),a)n=null!==(c=null===(d=this.component.ComponentLifecycle)||void 0===d?void 0:d.isDirty)&&void 0!==c&&c;else try{this.component.LoopComponentUrl&&this.component.FluidMetadataProvider&&(i=this.component.FluidMetadataProvider.getSnapshot()),n=i.length>0}catch(l){(0,o.c2)("DataToSaveProvider.onDataToSaveRequest()",new o.uV("Unable to get data to save from the container.",l))}(0,Qi.a7)(r,a,n,i).then(()=>{(0,Ji.Rm)(`Provided data to save. (Request: ${r}, isAttached: ${a}, hasDataToSave: ${n})`)}).catch(e=>{(0,Ji.vV)(`Unable to provide data to save. (Request: ${r}) ${e}`)})}onFluidComponentDataSaved(){(0,Ji.Rm)("Fluid component was saved."),this.hasDataToSave=!1,this.detectWhenFluidComponentIsEdited()}fluidComponentEdited(){this.hasDataToSave||((0,Ji.Rm)("Fluid component was edited, so there is now data to save."),this.hasDataToSave=!0,(0,Qi.nA)())}detectWhenFluidComponentIsEdited(){const e=t=>{t.defaultPrevented||(0,Wi.wP)(t)&&(document.removeEventListener("keydown",e),document.removeEventListener("mousedown",e),this.fluidComponentEdited())};document.addEventListener("keydown",e),document.addEventListener("mousedown",e)}}var Zi=r(51492),Xi=r(64643),es=r(33829),ts=r(90293),rs=r(98123),os=r(6971);class ns{constructor(e,t,r,o){this.component=e,this.loopInfo=t,this.isFluidLoop=r,this.officeFluidLogger=o,this.loopInfoChangedEventListeners=new Set,this.hasBeenUpdated=!1,this.currentLinkScope=void 0}determineLinkText(e,t,r){return e?r?r+Gi.Ct:t:r||t}off(e,t){this.loopInfoChangedEventListeners.delete(t)}on(e,t){this.loopInfoChangedEventListeners.add(t)}async onLinkUrlChanged(e,t){if((0,Ji.Rm)("Received native event LinkUrlChanged"),e!==this.loopInfo.linkUrl){if("@fluidx/video-playback"===this.loopInfo.registrationId){const t=await(0,os.E)();e=(0,rs.addReferralParamsToStreamUrl)(e,t.hydrateScenarioEntryPoint)}(0,Ji.Rm)(`Link url: ${e}`),this.loopInfo.linkUrl=e,this.onLoopInfoChanged({linkUrl:e})}if(t&&t!==this.currentLinkScope){const e=void 0!==this.currentLinkScope;if(this.currentLinkScope=t,(0,Ji.Rm)(`link scope: ${t}, isUpdate: ${e}`),this.officeFluidLogger){n._.startActivity(this.officeFluidLogger,i.G.CreateShareLink).setSuccess({linkScope:t,isUpdate:e})}}}onLoopInfoChanged(e){Object.keys(e).length&&(this.loopInfoChangedEventListeners.forEach(t=>{t(new CustomEvent("LoopInfoChanged",{detail:e}))}),(0,Qi.a5)(e))}onTitleChanged(e){const t={};(0,Ji.Rm)("LoopComponentProperties.onTitleChanged() called."),e&&e!==this.loopInfo.loopTitle&&((0,Ji.Rm)(`Loop title: ${e}`),this.loopInfo.loopTitle=e,t.loopTitle=e);const r=this.determineLinkText(this.isFluidLoop,this.loopInfo.loopName,this.loopInfo.loopTitle);r&&r!==this.loopInfo.linkText&&((0,Ji.Rm)(`Link text: ${r}`),this.loopInfo.linkText=r,t.linkText=r),this.onLoopInfoChanged(t)}async updateFluidFilename(){if(!this.isFluidLoop||!this.loopInfo.linkUrl)return;const e=await(0,ts.Wu)(this.loopInfo.linkUrl,this.loopInfo.linkText||null),t=(0,ts.$r)(e||"");this.onTitleChanged(t)}async update(){const e=this.component.ComponentProperties,t=this.component.ComponentTitle,o=this.component.ComponentWithTitle,n=this.component.ContentURL,i={};if(n)try{const e=await n.getContentURL();e.href&&e.href!==this.loopInfo.linkUrl&&((0,Ji.Rm)(`Link url: ${e.href}`),this.loopInfo.linkUrl=e.href,i.linkUrl=e.href)}catch(d){(0,Ji.vV)("Unable to get the content url for the Loop component.")}if(e){try{let t;if("@fluidx/video-playback"===this.loopInfo.registrationId){if(await(0,Zi.PA)(Zi.u.OEP,"ChangeGate.FluidHost.UseClipChampLogo")){t=(await r.e(82440).then(r.bind(r,82440))).ClipchampLogo}else{t=(await r.e(27443).then(r.bind(r,27443))).StreamLogo}}else{var s;t=e.iconUrl||await(null===(s=e.getIconUrl)||void 0===s?void 0:s.call(e))}t&&t!==this.loopInfo.loopIconUrl&&((0,Ji.Rm)(`Loop icon url: ${t}`),this.loopInfo.loopIconUrl=t,i.loopIconUrl=t)}catch(d){(0,Ji.vV)("Unable to get the icon url of the Loop component.")}try{var a;const t=e.name||await(null===(a=e.getName)||void 0===a?void 0:a.call(e));t&&t!==this.loopInfo.loopName&&((0,Ji.Rm)(`Loop name: ${t}`),this.loopInfo.loopName=t,i.loopName=t)}catch(d){(0,Ji.vV)("Unable to get the name of the Loop component.")}}if((t||o)&&(void 0===t&&((0,Ji.Rm)("Component does not provide ComponentTitle."),o&&(0,Ji.Rm)("Using ComponentWithTitle instead.")),!this.isFluidLoop))try{const e=(null===t||void 0===t?void 0:t.title)||await(null===o||void 0===o?void 0:o.getTitleText());e&&e!==this.loopInfo.loopTitle&&((0,Ji.Rm)(`Loop title: ${e}`),this.loopInfo.loopTitle=e,i.loopTitle=e)}catch(d){(0,Ji.vV)("Unable to get the title of the Loop component.")}const c=this.determineLinkText(this.isFluidLoop,this.loopInfo.loopName,this.loopInfo.loopTitle);c&&c!==this.loopInfo.linkText&&((0,Ji.Rm)(`Link text: ${c}`),this.loopInfo.linkText=c,i.linkText=c),this.onLoopInfoChanged(i),this.hasBeenUpdated||((0,es.As)(this.onLinkUrlChanged.bind(this)),null===t||void 0===t||t.on("titleChanged",e=>{(0,Ji.Rm)("Received event ComponentTitle.titleChanged"),this.onTitleChanged(e)})),this.hasBeenUpdated=!0}}var is=r(4311),ss=r(24921),as=r(53450),cs=r(51655);let ds=function(e){return e[e.Success=0]="Success",e[e.Failure=1]="Failure",e}({});class ls extends as.r{constructor(e){super("CreateDocument",e),this.AttachDocumentPerfTracker=void 0,this.CreateDocumentPerfTracker=void 0,this.setAttachDocumentPerfTracker()}setAttachDocumentPerfTracker(){const e=cs.q.startNew();this.AttachDocumentPerfTracker=e}setCreateDocumentPerfTracker(){const e=cs.q.startNew();this.CreateDocumentPerfTracker=e}sendTelemetryForSuccess(){this.endActivity(!0,ds.Success)}sendTelemetryForFailure(e){this.endActivity(!1,e)}async addDataFieldsToActivity(e,t){var r,o,n,i;(null===(r=this.AttachDocumentPerfTracker)||void 0===r?void 0:r.startTime)&&this.addInt64DataField("AttachDocumentStartTime",this.AttachDocumentPerfTracker.startTime),(null===(o=this.AttachDocumentPerfTracker)||void 0===o?void 0:o.getDuration)&&this.addInt64DataField("AttachDocumentDuration",this.AttachDocumentPerfTracker.getDuration()),this.AttachDocumentPerfTracker&&this.addBooleanDataField("AttachDocumentSuccess",this.AttachDocumentPerfTracker.isSuccess),(null===(n=this.CreateDocumentPerfTracker)||void 0===n?void 0:n.startTime)&&this.addInt64DataField("CreateDocumentStartTime",this.CreateDocumentPerfTracker.startTime),(null===(i=this.CreateDocumentPerfTracker)||void 0===i?void 0:i.getDuration)&&this.addInt64DataField("CreateDocumentDuration",this.CreateDocumentPerfTracker.getDuration()),this.CreateDocumentPerfTracker&&this.addBooleanDataField("CreateDocumentSuccess",this.CreateDocumentPerfTracker.isSuccess),this.addStringDataField("ResultType",ds[e]),t&&this.addStringDataField("ErrorMessage",t)}}var us,hs=r(97232);!function(e){e.summarizingClient="fluid-client-summarizer",e.createNew="createNew"}(us||(us={}));var gs,ps=r(20310),ms=r(37513),fs=r(74621);function vs(){return"object"===typeof navigator&&null!==navigator&&"boolean"===typeof navigator.onLine?navigator.onLine?gs.Online:gs.Offline:gs.Unknown}!function(e){e[e.Offline=0]="Offline",e[e.Online=1]="Online",e[e.Unknown=2]="Unknown"}(gs||(gs={}));class ys extends fs.iq{constructor(e,t,r){super(e,r),this.canRetry=t,this.errorType=ms.a.genericNetworkError}}class bs extends fs.iq{constructor(e,t){super(e,t),this.errorType=ms.a.fluidInvalidSchema,this.canRetry=!1}}class Ss extends fs.iq{constructor(e,t,r){super(e,{...t,statusCode:400}),this.errorType=Ss.errorType,this.canRetry=!1,this.storageOnlyReason=r}}Ss.errorType=ms.a.deltaStreamConnectionForbidden;class Cs extends fs.iq{constructor(e,t,r,o){void 0!==t&&(o.claims=t),void 0!==r&&(o.tenantId=r),super(e,o,new Set(["claims","tenantId"])),this.errorType=ms.a.authorizationError,this.canRetry=!1}}fs.iq;class ks extends fs.iq{constructor(e,t,r,o){super(e,o),this.errorType=t,this.canRetry=r}}class ws extends ks{constructor(e,t,r){super(e,t,!1,r),this.errorType=t}}class Ps extends ks{constructor(e,t,r){super(e,t,!0,r),this.errorType=t}}class Ts extends fs.iq{constructor(e,t,r){super(e,r),this.retryAfterSeconds=t,this.errorType=ms.a.throttlingError,this.canRetry=!0}}var Es=r(41395),Ns=r(50178);var Is=r(2875);const Ds="Bearer";function Fs(e){const t=[{headerName:"sprequestguid",logName:"sprequestguid"},{headerName:"request-id",logName:"requestId"},{headerName:"client-request-id",logName:"clientRequestId"},{headerName:"x-msedge-ref",logName:"xMsedgeRef"},{headerName:"X-Fluid-Retries",logName:"serverRetries"},{headerName:"content-encoding",logName:"contentEncoding"},{headerName:"content-type",logName:"contentType"}],r={sprequestduration:(0,Ns.ZK)(e.get("sprequestduration")),contentsize:(0,Ns.ZK)(e.get("content-length"))};for(const n of t){const t=e.get(n.headerName);void 0!==t&&null!==t&&(r[n.logName]=t)}const o=e.get("x-fluid-telemetry");if(void 0!==o&&null!==o){r.xFluidTelemetry=o;const e=o.split(",").map(e=>e.split("="));for(const[t,o]of e)if("Origin"===t.trim()){let e;switch(o?.trim()){case"c":e="cache";break;case"g":e="graph";break;default:e=o?.trim()}r["responseOrigin"]=e;break}}return r}class Bs extends fs.iq{constructor(e,t,r){super(e,r,new Set(["redirectLocation"])),this.redirectLocation=t,this.errorType=ms.a.fileNotFoundOrAccessDeniedError,this.canRetry=!1}}function Ls(e,t,r,o,n){let i,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const a=function(e){try{if(void 0!==e){const t=JSON.parse(e);if(function(e){const t=e?.error;return"string"===typeof t?.message&&(void 0===t?.code||"string"===typeof t?.code)}(t))return{success:!0,errorResponse:t}}}catch{}return{success:!1}}(n);let c,d,l;if(a.success){const e=a.errorResponse;s.responseMessage=e.error.message,c=function(e){const t=[];let r=e.error;for(;"object"===typeof r&&null!==r;)void 0!==r.code&&t.unshift(r.code),r=r.innerError;return t}(e),void 0!==c&&(d=c[0],s.innerMostErrorCode=d)}const u={driverVersion:"2.51.0",statusCode:t,...s};switch(t){case 301:case 302:case 303:case 307:case 308:if(l=o?.headers.get("Location")??void 0,void 0!==l){i=new Bs(e,l,u);break}case 400:if("fluidInvalidSchema"===d){i=new bs(e,u);break}i=new ws(e,ms.a.genericNetworkError,u);break;case 401:case 403:if("serviceReadOnly"===d)i=new Ps(e,Es.E.serviceReadOnly,u);else if("blockedIPAddress"===d||"conditionalAccessPolicyEnforced"===d)i=new ws("IP Address is blocked",Es.E.blockedIPAddress,u);else{const t=o?.headers?function(e){const t=e.get("www-authenticate");if(!t)return;let r,o=!1;return t.split(",").map(e=>{const t=e.split("=");t.length>=2&&(o||"error"!==t[0].trim().toLowerCase()?r||"claims"!==t[0].trim().toLowerCase()||(r=(0,Is.AH)(JSON.parse(e.slice(Math.max(0,e.indexOf("=")+1)).trim()))):o="insufficient_claims"===JSON.parse(t[1].trim().toLowerCase()))}),o?r:void 0}(o.headers):void 0,r=o?.headers?function(e){const t=e.get("www-authenticate");if(!t)return;const r=t.indexOf(Ds);if(r<0)return;let o;return t.slice(Math.max(0,r+6)).split(",").map(e=>{if(!o){const t=e.split("=");t.length>=2&&"realm"===t[0].trim().toLowerCase()&&(o=JSON.parse(t[1].trim()))}}),o}(o.headers):void 0;i=new Cs(e,t,r,u)}break;case 404:if(a.success){const t=a?.errorResponse?.error;if(l=t?.["@error.redirectLocation"],void 0!==l){i=new Bs(e,l,u);break}}i=new ws(e,ms.a.fileNotFoundOrAccessDeniedError,u);break;case 406:i=new ws(e,ms.a.unsupportedClientProtocolVersion,u);break;case 410:i=new ws(e,Es.E.cannotCatchUp,u);break;case 409:i=new ws(e,ms.a.fileOverwrittenInStorage,u);break;case 412:i=new ws(e,ms.a.genericNetworkError,u);break;case 413:i=new ws(e,Es.E.snapshotTooBig,u);break;case 414:i=new ws(e,Es.E.invalidFileNameError,u);break;case 423:if("resourceLocked"===d||"resourceCheckedOut"===d){i=new ws(e,ms.a.fileIsLocked,u);break}case 500:i=new Ps(e,ms.a.genericNetworkError,u);break;case 501:i=new ws(e,Es.E.fluidNotEnabled,u);break;case 507:i=new ws(e,ms.a.outOfStorageError,u);break;case 712:i=new ws(e,ms.a.incorrectServerResponse,u);break;default:i=function(e,t,r){return void 0!==t.retryAfterMs&&t.canRetry?new Ts(e,t.retryAfterMs/1e3,r):new ys(e,t.canRetry,r)}(e,{canRetry:!0,retryAfterMs:void 0===r?void 0:1e3*r},u);break}return i.addTelemetryProperties({endpointReached:!0}),function(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.online=gs[vs()],void 0!==r&&(e.facetCodes=r);if(t&&(o.responseType=t.type,t.headers)){const r=Fs(t.headers);for(const e of Object.keys(r))o[e]=r[e];e.serverEpoch=t.headers.get("x-fluid-epoch")??void 0}e.addTelemetryProperties(o)}(i,o,c,void 0),i}function xs(e,t,r,o,n){const i=Ls(e,t,function(e){if(null===e)return;const t=Number(e);if(Number.isNaN(t))return;return t}(r.headers.get("retry-after")),r,o,n);throw i.addTelemetryProperties({odspError:!0,storageServiceError:!0}),i}const As="2.51.0";async function Os(e,t){const r=(0,ps.l)();return fetch(e,t).then(async e=>{const t=e;if(!t)throw new ws("No response from ODSP fetch call",Es.E.incorrectServerResponse,{driverVersion:As});(!t.ok||t.status<200||t.status>=300)&&xs(`ODSP fetch error [${t.status}]`,t.status,t,await t.text());const o=function(e){const t=new Map;for(const[r,o]of e.entries())t.set(r,o);return t}(t.headers);return{content:t,headers:o,propsToLog:Fs(o),duration:(0,ps.l)()-r}},e=>{const t=vs(),r={value:`${e}`,tag:Ns.mc.UserData},o=r.value.replace(/((http|https):\/\/(\S*))/i,"REDACTED_URL");if("AbortError"===e.name)throw new Ps("Fetch Timeout (AbortError)",Es.E.fetchTimeout,{driverVersion:As});if(o.includes("ETIMEDOUT"))throw new Ps("Fetch Timeout (ETIMEDOUT)",Es.E.fetchTimeout,{driverVersion:As});throw t===gs.Offline?new Ps(`ODSP fetch failure (Offline): ${o}`,Es.E.offlineError,{driverVersion:As,rawErrorMessage:r}):new Ps(`ODSP fetch failure: ${o}`,Es.E.fetchFailure,{driverVersion:As,rawErrorMessage:r})})}Os.fetch=fetch;const Ms=e=>"object"===typeof e&&"string"===typeof e?.name&&"object"===typeof e?.fluid;function _s(e){let t;return t=e&&"name"in e?e.name:Ms(e?.package)?e?.package.name:e?.package,t}const Rs={KeyboardShortcutEmitter:"KeyboardShortcutEmitter",ConsumeLayout:"ConsumeLayout",ContentPlayable:"ContentPlayable",Disposable:"Disposable",Focusable:"Focusable",FocusableV2:"FocusableV2",HTMLView:"HTMLView",ComponentProduceCommands:"ComponentProduceCommands",DeepLinking:"DeepLinking",ComponentClipboardProvider:"ComponentClipboardProvider",ComponentFocusable:"ComponentFocusable",ComponentHasTransaction:"ComponentHasTransaction",ComponentHighlight:"ComponentHighlight",ComponentProvidesPlaceholder:"ComponentProvidesPlaceholder",ComponentSelection:"ComponentSelection",IFluidHTMLView:"IFluidHTMLView",ComponentCanvasProvider:"ComponentCanvasProvider",HTMLViewable:"HTMLViewable",ComponentWithTitle:"ComponentWithTitle",ComponentTitle:"ComponentTitle",ComponentProperties:"ComponentProperties",MessageBannerProvider:"MessageBannerProvider",LoopState:"LoopState",IComponentLastEditedTracker:"IComponentLastEditedTracker",PresenceAwayStatusTrackerFetcher:"PresenceAwayStatusTrackerFetcher",IFluidLoadable:"IFluidLoadable",ComponentLifecycle:"ComponentLifecycle",Lifecycle:"Lifecycle",ConnectionManager:"ConnectionManager",CollaboratorInfo:"CollaboratorInfo",ContentURL:"ContentURL",LoopComponentUrl:"LoopComponentUrl",Presence:"Presence",ComponentInitializer:"ComponentInitializer",ComponentMeetingInformationProvider:"ComponentMeetingInformationProvider",FluidMetadataProvider:"FluidMetadataProvider",ComponentTelemetryMetadata:"ComponentTelemetryMetadata",SharePointDocumentInfo:"SharePointDocumentInfo",FoundInPlacesInfo:"FoundInPlacesInfo",InformationProtectionLabelService:"InformationProtectionLabelService",HandoffService:"HandoffService",CitationList:"CitationList"};async function Hs(e,t,r,s,a,c){(0,Ji.Rm)("Attaching document..."),await async function(e,t,r,o){var s,a;const c=(0,Zi.n_)(Zi.u.OEP,"FluidHost.AttachDelay",0),d=r?n._.startActivity(r,i.G.AttachContainer):void 0,l=await c;l>0&&await(0,ss.y)(l);const u=o;null!==(s=u.LoopComponentUrl)&&void 0!==s&&s.initializeLoopComponentUrl&&await u.LoopComponentUrl.initializeLoopComponentUrl(e).catch(e=>{var r,o;throw null===(r=u.Disposable)||void 0===r||r.dispose(),null===(o=t.AttachDocumentPerfTracker)||void 0===o||o.setFailure(e),null===d||void 0===d||d.setFailure(e),new Error("Unable to attach document.")}),null===(a=t.AttachDocumentPerfTracker)||void 0===a||a.setSuccess(),null===d||void 0===d||d.setSuccess()}(t,s,r,e),(0,Ji.Rm)("Document attached."),s.setCreateDocumentPerfTracker();try{const d=await async function(e,t,r){var s,a;const c=r?n._.startActivity(r,i.G.GetFileLink):void 0,d=await(null===(s=e.LoopComponentUrl)||void 0===s?void 0:s.getLoopComponentUrl().catch(r=>{var n,i;throw null===(n=e.Disposable)||void 0===n||n.dispose(),null===(i=t.CreateDocumentPerfTracker)||void 0===i||i.setFailure(r),null===c||void 0===c||c.setFailure(r),new Error(`Unable to get the url of the new Fluid component. ${(0,o.u1)(r)}`)}));if(!d){var l,u;null===(l=e.Disposable)||void 0===l||l.dispose();const r=new Error("Unable to get the absolute url from the component.");throw null===c||void 0===c||c.setFailure(r),null===(u=t.CreateDocumentPerfTracker)||void 0===u||u.setFailure(r),r}return null===(a=t.CreateDocumentPerfTracker)||void 0===a||a.setSuccess(),null===c||void 0===c||c.setSuccess(),d}(e,s,r);let u="";try{u=await(0,is.RG)(d)}catch(l){(0,Ji.vV)("Unable to get file name from Sharepoint.")}u||(u=t),(0,Ji.Rm)(`Document created.\nFile name: "${u}"\nUrl: ${d}`);const h=null===a||void 0===a?void 0:a.resolve({url:d.href,headers:c.headers}),g={linkText:u,linkUrl:d.toString()},p=new ns(e,g,!0,r);await p.update();return{loopComponentProperties:p,createDocumentActivity:s,resolvedUrlPromise:h}}catch(l){var d;throw null===s||void 0===s||null===(d=s.CreateDocumentPerfTracker)||void 0===d||d.setFailure(l),new Error("Unable to create document.")}}async function Us(e,t,r,a,c,d,l,h,g,p,m,f){var v,y;let b;const S=function(e){if(e===Gi.l1)return!1;return!0}(e),C=await(0,Zi.xB)(),k=await Zi.LM,w=!S||await(0,Zi.qF)();let P,T,E;const N=new ls(a||"");if(!C){const e=h?n._.startActivity(h,i.G.GetDriveInfo):void 0;T=await(0,is.fZ)().catch(t=>{var r;throw null===(r=N.AttachDocumentPerfTracker)||void 0===r||r.setFailure(t),null===e||void 0===e||e.setFailure(t),new Error("Unable to get driver info.")}),null===e||void 0===e||e.setSuccess(),E=await t.catch(e=>{var t;throw null===(t=N.AttachDocumentPerfTracker)||void 0===t||t.setFailure(e),new Error("Unable to get special folder name.")})}if(p){const e=await p;if(C){const e=h?n._.startActivity(h,i.G.GetDriveInfo):void 0;P=(0,is.fZ)(),P.then(()=>{null===e||void 0===e||e.setSuccess()}).catch(t=>{null===e||void 0===e||e.setFailure(t)})}l.register("FluidDocumentServiceFactoryProvider",s({documentServiceFactory:e,createDocumentRequest:async e=>(C&&(T=await P.catch(e=>{var t;throw null===(t=N.AttachDocumentPerfTracker)||void 0===t||t.setFailure(e),new Error("Unable to get driver info.")}),E=await t.catch(e=>{var t;throw null===(t=N.AttachDocumentPerfTracker)||void 0===t||t.setFailure(e),new Error("Unable to get special folder name.")})),function(e,t,r,o,n,i){const s=function(e){if(!e)return;let t=`createLinkScope=${e.scope}`;const r=e.role;return t=r?`${t}&createLinkRole=${r}`:t,t}(n);return{url:`${e}?driveId=${encodeURIComponent(t)}&path=${encodeURIComponent(r)}${i?`&containerPackageName=${_s(i)}`:""}${s?`&${s}`:""}`,headers:{[us.createNew]:{fileName:o}}}}(T.siteUrl,T.id,E,e))}))}const I=c.environment,D=d.uiLanguage;if(w){const t=function(e){if(e===Gi.l1)return"@ms/forms-loop";return""}(e),r=await zs(),o=await async function(e,t,r,o,n,i,s){const a=!o||"@ms/office-fluid-container"==o;if(a){return{type:"Fluid",codeDetails:await js(e,t,r,n,i),pendingLocalState:s}}return{type:"Creation",registrationId:o}}(e,I,D,t,h,g,r);b=$i({config:c,dependencySynthesizer:l,loopComponentRouterInput:o,fluidRequestHeaders:f.headers,requiredProviderTypes:k?{...Rs,ComponentLifecycle:"ComponentLifecycle"}:void 0})}else if(e){b=function(e){const{logger:t,newConfig:r,perfMetadata:o,documentHiddenTrackerId:n}=u(e.config||{}),i=window;ii(Qn(e.codeDetails),t);const s=Si(i,e,void 0,r,t,o,n);return Promise.all([s.container,s.component]).then(e=>{let[t,r]=e;return r})}({codeDetails:await js(e,I,D,h,g),config:c,dependencySynthesizer:l,requiredProviderTypes:k?{...Rs,ComponentLifecycle:"ComponentLifecycle"}:void 0})}else{b=function(e){const{logger:t,newConfig:r,perfMetadata:o,documentHiddenTrackerId:n}=u(e.config||{}),i=Ci(window,e,void 0,r,t,o,n);return Promise.all([i.container,i.component]).then(e=>{let[t,r]=e;return r})}({config:c,dependencySynthesizer:l,snapshot:await zs(),requiredProviderTypes:k?{...Rs,ComponentLifecycle:"ComponentLifecycle"}:void 0})}const F=await b,B=null===(v=F.FluidMetadataProvider)||void 0===v?void 0:v.getCodeDetails();let L,x;if(void 0===F)throw new o.uV("Unable to create Fluid component. The component is undefined.");if(S){const t=(await(0,Xi.q)()).NewLoopComponentFileName,n=function(e,t){const r=e.replace(/[~#%&*{}\\:<>?/+|".]/g,"").trim();return t?function(e,t,r){switch(Qn(e)){case"@ms/whiteboard-container":return`${t}.whiteboard`;case"@fluidx/copilot-frames":return`${t}.loopsug`;default:return r?`${t}.fluid`:`${t}.loop`}}(t,r):((0,o.c2)("toFullSharepointFileName()",new o.uV("Using default extension since no code details provided.")),`${r}.fluid`)}(r.trim()||t,B);if(void 0===m)throw new o.uV("url resolver must be defined for fluid loop");L=Hs(F,n,h,N,m,f);x=new Yi(!!e,F),x.startProvidingDataToSave().catch(()=>{(0,o.c2)("createFluidComponent()",new o.uV("Unable to start providing data to save."))})}else L=async function(e,t){const r=new ns(e,{},!1,t);await r.update();return{loopComponentProperties:r}}(F,h);null===(y=L)||void 0===y||y.then(async e=>{var t;null===(t=x)||void 0===t||t.stopProvidingDataToSave(),(0,Qi.sQ)(e.loopComponentProperties.loopInfo.linkUrl||"",e.loopComponentProperties.loopInfo.linkText||"")});return{component:F,createDocumentPromise:L,componentPromise:b}}async function js(e,t,r,n,i){const s=await async function(e,t,r){const n="containerManifests",i=await(0,Zi.x$)(Zi.u.OEP,"FluidHost.ManifestUpgradeParameterFeature")?Jn(t,e,r,!0):Jn(t,e,r);i.then(e=>{localStorage.setItem(n,JSON.stringify(e))}).catch(e=>{(0,o.c2)("fetchAndCacheContainerManifestEntries()",new o.uV("failed to fetch container manifest.",e))});const s=localStorage.getItem(n);if(s)try{return JSON.parse(s)}catch(a){(0,o.c2)("fetchAndCacheContainerManifestEntries()",new o.uV("cannot parse from cache.",a)),localStorage.removeItem(n)}return i}(t,r,n);if(0==s.length){if(await(0,Zi.PA)(Zi.u.OEP,"FluidHost.UseFallbackCodeDetails")){const t=function(e){var t;const r=null!==(t={"FFX-BulletedList":"bulletedList","FFX-Checklist":"checklist","FFX-NumberedList":"numberedList","FFX-Paragraph":"paragraph","FFX-QuestionAnswer":"questionAnswer","FFX-Table":"tableInCanvas","FFX-TaskList":"taskListHostedInScriptorCanvas","FFX-CodeBlock":"codeBlock"}[e])&&void 0!==t?t:"paragraph";return{config:{blueprintId:r},package:{fluid:{browser:{umd:{files:["DynamicallyGeneratedWithCodeLoaderLogic"],library:"officeContainer"}}},name:"@ms/office-fluid-container",version:"0.0.1"}}}(e);return i.addBooleanDataField("FallbackCodeDetailsUsed",!0),(0,Ji.Rm)(`Using fallback codedetails for ${e}`),t}throw new o.uV("failed to get any manifests",void 0,hs.d.ExpectedError_FluidHostWebApp_CannotFetchContainerManifest)}let a=qs(s,e);if(a||(a=qs(s,"FFX-Paragraph"),(0,o.c2)("createFluidComponent()",new o.uV(`No container manifest entry with id "${e}".`))),!a)throw new o.uV(`Unable to create a Fluid component of type: ${e}. There is no container manifest entry for this type.`);return a.codeDetails}function qs(e,t){return e.find(e=>{var r;return(null===e||void 0===e||null===(r=e.queryableData)||void 0===r?void 0:r.id)==t})}async function zs(){return await(0,Qi.Y0)()}async function Vs(e,t,r,o){return function(e){let{dependencySynthesizer:t,containerRequest:r,preCheckInfo:o,config:n,requiredProviderTypes:i}=e;const{logger:s,newConfig:a,perfMetadata:c,documentHiddenTrackerId:d}=u(n||{}),l=bi({windowContextForLoader:window,dependencySynthesizer:t,hostConfig:a,logger:s,perfMetadata:c,documentEverHiddenTrackerID:d,containerRequest:r,driver:void 0,preCheckInfo:o,requiredProviderTypes:i});return Promise.all([l.container,l.component]).then(e=>{let[t,r]=e;return r})}({config:e,containerRequest:t,preCheckInfo:r,dependencySynthesizer:o,requiredProviderTypes:{...Rs,ComponentLifecycle:"ComponentLifecycle"}})}var $s=r(34805),Gs=r(99671);let Ws;async function Js(e,t,r,n,i,s,a,c,d,l,u,h,g,p){if(e)return await Us(t,r,n,c,s,a,l,u,h,g,p,d);{var m,f;let e;const t=await(0,Zi.qF)(),r=!i.registrationId||"@fluidx/office-fluid-container"===i.registrationId;if(t){const t=function(e){let t,r;if(e.linkUrl)try{t=new URL(e.linkUrl)}catch(s){throw new o.uV("LoopInfo.loopLinkUrl is not a valid URL.")}if(e.manifestData)try{r=JSON.parse(e.manifestData)}catch(s){throw new o.uV("Manifest data is not valid JSON.",s)}if(e.loopData){if(e.registrationId===$s.B2){let t;try{var n,i;t=JSON.parse(e.loopData),t.updateExtension={type:"updateExtendedProps",data:{appIcon:null!==(n=t.appIcon)&&void 0!==n?n:"",appName:null!==(i=t.appName)&&void 0!==i?i:"",cardId:t.cardId,contentType:t.cardType,mailId:""}}}catch(s){throw new o.uV("Loop data is not valid JSON.",s)}return{type:"Data",dataType:"Card",data:t,manifestData:r,registrationId:e.registrationId}}throw new o.uV(`Cannot provide loop data for registration id: ${e.registrationId}`)}if(!t)throw new o.uV("A url is required.");return{type:"Data",dataType:"URL",data:{url:t},manifestData:r,registrationId:"@fluidx/office-fluid-container"==e.registrationId?void 0:e.registrationId}}(i);e=async function(e,t,r,o){return(0,Ji.Rm)("Loading Loop component..."),$i({fluidRequestHeaders:o.headers,config:e,dependencySynthesizer:t,loopComponentRouterInput:r,requiredProviderTypes:{...Rs,ComponentLifecycle:"ComponentLifecycle"}})}(s,l,t,d)}else Ws=await async function(e){const t=function(e){const t=(0,Gs.Mh)(e);if(!t)return;let r;try{t?.siteUrl&&(r=new URL(t?.siteUrl).origin)}catch{}return{codeDetailsHint:t?.containerPackageName,criticalBootDomains:r?[r]:void 0}}(new URL(e));return t||{}}(d.url),e=Vs(s,d,Ws,l);const n=await e;null===n||void 0===n||null===(m=n.EmbedCardData)||void 0===m||m.getData().then(e=>{const t=JSON.stringify(e);(0,Qi.KJ)(t),(0,Ji.Rm)(`Saved embedded data: ${t}`)}).catch(()=>{});const a=new ns(n,i,r,u);let c;await a.update(),a.updateFluidFilename();const h=await(null===(f=n.LoopComponentUrl)||void 0===f?void 0:f.getLoopComponentUrl());h&&(c=null===p||void 0===p?void 0:p.resolve({url:h.href,headers:d.headers}));return{component:n,loopComponentProperties:a,componentPromise:e,resolvedUrlPromise:c}}}},22751:(e,t,r)=>{"use strict";r.d(t,{a:()=>k});var o={themeDarker:"#004578",themeDark:"#005a9e",themeDarkAlt:"#106ebe",themePrimary:"#0078d4",themeSecondary:"#2b88d8",themeTertiary:"#71afe5",themeLight:"#c7e0f4",themeLighter:"#deecf9",themeLighterAlt:"#eff6fc",black:"#000000",blackTranslucent40:"rgba(0,0,0,.4)",neutralDark:"#201f1e",neutralPrimary:"#323130",neutralPrimaryAlt:"#3b3a39",neutralSecondary:"#605e5c",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#a19f9d",neutralTertiaryAlt:"#c8c6c4",neutralQuaternary:"#d2d0ce",neutralQuaternaryAlt:"#e1dfdd",neutralLight:"#edebe9",neutralLighter:"#f3f2f1",neutralLighterAlt:"#faf9f8",accent:"#0078d4",white:"#ffffff",whiteTranslucent40:"rgba(255,255,255,.4)",yellowDark:"#d29200",yellow:"#ffb900",yellowLight:"#fff100",orange:"#d83b01",orangeLight:"#ea4300",orangeLighter:"#ff8c00",redDark:"#a4262c",red:"#e81123",magentaDark:"#5c005c",magenta:"#b4009e",magentaLight:"#e3008c",purpleDark:"#32145a",purple:"#5c2d91",purpleLight:"#b4a0ff",blueDark:"#002050",blueMid:"#00188f",blue:"#0078d4",blueLight:"#00bcf2",tealDark:"#004b50",teal:"#008272",tealLight:"#00b294",greenDark:"#004b1c",green:"#107c10",greenLight:"#bad80a"},n=r(46851),i={elevation4:n.f.depth4,elevation8:n.f.depth8,elevation16:n.f.depth16,elevation64:n.f.depth64,roundedCorner2:"2px",roundedCorner4:"4px",roundedCorner6:"6px"},s=r(19466),a=r(53815),c="'Segoe UI', '".concat(a.Dn.WestEuropean,"'"),d={ar:a.bi.Arabic,bg:a.bi.Cyrillic,cs:a.bi.EastEuropean,el:a.bi.Greek,et:a.bi.EastEuropean,he:a.bi.Hebrew,hi:a.bi.Hindi,hr:a.bi.EastEuropean,hu:a.bi.EastEuropean,ja:a.bi.Japanese,kk:a.bi.EastEuropean,ko:a.bi.Korean,lt:a.bi.EastEuropean,lv:a.bi.EastEuropean,pl:a.bi.EastEuropean,ru:a.bi.Cyrillic,sk:a.bi.EastEuropean,"sr-latn":a.bi.EastEuropean,th:a.bi.Thai,tr:a.bi.EastEuropean,uk:a.bi.Cyrillic,vi:a.bi.Vietnamese,"zh-hans":a.bi.ChineseSimplified,"zh-hant":a.bi.ChineseTraditional,hy:a.bi.Armenian,ka:a.bi.Georgian};function l(e,t,r){return{fontFamily:r,MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontSize:e,fontWeight:t}}var u=r(48717),h=r(44828);var g,p=r(13290),m="language";var f=function(e){var t=function(e){for(var t in d)if(d.hasOwnProperty(t)&&e&&0===t.indexOf(e))return d[t];return c}(e),r="".concat(t,", ").concat("'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Helvetica Neue', sans-serif");return{tiny:l(a.s.mini,a.BO.regular,r),xSmall:l(a.s.xSmall,a.BO.regular,r),small:l(a.s.small,a.BO.regular,r),smallPlus:l(a.s.smallPlus,a.BO.regular,r),medium:l(a.s.medium,a.BO.regular,r),mediumPlus:l(a.s.mediumPlus,a.BO.regular,r),large:l(a.s.large,a.BO.regular,r),xLarge:l(a.s.xLarge,a.BO.semibold,r),xLargePlus:l(a.s.xLargePlus,a.BO.semibold,r),xxLarge:l(a.s.xxLarge,a.BO.semibold,r),xxLargePlus:l(a.s.xxLargePlus,a.BO.semibold,r),superLarge:l(a.s.superLarge,a.BO.semibold,r),mega:l(a.s.mega,a.BO.semibold,r)}}(function(e){if(void 0===e&&(e="sessionStorage"),void 0===g){var t=(0,u.Y)(),r="localStorage"===e?function(e){var t=null;try{var r=(0,h.z)();t=r?r.localStorage.getItem(e):null}catch(o){}return t}(m):"sessionStorage"===e?p.G(m):void 0;r&&(g=r),void 0===g&&t&&(g=t.documentElement.getAttribute("lang")),void 0===g&&(g="en")}return g}());function v(e,t,r,o){e="'".concat(e,"'");var n=void 0!==o?"local('".concat(o,"'),"):"";(0,s.n)({fontFamily:e,src:n+"url('".concat(t,".woff2') format('woff2'),")+"url('".concat(t,".woff') format('woff')"),fontWeight:r,fontStyle:"normal",fontDisplay:"swap"})}function y(e,t,r,o,n){void 0===o&&(o="segoeui");var i="".concat(e,"/").concat(r,"/").concat(o);v(t,i+"-light",a.BO.light,n&&n+" Light"),v(t,i+"-semilight",a.BO.semilight,n&&n+" SemiLight"),v(t,i+"-regular",a.BO.regular,n),v(t,i+"-semibold",a.BO.semibold,n&&n+" SemiBold"),v(t,i+"-bold",a.BO.bold,n&&n+" Bold")}!function(e){if(e){var t="".concat(e,"/fonts");y(t,a.Dn.Thai,"leelawadeeui-thai","leelawadeeui"),y(t,a.Dn.Arabic,"segoeui-arabic"),y(t,a.Dn.Cyrillic,"segoeui-cyrillic"),y(t,a.Dn.EastEuropean,"segoeui-easteuropean"),y(t,a.Dn.Greek,"segoeui-greek"),y(t,a.Dn.Hebrew,"segoeui-hebrew"),y(t,a.Dn.Vietnamese,"segoeui-vietnamese"),y(t,a.Dn.WestEuropean,"segoeui-westeuropean","segoeui","Segoe UI"),y(t,a.bi.Selawik,"selawik","selawik"),y(t,a.Dn.Armenian,"segoeui-armenian"),y(t,a.Dn.Georgian,"segoeui-georgian"),v("Leelawadee UI Web","".concat(t,"/leelawadeeui-thai/leelawadeeui-semilight"),a.BO.light),v("Leelawadee UI Web","".concat(t,"/leelawadeeui-thai/leelawadeeui-bold"),a.BO.semibold)}}(function(){var e,t,r=null===(e=(0,h.z)())||void 0===e?void 0:e.FabricConfig;return null!==(t=null===r||void 0===r?void 0:r.fontBaseUrl)&&void 0!==t?t:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/assets"}());var b=r(4563),S={s2:"4px",s1:"8px",m:"16px",l1:"20px",l2:"32px"},C=r(40695);function k(e,t){void 0===e&&(e={}),void 0===t&&(t=!1);var r=!!e.isInverted,n={palette:o,effects:i,fonts:f,spacing:S,isInverted:r,disableGlobalClassNames:!1,semanticColors:(0,C.b)(o,i,void 0,r,t),rtl:void 0};return(0,b.z)(n,e)}},23989:(e,t,r)=>{"use strict";r.d(t,{_:()=>d});var o=r(33788),n=r(95996),i=r(83125),s=r(75335),a=r(25045);const c="EndToEnd";class d{static startScenario(e,t,r,o){if(r){const n=d.startScenario(e,t);return(async()=>{try{const e=await r(n);return n.setSuccess(o?.()),e}catch(e){throw n.setFailure(e,o?.()),e}})()}let n;return new d(t+c,e,()=>{n=(0,s.yb)();try{const t=e.PersistedProperties?.getPersistedProperties?.().hostScenarioStartTime;if(t&&"number"===typeof t){const e=performance.now()-(Date.now()-t);e>=0&&performance.measure("PreScenarioOverhead",{start:e})}}catch{}},()=>{n&&((0,s.WN)(n),n=void 0)},()=>({documentHidden:n?(0,s.xl)(n,!0)>-1:""}))}static startActivity(e,t,r,o){if(r){const n=d.startActivity(e,t);return(async()=>{try{const e=await r();return n.setSuccess(o?.()),e}catch(e){throw n.setFailure(e,o?.()),e}})()}return new d(a.K[t]||t,e)}getLogger(){return this.logger}scenarioEndsAfterRender(){return"LoadEndToEnd"===this.activityType||"PasteEndToEnd"===this.activityType}setSuccess(e){this.activityTracker&&(this.activityTracker.setResult(!0,{...e,...this.getExtraPropsToLog?.()}),this.dispose())}setFailure(e,t){this.activityTracker&&(this.activityTracker.setResult(!1,{...t,...this.getExtraPropsToLog?.(),errorType:e?e.errorType:void 0},e),this.dispose())}cancel(){this.dispose()}dispose(){this.additionalCleanup?.(),this.logger&&(0,n.Ot)(this.logger,{eventName:this.activityType,subCategory:"HostActivityTrackerDisposed"}),this.activityTracker?.dispose(),this.activityTracker=void 0,this.logger=void 0}constructor(e,t,r,s,d){this.activityType=e,this.additionalCleanup=s,this.getExtraPropsToLog=d,r?.(),this.logger=new i.p("HostTracker",t),this.activityTracker=o.m.start(e,this.logger,{addUserTiming:!0,isAPerformanceMetric:[a.G.RenderComponent,a.K.RenderComponent].includes(e)||e.endsWith(c)}),(0,n.Ot)(this.logger,{eventName:e,subCategory:"HostActivityTrackerCreated"})}}},24217:(e,t,r)=>{"use strict";r.d(t,{A:()=>n,F:()=>o});const o=3,n="PolicyLabelsUpdate"},24907:(e,t,r)=>{"use strict";function o(e,t){if(""===e)return void 0===t?"":t.absolutePath;{let r=e.startsWith("/")?e.slice(1):e;return r=r.endsWith("/")?r.slice(0,-1):r,void 0===t?`/${r}`:`${"/"===t.absolutePath?"":t.absolutePath}/${r}`}}r.d(t,{a:()=>o})},24921:(e,t,r)=>{"use strict";function o(e){return new Promise((t,r)=>{try{setTimeout(t,e)}catch(o){r(o)}})}r.d(t,{y:()=>o})},25045:(e,t,r)=>{"use strict";r.d(t,{G:()=>o,K:()=>n});const o={GetDriveInfo:"GetDriveInfo",AttachContainer:"AttachContainer",GetFileLink:"GetFileLink",CreateShareLink:"CreateShareLink",RenderComponent:"RenderComponent",PostRender:"PostRender"},n={RenderComponent:"RenderComponentByHost"}},25418:(e,t,r)=>{"use strict";r.d(t,{s:()=>T});var o=r(33669),n=r(93220),i=r(57471),s=r(85038),a=r(70354),c=r(54813),d=r(93586),l=r(83533),u=r(27250),h=r(58358),g=r(46402),p=r(70530),m=r(27612),f=r(62951);const v=new Map,y=(0,g.p)(async(e,t,r)=>{const o=`${t.siteUrl}_${t.driveId}_${t.itemId}`,n=v.get(o);if(void 0!==n)return n;const i=async function(){let n;try{let o=0;n=await(0,a.M)(async()=>(0,f.M)(async()=>async function(e,t,r){let o,n=!1;for(let s=1;s<=5;s++)try{const o=await C(e,t,r),i=new URL(t.siteUrl).origin,a=new URL(o.sharepointIds.siteUrl).origin;return i!==a&&(n=!0,r.sendTelemetryEvent({eventName:"LocationRedirectionErrorForGetOdspFileLink",retryCount:s}),k(t,a)),await b(e,t,r,o)}catch(i){if(o=i,(0,l.X)(i)&&n&&(i.errorType===d.E.fileNotFoundOrAccessDeniedError||i.errorType===d.E.authorizationError))continue;throw i}throw o}(e,t,r),"getFileLinkCore",r),"getShareLink",r,{onRetry(e,t){if(o++,5===o){if(void 0!==t&&"object"===typeof t)throw t.canRetry=!1,t;throw t}}})}catch(i){throw v.delete(o),i}return(0,s.vA)(void 0!==n,658),n}();return v.set(o,i),i});async function b(e,t,r,o){return u.Bt.timedExecAsync(r,{eventName:"odspFileLink",requestName:"getSharingInformation"},async n=>{let i,s=0;const a=await(0,p.gO)(async n=>{s++;const a=(0,p.bJ)(r,t,e),l=`${t.siteUrl}/_api/web/GetFileById(@a1)/ListItemAllFields/GetSharingInformation?@a1=guid${encodeURIComponent(`'${o.sharepointIds.listItemUniqueId}'`)}`,u="POST",g=await a({...n,request:{url:l,method:u}},"GetFileLinkCore"),f={method:u,headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose",...(0,h.b)(g)}},v=await(0,p.ZR)(l,f);i=v.propsToLog;const y=await v.content.json(),b=y?.d?.directUrl;if("string"!==typeof b)throw new c.OI("Malformed GetSharingInformation response",d.E.incorrectServerResponse,{driverVersion:m.z});return b});return n.end({...i,attempts:s}),a})}const S=e=>"string"===typeof e.webUrl&&"string"===typeof e.webDavUrl&&"object"===typeof e.sharepointIds;async function C(e,t,r){return u.Bt.timedExecAsync(r,{eventName:"odspFileLink",requestName:"getFileItemLite"},async o=>{let n,i=0;const a=await(0,p.gO)(async o=>{i++;const{siteUrl:a,driveId:l,itemId:u}=t,g=(0,p.bJ)(r,t,e),f=`${a}/_api/v2.0/drives/${l}/items/${u}?select=webUrl,webDavUrl,sharepointIds`,v=await g({...o,request:{url:f,method:"GET"}},"GetFileItemLite");(0,s.vA)(null!==v,700);const y={method:"GET",headers:(0,h.b)(v)},b=await(0,p.ZR)(f,y);n=b.propsToLog;const C=await b.content.json();if(!S(C))throw new c.OI("Malformed getFileItemLite response",d.E.incorrectServerResponse,{driverVersion:m.z});return C});return o.end({...n,attempts:i}),a})}function k(e,t){const r=`${t}${new URL(e.siteUrl).pathname}`;e.siteUrl=r,e.endpoints.attachmentGETStorageUrl&&(e.endpoints.attachmentGETStorageUrl=`${t}${new URL(e.endpoints.attachmentGETStorageUrl).pathname}`),e.endpoints.attachmentPOSTStorageUrl&&(e.endpoints.attachmentPOSTStorageUrl=`${t}${new URL(e.endpoints.attachmentPOSTStorageUrl).pathname}`),e.endpoints.deltaStorageUrl&&(e.endpoints.deltaStorageUrl=`${t}${new URL(e.endpoints.deltaStorageUrl).pathname}`),e.endpoints.snapshotStorageUrl&&(e.endpoints.snapshotStorageUrl=`${t}${new URL(e.endpoints.snapshotStorageUrl).pathname}`)}var w=r(11137),P=r(50349);class T{constructor(e,t,r,n,i){this.appName=r,this.getContext=n,this.containerPackageInfo=i,this.sharingLinkCache=new o.o,this.logger=(0,p.bP)(t),e&&(this.shareLinkFetcherProps={...e,tokenFetcher:e.tokenFetcher})}appendDataStorePath(e,t){const r=(0,P.Mh)(e);if(!r)return;const o=new URL(r.dataStorePath,`${e.protocol}//${e.hostname}`);if(t.startsWith("/?")||t.startsWith("?")){const e=new URLSearchParams(t);for(const[t,r]of e.entries())o.searchParams.append(t,r);r.dataStorePath=`${o.pathname}${o.search}`}else r.dataStorePath=`${o.pathname}${o.pathname.endsWith("/")||t.startsWith("/")?"":"/"}${t}/${o.search}`;return(0,P.Cu)(e,r),e.href}getKey(e){return`${e.siteUrl},${e.driveId},${e.itemId}`}async resolve(e){const t={headers:e.headers,url:e.url},r=t.headers?.[n.O.isSharingLinkToRedeem];try{const r=new URL(e.url),o=(0,P.Mh)(r);o&&(t.url=(0,i.m)(o))}catch{}const o=await(new w.Y).resolve(t);return o.context=await(this.getContext?.(o,o.dataStorePath??"")),o.appName=this.appName,o.codeHint=o.codeHint?.containerPackageName?o.codeHint:{containerPackageName:(0,p.nb)(this.containerPackageInfo)},r&&(o.shareLinkInfo=Object.assign(o.shareLinkInfo??{},{sharingLinkToRedeem:this.removeNavParam(e.url)})),o.itemId&&this.getShareLinkPromise(o).catch(()=>{}),o}removeNavParam(e){const t=new URL(e),r=new URLSearchParams(t.search);return r.delete(P.jC),t.search=r.toString(),t.href}async getShareLinkPromise(e){if(void 0===this.shareLinkFetcherProps)throw new Error("Failed to get share link because share link fetcher props are missing");if(!(e.siteUrl&&e.driveId&&e.itemId))throw new Error("Failed to get share link because necessary information is missing (e.g. siteUrl, driveId or itemId)");const t=this.getKey(e),r=this.sharingLinkCache.get(t);if(r)return r;const o=y(this.shareLinkFetcherProps.tokenFetcher,e,this.logger).catch(e=>{throw this.logger.sendErrorEvent({eventName:"FluidFileUrlError"},e),this.sharingLinkCache.remove(t),e});return this.sharingLinkCache.add(t,async()=>o),o}async getAbsoluteUrl(e,t,r){const o=(0,p.Yn)(e),n=await this.getShareLinkPromise(o);return this.appendLocatorParams(n,e,t,r)}async appendLocatorParams(e,t,r,o){const n=(0,p.Yn)(t),i=r||(n.dataStorePath??"");n.context=await(this.getContext?.(n,i));const s=(0,p.nb)(o)??n.codeHint?.containerPackageName??(0,p.nb)(this.containerPackageInfo);return n.appName=this.appName,(0,p.z6)(e,n,i,s)}static createDocumentUrl(e,t){const r=new URL(e);return(0,P.Cu)(r,t),r.href}}},25532:(e,t,r)=>{"use strict";r.d(t,{J:()=>u});var o=r(78796),n=r(95996),i=r(93537),s=r(29018),a=r(48116),c=r(43172),d=r(46624),l=r(26308);async function u(e,t){const r=new URL(e);if([o.i,a.t].includes(r.origin.toLowerCase()))return d.DR;const n=r.hostname.toLowerCase(),i=(0,l.v6)(n);return i?.guid?i.guid:await async function(e,t,r){const o=await h.get(e,t,r);void 0===o&&h.delete(e,t,r);return o}(e,n,t)}const h=(0,r(7621).wJ)(async(e,t,r)=>{let o,a;try{const r=`${(0,s.$)(e)}/_api/v2.0/drives`;let n;try{n=await(0,i.J5)(r,{method:"GET",headers:{Authorization:"Bearer"},credentials:"omit"})}catch{o="Server did not respond"}n&&(a=(0,c.J)(n.result.headers),a?(0,l.b6)(t,{guid:a}):o=`ODSP did not return tenant id in headers. Response status code: ${n.result.status}`)}catch{o="Unexpected error"}return o&&r&&(0,n.Ot)(r,{eventName:"AadTenantNotFound",message:o}),a},(e,t)=>t)},25573:(e,t,r)=>{"use strict";function o(){return(new Date).getTime()}r.d(t,{W:()=>o})},25838:(e,t,r)=>{"use strict";r.d(t,{r:()=>n});var o=r(90589),n={contractName:"Ms.ProductUsage.Action",instanceName:"BaseType",getFields:function(e){var t=this.instanceName,r=[];return r.push((0,o.m9)("zC.".concat(t),this.contractName)),e.ver&&r.push((0,o.m9)("".concat(t,".Ver"),e.ver)),r.push((0,o.m9)("".concat(t,".Name"),e.name)),e.featureName&&r.push((0,o.m9)("".concat(t,".FeatureName"),e.featureName)),e.featureCategory&&r.push((0,o.m9)("".concat(t,".FeatureCategory"),e.featureCategory)),e.inputMethod&&r.push((0,o.m9)("".concat(t,".InputMethod"),e.inputMethod)),r.push((0,o.LK)("".concat(t,".IsExportable"),e.isExportable)),r.push((0,o.LK)("".concat(t,".IsIntentional"),e.isIntentional)),e.subWorkload&&r.push((0,o.m9)("".concat(t,".SubWorkload"),e.subWorkload)),e.target&&r.push((0,o.m9)("".concat(t,".Target"),e.target)),r}}},25969:(e,t,r)=>{"use strict";r.d(t,{K:()=>n});var o=r(29018);function n(e){return[`${(0,o.$)(e)}/files.readwrite.all`]}},26140:(e,t,r)=>{"use strict";function o(){return performance.now()}function n(){return performance.getEntriesByType("resource")}r.d(t,{F:()=>o,T:()=>n})},26308:(e,t,r)=>{"use strict";r.d(t,{b6:()=>d,v6:()=>c});var o=r(63990),n=r(52841);let i;const s="FluidSiteToAadTenantMapping";function a(){if(!i){let e;const t=(0,n.Ar)(),r=t?.getItem(s);if(r)try{e=JSON.parse(r)}catch{t?.removeItem(s)}i=new Map(e)}return i}function c(e){return a().get(e)}function d(e,t){const r=a(),o=r.get(e);r.set(e,{hostname:o?.hostname||t.hostname,guid:o?.guid||t.guid}),u()}let l=!1;function u(){l||(l=!0,(0,o.l)(()=>{try{i&&(0,n.Ar)()?.setItem(s,JSON.stringify(Array.from(i.entries())))}finally{l=!1}},{ensureExecution:!0}))}},26631:(e,t,r)=>{"use strict";r.d(t,{JR:()=>s,Km:()=>n,Ss:()=>c,Xg:()=>i});var o=r(34445);function n(e,t){switch(t){case"base64":return o.fromByteArray(e);case"utf8":case"utf-8":case void 0:return(new TextDecoder).decode(e);default:throw new Error("invalid/unsupported encoding")}}const i=(e,t)=>c.from(e,t).buffer,s=(e,t)=>c.from(e).toString(t);function a(e){const t=e;return e instanceof ArrayBuffer||"object"===typeof t&&null!==t&&"number"===typeof t.byteLength&&"function"===typeof t.slice&&void 0===t.byteOffset&&void 0===t.buffer}class c extends Uint8Array{toString(e){return n(this,e)}static from(e,t,r){if("string"===typeof e)return c.fromString(e,t);if(null!==e&&"object"===typeof e&&a(e.buffer))return c.fromArrayBuffer(e.buffer,e.byteOffset,e.byteLength);if(a(e))return c.fromArrayBuffer(e,t,r);throw new TypeError("Input value was neither a string nor an ArrayBuffer.")}static fromArrayBuffer(e,t,r){const o=t??0,n=r??e.byteLength-o;if(o<0||o>e.byteLength||n<0||n+o>e.byteLength)throw new RangeError("Invalid range specified.");return new c(e,o,n)}static fromString(e,t){switch(t){case"base64":{const t=this.sanitizeBase64(e),r=o.toByteArray(t);return new c(r.buffer)}case"utf8":case"utf-8":case void 0:{const t=(new TextEncoder).encode(e);return new c(t.buffer)}default:throw new Error("invalid/unsupported encoding")}}static isBuffer(e){throw new Error("unimplemented")}static sanitizeBase64(e){let t=e;if(t=t.split("=")[0],t=t.replace(/[^\w+-/]/g,""),t.length%4!==0){t+=["","===","==","="][t.length%4]}return t}}},27015:(e,t,r)=>{"use strict";function o(e){return e.origin.endsWith("onedrive.com")||e.origin.endsWith("storage.live.com")||e.origin.endsWith("storage.live-int.com")||e.origin.endsWith("onedrive-tst.com")}function n(e){let t="_api/";return o(e)&&(t=""),`${e.origin}/${t}v2.1`}function i(e){const t=new URL(e).hostname.toLowerCase();return t.endsWith(".sharepoint-df.com")?"SPDF":"microsoft.sharepoint.com"===t||"microsoft-my.sharepoint.com"===t?"MSIT":void 0}r.d(t,{ir:()=>i,je:()=>o,lA:()=>n})},27250:(e,t,r)=>{"use strict";r.d(t,{Bt:()=>h,Df:()=>m,ZK:()=>c,fV:()=>g,mc:()=>o,pW:()=>l});var o,n=r(87615),i=r(97813),s=r(63520),a=r(39521);function c(e){if(void 0===e||null===e)return;const t=Number(e);return Number.isNaN(t)?e:t}!function(e){e.CodeArtifact="CodeArtifact",e.UserData="UserData"}(o||(o={}));class d{static sanitizePkgName(e){return e.replace("@","").replace("/","-")}static prepareErrorObject(e,t,r){const{message:o,errorType:n,stack:i}=(0,a.AV)(t,!0);if(e.stack=i,e.error=o,e.errorType=n,(0,a.dy)(t)){const r=t.getTelemetryProperties();for(const t of Object.keys(r))void 0===e[t]&&(e[t]=r[t])}void 0===e.stack&&r&&(e.stack=(0,a.aX)())}constructor(e,t){this.namespace=e,this.properties=t}sendTelemetryEvent(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.$.default;this.sendTelemetryEventCore({...e,category:e.category??"generic"},t,"error"===e.category?i.$.error:r)}sendTelemetryEventCore(e,t,r){const o=function(e){let{category:t,eventName:r,...o}=e;const n={category:t,eventName:r};for(const i of Object.keys(o))n[i]=g(o[i]);return n}(e);var n;void 0!==t&&d.prepareErrorObject(o,t,!1),"number"===typeof o.duration&&(o.duration=(n=o.duration,Math.floor(n))),this.send(o,r)}sendErrorEvent(e,t){this.sendTelemetryEventCore({error:e.eventName,...e,category:"error"},t,i.$.error)}sendPerformanceEvent(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.$.default;const o={...e,category:e.category??"performance"};this.sendTelemetryEventCore(o,t,"error"===o.category?i.$.error:r)}prepareEvent(e){const t="error"===e.category||void 0!==e.error,r={...e};return void 0!==this.namespace&&(r.eventName=`${this.namespace}${d.eventNamespaceSeparator}${r.eventName}`),this.extendProperties(r,t)}extendProperties(e,t){const r=e;if(this.properties){const e=[];e.push(this.properties.all),t&&e.push(this.properties.error);for(const t of e)if(void 0!==t)for(const[e,o]of Object.entries(t)){if(void 0!==r[e])continue;const t="function"===typeof o?o():o;void 0!==t&&(r[e]=t)}}return e}}d.eventNamespaceSeparator=":";function l(e){return u.create(e?.logger,e?.namespace,e?.properties)}class u extends d{static create(e,t,r){if(e instanceof u){const o={};for(const t of[e.properties,r])void 0!==t&&(void 0!==t.all&&(o.all={...o.all,...t.all}),void 0!==t.error&&(o.error={...o.error,...t.error}));const n=void 0===e.namespace?t:void 0===t?e.namespace:`${e.namespace}${d.eventNamespaceSeparator}${t}`,i=new u(e.baseLogger,n,o);return!(0,s.uz)(i)&&(0,s.uz)(e)&&(0,s.fG)(i,e.config),i}return new u(e??{send(){}},t,r)}constructor(e,t,r){super(t,r),this.baseLogger=e,(0,s.uz)(e)&&(0,s.fG)(this,new s.G0(this,e.config))}get minLogLevel(){return this.baseLogger.minLogLevel}shouldFilterOutEvent(e,t){return(t??i.$.default)<(this.baseLogger.minLogLevel??i.$.default)}send(e,t){this.shouldFilterOutEvent(e,t)||this.baseLogger.send(this.prepareEvent(e),t)}}class h{static start(e,t,r){return new h(e,t,r,!(arguments.length>3&&void 0!==arguments[3])||arguments[3])}static timedExec(e,t,r,o){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;const i=h.start(e,t,o,h.shouldReport(t,n));try{const e=r(i);return i.autoEnd(),e}catch(s){throw i.cancel(void 0,s),s}}static async timedExecAsync(e,t,r,o){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;const i=h.start(e,t,o,h.shouldReport(t,n));try{const e=await r(i);return i.autoEnd(),e}catch(s){throw i.cancel(void 0,s),s}}get duration(){return(0,n.l)()-this.startTime}constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{end:!0,cancel:"generic"},o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.logger=e,this.markers=r,this.emitLogs=o,this.startTime=(0,n.l)(),this.event={...t},this.markers.start&&this.reportEvent("start"),"object"===typeof window&&void 0!==window?.performance?.mark&&null!==window?.performance?.mark&&(this.startMark=`${t.eventName}-start`,window.performance.mark(this.startMark))}reportProgress(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"update";this.reportEvent(t,e)}autoEnd(){this.event&&this.markers.end&&this.reportEvent("end"),this.performanceEndMark(),this.event=void 0}end(e){this.reportEvent("end",e),this.performanceEndMark(),this.event=void 0}performanceEndMark(){if(void 0!==this.startMark&&this.event){const e=`${this.event.eventName}-end`;window.performance.mark(e),window.performance.measure(`${this.event.eventName}`,this.startMark,e),this.startMark=void 0}}cancel(e,t){void 0!==this.markers.cancel&&this.reportEvent("cancel",{category:this.markers.cancel,...e},t),this.event=void 0}reportEvent(e,t,r){if(!this.event)return;if(!this.emitLogs)return;const o={...this.event,...t};o.eventName=`${o.eventName}_${e}`,"start"!==e&&(o.duration=this.duration),this.logger.sendPerformanceEvent(o,r)}static shouldReport(e,t){const r=`.${e.category}.${e.eventName}`,o=h.eventHits.get(r)??0;return h.eventHits.set(r,o>=t?1:o+1),o%t===0}}function g(e){return(0,a.qp)(e)?{value:p(e.value),tag:e.tag}:p(e)}function p(e){switch(typeof e){case"string":case"number":case"boolean":case"undefined":return e;case"object":return JSON.stringify(e);default:return console.error(`convertToBasePropertyTypeUntagged: INVALID PROPERTY (typed as ${typeof e})`),`INVALID PROPERTY (typed as ${typeof e})`}}h.eventHits=new Map;const m=e=>((e,t)=>Object.entries(t).filter(e=>void 0!==e[1]).reduce((t,r)=>{const[o,n]=r;return t[o]="function"===typeof n?()=>({tag:e,value:n()}):{tag:e,value:n},t},{}))(o.CodeArtifact,e)},27284:e=>{"use strict";var t,r="object"===typeof Reflect?Reflect:null,o=r&&"function"===typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"===typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var n=Number.isNaN||function(e){return e!==e};function i(){i.init.call(this)}e.exports=i,e.exports.once=function(e,t){return new Promise(function(r,o){function n(r){e.removeListener(t,i),o(r)}function i(){"function"===typeof e.removeListener&&e.removeListener("error",n),r([].slice.call(arguments))}m(e,t,i,{once:!0}),"error"!==t&&function(e,t,r){"function"===typeof e.on&&m(e,"error",t,r)}(e,n,{once:!0})})},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var s=10;function a(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}function d(e,t,r,o){var n,i,s,d;if(a(r),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),s=i[t]),void 0===s)s=i[t]=r,++e._eventsCount;else if("function"===typeof s?s=i[t]=o?[r,s]:[s,r]:o?s.unshift(r):s.push(r),(n=c(e))>0&&s.length>n&&!s.warned){s.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=s.length,d=l,console&&console.warn&&console.warn(d)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function u(e,t,r){var o={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},n=l.bind(o);return n.listener=r,o.wrapFn=n,n}function h(e,t,r){var o=e._events;if(void 0===o)return[];var n=o[t];return void 0===n?[]:"function"===typeof n?r?[n.listener||n]:[n]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(n):p(n,n.length)}function g(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"===typeof r)return 1;if(void 0!==r)return r.length}return 0}function p(e,t){for(var r=new Array(t),o=0;o<t;++o)r[o]=e[o];return r}function m(e,t,r,o){if("function"===typeof e.on)o.once?e.once(t,r):e.on(t,r);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,function n(i){o.once&&e.removeEventListener(t,n),r(i)})}}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!==typeof e||e<0||n(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||n(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},i.prototype.getMaxListeners=function(){return c(this)},i.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=i[e];if(void 0===c)return!1;if("function"===typeof c)o(c,this,t);else{var d=c.length,l=p(c,d);for(r=0;r<d;++r)o(l[r],this,t)}return!0},i.prototype.addListener=function(e,t){return d(this,e,t,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(e,t){return d(this,e,t,!0)},i.prototype.once=function(e,t){return a(t),this.on(e,u(this,e,t)),this},i.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,u(this,e,t)),this},i.prototype.removeListener=function(e,t){var r,o,n,i,s;if(a(t),void 0===(o=this._events))return this;if(void 0===(r=o[e]))return this;if(r===t||r.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete o[e],o.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!==typeof r){for(n=-1,i=r.length-1;i>=0;i--)if(r[i]===t||r[i].listener===t){s=r[i].listener,n=i;break}if(n<0)return this;0===n?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,n),1===r.length&&(o[e]=r[0]),void 0!==o.removeListener&&this.emit("removeListener",e,s||t)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(e){var t,r,o;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var n,i=Object.keys(r);for(o=0;o<i.length;++o)"removeListener"!==(n=i[o])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(o=t.length-1;o>=0;o--)this.removeListener(e,t[o]);return this},i.prototype.listeners=function(e){return h(this,e,!0)},i.prototype.rawListeners=function(e){return h(this,e,!1)},i.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):g.call(e,t)},i.prototype.listenerCount=g,i.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},27377:(e,t,r)=>{"use strict";r.d(t,{O:()=>g,_:()=>h});r(65043);const o=r.p+"static/media/DarkBackground.f9c4b682680f49530d388ba0f2830809.svg";const n=r.p+"static/media/LightBackground.d93751152f3824d76f84f995fec9752f.svg";const i=r.p+"static/media/LightShimmerLoading.838ac9544853d68b3b1b62a5009ecef8.svg";const s=r.p+"static/media/DarkShimmerLoading.5bd608fb2a16127c459c6027848848ce.svg";const a=r.p+"static/media/DarkBackground_Old.df15325639cb5218602d4da3c7467955.svg";const c=r.p+"static/media/LightBackground_Old.f5416049e2f7d9abee2b5d9386b6fe77.svg";const d=r.p+"static/media/LightShimmerLoading_Old.ea2f880c2eab4e2bba069ba794390732.svg";const l=r.p+"static/media/DarkShimmerLoading_Old.e340d47723d2a30dc95ec74facf4f8b6.svg";var u=r(58443);function h(){const e=document.getElementById(u.bY),t=document.getElementById(u.xu);e&&(e.hidden=!0),null===t||void 0===t||t.removeAttribute("hidden")}function g(e,t){return t?e?{background:o,shimmer:s}:{background:n,shimmer:i}:e?{background:a,shimmer:l}:{background:c,shimmer:d}}},27586:(e,t,r)=>{"use strict";r.d(t,{S:()=>o});const o={durationUltraFast:"50ms",durationFaster:"100ms",durationFast:"150ms",durationNormal:"200ms",durationGentle:"250ms",durationSlow:"300ms",durationSlower:"400ms",durationUltraSlow:"500ms"}},27612:(e,t,r)=>{"use strict";r.d(t,{z:()=>o});const o="2.23.0"},27750:(e,t,r)=>{"use strict";var o;r.d(t,{Z:()=>o}),function(e){e.Tree=1,e.Blob=2,e.Handle=3,e.Attachment=4}(o||(o={}))},27901:(e,t,r)=>{"use strict";function o(){return`${n()+n()}-${n()}-${n()}-${n()}-${n()}${n()}${n()}`}function n(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}r.d(t,{_:()=>o})},28014:(e,t,r)=>{"use strict";r.d(t,{x:()=>c});var o=r(22751),n=r(98256);const i="--ms-themeColorPalette",s="--ms-themeColor";function a(e,t){return e.hasOwnProperty(t)}function c(e){const t=e?(0,n.P)(e):void 0,r={},c={},l=(0,o.a)(),u=(e,t)=>{if(e.startsWith(i)){const o=function(e){const t="--ms-themeColorPaletteShared",r="--ms-themeColorPaletteAccent";if(e.startsWith(t))return d(e,t);if(e.startsWith(r))return d(e,r);if(e.startsWith(i))return d(e,i);return}(e);void 0!==o&&a(l.palette,o)&&!r[o]&&(r[o]=t)}else if(e.startsWith(s)){const r=d(e,s);r&&a(l.semanticColors,r)&&!c[r]&&(c[r]=t)}};if(t)for(const o of t)u(o.name,o.value);return(0,o.a)({palette:r,semanticColors:c})}function d(e,t){const r=e.substring(t.length);return`${r.substring(0,1).toLowerCase()}${r.substring(1)}`}},28205:(e,t,r)=>{"use strict";r.d(t,{Ae:()=>D,bz:()=>N,kG:()=>F,GJ:()=>I});var o,n=r(56851),i=r(63722),s={};function a(e,t){var r=e[t];"-"!==r.charAt(0)&&(e[t]=s[r]=s[r]||r.replace(/([A-Z])/g,"-$1").toLowerCase())}var c={"user-select":1};function d(e,t){var r=function(){var e;if(!o){var t="undefined"!==typeof document?document:void 0,r="undefined"!==typeof navigator?navigator:void 0,n=null===(e=null===r||void 0===r?void 0:r.userAgent)||void 0===e?void 0:e.toLowerCase();o=t?{isWebkit:!(!t||!("WebkitAppearance"in t.documentElement.style)),isMoz:!!(n&&n.indexOf("firefox")>-1),isOpera:!!(n&&n.indexOf("opera")>-1),isMs:!(!r||!/rv:11.0/i.test(r.userAgent)&&!/Edge\/\d./i.test(navigator.userAgent))}:{isWebkit:!0,isMoz:!0,isOpera:!0,isMs:!0}}return o}(),n=e[t];if(c[n]){var i=e[t+1];c[n]&&(r.isWebkit&&e.push("-webkit-"+n,i),r.isMoz&&e.push("-moz-"+n,i),r.isMs&&e.push("-ms-"+n,i),r.isOpera&&e.push("-o-"+n,i))}}var l,u=["column-count","font-weight","flex","flex-grow","flex-shrink","fill-opacity","opacity","order","z-index","zoom"];function h(e,t){var r=e[t],o=e[t+1];if("number"===typeof o){var n=u.indexOf(r)>-1,i=r.indexOf("--")>-1,s=n||i?"":"px";e[t+1]="".concat(o).concat(s)}}var g="left",p="right",m="@noflip",f=((l={})[g]=p,l[p]=g,l),v={"w-resize":"e-resize","sw-resize":"se-resize","nw-resize":"ne-resize"};function y(e,t,r){if(e.rtl){var o=t[r];if(!o)return;var n=t[r+1];if("string"===typeof n&&n.indexOf(m)>=0)t[r+1]=n.replace(/\s*(?:\/\*\s*)?\@noflip\b(?:\s*\*\/)?\s*?/g,"");else if(o.indexOf(g)>=0)t[r]=o.replace(g,p);else if(o.indexOf(p)>=0)t[r]=o.replace(p,g);else if(String(n).indexOf(g)>=0)t[r+1]=n.replace(g,p);else if(String(n).indexOf(p)>=0)t[r+1]=n.replace(p,g);else if(f[o])t[r]=f[o];else if(v[n])t[r+1]=v[n];else switch(o){case"margin":case"padding":t[r+1]=function(e){if("string"===typeof e){var t=e.split(" ");if(4===t.length)return"".concat(t[0]," ").concat(t[3]," ").concat(t[2]," ").concat(t[1])}return e}(n);break;case"box-shadow":t[r+1]=function(e,t){var r=e.split(" "),o=parseInt(r[t],10);return r[0]=r[0].replace(String(o),String(-1*o)),r.join(" ")}(n,0)}}}var b="displayName";var S=/\:global\((.+?)\)/g;function C(e){return e.indexOf(":global(")>=0||0===e.indexOf(":")}function k(e,t){return e.indexOf(":global(")>=0?e.replace(S,"$1"):0===e.indexOf(":host(")?e:0===e.indexOf(":")?t+e:e.indexOf("&")<0?t+" "+e:e}function w(e,t,r,o,n){void 0===t&&(t={__order:[]}),0===r.indexOf("@")?P([o],t,r=r+"{"+e,n):r.indexOf(",")>-1?function(e){if(!S.test(e))return e;for(var t=[],r=/\:global\((.+?)\)/g,o=null;o=r.exec(e);)o[1].indexOf(",")>-1&&t.push([o.index,o.index+o[0].length,o[1].split(",").map(function(e){return":global(".concat(e.trim(),")")}).join(", ")]);return t.reverse().reduce(function(e,t){var r=t[0],o=t[1],n=t[2];return e.slice(0,r)+n+e.slice(o)},e)}(r).split(",").map(function(e){return e.trim()}).forEach(function(r){return P([o],t,k(r,e),n)}):P([o],t,k(r,e),n)}function P(e,t,r,o){void 0===t&&(t={__order:[]}),void 0===r&&(r="&");var n=t[r];n||(n={},t[r]=n,t.__order.push(r));for(var i=0,s=e;i<s.length;i++){var a=s[i];if("string"===typeof a){var c=o.argsFromClassName(a);c&&P(c,t,r,o)}else if(Array.isArray(a))P(a,t,r,o);else for(var d in a)if(a.hasOwnProperty(d)){var l=a[d];if("selectors"===d){var u=a.selectors;for(var h in u)u.hasOwnProperty(h)&&w(r,t,h,u[h],o)}else"object"===typeof l||C(d)?null!==l&&void 0!==l&&w(r,t,d,l,o):void 0!==l&&("margin"===d||"padding"===d?T(n,d,l):n[d]=l)}}return t}function T(e,t,r){var o="string"===typeof r?function(e){for(var t=[],r=0,o=0,n=0;n<e.length;n++)switch(e[n]){case"(":o++;break;case")":o&&o--;break;case"\t":case" ":o||(n>r&&t.push(e.substring(r,n)),r=n+1)}return r<e.length&&t.push(e.substring(r)),t}(r):[r];0===o.length&&o.push(r),"!important"===o[o.length-1]&&(o=o.slice(0,-1).map(function(e){return e+" !important"})),e[t+"Top"]=o[0],e[t+"Right"]=o[1]||o[0],e[t+"Bottom"]=o[2]||o[0],e[t+"Left"]=o[3]||o[1]||o[0]}function E(e,t){return t<=0?"":1===t?e:e+E(e,t-1)}function N(e,t){if(!t)return"";var r=[];for(var o in t)t.hasOwnProperty(o)&&o!==b&&void 0!==t[o]&&r.push(o,t[o]);for(var n=0;n<r.length;n+=2)a(r,n),h(r,n),y(e,r,n),d(r,n);for(n=1;n<r.length;n+=4)r.splice(n,1,":",r[n],";");return r.join("")}function I(e){for(var t,r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];var n=null!==(t=e.stylesheet)&&void 0!==t?t:i.nr.getInstance(e.shadowConfig),s=P(r,void 0,void 0,n),a=function(e,t){for(var r=[e.rtl?"rtl":"ltr"],o=!1,n=0,i=t.__order;n<i.length;n++){var s=i[n];r.push(s);var a=t[s];for(var c in a)a.hasOwnProperty(c)&&void 0!==a[c]&&(o=!0,r.push(c,a[c]))}return o?r.join(""):void 0}(e,s);if(a){var c={className:n.classNameFromKey(a),key:a,args:r};if(!c.className){c.className=n.getClassName(function(e){var t=e&&e["&"];return t?t.displayName:void 0}(s));for(var d=[],l=0,u=s.__order;l<u.length;l++){var h=u[l];d.push(h,N(e,s[h]))}c.rulesToInsert=d}return c}}function D(e,t,r,o){void 0===t&&(t=1);var n=null!==o&&void 0!==o?o:i.nr.getInstance(r),s=e.className,a=e.key,c=e.args,d=e.rulesToInsert;if(d){for(var l=0;l<d.length;l+=2){var u=d[l+1];if(u){var h=d[l];h=h.replace(/&/g,E(".".concat(e.className),t));var g="".concat(h,"{").concat(u,"}").concat(0===h.indexOf("@")?"}":"");n.insertRule(g)}}n.cacheClassName(s,a,c,d)}}function F(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var o=I.apply(void 0,(0,n.__spreadArray)([e],t,!1));return o?(D(o,e.specificityMultiplier,e.shadowConfig,e.stylesheet),o.className):""}},29018:(e,t,r)=>{"use strict";function o(e){return new URL(e).origin}r.d(t,{$:()=>o})},29900:(e,t,r)=>{"use strict";r.d(t,{E:()=>c,q:()=>a});var o=r(56851),n=r(82770),i=r(12283),s=r(50406),a=function(){return(a="object"===typeof self&&"object"===typeof self.performance&&"function"===typeof self.performance.now?function(){return self.performance.now()}:function(){return Date.now()})()},c=function(e){var t,r=a(),d=(0,s.EY)(e.telemetryEvent);return(0,o.__assign)((0,o.__assign)({cv:e.parentCv.getNext()},d),{createChildActivity:function(t){return c({telemetryEvent:t,sendTelemetryEvent:e.sendTelemetryEvent,parentCv:this.cv})},setResult:function(e,t,r){this.result={code:e,type:t,tag:r}},endNow:function(){var o,s,c=this;if(!t){void 0===this.success&&void 0===this.result&&(0,i.wC)(1,0,function(){return"Activity does not have success or result set"});var d=a(),l=Math.floor(1e3*(d-r));t=!0;var u={duration:l,count:1,aggMode:0,cV:this.cv.value,success:this.success,result:this.result},h=null!==(s=null===(o=this.eventContract)||void 0===o?void 0:o.dataFields)&&void 0!==s?s:[];return h.push.apply(h,n.Il.getFields(u)),this.eventContract={name:n.Il.contractName,dataFields:h},e.sendTelemetryEvent(this)}(0,i.wC)(0,0,function(){return"'".concat(c.eventName,"' already ended")})}})}},29951:(e,t,r)=>{"use strict";function o(e){return e}function n(e){return e}r.d(t,{P:()=>n,k:()=>o})},29967:(e,t,r)=>{"use strict";r.d(t,{o:()=>a});var o=r(25418),n=r(83125),i=r(25969),s=r(14836);function a(e,t,r,a){const c=t&&new n.p("OdspUrlResolver",t),d="UnauthenticatedGuest"===e.identityType?void 0:{tokenFetcher:r=>e.getToken((0,i.K)(r.siteUrl),(0,s.r)(r,t)),identityType:e.identityType||"Enterprise"};return new o.s(d,c,r?.appName,a)}},31482:(e,t,r)=>{"use strict";r.d(t,{o:()=>i});var o=r(45799),n=r(65922);const i=(0,o.a)(n.oZ)},31942:(e,t,r)=>{"use strict";var o;r.d(t,{S:()=>o}),function(e){e.fixedByHost="fixedByHost",e.grow="grow",e.growHeight="growHeight"}(o||(o={}))},32896:(e,t,r)=>{"use strict";r.d(t,{a:()=>o});const o=function(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"low",i=3;return function s(){return n(e,t,r,o).catch(()=>(i-=1,0===i?n(e,t,r,o):s()))}()};async function n(e,t,r,o){return new Promise((n,i)=>{const s=e.document,a=s.createElement("script");a.setAttribute("fetchpriority",o);const c=r?.trustedTypesPolicy?.createScriptURL(t,{allowedScriptOrigins:r.allowedOrigins})??t;a.src=c,a.async=!1,a.charset="utf-8",a.crossOrigin="anonymous",a.onload=n,a.onerror=()=>i(new Error(`Failed to download the script at url: ${t}, isUserDefinitelyOffline: ${!e.navigator.onLine}`)),s.head.appendChild(a)})}},33669:(e,t,r)=>{"use strict";r.d(t,{o:()=>n});class o{constructor(e,t){this.expiry=e,this.cleanup=t,this.gcTimeouts=new Map}schedule(e){"indefinite"!==this.expiry.policy&&this.gcTimeouts.set(e,setTimeout(()=>{this.cleanup(e),this.cancel(e)},this.expiry.durationMs))}cancel(e){const t=this.gcTimeouts.get(e);void 0!==t&&(clearTimeout(t),this.gcTimeouts.delete(e))}update(e){"sliding"===this.expiry.policy&&(this.cancel(e),this.schedule(e))}}class n{constructor(){let{expiry:e={policy:"indefinite"},removeOnError:t=()=>!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.cache=new Map,this.removeOnError=t,this.gc=new o(e,e=>this.remove(e))}has(e){return this.cache.has(e)}get(e){return this.has(e)&&this.gc.update(e),this.cache.get(e)}remove(e){return this.gc.cancel(e),this.cache.delete(e)}async addOrGet(e,t){let r=this.get(e);if(void 0===r){r=(async()=>t())(),this.cache.set(e,r),r.catch(t=>{this.removeOnError(t)&&this.remove(e)}),this.gc.schedule(e)}return r}add(e,t){const r=this.has(e);return this.addOrGet(e,t).catch(()=>{}),!r}async addValueOrGet(e,t){return this.addOrGet(e,async()=>t)}addValue(e,t){return this.add(e,async()=>t)}}},33788:(e,t,r)=>{"use strict";r.d(t,{m:()=>s});var o=r(15851),n=r(95996);const i=new Set;class s{constructor(e,t,r){this.activityName=e,this.logger=t,this.isAPerformanceMetric=!1,this.additionalPropsToLog=r?.additionalPropsToLog,this.addUserTiming=r?.addUserTiming,this.isAPerformanceMetric=r?.isAPerformanceMetric||!1,this.logSubactivityStartTimes=r?.logSubactivityStartTimes??!0,this.subActivities={},this.identifier=crypto.randomUUID(),this.activityStartName=`${this.activityName}-start-${this.identifier}`,this.activityEndName=`${this.activityName}-end-${this.identifier}`,this.addUserTiming&&performance.mark(this.activityStartName),this.startTime=performance.now(),this.startTimeSinceEpoch=Date.now()}static start(e,t,r){const o=new s(e,t,r);return i.add(o),o}markSubActivityStart(e){this.subActivities[e]={startTime:performance.now(),startTimeSinceEpoch:Date.now()},this.addUserTiming&&performance.mark(this.getSubActivityName(e,"start"))}markSubActivityEnd(e,t){const r=this.subActivities[e];if(!r)return;if(this.addUserTiming){const t=this.getSubActivityName(e,"end");performance.mark(t),performance.measure(e,this.getSubActivityName(e,"start"),t)}const o={[`durationMs_${e}`]:Math.round(performance.now()-r.startTime)};this.logSubactivityStartTimes&&(o[`startTime_${e}`]=r.startTimeSinceEpoch),this.additionalPropsToLog={...o,...this.additionalPropsToLog,...t}}setResult(e,t,r,o){this.logActivityResult(e,t,r,o?.skipLogging,void 0,o?.sampleEvent)}cancel(e,t,r){this.logActivityResult(e,t,r,!1,!0)}addAdditionalProps(e){this.additionalPropsToLog={...this.additionalPropsToLog,...e}}dispose(){this.cancel();const e=e=>performance.clearMarks(e),t=e=>performance.clearMeasures(e);if(this.addUserTiming){e(this.activityStartName),e(this.activityEndName),this.cachedMeasureName&&t(this.cachedMeasureName);for(const r in this.subActivities)e(this.getSubActivityName(r,"start")),e(this.getSubActivityName(r,"end")),t(r)}}logActivityResult(e,t,r,s,a,c){if(this.hasAlreadyResolved)return;this.hasAlreadyResolved=!0,this.addUserTiming&&performance.mark(this.activityEndName);const d=performance.now(),l=Math.round(d-this.startTime);if(this.isAPerformanceMetric){(window._pageTimings||(window._pageTimings={}))[this.activityName]=t?.durationMs?Number(t.durationMs):l}if(this.logger&&!s){const i={eventName:this.activityName,startTime:this.startTimeSinceEpoch,durationMs:l,succeeded:e,sampleEvent:c,resultType:a?o.Tp.Cancelled:e?o.Tp.Success:o.Tp.Failure,...this.additionalPropsToLog,...t};(0,n.IA)(this.logger,i,r)}this.logger=void 0,i.delete(this),this.addUserTiming&&performance.measure(this.generateMeasureName(e),this.activityStartName,this.activityEndName)}generateMeasureName(e){return this.cachedMeasureName=`${this.activityName}${!1===e?"-FAILED":""}-${this.identifier}`,this.cachedMeasureName}getSubActivityName(e,t){return`${e}-${t}-${this.identifier}`}}},33829:(e,t,r)=>{"use strict";r.d(t,{As:()=>c,CD:()=>l,R2:()=>u,TN:()=>h,VN:()=>p,Vb:()=>d,bv:()=>g,dR:()=>s,sc:()=>a});var o=r(16460),n=r(91947),i=r(90662);function s(e){(0,o.gp)(t=>{const r=t.detail.isDarkBackground;e.forEach(e=>{e(r)})})}function a(e){(0,o.fQ)(t=>{const r=t.detail.newTheme,o=(0,i.g4)(r);e.forEach(e=>{e(o)})})}function c(e){(0,o.hj)(t=>{e(t.detail.documentUrl,t.detail.linkScope)})}async function d(e){(0,o.WU)(t=>{e(t.detail.linkProblemState)});const t=(await(0,n.KE)()).linkProblemState;t&&e(t)}function l(e){(0,o.$h)(t=>{t.detail.isPermissionError&&e(o.$R.Error)})}function u(e){(0,o.ED)(t=>{const r=t.detail.isContentHeightLimited;e(r)})}function h(e){(0,o.Md)(t=>{const r=t.detail.showLoopGlowBorder;e(r)})}function g(e){(0,o.us)(t=>{const r=t.detail.isHeader;e(r)})}function p(e){(0,o.gC)(t=>{e(t.detail.isReadOnly)})}},34023:(e,t,r)=>{"use strict";r.d(t,{k:()=>o});const o={genericError:"genericError",throttlingError:"throttlingError",dataCorruptionError:"dataCorruptionError",dataProcessingError:"dataProcessingError",usageError:"usageError"}},34170:(e,t,r)=>{"use strict";r.r(t),r.d(t,{LoopRegistrationId:()=>Wh,NpmCodeLoaderFactory:()=>ep,PowerBIPortableComponent:()=>Qh,loopExport:()=>Yh});var o=r(57833),n=r(9580),i=r(75368),s=r(15834),a=r(27284),c="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof r.g?r.g:"undefined"!==typeof self?self:{},d=function(e){return e&&e.Math===Math&&e},l=d("object"==typeof globalThis&&globalThis)||d("object"==typeof window&&window)||d("object"==typeof self&&self)||d("object"==typeof c&&c)||d("object"==typeof c&&c)||function(){return this}()||Function("return this")(),u={},h=function(e){try{return!!e()}catch(t){return!0}},g=!h(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}),p=!h(function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}),m=p,f=Function.prototype.call,v=m?f.bind(f):function(){return f.apply(f,arguments)},y={},b={}.propertyIsEnumerable,S=Object.getOwnPropertyDescriptor,C=S&&!b.call({1:2},1);y.f=C?function(e){var t=S(this,e);return!!t&&t.enumerable}:b;var k,w,P=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},T=p,E=Function.prototype,N=E.call,I=T&&E.bind.bind(N,N),D=T?I:function(e){return function(){return N.apply(e,arguments)}},F=D,B=F({}.toString),L=F("".slice),x=function(e){return L(B(e),8,-1)},A=h,O=x,M=Object,_=D("".split),R=A(function(){return!M("z").propertyIsEnumerable(0)})?function(e){return"String"===O(e)?_(e,""):M(e)}:M,H=function(e){return null===e||void 0===e},U=H,j=TypeError,q=function(e){if(U(e))throw new j("Can't call method on "+e);return e},z=R,V=q,$=function(e){return z(V(e))},G="object"==typeof document&&document.all,W="undefined"==typeof G&&void 0!==G?function(e){return"function"==typeof e||e===G}:function(e){return"function"==typeof e},J=W,K=function(e){return"object"==typeof e?null!==e:J(e)},Q=l,Y=W,Z=function(e,t){return arguments.length<2?(r=Q[e],Y(r)?r:void 0):Q[e]&&Q[e][t];var r},X=D({}.isPrototypeOf),ee="undefined"!=typeof navigator&&String(navigator.userAgent)||"",te=l,re=ee,oe=te.process,ne=te.Deno,ie=oe&&oe.versions||ne&&ne.version,se=ie&&ie.v8;se&&(w=(k=se.split("."))[0]>0&&k[0]<4?1:+(k[0]+k[1])),!w&&re&&(!(k=re.match(/Edge\/(\d+)/))||k[1]>=74)&&(k=re.match(/Chrome\/(\d+)/))&&(w=+k[1]);var ae=w,ce=ae,de=h,le=l.String,ue=!!Object.getOwnPropertySymbols&&!de(function(){var e=Symbol("symbol detection");return!le(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&ce&&ce<41}),he=ue&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,ge=Z,pe=W,me=X,fe=Object,ve=he?function(e){return"symbol"==typeof e}:function(e){var t=ge("Symbol");return pe(t)&&me(t.prototype,fe(e))},ye=String,be=function(e){try{return ye(e)}catch(t){return"Object"}},Se=W,Ce=be,ke=TypeError,we=function(e){if(Se(e))return e;throw new ke(Ce(e)+" is not a function")},Pe=we,Te=H,Ee=function(e,t){var r=e[t];return Te(r)?void 0:Pe(r)},Ne=v,Ie=W,De=K,Fe=TypeError,Be={exports:{}},Le=l,xe=Object.defineProperty,Ae=function(e,t){try{xe(Le,e,{value:t,configurable:!0,writable:!0})}catch(r){Le[e]=t}return t},Oe=l,Me=Ae,_e="__core-js_shared__",Re=Be.exports=Oe[_e]||Me(_e,{});(Re.versions||(Re.versions=[])).push({version:"3.36.1",mode:"global",copyright:"\xa9 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.36.1/LICENSE",source:"https://github.com/zloirock/core-js"});var He=Be.exports,Ue=He,je=function(e,t){return Ue[e]||(Ue[e]=t||{})},qe=q,ze=Object,Ve=function(e){return ze(qe(e))},$e=Ve,Ge=D({}.hasOwnProperty),We=Object.hasOwn||function(e,t){return Ge($e(e),t)},Je=D,Ke=0,Qe=Math.random(),Ye=Je(1..toString),Ze=function(e){return"Symbol("+(void 0===e?"":e)+")_"+Ye(++Ke+Qe,36)},Xe=je,et=We,tt=Ze,rt=ue,ot=he,nt=l.Symbol,it=Xe("wks"),st=ot?nt.for||nt:nt&&nt.withoutSetter||tt,at=function(e){return et(it,e)||(it[e]=rt&&et(nt,e)?nt[e]:st("Symbol."+e)),it[e]},ct=v,dt=K,lt=ve,ut=Ee,ht=function(e,t){var r,o;if("string"===t&&Ie(r=e.toString)&&!De(o=Ne(r,e)))return o;if(Ie(r=e.valueOf)&&!De(o=Ne(r,e)))return o;if("string"!==t&&Ie(r=e.toString)&&!De(o=Ne(r,e)))return o;throw new Fe("Can't convert object to primitive value")},gt=TypeError,pt=at("toPrimitive"),mt=function(e,t){if(!dt(e)||lt(e))return e;var r,o=ut(e,pt);if(o){if(void 0===t&&(t="default"),r=ct(o,e,t),!dt(r)||lt(r))return r;throw new gt("Can't convert object to primitive value")}return void 0===t&&(t="number"),ht(e,t)},ft=ve,vt=function(e){var t=mt(e,"string");return ft(t)?t:t+""},yt=K,bt=l.document,St=yt(bt)&&yt(bt.createElement),Ct=function(e){return St?bt.createElement(e):{}},kt=Ct,wt=!g&&!h(function(){return 7!==Object.defineProperty(kt("div"),"a",{get:function(){return 7}}).a}),Pt=g,Tt=v,Et=y,Nt=P,It=$,Dt=vt,Ft=We,Bt=wt,Lt=Object.getOwnPropertyDescriptor;u.f=Pt?Lt:function(e,t){if(e=It(e),t=Dt(t),Bt)try{return Lt(e,t)}catch(r){}if(Ft(e,t))return Nt(!Tt(Et.f,e,t),e[t])};var xt={},At=g&&h(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype}),Ot=K,Mt=String,_t=TypeError,Rt=function(e){if(Ot(e))return e;throw new _t(Mt(e)+" is not an object")},Ht=g,Ut=wt,jt=At,qt=Rt,zt=vt,Vt=TypeError,$t=Object.defineProperty,Gt=Object.getOwnPropertyDescriptor,Wt="enumerable",Jt="configurable",Kt="writable";xt.f=Ht?jt?function(e,t,r){if(qt(e),t=zt(t),qt(r),"function"===typeof e&&"prototype"===t&&"value"in r&&Kt in r&&!r[Kt]){var o=Gt(e,t);o&&o[Kt]&&(e[t]=r.value,r={configurable:Jt in r?r[Jt]:o[Jt],enumerable:Wt in r?r[Wt]:o[Wt],writable:!1})}return $t(e,t,r)}:$t:function(e,t,r){if(qt(e),t=zt(t),qt(r),Ut)try{return $t(e,t,r)}catch(o){}if("get"in r||"set"in r)throw new Vt("Accessors not supported");return"value"in r&&(e[t]=r.value),e};var Qt=xt,Yt=P,Zt=g?function(e,t,r){return Qt.f(e,t,Yt(1,r))}:function(e,t,r){return e[t]=r,e},Xt={exports:{}},er=g,tr=We,rr=Function.prototype,or=er&&Object.getOwnPropertyDescriptor,nr=tr(rr,"name"),ir={PROPER:nr&&"something"===function(){}.name,CONFIGURABLE:nr&&(!er||er&&or(rr,"name").configurable)},sr=W,ar=He,cr=D(Function.toString);sr(ar.inspectSource)||(ar.inspectSource=function(e){return cr(e)});var dr,lr,ur,hr=ar.inspectSource,gr=W,pr=l.WeakMap,mr=gr(pr)&&/native code/.test(String(pr)),fr=Ze,vr=je("keys"),yr=function(e){return vr[e]||(vr[e]=fr(e))},br={},Sr=mr,Cr=l,kr=K,wr=Zt,Pr=We,Tr=He,Er=yr,Nr=br,Ir="Object already initialized",Dr=Cr.TypeError,Fr=Cr.WeakMap;if(Sr||Tr.state){var Br=Tr.state||(Tr.state=new Fr);Br.get=Br.get,Br.has=Br.has,Br.set=Br.set,dr=function(e,t){if(Br.has(e))throw new Dr(Ir);return t.facade=e,Br.set(e,t),t},lr=function(e){return Br.get(e)||{}},ur=function(e){return Br.has(e)}}else{var Lr=Er("state");Nr[Lr]=!0,dr=function(e,t){if(Pr(e,Lr))throw new Dr(Ir);return t.facade=e,wr(e,Lr,t),t},lr=function(e){return Pr(e,Lr)?e[Lr]:{}},ur=function(e){return Pr(e,Lr)}}var xr={set:dr,get:lr,has:ur,enforce:function(e){return ur(e)?lr(e):dr(e,{})},getterFor:function(e){return function(t){var r;if(!kr(t)||(r=lr(t)).type!==e)throw new Dr("Incompatible receiver, "+e+" required");return r}}},Ar=D,Or=h,Mr=W,_r=We,Rr=g,Hr=ir.CONFIGURABLE,Ur=hr,jr=xr.enforce,qr=xr.get,zr=String,Vr=Object.defineProperty,$r=Ar("".slice),Gr=Ar("".replace),Wr=Ar([].join),Jr=Rr&&!Or(function(){return 8!==Vr(function(){},"length",{value:8}).length}),Kr=String(String).split("String"),Qr=Xt.exports=function(e,t,r){"Symbol("===$r(zr(t),0,7)&&(t="["+Gr(zr(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!_r(e,"name")||Hr&&e.name!==t)&&(Rr?Vr(e,"name",{value:t,configurable:!0}):e.name=t),Jr&&r&&_r(r,"arity")&&e.length!==r.arity&&Vr(e,"length",{value:r.arity});try{r&&_r(r,"constructor")&&r.constructor?Rr&&Vr(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(n){}var o=jr(e);return _r(o,"source")||(o.source=Wr(Kr,"string"==typeof t?t:"")),e};Function.prototype.toString=Qr(function(){return Mr(this)&&qr(this).source||Ur(this)},"toString");var Yr=Xt.exports,Zr=W,Xr=xt,eo=Yr,to=Ae,ro=function(e,t,r,o){o||(o={});var n=o.enumerable,i=void 0!==o.name?o.name:t;if(Zr(r)&&eo(r,i,o),o.global)n?e[t]=r:to(t,r);else{try{o.unsafe?e[t]&&(n=!0):delete e[t]}catch(s){}n?e[t]=r:Xr.f(e,t,{value:r,enumerable:!1,configurable:!o.nonConfigurable,writable:!o.nonWritable})}return e},oo={},no=Math.ceil,io=Math.floor,so=Math.trunc||function(e){var t=+e;return(t>0?io:no)(t)},ao=function(e){var t=+e;return t!==t||0===t?0:so(t)},co=ao,lo=Math.max,uo=Math.min,ho=ao,go=Math.min,po=function(e){var t=ho(e);return t>0?go(t,9007199254740991):0},mo=function(e){return po(e.length)},fo=$,vo=function(e,t){var r=co(e);return r<0?lo(r+t,0):uo(r,t)},yo=mo,bo=function(e){return function(t,r,o){var n=fo(t),i=yo(n);if(0===i)return!e&&-1;var s,a=vo(o,i);if(e&&r!==r){for(;i>a;)if((s=n[a++])!==s)return!0}else for(;i>a;a++)if((e||a in n)&&n[a]===r)return e||a||0;return!e&&-1}},So={includes:bo(!0),indexOf:bo(!1)},Co=We,ko=$,wo=So.indexOf,Po=br,To=D([].push),Eo=function(e,t){var r,o=ko(e),n=0,i=[];for(r in o)!Co(Po,r)&&Co(o,r)&&To(i,r);for(;t.length>n;)Co(o,r=t[n++])&&(~wo(i,r)||To(i,r));return i},No=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Io=Eo,Do=No.concat("length","prototype");oo.f=Object.getOwnPropertyNames||function(e){return Io(e,Do)};var Fo={};Fo.f=Object.getOwnPropertySymbols;var Bo=Z,Lo=oo,xo=Fo,Ao=Rt,Oo=D([].concat),Mo=Bo("Reflect","ownKeys")||function(e){var t=Lo.f(Ao(e)),r=xo.f;return r?Oo(t,r(e)):t},_o=We,Ro=Mo,Ho=u,Uo=xt,jo=function(e,t,r){for(var o=Ro(t),n=Uo.f,i=Ho.f,s=0;s<o.length;s++){var a=o[s];_o(e,a)||r&&_o(r,a)||n(e,a,i(t,a))}},qo=h,zo=W,Vo=/#|\.prototype\./,$o=function(e,t){var r=Wo[Go(e)];return r===Ko||r!==Jo&&(zo(t)?qo(t):!!t)},Go=$o.normalize=function(e){return String(e).replace(Vo,".").toLowerCase()},Wo=$o.data={},Jo=$o.NATIVE="N",Ko=$o.POLYFILL="P",Qo=$o,Yo=l,Zo=u.f,Xo=Zt,en=ro,tn=Ae,rn=jo,on=Qo,nn=function(e,t){var r,o,n,i,s,a=e.target,c=e.global,d=e.stat;if(r=c?Yo:d?Yo[a]||tn(a,{}):Yo[a]&&Yo[a].prototype)for(o in t){if(i=t[o],n=e.dontCallGetSet?(s=Zo(r,o))&&s.value:r[o],!on(c?o:a+(d?".":"#")+o,e.forced)&&void 0!==n){if(typeof i==typeof n)continue;rn(i,n)}(e.sham||n&&n.sham)&&Xo(i,"sham",!0),en(r,o,i,e)}},sn=p,an=Function.prototype,cn=an.apply,dn=an.call,ln="object"==typeof Reflect&&Reflect.apply||(sn?dn.bind(cn):function(){return dn.apply(cn,arguments)}),un=D,hn=we,gn=K,pn=function(e){return gn(e)||null===e},mn=String,fn=TypeError,vn=function(e,t,r){try{return un(hn(Object.getOwnPropertyDescriptor(e,t)[r]))}catch(o){}},yn=K,bn=q,Sn=function(e){if(pn(e))return e;throw new fn("Can't set "+mn(e)+" as a prototype")},Cn=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=vn(Object.prototype,"__proto__","set"))(r,[]),t=r instanceof Array}catch(o){}return function(r,o){return bn(r),Sn(o),yn(r)?(t?e(r,o):r.__proto__=o,r):r}}():void 0),kn=xt.f,wn=W,Pn=K,Tn=Cn,En={};En[at("toStringTag")]="z";var Nn="[object z]"===String(En),In=W,Dn=x,Fn=at("toStringTag"),Bn=Object,Ln="Arguments"===Dn(function(){return arguments}()),xn=Nn?Dn:function(e){var t,r,o;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(r){}}(t=Bn(e),Fn))?r:Ln?Dn(t):"Object"===(o=Dn(t))&&In(t.callee)?"Arguments":o},An=xn,On=String,Mn=function(e){if("Symbol"===An(e))throw new TypeError("Cannot convert a Symbol value to a string");return On(e)},_n=Mn,Rn=K,Hn=Zt,Un=Error,jn=D("".replace),qn=String(new Un("zxcasd").stack),zn=/\n\s*at [^:]*:[^\n]*/,Vn=zn.test(qn),$n=P,Gn=!h(function(){var e=new Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",$n(1,7)),7!==e.stack)}),Wn=Zt,Jn=function(e,t){if(Vn&&"string"==typeof e&&!Un.prepareStackTrace)for(;t--;)e=jn(e,zn,"");return e},Kn=Gn,Qn=Error.captureStackTrace,Yn=Z,Zn=We,Xn=Zt,ei=X,ti=Cn,ri=jo,oi=function(e,t,r){r in e||kn(e,r,{configurable:!0,get:function(){return t[r]},set:function(e){t[r]=e}})},ni=function(e,t,r){var o,n;return Tn&&wn(o=t.constructor)&&o!==r&&Pn(n=o.prototype)&&n!==r.prototype&&Tn(e,n),e},ii=function(e,t){return void 0===e?arguments.length<2?"":t:_n(e)},si=function(e,t){Rn(t)&&"cause"in t&&Hn(e,"cause",t.cause)},ai=function(e,t,r,o){Kn&&(Qn?Qn(e,t):Wn(e,"stack",Jn(r,o)))},ci=g,di=nn,li=ln,ui=function(e,t,r,o){var n="stackTraceLimit",i=o?2:1,s=e.split("."),a=s[s.length-1],c=Yn.apply(null,s);if(c){var d=c.prototype;if(Zn(d,"cause")&&delete d.cause,!r)return c;var l=Yn("Error"),u=t(function(e,t){var r=ii(o?t:e,void 0),n=o?new c(e):new c;return void 0!==r&&Xn(n,"message",r),ai(n,u,n.stack,2),this&&ei(d,this)&&ni(n,this,u),arguments.length>i&&si(n,arguments[i]),n});u.prototype=d,"Error"!==a?ti?ti(u,l):ri(u,l,{name:!0}):ci&&n in c&&(oi(u,c,n),oi(u,c,"prepareStackTrace")),ri(u,c);try{d.name!==a&&Xn(d,"name",a),d.constructor=u}catch(h){}return u}},hi="WebAssembly",gi=l[hi],pi=7!==new Error("e",{cause:7}).cause,mi=function(e,t){var r={};r[e]=ui(e,t,pi),di({global:!0,constructor:!0,arity:1,forced:pi},r)},fi=function(e,t){if(gi&&gi[e]){var r={};r[e]=ui(hi+"."+e,t,pi),di({target:hi,stat:!0,constructor:!0,arity:1,forced:pi},r)}};mi("Error",function(e){return function(t){return li(e,this,arguments)}}),mi("EvalError",function(e){return function(t){return li(e,this,arguments)}}),mi("RangeError",function(e){return function(t){return li(e,this,arguments)}}),mi("ReferenceError",function(e){return function(t){return li(e,this,arguments)}}),mi("SyntaxError",function(e){return function(t){return li(e,this,arguments)}}),mi("TypeError",function(e){return function(t){return li(e,this,arguments)}}),mi("URIError",function(e){return function(t){return li(e,this,arguments)}}),fi("CompileError",function(e){return function(t){return li(e,this,arguments)}}),fi("LinkError",function(e){return function(t){return li(e,this,arguments)}}),fi("RuntimeError",function(e){return function(t){return li(e,this,arguments)}});var vi={},yi=Eo,bi=No,Si=Object.keys||function(e){return yi(e,bi)},Ci=g,ki=At,wi=xt,Pi=Rt,Ti=$,Ei=Si;vi.f=Ci&&!ki?Object.defineProperties:function(e,t){Pi(e);for(var r,o=Ti(t),n=Ei(t),i=n.length,s=0;i>s;)wi.f(e,r=n[s++],o[r]);return e};var Ni,Ii=Z("document","documentElement"),Di=Rt,Fi=vi,Bi=No,Li=br,xi=Ii,Ai=Ct,Oi="prototype",Mi="script",_i=yr("IE_PROTO"),Ri=function(){},Hi=function(e){return"<"+Mi+">"+e+"</"+Mi+">"},Ui=function(e){e.write(Hi("")),e.close();var t=e.parentWindow.Object;return e=null,t},ji=function(){try{Ni=new ActiveXObject("htmlfile")}catch(t){}ji="undefined"!=typeof document?document.domain&&Ni?Ui(Ni):function(){var e,t=Ai("iframe"),r="java"+Mi+":";return t.style.display="none",xi.appendChild(t),t.src=String(r),(e=t.contentWindow.document).open(),e.write(Hi("document.F=Object")),e.close(),e.F}():Ui(Ni);for(var e=Bi.length;e--;)delete ji[Oi][Bi[e]];return ji()};Li[_i]=!0;var qi=Object.create||function(e,t){var r;return null!==e?(Ri[Oi]=Di(e),r=new Ri,Ri[Oi]=null,r[_i]=e):r=ji(),void 0===t?r:Fi.f(r,t)},zi=at,Vi=qi,$i=xt.f,Gi=zi("unscopables"),Wi=Array.prototype;void 0===Wi[Gi]&&$i(Wi,Gi,{configurable:!0,value:Vi(null)});var Ji,Ki,Qi,Yi=function(e){Wi[Gi][e]=!0},Zi={},Xi=!h(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),es=We,ts=W,rs=Ve,os=Xi,ns=yr("IE_PROTO"),is=Object,ss=is.prototype,as=os?is.getPrototypeOf:function(e){var t=rs(e);if(es(t,ns))return t[ns];var r=t.constructor;return ts(r)&&t instanceof r?r.prototype:t instanceof is?ss:null},cs=h,ds=W,ls=K,us=as,hs=ro,gs=at("iterator"),ps=!1;[].keys&&("next"in(Qi=[].keys())?(Ki=us(us(Qi)))!==Object.prototype&&(Ji=Ki):ps=!0);var ms=!ls(Ji)||cs(function(){var e={};return Ji[gs].call(e)!==e});ms&&(Ji={}),ds(Ji[gs])||hs(Ji,gs,function(){return this});var fs={IteratorPrototype:Ji,BUGGY_SAFARI_ITERATORS:ps},vs=xt.f,ys=We,bs=at("toStringTag"),Ss=function(e,t,r){e&&!r&&(e=e.prototype),e&&!ys(e,bs)&&vs(e,bs,{configurable:!0,value:t})},Cs=fs.IteratorPrototype,ks=qi,ws=P,Ps=Ss,Ts=Zi,Es=function(){return this},Ns=nn,Is=v,Ds=W,Fs=function(e,t,r,o){var n=t+" Iterator";return e.prototype=ks(Cs,{next:ws(+!o,r)}),Ps(e,n,!1),Ts[n]=Es,e},Bs=as,Ls=Cn,xs=Ss,As=Zt,Os=ro,Ms=Zi,_s=ir.PROPER,Rs=ir.CONFIGURABLE,Hs=fs.IteratorPrototype,Us=fs.BUGGY_SAFARI_ITERATORS,js=at("iterator"),qs="keys",zs="values",Vs="entries",$s=function(){return this},Gs=$,Ws=Yi,Js=Zi,Ks=xr,Qs=xt.f,Ys=function(e,t,r,o,n,i,s){Fs(r,t,o);var a,c,d,l=function(e){if(e===n&&m)return m;if(!Us&&e&&e in g)return g[e];switch(e){case qs:case zs:case Vs:return function(){return new r(this,e)}}return function(){return new r(this)}},u=t+" Iterator",h=!1,g=e.prototype,p=g[js]||g["@@iterator"]||n&&g[n],m=!Us&&p||l(n),f="Array"===t&&g.entries||p;if(f&&(a=Bs(f.call(new e)))!==Object.prototype&&a.next&&(Bs(a)!==Hs&&(Ls?Ls(a,Hs):Ds(a[js])||Os(a,js,$s)),xs(a,u,!0)),_s&&n===zs&&p&&p.name!==zs&&(Rs?As(g,"name",zs):(h=!0,m=function(){return Is(p,this)})),n)if(c={values:l(zs),keys:i?m:l(qs),entries:l(Vs)},s)for(d in c)(Us||h||!(d in g))&&Os(g,d,c[d]);else Ns({target:t,proto:!0,forced:Us||h},c);return g[js]!==m&&Os(g,js,m,{name:n}),Ms[t]=m,c},Zs=function(e,t){return{value:e,done:t}},Xs=g,ea="Array Iterator",ta=Ks.set,ra=Ks.getterFor(ea),oa=Ys(Array,"Array",function(e,t){ta(this,{type:ea,target:Gs(e),index:0,kind:t})},function(){var e=ra(this),t=e.target,r=e.index++;if(!t||r>=t.length)return e.target=void 0,Zs(void 0,!0);switch(e.kind){case"keys":return Zs(r,!1);case"values":return Zs(t[r],!1)}return Zs([r,t[r]],!1)},"values"),na=Js.Arguments=Js.Array;if(Ws("keys"),Ws("values"),Ws("entries"),Xs&&"values"!==na.name)try{Qs(na,"name",{value:"values"})}catch(tp){}var ia="process"===x(l.process),sa=Yr,aa=xt,ca=function(e,t,r){return r.get&&sa(r.get,t,{getter:!0}),r.set&&sa(r.set,t,{setter:!0}),aa.f(e,t,r)},da=Z,la=ca,ua=g,ha=at("species"),ga=X,pa=TypeError,ma=function(e,t){if(ga(t,e))return e;throw new pa("Incorrect invocation")},fa=D,va=h,ya=W,ba=xn,Sa=hr,Ca=function(){},ka=Z("Reflect","construct"),wa=/^\s*(?:class|function)\b/,Pa=fa(wa.exec),Ta=!wa.test(Ca),Ea=function(e){if(!ya(e))return!1;try{return ka(Ca,[],e),!0}catch(tp){return!1}},Na=function(e){if(!ya(e))return!1;switch(ba(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Ta||!!Pa(wa,Sa(e))}catch(tp){return!0}};Na.sham=!0;var Ia,Da,Fa,Ba,La=!ka||va(function(){var e;return Ea(Ea.call)||!Ea(Object)||!Ea(function(){e=!0})||e})?Na:Ea,xa=La,Aa=be,Oa=TypeError,Ma=Rt,_a=function(e){if(xa(e))return e;throw new Oa(Aa(e)+" is not a constructor")},Ra=H,Ha=at("species"),Ua=x,ja=D,qa=function(e){if("Function"===Ua(e))return ja(e)},za=we,Va=p,$a=qa(qa.bind),Ga=function(e,t){return za(e),void 0===t?e:Va?$a(e,t):function(){return e.apply(t,arguments)}},Wa=D([].slice),Ja=TypeError,Ka=/(?:ipad|iphone|ipod).*applewebkit/i.test(ee),Qa=l,Ya=ln,Za=Ga,Xa=W,ec=We,tc=h,rc=Ii,oc=Wa,nc=Ct,ic=function(e,t){if(e<t)throw new Ja("Not enough arguments");return e},sc=Ka,ac=ia,cc=Qa.setImmediate,dc=Qa.clearImmediate,lc=Qa.process,uc=Qa.Dispatch,hc=Qa.Function,gc=Qa.MessageChannel,pc=Qa.String,mc=0,fc={},vc="onreadystatechange";tc(function(){Ia=Qa.location});var yc=function(e){if(ec(fc,e)){var t=fc[e];delete fc[e],t()}},bc=function(e){return function(){yc(e)}},Sc=function(e){yc(e.data)},Cc=function(e){Qa.postMessage(pc(e),Ia.protocol+"//"+Ia.host)};cc&&dc||(cc=function(e){ic(arguments.length,1);var t=Xa(e)?e:hc(e),r=oc(arguments,1);return fc[++mc]=function(){Ya(t,void 0,r)},Da(mc),mc},dc=function(e){delete fc[e]},ac?Da=function(e){lc.nextTick(bc(e))}:uc&&uc.now?Da=function(e){uc.now(bc(e))}:gc&&!sc?(Ba=(Fa=new gc).port2,Fa.port1.onmessage=Sc,Da=Za(Ba.postMessage,Ba)):Qa.addEventListener&&Xa(Qa.postMessage)&&!Qa.importScripts&&Ia&&"file:"!==Ia.protocol&&!tc(Cc)?(Da=Cc,Qa.addEventListener("message",Sc,!1)):Da=vc in nc("script")?function(e){rc.appendChild(nc("script"))[vc]=function(){rc.removeChild(this),yc(e)}}:function(e){setTimeout(bc(e),0)});var kc={set:cc},wc=l,Pc=g,Tc=Object.getOwnPropertyDescriptor,Ec=function(){this.head=null,this.tail=null};Ec.prototype={add:function(e){var t={item:e,next:null},r=this.tail;r?r.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return null===(this.head=e.next)&&(this.tail=null),e.item}};var Nc,Ic,Dc,Fc,Bc,Lc=Ec,xc=/ipad|iphone|ipod/i.test(ee)&&"undefined"!=typeof Pebble,Ac=/web0s(?!.*chrome)/i.test(ee),Oc=l,Mc=function(e){if(!Pc)return wc[e];var t=Tc(wc,e);return t&&t.value},_c=Ga,Rc=kc.set,Hc=Lc,Uc=Ka,jc=xc,qc=Ac,zc=ia,Vc=Oc.MutationObserver||Oc.WebKitMutationObserver,$c=Oc.document,Gc=Oc.process,Wc=Oc.Promise,Jc=Mc("queueMicrotask");if(!Jc){var Kc=new Hc,Qc=function(){var e,t;for(zc&&(e=Gc.domain)&&e.exit();t=Kc.get();)try{t()}catch(tp){throw Kc.head&&Nc(),tp}e&&e.enter()};Uc||zc||qc||!Vc||!$c?!jc&&Wc&&Wc.resolve?((Fc=Wc.resolve(void 0)).constructor=Wc,Bc=_c(Fc.then,Fc),Nc=function(){Bc(Qc)}):zc?Nc=function(){Gc.nextTick(Qc)}:(Rc=_c(Rc,Oc),Nc=function(){Rc(Qc)}):(Ic=!0,Dc=$c.createTextNode(""),new Vc(Qc).observe(Dc,{characterData:!0}),Nc=function(){Dc.data=Ic=!Ic}),Jc=function(e){Kc.head||Nc(),Kc.add(e)}}var Yc=Jc,Zc=function(e){try{return{error:!1,value:e()}}catch(tp){return{error:!0,value:tp}}},Xc=l.Promise,ed="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,td=!ed&&!ia&&"object"==typeof window&&"object"==typeof document,rd=l,od=Xc,nd=W,id=Qo,sd=hr,ad=at,cd=td,dd=ed,ld=ae;od&&od.prototype;var ud=ad("species"),hd=!1,gd=nd(rd.PromiseRejectionEvent),pd=id("Promise",function(){var e=sd(od),t=e!==String(od);if(!t&&66===ld)return!0;if(!ld||ld<51||!/native code/.test(e)){var r=new od(function(e){e(1)}),o=function(e){e(function(){},function(){})};if((r.constructor={})[ud]=o,!(hd=r.then(function(){})instanceof o))return!0}return!t&&(cd||dd)&&!gd}),md={CONSTRUCTOR:pd,REJECTION_EVENT:gd,SUBCLASSING:hd},fd={},vd=we,yd=TypeError,bd=function(e){var t,r;this.promise=new e(function(e,o){if(void 0!==t||void 0!==r)throw new yd("Bad Promise constructor");t=e,r=o}),this.resolve=vd(t),this.reject=vd(r)};fd.f=function(e){return new bd(e)};var Sd,Cd,kd,wd=nn,Pd=ia,Td=l,Ed=v,Nd=ro,Id=Cn,Dd=Ss,Fd=function(e){var t=da(e);ua&&t&&!t[ha]&&la(t,ha,{configurable:!0,get:function(){return this}})},Bd=we,Ld=W,xd=K,Ad=ma,Od=function(e,t){var r,o=Ma(e).constructor;return void 0===o||Ra(r=Ma(o)[Ha])?t:_a(r)},Md=kc.set,_d=Yc,Rd=function(e,t){try{1===arguments.length?console.error(e):console.error(e,t)}catch(tp){}},Hd=Zc,Ud=Lc,jd=xr,qd=Xc,zd=fd,Vd="Promise",$d=md.CONSTRUCTOR,Gd=md.REJECTION_EVENT,Wd=md.SUBCLASSING,Jd=jd.getterFor(Vd),Kd=jd.set,Qd=qd&&qd.prototype,Yd=qd,Zd=Qd,Xd=Td.TypeError,el=Td.document,tl=Td.process,rl=zd.f,ol=rl,nl=!!(el&&el.createEvent&&Td.dispatchEvent),il="unhandledrejection",sl=function(e){var t;return!(!xd(e)||!Ld(t=e.then))&&t},al=function(e,t){var r,o,n,i=t.value,s=1===t.state,a=s?e.ok:e.fail,c=e.resolve,d=e.reject,l=e.domain;try{a?(s||(2===t.rejection&&hl(t),t.rejection=1),!0===a?r=i:(l&&l.enter(),r=a(i),l&&(l.exit(),n=!0)),r===e.promise?d(new Xd("Promise-chain cycle")):(o=sl(r))?Ed(o,r,c,d):c(r)):d(i)}catch(tp){l&&!n&&l.exit(),d(tp)}},cl=function(e,t){e.notified||(e.notified=!0,_d(function(){for(var r,o=e.reactions;r=o.get();)al(r,e);e.notified=!1,t&&!e.rejection&&ll(e)}))},dl=function(e,t,r){var o,n;nl?((o=el.createEvent("Event")).promise=t,o.reason=r,o.initEvent(e,!1,!0),Td.dispatchEvent(o)):o={promise:t,reason:r},!Gd&&(n=Td["on"+e])?n(o):e===il&&Rd("Unhandled promise rejection",r)},ll=function(e){Ed(Md,Td,function(){var t,r=e.facade,o=e.value;if(ul(e)&&(t=Hd(function(){Pd?tl.emit("unhandledRejection",o,r):dl(il,r,o)}),e.rejection=Pd||ul(e)?2:1,t.error))throw t.value})},ul=function(e){return 1!==e.rejection&&!e.parent},hl=function(e){Ed(Md,Td,function(){var t=e.facade;Pd?tl.emit("rejectionHandled",t):dl("rejectionhandled",t,e.value)})},gl=function(e,t,r){return function(o){e(t,o,r)}},pl=function(e,t,r){e.done||(e.done=!0,r&&(e=r),e.value=t,e.state=2,cl(e,!0))},ml=function(e,t,r){if(!e.done){e.done=!0,r&&(e=r);try{if(e.facade===t)throw new Xd("Promise can't be resolved itself");var o=sl(t);o?_d(function(){var r={done:!1};try{Ed(o,t,gl(ml,r,e),gl(pl,r,e))}catch(tp){pl(r,tp,e)}}):(e.value=t,e.state=1,cl(e,!1))}catch(tp){pl({done:!1},tp,e)}}};if($d&&(Zd=(Yd=function(e){Ad(this,Zd),Bd(e),Ed(Sd,this);var t=Jd(this);try{e(gl(ml,t),gl(pl,t))}catch(tp){pl(t,tp)}}).prototype,(Sd=function(e){Kd(this,{type:Vd,done:!1,notified:!1,parent:!1,reactions:new Ud,rejection:!1,state:0,value:void 0})}).prototype=Nd(Zd,"then",function(e,t){var r=Jd(this),o=rl(Od(this,Yd));return r.parent=!0,o.ok=!Ld(e)||e,o.fail=Ld(t)&&t,o.domain=Pd?tl.domain:void 0,0===r.state?r.reactions.add(o):_d(function(){al(o,r)}),o.promise}),Cd=function(){var e=new Sd,t=Jd(e);this.promise=e,this.resolve=gl(ml,t),this.reject=gl(pl,t)},zd.f=rl=function(e){return e===Yd||undefined===e?new Cd(e):ol(e)},Ld(qd)&&Qd!==Object.prototype)){kd=Qd.then,Wd||Nd(Qd,"then",function(e,t){var r=this;return new Yd(function(e,t){Ed(kd,r,e,t)}).then(e,t)},{unsafe:!0});try{delete Qd.constructor}catch(tp){}Id&&Id(Qd,Zd)}wd({global:!0,constructor:!0,wrap:!0,forced:$d},{Promise:Yd}),Dd(Yd,Vd,!1),Fd(Vd);var fl=Zi,vl=at("iterator"),yl=Array.prototype,bl=xn,Sl=Ee,Cl=H,kl=Zi,wl=at("iterator"),Pl=function(e){if(!Cl(e))return Sl(e,wl)||Sl(e,"@@iterator")||kl[bl(e)]},Tl=v,El=we,Nl=Rt,Il=be,Dl=Pl,Fl=TypeError,Bl=v,Ll=Rt,xl=Ee,Al=Ga,Ol=v,Ml=Rt,_l=be,Rl=function(e){return void 0!==e&&(fl.Array===e||yl[vl]===e)},Hl=mo,Ul=X,jl=function(e,t){var r=arguments.length<2?Dl(e):t;if(El(r))return Nl(Tl(r,e));throw new Fl(Il(e)+" is not iterable")},ql=Pl,zl=function(e,t,r){var o,n;Ll(e);try{if(!(o=xl(e,"return"))){if("throw"===t)throw r;return r}o=Bl(o,e)}catch(tp){n=!0,o=tp}if("throw"===t)throw r;if(n)throw o;return Ll(o),r},Vl=TypeError,$l=function(e,t){this.stopped=e,this.result=t},Gl=$l.prototype,Wl=function(e,t,r){var o,n,i,s,a,c,d,l=r&&r.that,u=!(!r||!r.AS_ENTRIES),h=!(!r||!r.IS_RECORD),g=!(!r||!r.IS_ITERATOR),p=!(!r||!r.INTERRUPTED),m=Al(t,l),f=function(e){return o&&zl(o,"normal",e),new $l(!0,e)},v=function(e){return u?(Ml(e),p?m(e[0],e[1],f):m(e[0],e[1])):p?m(e,f):m(e)};if(h)o=e.iterator;else if(g)o=e;else{if(!(n=ql(e)))throw new Vl(_l(e)+" is not iterable");if(Rl(n)){for(i=0,s=Hl(e);s>i;i++)if((a=v(e[i]))&&Ul(Gl,a))return a;return new $l(!1)}o=jl(e,n)}for(c=h?e.next:o.next;!(d=Ol(c,o)).done;){try{a=v(d.value)}catch(tp){zl(o,"throw",tp)}if("object"==typeof a&&a&&Ul(Gl,a))return a}return new $l(!1)},Jl=at("iterator"),Kl=!1;try{var Ql=0,Yl={next:function(){return{done:!!Ql++}},return:function(){Kl=!0}};Yl[Jl]=function(){return this},Array.from(Yl,function(){throw 2})}catch(tp){}var Zl=Xc,Xl=function(e,t){try{if(!t&&!Kl)return!1}catch(tp){return!1}var r=!1;try{var o={};o[Jl]=function(){return{next:function(){return{done:r=!0}}}},e(o)}catch(tp){}return r},eu=md.CONSTRUCTOR||!Xl(function(e){Zl.all(e).then(void 0,function(){})}),tu=v,ru=we,ou=fd,nu=Zc,iu=Wl;nn({target:"Promise",stat:!0,forced:eu},{all:function(e){var t=this,r=ou.f(t),o=r.resolve,n=r.reject,i=nu(function(){var r=ru(t.resolve),i=[],s=0,a=1;iu(e,function(e){var c=s++,d=!1;a++,tu(r,t,e).then(function(e){d||(d=!0,i[c]=e,--a||o(i))},n)}),--a||o(i)});return i.error&&n(i.value),r.promise}});var su=nn,au=md.CONSTRUCTOR,cu=Xc,du=Z,lu=W,uu=ro,hu=cu&&cu.prototype;if(su({target:"Promise",proto:!0,forced:au,real:!0},{catch:function(e){return this.then(void 0,e)}}),lu(cu)){var gu=du("Promise").prototype.catch;hu.catch!==gu&&uu(hu,"catch",gu,{unsafe:!0})}var pu=v,mu=we,fu=fd,vu=Zc,yu=Wl;nn({target:"Promise",stat:!0,forced:eu},{race:function(e){var t=this,r=fu.f(t),o=r.reject,n=vu(function(){var n=mu(t.resolve);yu(e,function(e){pu(n,t,e).then(r.resolve,o)})});return n.error&&o(n.value),r.promise}});var bu=fd;nn({target:"Promise",stat:!0,forced:md.CONSTRUCTOR},{reject:function(e){var t=bu.f(this);return(0,t.reject)(e),t.promise}});var Su=Rt,Cu=K,ku=fd,wu=nn,Pu=md.CONSTRUCTOR,Tu=function(e,t){if(Su(e),Cu(t)&&t.constructor===e)return t;var r=ku.f(e);return(0,r.resolve)(t),r.promise};Z("Promise"),wu({target:"Promise",stat:!0,forced:Pu},{resolve:function(e){return Tu(this,e)}});var Eu=Rt,Nu=function(){var e=Eu(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},Iu=v,Du=We,Fu=X,Bu=Nu,Lu=RegExp.prototype,xu=ir.PROPER,Au=ro,Ou=Rt,Mu=Mn,_u=h,Ru=function(e){var t=e.flags;return void 0!==t||"flags"in Lu||Du(e,"flags")||!Fu(Lu,e)?t:Iu(Bu,e)},Hu="toString",Uu=RegExp.prototype,ju=Uu[Hu],qu=_u(function(){return"/a/b"!==ju.call({source:"a",flags:"b"})}),zu=xu&&ju.name!==Hu;(qu||zu)&&Au(Uu,Hu,function(){var e=Ou(this);return"/"+Mu(e.source)+"/"+Mu(Ru(e))},{unsafe:!0});var Vu=g,$u=xt,Gu=P,Wu=nn,Ju=l,Ku=ma,Qu=Rt,Yu=W,Zu=as,Xu=ca,eh=function(e,t,r){Vu?$u.f(e,t,Gu(0,r)):e[t]=r},th=h,rh=We,oh=fs.IteratorPrototype,nh=g,ih="constructor",sh="Iterator",ah=at("toStringTag"),ch=TypeError,dh=Ju[sh],lh=!Yu(dh)||dh.prototype!==oh||!th(function(){dh({})}),uh=function(){if(Ku(this,oh),Zu(this)===oh)throw new ch("Abstract class Iterator not directly constructable")},hh=function(e,t){nh?Xu(oh,e,{configurable:!0,get:function(){return t},set:function(t){if(Qu(this),this===oh)throw new ch("You can't redefine this property");rh(this,e)?this[e]=t:eh(this,e,t)}}):oh[e]=t};rh(oh,ah)||hh(ah,sh),!lh&&rh(oh,ih)&&oh[ih]!==Object||hh(ih,uh),uh.prototype=oh,Wu({global:!0,constructor:!0,forced:lh},{Iterator:uh});var gh=Wl,ph=we,mh=Rt,fh=function(e){return{iterator:e,next:e.next,done:!1}};nn({target:"Iterator",proto:!0,real:!0},{find:function(e){mh(this),ph(e);var t=fh(this),r=0;return gh(t,function(t,o){if(e(t,r++))return o(t)},{IS_RECORD:!0,INTERRUPTED:!0}).result}});var vh=Ct("span").classList,yh=vh&&vh.constructor&&vh.constructor.prototype,bh=yh===Object.prototype?void 0:yh,Sh=l,Ch={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},kh=bh,wh=oa,Ph=Zt,Th=Ss,Eh=at("iterator"),Nh=wh.values,Ih=function(e,t){if(e){if(e[Eh]!==Nh)try{Ph(e,Eh,Nh)}catch(tp){e[Eh]=Nh}if(Th(e,t,!0),Ch[t])for(var r in wh)if(e[r]!==wh[r])try{Ph(e,r,wh[r])}catch(tp){e[r]=wh[r]}}};for(var Dh in Ch)Ih(Sh[Dh]&&Sh[Dh].prototype,Dh);Ih(kh,"DOMTokenList");const Fh=(e,t)=>Object.assign(void 0!==t?function(){return{type:e,...t(...arguments)}}:t=>void 0!==t?{type:e,...t}:{type:e},{type:e}),Bh="[Loop]",Lh=`${Bh} [Start]`,xh=`${Bh} [Resolve]`,Ah=`${Bh} [Reject]`,Oh=e=>({start:Object.assign(t=>Fh(`${Lh} ${e}`,e=>({...t,asyncId:window.crypto.randomUUID(),instanceId:e})),{type:`${Lh} ${e}`}),resolve:Object.assign(t=>Fh(`${xh} ${e}`,(e,r)=>({...t,asyncId:r,instanceId:e})),{type:`${xh} ${e}`}),reject:Object.assign(t=>Fh(`${Ah} ${e}`,(e,r)=>({...t,asyncId:r,instanceId:e})),{type:`${Ah} ${e}`})});function Mh(e){return void 0!==e.asyncId}class _h{constructor(e){this.target=e,this.listeners=new Set,this.typeListeners=new Map,this.asyncListeners=new Map,this.asyncResponders=new Map,this.messageDelegator=e=>this.onMessage(e),this.listener=e=>this.messageDelegator(e),this.queue=[],window.addEventListener("message",this.listener)}pause(e){this.messageDelegator=t=>{e&&e(t)?this.onMessage(t):this.queue.push(t)}}flush(){const e=this.queue;this.queue=[];for(const t of e)this.onMessage(t)}resume(){this.messageDelegator=e=>this.onMessage(e),this.flush()}dispose(){window.removeEventListener("message",this.listener),this.listeners.clear(),this.typeListeners.clear(),this.asyncListeners.clear(),this.asyncResponders.clear(),this.queue=[]}listen(e){this.listeners.add(e)}listenFor(e,t){let{type:r}=e;const o=this.typeListeners.get(r);o?o.add(t):this.typeListeners.set(r,new Set([t]))}listenForAsync(e,t){const r=e.start.type,o=this.asyncListeners.get(r);o?o.add(t):this.asyncListeners.set(r,new Set([t]))}send(e){"function"===typeof e?this.sendMessage(e(this.target.instanceId)):this.sendMessage({...e,instanceId:this.target.instanceId})}async sendAsync(e){return new Promise((t,r)=>{const o=e(this.target.instanceId),{asyncId:n}=o;this.asyncResponders.set(n,[t,r]),this.sendMessage(o)})}onMessage(e){if(this.target.origin!==e.origin)return;const t=e.data;if(function(e){const t=e;return null!=t&&"object"===typeof t&&void 0!==t.type&&void 0!==t.instanceId}(t)){if(Mh(t)){const e=this.asyncResponders.get(t.asyncId);if(e){this.asyncResponders.delete(t.asyncId);const[r,o]=e,{type:n,asyncId:i,instanceId:s,...a}=t;n.startsWith(xh)?r(a):t.type.startsWith(Ah)&&o(a)}}for(const r of Array.from(this.listeners))r(t);const e=this.typeListeners.get(t.type);if(e)for(const r of Array.from(e))r(t);if(Mh(t)&&t.type.startsWith(Lh)){const e=this.asyncListeners.get(t.type);if(e)for(const r of Array.from(e))Promise.resolve(r(t)).then(e=>this.sendMessage(e(t.instanceId,t.asyncId)))}}}sendMessage(e){this.target.window()?.postMessage(e,this.target.origin)}}class Rh extends _h{constructor(e,t,r){super({origin:e,window:t,instanceId:r})}}const Hh=Oh("Open"),Uh=Oh("Initialize"),jh=Oh("GetToken"),qh=Oh("Render"),zh=Oh("SetIframeSize"),Vh=Oh("LoopActivity"),$h=[0,0,1];class Gh{constructor(e,t){this.container=e,this.config=t,this.renderPromiseResolver={resolve:()=>{},reject:()=>{}},this.renderPromise=new Promise((e,t)=>this.renderPromiseResolver={resolve:e,reject:t})}dispose(){this.broker?.dispose(),this.broker=void 0,this.iframe?.remove(),this.iframe=void 0,this.instanceId=void 0}async open(e){return await this.bootstrap(e),this.broker?this.broker.sendAsync(Hh.start(e)):{kind:"Unknown",resolved:"Unknown"}}setupLoopActivityListeners(e){this.broker?.listenForAsync(Vh,t=>{let{options:r}=t;return this.instanceId&&r?.iframeInstanceId===this.instanceId&&e(r),Vh.resolve({isError:!1})})}setScenarioName(e,t){let r="";const o=new URL(t.url)?.searchParams;t.url?.includes("/dataquestion")?r="dataquestion":t.url?.includes("/summary")?r="summary":(t.url?.includes("/reports")||o?.get("visual")&&o.get("bookmarkGuid"))&&(r="reportVisual"),e.searchParams.set("__scenario",r)}async bootstrap(e){if(this.broker)return $h;const t=new URL(e.url);t.pathname="loop",t.search="";const r=this.config.featureSwitches;if(r)for(const c in r)t.searchParams.set(c,r[c]?"1":"0");this.instanceId=window.crypto.randomUUID();const o=function(e,t,r){const o="string"===typeof e?new URL(e):e;return o.searchParams.set("__instanceId",t),o.searchParams.set("__hostOrigin",r),o}(t,this.instanceId,location.origin);this.setScenarioName(o,e);const n=this.iframe=this.container.ownerDocument.createElement("iframe");n.src=o.toString(),n.style.width="100%",n.style.height="400px",n.style.border="none",n.title="Power BI",n.setAttribute("sandbox","allow-same-origin allow-scripts allow-popups allow-forms allow-downloads"),n.setAttribute("allow","clipboard-read; clipboard-write");const i=new URLSearchParams(n.src)?.get("__hostOrigin"),s=new Promise((e,t)=>{n.onload=e,n.onerror=t});this.broker=new Rh(t.origin,()=>n?.contentWindow,this.instanceId);const a=new Promise((t,r)=>{this.broker?.listenForAsync(Uh,o=>{let{version:n}=o;return(e=>e[0]===$h[0])(n)?t(n):r(n),Uh.resolve({version:$h,context:this.config.hostContext,launchPbiStartTime:e.launchPbiStartTime,hostName:i??"unknown"})})});return this.setupListeners(),this.container.appendChild(n),this.renderPromiseResolver.resolve(),await s,a}setupListeners(){this.broker?.listenForAsync(jh,e=>{let{scopes:t,options:r}=e;return this.config.providers.token.getToken(t,r).then(jh.resolve,jh.reject)}),this.broker?.listenForAsync(qh,e=>{let{isError:t}=e;return t?this.renderPromiseResolver.reject():this.renderPromiseResolver.resolve(),qh.resolve({isError:t})}),this.broker?.listenForAsync(zh,e=>{let{options:t}=e;return this.instanceId&&t?.iframeInstanceId===this.instanceId&&this.iframe?.style.setProperty("height",`${t?.height}px`),zh.resolve({isError:!1})})}}const Wh="@trident/powerbi-loop",Jh="Power BI";class Kh extends a.EventEmitter{constructor(e,t){if(super(),this.props=e,this.providers=t,this.isFocused=!1,this.hostKeyboardShortcuts=[],this.isUserActivityLogged=!1,this.visualReadyTracker=(0,o.p)("visualReady",this),this.fullUiReadyTracker=(0,o.p)("fullUIReady",this),this.launchPbiStartTime=performance.timeOrigin,!t)throw Error("Missing providers")}get ComponentFocusable(){return this}giveFocus(){return this.setFocus()}isComponentFocused(){return this.hasFocus()}setHostComponentFocusable(e){this.hostComponentFocusable=e}get FocusableV2(){return this}setFocus(){var e;if(!this.iframeInstanceId)return!1;const t=null==(e=document.querySelector(`iframe[src*="__instanceId=${this.iframeInstanceId}"]`))?void 0:e.contentWindow;return t&&(t.focus(),this.isFocused=!0),this.isFocused}hasFocus(){return this.isFocused}get KeyboardShortcutEmitter(){return this}setShortcuts(e){this.hostKeyboardShortcuts=e}get UserActivityProvider(){return this}get RenderStageEmitter(){return this}get HTMLView(){return this}async render(e){var t,r,o;this.visualReadyTracker.start(),this.fullUiReadyTracker.start();const[n,i,s]=await Promise.all([null==(t=this.providers)?void 0:t.InternationalizationContext,null==(r=this.providers)?void 0:r.TelemetryConfig,null==(o=this.providers)?void 0:o.TokenProvider]);if(!s)throw Error("No telemetryConfig or token provider");var a;return this.loopClient=new Gh(e,{featureSwitches:{},hostContext:{hostSessionId:(null==i?void 0:i.hostSessionId)||"",hostLocaleContext:(null==n?void 0:n.uiLocale)||"",hostCorrelationId:(null==i?void 0:i.hostCorrelationId)||""},providers:{token:{getToken:async function(e){const t=e[0];if(1!==e.length||"https://analysis.windows-int.net/powerbi/api/.default"!==t&&"https://analysis.windows.net/powerbi/api/.default"!==t)throw Error("Incorrect token scopes requested");{const t=await(null==s?void 0:s.getToken(e,{request:null}));if(t){return{token:null==t?void 0:t.token}}throw Error("No token")}}}}}),this.props.url&&(this.loopClient.open({url:null==(a=this.props.url)?void 0:a.toString(),launchPbiStartTime:this.launchPbiStartTime}),this.loopClient.setupLoopActivityListeners(e=>this.loopActivityHandler(e))),this.loopClient.renderPromise}async dispose(){this.element&&delete this.element}loopActivityHandler(e){if(this.iframeInstanceId=e.iframeInstanceId,"visualReady"===e.type)this.visualReadyTracker.end();else if("fullUIReady"===e.type)this.fullUiReadyTracker.end();else if("keyPress"===e.type){if("ctrlF6"===e.message){var t;const e=new KeyboardEvent("keydown",{key:"F6",code:"F6",ctrlKey:!0,bubbles:!0,cancelable:!0}),r=null==(t=this.hostKeyboardShortcuts)?void 0:t.find(t=>(0,n.X)(e,t));null==r||r.handler(e)}else if("escape"===e.message){var r;this.FocusableV2.emit("moveFocusToHost"),this.hostComponentFocusable&&null!=(r=this.element)&&r.contains(document.activeElement)&&this.hostComponentFocusable.ComponentFocusable.giveFocus()}}else"userActivity"!==e.type||this.isUserActivityLogged||(this.emit("userActivity"),this.isUserActivityLogged=!0)}}class Qh{constructor(e,t){var r;this.powerBILoopInitialConfig=e,this.providers=t,this.name=Jh,this.iconUrl=(r="data:image/svg+xml,%3csvg width='20' height='20' viewBox='0 0 20 20' fill='none' xmlns='http://www.w3.org/2000/svg'%3e%3cg clip-path='url(%23clip0_2135_196676)'%3e%3cmask id='mask0_2135_196676' style='mask-type:alpha' maskUnits='userSpaceOnUse' x='2' y='0' width='16' height='20'%3e%3cpath d='M10.8333 0.833333C10.8333 0.61232 10.9211 0.400358 11.0774 0.244078C11.2337 0.0877974 11.4457 0 11.6667 0L16.6667 0C16.8877 0 17.0996 0.0877974 17.2559 0.244078C17.4122 0.400358 17.5 0.61232 17.5 0.833333V19.1667C17.5 19.3877 17.4122 19.5996 17.2559 19.7559C17.0996 19.9122 16.8877 20 16.6667 20H3.33333C3.11232 20 2.90036 19.9122 2.74408 19.7559C2.5878 19.5996 2.5 19.3877 2.5 19.1667V10.8333C2.5 10.6123 2.5878 10.4004 2.74408 10.2441C2.90036 10.0878 3.11232 10 3.33333 10H6.66667V5.83333C6.66667 5.61232 6.75446 5.40036 6.91074 5.24408C7.06702 5.0878 7.27899 5 7.5 5H10.8333V0.833333Z' fill='white'/%3e%3c/mask%3e%3cg mask='url(%23mask0_2135_196676)'%3e%3cpath d='M17.5 0V20H10.8333V0H17.5Z' fill='url(%23paint0_linear_2135_196676)'/%3e%3cg filter='url(%23filter0_f_2135_196676)'%3e%3cpath d='M13.3334 5.91671V20.0834H6.66669V5.08337H12.5C12.721 5.08337 12.933 5.17117 13.0893 5.32745C13.2456 5.48373 13.3334 5.69569 13.3334 5.91671Z' fill='black' fill-opacity='0.2'/%3e%3c/g%3e%3cg filter='url(%23filter1_f_2135_196676)'%3e%3cpath d='M13.3334 6.24996V20.4166H6.66669V5.41663H12.5C12.721 5.41663 12.933 5.50442 13.0893 5.6607C13.2456 5.81698 13.3334 6.02895 13.3334 6.24996Z' fill='black' fill-opacity='0.18'/%3e%3c/g%3e%3cpath d='M13.3334 5.83333V20H6.66669V5H12.5C12.721 5 12.933 5.0878 13.0893 5.24408C13.2456 5.40036 13.3334 5.61232 13.3334 5.83333Z' fill='url(%23paint1_linear_2135_196676)'/%3e%3cpath d='M2.5 10V20H9.16667V10.8333C9.16667 10.6123 9.07887 10.4004 8.92259 10.2441C8.76631 10.0878 8.55435 10 8.33333 10H2.5Z' fill='url(%23paint2_linear_2135_196676)'/%3e%3c/g%3e%3c/g%3e%3cdefs%3e%3cfilter id='filter0_f_2135_196676' x='6.26669' y='4.68337' width='7.46669' height='15.8' filterUnits='userSpaceOnUse' color-interpolation-filters='sRGB'%3e%3cfeFlood flood-opacity='0' result='BackgroundImageFix'/%3e%3cfeBlend mode='normal' in='SourceGraphic' in2='BackgroundImageFix' result='shape'/%3e%3cfeGaussianBlur stdDeviation='0.2' result='effect1_foregroundBlur_2135_196676'/%3e%3c/filter%3e%3cfilter id='filter1_f_2135_196676' x='2.66669' y='1.41663' width='14.6667' height='23' filterUnits='userSpaceOnUse' color-interpolation-filters='sRGB'%3e%3cfeFlood flood-opacity='0' result='BackgroundImageFix'/%3e%3cfeBlend mode='normal' in='SourceGraphic' in2='BackgroundImageFix' result='shape'/%3e%3cfeGaussianBlur stdDeviation='2' result='effect1_foregroundBlur_2135_196676'/%3e%3c/filter%3e%3clinearGradient id='paint0_linear_2135_196676' x1='9.72206' y1='-1.22525e-07' x2='18.5135' y2='18.6348' gradientUnits='userSpaceOnUse'%3e%3cstop stop-color='%23E6AD10'/%3e%3cstop offset='1' stop-color='%23C87E0E'/%3e%3c/linearGradient%3e%3clinearGradient id='paint1_linear_2135_196676' x1='6.66606' y1='5' x2='14.0596' y2='19.3387' gradientUnits='userSpaceOnUse'%3e%3cstop stop-color='%23F6D751'/%3e%3cstop offset='1' stop-color='%23E6AD10'/%3e%3c/linearGradient%3e%3clinearGradient id='paint2_linear_2135_196676' x1='2.49937' y1='10' x2='6.585' y2='19.6829' gradientUnits='userSpaceOnUse'%3e%3cstop stop-color='%23F9E589'/%3e%3cstop offset='1' stop-color='%23F6D751'/%3e%3c/linearGradient%3e%3cclipPath id='clip0_2135_196676'%3e%3crect width='20' height='20' fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",{type:"image",source:r}).source,this.experienceType="Isolated",e.creationData.dataType===i.kW&&(this.initialURL=e.creationData.data.url),this.loopTitle=Jh}get HTMLViewable(){return this}get ContentURL(){return this}async getView(){return new Kh({url:this.initialURL},this.providers)}async getContentURL(){if(!this.initialURL)throw Error("Unable to retrieve URL");return this.initialURL}get ComponentTelemetryMetadata(){return this}get entityName(){return"PowerBILoopComponent"}getLoopComponentUrl(){if(!this.initialURL)throw Error("Unable to retrieve URL");return Promise.resolve(this.initialURL)}get LoopComponentUrl(){return this}get ComponentTitle(){return this}on(e,t){return this}off(e,t){return this}get title(){return this.loopTitle}getTitle(){return Promise.resolve(this.loopTitle)}get ComponentProperties(){return this}get ComponentSerializable(){return this}async serialize(){throw Error("serialize is not implemented")}async rehydrate(e){throw Error("rehydrate is not implemented")}async getHtmlAsync(){var e;const t=document.createElement("a");return t.href=(null==(e=this.initialURL)?void 0:e.href)||"",t.textContent=this.loopTitle,t.rel="noreferrer noopener",t.outerHTML}async getTextAsync(){var e;return(null==(e=this.initialURL)?void 0:e.href)||""}}const Yh=new s.p(Qh,{InternationalizationContext:"InternationalizationContext",TelemetryConfig:"TelemetryConfig",TokenProvider:"TokenProvider"});var Zh=Object.freeze({__proto__:null,PowerBIPortableComponent:Qh,loopExport:Yh}),Xh=So.includes,eg=Yi;nn({target:"Array",proto:!0,forced:h(function(){return!Array(1).includes()})},{includes:function(e){return Xh(this,e,arguments.length>1?arguments[1]:void 0)}}),eg("includes");var tg=h,rg=l.RegExp,og=tg(function(){var e=rg("a","y");return e.lastIndex=2,null!==e.exec("abcd")});og||tg(function(){return!rg("a","y").sticky});var ng={BROKEN_CARET:og||tg(function(){var e=rg("^r","gy");return e.lastIndex=2,null!==e.exec("str")})},ig=h,sg=l.RegExp,ag=ig(function(){var e=sg(".","s");return!(e.dotAll&&e.test("\n")&&"s"===e.flags)}),cg=h,dg=l.RegExp,lg=cg(function(){var e=dg("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")}),ug=v,hg=D,gg=Mn,pg=Nu,mg=ng,fg=qi,vg=xr.get,yg=ag,bg=lg,Sg=je("native-string-replace",String.prototype.replace),Cg=RegExp.prototype.exec,kg=Cg,wg=hg("".charAt),Pg=hg("".indexOf),Tg=hg("".replace),Eg=hg("".slice),Ng=function(){var e=/a/,t=/b*/g;return ug(Cg,e,"a"),ug(Cg,t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),Ig=mg.BROKEN_CARET,Dg=void 0!==/()??/.exec("")[1];(Ng||Dg||Ig||yg||bg)&&(kg=function(e){var t,r,o,n,i,s,a,c=this,d=vg(c),l=gg(e),u=d.raw;if(u)return u.lastIndex=c.lastIndex,t=ug(kg,u,l),c.lastIndex=u.lastIndex,t;var h=d.groups,g=Ig&&c.sticky,p=ug(pg,c),m=c.source,f=0,v=l;if(g&&(p=Tg(p,"y",""),-1===Pg(p,"g")&&(p+="g"),v=Eg(l,c.lastIndex),c.lastIndex>0&&(!c.multiline||c.multiline&&"\n"!==wg(l,c.lastIndex-1))&&(m="(?: "+m+")",v=" "+v,f++),r=new RegExp("^(?:"+m+")",p)),Dg&&(r=new RegExp("^"+m+"$(?!\\s)",p)),Ng&&(o=c.lastIndex),n=ug(Cg,g?r:c,v),g?n?(n.input=Eg(n.input,f),n[0]=Eg(n[0],f),n.index=c.lastIndex,c.lastIndex+=n[0].length):c.lastIndex=0:Ng&&n&&(c.lastIndex=c.global?n.index+n[0].length:o),Dg&&n&&n.length>1&&ug(Sg,n[0],r,function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(n[i]=void 0)}),n&&h)for(n.groups=s=fg(null),i=0;i<h.length;i++)s[(a=h[i])[0]]=n[a[1]];return n});nn({target:"RegExp",proto:!0,forced:/./.exec!==kg},{exec:kg});var Fg=nn,Bg=v,Lg=W,xg=Rt,Ag=Mn,Og=function(){var e=!1,t=/[ac]/;return t.exec=function(){return e=!0,/./.exec.apply(this,arguments)},!0===t.test("abc")&&e}(),Mg=/./.test;Fg({target:"RegExp",proto:!0,forced:!Og},{test:function(e){var t=xg(this),r=Ag(e),o=t.exec;if(!Lg(o))return Bg(Mg,t,r);var n=Bg(o,t,r);return null!==n&&(xg(n),!0)}});var _g=K,Rg=x,Hg=at("match"),Ug=function(e){var t;return _g(e)&&(void 0!==(t=e[Hg])?!!t:"RegExp"===Rg(e))},jg=TypeError,qg=at("match"),zg=nn,Vg=function(e){if(Ug(e))throw new jg("The method doesn't accept regular expressions");return e},$g=q,Gg=Mn,Wg=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[qg]=!1,"/./"[e](t)}catch(o){}}return!1},Jg=D("".indexOf);zg({target:"String",proto:!0,forced:!Wg("includes")},{includes:function(e){return!!~Jg(Gg($g(this)),Gg(Vg(e)),arguments.length>1?arguments[1]:void 0)}});let Kg,Qg,Yg;const Zg=function(){if("undefined"===typeof window)return!1;if(void 0===Yg){const e=navigator.userAgentData;if(null!=e&&e.mobile)return!0;Yg=/Android|BlackBerry|Windows Phone|IEMobile|Opera Mini|iPhone|iPad|iPod/i.test(navigator.userAgent)||(void 0===Kg&&(Kg=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document),Kg)||function(){if(void 0===Qg){const e=navigator.userAgentData;Qg=null!=e&&e.platform?"Android"===e.platform:navigator.userAgent.indexOf("Android")>=0}return Qg}()}return Yg};class Xg{canLoad(e){return e.packageName===Wh&&!Zg()}async load(e){if(!this.canLoad(e))throw new Error("Incompatible loop code details");return Promise.resolve().then(function(){return Zh}).then(t=>({module:t,details:e}))}}const ep={instantiateLoopCodeLoader:e=>Promise.resolve(new Xg)}},34445:(e,t)=>{"use strict";t.byteLength=function(e){var t=a(e),r=t[0],o=t[1];return 3*(r+o)/4-o},t.toByteArray=function(e){var t,r,i=a(e),s=i[0],c=i[1],d=new n(function(e,t,r){return 3*(t+r)/4-r}(0,s,c)),l=0,u=c>0?s-4:s;for(r=0;r<u;r+=4)t=o[e.charCodeAt(r)]<<18|o[e.charCodeAt(r+1)]<<12|o[e.charCodeAt(r+2)]<<6|o[e.charCodeAt(r+3)],d[l++]=t>>16&255,d[l++]=t>>8&255,d[l++]=255&t;2===c&&(t=o[e.charCodeAt(r)]<<2|o[e.charCodeAt(r+1)]>>4,d[l++]=255&t);1===c&&(t=o[e.charCodeAt(r)]<<10|o[e.charCodeAt(r+1)]<<4|o[e.charCodeAt(r+2)]>>2,d[l++]=t>>8&255,d[l++]=255&t);return d},t.fromByteArray=function(e){for(var t,o=e.length,n=o%3,i=[],s=16383,a=0,c=o-n;a<c;a+=s)i.push(d(e,a,a+s>c?c:a+s));1===n?(t=e[o-1],i.push(r[t>>2]+r[t<<4&63]+"==")):2===n&&(t=(e[o-2]<<8)+e[o-1],i.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return i.join("")};for(var r=[],o=[],n="undefined"!==typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0;s<64;++s)r[s]=i[s],o[i.charCodeAt(s)]=s;function a(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function c(e){return r[e>>18&63]+r[e>>12&63]+r[e>>6&63]+r[63&e]}function d(e,t,r){for(var o,n=[],i=t;i<r;i+=3)o=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]),n.push(c(o));return n.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},34805:(e,t,r)=>{"use strict";r.d(t,{B2:()=>o.J,IG:()=>i.J,Zj:()=>l});var o=r(35159),n=r(96689),i=r(38314),s=r(52059),a=r(66267),c=r(81918),d=r(34170);function l(e){let t;switch(e){case o.J:t=(0,c.Cw)().then(e=>e.getCodeLoaderFactory());break;case i.J:t=r.e(95647).then(r.bind(r,95647)).then(e=>e.CdnCodeLoaderFactory);break;case n.JL:t=(0,c.vJ)().then(e=>e.getNpmCodeLoader());break;case d.LoopRegistrationId:t=Promise.resolve().then(r.bind(r,34170)).then(e=>e.NpmCodeLoaderFactory);break;case s.JL:t=r.e(72520).then(r.bind(r,72520)).then(e=>e.NpmCodeLoaderFactory);break;case a.J:t=Promise.all([r.e(2977),r.e(55198)]).then(r.bind(r,55198)).then(e=>e.NpmCodeLoaderFactory);break;default:throw new Error(`Unknown registration ID: ${e}`)}const l={getLoopCodeLoaderFactory:async()=>t,LoopCodeLoaderFactoryProvider:null};return l.LoopCodeLoaderFactoryProvider=l,l}},35159:(e,t,r)=>{"use strict";r.d(t,{J:()=>o});const o="@1js/card-loop"},35237:(e,t,r)=>{e.exports=function(e){function t(e){let r,n,i,s=null;function a(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];if(!a.enabled)return;const i=a,s=Number(new Date),c=s-(r||s);i.diff=c,i.prev=r,i.curr=s,r=s,o[0]=t.coerce(o[0]),"string"!==typeof o[0]&&o.unshift("%O");let d=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,(e,r)=>{if("%%"===e)return"%";d++;const n=t.formatters[r];if("function"===typeof n){const t=o[d];e=n.call(i,t),o.splice(d,1),d--}return e}),t.formatArgs.call(i,o);(i.log||t.log).apply(i,o)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=o,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(n!==t.namespaces&&(n=t.namespaces,i=t.enabled(e)),i),set:e=>{s=e}}),"function"===typeof t.init&&t.init(a),a}function o(e,r){const o=t(this.namespace+("undefined"===typeof r?":":r)+e);return o.log=this.log,o}function n(e,t){let r=0,o=0,n=-1,i=0;for(;r<e.length;)if(o<t.length&&(t[o]===e[r]||"*"===t[o]))"*"===t[o]?(n=o,i=r,o++):(r++,o++);else{if(-1===n)return!1;o=n+1,i++,r=i}for(;o<t.length&&"*"===t[o];)o++;return o===t.length}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names,...t.skips.map(e=>"-"+e)].join(",");return t.enable(""),e},t.enable=function(e){t.save(e),t.namespaces=e,t.names=[],t.skips=[];const r=("string"===typeof e?e:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const o of r)"-"===o[0]?t.skips.push(o.slice(1)):t.names.push(o)},t.enabled=function(e){for(const r of t.skips)if(n(e,r))return!1;for(const r of t.names)if(n(e,r))return!0;return!1},t.humanize=r(97340),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach(r=>{t[r]=e[r]}),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},37450:(e,t,r)=>{"use strict";var o;r.d(t,{o:()=>o}),function(e){e.DataClassification={EssentialServiceMetadata:1,AccountData:2,SystemMetadata:4,OrganizationIdentifiableInformation:8,EndUserIdentifiableInformation:16,CustomerContent:32,AccessControl:64,PublicNonPersonalData:128,EndUserPseudonymousInformation:256,PublicPersonalData:512,SupportData:1024,DirectMeasurementData:2048,Everything:65535},e.DataFieldType={String:0,Boolean:1,Int64:2,Double:3,Guid:4},e.SamplingPolicy={NotSet:0,Measure:1,Diagnostics:2,CriticalBusinessImpact:191,CriticalCensus:192,CriticalExperimentation:193,CriticalUsage:194},e.PersistencePriority={NotSet:0,Normal:1,High:2},e.CostPriority={NotSet:0,Normal:1,High:2},e.DataCategories={NotSet:0,SoftwareSetup:1,ProductServiceUsage:2,ProductServicePerformance:4,DeviceConfiguration:8,InkingTypingSpeech:16},e.DiagnosticLevel={ReservedDoNotUse:0,Required:10,BasicEvent:10,Optional:100,FullEvent:100,RequiredServiceData:110,NecessaryServiceDataEvent:110,RequiredServiceDataForEssentialServices:120,AlwaysOnNecessaryServiceDataEvent:120},e.DnmInterval={Hourly:1,Daily:2},e.AllowedPartA={ReleaseAudienceGroup:1,WacRing:2,AppName:3,AppPlatform:4,AppVersion:5},e.CustomerContentType={None:0,MocaAddIn:1},e.LogLevel={Error:0,Warning:1,Info:2,Verbose:3},e.Category={Core:0,Sink:1,Transport:2},e.PrimaryIdentitySpace={UserObjectId:"UserObjectId",MSACID:"MSACID",OrgIdPuid:"OrgIdPuid",OrgIdPUID:"OrgIdPUID",OrgIdCID:"OrgIdCID",MsaPuid:"MsaPuid",MSAPUID:"MSAPUID",WopiAuth:"WopiAuth",ThirdParty:"ThirdParty",Other:"Other"},e.AudienceGroup={Automation:"Automation",Dogfood:"Dogfood",Microsoft:"Microsoft",Insiders:"Insiders",Production:"Production"},e.QosPillarName={Interruptions:"Interruptions",Open:"Open",Save:"Save",RealTimeCoauth:"RealTimeCoauth",NotebookNavigation:"NotebookNavigation",Fidelity:"Fidelity",AsyncCollab:"AsyncCollab",Present:"Present",ContentConsumption:"ContentConsumption",ContentCreation:"ContentCreation"}}(o||(o={}))},37513:(e,t,r)=>{"use strict";r.d(t,{a:()=>a});var o=r(488);const{dataCorruptionError:n,dataProcessingError:i,...s}=o.k,a={...s,genericNetworkError:"genericNetworkError",authorizationError:"authorizationError",fileNotFoundOrAccessDeniedError:"fileNotFoundOrAccessDeniedError",offlineError:"offlineError",unsupportedClientProtocolVersion:"unsupportedClientProtocolVersion",writeError:"writeError",fetchFailure:"fetchFailure",fetchTokenError:"fetchTokenError",incorrectServerResponse:"incorrectServerResponse",fileOverwrittenInStorage:"fileOverwrittenInStorage",deltaStreamConnectionForbidden:"deltaStreamConnectionForbidden",locationRedirection:"locationRedirection",fluidInvalidSchema:"fluidInvalidSchema",fileIsLocked:"fileIsLocked",outOfStorageError:"outOfStorageError"}},37805:(e,t,r)=>{"use strict";r.d(t,{Ed:()=>s,FT:()=>i,mI:()=>n,pb:()=>c,sb:()=>a});var o=r(78632);function n(e){return t=>t*e}function i(e){return()=>e}function s(e){return t=>Math.pow(2,t)*e}function a(){return()=>!1}function c(e,t,r){return d(e,[],new AbortController,t,r)}function d(e,t,r,n,i){let s;const a=[e(t.length).then(e=>(s=e,!1))];return i&&i.timeoutMs>0&&a.push((0,o.c)(i.timeoutMs,r.signal).then(()=>!0)),Promise.race(a).then(a=>(a&&(s=i.onTimeout()),!n?.filter(s)||t.length>=n.maxRetries?(r.abort(),{result:s,tries:t}):(0,o.c)(n.backoffFn(t.length,s),r.signal).then(()=>(t.push(s),d(e,t,r,n,i)))))}},38314:(e,t,r)=>{"use strict";r.d(t,{J:()=>o});const o="@ms/forms-loop"},39521:(e,t,r)=>{"use strict";r.d(t,{iq:()=>w,i5:()=>P,AV:()=>g,aX:()=>v,OQ:()=>k,vt:()=>S,dy:()=>p,qp:()=>C,cQ:()=>m,kc:()=>b,J4:()=>y});const o={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let n;const i=new Uint8Array(16);function s(){if(!n&&(n="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!n))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(i)}const a=[];for(let E=0;E<256;++E)a.push((E+256).toString(16).slice(1));function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return a[e[t+0]]+a[e[t+1]]+a[e[t+2]]+a[e[t+3]]+"-"+a[e[t+4]]+a[e[t+5]]+"-"+a[e[t+6]]+a[e[t+7]]+"-"+a[e[t+8]]+a[e[t+9]]+"-"+a[e[t+10]]+a[e[t+11]]+a[e[t+12]]+a[e[t+13]]+a[e[t+14]]+a[e[t+15]]}const d=function(e,t,r){if(o.randomUUID&&!t&&!e)return o.randomUUID();const n=(e=e||{}).random||(e.rng||s)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return c(n)};var l=r(83533),u=r(27250);const h=e=>null!==e&&!Array.isArray(e)&&"object"===typeof e;function g(e,t){const r={message:"string"===typeof e?.message?e.message:String(e)};if(h(e)){const{errorType:o,stack:n,name:i}=e;if("string"===typeof o&&(r.errorType=o),"string"===typeof n){const e="string"===typeof i?i:void 0;r.stack=((e,r)=>{if(!t)return e;const o=e.split("\n");return o.shift(),void 0!==r&&o.unshift(r),o.join("\n")})(n,e)}}return r}const p=e=>"function"===typeof e?.getTelemetryProperties;function m(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((0,l.X)(e))return e.addTelemetryProperties(t.props??{}),e;const{message:r,stack:o}=g(e,!1),n=new T({message:r,stack:o});if("object"===typeof e&&null!==e){const t=e;let r;"canRetry"in e&&(r??={},r.canRetry=t.canRetry),"retryAfterSeconds"in e&&(r??={},r.retryAfterSeconds=t.retryAfterSeconds),void 0!==r&&Object.assign(n,r)}"object"!==typeof e&&n.addTelemetryProperties({typeofError:typeof e});const i=w.typeCheck(e)?e.getTelemetryProperties():{untrustedOrigin:1};return n.addTelemetryProperties({...i,...t.props}),n}let f;function v(e){return function(e){const t=Error,r=t.stackTraceLimit;void 0!==e&&(t.stackTraceLimit=e);const o=new Error("<<generated stack>>");if(void 0===f&&(f=void 0!==o.stack),f)return t.stackTraceLimit=r,o;try{throw o}catch(n){return t.stackTraceLimit=r,n}}(e).stack}function y(e,t){const{message:r,stack:o}=g(e,!1),n=t(r);return void 0!==o&&b(n,o),S(e)&&n.addTelemetryProperties({untrustedOrigin:1}),(0,l.f)(e)&&(n.overwriteErrorInstanceId(e.errorInstanceId),n.addTelemetryProperties({innerErrorInstanceId:e.errorInstanceId})),p(e)&&n.addTelemetryProperties(e.getTelemetryProperties()),n}function b(e,t){try{Object.assign(e,{stack:t})}catch{e.addTelemetryProperties({stack2:t})}}function S(e){if(w.typeCheck(e)){if(e.errorType===P){const t=e.getTelemetryProperties();return 1===t.untrustedOrigin||Boolean(t.errorRunningExternalCode)}return!1}return!0}function C(e){return"string"===typeof e?.tag}const k=()=>{const e=new WeakSet;return(t,r)=>{if("object"===typeof r&&null!==r){if(e.has(r))return"<removed/circular>";e.add(r)}return r}};class w extends Error{get errorInstanceId(){return this._errorInstanceId}overwriteErrorInstanceId(e){this._errorInstanceId=e}constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;super(e),this.omitPropsFromLogging=r,this._errorInstanceId=d(),r.add("omitPropsFromLogging"),r.add("_errorInstanceId"),t&&this.addTelemetryProperties(t)}static typeCheck(e){return"object"===typeof e&&null!==e&&("function"===typeof e.addTelemetryProperties&&"function"===typeof e.getTelemetryProperties&&"string"===typeof e.errorInstanceId)}addTelemetryProperties(e){!function(e,t){for(const[r,o]of Object.entries(t))void 0===e[r]&&(e[r]=o)}(this,e)}getTelemetryProperties(){const e={};for(const t of Object.keys(this)){if(this.omitPropsFromLogging.has(t))continue;const r=this[t];e[t]=(0,u.fV)(r)}return{...e,stack:this.stack,message:this.message,errorInstanceId:this._errorInstanceId}}}const P="genericError";class T extends w{constructor(e){super(e.message),this.errorType=P,void 0!==e.stack&&b(this,e.stack)}}},39773:(e,t,r)=>{"use strict";r.d(t,{EW:()=>s,I9:()=>a,eb:()=>i});var o=r(488),n=r(74621);n.iq;class i extends n.iq{constructor(e,t){super(e,{...t,usageError:!0}),this.errorType=o.k.usageError}}class s extends n.iq{constructor(e,t){super(e,{...t,dataProcessingError:1}),this.errorType=o.k.dataCorruptionError,this.canRetry=!1}}class a extends n.iq{constructor(e,t){super(e,t),this.errorType=o.k.dataProcessingError,this.canRetry=!1}static create(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=arguments.length>4?arguments[4]:void 0;const i=Error,s=i.stackTraceLimit;try{void 0!==n&&(i.stackTraceLimit=n);const s=a.wrapIfUnrecognized(e,t,r);return s.addTelemetryProperties(o),s}finally{void 0!==n&&(i.stackTraceLimit=s)}}static wrapIfUnrecognized(e,t,r){const o={dataProcessingError:1,dataProcessingCodepath:t,...void 0===r?void 0:c(r)},i=(0,n.cQ)(e,{props:o});if((0,n.vt)(i)||i.errorType===n.i5){const e=(0,n.J4)(i,e=>new a(e));return e.addTelemetryProperties(i.getTelemetryProperties()),e}return i}}const c=e=>({messageClientId:null===e.clientId?"null":e.clientId,messageSequenceNumber:e.sequenceNumber,messageClientSequenceNumber:e.clientSequenceNumber,messageReferenceSequenceNumber:e.referenceSequenceNumber,messageMinimumSequenceNumber:e.minimumSequenceNumber,messageTimestamp:e.timestamp})},40118:(e,t,r)=>{"use strict";r.d(t,{n:()=>n});var o=r(91947);class n{constructor(){this.tokenMap=new Map,this.pendingRequests=new Map,this.tokenExpirationDuration=18e4,this.isCacheEnabled=!1}generateTokenKey(e,t){return`${e}|${t}`}static getCurrentTime(){return(new Date).getTime()}async getToken(e,t,r){if(!this.isCacheEnabled){return{token:await(0,o.gf)(e,t)}}const i=this.generateTokenKey(e,t);if(r)this.tokenMap.delete(i);else{const e=this.tokenMap.get(i);if(e){if(!(n.getCurrentTime()>=e.expiration)){return{token:e.token,fromCache:!0}}this.tokenMap.delete(i)}}const s=this.pendingRequests.get(i);if(s){return{token:await s}}const a=(0,o.gf)(e,t);this.pendingRequests.set(i,a);try{const e=await a;return this.tokenMap.set(i,{token:e,expiration:n.getCurrentTime()+this.tokenExpirationDuration}),{token:e}}finally{this.pendingRequests.delete(i)}}static GetInstance(){return null==this.instance&&(this.instance=new n),this.instance}}n.instance=void 0},40635:(e,t,r)=>{"use strict";r.d(t,{y:()=>u,g:()=>h});var o=r(73370),n=r(93537),i=r(75812),s=r(75964);var a=r(43172),c=r(95996);function d(){return"undefined"!==typeof performance?performance.now():Date.now()}function l(e){return{tenantId:e.tenantId,request:{url:e.url,method:e.requestInit?.method?e.requestInit.method:"GET"}}}function u(e){return p(e,l(e))}function h(e){return p(e,l(e))}const g=3;async function p(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const c=e.retryPolicy?.maxAuthRetries??g,l=d(),{token:u,authorizationHeader:h}=await e.getToken(t),f=d(),{url:v,requestInit:y,retryPolicy:b,timeoutMs:S,tokenPolicy:C,additionalRequestHeaders:k}=e,{url:w,request:P}=(0,o.p)(v,y,u,h||`${o.Y} ${u}`,C||{});k&&P&&k.forEach((e,t)=>{!function(e,t,r){if(void 0===e.headers){const o=new Headers;o.set(t,r),e.headers=o}else if(e.headers instanceof Headers)e.headers.has(t)||e.headers.set(t,r);else if(Array.isArray(e.headers)){for(let r=0;r<e.headers.length;r+=1)if(e.headers[r][0]===t)return;e.headers=[...e.headers,[t,r]]}else e.hasOwnProperty("headers")&&(e.headers={[t]:r,...e.headers})}(P,t,e)});const T=e=>401===e.status&&function(e){const t=e.get("www-authenticate");if(!t)return;let r,o=!1;return t.split(",").map(e=>{const t=e.split("=");if(t.length>=2)if(o||"error"!==t[0].trim().toLowerCase()){if(!r&&"claims"===t[0].trim().toLowerCase()){const t=(0,s.X)(e.substring(e.indexOf("=")+1).trim());t&&(r=atob(t))}}else o="insufficient_claims"===(0,s.X)(t[1].trim().toLowerCase())}),o?r:void 0}(e.headers)||void 0,E=e=>401===e.status&&void 0!==function(e){const t=e.get("www-authenticate");if(!t)return;let r,o=!1;for(const n of t.split(",")){const e=n.split("=");e.length>=2&&(o||"error"!==e[0].trim().toLowerCase()?void 0===r&&"error_description"===e[0].trim().toLowerCase()&&(r=(0,s.X)(e[1].trim())):o="invalid_token"===(0,s.X)(e[1].trim().toLowerCase()))}return o?{errorDescription:r}:void 0}(e.headers)||void 0,N=e=>{if(401===e.status){const r=(0,a.J)(e.headers);if(r&&r!==t.tenantId)return r}};let I,D;if(b&&(I={...b,filter:e=>!T(e)&&!E(e)&&!N(e)&&b.filter(e)}),"logger"in e&&"nameForLogging"in e){const t=async(t,r)=>{const o=await(e.getAdditionalProps?.(t,r));return{tokenFetchDurationMs:Math.round(f-l),...o}};D=await(0,i.R)(w,P,e.nameForLogging,e.logger,e.doNotLogOnSuccess,I,S,t)}else D=await(0,n.J5)(w,P,I,S);if(r<=c){const o=r===c,n=T(D.result);if(n)return m(e,"InsufficientClaims",r,o),p(e,{...t,claims:n,forceRefresh:!0},r+1);if(E(D.result))return m(e,"InvalidToken",r,o),p(e,{...t,forceRefresh:!0},r+1);const i=N(D.result);if(i)return m(e,"SpecificTenant",r,o),p(e,{...t,tenantId:i},r+1)}return D}function m(e,t,r,o){"logger"in e&&"nameForLogging"in e&&(0,c.Ot)(e.logger,{eventName:`Retry${e.nameForLogging}OnAuthError`,subCategory:t,attempt:r,isFinalAttempt:o})}},40684:(e,t,r)=>{"use strict";r.d(t,{QK:()=>c,qH:()=>h,tR:()=>a,zr:()=>m});var o=r(899),n=r(31942),i=r(56142),s=r(69235);let a=function(e){return e[e.GetToken=1e3]="GetToken",e[e.SizeChanged=1001]="SizeChanged",e[e.GetFeature=1002]="GetFeature",e[e.SendTelemetry=1003]="SendTelemetry",e[e.ReportActivityResult=1004]="ReportActivityResult",e[e.GetUserIdentity=1006]="GetUserIdentity",e[e.GetNativeInfo=1007]="GetNativeInfo",e[e.ShowPermissionCallout=1008]="ShowPermissionCallout",e[e.CaretPositionChanged=1009]="CaretPositionChanged",e[e.OnAtMention=1010]="OnAtMention",e[e.OnInvokeFromInjectedScript=1011]="OnInvokeFromInjectedScript",e[e.FluidComponentCreated=1012]="FluidComponentCreated",e[e.IsChangeGateEnabled=1013]="IsChangeGateEnabled",e[e.FluidHostIsReady=1015]="FluidHostIsReady",e[e.PassKeyToHost=1016]="PassKeyToHost",e[e.GetDataForCreate=1017]="GetDataForCreate",e[e.SetCanProvideDataToSave=1018]="SetCanProvideDataToSave",e[e.ProvideDataToSave=1019]="ProvideDataToSave",e[e.FluidComponentEdited=1020]="FluidComponentEdited",e[e.TeachingCalloutDismissed=1021]="TeachingCalloutDismissed",e[e.TeachingCalloutShown=1022]="TeachingCalloutShown",e[e.FluidComponentCreateFailed=1023]="FluidComponentCreateFailed",e[e.InvokeMessageExtensionCommand=1024]="InvokeMessageExtensionCommand",e[e.LoopComponentCreated=1025]="LoopComponentCreated",e[e.Dehydrate=1026]="Dehydrate",e[e.SaveEmbeddedData=1027]="SaveEmbeddedData",e[e.UpdateLoopInfo=1028]="UpdateLoopInfo",e[e.CursUpDownFromE2o=1029]="CursUpDownFromE2o",e[e.ClearYCaretCoordinate=1030]="ClearYCaretCoordinate",e[e.GetOcps=1031]="GetOcps",e[e.ScrollHost=1032]="ScrollHost",e}({}),c=function(e){return e[e.Hydrate=0]="Hydrate",e}({});class d extends Error{constructor(e,t){super(t),this.errorCode=void 0,this.errorCode=e}}let l=function(e){return e[e.fixed=0]="fixed",e[e.growHeight=1]="growHeight",e[e.grow=2]="grow",e}({});function u(e){return a[e]}function h(e){switch(e){case n.S.grow:return l.grow;case n.S.growHeight:return l.growHeight;case n.S.fixedByHost:return l.fixed;default:throw new s.uV("Unknown LayoutMode")}}let g=0;const p=!1;function m(e,t){return new Promise((r,n)=>{try{const c=function(e){if(p){++g;const t=a[e];return(0,i.Rm)(`[${g}] Native method called: ${t}`),{invocation:g,methodName:t,timeStart:performance.now()}}return}(e);o.qn&&o.qn.Execute||n(new d(void 0,"Native requests are not supported.")),o.qn.Execute(e,t,(t,o)=>{if(function(e){if(e){const t=performance.now()-e.timeStart;(0,i.Rm)(`[${e.invocation}] Native method return: ${e.methodName} (Duration: ${t})`)}}(c),!t)throw new s.uV("The callback did not provide any data.");const a=t.toArray();if(!Array.isArray(a))throw new s.uV("The callback data is not an array.");0===a.length&&a.push("number"===typeof o?o:0);const[l,...h]=a;if("number"!==typeof l)throw new s.uV("The first item returned should be an error code number.");if(0===l)r(h);else{const[t]=h,r="string"===typeof t?`\n${t}`:"";n(new d(l,`${u(e)} native method failed. Error code: ${l}${r}`))}})}catch(c){n(new d(void 0,`Unexpected response from native request: ${u(e)}.\n${c instanceof Error?c.message:c}`))}})}},40695:(e,t,r)=>{"use strict";r.d(t,{B:()=>i,b:()=>n});var o=r(56851);function n(e,t,r,n,s){return void 0===s&&(s=!1),function(e,t){var r="";!0===t&&(r=" /* @deprecated */");return e.listTextColor=e.listText+r,e.menuItemBackgroundChecked+=r,e.warningHighlight+=r,e.warningText=e.messageText+r,e.successText+=r,e}(i(e,t,(0,o.__assign)({primaryButtonBorder:"transparent",errorText:n?"#F1707B":"#a4262c",messageText:n?"#F3F2F1":"#323130",messageLink:n?"#6CB8F6":"#005A9E",messageLinkHovered:n?"#82C7FF":"#004578",infoIcon:n?"#C8C6C4":"#605e5c",errorIcon:n?"#F1707B":"#A80000",blockingIcon:n?"#442726":"#FDE7E9",warningIcon:n?"#C8C6C4":"#797775",severeWarningIcon:n?"#FCE100":"#D83B01",successIcon:n?"#92C353":"#107C10",infoBackground:n?"#323130":"#f3f2f1",errorBackground:n?"#442726":"#FDE7E9",blockingBackground:n?"#442726":"#FDE7E9",warningBackground:n?"#433519":"#FFF4CE",severeWarningBackground:n?"#4F2A0F":"#FED9CC",successBackground:n?"#393D1B":"#DFF6DD",warningHighlight:n?"#fff100":"#ffb900",successText:n?"#92c353":"#107C10"},r),n),s)}function i(e,t,r,n,i){void 0===i&&(i=!1);var s={},a=e||{},c=a.white,d=a.black,l=a.themePrimary,u=a.themeDark,h=a.themeDarker,g=a.themeDarkAlt,p=a.themeLighter,m=a.neutralLight,f=a.neutralLighter,v=a.neutralDark,y=a.neutralQuaternary,b=a.neutralQuaternaryAlt,S=a.neutralPrimary,C=a.neutralSecondary,k=a.neutralSecondaryAlt,w=a.neutralTertiary,P=a.neutralTertiaryAlt,T=a.neutralLighterAlt,E=a.accent;return c&&(s.bodyBackground=c,s.bodyFrameBackground=c,s.accentButtonText=c,s.buttonBackground=c,s.primaryButtonText=c,s.primaryButtonTextHovered=c,s.primaryButtonTextPressed=c,s.inputBackground=c,s.inputForegroundChecked=c,s.listBackground=c,s.menuBackground=c,s.cardStandoutBackground=c),d&&(s.bodyTextChecked=d,s.buttonTextCheckedHovered=d),l&&(s.link=l,s.primaryButtonBackground=l,s.inputBackgroundChecked=l,s.inputIcon=l,s.inputFocusBorderAlt=l,s.menuIcon=l,s.menuHeader=l,s.accentButtonBackground=l),u&&(s.primaryButtonBackgroundPressed=u,s.inputBackgroundCheckedHovered=u,s.inputIconHovered=u),h&&(s.linkHovered=h),g&&(s.primaryButtonBackgroundHovered=g),p&&(s.inputPlaceholderBackgroundChecked=p),m&&(s.bodyBackgroundChecked=m,s.bodyFrameDivider=m,s.bodyDivider=m,s.variantBorder=m,s.buttonBackgroundCheckedHovered=m,s.buttonBackgroundPressed=m,s.listItemBackgroundChecked=m,s.listHeaderBackgroundPressed=m,s.menuItemBackgroundPressed=m,s.menuItemBackgroundChecked=m),f&&(s.bodyBackgroundHovered=f,s.buttonBackgroundHovered=f,s.buttonBackgroundDisabled=f,s.buttonBorderDisabled=f,s.primaryButtonBackgroundDisabled=f,s.disabledBackground=f,s.listItemBackgroundHovered=f,s.listHeaderBackgroundHovered=f,s.menuItemBackgroundHovered=f),y&&(s.primaryButtonTextDisabled=y,s.disabledSubtext=y),b&&(s.listItemBackgroundCheckedHovered=b),w&&(s.disabledBodyText=w,s.variantBorderHovered=(null===r||void 0===r?void 0:r.variantBorderHovered)||w,s.buttonTextDisabled=w,s.inputIconDisabled=w,s.disabledText=w),S&&(s.bodyText=S,s.actionLink=S,s.buttonText=S,s.inputBorderHovered=S,s.inputText=S,s.listText=S,s.menuItemText=S),T&&(s.bodyStandoutBackground=T,s.defaultStateBackground=T),v&&(s.actionLinkHovered=v,s.buttonTextHovered=v,s.buttonTextChecked=v,s.buttonTextPressed=v,s.inputTextHovered=v,s.menuItemTextHovered=v),C&&(s.bodySubtext=C,s.focusBorder=C,s.inputBorder=C,s.smallInputBorder=C,s.inputPlaceholderText=C),k&&(s.buttonBorder=k),P&&(s.disabledBodySubtext=P,s.disabledBorder=P,s.buttonBackgroundChecked=P,s.menuDivider=P),E&&(s.accentButtonBackground=E),(null===t||void 0===t?void 0:t.elevation4)&&(s.cardShadow=t.elevation4),!n&&(null===t||void 0===t?void 0:t.elevation8)?s.cardShadowHovered=t.elevation8:s.variantBorderHovered&&(s.cardShadowHovered="0 0 1px "+s.variantBorderHovered),s=(0,o.__assign)((0,o.__assign)({},s),r)}},41395:(e,t,r)=>{"use strict";r.d(t,{E:()=>o});const o={...r(37513).a,invalidFileNameError:"invalidFileNameError",snapshotTooBig:"snapshotTooBig",fetchTimeout:"fetchTimeout",fluidNotEnabled:"fluidNotEnabled",cannotCatchUp:"cannotCatchUp",serviceReadOnly:"serviceReadOnly",blockedIPAddress:"blockedIPAddress"}},41818:(e,t,r)=>{"use strict";r.d(t,{Km:()=>n,Ss:()=>a,Xg:()=>i});var o=r(34445);function n(e,t){switch(t){case"base64":return o.fromByteArray(e);case"utf8":case"utf-8":case void 0:return(new TextDecoder).decode(e);default:throw new Error("invalid/unsupported encoding")}}const i=(e,t)=>a.from(e,t).buffer;function s(e){const t=e;return e instanceof ArrayBuffer||"object"===typeof t&&null!==t&&"number"===typeof t.byteLength&&"function"===typeof t.slice&&void 0===t.byteOffset&&void 0===t.buffer}class a extends Uint8Array{toString(e){return n(this,e)}static from(e,t,r){if("string"===typeof e)return a.fromString(e,t);if(null!==e&&"object"===typeof e&&s(e.buffer))return a.fromArrayBuffer(e.buffer,e.byteOffset,e.byteLength);if(s(e))return a.fromArrayBuffer(e,t,r);throw new TypeError("Input value was neither a string nor an ArrayBuffer.")}static fromArrayBuffer(e,t,r){const o=t??0,n=r??e.byteLength-o;if(o<0||o>e.byteLength||n<0||n+o>e.byteLength)throw new RangeError("Invalid range specified.");return new a(e,o,n)}static fromString(e,t){switch(t){case"base64":{const t=this.sanitizeBase64(e),r=o.toByteArray(t);return new a(r.buffer)}case"utf8":case"utf-8":case void 0:{const t=(new TextEncoder).encode(e);return new a(t.buffer)}default:throw new Error("invalid/unsupported encoding")}}static isBuffer(e){throw new Error("unimplemented")}static sanitizeBase64(e){let t=e;if(t=t.split("=")[0],t=t.replace(/[^\w+-/]/g,""),t.length%4!==0){t+=["","===","==","="][t.length%4]}return t}}},43172:(e,t,r)=>{"use strict";r.d(t,{J:()=>n});var o=r(73370);function n(e){const t=e.get("www-authenticate");if(!t)return;const r=t.indexOf(o.Y);if(r<0)return;let n;return t.substring(r+o.Y.length).split(",").map(e=>{if(!n){const t=e.split("=");t.length>=2&&"realm"===t[0].trim().toLowerCase()&&(n=JSON.parse(t[1].trim()))}}),n}},43483:(e,t,r)=>{"use strict";r.d(t,{$S:()=>D,$T:()=>P,AV:()=>N,CE:()=>w,D9:()=>b,EM:()=>T,GC:()=>j,JW:()=>I,KK:()=>y,ON:()=>d,Oh:()=>o,Os:()=>L,Q1:()=>i,QH:()=>_,QJ:()=>V,Ql:()=>l,T_:()=>f,Us:()=>O,Vu:()=>U,Vv:()=>m,WB:()=>v,X1:()=>$,Xk:()=>k,Xv:()=>c,Y3:()=>G,YA:()=>C,Z:()=>A,Z1:()=>a,Zp:()=>M,Zz:()=>z,bK:()=>S,c8:()=>n,ik:()=>u,jF:()=>h,je:()=>p,pT:()=>R,qn:()=>H,s$:()=>F,t1:()=>q,ti:()=>s,um:()=>x,wL:()=>E,wv:()=>g,z1:()=>B});const o={2:"#050505",4:"#0a0a0a",6:"#0f0f0f",8:"#141414",10:"#1a1a1a",12:"#1f1f1f",14:"#242424",16:"#292929",18:"#2e2e2e",20:"#333333",22:"#383838",24:"#3d3d3d",26:"#424242",28:"#474747",30:"#4d4d4d",32:"#525252",34:"#575757",36:"#5c5c5c",38:"#616161",40:"#666666",42:"#6b6b6b",44:"#707070",46:"#757575",48:"#7a7a7a",50:"#808080",52:"#858585",54:"#8a8a8a",56:"#8f8f8f",58:"#949494",60:"#999999",62:"#9e9e9e",64:"#a3a3a3",66:"#a8a8a8",68:"#adadad",70:"#b3b3b3",72:"#b8b8b8",74:"#bdbdbd",76:"#c2c2c2",78:"#c7c7c7",80:"#cccccc",82:"#d1d1d1",84:"#d6d6d6",86:"#dbdbdb",88:"#e0e0e0",90:"#e6e6e6",92:"#ebebeb",94:"#f0f0f0",96:"#f5f5f5",98:"#fafafa"},n={5:"rgba(255, 255, 255, 0.05)",10:"rgba(255, 255, 255, 0.1)",20:"rgba(255, 255, 255, 0.2)",30:"rgba(255, 255, 255, 0.3)",40:"rgba(255, 255, 255, 0.4)",50:"rgba(255, 255, 255, 0.5)",60:"rgba(255, 255, 255, 0.6)",70:"rgba(255, 255, 255, 0.7)",80:"rgba(255, 255, 255, 0.8)",90:"rgba(255, 255, 255, 0.9)"},i={5:"rgba(0, 0, 0, 0.05)",10:"rgba(0, 0, 0, 0.1)",20:"rgba(0, 0, 0, 0.2)",30:"rgba(0, 0, 0, 0.3)",40:"rgba(0, 0, 0, 0.4)",50:"rgba(0, 0, 0, 0.5)",60:"rgba(0, 0, 0, 0.6)",70:"rgba(0, 0, 0, 0.7)",80:"rgba(0, 0, 0, 0.8)",90:"rgba(0, 0, 0, 0.9)"},s={5:"rgba(26, 26, 26, 0.05)",10:"rgba(26, 26, 26, 0.1)",20:"rgba(26, 26, 26, 0.2)",30:"rgba(26, 26, 26, 0.3)",40:"rgba(26, 26, 26, 0.4)",50:"rgba(26, 26, 26, 0.5)",60:"rgba(26, 26, 26, 0.6)",70:"rgba(26, 26, 26, 0.7)",80:"rgba(26, 26, 26, 0.8)",90:"rgba(26, 26, 26, 0.9)"},a={5:"rgba(31, 31, 31, 0.05)",10:"rgba(31, 31, 31, 0.1)",20:"rgba(31, 31, 31, 0.2)",30:"rgba(31, 31, 31, 0.3)",40:"rgba(31, 31, 31, 0.4)",50:"rgba(31, 31, 31, 0.5)",60:"rgba(31, 31, 31, 0.6)",70:"rgba(31, 31, 31, 0.7)",80:"rgba(31, 31, 31, 0.8)",90:"rgba(31, 31, 31, 0.9)"},c={5:"rgba(36, 36, 36, 0.05)",10:"rgba(36, 36, 36, 0.1)",20:"rgba(36, 36, 36, 0.2)",30:"rgba(36, 36, 36, 0.3)",40:"rgba(36, 36, 36, 0.4)",50:"rgba(36, 36, 36, 0.5)",60:"rgba(36, 36, 36, 0.6)",70:"rgba(36, 36, 36, 0.7)",80:"rgba(36, 36, 36, 0.8)",90:"rgba(36, 36, 36, 0.9)"},d="#ffffff",l="#000000",u={shade50:"#130204",shade40:"#230308",shade30:"#420610",shade20:"#590815",shade10:"#690a19",primary:"#750b1c",tint10:"#861b2c",tint20:"#962f3f",tint30:"#ac4f5e",tint40:"#d69ca5",tint50:"#e9c7cd",tint60:"#f9f0f2"},h={shade50:"#200205",shade40:"#3b0509",shade30:"#6e0811",shade20:"#960b18",shade10:"#b10e1c",primary:"#c50f1f",tint10:"#cc2635",tint20:"#d33f4c",tint30:"#dc626d",tint40:"#eeacb2",tint50:"#f6d1d5",tint60:"#fdf3f4"},g={shade50:"#210809",shade40:"#3f1011",shade30:"#751d1f",shade20:"#9f282b",shade10:"#bc2f32",primary:"#d13438",tint10:"#d7494c",tint20:"#dc5e62",tint30:"#e37d80",tint40:"#f1bbbc",tint50:"#f8dadb",tint60:"#fdf6f6"},p={shade50:"#230900",shade40:"#411200",shade30:"#7a2101",shade20:"#a62d01",shade10:"#c43501",primary:"#da3b01",tint10:"#de501c",tint20:"#e36537",tint30:"#e9835e",tint40:"#f4bfab",tint50:"#f9dcd1",tint60:"#fdf6f3"},m={shade50:"#200d03",shade40:"#3d1805",shade30:"#712d09",shade20:"#9a3d0c",shade10:"#b6480e",primary:"#ca5010",tint10:"#d06228",tint20:"#d77440",tint30:"#df8e64",tint40:"#efc4ad",tint50:"#f7dfd2",tint60:"#fdf7f4"},f={shade50:"#271002",shade40:"#4a1e04",shade30:"#8a3707",shade20:"#bc4b09",shade10:"#de590b",primary:"#f7630c",tint10:"#f87528",tint20:"#f98845",tint30:"#faa06b",tint40:"#fdcfb4",tint50:"#fee5d7",tint60:"#fff9f5"},v={shade50:"#291600",shade40:"#4d2a00",shade30:"#8f4e00",shade20:"#c26a00",shade10:"#e67e00",primary:"#ff8c00",tint10:"#ff9a1f",tint20:"#ffa83d",tint30:"#ffba66",tint40:"#ffddb3",tint50:"#ffedd6",tint60:"#fffaf5"},y={shade50:"#251a00",shade40:"#463100",shade30:"#835b00",shade20:"#b27c00",shade10:"#d39300",primary:"#eaa300",tint10:"#edad1c",tint20:"#efb839",tint30:"#f2c661",tint40:"#f9e2ae",tint50:"#fcefd3",tint60:"#fefbf4"},b={shade50:"#282400",shade40:"#4c4400",shade30:"#817400",shade20:"#c0ad00",shade10:"#e4cc00",primary:"#fde300",tint10:"#fde61e",tint20:"#fdea3d",tint30:"#feee66",tint40:"#fef7b2",tint50:"#fffad6",tint60:"#fffef5"},S={shade50:"#1f1900",shade40:"#3a2f00",shade30:"#6c5700",shade20:"#937700",shade10:"#ae8c00",primary:"#c19c00",tint10:"#c8a718",tint20:"#d0b232",tint30:"#dac157",tint40:"#ecdfa5",tint50:"#f5eece",tint60:"#fdfbf2"},C={shade50:"#181202",shade40:"#2e2103",shade30:"#553e06",shade20:"#745408",shade10:"#89640a",primary:"#986f0b",tint10:"#a47d1e",tint20:"#b18c34",tint30:"#c1a256",tint40:"#e0cea2",tint50:"#efe4cb",tint60:"#fbf8f2"},k={shade50:"#170e07",shade40:"#2b1a0e",shade30:"#50301a",shade20:"#6c4123",shade10:"#804d29",primary:"#8e562e",tint10:"#9c663f",tint20:"#a97652",tint30:"#bb8f6f",tint40:"#ddc3b0",tint50:"#edded3",tint60:"#faf7f4"},w={shade50:"#0c1501",shade40:"#162702",shade30:"#294903",shade20:"#376304",shade10:"#427505",primary:"#498205",tint10:"#599116",tint20:"#6ba02b",tint30:"#85b44c",tint40:"#bdd99b",tint50:"#dbebc7",tint60:"#f6faf0"},P={shade50:"#002111",shade40:"#003d20",shade30:"#00723b",shade20:"#009b51",shade10:"#00b85f",primary:"#00cc6a",tint10:"#19d279",tint20:"#34d889",tint30:"#5ae0a0",tint40:"#a8f0cd",tint50:"#cff7e4",tint60:"#f3fdf8"},T={shade50:"#031a02",shade40:"#063004",shade30:"#0b5a08",shade20:"#0e7a0b",shade10:"#11910d",primary:"#13a10e",tint10:"#27ac22",tint20:"#3db838",tint30:"#5ec75a",tint40:"#a7e3a5",tint50:"#cef0cd",tint60:"#f2fbf2"},E={shade50:"#031403",shade40:"#052505",shade30:"#094509",shade20:"#0c5e0c",shade10:"#0e700e",primary:"#107c10",tint10:"#218c21",tint20:"#359b35",tint30:"#54b054",tint40:"#9fd89f",tint50:"#c9eac9",tint60:"#f1faf1"},N={shade50:"#021102",shade40:"#032003",shade30:"#063b06",shade20:"#085108",shade10:"#0a5f0a",primary:"#0b6a0b",tint10:"#1a7c1a",tint20:"#2d8e2d",tint30:"#4da64d",tint40:"#9ad29a",tint50:"#c6e7c6",tint60:"#f0f9f0"},I={shade50:"#001d1f",shade40:"#00373a",shade30:"#00666d",shade20:"#008b94",shade10:"#00a5af",primary:"#00b7c3",tint10:"#18bfca",tint20:"#32c8d1",tint30:"#58d3db",tint40:"#a6e9ed",tint50:"#cef3f5",tint60:"#f2fcfd"},D={shade50:"#001516",shade40:"#012728",shade30:"#02494c",shade20:"#026467",shade10:"#037679",primary:"#038387",tint10:"#159195",tint20:"#2aa0a4",tint30:"#4cb4b7",tint40:"#9bd9db",tint50:"#c7ebec",tint60:"#f0fafa"},F={shade50:"#000f12",shade40:"#001b22",shade30:"#00333f",shade20:"#004555",shade10:"#005265",primary:"#005b70",tint10:"#0f6c81",tint20:"#237d92",tint30:"#4496a9",tint40:"#94c8d4",tint50:"#c3e1e8",tint60:"#eff7f9"},B={shade50:"#001322",shade40:"#002440",shade30:"#004377",shade20:"#005ba1",shade10:"#006cbf",primary:"#0078d4",tint10:"#1a86d9",tint20:"#3595de",tint30:"#5caae5",tint40:"#a9d3f2",tint50:"#d0e7f8",tint60:"#f3f9fd"},L={shade50:"#000c16",shade40:"#00172a",shade30:"#002c4e",shade20:"#003b6a",shade10:"#00467e",primary:"#004e8c",tint10:"#125e9a",tint20:"#286fa8",tint30:"#4a89ba",tint40:"#9abfdc",tint50:"#c7dced",tint60:"#f0f6fa"},x={shade50:"#0d1126",shade40:"#182047",shade30:"#2c3c85",shade20:"#3c51b4",shade10:"#4760d5",primary:"#4f6bed",tint10:"#637cef",tint20:"#778df1",tint30:"#93a4f4",tint40:"#c8d1fa",tint50:"#e1e6fc",tint60:"#f7f9fe"},A={shade50:"#00061d",shade40:"#000c36",shade30:"#001665",shade20:"#001e89",shade10:"#0023a2",primary:"#0027b4",tint10:"#173bbd",tint20:"#3050c6",tint30:"#546fd2",tint40:"#a3b2e8",tint50:"#ccd5f3",tint60:"#f2f4fc"},O={shade50:"#120f25",shade40:"#221d46",shade30:"#3f3682",shade20:"#5649b0",shade10:"#6656d1",primary:"#7160e8",tint10:"#8172eb",tint20:"#9184ee",tint30:"#a79cf1",tint40:"#d2ccf8",tint50:"#e7e4fb",tint60:"#f9f8fe"},M={shade50:"#0f0717",shade40:"#1c0e2b",shade30:"#341a51",shade20:"#46236e",shade10:"#532982",primary:"#5c2e91",tint10:"#6b3f9e",tint20:"#7c52ab",tint30:"#9470bd",tint40:"#c6b1de",tint50:"#e0d3ed",tint60:"#f7f4fb"},_={shade50:"#160418",shade40:"#29072e",shade30:"#4c0d55",shade20:"#671174",shade10:"#7a1589",primary:"#881798",tint10:"#952aa4",tint20:"#a33fb1",tint30:"#b55fc1",tint40:"#d9a7e0",tint50:"#eaceef",tint60:"#faf2fb"},R={shade50:"#1f091d",shade40:"#3a1136",shade30:"#6d2064",shade20:"#932b88",shade10:"#af33a1",primary:"#c239b3",tint10:"#c94cbc",tint20:"#d161c4",tint30:"#da7ed0",tint40:"#edbbe7",tint50:"#f5daf2",tint60:"#fdf5fc"},H={shade50:"#1c0b1f",shade40:"#35153a",shade30:"#63276d",shade20:"#863593",shade10:"#9f3faf",primary:"#b146c2",tint10:"#ba58c9",tint20:"#c36bd1",tint30:"#cf87da",tint40:"#e6bfed",tint50:"#f2dcf5",tint60:"#fcf6fd"},U={shade50:"#24091b",shade40:"#441232",shade30:"#80215d",shade20:"#ad2d7e",shade10:"#cd3595",primary:"#e43ba6",tint10:"#e750b0",tint20:"#ea66ba",tint30:"#ef85c8",tint40:"#f7c0e3",tint50:"#fbddf0",tint60:"#fef6fb"},j={shade50:"#1f0013",shade40:"#390024",shade30:"#6b0043",shade20:"#91005a",shade10:"#ac006b",primary:"#bf0077",tint10:"#c71885",tint20:"#ce3293",tint30:"#d957a8",tint40:"#eca5d1",tint50:"#f5cee6",tint60:"#fcf2f9"},q={shade50:"#13000c",shade40:"#240017",shade30:"#43002b",shade20:"#5a003b",shade10:"#6b0045",primary:"#77004d",tint10:"#87105d",tint20:"#98246f",tint30:"#ad4589",tint40:"#d696c0",tint50:"#e9c4dc",tint60:"#faf0f6"},z={shade50:"#141313",shade40:"#252323",shade30:"#444241",shade20:"#5d5958",shade10:"#6e6968",primary:"#7a7574",tint10:"#8a8584",tint20:"#9a9594",tint30:"#afabaa",tint40:"#d7d4d4",tint50:"#eae8e8",tint60:"#faf9f9"},V={shade50:"#0f0e0e",shade40:"#1c1b1a",shade30:"#343231",shade20:"#474443",shade10:"#54514f",primary:"#5d5a58",tint10:"#706d6b",tint20:"#84817e",tint30:"#9e9b99",tint40:"#cecccb",tint50:"#e5e4e3",tint60:"#f8f8f8"},$={shade50:"#111314",shade40:"#1f2426",shade30:"#3b4447",shade20:"#505c60",shade10:"#5f6d71",primary:"#69797e",tint10:"#79898d",tint20:"#89989d",tint30:"#a0adb2",tint40:"#cdd6d8",tint50:"#e4e9ea",tint60:"#f8f9fa"},G={shade50:"#090a0b",shade40:"#111315",shade30:"#202427",shade20:"#2b3135",shade10:"#333a3f",primary:"#394146",tint10:"#4d565c",tint20:"#626c72",tint30:"#808a90",tint40:"#bcc3c7",tint50:"#dbdfe1",tint60:"#f6f7f8"}},43927:(e,t,r)=>{"use strict";r.d(t,{TQ:()=>o,dt:()=>n});const o=["red","green","darkOrange","yellow","berry","lightGreen","marigold"],n=["darkRed","cranberry","pumpkin","peach","gold","brass","brown","forest","seafoam","darkGreen","lightTeal","teal","steel","blue","royalBlue","cornflower","navy","lavender","purple","grape","lilac","pink","magenta","plum","beige","mink","platinum","anchor"]},44828:(e,t,r)=>{"use strict";r.d(t,{z:()=>i});var o=r(73895),n=void 0;try{n=window}catch(s){}function i(e){if((0,o.S)()&&"undefined"!==typeof n){var t=e;return t&&t.ownerDocument&&t.ownerDocument.defaultView?t.ownerDocument.defaultView:n}}},45799:(e,t,r)=>{"use strict";r.d(t,{a:()=>y});var o=r(51497),n=r(43927),i=r(6390);const s=n.TQ.reduce((e,t)=>{const r=t.slice(0,1).toUpperCase()+t.slice(1),n={[`colorPalette${r}Background1`]:o.yd[t].tint60,[`colorPalette${r}Background2`]:o.yd[t].tint40,[`colorPalette${r}Background3`]:o.yd[t].primary,[`colorPalette${r}Foreground1`]:o.yd[t].shade10,[`colorPalette${r}Foreground2`]:o.yd[t].shade30,[`colorPalette${r}Foreground3`]:o.yd[t].primary,[`colorPalette${r}BorderActive`]:o.yd[t].primary,[`colorPalette${r}Border1`]:o.yd[t].tint40,[`colorPalette${r}Border2`]:o.yd[t].primary};return Object.assign(e,n)},{});s.colorPaletteYellowForeground1=o.yd.yellow.shade30,s.colorPaletteRedForegroundInverted=o.yd.red.tint20,s.colorPaletteGreenForegroundInverted=o.yd.green.tint20,s.colorPaletteYellowForegroundInverted=o.yd.yellow.tint40;const a=n.dt.reduce((e,t)=>{const r=t.slice(0,1).toUpperCase()+t.slice(1),n={[`colorPalette${r}Background2`]:o.cc[t].tint40,[`colorPalette${r}Foreground2`]:o.cc[t].shade30,[`colorPalette${r}BorderActive`]:o.cc[t].primary};return Object.assign(e,n)},{}),c={...s,...a},d=Object.entries(i.s).reduce((e,t)=>{let[r,n]=t;const i=r.slice(0,1).toUpperCase()+r.slice(1),s={[`colorStatus${i}Background1`]:o.Ul[n].tint60,[`colorStatus${i}Background2`]:o.Ul[n].tint40,[`colorStatus${i}Background3`]:o.Ul[n].primary,[`colorStatus${i}Foreground1`]:o.Ul[n].shade10,[`colorStatus${i}Foreground2`]:o.Ul[n].shade30,[`colorStatus${i}Foreground3`]:o.Ul[n].primary,[`colorStatus${i}ForegroundInverted`]:o.Ul[n].tint30,[`colorStatus${i}BorderActive`]:o.Ul[n].primary,[`colorStatus${i}Border1`]:o.Ul[n].tint40,[`colorStatus${i}Border2`]:o.Ul[n].primary};return Object.assign(e,s)},{});d.colorStatusDangerBackground3Hover=o.Ul[i.s.danger].shade10,d.colorStatusDangerBackground3Pressed=o.Ul[i.s.danger].shade20,d.colorStatusWarningForeground1=o.Ul[i.s.warning].shade20,d.colorStatusWarningForeground3=o.Ul[i.s.warning].shade20,d.colorStatusWarningBorder2=o.Ul[i.s.warning].shade20;var l=r(43483);var u=r(17483),h=r(95829),g=r(45882),p=r(92708),m=r(27586),f=r(58511),v=r(91809);const y=e=>{const t=(e=>({colorNeutralForeground1:l.Oh[14],colorNeutralForeground1Hover:l.Oh[14],colorNeutralForeground1Pressed:l.Oh[14],colorNeutralForeground1Selected:l.Oh[14],colorNeutralForeground2:l.Oh[26],colorNeutralForeground2Hover:l.Oh[14],colorNeutralForeground2Pressed:l.Oh[14],colorNeutralForeground2Selected:l.Oh[14],colorNeutralForeground2BrandHover:e[80],colorNeutralForeground2BrandPressed:e[70],colorNeutralForeground2BrandSelected:e[80],colorNeutralForeground3:l.Oh[38],colorNeutralForeground3Hover:l.Oh[26],colorNeutralForeground3Pressed:l.Oh[26],colorNeutralForeground3Selected:l.Oh[26],colorNeutralForeground3BrandHover:e[80],colorNeutralForeground3BrandPressed:e[70],colorNeutralForeground3BrandSelected:e[80],colorNeutralForeground4:l.Oh[44],colorNeutralForegroundDisabled:l.Oh[74],colorNeutralForegroundInvertedDisabled:l.c8[40],colorBrandForegroundLink:e[70],colorBrandForegroundLinkHover:e[60],colorBrandForegroundLinkPressed:e[40],colorBrandForegroundLinkSelected:e[70],colorNeutralForeground2Link:l.Oh[26],colorNeutralForeground2LinkHover:l.Oh[14],colorNeutralForeground2LinkPressed:l.Oh[14],colorNeutralForeground2LinkSelected:l.Oh[14],colorCompoundBrandForeground1:e[80],colorCompoundBrandForeground1Hover:e[70],colorCompoundBrandForeground1Pressed:e[60],colorBrandForeground1:e[80],colorBrandForeground2:e[70],colorBrandForeground2Hover:e[60],colorBrandForeground2Pressed:e[30],colorNeutralForeground1Static:l.Oh[14],colorNeutralForegroundStaticInverted:l.ON,colorNeutralForegroundInverted:l.ON,colorNeutralForegroundInvertedHover:l.ON,colorNeutralForegroundInvertedPressed:l.ON,colorNeutralForegroundInvertedSelected:l.ON,colorNeutralForegroundInverted2:l.ON,colorNeutralForegroundOnBrand:l.ON,colorNeutralForegroundInvertedLink:l.ON,colorNeutralForegroundInvertedLinkHover:l.ON,colorNeutralForegroundInvertedLinkPressed:l.ON,colorNeutralForegroundInvertedLinkSelected:l.ON,colorBrandForegroundInverted:e[100],colorBrandForegroundInvertedHover:e[110],colorBrandForegroundInvertedPressed:e[100],colorBrandForegroundOnLight:e[80],colorBrandForegroundOnLightHover:e[70],colorBrandForegroundOnLightPressed:e[50],colorBrandForegroundOnLightSelected:e[60],colorNeutralBackground1:l.ON,colorNeutralBackground1Hover:l.Oh[96],colorNeutralBackground1Pressed:l.Oh[88],colorNeutralBackground1Selected:l.Oh[92],colorNeutralBackground2:l.Oh[98],colorNeutralBackground2Hover:l.Oh[94],colorNeutralBackground2Pressed:l.Oh[86],colorNeutralBackground2Selected:l.Oh[90],colorNeutralBackground3:l.Oh[96],colorNeutralBackground3Hover:l.Oh[92],colorNeutralBackground3Pressed:l.Oh[84],colorNeutralBackground3Selected:l.Oh[88],colorNeutralBackground4:l.Oh[94],colorNeutralBackground4Hover:l.Oh[98],colorNeutralBackground4Pressed:l.Oh[96],colorNeutralBackground4Selected:l.ON,colorNeutralBackground5:l.Oh[92],colorNeutralBackground5Hover:l.Oh[96],colorNeutralBackground5Pressed:l.Oh[94],colorNeutralBackground5Selected:l.Oh[98],colorNeutralBackground6:l.Oh[90],colorNeutralBackgroundInverted:l.Oh[16],colorNeutralBackgroundStatic:l.Oh[20],colorNeutralBackgroundAlpha:l.c8[50],colorNeutralBackgroundAlpha2:l.c8[80],colorSubtleBackground:"transparent",colorSubtleBackgroundHover:l.Oh[96],colorSubtleBackgroundPressed:l.Oh[88],colorSubtleBackgroundSelected:l.Oh[92],colorSubtleBackgroundLightAlphaHover:l.c8[70],colorSubtleBackgroundLightAlphaPressed:l.c8[50],colorSubtleBackgroundLightAlphaSelected:"transparent",colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:l.Q1[10],colorSubtleBackgroundInvertedPressed:l.Q1[30],colorSubtleBackgroundInvertedSelected:l.Q1[20],colorTransparentBackground:"transparent",colorTransparentBackgroundHover:"transparent",colorTransparentBackgroundPressed:"transparent",colorTransparentBackgroundSelected:"transparent",colorNeutralBackgroundDisabled:l.Oh[94],colorNeutralBackgroundInvertedDisabled:l.c8[10],colorNeutralStencil1:l.Oh[90],colorNeutralStencil2:l.Oh[98],colorNeutralStencil1Alpha:l.Q1[10],colorNeutralStencil2Alpha:l.Q1[5],colorBackgroundOverlay:l.Q1[40],colorScrollbarOverlay:l.Q1[50],colorBrandBackground:e[80],colorBrandBackgroundHover:e[70],colorBrandBackgroundPressed:e[40],colorBrandBackgroundSelected:e[60],colorCompoundBrandBackground:e[80],colorCompoundBrandBackgroundHover:e[70],colorCompoundBrandBackgroundPressed:e[60],colorBrandBackgroundStatic:e[80],colorBrandBackground2:e[160],colorBrandBackground2Hover:e[150],colorBrandBackground2Pressed:e[130],colorBrandBackground3Static:e[60],colorBrandBackground4Static:e[40],colorBrandBackgroundInverted:l.ON,colorBrandBackgroundInvertedHover:e[160],colorBrandBackgroundInvertedPressed:e[140],colorBrandBackgroundInvertedSelected:e[150],colorNeutralCardBackground:l.Oh[98],colorNeutralCardBackgroundHover:l.ON,colorNeutralCardBackgroundPressed:l.Oh[96],colorNeutralCardBackgroundSelected:l.Oh[92],colorNeutralCardBackgroundDisabled:l.Oh[94],colorNeutralStrokeAccessible:l.Oh[38],colorNeutralStrokeAccessibleHover:l.Oh[34],colorNeutralStrokeAccessiblePressed:l.Oh[30],colorNeutralStrokeAccessibleSelected:e[80],colorNeutralStroke1:l.Oh[82],colorNeutralStroke1Hover:l.Oh[78],colorNeutralStroke1Pressed:l.Oh[70],colorNeutralStroke1Selected:l.Oh[74],colorNeutralStroke2:l.Oh[88],colorNeutralStroke3:l.Oh[94],colorNeutralStrokeSubtle:l.Oh[88],colorNeutralStrokeOnBrand:l.ON,colorNeutralStrokeOnBrand2:l.ON,colorNeutralStrokeOnBrand2Hover:l.ON,colorNeutralStrokeOnBrand2Pressed:l.ON,colorNeutralStrokeOnBrand2Selected:l.ON,colorBrandStroke1:e[80],colorBrandStroke2:e[140],colorBrandStroke2Hover:e[120],colorBrandStroke2Pressed:e[80],colorBrandStroke2Contrast:e[140],colorCompoundBrandStroke:e[80],colorCompoundBrandStrokeHover:e[70],colorCompoundBrandStrokePressed:e[60],colorNeutralStrokeDisabled:l.Oh[88],colorNeutralStrokeInvertedDisabled:l.c8[40],colorTransparentStroke:"transparent",colorTransparentStrokeInteractive:"transparent",colorTransparentStrokeDisabled:"transparent",colorNeutralStrokeAlpha:l.Q1[5],colorNeutralStrokeAlpha2:l.c8[20],colorStrokeFocus1:l.ON,colorStrokeFocus2:l.Ql,colorNeutralShadowAmbient:"rgba(0,0,0,0.12)",colorNeutralShadowKey:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.06)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.07)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.20)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.24)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"}))(e);return{...u.V,...h.GR,...h.lm,...h.aI,...h.NM,...g.k,...v.b,...v.F,...m.S,...f.L,...t,...c,...d,...(0,p.t)(t.colorNeutralShadowAmbient,t.colorNeutralShadowKey),...(0,p.t)(t.colorBrandShadowAmbient,t.colorBrandShadowKey,"Brand")}}},45852:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});const o={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let n;const i=new Uint8Array(16);const s=[];for(let d=0;d<256;++d)s.push((d+256).toString(16).slice(1));function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(s[e[t+0]]+s[e[t+1]]+s[e[t+2]]+s[e[t+3]]+"-"+s[e[t+4]]+s[e[t+5]]+"-"+s[e[t+6]]+s[e[t+7]]+"-"+s[e[t+8]]+s[e[t+9]]+"-"+s[e[t+10]]+s[e[t+11]]+s[e[t+12]]+s[e[t+13]]+s[e[t+14]]+s[e[t+15]]).toLowerCase()}const c=function(e,t,r){if(o.randomUUID&&!t&&!e)return o.randomUUID();const s=(e=e||{}).random??e.rng?.()??function(){if(!n){if("undefined"===typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");n=crypto.getRandomValues.bind(crypto)}return n(i)}();if(s.length<16)throw new Error("Random bytes length must be >= 16");if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){if((r=r||0)<0||r+16>t.length)throw new RangeError(`UUID byte range ${r}:${r+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[r+e]=s[e];return t}return a(s)}},45882:(e,t,r)=>{"use strict";r.d(t,{k:()=>o});const o={strokeWidthThin:"1px",strokeWidthThick:"2px",strokeWidthThicker:"3px",strokeWidthThickest:"4px"}},46402:(e,t,r)=>{"use strict";r.d(t,{p:()=>n});const o=Symbol("`mockify` mock function key");function n(e){const t=function(){return t[o](...arguments)};return t[o]=e,t}n.key=o},46624:(e,t,r)=>{"use strict";r.d(t,{DR:()=>o});const o="9188040d-6c67-4c5b-b112-36a304b66dad";new Set(["72f988bf-86f1-41af-91ab-2d7cd011db47","0000","f34444e5-e35c-4ceb-8a8b-7a0042451ccc","0a54704d-bba9-4e27-878e-fe460a591835","de21c301-a4ae-4292-aa09-6db710a590a6","49b6f6cd-6628-4bd2-8753-4d8c8a68fa04","fabbafd6-0003-4695-ada4-929dea5a0d36","5b73a072-2f1f-46ad-92ca-a9b3993e45aa","d4093791-9818-48dc-8880-35d134b8c79d","0d746a1c-f9a6-47a3-9d3a-4f3f1a79c0f6","13c6a44d-9b52-4b9e-aa34-0513ee7131f2","1f855c63-5a0d-47be-8300-914123519d11","21a4f3dd-ef15-47a5-bc51-1a31b80765be","26ed3691-0678-440d-9bc4-134f94a1beb1","35e07416-9027-4637-ae4d-72159981338a","3cbebbae-5ae7-4090-9654-f2df09940424","40ed3d74-3c8c-4399-866e-d1f7a95bb051","45c54e3f-1b2a-4a84-a2f5-5d5e86845726","4ad43d82-3f33-47ee-b8a0-273939d4570a","55ccf089-0e94-4a28-85df-629d0b273be1","6f6da031-e5cf-4e62-82cd-96636e80639e","73561903-7c11-4927-809d-b9a31fda7d61","78375574-4a4c-41a5-8b31-72e0374aa242","9188040d-6c67-4c5b-b112-36a304b66dad","a0effc3b-4ee4-4a46-9dcc-89fd35b439f6","af33e969-0b64-4c2d-bad6-329f25f2d990","b00367e2-193a-4f48-94de-7245d45c0947","b48595ab-4114-4783-883d-41872f68adfb","b68a597d-37e2-4254-a203-5fd9602367ee","c00cdc1a-23ab-45df-8a48-1f8d96fa2fab","c51071fb-f559-4967-ac4f-63ee879ca4ec","e1a132a4-2f3d-4ef5-9b14-2d4e94833544","e58c8e81-abd8-48a8-929d-eb67611b83bd","e73ba7cf-4e1b-40f5-805e-c3aae41e1b90","fc3fd415-e428-4884-bf6f-62c2e70a6682","8f474e12-1b0c-463d-a004-edbc2e2c72b0","6583636b-d156-492e-86ce-b8fccb790df1","91b036b7-fff3-4c61-8d5e-dba6d56268bd","7a55eed5-98d0-4f09-bf4e-17768961e804"])},46851:(e,t,r)=>{"use strict";var o;r.d(t,{f:()=>o}),function(e){e.depth0="0 0 0 0 transparent",e.depth4="0 1.6px 3.6px 0 rgba(0, 0, 0, 0.132), 0 0.3px 0.9px 0 rgba(0, 0, 0, 0.108)",e.depth8="0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132), 0 0.6px 1.8px 0 rgba(0, 0, 0, 0.108)",e.depth16="0 6.4px 14.4px 0 rgba(0, 0, 0, 0.132), 0 1.2px 3.6px 0 rgba(0, 0, 0, 0.108)",e.depth64="0 25.6px 57.6px 0 rgba(0, 0, 0, 0.22), 0 4.8px 14.4px 0 rgba(0, 0, 0, 0.18)"}(o||(o={}))},47860:(e,t,r)=>{"use strict";r.d(t,{o:()=>n});var o=r(77432);const n=e=>(0,o.F)("graph",e)},48116:(e,t,r)=>{"use strict";r.d(t,{t:()=>o});const o="https://home.microsoftpersonalcontent.com"},48219:(e,t,r)=>{"use strict";var o;r.d(t,{U:()=>o}),function(e){e.summarizingClient="fluid-client-summarizer",e.createNew="createNew"}(o||(o={}))},48680:(e,t,r)=>{"use strict";r.d(t,{AU:()=>l});var o=r(75964),n=r(52841),i=r(3503);const s=new Map;function a(e,t){const r=function(e,t){const r=s.get(e);if(void 0!==r)return r;let o,a,d,l;l=void 0!==(o=function(e){const t=i.f.get(e);return c(t)}(e))?o:void 0!==(a=function(e){const t=(0,n.Ar)()?.getItem(e);return c(t)}(e))?a:void 0!==(d=function(e){const t=(0,n.RY)()?.getItem(e);return c(t)}(e))?d:t;return s.set(e,l),l}(e,t);return r}function c(e){if(null!==e&&void 0!==e){const t=(0,o.X)(e),r=void 0!==t?t:e;return"on"===r||"off"===r?"on"===r:r}}function d(e,t,r,o){return r?r.getSetting(e,t,o):a(e,t)}const l=(e,t,r)=>d(e,t,r,"FluidExperiences")},48717:(e,t,r)=>{"use strict";r.d(t,{Y:()=>n});var o=r(73895);function n(e){if((0,o.S)()&&"undefined"!==typeof document){var t=e;return t&&t.ownerDocument?t.ownerDocument:document}}},49750:(e,t,r)=>{"use strict";r.d(t,{o:()=>n});class o extends Error{constructor(e,t){super(e),this.name="ErrorWithCode",this.code=t}}class n extends o{constructor(e,t){super(e),this.name="ResponseError",this.code=t.status,this.statusText=t.statusText}}},50178:(e,t,r)=>{"use strict";r.d(t,{mc:()=>s,fV:()=>p,pW:()=>u,ZK:()=>d,Df:()=>f});var o=r(20310);const n=20,i=30;var s,a=r(17637),c=r(74621);function d(e){if(void 0===e||null===e)return;const t=Number(e);return Number.isNaN(t)?e:t}!function(e){e.CodeArtifact="CodeArtifact",e.UserData="UserData"}(s||(s={}));class l{static sanitizePkgName(e){return e.replace("@","").replace("/","-")}static prepareErrorObject(e,t,r){const{message:o,errorType:n,stack:i}=(0,c.AV)(t,!0);if(e.stack=i,e.error=o,e.errorType=n,(0,c.dy)(t)){const r=t.getTelemetryProperties();for(const t of Object.keys(r))void 0===e[t]&&(e[t]=r[t])}void 0===e.stack&&r&&(e.stack=(0,c.aX)())}constructor(e,t){this.namespace=e,this.properties=t}sendTelemetryEvent(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n;this.sendTelemetryEventCore({...e,category:e.category??"generic"},t,"error"===e.category?i:r)}sendTelemetryEventCore(e,t,r){const o=function(e){let{category:t,eventName:r,...o}=e;const n={category:t,eventName:r};for(const i of Object.keys(o))n[i]=p(o[i]);return n}(e);var n;void 0!==t&&l.prepareErrorObject(o,t,!1),"number"===typeof o.duration&&(o.duration=(n=o.duration,Math.floor(n))),this.send(o,r)}sendErrorEvent(e,t){this.sendTelemetryEventCore({error:e.eventName,...e,category:"error"},t,i)}sendPerformanceEvent(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n;const o={...e,category:e.category??"performance"};this.sendTelemetryEventCore(o,t,"error"===o.category?i:r)}prepareEvent(e){const t="error"===e.category||void 0!==e.error,r={...e};return void 0!==this.namespace&&(r.eventName=`${this.namespace}${l.eventNamespaceSeparator}${r.eventName}`),this.extendProperties(r,t)}extendProperties(e,t){const r=e;if(this.properties){const e=[];e.push(this.properties.all),t&&e.push(this.properties.error);for(const t of e)if(void 0!==t)for(const[e,o]of Object.entries(t)){if(void 0!==r[e])continue;const t="function"===typeof o?o():o;void 0!==t&&(r[e]=t)}}return e}}l.eventNamespaceSeparator=":";function u(e){return h.create(e?.logger,e?.namespace,e?.properties)}class h extends l{static create(e,t,r){if(e instanceof h){const o={};for(const t of[e.properties,r])void 0!==t&&(void 0!==t.all&&(o.all={...o.all,...t.all}),void 0!==t.error&&(o.error={...o.error,...t.error}));const n=void 0===e.namespace?t:void 0===t?e.namespace:`${e.namespace}${l.eventNamespaceSeparator}${t}`,i=new h(e.baseLogger,n,o);return!(0,a.uz)(i)&&(0,a.uz)(e)&&(0,a.fG)(i,e.config),i}return new h(e??{send(){}},t,r)}constructor(e,t,r){super(t,r),this.baseLogger=e,(0,a.uz)(e)&&(0,a.fG)(this,new a.G0(this,e.config))}get minLogLevel(){return this.baseLogger.minLogLevel}shouldFilterOutEvent(e,t){return(t??n)<(this.baseLogger.minLogLevel??n)}send(e,t){this.shouldFilterOutEvent(e,t)||this.baseLogger.send(this.prepareEvent(e),t)}}class g{static start(e,t,r){return new g(e,t,r,!(arguments.length>3&&void 0!==arguments[3])||arguments[3])}static timedExec(e,t,r,o){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;const i=g.start(e,t,o,g.shouldReport(t,n));try{const e=r(i);return i.autoEnd(),e}catch(s){throw i.cancel(void 0,s),s}}static async timedExecAsync(e,t,r,o){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;const i=g.start(e,t,o,g.shouldReport(t,n));try{const e=await r(i);return i.autoEnd(),e}catch(s){throw i.cancel(void 0,s),s}}get duration(){return(0,o.l)()-this.startTime}constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{end:!0,cancel:"generic"},n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.logger=e,this.markers=r,this.emitLogs=n,this.startTime=(0,o.l)(),this.event={...t},this.markers.start&&this.reportEvent("start"),"object"===typeof window&&void 0!==window?.performance?.mark&&null!==window?.performance?.mark&&(this.startMark=`${t.eventName}-start`,window.performance.mark(this.startMark))}reportProgress(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"update";this.reportEvent(t,e)}autoEnd(){this.event&&this.markers.end&&this.reportEvent("end"),this.performanceEndMark(),this.event=void 0}end(e){this.reportEvent("end",e),this.performanceEndMark(),this.event=void 0}performanceEndMark(){if(void 0!==this.startMark&&this.event){const e=`${this.event.eventName}-end`;window.performance.mark(e),window.performance.measure(`${this.event.eventName}`,this.startMark,e),this.startMark=void 0}}cancel(e,t){void 0!==this.markers.cancel&&this.reportEvent("cancel",{category:this.markers.cancel,...e},t),this.event=void 0}reportEvent(e,t,r){if(!this.event)return;if(!this.emitLogs)return;const o={...this.event,...t};o.eventName=`${o.eventName}_${e}`,"start"!==e&&(o.duration=this.duration),this.logger.sendPerformanceEvent(o,r)}static shouldReport(e,t){const r=`.${e.category}.${e.eventName}`,o=g.eventHits.get(r)??0;return g.eventHits.set(r,o>=t?1:o+1),o%t===0}}function p(e){return(0,c.qp)(e)?{value:m(e.value),tag:e.tag}:m(e)}function m(e){switch(typeof e){case"string":case"number":case"boolean":case"undefined":return e;case"object":return JSON.stringify(e);default:return console.error(`convertToBasePropertyTypeUntagged: INVALID PROPERTY (typed as ${typeof e})`),`INVALID PROPERTY (typed as ${typeof e})`}}g.eventHits=new Map;const f=e=>((e,t)=>Object.entries(t).filter(e=>void 0!==e[1]).reduce((t,r)=>{const[o,n]=r;return t[o]="function"===typeof n?()=>({tag:e,value:n()}):{tag:e,value:n},t},{}))(s.CodeArtifact,e)},50349:(e,t,r)=>{"use strict";r.d(t,{Mh:()=>y,jC:()=>f,Cu:()=>v});var o=r(68194);const n="https://my.microsoftpersonalcontent.com",i="https://1drv.ms",s="1",a="fluid",c="s",d="d",l="f",u="c",h="a",g="p",p="v",m="x";const f="nav";function v(e,t){const r=function(e){const t=new URL(e.siteUrl),r=encodeURIComponent(t.pathname),n=encodeURIComponent(e.driveId),i=encodeURIComponent(e.itemId),f=encodeURIComponent(e.dataStorePath);let v=`${c}=${r}&${d}=${n}&${l}=${i}&${u}=${f}&${a}=${s}`;return e.appName&&(v+=`&${h}=${encodeURIComponent(e.appName)}`),e.containerPackageName&&(v+=`&${g}=${encodeURIComponent(e.containerPackageName)}`),e.fileVersion&&(v+=`&${p}=${encodeURIComponent(e.fileVersion)}`),e.context&&(v+=`&${m}=${encodeURIComponent(e.context)}`),(0,o.O0)(v)}(t);e.searchParams.set(f,r)}function y(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const r=e.searchParams.get(f);if(!r)return;return function(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=new URLSearchParams((0,o.AH)(e)),i=n.get(a);if(r&&"1"!==i)return;const s=n.get(c),f=n.get(d),v=n.get(l),y=n.get(u),b=n.get(h)??void 0,S=n.get(g)??void 0,C=n.get(p)??void 0,k=n.get(m)??void 0;if(!s||!f||!v||null===y)return;let w;try{w=new URL(s,t)}catch{}return w?{siteUrl:w.href,driveId:f,itemId:v,dataStorePath:y,appName:b,containerPackageName:S,fileVersion:C,context:k}:void 0}(r,e.origin.toLowerCase()===i?n:e.origin,t)}},50406:(e,t,r)=>{"use strict";r.d(t,{GV:()=>b,di:()=>v,EY:()=>y});var o=r(56851),n=r(12283),i={};function s(e,t){"Office."===e.substring(0,7)&&"."!==e[e.length-1]?i[e]?(t.ariaTenantToken&&(i[e].ariaTenantToken=t.ariaTenantToken),t.dnmToken&&(i[e].dnmToken=t.dnmToken)):i[e]=t:(0,n.wC)(0,0,function(){return"Namespace: ".concat(e)})}function a(e,t){for(var r=e.length;r>0;){var o=e.substr(0,r);if(i[o]){var n=i[o];return t.ariaTenantToken=n.ariaTenantToken,t.dnmToken=n.dnmToken,!0}r=e.lastIndexOf(".",r-1)}return!1}var c=9007199254740991,d=-c,l=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,u=/^[a-zA-Z0-9_\.]{1,95}$/;function h(e){(function(e){if(!e||e.length>98)return!1;return l.test(e)})(e.eventName)||m("eventName",e.eventName,l,98);var t=e.eventContract;t&&(t.name&&!g(t.name)&&m("eventContract",t.name,u),p(t.dataFields)),p(e.dataFields)}function g(e){return u.test(e)}function p(e){e&&e.forEach(function(e){"string"===typeof e.name&&g(e.name)||m("dataField name",e.name,u),2===e.dataType&&function(e){if("number"!==typeof e||!isFinite(e)||Math.floor(e)!==e||e<d||e>c)throw new Error("Invalid integer ".concat(JSON.stringify(e)))}(e.value)})}function m(e,t,r,o){throw new Error("Invalid ".concat(e," '").concat(t,"' as it does not match regex ").concat(r)+(o?" or exceeds ".concat(o," chars"):""))}var f=r(90589),v=-1;function y(e){var t={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?(0,o.__assign)({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp||(new Date).getTime()};return e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t}var b=function(){function e(t,r,n){var i,s,a;this.telemetrySinks=[],this.persistentDataFields=[],this.partAFields=[],this.eventQueue=[],this.config=n||{},this.instanceId=++e.instanceCounter,t&&(this.telemetrySinks=t.telemetrySinks,(i=this.persistentDataFields).push.apply(i,t.persistentDataFields),this.config=(0,o.__assign)((0,o.__assign)({},t.getConfig()),this.config),(s=this.partAFields).push.apply(s,t.partAFields)),r&&(a=this.persistentDataFields).push.apply(a,r)}return e.prototype.addEventContentType=function(e,t){e.push((0,f.Ug)("EventContent.Type",t))},e.prototype.sendTelemetryEvent=function(e){var t=y(e),r=t.telemetryProperties;r.nexusTenantToken=v;var o=r.ariaTenantToken;if(!o&&(!a(t.eventName,r)&&!o))return void(0,n.wC)(0,0,function(){return"No tenant token: "+e.eventName});this.sendTelemetryEventInternal(t,1)},e.prototype.sendNonStandardEvent=function(e,t){var r=y(e);this.sendTelemetryEventInternal(r,t)},e.prototype.sendCustomerContent=function(e){var t=y(e),r=t.telemetryProperties,o=r.customerContentVersion;return(!o||o>2)&&(r.customerContentVersion=2),r.ariaTenantToken=void 0,r.nexusTenantToken=void 0,r.dnmToken=void 0,this.addEventContentType(t.dataFields,2),this.sendTelemetryEventInternal(t,2)},e.prototype.sendDirectNumericEvent=function(e){var t=y(e),r=t.telemetryProperties;if(!r.dnmToken&&(!a(t.eventName,r)&&!r.dnmToken))return void(0,n.wC)(0,0,function(){return"No dnm token: "+t.eventName});this.addEventContentType(t.dataFields,1),this.sendTelemetryEventInternal(t,3)},e.prototype.sendTelemetryEventInternal=function(e,t){if(2===t||!e.telemetryProperties.customerContentVersion&&!e.telemetryProperties.customerContentType){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push([e,t]):(0,n.wC)(1,0,function(){return"No telemetry sinks are attached."}));this.processTelemetryEvent(e,t)}catch(r){return void(0,n.vV)(0,"SendTelemetryEvent",r)}this.telemetrySinks.forEach(function(r){try{3===t||2===t?r.sendNonStandardEvent&&r.sendNonStandardEvent(e,t):r.sendTelemetryEvent(e)}catch(o){}})}else(0,n.wC)(0,0,function(){return"Customer content"})},e.prototype.processTelemetryEvent=function(e,t){var r,o,n;if(e.dataFields&&(null===(n=e.dataFields)||void 0===n||n.unshift((0,f.m9)("OTelJS.Version","4.23.1149")),3!==t&&this.persistentDataFields&&(r=e.dataFields).unshift.apply(r,this.persistentDataFields)),this.partAFields.length>0){var i=e.eventContract||{name:"",dataFields:[]};(o=i.dataFields).push.apply(o,this.partAFields),e.eventContract=i}this.config.disableValidation||h(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e),this.flushQueue()},e.prototype.flushQueue=function(){var e=this.eventQueue;if(this.eventQueue=[],this.telemetrySinks.length>0)for(var t=0,r=e;t<r.length;t++){var o=r[t],n=o[0],i=o[1];this.sendTelemetryEventInternal(n,i)}},e.prototype.setTenantToken=function(e,t,r){s(e,{ariaTenantToken:t,nexusTenantToken:r})},e.prototype.setDNMToken=function(e,t){s(e,{dnmToken:t})},e.prototype.cloneEvent=function(e){return y(e)},e.prototype.getConfig=function(){return this.config},e.instanceCounter=0,e}()},51492:(e,t,r)=>{"use strict";r.d(t,{LM:()=>d,MO:()=>f,PA:()=>n.PA,WM:()=>u,Xe:()=>v,dK:()=>S,eH:()=>n.eH,g_:()=>y,lb:()=>m,n_:()=>n.n_,qF:()=>b,tT:()=>g,u:()=>h,x$:()=>n.x$,xB:()=>p,y:()=>c});var o=r(69235),n=r(91947),i=r(6971);let s,a,c,d,l,u,h=function(e){return e.OEP="OEP",e.Word="Word",e}({});async function g(){return s||(s=(0,n.x$)(h.OEP,"FluidHost.IsCardLoopCdnCodeLoaderEnabled")),s}async function p(){return a||(a=(0,n.PA)(h.OEP,"FluidHost.DelayWaitForDriveAndPath")),a}async function m(){return c||(c=(0,n.PA)(h.OEP,"ChangeGate.FluidHost.isAppThemeBrandingEnabled")),c}async function f(){return d||(d=(0,n.PA)(h.OEP,"ChangeGate.FluidHost.isSetReadOnlyEnabled")),d}async function v(){return l||(l=(0,n.PA)(h.Word,"FluidOutlook.InvokeBot")),l}async function y(){return u||(u=(0,n.PA)(h.OEP,"ChangeGate.FluidHost.isDisableV8ThemingEnabled")),u}async function b(){var e;const t=await(0,i.E)();return null!==(e=null===t||void 0===t?void 0:t.useGenericLoader)&&void 0!==e&&e}function S(e,t){if(!t||t.startsWith(".")||t.endsWith(".")||t.startsWith("Microsoft.Office."))throw new o.uV("The feature name is not valid.");return`Microsoft.Office.${e}.${t}`}},51497:(e,t,r)=>{"use strict";r.d(t,{Ul:()=>s,cc:()=>i,yd:()=>n});var o=r(43483);const n={red:o.wv,green:o.wL,darkOrange:o.je,yellow:o.D9,berry:o.pT,lightGreen:o.EM,marigold:o.KK},i={darkRed:o.ik,cranberry:o.jF,pumpkin:o.Vv,peach:o.WB,gold:o.bK,brass:o.YA,brown:o.Xk,forest:o.CE,seafoam:o.$T,darkGreen:o.AV,lightTeal:o.JW,teal:o.$S,steel:o.s$,blue:o.z1,royalBlue:o.Os,cornflower:o.um,navy:o.Z,lavender:o.Us,purple:o.Zp,grape:o.QH,lilac:o.qn,pink:o.Vu,magenta:o.GC,plum:o.t1,beige:o.Zz,mink:o.QJ,platinum:o.X1,anchor:o.Y3},s={cranberry:o.jF,green:o.wL,orange:o.T_}},51655:(e,t,r)=>{"use strict";r.d(t,{q:()=>i});var o=r(69235),n=r(26140);class i{constructor(){this.startTime=void 0,this.stopTime=void 0,this.isSuccess=!1,this.error=void 0}measure(e){try{this.start();const t=e();return this.setSuccess(),t}catch(t){throw this.setFailure(t),t}}start(e){if(this.startTime)throw new o.uV("PerfTracker.start() called when already started.");this.startTime=e||i.getTimePoint()}stop(){const e=i.getTimePoint();if(!this.stopTime){if(!this.startTime)throw new o.uV("PerTracker.stop() called when not started.");this.stopTime=e}}static getTimePoint(){return 1e3*(0,n.F)()}getDuration(){if(this.startTime){const e=(this.stopTime||i.getTimePoint())-this.startTime;return Math.floor(e)}return 0}getDurationInSeconds(){return this.getDuration()/1e6}setSuccess(){this.stop(),this.isSuccess=!0}setFailure(e){this.stop(),this.isSuccess=!1,this.error=e}static startNew(e){const t=new i;return t.start(e),t}}},52059:(e,t,r)=>{"use strict";r.d(t,{$A:()=>i,CS:()=>a,JL:()=>o,ZV:()=>n,gE:()=>s});const o="@ms/planner-loop",n="Planner",i=300,s={policyId:"L_Loop_Planner",valueName:"LoopPlanner",registryDataType:"REG_DWORD",regKeyFullPath:"software\\policies\\microsoft\\office\\16.0\\common\\loop"},a="Production"},52389:(e,t,r)=>{"use strict";r.d(t,{EI:()=>k,qt:()=>f,su:()=>m,jw:()=>v,ym:()=>y,eK:()=>b});var o=r(26631),n=r(2875),i=r(77565),s=r(15217),a=r(27750),c=r(97423);class d{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"utf-8";this.path=e,this.mode=c.S.File,this.type=c.$.Blob,this.value={contents:t,encoding:r}}}class l{constructor(e,t){this.path=e,this.value=t,this.mode=c.S.Directory,this.type=c.$.Tree}}class u{constructor(e,t){this.path=e,this.id=t,this.mode=c.S.File,this.type=c.$.Attachment,this.value={id:t}}}var h=r(7428);function g(){const e={treeNodeCount:0,blobNodeCount:0,handleNodeCount:0,totalBlobSize:0,unreferencedBlobSize:0};for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];for(const n of r)e.treeNodeCount+=n.treeNodeCount,e.blobNodeCount+=n.blobNodeCount,e.handleNodeCount+=n.handleNodeCount,e.totalBlobSize+=n.totalBlobSize,e.unreferencedBlobSize+=n.unreferencedBlobSize;return e}function p(e){return"string"===typeof e?function(e){let t=e.length;for(let r=e.length-1;r>=0;r--){const o=e.charCodeAt(r);o>127&&o<=2047?t++:o>2047&&o<=65535&&(t+=2),o>=56320&&o<=57343&&r--}return t}(e):e.byteLength}function m(e,t,r){const o={type:a.Z.Blob,content:r};e.summary.tree[t]=o,e.stats.blobNodeCount++,e.stats.totalBlobSize+=p(r)}class f{get summary(){const e={type:a.Z.Tree,tree:{...this.summaryTree}};return void 0!==this.groupId&&(e.groupId=this.groupId),e}get stats(){return{...this.summaryStats}}constructor(e){this.attachmentCounter=0,this.summaryTree={},this.summaryStats=g(),this.summaryStats.treeNodeCount++,this.groupId=e?.groupId}addBlob(e,t){m({summary:{type:a.Z.Tree,tree:this.summaryTree},stats:this.summaryStats},e,t)}addHandle(e,t,r){this.summaryTree[e]={type:a.Z.Handle,handleType:t,handle:r},this.summaryStats.handleNodeCount++}addWithStats(e,t){this.summaryTree[e]=t.summary,this.summaryStats=g(this.summaryStats,t.stats)}addAttachment(e){this.summaryTree[this.attachmentCounter++]={id:e,type:a.Z.Attachment}}getSummaryTree(){return{summary:this.summary,stats:this.stats}}}function v(e){const t=new f;for(const[i,s]of Object.entries(e.blobs)){let r;if(void 0!==e.blobsContents){const t=e.blobsContents[s];void 0!==t&&(r=(0,o.JR)(t,"utf-8"))}else void 0!==e.blobs[s]&&(r=(0,n.AH)(e.blobs[s]));void 0!==r&&t.addBlob(i,r)}for(const[o,n]of Object.entries(e.trees)){const e=v(n);t.addWithStats(o,e)}const r=t.getSummaryTree();return r.summary.unreferenced=e.unreferenced,r.summary.groupId=e.groupId,r}function y(e){const t=[];for(const[r,n]of Object.entries(e.tree))switch(n.type){case a.Z.Blob:{let e,i="utf-8";"string"===typeof n.content?e=n.content:(e=(0,o.Km)(n.content,"base64"),i="base64"),t.push(new d(r,e,i));break}case a.Z.Tree:t.push(new l(r,y(n)));break;case a.Z.Attachment:t.push(new u(r,n.id));break;case a.Z.Handle:throw new Error("Should not have Handle type in summary tree");default:(0,i.$)(n,"Unexpected summary tree type")}return{entries:t,unreferenced:e.unreferenced,groupId:e.groupId}}function b(e,t){const r=e?.entries.find(e=>e.path===h.xX);if(void 0===r)return!1;(0,s.vA)(r.type===c.$.Blob&&"utf-8"===r.value.encoding,2303);const o=JSON.parse(r.value.contents);for(const[n,i]of Object.entries(o.gcNodes))i.forEach(e=>{t(n,e)});return!0}function S(e){return e.replace(/^\/+/g,"")}function C(e){return e.replace(/\/+$/g,"")}class k{constructor(){this.gcNodesSet={}}get gcNodes(){const e={};for(const[t,r]of Object.entries(this.gcNodesSet))e[t]=[...r];return e}addNode(e,t){this.gcNodesSet[e]=new Set(t)}prefixAndAddNodes(e,t){for(const[r,o]of Object.entries(t)){let t=S(r);t=`/${e}/${t}`,t=C(t),this.gcNodesSet[t]=new Set(o)}}addNodes(e){for(const[t,r]of Object.entries(e))this.gcNodesSet[t]=new Set(r)}addRouteToAllNodes(e){for(const t of Object.values(this.gcNodesSet))t.add(e)}getGCData(){return{gcNodes:this.gcNodes}}}},52563:(e,t,r)=>{"use strict";r.d(t,{Zd:()=>a,q:()=>i,rv:()=>c});const o={afZa:"af-za",amEt:"am-et",arSa:"ar-sa",asIn:"as-in",azLatnAz:"az-latn-az",bgBg:"bg-bg",bnIn:"bn-in",bsLatnBa:"bs-latn-ba",caEs:"ca-es",caEsValencia:"ca-es-valencia",csCz:"cs-cz",cyGb:"cy-gb",daDk:"da-dk",deDe:"de-de",elGr:"el-gr",enGb:"en-gb",enUs:"en-us",esEs:"es-es",esMx:"es-mx",etEe:"et-ee",euEs:"eu-es",faIr:"fa-ir",fiFi:"fi-fi",filPh:"fil-ph",frCa:"fr-ca",frFr:"fr-fr",gaIe:"ga-ie",gdGb:"gd-gb",glEs:"gl-es",guIn:"gu-in",heIl:"he-il",hiIn:"hi-in",hrHr:"hr-hr",huHu:"hu-hu",hyAm:"hy-am",idId:"id-id",isIs:"is-is",itIt:"it-it",jaJp:"ja-jp",kaGe:"ka-ge",kkKz:"kk-kz",kmKh:"km-kh",knIn:"kn-in",kokIn:"kok-in",koKr:"ko-kr",lbLu:"lb-lu",loLa:"lo-la",ltLt:"lt-lt",lvLv:"lv-lv",miNz:"mi-nz",mkMk:"mk-mk",mlIn:"ml-in",mrIn:"mr-in",msMy:"ms-my",mtMt:"mt-mt",nbNo:"nb-no",neNp:"ne-np",nlNl:"nl-nl",nnNo:"nn-no",orIn:"or-in",paIn:"pa-in",plPl:"pl-pl",ptBr:"pt-br",ptPt:"pt-pt",quzPe:"quz-pe",roRo:"ro-ro",ruRu:"ru-ru",skSk:"sk-sk",slSi:"sl-si",sqAl:"sq-al",srCyrlBa:"sr-cyrl-ba",srCyrlRs:"sr-cyrl-rs",srLatnRs:"sr-latn-rs",svSe:"sv-se",taIn:"ta-in",teIn:"te-in",thTh:"th-th",trTr:"tr-tr",ttRu:"tt-ru",ugCn:"ug-cn",ukUa:"uk-ua",urPk:"ur-pk",viVn:"vi-vn",zhCn:"zh-cn",zhTw:"zh-tw"},n={af:o.afZa,am:o.amEt,ar:o.arSa,as:o.asIn,az:o.azLatnAz,bg:o.bgBg,bn:o.enGb,bs:o.bsLatnBa,"bs-cyrl-ba":o.enGb,ca:o.caEs,cs:o.csCz,cy:o.cyGb,da:o.daDk,de:o.deDe,el:o.elGr,"el-cy":o.enGb,en:o.enUs,es:o.esEs,et:o.etEe,eu:o.euEs,fa:o.faIr,fi:o.fiFi,fil:o.filPh,fr:o.frFr,ga:o.gaIe,gd:o.gdGb,gl:o.glEs,gu:o.guIn,he:o.heIl,hi:o.hiIn,hr:o.hrHr,hu:o.huHu,hy:o.hyAm,id:o.idId,is:o.isIs,it:o.itIt,iw:o.heIl,"iw-il":o.heIl,ja:o.jaJp,ka:o.kaGe,kk:o.kkKz,km:o.kmKh,kn:o.knIn,ko:o.koKr,kok:o.kokIn,lb:o.lbLu,lo:o.loLa,lt:o.ltLt,lv:o.lvLv,mi:o.miNz,mk:o.mkMk,ml:o.mlIn,mr:o.mrIn,ms:o.msMy,mt:o.mtMt,nb:o.nbNo,ne:o.neNp,nl:o.nlNl,nn:o.nnNo,or:o.orIn,pa:o.paIn,pl:o.plPl,pt:o.ptBr,quz:o.quzPe,ro:o.roRo,ru:o.ruRu,sk:o.skSk,sl:o.slSi,sq:o.sqAl,sv:o.svSe,ta:o.taIn,te:o.teIn,th:o.thTh,tr:o.trTr,"tr-cy":o.enGb,tt:o.ttRu,ug:o.ugCn,uk:o.ukUa,ur:o.urPk,uz:o.enUs,vi:o.viVn,zh:o.enUs,"zh-hans-tw":o.zhTw},i=o.enUs,s=/^([^-]+)-.+/;function a(e){if(void 0===e||null===e)return!1;const t=e.toLowerCase();return Object.values(o).includes(t)||void 0!==n[t]}function c(e){if(void 0===e||null===e)return i;const t=e.toLowerCase();if(Object.values(o).includes(t))return t;const r=n[t];if(void 0!==r)return r;const a=function(e){const t=s.exec(e.trim().toLowerCase());if(null!==t&&t.length>1)return t[1];return}(t);if(void 0!==a){const e=n[a];if(void 0!==e)return e}return i}},52841:(e,t,r)=>{"use strict";let o,n;r.d(t,{Ar:()=>i,RY:()=>s});try{localStorage.getItem("__storage_test__"),o=localStorage}catch{o=void 0}try{sessionStorage.getItem("__storage_test__"),n=sessionStorage}catch{n=void 0}function i(){return o}function s(){return n}},53316:e=>{"use strict";function t(e){if("string"!==typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function r(e,t){for(var r,o="",n=0,i=-1,s=0,a=0;a<=e.length;++a){if(a<e.length)r=e.charCodeAt(a);else{if(47===r)break;r=47}if(47===r){if(i===a-1||1===s);else if(i!==a-1&&2===s){if(o.length<2||2!==n||46!==o.charCodeAt(o.length-1)||46!==o.charCodeAt(o.length-2))if(o.length>2){var c=o.lastIndexOf("/");if(c!==o.length-1){-1===c?(o="",n=0):n=(o=o.slice(0,c)).length-1-o.lastIndexOf("/"),i=a,s=0;continue}}else if(2===o.length||1===o.length){o="",n=0,i=a,s=0;continue}t&&(o.length>0?o+="/..":o="..",n=2)}else o.length>0?o+="/"+e.slice(i+1,a):o=e.slice(i+1,a),n=a-i-1;i=a,s=0}else 46===r&&-1!==s?++s:s=-1}return o}var o={resolve:function(){for(var e,o="",n=!1,i=arguments.length-1;i>=-1&&!n;i--){var s;i>=0?s=arguments[i]:(void 0===e&&(e=process.cwd()),s=e),t(s),0!==s.length&&(o=s+"/"+o,n=47===s.charCodeAt(0))}return o=r(o,!n),n?o.length>0?"/"+o:"/":o.length>0?o:"."},normalize:function(e){if(t(e),0===e.length)return".";var o=47===e.charCodeAt(0),n=47===e.charCodeAt(e.length-1);return 0!==(e=r(e,!o)).length||o||(e="."),e.length>0&&n&&(e+="/"),o?"/"+e:e},isAbsolute:function(e){return t(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,r=0;r<arguments.length;++r){var n=arguments[r];t(n),n.length>0&&(void 0===e?e=n:e+="/"+n)}return void 0===e?".":o.normalize(e)},relative:function(e,r){if(t(e),t(r),e===r)return"";if((e=o.resolve(e))===(r=o.resolve(r)))return"";for(var n=1;n<e.length&&47===e.charCodeAt(n);++n);for(var i=e.length,s=i-n,a=1;a<r.length&&47===r.charCodeAt(a);++a);for(var c=r.length-a,d=s<c?s:c,l=-1,u=0;u<=d;++u){if(u===d){if(c>d){if(47===r.charCodeAt(a+u))return r.slice(a+u+1);if(0===u)return r.slice(a+u)}else s>d&&(47===e.charCodeAt(n+u)?l=u:0===u&&(l=0));break}var h=e.charCodeAt(n+u);if(h!==r.charCodeAt(a+u))break;47===h&&(l=u)}var g="";for(u=n+l+1;u<=i;++u)u!==i&&47!==e.charCodeAt(u)||(0===g.length?g+="..":g+="/..");return g.length>0?g+r.slice(a+l):(a+=l,47===r.charCodeAt(a)&&++a,r.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(t(e),0===e.length)return".";for(var r=e.charCodeAt(0),o=47===r,n=-1,i=!0,s=e.length-1;s>=1;--s)if(47===(r=e.charCodeAt(s))){if(!i){n=s;break}}else i=!1;return-1===n?o?"/":".":o&&1===n?"//":e.slice(0,n)},basename:function(e,r){if(void 0!==r&&"string"!==typeof r)throw new TypeError('"ext" argument must be a string');t(e);var o,n=0,i=-1,s=!0;if(void 0!==r&&r.length>0&&r.length<=e.length){if(r.length===e.length&&r===e)return"";var a=r.length-1,c=-1;for(o=e.length-1;o>=0;--o){var d=e.charCodeAt(o);if(47===d){if(!s){n=o+1;break}}else-1===c&&(s=!1,c=o+1),a>=0&&(d===r.charCodeAt(a)?-1===--a&&(i=o):(a=-1,i=c))}return n===i?i=c:-1===i&&(i=e.length),e.slice(n,i)}for(o=e.length-1;o>=0;--o)if(47===e.charCodeAt(o)){if(!s){n=o+1;break}}else-1===i&&(s=!1,i=o+1);return-1===i?"":e.slice(n,i)},extname:function(e){t(e);for(var r=-1,o=0,n=-1,i=!0,s=0,a=e.length-1;a>=0;--a){var c=e.charCodeAt(a);if(47!==c)-1===n&&(i=!1,n=a+1),46===c?-1===r?r=a:1!==s&&(s=1):-1!==r&&(s=-1);else if(!i){o=a+1;break}}return-1===r||-1===n||0===s||1===s&&r===n-1&&r===o+1?"":e.slice(r,n)},format:function(e){if(null===e||"object"!==typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function(e,t){var r=t.dir||t.root,o=t.base||(t.name||"")+(t.ext||"");return r?r===t.root?r+o:r+e+o:o}("/",e)},parse:function(e){t(e);var r={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return r;var o,n=e.charCodeAt(0),i=47===n;i?(r.root="/",o=1):o=0;for(var s=-1,a=0,c=-1,d=!0,l=e.length-1,u=0;l>=o;--l)if(47!==(n=e.charCodeAt(l)))-1===c&&(d=!1,c=l+1),46===n?-1===s?s=l:1!==u&&(u=1):-1!==s&&(u=-1);else if(!d){a=l+1;break}return-1===s||-1===c||0===u||1===u&&s===c-1&&s===a+1?-1!==c&&(r.base=r.name=0===a&&i?e.slice(1,c):e.slice(a,c)):(0===a&&i?(r.name=e.slice(1,s),r.base=e.slice(1,c)):(r.name=e.slice(a,s),r.base=e.slice(a,c)),r.ext=e.slice(s,c)),a>0?r.dir=e.slice(0,a-1):i&&(r.dir="/"),r},sep:"/",delimiter:":",win32:null,posix:null};o.posix=o,e.exports=o},53450:(e,t,r)=>{"use strict";r.d(t,{r:()=>a});var o=r(90589),n=r(37450),i=r(58443),s=r(82645);class a{constructor(e,t){this.activity=void 0,this.activity=s.u.createActivity({eventName:"Office.Extensibility.Fluid.HostWebApp."+e,eventFlags:{dataCategories:n.o.DataCategories.ProductServiceUsage,diagnosticLevel:n.o.DiagnosticLevel.FullEvent}}),this.addStringDataField("HydrateId",t)}async endActivity(e,t,r){this.activity&&(await this.addDataFieldsToActivity(t,r),this.activity.success=e,this.activity.setResult(t),i.KV&&this.activity.endNow())}addInt64DataField(e,t){var r;const n=(0,o.Ug)(e,Math.floor(t));this.activity&&(null!==(r=this.activity)&&void 0!==r&&r.dataFields?this.activity.dataFields.push(n):this.activity.dataFields=[n])}addStringDataField(e,t){const r=(0,o.m9)(e,t);this.activity&&(this.activity.dataFields?this.activity.dataFields.push(r):this.activity.dataFields=[r])}addBooleanDataField(e,t){const r=(0,o.LK)(e,t);this.activity&&(this.activity.dataFields?this.activity.dataFields.push(r):this.activity.dataFields=[r])}}},53783:(e,t,r)=>{"use strict";r.d(t,{Ej:()=>i,ZY:()=>o,qb:()=>n,vU:()=>s});var o=function(e){return e.IframeLoadFailed="IframeLoadFailed",e.ContainerUpgradeRequired="ContainerUpgradeRequired",e.ComponentNotFound="ComponentNotFound",e}({}),n=function(e){return e.RootComponentCreateFailed="RootComponentCreateFailed",e.RaasNotSupported="RaasNotSupported",e}({});class i extends Error{constructor(e,t,r,o){if(super(e),this.internalError=r,this.name=t,o)try{this.stack=o}catch{}}}class s extends i{constructor(e,t,r,o){super(e,"ComponentNotFound",t,o),this.code=r}}},53815:(e,t,r)=>{"use strict";var o,n,i,s,a;r.d(t,{BO:()=>s,Dn:()=>o,bi:()=>n,fF:()=>a,s:()=>i}),function(e){e.Arabic="Segoe UI Web (Arabic)",e.Cyrillic="Segoe UI Web (Cyrillic)",e.EastEuropean="Segoe UI Web (East European)",e.Greek="Segoe UI Web (Greek)",e.Hebrew="Segoe UI Web (Hebrew)",e.Thai="Leelawadee UI Web",e.Vietnamese="Segoe UI Web (Vietnamese)",e.WestEuropean="Segoe UI Web (West European)",e.Selawik="Selawik Web",e.Armenian="Segoe UI Web (Armenian)",e.Georgian="Segoe UI Web (Georgian)"}(o||(o={})),function(e){e.Arabic="'".concat(o.Arabic,"'"),e.ChineseSimplified="'Microsoft Yahei UI', Verdana, Simsun",e.ChineseTraditional="'Microsoft Jhenghei UI', Pmingliu",e.Cyrillic="'".concat(o.Cyrillic,"'"),e.EastEuropean="'".concat(o.EastEuropean,"'"),e.Greek="'".concat(o.Greek,"'"),e.Hebrew="'".concat(o.Hebrew,"'"),e.Hindi="'Nirmala UI'",e.Japanese="'Yu Gothic UI', 'Meiryo UI', Meiryo, 'MS Pgothic', Osaka",e.Korean="'Malgun Gothic', Gulim",e.Selawik="'".concat(o.Selawik,"'"),e.Thai="'Leelawadee UI Web', 'Kmer UI'",e.Vietnamese="'".concat(o.Vietnamese,"'"),e.WestEuropean="'".concat(o.WestEuropean,"'"),e.Armenian="'".concat(o.Armenian,"'"),e.Georgian="'".concat(o.Georgian,"'")}(n||(n={})),function(e){e.size10="10px",e.size12="12px",e.size14="14px",e.size16="16px",e.size18="18px",e.size20="20px",e.size24="24px",e.size28="28px",e.size32="32px",e.size42="42px",e.size68="68px",e.mini="10px",e.xSmall="10px",e.small="12px",e.smallPlus="12px",e.medium="14px",e.mediumPlus="16px",e.icon="16px",e.large="18px",e.xLarge="20px",e.xLargePlus="24px",e.xxLarge="28px",e.xxLargePlus="32px",e.superLarge="42px",e.mega="68px"}(i||(i={})),function(e){e.light=100,e.semilight=300,e.regular=400,e.semibold=600,e.bold=700}(s||(s={})),function(e){e.xSmall="10px",e.small="12px",e.medium="16px",e.large="20px"}(a||(a={}))},54813:(e,t,r)=>{"use strict";r.d(t,{E9:()=>y,Gi:()=>m,OI:()=>g,Tj:()=>h,WA:()=>o,YU:()=>v,c_:()=>u,d8:()=>c,dw:()=>p,gb:()=>d,ix:()=>f,sc:()=>s,yi:()=>l});var o,n=r(87804),i=r(39521);function s(){return"object"===typeof navigator&&null!==navigator&&"boolean"===typeof navigator.onLine?navigator.onLine?o.Online:o.Offline:o.Unknown}!function(e){e[e.Offline=0]="Offline",e[e.Online=1]="Online",e[e.Unknown=2]="Unknown"}(o||(o={}));class a extends i.iq{constructor(e,t,r){super(e,r),this.canRetry=t,this.errorType=n.a.genericNetworkError}}class c extends i.iq{constructor(e,t){super(e,t),this.errorType=n.a.fluidInvalidSchema,this.canRetry=!1}}class d extends i.iq{constructor(e,t,r){super(e,{...t,statusCode:400}),this.errorType=d.errorType,this.canRetry=!1,this.storageOnlyReason=r}}d.errorType=n.a.deltaStreamConnectionForbidden;class l extends i.iq{constructor(e,t,r,o){void 0!==t&&(o.claims=t),void 0!==r&&(o.tenantId=r),super(e,o,new Set(["claims","tenantId"])),this.errorType=n.a.authorizationError,this.canRetry=!1}}class u extends i.iq{constructor(e,t,r){super(e,r,new Set(["redirectUrl"])),this.redirectUrl=t,this.errorType=n.a.locationRedirection,this.canRetry=!1}}class h extends i.iq{constructor(e,t,r,o){super(e,o),this.errorType=t,this.canRetry=r}}class g extends h{constructor(e,t,r){super(e,t,!1,r),this.errorType=t}}class p extends h{constructor(e,t,r){super(e,t,!0,r),this.errorType=t}}class m extends i.iq{constructor(e,t,r){super(e,r),this.retryAfterSeconds=t,this.errorType=n.a.throttlingError,this.canRetry=!0}}function f(e,t,r){return void 0!==t.retryAfterMs&&t.canRetry?new m(e,t.retryAfterMs/1e3,r):new a(e,t.canRetry,r)}const v=e=>!0===e?.canRetry,y=e=>void 0!==e?.retryAfterSeconds?1e3*e.retryAfterSeconds:void 0},55651:(e,t,r)=>{"use strict";r.d(t,{Q:()=>i,R:()=>s});var o=r(16026),n=r(11502);const i=(e,t,r)=>{const i=(0,o.KC)(e,t,r);return{type:n.e[n.e.Plain],value:i}},s=(e,t,r)=>{if(e.type===n.e[n.e.Shared]){e.type=n.e[n.e.Plain];const i={type:"__fluid_handle__",url:e.value};e.value=t.encode((0,o.Zb)(i,t),r)}}},56142:(e,t,r)=>{"use strict";r.d(t,{Rm:()=>a,sF:()=>i,vV:()=>s});var o=r(58443);let n;function i(e){n=o.yz||e}function s(e){!0===n&&console.error(e)}async function a(e){!0===n&&console.log(e)}},56851:(e,t,r)=>{"use strict";r.r(t),r.d(t,{__addDisposableResource:()=>O,__assign:()=>i,__asyncDelegator:()=>T,__asyncGenerator:()=>P,__asyncValues:()=>E,__await:()=>w,__awaiter:()=>p,__classPrivateFieldGet:()=>L,__classPrivateFieldIn:()=>A,__classPrivateFieldSet:()=>x,__createBinding:()=>f,__decorate:()=>a,__disposeResources:()=>_,__esDecorate:()=>d,__exportStar:()=>v,__extends:()=>n,__generator:()=>m,__importDefault:()=>B,__importStar:()=>F,__makeTemplateObject:()=>N,__metadata:()=>g,__param:()=>c,__propKey:()=>u,__read:()=>b,__rest:()=>s,__rewriteRelativeImportExtension:()=>R,__runInitializers:()=>l,__setFunctionName:()=>h,__spread:()=>S,__spreadArray:()=>k,__spreadArrays:()=>C,__values:()=>y,default:()=>H});var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},o(e,t)};function n(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return i=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},i.apply(this,arguments)};function s(e,t){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var n=0;for(o=Object.getOwnPropertySymbols(e);n<o.length;n++)t.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(r[o[n]]=e[o[n]])}return r}function a(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function c(e,t){return function(r,o){t(r,o,e)}}function d(e,t,r,o,n,i){function s(e){if(void 0!==e&&"function"!==typeof e)throw new TypeError("Function expected");return e}for(var a,c=o.kind,d="getter"===c?"get":"setter"===c?"set":"value",l=!t&&e?o.static?e:e.prototype:null,u=t||(l?Object.getOwnPropertyDescriptor(l,o.name):{}),h=!1,g=r.length-1;g>=0;g--){var p={};for(var m in o)p[m]="access"===m?{}:o[m];for(var m in o.access)p.access[m]=o.access[m];p.addInitializer=function(e){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(s(e||null))};var f=(0,r[g])("accessor"===c?{get:u.get,set:u.set}:u[d],p);if("accessor"===c){if(void 0===f)continue;if(null===f||"object"!==typeof f)throw new TypeError("Object expected");(a=s(f.get))&&(u.get=a),(a=s(f.set))&&(u.set=a),(a=s(f.init))&&n.unshift(a)}else(a=s(f))&&("field"===c?n.unshift(a):u[d]=a)}l&&Object.defineProperty(l,o.name,u),h=!0}function l(e,t,r){for(var o=arguments.length>2,n=0;n<t.length;n++)r=o?t[n].call(e,r):t[n].call(e);return o?r:void 0}function u(e){return"symbol"===typeof e?e:"".concat(e)}function h(e,t,r){return"symbol"===typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function g(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)}function p(e,t,r,o){return new(r||(r=Promise))(function(n,i){function s(e){try{c(o.next(e))}catch(t){i(t)}}function a(e){try{c(o.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})}function m(e,t){var r,o,n,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},s=Object.create(("function"===typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"===typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(c){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(i=0)),i;)try{if(r=1,o&&(n=2&a[0]?o.return:a[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,a[1])).done)return n;switch(o=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(n=(n=i.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){i.label=a[1];break}if(6===a[0]&&i.label<n[1]){i.label=n[1],n=a;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(a);break}n[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(c){a=[6,c],o=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}var f=Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]};function v(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||f(t,e,r)}function y(e){var t="function"===typeof Symbol&&Symbol.iterator,r=t&&e[t],o=0;if(r)return r.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function b(e,t){var r="function"===typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){n={error:a}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return s}function S(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(b(arguments[t]));return e}function C(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var o=Array(e),n=0;for(t=0;t<r;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,n++)o[n]=i[s];return o}function k(e,t,r){if(r||2===arguments.length)for(var o,n=0,i=t.length;n<i;n++)!o&&n in t||(o||(o=Array.prototype.slice.call(t,0,n)),o[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))}function w(e){return this instanceof w?(this.v=e,this):new w(e)}function P(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,n=r.apply(e,t||[]),i=[];return o=Object.create(("function"===typeof AsyncIterator?AsyncIterator:Object).prototype),s("next"),s("throw"),s("return",function(e){return function(t){return Promise.resolve(t).then(e,d)}}),o[Symbol.asyncIterator]=function(){return this},o;function s(e,t){n[e]&&(o[e]=function(t){return new Promise(function(r,o){i.push([e,t,r,o])>1||a(e,t)})},t&&(o[e]=t(o[e])))}function a(e,t){try{(r=n[e](t)).value instanceof w?Promise.resolve(r.value.v).then(c,d):l(i[0][2],r)}catch(o){l(i[0][3],o)}var r}function c(e){a("next",e)}function d(e){a("throw",e)}function l(e,t){e(t),i.shift(),i.length&&a(i[0][0],i[0][1])}}function T(e){var t,r;return t={},o("next"),o("throw",function(e){throw e}),o("return"),t[Symbol.iterator]=function(){return this},t;function o(o,n){t[o]=e[o]?function(t){return(r=!r)?{value:w(e[o](t)),done:!1}:n?n(t):t}:n}}function E(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=y(e),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(r){t[r]=e[r]&&function(t){return new Promise(function(o,n){(function(e,t,r,o){Promise.resolve(o).then(function(t){e({value:t,done:r})},t)})(o,n,(t=e[r](t)).done,t.value)})}}}function N(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var I=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},D=function(e){return D=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},D(e)};function F(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=D(e),o=0;o<r.length;o++)"default"!==r[o]&&f(t,e,r[o]);return I(t,e),t}function B(e){return e&&e.__esModule?e:{default:e}}function L(e,t,r,o){if("a"===r&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?o:"a"===r?o.call(e):o?o.value:t.get(e)}function x(e,t,r,o,n){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?n.call(e,r):n?n.value=r:t.set(e,r),r}function A(e,t){if(null===t||"object"!==typeof t&&"function"!==typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"===typeof e?t===e:e.has(t)}function O(e,t,r){if(null!==t&&void 0!==t){if("object"!==typeof t&&"function"!==typeof t)throw new TypeError("Object expected.");var o,n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");o=t[Symbol.asyncDispose]}if(void 0===o){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");o=t[Symbol.dispose],r&&(n=o)}if("function"!==typeof o)throw new TypeError("Object not disposable.");n&&(o=function(){try{n.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:o,async:r})}else r&&e.stack.push({async:!0});return t}var M="function"===typeof SuppressedError?SuppressedError:function(e,t,r){var o=new Error(r);return o.name="SuppressedError",o.error=e,o.suppressed=t,o};function _(e){function t(t){e.error=e.hasError?new M(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}var r,o=0;return function n(){for(;r=e.stack.pop();)try{if(!r.async&&1===o)return o=0,e.stack.push(r),Promise.resolve().then(n);if(r.dispose){var i=r.dispose.call(r.value);if(r.async)return o|=2,Promise.resolve(i).then(n,function(e){return t(e),n()})}else o|=1}catch(s){t(s)}if(1===o)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}()}function R(e,t){return"string"===typeof e&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(e,r,o,n,i){return r?t?".jsx":".js":!o||n&&i?o+n+"."+i.toLowerCase()+"js":e}):e}const H={__extends:n,__assign:i,__rest:s,__decorate:a,__param:c,__esDecorate:d,__runInitializers:l,__propKey:u,__setFunctionName:h,__metadata:g,__awaiter:p,__generator:m,__createBinding:f,__exportStar:v,__values:y,__read:b,__spread:S,__spreadArrays:C,__spreadArray:k,__await:w,__asyncGenerator:P,__asyncDelegator:T,__asyncValues:E,__makeTemplateObject:N,__importStar:F,__importDefault:B,__classPrivateFieldGet:L,__classPrivateFieldSet:x,__classPrivateFieldIn:A,__addDisposableResource:O,__disposeResources:_,__rewriteRelativeImportExtension:R}},57471:(e,t,r)=>{"use strict";function o(e){let t=`${e.siteUrl}?driveId=${encodeURIComponent(e.driveId)}&itemId=${encodeURIComponent(e.itemId)}&path=${encodeURIComponent(e.dataStorePath)}`;return e.containerPackageName&&(t+=`&containerPackageName=${encodeURIComponent(e.containerPackageName)}`),e.fileVersion&&(t+=`&fileVersion=${encodeURIComponent(e.fileVersion)}`),t}r.d(t,{m:()=>o})},57833:(e,t,r)=>{"use strict";r.d(t,{p:()=>n});var o=r(85851);const n=(e,t,r)=>{let n,i;return{start:()=>{n=performance.now(),i=Date.now()},end:()=>{(0,o.F)(()=>{if(!n||!i)return;const o=performance.now(),s=Math.round(o-n),a={renderStage:e,startTime:i,durationMs:s,endTime:i+s,telemetryMetadataOverride:r};t.emit("onRenderStageComplete",a)},document.visibilityState)}}}},58358:(e,t,r)=>{"use strict";r.d(t,{b:()=>n});var o=r(85038);function n(e){return(0,o.vA)(!!e,2358),{Authorization:e}}},58443:(e,t,r)=>{"use strict";r.d(t,{A2:()=>u,CZ:()=>S,Ct:()=>i,FT:()=>f,KV:()=>d,L0:()=>g,Nu:()=>l,R0:()=>a,UH:()=>p,a8:()=>b,bY:()=>s,g4:()=>n,l1:()=>h,pY:()=>y,s:()=>v,sz:()=>m,xu:()=>o,yz:()=>c});const o="fluidElement",n=".fluid",i=".loop",s="animatedSplashScreen",a="FluidHostWin32",c=!1,d=!0,l=!1,u=100,h="FormsLoop",g="fluidLink",p="componentPartHostingElementId",m=864e5,f=290,v=835,y=245,b="white solid 1px",S="black solid 1px"},58511:(e,t,r)=>{"use strict";r.d(t,{L:()=>o});const o={curveAccelerateMax:"cubic-bezier(0.9,0.1,1,0.2)",curveAccelerateMid:"cubic-bezier(1,0,1,1)",curveAccelerateMin:"cubic-bezier(0.8,0,0.78,1)",curveDecelerateMax:"cubic-bezier(0.1,0.9,0.2,1)",curveDecelerateMid:"cubic-bezier(0,0,0,1)",curveDecelerateMin:"cubic-bezier(0.33,0,0.1,1)",curveEasyEaseMax:"cubic-bezier(0.8,0,0.2,1)",curveEasyEase:"cubic-bezier(0.33,0,0.67,1)",curveLinear:"cubic-bezier(0,0,1,1)"}},59091:(e,t,r)=>{"use strict";r.d(t,{kx:()=>U,FM:()=>j,Om:()=>H});var o=r(83125),n=r(33788),i=r(95996),s=r(75460),a=r(16135),c=r(82963),d=r(32896);const l="FluidOdspDriver";var u=r(53783),h=r(63990);const g="fluidDevOverrides";var p=r(74411),m=r(49750),f=r(93537),v=r(37805);const y="odspDriverManifestUrl";var b=r(52841);const S="fluidOdspDriverManifestCache_";function C(e){return S+(e||"Prod")}const k="v1",w="/odsp-driver/versionless/deploymentManifestOdspDriver.json";let P=24192e5;async function T(e){const t=function(e){try{const t=function(e){const t=(0,b.Ar)()?.getItem(C(e));return t?JSON.parse(t):null}(e);if(!t)return null;return Date.now()-t.lastUpdatedTime>P?null:t}catch(t){return null}}(e);return t?(function(e){(0,b.Ar)()&&(0,h.l)(()=>E(e,"low").catch(()=>{}))}(e),t):await E(e)}async function E(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"high";const r=function(e){try{return window.top[g]?.[e]}catch{return}}(y)||(0,p.o)(e)+w,o={method:"GET",priority:t};try{const t=await(0,f.J5)(r,o,{maxRetries:3,filter:(0,f.sC)([709,710]),backoffFn:(0,v.FT)(500)});if(t.result.ok){const r=await t.result.json();return function(e,t){if(!(0,b.Ar)())return;const r={...e,lastUpdatedTime:Date.now()};(0,b.Ar)()?.setItem(C(t),JSON.stringify(r))}(r,e),r}throw new m.o(`Invalid response of "${t.result.statusText}" with status ${t.result.status}, isUserDefinitelyOffline: ${"undefined"!==typeof navigator&&!navigator.onLine}`,t.result)}catch(n){const e=n instanceof Error?n.message:void 0;throw new u.Ej("Error fetching ODSP Driver manifest"+(" with message "+e),"OdspDriverFetchError",n)}}async function N(e){return function(e){return e.jsBaseUrl+"/"+e[k].index}(await T(e))}const I={GetOdspCode:"GetOdspCode"},D="OdspDriverCodeLoader",F="getServiceDeliveredOdspCode",B="Could not load service-delivered ODSP Driver Code";async function L(e){let{windowContext:t,environment:r,logger:i,trustedTypesPolicy:u,disposeOnCompletion:h}=e;const g=i&&new o.p(D,i),p=n.m.start(I.GetOdspCode,g,{addUserTiming:!0}),m=t;m[l]||(m[l]={});const f=m[l];try{if(f.getDocumentServiceFactory)return p.setResult(!0,{message:"Namespace already loaded."}),f;if(f.scriptLoadingStarted){const e=new s.c;return f.pending||(f.pending=[]),f.pending.push({promise:e,logger:g}),await e,p.setResult(!0,{message:"Loaded from existing call."}),f}f.scriptLoadingStarted=!0;const e=(0,a.Rs)(r),t=await N(e),o=(0,c.c)(e),n=u&&{trustedTypesPolicy:await u,allowedOrigins:o};return await(0,d.a)(m,t,n),f.pending?.forEach(e=>e.promise.resolve()),delete f.pending,p.setResult(!0,{message:"Loaded from first call."}),f}catch(v){const e=new Error(B);throw v instanceof Error&&x(g,v),delete f.scriptLoadingStarted,f.pending?.forEach(t=>{v instanceof Error&&x(t.logger,v),t.promise.reject(e)}),delete f.pending,p.setResult(!1,void 0,e),e}finally{h&&function(e){delete e[l]}(m)}}function x(e,t){e&&(0,i.hO)(e,{eventName:F},t)}var A=r(58443),O=r(69235),M=r(51655),_=r(81918),R=r(90846);let H=!1;class U{constructor(e,t){this.urlResolver=e,this.documentServiceFactory=t}get DriverImplementation(){return this}}async function j(e,t,r,n,i,s,a){var c;const d=3*A.sz,l=s?new R.f({partitionKey:a,logger:r,maxCacheItemAge:d}):void 0,u=t.environment,h=null!==(c=t.hostStoragePolicy)&&void 0!==c?c:{},g=r;h.enableRedeemFallback=!0;try{return H=!0,await async function(e){let{windowContext:t,environment:r,tokenProvider:n,trustedTypesPolicy:i,logger:s,driverCache:a,hostStoragePolicy:c,disposeOnCompletion:d}=e;const l=s&&new o.p(D,s);return(await L({windowContext:t,environment:r,logger:l,trustedTypesPolicy:i,disposeOnCompletion:d})).getDocumentServiceFactory({tokenProvider:n,logger:l,driverCache:a,hostStoragePolicy:c})}({windowContext:window,driverCache:l,environment:u,hostStoragePolicy:h,logger:g,tokenProvider:i,settingsProvider:n,disposeOnCompletion:!0,trustedTypesPolicy:void 0})}catch(p){(0,O.c2)("getDocumentServiceFactory()",new O.uV("getServiceDeliveredDocumentServiceFactory() failed.",p))}try{H=!1,e.odspModuleImportTracker=new M.q;const t=await e.odspModuleImportTracker.measure(()=>(0,_.Al)());return(await t.getNpmSharepointDriver(i,g,l,h,{appName:void 0},n)).documentServiceFactory}catch(p){(0,O.c2)("getSharepointDriver()",(0,O.oD)(p))}throw new O.uV("Unable to get the document service factory.")}},60119:(e,t,r)=>{"use strict";r.d(t,{a:()=>d});var o=r(91947),n=r(6971),i=r(24921);let s,a=[],c=!1;const d=new class{get LoopTelemetrySink(){return this}async sendTelemetryEvent(e){var t;void 0===s&&(s=await(0,n.E)());const r=JSON.stringify(e),d=null!==(t=s.telemetryBatchDurationMs)&&void 0!==t?t:0;d>0?(a.push(r),async function(e){if(!c){c=!0,await(0,i.y)(e),c=!1;const t=a;a=[],(0,o.wW)(t)}}(d)):(0,o.wW)([r])}}},60138:(e,t,r)=>{"use strict";r.d(t,{z:()=>h});var o=r(58443),n=r(40118),i=r(56142),s=r(69235),a=r(51655),c=r(24921),d=r(91947),l=r(51492),u=r(6971);class h{constructor(){this.getTokenCallCount=0,this.getTokenTotalDuration=0,this.getTokenSucceededAfterRetryCount=0,this.retryEnabledPromise=void 0,this.identityType="Enterprise"}get TokenProvider(){return this}getAppId(){return o.R0}async getToken(e,t){++this.getTokenCallCount;const r=a.q.startNew(),c=await(0,u.E)();if(e&&e.length>0){let a;var d;if(e[0]&&e[0].indexOf("/")>=0)try{const t=new URL(e[0]),r=t.pathname.lastIndexOf("/");if(r>0){const e=t.pathname.substring(0,r);t.pathname=e,a=t.href}else a=`${t.protocol}//${t.hostname}`}catch(h){throw(0,s.c2)("getToken()",new s.uV("scopes resource url is invalid",h)),new s.uV("scopes resource url is invalid")}else a=null!==(d=c.graphEndpoint)&&void 0!==d?d:"https://graph.microsoft.com";try{var l;const e=null===t||void 0===t?void 0:t.claims,o=null!==(l=null===t||void 0===t?void 0:t.forceRefresh)&&void 0!==l&&l,i=await n.n.GetInstance().getToken(a,e,o);return r.setSuccess(),this.getTokenTotalDuration+=r.getDuration(),"fromCache"in i?{token:i.token,fromCache:i.fromCache}:{token:i.token}}catch(h){throw o.Nu||(0,i.vV)(h),h}}throw new s.uV("No scopes provided to getToken")}async getTokenWithRetries(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4e3;let o=0,n=1e3<r?1e3:r;for(;;)try{const r=await this.getToken(e,t);return o>0&&++this.getTokenSucceededAfterRetryCount,r}catch(i){this.retryEnabledPromise||(this.retryEnabledPromise=(0,d.PA)(l.u.OEP,"ChangeGate.FluidHost.TokenRetryOnError"));if(!await this.retryEnabledPromise)throw i;++o;const e=this.decorateErrorPerErrorCode(i,o);if(!e.canRetry)throw e.canRetry,e;if(o>=25)throw e;n>0&&await(0,c.y)(n),n=2*n>r?r:2*n}}decorateErrorPerErrorCode(e,t){const r=e;switch(r.attemptCount=t,null===r||void 0===r?void 0:r.errorCode){case 12007:r.canRetry=!0;break;case 13002:r.canRetry=!1,r.isExpected=!0;break;case 13001:case 13003:case 13005:r.canRetry=!1}return r}}},60257:(e,t,r)=>{"use strict";r.d(t,{q:()=>o});const o=(e,t)=>{if(void 0!==e&&void 0!==t)return e-t}},60295:(e,t,r)=>{"use strict";var o;r.d(t,{NM:()=>i,RN:()=>n,nL:()=>o}),function(e){e[e.FromSummary=0]="FromSummary",e[e.FromAttach=1]="FromAttach",e[e.Local=2]="Local"}(o||(o={}));const n="BlobCount",i="TotalBlobSize"},60835:(e,t,r)=>{"use strict";r.d(t,{OF:()=>l,g2:()=>g,qT:()=>h,sN:()=>d});var o=r(29018),n=r(40635),i=r(74405),s=r(72376),a=r(95996);const c=new Map;function d(e,t,r,d,l,u){const h=(0,o.$)(t),g=`${h}_${r}_${d}`;if(!c.has(g)){const o=async()=>{const o={getToken:o=>{if(o){const n={...o,siteUrl:t,driveId:r,itemId:d};return e.getToken([`${h}/files.readwrite.all`],n)}throw Error("Options must be specified")},url:`${h}/_api/v2.0/drives/${r}/items/${d}?select=sharepointIds`,tenantId:u,requestInit:{method:"GET"},retryPolicy:s._9,tokenPolicy:(0,s.N$)(e)},p=l?(0,n.g)({...o,logger:l,nameForLogging:"GetFileSharepointIds",doNotLogOnSuccess:!0,getAdditionalProps:async(e,t)=>(0,i.u)(e)}):(0,n.y)(o);let m;try{m=(await p).result}catch{}if(m?.ok){let e;try{e=await m.json()}catch(f){l&&(0,a.hO)(l,{eventName:"GetFileSharepointIdsResponseParseError"},f)}if(e?.sharepointIds)return e.sharepointIds;l&&(0,a.hO)(l,{eventName:"GetFileSharepointIdsUnexpectedResponse"},new Error("sharepointIds is missing from response body"))}404!==m?.status&&c.delete(g)};c.set(g,o())}return c.get(g).then()}async function l(e,t,r,o,n,i,s){return u(e,t,r,o,void 0,n,i,s)}async function u(e,t,r,c,d,l,u,h){const g=(0,o.$)(t),p=void 0!==d?`:/${encodeURIComponent(d)}:/`:"",m={getToken:o=>{if(o){const n={...o,siteUrl:t,driveId:r,itemId:c};return e.getToken([`${g}/files.readwrite.all`],n)}throw Error("Options must be specified")},url:`${g}/_api/v2.0/drives/${r}/items/${c}${p}/?select=webUrl,webDavUrl,name,sharepointIds,parentReference,title`,tenantId:u,requestInit:{method:"GET",signal:h},retryPolicy:s._9,tokenPolicy:(0,s.N$)(e)},f=l?(0,n.g)({...m,logger:l,nameForLogging:"GetFileItemLite",doNotLogOnSuccess:!0,getAdditionalProps:async(e,t)=>(0,i.u)(e)}):(0,n.y)(m);let v;try{v=(await f).result}catch{}if(v?.ok)try{return await v.json()}catch(y){l&&(0,a.hO)(l,{eventName:"GetFileItemLiteResponseParseError"},y)}}const h=async(e,t,r,o,n)=>{if(g(e))return l(t,e.siteUrl,e.driveId,e.itemId,r,o,n).then(e=>{const t=e?.webDavUrl.lastIndexOf("/");if(void 0!==t&&t>0)return e?.webDavUrl.substring(0,t)})},g=e=>"driveId"in e&&"siteUrl"in e&&"itemId"in e},61376:(e,t,r)=>{"use strict";t.b=void 0;var o=r(87987);Object.defineProperty(t,"b",{enumerable:!0,get:function(){return o.EventEmitter}})},61865:(e,t,r)=>{"use strict";r.d(t,{n:()=>P,S:()=>T});var o=r(73105),n=r(15217),i=r(96516),s=r(86748),a=r(52389);class c{constructor(e){this._next=this,this._prev=this,this.headNode=this,e&&(this._list=e)}get next(){return this._next===this.headNode?void 0:this._next}get prev(){return this._prev===this.headNode?void 0:this._prev}get list(){return this.headNode._list}}const d=new c(void 0);class l extends c{constructor(e,t){super(void 0),this.data=t,this.headNode=e}remove(){return this.list?.remove(this)}}function u(e,t){let r=e;const o=r._next;let n;for(const i of t){const t=new l(e.headNode,i);void 0===n?n={first:t,last:t}:n.last=t,t._prev=r,r._next=t,r=t}if(o._prev=r,r._next=o,void 0===n)throw new Error("items must not be empty");return n}class h{constructor(e){this._len=0,this.headNode=new c(this),void 0!==e&&this.push(...e)}find(e){let t;return g(this,r=>{if(e(r,this))return t=r,!1}),t}map(e){let t=this.first;return{next(){if(void 0===t)return{done:!0,value:void 0};const r={value:e(t),done:!1};return t=t.next,r},[Symbol.iterator](){return this}}}insertAfter(e){if(!this._includes(e))throw new Error("preceding not in list");for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return this._len+=r.length,u(e,r)}pop(){return this.remove(this.last)}push(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._len+=t.length;return u(this.headNode._prev,t)}shift(){return this.remove(this.first)}unshift(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._len+=t.length,u(this.headNode,t)}splice(e,t){const r=new h;return g(this,e=>{const o=this._remove(e);if(o.headNode=r.headNode,o._next=r.headNode,o._prev=r.headNode._prev,r.headNode._prev._next=o,r.headNode._prev=o,r._len++,e===t||r.length===t)return!1},e),r}includes(e){return this._includes(e)}_includes(e){return e instanceof l&&e.headNode===this.headNode}_remove(e){if(this._includes(e))return e._prev._next=e._next,e._next._prev=e._prev,e.headNode=e._next=e._prev=d,this._len--,e}remove(e){return this._remove(e)}[Symbol.iterator](){let e=this.first;return{next(){if(void 0!==e){const t={value:e,done:!1};return e=e.next,t}return{value:void 0,done:!0}},[Symbol.iterator](){return this}}}get length(){return this._len}get empty(){return 0===this._len}get first(){return this.headNode.next}get last(){return this.headNode.prev}}function g(e,t,r){let o,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(r){if(!e.includes(r))throw new Error("start must be in the provided list");o=r}else o=n?e.first:e.last;let i=n?o?.next:o?.prev;for(;void 0!==o;){if(!1===t(o))return!1;o=i,i=n?i?.next:i?.prev}return!0}var p,m=r(77565),f=r(11502),v=r(55651);function y(e){return void 0!==e&&"number"===typeof e.pendingMessageId&&("add"===e.type||"edit"===e.type)}function b(e){return void 0!==e&&"clear"===e.type&&"number"===typeof e.pendingMessageId}class S{get size(){return this.data.size}constructor(e,t,r,o,n){this.serializer=e,this.handle=t,this.submitMessage=r,this.isAttached=o,this.eventEmitter=n,this.messageHandlers=new Map,this.data=new Map,this.pendingKeys=new Map,this.nextPendingMessageId=0,this.pendingMapLocalOpMetadata=new h,this.pendingClearMessageIds=[],this.messageHandlers=this.getMessageHandlers()}keys(){return this.data.keys()}entries(){const e=this.data.entries();return{next(){const t=e.next();return t.done?{value:void 0,done:!0}:{value:[t.value[0],t.value[1].value],done:!1}},[Symbol.iterator](){return this}}}values(){const e=this.data.values();return{next(){const t=e.next();return t.done?{value:void 0,done:!0}:{value:t.value.value,done:!1}},[Symbol.iterator](){return this}}}[Symbol.iterator](){return this.entries()}forEach(e){this.data.forEach((t,r,o)=>{e(t.value,r,o)})}get(e){const t=this.data.get(e);return void 0===t?void 0:t.value}has(e){return this.data.has(e)}set(e,t){if(void 0===e||null===e)throw new Error("Undefined and null keys are not supported");const r=this.setCore(e,{value:t},!0);if(!this.isAttached())return;const o={key:e,type:"set",value:{type:f.e[f.e.Plain],value:t}};this.submitMapKeyMessage(o,r)}delete(e){const t=this.deleteCore(e,!0);if(!this.isAttached())return void 0!==t;const r={key:e,type:"delete"};return this.submitMapKeyMessage(r,t),void 0!==t}clear(){const e=this.isAttached()?new Map(this.data):void 0;if(this.clearCore(!0),this.pendingKeys.clear(),!this.isAttached())return;this.submitMapClearMessage({type:"clear"},e)}getSerializedStorage(e){const t={};for(const[r,o]of this.data.entries())t[r]=(0,v.Q)(o.value,e,this.handle);return t}populateFromSerializable(e){for(const[t,r]of Object.entries(this.serializer.decode(e)))(0,v.R)(r,this.serializer,this.handle),this.data.set(t,{value:r.value})}tryResubmitMessage(e,t){const r=this.messageHandlers.get(e.type);return void 0!==r&&(r.resubmit(e,t),!0)}tryApplyStashedOp(e){switch(e.type){case"clear":this.clear();break;case"delete":this.delete(e.key);break;case"set":(0,v.R)(e.value,this.serializer,this.handle),this.set(e.key,e.value.value);break;default:(0,m.$)(e)}}tryProcessMessage(e,t,r){const o=this.messageHandlers.get(e.type);return void 0!==o&&(o.process(e,t,r),!0)}rollback(e,t){const r=e,o=t,i=this.pendingMapLocalOpMetadata.pop();if((0,n.vA)(void 0!==i&&i===o,3019),"clear"===r.type&&"clear"===o.data.type){if(void 0===o.data.previousMap)throw new Error("Cannot rollback without previous map");for(const[t,r]of o.data.previousMap.entries())this.setCore(t,r,!0);const e=this.pendingClearMessageIds.pop();if(void 0===e||e!==o.data.pendingMessageId)throw new Error("Rollback op does match last clear")}else{if("delete"!==r.type&&"set"!==r.type)throw new Error("Unsupported op for rollback");{if("add"===o.data.type)this.deleteCore(r.key,!0);else{if("edit"!==o.data.type||void 0===o.data.previousValue)throw new Error("Cannot rollback without previous value");this.setCore(r.key,o.data.previousValue,!0)}const e=this.pendingKeys.get(r.key),t=e?.pop();if(!e||t!==o.data.pendingMessageId)throw new Error("Rollback op does not match last pending");0===e.length&&this.pendingKeys.delete(r.key)}}}setCore(e,t,r){const o=this.data.get(e),n=o?.value;return this.data.set(e,t),this.eventEmitter.emit("valueChanged",{key:e,previousValue:n},r,this.eventEmitter),o}clearCore(e){this.data.clear(),this.eventEmitter.emit("clear",e,this.eventEmitter)}deleteCore(e,t){const r=this.data.get(e),o=r?.value;return this.data.delete(e)&&this.eventEmitter.emit("valueChanged",{key:e,previousValue:o},t,this.eventEmitter),r}clearExceptPendingKeys(){const e=new Map;for(const t of this.pendingKeys.keys())this.data.has(t)&&e.set(t,this.data.get(t));this.clearCore(!1);for(const[t,r]of e.entries())this.setCore(t,r,!0)}needProcessKeyOperation(e,t,r){if(void 0!==this.pendingClearMessageIds[0])return t&&(0,n.vA)(void 0!==r&&y(r)&&r.pendingMessageId<this.pendingClearMessageIds[0],19),!1;const o=this.pendingKeys.get(e.key);return void 0!==o?(t&&((0,n.vA)(void 0!==r&&y(r),20),(0,n.vA)(o[0]===r.pendingMessageId,762),o.shift(),0===o.length&&this.pendingKeys.delete(e.key)),!1):!t}getMessageHandlers(){const e=new Map;return e.set("clear",{process:(e,t,r)=>{if(t){const e=this.pendingMapLocalOpMetadata.shift();(0,n.vA)(void 0!==e&&e===r,3020),(0,n.vA)(b(r.data),21);const t=this.pendingClearMessageIds.shift();return void(0,n.vA)(t===r.data.pendingMessageId,763)}this.pendingKeys.size>0?this.clearExceptPendingKeys():this.clearCore(t)},resubmit:(e,t)=>{const r=t.remove()?.data;(0,n.vA)(void 0!==r,3021),(0,n.vA)(b(t.data),764);const o=this.pendingClearMessageIds.shift();(0,n.vA)(o===t.data.pendingMessageId,765),this.submitMapClearMessage(e,t.data.previousMap)}}),e.set("delete",{process:(e,t,r)=>{if(t){const e=this.pendingMapLocalOpMetadata.shift();(0,n.vA)(void 0!==e&&e===r,3022)}this.needProcessKeyOperation(e,t,r?.data)&&this.deleteCore(e.key,t)},resubmit:(e,t)=>{const r=t.remove()?.data;(0,n.vA)(void 0!==r,3023),this.resubmitMapKeyMessage(e,t.data)}}),e.set("set",{process:(e,t,r)=>{if(t){const e=this.pendingMapLocalOpMetadata.shift();(0,n.vA)(void 0!==e&&e===r,3024)}this.needProcessKeyOperation(e,t,r?.data)&&((0,v.R)(e.value,this.serializer,this.handle),this.setCore(e.key,{value:e.value.value},t))},resubmit:(e,t)=>{const r=t.remove()?.data;(0,n.vA)(void 0!==r,3025),this.resubmitMapKeyMessage(e,t.data)}}),e}getMapClearMessageId(){const e=this.nextPendingMessageId++;return this.pendingClearMessageIds.push(e),e}submitMapClearMessage(e,t){const r=function(e,t,r){return{type:"clear",pendingMessageId:t,previousMap:r}}(0,this.getMapClearMessageId(),t),o=this.pendingMapLocalOpMetadata.push(r).first;this.submitMessage(e,o)}getMapKeyMessageId(e){const t=this.nextPendingMessageId++,r=this.pendingKeys.get(e.key);return void 0===r?this.pendingKeys.set(e.key,[t]):r.push(t),t}submitMapKeyMessage(e,t){const r=function(e,t,r){return r?{type:"edit",pendingMessageId:t,previousValue:r}:{type:"add",pendingMessageId:t}}(0,this.getMapKeyMessageId(e),t),o=this.pendingMapLocalOpMetadata.push(r).first;this.submitMessage(e,o)}resubmitMapKeyMessage(e,t){(0,n.vA)(y(t),766);const r=this.pendingKeys.get(e.key);if(void 0===r)return;const o=r.indexOf(t.pendingMessageId);if(-1===o)return;r.splice(o,1),0===r.length&&this.pendingKeys.delete(e.key);const i=this.getMapKeyMessageId(e),s="edit"===t.type?{type:"edit",pendingMessageId:i,previousValue:t.previousValue}:{type:"add",pendingMessageId:i},a=this.pendingMapLocalOpMetadata.push(s).first;this.submitMessage(e,a)}}const C="header";class k extends o.T6{constructor(e,t,r){super(e,t,r,"fluid_map_"),this[p]="SharedMap",this.kernel=new S(this.serializer,this.handle,(e,t)=>this.submitLocalMessage(e,t),()=>this.isAttached(),this)}keys(){return this.kernel.keys()}entries(){return this.kernel.entries()}values(){return this.kernel.values()}[(p=Symbol.toStringTag,Symbol.iterator)](){return this.kernel.entries()}get size(){return this.kernel.size}forEach(e){this.kernel.forEach(e)}get(e){return this.kernel.get(e)}has(e){return this.kernel.has(e)}set(e,t){return this.kernel.set(e,t),this}delete(e){return this.kernel.delete(e)}clear(){this.kernel.clear()}summarizeCore(e,t){let r=0,o=0,n={};const i=[],s=new a.qt,c=this.kernel.getSerializedStorage(e);for(const[a,l]of Object.entries(c))if(l.value&&l.value.length>=8192){const e=`blob${o}`;o++,i.push(e);const t={[a]:{type:l.type,value:JSON.parse(l.value)}};s.addBlob(e,JSON.stringify(t))}else{if(r+=l.type.length+21,l.value&&(r+=l.value.length),r>16384){const e=`blob${o}`;o++,i.push(e),s.addBlob(e,JSON.stringify(n)),n={},r=0}n[a]={type:l.type,value:void 0===l.value?void 0:JSON.parse(l.value)}}const d={blobs:i,content:n};return s.addBlob(C,JSON.stringify(d)),s.getSummaryTree()}async loadCore(e){const t=await(0,s.P)(e,C),r=t;if(Array.isArray(r.blobs)){this.kernel.populateFromSerializable(r.content);const t=await Promise.all(r.blobs.map(async t=>(0,s.P)(e,t)));for(const e of t)this.kernel.populateFromSerializable(e)}else this.kernel.populateFromSerializable(t)}onDisconnect(){}reSubmitCore(e,t){this.kernel.tryResubmitMessage(e,t)}applyStashedOp(e){this.kernel.tryApplyStashedOp(e)}processCore(e,t,r){e.type===i.Go.Operation&&(0,n.vA)(this.kernel.tryProcessMessage(e.contents,t,r),2738)}rollback(e,t){this.kernel.rollback(e,t)}}var w=r(90876);class P{get type(){return P.Type}get attributes(){return P.Attributes}async load(e,t,r,o){const n=new k(t,e,o);return await n.load(r),n}create(e,t){const r=new k(t,e,P.Attributes);return r.initializeLocal(),r}}P.Type="https://graph.microsoft.com/types/map",P.Attributes={type:P.Type,snapshotFormatVersion:"0.2",packageVersion:w.z};const T=(0,o.Bm)(P)},62231:(e,t,r)=>{"use strict";function o(){return r.e(26853).then(r.bind(r,52564)).then(e=>e.getInstance())}r.d(t,{H:()=>o})},62951:(e,t,r)=>{"use strict";r.d(t,{M:()=>c});var o=r(87615),n=r(14365),i=r(54813),s=r(93586),a=r(91119);async function c(e,t,r,c){let d=1e3;const l=(0,o.l)();let u;for(let g=1;;g++){void 0!==c&&c();try{const n=await e();return g>1&&r.sendTelemetryEvent({eventName:"MultipleRetries",callName:t,attempts:g,duration:(0,o.l)()-l},u),n}catch(h){const e=(0,i.YU)(h),c=!0===h?.[a.Cj],p=h?.errorType===s.E.serviceReadOnly;if(1===g&&r.sendTelemetryEvent({eventName:`${t}_firstFailed`,callName:t,attempts:g,duration:(0,o.l)()-l},h),!c&&!p||!e)throw h;if(5===g)throw r.sendErrorEvent({eventName:c?"CoherencyErrorTooManyRetries":"ServiceReadonlyErrorTooManyRetries",callName:t,attempts:g,duration:(0,o.l)()-l},h),h.canRetry=!1,h;d=(0,i.E9)(h)??d,await(0,n.c)(Math.floor(d)),d+=d/4*(1+Math.random()),u=h}}}},63520:(e,t,r)=>{"use strict";r.d(t,{CL:()=>f,G0:()=>u,Ln:()=>g,fG:()=>p,uz:()=>h});var o=r(20258),n=r(27250);const i=new o.d(()=>a(l())),s={getRawConfig:()=>{}},a=e=>void 0!==e&&null!==e?new u(void 0,{getRawConfig:t=>{try{return d(e.getItem(t)??void 0)?.raw}catch{return}}}):s;function c(e){switch(e){case"boolean":case"number":case"string":return!0;default:return!1}}function d(e){let t,r=e;if("string"===typeof e)try{r=JSON.parse(e),t={raw:e,string:e}}catch{}if(void 0===r)return t;const o=typeof r;if(c(o))return{...t,raw:e,[o]:r};if(Array.isArray(r)){const o=typeof r[0];if(!c(o))return t;for(const e of r)if(typeof e!==o)return t;return{...t,raw:e,[`${o}[]`]:r}}return t}const l=()=>{try{return globalThis.sessionStorage??void 0}catch{return}};class u{constructor(e){this.logger=e,this.configCache=new Map,this.orderedBaseProviders=[];const t=new Set;for(var r=arguments.length,o=new Array(r>1?r-1:0),n=1;n<r;n++)o[n-1]=arguments[n];const i=[...o];for(;i.length>0;){const e=i.shift();void 0!==e&&m(e)&&!t.has(e)&&(t.add(e),e instanceof u?i.push(...e.orderedBaseProviders):this.orderedBaseProviders.push(e))}}getBoolean(e){return this.getCacheEntry(e)?.boolean}getNumber(e){return this.getCacheEntry(e)?.number}getString(e){return this.getCacheEntry(e)?.string}getBooleanArray(e){return this.getCacheEntry(e)?.["boolean[]"]}getNumberArray(e){return this.getCacheEntry(e)?.["number[]"]}getStringArray(e){return this.getCacheEntry(e)?.["string[]"]}getRawConfig(e){return this.getCacheEntry(e)?.raw}getCacheEntry(e){if(!this.configCache.has(e)){for(const t of this.orderedBaseProviders){const r=d(t?.getRawConfig(e));if(void 0!==r)return this.configCache.set(e,r),this.logger?.send({category:"generic",eventName:"ConfigRead",...(0,n.Df)({configName:e,configValue:JSON.stringify(r)})}),r}this.configCache.set(e,{raw:void 0})}return this.configCache.get(e)}}function h(e){const t=e;return m(t?.config)&&void 0!==t?.logger}function g(e){return h(e)?e:p(e,i.value)}function p(e){if(h(e))throw new Error("Logger is already a monitoring context");const t=e;for(var r=arguments.length,o=new Array(r>1?r-1:0),n=1;n<r;n++)o[n-1]=arguments[n];return t.config=new u(e,...o),t.logger=e,t}function m(e){const t=e;return"function"===typeof t?.getRawConfig}function f(e){return g((0,n.pW)(e))}},63722:(e,t,r)=>{"use strict";r.d(t,{nr:()=>h});var o,n=r(56851),i=r(96752),s=0,a=1,c=2,d="__stylesheet__",l="undefined"!==typeof navigator&&/rv:11.0/.test(navigator.userAgent),u={};try{u=window||{}}catch(g){}var h=function(){function e(e,t){var r,o,i,c,d,l;this._rules=[],this._preservedRules=[],this._counter=0,this._keyToClassName={},this._onInsertRuleCallbacks=[],this._onResetCallbacks=[],this._classNameToArgs={},this._config=(0,n.__assign)({injectionMode:"undefined"===typeof document?s:a,defaultPrefix:"css",namespace:void 0,cspSettings:void 0},e),this._classNameToArgs=null!==(r=null===t||void 0===t?void 0:t.classNameToArgs)&&void 0!==r?r:this._classNameToArgs,this._counter=null!==(o=null===t||void 0===t?void 0:t.counter)&&void 0!==o?o:this._counter,this._keyToClassName=null!==(c=null!==(i=this._config.classNameCache)&&void 0!==i?i:null===t||void 0===t?void 0:t.keyToClassName)&&void 0!==c?c:this._keyToClassName,this._preservedRules=null!==(d=null===t||void 0===t?void 0:t.preservedRules)&&void 0!==d?d:this._preservedRules,this._rules=null!==(l=null===t||void 0===t?void 0:t.rules)&&void 0!==l?l:this._rules}return e.getInstance=function(t){if(o=u[d],u[i.Se])return u[i.Se].getInstance(t);if(!o||o._lastStyleElement&&o._lastStyleElement.ownerDocument!==document){var r=(null===u||void 0===u?void 0:u.FabricConfig)||{},n=new e(r.mergeStyles,r.serializedStylesheet);o=n,u[d]=n}return o},e.prototype.serialize=function(){return JSON.stringify({classNameToArgs:this._classNameToArgs,counter:this._counter,keyToClassName:this._keyToClassName,preservedRules:this._preservedRules,rules:this._rules})},e.prototype.setConfig=function(e){this._config=(0,n.__assign)((0,n.__assign)({},this._config),e)},e.prototype.onReset=function(e){var t=this;return this._onResetCallbacks.push(e),function(){t._onResetCallbacks=t._onResetCallbacks.filter(function(t){return t!==e})}},e.prototype.onInsertRule=function(e){var t=this;return this._onInsertRuleCallbacks.push(e),function(){t._onInsertRuleCallbacks=t._onInsertRuleCallbacks.filter(function(t){return t!==e})}},e.prototype.getClassName=function(e){var t=this._config.namespace,r=e||this._config.defaultPrefix;return"".concat(t?t+"-":"").concat(r,"-").concat(this._counter++)},e.prototype.cacheClassName=function(e,t,r,o){this._keyToClassName[this._getCacheKey(t)]=e,this._classNameToArgs[e]={args:r,rules:o}},e.prototype.classNameFromKey=function(e){return this._keyToClassName[this._getCacheKey(e)]},e.prototype.getClassNameCache=function(){return this._keyToClassName},e.prototype.argsFromClassName=function(e){var t=this._classNameToArgs[e];return t&&t.args},e.prototype.insertedRulesFromClassName=function(e){var t=this._classNameToArgs[e];return t&&t.rules},e.prototype.insertRule=function(e,t,r){void 0===r&&(r=i.P6);var o=this._config.injectionMode,n=o!==s?this._getStyleElement():void 0;if(t&&this._preservedRules.push(e),n)switch(o){case a:this._insertRuleIntoSheet(n.sheet,e);break;case c:n.appendChild(document.createTextNode(e))}else this._rules.push(e);this._config.onInsertRule&&this._config.onInsertRule(e),this._onInsertRuleCallbacks.forEach(function(t){return t({key:r,sheet:n?n.sheet:void 0,rule:e})})},e.prototype.getRules=function(e){return(e?this._preservedRules.join(""):"")+this._rules.join("")},e.prototype.reset=function(){this._rules=[],this._counter=0,this._classNameToArgs={},this._keyToClassName={},this._onResetCallbacks.forEach(function(e){return e()})},e.prototype.resetKeys=function(){this._keyToClassName={}},e.prototype._createStyleElement=function(){var e,t=(null===(e=this._config.window)||void 0===e?void 0:e.document)||document,r=t.head,o=t.createElement("style"),n=null;o.setAttribute("data-merge-styles","true");var i=this._config.cspSettings;if(i&&i.nonce&&o.setAttribute("nonce",i.nonce),this._lastStyleElement)n=this._lastStyleElement.nextElementSibling;else{var s=this._findPlaceholderStyleTag();n=s?s.nextElementSibling:r.childNodes[0]}return r.insertBefore(o,r.contains(n)?n:null),this._lastStyleElement=o,o},e.prototype._insertRuleIntoSheet=function(e,t){if(!e)return!1;try{return e.insertRule(t,e.cssRules.length),!0}catch(r){}return!1},e.prototype._getCacheKey=function(e){return e},e.prototype._getStyleElement=function(){var e=this;this._styleElement||(this._styleElement=this._createStyleElement(),l||(this._config.window||window).requestAnimationFrame(function(){e._styleElement=void 0}));return this._styleElement},e.prototype._findPlaceholderStyleTag=function(){var e=document.head;return e?e.querySelector("style[data-merge-styles]"):null},e}()},63854:(e,t,r)=>{"use strict";function o(e){return n(e)}function n(e){switch(e){case"ar-sa":case"fa-ir":case"he-il":case"ug-cn":case"ur-pk":return"rtl";default:return"ltr"}}r.d(t,{Gz:()=>o})},63990:(e,t,r)=>{"use strict";r.d(t,{M:()=>a,l:()=>s});let o=[],n=!1,i=!1;function s(e,t){o.push({ensureExecution:!0===t?.ensureExecution,task:e}),t?.ensureExecution&&!i&&("object"===typeof document?document.addEventListener("visibilitychange",()=>{"hidden"===document.visibilityState&&u()}):u(),i=!0),c()}function a(e){const t=o.findIndex(t=>t.task===e);-1!==t&&o.splice(t,1)}function c(){if(!n){if("function"===typeof requestIdleCallback)requestIdleCallback(l);else{const e=Date.now()+50;setTimeout(()=>l({timeRemaining:()=>Math.max(e-Date.now(),0),didTimeout:!1}),0)}n=!0}}function d(e,t){const r=[];for(let n=0;n<o.length;n+=1){if(t&&!t()){r.push(...o.slice(n));break}const i=o[n];e&&!e(i)?r.push(i):i.task()}o=r}function l(e){d(void 0,()=>e.timeRemaining()>10),n=!1,o.length>0&&c()}function u(){d(e=>e.ensureExecution)}},64580:(e,t,r)=>{"use strict";r.d(t,{$:()=>h,G:()=>u});var o=r(5482),n=r(56142),i=r(91947),s=r(40684),a=r(97232),c=r(37513),d=r(94794),l=r(41395);function u(e){const t={[d.D.clientSessionExpiredError]:a.d.Error_FluidContainer_ClientSessionExpiredError,[d.D.dataCorruptionError]:a.d.Error_FluidContainer_DataCorruption,[d.D.dataProcessingError]:a.d.Error_FluidContainer_DataProcessingError,[d.D.genericError]:a.d.Error_FluidContainer_GeneralError,[d.D.throttlingError]:a.d.Error_FluidContainer_ThrottlingError,[d.D.usageError]:a.d.Error_FluidContainer_UsageError,[o.qb.RootComponentCreateFailed]:a.d.Error_FluidContainerLoad_RootComponentCreateFailed,[o.qb.RaasNotSupported]:a.d.Error_FluidContainerLoad_RaasNotSupported,[c.a.authorizationError]:a.d.ExpectedError_FluidDriver_AuthorizationError,[c.a.deltaStreamConnectionForbidden]:a.d.Error_FluidDriver_DeltaStreamConnectionForbidden,[c.a.fetchFailure]:a.d.ExpectedError_FluidDriver_FetchFailure,[c.a.fileNotFoundOrAccessDeniedError]:a.d.ExpectedError_FluidDriver_FileNotFoundOrAccessDenied,[c.a.fileOverwrittenInStorage]:a.d.Error_FluidDriver_FileOverwrittenInStorage,[c.a.fluidInvalidSchema]:a.d.Error_FluidDriver_FluidInvalidSchema,[c.a.genericError]:a.d.Error_FluidDriver_GenericError,[c.a.genericNetworkError]:a.d.Error_FluidDriver_GenericNetworkError,[c.a.incorrectServerResponse]:a.d.Error_FluidDriver_IncorrectServerResponse,[c.a.locationRedirection]:a.d.Error_FluidDriver_LocationRedirection,[c.a.offlineError]:a.d.ExpectedError_FluidDriver_OfflineError,[c.a.throttlingError]:a.d.Error_FluidDriver_ThrottlingError,[c.a.usageError]:a.d.Error_FluidDriver_UsageError,[c.a.unsupportedClientProtocolVersion]:a.d.Error_FluidDriver_UnsupportedClientProtocolVersion,[c.a.writeError]:a.d.Error_FluidDriver_WriteError,[c.a.fileIsLocked]:a.d.Error_FluidDriver_FileIsLocked,[l.E.cannotCatchUp]:a.d.Error_FluidOdsp_CannotCatchUp,[l.E.fetchTimeout]:a.d.Error_FluidOdsp_FetchTimeout,[l.E.fetchTokenError]:a.d.Error_FluidOdsp_FetchTokenError,[l.E.fluidNotEnabled]:a.d.ExpectedError_FluidOdsp_FluidNotEnabled,[l.E.invalidFileNameError]:a.d.Error_FluidOdsp_InvalidFileNameError,[l.E.outOfStorageError]:a.d.Error_FluidOdsp_OutOfStorageError,[l.E.serviceReadOnly]:a.d.Error_FluidOdsp_ServiceReadOnly,[l.E.snapshotTooBig]:a.d.Error_FluidOdsp_SnapshotTooBig,[l.E.blockedIPAddress]:a.d.Error_FluidOdsp_BlockedIPAddress,[o.ZY.ComponentNotFound]:a.d.Error_FluidOWH_ComponentNotFound,[o.ZY.ContainerUpgradeRequired]:a.d.Error_FluidOWH_ContainerUpgradeRequired,[o.ZY.IframeLoadFailed]:a.d.Error_FluidOWH_IFrameLoadFailed,[o.v6]:a.d.Error_Fluid_UnknownError};return e?t[e]:a.d.Error_Fluid_Undefined}function h(e){const t=function(e){switch(e){case a.d.Success_Hydrated:case a.d.Success_NoFluidUrl:case a.d.ExpectedError_FluidDriver_AuthorizationError:case a.d.ExpectedError_FluidDriver_FetchFailure:case a.d.ExpectedError_FluidDriver_FileNotFoundOrAccessDenied:case a.d.ExpectedError_FluidDriver_OfflineError:case a.d.ExpectedError_FluidOdsp_FluidNotEnabled:case a.d.ExpectedError_FluidHostWebApp_CannotFetchContainerManifest:return!0;default:return!1}}(e);return(0,n.Rm)(`Hydrate ${t?"succeeded":"failed"}: ${a.d[e]} (${e}).`),(0,i.Jn)(s.QK.Hydrate,t,e)}},64643:(e,t,r)=>{"use strict";var o;r.d(t,{q:()=>a});var n=r(899),i=r(16281);let s;async function a(){const e=(0,n.Mg)();try{return s||(s=await r(65606)(`./${e}/strings.json`)),s}catch(t){return o||(o=r.t(i,2))}}},65043:(e,t,r)=>{"use strict";e.exports=r(14202)},65199:(e,t,r)=>{"use strict";r.d(t,{z:()=>o});const o="2.23.0"},65317:(e,t,r)=>{"use strict";r.d(t,{ku:()=>o});function o(e){return e.replace(/(https:\/\/)(\w)+(.sharepoint.com|-my.sharepoint.com|.sharepoint-df.com|.sharepoint-mil.us|-my.sharepoint-mil.us|.sharepoint.us|-my.sharepoint.us)/,"(redacted)").replace(/(https:\/\/)(dev.loop.microsoft.com|df.loop.microsoft.com|loop.microsoft.com|preview.loop.microsoft.com|loop.cloud.microsoft|loop.cloud-dev.microsoft)(\/p\/)([a-zA-Z0-9%]+)/,"(redacted)")}},65606:(e,t,r)=>{var o={"./af-ZA/strings.json":[90976,90976],"./am-ET/strings.json":[79327,79327],"./ar-SA/strings.json":[36077,36077],"./as-IN/strings.json":[6471,6471],"./az-Latn-AZ/strings.json":[69110,69110],"./bg-BG/strings.json":[41514,41514],"./bn-IN/strings.json":[11299,11299],"./bs-Latn-BA/strings.json":[59108,59108],"./ca-ES/strings.json":[89520,89520],"./ca-Es-VALENCIA/strings.json":[69698,69698],"./cs-CZ/strings.json":[94751,94751],"./cy-GB/strings.json":[66561,66561],"./da-DK/strings.json":[57940,57940],"./de-DE/strings.json":[2338,2338],"./el-GR/strings.json":[88974,88974],"./en-GB/strings.json":[10572,10572],"./en-US/strings.json":[16281],"./es-ES/strings.json":[38428,38428],"./es-MX/strings.json":[23329,23329],"./et-EE/strings.json":[55953,55953],"./eu-ES/strings.json":[52326,52326],"./fa-IR/strings.json":[58888,58888],"./fi-FI/strings.json":[4474,4474],"./fil-PH/strings.json":[17925,17925],"./fr-CA/strings.json":[93892,93892],"./fr-FR/strings.json":[26748,26748],"./ga-IE/strings.json":[55346,55346],"./gd-gb/strings.json":[43164,43164],"./gl-ES/strings.json":[77873,77873],"./gu-IN/strings.json":[14183,14183],"./he-IL/strings.json":[97244,97244],"./hi-IN/strings.json":[7374,7374],"./hr-HR/strings.json":[93420,93420],"./hu-HU/strings.json":[36738,36738],"./hy-AM/strings.json":[13039,13039],"./id-ID/strings.json":[22362,22362],"./is-IS/strings.json":[85916,85916],"./it-IT/strings.json":[79450,79450],"./ja-JP/strings.json":[3201,3201],"./ka-GE/strings.json":[76128,76128],"./kk-KZ/strings.json":[85031,85031],"./km-KH/strings.json":[19347,19347],"./kn-IN/strings.json":[96900,96900],"./ko-KR/strings.json":[3763,3763],"./kok-IN/strings.json":[61374,61374],"./lb-LU/strings.json":[57397,57397],"./lt-LT/strings.json":[15520,15520],"./lv-LV/strings.json":[45092,45092],"./mi-NZ/strings.json":[65662,65662],"./mk-MK/strings.json":[12156,12156],"./ml-IN/strings.json":[10632,10632],"./mr-IN/strings.json":[32870,32870],"./ms-MY/strings.json":[40738,40738],"./mt-MT/strings.json":[49306,49306],"./nb-NO/strings.json":[20559,20559],"./ne-NP/strings.json":[41717,41717],"./nl-NL/strings.json":[28688,6307],"./nn-NO/strings.json":[50787,50787],"./or-IN/strings.json":[65156,65156],"./pa-IN/strings.json":[85902,85902],"./pl-PL/strings.json":[62200,62200],"./pt-BR/strings.json":[95164,95164],"./pt-PT/strings.json":[38328,15947],"./quz-PE/strings.json":[5891,5891],"./ro-RO/strings.json":[11354,11354],"./ru-RU/strings.json":[68346,68346],"./sk-SK/strings.json":[10672,10672],"./sl-SI/strings.json":[37801,37801],"./sq-AL/strings.json":[53205,53205],"./sr-Cyrl-BA/strings.json":[7911,7911],"./sr-Cyrl-RS/strings.json":[25621,25621],"./sr-Latn-RS/strings.json":[26676,26676],"./sv-SE/strings.json":[98595,98595],"./ta-IN/strings.json":[9858,9858],"./te-IN/strings.json":[56510,56510],"./th-TH/strings.json":[11072,11072],"./tr-TR/strings.json":[96444,96444],"./tt-RU/strings.json":[12481,12481],"./ug-CN/strings.json":[89441,89441],"./uk-UA/strings.json":[55874,55874],"./ur-PK/strings.json":[18196,18196],"./uz-Latn-UZ/strings.json":[28566,28566],"./vi-VN/strings.json":[89559,89559],"./zh-CN/strings.json":[77771,77771],"./zh-TW/strings.json":[56295,56295]};function n(e){if(!r.o(o,e))return Promise.resolve().then(()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t});var t=o[e],n=t[0];return Promise.all(t.slice(1).map(r.e)).then(()=>r.t(n,19))}n.keys=()=>Object.keys(o),n.id=65606,e.exports=n},65922:(e,t,r)=>{"use strict";r.d(t,{oZ:()=>o});const o={10:"#061724",20:"#082338",30:"#0a2e4a",40:"#0c3b5e",50:"#0e4775",60:"#0f548c",70:"#115ea3",80:"#0f6cbd",90:"#2886de",100:"#479ef5",110:"#62abf5",120:"#77b7f7",130:"#96c6fa",140:"#b4d6fa",150:"#cfe4fa",160:"#ebf3fc"}},66267:(e,t,r)=>{"use strict";r.d(t,{C:()=>a,J:()=>c});var o=r(19813),n=function(e,t,r,o){return new(r||(r=Promise))(function(n,i){function s(e){try{c(o.next(e))}catch(t){i(t)}}function a(e){try{c(o.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})},i=function(e,t){var r,o,n,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},s=Object.create(("function"===typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"===typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(c){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(i=0)),i;)try{if(r=1,o&&(n=2&a[0]?o.return:a[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,a[1])).done)return n;switch(o=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(n=(n=i.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){i.label=a[1];break}if(6===a[0]&&i.label<n[1]){i.label=n[1],n=a;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(a);break}n[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(c){a=[6,c],o=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},s=function(){function e(){}return e.prototype.canLoad=function(e){return e.packageName===c},e.prototype.load=function(e){return n(this,void 0,void 0,function(){return i(this,function(t){if(!this.canLoad(e))throw new Error("Incompatible loop code details.");return[2,Promise.all([r.e(97950),r.e(2977),r.e(84807)]).then(r.bind(r,61687)).then(function(t){return{module:t,details:e}})]})})},e}(),a={instantiateLoopCodeLoader:function(e){return Promise.resolve(new s)}},c=o.JL},68180:(e,t,r)=>{"use strict";r.d(t,{c:()=>o});function o(e){try{const t=new URL(e),r=t.searchParams.get("nav");if(!r)return e;const o=window.atob(r),n=new URLSearchParams(o),i=n.get("c");if(!i?.includes("deepLinkInfo")&&!i?.includes("minified"))return e;n.set("c","");const s=n.toString(),a=window.btoa(s);return t.searchParams.set("nav",a),t.toString()}catch(t){return e}}},68194:(e,t,r)=>{"use strict";r.d(t,{AH:()=>n,O0:()=>i});var o=r(41818);const n=e=>o.Ss.from(e,"base64").toString("utf8"),i=e=>o.Ss.from(e,"utf8").toString("base64")},69235:(e,t,r)=>{"use strict";r.d(t,{aK:()=>h,c2:()=>g,oD:()=>l,u1:()=>u,uV:()=>d});var o=r(90589),n=r(37450),i=r(58443),s=r(82645),a=r(56142),c=r(97232);class d extends Error{constructor(e,t,r){super(e),this.name=void 0,this.message=void 0,this.innerError=void 0,this.hydrateResult=void 0,this.name="AppError",this.message=e,this.innerError=t,this.hydrateResult=null!==r&&void 0!==r?r:c.d.Error_FluidHostWebApp_Exception}}function l(e){return e instanceof d?e:new d(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Exception occurred.",e)}function u(e){return"string"===typeof e?e:e instanceof Error?e.message:e instanceof PromiseRejectionEvent?e.reason:`${e}`}function h(e){return e instanceof d?e.message:""}function g(e,t){if(i.yz){const e=u(t);(0,a.vV)(`UNEXPECTED ERROR: ${e}`)}else{const r={eventName:"Office.Extensibility.Fluid.HostWebAppErrors",eventFlags:{dataCategories:n.o.DataCategories.ProductServiceUsage,diagnosticLevel:n.o.DiagnosticLevel.FullEvent},dataFields:[(0,o.m9)("Message",h(t)),(0,o.m9)("Source",e)]};i.Nu||s.u.sendTelemetryEvent(r)}}},69649:(e,t,r)=>{"use strict";r.d(t,{P2:()=>f});const o=(e,t)=>t.some(t=>e instanceof t);let n,i;const s=new WeakMap,a=new WeakMap,c=new WeakMap,d=new WeakMap,l=new WeakMap;let u={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return a.get(e);if("objectStoreNames"===t)return e.objectStoreNames||c.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return p(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function h(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(i||(i=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return e.apply(m(this),r),p(s.get(this))}:function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return p(e.apply(m(this),r))}:function(t){for(var r=arguments.length,o=new Array(r>1?r-1:0),n=1;n<r;n++)o[n-1]=arguments[n];const i=e.call(m(this),t,...o);return c.set(i,t.sort?t.sort():[t]),p(i)}}function g(e){return"function"===typeof e?h(e):(e instanceof IDBTransaction&&function(e){if(a.has(e))return;const t=new Promise((t,r)=>{const o=()=>{e.removeEventListener("complete",n),e.removeEventListener("error",i),e.removeEventListener("abort",i)},n=()=>{t(),o()},i=()=>{r(e.error||new DOMException("AbortError","AbortError")),o()};e.addEventListener("complete",n),e.addEventListener("error",i),e.addEventListener("abort",i)});a.set(e,t)}(e),o(e,n||(n=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,u):e)}function p(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,r)=>{const o=()=>{e.removeEventListener("success",n),e.removeEventListener("error",i)},n=()=>{t(p(e.result)),o()},i=()=>{r(e.error),o()};e.addEventListener("success",n),e.addEventListener("error",i)});return t.then(t=>{t instanceof IDBCursor&&s.set(t,e)}).catch(()=>{}),l.set(t,e),t}(e);if(d.has(e))return d.get(e);const t=g(e);return t!==e&&(d.set(e,t),l.set(t,e)),t}const m=e=>l.get(e);function f(e,t){let{blocked:r,upgrade:o,blocking:n,terminated:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=indexedDB.open(e,t),a=p(s);return o&&s.addEventListener("upgradeneeded",e=>{o(p(s.result),e.oldVersion,e.newVersion,p(s.transaction))}),r&&s.addEventListener("blocked",()=>r()),a.then(e=>{i&&e.addEventListener("close",()=>i()),n&&e.addEventListener("versionchange",()=>n())}).catch(()=>{}),a}const v=["get","getKey","getAll","getAllKeys","count"],y=["put","add","delete","clear"],b=new Map;function S(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(b.get(t))return b.get(t);const r=t.replace(/FromIndex$/,""),o=t!==r,n=y.includes(r);if(!(r in(o?IDBIndex:IDBObjectStore).prototype)||!n&&!v.includes(r))return;const i=async function(e){const t=this.transaction(e,n?"readwrite":"readonly");let i=t.store;for(var s=arguments.length,a=new Array(s>1?s-1:0),c=1;c<s;c++)a[c-1]=arguments[c];return o&&(i=i.index(a.shift())),(await Promise.all([i[r](...a),n&&t.done]))[0]};return b.set(t,i),i}u=(e=>({...e,get:(t,r,o)=>S(t,r)||e.get(t,r,o),has:(t,r)=>!!S(t,r)||e.has(t,r)}))(u)},70354:(e,t,r)=>{"use strict";r.d(t,{F:()=>h,M:()=>d});var o=r(87615),n=r(14365),i=r(87804),s=r(83533),a=r(54813),c=r(65199);async function d(e,t,r,s){let d,l=!1,u=500,g=0;const p=(0,o.l)();let m;do{try{d=await e(s.cancel),l=!0}catch(f){if(!(0,a.YU)(f))throw r.sendTelemetryEvent({eventName:`${t}_cancel`,retry:g,duration:(0,o.l)()-p,fetchCallName:t},f),f;if(!0===s.cancel?.aborted)throw r.sendTelemetryEvent({eventName:`${t}_runWithRetryAborted`,retry:g,duration:(0,o.l)()-p,fetchCallName:t,reason:s.cancel.reason},f),new a.OI("runWithRetry was Aborted",i.a.genericError,{driverVersion:c.z,fetchCallName:t,reason:s.cancel.reason});0===g&&r.sendTelemetryEvent({eventName:`${t}_firstFailed`,duration:(0,o.l)()-p,fetchCallName:t},f),g++,m=f,u=h(u,f),s.onRetry&&s.onRetry(u,f),await(0,n.c)(u)}}while(!l);return g>0&&r.sendTelemetryEvent({eventName:`${t}_lastError`,retry:g,duration:(0,o.l)()-p,fetchCallName:t},m),d}const l=6e4,u=8e3;function h(e,t){const r=(0,a.E9)(t);let o=Math.max(r??0,2*e);return o=Math.min(o,(0,s.X)(t)&&!0===t.getTelemetryProperties().endpointReached?l:u),o}},70530:(e,t,r)=>{"use strict";r.d(t,{z6:()=>_,wF:()=>D,wL:()=>E,bP:()=>w,bf:()=>S,cr:()=>b,ZR:()=>y,nb:()=>R,Q1:()=>L,Yn:()=>k,gO:()=>v,TV:()=>f,IU:()=>x,$o:()=>C,vh:()=>A,K3:()=>I,xP:()=>F,jL:()=>B,JH:()=>N,bJ:()=>P,yI:()=>T,Ss:()=>O});var o=r(87615),n=r(85038),i=r(54813),s=r(84295),a=r(93586);const c=e=>null===e||"string"===typeof e?e:void 0===e?null:e.token,d=e=>{if("object"===typeof e&&void 0!==e?.authorizationHeader)return e.authorizationHeader;const t=c(e);return null!==t?`Bearer ${t}`:null},l=e=>null===e||"string"===typeof e?void 0:e.fromCache;var u=r(20611),h=r(27250),g=r(39521),p=r(50349),m=r(27612);const f="getWithRetryForTokenRefreshRepeat";async function v(e){return e({refresh:!1}).catch(async t=>{const r={refresh:!0,previousError:t};switch(t.errorType){case a.E.authorizationError:{const o=t;return e({...r,claims:o.claims,tenantId:o.tenantId})}case a.E.incorrectServerResponse:case a.E.fetchTokenError:return e(r);default:if(!0===t[f])return e(r);throw t}})}async function y(e,t){const r=(0,o.l)();return fetch(e,t).then(async e=>{const t=e;if(!t)throw new i.OI("No response from ODSP fetch call",a.E.incorrectServerResponse,{driverVersion:m.z});(!t.ok||t.status<200||t.status>=300)&&(0,s.lJ)(`ODSP fetch error [${t.status}]`,t.status,t,await t.text());const n=function(e){const t=new Map;for(const[r,o]of e.entries())t.set(r,o);return t}(t.headers);return{content:t,headers:n,propsToLog:(0,s.qw)(n),duration:(0,o.l)()-r}},e=>{const t=(0,i.sc)(),r={value:`${e}`,tag:h.mc.UserData},o=r.value.replace(/((http|https):\/\/(\S*))/i,"REDACTED_URL");if("AbortError"===e.name)throw new i.dw("Fetch Timeout (AbortError)",a.E.fetchTimeout,{driverVersion:m.z});if(o.includes("ETIMEDOUT"))throw new i.dw("Fetch Timeout (ETIMEDOUT)",a.E.fetchTimeout,{driverVersion:m.z});throw t===i.WA.Offline?new i.dw(`ODSP fetch failure (Offline): ${o}`,a.E.offlineError,{driverVersion:m.z,rawErrorMessage:r}):new i.dw(`ODSP fetch failure: ${o}`,a.E.fetchFailure,{driverVersion:m.z,rawErrorMessage:r})})}async function b(e,t){const{content:r,headers:o,propsToLog:n,duration:i}=await y(e,t);let a;try{a=await r.arrayBuffer()}catch{(0,s.lJ)("Error while parsing fetch response",s.TX,r,void 0,n)}return n.bodySize=a.byteLength,{headers:o,content:a,propsToLog:n,duration:i}}async function S(e,t){const{content:r,headers:o,propsToLog:n,duration:i}=await y(e,t);let a;try{a=await r.text()}catch{(0,s.lJ)("Error while parsing fetch response",s.TX,r,a,n)}n.bodySize=a.length;return{headers:o,content:JSON.parse(a),propsToLog:n,duration:i}}function C(e){return void 0===e.type||"New"===e.type}function k(e){return(0,n.vA)(!0===e.odspResolvedUrl,478),e}y.fetch=fetch;const w=e=>(0,h.pW)({logger:e,namespace:"OdspDriver",properties:{all:{driverVersion:m.z}}});function P(e,t,r){return T(e,t,r,!0,!1)}function T(e,t,r,o,n){return async function(s,u){let p=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return h.Bt.timedExecAsync(e,{eventName:`${u}_GetToken`,attempts:s.refresh?2:1,hasClaims:!!s.claims,hasTenantId:!!s.tenantId},async e=>r({...s,...t}).then(t=>{const r=n?c(t):d(t);if((p||e.duration>=32)&&e.end({fromCache:l(t),isNull:null===r}),null===r&&o)throw new i.OI("The Host-provided token fetcher returned null",a.E.fetchTokenError,{method:u,driverVersion:m.z});return r},e=>{const t=e?.canRetry;throw(0,g.J4)(e,e=>new i.Tj("The Host-provided token fetcher threw an error",a.E.fetchTokenError,"boolean"===typeof t&&t,{method:u,errorMessage:e,driverVersion:m.z}))}),{cancel:"generic"})}}function E(e,t){return{type:t?u.W3:u.o1,key:e.fileVersion??"",file:{resolvedUrl:e,docId:e.hashedDocumentId}}}function N(e){return e.getBoolean("Fluid.Container.UseLoadingGroupIdForSnapshotFetch2")}const I=79872;function D(e){if(!e)return;let t=`createLinkScope=${e.scope}`;const r=e.role;return t=r?`${t}&createLinkRole=${r}`:t,t}function F(e){const t=(0,o.l)();return[e(),(0,o.l)()-t]}async function B(e){const t=(0,o.l)();return[await e(),(0,o.l)()-t]}function L(e){return`${e.hashedDocumentId}/joinsession`}function x(e){return void 0!==e&&"snapshotFormatV"in e&&1===e.snapshotFormatV}function A(e){return void 0!==e&&e.length>0}function O(e){return void 0===e}const M=e=>"object"===typeof e&&"string"===typeof e?.name&&"object"===typeof e?.fluid;function _(e,t,r,o){const n=new URL(e),i=r||(t.dataStorePath??"");return(0,p.Cu)(n,{siteUrl:t.siteUrl,driveId:t.driveId,itemId:t.itemId,dataStorePath:i,appName:t.appName,containerPackageName:o,fileVersion:t.fileVersion,context:t.context}),n.href}function R(e){let t;return t=e&&"name"in e?e.name:M(e?.package)?e?.package.name:e?.package,t}},71724:e=>{"use strict";function t(e){if(this._capacity=o(e),this._length=0,this._front=0,r(e)){for(var t=e.length,n=0;n<t;++n)this[n]=e[n];this._length=t}}t.prototype.toArray=function(){for(var e=this._length,t=new Array(e),r=this._front,o=this._capacity,n=0;n<e;++n)t[n]=this[r+n&o-1];return t},t.prototype.push=function(e){var t=arguments.length,r=this._length;if(t>1){var o=this._capacity;if(r+t>o){for(var n=0;n<t;++n){this._checkCapacity(r+1),this[i=this._front+r&this._capacity-1]=arguments[n],r++,this._length=r}return r}for(var i=this._front,n=0;n<t;++n)this[i+r&o-1]=arguments[n],i++;return this._length=r+t,r+t}return 0===t?r:(this._checkCapacity(r+1),this[n=this._front+r&this._capacity-1]=e,this._length=r+1,r+1)},t.prototype.pop=function(){var e=this._length;if(0!==e){var t=this._front+e-1&this._capacity-1,r=this[t];return this[t]=void 0,this._length=e-1,r}},t.prototype.shift=function(){var e=this._length;if(0!==e){var t=this._front,r=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length=e-1,r}},t.prototype.unshift=function(e){var t=this._length,r=arguments.length;if(r>1){if(t+r>(n=this._capacity)){for(var o=r-1;o>=0;o--){this._checkCapacity(t+1);var n=this._capacity;this[s=(this._front-1&n-1^n)-n]=arguments[o],t++,this._length=t,this._front=s}return t}var i=this._front;for(o=r-1;o>=0;o--){var s;this[s=(i-1&n-1^n)-n]=arguments[o],i=s}return this._front=i,this._length=t+r,t+r}if(0===r)return t;this._checkCapacity(t+1);n=this._capacity;return this[o=(this._front-1&n-1^n)-n]=e,this._length=t+1,this._front=o,t+1},t.prototype.peekBack=function(){var e=this._length;if(0!==e)return this[this._front+e-1&this._capacity-1]},t.prototype.peekFront=function(){if(0!==this._length)return this[this._front]},t.prototype.get=function(e){var t=e;if(t===(0|t)){var r=this._length;if(t<0&&(t+=r),!(t<0||t>=r))return this[this._front+t&this._capacity-1]}},t.prototype.isEmpty=function(){return 0===this._length},t.prototype.clear=function(){for(var e=this._length,t=this._front,r=this._capacity,o=0;o<e;++o)this[t+o&r-1]=void 0;this._length=0,this._front=0},t.prototype.toString=function(){return this.toArray().toString()},t.prototype.valueOf=t.prototype.toString,t.prototype.removeFront=t.prototype.shift,t.prototype.removeBack=t.prototype.pop,t.prototype.insertFront=t.prototype.unshift,t.prototype.insertBack=t.prototype.push,t.prototype.enqueue=t.prototype.push,t.prototype.dequeue=t.prototype.shift,t.prototype.toJSON=t.prototype.toArray,Object.defineProperty(t.prototype,"length",{get:function(){return this._length},set:function(){throw new RangeError("")}}),t.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(o(1.5*this._capacity+16))},t.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e;var r=this._front,o=this._length;r+o>t&&function(e,t,r,o,n){for(var i=0;i<n;++i)r[i+o]=e[i+t],e[i+t]=void 0}(this,0,this,t,r+o&t-1)};var r=Array.isArray;function o(e){if("number"!==typeof e){if(!r(e))return 16;e=e.length}return t=Math.min(Math.max(16,e),1073741824),t>>>=0,t-=1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,1+(t|=t>>16);var t}e.exports=t},72376:(e,t,r)=>{"use strict";r.d(t,{N$:()=>a,_9:()=>n});var o=r(93537);const n={maxRetries:2,backoffFn:(0,r(37805).FT)(500),filter:(0,o.sC)([408,409,503]),respectRetryAfterHeader:!0},i={queryParam:"access_token",doNotExceedQueryParamsLength:2048,preferAuthorizationInMultipartFormBody:!0,doNotExceedMultipartFormBodyLength:81920},s={preferAuthorizationInMultipartFormBody:!0,doNotExceedMultipartFormBodyLength:81920};function a(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return{..."Consumer"===e.identityType?s:i,preferAuthorizationInMultipartFormBody:t}}},73105:(e,t,r)=>{"use strict";r.d(t,{T6:()=>F,Bm:()=>B});var o=r(19688),n=r(15217),i=r(60295),s=r(29951),a=r(93023);class c extends a.X{constructor(e){super(),this.errorHandler=e}emit(e){try{for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return super.emit(e,...r)}catch(n){return this.errorHandler(e,n),!0}}}var d=r(50178),l=r(17637),u=r(20310);function h(e,t){const r=Math.pow(10,t);return Math.round(e*r)/r}class g{get disposed(){return this._disposed}constructor(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new Map;this.eventBase=e,this.logger=t,this.sampleThreshold=r,this.includeAggregateMetrics=o,this.perBucketProperties=n,this._disposed=!1,this.measurementsMap=new Map}measure(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const r=(0,u.l)(),o=e(),n=(0,u.l)()-r;let i=this.measurementsMap.get(t);void 0===i&&(i={measurements:{count:0,duration:-1},dataSums:{},dataMaxes:{}},this.measurementsMap.set(t,i));const s=i.measurements;return s.count++,s.duration=n,this.includeAggregateMetrics&&(s.totalDuration=(s.totalDuration??0)+n,s.minDuration=Math.min(s.minDuration??n,n),s.maxDuration=Math.max(s.maxDuration??0,n)),this.isCustomData(o)&&(i=this.accumulateCustomData(o.customData,i)),s.count>=this.sampleThreshold&&(this.includeAggregateMetrics&&(s.averageDuration=(s.totalDuration??0)/s.count),this.flushBucket(t)),o}isCustomData(e){return"object"===typeof e&&null!==e&&"customData"in e&&"object"===typeof e.customData}accumulateCustomData(e,t){for(const[r,o]of Object.entries(e))(0,n.vA)("string"===typeof r,2527),(0,n.vA)("number"===typeof o,2528),t.dataSums[r]=(t.dataSums[r]??0)+o,t.dataMaxes[r]=Math.max(t.dataMaxes[r]??Number.NEGATIVE_INFINITY,o);return t}processCustomData(e,t){const r={};if(void 0===e.dataSums||void 0===e.dataMaxes)return r;const o=e.dataSums,n=e.dataMaxes;for(const[i,s]of Object.entries(o))r[`avg_${i}`]=h(s/t,6),r[`max_${i}`]=n[i]??0;return r}flushBucket(e){const t=this.measurementsMap.get(e);if(void 0===t)return;const r=t.measurements,o=this.processCustomData(t,r.count);if(0!==r.count){const t=this.perBucketProperties.get(e),n={...this.eventBase,...t,...r,...o};this.logger.sendPerformanceEvent(n),this.measurementsMap.delete(e)}}dispose(e){for(const[t]of this.measurementsMap.entries())this.flushBucket(t);this._disposed=!0}}var p=r(39773),m=r(74621),f=r(45852);function v(e){return Array.isArray(e)?[...e]:{...e}}var y=r(15894),b=r(24907),S=r(19984),C=r(4041);class k extends y.SA{constructor(e,t,r){super(),this.absolutePath=e,this.routeContext=t,this.payloadPending=r,this.isAttached=!0,(0,n.vA)(e.startsWith("/"),413)}async get(){if(void 0===this.objectP){const e={url:this.absolutePath,headers:{[C.$6.viaHandle]:!0,[C.$6.payloadPending]:this.payloadPending}};this.objectP=this.routeContext.resolveHandle(e).then(t=>{if("fluid/object"===t.mimeType){return t.value}throw(0,S.MD)(t,e)})}return this.objectP}attachGraph(){}}var w=r(98483);function P(e){return(0,y.jP)(e)&&"function"===typeof e.bind}class T extends w.a{get isAttached(){return this.value.isAttached()}get isVisible(){return this.isAttached||this.isLocallyVisible}constructor(e,t,r){super(e,t,r.IFluidHandleContext),this.value=e,this.runtime=r,this.isLocallyVisible=!1,this.pendingHandles=new Set}attachGraph(){if(!this.isVisible){this.isLocallyVisible=!0;for(const e of this.pendingHandles)e.attachGraph();this.pendingHandles.clear(),this.value.bindToContext(),super.attachGraph()}}bind(e){!0!==this.runtime.inStagingMode&&(this.isVisible?e.attachGraph():this.pendingHandles.add(e))}}class E{constructor(e){for(this.context=e,this.root=this.context;void 0!==this.root.routeContext;)this.root=this.root.routeContext}get IFluidSerializer(){return this}encode(e,t){return(0,n.vA)(P(t),2956),e&&"object"===typeof e?this.recursivelyReplace(e,this.encodeValue.bind(this),t):e}decode(e){return e&&"object"===typeof e?this.recursivelyReplace(e,this.decodeValue.bind(this)):e}stringify(e,t){return(0,n.vA)(P(t),2957),JSON.stringify(e,(e,r)=>this.encodeValue(r,t))}parse(e){return JSON.parse(e,(e,t)=>this.decodeValue(t))}encodeValue(e,t){return(0,y.jP)(e)?((0,n.vA)(void 0!==t,2707),this.bindAndEncodeHandle((0,y.Fz)(e),t)):e}decodeValue(e){if((0,y.zF)(e)){const t=e.url.startsWith("/")?e.url:(0,b.a)(e.url,this.context);return new k(t,this.root,!0===e.payloadPending)}return e}recursivelyReplace(e,t,r){const o=t(e,r);if((0,y.jP)(e)||(0,y.jP)(o))return o;let n;for(const i of Object.keys(e)){const o=e[i];if(o&&"object"===typeof o){const s=this.recursivelyReplace(o,t,r);s!==o&&(n??=v(e),n[i]=s)}}return n??e}bindAndEncodeHandle(e,t){return t.bind(e),(0,y.oh)(e)}}class N extends E{constructor(){super(...arguments),this.visitedHandlePaths=new Set}getVisitedHandlePaths(){return[...this.visitedHandlePaths]}bindAndEncodeHandle(e){return this.visitedHandlePaths.add(e.absolutePath),{type:"__fluid_handle__",url:"UNUSED (see GCHandleVisitor)"}}}var I=r(16026);class D extends c{get IFluidLoadable(){return this}get connected(){return this._connected}constructor(e,t,r){super((e,t)=>this.eventListenerErrorHandler(e,t)),this.id=e,this.runtime=t,this.attributes=r,this._connected=!1,this._isBoundToContext=!1,(0,n.vA)(!e.includes("/"),772),this.handle=new T(this,e,t),this.logger=(0,d.pW)({logger:t.logger,properties:{all:{sharedObjectId:(0,f.A)(),...(0,d.Df)({ddsType:this.attributes.type})}}}),this.mc=(0,l.Ln)(this.logger);const{opProcessingHelper:o,callbacksHelper:i}=this.setUpSampledTelemetryHelpers();this.opProcessingHelper=o,this.callbacksHelper=i;const s=this.processMessagesCore?.bind(this);this.processMessagesHelper=void 0===s?e=>function(e,t){const{envelope:r,local:o,messagesContent:n}=e;for(const{contents:i,localOpMetadata:s,clientSequenceNumber:a}of n)t({...r,contents:i,clientSequenceNumber:a},o,s)}(e,this.process.bind(this)):e=>{!function(e,t,r,o){const{envelope:n,local:i,messagesContent:s}=e,a=(e,t)=>{for(const{contents:o,clientSequenceNumber:s}of t){const t={...n,contents:o,clientSequenceNumber:s};r(e,t,i)}};a("pre-op",s),t.measure(()=>{o(e);return{customData:{sequenceDifference:n.sequenceNumber-n.referenceSequenceNumber}}},i?"local":"remote"),a("op",s)}(e,this.opProcessingHelper,this.emitInternal.bind(this),s)}}get deltaManager(){return(0,s.k)(this.runtime.deltaManager)}setUpSampledTelemetryHelpers(){(0,n.vA)(void 0!==this.mc&&void 0!==this.logger,841);const e=new g({eventName:"ddsOpProcessing",category:"performance"},this.logger,this.mc.config.getNumber("Fluid.SharedObject.OpProcessingTelemetrySampling")??1e3,!0,new Map([["local",{localOp:!0}],["remote",{localOp:!1}]])),t=new g({eventName:"ddsEventCallbacks",category:"performance"},this.logger,this.mc.config.getNumber("Fluid.SharedObject.DdsCallbacksTelemetrySampling")??1e3,!0);return this.runtime.once("dispose",()=>{this.callbacksHelper.dispose(),this.opProcessingHelper.dispose()}),{opProcessingHelper:e,callbacksHelper:t}}closeWithError(e){void 0===this.closeError&&(this.closeError=e)}verifyNotClosed(){if(void 0!==this.closeError)throw this.closeError}eventListenerErrorHandler(e,t){const r=p.I9.wrapIfUnrecognized(t,"SharedObjectEventListenerException");throw r.addTelemetryProperties({emittedEventName:String(e)}),this.closeWithError(r),r}setBoundAndHandleAttach(){this.setBoundAndHandleAttach=()=>this.setConnectionState(this.runtime.connected),this._isBoundToContext=!0;const e=()=>{this.didAttach(),this.setConnectionState(this.runtime.connected)};this.isAttached()?e():this.runtime.once("attaching",e)}async load(e){this.services=e,this._isBoundToContext=!0,await this.loadCore(e.objectStorage),this.attachDeltaHandler(),this.setBoundAndHandleAttach()}initializeLocal(){this.initializeLocalCore()}bindToContext(){this.bindToContext=()=>{},this._isBoundToContext||(this.runtime.bindChannel(this),this.setBoundAndHandleAttach())}connect(e){void 0===this.services&&(this.services=e,this.attachDeltaHandler()),this.setBoundAndHandleAttach()}isAttached(){return this._isBoundToContext&&this.runtime.attachState!==o.d.Detached}initializeLocalCore(){}didAttach(){}submitLocalMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(this.verifyNotClosed(),this.isAttached()){const r=!0===this.runtime.submitMessagesWithoutEncodingHandles?(0,I.pM)(e,this.serializer,this.handle):(0,I.Dv)(e,this.serializer,this.handle);this.services.deltaConnection.submit(r,t)}}dirty(){this.isAttached()&&this.services.deltaConnection.dirty()}onConnect(){}reSubmitCore(e,t){this.submitLocalMessage(e,t)}reSubmitSquashed(e,t){(0,l.Ln)(this.logger).config.getBoolean("Fluid.SharedObject.AllowStagingModeWithoutSquashing")??this.runtime.options.allowStagingModeWithoutSquashing??!0?this.reSubmitCore(e,t):this.throwUnsupported("reSubmitSquashed")}async newAckBasedPromise(e){let t;return new Promise((r,o)=>{t=()=>o(new Error("FluidDataStoreRuntime disposed while this ack-based Promise was pending")),this.runtime.disposed?t():(this.runtime.on("dispose",t),e(r,o))}).finally(()=>{this.runtime.off("dispose",t)})}attachDeltaHandler(){(0,n.vA)(void 0!==this.services,122),this.services.deltaConnection.attach({processMessages:e=>{this.processMessages(e)},setConnectionState:e=>{this.setConnectionState(e)},reSubmit:(e,t,r)=>{this.reSubmit(e,t,r)},applyStashedOp:e=>{this.applyStashedOp((0,I.Zb)(e,this.serializer))},rollback:(e,t)=>{this.rollback(e,t)}})}setConnectionState(e){this.isAttached()&&this._connected!==e&&(this._connected=e,e?this.onConnect():this.onDisconnect())}process(e,t,r){this.verifyNotClosed(),this.emitInternal("pre-op",e,t,this),this.opProcessingHelper.measure(()=>{this.processCore(e,t,r);return{customData:{sequenceDifference:e.sequenceNumber-e.referenceSequenceNumber}}},t?"local":"remote"),this.emitInternal("op",e,t,this)}processMessages(e){this.verifyNotClosed();const t=[];for(const{contents:o,localOpMetadata:n,clientSequenceNumber:i}of e.messagesContent){const e={contents:(0,I.Zb)(o,this.serializer),localOpMetadata:n,clientSequenceNumber:i};t.push(e)}const r={...e,messagesContent:t};this.processMessagesHelper(r)}reSubmit(e,t,r){r?this.reSubmitSquashed(e,t):this.reSubmitCore(e,t)}rollback(e,t){this.throwUnsupported("rollback")}emit(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return this.callbacksHelper.measure(()=>super.emit(e,...r))}emitInternal(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return super.emit(e,...r)}throwUnsupported(e){throw new m.iq("Unsupported DDS feature",{featureName:e,...(0,d.Df)({ddsType:this.attributes.type})})}}class F extends D{get serializer(){return(0,n.vA)(!this._isGCing,117),this._serializer}constructor(e,t,r,o){super(e,t,r),this.telemetryContextPrefix=o,this._isGCing=!1,this._serializer=new E(this.runtime.channelsRoutingContext)}getAttachSummary(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>2?arguments[2]:void 0;const r=this.summarizeCore(this.serializer,t,void 0,e);return this.incrementTelemetryMetric(i.RN,r.stats.blobNodeCount,t),this.incrementTelemetryMetric(i.NM,r.stats.totalBlobSize,t),r}async summarize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;const o=this.summarizeCore(this.serializer,t,r,e);return this.incrementTelemetryMetric(i.RN,o.stats.blobNodeCount,t),this.incrementTelemetryMetric(i.NM,o.stats.totalBlobSize,t),o}getGCData(){let e;(0,n.vA)(!this._isGCing,120),this._isGCing=!0;try{const t=new N(this.runtime.channelsRoutingContext);this.processGCDataCore(t),e={gcNodes:{"/":t.getVisitedHandlePaths()}},(0,n.vA)(this._isGCing,121)}finally{this._isGCing=!1}return e}processGCDataCore(e){this.summarizeCore(e)}incrementTelemetryMetric(e,t,r){if(void 0!==r){(0,n.vA)("get"in r&&"function"===typeof r.get,2430);const o=r.get(this.telemetryContextPrefix,e)??0;r.set(this.telemetryContextPrefix,e,o+t)}}}function B(e){const t={getFactory:()=>new e,create:(t,r)=>t.createChannel(r,e.Type),is:t=>void 0!==t.attributes&&t.attributes.type===e.Type};return t}},73370:(e,t,r)=>{"use strict";function o(e,t,r){e.headers instanceof Headers?e.headers.set(t,r):e.headers={...e.headers,[t]:r}}r.d(t,{p:()=>i,Y:()=>n});const n="Bearer";function i(e,t,r,i,s){const a=new URL(e),c=i.startsWith(n);let d=!1;c&&s.queryParam&&(a.searchParams.set(s.queryParam,r),d=!s.doNotExceedQueryParamsLength||a.search.length<=s.doNotExceedQueryParamsLength,d||a.searchParams.delete(s.queryParam));let l=t;if(!d){l={...t};let e=!1;if(c){const r=t?.method?t.method.toUpperCase():"GET";if(s.preferAuthorizationInMultipartFormBody&&["GET","POST"].includes(r)){l.method="POST";const n=crypto.randomUUID(),c=[];c.push(`--${n}`),c.push(`Authorization: ${i}`),c.push(`X-HTTP-Method-Override: ${r}`),c.push("_post: 1"),t?.body&&c.push(`\r\n${t.body}\r\n`),c.push(`\r\n--${n}--`);const d=c.join("\r\n");e=!s.doNotExceedMultipartFormBodyLength||d.length<=s.doNotExceedMultipartFormBodyLength,e&&(l.body=d,o(l,"Content-Type",`multipart/form-data;boundary=${n}`),a.searchParams.set("ump","1"))}}e||o(l,"Authorization",i)}return{url:a.href,request:l}}},73895:(e,t,r)=>{"use strict";function o(){return"undefined"!==typeof window&&!(!window.document||!window.document.createElement)}r.d(t,{S:()=>o})},74405:(e,t,r)=>{"use strict";r.d(t,{u:()=>n});const o=[{headerName:"sprequestguid",logName:"spRequestGuid"},{headerName:"request-id",logName:"requestId"},{headerName:"client-request-id",logName:"clientRequestId"},{headerName:"x-msedge-ref",logName:"xMsedgeRef"}];function n(e){const t={};return e?.headers&&o.forEach(r=>{const o=e.headers.get(r.headerName);o&&(t[r.logName]=o)}),t}},74411:(e,t,r)=>{"use strict";r.d(t,{o:()=>s,V:()=>a});var o=r(16135);const n={Automation:"https://res.cdn.office.net/fluid/prod",Development:"https://res-dev.cdn.officeppe.net/fluid/pr",DoD:"https://res-dod.cdn.office.net/fluid/dod",Dogfood:"https://res.cdn.office.net/fluid/df",GCC:"https://res.cdn.office.net/fluid/gcc","GCC-High":"https://res-gcch.cdn.office.net/fluid/gcch",Local:"https://res.cdn.office.net/fluid/prod",Microsoft:"https://res.cdn.office.net/fluid/prod",Preview:"https://res.cdn.office.net/fluid/prod",Production:"https://res.cdn.office.net/fluid/prod",Staging:"https://res-sdf.cdn.office.net/fluid/stg",SyntheticTraffic:"https://res.cdn.office.net/fluid/prod",USNat:"",USSec:"",Bleu:"",Delos:"",Gallatin:"https://res-cn.cdn.partner.office365.cn/fluid/gallatin"},i={Automation:"https://res-sdp.public.cdn.office.net/fluid/prod",Development:"https://res-sdp.sdf.cdn.office.net/fluid/stg",DoD:"https://res-sdp.dod.cdn.office.net/fluid/dod",Dogfood:"https://res-sdp.public.cdn.office.net/fluid/df",GCC:"https://res-sdp.gcc.cdn.office.net/fluid/gcc","GCC-High":"https://res-sdp.gcch.cdn.office.net/fluid/gcch",Local:"https://res-sdp.public.cdn.office.net/fluid/prod",Microsoft:"https://res-sdp.public.cdn.office.net/fluid/prod",Preview:"https://res-sdp.public.cdn.office.net/fluid/prod",Production:"https://res-sdp.public.cdn.office.net/fluid/prod",Staging:"https://res-sdp.sdf.cdn.office.net/fluid/stg",SyntheticTraffic:"https://res-sdp.public.cdn.office.net/fluid/prod",USNat:"",USSec:"",Bleu:"",Delos:"",Gallatin:""};function s(e){const t=(0,o.mo)(e??"Prod");return r=t.audience,n[r];var r}function a(e){const t=(0,o.mo)(e??"Prod");return r=t.audience,i[r];var r}},74621:(e,t,r)=>{"use strict";r.d(t,{iq:()=>y,i5:()=>b,AV:()=>c,oD:()=>h,aX:()=>g,vt:()=>f,dy:()=>d,qp:()=>v,cQ:()=>l,J4:()=>p});var o=r(45852);const n=e=>"function"===typeof e?.getTelemetryProperties&&"function"===typeof e?.addTelemetryProperties,i=e=>"string"===typeof e?.errorInstanceId;var s=r(50178);const a=e=>null!==e&&!Array.isArray(e)&&"object"===typeof e;function c(e,t){const r={message:"string"===typeof e?.message?e.message:String(e)};if(a(e)){const{errorType:o,stack:n,name:i}=e;if("string"===typeof o&&(r.errorType=o),"string"===typeof n){const e="string"===typeof i?i:void 0;r.stack=((e,r)=>{if(!t)return e;const o=e.split("\n");return o.shift(),void 0!==r&&o.unshift(r),o.join("\n")})(n,e)}}return r}const d=e=>"function"===typeof e?.getTelemetryProperties;function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(function(e){return"string"===typeof e?.errorType&&"string"===typeof e?.message&&i(e)&&n(e)}(e))return e.addTelemetryProperties(t.props??{}),e;const{message:r,stack:o}=c(e,!1),s=new S({message:r,stack:o});if("object"===typeof e&&null!==e){const t=e;let r;"canRetry"in e&&(r??={},r.canRetry=t.canRetry),"retryAfterSeconds"in e&&(r??={},r.retryAfterSeconds=t.retryAfterSeconds),void 0!==r&&Object.assign(s,r)}"object"!==typeof e&&s.addTelemetryProperties({typeofError:typeof e});const a=y.typeCheck(e)?e.getTelemetryProperties():{untrustedOrigin:1};return s.addTelemetryProperties({...a,...t.props}),s}let u;function h(e){const t=Error,r=t.stackTraceLimit;void 0!==e&&(t.stackTraceLimit=e);const o=new Error("<<generated stack>>");if(void 0===u&&(u=void 0!==o.stack),u)return t.stackTraceLimit=r,o;try{throw o}catch(n){return t.stackTraceLimit=r,n}}function g(e){return h(e).stack}function p(e,t){const{message:r,stack:o}=c(e,!1),n=t(r);return void 0!==o&&m(n,o),f(e)&&n.addTelemetryProperties({untrustedOrigin:1}),i(e)&&(n.overwriteErrorInstanceId(e.errorInstanceId),n.addTelemetryProperties({innerErrorInstanceId:e.errorInstanceId})),d(e)&&n.addTelemetryProperties(e.getTelemetryProperties()),n}function m(e,t){try{Object.assign(e,{stack:t})}catch{e.addTelemetryProperties({stack2:t})}}function f(e){if(y.typeCheck(e)){if(e.errorType===b){const t=e.getTelemetryProperties();return 1===t.untrustedOrigin||Boolean(t.errorRunningExternalCode)}return!1}return!0}function v(e){return"string"===typeof e?.tag}class y extends Error{get errorInstanceId(){return this._errorInstanceId}overwriteErrorInstanceId(e){this._errorInstanceId=e}constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;super(e),this.omitPropsFromLogging=r,this._errorInstanceId=(0,o.A)(),r.add("omitPropsFromLogging"),r.add("_errorInstanceId"),t&&this.addTelemetryProperties(t)}static typeCheck(e){return"object"===typeof e&&null!==e&&("function"===typeof e.addTelemetryProperties&&"function"===typeof e.getTelemetryProperties&&"string"===typeof e.errorInstanceId)}addTelemetryProperties(e){!function(e,t){for(const[r,o]of Object.entries(t))void 0===e[r]&&(e[r]=o)}(this,e)}getTelemetryProperties(){const e={};for(const t of Object.keys(this)){if(this.omitPropsFromLogging.has(t))continue;const r=this[t];e[t]=(0,s.fV)(r)}return{...e,stack:this.stack,message:this.message,errorInstanceId:this._errorInstanceId}}}const b="genericError";class S extends y{constructor(e){super(e.message),this.errorType=b,void 0!==e.stack&&m(this,e.stack)}}},75097:(e,t,r)=>{"use strict";r.d(t,{M:()=>u});var o,n=r(56851),i=r(50406),s=r(29900),a=r(90589),c=function(e){var t="Error",r=[];return r.push((0,a.m9)("".concat(t,".ErrorGroup"),e.errorGroup)),r.push((0,a.Ug)("".concat(t,".Tag"),e.tag)),void 0!==e.code&&r.push((0,a.Ug)("".concat(t,".Code"),e.code)),void 0!==e.id&&r.push((0,a.Ug)("".concat(t,".Id"),e.id)),void 0!==e.count&&r.push((0,a.Ug)("".concat(t,".Count"),e.count)),r},d=r(82770),l=function(){function e(e){this.value=e,this.nextChild=0}return e.prototype.getNext=function(){return new e("".concat(this.value,".").concat(++this.nextChild))},e}();var u=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this;return i.baseCv=function(){if(!o){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=[],r=0;r<22;r++)t.push(e.charAt(Math.floor(64*Math.random())));o=new l(t.join(""))}return o}(),i}return(0,n.__extends)(t,e),t.prototype.createActivity=function(e){return(0,s.E)({sendTelemetryEvent:this.sendTelemetryEvent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t.prototype.sendActivity=function(e,t,r,o){return this.sendTelemetryEvent({eventName:e,eventContract:{name:d.Il.contractName,dataFields:d.Il.getFields(t)},dataFields:r,eventFlags:o})},t.prototype.sendError=function(e){var t=c(e.error);return null!=e.dataFields&&t.push.apply(t,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:t,eventFlags:e.eventFlags})},t.prototype.createCustomerContentActivity=function(e){return(0,s.E)({sendTelemetryEvent:this.sendCustomerContent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t}(i.GV)},75335:(e,t,r)=>{"use strict";r.d(t,{WN:()=>u,xl:()=>l,yb:()=>d});const o=new Map;let n=!1,i=0;function s(){if(document.hidden){const e=Date.now();o.forEach((t,r)=>{-1===t&&o.set(r,e)}),a()}}function a(){n=!1,document.removeEventListener("visibilitychange",s)}function c(e){document.hidden?o.set(e,0):(n||(n=!0,document.addEventListener("visibilitychange",s)),o.set(e,-1))}function d(){return i+=1,c(i),i}function l(e,t){const r=o.get(e);return t&&u(e),r}function u(e){o.delete(e),0===o.size&&n&&a()}},75368:(e,t,r)=>{"use strict";r.d(t,{$3:()=>y,A8:()=>k,Ft:()=>D,GO:()=>l,HA:()=>o,HY:()=>I,Jv:()=>N,KS:()=>n,MK:()=>B,PC:()=>L,Ph:()=>s,Py:()=>w,RG:()=>c,Tl:()=>b,UJ:()=>d,Xc:()=>u,Z6:()=>E,_w:()=>F,bG:()=>S,bh:()=>f,fM:()=>m,hL:()=>P,i5:()=>a,j4:()=>i,k4:()=>v,kW:()=>g,kx:()=>h,rf:()=>C,v3:()=>p,xH:()=>T});const o="Card",n="Code",i="Copilot",s="Date",a="Image",c="List",d="Person",l="RichText",u="Tabular",h="Task",g="URL",p="application/vnd.microsoft.card.adaptive",m="application/vnd.microsoft.card.hero",f="application/vnd.microsoft.card.thumbnail",v="application/vnd.microsoft.teams.card.o365connector",y="SignInCard",b="JITInstallCard",S="ErrorCard",C="Label",k="Quote",w="Callout",P="application/vnd.microsoft.activity.loginRequest",T="TokenProvider",E="SettingsProvider",N="CardChannelProvider",I="MetaOSProvider",D="UrlHandlerProvider",F="LinkService",B="OfficePolicyProvider",L="FileMetaTagProvider"},75460:(e,t,r)=>{"use strict";r.d(t,{c:()=>o});class o{constructor(){this[Symbol.toStringTag]="Deferred",this.isPending=!0,this.p=new Promise((e,t)=>{this.res=e,this.rej=t})}then(e,t){return this.p.then(e,t)}catch(e){return this.p.catch(e)}resolve(e){this.isPending=!1,this.res(e)}reject(e){this.isPending=!1,this.rej(e)}pending(){return this.isPending}finally(e){return this.p.finally(e)}}},75812:(e,t,r)=>{"use strict";r.d(t,{R:()=>i});var o=r(93537),n=r(95996);function i(e,t,r,n,i,a){let c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,d=arguments.length>7?arguments[7]:void 0;return(0,o.J5)(e,t,a,c).then(async e=>n&&r?((!i&&e.result.ok||!e.result.ok)&&await s(r,!0,e.result,e.tries.length+1,n,d),await Promise.all(e.tries.map(async(e,t)=>await s(r,!1,e,t+1,n,d))),e):e)}async function s(e,t,r,o,i,s){const a=s&&await s(r,t).catch(()=>({getAdditionalPropsError:!0}));(0,n.Ot)(i,{subCategory:"Request",eventName:e,isFinalAttempt:t,status:r.status,durationMs:r.durationMs,size:r.headers?.get("Content-Length")||-1,attempt:o,...a})}},75964:(e,t,r)=>{"use strict";r.d(t,{X:()=>n});var o=r(95996);function n(e,t,r){try{return JSON.parse(e,t)}catch(n){return void(r&&(0,o.hO)(r.logger,r.event,n))}}},76522:(e,t,r)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let o=0,n=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(o++,"%c"===e&&(n=o))}),t.splice(n,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(r){}},t.load=function(){let e;try{e=t.storage.getItem("debug")||t.storage.getItem("DEBUG")}catch(r){}!e&&"undefined"!==typeof process&&"env"in process&&(e={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.DEBUG);return e},t.useColors=function(){if("undefined"!==typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let e;return"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&(e=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(e[1],10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(35237)(t);const{formatters:o}=e.exports;o.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}},77432:(e,t,r)=>{"use strict";r.d(t,{F:()=>y});const o="https://hubblecontent.osi.office.net/contentsvc/",n="https://cdn.hubblecontent.osi.office.net/",i={aadAuthority:"https://login.microsoftonline.us",loki:"https://dod.loki.office365.us",graph:"https://dod-graph.microsoft.us",substrate:"https://substrate-dod.office365.us",outlook:"https://outlook-dod.office365.us",augloop:"https://augloop.dod.online.office365.us",augloopOld:"https://augloop.dod.online.office365.us",ocps:"https://clients.config.dod.office365.us",fs:"https://fs.microsoft.com",editor:"nleditor.osi.apps.mil",editorSynonyms:"editor-pathfinder-thesaurus.usgovtrafficmanager.net:9443",mru:"https://ocws.osi.apps.mil/ocs",ecs:"https://config.ecs.dod.teams.microsoft.us",project:"https://project.apps.mil/",teamsTasks:"",plannerOld:"https://tasks.osi.apps.mil",plannerNew:"",centro:"",iris:"",teams:"https://dod.teams.microsoft.us",teamsWebTasks:"",hubbleService:o,hubbleStorage:n,toDo:"",roaming:"https://roaming.osi.apps.mil",roamingToken:"https://api.osi.apps.mil",mruToken:"https://api.osi.apps.mil"},s={aadAuthority:"https://login.microsoftonline.us",loki:"https://gcchigh.loki.office365.us",graph:"https://graph.microsoft.us",substrate:"https://substrate.office365.us",outlook:"https://outlook.office365.us",augloop:"https://augloop.gov.online.office365.us",augloopOld:"https://augloop.gov.online.office365.us",ocps:"https://clients.config.high.office365.us",fs:"https://fs.microsoft.com",editor:"nleditor.osi.office365.us",editorSynonyms:"editor-trailblazer-thesaurus.usgovtrafficmanager.net:9443",mru:"https://ocws.osi.office365.us/ocs",ecs:"https://config.ecs.gov.teams.microsoft.us",project:"https://project.office365.us",plannerOld:"https://tasks.office365.us",plannerNew:"",teamsTasks:"",centro:"",iris:"",teams:"https://gov.teams.microsoft.us",teamsWebTasks:"",hubbleService:o,hubbleStorage:n,toDo:"",roaming:"https://roaming.osi.office365.us",roamingToken:"https://api.osi.office365.us",mruToken:"https://api.osi.office365.us"},a={aadAuthority:"https://login.microsoftonline.com",loki:"https://loki.delve.office.com",graph:"https://graph.microsoft.com",substrate:"https://substrate.office.com",outlook:"https://outlook.office.com",augloop:"https://gcc.augloop.svc.cloud.microsoft",augloopOld:"https://augloop-gcc.office.com",ocps:"https://clients.config.gcc.office.net",fs:"https://fs.microsoft.com",editor:"nleditor.gcc.osi.office365.us",editorSynonyms:"editor-gccm-thesaurus.usgovtrafficmanager.net:9443",mru:"https://ocws.officeapps.live.com/ocs",ecs:"https://ecs.office.com",project:"https://gcc.project.microsoft.com",teamsTasks:"https://tasks.gcc.teams.microsoft.com",plannerOld:"https://tasks.office.com",plannerNew:"",centro:"",iris:"",teams:"https://teams.microsoft.com",teamsWebTasks:"",hubbleService:o,hubbleStorage:n,toDo:"https://to-do.office.com",roaming:"https://roaming.officeapps.live.com",roamingToken:"https://api.office.net",mruToken:"https://api.office.net"},c={aadAuthority:"https://login.microsoftonline.us",loki:"",graph:"",substrate:"",outlook:"",augloop:"",augloopOld:"",ocps:"",fs:"",editor:"",editorSynonyms:"",mru:"",ecs:"https://config.ecs.teams.eaglex.ic.gov",project:"",teamsTasks:"",plannerOld:"",plannerNew:"",centro:"",iris:"",hubbleService:"",hubbleStorage:"",teams:"",teamsWebTasks:"",toDo:"",roaming:"https://roaming.osi.eaglex.ic.gov",roamingToken:"https://officeapps.live.com",mruToken:"https://officeapps.live.com"},d={aadAuthority:"https://login.microsoftonline.us",loki:"",graph:"",substrate:"",outlook:"",augloop:"",augloopOld:"",ocps:"",fs:"",editor:"",editorSynonyms:"",mru:"",ecs:"https://config.ecs.teams.microsoft.scloud",project:"",teamsTasks:"",plannerOld:"",plannerNew:"",centro:"",iris:"",hubbleService:"",hubbleStorage:"",teams:"",teamsWebTasks:"",toDo:"",roaming:"https://roaming.osi.microsoft.scloud",roamingToken:"https://officeapps.live.com",mruToken:"https://officeapps.live.com"},l={aadAuthority:"https://login.microsoftonline.com",augloop:"https://dogfood.augloop.svc.cloud.microsoft",augloopOld:"https://augloop-dogfood.officeppe.com",centro:"https://admin-ignite.microsoft.com",ecs:"https://ecs.office.com",editor:"nleditor.osi.office.net",editorSynonyms:"editor-prod-thesaurus.trafficmanager.net:9443",fs:"https://fs.microsoft.com",graph:"https://graph.microsoft.com",iris:"https://arc.msn.com",loki:"https://loki.delve.office.com",mru:"https://ocws-df.officeapps.live.com/ocs",ocps:"https://sip.clients.config.office.net",outlook:"https://outlook.office.com",plannerNew:"https://planner.cloud.microsoft",plannerOld:"https://tasks.office.com",project:"https://project.microsoft.com",substrate:"https://substrate.office.com",teamsTasks:"https://retailservices.teams.microsoft.com",teams:"https://teams.microsoft.com",teamsWebTasks:"https://tasks.teams.microsoft.com",hubbleService:o,hubbleStorage:n,toDo:"https://to-do.office.com",roaming:"https://roaming.officeapps.live.com",roamingToken:"https://api.office.net",mruToken:"https://api.office.net"},u={aadAuthority:"https://login.microsoftonline.com",augloop:"https://dogfood.augloop.svc.cloud.microsoft",augloopOld:"https://augloop-dogfood.officeppe.com",centro:"https://admin-ignite.microsoft.com",ecs:"https://ecs.office.com",editor:"nleditor.osi.officeppe.net",editorSynonyms:"editor-edog-thesaurus.trafficmanager.net:9443",fs:"https://fs.microsoft.com",graph:"https://graph.microsoft.com",iris:"https://arc.msn.com",loki:"https://loki.delve.office.com",mru:"https://ocws-df.officeapps.live.com/ocs",ocps:"https://clients.config.office.net",outlook:"https://outlook.office.com",plannerNew:"https://planner.cloud.microsoft",plannerOld:"https://tasks.office.com",project:"https://project.microsoft.com",substrate:"https://substrate.office.com",teamsTasks:"https://retailservices.teams.microsoft.com",teams:"https://teams.microsoft.com",teamsWebTasks:"",hubbleService:o,hubbleStorage:n,toDo:"https://to-do.office.com",roaming:"https://roaming.officeapps.live.com",roamingToken:"https://api.office.net",mruToken:"https://api.office.net"},h={aadAuthority:"https://login.microsoftonline.com",augloop:"https://dogfood.augloop.svc.cloud.microsoft",augloopOld:"https://augloop-dogfood.officeppe.com",centro:"https://admin-ignite.microsoft.com",ecs:"https://ecs.office.com",editor:"nleditor.osi.officeppe.net",editorSynonyms:"editor-edog-thesaurus.trafficmanager.net:9443",fs:"https://fs.microsoft.com",graph:"https://graph.microsoft.com",iris:"https://arc.msn.com",loki:"https://loki.delve.office.com",mru:"https://ocws-df.officeapps.live.com/ocs",ocps:"https://clients.config.office.net",outlook:"https://outlook.office.com",plannerNew:"https://planner.cloud.microsoft",plannerOld:"https://tasks.office.com",project:"https://project.microsoft.com",substrate:"https://substrate.office.com",teamsTasks:"https://retailservices.teams.microsoft.com",teams:"https://teams.microsoft.com",teamsWebTasks:"https://tasks.teams.microsoft.com",hubbleService:o,hubbleStorage:n,toDo:"https://to-do.office.com",roaming:"https://roaming.officeapps.live.com",roamingToken:"https://api.office.net",mruToken:"https://api.office.net"},g={aadAuthority:"https://login.microsoftonline.com",augloop:"https://dogfood.augloop.svc.cloud.microsoft",augloopOld:"https://augloop-dogfood.officeppe.com",centro:"https://admin-ignite.microsoft.com",ecs:"https://ecs.office.com",editor:"nleditor.osi.officeppe.net",editorSynonyms:"editor-edog-thesaurus.trafficmanager.net:9443",fs:"https://fs.microsoft.com",graph:"https://graph.microsoft.com",iris:"https://arc.msn.com",loki:"https://loki.delve.office.com",mru:"https://ocws-df.officeapps.live.com/ocs",ocps:"https://clients.config.office.net",outlook:"https://outlook.office.com",plannerNew:"https://planner.cloud.microsoft",plannerOld:"https://tasks.office.com",project:"https://project.microsoft.com",substrate:"https://substrate.office.com",teamsTasks:"https://retailservices.teams.microsoft.com",teams:"https://teams.microsoft.com",teamsWebTasks:"https://tasks.teams.microsoft.com",hubbleService:o,hubbleStorage:n,toDo:"https://to-do.office.com",roaming:"https://roaming.officeapps.live.com",roamingToken:"https://api.office.net",mruToken:"https://api.office.net"},p={aadAuthority:"https://login.microsoftonline.com",augloop:"https://dogfood.augloop.svc.cloud.microsoft",augloopOld:"https://augloop-dogfood.officeppe.com",centro:"https://admin-ignite.microsoft.com",ecs:"https://ecs.office.com",editor:"nleditor.osi.officeppe.net",editorSynonyms:"editor-edog-thesaurus.trafficmanager.net:9443",fs:"https://fs.microsoft.com",graph:"https://graph.microsoft.com",iris:"https://arc.msn.com",loki:"https://loki.delve.office.com",mru:"https://ocws-df.officeapps.live.com/ocs",ocps:"https://clients.config.office.net",outlook:"https://outlook.office.com",plannerNew:"https://planner.cloud.microsoft",plannerOld:"https://tasks.office.com",project:"https://project.microsoft.com",substrate:"https://substrate.office.com",teamsTasks:"https://retailservices.teams.microsoft.com",teams:"https://teams.microsoft.com",teamsWebTasks:"https://tasks.teams.microsoft.com",hubbleService:o,hubbleStorage:n,toDo:"https://to-do.office.com",roaming:"https://roaming-df.officeapps.live.com",roamingToken:"https://api.office.net",mruToken:"https://api.office.net"},m={aadAuthority:"https://login.microsoftonline.com",augloop:"https://augloop.svc.cloud.microsoft",augloopOld:"https://augloop.office.com",centro:"https://admin-ignite.microsoft.com",ecs:"https://ecs.office.com",editor:"nleditor.osi.office.net",editorSynonyms:"editor-prod-thesaurus.trafficmanager.net:9443",fs:"https://fs.microsoft.com",graph:"https://graph.microsoft.com",iris:"https://arc.msn.com",loki:"https://loki.delve.office.com",mru:"https://ocws.officeapps.live.com/ocs",ocps:"https://clients.config.office.net",outlook:"https://outlook.office.com",plannerNew:"https://planner.cloud.microsoft",plannerOld:"https://tasks.office.com",project:"https://project.microsoft.com",substrate:"https://substrate.office.com",teamsTasks:"https://retailservices.teams.microsoft.com",teams:"https://teams.microsoft.com",teamsWebTasks:"https://tasks.teams.microsoft.com",hubbleService:o,hubbleStorage:n,toDo:"https://to-do.office.com",roaming:"https://roaming.officeapps.live.com",roamingToken:"https://api.office.net",mruToken:"https://api.office.net"},f={aadAuthority:"https://login.microsoftonline.com",augloop:"https://augloop.svc.cloud.microsoft",augloopOld:"https://augloop.office.com",centro:"https://admin-ignite.microsoft.com",ecs:"https://ecs.office.com",editor:"nleditor.osi.office.net",editorSynonyms:"editor-prod-thesaurus.trafficmanager.net:9443",fs:"https://fs.microsoft.com",graph:"https://graph.microsoft.com",iris:"https://arc.msn.com",loki:"https://loki.delve.office.com",mru:"https://ocws.officeapps.live.com/ocs",ocps:"https://clients.config.office.net",outlook:"https://outlook.office.com",plannerNew:"https://planner.cloud.microsoft",plannerOld:"https://tasks.office.com",project:"https://project.microsoft.com",substrate:"https://substrate.office.com",teamsTasks:"https://retailservices.teams.microsoft.com",teams:"https://teams.microsoft.com",teamsWebTasks:"https://tasks.teams.microsoft.com",hubbleService:o,hubbleStorage:n,toDo:"https://to-do.office.com",roaming:"https://roaming.officeapps.live.com",roamingToken:"https://api.office.net",mruToken:"https://api.office.net"},v={aadAuthority:"https://login.chinacloudapi.cn",loki:"https://loki.office365.cn",graph:"https://microsoftgraph.chinacloudapi.cn",substrate:"https://substrate.partner.outlook.cn",outlook:"https://outlook.partner.outlook.cn",augloop:"https://augloop.microsoftonline.cn",augloopOld:"https://augloop.microsoftonline.cn",ocps:"",fs:"https://fs.microsoft.com",editor:"",editorSynonyms:"",mru:"https://ocws.officeapps.partner.office365.cn/ocs",ecs:"https://mooncake.ecs.office.com",project:"",teamsTasks:"",plannerOld:"",plannerNew:"",centro:"",iris:"",hubbleService:"",hubbleStorage:"",teams:"",teamsWebTasks:"",toDo:"",roaming:"https://roaming.officeapps.partner.office365.cn",roamingToken:"https://api.partner.office365.cn",mruToken:"https://api.partner.office365.cn"};function y(e,t){switch(t){case"Local":return l[e];case"Automation":return u[e];case"Development":return h[e];case"Staging":return g[e];case"SyntheticTraffic":case"Dogfood":return p[e];case"Microsoft":return f[e];case"Preview":case"Production":return m[e];case"GCC":return a[e];case"GCC-High":return s[e];case"DoD":return i[e];case"USNat":return c[e];case"USSec":return d[e];case"Gallatin":return v[e];case"Bleu":case"Delos":throw new Error(`Unsupported audience: ${t}`)}}},77565:(e,t,r)=>{"use strict";function o(e){throw new Error(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Unreachable Case")}r.d(t,{$:()=>o})},78632:(e,t,r)=>{"use strict";function o(e,t){return new Promise(r=>{const o=setTimeout(()=>r(),e);t?.addEventListener("abort",()=>{clearTimeout(o),r()})})}function n(e,t){const r=o(e).then(e=>!0),n=t.map(e=>e.then(e=>!1).catch(e=>!1));return Promise.race([r,...n])}r.d(t,{c:()=>o,t:()=>n})},78796:(e,t,r)=>{"use strict";r.d(t,{W:()=>n,i:()=>o});const o="https://my.microsoftpersonalcontent.com",n="https://1drv.ms"},78945:(e,t,r)=>{"use strict";r.d(t,{I:()=>n,d:()=>o});class o{constructor(e){this.valueGenerator=e,this._evaluated=!1}get evaluated(){return this._evaluated}get value(){return this._evaluated||(this._evaluated=!0,this._value=this.valueGenerator()),this._value}}class n{get[Symbol.toStringTag](){return"[object LazyPromise]"}constructor(e){this.execute=e}async then(e,t){return this.getPromise().then(...arguments)}async catch(e){return this.getPromise().catch(...arguments)}async finally(e){return this.getPromise().finally(...arguments)}async getPromise(){return void 0===this.result&&(this.result=this.execute()),this.result}}},81793:(e,t,r)=>{"use strict";r.d(t,{N2:()=>i});var o=r(41395),n=r(37513);function i(e){if("object"===typeof e){const t=e;if(function(e){return e.errorType===o.E.outOfStorageError}(t))return o.E.outOfStorageError;if(function(e){return e.errorType===o.E.invalidFileNameError}(t))return o.E.invalidFileNameError;if(function(e){return e.errorType===o.E.snapshotTooBig}(t))return o.E.snapshotTooBig;if(function(e){return e.errorType===o.E.fetchTimeout}(t))return o.E.fetchTimeout;if(function(e){return e.errorType===o.E.fluidNotEnabled}(t))return o.E.fluidNotEnabled;if(function(e){return e.errorType===n.a.fileOverwrittenInStorage}(t))return n.a.fileOverwrittenInStorage}}},81918:(e,t,r)=>{"use strict";async function o(){return Promise.all([r.e(97950),r.e(57833),r.e(50924)]).then(r.bind(r,60724))}async function n(){return Promise.all([r.e(5899),r.e(2440)]).then(r.bind(r,36713))}async function i(){return Promise.all([r.e(97950),r.e(63843),r.e(26922),r.e(95753),r.e(15319),r.e(89919),r.e(19779)]).then(r.bind(r,98123))}r.d(t,{Al:()=>n,Cw:()=>o,vJ:()=>i})},82645:(e,t,r)=>{"use strict";r.d(t,{u:()=>i});var o=r(75097),n=r(60119);const i=function(){const e=new o.M;return e.addSink(n.a),e.setTenantToken("Office.Extensibility","db334b301e7b474db5e0f02f07c51a47-a1b5bc36-1bbe-482f-a64a-c2d9cb606706-7439",1755),e}()},82770:(e,t,r)=>{"use strict";r.d(t,{EW:()=>p,Il:()=>l,KJ:()=>u,Kz:()=>C,Nn:()=>f,OD:()=>c,ay:()=>g,qw:()=>m,rh:()=>h});var o=r(90589);function n(e,t){return e?e+"."+t:t}function i(e,t,r,i,s){void 0===s&&(s=4),i&&e.push((0,o.m9)("".concat(n(t,r)),i,s))}function s(e,t,r,i){"boolean"===typeof i&&e.push((0,o.LK)("".concat(n(t,r)),i))}function a(e,t,r,i){if("number"===typeof i){var s=Math.round(i);e.push((0,o.Ug)("".concat(n(t,r)),s))}}var c,d=function(e){var t="Activity.Result",r=[];return a(r,t,"Code",e.code),i(r,t,"Type",e.type),a(r,t,"Tag",e.tag),s(r,t,"IsExpected",e.isExpected),r.push((0,o.m9)("zC.Activity.Result","Office.System.Result")),r},l={contractName:"Office.System.Activity",getFields:function(e){var t="Activity",r=[];return i(r,t,"CV",e.cV),a(r,t,"Duration",e.duration),a(r,t,"Count",e.count),a(r,t,"AggMode",e.aggMode),s(r,t,"Success",e.success),e.result&&r.push.apply(r,d(e.result)),r.push((0,o.m9)("zC.Activity",this.contractName)),r}},u={getFields:function(e){var t="User",r=[];return i(r,t,"PrimaryIdentityHash",e.primaryIdentityHash),i(r,t,"PrimaryIdentitySpace",e.primaryIdentitySpace),i(r,t,"TenantId",e.tenantId,1),i(r,t,"TenantGroup",e.tenantGroup,1),s(r,t,"IsAnonymous",e.isAnonymous),s(r,t,"IsSignedIn",e.isSignedIn),i(r,t,"TelemetryRegion",e.telemetryRegion),r}},h={getFields:function(e,t){var r=[];return i(r,e,"Name",t.name),i(r,e,"State",t.state),r}},g={getFields:function(e){var t="UserAction",r=[];return a(r,t,"Id",e.id),i(r,t,"Name",e.name),i(r,t,"CommandSurface",e.commandSurface),i(r,t,"ParentName",e.parentName),i(r,t,"TriggerMethod",e.triggerMethod),a(r,t,"TimeOffsetMs",e.timeOffsetMs),r}};!function(e){e.Web="Web",e.Desktop="Desktop",e.Universal="Universal",e.Mobile="Mobile",e.Win32="Win32",e.Mac="Mac",e.iOS="iOS",e.Android="Android"}(c||(c={}));var p,m={getFields:function(e){var t="App",r=[];return i(r,t,"Name",e.name,1),i(r,t,"Platform",e.platform,1),i(r,t,"Version",e.version,1),r}},f={getFields:function(e){var t="Session",r=[];return i(r,t,"Id",e.id,1),i(r,t,"EcsETag",e.ecsETag,1),r}};!function(e){e.Automation="Automation",e.Dogfood="Dogfood",e.Microsoft="Microsoft",e.Insiders="Insiders",e.Production="Production"}(p||(p={}));var v,y,b,S,C={getFields:function(e){var t=[];return i(t,"Release","AudienceGroup",e.audienceGroup,1),t}};!function(e){var t="Copilot";!function(e){e.IsEnabled="IsEnabled",e.IsSeen="IsSeen",e.IsTried="IsTried",e.IsKept="IsKept",e.IsRejected="IsRejected",e.IsAutonomousRun="IsAutonomousRun"}(e.FeatureActionType||(e.FeatureActionType={})),function(e){e.ContentGeneration="Content Generation",e.Commanding="Commanding",e.QAandSummaries="QA and Summaries",e.Collaboration="Collaboration",e.Suggestions="Suggestions"}(e.Capability||(e.Capability={})),function(e){e.BizChat="BizChat",e.Chat="Chat",e.Canvas="Canvas",e.SuggestionsPane="Suggestions Pane",e.Backstage="Backstage"}(e.EntryPoint||(e.EntryPoint={})),function(e){e.Create="Create",e.Command="Command",e.Ask="Ask",e.Summarize="Summarize",e.Share="Share",e.Analyze="Analyze"}(e.Verb||(e.Verb={})),function(e){e.Ribbon="Ribbon",e.Skittle="Skittle",e.Handoffs="Handoffs",e.TopOfDoc="TopOfDoc",e.ContextMenu="ContextMenu",e.FirstRunExperience="FirstRunExperience",e.Nudges="Nudges",e.AIRibbon="AIRibbon",e.CopilotLab="CopilotLab",e.Formula="Formula"}(e.ActionOrigin||(e.ActionOrigin={})),function(e){e.Reactive="Reactive",e.Proactive="Proactive",e.Autonomous="Autonomous"}(e.FeatureClass||(e.FeatureClass={})),e.getFields=function(e){var r=[];return i(r,t,"FeatureActionType",e.featureActionType),s(r,t,"IsUserInitiated",e.isUserInitiated),i(r,t,"FeatureName",e.featureName),i(r,t,"SubFeatureName",e.subFeatureName),i(r,t,"Capability",e.capability),s(r,t,"IsThumbsUp",e.isThumbsUp),i(r,t,"EntryPoint",e.entryPoint),i(r,t,"Verb",e.verb),i(r,t,"InteractionId",e.interactionId),i(r,t,"ConversationId",e.conversationId),i(r,t,"ActionOrigin",e.actionOrigin),i(r,t,"FeatureClass",e.featureClass),r.push((0,o.m9)("zC.".concat(t),"Office.System.Copilot")),r}}(v||(v={})),function(e){var t="Asha";!function(e){e.Pillar="Pillar",e.Error="Error"}(e.EventType||(e.EventType={})),e.getFields=function(e){var r=[];return i(r,t,"EventType",e.eventType),i(r,t,"Pillar",e.pillar),i(r,t,"Scenario",e.scenario),i(r,t,"Veto",e.veto),i(r,t,"Error",e.error),s(r,t,"InStaging",e.inStaging),s(r,t,"IsSessionEndingError",e.isSessionEndingError),s(r,t,"IsIntentional",e.isIntentional),s(r,t,"IsInternal",e.isInternal),r.push((0,o.m9)("zC.".concat(t),"Office.System.Asha")),r}}(y||(y={})),function(e){e.getFields=function(e,t){var r=[];return void 0!==t.name&&r.push((0,o.m9)("".concat(e,".Name"),t.name)),void 0!==t.platform&&r.push((0,o.m9)("".concat(e,".Platform"),t.platform)),void 0!==t.version&&r.push((0,o.m9)("".concat(e,".Version"),t.version)),void 0!==t.sessionId&&r.push((0,o.m9)("".concat(e,".SessionId"),t.sessionId)),void 0!==t.immediateHost&&r.push((0,o.m9)("".concat(e,".ImmediateHost"),t.immediateHost)),void 0!==t.subModuleName&&r.push((0,o.m9)("".concat(e,".SubModuleName"),t.subModuleName)),void 0!==t.context&&r.push((0,o.m9)("".concat(e,".Context"),t.context)),void 0!==t.referrer&&r.push((0,o.m9)("".concat(e,".Referrer"),t.referrer)),r}}(b||(b={})),function(e){var t="ContentIdentifier";e.getFields=function(e){var r=[];return r.push((0,o.m9)("".concat(t,".ContentType"),e.contentType)),r.push((0,o.m9)("".concat(t,".ContentId"),e.contentId)),void 0!==e.subContentType&&r.push((0,o.m9)("".concat(t,".SubContentType"),e.subContentType)),void 0!==e.subContentId&&r.push((0,o.m9)("".concat(t,".SubContentId"),e.subContentId)),r.push((0,o.m9)("zC.".concat(t),"Office.System.ContentIdentifier")),r}}(S||(S={}))},82963:(e,t,r)=>{"use strict";r.d(t,{c:()=>b,M:()=>y});var o=r(95996);const n=["https://cdn.dev.fluidpreview.office.net","https://cdn.fluidpreview.office.net","https://res-sdf.cdn.office.net","https://res.cdn.office.net","https://res-dev.cdn.officeppe.net","https://dev.loop.microsoft.com","https://df.loop.microsoft.com","https://preview.loop.microsoft.com","https://loop.microsoft.com","https://dev.ch5.fluidpreview.office.net","https://ch5.fluidpreview.office.net","https://dev.whiteboard.microsoft.com","https://app.int.whiteboard.microsoft.com","https://app.whiteboard.microsoft.com","https://whiteboard.cloud.microsoft","https://whiteboard.cloud.dev.microsoft","https://whiteboard.microsoft.com","https://whiteboard.office.com","https://loop.cloud.microsoft","https://loop.cloud-dev.microsoft","https://hosted.loop.cloud.dev.microsoft","https://hosted.loop.cloud.microsoft"],i=["https://res-gcch.cdn.office.net","https://whiteboard.office365.us"],s=["https://res-dod.cdn.office.net","https://whiteboard.apps.mil"],a=["https://res-cn.cdn.partner.office365.cn"],c=["https://whiteboard.eaglex.ic.gov"],d=["https://whiteboard.microsoft.scloud"],l=[...n,...i,...s,...c,...d,...a],u=[{origin:["https://cdn.dev.fluidpreview.office.net","https://cdn.fluidpreview.office.net","https://res-sdf.cdn.office.net","https://res.cdn.office.net","https://res-dev.cdn.officeppe.net","https://dev.loop.microsoft.com","https://df.loop.microsoft.com","https://preview.loop.microsoft.com","https://loop.microsoft.com","https://dev.ch5.fluidpreview.office.net","https://ch5.fluidpreview.office.net","https://loop.cloud.microsoft","https://loop.cloud-dev.microsoft","https://hosted.loop.cloud.dev.microsoft","https://hosted.loop.cloud.microsoft"],paths:["fluid/dev","fluid/df","fluid/stg","fluid/prod","fluid/pr","fluid/gcc","fluid/gcch","fluid/dod","fluid/local-redirect-container"]},{origin:["https://dev.whiteboard.microsoft.com","https://app.int.whiteboard.microsoft.com","https://app.whiteboard.microsoft.com","https://whiteboard.cloud.microsoft","https://whiteboard.cloud.dev.microsoft","https://whiteboard.microsoft.com","https://whiteboard.office.com"],paths:void 0}],h=[{origin:["https://res-gcch.cdn.office.net"],paths:["fluid/gcch"]},{origin:["https://whiteboard.office365.us"],paths:void 0}],g=[{origin:["https://res-dod.cdn.office.net"],paths:["fluid/dod"]},{origin:["https://whiteboard.apps.mil"],paths:void 0}],p=[{origin:["https://res-cn.cdn.partner.office365.cn"],paths:["fluid/gallatin"]}],m=[{origin:["https://whiteboard.eaglex.ic.gov"],paths:void 0}],f=[{origin:["https://whiteboard.microsoft.scloud"],paths:void 0}],v=[...u,...h,...g,...m,...f,...p],y=(e,t)=>{if(!(t?.getSetting("bohemiaCodeLoader.environmentSpecificCDNs",!0)??1))return v;switch(e){case"GccHigh":return h;case"DoD":return g;case"USNat":return m;case"USSec":return f;case"Gallatin":return p;default:return u}},b=(e,t,r)=>{if(t?.getSetting("bohemiaCodeLoader.environmentSpecificCDNs",!0)??1){let t;switch(e){case"DoD":t=s;break;case"GccHigh":t=i;break;case"USNat":t=c;break;case"USSec":t=d;break;case"Gallatin":t=a;break;default:t=n}return r&&((0,o.Ot)(r,{eventName:"DefaultAllowedCodeOrigins",environment:e}),0===t.length&&(0,o.hO)(r,{eventName:"DefaultAllowedCodeOriginsEmptyEnvironment"},"{message: ${deploymentRing} environment does not have any default code origins}")),t}return l}},83125:(e,t,r)=>{"use strict";r.d(t,{p:()=>o});class o{get NamespaceLogger(){return this}get PersistedProperties(){return this}get Disposable(){return this}dispose(){this.logger=null}constructor(e,t,r){if(this.namespace=e,t instanceof o){const e={...t.getPersistedProperties(),...r};this.logger=t.logger,this.persistedProperties=e}else this.logger=t,this.persistedProperties=r;this.baseLogger=t}addPersistedProperties(e){this.persistedProperties={...this.getPersistedProperties(),...e}}getPersistedProperties(){return{...this.baseLogger.PersistedProperties?.getPersistedProperties?.(),...this.persistedProperties}}send(e){this.sendWithNamespace(e,this.namespace)}sendWithNamespace(e,t){this.logger?.sendWithNamespace({...this.persistedProperties,...e},t)}getNamespace(){return this.namespace}}},83397:(e,t,r)=>{"use strict";r.d(t,{N:()=>i});var o=r(95996);const n=["mousemove","keydown","wheel","DOMMouseScroll","mouseWheel","mousedown","touchstart","touchmove","MSPointerDown","MSPointerMove","visibilitychange"];class i{constructor(e,t,r){this.timeoutMs=e,this.onUserActivityStateChange=t,this.logger=r,this.isActive=!0,this.userActivityCallback=()=>{this.onUserActivityDetected()},n.forEach(e=>{document.addEventListener(e,this.userActivityCallback,{passive:!0,capture:!1})}),this.startUserInactiveTimer()}get isUserActive(){return this.isActive}dispose(){this.isActive=!0,clearTimeout(this.userInactiveTimerId),n.forEach(e=>{document.removeEventListener(e,this.userActivityCallback,{capture:!1})})}onUserActivityDetected(){this.isActive||(this.isActive=!0,this.onUserActivityStateChange(!0),this.logger&&(0,o.Ot)(this.logger,{eventName:"UserActive"})),this.resetUserInactiveTimer()}resetUserInactiveTimer(){clearTimeout(this.userInactiveTimerId),this.startUserInactiveTimer()}startUserInactiveTimer(){this.userInactiveTimerId=setTimeout(()=>{this.isActive=!1,this.onUserActivityStateChange(!1),this.logger&&(0,o.Ot)(this.logger,{eventName:"UserInactive"})},this.timeoutMs)}}},83533:(e,t,r)=>{"use strict";r.d(t,{X:()=>i,f:()=>n});const o=e=>"function"===typeof e?.getTelemetryProperties&&"function"===typeof e?.addTelemetryProperties,n=e=>"string"===typeof e?.errorInstanceId;function i(e){return"string"===typeof e?.errorType&&"string"===typeof e?.message&&n(e)&&o(e)}},83736:(e,t,r)=>{"use strict";r.d(t,{b:()=>d});var o=r(45799),n=r(31482),i=r(91608),s=r(96826);const a={10:"#050106",20:"#211029",30:"#37154A",40:"#4A1866",50:"#5E1984",60:"#7219A2",70:"#802CB0",80:"#8D40B7",90:"#9853BE",100:"#A465C5",110:"#AF76CC",120:"#BA88D3",130:"#C59ADA",140:"#D0ABE1",150:"#DABDE7",160:"#E5CFEE"},c={10:"#020304",20:"#14171D",30:"#1E2631",40:"#263241",50:"#2F3E53",60:"#384B65",70:"#405878",80:"#49668B",90:"#52749F",100:"#5C82B3",110:"#6590C7",120:"#6E9FDC",130:"#7CAEEE",140:"#96BCF2",150:"#AECAF5",160:"#C5D9F8"};function d(e,t){let r;"OneNote"===e&&(r=a),"Word"===e&&(r=c);const d=r?(0,o.a)(r):n.o,l=r?(0,i.W)(r):s.C;return{fluentThemeV9:t?l:d,brandVariants:r}}},84295:(e,t,r)=>{"use strict";r.d(t,{jB:()=>m,TX:()=>u,qw:()=>g,Q3:()=>v,lJ:()=>f});var o=r(87804),n=r(54813),i=r(93586),s=r(27250),a=r(39521);const c="2.23.0";var d=r(68194);const l="Bearer";const u=712,h="serviceReadOnly";function g(e){const t={sprequestduration:(0,s.ZK)(e.get("sprequestduration")),contentsize:(0,s.ZK)(e.get("content-length"))};[{headerName:"sprequestguid",logName:"sprequestguid"},{headerName:"request-id",logName:"requestId"},{headerName:"client-request-id",logName:"clientRequestId"},{headerName:"x-msedge-ref",logName:"xMsedgeRef"},{headerName:"X-Fluid-Retries",logName:"serverRetries"},{headerName:"content-encoding",logName:"contentEncoding"},{headerName:"content-type",logName:"contentType"}].forEach(r=>{const o=e.get(r.headerName);void 0!==o&&null!==o&&(t[r.logName]=o)});const r=e.get("x-fluid-telemetry");if(void 0!==r&&null!==r){t.xFluidTelemetry=r;const e=r.split(",").map(e=>e.split("="));for(const[r,o]of e)if("Origin"===r.trim()){let e;switch(o?.trim()){case"c":e="cache";break;case"g":e="graph";break;default:e=o?.trim()}t["responseOrigin"]=e;break}}return t}class p extends a.iq{constructor(e,t,r){super(e,r,new Set(["redirectLocation"])),this.redirectLocation=t,this.errorType=o.a.fileNotFoundOrAccessDeniedError,this.canRetry=!1}}function m(e,t,r,s,a){let m,f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const v=function(e){try{if(void 0!==e){const t=JSON.parse(e);if(function(e){const t=e?.error;return"string"===typeof t?.message&&(void 0===t?.code||"string"===typeof t?.code)}(t))return{success:!0,errorResponse:t}}}catch(t){}return{success:!1}}(a);let y,b,S;if(v.success){const e=v.errorResponse;f.responseMessage=e.error.message,y=function(e){const t=[];let r=e.error;for(;"object"===typeof r&&null!==r;)void 0!==r.code&&t.unshift(r.code),r=r.innerError;return t}(e),void 0!==y&&(b=y[0],f.innerMostErrorCode=b)}const C={driverVersion:c,statusCode:t,...f};switch(t){case 301:case 302:case 303:case 307:case 308:if(S=s?.headers.get("Location")??void 0,void 0!==S){m=new p(e,S,C);break}case 400:if("fluidInvalidSchema"===b){m=new n.d8(e,C);break}m=new n.OI(e,o.a.genericNetworkError,C);break;case 401:case 403:if(b===h)m=new n.dw(e,i.E.serviceReadOnly,C);else if("blockedIPAddress"===b||"conditionalAccessPolicyEnforced"===b)m=new n.OI("IP Address is blocked",i.E.blockedIPAddress,C);else{const t=s?.headers?function(e){const t=e.get("www-authenticate");if(!t)return;let r,o=!1;return t.split(",").map(e=>{const t=e.split("=");t.length>=2&&(o||"error"!==t[0].trim().toLowerCase()?r||"claims"!==t[0].trim().toLowerCase()||(r=(0,d.AH)(JSON.parse(e.substring(e.indexOf("=")+1).trim()))):o="insufficient_claims"===JSON.parse(t[1].trim().toLowerCase()))}),o?r:void 0}(s.headers):void 0,r=s?.headers?function(e){const t=e.get("www-authenticate");if(!t)return;const r=t.indexOf(l);if(r<0)return;let o;return t.substring(r+l.length).split(",").map(e=>{if(!o){const t=e.split("=");t.length>=2&&"realm"===t[0].trim().toLowerCase()&&(o=JSON.parse(t[1].trim()))}}),o}(s.headers):void 0;m=new n.yi(e,t,r,C)}break;case 404:if(v.success){const t=v?.errorResponse?.error;if(S=t?.["@error.redirectLocation"],void 0!==S){m=new p(e,S,C);break}}m=new n.OI(e,o.a.fileNotFoundOrAccessDeniedError,C);break;case 406:m=new n.OI(e,o.a.unsupportedClientProtocolVersion,C);break;case 410:m=new n.OI(e,i.E.cannotCatchUp,C);break;case 409:m=new n.OI(e,o.a.fileOverwrittenInStorage,C);break;case 412:m=new n.OI(e,o.a.genericNetworkError,C);break;case 413:m=new n.OI(e,i.E.snapshotTooBig,C);break;case 414:m=new n.OI(e,i.E.invalidFileNameError,C);break;case 423:if("resourceLocked"===b||"resourceCheckedOut"===b){m=new n.OI(e,o.a.fileIsLocked,C);break}case 500:m=new n.dw(e,o.a.genericNetworkError,C);break;case 501:m=new n.OI(e,i.E.fluidNotEnabled,C);break;case 507:m=new n.OI(e,o.a.outOfStorageError,C);break;case u:m=new n.OI(e,o.a.incorrectServerResponse,C);break;default:const t=void 0!==r?1e3*r:void 0;m=(0,n.ix)(e,{canRetry:!0,retryAfterMs:t},C)}return m.addTelemetryProperties({endpointReached:!0}),function(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.online=n.WA[(0,n.sc)()],void 0!==r&&(e.facetCodes=r);if(t&&(o.responseType=t.type,t.headers)){const r=g(t.headers);for(const e of Object.keys(r))o[e]=r[e];e.serverEpoch=t.headers.get("x-fluid-epoch")??void 0}e.addTelemetryProperties(o)}(m,s,y,void 0),m}function f(e,t,r,o,n){const i=m(e,t,function(e){if(null===e)return;const t=Number(e);if(Number.isNaN(t))return;return t}(r.headers.get("retry-after")),r,o,n);throw i.addTelemetryProperties({odspError:!0,storageServiceError:!0}),i}function v(e){return Array.isArray(e?.facetCodes)}},85038:(e,t,r)=>{"use strict";function o(e,t){e||function(e){throw new Error("number"===typeof e?`0x${e.toString(16).padStart(3,"0")}`:e)}(t)}r.d(t,{vA:()=>o})},85851:(e,t,r)=>{"use strict";function o(e,t){"visible"===t&&requestAnimationFrame(e)}r.d(t,{F:()=>o})},85874:(e,t,r)=>{"use strict";r.d(t,{CE:()=>z,E7:()=>T,Ix:()=>O,LV:()=>i,M6:()=>F,N1:()=>M,SU:()=>x,Wy:()=>_,ZU:()=>q,e9:()=>N,gX:()=>P,hP:()=>L,i4:()=>H,jP:()=>I,md:()=>U,p3:()=>D,s5:()=>j,s7:()=>R,vY:()=>A,y6:()=>E,yg:()=>B});var o=r(48680);const n="mip.getLabel",i="mip.setLabel",s="mip.getDlp",a="mip.increaseRetries",c="mip.noDefaultOnGet",d="mip.makeVroomCall",l="mip.guestComponentInheritLabel",u="mip.filterUDPLabels",h="mip.fileIdUsedForDlpTip",g="mip.enforceReadOnlyEnabled",p="mip.enforceMandatoryLabelingEnabled",m="mip.canGetLabelIdWithoutTenantFiltering",f="mip.shouldStopIfCLPNotSupported",v="mip.newGetPolicySettings",y="mip.logEvaluateLabelRequest",b="mip.stopCallingEvaluate",S="mip.useMeInUrls",C="mip.retryOn404ForVroom",k="mip.getDefaultLabelFromLabelsCall",w="mip.assignedModeSupported";function P(e){return(0,o.AU)(n,!0,e)}function T(e){return(0,o.AU)(i,!0,e)}function E(e){return(0,o.AU)(s,!0,e)}function N(e){return(0,o.AU)(a,!0,e)}function I(e){return(0,o.AU)(c,!0,e)}function D(e){return(0,o.AU)(d,!0,e)}function F(e){return(0,o.AU)(l,!0,e)}function B(e){return(0,o.AU)(u,!0,e)}function L(e){return(0,o.AU)(h,!0,e)}function x(e){return(0,o.AU)(g,!1,e)}function A(e){return(0,o.AU)(p,!0,e)}function O(e){return(0,o.AU)(m,!0,e)}function M(e){return(0,o.AU)(f,!0,e)}function _(e){return(0,o.AU)(v,!0,e)}function R(e){return(0,o.AU)(y,!0,e)}function H(e){return(0,o.AU)(b,!0,e)}function U(e){return(0,o.AU)(S,!0,e)}function j(e){return(0,o.AU)(C,!0,e)}function q(e){return(0,o.AU)(k,!0,e)}function z(e){return(0,o.AU)(w,!0,e)}},86748:(e,t,r)=>{"use strict";r.d(t,{P:()=>n});var o=r(26631);async function n(e,t){const r=await e.readBlob(t),n=(0,o.JR)(r,"utf8");return JSON.parse(n)}},87416:(e,t,r)=>{"use strict";r.d(t,{Xd:()=>u,p7:()=>s});var o=r(78796),n=r(48116),i=r(26308);const s="-my",a="-admin",c=".sharepoint.",d=".sharepoint-df.",l=".onmicrosoft.";function u(e){const t=new URL(e);if([o.i,n.t].includes(t.origin.toLowerCase()))return"consumers";const r=t.hostname.toLowerCase(),u=(0,i.v6)(r);if(u)return u.hostname;let h=r.substring(0,r.indexOf(".")),g=r.substring(h.length),p=!1;0===g.indexOf(c)?g=`${l}${g.substring(c.length)}`:0===g.indexOf(d)?g=`${l}${g.substring(d.length)}`:p=!0,h.endsWith(s)?h=h.substring(0,h.length-s.length):h.endsWith(a)&&(h=h.substring(0,h.length-a.length));const m=p?void 0:`${h}${g}`;return(0,i.b6)(r,{hostname:m}),m}},87615:(e,t,r)=>{"use strict";r.d(t,{l:()=>o});const o=()=>globalThis.performance.now()},87804:(e,t,r)=>{"use strict";r.d(t,{a:()=>a});var o=r(34023);const{dataCorruptionError:n,dataProcessingError:i,...s}=o.k,a={...s,genericNetworkError:"genericNetworkError",authorizationError:"authorizationError",fileNotFoundOrAccessDeniedError:"fileNotFoundOrAccessDeniedError",offlineError:"offlineError",unsupportedClientProtocolVersion:"unsupportedClientProtocolVersion",writeError:"writeError",fetchFailure:"fetchFailure",fetchTokenError:"fetchTokenError",incorrectServerResponse:"incorrectServerResponse",fileOverwrittenInStorage:"fileOverwrittenInStorage",deltaStreamConnectionForbidden:"deltaStreamConnectionForbidden",locationRedirection:"locationRedirection",fluidInvalidSchema:"fluidInvalidSchema",fileIsLocked:"fileIsLocked",outOfStorageError:"outOfStorageError"}},87987:e=>{"use strict";var t,r="object"===typeof Reflect?Reflect:null,o=r&&"function"===typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"===typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var n=Number.isNaN||function(e){return e!==e};function i(){i.init.call(this)}e.exports=i,e.exports.once=function(e,t){return new Promise(function(r,o){function n(r){e.removeListener(t,i),o(r)}function i(){"function"===typeof e.removeListener&&e.removeListener("error",n),r([].slice.call(arguments))}m(e,t,i,{once:!0}),"error"!==t&&function(e,t,r){"function"===typeof e.on&&m(e,"error",t,r)}(e,n,{once:!0})})},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var s=10;function a(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}function d(e,t,r,o){var n,i,s,d;if(a(r),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),s=i[t]),void 0===s)s=i[t]=r,++e._eventsCount;else if("function"===typeof s?s=i[t]=o?[r,s]:[s,r]:o?s.unshift(r):s.push(r),(n=c(e))>0&&s.length>n&&!s.warned){s.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=s.length,d=l,console&&console.warn&&console.warn(d)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function u(e,t,r){var o={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},n=l.bind(o);return n.listener=r,o.wrapFn=n,n}function h(e,t,r){var o=e._events;if(void 0===o)return[];var n=o[t];return void 0===n?[]:"function"===typeof n?r?[n.listener||n]:[n]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(n):p(n,n.length)}function g(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"===typeof r)return 1;if(void 0!==r)return r.length}return 0}function p(e,t){for(var r=new Array(t),o=0;o<t;++o)r[o]=e[o];return r}function m(e,t,r,o){if("function"===typeof e.on)o.once?e.once(t,r):e.on(t,r);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,function n(i){o.once&&e.removeEventListener(t,n),r(i)})}}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!==typeof e||e<0||n(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||n(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},i.prototype.getMaxListeners=function(){return c(this)},i.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=i[e];if(void 0===c)return!1;if("function"===typeof c)o(c,this,t);else{var d=c.length,l=p(c,d);for(r=0;r<d;++r)o(l[r],this,t)}return!0},i.prototype.addListener=function(e,t){return d(this,e,t,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(e,t){return d(this,e,t,!0)},i.prototype.once=function(e,t){return a(t),this.on(e,u(this,e,t)),this},i.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,u(this,e,t)),this},i.prototype.removeListener=function(e,t){var r,o,n,i,s;if(a(t),void 0===(o=this._events))return this;if(void 0===(r=o[e]))return this;if(r===t||r.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete o[e],o.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!==typeof r){for(n=-1,i=r.length-1;i>=0;i--)if(r[i]===t||r[i].listener===t){s=r[i].listener,n=i;break}if(n<0)return this;0===n?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,n),1===r.length&&(o[e]=r[0]),void 0!==o.removeListener&&this.emit("removeListener",e,s||t)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(e){var t,r,o;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var n,i=Object.keys(r);for(o=0;o<i.length;++o)"removeListener"!==(n=i[o])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(o=t.length-1;o>=0;o--)this.removeListener(e,t[o]);return this},i.prototype.listeners=function(e){return h(this,e,!0)},i.prototype.rawListeners=function(e){return h(this,e,!1)},i.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):g.call(e,t)},i.prototype.listenerCount=g,i.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},89092:(e,t,r)=>{"use strict";r.d(t,{FX:()=>n});var o=r(53783);function n(e){if("object"===typeof e){const t=e;if(function(e){return e.name===o.ZY.IframeLoadFailed}(t))return o.ZY.IframeLoadFailed;if(function(e){return e.name===o.ZY.ComponentNotFound}(t))return o.ZY.ComponentNotFound}}},90140:(e,t,r)=>{"use strict";r.d(t,{Fq:()=>a,KM:()=>o,PB:()=>s,Ve:()=>c,_D:()=>n,aM:()=>i});const o={BlockingBackground:"--ms-themeColorBlockingBackground",BlockingIcon:"--ms-themeColorBlockingIcon",BodyBackground:"--ms-themeColorBodyBackground",BodyBackgroundChecked:"--ms-themeColorBodyBackgroundChecked",BodyBackgroundHovered:"--ms-themeColorBodyBackgroundHovered",BodyDivider:"--ms-themeColorBodyDivider",BodyFrameBackground:"--ms-themeColorBodyFrameBackground",BodyFrameDivider:"--ms-themeColorBodyFrameDivider",BodyText:"--ms-themeColorBodyText",BodyTextChecked:"--ms-themeColorBodyTextChecked",BodyStandoutBackground:"--ms-themeColorBodyStandoutBackground",BodySubtext:"--ms-themeColorBodySubtext",DefaultStateBackground:"--ms-themeColorDefaultStateBackground",DisabledBodySubtext:"--ms-themeColorDisabledBodySubtext",DisabledBodyText:"--ms-themeColorDisabledBodyText",DisabledBorder:"--ms-themeColorDisabledBorder",ErrorBackground:"--ms-themeColorErrorBackground",ErrorBoxBackground:"--ms-themeColorErrorBoxBackground",ErrorIcon:"--ms-themeColorErrorIcon",ErrorBorder:"--ms-themeColorErrorBorder",ErrorBlock:"--ms-themeColorErrorBlock",DarkErrorBlock:"--ms-themeColorDarkErrorBlock",GrayErrorBackground:"--ms-themeColorGrayErrorBackground",DarkGrayErrorBackground:"--ms-themeColorDarkGrayErrorBackground",ErrorText:"--ms-themeColorErrorText",InfoText:"--ms-themeColorInfoText",RedErrorText:"--ms-themeColorRedErrorText",GrayIcon:"--ms-themeColorGrayIcon",FocusBorder:"--ms-themeColorFocusBorder",InfoBackground:"--ms-themeColorInfoBackground",InfoIcon:"--ms-themeColorInfoIcon",MessageLink:"--ms-themeColorMessageLink",MessageLinkHovered:"--ms-themeColorMessageLinkHovered",MessageText:"--ms-themeColorMessageText",SevereWarningBackground:"--ms-themeColorSevereWarningBackground",SevereWarningIcon:"--ms-themeColorSevereWarningIcon",SuccessBackground:"--ms-themeColorSuccessBackground",SuccessIcon:"--ms-themeColorSuccessIcon",VariantBorder:"--ms-themeColorVariantBorder",VariantBorderHovered:"--ms-themeColorVariantBorderHovered",WarningBackground:"--ms-themeColorWarningBackground",WarningHighlight:"--ms-themeColorWarningHighlight",WarningIcon:"--ms-themeColorWarningIcon",ActionLink:"--ms-themeColorActionLink",ActionLinkHovered:"--ms-themeColorActionLinkHovered",Link:"--ms-themeColorLink",LinkHovered:"--ms-themeColorLinkHovered",AccentButtonBackground:"--ms-themeColorAccentButtonBackground",AccentButtonText:"--ms-themeColorAccentButtonText",ButtonBackground:"--ms-themeColorButtonBackground",ButtonBackgroundChecked:"--ms-themeColorButtonBackgroundChecked",ButtonBackgroundHovered:"--ms-themeColorButtonBackgroundHovered",ButtonBackgroundCheckedHovered:"--ms-themeColorButtonBackgroundCheckedHovered",ButtonBackgroundPressed:"--ms-themeColorButtonBackgroundPressed",ButtonBackgroundDisabled:"--ms-themeColorButtonBackgroundDisabled",ButtonBorder:"--ms-themeColorButtonBorder",ButtonText:"--ms-themeColorButtonText",ButtonTextHovered:"--ms-themeColorButtonTextHovered",ButtonTextChecked:"--ms-themeColorButtonTextChecked",ButtonTextCheckedHovered:"--ms-themeColorButtonTextCheckedHovered",ButtonTextPressed:"--ms-themeColorButtonTextPressed",ButtonTextDisabled:"--ms-themeColorButtonTextDisabled",ButtonBorderDisabled:"--ms-themeColorButtonBorderDisabled",PrimaryButtonBackground:"--ms-themeColorPrimaryButtonBackground",PrimaryButtonBackgroundHovered:"--ms-themeColorPrimaryButtonBackgroundHovered",PrimaryButtonBackgroundPressed:"--ms-themeColorPrimaryButtonBackgroundPressed",PrimaryButtonBackgroundDisabled:"--ms-themeColorPrimaryButtonBackgroundDisabled",PrimaryButtonBorder:"--ms-themeColorPrimaryButtonBorder",PrimaryButtonText:"--ms-themeColorPrimaryButtonText",PrimaryButtonTextHovered:"--ms-themeColorPrimaryButtonTextHovered",PrimaryButtonTextPressed:"--ms-themeColorPrimaryButtonTextPressed",PrimaryButtonTextDisabled:"--ms-themeColorPrimaryButtonTextDisabled",InputBorder:"--ms-themeColorInputBorder",InputBorderHovered:"--ms-themeColorInputBorderHovered",InputBackground:"--ms-themeColorInputBackground",InputBackgroundChecked:"--ms-themeColorInputBackgroundChecked",InputBackgroundCheckedHovered:"--ms-themeColorInputBackgroundCheckedHovered",InputPlaceholderBackgroundChecked:"--ms-themeColorInputPlaceholderBackgroundChecked",InputForegroundChecked:"--ms-themeColorInputForegroundChecked",InputIcon:"--ms-themeColorInputIcon",InputIconHovered:"--ms-themeColorInputIconHovered",InputIconDisabled:"--ms-themeColorInputIconDisabled",InputFocusBorderAlt:"--ms-themeColorInputFocusBorderAlt",SmallInputBorder:"--ms-themeColorSmallInputBorder",InputText:"--ms-themeColorInputText",InputTextHovered:"--ms-themeColorInputTextHovered",InputTextPressed:"--ms-themeColorInputTextPressed",InputPlaceholderText:"--ms-themeColorInputPlaceholderText",DisabledBackground:"--ms-themeColorDisabledBackground",DisabledText:"--ms-themeColorDisabledText",DisabledSubtext:"--ms-themeColorDisabledSubtext",ListBackground:"--ms-themeColorListBackground",ListText:"--ms-themeColorListText",ListTextColor:"--ms-themeColorListTextColor",ListItemBackgroundHovered:"--ms-themeColorListItemBackgroundHovered",ListItemBackgroundChecked:"--ms-themeColorListItemBackgroundChecked",ListItemBackgroundCheckedHovered:"--ms-themeColorListItemBackgroundCheckedHovered",ListHeaderBackgroundHovered:"--ms-themeColorListHeaderBackgroundHovered",ListHeaderBackgroundPressed:"--ms-themeColorListHeaderBackgroundPressed",MenuBackground:"--ms-themeColorMenuBackground",MenuBorder:"--ms-themeColorMenuBorder",MenuDivider:"--ms-themeColorMenuDivider",MenuIcon:"--ms-themeColorMenuIcon",MenuHeader:"--ms-themeColorMenuHeader",MenuItemBackgroundChecked:"--ms-themeColorMenuItemBackgroundChecked",MenuItemBackgroundHovered:"--ms-themeColorMenuItemBackgroundHovered",MenuItemBackgroundPressed:"--ms-themeColorMenuItemBackgroundPressed",MenuItemText:"--ms-themeColorMenuItemText",MenuItemTextHovered:"--ms-themeColorMenuItemTextHovered",MenuItemTextPressed:"--ms-themeColorMenuItemTextPressed",MenuItemTextChecked:"--ms-themeColorMenuItemTextChecked",MenuItemTextSecondary:"--ms-themeColorMenuItemTextSecondary",CardShadow:"--ms-themeCardShadow",CardShadowHovered:"--ms-themeCardShadowHovered",CardStandoutBackground:"--ms-themeColorCardStandoutBackground",GrabberBorderChecked:"--ms-grabberBorderChecked",GrabberBackgroundChecked:"--ms-grabberBackgroundChecked",GrabberColor:"--ms-grabberColor",GrabberColorChecked:"--ms-grabberColorChecked",CheckboxBackgroundUnchecked:"--ms-checkboxBackgroundUnchecked",CheckboxBackgroundChecked:"--ms-checkboxBackgroundChecked",CheckboxColorUnchecked:"--ms-checkboxColorUnchecked",CheckboxColorUncheckedHovered:"--ms-checkboxColorUncheckedHovered",CheckboxColorCheckedHovered:"--ms-checkboxColorCheckedHovered",CheckboxColorChecked:"--ms-checkboxColorChecked",CheckboxUnpopulated:"--ms-checkboxUnpopulated",TeamsV2DefaultForeground2:"--ms-themeColorPaletteTeamsV2DefaultForeground2",TeamsV2DefaultForeground:"--ms-themeColorPaletteTeamsV2DefaultForeground",TeamsV2DefaultForegroundHover:"--ms-themeColorPaletteTeamsV2DefaultForegroundHover",TeamsV2DefaultForegroundPressed:"--ms-themeColorPaletteTeamsV2DefaultForegroundPressed",TeamsV2DefaultBackground:"--ms-themeColorPaletteTeamsV2DefaultBackground",TeamsV2DefaultBackgroundHover:"--ms-themeColorPaletteTeamsV2DefaultBackgroundHover",TeamsV2DefaultBackgroundPressed:"--ms-themeColorPaletteTeamsV2DefaultBackgroundPressed",TeamsV2DefaultBorder:"--ms-themeColorPaletteTeamsV2DefaultBorder",TeamsV2DefaultBorderHover:"--ms-themeColorPaletteTeamsV2DefaultBorderHover",TeamsV2DefaultBorderPressed:"--ms-themeColorPaletteTeamsV2DefaultBorderPressed",TeamsV2BrandForeground4:"--ms-themeColorPaletteTeamsV2BrandForeground4",TeamsV2BrandBackground:"--ms-themeColorPaletteTeamsV2BrandBackground",TeamsV2BrandBackgroundHover:"--ms-themeColorPaletteTeamsV2BrandBackgroundHover",TeamsV2BrandBackgroundPressed:"--ms-themeColorPaletteTeamsV2BrandBackgroundPressed",VotingButtonHoverShadow:"--ms-themeColorPaletteVotingButtonHoverShadow"},n={ThemeName:"--ms-themeColorThemeName",TextSizeAdjust:"--ms-themeTextSizeAdjust",Selection:"--ms-themeColorSelection",SelectionBackground:"--ms-themeColorSelectionBackground",SelectionBorder:"--ms-themeColorSelectionBorder",DragDropTearOffPageBorder:"--ms-themeColorPaletteDragDropTearOffPageBorder",DragDropTearOffPageBackground:"--ms-themeColorPaletteDragDropTearOffPageBackground",BlockComponentPlaceholderBackground:"--ms-themeColorPaletteBlockComponentPlaceholderBackground",AtMentionBackgroundMe:"--ms-themeColorPaletteAtMentionBackGroundMe",AtMentionTextMe:"--ms-themeColorPaletteAtMentionTextMe",AtMentionBackgroundOther:"--ms-themeColorPaletteAtMentionBackgroundOther",AtMentionTextOther:"--ms-themeColorPaletteAtMentionTextOther",AtMentionBackgroundHighlight:"--ms-themeColorPaletteAtMentionBackgroundHighlight",AtMentionHighlightBorder:"--ms-themeColorPaletteAtMentionHighlightBorder",AtMentionUnresolvedBackground:"--ms-themeColorPaletteAtMentionUnresolvedBackground",AtMentionUnresolvedBackgroundHovered:"--ms-themeColorPaletteAtMentionUnresolvedBackgroudHovered",AtMentionUnresolvedBackgroundPressed:"--ms-themeColorPaletteAtMentionsUnresolvedBackgroundPressed",AtMentionUnresolvedBackgroundSelected:"--ms-themeColorPaletteAtMentionUnresolvedBackgroudSelected",AtMentionUnresolvedIcon:"--ms-themeColorPaletteAtMentionUnresolvedIcon",AtMentionUnresolvedIconHovered:"--ms-themeColorPaletteAtMentionUnresolvedIconHovered",AtMentionUnresolvedIconPressed:"--ms-themeColorPaletteAtMentionUnresolvedIconPressed",AtMentionUnresolvedIconSelected:"--ms-themeColorPaletteAtMentionUnresolvedIconSelected",AtMentionUnresolvedIconInner:"--ms-themeColorPaletteAtMentionUnresolvedIconInner",AtMentionUnresolvedIconInnerHovered:"--ms-themeColorPaletteAtMentionUnresolvedIconInnerHovered",AtMentionUnresolvedIconInnerPressed:"--ms-themeColorPaletteAtMentionUnresolvedIconInnerPressed",AtMentionUnresolvedIconInnerSelected:"--ms-themeColorPaletteAtMentionUnresolvedIconInnerSelected",AtMentionUnresolvedOutline:"--ms-themeColorPaletteAtMentionUnresolvedOutline",AtMentionUnresolvedOutlineHovered:"--ms-themeColorPaletteAtMentionUnresolvedOutlineHovered",AtMentionUnresolvedOutlinePressed:"--ms-themeColorPaletteAtMentionUnresolvedOutlinePressed",AtMentionUnresolvedOutlineSelected:"--ms-themeColorPaletteAtMentionUnresolvedOutlineSelected",IconButton:"--ms-themeColorIconButton",IconButtonHovered:"--ms-themeColorIconButtonHovered",IconButtonPressed:"--ms-themeColorIconButtonPressed",IconButtonChecked:"--ms-themeColorIconButtonChecked",IconButtonBackground:"--ms-themeColorIconButtonBackground",IconButtonBackgroundHovered:"--ms-themeColorIconButtonBackgroundHovered",IconButtonBackgroundPressed:"--ms-themeColorIconButtonBackgroundPressed",IconButtonBackgroundChecked:"--ms-themeColorIconButtonBackgroundChecked",OverflowText:"--ms-themeColorOverflowText",OverflowTextHovered:"--ms-themeColorOverflowTextHovered",OverflowTextPressed:"--ms-themeColorOverflowTextPressed",OverflowTextChecked:"--ms-themeColorOverflowTextChecked",OverflowBackground:"--ms-themeColorOverflowBackground",OverflowBackgroundHovered:"--ms-themeColorOverflowBackgroundHovered",OverflowBackgroundPressed:"--ms-themeColorOverflowBackgroundPressed",OverflowBackgroundChecked:"--ms-themeColorOverflowBackgroundChecked",MenuBorder:"--ms-themeColorMenuBorder",TooltipText:"--ms-themeColorTooltipText",TooltipBackground:"--ms-themeColorTooltipBackground",CalendarCellText:"--ms-themeColorCalendarCellText",CalendarCellTextHovered:"--ms-themeColorCalendarCellTextHovered",CalendarCellTextChecked:"--ms-themeColorCalendarCellTextChecked",CalendarCellTextToday:"--ms-themeColorCalendarCellTextToday",CalendarHeaderText:"--ms-themeColorCalendarHeaderText",CalendarBackground:"--ms-themeColorCalendarBackground",CalendarCellBackground:"--ms-themeColorCalendarCellBackground",CalendarCellBackgroundHovered:"--ms-themeColorCalendarCellBackgroundHovered",CalendarCellBackgroundChecked:"--ms-themeColorCalendarCellBackgroundSelected",CalendarCellBackgroundToday:"--ms-themeColorCalendarCellBackgroundToday",DatePickerTextToday:"--ms-themeColorDatePickerTextToday",DatePickerTextTomorrow:"--ms-themeColorDatePickerTextTomorrow",DatePickerTextYesterday:"--ms-themeColorDatePickerTextYesterday",DatePickerTextOther:"--ms-themeColorDatePickerTextOther",DatePickerBackgroundToday:"--ms-themeColorDatePickerBackgroundToday",DatePickerBackgroundTomorrow:"--ms-themeColorDatePickerBackgroundTomorrow",DatePickerBackgroundYesterday:"--ms-themeColorDatePickerBackgroundYesterday",DatePickerBackground:"--ms-themeColorDatePickerBackground",DatePickerGrayedText:"--ms-themeColorDatePickerGrayedText",DatePickerGrayedBackground:"--ms-themeColorDatePickerGrayedBackground",TaskDueDateTextToday:"--ms-themeColorDatePickerTextToday",TaskDueDateTextTomorrow:"--ms-themeColorDatePickerTextTomorrow",TaskDueDateTextYesterday:"--ms-themeColorDatePickerTextYesterday",TaskDueDateTextOther:"--ms-themeColorDatePickerTextOther",PersonaBorder:"--ms-themeColorPersonaBorder",PersonaText:"--ms-themeColorPersonaText",BodyBackgroundWithAlpha:"--ms-themeColorBodyBackgroundWithAlpha",ErrorCalloutText:"--ms-themeColorErrorCalloutText",ErrorCalloutBackground:"--ms-themeColorErrorCalloutBackground",ErrorSnackbarText:"--ms-themeColorErrorSnackbarText",ErrorSnackbarBackground:"--ms-themeColorErrorSnackbarBackground",WarningSnackbarText:"--ms-themeColorWarningSnackbarText",WarningSnackbarBackground:"--ms-themeColorWarningSnackbarBackground",TextSelectionBackgroundHovered:"--ms-themeColorPaletteTextSelectionBackgroundHovered",TextSelectionBackgroundPressed:"--ms-themeColorPaletteTextSelectionBackgroundPressed",TextSelectionEndCap:"--ms-themeColorPaletteTextSelectionEndCap",TextSelectionHorizontalCap:"--ms-themeColorPaletteTextSelectionHorizontalCap",FloatieText:"--ms-themeColorPaletteFloatieText",FloatieTextHovered:"--ms-themeColorPaletteFloatieTextHovered",FloatieTextPressed:"--ms-themeColorPaletteFloatieTextPressed",FloatieBackground:"--ms-themeColorPaletteFloatieBackground",FloatieBackgroundHovered:"--ms-themeColorPaletteFloatieBackgroundHovered",FloatieBackgroundPressed:"--ms-themeColorPaletteFloatieBackgroundPressed",FloatieBorder:"--ms-themeColorPaletteFloatieBorder",FloatieBorderHovered:"--ms-themeColorPaletteFloatieBorderHovered",FloatieBorderPressed:"--ms-themeColorPaletteFloatieBorderPressed",FontColorRed:"--ms-themeColorPaletteFontColorRed",FontColorOrange:"--ms-themeColorPaletteFontColorOrange",FontColorYellow:"--ms-themeColorPaletteFontColorYellow",FontColorGreen:"--ms-themeColorPaletteFontColorGreen",FontColorBlueGreen:"--ms-themeColorPaletteFontColorBlueGreen",FontColorBlue:"--ms-themeColorPaletteFontColorBlue",FontColorPurple:"--ms-themeColorPaletteFontColorPurple",BackgroundColorRed:"--ms-themeColorPaletteBackgroundColorRed",BackgroundColorOrange:"--ms-themeColorPaletteBackgroundColorOrange",BackgroundColorYellow:"--ms-themeColorPaletteBackgroundColorYellow",BackgroundColorGreen:"--ms-themeColorPaletteBackgroundColorGreen",BackgroundColorBlueGreen:"--ms-themeColorPaletteBackgroundColorBlueGreen",BackgroundColorBlue:"--ms-themeColorPaletteBackgroundColorBlue",BackgroundColorPurple:"--ms-themeColorPaletteBackgroundColorPurple",BackgroundAcrylicColorized:"--colorBackgroundAcrylicColorized",BackgroundAcrylicColorizedFallback:"--colorBackgroundAcrylicColorizedFallback",ComponentGlowBorder1:"--ms-themeColorPaletteComponentGlowBorder1",ComponentGlowBorder2:"--ms-themeColorPaletteComponentGlowBorder2",ComponentGlowBorder3:"--ms-themeColorPaletteComponentGlowBorder3",ComponentGlowBorder4:"--ms-themeColorPaletteComponentGlowBorder4",ComponentGlowBorder5:"--ms-themeColorPaletteComponentGlowBorder5",InCanvasPresenceText:"--ms-themeColorInCanvasPresenceText",CanvasBackground:"--ms-themeColorCanvasBackground"},i={Default:"default",Dark:"dark",HighContrast:"high-contrast"},s={MarginTopBody:"--ms-themeMarginTopBody",MarginTopHeading1:"--ms-themeMarginTopHeading1",MarginTopHeading2:"--ms-themeMarginTopHeading2",MarginTopHeading3:"--ms-themeMarginTopHeading3",MarginTopHeading4:"--ms-themeMarginTopHeading4",MarginTopHeading5:"--ms-themeMarginTopHeading5",MarginTopHeading6:"--ms-themeMarginTopHeading6",MarginBottomHeading1:"--ms-themeMarginBottomHeading1",MarginBottomHeading2:"--ms-themeMarginBottomHeading2",MarginBottomHeading3:"--ms-themeMarginBottomHeading3",MarginBottomHeading4:"--ms-themeMarginBottomHeading4",MarginBottomHeading5:"--ms-themeMarginBottomHeading5",MarginBottomHeading6:"--ms-themeMarginBottomHeading6",LineHeightBody:"--ms-themeLineHeightBody",LineHeightHeading1:"--ms-themeLineHeightHeading1",LineHeightHeading2:"--ms-themeLineHeightHeading2",LineHeightHeading3:"--ms-themeLineHeightHeading3",LineHeightHeading4:"--ms-themeLineHeightHeading4",LineHeightHeading5:"--ms-themeLineHeightHeading5",LineHeightHeading6:"--ms-themeLineHeightHeading6",OutlineBody:"--ms-themeOutlineBody",OutlineHeading1:"--ms-themeOutlineHeading1",OutlineHeading2:"--ms-themeOutlineHeading2",OutlineHeading3:"--ms-themeOutlineHeading3",OutlineHeading4:"--ms-themeOutlineHeading4",OutlineHeading5:"--ms-themeOutlineHeading5",OutlineHeading6:"--ms-themeOutlineHeading6",TextDecorationComplement:"--ms-themeTextDecorationComplement"},a={FontFamilyBody:"--ms-themeFontFamilyBody",FontFamilyHeading1:"--ms-themeFontFamilyHeading1",FontFamilyHeading2:"--ms-themeFontFamilyHeading2",FontFamilyHeading3:"--ms-themeFontFamilyHeading3",FontFamilyMenu:"--ms-themeFontFamilyMenu",FontFamilyButton:"--ms-themeFontFamilyButton",FontSizeBody:"--ms-themeFontSizeBody",FontSizeHeading1:"--ms-themeFontSizeHeading1",FontSizeHeading2:"--ms-themeFontSizeHeading2",FontSizeHeading3:"--ms-themeFontSizeHeading3",FontSizeHeading4:"--ms-themeFontSizeHeading4",FontSizeHeading5:"--ms-themeFontSizeHeading5",FontSizeHeading6:"--ms-themeFontSizeHeading6",FontSizeMenu:"--ms-themeFontSizeMenu",FontSizeButton:"--ms-themeFontSizeButton",FontWeightBody:"--ms-themeFontWeightBody",FontWeightHeading1:"--ms-themeFontWeightHeading1",FontWeightHeading2:"--ms-themeFontWeightHeading2",FontWeightHeading3:"--ms-themeFontWeightHeading3",FontWeightMenu:"--ms-themeFontWeightMenu",FontWeightButton:"--ms-themeFontWeightButton"},c={PinkRed10:"--ms-themeColorPaletteSharedPinkRed10",Red20:"--ms-themeColorPaletteSharedRed20",Red10:"--ms-themeColorPaletteSharedRed10",RedOrange10:"--ms-themeColorPaletteSharedRedOrange10",Orange30:"--ms-themeColorPaletteSharedOrange30",Orange20:"--ms-themeColorPaletteSharedOrange20",Orange10:"--ms-themeColorPaletteSharedOrange10",Yellow20:"--ms-themeColorPaletteSharedYellow20",Yellow10:"--ms-themeColorPaletteSharedYellow10",OrangeYellow20:"--ms-themeColorPaletteSharedOrangeYellow20",OrangeYellow10:"--ms-themeColorPaletteSharedOrangeYellow10",YellowGreen10:"--ms-themeColorPaletteSharedYellowGreen10",Green20:"--ms-themeColorPaletteSharedGreen20",Green10:"--ms-themeColorPaletteSharedGreen10",GreenCyan10:"--ms-themeColorPaletteSharedGreenCyan10",Cyan30:"--ms-themeColorPaletteSharedCyan30",Cyan20:"--ms-themeColorPaletteSharedCyan20",Cyan10:"--ms-themeColorPaletteSharedCyan10",CyanBlue20:"--ms-themeColorPaletteSharedCyanBlue20",CyanBlue10:"--ms-themeColorPaletteSharedCyanBlue10",Blue10:"--ms-themeColorPaletteSharedBlue10",BlueMagenta30:"--ms-themeColorPaletteSharedBlueMagenta30",BlueMagenta20:"--ms-themeColorPaletteSharedBlueMagenta20",BlueMagenta10:"--ms-themeColorPaletteSharedBlueMagenta10",Magenta20:"--ms-themeColorPaletteSharedMagenta20",Magenta10:"--ms-themeColorPaletteSharedMagenta10",MagentaPink20:"--ms-themeColorPaletteSharedMagentaPink20",MagentaPink10:"--ms-themeColorPaletteSharedMagentaPink10",Gray430:"--ms-themeColorPaletteSharedGray430",Gray180:"--ms-themeColorPaletteSharedGray180",Gray130:"--ms-themeColorPaletteSharedGray130",Gray100:"--ms-themeColorPaletteSharedGray100",Gray80:"--ms-themeColorPaletteSharedGray80",Gray70:"--ms-themeColorPaletteSharedGray70",Gray50:"--ms-themeColorPaletteSharedGray50",Gray40:"--ms-themeColorPaletteSharedGray40",Gray30:"--ms-themeColorPaletteSharedGray30",Gray20:"--ms-themeColorPaletteSharedGray20",Gray10:"--ms-themeColorPaletteSharedGray10",Gray4:"--ms-themeColorPaletteSharedGray4",Gray6:"--ms-themeColorPaletteSharedGray6",Gray5:"--ms-themeColorPaletteSharedGray5",Gray1:"--ms-themeColorPaletteSharedGray1",Away:"--ms-themeColorPalettePresenceAway",DoNotDisturb:"--ms-themeColorPalettePresenceDoNotDisturb",Online:"--ms-themeColorPalettePresenceOnline",Invisible:"--ms-themeColorPalettePresenceInvisible",OutOfOffice:"--ms-themeColorPalettePresenceOutOfOffice",Warning:"--ms-themeColorPaletteMessagingWarning",WarningIcon:"--ms-themeColorPaletteMessagingWarningIcon",SevereWarning:"--ms-themeColorPaletteMessagingSevereWarning",SevereWarningIcon:"--ms-themeColorPaletteMessagingServereWarningIcon",ErrorBlock:"--ms-themeColorPaletteMessagingErrorBlock",ErrorBlockIcon:"--ms-themeColorPaletteMessagingErrorBlockIcon",ErrorBackground:"--ms-themeColorPaletteMessagingErrorBackground",ErrorBoxBackground:"--ms-themeColorPaletteMessagingErrorBoxBackground",ErrorText:"--ms-themeColorPaletteMessagingErrorText",InfoText:"--ms-themeColorPaletteMessagingInfoText",DarkErrorBlock:"--ms-themeColorPaletteMessagingDarkErrorBlock",GrayErrorBackground:"--ms-themeColorPaletteMessagingGrayErrorBackground",DarkGrayErrorBackground:"--ms-themeColorPaletteMessagingDarkGrayErrorBackground",GrayErrorText:"--ms-themeColorPaletteMessagingGrayErrorText",RedErrorText:"--ms-themeColorPaletteMessagingRedErrorText",GrayIcon:"--ms-themeColorPaletteMessagingGrayIcon",ButtonText:"--ms-themeColorPaletteMessagingButtonText",Success:"--ms-themeColorPaletteMessagingSuccess",SuccessIcon:"--ms-themeColorPaletteMessagingSuccessIcon",themeDarker:"--ms-themeColorPaletteThemeDarker",themeDark:"--ms-themeColorPaletteThemeDark",themeDarkAlt:"--ms-themeColorPaletteThemeDarkAlt",themePrimary:"--ms-themeColorPaletteThemePrimary",themeSecondary:"--ms-themeColorPaletteThemeSecondary",themeTertiary:"--ms-themeColorPaletteThemeTertiary",themeLight:"--ms-themeColorPaletteThemeLight",themeLighter:"--ms-themeColorPaletteThemeLighter",themeLighterAlt:"--ms-themeColorPaletteThemeLighterAlt",black:"--ms-themeColorPaletteBlack",neutralDark:"--ms-themeColorPaletteNeutralDark",neutralPrimary:"--ms-themeColorPaletteNeutralPrimary",neutralPrimaryAlt:"--ms-themeColorPaletteNeutralPrimaryAlt",neutralSecondary:"--ms-themeColorPaletteNeutralSecondary",neutralSecondaryAlt:"--ms-themeColorPaletteNeutralSecondaryAlt",neutralTertiary:"--ms-themeColorPaletteNeutralTertiary",neutralTertiaryAlt:"--ms-themeColorPaletteNeutralTertiaryAlt",neutralQuaternary:"--ms-themeColorPaletteNeutralQuaternary",neutralQuaternaryAlt:"--ms-themeColorPaletteNeutralQuaternaryAlt",neutralQuaternaryAlt2:"--ms-themeColorPaletteNeutralQuaternaryAlt2",neutralLight:"--ms-themeColorPaletteNeutralLight",neutralLightAlt:"--ms-themeColorPaletteNeutralLightAlt",neutralLighter:"--ms-themeColorPaletteNeutralLighter",neutralLighterAlt:"--ms-themeColorPaletteNeutralLighterAlt",white:"--ms-themeColorPaletteWhite",yellowDark:"--ms-themeColorPaletteAccentYellowDark",yellow:"--ms-themeColorPaletteAccentYellow",yellowLight:"--ms-themeColorPaletteAccentYellowLight",orange:"--ms-themeColorPaletteAccentOrange",orangeLight:"--ms-themeColorPaletteAccentOrangeLight",orangeLighter:"--ms-themeColorPaletteAccentOrangeLighter",redDark:"--ms-themeColorPaletteAccentRedDark",red:"--ms-themeColorPaletteAccentRed",magentaDark:"--ms-themeColorPaletteAccentMagentaDark",magenta:"--ms-themeColorPaletteAccentMagenta",magentaLight:"--ms-themeColorPaletteAccentMagentaLight",purpleDark:"--ms-themeColorPaletteAccentPurpleDark",purple:"--ms-themeColorPaletteAccentPurple",purpleLight:"--ms-themeColorPaletteAccentPurpleLight",blueDark:"--ms-themeColorPaletteAccentBlueDark",blueMid:"--ms-themeColorPaletteAccentBlueMid",blue:"--ms-themeColorPaletteAccentBlue",blueAlt:"--ms-themeColorPaletteAccentBlueAlt",blueLight:"--ms-themeColorPaletteAccentBlueLight",tealDark:"--ms-themeColorPaletteAccentTealDark",teal:"--ms-themeColorPaletteAccentTeal",tealLight:"--ms-themeColorPaletteAccentTealLight",greenDark:"--ms-themeColorPaletteAccentGreenDark",green:"--ms-themeColorPaletteAccentGreen",greenLight:"--ms-themeColorPaletteAccentGreenLight",SuggestionAcceptedBackground:"--ms-themeColorPaletteProofingSuggestionAcceptedBackground",SpellingSuggestionHoverHighlight:"--ms-themeColorPaletteProofingSpellingSuggestionHoverHighlight",SpellingHoverTextColor:"--ms-themeColorPaletteProofingSpellingHoverTextColor",GrammarSuggestionHoverHighlight:"--ms-themeColorPaletteProofingGrammarSuggestionHoverHighlight",GrammarHoverTextColor:"--ms-themeColorPaletteProofingGrammarHoverTextColor",HeadingDetectedHoverHighlight:"--ms-themeColorPaletteAnnotationsHeadingDetectedHoverHighlight",HeadingDetectedHoverTextColor:"--ms-themeColorPaletteAnnotationsHeadingDetectedHoverTextColor",TaskRecognitionUnderline:"--ms-themeColorPaletteAnnotationsTaskRecognitionUnderline",TaskRecognitionHoverHighlight:"--ms-themeColorPaletteAnnotationsTaskRecognitionHoverHighlight",TaskRecognitionHoverTextColor:"--ms-themeColorPaletteAnnotationsTaskRecognitionHoverTextColor",EntityRecognitionUnderline:"--ms-themeColorPaletteAnnotationsEntityRecognitionUnderline",EntityRecognitionHoverHighlight:"--ms-themeColorPaletteAnnotationsEntityRecognitionHoverHighlight",EntityRecognitionHoverTextColor:"--ms-themeColorPaletteAnnotationsEntityRecognitionHoverTextColor",Scrollbar:"--ms-themeColorScrollbar",ScrollbarPressed:"--ms-themeColorScrollbarPressed",HeadingText:"--ms-themeColorHeadingText"}},90293:(e,t,r)=>{"use strict";r.d(t,{br:()=>We,NK:()=>Qe,Wu:()=>Je,b6:()=>Ze,Z:()=>$e,$r:()=>qe,Ng:()=>Ge,ig:()=>Ve,Sk:()=>Ke,ux:()=>Ue,ZG:()=>je,OX:()=>ze});var o=r(28014),n=r(20875),i=r(27284);const s="--ms-themeColorHeadingText",a={neutralPrimary:`var(${"--ms-themeColorPaletteNeutralPrimary"}, #323130)`},c="--ms-themeFontFamilyHeading1",d="--ms-themeFontSizeHeading1",l="--ms-themeFontSizeHeading2",u="--ms-themeFontSizeHeading3",h="--ms-themeFontFamilyHeading2",g="--ms-themeFontFamilyHeading3",p="--ms-themeFontSizeBody",m="--ms-themeFontWeightBody",f="--ms-themeFontWeightHeading1",v="--ms-themeFontWeightHeading2",y="--ms-themeFontWeightHeading3",b="--ms-themeColorBodyText",S="--ms-themeColorBodyBackground",C="--ms-themeMarginTopHeading1",k="--ms-themeMarginTopHeading2",w="--ms-themeMarginTopHeading3",P="--ms-themeLineHeightBody",T="--ms-themeLineHeightHeading1",E="--ms-themeLineHeightHeading2",N="--ms-themeLineHeightHeading3",I="--ms-themeOutlineBody",D="--ms-themeOutlineHeading1",F="--ms-themeOutlineHeading2",B="--ms-themeOutlineHeading3",L="--colorNeutralForeground1",x="--colorNeutralBackground1",A="--fontFamilyBase",O="--fontSizeBase300",M="--fontSizeBase500",_="--fontSizeBase600",R="--fontSizeHero800",H="--fontWeightRegular",U="--fontWeightSemibold",j="--fontWeightBold",q="--lineHeightBase400",z="--lineHeightBase500",V="--lineHeightBase600",$="--lineHeightHero800",G=`var(${A}, var(${"--ms-themeFontFamilyBody"}, ${"Segoe UI"}, ${"Segoe UI Emoji"}, ${"sans-serif"}))`,W=`var(${L}, var(${b}, ${a.neutralPrimary}))`,J=[["Heading 1",[{name:"fontFamily",cssPropertyName:"font-family",value:{customPropertyName:"--fontFamilyBaseDisplay",fallbackValue:`var(${c}, ${G})`}},{name:"fontSize",cssPropertyName:"font-size",value:{customPropertyName:R,fallbackValue:`var(${d}, 24px)`}},{name:"fontWeight",cssPropertyName:"font-weight",value:{customPropertyName:j,fallbackValue:`var(${f}, 700)`}},{name:"color",cssPropertyName:"color",value:{customPropertyName:s,fallbackValue:W}},{name:"marginTop",cssPropertyName:"margin-top",value:{customPropertyName:C,fallbackValue:"24px"}},{name:"lineHeight",cssPropertyName:"line-height",value:{customPropertyName:$,fallbackValue:`var(${T}, normal)`}},{name:"role",cssPropertyName:"role",value:"heading"},{name:"ariaLevel",cssPropertyName:"aria-level",value:"1"},{name:"outline",cssPropertyName:"outline",value:{customPropertyName:D}},{name:"backgroundColor",cssPropertyName:"background-color",value:{customPropertyName:x,fallbackValue:`var(${S}, transparent)`}}]],["Heading 2",[{name:"fontFamily",cssPropertyName:"font-family",value:{customPropertyName:"--fontFamilyBaseDisplay",fallbackValue:`var(${h}, ${G})`}},{name:"fontSize",cssPropertyName:"font-size",value:{customPropertyName:_,fallbackValue:`var(${l}, 20px)`}},{name:"fontWeight",cssPropertyName:"font-weight",value:{customPropertyName:j,fallbackValue:`var(${v}, 700)`}},{name:"color",cssPropertyName:"color",value:{customPropertyName:s,fallbackValue:W}},{name:"marginTop",cssPropertyName:"margin-top",value:{customPropertyName:k,fallbackValue:"20px"}},{name:"lineHeight",cssPropertyName:"line-height",value:{customPropertyName:V,fallbackValue:`var(${E}, normal)`}},{name:"role",cssPropertyName:"role",value:"heading"},{name:"ariaLevel",cssPropertyName:"aria-level",value:"2"},{name:"outline",cssPropertyName:"outline",value:{customPropertyName:F}},{name:"backgroundColor",cssPropertyName:"background-color",value:{customPropertyName:x,fallbackValue:`var(${S}, transparent)`}}]],["Heading 3",[{name:"fontFamily",cssPropertyName:"font-family",value:{customPropertyName:"--fontFamilyBaseDisplay",fallbackValue:`var(${g}, ${G})`}},{name:"fontSize",cssPropertyName:"font-size",value:{customPropertyName:M,fallbackValue:`var(${u}, 14px)`}},{name:"fontWeight",cssPropertyName:"font-weight",value:{customPropertyName:U,fallbackValue:`var(${y}, 700)`}},{name:"color",cssPropertyName:"color",value:{customPropertyName:s,fallbackValue:W}},{name:"marginTop",cssPropertyName:"margin-top",value:{customPropertyName:w,fallbackValue:"16px"}},{name:"lineHeight",cssPropertyName:"line-height",value:{customPropertyName:z,fallbackValue:`var(${N}, normal)`}},{name:"role",cssPropertyName:"role",value:"heading"},{name:"ariaLevel",cssPropertyName:"aria-level",value:"3"},{name:"outline",cssPropertyName:"outline",value:{customPropertyName:B}},{name:"backgroundColor",cssPropertyName:"background-color",value:{customPropertyName:x,fallbackValue:`var(${S}, transparent)`}}]],["Body",[{name:"fontFamily",cssPropertyName:"font-family",value:{customPropertyName:A,fallbackValue:G}},{name:"fontSize",cssPropertyName:"font-size",value:{customPropertyName:O,fallbackValue:`var(${p}, 14px)`}},{name:"fontWeight",cssPropertyName:"font-weight",value:{customPropertyName:H,fallbackValue:`var(${m})`}},{name:"color",cssPropertyName:"color",value:{customPropertyName:L,fallbackValue:`var(${b}, ${a.neutralPrimary})`}},{name:"lineHeight",cssPropertyName:"line-height",value:{customPropertyName:q,fallbackValue:`var(${P}, normal)`}},{name:"outline",cssPropertyName:"outline",value:{customPropertyName:I}},{name:"backgroundColor",cssPropertyName:"background-color",value:{customPropertyName:x,fallbackValue:`var(${S}, transparent)`}}]]];class K extends i.EventEmitter{get Disposable(){return this}dispose(){delete this._themeName,delete this.appThemeProperties,delete this.appTextStyles}get Theming(){return this}get themeName(){return this._themeName}set themeName(e){e!==this._themeName&&(this._themeName=e,this.emit("themeNameChanged"))}set themeProperties(e){this.setThemeProperties(new Map(e))}constructor(){super(),this.setMaxListeners(0),this.appTextStyles=new Map(J)}get StylingProvider(){return this}get themeProperties(){return this.appThemeProperties}get textStyles(){return this.appTextStyles}setThemeProperties(e){const t=this.appThemeProperties?new Map(this.appThemeProperties):void 0;this.appThemeProperties=e,this.emit("themePropertiesChanged",t)}setTextStyles(e){const t=this.appTextStyles?new Map(this.appTextStyles):void 0;this.appTextStyles=e,this.emit("textStylesChanged",t)}}var Q=r(31942);const Y=1e4;class Z{get NamespaceLogger(){return this}get PersistedProperties(){return this}constructor(e,t){this.namespace=t,this.persistentProps=e||{},this.namespace=t}send(e){this.sendWithNamespace(e,this.namespace)}sendWithNamespace(e,t){const r=t||this.namespace;let{category:o,...n}={...this.persistentProps,...e},i=!1;n.sampleEvent&&(i=Boolean(n.sampleEvent),delete n.sampleEvent);const s=Object.keys(n).length>100;"error"!==o&&"Error"!==o||(n=(e=>{let t;return"string"===typeof e.message&&e.message.length>Y&&(t="message",e.message=e.message.substr(0,Y)),"string"===typeof e.stack&&e.stack.length>Y&&(t=t?t.concat(", stack"):"stack",e.stack=e.stack.substr(0,Y)),t?{...e,cappedFields:t}:e})(n)),this.logEvent({category:o,props:{...n,exceedsMaxAllowedFields:s},sampleEvent:i,namespace:r})}addPersistedProperties(e){this.persistentProps={...this.persistentProps,...e}}getPersistedProperties(){return{...this.persistentProps}}}var X=r(15851);const ee=new class{logEvent(e){if(e.category===X.hB.Error)console.error("%cPurple: %cSession_Id:%s %s","color: purple; font-style: italic","",this.sessionId,JSON.stringify(e));else console.log("%cPurple: %cSession_Id:%s %s","color: purple; font-style: italic","",this.sessionId,JSON.stringify(e))}setSessionId(e){this.sessionId=e}setUserContext(e){}shutdown(){}loadFull(){return Promise.resolve()}loadAsha(){}constructor(){this.sessionId=""}};var te=r(50406),re=r(90589),oe=r(37450),ne=r(12283),ie=r(82770),se=r(93916);const ae="VetoMissingClassification",ce=[{pillar:"Open",vetos:["LoadFailed"]},{pillar:"Interruptions",vetos:["UnhandledError","UnhandledRejection"]}];function de(e){for(const t of ce)if(t.vetos.includes(e))return t.pillar;return ae}const le={token:"6a8929bcfc6d44e9b13fee392ada9cf0-4dea6a88-32c5-404b-8af1-4a43b94ef559-7393",directNumericMeasurementToken:"970a2f2bd232416db9f00ce2dc4e0490-505d1603-e4f2-4da4-9ba3-13325ddc1915-7112",namespacePrefix:"Office.Fluid"},ue={token:"742fa5a288b045e5beab1a2b8e445a71-66618038-43f3-4a1f-a680-59d90da7d572-7251",directNumericMeasurementToken:"970a2f2bd232416db9f00ce2dc4e0490-505d1603-e4f2-4da4-9ba3-13325ddc1915-7112",namespacePrefix:"Office.Fluid"},he={token:"954f09bf2c8a4321823cdeae34562b5c-d0886c33-e264-4c84-8ae5-a767e01b42cb-7479",namespacePrefix:"Office.Fluid.Workspaces"};function ge(e){return function(){let e=!1;try{e=!!localStorage.getItem("FluidCodeDetailsOverride")}catch{}return e}()||function(e){return"Local"===e||"Automation"===e||"SyntheticTraffic"===e||"Development"===e}(e)?ue:le}class pe{constructor(e,t,r){this.initialPersistentProps=t,this.ashaLoadStarted=!1,this.telemetryLogger=new te.GV(void 0,void 0,this.getTelemetryConfig(e)),this.telemetryLogger.partAFields.push((0,re.m9)("Loop.Audience",e)),this.ariaInfo=r?.useFluidWorkspacesAriaInfo?he:ge(e),this.telemetryLogger.setTenantToken(this.ariaInfo.namespacePrefix,this.ariaInfo.token,te.di),this.isNonProductionAudience(e)&&this.registerOtelErrorsListener()}async logEvent(e){let{namespace:t,category:r,props:o,sampleEvent:n}=e;if(r===X.hB.UserAction)this.logUserActionEventToOtel(e);else if(r===X.hB.Activity)this.logActivityEventToOtel(e);else if(r===X.hB.DNM)this.ariaInfo.directNumericMeasurementToken&&this.logDNMEventToOTel(e);else{if(["AshaPillarAdd","AshaPillarRemove","AshaError"].includes(o.eventName))return this.loadAsha(),void this.ashaUtils?.then(t=>{let{handleAshaEvent:r}=t;return r(e)}).catch(()=>{this.logDefaultEventToOtel({category:X.hB.Error,namespace:t,props:{eventName:`${o.eventName}Failure`},sampleEvent:n})});r===X.hB.Error&&function(e){return"eventName"in e&&"veto"in e}(o)&&(o=function(e){return{...e,pillar:e.pillar??de(e.veto),isIntentional:e.isIntentional??!1,isInternal:e.isInternal??!0,alertOnPillar:e.alertOnPillar??!0,isSessionEndingError:e.isSessionEndingError??!1}}(o)),this.logDefaultEventToOtel({namespace:t,category:r,props:o,sampleEvent:n})}}shutdown(){this.ashaUtils?.then(e=>{let{shutdownAshaForFluid:t}=e;return t()}).catch(()=>{this.logDefaultEventToOtel({category:X.hB.Error,props:{eventName:"AshaShutdownFailure"}})})}logDefaultEventToOtel(e){this.logEventToOtelInternal(e,t=>{this.prepareDefaultOtelEvent(t,e)})}logActivityEventToOtel(e){this.logEventToOtelInternal(e,t=>{this.prepareActivityOtelEvent(t,{...e.props})})}logUserActionEventToOtel(e){this.logEventToOtelInternal(e,t=>{this.prepareUserActionOtelEvent(t,{...e.props},e.namespace)})}logDNMEventToOTel(e){const t=e.props.eventName,r=e.props.dataName,o=e.props.dataMeasurement;if("string"!==typeof t||"string"!==typeof r||"number"!==typeof o&&"boolean"!==typeof o)return;const n={eventName:t,dataName:r,dataMeasurement:o,dataType:e.props.dataType,interval:e.props.interval};this.logDirectNumericMeasurementEvent(n)}logDirectNumericMeasurementEvent(e){const t=[];switch(e.dataType){case X.Qq.Bool:t.push((0,re.LK)(e.dataName,e.dataMeasurement));break;case X.Qq.Double:t.push((0,re.ip)(e.dataName,e.dataMeasurement));break;case X.Qq.Int64:t.push((0,re.Ug)(e.dataName,e.dataMeasurement))}if(!e.eventName||0===e.eventName.length)return;const r=e.eventName[0].toUpperCase()+e.eventName.slice(1),o={telemetryProperties:{dnmToken:this.ariaInfo.directNumericMeasurementToken,dnmInterval:e.interval,dnmAllowedPartA:[3,4,5,1]},eventName:"Office.DNM.Loop."+r,eventFlags:{dataCategories:oe.o.DataCategories.ProductServicePerformance,diagnosticLevel:oe.o.DiagnosticLevel.RequiredServiceData},dataFields:t};this.telemetryLogger.sendDirectNumericEvent(o)}getTelemetryConfig(e){const t={enableQueue:!0};return this.isNonProductionAudience(e)?t:{...t,disableValidation:!0}}isNonProductionAudience(e){return"Automation"===e||"Local"===e||"Staging"===e}registerOtelErrorsListener(){(0,ne.d$)().addListener(e=>{0===e.category&&0===e.level&&console.error(e.message())})}getDataFieldsFromProps(e){const t=[];if(Object.keys(e).forEach(r=>{const o=(0,se.R)(e[r],r);o&&t.push(o)}),e.dataFields){const r=e.dataFields;t.push(...r)}return t}logEventToOtelInternal(e,t){const r=this.getBasicOtelEvent(e);t(r),this.telemetryLogger.sendTelemetryEvent(r)}getBasicOtelEvent(e){let t=e.category&&`${e.category.charAt(0).toUpperCase()}${e.category.substring(1)}`;e.props.subCategory&&e.category===X.hB.Generic&&(t+=`.${e.props.subCategory.charAt(0).toUpperCase()}${e.props.subCategory.substring(1)}`);let r=!1;return e.sampleEvent&&(r=e.sampleEvent),{eventName:`${this.ariaInfo.namespacePrefix}${e.namespace?"."+e.namespace:""}.${t}`,eventFlags:{diagnosticLevel:oe.o.DiagnosticLevel.RequiredServiceData,samplingPolicy:r?oe.o.SamplingPolicy.Measure:void 0}}}prepareDefaultOtelEvent(e,t){e.eventFlags.dataCategories=oe.o.DataCategories.ProductServicePerformance,e.dataFields=this.getDataFieldsFromProps({...t.props})}mapActivityResultTypeToCode(e){switch(e){case X.Tp.Failure:return 0;case X.Tp.Success:return 1;case X.Tp.Cancelled:return 2}}prepareBaseActivityOtelEvent(e,t,r){t.durationMs||(t.durationMs=0);const o=Math.floor(1e3*t.durationMs),{durationMs:n,succeeded:i,resultType:s,...a}=t;return e.eventContract={name:ie.Il.contractName,dataFields:ie.Il.getFields({duration:o,count:1,aggMode:0,success:i,result:!r&&s?{code:this.mapActivityResultTypeToCode(s),type:s}:void 0})},a}prepareActivityOtelEvent(e,t){const r=t.eventName;e.eventName+=`.${r.charAt(0).toUpperCase()}${r.substring(1)}`,e.eventFlags.dataCategories=oe.o.DataCategories.ProductServicePerformance;const o=this.prepareBaseActivityOtelEvent(e,t,!1);e.dataFields=this.getDataFieldsFromProps(o||{})}prepareUserActionOtelEvent(e,t,r){const o=t.eventName;e.eventName+=`.${o.charAt(0).toUpperCase()}${o.substring(1)}`,e.eventFlags.dataCategories=oe.o.DataCategories.ProductServiceUsage;const n=ie.rh.getFields("Funnel",{name:r,state:"Successful"}),i=t,s=ie.ay.getFields({id:i.actionId,name:o,commandSurface:i.commandSurface,parentName:i.parentName,triggerMethod:i.triggerMethod,timeOffsetMs:i.timeOffsetMs}),a=this.prepareBaseActivityOtelEvent(e,t,!0),{eventName:c,actionId:d,commandSurface:l,parentName:u,triggerMethod:h,timeOffsetMs:g,...p}=a;e.dataFields=[...n,...s,...this.getDataFieldsFromProps(p||{})]}loadAsha(){this.ashaLoadStarted||(this.ashaLoadStarted=!0,this.ashaUtils=r.e(59941).then(r.bind(r,93401)),this.ashaUtils.then(e=>{let{initializeAshaForFluid:t}=e;return t(this.ariaInfo.namespacePrefix,this.initialPersistentProps,e=>{delete e.eventContract,this.telemetryLogger.sendTelemetryEvent(e)})}).catch(()=>{this.ashaLoadStarted=!1,this.logDefaultEventToOtel({category:X.hB.Error,props:{eventName:"AshaLoadFailure"}})}))}}class me extends pe{constructor(e,t,r,o){super(t,r,o),this.hostTelemetrySink=e,this.loadFullCalled=!1}setUserContext(e){}replaceTelemetrySink(e){this.hostTelemetrySink=e,this.telemetryLogger.telemetrySinks.pop(),this.telemetryLogger.addSink(e),this.telemetryLogger.flushQueue()}async loadFull(){if(!this.loadFullCalled){this.loadFullCalled=!0;try{const e=await this.hostTelemetrySink;this.telemetryLogger.addSink(e),this.telemetryLogger.flushQueue()}catch(e){this.logDefaultEventToOtel({category:X.hB.Error,props:{eventName:"FailedToLoadTelemetrySink",message:`${e}`}})}}}}class fe{constructor(e){this.telemetrySink=e}get Disposable(){return this}dispose(){}get LoopTelemetrySink(){return this}sendTelemetryEvent(e,t){this.telemetrySink.sendTelemetryEvent(e,t)}sendCustomerContent(e){this.telemetrySink.sendCustomerContent?.(e)}sendNonStandardEvent(e,t){this.telemetrySink.sendNonStandardEvent?.(e,t)}}var ve=r(95996);class ye extends pe{constructor(e,t){const r=(0,ve.LJ)(e.audience),o=r?t:{...t,hostCorrelationId:""};super(e.audience,o),this.context=e,this.loadFullCalled=!1,this.allowedToLogEupi=!1,this.loopTelemetrySinkPromise=new Promise(e=>this.loopTelemetrySinkPromiseResolve=e),this.allowedToLogEupi=r,this.scrubContextIfNecessary()}getLoopTelemetrySinkPromise(){return this.loopTelemetrySinkPromise.then()}async logEvent(e){return this.allowedToLogEupi||(e.props={...e.props,hostCorrelationId:""}),e.category===X.hB.Error&&(this.loadFullCalled||this.loadFull().catch(()=>{})),super.logEvent(e)}scrubContextIfNecessary(){this.allowedToLogEupi||(this.context.sessionId="",this.context.user=void 0)}setUserContext(e){this.context={...this.context,...e},this.scrubContextIfNecessary(),this.telemetrySink?.setPartADataFields(this.context)}shutdown(){super.shutdown(),this.loadFull().then(()=>this.telemetrySink?.shutdown()).catch(()=>{})}async loadFull(){this.loadFullCalled||(this.loadFullCalled=!0,Promise.all([r.e(55307),r.e(26873)]).then(r.bind(r,14698)).then(e=>{this.telemetrySink=new e.OfficeFluidOneDsSink(this.context);const t=this.telemetrySink.createOneDsSink();this.telemetryLogger.addSink(t),this.telemetryLogger.flushQueue(),this.loopTelemetrySinkPromiseResolve?.(new fe(t))}).catch(e=>{this.logDefaultEventToOtel({category:X.hB.Error,props:{eventName:"LoggerLoadFailure",message:e.message,stack:e.stack}})}))}}class be extends Z{get Disposable(){return this}get PersistedProperties(){return this}getTelemetrySinkPromise(){return this.telemetrySinkPromise.then()}constructor(e){const t=e.hostTelemetryContext,r={...e.persistentProps,hostCorrelationId:t.hostCorrelationId,hostScenarioName:[t.hostScenarioLifecycle,t.hostScenarioName,t.hostScenarioEntryPoint].filter(e=>e).join("_"),hostName:t.hostName,hostScenarioStartTime:t.hostScenarioStartTime,loopAudience:e.audience,hostSessionId:t.hostSessionId,hostAppVersion:t.hostAppVersion,hostAppPlatform:t.hostAppPlatform};super(r,e.namespace),this.forceTelemetryToConsole=!1,this.dispose=()=>{this.logProcessors.forEach(e=>e.shutdown())},this.shutdown=()=>{this.Disposable.dispose()};const{delayLoadLogger:o,hostTelemetrySink:n}=e;this.audience=e.audience,this.logProcessors=[...e.additionalLogProcessors||[]];try{this.forceTelemetryToConsole="1"===localStorage.getItem("debugPurple"),this.forceTelemetryToConsole&&(ee.setSessionId(e.hostTelemetryContext.hostSessionId),this.logProcessors.push(ee))}catch{}if(n)this.telemetrySinkPromise=Promise.resolve(n).then(e=>new fe(e)),this.logProcessors.push(new me(n,this.audience,r,{useFluidWorkspacesAriaInfo:e.useFluidWorkspacesAriaInfo}));else{this.sendWithNamespace({eventName:"HostPassedTelemetrySinkNotPassed",sinkPassed:!1,category:"Error",sampleEvent:!0},"HostPassedTelemetrySink");const o=new ye({appPlatform:t.hostAppPlatform,appName:t.hostAppName,appVersion:t.hostAppVersion,user:t.userContext?.user,sessionId:t.hostSessionId,audience:this.audience,uiLanguage:e.hostTelemetryContext.uiLanguage},r);this.telemetrySinkPromise=o.getLoopTelemetrySinkPromise(),this.logProcessors.push(o)}if(o||this.loadFull().catch(()=>{}),e.hostMetadata&&!e.skipInitializationLogs){const{hostMetadata:t}=e,r=t.hostFlights,o=t.hostFlightsMetadata;this.sendWithNamespace({eventName:"HostMetadata",hostRing:t.hostRing,hostFlights:r&&JSON.stringify(r),hostFlightsMetadata:o&&JSON.stringify(o),category:"Generic"},"HostMetadata")}}async loadFull(){try{await Promise.allSettled([this.logProcessors.map(e=>e.loadFull())])}catch{}}setUserContext(e){this.logProcessors.forEach(t=>t.setUserContext(e))}logEvent(e){this.logProcessors.forEach(t=>t.logEvent(e));if("Local"===this.audience){const t="UnhandledError"!==e.props.eventName&&"UnhandledRejection"!==e.props.eventName,r=e.category===X.hB.Error||e.category===X.hB.Activity&&!1===e.props.succeeded;t&&r&&!this.forceTelemetryToConsole&&console.error("OfficeFluidLogger %s %s event:",e.props.eventName,e.category,e.props,e.props.stack)}}addPersistedProperties(e){super.addPersistedProperties(e),r.e(59941).then(r.bind(r,93401)).then(t=>{let{updateAshaAdditionalPartCEventDataFromTelemetryProperties:r}=t;return r(e)}).catch(()=>{this.send({category:"Error",eventName:"AshaUpdatePartCEventDataFailure"})})}}var Se=r(52563),Ce=r(63854);function ke(e){var t;t=e?.dir,document.documentElement.setAttribute("dir",t||(0,Ce.Gz)(Se.q)),document.documentElement.setAttribute("lang",e?.lang||Se.q),document.documentElement.setAttribute("translate","no")}var we=r(58443),Pe=r(69235),Te=r(899),Ee=r(64643),Ne=r(56142),Ie=r(91947),De=r(4311),Fe=r(6971),Be=r(24921);class Le{get notify(){return this._notify}set notify(e){this._notify=e,this.notifySizeChanged()}get currentHeight(){return this.height}constructor(e,t,r,o,n){this.beforeNotify=void 0,this.useDevicePixelRatio=void 0,this.hasSizeChanged=!1,this.width=0,this.height=0,this.isNotifying=!1,this.layoutMode=Q.S.fixedByHost,this._notify=!0,this.resizeObserver=void 0,this.sizeChanged=void 0,this.loopWidth=0,this.loopDiv=void 0,this.useLoopContentWidth=!1,this.savedDevicePixelRatio=0,this.beforeNotify=this.waitBeforeNotifying,this.layoutMode=t,this.notify=r,this.sizeChanged=o,this.useLoopContentWidth=null!==n&&void 0!==n&&n,this.observeResize(e)}observeWidthChangeFromLoop(e){this.useLoopContentWidth&&(this.loopDiv=e,this.updateAndNotify(this.width,this.height))}updateAndNotify(e,t){let r=0;if(this.loopDiv){const e=20,t=this.loopDiv.offsetWidth;if(r=(t+e)*(this.useDevicePixelRatio?devicePixelRatio:1),this.useDevicePixelRatio){if(this.savedDevicePixelRatio>0&&devicePixelRatio>=this.savedDevicePixelRatio){const e=this.loopWidth*devicePixelRatio/this.savedDevicePixelRatio;e>r&&(r=e)}this.savedDevicePixelRatio=devicePixelRatio}(0,Ne.Rm)(`content width: ${t}, adjusted: ${r}, devicePixelRatio: ${this.savedDevicePixelRatio}`)}t==this.height&&r==this.loopWidth&&e==this.width||(this.width=e,this.height=t,this.loopWidth=r,this.hasSizeChanged=!0,this.notifySizeChanged())}async notifySizeChanged(){if(this.layoutMode!=Q.S.fixedByHost&&!this.isNotifying)for(;this.notify&&this.hasSizeChanged;){this.hasSizeChanged=!1,this.isNotifying=!0;try{await this.beforeNotify(),this.hasSizeChanged&&(Le.isVerboseLoggingEnabled&&(0,Ne.Rm)("Size changed while waiting."),this.hasSizeChanged=!1),Le.isVerboseLoggingEnabled&&(0,Ne.Rm)(`Notifying about size change (${this.width} x ${this.height}), loopWidth: ${this.loopWidth}...`),this.useLoopContentWidth?await this.sizeChanged(this.loopWidth,this.height,this.layoutMode):await this.sizeChanged(this.width,this.height,this.layoutMode)}catch(e){}this.isNotifying=!1}}observeResize(e){this.layoutMode!=Q.S.fixedByHost&&e&&(this.resizeObserver=new ResizeObserver(async e=>{await this.resizeObserverCallback(e)}),this.resizeObserver.observe(e))}async resizeObserverCallback(e){if(void 0===this.useDevicePixelRatio){var t;const e=await(0,Fe.E)();this.useDevicePixelRatio=null!==(t=null===e||void 0===e?void 0:e.useDevicePixelRatio)&&void 0!==t&&t}if(e.length>0){const t=e[e.length-1];let n,i;var r,o;if(this.useDevicePixelRatio){if(n=Math.ceil(t.contentRect.height*devicePixelRatio),i=Math.ceil(t.contentRect.width*devicePixelRatio),Le.isVerboseLoggingEnabled)(0,Ne.Rm)(`Device pixel ratio: ${devicePixelRatio}`),(0,Ne.Rm)("ResizeObserverEntry:"),(0,Ne.Rm)(`  .contentRect =                    ${t.contentRect.width} W x ${t.contentRect.height} H`),null===(r=t.contentBoxSize)||void 0===r||r.forEach((e,t)=>(0,Ne.Rm)(`  .contentBoxSize[${t}] =              ${e.inlineSize} W x ${e.blockSize} H`)),null===(o=t.devicePixelContentBoxSize)||void 0===o||o.forEach((e,t)=>(0,Ne.Rm)(`  .devicePixelContentBoxSize[${t}] =   ${e.inlineSize} W x ${e.blockSize} H`)),(0,Ne.Rm)(`  .contentRect * devicePixelRatio = ${t.contentRect.width*devicePixelRatio} W x ${t.contentRect.height*devicePixelRatio} H`)}else n=Math.ceil(t.contentRect.height),i=Math.ceil(t.contentRect.width);if(this.useLoopContentWidth)return this.updateAndNotify(i,n);if(n!=this.height||i!=this.width)return this.height=n,this.width=i,this.hasSizeChanged=!0,we.Nu||(0,Ne.Rm)(`Observed size change. ${this.width} W x ${this.height} H  (devicePixelRatio: ${devicePixelRatio})`),this.notifySizeChanged()}}setBeforeNotifyFunction(e){this.beforeNotify=e}async waitBeforeNotifying(){Le.isVerboseLoggingEnabled&&(0,Ne.Rm)(`Waiting for ${Le.delayBeforeSizeChanged} ms before notifying about size change (${this.width} x ${this.height}, content width: ${this.loopWidth})...`),await(0,Be.y)(Le.delayBeforeSizeChanged),Le.isVerboseLoggingEnabled&&(0,Ne.Rm)("Finished waiting.")}}Le.delayBeforeSizeChanged=10,Le.isVerboseLoggingEnabled=!1;var xe=r(60119),Ae=r(90662),Oe=r(96826),Me=r(31482),_e=r(20930),Re=r(83736);class He extends i.EventEmitter{constructor(){super(),this.setMaxListeners(0)}get Disposable(){return this}dispose(){delete this.appThemeName,delete this.appThemeProperties}get Theming(){return this}get themeName(){return this.appThemeName}set themeName(e){e!==this.appThemeName&&(this.appThemeName=e,this.emit("themeNameChanged"))}get themeProperties(){return this.appThemeProperties}set themeProperties(e){this.appThemeProperties=e,this.emit("themePropertiesChanged")}}let Ue;function je(e){switch(e){case"fixed":return Q.S.fixedByHost;case"grow":return Q.S.grow;default:return Q.S.growHeight}}function qe(e){const t=new RegExp(/\.(fluid|loop)$/,"i");return e.replace(t,"")}function ze(e){if(!e)throw new Pe.uV("A Loop url was not provided.");let t;try{t=new URL(e)}catch(o){throw new Pe.uV("The Loop url that was provided is not a valid url.")}const r=t.protocol;if(!r||"https:"!==r.toLowerCase())throw new Pe.uV("The Loop url must use the HTTPS protocol.")}function Ve(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t&&!e.ctrlKey&&(e.preventDefault(),(0,Ie.Jc)()),r&&!e.ctrlKey&&e.preventDefault()}async function $e(e){const t=(0,Se.rv)(e.toLowerCase()),r=(0,Ce.Gz)(t);ke({lang:t,dir:r});const o=await(0,Ee.q)(),n="OneNote"===Ye((0,Te.xE)().appName);return{localization:{locale:t,localeDirection:r,stringOverrides:{permissionsPanelPeopleOutsideWithLinkText:n?o.CustomPermissionsPanelPeopleOutsideWithLinkText_OneNote:o.CustomPermissionsPanelPeopleOutsideWithLinkText_Default,permissionsPanelSpecificPermissionText:n?o.CustomPermissionsPanelSpecificPermissionText_OneNote:o.CustomPermissionsPanelSpecificPermissionText_Default,permissionsPanelPeopleOutsideText:n?o.CustomPermissionsPanelPeopleOutsideText_OneNote:o.CustomPermissionsPanelPeopleOutsideText_Default,permissionsPanelSomePeopleText:n?o.CustomPermissionsPanelSomePeopleText_OneNote:o.CustomPermissionsPanelSomePeopleText_Default}},internationalizationContext:{get InternationalizationContext(){return this},uiLocale:t,defaultContentDirection:r}}}function Ge(e,t,r){const o=function(e){const t={};if(null!==e&&void 0!==e&&e.audienceGroup||null!==e&&void 0!==e&&e.channel){var r,o;const n=null!==(r=null===e||void 0===e?void 0:e.audienceGroup)&&void 0!==r?r:"Unknown",i=null!==(o=null===e||void 0===e?void 0:e.channel)&&void 0!==o?o:"Unknown";t.hostRing=`${n}/${i}`}return t}(t);return new be({hostTelemetryContext:e,hostTelemetrySink:xe.a,audience:r,hostMetadata:o})}function We(e,t,r,i){const s=(0,Ae.h2)(t),a=new Map(s.properties);let c;if(r){const r=(0,Re.b)(e,t);c=(0,_e.m)(r)}else c=(0,_e.m)({fluentThemeV9:t?Oe.C:Me.o});const d=new Map;c.forEach(e=>{d.set(e.name,e.value)});const l=new Map([...d.entries(),...a.entries()]);let u;i&&(u=new He,u.themeProperties=l);const h=new K;null===h||void 0===h||h.setThemeProperties(l);const g=[];for(const[o,n]of a)g.push({name:o,value:n});const p=g.concat(c),m=(0,o.x)(p),f=(0,n.w)(p);var v,y;t&&(null===(v=document)||void 0===v||null===(y=v.body)||void 0===y||y.style.setProperty("background-color",Ae.kc));return{stylingProvider:h,initialTheme:m,initialThemeV9:f,theming:u}}async function Je(e,t){return await(0,De.RG)(new URL(e)).catch(e=>((0,Ne.vV)(`Unable to get fluid file name from Sharepoint.\n${(0,Pe.u1)(e)}`),null))||function(e){try{const t=/^.*[/\\]([^/\\]+)$/,r=new URL(e).pathname,o=t.exec(r);if(o&&o.length>1){const e=decodeURIComponent(o[1]);if(e.endsWith(we.g4)||e.endsWith(we.Ct))return e}}catch(t){}return null}(e)||t||""}function Ke(e,t){const r=document.documentElement;Ue=r?new Le(r,e,!1,Ie.CQ,t):void 0}function Qe(e){switch(e){case"Automation":case"Local":case"Staging":case"SyntheticTraffic":return{audience:"Staging"};case"Dogfood":return{audience:"Dogfood"};case"Microsoft":return{audience:"Microsoft"};case"Preview":return{audience:"Preview"};case"DoD":case"GCC":case"GCC-High":case"Production":return{audience:"Production"};default:return we.Nu||(0,Ne.vV)(`Audience ${e} is not a known value.`),{audience:"Production"}}}function Ye(e){switch(e){case"Demo App":case"Demo Host":case"Fluid Preview App":case"Loop App":case"Office.com":case"OfficeMobile":case"OneNote":case"Outlook":case"Scriptor Pad":case"Teams":case"Whiteboard":case"Word":return e;default:return we.Nu||(0,Ne.Rm)(`"${e}" is not a valid app name, set to Unknown`),"Unknown"}}function Ze(e,t,r,o){const n=(0,Te.xE)(),i=function(e){switch(null===e||void 0===e?void 0:e.toLowerCase()){case"android":return"Android";case"ios":return"iOS";case"mac":return"Mac";case"web":return"Web";case"win32":return"Win32";default:throw new Error(`"${e}" is not a valid app platform.`)}}(n.platform),s=Ye(n.appName);return(0,Ne.Rm)(`Fluid host context: {\n  correlationId: ${t}, \n  hostAppName: ${s} \n  hostAppPlatform: ${i} \n  hostAppVersion: ${n.appVersion}, \n  scenarioLifecycle: ${o.lifecycle}, \n  scenarioName: ${o.name}, \n  scenarioEntryPoint: ${o.entryPoint}, \n}`),{hostName:`${n.appName}_${i}`,hostAppName:s,hostAppPlatform:i,hostSessionId:e,hostCorrelationId:t,uiLanguage:r,hostAppVersion:n.appVersion,hostScenarioEntryPoint:o.entryPoint,hostScenarioLifecycle:o.lifecycle,hostScenarioName:o.name,hostScenarioStartTime:o.startTime,userContext:{}}}},90589:(e,t,r)=>{"use strict";function o(e,t,r){return a(e,1,t,r)}function n(e,t,r){return a(e,2,t,r)}function i(e,t,r){return a(e,3,t,r)}function s(e,t,r){return a(e,0,t,r)}function a(e,t,r,o){return{name:e,dataType:t,value:r,classification:o||4}}r.d(t,{LK:()=>o,Ug:()=>n,ip:()=>i,m9:()=>s})},90662:(e,t,r)=>{"use strict";r.d(t,{kc:()=>d,h2:()=>g,mz:()=>s,d8:()=>c,D8:()=>a,g4:()=>h,fB:()=>p});r(899);var o=r(90140);let n=function(e){return e[e.Default=0]="Default",e[e.Dark=1]="Dark",e}({});const i=new Map([[n[n.Default],{name:"Default Theme",properties:[]}],[n[n.Dark],{name:"Dark Theme",properties:[[o.Ve.black,"#ffffff"],[o.Ve.white,"#262626"],[o.Ve.neutralDark,"#ffffff"],[o.Ve.neutralPrimary,"#ffffff"],[o.Ve.neutralPrimaryAlt,"#f8f8f8"],[o.Ve.neutralSecondary,"#f4f4f4"],[o.Ve.neutralTertiary,"#eaeaea"],[o.Ve.neutralTertiaryAlt,"#c8c8c8"],[o.Ve.neutralQuaternary,"#2e2e2e"],[o.Ve.neutralLight,"#000000"],[o.Ve.neutralQuaternaryAlt,"#2e2e2e"],[o.Ve.neutralLighter,"#212121"],[o.Ve.neutralLighterAlt,"#363636"],[o.Ve.redDark,"#e81123"],[o.Ve.purple,"#9c89e9"],[o.Ve.themeDarker,"#cfd3d5"],[o.Ve.themeDark,"#bcd6e6"],[o.Ve.themeDarkAlt,"#afd8f0"],[o.Ve.themePrimary,"#79b0c8"],[o.Ve.themeSecondary,"#588b9e"],[o.Ve.themeTertiary,"#597c87"],[o.Ve.themeLight,"#495e66"],[o.Ve.themeLighter,"#485b60"],[o.Ve.themeLighterAlt,"#3c4547"],[o.Ve.EntityRecognitionUnderline,"#8a8886"],[o.Ve.EntityRecognitionHoverHighlight,"#3b3a39"],[o.Ve.TaskRecognitionUnderline,"#8a8886"],[o.Ve.TaskRecognitionHoverHighlight,"#3b3a39"],[o._D.ThemeName,o.aM.Dark],[o.KM.MessageText,"#323130"],[o.KM.ErrorBackground,"#FDE7E9"],[o.KM.ErrorIcon,"#F75E75"],[o.KM.SuccessBackground,"#262626"],[o.KM.SuccessIcon,"#107C10"],[o.KM.WarningBackground,"#FFF4CE"],[o.KM.WarningIcon,"#797775"],[o.KM.SevereWarningBackground,"#FED9CC"],[o.KM.SevereWarningIcon,"#D83B01"],[o.KM.InfoBackground,"#292929"],[o.KM.InfoIcon,"#605e5c"]]}]]),s="#e49fff",a="#EB0000",c="#FF4D4D",d="#262626",l="#ffffff";let u=function(e){return e[e.Colorful=0]="Colorful",e[e.VeryDark=1]="VeryDark",e[e.Black=2]="Black",e[e.Fresh=3]="Fresh",e}({});function h(e){return e===u.Black}function g(e){return e?i.get(n[n.Dark])||{name:"Default Theme",properties:[]}:i.get(n[n.Default])||{name:"Default Theme",properties:[]}}function p(e){var t,r;null===(t=document)||void 0===t||null===(r=t.body)||void 0===r||r.style.setProperty("background-color",e?d:l)}},90846:(e,t,r)=>{"use strict";r.d(t,{f:()=>b});var o=r(15217);const n=432e6;var i=r(50178),s=r(39773),a=r(69649);const c="fluidDriverCache",d="driverStorage.V3",l={1:"diverStorage",2:"diverStorage.V2"};function u(e){return`${e.file.docId}_${e.type}_${e.key}`}function h(e){return new Promise((t,r)=>{(0,a.P2)(c,3,{upgrade:(t,r)=>{try{const e=l[r];e&&t.deleteObjectStore(e)}catch(n){(0,i.pW)({logger:e}).sendErrorEvent({eventName:"FluidCacheDeleteOldDbError"},n)}const o=t.createObjectStore(d);o.createIndex("createdTimeMs","createdTimeMs"),o.createIndex("lastAccessTimeMs","lastAccessTimeMs"),o.createIndex("partitionKey","partitionKey"),o.createIndex("fileId","fileId")},blocked:()=>{r(new Error("Could not open DB since it is blocked by an older client that has the DB open"))}}).then(t,r)})}const g="2.51.0";let p=[],m=!1;function f(e){p.push({task:e}),v(2e3)}function v(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!m){if(self.requestIdleCallback)self.requestIdleCallback(y);else{const t=Date.now()+50;self.setTimeout(()=>y({timeRemaining:()=>Math.max(t-Date.now(),0),didTimeout:!1}),e)}m=!0}}function y(e){!function(e,t){const r=[];for(const[o,n]of p.entries()){if(t&&!t()){r.push(...p.slice(o));break}e&&!e(n)?r.push(n):n.task()}p=r}(void 0,()=>e.timeRemaining()>10),m=!1,p.length>0&&v()}class b{constructor(e){this.closeDbImmediately=!0,this.dbReuseCount=-1;const{logger:t,partitionKey:r,maxCacheItemAge:o,closeDbAfterMs:a}=e;if(this.logger=(0,i.pW)({logger:t}),this.partitionKey=r,o>n){const e=new s.eb(`maxCacheItemAge(${o}) cannot be greater than 432000000`,{maxCacheItemAge:o,maximumCacheDurationMs:n,pkgVersion:g});this.logger.sendErrorEvent({eventName:"maxCacheItemAgeTooLarge",subCategory:"FluidCache"},e)}this.maxCacheItemAge=Math.min(o,n),this.closeDbAfterMs=a??0,this.closeDbAfterMs>0&&(this.closeDbImmediately=!1),f(async()=>{if(navigator.storage?.estimate){const e=await navigator.storage.estimate();let t;"usageDetails"in e&&(t=e.usageDetails.indexedDB),this.logger.sendTelemetryEvent({eventName:"FluidCacheStorageInfo",subCategory:"FluidCache",quota:e.quota,usage:e.usage,indexedDBSize:t,pkgVersion:g})}}),f(async()=>{let e;try{e=await h(this.logger);const t=e.transaction(d,"readwrite"),r=t.store.index("createdTimeMs"),o=await r.getAllKeys(IDBKeyRange.upperBound((new Date).getTime()-this.maxCacheItemAge));await Promise.all(o.map(e=>t.store.delete(e))),await t.done}catch(t){this.logger.sendErrorEvent({eventName:"FluidCacheDeleteOldEntriesError",pkgVersion:g},t)}finally{e?.close()}})}async openDb(){if(this.closeDbImmediately)return h(this.logger);if(void 0===this.db){const e=await h(this.logger);if(void 0!==this.db)return e.close(),this.dbReuseCount+=1,this.db;this.dbReuseCount=-1,this.db=e,this.db.onversionchange=e=>{this.db?.close(),this.db=void 0,clearTimeout(this.dbCloseTimer),this.dbCloseTimer=void 0},this.db.addEventListener("close",e=>{clearTimeout(this.dbCloseTimer),this.dbCloseTimer=void 0,this.db=void 0}),(0,o.vA)(void 0===this.dbCloseTimer,1734),this.dbCloseTimer=setTimeout(()=>{this.db?.close(),this.db=void 0,this.dbCloseTimer=void 0},this.closeDbAfterMs)}return(0,o.vA)(void 0!==this.db,1735),this.dbReuseCount+=1,this.db}closeDb(e){this.closeDbImmediately&&e?.close()}async removeEntries(e){let t;try{t=await this.openDb();const r=t.transaction(d,"readwrite"),o=r.store.index("fileId"),n=await o.getAllKeys(e.docId);await Promise.all(n.map(e=>r.store.delete(e))),await r.done}catch(r){this.logger.sendErrorEvent({eventName:"FluidCacheDeleteOldEntriesError",pkgVersion:g},r)}finally{this.closeDb(t)}}async get(e){const t=performance.now(),r=await this.getItemFromCache(e);return this.logger.sendPerformanceEvent({eventName:"FluidCacheAccess",cacheHit:void 0!==r,type:e.type,duration:performance.now()-t,dbOpenPerf:r?.dbOpenPerf,dbReuseCount:this.dbReuseCount,pkgVersion:g}),r?.cachedObject}async getItemFromCache(e){let t;try{const r=u(e),o=performance.now();t=await this.openDb();const n=performance.now()-o,i=await t.get(d,r);if(!i)return void this.closeDb(t);if(i.partitionKey!==this.partitionKey)return this.logger.sendTelemetryEvent({eventName:"FluidCachePartitionKeyMismatch",subCategory:"FluidCache",pkgVersion:g}),void this.closeDb(t);return(new Date).getTime()-i.createdTimeMs>this.maxCacheItemAge?void this.closeDb(t):(this.closeDb(t),{...i,dbOpenPerf:n})}catch(r){return this.logger.sendErrorEvent({eventName:"FluidCacheGetError",pkgVersion:g},r),void this.closeDb(t)}}async put(e,t){let r;try{r=await this.openDb();const o=(new Date).getTime();await r.put(d,{cachedObject:t,fileId:e.file.docId,type:e.type,cacheItemId:e.key,partitionKey:this.partitionKey,createdTimeMs:o,lastAccessTimeMs:o},u(e)),this.closeDb(r)}catch(o){this.logger.sendErrorEvent({eventName:"FluidCachePutError",pkgVersion:g},o)}finally{this.closeDb(r)}}}},90876:(e,t,r)=>{"use strict";r.d(t,{z:()=>o});const o="2.51.0"},91119:(e,t,r)=>{"use strict";r.d(t,{Cj:()=>y,iJ:()=>C});var o=r(85038),n=r(8018),i=r(21673),s=r(54813),a=r(20611),c=r(93586),d=r(63520),l=r(83533),u=r(39521),h=r(27250),g=r(14826),p=r(24217),m=r(93220),f=r(70530);var v=r(27612);const y="Odsp409Error";class b{constructor(e,t,r,o){this.cache=e,this.fileEntry=t,this.logger=r,this.clientIsSummarizer=o,this.driverId=(0,g.A)(),this.networkCallNumber=1,this.rateLimiter=new i.v(24),this.snapshotCacheExpiryTimeoutMs=(0,d.Ln)(r).config.getBoolean("Fluid.Driver.Odsp.TestOverride.DisableSnapshotCache")?0:a.Pb}setEpoch(e,t,r){(0,o.vA)(void 0===this._fluidEpoch,475),this._fluidEpoch=e,this.logger.sendTelemetryEvent({eventName:"EpochLearnedFirstTime",epoch:e,fetchType:r,fromCache:t})}async get(e){try{const t=await this.cache.get(this.fileEntryFromEntry(e));if(void 0===t||t.version!==p.F)return;if((0,o.vA)(void 0!==t.fluidEpoch,476),void 0===this._fluidEpoch)this.setEpoch(t.fluidEpoch,!0,"cache");else if(this._fluidEpoch!==t.fluidEpoch)return;if(e.type===a.o1||e.type===a.W3){const e=t.value?.cacheEntryTime,r=Date.now();if(void 0===e||r-e>=this.snapshotCacheExpiryTimeoutMs)return this.logger.sendTelemetryEvent({eventName:"odspVersionsCacheExpired",duration:r-e,maxCacheAgeMs:this.snapshotCacheExpiryTimeoutMs}),void await this.removeEntries()}return t.value}catch(t){return void this.logger.sendErrorEvent({eventName:"cacheFetchError",type:e.type},t)}}async put(e,t){(0,o.vA)(void 0!==this._fluidEpoch,477),e.type!==a.o1&&e.type!==a.W3||(t.cacheEntryTime=t.cacheEntryTime??Date.now());const r={value:t,version:p.F,fluidEpoch:this._fluidEpoch};return this.cache.put(this.fileEntryFromEntry(e),r).catch(t=>{throw this.logger.sendErrorEvent({eventName:"cachePutError",type:e.type},t),t})}async removeEntries(){try{return await this.cache.removeEntries(this.fileEntry)}catch(e){this.logger.sendErrorEvent({eventName:"removeCacheEntries"},e)}}get fluidEpoch(){return this._fluidEpoch}async validateEpoch(e,t){(0,o.vA)(void 0!==e,1412);try{this.validateEpochFromResponse(e,t)}catch(r){throw await this.checkForEpochError(r,e,t),r}}async fetchAndParseAsJSON(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=arguments.length>4?arguments[4]:void 0;return this.fetchCore(e,t,f.bf,r,o,n)}async fetch(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=arguments.length>4?arguments[4]:void 0;return this.fetchCore(e,t,f.ZR,r,o,n)}async fetchCore(e,t,r,o){let n=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5?arguments[5]:void 0;const a=this.formatClientCorrelationId(i);let d;return this.addEpochInRequest(t,n,a),this.rateLimiter.schedule(async()=>r(e,t)).then(e=>(d=e.headers.get("x-fluid-epoch"),this.validateEpochFromResponse(d,o),e.propsToLog.XRequestStatsHeader=a,e)).catch(async e=>{throw void 0===d&&(d=e.serverEpoch),await this.checkForEpochError(e,d,o),e}).catch(e=>{if((0,l.X)(e)&&e.errorType===c.E.fileNotFoundOrAccessDeniedError){const t=e.redirectLocation;if(void 0!==t){const r=function(e,t){const r={...(0,f.Yn)(e)},o=`${new URL(t).origin}${new URL(r.siteUrl).pathname}`;return r.siteUrl=o,r}(this.fileEntry.resolvedUrl,t),o=new s.c_(e.message,r,{driverVersion:v.z,redirectLocation:t});throw o.addTelemetryProperties(e.getTelemetryProperties()),o}}throw e}).catch(e=>{throw(0,u.cQ)(e,{props:{XRequestStatsHeader:a}})})}async fetchArray(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=arguments.length>4?arguments[4]:void 0;return this.fetchCore(e,t,f.cr,r,o,n)}addEpochInRequest(e,t,r){const n=(0,f.Yn)(this.fileEntry.resolvedUrl).isClpCompliantApp;if(t){const t={};t["X-RequestStats"]=r,void 0!==this.fluidEpoch&&(t["x-fluid-epoch"]=this.fluidEpoch),n&&(t[m.t.isClpCompliantApp]=n.toString()),this.addParamInBody(e,t)}else{const t=(t,r)=>{e.headers={...e.headers},(0,o.vA)(void 0!==e.headers,642),e.headers[t]=r};t("X-RequestStats",r),void 0!==this.fluidEpoch&&t("x-fluid-epoch",this.fluidEpoch),n&&t(m.t.isClpCompliantApp,n.toString())}}addParamInBody(e,t){const r=e.body;(0,o.vA)("string"===typeof r,541);const n=r.split("\r\n"),i=n.shift();(0,o.vA)(!0===i?.startsWith("--"),542);const s=[i];for(const[o,a]of Object.entries(t))s.push(`${o}: ${a}`);for(const o of n)s.push(o);e.body=s.join("\r\n")}formatClientCorrelationId(e){const t=[`driverId=${this.driverId}`,"RequestNumber="+this.networkCallNumber++,`driverVersion=${v.z}`,`isSummarizer=${this.clientIsSummarizer}`];return void 0!==e&&t.push(`fetchReason=${e}`),t.join(", ")}validateEpochFromResponse(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=this.checkForEpochErrorCore(e);if(void 0!==o)throw o;void 0!==e&&void 0===this._fluidEpoch&&this.setEpoch(e,r,t)}async checkForEpochError(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if((0,l.X)(e)&&e.errorType===c.E.fileOverwrittenInStorage){const n=this.checkForEpochErrorCore(t);if(void 0!==n)throw n.addTelemetryProperties({fromCache:o,fetchType:r}),this.logger.sendErrorEvent({eventName:"fileOverwrittenInStorage"},n),await this.removeEntries(),n;throw(0,u.J4)(e,e=>new s.Gi(`Coherency 409: ${e}`,1,{[y]:!0,driverVersion:v.z}))}}checkForEpochErrorCore(e){if(this.fluidEpoch&&e&&this.fluidEpoch!==e)return new s.OI("Epoch mismatch",c.E.fileOverwrittenInStorage,{driverVersion:v.z,serverEpoch:e,clientEpoch:this.fluidEpoch})}fileEntryFromEntry(e){return{...e,file:this.fileEntry}}}class S extends b{constructor(e,t,r,o){super(e,t,r,o),this.cache=e,this.fileEntry=t,this.logger=r,this.clientIsSummarizer=o,this.treesLatestDeferral=new n.c,this.treesLatestDeferral.promise.catch(()=>{})}validateEpochFromResponse(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super.validateEpochFromResponse(e,t,r),this.treesLatestDeferral.resolve()}async get(e){let t=super.get(e);return e.type!==a.o1&&e.type!==a.W3||(t=t.then(e=>(void 0!==e&&this.treesLatestDeferral.resolve(),e)).catch(e=>{throw this.treesLatestDeferral.reject(e),e})),t}async fetchAndParseAsJSON(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=arguments.length>4?arguments[4]:void 0;const i=this.treesLatestDeferral.isCompleted;try{return await super.fetchAndParseAsJSON(e,t,r,o,n)}catch(s){if("treesLatest"===r&&this.treesLatestDeferral.reject(s),"joinSession"!==r||s.statusCode<401||s.statusCode>404||i)throw s}return await h.Bt.timedExecAsync(this.logger,{eventName:"JoinSessionSyncWait"},async e=>{let t;const r=new Promise(e=>{t=setTimeout(()=>{e(51)},15e3)});51===await Promise.race([r,this.treesLatestDeferral.promise.finally(()=>clearTimeout(t))])&&e.cancel()},{start:!0,end:!0,cancel:"generic"}),super.fetchAndParseAsJSON(e,t,r,o)}}function C(e,t,r,o,n){const i=new S(e,r,o,n);return{cache:{...t,persistedCache:i},epochTracker:i}}},91608:(e,t,r)=>{"use strict";r.d(t,{W:()=>y});var o=r(51497),n=r(43927),i=r(6390);const s=n.TQ.reduce((e,t)=>{const r=t.slice(0,1).toUpperCase()+t.slice(1),n={[`colorPalette${r}Background1`]:o.yd[t].shade40,[`colorPalette${r}Background2`]:o.yd[t].shade30,[`colorPalette${r}Background3`]:o.yd[t].primary,[`colorPalette${r}Foreground1`]:o.yd[t].tint30,[`colorPalette${r}Foreground2`]:o.yd[t].tint40,[`colorPalette${r}Foreground3`]:o.yd[t].tint20,[`colorPalette${r}BorderActive`]:o.yd[t].tint30,[`colorPalette${r}Border1`]:o.yd[t].primary,[`colorPalette${r}Border2`]:o.yd[t].tint20};return Object.assign(e,n)},{});s.colorPaletteRedForeground3=o.yd.red.tint30,s.colorPaletteRedBorder2=o.yd.red.tint30,s.colorPaletteGreenForeground3=o.yd.green.tint40,s.colorPaletteGreenBorder2=o.yd.green.tint40,s.colorPaletteDarkOrangeForeground3=o.yd.darkOrange.tint30,s.colorPaletteDarkOrangeBorder2=o.yd.darkOrange.tint30,s.colorPaletteRedForegroundInverted=o.yd.red.primary,s.colorPaletteGreenForegroundInverted=o.yd.green.primary,s.colorPaletteYellowForegroundInverted=o.yd.yellow.shade30;const a=n.dt.reduce((e,t)=>{const r=t.slice(0,1).toUpperCase()+t.slice(1),n={[`colorPalette${r}Background2`]:o.cc[t].shade30,[`colorPalette${r}Foreground2`]:o.cc[t].tint40,[`colorPalette${r}BorderActive`]:o.cc[t].tint30};return Object.assign(e,n)},{});a.colorPaletteDarkRedBackground2=o.cc.darkRed.shade20,a.colorPalettePlumBackground2=o.cc.plum.shade20;const c={...s,...a},d=Object.entries(i.s).reduce((e,t)=>{let[r,n]=t;const i=r.slice(0,1).toUpperCase()+r.slice(1),s={[`colorStatus${i}Background1`]:o.Ul[n].shade40,[`colorStatus${i}Background2`]:o.Ul[n].shade30,[`colorStatus${i}Background3`]:o.Ul[n].primary,[`colorStatus${i}Foreground1`]:o.Ul[n].tint30,[`colorStatus${i}Foreground2`]:o.Ul[n].tint40,[`colorStatus${i}Foreground3`]:o.Ul[n].tint20,[`colorStatus${i}BorderActive`]:o.Ul[n].tint30,[`colorStatus${i}ForegroundInverted`]:o.Ul[n].shade10,[`colorStatus${i}Border1`]:o.Ul[n].primary,[`colorStatus${i}Border2`]:o.Ul[n].tint20};return Object.assign(e,s)},{});d.colorStatusDangerBackground3Hover=o.Ul[i.s.danger].shade10,d.colorStatusDangerBackground3Pressed=o.Ul[i.s.danger].shade20,d.colorStatusDangerForeground3=o.Ul[i.s.danger].tint40,d.colorStatusDangerBorder2=o.Ul[i.s.danger].tint30,d.colorStatusSuccessForeground3=o.Ul[i.s.success].tint40,d.colorStatusSuccessBorder2=o.Ul[i.s.success].tint40,d.colorStatusWarningForegroundInverted=o.Ul[i.s.warning].shade20;var l=r(43483);var u=r(17483),h=r(95829),g=r(45882),p=r(92708),m=r(27586),f=r(58511),v=r(91809);const y=e=>{const t=(e=>({colorNeutralForeground1:l.ON,colorNeutralForeground1Hover:l.ON,colorNeutralForeground1Pressed:l.ON,colorNeutralForeground1Selected:l.ON,colorNeutralForeground2:l.Oh[84],colorNeutralForeground2Hover:l.ON,colorNeutralForeground2Pressed:l.ON,colorNeutralForeground2Selected:l.ON,colorNeutralForeground2BrandHover:e[100],colorNeutralForeground2BrandPressed:e[90],colorNeutralForeground2BrandSelected:e[100],colorNeutralForeground3:l.Oh[68],colorNeutralForeground3Hover:l.Oh[84],colorNeutralForeground3Pressed:l.Oh[84],colorNeutralForeground3Selected:l.Oh[84],colorNeutralForeground3BrandHover:e[100],colorNeutralForeground3BrandPressed:e[90],colorNeutralForeground3BrandSelected:e[100],colorNeutralForeground4:l.Oh[60],colorNeutralForegroundDisabled:l.Oh[36],colorNeutralForegroundInvertedDisabled:l.c8[40],colorBrandForegroundLink:e[100],colorBrandForegroundLinkHover:e[110],colorBrandForegroundLinkPressed:e[90],colorBrandForegroundLinkSelected:e[100],colorNeutralForeground2Link:l.Oh[84],colorNeutralForeground2LinkHover:l.ON,colorNeutralForeground2LinkPressed:l.ON,colorNeutralForeground2LinkSelected:l.ON,colorCompoundBrandForeground1:e[100],colorCompoundBrandForeground1Hover:e[110],colorCompoundBrandForeground1Pressed:e[90],colorBrandForeground1:e[100],colorBrandForeground2:e[110],colorBrandForeground2Hover:e[130],colorBrandForeground2Pressed:e[160],colorNeutralForeground1Static:l.Oh[14],colorNeutralForegroundStaticInverted:l.ON,colorNeutralForegroundInverted:l.Oh[14],colorNeutralForegroundInvertedHover:l.Oh[14],colorNeutralForegroundInvertedPressed:l.Oh[14],colorNeutralForegroundInvertedSelected:l.Oh[14],colorNeutralForegroundInverted2:l.Oh[14],colorNeutralForegroundOnBrand:l.ON,colorNeutralForegroundInvertedLink:l.ON,colorNeutralForegroundInvertedLinkHover:l.ON,colorNeutralForegroundInvertedLinkPressed:l.ON,colorNeutralForegroundInvertedLinkSelected:l.ON,colorBrandForegroundInverted:e[80],colorBrandForegroundInvertedHover:e[70],colorBrandForegroundInvertedPressed:e[60],colorBrandForegroundOnLight:e[80],colorBrandForegroundOnLightHover:e[70],colorBrandForegroundOnLightPressed:e[50],colorBrandForegroundOnLightSelected:e[60],colorNeutralBackground1:l.Oh[16],colorNeutralBackground1Hover:l.Oh[24],colorNeutralBackground1Pressed:l.Oh[12],colorNeutralBackground1Selected:l.Oh[22],colorNeutralBackground2:l.Oh[12],colorNeutralBackground2Hover:l.Oh[20],colorNeutralBackground2Pressed:l.Oh[8],colorNeutralBackground2Selected:l.Oh[18],colorNeutralBackground3:l.Oh[8],colorNeutralBackground3Hover:l.Oh[16],colorNeutralBackground3Pressed:l.Oh[4],colorNeutralBackground3Selected:l.Oh[14],colorNeutralBackground4:l.Oh[4],colorNeutralBackground4Hover:l.Oh[12],colorNeutralBackground4Pressed:l.Ql,colorNeutralBackground4Selected:l.Oh[10],colorNeutralBackground5:l.Ql,colorNeutralBackground5Hover:l.Oh[8],colorNeutralBackground5Pressed:l.Oh[2],colorNeutralBackground5Selected:l.Oh[6],colorNeutralBackground6:l.Oh[20],colorNeutralBackgroundInverted:l.ON,colorNeutralBackgroundStatic:l.Oh[24],colorNeutralBackgroundAlpha:l.ti[50],colorNeutralBackgroundAlpha2:l.Z1[70],colorSubtleBackground:"transparent",colorSubtleBackgroundHover:l.Oh[22],colorSubtleBackgroundPressed:l.Oh[18],colorSubtleBackgroundSelected:l.Oh[20],colorSubtleBackgroundLightAlphaHover:l.Xv[80],colorSubtleBackgroundLightAlphaPressed:l.Xv[50],colorSubtleBackgroundLightAlphaSelected:"transparent",colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:l.Q1[10],colorSubtleBackgroundInvertedPressed:l.Q1[30],colorSubtleBackgroundInvertedSelected:l.Q1[20],colorTransparentBackground:"transparent",colorTransparentBackgroundHover:"transparent",colorTransparentBackgroundPressed:"transparent",colorTransparentBackgroundSelected:"transparent",colorNeutralBackgroundDisabled:l.Oh[8],colorNeutralBackgroundInvertedDisabled:l.c8[10],colorNeutralStencil1:l.Oh[34],colorNeutralStencil2:l.Oh[20],colorNeutralStencil1Alpha:l.c8[10],colorNeutralStencil2Alpha:l.c8[5],colorBackgroundOverlay:l.Q1[50],colorScrollbarOverlay:l.c8[60],colorBrandBackground:e[70],colorBrandBackgroundHover:e[80],colorBrandBackgroundPressed:e[40],colorBrandBackgroundSelected:e[60],colorCompoundBrandBackground:e[100],colorCompoundBrandBackgroundHover:e[110],colorCompoundBrandBackgroundPressed:e[90],colorBrandBackgroundStatic:e[80],colorBrandBackground2:e[20],colorBrandBackground2Hover:e[40],colorBrandBackground2Pressed:e[10],colorBrandBackground3Static:e[60],colorBrandBackground4Static:e[40],colorBrandBackgroundInverted:l.ON,colorBrandBackgroundInvertedHover:e[160],colorBrandBackgroundInvertedPressed:e[140],colorBrandBackgroundInvertedSelected:e[150],colorNeutralCardBackground:l.Oh[20],colorNeutralCardBackgroundHover:l.Oh[24],colorNeutralCardBackgroundPressed:l.Oh[18],colorNeutralCardBackgroundSelected:l.Oh[22],colorNeutralCardBackgroundDisabled:l.Oh[8],colorNeutralStrokeAccessible:l.Oh[68],colorNeutralStrokeAccessibleHover:l.Oh[74],colorNeutralStrokeAccessiblePressed:l.Oh[70],colorNeutralStrokeAccessibleSelected:e[100],colorNeutralStroke1:l.Oh[40],colorNeutralStroke1Hover:l.Oh[46],colorNeutralStroke1Pressed:l.Oh[42],colorNeutralStroke1Selected:l.Oh[44],colorNeutralStroke2:l.Oh[32],colorNeutralStroke3:l.Oh[24],colorNeutralStrokeSubtle:l.Oh[4],colorNeutralStrokeOnBrand:l.Oh[16],colorNeutralStrokeOnBrand2:l.ON,colorNeutralStrokeOnBrand2Hover:l.ON,colorNeutralStrokeOnBrand2Pressed:l.ON,colorNeutralStrokeOnBrand2Selected:l.ON,colorBrandStroke1:e[100],colorBrandStroke2:e[50],colorBrandStroke2Hover:e[50],colorBrandStroke2Pressed:e[30],colorBrandStroke2Contrast:e[50],colorCompoundBrandStroke:e[100],colorCompoundBrandStrokeHover:e[110],colorCompoundBrandStrokePressed:e[90],colorNeutralStrokeDisabled:l.Oh[26],colorNeutralStrokeInvertedDisabled:l.c8[40],colorTransparentStroke:"transparent",colorTransparentStrokeInteractive:"transparent",colorTransparentStrokeDisabled:"transparent",colorNeutralStrokeAlpha:l.c8[10],colorNeutralStrokeAlpha2:l.c8[20],colorStrokeFocus1:l.Ql,colorStrokeFocus2:l.ON,colorNeutralShadowAmbient:"rgba(0,0,0,0.24)",colorNeutralShadowKey:"rgba(0,0,0,0.28)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.12)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.40)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.48)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"}))(e);return{...u.V,...h.GR,...h.lm,...h.aI,...h.NM,...g.k,...v.b,...v.F,...m.S,...f.L,...t,...c,...d,...(0,p.t)(t.colorNeutralShadowAmbient,t.colorNeutralShadowKey),...(0,p.t)(t.colorBrandShadowAmbient,t.colorBrandShadowKey,"Brand")}}},91809:(e,t,r)=>{"use strict";r.d(t,{F:()=>m,b:()=>p});const o="0",n="2px",i="4px",s="6px",a="8px",c="10px",d="12px",l="16px",u="20px",h="24px",g="32px",p={spacingHorizontalNone:o,spacingHorizontalXXS:n,spacingHorizontalXS:i,spacingHorizontalSNudge:s,spacingHorizontalS:a,spacingHorizontalMNudge:c,spacingHorizontalM:d,spacingHorizontalL:l,spacingHorizontalXL:u,spacingHorizontalXXL:h,spacingHorizontalXXXL:g},m={spacingVerticalNone:o,spacingVerticalXXS:n,spacingVerticalXS:i,spacingVerticalSNudge:s,spacingVerticalS:a,spacingVerticalMNudge:c,spacingVerticalM:d,spacingVerticalL:l,spacingVerticalXL:u,spacingVerticalXXL:h,spacingVerticalXXXL:g}},91947:(e,t,r)=>{"use strict";r.d(t,{CE:()=>g,CQ:()=>_,Ht:()=>l,Jc:()=>M,Jn:()=>L,KE:()=>w,KJ:()=>O,PA:()=>E,UT:()=>A,Vp:()=>R,XQ:()=>H,Y0:()=>b,_d:()=>u,a5:()=>U,a7:()=>B,eH:()=>k,gf:()=>P,hw:()=>p,kF:()=>y,lW:()=>h,nA:()=>v,n_:()=>C,nt:()=>I,sQ:()=>m,wL:()=>D,wW:()=>x,w_:()=>T,x$:()=>S,xh:()=>f,y7:()=>F});var o=r(58443),n=r(69235),i=r(51492),s=r(56142),a=r(6971),c=r(40684);let d=function(e){return e[e.boolean=0]="boolean",e[e.integer=1]="integer",e[e.string=2]="string",e}({});async function l(e){await(0,c.zr)(c.tR.CaretPositionChanged,[e])}async function u(){await N(c.tR.ClearYCaretCoordinate)&&await(0,c.zr)(c.tR.ClearYCaretCoordinate,[])}async function h(e){await(0,c.zr)(c.tR.CursUpDownFromE2o,[e?1:-1])}async function g(e){try{if(await N(c.tR.GetOcps)){const[t]=await(0,c.zr)(c.tR.GetOcps,[e]);return t}return}catch(t){return}}async function p(){await N(c.tR.Dehydrate)&&await(0,c.zr)(c.tR.Dehydrate,[])}async function m(e,t){await(0,c.zr)(c.tR.FluidComponentCreated,[e,t])}async function f(e){await N(c.tR.FluidComponentCreateFailed)&&await(0,c.zr)(c.tR.FluidComponentCreateFailed,[e])}async function v(){await N(c.tR.FluidComponentEdited)&&await(0,c.zr)(c.tR.FluidComponentEdited,[])}async function y(){try{await N(c.tR.FluidHostIsReady)&&await(0,c.zr)(c.tR.FluidHostIsReady,[])}catch(e){(0,n.c2)("fluidHostIsReady()",(0,n.oD)(e))}}async function b(){if(await N(c.tR.GetDataForCreate)){const[e]=await(0,c.zr)(c.tR.GetDataForCreate,[]);if("string"!==typeof e)throw new n.uV("The data returned is not a string.");return e}return""}async function S(e,t){const r=[(0,i.dK)(e,t),d.boolean],[n]=await(0,c.zr)(c.tR.GetFeature,r).catch(e=>(o.Nu||(0,s.vV)(e),[!1]));return"boolean"===typeof n&&n}async function C(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!Number.isInteger(r))throw new n.uV("The default value must be an integer.");const a=[(0,i.dK)(e,t),d.integer,r],[l]=await(0,c.zr)(c.tR.GetFeature,a).catch(e=>(o.Nu||(0,s.vV)(e),[r]));return"number"===typeof l?l:r}async function k(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const n=[(0,i.dK)(e,t),d.string,r],[a]=await(0,c.zr)(c.tR.GetFeature,n).catch(e=>(o.Nu||(0,s.vV)(e),[r]));return"string"===typeof a?a:r}async function w(){const[e]=await(0,c.zr)(c.tR.GetNativeInfo,[]).catch(()=>["{}"]);if("string"!==typeof e)throw new Error("A string should be returned.");const t=JSON.parse(e);if(!t)throw new Error("Unable to parse the native info json.");return t}async function P(e,t){const r=[e,null!==t&&void 0!==t?t:"",!0],[o]=await(0,c.zr)(c.tR.GetToken,r);if("string"!==typeof o)throw new n.uV("Token should be a string.");return o}async function T(e,t){if(await N(c.tR.InvokeMessageExtensionCommand)){const[r]=await(0,c.zr)(c.tR.InvokeMessageExtensionCommand,[e,JSON.stringify(t)]);if("string"!==typeof r)throw new n.uV("The data returned is not a string.");return JSON.parse(r)}}async function E(e,t){if(!await N(c.tR.IsChangeGateEnabled))return!0;const[r]=await(0,c.zr)(c.tR.IsChangeGateEnabled,[e,t]).catch(e=>(o.Nu||(0,s.vV)(e),[!0]));return"boolean"!==typeof r||r}async function N(e){const t=await(0,a.E)();if(!t.version)return!1;switch(e){case c.tR.GetFeature:case c.tR.GetNativeInfo:case c.tR.GetToken:case c.tR.GetUserIdentity:case c.tR.ReportActivityResult:case c.tR.SendTelemetry:return t.version>=1;case c.tR.ShowPermissionCallout:return t.version>=2;case c.tR.CaretPositionChanged:return t.version>=3;case c.tR.OnAtMention:return t.version>=4;case c.tR.OnInvokeFromInjectedScript:return t.version>=8;case c.tR.FluidComponentCreated:return t.version>=9;case c.tR.IsChangeGateEnabled:return t.version>=10;case c.tR.FluidHostIsReady:return t.version>=12;case c.tR.PassKeyToHost:return t.version>=13;case c.tR.GetDataForCreate:return t.version>=15;case c.tR.SetCanProvideDataToSave:case c.tR.ProvideDataToSave:case c.tR.FluidComponentEdited:return t.version>=16;case c.tR.TeachingCalloutDismissed:case c.tR.TeachingCalloutShown:return t.version>=17;case c.tR.FluidComponentCreateFailed:return t.version>=18;case c.tR.InvokeMessageExtensionCommand:return t.version>=22;case c.tR.Dehydrate:return t.version>=24;case c.tR.SaveEmbeddedData:return t.version>=25;case c.tR.UpdateLoopInfo:return t.version>=26;case c.tR.CursUpDownFromE2o:return t.version>=28;case c.tR.GetOcps:return t.version>=32;case c.tR.ScrollHost:return t.version>=33;default:return!1}}async function I(e,t){await(0,c.zr)(c.tR.OnAtMention,[e,t])}async function D(e){const t=function(e){const t=27;if("Escape"===e)return t;return void(0,s.vV)(`Unsupported key: ${e}`)}(e);t&&await(0,c.zr)(c.tR.PassKeyToHost,[t])}async function F(e,t){await N(c.tR.ScrollHost)&&await(0,c.zr)(c.tR.ScrollHost,[e,t])}async function B(e,t,r,o){await N(c.tR.ProvideDataToSave)&&await(0,c.zr)(c.tR.ProvideDataToSave,[e,t,r,o])}async function L(e,t,r){const o=[e,t,r];await(0,c.zr)(c.tR.ReportActivityResult,o).catch(s.vV)}async function x(e){await(0,c.zr)(c.tR.SendTelemetry,e)}async function A(e){await N(c.tR.SetCanProvideDataToSave)&&await(0,c.zr)(c.tR.SetCanProvideDataToSave,[e])}async function O(e){await N(c.tR.SaveEmbeddedData)&&await(0,c.zr)(c.tR.SaveEmbeddedData,[e])}async function M(){await(0,c.zr)(c.tR.ShowPermissionCallout,[])}async function _(e,t,r){o.Nu||(0,s.Rm)(`Size changed: ${e} x ${t}`),await(0,c.zr)(c.tR.SizeChanged,[e,t,(0,c.qH)(r)])}async function R(e){await(0,c.zr)(c.tR.TeachingCalloutDismissed,[e])}async function H(){await(0,c.zr)(c.tR.TeachingCalloutShown,[])}async function U(e){if(await N(c.tR.UpdateLoopInfo)){const t=JSON.stringify(e);await(0,c.zr)(c.tR.UpdateLoopInfo,[t])}}},92708:(e,t,r)=>{"use strict";function o(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return{[`shadow2${r}`]:`0 0 2px ${e}, 0 1px 2px ${t}`,[`shadow4${r}`]:`0 0 2px ${e}, 0 2px 4px ${t}`,[`shadow8${r}`]:`0 0 2px ${e}, 0 4px 8px ${t}`,[`shadow16${r}`]:`0 0 2px ${e}, 0 8px 16px ${t}`,[`shadow28${r}`]:`0 0 8px ${e}, 0 14px 28px ${t}`,[`shadow64${r}`]:`0 0 8px ${e}, 0 32px 64px ${t}`}}r.d(t,{t:()=>o})},92756:(e,t,r)=>{"use strict";var o;r.d(t,{d:()=>o}),function(e){e.cache="fluid-cache",e.clientDetails="fluid-client-details",e.loadMode="loadMode",e.reconnect="fluid-reconnect",e.sequenceNumber="fluid-sequence-number",e.version="version"}(o||(o={}))},93023:(e,t,r)=>{"use strict";r.d(t,{X:()=>n});var o=r(61376);class n extends o.b{constructor(){super(),this.addListener=super.addListener.bind(this),this.on=super.on.bind(this),this.once=super.once.bind(this),this.prependListener=super.prependListener.bind(this),this.prependOnceListener=super.prependOnceListener.bind(this),this.removeListener=super.removeListener.bind(this),this.off=super.off.bind(this)}}},93220:(e,t,r)=>{"use strict";var o,n;r.d(t,{O:()=>o,t:()=>n}),function(e){e.isSharingLinkToRedeem="isSharingLinkToRedeem"}(o||(o={})),function(e){e.isClpCompliantApp="X-CLP-Compliant-App"}(n||(n={}))},93537:(e,t,r)=>{"use strict";r.d(t,{$e:()=>u,J5:()=>h,sC:()=>l});var o=r(37805);const n=709,i=710,s=707,a=711;function c(){return"undefined"===typeof navigator||!1!==navigator.onLine}const d={durationMs:-1,body:null,bodyUsed:!1,headers:new Headers,ok:!1,redirected:!1,status:c()?i:n,statusText:"",type:"error",url:"",bytes:()=>Promise.resolve(new Uint8Array(0)),arrayBuffer:()=>Promise.resolve(new ArrayBuffer(0)),blob:()=>Promise.resolve(new Blob(void 0)),formData:()=>Promise.resolve(new FormData(void 0)),json:()=>Promise.resolve(void 0),text:()=>Promise.resolve(""),clone:()=>new Response};function l(e){return t=>e.includes(t.status)}function u(e){return t=>!e.includes(t.status)}function h(e,t,r){let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:18e4,u=r;r?.respectRetryAfterHeader&&(u={...r},u.backoffFn=(e,t)=>{if(429===t.status||503===t.status){const e=t.headers.get("Retry-After");if(e){const t=parseInt(e,10);if(!isNaN(t))return 1e3*t}}return r.backoffFn(e,t)});const h=new AbortController;t?.signal?.aborted?h.abort(t.signal.reason):t?.signal?.addEventListener("abort",function(){h.abort(this.reason)});const g={...t,signal:h.signal};let p,m=!1;return"undefined"!==typeof window&&window.self!==window.top&&(p=e=>{e.persisted||(m=!0)},window.addEventListener("pagehide",p)),(0,o.pb)(()=>{const t="undefined"!==typeof performance?performance.now():Date.now();return fetch(e,g).then(e=>{const r=e;return r.durationMs=Math.round(performance.now()-t),r}).catch(e=>{if(function(e,t){return e===t?.reason||"object"===typeof e&&null!==e&&("AbortError"===e.name||20===e.code)}(e,g.signal))throw e;let r="Error does not provide a message";e.name&&e.message?r=`Error type: ${e.name}, ${e.message}`:e.name?r=`Error type: ${e.name}`:e.message&&(r=`Error message: ${e.message}`);const o=c()?m?a:i:n;return{...d,status:o,ok:!1,durationMs:Math.round(performance.now()-t),statusText:r}})},u,{timeoutMs:l,onTimeout:()=>(h.abort(),{...d,status:s,ok:!1,durationMs:l})}).finally(()=>{"undefined"!==typeof window&&window.self!==window.top&&p&&window.removeEventListener("pagehide",p)})}},93586:(e,t,r)=>{"use strict";r.d(t,{E:()=>o});const o={...r(87804).a,invalidFileNameError:"invalidFileNameError",snapshotTooBig:"snapshotTooBig",fetchTimeout:"fetchTimeout",fluidNotEnabled:"fluidNotEnabled",cannotCatchUp:"cannotCatchUp",serviceReadOnly:"serviceReadOnly",blockedIPAddress:"blockedIPAddress"}},93916:(e,t,r)=>{"use strict";r.d(t,{R:()=>n});var o=r(90589);const n=(e,t)=>{const r=function(e){const{value:t,tag:r}=null!==e&&"object"===typeof e?e:{value:e,tag:void 0};switch(r){case void 0:case"PackageData":case"CodeArtifact":return t;case"UserData":return"REDACTED (tag: UserData)";default:return`REDACTED (tag: ${r})`}}(e);if(void 0!==r)return"string"===typeof r?(0,o.m9)(t,r):"number"===typeof r?(0,o.ip)(t,r):(0,o.LK)(t,r)}},94040:(e,t,r)=>{"use strict";r.d(t,{Jf:()=>o,RC:()=>n,RG:()=>a,be:()=>c,hW:()=>s,kZ:()=>i});const o={colorNeutralForeground1:"--colorNeutralForeground1",colorNeutralForeground1Hover:"--colorNeutralForeground1Hover",colorNeutralForeground1Pressed:"--colorNeutralForeground1Pressed",colorNeutralForeground1Selected:"--colorNeutralForeground1Selected",colorNeutralForeground2:"--colorNeutralForeground2",colorNeutralForeground2Hover:"--colorNeutralForeground2Hover",colorNeutralForeground2Pressed:"--colorNeutralForeground2Pressed",colorNeutralForeground2Selected:"--colorNeutralForeground2Selected",colorNeutralForeground2BrandHover:"--colorNeutralForeground2BrandHover",colorNeutralForeground2BrandPressed:"--colorNeutralForeground2BrandPressed",colorNeutralForeground2BrandSelected:"--colorNeutralForeground2BrandSelected",colorNeutralForeground3:"--colorNeutralForeground3",colorNeutralForeground3Hover:"--colorNeutralForeground3Hover",colorNeutralForeground3Pressed:"--colorNeutralForeground3Pressed",colorNeutralForeground3Selected:"--colorNeutralForeground3Selected",colorNeutralForeground3BrandHover:"--colorNeutralForeground3BrandHover",colorNeutralForeground3BrandPressed:"--colorNeutralForeground3BrandPressed",colorNeutralForeground3BrandSelected:"--colorNeutralForeground3BrandSelected",colorNeutralForeground4:"--colorNeutralForeground4",colorNeutralForegroundDisabled:"--colorNeutralForegroundDisabled",colorBrandForegroundLink:"--colorBrandForegroundLink",colorBrandForegroundLinkHover:"--colorBrandForegroundLinkHover",colorBrandForegroundLinkPressed:"--colorBrandForegroundLinkPressed",colorBrandForegroundLinkSelected:"--colorBrandForegroundLinkSelected",colorNeutralForeground2Link:"--colorNeutralForeground2Link",colorNeutralForeground2LinkHover:"--colorNeutralForeground2LinkHover",colorNeutralForeground2LinkPressed:"--colorNeutralForeground2LinkPressed",colorNeutralForeground2LinkSelected:"--colorNeutralForeground2LinkSelected",colorCompoundBrandForeground1:"--colorCompoundBrandForeground1",colorCompoundBrandForeground1Hover:"--colorCompoundBrandForeground1Hover",colorCompoundBrandForeground1Pressed:"--colorCompoundBrandForeground1Pressed",colorNeutralForegroundOnBrand:"--colorNeutralForegroundOnBrand",colorNeutralForegroundInverted:"--colorNeutralForegroundInverted",colorNeutralForegroundInvertedHover:"--colorNeutralForegroundInvertedHover",colorNeutralForegroundInvertedPressed:"--colorNeutralForegroundInvertedPressed",colorNeutralForegroundInvertedSelected:"--colorNeutralForegroundInvertedSelected",colorNeutralForegroundInverted2:"--colorNeutralForegroundInverted2",colorNeutralForegroundStaticInverted:"--colorNeutralForegroundStaticInverted",colorNeutralForegroundInvertedLink:"--colorNeutralForegroundInvertedLink",colorNeutralForegroundInvertedLinkHover:"--colorNeutralForegroundInvertedLinkHover",colorNeutralForegroundInvertedLinkPressed:"--colorNeutralForegroundInvertedLinkPressed",colorNeutralForegroundInvertedLinkSelected:"--colorNeutralForegroundInvertedLinkSelected",colorNeutralForegroundInvertedDisabled:"--colorNeutralForegroundInvertedDisabled",colorBrandForeground1:"--colorBrandForeground1",colorBrandForeground2:"--colorBrandForeground2",colorNeutralForeground1Static:"--colorNeutralForeground1Static",colorBrandForegroundInverted:"--colorBrandForegroundInverted",colorBrandForegroundInvertedHover:"--colorBrandForegroundInvertedHover",colorBrandForegroundInvertedPressed:"--colorBrandForegroundInvertedPressed",colorBrandForegroundOnLight:"--colorBrandForegroundOnLight",colorBrandForegroundOnLightHover:"--colorBrandForegroundOnLightHover",colorBrandForegroundOnLightPressed:"--colorBrandForegroundOnLightPressed",colorBrandForegroundOnLightSelected:"--colorBrandForegroundOnLightSelected",colorNeutralBackground1:"--colorNeutralBackground1",colorNeutralBackground1Hover:"--colorNeutralBackground1Hover",colorNeutralBackground1Pressed:"--colorNeutralBackground1Pressed",colorNeutralBackground1Selected:"--colorNeutralBackground1Selected",colorNeutralBackground2:"--colorNeutralBackground2",colorNeutralBackground2Hover:"--colorNeutralBackground2Hover",colorNeutralBackground2Pressed:"--colorNeutralBackground2Pressed",colorNeutralBackground2Selected:"--colorNeutralBackground2Selected",colorNeutralBackground3:"--colorNeutralBackground3",colorNeutralBackground3Hover:"--colorNeutralBackground3Hover",colorNeutralBackground3Pressed:"--colorNeutralBackground3Pressed",colorNeutralBackground3Selected:"--colorNeutralBackground3Selected",colorNeutralBackground4:"--colorNeutralBackground4",colorNeutralBackground4Hover:"--colorNeutralBackground4Hover",colorNeutralBackground4Pressed:"--colorNeutralBackground4Pressed",colorNeutralBackground4Selected:"--colorNeutralBackground4Selected",colorNeutralBackground5:"--colorNeutralBackground5",colorNeutralBackground5Hover:"--colorNeutralBackground5Hover",colorNeutralBackground5Pressed:"--colorNeutralBackground5Pressed",colorNeutralBackground5Selected:"--colorNeutralBackground5Selected",colorNeutralBackground6:"--colorNeutralBackground6",colorNeutralBackgroundInverted:"--colorNeutralBackgroundInverted",colorNeutralBackgroundStatic:"--colorNeutralBackgroundStatic",colorSubtleBackground:"--colorSubtleBackground",colorSubtleBackgroundHover:"--colorSubtleBackgroundHover",colorSubtleBackgroundPressed:"--colorSubtleBackgroundPressed",colorSubtleBackgroundSelected:"--colorSubtleBackgroundSelected",colorSubtleBackgroundLightAlphaHover:"--colorSubtleBackgroundLightAlphaHover",colorSubtleBackgroundLightAlphaPressed:"--colorSubtleBackgroundLightAlphaPressed",colorSubtleBackgroundLightAlphaSelected:"--colorSubtleBackgroundLightAlphaSelected",colorSubtleBackgroundInverted:"--colorSubtleBackgroundInverted",colorSubtleBackgroundInvertedHover:"--colorSubtleBackgroundInvertedHover",colorSubtleBackgroundInvertedPressed:"--colorSubtleBackgroundInvertedPressed",colorSubtleBackgroundInvertedSelected:"--colorSubtleBackgroundInvertedSelected",colorTransparentBackground:"--colorTransparentBackground",colorTransparentBackgroundHover:"--colorTransparentBackgroundHover",colorTransparentBackgroundPressed:"--colorTransparentBackgroundPressed",colorTransparentBackgroundSelected:"--colorTransparentBackgroundSelected",colorNeutralBackgroundDisabled:"--colorNeutralBackgroundDisabled",colorNeutralBackgroundInvertedDisabled:"--colorNeutralBackgroundInvertedDisabled",colorNeutralStencil1:"--colorNeutralStencil1",colorNeutralStencil2:"--colorNeutralStencil2",colorNeutralStencil1Alpha:"--colorNeutralStencil1Alpha",colorNeutralStencil2Alpha:"--colorNeutralStencil2Alpha",colorBackgroundOverlay:"--colorBackgroundOverlay",colorScrollbarOverlay:"--colorScrollbarOverlay",colorBrandBackground:"--colorBrandBackground",colorBrandBackgroundHover:"--colorBrandBackgroundHover",colorBrandBackgroundPressed:"--colorBrandBackgroundPressed",colorBrandBackgroundSelected:"--colorBrandBackgroundSelected",colorCompoundBrandBackground:"--colorCompoundBrandBackground",colorCompoundBrandBackgroundHover:"--colorCompoundBrandBackgroundHover",colorCompoundBrandBackgroundPressed:"--colorCompoundBrandBackgroundPressed",colorBrandBackgroundStatic:"--colorBrandBackgroundStatic",colorBrandBackground2:"--colorBrandBackground2",colorBrandBackground2Pressed:"--colorBrandBackground2Pressed",colorBrandBackground2Hover:"--colorBrandBackground2Hover",colorBrandBackgroundInverted:"--colorBrandBackgroundInverted",colorBrandBackgroundInvertedHover:"--colorBrandBackgroundInvertedHover",colorBrandBackgroundInvertedPressed:"--colorBrandBackgroundInvertedPressed",colorBrandBackgroundInvertedSelected:"--colorBrandBackgroundInvertedSelected",colorNeutralStrokeAccessible:"--colorNeutralStrokeAccessible",colorNeutralStrokeAccessibleHover:"--colorNeutralStrokeAccessibleHover",colorNeutralStrokeAccessiblePressed:"--colorNeutralStrokeAccessiblePressed",colorNeutralStrokeAccessibleSelected:"--colorNeutralStrokeAccessibleSelected",colorNeutralStrokeAlpha:"--colorNeutralStrokeAlpha",colorNeutralStroke1:"--colorNeutralStroke1",colorNeutralStroke1Hover:"--colorNeutralStroke1Hover",colorNeutralStroke1Pressed:"--colorNeutralStroke1Pressed",colorNeutralStroke1Selected:"--colorNeutralStroke1Selected",colorNeutralStroke2:"--colorNeutralStroke2",colorNeutralStroke3:"--colorNeutralStroke3",colorNeutralStrokeOnBrand:"--colorNeutralStrokeOnBrand",colorNeutralStrokeOnBrand2:"--colorNeutralStrokeOnBrand2",colorNeutralStrokeOnBrand2Hover:"--colorNeutralStrokeOnBrand2Hover",colorNeutralStrokeOnBrand2Pressed:"--colorNeutralStrokeOnBrand2Pressed",colorNeutralStrokeOnBrand2Selected:"--colorNeutralStrokeOnBrand2Selected",colorBrandStroke1:"--colorBrandStroke1",colorBrandStroke2:"--colorBrandStroke2",colorCompoundBrandStroke:"--colorCompoundBrandStroke",colorCompoundBrandStrokeHover:"--colorCompoundBrandStrokeHover",colorCompoundBrandStrokePressed:"--colorCompoundBrandStrokePressed",colorNeutralStrokeDisabled:"--colorNeutralStrokeDisabled",colorNeutralStrokeInvertedDisabled:"--colorNeutralStrokeInvertedDisabled",colorTransparentStroke:"--colorTransparentStroke",colorTransparentStrokeInteractive:"--colorTransparentStrokeInteractive",colorTransparentStrokeDisabled:"--colorTransparentStrokeDisabled",colorStrokeFocus1:"--colorStrokeFocus1",colorStrokeFocus2:"--colorStrokeFocus2",colorNeutralShadowAmbient:"--colorNeutralShadowAmbient",colorNeutralShadowKey:"--colorNeutralShadowKey",colorNeutralShadowAmbientLighter:"--colorNeutralShadowAmbientLighter",colorNeutralShadowKeyLighter:"--colorNeutralShadowKeyLighter",colorNeutralShadowAmbientDarker:"--colorNeutralShadowAmbientDarker",colorNeutralShadowKeyDarker:"--colorNeutralShadowKeyDarker",colorBrandShadowAmbient:"--colorBrandShadowAmbient",colorBrandShadowKey:"--colorBrandShadowKey",colorPaletteDarkOrangeForeground1:"--colorPaletteDarkOrangeForeground1",colorPaletteRedForeground1:"--colorPaletteRedForeground1",colorPaletteYellowBackground2:"--colorPaletteYellowBackground2",colorPaletteDarkOrangeBorderActive:"--colorPaletteDarkOrangeBorderActive",colorPaletteGrapeBorderActive:"--colorPaletteGrapeBorderActive"},n={fontFamilyBase:"--fontFamilyBase",fontFamilyMonospace:"--fontFamilyMonospace",fontFamilyNumeric:"--fontFamilyNumeric"},i={fontSizeBase100:"--fontSizeBase100",fontSizeBase200:"--fontSizeBase200",fontSizeBase300:"--fontSizeBase300",fontSizeBase400:"--fontSizeBase400",fontSizeBase500:"--fontSizeBase500",fontSizeBase600:"--fontSizeBase600",fontSizeHero700:"--fontSizeHero700",fontSizeHero800:"--fontSizeHero800",fontSizeHero900:"--fontSizeHero900",fontSizeHero1000:"--fontSizeHero1000"},s={fontWeightRegular:"--fontWeightRegular",fontWeightMedium:"--fontWeightMedium",fontWeightSemibold:"--fontWeightSemibold",fontWeightBold:"--fontWeightBold"},a={lineHeightBase100:"--lineHeightBase100",lineHeightBase200:"--lineHeightBase200",lineHeightBase300:"--lineHeightBase300",lineHeightBase400:"--lineHeightBase400",lineHeightBase500:"--lineHeightBase500",lineHeightBase600:"--lineHeightBase600",lineHeightHero700:"--lineHeightHero700",lineHeightHero800:"--lineHeightHero800",lineHeightHero900:"--lineHeightHero900",lineHeightHero1000:"--lineHeightHero1000"},c={colorNeutralBackground7:"--colorNeutralBackground7",colorNeutralBackground7Selected:"--colorNeutralBackground7Selected"}},94115:(e,t,r)=>{"use strict";r.d(t,{i:()=>g,y:()=>h});var o=r(60138),n=r(25573),i=r(64580),s=r(97232),a=r(53450),c=r(51655),d=r(26140),l=r(59091),u=r(69235);let h=function(e){return e[e.Success=0]="Success",e[e.LoadComponentError=1]="LoadComponentError",e[e.RenderComponentError_PromiseRejected=2]="RenderComponentError_PromiseRejected",e[e.RenderComponentError_NoComponent=3]="RenderComponentError_NoComponent",e[e.RenderComponentError_CannotRender=4]="RenderComponentError_CannotRender",e}({});class g extends a.r{constructor(e,t,r,o){super("ShowComponent",e),this.WebAppMainPerfTracker=void 0,this.LoadPerfTracker=void 0,this.InitialRenderPerfTracker=void 0,this.AppLazyImportTracker=void 0,this.AppLazyStartTracker=void 0,this.ComponentRenderPerfTracker=void 0,this.GetTokenCount=void 0,this.GetTokenTotalDuration=void 0,this.GetTokenSucceededAfterRetryCount=void 0,this.EndTime=void 0,this.EnforceInformationProtectionPerfTracker=void 0,this.odspModuleImportTracker=void 0,this.addStringDataField("ScenarioName",t),this.addStringDataField("Fluid_Audience",r),this.setWebAppMainPerfTracker(o)}setWebAppMainPerfTracker(e){this.WebAppMainPerfTracker=c.q.startNew(e)}setLoadPerfTracker(){this.LoadPerfTracker=c.q.startNew()}setInitialRenderPerfTracker(){this.InitialRenderPerfTracker=c.q.startNew()}setAppLazyImportPerfTracker(){this.AppLazyImportTracker=c.q.startNew()}setAppLazyStartPerfTracker(){this.AppLazyStartTracker=c.q.startNew()}setComponentRenderPerfTracker(){this.ComponentRenderPerfTracker=c.q.startNew()}setEnforceInformationProtectionPerfTracker(){this.EnforceInformationProtectionPerfTracker=c.q.startNew()}onLoadComplete(e){var t;null===(t=this.LoadPerfTracker)||void 0===t||t.setSuccess(),e instanceof o.z&&(this.GetTokenCount=e.getTokenCallCount,this.GetTokenTotalDuration=e.getTokenTotalDuration,this.GetTokenSucceededAfterRetryCount=e.getTokenSucceededAfterRetryCount)}addResourceMetrics(){const e=(0,d.T)(),t=e.find(e=>e.name.match("https://fa000000084.resources.office.net/static/js/268.(.*).chunk.js")),r=e.find(e=>e.name.match("https://fa000000084.resources.office.net/static/js/main.(.*).chunk.js"));t&&(void 0!=t.startTime&&this.addInt64DataField("LoadResourceBundleStart",t.startTime),void 0!=t.duration&&this.addInt64DataField("LoadResourceBundleDuration",t.duration)),r&&(void 0!=r.startTime&&this.addInt64DataField("LoadResourceMainStart",r.startTime),void 0!=r.duration&&this.addInt64DataField("LoadResourceMainDuration",r.duration))}async sendTelemetryForSuccess(){await this.endActivity(!0,h.Success),this.EndTime=(0,n.W)(),(0,i.$)(s.d.Success_Hydrated)}async sendTelemetryForFailure(e,t,r){const o=null===r||void 0===r?void 0:r.errorType,s=null===r||void 0===r?void 0:r.name,a=(0,u.aK)(r)||o||s;await this.endActivity(!1,e,a),this.EndTime=(0,n.W)(),(0,i.$)(t)}async addDataFieldsToActivity(e,t){var r,o,n,i,s,a,c,d,u,g,p,m,f,v,y;(null===(r=this.WebAppMainPerfTracker)||void 0===r?void 0:r.startTime)&&this.addInt64DataField("WebAppMainStartTime",this.WebAppMainPerfTracker.startTime),(null===(o=this.WebAppMainPerfTracker)||void 0===o?void 0:o.getDuration)&&this.addInt64DataField("WebAppMainDuration",this.WebAppMainPerfTracker.getDuration()),this.WebAppMainPerfTracker&&this.addBooleanDataField("WebAppMainSuccess",this.WebAppMainPerfTracker.isSuccess),(null===(n=this.LoadPerfTracker)||void 0===n?void 0:n.startTime)&&this.addInt64DataField("LoadStartTime",this.LoadPerfTracker.startTime),(null===(i=this.LoadPerfTracker)||void 0===i?void 0:i.getDuration)&&this.addInt64DataField("LoadDuration",this.LoadPerfTracker.getDuration()),this.LoadPerfTracker&&this.addBooleanDataField("LoadSuccess",this.LoadPerfTracker.isSuccess),(null===(s=this.AppLazyImportTracker)||void 0===s?void 0:s.startTime)&&this.addInt64DataField("AppLazyImportStartTime",this.AppLazyImportTracker.startTime),(null===(a=this.AppLazyImportTracker)||void 0===a?void 0:a.getDuration)&&this.addInt64DataField("AppLazyImportDuration",this.AppLazyImportTracker.getDuration()),this.AppLazyImportTracker&&this.addBooleanDataField("AppLazyImportSuccess",this.AppLazyImportTracker.isSuccess),(null===(c=this.AppLazyStartTracker)||void 0===c?void 0:c.startTime)&&this.addInt64DataField("AppLazyStartStartTime",this.AppLazyStartTracker.startTime),(null===(d=this.AppLazyStartTracker)||void 0===d?void 0:d.getDuration)&&this.addInt64DataField("AppLazyStartDuration",this.AppLazyStartTracker.getDuration()),this.AppLazyStartTracker&&this.addBooleanDataField("AppLazyStartSuccess",this.AppLazyStartTracker.isSuccess),(null===(u=this.InitialRenderPerfTracker)||void 0===u?void 0:u.startTime)&&this.addInt64DataField("InitialRenderStartTime",this.InitialRenderPerfTracker.startTime),(null===(g=this.InitialRenderPerfTracker)||void 0===g?void 0:g.getDuration)&&this.addInt64DataField("InitialRenderDuration",this.InitialRenderPerfTracker.getDuration()),this.InitialRenderPerfTracker&&this.addBooleanDataField("InitialRenderSuccess",this.InitialRenderPerfTracker.isSuccess),(null===(p=this.ComponentRenderPerfTracker)||void 0===p?void 0:p.startTime)&&this.addInt64DataField("ComponentRenderStartTime",this.ComponentRenderPerfTracker.startTime),(null===(m=this.ComponentRenderPerfTracker)||void 0===m?void 0:m.getDuration)&&this.addInt64DataField("ComponentRenderDuration",this.ComponentRenderPerfTracker.getDuration()),this.ComponentRenderPerfTracker&&this.addBooleanDataField("ComponentRenderSuccess",this.ComponentRenderPerfTracker.isSuccess),(null===(f=this.EnforceInformationProtectionPerfTracker)||void 0===f?void 0:f.getDuration)&&this.addInt64DataField("EnforceInformationProtectionDuration",this.EnforceInformationProtectionPerfTracker.getDuration()),this.addBooleanDataField("IsUsingServiceDeliveredODSPDriver",l.Om),this.GetTokenCount&&this.addInt64DataField("GetTokenCount",this.GetTokenCount),this.GetTokenTotalDuration&&this.addInt64DataField("GetTokenTotalDuration",this.GetTokenTotalDuration),this.GetTokenSucceededAfterRetryCount&&this.addInt64DataField("GetTokenSucceededAfterRetryCount",this.GetTokenSucceededAfterRetryCount),(null===(v=this.odspModuleImportTracker)||void 0===v?void 0:v.startTime)&&this.addInt64DataField("OdspModuleImportStartTime",this.odspModuleImportTracker.startTime),(null===(y=this.odspModuleImportTracker)||void 0===y?void 0:y.getDuration)&&this.addInt64DataField("OdspModuleImportDuration",this.odspModuleImportTracker.getDuration()),this.addResourceMetrics(),this.addStringDataField("ResultType",h[e]),t&&this.addStringDataField("ErrorMessage",t)}}},94794:(e,t,r)=>{"use strict";r.d(t,{D:()=>o});const o={...r(488).k,clientSessionExpiredError:"clientSessionExpiredError"}},95720:(e,t,r)=>{"use strict";r.d(t,{A8:()=>u,Ak:()=>k,BN:()=>w,F7:()=>c,P:()=>d,Qk:()=>g,Qn:()=>l,TK:()=>p,Ug:()=>C,_H:()=>S,a$:()=>s,bU:()=>o,ih:()=>n,ii:()=>y,m1:()=>h,md:()=>f,ol:()=>a,ps:()=>b,tR:()=>i,uT:()=>m,ul:()=>v});const o="LoadComponentInDiv",n="GetDriver",i="LoadContainer",s="LoadComponentFromContainer",a="RequestComponent",c="GetTemplateContent",d="RehydrateFromTemplateContent",l="LoadCodeFromHint",u="FetchComponentManifest",h="GetLoopComponentCore",g="ContainerPostBootError",p="ContainerPackagePreCacheError",m="GetTemplateContentError",f="UndefinedTemplateContentError",v="ComponentNotSerializableError",y="ComponentSerializationError",b="ComponentManifestFetchError",S="LoadComponentCancelledByHost",C="CodeHintExists",k="OfficeWebHost",w="LoopExperiences"},95829:(e,t,r)=>{"use strict";r.d(t,{GR:()=>o,NM:()=>i,aI:()=>s,lm:()=>n});const o={fontSizeBase100:"10px",fontSizeBase200:"12px",fontSizeBase300:"14px",fontSizeBase400:"16px",fontSizeBase500:"20px",fontSizeBase600:"24px",fontSizeHero700:"28px",fontSizeHero800:"32px",fontSizeHero900:"40px",fontSizeHero1000:"68px"},n={lineHeightBase100:"14px",lineHeightBase200:"16px",lineHeightBase300:"20px",lineHeightBase400:"22px",lineHeightBase500:"28px",lineHeightBase600:"32px",lineHeightHero700:"36px",lineHeightHero800:"40px",lineHeightHero900:"52px",lineHeightHero1000:"92px"},i={fontWeightRegular:400,fontWeightMedium:500,fontWeightSemibold:600,fontWeightBold:700},s={fontFamilyBase:"'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif",fontFamilyMonospace:"Consolas, 'Courier New', Courier, monospace",fontFamilyNumeric:"Bahnschrift, 'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif"}},95996:(e,t,r)=>{"use strict";r.d(t,{LJ:()=>C,IA:()=>g,hO:()=>u,Ot:()=>l,o4:()=>p,A$:()=>d});var o=r(25838),n=r(15851),i=r(83125);const s=["facetCodes","statusCode","innerMostErrorCode","sprequestguid"],a=["local.loop.microsoft.com","res.cdn.office.net","res-sdf.cdn.office.net"];function c(e){for(const t in e)if(-1!==t.search(/message|error|stack/i)||s.includes(t)){const r=e[t];if("string"===typeof r){const o=/\b([A-Z0-9.!#$%&'*+-/=?^_`{|}~]+@[A-Z0-9.-]+\.[A-Z]{2,4})\b|\b((?:https?|ftp):\/\/([^\/\s]+)[^\s]*)\b/gi;e[t]=r.replace(o,(e,t,r,o)=>t?"(scrubbed_email)":r&&!a.includes(o)?"(scrubbed_URL)":e)}}return e}function d(e,t,r,o){if(t)switch(e){case n.hB.Generic:return l(t,r);case n.hB.Error:return u(t,r,o);case n.hB.Activity:return g(t,r,o);case n.hB.UserAction:return p(t,r);default:return}}function l(e,t){const r=c(t);e.send({...r,category:n.hB.Generic})}function u(e,t,r){r&&b(t,r);const o=c(t);e.send({...o,category:n.hB.Error}),t.isUserImpacting&&m(e,o)}new Set,new Set,new Map([["Automation",1],["SyntheticTraffic",1],["Local",1],["Staging",1],["Dogfood",.1],["Preview",.1],["Microsoft",.01],["Production",.001],["GCC",0],["GCC-High",0],["DoD",0],["Gallatin",0]]);const h={Automation:!0,SyntheticTraffic:!0,Local:!0,Development:!0,Staging:!0,Dogfood:!0,Preview:!0,Microsoft:!0,Production:!1,GCC:!1,"GCC-High":!1,DoD:!1,USNat:!1,USSec:!1,Gallatin:!1,Bleu:!1,Delos:!1};function g(e,t,r){r&&b(t,r),t.resultType||void 0===t.succeeded||(t.resultType=t.succeeded?n.Tp.Success:n.Tp.Failure);const o=c(t);e.send({...o,category:n.hB.Activity}),t.resultType===n.Tp.Failure&&t.isUserImpacting&&m(e,o)}function p(e,t,r){const i=t;if(r){const t=o.r.getFields(r);e.send({...i,dataFields:t,category:n.hB.UserAction})}else e.send({...i,category:n.hB.UserAction})}function m(e,t){let r=e;const o=r.getNamespace?.(),s=`${o}_${t.eventName}`;r=new i.p("ContainerSession",e),r.send({...t,errorAction:s,category:n.hB.Error})}const f=e=>"object"===typeof e&&null!==e;function v(e,t){if(!f(t))return;const r=t[e];return"string"===typeof r?r:void 0}function y(e){const t="string"===typeof e?e:void 0,r=v("errorType",e);return{message:t??v("message",e),errorMessage:t??v("errorMessage",e),errorName:v("name",e),stack:v("stack",e),errorType:r,errorInstanceId:v("errorInstanceId",e)}}function b(e,t){!function(e,t){const r=y(e);if(t.message=r.message??t.message,t.errorMessage=r.errorMessage??t.message,t.errorName=r.errorName,t.stack=r.stack??("string"===typeof t.stack?t.stack:void 0),t.errorType=r.errorType||t.errorType,t.errorInstanceId=r.errorInstanceId,s.forEach(r=>{if(f(e)){const o=e[r];"boolean"!==typeof o&&"number"!==typeof o&&"string"!==typeof o&&"undefined"!==typeof o||(t[r]=o),"object"===typeof o&&(t[r]=JSON.stringify(o))}}),"object"===typeof e&&e&&"cause"in e){const r=y(e.cause);t.causeMessage=r.message,t.causeStack=r.stack}}(t,e),e.message||(e.message=e.errorMessage),void 0===e.stack&&(e.stack=S())}function S(e){const t=Error.stackTraceLimit;void 0!==e&&(Error.stackTraceLimit=e);let r=(new Error).stack;if(!r)try{throw new Error}catch(o){r=o.stack}return Error.stackTraceLimit=t,r}function C(e){return h[e]}},96076:(e,t,r)=>{"use strict";r.d(t,{C:()=>d});var o=r(61865),n=r(21856),i=r(93023),s=r(15217),a=r(19984);class c extends i.X{get id(){return this.runtime.id}get IFluidLoadable(){return this}get IFluidHandle(){return this.handle}get handle(){return(0,s.vA)(void 0!==this.runtime.entryPoint,1131),this.runtime.entryPoint}static async getDataObject(e){return await e.entryPoint.get()}constructor(e){super(),this.runtime=e.runtime,this.context=e.context,this.providers=e.providers,this.initProps=e.initProps}async request(e){return""===e.url||"/"===e.url||e.url.startsWith("/?")?{mimeType:"fluid/object",status:200,value:this}:(0,a.or)(e)}async finishInitialization(e){return this.initializeP??=this.initializeInternal(e),this.initializeP}async initializeInternal(e){await this.preInitialize(),e?((0,s.vA)(void 0===this.initProps,190),await this.initializingFromExisting()):await this.initializingFirstTime(this.context.createProps??this.initProps),await this.hasInitialized()}async preInitialize(){}async initializingFirstTime(e){}async initializingFromExisting(){}async hasInitialized(){}}class d extends c{constructor(){super(...arguments),this.rootDirectoryId="root"}get root(){if(!this.internalRoot)throw new Error(this.getUninitializedErrorString("root"));return this.internalRoot}async initializeInternal(e){e?(this.internalRoot=await this.runtime.getChannel(this.rootDirectoryId),this.internalRoot.attributes.type===o.n.Type&&this.runtime.logger.send({category:"generic",eventName:"MapDataObject",message:"Legacy document, SharedMap is masquerading as SharedDirectory in DataObject"})):(this.internalRoot=n.B.create(this.runtime,this.rootDirectoryId),this.internalRoot.bindToContext()),await super.initializeInternal(e)}getUninitializedErrorString(e){return`${e} must be initialized before being accessed.`}}},96516:(e,t,r)=>{"use strict";var o,n,i;r.d(t,{Go:()=>o}),function(e){e.NoOp="noop",e.ClientJoin="join",e.ClientLeave="leave",e.Propose="propose",e.Reject="reject",e.Accept="accept",e.Summarize="summarize",e.SummaryAck="summaryAck",e.SummaryNack="summaryNack",e.Operation="op",e.NoClient="noClient",e.RoundTrip="tripComplete",e.Control="control"}(o||(o={})),function(e){e.ClientJoin="join",e.ClientLeave="leave"}(n||(n={})),function(e){e.ThrottlingError="ThrottlingError",e.InvalidScopeError="InvalidScopeError",e.BadRequestError="BadRequestError",e.LimitExceededError="LimitExceededError"}(i||(i={}))},96689:(e,t,r)=>{"use strict";r.d(t,{Cx:()=>a,II:()=>i,JL:()=>o,K$:()=>n});const o="@fluidx/video-playback",n="@fluidx/video-playback-extended",i="@fluidx/video-notes-msa";class s{canLoad(e){const{packageName:t}=e;return t===o||t===i||t===n}async load(e){if(!this.canLoad(e))throw new Error("Incompatible loop code details.");return Promise.all([r.e(97950),r.e(63843),r.e(26922),r.e(95753),r.e(15319),r.e(89919),r.e(3280)]).then(r.bind(r,89919)).then(t=>({module:t,details:e}))}}const a={instantiateLoopCodeLoader:e=>Promise.resolve(new s)}},96752:(e,t,r)=>{"use strict";r.d(t,{HD:()=>s,P6:()=>o,Se:()=>n,db:()=>a,ou:()=>i});var o="__global__",n="__shadow_dom_stylesheet__",i={stylesheetKey:o,inShadow:!1,window:void 0,__isShadowConfig__:!0},s=function(e,t,r){return{stylesheetKey:e,inShadow:t,window:r,__isShadowConfig__:!0}},a=function(e){return!(!e||!function(e){return null!==e&&"object"===typeof e&&!Array.isArray(e)}(e))&&!0===e.__isShadowConfig__}},96826:(e,t,r)=>{"use strict";r.d(t,{C:()=>i});var o=r(91608),n=r(65922);const i=(0,o.W)(n.oZ)},97232:(e,t,r)=>{"use strict";r.d(t,{d:()=>o});let o=function(e){return e[e.Success_Hydrated=0]="Success_Hydrated",e[e.Success_E2oNotViewed=1]="Success_E2oNotViewed",e[e.Success_NoFluidUrl=2]="Success_NoFluidUrl",e[e.Success_Aborted=3]="Success_Aborted",e[e.Error_FluidHostWebApp_Exception=500]="Error_FluidHostWebApp_Exception",e[e.ExpectedError_FluidHostWebApp_CannotFetchContainerManifest=501]="ExpectedError_FluidHostWebApp_CannotFetchContainerManifest",e[e.Error_Fluid_Undefined=1e3]="Error_Fluid_Undefined",e[e.Error_Fluid_UnknownError=1001]="Error_Fluid_UnknownError",e[e.Error_RenderFailed=1002]="Error_RenderFailed",e[e.Error_FluidContainer_DataCorruption=2e3]="Error_FluidContainer_DataCorruption",e[e.Error_FluidContainer_GeneralError=2001]="Error_FluidContainer_GeneralError",e[e.Error_FluidContainer_ThrottlingError=2002]="Error_FluidContainer_ThrottlingError",e[e.Error_FluidContainer_DataProcessingError=2003]="Error_FluidContainer_DataProcessingError",e[e.Error_FluidContainer_UsageError=2004]="Error_FluidContainer_UsageError",e[e.Error_FluidContainer_ClientSessionExpiredError=2005]="Error_FluidContainer_ClientSessionExpiredError",e[e.ExpectedError_FluidDriver_AuthorizationError=3e3]="ExpectedError_FluidDriver_AuthorizationError",e[e.ExpectedError_FluidDriver_FetchFailure=3001]="ExpectedError_FluidDriver_FetchFailure",e[e.ExpectedError_FluidDriver_FileNotFoundOrAccessDenied=3002]="ExpectedError_FluidDriver_FileNotFoundOrAccessDenied",e[e.Error_FluidDriver_GenericError=3003]="Error_FluidDriver_GenericError",e[e.Error_FluidDriver_GenericNetworkError=3004]="Error_FluidDriver_GenericNetworkError",e[e.Error_FluidDriver_IncorrectServerResponse=3005]="Error_FluidDriver_IncorrectServerResponse",e[e.ExpectedError_FluidDriver_OfflineError=3006]="ExpectedError_FluidDriver_OfflineError",e[e.Error_FluidDriver_ThrottlingError=3007]="Error_FluidDriver_ThrottlingError",e[e.Error_FluidDriver_UnsupportedClientProtocolVersion=3008]="Error_FluidDriver_UnsupportedClientProtocolVersion",e[e.Error_FluidDriver_WriteError=3009]="Error_FluidDriver_WriteError",e[e.Error_FluidDriver_FileOverwrittenInStorage=3010]="Error_FluidDriver_FileOverwrittenInStorage",e[e.Error_FluidDriver_DeltaStreamConnectionForbidden=3011]="Error_FluidDriver_DeltaStreamConnectionForbidden",e[e.Error_FluidDriver_LocationRedirection=3012]="Error_FluidDriver_LocationRedirection",e[e.Error_FluidDriver_FluidInvalidSchema=3013]="Error_FluidDriver_FluidInvalidSchema",e[e.Error_FluidDriver_UsageError=3014]="Error_FluidDriver_UsageError",e[e.Error_FluidDriver_FileIsLocked=3015]="Error_FluidDriver_FileIsLocked",e[e.Error_FluidOdsp_CannotCatchUp=4e3]="Error_FluidOdsp_CannotCatchUp",e[e.Error_FluidOdsp_FetchTimeout=4001]="Error_FluidOdsp_FetchTimeout",e[e.ExpectedError_FluidOdsp_FluidNotEnabled=4002]="ExpectedError_FluidOdsp_FluidNotEnabled",e[e.Error_FluidOdsp_InvalidFileNameError=4003]="Error_FluidOdsp_InvalidFileNameError",e[e.Error_FluidOdsp_OutOfStorageError=4004]="Error_FluidOdsp_OutOfStorageError",e[e.Error_FluidOdsp_SnapshotTooBig=4005]="Error_FluidOdsp_SnapshotTooBig",e[e.Error_FluidOdsp_FetchTokenError=4006]="Error_FluidOdsp_FetchTokenError",e[e.Error_FluidOdsp_ServiceReadOnly=4007]="Error_FluidOdsp_ServiceReadOnly",e[e.Error_FluidOdsp_BlockedIPAddress=4008]="Error_FluidOdsp_BlockedIPAddress",e[e.Error_FluidOWH_ContainerUpgradeRequired=5e3]="Error_FluidOWH_ContainerUpgradeRequired",e[e.Error_FluidOWH_IFrameLoadFailed=5001]="Error_FluidOWH_IFrameLoadFailed",e[e.Error_FluidOWH_ComponentNotFound=5002]="Error_FluidOWH_ComponentNotFound",e[e.Error_FluidContainerLoad_RootComponentCreateFailed=6e3]="Error_FluidContainerLoad_RootComponentCreateFailed",e[e.Error_FluidContainerLoad_RaasNotSupported=6001]="Error_FluidContainerLoad_RaasNotSupported",e}({})},97340:e=>{var t=1e3,r=60*t,o=60*r,n=24*o,i=7*n,s=365.25*n;function a(e,t,r,o){var n=t>=1.5*r;return Math.round(e/r)+" "+o+(n?"s":"")}e.exports=function(e,c){c=c||{};var d=typeof e;if("string"===d&&e.length>0)return function(e){if((e=String(e)).length>100)return;var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!a)return;var c=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*s;case"weeks":case"week":case"w":return c*i;case"days":case"day":case"d":return c*n;case"hours":case"hour":case"hrs":case"hr":case"h":return c*o;case"minutes":case"minute":case"mins":case"min":case"m":return c*r;case"seconds":case"second":case"secs":case"sec":case"s":return c*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(e);if("number"===d&&isFinite(e))return c.long?function(e){var i=Math.abs(e);if(i>=n)return a(e,i,n,"day");if(i>=o)return a(e,i,o,"hour");if(i>=r)return a(e,i,r,"minute");if(i>=t)return a(e,i,t,"second");return e+" ms"}(e):function(e){var i=Math.abs(e);if(i>=n)return Math.round(e/n)+"d";if(i>=o)return Math.round(e/o)+"h";if(i>=r)return Math.round(e/r)+"m";if(i>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},97423:(e,t,r)=>{"use strict";var o,n;r.d(t,{$:()=>n,S:()=>o}),function(e){e.File="100644",e.Executable="100755",e.Directory="040000",e.Symlink="120000"}(o||(o={})),function(e){e.Blob="Blob",e.Tree="Tree",e.Attachment="Attachment"}(n||(n={}))},97813:(e,t,r)=>{"use strict";r.d(t,{$:()=>o});const o={verbose:10,default:20,error:30}},98123:(e,t,r)=>{"use strict";function o(){return i}r.r(t),r.d(t,{addReferralParamsToStreamUrl:()=>s,getNpmCodeLoader:()=>o});class n{canLoad(e){return"@fluidx/video-playback"===e.packageName}async load(e){if(!this.canLoad(e))throw new Error("Incompatible loop code details.");return{module:await Promise.all([r.e(97950),r.e(63843),r.e(26922),r.e(95753),r.e(15319),r.e(89919),r.e(19779)]).then(r.bind(r,54918)),details:e}}}const i={instantiateLoopCodeLoader:()=>Promise.resolve(new n)};function s(e,t){if("MailCompose"!==t&&"MailRead"!==t)return e;const r=new URL(e);if(r.searchParams.has("url"))return e;return function(e,t,r,o){const n=`${t}.${r}`,i=e.searchParams.getAll("referrer"),s=e.searchParams.getAll("referrerScenario");if(i.length>0&&i[i.length-1]===n){if(!o)return;if(o&&s.length>0&&s[s.length-1]===o)return}e.searchParams.append("referrer",n),o&&e.searchParams.append("referrerScenario",o)}(r,"Outlook","Win32","email-linkwithembed"),r.toString()}},98140:(e,t,r)=>{"use strict";r.d(t,{Fr:()=>d});const o=()=>"undefined"===typeof window;let n,i,s;const a=function(){return void 0===n&&(n=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document),n},c=function(){if(void 0===i){const e=navigator.userAgentData;i=e?.platform?"Android"===e.platform:navigator.userAgent.indexOf("Android")>=0}return i},d=function(){if(o())return!1;if(void 0===s){const e=navigator.userAgentData;if(e?.mobile)return!0;s=/Android|BlackBerry|Windows Phone|IEMobile|Opera Mini|iPhone|iPad|iPod/i.test(navigator.userAgent)||a()||c()}return s}},98256:(e,t,r)=>{"use strict";r.d(t,{P:()=>n});var o=r(12553);function n(e){const t=[];for(const r of e){let e,n;Array.isArray(r)?(e=r[0],n=r[1]):(e=r.name,n=r.value),t.push({name:e,value:n});const i=o.y.get(e);if(i)for(const r of i)if(void 0===t.find(e=>e.name===r)){const e={name:r,value:n};t.push(e)}}return t}},98483:(e,t,r)=>{"use strict";r.d(t,{a:()=>i});var o=r(24907),n=r(15894);class i extends n.SA{get isAttached(){return this.routeContext.isAttached}constructor(e,t,r){super(),this.value=e,this.path=t,this.routeContext=r,this.absolutePath=(0,o.a)(t,this.routeContext)}async get(){return this.value}attachGraph(){this.routeContext.attachGraph()}}},98581:(e,t,r)=>{"use strict";r.d(t,{R:()=>a});const o=["#C239B3","#CA5010","#E3008C","#A4262C","#498205","#69797E","#881798","#D13438","#0078D4","#038387","#750B1C","#986F0B","#4F6BED","#8764B8","#0B6A0B","#7A7574","#5C2E91","#005B70","#8E562E"],n=["#DC8990","#DA846B","#ECC26E","#B5CC99","#78C9A0","#85ACB8","#7FA3D0","#CC87B1","#E47CA1","#BF9D8C"],i="--ms-themeColorThemeName",s="dark";class a{get PresenceColorProvider(){return this}get Disposable(){return this.disposable}constructor(e){this.theming=e,this.nextColorToAssignIndex=0,this.colorAssignmentInFlight=new Set,this.deferredColorAssignment={},this.assignedColors=new Map,this.colorPalette=o,this.disposable={get Disposable(){return this},dispose:()=>{this.theming&&this.theming.off("themePropertiesChanged",this.themePropertiesChangedListener),this.colorAssignmentInFlight.clear(),this.assignedColors.clear()}},this.themePropertiesChangedListener=()=>{const e=this.getColorPaletteForTheme();e!==this.colorPalette&&(this.colorPalette=e,this.assignedColors.clear(),this.nextColorToAssignIndex=0)},this.theming?.on("themePropertiesChanged",this.themePropertiesChangedListener),this.colorPalette=this.getColorPaletteForTheme()}getColorPaletteForTheme(){return(this.theming?.themeName??this.theming?.themeProperties?.get(i))===s?n:o}dispose(){this.Disposable.dispose()}async getPresenceColorForUser(e){const t=this.assignedColors.get(e);if(t)return Promise.resolve(t);if(this.colorAssignmentInFlight.has(e))return new Promise(t=>{this.deferredColorAssignment[e].push(t)});this.colorAssignmentInFlight.add(e);const r=this.colorPalette[this.nextColorToAssignIndex];if(this.nextColorToAssignIndex=(this.nextColorToAssignIndex+1)%this.colorPalette.length,this.assignedColors.set(e,r),this.colorAssignmentInFlight.delete(e),void 0!==this.deferredColorAssignment[e])for(const o of this.deferredColorAssignment[e])o(r);return delete this.deferredColorAssignment[e],Promise.resolve(r)}}},99671:(e,t,r)=>{"use strict";r.d(t,{Cu:()=>v,Mh:()=>y,kt:()=>m});var o=r(2875),n=r(78796);const i="1",s="fluid",a="s",c="d",d="f",l="c",u="a",h="p",g="v",p="x";function m(e){const t=new URL(e.siteUrl),r=encodeURIComponent(t.pathname),n=encodeURIComponent(e.driveId),m=encodeURIComponent(e.itemId),f=encodeURIComponent(e.dataStorePath);let v=`${a}=${r}&${c}=${n}&${d}=${m}&${l}=${f}&${s}=${i}`;return e.appName&&(v+=`&${u}=${encodeURIComponent(e.appName)}`),e.containerPackageName&&(v+=`&${h}=${encodeURIComponent(e.containerPackageName)}`),e.fileVersion&&(v+=`&${g}=${encodeURIComponent(e.fileVersion)}`),e.context&&(v+=`&${p}=${encodeURIComponent(e.context)}`),(0,o.O0)(v)}const f="nav";function v(e,t){const r=m(t);e.searchParams.set(f,r)}function y(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const r=e.searchParams.get(f);if(!r)return;return function(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=new URLSearchParams((0,o.AH)(e)),i=n.get(s);if(r&&"1"!==i)return;const m=n.get(a),f=n.get(c),v=n.get(d),y=n.get(l),b=n.get(u)??void 0,S=n.get(h)??void 0,C=n.get(g)??void 0,k=n.get(p)??void 0;if(!m||!f||!v||null===y)return;let w;try{w=new URL(m,t)}catch{}return w?{siteUrl:w.href,driveId:f,itemId:v,dataStorePath:y,appName:b,containerPackageName:S,fileVersion:C,context:k}:void 0}(r,e.origin.toLowerCase()===n.W?n.i:e.origin,t)}}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var i=t[o]={id:o,loaded:!1,exports:{}};return e[o].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}r.m=e,r.F={},r.E=e=>{Object.keys(r.F).map(t=>{r.F[t](e)})},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;r.t=function(o,n){if(1&n&&(o=this(o)),8&n)return o;if("object"===typeof o&&o){if(4&n&&o.__esModule)return o;if(16&n&&"function"===typeof o.then)return o}var i=Object.create(null);r.r(i);var s={};e=e||[null,t({}),t([]),t(t)];for(var a=2&n&&o;("object"==typeof a||"function"==typeof a)&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach(e=>s[e]=()=>o[e]);return s.default=()=>o,r.d(i,s),i}})(),r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.f={},r.e=e=>Promise.all(Object.keys(r.f).reduce((t,o)=>(r.f[o](e,t),t),[])),r.u=e=>"static/js/"+({170:"InformationProtectionStrings82",361:"shareServiceStrings6",372:"genericLinkStrings84",467:"genericLinkStrings61",470:"genericLinkStrings37",522:"shareServiceStrings36",620:"shareServiceStrings81",1188:"cardloopstrings_ca-es-valencia-json",1214:"InformationProtectionStrings28",1261:"VideoPlaybackStrings59",1303:"graphapi",1686:"cardloopstrings_kok-json",1734:"InformationProtectionStrings15",1994:"cardloopstrings_en-gb-json",2118:"InformationProtectionStrings64",2246:"notificationac",2440:"fluidHost-odsp",2472:"cardloopstrings_sv-json",2544:"shareServiceStrings70",2690:"el-plex-strings-json",2744:"cardloopstrings_vi-json",2892:"InformationProtectionStrings40",3150:"graphservice",3181:"shareServiceStrings2",3280:"videoPlaybackComponent",3304:"genericLinkStrings0",3349:"genericLinkStrings23",3367:"viewtransformsac",3401:"hostUxStrings45",3459:"shareServiceStrings42",3642:"usermodule",3678:"VideoPlaybackStrings52",3900:"hostUxStrings4",4062:"VideoPlaybackStrings85",4085:"cardloopstrings_sq-json",4256:"genericLinkStrings31",4316:"hostUxStrings71",4440:"ar-plex-strings-json",4524:"MTSFoundInPlaces",4554:"InformationProtectionStrings19",4856:"driveitemmodule",4938:"InformationProtectionStrings68",5220:"activityac",5364:"shareServiceStrings74",5520:"InformationProtectionStrings13",5828:"unifiedgroupmodule",5851:"diffsyncmodule",6279:"shareServiceStrings46",6363:"addformrequirementdialog",6373:"InformationProtectionStrings85",6667:"hostUxStrings54",6689:"genericLinkStrings12",6725:"shareServiceStrings31",6830:"genericLinkStrings64",7010:"cardloopstrings_bs-latn-ba-json",7076:"genericLinkStrings35",7135:"genericLinkStrings29",7320:"cardloopstrings_ru-json",7464:"VideoPlaybackStrings54",7902:"cardloopstrings_tk-tm-json",8010:"permissionmodule",8081:"lb-lu-plex-strings-json",8340:"InformationProtectionStrings17",8446:"VideoPlaybackStrings38",8461:"cardloopstrings_km-kh-json",8500:"sr-latn-rs-plex-strings-json",8826:"cardloopstrings_ar-json",8857:"InformationProtectionStrings38",8996:"qps-ploc-plex-strings-json",9350:"VideoPlaybackStrings74",9444:"shareCallout",9496:"settingsac",9507:"genericLinkStrings3",9770:"userac",10041:"bucketmodule",10065:"shareServiceStrings40",10077:"cardloopstrings_quz-pe-json",10119:"nb-no-plex-strings-json",10135:"richtexteditorribbon",10301:"quz-pe-plex-strings-json",10332:"cardloopstrings_el-json",10361:"genericLinkStrings81",10475:"genericLinkStrings18",10506:"hostUxStrings2",10538:"PlannerComponent",10616:"genericLinkStrings62",10720:"gateddirectoryservice",10922:"hostUxStrings77",11133:"summaryModule",11567:"shareServiceStrings77",11966:"hostUxStrings15",11983:"cardloopstrings_sk-json",12870:"hostUxStrings51",12892:"genericLinkStrings17",12956:"socketModule",13170:"shareServiceStrings5",13181:"genericLinkStrings85",13276:"genericLinkStrings66",13279:"genericLinkStrings36",13311:"kk-plex-strings-json",13482:"FluidFramework-HashFallback",13499:"InformationProtectionStrings76",13667:"VideoPlaybackStrings57",14044:"he-plex-strings-json",14094:"InformationProtectionStrings37",14295:"cardloopstrings_eu-json",14427:"cardloopstrings_ko-json",14543:"InformationProtectionStrings14",14664:"telemetrymodule",14708:"hostUxStrings79",14782:"pt-pt-plex-strings-json",15286:"shareServiceStrings29",15353:"shareServiceStrings71",15434:"et-plex-strings-json",15456:"containermodule",15596:"odspservice",15700:"af-plex-strings-json",15797:"sr-cyrl-ba-plex-strings-json",16158:"genericLinkStrings20",16210:"hostUxStrings46",16268:"shareServiceStrings45",16487:"VideoPlaybackStrings53",16709:"hostUxStrings5",16740:"cardloopstrings_bn-bd-json",16766:"cardloopstrings_lo-la-json",16829:"cardloopstrings_zh-hant-json",17065:"genericLinkStrings30",17125:"hostUxStrings70",17620:"card-loop",17740:"cardloopstrings_ja-json",17880:"InformationProtectionStrings31",18106:"shareServiceStrings25",18329:"InformationProtectionStrings12",18407:"shareServiceStrings8",18510:"linksmodule",18623:"cardloopstrings_es-mx-json",18728:"cardloopstrings_fi-json",18848:"bs-latn-ba-plex-strings-json",19411:"gatedtsapi",19498:"genericLinkStrings11",19499:"VideoPlaybackStrings71",19632:"VideoPlaybackStrings29",19639:"genericLinkStrings65",19702:"InformationProtectionStrings73",19779:"fluidHost-videoLoop",19885:"genericLinkStrings34",20273:"VideoPlaybackStrings55",20731:"VideoPlaybackStrings66",20854:"cardloopstrings_bg-json",21139:"cardloopstrings_lb-lu-json",21149:"InformationProtectionStrings16",21211:"nl-plex-strings-json",21702:"cardloopstrings_de-json",21724:"planarchivedstateview",21910:"az-latn-az-plex-strings-json",22316:"genericLinkStrings4",22573:"hostUxStrings41",22874:"shareServiceStrings43",22968:"InformationProtectionStrings80",23170:"genericLinkStrings82",23394:"shareServiceStrings54",23425:"genericLinkStrings63",23488:"InformationProtectionStrings75",23840:"shareServiceStrings49",23852:"bg-plex-strings-json",23945:"genericLinkStrings56",24083:"InformationProtectionStrings32",24251:"hostUxStrings69",24309:"shareServiceStrings22",24376:"shareServiceStrings78",24637:"cardloopstrings_sd-arab-pk-json",24901:"loopappdialogs",25072:"VideoPlaybackStrings1",25115:"VideoPlaybackStrings13",25253:"editformdialog",25416:"pa-plex-strings-json",25701:"genericLinkStrings16",25785:"bucketac",25914:"planmodule",25921:"InformationProtectionStrings56",25979:"shareServiceStrings4",26047:"zh-cn-plex-strings-json",26088:"genericLinkStrings39",26308:"InformationProtectionStrings71",26329:"cardloopstrings_tt-json",26476:"VideoPlaybackStrings50",26584:"hi-plex-strings-json",26660:"cardloopstrings_et-json",26765:"genericLinkStrings52",26853:"playbackStateHandler",26873:"officeFluidOneDsSink",26903:"InformationProtectionStrings36",26934:"VideoPlaybackStrings63",26937:"cardloopstrings_es-json",26983:"cardloopstrings_kk-json",27211:"genericLinkStrings69",27517:"hostUxStrings78",27717:"gu-plex-strings-json",27719:"cardloopstrings_sr-cyrl-json",27837:"th-plex-strings-json",27861:"pl-plex-strings-json",27892:"VideoPlaybackStrings5",28095:"shareServiceStrings28",28162:"shareServiceStrings72",28318:"cardloopstrings_af-json",28391:"card-loop-jitcardview",28522:"VideoPlaybackStrings78",28573:"campaignmodule",28679:"genericLinkStrings7",28688:"InformationProtectionStrings0",28725:"InformationProtectionStrings78",28884:"cardloopstrings_ga-ie-json",29077:"shareServiceStrings44",29171:"InformationProtectionStrings83",29874:"genericLinkStrings33",29888:"genericLinkStrings8",29934:"hostUxStrings73",29936:"cardloopstrings_mi-nz-json",30138:"intelligenceac",30689:"InformationProtectionStrings30",30720:"VideoPlaybackStrings65",30759:"cardloopstrings_cs-json",30813:"es-mx-plex-strings-json",31209:"InformationProtectionStrings27",31318:"VideoPlaybackStrings16",31436:"hostUxStrings48",31487:"cs-plex-strings-json",31508:"InformationProtectionStrings4",31591:"bn-in-plex-strings-json",31902:"or-in-plex-strings-json",32124:"InformationProtectionStrings53",32175:"hostUxStrings29",32182:"shareServiceStrings1",32441:"VideoPlaybackStrings28",32465:"genericLinkStrings1",32511:"InformationProtectionStrings72",33019:"hostUxStrings83",33201:"directoryservice",33274:"hostUxStrings60",33321:"shareServiceStrings13",33477:"ca-plex-strings-json",33540:"VideoPlaybackStrings61",33555:"InformationProtectionStrings18",33720:"hostUxStrings75",33884:"SharepointNotificationService",33892:"cardloopstrings_ml-json",34095:"VideoPlaybackStrings6",34525:"shareServiceStrings75",34624:"ga-ie-plex-strings-json",34905:"ug-plex-strings-json",35104:"VideoPlaybackStrings10",35125:"genericLinkStrings5",35222:"hostUxStrings42",35848:"MTSFoundInPlacesInfo",35910:"InformationProtectionStrings59",35957:"VideoPlaybackStrings68",35968:"shareServiceStrings7",35979:"genericLinkStrings83",36074:"sv-plex-strings-json",36079:"tr-plex-strings-json",36203:"shareServiceStrings55",36234:"genericLinkStrings60",36297:"InformationProtectionStrings74",36754:"genericLinkStrings55",36818:"tasksbyplanviewac",36892:"InformationProtectionStrings35",37118:"shareServiceStrings21",37185:"shareServiceStrings79",37290:"cardloopstrings_gd-gb-json",37308:"taskmodule",37466:"genericLinkStrings77",37678:"VideoPlaybackStrings27",37711:"InformationProtectionStrings7",37881:"VideoPlaybackStrings0",37924:"VideoPlaybackStrings14",38146:"cardloopstrings_gl-json",38328:"cardloopstrings_kn-json",38422:"cardloopstrings_ur-json",38510:"genericLinkStrings15",38529:"cardloopstrings_uk-json",38730:"InformationProtectionStrings55",38788:"shareServiceStrings3",38856:"sl-plex-strings-json",38897:"genericLinkStrings38",39008:"hostUxStrings44",39117:"InformationProtectionStrings70",39477:"hostUxStrings67",39479:"fil-ph-plex-strings-json",39743:"VideoPlaybackStrings62",39862:"id-plex-strings-json",39923:"hostUxStrings76",40044:"card-loop-herocardview",40077:"cardloopstrings_th-json",40104:"apppoweredtasksection",40136:"cardloopstrings_be-by-json",40362:"intelligencemodule",40513:"tsgraphodataapi",40701:"VideoPlaybackStrings4",40856:"cardloopstrings_id-json",40904:"shareServiceStrings27",40971:"shareServiceStrings73",41165:"cardloopstrings_ka-json",41198:"hostUxStrings20",41252:"genericLinkStrings79",41380:"taskac",41464:"VideoPlaybackStrings21",41497:"InformationProtectionStrings1",41886:"shareServiceStrings47",41991:"genericLinkStrings58",42038:"PlannerLinkComponent",42067:"formresponseviewdialog",42296:"genericLinkStrings13",42406:"shareServiceStrings50",42437:"genericLinkStrings67",42503:"LazyPermissionsPopoverTrigger1",42743:"hostUxStrings72",42966:"LazyFluidMessageBannerStack",42967:"gatedconversationsservice",43008:"hostUxStrings80",43280:"cardloopstrings_fa-json",43529:"VideoPlaybackStrings64",43669:"genericLinkStrings70",44127:"VideoPlaybackStrings17",44245:"hostUxStrings49",44285:"ms-plex-strings-json",44317:"InformationProtectionStrings5",44729:"tt-plex-strings-json",44769:"PlannerInsertionComponent",44874:"gatedgraphapi",44933:"InformationProtectionStrings52",44941:"cardloopstrings_cy-json",44984:"hostUxStrings26",44991:"shareServiceStrings0",45274:"genericLinkStrings2",45371:"hostUxStrings47",45590:"LazyLastEdited",45828:"hostUxStrings84",46075:"diffsyncac",46120:"cardloopstrings_it-json",46130:"shareServiceStrings10",46192:"shareServiceStrings56",46349:"VideoPlaybackStrings60",46904:"VideoPlaybackStrings9",47107:"shareServiceStrings24",47169:"cardloopstrings_as-in-json",47174:"shareServiceStrings76",47534:"fa-plex-strings-json",47550:"uz-latn-uz-plex-strings-json",47649:"cardloopstrings_sr-cyrl-ba-json",47665:"qps-ploca-plex-strings-json",47667:"VideoPlaybackStrings22",47913:"VideoPlaybackStrings11",47934:"genericLinkStrings6",48031:"hostUxStrings43",48406:"cardloopstrings_hy-json",48499:"genericLinkStrings10",48547:"shareServiceStrings19",48704:"cardloopstrings_pa-in-json",48719:"InformationProtectionStrings58",48867:"ko-plex-strings-json",49012:"shareServiceStrings52",49106:"InformationProtectionStrings77",49505:"VideoPlaybackStrings46",49563:"genericLinkStrings54",49669:"cardloopstrings_pt-json",49701:"InformationProtectionStrings34",49927:"shareServiceStrings20",50177:"lt-plex-strings-json",50381:"InformationProtectionStrings23",50487:"VideoPlaybackStrings26",50520:"InformationProtectionStrings8",50618:"cardloopstrings_he-json",50690:"VideoPlaybackStrings3",50924:"fluidHost-cardLoop",50932:"mr-plex-strings-json",51187:"hostUxStrings25",51194:"cardloopstrings_no-json",51306:"planac",51319:"genericLinkStrings14",51383:"cardloopstrings_tr-json",51458:"cardloopstrings_fil-json",52253:"fr-plex-strings-json",52286:"hostUxStrings64",52487:"gatedplannerservice",52492:"LazyPermissionsPopoverTrigger2",52493:"shareServiceStrings17",53408:"te-plex-strings-json",53423:"cardloopstrings_ug-cn-json",53713:"shareServiceStrings26",54007:"hostUxStrings21",54014:"shareServiceStrings9",54061:"genericLinkStrings78",54062:"cardloopstrings_prs-json",54101:"cardloopstrings_ky-json",54273:"VideoPlaybackStrings20",54306:"InformationProtectionStrings2",54651:"cardloopstrings_am-json",54793:"VideoPlaybackStrings37",54853:"sq-plex-strings-json",54914:"hostUxStrings33",55215:"shareServiceStrings51",55547:"lv-plex-strings-json",55708:"VideoPlaybackStrings43",55766:"genericLinkStrings51",55807:"km-kh-plex-strings-json",55817:"hostUxStrings81",55892:"shareServiceStrings38",56012:"ur-plex-strings-json",56072:"hostUxStrings62",56176:"de-plex-strings-json",56186:"kn-plex-strings-json",56338:"VideoPlaybackStrings67",56458:"userplansretrievalac",56478:"genericLinkStrings73",56936:"VideoPlaybackStrings18",57339:"cardloopstrings_si-lk-json",57488:"InformationProtectionStrings62",57605:"es-plex-strings-json",57613:"VideoPlaybackStrings33",57628:"cardloopstrings_mt-mt-json",57668:"cardloopstrings_sr-json",57742:"InformationProtectionStrings51",57793:"hostUxStrings27",57877:"cardloopstrings_ca-json",58135:"cardloopstrings_en-us-json",58180:"hostUxStrings40",58555:"shareServiceStrings60",58637:"hostUxStrings85",58800:"cardloopstrings_zu-za-json",59001:"shareServiceStrings57",59007:"sr-cyrl-rs-plex-strings-json",59062:"card-loop-adaptivecardview",59106:"genericLinkStrings46",59432:"VideoPlaybackStrings83",59494:"VideoPlaybackStrings49",59552:"genericLinkStrings57",59713:"VideoPlaybackStrings8",59805:"cy-gb-plex-strings-json",59850:"InformationProtectionStrings33",59858:"hostUxStrings68",59885:"uk-plex-strings-json",59916:"shareServiceStrings23",59941:"AshaUtils",59950:"cardloopstrings_ro-json",60250:"lo-plex-strings-json",60264:"genericLinkStrings75",60308:"InformationProtectionStrings66",60370:"InformationProtectionStrings24",60476:"VideoPlaybackStrings25",60722:"VideoPlaybackStrings12",61082:"InformationProtectionStrings46",61528:"InformationProtectionStrings57",61578:"ml-plex-strings-json",61821:"shareServiceStrings53",62275:"hostUxStrings61",62314:"VideoPlaybackStrings45",62364:"da-plex-strings-json",62372:"genericLinkStrings53",62521:"cardloopstrings_mk-json",62530:"card-loop-signincardview",62547:"cardloopstrings_ne-np-json",62672:"requirementssection",63030:"InformationProtectionStrings20",63056:"hostUxStrings8",63120:"cardloopstrings_ha-latn-ng-json",63329:"InformationProtectionStrings9",63499:"VideoPlaybackStrings2",63605:"qps-plocm-plex-strings-json",63874:"plannerservice",63937:"hostUxStrings38",63996:"hostUxStrings22",64062:"cardloopstrings_mr-json",64238:"shareServiceStrings58",64332:"InformationProtectionStrings79",64720:"VideoPlaybackStrings72",64758:"shareServiceStrings65",64868:"InformationProtectionStrings48",64969:"ne-np-plex-strings-json",65013:"shareServiceStrings80",65095:"hostUxStrings65",65142:"shareServiceStrings14",65354:"SharepointInformationProtectionService",65607:"InformationProtectionStrings29",65635:"VideoPlaybackStrings80",66147:"nn-no-plex-strings-json",66467:"genericLinkStrings76",66511:"InformationProtectionStrings65",66676:"gl-plex-strings-json",66816:"InformationProtectionStrings26",67070:"cardloopstrings_uz-json",67082:"VideoPlaybackStrings23",67085:"VideoPlaybackStrings15",67115:"InformationProtectionStrings3",67285:"InformationProtectionStrings41",67336:"hostUxStrings13",67578:"shareServiceStrings69",67602:"VideoPlaybackStrings34",67723:"hostUxStrings32",67731:"InformationProtectionStrings54",67782:"hostUxStrings28",67846:"it-plex-strings-json",67910:"removeformconfirmationdialog",68054:"ca-es-valencia-plex-strings-json",68240:"hostUxStrings57",68415:"cardloopstrings_nl-json",68455:"VideoPlaybackStrings84",68517:"VideoPlaybackStrings42",68544:"shareServiceStrings63",68575:"genericLinkStrings50",68626:"hostUxStrings82",68701:"shareServiceStrings39",68881:"hostUxStrings63",68928:"shareServiceStrings12",69018:"diffsyncstateac",69287:"genericLinkStrings72",69356:"hu-plex-strings-json",69427:"eu-plex-strings-json",69702:"VideoPlaybackStrings7",69745:"VideoPlaybackStrings19",69807:"zh-tw-plex-strings-json",70297:"InformationProtectionStrings63",70506:"kok-plex-strings-json",70551:"InformationProtectionStrings50",70602:"hostUxStrings24",70915:"cardloopstrings_hr-json",71060:"hostUxStrings53",71118:"shareServiceStrings32",71122:"hostUxStrings19",71364:"shareServiceStrings67",71398:"conversationsservice",71486:"cardloopstrings_sl-json",71528:"genericLinkStrings26",71564:"VideoPlaybackStrings69",71888:"cardloopstrings_zh-hans-json",71915:"genericLinkStrings47",71981:"cardloopstrings_bn-in-json",72241:"VideoPlaybackStrings82",72303:"VideoPlaybackStrings48",72306:"cardloopstrings_da-json",72758:"cardloopstrings_te-json",72839:"VideoPlaybackStrings39",72883:"createNewModule",73073:"genericLinkStrings74",73117:"InformationProtectionStrings67",73179:"InformationProtectionStrings25",73285:"VideoPlaybackStrings24",73318:"InformationProtectionStrings6",73539:"hostUxStrings10",73580:"SharepointShareService",73743:"VideoPlaybackStrings75",73851:"uilayoutac",73926:"hostUxStrings37",74017:"cardloopstrings_lt-json",74332:"genericLinkStrings48",74874:"augloopapi",74904:"shareServiceStrings34",75084:"hostUxStrings66",75107:"hr-plex-strings-json",75291:"shareServiceStrings11",75458:"cardloopstrings_fr-ca-json",75562:"cardloopstrings_hu-json",75563:"cardloopstrings_sw-json",75865:"hostUxStrings9",75990:"formrequirementiframedialog",76359:"hostUxStrings14",76794:"en-gb-plex-strings-json",76805:"hostUxStrings23",76902:"notificationmodule",77047:"shareServiceStrings59",77263:"hostUxStrings50",77529:"VideoPlaybackStrings73",77548:"gd-plex-strings-json",77567:"shareServiceStrings64",77598:"genericLinkStrings59",77677:"InformationProtectionStrings49",77712:"hostUxStrings31",77731:"genericLinkStrings25",77738:"card-loop-thumbnailcardview",77822:"shareServiceStrings83",77878:"ru-plex-strings-json",77951:"shareServiceStrings15",78118:"genericLinkStrings42",78622:"linksac",79094:"vi-plex-strings-json",79276:"genericLinkStrings71",79379:"cardloopstrings_lv-json",80094:"InformationProtectionStrings42",80145:"hostUxStrings12",80198:"cardloopstrings_hi-json",80411:"VideoPlaybackStrings35",80529:"cardloopstrings_fr-json",80532:"hostUxStrings35",80551:"genericLinkStrings21",80616:"cardloopstrings_or-json",80720:"mi-nz-plex-strings-json",80819:"dialogac",81049:"hostUxStrings56",81102:"hostUxStrings6",81107:"shareServiceStrings37",81200:"genericLinkStrings80",81326:"VideoPlaybackStrings41",81353:"shareServiceStrings62",81514:"approvalrequestsection",81608:"shareServiceStrings85",81802:"fr-ca-plex-strings-json",81904:"genericLinkStrings44",82013:"cardloopstrings_nn-no-json",82368:"StreamEmbeddedRenderer",82689:"card-loop-o365connectorscardview",82707:"reactplayer",82722:"InformationProtectionStrings11",83069:"notificationbar",83106:"InformationProtectionStrings60",83479:"tenantmodule",83869:"hostUxStrings52",83880:"InformationProtectionStrings44",83892:"VideoPlaybackStrings76",83927:"shareServiceStrings33",83931:"hostUxStrings18",84006:"fi-plex-strings-json",84173:"shareServiceStrings66",84314:"shareServiceStrings18",84337:"genericLinkStrings27",84465:"formattachmentslist",84666:"VideoPlaybackStrings56",84724:"genericLinkStrings40",84807:"whiteboard-loop-component",84888:"hostUxStrings0",85050:"VideoPlaybackStrings81",85112:"VideoPlaybackStrings47",85164:"ta-plex-strings-json",85411:"as-in-plex-strings-json",85523:"InformationProtectionStrings69",85988:"InformationProtectionStrings22",86286:"hostUxStrings59",86348:"hostUxStrings17",86357:"cardloopstrings_is-json",86614:"VideoPlaybackStrings30",86735:"hostUxStrings36",87141:"genericLinkStrings49",87361:"InformationProtectionStrings81",87397:"mk-plex-strings-json",87713:"shareServiceStrings35",87986:"ja-plex-strings-json",88100:"shareServiceStrings16",88233:"shareServiceStrings48",88452:"VideoPlaybackStrings58",88605:"cardloopstrings_gu-json",89088:"mt-mt-plex-strings-json",89245:"cardloopstrings_pl-json",90083:"InformationProtectionStrings47",90338:"VideoPlaybackStrings70",90400:"VideoPlaybackStrings36",90422:"pt-br-plex-strings-json",90521:"hostUxStrings30",90540:"genericLinkStrings22",90631:"shareServiceStrings82",90791:"sk-plex-strings-json",90869:"VideoPlaybackStrings51",90927:"genericLinkStrings43",91091:"hostUxStrings3",91315:"VideoPlaybackStrings44",91955:"gatedtenantservice",92191:"InformationProtectionStrings21",92345:"is-plex-strings-json",92755:"VideoPlaybackStrings79",92796:"unifiedgroupac",92903:"InformationProtectionStrings43",92954:"hostUxStrings11",92957:"ka-plex-strings-json",93220:"VideoPlaybackStrings32",93341:"hostUxStrings34",93564:"InformationProtectionStrings84",93818:"plantaskboardpage",93858:"hostUxStrings55",93911:"hostUxStrings7",93916:"shareServiceStrings30",94084:"ro-plex-strings-json",94135:"VideoPlaybackStrings40",94162:"shareServiceStrings61",94258:"appLazy",94267:"genericLinkStrings32",94281:"genericLinkStrings9",94326:"genericLinkStrings28",94417:"shareServiceStrings84",94680:"shareDialog",94713:"genericLinkStrings45",95336:"containerac",95416:"cardloopstrings_az-latn-az-json",95531:"InformationProtectionStrings10",95638:"cardloopstrings_pt-pt-json",95915:"InformationProtectionStrings61",96048:"InformationProtectionStrings39",96579:"shareServiceStrings68",96689:"InformationProtectionStrings45",96701:"VideoPlaybackStrings77",96924:"tenantservice",97138:"groupdocumentsac",97146:"genericLinkStrings24",97160:"FluidDocumentServiceFactoryContainer",97256:"shareServiceStrings41",97533:"genericLinkStrings41",97666:"genericLinkStrings19",97697:"hostUxStrings1",97969:"cardloopstrings_ms-json",98050:"genericLinkStrings68",98113:"hostUxStrings74",98400:"cardloopstrings_mn-mn-json",98434:"cardloopstrings_ta-json",98903:"am-et-plex-strings-json",99095:"hostUxStrings58",99157:"hostUxStrings16",99171:"gatedodspservice",99423:"VideoPlaybackStrings31",99544:"hostUxStrings39"}[e]||e)+"."+{170:"df29fd9c",361:"f9f516bb",372:"397a76c5",467:"22bf533b",470:"8a014eb3",522:"c7114ae6",620:"02c103a8",1188:"3130413b",1214:"10c915ba",1261:"58d042b7",1303:"d4977def",1686:"940ef5f6",1734:"a7b8ed93",1994:"279b3c84",2118:"82e284e5",2246:"47ded68c",2338:"8e1d76bc",2440:"f905f14a",2472:"23ecda91",2544:"34a67bef",2690:"30b7cc26",2744:"6ef4f9d1",2892:"d8b48e18",2977:"e574aa90",3150:"edcec5b9",3181:"862e8d68",3201:"d55edb60",3280:"1fd89db2",3304:"c43e398b",3349:"2d73bc7b",3367:"5826955c",3401:"fda99179",3459:"57f395a2",3642:"5eb5b715",3678:"634ecb60",3763:"28d29712",3900:"c17e35eb",4004:"ee48004f",4062:"d4adb9a2",4085:"5cc393c2",4256:"5fcfc7c2",4316:"be6bbb0e",4440:"fefdfd0a",4474:"5bc6cf65",4524:"0432dd45",4554:"573673a7",4856:"cc5d26c5",4938:"883f8340",5220:"fa819d2a",5364:"9288bf8a",5520:"7c937dd8",5828:"e35c957a",5851:"620b2b49",5891:"c180baa8",5899:"2632c76d",6279:"03c31df8",6307:"b550a112",6363:"f8374a7d",6373:"5a56ce3a",6471:"f25812de",6667:"fa0cad71",6689:"e912225b",6725:"55500ce1",6830:"cce64366",7010:"249d1616",7076:"b0311407",7135:"a605fe82",7320:"a124bacd",7374:"3035317b",7464:"020a45a3",7509:"3909e18a",7670:"bc0435d1",7691:"ec5a2635",7902:"c34a86e1",7911:"38d001a0",8010:"5b7d17cd",8081:"2f36033d",8088:"90f4bf81",8340:"dce6533a",8446:"51f3d695",8461:"b8078869",8500:"f1879814",8513:"7d35fbb9",8826:"2fef37cc",8857:"371377ea",8928:"d873cb08",8996:"4d67d6bb",9350:"47f4c66e",9444:"8fe8a26a",9496:"d812ff04",9507:"362fba53",9770:"90c68207",9858:"b74e7c43",10041:"50d08274",10065:"aae827df",10077:"b6b5ef22",10119:"e159284f",10135:"ba9dfba8",10301:"adf0636b",10332:"d7a49b96",10361:"c4754ed2",10475:"b2b16796",10506:"ace73268",10510:"b48b2e86",10538:"7b17a25e",10572:"41bf68f0",10616:"d5394cd6",10632:"cf14d010",10672:"a1e1cca8",10720:"0705ab79",10922:"3cc902ba",11072:"9f891a55",11133:"b31fa391",11299:"ec28828a",11354:"a6f3608e",11567:"0ba50d87",11966:"2676cb8c",11983:"c07f0ae2",12156:"bc925d77",12481:"2c0aa806",12870:"165b2b94",12892:"c350578e",12956:"72d1ed2d",13039:"df224177",13170:"66cd85f4",13181:"229eec15",13276:"575797a2",13279:"389697d6",13311:"35ffcf7d",13482:"5b7a851e",13499:"31fc9e61",13667:"f54b0ec2",14044:"326f8f8b",14094:"d61c4b55",14183:"c860a302",14295:"79bf645d",14427:"5971fa1b",14543:"d8e5e909",14664:"c998e6fc",14708:"4967d830",14782:"8033f558",15286:"2e824b57",15319:"d0c28741",15353:"74e78afa",15434:"a53cbe55",15456:"95432005",15520:"765137ef",15596:"edd7e7df",15700:"126c4217",15797:"040742b7",15947:"c35df54d",16158:"8ba70591",16210:"ce52a13c",16268:"21238030",16487:"e7e0161b",16709:"ccaa0293",16740:"eb065be2",16766:"5f8b242b",16829:"b858b537",17065:"e56e2e83",17122:"0ff36369",17125:"eb8c9554",17323:"c868180f",17620:"c5fddb89",17740:"99aa8cd9",17880:"236a44f9",17925:"f05edffd",18095:"ad9793b0",18106:"06c344de",18196:"f961a622",18329:"89ca0982",18407:"6be4f44c",18510:"9b364c25",18623:"4a2d88cd",18728:"25eab4ba",18848:"abe87bf0",19347:"39bdf0ee",19411:"c4a67746",19498:"0f44580b",19499:"8549e91f",19632:"229e77c2",19639:"6948d1c8",19702:"812d18ba",19779:"39f670cc",19885:"d805f481",20273:"26b9b78e",20559:"7a785589",20731:"c4932de9",20854:"889f2b7f",21139:"f1f20191",21149:"ff85d63b",21211:"af13fe8d",21702:"cf3ebee5",21724:"adb78429",21910:"a1566708",22316:"49ddfb97",22362:"a9c9d3d4",22514:"af257769",22573:"5fea33cb",22874:"66adc056",22968:"a56b651c",23170:"66374bfd",23329:"9c6fe0b9",23394:"597aa001",23425:"7aaf8389",23488:"c7ed9f1a",23840:"99e458d6",23852:"d244f7e0",23945:"ecb6a8ec",24083:"bf68e52b",24251:"eb62cbec",24309:"95fadcc4",24376:"9d895ddf",24637:"555ebe0b",24901:"2d07e3fb",25072:"e30a0122",25115:"7b789335",25253:"705dc3fa",25416:"caa983ff",25621:"4e779645",25701:"6c0661da",25785:"8a0fdbb8",25914:"9619e187",25921:"5d1e55f6",25979:"c104abfd",26047:"2ecdf555",26088:"78fb6521",26308:"9d3a96f6",26329:"08d3d155",26476:"562813e6",26584:"32354de1",26660:"170813d5",26676:"5aebfdfd",26748:"69495e46",26765:"01b00a1f",26853:"440d86bf",26873:"7fdaa576",26903:"c24b5ed6",26922:"fd3f9751",26934:"d7bd2b71",26937:"c4d129e1",26983:"9d14dcd1",27211:"365fe64f",27443:"9b7fbe86",27517:"f24a2866",27717:"7c043ca2",27719:"c7c607b8",27837:"91a2d486",27861:"5db9f3c0",27892:"f03d0587",28095:"b4eba634",28097:"69ba1e35",28162:"a483b340",28318:"c862b7e4",28391:"a847feae",28522:"57a93f5f",28566:"f541d9d4",28573:"8629ecd8",28679:"654db585",28688:"2b020079",28725:"1a12be39",28884:"0095d748",29077:"0d9ff76b",29171:"44d12adf",29874:"bee628d5",29888:"38be1336",29934:"092c30fb",29936:"c5e6e698",30138:"6141adc5",30689:"0a016b19",30712:"0d2022d8",30720:"eb53ecea",30759:"dbc3e55c",30813:"cef86744",31209:"165e1013",31318:"b34045aa",31436:"b33aa25f",31487:"0614cb3b",31508:"efa6fa45",31591:"0d495cc0",31902:"3b1578f0",32124:"6dd31628",32175:"88902999",32182:"bd7b93e4",32441:"1ce0c677",32465:"d2dd5ff2",32511:"3fa4a68f",32870:"e379689c",33019:"2fd9f085",33028:"9115ce6a",33201:"93b81df4",33274:"bd810795",33321:"23fc727b",33477:"ba05bece",33540:"d3f32f77",33555:"c541ad1d",33720:"07391a4e",33884:"617c2053",33892:"fb84da9a",34095:"a09aeb52",34167:"acaf98c6",34525:"35cae828",34624:"3399d235",34905:"d1bc9941",35104:"bfa95e47",35125:"4beea734",35222:"ff0de44c",35848:"460fd6da",35910:"ad15e651",35957:"7e00c6a6",35968:"1a3e88a7",35979:"211cd000",36074:"054903ea",36077:"23fb8799",36079:"2c48372c",36203:"a4f07062",36234:"6ac5a287",36297:"2cf42b3e",36738:"4614f74e",36754:"c2ffc3b7",36818:"9d3a7061",36892:"c666924e",37118:"5134ef1a",37185:"f5fb70e8",37290:"251e252d",37308:"2306896a",37466:"b1fd3f46",37678:"50ab1d79",37711:"efc5bd1e",37801:"de524dc3",37881:"92482127",37924:"333bcdcd",38146:"259bba44",38328:"eccd63d2",38422:"0999da05",38428:"30e40dd6",38510:"ec0775b8",38529:"76b41aaa",38730:"bc6c6646",38788:"f4079ee1",38856:"cbdc5182",38897:"0383b7ac",39008:"a4733216",39117:"87b3a1bd",39477:"b8ae9781",39479:"aafdf716",39743:"6304f6ba",39862:"a6d105b0",39923:"5add9727",40044:"6beaa6eb",40077:"0ac3267b",40104:"2c9a647e",40135:"8fe51d5b",40136:"3ade7473",40362:"ceabb14d",40513:"f4cb8c96",40701:"92369cb3",40738:"3376e04c",40856:"7a2835b0",40904:"e2a8b0a6",40971:"993805b8",41165:"2e8ac0d8",41198:"d1260d25",41252:"0fbe0daa",41380:"d16ac60f",41464:"a39223d8",41497:"c94de3c2",41514:"f32f009d",41717:"3f0933e2",41886:"5ac30849",41991:"d062f4c5",42038:"a124e07b",42067:"110062d5",42296:"7264db42",42406:"374a5094",42437:"50c8ddbd",42503:"9abeda84",42743:"77aa225b",42966:"78eac1e3",42967:"b8605171",43008:"81c93c4e",43164:"40e2375e",43280:"bc9e064c",43529:"d25c388c",43669:"00909551",44127:"2e6cb74f",44245:"3fd7eba7",44285:"3d5ba410",44317:"175edd5a",44729:"9ea2be9e",44769:"e0088522",44874:"f56edd5d",44933:"52530611",44941:"cd3f9bc7",44984:"6be5f77d",44991:"aa7370d7",45092:"2be87bb0",45274:"3f39ca7c",45371:"239e6401",45590:"c26fd2d8",45828:"1450838c",46075:"06c079b0",46120:"50278da8",46130:"27b6487b",46192:"805fc2b0",46349:"e3b1499a",46441:"0cc15476",46904:"8836400f",47107:"53d8a9f0",47169:"805a405e",47174:"a2e83bdd",47534:"42587659",47550:"700e25bd",47649:"43c6be34",47665:"bf03c6fb",47667:"e8176ca5",47880:"62dd8974",47913:"6388ad98",47934:"351e3bf5",48031:"ebc6f5d6",48406:"d0654a62",48453:"4b9e0f37",48499:"97c5732d",48547:"b725b29b",48704:"98cfda0f",48719:"41ff918b",48867:"15f871f9",49012:"a3c15f72",49106:"fe216ce1",49306:"d56fd805",49505:"ea8cf1b4",49563:"990f55d8",49669:"fa8b5915",49701:"1720f3fe",49927:"8b569464",50008:"d1e0818e",50177:"d637f120",50381:"816d764c",50487:"ad90ec31",50520:"d03b3a31",50618:"57f7516c",50690:"3c11a30b",50787:"ca64e9ed",50924:"f6ac0b1c",50932:"2c721589",51187:"7cb62e45",51194:"374f1e10",51306:"80eda57c",51319:"e950b7a5",51383:"cbb4d767",51458:"7ab60d0e",52253:"6de8ca41",52286:"9a29b770",52326:"89b278e9",52487:"02c33712",52492:"e0bda164",52493:"7a8bf844",52753:"6e2a448b",53205:"5a7f09b0",53408:"b823afb3",53423:"037c96a2",53713:"c7f6951d",54007:"3e8c5c59",54014:"4b144c86",54061:"50560c49",54062:"0d9c862d",54101:"54acb04c",54273:"51cc121c",54306:"9e82b8af",54651:"8f34269f",54793:"ac590c8e",54853:"baa0f30c",54914:"6ce6c23c",55198:"329005c8",55215:"12e12b69",55307:"a88ba001",55346:"12a380f1",55547:"56f56229",55708:"cd4779dc",55766:"16380b2f",55807:"d97e0fc8",55817:"6d53a086",55832:"10d319d1",55874:"9ef270e9",55892:"f929f683",55953:"38ef062d",56012:"31e09227",56072:"a5db23d3",56176:"14df32bd",56186:"f5368652",56295:"1429c05b",56338:"7651dc2b",56458:"73ce5710",56478:"93585a52",56510:"46acbf19",56936:"0e7acf5a",57339:"5a17e22e",57365:"8ce85dde",57397:"c01d2eb7",57488:"002903a3",57605:"d120837a",57613:"85e71fb4",57628:"39dbb7d9",57668:"316013bc",57742:"72378a11",57793:"2a1a1b62",57833:"364ef594",57877:"0f4dc581",57939:"64741cee",57940:"c49f0d7b",58135:"44be16d4",58180:"c9820112",58555:"e68931f1",58637:"c518a9c6",58800:"aabc9ad9",58888:"657da5f2",59001:"0f154fa1",59007:"04d7639a",59062:"7a21b1d2",59106:"48f6a6ef",59108:"593ba1a1",59432:"e094877f",59494:"d75da880",59552:"267f488a",59713:"69b56005",59805:"967c2e41",59850:"36d329e3",59858:"3efe0c65",59885:"ff2cb0ea",59916:"f891e96e",59941:"cc8d7432",59950:"555aaf29",60250:"9671ed49",60264:"74eb9a67",60308:"bc8726c7",60370:"9e7190f6",60476:"b1925687",60722:"207caffe",61082:"e464f16b",61374:"ee1b3c43",61528:"56486f7c",61578:"b8283078",61821:"b33d85b0",62200:"8f399125",62275:"852e7d9f",62314:"b267829f",62364:"80a3440b",62372:"d07aa3f9",62521:"a982cef7",62530:"05a67880",62547:"7142b364",62672:"faa15b40",63030:"7f9a21da",63056:"3d25664a",63120:"41920302",63329:"f2045d6d",63499:"8ca357d0",63605:"a92ef0e9",63843:"6af1aa35",63874:"8f01ef4b",63937:"01f26052",63996:"dcb8f247",64062:"e0ebe9a5",64238:"a04ea059",64332:"a8f95669",64720:"568ad867",64758:"e6eb48a0",64868:"c3327c8d",64969:"185caf1d",65013:"0356b37e",65095:"7b568aa0",65142:"43485757",65156:"af5194fd",65354:"ee40b403",65607:"b9a7e0e5",65635:"314dd8f2",65662:"f10dbc8f",66147:"6344bdfa",66390:"c1cab509",66467:"fe3ad198",66511:"7e808a63",66561:"e945d044",66676:"09d6321e",66816:"df8bddf2",67070:"ff287912",67082:"050cb2cf",67085:"5b69a4ae",67115:"9a645f44",67285:"8d9ad1a6",67336:"16387c2d",67578:"2d08216c",67602:"d47ecc08",67723:"2bc7c865",67731:"4d976270",67782:"f88bcfc9",67846:"86414de8",67910:"147d2de8",68054:"b8aec4b9",68212:"6ce6455e",68240:"56f1a880",68346:"e797a10a",68415:"28543865",68455:"6ab6ef6d",68517:"439eedb8",68544:"323c1ac2",68575:"f763254b",68626:"1631aa65",68701:"d15c341a",68881:"d018e7ab",68928:"520609a5",69018:"db61a3cc",69110:"4e922c11",69287:"4f8350e3",69356:"cd4c705b",69427:"a71e92c5",69698:"997502e6",69702:"a368c353",69745:"601c10bf",69807:"ff41603e",70297:"50ff3fcf",70506:"55b2f704",70551:"8122ddd5",70602:"65cecdc1",70915:"79f5e4e9",71060:"393275b9",71118:"21a04e5e",71122:"6c0d8e8c",71364:"cd63b3db",71398:"6a7f5f1a",71486:"bcd3544e",71528:"01015989",71564:"f995eb4e",71888:"c6f16485",71915:"f36cfc7d",71981:"42d80f73",72241:"e6caccad",72303:"55e41237",72306:"1fa529f5",72520:"2b857c24",72567:"fa5a955d",72758:"72e48e72",72839:"c51cfedd",72883:"86f9750c",73073:"1f78a31a",73117:"19088935",73179:"5c9afd8f",73285:"22345db7",73318:"6b32d4e8",73539:"29ba6bc2",73580:"bc4c24d2",73743:"30c1677e",73851:"b6f1bb82",73926:"22af840d",74017:"02364360",74332:"f086e8f9",74874:"19798eca",74904:"161e9f53",75084:"e545cd1c",75107:"cf886dd7",75291:"68483bc3",75458:"44494e90",75562:"7afde610",75563:"b7760b05",75865:"72ec99a8",75959:"d3e6b7f3",75990:"35f08b6c",76115:"a97d7113",76128:"ce8ae84d",76359:"908a9d8b",76794:"a7b4c0e0",76805:"5fd5812a",76902:"34e90045",77047:"cf19f472",77263:"0af97a75",77529:"4144f884",77548:"1cc28361",77567:"8f8d5cd7",77598:"9ef9bfc6",77677:"d60f9b59",77712:"9817a780",77731:"cfb83fca",77738:"64953794",77771:"b3432227",77822:"85f7be41",77873:"7ce95b64",77878:"5b4a45fa",77951:"369ba8e9",78118:"311acb53",78622:"c3b64f52",79094:"caeb52b6",79276:"c0dc370f",79327:"81370b48",79379:"4904c15e",79450:"a70b5825",80094:"cf6c889b",80145:"832d2dc1",80198:"49208d9a",80411:"e1af4613",80529:"bd60c492",80532:"b29d671b",80551:"cf2ebc92",80616:"650fd0d9",80708:"6e02f030",80720:"d166fb9a",80819:"cf80531a",81049:"cb3da63c",81102:"666fd34c",81107:"8e5fb4f8",81200:"01372665",81326:"f8cada36",81353:"1b724ff3",81514:"aee2a6be",81540:"874b6538",81608:"05621f6e",81802:"38a2fd52",81904:"5305318a",82013:"dde0396d",82270:"f4a82c6a",82368:"35694578",82440:"1e01a4de",82689:"1921f771",82707:"39e19a3d",82722:"9f418701",83069:"3cff70cb",83106:"25bdd5d6",83479:"fc731691",83869:"88e49d2a",83880:"1554f95a",83892:"8615d993",83927:"2b460341",83931:"121babf6",84006:"b21309d5",84173:"640f8e3c",84314:"fbed26f1",84337:"1fdef56e",84465:"2f282961",84666:"be8cf3c3",84724:"30281c0d",84807:"bd044b99",84888:"cbe6b011",85031:"0ce7295b",85050:"d4c4c25e",85112:"b1e2b5e9",85164:"ffa9b723",85411:"34e5d7cc",85523:"785eb32e",85902:"296ac372",85916:"2be57f66",85988:"0dae9b26",86286:"bf18e155",86348:"0a9be234",86357:"30222245",86614:"54011a49",86735:"9ff7fdb6",87141:"6224f417",87361:"41be5204",87397:"44fb94c7",87713:"9e4d446a",87986:"7a44cbf6",88100:"2461ad78",88233:"f09a2260",88452:"3771cd13",88605:"d2e39040",88652:"03d79ad6",88974:"225c0a5e",89088:"b91f0930",89245:"258199eb",89441:"52f0d00b",89520:"a43b6e93",89559:"0f161f9f",89919:"1c59cb4b",90083:"094f5020",90338:"7dcef79c",90400:"04a4244a",90422:"a05e9608",90521:"97fa06dc",90540:"4388930d",90631:"d5f19a28",90791:"dec2fb86",90869:"ff658012",90927:"3d12454c",90976:"d40afd37",91091:"5c036567",91315:"6d1972f9",91955:"cbcf84e8",92191:"98e2de9d",92345:"0b9e4bbc",92755:"f89c2390",92796:"d7fced92",92903:"fc5807b0",92954:"f86553c6",92957:"c44f208d",93220:"051d9790",93341:"d962d9de",93420:"4fc4a4e0",93564:"e36e7bb6",93818:"cfda1e3e",93858:"e1373e9c",93892:"add3f91b",93911:"40186ec6",93916:"8f120f1b",94084:"a99afffc",94135:"43e42eab",94162:"96a6f610",94258:"3c0db3c2",94267:"c1a4ee55",94281:"6bd2467c",94326:"b1055cd5",94417:"7702d0cd",94680:"6de01bcb",94713:"17836e3f",94751:"ca562659",95164:"4996ae12",95336:"d916f41c",95416:"a8130e93",95531:"3c7a052c",95638:"532a2521",95647:"8487a4b8",95753:"a33132f8",95915:"403ad825",96048:"abf806bb",96444:"cfb31c5a",96579:"a52df0f2",96689:"8c466e68",96701:"284ed88e",96900:"f643bd38",96924:"aa14ee42",97138:"ac505a0e",97146:"b427c302",97160:"17de8bd1",97244:"5d3385b7",97256:"e467eae0",97533:"357d834f",97666:"efac4242",97697:"e569b9b5",97950:"f226ceff",97969:"8a6fd5ef",98050:"7496c3c8",98113:"d328fa95",98400:"11c773e0",98434:"df6db274",98595:"cda3b347",98903:"b678a0a4",99095:"411f52c4",99157:"12c1638d",99171:"453a9b9d",99423:"b1a07e62",99544:"a37c36da"}[e]+".chunk.js",r.miniCssF=e=>{},r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="fluidhost:";r.l=(o,n,i,s)=>{if(e[o])e[o].push(n);else{var a,c;if(void 0!==i)for(var d=document.getElementsByTagName("script"),l=0;l<d.length;l++){var u=d[l];if(u.getAttribute("src")==o||u.getAttribute("data-webpack")==t+i){a=u;break}}a||(c=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,r.nc&&a.setAttribute("nonce",r.nc),a.setAttribute("data-webpack",t+i),a.src=o),e[o]=[n];var h=(t,r)=>{a.onerror=a.onload=null,clearTimeout(g);var n=e[o];if(delete e[o],a.parentNode&&a.parentNode.removeChild(a),n&&n.forEach(e=>e(r)),t)return t(r)},g=setTimeout(h.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=h.bind(null,a.onerror),a.onload=h.bind(null,a.onload),c&&document.head.appendChild(a)}}})(),r.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),r.p="./",(()=>{var e={38792:0};r.f.j=(t,o)=>{var n=r.o(e,t)?e[t]:void 0;if(0!==n)if(n)o.push(n[2]);else{var i=new Promise((r,o)=>n=e[t]=[r,o]);o.push(n[2]=i);var s=r.p+r.u(t),a=new Error;r.l(s,o=>{if(r.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var i=o&&("load"===o.type?"missing":o.type),s=o&&o.target&&o.target.src;a.message="Loading chunk "+t+" failed.\n("+i+": "+s+")",a.name="ChunkLoadError",a.type=i,a.request=s,n[1](a)}},"chunk-"+t,t)}},r.F.j=t=>{if(!r.o(e,t)||void 0===e[t]){e[t]=null;var o=document.createElement("link");o.charset="utf-8",r.nc&&o.setAttribute("nonce",r.nc),o.rel="prefetch",o.as="script",o.href=r.p+r.u(t),document.head.appendChild(o)}};var t=(t,o)=>{var n,i,s=o[0],a=o[1],c=o[2],d=0;if(s.some(t=>0!==e[t])){for(n in a)r.o(a,n)&&(r.m[n]=a[n]);if(c)c(r)}for(t&&t(o);d<s.length;d++)i=s[d],r.o(e,i)&&e[i]&&e[i][0](),e[i]=0},o=self.webpackChunkfluidhost=self.webpackChunkfluidhost||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})(),(()=>{var e={73580:[46441,72567,94680,9444]};r.f.prefetch=(t,o)=>Promise.all(o).then(()=>{var o=e[t];Array.isArray(o)&&o.map(r.E)})})(),(()=>{"use strict";var e=r(99671),t=r(83125),o=r(33788),n=r(85874);var i=r(26631),s=r(34445);async function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"SHA-1",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"hex";if(void 0===crypto.subtle)return r.e(13482).then(r.bind(r,37711)).then(async r=>r.hashFile(e,t,o));const n=await async function(e,t){const r=await crypto.subtle.digest(t,e);return new Uint8Array(r)}(e,t);return function(e,t){switch(t){case"hex":return Array.prototype.map.call(e,e=>e.toString(16).padStart(2,"0")).join("");case"base64":return s.fromByteArray(e)}}(n,o)}async function c(e,r,n,s,c){(async function(e,t){const r=i.Ss.from(`${e}_${t}`);return encodeURIComponent(await a(r,"SHA-256","base64"))})(n,s).then(i=>{!function(e,r,n){(async(e,r)=>{const i=n?new t.p("InformationProtectionService",n):void 0,s=o.m.start("precacheInformationProtection",i,{addUserTiming:!0,isAPerformanceMetric:!0});try{const t=await e;await Promise.all([t.getIrmInformation(r),t.getWatermarkInformation(r)])}catch{s.setResult(!1)}s.setResult(!0)})(e,r)}(e,{siteUrl:r,driveId:n,itemId:s,odspResolvedUrl:!0,hashedDocumentId:i,type:"fluid",id:"",url:"",tokens:{},endpoints:{snapshotStorageUrl:"",attachmentPOSTStorageUrl:"",attachmentGETStorageUrl:"",deltaStorageUrl:""},fileName:"",summarizer:!1,fileVersion:""},c)}).catch(()=>{})}var d=r(98581),l=r(31942),u=r(95996),h=r(52841),g=r(93537),p=r(3503),m=r(37805);const f={maxRetries:3,filter:(0,g.sC)([429,500,503]),backoffFn:(0,m.Ed)(500)},v=/.+\S\([^\(\)]+\)$/;function y(e){const t=p.f.get(e);if(null!==t&&void 0!==t)return C(t)}function b(e){const t=(0,h.Ar)()?.getItem(e);if(null!==t&&void 0!==t)return C(t)}function S(e){return 2===(e.cacheVersion||0)&&void 0!==e.expires&&e.expires.valueOf()>Date.now()}function C(e){if(null!==e&&void 0!==e){let r;try{r=JSON.parse(e)}catch(t){}const o=void 0!==r?r:e;return"on"===o||"off"===o?"on"===o:o}}class k{static#e=(()=>this.previouslyLoggedSettingMetadata=new Set)();static#t=(()=>this.settingMetadataToBeLogged=[])();static#r=(()=>this.settingsMetadataLoggingInterval=1e4)();constructor(e,r){this.ecsClientConfiguration=e,this.previouslyAccessedEcsSettings=new Map,this._settingsFetchedFromEcs=!1,this._loadedEcsReponseEventSent=!1,this.logger=r&&new t.p("EcsClient",r),this.loadAndClearCache(),this.ecsClientConfiguration.enableLogSettingsWithSource&&setInterval(()=>{this.logSettingsMetadata()},k.settingsMetadataLoggingInterval)}get settingsFetchedFromEcs(){return this._settingsFetchedFromEcs}async fetch(){if(this.ecsClientConfiguration.alwaysFetchNewSettings||void 0===this.ecsResponseFromCache||!S(this.ecsResponseFromCache)||this.ecsResponseFromCache.sessionId!==this.ecsClientConfiguration.sessionId){const e=function(e){const t=new URLSearchParams;if(t.append("agents",e.teamNames.join(",")),e.guestAgents){const r={};for(let t=0;t<e.guestAgents.length;t+=1){const o=e.guestAgents[t].substring(e.guestAgents[t].indexOf("(")+1,e.guestAgents[t].indexOf(")")),n=e.guestAgents[t].substring(0,e.guestAgents[t].indexOf("("));r[o]=r[o]?`${r[o]},${n}`:n}Object.entries(r).forEach(e=>{let[r,o]=e;t.append("guestAgents",`${o}(${r})`)})}Object.entries(e.filters).forEach(e=>{let[r,o]=e;void 0!==o&&t.append(r,o)});const r=t.toString();return`${e.host}/config/v1/${e.clientName}/${e.clientVersion}${""!==r?`?${r}`:""}`}(this.ecsClientConfiguration);return this.ecsResponsePromise||(this.ecsResponsePromise=this.fetchAndParse(e),this.ecsResponsePromise.then(e=>{e&&this.cacheEcsResponse(e),this._settingsFetchedFromEcs=!0}).catch(()=>{})),this.ecsResponsePromise}}getSettingKey(e,t){return`${e}_${t}`}getSetting(e,t,r){return this.maybeLogLoadedEcsResponseFromCache(),this.getSettingInternal(e,t,r)}maybeLogLoadedEcsResponseFromCache(){!this._loadedEcsReponseEventSent&&this.ecsResponseFromCache&&(this.logger&&(0,u.Ot)(this.logger,{eventName:"loadedEcsResponseFromCache",settings:JSON.stringify(this.ecsResponseFromCache.ecsTeamsSettings),eTag:this.ecsResponseFromCache.eTag,configIds:JSON.stringify(this.ecsResponseFromCache.configIDs)}),this._loadedEcsReponseEventSent=!0)}logSettingsMetadata(){0!==k.settingMetadataToBeLogged.length&&(this.logger&&(0,u.Ot)(this.logger,{eventName:"ECSSettingMetadatas",settings:JSON.stringify(k.settingMetadataToBeLogged)}),k.settingMetadataToBeLogged=[])}async getLiveSetting(e,t,r){return this.maybeLogLoadedEcsResponseFromCache(),this.getLiveSettingInternal(e,t,r)}getSettingInternal(e,t,r){let o;const n=this.getSettingKey(e,r);if(void 0!==(o=this.previouslyAccessedEcsSettings.get(n)))return o;let i="";return void 0!==(o=y(e))?i="QueryParam":void 0!==(o=b(e))?i="LocalStorage":void 0!==(o=this.getSettingFromCachedEcsResponse(e,r))?i="CachedEcsResponse":(i="DefaultValue",o=t),this.previouslyAccessedEcsSettings.set(n,o),this.ecsClientConfiguration.enableLogSettingsWithSource&&!k.previouslyLoggedSettingMetadata.has(e)&&(k.previouslyLoggedSettingMetadata.add(e),k.settingMetadataToBeLogged.push({settingName:e,settingValue:o?.toString()??"",settingSource:i})),o}async getLiveSettingInternal(e,t,r){let o;const n=this.getSettingKey(e,r);if(void 0!==(o=this.previouslyAccessedEcsSettings.get(n)))return o;if(void 0!==(o=y(e))||(o=b(e)),void 0!==o)return this.previouslyAccessedEcsSettings.set(n,o),o;const i=this._settingsFetchedFromEcs?this.getAllCachedEcsResponses()?.[this.ecsClientConfiguration.cacheKey]:await this.fetch();return void 0!==(o=i?.ecsTeamsSettings[r]?.[e])||(o=t),this.previouslyAccessedEcsSettings.set(n,o),o}getSettingFromCachedEcsResponse(e,t){return this.ecsResponseFromCache?.ecsTeamsSettings[t]?.[e]}async fetchAndParse(e){const t=o.m.start("EcsFetch",this.logger,{addUserTiming:!0});let r;try{r=await(0,g.J5)(e,void 0,f)}catch(i){return void t.setResult(!1,void 0,i)}if(200!==r.result.status){const e=new Error("Failed to Fetch from ECS. Response is not 200");return void t.setResult(!1,{status:r.result.status,statusText:r.result.statusText},e)}const n=this.parseResponseToEcsResponse(r);return n.then(r=>{let o;performance.getEntriesByName(e).map(e=>{e.name.includes(this.ecsClientConfiguration.host)&&(o=e.duration)}),t.setResult(!0,{eTag:r.eTag,networkDurationMs:o,configIds:JSON.stringify(r.configIDs)})}).catch(e=>{t.setResult(!1,void 0,e)}),n}async parseResponseToEcsResponse(e){const t=await e.result.json(),r=[...this.ecsClientConfiguration.teamNames],o={};this.ecsClientConfiguration.guestAgents?.forEach(e=>{if(v.test(e)){const t=e.substring(0,e.indexOf("("));r.push(t)}else this.logger&&(0,u.hO)(this.logger,{eventName:"ecsTeamFormat"},new Error(`${e} doesn't match the format <EcsTeam>(<EcsClient>)`))});for(let a=0;a<r.length;a+=1)t[r[a]]&&(o[r[a]]=t[r[a]]);const n=e.result.headers.get("ETag")||"",i=t.ConfigIDs||{};let s;if(this.ecsClientConfiguration.cacheExpiresDurationOverrideInMin)s=new Date(Date.now()+6e4*this.ecsClientConfiguration.cacheExpiresDurationOverrideInMin);else{const t=e.result.headers.get("Expires");s=t?new Date(t):void 0}return{ecsTeamsSettings:o,eTag:n,configIDs:i,expires:s,cacheVersion:2,sessionId:this.ecsClientConfiguration.sessionId}}cacheEcsResponse(e){const t=(0,h.Ar)();if(t)try{const r=this.getAllCachedEcsResponses()||{};r[this.ecsClientConfiguration.cacheKey]=e,t.setItem(this.ecsClientConfiguration.responsesCacheKey,JSON.stringify(r))}catch(r){this.logger&&(0,u.hO)(this.logger,{eventName:"cacheEcsResponse"},r)}}getAllCachedEcsResponses(){try{const e=(0,h.Ar)(),t=e?.getItem(this.ecsClientConfiguration.responsesCacheKey),r=t&&JSON.parse(t);if(!r||0===Object.keys(r).length)return;return Object.entries(r).forEach(e=>{let[t,r]=e;"string"===typeof r.expires&&(r.expires=new Date(r.expires))}),r}catch(e){this.logger&&(0,u.hO)(this.logger,{eventName:"getAllCachedEcsResponses"},e)}}loadAndClearCache(){const e=this.getAllCachedEcsResponses();if(e){const t=e[this.ecsClientConfiguration.cacheKey];t&&(this.ecsResponseFromCache=t),this.clearExpiredEcsResponsesFromCache(e)}}clearExpiredEcsResponsesFromCache(e){try{const t=(0,h.Ar)();if(!t)return;const r={};Object.entries(e).forEach(e=>{let[t,o]=e;(S(o)||t===this.ecsClientConfiguration.cacheKey)&&(r[t]=o)}),t.setItem(this.ecsClientConfiguration.responsesCacheKey,JSON.stringify(r))}catch(t){this.logger&&(0,u.hO)(this.logger,{eventName:"clearExpiredEcsResponsesFromCache"},t)}}}var w=r(77432);function P(e){return(0,w.F)("ecs",e)}function T(e){return"teamNames"in e}class E{get SettingsProvider(){return this}get settingsFetchedFromEcs(){return this.ecsClient.settingsFetchedFromEcs}constructor(e,t){this.ecsClient=T(e)?new k(e,t):new k(function(e){const{ecsFilters:t,hostName:r,sessionId:o,responsesCacheKeyOverride:n,cacheExpiresDurationOverrideInMin:i,fetchFluidExperiencesSettings:s=!0,fetchHostExperiencesSettings:a=!0,fetchSegmentationSettings:c=!0,alwaysFetchNewSettings:d,enableLogSettingsWithSource:l=!1}=e,{userContext:u}=t,h=function(e){return"Development"===e?"Staging":e}(t.audience),g=u.user?.id,p=u.user?.tenantId,m={audience:h,userId:g,tenantId:p,hostName:r},f=`${g}${r}${h}`,v=n||"FluidEcsClientResponses",y=[];return s&&y.push("FluidExperiences"),a&&y.push("HostExperiences"),c&&y.push("Segmentation"),{host:P(h),clientName:"Fluid",clientVersion:"0.0.0.1",teamNames:y,filters:m,cacheKey:f,responsesCacheKey:v,cacheExpiresDurationOverrideInMin:i,sessionId:o,alwaysFetchNewSettings:d,enableLogSettingsWithSource:l}}(e),t),this.audience=T(e)?e.filters.audience:e.ecsFilters.audience,this.fetchSettings().catch(()=>{})}get Disposable(){return this}dispose(){}async fetchSettings(){await this.ecsClient.fetch()}getSetting(e,t,r){return this.ecsClient.getSetting(e,t,r)}async getLiveSetting(e,t,r){return this.ecsClient.getLiveSetting(e,t,r)}}var N=r(68180),I=r(23989),D=r(29967),F=r(58443),B=r(51655),L=r(56142);var x=r(78945),A=r(14818);class O{get IFluidDependencySynthesizer(){return this}constructor(){this.providers=new Map;for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.parents=t.filter(e=>void 0!==e)}register(e,t){if(this.providers.has(e))throw new Error(`Attempting to register a provider of type ${String(e)} that already exists`);this.providers.set(e,t)}unregister(e){this.providers.has(e)&&this.providers.delete(e)}synthesize(e,t){const r={};return this.generateRequired(r,t),this.generateOptional(r,e),Object.defineProperty(r,A.x,{get:()=>this}),r}has(e,t){return!!this.providers.has(e)||!0!==t&&this.parents.some(t=>t.has(e))}getProvider(e){if(this.has(e)){if(this.providers.has(e))return this.providers.get(e);for(const t of this.parents){if(t instanceof O)return t.getProvider(e);{const r=t;if(void 0!==r?.getProvider)return r.getProvider(e)}}}}generateRequired(e,t){if(void 0!==t)for(const r of Object.keys(t)){const t=this.resolveProvider(r);if(void 0===t)throw new Error(`Object attempted to be created without registered required provider ${String(r)}`);Object.defineProperty(e,r,t)}}generateOptional(e,t){if(void 0!==t)for(const r of Object.keys(t)){const t=this.resolveProvider(r)??{get:async()=>{}};Object.defineProperty(e,r,t)}}resolveProvider(e){const t=this.providers.get(e);if(void 0!==t)return"function"===typeof t?{get(){if(t&&"function"===typeof t)return Promise.resolve(this[A.x]).then(async e=>t(e)).then(t=>t?.[e])}}:{get(){if(t)return new x.I(async()=>Promise.resolve(t).then(t=>{if(t)return t[e]}))}};for(const r of this.parents){const t={[e]:e},o=r.synthesize(t,{}),n=Object.getOwnPropertyDescriptor(o,e);if(void 0!==n)return n}}}var M=r(59091),_=r(60119);var R=r(69235),H=r(51492),U=r(21880),j=r(90293),q=r(91947);class z{constructor(e){this.isOptionalConnectedExperiencesEnabled=e}async optionalConnectedExperiencesEnabled(){return this.isOptionalConnectedExperiencesEnabled}async getEnterpriseFeedbackPolicy(){}get OfficePolicyProvider(){return this}async getPolicy(e){if(!await(0,H.PA)(H.u.OEP,"LoopSettings.OcpsPolicyEnabled"))return{value:"0"};const t=await(0,q.CE)(e.policyId);return void 0===t?void 0:{value:t?"1":"0"}}}class V{constructor(e,t,r){this.defaultProvider=void 0,this.settingOverrides=void 0,this.audience=void 0,this.SettingsProvider=void 0,this.defaultProvider=t,this.SettingsProvider=this,this.audience=e,this.settingOverrides=r,void 0===this.settingOverrides&&async function(){const e=await(0,H.eH)(H.u.OEP,"FluidHost.FluidSettingOverrides","");if(e)try{return JSON.parse(e)}catch(t){(0,R.c2)("HostSettingsProvider",new R.uV("Unable to parse value of FluidHost.FluidSettingsOverride."))}return{}}().then(e=>{this.settingOverrides=e})}getSetting(e,t,r){var o,n;if(this.settingOverrides){const r=this.settingOverrides[e];if(void 0!==r){const o=typeof r,n=typeof t;if(o===n)return(0,L.Rm)(`Override setting: ${e} = ${r}`),r;console.warn(`Cannot override setting ${e}. The override type (${o}) is different than the setting type (${n}).`)}}return null!==(o=null===(n=this.defaultProvider)||void 0===n?void 0:n.getSetting(e,t,r))&&void 0!==o?o:t}}var $=r(34805),G=r(64643),W=r(81918),J=r(16460),K=r(6971),Q=r(60138),Y=r(899);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Z=r(4311),X=r(24921),ee=r(27377),te=r(64580),re=r(97232),oe=r(94115),ne=r(25573),ie=r(40118),se=r(27901);let ae;var ce=r(62231),de=r(98123);"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(e=>{e.unregister()}).catch(e=>{(0,L.vV)(e.message)}),(0,J.Vg)(),(0,K.E)(),async function(i){var s,a,u,h,g,p,m,f,v;F.yz&&await(0,H.x$)(H.u.OEP,"FluidHost.Debugger.BreakAtMain");const y=B.q.getTimePoint();let{layoutMode:b}=i;const{uiLanguage:S}=i,C=await(0,K.E)(),k=(null===C||void 0===C?void 0:C.loopInfo)||{},w=i.componentTypeToCreate||"",P=w==F.l1,T="@fluidx/video-playback"===k.registrationId;if((0,L.sF)(null===C||void 0===C?void 0:C.consoleLogEnabled),!k.linkUrl&&k.loopData){var x;const e=JSON.parse(k.loopData);k.linkUrl="string"===typeof e.webUrl?e.webUrl:null===(x=e.webUrl)||void 0===x?void 0:x.href}var A;k.linkText||(k.linkText=i.loopLinkText||(null===C||void 0===C||null===(A=C.createParams)||void 0===A?void 0:A.loopFileName)||"");k.linkUrl||(k.linkUrl=i.loopLinkUrl||"");k.registrationId||(k.registrationId=P?$.IG:i.loopRegistrationId||"");const le=!k.registrationId||"@fluidx/office-fluid-container"===k.registrationId,ue=k.registrationId===$.B2,he=null===C||void 0===C?void 0:C.fluidSettingOverrides,ge=null===C||void 0===C?void 0:C.hydrateId,pe=null!==(s=null===C||void 0===C?void 0:C.isDarkBackground)&&void 0!==s&&s,me=null!==(a=null===C||void 0===C?void 0:C.isInEditableDocument)&&void 0!==a&&a,fe=null!==C&&void 0!==C&&C.linkProblemState||null!==C&&void 0!==C&&C.isPermissionError?J.$R.Error:J.$R.None,ve=null!==(u=null===C||void 0===C?void 0:C.useTokenCache)&&void 0!==u&&u;ie.n.GetInstance().isCacheEnabled=ve;const ye=await async function(){if(!F.KV&&(F.Nu||await(0,H.PA)(H.u.OEP,"ChangeGate.LocalAudience")))return"Local";const e="Production",t=await(0,H.eH)(H.u.OEP,"FluidHost.Audience",e);switch(t){case"Automation":case"Dogfood":case"Local":case"Microsoft":case"Preview":case"Production":case"Staging":case"SyntheticTraffic":return t;default:return(0,R.c2)("determineAudience()",new R.uV(`Unexpected value for OEP.FluidHost.Audience ("${t}").`)),e}}(),be=function(e){e.name&&"MailComponent"!==e.name||(e.name="Component");e.entryPoint||(e.entryPoint="Mail");e.lifecycle||(e.lifecycle="Load");return e}({entryPoint:null!==(h=null===C||void 0===C?void 0:C.hydrateScenarioEntryPoint)&&void 0!==h?h:i.scenarioEntryPoint,name:i.scenarioName,lifecycle:i.scenarioLifecycle,startTime:null!==(g=null===C||void 0===C?void 0:C.scenarioStartTime)&&void 0!==g?g:(0,ne.W)()}),Se="Create"==be.lifecycle,Ce=(0,H.x$)(H.u.OEP,"FluidHost.MIP"),ke=(0,H.x$)(H.u.OEP,"FluidHost.AppWaitForDriver"),we=`${be.lifecycle}_${be.name}_${be.entryPoint}`,Pe=null!==(p=(null===C||void 0===C?void 0:C.showTeachingCallout)&&le)&&void 0!==p&&p,Te=await(0,G.q)(),Ee={buttonText:Te.GotIt,descriptionText:Te.CalloutDescription,headerText:Te.CalloutTitle,officeTheme:null===C||void 0===C?void 0:C.officeTheme,calloutColors:null===C||void 0===C?void 0:C.teachingCalloutColors},Ne=null!==(m=null===C||void 0===C?void 0:C.useNewAnimatedSplashScreen)&&void 0!==m&&m,Ie=null!==(f=null===C||void 0===C?void 0:C.enableShowLoopGlowBorderEvent)&&void 0!==f&&f,De=null!==(v=null===C||void 0===C?void 0:C.enableRightToLeftSplashScreen)&&void 0!==v&&v;(0,H.lb)(),(0,H.MO)(),T&&k.linkUrl&&(k.linkUrl=(0,de.addReferralParamsToStreamUrl)(k.linkUrl,C.hydrateScenarioEntryPoint));if((0,L.Rm)(`Audience: ${ye}`),(0,L.Rm)(`Scenario: ${we}`),(0,L.Rm)(`LayoutMode: ${b}`),(0,L.Rm)(`UI Language: ${S}`),(0,L.Rm)(`Native info: ${JSON.stringify(C,void 0,"  ")}`),(0,L.Rm)(`Loop info: ${JSON.stringify(k,void 0,"  ")}`),(0,L.Rm)(`Is Fluid Loop: ${le}`),!le||k.linkUrl||Se){var Fe,Be,Le,xe;const i=new oe.i(ge||"",we,ye,y),s=!Se||await(0,H.xB)()&&!le?Promise.resolve(""):null!==C&&void 0!==C&&null!==(Fe=C.createParams)&&void 0!==Fe&&Fe.loopFolderName?Promise.resolve(C.createParams.loopFolderName):(0,Z.ZQ)("attachments"),a=Promise.resolve(Se?k.linkText:"");let u;Se||((0,j.OX)(k.linkUrl),"Paste"===be.lifecycle&&(k.linkUrl=(0,N.c)(k.linkUrl)),le&&(u=(0,e.Mh)(new URL(k.linkUrl)),u||(0,L.vV)("Unable to get the SharePoint locator from the Fluid url.")));const{localization:h,internationalizationContext:g}=await(0,j.Z)(S),p=document.getElementById(F.xu),m=document.getElementById(F.bY);p&&(p.hidden=!0),null===m||void 0===m||m.removeAttribute("hidden");const f=null===m||void 0===m?void 0:m.clientWidth,v=f?Math.min(f,F.s):F.s,{background:P,shimmer:x}=(0,ee.O)(pe,Ne),A=document.createElement("div");A.className="combined";const G=document.createElement("object");G.data=P,G.width=(null===f||void 0===f?void 0:f.toString())||"",G.height=Ne?F.pY.toString():F.FT.toString();const J=document.createElement("object");J.data=x,J.width=v.toString(),J.height=Ne?F.pY.toString():F.FT.toString(),De&&"rtl"==h.localeDirection&&(J.style.transform="scale(-1, 1)"),J.onload=()=>{setTimeout(()=>{(0,q.kF)()},200)},J.onerror=()=>{m&&(m.hidden=!0),null===p||void 0===p||p.removeAttribute("hidden"),(0,R.c2)("main()",new R.uV("Failed to load animated Svg.")),(0,q.kF)()},A.append(G,J),null===m||void 0===m||m.append(A);const K=(0,Y.u0)().replace(/[{}]/g,"").toLowerCase(),X=null!==ge&&void 0!==ge?ge:(0,se._)(),te=(0,j.b6)(K,X,S,be),re={get TelemetryConfig(){return this},hostCorrelationId:X,hostSessionId:K},ne=new Q.z,ie=(0,j.Ng)(te,C,ye),de=I._.startScenario(ie,be.lifecycle),ve=new E({ecsFilters:{audience:ye,userContext:{}},hostName:te.hostName},ie),Oe=await H.y,Me=new V(ye,ve,he),_e=await(0,H.PA)(H.u.OEP,"ChangeGate.FluidHost.UseAppTheming"),{stylingProvider:Re,initialTheme:He,initialThemeV9:Ue,theming:je}=(0,j.br)(te.hostAppName,pe,Oe,_e),qe=le&&await Ce,ze=qe?function(e){if("Consumer"===e.tokenProvider.identityType)return;let i;if((0,n.gX)(e.settingsProvider)&&(i=r.e(65354).then(r.bind(r,83126)).then(r=>{const o=new r.SharepointInformationProtectionService({...e,logger:e.logger?new t.p("InformationProtectionService",e.logger):void 0});return o.initialize("PO"),o})),e.logger){const r=new t.p("InformationProtectionService",e.logger);o.m.start("getInformationProtectionServiceForSharepoint",r).setResult(void 0!==i,{isGetLabelEnabled:(0,n.gX)(e.settingsProvider),isSetLabelEnabled:(0,n.E7)(e.settingsProvider),settingsProviderExists:void 0!==e.settingsProvider})}return i}({tokenProvider:ne,settingsProvider:Me,logger:ie,locale:h.locale}):void 0;if(qe&&void 0===ze&&(0,R.c2)("main()",new R.uV("getInformationProtectionServiceForSharepoint() failed.")),qe&&ze&&u)try{c(ze,u.siteUrl,u.driveId,u.itemId,ie)}catch(Ae){(0,R.c2)("preCacheInformationProtectionWithSharePointIds()",new R.uV("Exception occurred.",Ae))}const Ve=new d.R(_e?je:Re);let $e,Ge,We;const Je=void 0!==(null===C||void 0===C?void 0:C.isOptionalConnectedExperiencesEnabled),Ke=void 0!==(null===C||void 0===C?void 0:C.isOptionalConnectedExperiencesEnabled)?new z(Je):void 0;if(ue){const e=await(0,W.Cw)();We=e.getUrlHandlerProvider(),Ge=e.getMetaOSProvider(),$e=null!==C&&void 0!==C&&C.isCardChannelProviderEnabled?e.getCardChanelProvider():void 0}const Qe={environment:(0,j.NK)(ye),logger:ie},Ye=(null===C||void 0===C?void 0:C.partitionCacheKey)||null,Ze=C&&""!==C.partitionCacheKey;let Xe,et;le&&(Xe=(0,M.FM)(i,Qe,ie,Me,ne,Ze,Ye),et=(0,D.o)(ne,ie));const tt=(0,ce.H)(),rt=k.registrationId?await(0,$.Zj)(k.registrationId):void 0,ot=await async function(e){let{cardChannelProvider:t,documentServiceFactory:r,informationProtectionServicePromise:o,internationalizationContext:n,metaOSProvider:i,officeFluidLogger:s,optionalConnectedProvider:a,presenceColorProvider:c,settingsProvider:d,stylingProvider:l,telemetryConfig:u,tokenProvider:h,urlHandlerProvider:g,urlResolver:p,playbackStateHandlerPromise:m,loopCodeLoaderFactory:f,theming:v,isThemingEnabled:y}=e;const b=new O;return t&&b.register("CardChannelProvider",t),b.register("InternationalizationContext",n),o&&b.register("InformationProtectionService",o),b.register("LoopTelemetrySink",_.a),i&&b.register("MetaOSProvider",i),b.register("NamespaceLogger",s),a&&b.register("OfficePolicyProvider",a),b.register("PresenceColorProvider",c),b.register("SettingsProvider",d),y&&v&&b.register("Theming",v),b.register("StylingProvider",l),b.register("TelemetryConfig",u),b.register("TokenProvider",h),g&&b.register("UrlHandlerProvider",g),r&&p&&b.register("DriverImplementation",new M.kx(p,r)),m&&b.register("PlaybackStateHandler",m),f&&b.register("LoopCodeLoaderFactoryProvider",f),b}({cardChannelProvider:$e,documentServiceFactory:Xe,informationProtectionServicePromise:ze,metaOSProvider:Ge,officeFluidLogger:ie,optionalConnectedProvider:Ke,playbackStateHandlerPromise:tt,presenceColorProvider:Ve,settingsProvider:Me,stylingProvider:Re,tokenProvider:ne,urlHandlerProvider:We,urlResolver:et,internationalizationContext:g,telemetryConfig:re,loopCodeLoaderFactory:rt,theming:je,isThemingEnabled:_e}),nt={url:k.linkUrl,headers:{isSharingLinkToRedeem:!0}};qe&&(nt.headers={...nt.headers,"X-CLP-Compliant-App":!0});const it=await a,st="Mac"!==te.hostAppPlatform;i.setLoadPerfTracker();const at=(0,U.h)(Se,w,s,it,k,Qe,te,ge,nt,ot,ie,i,Xe,et);at.then(()=>{var e;i.onLoadComplete(ne);const t=null===(e=i.LoadPerfTracker)||void 0===e?void 0:e.getDurationInSeconds();(0,L.Rm)(`Fluid component loaded. (${null!==t&&void 0!==t?t:"??"} s)`),k.loopData&&(0,L.Rm)(`  Data: ${k.loopData}`),k.loopIconUrl&&(0,L.Rm)(`  Icon: ${k.loopIconUrl}`),k.loopName&&(0,L.Rm)(`  Name: ${k.loopName}`),k.loopTitle&&(0,L.Rm)(`  Title: ${k.loopTitle}`),k.linkText&&(0,L.Rm)(`  Link Text: ${k.linkText}`),k.linkUrl&&(0,L.Rm)(`  Link Url: ${k.linkUrl}`)}),Se&&at.catch(async()=>{await(0,H.PA)(H.u.OEP,"ChangeGate.FluidHost.CreateFailed")&&(0,q.xh)(w)}),async function(e){"Mac"!=e.hostAppPlatform&&(0,H.PA)(H.u.OEP,"ChangeGate.FluidOutlook.FixBorderWithMargin").then(e=>{if(e)document.documentElement.style.marginRight="1px";else{const e=document.getElementById(F.xu);e&&(e.style.paddingRight="1px")}})}(te),(0,j.Sk)(b,C.useLoopContentWidthEnabled),T&&(b=l.S.grow);const ct=function(e,t){return ae?e.isInEditableDocument&&(ae.delegateToHostAppForNotification=!0,ae.useCustomSharedService=!0):(ae={delegateToHostAppForNotification:!1,disableSingleClickOpenHeaderLink:!1,shouldDisableEscapeKey:!1,useCustomSharedService:!1},("MailCompose"===e.hydrateScenarioEntryPoint||void 0===e.hydrateScenarioEntryPoint&&e.isInEditableDocument)&&(ae.delegateToHostAppForNotification=!0,ae.useCustomSharedService=!0,t&&(ae.shouldDisableEscapeKey=!0)),"WordDocument"===e.hydrateScenarioEntryPoint&&(ae.disableSingleClickOpenHeaderLink=!0)),ae}(C,!(null===C||void 0===C||!C.version)&&(null===C||void 0===C?void 0:C.version)>=28),dt={followLinkToolTip:me||ct.disableSingleClickOpenHeaderLink?Te.ControlClickToFollowLink:Te.ClickToFollowLink,isDarkBackground:pe,shouldDisableEscapeKey:ct.shouldDisableEscapeKey,linkProblemState:fe,linkText:k.linkText,linkUrl:null!==(Be=k.safeLinkWrappedUrl)&&void 0!==Be?Be:k.linkUrl,onClick:e=>{(0,j.ig)(e,me,ct.disableSingleClickOpenHeaderLink)},textForEmptyUrl:Te.GettingThisReady,updateTheme:void 0};if(i.setInitialRenderPerfTracker(),Xe){if(await ke)try{await Xe}catch{}}(async function(e){const t=e.showComponentActivity;(0,L.Rm)("appLazyStart() started."),t.AppLazyImportTracker=new B.q,t.AppLazyStartTracker=new B.q;const o=await t.AppLazyImportTracker.measure(()=>Promise.all([r.e(97950),r.e(63843),r.e(17122),r.e(26922),r.e(95753),r.e(28097),r.e(48453),r.e(47880),r.e(8513),r.e(81540),r.e(65354),r.e(8088),r.e(10510),r.e(94258)]).then(r.bind(r,78003)));t.AppLazyStartTracker.measure(()=>o.lazyStart(e));const n=t.AppLazyImportTracker.getDurationInSeconds(),i=t.AppLazyStartTracker.getDurationInSeconds();(0,L.Rm)(`appLazyStart() completed.  (Import: ${n} s,  Lazy start: ${i} s)`)})({canSetFocusToLink:st,containerRequest:nt,dependencySynthesizer:ot,documentServiceFactory:Xe,enableShowLoopGlowBorderEvent:Ie,giveComponentFocus:Se,headerProps:dt,hostConfig:Qe,hostContext:te,informationProtectionServicePromise:ze,initialTheme:He,initialThemeV9:Ue,isAppThemeBrandingEnabled:Oe,isInEditableDocument:me,isMIPEnabled:qe,layoutMode:b,loadCompletePromise:at,localization:h,loopInfo:k,officeFluidLogger:ie,presenceColorProvider:Ve,scenarioTracker:de,settingsProvider:Me,showComponentActivity:i,stylingProvider:Re,teachingProps:Ee,tokenProvider:ne,urlResolver:et,wantToShowTeachingCallout:Pe,webAppConfigOverride:ct,theming:je,isThemingEnabled:_e}).catch(e=>{(0,R.c2)("appLazyStart()",(0,R.oD)(e))}),null===(Le=i.WebAppMainPerfTracker)||void 0===Le||Le.setSuccess();const lt=null===(xe=i.WebAppMainPerfTracker)||void 0===xe?void 0:xe.getDurationInSeconds();(0,L.Rm)(`WebApp main complete. (${null!==lt&&void 0!==lt?lt:"??"} s)`)}else{const e=1e3,t=await(0,H.n_)(H.u.OEP,"FluidHost.DelayTimeWhenNoFluidUrl",e);await(0,X.y)(t),await(0,te.$)(re.d.Success_NoFluidUrl)}}(function(e){const t=function(e){const t=e.search?e.search:e.hash;return new URLSearchParams("#"==t[0]?t.substring(1):t)}(e),r=t.get("create"),o=null!==r,n=null!==t.get("paste");return{componentTypeToCreate:r,layoutMode:(0,j.ZG)(t.get("layout")),loopRegistrationId:t.get("loopId"),loopLinkText:t.get("linkText")||t.get("fileName"),loopLinkUrl:function(e){switch(e){case"1":return"";case"2":return"https://microsoft-my.sharepoint-df.com/:fl:/p/manos/ETK44FqyWS1HmflsrI7osCcBaCWLXvZ-GinnJBsnNU9ZXg?nav=cz0lMkZwZXJzb25hbCUyRm1hbm9zX21pY3Jvc29mdF9jb20mZD1iIVVET05QQU1XQlVLOUU2U3NyT2dwTEdtQjVpYmliR3BNa2d4RG1rYXlnTFYtaUVoOHAwNDhTNTR4YUUxUVh6R3EmZj0wMUJNWFJUSUpTWERRRlZNU1pGVkRaVDZMTVZTSE9STUJIJmM9JTJGNTU2YzVkNjEtNmY4Ny00MTBiLTlkMzctYTM2OTE5N2Y1OGZkJTNGc3RhcnQlM0R1bmRlZmluZWQlMjZlbmQlM0QyZDhjNmIwNS1jYTg3LTQ3OGMtOGJjZC1lMGNiNzZkOTk2MjgmZmx1aWQ9MSZwPSU0MG1zJTJGb2ZmaWNlLWZsdWlkLWNvbnRhaW5lcg%3D%3D"}return null}(t.get("fluidUrlOverride"))||t.get("linkUrl")||t.get("fluidUrl"),scenarioEntryPoint:t.get("sep")||"",scenarioLifecycle:n?"Paste":o?"Create":"Load",scenarioName:t.get("s")||"",uiLanguage:t.get("locale")||(0,Y.Mg)()||"en-us"}}(window.location)).catch(e=>{(0,R.c2)("main()",(0,R.oD)(e))})})()})();
//# sourceMappingURL=main.63d302ce.js.map