(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[80708],{10871:(e,t,r)=>{var i=r(71775),s=r(19449)(function(e,t,r){i(e,r,t)});e.exports=s},11569:(e,t,r)=>{"use strict";r.d(t,{L:()=>i});class i{toGraphSerializable(){return{isApprovalRequired:this.isApprovalRequired}}static fromResource(e){return new i(e.isApprovalRequired)}setProperty(e,t){const r=new i(this.isApprovalRequired);return r[e]=t,r}constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isApprovalRequired=e}}},12358:(e,t,r)=>{var i=r(95694),s=r(41069),n=/[&<>"']/g,a=RegExp(n.source);e.exports=function(e){return(e=s(e))&&a.test(e)?e.replace(n,i):e}},13378:(e,t,r)=>{"use strict";r.d(t,{e:()=>p});var i=r(14740),s=r.n(i),n=r(55491),a=r.n(n),o=r(40840),l=r.n(o),c=r(56707),d=r.n(c),u=r(98424);class p{static getClientDictionaryType(e){const t={};return l()(e,(e,r)=>{t[r]=new p(r,e.IsChecked,e.OrderHint,e.Title)}),t}static getGraphChecklistItem(e,t){return new p(e,t.isChecked,t.orderHint,t.title)}static getGraphClientDictionaryType(e){const t={};return l()(e,(e,r)=>{t[r]=p.getGraphChecklistItem(r,e)}),t}static getResourceDictionaryType(e){const t={};return l()(e,(e,r)=>{t[r]={IsChecked:e.isChecked,OrderHint:e.orderHint,Title:e.title}}),t}static getGraphResourceDictionaryType(e){const t={};return l()(e,(e,r)=>{t[r]={"@odata.type":"microsoft.graph.plannerChecklistItem",isChecked:e.isChecked,orderHint:e.orderHint,title:e.title},null!=e.lastModifiedBy&&(t[r].lastModifiedBy=e.lastModifiedBy),null!=e.lastModifiedDateTime&&(t[r].lastModifiedDateTime=e.lastModifiedDateTime)}),t}static getSortedChecklistItems(e){return s()(d()(e)).sort((e,t)=>-1*u.O.compareOrderHints(e.orderHint,t.orderHint))}static cloneChecklist(e){const t={};return a()(e,e=>{t[e.id]=e.getClone()}),t}static setChecklistProperty(e,t,r,i){if(null==e[t])throw new Error("ArgumentException: id not found in checklist");const s=p.cloneChecklist(e);return s[t]=s[t].setProperty(r,i),s}setProperty(e,t){if("isChecked"!==e&&"orderHint"!==e&&"title"!==e)throw new Error("ReadOnlyException: "+e);const r=this.getClone();return r[e]=t,r}toWebSerializable(){return{IsChecked:this.isChecked,OrderHint:this.orderHint,Title:this.title}}toGraphSerializable(){return{"@odata.type":"microsoft.graph.checklistItem",isChecked:this.isChecked,orderHint:this.orderHint,title:this.title}}getClone(){return new p(this.id,this.isChecked,this.orderHint,this.title)}constructor(e,t,r,i){this.id=e,this.isChecked=t,this.orderHint=r,this.title=i}}p.TitleMaxLength=100},14740:e=>{e.exports=function(e){for(var t=-1,r=null==e?0:e.length,i=0,s=[];++t<r;){var n=e[t];n&&(s[i++]=n)}return s}},14983:(e,t,r)=>{"use strict";var i;r.d(t,{Er:()=>i,LP:()=>s,ig:()=>n}),function(e){e.Word="Word",e.Excel="Excel",e.PowerPoint="PowerPoint",e.OneNote="OneNote",e.Project="Project",e.Visio="Visio",e.Pdf="Pdf",e.Loop="Loop",e.Other="Other"}(i||(i={}));i.OneNote,i.Project,i.Visio;var s,n=["jpg","jpeg","png","gif","bmp"];!function(e){e.Stream="stream-video",e.Youtube="yt-video",e.Vimeo="vimeo-video",e.DailyMotion="dm-video",e.Facebook="fb-video"}(s||(s={}))},16698:(e,t,r)=>{"use strict";r.d(t,{W:()=>l});var i,s,n,a,o=r(14983);!function(e){var t=/^(?:(?:https?):)?(?:\/\/)?(?:www\.)?(?:(?:dailymotion\.com(?:\/embed)?\/video)|dai\.ly)\/([a-zA-Z0-9]+)(?:_[\w_-]+)?$/;e.tryParseVideoUrl=function(e,r){var i=e.match(t);return null!=i&&(r.canPlay=!0,r.embedUrl="https://www.dailymotion.com/embed/video/"+i[1]+"?autoplay=0",r.provider=o.LP.DailyMotion,!0)}}(i||(i={})),function(e){var t=new RegExp("https://(.*).microsoftstream.com/(video/.*)");e.tryParseVideoUrl=function(e,r){var i=e.match(t);return null!=i&&(r.canPlay=!0,r.embedUrl="https://"+i[1]+".microsoftstream.com/embed/"+i[2]+"?autoplay=false",r.provider=o.LP.Stream,!0)}}(s||(s={})),function(e){var t=/vimeo\.com\/album\/.+\/video\/(.+)/,r=/vimeo\.com\/channels\/.+\/(.+)/,i=/vimeo\.com\/groups\/.+\/videos\/(.+)/,s=/vimeo\.com\/ondemand\/.+\/(.+)/,n=/vimeo\.com\/(.+)/;e.tryParseVideoUrl=function(e,a){var l=e.match(t)?e.match(t):e.match(r)?e.match(r):e.match(i)?e.match(i):e.match(s)?e.match(s):e.match(n);return null!=l&&(a.canPlay=!0,a.embedUrl="https://player.vimeo.com/video/"+l[1]+"?autoplay=0",a.provider=o.LP.Vimeo,!0)}}(n||(n={})),function(e){var t=/(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})|youtube\.com\/playlist\?list=/;e.tryParseVideoUrl=function(e,r){var i=e.match(t);return null!=i&&(r.canPlay=!0,r.embedUrl="https://www.youtube.com/embed/"+i[1]+"?autoplay=0",r.provider=o.LP.Youtube,!0)}}(a||(a={}));var l=function(){function e(){}return e.TryParseVideoUrl=function(e){var t={canPlay:!1,embedUrl:"",provider:"Unknown"};return s.tryParseVideoUrl(e,t)||n.tryParseVideoUrl(e,t)||i.tryParseVideoUrl(e,t)||a.tryParseVideoUrl(e,t),t},e}()},17776:(e,t,r)=>{"use strict";r.d(t,{g:()=>k});var i=r(72761),s=r(70252),n=r(88908),a=r(55491),o=r.n(a),l=r(42410),c=r(91246);class d{build(){return new k(this)}fromGraphResource(e){return this.withPropertyBag({version:e["@odata.etag"],id:e.id,orderHint:e.orderHint})}fromWebResource(e){return this.withPropertyBag({id:e.Id,orderHint:e.OrderHint,version:null!=e.ItemVersion?e.ItemVersion.toString():void 0})}newFromDifferentialUpdate(e){if(e.entityType!==i.I.Task&&e.entityType!==i.I.TaskboardBucketTaskFormatting)throw new Error("ArgumentException: invalid entity");const t=k.builder.withPropertyBag({id:e.id,version:e.itemVersion}).build(),r=e.getCreateDiffData(i.I.TaskboardBucketTaskFormatting),s=t.applyDiffs(r);return this.forClone(s)}forClone(e){return this.withPropertyBag({id:e.id,orderHint:e.orderHint,version:e.itemVersion})}withPropertyBag(e){return this.id=e.id,this.orderHint=e.orderHint||this.orderHint,this.version=e.version||this.version,this}withDefaultValues(){return this.withPropertyBag({id:"TaskID",orderHint:"orderhint1",version:"1"})}getDiffDataFromWebResource(e,t){const r={};return o()(e.Changes,t=>{switch(t.FieldName){case"OrderHint":e.ItemType===i.I.TaskboardBucketTaskFormatting&&(r.orderHint=t.Value);break;case"TaskBoardBucketOrderHint":r.orderHint=t.Value}}),r}getDiffDataFromGraphResource(e,t){const r=new l.F;return r.addMapping("orderHint","orderHint"),r.translate(e)}withId(e){return this.id=e,this}constructor(){this.id=c.o.generate(),this.orderHint=" !",this.version=""}}var u=r(679),p=r(17002),h=r.n(p),m=r(54320),g=r.n(m),f=r(36777),y=r.n(f);class k extends n.W{static get builder(){return new d}get taskboardType(){return s.s.Bucket}get entityType(){return i.I.TaskboardBucketTaskFormatting}setProperty(e,t){if("orderHint"!==e)throw new Error("ReadOnlyException: "+e);const r=this.getClone();return r[e]=t,r}toWebSerializable(){return{Id:this.id,OrderHint:this.orderHint,TaskBoardType:this.taskboardType,ItemVersion:g()(this.itemVersion)?null:parseInt(this.itemVersion,10)}}toGraphSerializable(){return{"@odata.etag":g()(this.itemVersion)?void 0:this.itemVersion,id:this.id,orderHint:this.orderHint}}getDiff(e){return u.B.getDiff(this,e,u.B.getDiffMomentCustomizer)}applyDiffs(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(!h()(t,e=>null!=e))throw new Error("ArgumentException: diffs - Diffs array contains null elements");return t.length>0?y()(k.builder.build(),this,...t,u.B.applyDiffMomentCustomizer):this}applyDifferentialUpdate(e){if(e.id!==this.id)throw new Error("ArgumentException: update.id must match this.id");const t=e.getUpdateDiffData(this,this.entityType);return this.applyDiffs(t)}getClone(){return this.getCloneBuilder().build()}getCloneBuilder(){return k.builder.forClone(this)}constructor(e){super(e.id,e.version),this.orderHint=e.orderHint}}},19449:(e,t,r)=>{var i=r(94710),s=r(32952),n=r(9096),a=r(54052);e.exports=function(e,t){return function(r,o){var l=a(r)?i:s,c=t?t():{};return l(r,e,n(o,2),c)}}},20719:(e,t,r)=>{"use strict";r.d(t,{t:()=>i});const i={Word:["docx","docm","doc","dotx","dotm"],Excel:["xlsx","xlsm","xlsb","xltx","xltm","xls","xlam","xla","xlw","xml"],PowerPoint:["pptx","pptm","ppt","potx","potm","pot","thmx","pps","ppsx","ppsm","ppsam","ppa"],OneNote:["one"],Project:["mpp","mpt","mpd"],Visio:["vsdx","vsd","vsdm","vssx","vssm","vstx","vstm"],Pdf:["pdf"],Loop:["loop","fluid"]}},22717:(e,t,r)=>{var i=r(80726),s=r(21817),n=r(72283),a=r(9096),o=r(85990),l=r(54052),c=r(44543),d=r(11629),u=r(46686),p=r(51268);e.exports=function(e,t,r){var h=l(e),m=h||c(e)||p(e);if(t=a(t,4),null==r){var g=e&&e.constructor;r=m?h?new g:[]:u(e)&&d(g)?s(o(e)):{}}return(m?i:n)(e,function(e,i,s){return t(r,e,i,s)}),r}},22794:(e,t,r)=>{var i=r(79742),s=r(75117),n=r(9096);e.exports=function(e,t){return e&&e.length?i(e,n(t,2),s):void 0}},23312:(e,t,r)=>{"use strict";r.d(t,{o:()=>v});var i=r(94778),s=r(77138),n=r(36723),a=r(69491),o=r(47453);class l extends a._{build(){return new v(this)}fromAttachmentResource(e,t){this.url=e,this.alias=t.Alias;const r=new o.d;return this.taskAttachmentType=r.fromAttachmentResource(e,t).build(),this.previewPriority=t.PreviewPriority,this.isProtected=t.isProtected??this.isProtected,this}fromGraphAttachmentResource(e,t){this.url=e,this.alias=t.alias;const r=new o.d;return this.taskAttachmentType=r.fromGraphAttachmentResource(e,t).build(),this.previewPriority=t.previewPriority,this}attachmentFromDriveItem(e,t){return super.fromDriveItem(e,t),this.previewPriority="",this.isProtected=!1,this}attachmentFromForm(e,t){return super.fromForm(e,t),this.previewPriority="",this.isProtected=!1,this}fromRecentlyUploadedDriveItem(e,t,r,i,n){return this.url=e+"/"+encodeURIComponent(n)+"?web=1",this.alias=t.substring(0,v.AliasMaxLength),this.taskAttachmentType=s.Z.builder.withPropertyBag({url:this.url,taskAttachmentType:r.taskAttachmentType}).build(),this.previewPriority=i,this.isProtected=!1,this}withPropertyBag(e){return super.withPropertyBag({alias:e.alias,taskAttachmentType:e.taskAttachmentType,url:e.url}),this.previewPriority=e.previewPriority||this.previewPriority||"",this.isProtected=void 0!==e.isProtected?e.isProtected:this.isProtected,this}withExpectedData(e){return this.withPropertyBag({alias:"name/alias"+e,taskAttachmentType:s.Z.builder.withPropertyBag({taskAttachmentType:n.Er.Other,specificType:n.ig[2]}).build(),url:"https://microsoft.sharepoint.com/teams/plannerweb/Shared%20Documents/documents/"+e+".png?web=1",previewPriority:"1000"+e,isProtected:!1})}ofType(e,t,r){return this.withExpectedData(e).withPropertyBag({taskAttachmentType:s.Z.builder.withPropertyBag({taskAttachmentType:t,specificType:t===n.Er.Other?r?n.ig[0]:"unknown":null}).build()})}constructor(){super(...arguments),this.isProtected=!1}}var c=r(56434),d=r.n(c),u=r(14740),p=r.n(u),h=r(40840),m=r.n(h),g=r(56707),f=r.n(g),y=r(98424),k=r(91246);class v extends i.R{static get builder(){return new l}static getClientDictionaryType(e){const t={};return m()(e,(e,r)=>{t[r]=v.builder.fromAttachmentResource(r,e).build()}),t}static getGraphClientDictionaryType(e){const t={};return m()(e,(e,r)=>{r=decodeURIComponent(r),t[r]=v.builder.fromGraphAttachmentResource(r,e).build()}),t}static getResourceDictionaryType(e){const t={};return m()(e,(e,r)=>{t[r]=e.toWebSerializable()}),t}static getGraphResourceDictionaryType(e){const t={};return m()(e,(e,r)=>{t[v.encodeGraphReferenceKey(r)]=e.toGraphSerializable()}),t}static getSortedAttachments(e){return p()(f()(e)).sort((e,t)=>-1*y.O.compareOrderHints(e.previewPriority,t.previewPriority))}static encodeGraphReferenceKey(e){return e.replace(/%/g,"%25").replace(/\./g,"%2E").replace(/:/g,"%3A").replace(/@/g,"%40").replace(/#/g,"%23")}toWebSerializable(){return{Alias:this.alias,Type:this.taskAttachmentType?this.taskAttachmentType.taskAttachmentType:null,PreviewPriority:this.previewPriority}}toGraphSerializable(){return{"@odata.type":"#microsoft.graph.plannerExternalReference",alias:this.alias,type:this.taskAttachmentType?this.taskAttachmentType.taskAttachmentType:null,previewPriority:this.previewPriority}}getClone(){return v.builder.withPropertyBag({alias:this.alias,taskAttachmentType:this.taskAttachmentType?d()(this.taskAttachmentType):s.Z.builder.withPropertyBag({url:this.url}).build(),url:this.url,previewPriority:this.previewPriority,isProtected:this.isProtected}).build()}setProperty(e,t){if("taskAttachmentType"===e||"isProtected"===e)throw new Error("ReadOnlyException: "+e);const r=this.getClone();return r[e]=t,r}getItemPath(e){if(k.o.isPlexTempId(this.url))return null;const t=decodeURIComponent(this.url);let r=decodeURIComponent(e);r.lastIndexOf("/")!==r.length-1&&(r+="/");const i=new RegExp(r,"ig");if(t.search(i)<0){let e="";const r=new RegExp("[?]sourcedoc={.*}&file=","ig");throw t.search(r)<0&&(e="OneDrive webUrl attachment url detected."),e+="Drive url different from attachment url",new Error(e)}return t.replace(i,"").replace("?web=1","")}constructor(e){super(e),this.previewPriority=e.previewPriority,this.isProtected=e.isProtected}}},27805:(e,t,r)=>{"use strict";var i;r.d(t,{u:()=>i}),function(e){e.CollectResponses="CollectResponses",e.EditForm="EditForm",e.ViewResponses="ViewResponses"}(i||(i={}))},32561:(e,t,r)=>{"use strict";r.d(t,{U:()=>se});var i=r(38752),s=r(45078),n=r(47453),a=r(72761),o=r(34648),l=r(23312),c=r(13378),d=r(54276),u=r(68501),p=r(39946),h=r(67875),m=r(48770);class g{build(){return new f(this)}fromApprovalResource(e){return this.approvalId=e.approvalId,this.approvalStatus=e.status,this}fromGraphApprovalResource(e){return this.approvalId=e.approvalId,this.approvalStatus=e.status,this}withPropertyBag(e){return this.approvalId=e.approvalId||this.approvalId||"",this.approvalStatus=void 0!==e.approvalStatus?e.approvalStatus:this.approvalStatus||m.q.UnknownFutureValue,this}}class f{static get builder(){return new g}toWebSerializable(){return{approvalId:this.approvalId,status:this.approvalStatus}}toGraphSerializable(){return{"@odata.type":"#microsoft.graph.plannerBasicApprovalAttachment",approvalId:this.approvalId,status:this.approvalStatus}}getClone(){return f.builder.withPropertyBag({approvalId:this.approvalId,approvalStatus:this.approvalStatus}).build()}setProperty(e,t){if("approvalStatus"===e)throw new Error("ReadOnlyException: "+e);const r=this.getClone();return r[e]=t,r}constructor(e){this.approvalId=e.approvalId,this.approvalStatus=e.approvalStatus}}var y=r(56434),k=r.n(y),v=r(55491),b=r.n(v),T=r(22717),w=r.n(T),P=r(91246),B=r(42410);class F{build(){return new se(this)}fromWebResource(e){const t=c.e.getClientDictionaryType(e.Checklist),r=l.o.getClientDictionaryType(e.References),s=i.B.clientSettings.Flights.TeamsTasksECS_richTextEditorEnabled&&!e.notes&&e.Description?{content:e.Description,contentType:d.c.HTML}:null,n=i.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryChecklist,a=i.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryForms,o=i.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryApprovals,h=this.withPropertyBag({checklist:t,description:e.Description||void 0,notes:null!=e.notes?{content:e.notes.content,contentType:d.c.HTML}:s,id:e.Id,itemVersion:null!=e.ItemVersion?e.ItemVersion.toString():void 0,previewType:e.PreviewType,references:r});return(n||a||o)&&(h.completionRequirements=e.completionRequirements?u.h.builder.fromGraphResource(e?.completionRequirements).build():null),a&&e.forms&&(h.forms=p.l.getClientDictionaryType(e.forms)),o&&e.approvalAttachment&&(h.approval=f.builder.fromApprovalResource(e.approvalAttachment).build()),h}fromGraphResource(e){const t=c.e.getGraphClientDictionaryType(e.checklist),r=l.o.getGraphClientDictionaryType(e.references),s=i.B.clientSettings.Flights.TeamsTasksECS_richTextEditorEnabled&&!e.notes&&e.description?{content:e.description,contentType:d.c.HTML}:void 0,n=i.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryChecklist,a=i.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryForms,h=i.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryApprovals,m=this.withPropertyBag({checklist:t,description:e.description||void 0,notes:null!=e.notes?{content:e.notes.content,contentType:d.c.HTML}:s,id:e.id,itemVersion:e["@odata.etag"],previewType:o.N.getPreviewTypeFromGraph(e.previewType),references:r});return(n||a||h)&&(m.completionRequirements=e.completionRequirements?u.h.builder.fromGraphResource(e?.completionRequirements).build():null),a&&e.forms&&(m.forms=p.l.getGraphClientDictionaryType(e.forms)),h&&e.approvalAttachment&&(m.approval=f.builder.fromGraphApprovalResource(e.approvalAttachment).build()),m}withPropertyBag(e){return this.completionRequirements=e.completionRequirements||this.completionRequirements,this.checklist=e.checklist||this.checklist,this.description=null!=e.description?e.description:this.description,this.notes=null!=e.notes?e.notes:this.notes,this.id=e.id,this.itemVersion=e.itemVersion||this.itemVersion,this.previewType=null!=e.previewType?e.previewType:this.previewType,this.references=e.references||this.references,this.forms=e.forms||this.forms,this.approval=e.approval||this.approval,this}withPreviewType(e,t){let r={};switch(e){case o.X.Description:r={description:"preview-type-description",notes:{content:"preview-type-description",contentType:d.c.HTML}};break;case o.X.CheckList:const e={},i="check list item Id",s=new c.e(i,!1,"abc a","cli title");e[s.id]=s,r={checklist:e};break;case o.X.Reference:r={references:t}}return this.withPropertyBag({...r,previewType:e,id:this.id})}withCompletionRequirements(e){return this.completionRequirements=e,this}withDefaultValues(){return this.withPropertyBag({checklist:{},completionRequirements:null,description:"task details description",notes:{content:"task details notes",contentType:d.c.HTML},id:"TaskDetailsId",itemVersion:"1",previewType:o.X.Automatic,references:{}})}withLocallyUniqueId(){return this.withPropertyBag({id:P.o.generate()})}withId(e){return this.id=e,this}newFromDifferentialUpdate(e){if(e.entityType!==a.I.TaskDetails&&e.entityType!==a.I.Task)throw new Error("ArgumentException: invalid entity");const t=se.builder.withPropertyBag({id:e.id,itemVersion:e.itemVersion}).build(),r=e.getCreateDiffData(a.I.TaskDetails),i=t.applyDiffs(r);return this.forClone(i)}forClone(e){return this.withPropertyBag({checklist:k()(e.checklist),completionRequirements:k()(e.completionRequirements),description:e.description||void 0,notes:null!=e.notes?{content:e.notes.content,contentType:e.notes.contentType}:void 0,id:e.id,itemVersion:e.itemVersion,previewType:k()(e.previewType),references:k()(e.references),forms:k()(e.forms),approval:k()(e.approval)})}getDiffDataFromWebResource(e,t){const r={},i=new B.F;i.addMapping("Checklist","checklist"),i.addMapping("Description","description"),i.addMapping("notes","notes"),i.addMapping("PreviewType","previewType"),i.addMapping("References","references"),i.addMapping("forms","forms"),i.addMapping("approval","approval");const a=new B.F;a.addMapping("Title","title"),a.addMapping("IsChecked","isChecked"),a.addMapping("OrderHint","orderHint");const o=new B.F;o.addMapping("Alias","alias"),o.addMapping("PreviewPriority","previewPriority"),o.addMapping("Type","taskAttachmentType"),o.addMapping("isProtected","isProtected");const d=new B.F;d.addMapping("displayName","displayName"),d.addMapping("formResponse","formResponse"),d.addMapping("formWebUrl","collectResponsesUrl");const u=new B.F;u.addMapping("approvalId","approvalId"),u.addMapping("status","approvalStatus");let p=!1,m=!1,g=!1,f=!1,y=!1;return b()(e.Changes,e=>{const v=e.FieldName;switch(v){case"Checklist":const b=i.getMappedClientKey(v);if(1===e.PathSegments.length&&null==e.Value)r[b]=s.Wh.CollectionCleanupValue,p=!0;else if(e.PathSegments.length>=2){r[b]||(r[b]=t?.checklist?k()(t.checklist):{});const i=e.PathSegments[1];if(2===e.PathSegments.length&&null==e.Value)delete r[b][i],p=!0;else if(3===e.PathSegments.length){const t=e.PathSegments[2];if(a.hasMapping(t)){const s=a.getMappedClientKey(t);r[b][i]||(r[b][i]=new c.e(i,!1,"","")),r[b][i][s]=a.translateValue(t,s,e.Value),p=!0}}}break;case"forms":const T=i.getMappedClientKey(v);if(1===e.PathSegments.length&&null==e.Value)r[T]=s.Wh.CollectionCleanupValue,f=!0;else if(e.PathSegments.length>=2){r[T]||(r[T]=t?.forms?k()(t.forms):{});const i=e.PathSegments[1];if(2===e.PathSegments.length&&null==e.Value)delete r[T][i],f=!0;else if(3===e.PathSegments.length){const t="formResponseId"===e.PathSegments[2]?"formResponse":e.PathSegments[2];if(d.hasMapping(t)){const s=d.getMappedClientKey(t);if(!r[T][i]){const e=(new h.o).withPropertyBag({formId:i}).build();r[T][i]=e}r[T][i][s]=d.translateValue(t,s,e.Value),f=!0}}}break;case"approval":const w=i.getMappedClientKey(v);if(1!==e.PathSegments.length&&2!==e.PathSegments.length||null!=e.Value){if(e.PathSegments.length>=3){r[w]||(r[w]=t?.approval?k()(t.approval):{});const i=e.PathSegments[2];if(u.hasMapping(i)){const t="status"===i?e.Value.toLowerCase():e.Value,s=u.getMappedClientKey(i);r[w][s]=u.translateValue(i,s,t),y=!0}}}else r[w]=s.Wh.CollectionCleanupValue,y=!0;break;case"notes":const P=i.getMappedClientKey(v);if(1===e.PathSegments.length&&null==e.Value)r[P]=s.Wh.CollectionCleanupValue,g=!0;else if(e.PathSegments.length>=2){r[P]||(r[P]=t?.notes?k()(t.notes):{});const s=e.PathSegments[0],n=e.PathSegments[1],a="contentType";2===e.PathSegments.length&&i.hasMapping(s)&&(r[P][n]=i.translateValue(s,P,e.Value),r[P][a]="html",g=!0)}break;case"Description":case"PreviewType":const B=i.getMappedClientKey(v);r[B]=i.translateValue(v,B,e.Value);break;case"References":const F=i.getMappedClientKey(v);if(1===e.PathSegments.length&&null==e.Value)r[F]=s.Wh.CollectionCleanupValue,m=!0;else if(e.PathSegments.length>=2){r[F]||(r[F]=t?.references?k()(t.references):{});const i=e.PathSegments[1];if(2===e.PathSegments.length&&null==e.Value)delete r[F][i],m=!0;else if(3===e.PathSegments.length){const t=e.PathSegments[2];if(o.hasMapping(t)){const s=o.getMappedClientKey(t);switch(r[F][i]||(r[F][i]=l.o.builder.withPropertyBag({url:i}).build()),t){case"Alias":case"PreviewPriority":case"isProtected":r[F][i][s]=o.translateValue(t,s,e.Value),m=!0;break;case"Type":const a=(new n.d).fromAttachmentResource(i,{Alias:"",PreviewPriority:"",Type:e.Value,isProtected:!1}).build();r[F][i][s]=a,m=!0}}}}}}),!m&&"references"in r&&delete r.references,!g&&"notes"in r&&delete r.notes,!p&&"checklist"in r&&delete r.checklist,!f&&"forms"in r&&delete r.forms,!y&&"approval"in r&&delete r.approval,r}getDiffDataFromGraphResource(e,t){const r=new B.F;return r.addMapping("checklist","checklist",e=>{if(null==e)return s.Wh.CollectionCleanupValue;const r=t?.checklist?k()(t.checklist):{};for(const t in e)null==e[t]?delete r[t]:t in r?("title"in e[t]&&(r[t]=r[t].setProperty("title",e[t].title)),"isChecked"in e[t]&&(r[t]=r[t].setProperty("isChecked",e[t].isChecked)),"orderHint"in e[t]&&(r[t]=r[t].setProperty("orderHint",e[t].orderHint))):r[t]=c.e.getGraphChecklistItem(t,e[t]);return r}),r.addMapping("forms","forms",e=>{if(null==e)return s.Wh.CollectionCleanupValue;const r=t?.forms?k()(t.forms):{};for(const t in e)if(null==e[t])delete r[t];else if(t in r)"displayName"in e[t]&&(r[t]=r[t].setProperty("displayName",e[t].displayName)),"formResponse"in e[t]&&(r[t]=r[t].setProperty("formResponse",e[t].formResponse)),"formWebUrl"in e[t]&&(r[t]=r[t].setProperty("collectResponsesUrl",e[t].formWebUrl));else{const i=(new h.o).fromGraphFormResource(t,e[t]).build();r[t]=i}return r}),r.addMapping("approvalAttachment","approval",e=>{if(null==e)return null;const r=t?.approval?k()(t.approval):{};return"approvalId"in e&&(r.approvalId=e.approvalId),"status"in e&&(r.approvalStatus=e.status),r}),r.addMapping("description","description"),r.addMapping("notes","notes"),r.addMapping("previewType","previewType",e=>o.N.getPreviewTypeFromGraph(e)),r.addMapping("references","references",e=>{if(null==e)return s.Wh.CollectionCleanupValue;e=w()(e,(e,t,r)=>e[decodeURIComponent(r)]=t);const r=t?.references?k()(t.references):{};for(const t in e)if(null==e[t])delete r[t];else if(t in r){if("alias"in e[t]&&(r[t]=r[t].setProperty("alias",e[t].alias)),"previewPriority"in e[t]&&(r[t]=r[t].setProperty("previewPriority",e[t].previewPriority)),"type"in e[t]){const i=(new n.d).fromGraphAttachmentResource(t,e[t]).build();r[t].taskAttachmentType=i}}else r[t]=l.o.builder.fromGraphAttachmentResource(t,e[t]).build();return r}),r.translate(e)}constructor(){this.id=P.o.generate(),this.completionRequirements=null,this.checklist={},this.references={},this.description=null,this.notes=null,this.previewType=o.X.Automatic,this.forms={},this.approval=null}}var R=r(88908),C=r(38621),A=r(11569),D=r(14740),S=r.n(D),I=r(17002),E=r.n(I),H=r(50723),x=r.n(H),U=r(85855),V=r.n(U),M=r(40840),O=r.n(M),q=r(19853),W=r.n(q),G=r(10871),L=r.n(G),N=r(28673),z=r.n(N),_=r(22794),$=r.n(_),j=r(36777),K=r.n(j),X=r(59364),Z=r.n(X),Y=r(35640),Q=r.n(Y),J=r(26727),ee=r.n(J),te=r(679),re=r(98424),ie=r(36723);class se extends R.W{static get builder(){return new F}static mergeCustomizer(e,t,r){return"checklist"===r||"references"===r||"forms"===r?W()(t,s.Wh.CollectionCleanupValue)?{}:t:"completionRequirements"!==r||W()(e,t)?te.B.applyDiffMomentCustomizer(e,t,r):t}get entityType(){return a.I.TaskDetails}get hasThumbnail(){return(this.previewType===o.X.Reference||this.previewType===o.X.Automatic)&&null!=this.getReferenceWithLowestPriority()}toWebSerializable(){const e=this.removeTemporaryAttachments(),t=c.e.getResourceDictionaryType(e.checklist),r=l.o.getResourceDictionaryType(e.references),s=i.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryChecklist,n=i.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryForms,a=i.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryApprovals,o={References:r,Checklist:t,Id:e.id,Description:e.description,notes:e.notes?.content?{content:e.notes.content,contentType:e.notes.contentType}:null,PreviewType:e.previewType,ItemVersion:null!=e.itemVersion?parseInt(e.itemVersion,10):null};return(s||n||a)&&(o.completionRequirements=e.completionRequirements?.toGraphSerializable()),n&&(o.forms=p.l.getResourceDictionaryType(e.forms)),a&&(o.approvalAttachment=e.approval?.toWebSerializable()??null),o}toGraphSerializable(){const e=this.removeTemporaryAttachments(),t=c.e.getGraphResourceDictionaryType(e.checklist),r=l.o.getGraphResourceDictionaryType(e.references),s=i.B.clientSettings.Flights.TeamsTasksECS_richTextEditorEnabled,n=i.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryChecklist,a=i.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryForms,d=i.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryApprovals,u=s&&e.notes?.content?{content:e.notes.content,contentType:e.notes.contentType}:void 0,h=s?void 0:e.description,m={references:r,checklist:t,id:e.id,description:h,notes:u,previewType:o.N.getGraphPreviewType(e.previewType),"@odata.etag":null!=e.itemVersion?e.itemVersion:void 0};return(n||a||d)&&(m.completionRequirements=e.completionRequirements?.toGraphSerializable()),a&&(m.forms=p.l.getGraphResourceDictionaryType(e.forms)),d&&(m.approvalAttachment=e.approval?.toGraphSerializable()??null),m}setProperty(e,t){if("id"===e||"itemVersion"===e)throw new Error("ReadOnlyException: "+e);const r=this.getClone();return r[e]=t,r}getDiff(e){return te.B.getDiff(this,e,(e,t,r)=>"checklist"===r||"references"===r||"forms"===r?W()(e,t)?{}:W()(t,{})?s.Wh.CollectionCleanupValue:t:"completionRequirements"!==r||W()(e,t)?te.B.getDiffMomentCustomizer(e,t,r):t)}applyDiffs(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(!E()(t,e=>null!=e))throw new Error("ArgumentException: diffs - Diffs array contains null elements");return t.length>0?K()(se.builder.build(),this,...t,se.mergeCustomizer):this}applyDifferentialUpdate(e){if(e.id!==this.id)throw new Error("ArgumentException: update.id must match this.id");const t=e.getUpdateDiffData(this,this.entityType);return this.applyDiffs(t)}getReferenceWithHighestPriority(){const e=$()(z()(this.references),e=>this.references[e].previewPriority);return null==e?null:this.references[e]}getReferenceWithLowestPriority(){const e=Z()(z()(this.references),e=>this.references[e].previewPriority);return null==e?null:this.references[e]}getTaskPreviewReference(){return this.getReferenceWithLowestPriority()}getAttachmentsSortedByAlias(){const e=[];return O()(this.references,(t,r)=>{t.taskAttachmentType.taskAttachmentType!==ie.Er.TeamsHostedApp&&e.push(t)}),e.sort((e,t)=>l.o.aliasCompare(e,t)),e}attachmentExists(e){return null!=this.references[e.url]}doesUrlExistAsAttachment(e){return null!=this.references[e]}addAttachment(e){if(null!=this.references[e.url])throw new Error("AggregateException: attachment already exists");const t=k()(this.references);return t[e.url]=e,this.setProperty("references",t)}removeAttachment(e){if(null==this.references[e])throw new Error("NotFoundException: attachment not found on task details");const t=L()(x()(this.references,t=>t.url!==e),e=>e.url);return this.setProperty("references",t)}removeTemporaryAttachments(){const e=L()(x()(this.references,e=>!P.o.isPlexTempId(e.url)),e=>e.url);return this.setProperty("references",e)}replaceAttachment(e,t){if(null==this.references[e.url])throw new Error("NotFoundException: oldAttachment not found on task details");const r=L()(x()(this.references,t=>t.url!==e.url),e=>e.url);return r[t.url]=t,this.setProperty("references",r)}checkChecklistItem(e,t){const r=c.e.setChecklistProperty(this.checklist,e,"isChecked",t);return this.setProperty("checklist",r)}getPromotedProperties(){const e=null==this.references?0:Q()(this.references),t=this.getChecklistStats();return{hasDescription:!!this.description||!!this.notes,numberOfAttachments:e,numberOfActiveChecklistItems:t.numActiveItems,numberOfChecklistItems:t.numItems,previewType:this.previewType}}hasMandatoryChecklist(){return null!=this.checklist&&null!=this.completionRequirements?.checklistRequirement}getCopy(){const e=this.getClone();if(null!=e.checklist){const t=c.e.getSortedChecklistItems(e.checklist);b()(t,(r,i)=>{let s;s=r===V()(t)?re.O.generateOrderHintBetween(t[i].orderHint,null):re.O.generateOrderHintBetween(t[i].orderHint,t[i-1].orderHint),e.checklist[t[i].id]=e.checklist[t[i].id].setProperty("orderHint",s)})}if(null!=e.references){const t=l.o.getSortedAttachments(e.references);b()(t,(r,i)=>{let s;s=r===V()(t)?re.O.generateOrderHintBetween(t[i].previewPriority,null):re.O.generateOrderHintBetween(t[i].previewPriority,t[i-1].previewPriority),e.references[t[i].url]=e.references[t[i].url].setProperty("previewPriority",s)})}return e}getCloneBuilder(){return se.builder.forClone(this)}getClone(){return this.getCloneBuilder().build()}getChecklistStats(){const e=null==this.checklist?{}:this.checklist,t=S()(ee()(e));return{numItems:t.length,numActiveItems:t.filter(e=>!e.isChecked).length}}getFormsSortedByAlias(){const e=[];return O()(this.forms,(t,r)=>{e.push(t)}),e.sort((e,t)=>p.l.displayNameCompare(e,t)),e}addForm(e){if(null!=this.forms[e.formId])throw new Error("AggregateException: form already exists");const t=k()(this.forms);t[e.formId]=e;const r=this.setProperty("forms",t),i=z()(t);return this.updateFormsRequirement(i,r)}replaceForm(e,t){if(null==this.forms[e.formId])throw new Error("NotFoundException: oldForm not found on task details");const r=L()(x()(this.forms,t=>t.formId!==e.formId),e=>e.formId);r[t.formId]=t;const i=this.setProperty("forms",r),s=z()(r);return this.updateFormsRequirement(s,i)}removeForm(e){if(null==this.forms[e.formId])throw new Error("NotFoundException: form not found on task details");const t=L()(x()(this.forms,t=>t.formId!==e.formId),e=>e.formId),r=this.setProperty("forms",t),i=z()(t);return this.updateFormsRequirement(i,r)}updateFormsRequirement(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,r=t.completionRequirements??u.h.builder.build();const i=0===e.length?null:new C.T(e);return r=r.setProperty("formsRequirement",i),t.setProperty("completionRequirements",r)}updateApprovalRequirement(e){const t=new A.L(e);if(this.completionRequirements){const e=this.completionRequirements.setProperty("approvalRequirement",t);return this.setProperty("completionRequirements",e)}return this.setProperty("completionRequirements",u.h.builder.withApprovalRequirement(t).build())}constructor(e){super(e.id,e.itemVersion),this.notes=e.notes?e.notes:null,this.description=e.description?e.description:null,this.checklist=e.checklist,this.previewType=e.previewType,this.references=e.references,this.completionRequirements=e.completionRequirements,this.forms=e.forms,this.approval=e.approval?e.approval:null}}se.DescriptionMaxLength=32768,se.MaxChecklistItemsPerTask=20},32952:(e,t,r)=>{var i=r(45652);e.exports=function(e,t,r,s){return i(e,function(e,i,n){t(s,e,r(e),n)}),s}},33268:(e,t,r)=>{"use strict";r.d(t,{XY:()=>k,lo:()=>y,sN:()=>v,wS:()=>f});var i=r(38752),s=r(8453),n=r(72761),a=r(40468),o=r(12358),l=r.n(o),c=r(54320),d=r.n(c),u=r(74844),p=r(74065),h=r.n(p),m=r(85855),g=r.n(m);class f{static getFavIconUrl(e){return"https://"+f.extractHostname(e)+"/favicon.ico"}static generateEntityHyperlink(e,t,r,i){switch(e.entityType){case n.I.Task:return this.generateTaskHyperLink(e,t,r,i);case n.I.Plan:return this.generatePlanHyperLink(e,t,r,i);default:throw new Error("NotSupportedException: entity.type")}}static generateEntityLink(e,t,r,i){switch(e.entityType){case n.I.Task:return this.generateTaskLink(e,t,r,i);case n.I.Plan:return this.generatePlanLink(e,t,r,i);default:throw new Error("NotSupportedException: entity.type")}}static generateOWAGroupEmailSettingsLink(e,t,r){if(d()(e))return r.logTrace(508047762,u.k.Warning,"Empty owa host. Hiding the whole owa link."),"";if(d()(t)||t.indexOf("@")<0||t.indexOf("@")!==t.lastIndexOf("@"))return`https://${e}`;{const r=t.split("@")[0];return`https://${e}/mail/group/${t.split("@")[1]}/${r}/action/EmailSettings`}}static extractHostname(e){let t="";return t=e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0],t=t.split(":")[0],t=t.split("?")[0],t=t.split("#")[0],t}static getPlanExternalUrl(e,t){const r=a.T.builder.withPlan(e).withDetails(t).build(),i=r.getCreationContextInfo()?.key;let s=null;return i&&(s=t.contextDetails[i].url??null),s}static generateTaskHyperLink(e,t,r,i){return'<a href="'+this.generateTaskLink(e,t,r,i)+'" target="_blank" rel="noopener noreferrer">'+l()(e.title)+"</a>"}static generatePlanHyperLink(e,t,r,i){return'<a href="'+this.generatePlanLink(e,t,r,i)+'" target="_blank" rel="noopener noreferrer">'+l()(e.title)+"</a>"}static generateTaskLink(e,t,r,n){return e.creationSource.external?.contextScenarioId===s.z.project&&e.creationSource.external?.webUrl?e.creationSource.external?.webUrl:this.generatePlannerLink(`${i.B.absoluteRedirectRoot}/Home/Task/${e.id}`,t,r,n)}static generatePlanLink(e,t,r,s){return this.generatePlannerLink(`${i.B.absoluteRedirectRoot}/Home/PlanViews/${e.id}`,t,r,s)}static generatePlannerLink(e,t,r,i){return`${e}?Type=${t}&Channel=${r}&CreatedTime=${621355968e9+1e4*i.getTime()}`}static getValidUrl(e){const t=f.formatUrlWithHttpUrlScheme(e);return f.validateUrl(t)}static formatUrlWithHttpUrlScheme(e){return f.getUrlScheme(e).toLowerCase()===f.httpScheme?f.ensureUrlScheme(e,f.httpScheme):f.ensureUrlScheme(e,f.httpsScheme)}static validateUrl(e){try{const t=new URL(e);if(!t.host||!t.hostname||!t.origin||"null"===t.origin||"http:"!==t.protocol&&"https:"!==t.protocol)return;return t.toString()}catch{return}}static getUrlScheme(e){const t=new RegExp("(.*)://.*","i").exec(e)||[];return h()(t)||""}static ensureUrlScheme(e,t){return`${t&&g()(t.split("://"))}://${f.removeUrlScheme(e)}`}static removeUrlScheme(e){const t=new RegExp("(http(s)?(:)?(//)?)*(.*)","i").exec(e)||[];return h()(t)||""}static getQueryParamValue(e,t){return new URLSearchParams(new URL(e).search).get(t)}}function y(e){return`${b()}hubnew?importPlanId=${e}`}function k(){return`${i.B.clientSettings.ECSSettings.ProjectServiceConfig.Hostname}trialFRE#templates`}function v(){return`${i.B.clientSettings.ECSSettings.ProjectServiceConfig.Hostname}trialFRE#templates/{0}`}function b(){return`${i.B.clientSettings.ECSSettings.ProjectServiceConfig.Hostname}${i.B.tenantDomain}/${i.B.culture}#/`}f.httpScheme="http",f.httpsScheme="https"},38621:(e,t,r)=>{"use strict";r.d(t,{T:()=>i});class i{toGraphSerializable(){return{requiredForms:this.requiredForms}}static fromResource(e){return new i(e.requiredForms)}setProperty(e,t){const r=new i([...this.requiredForms]);return r[e]=t,r}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.requiredForms=e}}},39115:(e,t,r)=>{var i=r(45967),s=r(36311),n=r(50715);e.exports=function(e){return s(e)?n(e):i(e)}},39589:(e,t,r)=>{"use strict";r.d(t,{_:()=>c});var i=r(54320),s=r.n(i),n=r(64696),a=r(17776),o=r(97139);class l{build(){return new c(this)}fromTaskBoardTaskFormattingCollectionResource(e){return this.withPropertyBag({assignedBoardFormat:null==e.AssignmentBoardFormat?void 0:n.x.builder.fromWebResource(e.AssignmentBoardFormat).build(),bucketBoardFormat:null==e.BucketBoardFormat?void 0:a.g.builder.fromWebResource(e.BucketBoardFormat).build(),progressBoardFormat:null==e.ProgressBoardFormat?void 0:o.j.builder.fromWebResource(e.ProgressBoardFormat).build()})}fromGraphTaskBoardTaskFormattingCollectionResource(e){return this.withPropertyBag({assignedBoardFormat:null==e.assignmentBoardFormat?void 0:n.x.builder.fromGraphResource(e.assignmentBoardFormat).build(),bucketBoardFormat:null==e.bucketBoardFormat?void 0:a.g.builder.fromGraphResource(e.bucketBoardFormat).build(),progressBoardFormat:null==e.progressBoardFormat?void 0:o.j.builder.fromGraphResource(e.progressBoardFormat).build()})}withPropertyBag(e){return this.assignedBoardFormat=e.assignedBoardFormat||this.assignedBoardFormat,this.bucketBoardFormat=e.bucketBoardFormat||this.bucketBoardFormat,this.progressBoardFormat=e.progressBoardFormat||this.progressBoardFormat,this}withDefaultValues(){return this.withPropertyBag({assignedBoardFormat:void 0,bucketBoardFormat:void 0,progressBoardFormat:void 0})}constructor(){}}class c{static getAssignedToOrderHint(e,t){return null==e.assignmentBoardFormat?null:null==t||s()(t)?e.assignmentBoardFormat.unassignedOrderHint:e.assignmentBoardFormat.orderHintsByAssignee[t]}static setAssignedToOrderHint(e,t,r){if(null==e.assignmentBoardFormat)return e;let i=e.assignmentBoardFormat.getClone();if(s()(r))i=i.setProperty("unassignedOrderHint",t);else{const e=i.orderHintsByAssignee;null==t?delete e[r]:e[r]=t,i=i.setProperty("orderHintsByAssignee",e)}return e.setProperty("assignmentBoardFormat",i)}static getBucketOrderHint(e,t){return null==e.bucketBoardFormat?null:e.bucketBoardFormat.orderHint}static setBucketOrderHint(e,t,r){if(null==e.bucketBoardFormat)return e;const i=e.bucketBoardFormat.setProperty("orderHint",t);return e.setProperty("bucketBoardFormat",i)}static getProgressOrderHint(e,t){return null==e.progressBoardFormat?null:e.progressBoardFormat.orderHint}static setProgressOrderHint(e,t,r){if(null==e.progressBoardFormat)return e;const i=e.progressBoardFormat.setProperty("orderHint",t);return e.setProperty("progressBoardFormat",i)}setProperty(e,t){if("assignmentBoardFormat"!==e&&"bucketBoardFormat"!==e&&"progressBoardFormat"!==e)throw new Error("ReadOnlyException: "+e);const r=this.getClone();return r[e]=t,r}static get builder(){return new l}toWebSerializable(){return{AssignmentBoardFormat:null!=this.assignmentBoardFormat?this.assignmentBoardFormat.toWebSerializable():void 0,BucketBoardFormat:null!=this.bucketBoardFormat?this.bucketBoardFormat.toWebSerializable():void 0,ProgressBoardFormat:null!=this.progressBoardFormat?this.progressBoardFormat.toWebSerializable():void 0}}toGraphSerializable(){return{assignmentBoardFormat:null!=this.assignmentBoardFormat?this.assignmentBoardFormat.toGraphSerializable():void 0,bucketBoardFormat:null!=this.bucketBoardFormat?this.bucketBoardFormat.toGraphSerializable():void 0,progressBoardFormat:null!=this.progressBoardFormat?this.progressBoardFormat.toGraphSerializable():void 0}}getClone(){const e=this.toWebSerializable();return c.builder.fromTaskBoardTaskFormattingCollectionResource(e).build()}constructor(e){this.assignmentBoardFormat=e.assignedBoardFormat,this.bucketBoardFormat=e.bucketBoardFormat,this.progressBoardFormat=e.progressBoardFormat}}},39946:(e,t,r)=>{"use strict";r.d(t,{l:()=>u});var i=r(40840),s=r.n(i),n=r(67875),a=r(28730),o=r(61086),l=r.n(o),c=r(33268),d=r(27805);class u{static get builder(){return new n.o}static displayNameCompare(e,t){return a.l.compareStringForDisplay(e?.displayName?.toUpperCase(),t?.displayName?.toUpperCase())}static generateFormUniqueId(e){let t="";do{t=l()(1e4,99999,!1).toString()}while(null!=e[t]);return t}static parseFormIdFromUrl(e){return c.wS.getQueryParamValue(e,"id")}static getFormUrl(e,t,r){if(!e)return"";switch(t){case d.u.EditForm:return`https://forms.office.com/Pages/DesignPageV2.aspx?origin=NeoPortalPage&subpage=design&id=${e}`;case d.u.ViewResponses:return`https://forms.office.com/Pages/DesignPageV2.aspx?origin=NeoPortalPage&subpage=design&id=${e}&analysis=true`;case d.u.CollectResponses:default:return r?.collectResponsesUrl??`https://forms.office.com/Pages/ResponsePage.aspx?id=${e}`}}static getClientDictionaryType(e){const t={};return s()(e,(e,r)=>{t[r]=u.builder.fromFormResource(r,e).build()}),t}static getGraphClientDictionaryType(e){const t={};return s()(e,(e,r)=>{r=decodeURIComponent(r),t[r]=u.builder.fromGraphFormResource(r,e).build()}),t}static getResourceDictionaryType(e){const t={};return s()(e,(e,r)=>{t[r]=e.toWebSerializable()}),t}static getGraphResourceDictionaryType(e){const t={};return s()(e,(e,r)=>{t[r]=e.toGraphSerializable()}),t}toWebSerializable(){return{displayName:this.displayName,formWebUrl:this.collectResponsesUrl,formResponse:this.formResponse}}toGraphSerializable(){return{"@odata.type":"#microsoft.taskServices.form",displayName:this.displayName,formWebUrl:this.collectResponsesUrl,formResponse:this.formResponse}}getClone(){return u.builder.withPropertyBag({displayName:this.displayName,formResponse:this.formResponse,formId:this.formId,formWebUrl:this.collectResponsesUrl}).build()}setProperty(e,t){const r=this.getClone();return r[e]=t,r}constructor(e){this.displayName=e.displayName,this.formResponse=e.formResponse,this.formId=e.formId,this.collectResponsesUrl=e.collectResponsesUrl,this.urlFormId=e.urlFormId}}u.TitleMaxLength=90},45234:e=>{e.exports=function(e){for(var t,r=[];!(t=e.next()).done;)r.push(t.value);return r}},45967:e=>{e.exports=function(e){return e.split("")}},47451:(e,t,r)=>{"use strict";r.d(t,{A:()=>h});var i=r(20719),s=r(36723),n=r(77138),a=r(16698),o=r(98990),l=r.n(o),c=r(55491),d=r.n(c),u=r(69108),p=r.n(u);class h{build(){return new n.Z(this)}fromDriveItem(e,t){return this.taskAttachmentType=t.fileType,this.taskAttachmentType===s.Er.Other&&e&&(this.specificType=this.getSpecificType(e),this.videoUrlParseResult=a.W.TryParseVideoUrl(e)),this}fromFileName(e){let t=s.Er.Other,r=null;const a=e.lastIndexOf(".");if(a>-1){const o=e.slice(a+1).toLowerCase();d()(i.t,(e,r)=>{l()(e,e=>e.toLowerCase()===o)&&(t=n.Z.getTaskAttachmentTypeFromString(r))}),p()(s.ig,o)>=0&&(r=o)}return this.specificType=r,this.taskAttachmentType=t,this}withPropertyBag(e){return this.taskAttachmentType=e.taskAttachmentType||this.taskAttachmentType,this.specificType=e.specificType||this.specificType,this.taskAttachmentType===s.Er.Other&&e.url&&(null==this.specificType&&(this.specificType=this.getSpecificType(e.url)),this.videoUrlParseResult=a.W.TryParseVideoUrl(e.url)),this}ofDriveItemType(e){return this.taskAttachmentType=e,this}getSpecificType(e){const t=e.slice((e.lastIndexOf(".")-1>>>0)+2).split(/\#|\?|\&|\s/g);return t.length>0&&p()(s.ig,t[0].toLowerCase())>=0?t[0]:null}constructor(){this.taskAttachmentType=s.Er.Other,this.specificType=null,this.videoUrlParseResult={canPlay:!1,embedUrl:"",provider:"Unknown"}}}},47453:(e,t,r)=>{"use strict";r.d(t,{d:()=>o});var i=r(36723),s=r(77138),n=r(47451),a=r(16698);class o extends n.A{fromAttachmentResource(e,t){return this.taskAttachmentType=s.Z.getTaskAttachmentTypeFromString(t.Type),this.taskAttachmentType===i.Er.Other&&e&&(this.specificType=this.getSpecificType(e),this.videoUrlParseResult=a.W.TryParseVideoUrl(e)),this}fromGraphAttachmentResource(e,t){return this.taskAttachmentType=s.Z.getTaskAttachmentTypeFromString(t.type),this.taskAttachmentType===i.Er.Other&&e&&(this.specificType=this.getSpecificType(e),this.videoUrlParseResult=a.W.TryParseVideoUrl(e)),this}fromFormResource(e){return e&&(this.taskAttachmentType=i.Er.Form),this}fromGraphFormResource(e){return e&&(this.taskAttachmentType=i.Er.Form),this}}},50061:e=>{e.exports=function(e,t){return e<t}},50715:e=>{var t="\\ud800-\\udfff",r="["+t+"]",i="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",s="\\ud83c[\\udffb-\\udfff]",n="[^"+t+"]",a="(?:\\ud83c[\\udde6-\\uddff]){2}",o="[\\ud800-\\udbff][\\udc00-\\udfff]",l="(?:"+i+"|"+s+")"+"?",c="[\\ufe0e\\ufe0f]?",d=c+l+("(?:\\u200d(?:"+[n,a,o].join("|")+")"+c+l+")*"),u="(?:"+[n+i+"?",i,a,o,r].join("|")+")",p=RegExp(s+"(?="+s+")|"+u+d,"g");e.exports=function(e){return e.match(p)||[]}},54276:(e,t,r)=>{"use strict";var i;r.d(t,{c:()=>i}),function(e){e.Text="text",e.HTML="html"}(i||(i={}))},56707:(e,t,r)=>{var i=r(9812),s=r(91980),n=r(26924),a=r(6571),o=r(90620),l=r(45234),c=r(54160),d=r(52074),u=r(39115),p=r(26727),h=i?i.iterator:void 0;e.exports=function(e){if(!e)return[];if(a(e))return o(e)?u(e):s(e);if(h&&e[h])return l(e[h]());var t=n(e);return("[object Map]"==t?c:"[object Set]"==t?d:p)(e)}},59364:(e,t,r)=>{var i=r(79742),s=r(9096),n=r(50061);e.exports=function(e,t){return e&&e.length?i(e,s(t,2),n):void 0}},61086:(e,t,r)=>{var i=r(83518),s=r(60929),n=r(37303),a=parseFloat,o=Math.min,l=Math.random;e.exports=function(e,t,r){if(r&&"boolean"!=typeof r&&s(e,t,r)&&(t=r=void 0),void 0===r&&("boolean"==typeof t?(r=t,t=void 0):"boolean"==typeof e&&(r=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):(e=n(e),void 0===t?(t=e,e=0):t=n(t)),e>t){var c=e;e=t,t=c}if(r||e%1||t%1){var d=l();return o(e+d*(t-e+a("1e-"+((d+"").length-1))),t)}return i(e,t)}},64696:(e,t,r)=>{"use strict";r.d(t,{x:()=>F});var i=r(41740),s=r.n(i),n=r(17002),a=r.n(n),o=r(54320),l=r.n(o),c=r(19853),d=r.n(c),u=r(36777),p=r.n(u),h=r(45078),m=r(72761),g=r(70252),f=r(88908),y=r(56434),k=r.n(y),v=r(55491),b=r.n(v),T=r(42410),w=r(91246);class P{build(){return new F(this)}fromWebResource(e){return this.withPropertyBag({id:e.Id,version:null!=e.ItemVersion?e.ItemVersion.toString():void 0,orderHintsByAssignee:e.OrderHintsByAssignee,unassignedOrderHint:e.UnassignedOrderHint})}fromGraphResource(e){return this.withPropertyBag({version:e["@odata.etag"],id:e.id,orderHintsByAssignee:e.orderHintsByAssignee||void 0,unassignedOrderHint:e.unassignedOrderHint})}newFromDifferentialUpdate(e){if(e.entityType!==m.I.Task&&e.entityType!==m.I.TaskboardAssignedToTaskFormatting)throw new Error("ArgumentException: invalid entity");const t=F.builder.withPropertyBag({id:e.id,version:e.itemVersion}).build(),r=e.getCreateDiffData(m.I.TaskboardAssignedToTaskFormatting),i=t.applyDiffs(r);return this.forClone(i)}forClone(e){return this.withPropertyBag({id:e.id,orderHintsByAssignee:k()(e.orderHintsByAssignee),unassignedOrderHint:e.unassignedOrderHint,version:e.itemVersion})}withPropertyBag(e){return this.id=e.id,this.version=e.version||this.version,this.orderHintsByAssignee=e.orderHintsByAssignee||this.orderHintsByAssignee,this.unassignedOrderHint=e.unassignedOrderHint||this.unassignedOrderHint,this}getDiffDataFromWebResource(e,t){const r={},i=new T.F;return i.addMapping("UnassignedOrderHint","unassignedOrderHint"),i.addMapping("OrderHintsByAssignee","orderHintsByAssignee"),b()(e.Changes,e=>{const s=e.FieldName;switch(s){case"OrderHintsByAssignee":const n=i.getMappedClientKey(s);if(1===e.PathSegments.length&&null==e.Value)r[n]=h.Wh.CollectionCleanupValue;else if(2===e.PathSegments.length){r[n]||(r[n]=t?.orderHintsByAssignee?k()(t.orderHintsByAssignee):{});const i=e.PathSegments[1];null==e.Value?delete r[n][i]:r[n][i]=e.Value}break;case"UnassignedOrderHint":const a=i.getMappedClientKey(s);r[a]=i.translateValue(s,a,e.Value)}}),r}getDiffDataFromGraphResource(e,t){const r=new T.F;return r.addMapping("unassignedOrderHint","unassignedOrderHint"),r.addMapping("orderHintsByAssignee","orderHintsByAssignee",e=>{if(null==e)return h.Wh.CollectionCleanupValue;const r=t?.orderHintsByAssignee?k()(t.orderHintsByAssignee):{};for(const t in e)null==e[t]?delete r[t]:r[t]=e[t];return r}),r.translate(e)}withDefaultValues(){return this.withPropertyBag({id:"TaskID",version:"1",unassignedOrderHint:"orderHint",orderHintsByAssignee:{}})}withId(e){return this.id=e,this}constructor(){this.id=w.o.generate(),this.version="",this.orderHintsByAssignee={},this.unassignedOrderHint=" !"}}var B=r(679);class F extends f.W{static get builder(){return new P}static mergeCustomizer(e,t,r){return"orderHintsByAssignee"===r?d()(t,h.Wh.CollectionCleanupValue)?{}:t:B.B.applyDiffMomentCustomizer(e,t,r)}get taskboardType(){return g.s.AssignedTo}get entityType(){return m.I.TaskboardAssignedToTaskFormatting}setProperty(e,t){if("orderHintsByAssignee"!==e&&"unassignedOrderHint"!==e)throw new Error("ReadOnlyException: "+e);const r=this.getClone();return r[e]=t,r}getClone(){return this.getCloneBuilder().build()}getCloneBuilder(){return F.builder.forClone(this)}toWebSerializable(){return{Id:this.id,TaskBoardType:this.taskboardType,ItemVersion:l()(this.itemVersion)?null:parseInt(this.itemVersion,10),OrderHintsByAssignee:s()(this.orderHintsByAssignee||{}),UnassignedOrderHint:this.unassignedOrderHint}}toGraphSerializable(){return{id:this.id,"@odata.etag":l()(this.itemVersion)?null:this.itemVersion,orderHintsByAssignee:s()(this.orderHintsByAssignee||{}),unassignedOrderHint:this.unassignedOrderHint}}getDiff(e){return B.B.getDiff(this,e,(e,t,r)=>"orderHintsByAssignee"===r?d()(e,t)?{}:d()(t,{})?h.Wh.CollectionCleanupValue:t:B.B.getDiffMomentCustomizer(e,t,r))}applyDiffs(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(!a()(t,e=>null!=e))throw new Error("ArgumentException: diffs - Diffs array contains null elements");return t.length>0?p()(F.builder.build(),this,...t,F.mergeCustomizer):this}applyDifferentialUpdate(e){if(e.id!==this.id)throw new Error("ArgumentException: update.id must match this.id");const t=e.getUpdateDiffData(this,this.entityType);return this.applyDiffs(t)}constructor(e){super(e.id,e.version),this.orderHintsByAssignee=e.orderHintsByAssignee,this.unassignedOrderHint=e.unassignedOrderHint}}},67868:(e,t,r)=>{"use strict";r.d(t,{u:()=>i});class i{toGraphSerializable(){return{requiredChecklistItemIds:this.requiredChecklistItemIds}}static fromResource(e){return new i(e.requiredChecklistItemIds)}setProperty(e,t){const r=new i([...this.requiredChecklistItemIds]);return r[e]=t,r}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.requiredChecklistItemIds=e}}},67875:(e,t,r)=>{"use strict";r.d(t,{o:()=>n});var i=r(39946),s=r(27805);class n{build(){return new i.l(this)}fromFormResource(e,t){return this.displayName=t.displayName,this.formResponse=t.formResponse,this.formId=e,this.urlFormId=i.l.parseFormIdFromUrl(t.formWebUrl)??"",this.collectResponsesUrl=t.formWebUrl,this}fromGraphFormResource(e,t){return this.displayName=t.displayName,this.formResponse=t.formResponse,this.formId=e,this.urlFormId=i.l.parseFormIdFromUrl(t.formWebUrl)??"",this.collectResponsesUrl=t.formWebUrl,this}fromOfficeForm(e,t){return this.displayName=e.title,this.formResponse=null,this.formId=t,this.urlFormId=e.id,this.collectResponsesUrl=i.l.getFormUrl(e.id,s.u.CollectResponses),this}withPropertyBag(e){return this.displayName=e.displayName||this.displayName||"",this.formResponse=e.formResponse||this.formResponse||null,this.formId=e.formId||this.formId||"",this.urlFormId=e.formWebUrl&&i.l.parseFormIdFromUrl(e.formWebUrl)||this.urlFormId||"",this.collectResponsesUrl=e.formWebUrl||this.collectResponsesUrl||"",this}}},68501:(e,t,r)=>{"use strict";r.d(t,{h:()=>d});var i=r(67868),s=r(38621),n=r(11569),a=r(56434),o=r.n(a),l=r(38752);class c{build(){return new d(this)}withPropertyBag(e){return this.checklistRequirement=e.checklistRequirement??this.checklistRequirement,this.formsRequirement=e.formsRequirement??this.formsRequirement,this.approvalRequirement=e.approvalRequirement??this.approvalRequirement,this}forClone(e){return this.withPropertyBag(o()(e))}getDiffDataFromWebResource(e){return{}}fromGraphResource(e){const t=l.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryChecklist,r=l.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryForms,a=l.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryApprovals;return this.withPropertyBag({checklistRequirement:e.checklistRequirement&&t?i.u.fromResource(e.checklistRequirement):null,formsRequirement:e.formsRequirement&&r?s.T.fromResource(e.formsRequirement):null,approvalRequirement:e.approvalRequirement&&a?n.L.fromResource(e.approvalRequirement):null})}getDiffDataFromGraphResource(e){return{}}withChecklistRequirement(e){return this.checklistRequirement=e,this}withFormsRequirement(e){return this.formsRequirement=e,this}withApprovalRequirement(e){return this.approvalRequirement=e,this}constructor(){this.checklistRequirement=null,this.formsRequirement=null,this.approvalRequirement=null}}class d{static get builder(){return new c}toGraphSerializable(){const e=l.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryForms,t=l.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryChecklist,r=l.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryApprovals,i={checklistRequirement:null};return t&&(i.checklistRequirement=this.checklistRequirement),e&&(i.formsRequirement=this.formsRequirement),r&&(i.approvalRequirement=this.approvalRequirement),i}setProperty(e,t){const r=this.getClone();return r[e]=t,r}getClone(){return d.builder.forClone(this).build()}constructor(e){this.checklistRequirement=e.checklistRequirement,this.formsRequirement=e.formsRequirement,this.approvalRequirement=e.approvalRequirement}}},69108:(e,t,r)=>{var i=r(88468),s=r(99140),n=Math.max;e.exports=function(e,t,r){var a=null==e?0:e.length;if(!a)return-1;var o=null==r?0:s(r);return o<0&&(o=n(a+o,0)),i(e,t,o)}},69491:(e,t,r)=>{"use strict";r.d(t,{_:()=>o});var i=r(36723),s=r(94778),n=r(77138),a=r(39946);class o{build(){return new s.R(this)}fromDriveItem(e,t){return this.url=e+t.itemPath.replace("/drive/root:","")+"/"+encodeURIComponent(t.name)+"?web=1",this.alias=t.name.substring(0,s.R.AliasMaxLength),this.taskAttachmentType=n.Z.builder.fromDriveItem(this.url,t).build(),this}fromForm(e,t){return this.url=a.l.getFormUrl(e.urlFormId,t,e),this.alias=e.displayName,this.taskAttachmentType=n.Z.builder.withPropertyBag({taskAttachmentType:i.Er.Form}).build(),this}withPropertyBag(e){return this.alias=e.alias||this.alias||"",this.taskAttachmentType=e.taskAttachmentType||this.taskAttachmentType||n.Z.builder.withPropertyBag({url:e.url}).build(),this.url=e.url||this.url||"",this.isShownInTaskCard=!!e.isShownInTaskCard,this}constructor(){this.isShownInTaskCard=!1}}},70252:(e,t,r)=>{"use strict";var i;r.d(t,{s:()=>i}),function(e){e[e.Progress=0]="Progress",e[e.AssignedTo=1]="AssignedTo",e[e.Bucket=2]="Bucket"}(i||(i={}))},72037:e=>{e.exports=function(e){return function(t){return null==e?void 0:e[t]}}},75117:e=>{e.exports=function(e,t){return e>t}},77138:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var i=r(36723),s=r(47451);class n{static get builder(){return new s.A}static getTaskAttachmentTypeFromString(e){return i.Er[e]?i.Er[e]:i.Er.Other}constructor(e){this.taskAttachmentType=e.taskAttachmentType,this.specificType=e.specificType,this.videoUrlParseResult=e.videoUrlParseResult}}},79742:(e,t,r)=>{var i=r(19841);e.exports=function(e,t,r){for(var s=-1,n=e.length;++s<n;){var a=e[s],o=t(a);if(null!=o&&(void 0===l?o===o&&!i(o):r(o,l)))var l=o,c=a}return c}},80708:(e,t,r)=>{"use strict";var i,s;r.d(t,{F:()=>B}),function(e){e[e.Automatic=0]="Automatic",e[e.NoPreview=1]="NoPreview",e[e.Checklist=2]="Checklist",e[e.Description=3]="Description",e[e.Reference=4]="Reference"}(i||(i={})),function(e){e[e.Shared=1]="Shared",e[e.Personal=2]="Personal",e[e.Template=3]="Template"}(s||(s={}));var n=r(34648),a=r(34717),o=r(32561),l=r(64696),c=r(17776),d=r(97139),u=r(39589);class p{build(){return new B(this)}fromWebResource(e){return this.withPropertyBag({task:a.Y.builder.fromWebResource(e.Task).build(),taskDetails:null==e.Details?void 0:o.U.builder.fromWebResource(e.Details).build(),taskFormatData:e&&(e.AssignedToTaskBoardFormat||e.BucketTaskBoardFormat||e.ProgressTaskBoardFormat)?u._.builder.withPropertyBag({assignedBoardFormat:e.AssignedToTaskBoardFormat?l.x.builder.fromWebResource(e.AssignedToTaskBoardFormat).build():void 0,bucketBoardFormat:e.BucketTaskBoardFormat?c.g.builder.fromWebResource(e.BucketTaskBoardFormat).build():void 0,progressBoardFormat:e.ProgressTaskBoardFormat?d.j.builder.fromWebResource(e.ProgressTaskBoardFormat).build():void 0}).build():void 0})}fromGraphResource(e){return this.withPropertyBag({task:a.Y.builder.fromGraphResource(e).build(),taskDetails:e?.details?o.U.builder.fromGraphResource(e.details).build():void 0,taskFormatData:e&&(e.assignedToTaskBoardFormat||e.bucketTaskBoardFormat||e.progressTaskBoardFormat)?u._.builder.withPropertyBag({assignedBoardFormat:e.assignedToTaskBoardFormat?l.x.builder.fromGraphResource(e.assignedToTaskBoardFormat).build():void 0,bucketBoardFormat:e.bucketTaskBoardFormat?c.g.builder.fromGraphResource(e.bucketTaskBoardFormat).build():void 0,progressBoardFormat:e.progressTaskBoardFormat?d.j.builder.fromGraphResource(e.progressTaskBoardFormat).build():void 0}).build():void 0})}withPropertyBag(e){return this.task=e.task,this.taskDetails=e.taskDetails||this.taskDetails,this.taskFormatData=e.taskFormatData||this.taskFormatData,this}withTask(e){return this.task=e,this}withDetails(e){return this.taskDetails=e,this}withFormatData(e){return this.taskFormatData=e,this}withId(e){if(!this.task)throw new Error("task must be specified before calling withId");if(this.task=a.Y.builder.forClone(this.task).withId(e).build(),this.taskDetails&&(this.taskDetails=o.U.builder.forClone(this.taskDetails).withId(e).build()),this.taskFormatData){const t=u._.builder;this.taskFormatData.bucketBoardFormat&&(t.bucketBoardFormat=c.g.builder.forClone(this.taskFormatData.bucketBoardFormat).withId(e).build()),this.taskFormatData.assignmentBoardFormat&&(t.assignedBoardFormat=l.x.builder.forClone(this.taskFormatData.assignmentBoardFormat).withId(e).build()),this.taskFormatData.progressBoardFormat&&(t.progressBoardFormat=d.j.builder.forClone(this.taskFormatData.progressBoardFormat).withId(e).build()),this.taskFormatData=t.build()}return this}forClone(e){return this.withPropertyBag({task:e.task,taskDetails:e.taskDetails,taskFormatData:e.taskFormatData})}}var h=r(51171),m=r(14740),g=r.n(m),f=r(98990),y=r.n(f),k=r(55491),v=r.n(k),b=r(28673),T=r.n(b),w=r(91246),P=r(25290);class B{static get builder(){return new p}static toAugmentationLoopTaskModel(e,t,r,s,a){let o;switch(e.task.previewType){case n.X.CheckList:o=i.Checklist;break;case n.X.Description:o=i.Description;break;case n.X.NoPreview:o=i.NoPreview;break;case n.X.Reference:o=i.Reference;break;case n.X.Automatic:default:o=i.Automatic}const l=y()(s,{id:e.task.createdBy})?.userPrincipalName??"",c=y()(s,{id:e.task.userContentLastModifiedBy})?.userPrincipalName??"",d=e.task.completedBy?y()(s,{id:e.task.completedBy})?.userPrincipalName:void 0,u=e.task.deletedBy?y()(s,{id:e.task.deletedBy})?.userPrincipalName:void 0,p=g()(T()(e.task.assignments).map(e=>y()(s,{id:e})?.userPrincipalName));return{id:e.id,appliedCategories:r,bucketTitle:a,completedBy:d,completedDate:e.task.completedDate?.toISOString()??void 0,createdBy:l,createdDate:e.task.createdDate.toISOString(),deletedBy:u,dueDate:e.task.dueDate?.toISOString()??void 0,hasDescription:e.task.hasDescription,numberOfActiveChecklistItems:e.task.numberOfActiveChecklistItems,numberOfChecklistItems:e.task.numberOfChecklistItems,numberOfReferences:e.task.numberOfReferences,orderHint:e.task.orderHint,percentComplete:e.task.percentComplete,planTitle:t,previewType:o,priority:e.task.priority,startDate:e.task.startDate?.toISOString()??void 0,title:e.task.title,userContentLastModifiedBy:c,userContentLastModifiedDate:e.task.userContentLastModifiedDate?.toISOString()??void 0,kind:1,assigneeIds:p,plannerTaskDetails:{id:e.id,description:e.taskDetails?.description??"",previewType:o},logicalId:(0,P.DA)()}}static hasContentBeenModified(e,t){let r=!1;if(e.id===t.id||w.o.isPlexTempId(e.id)&&!w.o.isPlexTempId(t.id)){const i=T()(t.task.getDiff(e.task)),s=["title","bucketId","percentComplete","startDate","dueDate","conversationThreadId","appliedCategories"];if(r=i.some(e=>s.indexOf(e)>=0),r||T()(t.task.assignments).forEach(t=>{if(null==e.task.assignments[t])return r=!0,!1}),!r&&null!=e.taskDetails&&null!=t.taskDetails){let i=!1;const s=e.taskDetails.references;v()(t.taskDetails.references,e=>{if(null==s[e.url]||e.alias!==s[e.url].alias)return i=!0,!1});let n=!1;const a=e.taskDetails.checklist;i||v()(t.taskDetails.checklist,e=>{if(null==a[e.id]||e.title!==a[e.id].title||e.isChecked!==a[e.id].isChecked)return n=!0,!1}),r=t.taskDetails.description!==e.taskDetails.description||t.taskDetails.notes?.content!==e.taskDetails.notes?.content||i||n}return r}throw new Error("Task ids doesn't match")}get id(){return this.task.id}toWebSerializable(){return{Task:this.task.toWebSerializable(),Details:this.taskDetails?.toWebSerializable(),AssignedToTaskBoardFormat:this.taskFormatData?.assignmentBoardFormat?.toWebSerializable(),BucketTaskBoardFormat:this.taskFormatData?.bucketBoardFormat?.toWebSerializable(),ProgressTaskBoardFormat:this.taskFormatData?.progressBoardFormat?.toWebSerializable()}}getClone(){return this.getCloneBuilder().build()}getCloneForMove(e,t){return B.builder.withTask(this.task.getCloneForMove(e)).withFormatData(t).build()}getCloneBuilder(){return B.builder.forClone(this)}constructor(e){if(null==e.task)throw new h.L("builder.task");if(e.taskDetails&&e.task&&e.taskDetails.id!==e.task.id)throw new Error("ArgumentException: Mismatch between task.id and taskDetails.id");if(e.taskFormatData?.assignmentBoardFormat&&e.taskFormatData.assignmentBoardFormat.id!==e.task.id)throw new Error("ArgumentException: Mismatch between task.id and taskFormatData.assignmentBoardFormat.id");if(e.taskFormatData?.bucketBoardFormat&&e.taskFormatData.bucketBoardFormat.id!==e.task.id)throw new Error("ArgumentException: Mismatch between task.id and taskFormatData.bucketBoardFormat.id");if(e.taskFormatData?.progressBoardFormat&&e.taskFormatData.progressBoardFormat.id!==e.task.id)throw new Error("ArgumentException: Mismatch between task.id and taskFormatData.progressBoardFormat.id");this.task=e.task,this.taskDetails=e.taskDetails,this.taskFormatData=e.taskFormatData}}},83518:e=>{var t=Math.floor,r=Math.random;e.exports=function(e,i){return e+t(r()*(i-e+1))}},85855:(e,t,r)=>{e.exports=r(96483)},94710:e=>{e.exports=function(e,t,r,i){for(var s=-1,n=null==e?0:e.length;++s<n;){var a=e[s];t(i,a,r(a),e)}return i}},94778:(e,t,r)=>{"use strict";r.d(t,{R:()=>h});var i=r(20719),s=r(36723),n=r(69491),a=r(28730),o=r(36475),l=r.n(o),c=r(55491),d=r.n(c),u=r(69108),p=r.n(u);class h{static get builder(){return new n._}static aliasCompare(e,t){return a.l.compareStringForDisplay(e?.alias?.toUpperCase(),t?.alias?.toUpperCase())}isExternalLinkAttachment(e){if(this.taskAttachmentType.taskAttachmentType!==s.Er.Other)return!1;const t=decodeURIComponent(this.url);let r=decodeURIComponent(e);l()(r,"/")||(r+="/");const i=new RegExp(r,"ig");return t.search(i)<0}getFileExtension(){if(this.taskAttachmentType.specificType)return this.taskAttachmentType.specificType;let e=null;if(this.taskAttachmentType.taskAttachmentType!==s.Er.Other)switch(this.taskAttachmentType.taskAttachmentType){case s.Er.Excel:e=this.getExtensionFromUrl(this.url,s.Er.Excel);break;case s.Er.OneNote:e=this.getExtensionFromUrl(this.url,s.Er.OneNote);break;case s.Er.Pdf:e=this.getExtensionFromUrl(this.url,s.Er.Pdf);break;case s.Er.PowerPoint:e=this.getExtensionFromUrl(this.url,s.Er.PowerPoint);break;case s.Er.Project:e=this.getExtensionFromUrl(this.url,s.Er.Project);break;case s.Er.Visio:e=this.getExtensionFromUrl(this.url,s.Er.Visio);break;case s.Er.Word:e=this.getExtensionFromUrl(this.url,s.Er.Word)}if(null==e){const t=this.alias.split(".");if(t.length>1){const r=t[t.length-1];3!==r.length&&4!==r.length||(e=r)}}return e}hasKnownExtension(){return this.taskAttachmentType.taskAttachmentType!==s.Er.Other||!!this.taskAttachmentType.specificType&&p()(s.ig,this.taskAttachmentType.specificType.toLowerCase())>=0}isAttachmentPreviewable(){return this.taskAttachmentType.taskAttachmentType!==s.Er.Other?p()(s.Tj,this.taskAttachmentType.taskAttachmentType)<0:!!this.taskAttachmentType.specificType&&p()(s.ig,this.taskAttachmentType.specificType.toLowerCase())>=0}isGifAttachment(){return this.taskAttachmentType.taskAttachmentType===s.Er.Other&&"gif"===this.taskAttachmentType.specificType}getExtensionFromUrl(e,t){let r=null;return d()(i.t[t],t=>{if(e.indexOf("."+t)>-1)return r=t.toLowerCase(),!1}),r}constructor(e){this.alias=e.alias,this.taskAttachmentType=e.taskAttachmentType,this.url=e.url,this.isShownInTaskCard=e.isShownInTaskCard}}h.AliasMaxLength=100,h.UrlMaxLength=2e3},95694:(e,t,r)=>{var i=r(72037)({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});e.exports=i},96483:e=>{e.exports=function(e){return e&&e.length?e[0]:void 0}},97139:(e,t,r)=>{"use strict";r.d(t,{j:()=>k});var i=r(17002),s=r.n(i),n=r(54320),a=r.n(n),o=r(36777),l=r.n(o),c=r(72761),d=r(70252),u=r(88908),p=r(55491),h=r.n(p),m=r(42410),g=r(91246);class f{build(){return new k(this)}fromWebResource(e){return this.withPropertyBag({id:e.Id,orderHint:e.OrderHint,version:null!=e.ItemVersion?e.ItemVersion.toString():void 0})}fromGraphResource(e){return this.withPropertyBag({version:e["@odata.etag"],id:e.id,orderHint:e.orderHint})}newFromDifferentialUpdate(e){if(e.entityType!==c.I.Task&&e.entityType!==c.I.TaskboardStatusTaskFormatting)throw new Error("ArgumentException: invalid entity");const t=k.builder.withPropertyBag({id:e.id,version:e.itemVersion}).build(),r=e.getCreateDiffData(c.I.TaskboardStatusTaskFormatting),i=t.applyDiffs(r);return this.forClone(i)}forClone(e){return this.withPropertyBag({id:e.id,orderHint:e.orderHint,version:e.itemVersion})}withPropertyBag(e){return this.id=e.id,this.orderHint=e.orderHint||this.orderHint,this.version=e.version||this.version,this}withDefaultValues(){return this.withPropertyBag({id:"TaskID",orderHint:"orderhint1",version:"1"})}getDiffDataFromWebResource(e,t){const r={};return h()(e.Changes,t=>{switch(t.FieldName){case"OrderHint":e.ItemType===c.I.TaskboardStatusTaskFormatting&&(r.orderHint=t.Value);break;case"TaskBoardStatusOrderHint":r.orderHint=t.Value}}),r}getDiffDataFromGraphResource(e,t){if(null==e)throw new Error("ArgumentNullException: update");const r=new m.F;return r.addMapping("orderHint","orderHint"),r.translate(e)}withId(e){return this.id=e,this}constructor(){this.id=g.o.generate(),this.orderHint=" !",this.version=""}}var y=r(679);class k extends u.W{static get builder(){return new f}get taskboardType(){return d.s.Progress}get entityType(){return c.I.TaskboardStatusTaskFormatting}setProperty(e,t){if("orderHint"!==e)throw new Error("ReadOnlyException: "+e);const r=this.getClone();return r[e]=t,r}toWebSerializable(){return{Id:this.id,OrderHint:this.orderHint,TaskBoardType:this.taskboardType,ItemVersion:a()(this.itemVersion)?null:parseInt(this.itemVersion,10)}}toGraphSerializable(){return{"@odata.etag":a()(this.itemVersion)?void 0:this.itemVersion,id:this.id,orderHint:this.orderHint}}getDiff(e){return y.B.getDiff(this,e,y.B.getDiffMomentCustomizer)}applyDiffs(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(!s()(t,e=>null!=e))throw new Error("ArgumentException: diffs - Diffs array contains null elements");return t.length>0?l()(k.builder.build(),this,...t,y.B.applyDiffMomentCustomizer):this}applyDifferentialUpdate(e){if(e.id!==this.id)throw new Error("ArgumentException: update.id must match this.id");const t=e.getUpdateDiffData(this,this.entityType);return this.applyDiffs(t)}getClone(){return this.getCloneBuilder().build()}getCloneBuilder(){return k.builder.forClone(this)}constructor(e){super(e.id,e.version),this.orderHint=e.orderHint}}}}]);
//# sourceMappingURL=80708.6e02f030.chunk.js.map