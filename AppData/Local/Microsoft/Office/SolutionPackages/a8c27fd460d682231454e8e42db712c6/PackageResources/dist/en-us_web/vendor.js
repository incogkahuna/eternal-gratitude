/*! For license information please see vendor.js.LICENSE.txt */
(self.webpackChunkTypeScriptModule=self.webpackChunkTypeScriptModule||[]).push([[121],{81958:(e,t,n)=>{"use strict";n.r(t),n.d(t,{DictationEventsType:()=>i.Ff,SpeechToTextProfile:()=>r.A,VoiceSession:()=>v});var o=n(97953),s=n(52865),r=n(90913),i=n(21965),a=n(72514),l=n(3316),c=n(54585),u=n(82058),d=n(88943),h=n(48316);class p{constructor(){this.count=0,this.total={service:0,perceived:0},this.min={service:Number.MAX_VALUE,perceived:Number.MAX_VALUE},this.max={service:0,perceived:0}}add(e){this.count++,this.total.perceived+=e.perceived,this.total.service+=e.service,this.min.perceived=Math.min(e.perceived,this.min.perceived),this.min.service=Math.min(e.service,this.min.service),this.max.perceived=Math.max(e.perceived,this.max.perceived),this.max.service=Math.max(e.service,this.max.service)}getAverages(){return 0===this.count?{perceived:-1,service:-1}:{perceived:this.total.perceived/this.count,service:this.total.service/this.count}}}class f{constructor(e,t,n,o){this.finals=new p,this.partials=new p,this.getNow=Date.now,this.list=[],this.maxListLength=e,this.warnListLength=.8*e,this.getNow=t??Date.now,this.onInfo=n,this.onWarning=o}get length(){return this.list.length}getChunk(e){return this.list[e]}track(e,t,n){const o={audioStart:e-t,audioEnd:e,localEnd:this.getNow(),seq:n};let s=this.list.length-1;if(-1===s||o.audioStart>=this.list[s].audioEnd)this.list.push(o);else if(o.audioEnd<=this.list[0].audioStart)this.list.unshift(o);else{for(;s>0&&o.audioEnd<this.list[s].audioStart;)s--;if(s>=0&&o.audioStart===this.list[s].audioStart)throw new Error(`Why are we double tracking the same chunk of audio? newChunk: ${JSON.stringify(o)}, existing chunk: ${JSON.stringify(this.list[s])}`);this.list.splice(s,0,o)}if(this.list.length>this.maxListLength){const e=this.list.length-this.maxListLength;this.list.splice(0,e),this.onWarning?this.onWarning(`AudioStreamPerfTracker.track: list length has exceeded max by ${e} items!`,523568153):c.Hv.sendTraceTag(523568153,u.n.msoulscat_Wac_Dictation,d.k.Warning,`AudioStreamPerfTracker.track: list length has exceeded max by ${e} items!`)}else this.list.length>=this.warnListLength&&(this.onWarning?this.onWarning(`AudioStreamPerfTracker.track: list length: ${this.list.length} approaching max: ${this.maxListLength}`,523568154):c.Hv.sendTraceTag(523568154,u.n.msoulscat_Wac_Dictation,d.k.Warning,`AudioStreamPerfTracker.track: list length: ${this.list.length} approaching max: ${this.maxListLength}`))}trimBefore(e){if(0===this.list.length)return void(this.onInfo?this.onInfo("AudioStreamPerfTracker.trimBefore: list is empty - nothing to trim!",523568155):c.Hv.sendTraceTag(523568155,u.n.msoulscat_Wac_Dictation,d.k.Info,"AudioStreamPerfTracker.trimBefore: list is empty - nothing to trim!"));const t=`${this.list[0].audioStart} to ${this.list[this.list.length-1].audioEnd}`;let n=0;for(;n<this.list.length&&this.list[n].audioEnd<e;)n++;n===this.list.length&&(this.onWarning?this.onWarning(`AudioStreamPerfTracker.trimBefore: no match found for audioEnd: ${e}. List length: ${this.list.length}, audio span: ${t}`,523568156):c.Hv.sendTraceTag(523568156,u.n.msoulscat_Wac_Dictation,d.k.Warning,`AudioStreamPerfTracker.trimBefore: no match found for audioEnd: ${e}. List length: ${this.list.length}, audio span: ${t}`));const o=this.list.splice(0,n),s=o.length>0?`${o[0].audioStart} to ${o[o.length-1].audioEnd}`:"none",r=this.list.length>0?`${this.list[0].audioStart} to ${this.list[this.list.length-1].audioEnd}`:"none";this.onInfo?this.onInfo(`AudioStreamPerfTracker.trimBefore: audioEnd: ${e}, culling ${o.length} chunks (audio span ${s}), new list.length: ${this.list.length}. Audio span was: ${t}, now: ${r}`,523568157):c.Hv.sendTraceTag(523568157,u.n.msoulscat_Wac_Dictation,d.k.Info,`AudioStreamPerfTracker.trimBefore: audioEnd: ${e}, culling ${o.length} chunks (audio span ${s}), new list.length: ${this.list.length}. Audio span was: ${t}, now: ${r}`)}getChunksFrom(e,t){const n=e+t;let o,s,r=0;for(;r<this.list.length&&(!o||!s);){const t=this.list[r];!o&&e>=t.audioStart&&e<=t.audioEnd&&(o=t),!s&&n>=t.audioStart&&n<=t.audioEnd&&(s=t),r++}return[o,s]}measureLatency(e,t,n){const o=this.getNow(),s=e+t,[r,i]=this.getChunksFrom(e,t);if(!r&&!i)return this.onWarning?this.onWarning(`AudioStreamPerfTracker.getRelatedAudioChunks: Zero audio chunks not found for speechEnd: ${s} (${e} + ${t})`,523568158):c.Hv.sendTraceTag(523568158,u.n.msoulscat_Wac_Dictation,d.k.Warning,`AudioStreamPerfTracker.getRelatedAudioChunks: Zero audio chunks not found for speechEnd: ${s} (${e} + ${t})`),{service:-1,perceived:-1};if(!r||!i){const n=r?"end":"start";let o="none",i=NaN;this.list.length>0&&(o=`${this.list[0].audioStart} to ${this.list[this.list.length-1].audioEnd}`,i=r?s-this.list[this.list.length-1].audioEnd:s-this.list[0].audioStart),this.onWarning?this.onWarning(`AudioStreamPerfTracker.getRelatedAudioChunks: Expected audio chunk not found for ${n} of audio, for speechEnd: ${s} (${e} + ${t}), tracked audio span: ${o}, delta: ${i}`,523568159):c.Hv.sendTraceTag(523568159,u.n.msoulscat_Wac_Dictation,d.k.Warning,`AudioStreamPerfTracker.getRelatedAudioChunks: Expected audio chunk not found for ${n} of audio, for speechEnd: ${s} (${e} + ${t}), tracked audio span: ${o}, delta: ${i}`)}const a=o-Math.max(r?.localEnd||0,i?.localEnd||0),l=r?this.getLatencyForChunk(r,e,t,o):-1,h=i?this.getLatencyForChunk(i,s,0,o):-1,p={service:a,perceived:Math.max(l,h)};return(n?this.finals:this.partials).add(p),p}getLatencyForChunk(e,t,n,o){return o-(e.localEnd-(e.audioEnd-t))-n}}var g=n(63564),m=n(62510),y=n(54998);class v{constructor(e,t,n=!1,o,s,i=r.A.Dictation,l,c,u,d){this.audioContext=null,this.microphoneSessionState=null,this.responseVersion=a.wM.version2,this.fileBytes=null,this._wavFileAudioChunkSize=16e3,this.endVoiceSessionCalled=!1,this.totalAudioInputDurationMs=0,this.resolveSendVoiceTilesUsingVoicePacketsPromise=null,this.runtimeManager=e,this.fdSpeechClientObserver=t,this.useFrontdoorWorkflow=n,o&&(this.commandTelemetry=o),s&&(this.sessionTelemetry=s,s.audioPerfTracker=this.audioPerfTracker),this.speechToTextProfile=i,l?this.alSession=l:(0,m.isChangeGateEnabled)("OfficeVSO:8765828_UseALSession")&&e.getSession().then((e=>{this.alSession=e})).catch((e=>{d&&d(e)})),this.onInfo=c,this.onWarning=u,this.onError=d,this.audioPerfTracker=new f(1e3,void 0,c,u)}async startVoiceSessionFromMicrophoneInput(e,t,n){this.endVoiceSessionCalled=!1,this.totalAudioInputDurationMs=0,await this.startAudioCaptureAsync((t=>{if(this.endVoiceSessionCalled)return;e&&e(t.inputBuffer);const r=this.audioContext?this.audioContext.sampleRate:t.inputBuffer.sampleRate,i=(0,s.eG)(t.inputBuffer.getChannelData(0),r);let a;a=this.alSession?g.vh(this.alSession,i,s.b2,this.useFrontdoorWorkflow,l.A.dictationSettings,this.responseVersion,this.speechToTextProfile,this.sessionTelemetry,n?.getCommandSet()):o.vh(this.runtimeManager,i,s.b2,this.useFrontdoorWorkflow,l.A.dictationSettings,this.responseVersion,this.speechToTextProfile,this.sessionTelemetry,n?.getCommandSet());const c=1e3*t.inputBuffer.duration;this.totalAudioInputDurationMs+=c,this.audioPerfTracker.track(this.totalAudioInputDurationMs,c,a.seq),this.fdSpeechClientObserver.onAudioData&&this.fdSpeechClientObserver.onAudioData(new Int16Array(i.buffer))}),t).catch((e=>Promise.reject(e)))}sendVoiceTilesUsingVoicePackets(e,t){return new Promise((async(n,r)=>{try{null!=this.resolveSendVoiceTilesUsingVoicePacketsPromise&&r(new Error("Please finish sending an audio file (i.e. call endVoiceSession) before sending another one.")),this.resolveSendVoiceTilesUsingVoicePacketsPromise=n;const i=this._wavFileAudioChunkSize;let a=0,c=i,u=!1;for(;a<e.byteLength&&!this.endVoiceSessionCalled;){const n=e.slice(a,c),r=new DataView(n);this.alSession?g.vh(this.alSession,r,s.b2,this.useFrontdoorWorkflow,l.A.dictationSettings,this.responseVersion,this.speechToTextProfile,this.sessionTelemetry):o.vh(this.runtimeManager,r,s.b2,this.useFrontdoorWorkflow,l.A.dictationSettings,this.responseVersion,this.speechToTextProfile,this.sessionTelemetry);const d=t&&t.audioFileStreamDelay||300;if(await this.wait(+d),u)break;a=c,c+=i,c>e.byteLength&&(c=e.byteLength,u=!0)}null!=this.resolveSendVoiceTilesUsingVoicePacketsPromise&&(this.resolveSendVoiceTilesUsingVoicePacketsPromise(),this.resolveSendVoiceTilesUsingVoicePacketsPromise=null)}catch(e){r(e)}}))}resendFileFromTimeOffset(e,t){if(!this.fileBytes)throw new Error("Can't resend a file if startVoiceSessionFromAudioFile (or equivalent) has not been called.");if(!this.endVoiceSessionCalled||null!=this.resolveSendVoiceTilesUsingVoicePacketsPromise)throw new Error("Can't resend a file when we are currently sending one. End the voice session first.");const n=e/1e3*s.b2*(s.FA/8),o=t?t/1e3*s.b2*(s.FA/8):void 0;return this.fileBytes=this.fileBytes.slice(n,o),this.endVoiceSessionCalled=!1,this.sendVoiceTilesUsingVoicePackets(this.fileBytes)}async startVoiceSessionFromAudioFileFromServer(e,t){return this.fdSpeechClientObserver.onSpeechRecognitionStarted(),this.fileBytes=e,this.sendVoiceTilesUsingVoicePackets(this.fileBytes,t)}readAndSendFile(e,t=!1,n){const o=new FileReader,r=new Promise(((e,r)=>{o.onload=async()=>{try{if(this.fileBytes=o.result,t){const e=Date.now(),t=new OfflineAudioContext(1,1,s.b2);if(null==t.decodeAudioData)throw new Error("Browser does not support decodeAudioData");const o=await function(e,t){return new Promise(((n,o)=>{t.decodeAudioData(e,n,o)}))}(this.fileBytes,t);this.fileBytes=(0,s.eG)(o.getChannelData(0),s.b2).buffer;const r=o.duration;n&&n(Date.now()-e,r)}await this.sendVoiceTilesUsingVoicePackets(this.fileBytes),e()}catch(e){r(e)}},o.onabort=()=>{r(new Error("Aborted fileReader"))},o.onerror=()=>{r(o.error)}}));return o.readAsArrayBuffer(e),r}async startVoiceSessionFromAudioFile(e,t=!1,n){return this.fdSpeechClientObserver.onSpeechRecognitionStarted(),this.readAndSendFile(e,t,n)}async stopVoiceSession(){await this.stopMicrophoneInputAsync(),this.endVoiceSession()}endVoiceSession(){this.alSession?g.Yf(this.alSession,this.useFrontdoorWorkflow,l.A.dictationSettings,this.sessionTelemetry,this.onInfo):o.Yf(this.runtimeManager,this.useFrontdoorWorkflow,l.A.dictationSettings,this.sessionTelemetry),this.endVoiceSessionCalled=!0,null!=this.resolveSendVoiceTilesUsingVoicePacketsPromise&&(this.resolveSendVoiceTilesUsingVoicePacketsPromise(),this.resolveSendVoiceTilesUsingVoicePacketsPromise=null)}async stopMicrophoneInputAsync(){if(this.microphoneSessionState&&(this.microphoneSessionState.mediaStream.getAudioTracks().map((e=>{e.stop()})),this.microphoneSessionState=null),this.audioContext&&"closed"!==this.audioContext.state)try{await this.audioContext.close()}catch(e){if(this.onWarning?this.onWarning(`Error closing audioContext: ${e}`,528871704):c.Hv.sendTraceTag(528871704,u.n.msoulscat_Wac_Dictation,d.k.Warning,`Error closing audioContext: ${e}`),"InvalidStateError"!==e.name)throw e}}async startAudioCaptureAsync(e,t){const n=Date.now();let o=!1;try{const{context:n,sessionState:s}=await this.createAudioContextAndMicrophoneSessionState(t);o=!0,this.sessionTelemetry?.setRecordingStartTime(Date.now()),this.commandTelemetry?.setRecordingStartTime(Date.now()),this.microphoneSessionState=s,this.audioContext=n,this.endVoiceSessionCalled?this.onWarning?this.onWarning("Audio Capture is cancelled due to VoiceSession closed",573391628):c.Hv.sendTraceTag(573391628,u.n.msoulscat_Wac_Dictation,d.k.Warning,"Audio Capture is cancelled due to VoiceSession closed"):(s.processor.onaudioprocess=e,s.source.connect(s.processor),s.processor.connect(n.destination),window.self.document.hasFocus()||await this.waitForWindowFocus(20),this.fdSpeechClientObserver.onSpeechRecognitionStarted())}catch(e){const t=this.parseMicrophoneErrorMessage(e);return this.fdSpeechClientObserver.onError(t),t===h.J.ErrorAudioCaptureAsync?Promise.reject(e):Promise.reject(t)}finally{const e=Date.now()-n;this.onInfo?this.onInfo(`Mic enablement - success: ${o}, duration: ${e}, endVoiceSessionCalled: ${this.endVoiceSessionCalled}`,589886626):c.Hv.sendTraceTag(589886626,u.n.msoulscat_Wac_Dictation,d.k.Info,`Mic enablement - success: ${o}, duration: ${e}, endVoiceSessionCalled: ${this.endVoiceSessionCalled}`),this.endVoiceSessionCalled&&(0,m.isChangeGateEnabled)("OfficeVSO:8355217_HandleVoiceSessionMicrophoneInputRaceCondition")&&await this.stopMicrophoneInputAsync()}}waitForWindowFocus(e=20){const t=Date.now();let n=e;return new Promise(((e,o)=>{const s=()=>{if(n-=1,window.self.document.hasFocus()||n<0){const o=Date.now()-t;this.onInfo?this.onInfo(`waitForWindowFocus duration: ${o}, count: ${n}, window has focus: ${window.self.document.hasFocus()}`,553747910):c.Hv.sendTraceTag(553747910,u.n.msoulscat_Wac_Dictation,d.k.Info,`waitForWindowFocus duration: ${o}, count: ${n}, window has focus: ${window.self.document.hasFocus()}`),e()}else setTimeout(s,50)};s()}))}parseMicrophoneErrorMessage(e){const t=(0,y.rq)(e,this.onError);return t.startsWith("NotAllowedError")||t.endsWith("PermissionDeniedError")||t.startsWith("PermissionDeniedError")?h.J.ErrorAudioPermissionDeniedError:t.endsWith("NotFoundError")||t.startsWith("NotFoundError")||t.startsWith("DevicesNotFoundError")?h.J.ErrorAudioDevicesNotFoundError:t.endsWith("MediaDeviceNotSupported")||t.startsWith("NotSupportedError")||t.startsWith("NotReadableError")||t.startsWith("TrackStartError")?h.J.ErrorAudioNotReadableError:(this.onError?this.onError(`Unexpected microphone error: ${t} (${e?.name}-${e?.message})`,538481308):c.Hv.sendTraceTag(538481308,u.n.msoulscat_Wac_Dictation,d.k.Error,`Unexpected microphone error: ${t} (${e?.name}-${e?.message})`),h.J.ErrorAudioCaptureAsync)}wait(e){return new Promise((t=>{setTimeout((()=>{t()}),e)}))}async createAudioContextAndMicrophoneSessionState(e){let t=0;try{t=window.setTimeout((()=>{t=0,this.fdSpeechClientObserver.showPermissionPrompt&&this.fdSpeechClientObserver.showPermissionPrompt()}),2e3);const n=!e||{deviceId:e},o=await navigator.mediaDevices.getUserMedia({audio:n}),s=window.AudioContext||window.webkitAudioContext;if(null===s)return Promise.reject("Browser doesn't support AudioContext");const r=new s;return{context:r,sessionState:{mediaStream:o,source:r.createMediaStreamSource(o),processor:r.createScriptProcessor(16384,1,1)}}}finally{t>0&&window.clearTimeout(t)}}}},2217:(e,t,n)=>{"use strict";n.r(t),n.d(t,{SpeechToTextClient:()=>v,SpeechToTextResultType:()=>o,sendSpeechToTextFinalResultToSpeechClientObserver:()=>b});var o,s=n(97953),r=n(90913),i=n(3316),a=n(76483),l=n(72514),c=n(57144),u=n(21965),d=n(54585),h=n(82058),p=n(88943),f=n(98787),g=n(63564),m=n(54998),y=n(62510);!function(e){e[e.FinalResult=0]="FinalResult",e[e.PartialResult=1]="PartialResult"}(o||(o={}));class v{constructor(e,t,n=!0,o=!0,s,a=r.A.Dictation,l,c,u,d,h){this.initialized=!1,this.speechSessionEventToken=null,this.speechToTextPartialResultToken=null,this.speechToTextFinalResultToken=null,this.speechErrorEventToken=null,this.speechQualityEventToken=null,this.useDebugDictation=!1,this.runtimeManager=e,this.fdSpeechClientObserver=t,this.useFrontdoorWorkflow=n,this.startRecognitionInSpeechToTextClient=o,this.enableSetAnnotationsFromALVoiceClient=!!s,this.speechToTextProfile=a,l?this.alSession=l:(0,y.isChangeGateEnabled)("OfficeVSO:8765828_UseALSession")&&e.getSession().then((e=>{this.alSession=e})).catch((e=>{d&&d(e)})),this.onInfo=c,this.onWarning=u,this.onError=d,v.onTelemetryEvent=h,this.annotationObserver={onAnnotationResult:e=>{this.onAnnotationResult(e)}};const p=new URLSearchParams(window.location.search?.toLowerCase()),f=i.A.dictationSettings.properties??{};this.useDebugDictation="true"===p.get("wddictationdebugmode"),this.useDebugDictation&&(f.EnableAudioLogging="true");const g=p.get("wdspeechdomain");g&&(f.wdSpeechDomain=decodeURIComponent(g)),i.A.dictationSettings={properties:f}}static logPhraseId(e,t,n){const o=n.properties.JsonResult?.Id;if(o&&t&&n)if(v.onTelemetryEvent)v.onTelemetryEvent(e,n);else{const s={name:"Office.Voice.Online.PhraseReceived",dataFields:[{name:"PhraseID",string:o},{name:"ConnectionID",string:t.connectionID},{name:"SessionID",string:t.sessionID},{name:"MessageType",string:e},{name:"voiceLatency",int64:n.properties.audioLatency}]};if(n.properties.commandLatency&&s.dataFields.push({name:"commandLatency",int64:n.properties.commandLatency}),t.audioPerfTracker&&n.properties.JsonResult&&n.properties.JsonResult.Offset&&n.properties.JsonResult.Duration){const o=n.properties.JsonResult.Offset/1e4,r=n.properties.JsonResult.Duration/1e4,i="final"===e,a=t.audioPerfTracker.measureLatency(o,r,i);s.dataFields.push({name:"perceivedLatency",int64:a.perceived}),s.dataFields.push({name:"serviceLatency",int64:a.service})}(0,f.Ot)(s)}}async initializeAsync(e,t){const n=this.checkAnnotationActive();this.onInfo?this.onInfo(`SpeechToTextClient.initializeAsync - initialized: ${this.initialized}, annotationsActive: ${n}`,521417154):d.Hv.sendTraceTag(521417154,h.n.msoulscat_Wac_Dictation,p.k.Info,`SpeechToTextClient.initializeAsync - initialized: ${this.initialized}, annotationsActive: ${n}`),n&&(this.onWarning?this.onWarning("Releasing old annotations",521417153):d.Hv.sendTraceTag(521417153,h.n.msoulscat_Wac_Dictation,p.k.Warning,"Releasing old annotations"),await this.uninitializeAsync()),t&&(this.sessionTelemetry=t);try{await this.activateAnnotations(e),this.warmUpAugloop(),this.initialized=!0}catch(e){const t="SpeechToTextClient.initializeAsync - Activate Annotations - "+e.message,n={errorType:m.yA.ErrorAugloopActivateAnnotations,errorMsg:t+" - Error stack: "+e.stack};if(!e.message)try{const t={};Object.getOwnPropertyNames(e).forEach((n=>t[n]=e[n])),this.onError?this.onError("Odd error: "+JSON.stringify(t),509745299):d.Hv.sendTraceTag(509745299,h.n.msoulscat_Wac_Dictation,p.k.Error,"Odd error: "+JSON.stringify(t))}catch(e){this.onError?this.onError("Failed to diagnose odd error: "+(0,m.rq)(e,this.onError),509745298):d.Hv.sendTraceTag(509745298,h.n.msoulscat_Wac_Dictation,p.k.Error,"Failed to diagnose odd error: "+(0,m.rq)(e,this.onError))}t.includes("Timeout waiting for response")?this.fdSpeechClientObserver.onWarning(n):this.fdSpeechClientObserver.onError(n)}}async uninitializeAsync(){const e=this.checkAnnotationActive();this.onInfo?this.onInfo(`SpeechToTextClient.uninitializeAsync - initialized: ${this.initialized}, annotationsActive: ${e}`,521417152):d.Hv.sendTraceTag(521417152,h.n.msoulscat_Wac_Dictation,p.k.Info,`SpeechToTextClient.uninitializeAsync - initialized: ${this.initialized}, annotationsActive: ${e}`),this.initialized=!1;const t=["speechSessionEventToken","speechToTextPartialResultToken","speechToTextFinalResultToken","speechQualityEventToken","speechErrorEventToken"],n=t.map((e=>this[e])).filter((e=>!!e));try{this.alSession?await g.yw(this.alSession,n,this.onInfo,this.onError):await s.yw(this.runtimeManager,n)}catch(e){const t="SpeechToTextClient.uninitializeAsync - Release Annotations - "+e.message;this.sessionTelemetry?.onAugloopError(t),this.onError?this.onError("SpeechToTextClient.uninitializeAsync - Release Annotations - Error message: "+t+" - Error stack: "+e.stack,521417123):d.Hv.sendTraceTag(521417123,h.n.msoulscat_Wac_Dictation,p.k.Error,"SpeechToTextClient.uninitializeAsync - Release Annotations - Error message: "+t+" - Error stack: "+e.stack)}t.forEach((e=>this[e]=null))}checkAnnotationActive(){return null!==this.speechSessionEventToken||null!==this.speechToTextPartialResultToken||null!==this.speechToTextFinalResultToken||null!==this.speechQualityEventToken||null!==this.speechErrorEventToken}getAnnotationObserver(){return this.annotationObserver}async activateAnnotations(e){this.alSession?await this.activateAnnotationsUsingALSession(this.alSession,e):await this.activateAnnotationsUsingRuntimeManager(e)}async activateAnnotationsUsingRuntimeManager(e){const t=s.Rd(this.runtimeManager,a.lM.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient),n=s.Rd(this.runtimeManager,a.D_.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient);let r=null;e.indexOf(o.PartialResult)>=0&&(r=s.Rd(this.runtimeManager,a.ZF.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient));let i=null;e.indexOf(o.FinalResult)>=0&&(i=s.Rd(this.runtimeManager,a.mh.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient));const l=s.Rd(this.runtimeManager,a._K.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient);this.useDebugDictation&&console.warn("This dictation session will be logging audio"),[this.speechSessionEventToken,this.speechToTextPartialResultToken,this.speechToTextFinalResultToken,this.speechQualityEventToken,this.speechErrorEventToken]=await Promise.all([n,r,i,l,t])}warmUpAugloop(){this.alSession?g.j9(this.alSession,this.useFrontdoorWorkflow,i.A.dictationSettings,l.wM.version2,this.speechToTextProfile,this.sessionTelemetry,this.onInfo):s.j9(this.runtimeManager,this.useFrontdoorWorkflow,i.A.dictationSettings,l.wM.version2,this.speechToTextProfile,this.sessionTelemetry)}onAnnotationResult(e){(0,m.Jh)(e,a.lM.getTypeName()).map((e=>{this.handleSpeechErrorEvent(e.body)})),(0,m.Jh)(e,a.D_.getTypeName()).map((e=>{this.handleSpeechSessionEvent(e.body)})),(0,m.Jh)(e,a.ZF.getTypeName()).map((e=>{this.handleSpeechToTextPartialResult(e.body)})),(0,m.Jh)(e,a.mh.getTypeName()).map((e=>{const t=e.body,n=t.text;b(this.fdSpeechClientObserver,t,n,this.sessionTelemetry)})),(0,m.Jh)(e,a._K.getTypeName()).map((e=>{const t=e.body;t.eventInfo&&t.eventInfo.eventName===c.$O.QualityStatusUpdate&&this.handleSpeechQualityEvent(t.eventInfo)}))}handleSpeechErrorEvent(e){e&&(this.onWarning?this.onWarning(JSON.stringify(e),521417122):d.Hv.sendTraceTag(521417122,h.n.msoulscat_Wac_Dictation,p.k.Warning,JSON.stringify(e)),e.ErrorState===l.o2.FINAL&&e.ErrorImpact===l.$O.NO_DICTATION?(this.onError?this.onError(JSON.stringify(e),521417121):d.Hv.sendTraceTag(521417121,h.n.msoulscat_Wac_Dictation,p.k.Error,JSON.stringify(e)),this.fdSpeechClientObserver.onError(e.ErrorCode)):e.ErrorState===l.o2.INTERMITTENT&&e.ErrorImpact===l.$O.NO_DICTATION?this.onWarning?this.onWarning(JSON.stringify(e),521417120):d.Hv.sendTraceTag(521417120,h.n.msoulscat_Wac_Dictation,p.k.Warning,JSON.stringify(e)):e.ErrorState===l.o2.FINAL&&e.ErrorImpact===l.$O.NO_COMMANDING&&(this.onWarning?this.onWarning(JSON.stringify(e),521417120):d.Hv.sendTraceTag(521417119,h.n.msoulscat_Wac_Dictation,p.k.Warning,JSON.stringify(e)),this.fdSpeechClientObserver.showDictationWarning(e.ErrorCode,e.ErrorImpact)))}handleSpeechSessionEvent(e){switch(e.eventId){case u.P_.SpeechRecognitionStarted:this.transcriberId=e.sessionId,this.useDebugDictation&&console.warn(`Speech transcriberId: ${this.transcriberId}`),this.startRecognitionInSpeechToTextClient&&this.fdSpeechClientObserver.onSpeechRecognitionStarted();break;case u.P_.SpeechRecognitionStopped:this.sessionTelemetry?.setEndReason("SpeechRecognitionStopped"),this.fdSpeechClientObserver.onSpeechEnd();break;case u.P_.SpeechSessionStarted:if(this.speechSessionId=e.sessionId,this.useDebugDictation&&console.warn(`Speech speechSessionId: ${this.speechSessionId}`),this.fdSpeechClientObserver.onSpeechSessionStarted&&this.speechSessionId){const e={speechSessionId:this.speechSessionId,transcriptionSignature:""};this.fdSpeechClientObserver.onSpeechSessionStarted(e)}break;case u.P_.SpeechSessionStopped:this.fdSpeechClientObserver.onSpeechSessionStopped&&this.fdSpeechClientObserver.onSpeechSessionStopped();break;default:console.warn(`Unexpected speechSessionEventId: ${e.eventId}`)}}handleSpeechToTextPartialResult(e){if(""!==e.text){const t=new Map([[e.language,e.text]]);this.sessionTelemetry?.onPartialResultAnnotationResponse(Date.now(),e.properties.JsonResult?.Offset,e.properties.JsonResult?.Duration);const n=new Map;n.set("JsonResult",JSON.stringify(e.properties.JsonResult)),this.fdSpeechClientObserver.onFragmentText(t,n),this.sessionTelemetry&&v.logPhraseId("partial",this.sessionTelemetry,e)}}handleSpeechQualityEvent(e){this.fdSpeechClientObserver.onEventUpdate(e)}async activateAnnotationsUsingALSession(e,t){const n=g.Rd(e,a.lM.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient,this.onInfo,this.onError),s=g.Rd(e,a.D_.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient,this.onInfo,this.onError);let r=null;t.indexOf(o.PartialResult)>=0&&(r=g.Rd(e,a.ZF.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient,this.onInfo,this.onError));let i=null;t.indexOf(o.FinalResult)>=0&&(i=g.Rd(e,a.mh.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient,this.onInfo,this.onError));const l=g.Rd(e,a._K.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient,this.onInfo,this.onError);this.useDebugDictation&&console.warn("This dictation session will be logging audio"),[this.speechSessionEventToken,this.speechToTextPartialResultToken,this.speechToTextFinalResultToken,this.speechQualityEventToken,this.speechErrorEventToken]=await Promise.all([s,r,i,l,n])}}function b(e,t,n,o){const s=new Map([[t.language,n]]);o&&""!==n&&o.onFinalResultAnnotationResponse(Date.now(),t.properties.JsonResult?.Offset,t.properties.JsonResult?.Duration);const r=new Map;r.set("JsonResult",JSON.stringify(t.properties.JsonResult)),e.onFinalText(s,r),o&&""!==n&&v.logPhraseId("final",o,t)}},48316:(e,t,n)=>{"use strict";var o;n.d(t,{J:()=>o}),function(e){e.ErrorAudioPermissionDeniedError="ErrorAudioPermissionDeniedError",e.ErrorAudioDevicesNotFoundError="ErrorAudioDevicesNotFoundError",e.ErrorAudioNotReadableError="ErrorAudioNotReadableError",e.ErrorAudioCaptureAsync="ErrorAudioCaptureAsync"}(o||(o={}))},35305:(e,t,n)=>{"use strict";n.r(t),n.d(t,{BatchTranscriptionClientError:()=>q,BatchTranscriptionClientErrorCode:()=>H,BatchTranscriptionClientRequest:()=>Q,BatchTranscriptionClientRequestPoller:()=>J,CommandSuggestionClient:()=>I,CopilotLicensingClientError:()=>pe,CopilotLicensingClientErrorCode:()=>Y,CopilotLicensingClientRequest:()=>ve,CopilotLicensingClientRequestPoller:()=>be,DictationSettingsManager:()=>o.A,MicrophoneError:()=>M.J,SpeechToTextClient:()=>a.SpeechToTextClient,SpeechToTextResultType:()=>a.SpeechToTextResultType,VoiceCommandingClient:()=>A,VoiceSession:()=>P.VoiceSession,initializeBatchTranscriptionClient:()=>z,initializeCopilotLicensingClient:()=>me,uninitializeBatchTranscriptionClient:()=>j,uninitializeCopilotLicensingClient:()=>ye});var o=n(3316),s=n(69382),r=n(21965),i=n(97953),a=n(2217),l=n(35859);const c=new Set([r.oJ.Paste,r.oJ.Redo]);var u,d;!function(e){e.ZoomIn="Word.View.ZoomIn",e.ZoomOut="Word.View.ZoomOut",e.ShowOutline="Word.View.ShowOutline",e.ScrollUp="Word.View.ScrollUp",e.ScrollDown="Word.View.ScrollDown",e.ReadBack="Word.Editing.ReadBack",e.PageBreak="Word.Editing.PageBreak",e.SpellOut="Word.Editing.SpellOut",e.ShowSuggestions="Word.Editing.ShowSuggestions"}(u||(u={})),function(e){e.ReadBack="ReadBack",e.ChangeViews="ChangeViews",e.PageBreak="PageBreak",e.SpellOut="SpellOut",e.Discovery="Discovery"}(d||(d={}));const h=new Map([[d.ReadBack,new Set([u.ReadBack])],[d.ChangeViews,new Set([u.ZoomIn,u.ZoomOut,u.ShowOutline,u.ScrollDown,u.ScrollUp])],[d.PageBreak,new Set([u.PageBreak])],[d.SpellOut,new Set([u.SpellOut])],[d.Discovery,new Set([u.ShowSuggestions])]]),p=new Set([r.oJ.Bold,r.oJ.Italics,r.oJ.Underline,r.oJ.Highlight,r.oJ.Select,r.oJ.Superscript,r.oJ.Subscript,r.oJ.StrikeThrough,r.oJ.RemoveBold,r.oJ.RemoveItalics,r.oJ.RemoveUnderline,r.oJ.RemoveHighlight,r.oJ.RemoveSuperscript,r.oJ.RemoveSubscript,r.oJ.RemoveStrikeThrough,r.oJ.Delete,r.oJ.Quote,r.oJ.Navigation,r.oJ.AllCaps,r.oJ.LowerCase,r.oJ.SentenceCase]),f=Object.keys(u),g=Object.keys(r.oJ);function m(e){const t=new Set;return e.forEach((e=>{const n=h.get(e);null!=n&&n.forEach((e=>{t.add(e)}))})),t}const y=e=>!p.has(e.commandId)||!(e.selection&&v(e.selection,e.commandId)),v=(e,t)=>t===r.oJ.Navigation&&(e.which!==l.uR.Next&&e.which!==l.uR.Previous&&e.which!==l.uR.End||e.type!==l.hO.Word&&e.type!==l.hO.Bullet&&e.type!==l.hO.Sentence&&e.type!==l.hO.Paragraph),b=e=>(e.commandId===r.oJ.InsertComment&&(e.sourceText=e?.comment?.commentCommand||e.sourceText),e);var S=n(54585),w=n(82058),T=n(88943),C=n(98787),_=n(63564),k=n(54998),E=n(62510);class A{constructor(e,t,n,o,s,i,a,l,h,p){this.initialized=!1,this.voiceCommandRequestToken=null,this.alRuntimeManager=e,this.fdVoiceCommandClientObserver=t,this.fdSpeechClientObserver=n,this.enableSetAnnotationsFromALVoiceClient=s,(0,E.isChangeGateEnabled)("OfficeVSO:8765828_UseALSession")&&(i?this.alSession=i:e.getSession().then((e=>{this.alSession=e})).catch((e=>{h&&h(e)}))),this.onInfo=a,this.onWarning=l,this.onError=h,this.onTelemetryEvent=p,this.validVoiceCommands=(e=>{const t=new Set,n=m(e),o=m(Object.keys(d));for(const e of g)o.has(r.oJ[e])&&!n.has(r.oJ[e])||c.has(r.oJ[e])||t.add(r.oJ[e]);for(const e of f)n.has(u[e])&&o.has(u[e])&&t.add(u[e]);return t})(o),this.annotationObserver={onAnnotationResult:e=>{this.onAnnotationResult(e)}},this.workflowUsesCommandSets=!1}async initializeAsync(e){const t=!!this.voiceCommandRequestToken;this.onInfo?this.onInfo(`VoiceCommandingClient.initializeAsync - initialized: ${this.initialized}, annotationsActive: ${t}`,521417118):S.Hv.sendTraceTag(521417118,w.n.msoulscat_Wac_Dictation,T.k.Info,`VoiceCommandingClient.initializeAsync - initialized: ${this.initialized}, annotationsActive: ${t}`),t&&(this.onWarning?this.onWarning("Releasing old annotations",521417117):S.Hv.sendTraceTag(521417117,w.n.msoulscat_Wac_Dictation,T.k.Warning,"Releasing old annotations"),await this.uninitializeAsync()),e&&(this.sessionTelemetry=e);try{this.alSession?this.voiceCommandRequestToken=await _.Rd(this.alSession,s.VJ.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient,this.onInfo,this.onError):this.voiceCommandRequestToken=await i.Rd(this.alRuntimeManager,s.VJ.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient),this.initialized=!0}catch(e){("VoiceCommandingClient.initializeAsync - Activate Annotations - "+e.message).includes("Timeout waiting for response")?this.fdSpeechClientObserver.onWarning(e):this.fdSpeechClientObserver.onError(e)}}async uninitializeAsync(){const e=!!this.voiceCommandRequestToken;if(this.onInfo?this.onInfo(`VoiceCommandingClient.uninitializeAsync - initialized: ${this.initialized}, annotationsActive: ${e}`,521417116):S.Hv.sendTraceTag(521417116,w.n.msoulscat_Wac_Dictation,T.k.Info,`VoiceCommandingClient.uninitializeAsync - initialized: ${this.initialized}, annotationsActive: ${e}`),this.initialized=!1,e){try{this.alSession?await _.yw(this.alSession,[this.voiceCommandRequestToken],this.onInfo,this.onError):await i.yw(this.alRuntimeManager,[this.voiceCommandRequestToken])}catch(e){const t="VoiceCommandingClient.uninitializeAsync - Release Annotations - "+e.message;this.sessionTelemetry?.onAugloopError(t),this.onError?this.onError("VoiceCommandingClient.uninitializeAsync - Release Annotations - Error message: "+t+" - Error stack: "+e.stack,521417115):S.Hv.sendTraceTag(521417115,w.n.msoulscat_Wac_Dictation,T.k.Error,"VoiceCommandingClient.uninitializeAsync - Release Annotations - Error message: "+t+" - Error stack: "+e.stack)}this.voiceCommandRequestToken=null}}getAnnotationObserver(){return this.annotationObserver}onAnnotationResult(e){(0,k.Jh)(e,s.VJ.getTypeName()).forEach((e=>{this.handleCommandResult(e.body)}))}handleCommandResult(e){e.textAnnotation?.properties?.commandSet&&e.textAnnotation.properties.commandSet.length>0&&(this.workflowUsesCommandSets=!0),e.error&&this.sessionTelemetry&&this.sessionTelemetry.onCommandError(`handleCommandResult:${e.error}`);const t=e.textAnnotation.properties?.JsonResult?.Id;for(const o of e.commandList){const s=!((n=o.commandId)===r.oJ.Correction||n===r.oJ.CorrectionOption)||this.workflowUsesCommandSets,i=this.validVoiceCommands.has(o.commandId)&&y(o)&&s;if(i||(this.onTelemetryEvent?this.onTelemetryEvent("Office.Voice.Online.UnsupportedCommandReceived",t,o):(0,C.Ot)({name:"Office.Voice.Online.UnsupportedCommandReceived",dataFields:[{name:"PhraseID",string:t},{name:"ConnectionID",string:this.sessionTelemetry?.connectionID},{name:"SessionID",string:this.sessionTelemetry?.sessionID},{name:"CommandID",string:o.commandId},{name:"CommandVersion",int64:o.ver}]})),o.commandId!==r.oJ.InsertText&&i){const n=b(o);this.fdVoiceCommandClientObserver.onVoiceCommand(n,t),this.sessionTelemetry&&a.SpeechToTextClient.logPhraseId("final",this.sessionTelemetry,e.textAnnotation)}else(0,a.sendSpeechToTextFinalResultToSpeechClientObserver)(this.fdSpeechClientObserver,e.textAnnotation,o.sourceText,this.sessionTelemetry)}var n}}class I{constructor(e,t,n,o,s,r,i){this.initialized=!1,this.commandSuggestionRequestToken=null,this.alRuntimeManager=e,this.commandSuggestionManagerObserver=t,this.enableSetAnnotationsFromALVoiceClient=n,(0,E.isChangeGateEnabled)("OfficeVSO:8765828_UseALSession")&&(o?this.alSession=o:e.getSession().then((e=>{this.alSession=e})).catch((e=>{i&&i(e)}))),this.onInfo=s,this.onWarning=r,this.onError=i,this.annotationObserver={onAnnotationResult:e=>{this.onAnnotationResult(e)}}}async initializeAsync(e){const t=null!==this.commandSuggestionRequestToken;this.onInfo?this.onInfo(`CommandSuggestionClient.initializeAsync - initialized: ${this.initialized}, annotationsActive: ${t}`,521417160):S.Hv.sendTraceTag(521417160,w.n.msoulscat_Wac_Dictation,T.k.Info,`CommandSuggestionClient.initializeAsync - initialized: ${this.initialized}, annotationsActive: ${t}`),t&&(this.onWarning?this.onWarning("Releasing old annotations",521417159):S.Hv.sendTraceTag(521417159,w.n.msoulscat_Wac_Dictation,T.k.Warning,"Releasing old annotations"),await this.uninitializeAsync()),e&&(this.sessionTelemetry=e);try{this.alSession?this.commandSuggestionRequestToken=await _.Rd(this.alSession,s.z4.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient,this.onInfo,this.onError):this.commandSuggestionRequestToken=await i.Rd(this.alRuntimeManager,s.z4.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient),this.initialized=!0}catch(e){`CommandSuggestionClient.initializeAsync - Activate Annotations - ${e.message}`.includes("Timeout waiting for response")?this.commandSuggestionManagerObserver.onWarning(e):this.commandSuggestionManagerObserver.onError(e)}}async uninitializeAsync(){const e=null!==this.commandSuggestionRequestToken;if(this.onInfo?this.onInfo(`CommandSuggestionClient.uninitializeAsync - initialized: ${this.initialized}, annotationsActive: ${e}`,521417158):S.Hv.sendTraceTag(521417158,w.n.msoulscat_Wac_Dictation,T.k.Info,`CommandSuggestionClient.uninitializeAsync - initialized: ${this.initialized}, annotationsActive: ${e}`),this.initialized=!1,e){try{this.alSession?await _.yw(this.alSession,[this.commandSuggestionRequestToken],this.onInfo,this.onError):await i.yw(this.alRuntimeManager,[this.commandSuggestionRequestToken])}catch(e){const t=`CommandSuggestionClient.uninitializeAsync - Release Annotations - ${e.message}`;this.sessionTelemetry?.onAugloopError(t),this.onError?this.onError("CommandSuggestionClient.uninitializeAsync - Release Annotations - Error message: "+t+" - Error stack: "+e.stack,521417157):S.Hv.sendTraceTag(521417157,w.n.msoulscat_Wac_Dictation,T.k.Error,"CommandSuggestionClient.uninitializeAsync - Release Annotations - Error message: "+t+" - Error stack: "+e.stack)}this.commandSuggestionRequestToken=null}}getAnnotationObserver(){return this.annotationObserver}onAnnotationResult(e){(0,k.Jh)(e,s.z4.getTypeName()).forEach((e=>{this.commandSuggestionManagerObserver.onCommandSuggestion(e.body)}))}}var P=n(81958),M=n(48316),x=n(15372),R=n(76483),D=n(57144),O=n(72514),N=n(90268);const L={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let F;const B=new Uint8Array(16);function W(){if(!F&&(F="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!F))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return F(B)}const U=[];for(let e=0;e<256;++e)U.push((e+256).toString(16).slice(1));const G=function(e,t,n){if(L.randomUUID&&!t&&!e)return L.randomUUID();const o=(e=e||{}).random||(e.rng||W)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=o[e];return t}return function(e,t=0){return(U[e[t+0]]+U[e[t+1]]+U[e[t+2]]+U[e[t+3]]+"-"+U[e[t+4]]+U[e[t+5]]+"-"+U[e[t+6]]+U[e[t+7]]+"-"+U[e[t+8]]+U[e[t+9]]+"-"+U[e[t+10]]+U[e[t+11]]+U[e[t+12]]+U[e[t+13]]+U[e[t+14]]+U[e[t+15]]).toLowerCase()}(o)};var H;!function(e){e.UNKNOWN_ERROR="UNKNOWN_ERROR",e.UNSUPPORTED_FILE_FORMAT="UNSUPPORTED_FILE_FORMAT",e.INVALID_REQUEST="INVALID_REQUEST",e.REQUEST_DISPOSED="REQUEST_DISPOSED",e.POLLER_DISPOSED="POLLER_DISPOSED",e.PROCESSING="PROCESSING",e.DELETED="DELETED",e.FILE_NOT_EXIST="FILE_NOT_EXIST",e.FILE_DECODE_ERROR="FILE_DECODE_ERROR",e.REQUEST_TIMEOUT_ERROR="REQUEST_TIMEOUT_ERROR"}(H||(H={}));class q extends Error{constructor(e,t){super(t),this.code=e}}const $=[];function V(e,t,n,o,s,r,i,a,l,c,u){const d=new N.Xr({parentPath:["session"],items:[{id:t,body:new x.Qu({stage:n,downloadUrl:o,conversationId:s,speechFDUrl:i,corelationId:r,sourceLanguage:a,transcriberType:l})}]});(0,E.isChangeGateEnabled)("OfficeVSO:8765828_UseALSession")?c?c.submitOperation(d):e.getSession().then((e=>{e.submitOperation(d)})).catch((e=>{u&&u(e)})):e.submitOperation({operation:d})}async function z(e,t,n,o,s,r){(0,E.isChangeGateEnabled)("OfficeVSO:8765828_UseALSession")?o?($.push(await _.Rd(o,R.U1.getTypeName(),t,n,s,r)),V(void 0,G(),D.Cu.GetBatchResult,void 0,"",void 0,void 0,void 0,void 0,o,r)):e.getSession().then((async e=>{$.push(await _.Rd(e,R.U1.getTypeName(),t,n,s,r)),V(void 0,G(),D.Cu.GetBatchResult,void 0,"",void 0,void 0,void 0,void 0,e,r)})).catch((e=>{r&&r(e)})):($.push(await i.Rd(e,R.U1.getTypeName(),t,n)),V(e,G(),D.Cu.GetBatchResult))}function j(e,t,n,o){return(0,E.isChangeGateEnabled)("OfficeVSO:8765828_UseALSession")?new Promise(((s,r)=>{t?s(_.yw(t,$,n,o)):e.getSession().then((e=>{s(_.yw(e,$,n,o))})).catch((e=>{o&&(o(e),r())}))})):i.yw(e,$)}class Q{constructor(e,t=D.Cu.GetBatchResult,n,o,s,r,i,a,l,c,u,d,h){this.getResultCallbacks=null,this.alRuntimeManager=e,this.conversationId=o,this.corelationId=s,this.speechFdUrl=r,this.sourceLanguage=i,this.transcriberType=a,this.logMessage=l,this.workflowStage=t,this.downloadUrl=n,(0,E.isChangeGateEnabled)("OfficeVSO:8765828_UseALSession")&&(c?this.augloopSession=c:e.getSession().then((e=>{this.augloopSession=e})).catch((e=>{h&&h(e)}))),this.onInfo=u,this.onWarning=d,this.onError=h}makeRequest(){if(null!==this.getResultCallbacks)throw new q(H.INVALID_REQUEST,"getResult can only be called once per instance. If you want to make another request, create another instance.");return new Promise(((e,t)=>{const n=G();this.onInfo?this.onInfo(`Request tile submitted with requestId ${n}, conversationId ${this.conversationId}, correlation Id ${this.corelationId}.`,520435273):S.Hv.sendTraceTag(520435273,w.n.msoulscat_Wac_Dictation,T.k.Info,`Request tile submitted with requestId ${n}, conversationId ${this.conversationId}, correlation Id ${this.corelationId}.`),this.augloopSession?V(void 0,n,this.workflowStage,this.downloadUrl,this.conversationId,this.corelationId,this.speechFdUrl,this.sourceLanguage,this.transcriberType,this.augloopSession,this.onError):V(this.alRuntimeManager,n,this.workflowStage,this.downloadUrl,this.conversationId,this.corelationId,this.speechFdUrl,this.sourceLanguage,this.transcriberType),this.getResultCallbacks={resolve:e,reject:t,requestId:n}}))}dispose(){null!=this.getResultCallbacks&&this.getResultCallbacks.reject(new q(H.REQUEST_DISPOSED,"Caller disposed the BatchTranscriptionClientRequest instance")),this.getResultCallbacks=null}onAnnotationResult(e){const t=(0,k.Jh)(e,R.U1.getTypeName()),n=e.parentPath[e.parentPath.length-1];t.forEach((e=>{const t=e.body;if(null!=this.getResultCallbacks&&this.getResultCallbacks.requestId===n){try{!function(e,t){if(e.errorCode)throw t?t(`The result error code received in on AnnotationsResultcall back is ${e.errorCode}.`,520435270):S.Hv.sendTraceTag(520435270,w.n.msoulscat_Wac_Dictation,T.k.Warning,`The result error code received in on AnnotationsResultcall back is ${e.errorCode}.`),new q(function(e){switch(e){case O.sP.UNSUPPORTED_FILE_FORMAT:return H.UNSUPPORTED_FILE_FORMAT;case O.sP.PROCESSING:return H.PROCESSING;case O.sP.FILE_NOT_EXIST:return H.FILE_NOT_EXIST;case O.sP.FILE_DECODE_ERROR:return H.FILE_DECODE_ERROR;case O.sP.DELETED:return H.DELETED;case O.sP.REQUEST_TIMEOUT_ERROR:return H.REQUEST_TIMEOUT_ERROR;default:return H.UNKNOWN_ERROR}}(e.errorCode),e.errorMessage)}(t,this.onWarning)}catch(e){if(this.getResultCallbacks.reject(e),e.errorCode===H.FILE_NOT_EXIST||e.errorCode===H.FILE_DECODE_ERROR||e.code===H.DELETED)throw e}try{if(this.onInfo?this.onInfo(`Parsing batch transcription result segments for request Id ${n}, error message ${t.errorMessage}.`,520435272):S.Hv.sendTraceTag(520435272,w.n.msoulscat_Wac_Dictation,T.k.Info,`Parsing batch transcription result segments for request Id ${n}, error message ${t.errorMessage}.`),this.workflowStage===D.Cu.GetBatchResult){const e=function(e){if(!e.transcriptionsJson)throw new q(H.UNKNOWN_ERROR,"Received invalid transcriptionsJson");return JSON.parse(e.transcriptionsJson).map((e=>({offsetInTicks:e.offsetInTicks,durationInTicks:e.durationInTicks,userId:e.userId,text:e.text})))}(t);this.getResultCallbacks.resolve({conversationId:this.conversationId,transcriptSegments:e})}else if(this.workflowStage===D.Cu.AnalyzeAudio){const e=t.conversationId;this.getResultCallbacks.resolve({conversationId:e,transcriptSegments:[]})}}catch(e){this.onWarning?this.onWarning(`Batch transcription result segments failed for request Id ${n}, error message ${e.message}.`,520435271):S.Hv.sendTraceTag(520435271,w.n.msoulscat_Wac_Dictation,T.k.Warning,`Batch transcription result segments failed for request Id ${n}, error message ${e.message}.`),this.getResultCallbacks.reject(new q(H.UNKNOWN_ERROR,"Error parsing workflow response "+e.message))}}else this.workflowStage===D.Cu.GetBatchResult&&t.conversationId===this.conversationId&&this.logMessage&&this.logMessage("Dropped response for conversation ID that didn't belong to this request. Should we reuse results for the same conversation ID across requests?")}))}}class J{constructor(e,t,n=D.Cu.GetBatchResult,o,s,r,i,a,l,c,u,d,h,p){this.isDisposed=!1,this.lastRequest=null,this.pollingDelayMilliseconds=e,this.conversationId=s,this.corelationId=r,this.alRuntimeManager=t,this.speechFdUrl=i,this.workflowStage=n,this.downloadUrl=o,this.sourceLanguage=a,this.transcriberType=l,this.logMessage=c,(0,E.isChangeGateEnabled)("OfficeVSO:8765828_UseALSession")&&(u?this.augloopSession=u:t.getSession().then((e=>{this.augloopSession=e})).catch((e=>{p&&p(e)}))),this.onInfo=d,this.onWarning=h,this.onError=p}async makeRequest(){let e=null;do{let t;if(null!=e&&await K(this.pollingDelayMilliseconds),this.throwIfDisposed(),t=this.augloopSession?this.augloopSession:await this.alRuntimeManager.getSession(),!1!==t.isConnected){this.augloopSession?this.lastRequest=new Q(void 0,this.workflowStage,this.downloadUrl,this.conversationId,this.corelationId,this.speechFdUrl,this.sourceLanguage,this.transcriberType,this.logMessage,this.augloopSession,this.onInfo,this.onWarning,this.onError):this.lastRequest=new Q(this.alRuntimeManager,this.workflowStage,this.downloadUrl,this.conversationId,this.corelationId,this.speechFdUrl,this.sourceLanguage,this.transcriberType,this.logMessage);try{return await this.lastRequest.makeRequest()}catch(t){t.code===H.REQUEST_DISPOSED&&this.throwIfDisposed(),e=t}}else this.onWarning?this.onWarning("augloopSession isConnected is false, skipping BatchTranscriptionClient request to next turn.",521417155):S.Hv.sendTraceTag(521417155,w.n.msoulscat_Wac_Dictation,T.k.Warning,"augloopSession isConnected is false, skipping BatchTranscriptionClient request to next turn.")}while(e.code===H.PROCESSING);throw e}onAnnotationResult(e){null!=this.lastRequest&&this.lastRequest.onAnnotationResult(e)}dispose(){this.isDisposed=!0,null!=this.lastRequest&&this.lastRequest.dispose()}throwIfDisposed(){if(this.isDisposed)throw this.onWarning?this.onWarning("Caller disposed the BatchTranscriptionClientPoller instance.",520435269):S.Hv.sendTraceTag(520435269,w.n.msoulscat_Wac_Dictation,T.k.Warning,"Caller disposed the BatchTranscriptionClientPoller instance."),new q(H.POLLER_DISPOSED,"Caller disposed the BatchTranscriptionClientPoller instance")}}function K(e){return new Promise((t=>{setTimeout(t,e)}))}var Y,X=n(7703),Z=n(90687);class ee{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Z.h.assign(ee,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicensingAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Z.h.matchesTypesFor(e,[ee.getTypeName()])}}ee.H_={T_:ee.getTypeName(),B_:ee.getBaseTypes()};class te{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Z.h.assign(te,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicenseEnabledAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return Z.h.matchesTypesFor(e,[te.getTypeName()])}}te.H_={T_:te.getTypeName(),B_:te.getBaseTypes()};class ne{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Z.h.assign(ne,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicenseEnabledForBusinessChatAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return Z.h.matchesTypesFor(e,[ne.getTypeName()])}}ne.H_={T_:ne.getTypeName(),B_:ne.getBaseTypes()};class oe{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Z.h.assign(oe,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicenseEnabledForIntelligentSearchAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return Z.h.matchesTypesFor(e,[oe.getTypeName()])}}oe.H_={T_:oe.getTypeName(),B_:oe.getBaseTypes()};class se{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Z.h.assign(se,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicenseEnabledForM365TeamsAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return Z.h.matchesTypesFor(e,[se.getTypeName()])}}se.H_={T_:se.getTypeName(),B_:se.getBaseTypes()};class re{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Z.h.assign(re,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicenseEnabledForM365AppsAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return Z.h.matchesTypesFor(e,[re.getTypeName()])}}re.H_={T_:re.getTypeName(),B_:re.getBaseTypes()};class ie{constructor(e){Z.h.assign(ie,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CheckCopilotLicenseSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return Z.h.matchesTypesFor(e,[ie.getTypeName()])}}ie.H_={T_:ie.getTypeName(),B_:ie.getBaseTypes()};class ae{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Z.h.assign(ae,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicenseEnabledForSharePointAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return Z.h.matchesTypesFor(e,[ae.getTypeName()])}}ae.H_={T_:ae.getTypeName(),B_:ae.getBaseTypes()};class le{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Z.h.assign(le,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_PlannerPremiumLicenseEnabledAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return Z.h.matchesTypesFor(e,[le.getTypeName()])}}le.H_={T_:le.getTypeName(),B_:le.getBaseTypes()};class ce{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Z.h.assign(ce,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_TeamsPremiumLicenseEnabledAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return Z.h.matchesTypesFor(e,[ce.getTypeName()])}}ce.H_={T_:ce.getTypeName(),B_:ce.getBaseTypes()};class ue{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Z.h.assign(ue,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicensingOnDemandAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Z.h.matchesTypesFor(e,[ue.getTypeName()])}}ue.H_={T_:ue.getTypeName(),B_:ue.getBaseTypes()};class de{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Z.h.assign(de,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_TeamsCopilotLicensingAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Z.h.matchesTypesFor(e,[de.getTypeName()])}}de.H_={T_:de.getTypeName(),B_:de.getBaseTypes()};class he{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Z.h.assign(he,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotUserContextAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Z.h.matchesTypesFor(e,[he.getTypeName()])}}he.H_={T_:he.getTypeName(),B_:he.getBaseTypes()},function(e){e.UNKNOWN_ERROR="UNKNOWN_ERROR",e.INVALID_REQUEST="INVALID_REQUEST",e.REQUEST_DISPOSED="REQUEST_DISPOSED",e.REQUEST_TIMEOUT_ERROR="REQUEST_TIMEOUT_ERROR"}(Y||(Y={}));class pe extends Error{constructor(e,t){super(t),this.code=e}}const fe=[];function ge(e,t,n,o){const s=new N.Xr({parentPath:["session"],items:[{id:t,body:new X.hD}]});(0,E.isChangeGateEnabled)("OfficeVSO:8765828_UseALSession")?n?n.submitOperation(s):e.getSession().then((e=>{e.submitOperation(s)})).catch((e=>{o&&o(e)})):e.submitOperation({operation:s})}async function me(e,t,n,o,s,r){(0,E.isChangeGateEnabled)("OfficeVSO:8765828_UseALSession")?o?(fe.push(await _.Rd(o,ee.getTypeName(),t,n,s,r)),ge(void 0,G(),o,r)):e.getSession().then((async e=>{fe.push(await _.Rd(e,ee.getTypeName(),t,n,s,r)),ge(void 0,G(),e,r)})).catch((e=>{r&&r(e)})):(fe.push(await i.Rd(e,ee.getTypeName(),t,n)),ge(e,G(),o,r))}function ye(e,t,n,o){return(0,E.isChangeGateEnabled)("OfficeVSO:8765828_UseALSession")?new Promise(((s,r)=>{t?s(_.yw(t,fe,n,o)):e.getSession().then((e=>{s(_.yw(e,fe,n,o))})).catch((e=>{o&&(o(e),r())}))})):i.yw(e,fe)}class ve{constructor(e,t,n,o,s){this.getResultCallbacks=null,this.alRuntimeManager=e,(0,E.isChangeGateEnabled)("OfficeVSO:8765828_UseALSession")&&(t?this.augloopSession=t:e.getSession().then((e=>{this.augloopSession=e})).catch((e=>{s&&s(e)}))),this.onInfo=n,this.onWarning=o,this.onError=s}makeRequest(){if(null!==this.getResultCallbacks)throw new pe(Y.INVALID_REQUEST,"getResult can only be called once per instance. If you want to make another request, create another instance.");return new Promise(((e,t)=>{const n=G();this.onInfo?this.onInfo(`Request tile submitted with requestId ${n}`,520435273):S.Hv.sendTraceTag(505415009,w.n.msoulscat_Wac_Dictation,T.k.Info,`Request tile submitted with requestId ${n}`),this.augloopSession?ge(void 0,n,this.augloopSession,this.onError):ge(this.alRuntimeManager,n),this.getResultCallbacks={resolve:e,reject:t,requestId:n}}))}dispose(){null!=this.getResultCallbacks&&this.getResultCallbacks.reject(new pe(Y.REQUEST_DISPOSED,"Caller disposed the CopilotLicensingClientRequest instance")),this.getResultCallbacks=null}onAnnotationResult(e){const t=(0,k.Jh)(e,ee.getTypeName()),n=e.parentPath[e.parentPath.length-1];t.forEach((e=>{const t=e.body;if(null!=this.getResultCallbacks&&this.getResultCallbacks.requestId===n)try{this.onInfo?this.onInfo(`Parsing Copilot licensing result for request Id ${n}`,520435272):S.Hv.sendTraceTag(505415008,w.n.msoulscat_Wac_Dictation,T.k.Info,`Parsing Copilot licensing result for request Id ${n}`),this.getResultCallbacks.resolve(t)}catch(e){this.onWarning?this.onWarning(`Copilot licensing result failed for request Id ${n}, error message ${e.message}`,520435271):S.Hv.sendTraceTag(505415007,w.n.msoulscat_Wac_Dictation,T.k.Warning,`Copilot licensing result failed for request Id ${n}, error message ${e.message}`),this.getResultCallbacks.reject(new pe(Y.UNKNOWN_ERROR,"Error parsing workflow response "+e.message))}}))}}class be{constructor(e,t,n,o,s,r){this.isDisposed=!1,this.lastRequest=null,this.pollingDelayMilliseconds=e,this.alRuntimeManager=t,(0,E.isChangeGateEnabled)("OfficeVSO:8765828_UseALSession")&&(n?this.augloopSession=n:t.getSession().then((e=>{this.augloopSession=e})).catch((e=>{r&&r(e)}))),this.onInfo=o,this.onWarning=s,this.onError=r}async makeRequest(){let e=null;do{let t;if(null!=e&&await Se(this.pollingDelayMilliseconds),this.throwIfDisposed(),t=this.augloopSession?this.augloopSession:await this.alRuntimeManager.getSession(),!1!==t.isConnected){this.augloopSession?this.lastRequest=new ve(void 0,this.augloopSession,this.onInfo,this.onWarning,this.onError):this.lastRequest=new ve(this.alRuntimeManager,void 0,this.onInfo,this.onWarning,this.onError);try{return await this.lastRequest.makeRequest()}catch(t){t.code===Y.REQUEST_DISPOSED&&this.throwIfDisposed(),e=t}}else this.onWarning?this.onWarning("augloopSession isConnected is false, skipping CopilotLicensingClient request to next turn.",521417155):S.Hv.sendTraceTag(505415006,w.n.msoulscat_Wac_Dictation,T.k.Warning,"augloopSession isConnected is false, skipping CopilotLicensingClient request to next turn.")}while(e.code===Y.REQUEST_TIMEOUT_ERROR);throw e}onAnnotationResult(e){null!=this.lastRequest&&this.lastRequest.onAnnotationResult(e)}dispose(){this.isDisposed=!0,null!=this.lastRequest&&this.lastRequest.dispose()}throwIfDisposed(){if(this.isDisposed)throw this.onWarning?this.onWarning("Caller disposed the CopilotLicensingClientPoller instance.",520435269):S.Hv.sendTraceTag(505415005,w.n.msoulscat_Wac_Dictation,T.k.Warning,"Caller disposed the CopilotLicensingClientPoller instance."),new pe(Y.REQUEST_DISPOSED,"Caller disposed the CopilotLicensingClientPoller instance")}}function Se(e){return new Promise((t=>{setTimeout(t,e)}))}},52865:(e,t,n)=>{"use strict";n.d(t,{FA:()=>s,b2:()=>o,eG:()=>r});const o=16e3,s=16,r=(e,t)=>{const n=i(e,t,o),s=new ArrayBuffer(2*n.length),r=new DataView(s);return a(r,0,n),r},i=(e,t,n)=>{if(n===t||n>t)return e;if(null==e)return new Float32Array(0);const o=t/n,s=Math.round(e.length/o),r=new Float32Array(s);let i=0,a=0;for(;a<s;){const t=Math.round((a+1)*o);let n=0,s=0;for(;i<t&&i<e.length;)n+=e[i],i+=1,s+=1;r[a]=n/s,a+=1}return r},a=(e,t,n)=>{for(let o=0,s=t;o<n.length;o+=1,s+=2){const t=Math.max(-1,Math.min(1,n[o]));e.setInt16(s,t<0?32768*t:32767*t,!0)}}},97953:(e,t,n)=>{"use strict";n.d(t,{Rd:()=>h,Yf:()=>g,j9:()=>f,vh:()=>m,yw:()=>p});var o=n(84166),s=n(15372),r=n(52865),i=n(54585),a=n(82058),l=n(88943),c=n(54998);let u=0;const d=(e,t,n)=>{const s=new o.VR({item:{id:u.toString(),body:t}});e.submitCustomMessage({message:s}).catch((e=>{(0,c.bU)(e,n)}))},h=async(e,t,n,o)=>{i.Hv.sendTraceTag(508151006,a.n.msoulscat_Wac_Dictation,l.k.Info,"Start to activate annotations of: "+t);const s=o?await e.activateAnnotation({annotationType:t,handler:e=>{n&&n.onAnnotationResult(e)}}):await e.activateAnnotation({annotationType:t});return s||i.Hv.sendTraceTag(508151005,a.n.msoulscat_Wac_Dictation,l.k.Error,"activateAnnotationAsync: Missing activationResult!"),s?.token},p=async(e,t)=>{i.Hv.sendTraceTag(508151004,a.n.msoulscat_Wac_Dictation,l.k.Info,`Releasing annotation tokens: ${t}`);const n=t.map((t=>(i.Hv.sendTraceTag(508151003,a.n.msoulscat_Wac_Dictation,l.k.Info,"Start to release annotation of: "+t),t?e.releaseAnnotation({token:t}).catch((e=>{i.Hv.sendTraceTag(508151002,a.n.msoulscat_Wac_Dictation,l.k.Error,`Failed to release annotation ${t}: ${e.message}`)})):Promise.resolve())));await Promise.all(n)},f=(e,t,n,o,c,h)=>{const{dictationLanguage:p,useAutoPunctuation:f,useCorrections:g,useVoiceCommands:m}=n;i.Hv.sendTraceTag(508151001,a.n.msoulscat_Wac_Dictation,l.k.Info,`Sending empty warm-up tile, seq: ${u}, dictationLanguage: ${p}, useAutoPunctuation: ${f}, useCorrections: ${g}, useVoiceCommands: ${m}, speechToTextProfile: ${c}`);const y=new s.jP({sampleRate:r.b2,useFrontdoorWorkflow:t,seq:u,dictationSettings:n,responseVersion:o,speechToTextProfile:c,commandSet:["warm-up"]});d(e,y,h),u+=1},g=(e,t,n,o)=>{i.Hv.sendTraceTag(508151e3,a.n.msoulscat_Wac_Dictation,l.k.Info,`Sending empty tile with endVoiceSession:true, seq: ${u}`);const c=new s.jP({endVoiceSession:!0,sampleRate:r.b2,useFrontdoorWorkflow:t,seq:u,dictationSettings:n});d(e,c,o),u+=1},m=(e,t,n,o,r,i,a,l,c=[])=>{const h=new s.jP({sampleRate:n,useFrontdoorWorkflow:o,seq:u,dictationSettings:r,responseVersion:i,data:new Uint8Array(t.buffer,t.byteOffset,t.byteLength),speechToTextProfile:a,commandSet:c});return d(e,h,l),u+=1,h}},63564:(e,t,n)=>{"use strict";n.d(t,{Rd:()=>h,Yf:()=>g,j9:()=>f,vh:()=>m,yw:()=>p});var o=n(54585),s=n(82058),r=n(88943),i=n(15372),a=n(52865),l=n(84166),c=n(54998);let u=0;const d=(e,t,n)=>{const o=new l.VR({item:{id:u.toString(),body:t}});e.submitCustomMessage(o).catch((e=>{(0,c.bU)(e,n)}))},h=async(e,t,n,i,a,l)=>{a?a("Start to activate annotations of: "+t,508151266):o.Hv.sendTraceTag(508151266,s.n.msoulscat_Wac_Dictation,r.k.Info,"Start to activate annotations of: "+t);const c=i?await e.activateAnnotation(t,{callback:e=>{n&&n.onAnnotationResult(e)}}):await e.activateAnnotation(t);return c||(l?l("activateAnnotationAsync: Missing activationResult!",508151265):o.Hv.sendTraceTag(508151265,s.n.msoulscat_Wac_Dictation,r.k.Error,"activateAnnotationAsync: Missing activationResult!")),c?.token},p=async(e,t,n,i)=>{n?n(`Releasing annotation tokens: ${t}`,508151298):o.Hv.sendTraceTag(508151298,s.n.msoulscat_Wac_Dictation,r.k.Info,`Releasing annotation tokens: ${t}`);const a=t.map((t=>(n?n("Start to release annotation of: "+t,508151297):o.Hv.sendTraceTag(508151297,s.n.msoulscat_Wac_Dictation,r.k.Info,"Start to release annotation of: "+t),t?e?.releaseAnnotation(t).catch((e=>{i?i(`Failed to release annotation ${t}: ${e.message}`,508151296):o.Hv.sendTraceTag(508151296,s.n.msoulscat_Wac_Dictation,r.k.Error,`Failed to release annotation ${t}: ${e.message}`)})):Promise.resolve())));await Promise.all(a)},f=(e,t,n,l,c,h,p)=>{const{dictationLanguage:f,useAutoPunctuation:g,useCorrections:m,useVoiceCommands:y}=n;p?p(`Sending empty warm-up tile, seq: ${u}, dictationLanguage: ${f}, useAutoPunctuation: ${g}, useCorrections: ${m}, useVoiceCommands: ${y}, speechToTextProfile: ${c}`,508151267):o.Hv.sendTraceTag(508151267,s.n.msoulscat_Wac_Dictation,r.k.Info,`Sending empty warm-up tile, seq: ${u}, dictationLanguage: ${f}, useAutoPunctuation: ${g}, useCorrections: ${m}, useVoiceCommands: ${y}, speechToTextProfile: ${c}`);const v=new i.jP({sampleRate:a.b2,useFrontdoorWorkflow:t,seq:u,dictationSettings:n,responseVersion:l,speechToTextProfile:c,commandSet:["warm-up"]});d(e,v,h),u+=1},g=(e,t,n,l,c)=>{c?c(`Sending empty tile with endVoiceSession:true, seq: ${u}`,508151264):o.Hv.sendTraceTag(508151264,s.n.msoulscat_Wac_Dictation,r.k.Info,`Sending empty tile with endVoiceSession:true, seq: ${u}`);const h=new i.jP({endVoiceSession:!0,sampleRate:a.b2,useFrontdoorWorkflow:t,seq:u,dictationSettings:n});d(e,h,l),u+=1},m=(e,t,n,o,s,r,a,l,c=[])=>{const h=new i.jP({sampleRate:n,useFrontdoorWorkflow:o,seq:u,dictationSettings:s,responseVersion:r,data:new Uint8Array(t.buffer,t.byteOffset,t.byteLength),speechToTextProfile:a,commandSet:c});return d(e,h,l),u+=1,h}},54998:(e,t,n)=>{"use strict";n.d(t,{Jh:()=>l,bU:()=>d,rq:()=>c,yA:()=>u});var o=n(90687),s=n(90268),r=n(54585),i=n(82058),a=n(88943);const l=(e,t)=>o.h.getTypeNameFor(e)!==s.Xr.getTypeName()&&o.h.getTypeNameFor(e)!==s.fZ.getTypeName()||0===e.items.length?[]:e.items.filter((e=>e.body&&o.h.getTypeNameFor(e.body)===t)),c=(e,t)=>{const n=`${e}`.trimLeft();if(n.startsWith("[object "))try{const t=e?.name&&e?.message?`${e.name}: ${e.message}`:e?.message?e.message:e?.name?e.name:JSON.stringify(e);return t?n+" "+t:n}catch(e){const o=`stringifyException error: ${e.name}: ${e.message}`;return t?t(o,507377506):r.Hv.sendTraceTag(507377506,i.n.msoulscat_Wac_Dictation,a.k.Error,o),n+" "+o}return n};var u;function d(e,t){t?.onTileSubmitFailed&&t.onTileSubmitFailed();const n=e?.error??e?.message??e?.toString();switch(n){case"Timeout waiting for response":case"Cancelled":case"Message is dropped as oldest in full queue":return;default:t?.onAugloopError(`submitVoiceTile error: ${c(n)}`)}}!function(e){e.ErrorAugloopActivateAnnotations="ErrorAugloopActivateAnnotations"}(u||(u={}))},98526:(e,t)=>{"use strict";function n(){return void 0===globalThis.__get_change_gate_dictionary_variable?{}:globalThis.__get_change_gate_dictionary_variable()}Object.defineProperty(t,"__esModule",{value:!0}),t.getChangeGateDictionary=n,t.isChangeGateEnabled=function(e){return n()[e]??!0},t.setChangeGateDictionaryGetter=function(e){const t=globalThis.__get_change_gate_dictionary_variable;return globalThis.__get_change_gate_dictionary_variable=e,t}},28869:(e,t)=>{"use strict";function n(e){return e.split("")}Object.defineProperty(t,"__esModule",{value:!0}),t.editDistance=function(e,t){const o=n(e),s=n(t);let r=[];for(let e=0;e<=s.length;++e)r[e]=e;for(let e=1;e<=o.length;++e){const t=[e];for(let n=1;n<=s.length;++n)t[n]=o[e-1]===s[n-1]?r[n-1]:1+Math.min(r[n],r[n-1],t[n-1]);r=t}return r[s.length]}},27806:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.disableVerboseMode=function(){globalThis.__office_online_feature_gates_verbose_log_callback=void 0},t.enableVerboseMode=function(e){globalThis.__office_online_feature_gates_verbose_log_callback=e},t.getFeatureGateDictionary=r,t.getStringFeatureGate=i,t.getBooleanFeatureGate=function(e,t){const n=i(e)?.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){const n=i(e)?.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;const o=parseFloat(n);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){const n=i(e)?.trim();if(void 0===n)return t;const o=parseInt(n,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){const t=globalThis.__get_feature_gate_dictionary_variable;return globalThis.__get_feature_gate_dictionary_variable=e,t};const o=n(28869),s={};function r(){return void 0===globalThis.__get_feature_gate_dictionary_variable?s:globalThis.__get_feature_gate_dictionary_variable()}function i(e,t){if(void 0===globalThis.__office_online_feature_gates_verbose_log_callback)return r()[e]??t;const n=r();if(Object.hasOwn(n,e))return n[e]??t;const s=globalThis.__office_online_feature_gates_verbose_log_callback;s(`Failed lookup for FeatureGate ${e}...`);const i=[],a=e.toLowerCase();for(const e of Object.keys(n))(0,o.editDistance)(e.toLowerCase(),a)<=4&&i.push(e);return i.length>0&&s(`Potential candidates found (edit distance <= 4, case-insensitive): [${i.join(", ")}]`),s(`FeatureGate override not found, returning default: ${t}`),t}},62510:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(5866);o.__exportStar(n(27806),t),o.__exportStar(n(83009),t),o.__exportStar(n(98526),t),o.__exportStar(n(86338),t),o.__exportStar(n(2070),t),o.__exportStar(n(83398),t)},83009:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=function(e){return function(t){const n=e[t];switch(typeof n){case"boolean":return(0,o.getBooleanFeatureGate)(t,n);case"number":return(0,o.getNumberFeatureGate)(t,n);case"string":return(0,o.getStringFeatureGate)(t,n);default:throw new Error("Wrong defaultValue type")}}};const o=n(27806)},86338:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=function(e){return e=>(0,o.isChangeGateEnabled)(e)};const o=n(98526)},2070:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideChangeGates=s,t.overrideTypedChangeGates=function(e,t){return s(t)};const o=n(98526);function s(e){const t=(0,o.setChangeGateDictionaryGetter)(void 0);return(0,o.setChangeGateDictionaryGetter)((()=>({...void 0!==t?t():{},...e}))),t}},83398:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideFeatureGates=s,t.overrideTypedFeatureGates=function(e,t){return s(t)};const o=n(27806);function s(e){const t={};for(const n of Object.keys(e))t[n]=e[n]?.toString();const n=(0,o.setFeatureGateDictionaryGetter)(void 0)??(()=>({}));return(0,o.setFeatureGateDictionaryGetter)((()=>({...n(),...t}))),n}},98787:(e,t,n)=>{"use strict";n.d(t,{Ot:()=>c});let o,s=!1,r=[],i=0;const a=2e4;var l;function c(e){!function(e){s&&(o?o(e):r.length<=a?r.push(e):i+=1)}({kind:"event",event:e,timestamp:(new Date).getTime()})}!function(e){e.Count="Count",e.Avg="Avg",e.Sum="Sum"}(l||(l={}))},82058:(e,t,n)=>{"use strict";var o;n.d(t,{n:()=>o}),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_MSOSP_AddInCommands=220]="msoulscat_MSOSP_AddInCommands",e[e.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",e[e.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WacFeedback=356]="msoulscat_Wac_WacFeedback",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptGc2General=835]="msoulscat_Wac_PptGc2General",e[e.msoulscat_Wac_PptGc2GraphicHost=836]="msoulscat_Wac_PptGc2GraphicHost",e[e.msoulscat_Wac_PptGc2Operation=837]="msoulscat_Wac_PptGc2Operation",e[e.msoulscat_Wac_PptGc2EditCanvas=852]="msoulscat_Wac_PptGc2EditCanvas",e[e.msoulscat_Wac_PptDataSync=844]="msoulscat_Wac_PptDataSync",e[e.msoulscat_Wac_PptFluidRuntime=848]="msoulscat_Wac_PptFluidRuntime",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",e[e.msoulscat_Wac_PptVideos=846]="msoulscat_Wac_PptVideos",e[e.msoulscat_Uci_Insights=1303]="msoulscat_Uci_Insights",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_OAuth=3e3]="msoulscat_Wac_OAuth",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",e[e.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",e[e.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost",e[e.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools",e[e.msoulscat_Osf_Latency=1401]="msoulscat_Osf_Latency",e[e.msoulscat_Osf_Notification=1402]="msoulscat_Osf_Notification",e[e.msoulscat_Osf_Runtime=1403]="msoulscat_Osf_Runtime",e[e.msoulscat_Wac_AiMaker=3041]="msoulscat_Wac_AiMaker",e[e.msoulscat_Wac_AiRewrite=3043]="msoulscat_Wac_AiRewrite",e[e.msoulscat_Wac_AiInsert=3044]="msoulscat_Wac_AiInsert",e[e.msoulscat_Wac_AiSummarize=3047]="msoulscat_Wac_AiSummarize",e[e.msoulscat_Wac_CopilotCompose=3048]="msoulscat_Wac_CopilotCompose",e[e.msoulscat_Wac_Skittles=3049]="msoulscat_Wac_Skittles",e[e.msoulscat_Wac_CopilotChat=3050]="msoulscat_Wac_CopilotChat",e[e.msoulscat_Wac_Syntex=3051]="msoulscat_Wac_Syntex",e[e.msoulscat_Wac_WireGraph=3052]="msoulscat_Wac_WireGraph",e[e.msoulscat_Wac_CshCopilot=3053]="msoulscat_Wac_CshCopilot",e[e.msoulscat_Wac_CopilotProactiveSummary=3055]="msoulscat_Wac_CopilotProactiveSummary",e[e.msoulscat_Wac_CopilotProactiveShared=3056]="msoulscat_Wac_CopilotProactiveShared",e[e.msoulscat_Wac_CopilotCursor=3057]="msoulscat_Wac_CopilotCursor",e[e.msoulscat_Wac_WasmGeneral=3059]="msoulscat_Wac_WasmGeneral",e[e.msoulscat_Wac_WasmTextLayout=3060]="msoulscat_Wac_WasmTextLayout",e[e.msoulscat_Wac_WasmSmartArt=3061]="msoulscat_Wac_WasmSmartArt",e[e.msoulscat_Wac_WasmClient=3062]="msoulscat_Wac_WasmClient",e[e.msoulscat_Wac_WasmNative=3063]="msoulscat_Wac_WasmNative",e[e.msoulscat_Wac_UniversalPrint=3068]="msoulscat_Wac_UniversalPrint",e[e.msoulscat_AIHub_CreateModuleTelemetry=4e3]="msoulscat_AIHub_CreateModuleTelemetry",e[e.msoulscat_AIHub_CreateModuleAugloop=4001]="msoulscat_AIHub_CreateModuleAugloop",e[e.msoulscat_AIHub_CreateModuleDAS=4002]="msoulscat_AIHub_CreateModuleDAS",e[e.msoulscat_AIHub_CreateModuleConfig=4003]="msoulscat_AIHub_CreateModuleConfig",e[e.msoulscat_AIHub_CreateModuleContext=4004]="msoulscat_AIHub_CreateModuleContext",e[e.msoulscat_AIHub_CreateModuleGraph=4005]="msoulscat_AIHub_CreateModuleGraph",e[e.msoulscat_AIHub_CreateModuleExperiences=4006]="msoulscat_AIHub_CreateModuleExperiences",e[e.msoulscat_AIHub_CreateModuleHttp=4007]="msoulscat_AIHub_CreateModuleHttp",e[e.msoulscat_AIHub_CreateModuleRouting=4008]="msoulscat_AIHub_CreateModuleRouting",e[e.msoulscat_AIHub_CreateModuleStorage=4009]="msoulscat_AIHub_CreateModuleStorage",e[e.msoulscat_AIHub_CreateModuleStore=4010]="msoulscat_AIHub_CreateModuleStore",e[e.msoulscat_AIHub_CreateModuleUI=4011]="msoulscat_AIHub_CreateModuleUI",e[e.msoulscat_AIHub_CreateModuleSharePoint=4012]="msoulscat_AIHub_CreateModuleSharePoint",e[e.msoulscat_AIHub_CreateModuleUI_Artifacts=4100]="msoulscat_AIHub_CreateModuleUI_Artifacts",e[e.msoulscat_AIHub_CreateModuleUI_BrandKit=4101]="msoulscat_AIHub_CreateModuleUI_BrandKit",e[e.msoulscat_AIHub_CreateModuleUI_Forms=4102]="msoulscat_AIHub_CreateModuleUI_Forms",e[e.msoulscat_AIHub_CreateModuleUI_Homepage=4103]="msoulscat_AIHub_CreateModuleUI_Homepage",e[e.msoulscat_AIHub_CreateModuleUI_Text=4104]="msoulscat_AIHub_CreateModuleUI_Text",e[e.msoulscat_AIHub_CreateModuleUI_Video=4105]="msoulscat_AIHub_CreateModuleUI_Video"}(o||(o={}))},88943:(e,t,n)=>{"use strict";var o;n.d(t,{k:()=>o}),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(o||(o={}))},54585:(e,t,n)=>{"use strict";n.d(t,{Hv:()=>s});class o{sendTraceTag(){}shipAssertTag(){}debugAssertTag(){}setCorrelationId(){}}const s=new class{constructor(){this.externalLogger=new o}setCorrelationId(e){this.externalLogger.setCorrelationId(e)}setLogger(e){this.externalLogger=e}sendTraceTag(e,t,n,o){this.externalLogger.sendTraceTag(e,t,n,o)}debugAssertTag(e,t,n,o){this.externalLogger.debugAssertTag(e,t,n,o)}shipAssertTag(e,t,n,o){this.externalLogger.shipAssertTag(e,t,n,o)}}},196:(e,t,n)=>{"use strict";var o,s,r,i,a;n.d(t,{OY:()=>o,Om:()=>r}),function(e){e[e.EditorLowPrivilege=0]="EditorLowPrivilege",e[e.AugLoopLowPrivilege=1]="AugLoopLowPrivilege",e[e.Anonymous=2]="Anonymous",e[e.ClientAssertion=3]="ClientAssertion",e[e.ClientAssertionV2=4]="ClientAssertionV2",e[e.AutoClpLowPrivilege=5]="AutoClpLowPrivilege",e[e.AutoClpAppOnlyLowPrivilege=6]="AutoClpAppOnlyLowPrivilege",e[e.Substrate=7]="Substrate",e[e.WacUserInfo=8]="WacUserInfo",e[e.OwaExchange=9]="OwaExchange",e[e.SmartCompose=10]="SmartCompose",e[e.WritingAnalyticsLowPrivilege=11]="WritingAnalyticsLowPrivilege",e[e.DWEngineLowPrivilege=12]="DWEngineLowPrivilege",e[e.SubstrateApp=13]="SubstrateApp",e[e.CortanaAppPop=14]="CortanaAppPop",e[e.OfficeAppsAppOnly=15]="OfficeAppsAppOnly",e[e.PPTFrontdoorAppPop=16]="PPTFrontdoorAppPop",e[e.EditorAppOnlyLowPrivilege=17]="EditorAppOnlyLowPrivilege",e[e.AugLoopApp=18]="AugLoopApp",e[e.MeetingIntelligenceApp=19]="MeetingIntelligenceApp",e[e.GraphApp=20]="GraphApp",e[e.IceServicesApp=21]="IceServicesApp",e[e.AzureMapsApp=22]="AzureMapsApp",e[e.SpoApp=23]="SpoApp",e[e.OneDrive=24]="OneDrive",e[e.GoogleDrive=25]="GoogleDrive",e[e.GettyApp=26]="GettyApp",e[e.Dropbox=27]="Dropbox",e[e.GooglePhotos=28]="GooglePhotos",e[e.EditorApp=29]="EditorApp",e[e.AmazonKindle=30]="AmazonKindle",e[e.ShredderApp=31]="ShredderApp",e[e.FormsLowPrivilege=32]="FormsLowPrivilege",e[e.VivaSalesLowPrivilege=33]="VivaSalesLowPrivilege",e[e.IntentSvcApp=34]="IntentSvcApp",e[e.DcgLowPrivilege=35]="DcgLowPrivilege",e[e.CSALowPrivilege=36]="CSALowPrivilege",e[e.ConsumerSydneyLowPrivilege=37]="ConsumerSydneyLowPrivilege",e[e.CompliantSydneyApp=38]="CompliantSydneyApp",e[e.M365AdminApp=39]="M365AdminApp",e[e.MeetingArtifactsServiceLowPrivilege=40]="MeetingArtifactsServiceLowPrivilege",e[e.AlchemyApp=41]="AlchemyApp",e[e.M365Admin=42]="M365Admin",e[e.ConsumerShellApp=43]="ConsumerShellApp",e[e.PowerQueryLowPrivilege=44]="PowerQueryLowPrivilege",e[e.CIIApp=45]="CIIApp",e[e.ConsumerShell=46]="ConsumerShell",e[e.AssistCopilotLowPrivilege=47]="AssistCopilotLowPrivilege",e[e.Pva=48]="Pva",e[e.TeamsCopilotServiceLowPrivilege=49]="TeamsCopilotServiceLowPrivilege",e[e.CallAnalytics=50]="CallAnalytics",e[e.IncomingPFT=51]="IncomingPFT",e[e.GraphExchange=52]="GraphExchange",e[e.EXOAdmin=53]="EXOAdmin",e[e.InsightsServicesLowPrivilege=54]="InsightsServicesLowPrivilege",e[e.VivaServicesLowPrivilege=55]="VivaServicesLowPrivilege",e[e.EcsAppOnly=56]="EcsAppOnly",e[e.ShredderLowPrivilege=57]="ShredderLowPrivilege",e[e.SpoLowPrivilege=58]="SpoLowPrivilege",e[e.PromptValidationApp=59]="PromptValidationApp",e[e.CompliantSydneyLowPrivilege=60]="CompliantSydneyLowPrivilege",e[e.SubstrateTenantFeedbackApp=61]="SubstrateTenantFeedbackApp",e[e.MonitoringPlatform=62]="MonitoringPlatform",e[e.YammerLowPrivilege=63]="YammerLowPrivilege",e[e.VivaLearningLowPrivilege=64]="VivaLearningLowPrivilege",e[e.VivaInsightsLowPrivilege=65]="VivaInsightsLowPrivilege",e[e.ClientAugLoopApp=66]="ClientAugLoopApp",e[e.AssistAuthLowPrivilege=67]="AssistAuthLowPrivilege",e[e.VivaLearningSearchPreProdLowPrivilege=68]="VivaLearningSearchPreProdLowPrivilege",e[e.SubstrateSearchApp=69]="SubstrateSearchApp",e[e.SparkContentPlatformLowPrivilege=70]="SparkContentPlatformLowPrivilege",e[e.SparkContentPlatformPopApp=71]="SparkContentPlatformPopApp",e[e.ConsumerSydneyApp=72]="ConsumerSydneyApp",e[e.BusinessAssistAuthLowPrivilege=73]="BusinessAssistAuthLowPrivilege",e[e.AzureResourceManager=74]="AzureResourceManager",e[e.AlchemyPortal=75]="AlchemyPortal",e[e.VivaUserSkillsApp=76]="VivaUserSkillsApp",e[e.VivaEngageAppPop=77]="VivaEngageAppPop",e[e.SubstrateAppOnly=78]="SubstrateAppOnly",e[e.PowerAutomateFlowCreationLowPrivilege=79]="PowerAutomateFlowCreationLowPrivilege",e[e.PowerAutomateConnectionCreationLowPrivilege=80]="PowerAutomateConnectionCreationLowPrivilege",e[e.PowerAutomateAuthorizeConnectionLowPrivilege=81]="PowerAutomateAuthorizeConnectionLowPrivilege",e[e.TCAAppPop=82]="TCAAppPop",e[e.BusinessAssistAuthAppPop=83]="BusinessAssistAuthAppPop",e[e.HolmesApp=84]="HolmesApp",e[e.GraphAppOnly=85]="GraphAppOnly",e[e.SimsApp=86]="SimsApp",e[e.VivaOrgInsightsLowPrivilege=87]="VivaOrgInsightsLowPrivilege",e[e.VivaGoalsAppPop=88]="VivaGoalsAppPop",e[e.GCBotAppPop=89]="GCBotAppPop",e[e.ShredderV2App=90]="ShredderV2App",e[e.ShredderV2LowPrivilege=91]="ShredderV2LowPrivilege",e[e.AmplifyProfileService=92]="AmplifyProfileService",e[e.AzureDevopsLowPrivilege=93]="AzureDevopsLowPrivilege",e[e.CommuteServices=94]="CommuteServices",e[e.GCBotAppOnly=95]="GCBotAppOnly",e[e.TCAAppOnly=96]="TCAAppOnly",e[e.MavenAgentLowPrivilege=97]="MavenAgentLowPrivilege",e[e.VivaOrgInsightsAppPop=98]="VivaOrgInsightsAppPop",e[e.EduAssignmentsPftAtPop=99]="EduAssignmentsPftAtPop",e[e.AugloopAppPop=100]="AugloopAppPop",e[e.OneNoteLowPrivilege=101]="OneNoteLowPrivilege",e[e.TeamsAuthzSvcAppPop=102]="TeamsAuthzSvcAppPop",e[e.LoopAppPop=103]="LoopAppPop",e[e.LoopAppOnly=104]="LoopAppOnly",e[e.BapLowPrivilege=105]="BapLowPrivilege",e[e.IC3AppPop=106]="IC3AppPop",e[e.PowerPlatformApiGateway=107]="PowerPlatformApiGateway",e[e.OdspNotifyAppPop=108]="OdspNotifyAppPop",e[e.MIPSyncService=109]="MIPSyncService",e[e.RightsManagementServices=110]="RightsManagementServices",e[e.TCAV2AppPop=111]="TCAV2AppPop",e[e.SubstrateLLMLowPrivilege=112]="SubstrateLLMLowPrivilege",e[e.SubstrateSearchLowPrivilege=113]="SubstrateSearchLowPrivilege",e[e.CloudPolicyServiceAppPop=114]="CloudPolicyServiceAppPop",e[e.TCAV2LowPrivilege=115]="TCAV2LowPrivilege",e[e.AiHubServicesAppPop=116]="AiHubServicesAppPop",e[e.TMRAppOnly=117]="TMRAppOnly",e[e.PacmanAppPop=118]="PacmanAppPop",e[e.AugloopAlternativeIdentity=119]="AugloopAlternativeIdentity",e[e.SpoAppOnly=120]="SpoAppOnly",e[e.DataverseLowPrivilege=121]="DataverseLowPrivilege",e[e.SubstrateLLMApp=122]="SubstrateLLMApp",e[e.SimsAppOnly=123]="SimsAppOnly",e[e.PythonService=124]="PythonService",e[e.PythonServiceAppOnly=125]="PythonServiceAppOnly",e[e.DesignerAppServiceLowPrivilege=126]="DesignerAppServiceLowPrivilege",e[e.DesignerAppServiceAppPop=127]="DesignerAppServiceAppPop",e[e.AmplifyProfileServiceAppOnly=128]="AmplifyProfileServiceAppOnly",e[e.MARSAppPop=129]="MARSAppPop",e[e.PlannerAppPop=130]="PlannerAppPop",e[e.BingForBusinessLowPrivilege=131]="BingForBusinessLowPrivilege",e[e.OLS=132]="OLS",e[e.OLSAppPop=133]="OLSAppPop",e[e.GCS=134]="GCS",e[e.AugLoopConsumer=135]="AugLoopConsumer",e[e.ContentValidationServiceAppOnly=136]="ContentValidationServiceAppOnly",e[e.FabricLowPrivilege=137]="FabricLowPrivilege",e[e.FeatureAccessManagementAppPop=138]="FeatureAccessManagementAppPop",e[e.FireIntelligenceAppOnly=139]="FireIntelligenceAppOnly",e[e.MARSLowPrivilege=140]="MARSLowPrivilege",e[e.EXOAdminAppPop=141]="EXOAdminAppPop",e[e.IncomingAT=142]="IncomingAT",e[e.CopilotLabLowPrivilege=143]="CopilotLabLowPrivilege",e[e.VivaPulseLowPrivilege=144]="VivaPulseLowPrivilege",e[e.WacAppPop=145]="WacAppPop",e[e.PowerAppsAiBuilderLowPrivilege=146]="PowerAppsAiBuilderLowPrivilege",e[e.CognitiveApiAppOnly=147]="CognitiveApiAppOnly",e[e.CopilotMetricsAppOnly=148]="CopilotMetricsAppOnly",e[e.ShredderAppOnly=149]="ShredderAppOnly",e[e.TeamsAuthzSvcLowPrivilege=150]="TeamsAuthzSvcLowPrivilege",e[e.PlannerLowPrivilege=151]="PlannerLowPrivilege",e[e.VivaGlintLowPrivilege=152]="VivaGlintLowPrivilege",e[e.DiscoveryServiceAppPop=153]="DiscoveryServiceAppPop",e[e.PowerAppsOrchardLowPrivilege=154]="PowerAppsOrchardLowPrivilege",e[e.EduSkillingPlatformPftAtPop=155]="EduSkillingPlatformPftAtPop",e[e.IncomingPFTAppOnly=156]="IncomingPFTAppOnly",e[e.EduSkillingPlatformLowPrivilege=157]="EduSkillingPlatformLowPrivilege",e[e.MCPSAppOnly=158]="MCPSAppOnly",e[e.TeamsMiddleTierLowPrivilege=159]="TeamsMiddleTierLowPrivilege",e[e.SharePointESignatureAppPop=160]="SharePointESignatureAppPop",e[e.SparkContentPlatformAppOnly=161]="SparkContentPlatformAppOnly",e[e.LuminaLowPrivilege=162]="LuminaLowPrivilege",e[e.OfficeScriptsServiceAppPop=163]="OfficeScriptsServiceAppPop",e[e.OfficeScriptsServiceLowPrivilege=164]="OfficeScriptsServiceLowPrivilege"}(o||(o={})),function(e){e[e.Unknown=0]="Unknown",e[e.Consumer=1]="Consumer",e[e.Enterprise=2]="Enterprise"}(s||(s={})),function(e){e[e.Default=0]="Default",e[e.EDPSCompliant=1]="EDPSCompliant"}(r||(r={})),function(e){e.AuthorizationCode="authorization_code",e.ClientCredentials="client_credentials",e.RefreshToken="refresh_token"}(i||(i={})),function(e){e[e.LoggedIn=0]="LoggedIn",e[e.LoggedOut=1]="LoggedOut"}(a||(a={}))},52901:(e,t,n)=>{"use strict";var o;n.d(t,{q:()=>o}),function(e){e[e.error=0]="error",e[e.warn=1]="warn",e[e.info=3]="info",e[e.metric=4]="metric",e[e.verbose=5]="verbose",e[e.debug=6]="debug",e[e.disabled=7]="disabled"}(o||(o={}))},59456:(e,t,n)=>{"use strict";n.d(t,{tG:()=>b,nh:()=>L,OD:()=>E});var o,s=n(52901),r=n(196);!function(e){e.Log="Log"}(o||(o={}));const i="undefined"!=typeof process&&process.env?process.env.SERVICE_NAME:"client",a="abcdefghijklmnopqrstuvwxyz0123456789",l={97:0,98:1,99:2,100:3,101:4,102:5,103:6,104:7,105:8,106:9,107:10,108:11,109:12,110:13,111:14,112:15,113:16,114:17,115:18,116:19,117:20,118:21,119:22,120:23,121:24,122:25,48:26,49:27,50:28,51:29,52:30,53:31,54:32,55:33,56:34,57:35};let c,u=[],d=[],h=e=>null,p=e=>{};const f=new Map,g=new Map,m=new Map,y=new Map;var v,b;!function(e){e.Default="",e.EDPSCompliant="edps"}(v||(v={})),function(e){e.defineCoreLogCategory=e=>({root:"Core",name:e}),e.defineWorkflowLogCategory=e=>({root:"Workflow",name:e}),e.clearLoggers=()=>{u=[],d=[],g.clear(),m.clear()},e.clearAggregators=()=>{f.clear()},e.addLogger=e=>{-1===u.indexOf(e)&&(u.push(e),S(g,e))},e.addDecidingLogger=e=>{-1===d.indexOf(e)&&(d.push(e),S(m,e))},e.setCorrelationContextCallback=e=>{c=e},e.setStartPerformanceEventCallback=e=>{h=e},e.setStopPerformanceEventCallback=e=>{p=e},e.addAggregator=e=>{e.init(((e,t)=>{M(e,t)})),f.has(e.eventName)?f.get(e.eventName).push(e):f.set(e.eventName,[e])},e.flushAggregators=e=>{f.forEach((t=>{t.forEach((t=>t.flush(e)))}))},e.setTagLevelOverride=(e,t)=>{const n=N(e);y.set(n,t)},e.resetTagLevelOverrides=()=>{y.clear()},e.error=(e,t,n,o,r,i,a,l,c,u)=>{P(e,t,s.q.error,n,o,r,i,a,l,c,u)},e.warn=(e,t,n,o,r,i,a,l,c,u)=>{P(e,t,s.q.warn,n,o,r,i,a,l,c,u)},e.info=(e,t,n,o,r,i,a,l,c,u)=>{P(e,t,s.q.info,n,o,r,i,a,l,c,u)},e.verbose=(e,t,n,o,r,i,a,l,c,u)=>{P(e,t,s.q.verbose,n,o,r,i,a,l,c,u)},e.debug=(e,t,n,o,r,i,a,l,c,u)=>{P(e,t,s.q.debug,n,o,r,i,a,l,c,u)},e.metric=(e,t,n,o,r,i,a,l,c,u)=>{P(e,t,s.q.metric,n,o,r,i,a,l,c,u)},e.formatMetric=(e,t,n,o)=>{const s={};return s[e]={dimensionNames:n,dimensionValues:o,value:t},s},e.dynamic=e=>{M(e)}}(b||(b={}));const S=(e,t)=>{const n=t.level;Object.keys(s.q).map((e=>s.q[e])).filter((e=>"string"!=typeof e)).filter((e=>e<=n)).forEach((n=>{e.has(n)?e.get(n).push(t):e.set(n,[t])}))},w=e=>{if("string"==typeof e)return e;let t="";for(let n=0;n<e.length;n++){n>0&&(t+=" ");const o=e[n];o instanceof Error?t+=JSON.stringify({message:o.message,name:o.name,stack:o.stack}):t+="object"==typeof o?JSON.stringify(o):o}return t},T=e=>`${e.root}.${e.name}`,C=[],_=["Level","Tag"],k=["Level","Tag","Workflow"],E=e=>A(e).length,A=e=>void 0!==e?g.get(e)||C:u,I=(e,t)=>(void 0!==e?m.get(e)||[]:d).filter((e=>e.shouldLog(t))),P=(e,t,n,s,r,i,a,l,u,d,g)=>{n=y.get(e)||n;const m=A(n),v=I(n,s);if(0==m.length&&0==v.length)return;const b=h(o.Log),S=O(e),C=((e,t,n,o,s,r,i,a)=>{if(void 0===t&&("string"==typeof e||"object"==typeof e))return e;if(void 0===t&&"function"==typeof e)return e();const l=[];for(const c of[e,t,n,o,s,r,i,a])void 0!==c&&l.push("function"==typeof c?c():c);return l})(s,r,i,a,l,u,d,g);if(x(t))R(C)&&M({eventName:"Metrics",tagId:S,category:T(t),traceLevel:n,message:"",getMetrics:()=>C},!1,m,v);else if(R(C)){const e=C;e.tagId=S,e.category=T(t),"Operation"===e.eventName&&"Workflow"===t.root&&(e.eventName="WorkflowOperation",c&&(e.joinContextId=c().joinContextId,e.workflow=c().workflow)),e.traceLevel=n;const o=f.get(e.eventName);if(o)for(let t=0;t<o.length;++t){const n=o[t];if(n&&n.add(e,t===o.length-1))break}else M(e,!1,m,v)}else{const e=()=>{var e;return"Core"===t.root?{TraceEventV2:{dimensionNames:()=>_,dimensionValues:[String(n),S],value:1}}:{WorkflowTraceEvent:{dimensionNames:()=>k,dimensionValues:[String(n),S,c?null===(e=c())||void 0===e?void 0:e.workflow:""],value:1}}};M({eventName:"Log",tagId:S,category:T(t),traceLevel:n,message:w(C),getMetrics:e},!1,m,v)}p(b)},M=(e,t=!1,n,o)=>{var s,r,a,l,u,d,h,p,f,g,m,y,v,b;let S;if(null==n&&(n=A(e.traceLevel)),o=o||C,n.length>0||o.length>0){if(e.serviceName=i,!t&&c){const t=c();t&&(S={disableLogging:t.disableLogging,userDataBoundaryType:null===(r=null===(s=t.sessionDescriptor)||void 0===s?void 0:s.userContext)||void 0===r?void 0:r.userDataBoundaryType},e.cv=e.cv?e.cv:t.cv.toString(),e.sessionKey=e.sessionKey?e.sessionKey:t.sessionKey,e.userTenantId=e.userTenantId?e.userTenantId:t.userTenantId,e.workflow=e.workflow?e.workflow:t.workflow,e.clientAppName=e.clientAppName?e.clientAppName:null===(a=t.clientMetadata)||void 0===a?void 0:a.appName,e.clientAppPlatform=e.clientAppPlatform?e.clientAppPlatform:null===(l=t.clientMetadata)||void 0===l?void 0:l.appPlatform,e.clientAppVersion=e.clientAppVersion?e.clientAppVersion:null===(u=t.clientMetadata)||void 0===u?void 0:u.appVersion,e.clientDocSessionId=e.clientDocSessionId?e.clientDocSessionId:null===(d=t.clientMetadata)||void 0===d?void 0:d.docSessionId,e.clientReleaseAudienceGroup=e.clientReleaseAudienceGroup?e.clientReleaseAudienceGroup:null===(h=t.clientMetadata)||void 0===h?void 0:h.releaseAudienceGroup,e.clientReleaseChannel=e.clientReleaseChannel?e.clientReleaseChannel:null===(p=t.clientMetadata)||void 0===p?void 0:p.releaseChannel,e.clientReleaseFork=e.clientReleaseFork?e.clientReleaseFork:null===(f=t.clientMetadata)||void 0===f?void 0:f.releaseFork,e.clientRuntimeVersion=e.clientRuntimeVersion?e.clientRuntimeVersion:null===(g=t.clientMetadata)||void 0===g?void 0:g.runtimeVersion,e.clientSessionId=e.clientSessionId?e.clientSessionId:null===(m=t.clientMetadata)||void 0===m?void 0:m.sessionId,e.clientUserAgent=e.clientUserAgent?e.clientUserAgent:null===(y=t.clientMetadata)||void 0===y?void 0:y.userAgent,e.traceId=e.traceId||t.traceId,e.isClientTelemetrySampled=e.isClientTelemetrySampled?e.isClientTelemetrySampled:null===(v=t.clientMetadata)||void 0===v?void 0:v.isClientTelemetrySampled,e.userDataBoundaryType=D(S),e.ecsConfigIDs=null===(b=t.ecsConfigIDsManager)||void 0===b?void 0:b.getAllConfigIDsString())}for(const t of n)t.log(e,S);for(const t of o)t.log(e)}},x=e=>e.name===L.WorkflowMetricsOnly.name&&e.root===L.WorkflowMetricsOnly.root,R=e=>!Array.isArray(e)&&"object"==typeof e,D=e=>(null==e?void 0:e.userDataBoundaryType)===r.Om.EDPSCompliant?v.EDPSCompliant:v.Default,O=e=>a[e>>24&63]+a[e>>18&63]+a[e>>12&63]+a[e>>6&63]+a[63&e],N=e=>e&&5===e.length?l[e.charCodeAt(0)]<<24|l[e.charCodeAt(1)]<<18|l[e.charCodeAt(2)]<<12|l[e.charCodeAt(3)]<<6|l[e.charCodeAt(4)]:-1;class L{}L.CoreDefault=b.defineCoreLogCategory("Default"),L.CoreSystem=b.defineCoreLogCategory("System"),L.CoreUnsampled=b.defineCoreLogCategory("Unsampled"),L.WorkflowDefault=b.defineWorkflowLogCategory("Default"),L.WorkflowUnsampled=b.defineWorkflowLogCategory("Unsampled"),L.WorkflowMetricsOnly=b.defineWorkflowLogCategory("MetricsOnly"),L.PrivacyGuardEvent=b.defineCoreLogCategory("PrivacyGuardEvent")},75913:(e,t,n)=>{"use strict";n.d(t,{t:()=>o});const o="undefined"!=typeof process&&process.hrtime?()=>{const e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:"undefined"!=typeof performance&&performance.now?()=>performance.now():()=>Date.now();"undefined"!=typeof process&&process.hrtime||"undefined"!=typeof performance&&performance.now},68279:(e,t,n)=>{"use strict";n.d(t,{I:()=>c});var o={util:{},roots:{default:{}}},s=(o.util,o.roots.default||(o.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.count=0,e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.durationMs=0,e.prototype.success=!1,e.prototype.resultDescription="",e.prototype.resultJSON="",e.prototype.resultSignature="",e.prototype.operationName="",e.prototype.resourceId="",e.prototype.dimension0="",e.prototype.dimension1="",e.prototype.dimension2="",e.prototype.dimension3="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.joinContextId="",e.prototype.ariaTenant="",e.prototype.ariaNamespace="",e.prototype.dataFields="",e.prototype.userDataBoundaryType="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/OperationEvent"},e}()),r=n(75913);const i=Symbol("dataFieldsObject"),a=Symbol("dataFieldsAreDirty"),l=Symbol("_dataFields");class c extends s{constructor(e,t){super(e),this.eventName="Operation",this.options=t,this.durationMs=null==e?void 0:e.durationMs,e&&null!=e.count||(this.count=1),(null==e?void 0:e.dataFields)&&(this.dataFields=e.dataFields)}setClientMetadata(e,t){return e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,null!=t&&t||(this.clientFlights=e.flights),this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientReleaseChannel=e.releaseChannel,this.clientReleaseFork=e.releaseFork,this.clientRuntimeVersion=e.runtimeVersion,this.clientSessionId=e.sessionId,this.clientDocSessionId=e.docSessionId,this.clientUserAgent=e.userAgent),this}setUserContext(e){return e&&(this.userId=e.puid||e.oid,this.userType=e.userType&&e.userType.toString(),this.userTenantId=e.tid),this}setMetricCustomDimensions(e,t){if(!this.options)throw new Error(`Attempting to set custom dimensions ${e} to operation ${this.operationName} without activating MetricCount or MetricDuration`);this.options.metricCustomDimensions=this.options.metricCustomDimensions||{},this.options.metricCustomDimensions[e]=t}setDataField(e,t){this[i]||(this[i]={}),this[i][e]=t,this[a]=!0}setDataFields(e){this[i]||(this[i]={}),this[i]=Object.assign(Object.assign({},this[i]),e),this[a]=!0}start(){return this.startTime=(0,r.t)(),this}recordStep(e){return this.setDataField(e,Math.floor((0,r.t)()-this.startTime)),this}stop(){const e=(0,r.t)();return this.durationMs=Math.round(e-this.startTime),this}addCustomMetric(e){void 0===this.customMetrics&&(this.customMetrics=[]),this.customMetrics.push(e)}getCustomMetrics(){const e=[];if(void 0!==this.customMetrics){const t=e=>[...this.getDimensionNames(),...e.extraDimensions.map((e=>e.name))];for(const n of this.customMetrics){const o={};o[`${this.operationName}.${n.nameSuffix}`]={dimensionNames:()=>t(n),dimensionValues:[...this.getDimensionValues(),...n.extraDimensions.map((e=>e.value))],value:n.value},e.push(o)}}return e}getMetrics(e){var t,n;const o={};if(this.operationName)switch(this.operationName){case"SessionHealthOrphanedEventsWithoutProperSessionKey":case"SessionHealthOrphanedSessions":case"WorkflowActivationState":o[this.operationName+".CountV2"]={dimensionNames:c.getOrphanedSessionHealthDimensionNames.bind(c),dimensionValues:this.getOrphanedSessionHealthDimensionValues(),value:this.count};break;case"MarkUnhealthySession":case"MarkHealthWarningSession":o[this.operationName+".Reason"]={dimensionNames:c.getSessionHealthDimensionNames.bind(c),dimensionValues:this.getSessionHealthDimensionValues(),value:1};break;default:if("matchmaker_timer"===this.operationName&&(o["Workflow.DurationMs"]={dimensionNames:c.getWorkflowDimensionNames.bind(c),dimensionValues:this.getWorkflowDimensionValues(),value:this.durationMs||0},o["Workflow.Count"]={dimensionNames:c.getWorkflowDimensionNames.bind(c),dimensionValues:this.getWorkflowDimensionValues(),value:1}),void 0!==this.durationMs){const n=`${this.operationName}.DurationMsV2`;((null===(t=this.options)||void 0===t?void 0:t.metricDuration)||e.indexOf(n)>=0)&&(o[n]={dimensionNames:this.getDimensionNames.bind(this),dimensionValues:this.getDimensionValues(),value:this.durationMs})}{const t=`${this.operationName}.CountV2`;((null===(n=this.options)||void 0===n?void 0:n.metricCount)||e.indexOf(t)>=0)&&(o[t]={dimensionNames:this.getDimensionNames.bind(this),dimensionValues:this.getDimensionValues(),value:this.count})}}return o}getDimensionNames(){var e,t;let n=c.dimensionNames;if(null===(e=this.options)||void 0===e?void 0:e.metricCustomDimensions){n=n.slice();for(const e in null===(t=this.options)||void 0===t?void 0:t.metricCustomDimensions)n.push(e)}return n}getDimensionValues(){var e,t;const n=[this.success,this.clientAppName,this.clientAppPlatform,this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3];if(null===(e=this.options)||void 0===e?void 0:e.metricCustomDimensions)for(const e in null===(t=this.options)||void 0===t?void 0:t.metricCustomDimensions)n.push(this.options.metricCustomDimensions[e]);return n}static getOrphanedSessionHealthDimensionNames(){return this.orphanedSessionHealthDimensionNames}getOrphanedSessionHealthDimensionValues(){return[this.success,this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}static getSessionHealthDimensionNames(){return this.sessionHealthDimensionNames}getSessionHealthDimensionValues(){return[this.resultSignature,this.clientAppName,this.clientAppPlatform,this.clientAppVersion,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}static getWorkflowDimensionNames(){return this.workflowDimensionNames}getWorkflowDimensionValues(){return[this.resultSignature,this.resourceId,this.resourceId,this.success]}}c.dimensionNames=["Success","ClientAppName","ClientAppPlatform","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"],c.orphanedSessionHealthDimensionNames=["Success","ClientAppName","ClientAppPlatform","ClientReleaseAudienceGroup","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"],c.sessionHealthDimensionNames=["Reason","ClientAppName","ClientAppPlatform","ClientAppVersion","Dimension0","Dimension1","Dimension2","Dimension3"],c.workflowDimensionNames=["ResultSignature","WorkflowId","ResourceId","Success"],Object.defineProperty(c.prototype,"dataFields",{get:function(){var e,t;return this[a]&&(this[l]=JSON.stringify(null!==(e=this[i])&&void 0!==e?e:{}),this[a]=!1),void 0!==this[a]?this[l]:null!==(t=this[l])&&void 0!==t?t:""},set:function(e){this[i]=e&&""!==e?JSON.parse(e):{},this[l]=e,this[a]=!1},enumerable:!0,configurable:!0})},87234:(e,t,n)=>{"use strict";var o;n.r(t),n.d(t,{ALFactoryGlobal:()=>sr,Alignment:()=>hr,AsyncClientRequestBuilder:()=>M,AugLoopFactory:()=>or,AugLoopRuntimeManager:()=>Js,AugLoopStandardSchema:()=>vr,AuthTokenResponseError:()=>At,CapsType:()=>lr,CrudAugLoopStandardSchema:()=>br,DataObject:()=>mr,FontWeight:()=>ur,FormattedSpan:()=>pr,IdentityProvider:()=>kt,Lambda:()=>gr,LambdaException:()=>yr,ListType:()=>dr,MockAugLoopRuntimeManager:()=>Sr,ServerAuthenticationState:()=>Te.f,TextTile:()=>fr,Tile:()=>rr,Tile$1:()=>ir,TileType:()=>ar,UnderlineType:()=>cr}),function(e){e[e.SingleAnnotation=0]="SingleAnnotation",e[e.Streaming=1]="Streaming",e[e.CustomMessage=2]="CustomMessage"}(o||(o={}));var s=n(90687);class r{constructor(){this._fulfilled=!1,this.completion=new Promise(((e,t)=>{this.onResolve=e,this.onReject=t}))}resolve(e){this._fulfilled=!0,this.onResolve(e)}reject(e){this._fulfilled=!0,this.onReject(e)}get fulfilled(){return this._fulfilled}}class i extends Error{constructor(e){super(e),Object.setPrototypeOf(this,i.prototype)}}class a extends Error{constructor(e){super(e),Object.setPrototypeOf(this,a.prototype)}}class l extends Error{constructor(e,t){super(e),Object.setPrototypeOf(this,l.prototype),this.erroInfo=t}}class c extends Error{constructor(e){super(e),Object.setPrototypeOf(this,c.prototype)}}class u extends Error{constructor(e){super(e),Object.setPrototypeOf(this,u.prototype)}}Error;class d{executeAfter(e,t){let n=setTimeout((()=>{n=null,e()}),t);return()=>{null!==n&&(clearTimeout(n),n=null)}}}const h=new d;class p{constructor(){this._isCancellationRequested=!1,this.onCancelCallbacks=[]}cancel(){if(!this._isCancellationRequested){this._isCancellationRequested=!0;for(const e of this.onCancelCallbacks)e(this);this.onCancelCallbacks=[]}}get IsCancellationRequested(){return this._isCancellationRequested}onCancel(e){this._isCancellationRequested?e(this):this.onCancelCallbacks.push(e)}rejectWhenCancellationRequested(){return new Promise(((e,t)=>{this.onCancel((()=>t(new i("Token cancelled"))))}))}removeCancelCallback(e){const t=this.onCancelCallbacks.indexOf(e);t>-1&&this.onCancelCallbacks.splice(t,1)}dispose(){this.onCancelCallbacks=[]}}class f{constructor(e){this.internalToken=new p,this.clearScheduledCancel=null,this.scheduler=null!=e?e:h}get token(){return this.internalToken}cancel(){var e;this.internalToken.IsCancellationRequested||(this.internalToken.cancel(),null===(e=this.clearScheduledCancel)||void 0===e||e.call(this))}cancelAfter(e){var t;if(this.token.IsCancellationRequested)return;if(e<0)throw new Error("Duration can not be negative");null===(t=this.clearScheduledCancel)||void 0===t||t.call(this);const n=this.scheduler.executeAfter((()=>{this.cancel(),this.clearScheduledCancel=null}),e);this.clearScheduledCancel=()=>{n(),this.clearScheduledCancel=null}}dispose(){var e;this.internalToken&&(null===(e=this.clearScheduledCancel)||void 0===e||e.call(this),this.internalToken.dispose(),this.internalToken=null)}}class g{constructor(...e){this.innerCancelSource=new f,this.unsubscribeFromTokens=null,this.onLinkedTokenCancelled=()=>{var e;this.innerCancelSource.cancel(),null===(e=this.unsubscribeFromTokens)||void 0===e||e.call(this)},this.subscribeToTokens(e)}get token(){return this.innerCancelSource.token}dispose(){var e;null===(e=this.unsubscribeFromTokens)||void 0===e||e.call(this)}subscribeToTokens(e){e.some((e=>e.IsCancellationRequested))?this.innerCancelSource.cancel():(e.forEach((e=>e.onCancel(this.onLinkedTokenCancelled))),this.unsubscribeFromTokens=()=>{this.unsubscribeFromTokens=null,e.forEach((e=>e.removeCancelCallback(this.onLinkedTokenCancelled)))})}}class m{constructor(e,t,n){this.scheduler=e,this.callerCancelToken=t,this.timeoutMs=n}runWithCombinedToken(e){return t=this,n=void 0,s=function*(){const t=new f(this.scheduler),n=new g(this.callerCancelToken,t.token);try{return void 0!==this.timeoutMs&&t.cancelAfter(this.timeoutMs),yield e(n.token)}catch(e){if(e instanceof i&&!this.callerCancelToken.IsCancellationRequested&&t.token.IsCancellationRequested)throw new a(`strategy timeout: ${this.timeoutMs}`);throw e}finally{n.dispose(),t.dispose()}},new((o=void 0)||(o=Promise))((function(e,r){function i(e){try{l(s.next(e))}catch(e){r(e)}}function a(e){try{l(s.throw(e))}catch(e){r(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(i,a)}l((s=s.apply(t,n||[])).next())}));var t,n,o,s}}class y{constructor(e,t){this.value=null,this.error=null,this.value=e,this.error=t}static createValue(e){return new y(e,null)}static createError(e){return new y(null,e)}isError(){return null!==this.error}}class v{constructor(){this.items=[],this.pendingDequeuePromise=null}enqueue(e){var t;this.items.push(y.createValue(e)),null===(t=this.pendingDequeuePromise)||void 0===t||t.resolve()}enqueueError(e){var t;this.items.push(y.createError(e)),null===(t=this.pendingDequeuePromise)||void 0===t||t.resolve()}dequeue(e){return t=this,n=void 0,s=function*(){if(0===this.items.length){if(this.pendingDequeuePromise)throw new Error("Cannot have simultaneous dequeues");this.pendingDequeuePromise=new r;try{yield Promise.race([this.pendingDequeuePromise.completion,e.rejectWhenCancellationRequested()])}finally{this.pendingDequeuePromise=null}}return this.items.shift()},new((o=void 0)||(o=Promise))((function(e,r){function i(e){try{l(s.next(e))}catch(e){r(e)}}function a(e){try{l(s.throw(e))}catch(e){r(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(i,a)}l((s=s.apply(t,n||[])).next())}));var t,n,o,s}empty(){return 0===this.items.length}}var b=n(59456),S=function(e,t,n,o){return new(n||(n=Promise))((function(s,r){function i(e){try{l(o.next(e))}catch(e){r(e)}}function a(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))};class w{constructor(e,t,n,o){this.operation=e,this.params=t,this.timeout=n,this.cv=o}build(){var e;return{type:o.Streaming,operation:this.operation,cv:this.cv,firstAnnotationTimeoutMs:null!==(e=this.timeout.firstAnnotationTimeoutMs)&&void 0!==e?e:void 0,perAnnotationTimeoutMs:this.timeout.perAnnotationTimeoutMs,chunks:this.params.chunks,completion:this.params.completion}}}class T{constructor(e,t,n,o,s){this.session=e,this.request=t,this.cancelToken=n,this.scheduler=o,this.logOp=s,this.logOp.resourceId="StreamingRequest"}execute(){return S(this,void 0,void 0,(function*(){const e=this.request.firstAnnotationTimeoutMs?Math.min(this.request.firstAnnotationTimeoutMs,this.request.perAnnotationTimeoutMs):this.request.perAnnotationTimeoutMs,t={annotationType:[this.request.chunks.getTypeName(),this.request.completion.getTypeName()],transientItems:this.request.operation.items.map((e=>Object.assign(Object.assign({},e),{parentPath:this.request.operation.parentPath}))),maxDelayMs:e,sourceInfo:{}},n=this.session.getAnnotations(t,this.cancelToken),o=new v,s=new C(n,this.scheduler,this.cancelToken,this.request,o,this.logOp);return s.initialize().catch((e=>{o.enqueueError(e)})),Promise.resolve(s)}))}}class C{constructor(e,t,n,o,s,i){this.iterable=e,this.scheduler=t,this.cancelToken=n,this.request=o,this.queue=s,this.logOp=i,this.completionPromise=new r,this.complete=!1,this.isFirstAnnotation=!0}subscribeResults(e){var t,n,o,s,r,i,a;return S(this,void 0,void 0,(function*(){try{try{for(t=!0,n=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(n){t[n]=e[n]&&function(t){return new Promise((function(o,s){!function(e,t,n,o){Promise.resolve(o).then((function(t){e({value:t,done:n})}),t)}(o,s,(t=e[n](t)).done,t.value)}))}}}(e);o=yield n.next(),!(s=o.done);t=!0){a=o.value,t=!1;const e=a;if(this.completionPromise.fulfilled)break;this.onGetAnnotationResponse(e)}}catch(e){r={error:e}}finally{try{t||s||!(i=n.return)||(yield i.call(n))}finally{if(r)throw r.error}}}catch(e){this.queue.enqueueError(e)}}))}initialize(){return S(this,void 0,void 0,(function*(){return this.subscribeResults(this.iterable)}))}onGetAnnotationResponse(e){if(e.error)throw new l(JSON.stringify(e.error),e.error);const t=e.content.map((e=>e.body));for(const e of t)this.isFirstAnnotation&&(this.isFirstAnnotation=!1),this.queue.enqueue(e);e.finalResponse&&(this.complete=!0)}[Symbol.asyncIterator](){return this}get chunks(){return this}get completion(){return this.completionPromise.completion}next(){return S(this,void 0,void 0,(function*(){try{const e=this.request.firstAnnotationTimeoutMs&&this.request.firstAnnotationTimeoutMs?this.request.firstAnnotationTimeoutMs:this.request.perAnnotationTimeoutMs,t=new m(this.scheduler,this.cancelToken,e),n=yield t.runWithCombinedToken(this.waitForNextEvent.bind(this)),{value:o}=n;return n.isError()?this.handleError(n.error):this.complete&&this.queue.empty()?this.request.completion.typeGuard(o)?(this.completionPromise.resolve(o),this.handleFinalResult(o)):this.handleError(new c(`(Streaming completion) expect: ${this.request.completion.getTypeName()}, received: ${s.h.getTypeNameFor(o)}`)):this.request.chunks.typeGuard(o)?{done:!1,value:o}:this.handleError(new c(`(Streaming chunks) expect: ${this.request.chunks.getTypeName()}, received: ${s.h.getTypeNameFor(o)}`))}catch(e){return this.handleError(e)}}))}handleError(e){return this.completionPromise.reject(e),this.logOp.success=!1,this.logOp.resultDescription=`[name, message, stack]: [${e.name}, ${e.message}, ${e.stack}]`,this.handleFinalResult(e)}handleFinalResult(e){return b.tG.info(505427165,b.nh.CoreDefault,this.logOp.stop()),{done:!0,value:e}}waitForNextEvent(e){return S(this,void 0,void 0,(function*(){return yield this.queue.dequeue(e)}))}}var _=function(e,t,n,o){return new(n||(n=Promise))((function(s,r){function i(e){try{l(o.next(e))}catch(e){r(e)}}function a(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))};class k{constructor(e,t,n,o){this.operation=e,this.annotation=t,this.timeoutMs=n,this.cv=o}build(){return{type:o.SingleAnnotation,operation:this.operation,cv:this.cv,annotation:this.annotation,timeoutMs:this.timeoutMs}}}class E{constructor(e,t,n,o,s){this.session=e,this.request=t,this.cancelToken=n,this.scheduler=o,this.logOp=s,this.completionPromise=new r,this.logOp.resourceId="SingleAnnotationRequest"}execute(){return _(this,void 0,void 0,(function*(){try{const e=new m(this.scheduler,this.cancelToken,this.request.timeoutMs);return yield e.runWithCombinedToken(this.executeOnAnnotation.bind(this))}catch(e){throw this.logOp.success=!1,this.logOp.resultDescription=`[name, message, stack]: [${e.name}, ${e.message}, ${e.stack}]`,e}finally{b.tG.info(505427166,b.nh.CoreDefault,this.logOp.stop())}}))}executeOnAnnotation(e){return _(this,void 0,void 0,(function*(){try{const t={annotationType:[this.request.annotation.getTypeName()],transientItems:this.request.operation.items.map((e=>Object.assign(Object.assign({},e),{parentPath:this.request.operation.parentPath}))),maxDelayMs:this.request.timeoutMs,sourceInfo:{}},n=this.session.getAnnotations(t,e);return yield Promise.race([this.subscribeAnnotations(n),e.rejectWhenCancellationRequested()])}catch(e){throw e}}))}subscribeAnnotations(e){var t,n,o,r,i,a,d;return _(this,void 0,void 0,(function*(){try{for(t=!0,n=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(n){t[n]=e[n]&&function(t){return new Promise((function(o,s){!function(e,t,n,o){Promise.resolve(o).then((function(t){e({value:t,done:n})}),t)}(o,s,(t=e[n](t)).done,t.value)}))}}}(e);o=yield n.next(),!(r=o.done);t=!0){d=o.value,t=!1;const e=d;if(e.error){this.completionPromise.reject(new l(JSON.stringify(e.error),e.error));break}const n=e.content.map((e=>e.body));1==n.length?this.request.annotation.typeGuard(n[0])?this.completionPromise.resolve(n[0]):this.completionPromise.reject(new c(`(SingleAnnotation) expect: ${this.request.annotation.getTypeName()}, received: ${s.h.getTypeNameFor(n[0])}`)):this.completionPromise.reject(new u(`Number of annotations received: ${n.length}`));break}}catch(e){i={error:e}}finally{try{t||r||!(a=n.return)||(yield a.call(n))}finally{if(i)throw i.error}}return this.completionPromise.completion}))}}var A=function(e,t,n,o){return new(n||(n=Promise))((function(s,r){function i(e){try{l(o.next(e))}catch(e){r(e)}}function a(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))};class I{constructor(e,t,n){this.message=e,this.responseType=t,this.timeoutMs=n}build(){return{type:o.CustomMessage,message:this.message,responseType:this.responseType,timeoutMs:this.timeoutMs}}}class P{constructor(e,t,n,o,s){this.session=e,this.request=t,this.cancelToken=n,this.scheduler=o,this.logOp=s,this.logOp.resourceId="CustomMessageRequest"}execute(){return A(this,void 0,void 0,(function*(){try{const e=new m(this.scheduler,this.cancelToken,this.request.timeoutMs);return yield e.runWithCombinedToken(this.executeOnAnnotation.bind(this))}catch(e){throw this.logOp.success=!1,this.logOp.resultDescription=`[name, message, stack]: [${e.name}, ${e.message}, ${e.stack}]`,e}finally{b.tG.info(505427164,b.nh.CoreDefault,this.logOp.stop())}}))}executeOnAnnotation(e){return A(this,void 0,void 0,(function*(){return yield Promise.race([this.submitRequest(),e.rejectWhenCancellationRequested()])}))}submitRequest(){return A(this,void 0,void 0,(function*(){const e=yield this.session.submitCustomMessage(this.request.message);if(!this.request.responseType.typeGuard(e))throw new c(`Response type do not match. Actual: ${s.h.getTypeNameFor(e)}, Expected: ${this.request.responseType}`);return e}))}}class M{constructor(){}static forOperation(e,t){return new x(e,t)}static forMessage(e){return new R(e)}}class x{constructor(e,t){this.op=e,this.cv=t}withSingleAnnotation(e,t){return new k(this.op,e,t,this.cv)}withStreaming(e,t){return new w(this.op,e,t,this.cv)}}class R{constructor(e){this.message=e}withResponse(e,t){return new I(this.message,e,t)}}var D,O,N=n(52901),L=n(68279);function F(){return"xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}function B(e){if(!e)return new U([],new Set,new Map,new Map);const t=e.split(";"),n=new Set,o=new Map,s=new Map;for(const e of t){const t=e.trim();if(""===t)continue;n.add(U.normalizeName(t));const[r,...i]=t.split(":"),a=i.join(":"),l=U.normalizeName(r);if(l){o.set(l,a);const e=U.parseName(l);e&&e!==l&&s.set(e,l)}}return new U(t,n,o,s)}function W(e){if(!e)return"";const t=new Set,n=[];for(const o of e.split(";").reverse()){const e=o.split(":")[0],s=U.normalizeName(e);t.has(s)||(t.add(s),n.push(o))}return n.reverse().join(";")}!function(e){e[e.JSWebSockets=0]="JSWebSockets",e[e.LocalWorkflowsOnly=1]="LocalWorkflowsOnly",e[e.HostWebSockets=2]="HostWebSockets",e[e.HttpFallback=3]="HttpFallback"}(D||(D={})),function(e){e.Workflow="Workflow",e.Client="Client",e.HttpEndpoint="HttpEndpoint"}(O||(O={}));class U{constructor(e,t,n,o){this.originalFlights=e,this.normalizedFlights=t,this.keyValueFlightsMap=n,this.parsedFlightsMap=o}static normalizeName(e){return null==e?void 0:e.toLowerCase()}static parseName(e){const t=null==e?void 0:e.split(".");return t?t[t.length-1]:void 0}hasFlight(e){const t=U.normalizeName(e),n=this.normalizedFlights.has(t),o=this.keyValueFlightsMap.has(t),s=this.parsedFlightsMap.has(t);return n||o||s}getBooleanValue(e,t){var n,o;const s=null===(n=this.getStringValue(e))||void 0===n?void 0:n.toLowerCase(),r=null===(o=this.getStringValue(this.parsedFlightsMap.get(U.normalizeName(e))))||void 0===o?void 0:o.toLowerCase();return"true"===s||"true"===r||"false"!==s&&"false"!==r&&t}getIntValue(e,t){const n=this.getStringValue(e),o=Number.parseInt(n,10);return Number.isNaN(o)?t:o}getStringValue(e,t){var n;return null!==(n=this.keyValueFlightsMap.get(U.normalizeName(e)))&&void 0!==n?n:t}getAll(){return this.originalFlights}getAllParsed(){const e=[];return this.keyValueFlightsMap.forEach(((t,n)=>{const o=null==t?void 0:t.toLowerCase();switch(o){case"true":e.push({name:n,value:!0});break;case"false":e.push({name:n,value:!1});break;default:{const s=Number.parseInt(o,10);Number.isNaN(s)?e.push({name:n,value:t}):e.push({name:n,value:s})}}})),e}}class G{constructor(e=500,t=!1){this.prevSeq=-1,this.bufferingTimeMs=e,this.rejectOutdatedSequenceNumbers=t}sequence(e){return new Promise(((t,n)=>{if(e<this.prevSeq){if(this.rejectOutdatedSequenceNumbers){const t=new Error(`BufferingSequencer: Item out of order. Expecting seqId > ${this.prevSeq}. Actual seqId ${e}`);return t.name=G.Rejected,void n(t)}this.prevSeq=-1}e!=this.prevSeq+1&&b.tG.warn(542712385,b.nh.CoreDefault,`BufferingSequencer: got out of order sequence number. Got ${e}, expected ${this.prevSeq+1}`);const o={seq:e,resolve:t};this.insertItem(o),this.runInOrder(o,!0,!1)}))}insertItem(e){if(!this.firstQueueItem)return this.firstQueueItem=e,void(this.lastQueueItem=e);let t=this.lastQueueItem,n=null;do{if(e.seq>t.seq)return e.prev=t,t.next=e,void(n?(n.prev=e,e.next=n):this.lastQueueItem=e);n=t,t=t.prev}while(t);n&&(n.prev=e),e.next=n,this.firstQueueItem=e}runInOrder(e,t,n){let o=this.prevSeq,s=!1;const r=[];for(;this.firstQueueItem;){const t=this.firstQueueItem;if(o+1!=t.seq&&(!n||t.seq>e.seq))break;o=t.seq,t.timeout&&clearTimeout(t.timeout),r.push(t),e==t&&(s=!0),this.firstQueueItem=this.firstQueueItem.next,this.firstQueueItem&&(this.firstQueueItem.prev=null)}r.length>0&&setTimeout((()=>{for(const e of r)e.resolve(e.seq)}),0),this.prevSeq=o,!s&&t&&(e.timeout=setTimeout((()=>{this.runInOrder(e,!1,!0)}),this.bufferingTimeMs))}}G.Rejected="SequenceItemRejected";class H{constructor(e=500){this.bufferingTimeMs=500,this.workflowIdToSequencersMap=new Map,this.bufferingTimeMs=e}create(e){if(!e.ownerId)return null;let t=this.workflowIdToSequencersMap.get(e.ownerId);return t||(t=new G(this.bufferingTimeMs),this.workflowIdToSequencersMap.set(e.ownerId,t)),t}}class q{constructor(e=500,t){this.sequencerFactory=null!=t?t:new H(e)}sequence(e){var t,n,o,s,r;return n=this,o=void 0,r=function*(){if(null==(null===(t=null==e?void 0:e.M_)||void 0===t?void 0:t.seq))return;const n=this.sequencerFactory.create(e);n&&(yield n.sequence(e.M_.seq))},new((s=void 0)||(s=Promise))((function(e,t){function i(e){try{l(r.next(e))}catch(e){t(e)}}function a(e){try{l(r.throw(e))}catch(e){t(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof s?n:new s((function(e){e(n)}))).then(i,a)}l((r=r.apply(n,o||[])).next())}))}}class ${constructor(e){this.annotationSequencer=null!=e?e:new q}process(e,t,n,o){const s=[];for(const o of e.ops){const r=[];if(null==o?void 0:o.items)for(const e of o.items){const n=this.annotationSequencer.sequence(e.body).then((()=>{t(o,e)}));r.push(n)}s.push(Promise.all(r).then((()=>{n(o,e.cv)})))}Promise.all(s).then((()=>o(e)))}}class V{process(e,t,n,o){for(const o of e.ops){if(null==o?void 0:o.items)for(const e of o.items)t(o,e);n(o,e.cv)}o(e)}}class z{constructor(e,t,n){this.isOrderingEnabled=e,this.orderedAnnotationResultsProcessor=null!=t?t:new $,this.unorderedAnnotationResultsProcessor=null!=n?n:new V}process(e,t,n,o){this.isOrderingEnabled()?this.orderedAnnotationResultsProcessor.process(e,t,n,o):this.unorderedAnnotationResultsProcessor.process(e,t,n,o)}}var j=function(e,t,n,o){return new(n||(n=Promise))((function(s,r){function i(e){try{l(o.next(e))}catch(e){r(e)}}function a(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))};class Q{constructor(e,t){this.changeGatesInitialized=!1,this.hostCallbacks=e,this.changeGateMap=t||new Map}init(){return j(this,void 0,void 0,(function*(){const e=[];this.hostCallbacks&&this.hostCallbacks.isChangeGateEnabled&&this.changeGateMap.forEach(((t,n)=>{e.push(this.hostCallbacks.isChangeGateEnabled(n).then((e=>{this.changeGateMap.set(n,e)})))})),yield Promise.all(e).then((()=>{this.changeGatesInitialized=!0})).catch((e=>{}))}))}isFeatureEnabled(e,t=!1,n="None"){return this.hostCallbacks&&this.hostCallbacks.isFeatureEnabled?this.hostCallbacks.isFeatureEnabled(e,n).catch((()=>Promise.resolve(t))):Promise.resolve(t)}isChangeGateEnabled(e){var t;return j(this,void 0,void 0,(function*(){return!this.changeGateMap||(this.changeGatesInitialized&&this.changeGateMap.has(e)?this.changeGateMap.get(e):!(!this.changeGatesInitialized&&(null===(t=this.hostCallbacks)||void 0===t?void 0:t.isChangeGateEnabled))||(yield this.hostCallbacks.isChangeGateEnabled(e)))}))}isChangeGateEnabledSync(e){var t;if(!this.changeGatesInitialized&&(null===(t=this.hostCallbacks)||void 0===t?void 0:t.isChangeGateEnabled)){const t=new L.I({operationName:"GateUtilsNotInitialized",success:!1,resultDescription:`${e}`});b.tG.error(505529628,b.nh.CoreDefault,t)}return!this.changeGateMap||!this.changeGatesInitialized||!this.changeGateMap.has(e)||this.changeGateMap.get(e)}isChangeGatesInitialized(){return this.changeGatesInitialized}getChangeGateMap(){return this.changeGateMap}}var J,K,Y,X,Z,ee,te,ne,oe,se,re,ie,ae,le,ce,ue,de=n(7703),he=n(90268),pe=n(80993),fe=n(23008),ge=n(85555);!function(e){e[e.SingleItem=0]="SingleItem",e[e.Reduce=1]="Reduce",e[e.Grid=2]="Grid",e[e.DynamicText=3]="DynamicText",e[e.Join=4]="Join",e[e.Generic=5]="Generic"}(J||(J={})),function(e){e.Default="Default",e.Copilot="Copilot"}(K||(K={})),function(e){e[e.None=0]="None",e[e.ContentFiltering_M365Copilot=1]="ContentFiltering_M365Copilot"}(Y||(Y={})),function(e){e[e.Default=0]="Default",e[e.LocalOnly=1]="LocalOnly",e[e.Exclusive=2]="Exclusive"}(X||(X={})),function(e){e[e.PreActivate=0]="PreActivate",e[e.Default=1]="Default",e[e.DelayActivate=1]="DelayActivate",e[e.NeverActivate=2]="NeverActivate"}(Z||(Z={})),(ue=ee||(ee={}))[ue.Required=-3]="Required",ue[ue.Optional=-1]="Optional",(ce=te||(te={}))[ce.Never=0]="Never",ce[ce.Always=1]="Always",function(e){e[e.PreSeed=1]="PreSeed",e[e.OnSeed=2]="OnSeed",e[e.PostSeed=4]="PostSeed",e[e.All=5]="All"}(ne||(ne={})),(le=oe||(oe={}))[le.UpstreamWorkflowsReady=0]="UpstreamWorkflowsReady",le[le.AnnotationMetadataUpdated=1]="AnnotationMetadataUpdated",le[le.DeltaUpdate=2]="DeltaUpdate",le[le.NonExclusiveTriggerSignals=3]="NonExclusiveTriggerSignals",function(e){e[e.Character=1]="Character",e[e.Paragraph=2]="Paragraph"}(se||(se={})),function(e){e.Input="Input",e.Delta="Delta",e.UILanguage="UILanguage",e.MaxInputCount="MaxInputCount",e.ExtensionLimits="ExtensionLimits"}(re||(re={})),function(e){e.SetPredefinedAnnotation="SetPredefinedAnnotation",e.ClearAnnotations="ClearAnnotations"}(ie||(ie={})),function(e){e[e.JoinContext=0]="JoinContext",e[e.Session=1]="Session"}(ae||(ae={})),Error;var me={util:{},roots:{default:{}}},ye=(me.util,me.roots.default||(me.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.sessionKey="",e.prototype.annotationType="",e.prototype.annotationState=0,e.prototype.workflowId="",e.prototype.traceId="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/AnnotationMetaDataChangeEvent"},e}());class ve extends ye{constructor(e){super(e),this.eventName="AnnotationMetaDataChange"}}var be,Se,we,Te=n(51929),Ce=n(84166);class _e{constructor(e){s.h.assign(_e,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_WorkflowRegistrationMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return s.h.matchesTypesFor(e,[_e.getTypeName()])}}_e.H_={T_:_e.getTypeName(),B_:_e.getBaseTypes()};class ke{constructor(e){s.h.assign(ke,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionRequest"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return s.h.matchesTypesFor(e,[ke.getTypeName()])}}ke.H_={T_:ke.getTypeName(),B_:ke.getBaseTypes()};class Ee{constructor(e){s.h.assign(Ee,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowCancellationRequest"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return s.h.matchesTypesFor(e,[Ee.getTypeName()])}}Ee.H_={T_:Ee.getTypeName(),B_:Ee.getBaseTypes()};class Ae{constructor(e){s.h.assign(Ae,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return s.h.matchesTypesFor(e,[Ae.getTypeName()])}}Ae.H_={T_:Ae.getTypeName(),B_:Ae.getBaseTypes()};class Ie{constructor(e){s.h.assign(Ie,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_RuntimeInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return s.h.matchesTypesFor(e,[Ie.getTypeName()])}}Ie.H_={T_:Ie.getTypeName(),B_:Ie.getBaseTypes()};class Pe{constructor(e){s.h.assign(Pe,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_DiagnosticTraceMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return s.h.matchesTypesFor(e,[Pe.getTypeName()])}}Pe.H_={T_:Pe.getTypeName(),B_:Pe.getBaseTypes()};class Me{constructor(e){s.h.assign(Me,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_TelemetryMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return s.h.matchesTypesFor(e,[Me.getTypeName()])}}Me.H_={T_:Me.getTypeName(),B_:Me.getBaseTypes()};class xe{constructor(e){s.h.assign(xe,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_TelemetryFlushMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return s.h.matchesTypesFor(e,[xe.getTypeName()])}}xe.H_={T_:xe.getTypeName(),B_:xe.getBaseTypes()};class Re{constructor(e){s.h.assign(Re,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_SessionCloseResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return s.h.matchesTypesFor(e,[Re.getTypeName()])}}Re.H_={T_:Re.getTypeName(),B_:Re.getBaseTypes()};class De{constructor(e){s.h.assign(De,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_WorkflowDefinitionOverrideMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return s.h.matchesTypesFor(e,[De.getTypeName()])}}De.H_={T_:De.getTypeName(),B_:De.getBaseTypes()};class Oe{constructor(e){s.h.assign(Oe,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_GetAnnotationsRequestMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_StreamingRequest","AugLoop_Session_Protocol_Message"]}static typeGuard(e){return s.h.matchesTypesFor(e,[Oe.getTypeName()])}}Oe.H_={T_:Oe.getTypeName(),B_:Oe.getBaseTypes()};class Ne{constructor(e){s.h.assign(Ne,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_GetAnnotationsResponseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_StreamingResponse","AugLoop_Session_Protocol_Response"]}static typeGuard(e){return s.h.matchesTypesFor(e,[Ne.getTypeName()])}}Ne.H_={T_:Ne.getTypeName(),B_:Ne.getBaseTypes()};class Le{constructor(e){s.h.assign(Le,this,e)}static getTypeName(){return"AugLoop_Text_TextTile"}static getBaseTypes(){return[]}static typeGuard(e){return s.h.matchesTypesFor(e,[Le.getTypeName()])}}Le.H_={T_:Le.getTypeName(),B_:Le.getBaseTypes()};class Fe{constructor(e){s.h.assign(Fe,this,e)}static getTypeName(){return"AugLoop_Text_FormattedTextTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(e){return s.h.matchesTypesFor(e,[Fe.getTypeName()])}}Fe.H_={T_:Fe.getTypeName(),B_:Fe.getBaseTypes()};class Be{constructor(e){s.h.assign(Be,this,e)}static getTypeName(){return"AugLoop_Text_InlineTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(e){return s.h.matchesTypesFor(e,[Be.getTypeName()])}}Be.H_={T_:Be.getTypeName(),B_:Be.getBaseTypes()};class We{constructor(e){s.h.assign(We,this,e)}static getTypeName(){return"AugLoop_Text_DynamicTextContext"}static getBaseTypes(){return["AugLoop_Core_DynamicContext"]}static typeGuard(e){return s.h.matchesTypesFor(e,[We.getTypeName()])}}We.H_={T_:We.getTypeName(),B_:We.getBaseTypes()};class Ue{constructor(e){s.h.assign(Ue,this,e)}static getTypeName(){return"AugLoop_Text_TaskTile"}static getBaseTypes(){return["AugLoop_Text_FormattedTextTile","AugLoop_Text_TextTile"]}static typeGuard(e){return s.h.matchesTypesFor(e,[Ue.getTypeName()])}}Ue.H_={T_:Ue.getTypeName(),B_:Ue.getBaseTypes()};class Ge{constructor(e){s.h.assign(Ge,this,e)}static getTypeName(){return"AugLoop_Text_PersonTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return s.h.matchesTypesFor(e,[Ge.getTypeName()])}}Ge.H_={T_:Ge.getTypeName(),B_:Ge.getBaseTypes()};class He{constructor(e){s.h.assign(He,this,e)}static getTypeName(){return"AugLoop_Text_DateTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return s.h.matchesTypesFor(e,[He.getTypeName()])}}He.H_={T_:He.getTypeName(),B_:He.getBaseTypes()};class qe{constructor(e){s.h.assign(qe,this,e)}static getTypeName(){return"AugLoop_Text_LinkTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return s.h.matchesTypesFor(e,[qe.getTypeName()])}}qe.H_={T_:qe.getTypeName(),B_:qe.getBaseTypes()};class $e{constructor(e){s.h.assign($e,this,e)}static getTypeName(){return"AugLoop_Text_CommentTile"}static getBaseTypes(){return[]}static typeGuard(e){return s.h.matchesTypesFor(e,[$e.getTypeName()])}}$e.H_={T_:$e.getTypeName(),B_:$e.getBaseTypes()},function(e){e[e.Add=0]="Add",e[e.Delete=1]="Delete",e[e.Update=2]="Update",e[e.CursorUpdate=3]="CursorUpdate",e[e.FormattingUpdate=4]="FormattingUpdate",e[e.OtherNonContentUpdate=5]="OtherNonContentUpdate",e[e.AttributionUpdate=6]="AttributionUpdate"}(be||(be={})),function(e){e[e.Chars=0]="Chars",e[e.Word=1]="Word",e[e.PartialSentence=2]="PartialSentence",e[e.Sentence=3]="Sentence",e[e.Paragraph=4]="Paragraph"}(Se||(Se={})),function(e){e[e.SessionUser=0]="SessionUser",e[e.Programmatic=1]="Programmatic",e[e.Collaborator=2]="Collaborator"}(we||(we={}));class Ve{constructor(e){s.h.assign(Ve,this,e)}static getTypeName(){return"AugLoop_Text_TextTileDelta"}static getBaseTypes(){return["AugLoop_Core_ItemDelta"]}static typeGuard(e){return s.h.matchesTypesFor(e,[Ve.getTypeName()])}}Ve.H_={T_:Ve.getTypeName(),B_:Ve.getBaseTypes()};class ze{constructor(e){s.h.assign(ze,this,e)}static getTypeName(){return"AugLoop_Text_FormattedTextTileDelta"}static getBaseTypes(){return["AugLoop_Text_TextTileDelta","AugLoop_Core_ItemDelta"]}static typeGuard(e){return s.h.matchesTypesFor(e,[ze.getTypeName()])}}function je(e,t=!1){switch(e){case 12288:case 8197:case 32:case 11:case 9:case 160:return!0;case 13:case 10:case 65532:return!t}return!1}function Qe(e,t){return e.charCodeAt(t)>=56320&&e.charCodeAt(t)<=57343}ze.H_={T_:ze.getTypeName(),B_:ze.getBaseTypes()};var Je=n(92792),Ke=n.n(Je);const Ye=/[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]/g,Xe=/[.!?]/g;function Ze(e,t){const n=[],o=tt(e,t);return o&&n.push(o),n}function et(e,t){const n=[],o=tt(e,t);o&&n.push(o);const s=function(e,t,n){var o,s,r,i,a,l;const c=e,u=t;if((null==c?void 0:c.ipPosition)!==(null==u?void 0:u.ipPosition)||(null==c?void 0:c.isColdIp)!==(null==u?void 0:u.isColdIp)){if((null==c?void 0:c.isColdIp)===(null==u?void 0:u.isColdIp)&&n)if(n.deltaType===be.Add){if((null==u?void 0:u.ipPosition)===(null!==(o=n.position)&&void 0!==o?o:0)+(null!==(s=n.length)&&void 0!==s?s:0))return}else if(n.deltaType===be.Update){if((null==u?void 0:u.ipPosition)===(null!==(r=n.position)&&void 0!==r?r:0)+(null!==(a=null===(i=n.content)||void 0===i?void 0:i.length)&&void 0!==a?a:0))return}else if(n.deltaType===be.Delete&&(null==u?void 0:u.ipPosition)===(null!==(l=n.position)&&void 0!==l?l:0))return;return new ze({deltaType:be.CursorUpdate,cursorData:{ipPosition:null==u?void 0:u.ipPosition,isColdIp:null==u?void 0:u.isColdIp}})}}(e,t,o);s&&n.push(s);const r=function(e,t,n){var o,s,r,i,a,l,c;const u=e,d=t;if((null===(o=d.formattedRanges)||void 0===o?void 0:o.length)<=(null===(s=u.formattedRanges)||void 0===s?void 0:s.length))if(n){let e=u.formattedRanges?[...u.formattedRanges]:[];const t=function(e,t,n){if(!e)return;if(t.deltaType===be.Add){const t=e.find((e=>e.start===n&&0===e.length));if(t)return t;n=Math.max(n-1,0)}const o=e.find((e=>0===e.length?e.start===n:e.start<=n&&n<e.start+e.length));return o}(u.formattedRanges,n,n.position),o=t?e.indexOf(t):-1;if(-1!==o&&(n.position+(n.length||0)>t.start+t.length?t.length=n.position+(null!==(r=n.content)&&void 0!==r?r:"").length-t.start:t.length+=(null!==(i=n.content)&&void 0!==i?i:"").length-(n.length||0),e[o]=t),e.length>0){for(const t of e.slice(o+1))t.start<n.position||(n.position+(n.length||0)>t.start?(t.length=t.start+t.length-(n.position+(n.length||0)),t.start=n.position+(null!==(a=n.content)&&void 0!==a?a:"").length):t.start+=(null!==(l=n.content)&&void 0!==l?l:"").length-(n.length||0));e=e.filter((e=>e.length>0))}const s=null!==(c=null==d?void 0:d.formattedRanges)&&void 0!==c?c:[];if(Ke()(e,s)||0===e.length&&0===s.length)return}else if(Ke()(null==u?void 0:u.formattedRanges,null==d?void 0:d.formattedRanges))return;return new ze({deltaType:be.FormattingUpdate,formattedRanges:null==d?void 0:d.formattedRanges})}(e,t,o);r&&n.push(r);const i=function(e,t,n){var o;const s=e,r=t;if(((null==s?void 0:s.attributionRanges)||r.attributionRanges||(null===(o=null==n?void 0:n.attributionData)||void 0===o?void 0:o.ranges))&&!Ke()(null==s?void 0:s.attributionRanges,null==r?void 0:r.attributionRanges)){if(s.attributionRanges&&r.attributionRanges){const e=[];for(const t of r.attributionRanges)s.attributionRanges.some((e=>Ke()(e,t)))||e.push(t);if(0===e.length)return;return new ze({deltaType:be.AttributionUpdate,attributionData:{ranges:e}})}return new ze({deltaType:be.AttributionUpdate,attributionData:{ranges:null==r?void 0:r.attributionRanges}})}}(e,t,o);i&&n.push(i);const a=function(e,t){const n=e,o=t;let s;const r={};let i=!1;for(s in o)-1===["ipPosition","isColdIp","content","formattedRanges","attributionRanges"].indexOf(s)&&(Ke()(o[s],n[s])||(i=!0,r[s]=o[s]));if(i)return new ze({deltaType:be.OtherNonContentUpdate,otherNonContentData:r})}(e,t);return a&&n.push(a),n}function tt(e,t){const n=e.content,o=t.content,s=function(e,t,n=!1){let o,s,r={firstDiffLeft:0,firstDiffRight:t.length};return e.length<t.length?(o=e,s=t):(o=t,s=e),0===s.indexOf(o)?(r.firstDiffLeft=o.length,r.firstDiffRight=0):s.endsWith(o)?(r.firstDiffLeft=0,r.firstDiffRight=o.length):(r=function(e,t,n=!1){const o={firstDiffLeft:0,firstDiffRight:t.length};let s;for(s=0;s<e.length&&s<t.length;s+=1){const o=e.charCodeAt(s),r=t.charCodeAt(s);if(!(o===r||je(o,n)&&je(r,n)))break}for(o.firstDiffLeft=s,s=0;s<e.length&&s<t.length;s+=1){const o=e.charCodeAt(e.length-s-1),r=t.charCodeAt(t.length-s-1);if(!(o===r||je(o,n)&&je(r,n)))break}return o.firstDiffRight=s,o}(e,t,n),r.firstDiffLeft+r.firstDiffRight>o.length&&(r.firstDiffRight=o.length-r.firstDiffLeft)),function(e,t,n){if(e.firstDiffLeft>0){const o=e.firstDiffLeft<t.length&&Qe(t,e.firstDiffLeft),s=e.firstDiffLeft<n.length&&Qe(n,e.firstDiffLeft);(o||s)&&(e.firstDiffLeft-=1)}if(e.firstDiffRight>1){const o=e.firstDiffRight<t.length&&Qe(t,t.length-e.firstDiffRight),s=e.firstDiffRight<n.length&&Qe(n,n.length-e.firstDiffRight);(o||s)&&(e.firstDiffRight-=1)}}(r,e,t),r}(n,o),r=s.firstDiffLeft,i=n.length-s.firstDiffRight,a=o.length-s.firstDiffRight;let l,c=be.Update;if(n.length!==o.length)i===r?(c=be.Add,l=n[n.length-1]):a===r&&(c=be.Delete,l=o[o.length-1]);else if(n===o)return;let u,d=0;switch(c){case be.Update:d=i-r,u=o.substring(r,a);break;case be.Add:u=o.substring(r,a);break;case be.Delete:d=i-r,u=n.substring(r,i)}const h=function(e,t){const n=Array.from(e.matchAll(Ye));if(Ye.lastIndex=0,0===n.length)return Se.Chars;if(1===n.length){if(0===n[0].index)return t&&Xe.test(t)?Se.Sentence:t&&!Ye.test(t)?Se.Word:Se.Chars;if(n[0].index+1===e.length)return Xe.test(e[n[0].index-1])?Se.Sentence:Ye.test(e[n[0].index-1])?Se.Chars:Se.Word;if(e[n[0].index-1]){const t=e[n[0].index-1];if(Xe.test(t))return Se.Sentence;if(Ye.test(t))return Se.Chars}return Se.Word}const o=Array.from(e.matchAll(Xe));return Xe.lastIndex=0,0===o.length?Se.PartialSentence:o.length>1?Se.Paragraph:o[0].index+1<=e.length?Ye.test(e[o[0].index+1])?Se.Sentence:Se.Paragraph:void 0}(u,l);if(void 0!==h)return new ze({content:c!==be.Delete?u:void 0,deltaType:c,unit:h,position:r,length:c!==be.Add?d:0})}class nt{constructor(){this.deltaBuilderHandlers=new Map,this.registerDeltaBuilderHandler(Le.getTypeName(),Ze),this.registerDeltaBuilderHandler(Fe.getTypeName(),et)}registerDeltaBuilderHandler(e,t){this.deltaBuilderHandlers.set(e,t)}executeDeltaBuilderHandler(e,t,n){const o=this.deltaBuilderHandlers.get(e);return o?o(t,n):[]}}const ot=(e,t)=>t?st([...t,e]):e,st=e=>e.join("\\");class rt{constructor(e){this.createTextTileDeltasFromItem=(e,t)=>{var n;const o=new L.I({operationName:"CreateTextTileDeltaFromItem",success:!0}).start();try{if(!e)return o.success=!1,o.resultDescription="Unable to create text tile delta, parent item is undefined",void b.tG.info(524883085,b.nh.CoreDefault,o.stop());if(!e.body)return o.success=!1,o.resultDescription="Unable to create text tile delta, parent item has undefined body",void b.tG.info(524883086,b.nh.CoreDefault,o.stop());const r=e.body;if(!Le.typeGuard(r))return o.success=!1,void(o.resultDescription=`Unable to create text tile delta, parent item body is not proper type: expected ${Le.getTypeName()}, received ${s.h.getTypeNameFor(r)}`);const i=ot(e.id,t),a=null!==(n=this.lastSeenTileByTileId.get(i))&&void 0!==n?n:new Le({content:""}),l=this.createDeltas(a,r);return l&&0!==l.length?(o.dimension0=l.length.toString(),this.lastSeenTileByTileId.set(i,r)):(o.dimension0="0",o.resultDescription="No delta differences found"),b.tG.info(524883087,b.nh.CoreDefault,o.stop()),l}catch(e){return o.success=!1,o.resultDescription=`Error creating text tile delta: ${e}`,void b.tG.info(524883088,b.nh.CoreDefault,o.stop())}},this.lastSeenTileByTileId=null!=e?e:new Map,this.deltaBuilder=new nt}addItemToLocalMap(e,t){const n=ot(e.id,t),o=e.body;Le.typeGuard(o)&&!this.lastSeenTileByTileId.has(n)&&this.lastSeenTileByTileId.set(n,o)}deleteItemFromLocalMap(e,t){const n=ot(e.id,t);this.lastSeenTileByTileId.has(n)&&this.lastSeenTileByTileId.delete(n)}moveItemsInLocalMap(e,t,n){const o=new Set(n),s=st(t),r=st(e),i=[],a=(e,t)=>e.length>t.length?e.substring(t.length+1).split("\\")[0]:void 0;for(const[e,t]of this.lastSeenTileByTileId)if(e.startsWith(s)){const n=a(e,s);if(void 0===n||o.has(n)){const n=e.replace(s,r);i.push({item:t,newPathKey:n,prevPathKey:e})}}for(const e of i)this.lastSeenTileByTileId.delete(e.prevPathKey),this.lastSeenTileByTileId.set(e.newPathKey,e.item)}createDeltas(e,t){return this.deltaBuilder.executeDeltaBuilderHandler(s.h.getTypeNameFor(t),e,t)}}var it=n(196);class at{constructor(e){this.childCount=0,this.id=e||function(){for(let e=0;e<ct;e++)ut[e]=lt[Math.floor(Math.random()*lt.length)];return ut.join("")}()}static fromString(e,t){if(!e)throw new Error("Received invalid correlation vector string");let n;return n=e.endsWith(".0")?new at(e.substring(0,e.length-2)):new at(e),t&&(n.childCount=t),n}newChild(){return++this.childCount,new at(this.id+"."+this.childCount.toString())}toString(){return this.id.length>127?this.id.substring(0,127)+"!":this.id}}const lt=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],ct=22,ut=new Array(ct);var dt;!function(e){e[e.Local=0]="Local",e[e.External=1]="External"}(dt||(dt={}));class ht{constructor(){this.graphNodeByLocationAndWorkflowId=new Map}getWorkflow(e,t){var n;const o=this.getLocation(t);return null===(n=this.graphNodeByLocationAndWorkflowId.get(o))||void 0===n?void 0:n.get(e)}addWorkflow(e,t=!1){if(this.getWorkflow(e.id,t)){const n=new L.I({operationName:"AddWorkflowToGraphFailure",success:!1,resourceId:e.id,resultDescription:`Adding a new with workflow with a duplicated workflowId: ${t}`}).start();return void b.tG.error(524300630,b.nh.CoreDefault,n.stop())}const n=this.getLocation(t),o=new pt(e,n);this.addWorkflowAsDependency(o);let s=this.graphNodeByLocationAndWorkflowId.get(n);s||(s=new Map,this.graphNodeByLocationAndWorkflowId.set(n,s)),s.set(e.id,o)}getUpstreamRuntimeVisibleWorkflows(){const e=[];for(const t of this.graphNodeByLocationAndWorkflowId.values()||[])for(const n of t.values()||[]){const t=this.createWorkflowDefinition(n.workflow);n.workflow.visibility===X.LocalOnly?this.compressDownstreamWorkflows(t,n):t.outputTypes.push(...n.workflow.outputTypes),0!==t.inputTypes.length&&e.push(t)}return e}removeWorkflows(e){const t=this.getLocation(e),n=this.graphNodeByLocationAndWorkflowId.get(t),o=Array.from((null==n?void 0:n.values())||[]);for(const e of o){for(const t of e.upstreamWorkflows.values())t.downstreamWorkflows.delete(e);for(const t of e.downstreamWorkflows.values())t.upstreamWorkflows.delete(e);n.delete(e.workflow.id)}}getWorkflowsDefinitions(){const e=[];for(const t of this.graphNodeByLocationAndWorkflowId.values()||[])for(const n of t.values()||[])e.push(n.workflow);return e}getWorkflowNodes(e){const t=[];for(const e of this.graphNodeByLocationAndWorkflowId.values())for(const n of e.values())t.push(n);return t}getLocation(e){return e?dt.External:dt.Local}createWorkflowDefinition(e){return Object.assign(Object.assign({},e),{outputTypes:[]})}compressDownstreamWorkflows(e,t){for(const n of t.downstreamWorkflows)if(n.workflow.visibility!==X.LocalOnly){if(n.workflow.kind!==J.Join||-1!==e.inputTypes.indexOf(n.workflow.collectionScopeType))for(const t of n.workflow.outputTypes)-1===e.outputTypes.indexOf(t)&&e.outputTypes.push(t)}else this.compressDownstreamWorkflows(e,n)}addWorkflowAsDependency(e){for(const t of this.graphNodeByLocationAndWorkflowId.values())for(const n of t.values()){for(const t of n.workflow.inputTypes)-1!==e.workflow.outputTypes.indexOf(t)&&this.addWorkflowChain(e,n);for(const t of n.workflow.outputTypes)-1!==e.workflow.inputTypes.indexOf(t)&&this.addWorkflowChain(n,e)}}addWorkflowChain(e,t){e.downstreamWorkflows.add(t),t.upstreamWorkflows.add(e)}}class pt{constructor(e,t){this.isActivated=!0,this.upstreamWorkflows=new Set,this.downstreamWorkflows=new Set,this.location=t,this.workflow=Object.assign(Object.assign({},e),{inputTypes:Array.isArray(e.inputTypes)?e.inputTypes:[],outputTypes:Array.isArray(e.outputTypes)?e.outputTypes:[]})}}new(n(90170).eU)("enableRichContentApis",!1);const ft=e=>({id:e.id,kind:e.kind,visibility:e.visibility,collectionScopeType:e.collectionScopeType,inputTypes:e.inputTypes,outputTypes:e.outputTypes,correlatedSignals:e.correlatedSignals}),gt=(e,t)=>null!=e&&null!=t&&e.length>0&&(e===t||0===t.indexOf(e)&&"."===t.charAt(e.length));class mt{constructor(){this.workflowDefByWorkflowAndContextId=new Map,this.workflowDefByWorkflow=new Map}static mergeDefinitions(e,t,n){return Object.assign(Object.assign(Object.assign({},e),t),n)}mergeWorkflowDefinition(e,t,n){if(n){const o=((e,t)=>{let n=e.get(t);return n||(n=new Map,e.set(t,n)),n})(this.workflowDefByWorkflowAndContextId,e.id);o.set(n,mt.mergeDefinitions(e,o.get(n),t))}else this.workflowDefByWorkflow.set(e.id,mt.mergeDefinitions(e,this.workflowDefByWorkflow.get(e.id),t))}getWorkflowDefinition(e,t){var n;let o;return t&&(o=null===(n=this.workflowDefByWorkflowAndContextId.get(e.id))||void 0===n?void 0:n.get(t)),o||(o=this.workflowDefByWorkflow.get(e.id)),o||(o=e),o}deleteWorkflowDefinition(e,t){const n=this.workflowDefByWorkflowAndContextId.get(e.id);n&&(n.delete(t),0===n.size&&this.workflowDefByWorkflowAndContextId.delete(e.id))}}var yt;!function(e){e.JsClient="C",e.Server="S"}(yt||(yt={}));const vt=new Set([he.Xr.getTypeName(),he.fZ.getTypeName(),he.g0.getTypeName(),he.xU.getTypeName()]);class bt{constructor(e,t){this.nextId=1,this.runtimeKind=e,this.workflowGraph=t}static isParentContextId(e,t){return gt(e,t)}applyContextIdOnOperations(e){for(const t of e){const e=s.h.getTypeNameFor(t);if(this.isSupportedOperation(e))for(const e of t.items)e.contextId?e.source&&this.workflowGraph.getWorkflow(e.source,!1)?e.contextId=this.addNewContextId(e.contextId):this.tryLogMessage(new L.I({operationName:"ApplyContextIdOnOperations",success:!0}).start(),"Item with a contextId but without a workflow source atribute"):e.contextId=this.addNewContextId()}}addNewContextId(e){const t=`${this.runtimeKind}${this.nextId++}`;return e?`${e}.${t}`:t}isSupportedOperation(e){return vt.has(e)}tryLogMessage(e,t,n=!0){e&&(e.success=n,e.resultDescription=t,b.tG.verbose(527308633,b.nh.CoreDefault,e.stop()))}}var St;!function(e){e[e.Idle=1]="Idle",e[e.Pending=2]="Pending",e[e.Running=3]="Running",e[e.Executed=4]="Executed"}(St||(St={}));const wt="\\",Tt=(e,t)=>Object.assign(Object.assign({},t),{parentPath:e}),Ct=e=>Array.isArray(e)?5===e.length?`${e[0]}${wt}${e[1]}${wt}${e[2]}${wt}${e[3]}${wt}${e[4]}`:4===e.length?`${e[0]}${wt}${e[1]}${wt}${e[2]}${wt}${e[3]}`:3===e.length?`${e[0]}${wt}${e[1]}${wt}${e[2]}`:2===e.length?`${e[0]}${wt}${e[1]}`:1===e.length?e[0]:e.join(wt):"(malformed path)";class _t{constructor(e){this.scopeItemsByContextId=new Map,this.itemsByWorkflowAndContextId=new Map,this.workflowDefinitionManager=e}setScopeItem(e,t){var n;const o=e.contextId;if(o)if(this.itemsByWorkflowAndContextId.has(t.id)||this.itemsByWorkflowAndContextId.set(t.id,new Map),this.itemsByWorkflowAndContextId.get(t.id).set(o,[]),this.scopeItemsByContextId.has(o)){if(null===(n=this.itemsByWorkflowAndContextId.get(t.id))||void 0===n?void 0:n.has(o)){const n=new L.I({resultDescription:`Trying to set new scope item: ${e.id} with already existing contextId ${o} for workflow ${t.id}`,operationName:"WIS.setScopeItem",resourceId:t.id,success:!0}).start();b.tG.verbose(527291288,b.nh.CoreDefault,n.stop())}}else this.scopeItemsByContextId.set(o,e)}updateScopeItemPath(e,t,n){var o,s;if(!e)return;const r=this.scopeItemsByContextId.get(e);if(!r)return;const i=r.parentPath;this.scopeItemsByContextId.set(e,Tt(t,r));const a=null!==(s=null===(o=this.itemsByWorkflowAndContextId.get(n.id))||void 0===o?void 0:o.get(e))&&void 0!==s?s:[];for(let e=0;e<a.length;e++)a[e]=Tt([...t,...a[e].parentPath.slice(0,i.length)],a[e])}getScopeItem(e,t){var n;for(const o of(null===(n=this.itemsByWorkflowAndContextId.get(t.id))||void 0===n?void 0:n.keys())||[])if(gt(o,e))return this.scopeItemsByContextId.get(o)}addItemToWorkflowList(e,t){const n=e.contextId;if(!n)return;const o=this.itemsByWorkflowAndContextId.get(t.id);if(o)for(const[s,r]of o)if(gt(s,n)){r.push(e);const n=new L.I({resultDescription:`Items for contextId ${s}: [${r.map((e=>e.id)).join(",")}]`,operationName:"WIS.addItemOnContextIdList",resourceId:t.id,success:!0}).start();b.tG.info(526403808,b.nh.CoreDefault,n.stop())}}isWorkflowReady(e,t){const n=this.workflowDefinitionManager.getWorkflowDefinition(t,e).maxAnnotations;return this.getGeneratedItems(e,t).length>=n}getItemsToExecute(e,t){const n=this.getGeneratedItems(e,t);return this.itemsByWorkflowAndContextId.get(t.id).delete(e),n}onWorkflowExecuted(e,t){const n=e.contextId,o=this.itemsByWorkflowAndContextId.get(t.id);o&&(o.delete(n),0===o.size&&this.itemsByWorkflowAndContextId.delete(t.id)),this.hasWorkflowsAwaitingExecution(n)||this.scopeItemsByContextId.delete(n)}getGeneratedItems(e,t){var n;if(!(null===(n=this.itemsByWorkflowAndContextId.get(t.id))||void 0===n?void 0:n.get(e)))return[];const o=this.workflowDefinitionManager.getWorkflowDefinition(t,e).maxAnnotations;return this.itemsByWorkflowAndContextId.get(t.id).get(e).slice(0,o)}hasWorkflowsAwaitingExecution(e){for(const t of this.itemsByWorkflowAndContextId.values())for(const n of t.keys())if(n===e)return!0;return!1}}var kt,Et,At;!function(e){e[e.Unknown=0]="Unknown",e[e.LiveId=1]="LiveId",e[e.OrgId=2]="OrgId",e[e.ActiveDirectory=3]="ActiveDirectory",e[e.ADAL=4]="ADAL",e[e.SSPI=5]="SSPI",e[e.OAuth2=6]="OAuth2",e[e.Badger=7]="Badger"}(kt||(kt={})),function(e){e[e.Augloop=0]="Augloop",e[e.Substrate=1]="Substrate"}(Et||(Et={})),function(e){e[e.Unknown=0]="Unknown",e[e.TokenMissingInteractionRequired=1]="TokenMissingInteractionRequired"}(At||(At={}));var It=n(46331),Pt=n(25631),Mt=n(55730),xt=n(26025);const Rt=e=>Dt(e,Number.POSITIVE_INFINITY),Dt=(e,t)=>{let n=0;const o=[],s=[e];for(;s.length>0;){const e=s.pop(),r=typeof e;if("boolean"===r)n+=4;else if("string"===r)n+=2*e.length;else if("number"===r)n+=8;else if("object"===r&&e&&-1===o.indexOf(e))if(e instanceof Uint8Array)n+=e.length;else{o.push(e);for(const t in e)s.push(e[t])}if(n>t)return n}return n},Ot=(e,t)=>{const n=[];for(const o of null!=e?e:[])if(void 0===t||t===o.cardinality)for(const e of o.contextTypes)n.push([e,o.cardinality,o.producerWaitPolicy]);return n};class Nt{constructor(e,t,n,o){this.sendMessage=e,this.annotationType=t,this.options=n,this.token=`${t}-${Nt.nextActivationResultBatchId++}`,this.annotationDoesNotExistOnServiceEnabled=o}activate(e,t,n){return new Promise(((o,s)=>{this.sendMessage(new Ce.n4({annotationType:this.annotationType,token:this.token,config:this.options?this.options.config:void 0,ignoreExistingAnnotations:e,sendStateUpdates:this.options?!!this.options.stateUpdateCallback:void 0,forceReturnCachedAnnotations:this.options?this.options.forceReturnCachedAnnotations:void 0,returnAnnotationDoesNotExist:this.annotationDoesNotExistOnServiceEnabled||!1,sendApologies:n}),((e,t)=>{e?s(new Error(e.error)):(Ce.PY.typeGuard(t)&&this.annotationDoesNotExistOnServiceEnabled&&(this.annotationDoesNotExistOnService=t.annotationNotExists),o({token:this.token}))}),t)}))}release(){return new Promise(((e,t)=>{this.annotationDoesNotExistOnService&&this.annotationDoesNotExistOnServiceEnabled?e(!1):this.sendMessage(new Ce.GA({token:this.token}),((n,o)=>{n?t(new Error(n.error)):e(o.lastRelease)}))}))}}var Lt,Ft,Bt,Wt;Nt.nextActivationResultBatchId=1,(Wt=Lt||(Lt={}))[Wt.Input=0]="Input",Wt[Wt.Exception=1]="Exception",Wt[Wt.WaitOn=2]="WaitOn",Wt[Wt.StopAndFilterWorkflow=3]="StopAndFilterWorkflow",function(e){e[e.Unknown=0]="Unknown",e[e.NoOutput=1]="NoOutput",e[e.Authentication=2]="Authentication",e[e.JoinTimedOut=3]="JoinTimedOut",e[e.LambdaThrow=4]="LambdaThrow",e[e.LambdaErrorCallback=5]="LambdaErrorCallback"}(Ft||(Ft={})),function(e){e[e.ExceedingMaxSize=0]="ExceedingMaxSize",e[e.GroupComplete=1]="GroupComplete",e[e.BatchIntervalElapsed=2]="BatchIntervalElapsed"}(Bt||(Bt={}));class Ut{constructor(e,t,n,o,s){this.batchesByGroupingKey=new Map,this.getOrderOfMagnitudeDimension=e=>e<0?"Negative":0===e?"0":1===e?"1":`Magnitude ${e.toString().length}`,this.submit=e,this.onSummary=o,this.reduceBatchOperationsEnabled=t,this.batchMessagesEnabled=n,this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled=s}addBatchItem(e,t,n,o,s,r){const{delayMs:i,delayMsMax:a,maxInputSize:l,estimateSize:c,groupingKeyExtractor:u}=t,d=c(e),h=u(e);if(t.split&&d>l){let i;try{i=t.split(e)}catch(e){const t=new Error("Split error: "+e.message);return void(r?r(t):b.tG.error(573366352,b.nh.CoreDefault,t))}if(i&&Array.isArray(i.inputs)&&i.inputs.length>1){let e;const a=[],l=r?(t,n)=>{if(e=e||t,a.push(n),a.length===i.inputs.length){let n;try{n=i.join(a)}catch(t){return void r(new Error("Join error: "+t.message))}r(e,n)}}:void 0;for(let e=0;e<i.inputs.length;e++){const r=i.inputs[e];this.addBatchItem(r,t,n,o,s&&e===i.inputs.length-1,l)}return}}let p=this.batchesByGroupingKey.get(h);if(p&&p.size+d>l&&(this.executeBatch(h,p,t,Bt.ExceedingMaxSize),p=void 0),p||(p={items:[],size:0,hasItemsWithCallbacks:!1,context:n,creationTime:Date.now()},this.batchesByGroupingKey.set(h,p)),this.batchMessagesEnabled){const t=p.items[p.items.length-1];t&&t.cv===o&&t.callback===r?(t.input=[...t.input,...e],t.size+=d):p.items.push({input:e,size:d,cv:o,callback:r,creationTime:Date.now()})}else p.items.push({input:e,size:d,callback:r,creationTime:Date.now()});p.size+=d,p.hasItemsWithCallbacks=p.hasItemsWithCallbacks||!!r,this.batchMessagesEnabled||(p.cv=o),p.groupComplete=s,p.groupComplete?this.executeBatch(h,p,t,Bt.GroupComplete):(Date.now()-p.creationTime+i<a&&(clearTimeout(p.timeout),p.timeout=void 0),p.timeout||(p.timeout=setTimeout((()=>{this.executeBatch(h,p,t,Bt.BatchIntervalElapsed)}),i)))}removeAllBatchedItems(){this.batchesByGroupingKey.forEach((e=>{e.timeout&&clearTimeout(e.timeout)})),this.batchesByGroupingKey.clear()}close(){for(const[e,t]of this.batchesByGroupingKey){const n=1e3;void 0!==t.creationTime&&void 0!==t.timeout&&void 0!==t.timeoutDuration&&Date.now()-t.creationTime>t.timeoutDuration+n&&b.tG.info(504690067,b.nh.CoreDefault,{operationName:"BatchStillPendingAfterTimeout",resourceId:t.context.name,resultDescription:`Batch with groupingKey "${e}" still pending after timeout. Items: ${t.items.length}, Size: ${t.size}`,dimension0:t.items.length>0?`LastItemAge: ${Date.now()-t.items[t.items.length-1].creationTime}ms`:"No items in batch"})}}reduceBatchOperations(e){const t=new L.I({operationName:"ReduceBatchOperations"}).start();let n=0,o=0,s=0;const r=new Set,i=[],a=(e,t)=>e.parentPath.toString()+"/"+e.parentRevId+"/"+t.id;for(const t of e.input.reverse()){const e=[];for(const i of t.input.reverse())if(he.fZ.typeGuard(i)){const t=[];for(const e of i.items){s++;const l=a(i,e);r.has(l)?o++:(t.push(e),r.add(l),n++)}0!==t.length&&(i.items=t,e.push(i))}else if(he.Xr.typeGuard(i)){for(const e of i.items){const t=a(i,e);r.delete(t)}e.push(i)}else e.push(i);0!==e.length&&i.push({input:e.reverse(),size:t.size,cv:t.cv,callback:t.callback,creationTime:t.creationTime})}e.input=i.reverse(),0!=s&&(t.dimension0=`${this.getOrderOfMagnitudeDimension(o)}`,t.dimension1=`noOp: ${0===o}`),t.success=s-o==n,b.tG.info(507839488,b.nh.CoreDefault,t.stop())}maxNumberOfDeltaUpdateOpsPerItemPerBatch(e){const t=(e,t)=>e.parentPath.toString()+"/"+t.id;let n=0;const o=new Map;for(const s of e.input)if(he.xU.typeGuard(s))for(const e of s.items){const r=t(s,e);o.has(r)||o.set(r,0),o.set(r,o.get(r)+1),n=Math.max(n,o.get(r))}return n}executeBatch(e,t,n,o){clearTimeout(t.timeout),t.timeout=void 0,this.batchesByGroupingKey.delete(e);const s=t.items,r=new L.I({operationName:"ExecuteBatch",cv:this.batchMessagesEnabled?"":t.cv,resourceId:t.context.name,resultDescription:`batching duration: ${Date.now()-t.creationTime}ms`,dimension0:`${this.batchMessagesEnabled?"Batched items count":"Batched ops count:"} ${this.getOrderOfMagnitudeDimension(s.length)}`,dimension1:`Size ${this.getOrderOfMagnitudeDimension(t.size)}`,dimension2:o.toString()}).start(),i=(e,n,o)=>{let i;if(n&&n.exceptionType===Ft.NoOutput)r.success=!0,b.tG.info(573366353,b.nh.CoreDefault,r.stop());else{const o=`${e} error: ${n?n.message||n:"Unknown error"}`;i=n||new Error(o),r.success=!1,r.resultDescription=`Batch of ${s.length} items of size ${t.size} with ${o}`,r.resultSignature=`${e} Error`,b.tG.error(573366354,b.nh.CoreDefault,r.stop())}if(t.hasItemsWithCallbacks)for(const e of s)e.callback&&e.callback(i,o)};let a;try{a=n.multiplex(this.batchMessagesEnabled?s:s.map((e=>e.input)))}catch(e){return void i("Multiplex",e)}this.reduceBatchOperationsEnabled&&this.batchMessagesEnabled&&"operations"==e&&this.reduceBatchOperations(a),!this.batchMessagesEnabled&&"operations"==e&&this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled&&(r.dimension3=this.getOrderOfMagnitudeDimension(this.maxNumberOfDeltaUpdateOpsPerItemPerBatch(a))),this.submit(a.input,t,((e,o)=>{if(e||o&&("exceptionType"in o||o instanceof Error))i("Submit",e||o,o);else if(t.hasItemsWithCallbacks||n.summaryExtractor){let l,c,u;if(t.hasItemsWithCallbacks)try{if(l=a.demultiplex(o),l.length!==s.length)throw new Error("Mismatched output length")}catch(e){return void i("Demultiplex",e)}if(n.summaryExtractor)try{[u,c]=n.summaryExtractor(o)}catch(e){return void i("SummaryExtractor",e)}if(r.success=!0,b.tG.info(573366342,b.nh.CoreDefault,r.stop()),t.hasItemsWithCallbacks)for(let e=0;e<s.length;e++)s[e].callback&&s[e].callback(void 0,l[e]);c&&this.onSummary(u,c,t.context)}else r.success=!0,b.tG.info(573366343,b.nh.CoreDefault,r.stop())}))}}var Gt=n(65618);const{AugLoopTextEncoder:Ht,AugLoopTextDecoder:qt}=(()=>{if("undefined"==typeof TextEncoder||"undefined"==typeof TextDecoder){n(20731);const e={AugLoopTextEncoder:TextEncoder,AugLoopTextDecoder:TextDecoder};return TextEncoder=void 0,TextDecoder=void 0,e}return{AugLoopTextEncoder:TextEncoder,AugLoopTextDecoder:TextDecoder}})();var $t=function(e,t,n,o){return new(n||(n=Promise))((function(s,r){function i(e){try{l(o.next(e))}catch(e){r(e)}}function a(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))};class Vt{static extractFragments(e){if(e[0]!==Vt.IDENTIFIERBYTE)throw new Error("Invalid Binary: Incorrect Identifier");let t=1;const n=[],o=new DataView(e.buffer,e.byteOffset,e.byteLength);for(;t<e.byteLength;){if(t+4>e.byteLength)throw new Error("Invalid Binary: Error reading fragment length");const s=o.getUint32(t);if(t+s+4>e.byteLength)throw new Error("Invalid Binary: Fragment out of range");"undefined"!=typeof Buffer&&Buffer.from?n.push(Buffer.from(e.buffer,e.byteOffset+t+4,s)):n.push(new Uint8Array(e.buffer,e.byteOffset+t+4,s)),t+=4+s}if(n.length<1)throw new Error("Invalid Binary: No fragments found");return n}static deserialize(e,t=e=>e){const n=Vt.extractFragments(e),o=Vt.textDecoder.decode(n[0]);return JSON.parse(o,((e,o)=>{if("string"==typeof o){if(o.substring(0,Vt.BINARYKEYWORD.length)===Vt.BINARYKEYWORD){const e=parseInt(o.substring(Vt.BINARYKEYWORD.length),10);if("number"!=typeof e||e>=n.length-1)throw new Error("Invalid Binary: Binary index out of range");return t(n[e+1])}if(o.substring(0,Vt.ESCAPEKEYWORD.length)===Vt.ESCAPEKEYWORD)return o.substring(Vt.ESCAPEKEYWORD.length)}return o}))}static deserializeAsync(e,t=e=>$t(this,void 0,void 0,(function*(){return e}))){return $t(this,void 0,void 0,(function*(){const n=Vt.extractFragments(e),o=Vt.textDecoder.decode(n[0]),s=[],r=Symbol("placeholder"),i=e=>{if(Array.isArray(e)){for(let t=0;t<e.length;t++)e[t]=i(e[t]);return e}if(null!==e&&"object"==typeof e){if(e[r])return e.value;for(const t of Object.keys(e))e[t]=i(e[t]);return e}return e};let a=JSON.parse(o,((e,o)=>{if("string"==typeof o){if(o.startsWith(Vt.BINARYKEYWORD)){const e=parseInt(o.substring(Vt.BINARYKEYWORD.length),10);if("number"!=typeof e||e>=n.length-1)throw new Error("Invalid Binary: Binary index out of range");const i=t(n[e+1]);return s.push(i),(e=>{const t={[r]:!0,value:void 0};return e.then((e=>{t.value=e})),t})(i)}if(o.startsWith(Vt.ESCAPEKEYWORD))return o.substring(Vt.ESCAPEKEYWORD.length)}return o}));return yield Promise.all(s),a=yield i(a),a}))}static serializeInternal(e){const t=[void 0],n=JSON.stringify(e,((e,n)=>ArrayBuffer.isView(n)?(t.push(n),`${Vt.BINARYKEYWORD}${t.length-2}`):n&&"Buffer"===n.type&&Array.isArray(n.data)?(t.push(new Uint8Array(n.data)),`${Vt.BINARYKEYWORD}${t.length-2}`):"string"==typeof n&&n.substring(0,Vt.ESCAPEKEYWORD.length)===Vt.ESCAPEKEYWORD?Vt.ESCAPEKEYWORD+n:n));t[0]=Vt.textEncoder.encode(n);const o=t.reduce(((e,t)=>e+4+t.byteLength),0),s=new Uint8Array(o+1);s[0]=Vt.IDENTIFIERBYTE;let r=1;const i=new DataView(s.buffer,s.byteOffset,s.byteLength);for(const e of t)i.setUint32(r,e.byteLength),s.set(e,r+4),r+=4+e.byteLength;return s}static serialize(e){return Vt.serializeInternal(e)}static serializeAsync(e){return $t(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{try{t(Vt.serializeInternal(e))}catch(e){n(e)}}))}))}}Vt.IDENTIFIERBYTE=3,Vt.BINARYKEYWORD=":b",Vt.ESCAPEKEYWORD=":",Vt.textDecoder=new qt,Vt.textEncoder=new Ht;var zt=function(e,t,n,o){return new(n||(n=Promise))((function(s,r){function i(e){try{l(o.next(e))}catch(e){r(e)}}function a(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))};function jt(e,t){return zt(this,void 0,void 0,(function*(){const{authToken:n,origin:o,sessionUrl:s}=e,{body:r,cv:i,method:a,requestUrl:l}=t,c=yield(0,Gt.fetch)(l||s,{method:a,headers:Object.assign({Authorization:`Bearer ${n}`,"x-origin":o,"x-correlationid":i},t.headers),body:r});if(200!==c.status)throw new Error(`Unexpected status code: ${c.status}`);return c}))}const Qt=(e,t)=>{t?(e.resultDescription=t,e.success=!1,b.tG.error(507646878,b.nh.CoreDefault,e.stop())):b.tG.info(507646877,b.nh.CoreDefault,e.stop())};function Jt(e,t,n,o){let s;jt(e,{headers:{"Content-Type":"application/jsond"},body:Vt.serialize(t),cv:n.cv,method:"POST"}).then((e=>e.json())).catch((e=>{s=new Ce._p({messageId:t.messageId,error:e.message})})).then((e=>{Qt(n,s?s.error:void 0),o(s,e)}))}function Kt(e,t,n,o){let s;jt(e,{headers:{"Content-Type":"application/octet-stream"},body:t,cv:n.cv,method:"POST",requestUrl:`${e.sessionUrl}/blob`}).then((e=>e.json())).catch((e=>{s=new Ce._p({error:e.message})})).then((e=>{Qt(n,s?s.error:void 0),o(s,e)}))}function Yt(e,t,n,o){const{sessionUrl:s}=e;let r;jt(e,{cv:o.cv,method:"GET",requestUrl:t.refType===Mt.J1.AlCodedLocation?`${s}/blob/${t.value}`:t.value}).then((e=>e.arrayBuffer())).then((e=>new Uint8Array(e))).catch((e=>{r=e})).then((e=>{Qt(o,r?r.message:void 0),n(r,e)}))}var Xt=n(6731);class Zt extends Xt.EventEmitter{init(){return Promise.resolve()}sendMessage(e,t,n){}onMessage(e,t){}forceReconnect(){return Promise.resolve()}closeSession(){}sendBytes(e){}getCorrelationVector(){return new at}getNetworkWorkerManager(){}setState(e){}}const en=e=>{var t,n;if(Ce.B_.typeGuard(e)){const n=e.ops.filter((e=>s.h.matchesTypesFor(e,["AugLoop_Core_AddOperation"])));for(const e of n)for(const n of e.items)if(n.body&&(null===(t=n.body)||void 0===t?void 0:t.isFirstUserPerceivedResponse))return!0}else if(Ne.typeGuard(e))return null===(n=e.content)||void 0===n?void 0:n.some((e=>{var t;return null===(t=e.body)||void 0===t?void 0:t.isFirstUserPerceivedResponse}));return!1},tn=(e,t,n,o,r)=>{const i=(e=>{const t=e.filter((e=>s.h.matchesTypesFor(e,["AugLoop_Signals_SignalOperation"])));for(const e of t)for(const t of e.items)if(t.body&&s.h.matchesTypesFor(t.body,["AugLoop_CopilotChatHistory_CopilotChatHistorySignal","AugLoop_Copilot_CopilotInputSignal"]))return t})(e);i&&(r.setDataField("CurrentTimestamp",n),r.cv=t||"",r.resultSignature=o,r.resourceId=s.h.getTypeNameFor(i.body),i.contextId&&r.setDataField("ContextId",i.contextId),i.sourceTimestamp&&r.setDataField("SourceTimestamp",i.sourceTimestamp),b.tG.info(505983429,b.nh.CoreDefault,r.stop()))},nn=(e,t,n,o,s)=>{o&&!en(e)||(s.setDataField("CurrentTimestamp",t),s.cv=e.cv,s.resultSignature=n,s.resourceId=e.annotationType,s.dimension1=`AreApologies: ${e.areApologies}`,b.tG.info(505983428,b.nh.CoreDefault,s.stop()))};var on;!function(e){e[e.Undefined=0]="Undefined",e[e.Schema=1]="Schema",e[e.Boolean=2]="Boolean",e[e.Number=3]="Number",e[e.String=4]="String",e[e.Buffer=5]="Buffer",e[e.Function=6]="Function"}(on||(on={}));class sn{static createHealthCheckRequest(e){return{payload:{},payloadSchema:{category:on.Schema,schema:{name:"HealthCheckRequest"}},requestedSchema:{category:on.Schema,schema:{name:"HealthCheckResponse"}},clientMetadata:Object.assign(Object.assign({},e),{flights:""})}}static isFeatureEnabled(e,t,n=!1,o="None"){return e&&e.isFeatureEnabled?e.isFeatureEnabled("Microsoft.Office.AugLoop."+t,o).catch((()=>Promise.resolve(n))):Promise.resolve(n)}static isChangeGateEnabled(e,t){return e&&e.isChangeGateEnabled?e.isChangeGateEnabled(t):Promise.resolve(!1)}static convertWebSocketUrlToHttp(e){return this.convertUrl(e,!1)}static convertServiceUrlToWebSocket(e){return this.convertUrl(e,!0)}static convertUrl(e,t){if(!e)return e;const n=e.split(":");let o=n[0].toLowerCase();return 0==o.indexOf(t?"http":"ws")?(o=t?o.replace("http","ws"):o.replace("ws","http"),n[0]=o,n.join(":")):e}static deepEquals(e,t){return Ke()(e,t)}static collectTelemetry(e,t,n,o,s,r){var i,a,l,c;e.start(),e.resultSignature=null!=o?o:"",e.resultDescription=null!=s?s:"",e.success=n,r?(e.dimension0=null!==(i=r[0])&&void 0!==i?i:"",e.dimension1=null!==(a=r[1])&&void 0!==a?a:"",e.dimension2=null!==(l=r[2])&&void 0!==l?l:"",e.dimension3=null!==(c=r[3])&&void 0!==c?c:""):(e.dimension0="",e.dimension1="",e.dimension2="",e.dimension3=""),t.log((()=>b.tG.info(508367457,b.nh.CoreDefault,e.stop())))}}sn.getCurrentTimeMs=()=>Date.now?Date.now():(new Date).getTime();class rn{constructor(e){this.maxNumberOfLogs=40,this.numberOfLogs=0,this.id=e}log(e){if(this.numberOfLogs<this.maxNumberOfLogs&&(this.numberOfLogs++,e(),this.numberOfLogs===this.maxNumberOfLogs)){const e=new L.I({operationName:"OnLastLog",success:!0,resourceId:this.id,resultDescription:`Limit for number of logs for id: ${this.id} reached - all next logs will be dropped`});b.tG.warn(572838107,b.nh.CoreDefault,e)}}}const an=[s.h.getTypeName(),fe.YH.getTypeName(),ge.HN.getTypeName()],ln=e=>{const t=new Set;for(const n of e)if("string"==typeof n)-1===an.indexOf(n)&&t.add(n);else for(const e of[n.getTypeName(),...n.getBaseTypes()])-1===an.indexOf(e)&&t.add(e);return Array.from(t)},cn=(e,t=0)=>Number.isFinite(e)?e:t;var un,dn=function(e,t,n,o){return new(n||(n=Promise))((function(s,r){function i(e){try{l(o.next(e))}catch(e){r(e)}}function a(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))},hn=function(e){return this instanceof hn?(this.v=e,this):new hn(e)};!function(e){e[e.LocalWorkflow=0]="LocalWorkflow",e[e.ServerWorkflow=1]="ServerWorkflow",e[e.Submitted=2]="Submitted"}(un||(un={}));const pn=(e,t)=>{t?(e.resultDescription=t,e.success=!1,b.tG.error(509203144,b.nh.CoreDefault,e.stop())):b.tG.info(509203143,b.nh.CoreDefault,e.stop())},fn=e=>!e.items.some((e=>e.source&&0===e.source.indexOf("ThirdParty")));class gn{constructor(e){var t,n;this.annotationActivationTrackers=new Map,this.annotationCallbacks=new Map,this.apologyCallbacks=new Map,this.annotationResultStates=new Map,this.tokensByAnnotationType=new Map,this.registeredContextTypes=new Set,this.availableContexts=new Map,this.nextSyncSequenceId=1,this.allowSeed=!0,this.allowGroupSeed=!0,this.seedGroupSize=0,this.batchedSeedMessageGroupSize=0,this.hasSessionConnected=!1,this.isSessionClosed=!1,this.serverAuthenticationState=Te.f.NotAuthenticated,this.sessionCloseCallbacks=new Map,this.connectCallbacks=new Map,this.reconnectCallbacks=new Map,this.disconnectCallbacks=new Map,this.sessionStateCallbackToken=0,this.workflowGraph=new ht,this.workflowDefinitionManager=new mt,this.contextIdManager=new bt(yt.JsClient,this.workflowGraph),this.workflowItemStorage=new _t(this.workflowDefinitionManager),this.pendingConnectCallbacks=[],this.onAnnotationsSubmittedEnabled=!1,this.reduceBatchOperationsEnabled=!1,this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled=!1,this.batchMessagesEnabled=!1,this.seedingStatus=It.e9.NotStarted,this.onConnectTelemetryCG=void 0,this.cachedClaimsChallenge={claimsVersion:0,actionRequired:!1},this.tokenMessageVersion=1,this.hostCallbacks=e.hostCallbacks,this.sessionManager=e.sessionManager,this.batchMessagesEnabled=e.batchMessagesEnabled||!1,this.reduceBatchOperationsEnabled=e.reduceBatchOperationsEnabled||!1,this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled=e.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled||!1,this.operationBatchConfig=e.batchOptions?this.getOperationBatchConfig(e.batchOptions):void 0,this.extensionConfigs=e.extensionConfigs,this.clientMetadata=e.clientMetadata,this.userContext=e.userContext,this.localWorkflowManager=e.localWorkflowManager,this.annotationResultsProcessor=e.annotationResultsProcessor,this.gateUtils=e.gateUtils,this.localRegisteredWorkflows=e.localRegisteredWorkflows||[],this.enableRemoteExecutionNotification=e.enableRemoteExecutionNotification||!1,this.networkMode=e.networkMode,this.egress=e.egress,this.serverAuthenticationStateChangeCallback=[],this.claimsChallengeCallback=[],this.seedingStatusChangeCallbacks=[],this.onAnnotationsSubmittedEnabled=e.onAnnotationsSubmittedEnabled||!1,this.annotationDoesNotExistOnServiceEnabled=e.annotationDoesNotExistOnServiceEnabled||!1,this.sessionManager.on("sessionClose",this.onSessionClose.bind(this)),this.sessionManager.on("reconnect",this.onReconnect.bind(this)),this.sessionManager.on("connect",this.onConnect.bind(this)),this.sessionManager.on("disconnect",this.onDisconnect.bind(this)),this.sessionManager.on("resetNextSyncSequenceId",this.resetNextSyncSequenceId.bind(this)),this.sessionManager.on("serverAuthenticationStateChange",this.onServerAuthenticationStateChange.bind(this)),this.sessionManager.onMessage(Ce.B_.getTypeName(),this.onAnnotationResultsFromServer.bind(this)),this.sessionManager.onMessage(Ce.$j.getTypeName(),this.onAnnotationResultStateMessage.bind(this)),this.sessionManager.onMessage(Ce.Gs.getTypeName(),this.onWorkflowExecutionCompleteMessage.bind(this)),this.sessionManager.onMessage(Ce.Sy.getTypeName(),this.onClaimsChallengeMessage.bind(this)),this.sessionManager.onMessage(Ce.fr.getTypeName(),this.onSeedingStatusChangeMessage.bind(this)),e.isDeltaGeneratorEnabled&&(this.enableSyncDeltaSending=!e.disableSyncDeltaSending,this.syncDeltaTimeout=null!==(t=e.syncDeltaTimeout)&&void 0!==t?t:700,this.enableDeltaGenerator()),this.setServerAuthenticationStateChangeCallback(this.updateGraphOnAuthStateChange.bind(this)),(null===(n=this.gateUtils)||void 0===n?void 0:n.isChangeGateEnabledSync(Eo))||this.setClaimsChallengeCallback(this.requestAuthTokenWithClaims.bind(this))}enabledRemoteExecutionNotification(){return this.enableRemoteExecutionNotification}getSessionReconnectParams(){if(!this.connectParams)throw new Error("Session has not been established yet.");return{sessionUrl:this.connectParams.sessionUrl,origin:this.connectParams.origin,authToken:this.connectParams.authToken,nextSyncSequenceId:this.nextSyncSequenceId}}setNextSequenceId(e){this.nextSyncSequenceId=e}tryGetDocSessionId(){if(this.clientMetadata&&this.clientMetadata.docSessionId)return this.clientMetadata.docSessionId}getSessionStateCallbackToken(e){var t;return e+"-callback-"+(null!==(t=this.tryGetDocSessionId())&&void 0!==t?t:"unknown")+"-"+this.sessionStateCallbackToken++}updateGraphOnAuthStateChange(e){this.tryActivateWorkflows()}tryActivateWorkflows(){if(this.enableRemoteExecutionNotification){const e=new L.I({operationName:"GraphServerWorkflowActivation",success:!0}).setClientMetadata(this.clientMetadata).start(),t=[];this.workflowGraph.getWorkflowNodes().filter((e=>e.location===dt.External)).forEach((e=>{this.localWorkflowManager.canActivateWorkflow(e,this)?e.isActivated=!0:(this.localWorkflowManager.deactivateServerWorkflow(e,this),t.push(e.workflow.id))})),e.resultDescription=`deactivated workflows: [${t.join()}]`,b.tG.info(508879493,b.nh.CoreDefault,e.stop())}}initialize(){return dn(this,void 0,void 0,(function*(){return this.localWorkflowManager&&this.localWorkflowManager.addSession(this),this.registerLocalWorkflowsWithoutGraphInit(this.localRegisteredWorkflows),this.gateUtils&&!this.onConnectTelemetryCG&&(this.onConnectTelemetryCG=yield this.gateUtils.isChangeGateEnabled("OnConnectTelemetry")),yield this.sessionManager.init(this.extensionConfigs,this.hostCallbacks.onInitSession?this.hostCallbacks.onInitSession:void 0,this.egress),this.localWorkflowManager&&this.localWorkflowManager.setTokenCallback(this.getAuthToken.bind(this)),this}))}isLocalWorkflowRegistered(e){return this.getLocalRegisteredWorkflows().some((t=>e===t.id))}get isConnected(){return!!this.connectParams}get hasConnected(){return this.hasSessionConnected}get isClosed(){return this.isSessionClosed}getServerAuthenticationState(){return this.serverAuthenticationState}getContextIdManager(){return this.contextIdManager}getWorkflowItemStorage(){return this.workflowItemStorage}getWorkflowDefinition(e,t){return this.workflowDefinitionManager.getWorkflowDefinition(e,t)}registerLocalWorkflows(e){this.registerLocalWorkflowsWithoutGraphInit(e),this.trySendWorkflowGraphInitMessage()}registerLocalWorkflowsWithoutGraphInit(e){if(e.length&&this.localWorkflowManager)for(const t of e)this.localWorkflowManager.registerLocalWorkflow(t,this)}registerLocalWorkflow(e){this.registerLocalWorkflows([e]);const t=new L.I({operationName:"SessionRegisterLocalWorkflow",resourceId:e.id,success:!0}).setClientMetadata(this.clientMetadata).start();pn(t)}activateAnnotation(e,t,n){var o;const s=new Nt(this.sendMessageToSession.bind(this),e,t,this.annotationDoesNotExistOnServiceEnabled),r=(t,n)=>{let o=t.get(e);o||(o=new Map,t.set(e,o)),o.set(s.token,n)};(null==t?void 0:t.callback)&&r(this.annotationCallbacks,null==t?void 0:t.callback),(null==t?void 0:t.apologyCallback)&&r(this.apologyCallbacks,null==t?void 0:t.apologyCallback);const i=null!==(o=this.tokensByAnnotationType.get(e))&&void 0!==o?o:[];return-1===i.indexOf(s.token)&&i.push(s.token),this.tokensByAnnotationType.set(e,i),this.annotationActivationTrackers.set(s.token,s),this.activateAnnotationForTracker(s,{ignoreExistingAnnotations:!1,sendOnlyIfConnected:!1,sendApologies:void 0!==(null==t?void 0:t.apologyCallback)})}activateServerRequestResponse(e,t,n){return dn(this,void 0,void 0,(function*(){yield this.activateAnnotation(e,{callback:(e,n)=>{for(const n of e.items){const e=new L.I({operationName:"ServerRequestResponseAnnotationReceived",success:!0}).setClientMetadata(this.clientMetadata).start(),o=n.body;if(!(null==o?void 0:o.workflowExecutionCorrelation)){const t="Received annotation without workflowExecutionCorrelation";throw pn(e,t),new Error(t)}let s=!1;const r=(t,n)=>{if(s){const t="Final response has already been sent for this annotation";throw pn(e,t),new Error(t)}s=void 0===n||n;const r=new Ce.iT({workflowExecutionCorrelation:o.workflowExecutionCorrelation,finalResponse:s,content:t}),i=this.submitCustomMessage(r).catch((t=>{throw pn(e,`Error submitting response: ${t.message}`),t}));return n&&pn(e),i};null==t||t.onAnnotationCallback(o,r).catch((t=>{pn(e,`Error in onAnnotationCallback: ${t.message}`)}))}}},n)}))}activateAnnotationForTracker(e,t){const n=new L.I({operationName:"ActivateAnnotation",resourceId:e.annotationType,success:!0}).setClientMetadata(this.clientMetadata).start();return n.setDataField("StartTimestamp",Date.now()),e.activate(t.ignoreExistingAnnotations,t.sendOnlyIfConnected,t.sendApologies).then((o=>(n.resultSignature="Ok",n.resultDescription=`Activated annotation ${e.annotationType} with token ${e.token}; sendOnlyIfConnected: ${t.sendOnlyIfConnected}`,pn(n),o))).catch((o=>{throw pn(n,`error on activate annotation type ${e.annotationType}: ${o}; sendOnlyIfConnected: ${t.sendOnlyIfConnected}`),o}))}updateAnnotationConfig(e,t){const n=new Ce.Ol({token:e,config:t});this.sendMessageToSession(n);const o=this.annotationActivationTrackers.get(e);o&&o.options&&(o.options.config=t)}releaseAnnotation(e){const t=this.annotationActivationTrackers.get(e);if(t){this.annotationActivationTrackers.delete(e);const n=n=>{const o=n.get(t.annotationType);o&&(o.delete(e),0==o.size&&n.delete(t.annotationType))};return n(this.annotationCallbacks),n(this.apologyCallbacks),t.release()}return Promise.resolve(!1)}setAnnotationState(e,t,n){const o={state:n};this.submitOperation(new he.XP({parentPath:e,items:[{id:t}],M_:o}))}setAnnotationMetadata(e,t,n){this.submitOperation(new he.XP({parentPath:e,items:[{id:t}],M_:n}))}submitOperation(e,t){this.submitOperations([e],t)}submitOperations(e,t){var n,o;if(t||(t=this.generateCorrelationId()),tn(e,t,Date.now(),"SubmitInRuntimeClient",new L.I({operationName:"AugloopClientPerfTracker",success:!0}).setClientMetadata(this.clientMetadata).start()),this.contextIdManager.applyContextIdOnOperations(e),this.updateWorkflowExecutionStates(e),!this.onAnnotationsSubmittedEnabled){const[n,o]=this.partitionAnnotationOperations(e);this.executeCallbacksOnAnnotationSubmitted(n,t)}const s=e.filter(this.filterOperationsForSession.bind(this)).filter(fn),r=[];if(this.deltaGenerator){const e=new L.I({operationName:"ExecuteDeltaGenerator",success:!0}).setClientMetadata(this.clientMetadata).start();for(const e of s)if(he.fZ.typeGuard(e))r.push(...this.createDeltasFromUpdateOperation(e));else{const t=e;for(const s of t.items)he.Xr.typeGuard(e)?this.deltaGenerator.addItemToLocalMap(s,t.parentPath):he.n4.typeGuard(e)?this.deltaGenerator.deleteItemFromLocalMap(s,t.parentPath):he.hW.typeGuard(e)&&this.deltaGenerator.moveItemsInLocalMap(e.parentPath,e.prevParentPath,null!==(o=null===(n=e.items)||void 0===n?void 0:n.map((e=>e.id)))&&void 0!==o?o:[]);r.push(e)}pn(e)}if(this.onAnnotationsSubmittedEnabled){const[e,n]=this.partitionAnnotationOperations(r.length?r:s);this.onAnnotationsSubmitted(e,t),this.submitOperationsToSession(n,t)}else this.submitOperationsToSession(r.length?r:s,t);this.localWorkflowManager&&this.localWorkflowManager.runLocalWorkflows(e,this,!0)}submitSeedOperations(e,t){if(!this.allowSeed)throw new Error("Cannot submit seed operations more than once per session");if(this.networkMode===D.LocalWorkflowsOnly&&this.localWorkflowManager)return void this.localWorkflowManager.runLocalWorkflows(e,this);t||(t=this.generateCorrelationId()),this.allowSeed=!1,this.allowGroupSeed=!1;const[n,o]=this.partitionAnnotationOperations(e);this.onAnnotationsSubmittedEnabled?this.onAnnotationsSubmitted(n,t):this.executeCallbacksOnAnnotationSubmitted(n,t),this.operationBatchConfig?this.sendSeedMessagesViaBatchManager(this.onAnnotationsSubmittedEnabled?o:e,!0,t):this.sendMessageToSession(new Ce.Tb({cv:t,seq:0,ops:this.onAnnotationsSubmittedEnabled?o:e}))}submitSeedGroupOperations(e,t,n){if(!this.allowGroupSeed)throw new Error("Seed operations are not allowed for this session");if(this.networkMode===D.LocalWorkflowsOnly&&this.localWorkflowManager)return void this.localWorkflowManager.runLocalWorkflows(e,this);n||(n=this.generateCorrelationId()),t&&(this.allowGroupSeed=!1),this.allowSeed=!1;const[o,s]=this.partitionAnnotationOperations(e);this.executeCallbacksOnAnnotationSubmitted(o,n),this.onAnnotationsSubmittedEnabled?this.onAnnotationsSubmitted(o,n):this.executeCallbacksOnAnnotationSubmitted(o,n),this.operationBatchConfig?this.sendSeedMessagesViaBatchManager(this.onAnnotationsSubmittedEnabled?s:e,!!t,n):(this.seedGroupSize++,this.sendMessageToSession(new Ce.Tb({cv:n,seq:0,ops:this.onAnnotationsSubmittedEnabled?s:e,groupId:"Seed",groupSize:t?this.seedGroupSize:void 0,groupComplete:t||void 0})))}submitCustomMessage(e){return new Promise(((t,n)=>{this.sendMessageToSession(e,((o,r)=>{o?n(new Error(`${o.error}; for message type: ${s.h.getTypeNameFor(e)}`)):t(r)}))}))}submitLargeBinaryDataMessage(e){return new Promise(((t,n)=>{this.sendMessageToSessionPostEndpoint(e,((e,o)=>{e?n(new Error(e.error)):t(o)}))}))}submitBinaryStreamUploadMessage(e){return new Promise(((t,n)=>{const o=new L.I({operationName:"sendBinaryStreamUploadMessage",success:!0}).setClientMetadata(this.clientMetadata).start();if(this.connectParams)Kt(this.connectParams,e,o,((e,o)=>{e?n(new Error(e.error)):t(o)}));else{const s=(s=>Kt(s,e,o,((e,o)=>{e?n(new Error(e.error)):t(o)}))).bind(this);this.pendingConnectCallbacks.push(s)}}))}requestBinaryDataForBlob(e){return e.data?Promise.resolve(e.data):e.dataPointer&&e.dataPointer.refType!==Mt.J1.None?new Promise(((t,n)=>{this.requestBinaryDataFromSessionBlobEndpoint(e.dataPointer,((e,o)=>{e?n(e):t(o)}))})):Promise.reject(new Error("Blob does not have a data pointer"))}requestCacheDump(e){if(e)throw new Error("NYI");return this.submitCustomMessage(new Ce.z_)}forceReconnect(e){return this.extensionConfigs=e,this.sessionManager.forceReconnect(e)}close(e){var t;this.isSessionClosed=!0,this.sessionManager.closeSession(e),this.localWorkflowManager&&this.localWorkflowManager.closeSession(this),this.graphInitMessageTimer&&(clearTimeout(this.graphInitMessageTimer),this.graphInitMessageTimer=void 0),(null===(t=this.gateUtils)||void 0===t?void 0:t.isChangeGateEnabledSync(Ao))||this.batchedOperationsManager&&this.batchedOperationsManager.close()}authenticateInteractive(e){return dn(this,void 0,void 0,(function*(){if((!e||!e.forceUserPrompt)&&this.cachedClaimsChallenge.claimsVersion>0&&!this.cachedClaimsChallenge.actionRequired)return;const t=yield this.requestAuthTokenInteractive(this.cachedClaimsChallenge,{interactive:!0});if(Ce.D0.typeGuard(t))throw new Error(t.reason)}))}getClientMetadata(){return this.clientMetadata}getUserContext(){return this.userContext}setSessionCloseCallback(e){const t=this.getSessionStateCallbackToken("close");return e&&this.sessionCloseCallbacks.set(t,e),t}setConnectCallback(e){const t=this.getSessionStateCallbackToken("connect");return e&&this.connectCallbacks.set(t,e),t}setDisconnectCallback(e){const t=this.getSessionStateCallbackToken("disconnect");return e&&this.disconnectCallbacks.set(t,e),t}setReconnectCallback(e){const t=this.getSessionStateCallbackToken("reconnect");return e&&this.reconnectCallbacks.set(t,e),t}removeSessionStateCallback(e){function t(t){return!!t.has(e)&&(t.delete(e),!0)}return t(this.sessionCloseCallbacks)||t(this.reconnectCallbacks)||t(this.disconnectCallbacks)||t(this.connectCallbacks)}setServerAuthenticationStateChangeCallback(e){this.serverAuthenticationStateChangeCallback.push(e),e(this.serverAuthenticationState)}setClaimsChallengeCallback(e){this.cachedClaimsChallenge.actionRequired&&e(this.cachedClaimsChallenge),this.claimsChallengeCallback.push(e)}setSeedingStatusChangeCallback(e){e(new Ce.fr({newStatus:this.seedingStatus})),this.seedingStatusChangeCallbacks.push(e)}getConnectParams(){return this.connectParams}setOfflineMode(){this.sessionManager=new Zt}onAnnotationResults(e,t,n){b.tG.info(508916486,b.nh.CoreDefault,new L.I({operationName:"OnAnnotationResultsEgress",dimension0:null==e?void 0:e.annotationType,success:!0,cv:e.cv})),n(void 0,new Ce.YK),t===un.LocalWorkflow&&this.contextIdManager.applyContextIdOnOperations(e.ops),this.updateWorkflowExecutionStates(e.ops),this.egress&&this.egress(e,(()=>{})),this.annotationResultsProcessor.process(e,((e,n)=>{this.applyOperationForContext(e,n,t)}),((n,o)=>{const s=Date.now();this.triggerRegisteredAnnotationCallbacks(n,e.annotationType,o,e.areApologies),t===un.ServerWorkflow&&nn(e,s,"CallbackInRuntimeClient",!0,new L.I({operationName:"AugloopClientPerfTracker",success:!0}).setClientMetadata(this.clientMetadata).start())}),(e=>{if(t!==un.ServerWorkflow){const t=e.ops.filter(this.filterOperationsForSession.bind(this)).filter(fn);this.submitOperationsToSession(t,e.cv)}this.localWorkflowManager&&this.localWorkflowManager.runLocalWorkflows(e.ops,this)}))}onAnnotationResultStateMessage(e,t){var n;t(void 0,new Ce.YK);for(const t of e.updates){const{annotationType:e,state:o}=t;if(!this.tokensByAnnotationType.has(e))continue;let s;s=this.annotationResultStates.has(e)?this.annotationResultStates.get(e):o===It.K7.Idle?It.K7.Pending:It.K7.Idle;for(const t of this.tokensByAnnotationType.get(e)){const e=this.annotationActivationTrackers.get(t);(null===(n=e.options)||void 0===n?void 0:n.stateUpdateCallback)&&e.options.stateUpdateCallback(s,o)}}}submitOperationsToSession(e,t){t||(t=this.generateCorrelationId());const n=e.filter((e=>he.g0.typeGuard(e))),o=e.filter((e=>!he.g0.typeGuard(e)));if(n.length>0&&this.sendMessageToSession(new Ce.Tb({cv:t,ops:n})),o.length>0)if(this.operationBatchConfig){if(!this.batchedOperationsManager){let e;e=this.batchMessagesEnabled?(e,t,n)=>{if(e.length){const t=new Ce.l0;t.messages=[],e.forEach((e=>{t.messages.push(new Ce.Tb({cv:e.cv,seq:this.nextSyncSequenceId++,ops:e.input}))})),this.sendMessageToSession(t,(e=>{n(e?new Error(e.error):void 0)}))}}:(e,t,n)=>{this.sendMessageToSession(new Ce.Tb({cv:t.cv,seq:this.nextSyncSequenceId++,ops:e}),(e=>{n(e?new Error(e.error):void 0)}))},this.batchedOperationsManager=new Ut(e,this.reduceBatchOperationsEnabled,this.batchMessagesEnabled,void 0,this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled)}this.batchedOperationsManager.addBatchItem(o,this.operationBatchConfig,{name:"SubmitOperations"},t)}else this.sendMessageToSession(new Ce.Tb({cv:t,seq:this.nextSyncSequenceId++,ops:o}))}sendMessageToSession(e,t){this.sessionManager.sendMessage(e,t),Ce.w9.typeGuard(e)&&this.close()}sendMessageToSessionPostEndpoint(e,t){const n=new L.I({operationName:"SendLargeBinaryDataMessage",success:!0,cv:e.cv}).setClientMetadata(this.clientMetadata).start();if(this.connectParams)Jt(this.connectParams,e,n,t);else{const o=(o=>Jt(o,e,n,t)).bind(this);this.pendingConnectCallbacks.push(o)}}requestBinaryDataFromSessionBlobEndpoint(e,t){const n=new L.I({operationName:"RequestBinaryData",success:!0,cv:(new at).toString()}).setClientMetadata(this.clientMetadata).start();if(this.connectParams)Yt(this.connectParams,e,t,n);else{const o=(o=>Yt(o,e,t,n)).bind(this);this.pendingConnectCallbacks.push(o)}}registerContextTypes(e){for(const t of e)this.activateAnnotation(t),this.registeredContextTypes.add(t)}applyOperationForContext(e,t,n){let o=s.h.getTypeNameFor(e);if(o!=he.Xr.getTypeName()&&o!=he.I.getTypeName()&&o!=he.fZ.getTypeName()&&o!=he.n4.getTypeName())return;o==he.I.getTypeName()&&(o=he.Xr.getTypeName());const r=Tt(this.resolvePlaceholdersInOperationParentPath(e.parentPath),t),i=Ct(r.parentPath);if(o==he.Xr.getTypeName()||o==he.fZ.getTypeName()){if(!r.body)return;const e=s.h.getTypeNameFor(r.body);if(!this.registeredContextTypes.has(e))return;let t=this.availableContexts.get(e);t||(t=new Map,this.availableContexts.set(e,t));let a=t.get(n);if(a||(a=[],t.set(n,a)),r.id||this.localWorkflowManager&&(r.id=this.localWorkflowManager.getNextClientAnnotationId()),o==he.Xr.getTypeName())0==a.filter((e=>Ct(e.parentPath)==i&&e.id==r.id)).length?a.push(r):b.tG.info(540848911,b.nh.CoreDefault,`AddOperation for (${n}, ${r.id}, ${r.source}) can't be applied as the context item with matching path and ID already exists. Use UpdateOperation instead.`);else for(let e=0;e<a.length;e++)if(a[e].id==r.id&&Ct(a[e].parentPath)==i){if(a[e].source==r.source){a[e]=r;break}b.tG.warn(540848912,b.nh.CoreDefault,`UpdateOperation for (${n}, ${r.id}, ${r.source}) can't be applied as the context item with provided path and ID has different source: ${a[e].source}`)}else b.tG.warn(540848913,b.nh.CoreDefault,`UpdateOperation for (${n}, ${r.id}, ${r.source}) can't be applied as the context item with matching path and ID was not found. AddOperation should be used instead`)}else if(o==he.n4.getTypeName()){if(!r.id)return;this.availableContexts.forEach(((e,t)=>{let o=e.get(n);o&&(o=o.filter((e=>!(Ct(e.parentPath)==i&&e.id==r.id))),0==o.length?e.delete(n):e.set(n,o),0==e.size?this.availableContexts.delete(t):this.availableContexts.set(t,e))}))}}updateWorkflowExecutionStates(e){if(this.localWorkflowManager){const t=this.enableRemoteExecutionNotification?this.workflowGraph.getWorkflowNodes().map((e=>e.workflow)):this.localWorkflowManager.getAllRegisteredWorkflowsFromSession(this);for(const n of e)if(vt.has(s.h.getTypeNameFor(n)))for(const e of n.items)for(const n of t||[])this.localWorkflowManager.preProcessItemToWorkflow(n,e,this)}}resolveRequestedContexts(e){const t=[];for(const[n,o,s]of Ot(e.requestedContextTypesRules)){if(!this.availableContexts.has(n)){if(o==ee.Required)return[!1,[]];continue}const e=Array.from(this.availableContexts.get(n).values()).reduce(((e,t)=>e.concat(t)),[]);if(0==e.length)throw new Error(`Assert: availableContexts have the entry for ${n} which does not contain any context annotation.`);t.push(...e)}return[!0,this.removeDuplicatedContextItems(t)]}removeDuplicatedContextItems(e){return e.filter(((e,t,n)=>n.findIndex((t=>sn.deepEquals(t,e)))===t))}getContextAnnotations(e,t,n,o){var s,r;const i=n?Ct(n):void 0;return null===(r=null===(s=this.availableContexts.get(e))||void 0===s?void 0:s.get(t))||void 0===r?void 0:r.filter((e=>!(i&&Ct(e.parentPath)!=i||o&&e.source!=o)))}onWorkflowDefinitionOverrideMessage(e){const t=new L.I({operationName:"WorkflowDefinitionOverride",success:!0}).setClientMetadata(this.clientMetadata).start(),n=e=>{throw pn(t,e),Error(`WorkflowDefinitionOverride: ${e}`)};if(!this.localWorkflowManager)return void n("Not supported by this local SessionProxy instance.");const o=this.localWorkflowManager.getWorkflowDefinitionsByName(this),s=o.get(e.sourceWorkflowId);if(!s)return void n(`Workflow registration for source workflow '${e.targetWorkflowId}' was not found.`);t.resourceId=s.id;const r=o.get(e.targetWorkflowId);r&&(r.allowDefinitionOverride?s.definitionOverrideTargetWorkflows&&-1!==s.definitionOverrideTargetWorkflows.indexOf(r.id)?(this.workflowDefinitionManager.mergeWorkflowDefinition(r,e.definition,e.contextId),t.resultDescription=`Updated config for workflow: ${e.targetWorkflowId}, context id: ${e.contextId}`,pn(t)):n(`Workflow '${s.id}' does not allow workflow definition for workflow '${r.id}'.`):n(`Workflow '${r.id}' does not allow workflow definition override.`))}applyContextIdOnOperations(e){this.contextIdManager.applyContextIdOnOperations(e)}attachToWorkflowGraph(e){this.addToWorkflowGraph(e),this.attachExecutionTrackerToEachWorkflow()}triggerRegisteredAnnotationCallbacks(e,t,n,o){if(this.callAnnotationCallbacks(e,t,n,o),this.hostCallbacks.onAnnotationResult)try{o?this.hostCallbacks.onApologyResult&&this.hostCallbacks.onApologyResult(e,n):this.hostCallbacks.onAnnotationResult(e,n)}catch(e){b.tG.error(540301151,b.nh.CoreDefault,new L.I({operationName:"HostCallbackOnAnnotationResultError",dimension0:t,resultDescription:`onAnnotationResult error: ${e}`}))}}attachExecutionTrackerToEachWorkflow(){this.localWorkflowManager&&this.localWorkflowManager.attachExecutionTrackerToEachWorkflow(this.workflowGraph,this,this.onWorkflowExecutionComplete.bind(this))}onWorkflowExecutionCompleteMessage(e,t){t(void 0,new Ce.YK),this.localWorkflowManager&&this.localWorkflowManager.onExternalWorkflowExecuted(e.contextId,e.workflowId,this)}onWorkflowExecutionComplete(e,t){}enableDeltaGenerator(){var e,t;this.deltaGenerator=null!==(e=this.deltaGenerator)&&void 0!==e?e:new rt,this.syncDeltaTimers=null!==(t=this.syncDeltaTimers)&&void 0!==t?t:new Map}createDeltasFromUpdateOperation(e){var t,n;const o=[];b.tG.info(523776396,b.nh.CoreDefault,`Calling delta create for UpdateOperation under parent path [${e.parentPath}] (${null===(t=e.items)||void 0===t?void 0:t.length} item(s), first item id: ${(null===(n=e.items)||void 0===n?void 0:n.length)>0?e.items[0].id:"(no items)"})`);let s=[...e.parentPath];for(const t of e.items){const n=[],r=this.deltaGenerator.createTextTileDeltasFromItem(t,e.parentPath);if(null==r?void 0:r.length){for(const o of r){const r=F();s=[...e.parentPath,t.id];const i={id:r,revId:t.revId,body:o,contextId:t.contextId,source:t.source};n.push(i)}n.length>0&&(o.push(new he.xU({parentPath:s,items:n})),this.enableSyncDeltaSending&&this.setupSyncDeltaAfterDelay(t,s,n))}else b.tG.info(523329632,b.nh.CoreDefault,`Failed to create delta on item ${t.id}`)}return o}setupSyncDeltaAfterDelay(e,t,n){var o,s,r;const i=this.syncDeltaTimers.get(e.id);i&&(clearTimeout(i),this.syncDeltaTimers.delete(e.id));const a=n.find((e=>{var t;return(null===(t=e.body)||void 0===t?void 0:t.unit)===Se.Chars}));if(a){const n=a.body,i={content:"",deltaType:be.Update,length:0,position:(null!==(o=null==n?void 0:n.position)&&void 0!==o?o:0)+(null!==(r=null===(s=null==n?void 0:n.content)||void 0===s?void 0:s.length)&&void 0!==r?r:0),unit:Se.Sentence},l=Fe.typeGuard(e.body)?new ze(i):new Ve(i),c={id:F(),revId:e.revId,body:l,contextId:e.contextId,source:e.source},u=new he.xU({parentPath:t,items:[c]}),d=setTimeout(((e,t)=>{this.submitOperation(e),this.syncDeltaTimers.delete(t)}),this.syncDeltaTimeout,u,e.id);this.syncDeltaTimers.set(e.id,d)}}addToWorkflowGraph(e){this.workflowGraph.addWorkflow(ft(e))}getAnnotations(e,t){var n,o,s;const r=null!==(n=e.cv)&&void 0!==n?n:this.sessionManager.getCorrelationVector().newChild().toString(),i=new L.I({operationName:"GetAnnotations",success:!0,resultSignature:"GetAnnotationsEntry",resourceId:`${e.sourceInfo.featureId}-${e.sourceInfo.entryPoint}`,cv:r}).setClientMetadata(this.clientMetadata).start();i.setDataFields({AnnotationType:null===(o=e.annotationType)||void 0===o?void 0:o.toString(),MaxDelayMs:null===(s=e.maxDelayMs)||void 0===s?void 0:s.toString()});const a=new Oe({annotationTypes:e.annotationType,transientItems:e.transientItems,configs:e.configs,maxDelayMs:e.maxDelayMs,sourceInfo:e.sourceInfo,caller:O.Client,tryResolveUpstreamDependencies:e.tryResolveUpstreamDependencies,correlationInfo:{cvString:r},cv:r}),l=[];let c;pn(i),this.sendMessageToSession(a,((e,n)=>{(null==t?void 0:t.IsCancellationRequested)||(l.push({error:e,response:n}),null==c||c(!0))}));const u=this;let d=!1;const h=new Promise(((e,n)=>{null==t||t.onCancel((t=>{d?e():n(new Error(gn.requestCancelledError))}))}));return{[Symbol.asyncIterator](){var e,n,o,s,r,a,p;return function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,s=n.apply(e,t||[]),r=[];return o={},i("next"),i("throw"),i("return"),o[Symbol.asyncIterator]=function(){return this},o;function i(e){s[e]&&(o[e]=function(t){return new Promise((function(n,o){r.push([e,t,n,o])>1||a(e,t)}))})}function a(e,t){try{(n=s[e](t)).value instanceof hn?Promise.resolve(n.value.v).then(l,c):u(r[0][2],n)}catch(e){u(r[0][3],e)}var n}function l(e){a("next",e)}function c(e){a("throw",e)}function u(e,t){e(t),r.shift(),r.length&&a(r[0][0],r[0][1])}}(this,arguments,(function*(){for(;!d;)try{0===l.length&&(yield hn(Promise.race([new Promise((e=>c=e)),h]))),i.resultSignature="AnnotationReceived";const f=l.shift();if(null==t?void 0:t.IsCancellationRequested)throw new Error(gn.requestCancelledError);d=(null===(e=f.response)||void 0===e?void 0:e.finalResponse)||void 0!==f.error,i.setDataField("FinalResponse",d);const g=en(f.response);let m,y,v;if(i.setDataField("FirstUserPerceivedResponse",g),f.error){const e=`ErrorCode: ${f.error.code}, Error: ${f.error.error}, Retryable: ${f.error.retryable}`;i.setDataField("ServerError",e),v=f.error.error,m={serviceError:[{code:It.Qn.ServerError,error:f.error.error,retryable:null==u?void 0:u.canBeRetried(f.error)}]}}else if((null===(o=null===(n=f.response)||void 0===n?void 0:n.errorInfo)||void 0===o?void 0:o.length)>0){const e=f.response.errorInfo.map((e=>`ErrorCode: ${e.code}, Error: ${e.error}, Retryable: ${e.retryable}, ResourceId: ${e.resourceId}`)).join("\n");i.setDataField("WorkflowErrors",e),v="Workflow execution error",m={serviceError:f.response.errorInfo}}else i.resultDescription="OK";if((null===(r=null===(s=f.response)||void 0===s?void 0:s.warningInfo)||void 0===r?void 0:r.length)>0){y={serviceError:f.response.warningInfo};const e=f.response.warningInfo.map((e=>`ErrorCode: ${e.code}, Error: ${e.error}, Retryable: ${e.retryable}, ResourceId: ${e.resourceId}`)).join("\n");i.setDataField("WorkflowWarnings",e)}pn(i,v),yield yield hn({content:null===(a=f.response)||void 0===a?void 0:a.content,error:null!=m?m:void 0,warning:null!=y?y:void 0,finalResponse:null===(p=f.response)||void 0===p?void 0:p.finalResponse})}catch(e){const t=e.message===gn.requestCancelledError?It.zy.RequestCancelled:It.zy.Unknown;i.setDataField("ClientError",`ErrorCode: ${t}, Error: ${e.message}`),pn(i,null==e?void 0:e.message),yield yield hn({content:void 0,error:{clientError:{code:t,error:null==e?void 0:e.message}}}),d=!0;break}}))}}}isHttpFallback(){const e=this.sessionManager.getNetworkWorkerManager();return!(!e||e.getInitNetworkMode()!==D.JSWebSockets||e.getNetworkMode()!==D.HttpFallback)}canBeRetried(e){return(null==e?void 0:e.code)===It.xv.TooManyRequests||(null==e?void 0:e.code)===It.xv.RequestTimeout||e.error.includes(Pt.Ef.ClientDisconnected)}getAuthToken(e,t){const n={Tickets:[]};this.clientMetadata.docSessionId&&(n.DocSessionId=this.clientMetadata.docSessionId);const o=(e=>{if(e===it.OY.Substrate)return Et.Substrate})(e);o&&(n.TokenType=o),this.hostCallbacks.requestAuthToken(n).then((n=>{var o;if(!n)throw new Error("Missing AuthTokenResponse from requestAuthToken");if(!n.Token)throw new Error("Missing Token from requestAuthToken");t(void 0,n.Token,{returnedTokenType:e,timeToLiveSec:null===(o=n.TokenProperties)||void 0===o?void 0:o.timeToLiveSec})})).catch((e=>{t(e)}))}resetNextSyncSequenceId(){this.nextSyncSequenceId=1}onReconnect(){if(this.annotationActivationTrackers.forEach((e=>{var t;this.activateAnnotationForTracker(e,{ignoreExistingAnnotations:!0,sendOnlyIfConnected:!0,sendApologies:void 0!==(null===(t=e.options)||void 0===t?void 0:t.apologyCallback)}).catch((()=>{}))})),this.reconnectCallbacks.forEach(((e,t)=>{e()})),!this.connectParams)throw new Error("Expected onConnect before onReconnect")}onSessionClose(e){this.isSessionClosed=!0,this.connectParams=void 0,this.sessionCloseCallbacks.forEach(((t,n)=>{t(e)}))}onConnect(e,t,n,o,s,r,i,a){const l=new L.I({operationName:"OnConnect",success:!0}).setClientMetadata(this.clientMetadata).start();l.setDataField("HasSessionConnected",this.hasSessionConnected),l.setDataField("IsSeedingRequired",e),l.setDataField("SeedingStatus",this.seedingStatus);let c=!1;e&&(this.hasSessionConnected&&(this.allowSeed=!0,this.allowGroupSeed=!0,c=this.changeSeedingStatus(It.e9.NotStarted,"ReconnectReset",!1),this.seedGroupSize=0,this.batchedSeedMessageGroupSize=0,this.seedBatchedOperationsManager&&(this.seedBatchedOperationsManager.removeAllBatchedItems(),this.seedBatchedOperationsManager=void 0),this.batchedOperationsManager&&(this.batchedOperationsManager.removeAllBatchedItems(),this.batchedOperationsManager=void 0)),this.cachedClaimsChallenge=Object.assign(Object.assign({},this.cachedClaimsChallenge),{claimsVersion:0})),this.enableRemoteExecutionNotification&&!this.hasSessionConnected&&this.addDownstreamWorkflowsIntoClientGraph(r),this.connectParams={isSeedingRequired:e,sessionUrl:t,origin:n,authToken:o,routingSessionKey:i,blobFileId:a},this.hasSessionConnected=!0,this.tryActivateWorkflows();for(const e of this.pendingConnectCallbacks)e(this.connectParams);this.connectCallbacks.forEach(((s,r)=>{s(e,t,n,o,i,a)})),c&&this.triggerSeedingStatusChangeCallbacks(),this.serverInputTypes=s,this.onConnectTelemetryCG&&pn(l)}onDisconnect(e){this.connectParams=void 0,this.disconnectCallbacks.forEach(((t,n)=>{t(e)}))}onSeedingStatusChangeMessage(e,t){t(void 0,new Ce.YK),this.changeSeedingStatus(e.newStatus,"SeedingStatusChangeMessage")}changeSeedingStatus(e,t,n=!0){const o=new L.I({operationName:"SeedingStatusChange",success:!0}).setClientMetadata(this.clientMetadata).start();return o.setDataField("Status",It.e9[e]),o.setDataField("Reason",t),pn(o),this.seedingStatus!=e&&(this.seedingStatus=e,n&&this.triggerSeedingStatusChangeCallbacks(),!0)}triggerSeedingStatusChangeCallbacks(){this.seedingStatusChangeCallbacks.forEach((e=>{e(new Ce.fr({newStatus:this.seedingStatus}))}))}onServerAuthenticationStateChange(e){if(e!=this.serverAuthenticationState){if(this.serverAuthenticationState==Te.f.Authenticated&&e==Te.f.Pending)return;const t=new L.I({operationName:"ServerAuthStateChange",dimension0:Te.f[e],dimension1:Te.f[this.serverAuthenticationState],success:!0}).setClientMetadata(this.clientMetadata).start();t.resultDescription=`Changing Server Authentication State newState: ${Te.f[e]}, previousState: ${Te.f[this.serverAuthenticationState]}`,pn(t),this.serverAuthenticationState=e;for(const e of this.serverAuthenticationStateChangeCallback)e(this.serverAuthenticationState)}}callAnnotationCallbacks(e,t,n,o){if(0===this.annotationCallbacks.size&&0===this.apologyCallbacks.size)return;const s=o?this.apologyCallbacks.get(t):this.annotationCallbacks.get(t);s&&s.forEach((t=>{t(e,n)}))}getOperationBatchConfig(e){let t;return t=this.batchMessagesEnabled?e=>({input:e,demultiplex:()=>[[]]}):e=>({input:e.filter((e=>e.length)).reduce(((e,t)=>e.concat(t)),[]),demultiplex:()=>[[]]}),{delayMs:e.delayMs,delayMsMax:e.delayMsMax,maxInputSize:e.maxInputSize,estimateSize:Rt,groupingKeyExtractor:()=>"operations",multiplex:t,split:e=>{if(!(e.length<=1))return{inputs:e.reduce(((e,t)=>(e.push([t]),e)),[]),join:()=>[]}}}}sendSeedMessagesViaBatchManager(e,t,n){if(!this.seedBatchedOperationsManager){let e;e=this.batchMessagesEnabled?(e,t,n)=>{if(this.batchedSeedMessageGroupSize+=e.length,e.length){const o=new Ce.l0;o.messages=[],e.forEach((e=>{o.messages.push(new Ce.Tb({cv:e.cv,seq:0,ops:e.input,groupId:"Seed",groupSize:t.groupComplete?this.batchedSeedMessageGroupSize:void 0,groupComplete:t.groupComplete?t.groupComplete:void 0}))})),this.sendMessageToSession(o,(e=>{n(e?new Error(e.error):void 0)}))}}:(e,t,n)=>{this.seedGroupSize++,this.sendMessageToSession(new Ce.Tb({cv:t.cv,seq:0,ops:e,groupId:"Seed",groupSize:t.groupComplete?this.seedGroupSize:void 0,groupComplete:t.groupComplete?t.groupComplete:void 0}),(e=>{n(e?new Error(e.error):void 0)}))},this.seedBatchedOperationsManager=new Ut(e,this.reduceBatchOperationsEnabled,this.batchMessagesEnabled,void 0,this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled)}this.seedBatchedOperationsManager.addBatchItem(e,this.operationBatchConfig,{name:"SubmitSeedOperations"},n,t)}onAnnotationResultsFromServer(e,t){nn(e,Date.now(),"ReceiveFromNetwork",!0,new L.I({operationName:"AugloopClientPerfTracker",success:!0}).setClientMetadata(this.clientMetadata).start()),this.onAnnotationResults(e,un.ServerWorkflow,t)}getLocalRegisteredWorkflows(){return this.localWorkflowManager?this.localWorkflowManager.getAllRegisteredWorkflowsFromSession(this).map((e=>ft(e))):[]}sendWorkflowGraphInitMessage(){const e=this.getLocalRegisteredWorkflows(),t=new L.I({operationName:"WorkflowGraphInit",success:!0}).setClientMetadata(this.clientMetadata).start(),n=new Ce.TV({upstreamRuntimeWorkflows:e});this.sendMessageToSession(n,((n,o)=>{n?pn(t,n.error):(t.resultDescription=`local workflows: ${e.map((e=>e.id))}, remote workflows: ${o.downstreamRuntimeWorkflows.map((e=>e.id))}`,pn(t),this.onWorkflowGraphInitResponse(o))}))}trySendWorkflowGraphInitMessage(){!this.graphInitMessageTimer&&this.enableRemoteExecutionNotification&&(this.graphInitMessageTimer=setTimeout((()=>{this.graphInitMessageTimer=void 0,this.sendWorkflowGraphInitMessage()}),10))}onWorkflowGraphInitResponse(e){this.addDownstreamWorkflowsIntoClientGraph(e.downstreamRuntimeWorkflows),this.tryActivateWorkflows()}addDownstreamWorkflowsIntoClientGraph(e){this.workflowGraph.removeWorkflows(!0);for(const t of e||[])this.workflowGraph.addWorkflow(t,!0);this.attachExecutionTrackerToEachWorkflow()}resolvePlaceholdersInOperationParentPath(e){let t=e;return 3==t.length&&"session"==t[0]&&"user"==t[1]&&t[2].startsWith("user_")&&(b.tG.info(540848914,b.nh.CoreDefault,`Replacing user context placeholder for: ${Ct(e)}.`),t=["session","#userContext#"]),3==t.length&&"session"==t[0]&&"user"==t[1]&&t[2].startsWith("tenant_")&&(b.tG.info(540848915,b.nh.CoreDefault,`Replacing tenant context placeholder for: ${Ct(e)}.`),t=["session","#tenantContext#"]),t}filterOperationsForSession(e){return((e,t)=>{if(!Array.isArray(t)||0===t.length)return!0;if(he.xU.typeGuard(e)||he.XP.typeGuard(e))return!0;for(const n of e.items)if(!n.body||s.h.matchesTypesFor(n.body,t))return!0;return!1})(e,this.serverInputTypes)}executeCallbacksOnAnnotationSubmitted(e,t){const{annotationOpsMap:n,apologyOpsMap:o}=this.getAnnotationOperationsByType(e);n.forEach(((e,n)=>{Array.from(e).forEach((e=>this.triggerRegisteredAnnotationCallbacks(e,n,t,!1)))})),o.forEach(((e,n)=>{Array.from(e).forEach((e=>this.triggerRegisteredAnnotationCallbacks(e,n,t,!0)))}))}partitionAnnotationOperations(e){return e.reduce((([e,t],n)=>n.items.some((e=>e.body&&fe.YH.typeGuard(e.body)))?[[...e,n],t]:[e,[...t,n]]),[[],[]])}onAnnotationsSubmitted(e,t){const{annotationOpsMap:n,apologyOpsMap:o}=this.getAnnotationOperationsByType(e);n.forEach(((e,n)=>{const o=Array.from(e);this.onAnnotationResults(new Ce.B_({annotationType:n,ops:o,cv:t,areApologies:!1}),un.Submitted,(()=>{}))})),o.forEach(((e,n)=>{const o=Array.from(e);this.onAnnotationResults(new Ce.B_({annotationType:n,ops:o,cv:t,areApologies:!0}),un.Submitted,(()=>{}))}))}getAnnotationOperationsByType(e){const t=new Map,n=new Map;for(const o of e)for(const e of o.items)if(e.body&&fe.YH.typeGuard(e.body)){const r=(e,t)=>{const n=e.get(t)||new Set;n.add(o),e.set(t,n)};xt.k$.typeGuard(e.body)?r(n,e.body.annotationTypeName):r(t,s.h.getTypeNameFor(e.body))}return{annotationOpsMap:t,apologyOpsMap:n}}onClaimsChallengeMessage(e,t){var n;const o=new L.I({operationName:"OnClaimsChallengeMessage",dimension0:e.claimsVersion.toString(),dimension1:e.error,success:!0}).setClientMetadata(this.clientMetadata).start(),s=e.claims&&e.claims.length>0;o.resultSignature=`HasClaims: ${s}`,o.resultDescription="Received Claims Challenge Message from Server",pn(o),e.claimsVersion>this.cachedClaimsChallenge.claimsVersion&&(this.cachedClaimsChallenge=Object.assign(Object.assign({},e),{actionRequired:!0})),(null===(n=this.gateUtils)||void 0===n?void 0:n.isChangeGateEnabledSync(Eo))?this.requestAuthTokenInteractive(e).then((e=>{Ce.D0.typeGuard(e)&&this.invokeClaimsChallengeCallbacks()})).catch((()=>{})):this.invokeClaimsChallengeCallbacks(),t(void 0,new Ce.YK)}generateCorrelationId(){return this.sessionManager.getCorrelationVector().newChild().toString()}onTokenProvisionResponse(e){e&&this.onServerAuthenticationStateChange(Te.f.Authenticated)}invokeClaimsChallengeCallbacks(){for(const e of this.claimsChallengeCallback)e(this.cachedClaimsChallenge)}requestAuthTokenWithClaims(e){this.requestAuthTokenInteractive(e).catch((()=>{}))}requestAuthTokenInteractive(e,t){var n;const o=new L.I({operationName:"RequestAuthTokenInteractive",success:!0,dimension0:`isInteractive: ${null!==(n=null==t?void 0:t.interactive)&&void 0!==n&&n}`}).start();o.dimension1=`HasClaims: ${!!e.claims&&e.claims.length>0}`;const s={Tickets:[],DocSessionId:this.clientMetadata.docSessionId,TokenType:Et.Augloop,ConnectParams:this.connectParams,Claims:e.claims,Interactive:null==t?void 0:t.interactive};return this.hostCallbacks.requestAuthToken(s).then((t=>{if(!t)throw new Error("Missing AuthTokenResponse from requestAuthToken claims");if(!t.Token)throw new Error("Missing Token from requestAuthToken claims");return o.resultSignature="Token",new Ce.kd({authToken:t.Token,version:++this.tokenMessageVersion,claimsVersion:e.claimsVersion})})).catch((t=>(o.resultSignature="NoToken",o.dimension2=t.message,new Ce.D0({reason:t.message,version:++this.tokenMessageVersion,claimsVersion:e.claimsVersion,clientHandlesResponse:!0})))).then((e=>new Promise(((t,n)=>{this.sendMessageToSession(e,((s,r)=>{pn(o,null==s?void 0:s.error),s?n(new Error(s.error)):(Ce.kd.typeGuard(e)&&(this.cachedClaimsChallenge.actionRequired=!1,this.onTokenProvisionResponse(r)),t(e))}))}))))}ensureConnection(){return Promise.resolve()}keepAlive(){}}gn.requestCancelledError="Request cancelled";class mn{constructor(e){this.item=e,this.operation=e.op,this.delta=e.delta,this.deltas=e.deltas,this.id=Ct(this.itemPath),this.revId=e.revId}get itemPath(){return[...this.item.parentPath,this.item.id]}getModelIterator(){throw new Error("Method not implemented.")}getBody(){return this.item.body}getItemReference(){throw new Error("Method not implemented.")}getParentItem(e){throw new Error("Method not implemented.")}getParentItemBody(e){throw new Error("Method not implemented.")}getPrevItem(e,t){throw new Error("Method not implemented.")}getPrevItemBody(e,t){throw new Error("Method not implemented.")}getNextItem(e,t){throw new Error("Method not implemented.")}getNextItemBody(e,t){throw new Error("Method not implemented.")}getChildItem(e){throw new Error("Method not implemented.")}getChildItemBody(e){throw new Error("Method not implemented.")}getChildItems(e){throw new Error("Method not implemented.")}getChildItemBodies(e){throw new Error("Method not implemented.")}getSubtreeItem(e){throw new Error("Method not implemented.")}getSubtreeItemBody(e){throw new Error("Method not implemented.")}getSubtreeItems(e){throw new Error("Method not implemented.")}getSubtreeItemBodies(e){throw new Error("Method not implemented.")}getContextItem(e){throw new Error("Method not implemented.")}getContextItemBody(e){throw new Error("Method not implemented.")}getContextItems(e){throw new Error("Method not implemented.")}getContextItemBodies(e){throw new Error("Method not implemented.")}addAnnotation(e,t){throw new Error("Method not implemented.")}updateAnnotation(e,t){throw new Error("Method not implemented.")}deleteAnnotation(e){throw new Error("Method not implemented.")}loadSubtree(e){throw new Error("Method not implemented.")}getSourceTimestamp(){return this.item.sourceTimestamp}getContextId(){return this.item.contextId}}class yn{constructor(e,t=[]){this.scopeItem=void 0,this.rootItem=void 0,this.normalizeFilter=e=>{if(!e)return e=>void 0!==e;if("function"==typeof e)throw new Error("Not implemented yet");if((e.id?1:0)+(e.ids?1:0)+(e.itemType?1:0)+(e.itemTypes?1:0)!=1)throw new Error("Exactly one condition expected on IItemFilter");if(e.itemType)return t=>t&&s.h.matchesTypesFor(t.body,[e.itemType]);if(e.itemTypes)return t=>t&&s.h.matchesTypesFor(t.body,e.itemTypes);throw new Error("Not implemented yet")},this.items=[...t,e],this.scopeItem=new mn(e)}getItem(e){throw new Error("Method not implemented.")}getItems(e){throw new Error("Method not implemented.")}getItemBody(e){return this.getItemBodies(e)[0]}getItemBodies(e){const t=this.normalizeFilter(e);return this.items.filter(t).map((e=>e.body))}getItemByReference(e){throw new Error("Method not implemented.")}getItemBodyByReference(e){throw new Error("Method not implemented.")}}const vn=[be.CursorUpdate,be.FormattingUpdate,be.OtherNonContentUpdate,be.AttributionUpdate];function bn(e,t,n){const o=new L.I({operationName:"ApplyTextTileDeltaForLocalWorkflows",dimension0:"0",success:!0}).start();try{if(!t)return o.success=!1,o.resultDescription="Unable to apply text tile delta, parent tile is undefined",void b.tG.info(538798173,b.nh.CoreDefault,o.stop());if(s.h.getTypeNameFor(t)!==Le.getTypeName())return o.success=!1,o.resultDescription=`Unable to apply text tile delta, parent tile is not proper type: expected ${Ve.getTypeName()}, received ${s.h.getTypeNameFor(t)}`,void b.tG.info(538798174,b.nh.CoreDefault,o.stop());const n=e,r=t.content;let i="";if(void 0===n.position||n.position<0)return o.success=!1,o.resultDescription="Unable to apply text tile delta, invalid text tile position",void b.tG.info(538798175,b.nh.CoreDefault,o.stop());switch(n.deltaType){case be.Add:i=n.position<r.length?`${r.slice(0,n.position)}${n.content}${r.slice(n.position,r.length)}`:r+n.content;break;case be.Update:n.content||n.unit!==Se.Sentence||(o.dimension0="1"),i=`${r.slice(0,n.position)}${n.content}${r.slice(n.position+(n.length||0),r.length)}`;break;case be.Delete:i=`${r.slice(0,n.position)}${r.slice(n.position+(n.length||0),r.length)}`}return b.tG.info(538837071,b.nh.CoreDefault,o.stop()),new Le({content:i})}catch(e){return o.success=!1,o.resultDescription=`Error applying text tile delta: ${e}`,void b.tG.info(538798176,b.nh.CoreDefault,o.stop())}}function Sn(e,t){var n,o,s,r,i;const a=(null===(n=t.attributionData)||void 0===n?void 0:n.ranges)||t.attributionRanges;if((null===(o=t.attributionData)||void 0===o?void 0:o.isFullUpdate)||t.deltaType!==be.AttributionUpdate&&void 0!==a)return a;if(!(null===(s=e.attributionRanges)||void 0===s?void 0:s.length)&&!a||t.deltaType===be.Update&&0===t.length)return e.attributionRanges;let l=e.attributionRanges?[...e.attributionRanges]:[];if(t.deltaType!==be.AttributionUpdate){const n=Tn(e.attributionRanges,t.deltaType,t.position),o=n?l.indexOf(n):-1;-1!==o&&(n.length=t.position-n.start);const s=(null!==(r=t.content)&&void 0!==r?r:"").length,a=null!==(i=t.length)&&void 0!==i?i:0,c=t.position+a,u=t.position+s;for(const e of l.slice(o+1)){if(e.start<t.position)continue;const n=e.start+e.length;c>e.start&&(e.length=n-c),e.start=Math.max(e.start+s-a,u)}return l=l.filter((e=>e.length>0)),l}const c=[];for(const e of a)0!==c.length&&c[c.length-1].start+c[c.length-1].length>=e.start?c[c.length-1].length=e.start+e.length-c[c.length-1].start:c.push({start:e.start,length:e.length});l=l.filter((e=>e.length>0&&!(e=>{for(const t of c)if(t.start<=e.start&&t.start+t.length>=e.start+e.length)return!0;return!1})(e))),null==a||a.forEach((e=>{l.push(e)})),l.sort(((e,t)=>e.start-t.start));const u=[];for(const e of l){const t=u.length>0?u[u.length-1]:void 0;t&&t.start+t.length>e.start&&(t.length=Math.max(e.start-t.start,0)),!t||(h=e,(d=t).attribution.userId!==h.attribution.userId||d.attribution.timestamp!==h.attribution.timestamp||d.attribution.dataSource!==h.attribution.dataSource)||e.start>t.start+t.length?u.push(e):t.length+=Math.max(e.start+e.length-(t.start+t.length),0)}var d,h;return u}function wn(e,t,n){var o,r,i,a;const l=new L.I({operationName:"ApplyFormattedTextTileDeltaForLocalWorkflows",dimension0:"0",success:!0}).start();l.clientFlights=n;try{if(!t)return l.success=!1,l.resultDescription="Unable to apply formatted text tile delta, parent tile is undefined",void b.tG.info(538798177,b.nh.CoreDefault,l.stop());if(s.h.getTypeNameFor(t)!==Fe.getTypeName())return l.success=!1,l.resultDescription=`Unable to apply formatted text tile delta, parent tile is not proper type: expected ${Fe.getTypeName()}, received ${s.h.getTypeNameFor(t)}`,void b.tG.info(538798178,b.nh.CoreDefault,l.stop());const n=t,c=e,u=n.content;let d="";if((void 0===c.position||c.position<0)&&!_n(c.deltaType))return l.success=!1,l.resultDescription="Unable to apply formatted text tile delta, invalid text tile position",void b.tG.info(538798179,b.nh.CoreDefault,l.stop());if(void 0===c.content&&!_n(c.deltaType))return l.success=!1,l.resultDescription="Unable to apply formatted text tile delta, non-delete, non-formatting, non-other-non-content-update and non-cursor-update operation without content defined",void b.tG.info(538798208,b.nh.CoreDefault,l.stop());if(c.deltaType===be.Add&&0!==c.length?b.tG.info(538798209,b.nh.CoreDefault,new L.I({operationName:"ApplyDeltaChecks",resultDescription:"Received formatted text tile delta add operation with delta length, expected length 0",success:!0})):_n(c.deltaType)&&void 0!==c.content&&b.tG.info(538798210,b.nh.CoreDefault,new L.I({operationName:"ApplyDeltaChecks",resultDescription:"Received formatted text tile delta delete or non-content related operation with content defined, expected undefined",success:!0})),!Cn(c.deltaType)){const e=function(e,t){var n,o,s,r;const i=Tn(e.formattedRanges,t.deltaType,t.position);let a=e.formattedRanges?[...e.formattedRanges]:[];const l=i?a.indexOf(i):-1;-1!==l&&(t.position+(t.length||0)>i.start+i.length?i.length=t.position+(null!==(n=t.content)&&void 0!==n?n:"").length-i.start:i.length+=(null!==(o=t.content)&&void 0!==o?o:"").length-(t.length||0),a[l]=i);for(const e of a.slice(l+1))e.start<t.position||(t.position+(t.length||0)>e.start?(e.length=e.start+e.length-(t.position+(t.length||0)),e.start=t.position+(null!==(s=t.content)&&void 0!==s?s:"").length):e.start+=(null!==(r=t.content)&&void 0!==r?r:"").length-(t.length||0));return a=a.filter((e=>e.length>0)),a}(n,c),t=Sn(n,c);let s=n.ipPosition;switch(c.deltaType){case be.Add:d=c.position<u.length?`${u.slice(0,c.position)}${c.content}${u.slice(c.position,u.length)}`:u+c.content,s=c.position+c.length;break;case be.Update:c.content||c.unit!==Se.Sentence||(l.dimension0="1"),d=`${u.slice(0,c.position)}${c.content}${u.slice(c.position+(null!==(o=c.length)&&void 0!==o?o:0),u.length)}`,s=c.position+c.content.length;break;case be.Delete:d=`${u.slice(0,c.position)}${u.slice(c.position+(null!==(r=c.length)&&void 0!==r?r:0),u.length)}`,s=c.position}const i=new Fe(Object.assign(Object.assign({},n),{ipPosition:s,content:d,formattedRanges:e,attributionRanges:t,queryRange:c.queryRange}));return b.tG.info(538837073,b.nh.CoreDefault,l.stop()),i}if(c.deltaType===be.CursorUpdate)return new Fe(Object.assign(Object.assign({},n),{ipPosition:null===(i=c.cursorData)||void 0===i?void 0:i.ipPosition,isColdIp:null===(a=c.cursorData)||void 0===a?void 0:a.isColdIp}));if(c.deltaType===be.FormattingUpdate)return new Fe(Object.assign(Object.assign({},n),{formattedRanges:c.formattedRanges}));if(c.deltaType===be.OtherNonContentUpdate){let e;const t={};for(e in c.otherNonContentData)t[e]=c.otherNonContentData[e];return new Fe(Object.assign(Object.assign({},n),t))}return c.deltaType===be.AttributionUpdate?new Fe(Object.assign(Object.assign({},n),{attributionRanges:Sn(n,c)})):void 0}catch(e){return l.success=!1,l.resultDescription=`Error applying formatted text tile delta: ${e}`,void b.tG.info(538798211,b.nh.CoreDefault,l.stop())}}function Tn(e,t,n){const o=new L.I({operationName:"FindRangeForDelta",success:!0});if(o.start(),!e)return o.resultDescription="No formatted ranges found within the tile, skipping.",void b.tG.info(538798212,b.nh.CoreDefault,o.stop());if(t===be.Add){const t=e.find((e=>e.start===n&&0===e.length));if(t)return o.resultDescription=`Found a zero-length formatted range for add operation with start ${t.start}.`,b.tG.info(538798213,b.nh.CoreDefault,o.stop()),t;n=Math.max(n-1,0)}const s=e.find((e=>0===e.length?e.start===n:e.start<=n&&n<e.start+e.length));return s?(o.resultDescription=`Updating formatted range for operation with start: ${s.start} and length: ${s.length}`,b.tG.info(538798214,b.nh.CoreDefault,o.stop())):(o.resultDescription=`Unable to find formatted range for operation at position ${n}, skipping.`,b.tG.info(538798215,b.nh.CoreDefault,o.stop())),s}function Cn(e){return-1!==vn.indexOf(e)}function _n(e){return Cn(e)||be.Delete===e}class kn{constructor(e){this.model=e.model,this.clientMetadata=e.clientMetadata,this.userContext=e.userContext,this.site=e.site,this.getTokenCallback=e.getTokenCallback}get flights(){var e;return null!==(e=this._flights)&&void 0!==e||(this._flights=B(this.clientMetadata.flights)),this._flights}getToken(e,t){return this.getTokenCallback(e,t)}getTokenAsync(e){return new Promise(((t,n)=>{this.getToken(e,((e,o,s)=>{e?n(e):t(Object.assign(Object.assign({},s),{token:o}))}))}))}}class En{constructor(e,t,n){this.itemsContextId=new Set,this.executionState=new Map,this.graphNode=e,this.onContextIdWorkflowExecutionComplete=t,n&&(this.itemsContextId=n.itemsContextId,this.executionState=n.executionState)}addInputItemToProcess(e){this.itemsContextId.add(e)}removeProcessedInputItem(e){this.itemsContextId.delete(e)}countItemsToProcess(e){let t=0;for(const n of this.itemsContextId)0===n.indexOf(e)&&(t+=1);return t}getExecutionState(){return this.executionState}setExecutionState(e,t){return this.graphNode.isActivated?e?(this.executionState.set(e,t),!0):(b.tG.info(520217546,b.nh.CoreDefault,new L.I({operationName:"WorkflowExecutionTracker",resourceId:this.graphNode.workflow.id,joinContextId:e,resultDescription:`Trying to set state ${t} for a undefined contextId (setExecutionState)`})),!1):(b.tG.info(508883415,b.nh.CoreDefault,new L.I({operationName:"WorkflowExecutionTracker",resourceId:this.graphNode.workflow.id,joinContextId:e,resultDescription:`Trying to set state ${t} for a not activated workflow`})),!1)}beforeWorkflowExecution(e){this.setExecutionState(e,St.Pending)}afterWorkflowExecution(e){this.setExecutionState(e,St.Executed)&&this.tryToCompleteWorkflowExecution(e)}clearWorkflowExecutions(){this.executionState.forEach(((e,t)=>this.afterWorkflowExecution(t)))}tryToCompleteWorkflowExecution(e){if(this.executionState.get(e)===St.Executed&&this.canCompleteExecution(e)){this.executionState.delete(e),this.onContextIdWorkflowExecutionComplete&&this.onContextIdWorkflowExecutionComplete(this.graphNode.workflow.id,e);for(const t of this.downstreamWorkflowExecutionTrackers)for(const[n,o]of t.getExecutionState())o===St.Executed&&bt.isParentContextId(e,n)&&t.tryToCompleteWorkflowExecution(n)}}canCompleteExecution(e){for(const t of this.upstreamWorkflowExecutionTrackers)for(const n of t.getExecutionState().keys())if(bt.isParentContextId(n,e))return!1;return!0}}var An;!function(e){e.Unknown="",e.InputReceived="input",e.JoinMaxAnnnotation="maxAnnotation",e.JoinMaxTimeout="maxTimeout",e.JoinEarlyCompletion="earlyCompletion"}(An||(An={}));class In{constructor(e,t,n){this.executionTrackersByWorkflowNameBySession=new Map,this.workflowsWithSessionAffinity=new Map,this.workflowDefinitionsWithSessionAffinity=[],this.workflowsWithoutSessionAffinity=[],this.pendingScopeExecutionNotificationsByWorkflow=new Map,this.sweepIntervalMs=200,this.sweepTimers=new Map,this.getResourceAsArrayBuffer=(e,t,n)=>this.modelDownloader?this.modelDownloader.getResourceAsArrayBuffer(e,t,n):Promise.reject(new Error("Resource Downloader never created")),this.getResourceAsURL=(e,t,n)=>this.modelDownloader?this.modelDownloader.getResourceAsURL(e,t,n):Promise.reject(new Error("Resource Downloader never created")),this.createModel=e=>(!this.inferenceService&&this.inferenceServiceFactory&&(this.inferenceService=this.inferenceServiceFactory()),this.inferenceService?this.inferenceService.then((t=>t.createModel(e))):Promise.reject(new Error("Inference Service never created"))),this.createModelInputs=()=>{if(!this.inferenceService&&this.inferenceServiceFactory&&(this.inferenceService=this.inferenceServiceFactory()),this.inferenceService)return this.inferenceService.then((e=>e.createInputs()));throw new Error("Inference Service never created")},this.nextAnnotationId=1,this.nextSignalId=1,this.modelDownloader=e,this.inferenceServiceFactory=t,n.enableDeltas&&(this.deltaHandlers=(new Map).set(s.h.getTypeNameFor(Ve),bn).set(s.h.getTypeNameFor(ze),wn),this.itemsForDelta=new Map),this.enableEarlyJoin=n.enableEarlyJoin||!1,this.site={getResourceAsArrayBuffer:this.getResourceAsArrayBuffer,getResourceAsURL:this.getResourceAsURL,createModel:this.createModel,createModelInputs:this.createModelInputs}}getNextClientAnnotationId(){return"#AC"+this.nextAnnotationId++}getNextClientSignalId(){return"#SC"+this.nextSignalId++}registerLocalWorkflow(e,t){const n=new L.I({operationName:"WorkflowRegistration",resourceId:e.id}).start();if(0===e.inputTypes.length)throw new Error("Invalid workflow params");t?(this.workflowsWithSessionAffinity.get(t).push(this.createWorkflowImplementation(e,t)),t.registerContextTypes(Ot(e.requestedContextTypesRules).map((([e,t])=>e))),t.attachToWorkflowGraph(e),n.setClientMetadata(t.getClientMetadata())):(e.isStateful?(this.workflowDefinitionsWithSessionAffinity.push(e),this.workflowsWithSessionAffinity.forEach(((t,n)=>{t.push(this.createWorkflowImplementation(e,n))}))):this.workflowsWithoutSessionAffinity.push(this.createWorkflowImplementation(e)),this.workflowsWithSessionAffinity.forEach(((t,n)=>{n.registerContextTypes(Ot(e.requestedContextTypesRules).map((([e,t])=>e))),n.attachToWorkflowGraph(e)}))),n.success=!0,b.tG.info(572838110,b.nh.CoreDefault,n.stop())}getAllRegisteredWorkflowsFromSession(e){const t=[];return t.push(...this.workflowsWithoutSessionAffinity||[]),t.push(...this.workflowsWithSessionAffinity.get(e)||[]),t.map((e=>e.workflow))}getWorkflowDefinitionsByName(e){var t;const n=new Map;return null===(t=this.workflowsWithSessionAffinity.get(e))||void 0===t||t.forEach((e=>n.set(e.workflow.id,e.workflow))),n}getWorkflowDefinitionsWithSessionAffinity(){return this.workflowDefinitionsWithSessionAffinity}attachExecutionTrackerToEachWorkflow(e,t,n){const o=e.getWorkflowNodes(),s=this.executionTrackersByWorkflowNameBySession.get(t),r=(e,o)=>{n&&n(e,o),this.enableEarlyJoin&&(()=>{var e;for(const n of(null===(e=this.executionTrackersByWorkflowNameBySession.get(t))||void 0===e?void 0:e.values())||[])if(n.graphNode.workflow.kind===J.Join)for(const e of n.getExecutionState().keys())if(bt.isParentContextId(e,o))return!0;return!1})()&&(this.cancelSweepTimer(t),this.ensureSweepTimer(t),this.sweepScopeExecutionNotifications())};if(s){for(const e of o){const t=s.get(e.workflow.id),n=new En(e,r.bind(this),t);s.set(e.workflow.id,n)}for(const e of s.values())this.setDownstreamWorkflowExecutionTrackers(e,s),this.setUpstreamWorkflowExecutionTrackers(e,s)}}canActivateWorkflow(e,t){var n;return e.location===dt.Local||!!t.hasConnected&&!((null===(n=e.workflow.requiredTokenTypes)||void 0===n?void 0:n.length)>0&&t.getServerAuthenticationState()===Te.f.NotAuthenticated)}setDownstreamWorkflowExecutionTrackers(e,t){if(void 0!==e.downstreamWorkflowExecutionTrackers)return;e.downstreamWorkflowExecutionTrackers=new Set;const{graphNode:n}=e;for(const o of n.downstreamWorkflows||[]){const n=t.get(o.workflow.id);this.setDownstreamWorkflowExecutionTrackers(n,t),e.downstreamWorkflowExecutionTrackers.add(n)}}setUpstreamWorkflowExecutionTrackers(e,t){if(void 0!==e.upstreamWorkflowExecutionTrackers)return;e.upstreamWorkflowExecutionTrackers=new Set;const{graphNode:n}=e;for(const o of n.upstreamWorkflows||[]){const n=t.get(o.workflow.id);this.setUpstreamWorkflowExecutionTrackers(n,t),e.upstreamWorkflowExecutionTrackers.add(n)}}deactivateServerWorkflow(e,t){var n,o;e.location!==dt.Local&&(null===(o=null===(n=this.executionTrackersByWorkflowNameBySession.get(t))||void 0===n?void 0:n.get(e.workflow.id))||void 0===o||o.clearWorkflowExecutions(),e.isActivated=!1)}addSession(e){this.isWorkflowTrackingEnabled(e)&&this.executionTrackersByWorkflowNameBySession.set(e,new Map);const t=[];for(const n of this.workflowDefinitionsWithSessionAffinity)t.push(this.createWorkflowImplementation(n)),e.attachToWorkflowGraph(n);this.workflowsWithSessionAffinity.set(e,t);for(const t of this.workflowsWithoutSessionAffinity)e.attachToWorkflowGraph(t.workflow)}isWorkflowTrackingEnabled(e){return this.enableEarlyJoin||e.enabledRemoteExecutionNotification()}closeSession(e){this.cancelSweepTimer(e);for(const t of this.workflowsWithSessionAffinity.get(e)||[])t.workflowLambda.dispose();this.workflowsWithSessionAffinity.delete(e),this.isWorkflowTrackingEnabled(e)&&this.executionTrackersByWorkflowNameBySession.delete(e)}setTokenCallback(e){this.getAuthTokenCallback=e}preProcessItemToWorkflow(e,t,n){var o;const r=null===(o=this.executionTrackersByWorkflowNameBySession.get(n))||void 0===o?void 0:o.get(e.id);r&&(e.kind===J.Join&&s.h.matchesTypesFor(t.body,e.inputTypes)&&r.addInputItemToProcess(t.contextId),(e.kind===J.SingleItem&&s.h.matchesTypesFor(t.body,e.inputTypes)||e.kind===J.Join&&s.h.matchesTypesFor(t.body,[e.collectionScopeType]))&&r.beforeWorkflowExecution(t.contextId))}isReadyToEarlyJoin(e,t,n){if(!e)return!1;const o=o=>{var s;const r=Array.from(null!==(s=o.states)&&void 0!==s?s:[]).map((e=>`${e[0]}: ${e[1].map((e=>e.join()))}`)).join(),i=new L.I({operationName:"EarlyJoinCompletion",resourceId:e.graphNode.workflow.id,joinContextId:t,success:!0}).start();i.setClientMetadata(n),i.resultDescription=`isReadyToEarlyJoin (${this.enableEarlyJoin}) -> hasProcessedAllInputItems: ${o.hasProcessedAllInputItems}, allUpstreamComplete: ${o.allUpstreamComplete}, states: ${r}`,b.tG.info(512550800,b.nh.CoreDefault,i.stop())},s=0===e.countItemsToProcess(t);if(!s)return this.enableEarlyJoin||o({hasProcessedAllInputItems:s}),!1;const{allUpstreamComplete:r,states:i}=this.areAllUpstreamWorkflowComplete(e,t);return this.enableEarlyJoin?r:(o({hasProcessedAllInputItems:s,allUpstreamComplete:r,states:i}),!1)}areAllUpstreamWorkflowComplete(e,t){const n=new Map;for(const o of e.upstreamWorkflowExecutionTrackers){const e=[];for(const[s,r]of o.getExecutionState())if(e.push([s,r]),bt.isParentContextId(t,s))return n.set(o.graphNode.workflow.id,e),{allUpstreamComplete:!1,states:n};e.length>0&&n.set(o.graphNode.workflow.id,e)}return{allUpstreamComplete:!0,states:n}}runLocalWorkflows(e,t,n=!1){var o,r,i;const a=(e,n,o)=>{var r,i;const a=t.getWorkflowItemStorage(),{workflow:l}=e,c=null===(r=this.executionTrackersByWorkflowNameBySession.get(t))||void 0===r?void 0:r.get(l.id),u=l.inputTypes.concat(l.kind===J.Join?l.collectionScopeType:[]),d=new L.I({operationName:"RunLocalWorkflows",success:!0,resourceId:l.id,joinContextId:n.contextId}).start();if(d.setClientMetadata(t.getClientMetadata()),s.h.matchesTypesFor(n.body,u)){const r=Tt(o.parentPath,n);if(l.kind===J.Join){if(s.h.matchesTypesFor(r.body,[l.collectionScopeType]))return a.setScopeItem(r,l),d.resultDescription=`Scope item: ${n.id} (${s.h.getTypeNameFor(n.body)})`,b.tG.info(524126153,b.nh.CoreDefault,d.stop()),void this.setScopeExecutionNotification(t,e,r);{null==c||c.removeProcessedInputItem(r.contextId);const e=a.getScopeItem(r.contextId,l);if(!e)return d.resultDescription=`Filtered out join invalidation: out of scope type (${l.collectionScopeType}), item id: ${r.id}`,void b.tG.info(541173894,b.nh.CoreDefault,d.stop());a.addItemToWorkflowList(r,l),d.joinContextId=e.contextId,d.resultDescription=`Input item: ${n.id} (${s.h.getTypeNameFor(n.body)})`}}if(s.h.getBaseTypesFor(r.body).indexOf(de.W1.getTypeName())>=0){const e=[...r.parentPath,r.id];let n=!0;for(const o of null!==(i=l.outputTypes)&&void 0!==i?i:[])if(!t.getContextAnnotations(o,un.LocalWorkflow,e,l.id)){n=!1;break}if(n)return}const u=()=>{var o;const[s,i]=t.resolveRequestedContexts(l);if(!s)return d.resultDescription=`Required contexts are not ready for ${l.id}. Retrying execution in 500 milliseconds...`,b.tG.info(545837259,b.nh.CoreDefault,d.stop()),void setTimeout(u,500);if(l.kind===J.SingleItem)this.queueWorkflow({workflowInfo:e,scopeItem:r,inputItems:[r],requestedContexts:i,session:t,triggerReason:An.InputReceived,onCompleteCallback:this.onWorkflowExecuted.bind(this,r,l,t)}).then((()=>{b.tG.info(509154263,b.nh.WorkflowDefault,d.stop())})).catch((e=>{d.resultDescription=e,b.tG.error(572838111,b.nh.CoreDefault,d.stop())}));else if(l.kind===J.Join){const s=n.contextId,r=a.getScopeItem(s,e.workflow);if(!r)return d.resultDescription=`No scope item for ${l.id} workflow from contextId ${s}`,void b.tG.info(526758475,b.nh.CoreDefault,d.stop());const u=this.isReadyToEarlyJoin(c,r.contextId,t.getClientMetadata()),h=u?An.JoinEarlyCompletion:An.JoinMaxAnnnotation;if(a.isWorkflowReady(r.contextId,l)||u){if(!(null===(o=this.pendingScopeExecutionNotificationsByWorkflow.get(l.id))||void 0===o?void 0:o.get(r.contextId)))return d.resultDescription=`Workflow ${l.id}, contextId ${r.contextId}, already queued, skipping new scope execution`,void b.tG.info(528048977,b.nh.CoreDefault,d.stop());const n=a.getItemsToExecute(r.contextId,l);this.queueWorkflow({workflowInfo:e,scopeItem:r,inputItems:n,requestedContexts:i,session:t,triggerReason:h,onCompleteCallback:this.onWorkflowExecuted.bind(this,r,l,t)}).then((()=>{b.tG.info(509154262,b.nh.WorkflowDefault,d.stop())})).catch((e=>{d.resultDescription=e,b.tG.error(541173895,b.nh.CoreDefault,d.stop())})),this.pendingScopeExecutionNotificationsByWorkflow.get(l.id).delete(r.contextId),0===this.pendingScopeExecutionNotificationsByWorkflow.get(l.id).size&&this.pendingScopeExecutionNotificationsByWorkflow.delete(l.id)}}};u()}};let l=e;n&&(l=[new he.Xr({parentPath:["session"],items:[{id:"#userContext#",body:new de.hD}]}),new he.Xr({parentPath:["session"],items:[{id:"#tenantContext#",body:new de.SB}]})],t.getContextIdManager().applyContextIdOnOperations(l),l=l.concat(e));for(const e of l){const n=s.h.getTypeNameFor(e);for(const s of e.items)if(t.applyOperationForContext(e,s,un.Submitted),n!==he.n4.getTypeName()){if(s.body)if(n===he.xU.getTypeName()&&this.deltaHandlers&&this.itemsForDelta)this.handleLocalDeltaUpdate(s,e,t);else{null===(r=this.itemsForDelta)||void 0===r||r.set(e.parentPath.concat(s.id).toString(),s);for(const t of this.workflowsWithoutSessionAffinity)a(t,s,e);for(const n of null!==(i=this.workflowsWithSessionAffinity.get(t))&&void 0!==i?i:[])a(n,s,e)}}else null===(o=this.itemsForDelta)||void 0===o||o.delete(e.parentPath.concat(s.id).toString())}}handleLocalDeltaUpdate(e,t,n){const o=new L.I({operationName:"LocalDeltaUpdate",dimension0:s.h.getTypeNameFor(e.body),success:!0});o.start();try{const r=this.deltaHandlers.get(s.h.getTypeNameFor(e.body)),i=this.itemsForDelta.get(t.parentPath.toString());if(r&&i){const s=t.parentPath.length>0?t.parentPath.slice(0,t.parentPath.length-1):t.parentPath,a=r(e.body,i.body);if(a){const t={id:i.id,revId:e.revId,body:a,parentPath:s,delta:e.body,contextId:e.contextId},r=new he.I({parentPath:t.parentPath,items:[t]});b.tG.info(539637591,b.nh.CoreDefault,o.stop()),this.runLocalWorkflows([r],n)}else o.success=!1,o.resultDescription="Failed because the handler did not produce valid updated item",b.tG.info(539637592,b.nh.CoreDefault,o.stop())}else o.success=!1,o.resultDescription="Failed due to lack of handler or parent item",b.tG.info(539637593,b.nh.CoreDefault,o.stop())}catch(e){o.success=!1,o.resultDescription=`Failed to apply delta, error: ${e}`,b.tG.info(539637594,b.nh.CoreDefault,o.stop())}}createWorkflowImplementation(e,t){const n=e.factory();return{workflow:e,workflowLambda:n,initPromise:this.initWorkflow(e.kind,n,t)}}initWorkflow(e,t,n){const o=new kn({model:void 0,clientMetadata:n?n.getClientMetadata():void 0,userContext:n?n.getUserContext():void 0,site:this.site,getTokenCallback:this.getAuthTokenCallback});return e===J.SingleItem||e===J.Join?t.init(this.site,o):Promise.resolve()}queueWorkflow(e){var t,n;return null===(n=null===(t=this.executionTrackersByWorkflowNameBySession.get(e.session))||void 0===t?void 0:t.get(e.workflowInfo.workflow.id))||void 0===n||n.setExecutionState(e.scopeItem.contextId,St.Running),this.executeLocalWorkflow(e.workflowInfo,e.scopeItem,e.inputItems,e.session,e.requestedContexts,e.triggerReason).then((t=>{this.processAnnotationResults(t,e.session),e.onCompleteCallback()})).catch((t=>{throw e.onCompleteCallback(),t}))}processAnnotationResults(e,t){for(const n of e)t.onAnnotationResults(n,un.LocalWorkflow,(()=>{}))}executeLocalWorkflow(e,t,n,o,r,i){return new Promise(((a,l)=>{var c,u,d;const h=[],p=e.workflow,f=new L.I({operationName:"ExecuteWorkflow",resourceId:p.id,joinContextId:null!==(c=null==t?void 0:t.contextId)&&void 0!==c?c:"",resultDescription:null!=i?i:"",success:!0}).setClientMetadata(o.getClientMetadata());f.start();const g=null!==(u=null==t?void 0:t.contextId)&&void 0!==u?u:n[0].contextId,m=null!==(d=null==t?void 0:t.revId)&&void 0!==d?d:n[0].revId,y=(()=>{const e=new Map;if(t&&(t.parentPath||b.tG.error(525382231,b.nh.CoreDefault,`Missing scope item parent. Workflow: ${p.id}. Type: ${s.h.getTypeNameFor(t.body)}`),e.set(t.body,t)),Array.isArray(n))for(const t of n)t&&t.body&&(t.parentPath||b.tG.error(525382232,b.nh.CoreDefault,`Missing parent. Workflow: ${p.id}. Type: ${s.h.getTypeNameFor(t.body)}`),e.set(t.body,t));return e})(),v=(e,t=f)=>{if(e)return t.success=!1,t.resultDescription+="string"==typeof e?e:e.message,t.resultSignature="Exception",b.tG.error(572838112,b.nh.CoreDefault,t.stop()),"string"==typeof e?new Error(e):e;b.tG.info(572838113,b.nh.CoreDefault,t.stop())},S=new kn({model:new yn(n[0],r),clientMetadata:o.getClientMetadata(),userContext:o.getUserContext(),site:this.site,getTokenCallback:this.getAuthTokenCallback}),w=e=>{v(e?e.message:void 0),e?l(e):a(h)},T={setAnnotations:(r,i,a,c)=>{var u;const d=new L.I({operationName:"SetAnnotations",resourceId:i,joinContextId:null!==(u=null==t?void 0:t.contextId)&&void 0!==u?u:"",success:!0}).setClientMetadata(o.getClientMetadata());d.start();const f=t=>{b.tG.info(555866112,b.nh.CoreDefault,new ve({annotationType:i,annotationState:t,workflowId:e.workflow.id}))};for(const e of a)e.metadata=Object.assign(Object.assign({},e.metadata),{state:pe.r.Created}),f(pe.r.Created);const S=y.get(r),w=s.h.getTypeNameFor(S.body),T=(()=>{var e;if(p.kind===J.SingleItem&&n[0].body!==r){const e=`Expected obj to be ${n[0].body} but instead it was ${r}`;return v(e,d),void l(v(e))}let t,u;if(Array.isArray(a))if(!p.outputTypes||p.outputTypes.indexOf(i)<0)t=`Workflow said it would output one of [${p.outputTypes}] but instead output ${i}`;else if(S)for(const e of a)s.h.matchesTypesFor(e,[fe.YH.getTypeName()])?s.h.getTypeNameFor(e)!==i&&(t=`Workflow produced inconsistent annotation types in setAnnotations call (${s.h.getTypeNameFor(e)} did not match expected ${i})`):t=`Workflow produced an output that is not an annotation ${s.h.getTypeNameFor(e)}`;else t="No item provided";else t="Workflow produced an invalid annotation array";if(t)return v(t,d),void l(v(t));u=c&&c.isSessionAnnotation?["session"]:c&&c.ancestorType?S.parentPath:S.parentPath.concat(S.id);const h=[],y=[];for(const t of a){t.metadata=Object.assign(Object.assign({},t.metadata),{state:pe.r.Sent}),f(pe.r.Sent);const n=t.id,s=n?null===(e=o.getContextAnnotations(i,un.LocalWorkflow,u,p.id))||void 0===e?void 0:e.filter((e=>{var t;return(null===(t=e.body)||void 0===t?void 0:t.id)==n})):void 0;1==(null==s?void 0:s.length)?1==s.length?y.push({id:s[0].id,source:p.id,revId:m,body:t,contextId:g}):b.tG.error(545837260,b.nh.CoreDefault,`Assert: Multiple existing context annotations with body id ${n} found for ${i} and local workflow ${p.id}).`):h.push({id:this.getNextClientAnnotationId(),source:p.id,revId:m,body:t,contextId:g})}const w=[];return h.length>0&&w.push(new he.Xr({parentPath:u,items:h,parentRevId:m})),y.length>0&&w.push(new he.fZ({parentPath:u,items:y,parentRevId:m})),new Ce.B_({annotationType:i,ops:w})})();T?(c&&c.immediate?o.onAnnotationResults(T,un.LocalWorkflow,(()=>{})):h.push(T),(w==de.hD.getTypeName()||w==de.SB.getTypeName()||s.h.matchesTypesFor(S.body,[de.yo.getTypeName(),de.I3.getTypeName()]))&&o.submitOperationsToSession(T.ops),b.tG.info(509644822,b.nh.CoreDefault,d.stop())):b.tG.info(509644823,b.nh.CoreDefault,d.stop())},submitSignals:e=>{const t=new L.I({operationName:"submitSignalsAction",resourceId:p.id,success:!0}).setClientMetadata(o.getClientMetadata());for(const n of e){const e=s.h.getTypeNameFor(n);s.h.matchesTypesFor(n,[ge.HN.getTypeName()])||(t.resultDescription=`Workflow produced an output that is not an signal (${s.h.getTypeNameFor(n)})`,b.tG.info(521413954,b.nh.CoreDefault,t)),p.outputTypes&&-1!==p.outputTypes.indexOf(e)||(t.resultDescription=`Workflow said it would output one of [${p.outputTypes}] but instead output ${e}`,b.tG.info(521413953,b.nh.CoreDefault,t)),n.timestamp&&(In.logTimestampUsageByWorkflowId.has(p.id)||(In.logTimestampUsageByWorkflowId.add(p.id),t.resultDescription=`Workflow "${p.id}" sets signal.timeStamp`,b.tG.info(509212803,b.nh.CoreDefault,t)))}const n=e.map((e=>({id:this.getNextClientSignalId(),source:p.id,revId:m,body:e,contextId:g}))),r=new he.g0({parentPath:["session"],parentRevId:m,items:n});o.submitOperations([r])},done:w,overrideWorkflowDefinition:(e,n,s)=>{let r;switch(s){case ae.JoinContext:if(!t.contextId){const e="ContextId is not defined for this scope item.";throw b.tG.error(527472289,b.nh.CoreDefault,e),new Error(e)}r=t.contextId;break;case ae.Session:r=void 0;break;default:{const e="Defined scope is not supported. "+s;throw b.tG.error(527472290,b.nh.CoreDefault,e),new Error(e)}}const i=new De({definition:n,contextId:r,sourceWorkflowId:p.id,targetWorkflowId:e});o.onWorkflowDefinitionOverrideMessage(i)},getDynamicAnnotations:void 0,setBillingDomain:void 0,sendClientRequest:void 0,sendClientRequestStreaming:void 0},C=e.workflowLambda;if(p.kind===J.SingleItem){1!==n.length&&w(new Error("Single item workflows expect a single input")),S.delta=n[0].delta,S.deltas=n[0].deltas;try{const t=C;e.initPromise||(e.initPromise=t.init(this.site,S)),e.initPromise.then((()=>{t.execute(n[0].body,S,T)})).catch((e=>{v(e)}))}catch(e){v(e)}}else if(p.kind===J.Join){0===n.length&&w(new Error("Join workflows expect an inputs array")),S.delta=t.delta,S.deltas=t.deltas;try{const o=C;e.initPromise||(e.initPromise=o.init(this.site,S)),e.initPromise.then((()=>{o.execute(t.body,n.map((e=>e.body)),S,T)})).catch((e=>{v(e)}))}catch(e){v(e)}}else v(`Workflow kind ${p.kind} not supported`)}))}ensureSweepTimer(e){if(!this.sweepTimers.get(e)){const t=setInterval(this.onSweep.bind(this),this.sweepIntervalMs);this.sweepTimers.set(e,t)}}cancelSweepTimer(e){const t=this.sweepTimers.get(e);this.sweepTimers.get(e)&&(clearInterval(t),this.sweepTimers.delete(e))}onSweep(){this.sweepScopeExecutionNotifications()}setScopeExecutionNotification(e,t,n){var o,s;const r=Date.now(),i={session:e,workflowImplementation:t,scopeItem:n,startTime:r,minTime:r+cn(t.workflow.minDelayMs,1e3),maxTime:r+cn(t.workflow.maxDelayMs,5e3)},a=t.workflow.kind===J.Join?n.contextId:i.scopeItem.parentPath.concat(n.id).join("\\");if(this.pendingScopeExecutionNotificationsByWorkflow.get(t.workflow.id)||this.pendingScopeExecutionNotificationsByWorkflow.set(t.workflow.id,new Map),this.pendingScopeExecutionNotificationsByWorkflow.get(t.workflow.id).get(a)){const o=new L.I({resultDescription:`Duplicated pending scope execution for ${t.workflow.id} at ${a}`,operationName:"LocalScopeExecutionNotification",resourceId:t.workflow.id,joinContextId:null!==(s=null==n?void 0:n.contextId)&&void 0!==s?s:"",success:!0}).setClientMetadata(e.getClientMetadata()).start();b.tG.info(509727899,b.nh.CoreDefault,o.stop())}else{const s=new L.I({resultDescription:`New pending scope execution for ${t.workflow.id} at ${a}`,operationName:"LocalScopeExecutionNotification",resourceId:t.workflow.id,joinContextId:null!==(o=null==n?void 0:n.contextId)&&void 0!==o?o:"",success:!0}).setClientMetadata(e.getClientMetadata()).start();b.tG.info(539883075,b.nh.CoreDefault,s.stop()),this.pendingScopeExecutionNotificationsByWorkflow.get(t.workflow.id).set(a,i)}this.ensureSweepTimer(e)}sweepScopeExecutionNotifications(){var e,t;const n=new Set(Array.from(this.sweepTimers.keys()));for(const[o,s]of Array.from(this.pendingScopeExecutionNotificationsByWorkflow.entries()))for(const[r,i]of Array.from(s.entries())){const{session:s,workflowImplementation:{workflow:a}}=i,l=s.getWorkflowItemStorage(),c=new L.I({operationName:"LocalScopeExecutionNotification",resourceId:a.id,joinContextId:null!==(t=null===(e=i.scopeItem)||void 0===e?void 0:e.contextId)&&void 0!==t?t:"",success:!0}).setClientMetadata(s.getClientMetadata()).start(),u=()=>{var e;if(a.kind===J.Join){const t=Date.now(),{workflow:n}=i.workflowImplementation,o=i.scopeItem.contextId,r=s.getWorkflowDefinition(n,o).maxDelayMs;return l.isWorkflowReady(o,n)?(c.resultDescription=`Join Workflow: ${n.id} queuing by maxAnnotation, contextId: ${o}`,b.tG.info(528048978,b.nh.CoreDefault,c.stop()),{isValid:!0,triggerReason:An.JoinMaxAnnnotation}):i.startTime+r<t?(c.resultDescription=`Join Workflow: ${n.id} queuing by maxTimeout, contextId: ${o}`,b.tG.info(528048979,b.nh.CoreDefault,c.stop()),{isValid:!0,triggerReason:An.JoinMaxTimeout}):this.isReadyToEarlyJoin(null===(e=this.executionTrackersByWorkflowNameBySession.get(s))||void 0===e?void 0:e.get(n.id),o,s.getClientMetadata())?(b.tG.info(512550856,b.nh.CoreDefault,`Workflow: ${n.id} queuing by early completion, contextId: ${o}, timeout: ${r}`),{isValid:!0,triggerReason:An.JoinEarlyCompletion}):{isValid:!1,triggerReason:An.Unknown}}return{isValid:!0,triggerReason:An.Unknown}};(()=>{const{isValid:e,triggerReason:t}=u();if(!e)return!1;const[n,o]=s.resolveRequestedContexts(a);if(!n)return!1;try{if(a.kind===J.Join){const e=i.scopeItem.contextId,n=l.getScopeItem(e,a);if(n){const r=l.getItemsToExecute(n.contextId,a);if(0===r.length)return c.resultDescription=`Failed to retrieve items for workflow: ${a.id}, contextId: ${e}, skipping execution`,b.tG.info(527472291,b.nh.CoreDefault,c.stop()),this.onWorkflowExecuted(n,a,s),!0;this.queueWorkflow({workflowInfo:i.workflowImplementation,scopeItem:n,inputItems:r,requestedContexts:o,session:s,triggerReason:t,onCompleteCallback:this.onWorkflowExecuted.bind(this,n,a,s)}).catch((e=>{c.success=!1,c.resultDescription=e.message,b.tG.error(509092189,b.nh.CoreDefault,c.stop())}))}else c.resultDescription="ContextId no longer exists, skipping workflow execution",b.tG.info(539883076,b.nh.CoreDefault,c.stop())}else c.resultDescription=`Workflow in type ${a.kind} is not supported`,b.tG.error(539883077,b.nh.CoreDefault,c.stop())}catch(e){c.resultDescription=`Trying to execute ${a.id} caused an exception: ${e}`,b.tG.warn(539883078,b.nh.CoreDefault,c.stop())}return!0})()?(this.pendingScopeExecutionNotificationsByWorkflow.get(o).delete(r),0===this.pendingScopeExecutionNotificationsByWorkflow.get(o).size&&this.pendingScopeExecutionNotificationsByWorkflow.delete(o)):n.delete(s)}if(0!==n.size)for(const e of Array.from(n)){const t=new L.I({resultDescription:"No pending scope notifications left, cancelling sweep timer",operationName:"LocalScopeExecutionNotification",success:!0}).start();b.tG.debug(539883079,b.nh.CoreDefault,t.stop()),this.cancelSweepTimer(e)}}onExternalWorkflowExecuted(e,t,n){const o={id:"",parentPath:[],contextId:e},s={id:t};this.onWorkflowExecuted(o,s,n,!1)}onWorkflowExecuted(e,t,n,o=!0){var s,r;null===(r=null===(s=this.executionTrackersByWorkflowNameBySession.get(n))||void 0===s?void 0:s.get(t.id))||void 0===r||r.afterWorkflowExecution(e.contextId),o&&t.kind===J.Join&&n.getWorkflowItemStorage().onWorkflowExecuted(e,t)}}const Pn="Request timed out";function Mn(e,t,n){const o=new Gt.Request(e,t);return xn.add(o,n)}const xn=new class{constructor(e,t,n){if(this.requestInProgress=!1,this.queuedRequests=[],null==e)throw new Error("No request.");this.fetch=e,this.fetchTimeout=t,this.queueTimeout=n}tryProcessNextRequest(){if(this.requestInProgress=!1,this.queuedRequests.length>0){const[e,t,n]=this.queuedRequests.shift();clearTimeout(n),this.add(e,t)}}add(e,t){if(this.requestInProgress){const n=setTimeout((()=>{t(new Error("Timed out waiting in queue"),null),this.queuedRequests.shift()}),this.queueTimeout);this.queuedRequests.push([e,t,n])}else this.requestInProgress=!0,new Promise(((t,n)=>{let o=!1;const s=setTimeout((()=>{o=!0,n(new Error("Fetch timed out"))}),this.fetchTimeout);this.fetch(e).then((e=>{o||(clearTimeout(s),t(e))})).catch((e=>{o||(clearTimeout(s),n(e))}))})).then((e=>{t(null,e),this.tryProcessNextRequest()})).catch((e=>{t(e,null),this.tryProcessNextRequest()}))}}(Gt.fetch,2e4,12e4),Rn=JSON.stringify(new Ce.ry({error:Pn}));class Dn{constructor(e){this.networkOverrideOptions=e,this.isClosed=!1,this.pendingEgress=[]}init(e,t,n,o){const s=new L.I({operationName:"HttpWorkerInit",success:!0}).start(),r=e.split("/?x-origin=");2===r.length?(this.url=sn.convertWebSocketUrlToHttp(r[0]),this.origin=r[1]):(this.url=sn.convertWebSocketUrlToHttp(e),this.origin=void 0),this.ingress=t,this.onOpen=n,this.onClose=o,b.tG.info(507839180,b.nh.CoreDefault,s.stop())}egress(e){const t=new L.I({operationName:"HttpEgress",success:!0}).start();if(!this.isConnectedToSession()&&!e.isHttpSessionInitMessage)return this.pendingEgress.push(e),t.success=!1,t.resultDescription="NotConnected, pendingQueueSize:  "+this.pendingEgress.length.toString(),void b.tG.info(508163394,b.nh.CoreDefault,t.stop());const n=this.getRequestInfo(e,t);if(!n.url)return t.success=!1,t.resultDescription="Could not generate HTTP request",void b.tG.error(508163393,b.nh.CoreDefault,t.stop());e.isHttpSessionLongPollMessage?this.egressLongPoll(n,t):Mn(n.url,n.request,((e,n)=>{e?this.onEgressError(t,"OnEgressError:"+(null==e?void 0:e.message)):n&&n.ok?n.text().then((e=>{t.success=!0,b.tG.info(508163362,b.nh.CoreDefault,t.stop()),this.ingressInternal(e)})).catch((e=>{this.onEgressError(t,"OnEgressParseError: "+(null==e?void 0:e.message))})):this.onEgressError(t,"OnEgressResponseError: "+(null==e?void 0:e.message)+`, Status ${null==n?void 0:n.status}: ${null==n?void 0:n.statusText}`)}))}close(){const e=new L.I({operationName:"HttpWorkerClose",success:!0}).start();if(this.isClosed)return e.resultDescription="AlreadyClosed",void b.tG.info(508163360,b.nh.CoreDefault,e.stop());b.tG.info(508163359,b.nh.CoreDefault,e.stop()),this.isClosed=!0,this.sessionSettings=void 0,this.onClose&&(this.onClose(void 0),this.onClose=void 0)}onEgressError(e,t){e.success=!1,e.resultDescription=t,b.tG.error(508163358,b.nh.CoreDefault,e.stop()),this.isClosed||this.close()}ingressInternal(e,t){let n=e;t||(n=this.formatServerInput(e));n&&(this.logIngressCount(n),this.ingress(n,(e=>{Ce.uN.typeGuard(e)&&this.onSessionInitResponse(e)})))}onSessionInitResponse(e){const t=new L.I({operationName:"HttpWorkerOpen",success:!0}).start();if(!(e.sessionKey&&e.origin&&e.anonymousToken&&e.sessionUrlBase))return t.success=!1,t.resultDescription="SessionInitResponse missing information",void b.tG.error(507809949,b.nh.CoreDefault,t.stop());b.tG.info(508163357,b.nh.CoreDefault,t.stop()),this.setSessionSettings(e.sessionKey,e.origin,e.anonymousToken,e.sessionUrlBase),this.onOpen(),this.pendingEgress.forEach((e=>{this.egress(e)})),this.pendingEgress=[]}egressLongPoll(e,t){var n,o;(n=e.url,o=e.request,new Promise(((e,t)=>{const s=setTimeout((()=>{t(new Error(Pn))}),2e4);(0,Gt.fetch)(n,o||{}).then((t=>{clearTimeout(s),e(t)})).catch((e=>{clearTimeout(s),t(e)}))}))).then((e=>{e&&e.ok?e.text().then((e=>{t.success=!0,t.resourceId="LongPoll",b.tG.info(508163355,b.nh.CoreDefault,t.stop()),this.ingressInternal(e)})).catch((e=>{this.onEgressError(t,"LongPollFetchParseError: "+(null==e?void 0:e.message))})):this.onEgressError(t,"LongPollFetchStatusFailure: "+(null==e?void 0:e.statusText))})).catch((e=>{e.message===Pn?(t.success=!1,t.resultDescription="LongPollFetchResponseTimeout:"+(null==e?void 0:e.message),b.tG.error(508163353,b.nh.CoreDefault,t.stop()),this.ingressInternal(Rn,!0)):this.onEgressError(t,"LongPollFetchResponseError: "+(null==e?void 0:e.message))}))}getRequestInfo(e,t){const n=this.getUrl(null==e?void 0:e.isHttpSessionInitMessage),o=this.getHeader(e,t);return t.resultSignature=n,{url:n,request:{method:"POST",headers:o,body:e.obj}}}getUrl(e){const t=this.sessionSettings&&this.sessionSettings.sliceUrl?this.sessionSettings.sliceUrl:this.url;return e?t+"/sessioninit":this.isConnectedToSession()?t+"/session/"+this.sessionSettings.sessionKey:""}getHeader(e,t){var n;const o=new Gt.Headers;return(null==e?void 0:e.isHttpSessionInitMessage)?(o.set("Content-Type","application/json"),this.origin&&o.set("x-origin",this.origin)):this.isConnectedToSession()&&(e.obj instanceof Uint8Array||e.obj instanceof ArrayBuffer?(o.set("Content-Type","application/jsond2"),t.dimension0=e.obj.byteLength.toString().length.toString()):o.set("Content-Type","application/json"),o.append("Authorization",`Bearer ${this.sessionSettings.anonymousToken}`),o.set("x-origin",this.sessionSettings.origin)),(null===(n=this.networkOverrideOptions)||void 0===n?void 0:n.hostHeader)&&o.set("host",this.networkOverrideOptions.hostHeader),o}setSessionSettings(e,t,n,o){const s=o.replace("/session","");this.sessionSettings={sessionKey:e,origin:t,anonymousToken:n,sliceUrl:s}}isConnectedToSession(){return this.sessionSettings&&this.sessionSettings.sessionKey.length>0&&this.sessionSettings.anonymousToken.length>0&&this.sessionSettings.origin.length>0&&this.sessionSettings.sliceUrl.length>0&&!this.isClosed}formatServerInput(e){return e.length>1?e.substring(1,e.length-1):""}logIngressCount(e){const t=e.length;if(t>1e5){const e=new L.I({operationName:"HttpIngressByteOrderOfMagnitude",success:!0}).start();e.dimension2=t.toString().length.toString(),b.tG.info(508409622,b.nh.CoreDefault,e.stop())}}}class On{}var Nn,Ln,Fn=n(60221),Bn=n.n(Fn);!function(e){e.ArrivedBeforeReseeding="Message is dropped from queue since it arrived before reseeding is started",e.DroppedAsOldestInQueue="Message is dropped as oldest in full queue",e.DroppedBecauseClientDisconnected="Message is dropped because client is disconnected from server"}(Nn||(Nn={}));class Wn{constructor(e){this.logOp=new L.I({operationName:"MessageQueue",success:!0}),this.queue=new(Bn())(1e3),this.callbacks=e}clear(){this.queue.clear()}size(){return this.queue.length}push(e,t,n){this.logOp.start();const o=this.queue;if(1e3===o.length){this.logOp.resourceId="QueueFull",this.logOp.success=!1,b.tG.warn(508843746,b.nh.CoreDefault,this.logOp.stop());const e=o.shift();e.onResponse&&e.onResponse(new Ce._p({error:Nn.DroppedAsOldestInQueue}))}o.push({message:e,onResponse:t,timeQueued:sn.getCurrentTimeMs(),attemptNumber:n})}sendOnSessionInitialized(e){this.logOp.start();const t=this.queue.length;let n=0;if(t>0){const o=sn.getCurrentTimeMs()-this.queue.get(0).timeQueued;for(;this.queue.length>0&&this.callbacks.canSendMessage();){const t=this.queue.shift();e&&this.containSequencedSyncMessage(t)?(n++,t.onResponse&&t.onResponse(new Ce._p({error:Nn.ArrivedBeforeReseeding}))):t.message instanceof Uint8Array?this.callbacks.sendBytes(t.message):this.callbacks.sendMessage(t.message,t.onResponse,t.attemptNumber)}this.logOp.resourceId="SendOnSessionInitialized",this.logOp.resultDescription=`Queue size before: ${t}, after: ${this.queue.length}. droppedSyncMessages: ${n}`,this.logOp.setDataField("OldestMessageInQueueTimeWaitingMs",o),this.logOp.success=!0,b.tG.warn(508843745,b.nh.CoreDefault,this.logOp.stop())}}containSequencedSyncMessage(e){return e.message instanceof Ce.Tb&&s.h.matchesTypesFor(e.message,[Ce.Tb.getTypeName()])&&e.message.seq>=0||e.message instanceof Ce.l0&&s.h.matchesTypesFor(e.message,[Ce.l0.getTypeName()])}}!function(e){e[e.Initing=0]="Initing",e[e.Running=1]="Running",e[e.Disconnected=2]="Disconnected",e[e.Closed=3]="Closed"}(Ln||(Ln={}));const Un=(e,t,n,o)=>{t&&(t.cv||(t.cv=e.cvParent.newChild().toString()),e.messageEndpoint.sendMessage(t,((t,o)=>{t||s.h.getTypeNameFor(o)!==Ce.fZ.getTypeName()||(e.stats.lastSyncMessage=Date.now()),n&&n(t,o)}),void 0,o))},Gn=(e,t,n,o)=>{t&&(e.messageQueue.push(t,n,o),e.networkWorkerManager.init(void 0,e.customInitPromise).catch((e=>{const t=new L.I({operationName:"WorkerManagerInit",success:!1,resultDescription:`${e}`});b.tG.error(508843789,b.nh.CoreDefault,t)})))},Hn=(e,t)=>{t&&(e.messageQueue.push(t),e.networkWorkerManager.init(void 0,e.customInitPromise).catch((e=>{b.tG.error(508843788,b.nh.CoreDefault,`Init failed: ${e}`)})))};class qn{constructor(e){this.context=e}onEnter(e){}sendMessage(e,t,n,o){}sendBytes(e){}canSendMessage(){return!1}onConnectionClose(){}}class $n extends qn{constructor(){super(...arguments),this.stateName=Ln.Initing,this.possibleNextStates=[Ln.Running,Ln.Disconnected,Ln.Closed]}sendMessage(e,t,n){s.h.matchesTypesFor(e,[Ce.eE.getTypeName()])?Un(this.context,e,t,n):Gn(this.context,e,t)}sendBytes(e){Hn(this.context,e)}onConnectionClose(){this.context.setState(Ln.Disconnected)}}class Vn extends qn{constructor(){super(...arguments),this.stateName=Ln.Running,this.possibleNextStates=[Ln.Disconnected,Ln.Closed]}onEnter(e){e&&e.isSessionReseedingStarted&&this.context.resetNextSyncSequenceId(),this.context.messageQueue.sendOnSessionInitialized(e&&e.isSessionReseedingStarted)}sendMessage(e,t,n,o){Un(this.context,e,t,n)}sendBytes(e){e&&this.context.networkWorkerManager.egressBytes(e)}canSendMessage(){return!0}onConnectionClose(){this.context.setState(Ln.Disconnected)}}class zn extends qn{constructor(){super(...arguments),this.stateName=Ln.Disconnected,this.possibleNextStates=[Ln.Initing,Ln.Closed]}onEnter(e){this.context.messageEndpoint.cancelPendingResponseCallbacks(Pt.Ef.ClientDisconnected)}sendMessage(e,t,n,o){if(s.h.matchesTypesFor(e,[Ce.eE.getTypeName()]))this.context.setState(Ln.Initing),Un(this.context,e,t,n);else if(s.h.matchesTypesFor(e,[Ce.w9.getTypeName()]))this.context.setState(Ln.Closed);else{if(!o)return void Gn(this.context,e,t,n);t&&t(new Ce._p({messageId:e.messageId,error:Nn.DroppedBecauseClientDisconnected}))}}sendBytes(e){Hn(this.context,e)}}class jn extends qn{constructor(){super(...arguments),this.stateName=Ln.Closed,this.possibleNextStates=[]}onEnter(e){this.context.messageEndpoint.cancelPendingResponseCallbacks(Pt.Ef.ClientClosed)}}const Qn=3e4;class Jn{constructor(e,t,n,o){this.lastPingTime=0,this.lastPongTime=0,this.lastEgressTime=0,this.remainingPingFailures=3,this.isPingPongSuccessful=!1,this.reducedPingPongRetryEnabled=o,this.pingPongLogOp=new L.I({operationName:"WebSocketReliabilityManager",success:!0,resourceId:this.reducedPingPongRetryEnabled?"reducedPingPongRetryEnabled":""}).start(),this.pingPongLogOp.setClientMetadata(n,!0),this.worker=e,this.rateControllerClose=t}start(){this.reducedPingPongRetryEnabled?(this.pingPongLogOp.start(),this.pingPongLogOp.resultSignature="initial ping"):this.logOperation(!0,"ping","initial ping"),this.ping(),this.isPingPongSuccessful=!0,this.startInterval()}onResponse(){this.lastPongTime=Date.now(),this.reducedPingPongRetryEnabled&&(this.pingPongLogOp.success=!0,b.tG.info(506795283,b.nh.CoreDefault,this.pingPongLogOp.stop()))}isReliabilityResponse(e){return"string"==typeof e&&1===e.length&&e===Jn.pingPongMessage}close(){this.reducedPingPongRetryEnabled?(this.pingPongLogOp.start(),this.pingPongLogOp.success=!0,this.pingPongLogOp.resultSignature="close",b.tG.info(506795282,b.nh.CoreDefault,this.pingPongLogOp.stop())):this.logOperation(!0,"ping","close"),this.lastPingTime=0,this.lastPongTime=0,this.isPingPongSuccessful=!1,this.clearPingInterval(),this.worker=void 0}checkConnection(){return this.isPingPongSuccessful}postEgress(){this.lastEgressTime=Date.now()}needsParsedResponses(){return!1}ping(){this.reducedPingPongRetryEnabled?this.worker||(this.pingPongLogOp.success=!1,this.pingPongLogOp.resultDescription="websocket worker undefined",this.rateControllerClose(),b.tG.info(506795281,b.nh.CoreDefault,this.pingPongLogOp.stop())):this.lastPingTime=Date.now(),this.worker&&(this.reducedPingPongRetryEnabled&&(this.lastPingTime=Date.now()),this.worker.egress({obj:Jn.pingPongMessage}))}startInterval(){this.pingInterval=setInterval((()=>{if(this.reducedPingPongRetryEnabled){if(this.lastPongTime<this.lastPingTime&&Date.now()-this.lastPingTime<Qn)return;this.isPingPongSuccessful=this.lastPongTime>=this.lastPingTime,this.pingPongLogOp.start(),this.isPingPongSuccessful?(this.pingPongLogOp.resultSignature="ping",this.ping()):(this.pingPongLogOp.success=!1,this.pingPongLogOp.resultDescription="Pong not received",b.tG.info(506795280,b.nh.CoreDefault,this.pingPongLogOp.stop()),this.worker?this.worker.close():this.rateControllerClose())}else{if(this.isPingPongSuccessful=this.lastPongTime>=this.lastPingTime&&this.lastPongTime-this.lastPingTime<=Qn,this.lastPongTime>this.lastEgressTime)return;const e=this.lastPongTime-this.lastPingTime;this.isPingPongSuccessful?(this.remainingPingFailures=3,this.ping()):this.remainingPingFailures>0?(--this.remainingPingFailures,this.ping()):(this.logOperation(!1,"ping","Pong still not received after all retry attempts",[`${e}`,`${this.remainingPingFailures}`]),this.worker?this.worker.close():this.rateControllerClose())}}),Qn)}clearPingInterval(){this.pingInterval&&(clearInterval(this.pingInterval),this.pingInterval=void 0)}logOperation(e,t,n,o){var s,r,i,a;this.pingPongLogOp.start(),this.pingPongLogOp.success=e,this.pingPongLogOp.resultSignature=t,this.pingPongLogOp.resultDescription=n,o&&(this.pingPongLogOp.dimension0=null!==(s=o[0])&&void 0!==s?s:"",this.pingPongLogOp.dimension1=null!==(r=o[1])&&void 0!==r?r:"",this.pingPongLogOp.dimension2=null!==(i=o[2])&&void 0!==i?i:"",this.pingPongLogOp.dimension3=null!==(a=o[3])&&void 0!==a?a:""),b.tG.info(507320073,b.nh.CoreDefault,this.pingPongLogOp.stop())}}Jn.pingPongMessage="~";const Kn="Request timed out";class Yn{constructor(e,t,n){this.remainingRetryAttempts=4,this.isAsleep=!1,this.isLongPollSuccessful=!1,this.isActiveLongPoll=!1,this.isResponseReceived=!1,this.lastEgressTime=0,this.longPollLogOp=new L.I({operationName:"OnLongPollMessage",success:!0}),this.clientMetadata=t,this.sessionCorrelationVector=n,this.longPollLogOp.setClientMetadata(this.clientMetadata,!0),this.worker=e}start(){const e=new L.I({operationName:"StartHttpReliabilityManager",success:!0}).start();e.setClientMetadata(this.clientMetadata,!0),b.tG.info(508163399,b.nh.CoreDefault,e.stop()),this.trySendLongPoll(It.PO.Start,!0),this.isLongPollSuccessful=!0}onResponse(e){if(!e||this.isResponseReceived){const e=new L.I({operationName:"HttpReliabilityManagerFailure",success:!1}).start();return e.setClientMetadata(this.clientMetadata,!0),void b.tG.info(508162497,b.nh.CoreDefault,e.stop())}this.isResponseReceived=!0,this.isActiveLongPoll=!1;const t=e;if(t.error)if(this.isLongPollSuccessful=!1,--this.remainingRetryAttempts,this.remainingRetryAttempts>0){this.longPollLogOp.success=!1,this.longPollLogOp.resultDescription=`Retry attempts left : ${this.remainingRetryAttempts}`,this.longPollLogOp.resultSignature=t.error,b.tG.info(508163398,b.nh.CoreDefault,this.longPollLogOp.stop());const e=t.error===Kn?It.PO.TimeoutResend:It.PO.FailResend;t.error===Kn||3===this.remainingRetryAttempts?this.trySendLongPoll(e,!0):this.enqueueSendLongPoll(e)}else this.longPollLogOp.success=!1,this.longPollLogOp.resultDescription="Long poll still not received after all retry attempts",b.tG.info(508163397,b.nh.CoreDefault,this.longPollLogOp.stop()),this.worker&&this.worker.close();else this.longPollLogOp.success=!0,this.longPollLogOp.resultDescription="Long poll received",b.tG.info(508163401,b.nh.CoreDefault,this.longPollLogOp.stop()),this.remainingRetryAttempts=4,this.isLongPollSuccessful=!0,this.trySendLongPoll(It.PO.Regular)}close(){const e=new L.I({operationName:"CloseHttpReliabilityManager",success:!0}).start();e.setClientMetadata(this.clientMetadata,!0),b.tG.info(508162467,b.nh.CoreDefault,e.stop()),this.sendLongPollTimer&&(clearTimeout(this.sendLongPollTimer),this.sendLongPollTimer=void 0),this.isActiveLongPoll=!1,this.isLongPollSuccessful=!1,this.worker=void 0}checkConnection(){if(this.isAsleep){this.isAsleep=!1;const e=new L.I({operationName:"AwakenHttpReliabilityManager",success:!0}).start();e.setClientMetadata(this.clientMetadata,!0),b.tG.info(508162496,b.nh.CoreDefault,e.stop()),this.trySendLongPoll(It.PO.CheckConnection,!0)}return this.isLongPollSuccessful}isReliabilityResponse(e){return"string"!=typeof e&&Ce.ry.typeGuard(e)}postEgress(){this.lastEgressTime=Date.now(),this.trySendLongPoll(It.PO.PostEgress)}needsParsedResponses(){return!0}enqueueSendLongPoll(e){this.sendLongPollTimer=setTimeout((()=>{this.trySendLongPoll(e,!0)}),2e4)}trySendLongPoll(e,t){if(!this.worker){const e=new L.I({operationName:"LongPollNoOp",success:!0}).start();return e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Worker is undefined",void b.tG.info(507281438,b.nh.CoreDefault,e.stop())}if(!0===this.isActiveLongPoll){const e=new L.I({operationName:"LongPollNoOp",success:!0}).start();return e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Already active long poll",void b.tG.info(508163396,b.nh.CoreDefault,e.stop())}if(this.isActiveLongPoll=!0,Date.now()-this.lastEgressTime>6e4&&!t){this.isActiveLongPoll=!1,this.isAsleep=!0;const e=new L.I({operationName:"LongPollSleep",success:!0}).start();return e.setClientMetadata(this.clientMetadata),e.resultDescription=`isAsleep: ${this.isAsleep}, isActiveLongPoll: ${this.isActiveLongPoll}`,void b.tG.info(507278739,b.nh.CoreDefault,e.stop())}this.longPollLogOp.start(),this.isResponseReceived=!1,this.worker.egress({obj:this.getLongPollMessageString(e),isHttpSessionLongPollMessage:!0,isHttpSessionInitMessage:!1})}getLongPollMessageString(e){const t=new Ce.LQ({longPollTimeoutHint:15e3,type:e});return this.sessionCorrelationVector&&(t.cv=this.sessionCorrelationVector().newChild().toString()),JSON.stringify(t)}}var Xn=function(e,t,n,o){return new(n||(n=Promise))((function(s,r){function i(e){try{l(o.next(e))}catch(e){r(e)}}function a(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))};const Zn=1e5;class eo{constructor(e){var t;this.emptyMessageId=0,this.egressMessageCount=0,this.egressByteCount=0,this.prevSeq=-1,this.rpsThreshold=150,this.bpsThreshold=5e8,this.isClosing=!1,this.messageQueue=void 0,this.egressRateLogOp=new L.I({operationName:"NetworkEgressRate",success:!0}),this.egressedCache=new Map,this.initPromise=new Promise((e=>{this.resolveInitPromise=e})),this.messageQueue=new(Bn()),this.reducedPingPongRetryEnabled=null!==(t=null==e?void 0:e.reducedPingPongRetryEnabled)&&void 0!==t&&t}init(e,t,n,o,s){this.worker=e,this.ingress=t,this.clientMetadata=o,this.networkMode=n,this.reliabilityManager=((e,t,n,o,s)=>e instanceof Dn?new Yn(e,n,o):new Jn(e,t,n,s))(this.worker,this.close.bind(this),void 0,s,this.reducedPingPongRetryEnabled),this.egressRateLogOp.setClientMetadata(this.clientMetadata,!0),this.resetRateLimiter(),this.onCloseController=new Promise((e=>{this.resolveCloseControllerPromise=e})),this.queueProcessingCompletePromise=new Promise((e=>{this.resolveQueueProcessingCompletePromise=e})),this.resolveInitPromise()}open(){const e=new L.I({operationName:"NetworkRateControllerOpen",success:!0,dimension3:`networkMode: ${this.networkMode}`}).start();e.setClientMetadata(this.clientMetadata,!0),this.initPromise.then((()=>{if(!this.reliabilityManager)return e.success=!1,void(e.resultDescription="Reliability Manager is undefined");this.egressRateControlIntervalStart=Date.now(),this.reliabilityManager.start(),this.processQueue()})).catch((t=>{var n;e.success=!1,e.resultDescription="Catch: "+(null!==(n=null==t?void 0:t.message)&&void 0!==n?n:"")})).finally((()=>{b.tG.info(507834384,b.nh.CoreDefault,e.stop())}))}ingressFromWorker(e,t){this.reliabilityManager?this.reliabilityManager.needsParsedResponses()||!this.reliabilityManager.isReliabilityResponse(e)?this.ingress(e,(e=>{null==t||t(e),this.reliabilityManager.needsParsedResponses()&&this.reliabilityManager.isReliabilityResponse(e)&&this.reliabilityManager.onResponse(e)})):this.reliabilityManager.onResponse():this.ingress(e,t)}onRateLimitErrorResponse(e){const t=new L.I({operationName:"NetworkRateControllerOnRateLimitResponse",success:!0}).start();t.setClientMetadata(this.clientMetadata,!0),t.resultSignature=`rateLimitAlreadyStarted: ${void 0!==this.rateLimitTimeout}`,t.setDataField("RetryAfterMs",e.retryAfterMs),t.setDataField("QueueSize",this.messageQueue.length),this.startRateLimiting(e.retryAfterMs),b.tG.info(507388684,b.nh.CoreDefault,t.stop())}setRpsBps(e,t){const n=new L.I({operationName:"NetworkRateControllerRateLimitsSet",success:!0}).start();n.setClientMetadata(this.clientMetadata,!0),e&&(this.rpsThreshold=.8*e,n.resultDescription+=`maxRPS: ${e}, rpsThreshold: ${this.rpsThreshold}; `),t&&(this.bpsThreshold=.8*t,n.resultDescription+=`maxRPS: ${t}, rpsThreshold: ${this.bpsThreshold}; `),b.tG.info(507388683,b.nh.CoreDefault,n.stop())}close(){var e,t;return Xn(this,void 0,void 0,(function*(){const n=new L.I({operationName:"NetworkRateControllerClose",success:!0,dimension3:`networkMode: ${this.networkMode}`}).start();n.setClientMetadata(this.clientMetadata,!0),this.isClosing=!0,null===(e=this.resolveCloseControllerPromise)||void 0===e||e.call(this);const o=null===(t=this.reliabilityManager)||void 0===t?void 0:t.checkConnection();n.setDataField("QueueSizeBeforeFlush",this.messageQueue.length),0!=this.messageQueue.length&&o&&(yield this.queueProcessingCompletePromise),n.setDataField("QueueSizeAfterFlush",this.messageQueue.length),n.setDataField("IsConnected",o),this.reliabilityManager?this.reliabilityManager.close():n.resultDescription="Reliability Manager is undefined",this.worker=void 0,this.prevSeq=-1,this.clearEgressControlTimeout(),this.reliabilityManager=void 0,b.tG.info(507834381,b.nh.CoreDefault,n.stop())}))}clearMessageQueues(){this.egressedCache.clear(),this.messageQueue=void 0}egress(e,t=0){var n,o;if(!this.reliabilityManager)return void this.logEgressActivity(!1,"Reliability Manager is undefined","");const s=this.getMessageSize(e);if(s>=3e6)return void this.logEgressActivity(!1,"Message size exceeded 3000000",`Message size: ${s}`);if((e.obj instanceof ArrayBuffer||e.isHttpSessionInitMessage)&&this.worker)return this.logEgressActivity(!0,`isArrayBuffer: ${e.obj instanceof ArrayBuffer}, isHttpSessionInitMessage: ${e.isHttpSessionInitMessage}`,""),void this.worker.egress(e);this.validateSyncMessage(e.messageId,e.seqId);const r=null!==(n=e.messageId)&&void 0!==n?n:"id"+this.emptyMessageId++,i={obj:e.obj,seqId:null==e?void 0:e.seqId,messageId:r,isHttpSessionInitMessage:null==e?void 0:e.isHttpSessionInitMessage},a=t>0,l=new L.I({operationName:"NetworkRateControllerQueueItem",success:!0,dimension3:`isRetry: ${a}`}).start();l.setClientMetadata(this.clientMetadata,!0);const c={message:i,logOp:l};if(a?this.messageQueue.unshift(c):this.messageQueue.push(c),this.messageQueue.length>1e4){const e=this.messageQueue.shift(),t=`NetworkRateControllerQueue max size reached. Dropping messageId: ${e.message.messageId}`;throw e.logOp.resultDescription=t,e.logOp.success=!1,b.tG.info(506001225,b.nh.CoreDefault,e.logOp.stop()),new Error(t)}null===(o=this.resolveQueueNotEmptyPromise)||void 0===o||o.call(this)}getMessageSize(e){return e.obj instanceof ArrayBuffer?e.obj.byteLength:e.obj.length}sendToNetworkWorker(e){var t;try{if(!this.worker)return void this.logEgressActivity(!1,"NetworkWorker is undefined","SendToNetworkWorkerFailure");if(!this.reliabilityManager)return void this.logEgressActivity(!1,"Reliability Manager is undefined","SendToNetworkWorkerFailure");this.worker.egress(e),this.onSendToNetworkWorker(e),null===(t=this.reliabilityManager)||void 0===t||t.postEgress();const n=this.getMessageSize(e);this.logEgressCount(n)}catch(e){this.logEgressActivity(!1,"SendToNetworkWorkerFailure",e?e.message:"")}}onSendToNetworkWorker(e){if("string"==typeof e.obj)try{const a=JSON.parse(e.obj);Ce.Tb.typeGuard(a)?((e,t,n,o)=>{tn(e.ops,e.cv,t,"SendToNetwork",o)})(a,Date.now(),0,new L.I({operationName:"AugloopClientPerfTracker",success:!0}).setClientMetadata(this.clientMetadata).start()):Oe.typeGuard(a)&&(t=a,(n=new L.I({operationName:"AugloopClientPerfTracker",success:!0}).setClientMetadata(this.clientMetadata).start()).resultSignature="GetAnnotationsSendToNetwork",n.resourceId=`${null===(o=t.sourceInfo)||void 0===o?void 0:o.featureId}-${null===(s=t.sourceInfo)||void 0===s?void 0:s.entryPoint}`,n.cv=t.cv,n.setDataFields({AnnotationTypes:null===(r=t.annotationTypes)||void 0===r?void 0:r.toString(),MaxDelayMs:null===(i=t.maxDelayMs)||void 0===i?void 0:i.toString()}),b.tG.info(505455200,b.nh.CoreDefault,n.stop()))}catch(e){}var t,n,o,s,r,i}processQueue(){var e,t,n;return Xn(this,void 0,void 0,(function*(){if(!this.reliabilityManager){const e=new L.I({operationName:"NetworkRateControllerProcessQueueFailure",success:!1,dimension3:`networkMode: ${this.networkMode}`}).start();return e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Reliability Manager is undefined",void b.tG.info(507573643,b.nh.CoreDefault,e.stop())}const o=new L.I({operationName:"NetworkRateControllerProcessQueue",success:!0}).start();for(;;){if(0===this.messageQueue.length){if(this.isClosing){o.setDataField("ExitReason","Stage#1 Closing");break}yield Promise.race([this.queueNotEmpty(),this.onCloseController])}if(this.rateLimitTimeout){const e=new L.I({operationName:"NetworkRateControllerRateLimitBackoff",dimension3:`networkMode: ${this.networkMode}`}).start();e.setClientMetadata(this.clientMetadata,!0),e.setDataField("QueueLengthBeforeBackoff",this.messageQueue.length),yield Promise.race([this.rateLimitTimeout,this.onCloseController]),e.setDataField("QueueLengthAfterBackoff",this.messageQueue.length),e.setDataField("IsClosing",this.isClosing),e.success=!0,this.rateLimitTimeout=void 0,this.resetRateLimiter(),b.tG.info(507281410,b.nh.CoreDefault,e.stop())}if(!(null===(e=this.reliabilityManager)||void 0===e?void 0:e.checkConnection())){if(this.isClosing){o.setDataField("ExitReason","Stage#2 Closing");break}yield this.checkConnectionPromise(),this.connectionPromise=void 0}if(!this.reliabilityManager){o.setDataField("ExitReason","Stage#2 ReliabilityManager null");break}for(;this.messageQueue.length>0&&this.reliabilityManager.checkConnection();){if(Date.now()-this.egressRateControlIntervalStart>=1e3)this.resetRateLimiter();else if(this.egressMessageCount>=this.rpsThreshold||this.egressByteCount>=this.bpsThreshold){const e=1100;let t="";this.egressMessageCount>=this.rpsThreshold&&(t+="RPS exceeded."),this.egressByteCount>=this.bpsThreshold&&(t+="BPS exceeded.");const n="rateLimitHit",o=new L.I({operationName:"NetworkRateControllerEgress",dimension3:`networkMode: ${this.networkMode}`}).start();o.setClientMetadata(this.clientMetadata,!0),o.success=!0,o.resultDescription=n,o.resultSignature=t,o.dimension0=this.messageQueue.length.toString().length.toString(),o.dimension1="rateLimitHit",o.setDataField("QueueLength",this.messageQueue.length),o.setDataField("RateLimitDelayMs",e),b.tG.info(507281409,b.nh.CoreDefault,o.stop()),this.startRateLimiting(e);break}const e=this.messageQueue.shift();this.sendToNetworkWorker(e.message),b.tG.info(507388682,b.nh.CoreDefault,e.logOp.stop())}this.onQueueNotEmpty=void 0,this.resolveQueueNotEmptyPromise=void 0}null===(t=this.resolveQueueProcessingCompletePromise)||void 0===t||t.call(this),this.resolveQueueProcessingCompletePromise=void 0,o.setClientMetadata(this.clientMetadata,!0),o.setDataField("QueueSize",this.messageQueue.length),o.setDataField("IsConnected",null===(n=this.reliabilityManager)||void 0===n?void 0:n.checkConnection()),o.setDataField("IsClosing",this.isClosing),b.tG.info(507368671,b.nh.CoreDefault,o.stop())}))}queueNotEmpty(){return this.onQueueNotEmpty||(this.onQueueNotEmpty=new Promise((e=>{this.resolveQueueNotEmptyPromise=e}))),this.onQueueNotEmpty}checkConnectionPromise(){return this.connectionPromise||(this.connectionPromise=new Promise((e=>{setTimeout(e,1e3)}))),this.connectionPromise}startRateLimiting(e){this.rateLimitTimeout||(this.rateLimitTimeout=new Promise((t=>{setTimeout(t,e)})))}resetRateLimiter(){this.egressRateControlIntervalStart=Date.now(),this.egressMessageCount=0,this.egressByteCount=0}clearEgressControlTimeout(){this.egressRateControlTimer&&(clearInterval(this.egressRateControlTimer),this.egressRateControlTimer=void 0)}validateSyncMessage(e,t){if(!(void 0===t||void 0===e||t<=this.prevSeq)){if(t&&t!==this.prevSeq+1){const e=new L.I({operationName:"NetworkRateControllerAbandonedSyncMessage",success:!0,dimension3:`networkMode: ${this.networkMode}`}).start();e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Gap in sync message",e.dimension0=`${this.prevSeq}`,e.dimension1=`${t}`,e.dimension2=""+(t-this.prevSeq),b.tG.info(507834370,b.nh.CoreDefault,e.stop())}this.prevSeq=t}}logEgressActivity(e,t,n,o){var s,r,i,a;const l=new L.I({operationName:"NetworkRateControllerEgress",dimension3:`networkMode: ${this.networkMode}`}).start();l.setClientMetadata(this.clientMetadata,!0),l.success=e,l.resultDescription=t,l.resultSignature=n,o&&(l.dimension0=null!==(s=o[0])&&void 0!==s?s:"",l.dimension1=null!==(r=o[1])&&void 0!==r?r:"",l.dimension2=null!==(i=o[2])&&void 0!==i?i:"",l.dimension3=null!==(a=o[3])&&void 0!==a?a:""),b.tG.info(507626007,b.nh.CoreDefault,l.stop())}logEgressCount(e){const t=Date.now();t-this.egressRateControlIntervalStart>1e3&&((this.egressMessageCount>50||this.egressByteCount>Zn)&&(this.egressRateLogOp.start(),this.egressRateLogOp.resultDescription=this.egressMessageCount>50?"rps logging threshold exceeded":"",this.egressRateLogOp.resultDescription=this.egressByteCount>Zn?"bps logging threshold exceeded":"",this.egressRateLogOp.dimension0=(t-this.egressRateControlIntervalStart).toString(),this.egressRateLogOp.dimension1=`${this.egressMessageCount}`,this.egressRateLogOp.dimension2=`${this.egressByteCount}`,this.egressRateLogOp.dimension3=`networkMode: ${this.networkMode}`,b.tG.info(508843792,b.nh.CoreDefault,this.egressRateLogOp.stop())),this.egressRateControlIntervalStart=t,this.egressMessageCount=0,this.egressByteCount=0),this.egressMessageCount++,this.egressByteCount+=null!=e?e:0}}var to,no;!function(e){e[e.ProductServiceUsage=2]="ProductServiceUsage",e[e.ProductServicePerformance=4]="ProductServicePerformance"}(to||(to={})),function(e){e[e.BasicEvent=10]="BasicEvent",e[e.FullEvent=100]="FullEvent",e[e.RequiredServiceDataEvent=110]="RequiredServiceDataEvent"}(no||(no={}));const oo=/\|\~/g;class so{constructor(){this.count=0,this.measureSums=new Map}}class ro{constructor(e,t,n,o,s){this.buckets=new Map,this.init=e=>{this.log=e},this.add=(e,t=!0)=>{if(!this.condition||!this.condition(e))return!0===t&&this.log(e,!1),!1;const n=[];for(const t of this.dimensions)if(void 0===e[t]||null===e[t])n.push(null);else{let o="";"boolean"==typeof e[t]?o="b~":"number"==typeof e[t]&&(o="n~"),n.push(`${o}${e[t].toString().replace(oo,"_")}`)}const o=n.join("|");let s=this.buckets.get(o);if(!s){s=new so,s.traceLevel=e.traceLevel;for(const e of this.avgMeasures)s.measureSums.set(e,0);this.buckets.set(o,s)}s.count++;for(const t of this.avgMeasures)e[t]&&s.measureSums.set(t,s.measureSums.get(t)+e[t]);return!0},this.flush=(e=!1)=>{this.buckets.forEach(((e,t)=>{const n={traceLevel:e.traceLevel,eventName:this.eventName,count:e.count},o=t.split("|");for(let e=0;e<this.dimensions.length;e++){const t=this.dimensions[e],s=o[e];0===s.indexOf("b~")?n[t]="b~true"===s:0===s.indexOf("n~")?n[t]=parseInt(s.slice(2),10):n[t]=s}for(const t of this.avgMeasures)n[t]=Math.round(e.measureSums.get(t)/e.count);this.log(n,!0)})),this.buckets.clear(),e&&(this.condition=null,clearInterval(this.interval))},this.eventName=e,this.condition=t,this.dimensions=n,this.avgMeasures=o,s>0&&(this.interval=setInterval(this.flush,1e3*s))}}const io=["cloud.dev.microsoft","officeppe.com","cloud.microsoft","office.com","office365.us","ic.gov","microsoft.scloud","microsoftonline.cn"],ao=(e,t,n,o)=>new ro(e,(e=>e.success&&n.indexOf(e[t])>=0),[t,"ariaNamespace","resourceId","success","resultSignature","clientDocSessionId","dimension0","dimension1","dimension2","dimension3"],["durationMs"],o),lo=e=>{if(!e)return e;for(const t of io)if(e.indexOf(t)>=0)return e;return"**redacted**"};class co{constructor(e){this.level=N.q.info,this.hostCallbacks=e}log(e){if(null==this.hostCallbacks||null==this.hostCallbacks.sendTelemetryEvent)return;const t=(e,t,n,o,s)=>{let r=t.charAt(0).toUpperCase()+t.slice(1),i={DocSessionId:e.clientDocSessionId,ResourceId:e.resourceId,ResultDescription:e.resultDescription,ResultSignature:e.resultSignature,Dimension0:e.dimension0,Dimension1:e.dimension1,Dimension2:e.dimension2,Dimension3:e.dimension3,JoinContextId:e.joinContextId,ServerSessionKey:this.serverSessionKey};n&&(i=Object.assign(Object.assign({},i),JSON.parse(n)));const a=o||co.augLoopAriaTenantToken,l=s||a!=co.augLoopAriaTenantToken?s:co.augLoopAriaNamespace;r=r||co.operationNamePlaceholder;const c={CV:e.cv,Duration:1e3*(e.durationMs||0),Count:e.count,AggMode:2,Success:e.success};this.hostCallbacks.sendTelemetryEvent(a,l?`${l}_${r}`:r,i,"Office.System.Activity",c,!1,to.ProductServiceUsage|to.ProductServicePerformance,no.RequiredServiceDataEvent)};if("Workflow.MetricsOnly"==e.category);else if("Operation"===e.eventName){const n=e;t(n,n.operationName,n.dataFields,void 0,n.ariaNamespace)}else if("SessionHealth"===e.eventName)t(e,e.sessionHealthEventName);else if("WorkflowOperation"===e.eventName){const n=e;t(n,n.operationName,n.dataFields,n.ariaTenant,n.ariaNamespace)}else"Log"===e.eventName&&((e,t,n)=>{this.hostCallbacks.sendDiagnosticTrace&&this.hostCallbacks.sendDiagnosticTrace(e,t,n)})(e.tagId,e.traceLevel,e.message)}setServerSessionKey(e){this.serverSessionKey=e}}co.augLoopAriaTenantToken="3de4087d4de34817b1c376e3d1e6e293-983c4292-5ba9-485a-ab10-9797863c788b-6770",co.augLoopAriaNamespace="Office_AugLoop_Client",co.operationNamePlaceholder="OperationNameNotProvided";class uo{constructor(e,t,n,o,s,r,i,a,l){this.logCountLimiter=new rn(uo.className),this.isWorkerReady=!1,this.permanentlyClosed=!1,this.currentReconnectAttempt=0,this.lastInitializationAttemptTimeMs=0,this.offlineInterval=void 0,this.alreadyLoggedReconnectAttempt=!1,this.httpTestsLeft=5,this.httpTestsSuccessCount=0,this.workerOpenCount=0,this.testHttpConnection=e=>{const t=sn.convertWebSocketUrlToHttp(this.globalUrl),n=!e,o=null!=e?e:new L.I({operationName:"HttpsTest",resourceId:lo(t),success:!1,resultDescription:"",resultSignature:"HttpResponse:"}).start();Mn(t,{method:"POST",headers:{"content-type":"application/json","X-CorrelationId":o.cv},body:JSON.stringify(sn.createHealthCheckRequest(this.clientMetadata))},((e,t)=>{e?(o.dimension1="HttpErr",o.resultDescription+=`HttpErr: ${e.message}`):t&&t.ok?(o.dimension1="HttpOK",this.leaveOfflineMode(),this.httpTestsSuccessCount++,n&&(o.success=!0)):(o.dimension1="HttpNoResp",o.resultDescription+=`HttpStatus: ${null==t?void 0:t.status}`),n&&o.stop(),this.logCountLimiter.log((()=>{b.tG.info(508843780,b.nh.CoreDefault,o)}))}))},this.globalUrl=e,this.clientMetadata=t,this.workerFactory=n,this.sessionInitializer=o,this.ingress=s,this.onConnectionClose=r,this.sessionCorrelationVector=i,this.reducedPingPongRetryEnabled=a.reducedPingPongRetryEnabled,this.networkWorkerLogOp=new L.I({operationName:"CreateNetworkWorker",success:!0}),this.networkMode=l||D.JSWebSockets,this.initNetworkMode=this.networkMode}init(e,t,n=!1){if(this.permanentlyClosed)return Promise.reject(new Error("permanentlyClosed"));if(this.isWorkerReady||this.pendingInitPromise)return this.pendingInitPromise?this.pendingInitPromise:Promise.resolve();this.extensionConfigs=e||this.extensionConfigs;const o=()=>{if(n||!this.alreadyLoggedReconnectAttempt){const e=n?uo.initialAttemptTimeout:uo.reconnectAttemptTimeout;this.connTimeout=setTimeout((()=>{const t=new L.I({operationName:"ConnectionFailingOrSlow",dimension0:n?"Initial":"Reconnect",dimension1:e.toString(),dimension2:this.currentReconnectAttempt.toString()});b.tG.info(508843787,b.nh.CoreDefault,t),this.alreadyLoggedReconnectAttempt=!n,this.connTimeout=void 0}),e)}};return t?this.pendingInitPromise=t().catch((e=>{const t=new L.I({operationName:"WorkerManagerCustomInit",success:!1,resultDescription:`${e}`});b.tG.error(508843786,b.nh.CoreDefault,t)})).then((()=>{o(),this.initInternal()})):(this.pendingInitPromise=Promise.resolve(),o(),this.initInternal()),this.pendingInitPromise}egress(e,t){return!this.isWorkerReady&&this.pendingInitPromise?this.pendingInitPromise.then((()=>{this.egressInternal(e,t)})):(this.egressInternal(e,t),Promise.resolve())}egressBytes(e){return!this.isWorkerReady&&this.pendingInitPromise?this.pendingInitPromise.then((()=>{this.egressBytesInternal(e)})):(this.egressBytesInternal(e),Promise.resolve())}getNetworkMode(){return this.networkMode}getInitNetworkMode(){return this.initNetworkMode}onRateLimitErrorResponse(e){this.getNetworkRateController().onRateLimitErrorResponse(e)}close(e){this.isWorkerReady=!1,this.networkRateController&&this.getNetworkRateController().close(),this.worker&&(this.worker.close(),this.worker=null),this.networkRateController=null,this.permanentlyClosed=e||this.permanentlyClosed,this.permanentlyClosed&&(this.leaveOfflineMode(),clearTimeout(this.connTimeout))}initInternal(){if(this.isWorkerReady=!1,this.permanentlyClosed||this.isOffline()){const e=new L.I({operationName:"WorkerManagerInitOffline",success:!0,resultSignature:this.permanentlyClosed?"PermanentlyClosed":"Offline"});b.tG.info(508843785,b.nh.CoreDefault,e)}else this.currentReconnectAttempt>0?setTimeout((()=>{this.tryToConnectAndInitializeSession()}),((e,t,n)=>{let o=0;const s=sn.getCurrentTimeMs()?sn.getCurrentTimeMs()-t:0,r=[1e3,2e3,5e3,1e4,6e4];return o=r[Math.max(0,Math.min(r.length-1,e-1))],o=Math.max(o-s,1e3),o=n&&n>0?Math.min(5e3,o):o,o})(this.currentReconnectAttempt,this.lastInitializationAttemptTimeMs,this.httpTestsSuccessCount)):this.getNetworkMode()===D.HttpFallback?setTimeout((()=>{this.tryToConnectAndInitializeSession()}),100):this.tryToConnectAndInitializeSession()}egressInternal(e,t){if(!this.isWorkerReady&&!s.h.matchesTypesFor(e,[Ce.eE.getTypeName()]))return void(s.h.matchesTypesFor(e,[Ce.YK.getTypeName()])||b.tG.error(508843784,b.nh.CoreDefault,new L.I({operationName:"UnexpectedEgressCall",resultDescription:`isWorkerReady: ${this.isWorkerReady}`})));let n,o;if(s.h.matchesTypesFor(e,[Ce.VR.getTypeName()])?(this.castBinaryData(e),n=Vt.serialize(e)):n=JSON.stringify(e),Ce.Tb.typeGuard(e)&&(o=e.seq),this.bypassRateController(e))return void this.worker.egress({obj:n});const r=Ce.eE.typeGuard(e)&&this.getNetworkMode()===D.HttpFallback;this.getNetworkRateController().egress({obj:n,isHttpSessionInitMessage:r,messageId:e.messageId,seqId:o},t)}bypassRateController(e){return Ce.w9.typeGuard(e)}egressBytesInternal(e){this.isWorkerReady?this.getNetworkRateController().egress({obj:e}):b.tG.error(508843783,b.nh.CoreDefault,new L.I({operationName:"UnexpectedEgressBytesCall",resultDescription:`isWorkerReady: ${this.isWorkerReady}`}))}tryToConnectAndInitializeSession(){this.currentReconnectAttempt++,this.lastInitializationAttemptTimeMs=sn.getCurrentTimeMs();const e=t=>{if(this.permanentlyClosed||this.isOffline())return;const n=this.sliceUrl?this.sliceUrl:this.globalUrl;t.setDataField("connectionUrl",lo(n)),this.connect(n),this.sessionInitializer.initSession({isTokenRefresh:!1,isReconnectOnSameSlice:!!this.sliceUrl,extensionConfigs:this.extensionConfigs,onResponse:(n,o)=>{if(t.success=!n,t.resourceId=o?lo(o.sliceUrl):"",t.dimension2=this.getNetworkModeLogString(),this.getNetworkMode()===D.HttpFallback?(t.resultDescription=n?`HTTP Error: ${n.error}`:"",t.dimension0=t.success?"HTTPOK":"HTTPFail"):(t.resultDescription=n?`WS Error: ${n.error}`:"",t.dimension0=t.success?"WSOK":"WSFail"),n||!this.worker)return this.sliceUrl=void 0,this.close(),this.httpTestsLeft>0?(this.httpTestsLeft--,this.testHttpConnection(t.stop())):(this.getNetworkMode()===D.JSWebSockets?0===this.workerOpenCount&&this.httpTestsSuccessCount>=5?(t.dimension1="WSBlocked",t.dimension3="HTTP Fallback",this.networkMode=D.HttpFallback,this.currentReconnectAttempt=0,this.resetHttpTestsCounter()):0===this.httpTestsSuccessCount&&(this.startOfflineMode(),t.dimension1="WSOffline"):0===this.httpTestsSuccessCount&&(this.startOfflineMode(),t.dimension1="HTTPOffline"),this.logCountLimiter.log((()=>{b.tG.info(508843782,b.nh.CoreDefault,t.stop())}))),void this.initInternal();if(this.logCountLimiter.log((()=>{b.tG.info(508843781,b.nh.CoreDefault,t.stop())})),o.forceReconnect){this.close();const t=new L.I({operationName:"ForcedReconnect"}).start();t.resultSignature=`globalUrl: ${this.globalUrl}. sliceUrl: ${this.sliceUrl}`,this.sliceUrl=void 0,setTimeout((()=>{e(t)}),1e3)}else clearTimeout(this.connTimeout),this.sliceUrl=o.sliceUrl,this.getNetworkRateController().setRpsBps(o.maxRPS,o.maxBPS),this.ready();this.resetHttpTestsCounter()}})},t=new L.I({operationName:"TryToConnectAndInitializeSession",resultSignature:`Reconnection attempt #${this.currentReconnectAttempt}`}).start();e(t)}getNetworkRateController(){return this.networkRateController||(this.networkRateController=new eo({reducedPingPongRetryEnabled:this.reducedPingPongRetryEnabled})),this.networkRateController}connect(e){const t=this.getNetworkMode();this.networkWorkerLogOp.start(),this.networkWorkerLogOp.resultDescription=this.getNetworkModeLogString(),this.networkWorkerLogOp.dimension0=t.toString(),this.logCountLimiter.log((()=>b.tG.info(508372418,b.nh.CoreDefault,this.networkWorkerLogOp.stop()))),this.worker=this.workerFactory(t),this.worker.init(e,this.getNetworkRateController().ingressFromWorker.bind(this.networkRateController),(()=>{this.workerOpenCount++,this.getNetworkRateController().open(),this.leaveOfflineMode()}),(e=>{this.close(),this.onConnectionClose(e)}),this.clientMetadata),this.getNetworkRateController().init(this.worker,this.ingress,t,this.clientMetadata,this.sessionCorrelationVector)}ready(){this.isWorkerReady=!0,this.pendingInitPromise=void 0,this.currentReconnectAttempt=0}castBinaryData(e){if(e){if(Array.isArray(e.__binaryMembers__))for(const t of e.__binaryMembers__)ArrayBuffer.isView(e[t])||(e[t]=new Uint8Array(e[t]));for(const t of Object.keys(e))"object"==typeof e[t]&&null!==e[t]&&this.castBinaryData(e[t])}}isOffline(){return!!this.offlineInterval}startOfflineMode(){this.offlineInterval=setInterval((()=>{this.testHttpConnection()}),6e4)}leaveOfflineMode(){this.isOffline()&&(clearInterval(this.offlineInterval),this.offlineInterval=void 0,this.resetHttpTestsCounter(),this.tryToConnectAndInitializeSession())}resetHttpTestsCounter(){this.httpTestsLeft=5,this.httpTestsSuccessCount=0}getNetworkModeLogString(){return"NetworkMode: "+(this.getNetworkMode()===D.JSWebSockets?"WebSocket":"HTTP")}}uo.initialAttemptTimeout=1e5,uo.reconnectAttemptTimeout=2e4,uo.className="NetworkWorkerManager";class ho extends Xt.EventEmitter{constructor(e,t,n,o,s,r,i,a,l){super(),this.cvParent=new at,this.logOp=new L.I({operationName:"SessionState",success:!0}).start(),this.sessionStateChangeLogCountLimiter=new rn("SessionState"),this.stats=t,this.allStates={[Ln.Initing]:new $n(this),[Ln.Running]:new Vn(this),[Ln.Disconnected]:new zn(this),[Ln.Closed]:new jn(this)},this.setState(Ln.Initing),this.messageEndpoint=new Pt.N0({messageIdPrefix:"c",responseTimeoutMs:3e4,resendPendingMessagesOnReconnect:!1}),this.messageEndpoint.setClientMetadata(s),this.messageEndpoint.setEgress(this.egress.bind(this)),this.messageEndpoint.onMessage(Ce.w9.getTypeName(),((e,t)=>{this.onSessionCloseMessage(e,t)})),this.networkWorkerManager=new uo(e,s,n,o,this.ingress.bind(this),this.onConnectionClose.bind(this),this.getCorrelationVector.bind(this),i,l),this.messageQueue=new Wn({sendMessage:(e,t,n,o)=>this.state.sendMessage(e,t,n,o),sendBytes:this.sendBytes.bind(this),canSendMessage:()=>this.state.canSendMessage()}),o.on("connect",((e,t,n,o,s,r,i,a,l)=>{this.setState(Ln.Running,"",{isSessionReseedingStarted:e&&t}),this.emit("connect",e,n,o,s,r,i,a,l)})),o.on("reconnect",(()=>this.emit("reconnect"))),o.on("serverAuthenticationStateChange",(e=>this.emit("serverAuthenticationStateChange",e))),this.resetNextSyncSequenceId=()=>this.emit("resetNextSyncSequenceId"),this.tokenRefreshManager=r,this.gateUtils=a}setState(e,t,n){if(this.state&&e===this.state.stateName)return;const o=this.state?Ln[this.state.stateName]:"undefined",s=this.state?this.state.possibleNextStates.indexOf(e)>=0:e===Ln.Initing;this.sessionStateChangeLogCountLimiter.log((()=>{this.logOp.stop(),this.logOp.resourceId=`New state: ${s?Ln[e]:o}`,this.logOp.resultDescription=`Previous state: ${o}`,this.logOp.dimension0=`Attempted state: ${Ln[e]||"undefined"}`,this.logOp.resultSignature=t+(this.state&&!s?"Unexpected state change":""),this.logOp.success=s,b.tG.info(508843791,b.nh.CoreDefault,this.logOp)})),s&&(this.state=this.allStates[e],this.logOp.start(),this.state.onEnter(n))}init(e,t){return this.extensionConfigs=e,this.customInitPromise=t,this.networkWorkerManager.init(this.extensionConfigs,this.customInitPromise,!0)}sendMessage(e,t,n){this.retrySendMessage(e,t,ho.maxRetries,n)}sendBytes(e){this.state.sendBytes(e)}onMessage(e,t){this.messageEndpoint.onMessage(e,t)}getCorrelationVector(){return this.cvParent}getNetworkWorkerManager(){return this.networkWorkerManager}forceReconnect(e){return this.extensionConfigs=e||this.extensionConfigs,this.networkWorkerManager.close(!1),new Promise((e=>setTimeout((()=>{e(this.networkWorkerManager.init(this.extensionConfigs))}),100)))}closeSession(e){this.sendMessage(new Ce.w9),this.networkWorkerManager.close(!0);const t=e||new Ce.Zy({reasonDescription:"ClientRequested"});this.onSessionClose(new Ce.w9({reconnectAllowed:!1,reason:t}),"ClientRequested")}ingress(e,t){let n;try{n=JSON.parse(e)}catch(e){b.tG.error(508843790,b.nh.CoreDefault,new L.I({operationName:"ProcessMessage",resourceId:"Unknown",success:!1,resultSignature:"ParseError",resultDescription:e.message,durationMs:0}))}if(n){if(t&&Ce.YK.typeGuard(n)&&t(n),this.networkWorkerManager.getNetworkMode()===D.HttpFallback&&Ce.ry.typeGuard(n)){const e=n;if(e.batch)for(const t of e.batch)this.messageEndpoint.ingress(t,((e,t)=>this.egress(e||t,(()=>{}))));return}this.messageEndpoint.ingress(n,((e,t)=>this.egress(e||t,(()=>{}))))}}egress(e,t,n){e&&this.networkWorkerManager.egress(e,n).then((()=>t())).catch((e=>t(e)))}onSessionCloseMessage(e,t){e.reconnectAllowed?this.networkWorkerManager.close():this.onSessionClose(e,"CloseMessageReceived"),t()}onSessionClose(e,t){this.setState(Ln.Closed,t),this.tokenRefreshManager.clearAllTimeouts(),this.onConnectionClose(void 0),e&&this.emit("sessionClose",e)}onConnectionClose(e){this.state.onConnectionClose(),this.stats.lastConnectionClose=sn.getCurrentTimeMs(),this.emit("disconnect",e)}retrySendMessage(e,t,n,o,r){const i=ho.maxRetries-n;this.state.sendMessage(e,((a,l)=>{var c,u,d,h,p,f;r&&(a&&0==n?(r.dimension0=(i+1).toString(),r.success=!1,b.tG.info(507025311,b.nh.CoreDefault,r.stop())):a&&n>0?(r.dimension0=(i+1).toString(),r.dimension1=null!==(u=null===(c=a.code)||void 0===c?void 0:c.toString())&&void 0!==u?u:"NoErrorCode",r.resultSignature=null!==(d=a.error)&&void 0!==d?d:"NoErrorMessage"):(r.success=!0,b.tG.info(507025310,b.nh.CoreDefault,r.stop()))),a&&n>0&&this.canBeRetried(e)&&this.isTransientError(a)?(r||((r=new L.I({operationName:"RetrySendMessage",success:!0,dimension0:(i+1).toString()}).start()).resourceId=s.h.getTypeNameFor(e),r.dimension1=null!==(p=null===(h=a.code)||void 0===h?void 0:h.toString())&&void 0!==p?p:"NoErrorCode",r.resultSignature=null!==(f=a.error)&&void 0!==f?f:"NoErrorMessage",r.resultDescription=`Retrying message with messageId: ${e.messageId}${Ce.Tb.typeGuard(e)?`, seq: ${e.seq}`:""}`),s.h.matchesTypesFor(a,[Ce.ru.getTypeName()])&&this.networkWorkerManager.onRateLimitErrorResponse(a),this.retrySendMessage(e,t,n-1,o,r)):t&&t(a,l)}),i,o)}canBeRetried(e){return!s.h.matchesTypesFor(e,[Ce.eE.getTypeName(),Ce.VR.getTypeName(),Oe.getTypeName()])}isTransientError(e){const t=e.error,n=e.code;return n!==It.xv.TokenValidationError&&n!==It.xv.TokenDecryptError&&n!==It.xv.SyncMessageTooLateOrDuplicate&&n!==It.xv.Gone&&t!==Pt.Ef.SyncMessageUnsupportedBatch&&t!==Pt.Ef.UnexpectedSeedMessage&&t!==Pt.Ef.UnsupportedSyncMessage&&t!==Pt.Ef.AnnotationTokenNotFound&&t!==Nn.ArrivedBeforeReseeding&&t!==Nn.DroppedAsOldestInQueue&&t!==Nn.DroppedBecauseClientDisconnected}}var po;ho.maxRetries=2,function(e){e[e.Anonymous=0]="Anonymous",e[e.Host=1]="Host"}(po||(po={}));class fo{constructor(){this.timers=new Map}scheduleRefresh(e,t,n,o){let s=this.timers.get(e);s||(s={numberOfAttempts:0},this.timers.set(e,s)),s.refreshTimeoutId&&(clearTimeout(s.refreshTimeoutId),s.refreshTimeoutId=void 0),s.expiredTimeoutId&&(clearTimeout(s.expiredTimeoutId),s.expiredTimeoutId=void 0);let r=1e3*t-fo.tokenRefreshBufferMs,i=1e3*t-fo.tokenExpirationBufferMs;r>0?s.numberOfAttempts=0:(++s.numberOfAttempts,r=fo.tokenRefreshBackoffIntervalMs,i=fo.tokenExpirationBufferMs),s.numberOfAttempts<=fo.tokenRefreshMaximumAttempts&&(s.refreshTimeoutId=setTimeout((()=>{n()}),r)),o&&(s.expiredTimeoutId=setTimeout((()=>{o()}),i))}clearRefreshTimeouts(){this.clearTimeouts(!1)}clearAllTimeouts(){this.clearTimeouts(!0)}clearTimeouts(e){this.timers.forEach(((t,n)=>{t.refreshTimeoutId&&(clearTimeout(t.refreshTimeoutId),t.refreshTimeoutId=void 0),e&&t.expiredTimeoutId&&(clearTimeout(t.expiredTimeoutId),t.expiredTimeoutId=void 0),t.expiredTimeoutId||this.timers.delete(n)}))}}fo.tokenRefreshBufferMs=24e4,fo.tokenExpirationBufferMs=12e4,fo.tokenRefreshBackoffIntervalMs=3e4,fo.tokenRefreshMaximumAttempts=3;class go extends Xt.EventEmitter{constructor(e,t,n,o,s){if(super(),this.getSessionStats=e,this.clientMetadata=t,this.tokenRefreshManager=n,this.sendMessage=o,this.options=s||{},this.options.overrideSessionInitMessage=this.options.overrideSessionInitMessage||(e=>e),this.clientMetadata&&!this.clientMetadata.userSystemTimezone)try{this.clientMetadata.userSystemTimezone=Intl.DateTimeFormat().resolvedOptions().timeZone}catch(e){}}initSession(e){e.onResponse=e.onResponse||(()=>{});const t=sn.getCurrentTimeMs(),n=this.getSessionStats().lastConnectionClose&&t-this.getSessionStats().lastConnectionClose,o=this.getSessionStats().lastSyncMessage&&t-this.getSessionStats().lastSyncMessage,s=new L.I({operationName:"SessionInit"}).start(),r={sessionKey:this.sessionKey,sessionId:this.clientMetadata.sessionId,timeSinceLastConnectionClose:n,timeSinceLastSyncMessage:o,isTokenRefresh:e.isTokenRefresh,enableRemoteExecutionNotification:this.options.enableRemoteExecutionNotification,error:void 0,isSeedingRequired:void 0,enableCreateBlobStorageContainer:this.options.createBlobStorageContainerEnabled};let i;i=this.options.createCopyOfClientMetadataInSessionInit?Object.assign({},this.clientMetadata):this.clientMetadata;const a=this.options.overrideSessionInitMessage(new Ce.eE({protocolVersion:It.mH,clientMetadata:i,sessionKey:this.sessionKey,origin:this.origin,authToken:this.anonymousToken,extensionConfigs:e.extensionConfigs,returnWorkflowInputTypes:!0,enableRemoteExecutionNotification:this.options.enableRemoteExecutionNotification,createBlobStorageContainer:this.options.createBlobStorageContainerEnabled}));this.sendMessage(a,((t,n)=>{if(s.success=!t,s.resultSignature=this.getSessionStats().lastConnectionClose?"Reconnect":"FirstConnect",s.resourceId=lo(null==n?void 0:n.sliceUrl),s.setClientMetadata(this.clientMetadata),(null==n?void 0:n.sessionKey)&&r.sessionKey!==n.sessionKey&&(r.sessionKey=n.sessionKey),t&&(r.error=t.error),r.isSeedingRequired=this.sessionKey!==(null==n?void 0:n.sessionKey),s.resultDescription=JSON.stringify(r),b.tG.info(508843779,b.nh.CoreDefault,s.stop()),e.onResponse(t,n),t)this.emit("serverAuthenticationStateChange",Te.f.NotAuthenticated);else if(e.isReconnectOnSameSlice&&n.forceReconnect)this.emit("serverAuthenticationStateChange",Te.f.NotAuthenticated);else{if(!n.anonymousToken||!n.tokenExpirationSeconds)return this.emit("serverAuthenticationStateChange",Te.f.NotAuthenticated),void b.tG.error(508843778,b.nh.CoreDefault,"AL Anonymous token was not generated for the session");this.anonymousToken=n.anonymousToken,this.onSuccessfulSessionInitOnServerSide(n)}}))}onSuccessfulSessionInitOnServerSide(e){var t,n;this.tokenRefreshManager.scheduleRefresh(po.Anonymous,e.tokenExpirationSeconds,this.initSession.bind(this,{isTokenRefresh:!0}),(()=>{this.anonymousToken=void 0})),this.connectParams={isSeedingRequired:this.sessionKey!==e.sessionKey,sessionUrl:`${e.sessionUrlBase}/${e.sessionKey}`,origin:e.origin,authToken:this.anonymousToken},(null===(t=this.options)||void 0===t?void 0:t.dontSendTokenOnReconnectChangeGate)&&e.existingTokenProvisionResponse&&(null===(n=e.existingTokenProvisionResponse)||void 0===n?void 0:n.tokenType)===it.OY.AugLoopLowPrivilege||(this.options.sendTokenFailureMessageChangeGate?this.initHostAuthTokenNew().catch((()=>{})):this.initHostAuthToken());const o=!!this.sessionKey;this.sessionKey=e.sessionKey,this.origin=e.origin,this.emit("connect",this.connectParams.isSeedingRequired,o,this.connectParams.sessionUrl,this.connectParams.origin,this.connectParams.authToken,e.workflowInputTypes,e.downstreamRuntimeWorkflows,e.routingSessionKey,e.blobFileId),o&&this.emit("reconnect")}getAuthToken(){const e={Tickets:[],DocSessionId:this.clientMetadata.docSessionId,TokenType:Et.Augloop,ConnectParams:this.connectParams};return this.options.requestAuthToken(e).then((e=>e)).catch((()=>{}))}getAuthTokenNew(){const e={Tickets:[],DocSessionId:this.clientMetadata.docSessionId,TokenType:Et.Augloop,ConnectParams:this.connectParams};return this.options.requestAuthToken(e).then((e=>e))}getAuthTokenTimeoutPromise(){const e=this.options.authTokenTimeoutMs;return new Promise(((t,n)=>{setTimeout((()=>{n(new Error(`Host auth token provision took longer than ${e} ms`))}),e)}))}initHostAuthToken(){const e=this.getAuthToken.bind(this);if(this.options.requestAuthToken&&e){const t=new L.I({operationName:"RefreshAuthToken",success:!0}).setClientMetadata(this.clientMetadata).start();e().then((e=>{if(e){if(!e.Token)return e.TokenError==At.TokenMissingInteractionRequired?(this.emit("serverAuthenticationStateChange",Te.f.TokenMissingInteractionRequired),t.resultDescription="Host auth token provision failed interaction required"):(this.emit("serverAuthenticationStateChange",Te.f.NotAuthenticated),t.resultDescription="Host auth token provision failed"),t.success=!1,void b.tG.info(508843777,b.nh.CoreDefault,t.stop());b.tG.info(508843776,b.nh.CoreDefault,t.stop()),this.sendTokenProvisionMessage(e.Token)}else t.resultDescription="TokenResponse is not set"})).catch((e=>{this.emit("serverAuthenticationStateChange",Te.f.NotAuthenticated),t.success=!1,t.resultDescription=`Error happened while attempting to fetch host token: ${e}`,b.tG.error(508843747,b.nh.CoreDefault,t.stop())}))}}initHostAuthTokenNew(){return e=this,t=void 0,o=function*(){const e=this.getAuthTokenNew.bind(this);if(this.options.requestAuthToken&&e){const t=new L.I({operationName:"RefreshAuthToken",success:!0}).setClientMetadata(this.clientMetadata).start();let n,o,s=Te.f.NotAuthenticated;try{if(n=this.options.authTokenTimeoutMs>0?yield Promise.race([e(),this.getAuthTokenTimeoutPromise()]):yield e(),!n)throw new Error("TokenResponse is not set");if(!n.Token)throw n.TokenError==At.TokenMissingInteractionRequired?(s=Te.f.TokenMissingInteractionRequired,new Error("Host auth token provision failed interaction required")):new Error("Host auth token provision failed")}catch(e){o=e.message,this.emit("serverAuthenticationStateChange",s),t.success=!1,t.resultDescription=`Error happened while attempting to fetch host token: ${e}`}try{o?this.sendMessage(new Ce.D0({reason:o,version:go.initialTokenVersion,clientHandlesResponse:!0})):this.sendTokenProvisionMessage(n.Token)}catch(e){o||(o=e.message,this.emit("serverAuthenticationStateChange",s),t.success=!1,t.resultDescription=`Error happened while attempting to send host token: ${e}`)}finally{o?b.tG.error(506074845,b.nh.CoreDefault,t.stop()):b.tG.info(506074846,b.nh.CoreDefault,t.stop())}}},new((n=void 0)||(n=Promise))((function(s,r){function i(e){try{l(o.next(e))}catch(e){r(e)}}function a(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}));var e,t,n,o}sendTokenProvisionMessage(e){const t=new Ce.kd({authToken:e,version:go.initialTokenVersion});this.emit("serverAuthenticationStateChange",Te.f.Pending),this.sendMessage(t,this.onTokenProvisionResponse.bind(this),!0)}onTokenProvisionResponse(e,t){!e&&t&&t.tokenExpirationSeconds?(this.emit("serverAuthenticationStateChange",Te.f.Authenticated),this.tokenRefreshManager.scheduleRefresh(po.Host,t.tokenExpirationSeconds,this.initHostAuthToken.bind(this))):this.emit("serverAuthenticationStateChange",Te.f.NotAuthenticated)}}go.initialTokenVersion=1;var mo=null;"undefined"!=typeof WebSocket?mo=WebSocket:"undefined"!=typeof MozWebSocket?mo=MozWebSocket:void 0!==n.g?mo=n.g.WebSocket||n.g.MozWebSocket:"undefined"!=typeof window?mo=window.WebSocket||window.MozWebSocket:"undefined"!=typeof self&&(mo=self.WebSocket||self.MozWebSocket);const yo=mo,vo="object"==typeof process&&"object"==typeof process.versions&&void 0!==process.versions.node,bo=1e5;class So{constructor(e,t){this.networkOverrideOptions=e,this.settings=t,this.hadEgressError=!1,this.isClosing=!1,this.pendingEgress=[]}get egressByteCountOp(){return this._egressByteCountOp||(this._egressByteCountOp=new L.I({operationName:"WSEgressByteOrderOfMagnitude",success:!0}),this._egressByteCountOp.setClientMetadata(this.clientMetadata,!0)),this._egressByteCountOp}init(e,t,n,o,s){var r,i;if(this.clientMetadata=s,vo&&this.networkOverrideOptions){const t={servername:null===(r=this.networkOverrideOptions)||void 0===r?void 0:r.hostHeader,headers:(null===(i=this.networkOverrideOptions)||void 0===i?void 0:i.hostHeader)?{host:this.networkOverrideOptions.hostHeader}:void 0};this.ws=new yo(e,t)}else this.ws=new yo(e);this.logOp=new L.I({operationName:So.className,success:!0}).start(),this.logOp.setClientMetadata(s,!0),this.ingressByteCountOp=new L.I({operationName:"WSIngressByteOrderOfMagnitude",success:!0}),this.ingressByteCountOp.setClientMetadata(s,!0),this.ws.addEventListener("open",(e=>{n(),this.logOp.resourceId="OnOpen",this.logOp.resultDescription="",this.logOp.success=!0,this.logOp.dimension0=this.pendingEgress.length.toString(),b.tG.info(508843801,b.nh.CoreDefault,this.logOp.stop())})),this.ws.addEventListener("message",(e=>{this.logIngressCount(e.data),t(e.data)})),this.ws.addEventListener("error",(e=>{this.errorMessage=e.message,this.logOp.resourceId="OnError",this.logOp.resultDescription=this.errorMessage,this.logOp.success=!1,b.tG.info(508843800,b.nh.CoreDefault,this.logOp.stop()),this.ws?this.ws.close():this.logWsUndefinedError("error event handler")})),this.ws.addEventListener("close",(e=>{this.logOp.resourceId="OnClose",this.logOp.resultDescription=e?`code: ${e.code}. reason: ${e.reason}`:"",this.logOp.success=!0,b.tG.info(508843799,b.nh.CoreDefault,this.logOp.stop()),o(this.errorMessage),this.isClosing=!1}))}egress(e){var t;const n=e.obj;(null===(t=this.settings)||void 0===t?void 0:t.webSocketWorkerShouldLogEgressCount)&&this.logEgressCount(n),this.ws.send(n,(e=>{e&&!this.hadEgressError&&(this.hadEgressError=!0,this.logOp.resourceId="OnEgressError",this.logOp.resultDescription=e.message,this.logOp.success=!1,b.tG.info(508843797,b.nh.CoreDefault,this.logOp.stop()))}))}close(){this.isClosing||(this.isClosing=!0,this.ws?this.ws.close():this.logWsUndefinedError("close"))}logIngressCount(e){const t=e.length;t>bo&&(this.ingressByteCountOp.start(),this.ingressByteCountOp.dimension2=t.toString().length.toString(),b.tG.info(508843794,b.nh.CoreDefault,this.ingressByteCountOp.stop()))}logEgressCount(e){const t="string"==typeof e?e.length:e.byteLength;t>bo&&(this.egressByteCountOp.start(),this.egressByteCountOp.dimension2=t.toString().length.toString(),b.tG.info(505710625,b.nh.CoreDefault,this.egressByteCountOp.stop()))}logWsUndefinedError(e){const t=new L.I({operationName:So.className,success:!1}).start();t.setClientMetadata(this.clientMetadata,!0),t.resourceId="webSocketUndefined",t.resultDescription=e+": this.ws null or undefined",b.tG.info(506566722,b.nh.CoreDefault,t.stop())}}So.className="WebSocketWorker";var wo=function(e,t,n,o){return new(n||(n=Promise))((function(s,r){function i(e){try{l(o.next(e))}catch(e){r(e)}}function a(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))};const To="CloseSessionsOnRuntimeUninit",Co="ShouldAppendClientFeatureFlights",_o="DontSendNewTokenOnReconnect",ko="WebSocketWorkerShouldLogEgressCount",Eo="FixIncorrectInvocationOfClaimsCallbacks",Ao="LogExpiredTimeoutTasksInBatchManager",Io=()=>n(74325).r;class Po{constructor(e,t,n,o){this.sessionsByDocSessionId=new Map,this.isDeltaGeneratorEnabled=!1,this.disableSyncDeltaSending=!1,this.hasBeenInitialized=!1,this.telemetryLogger=null,this.changeGateList=new Map([["SkipCheckingCachedClaimsChallenge",!0],[To,!0],[Co,!0],[_o,!0],[ko,!0],[Eo,!0],[Ao,!0]]),this.settings={annotationsOrderingEnabled:!0,deltaOperationsEnabled:!1,defaultBatchingEnabled:!0,batchingWith20msIntervalEnabled:!0,onAnnotationsSubmittedEnabled:!1,reduceBatchOperationsEnabled:!1,batchMessagesEnabled:!1,removeDuplicateFlights:!0,annotationDoesNotExistOnService:!0,reducedPingPongRetryEnabled:!1,maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled:!1,sendTokenFailureMessage:!0,closeSessionsOnRuntimeUninit:!1,shouldAppendClientFeatureFlights:!0,authTokenTimeoutMs:0,doNotSendNewTokenOnReconnect:!1,webSocketWorkerShouldLogEgressCount:!0,createBlobStorageContainerEnabled:!1,createCopyOfClientMetadataInSessionInit:!0,doNotAddCustomLogger:!1},this.settingToChangeGateName={closeSessionsOnRuntimeUninit:To,shouldAppendClientFeatureFlights:Co,doNotSendNewTokenOnReconnect:_o,webSocketWorkerShouldLogEgressCount:ko},this.isDownloaderCompatible=()=>"undefined"!=typeof Array&&void 0!==Array.from&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL,o&&(this.settings=o),this.workerFactory=e||(e=>e&&e===D.HttpFallback?new Dn:new So(void 0,this.settings));const s=this.createDefaultSessionManagerFactory();this.sessionManagerFactory=(...e)=>(null==t?void 0:t(...e))||s(...e),this.sessionFactory=n||(e=>new gn(e))}init(e,t,n,o){var s,r,i,a,l,c,u,d,h,p;const f=new L.I({operationName:"InitRuntime",resourceId:lo(e),dimension1:this.hasBeenInitialized.toString()});f.start(),this.hasBeenInitialized=!0,this.hostCallbacks=n,this.gateUtils=new Q(this.hostCallbacks,this.changeGateList),this.clientMetadata=t,this.clientMetadata&&(this.clientMetadata.runtimeVersion=Io()),this.telemetryLogger=new co(this.hostCallbacks),this.settings.doNotAddCustomLogger=this.settings.doNotAddCustomLogger||!!o.doNotAddCustomLogger,this.settings.doNotAddCustomLogger||(this.shouldAddLogger(f)?(b.tG.addLogger(this.telemetryLogger),this.addLoggingAggregator(o)):(b.tG.clearLoggers(),b.tG.addLogger(this.telemetryLogger))),Po.haveCalledInit=!0,this.annotationResultsProcessor=new z((()=>this.settings.annotationsOrderingEnabled)),this.inferenceServiceFactory=o.inferenceServiceFactory,f.dimension2=(0,b.OD)(N.q.info).toString();const g=[];e&&(this.defaultServiceUrl=sn.convertServiceUrlToWebSocket(e),this.serviceProtocol=this.defaultServiceUrl.split(":")[0].toLowerCase()),g.push(this.gateUtils.init().then((()=>wo(this,void 0,void 0,(function*(){yield Promise.all(Object.keys(this.settingToChangeGateName).map((e=>wo(this,void 0,void 0,(function*(){try{const t=yield this.gateUtils.isChangeGateEnabled(this.settingToChangeGateName[e]);this.settings[e]=t}catch(t){this.settings[e]=!1}})))))}))))),g.push(this.isFeatureEnabled("AnnotationsOrderingEnabled",!0).then((e=>{this.settings.annotationsOrderingEnabled=e}))),g.push(this.isFeatureEnabled("DefaultBatchingDisabled").then((e=>{var t;(t=this.settings).defaultBatchingEnabled&&(t.defaultBatchingEnabled=!e)}))),g.push(this.isFeatureEnabled("BatchingWith20msIntervalDisabled").then((e=>{var t;(t=this.settings).batchingWith20msIntervalEnabled&&(t.batchingWith20msIntervalEnabled=!e)}))),g.push(this.isFeatureEnabled("OnAnnotationsSubmittedDisabled").then((e=>{var t;(t=this.settings).onAnnotationsSubmittedEnabled&&(t.onAnnotationsSubmittedEnabled=!e)}))),g.push(this.isFeatureEnabled("ReduceBatchOperationsEnabled").then((e=>{var t;(t=this.settings).reduceBatchOperationsEnabled||(t.reduceBatchOperationsEnabled=e)}))),g.push(this.isFeatureEnabled("BatchMessagesEnabled").then((e=>{var t;(t=this.settings).batchMessagesEnabled||(t.batchMessagesEnabled=e)}))),g.push(sn.isChangeGateEnabled(this.hostCallbacks,"AnnotationDoesNotExistOnService").then((e=>{this.settings.annotationDoesNotExistOnService=e}))),g.push(sn.isFeatureEnabled(this.hostCallbacks,"ReducedPingPongRetryEnabled").then((e=>{var t;(t=this.settings).reducedPingPongRetryEnabled||(t.reducedPingPongRetryEnabled=e)}))),g.push(this.isFeatureEnabled("MaxNumberOfDeltaUpdateOpsPerItemPerBatch").then((e=>{var t;(t=this.settings).maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled||(t.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled=e)}))),g.push(sn.isChangeGateEnabled(this.hostCallbacks,"SendTokenFailureMessage").then((e=>{this.settings.sendTokenFailureMessage=e}))),g.push(this.isFeatureEnabled("CreateBlobStorageContainerEnabled").then((e=>{var t;(t=this.settings).createBlobStorageContainerEnabled||(t.createBlobStorageContainerEnabled=e)}))),g.push(sn.isChangeGateEnabled(this.hostCallbacks,"CreateCopyOfClientMetadataInSessionInit").then((e=>{var t;(t=this.settings).createCopyOfClientMetadataInSessionInit||(t.createCopyOfClientMetadataInSessionInit=e)})));const m={enableDeltas:!1,enableEarlyJoin:!1};g.push(Promise.all([this.isFeatureEnabled("DeltaOperationsEnabled").then((e=>m.enableDeltas=e)).catch((()=>m.enableDeltas=!1)),this.isFeatureEnabled("EarlyJoinCompletionEnabled").then((e=>m.enableEarlyJoin=e)).catch((()=>m.enableEarlyJoin=!1))]).then((()=>{this.localWorkflowManager=new In(o.modelDownloader&&this.isDownloaderCompatible()?o.modelDownloader:void 0,this.inferenceServiceFactory,m)})));const y=B(null!==(s=t.flights)&&void 0!==s?s:"");var v;return this.isDeltaGeneratorEnabled=y.getBooleanValue("Microsoft.Office.WordOnline.AugloopDeltas",null!==(r=o.isDeltaGeneratorEnabled)&&void 0!==r&&r),this.disableSyncDeltaSending=y.getBooleanValue("Microsoft.Office.WordOnline.DisableSyncDeltaSending",null!==(i=o.disableSyncDeltaSending)&&void 0!==i&&i),this.syncDeltaTimeout=y.getIntValue("Microsoft.Office.WordOnline.SyncDeltaTimeout",o.syncDeltaTimeout),(a=this.settings).defaultBatchingEnabled&&(a.defaultBatchingEnabled=!y.getBooleanValue("DefaultBatchingDisabled",!1)),(l=this.settings).batchingWith20msIntervalEnabled&&(l.batchingWith20msIntervalEnabled=!y.getBooleanValue("BatchingWith20msIntervalDisabled",!1)),(c=this.settings).reduceBatchOperationsEnabled||(c.reduceBatchOperationsEnabled=y.getBooleanValue("ReduceBatchOperationsEnabled",!1)),(u=this.settings).batchMessagesEnabled||(u.batchMessagesEnabled=y.getBooleanValue("BatchMessagesEnabled",!1)),(d=this.settings).removeDuplicateFlights&&(d.removeDuplicateFlights=y.getBooleanValue("RemoveDuplicateFlights",!0)),(h=this.settings).reducedPingPongRetryEnabled||(h.reducedPingPongRetryEnabled=y.getBooleanValue("ReducedPingPongRetryEnabled",!1)),(p=this.settings).maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled||(p.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled=y.getBooleanValue("maxNumberOfDeltaUpdateOpsPerItemPerBatch",!1)),this.settings.authTokenTimeoutMs=y.getIntValue("AuthTokenTimeoutMs",0),f.setDataField("Flights",JSON.stringify(this.settings)),o&&o.loggableUrls&&(v=o.loggableUrls,io.push(...v)),Promise.all(g).then((()=>{this.batchOptions=o.batchOptions,!this.batchOptions&&this.settings.defaultBatchingEnabled&&(this.batchOptions={delayMs:1,maxInputSize:1e6,delayMsMax:50},this.settings.batchingWith20msIntervalEnabled&&(this.batchOptions.delayMs=20)),this.batchOptions&&!this.batchOptions.delayMsMax&&(this.batchOptions.delayMsMax=50),o&&o.networkMode&&(this.networkMode=o.networkMode,o.networkMode===D.LocalWorkflowsOnly&&(this.sessionManagerFactory=()=>new Zt)),f.dimension0=JSON.stringify(this.batchOptions),this.logOperation(f,!0)})).catch((e=>{this.logOperation(f,!1,"Error",e?e.message:"(no error)")}))}getServiceProtocol(){return this.serviceProtocol}registerLocalWorkflow(e){this.localWorkflowManager.registerLocalWorkflow(e)}flushTelemetry(e){b.tG.flushAggregators(e)}createSession(e){var t;const n=e&&e.docSessionId?e.docSessionId:F(),o=e&&e.documentId?e.documentId:void 0,s=this.sessionsByDocSessionId.get(n),r=new L.I({operationName:"CreateSession",resourceId:n,dimension1:this.hasBeenInitialized.toString()});if(r.start(),s&&!1===s.isClosed)throw this.logOperation(r,!1,"Error","docSessionId already exists"),new Error("docSessionId already exists");let i=e&&null!==(t=e.serviceUrl)&&void 0!==t?t:this.defaultServiceUrl;i=sn.convertServiceUrlToWebSocket(i),i||((e=e||{}).networkMode=D.LocalWorkflowsOnly),!this.networkMode||void 0!==(null==e?void 0:e.networkMode)&&null!==(null==e?void 0:e.networkMode)||((e=e||{}).networkMode=this.networkMode),void 0!==(null==e?void 0:e.networkMode)&&null!==(null==e?void 0:e.networkMode)&&(null==e?void 0:e.networkMode)!==D.JSWebSockets||!this.hasHttpFallbackSession()||((e=e||{}).networkMode=D.HttpFallback);const a=Object.assign({},this.clientMetadata);if(a.docSessionId=n,o&&(a.documentId=o),e&&e.tid3pHost&&(a.tid3pHost=e.tid3pHost),e&&e.flights&&(a.flights=a.flights?a.flights+";"+e.flights:e.flights),this.settings.shouldAppendClientFeatureFlights){const e=["_acceptsClaimsChallengeMessages","_acceptsSeedingStatusChangeMessages"].join(";");a.flights=a.flights?`${a.flights};${e}`:e}this.settings.removeDuplicateFlights&&a.flights&&(a.flights=W(a.flights)),r.setDataField("Flights",a.flights||"");const l=this.sessionFactory({hostCallbacks:this.hostCallbacks,sessionManager:this.sessionManagerFactory(a,i,e),batchOptions:this.batchOptions,extensionConfigs:(null==e?void 0:e.extensionConfigs)||[],clientMetadata:a,userContext:e?e.userContext:void 0,localWorkflowManager:this.localWorkflowManager,annotationResultsProcessor:this.annotationResultsProcessor,localRegisteredWorkflows:(null==e?void 0:e.localRegisteredWorkflows)||[],enableRemoteExecutionNotification:(null==e?void 0:e.enableRemoteExecutionNotification)||!1,networkMode:null==e?void 0:e.networkMode,egress:e?e.egress:void 0,isDeltaGeneratorEnabled:this.isDeltaGeneratorEnabled,onAnnotationsSubmittedEnabled:this.settings.onAnnotationsSubmittedEnabled,disableSyncDeltaSending:this.disableSyncDeltaSending,syncDeltaTimeout:this.syncDeltaTimeout,reduceBatchOperationsEnabled:this.settings.reduceBatchOperationsEnabled,batchMessagesEnabled:this.settings.batchMessagesEnabled,annotationDoesNotExistOnServiceEnabled:this.settings.annotationDoesNotExistOnService,maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled:this.settings.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled,gateUtils:this.gateUtils});return this.sessionsByDocSessionId.set(n,l),e&&(e.onSessionConnect&&l.setConnectCallback(e.onSessionConnect),e.onSessionDisconnect&&l.setDisconnectCallback(e.onSessionDisconnect),e.onSessionReconnect&&l.setReconnectCallback(e.onSessionReconnect),e.onSessionClose&&l.setSessionCloseCallback(e.onSessionClose),e.onServerAuthenticationStateChangeCallback&&l.setServerAuthenticationStateChangeCallback(e.onServerAuthenticationStateChangeCallback),e.onClaimsChallengeCallback&&l.setClaimsChallengeCallback(e.onClaimsChallengeCallback),e.onSeedingStatusChangeCallback&&l.setSeedingStatusChangeCallback(e.onSeedingStatusChangeCallback)),this.logOperation(r,!0),l.initialize?l.initialize():Promise.resolve(l)}getSession(e){return this.sessionsByDocSessionId.get(e)}getSessionManagerFactory(){return this.sessionManagerFactory}shouldAddLogger(e){if(Po.haveCalledInit){const t=new Error("Runtime already initialized");return e.dimension3=t.stack,e.dimension2=(0,b.OD)(N.q.info).toString(),this.logOperation(e,!1,"Error",t.message),!1}return!0}createDefaultSessionManagerFactory(){return(e,t,n)=>{if(n&&n.networkMode==D.LocalWorkflowsOnly)return new Zt;const o=new fo,s=new On;let r=()=>{b.tG.error(573321615,b.nh.CoreDefault,"Unexpectedly not set sendMessage")};const i=new go((()=>s),e,o,((e,t,n)=>{r(e,t,n)}),{requestAuthToken:this.hostCallbacks.requestAuthToken,overrideSessionInitMessage:this.hostCallbacks.overrideSessionInitMessage,enableRemoteExecutionNotification:(null==n?void 0:n.enableRemoteExecutionNotification)||!1,sendTokenFailureMessageChangeGate:this.settings.sendTokenFailureMessage,authTokenTimeoutMs:this.settings.authTokenTimeoutMs,dontSendTokenOnReconnectChangeGate:this.settings.doNotSendNewTokenOnReconnect,createBlobStorageContainerEnabled:this.settings.createBlobStorageContainerEnabled,createCopyOfClientMetadataInSessionInit:this.settings.createCopyOfClientMetadataInSessionInit}),a=new ho(sn.convertServiceUrlToWebSocket(t),s,this.workerFactory,i,e,o,this.settings,this.gateUtils,null==n?void 0:n.networkMode);return r=a.sendMessage.bind(a),a.on("disconnect",(()=>o.clearRefreshTimeouts())),a.on("connect",((e,t,n,o)=>{e&&this.hostCallbacks.setSessionData&&this.hostCallbacks.setSessionData(t,n,o);const s=t.substring(t.lastIndexOf("/")+1);this.telemetryLogger.setServerSessionKey(s)})),a}}isFeatureEnabled(e,t=!1,n="None"){return sn.isFeatureEnabled(this.hostCallbacks,e,t,n)}hasHttpFallbackSession(){let e=!1;return this.sessionsByDocSessionId.forEach((t=>{t.isHttpFallback()&&(e=!0)})),e}logOperation(e,t,n,o){e.stop(),e.success=t,e.resultSignature=n,e.resultDescription=o,b.tG.info(573321622,b.nh.CoreDefault,e)}addLoggingAggregator(e){var t,n,o,s;"Dogfood"!==this.clientMetadata.releaseAudienceGroup&&"Automation"!==this.clientMetadata.releaseAudienceGroup&&(b.tG.addAggregator(ao("Operation","operationName",["ExecuteBatch","ReduceBatchOperations","ProcessResponse","LocalDeltaUpdate","ApplyFormattedTextTileDeltaForLocalWorkflows","ApplyTextTileDeltaForLocalWorkflows","FindRangeForDelta","RunModelForInferencing","GetResource","CreateTextTileDeltaFromItem","NetworkEgressControl","HttpEgress","LongPollNoOp","NetworkRateControllerAbandonedSyncMessage","NetworkRateControllerEgress","NetworkRateControllerQueueItem","NetworkRateControllerOnRateLimitResponse","NetworkRateControllerOnRateLimitError","NetworkRateControllerRateLimitsSet"],null!==(t=e.telemetryAggregationIntervalSec)&&void 0!==t?t:30)),b.tG.addAggregator(ao("Operation","operationName",["ExecuteWorkflow","ExecuteLambda","EarlyJoinCompletion","OnLongPollMessage","OnAnnotationResultsEgress"],null!==(n=e.telemetryAggregationIntervalSec)&&void 0!==n?n:60)),b.tG.addAggregator(ao("Operation","operationName",["LocalScopeExecutionNotification","RunLocalWorkflows","EarlyJoinCompletion","SetAnnotations","WIS.addItemOnContextIdList","WIS.setScopeItem"],null!==(o=e.telemetryAggregationIntervalSec)&&void 0!==o?o:120)),b.tG.addAggregator(ao("SessionHealth","sessionHealthEventName",["SendMessage","ProcessMessage"],null!==(s=e.telemetryAggregationIntervalSec)&&void 0!==s?s:60)))}uninitialize(){this.settings.closeSessionsOnRuntimeUninit&&(this.sessionsByDocSessionId.forEach((e=>{e.close()})),this.sessionsByDocSessionId.clear()),this.flushTelemetry(!0),this.hostCallbacks=null,this.hasBeenInitialized=!1,this.telemetryLogger=null,Po.haveCalledInit=!1,this.settings.doNotAddCustomLogger||(b.tG.clearAggregators(),b.tG.clearLoggers())}}const Mo=new Po;class xo{static create(e){var t;return new xo(e.session,null!==(t=e.scheduler)&&void 0!==t?t:new d)}constructor(e,t){this.session=e,this.scheduler=t}execute(e,t){return this.createExecutor(e,t).execute()}createExecutor(e,t){const n=new L.I({operationName:"AsyncClientExecute",success:!0}).setClientMetadata(this.session.getClientMetadata()).start();switch(e.type){case o.SingleAnnotation:return n.resourceId="SingleAnnotationRequest",new E(this.session,e,t,this.scheduler,n);case o.Streaming:return n.resourceId="StreamingRequest",new T(this.session,e,t,this.scheduler,n);case o.CustomMessage:return n.resourceId="CustomMessageRequest",new P(this.session,e,t,this.scheduler,n);default:throw new Error("Request Type not supported")}}}const Ro={category:on.Schema,schema:{name:"Exception",path:"message-schema.proto"}},Do=(on.Schema,(e,t=!1)=>{if(null==e)return"Invalid message passed";if(null==e.payload)return`${Ft[Ft.NoOutput]}: Payload is null`;if(null==e.payload.exceptionType)return"Payload is not an exception";{let n=Ft[e.payload.exceptionType];return n+=e.payload.message?`: ${e.payload.message}`:": No description",n+=t&&e.payload.data?`\n${e.payload.data.toString()}`:"",n}}),Oo=(e,t)=>{if(null==e)throw new Error("Cannot set exception on null message");e.payload=t,e.payloadSchema=Ro,e.messageType=Lt.Exception};var No,Lo;!function(e){let t,n,o,s,r,i;!function(e){e[e.Unknown=0]="Unknown",e[e.Text=1]="Text",e[e.Slide=2]="Slide"}(t=e.TileType||(e.TileType={})),function(e){e[e.Generic=0]="Generic",e[e.Title=1]="Title",e[e.SmartArt=2]="SmartArt",e[e.TableCell=3]="TableCell",e[e.TextBox=4]="TextBox",e[e.Notes=5]="Notes"}(n=e.TextTileType||(e.TextTileType={})),function(e){e[e.Undefined=0]="Undefined",e[e.Word=1]="Word",e[e.Phrase=2]="Phrase",e[e.Sentence=3]="Sentence",e[e.Paragraph=4]="Paragraph"}(o=e.TextTileElementUnit||(e.TextTileElementUnit={})),function(e){e[e.Undefined=0]="Undefined",e[e.Bullet=1]="Bullet",e[e.Numbered=2]="Numbered"}(s=e.ListType||(e.ListType={})),function(e){e[e.Undefined=0]="Undefined",e[e.AlphaLcParenBoth=1]="AlphaLcParenBoth",e[e.AlphaUcParenBoth=2]="AlphaUcParenBoth",e[e.AlphaLcParenR=3]="AlphaLcParenR",e[e.AlphaUcParenR=4]="AlphaUcParenR",e[e.AlphaLcPeriod=5]="AlphaLcPeriod",e[e.AlphaUcPeriod=6]="AlphaUcPeriod",e[e.ArabicParenBoth=7]="ArabicParenBoth",e[e.ArabicParenR=8]="ArabicParenR",e[e.ArabicPeriod=9]="ArabicPeriod",e[e.ArabicPlain=10]="ArabicPlain",e[e.RomanLcParenBoth=11]="RomanLcParenBoth",e[e.RomanUcParenBoth=12]="RomanUcParenBoth",e[e.RomanLcParenR=13]="RomanLcParenR",e[e.RomanUcParenR=14]="RomanUcParenR",e[e.RomanLcPeriod=15]="RomanLcPeriod",e[e.RomanUcPeriod=16]="RomanUcPeriod",e[e.CircleNumDbPlain=17]="CircleNumDbPlain",e[e.CircleNumWdBlackPlain=18]="CircleNumWdBlackPlain",e[e.CircleNumWdWhitePlain=19]="CircleNumWdWhitePlain",e[e.ArabicDbPeriod=20]="ArabicDbPeriod",e[e.ArabicDbPlain=21]="ArabicDbPlain",e[e.Ea1ChsPeriod=22]="Ea1ChsPeriod",e[e.Ea1ChsPlain=23]="Ea1ChsPlain",e[e.Ea1ChtPeriod=24]="Ea1ChtPeriod",e[e.Ea1ChtPlain=25]="Ea1ChtPlain",e[e.Ea1JpnChsDbPeriod=26]="Ea1JpnChsDbPeriod",e[e.Ea1JpnKorPlain=27]="Ea1JpnKorPlain",e[e.Ea1JpnKorPeriod=28]="Ea1JpnKorPeriod",e[e.Arabic1Minus=29]="Arabic1Minus",e[e.Arabic2Minus=30]="Arabic2Minus",e[e.Hebrew2Minus=31]="Hebrew2Minus",e[e.ThaiAlphaPeriod=32]="ThaiAlphaPeriod",e[e.ThaiAlphaParenR=33]="ThaiAlphaParenR",e[e.ThaiAlphaParenBoth=34]="ThaiAlphaParenBoth",e[e.ThaiNumPeriod=35]="ThaiNumPeriod",e[e.ThaiNumParenR=36]="ThaiNumParenR",e[e.ThaiNumParenBoth=37]="ThaiNumParenBoth",e[e.HindiAlphaPeriod=38]="HindiAlphaPeriod",e[e.HindiNumPeriod=39]="HindiNumPeriod",e[e.HindiNumParenR=40]="HindiNumParenR",e[e.HindiAlpha1Period=41]="HindiAlpha1Period"}(r=e.ListNumeration||(e.ListNumeration={})),function(e){e[e.Undefined=0]="Undefined",e[e.Delete=1]="Delete",e[e.Add=2]="Add",e[e.Change=3]="Change",e[e.Refresh=4]="Refresh"}(i=e.TextTileEventType||(e.TextTileEventType={}))}(No||(No={})),function(e){let t;!function(e){e[e.Undefined=0]="Undefined",e[e.Delete=1]="Delete",e[e.Add=2]="Add",e[e.Change=3]="Change",e[e.Refresh=4]="Refresh"}(t=e.SlideTileEventType||(e.SlideTileEventType={}))}(Lo||(Lo={}));class Fo{constructor(){this.cache=new Map}setReduceTimer(e,t,n,o=500,s=()=>!1,r=5e3){this.cache.has(e)||this.cache.set(e,new Map);const i=this.cache.get(e);i.has(t)&&clearTimeout(i.get(t).timer);const a=()=>{const a=i.get(t),l=Date.now()-a.start;s()&&l<r?a.timer=setTimeout(a.timerCallback,Math.min(o,r-l)):(i.size>1?i.delete(t):this.cache.delete(e),n())};i.set(t,{start:Date.now(),timerCallback:a,timer:setTimeout(a,o)})}clear(e,t){this.cache.forEach(((n,o)=>{e&&e!==o||n.forEach(((e,n)=>{t&&t!==n||clearTimeout(e.timer)}))})),this.cache.clear()}}class Bo{constructor(e=33e5){this.tokenCache=new Map,this.requestMap=new Map,this.requestRecordMap=new Map,this.tokenExpirationMs=e}updateAuthToken(e,t){const n=JSON.stringify(t);let o=this.requestRecordMap.get(n);return(void 0===o||this.isTokenExpired(o))&&(o={requestPromise:e.requestAuthToken(t).then((e=>{if(!e||!e.Token)throw new Error(`No token available for request ${n}`);this.tokenCache.set(n,e.Token)})),requestTime:sn.getCurrentTimeMs()},this.requestRecordMap.set(n,o)),o.requestPromise}getAuthTokenEntries(e,t){return Array.from(this.tokenCache.keys()).map((e=>{let t=this.requestMap.get(e);return void 0===t&&(t=JSON.parse(e),this.requestMap.set(e,t)),{requestKey:e,request:t}})).filter((({request:e})=>!t||e.DocId===t)).map((({requestKey:t,request:n})=>(this.isTokenExpired(this.requestRecordMap.get(t))&&this.updateAuthToken(e,n),{ticket:n.Tickets[0],token:this.tokenCache.get(t)})))}isTokenExpired(e){return sn.getCurrentTimeMs()>e.requestTime+this.tokenExpirationMs}}let Wo;const Uo=()=>{Wo=new Bo};Uo();const Go=(e,t,n,o,s,r,i,a,l,c)=>{const u={method:"POST",headers:{"content-type":"application/json","X-CorrelationId":s},body:JSON.stringify({payload:t.payload,payloadSchema:n,requestedSchema:o,clientMetadata:r,tokens:Wo.getAuthTokenEntries(i,l.docId)})};Mn(e,u,((u,d)=>{u?c(new Error(`Fetch error in remote lambda request to ${e}: ${u}`)):401===d.status?a>0?(b.tG.info(572838109,b.nh.CoreDefault,"Auth token required for remote lambda request"),d.json().then((e=>Wo.updateAuthToken(i,{Tickets:[e],DocId:l.docId}))).then((()=>{Go(e,t,n,o,s,r,i,a-1,l,c)})).catch((e=>{c({exceptionType:Ft.Authentication,message:e.message})}))):c({exceptionType:Ft.Authentication,message:"Remote lambda request retry with authentication token failed"}):d.ok?d.json().then((e=>{if(Array.isArray(e))if(e.length>0){let n=0;for(const o of e)t.moreResults=++n<e.length,c(null,o)}else c(new Error("No output"));else c(new Error("Did not receive a valid response for remote lambda request"))})).catch((e=>{c({exceptionType:Ft.LambdaThrow,message:e.message})})):c(new Error(`Remote lambda request failed with status ${d.status}`))}))},Ho=(e,t,n,o,s,r,i,a,l)=>{Array.isArray(a.authTickets)?Wo.updateAuthToken(i,{Tickets:a.authTickets,DocId:a.docId}).then((()=>{Go(e,t,n,o,s.id,r,i,1,a,l)})).catch((e=>{l({exceptionType:Ft.Authentication,message:e.message})})):Go(e,t,n,o,s.id,r,i,1,a,l)};class qo{constructor(){this.hasBeenOpened=!1,this.hadEgressError=!1,this.lastEgressTime=0,this.lastPongTime=0,this.remainingPingFailures=3,this.egressMessageCount=0,this.egressByteCount=0,this.isClosing=!1,this.pendingEgress=[]}init(e,t,n,o){this.ws=new yo(e),this.logOp=new L.I({operationName:qo.className,success:!0,dimension1:"V1"}).start(),this.egressTimer=Date.now(),this.egressMessageCountOp=new L.I({operationName:"WSEgressMessageCount",success:!0,dimension1:"V1"}),this.egressByteCountOp=new L.I({operationName:"WSEgressByteOrderOfMagnitude",success:!0,dimension1:"V1"}),this.ingressByteCountOp=new L.I({operationName:"WSIngressByteOrderOfMagnitude",success:!0,dimension1:"V1"});const s=e=>{this.logPingLatencyOp&&(this.logPingLatencyOp.success=e,b.tG.info(507789790,b.nh.CoreDefault,this.logPingLatencyOp.stop()),this.logPingLatencyOp=void 0)};this.ws.addEventListener("open",(e=>{n(),qo.logCountLimiter.log((()=>{this.logOp.resourceId="OnOpen",this.logOp.resultDescription="",this.logOp.success=!0,this.logOp.dimension0=this.pendingEgress.length.toString(),b.tG.info(507789789,b.nh.CoreDefault,this.logOp.stop())})),this.hasBeenOpened=!0,this.pendingEgress.forEach((e=>{this.egress({obj:e})})),this.pendingEgress=[],this.pingInterval=setInterval((()=>{this.logPingLatencyOp&&(--this.remainingPingFailures,s(!1)),this.remainingPingFailures>0&&this.hasBeenOpened&&this.lastPongTime<this.lastEgressTime&&(this.logPingLatencyOp=new L.I({operationName:"Ping",success:!0,dimension0:this.ws.bufferedAmount>=0?this.ws.bufferedAmount.toString().length.toString():void 0,dimension1:"V1"}).start(),this.ws.send(qo.pingPongMessage,(e=>{e&&(--this.remainingPingFailures,s(!1))})))}),3e4)})),this.ws.addEventListener("message",(e=>{this.logPingLatencyOp&&"string"==typeof e.data&&1===e.data.length&&e.data[0]===qo.pingPongMessage?(s(!0),this.lastPongTime=Date.now()):(this.logIngressCount(e.data),t(e.data))})),this.ws.addEventListener("error",(e=>{this.errorMessage=e.message,qo.logCountLimiter.log((()=>{this.logOp.resourceId="OnError",this.logOp.resultDescription=this.errorMessage,this.logOp.success=!1,b.tG.info(507789788,b.nh.CoreDefault,this.logOp.stop())})),this.ws.close()})),this.ws.addEventListener("close",(e=>{qo.logCountLimiter.log((()=>{this.logOp.resourceId="OnClose",this.logOp.resultDescription=e?`code: ${e.code}. reason: ${e.reason}`:"",this.logOp.success=!0,b.tG.info(507789787,b.nh.CoreDefault,this.logOp.stop())})),this.pingInterval&&(clearInterval(this.pingInterval),this.pingInterval=void 0),o(this.errorMessage),this.isClosing=!1}))}egress(e){const t=e.obj;this.logEgressCount(t instanceof ArrayBuffer||t instanceof Uint8Array?t.byteLength:t.length),this.lastEgressTime=Date.now(),this.hasBeenOpened?this.ws.send(t,(e=>{e&&!this.hadEgressError&&(this.hadEgressError=!0,qo.logCountLimiter.log((()=>{this.logOp.resourceId="OnFirstEgressError",this.logOp.resultDescription=e.message,this.logOp.success=!1,b.tG.info(507789786,b.nh.CoreDefault,this.logOp.stop())})))})):this.pendingEgress.push(t)}close(){this.isClosing||(this.isClosing=!0,this.pingInterval&&(clearInterval(this.pingInterval),this.pingInterval=void 0),this.ws.close())}logEgressCount(e){const t=Date.now(),n=t-this.egressTimer;n>1e3&&(this.egressMessageCount>50&&(this.egressMessageCountOp.start(),this.egressMessageCountOp.resultDescription="Egress message count: "+this.egressMessageCount.toString()+", Buffered amount: "+(this.ws.bufferedAmount>=0?this.ws.bufferedAmount.toString():"-")+", Time elapsed: "+n.toString(),b.tG.info(507789785,b.nh.CoreDefault,this.egressMessageCountOp.stop())),this.egressByteCount>1e5&&(this.egressByteCountOp.start(),this.egressByteCountOp.dimension2=this.egressByteCount.toString().length.toString(),this.egressMessageCountOp.resultDescription="Buffered amount: "+(this.ws.bufferedAmount>=0?this.ws.bufferedAmount.toString():"-")+", Time elapsed: "+n.toString(),b.tG.info(507789784,b.nh.CoreDefault,this.egressByteCountOp.stop())),this.egressTimer=t,this.egressMessageCount=0,this.egressByteCount=0),this.egressMessageCount++,this.egressByteCount+=null!=e?e:0}logIngressCount(e){const t=e.length;t>1e5&&(this.ingressByteCountOp.start(),this.ingressByteCountOp.dimension2=t.toString().length.toString(),b.tG.info(507789783,b.nh.CoreDefault,this.ingressByteCountOp.stop()))}}qo.className="WebSocketWorker",qo.logCountLimiter=new rn(qo.className),qo.pingPongMessage="~";class $o{constructor(e,t,n,o,s,r){this.requestId=e,this.correlationId=t,this.schemaName=n,this.data=o,this.callback=s,this.requestTimeoutInMs=r,this.ended=!1,this.startTime=0}startRequest(){this.startTime=sn.getCurrentTimeMs()}getMsUntilTimeout(){const e=sn.getCurrentTimeMs()-this.startTime;return this.requestTimeoutInMs-e}endRequest(e){this.ended||(this.invokeCallback(null,e,!0),this.ended=!0)}addResponseData(e){this.invokeCallback(e,null,!1)}invokeCallback(e,t,n){new Promise((()=>this.callback(e,t,n))).catch((e=>{}))}}let Vo;const zo=()=>{Vo=new Bo};zo();const jo=new class{constructor(e,t,n){this.requestCounter=0,this.activeRequests=[],this.pendingRequests=[],this.requestTimeoutInMs=e,this.workerFactory=t,this.maxActiveRequests=n}testConnection(e,t){let n=!1;const o=new L.I({cv:(new at).toString(),operationName:"WebSocketTest",resourceId:lo(e),success:!0}).start();return new Promise((s=>{const r=sn.createHealthCheckRequest(t);e?this.addRequest(e,r,o.cv,"HealthCheckRequest",((e,t,r)=>{t&&(o.success=!1,o.resultSignature="Error",o.resultDescription=t.message||t),e&&"OK"===e.status&&(n=!0),r&&(o.success&&!n&&(o.success=!1,o.resultSignature="NoResponseData"),b.tG.info(556617949,b.nh.CoreDefault,o.stop()),s(o.success))})):(o.success=!1,o.resultSignature="EmptyUrl",b.tG.info(557641870,b.nh.CoreDefault,o.stop()),s(o.success))}))}addRequest(e,t,n,o,s){const r=(this.requestCounter++).toString(),i=new $o(r,n,o,t,s,this.requestTimeoutInMs);this.getWorker(e),this.pendingRequests.push(i),this.egressPendingRequests()}egressPendingRequests(){for(;this.pendingRequests.length>0&&this.activeRequests.length<this.maxActiveRequests;){const e=this.pendingRequests.shift();if(this.activeRequests.push(e),1===this.activeRequests.length){const t=e.getMsUntilTimeout();setTimeout(this.onTimeout.bind(this),t)}e.startRequest(),this.worker&&this.worker.egress({obj:this.createRequestMessage(e.data,e.requestId,e.correlationId)})}}createRequestMessage(e,t,n){return JSON.stringify({correlationId:n,requestId:t,body:e})}onTimeout(){for(;this.activeRequests.length>0;){const e=this.activeRequests[0],t=e.getMsUntilTimeout();if(!(t<=0))return void setTimeout(this.onTimeout.bind(this),t);{const t=new Error("Request timed out");e.endRequest(t),this.activeRequests.shift(),this.egressPendingRequests()}}}onMessage(e){try{const t=JSON.parse(e);for(let e=0;e<this.activeRequests.length;e++){const n=this.activeRequests[e];if(n.requestId===t.requestId){t.end?(this.activeRequests.splice(e,1),n.endRequest(t.error),this.egressPendingRequests()):t.body&&n.addResponseData(t.body);break}}}catch(e){b.tG.error(557641871,b.nh.CoreDefault,e)}}onClose(e){const t=new Error(`Connection closed: ${e}`);for(const e of this.activeRequests)e.endRequest(t);this.activeRequests=[];for(const e of this.pendingRequests)e.endRequest(t);this.pendingRequests=[],this.worker=void 0}getWorker(e){return this.worker||(this.worker=this.workerFactory(),this.worker.init(e,this.onMessage.bind(this),(()=>{}),this.onClose.bind(this))),this.worker}}(3e4,(()=>new qo),50),Qo=(e,t,n,o,s,r,i,a,l,c)=>{const u={payload:t.payload,payloadSchema:n,requestedSchema:o,clientMetadata:r,tokens:Vo.getAuthTokenEntries(i,l.docId)};let d="";o&&o.schema&&(d=o.schema.name);let h=!1;jo.addRequest(e,u,s,d,((u,d,p)=>{if(!h)if(h=!0,null!=d)if(d.exceptionType===Ft.Authentication)try{const u=JSON.parse(d.data);a>0?(b.tG.info(572838108,b.nh.CoreDefault,"Auth token required for remote lambda WebSocket request"),Vo.updateAuthToken(i,{Tickets:[u],DocId:l.docId}).then((()=>{Qo(e,t,n,o,s,r,i,a-1,l,c)})).catch((e=>{c({exceptionType:Ft.Authentication,message:e.message})}))):c({exceptionType:Ft.Authentication,message:"Remote lambda request retry with authentication token failed"})}catch(e){c({exceptionType:Ft.Authentication,message:e.message})}else c(new Error(`Error in remote lambda WebSocket request to ${e}: ${d}`));else t.moreResults=!1,c(null,u)}))},Jo=(e,t,n,o,s,r,i,a,l)=>{Array.isArray(a.authTickets)?Vo.updateAuthToken(i,{Tickets:a.authTickets,DocId:a.docId}).then((()=>{Qo(e,t,n,o,s.id,r,i,1,a,l)})).catch((e=>{l({exceptionType:Ft.Authentication,message:e.message})})):Qo(e,t,n,o,s.id,r,i,1,a,l)};class Ko{constructor(){this.cache=new Map,this.bucketSizes=new Map}setBucketSize(e,t){this.bucketSizes.set(e,t)}setResult(e,t,n){if(!t.primary)return;let o=this.cache.get(e);o||(o=new Map,this.cache.set(e,o));let s=o.get(t.primary);if(s||(s=t.secondary?new Map:[],o.set(t.primary,s)),t.secondary)s.set(t.secondary,n);else{const t=s;t.length==this.getBucketSize(e)&&t.shift(),t.push(n)}}getResults(e,t){const n=this.cache.get(e);if(n){const e=n.get(t.primary);if(e){if(!t.secondary)return e;const n=Array.from(e.values());if(n.length>0)return n}}return[]}clear(e,t){t?this.cache.forEach(((n,o)=>{if(!e||e===o)if(t.secondary){const e=n.get(t.primary);e&&e.delete(t.secondary)}else n.delete(t.primary)})):e?this.cache.delete(e):this.cache.clear()}getBucketSize(e){return this.bucketSizes.get(e)||10}}var Yo,Xo;!function(e){e[e.Unknown=0]="Unknown",e[e.Local=1]="Local",e[e.Custom=2]="Custom",e[e.Remote=3]="Remote",e[e.BatchedRemote=4]="BatchedRemote"}(Yo||(Yo={}));class Zo{constructor(){this.throttleInfoMap=new Map}execute(e,t,n){if(t.throttleSettings.shouldBeThrottled&&t.throttleSettings.throttlingInterval>0){const o=this.getWorkflowThrottleInfo(t.name);if(null==o.currentTileId)o.currentTileId=e,o.timeOfPreviousStartedEvent=sn.getCurrentTimeMs(),n();else if(o.currentTileId===e){const e=sn.getCurrentTimeMs(),s=this.delayTime(o,e,t.throttleSettings.throttlingInterval);s>0?(o.latestCallback=n,null==o.lastTimeout&&(o.lastTimeout=setTimeout((()=>{const e=this.getWorkflowThrottleInfo(t.name);e.lastTimeout=void 0,e.timeOfPreviousStartedEvent=sn.getCurrentTimeMs(),e.latestCallback()}),s))):(o.timeOfPreviousStartedEvent=e,n())}else null!=o.lastTimeout&&(clearTimeout(o.lastTimeout),o.latestCallback(),o.lastTimeout=void 0),o.currentTileId=e,o.timeOfPreviousStartedEvent=sn.getCurrentTimeMs(),n()}else n()}delayTime(e,t,n){const o=t-e.timeOfPreviousStartedEvent;return Math.max(n-o,0)}getWorkflowThrottleInfo(e){let t=this.throttleInfoMap.get(e);return t||(t={currentTileId:void 0,timeOfPreviousStartedEvent:-1,latestCallback:()=>{},lastTimeout:void 0},this.throttleInfoMap.set(e,t)),t}}!function(e){e[e.Restricted=0]="Restricted",e[e.Unrestricted=1]="Unrestricted",e[e.Suppressed=2]="Suppressed"}(Xo||(Xo={}));class es{constructor(){this.canaryTextTileEventSubmittedByDocSessionId=new Set,this.stateByDocSessionId=new Map,this.executionQueueByDocSessionId=new Map,this.executionCountByDocSessionId=new Map}getOutputSchema(){return this.lambdas[this.lambdas.length-1].outputSchema}scheduleExecution(e,t){const n=this.docSessionIdExtractor?this.docSessionIdExtractor(e):void 0,o=this.getStateForDocSessionId(n);if(o===Xo.Restricted){const e=this.getExecutionQueueForDocSessionId(n);e.push(t),1===e.length&&t()}else o===Xo.Unrestricted?t():Xo.Suppressed}onStart(e){this.incrementExecutionCountForDocSessionId(e)}onFinish(e,t){if(this.decrementExecutionCountForDocSessionId(e),t===Ft.Authentication)this.stateByDocSessionId.set(e,Xo.Suppressed),this.executionQueueByDocSessionId.delete(e);else if(this.stateByDocSessionId.get(e)===Xo.Restricted){const n=this.getExecutionQueueForDocSessionId(e);if(n.shift(),void 0===t){this.stateByDocSessionId.set(e,Xo.Unrestricted),this.executionQueueByDocSessionId.delete(e);for(const e of n)e()}else n.length>0&&(0,n[0])()}}onRefresh(e){this.stateByDocSessionId=new Map,this.triggerOnRefresh&&(e?(this.executionQueueByDocSessionId.delete(e),this.executionCountByDocSessionId.delete(e)):(this.executionQueueByDocSessionId=new Map,this.executionCountByDocSessionId=new Map)),this.canaryTextTileEventSubmittedByDocSessionId.delete(e)}getStateForDocSessionId(e){let t=this.stateByDocSessionId.get(e);return void 0===t&&(t=es.executionQueuesEnabled?Xo.Restricted:Xo.Unrestricted,this.stateByDocSessionId.set(e,t)),t}getExecutionQueueForDocSessionId(e){let t=this.executionQueueByDocSessionId.get(e);return void 0===t&&(t=[],this.executionQueueByDocSessionId.set(e,t)),t}incrementExecutionCountForDocSessionId(e){const t=this.executionCountByDocSessionId.get(e)||0;this.executionCountByDocSessionId.set(e,t+1)}decrementExecutionCountForDocSessionId(e){const t=this.executionCountByDocSessionId.get(e)||0;t<=1?this.executionCountByDocSessionId.delete(e):this.executionCountByDocSessionId.set(e,t-1)}}es.executionQueuesEnabled=!0;const ts=e=>({category:on.Schema,schema:{name:e}}),ns="Tiling.TextTileEvent",os="ClpSlideTile",ss=(e,t)=>e===ns&&t&&t.type==No.TextTileEventType.Refresh,rs=(e,t)=>e===os&&t&&t.eventType==Lo.SlideTileEventType.Refresh,is=(e,t)=>ss(e,t)||rs(e,t),as=(e,t)=>{var n,o;return e===ns?null===(o=null===(n=t.tile)||void 0===n?void 0:n.metadata)||void 0===o?void 0:o.docSessionId:e===os?t.docId:void 0},ls=new class{constructor(){this.inputSchemasToWorkflows=new Map,this.inputSchemasToReduceWorkflows=new Map,this.reduceWorkflowsGroupingKeyExtractors=new Map,this.defaultWorkflowOptions={canProduceNullResult:!1,shouldSendResultsToHost:!0,enabledByDefault:!1,throttleSettings:{shouldBeThrottled:!1},triggerOnRefresh:!1},this.resultCache=new Ko,this.reduceTimerCache=new Fo,this.lookupTableCache=new Map,this.throttling=new Zo,this.lastTileRefreshSeq=-1,this.lastTileRefreshSeqByDocSessionId=new Map,this.tileRefreshByDocSessionIdEnabled=!0}init(e,t,n){const o=new L.I({operationName:"InitRuntimeALv1",resourceId:lo(e)});o.start(),this.clientMetadata=t,this.clientMetadata&&(this.clientMetadata.runtimeVersion=Io(),this.clientMetadata.flights&&(this.clientMetadata.flights=W(this.clientMetadata.flights))),this.hostCallbacks=n;const s=[];return s.push(this.isFeatureEnabled("DisableWebSocket").then((n=>!n&&(!(["Outlook Mac","Outlook Win32","PowerPoint Mac","PowerPoint Web","PowerPoint Win32","Word Mac","Word Win32"].indexOf(`${t.appName} ${t.appPlatform}`)>=0)||((e,t)=>jo.testConnection(e,t))(sn.convertServiceUrlToWebSocket(e),this.clientMetadata)))).then((t=>{e&&(this.serviceUrl=t?sn.convertServiceUrlToWebSocket(e):e,this.executeRemoteLambda=t?Jo:Ho,this.clearRemoteLambdaTokenCache=t?zo:Uo,this.serviceProtocol=this.serviceUrl.split(":")[0].toLowerCase())}))),s.push(this.isFeatureEnabled("WorkflowQueuesDisabled").then((e=>{es.executionQueuesEnabled=!e}))),s.push(this.isFeatureEnabled("TileRefreshByDocSessionIdDisabled").then((e=>{this.tileRefreshByDocSessionIdEnabled=!e}))),Promise.all(s).then((()=>{this.logOperation(o,!0)})).catch((e=>{this.logOperation(o,!1,"Error",e?e.message:"(no error)")}))}getServiceProtocol(){return this.serviceProtocol}registerSchemas(e,t){return Promise.resolve()}registerSimpleLocalWorkflow(e,t,n=this.defaultWorkflowOptions){return t.source=t.source||Yo.Custom,this.registerHardcodedWorkflow(e,[t],this.inputSchemasToWorkflows,n)}registerSimpleRemoteWorkflow(e,t,n,o,s=this.defaultWorkflowOptions){const r=[];return t&&(t.source=Yo.Custom,r.push(t)),n.source=n.func?Yo.Custom:Yo.Remote,r.push(n),o&&(o.source=Yo.Custom,r.push(o)),this.registerHardcodedWorkflow(e,r,this.inputSchemasToWorkflows,s)}registerMultipleLambdasWorkflow(e,t,n=this.defaultWorkflowOptions){return this.registerHardcodedWorkflow(e,t,this.inputSchemasToWorkflows,n)}registerReduceWorkflow(e,t,n,o=10,s=this.defaultWorkflowOptions){return this.reduceWorkflowsGroupingKeyExtractors.set(t.inputSchema,n),this.resultCache.setBucketSize(t.inputSchema,o),t.source=t.source||Yo.Custom,this.registerHardcodedWorkflow(e,[t],this.inputSchemasToReduceWorkflows,s)}registerMultipleLambdasReduceWorkflow(e,t,n,o=10,s=this.defaultWorkflowOptions){return this.reduceWorkflowsGroupingKeyExtractors.set(t[0].inputSchema,n),this.resultCache.setBucketSize(t[0].inputSchema,o),this.registerHardcodedWorkflow(e,t,this.inputSchemasToReduceWorkflows,s)}submit(e,t,n){this.submitToWorkflows(e,t,n,this.inputSchemasToWorkflows)}getGroupingKey(e,t,n){const o=this.reduceWorkflowsGroupingKeyExtractors.get(n);if(null==o)throw new Error("Reduce workflow does not have a grouping extractor");return o(t,e)}submitToWorkflows(e,t,n,o=this.inputSchemasToWorkflows){if(!this.hostCallbacks)return;let s;s=n?at.fromString(n):new at,this.handleTileRefresh(e,t,s);const r=o.get(e)||[];for(const n of r)is(e,t)&&!n.triggerOnRefresh||(n.useCanaryTextTile&&e===ns&&!n.canaryTextTileEventSubmittedByDocSessionId.has(as(e,t))&&(this.submitToWorkflow(ns,{type:(i=t).type,tile:{metadata:{docSessionId:i.tile.metadata.docSessionId,docId:i.tile.metadata.docId,seqnoCLPRefresh:i.tile.metadata.seqnoCLPRefresh,tileId:"A56B3127DBDFD0D6"},elements:[{text:"B91153AE828B4E48"}]}},s,n,o),n.canaryTextTileEventSubmittedByDocSessionId.add(as(e,t))),this.submitToWorkflow(e,t,s,n,o));var i}submitToWorkflow(e,t,n,o,s){const r={messageType:Lt.Input,correlationVector:n.newChild(),payload:t,payloadSchema:ts(o.lambdas[0].inputSchema),clientMetadata:this.clientMetadata},i=new L.I({cv:r.correlationVector.toString(),operationName:"ExecuteWorkflow",resourceId:o.name});i.setClientMetadata(this.clientMetadata),i.start(),o.scheduleExecution(t,(()=>{try{if(r.payload&&r.payload.tile&&r.payload.tile.metadata&&r.payload.tile.metadata.tileId){const n=r.payload.tile.metadata.tileId;this.throttling.execute(n,o,(()=>this.executeWorkflow(i,r,t,o,e,s)))}else this.executeWorkflow(i,r,t,o,e,s)}catch(e){i.success=!1,i.resultSignature="ExecuteException",i.resultDescription=e?e.message:"(no error)",b.tG.error(559290447,b.nh.CoreDefault,i.stop())}}))}handleTileRefresh(e,t,n){if(!is(e,t))return;const o=this.tileRefreshByDocSessionIdEnabled?as(e,t):void 0,s=((e,t)=>{var n,o;return ss(e,t)?null===(o=null===(n=t.tile)||void 0===n?void 0:n.metadata)||void 0===o?void 0:o.seqnoCLPRefresh:(rs(e,t),-1)})(e,t);if(this.tileRefreshByDocSessionIdEnabled){const e=this.lastTileRefreshSeqByDocSessionId.get(o);if(e>=0&&s<=e)return}else if(s<=this.lastTileRefreshSeq)return;const r=new L.I({cv:n.toString(),operationName:"TileRefresh",resultDescription:"",success:!0});if(r.start(),this.tileRefreshByDocSessionIdEnabled&&!o)return r.success=!1,r.resultDescription="NoDocSessionId",void b.tG.info(559290448,b.nh.CoreDefault,r.stop());this.inputSchemasToReduceWorkflows.forEach(((e,t)=>{e.some((e=>e.triggerOnRefresh))&&(this.tileRefreshByDocSessionIdEnabled?(this.resultCache.clear(t,{primary:o}),this.resultCache.clear(this.getForcedDocLevelSchema(t),{primary:o}),this.reduceTimerCache.clear(t,o)):(this.resultCache.clear(t),this.resultCache.clear(this.getForcedDocLevelSchema(t)),this.reduceTimerCache.clear(t)),e.some((e=>!e.triggerOnRefresh))&&(r.resultDescription+="X_"),r.resultDescription+=t+" ")})),this.clearRemoteLambdaTokenCache();const i=[];this.inputSchemasToWorkflows.forEach((e=>i.push(...e))),this.inputSchemasToReduceWorkflows.forEach((e=>i.push(...e)));for(const e of i)this.tileRefreshByDocSessionIdEnabled?e.onRefresh(o):e.onRefresh();this.tileRefreshByDocSessionIdEnabled?this.lastTileRefreshSeqByDocSessionId.set(o,s):this.lastTileRefreshSeq=s,b.tG.info(559290449,b.nh.CoreDefault,r.stop())}executeWorkflow(e,t,n,o,s,r){const i=o.docIdExtractor?o.docIdExtractor(t.payload):void 0,a=o.docSessionIdExtractor(n),l=this.tileRefreshByDocSessionIdEnabled?this.lastTileRefreshSeqByDocSessionId.get(a):this.lastTileRefreshSeq;o.onStart(a);const c=t=>{const i=this.tileRefreshByDocSessionIdEnabled?this.lastTileRefreshSeqByDocSessionId.get(a):this.lastTileRefreshSeq;if(o.triggerOnRefresh&&i!==l)return e.success=!0,e.resultSignature="TileRefreshIgnore",void b.tG.info(559290450,b.nh.CoreDefault,e.stop());const c=t.messageType==Lt.Exception&&t.payload.exceptionType==Ft.NoOutput,u=c&&o.canProduceNullResult,d=u?o.lambdas[o.lambdas.length-1].outputSchema:t.payloadSchema.schema.name,h=u?null:t.payload;t.messageType===Lt.Input||u?(o.shouldSendResultsToHost&&(r===this.inputSchemasToReduceWorkflows?this.hostCallbacks.onResult("Reduce.Input",n,d,h):this.hostCallbacks.onResult(s,n,d,h)),e.success=!0,e.resultSignature=c?"NoOutput":"ValidOutput"):c?(e.success=!0,e.resultSignature="NoOutput"):(e.success=!1,e.resultSignature="Exception",e.resultDescription=Do(t)),r!==this.inputSchemasToReduceWorkflows&&this.updateResultCacheForReduceWorkflows(s,n,d,h,t.correlationVector.toString()),t.moreResults||(e.stop(),b.tG.info(559290451,b.nh.CoreDefault,e),o.onFinish(a,t.payload&&t.payload.exceptionType?(e=>null==e||null==e.payload||null==e.payload.exceptionType?Ft.Unknown:e.payload.exceptionType)(t):void 0))};o.preExecutionPromise.then((()=>{const e={lookupTable:this.lookupTableCache.get(o.name),docId:i,docSessionId:a};let n=c;for(let t=o.lambdas.length-1;t>=0;t--)n=this.createLambdaExecutionStep(o.name,o.lambdas[t],e,n,c);n(t)}))}getForcedDocLevelSchema(e){return`~${e}`}updateResultCacheForReduceWorkflows(e,t,n,o,s){const r=this.inputSchemasToReduceWorkflows.get(n);if(r){let i;"docSessionId"===e?(i=this.getGroupingKey(e,t,n),this.resultCache.setResult(this.getForcedDocLevelSchema(n),i,o),i.secondary="*"):(i=this.getGroupingKey(e,t,n),((e,t)=>e===ns&&t&&t.type==No.TextTileEventType.Delete||e===os&&t&&t.eventType==Lo.SlideTileEventType.Delete)(e,t)&&null!=i.primary&&null!=i.secondary?this.resultCache.clear(void 0,i):this.resultCache.setResult(n,i,o));const a=r.some((e=>e.deferReduceUntilIdle)),l=[];this.inputSchemasToWorkflows.forEach((e=>l.push(...e.filter((e=>e.getOutputSchema()===n)))));const c=()=>a&&l.some((e=>e.executionCountByDocSessionId.get(i.primary)>0)),u=r.map((e=>e.deferReduceUntilIdleMaxDelayMs||0)).reduce(((e,t)=>Math.max(e,t)));this.reduceTimerCache.setReduceTimer(n,i.primary,(()=>{const e=this.resultCache.getResults(n,i);if(e.push(...this.resultCache.getResults(this.getForcedDocLevelSchema(n),{primary:i.primary})),Array.isArray(e)){const t={id:i.primary,values:e,isReduceInput:!0};this.submitToWorkflows(n,t,s,this.inputSchemasToReduceWorkflows)}else b.tG.error(559290452,b.nh.CoreDefault,`Cached results have unexpected type "${typeof e}"`)}),500,c,u)}}isFeatureEnabled(e,t=!1,n="None"){return this.hostCallbacks&&this.hostCallbacks.isFeatureEnabled?this.hostCallbacks.isFeatureEnabled("Microsoft.Office.AugLoop."+e,n).catch((()=>Promise.resolve(t))):Promise.resolve(t)}areLicenseFeaturesEnabled(e){return this.hostCallbacks&&this.hostCallbacks.areLicenseFeaturesEnabled?this.hostCallbacks.areLicenseFeaturesEnabled(e).catch((()=>Promise.resolve(!1))):Promise.resolve(!1)}isWorkflowEnabled(e,t,n,o,s){if(t.some((e=>e.source===Yo.Remote||e.source===Yo.BatchedRemote))){if(!this.serviceUrl)return s.resultDescription="Disabled because no service URL available for remote workflow",Promise.resolve(!1);if(this.clientMetadata&&this.clientMetadata.privateMode&&t.some((e=>(e.source===Yo.Remote||e.source===Yo.BatchedRemote)&&!e.canRunInPrivateMode)))return s.resultDescription="Disabled because we are running in private mode",Promise.resolve(!1)}let r;return(!this.clientMetadata||"Mac"!==this.clientMetadata.appPlatform&&"Win32"!==this.clientMetadata.appPlatform)&&(o=!0,s.resultDescription="Enabled by default due to platform name"),r=o?Promise.resolve(!0):this.isFeatureEnabled("WorkflowEnabled."+e),r.then((t=>t?this.isFeatureEnabled("WorkflowDisabled."+e).then((e=>e?(s.resultDescription="Disabled because explicitly disabled",!1):!n||this.areLicenseFeaturesEnabled(n).then((e=>(e||(s.resultDescription="Disabled because license check failed"),e))))):(s.resultDescription="Disabled because not explicitly enabled",!1)))}registerHardcodedWorkflow(e,t,n=this.inputSchemasToWorkflows,o){if(!e||e.length>40)throw new Error("Workflow name has invalid length");if(!1===new RegExp(/^[A-Z][a-zA-Z0-9_]+$/).test(e))throw new Error("Workflow name has invalid format");n.forEach((t=>{if(t.some((t=>t.name===e)))throw new Error("Workflow name already registered.")}));const s=new L.I({operationName:"WorkflowRegistration",resourceId:e,success:!0});return s.setClientMetadata(this.clientMetadata),s.start(),this.isWorkflowEnabled(e,t,o.licenseFeatures,o.enabledByDefault,s).then((r=>{if(s.resultSignature=r?"Enabled":"Disabled",s.stop(),b.tG.info(559290453,b.nh.CoreDefault,s),r){const s=t[0].inputSchema;let r=n.get(s);r||(r=[],n.set(s,r));let i=Promise.resolve();o.lookupTableLambda&&(i=new Promise(((t,n)=>{const s=new at,r={messageType:Lt.Input,correlationVector:s,payloadSchema:ts(o.lookupTableLambda.inputSchema),clientMetadata:this.clientMetadata,payload:{}},i=n=>{n.messageType===Lt.Input&&n.payload&&this.lookupTableCache.set(e,n.payload),t()};this.createLambdaExecutionStep("",o.lookupTableLambda,{},i,i)(r)})));const a=new es;a.name=e,a.lambdas=t,a.canProduceNullResult=o.canProduceNullResult,a.shouldSendResultsToHost=o.shouldSendResultsToHost,a.triggerOnRefresh=o.triggerOnRefresh,a.throttleSettings=o.throttleSettings||this.defaultWorkflowOptions.throttleSettings,a.docIdExtractor=o.docIdExtractor,a.docSessionIdExtractor=e=>e.isReduceInput?e.id:as(s,e),a.deferReduceUntilIdle=o.deferReduceUntilIdle,a.deferReduceUntilIdleMaxDelayMs=o.deferReduceUntilIdleMaxDelayMs,a.useCanaryTextTile=o.useCanaryTextTile,a.preExecutionPromise=i,r.push(a)}}))}logOperation(e,t,n,o){e.stop(),e.success=t,e.resultSignature=n,e.resultDescription=o,b.tG.info(559290454,b.nh.CoreDefault,e)}handleLambdaError(e,t,n,o,s){null!=e.exceptionType?Oo(t,e):e instanceof Error?Oo(t,{exceptionType:o,message:e.message}):Oo(t,{exceptionType:Ft.Unknown,message:e?e.toString():void 0}),this.logOperation(n,!1,"Exception",Do(t)),s(t)}handleLambdaOutput(e,t,n,o,s,r){e&&e.exceptionType!==Ft.NoOutput?null!=e.exceptionType?this.handleLambdaError(e,t,n,e.exceptionType,r):e instanceof Error?this.handleLambdaError(e,t,n,Ft.LambdaErrorCallback,r):(t.payload=e,t.payloadSchema=ts(o),this.logOperation(n,!0),s(t)):(Oo(t,{exceptionType:Ft.NoOutput}),this.logOperation(n,!0,"NoOutput"),r(t))}executeCustomLambdaStep(e,t,n,o,s,r){if(null==n.func)Oo(e,{exceptionType:Ft.LambdaThrow,message:"No lambda function set"}),this.logOperation(t,!1,"Error",Do(e)),r(e);else{const i=o=>{this.handleLambdaOutput(o,e,t,n.outputSchema,s,r)},a=(n,o)=>{this.handleLambdaOutput(n,e,t,o,r,r)};try{n.func(e.payload,n.config,o,i,a)}catch(n){this.handleLambdaError(n,e,t,Ft.LambdaThrow,r)}}}executeLocalLambdaStep(e,t,n,o,s){null==this.hostCallbacks.executeLocalLambda?(Oo(e,{exceptionType:Ft.LambdaThrow,message:"No local lambda host callback set"}),this.logOperation(t,!1,"Error",Do(e)),s(e)):this.hostCallbacks.executeLocalLambda(n.inputSchema,e.payload,n.outputSchema).then((r=>{this.handleLambdaOutput(r,e,t,n.outputSchema,o,s)})).catch((n=>{this.handleLambdaError(n,e,t,Ft.LambdaThrow,s)}))}executeRemoteLambdaStep(e,t,n,o,s,r){if(this.serviceUrl){t.resourceId+=`.${this.serviceProtocol}`;const i=(o,i)=>{o?this.handleLambdaError(o,e,t,o.exceptionType||Ft.LambdaErrorCallback,r):this.handleLambdaOutput(i,e,t,n.outputSchema,s,r)};if(o.authTickets=n.authTickets,n.source===Yo.Remote)this.executeRemoteLambda(this.serviceUrl,e,ts(n.inputSchema),ts(n.outputSchema),e.correlationVector,this.clientMetadata,this.hostCallbacks,o,i);else{this.batchedRemoteLambdaManager||(this.batchedRemoteLambdaManager=new Ut(((e,t,n)=>{const{remoteLambda:o,lambdaContext:s}=t.context;this.executeRemoteLambda(this.serviceUrl,{messageType:Lt.Input,correlationVector:{id:t.cv},payload:e,payloadSchema:ts(o.inputSchema),clientMetadata:this.clientMetadata},ts(o.remoteInputSchema),ts(o.remoteOutputSchema),{id:t.cv},this.clientMetadata,this.hostCallbacks,s,n)}),!1,!1,((e,t,n)=>{var o;const{lambdaContext:s}=n;this.updateResultCacheForReduceWorkflows("docSessionId",null!==(o=s.docSessionId)&&void 0!==o?o:s.docId,e,t)})));const{batchOptions:t}=n,s=this.normalizeBatchOptions(t),{groupingKeyExtractor:r}=s;s.groupingKeyExtractor=e=>`${n.name}-${r(e)}`;const a={name:n.name,remoteLambda:n,lambdaContext:o};this.batchedRemoteLambdaManager.addBatchItem(e.payload,s,a,e.correlationVector.id.length>127?e.correlationVector.id.substring(0,127)+"!":e.correlationVector.id,void 0,i)}}else Oo(e,{exceptionType:Ft.LambdaThrow,message:"No URL for remote lambda"}),this.logOperation(t,!1,"Error",Do(e)),r(e)}createLambdaExecutionStep(e,t,n,o,s){return r=>{const i=new L.I({cv:r.correlationVector.toString(),operationName:"ExecuteLambda",resourceId:t.name,dimension0:e});i.start(),t.source===Yo.Custom?this.executeCustomLambdaStep(r,i,t,n,o,s):t.source===Yo.Local?this.executeLocalLambdaStep(r,i,t,o,s):t.source===Yo.Remote||t.source===Yo.BatchedRemote?this.executeRemoteLambdaStep(r,i,t,n,o,s):(Oo(r,{exceptionType:Ft.LambdaThrow,message:"Unknown/No lambda location set"}),this.logOperation(i,!1,"Error",Do(r)),s(r))}}normalizeBatchOptions(e){if(!e)throw new Error("Expected batchConfig");const t=Object.assign({},e);return e.estimateSize||(t.estimateSize=Rt),t}},cs=(e,t)=>t.some((t=>e instanceof t));let us,ds;const hs=new WeakMap,ps=new WeakMap,fs=new WeakMap,gs=new WeakMap,ms=new WeakMap;let ys={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return ps.get(e);if("objectStoreNames"===t)return e.objectStoreNames||fs.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return bs(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function vs(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(ds||(ds=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(Ss(this),e),bs(hs.get(this))}:function(...e){return bs(t.apply(Ss(this),e))}:function(e,...n){const o=t.call(Ss(this),e,...n);return fs.set(o,e.sort?e.sort():[e]),bs(o)}:(e instanceof IDBTransaction&&function(e){if(ps.has(e))return;const t=new Promise(((t,n)=>{const o=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",r),e.removeEventListener("abort",r)},s=()=>{t(),o()},r=()=>{n(e.error||new DOMException("AbortError","AbortError")),o()};e.addEventListener("complete",s),e.addEventListener("error",r),e.addEventListener("abort",r)}));ps.set(e,t)}(e),cs(e,us||(us=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,ys):e);var t}function bs(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const o=()=>{e.removeEventListener("success",s),e.removeEventListener("error",r)},s=()=>{t(bs(e.result)),o()},r=()=>{n(e.error),o()};e.addEventListener("success",s),e.addEventListener("error",r)}));return t.then((t=>{t instanceof IDBCursor&&hs.set(t,e)})).catch((()=>{})),ms.set(t,e),t}(e);if(gs.has(e))return gs.get(e);const t=vs(e);return t!==e&&(gs.set(e,t),ms.set(t,e)),t}const Ss=e=>ms.get(e),ws=["get","getKey","getAll","getAllKeys","count"],Ts=["put","add","delete","clear"],Cs=new Map;function _s(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(Cs.get(t))return Cs.get(t);const n=t.replace(/FromIndex$/,""),o=t!==n,s=Ts.includes(n);if(!(n in(o?IDBIndex:IDBObjectStore).prototype)||!s&&!ws.includes(n))return;const r=async function(e,...t){const r=this.transaction(e,s?"readwrite":"readonly");let i=r.store;return o&&(i=i.index(t.shift())),(await Promise.all([i[n](...t),s&&r.done]))[0]};return Cs.set(t,r),r}var ks,Es,As;As=ys,ys={...As,get:(e,t,n)=>_s(e,t)||As.get(e,t,n),has:(e,t)=>!!_s(e,t)||As.has(e,t)},function(e){e.URL="URL",e.ArrayBuffer="ArrayBuffer"}(ks||(ks={}));class Is{constructor(e,t,n,o){this.dbName="ALModels_db",this.osName="ALModels_os",this.dbVersion=2,this.modelPathsCache=new Map,this.isPolymerSupported=Boolean(n),this.baseURL=`https://${t}/web/${e}`,this.polymerBaseURL=this.isPolymerSupported?`https://${n}`:"",this.fetchResource=null!=o?o:"undefined"!=typeof fetch?fetch:Gt.fetch;const s=new L.I({operationName:"CreateModelDownloader",success:!0,resultDescription:""});s.start(),this.isBrowserIdbCompatible().then((e=>{if(e){let e,t=0,n=0,o=0;const r=new Promise(((t,n)=>{e=setTimeout((()=>{n(new Error("Took longer than 10000 ms"))}),1e4)})),i=this.accessDB().then((e=>{const s=e.transaction(this.osName,"readwrite");return s.objectStore(this.osName).openCursor().then((function e(r){if(o++,r){const o=r.value;let s;return o.timesSinceUsage||(o.timesSinceUsage=0),o.timesSinceUsage++,o.timesSinceUsage>5?(n++,s=r.delete()):(t++,s=r.update(o)),s.then((()=>r.continue())).then(e)}return s.done}))}));this.initPromise=Promise.race([r,i]).catch((e=>{s.success=!1,s.resultDescription+=`${e.message} `})).then((()=>{s.dimension0=`${o}`,s.dimension1=`${t}`,s.dimension2=`${n}`,clearTimeout(e),this.closeDBAndEndLog(s,"initializing idb storage")}))}else s.resultDescription="Incompatible browser for IDB",b.tG.info(538706242,b.nh.CoreDefault,s.stop())})).catch((()=>{s.resultDescription="Issue determining idb compatibility",b.tG.info(536966936,b.nh.CoreDefault,s.stop())}))}getResourceAsArrayBuffer(e,t,n){const o=new L.I({operationName:"GetResource",success:!0,resultDescription:"",dimension0:ks.ArrayBuffer,dimension1:e,dimension2:t});o.start();const s={};return this.getResource(e,t,n,ks.ArrayBuffer,o,(e=>Promise.all(Array.from(e.keys()).map((t=>{const n=e.get(t);return n.arrayBuffer?n.arrayBuffer().then((e=>{s[t]=e})):new Promise(((e,o)=>{const r=new FileReader;r.readAsArrayBuffer(n),r.onload=n=>{const r=n.target.result;r instanceof ArrayBuffer?(s[t]=r,e()):o(new Error("Unable to obtain ArrayBuffer"))}}))}))))).then((()=>s))}getKey(e,t,n){return n?`${e}_${t}_${JSON.stringify(Array.from(n.entries()))}`:`${e}_${t}`}updateCache(e,t,n,o){this.modelPathsCache.set(this.getKey(e,t,n),o)}getCache(e,t,n){return this.modelPathsCache.get(this.getKey(e,t,n))}getResourceAsURL(e,t,n){const o=new L.I({operationName:"GetResource",success:!0,resultDescription:"",dimension0:ks.URL,dimension1:e,dimension2:t});o.start();const s={},r=this.getCache(e,t,n);return r?Promise.resolve(r):this.getResource(e,t,n,ks.URL,o,(e=>Promise.all(Array.from(e.keys()).map((t=>{s[t]=URL.createObjectURL(e.get(t))}))))).then((()=>this.getCache(e,t,n)||(this.updateCache(e,t,n,s),s)))}getResource(e,t,n,o,s,r){return this.getFiles(e,t,n,s).then((e=>r(e))).then((()=>{this.closeDBAndEndLog(s,`retrieving ${e}`)})).catch((t=>{throw s.resultDescription.indexOf(t.message)>=0&&(s.success=!1,s.resultDescription+=`${t.message} `),s.resultSignature=`Issue retrieving from CDN or translating to ${o}`,this.closeDBAndEndLog(s,`retrieving ${e}`),t}))}checkFirefoxCompatibility(e){const t=globalThis.navigator.userAgent.substring(e+8,e+11);return t.replace(".",""),parseInt(t,10)<=70?new Promise((function(e,t){const n=globalThis.indexedDB.open(this.dbName,this.dbVersion);n.onsuccess=function(){e(!0)},n.onerror=function(e){return t(e),!0}})):Promise.resolve(!0)}isBrowserIdbCompatible(){var e,t;return"undefined"==typeof Array||void 0===Array.from||"undefined"==typeof Proxy||"undefined"==typeof URL||void 0===URL.createObjectURL?Promise.resolve(!1):"undefined"!=typeof globalThis&&(null===(e=globalThis.navigator)||void 0===e?void 0:e.userAgent)?globalThis.navigator.userAgent.toLowerCase().indexOf("firefox")>-1?globalThis.indexedDB?this.checkFirefoxCompatibility(globalThis.navigator.userAgent.toLowerCase().indexOf("firefox")):Promise.resolve(!1):globalThis.navigator.userAgent.toLowerCase().indexOf("safari")>-1&&globalThis.navigator.userAgent.toLowerCase().indexOf("chrome")<=-1?(null===(t=globalThis.document)||void 0===t?void 0:t.hasStorageAccess)?globalThis.document.hasStorageAccess().then((()=>!0)).catch((()=>!1)):Promise.resolve(!1):Promise.resolve(!0):Promise.resolve(!1)}accessDB(){return this.accessDBPromise?this.accessDBPromise.then((e=>e.transaction(this.osName).done)).then((()=>this.accessDBPromise)).catch((()=>this.callOpenDB())):this.callOpenDB()}callOpenDB(){return this.accessDBPromise=function(e,t,{blocked:n,upgrade:o,blocking:s,terminated:r}={}){const i=indexedDB.open(e,t),a=bs(i);return o&&i.addEventListener("upgradeneeded",(e=>{o(bs(i.result),e.oldVersion,e.newVersion,bs(i.transaction))})),n&&i.addEventListener("blocked",(()=>n())),a.then((e=>{r&&e.addEventListener("close",(()=>r())),s&&e.addEventListener("versionchange",(()=>s()))})).catch((()=>{})),a}(this.dbName,this.dbVersion,{upgrade:e=>{e.objectStoreNames.contains(this.osName)&&e.deleteObjectStore(this.osName),e.createObjectStore(this.osName,{keyPath:"id",autoIncrement:!0})}})}endLog(e,t){e.success?(e.resultDescription=`Success ${t}`,b.tG.info(573329487,b.nh.CoreDefault,e.stop())):(e.resultDescription+=`error ${t}`,b.tG.error(573329488,b.nh.CoreDefault,e.stop()))}closeDBAndEndLog(e,t){this.accessDBPromise?this.accessDBPromise.then((e=>{e.close()})).catch((t=>{e.resultDescription.indexOf(t.message)>=0&&(e.success=!1,e.resultDescription+=`${t.message?t.message:"Error closing db"} `,e.resultSignature="Issue closing db")})).then((()=>{this.accessDBPromise=void 0,this.endLog(e,t)})):this.endLog(e,t)}getFiles(e,t,n,o){return this.isBrowserIdbCompatible().catch((e=>(o.success=!1,o.resultDescription+=`${e.message} `,o.resultSignature="Issue determining idb compatibility",!1))).then((s=>{const r=()=>{if(n){if(this.isPolymerSupported)return this.downloadFiles1CDN(e,t,n,o,s);throw new Error("Missing polymerBaseURL provided at host level for queries with modelFilters")}return this.downloadFiles(e,t,o,s)};return s?this.getFilesFromIDB(e,t,n,o).catch((e=>(e&&(o.resultDescription.indexOf(e.message)>=0&&(o.success=!1,o.resultDescription+=`${e.message} `),o.resultSignature="Issue retrieving from DB"),r()))):r()}))}getFilesFromIDB(e,t,n,o){return this.initPromise.catch((e=>{o.success=!1,o.resultDescription+=`${e.message} `,o.resultSignature="Issue initializing"})).then((()=>this.getModelOptions(e))).then((s=>{for(const r of s)if(r&&r.model&&r.version==t){if(!this.checkModelFiltersPass(n,r.filters))continue;return this.putModel(e,r.model,t,r.filters,o,r.id),Promise.resolve(r.model)}return Promise.reject()}))}checkModelFiltersPass(e,t){var n;for(const o of e){const e=null===(n=t.get(o[0]))||void 0===n?void 0:n.map((e=>e.toLocaleLowerCase()));if(!e)throw new Error(`Expected filter ${o[0]} to exist in metadata file`);if(e.indexOf(o[1].toLocaleLowerCase())<0)return!1}return!0}downloadFiles1CDN(e,t,n,o,s){let r;return o.dimension3="Polymer",n||(n=new Map),this.fetchResource(`${this.polymerBaseURL}/${e}/${t}/metadata.json`).then((e=>{if(e.ok)return e.text();throw new Error(`CDN download response status: ${e.status}`)})).then((s=>{var i,a;const l=JSON.parse(s);if(l.name!==e||l.version!==t)throw new Error(`Expected: ${e} version ${t}, received: ${l.name} version ${l.version}`);for(const e of l.variants)if(r=new Map(Object.entries(e)),this.checkModelFiltersPass(n,r))return(l.catalog?n.size+2:n.size+1!==r.size)&&(o.success=!1,o.resultDescription+=`Expected ${null===(i=r.keys)||void 0===i?void 0:i.length} # of filters, received ${null===(a=n.keys)||void 0===a?void 0:a.length}`),e.model_files;throw new Error("No model found with given filters")})).then((n=>Promise.all(n.map((n=>this.fetchResource(`${this.polymerBaseURL}/${e}/${t}/${n}`).then((e=>{if(e.ok)return e.blob();throw new Error(`CDN download response status: ${e.status}`)})).then((e=>[n,e]))))))).then((n=>{const i=new Map(n);return s?this.putModel(e,i,t,r,o):i}))}downloadFiles(e,t,n,o){return n.dimension3="FS",this.fetchResource(`${this.baseURL}/catalog_${e}_${t}.json`).then((e=>{if(e.ok)return e.text();throw new Error(`CDN download response status: ${e.status}`)})).then((n=>{const o=JSON.parse(n),s=`${o.MajorVersion}.${o.MinorVersion}/ModelResources`,r=`${e}/${t}/`;return Promise.all(o.Resources.map((e=>(e.Name.length>r.length&&e.Name.substring(0,r.length)===r&&(e.Name=e.Name.substring(r.length)),this.fetchResource(`${this.baseURL}/${s}/${r}${e.Name}.${e.Type}`).then((e=>{if(e.ok)return e.blob();throw new Error(`CDN download response status: ${e.status}`)})).then((t=>[`${e.Name}.${e.Type}`,t]))))))})).then((s=>{const r=new Map(s);return o?this.putModel(e,r,t,new Map,n):r}))}getModelOptions(e){return this.accessDB().then((t=>{const n=[],o=t.transaction(this.osName,"readonly");return o.objectStore(this.osName).openCursor().then((function t(s){if(s){const o=s.value;return o.modelId==e&&n.push(o),s.continue().then(t)}return o.done})).then((()=>n))}))}putModel(e,t,n,o,s,r){return o||(o=new Map),this.accessDB().then((s=>s.put(this.osName,{modelId:e,model:t,version:n,filters:o,timesSinceUsage:0},r))).catch((e=>{s.resultDescription.indexOf(e.message)>=0&&(s.success=!1,s.resultDescription+=`${e.message} `),s.resultSignature="Issue adding to DB"})).then((()=>t))}}!function(e){e[e.None=0]="None",e[e.Booleans=1]="Booleans",e[e.Float32s=2]="Float32s",e[e.Float64s=3]="Float64s",e[e.Int8s=4]="Int8s",e[e.Int16s=5]="Int16s",e[e.Int32s=6]="Int32s",e[e.Strings=7]="Strings",e[e.UnsignedInt8s=8]="UnsignedInt8s",e[e.UnsignedInt16s=9]="UnsignedInt16s",e[e.UnsignedInt32s=10]="UnsignedInt32s"}(Es||(Es={}));var Ps=function(e,t,n,o){return new(n||(n=Promise))((function(s,r){function i(e){try{l(o.next(e))}catch(e){r(e)}}function a(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))};class Ms{constructor(e,t,n){this.session=e,this.onnxObject=n,this.modelName=t}static create(e,t,n){return Ps(this,void 0,void 0,(function*(){const o=new L.I({operationName:"CreateModelForInferencing",success:!0,resourceId:t});return o.start(),n[e]?(o.resultDescription="Model already existed",b.tG.info(509699716,b.nh.CoreDefault,o.stop()),n[e]):n[e]=this.getInferenceSession(n).create(e).then((e=>(b.tG.info(540406807,b.nh.CoreDefault,o.stop()),new Ms(e,t,n)))).catch((e=>{throw o.resultDescription=`Error: ${e}`,b.tG.info(540406808,b.nh.CoreDefault,o.stop()),e}))}))}static getInferenceSession(e){if(null==e?void 0:e.InferenceSession)return e.InferenceSession;throw new Error("InferenceSession is not defined")}run(e){var t;return Ps(this,void 0,void 0,(function*(){const n=new L.I({operationName:"RunModelForInferencing",success:!0,resourceId:this.modelName});if(n.start(),null===(t=this.onnxObject)||void 0===t?void 0:t.Tensor){const t=e.getInputs(),o={};return Object.keys(t).forEach((e=>{const n=t[e];if(Array.isArray(n.values)&&n.values.length>0&&"boolean"==typeof n.values[0]){const t=new Uint8Array(n.values);o[e]=new this.onnxObject.Tensor(t,n.dimensions)}else o[e]=new this.onnxObject.Tensor(n.values,n.dimensions)})),this.session.run(o).then((e=>(b.tG.info(540406809,b.nh.CoreDefault,n.stop()),new Rs(e)))).catch((e=>{n.resultDescription=`Problem running model. ${e.message}`,b.tG.info(540406810,b.nh.CoreDefault,n.stop())}))}throw n.resultDescription="Unable to run model. Tensor not defined",b.tG.info(540406811,b.nh.CoreDefault,n.stop()),new Error("Tensor is not defined")}))}}class xs{constructor(){this.map={}}static create(){return new xs}getInputs(){return this.map}add(e,t,n){return this.map[e]={dimensions:t,values:n},this}}class Rs{constructor(e){for(const t of Object.keys(e))this[t]=new Ds(t,e[t])}}class Ds{constructor(e,t){this.resultName=e,this.result=t}name(){return this.resultName}outputType(){switch(this.result.type){case"string":return Es.Strings;case"int8":return Es.Int8s;case"int16":return Es.Int16s;case"int32":return Es.Int32s;case"bool":return Es.Booleans;case"uint8":return Es.UnsignedInt8s;case"uint16":return Es.UnsignedInt16s;case"uint32":return Es.UnsignedInt32s;case"float32":return Es.Float32s;case"float64":return Es.Float64s;default:throw new Error(`The output type ${this.result.type} is not supported.`)}}dimensions(){return this.result.dims}asBooleans(){if(this.outputType()===Es.Booleans)return this.result.data.map((e=>!!e));throw new Error(`asBooleans() was called; however, outputType() is ${this.outputType()}, not Type.Booleans.`)}asFloat32s(){if(this.outputType()===Es.Float32s)return this.result.data;throw new Error(`asFloat32s() was called; however, outputType() is ${this.outputType()}, not Type.Float32s.`)}asFloat64s(){if(this.outputType()===Es.Float64s)return this.result.data;throw new Error(`asFloat64s() was called; however, outputType() is ${this.outputType()}, not Type.Float64s.`)}asInt8s(){if(this.outputType()===Es.Int8s)return this.result.data;throw new Error(`asInt8s() was called; however, outputType() is ${this.outputType()}, not Type.Int8s.`)}asInt16s(){if(this.outputType()===Es.Int16s)return this.result.data;throw new Error(`asInt16s() was called; however, outputType() is ${this.outputType()}, not Type.Int16s.`)}asInt32s(){if(this.outputType()===Es.Int32s)return this.result.data;throw new Error(`asInt32s() was called; however, outputType() is ${this.outputType()}, not Type.Int32s.`)}asStrings(){if(this.outputType()===Es.Strings)return this.result.data;throw new Error(`asStrings() was called; however, outputType() is ${this.outputType()}, not Type.Strings.`)}asUnsignedInt8s(){if(this.outputType()===Es.UnsignedInt8s)return this.result.data;throw new Error(`asUnsignedInt8s() was called; however, outputType() is ${this.outputType()}, not Type.UnsignedInt8s.`)}asUnsignedInt16s(){if(this.outputType()===Es.UnsignedInt16s)return this.result.data;throw new Error(`asUnsignedInt16s() was called; however, outputType() is ${this.outputType()}, not Type.UnsignedInt16s.`)}asUnsignedInt32s(){if(this.outputType()===Es.UnsignedInt32s)return this.result.data;throw new Error(`asUnsignedInt32s() was called; however, outputType() is ${this.outputType()}, not Type.UnsignedInt32s.`)}}function Os(){return globalThis&&!globalThis.top&&(globalThis.top={}),null===globalThis||void 0===globalThis?void 0:globalThis.top}function Ns(e,t){e.src=t}function Ls(e,t){const n=globalThis[t];if(n&&n.InferenceSession&&n.Tensor){const o=e();return o&&!o[t]&&(o[t]=n),!0}return!1}class Fs{static createFactory(e,t,n,o,s){return r=>{var i;const a=o||Os;return!Fs.onnxRetrievalPromise||r?e&&t?((null===(i=a())||void 0===i?void 0:i.ort)&&!r?Promise.resolve():function(e,t,n,o,s){const r=new L.I({operationName:"CreateOnnxInferenceService",success:!0,resultDescription:""});if(r.start(),function(e){let t="";if("undefined"!=typeof navigator&&navigator.userAgent){const e=navigator.userAgent;!e.indexOf||e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0?t="Error: IE lacks necessary support":"undefined"==typeof Promise?t="Error: Promise is not supported":"undefined"==typeof WebAssembly&&(t="Error: WASM is not supported")}else t="Error: No window userAgent";return""!=t&&(e.resultDescription=t,b.tG.info(540406806,b.nh.CoreDefault,e.stop()),!0)}(r)){const e="Browser lacks necessary support for inference service";return r.success=!1,r.resultDescription=e,b.tG.info(540406803,b.nh.CoreDefault,r.stop()),Promise.reject(new Error(e))}return new Promise(((r,i)=>{if("undefined"!=typeof document){const a=document.createElement("script");(s||Ns)(a,e),a.onload=()=>{Ls(t,n)?(o&&(t()[n].env.wasm.wasmPaths=o),r()):(a.remove(),i(new Error("ort.Tensor and/or ort.InferenceSession are undefined")))},a.onerror=i,document.body.appendChild(a)}else globalThis.importScripts?(globalThis.importScripts(e),globalThis[n]=self[n],Ls(t,n)?(o&&(t()[n].env.wasm.wasmPaths=o),r()):i(new Error("ort.Tensor and/or ort.InferenceSession are undefined"))):i(new Error("Unexpected lack of document and importScripts"))})).then((()=>{b.tG.info(540406804,b.nh.CoreDefault,r.stop())})).catch((e=>{throw r.success=!1,r.resultDescription=e.message,b.tG.info(509871835,b.nh.CoreDefault,r.stop()),e}))}(this.createCdnUrl(e,t),a,"ort",n,s)).then((()=>{Fs.onnxRetrievalPromise=Promise.resolve(new Fs(a))})).catch((e=>{Fs.onnxRetrievalPromise=Promise.reject(e)})).then((()=>Fs.onnxRetrievalPromise)):Promise.reject(new Error("Error: appName and/or version not provided")):Fs.onnxRetrievalPromise}}static createCdnUrl(e,t){return`https://${e}${t}`}constructor(e){this.getCache=null,this.getCache=e}createModel(e,t){var n;return function(e,t,n){return Ms.create(e,t,n)}(e,t||"",null===(n=this.getCache())||void 0===n?void 0:n.ort)}createInputs(){return xs.create()}}var Bs=n(9622);class Ws{constructor(){this.bridgeMessageSequenceId=0,this.sessionCloseReasonMap=new Map,this.addCallbacksAlreadySet=new Set,this.sendBridgeMessage=e=>{this.messageBridge&&(e.seq=this.bridgeMessageSequenceId++,this.messageBridge.sendMessage(JSON.stringify(new Ce.vG(e))))},this.sendResponseAcrossBridge=(e,t,n,o)=>{e.catch((e=>(this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.error,e.message),new Ce._p({messageId:t.messageId,error:e.message})))).then((e=>{this.sendBridgeMessage({bridgeId:n,docSessionId:o,response:e})})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.error,e.message)}))}}initialize(e){this.messageBridge=e.messageBridge,this.getSessionCallback=e.getSessionCallback,this.hostTelemetryCallbacks=e.hostTelemetryCallbacks,this.messageBridge.registerMessageReceivedCallback(this.onBridgeMessageReceived.bind(this))}setInterceptor(e){this.interceptorBridge=e,this.interceptorBridge.registerMessageReceivedCallback(this.onBridgeMessageReceivedFromInterceptor.bind(this))}onBridgeMessageReceived(e){null!=this.interceptorBridge?this.interceptorBridge.sendMessage(e):this.handleBridgeMessage(e)}onBridgeMessageReceivedFromInterceptor(e){this.handleBridgeMessage(e)}handleBridgeMessage(e){try{const{bridgeId:t,docSessionId:n,message:o}=JSON.parse(e),r=s.h.getTypeNameFor(o);this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.info,`Received message with messageTypeName ${r} on bridgeId ${t} and docSessionId ${n}`);const i=this.getSessionCallback(n);if(this.sessionCloseReasonMap.has(n)){const e=this.sessionCloseReasonMap.get(n);this.sendBridgeMessage({bridgeId:t,docSessionId:n,message:new Ce.w9({reason:e})}),this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.info,`Session whose doc session id is ${n} is close due to ${e}`)}if(Bs.Cs.typeGuard(o))if(this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.info,`Sending GetHostBridgeSessionResponse to bridge with docSessionId ${n}`),i)i.then((e=>{this.sendBridgeMessage({bridgeId:t,docSessionId:n,response:new Bs.f8({messageId:o.messageId,isConnected:e.isConnected,isClosed:e.isClosed})})})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.error,e),this.sendBridgeMessage({bridgeId:t,docSessionId:n,response:new Ce._p({messageId:o.messageId,error:e})})}));else{const e="GetHostBridgeSessionRequestMessage called before session init";this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.error,e),this.sendBridgeMessage({bridgeId:t,docSessionId:n,response:new Ce._p({messageId:o.messageId,error:e})})}else if(Ce.n4.typeGuard(o))this.handleAnnotationActivationMessage(o,t,n,i);else if(Oe.typeGuard(o))this.handleGetAnnotationRequestBridgeMessage(o,t,n,i);else if(Ce.Tb.typeGuard(o)){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.info,"Receiving Sync Message");for(const e of o.ops)i.then((t=>{t.submitOperation(e,o.cv)})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.error,e.message)}));this.sendBridgeMessage({bridgeId:t,docSessionId:n,response:new Ce.YK({messageId:o.messageId})})}else if(Ce.GA.typeGuard(o)){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.info,`Releasing Annotation Activation token = ${o.token}`);const e=i.then((e=>e.releaseAnnotation(o.token).then((e=>(this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.info,`Sending Annotation Activation token = ${o.token}`),new Ce.Qq({messageId:o.messageId,lastRelease:e}))))));this.sendResponseAcrossBridge(e,o,t,n)}else if(Ce.g$.typeGuard(o))this.handleSubmittedCustomMessage(o,t,n,i);else if(Ce.eE.typeGuard(o))this.handleSessionInitMessage(t,n,i);else if(s.h.matchesTypesFor(o,[Bs.i2.getTypeName()]))this.handleInteractiveAuthMessage(o,t,n,i);else if(s.h.matchesTypesFor(o,[Bs.og.getTypeName()])){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.info,"Setting seeding status change callback");const e=(e=>{this.sendBridgeMessage({bridgeId:t,docSessionId:n,message:new Bs.U8({messageId:o.messageId,seedingStatusChangeMessage:e})})}).bind(this);i.then((t=>{t.setSeedingStatusChangeCallback(e)})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.error,e.message)}))}else if(s.h.matchesTypesFor(o,[Bs.tj.getTypeName()])){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.info,"Setting claims challenge callback");const e=(e=>{this.sendBridgeMessage({bridgeId:t,docSessionId:n,message:new Bs.Td({messageId:o.messageId,claimsChallengeMessage:e})})}).bind(this);i.then((t=>{t.setClaimsChallengeCallback(e)})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.error,e.message)}))}else this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.error,`Did not respond to ${r} with Id ${o.messageId}`),this.sendBridgeMessage({bridgeId:t,docSessionId:n,response:new Ce._p({messageId:o.messageId,error:"Unknown message type to handle"})})}catch(e){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.error,e.message),this.sendBridgeMessage({bridgeId:"unknown",docSessionId:"unknown",response:new Ce._p({messageId:"unknown",error:e.message})})}}addBridgeCallbacksForSession(e,t){e.then((e=>{e.setServerAuthenticationStateChangeCallback((e=>{this.sendBridgeMessage({bridgeId:"*",docSessionId:t,message:new Ce.wU({serverAuthenticationState:e})})})),e.setSessionCloseCallback((e=>{this.sessionCloseReasonMap.set(t,e.reason),this.sendBridgeMessage({bridgeId:"*",docSessionId:t,message:e})})),e.setConnectCallback(((e,n,o,s,r,i)=>{this.sendBridgeMessage({bridgeId:"*",docSessionId:t,message:new Ce.uN({origin:o,sessionKey:n.split("/").pop(),sessionUrlBase:n.split("/").slice(0,-1).join("/"),anonymousToken:s,routingSessionKey:r,blobFileId:i})}),this.sendBridgeMessage({bridgeId:"*",docSessionId:t,message:new Ce.gy({isSeedingRequired:e,sessionUrl:n,origin:o,authToken:s,routingSessionKey:r,blobFileId:i})})})),e.setReconnectCallback((()=>{this.sendBridgeMessage({bridgeId:"*",docSessionId:t,message:new Ce.lj})})),e.setDisconnectCallback((e=>{this.sendBridgeMessage({bridgeId:"*",docSessionId:t,message:new Ce.eG({error:e})})}))})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.error,e.message)}))}handleAnnotationActivationMessage(e,t,n,o){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.info,`Activate Annotation of type = ${e.annotationType} token = ${e.token}`);const s=((o,s)=>{this.sendBridgeMessage({bridgeId:t,docSessionId:n,message:new Ce.B_({annotationType:e.annotationType,areApologies:!0,ops:[o],cv:s})})}).bind(this),r=o.then((o=>o.activateAnnotation(e.annotationType,{config:e.config,callback:(o,s)=>{this.sendBridgeMessage({bridgeId:t,docSessionId:n,message:new Ce.B_({annotationType:e.annotationType,ops:[o],cv:s})})},apologyCallback:e.sendApologies?s:void 0,forceReturnCachedAnnotations:e.forceReturnCachedAnnotations}).then((t=>(this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.info,`Annotation Activation Response Recieved with token = ${t.token}`),new Ce.PY({messageId:e.messageId,token:t.token}))))));this.sendResponseAcrossBridge(r,e,t,n)}handleSessionInitMessage(e,t,n){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.info,`Initing session with doc session id ${t}`),this.addCallbacksAlreadySet.has(t)||(this.addBridgeCallbacksForSession(n,t),this.addCallbacksAlreadySet.add(t)),n.then((n=>{const o=n.getConnectParams();if(void 0===o)return;const s=o.sessionUrl;this.sendBridgeMessage({bridgeId:e,docSessionId:t,message:new Ce.uN({origin:o.origin,sessionKey:s.split("/").pop(),sessionUrlBase:s.split("/").slice(0,-1).join("/"),anonymousToken:o.authToken,routingSessionKey:o.routingSessionKey,blobFileId:o.blobFileId})}),this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.info,`Inited session with doc session id ${t}`),this.sendBridgeMessage({bridgeId:e,docSessionId:t,message:new Ce.wU({serverAuthenticationState:n.getServerAuthenticationState()})})})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.error,e.message)}))}handleGetAnnotationRequestBridgeMessage(e,t,n,o){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.info,"Sending Get Annotation request");const s=o.then((t=>t.getAnnotations({annotationType:e.annotationTypes,sourceInfo:e.sourceInfo,configs:e.configs,transientItems:e.transientItems,maxDelayMs:e.maxDelayMs,tryResolveUpstreamDependencies:e.tryResolveUpstreamDependencies,cv:e.cv})));Promise.resolve(s).then((o=>{var s,r,i,a,l,c,u;return a=this,l=void 0,u=function*(){var a,l,c,u,d,h,p;try{for(s=!0,r=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(n){t[n]=e[n]&&function(t){return new Promise((function(o,s){!function(e,t,n,o){Promise.resolve(o).then((function(t){e({value:t,done:n})}),t)}(o,s,(t=e[n](t)).done,t.value)}))}}}(o);!(a=(i=yield r.next()).done);s=!0){u=i.value,s=!1;const o=u;this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.info,"Receiving Get Annotation request");const r=new Ne({content:o.content,errorInfo:null===(d=o.error)||void 0===d?void 0:d.serviceError,warningInfo:null===(h=o.warning)||void 0===h?void 0:h.serviceError}),a=new Bs.wR({messageId:e.messageId,serverResponse:JSON.stringify(r),clientError:null===(p=o.error)||void 0===p?void 0:p.clientError,finalResponse:o.finalResponse});this.sendBridgeMessage({bridgeId:t,docSessionId:n,response:a})}}catch(e){l={error:e}}finally{try{s||a||!(c=r.return)||(yield c.call(r))}finally{if(l)throw l.error}}},new((c=void 0)||(c=Promise))((function(e,t){function n(e){try{s(u.next(e))}catch(e){t(e)}}function o(e){try{s(u.throw(e))}catch(e){t(e)}}function s(t){var s;t.done?e(t.value):(s=t.value,s instanceof c?s:new c((function(e){e(s)}))).then(n,o)}s((u=u.apply(a,l||[])).next())}))})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.error,e.message)}))}handleSubmittedCustomMessage(e,t,n,o){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.info,`Receiving SubmittedCustomMessage via message ${e.messageId}`),o.then((o=>{o.submitCustomMessage(e.customMessage).then((o=>{Ce.YK.typeGuard(o)?o.messageId=e.messageId:this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.error,"Unexpeced response type from SubmitCustomMessage"),this.sendBridgeMessage({bridgeId:t,docSessionId:n,response:o})})).catch((o=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.error,o.message),this.sendBridgeMessage({bridgeId:t,docSessionId:n,response:new Ce._p({messageId:e.messageId,error:o.message})})}))})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.error,e.message)}))}handleInteractiveAuthMessage(e,t,n,o){let s;this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.info,`Interactive auth requested via message ${e.messageId}`),o.then((o=>{o.authenticateInteractive().then((()=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.info,`Interactive auth succeeded for message ${e.messageId}`),s=new Ce.YK({messageId:e.messageId})})).catch((t=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.error,`Interactive auth failed for message ${e.messageId}`),s=new Ce._p({messageId:e.messageId,error:t.message})})).finally((()=>{this.sendBridgeMessage({bridgeId:t,docSessionId:n,response:s})}))})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.error,e.message)}))}}class Us{sendTraceTag(){}shipAssertTag(){}debugAssertTag(){}setCorrelationId(){}}const Gs=new class{constructor(){this.externalLogger=new Us}setCorrelationId(e){this.externalLogger.setCorrelationId(e)}setLogger(e){this.externalLogger=e}sendTraceTag(e,t,n,o){this.externalLogger.sendTraceTag(e,t,n,o)}debugAssertTag(e,t,n,o){this.externalLogger.debugAssertTag(e,t,n,o)}shipAssertTag(e,t,n,o){this.externalLogger.shipAssertTag(e,t,n,o)}};var Hs,qs;!function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_MSOSP_AddInCommands=220]="msoulscat_MSOSP_AddInCommands",e[e.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",e[e.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WacFeedback=356]="msoulscat_Wac_WacFeedback",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptGc2General=835]="msoulscat_Wac_PptGc2General",e[e.msoulscat_Wac_PptGc2GraphicHost=836]="msoulscat_Wac_PptGc2GraphicHost",e[e.msoulscat_Wac_PptGc2Operation=837]="msoulscat_Wac_PptGc2Operation",e[e.msoulscat_Wac_PptGc2EditCanvas=852]="msoulscat_Wac_PptGc2EditCanvas",e[e.msoulscat_Wac_PptDataSync=844]="msoulscat_Wac_PptDataSync",e[e.msoulscat_Wac_PptFluidRuntime=848]="msoulscat_Wac_PptFluidRuntime",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",e[e.msoulscat_Wac_PptVideos=846]="msoulscat_Wac_PptVideos",e[e.msoulscat_Uci_Insights=1303]="msoulscat_Uci_Insights",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_OAuth=3e3]="msoulscat_Wac_OAuth",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",e[e.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",e[e.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost",e[e.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools",e[e.msoulscat_Osf_Latency=1401]="msoulscat_Osf_Latency",e[e.msoulscat_Osf_Notification=1402]="msoulscat_Osf_Notification",e[e.msoulscat_Osf_Runtime=1403]="msoulscat_Osf_Runtime",e[e.msoulscat_Wac_AiMaker=3041]="msoulscat_Wac_AiMaker",e[e.msoulscat_Wac_AiRewrite=3043]="msoulscat_Wac_AiRewrite",e[e.msoulscat_Wac_AiInsert=3044]="msoulscat_Wac_AiInsert",e[e.msoulscat_Wac_AiSummarize=3047]="msoulscat_Wac_AiSummarize",e[e.msoulscat_Wac_CopilotCompose=3048]="msoulscat_Wac_CopilotCompose",e[e.msoulscat_Wac_Skittles=3049]="msoulscat_Wac_Skittles",e[e.msoulscat_Wac_CopilotChat=3050]="msoulscat_Wac_CopilotChat",e[e.msoulscat_Wac_Syntex=3051]="msoulscat_Wac_Syntex",e[e.msoulscat_Wac_WireGraph=3052]="msoulscat_Wac_WireGraph",e[e.msoulscat_Wac_CshCopilot=3053]="msoulscat_Wac_CshCopilot",e[e.msoulscat_Wac_CopilotComposeLaunchpad=3054]="msoulscat_Wac_CopilotComposeLaunchpad",e[e.msoulscat_Wac_CopilotProactiveSummary=3055]="msoulscat_Wac_CopilotProactiveSummary",e[e.msoulscat_Wac_CopilotProactiveShared=3056]="msoulscat_Wac_CopilotProactiveShared",e[e.msoulscat_Wac_CopilotCursor=3057]="msoulscat_Wac_CopilotCursor"}(Hs||(Hs={})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(qs||(qs={}));class $s{constructor(e){s.h.assign($s,this,e)}static getTypeName(){return"AugLoop_Powerpoint_Session_Protocol_PowerPointSessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SessionInitMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(e){return s.h.matchesTypesFor(e,[$s.getTypeName()])}}$s.H_={T_:$s.getTypeName(),B_:$s.getBaseTypes()};class Vs{constructor(e){s.h.assign(Vs,this,e)}static getTypeName(){return"AugLoop_Powerpoint_Session_Protocol_PowerPointSessionExtensionConfig"}static getBaseTypes(){return[]}static typeGuard(e){return s.h.matchesTypesFor(e,[Vs.getTypeName()])}}Vs.H_={T_:Vs.getTypeName(),B_:Vs.getBaseTypes()};var zs=function(e){return this instanceof zs?(this.v=e,this):new zs(e)};const js=(e,t)=>{const n=[];for(const s of Object.keys(e)){if(void 0===e[s]||null===e[s])continue;const r={name:t?`${t}.${s}`:s,dataType:(o=e[s],"string"==typeof o?0:"boolean"==typeof o?1:"number"==typeof o?2:void Gs.sendTraceTag(572838285,Hs.msoulscat_Wac_BrowserGeneral,qs.Warning,"Unsupported data field type")),value:e[s],classification:4};n.push(r)}var o;return n},Qs=e=>Promise.resolve(!1);class Js{constructor(){this._telemetryAggregationIntervalSec=30,this._eventHandlerDictionary={},this._changeGateEnabledCallback=void 0,this._bridge=null,this._bridgeInterceptor=null,this._sessionCloseReason=null,this._isSessionClosed=null,this._isSessionConnected=null,this._sessionConnectParams=null,this._serverAuthenticationState=Te.f.NotAuthenticated,this._connectCallbacks=new Map,this._connectionStateCallbackToken=0,this._claimsChallengeCallbacks=[],this._seedingStatusChangeCallbacks=[],this._bridgeMessageSequenceId=0,this._runtimeClientBridge=void 0,this._useBridgePackage=void 0,this.initialize=e=>{if(this._runtimeInitPromise)return void Gs.sendTraceTag(572838286,Hs.msoulscat_Wac_BrowserGeneral,qs.Info,"Runtime already initialized");Gs.sendTraceTag(572838287,Hs.msoulscat_Wac_BrowserGeneral,qs.Info,"Start and initialize augloop runtime ..."),this.checkParametersAndThrow("initialize",e);const t=[];t.push(this.isFeatureEnabled("Microsoft.Office.AugLoop.UseBridgePackage","None").then((e=>{this._useBridgePackage=e,Gs.sendTraceTag(505419218,Hs.msoulscat_Wac_BrowserGeneral,qs.Info,`Use bridge package: ${e}`)}))),t.push(this.isFeatureEnabled("ModelDownloaderEbrake","None").then((t=>{t?Gs.sendTraceTag(556376070,Hs.msoulscat_Wac_BrowserGeneral,qs.Info,"Resource downloader not created due to feature gate"):this.modelDownloaderFromCDN=e.appName&&e.downloadBaseUrl||e.downloadPolymerBaseUrl?new Is(e.appName,e.downloadBaseUrl,e.downloadPolymerBaseUrl):void 0}))),this.inferenceServiceFactory=e.appName&&e.inferenceServiceVersion?Fs.createFactory(e.appName,e.inferenceServiceVersion):void 0,this.powerpointParameters=e.powerpoint;const n={appName:e.appName,appPlatform:"Web",appVersion:e.appVersion,uiLanguage:e.uiLanguage,releaseAudienceGroup:e.releaseAudienceGroup,releaseChannel:e.releaseChannel,releaseCustomAudience:e.releaseCustomAudience,releaseFork:e.releaseFork,sessionId:e.sessionId,flights:e.flights,privateMode:e.privateMode,disabledServiceGroups:e.disabledServiceGroups,userSystemTimezone:e.userSystemTimezone,isClientTelemetrySampled:e.isClientTelemetrySampled},o={onResult:this.onResult.bind(this),onAnnotationResult:this.onAnnotationResult.bind(this),sendTelemetryEvent:this.sendTelemetryEvent.bind(this),sendDiagnosticTrace:this.sendDiagnosticTrace.bind(this),requestAuthToken:this.requestAuthToken.bind(this),isFeatureEnabled:this.isFeatureEnabled.bind(this),isChangeGateEnabled:this.isChangeGateEnabled.bind(this),setSessionData:this.setSessionData.bind(this),areLicenseFeaturesEnabled:Qs,onInitSession:this.onInitSession.bind(this),overrideSessionInitMessage:this.overrideSessionInitMessage.bind(this)},s=Promise.all(t).then((()=>Mo.init(e.serviceUrl,n,o,{telemetryAggregationIntervalSec:this._telemetryAggregationIntervalSec,modelDownloader:this.modelDownloaderFromCDN,inferenceServiceFactory:this.inferenceServiceFactory,isDeltaGeneratorEnabled:e.isDeltaGeneratorEnabled,disableSyncDeltaSending:e.disableSyncDeltaSending,syncDeltaTimeout:e.syncDeltaTimeout}))).then((()=>ls.init(e.serviceUrl,n,o)));this.createSession=()=>{this._runtimeInitPromise=s.then((()=>{let t=e.sessionCreationOptions;if(t||(t={}),this._useBridgePackage){if(this._runtimeClientBridge=new Ws,this._bridge){const e={sendDiagnosticTrace:(e,t,n)=>{const o=(()=>{switch(t){case N.q.error:return qs.Error;case N.q.warn:return qs.Warning;case N.q.info:return qs.Info;case N.q.verbose:case N.q.debug:return qs.Verbose;default:return qs.Info}})();Gs.sendTraceTag(e,Hs.msoulscat_Wac_BrowserGeneral,o,n)},sendTelemetryEvent:(e,t,n,o,s,r,i,a)=>{throw new Error("Method not implemented.")}};this._runtimeClientBridge.initialize({messageBridge:this._bridge,getSessionCallback:this.getSessionCallback.bind(this),hostTelemetryCallbacks:e,changeGateFeatureGateCallbacks:{isFeatureEnabled:this.isFeatureEnabled.bind(this),isChangeGateEnabled:this.isChangeGateEnabled.bind(this)}})}else Gs.sendTraceTag(505415107,Hs.msoulscat_Wac_BrowserGeneral,qs.Error,"bridge is not set, cannot initialize RuntimeClientBridge");this._bridgeInterceptor&&this._runtimeClientBridge.setInterceptor(this._bridgeInterceptor)}else{this._bridge&&this._bridge.registerMessageReceivedCallback(this.onBridgeMessage.bind(this)),this._bridgeInterceptor&&this._bridgeInterceptor.registerMessageReceivedCallback(this.onBridgeMessageFromInterceptor.bind(this));const e=t.onServerAuthenticationStateChangeCallback;t.onServerAuthenticationStateChangeCallback=t=>{this._serverAuthenticationState=t,e&&e(t),this._bridge&&this.sendBridgeMessage({bridgeId:"*",docSessionId:"*",message:new Ce.wU({serverAuthenticationState:t})})};const n=t.onSessionClose;t.onSessionClose=e=>{this._sessionCloseReason=e.reason,this._isSessionClosed=!0,n&&n(e),this._bridge&&this.sendBridgeMessage({bridgeId:"*",docSessionId:"*",message:e})};const o=t.onSessionReconnect;t.onSessionReconnect=()=>{o&&o(),this._bridge&&this.sendBridgeMessage({bridgeId:"*",docSessionId:"*",message:new Ce.lj})};const s=t.onSessionDisconnect;t.onSessionDisconnect=e=>{this._isSessionConnected=!1,s&&s(e),this._bridge&&(this._sessionConnectParams=void 0,this.sendBridgeMessage({bridgeId:"*",docSessionId:"*",message:new Ce.eG({error:e})}))}}const n=t.onSessionConnect;t.onSessionConnect=(e,t,o,s,r,i)=>{this._isSessionConnected=!0,this._isSessionClosed=!1,n&&n(e,t,o,s,r,i),this._connectCallbacks.forEach(((n,a)=>{n(e,t,o,s,r,i)})),this._bridge&&!this._useBridgePackage&&(this._sessionConnectParams||(this._sessionConnectParams={authToken:s,isSeedingRequired:e,sessionUrl:t,origin:o,routingSessionKey:r,blobFileId:i},this.sendSessionInitResponseToBridge("*","*")),this.sendBridgeMessage({bridgeId:"*",docSessionId:"*",message:new Ce.gy({isSeedingRequired:e,sessionUrl:t,origin:o,authToken:s,routingSessionKey:r,blobFileId:i})}))};const o=t.onClaimsChallengeCallback;t.onClaimsChallengeCallback=e=>{o&&o(e),this._claimsChallengeCallbacks.forEach((t=>{t(e)}))};const s=t.onSeedingStatusChangeCallback;t.onSeedingStatusChangeCallback=e=>{s&&s(e),this._seedingStatusChangeCallbacks.forEach((t=>{t(e)}))};const r=t&&t.docSessionId||e.sessionId;return Mo.createSession(Object.assign(Object.assign({},t),{docSessionId:r}))}))},this.createSession()},this.getSession=()=>this._runtimeInitPromise,this.setULSLogger=e=>{this.checkParametersAndThrow("setULSLogger",e&&e.ulsLogger),Gs.setLogger(e.ulsLogger)},this.setSendOTelEventCallback=e=>{this.checkParametersAndPropertyAndThrow("setSendOTelEventCallback",e&&e.sendOTelEvent,this._sendOTelEventCallback),this._sendOTelEventCallback=e.sendOTelEvent},this.setSendDiagnosticTraceCallback=e=>{this.checkParametersAndPropertyAndThrow("setSendDiagnosticTraceCallback",e&&e.sendDiagnosticTraceCallback,this._sendDiagnosticTraceCallback),this._sendDiagnosticTraceCallback=e.sendDiagnosticTraceCallback},this.setRequestAuthTokenCallback=e=>{this.checkParametersAndPropertyAndThrow("setRequestAuthTokenCallback",e&&e.requestAuthTokenCallback,this._requestAuthTokenCallback),this._requestAuthTokenCallback=e.requestAuthTokenCallback},this.setIsFeatureEnabledCallback=e=>{this.checkParametersAndPropertyAndThrow("setIsFeatureEnabledCallback",e&&e.featureEnabledCallback,this._featureEnabledCallback),this._featureEnabledCallback=e.featureEnabledCallback},this.setIsChangeGateEnabledCallback=e=>{this.checkParametersAndPropertyAndThrow("setIsChangeGateEnabledCallback",e&&e.changeGateEnabledCallback,this._changeGateEnabledCallback),this._changeGateEnabledCallback=e.changeGateEnabledCallback},this.registerLocalWorkflow=e=>{const t="registerLocalWorkflow";this.checkParametersAndThrow(t,e&&e.workflow),this.checkRuntimeInitAndThrow(t),this._runtimeInitPromise.then((t=>{t.registerLocalWorkflow(e.workflow)}))},this.activateAnnotation=e=>{const t="activateAnnotation",n=this.checkParameters(t,e&&e.annotationType)||this.checkRuntimeInit(t);return n?Promise.reject(n):this._runtimeInitPromise.then((t=>{let n;return(e.config||e.handler||e.stateUpdateHandler)&&(n={config:e.config,callback:e.handler,apologyCallback:e.apologyHandler,stateUpdateCallback:e.stateUpdateHandler,forceReturnCachedAnnotations:e.forceReturnCachedAnnotations}),t.activateAnnotation(e.annotationType,n)}))},this.updateAnnotationConfig=e=>{const t="updateAnnotationConfig",n=this.checkParameters(t,e&&e.token&&e.config)||this.checkRuntimeInit(t);return n?Promise.reject(n):this._runtimeInitPromise.then((t=>{t.updateAnnotationConfig(e.token,e.config)}))},this.releaseAnnotation=e=>{const t="releaseAnnotation",n=this.checkParameters(t,e&&e.token)||this.checkRuntimeInit(t);return n?Promise.reject(n):this._runtimeInitPromise.then((t=>t.releaseAnnotation(e.token)))},this.submitOperation=e=>{const t="submitOperation";this.checkParametersAndThrow(t,e&&e.operation),this.checkRuntimeInit(t),this._runtimeInitPromise.then((t=>{t.submitOperation(e.operation,e.cv)}))},this.setSessionDataCallback=e=>{this.checkParametersAndPropertyAndThrow("setSessionDataCallback",e&&(e.sessionDataCallback||e.handler),this._setSessionDataCallback),e.sessionDataCallback?this._setSessionDataCallback=e.sessionDataCallback:e.handler&&(this._setSessionDataCallback=(t,n,o)=>e.handler(t,n))},this.setAnnotationResultCallback=e=>{const t="setAnnotationResultCallback";if(this.checkParametersAndThrow(t,e&&e.handler),this._annotationResultCallback){const e=`${t} already called`;Gs.sendTraceTag(537401028,Hs.msoulscat_Wac_BrowserGeneral,qs.Error,e)}this._annotationResultCallback=e.handler},this.setAnnotationState=e=>{const t="setAnnotationState";this.checkParametersAndThrow(t,e&&e.parentPath&&e.id&&e.value),this.checkRuntimeInitAndThrow(t),this._runtimeInitPromise.then((t=>{t.setAnnotationState(e.parentPath,e.id,e.value)}))},this.setAnnotationMetadata=e=>{const t="setAnnotationMetadata";this.checkParametersAndThrow(t,e&&e.parentPath&&e.id&&e.value),this.checkRuntimeInitAndThrow(t),this._runtimeInitPromise.then((t=>{t.setAnnotationMetadata(e.parentPath,e.id,e.value)}))},this.setInitSessionCallback=e=>{this.checkParametersAndPropertyAndThrow("setInitSessionCallback",e&&e.initSessionCallback,this._initSessionCallback),this._initSessionCallback=e.initSessionCallback},this.setSessionInitOverrideCallback=e=>{this.checkParametersAndPropertyAndThrow("setSessionInitOverrideCallback",e&&e.handler,this._sessionInitOverrideCallback),this._sessionInitOverrideCallback=e.handler},this.setMessageBridge=e=>{this.checkParametersAndPropertyAndThrow("setMessageBridge",e&&e.bridge,this._bridge),this._bridge=e.bridge},this.setMessageBridgeToALInterceptor=e=>{this.checkParametersAndPropertyAndThrow("setMessageBridgeToALInterceptor",e&&e.bridge,this._bridgeInterceptor),this._bridgeInterceptor=e.bridge},this.forceReconnectSession=e=>{const t="forceReconnectSession",n=this.checkParameters(t,e)||this.checkRuntimeInit(t);return n?Promise.reject(n):this._runtimeInitPromise.then((e=>e.forceReconnect()))},this.setSessionCloseCallback=e=>{const t="setSessionCloseCallback",n=this.checkParameters(t,e&&e.callback)||this.checkRuntimeInit(t);return n?Promise.reject(n):this._runtimeInitPromise.then((t=>{t.setSessionCloseCallback(e.callback)}))},this.setConnectCallback=e=>{const t=this.getSessionStateCallbackToken("connect");return e.callback&&this._connectCallbacks.set(t,e.callback),t},this.removeConnectionStateCallback=e=>!!this._connectCallbacks.has(e.token)&&(this._connectCallbacks.delete(e.token),!0),this.setSeedingStatusChangeCallback=e=>{this._seedingStatusChangeCallbacks.push(e.callback)},this.submitCustomMessage=e=>{const t="submitCustomMessage",n=this.checkParameters(t,e&&e.message)||this.checkRuntimeInit(t);return n?Promise.reject(n):this._runtimeInitPromise.then((t=>t.submitCustomMessage(e.message)))},this.submitLargeBinaryDataMessage=e=>{const t="submitLargeBinaryDataMessage",n=this.checkParameters(t,e&&e.message)||this.checkRuntimeInit(t);return n?Promise.reject(n):Ce.VR.typeGuard(e.message)?this._runtimeInitPromise.then((t=>t.submitLargeBinaryDataMessage(e.message))):Promise.reject(`${t} only supports MicroSyncMessage`)},this.requestBinaryDataForBlob=e=>{const t="requestBinaryDataForBlob",n=this.checkParameters(t,e&&e.blob)||this.checkRuntimeInit(t);return n?Promise.reject(n):this._runtimeInitPromise.then((t=>t.requestBinaryDataForBlob(e.blob)))},this.closeSession=()=>{const e=this.checkRuntimeInit("closeSession");return e?Promise.reject(e):this._runtimeInitPromise.then((e=>{e.close()}))},this.startNewSession=()=>{if(!this.createSession){const e="startNewSession called before runtime init";throw Gs.sendTraceTag(537408074,Hs.msoulscat_Wac_BrowserGeneral,qs.Error,e),new Error(e)}this.createSession(),this._sessionCloseReason=null,this._sessionConnectParams=null},this.authenticateInteractive=()=>{const e=this.checkRuntimeInit("authenticateInteractive");return e?Promise.reject(e):this._runtimeInitPromise.then((e=>e.authenticateInteractive()))},this.getAnnotations=e=>{const t="getAnnotations",n=this.checkParameters(t,e&&e.request),o=this.checkRuntimeInit(t),s=n||o;return s?Promise.resolve({[Symbol.asyncIterator](){return function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,s=n.apply(e,t||[]),r=[];return o={},i("next"),i("throw"),i("return"),o[Symbol.asyncIterator]=function(){return this},o;function i(e){s[e]&&(o[e]=function(t){return new Promise((function(n,o){r.push([e,t,n,o])>1||a(e,t)}))})}function a(e,t){try{(n=s[e](t)).value instanceof zs?Promise.resolve(n.value.v).then(l,c):u(r[0][2],n)}catch(e){u(r[0][3],e)}var n}function l(e){a("next",e)}function c(e){a("throw",e)}function u(e,t){e(t),r.shift(),r.length&&a(r[0][0],r[0][1])}}(this,arguments,(function*(){const e=n?It.zy.InvalidRequest:It.zy.RuntimeNotInitialized;Gs.sendTraceTag(505952348,Hs.msoulscat_Wac_BrowserGeneral,qs.Error,`ClientError. Code: ${e}, Error: ${null==s?void 0:s.message}`),yield yield zs({content:void 0,error:{clientError:{code:e,error:null==s?void 0:s.message}}})}))}}):this._runtimeInitPromise.then((t=>t.getAnnotations(e.request,e.cancellationToken)))},this.getAsyncClient=e=>{const t=this.checkRuntimeInit("getAsyncClient");return t?Promise.reject(t):this._runtimeInitPromise.then((t=>xo.create({session:t,scheduler:e.scheduler})))},this.submit=e=>{const t="submit";this.checkParametersAndThrow(t,e&&e.inputSchema&&e.input),this.checkRuntimeInitAndThrow(t),this._runtimeInitPromise.then((()=>{ls.submit(e.inputSchema,e.input,e.correlationVector)}))},this.addEventHandler=e=>{this.checkParametersAndThrow("addEventHandler",e&&e.schemaName&&e.handler);const t=this._eventHandlerDictionary[e.schemaName]||[];t.push(e.handler),this._eventHandlerDictionary[e.schemaName]=t},this.removeEventHandler=e=>{this.checkParametersAndThrow("removeEventHandler",e&&e.schemaName&&e.handler);const t=this._eventHandlerDictionary[e.schemaName];if(!Array.isArray(t))return;const n=t.indexOf(e.handler);n>=0&&t.splice(n,1)},this.registerSimpleRemoteWorkflow=e=>{const t="registerSimpleRemoteWorkflow",n=this.checkParameters(t,e&&e.name&&e.lambdaRemote)||this.checkRuntimeInit(t);return n?Promise.reject(n):this._runtimeInitPromise.then((()=>ls.registerSimpleRemoteWorkflow(e.name,e.lambdaBefore,e.lambdaRemote,e.lambdaAfter)))},this.registerSimpleLocalWorkflow=e=>{const t="registerSimpleLocalWorkflow",n=this.checkParameters(t,e&&e.name&&e.lambda)||this.checkRuntimeInit(t);return n?Promise.reject(n):this._runtimeInitPromise.then((()=>ls.registerSimpleLocalWorkflow(e.name,e.lambda)))},this.registerReduceWorkflow=e=>Promise.resolve(),this.registerSchemas=e=>Promise.resolve(),this.onResult=(e,t,n,o)=>{const s=this._eventHandlerDictionary[n];if(s)for(const r of s)r&&r({inputSchema:e,input:t,outputSchema:n,output:o})},this.onAnnotationResult=(e,t)=>{this._annotationResultCallback&&this._annotationResultCallback(e,t)},this.requestAuthToken=e=>this._requestAuthTokenCallback?(this._requestAuthTokenCallback(e)||Promise.resolve("")).then((e=>{const t=e||"";return Promise.resolve({Token:t})})):Promise.resolve({Token:""}),this.sendTelemetryEvent=(e,t,n,o,s,r,i,a)=>{this._sendOTelEventCallback&&this._sendOTelEventCallback(((e,t,n,o,s,r,i)=>{const a={telemetryProperties:{ariaTenantToken:e,nexusTenantToken:-1},eventName:t.split("_").join("."),dataFields:js(n),eventFlags:{dataCategories:r,diagnosticLevel:i,samplingPolicy:1}};return o&&(a.eventContract={name:o,dataFields:js(s,o.split(".").slice(-1)[0])}),a})(e,t,n,o,s,i,a))},this.sendDiagnosticTrace=(e,t,n)=>{this._sendDiagnosticTraceCallback&&this._sendDiagnosticTraceCallback(e,t,n)},this.isFeatureEnabled=(e,t)=>{if(!e)return Promise.resolve(!1);if(0===e.indexOf("Microsoft.Office.AugLoop.")&&this._featureEnabledCallback){const t=e.slice(25);return Promise.resolve(this._featureEnabledCallback(t)||this._featureEnabledCallback(e))}return Promise.resolve(!1)},this.isChangeGateEnabled=e=>e&&this._changeGateEnabledCallback?Promise.resolve(this._changeGateEnabledCallback(e)):Promise.resolve(!1),this.setSessionData=(e,t,n)=>{this._setSessionDataCallback&&this._setSessionDataCallback(e,t,n)},this.overrideSessionInitMessage=e=>this._sessionInitOverrideCallback?this._sessionInitOverrideCallback(e):0===e.clientMetadata.appName.indexOf("PowerPoint")&&this.powerpointParameters?this.overridePowerPointSessionInitMessage(e):e,this.overridePowerPointSessionInitMessage=e=>{const t={downloadUrl:this.powerpointParameters.downloadUrl,getItemsEndPoint:this.powerpointParameters.getItemsEndPoint,documentOpenType:this.powerpointParameters.documentOpenType};for(const n of Object.keys(e))t[n]=e[n];return new $s(t)},this.onInitSession=()=>this._initSessionCallback?this._initSessionCallback():Promise.resolve(),this.checkParameters=(e,t)=>{if(!t){const t=`${e} called with invalid parameters`;return Gs.sendTraceTag(537408075,Hs.msoulscat_Wac_BrowserGeneral,qs.Error,t),new Error(t)}},this.checkParametersAndThrow=(e,t)=>{const n=this.checkParameters(e,t);if(n)throw n},this.checkParametersAndPropertyAndThrow=(e,t,n)=>{if(this.checkParametersAndThrow(e,t),n){const t=`${e} already called`;throw Gs.sendTraceTag(537408076,Hs.msoulscat_Wac_BrowserGeneral,qs.Error,t),new Error(t)}},this.checkRuntimeInit=e=>{if(!this._runtimeInitPromise){const t=`${e} called before runtime init`;return Gs.sendTraceTag(537408077,Hs.msoulscat_Wac_BrowserGeneral,qs.Error,t),new Error(t)}},this.checkRuntimeInitAndThrow=e=>{const t=this.checkRuntimeInit(e);if(t)throw t},this.sendBridgeMessage=e=>{this._bridge&&(e.seq=this._bridgeMessageSequenceId++,this._bridge.sendMessage(JSON.stringify(new Ce.vG(e))))},this.onBridgeMessage=e=>{null!=this._bridgeInterceptor?this._bridgeInterceptor.sendMessage(e):this.handleReceivedBridgeMessage(e)},this.sendSessionInitResponseToBridge=(e,t)=>{if(this._sessionConnectParams){const n=this._sessionConnectParams.sessionUrl;this.sendBridgeMessage({bridgeId:e,docSessionId:t,message:new Ce.uN({origin:this._sessionConnectParams.origin,sessionKey:n.split("/").pop(),sessionUrlBase:n.split("/").slice(0,-1).join("/"),anonymousToken:this._sessionConnectParams.authToken,routingSessionKey:this._sessionConnectParams.routingSessionKey,blobFileId:this._sessionConnectParams.blobFileId})})}},this.handleReceivedBridgeMessage=e=>{try{const{bridgeId:t,docSessionId:n,message:o}=JSON.parse(e),r=s.h.getTypeNameFor(o);if(Gs.sendTraceTag(509092291,Hs.msoulscat_Wac_BrowserGeneral,qs.Info,`Received ${r}`),null!=this._sessionCloseReason&&this.sendBridgeMessage({bridgeId:"*",docSessionId:"*",message:new Ce.w9({reason:this._sessionCloseReason})}),Bs.Cs.typeGuard(o)){Gs.sendTraceTag(505448338,Hs.msoulscat_Wac_BrowserGeneral,qs.Info,`Sending GetHostBridgeSessionResponse to bridge with docSessionId ${n}`);const e=this.checkRuntimeInit("GetHostBridgeSessionRequestMessage");e?this.sendBridgeMessage({bridgeId:t,docSessionId:n,response:new Ce._p({messageId:o.messageId,error:e.message})}):this.sendBridgeMessage({bridgeId:t,docSessionId:n,response:new Bs.f8({messageId:o.messageId,isConnected:this._isSessionConnected,isClosed:this._isSessionClosed})})}else if(Ce.n4.typeGuard(o)){const e=((e,s)=>{this.sendBridgeMessage({bridgeId:t,docSessionId:n,message:new Ce.B_({annotationType:o.annotationType,areApologies:!0,ops:[e],cv:s})})}).bind(this),s=this.activateAnnotation({annotationType:o.annotationType,config:o.config,handler:(e,s)=>{this.sendBridgeMessage({bridgeId:t,docSessionId:n,message:new Ce.B_({annotationType:o.annotationType,ops:[e],cv:s})})},apologyHandler:o.sendApologies?e:void 0,forceReturnCachedAnnotations:o.forceReturnCachedAnnotations}).then((e=>new Ce.PY({messageId:o.messageId,token:e.token})));this.sendResponseAcrossBridge(s,o,t,n)}else if(Oe.typeGuard(o))this.handleGetAnnotationsRequestMessage(t,n,o);else if(Ce.Tb.typeGuard(o)){for(const e of o.ops)this.submitOperation({operation:e,cv:o.cv});this.sendBridgeMessage({bridgeId:t,docSessionId:n,response:new Ce.YK({messageId:o.messageId})}),Gs.sendTraceTag(509092288,Hs.msoulscat_Wac_BrowserGeneral,qs.Info,`Responded to ${r}`)}else if(Ce.GA.typeGuard(o)){const e=this.releaseAnnotation({token:o.token}).then((e=>new Ce.Qq({messageId:o.messageId,lastRelease:e})));this.sendResponseAcrossBridge(e,o,t,n)}else if(Ce.g$.typeGuard(o))this.submitCustomMessage({message:o.customMessage}).then((e=>{Ce.YK.typeGuard(e)?(e.messageId=o.messageId,Gs.sendTraceTag(508432467,Hs.msoulscat_Wac_BrowserGeneral,qs.Info,`Responded to ${r}`)):Gs.sendTraceTag(508420946,Hs.msoulscat_Wac_BrowserGeneral,qs.Error,"Unexpeced response type from SubmitCustomMessage"),this.sendBridgeMessage({bridgeId:t,docSessionId:n,response:e})})).catch((e=>{Gs.sendTraceTag(508436636,Hs.msoulscat_Wac_BrowserGeneral,qs.Error,e.message),this.sendBridgeMessage({bridgeId:t,docSessionId:n,response:new Ce._p({messageId:o.messageId,error:e.message})})}));else if(Ce.eE.typeGuard(o))this.sendSessionInitResponseToBridge(t,n),this.sendBridgeMessage({bridgeId:t,docSessionId:n,message:new Ce.wU({serverAuthenticationState:this._serverAuthenticationState})});else if(s.h.matchesTypesFor(o,[Bs.i2.getTypeName()])){const e=this._runtimeInitPromise.then((e=>e.authenticateInteractive())).then((()=>new Ce.YK({messageId:o.messageId})));this.sendResponseAcrossBridge(e,o,t,n)}else if(s.h.matchesTypesFor(o,[Bs.og.getTypeName()])){const e=(e=>{this.sendBridgeMessage({bridgeId:t,docSessionId:n,message:new Bs.U8({messageId:o.messageId,seedingStatusChangeMessage:e})})}).bind(this);this._runtimeInitPromise.then((t=>{t.setSeedingStatusChangeCallback(e)})).catch((e=>{Gs.sendTraceTag(506474634,Hs.msoulscat_Wac_BrowserGeneral,qs.Warning,`RuntimeInitPromiseException for message with Id ${o.messageId}`)}))}else if(s.h.matchesTypesFor(o,[Bs.tj.getTypeName()])){const e=(e=>{this.sendBridgeMessage({bridgeId:t,docSessionId:n,message:new Bs.Td({messageId:o.messageId,claimsChallengeMessage:e})})}).bind(this);this._runtimeInitPromise.then((t=>{t.setClaimsChallengeCallback(e)})).catch((e=>{Gs.sendTraceTag(506987159,Hs.msoulscat_Wac_BrowserGeneral,qs.Warning,`RuntimeInitPromiseException for message with Id ${o.messageId}`)}))}else Gs.sendTraceTag(509092259,Hs.msoulscat_Wac_BrowserGeneral,qs.Warning,`Did not respond to ${r} with Id ${o.messageId}`),this.sendBridgeMessage({bridgeId:t,docSessionId:n,response:new Ce._p({messageId:o.messageId,error:"Unknown message type to handle"})})}catch(e){Gs.sendTraceTag(509092363,Hs.msoulscat_Wac_BrowserGeneral,qs.Error,e.message),this.sendBridgeMessage({bridgeId:"unknown",docSessionId:"unknown",response:new Ce._p({messageId:"unknown",error:e.message})})}},this.handleGetAnnotationsRequestMessage=(e,t,n)=>{const o={request:{annotationType:n.annotationTypes,sourceInfo:n.sourceInfo,configs:n.configs,transientItems:n.transientItems,maxDelayMs:n.maxDelayMs,tryResolveUpstreamDependencies:n.tryResolveUpstreamDependencies,cv:n.cv}};this.getAnnotations(o).then((o=>{var s,r,i,a,l,c,u;return a=this,l=void 0,u=function*(){var a,l,c,u,d,h,p;try{for(s=!0,r=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(n){t[n]=e[n]&&function(t){return new Promise((function(o,s){!function(e,t,n,o){Promise.resolve(o).then((function(t){e({value:t,done:n})}),t)}(o,s,(t=e[n](t)).done,t.value)}))}}}(o);!(a=(i=yield r.next()).done);s=!0){u=i.value,s=!1;const o=u,r=new Ne({content:o.content,errorInfo:null===(d=o.error)||void 0===d?void 0:d.serviceError,warningInfo:null===(h=o.warning)||void 0===h?void 0:h.serviceError}),a=new Bs.wR({messageId:n.messageId,serverResponse:JSON.stringify(r),clientError:null===(p=o.error)||void 0===p?void 0:p.clientError,finalResponse:o.finalResponse});this.sendResponseAcrossBridge(Promise.resolve(a),n,e,t)}}catch(e){l={error:e}}finally{try{s||a||!(c=r.return)||(yield c.call(r))}finally{if(l)throw l.error}}},new((c=void 0)||(c=Promise))((function(e,t){function n(e){try{s(u.next(e))}catch(e){t(e)}}function o(e){try{s(u.throw(e))}catch(e){t(e)}}function s(t){var s;t.done?e(t.value):(s=t.value,s instanceof c?s:new c((function(e){e(s)}))).then(n,o)}s((u=u.apply(a,l||[])).next())}))}))},this.sendResponseAcrossBridge=(e,t,n,o)=>{e.catch((e=>new Ce._p({messageId:t.messageId,error:e.message}))).then((e=>{this.sendBridgeMessage({bridgeId:n,docSessionId:o,response:e}),Gs.sendTraceTag(508937624,Hs.msoulscat_Wac_BrowserGeneral,qs.Info,`Responded to ${s.h.getTypeNameFor(t)}`)})).catch((e=>{Gs.sendTraceTag(508937623,Hs.msoulscat_Wac_BrowserGeneral,qs.Error,e.message)}))},this.onBridgeMessageFromInterceptor=e=>{this.handleReceivedBridgeMessage(e)},this.getSessionCallback=e=>this._runtimeInitPromise}getSessionStateCallbackToken(e){return e+"-callback-"+this._connectionStateCallbackToken++}}class Ks{constructor(e,t){var n,o,s,r,i,a;this.kind=J.SingleItem,this.isStateful=!1,this.id=e,t&&(this.inputTypes=null!==(n=t.inputTypes)&&void 0!==n?n:this.inputTypes,this.outputTypes=null!==(o=t.outputTypes)&&void 0!==o?o:this.outputTypes,this.isStateful=null!==(s=t.isStateful)&&void 0!==s?s:this.isStateful,this.requestedContextTypesRules=null!==(r=t.requestedContextTypesRules)&&void 0!==r?r:this.requestedContextTypesRules,this.definitionOverrideTargetWorkflows=null!==(i=t.definitionOverrideTargetWorkflows)&&void 0!==i?i:this.definitionOverrideTargetWorkflows,this.correlatedSignals=0!==(null===(a=t.correlatedSignals)||void 0===a?void 0:a.length)?t.correlatedSignals:this.correlatedSignals)}static create(e){return new Ks(e)}setInputTypes(e){return this.inputTypes=ln(e),this}setOutputTypes(e){return this.outputTypes=ln(e),this}setStateful(){return this.isStateful=!0,this}setRequestedContexts(e){var t;return this.requestedContextTypesRules=(null!==(t=this.requestedContextTypesRules)&&void 0!==t?t:this.requestedContextTypesRules=[]).concat(e),this}setLambdaType(e){return this.factory=e,this}setDefinitionOverrideTargetWorkflows(e){return this.definitionOverrideTargetWorkflows=e,this}setCorrelatedSignals(e){return 0!==e.length&&(this.correlatedSignals=e),this}setLambda(e,t){return this.factory=()=>({init:t||(e=>Promise.resolve()),execute:e,dispose:()=>{}}),this}validateOptions(){return{isValid:!0}}}class Ys{constructor(e){s.h.assign(Ys,this,e)}static getTypeName(){return"AugLoop_Chat_ChatsHolder"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return s.h.matchesTypesFor(e,[Ys.getTypeName()])}}Ys.H_={T_:Ys.getTypeName(),B_:Ys.getBaseTypes()};class Xs{constructor(e){s.h.assign(Xs,this,e)}static getTypeName(){return"AugLoop_Chat_Chat"}static getBaseTypes(){return[]}static typeGuard(e){return s.h.matchesTypesFor(e,[Xs.getTypeName()])}}Xs.H_={T_:Xs.getTypeName(),B_:Xs.getBaseTypes()};class Zs{constructor(e){s.h.assign(Zs,this,e)}static getTypeName(){return"AugLoop_Chat_MessagesHolder"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return s.h.matchesTypesFor(e,[Zs.getTypeName()])}}Zs.H_={T_:Zs.getTypeName(),B_:Zs.getBaseTypes()};class er{constructor(e){s.h.assign(er,this,e)}static getTypeName(){return"AugLoop_Chat_ChatMessage"}static getBaseTypes(){return[]}static typeGuard(e){return s.h.matchesTypesFor(e,[er.getTypeName()])}}er.H_={T_:er.getTypeName(),B_:er.getBaseTypes()};class tr{constructor(e){s.h.assign(tr,this,e)}static getTypeName(){return"AugLoop_Chat_TextChatMessage"}static getBaseTypes(){return["AugLoop_Chat_ChatMessage"]}static typeGuard(e){return s.h.matchesTypesFor(e,[tr.getTypeName()])}}tr.H_={T_:tr.getTypeName(),B_:tr.getBaseTypes()};class nr{static create(e){const t=new nr(e);return t.activateAnnotation(e.responseType).then((()=>t))}constructor(e){this.config=e,this.nextMessageId=0,this.responseCallbacks=new Map;const t=["session","chats"],n=F(),o="messages",s=[...t,n];this.messagesPath=[...s,o],this.config.session.submitOperations([new he.Xr({parentPath:t,items:[{id:n,body:e.chat}]}),new he.Xr({parentPath:s,items:[{id:o,body:new Zs}]})])}send(e,t){const n=""+this.nextMessageId++;this.responseCallbacks.set(n,t),this.config.session.submitOperations([new he.Xr({parentPath:this.messagesPath,items:[{id:n,body:e}]})])}close(){return this.config.session.releaseAnnotation(this.activatedAnnotationToken)}activateAnnotation(e){return this.config.session.activateAnnotation(e,{callback:e=>{if(he.Xr.typeGuard(e)&&this.isUnderSubtree(e.parentPath,this.messagesPath))for(const t of e.items){const n=e.parentPath[e.parentPath.length-1],o=this.responseCallbacks.get(n);o&&(o(t.body),this.responseCallbacks.delete(n))}}}).then((({token:e})=>{this.activatedAnnotationToken=e}))}isUnderSubtree(e,t){if(e.length<t.length)return!1;for(let n=0;n<t.length;n++)if(e[n]!==t[n])return!1;return!0}}class or{constructor(){this._augLoopRuntimeManager=new Js}getAugLoopRuntimeManager(){return this._augLoopRuntimeManager}createSingleItemWorkflow(e){return Ks.create(e)}createChatHelper(e){return this.getAugLoopRuntimeManager().getSession().then((t=>nr.create(Object.assign({session:t},e))))}createAugLoopRuntimeManager(){return new Js}}const sr=new or;class rr extends s.h{constructor(e){super(),this.Id=null,this.Id=e}}class ir extends rr{constructor(e,t){super(e),this.Content=null,this.Content=t}}var ar,lr,cr,ur,dr,hr;!function(e){e[e.Unknown=0]="Unknown",e[e.Text=1]="Text",e[e.Slide=2]="Slide"}(ar||(ar={}));class pr{constructor(e,t,n,o,s,r,i,a,l){this.Start=0,this.Length=0,this.FontWeight=ur.DontCare,this.Italic=!1,this.Underline=cr.None,this.Capitalization=lr.NoCaps,this.FontSize=0,this.Color=0,this.StyleName=null,this.Start=e,this.Length=t,this.FontWeight=n,this.Italic=o,this.Underline=s,this.Capitalization=r,this.FontSize=i,this.Color=a,this.StyleName=l}}class fr extends ir{constructor(e,t,n){super(e,t),this.Language=null,this.RevisionId=null,this.RevisionSequence=0,this.Indentation=0,this.OutlineLevel=0,this.ListType=dr.Number,this.Alignment=hr.Left,this.FormattedRanges=null,this.Language=n}}!function(e){e[e.NoCaps=0]="NoCaps",e[e.SmallCaps=1]="SmallCaps",e[e.AllCaps=2]="AllCaps",e[e.AllPetiteCaps=3]="AllPetiteCaps",e[e.PetiteCaps=4]="PetiteCaps",e[e.Unicase=5]="Unicase",e[e.Titling=6]="Titling",e[e.Other=7]="Other"}(lr||(lr={})),function(e){e[e.None=0]="None",e[e.Words=1]="Words",e[e.SingleLine=2]="SingleLine",e[e.DoubleLine=3]="DoubleLine",e[e.HeavyLine=4]="HeavyLine",e[e.DottedLine=5]="DottedLine",e[e.DottedHeavyLine=6]="DottedHeavyLine",e[e.DashLine=7]="DashLine",e[e.DashHeavyLine=8]="DashHeavyLine",e[e.DashLongLine=9]="DashLongLine",e[e.DashLongHeavyLine=10]="DashLongHeavyLine",e[e.DotDashLine=11]="DotDashLine",e[e.DotDashHeavyLine=12]="DotDashHeavyLine",e[e.DotDotDashLine=13]="DotDotDashLine",e[e.DotDotDashHeavyLine=14]="DotDotDashHeavyLine",e[e.WavyLine=15]="WavyLine",e[e.WavyHeavyLine=16]="WavyHeavyLine",e[e.WavyDoubleLine=17]="WavyDoubleLine"}(cr||(cr={})),function(e){e[e.DontCare=0]="DontCare",e[e.Thin=1]="Thin",e[e.ExtraLight=2]="ExtraLight",e[e.Light=3]="Light",e[e.Normal=4]="Normal",e[e.Medium=5]="Medium",e[e.SemiBold=6]="SemiBold",e[e.Bold=7]="Bold",e[e.ExtraBold=8]="ExtraBold",e[e.Heavy=9]="Heavy"}(ur||(ur={})),function(e){e[e.Number=0]="Number",e[e.Bullet=1]="Bullet",e[e.Lim=13]="Lim",e[e.Nil=14]="Nil",e[e.Any=15]="Any",e[e.NoList=16]="NoList",e[e.Invalid=42]="Invalid"}(dr||(dr={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Center=2]="Center",e[e.Justified=3]="Justified",e[e.Other=4]="Other",e[e.None=5]="None"}(hr||(hr={}));class gr{}class mr{constructor(e,t){this.type=e,this.data=t}}class yr{constructor(e,t,n){this.exceptionType=e,this.message=t,this.data=n}static exceptionTypeToString(e){switch(e){case 0:return"Unknown";case 1:return"NoOutput";case 2:return"Authentication";case 3:return"JoinTimedOut";case 4:return"LambdaThrow";case 5:return"LambdaErrorCallback";default:return"Invalid Error Type"}}static parseExceptionData(e){let t="";try{t=String.fromCharCode.apply(null,e)}catch(e){return"Failed to decode exception data:"+e.toString()}return t}}class vr{constructor(e,t){this._proto=e,this._schemas=t}get proto(){return this._proto}get schemas(){return this._schemas}registerSchemas(e){return e.registerSchemas({proto:this.proto,schemaNames:this.schemas})}}class br{constructor(e,t){this._tileName=e,this._tileSchema=t,this._addedSchemaName=e+"Added",this._attachedSchemaName=e+"Attached",this._changedSchemaName=e+"Changed",this._deletedSchemaName=e+"Deleted"}get tileName(){return this._tileName}get tileSchema(){return this._tileSchema}get addedSchemaName(){return this._addedSchemaName}get attachedSchemaName(){return this._attachedSchemaName}get changedSchemaName(){return this._changedSchemaName}get deletedSchemaName(){return this._deletedSchemaName}registerSchemas(e){const t='syntax="proto3";message '+this.addedSchemaName+" "+this.tileSchema+"; message "+this.changedSchemaName+" "+this.tileSchema+"; message "+this.attachedSchemaName+" "+this.tileSchema+"; message "+this.deletedSchemaName+" "+this.tileSchema+"; ",n=[this.addedSchemaName,this.changedSchemaName,this.attachedSchemaName,this.deletedSchemaName];return e.registerSchemas({proto:t,schemaNames:n})}}class Sr{initialize(e){}getSession(){return null}setULSLogger(e){}setSendOTelEventCallback(e){}setSendDiagnosticTraceCallback(e){}setRequestAuthTokenCallback(e){}setIsFeatureEnabledCallback(e){}setIsChangeGateEnabledCallback(e){}registerLocalWorkflow(e){}activateAnnotation(e){return null}updateAnnotationConfig(e){}releaseAnnotation(e){return null}submitCustomMessage(e){return null}submitLargeBinaryDataMessage(e){return null}requestBinaryDataForBlob(e){return null}submitOperation(e){}setSessionDataCallback(e){}setAnnotationResultCallback(e){}setAnnotationState(e){}setAnnotationMetadata(e){}setInitSessionCallback(e){}setSessionInitOverrideCallback(e){}setMessageBridge(e){}setMessageBridgeToALInterceptor(e){}forceReconnectSession(e){return null}setSessionCloseCallback(e){return null}setConnectCallback(e){return null}removeConnectionStateCallback(e){return!1}closeSession(){return null}startNewSession(){}authenticateInteractive(){return null}submit(e){}addEventHandler(e){}removeEventHandler(e){}registerSimpleLocalWorkflow(e){return null}registerSimpleRemoteWorkflow(e){return null}registerReduceWorkflow(e){return null}registerSchemas(e){return null}getAnnotations(e){return null}getAsyncClient(e){return null}}},51929:(e,t,n)=>{"use strict";var o;n.d(t,{f:()=>o}),function(e){e[e.NotAuthenticated=0]="NotAuthenticated",e[e.Pending=1]="Pending",e[e.Authenticated=2]="Authenticated",e[e.WacUserInfoAuthenticated=3]="WacUserInfoAuthenticated",e[e.TokenMissingInteractionRequired=4]="TokenMissingInteractionRequired"}(o||(o={}))},9622:(e,t,n)=>{"use strict";n.d(t,{Cs:()=>u,Td:()=>r,U8:()=>a,f8:()=>d,i2:()=>l,og:()=>i,tj:()=>s,wR:()=>c});var o=n(90687);class s{constructor(e){o.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SetClaimsChallengeCallbackMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_FireClaimsChallengeCallbackResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SetSeedingStatusChangeCallbackMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_FireSeedingStatusChangeCallbackResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_InteractiveAuthMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetAnnotationsResponseBridgeMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetHostBridgeSessionRequestMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class d{constructor(e){o.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetHostBridgeSessionResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()}},84166:(e,t,n)=>{"use strict";n.d(t,{$j:()=>k,B_:()=>N,D0:()=>F,F_:()=>h,Fz:()=>j,GA:()=>E,Gs:()=>H,HZ:()=>G,LQ:()=>m,Nn:()=>T,Ol:()=>I,PR:()=>W,PY:()=>_,QB:()=>s,Qq:()=>A,Re:()=>l,Sv:()=>z,Sy:()=>te,TV:()=>U,Tb:()=>x,VR:()=>R,Wx:()=>c,XE:()=>se,YK:()=>r,Yp:()=>a,ZH:()=>O,Zy:()=>v,_4:()=>P,_p:()=>d,ah:()=>B,dx:()=>$,eE:()=>f,eG:()=>Y,fZ:()=>D,fr:()=>q,g$:()=>Z,gy:()=>K,i:()=>i,iT:()=>re,iU:()=>Q,kd:()=>L,l0:()=>M,lZ:()=>oe,lj:()=>X,n4:()=>C,o5:()=>ne,p3:()=>u,pr:()=>b,ru:()=>p,ry:()=>y,uN:()=>g,vG:()=>J,w9:()=>S,wU:()=>ee,z_:()=>w,zk:()=>V});var o=n(90687);class s{constructor(e){o.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Message"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Response"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_StreamingResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_StreamingRequest"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ExecutionError"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetAnnotationsClientError"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetAnnotationsErrorInfo"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class d{constructor(e){o.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class h{constructor(e){o.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TimeoutErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_ErrorResponse","AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class p{constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_RateLimitErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_ErrorResponse","AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class f{constructor(e){o.h.assign(f,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class g{constructor(e){o.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class m{constructor(e){o.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionLongPollMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{constructor(e){o.h.assign(y,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionLongPollResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class v{constructor(e){o.h.assign(v,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionCloseReason"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[v.getTypeName()])}}v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class b{constructor(e){o.h.assign(b,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionSwapOnClose"}static getBaseTypes(){return["AugLoop_Session_Protocol_SessionCloseReason"]}static typeGuard(e){return o.h.matchesTypesFor(e,[b.getTypeName()])}}b.H_={T_:b.getTypeName(),B_:b.getBaseTypes()};class S{constructor(e){o.h.assign(S,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionCloseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[S.getTypeName()])}}S.H_={T_:S.getTypeName(),B_:S.getBaseTypes()};class w{constructor(e){o.h.assign(w,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_CacheDumpRequestMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[w.getTypeName()])}}w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class T{constructor(e){o.h.assign(T,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_CacheDumpRequestResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[T.getTypeName()])}}T.H_={T_:T.getTypeName(),B_:T.getBaseTypes()};class C{constructor(e){o.h.assign(C,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationActivationMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[C.getTypeName()])}}C.H_={T_:C.getTypeName(),B_:C.getBaseTypes()};class _{constructor(e){o.h.assign(_,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationActivationResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[_.getTypeName()])}}_.H_={T_:_.getTypeName(),B_:_.getBaseTypes()};class k{constructor(e){o.h.assign(k,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationResultStateMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[k.getTypeName()])}}k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()};class E{constructor(e){o.h.assign(E,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationReleaseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[E.getTypeName()])}}E.H_={T_:E.getTypeName(),B_:E.getBaseTypes()};class A{constructor(e){o.h.assign(A,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationReleaseResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[A.getTypeName()])}}A.H_={T_:A.getTypeName(),B_:A.getBaseTypes()};class I{constructor(e){o.h.assign(I,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[I.getTypeName()])}}I.H_={T_:I.getTypeName(),B_:I.getBaseTypes()};class P{constructor(e){o.h.assign(P,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[P.getTypeName()])}}P.H_={T_:P.getTypeName(),B_:P.getBaseTypes()};class M{constructor(e){o.h.assign(M,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_BatchedMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[M.getTypeName()])}}M.H_={T_:M.getTypeName(),B_:M.getBaseTypes()};class x{constructor(e){o.h.assign(x,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SyncMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[x.getTypeName()])}}x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()};class R{constructor(e){o.h.assign(R,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_MicroSyncMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[R.getTypeName()])}}R.H_={T_:R.getTypeName(),B_:R.getBaseTypes()};class D{constructor(e){o.h.assign(D,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SyncResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[D.getTypeName()])}}D.H_={T_:D.getTypeName(),B_:D.getBaseTypes()};class O{constructor(e){o.h.assign(O,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionDeleteMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[O.getTypeName()])}}O.H_={T_:O.getTypeName(),B_:O.getBaseTypes()};class N{constructor(e){o.h.assign(N,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationResultsMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SyncMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[N.getTypeName()])}}N.H_={T_:N.getTypeName(),B_:N.getBaseTypes()};class L{constructor(e){o.h.assign(L,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TokenProvisionMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[L.getTypeName()])}}L.H_={T_:L.getTypeName(),B_:L.getBaseTypes()};class F{constructor(e){o.h.assign(F,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TokenFailureMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[F.getTypeName()])}}F.H_={T_:F.getTypeName(),B_:F.getBaseTypes()};class B{constructor(e){o.h.assign(B,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TokenProvisionResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[B.getTypeName()])}}B.H_={T_:B.getTypeName(),B_:B.getBaseTypes()};class W{constructor(e){o.h.assign(W,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_KeepAlive"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[W.getTypeName()])}}W.H_={T_:W.getTypeName(),B_:W.getBaseTypes()};class U{constructor(e){o.h.assign(U,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowGraphInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[U.getTypeName()])}}U.H_={T_:U.getTypeName(),B_:U.getBaseTypes()};class G{constructor(e){o.h.assign(G,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowGraphInitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[G.getTypeName()])}}G.H_={T_:G.getTypeName(),B_:G.getBaseTypes()};class H{constructor(e){o.h.assign(H,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionCompleteMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SyncMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[H.getTypeName()])}}H.H_={T_:H.getTypeName(),B_:H.getBaseTypes()};class q{constructor(e){o.h.assign(q,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SeedingStatusChangeMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[q.getTypeName()])}}q.H_={T_:q.getTypeName(),B_:q.getBaseTypes()};class ${constructor(e){o.h.assign($,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitV2Message"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[$.getTypeName()])}}$.H_={T_:$.getTypeName(),B_:$.getBaseTypes()};class V{constructor(e){o.h.assign(V,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitV2Response"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[V.getTypeName()])}}V.H_={T_:V.getTypeName(),B_:V.getBaseTypes()};class z{constructor(e){o.h.assign(z,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[z.getTypeName()])}}z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()};class j{constructor(e){o.h.assign(j,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[j.getTypeName()])}}j.H_={T_:j.getTypeName(),B_:j.getBaseTypes()};class Q{constructor(e){o.h.assign(Q,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2CallbackMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[Q.getTypeName()])}}Q.H_={T_:Q.getTypeName(),B_:Q.getBaseTypes()};class J{constructor(e){o.h.assign(J,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_BridgeMessage"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[J.getTypeName()])}}J.H_={T_:J.getTypeName(),B_:J.getBaseTypes()};class K{constructor(e){o.h.assign(K,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionConnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[K.getTypeName()])}}K.H_={T_:K.getTypeName(),B_:K.getBaseTypes()};class Y{constructor(e){o.h.assign(Y,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionDisconnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[Y.getTypeName()])}}Y.H_={T_:Y.getTypeName(),B_:Y.getBaseTypes()};class X{constructor(e){o.h.assign(X,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionReconnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[X.getTypeName()])}}X.H_={T_:X.getTypeName(),B_:X.getBaseTypes()};class Z{constructor(e){o.h.assign(Z,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SubmittedCustomMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[Z.getTypeName()])}}Z.H_={T_:Z.getTypeName(),B_:Z.getBaseTypes()};class ee{constructor(e){o.h.assign(ee,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ServerAuthenticationStateChangeMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[ee.getTypeName()])}}ee.H_={T_:ee.getTypeName(),B_:ee.getBaseTypes()};class te{constructor(e){o.h.assign(te,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ClaimsChallengeMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[te.getTypeName()])}}te.H_={T_:te.getTypeName(),B_:te.getBaseTypes()};class ne{constructor(e){o.h.assign(ne,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_BlobUploadResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[ne.getTypeName()])}}ne.H_={T_:ne.getTypeName(),B_:ne.getBaseTypes()};class oe{constructor(e){o.h.assign(oe,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetPluginsMetadataMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[oe.getTypeName()])}}oe.H_={T_:oe.getTypeName(),B_:oe.getBaseTypes()};class se{constructor(e){o.h.assign(se,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetPluginsMetadataResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[se.getTypeName()])}}se.H_={T_:se.getTypeName(),B_:se.getBaseTypes()};class re{constructor(e){o.h.assign(re,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ExecutionCorrelatedClientResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[re.getTypeName()])}}re.H_={T_:re.getTypeName(),B_:re.getBaseTypes()}},9163:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AnnotationActivationMessage:()=>r.n4,AnnotationActivationResponse:()=>r.PY,AnnotationConfigUpdateMessage:()=>r.Ol,AnnotationConfigUpdateResponse:()=>r._4,AnnotationReleaseMessage:()=>r.GA,AnnotationReleaseResponse:()=>r.Qq,AnnotationResultState:()=>s.K7,AnnotationResultStateMessage:()=>r.$j,AnnotationResultsMessage:()=>r.B_,BatchedMessage:()=>r.l0,BlobUploadResponse:()=>r.o5,BridgeMessage:()=>r.vG,CacheDumpRequestMessage:()=>r.z_,CacheDumpRequestResponse:()=>r.Nn,ClaimsChallengeMessage:()=>r.Sy,ErrorResponse:()=>r._p,ErrorResponseCode:()=>s.xv,ExecutionCorrelatedClientResponse:()=>r.iT,ExecutionError:()=>r.Re,ExecutionErrorCode:()=>s.Qn,FireClaimsChallengeCallbackResponse:()=>a.Td,FireSeedingStatusChangeCallbackResponse:()=>a.U8,GetAnnotationsClientError:()=>r.Wx,GetAnnotationsClientErrorCode:()=>s.zy,GetAnnotationsErrorInfo:()=>r.p3,GetAnnotationsResponseBridgeMessage:()=>a.wR,GetHostBridgeSessionRequestMessage:()=>a.Cs,GetHostBridgeSessionResponse:()=>a.f8,GetPluginsMetadataMessage:()=>r.lZ,GetPluginsMetadataResponse:()=>r.XE,InteractiveAuthMessage:()=>a.i2,KeepAlive:()=>r.PR,Message:()=>r.QB,MessageEndpoint:()=>o.N0,MicroSyncMessage:()=>r.VR,OAuth2CallbackMessage:()=>r.iU,OAuth2InitMessage:()=>r.Sv,OAuth2InitResponse:()=>r.Fz,OAuth2InitV2Message:()=>r.dx,OAuth2InitV2Response:()=>r.zk,ProcessMessageErrorReason:()=>o.N2,RateLimitErrorResponse:()=>r.ru,Response:()=>r.YK,SeedingProgressCode:()=>s.e9,SeedingStatusChangeMessage:()=>r.fr,SendMessageErrorReason:()=>o.Ef,ServerAuthenticationState:()=>i.f,ServerAuthenticationStateChangeMessage:()=>r.wU,SessionCloseMessage:()=>r.w9,SessionCloseReason:()=>r.Zy,SessionConnectMessage:()=>r.gy,SessionDeleteMessage:()=>r.ZH,SessionDisconnectMessage:()=>r.eG,SessionInitMessage:()=>r.eE,SessionInitResponse:()=>r.uN,SessionLongPollMessage:()=>r.LQ,SessionLongPollMessageType:()=>s.PO,SessionLongPollResponse:()=>r.ry,SessionReconnectMessage:()=>r.lj,SessionSwapOnClose:()=>r.pr,SessionSwapReason:()=>s.ey,SetClaimsChallengeCallbackMessage:()=>a.tj,SetSeedingStatusChangeCallbackMessage:()=>a.og,StreamingRequest:()=>r.Yp,StreamingResponse:()=>r.i,SubmittedCustomMessage:()=>r.g$,SyncMessage:()=>r.Tb,SyncResponse:()=>r.fZ,TimeoutErrorResponse:()=>r.F_,TokenFailureMessage:()=>r.D0,TokenProvisionMessage:()=>r.kd,TokenProvisionResponse:()=>r.ah,WorkflowExecutionCompleteMessage:()=>r.Gs,WorkflowGraphInitMessage:()=>r.TV,WorkflowGraphInitResponse:()=>r.HZ,currentProtocolVersion:()=>s.mH,extractMessageNameFromTypeName:()=>o.L9});var o=n(25631),s=n(46331),r=n(84166),i=n(51929),a=n(9622)},25631:(e,t,n)=>{"use strict";n.d(t,{N0:()=>E,N2:()=>_,Ef:()=>C,L9:()=>k});var o,s,r,i={util:{},roots:{default:{}}},a=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.sessionHealthEventName="",e.prototype.source="",e.prototype.reason="",e.prototype.reasonDependency="",e.prototype.subReason="",e.prototype.impact="",e.prototype.success=!1,e.prototype.durationMs=0,e.prototype.count=0,e.prototype.message="",e.prototype.affectedWorkflows="",e.prototype.resourceId="",e.prototype.dimension0="",e.prototype.dimension1="",e.prototype.dimension2="",e.prototype.dimension3="",e.prototype.resultDescription="",e.prototype.resultSignature="",e.prototype.joinContextId="",e.prototype.userDataBoundaryType="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SessionHealthEvent"},e}()),l=n(75913);!function(e){e[e.Unknown=0]="Unknown",e[e.Core=1]="Core",e[e.Workflow=2]="Workflow",e[e.SessionExtension=3]="SessionExtension",e[e.Client=4]="Client",e[e.ClientRuntime=5]="ClientRuntime"}(o||(o={})),function(e){e[e.Unknown=0]="Unknown",e[e.Core=1]="Core",e[e.Workflow=2]="Workflow",e[e.SessionExtension=3]="SessionExtension",e[e.Client=4]="Client",e[e.Network=5]="Network",e[e.AugLoopDependency=6]="AugLoopDependency",e[e.WorkflowDependency=7]="WorkflowDependency",e[e.ClientRuntime=8]="ClientRuntime"}(s||(s={})),function(e){e[e.Unknown=0]="Unknown",e[e.None=1]="None",e[e.MissingInput=2]="MissingInput",e[e.MissingOutput=3]="MissingOutput"}(r||(r={}));class c extends a{constructor(e,t){var n,i;super({source:o[e.source],reason:s[e.reason],reasonDependency:e.reasonDependency,subReason:e.subReason,sessionHealthEventName:e.sessionHealthEventName,impact:r[e.impact],success:e.success,durationMs:null!==(n=e.durationMs)&&void 0!==n?n:0,count:"number"==typeof e.count?e.count:1,message:e.message,affectedWorkflows:(null!==(i=e.affectedWorkflows)&&void 0!==i?i:[]).join(","),resourceId:e.resourceId,dimension0:e.dimension0,dimension1:e.dimension1,dimension2:e.dimension2,dimension3:e.dimension3,cv:e.cv,resultSignature:e.resultSignature,resultDescription:e.resultDescription,joinContextId:e.joinContextId}),this.eventName="SessionHealth",this.aggregationEnabled=!1,t&&this.setClientMetadata(t),this.metricCount=e.metricCount,this.metricDuration=e.metricDuration}getMetrics(){const e={};return(void 0===this.metricCount||this.metricCount)&&(e[`${this.sessionHealthEventName}.CountV2`]={dimensionNames:()=>c.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.count}),(void 0===this.metricDuration||this.metricDuration)&&(e[`${this.sessionHealthEventName}.DurationMsV2`]={dimensionNames:()=>c.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.durationMs}),e}setClientMetadata(e){return e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,this.clientFlights=e.flights,this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientReleaseChannel=e.releaseChannel,this.clientReleaseFork=e.releaseFork,this.clientRuntimeVersion=e.runtimeVersion,this.clientSessionId=e.sessionId,this.clientDocSessionId=e.docSessionId,this.clientUserAgent=e.userAgent),this}setUserContext(e){return e&&(this.userId=e.puid||e.oid,this.userType=e.userType&&e.userType.toString(),this.userTenantId=e.tid),this}setReason(e){return this.reason=s[e],this}setSource(e){return this.source=o[e],this}setImpact(e){return this.impact=r[e],this}setAffectedWorkflows(e){return this.affectedWorkflows=(null!=e?e:[]).join(","),this}getAffectedWorkflows(){return this.affectedWorkflows.split(",")}enableAggregation(){return this.aggregationEnabled=!0,this}shouldBeAggregated(){return this.aggregationEnabled}start(){return this.startTime=(0,l.t)(),this}stop(){const e=(0,l.t)();return this.durationMs=Math.round(e-this.startTime),this}getDimensionValues(){var e;return[this.clientAppName,this.clientAppPlatform,this.clientAppVersion,this.success?"1":"0",`${this.reason}_${this.reasonDependency}`,this.impact,null!==(e=this.getAffectedWorkflows()[0])&&void 0!==e?e:"",this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}}c.dimensionNames=["ClientAppName","ClientAppPlatform","ClientAppVersion","Success","Reason","Impact","FirstAffectedWorkflow","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"];var u=n(59456),d=n(68279),h=n(90170);const p=new h.eU("disabledChangeGates",[]),f=(e,t,...n)=>{const o=-1===p.getValue().indexOf(e);return g(o,t,...n)},g=(e,t,...n)=>t?e?t(...n):void 0:e;var m,y=n(90687),v=n(46331),b=n(84166);class S{constructor(e){if(this.cache=new Map,this.options=e||{sweepInterval:100},null!=this.options.idleDurationMs&&this.options.idleDurationMs<=0)throw new Error("Idle duration must be positive");if(this.interval=this.options.sweepInterval||100,this.interval<=0)throw new Error("Sweep interval must be a positive number")}static setLogIntervalError(e){S.logIntervalError=e}put(e,t,n,o,s,r,i){if(null==n||n<=0)throw new Error("Cache timeout must be a positive number");(null==s||s<=0)&&(s=this.options.idleDurationMs);const a={value:t,lastUsed:s?Date.now():void 0,expire:n+Date.now(),idleDurationMs:s,expireCallback:o,expiringTriggerTime:r+Date.now(),expiringCallback:i};return this.cache.set(e,a),this.timeout||(this.timeout=setInterval(this.onInterval.bind(this),this.interval),this.timeout.unref&&this.timeout.unref()),t}del(e){if(this.options.delCallback){const t=this.cache.get(e);t&&this.options.delCallback(e,t.value)}const t=this.cache.delete(e);return 0===this.size()&&this.clear(),t}clear(){this.timeout&&(clearInterval(this.timeout),this.timeout=void 0),this.cache.clear()}get(e){let t=this.cache.get(e);if(t){if(this.options.idleDurationMs&&(t.lastUsed=Date.now()),t.expire<Date.now()&&(this.del(e),t.expireCallback&&t.expireCallback(e,t.value),t=this.cache.get(e),!t))return;return t.value}}keys(){return this.cache.keys()}forEach(e){this.cache.forEach(((t,n)=>{e(t.value,n)}))}size(){return this.cache.size}updateExpireTime(e,t){return!!(this.cache.has(e)&&t>=0)&&(this.cache.get(e).expire=t+Date.now(),!0)}onInterval(){const e=Date.now();this.cache.forEach(((t,n)=>{try{if(t.idleDurationMs&&t.lastUsed<e-t.idleDurationMs)return this.del(n),void(this.options.idleCallback&&this.options.idleCallback(n,t.value));t.expire<e&&(this.del(n),t.expireCallback&&t.expireCallback(n,t.value)),t.expiringTriggerTime<e&&t.expiringCallback&&(t.expiringCallback(n,t.value),t.expiringCallback=void 0)}catch(e){S.logIntervalError&&S.logIntervalError(e)}}))}}!function(e){e.InvalidType="invalid_type",e.InvalidEnum="invalid_enum",e.NumberMax="number_max",e.NumberMin="number_min",e.LengthMin="length_min",e.LengthMax="length_max",e.ItemsMax="items_max",e.ItemsMin="items_min",e.ItemsUnique="items_unique",e.PropertiesMax="properties_max",e.PropertiesMin="properties_min",e.Required="required",e.Custom="custom"}(m||(m={}));const w=new h.eU("processAndRejectMessageEndpointValidation",!1),T=new h.eU("messageValidationAllowList",[{code:m.Required,className:"",path:[],message:""},{code:m.InvalidType,className:"SchemaObjectHeader",path:["config"],message:"SchemaObjectHeader: Expected object, got undefined object for SchemaObjectHeaderValidator"},{code:m.InvalidType,className:"Item",path:["item","id"],message:'Required field "id" is wrong type'},{code:m.InvalidType,className:"Item",path:["ops","*","items","0","id"],message:'Required field "id" is wrong type'}]);var C,_;function k(e){const t=["AugLoop_Excel_Session_Protocol_","AugLoop_Powerpoint_Session_Protocol_","AugLoop_Session_Protocol_"];let n;for(const o of t)if(0===e.indexOf(o)){n=o;break}if(!n)return"MalformedMessageName";const o=e.indexOf("Message",e.length-7)===e.length-7;return e.slice(n.length,o?-7:void 0)}!function(e){e.ClientDisconnected="Client disconnected.",e.ClientClosed="Client closed",e.UnsupportedSyncMessage="SyncMessages with seq = -1 are not supported anymore.",e.UnexpectedSeedMessage="Unexpected seed message",e.SyncMessageUnsupportedBatch="SyncMessage with unsupported batching.",e.AnnotationTokenNotFound="Token not found",e.TooManyDeltaOperations="SyncMessage with too many delta operations",e.UnsupportedSyncMessageSeq0NonSeeding="SyncMessages with seq 0 are not supported in non seeding sequencer (SenderId)."}(C||(C={})),function(e){e.ProvisionTokenValidationError="Token provision message didn't pass token validation.",e.ProvisionTokenDecryptAndTransformError="Token provision message didn't pass token decrypt and transform."}(_||(_={}));class E{constructor(e){this.config=e,this.nextMessageId=1,this.pendingResponseCallbacks=new S({sweepInterval:5e3}),this.messageCallbacks=new Map,this.messageValidators=new Map,this.messageIdPrefix=e.messageIdPrefix,this.source="c"===e.messageIdPrefix?o.ClientRuntime:o.Core,this.stats={sendMessageCount:0,sendMessageClientDisconnectedErrors:0,sendMessageErrors:0,sendMessageDurationMsMax:0,processMessageCount:0,processMessageProvisionTokenErrors:0,processMessageErrors:0,processMessageDurationMsMax:0};const t=e=>e.map((e=>({code:(null==e?void 0:e.code)||"",className:(null==e?void 0:e.className)||"",path:(null==e?void 0:e.path)||[]}))),n=t(T.getDefaultValue()),s=t(T.getValue());T.getDefaultValue()===T.getValue()?this.messageValidationAllowListFull=n:this.messageValidationAllowListFull=[...n,...s.filter((e=>e.code))]}setClientMetadata(e){this.clientMetadata=e}setEgress(e){this.egress=e,this.config.resendPendingMessagesOnReconnect&&this.egress&&this.pendingResponseCallbacks.forEach(((e,t)=>{e.logOp.dimension1=(e.sendCount++).toString(),this.egress(e.message,(t=>this.onEgressError(t,e)))}))}ingress(e,t){b.YK.typeGuard(e)?(this.processResponse(e),t()):this.processMessage(e,t),b.w9.typeGuard(e)&&!e.reconnectAllowed&&this.clearAllPendingResponses()}sendMessage(e,t,n,i=0){var a,l;const d=new c({sessionHealthEventName:"SendMessage",source:this.source,reason:s.Client,impact:this.source===o.ClientRuntime?r.MissingInput:r.MissingOutput,success:!0,message:"",affectedWorkflows:["All"],cv:e.cv,resourceId:k(y.h.getTypeNameFor(e)),dimension0:i.toString()}).start().enableAggregation(),h=()=>{if(d.setClientMetadata(this.clientMetadata),d.success)u.tG.info(572836e3,u.nh.CoreDefault,d.stop());else{const e="ErrorWithoutPendingResponse"===d.resultSignature||"ResponseCallbackException"===d.resultSignature||"We called into done callback"!==d.message;d.message=JSON.stringify({errorNotPropagatedToDoneCallback:e}),u.tG.error(572836001,u.nh.CoreDefault,d.stop())}};f("PersistMessageId")?e.messageId=null!==(a=e.messageId)&&void 0!==a?a:`${this.messageIdPrefix}${this.nextMessageId++}`:e.messageId=`${this.messageIdPrefix}${this.nextMessageId++}`,b.l0.typeGuard(e)&&e.messages.forEach(((t,n)=>t.messageId=e.messageId+"."+n));const p=y.h.getTypeNameFor(e)===b.w9.getTypeName(),g={message:e,logOp:d,logEvent:h,callback:void 0,sendCount:1};if(!n&&!p){g.callback=(n,o)=>{var s;if(n?f("IgnoreUnsupportedMessageErrorForOldClientVersion")&&n.code===v.xv.UnsupportedMessage?(d.resultSignature="Success",d.resultDescription=`Ignore error for ${y.h.getTypeNameFor(e)} message ${e.messageId}${b.Tb.typeGuard(e)?`, seq ${e.seq}`:""}: ${n.error}`):(d.success=!1,d.resultSignature=n.error,d.resultDescription=`Error for ${y.h.getTypeNameFor(e)} message ${e.messageId}${b.Tb.typeGuard(e)?`, seq ${e.seq}`:""}: ${n.error}`):d.resultSignature="Success",t)try{d.message="We called into done callback",t(n,o)}catch(e){d.success=!1,d.resultSignature="ResponseCallbackException",d.resultDescription="Web"===(null===(s=this.clientMetadata)||void 0===s?void 0:s.appPlatform)?JSON.stringify({message:e.message,stack:e.stack}):JSON.stringify({message:e.message})}h(),this.updateSendMessageStats(d.success,d.durationMs,n?new Error(n.error):void 0)};const n=()=>{g.callback(new b.F_({code:v.xv.RequestTimeout,error:"Timeout waiting for response"}),void 0)};let o=this.config.responseTimeoutMs;if(b.LQ.typeGuard(e)){const t=e;o=t.longPollTimeoutHint>=15e3&&t.longPollTimeoutHint<=3e5?t.longPollTimeoutHint+5e3:12e4}else b.Yp.typeGuard(e)&&(o=null!==(l=e.maxDelayMs)&&void 0!==l?l:12e4);this.pendingResponseCallbacks.put(e.messageId,g,o,n)}this.egress&&this.egress(e,(e=>this.onEgressError(e,g)),i)}onEgressError(e,t){var n,o;if(e){const s=t.message,r=this.pendingResponseCallbacks.get(t.message.messageId);r?(this.pendingResponseCallbacks.del(s.messageId),r.callback(new b._p({messageId:s.messageId,code:v.xv.EgressError,error:e.message}))):b.w9.typeGuard(s)?(t.logOp.success=null!==(o=null===(n=e.message)||void 0===n?void 0:n.endsWith("Client disconnected."))&&void 0!==o&&o,t.logOp.resultSignature="ErrorSendingSessionCloseMessage",t.logOp.resultDescription=`Error for ${y.h.getTypeNameFor(s)} message ${s.messageId}: ${e.message}`,t.logEvent()):(t.logOp.success=!1,t.logOp.resultSignature="ErrorWithoutPendingResponse",t.logOp.resultDescription=`Error for ${y.h.getTypeNameFor(s)} message ${s.messageId}: ${e.message}`,t.logEvent())}}queryEgressCacheSize(){return this.pendingResponseCallbacks.size()}onMessage(e,t,n){this.messageCallbacks.set(e,t),n&&this.messageValidators.set(e,n)}onMessageAsync(e,t,n){this.messageCallbacks.set(e,((e,n)=>{return o=this,s=void 0,i=function*(){try{const o=yield t(e);b._p.typeGuard(o)?n(o,void 0):n(void 0,o)}catch(e){n(e)}},new((r=void 0)||(r=Promise))((function(e,t){function n(e){try{l(i.next(e))}catch(e){t(e)}}function a(e){try{l(i.throw(e))}catch(e){t(e)}}function l(t){var o;t.done?e(t.value):(o=t.value,o instanceof r?o:new r((function(e){e(o)}))).then(n,a)}l((i=i.apply(o,s||[])).next())}));var o,s,r,i})),n&&this.messageValidators.set(e,n)}getStats(){return this.stats}hasMessageCallback(e){return this.messageCallbacks.has(e)}cancelPendingResponseCallbacks(e){this.pendingResponseCallbacks.forEach(((t,n)=>{t&&(this.pendingResponseCallbacks.del(n),t.callback(new b._p({messageId:n,code:v.xv.Cancelled,error:`Cancelled. Reason: ${e}`})))}))}clearAllPendingResponses(){if(0==this.pendingResponseCallbacks.size())return;const e=new d.I({operationName:"PurgePendingResponses",resultDescription:this.pendingResponseCallbacks.size().toString(),success:!0});u.tG.info(572836002,u.nh.CoreDefault,e),this.pendingResponseCallbacks.clear()}processMessage(e,t){var n,i,a,l;const h=new c({sessionHealthEventName:"ProcessMessage",source:this.source,reason:s.Client,impact:this.source===o.ClientRuntime?r.MissingOutput:r.MissingInput,success:!0,message:"",affectedWorkflows:["All"],cv:e.cv}).start().enableAggregation(),p=()=>{if(h.setClientMetadata(this.clientMetadata),h.success)u.tG.info(572836003,u.nh.CoreDefault,h.stop());else{const e="UnsupportedMessage"===h.resourceId||"Timeout"===h.resultSignature||"OnResponseInvokedMoreThanOnce"===h.resultSignature||"MessageCallbackException"===h.resultSignature||"We called into messageCallback"!==h.message;h.message=JSON.stringify({errorHappenedOutsideRegisteredMessageCallback:e}),u.tG.error(572836032,u.nh.CoreDefault,h.stop())}},g=this.messageValidators.get(y.h.getTypeNameFor(e)),m=(null===(i=null===(n=this.clientMetadata)||void 0===n?void 0:n.userAgent)||void 0===i?void 0:i.startsWith("test-suite"))||(null===(l=null===(a=this.clientMetadata)||void 0===a?void 0:a.userAgent)||void 0===l?void 0:l.startsWith("e2e-test"));let S;if(f("enableMessageValidation")&&g&&!m){const t=new d.I({operationName:"MessageValidationFailure",resourceId:k(y.h.getTypeNameFor(e)),success:!1,resultDescription:""},{metricDuration:!0}).start(),n=g.validate(e);if(t.success=n.success,!n.success){const o=n.errors;let s=!0;for(const e of o){let t=!1;for(const n of this.messageValidationAllowListFull)if(e.code!==n.code||n.className||0!==n.path.length){if(e.code===n.code&&e.className===n.className&&e.path.length===n.path.length&&e.path.every(((e,t)=>e===n.path[t]||"*"===n.path[t]))){t=!0;break}}else t=!0;s=s&&t}s?t.dimension0="ValidationErrorAllowed":(t.dimension0="ValidationErrorNotAllowed",S=`Message type ${y.h.getTypeNameFor(e)} had a type validation error`),n.errors?(n.errors.length>0&&(t.dimension1=n.errors[0].code),t.setDataFields({errors:JSON.stringify(n.errors)}),t.resultDescription="List of error messages: "+n.errors.map((e=>e.message)).join(", ")):(t.setDataFields({errors:"No validation errors provided"}),t.resultDescription="Validation failed with no specific errors"),u.tG.info(504971855,u.nh.CoreDefault,t.stop())}}let T=this.messageCallbacks.get(y.h.getTypeNameFor(e));T?(h.resourceId=k(y.h.getTypeNameFor(e)),w.getValue()&&S&&(u.tG.error(504729920,u.nh.CoreDefault,`Rejecting message ${e.messageId} due to validation error`),T=(e,t)=>{t(new b._p({messageId:e.messageId,code:v.xv.MessageValidationError,error:S}))})):T=(e,t)=>{h.resourceId=k(y.h.getTypeNameFor(e)),"MalformedMessageName"!==h.resourceId&&(h.resourceId="UnsupportedMessage"),t(new b._p({messageId:e.messageId,code:v.xv.UnsupportedMessage,error:`Message type ${y.h.getTypeNameFor(e)} is not supported`}))};const C=(e,t)=>void 0!==t?JSON.stringify({message:e,stack:t}):e;let _=!1;const E=(n,o)=>{if(_){h.success=!1,h.resultSignature="OnResponseInvokedMoreThanOnce";const t=`Invoked onResponse for ${y.h.getTypeNameFor(e)} message ${e.messageId} more than once`;h.resultDescription=C(t)}else if(n){h.success=!1,h.resultSignature=n.error,void 0!==n.code&&(h.dimension0=v.xv[n.code]);const t=`Error for ${y.h.getTypeNameFor(e)} message ${e.messageId}: ${n.error}`;h.resultDescription=C(t)}else h.resultSignature="Success",h.resultDescription=C("");_=!0,p(),n&&!y.h.matchesTypesFor(n,[b._p.getTypeName()])&&(n=new b._p({error:"Internal Server Error"})),this.updateProcessMessageStats(h.success,h.durationMs,n?new Error(n.error):void 0),n?(n.messageId=e.messageId,t(n)):o?(o.messageId=e.messageId,t(void 0,o)):t()};try{h.message="We called into messageCallback",T(e,E)}catch(e){h.success=!1,h.resultSignature="MessageCallbackException",h.resultDescription=C(e.message,e.stack),p(),this.updateProcessMessageStats(!1,h.durationMs,e),t()}}processResponse(e){var t;const n=new d.I({operationName:"ProcessResponse"});if(n.success=!0,n.setClientMetadata(this.clientMetadata),n.start(),e.messageId){const t=this.pendingResponseCallbacks.get(e.messageId),o=null==t?void 0:t.callback;if(o){if(b.i.typeGuard(e)&&!e.finalResponse){const n=t.message.maxDelayMs;this.pendingResponseCallbacks.updateExpireTime(e.messageId,n)}else this.pendingResponseCallbacks.del(e.messageId);y.h.matchesTypesFor(e,[b._p.getTypeName()])?o(e):o(void 0,e)}else n.resultSignature="NoPendingMessage",n.resultDescription=`${e.messageId}`,n.success=!1}else n.resultSignature="NoMessageIdSetInResponse",b._p.typeGuard(e)?n.resultDescription=e.error:n.resultDescription="MessageId is not available",n.success=!1;"Production"!==(null===(t=this.clientMetadata)||void 0===t?void 0:t.releaseAudienceGroup)&&(n.resourceId=k(y.h.getTypeNameFor(e)),u.tG.info(572836034,u.nh.CoreDefault,n.stop()))}updateSendMessageStats(e,t,n){this.stats.sendMessageCount++,this.stats.sendMessageDurationMsMax=Math.max(t,this.stats.sendMessageDurationMsMax),e||n?e&&n&&u.tG.warn(572836036,u.nh.CoreDefault,"Succeeded send message provided error object."):u.tG.warn(572836035,u.nh.CoreDefault,"Failed send message did not provide error object."),e||(n&&n.message===C.ClientDisconnected?this.stats.sendMessageClientDisconnectedErrors++:this.stats.sendMessageErrors++)}updateProcessMessageStats(e,t,n){this.stats.processMessageCount++,this.stats.processMessageDurationMsMax=Math.max(t,this.stats.processMessageDurationMsMax),e||n?e&&n&&u.tG.warn(572836038,u.nh.CoreDefault,"Succeeded process message provided error object."):u.tG.warn(572836037,u.nh.CoreDefault,"Failed process message did not provide error object."),e||(n&&n.message===_.ProvisionTokenValidationError?this.stats.processMessageProvisionTokenErrors++:this.stats.processMessageErrors++)}}},46331:(e,t,n)=>{"use strict";n.d(t,{K7:()=>c,PO:()=>a,Qn:()=>s,e9:()=>u,ey:()=>l,mH:()=>o,xv:()=>i,zy:()=>r});const o=2;var s,r,i,a,l,c,u;!function(e){e[e.ServerError=0]="ServerError",e[e.WorkflowDisabled=100]="WorkflowDisabled",e[e.TokenNotReady=101]="TokenNotReady",e[e.FlightNotReady=102]="FlightNotReady",e[e.ContextNotReady=103]="ContextNotReady",e[e.WorkflowExcluded=104]="WorkflowExcluded",e[e.WorkflowExecutionTimeout=105]="WorkflowExecutionTimeout",e[e.LambdaExecutionError=106]="LambdaExecutionError",e[e.UnexpectedOutput=107]="UnexpectedOutput",e[e.FailedToFetchInputs=108]="FailedToFetchInputs",e[e.FailedToFetchRequestedContexts=109]="FailedToFetchRequestedContexts"}(s||(s={})),function(e){e[e.Unknown=0]="Unknown",e[e.InvalidRequest=1]="InvalidRequest",e[e.InvalidResponse=2]="InvalidResponse",e[e.RuntimeNotInitialized=3]="RuntimeNotInitialized",e[e.RequestCancelled=4]="RequestCancelled",e[e.ResponseReceivedAfterFinalResponse=5]="ResponseReceivedAfterFinalResponse"}(r||(r={})),function(e){e[e.Unknown=0]="Unknown",e[e.Found=302]="Found",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.RequestTimeout=408]="RequestTimeout",e[e.Conflict=409]="Conflict",e[e.Gone=410]="Gone",e[e.RequestEntityTooLarge=413]="RequestEntityTooLarge",e[e.UnsupportedMediaType=415]="UnsupportedMediaType",e[e.UnprocessableContent=422]="UnprocessableContent",e[e.TooManyRequests=429]="TooManyRequests",e[e.SocketDisconnect=499]="SocketDisconnect",e[e.InternalServerError=500]="InternalServerError",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout",e[e.UnsupportedMessage=1e3]="UnsupportedMessage",e[e.Cancelled=1001]="Cancelled",e[e.EgressError=1002]="EgressError",e[e.MessageValidationError=1003]="MessageValidationError",e[e.SyncMessageException=2e3]="SyncMessageException",e[e.SyncMessageUnsupported=2001]="SyncMessageUnsupported",e[e.SyncMessageUnexpectedSeed=2002]="SyncMessageUnexpectedSeed",e[e.SyncMessageUnsupportedBatch=2003]="SyncMessageUnsupportedBatch",e[e.SyncMessageQueueFull=2004]="SyncMessageQueueFull",e[e.SyncMessageTooLateOrDuplicate=2005]="SyncMessageTooLateOrDuplicate",e[e.SyncMessageGroupIdMismatch=2006]="SyncMessageGroupIdMismatch",e[e.SyncMessageGroupStop=2007]="SyncMessageGroupStop",e[e.SyncMessageLost=2008]="SyncMessageLost",e[e.SyncMessageUnprocessedDuplicate=2009]="SyncMessageUnprocessedDuplicate",e[e.SyncMessageSessionClosed=2010]="SyncMessageSessionClosed",e[e.SyncMessageAbandoned=2011]="SyncMessageAbandoned",e[e.SyncMessageTooManyDeltaOperations=2012]="SyncMessageTooManyDeltaOperations",e[e.SyncMessageSessionSizeLimitExceeded=2013]="SyncMessageSessionSizeLimitExceeded",e[e.TokenValidationError=2100]="TokenValidationError",e[e.TokenDecryptError=2101]="TokenDecryptError",e[e.TokenTypeError=2102]="TokenTypeError",e[e.TokenUserBlocked=2103]="TokenUserBlocked",e[e.AnnotationActivationInvalidType=2200]="AnnotationActivationInvalidType",e[e.AnnotationReleaseTokenNotFound=2300]="AnnotationReleaseTokenNotFound"}(i||(i={})),function(e){e[e.UnKnown=0]="UnKnown",e[e.Start=1]="Start",e[e.Regular=2]="Regular",e[e.CheckConnection=3]="CheckConnection",e[e.PostEgress=4]="PostEgress",e[e.TimeoutResend=5]="TimeoutResend",e[e.FailResend=6]="FailResend"}(a||(a={})),function(e){e[e.IdentityChange=0]="IdentityChange"}(l||(l={})),function(e){e[e.Idle=0]="Idle",e[e.Pending=1]="Pending"}(c||(c={})),function(e){e[e.NotStarted=0]="NotStarted",e[e.Started=1]="Started",e[e.Incomplete=2]="Incomplete",e[e.Finished=3]="Finished"}(u||(u={}))},90170:(e,t,n)=>{"use strict";n.d(t,{eU:()=>p});var o,s,r=n(59456),i=n(68279),a=n(92792),l=n.n(a);class c{constructor(){this.listeners=new Map,this.lastId=0}addListener(e){if(!e)throw new Error("No callback provided for data listener");return this.listeners.set(this.lastId,e),this.lastId++}removeListener(e){this.listeners.delete(e)}notifyListeners(e){this.listeners.forEach((t=>{t(e)}))}}!function(e){e.Add="Add",e.Remove="Remove",e.Set="Set",e.Delete="Delete"}(s||(s={}));class u{static applyECSPatchOperation(e,t){let n=!1;if("object"==typeof t||Array.isArray(t))switch(e.operation){case s.Add:case s.Remove:n=u.applyAddOrRemoveOperation(e.path,t,e.value,e.operation);break;case s.Set:n=u.applySetOperation(e.path,t,e.value);break;case s.Delete:n=u.applyDeleteOperation(e.path,t,e.value)}return n?r.tG.verbose(505956121,r.nh.CoreDefault,`PATCH operation succeeded for ${e.operation} on ${e.settingName} with path: ${e.path}.`):r.tG.error(505956122,r.nh.CoreDefault,`PATCH operation failed for ${e.operation} on ${e.settingName} with path: ${e.path}`),n}static applyAddOrRemoveOperation(e,t,n,o){let i=!1;try{let r=[];if("object"!=typeof t||Array.isArray(t)?Array.isArray(t)&&(r=t):r=e.reduce(((e,t)=>e&&e[t]),t),Array.isArray(r))if(o===s.Add)r.push(n),i=!0;else if(o===s.Remove){const e=r.indexOf(n);e>=0&&(r.splice(e,1),i=!0)}}catch(e){r.tG.info(505968832,r.nh.CoreDefault,`Exception thrown while applying operation type: ${o} for an array. Error: ${e}`),i=!1}return i}static applySetOperation(e,t,n){let o=!1;try{const s=e.slice(0,-1),r=e[e.length-1];let i={};"object"!=typeof t||Array.isArray(t)||(i=s.reduce(((e,t)=>e&&e[t]),t),"object"!=typeof i||Array.isArray(i)||(i[r]=n,o=!0))}catch(e){r.tG.info(505968802,r.nh.CoreDefault,`Exception thrown while applying set operation. Error: ${e}`),o=!1}return o}static applyDeleteOperation(e,t,n){let o=!1;try{let s={};"object"!=typeof t||Array.isArray(t)||(s=e.reduce(((e,t)=>e&&e[t]),t),"object"!=typeof s||Array.isArray(s)||"string"!=typeof n||s.hasOwnProperty(n)&&(delete s[n],o=!0))}catch(e){r.tG.info(505968801,r.nh.CoreDefault,`Exception thrown while applying delete operation. Error: ${e}`),o=!1}return o}}o=u,u.parseECSOperation=(e,t)=>{if(!t.hasOwnProperty("operationType")||!t.hasOwnProperty("path")||!t.hasOwnProperty("value"))throw new Error(`Invalid format for PATCH operation on setting: ${e}`);const n=t.operationType.toLowerCase(),s=o.convertToConfigPatchOperationType(n);return{settingName:e,path:t.path?t.path.split("."):[],operation:s,value:t.value}},u.convertToConfigPatchOperationType=e=>{switch(e){case"add":return s.Add;case"remove":return s.Remove;case"set":return s.Set;case"delete":return s.Delete;default:throw new Error(`Invalid operation type: ${e}`)}};var d=function(e,t,n,o){return new(n||(n=Promise))((function(s,r){function i(e){try{l(o.next(e))}catch(e){r(e)}}function a(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))};class h extends c{constructor(e){super(),this.name=e}static initEcsSettingsProvider(e){r.tG.info(505999498,r.nh.CoreDefault,"Initializing ECS settings provider."),h.ecsSettingsProvider=e}static enableEcsPatchConfig(e){h.ecsPatchConfigEnabled=e}static getInstance(e){let t=this.allSettings.get(e);if(!t){t=new h(e);const n=h.tryGetConfigProperty(h.currentConfig,e);n.success&&t.updateValue(n.value),this.allSettings.set(e,t)}return t}static getPatternInstance(e){let t=this.allPatternSettings.get(e);if(!t){t={regex:new RegExp(e),setting:new h(e)};const n=h.tryGetConfigPropertyByPattern(h.currentConfig,t.regex);t.setting.updateValue(n),this.allPatternSettings.set(e,t)}return t.setting}static setNewConfig(e){h.currentConfig=e,r.tG.info(572837966,r.nh.CoreDefault,`New config: ${JSON.stringify(e)}`),h.allSettings.forEach(((e,t)=>{const n=h.tryGetConfigProperty(h.currentConfig,t).value;e.updateValue(n)&&(r.tG.info(572837967,r.nh.CoreDefault,`Setting new value for ${t}: ${n instanceof Object?JSON.stringify(n):n}`),e.notifyListeners(n))})),h.allPatternSettings.forEach(((t,n)=>{const o=h.tryGetConfigPropertyByPattern(e,t.regex);t.setting.updateValue(o)&&(r.tG.info(508432774,r.nh.CoreDefault,`Setting new value for pattern ${n}: ${JSON.stringify(o)}`),t.setting.notifyListeners(o))}))}static tryGetConfigProperty(e,t){return e&&e.hasOwnProperty(t)?{success:!0,value:h.selectApplicableValue(e[t])}:{success:!1,value:void 0}}static tryGetConfigPropertyByPattern(e,t){const n=[];if(e){const o=Object.getOwnPropertyNames(e).filter((e=>t.test(e)));for(const t of o)n.push({name:t,value:h.selectApplicableValue(e[t])})}return n}static setGlobalFilter(e){h.globalFilter=e}static setLocalConfig(e){h.localConfig=e,r.tG.info(506053841,r.nh.CoreDefault,`Setting localConfig field in Setting class: ${JSON.stringify(h.localConfig)}`)}static clear(){h.currentConfig=void 0,h.localConfig=void 0,h.allSettings.clear(),h.allPatternSettings.clear(),h.ecsSettingsProvider=void 0}static selectApplicableValue(e){let t;if(e){const n=e.find((e=>!h.globalFilter||h.globalFilter(e)));n&&(t=n.value)}return t}getName(){return this.name}getValue(){if(function(){var e;return void 0!==globalThis.process&&"true"===(null===(e=globalThis.process.env)||void 0===e?void 0:e.VALIDATE_CORRECT_USAGE_OF_GET_VALUE)}()&&0===this.listeners.size){const e=new Error(`SettingInstance or ChangeGate is being used incorrectly. Make sure .getValue() or ChangeGate is called during runtime or there is a listener set up on the setting. For more info visit: ${h.troubleshootUrl}`);throw e.name="Incorrect usage of getValue()",e}return this.value}getValueAdvancedAsync(e){return d(this,void 0,void 0,(function*(){const t=new i.I({operationName:"ECSGetValueAsync"},{metricDuration:!0}).start();let n;try{const o=yield h.ecsSettingsProvider.getSettingValue(this.name,e);t.dimension0=o.userAuthenticated?"Authenticated":"Anonymous",t.success=!0;let s=o.value,r=o.ecsSection;return s||(s=h.tryGetConfigProperty(h.localConfig,this.name).value,s&&o.patchValue&&(s=h.applyPatchOperationOnSetting(this.name,s,o.patchValue),r=o.ecsPatchSection)),n=`Setting value for ${this.name} is ${JSON.stringify(s)}.\n Config IDs: ${JSON.stringify(r)}.`,s}catch(e){r.tG.error(505226379,r.nh.CoreDefault,`Exception thrown while getting setting value for ${this.name}. Error: ${e}\n Error stack trace: ${e.stack}`),t.success=!1;const o=h.tryGetConfigProperty(h.localConfig,this.name).value;return n=`Setting value for ${this.name} is ${JSON.stringify(o)}.`,o}finally{r.tG.info(506053839,r.nh.CoreDefault,t.stop()),r.tG.info(505821320,r.nh.CoreDefault,n)}}))}updateValue(e){return!l()(this.value,e)&&(r.tG.info(572837968,r.nh.CoreDefault,`Received new property value for ${this.getName()}:`,e),this.value=e,!0)}static applyPatchOperationsOnConfig(e){try{if(!h.ecsPatchConfigEnabled)return e;const t=this.tryGetConfigProperty(e,"patchOperations").value;if(!t||0===t.length)return e;const n=[];for(const[e,o]of Object.entries(t))try{n.push(u.parseECSOperation(e,o))}catch(t){r.tG.error(505734922,r.nh.CoreDefault,`Exception thrown while parsing ECS PATCH operation for setting: ${e}. Error: ${t}`);continue}const o=new Map;for(const t of n)if(null==e?void 0:e.hasOwnProperty(t.settingName)){const n=JSON.parse(JSON.stringify(e[t.settingName])),s=h.selectApplicableValue(n);u.applyECSPatchOperation(t,s)&&(o.set(t.settingName,s),e[t.settingName]=n)}if(o.size>0){const e={};o.forEach(((t,n)=>{e[n]=t})),r.tG.info(505788322,r.nh.CoreDefault,`Resulting settings after PATCHes were applied: ${JSON.stringify(e)}`)}return e}catch(t){return r.tG.error(505788321,r.nh.CoreDefault,`Exception thrown while applying ECS PATCH operations. Error: ${t}`),e}}static applyPatchOperationOnSetting(e,t,n){try{if(!h.ecsPatchConfigEnabled)return t;const o=JSON.parse(JSON.stringify(t)),s=n,r=u.parseECSOperation(e,s);return u.applyECSPatchOperation(r,o),o}catch(e){return r.tG.error(505788323,r.nh.CoreDefault,`Exception thrown while applying ECS PATCH operation on setting. Error: ${e}`),t}}}h.allSettings=new Map,h.allPatternSettings=new Map,h.ecsPatchConfigEnabled=!1,h.troubleshootUrl="https://eng.ms/docs/experiences-devices/opg/office-ai/augloop-ai-platform/augmentation-loop/documentation/server-workflow-tutorials/settings/troubleshoot";class p extends c{constructor(e,t){super(),this.listenerId=NaN,this.defaultValue=t,this.setting=h.getInstance(e)}getDefaultValue(){return this.defaultValue}addListener(e){return Number.isNaN(this.listenerId)&&(this.listenerId=this.setting.addListener((()=>{this.notifyListeners(this.getValue())}))),super.addListener(e)}removeListener(e){super.removeListener(e),0!==this.listeners.size||Number.isNaN(this.listenerId)||(this.setting.removeListener(this.listenerId),this.listenerId=NaN)}getValue(){const e=this.setting.getValue();return void 0===e?this.defaultValue:e}getValueAdvancedAsync(e){return d(this,void 0,void 0,(function*(){const t=yield this.setting.getValueAdvancedAsync(e);return void 0===t?this.defaultValue:t}))}}},80993:(e,t,n)=>{"use strict";var o;n.d(t,{r:()=>o}),function(e){e[e.Undefined=0]="Undefined",e[e.Created=10]="Created",e[e.Sent=20]="Sent",e[e.Duplicated=30]="Duplicated",e[e.Seen=40]="Seen",e[e.Tried=50]="Tried",e[e.Kept=60]="Kept",e[e.Rejected=70]="Rejected"}(o||(o={}))},23008:(e,t,n)=>{"use strict";n.d(t,{DA:()=>a,Iz:()=>i,SQ:()=>l,YH:()=>s,h_:()=>r});var o=n(90687);class s{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Core_Annotation"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_BinaryClassificationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Core_StreamAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Core_ExecutionCorrelatedAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Core_ClaimsChallengeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()}},26025:(e,t,n)=>{"use strict";n.d(t,{W8:()=>i,ay:()=>r,k$:()=>s,tX:()=>l,u$:()=>a});var o=n(90687);class s{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Core_Apology"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_SecondaryApology"}static getBaseTypes(){return["AugLoop_Core_Apology","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Core_WorkflowActivationFailureDetails"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Core_AuthTokenIsMissingDetails"}static getBaseTypes(){return["AugLoop_Core_WorkflowActivationFailureDetails"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Core_NotActivatedWorkflowApology"}static getBaseTypes(){return["AugLoop_Core_Apology","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()}},90268:(e,t,n)=>{"use strict";n.d(t,{A5:()=>m,B9:()=>r,GH:()=>w,I:()=>i,Vm:()=>f,XP:()=>u,Xr:()=>l,Z5:()=>g,Zw:()=>p,fZ:()=>d,g0:()=>S,hK:()=>b,hW:()=>c,mX:()=>y,n4:()=>h,sT:()=>s,vg:()=>a,xU:()=>v});var o=n(90687);class s{constructor(e){o.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Core_ItemDelta"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_ItemChangesDelta"}static getBaseTypes(){return["AugLoop_Core_ItemDelta"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Core_Operation"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Core_OperationWithSiblingContext"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Core_AddOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Core_UpdateAnnotationMetaDataOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class d{constructor(e){o.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Core_UpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class h{constructor(e){o.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Core_DeleteOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class p{constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Core_PurgeOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class f{constructor(e){o.h.assign(f,this,e)}static getTypeName(){return"AugLoop_Core_PurgeSubtreeExceptTypesOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class g{constructor(e){o.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Core_PurgeByTypesOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class m{constructor(e){o.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Core_FocusOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{constructor(e){o.h.assign(y,this,e)}static getTypeName(){return"AugLoop_Core_VisibilityOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class v{constructor(e){o.h.assign(v,this,e)}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[v.getTypeName()])}}v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class b{constructor(e){o.h.assign(b,this,e)}static getTypeName(){return"AugLoop_Core_MicroSyncOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[b.getTypeName()])}}b.H_={T_:b.getTypeName(),B_:b.getBaseTypes()};class S{constructor(e){o.h.assign(S,this,e)}static getTypeName(){return"AugLoop_Signals_SignalOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[S.getTypeName()])}}S.H_={T_:S.getTypeName(),B_:S.getBaseTypes()};class w{constructor(e){o.h.assign(w,this,e)}static getTypeName(){return"AugLoop_Core_CancelSignalTriggeredWorkflowExecutionOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[w.getTypeName()])}}w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()}},90687:(e,t,n)=>{"use strict";n.d(t,{h:()=>o});class o{constructor(e){o.assign(o,this,e)}static getTypeName(){return"AugLoop_Core_SchemaObject"}static getBaseTypes(){return[]}static getTypeNameFor(e){return e&&e.H_?e.H_.T_:void 0}static getBaseTypesFor(e){return e&&e.H_&&e.H_.B_&&Array.isArray(e.H_.B_)?e.H_.B_:[]}static getAllTypesFor(e){const t=o.getTypeNameFor(e);return t?[t,...o.getBaseTypesFor(e)]:[]}static matchesTypesFor(e,t){if(!Array.isArray(t)||0===t.length)return!0;const n=o.getTypeNameFor(e),s=o.getBaseTypesFor(e);for(const e of t){if(e===n)return!0;if(s.indexOf(e)>=0)return!0}return!1}static assign(e,t,n){if(n)for(const e of Object.keys(n))t[e]=n[e];return t.H_=e.H_,t}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()}},85555:(e,t,n)=>{"use strict";n.d(t,{HN:()=>s,M_:()=>r,WJ:()=>i});var o=n(90687);class s{constructor(e){o.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Signals_Signal"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_DirtyAreaSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Core_DirtyDocumentSignal"}static getBaseTypes(){return["AugLoop_Core_DirtyAreaSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},7703:(e,t,n)=>{"use strict";n.d(t,{I3:()=>u,LX:()=>d,Nn:()=>l,QG:()=>b,SB:()=>y,W1:()=>g,YQ:()=>r,hD:()=>m,hw:()=>s,iS:()=>a,sD:()=>p,u7:()=>v,wX:()=>h,yI:()=>i,yo:()=>c,zB:()=>f});var o=n(90687);class s{constructor(e){o.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Core_BlobContainer"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_Blob"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Core_Binary"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Core_TileGroup"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Core_Session"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Core_Document"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Core_SubDocument"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class d{constructor(e){o.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Core_GridCell"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class h{constructor(e){o.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Core_GridNeighborhoodContext"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class p{constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Core_ItemFilter"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class f{constructor(e){o.h.assign(f,this,e)}static getTypeName(){return"AugLoop_Core_DynamicContext"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class g{constructor(e){o.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Core_ContextHolder"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class m{constructor(e){o.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Core_UserContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(e){return o.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{constructor(e){o.h.assign(y,this,e)}static getTypeName(){return"AugLoop_Core_TenantContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(e){return o.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class v{constructor(e){o.h.assign(v,this,e)}static getTypeName(){return"AugLoop_Core_EventsHolder"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[v.getTypeName()])}}v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class b{constructor(e){o.h.assign(b,this,e)}static getTypeName(){return"AugLoop_Core_UserCommandsHolder"}static getBaseTypes(){return["AugLoop_Core_EventsHolder"]}static typeGuard(e){return o.h.matchesTypesFor(e,[b.getTypeName()])}}b.H_={T_:b.getTypeName(),B_:b.getBaseTypes()}},2088:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AddOperation:()=>y.Xr,Annotation:()=>p.YH,AnnotationState:()=>l.r,Apology:()=>S.k$,AuthTokenIsMissingDetails:()=>S.u$,Binary:()=>b.yI,BinaryClassificationAnnotation:()=>p.h_,Blob:()=>b.YQ,BlobContainer:()=>b.hw,BlobRefType:()=>h.J1,CancelSignalTriggeredWorkflowExecutionOperation:()=>y.GH,ClaimsChallengeAnnotation:()=>p.SQ,ContextHolder:()=>b.W1,CopilotLicenseType:()=>o,DeleteOperation:()=>y.n4,DeltaUpdateOperation:()=>y.xU,DirtyAreaSignal:()=>v.M_,DirtyDocumentSignal:()=>v.WJ,Document:()=>b.yo,DynamicContext:()=>b.zB,EntryPoint:()=>s,Event:()=>g,EventsHolder:()=>b.u7,ExecutionCorrelatedAnnotation:()=>p.DA,FocusOperation:()=>y.A5,GridCell:()=>b.LX,GridConstants:()=>h.u5,GridNeighborhoodContext:()=>b.wX,ItemChanges:()=>i,ItemChangesDelta:()=>y.B9,ItemDelta:()=>y.sT,ItemFilter:()=>b.sD,ItemOperation:()=>r,MicroSyncOperation:()=>y.hK,MoveOperation:()=>y.hW,NotActivatedWorkflowApology:()=>S.tX,OpenType:()=>h.h6,Operation:()=>y.I,OperationErrorCode:()=>a,OperationWithSiblingContext:()=>y.vg,PurgeByTypesOperation:()=>y.Z5,PurgeOperation:()=>y.Zw,PurgeSubtreeExceptTypesOperation:()=>y.Vm,Scenario:()=>d,SchemaObject:()=>f.h,SecondaryApology:()=>S.ay,Session:()=>b.Nn,Signal:()=>v.HN,SignalOperation:()=>y.g0,StreamAnnotation:()=>p.Iz,SubDocument:()=>b.I3,TenantContextHolder:()=>b.SB,TileGroup:()=>b.iS,UpdateAnnotationMetaDataOperation:()=>y.XP,UpdateOperation:()=>y.fZ,UserCommand:()=>m,UserCommandsHolder:()=>b.QG,UserContextHolder:()=>b.hD,VisibilityOperation:()=>y.mX,WorkflowActivationFailureDetails:()=>S.W8,WorkflowExecutionErrorCode:()=>c,WorkflowNotActivatedReasonCode:()=>u,ecsMetadataBlockHeight:()=>h.Xo,ecsMetadataBlockWidth:()=>h.KY});var o,s,r,i,a,l=n(80993);!function(e){e[e.Unknown=0]="Unknown",e[e.CopilotInM365=1]="CopilotInM365",e[e.CopilotPro=2]="CopilotPro",e[e.CopilotEnterprise=3]="CopilotEnterprise"}(o||(o={})),function(e){e.Unknown="Unknown",e.Canvas="Canvas",e.CopilotChat="CopilotChat",e.Test="Test"}(s||(s={})),function(e){e[e.None=0]="None",e[e.Added=1]="Added",e[e.Updated=2]="Updated",e[e.Deleted=3]="Deleted"}(r||(r={})),function(e){e[e.ContentChanged=0]="ContentChanged",e[e.ContentWasEmpty=1]="ContentWasEmpty",e[e.FormattingChanged=2]="FormattingChanged",e[e.ContentWasInsideOfTheTable=3]="ContentWasInsideOfTheTable"}(i||(i={})),function(e){e[e.AddOfZeroElements=0]="AddOfZeroElements",e[e.AddOfItemsWithExtraOrMissingIds=1]="AddOfItemsWithExtraOrMissingIds",e[e.AddOfItemWithUndefinedId=2]="AddOfItemWithUndefinedId",e[e.AddOfUndefinedItem=3]="AddOfUndefinedItem",e[e.AddOfItemsWithDuplicateIds=4]="AddOfItemsWithDuplicateIds",e[e.SetHeadToNonExistingItem=5]="SetHeadToNonExistingItem",e[e.DeleteOfNonExistingItem=6]="DeleteOfNonExistingItem",e[e.UpdateOfNonExistentItem=7]="UpdateOfNonExistentItem",e[e.UpdateOfStubbedItem=8]="UpdateOfStubbedItem",e[e.MoveOfNonExistentItem=9]="MoveOfNonExistentItem",e[e.UpdateMetaDataOfNonAnnotationType=10]="UpdateMetaDataOfNonAnnotationType",e[e.SequentialyInvertedUpdate=11]="SequentialyInvertedUpdate",e[e.MoveToTheSamePath=12]="MoveToTheSamePath",e[e.UnknownOperation=13]="UnknownOperation",e[e.DeltaOfNonExistingItem=100]="DeltaOfNonExistingItem"}(a||(a={}));var c,u,d,h=n(55730);!function(e){e[e.LambdaExecutionUnhandledError=0]="LambdaExecutionUnhandledError",e[e.LambdaExecutionError=1]="LambdaExecutionError",e[e.WorkflowExecutionTimeout=2]="WorkflowExecutionTimeout",e[e.NetworkError=3]="NetworkError",e[e.SignalNotGotToExecution=4]="SignalNotGotToExecution",e[e.RequestTruncated=5]="RequestTruncated",e[e.WorkflowWrongAnnotationType=6]="WorkflowWrongAnnotationType",e[e.SequenceOutOfOrder=7]="SequenceOutOfOrder",e[e.WorkflowExecutionThrottled=8]="WorkflowExecutionThrottled",e[e.WorkflowExecutionCancelled=9]="WorkflowExecutionCancelled",e[e.NetworkTimeoutOrWorkflowIsBusy=10]="NetworkTimeoutOrWorkflowIsBusy",e[e.RequiredTokenNotAvailable=11]="RequiredTokenNotAvailable",e[e.InvalidInputQuantityForSingleItemWorkflow=12]="InvalidInputQuantityForSingleItemWorkflow",e[e.ExceededRequestSizeLimit=13]="ExceededRequestSizeLimit",e[e.UnknownAnnotationParent=14]="UnknownAnnotationParent",e[e.AnnotationsNotArray=15]="AnnotationsNotArray",e[e.UnexpectedOutput=16]="UnexpectedOutput",e[e.MixedOutput=17]="MixedOutput",e[e.OutputIsNotAnnotation=18]="OutputIsNotAnnotation",e[e.UnexpectedError=19]="UnexpectedError",e[e.WorkflowNotActivated=20]="WorkflowNotActivated"}(c||(c={})),function(e){e[e.Unknown=0]="Unknown",e[e.AuthTokenIsMissing=1]="AuthTokenIsMissing",e[e.UserContextIsMissing=2]="UserContextIsMissing",e[e.SeedingNotCompleted=3]="SeedingNotCompleted"}(u||(u={})),function(e){e.Unknown="Unknown",e.Testing="Testing",e.CopilotSummary="Copilot Summary",e.CopilotCompose="Copilot Compose",e.Rewrite="Copilot Rewrite",e.ChatQnA="Copilot Chat Question & Answer",e.CIQ="Context IQ",e.Editor="Editor",e.Handoff="Handoff",e.ReadAloud="Read Aloud"}(d||(d={}));var p=n(23008),f=n(90687);class g{constructor(e){f.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Core_Event"}static getBaseTypes(){return[]}static typeGuard(e){return f.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class m{constructor(e){f.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Core_UserCommand"}static getBaseTypes(){return["AugLoop_Core_Event"]}static typeGuard(e){return f.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};var y=n(90268),v=n(85555),b=n(7703),S=n(26025)},55730:(e,t,n)=>{"use strict";n.d(t,{J1:()=>r,KY:()=>s,Xo:()=>o,h6:()=>i,u5:()=>a});const o=512,s=32;var r,i;!function(e){e[e.None=0]="None",e[e.HttpsGetDownloadUrl=1]="HttpsGetDownloadUrl",e[e.AlCodedLocation=2]="AlCodedLocation",e[e.Token=3]="Token",e[e.SpeAlCodedLocation=4]="SpeAlCodedLocation"}(r||(r={})),function(e){e[e.NewDocument=0]="NewDocument",e[e.EditDocument=1]="EditDocument",e[e.ViewOnlyDocument=2]="ViewOnlyDocument"}(i||(i={}));class a{}a.lowerIndexBound=1,a.maxNumberOfRows=1048576,a.maxNumberOfColumns=16384,a.firstColumnName="A",a.lastColumnName="XFD"},35859:(e,t,n)=>{"use strict";var o,s,r,i,a,l;n.d(t,{Ih:()=>o,bt:()=>s,hO:()=>i,pL:()=>r,uR:()=>a,wk:()=>l}),function(e){e.Persistent="Persistent",e.Discardable="Discardable"}(o||(o={})),function(e){e.NONE="none",e.BLANK="blankDocument",e.PARAGRAPH="paragraph",e.LIST="list",e.TABLE="table",e.WHATCANISAY="whatCanISay"}(s||(s={})),function(e){e.Final="Final",e.Fragment="Fragment",e.Hypothesis="Hypothesis"}(r||(r={})),function(e){e.Paragraph="paragraph",e.Sentence="sentence",e.Character="character",e.Word="word",e.That="that",e.This="this",e.Table="table",e.Row="row",e.Column="column",e.Cell="cell",e.Page="page",e.Bullet="bullet",e.To="to",e.Bcc="bcc",e.Cc="cc",e.Subject="subject",e.EmailBody="emailBody",e.Field="field",e.All="all"}(i||(i={})),function(e){e.Next="next",e.Last="last",e.Previous="previous",e.Current="current",e.Left="left",e.Right="right",e.Above="above",e.Below="below",e.Start="start",e.End="end",e.Up="up",e.Down="down",e.Before="before",e.After="after",e.Beginning="start"}(a||(a={})),function(e){e.Play="play",e.Pause="pause",e.Resume="resume"}(l||(l={}))},72514:(e,t,n)=>{"use strict";var o,s,r,i,a,l;n.d(t,{$O:()=>r,El:()=>a,Y3:()=>o,o2:()=>s,sP:()=>l,wM:()=>i}),function(e){e.UNKNOWN="Unknown",e.CONNECTION_RETRY="ConnectionRetry",e.CONNECTION_RETRY_FAILURE="ErrorConnectionRetryFailure",e.SPEECH_HANDLER_WS_FAILURE="ErrorSpeechHandlerWebSocketFailure",e.PROTOBUF_DESERIALIZATION_FAILURE="ErrorProtobufDeserializationFailure",e.EXPLICITLY_DISABLED="ExplicitlyDisabled",e.SPEECH_RECOGNITION_CANCELED="ErrorSpeechRecognitionCanceled"}(o||(o={})),function(e){e.INTERMITTENT="Intermittent",e.FINAL="Final"}(s||(s={})),function(e){e.NO_DICTATION="NoDictation",e.NO_COMMANDING="NoCommanding",e.NO_TOKEN="NoPfaToken"}(r||(r={})),function(e){e.version1="1",e.version2="2"}(i||(i={})),function(e){e[e.NoMatch=0]="NoMatch"}(a||(a={})),function(e){e.INTERNAL_ERROR="INTERNAL_ERROR",e.UNSUPPORTED_FILE_FORMAT="UNSUPPORTED_FILE_FORMAT",e.UPLOADING="UPLOADING",e.PROCESSING="PROCESSING",e.DELETED="DELETED",e.FILE_NOT_EXIST="FILE_NOT_EXIST",e.FILE_DECODE_ERROR="FILE_DECODE_ERROR",e.REQUEST_TIMEOUT_ERROR="REQUEST_TIMEOUT_ERROR"}(l||(l={}))},3316:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var o=function(){function e(e){this.mergeDictationSettings(e)}return e.prototype.mergeDictationSettings=function(e){var t=this;Object.keys(e).forEach((function(n){t[n]=e[n]}))},e}(),s=function(){function e(){}return Object.defineProperty(e,"dictationSettings",{get:function(){if(e._instance)return e._instance;throw new Error("Dictation Settings not initialized")},set:function(t){e._instance?e._instance.mergeDictationSettings(t):e._instance=new o(t)},enumerable:!1,configurable:!0}),e}()},69382:(e,t,n)=>{"use strict";n.d(t,{Cd:()=>d,LT:()=>a,VJ:()=>r,dn:()=>u,mZ:()=>s,oS:()=>i,pn:()=>l,z4:()=>h,zc:()=>c});var o=n(90687),s=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_BaseVoiceCommandResult"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),r=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_VoiceCommandResultV2"},e.getBaseTypes=function(){return["AugLoop_Voice_BaseVoiceCommandResult","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),i=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_VoiceCommandInternalResult"},e.getBaseTypes=function(){return["AugLoop_Voice_BaseVoiceCommandResult","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),a=function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_VoiceCommandResultsInternalSignal"},e.getBaseTypes=function(){return["AugLoop_Signals_Signal"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),l=function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_VoiceCommandSuggestionInternalSignal"},e.getBaseTypes=function(){return["AugLoop_Signals_Signal"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),c=function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_VoiceDictationSessionInitiatedSignal"},e.getBaseTypes=function(){return["AugLoop_Signals_Signal"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),u=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_BaseVoiceCommandSuggestion"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),d=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_VoiceCommandSuggestion"},e.getBaseTypes=function(){return["AugLoop_Voice_BaseVoiceCommandSuggestion","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),h=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_VoiceCommandSuggestionResult"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()},76483:(e,t,n)=>{"use strict";n.d(t,{Al:()=>u,D_:()=>l,KI:()=>h,Pm:()=>a,U1:()=>d,ZF:()=>r,_K:()=>c,lM:()=>i,mh:()=>s});var o=n(90687),s=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_SpeechToTextFinalResult"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),r=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_SpeechToTextPartialResult"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),i=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_SpeechErrorEvent"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),a=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_VoiceCommandRequest"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),l=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_SpeechSessionEvent"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),c=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_SpeechQualityEvent"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),u=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_VoiceLatencyOutput"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),d=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_BatchTranscriptionResult"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),h=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_RehearsalRealTimeResult"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()},15372:(e,t,n)=>{"use strict";n.d(t,{IQ:()=>r,Qu:()=>l,VR:()=>a,jP:()=>i,nO:()=>s});var o=n(90687),s=function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_VoiceBlobContent"},e.getBaseTypes=function(){return["AugLoop_Core_Blob"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),r=function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_VoiceBlobTile"},e.getBaseTypes=function(){return["AugLoop_Core_Binary"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),i=function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_VoiceTile"},e.getBaseTypes=function(){return["AugLoop_Core_Binary"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),a=function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_VoiceLatencyInput"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),l=function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_BatchTranscriptionConversation"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()},71711:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AudioMode:()=>h.wk,BaseVoiceCommandResult:()=>p.mZ,BaseVoiceCommandSuggestion:()=>p.dn,BatchTranscriptionConversation:()=>u.Qu,BatchTranscriptionErrorCode:()=>s.sP,BatchTranscriptionResult:()=>a.U1,BatchWorkflowStage:()=>o.Cu,ClientApp:()=>o.jr,CommandSuggestionContextType:()=>h.bt,CommandSuggestionDisplayType:()=>h.Ih,DictationEventsType:()=>d.Ff,DictationSettingsManager:()=>r.A,IEventName:()=>o.$O,ISpeechError:()=>o.IZ,QualityStatusCode:()=>o.ZE,RehearsalRealTimeResult:()=>a.KI,SelectionType:()=>h.hO,SelectionWhich:()=>h.uR,SpeechErrorEvent:()=>a.lM,SpeechErrorEventCode:()=>s.Y3,SpeechErrorEventImpact:()=>s.$O,SpeechErrorEventState:()=>s.o2,SpeechQualityEvent:()=>a._K,SpeechSessionEvent:()=>a.D_,SpeechSessionEventIds:()=>d.P_,SpeechToTextFinalResult:()=>a.mh,SpeechToTextPartialResult:()=>a.ZF,SpeechToTextProfile:()=>i.A,TraceLevel:()=>o.kp,TranscriberType:()=>i.y,UtteranceRecognitionType:()=>h.pL,VoiceBlobContent:()=>u.nO,VoiceBlobTile:()=>u.IQ,VoiceCommandError:()=>s.El,VoiceCommandInternalResult:()=>p.oS,VoiceCommandRequest:()=>a.Pm,VoiceCommandResultV2:()=>p.VJ,VoiceCommandResultsInternalSignal:()=>p.LT,VoiceCommandSuggestion:()=>p.Cd,VoiceCommandSuggestionInternalSignal:()=>p.pn,VoiceCommandSuggestionResult:()=>p.z4,VoiceDictationSessionInitiatedSignal:()=>p.zc,VoiceLatencyInput:()=>u.VR,VoiceLatencyOutput:()=>a.Al,VoiceOperation:()=>c,VoiceResponseVersion:()=>s.wM,VoiceTile:()=>u.jP,WordVoiceCommandIds:()=>d.oJ,WordVoiceCommandValueKeys:()=>d.n4,internalCommandIds:()=>d.XH});var o=n(57144),s=n(72514),r=n(3316),i=n(90913),a=n(76483),l=n(90687),c=function(){function e(t){l.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_VoiceOperation"},e.getBaseTypes=function(){return["AugLoop_Core_Operation"]},e.typeGuard=function(t){return l.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),u=n(15372),d=n(21965),h=n(35859),p=n(69382)},57144:(e,t,n)=>{"use strict";var o,s,r,i,a,l,c;n.d(t,{$O:()=>a,Cu:()=>s,IZ:()=>i,ZE:()=>l,jr:()=>r,kp:()=>o}),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(o||(o={})),function(e){e.AnalyzeAudio="AnalyzeAudio",e.GetBatchResult="GetBatchResult"}(s||(s={})),function(e){e[e.PowerPoint=0]="PowerPoint",e[e.Word=1]="Word",e[e.OneNote=2]="OneNote",e[e.Outlook=3]="Outlook",e[e.Unknown=4]="Unknown",e[e.LinkedIn=5]="LinkedIn",e[e.Flipgrid=6]="Flipgrid",e[e.OfficeMobie=7]="OfficeMobie",e[e.OfficeSuite=8]="OfficeSuite",e[e.Teams=9]="Teams"}(r||(r={})),function(e){e.ErrorNone="ErrorNone",e.ErrorInvalidSubscriptionFromConfig="ErrorInvalidSubscriptionFromConfig",e.ErrorInvalidRegionFromConfig="ErrorInvalidRegionFromConfig",e.ErrorAddSessionFailure="ErrorAddSessionFailure",e.ErrorCreateSpeechSessionBadRequest="ErrorCreateSpeechSessionBadRequest",e.ErrorSpeechHandlerWebSocketFailure="ErrorSpeechHandlerWebSocketFailure",e.ErrorInvalidMessage="ErrorInvalidMessage",e.ErrorWaitAudioTimeout="ErrorWaitAudioTimeout",e.ErrorInitialSilenceTimeout="ErrorInitialSilenceTimeout",e.ErrorInitialBabbleTimeout="ErrorInitialBabbleTimeout",e.ErrorProtobufDeserializationFailure="ErrorProtobufDeserializationFailure",e.ErrorSpeechRecognitionFailure="ErrorSpeechRecognitionFailure",e.ErrorTranslationFailure="ErrorTranslationFailure",e.ErrorFailedToGetSupportedTextLanguages="ErrorFailedToGetSupportedTextLanguages",e.ErrorCustomEndpointTimeout="ErrorCustomEndpointTimeout",e.ErrorAudioAbortError="ErrorAudioAbortError",e.ErrorAudioNotAllowedError="ErrorAudioNotAllowedError",e.ErrorAudioNotFoundError="ErrorAudioNotFoundError",e.ErrorAudioNotReadableError="ErrorAudioNotReadableError",e.ErrorAudioOverconstrainedError="ErrorAudioOverconstrainedError",e.ErrorAudioSecurityError="ErrorAudioSecurityError",e.ErrorAudioTypeError="ErrorAudioTypeError",e.ErrorAudioSetupFailure="ErrorAudioSetupFailure",e.ErrorAudioCaptureStalePermission="ErrorAudioCaptureStalePermission",e.ErrorConnectionRetryFailure="ErrorConnectionRetryFailure",e.ErrorWebcamSamplingUnsupportedSpeechMode="ErrorWebcamSamplingUnsupportedSpeechMode",e.ErrorWebcamSetupFailure="ErrorWebcamSetupFailure",e.ErrorWebcamNotFoundError="ErrorWebcamNotFoundError",e.ErrorMultipleWebcamsFound="ErrorMultipleWebcamsFound",e.ErrorMaxConnectionRetryFailureInSession="ErrorMaxConnectionRetryFailureInSession",e.ErrorUnknown="ErrorUnknown"}(i||(i={})),function(e){e.RehearsalDashboardUpdate="RehearsalDashboardUpdate",e.MediaEvent="MediaEvent",e.QualityStatusUpdate="QualityStatusUpdate",e.ConnectionRetry="ConnectionRetry"}(a||(a={})),function(e){e[e.None=0]="None",e[e.Listening=1]="Listening",e[e.Warning_CannotHearYou=2]="Warning_CannotHearYou",e[e.Warning_BackgroundNoise=3]="Warning_BackgroundNoise",e[e.Warning_TooLoud=4]="Warning_TooLoud",e[e.Warning_TooQuiet=5]="Warning_TooQuiet",e[e.Warning_WeakConnection=6]="Warning_WeakConnection",e[e.Warning_SlowConnection=7]="Warning_SlowConnection",e[e.Warning_UnstableConnection=8]="Warning_UnstableConnection",e[e.Warning_ServiceIssue=9]="Warning_ServiceIssue",e[e.Error_CannotHearYou=10]="Error_CannotHearYou",e[e.Error_BackgroundNoise=11]="Error_BackgroundNoise",e[e.Error_TooLoud=12]="Error_TooLoud",e[e.Error_TooQuiet=13]="Error_TooQuiet",e[e.Error_WeakConnection=14]="Error_WeakConnection",e[e.Error_SlowConnection=15]="Error_SlowConnection",e[e.Error_UnstableConnection=16]="Error_UnstableConnection",e[e.Error_ServiceIssue=17]="Error_ServiceIssue"}(l||(l={})),function(e){e.Closed="Closed",e.Closing="Closing",e.Connecting="Connecting",e.Open="Open"}(c||(c={}))},90913:(e,t,n)=>{"use strict";var o,s;n.d(t,{A:()=>o,y:()=>s}),function(e){e.Dictation="Dictation",e.Transcription="Transcription",e.ConversationTranscription="ConversationTranscription",e.Rehearsal="Rehearsal",e.Subtitle="Subtitle",e.AdHocRehearsal="AdHocRehearsal"}(o||(o={})),function(e){e.Ovfd="Ovfd",e.Cts="Cts",e.Fast="Fast"}(s||(s={}))},21965:(e,t,n)=>{"use strict";var o;n.d(t,{Ff:()=>i,P_:()=>r,XH:()=>a,n4:()=>s,oJ:()=>o}),function(e){e.Bold="Word.Editing.Bold",e.CenterJustify="Word.Editing.CenterJustify",e.CreateBulletList="Word.Editing.CreateBulletList",e.CreateNumberedList="Word.Editing.CreateNumberedList",e.Delete="Word.Editing.Delete",e.Deselect="Word.Editing.Deselect",e.Exit="Command.Exit",e.ExitList="Word.Editing.ExitList",e.FullJustify="Word.Editing.FullJustify",e.Highlight="Word.Editing.Highlight",e.SetFont="Word.Editing.SetFont",e.InsertText="Word.Editing.InsertText",e.InsertBullet="Word.Editing.InsertBullet",e.InsertComment="Word.Editing.InsertComment",e.InsertEmoji="Word.Editing.InsertEmoji",e.InsertTable="Word.Editing.Table.Insert",e.DeleteTable="Word.Editing.Table.Delete",e.NavigateTable="Word.Editing.Table.Navigate",e.Navigation="Word.Editing.Navigation",e.InsertSpace="Word.Editing.InsertSpace",e.Italics="Word.Editing.Italics",e.LeftJustify="Word.Editing.LeftJustify",e.NewLine="Word.Editing.NewLine",e.NextBullet="Word.Editing.NextBullet",e.NextLine="Word.Editing.NextLine",e.Pause="Command.Pause",e.Paste="Word.Editing.Paste",e.ReadBack="Word.Editing.ReadBack",e.Redo="Word.Editing.Redo",e.RightJustify="Word.Editing.RightJustify",e.RemoveBold="Word.Editing.RemoveBold",e.RemoveItalics="Word.Editing.RemoveItalics",e.RemoveUnderline="Word.Editing.RemoveUnderline",e.RemoveHighlight="Word.Editing.RemoveHighlight",e.RemoveSuperscript="Word.Editing.RemoveSuperscript",e.RemoveStrikeThrough="Word.Editing.RemoveStrikeThrough",e.RemoveSubscript="Word.Editing.RemoveSubscript",e.RemoveFormatting="Word.Editing.RemoveFormatting",e.Quote="Word.Editing.Quote",e.Select="Word.Editing.Select",e.Superscript="Word.Editing.Superscript",e.Subscript="Word.Editing.Subscript",e.StrikeThrough="Word.Editing.StrikeThrough",e.ShowHelp="Command.ShowHelp",e.ShowCommands="Command.ShowCommand",e.Undo="Word.Editing.Undo",e.Underline="Word.Editing.Underline",e.IncreaseIndent="Word.Editing.IncreaseIndent",e.DecreaseIndent="Word.Editing.DecreaseIndent",e.Backspace="Word.Editing.Backspace",e.VoiceCommand="Command.VoiceCommand",e.Type="Command.Type",e.ShrinkFont="Word.Editing.ShrinkFont",e.GrowFont="Word.Editing.GrowFont",e.AllCaps="Word.Editing.AllCaps",e.SentenceCase="Word.Editing.SentenceCase",e.LowerCase="Word.Editing.LowerCase",e.Tab="Word.Editing.Tab",e.ZoomOut="Word.View.ZoomOut",e.ZoomIn="Word.View.ZoomIn",e.ScrollUp="Word.View.ScrollUp",e.ScrollDown="Word.View.ScrollDown",e.ShowOutline="Word.View.ShowOutline",e.PageBreak="Word.Editing.PageBreak",e.ResumeDictation="Word.Editing.ResumeDictation",e.Correction="Word.Editing.Correction",e.Style="Word.Editing.Style",e.CorrectionOption="Word.Editing.CorrectionOption",e.SpellOut="Word.Editing.SpellOut",e.ShowSuggestions="Word.Editing.ShowSuggestions",e.Send="Outlook.Send",e.Cancel="Outlook.Cancel",e.Yes="Outlook.Yes",e.AddRecipient="Outlook.AddRecipient",e.AtMention="Outlook.AtMention",e.FieldEdit="Outlook.FieldEdit",e.MoonshotAbout="Annotation.Document.About",e.MoonshotReadFromBeginning="Annotation.Document.FromBeginning",e.MoonshotKeyPoints="Annotation.Document.KeyPoints",e.MoonshotOutline="Annotation.Document.Outline",e.MoonshotReadInFull="Annotation.Document.ReadInFull",e.MoonshotSummarize="Annotation.Document.Summary",e.MoonshotMicrophoneOff="Audio.MicrophoneOff",e.MoonshotPause="Audio.Pause",e.MoonshotPlay="Audio.Play",e.MoonshotReplay="Audio.Replay",e.MoonshotSlowDown="Audio.SlowDown",e.MoonshotSpeedUp="Audio.SpeedUp",e.MoonshotReadSection="Document.Action.ReadSection",e.MoonshotRepeat="Document.Action.Repeat",e.MoonshotReview="Document.Action.Review",e.MoonshotDocumentAge="Document.Metadata.Age",e.MoonshotDocumentAuthor="Document.Metadata.Author",e.MoonshotDocumentHits="Document.Metadata.Hits",e.MoonshotDocumentLength="Document.Metadata.Length",e.MoonshotDocumentPreview="Document.Metadata.Preview",e.MoonshotDocumentTitle="Document.Metadata.Title",e.MoonshotNo="General.No",e.MoonshotYes="General.Yes",e.MoonshotIntro="intro",e.MoonshotNextDocument="Navigate.Document.Next",e.MoonshotPreviousDocument="Navigate.Document.Previous",e.ExcelIntent="ExcelIntent",e.InternalReadBack="Internal.Word.Editing.ReadBack",e.NoOp="NoOp"}(o||(o={}));var s,r,i,a=new Set([o.InternalReadBack]);!function(e){e.TableColumns="Word.Editing.InsertTable.TableColumns",e.TableRows="Word.Editing.InsertTable.TableRows",e.SelectionType="Word.Editing.ActOnSelection.SelectionType"}(s||(s={})),function(e){e.SpeechRecognitionStarted="SpeechRecognitionStarted",e.SpeechRecognitionStopped="SpeechRecognitionStopped",e.SpeechSessionStarted="SpeechSessionStarted",e.SpeechSessionStopped="SpeechSessionStopped"}(r||(r={})),function(e){e.MicrophoneError="ErrorAudioCaptureAsync"}(i||(i={}))},14101:(e,t,n)=>{"use strict";n.d(t,{fi:()=>r,PS:()=>a,J4:()=>i,e7:()=>l,F4:()=>g,H$:()=>f,vk:()=>C,xe:()=>m,H7:()=>w,Om:()=>u,Jq:()=>c,Yz:()=>S,QW:()=>b,Ee:()=>v,tF:()=>h,QM:()=>d,yw:()=>y,ZJ:()=>p});var o=n(37135);const s={MillisecondsInOneDay:864e5,MillisecondsIn1Sec:1e3,MillisecondsIn1Min:6e4,MillisecondsIn30Mins:18e5,MillisecondsIn1Hour:36e5,MinutesInOneDay:1440,MinutesInOneHour:60,DaysInOneWeek:7,MonthInOneYear:12};function r(e,t){var n=new Date(e.getTime());return n.setDate(n.getDate()+t),n}function i(e,t){return r(e,t*s.DaysInOneWeek)}function a(e,t){var n=new Date(e.getTime()),o=n.getMonth()+t;return n.setMonth(o),n.getMonth()!==(o%s.MonthInOneYear+s.MonthInOneYear)%s.MonthInOneYear&&(n=r(n,-n.getDate())),n}function l(e,t){var n=new Date(e.getTime());return n.setFullYear(e.getFullYear()+t),n.getMonth()!==(e.getMonth()%s.MonthInOneYear+s.MonthInOneYear)%s.MonthInOneYear&&(n=r(n,-n.getDate())),n}function c(e){return new Date(e.getFullYear(),e.getMonth(),1,0,0,0,0)}function u(e){return new Date(e.getFullYear(),e.getMonth()+1,0,0,0,0,0)}function d(e){return new Date(e.getFullYear(),0,1,0,0,0,0)}function h(e){return new Date(e.getFullYear()+1,0,0,0,0,0,0)}function p(e,t){return a(e,t-e.getMonth())}function f(e,t){return!e&&!t||!(!e||!t)&&e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}function g(e,t){return C(e)-C(t)}function m(e,t,n,i,l){void 0===l&&(l=1);var c,u=new Array,d=null;switch(i||(i=[o.ob.Monday,o.ob.Tuesday,o.ob.Wednesday,o.ob.Thursday,o.ob.Friday]),l=Math.max(l,1),t){case o.ci.Day:d=r(c=T(e),l);break;case o.ci.Week:case o.ci.WorkWeek:d=r(c=S(T(e),n),s.DaysInOneWeek);break;case o.ci.Month:d=a(c=new Date(e.getFullYear(),e.getMonth(),1),1);break;default:throw new Error("Unexpected object: "+t)}var h=c;do{(t!==o.ci.WorkWeek||-1!==i.indexOf(h.getDay()))&&u.push(h),h=r(h,1)}while(!f(h,d));return u}function y(e,t){for(var n=0,o=t;n<o.length;n++)if(f(e,o[n]))return!0;return!1}function v(e,t,n,r){var i=r.getFullYear(),a=r.getMonth(),l=1,c=new Date(i,a,l),u=l+(t+s.DaysInOneWeek-1)-function(e,t){return e!==o.ob.Sunday&&t<e?t+s.DaysInOneWeek:t}(t,c.getDay()),d=new Date(i,a,u);l=d.getDate();for(var h=[],p=0;p<e;p++)h.push(b(d,t,n)),l+=s.DaysInOneWeek,d=new Date(i,a,l);return h}function b(e,t,n){switch(n){case o.zX.FirstFullWeek:return _(e,t,s.DaysInOneWeek);case o.zX.FirstFourDayWeek:return _(e,t,4);default:return function(e,t){var n=k(e)-1,o=(e.getDay()-n%s.DaysInOneWeek-t+2*s.DaysInOneWeek)%s.DaysInOneWeek;return Math.floor((n+o)/s.DaysInOneWeek+1)}(e,t)}}function S(e,t){var n=t-e.getDay();return n>0&&(n-=s.DaysInOneWeek),r(e,n)}function w(e,t){var n=(t-1>=0?t-1:s.DaysInOneWeek-1)-e.getDay();return n<0&&(n+=s.DaysInOneWeek),r(e,n)}function T(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())}function C(e){return e.getDate()+(e.getMonth()<<5)+(e.getFullYear()<<9)}function _(e,t,n){var r=k(e)-1,i=e.getDay()-r%s.DaysInOneWeek,a=k(new Date(e.getFullYear()-1,o.Ph.December,31))-1,l=(t-i+2*s.DaysInOneWeek)%s.DaysInOneWeek;0!==l&&l>=n&&(l-=s.DaysInOneWeek);var c=r-l;return c<0&&(0!=(l=(t-(i-=a%s.DaysInOneWeek)+2*s.DaysInOneWeek)%s.DaysInOneWeek)&&l+1>=n&&(l-=s.DaysInOneWeek),c=a-l),Math.floor(c/s.DaysInOneWeek+1)}function k(e){for(var t=e.getMonth(),n=e.getFullYear(),o=0,s=0;s<t;s++)o+=E(s+1,n);return o+e.getDate()}function E(e,t){return new Date(t,e,0).getDate()}},37135:(e,t,n)=>{"use strict";var o,s,r,i;n.d(t,{Ph:()=>s,ci:()=>i,f9:()=>a,ob:()=>o,zX:()=>r}),function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday"}(o||(o={})),function(e){e[e.January=0]="January",e[e.February=1]="February",e[e.March=2]="March",e[e.April=3]="April",e[e.May=4]="May",e[e.June=5]="June",e[e.July=6]="July",e[e.August=7]="August",e[e.September=8]="September",e[e.October=9]="October",e[e.November=10]="November",e[e.December=11]="December"}(s||(s={})),function(e){e[e.FirstDay=0]="FirstDay",e[e.FirstFullWeek=1]="FirstFullWeek",e[e.FirstFourDayWeek=2]="FirstFourDayWeek"}(r||(r={})),function(e){e[e.Day=0]="Day",e[e.Week=1]="Week",e[e.Month=2]="Month",e[e.WorkWeek=3]="WorkWeek"}(i||(i={}));var a=7},41602:(e,t,n)=>{"use strict";n.d(t,{s:()=>s});var o=n(93483);function s(e,t,n){void 0===n&&(n=!0);var s=!1;if(e&&t)if(n)if(e===t)s=!0;else for(s=!1;t;){var r=(0,o.P)(t);if(r===e){s=!0;break}t=r}else e.contains&&(s=e.contains(t));return s}},60552:(e,t,n)=>{"use strict";n.d(t,{m:()=>s});var o=n(88948);function s(e,t){var n=(0,o.w)(e,(function(e){return e.hasAttribute(t)}));return n&&n.getAttribute(t)}},88948:(e,t,n)=>{"use strict";n.d(t,{w:()=>s});var o=n(93483);function s(e,t){return e&&e!==document.body?t(e)?e:s((0,o.P)(e),t):null}},93483:(e,t,n)=>{"use strict";n.d(t,{P:()=>s});var o=n(72148);function s(e,t){return void 0===t&&(t=!0),e&&(t&&(0,o.c)(e)||e.parentNode&&e.parentNode)}},72148:(e,t,n)=>{"use strict";n.d(t,{c:()=>s});var o=n(80566);function s(e){var t;return e&&(0,o.q)(e)&&(t=e._virtual.parent),t}},80566:(e,t,n)=>{"use strict";function o(e){return e&&!!e._virtual}n.d(t,{q:()=>o})},15846:(e,t,n)=>{"use strict";n.d(t,{s:()=>r});var o=n(88948),s=n(7821);function r(e,t){var n=(0,o.w)(e,(function(e){return t===e||e.hasAttribute(s.r)}));return null!==n&&n.hasAttribute(s.r)}},7821:(e,t,n)=>{"use strict";n.d(t,{V:()=>s,r:()=>o});var o="data-portal-element";function s(e){e.setAttribute(o,"true")}},97672:(e,t,n)=>{"use strict";function o(e,t){var n=e,o=t;n._virtual||(n._virtual={children:[]});var s=n._virtual.parent;if(s&&s!==t){var r=s._virtual.children.indexOf(n);r>-1&&s._virtual.children.splice(r,1)}n._virtual.parent=o||void 0,o&&(o._virtual||(o._virtual={children:[]}),o._virtual.children.push(n))}n.d(t,{g:()=>o})},73494:(e,t,n)=>{"use strict";n.d(t,{R:()=>N});var o,s=n(98670),r=n(30538),i=n(16536),a=n(84461),l=n(16829),c=n(77588),u=n(93483),d=n(73413),h=n(41914),p=n(66320),f=n(91177),g=n(19559),m=n(35407),y=n(76539),v=n(41602),b=n(58207),S=n(15846),w=n(50950),T=n(12977),C="data-is-focusable",_="data-focuszone-id",k="tabindex",E="data-no-vertical-wrap",A="data-no-horizontal-wrap",I=999999999,P=-999999999;function M(e,t){var n,o,s,r,i,a,l;"function"==typeof MouseEvent?l=new MouseEvent("click",{ctrlKey:null===(n=t)||void 0===n?void 0:n.ctrlKey,metaKey:null===(o=t)||void 0===o?void 0:o.metaKey,shiftKey:null===(s=t)||void 0===s?void 0:s.shiftKey,altKey:null===(r=t)||void 0===r?void 0:r.altKey,bubbles:null===(i=t)||void 0===i?void 0:i.bubbles,cancelable:null===(a=t)||void 0===a?void 0:a.cancelable}):(l=document.createEvent("MouseEvents")).initMouseEvent("click",!!t&&t.bubbles,!!t&&t.cancelable,window,0,0,0,0,0,!!t&&t.ctrlKey,!!t&&t.altKey,!!t&&t.shiftKey,!!t&&t.metaKey,0,null),e.dispatchEvent(l)}var x={},R=new Set,D=["text","number","password","email","tel","url","search"],O=!1,N=function(e){function t(t){var n=e.call(this,t)||this;return n._root=r.createRef(),n._mergedRef=(0,l.K)(),n._onFocus=function(e){if(!n._portalContainsElement(e.target)){var t,o=n.props,s=o.onActiveElementChanged,r=o.doNotAllowFocusEventToPropagate,i=o.stopFocusPropagation,a=o.onFocusNotification,l=o.onFocus,d=o.shouldFocusInnerElementWhenReceivedFocus,h=o.defaultTabbableElement,p=n._isImmediateDescendantOfZone(e.target);if(p)t=e.target;else for(var f=e.target;f&&f!==n._root.current;){if((0,c.S0)(f)&&n._isImmediateDescendantOfZone(f)){t=f;break}f=(0,u.P)(f,O)}if(d&&e.target===n._root.current){var g=h&&"function"==typeof h&&h(n._root.current);g&&(0,c.S0)(g)?(t=g,g.focus()):(n.focus(!0),n._activeElement&&(t=null))}var m=!n._activeElement;t&&t!==n._activeElement&&((p||m)&&n._setFocusAlignment(t,!0,!0),n._activeElement=t,m&&n._updateTabIndexes()),s&&s(n._activeElement,e),(i||r)&&e.stopPropagation(),l?l(e):a&&a()}},n._onBlur=function(){n._setParkedFocus(!1)},n._onMouseDown=function(e){if(!n._portalContainsElement(e.target)&&!n.props.disabled){for(var t=e.target,o=[];t&&t!==n._root.current;)o.push(t),t=(0,u.P)(t,O);for(;o.length&&((t=o.pop())&&(0,c.S0)(t)&&n._setActiveElement(t,!0),!(0,c.HC)(t)););}},n._onKeyDown=function(e,t){if(!n._portalContainsElement(e.target)){var o=n.props,s=o.direction,r=o.disabled,i=o.isInnerZoneKeystroke,a=o.pagingSupportDisabled,l=o.shouldEnterInnerZone;if(!(r||(n.props.onKeyDown&&n.props.onKeyDown(e),e.isDefaultPrevented()||n._getDocument().activeElement===n._root.current&&n._isInnerZone))){if((l&&l(e)||i&&i(e))&&n._isImmediateDescendantOfZone(e.target)){var u=n._getFirstInnerZone();if(u){if(!u.focus(!0))return}else{if(!(0,c.Z5)(e.target))return;if(!n.focusElement((0,c.eX)(e.target,e.target.firstChild,!0)))return}}else{if(e.altKey)return;switch(e.which){case d.c.space:if(n._tryInvokeClickForFocusable(e.target,e))break;return;case d.c.left:if(s!==T.E.vertical&&(n._preventDefaultWhenHandled(e),n._moveFocusLeft(t)))break;return;case d.c.right:if(s!==T.E.vertical&&(n._preventDefaultWhenHandled(e),n._moveFocusRight(t)))break;return;case d.c.up:if(s!==T.E.horizontal&&(n._preventDefaultWhenHandled(e),n._moveFocusUp()))break;return;case d.c.down:if(s!==T.E.horizontal&&(n._preventDefaultWhenHandled(e),n._moveFocusDown()))break;return;case d.c.pageDown:if(!a&&n._moveFocusPaging(!0))break;return;case d.c.pageUp:if(!a&&n._moveFocusPaging(!1))break;return;case d.c.tab:if(n.props.allowTabKey||n.props.handleTabKey===T.l.all||n.props.handleTabKey===T.l.inputOnly&&n._isElementInput(e.target)){var p=!1;if(n._processingTabKey=!0,p=s!==T.E.vertical&&n._shouldWrapFocus(n._activeElement,A)?((0,h.jI)(t)?!e.shiftKey:e.shiftKey)?n._moveFocusLeft(t):n._moveFocusRight(t):e.shiftKey?n._moveFocusUp():n._moveFocusDown(),n._processingTabKey=!1,p)break;n.props.shouldResetActiveElementWhenTabFromZone&&(n._activeElement=null)}return;case d.c.home:if(n._isContentEditableElement(e.target)||n._isElementInput(e.target)&&!n._shouldInputLoseFocus(e.target,!1))return!1;var f=n._root.current&&n._root.current.firstChild;if(n._root.current&&f&&n.focusElement((0,c.eX)(n._root.current,f,!0)))break;return;case d.c.end:if(n._isContentEditableElement(e.target)||n._isElementInput(e.target)&&!n._shouldInputLoseFocus(e.target,!0))return!1;var g=n._root.current&&n._root.current.lastChild;if(n._root.current&&n.focusElement((0,c.yv)(n._root.current,g,!0,!0,!0)))break;return;case d.c.enter:if(n._tryInvokeClickForFocusable(e.target,e))break;return;default:return}}e.preventDefault(),e.stopPropagation()}}},n._getHorizontalDistanceFromCenter=function(e,t,o){var s=n._focusAlignment.left||n._focusAlignment.x||0,r=Math.floor(o.top),i=Math.floor(t.bottom),a=Math.floor(o.bottom),l=Math.floor(t.top);return e&&r>i||!e&&a<l?s>=o.left&&s<=o.left+o.width?0:Math.abs(o.left+o.width/2-s):n._shouldWrapFocus(n._activeElement,E)?I:P},(0,p.f)(n),n._id=(0,f.O)("FocusZone"),n._focusAlignment={left:0,top:0},n._processingTabKey=!1,n}return(0,s.C6)(t,e),t.getOuterZones=function(){return R.size},t._onKeyDownCapture=function(e){e.which===d.c.tab&&R.forEach((function(e){return e._updateTabIndexes()}))},t.prototype.componentDidMount=function(){var e=this._root.current;if(x[this._id]=this,e){this._windowElement=(0,g.z)(e);for(var n=(0,u.P)(e,O);n&&n!==this._getDocument().body&&1===n.nodeType;){if((0,c.HC)(n)){this._isInnerZone=!0;break}n=(0,u.P)(n,O)}this._isInnerZone||(R.add(this),this._windowElement&&1===R.size&&this._windowElement.addEventListener("keydown",t._onKeyDownCapture,!0)),this._root.current&&this._root.current.addEventListener("blur",this._onBlur,!0),this._updateTabIndexes(),this.props.defaultTabbableElement&&"string"==typeof this.props.defaultTabbableElement?this._activeElement=this._getDocument().querySelector(this.props.defaultTabbableElement):this.props.defaultActiveElement&&(this._activeElement=this._getDocument().querySelector(this.props.defaultActiveElement)),this.props.shouldFocusOnMount&&this.focus()}},t.prototype.componentDidUpdate=function(){var e=this._root.current,t=this._getDocument();if(t&&this._lastIndexPath&&(t.activeElement===t.body||null===t.activeElement||!this.props.preventFocusRestoration&&t.activeElement===e)){var n=(0,c.nA)(e,this._lastIndexPath);n?(this._setActiveElement(n,!0),n.focus(),this._setParkedFocus(!1)):this._setParkedFocus(!0)}},t.prototype.componentWillUnmount=function(){delete x[this._id],this._isInnerZone||(R.delete(this),this._windowElement&&0===R.size&&this._windowElement.removeEventListener("keydown",t._onKeyDownCapture,!0)),this._root.current&&this._root.current.removeEventListener("blur",this._onBlur,!0),this._activeElement=null,this._defaultFocusElement=null},t.prototype.render=function(){var e=this,t=this.props,n=t.as,l=t.elementType,c=t.rootProps,u=t.ariaDescribedBy,d=t.ariaLabelledBy,h=t.className,p=(0,m.G1)(this.props,m.vt),f=n||l||"div";this._evaluateFocusBeforeRender();var g=(0,a.getTheme)();return r.createElement(f,(0,s.Cl)({"aria-labelledby":d,"aria-describedby":u},p,c,{className:(0,y.A)((o||(o=(0,i.Z)({selectors:{":focus":{outline:"none"}}},"ms-FocusZone")),o),h),ref:this._mergedRef(this.props.elementRef,this._root),"data-focuszone-id":this._id,onKeyDown:function(t){return e._onKeyDown(t,g)},onFocus:this._onFocus,onMouseDownCapture:this._onMouseDown}),this.props.children)},t.prototype.focus=function(e){if(void 0===e&&(e=!1),this._root.current){if(!e&&"true"===this._root.current.getAttribute(C)&&this._isInnerZone){var t=this._getOwnerZone(this._root.current);if(t!==this._root.current){var n=x[t.getAttribute(_)];return!!n&&n.focusElement(this._root.current)}return!1}if(!e&&this._activeElement&&(0,v.s)(this._root.current,this._activeElement)&&(0,c.S0)(this._activeElement))return this._activeElement.focus(),!0;var o=this._root.current.firstChild;return this.focusElement((0,c.eX)(this._root.current,o,!0))}return!1},t.prototype.focusLast=function(){if(this._root.current){var e=this._root.current&&this._root.current.lastChild;return this.focusElement((0,c.yv)(this._root.current,e,!0,!0,!0))}return!1},t.prototype.focusElement=function(e,t){var n=this.props,o=n.onBeforeFocus,s=n.shouldReceiveFocus;return!(s&&!s(e)||o&&!o(e)||!e||(this._setActiveElement(e,t),this._activeElement&&this._activeElement.focus(),0))},t.prototype.setFocusAlignment=function(e){this._focusAlignment=e},t.prototype._evaluateFocusBeforeRender=function(){var e=this._root.current,t=this._getDocument();if(t){var n=t.activeElement;if(n!==e){var o=(0,v.s)(e,n,!1);this._lastIndexPath=o?(0,c.Ep)(e,n):void 0}}},t.prototype._setParkedFocus=function(e){var t=this._root.current;t&&this._isParked!==e&&(this._isParked=e,e?(this.props.allowFocusRoot||(this._parkedTabIndex=t.getAttribute("tabindex"),t.setAttribute("tabindex","-1")),t.focus()):this.props.allowFocusRoot||(this._parkedTabIndex?(t.setAttribute("tabindex",this._parkedTabIndex),this._parkedTabIndex=void 0):t.removeAttribute("tabindex")))},t.prototype._setActiveElement=function(e,t){var n=this._activeElement;this._activeElement=e,n&&((0,c.HC)(n)&&this._updateTabIndexes(n),n.tabIndex=-1),this._activeElement&&(this._focusAlignment&&!t||this._setFocusAlignment(e,!0,!0),this._activeElement.tabIndex=0)},t.prototype._preventDefaultWhenHandled=function(e){this.props.preventDefaultWhenHandled&&e.preventDefault()},t.prototype._tryInvokeClickForFocusable=function(e,t){var n=e;if(n===this._root.current||!this.props.shouldRaiseClicks)return!1;do{if("BUTTON"===n.tagName||"A"===n.tagName||"INPUT"===n.tagName||"TEXTAREA"===n.tagName)return!1;if(this._isImmediateDescendantOfZone(n)&&"true"===n.getAttribute(C)&&"true"!==n.getAttribute("data-disable-click-on-enter"))return M(n,t),!0;n=(0,u.P)(n,O)}while(n!==this._root.current);return!1},t.prototype._getFirstInnerZone=function(e){if(!(e=e||this._activeElement||this._root.current))return null;if((0,c.HC)(e))return x[e.getAttribute(_)];for(var t=e.firstElementChild;t;){if((0,c.HC)(t))return x[t.getAttribute(_)];var n=this._getFirstInnerZone(t);if(n)return n;t=t.nextElementSibling}return null},t.prototype._moveFocus=function(e,t,n,o){void 0===o&&(o=!0);var s=this._activeElement,r=-1,i=void 0,a=!1,l=this.props.direction===T.E.bidirectional;if(!s||!this._root.current)return!1;if(this._isElementInput(s)&&!this._shouldInputLoseFocus(s,e))return!1;var u=l?s.getBoundingClientRect():null;do{if(s=e?(0,c.eX)(this._root.current,s):(0,c.yv)(this._root.current,s),!l){i=s;break}if(s){var d=t(u,s.getBoundingClientRect());if(-1===d&&-1===r){i=s;break}if(d>-1&&(-1===r||d<r)&&(r=d,i=s),r>=0&&d<0)break}}while(s);if(i&&i!==this._activeElement)a=!0,this.focusElement(i);else if(this.props.isCircularNavigation&&o)return e?this.focusElement((0,c.eX)(this._root.current,this._root.current.firstElementChild,!0)):this.focusElement((0,c.yv)(this._root.current,this._root.current.lastElementChild,!0,!0,!0));return a},t.prototype._moveFocusDown=function(){var e=this,t=-1,n=this._focusAlignment.left||this._focusAlignment.x||0;return!!this._moveFocus(!0,(function(o,s){var r=-1,i=Math.floor(s.top),a=Math.floor(o.bottom);return i<a?e._shouldWrapFocus(e._activeElement,E)?I:P:((-1===t&&i>=a||i===t)&&(t=i,r=n>=s.left&&n<=s.left+s.width?0:Math.abs(s.left+s.width/2-n)),r)}))&&(this._setFocusAlignment(this._activeElement,!1,!0),!0)},t.prototype._moveFocusUp=function(){var e=this,t=-1,n=this._focusAlignment.left||this._focusAlignment.x||0;return!!this._moveFocus(!1,(function(o,s){var r=-1,i=Math.floor(s.bottom),a=Math.floor(s.top),l=Math.floor(o.top);return i>l?e._shouldWrapFocus(e._activeElement,E)?I:P:((-1===t&&i<=l||a===t)&&(t=a,r=n>=s.left&&n<=s.left+s.width?0:Math.abs(s.left+s.width/2-n)),r)}))&&(this._setFocusAlignment(this._activeElement,!1,!0),!0)},t.prototype._moveFocusLeft=function(e){var t=this,n=this._shouldWrapFocus(this._activeElement,A);return!!this._moveFocus((0,h.jI)(e),(function(o,s){var r=-1;return((0,h.jI)(e)?parseFloat(s.top.toFixed(3))<parseFloat(o.bottom.toFixed(3)):parseFloat(s.bottom.toFixed(3))>parseFloat(o.top.toFixed(3)))&&s.right<=o.right&&t.props.direction!==T.E.vertical?r=o.right-s.right:n||(r=P),r}),void 0,n)&&(this._setFocusAlignment(this._activeElement,!0,!1),!0)},t.prototype._moveFocusRight=function(e){var t=this,n=this._shouldWrapFocus(this._activeElement,A);return!!this._moveFocus(!(0,h.jI)(e),(function(o,s){var r=-1;return((0,h.jI)(e)?parseFloat(s.bottom.toFixed(3))>parseFloat(o.top.toFixed(3)):parseFloat(s.top.toFixed(3))<parseFloat(o.bottom.toFixed(3)))&&s.left>=o.left&&t.props.direction!==T.E.vertical?r=s.left-o.left:n||(r=P),r}),void 0,n)&&(this._setFocusAlignment(this._activeElement,!0,!1),!0)},t.prototype._moveFocusPaging=function(e,t){void 0===t&&(t=!0);var n=this._activeElement;if(!n||!this._root.current)return!1;if(this._isElementInput(n)&&!this._shouldInputLoseFocus(n,e))return!1;var o=(0,b.Hc)(n);if(!o)return!1;var s=-1,r=void 0,i=-1,a=-1,l=o.clientHeight,u=n.getBoundingClientRect();do{if(n=e?(0,c.eX)(this._root.current,n):(0,c.yv)(this._root.current,n)){var d=n.getBoundingClientRect(),h=Math.floor(d.top),p=Math.floor(u.bottom),f=Math.floor(d.bottom),g=Math.floor(u.top),m=this._getHorizontalDistanceFromCenter(e,u,d);if(e&&h>p+l||!e&&f<g-l)break;m>-1&&(e&&h>i?(i=h,s=m,r=n):!e&&f<a?(a=f,s=m,r=n):(-1===s||m<=s)&&(s=m,r=n))}}while(n);var y=!1;if(r&&r!==this._activeElement)y=!0,this.focusElement(r),this._setFocusAlignment(r,!1,!0);else if(this.props.isCircularNavigation&&t)return e?this.focusElement((0,c.eX)(this._root.current,this._root.current.firstElementChild,!0)):this.focusElement((0,c.yv)(this._root.current,this._root.current.lastElementChild,!0,!0,!0));return y},t.prototype._setFocusAlignment=function(e,t,n){if(this.props.direction===T.E.bidirectional&&(!this._focusAlignment||t||n)){var o=e.getBoundingClientRect(),s=o.left+o.width/2,r=o.top+o.height/2;this._focusAlignment||(this._focusAlignment={left:s,top:r}),t&&(this._focusAlignment.left=s),n&&(this._focusAlignment.top=r)}},t.prototype._isImmediateDescendantOfZone=function(e){return this._getOwnerZone(e)===this._root.current},t.prototype._getOwnerZone=function(e){for(var t=(0,u.P)(e,O);t&&t!==this._root.current&&t!==this._getDocument().body;){if((0,c.HC)(t))return t;t=(0,u.P)(t,O)}return t},t.prototype._updateTabIndexes=function(e){!this._activeElement&&this.props.defaultTabbableElement&&"function"==typeof this.props.defaultTabbableElement&&(this._activeElement=this.props.defaultTabbableElement(this._root.current)),!e&&this._root.current&&(this._defaultFocusElement=null,e=this._root.current,this._activeElement&&!(0,v.s)(e,this._activeElement)&&(this._activeElement=null)),this._activeElement&&!(0,c.S0)(this._activeElement)&&(this._activeElement=null);for(var t=e&&e.children,n=0;t&&n<t.length;n++){var o=t[n];(0,c.HC)(o)?"true"===o.getAttribute(C)&&(this._isInnerZone||(this._activeElement||this._defaultFocusElement)&&this._activeElement!==o?"-1"!==o.getAttribute(k)&&o.setAttribute(k,"-1"):(this._defaultFocusElement=o,"0"!==o.getAttribute(k)&&o.setAttribute(k,"0"))):(o.getAttribute&&"false"===o.getAttribute(C)&&o.setAttribute(k,"-1"),(0,c.S0)(o)?this.props.disabled?o.setAttribute(k,"-1"):this._isInnerZone||(this._activeElement||this._defaultFocusElement)&&this._activeElement!==o?"-1"!==o.getAttribute(k)&&o.setAttribute(k,"-1"):(this._defaultFocusElement=o,"0"!==o.getAttribute(k)&&o.setAttribute(k,"0")):"svg"===o.tagName&&"false"!==o.getAttribute("focusable")&&o.setAttribute("focusable","false")),this._updateTabIndexes(o)}},t.prototype._isContentEditableElement=function(e){return e&&"true"===e.getAttribute("contenteditable")},t.prototype._isElementInput=function(e){return!(!e||!e.tagName||"input"!==e.tagName.toLowerCase()&&"textarea"!==e.tagName.toLowerCase())},t.prototype._shouldInputLoseFocus=function(e,t){if(!this._processingTabKey&&e&&e.type&&D.indexOf(e.type.toLowerCase())>-1){var n=e.selectionStart,o=n!==e.selectionEnd,s=e.value,r=e.readOnly;if(o||n>0&&!t&&!r||n!==s.length&&t&&!r||this.props.handleTabKey&&(!this.props.shouldInputLoseFocusOnArrowKey||!this.props.shouldInputLoseFocusOnArrowKey(e)))return!1}return!0},t.prototype._shouldWrapFocus=function(e,t){return!this.props.checkForNoWrap||(0,c._l)(e,t)},t.prototype._portalContainsElement=function(e){return e&&!!this._root.current&&(0,S.s)(e,this._root.current)},t.prototype._getDocument=function(){return(0,w.Y)(this._root.current)},t.defaultProps={isCircularNavigation:!1,direction:T.E.bidirectional,shouldRaiseClicks:!0},t}(r.Component)},12977:(e,t,n)=>{"use strict";n.d(t,{E:()=>o,l:()=>s});var o,s={none:0,all:1,inputOnly:2};!function(e){e[e.vertical=0]="vertical",e[e.horizontal=1]="horizontal",e[e.bidirectional=2]="bidirectional",e[e.domOrder=3]="domOrder"}(o||(o={}))},16762:(e,t,n)=>{"use strict";n.d(t,{R:()=>o.R,Es:()=>s.E,lT:()=>s.l}),(0,n(30620).v)("@fluentui/react-focus","7.18.16");var o=n(73494),s=n(12977)},51595:(e,t,n)=>{"use strict";n.d(t,{D:()=>o});var o=n(30538).createContext(void 0)},56508:(e,t,n)=>{"use strict";n.d(t,{N:()=>A});var o=n(30538),s=n(76539),r=n(70616),i=n(65891),a=function(e,t,n){void 0===n&&(n={});var o=!1;if(e)for(var s=0,r=Object.keys(e);s<r.length;s++){var i=r[s];if(!o){if(0===i.indexOf("--"))return e;o=!0}var l=t?t+("default"===i?"":"-"+i):"--"+i,c=e[i];c&&"object"==typeof c?a(c,l,n):n[l]=c}return n},l=(0,i.n)((function(e){var t,n,o,s,r,i,l,c,u,d,h,p,f,g,m,y,v=e.tokens;return{root:a(v),body:[{color:null===(o=null===(n=null===(t=v)||void 0===t?void 0:t.color)||void 0===n?void 0:n.body)||void 0===o?void 0:o.contentColor,background:null===(i=null===(r=null===(s=v)||void 0===s?void 0:s.color)||void 0===r?void 0:r.body)||void 0===i?void 0:i.background,fontFamily:null===(c=null===(l=v)||void 0===l?void 0:l.body)||void 0===c?void 0:c.fontFamily,fontWeight:null===(d=null===(u=v)||void 0===u?void 0:u.body)||void 0===d?void 0:d.fontWeight,fontSize:null===(p=null===(h=v)||void 0===h?void 0:h.body)||void 0===p?void 0:p.fontSize,MozOsxFontSmoothing:null===(g=null===(f=v)||void 0===f?void 0:f.body)||void 0===g?void 0:g.mozOsxFontSmoothing,WebkitFontSmoothing:null===(y=null===(m=v)||void 0===m?void 0:m.body)||void 0===y?void 0:y.webkitFontSmoothing}]}}));var c=n(98670),u=n(8001),d=n(79433),h=n(61977),p=n(51595),f=n(50704),g=function(e){var t=function(e){var t={root:e.as||"div"},n={root:"string"==typeof e.as?(0,u._)(e.as,e):(0,d.cJ)(e,["as"])};return{slots:t,slotProps:n}}(e),n=t.slots,s=t.slotProps,r=e.theme,i=e.customizerContext;return o.createElement(p.D.Provider,{value:r},o.createElement(f.E.Provider,{value:e.renderer},o.createElement(h.z.Provider,{value:i},o.createElement(n.root,(0,c.Cl)({},s.root)))))},m=n(12846),y=n(95331),v=n(91177),b=n(66672),S=new Map,w=function(e){void 0===e&&(e={});var t=(0,c.aN)(e.deepMerge||[],["style"]),n=function(e){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];for(var a=0,l=r;a<l.length;a++){var c=l[a];if(c)for(var u=0,d=Object.keys(c);u<d.length;u++){var h=d[u],p=c[h];void 0!==p&&(p&&"object"==typeof p?Array.isArray(p)?e[h]=p:(e[h]=e[h]||{},"object"!=typeof e[h]||o.isValidElement(p)||p&&"object"==typeof p&&p.hasOwnProperty("current")||-1===t.indexOf(h)?e[h]=p:n(e[h],p)):"className"===h?p&&(e[h]=(0,s.A)(e[h],p)):e[h]=p)}}return e};return n}(),T=function(e,t,n){var s,r,i,a,l=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=o.useCallback((function(t){n.current=t;for(var o=0,s=e;o<s.length;o++){var r=s[o];"function"==typeof r?r(t):r&&(r.current=t)}}),(0,c.aN)(e));return n}(t,o.useRef(null)),u=w({ref:l,as:"div"},n,e);return r=(s=u).theme,i=(0,y.D)(),a=s.theme=o.useMemo((function(){var e,t=(0,m.z)(i,r);return t.tokens=function(e,t){var n=e.fonts,o=e.palette,s=e.semanticColors;return(0,b.h)({color:{body:{background:s.bodyBackground,contentColor:s.bodyText},brand:{background:s.primaryButtonBackground,borderColor:s.primaryButtonBorder,contentColor:s.primaryButtonText,iconColor:o.white,dividerColor:o.white,secondaryContentColor:o.white,hovered:{background:s.primaryButtonBackgroundHovered,contentColor:s.primaryButtonTextHovered,secondaryContentColor:o.white,borderColor:"var(--color-brand-borderColor)"},pressed:{background:s.primaryButtonBackgroundPressed,contentColor:s.primaryButtonTextPressed,secondaryContentColor:s.primaryButtonTextPressed,borderColor:"var(--color-brand-borderColor)",iconColor:"var(--color-brand-iconColor)"},focused:{background:"var(--color-brand-background)",borderColor:"var(--color-brand-borderColor)",contentColor:"var(--color-brand-contentColor)",iconColor:"var(--color-brand-iconColor)",secondaryContentColor:"var(--color-brand-focused-contentColor)"},disabled:{background:s.primaryButtonBackgroundDisabled,contentColor:s.buttonTextDisabled,dividerColor:o.neutralTertiaryAlt,secondaryContentColor:"var(--color-brand-disabled-contentColor)",borderColor:"var(--color-brand-disabled-background)",iconColor:"var(--color-brand-disabled-contentColor)"},checked:{background:s.primaryButtonBackgroundPressed,contentColor:s.primaryButtonTextPressed,iconColor:s.primaryButtonTextPressed},checkedHovered:{background:s.primaryButtonBackgroundPressed,contentColor:s.primaryButtonTextPressed,iconColor:s.primaryButtonTextPressed}}},body:{fontFamily:n.medium.fontFamily,fontWeight:n.medium.fontWeight,fontSize:n.medium.fontSize,mozOsxFontSmoothing:n.medium.MozOsxFontSmoothing,webkitFontSmoothing:n.medium.WebkitFontSmoothing},text:{variant:{caption:{fontSize:"12px",fontWeight:"400",lineHeight:"14px"},body:{fontSize:"14px",fontWeight:"400",lineHeight:"20px"},subHeadline:{fontSize:"16px",fontWeight:"600",lineHeight:"22px"},headline:{fontSize:"20px",fontWeight:"600",lineHeight:"28px"},title3:{fontSize:"24px",fontWeight:"600",lineHeight:"32px"},title2:{fontSize:"28px",fontWeight:"600",lineHeight:"36px"},title1:{fontSize:"32px",fontWeight:"600",lineHeight:"40px"},largeTitle:{fontSize:"40px",fontWeight:"600",lineHeight:"52px"},display:{fontSize:"68px",fontWeight:"600",lineHeight:"92px"}}}},t)}(t,null===(e=r)||void 0===e?void 0:e.tokens),t.id=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=[],o=0,s=e;o<s.length;o++){var r=s[o];if(r){var i=r.id||S.get(r);i||(i=(0,v.O)(""),S.set(r,i)),n.push(i)}}return n.join("-")}(i,r),t}),[i,r]),s.customizerContext=o.useMemo((function(){return{customizations:{inCustomizerContext:!0,settings:{theme:a},scopedSettings:a.components||{}}}}),[a]),s.theme.rtl!==i.rtl&&(s.dir=s.theme.rtl?"rtl":"ltr"),{state:u,render:g}},C=n(78750),_={document:"document"},k=o.createContext({registerStyles:function(e,t){var n=t.styleCache,o=t.target;if(e&&!(e.length<1)){Array.isArray(e)||(e=[e]);var s=[],r=o||_,i=n.get(r);i||(i=new Map,n.set(r,i));for(var a=0,l=e;a<l.length;a++){var c=l[a];i.has(c)||(s.push(c),i.set(c,!0))}s.length&&t.renderStyles(s,t)}},renderStyles:function(e,t){var n=t.target;if(e.length&&n){var o=n.createElement("style");o.textContent=e.join(""),n.head.appendChild(o)}},target:"object"==typeof window?window.document:void 0,styleCache:new WeakMap}),E=n(81180),A=o.forwardRef((function(e,t){var n,i,a=T(e,t,{renderer:C.K,applyTo:"element"}),c=a.render,u=a.state;return n=u.theme.stylesheets,(i=o.useContext(k)).registerStyles(n,i),function(e){var t=l(e),n=e.className,i=e.applyTo;!function(e,t){var n,s="body"===e.applyTo,i=null===(n=(0,r.ZY)())||void 0===n?void 0:n.body;o.useEffect((function(){if(s&&i){for(var e=0,n=t;e<n.length;e++){var o=n[e];o&&i.classList.add(o)}return function(){if(s&&i)for(var e=0,n=t;e<n.length;e++){var o=n[e];o&&i.classList.remove(o)}}}}),[s,i,t])}(e,[t.root,t.body]),e.className=(0,s.A)(n,t.root,"element"===i&&t.body)}(u),(0,E.v)(u.ref),c(u)}));A.displayName="ThemeProvider"},65891:(e,t,n)=>{"use strict";n.d(t,{n:()=>l});var o=n(95331),s=n(70616),r=n(50704),i=function(e,t){for(var n=0,o=t;n<o.length;n++){var s=o[n];if(!(e=e.get(s)))return}return e},a=function(e,t,n){for(var o=0;o<t.length-1;o++){var s=t[o],r=e.get(s);r||(r=new Map,e.set(s,r)),e=r}e.set(t[t.length-1],n)};function l(e){var t=new Map;return function(n){void 0===n&&(n={});var l=n.theme,c=n.renderer,u=(0,s.ox)(),d=(0,o.D)(),h=(0,r.M)();l=l||d||{};var p=(c=c||h).getId(),f="function"==typeof e,g=f?[p,u,l]:[p,u],m=i(t,g);if(!m){var y=f?e(l):e;m=c.renderStyles(y,{targetWindow:u,rtl:!!l.rtl}),a(t,g,m)}return m}}},78750:(e,t,n)=>{"use strict";n.d(t,{K:()=>l}),n(30538);var o=n(95876),s=n(46208),r=n(3864),i=n(88063),a=0,l={reset:function(){o.n.getInstance().onReset((function(){return a++}))},getId:function(){return a},renderStyles:function(e,t){return(0,s.L)(Array.isArray(e)?e:[e],t)},renderFontFace:function(e,t){return(0,r.n)(e)},renderKeyframes:function(e){return(0,i.i)(e)}}},50704:(e,t,n)=>{"use strict";n.d(t,{E:()=>r,M:()=>i});var o=n(30538),s=n(78750),r=o.createContext(s.K),i=function(){return o.useContext(r)}},95331:(e,t,n)=>{"use strict";n.d(t,{D:()=>a});var o=n(30538),s=n(21618),r=n(46401),i=n(51595),a=function(){var e=(0,o.useContext)(i.D),t=(0,s.m)(["theme"]).theme;return e||t||(0,r.a)({})}},70616:(e,t,n)=>{"use strict";n.d(t,{IF:()=>a,ZY:()=>i,_0:()=>s,ox:()=>r});var o=n(30538),s=o.createContext({window:"object"==typeof window?window:void 0}),r=function(){return o.useContext(s).window},i=function(){var e;return null===(e=o.useContext(s).window)||void 0===e?void 0:e.document},a=function(e){return o.createElement(s.Provider,{value:e},e.children)}},14785:(e,t,n)=>{"use strict";n.d(t,{IF:()=>o.IF,ZY:()=>o.ZY,_0:()=>o._0,ox:()=>o.ox});var o=n(70616)},88367:(e,t,n)=>{"use strict";n.d(t,{m:()=>o});var o=(0,n(46401).a)({})},59981:(e,t,n)=>{"use strict";n.d(t,{b:()=>o});var o={themeDarker:"#004578",themeDark:"#005a9e",themeDarkAlt:"#106ebe",themePrimary:"#0078d4",themeSecondary:"#2b88d8",themeTertiary:"#71afe5",themeLight:"#c7e0f4",themeLighter:"#deecf9",themeLighterAlt:"#eff6fc",black:"#000000",blackTranslucent40:"rgba(0,0,0,.4)",neutralDark:"#201f1e",neutralPrimary:"#323130",neutralPrimaryAlt:"#3b3a39",neutralSecondary:"#605e5c",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#a19f9d",neutralTertiaryAlt:"#c8c6c4",neutralQuaternary:"#d2d0ce",neutralQuaternaryAlt:"#e1dfdd",neutralLight:"#edebe9",neutralLighter:"#f3f2f1",neutralLighterAlt:"#faf9f8",accent:"#0078d4",white:"#ffffff",whiteTranslucent40:"rgba(255,255,255,.4)",yellowDark:"#d29200",yellow:"#ffb900",yellowLight:"#fff100",orange:"#d83b01",orangeLight:"#ea4300",orangeLighter:"#ff8c00",redDark:"#a4262c",red:"#e81123",magentaDark:"#5c005c",magenta:"#b4009e",magentaLight:"#e3008c",purpleDark:"#32145a",purple:"#5c2d91",purpleLight:"#b4a0ff",blueDark:"#002050",blueMid:"#00188f",blue:"#0078d4",blueLight:"#00bcf2",tealDark:"#004b50",teal:"#008272",tealLight:"#00b294",greenDark:"#004b1c",green:"#107c10",greenLight:"#bad80a"}},29643:(e,t,n)=>{"use strict";var o,s,r;n.d(t,{$U:()=>o,kd:()=>s,u2:()=>r}),function(e){e.shade30="#004578",e.shade20="#005a9e",e.shade10="#106ebe",e.primary="#0078d4",e.tint10="#2b88d8",e.tint20="#c7e0f4",e.tint30="#deecf9",e.tint40="#eff6fc"}(o||(o={})),function(e){e.black="#000000",e.gray220="#11100f",e.gray210="#161514",e.gray200="#1b1a19",e.gray190="#201f1e",e.gray180="#252423",e.gray170="#292827",e.gray160="#323130",e.gray150="#3b3a39",e.gray140="#484644",e.gray130="#605e5c",e.gray120="#797775",e.gray110="#8a8886",e.gray100="#979593",e.gray90="#a19f9d",e.gray80="#b3b0ad",e.gray70="#bebbb8",e.gray60="#c8c6c4",e.gray50="#d2d0ce",e.gray40="#e1dfdd",e.gray30="#edebe9",e.gray20="#f3f2f1",e.gray10="#faf9f8",e.white="#ffffff"}(s||(s={})),function(e){e.pinkRed10="#750b1c",e.red20="#a4262c",e.red10="#d13438",e.redOrange20="#603d30",e.redOrange10="#da3b01",e.orange30="#8e562e",e.orange20="#ca5010",e.orange10="#ffaa44",e.yellow10="#fce100",e.orangeYellow20="#986f0b",e.orangeYellow10="#c19c00",e.yellowGreen10="#8cbd18",e.green20="#0b6a0b",e.green10="#498205",e.greenCyan10="#00ad56",e.cyan40="#005e50",e.cyan30="#005b70",e.cyan20="#038387",e.cyan10="#00b7c3",e.cyanBlue20="#004e8c",e.cyanBlue10="#0078d4",e.blue10="#4f6bed",e.blueMagenta40="#373277",e.blueMagenta30="#5c2e91",e.blueMagenta20="#8764b8",e.blueMagenta10="#8378de",e.magenta20="#881798",e.magenta10="#c239b3",e.magentaPink20="#9b0062",e.magentaPink10="#e3008c",e.gray40="#393939",e.gray30="#7a7574",e.gray20="#69797e",e.gray10="#a0aeb2"}(r||(r={}))},46401:(e,t,n)=>{"use strict";n.d(t,{a:()=>c});var o=n(59981),s=n(70944),r=n(60203),i=n(12846),a=n(29730),l=n(99209);function c(e,t){void 0===e&&(e={}),void 0===t&&(t=!1);var n=!!e.isInverted,c={palette:o.b,effects:s.W,fonts:r.d,spacing:a.N,isInverted:n,disableGlobalClassNames:!1,semanticColors:(0,l.b)(o.b,s.W,void 0,n,t),rtl:void 0};return(0,i.z)(c,e)}},70944:(e,t,n)=>{"use strict";n.d(t,{W:()=>s});var o=n(78849),s={elevation4:o.f.depth4,elevation8:o.f.depth8,elevation16:o.f.depth16,elevation64:o.f.depth64,roundedCorner2:"2px",roundedCorner4:"4px",roundedCorner6:"6px"}},78849:(e,t,n)=>{"use strict";var o;n.d(t,{f:()=>o}),function(e){e.depth0="0 0 0 0 transparent",e.depth4="0 1.6px 3.6px 0 rgba(0, 0, 0, 0.132), 0 0.3px 0.9px 0 rgba(0, 0, 0, 0.108)",e.depth8="0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132), 0 0.6px 1.8px 0 rgba(0, 0, 0, 0.108)",e.depth16="0 6.4px 14.4px 0 rgba(0, 0, 0, 0.132), 0 1.2px 3.6px 0 rgba(0, 0, 0, 0.108)",e.depth64="0 25.6px 57.6px 0 rgba(0, 0, 0, 0.22), 0 4.8px 14.4px 0 rgba(0, 0, 0, 0.18)"}(o||(o={}))},60203:(e,t,n)=>{"use strict";n.d(t,{a:()=>f,d:()=>d});var o,s,r,i=n(3864),a=n(79805),l=n(33630),c=n(24823),u=n(19559),d=(0,l.s)((0,c.Z)("sessionStorage"));function h(e,t,n,o){e="'"+e+"'";var s=void 0!==o?"local('"+o+"'),":"";(0,i.n)({fontFamily:e,src:s+"url('"+t+".woff2') format('woff2'),url('"+t+".woff') format('woff')",fontWeight:n,fontStyle:"normal",fontDisplay:"swap"})}function p(e,t,n,o,s){void 0===o&&(o="segoeui");var r=e+"/"+n+"/"+o;h(t,r+"-light",a.BO.light,s&&s+" Light"),h(t,r+"-semilight",a.BO.semilight,s&&s+" SemiLight"),h(t,r+"-regular",a.BO.regular,s),h(t,r+"-semibold",a.BO.semibold,s&&s+" SemiBold"),h(t,r+"-bold",a.BO.bold,s&&s+" Bold")}function f(e){if(e){var t=e+"/fonts";p(t,a.Dn.Thai,"leelawadeeui-thai","leelawadeeui"),p(t,a.Dn.Arabic,"segoeui-arabic"),p(t,a.Dn.Cyrillic,"segoeui-cyrillic"),p(t,a.Dn.EastEuropean,"segoeui-easteuropean"),p(t,a.Dn.Greek,"segoeui-greek"),p(t,a.Dn.Hebrew,"segoeui-hebrew"),p(t,a.Dn.Vietnamese,"segoeui-vietnamese"),p(t,a.Dn.WestEuropean,"segoeui-westeuropean","segoeui","Segoe UI"),p(t,a.bi.Selawik,"selawik","selawik"),p(t,a.Dn.Armenian,"segoeui-armenian"),p(t,a.Dn.Georgian,"segoeui-georgian"),h("Leelawadee UI Web",t+"/leelawadeeui-thai/leelawadeeui-semilight",a.BO.light),h("Leelawadee UI Web",t+"/leelawadeeui-thai/leelawadeeui-bold",a.BO.semibold)}}f(null!=(r=null===(s=null===(o=(0,u.z)())||void 0===o?void 0:o.FabricConfig)||void 0===s?void 0:s.fontBaseUrl)?r:"https://static2.sharepointonline.com/files/fabric/assets")},79805:(e,t,n)=>{"use strict";var o,s,r,i,a;n.d(t,{BO:()=>i,Dn:()=>o,bi:()=>s,fF:()=>a,s:()=>r}),function(e){e.Arabic="Segoe UI Web (Arabic)",e.Cyrillic="Segoe UI Web (Cyrillic)",e.EastEuropean="Segoe UI Web (East European)",e.Greek="Segoe UI Web (Greek)",e.Hebrew="Segoe UI Web (Hebrew)",e.Thai="Leelawadee UI Web",e.Vietnamese="Segoe UI Web (Vietnamese)",e.WestEuropean="Segoe UI Web (West European)",e.Selawik="Selawik Web",e.Armenian="Segoe UI Web (Armenian)",e.Georgian="Segoe UI Web (Georgian)"}(o||(o={})),function(e){e.Arabic="'"+o.Arabic+"'",e.ChineseSimplified="'Microsoft Yahei UI', Verdana, Simsun",e.ChineseTraditional="'Microsoft Jhenghei UI', Pmingliu",e.Cyrillic="'"+o.Cyrillic+"'",e.EastEuropean="'"+o.EastEuropean+"'",e.Greek="'"+o.Greek+"'",e.Hebrew="'"+o.Hebrew+"'",e.Hindi="'Nirmala UI'",e.Japanese="'Yu Gothic UI', 'Meiryo UI', Meiryo, 'MS Pgothic', Osaka",e.Korean="'Malgun Gothic', Gulim",e.Selawik="'"+o.Selawik+"'",e.Thai="'Leelawadee UI Web', 'Kmer UI'",e.Vietnamese="'"+o.Vietnamese+"'",e.WestEuropean="'"+o.WestEuropean+"'",e.Armenian="'"+o.Armenian+"'",e.Georgian="'"+o.Georgian+"'"}(s||(s={})),function(e){e.size10="10px",e.size12="12px",e.size14="14px",e.size16="16px",e.size18="18px",e.size20="20px",e.size24="24px",e.size28="28px",e.size32="32px",e.size42="42px",e.size68="68px",e.mini="10px",e.xSmall="10px",e.small="12px",e.smallPlus="12px",e.medium="14px",e.mediumPlus="16px",e.icon="16px",e.large="18px",e.xLarge="20px",e.xLargePlus="24px",e.xxLarge="28px",e.xxLargePlus="32px",e.superLarge="42px",e.mega="68px"}(r||(r={})),function(e){e.light=100,e.semilight=300,e.regular=400,e.semibold=600,e.bold=700}(i||(i={})),function(e){e.xSmall="10px",e.small="12px",e.medium="16px",e.large="20px"}(a||(a={}))},33630:(e,t,n)=>{"use strict";n.d(t,{s:()=>l});var o=n(79805),s="'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Helvetica Neue', sans-serif",r="'Segoe UI', '"+o.Dn.WestEuropean+"'",i={ar:o.bi.Arabic,bg:o.bi.Cyrillic,cs:o.bi.EastEuropean,el:o.bi.Greek,et:o.bi.EastEuropean,he:o.bi.Hebrew,hi:o.bi.Hindi,hr:o.bi.EastEuropean,hu:o.bi.EastEuropean,ja:o.bi.Japanese,kk:o.bi.EastEuropean,ko:o.bi.Korean,lt:o.bi.EastEuropean,lv:o.bi.EastEuropean,pl:o.bi.EastEuropean,ru:o.bi.Cyrillic,sk:o.bi.EastEuropean,"sr-latn":o.bi.EastEuropean,th:o.bi.Thai,tr:o.bi.EastEuropean,uk:o.bi.Cyrillic,vi:o.bi.Vietnamese,"zh-hans":o.bi.ChineseSimplified,"zh-hant":o.bi.ChineseTraditional,hy:o.bi.Armenian,ka:o.bi.Georgian};function a(e,t,n){return{fontFamily:n,MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontSize:e,fontWeight:t}}function l(e){var t=function(e){for(var t in i)if(i.hasOwnProperty(t)&&e&&0===t.indexOf(e))return i[t];return r}(e)+", "+s;return{tiny:a(o.s.mini,o.BO.regular,t),xSmall:a(o.s.xSmall,o.BO.regular,t),small:a(o.s.small,o.BO.regular,t),smallPlus:a(o.s.smallPlus,o.BO.regular,t),medium:a(o.s.medium,o.BO.regular,t),mediumPlus:a(o.s.mediumPlus,o.BO.regular,t),large:a(o.s.large,o.BO.regular,t),xLarge:a(o.s.xLarge,o.BO.semibold,t),xLargePlus:a(o.s.xLargePlus,o.BO.semibold,t),xxLarge:a(o.s.xxLarge,o.BO.semibold,t),xxLargePlus:a(o.s.xxLargePlus,o.BO.semibold,t),superLarge:a(o.s.superLarge,o.BO.semibold,t),mega:a(o.s.mega,o.BO.semibold,t)}}},12846:(e,t,n)=>{"use strict";n.d(t,{z:()=>r});var o=n(66672),s=n(99209);function r(e,t){var n,r,i,a;void 0===t&&(t={});var l=(0,o.h)({},e,t,{semanticColors:(0,s.B)(t.palette,t.effects,t.semanticColors,void 0===t.isInverted?e.isInverted:t.isInverted)});if((null===(n=t.palette)||void 0===n?void 0:n.themePrimary)&&!(null===(r=t.palette)||void 0===r?void 0:r.accent)&&(l.palette.accent=t.palette.themePrimary),t.defaultFontStyle)for(var c=0,u=Object.keys(l.fonts);c<u.length;c++){var d=u[c];l.fonts[d]=(0,o.h)(l.fonts[d],t.defaultFontStyle,null===(a=null===(i=t)||void 0===i?void 0:i.fonts)||void 0===a?void 0:a[d])}return t.stylesheets&&(l.stylesheets=(e.stylesheets||[]).concat(t.stylesheets)),l}},58275:(e,t,n)=>{"use strict";n.d(t,{Mz:()=>r,OV:()=>s,Sw:()=>o});var o,s,r,i=n(88063),a=(0,i.i)({from:{opacity:0},to:{opacity:1}}),l=(0,i.i)({from:{opacity:1},to:{opacity:0}}),c=(0,i.i)({from:{transform:"scale3d(1.15, 1.15, 1)"},to:{transform:"scale3d(1, 1, 1)"}}),u=(0,i.i)({from:{transform:"scale3d(1, 1, 1)"},to:{transform:"scale3d(0.9, 0.9, 1)"}}),d=(0,i.i)({from:{transform:"translate3d(0, 0, 0)"},to:{transform:"translate3d(-48px, 0, 0)"}}),h=(0,i.i)({from:{transform:"translate3d(0, 0, 0)"},to:{transform:"translate3d(48px, 0, 0)"}}),p=(0,i.i)({from:{transform:"translate3d(48px, 0, 0)"},to:{transform:"translate3d(0, 0, 0)"}}),f=(0,i.i)({from:{transform:"translate3d(-48px, 0, 0)"},to:{transform:"translate3d(0, 0, 0)"}}),g=(0,i.i)({from:{transform:"translate3d(0, 0, 0)"},to:{transform:"translate3d(0, -48px, 0)"}}),m=(0,i.i)({from:{transform:"translate3d(0, 0, 0)"},to:{transform:"translate3d(0, 48px, 0)"}}),y=(0,i.i)({from:{transform:"translate3d(0, 48px, 0)"},to:{transform:"translate3d(0, 0, 0)"}}),v=(0,i.i)({from:{transform:"translate3d(0, -48px, 0)"},to:{transform:"translate3d(0, 0, 0)"}});function b(e,t,n){return e+" "+t+" "+n}!function(e){e.duration1="100ms",e.duration2="200ms",e.duration3="300ms",e.duration4="400ms"}(o||(o={})),function(e){e.accelerate="cubic-bezier(0.9, 0.1, 1, 0.2)",e.decelerate="cubic-bezier(0.1, 0.9, 0.2, 1)",e.linear="cubic-bezier(0, 0, 1, 1)",e.standard="cubic-bezier(0.8, 0, 0.2, 1)"}(s||(s={})),function(e){e.fadeIn=b(a,o.duration1,s.linear),e.fadeOut=b(l,o.duration1,s.linear),e.scaleDownIn=b(c,o.duration3,s.decelerate),e.scaleDownOut=b(u,o.duration3,s.decelerate),e.slideLeftOut=b(d,o.duration1,s.accelerate),e.slideRightOut=b(h,o.duration1,s.accelerate),e.slideLeftIn=b(p,o.duration1,s.decelerate),e.slideRightIn=b(f,o.duration1,s.decelerate),e.slideUpOut=b(g,o.duration1,s.accelerate),e.slideDownOut=b(m,o.duration1,s.accelerate),e.slideUpIn=b(y,o.duration1,s.decelerate),e.slideDownIn=b(v,o.duration1,s.decelerate)}(r||(r={}))},29730:(e,t,n)=>{"use strict";n.d(t,{N:()=>o});var o={s2:"4px",s1:"8px",m:"16px",l1:"20px",l2:"32px"}},99209:(e,t,n)=>{"use strict";n.d(t,{B:()=>r,b:()=>s});var o=n(98670);function s(e,t,n,s,i){return void 0===i&&(i=!1),function(e,t){var n="";return!0===t&&(n=" /* @deprecated */"),e.listTextColor=e.listText+n,e.menuItemBackgroundChecked+=n,e.warningHighlight+=n,e.warningText=e.messageText+n,e.successText+=n,e}(r(e,t,(0,o.Cl)({primaryButtonBorder:"transparent",errorText:s?"#F1707B":"#a4262c",messageText:s?"#F3F2F1":"#323130",messageLink:s?"#6CB8F6":"#005A9E",messageLinkHovered:s?"#82C7FF":"#004578",infoIcon:s?"#C8C6C4":"#605e5c",errorIcon:s?"#F1707B":"#A80000",blockingIcon:s?"#442726":"#FDE7E9",warningIcon:s?"#C8C6C4":"#797775",severeWarningIcon:s?"#FCE100":"#D83B01",successIcon:s?"#92C353":"#107C10",infoBackground:s?"#323130":"#f3f2f1",errorBackground:s?"#442726":"#FDE7E9",blockingBackground:s?"#442726":"#FDE7E9",warningBackground:s?"#433519":"#FFF4CE",severeWarningBackground:s?"#4F2A0F":"#FED9CC",successBackground:s?"#393D1B":"#DFF6DD",warningHighlight:s?"#fff100":"#ffb900",successText:s?"#92c353":"#107C10"},n),s),i)}function r(e,t,n,s,r){var i,a,l;void 0===r&&(r=!1);var c={},u=e||{},d=u.white,h=u.black,p=u.themePrimary,f=u.themeDark,g=u.themeDarker,m=u.themeDarkAlt,y=u.themeLighter,v=u.neutralLight,b=u.neutralLighter,S=u.neutralDark,w=u.neutralQuaternary,T=u.neutralQuaternaryAlt,C=u.neutralPrimary,_=u.neutralSecondary,k=u.neutralSecondaryAlt,E=u.neutralTertiary,A=u.neutralTertiaryAlt,I=u.neutralLighterAlt,P=u.accent;return d&&(c.bodyBackground=d,c.bodyFrameBackground=d,c.accentButtonText=d,c.buttonBackground=d,c.primaryButtonText=d,c.primaryButtonTextHovered=d,c.primaryButtonTextPressed=d,c.inputBackground=d,c.inputForegroundChecked=d,c.listBackground=d,c.menuBackground=d,c.cardStandoutBackground=d),h&&(c.bodyTextChecked=h,c.buttonTextCheckedHovered=h),p&&(c.link=p,c.primaryButtonBackground=p,c.inputBackgroundChecked=p,c.inputIcon=p,c.inputFocusBorderAlt=p,c.menuIcon=p,c.menuHeader=p,c.accentButtonBackground=p),f&&(c.primaryButtonBackgroundPressed=f,c.inputBackgroundCheckedHovered=f,c.inputIconHovered=f),g&&(c.linkHovered=g),m&&(c.primaryButtonBackgroundHovered=m),y&&(c.inputPlaceholderBackgroundChecked=y),v&&(c.bodyBackgroundChecked=v,c.bodyFrameDivider=v,c.bodyDivider=v,c.variantBorder=v,c.buttonBackgroundCheckedHovered=v,c.buttonBackgroundPressed=v,c.listItemBackgroundChecked=v,c.listHeaderBackgroundPressed=v,c.menuItemBackgroundPressed=v,c.menuItemBackgroundChecked=v),b&&(c.bodyBackgroundHovered=b,c.buttonBackgroundHovered=b,c.buttonBackgroundDisabled=b,c.buttonBorderDisabled=b,c.primaryButtonBackgroundDisabled=b,c.disabledBackground=b,c.listItemBackgroundHovered=b,c.listHeaderBackgroundHovered=b,c.menuItemBackgroundHovered=b),w&&(c.primaryButtonTextDisabled=w,c.disabledSubtext=w),T&&(c.listItemBackgroundCheckedHovered=T),E&&(c.disabledBodyText=E,c.variantBorderHovered=(null===(i=n)||void 0===i?void 0:i.variantBorderHovered)||E,c.buttonTextDisabled=E,c.inputIconDisabled=E,c.disabledText=E),C&&(c.bodyText=C,c.actionLink=C,c.buttonText=C,c.inputBorderHovered=C,c.inputText=C,c.listText=C,c.menuItemText=C),I&&(c.bodyStandoutBackground=I,c.defaultStateBackground=I),S&&(c.actionLinkHovered=S,c.buttonTextHovered=S,c.buttonTextChecked=S,c.buttonTextPressed=S,c.inputTextHovered=S,c.menuItemTextHovered=S),_&&(c.bodySubtext=_,c.focusBorder=_,c.inputBorder=_,c.smallInputBorder=_,c.inputPlaceholderText=_),k&&(c.buttonBorder=k),A&&(c.disabledBodySubtext=A,c.disabledBorder=A,c.buttonBackgroundChecked=A,c.menuDivider=A),P&&(c.accentButtonBackground=P),(null===(a=t)||void 0===a?void 0:a.elevation4)&&(c.cardShadow=t.elevation4),!s&&(null===(l=t)||void 0===l?void 0:l.elevation8)?c.cardShadowHovered=t.elevation8:c.variantBorderHovered&&(c.cardShadowHovered="0 0 1px "+c.variantBorderHovered),(0,o.Cl)((0,o.Cl)({},c),n)}},92132:(e,t,n)=>{"use strict";n.d(t,{EQ:()=>p,hN:()=>d});var o,s=function(){return s=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},s.apply(this,arguments)},r="undefined"==typeof window?n.g:window,i=r&&r.CSPSettings&&r.CSPSettings.nonce,a=((o=r.__themeState__||{theme:void 0,lastStyleElement:void 0,registeredStyles:[]}).runState||(o=s(s({},o),{perf:{count:0,duration:0},runState:{flushTimer:0,mode:0,buffer:[]}})),o.registeredThemableStyles||(o=s(s({},o),{registeredThemableStyles:[]})),r.__themeState__=o,o),l=/[\'\"]\[theme:\s*(\w+)\s*(?:\,\s*default:\s*([\\"\']?[\.\,\(\)\#\-\s\w]*[\.\,\(\)\#\-\w][\"\']?))?\s*\][\'\"]/g,c=function(){return"undefined"!=typeof performance&&performance.now?performance.now():Date.now()};function u(e){var t=c();e();var n=c();a.perf.duration+=n-t}function d(e,t){void 0===t&&(t=!1),u((function(){var n=Array.isArray(e)?e:function(e){var t=[];if(e){for(var n=0,o=void 0;o=l.exec(e);){var s=o.index;s>n&&t.push({rawString:e.substring(n,s)}),t.push({theme:o[1],defaultValue:o[2]}),n=l.lastIndex}t.push({rawString:e.substring(n)})}return t}(e),o=a.runState,s=o.mode,r=o.buffer,i=o.flushTimer;t||1===s?(r.push(n),i||(a.runState.flushTimer=setTimeout((function(){a.runState.flushTimer=0,u((function(){var e=a.runState.buffer.slice();a.runState.buffer=[];var t=[].concat.apply([],e);t.length>0&&h(t)}))}),0))):h(n)}))}function h(e,t){a.loadStyles?a.loadStyles(g(e).styleString,e):function(e){if("undefined"!=typeof document){var t=document.getElementsByTagName("head")[0],n=document.createElement("style"),o=g(e),s=o.styleString,r=o.themable;n.setAttribute("data-load-themed-styles","true"),i&&n.setAttribute("nonce",i),n.appendChild(document.createTextNode(s)),a.perf.count++,t.appendChild(n);var l=document.createEvent("HTMLEvents");l.initEvent("styleinsert",!0,!1),l.args={newStyle:n},document.dispatchEvent(l);var c={styleElement:n,themableStyle:e};r?a.registeredThemableStyles.push(c):a.registeredStyles.push(c)}}(e)}function p(e){a.theme=e,function(){if(a.theme){for(var e=[],t=0,n=a.registeredThemableStyles;t<n.length;t++){var o=n[t];e.push(o.themableStyle)}e.length>0&&(void 0===(s=1)&&(s=3),3!==s&&2!==s||(f(a.registeredStyles),a.registeredStyles=[]),3!==s&&1!==s||(f(a.registeredThemableStyles),a.registeredThemableStyles=[]),h([].concat.apply([],e)))}var s}()}function f(e){e.forEach((function(e){var t=e&&e.styleElement;t&&t.parentElement&&t.parentElement.removeChild(t)}))}function g(e){var t=a.theme,n=!1;return{styleString:(e||[]).map((function(e){var o=e.theme;if(o){n=!0;var s=t?t[o]:void 0,r=e.defaultValue||"inherit";return t&&!s&&console&&!(o in t)&&"undefined"!=typeof DEBUG&&DEBUG&&console.warn('Theming value not provided for "'.concat(o,'". Falling back to "').concat(r,'".')),s||r}return e.rawString})).join(""),themable:n}}},31545:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AuthenticationHandler:()=>_,AuthenticationHandlerOptions:()=>S,BatchRequestContent:()=>r,BatchResponseContent:()=>i,ChaosHandler:()=>N,ChaosHandlerOptions:()=>R,ChaosStrategy:()=>T,Client:()=>te,CustomAuthenticationProvider:()=>J,FeatureUsageFlag:()=>w,FileUpload:()=>$,GraphClientError:()=>l,GraphError:()=>K,GraphRequest:()=>X,HTTPMessageHandler:()=>k,LargeFileUploadTask:()=>q,MiddlewareFactory:()=>x,OneDriveLargeFileUploadTask:()=>z,PageIterator:()=>Q,Range:()=>G,RedirectHandler:()=>P,RedirectHandlerOptions:()=>I,ResponseType:()=>L,RetryHandler:()=>A,RetryHandlerOptions:()=>E,StreamUpload:()=>j,TelemetryHandler:()=>M,TelemetryHandlerOptions:()=>C,UploadResult:()=>H,getValidRangeSize:()=>V});var o,s=n(5866);!function(e){e.GET="GET",e.PATCH="PATCH",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(o||(o={}));class r{static validateDependencies(e){if(0===e.size){const e=new Error("Empty requests map, Please provide at least one request.");throw e.name="Empty Requests Error",e}return(e=>{const t=e.entries();let n=t.next();for(;!n.done;){const e=n.value[1];if(void 0!==e.dependsOn&&e.dependsOn.length>0)return!1;n=t.next()}return!0})(e)||(e=>{const t=e.entries();let n=t.next();const o=n.value[1];if(void 0!==o.dependsOn&&o.dependsOn.length>0)return!1;let s=n;for(n=t.next();!n.done;){const e=n.value[1];if(void 0===e.dependsOn||1!==e.dependsOn.length||e.dependsOn[0]!==s.value[1].id)return!1;s=n,n=t.next()}return!0})(e)||(e=>{const t=e.entries();let n=t.next();const o=n.value[1];let s;if(void 0===o.dependsOn||0===o.dependsOn.length)s=o.id;else{if(1!==o.dependsOn.length)return!1;{const t=o.dependsOn[0];if(t===o.id||!e.has(t))return!1;s=t}}for(n=t.next();!n.done;){const e=n.value[1];if((void 0===e.dependsOn||0===e.dependsOn.length)&&s!==e.id)return!1;if(void 0!==e.dependsOn&&0!==e.dependsOn.length){if(1===e.dependsOn.length&&(e.id===s||e.dependsOn[0]!==s))return!1;if(e.dependsOn.length>1)return!1}n=t.next()}return!0})(e)}static getRequestData(e){return(0,s.__awaiter)(this,void 0,void 0,(function*(){const t={url:""},n=new RegExp("^https?://");t.url=n.test(e.url)?"/"+e.url.split(/.*?\/\/.*?\//)[1]:e.url,t.method=e.method;const s={};return e.headers.forEach(((e,t)=>{s[t]=e})),Object.keys(s).length&&(t.headers=s),e.method!==o.PATCH&&e.method!==o.POST&&e.method!==o.PUT||(t.body=yield r.getRequestBody(e)),t}))}static getRequestBody(e){return(0,s.__awaiter)(this,void 0,void 0,(function*(){let t,n=!1;try{const o=e.clone();t=yield o.json(),n=!0}catch(e){}if(!n)try{if("undefined"!=typeof Blob){const n=yield e.blob(),o=new FileReader;t=yield new Promise((e=>{o.addEventListener("load",(()=>{const t=o.result,n=new RegExp("^s*data:(.+?/.+?(;.+?=.+?)*)?(;base64)?,(.*)s*$").exec(t);e(n[4])}),!1),o.readAsDataURL(n)}))}else"undefined"!=typeof Buffer&&(t=(yield e.buffer()).toString("base64"));n=!0}catch(e){}return t}))}constructor(e){if(this.requests=new Map,void 0!==e){const t=r.requestLimit;if(e.length>t){const e=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw e.name="Limit Exceeded Error",e}for(const t of e)this.addRequest(t)}}addRequest(e){const t=r.requestLimit;if(""===e.id){const e=new Error("Id for a request is empty, Please provide an unique id");throw e.name="Empty Id For Request",e}if(this.requests.size===t){const e=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw e.name="Limit Exceeded Error",e}if(this.requests.has(e.id)){const t=new Error(`Adding request with duplicate id ${e.id}, Make the id of the requests unique`);throw t.name="Duplicate RequestId Error",t}return this.requests.set(e.id,e),e.id}removeRequest(e){const t=this.requests.delete(e),n=this.requests.entries();let o=n.next();for(;!o.done;){const t=o.value[1].dependsOn;if(void 0!==t){const n=t.indexOf(e);-1!==n&&t.splice(n,1),0===t.length&&delete o.value[1].dependsOn}o=n.next()}return t}getContent(){return(0,s.__awaiter)(this,void 0,void 0,(function*(){const e=[],t={requests:e},n=this.requests.entries();let o=n.next();if(o.done){const e=new Error("No requests added yet, Please add at least one request.");throw e.name="Empty Payload",e}if(!r.validateDependencies(this.requests)){const e=new Error("Invalid dependency found, Dependency should be:\n1. Parallel - no individual request states a dependency in the dependsOn property.\n2. Serial - all individual requests depend on the previous individual request.\n3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.");throw e.name="Invalid Dependency",e}for(;!o.done;){const t=o.value[1],s=yield r.getRequestData(t.request);if(void 0!==s.body&&(void 0===s.headers||void 0===s.headers["content-type"])){const e=new Error(`Content-type header is not mentioned for request #${t.id}, For request having body, Content-type header should be mentioned`);throw e.name="Invalid Content-type header",e}s.id=t.id,void 0!==t.dependsOn&&t.dependsOn.length>0&&(s.dependsOn=t.dependsOn),e.push(s),o=n.next()}return t.requests=e,t}))}addDependency(e,t){if(!this.requests.has(e)){const t=new Error(`Dependent ${e} does not exists, Please check the id`);throw t.name="Invalid Dependent",t}if(void 0!==t&&!this.requests.has(t)){const e=new Error(`Dependency ${t} does not exists, Please check the id`);throw e.name="Invalid Dependency",e}if(void 0!==t){const n=this.requests.get(e);if(void 0===n.dependsOn&&(n.dependsOn=[]),-1!==n.dependsOn.indexOf(t)){const n=new Error(`Dependency ${t} is already added for the request ${e}`);throw n.name="Duplicate Dependency",n}n.dependsOn.push(t)}else{const n=this.requests.entries();let o,s=n.next();for(;!s.done&&s.value[1].id!==e;)o=s,s=n.next();if(void 0===o){const e=new Error(`Can't add dependency ${t}, There is only a dependent request in the batch`);throw e.name="Invalid Dependency Addition",e}{const t=o.value[0];if(void 0===s.value[1].dependsOn&&(s.value[1].dependsOn=[]),-1!==s.value[1].dependsOn.indexOf(t)){const n=new Error(`Dependency ${t} is already added for the request ${e}`);throw n.name="Duplicate Dependency",n}s.value[1].dependsOn.push(t)}}}removeDependency(e,t){const n=this.requests.get(e);if(void 0===n||void 0===n.dependsOn||0===n.dependsOn.length)return!1;if(void 0!==t){const e=n.dependsOn.indexOf(t);return-1!==e&&(n.dependsOn.splice(e,1),!0)}return delete n.dependsOn,!0}}r.requestLimit=20;class i{constructor(e){this.responses=new Map,this.update(e)}createResponseObject(e){const t=e.body,n={};if(n.status=e.status,void 0!==e.statusText&&(n.statusText=e.statusText),n.headers=e.headers,void 0!==n.headers&&void 0!==n.headers["Content-Type"]&&"application/json"===n.headers["Content-Type"].split(";")[0]){const e=JSON.stringify(t);return new Response(e,n)}return new Response(t,n)}update(e){this.nextLink=e["@odata.nextLink"];const t=e.responses;for(let e=0,n=t.length;e<n;e++)this.responses.set(t[e].id,this.createResponseObject(t[e]))}getResponseById(e){return this.responses.get(e)}getResponses(){return this.responses}*getResponsesIterator(){const e=this.responses.entries();let t=e.next();for(;!t.done;)yield t.value,t=e.next()}}const a=new Set(["graph.microsoft.com","graph.microsoft.us","dod-graph.microsoft.us","graph.microsoft.de","microsoftgraph.chinacloudapi.cn","canary.graph.microsoft.com"]);class l extends Error{static setGraphClientError(e){let t;return e instanceof Error?t=e:(t=new l,t.customError=e),t}constructor(e){super(e),Object.setPrototypeOf(this,l.prototype)}}const c=["$select","$expand","$orderby","$filter","$top","$skip","$skipToken","$count"],u=e=>{const t=e&&e.constructor&&e.constructor.name;if("Buffer"===t||"Blob"===t||"File"===t||"FormData"===t||"string"==typeof e)return e;if("ArrayBuffer"===t)e=Buffer.from(e);else if("Int8Array"===t||"Int16Array"===t||"Int32Array"===t||"Uint8Array"===t||"Uint16Array"===t||"Uint32Array"===t||"Uint8ClampedArray"===t||"Float32Array"===t||"Float64Array"===t||"DataView"===t)e=Buffer.from(e.buffer);else try{e=JSON.stringify(e)}catch(e){throw new Error("Unable to stringify the content")}return e},d=e=>p(e),h=(e,t)=>(t.forEach((e=>f(e))),p(e,t)),p=(e,t=a)=>{if(-1!==(e=e.toLowerCase()).indexOf("https://")){const n=(e=e.replace("https://","")).indexOf(":"),o=e.indexOf("/");let s="";if(-1!==o)return-1!==n&&n<o?(s=e.substring(0,n),t.has(s)):(s=e.substring(0,o),t.has(s))}return!1},f=e=>{if(-1!==e.indexOf("/"))throw new l("Please add only hosts or hostnames to the CustomHosts config. If the url is `http://example.com:3000/`, host is `example:3000`")};class g{constructor(e=[]){this.middlewareOptions=new Map;for(const t of e){const e=t.constructor;this.middlewareOptions.set(e,t)}}getMiddlewareOptions(e){return this.middlewareOptions.get(e)}setMiddlewareOptions(e,t){this.middlewareOptions.set(e,t)}}const m=()=>{let e="";for(let t=0;t<32;t++)8!==t&&12!==t&&16!==t&&20!==t||(e+="-"),e+=Math.floor(16*Math.random()).toString(16);return e},y=(e,t,n)=>{let o=null;if("undefined"!=typeof Request&&e instanceof Request)o=e.headers.get(n);else if(void 0!==t&&void 0!==t.headers)if("undefined"!=typeof Headers&&t.headers instanceof Headers)o=t.headers.get(n);else if(t.headers instanceof Array){const e=t.headers;for(let t=0,s=e.length;t<s;t++)if(e[t][0]===n){o=e[t][1];break}}else void 0!==t.headers[n]&&(o=t.headers[n]);return o},v=(e,t,n,o)=>{if("undefined"!=typeof Request&&e instanceof Request)e.headers.set(n,o);else if(void 0!==t)if(void 0===t.headers)t.headers=new Headers({[n]:o});else if("undefined"!=typeof Headers&&t.headers instanceof Headers)t.headers.set(n,o);else if(t.headers instanceof Array){let e=0;const s=t.headers.length;for(;e<s;e++){const s=t.headers[e];if(s[0]===n){s[1]=o;break}}e===s&&t.headers.push([n,o])}else Object.assign(t.headers,{[n]:o})},b=(e,t,n,o)=>{"undefined"!=typeof Request&&e instanceof Request?e.headers.append(n,o):void 0!==t&&(void 0===t.headers?t.headers=new Headers({[n]:o}):"undefined"!=typeof Headers&&t.headers instanceof Headers?t.headers.append(n,o):t.headers instanceof Array?t.headers.push([n,o]):void 0===t.headers?t.headers={[n]:o}:void 0===t.headers[n]?t.headers[n]=o:t.headers[n]+=`, ${o}`)};class S{constructor(e,t){this.authenticationProvider=e,this.authenticationProviderOptions=t}}var w,T;!function(e){e[e.NONE=0]="NONE",e[e.REDIRECT_HANDLER_ENABLED=1]="REDIRECT_HANDLER_ENABLED",e[e.RETRY_HANDLER_ENABLED=2]="RETRY_HANDLER_ENABLED",e[e.AUTHENTICATION_HANDLER_ENABLED=4]="AUTHENTICATION_HANDLER_ENABLED"}(w||(w={}));class C{constructor(){this.featureUsage=w.NONE}static updateFeatureUsageFlag(e,t){let n;e.middlewareControl instanceof g?n=e.middlewareControl.getMiddlewareOptions(C):e.middlewareControl=new g,void 0===n&&(n=new C,e.middlewareControl.setMiddlewareOptions(C,n)),n.setFeatureUsage(t)}setFeatureUsage(e){this.featureUsage=this.featureUsage|e}getFeatureUsage(){return this.featureUsage.toString(16)}}class _{constructor(e){this.authenticationProvider=e}execute(e){return(0,s.__awaiter)(this,void 0,void 0,(function*(){const t="string"==typeof e.request?e.request:e.request.url;if(d(t)||e.customHosts&&h(t,e.customHosts)){let t,n,o;e.middlewareControl instanceof g&&(t=e.middlewareControl.getMiddlewareOptions(S)),t&&(n=t.authenticationProvider,o=t.authenticationProviderOptions),n||(n=this.authenticationProvider);const s=`Bearer ${yield n.getAccessToken(o)}`;b(e.request,e.options,_.AUTHORIZATION_HEADER,s),C.updateFeatureUsageFlag(e,w.AUTHENTICATION_HANDLER_ENABLED)}else e.options.headers&&delete e.options.headers[_.AUTHORIZATION_HEADER];return yield this.nextMiddleware.execute(e)}))}setNext(e){this.nextMiddleware=e}}_.AUTHORIZATION_HEADER="Authorization";class k{execute(e){return(0,s.__awaiter)(this,void 0,void 0,(function*(){e.response=yield fetch(e.request,e.options)}))}}class E{constructor(e=E.DEFAULT_DELAY,t=E.DEFAULT_MAX_RETRIES,n=E.defaultShouldRetry){if(e>E.MAX_DELAY&&t>E.MAX_MAX_RETRIES){const e=new Error(`Delay and MaxRetries should not be more than ${E.MAX_DELAY} and ${E.MAX_MAX_RETRIES}`);throw e.name="MaxLimitExceeded",e}if(e>E.MAX_DELAY){const e=new Error(`Delay should not be more than ${E.MAX_DELAY}`);throw e.name="MaxLimitExceeded",e}if(t>E.MAX_MAX_RETRIES){const e=new Error(`MaxRetries should not be more than ${E.MAX_MAX_RETRIES}`);throw e.name="MaxLimitExceeded",e}if(e<0&&t<0){const e=new Error("Delay and MaxRetries should not be negative");throw e.name="MinExpectationNotMet",e}if(e<0){const e=new Error("Delay should not be negative");throw e.name="MinExpectationNotMet",e}if(t<0){const e=new Error("MaxRetries should not be negative");throw e.name="MinExpectationNotMet",e}this.delay=Math.min(e,E.MAX_DELAY),this.maxRetries=Math.min(t,E.MAX_MAX_RETRIES),this.shouldRetry=n}getMaxDelay(){return E.MAX_DELAY}}E.DEFAULT_DELAY=3,E.DEFAULT_MAX_RETRIES=3,E.MAX_DELAY=180,E.MAX_MAX_RETRIES=10,E.defaultShouldRetry=()=>!0;class A{constructor(e=new E){this.options=e}isRetry(e){return-1!==A.RETRY_STATUS_CODES.indexOf(e.status)}isBuffered(e,t){const n="string"==typeof e?t.method:e.method;return n!==o.PUT&&n!==o.PATCH&&n!==o.POST||"application/octet-stream"!==y(e,t,"Content-Type")}getDelay(e,t,n){const o=()=>Number(Math.random().toFixed(3)),s=void 0!==e.headers?e.headers.get(A.RETRY_AFTER_HEADER):null;let r;return r=null!==s?Number.isNaN(Number(s))?Math.round((new Date(s).getTime()-Date.now())/1e3):Number(s):t>=2?this.getExponentialBackOffTime(t)+n+o():n+o(),Math.min(r,this.options.getMaxDelay()+o())}getExponentialBackOffTime(e){return Math.round(.5*(Math.pow(2,e)-1))}sleep(e){return(0,s.__awaiter)(this,void 0,void 0,(function*(){const t=1e3*e;return new Promise((e=>setTimeout(e,t)))}))}getOptions(e){let t;return e.middlewareControl instanceof g&&(t=e.middlewareControl.getMiddlewareOptions(this.options.constructor)),void 0===t&&(t=Object.assign(new E,this.options)),t}executeWithRetry(e,t,n){return(0,s.__awaiter)(this,void 0,void 0,(function*(){if(yield this.nextMiddleware.execute(e),t<n.maxRetries&&this.isRetry(e.response)&&this.isBuffered(e.request,e.options)&&n.shouldRetry(n.delay,t,e.request,e.options,e.response)){++t,v(e.request,e.options,A.RETRY_ATTEMPT_HEADER,t.toString());const o=this.getDelay(e.response,t,n.delay);return yield this.sleep(o),yield this.executeWithRetry(e,t,n)}}))}execute(e){return(0,s.__awaiter)(this,void 0,void 0,(function*(){const t=this.getOptions(e);return C.updateFeatureUsageFlag(e,w.RETRY_HANDLER_ENABLED),yield this.executeWithRetry(e,0,t)}))}setNext(e){this.nextMiddleware=e}}A.RETRY_STATUS_CODES=[429,503,504],A.RETRY_ATTEMPT_HEADER="Retry-Attempt",A.RETRY_AFTER_HEADER="Retry-After";class I{constructor(e=I.DEFAULT_MAX_REDIRECTS,t=I.defaultShouldRedirect){if(e>I.MAX_MAX_REDIRECTS){const e=new Error(`MaxRedirects should not be more than ${I.MAX_MAX_REDIRECTS}`);throw e.name="MaxLimitExceeded",e}if(e<0){const e=new Error("MaxRedirects should not be negative");throw e.name="MinExpectationNotMet",e}this.maxRedirects=e,this.shouldRedirect=t}}I.DEFAULT_MAX_REDIRECTS=5,I.MAX_MAX_REDIRECTS=20,I.defaultShouldRedirect=()=>!0;class P{constructor(e=new I){this.options=e}isRedirect(e){return-1!==P.REDIRECT_STATUS_CODES.indexOf(e.status)}hasLocationHeader(e){return e.headers.has(P.LOCATION_HEADER)}getLocationHeader(e){return e.headers.get(P.LOCATION_HEADER)}isRelativeURL(e){return-1===e.indexOf("://")}shouldDropAuthorizationHeader(e,t){const n=/^[A-Za-z].+?:\/\/.+?(?=\/|$)/,o=n.exec(e);let s,r;null!==o&&(s=o[0]);const i=n.exec(t);return null!==i&&(r=i[0]),void 0!==s&&void 0!==r&&s!==r}updateRequestUrl(e,t){return(0,s.__awaiter)(this,void 0,void 0,(function*(){var n,o;t.request="string"==typeof t.request?e:yield(n=e,o=t.request,(0,s.__awaiter)(void 0,void 0,void 0,(function*(){const e=o.headers.get("Content-Type")?yield o.blob():yield Promise.resolve(void 0),{method:t,headers:s,referrer:r,referrerPolicy:i,mode:a,credentials:l,cache:c,redirect:u,integrity:d,keepalive:h,signal:p}=o;return new Request(n,{method:t,headers:s,body:e,referrer:r,referrerPolicy:i,mode:a,credentials:l,cache:c,redirect:u,integrity:d,keepalive:h,signal:p})})))}))}getOptions(e){let t;return e.middlewareControl instanceof g&&(t=e.middlewareControl.getMiddlewareOptions(I)),void 0===t&&(t=Object.assign(new I,this.options)),t}executeWithRedirect(e,t,n){return(0,s.__awaiter)(this,void 0,void 0,(function*(){yield this.nextMiddleware.execute(e);const s=e.response;if(t<n.maxRedirects&&this.isRedirect(s)&&this.hasLocationHeader(s)&&n.shouldRedirect(s)){if(++t,s.status===P.STATUS_CODE_SEE_OTHER)e.options.method=o.GET,delete e.options.body;else{const t=this.getLocationHeader(s);!this.isRelativeURL(t)&&this.shouldDropAuthorizationHeader(s.url,t)&&delete e.options.headers[P.AUTHORIZATION_HEADER],yield this.updateRequestUrl(t,e)}yield this.executeWithRedirect(e,t,n)}}))}execute(e){return(0,s.__awaiter)(this,void 0,void 0,(function*(){const t=this.getOptions(e);return e.options.redirect=P.MANUAL_REDIRECT,C.updateFeatureUsageFlag(e,w.REDIRECT_HANDLER_ENABLED),yield this.executeWithRedirect(e,0,t)}))}setNext(e){this.nextMiddleware=e}}P.REDIRECT_STATUS_CODES=[301,302,303,307,308],P.STATUS_CODE_SEE_OTHER=303,P.LOCATION_HEADER="Location",P.AUTHORIZATION_HEADER="Authorization",P.MANUAL_REDIRECT="manual";class M{execute(e){return(0,s.__awaiter)(this,void 0,void 0,(function*(){const t="string"==typeof e.request?e.request:e.request.url;if(d(t)||e.customHosts&&h(t,e.customHosts)){let t=y(e.request,e.options,M.CLIENT_REQUEST_ID_HEADER);t||(t=m(),v(e.request,e.options,M.CLIENT_REQUEST_ID_HEADER,t));let n,o=`${M.PRODUCT_NAME}/3.0.7`;if(e.middlewareControl instanceof g&&(n=e.middlewareControl.getMiddlewareOptions(C)),n){const e=n.getFeatureUsage();o+=` (${M.FEATURE_USAGE_STRING}=${e})`}b(e.request,e.options,M.SDK_VERSION_HEADER,o)}else delete e.options.headers[M.CLIENT_REQUEST_ID_HEADER],delete e.options.headers[M.SDK_VERSION_HEADER];return yield this.nextMiddleware.execute(e)}))}setNext(e){this.nextMiddleware=e}}M.CLIENT_REQUEST_ID_HEADER="client-request-id",M.SDK_VERSION_HEADER="SdkVersion",M.PRODUCT_NAME="graph-js",M.FEATURE_USAGE_STRING="featureUsage";class x{static getDefaultMiddlewareChain(e){const t=[],n=new _(e),o=new A(new E),s=new M,r=new k;if(t.push(n),t.push(o),"object"==typeof process){const e=new P(new I);t.push(e)}return t.push(s),t.push(r),t}}!function(e){e[e.MANUAL=0]="MANUAL",e[e.RANDOM=1]="RANDOM"}(T||(T={}));class R{constructor(e=T.RANDOM,t="Some error Happened",n,o,s,r){if(this.chaosStrategy=e,this.statusCode=n,this.statusMessage=t,this.chaosPercentage=void 0!==o?o:10,this.responseBody=s,this.headers=r,this.chaosPercentage>100)throw new Error("Error Pecentage can not be more than 100")}}const D={GET:[429,500,502,503,504],POST:[429,500,502,503,504,507],PUT:[429,500,502,503,504,507],PATCH:[429,500,502,503,504],DELETE:[429,500,502,503,504,507]},O={100:"Continue",101:"Switching Protocols",102:"Processing",103:"Early Hints",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Too Early",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",510:"Not Extended",511:"Network Authentication Required"};class N{constructor(e=new R,t){this.options=e,this.manualMap=t}createResponseHeaders(e,t,n){const o=e.headers?new Headers(e.headers):new Headers;return o.append("Cache-Control","no-store"),o.append("request-id",t),o.append("client-request-id",t),o.append("x-ms-ags-diagnostic",""),o.append("Date",n),o.append("Strict-Transport-Security",""),429===e.statusCode&&o.append("retry-after","3"),o}createResponseBody(e,t,n){if(e.responseBody)return e.responseBody;let o;return o=e.statusCode>=400?{error:{code:O[e.statusCode],message:e.statusMessage,innerError:{"request-id":t,date:n}}}:{},o}createResponse(e,t){const n=t.request,o=m(),s=new Date,r=this.createResponseHeaders(e,o,s.toString()),i=this.createResponseBody(e,o,s.toString()),a={url:n,status:e.statusCode,statusText:e.statusMessage,headers:r};t.response=new Response("string"==typeof i?i:JSON.stringify(i),a)}sendRequest(e,t){return(0,s.__awaiter)(this,void 0,void 0,(function*(){this.setStatusCode(e,t.request,t.options.method),e.chaosStrategy===T.MANUAL&&!this.nextMiddleware||Math.floor(100*Math.random())<e.chaosPercentage?this.createResponse(e,t):this.nextMiddleware&&(yield this.nextMiddleware.execute(t))}))}getRandomStatusCode(e){const t=D[e];return t[Math.floor(Math.random()*t.length)]}getRelativeURL(e){const t=/https?:\/\/graph\.microsoft\.com\/[^/]+(.+?)(\?|$)/;let n;return null!==t.exec(e)&&(n=t.exec(e)[1]),n}setStatusCode(e,t,n){if(e.chaosStrategy===T.MANUAL){if(void 0===e.statusCode){const o=this.getRelativeURL(t);void 0!==this.manualMap.get(o)?void 0!==this.manualMap.get(o).get(n)&&(e.statusCode=this.manualMap.get(o).get(n)):this.manualMap.forEach(((t,s)=>{new RegExp(s+"$").test(o)&&void 0!==this.manualMap.get(s).get(n)&&(e.statusCode=this.manualMap.get(s).get(n))}))}}else e.statusCode=this.getRandomStatusCode(n)}getOptions(e){let t;return e.middlewareControl instanceof g&&(t=e.middlewareControl.getMiddlewareOptions(R)),void 0===t&&(t=Object.assign(new R,this.options)),t}execute(e){return(0,s.__awaiter)(this,void 0,void 0,(function*(){const t=this.getOptions(e);return yield this.sendRequest(t,e)}))}setNext(e){this.nextMiddleware=e}}var L,F,B,W;!function(e){e.ARRAYBUFFER="arraybuffer",e.BLOB="blob",e.DOCUMENT="document",e.JSON="json",e.RAW="raw",e.STREAM="stream",e.TEXT="text"}(L||(L={})),function(e){e.TEXT_HTML="text/html",e.TEXT_XML="text/xml",e.APPLICATION_XML="application/xml",e.APPLICATION_XHTML="application/xhtml+xml"}(F||(F={})),function(e){e.TEXT_PLAIN="text/plain",e.APPLICATION_JSON="application/json"}(B||(B={})),function(e){e.DOCUMENT="^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$",e.IMAGE="^image\\/.+"}(W||(W={}));class U{static parseDocumentResponse(e,t){return"undefined"!=typeof DOMParser?new Promise(((n,o)=>{e.text().then((e=>{try{const o=(new DOMParser).parseFromString(e,t);n(o)}catch(e){o(e)}}))})):Promise.resolve(e.body)}static convertResponse(e,t){return(0,s.__awaiter)(this,void 0,void 0,(function*(){if(204===e.status)return Promise.resolve();let n;const o=e.headers.get("Content-type");switch(t){case L.ARRAYBUFFER:n=yield e.arrayBuffer();break;case L.BLOB:n=yield e.blob();break;case L.DOCUMENT:n=yield U.parseDocumentResponse(e,F.TEXT_XML);break;case L.JSON:n=yield e.json();break;case L.STREAM:n=yield Promise.resolve(e.body);break;case L.TEXT:n=yield e.text();break;default:if(null!==o){const t=o.split(";")[0];n=new RegExp(W.DOCUMENT).test(t)?yield U.parseDocumentResponse(e,t):new RegExp(W.IMAGE).test(t)?e.blob():t===B.TEXT_PLAIN?yield e.text():t===B.APPLICATION_JSON?yield e.json():Promise.resolve(e.body)}else n=Promise.resolve(e.body)}return n}))}static getResponse(e,t,n){return(0,s.__awaiter)(this,void 0,void 0,(function*(){if(t===L.RAW)return Promise.resolve(e);{const o=yield U.convertResponse(e,t);if(!e.ok)throw o;if("function"!=typeof n)return o;n(null,o)}}))}}class G{constructor(e=-1,t=-1){this.minValue=e,this.maxValue=t}}class H{get location(){return this._location}set location(e){this._location=e}get responseBody(){return this._responseBody}set responseBody(e){this._responseBody=e}constructor(e,t){this._location=t,this._responseBody=e}static CreateUploadResult(e,t){return new H(e,t.get("location"))}}class q{static createUploadSession(e,t,n,o={}){return(0,s.__awaiter)(this,void 0,void 0,(function*(){const s=yield e.api(t).headers(o).post(n);return{url:s.uploadUrl,expiry:new Date(s.expirationDateTime),isCancelled:!1}}))}constructor(e,t,n,o={}){if(this.DEFAULT_FILE_SIZE=5242880,this.client=e,!t.sliceFile)throw new l("Please pass the FileUpload object, StreamUpload object or any custom implementation of the FileObject interface");this.file=t,this.file=t,o.rangeSize||(o.rangeSize=this.DEFAULT_FILE_SIZE),this.options=o,this.uploadSession=n,this.nextRange=new G(0,this.options.rangeSize-1)}parseRange(e){const t=e[0];if(void 0===t||""===t)return new G;const n=t.split("-"),o=parseInt(n[0],10);let s=parseInt(n[1],10);return Number.isNaN(s)&&(s=this.file.size-1),new G(o,s)}updateTaskStatus(e){this.uploadSession.expiry=new Date(e.expirationDateTime),this.nextRange=this.parseRange(e.nextExpectedRanges)}getNextRange(){if(-1===this.nextRange.minValue)return this.nextRange;const e=this.nextRange.minValue;let t=e+this.options.rangeSize-1;return t>=this.file.size&&(t=this.file.size-1),new G(e,t)}sliceFile(e){if(console.warn("The LargeFileUploadTask.sliceFile() function has been deprecated and moved into the FileObject interface."),this.file.content instanceof ArrayBuffer||this.file.content instanceof Blob||this.file.content instanceof Uint8Array)return this.file.content.slice(e.minValue,e.maxValue+1);throw new l("The LargeFileUploadTask.sliceFile() function expects only Blob, ArrayBuffer or Uint8Array file content. Please note that the sliceFile() function is deprecated.")}upload(){return(0,s.__awaiter)(this,void 0,void 0,(function*(){const e=this.options&&this.options.uploadEventHandlers;for(;!this.uploadSession.isCancelled;){const t=this.getNextRange();if(-1===t.maxValue){const e=new Error("Task with which you are trying to upload is already completed, Please check for your uploaded file");throw e.name="Invalid Session",e}const n=yield this.file.sliceFile(t),o=yield this.uploadSliceGetRawResponse(n,t,this.file.size);if(!o)throw new l("Something went wrong! Large file upload slice response is null.");const s=yield U.getResponse(o);if(201===o.status||200===o.status&&s.id)return this.reportProgress(e,t),H.CreateUploadResult(s,o.headers);const r={expirationDateTime:s.expirationDateTime||s.ExpirationDateTime,nextExpectedRanges:s.NextExpectedRanges||s.nextExpectedRanges};this.updateTaskStatus(r),this.reportProgress(e,t)}}))}reportProgress(e,t){e&&e.progress&&e.progress(t,e.extraCallbackParam)}uploadSlice(e,t,n){return(0,s.__awaiter)(this,void 0,void 0,(function*(){return yield this.client.api(this.uploadSession.url).headers({"Content-Length":""+(t.maxValue-t.minValue+1),"Content-Range":`bytes ${t.minValue}-${t.maxValue}/${n}`,"Content-Type":"application/octet-stream"}).put(e)}))}uploadSliceGetRawResponse(e,t,n){return(0,s.__awaiter)(this,void 0,void 0,(function*(){return yield this.client.api(this.uploadSession.url).headers({"Content-Length":""+(t.maxValue-t.minValue+1),"Content-Range":`bytes ${t.minValue}-${t.maxValue}/${n}`,"Content-Type":"application/octet-stream"}).responseType(L.RAW).put(e)}))}cancel(){return(0,s.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.client.api(this.uploadSession.url).responseType(L.RAW).delete();return 204===e.status&&(this.uploadSession.isCancelled=!0),e}))}getStatus(){return(0,s.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.client.api(this.uploadSession.url).get();return this.updateTaskStatus(e),e}))}resume(){return(0,s.__awaiter)(this,void 0,void 0,(function*(){return yield this.getStatus(),yield this.upload()}))}getUploadSession(){return this.uploadSession}}class ${constructor(e,t,n){if(this.content=e,this.name=t,this.size=n,!e||!t||!n)throw new l("Please provide the upload content, name of the file and size of the file")}sliceFile(e){return this.content.slice(e.minValue,e.maxValue+1)}}const V=(e=5242880)=>{const t=62914560;return e>t&&(e=t),(n=e)>327680&&(n=320*Math.floor(n/327680)*1024),n;var n};class z extends q{static constructCreateSessionUrl(e,t=z.DEFAULT_UPLOAD_PATH){return e=e.trim(),""===(t=t.trim())&&(t="/"),"/"!==t[0]&&(t=`/${t}`),"/"!==t[t.length-1]&&(t=`${t}/`),`/me/drive/root:${t.split("/").map((e=>encodeURIComponent(e))).join("/")}${encodeURIComponent(e)}:/createUploadSession`}static getFileInfo(e,t){let n,o;if("undefined"!=typeof Blob&&e instanceof Blob)n=new File([e],t),o=n.size;else if("undefined"!=typeof File&&e instanceof File)n=e,o=n.size;else if("undefined"!=typeof Uint8Array&&e instanceof Uint8Array){const t=e;o=t.byteLength,n=t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}return{content:n,size:o}}static create(e,t,n){return(0,s.__awaiter)(this,void 0,void 0,(function*(){if(!e||!t||!n)throw new l("Please provide the Graph client instance, file object and OneDriveLargeFileUploadOptions value");const o=n.fileName,s=z.getFileInfo(t,o),r=new $(s.content,o,s.size);return this.createTaskWithFileObject(e,r,n)}))}static createTaskWithFileObject(e,t,n){return(0,s.__awaiter)(this,void 0,void 0,(function*(){if(!e||!t||!n)throw new l("Please provide the Graph client instance, FileObject interface implementation and OneDriveLargeFileUploadOptions value");const o=n.uploadSessionURL?n.uploadSessionURL:z.constructCreateSessionUrl(n.fileName,n.path),s={fileName:n.fileName,fileDescription:n.fileDescription,conflictBehavior:n.conflictBehavior},r=yield z.createUploadSession(e,o,s),i=V(n.rangeSize);return new z(e,t,r,{rangeSize:i,uploadEventHandlers:n.uploadEventHandlers})}))}static createUploadSession(e,t,n){const o=Object.create(null,{createUploadSession:{get:()=>super.createUploadSession}});return(0,s.__awaiter)(this,void 0,void 0,(function*(){const s={item:{"@microsoft.graph.conflictBehavior":(null==n?void 0:n.conflictBehavior)||"rename",name:null==n?void 0:n.fileName,description:null==n?void 0:n.fileDescription}};return o.createUploadSession.call(this,e,t,s)}))}constructor(e,t,n,o){super(e,t,n,o)}commit(e,t="rename"){return(0,s.__awaiter)(this,void 0,void 0,(function*(){const n={name:this.file.name,"@microsoft.graph.conflictBehavior":t,"@microsoft.graph.sourceUrl":this.uploadSession.url};return yield this.client.api(e).put(n)}))}}z.DEFAULT_UPLOAD_PATH="/";class j{constructor(e,t,n){if(this.content=e,this.name=t,this.size=n,!e||!t||!n)throw new l("Please provide the Readable Stream content, name of the file and size of the file")}sliceFile(e){return(0,s.__awaiter)(this,void 0,void 0,(function*(){let t=e.maxValue-e.minValue+1;const n=[];if(this.previousSlice){if(e.minValue<this.previousSlice.range.minValue)throw new l("An error occurred while uploading the stream. Please restart the stream upload from the first byte of the file.");if(e.minValue<this.previousSlice.range.maxValue){const o=this.previousSlice.range.minValue,s=this.previousSlice.range.maxValue;if(e.minValue===o&&e.maxValue===s)return this.previousSlice.fileSlice;if(e.maxValue===s)return this.previousSlice.fileSlice.slice(e.minValue,e.maxValue+1);n.push(this.previousSlice.fileSlice.slice(e.minValue,s+1)),t=e.maxValue-s}}if(!this.content||!this.content.readable)throw new l("Stream is not readable.");this.content.readableLength>=t?n.push(this.content.read(t)):n.push(yield this.readNBytesFromStream(t));const o=Buffer.concat(n);return this.previousSlice={fileSlice:o,range:e},o}))}readNBytesFromStream(e){return new Promise(((t,n)=>{const o=[];let s=e,r=0;this.content.on("end",(()=>{if(s>0)return n(new l("Stream ended before reading required range size"))})),this.content.on("readable",(()=>{let i;for(;r<e&&null!==(i=this.content.read(s));)r+=i.length,o.push(i),s>0&&(s=e-r);return r===e?t(Buffer.concat(o)):this.content&&this.content.readable?void 0:n(new l("Error encountered while reading the stream during the upload"))}))}))}}class Q{constructor(e,t,n,o){this.client=e,this.collection=t.value,this.nextLink=t["@odata.nextLink"],this.deltaLink=t["@odata.deltaLink"],this.callback=n,this.cursor=0,this.complete=!1,this.requestOptions=o}iterationHelper(){if(void 0===this.collection)return!1;let e=!0;for(;e&&this.cursor<this.collection.length;){const t=this.collection[this.cursor];e=this.callback(t),this.cursor++}return e}fetchAndUpdateNextPageData(){return(0,s.__awaiter)(this,void 0,void 0,(function*(){let e=this.client.api(this.nextLink);this.requestOptions&&(this.requestOptions.headers&&(e=e.headers(this.requestOptions.headers)),this.requestOptions.middlewareOptions&&(e=e.middlewareOptions(this.requestOptions.middlewareOptions)),this.requestOptions.options&&(e=e.options(this.requestOptions.options)));const t=yield e.get();this.collection=t.value,this.cursor=0,this.nextLink=t["@odata.nextLink"],this.deltaLink=t["@odata.deltaLink"]}))}getDeltaLink(){return this.deltaLink}iterate(){return(0,s.__awaiter)(this,void 0,void 0,(function*(){let e=this.iterationHelper();for(;e;)void 0!==this.nextLink?(yield this.fetchAndUpdateNextPageData(),e=this.iterationHelper()):e=!1;void 0===this.nextLink&&this.cursor>=this.collection.length&&(this.complete=!0)}))}resume(){return(0,s.__awaiter)(this,void 0,void 0,(function*(){return this.iterate()}))}isComplete(){return this.complete}}class J{constructor(e){this.provider=e}getAccessToken(){return(0,s.__awaiter)(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{this.provider(((n,o)=>(0,s.__awaiter)(this,void 0,void 0,(function*(){if(o)e(o);else{n||(n=new l("Access token is undefined or empty.\t\t\t\t\t\tPlease provide a valid token.\t\t\t\t\t\tFor more help - https://github.com/microsoftgraph/msgraph-sdk-javascript/blob/dev/docs/CustomAuthenticationProvider.md"));const e=yield l.setGraphClientError(n);t(e)}}))))}))}))}}class K extends Error{constructor(e=-1,t,n){super(t||n&&n.message),Object.setPrototypeOf(this,K.prototype),this.statusCode=e,this.code=null,this.requestId=null,this.date=new Date,this.body=null,this.stack=n?n.stack:this.stack}}class Y{static constructError(e,t,n){const o=new K(t,"",e);return void 0!==e.name&&(o.code=e.name),o.body=e.toString(),o.date=new Date,o.headers=null==n?void 0:n.headers,o}static constructErrorFromResponse(e,t,n){const o=e.error,s=new K(t,o.message);return s.code=o.code,void 0!==o.innerError&&(s.requestId=o.innerError["request-id"],s.date=new Date(o.innerError.date)),s.body=JSON.stringify(o),s.headers=null==n?void 0:n.headers,s}static getError(e=null,t=-1,n,o){return(0,s.__awaiter)(this,void 0,void 0,(function*(){let s;if(e&&e.error?s=Y.constructErrorFromResponse(e,t,o):e instanceof Error?s=Y.constructError(e,t,o):(s=new K(t),s.body=e),"function"!=typeof n)return s;n(s,null)}))}}class X{constructor(e,t,n){this.parsePath=e=>{if(-1!==e.indexOf("https://")){const t=(e=e.replace("https://","")).indexOf("/");-1!==t&&(this.urlComponents.host="https://"+e.substring(0,t),e=e.substring(t+1,e.length));const n=e.indexOf("/");-1!==n&&(this.urlComponents.version=e.substring(0,n),e=e.substring(n+1,e.length))}"/"===e.charAt(0)&&(e=e.substr(1));const t=e.indexOf("?");if(-1===t)this.urlComponents.path=e;else{this.urlComponents.path=e.substr(0,t);const n=e.substring(t+1,e.length).split("&");for(const e of n)this.parseQueryParameter(e)}},this.httpClient=e,this.config=t,this.urlComponents={host:this.config.baseUrl,version:this.config.defaultVersion,oDataQueryParams:{},otherURLQueryParams:{},otherURLQueryOptions:[]},this._headers={},this._options={},this._middlewareOptions=[],this.parsePath(n)}addCsvQueryParameter(e,t,n){this.urlComponents.oDataQueryParams[e]=this.urlComponents.oDataQueryParams[e]?this.urlComponents.oDataQueryParams[e]+",":"";let o=[];n.length>1&&"string"==typeof t?o=Array.prototype.slice.call(n):"string"==typeof t?o.push(t):o=o.concat(t),this.urlComponents.oDataQueryParams[e]+=o.join(",")}buildFullUrl(){const e=(e=>{const t=e=>e.replace(/^\/+/,"");return Array.prototype.slice.call(e).reduce(((e,n)=>{return[(o=e,o.replace(/\/+$/,"")),t(n)].join("/");var o}))})([this.urlComponents.host,this.urlComponents.version,this.urlComponents.path])+this.createQueryString();return this.config.debugLogging&&console.log(e),e}createQueryString(){const e=this.urlComponents,t=[];if(0!==Object.keys(e.oDataQueryParams).length)for(const n in e.oDataQueryParams)Object.prototype.hasOwnProperty.call(e.oDataQueryParams,n)&&t.push(n+"="+e.oDataQueryParams[n]);if(0!==Object.keys(e.otherURLQueryParams).length)for(const n in e.otherURLQueryParams)Object.prototype.hasOwnProperty.call(e.otherURLQueryParams,n)&&t.push(n+"="+e.otherURLQueryParams[n]);if(0!==e.otherURLQueryOptions.length)for(const n of e.otherURLQueryOptions)t.push(n);return t.length>0?"?"+t.join("&"):""}parseQueryParameter(e){if("string"==typeof e)if("?"===e.charAt(0)&&(e=e.substring(1)),-1!==e.indexOf("&")){const t=e.split("&");for(const e of t)this.parseQueryParamenterString(e)}else this.parseQueryParamenterString(e);else if(e.constructor===Object)for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&this.setURLComponentsQueryParamater(t,e[t]);return this}parseQueryParamenterString(e){if(this.isValidQueryKeyValuePair(e)){const t=e.indexOf("="),n=e.substring(0,t),o=e.substring(t+1);this.setURLComponentsQueryParamater(n,o)}else this.urlComponents.otherURLQueryOptions.push(e)}setURLComponentsQueryParamater(e,t){if(-1!==c.indexOf(e)){const n=this.urlComponents.oDataQueryParams[e],o=n&&("$expand"===e||"$select"===e||"$orderby"===e);this.urlComponents.oDataQueryParams[e]=o?n+","+t:t}else this.urlComponents.otherURLQueryParams[e]=t}isValidQueryKeyValuePair(e){const t=e.indexOf("=");return-1!==t&&!(-1!==e.indexOf("(")&&e.indexOf("(")<t)}updateRequestOptions(e){const t=Object.assign({},e.headers);if(void 0!==this.config.fetchOptions){const t=Object.assign({},this.config.fetchOptions);Object.assign(e,t),void 0!==typeof this.config.fetchOptions.headers&&(e.headers=Object.assign({},this.config.fetchOptions.headers))}Object.assign(e,this._options),void 0!==e.headers&&Object.assign(t,e.headers),Object.assign(t,this._headers),e.headers=t}send(e,t,n){var o;return(0,s.__awaiter)(this,void 0,void 0,(function*(){let s;const r=new g(this._middlewareOptions);this.updateRequestOptions(t);const i=null===(o=this.config)||void 0===o?void 0:o.customHosts;try{return s=(yield this.httpClient.sendRequest({request:e,options:t,middlewareControl:r,customHosts:i})).response,yield U.getResponse(s,this._responseType,n)}catch(e){if(e instanceof l)throw e;let t;throw s&&(t=s.status),yield Y.getError(e,t,n,s)}}))}setHeaderContentType(){if(!this._headers)return void this.header("Content-Type","application/json");const e=Object.keys(this._headers);for(const t of e)if("content-type"===t.toLowerCase())return;this.header("Content-Type","application/json")}header(e,t){return this._headers[e]=t,this}headers(e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._headers[t]=e[t]);return this}option(e,t){return this._options[e]=t,this}options(e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._options[t]=e[t]);return this}middlewareOptions(e){return this._middlewareOptions=e,this}version(e){return this.urlComponents.version=e,this}responseType(e){return this._responseType=e,this}select(e){return this.addCsvQueryParameter("$select",e,arguments),this}expand(e){return this.addCsvQueryParameter("$expand",e,arguments),this}orderby(e){return this.addCsvQueryParameter("$orderby",e,arguments),this}filter(e){return this.urlComponents.oDataQueryParams.$filter=e,this}search(e){return this.urlComponents.oDataQueryParams.$search=e,this}top(e){return this.urlComponents.oDataQueryParams.$top=e,this}skip(e){return this.urlComponents.oDataQueryParams.$skip=e,this}skipToken(e){return this.urlComponents.oDataQueryParams.$skipToken=e,this}count(e=!0){return this.urlComponents.oDataQueryParams.$count=e.toString(),this}query(e){return this.parseQueryParameter(e)}get(e){return(0,s.__awaiter)(this,void 0,void 0,(function*(){const t=this.buildFullUrl(),n={method:o.GET};return yield this.send(t,n,e)}))}post(e,t){return(0,s.__awaiter)(this,void 0,void 0,(function*(){const n=this.buildFullUrl(),s={method:o.POST,body:u(e)};return"FormData"===(e&&e.constructor&&e.constructor.name)?s.headers={}:(this.setHeaderContentType(),s.headers=this._headers),yield this.send(n,s,t)}))}create(e,t){return(0,s.__awaiter)(this,void 0,void 0,(function*(){return yield this.post(e,t)}))}put(e,t){return(0,s.__awaiter)(this,void 0,void 0,(function*(){const n=this.buildFullUrl();this.setHeaderContentType();const s={method:o.PUT,body:u(e)};return yield this.send(n,s,t)}))}patch(e,t){return(0,s.__awaiter)(this,void 0,void 0,(function*(){const n=this.buildFullUrl();this.setHeaderContentType();const s={method:o.PATCH,body:u(e)};return yield this.send(n,s,t)}))}update(e,t){return(0,s.__awaiter)(this,void 0,void 0,(function*(){return yield this.patch(e,t)}))}delete(e){return(0,s.__awaiter)(this,void 0,void 0,(function*(){const t=this.buildFullUrl(),n={method:o.DELETE};return yield this.send(t,n,e)}))}del(e){return(0,s.__awaiter)(this,void 0,void 0,(function*(){return yield this.delete(e)}))}getStream(e){return(0,s.__awaiter)(this,void 0,void 0,(function*(){const t=this.buildFullUrl(),n={method:o.GET};return this.responseType(L.STREAM),yield this.send(t,n,e)}))}putStream(e,t){return(0,s.__awaiter)(this,void 0,void 0,(function*(){const n=this.buildFullUrl(),s={method:o.PUT,headers:{"Content-Type":"application/octet-stream"},body:e};return yield this.send(n,s,t)}))}}class Z{constructor(...e){if(!e||!e.length){const e=new Error;throw e.name="InvalidMiddlewareChain",e.message="Please provide a default middleware chain or custom middleware chain",e}this.setMiddleware(...e)}setMiddleware(...e){e.length>1?this.parseMiddleWareArray(e):this.middleware=e[0]}parseMiddleWareArray(e){e.forEach(((t,n)=>{n<e.length-1&&t.setNext(e[n+1])})),this.middleware=e[0]}sendRequest(e){return(0,s.__awaiter)(this,void 0,void 0,(function*(){if("string"==typeof e.request&&void 0===e.options){const e=new Error;throw e.name="InvalidRequestOptions",e.message="Unable to execute the middleware, Please provide valid options for a request",e}return yield this.middleware.execute(e),e}))}}class ee{static createWithAuthenticationProvider(e){const t=new _(e),n=new A(new E),o=new M,s=new k;if(t.setNext(n),"object"==typeof process){const e=new P(new I);n.setNext(e),e.setNext(o)}else n.setNext(o);return o.setNext(s),ee.createWithMiddleware(t)}static createWithMiddleware(...e){return new Z(...e)}}class te{static init(e){const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]="authProvider"===n?new J(e[n]):e[n]);return te.initWithMiddleware(t)}static initWithMiddleware(e){return new te(e)}constructor(e){this.config={baseUrl:"https://graph.microsoft.com/",debugLogging:!1,defaultVersion:"v1.0"},(()=>{if("undefined"==typeof Promise&&"undefined"==typeof fetch){const e=new Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");throw e.name="PolyFillNotAvailable",e}if("undefined"==typeof Promise){const e=new Error("Library cannot function without Promise. So, please provide polyfill for it.");throw e.name="PolyFillNotAvailable",e}if("undefined"==typeof fetch){const e=new Error("Library cannot function without fetch. So, please provide polyfill for it.");throw e.name="PolyFillNotAvailable",e}})();for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this.config[t]=e[t]);let t;if(void 0!==e.authProvider&&void 0!==e.middleware){const e=new Error;throw e.name="AmbiguityInInitialization",e.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both",e}if(void 0!==e.authProvider)t=ee.createWithAuthenticationProvider(e.authProvider);else{if(void 0===e.middleware){const e=new Error;throw e.name="InvalidMiddlewareChain",e.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain",e}t=new Z(...[].concat(e.middleware))}this.httpClient=t}api(e){return new X(this.httpClient,this.config,e)}}},73172:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CustomAuthenticationProvider=void 0;var o=n(5866),s=n(63465),r=function(){function e(e){this.provider=e}return e.prototype.getAccessToken=function(){return o.__awaiter(this,void 0,void 0,(function(){var e=this;return o.__generator(this,(function(t){return[2,new Promise((function(t,n){e.provider((function(r,i){return o.__awaiter(e,void 0,void 0,(function(){var e;return o.__generator(this,(function(o){switch(o.label){case 0:return i?(t(i),[3,3]):[3,1];case 1:return r||(r=new s.GraphClientError("Access token is undefined or empty.\t\t\t\t\t\tPlease provide a valid token.\t\t\t\t\t\tFor more help - https://github.com/microsoftgraph/msgraph-sdk-javascript/blob/dev/docs/CustomAuthenticationProvider.md")),[4,s.GraphClientError.setGraphClientError(r)];case 2:e=o.sent(),n(e),o.label=3;case 3:return[2]}}))}))}))}))]}))}))},e}();t.CustomAuthenticationProvider=r},63465:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GraphClientError=void 0;var o=n(5866),s=function(e){function t(n){var o=e.call(this,n)||this;return Object.setPrototypeOf(o,t.prototype),o}return o.__extends(t,e),t.setGraphClientError=function(e){var n;return e instanceof Error?n=e:(n=new t).customError=e,n},t}(Error);t.GraphClientError=s},96675:(e,t,n)=>{"use strict";var o;n.d(t,{q:()=>l}),function(e){var t,n=0;e.getNext=function(){return void 0===t&&(t=function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=[],n=0;n<22;n++)t.push(e.charAt(Math.floor(64*Math.random())));return t.join("")}()),new o(t,++n)},e.getNextChild=function(e){return new o(e.getString(),++e.nextChild)};var o=function(){function e(e,t){this.base=e,this.id=t,this.nextChild=0}return e.prototype.getString=function(){return this.base+"."+this.id},e}();e.CV=o}(o||(o={}));var s=n(21681),r=function(e,t,n,o){return new(n||(n=Promise))((function(s,r){function i(e){try{l(o.next(e))}catch(e){r(e)}}function a(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))},i=function(e,t){var n,o,s,r,i={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(s=2&r[0]?o.return:r[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,r[1])).done)return s;switch(o=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return i.label++,{value:r[1],done:!1};case 5:i.label++,o=r[1],r=[0];continue;case 7:r=i.ops.pop(),i.trys.pop();continue;default:if(!((s=(s=i.trys).length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){i=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){i.label=r[1];break}if(6===r[0]&&i.label<s[1]){i.label=s[1],s=r;break}if(s&&i.label<s[2]){i.label=s[2],i.ops.push(r);break}s[2]&&i.ops.pop(),i.trys.pop();continue}r=t.call(e,i)}catch(e){r=[6,e],o=0}finally{n=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},a=function(){return 1e3*Date.now()};"object"==typeof window&&"object"==typeof window.performance&&"now"in window.performance&&(a=function(){return 1e3*Math.floor(window.performance.now())});var l=function(){function e(e,t,n){this._optionalEventFlags={},this._ended=!1,this._telemetryLogger=e,this._activityName=t,this._cv=n?o.getNextChild(n._cv):o.getNext(),this._dataFields=[],this._success=void 0,this._startTime=a()}return e.createNew=function(t,n){return new e(t,n)},e.prototype.createChildActivity=function(t){return new e(this._telemetryLogger,t,this)},e.prototype.setEventFlags=function(e){this._optionalEventFlags=e},e.prototype.addDataField=function(e){this._dataFields.push(e)},e.prototype.addDataFields=function(e){var t;(t=this._dataFields).push.apply(t,e)},e.prototype.setSuccess=function(e){this._success=e},e.prototype.setResult=function(e,t,n){this._result={code:e,type:t,tag:n}},e.prototype.endNow=function(){if(!this._ended){void 0===this._success&&void 0===this._result&&(0,s.wC)(s.$b.Warning,s.b7.Core,(function(){return"Activity does not have success or result set"}));var e=a()-this._startTime;this._ended=!0;var t={duration:e,count:1,aggMode:0,cV:this._cv.getString(),success:this._success,result:this._result};return this._telemetryLogger.sendActivity(this._activityName,t,this._dataFields,this._optionalEventFlags)}(0,s.wC)(s.$b.Error,s.b7.Core,(function(){return"Activity has already ended"}))},e.prototype.executeAsync=function(e){return r(this,void 0,void 0,(function(){var t=this;return i(this,(function(n){return[2,e(this).then((function(e){return t.endNow(),e})).catch((function(e){throw t.endNow(),e}))]}))}))},e.prototype.executeSync=function(e){try{var t=e(this);return this.endNow(),t}catch(e){throw this.endNow(),e}},e.prototype.executeChildActivityAsync=function(e,t){return r(this,void 0,void 0,(function(){return i(this,(function(n){return[2,this.createChildActivity(e).executeAsync(t)]}))}))},e.prototype.executeChildActivitySync=function(e,t){return this.createChildActivity(e).executeSync(t)},e}()},82101:(e,t,n)=>{"use strict";n.d(t,{w:()=>s});var o=n(30227);function s(e,t,n){e.push((0,o.m9)("zC."+t,n))}},96550:(e,t,n)=>{"use strict";n.d(t,{P:()=>s});var o=n(82101);function s(e,t,n){var s=n.map((function(t){return{name:e+"."+t.name,value:t.value,dataType:t.dataType}}));return(0,o.w)(s,e,t),s}},9751:(e,t,n)=>{"use strict";var o;n.d(t,{p:()=>o}),function(e){e[e.EssentialServiceMetadata=1]="EssentialServiceMetadata",e[e.AccountData=2]="AccountData",e[e.SystemMetadata=4]="SystemMetadata",e[e.OrganizationIdentifiableInformation=8]="OrganizationIdentifiableInformation",e[e.EndUserIdentifiableInformation=16]="EndUserIdentifiableInformation",e[e.CustomerContent=32]="CustomerContent",e[e.AccessControl=64]="AccessControl"}(o||(o={}))},54243:()=>{},30227:(e,t,n)=>{"use strict";n.d(t,{LK:()=>r,Ug:()=>i,ip:()=>a,k:()=>c,m9:()=>l});var o=n(37435),s=n(9751);function r(e,t){return{name:e,dataType:o.b.Boolean,value:t,classification:s.p.SystemMetadata}}function i(e,t){return{name:e,dataType:o.b.Int64,value:t,classification:s.p.SystemMetadata}}function a(e,t){return{name:e,dataType:o.b.Double,value:t,classification:s.p.SystemMetadata}}function l(e,t){return{name:e,dataType:o.b.String,value:t,classification:s.p.SystemMetadata}}function c(e,t){return{name:e,dataType:o.b.Guid,value:t,classification:s.p.SystemMetadata}}},37435:(e,t,n)=>{"use strict";var o;n.d(t,{b:()=>o}),function(e){e[e.String=0]="String",e[e.Boolean=1]="Boolean",e[e.Int64=2]="Int64",e[e.Double=3]="Double",e[e.Guid=4]="Guid"}(o||(o={}))},75255:(e,t,n)=>{"use strict";n.d(t,{J:()=>o});var o=function(){function e(){this._listeners=[]}return e.prototype.fireEvent=function(e){this._listeners.forEach((function(t){return t(e)}))},e.prototype.addListener=function(e){e&&this._listeners.push(e)},e.prototype.removeListener=function(e){this._listeners=this._listeners.filter((function(t){return t!==e}))},e.prototype.getListenerCount=function(){return this._listeners.length},e}()},97131:(e,t,n)=>{"use strict";n.d(t,{H:()=>r});var o=n(81701),s=n(21681);function r(e){var t={costPriority:o.Mx.Normal,samplingPolicy:o.A2.Measure,persistencePriority:o.qu.Normal,dataCategories:o.b5.NotSet,diagnosticLevel:o.EP.FullEvent};return e.eventFlags&&e.eventFlags.dataCategories||(0,s.wC)(s.$b.Error,s.b7.Core,(function(){return"Event is missing DataCategories event flag"})),e.eventFlags?(e.eventFlags.costPriority&&(t.costPriority=e.eventFlags.costPriority),e.eventFlags.samplingPolicy&&(t.samplingPolicy=e.eventFlags.samplingPolicy),e.eventFlags.persistencePriority&&(t.persistencePriority=e.eventFlags.persistencePriority),e.eventFlags.dataCategories&&(t.dataCategories=e.eventFlags.dataCategories),e.eventFlags.diagnosticLevel&&(t.diagnosticLevel=e.eventFlags.diagnosticLevel),t):t}},81701:(e,t,n)=>{"use strict";var o,s,r,i,a;n.d(t,{A2:()=>o,EP:()=>a,Mx:()=>r,b5:()=>i,qu:()=>s}),function(e){e[e.NotSet=0]="NotSet",e[e.Measure=1]="Measure",e[e.Diagnostics=2]="Diagnostics",e[e.CriticalBusinessImpact=191]="CriticalBusinessImpact",e[e.CriticalCensus=192]="CriticalCensus",e[e.CriticalExperimentation=193]="CriticalExperimentation",e[e.CriticalUsage=194]="CriticalUsage"}(o||(o={})),function(e){e[e.NotSet=0]="NotSet",e[e.Normal=1]="Normal",e[e.High=2]="High"}(s||(s={})),function(e){e[e.NotSet=0]="NotSet",e[e.Normal=1]="Normal",e[e.High=2]="High"}(r||(r={})),function(e){e[e.NotSet=0]="NotSet",e[e.SoftwareSetup=1]="SoftwareSetup",e[e.ProductServiceUsage=2]="ProductServiceUsage",e[e.ProductServicePerformance=4]="ProductServicePerformance",e[e.DeviceConfiguration=8]="DeviceConfiguration",e[e.InkingTypingSpeech=16]="InkingTypingSpeech"}(i||(i={})),function(e){e[e.ReservedDoNotUse=0]="ReservedDoNotUse",e[e.BasicEvent=10]="BasicEvent",e[e.FullEvent=100]="FullEvent",e[e.NecessaryServiceDataEvent=110]="NecessaryServiceDataEvent",e[e.AlwaysOnNecessaryServiceDataEvent=120]="AlwaysOnNecessaryServiceDataEvent"}(a||(a={}))},21681:(e,t,n)=>{"use strict";n.d(t,{$b:()=>o,b7:()=>s,d$:()=>i,vV:()=>l,wC:()=>a});var o,s,r=new(n(75255).J);function i(){return r}function a(e,t,n){r.fireEvent({level:e,category:t,message:n})}function l(e,t,n){a(o.Error,e,(function(){var e=n instanceof Error?n.message:"";return t+": "+e}))}!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(o||(o={})),function(e){e[e.Core=0]="Core",e[e.Sink=1]="Sink",e[e.Transport=2]="Transport"}(s||(s={}))},49068:()=>{},80889:(e,t,n)=>{"use strict";n.d(t,{G:()=>p,d:()=>h});var o,s,r=n(57118),i=n(21681);!function(e){e[e.Aria=0]="Aria",e[e.Nexus=1]="Nexus"}(o||(o={})),function(e){var t={},n={},s={};function r(e){if("object"!=typeof e)throw new Error("tokenTree must be an object");s=u(s,e)}function a(e){if(t[e])return t[e];var n=c(e,o.Aria);return"string"==typeof n?(t[e]=n,n):void 0}function l(e){if(n[e])return n[e];var t=c(e,o.Nexus);return"number"==typeof t?(n[e]=t,t):void 0}function c(e,t){var n=e.split("."),r=s,i=void 0;if(r){for(var a=0;a<n.length-1;a++)r[n[a]]&&(r=r[n[a]],t===o.Aria&&"string"==typeof r.ariaTenantToken?i=r.ariaTenantToken:t===o.Nexus&&"number"==typeof r.nexusTenantToken&&(i=r.nexusTenantToken));return i}}function u(e,t){if("object"!=typeof t)return t;for(var n=0,o=Object.keys(t);n<o.length;n++){var s=o[n];s in e&&(e[s],1)?e[s]=u(e[s],t[s]):e[s]=t[s]}return e}e.setTenantToken=function(e,t,n){var o=e.split(".");if(o.length<2||"Office"!==o[0])(0,i.wC)(i.$b.Error,i.b7.Core,(function(){return"Invalid namespace: "+e}));else{var s=Object.create(Object.prototype);t&&(s.ariaTenantToken=t),n&&(s.nexusTenantToken=n);var a,l=s;for(a=o.length-1;a>=0;--a){var c=Object.create(Object.prototype);c[o[a]]=l,l=c}r(l)}},e.setTenantTokens=r,e.getTenantTokens=function(e){var t=a(e),n=l(e);if(!n||!t)throw new Error("Could not find tenant token for "+e);return{ariaTenantToken:t,nexusTenantToken:n}},e.getAriaTenantToken=a,e.getNexusTenantToken=l,e.clear=function(){t={},n={},s={}}}(s||(s={}));var a,l=n(37435);!function(e){var t=-9007199254740991,n=9007199254740991,o=/^[A-Z][a-zA-Z0-9]*$/,s=/^[a-zA-Z0-9_\.]*$/;function r(e){return void 0!==e&&s.test(e)}function i(e){if(!((t=e.name)&&r(t)&&t.length+5<100))throw new Error("Invalid dataField name");var t;e.dataType===l.b.Int64&&a(e.value)}function a(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<t||e>n)throw new Error("Invalid integer "+JSON.stringify(e))}e.validateTelemetryEvent=function(e){if(!function(e){if(!e||e.length>98)return!1;var t,n=e.split("."),s=n[n.length-1];return function(e){return!!e&&e.length>=3&&"Office"===e[0]}(n)&&(void 0!==(t=s)&&o.test(t))}(e.eventName))throw new Error("Invalid eventName");if(e.eventContract&&!r(e.eventContract.name))throw new Error("Invalid eventContract");if(null!=e.dataFields)for(var t=0;t<e.dataFields.length;t++)i(e.dataFields[t])},e.validateInt=a}(a||(a={}));var c=n(75255),u=n(30227),d=function(){return d=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},d.apply(this,arguments)},h=-1,p=function(){function e(e,t,n){var o,s;this.onSendEvent=new c.J,this.persistentDataFields=[],this.config=n||{},e&&(this.onSendEvent=e.onSendEvent,(o=this.persistentDataFields).push.apply(o,e.persistentDataFields),this.config=d(d({},e.getConfig()),this.config)),t&&(s=this.persistentDataFields).push.apply(s,t)}return e.prototype.sendTelemetryEvent=function(e){var t;try{if(0===this.onSendEvent.getListenerCount())return void(0,i.wC)(i.$b.Warning,i.b7.Core,(function(){return"No telemetry sinks are attached."}));t=this.cloneEvent(e),this.processTelemetryEvent(t)}catch(e){return void(0,i.vV)(i.b7.Core,"SendTelemetryEvent",e)}try{this.onSendEvent.fireEvent(t)}catch(e){}},e.prototype.processTelemetryEvent=function(e){var t;e.telemetryProperties||(e.telemetryProperties=s.getTenantTokens(e.eventName)),e.dataFields&&(e.dataFields.unshift((0,u.m9)("OTelJS.Version","3.1.74")),this.persistentDataFields&&(t=e.dataFields).unshift.apply(t,this.persistentDataFields)),this.config.disableValidation||a.validateTelemetryEvent(e)},e.prototype.addSink=function(e){this.onSendEvent.addListener((function(t){return e.sendTelemetryEvent(t)}))},e.prototype.setTenantToken=function(e,t,n){s.setTenantToken(e,t,n)},e.prototype.setTenantTokens=function(e){s.setTenantTokens(e)},e.prototype.cloneEvent=function(e){return(0,r.E)(e)},e.prototype.getConfig=function(){return this.config},e}()},57118:(e,t,n)=>{"use strict";function o(e){var t={eventName:e.eventName,eventFlags:e.eventFlags};return e.telemetryProperties&&(t.telemetryProperties={ariaTenantToken:e.telemetryProperties.ariaTenantToken,nexusTenantToken:e.telemetryProperties.nexusTenantToken}),e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t.dataFields=e.dataFields?e.dataFields.slice():[],t}n.d(t,{E:()=>o})},28932:(e,t,n)=>{"use strict";n.d(t,{M:()=>l});var o,s=n(80889),r=n(96675),i=n(26501),a=(o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},o(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.executeActivityAsync=function(e,t){return n=this,o=void 0,r=function(){return function(e,t){var n,o,s,r,i={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(s=2&r[0]?o.return:r[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,r[1])).done)return s;switch(o=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return i.label++,{value:r[1],done:!1};case 5:i.label++,o=r[1],r=[0];continue;case 7:r=i.ops.pop(),i.trys.pop();continue;default:if(!((s=(s=i.trys).length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){i=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){i.label=r[1];break}if(6===r[0]&&i.label<s[1]){i.label=s[1],s=r;break}if(s&&i.label<s[2]){i.label=s[2],i.ops.push(r);break}s[2]&&i.ops.pop(),i.trys.pop();continue}r=t.call(e,i)}catch(e){r=[6,e],o=0}finally{n=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}}(this,(function(n){return[2,this.createNewActivity(e).executeAsync(t)]}))},new((s=void 0)||(s=Promise))((function(e,t){function i(e){try{l(r.next(e))}catch(e){t(e)}}function a(e){try{l(r.throw(e))}catch(e){t(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof s?n:new s((function(e){e(n)}))).then(i,a)}l((r=r.apply(n,o||[])).next())}));var n,o,s,r},t.prototype.executeActivitySync=function(e,t){return this.createNewActivity(e).executeSync(t)},t.prototype.createNewActivity=function(e){return r.q.createNew(this,e)},t.prototype.sendActivity=function(e,t,n,o){return this.sendTelemetryEvent({eventName:e,eventContract:{name:i.A.Office.System.Activity.contractName,dataFields:i.A.Office.System.Activity.getFields(t)},dataFields:n,eventFlags:o})},t.prototype.sendError=function(e){var t=i.A.Office.System.Error.getFields("Error",e.error);return null!=e.dataFields&&t.push.apply(t,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:t,eventFlags:e.eventFlags})},t}(s.G)},11761:()=>{},93815:()=>{},26501:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var o,s,r,i,a,l,c,u,d=n(30227),h=n(82101);!function(e){e.getFields=function(e,t){var n=[];return n.push((0,d.Ug)(e+".Code",t.code)),void 0!==t.type&&n.push((0,d.m9)(e+".Type",t.type)),void 0!==t.tag&&n.push((0,d.Ug)(e+".Tag",t.tag)),void 0!==t.isExpected&&n.push((0,d.LK)(e+".IsExpected",t.isExpected)),(0,h.w)(n,e,"Office.System.Result"),n}}(o||(o={})),function(e){e.contractName="Office.System.Activity",e.getFields=function(t){var n="Activity",s=[];return void 0!==t.cV&&s.push((0,d.m9)(n+".CV",t.cV)),s.push((0,d.Ug)(n+".Duration",t.duration)),s.push((0,d.Ug)(n+".Count",t.count)),s.push((0,d.Ug)(n+".AggMode",t.aggMode)),void 0!==t.success&&s.push((0,d.LK)(n+".Success",t.success)),void 0!==t.result&&s.push.apply(s,o.getFields(n+".Result",t.result)),(0,h.w)(s,n,e.contractName),s}}(s||(s={})),function(e){e.getFields=function(e,t){var n=[];return void 0!==t.id&&n.push((0,d.m9)(e+".Id",t.id)),void 0!==t.version&&n.push((0,d.m9)(e+".Version",t.version)),void 0!==t.sessionId&&n.push((0,d.m9)(e+".SessionId",t.sessionId)),(0,h.w)(n,e,"Office.System.Host"),n}}(r||(r={})),function(e){e.getFields=function(e,t){var n=[];return void 0!==t.alias&&n.push((0,d.m9)(e+".Alias",t.alias)),void 0!==t.primaryIdentityHash&&n.push((0,d.m9)(e+".PrimaryIdentityHash",t.primaryIdentityHash)),void 0!==t.primaryIdentitySpace&&n.push((0,d.m9)(e+".PrimaryIdentitySpace",t.primaryIdentitySpace)),void 0!==t.tenantId&&n.push((0,d.m9)(e+".TenantId",t.tenantId)),void 0!==t.tenantGroup&&n.push((0,d.m9)(e+".TenantGroup",t.tenantGroup)),void 0!==t.isAnonymous&&n.push((0,d.LK)(e+".IsAnonymous",t.isAnonymous)),(0,h.w)(n,e,"Office.System.User"),n}}(i||(i={})),function(e){e.getFields=function(e,t){var n=[];return void 0!==t.id&&n.push((0,d.m9)(e+".Id",t.id)),void 0!==t.version&&n.push((0,d.m9)(e+".Version",t.version)),void 0!==t.instanceId&&n.push((0,d.m9)(e+".InstanceId",t.instanceId)),void 0!==t.name&&n.push((0,d.m9)(e+".Name",t.name)),void 0!==t.marketplaceType&&n.push((0,d.m9)(e+".MarketplaceType",t.marketplaceType)),void 0!==t.sessionId&&n.push((0,d.m9)(e+".SessionId",t.sessionId)),void 0!==t.browserToken&&n.push((0,d.m9)(e+".BrowserToken",t.browserToken)),void 0!==t.osfRuntimeVersion&&n.push((0,d.m9)(e+".OsfRuntimeVersion",t.osfRuntimeVersion)),void 0!==t.officeJsVersion&&n.push((0,d.m9)(e+".OfficeJsVersion",t.officeJsVersion)),void 0!==t.hostJsVersion&&n.push((0,d.m9)(e+".HostJsVersion",t.hostJsVersion)),void 0!==t.assetId&&n.push((0,d.m9)(e+".AssetId",t.assetId)),void 0!==t.providerName&&n.push((0,d.m9)(e+".ProviderName",t.providerName)),void 0!==t.type&&n.push((0,d.m9)(e+".Type",t.type)),(0,h.w)(n,e,"Office.System.SDX"),n}}(a||(a={})),function(e){e.getFields=function(e,t){var n=[];return void 0!==t.name&&n.push((0,d.m9)(e+".Name",t.name)),void 0!==t.state&&n.push((0,d.m9)(e+".State",t.state)),(0,h.w)(n,e,"Office.System.Funnel"),n}}(l||(l={})),function(e){e.getFields=function(e,t){var n=[];return void 0!==t.id&&n.push((0,d.Ug)(e+".Id",t.id)),void 0!==t.name&&n.push((0,d.m9)(e+".Name",t.name)),void 0!==t.commandSurface&&n.push((0,d.m9)(e+".CommandSurface",t.commandSurface)),void 0!==t.parentName&&n.push((0,d.m9)(e+".ParentName",t.parentName)),void 0!==t.triggerMethod&&n.push((0,d.m9)(e+".TriggerMethod",t.triggerMethod)),void 0!==t.timeOffsetMs&&n.push((0,d.Ug)(e+".TimeOffsetMs",t.timeOffsetMs)),(0,h.w)(n,e,"Office.System.UserAction"),n}}(c||(c={})),function(e){e.getFields=function(e,t){var n=[];return n.push((0,d.m9)(e+".ErrorGroup",t.errorGroup)),n.push((0,d.Ug)(e+".Tag",t.tag)),void 0!==t.code&&n.push((0,d.Ug)(e+".Code",t.code)),void 0!==t.id&&n.push((0,d.Ug)(e+".Id",t.id)),void 0!==t.count&&n.push((0,d.Ug)(e+".Count",t.count)),(0,h.w)(n,e,"Office.System.Error"),n}}(u||(u={}));var p,f=s,g=o,m=u,y=l,v=r,b=a,S=c,w=i;!function(e){var t,n;t=e.Office||(e.Office={}),(n=t.System||(t.System={})).Activity=f,n.Result=g,n.Error=m,n.Funnel=y,n.Host=v,n.SDX=b,n.User=w,n.UserAction=S}(p||(p={}))},1059:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ActivityScope:()=>s.q,Category:()=>g.b7,Contracts:()=>o.A,CostPriority:()=>p.Mx,DataCategories:()=>p.b5,DataClassification:()=>a.p,DataFieldType:()=>d.b,DiagnosticLevel:()=>p.EP,LogLevel:()=>g.$b,PersistencePriority:()=>p.qu,SamplingPolicy:()=>p.A2,SimpleTelemetryLogger:()=>m.G,SuppressNexus:()=>m.d,TelemetryLogger:()=>y.M,addContractField:()=>r.w,cloneEvent:()=>v.E,getEffectiveEventFlags:()=>h.H,getFieldsForContract:()=>i.P,logError:()=>g.vV,logNotification:()=>g.wC,makeBooleanDataField:()=>u.LK,makeDoubleDataField:()=>u.ip,makeGuidDataField:()=>u.k,makeInt64DataField:()=>u.Ug,makeStringDataField:()=>u.m9,onNotification:()=>g.d$});var o=n(26501),s=n(96675),r=n(82101),i=n(96550),a=n(9751),l=n(54243),c={};for(const e in l)["default","Contracts","ActivityScope","addContractField","getFieldsForContract","DataClassification"].indexOf(e)<0&&(c[e]=()=>l[e]);n.d(t,c);var u=n(30227),d=n(37435),h=n(97131),p=n(81701),f=n(49068);c={};for(const e in f)["default","Contracts","ActivityScope","addContractField","getFieldsForContract","DataClassification","makeBooleanDataField","makeDoubleDataField","makeGuidDataField","makeInt64DataField","makeStringDataField","DataFieldType","getEffectiveEventFlags","CostPriority","DataCategories","DiagnosticLevel","PersistencePriority","SamplingPolicy"].indexOf(e)<0&&(c[e]=()=>f[e]);n.d(t,c);var g=n(21681),m=n(80889),y=n(28932),v=n(57118),b=n(11761);c={};for(const e in b)["default","Contracts","ActivityScope","addContractField","getFieldsForContract","DataClassification","makeBooleanDataField","makeDoubleDataField","makeGuidDataField","makeInt64DataField","makeStringDataField","DataFieldType","getEffectiveEventFlags","CostPriority","DataCategories","DiagnosticLevel","PersistencePriority","SamplingPolicy","Category","LogLevel","logError","logNotification","onNotification","SimpleTelemetryLogger","SuppressNexus","TelemetryLogger","cloneEvent"].indexOf(e)<0&&(c[e]=()=>b[e]);n.d(t,c);var S=n(93815);c={};for(const e in S)["default","Contracts","ActivityScope","addContractField","getFieldsForContract","DataClassification","makeBooleanDataField","makeDoubleDataField","makeGuidDataField","makeInt64DataField","makeStringDataField","DataFieldType","getEffectiveEventFlags","CostPriority","DataCategories","DiagnosticLevel","PersistencePriority","SamplingPolicy","Category","LogLevel","logError","logNotification","onNotification","SimpleTelemetryLogger","SuppressNexus","TelemetryLogger","cloneEvent"].indexOf(e)<0&&(c[e]=()=>S[e]);n.d(t,c)},5220:(e,t,n)=>{"use strict";n.d(t,{a:()=>u});var o=n(98670),s=n(30538),r=n(84461),i=n(61977),a=n(24301),l=n(26746),c=n(64047);function u(e,t){void 0===t&&(t={});var n=t.factoryOptions,u=(void 0===n?{}:n).defaultProp,h=function(n){var l,c,u,h,p=(l=t.displayName,c=s.useContext(i.z),u=t.fields,h=["theme","styles","tokens"],a.X.getSettings(u||h,l,c.customizations)),f=t.state;f&&(n=(0,o.Cl)((0,o.Cl)({},n),f(n)));var g=n.theme||p.theme,m=d(n,g,t.tokens,p.tokens,n.tokens),y=function(e,t,n){for(var o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return r.concatStyleSets.apply(void 0,o.map((function(o){return"function"==typeof o?o(e,t,n):o})))}(n,g,m,t.styles,p.styles,n.styles),v=(0,o.Cl)((0,o.Cl)({},n),{styles:y,tokens:m,_defaultStyles:y,theme:g});return e(v)};return h.displayName=t.displayName||e.name,u&&(h.create=(0,l.Bw)(h,{defaultProp:u})),(0,c.k)(h,t.statics),h}function d(e,t){for(var n=[],s=2;s<arguments.length;s++)n[s-2]=arguments[s];for(var r={},i=0,a=n;i<a.length;i++){var l=a[i];l&&(l="function"==typeof l?l(e,t):l,Array.isArray(l)&&(l=d.apply(void 0,(0,o.aN)([e,t],l))),(0,c.k)(r,l))}return r}},26746:(e,t,n)=>{"use strict";var o;n.d(t,{Bw:()=>d,Sk:()=>p,WL:()=>u});var s=n(98670),r=n(30538),i=n(16536),a=n(78572),l=n(41914),c=n(64047);function u(e,t){for(var i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a];var l=e;return l.isSlot?0===(i=r.Children.toArray(i)).length?l(t):l((0,s.Cl)((0,s.Cl)({},t),{children:i})):r.createElement.apply(o||(o=n.t(r,2)),(0,s.aN)([e,t],i))}function d(e,t){void 0===t&&(t={});var n=t.defaultProp,o=void 0===n?"children":n;return function(t,n,a,u,d){if(r.isValidElement(n))return n;var h=function(e,t){var n,o;return"string"==typeof t||"number"==typeof t||"boolean"==typeof t?((n={})[e]=t,o=n):o=t,o}(o,n),p=function(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];for(var s={},r=[],a=0,u=n;a<u.length;a++){var d=u[a];r.push(d&&d.className),(0,c.k)(s,d)}return s.className=(0,i.e)([e,r],{rtl:(0,l.jI)(t)}),s}(u,d,t,h);if(a){if(a.component){var f=a.component;return r.createElement(f,(0,s.Cl)({},p))}if(a.render)return a.render(p,e)}return r.createElement(e,(0,s.Cl)({},p))}}var h=(0,a.J9)((function(e){return d(e)}));function p(e,t){var n={},o=e,s=function(e){if(t.hasOwnProperty(e)){var s=function(n){for(var s=[],r=1;r<arguments.length;r++)s[r-1]=arguments[r];if(s.length>0)throw new Error("Any module using getSlots must use withSlots. Please see withSlots javadoc for more info.");return function(e,t,n,o,s,r){return void 0!==e.create?e.create(t,n,o,s):h(e)(t,n,o,s,r)}(t[e],n,o[e],o.slots&&o.slots[e],o._defaultStyles&&o._defaultStyles[e],o.theme)};s.isSlot=!0,n[e]=s}};for(var r in t)s(r);return n}},64047:(e,t,n)=>{"use strict";n.d(t,{k:()=>o});var o=n(98670).Cl},22599:(e,t,n)=>{"use strict";n.d(t,{v:()=>A});var o=n(84461);function s(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons"',src:"url('"+e+"fabric-icons-a13498cf.woff') format('woff')"},icons:{GlobalNavButton:"",ChevronDown:"",ChevronUp:"",Edit:"",Add:"",Cancel:"",More:"",Settings:"",Mail:"",Filter:"",Search:"",Share:"",BlockedSite:"",FavoriteStar:"",FavoriteStarFill:"",CheckMark:"",Delete:"",ChevronLeft:"",ChevronRight:"",Calendar:"",Megaphone:"",Undo:"",Flag:"",Page:"",Pinned:"",View:"",Clear:"",Download:"",Upload:"",Folder:"",Sort:"",AlignRight:"",AlignLeft:"",Tag:"",AddFriend:"",Info:"",SortLines:"",List:"",CircleRing:"",Heart:"",HeartFill:"",Tiles:"",Embed:"",Glimmer:"",Ascending:"",Descending:"",SortUp:"",SortDown:"",SyncToPC:"",LargeGrid:"",SkypeCheck:"",SkypeClock:"",SkypeMinus:"",ClearFilter:"",Flow:"",StatusCircleCheckmark:"",MoreVertical:""}};(0,o.registerIcons)(n,t)}function r(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-0"',src:"url('"+e+"fabric-icons-0-467ee27f.woff') format('woff')"},icons:{PageLink:"",CommentSolid:"",ChangeEntitlements:"",Installation:"",WebAppBuilderModule:"",WebAppBuilderFragment:"",WebAppBuilderSlot:"",BullseyeTargetEdit:"",WebAppBuilderFragmentCreate:"",PageData:"",PageHeaderEdit:"",ProductList:"",UnpublishContent:"",DependencyAdd:"",DependencyRemove:"",EntitlementPolicy:"",EntitlementRedemption:"",SchoolDataSyncLogo:"",PinSolid12:"",PinSolidOff12:"",AddLink:"",SharepointAppIcon16:"",DataflowsLink:"",TimePicker:"",UserWarning:"",ComplianceAudit:"",InternetSharing:"",Brightness:"",MapPin:"",Airplane:"",Tablet:"",QuickNote:"",Video:"",People:"",Phone:"",Pin:"",Shop:"",Stop:"",Link:"",AllApps:"",Zoom:"",ZoomOut:"",Microphone:"",Camera:"",Attach:"",Send:"",FavoriteList:"",PageSolid:"",Forward:"",Back:"",Refresh:"",Lock:"",ReportHacked:"",EMI:"",MiniLink:"",Blocked:"",ReadingMode:"",Favicon:"",Remove:"",Checkbox:"",CheckboxComposite:"",CheckboxFill:"",CheckboxIndeterminate:"",CheckboxCompositeReversed:"",BackToWindow:"",FullScreen:"",Print:"",Up:"",Down:"",OEM:"",Save:"",ReturnKey:"",Cloud:"",Flashlight:"",CommandPrompt:"",Sad:"",RealEstate:"",SIPMove:"",EraseTool:"",GripperTool:"",Dialpad:"",PageLeft:"",PageRight:"",MultiSelect:"",KeyboardClassic:"",Play:"",Pause:"",InkingTool:"",Emoji2:"",GripperBarHorizontal:"",System:"",Personalize:"",SearchAndApps:"",Globe:"",EaseOfAccess:"",ContactInfo:"",Unpin:"",Contact:"",Memo:"",IncomingCall:""}};(0,o.registerIcons)(n,t)}function i(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-1"',src:"url('"+e+"fabric-icons-1-4d521695.woff') format('woff')"},icons:{Paste:"",WindowsLogo:"",Error:"",GripperBarVertical:"",Unlock:"",Slideshow:"",Trim:"",AutoEnhanceOn:"",AutoEnhanceOff:"",Color:"",SaveAs:"",Light:"",Filters:"",AspectRatio:"",Contrast:"",Redo:"",Crop:"",PhotoCollection:"",Album:"",Rotate:"",PanoIndicator:"",Translate:"",RedEye:"",ViewOriginal:"",ThumbnailView:"",Package:"",Telemarketer:"",Warning:"",Financial:"",Education:"",ShoppingCart:"",Train:"",Move:"",TouchPointer:"",Merge:"",TurnRight:"",Ferry:"",Highlight:"",PowerButton:"",Tab:"",Admin:"",TVMonitor:"",Speakers:"",Game:"",HorizontalTabKey:"",UnstackSelected:"",StackIndicator:"",Nav2DMapView:"",StreetsideSplitMinimize:"",Car:"",Bus:"",EatDrink:"",SeeDo:"",LocationCircle:"",Home:"",SwitcherStartEnd:"",ParkingLocation:"",IncidentTriangle:"",Touch:"",MapDirections:"",CaretHollow:"",CaretSolid:"",History:"",Location:"",MapLayers:"",SearchNearby:"",Work:"",Recent:"",Hotel:"",Bank:"",LocationDot:"",Dictionary:"",ChromeBack:"",FolderOpen:"",PinnedFill:"",RevToggleKey:"",USB:"",Previous:"",Next:"",Sync:"",Help:"",Emoji:"",MailForward:"",ClosePane:"",OpenPane:"",PreviewLink:"",ZoomIn:"",Bookmarks:"",Document:"",ProtectedDocument:"",OpenInNewWindow:"",MailFill:"",ViewAll:"",Switch:"",Rename:"",Go:"",Remote:"",SelectAll:"",Orientation:"",Import:""}};(0,o.registerIcons)(n,t)}function a(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-2"',src:"url('"+e+"fabric-icons-2-63c99abf.woff') format('woff')"},icons:{Picture:"",ChromeClose:"",ShowResults:"",Message:"",CalendarDay:"",CalendarWeek:"",MailReplyAll:"",Read:"",Cut:"",PaymentCard:"",Copy:"",Important:"",MailReply:"",GotoToday:"",Font:"",FontColor:"",FolderFill:"",Permissions:"",DisableUpdates:"",Unfavorite:"",Italic:"",Underline:"",Bold:"",MoveToFolder:"",Dislike:"",Like:"",AlignCenter:"",OpenFile:"",ClearSelection:"",FontDecrease:"",FontIncrease:"",FontSize:"",CellPhone:"",RepeatOne:"",RepeatAll:"",Calculator:"",Library:"",PostUpdate:"",NewFolder:"",CalendarReply:"",UnsyncFolder:"",SyncFolder:"",BlockContact:"",Accept:"",BulletedList:"",Preview:"",News:"",Chat:"",Group:"",World:"",Comment:"",DockLeft:"",DockRight:"",Repair:"",Accounts:"",Street:"",RadioBullet:"",Stopwatch:"",Clock:"",WorldClock:"",AlarmClock:"",Photo:"",ActionCenter:"",Hospital:"",Timer:"",FullCircleMask:"",LocationFill:"",ChromeMinimize:"",ChromeRestore:"",Annotation:"",Fingerprint:"",Handwriting:"",ChromeFullScreen:"",Completed:"",Label:"",FlickDown:"",FlickUp:"",FlickLeft:"",FlickRight:"",MiniExpand:"",MiniContract:"",Streaming:"",MusicInCollection:"",OneDriveLogo:"",CompassNW:"",Code:"",LightningBolt:"",CalculatorMultiply:"",CalculatorAddition:"",CalculatorSubtract:"",CalculatorPercentage:"",CalculatorEqualTo:"",PrintfaxPrinterFile:"",StorageOptical:"",Communications:"",Headset:"",Health:"",Webcam2:"",FrontCamera:"",ChevronUpSmall:""}};(0,o.registerIcons)(n,t)}function l(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-3"',src:"url('"+e+"fabric-icons-3-089e217a.woff') format('woff')"},icons:{ChevronDownSmall:"",ChevronLeftSmall:"",ChevronRightSmall:"",ChevronUpMed:"",ChevronDownMed:"",ChevronLeftMed:"",ChevronRightMed:"",Devices2:"",PC1:"",PresenceChickletVideo:"",Reply:"",HalfAlpha:"",ConstructionCone:"",DoubleChevronLeftMed:"",Volume0:"",Volume1:"",Volume2:"",Volume3:"",Chart:"",Robot:"",Manufacturing:"",LockSolid:"",FitPage:"",FitWidth:"",BidiLtr:"",BidiRtl:"",RightDoubleQuote:"",Sunny:"",CloudWeather:"",Cloudy:"",PartlyCloudyDay:"",PartlyCloudyNight:"",ClearNight:"",RainShowersDay:"",Rain:"",Thunderstorms:"",RainSnow:"",Snow:"",BlowingSnow:"",Frigid:"",Fog:"",Squalls:"",Duststorm:"",Unknown:"",Precipitation:"",Ribbon:"",AreaChart:"",Assign:"",FlowChart:"",CheckList:"",Diagnostic:"",Generate:"",LineChart:"",Equalizer:"",BarChartHorizontal:"",BarChartVertical:"",Freezing:"",FunnelChart:"",Processing:"",Quantity:"",ReportDocument:"",StackColumnChart:"",SnowShowerDay:"",HailDay:"",WorkFlow:"",HourGlass:"",StoreLogoMed20:"",TimeSheet:"",TriangleSolid:"",UpgradeAnalysis:"",VideoSolid:"",RainShowersNight:"",SnowShowerNight:"",Teamwork:"",HailNight:"",PeopleAdd:"",Glasses:"",DateTime2:"",Shield:"",Header1:"",PageAdd:"",NumberedList:"",PowerBILogo:"",Info2:"",MusicInCollectionFill:"",Asterisk:"",ErrorBadge:"",CircleFill:"",Record2:"",AllAppsMirrored:"",BookmarksMirrored:"",BulletedListMirrored:"",CaretHollowMirrored:"",CaretSolidMirrored:"",ChromeBackMirrored:"",ClearSelectionMirrored:"",ClosePaneMirrored:"",DockLeftMirrored:"",DoubleChevronLeftMedMirrored:"",GoMirrored:""}};(0,o.registerIcons)(n,t)}function c(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-4"',src:"url('"+e+"fabric-icons-4-a656cc0a.woff') format('woff')"},icons:{HelpMirrored:"",ImportMirrored:"",ImportAllMirrored:"",ListMirrored:"",MailForwardMirrored:"",MailReplyMirrored:"",MailReplyAllMirrored:"",MiniContractMirrored:"",MiniExpandMirrored:"",OpenPaneMirrored:"",ParkingLocationMirrored:"",SendMirrored:"",ShowResultsMirrored:"",ThumbnailViewMirrored:"",Media:"",Devices3:"",Focus:"",VideoLightOff:"",Lightbulb:"",StatusTriangle:"",VolumeDisabled:"",Puzzle:"",EmojiNeutral:"",EmojiDisappointed:"",HomeSolid:"",Ringer:"",PDF:"",HeartBroken:"",StoreLogo16:"",MultiSelectMirrored:"",Broom:"",AddToShoppingList:"",Cocktails:"",Wines:"",Articles:"",Cycling:"",DietPlanNotebook:"",Pill:"",ExerciseTracker:"",HandsFree:"",Medical:"",Running:"",Weights:"",Trackers:"",AddNotes:"",AllCurrency:"",BarChart4:"",CirclePlus:"",Coffee:"",Cotton:"",Market:"",Money:"",PieDouble:"",PieSingle:"",RemoveFilter:"",Savings:"",Sell:"",StockDown:"",StockUp:"",Lamp:"",Source:"",MSNVideos:"",Cricket:"",Golf:"",Baseball:"",Soccer:"",MoreSports:"",AutoRacing:"",CollegeHoops:"",CollegeFootball:"",ProFootball:"",ProHockey:"",Rugby:"",SubstitutionsIn:"",Tennis:"",Arrivals:"",Design:"",Website:"",Drop:"",HistoricalWeather:"",SkiResorts:"",Snowflake:"",BusSolid:"",FerrySolid:"",AirplaneSolid:"",TrainSolid:"",Ticket:"",WifiWarning4:"",Devices4:"",AzureLogo:"",BingLogo:"",MSNLogo:"",OutlookLogoInverse:"",OfficeLogo:"",SkypeLogo:"",Door:"",EditMirrored:"",GiftCard:"",DoubleBookmark:"",StatusErrorFull:""}};(0,o.registerIcons)(n,t)}function u(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-5"',src:"url('"+e+"fabric-icons-5-f95ba260.woff') format('woff')"},icons:{Certificate:"",FastForward:"",Rewind:"",Photo2:"",OpenSource:"",Movers:"",CloudDownload:"",Family:"",WindDirection:"",Bug:"",SiteScan:"",BrowserScreenShot:"",F12DevTools:"",CSS:"",JS:"",DeliveryTruck:"",ReminderPerson:"",ReminderGroup:"",ReminderTime:"",TabletMode:"",Umbrella:"",NetworkTower:"",CityNext:"",CityNext2:"",Section:"",OneNoteLogoInverse:"",ToggleFilled:"",ToggleBorder:"",SliderThumb:"",ToggleThumb:"",Documentation:"",Badge:"",Giftbox:"",VisualStudioLogo:"",HomeGroup:"",ExcelLogoInverse:"",WordLogoInverse:"",PowerPointLogoInverse:"",Cafe:"",SpeedHigh:"",Commitments:"",ThisPC:"",MusicNote:"",MicOff:"",PlaybackRate1x:"",EdgeLogo:"",CompletedSolid:"",AlbumRemove:"",MessageFill:"",TabletSelected:"",MobileSelected:"",LaptopSelected:"",TVMonitorSelected:"",DeveloperTools:"",Shapes:"",InsertTextBox:"",LowerBrightness:"",WebComponents:"",OfflineStorage:"",DOM:"",CloudUpload:"",ScrollUpDown:"",DateTime:"",Event:"",Cake:"",Org:"",PartyLeader:"",DRM:"",CloudAdd:"",AppIconDefault:"",Photo2Add:"",Photo2Remove:"",Calories:"",POI:"",AddTo:"",RadioBtnOff:"",RadioBtnOn:"",ExploreContent:"",Product:"",ProgressLoopInner:"",ProgressLoopOuter:"",Blocked2:"",FangBody:"",Toolbox:"",PageHeader:"",ChatInviteFriend:"",Brush:"",Shirt:"",Crown:"",Diamond:"",ScaleUp:"",QRCode:"",Feedback:"",SharepointLogoInverse:"",YammerLogo:"",Hide:"",Uneditable:"",ReturnToSession:"",OpenFolderHorizontal:"",CalendarMirrored:""}};(0,o.registerIcons)(n,t)}function d(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-6"',src:"url('"+e+"fabric-icons-6-ef6fd590.woff') format('woff')"},icons:{SwayLogoInverse:"",OutOfOffice:"",Trophy:"",ReopenPages:"",EmojiTabSymbols:"",AADLogo:"",AccessLogo:"",AdminALogoInverse32:"",AdminCLogoInverse32:"",AdminDLogoInverse32:"",AdminELogoInverse32:"",AdminLLogoInverse32:"",AdminMLogoInverse32:"",AdminOLogoInverse32:"",AdminPLogoInverse32:"",AdminSLogoInverse32:"",AdminYLogoInverse32:"",DelveLogoInverse:"",ExchangeLogoInverse:"",LyncLogo:"",OfficeVideoLogoInverse:"",SocialListeningLogo:"",VisioLogoInverse:"",Balloons:"",Cat:"",MailAlert:"",MailCheck:"",MailLowImportance:"",MailPause:"",MailRepeat:"",SecurityGroup:"",Table:"",VoicemailForward:"",VoicemailReply:"",Waffle:"",RemoveEvent:"",EventInfo:"",ForwardEvent:"",WipePhone:"",AddOnlineMeeting:"",JoinOnlineMeeting:"",RemoveLink:"",PeopleBlock:"",PeopleRepeat:"",PeopleAlert:"",PeoplePause:"",TransferCall:"",AddPhone:"",UnknownCall:"",NoteReply:"",NoteForward:"",NotePinned:"",RemoveOccurrence:"",Timeline:"",EditNote:"",CircleHalfFull:"",Room:"",Unsubscribe:"",Subscribe:"",HardDrive:"",RecurringTask:"",TaskManager:"",TaskManagerMirrored:"",Combine:"",Split:"",DoubleChevronUp:"",DoubleChevronLeft:"",DoubleChevronRight:"",TextBox:"",TextField:"",NumberField:"",Dropdown:"",PenWorkspace:"",BookingsLogo:"",ClassNotebookLogoInverse:"",DelveAnalyticsLogo:"",DocsLogoInverse:"",Dynamics365Logo:"",DynamicSMBLogo:"",OfficeAssistantLogo:"",OfficeStoreLogo:"",OneNoteEduLogoInverse:"",PlannerLogo:"",PowerApps:"",Suitcase:"",ProjectLogoInverse:"",CaretLeft8:"",CaretRight8:"",CaretUp8:"",CaretDown8:"",CaretLeftSolid8:"",CaretRightSolid8:"",CaretUpSolid8:"",CaretDownSolid8:"",ClearFormatting:"",Superscript:"",Subscript:"",Strikethrough:"",Export:"",ExportMirrored:""}};(0,o.registerIcons)(n,t)}function h(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-7"',src:"url('"+e+"fabric-icons-7-2b97bb99.woff') format('woff')"},icons:{SingleBookmark:"",SingleBookmarkSolid:"",DoubleChevronDown:"",FollowUser:"",ReplyAll:"",WorkforceManagement:"",RecruitmentManagement:"",Questionnaire:"",ManagerSelfService:"",ProductionFloorManagement:"",ProductRelease:"",ProductVariant:"",ReplyMirrored:"",ReplyAllMirrored:"",Medal:"",AddGroup:"",QuestionnaireMirrored:"",CloudImportExport:"",TemporaryUser:"",CaretSolid16:"",GroupedDescending:"",GroupedAscending:"",AwayStatus:"",MyMoviesTV:"",GenericScan:"",AustralianRules:"",WifiEthernet:"",TrackersMirrored:"",DateTimeMirrored:"",StopSolid:"",DoubleChevronUp12:"",DoubleChevronDown12:"",DoubleChevronLeft12:"",DoubleChevronRight12:"",CalendarAgenda:"",ConnectVirtualMachine:"",AddEvent:"",AssetLibrary:"",DataConnectionLibrary:"",DocLibrary:"",FormLibrary:"",FormLibraryMirrored:"",ReportLibrary:"",ReportLibraryMirrored:"",ContactCard:"",CustomList:"",CustomListMirrored:"",IssueTracking:"",IssueTrackingMirrored:"",PictureLibrary:"",OfficeAddinsLogo:"",OfflineOneDriveParachute:"",OfflineOneDriveParachuteDisabled:"",TriangleSolidUp12:"",TriangleSolidDown12:"",TriangleSolidLeft12:"",TriangleSolidRight12:"",TriangleUp12:"",TriangleDown12:"",TriangleLeft12:"",TriangleRight12:"",ArrowUpRight8:"",ArrowDownRight8:"",DocumentSet:"",GoToDashboard:"",DelveAnalytics:"",ArrowUpRightMirrored8:"",ArrowDownRightMirrored8:"",CompanyDirectory:"",OpenEnrollment:"",CompanyDirectoryMirrored:"",OneDriveAdd:"",ProfileSearch:"",Header2:"",Header3:"",Header4:"",RingerSolid:"",Eyedropper:"",MarketDown:"",CalendarWorkWeek:"",SidePanel:"",GlobeFavorite:"",CaretTopLeftSolid8:"",CaretTopRightSolid8:"",ViewAll2:"",DocumentReply:"",PlayerSettings:"",ReceiptForward:"",ReceiptReply:"",ReceiptCheck:"",Fax:"",RecurringEvent:"",ReplyAlt:"",ReplyAllAlt:"",EditStyle:"",EditMail:"",Lifesaver:"",LifesaverLock:"",InboxCheck:"",FolderSearch:""}};(0,o.registerIcons)(n,t)}function p(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-8"',src:"url('"+e+"fabric-icons-8-6fdf1528.woff') format('woff')"},icons:{CollapseMenu:"",ExpandMenu:"",Boards:"",SunAdd:"",SunQuestionMark:"",LandscapeOrientation:"",DocumentSearch:"",PublicCalendar:"",PublicContactCard:"",PublicEmail:"",PublicFolder:"",WordDocument:"",PowerPointDocument:"",ExcelDocument:"",GroupedList:"",ClassroomLogo:"",Sections:"",EditPhoto:"",Starburst:"",ShareiOS:"",AirTickets:"",PencilReply:"",Tiles2:"",SkypeCircleCheck:"",SkypeCircleClock:"",SkypeCircleMinus:"",SkypeMessage:"",ClosedCaption:"",ATPLogo:"",OfficeFormsLogoInverse:"",RecycleBin:"",EmptyRecycleBin:"",Hide2:"",Breadcrumb:"",BirthdayCake:"",TimeEntry:"",CRMProcesses:"",PageEdit:"",PageArrowRight:"",PageRemove:"",Database:"",DataManagementSettings:"",CRMServices:"",EditContact:"",ConnectContacts:"",AppIconDefaultAdd:"",AppIconDefaultList:"",ActivateOrders:"",DeactivateOrders:"",ProductCatalog:"",ScatterChart:"",AccountActivity:"",DocumentManagement:"",CRMReport:"",KnowledgeArticle:"",Relationship:"",HomeVerify:"",ZipFolder:"",SurveyQuestions:"",TextDocument:"",TextDocumentShared:"",PageCheckedOut:"",PageShared:"",SaveAndClose:"",Script:"",Archive:"",ActivityFeed:"",Compare:"",EventDate:"",ArrowUpRight:"",CaretRight:"",SetAction:"",ChatBot:"",CaretSolidLeft:"",CaretSolidDown:"",CaretSolidRight:"",CaretSolidUp:"",PowerAppsLogo:"",PowerApps2Logo:"",SearchIssue:"",SearchIssueMirrored:"",FabricAssetLibrary:"",FabricDataConnectionLibrary:"",FabricDocLibrary:"",FabricFormLibrary:"",FabricFormLibraryMirrored:"",FabricReportLibrary:"",FabricReportLibraryMirrored:"",FabricPublicFolder:"",FabricFolderSearch:"",FabricMovetoFolder:"",FabricUnsyncFolder:"",FabricSyncFolder:"",FabricOpenFolderHorizontal:"",FabricFolder:"",FabricFolderFill:"",FabricNewFolder:"",FabricPictureLibrary:"",PhotoVideoMedia:"",AddFavorite:""}};(0,o.registerIcons)(n,t)}function f(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-9"',src:"url('"+e+"fabric-icons-9-c6162b42.woff') format('woff')"},icons:{AddFavoriteFill:"",BufferTimeBefore:"",BufferTimeAfter:"",BufferTimeBoth:"",PublishContent:"",ClipboardList:"",ClipboardListMirrored:"",CannedChat:"",SkypeForBusinessLogo:"",TabCenter:"",PageCheckedin:"",PageList:"",ReadOutLoud:"",CaretBottomLeftSolid8:"",CaretBottomRightSolid8:"",FolderHorizontal:"",MicrosoftStaffhubLogo:"",GiftboxOpen:"",StatusCircleOuter:"",StatusCircleInner:"",StatusCircleRing:"",StatusTriangleOuter:"",StatusTriangleInner:"",StatusTriangleExclamation:"",StatusCircleExclamation:"",StatusCircleErrorX:"",StatusCircleInfo:"",StatusCircleBlock:"",StatusCircleBlock2:"",StatusCircleQuestionMark:"",StatusCircleSync:"",Toll:"",ExploreContentSingle:"",CollapseContent:"",CollapseContentSingle:"",InfoSolid:"",GroupList:"",ProgressRingDots:"",CaloriesAdd:"",BranchFork:"",MuteChat:"",AddHome:"",AddWork:"",MobileReport:"",ScaleVolume:"",HardDriveGroup:"",FastMode:"",ToggleLeft:"",ToggleRight:"",TriangleShape:"",RectangleShape:"",CubeShape:"",Trophy2:"",BucketColor:"",BucketColorFill:"",Taskboard:"",SingleColumn:"",DoubleColumn:"",TripleColumn:"",ColumnLeftTwoThirds:"",ColumnRightTwoThirds:"",AccessLogoFill:"",AnalyticsLogo:"",AnalyticsQuery:"",NewAnalyticsQuery:"",AnalyticsReport:"",WordLogo:"",WordLogoFill:"",ExcelLogo:"",ExcelLogoFill:"",OneNoteLogo:"",OneNoteLogoFill:"",OutlookLogo:"",OutlookLogoFill:"",PowerPointLogo:"",PowerPointLogoFill:"",PublisherLogo:"",PublisherLogoFill:"",ScheduleEventAction:"",FlameSolid:"",ServerProcesses:"",Server:"",SaveAll:"",LinkedInLogo:"",Decimals:"",SidePanelMirrored:"",ProtectRestrict:"",Blog:"",UnknownMirrored:"",PublicContactCardMirrored:"",GridViewSmall:"",GridViewMedium:"",GridViewLarge:"",Step:"",StepInsert:"",StepShared:"",StepSharedAdd:"",StepSharedInsert:"",ViewDashboard:"",ViewList:""}};(0,o.registerIcons)(n,t)}function g(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-10"',src:"url('"+e+"fabric-icons-10-c4ded8e4.woff') format('woff')"},icons:{ViewListGroup:"",ViewListTree:"",TriggerAuto:"",TriggerUser:"",PivotChart:"",StackedBarChart:"",StackedLineChart:"",BuildQueue:"",BuildQueueNew:"",UserFollowed:"",ContactLink:"",Stack:"",Bullseye:"",VennDiagram:"",FiveTileGrid:"",FocalPoint:"",Insert:"",RingerRemove:"",TeamsLogoInverse:"",TeamsLogo:"",TeamsLogoFill:"",SkypeForBusinessLogoFill:"",SharepointLogo:"",SharepointLogoFill:"",DelveLogo:"",DelveLogoFill:"",OfficeVideoLogo:"",OfficeVideoLogoFill:"",ExchangeLogo:"",ExchangeLogoFill:"",Signin:"",DocumentApproval:"",CloneToDesktop:"",InstallToDrive:"",Blur:"",Build:"",ProcessMetaTask:"",BranchFork2:"",BranchLocked:"",BranchCommit:"",BranchCompare:"",BranchMerge:"",BranchPullRequest:"",BranchSearch:"",BranchShelveset:"",RawSource:"",MergeDuplicate:"",RowsGroup:"",RowsChild:"",Deploy:"",Redeploy:"",ServerEnviroment:"",VisioDiagram:"",HighlightMappedShapes:"",TextCallout:"",IconSetsFlag:"",VisioLogo:"",VisioLogoFill:"",VisioDocument:"",TimelineProgress:"",TimelineDelivery:"",Backlog:"",TeamFavorite:"",TaskGroup:"",TaskGroupMirrored:"",ScopeTemplate:"",AssessmentGroupTemplate:"",NewTeamProject:"",CommentAdd:"",CommentNext:"",CommentPrevious:"",ShopServer:"",LocaleLanguage:"",QueryList:"",UserSync:"",UserPause:"",StreamingOff:"",ArrowTallUpLeft:"",ArrowTallUpRight:"",ArrowTallDownLeft:"",ArrowTallDownRight:"",FieldEmpty:"",FieldFilled:"",FieldChanged:"",FieldNotChanged:"",RingerOff:"",PlayResume:"",BulletedList2:"",BulletedList2Mirrored:"",ImageCrosshair:"",GitGraph:"",Repo:"",RepoSolid:"",FolderQuery:"",FolderList:"",FolderListMirrored:"",LocationOutline:"",POISolid:"",CalculatorNotEqualTo:"",BoxSubtractSolid:""}};(0,o.registerIcons)(n,t)}function m(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-11"',src:"url('"+e+"fabric-icons-11-2a8393d6.woff') format('woff')"},icons:{BoxAdditionSolid:"",BoxMultiplySolid:"",BoxPlaySolid:"",BoxCheckmarkSolid:"",CirclePauseSolid:"",CirclePause:"",MSNVideosSolid:"",CircleStopSolid:"",CircleStop:"",NavigateBack:"",NavigateBackMirrored:"",NavigateForward:"",NavigateForwardMirrored:"",UnknownSolid:"",UnknownMirroredSolid:"",CircleAddition:"",CircleAdditionSolid:"",FilePDB:"",FileTemplate:"",FileSQL:"",FileJAVA:"",FileASPX:"",FileCSS:"",FileSass:"",FileLess:"",FileHTML:"",JavaScriptLanguage:"",CSharpLanguage:"",CSharp:"",VisualBasicLanguage:"",VB:"",CPlusPlusLanguage:"",CPlusPlus:"",FSharpLanguage:"",FSharp:"",TypeScriptLanguage:"",PythonLanguage:"",PY:"",CoffeeScript:"",MarkDownLanguage:"",FullWidth:"",FullWidthEdit:"",Plug:"",PlugSolid:"",PlugConnected:"",PlugDisconnected:"",UnlockSolid:"",Variable:"",Parameter:"",CommentUrgent:"",Storyboard:"",DiffInline:"",DiffSideBySide:"",ImageDiff:"",ImagePixel:"",FileBug:"",FileCode:"",FileComment:"",BusinessHoursSign:"",FileImage:"",FileSymlink:"",AutoFillTemplate:"",WorkItem:"",WorkItemBug:"",LogRemove:"",ColumnOptions:"",Packages:"",BuildIssue:"",AssessmentGroup:"",VariableGroup:"",FullHistory:"",Wheelchair:"",SingleColumnEdit:"",DoubleColumnEdit:"",TripleColumnEdit:"",ColumnLeftTwoThirdsEdit:"",ColumnRightTwoThirdsEdit:"",StreamLogo:"",PassiveAuthentication:"",AlertSolid:"",MegaphoneSolid:"",TaskSolid:"",ConfigurationSolid:"",BugSolid:"",CrownSolid:"",Trophy2Solid:"",QuickNoteSolid:"",ConstructionConeSolid:"",PageListSolid:"",PageListMirroredSolid:"",StarburstSolid:"",ReadingModeSolid:"",SadSolid:"",HealthSolid:"",ShieldSolid:"",GiftBoxSolid:"",ShoppingCartSolid:"",MailSolid:"",ChatSolid:"",RibbonSolid:""}};(0,o.registerIcons)(n,t)}function y(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-12"',src:"url('"+e+"fabric-icons-12-7e945a1e.woff') format('woff')"},icons:{FinancialSolid:"",FinancialMirroredSolid:"",HeadsetSolid:"",PermissionsSolid:"",ParkingSolid:"",ParkingMirroredSolid:"",DiamondSolid:"",AsteriskSolid:"",OfflineStorageSolid:"",BankSolid:"",DecisionSolid:"",Parachute:"",ParachuteSolid:"",FiltersSolid:"",ColorSolid:"",ReviewSolid:"",ReviewRequestSolid:"",ReviewRequestMirroredSolid:"",ReviewResponseSolid:"",FeedbackRequestSolid:"",FeedbackRequestMirroredSolid:"",FeedbackResponseSolid:"",WorkItemBar:"",WorkItemBarSolid:"",Separator:"",NavigateExternalInline:"",PlanView:"",TimelineMatrixView:"",EngineeringGroup:"",ProjectCollection:"",CaretBottomRightCenter8:"",CaretBottomLeftCenter8:"",CaretTopRightCenter8:"",CaretTopLeftCenter8:"",DonutChart:"",ChevronUnfold10:"",ChevronFold10:"",DoubleChevronDown8:"",DoubleChevronUp8:"",DoubleChevronLeft8:"",DoubleChevronRight8:"",ChevronDownEnd6:"",ChevronUpEnd6:"",ChevronLeftEnd6:"",ChevronRightEnd6:"",ContextMenu:"",AzureAPIManagement:"",AzureServiceEndpoint:"",VSTSLogo:"",VSTSAltLogo1:"",VSTSAltLogo2:"",FileTypeSolution:"",WordLogoInverse16:"",WordLogo16:"",WordLogoFill16:"",PowerPointLogoInverse16:"",PowerPointLogo16:"",PowerPointLogoFill16:"",ExcelLogoInverse16:"",ExcelLogo16:"",ExcelLogoFill16:"",OneNoteLogoInverse16:"",OneNoteLogo16:"",OneNoteLogoFill16:"",OutlookLogoInverse16:"",OutlookLogo16:"",OutlookLogoFill16:"",PublisherLogoInverse16:"",PublisherLogo16:"",PublisherLogoFill16:"",VisioLogoInverse16:"",VisioLogo16:"",VisioLogoFill16:"",TestBeaker:"",TestBeakerSolid:"",TestExploreSolid:"",TestAutoSolid:"",TestUserSolid:"",TestImpactSolid:"",TestPlan:"",TestStep:"",TestParameter:"",TestSuite:"",TestCase:"",Sprint:"",SignOut:"",TriggerApproval:"",Rocket:"",AzureKeyVault:"",Onboarding:"",Transition:"",LikeSolid:"",DislikeSolid:"",CRMCustomerInsightsApp:"",EditCreate:"",PlayReverseResume:"",PlayReverse:"",SearchData:"",UnSetColor:"",DeclineCall:""}};(0,o.registerIcons)(n,t)}function v(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-13"',src:"url('"+e+"fabric-icons-13-c3989a02.woff') format('woff')"},icons:{RectangularClipping:"",TeamsLogo16:"",TeamsLogoFill16:"",Spacer:"",SkypeLogo16:"",SkypeForBusinessLogo16:"",SkypeForBusinessLogoFill16:"",FilterSolid:"",MailUndelivered:"",MailTentative:"",MailTentativeMirrored:"",MailReminder:"",ReceiptUndelivered:"",ReceiptTentative:"",ReceiptTentativeMirrored:"",Inbox:"",IRMReply:"",IRMReplyMirrored:"",IRMForward:"",IRMForwardMirrored:"",VoicemailIRM:"",EventAccepted:"",EventTentative:"",EventTentativeMirrored:"",EventDeclined:"",IDBadge:"",BackgroundColor:"",OfficeFormsLogoInverse16:"",OfficeFormsLogo:"",OfficeFormsLogoFill:"",OfficeFormsLogo16:"",OfficeFormsLogoFill16:"",OfficeFormsLogoInverse24:"",OfficeFormsLogo24:"",OfficeFormsLogoFill24:"",PageLock:"",NotExecuted:"",NotImpactedSolid:"",FieldReadOnly:"",FieldRequired:"",BacklogBoard:"",ExternalBuild:"",ExternalTFVC:"",ExternalXAML:"",IssueSolid:"",DefectSolid:"",LadybugSolid:"",NugetLogo:"",TFVCLogo:"",ProjectLogo32:"",ProjectLogoFill32:"",ProjectLogo16:"",ProjectLogoFill16:"",SwayLogo32:"",SwayLogoFill32:"",SwayLogo16:"",SwayLogoFill16:"",ClassNotebookLogo32:"",ClassNotebookLogoFill32:"",ClassNotebookLogo16:"",ClassNotebookLogoFill16:"",ClassNotebookLogoInverse32:"",ClassNotebookLogoInverse16:"",StaffNotebookLogo32:"",StaffNotebookLogoFill32:"",StaffNotebookLogo16:"",StaffNotebookLogoFill16:"",StaffNotebookLogoInverted32:"",StaffNotebookLogoInverted16:"",KaizalaLogo:"",TaskLogo:"",ProtectionCenterLogo32:"",GallatinLogo:"",Globe2:"",Guitar:"",Breakfast:"",Brunch:"",BeerMug:"",Vacation:"",Teeth:"",Taxi:"",Chopsticks:"",SyncOccurence:"",UnsyncOccurence:"",GIF:"",PrimaryCalendar:"",SearchCalendar:"",VideoOff:"",MicrosoftFlowLogo:"",BusinessCenterLogo:"",ToDoLogoBottom:"",ToDoLogoTop:"",EditSolid12:"",EditSolidMirrored12:"",UneditableSolid12:"",UneditableSolidMirrored12:"",UneditableMirrored:"",AdminALogo32:"",AdminALogoFill32:"",ToDoLogoInverse:""}};(0,o.registerIcons)(n,t)}function b(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-14"',src:"url('"+e+"fabric-icons-14-5cf58db8.woff') format('woff')"},icons:{Snooze:"",WaffleOffice365:"",ImageSearch:"",NewsSearch:"",VideoSearch:"",R:"",FontColorA:"",FontColorSwatch:"",LightWeight:"",NormalWeight:"",SemiboldWeight:"",GroupObject:"",UngroupObject:"",AlignHorizontalLeft:"",AlignHorizontalCenter:"",AlignHorizontalRight:"",AlignVerticalTop:"",AlignVerticalCenter:"",AlignVerticalBottom:"",HorizontalDistributeCenter:"",VerticalDistributeCenter:"",Ellipse:"",Line:"",Octagon:"",Hexagon:"",Pentagon:"",RightTriangle:"",HalfCircle:"",QuarterCircle:"",ThreeQuarterCircle:"","6PointStar":"","12PointStar":"",ArrangeBringToFront:"",ArrangeSendToBack:"",ArrangeSendBackward:"",ArrangeBringForward:"",BorderDash:"",BorderDot:"",LineStyle:"",LineThickness:"",WindowEdit:"",HintText:"",MediaAdd:"",AnchorLock:"",AutoHeight:"",ChartSeries:"",ChartXAngle:"",ChartYAngle:"",Combobox:"",LineSpacing:"",Padding:"",PaddingTop:"",PaddingBottom:"",PaddingLeft:"",PaddingRight:"",NavigationFlipper:"",AlignJustify:"",TextOverflow:"",VisualsFolder:"",VisualsStore:"",PictureCenter:"",PictureFill:"",PicturePosition:"",PictureStretch:"",PictureTile:"",Slider:"",SliderHandleSize:"",DefaultRatio:"",NumberSequence:"",GUID:"",ReportAdd:"",DashboardAdd:"",MapPinSolid:"",WebPublish:"",PieSingleSolid:"",BlockedSolid:"",DrillDown:"",DrillDownSolid:"",DrillExpand:"",DrillShow:"",SpecialEvent:"",OneDriveFolder16:"",FunctionalManagerDashboard:"",BIDashboard:"",CodeEdit:"",RenewalCurrent:"",RenewalFuture:"",SplitObject:"",BulkUpload:"",DownloadDocument:"",GreetingCard:"",Flower:"",WaitlistConfirm:"",WaitlistConfirmMirrored:"",LaptopSecure:"",DragObject:"",EntryView:"",EntryDecline:"",ContactCardSettings:"",ContactCardSettingsMirrored:""}};(0,o.registerIcons)(n,t)}function S(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-15"',src:"url('"+e+"fabric-icons-15-3807251b.woff') format('woff')"},icons:{CalendarSettings:"",CalendarSettingsMirrored:"",HardDriveLock:"",HardDriveUnlock:"",AccountManagement:"",ReportWarning:"",TransitionPop:"",TransitionPush:"",TransitionEffect:"",LookupEntities:"",ExploreData:"",AddBookmark:"",SearchBookmark:"",DrillThrough:"",MasterDatabase:"",CertifiedDatabase:"",MaximumValue:"",MinimumValue:"",VisualStudioIDELogo32:"",PasteAsText:"",PasteAsCode:"",BrowserTab:"",BrowserTabScreenshot:"",DesktopScreenshot:"",FileYML:"",ClipboardSolid:"",FabricUserFolder:"",FabricNetworkFolder:"",BullseyeTarget:"",AnalyticsView:"",Video360Generic:"",Untag:"",Leave:"",Trending12:"",Blocked12:"",Warning12:"",CheckedOutByOther12:"",CheckedOutByYou12:"",CircleShapeSolid:"",SquareShapeSolid:"",TriangleShapeSolid:"",DropShapeSolid:"",RectangleShapeSolid:"",ZoomToFit:"",InsertColumnsLeft:"",InsertColumnsRight:"",InsertRowsAbove:"",InsertRowsBelow:"",DeleteColumns:"",DeleteRows:"",DeleteRowsMirrored:"",DeleteTable:"",AccountBrowser:"",VersionControlPush:"",StackedColumnChart2:"",TripleColumnWide:"",QuadColumn:"",WhiteBoardApp16:"",WhiteBoardApp32:"",PinnedSolid:"",InsertSignatureLine:"",ArrangeByFrom:"",Phishing:"",CreateMailRule:"",PublishCourse:"",DictionaryRemove:"",UserRemove:"",UserEvent:"",Encryption:"",PasswordField:"",OpenInNewTab:"",Hide3:"",VerifiedBrandSolid:"",MarkAsProtected:"",AuthenticatorApp:"",WebTemplate:"",DefenderTVM:"",MedalSolid:"",D365TalentLearn:"",D365TalentInsight:"",D365TalentHRCore:"",BacklogList:"",ButtonControl:"",TableGroup:"",MountainClimbing:"",TagUnknown:"",TagUnknownMirror:"",TagUnknown12:"",TagUnknown12Mirror:"",Link12:"",Presentation:"",Presentation12:"",Lock12:"",BuildDefinition:"",ReleaseDefinition:"",SaveTemplate:"",UserGauge:"",BlockedSiteSolid12:"",TagSolid:"",OfficeChat:""}};(0,o.registerIcons)(n,t)}function w(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-16"',src:"url('"+e+"fabric-icons-16-9cf93f3b.woff') format('woff')"},icons:{OfficeChatSolid:"",MailSchedule:"",WarningSolid:"",Blocked2Solid:"",SkypeCircleArrow:"",SkypeArrow:"",SyncStatus:"",SyncStatusSolid:"",ProjectDocument:"",ToDoLogoOutline:"",VisioOnlineLogoFill32:"",VisioOnlineLogo32:"",VisioOnlineLogoCloud32:"",VisioDiagramSync:"",Event12:"",EventDateMissed12:"",UserOptional:"",ResponsesMenu:"",DoubleDownArrow:"",DistributeDown:"",BookmarkReport:"",FilterSettings:"",GripperDotsVertical:"",MailAttached:"",AddIn:"",LinkedDatabase:"",TableLink:"",PromotedDatabase:"",BarChartVerticalFilter:"",BarChartVerticalFilterSolid:"",MicOff2:"",MicrosoftTranslatorLogo:"",ShowTimeAs:"",FileRequest:"",WorkItemAlert:"",PowerBILogo16:"",PowerBILogoBackplate16:"",BulletedListText:"",BulletedListBullet:"",BulletedListTextMirrored:"",BulletedListBulletMirrored:"",NumberedListText:"",NumberedListNumber:"",NumberedListTextMirrored:"",NumberedListNumberMirrored:"",RemoveLinkChain:"",RemoveLinkX:"",FabricTextHighlight:"",ClearFormattingA:"",ClearFormattingEraser:"",Photo2Fill:"",IncreaseIndentText:"",IncreaseIndentArrow:"",DecreaseIndentText:"",DecreaseIndentArrow:"",IncreaseIndentTextMirrored:"",IncreaseIndentArrowMirrored:"",DecreaseIndentTextMirrored:"",DecreaseIndentArrowMirrored:"",CheckListText:"",CheckListCheck:"",CheckListTextMirrored:"",CheckListCheckMirrored:"",NumberSymbol:"",Coupon:"",VerifiedBrand:"",ReleaseGate:"",ReleaseGateCheck:"",ReleaseGateError:"",M365InvoicingLogo:"",RemoveFromShoppingList:"",ShieldAlert:"",FabricTextHighlightComposite:"",Dataflows:"",GenericScanFilled:"",DiagnosticDataBarTooltip:"",SaveToMobile:"",Orientation2:"",ScreenCast:"",ShowGrid:"",SnapToGrid:"",ContactList:"",NewMail:"",EyeShadow:"",FabricFolderConfirm:"",InformationBarriers:"",CommentActive:"",ColumnVerticalSectionEdit:"",WavingHand:"",ShakeDevice:"",SmartGlassRemote:"",Rotate90Clockwise:"",Rotate90CounterClockwise:"",CampaignTemplate:"",ChartTemplate:"",PageListFilter:"",SecondaryNav:"",ColumnVerticalSection:"",SkypeCircleSlash:"",SkypeSlash:""}};(0,o.registerIcons)(n,t)}function T(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-17"',src:"url('"+e+"fabric-icons-17-0c4ed701.woff') format('woff')"},icons:{CustomizeToolbar:"",DuplicateRow:"",RemoveFromTrash:"",MailOptions:"",Childof:"",Footer:"",Header:"",BarChartVerticalFill:"",StackedColumnChart2Fill:"",PlainText:"",AccessibiltyChecker:"",DatabaseSync:"",ReservationOrders:"",TabOneColumn:"",TabTwoColumn:"",TabThreeColumn:"",BulletedTreeList:"",MicrosoftTranslatorLogoGreen:"",MicrosoftTranslatorLogoBlue:"",InternalInvestigation:"",AddReaction:"",ContactHeart:"",VisuallyImpaired:"",EventToDoLogo:"",Variable2:"",ModelingView:"",DisconnectVirtualMachine:"",ReportLock:"",Uneditable2:"",Uneditable2Mirrored:"",BarChartVerticalEdit:"",GlobalNavButtonActive:"",PollResults:"",Rerun:"",QandA:"",QandAMirror:"",BookAnswers:"",AlertSettings:"",TrimStart:"",TrimEnd:"",TableComputed:"",DecreaseIndentLegacy:"",IncreaseIndentLegacy:"",SizeLegacy:""}};(0,o.registerIcons)(n,t)}var C=function(){(0,o.registerIconAlias)("trash","delete"),(0,o.registerIconAlias)("onedrive","onedrivelogo"),(0,o.registerIconAlias)("alertsolid12","eventdatemissed12"),(0,o.registerIconAlias)("sixpointstar","6pointstar"),(0,o.registerIconAlias)("twelvepointstar","12pointstar"),(0,o.registerIconAlias)("toggleon","toggleleft"),(0,o.registerIconAlias)("toggleoff","toggleright")},_=n(19559);(0,n(30620).v)("@uifabric/icons","7.9.4");var k="https://spoppe-b.azureedge.net/files/fabric-cdn-prod_20210407.001/assets/icons/",E=(0,_.z)();function A(e,t){var n,o,_,A;void 0===e&&(e=(null===(o=null===(n=E)||void 0===n?void 0:n.FabricConfig)||void 0===o?void 0:o.iconBaseUrl)||(null===(A=null===(_=E)||void 0===_?void 0:_.FabricConfig)||void 0===A?void 0:A.fontBaseUrl)||k),[s,r,i,a,l,c,u,d,h,p,f,g,m,y,v,b,S,w,T].forEach((function(n){return n(e,t)})),C()}},17060:(e,t,n)=>{"use strict";function o(e){r!==e&&(r=e)}function s(){return void 0===r&&(r="undefined"!=typeof document&&!!document.documentElement&&"rtl"===document.documentElement.getAttribute("dir")),r}var r;function i(){return{rtl:s()}}n.d(t,{DU:()=>o,Iy:()=>i}),r=s()},95876:(e,t,n)=>{"use strict";n.d(t,{b:()=>r,n:()=>c});var o,s=n(98670),r={none:0,insertNode:1,appendChild:2},i="__stylesheet__",a="undefined"!=typeof navigator&&/rv:11.0/.test(navigator.userAgent),l={};try{l=window}catch(e){}var c=function(){function e(e){this._rules=[],this._preservedRules=[],this._rulesToInsert=[],this._counter=0,this._keyToClassName={},this._onResetCallbacks=[],this._classNameToArgs={},this._config=(0,s.Cl)({injectionMode:r.insertNode,defaultPrefix:"css",namespace:void 0,cspSettings:void 0},e),this._keyToClassName=this._config.classNameCache||{}}return e.getInstance=function(){var t;if(!(o=l[i])||o._lastStyleElement&&o._lastStyleElement.ownerDocument!==document){var n=(null===(t=l)||void 0===t?void 0:t.FabricConfig)||{};o=l[i]=new e(n.mergeStyles)}return o},e.prototype.setConfig=function(e){this._config=(0,s.Cl)((0,s.Cl)({},this._config),e)},e.prototype.onReset=function(e){this._onResetCallbacks.push(e)},e.prototype.getClassName=function(e){var t=this._config.namespace;return(t?t+"-":"")+(e||this._config.defaultPrefix)+"-"+this._counter++},e.prototype.cacheClassName=function(e,t,n,o){this._keyToClassName[t]=e,this._classNameToArgs[e]={args:n,rules:o}},e.prototype.classNameFromKey=function(e){return this._keyToClassName[e]},e.prototype.getClassNameCache=function(){return this._keyToClassName},e.prototype.argsFromClassName=function(e){var t=this._classNameToArgs[e];return t&&t.args},e.prototype.insertedRulesFromClassName=function(e){var t=this._classNameToArgs[e];return t&&t.rules},e.prototype.insertRule=function(e,t){var n=this._config.injectionMode!==r.none?this._getStyleElement():void 0;if(t&&this._preservedRules.push(e),n)switch(this._config.injectionMode){case r.insertNode:var o=n.sheet;try{o.insertRule(e,o.cssRules.length)}catch(e){}break;case r.appendChild:n.appendChild(document.createTextNode(e))}else this._rules.push(e);this._config.onInsertRule&&this._config.onInsertRule(e)},e.prototype.getRules=function(e){return(e?this._preservedRules.join(""):"")+this._rules.join("")+this._rulesToInsert.join("")},e.prototype.reset=function(){this._rules=[],this._rulesToInsert=[],this._counter=0,this._classNameToArgs={},this._keyToClassName={},this._onResetCallbacks.forEach((function(e){return e()}))},e.prototype.resetKeys=function(){this._keyToClassName={}},e.prototype._getStyleElement=function(){var e=this;return this._styleElement||"undefined"==typeof document||(this._styleElement=this._createStyleElement(),a||window.requestAnimationFrame((function(){e._styleElement=void 0}))),this._styleElement},e.prototype._createStyleElement=function(){var e=document.head,t=document.createElement("style"),n=null;t.setAttribute("data-merge-styles","true");var o=this._config.cspSettings;if(o&&o.nonce&&t.setAttribute("nonce",o.nonce),this._lastStyleElement)n=this._lastStyleElement.nextElementSibling;else{var s=this._findPlaceholderStyleTag();n=s?s.nextElementSibling:e.childNodes[0]}return e.insertBefore(t,e.contains(n)?n:null),this._lastStyleElement=t,t},e.prototype._findPlaceholderStyleTag=function(){var e=document.head;return e?e.querySelector("style[data-merge-styles]"):null},e}()},69646:(e,t,n)=>{"use strict";n.d(t,{T:()=>s});var o=n(98670);function s(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(e&&1===e.length&&e[0]&&!e[0].subComponentStyles)return e[0];for(var n={},r={},i=0,a=e;i<a.length;i++){var l=a[i];if(l)for(var c in l)if(l.hasOwnProperty(c)){if("subComponentStyles"===c&&void 0!==l.subComponentStyles){var u=l.subComponentStyles;for(var d in u)u.hasOwnProperty(d)&&(r.hasOwnProperty(d)?r[d].push(u[d]):r[d]=[u[d]]);continue}var h=n[c],p=l[c];n[c]=void 0===h?p:(0,o.aN)(Array.isArray(h)?h:[h],Array.isArray(p)?p:[p])}}if(Object.keys(r).length>0){n.subComponentStyles={};var f=n.subComponentStyles,g=function(e){if(r.hasOwnProperty(e)){var t=r[e];f[e]=function(e){return s.apply(void 0,t.map((function(t){return"function"==typeof t?t(e):t})))}}};for(var d in r)g(d)}return n}},49742:(e,t,n)=>{"use strict";n.d(t,{p:()=>s});var o=n(69646);function s(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var s=[],r=0,i=t;r<i.length;r++){var a=i[r];a&&s.push("function"==typeof a?a(e):a)}return 1===s.length?s[0]:s.length?o.T.apply(void 0,s):{}}},39718:(e,t,n)=>{"use strict";n.d(t,{h:()=>s});var o=n(95876);function s(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=[],s=[],r=o.n.getInstance();return function e(t){for(var o=0,i=t;o<i.length;o++){var a=i[o];if(a)if("string"==typeof a)if(a.indexOf(" ")>=0)e(a.split(" "));else{var l=r.argsFromClassName(a);l?e(l):-1===n.indexOf(a)&&n.push(a)}else Array.isArray(a)?e(a):"object"==typeof a&&s.push(a)}}(e),{classes:n,objects:s}}},3864:(e,t,n)=>{"use strict";n.d(t,{n:()=>i});var o=n(17060),s=n(95876),r=n(81992);function i(e){s.n.getInstance().insertRule("@font-face{"+(0,r.bz)((0,o.Iy)(),e)+"}",!0)}},88063:(e,t,n)=>{"use strict";n.d(t,{i:()=>i});var o=n(17060),s=n(95876),r=n(81992);function i(e){var t=s.n.getInstance(),n=t.getClassName(),i=[];for(var a in e)e.hasOwnProperty(a)&&i.push(a,"{",(0,r.bz)((0,o.Iy)(),e[a]),"}");var l=i.join("");return t.insertRule("@keyframes "+n+"{"+l+"}",!0),t.cacheClassName(n,l,[],["keyframes",l]),n}},46208:(e,t,n)=>{"use strict";n.d(t,{L:()=>l,l:()=>a});var o=n(69646),s=n(39718),r=n(17060),i=n(81992);function a(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return l(e,(0,r.Iy)())}function l(e,t){var n,r,a={subComponentStyles:{}};if(!e[0]&&e.length<=1)return{subComponentStyles:{}};var l=o.T.apply(void 0,e),c=[];for(var u in l)if(l.hasOwnProperty(u)){if("subComponentStyles"===u){a.subComponentStyles=l.subComponentStyles||{};continue}var d=l[u],h=(0,s.h)(d),p=h.classes,f=h.objects;(null===(n=f)||void 0===n?void 0:n.length)?(y=(0,i.GJ)(t||{},{displayName:u},f))&&(c.push(y),a[u]=p.concat([y.className]).join(" ")):a[u]=p.join(" ")}for(var g=0,m=c;g<m.length;g++){var y;(y=m[g])&&(0,i.Ae)(y,null===(r=t)||void 0===r?void 0:r.specificityMultiplier)}return a}},16536:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i,e:()=>a});var o=n(39718),s=n(17060),r=n(81992);function i(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a(e,(0,s.Iy)())}function a(e,t){var n=e instanceof Array?e:[e],s=(0,o.h)(n),i=s.classes,a=s.objects;return a.length&&i.push((0,r.kG)(t||{},a)),i.join(" ")}},81992:(e,t,n)=>{"use strict";n.d(t,{Ae:()=>A,bz:()=>k,kG:()=>I,GJ:()=>E});var o,s=n(98670),r=n(95876),i={},a={"user-select":1};function l(e,t){var n=function(){var e,t;if(!o){var n="undefined"!=typeof document?document:void 0,s="undefined"!=typeof navigator?navigator:void 0,r=null===(t=null===(e=s)||void 0===e?void 0:e.userAgent)||void 0===t?void 0:t.toLowerCase();o=n?{isWebkit:!(!n||!("WebkitAppearance"in n.documentElement.style)),isMoz:!!(r&&r.indexOf("firefox")>-1),isOpera:!!(r&&r.indexOf("opera")>-1),isMs:!(!s||!/rv:11.0/i.test(s.userAgent)&&!/Edge\/\d./i.test(navigator.userAgent))}:{isWebkit:!0,isMoz:!0,isOpera:!0,isMs:!0}}return o}(),s=e[t];if(a[s]){var r=e[t+1];a[s]&&(n.isWebkit&&e.push("-webkit-"+s,r),n.isMoz&&e.push("-moz-"+s,r),n.isMs&&e.push("-ms-"+s,r),n.isOpera&&e.push("-o-"+s,r))}}var c,u=["column-count","font-weight","flex","flex-grow","flex-shrink","fill-opacity","opacity","order","z-index","zoom"];function d(e,t){var n=e[t],o=e[t+1];if("number"==typeof o){var s=u.indexOf(n)>-1,r=n.indexOf("--")>-1,i=s||r?"":"px";e[t+1]=""+o+i}}var h="left",p="right",f="@noflip",g=((c={})[h]=p,c[p]=h,c),m={"w-resize":"e-resize","sw-resize":"se-resize","nw-resize":"ne-resize"};function y(e,t,n){if(e.rtl){var o=t[n];if(!o)return;var s=t[n+1];if("string"==typeof s&&s.indexOf(f)>=0)t[n+1]=s.replace(/\s*(?:\/\*\s*)?\@noflip\b(?:\s*\*\/)?\s*?/g,"");else if(o.indexOf(h)>=0)t[n]=o.replace(h,p);else if(o.indexOf(p)>=0)t[n]=o.replace(p,h);else if(String(s).indexOf(h)>=0)t[n+1]=s.replace(h,p);else if(String(s).indexOf(p)>=0)t[n+1]=s.replace(p,h);else if(g[o])t[n]=g[o];else if(m[s])t[n+1]=m[s];else switch(o){case"margin":case"padding":t[n+1]=function(e){if("string"==typeof e){var t=e.split(" ");if(4===t.length)return t[0]+" "+t[3]+" "+t[2]+" "+t[1]}return e}(s);break;case"box-shadow":t[n+1]=function(e){var t=e.split(" "),n=parseInt(t[0],10);return t[0]=t[0].replace(String(n),String(-1*n)),t.join(" ")}(s)}}}var v="displayName",b=/\:global\((.+?)\)/g;function S(e,t){return e.indexOf(":global(")>=0?e.replace(b,"$1"):0===e.indexOf(":")?t+e:e.indexOf("&")<0?t+" "+e:e}function w(e,t,n,o){void 0===t&&(t={__order:[]}),0===n.indexOf("@")?T([o],t,n=n+"{"+e):n.indexOf(",")>-1?function(e){if(!b.test(e))return e;for(var t=[],n=/\:global\((.+?)\)/g,o=null;o=n.exec(e);)o[1].indexOf(",")>-1&&t.push([o.index,o.index+o[0].length,o[1].split(",").map((function(e){return":global("+e.trim()+")"})).join(", ")]);return t.reverse().reduce((function(e,t){var n=t[0],o=t[1],s=t[2];return e.slice(0,n)+s+e.slice(o)}),e)}(n).split(",").map((function(e){return e.trim()})).forEach((function(n){return T([o],t,S(n,e))})):T([o],t,S(n,e))}function T(e,t,n){void 0===t&&(t={__order:[]}),void 0===n&&(n="&");var o=r.n.getInstance(),s=t[n];s||(s={},t[n]=s,t.__order.push(n));for(var i=0,a=e;i<a.length;i++){var l=a[i];if("string"==typeof l){var c=o.argsFromClassName(l);c&&T(c,t,n)}else if(Array.isArray(l))T(l,t,n);else for(var u in l)if(l.hasOwnProperty(u)){var d=l[u];if("selectors"===u){var h=l.selectors;for(var p in h)h.hasOwnProperty(p)&&w(n,t,p,h[p])}else"object"==typeof d?null!==d&&w(n,t,u,d):void 0!==d&&("margin"===u||"padding"===u?C(s,u,d):s[u]=d)}}return t}function C(e,t,n){var o="string"==typeof n?n.split(" "):[n];e[t+"Top"]=o[0],e[t+"Right"]=o[1]||o[0],e[t+"Bottom"]=o[2]||o[0],e[t+"Left"]=o[3]||o[1]||o[0]}function _(e,t){return t<=0?"":1===t?e:e+_(e,t-1)}function k(e,t){if(!t)return"";var n,o,s,r=[];for(var a in t)t.hasOwnProperty(a)&&a!==v&&void 0!==t[a]&&r.push(a,t[a]);for(var c=0;c<r.length;c+=2)s=void 0,"-"!==(s=(n=r)[o=c]).charAt(0)&&(n[o]=i[s]=i[s]||s.replace(/([A-Z])/g,"-$1").toLowerCase()),d(r,c),y(e,r,c),l(r,c);for(c=1;c<r.length;c+=4)r.splice(c,1,":",r[c],";");return r.join("")}function E(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=T(t),s=function(e,t){for(var n=[e.rtl?"rtl":"ltr"],o=!1,s=0,r=t.__order;s<r.length;s++){var i=r[s];n.push(i);var a=t[i];for(var l in a)a.hasOwnProperty(l)&&void 0!==a[l]&&(o=!0,n.push(l,a[l]))}return o?n.join(""):void 0}(e,o);if(s){var i=r.n.getInstance(),a={className:i.classNameFromKey(s),key:s,args:t};if(!a.className){a.className=i.getClassName(function(e){var t=e&&e["&"];return t?t.displayName:void 0}(o));for(var l=[],c=0,u=o.__order;c<u.length;c++){var d=u[c];l.push(d,k(e,o[d]))}a.rulesToInsert=l}return a}}function A(e,t){void 0===t&&(t=1);var n=r.n.getInstance(),o=e.className,s=e.key,i=e.args,a=e.rulesToInsert;if(a){for(var l=0;l<a.length;l+=2){var c=a[l+1];if(c){var u=a[l],d=(u=u.replace(/&/g,_("."+e.className,t)))+"{"+c+"}"+(0===u.indexOf("@")?"}":"");n.insertRule(d)}}n.cacheClassName(o,s,i,a)}}function I(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=E.apply(void 0,(0,s.aN)([e],t));return o?(A(o,e.specificityMultiplier),o.className):""}},786:(e,t,n)=>{"use strict";n.d(t,{d:()=>s});var o=n(30538);function s(e){var t=o.useRef();return void 0===t.current&&(t.current={value:"function"==typeof e?e():e}),t.current.value}},80882:(e,t,n)=>{"use strict";n.d(t,{x:()=>r});var o=n(97778),s=n(30538);function r(e,t,n,r){var i=s.useRef(n);i.current=n,s.useEffect((function(){var n=e&&"current"in e?e.current:e;if(n)return(0,o.on)(n,t,(function(e){return i.current(e)}),r)}),[e,t,r])}},70052:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var o=n(30538);function s(e){var t=(0,o.useRef)();return(0,o.useEffect)((function(){t.current=e})),t.current}},30620:(e,t,n)=>{"use strict";n.d(t,{v:()=>r});var o={},s=void 0;try{s=window}catch(e){}function r(e,t){if(void 0!==s){var n=s.__packages__=s.__packages__||{};n[e]&&o[e]||(o[e]=t,(n[e]=n[e]||[]).push(t))}}r("@uifabric/set-version","6.0.0")},84461:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AnimationClassNames:()=>Y,AnimationStyles:()=>V,AnimationVariables:()=>$,ColorClassNames:()=>fe,DefaultEffects:()=>ye.W,DefaultFontStyles:()=>X.d,DefaultPalette:()=>ee.b,EdgeChromiumHighContrastSelector:()=>Ce,FontClassNames:()=>Z,FontSizes:()=>ve.s,FontWeights:()=>ve.BO,HighContrastSelector:()=>Se,HighContrastSelectorBlack:()=>Te,HighContrastSelectorWhite:()=>we,IconFontSizes:()=>ve.fF,InjectionMode:()=>Ye.b,PulsingBeaconAnimationStyles:()=>Ke,ScreenWidthMaxLarge:()=>Re,ScreenWidthMaxMedium:()=>xe,ScreenWidthMaxSmall:()=>Me,ScreenWidthMaxXLarge:()=>De,ScreenWidthMaxXXLarge:()=>Oe,ScreenWidthMinLarge:()=>Ee,ScreenWidthMinMedium:()=>ke,ScreenWidthMinSmall:()=>_e,ScreenWidthMinUhfMobile:()=>Ne,ScreenWidthMinXLarge:()=>Ae,ScreenWidthMinXXLarge:()=>Ie,ScreenWidthMinXXXLarge:()=>Pe,Stylesheet:()=>Ye.n,ThemeSettingName:()=>le,ZIndexes:()=>We,buildClassMap:()=>s,concatStyleSets:()=>kt.T,concatStyleSetsWithProps:()=>Et.p,createFontStyles:()=>be.s,createTheme:()=>re.a,focusClear:()=>He,fontFace:()=>dt.n,getEdgeChromiumNoHighContrastAdjustSelector:()=>Be,getFadedOverflowStyle:()=>it,getFocusOutlineStyle:()=>qe,getFocusStyle:()=>Ge,getGlobalClassNames:()=>Ze,getHighContrastNoAdjustStyle:()=>Fe,getIcon:()=>vt,getIconClassName:()=>_t,getInputFocusStyle:()=>$e,getPlaceholderStyles:()=>lt,getScreenSelector:()=>Le,getTheme:()=>ue,getThemedContext:()=>tt,hiddenContentStyle:()=>Ve,keyframes:()=>r.i,loadTheme:()=>pe,mergeStyleSets:()=>At.l,mergeStyles:()=>o.Z,noWrap:()=>ot,normalize:()=>nt,registerDefaultFontFaces:()=>X.a,registerIconAlias:()=>yt,registerIcons:()=>gt,registerOnThemeChangeCallback:()=>de,removeOnThemeChangeCallback:()=>he,setIconOptions:()=>bt,unregisterIcons:()=>mt});var o=n(16536);function s(e){var t={},n=function(n){var s;e.hasOwnProperty(n)&&Object.defineProperty(t,n,{get:function(){return void 0===s&&(s=(0,o.Z)(e[n]).toString()),s},enumerable:!0,configurable:!0})};for(var s in e)n(s);return t}var r=n(88063),i="cubic-bezier(.1,.9,.2,1)",a="cubic-bezier(.1,.25,.75,.9)",l="0.167s",c="0.267s",u="0.367s",d="0.467s",h=(0,r.i)({from:{opacity:0},to:{opacity:1}}),p=(0,r.i)({from:{opacity:1},to:{opacity:0,visibility:"hidden"}}),f=j(-10),g=j(-20),m=j(-40),y=j(-400),v=j(10),b=j(20),S=j(40),w=j(400),T=Q(10),C=Q(20),_=Q(-10),k=Q(-20),E=J(10),A=J(20),I=J(40),P=J(400),M=J(-10),x=J(-20),R=J(-40),D=J(-400),O=K(-10),N=K(-20),L=K(10),F=K(20),B=(0,r.i)({from:{transform:"scale3d(.98,.98,1)"},to:{transform:"scale3d(1,1,1)"}}),W=(0,r.i)({from:{transform:"scale3d(1,1,1)"},to:{transform:"scale3d(.98,.98,1)"}}),U=(0,r.i)({from:{transform:"scale3d(1.03,1.03,1)"},to:{transform:"scale3d(1,1,1)"}}),G=(0,r.i)({from:{transform:"scale3d(1,1,1)"},to:{transform:"scale3d(1.03,1.03,1)"}}),H=(0,r.i)({from:{transform:"rotateZ(0deg)"},to:{transform:"rotateZ(90deg)"}}),q=(0,r.i)({from:{transform:"rotateZ(0deg)"},to:{transform:"rotateZ(-90deg)"}}),$={easeFunction1:i,easeFunction2:a,durationValue1:l,durationValue2:c,durationValue3:u,durationValue4:d},V={slideRightIn10:z(h+","+f,u,i),slideRightIn20:z(h+","+g,u,i),slideRightIn40:z(h+","+m,u,i),slideRightIn400:z(h+","+y,u,i),slideLeftIn10:z(h+","+v,u,i),slideLeftIn20:z(h+","+b,u,i),slideLeftIn40:z(h+","+S,u,i),slideLeftIn400:z(h+","+w,u,i),slideUpIn10:z(h+","+T,u,i),slideUpIn20:z(h+","+C,u,i),slideDownIn10:z(h+","+_,u,i),slideDownIn20:z(h+","+k,u,i),slideRightOut10:z(p+","+E,u,i),slideRightOut20:z(p+","+A,u,i),slideRightOut40:z(p+","+I,u,i),slideRightOut400:z(p+","+P,u,i),slideLeftOut10:z(p+","+M,u,i),slideLeftOut20:z(p+","+x,u,i),slideLeftOut40:z(p+","+R,u,i),slideLeftOut400:z(p+","+D,u,i),slideUpOut10:z(p+","+O,u,i),slideUpOut20:z(p+","+N,u,i),slideDownOut10:z(p+","+L,u,i),slideDownOut20:z(p+","+F,u,i),scaleUpIn100:z(h+","+B,u,i),scaleDownIn100:z(h+","+U,u,i),scaleUpOut103:z(p+","+G,l,a),scaleDownOut98:z(p+","+W,l,a),fadeIn100:z(h,l,a),fadeIn200:z(h,c,a),fadeIn400:z(h,u,a),fadeIn500:z(h,d,a),fadeOut100:z(p,l,a),fadeOut200:z(p,c,a),fadeOut400:z(p,u,a),fadeOut500:z(p,d,a),rotate90deg:z(H,"0.1s",a),rotateN90deg:z(q,"0.1s",a)};function z(e,t,n){return{animationName:e,animationDuration:t,animationTimingFunction:n,animationFillMode:"both"}}function j(e){return(0,r.i)({from:{transform:"translate3d("+e+"px,0,0)",pointerEvents:"none"},to:{transform:"translate3d(0,0,0)",pointerEvents:"auto"}})}function Q(e){return(0,r.i)({from:{transform:"translate3d(0,"+e+"px,0)",pointerEvents:"none"},to:{transform:"translate3d(0,0,0)",pointerEvents:"auto"}})}function J(e){return(0,r.i)({from:{transform:"translate3d(0,0,0)"},to:{transform:"translate3d("+e+"px,0,0)"}})}function K(e){return(0,r.i)({from:{transform:"translate3d(0,0,0)"},to:{transform:"translate3d(0,"+e+"px,0)"}})}var Y=s(V),X=n(60203),Z=s(X.d),ee=n(59981),te=n(98670),ne=n(19559),oe=n(24301),se=n(92132),re=n(46401),ie=(0,re.a)({}),ae=[],le="theme";function ce(){var e,t,n,o,s,r=(0,ne.z)();(null===(n=null===(t=r)||void 0===t?void 0:t.FabricConfig)||void 0===n?void 0:n.legacyTheme)?pe(r.FabricConfig.legacyTheme):oe.X.getSettings([le]).theme||((null===(s=null===(o=r)||void 0===o?void 0:o.FabricConfig)||void 0===s?void 0:s.theme)&&(ie=(0,re.a)(r.FabricConfig.theme)),oe.X.applySettings(((e={})[le]=ie,e)))}function ue(e){return void 0===e&&(e=!1),!0===e&&(ie=(0,re.a)({},e)),ie}function de(e){-1===ae.indexOf(e)&&ae.push(e)}function he(e){var t=ae.indexOf(e);-1!==t&&ae.splice(t,1)}function pe(e,t){var n;return void 0===t&&(t=!1),ie=(0,re.a)(e,t),(0,se.EQ)((0,te.Cl)((0,te.Cl)((0,te.Cl)((0,te.Cl)({},ie.palette),ie.semanticColors),ie.effects),function(e){for(var t={},n=0,o=Object.keys(e.fonts);n<o.length;n++)for(var s=o[n],r=e.fonts[s],i=0,a=Object.keys(r);i<a.length;i++){var l=a[i],c=s+l.charAt(0).toUpperCase()+l.slice(1),u=r[l];"fontSize"===l&&"number"==typeof u&&(u+="px"),t[c]=u}return t}(ie))),oe.X.applySettings(((n={})[le]=ie,n)),ae.forEach((function(e){try{e(ie)}catch(e){}})),ie}ce();var fe={};for(var ge in ee.b)ee.b.hasOwnProperty(ge)&&(me(fe,ge,"",!1,"color"),me(fe,ge,"Hover",!0,"color"),me(fe,ge,"Background",!1,"background"),me(fe,ge,"BackgroundHover",!0,"background"),me(fe,ge,"Border",!1,"borderColor"),me(fe,ge,"BorderHover",!0,"borderColor"));function me(e,t,n,s,r){Object.defineProperty(e,t+n,{get:function(){var e,n=((e={})[r]=ue().palette[t],e);return(0,o.Z)(s?{selectors:{":hover":n}}:n).toString()},enumerable:!0,configurable:!0})}var ye=n(70944),ve=n(79805),be=n(33630),Se="@media screen and (-ms-high-contrast: active), screen and (forced-colors: active)",we="@media screen and (-ms-high-contrast: black-on-white), screen and (forced-colors: active) and (prefers-color-scheme: light)",Te="@media screen and (-ms-high-contrast: white-on-black), screen and (forced-colors: active) and (prefers-color-scheme: dark)",Ce="@media screen and (-ms-high-contrast: active), screen and (forced-colors: active)",_e=320,ke=480,Ee=640,Ae=1024,Ie=1366,Pe=1920,Me=ke-1,xe=Ee-1,Re=Ae-1,De=Ie-1,Oe=Pe-1,Ne=768;function Le(e,t){return"@media only screen"+("number"==typeof e?" and (min-width: "+e+"px)":"")+("number"==typeof t?" and (max-width: "+t+"px)":"")}function Fe(){return{forcedColorAdjust:"none",MsHighContrastAdjust:"none"}}function Be(){var e;return(e={})[Ce]={forcedColorAdjust:"none",MsHighContrastAdjust:"none"},e}var We,Ue=n(69746);function Ge(e,t,n,o,s,r,i){return function(e,t){var n,o;void 0===t&&(t={});var s=t.inset,r=void 0===s?0:s,i=t.width,a=void 0===i?1:i,l=t.position,c=void 0===l?"relative":l,u=t.highContrastStyle,d=t.borderColor,h=void 0===d?e.palette.white:d,p=t.outlineColor,f=void 0===p?e.palette.neutralSecondary:p,g=t.isFocusedOnly,m=void 0===g||g;return{outline:"transparent",position:c,selectors:(n={"::-moz-focus-inner":{border:"0"}},n["."+Ue.Y2+" &"+(m?":focus":"")+":after"]={content:'""',position:"absolute",left:r+1,top:r+1,bottom:r+1,right:r+1,border:a+"px solid "+h,outline:a+"px solid "+f,zIndex:We.FocusStyle,selectors:(o={},o[Se]=u,o)},n)}}(e,"number"!=typeof t&&t?t:{inset:t,position:n,highContrastStyle:o,borderColor:s,outlineColor:r,isFocusedOnly:i})}function He(){return{selectors:{"&::-moz-focus-inner":{border:0},"&":{outline:"transparent"}}}}function qe(e,t,n,o){var s;return void 0===t&&(t=0),void 0===n&&(n=1),{selectors:(s={},s[":global("+Ue.Y2+") &:focus"]={outline:n+" solid "+(o||e.palette.neutralSecondary),outlineOffset:-t+"px"},s)}}!function(e){e.Nav=1,e.ScrollablePane=1,e.FocusStyle=1,e.Coachmark=1e3,e.Layer=1e6,e.KeytipLayer=1000001}(We||(We={}));var $e=function(e,t,n,o){var s,r,i;void 0===n&&(n="border"),void 0===o&&(o=-1);var a="borderBottom"===n;return{borderColor:e,selectors:{":after":(s={pointerEvents:"none",content:"''",position:"absolute",left:a?0:o,top:o,bottom:o,right:a?0:o},s[n]="2px solid "+e,s.borderRadius=t,s.width="borderBottom"===n?"100%":void 0,s.selectors=(r={},r[Se]=(i={},i["border"===n?"borderColor":"borderBottomColor"]="Highlight",i),r),s)}}},Ve={position:"absolute",width:1,height:1,margin:-1,padding:0,border:0,overflow:"hidden"};function ze(e,t){return{borderColor:e,borderWidth:"0px",width:t,height:t}}function je(e){return{opacity:1,borderWidth:e}}function Qe(e,t){return{borderWidth:"0",width:t,height:t,opacity:0,borderColor:e}}function Je(e,t){return(0,te.Cl)((0,te.Cl)({},ze(e,t)),{opacity:0})}var Ke={continuousPulseAnimationDouble:function(e,t,n,o,s){return(0,r.i)({"0%":ze(e,n),"1.42%":je(s),"3.57%":{opacity:1},"7.14%":Qe(t,o),"8%":Je(e,n),"29.99%":Je(e,n),"30%":ze(e,n),"31.42%":je(s),"33.57%":{opacity:1},"37.14%":Qe(t,o),"38%":Je(e,n),"79.42%":Je(e,n),79.43:ze(e,n),81.85:je(s),83.42:{opacity:1},"87%":Qe(t,o),"100%":{}})},continuousPulseAnimationSingle:function(e,t,n,o,s){return(0,r.i)({"0%":ze(e,n),"14.2%":je(s),"35.7%":{opacity:1},"71.4%":Qe(t,o),"100%":{}})},createDefaultAnimation:function(e,t){return{animationName:e,animationIterationCount:"1",animationDuration:"14s",animationDelay:t||"2s"}}},Ye=n(95876),Xe=(0,n(78572).J9)((function(e,t){var n=Ye.n.getInstance();return t?Object.keys(e).reduce((function(t,o){return t[o]=n.getClassName(e[o]),t}),{}):e}));function Ze(e,t,n){return Xe(e,void 0!==n?n:t.disableGlobalClassNames)}var et=n(49814);function tt(e,t,n){var o,s=e,r=n||oe.X.getSettings(["theme"],void 0,e.customizations).theme;n&&(o={theme:n});var i=t&&r&&r.schemes&&r.schemes[t];return r&&i&&r!==i&&((o={theme:i}).theme.schemes=r.schemes),o&&(s={customizations:{settings:(0,et.s)(e.customizations.settings,o),scopedSettings:e.customizations.scopedSettings}}),s}var nt={boxShadow:"none",margin:0,padding:0,boxSizing:"border-box"},ot={overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},st="50%",rt=20;function it(e,t,n,o,s){void 0===t&&(t="bodyBackground"),void 0===n&&(n="horizontal"),void 0===o&&(o=at("width",n)),void 0===s&&(s=at("height",n));var r=e.semanticColors[t]||e.palette[t],i=function(e){if("#"===e[0])return{r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16)};if(0===e.indexOf("rgba(")){var t=(e=e.match(/rgba\(([^)]+)\)/)[1]).split(/ *, */).map(Number);return{r:t[0],g:t[1],b:t[2]}}return{r:255,g:255,b:255}}(r);return{content:'""',position:"absolute",right:0,bottom:0,width:o,height:s,pointerEvents:"none",backgroundImage:"linear-gradient("+("vertical"===n?"to bottom":"to right")+", rgba("+i.r+", "+i.g+", "+i.b+", 0) 0%, "+r+" 100%)"}}function at(e,t){return"width"===e?"horizontal"===t?rt:"100%":"vertical"===t?st:"100%"}function lt(e){return{selectors:{"::placeholder":e,":-ms-input-placeholder":e,"::-ms-input-placeholder":e}}}var ct=n(9724),ut=n(82729),dt=n(3864),ht=ct.h.getValue("icons",{__options:{disableWarnings:!1,warnOnMissingIcons:!0},__remapped:{}}),pt=Ye.n.getInstance();pt&&pt.onReset&&pt.onReset((function(){for(var e in ht)ht.hasOwnProperty(e)&&ht[e].subset&&(ht[e].subset.className=void 0)}));var ft=function(e){return e.toLowerCase()};function gt(e,t){var n=(0,te.Cl)((0,te.Cl)({},e),{isRegistered:!1,className:void 0}),o=e.icons;for(var s in t=t?(0,te.Cl)((0,te.Cl)({},ht.__options),t):ht.__options,o)if(o.hasOwnProperty(s)){var r=o[s],i=ft(s);ht[i]?Tt(s):ht[i]={code:r,subset:n}}}function mt(e){for(var t=ht.__options,n=function(e){var n=ft(e);ht[n]?delete ht[n]:t.disableWarnings||(0,ut.R)('The icon "'+e+'" tried to unregister but was not registered.'),ht.__remapped[n]&&delete ht.__remapped[n],Object.keys(ht.__remapped).forEach((function(e){ht.__remapped[e]===n&&delete ht.__remapped[e]}))},o=0,s=e;o<s.length;o++)n(s[o])}function yt(e,t){ht.__remapped[ft(e)]=ft(t)}function vt(e){var t=void 0,n=ht.__options;if(e=e?ft(e):"",e=ht.__remapped[e]||e)if(t=ht[e]){var s=t.subset;s&&s.fontFace&&(s.isRegistered||((0,dt.n)(s.fontFace),s.isRegistered=!0),s.className||(s.className=(0,o.Z)(s.style,{fontFamily:s.fontFace.fontFamily,fontWeight:s.fontFace.fontWeight||"normal",fontStyle:s.fontFace.fontStyle||"normal"})))}else!n.disableWarnings&&n.warnOnMissingIcons&&(0,ut.R)('The icon "'+e+'" was used but not registered. See https://github.com/microsoft/fluentui/wiki/Using-icons for more information.');return t}function bt(e){ht.__options=(0,te.Cl)((0,te.Cl)({},ht.__options),e)}var St=[],wt=void 0;function Tt(e){ht.__options.disableWarnings||(St.push(e),void 0===wt&&(wt=setTimeout((function(){(0,ut.R)("Some icons were re-registered. Applications should only call registerIcons for any given icon once. Redefining what an icon is may have unintended consequences. Duplicates include: \n"+St.slice(0,10).join(", ")+(St.length>10?" (+ "+(St.length-10)+" more)":"")),wt=void 0,St=[]}),2e3)))}var Ct={display:"inline-block"};function _t(e){var t="",n=vt(e);return n&&(t=(0,o.Z)(n.subset.className,Ct,{selectors:{"::before":{content:'"'+n.code+'"'}}})),t}var kt=n(69646),Et=n(49742),At=n(46208);(0,n(30620).v)("@uifabric/styling","7.25.0"),ce()},18264:(e,t,n)=>{"use strict";n.d(t,{j:()=>s});var o=n(19559),s=function(){function e(e,t){this._timeoutIds=null,this._immediateIds=null,this._intervalIds=null,this._animationFrameIds=null,this._isDisposed=!1,this._parent=e||null,this._onErrorHandler=t,this._noop=function(){}}return e.prototype.dispose=function(){var e;if(this._isDisposed=!0,this._parent=null,this._timeoutIds){for(e in this._timeoutIds)this._timeoutIds.hasOwnProperty(e)&&this.clearTimeout(parseInt(e,10));this._timeoutIds=null}if(this._immediateIds){for(e in this._immediateIds)this._immediateIds.hasOwnProperty(e)&&this.clearImmediate(parseInt(e,10));this._immediateIds=null}if(this._intervalIds){for(e in this._intervalIds)this._intervalIds.hasOwnProperty(e)&&this.clearInterval(parseInt(e,10));this._intervalIds=null}if(this._animationFrameIds){for(e in this._animationFrameIds)this._animationFrameIds.hasOwnProperty(e)&&this.cancelAnimationFrame(parseInt(e,10));this._animationFrameIds=null}},e.prototype.setTimeout=function(e,t){var n=this,o=0;return this._isDisposed||(this._timeoutIds||(this._timeoutIds={}),o=setTimeout((function(){try{n._timeoutIds&&delete n._timeoutIds[o],e.apply(n._parent)}catch(e){n._onErrorHandler&&n._onErrorHandler(e)}}),t),this._timeoutIds[o]=!0),o},e.prototype.clearTimeout=function(e){this._timeoutIds&&this._timeoutIds[e]&&(clearTimeout(e),delete this._timeoutIds[e])},e.prototype.setImmediate=function(e,t){var n=this,s=0,r=(0,o.z)(t);return this._isDisposed||(this._immediateIds||(this._immediateIds={}),s=r.setTimeout((function(){try{n._immediateIds&&delete n._immediateIds[s],e.apply(n._parent)}catch(e){n._logError(e)}}),0),this._immediateIds[s]=!0),s},e.prototype.clearImmediate=function(e,t){var n=(0,o.z)(t);this._immediateIds&&this._immediateIds[e]&&(n.clearTimeout(e),delete this._immediateIds[e])},e.prototype.setInterval=function(e,t){var n=this,o=0;return this._isDisposed||(this._intervalIds||(this._intervalIds={}),o=setInterval((function(){try{e.apply(n._parent)}catch(e){n._logError(e)}}),t),this._intervalIds[o]=!0),o},e.prototype.clearInterval=function(e){this._intervalIds&&this._intervalIds[e]&&(clearInterval(e),delete this._intervalIds[e])},e.prototype.throttle=function(e,t,n){var o=this;if(this._isDisposed)return this._noop;var s,r,i=t||0,a=!0,l=!0,c=0,u=null;n&&"boolean"==typeof n.leading&&(a=n.leading),n&&"boolean"==typeof n.trailing&&(l=n.trailing);var d=function(t){var n=Date.now(),h=n-c,p=a?i-h:i;return h>=i&&(!t||a)?(c=n,u&&(o.clearTimeout(u),u=null),s=e.apply(o._parent,r)):null===u&&l&&(u=o.setTimeout(d,p)),s};return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r=e,d(!0)}},e.prototype.debounce=function(e,t,n){var o=this;if(this._isDisposed){var s=function(){};return s.cancel=function(){},s.flush=function(){return null},s.pending=function(){return!1},s}var r,i,a=t||0,l=!1,c=!0,u=null,d=0,h=Date.now(),p=null;n&&"boolean"==typeof n.leading&&(l=n.leading),n&&"boolean"==typeof n.trailing&&(c=n.trailing),n&&"number"==typeof n.maxWait&&!isNaN(n.maxWait)&&(u=n.maxWait);var f=function(e){p&&(o.clearTimeout(p),p=null),h=e},g=function(t){f(t),r=e.apply(o._parent,i)},m=function(e){var t=Date.now(),n=!1;e&&(l&&t-d>=a&&(n=!0),d=t);var s=t-d,i=a-s,f=t-h,y=!1;return null!==u&&(f>=u&&p?y=!0:i=Math.min(i,u-f)),s>=a||y||n?g(t):null!==p&&e||!c||(p=o.setTimeout(m,i)),r},y=function(){return!!p},v=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i=e,m(!0)};return v.cancel=function(){y()&&f(Date.now())},v.flush=function(){return y()&&g(Date.now()),r},v.pending=y,v},e.prototype.requestAnimationFrame=function(e,t){var n=this,s=0,r=(0,o.z)(t);if(!this._isDisposed){this._animationFrameIds||(this._animationFrameIds={});var i=function(){try{n._animationFrameIds&&delete n._animationFrameIds[s],e.apply(n._parent)}catch(e){n._logError(e)}};s=r.requestAnimationFrame?r.requestAnimationFrame(i):r.setTimeout(i,0),this._animationFrameIds[s]=!0}return s},e.prototype.cancelAnimationFrame=function(e,t){var n=(0,o.z)(t);this._animationFrameIds&&this._animationFrameIds[e]&&(n.cancelAnimationFrame?n.cancelAnimationFrame(e):n.clearTimeout(e),delete this._animationFrameIds[e])},e.prototype._logError=function(e){this._onErrorHandler&&this._onErrorHandler(e)},e}()},38480:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var o=n(2941),s=n(58207),r=n(16285),i=100,a=function(){function e(e){this._events=new o.g(this),this._scrollableParent=(0,s.Hc)(e),this._incrementScroll=this._incrementScroll.bind(this),this._scrollRect=(0,r.l)(this._scrollableParent),this._scrollableParent===window&&(this._scrollableParent=document.body),this._scrollableParent&&(this._events.on(window,"mousemove",this._onMouseMove,!0),this._events.on(window,"touchmove",this._onTouchMove,!0))}return e.prototype.dispose=function(){this._events.dispose(),this._stopScroll()},e.prototype._onMouseMove=function(e){this._computeScrollVelocity(e)},e.prototype._onTouchMove=function(e){e.touches.length>0&&this._computeScrollVelocity(e)},e.prototype._computeScrollVelocity=function(e){if(this._scrollRect){var t,n;"clientX"in e?(t=e.clientX,n=e.clientY):(t=e.touches[0].clientX,n=e.touches[0].clientY);var o,s,r,a=this._scrollRect.top,l=this._scrollRect.left,c=a+this._scrollRect.height-i,u=l+this._scrollRect.width-i;n<a+i||n>c?(s=n,o=a,r=c,this._isVerticalScroll=!0):(s=t,o=l,r=u,this._isVerticalScroll=!1),this._scrollVelocity=s<o+i?Math.max(-15,(i-(s-o))/i*-15):s>r?Math.min(15,(s-r)/i*15):0,this._scrollVelocity?this._startScroll():this._stopScroll()}},e.prototype._startScroll=function(){this._timeoutId||this._incrementScroll()},e.prototype._incrementScroll=function(){this._scrollableParent&&(this._isVerticalScroll?this._scrollableParent.scrollTop+=Math.round(this._scrollVelocity):this._scrollableParent.scrollLeft+=Math.round(this._scrollVelocity)),this._timeoutId=setTimeout(this._incrementScroll,16)},e.prototype._stopScroll=function(){this._timeoutId&&(clearTimeout(this._timeoutId),delete this._timeoutId)},e}()},18064:(e,t,n)=>{"use strict";n.d(t,{$:()=>u,K:()=>h});var o=n(98670),s=n(30538),r=n(18264),i=n(2941),a=n(11641),l=n(34924),c=n(74010),u=function(e){function t(n,o){var s=e.call(this,n,o)||this;return function(e,t,n){for(var o=0,s=n.length;o<s;o++)d(e,t,n[o])}(s,t.prototype,["componentDidMount","shouldComponentUpdate","getSnapshotBeforeUpdate","render","componentDidUpdate","componentWillUnmount"]),s}return(0,o.C6)(t,e),t.prototype.componentDidUpdate=function(e,t){this._updateComponentRef(e,this.props)},t.prototype.componentDidMount=function(){this._setComponentRef(this.props.componentRef,this)},t.prototype.componentWillUnmount=function(){if(this._setComponentRef(this.props.componentRef,null),this.__disposables){for(var e=0,t=this._disposables.length;e<t;e++){var n=this.__disposables[e];n.dispose&&n.dispose()}this.__disposables=null}},Object.defineProperty(t.prototype,"className",{get:function(){if(!this.__className){var e=/function (.{1,})\(/.exec(this.constructor.toString());this.__className=e&&e.length>1?e[1]:""}return this.__className},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_disposables",{get:function(){return this.__disposables||(this.__disposables=[]),this.__disposables},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_async",{get:function(){return this.__async||(this.__async=new r.j(this),this._disposables.push(this.__async)),this.__async},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_events",{get:function(){return this.__events||(this.__events=new i.g(this),this._disposables.push(this.__events)),this.__events},enumerable:!0,configurable:!0}),t.prototype._resolveRef=function(e){var t=this;return this.__resolves||(this.__resolves={}),this.__resolves[e]||(this.__resolves[e]=function(n){return t[e]=n}),this.__resolves[e]},t.prototype._updateComponentRef=function(e,t){void 0===t&&(t={}),e&&t&&e.componentRef!==t.componentRef&&(this._setComponentRef(e.componentRef,null),this._setComponentRef(t.componentRef,this))},t.prototype._warnDeprecations=function(e){(0,c.A)(this.className,this.props,e)},t.prototype._warnMutuallyExclusive=function(e){(0,l.Y)(this.className,this.props,e)},t.prototype._warnConditionallyRequiredProps=function(e,t,n){(0,a.J)(this.className,this.props,e,t,n)},t.prototype._setComponentRef=function(e,t){!this._skipComponentRefResolution&&e&&("function"==typeof e&&e(t),"object"==typeof e&&(e.current=t))},t}(s.Component);function d(e,t,n){var o=e[n],s=t[n];(o||s)&&(e[n]=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return s&&(e=s.apply(this,t)),o!==s&&(e=o.apply(this,t)),e})}function h(){return null}},34086:(e,t,n)=>{"use strict";n.d(t,{P:()=>r});var o=n(98670),s=n(30538),r=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isRendered:!1},n}return(0,o.C6)(t,e),t.prototype.componentDidMount=function(){var e=this,t=this.props.delay;this._timeoutId=window.setTimeout((function(){e.setState({isRendered:!0})}),t)},t.prototype.componentWillUnmount=function(){this._timeoutId&&clearTimeout(this._timeoutId)},t.prototype.render=function(){return this.state.isRendered?s.Children.only(this.props.children):null},t.defaultProps={delay:0},t}(s.Component)},2941:(e,t,n)=>{"use strict";n.d(t,{g:()=>s});var o=n(79433),s=function(){function e(t){this._id=e._uniqueId++,this._parent=t,this._eventRecords=[]}return e.raise=function(t,n,s,r){var i;if(e._isElement(t)){if("undefined"!=typeof document&&document.createEvent){var a=document.createEvent("HTMLEvents");a.initEvent(n,r||!1,!0),(0,o.kp)(a,s),i=t.dispatchEvent(a)}else if("undefined"!=typeof document&&document.createEventObject){var l=document.createEventObject(s);t.fireEvent("on"+n,l)}}else for(;t&&!1!==i;){var c=t.__events__,u=c?c[n]:null;if(u)for(var d in u)if(u.hasOwnProperty(d))for(var h=u[d],p=0;!1!==i&&p<h.length;p++){var f=h[p];f.objectCallback&&(i=f.objectCallback.call(f.parent,s))}t=r?t.parent:null}return i},e.isObserved=function(e,t){var n=e&&e.__events__;return!!n&&!!n[t]},e.isDeclared=function(e,t){var n=e&&e.__declaredEvents;return!!n&&!!n[t]},e.stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},e._isElement=function(e){return!!e&&(!!e.addEventListener||"undefined"!=typeof HTMLElement&&e instanceof HTMLElement)},e.prototype.dispose=function(){this._isDisposed||(this._isDisposed=!0,this.off(),this._parent=null)},e.prototype.onAll=function(e,t,n){for(var o in t)t.hasOwnProperty(o)&&this.on(e,o,t[o],n)},e.prototype.on=function(t,n,o,s){var r=this;if(n.indexOf(",")>-1)for(var i=n.split(/[ ,]+/),a=0;a<i.length;a++)this.on(t,i[a],o,s);else{var l=this._parent,c={target:t,eventName:n,parent:l,callback:o,options:s};if((i=t.__events__=t.__events__||{})[n]=i[n]||{count:0},i[n][this._id]=i[n][this._id]||[],i[n][this._id].push(c),i[n].count++,e._isElement(t)){var u=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!r._isDisposed){var n;try{if(!1===(n=o.apply(l,e))&&e[0]){var s=e[0];s.preventDefault&&s.preventDefault(),s.stopPropagation&&s.stopPropagation(),s.cancelBubble=!0}}catch(s){}return n}};c.elementCallback=u,t.addEventListener?t.addEventListener(n,u,s):t.attachEvent&&t.attachEvent("on"+n,u)}else c.objectCallback=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!r._isDisposed)return o.apply(l,e)};this._eventRecords.push(c)}},e.prototype.off=function(e,t,n,o){for(var s=0;s<this._eventRecords.length;s++){var r=this._eventRecords[s];if(!(e&&e!==r.target||t&&t!==r.eventName||n&&n!==r.callback||"boolean"==typeof o&&o!==r.options)){var i=r.target.__events__,a=i[r.eventName],l=a?a[this._id]:null;l&&(1!==l.length&&n?(a.count--,l.splice(l.indexOf(r),1)):(a.count-=l.length,delete i[r.eventName][this._id]),a.count||delete i[r.eventName]),r.elementCallback&&(r.target.removeEventListener?r.target.removeEventListener(r.eventName,r.elementCallback,r.options):r.target.detachEvent&&r.target.detachEvent("on"+r.eventName,r.elementCallback)),this._eventRecords.splice(s--,1)}}},e.prototype.raise=function(t,n,o){return e.raise(this._parent,t,n,o)},e.prototype.declare=function(e){var t=this._parent.__declaredEvents=this._parent.__declaredEvents||{};if("string"==typeof e)t[e]=!0;else for(var n=0;n<e.length;n++)t[e[n]]=!0},e._uniqueId=0,e}()},9724:(e,t,n)=>{"use strict";n.d(t,{h:()=>a});var o=n(19559),s="__globalSettings__",r="__callbacks__",i=0,a=function(){function e(){}return e.getValue=function(e,t){var n=l();return void 0===n[e]&&(n[e]="function"==typeof t?t():t),n[e]},e.setValue=function(e,t){var n=l(),o=n[r],s=n[e];if(t!==s){n[e]=t;var i={oldValue:s,value:t,key:e};for(var a in o)o.hasOwnProperty(a)&&o[a](i)}return t},e.addChangeListener=function(e){var t=e.__id__,n=c();t||(t=e.__id__=String(i++)),n[t]=e},e.removeChangeListener=function(e){delete c()[e.__id__]},e}();function l(){var e,t=(0,o.z)()||{};return t[s]||(t[s]=((e={})[r]={},e)),t[s]}function c(){return l()[r]}},73413:(e,t,n)=>{"use strict";n.d(t,{c:()=>o});var o={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pauseBreak:19,capslock:20,escape:27,space:32,pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,del:46,zero:48,one:49,two:50,three:51,four:52,five:53,six:54,seven:55,eight:56,nine:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,leftWindow:91,rightWindow:92,select:93,zero_numpad:96,one_numpad:97,two_numpad:98,three_numpad:99,four_numpad:100,five_numpad:101,six_numpad:102,seven_numpad:103,eight_numpad:104,nine_numpad:105,multiply:106,add:107,subtract:109,decimalPoint:110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numlock:144,scrollLock:145,semicolon:186,equalSign:187,comma:188,dash:189,period:190,forwardSlash:191,graveAccent:192,openBracket:219,backSlash:220,closeBracket:221,singleQuote:222}},90693:(e,t,n)=>{"use strict";n.d(t,{M:()=>o});var o=function(){function e(e,t,n,o){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===o&&(o=0),this.top=n,this.bottom=o,this.left=e,this.right=t}return Object.defineProperty(e.prototype,"width",{get:function(){return this.right-this.left},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.bottom-this.top},enumerable:!0,configurable:!0}),e.prototype.equals=function(e){return parseFloat(this.top.toFixed(4))===parseFloat(e.top.toFixed(4))&&parseFloat(this.bottom.toFixed(4))===parseFloat(e.bottom.toFixed(4))&&parseFloat(this.left.toFixed(4))===parseFloat(e.left.toFixed(4))&&parseFloat(this.right.toFixed(4))===parseFloat(e.right.toFixed(4))},e}()},6674:(e,t,n)=>{"use strict";function o(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.length<2?t[0]:function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];t.forEach((function(t){return t&&t.apply(e,n)}))}}n.d(t,{$:()=>o})},88723:(e,t,n)=>{"use strict";function o(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.filter((function(e){return e})).join(" ").trim();return""===n?void 0:n}n.d(t,{_:()=>o})},1341:(e,t,n)=>{"use strict";function o(e,t,n){void 0===n&&(n=0);for(var o=-1,s=n;e&&s<e.length;s++)if(t(e[s],s)){o=s;break}return o}function s(e,t){var n=o(e,t);if(!(n<0))return e[n]}function r(e,t){for(var n=[],o=0;o<e;o++)n.push(t(o));return n}function i(e,t){return e.reduce((function(e,n,o){return o%t==0?e.push([n]):e[e.length-1].push(n),e}),[])}function a(e,t){return e.filter((function(e,n){return t!==n}))}function l(e,t,n){var o=e.slice();return o[n]=t,o}function c(e,t,n){var o=e.slice();return o.splice(t,0,n),o}function u(e){var t=[];return e.forEach((function(e){return t=t.concat(e)})),t}function d(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}n.d(t,{Bq:()=>u,D3:()=>i,I6:()=>s,Kz:()=>r,SL:()=>o,Ty:()=>c,fx:()=>l,r1:()=>d,xR:()=>a})},4262:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var o=n(95876),s=n(46208),r=n(41914),i=n(19559),a=50,l=5,c=0,u=o.n.getInstance();u&&u.onReset&&u.onReset((function(){return c++}));var d="__retval__";function h(e){void 0===e&&(e={});var t=new Map,n=0,o=0,u=c;return function(h,p){var g,m;if(void 0===p&&(p={}),e.useStaticStyles&&"function"==typeof h&&h.__noStyleOverride__)return h(p);o++;var y=t,v=p.theme,b=v&&void 0!==v.rtl?v.rtl:(0,r.jI)(),S=e.disableCaching;return u!==c&&(u=c,t=new Map,n=0),e.disableCaching||(y=f(t,h),y=f(y,p)),!S&&y[d]||(y[d]=void 0===h?{}:(0,s.L)(["function"==typeof h?h(p):h],{rtl:!!b,specificityMultiplier:e.useStaticStyles?l:void 0}),S||n++),n>(e.cacheSize||a)&&((null===(m=null===(g=(0,i.z)())||void 0===g?void 0:g.FabricConfig)||void 0===m?void 0:m.enableClassNameCacheFullWarning)&&(console.warn("Styles are being recalculated too frequently. Cache miss rate is "+n+"/"+o+"."),console.trace()),t.clear(),n=0,e.disableCaching=!0),y[d]}}function p(e,t){return t=function(e){switch(e){case void 0:return"__undefined__";case null:return"__null__";default:return e}}(t),e.has(t)||e.set(t,new Map),e.get(t)}function f(e,t){if("function"==typeof t)if(t.__cachedInputs__)for(var n=0,o=t.__cachedInputs__;n<o.length;n++)e=p(e,o[n]);else e=p(e,t);else if("object"==typeof t)for(var s in t)t.hasOwnProperty(s)&&(e=p(e,t[s]));return e}},38353:(e,t,n)=>{"use strict";n.d(t,{C:()=>a});var o=n(98670),s=n(30538),r=n(78572),i=(0,r.J5)((function(e){var t=e;return(0,r.J5)((function(n){if(e===n)throw new Error("Attempted to compose a component with itself.");var i=n,a=(0,r.J5)((function(e){return function(t){return s.createElement(i,(0,o.Cl)({},t,{defaultRender:e}))}}));return function(e){var n=e.defaultRender;return s.createElement(t,(0,o.Cl)({},e,{defaultRender:n?a(n):i}))}}))}));function a(e,t){return i(e)(t)}},23584:(e,t,n)=>{"use strict";function o(e,t){return void 0!==e[t]&&null!==e[t]}n.d(t,{R:()=>o})},16829:(e,t,n)=>{"use strict";n.d(t,{K:()=>s});var o=n(1341),s=function(e){var t={refs:[]};return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.resolver&&(0,o.r1)(t.refs,e)||(t.resolver=function(e){return function(t){for(var n=0,o=e.refs;n<o.length;n++){var s=o[n];"function"==typeof s?s(t):s&&(s.current=t)}}}(t)),t.refs=e,t.resolver}}},76539:(e,t,n)=>{"use strict";function o(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=[],o=0,s=e;o<s.length;o++){var r=s[o];if(r)if("string"==typeof r)n.push(r);else if(r.hasOwnProperty("toString")&&"function"==typeof r.toString)n.push(r.toString());else for(var i in r)r[i]&&n.push(i)}return n.join(" ")}n.d(t,{A:()=>o})},24301:(e,t,n)=>{"use strict";n.d(t,{X:()=>l});var o=n(98670),s=n(9724),r={settings:{},scopedSettings:{},inCustomizerContext:!1},i=s.h.getValue("customizations",{settings:{},scopedSettings:{},inCustomizerContext:!1}),a=[],l=function(){function e(){}return e.reset=function(){i.settings={},i.scopedSettings={}},e.applySettings=function(t){i.settings=(0,o.Cl)((0,o.Cl)({},i.settings),t),e._raiseChange()},e.applyScopedSettings=function(t,n){i.scopedSettings[t]=(0,o.Cl)((0,o.Cl)({},i.scopedSettings[t]),n),e._raiseChange()},e.getSettings=function(e,t,n){void 0===n&&(n=r);for(var o={},s=t&&n.scopedSettings[t]||{},a=t&&i.scopedSettings[t]||{},l=0,c=e;l<c.length;l++){var u=c[l];o[u]=s[u]||n.settings[u]||a[u]||i.settings[u]}return o},e.applyBatchedUpdates=function(t,n){e._suppressUpdates=!0;try{t()}catch(e){}e._suppressUpdates=!1,n||e._raiseChange()},e.observe=function(e){a.push(e)},e.unobserve=function(e){a=a.filter((function(t){return t!==e}))},e._raiseChange=function(){e._suppressUpdates||a.forEach((function(e){return e()}))},e}()},55844:(e,t,n)=>{"use strict";n.d(t,{K:()=>l});var o=n(98670),s=n(30538),r=n(24301),i=n(61977),a=n(86073),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onCustomizationChange=function(){return t.forceUpdate()},t}return(0,o.C6)(t,e),t.prototype.componentDidMount=function(){r.X.observe(this._onCustomizationChange)},t.prototype.componentWillUnmount=function(){r.X.unobserve(this._onCustomizationChange)},t.prototype.render=function(){var e=this,t=this.props.contextTransform;return s.createElement(i.z.Consumer,null,(function(n){var o=(0,a.N)(e.props,n);return t&&(o=t(o)),s.createElement(i.z.Provider,{value:o},e.props.children)}))},t}(s.Component)},61977:(e,t,n)=>{"use strict";n.d(t,{z:()=>o});var o=n(30538).createContext({customizations:{inCustomizerContext:!1,settings:{},scopedSettings:{}}})},96031:(e,t,n)=>{"use strict";n.d(t,{T:()=>c});var o=n(98670),s=n(30538),r=n(24301),i=n(22948),a=n(61977),l=n(69646);function c(e,t,n){return function(c){var u,d=((u=function(i){function u(e){var t=i.call(this,e)||this;return t._styleCache={},t._onSettingChanged=t._onSettingChanged.bind(t),t}return(0,o.C6)(u,i),u.prototype.componentDidMount=function(){r.X.observe(this._onSettingChanged)},u.prototype.componentWillUnmount=function(){r.X.unobserve(this._onSettingChanged)},u.prototype.render=function(){var i=this;return s.createElement(a.z.Consumer,null,(function(a){var u=r.X.getSettings(t,e,a.customizations),d=i.props;if(u.styles&&"function"==typeof u.styles&&(u.styles=u.styles((0,o.Cl)((0,o.Cl)({},u),d))),n&&u.styles){if(i._styleCache.default!==u.styles||i._styleCache.component!==d.styles){var h=(0,l.T)(u.styles,d.styles);i._styleCache.default=u.styles,i._styleCache.component=d.styles,i._styleCache.merged=h}return s.createElement(c,(0,o.Cl)({},u,d,{styles:i._styleCache.merged}))}return s.createElement(c,(0,o.Cl)({},u,d))}))},u.prototype._onSettingChanged=function(){this.forceUpdate()},u}(s.Component)).displayName="Customized"+e,u);return(0,i.D)(c,d)}}},86073:(e,t,n)=>{"use strict";n.d(t,{N:()=>s});var o=n(49814);function s(e,t){var n=(t||{}).customizations,s=void 0===n?{settings:{},scopedSettings:{}}:n;return{customizations:{settings:(0,o.s)(s.settings,e.settings),scopedSettings:(0,o.A)(s.scopedSettings,e.scopedSettings),inCustomizerContext:!0}}}},49814:(e,t,n)=>{"use strict";n.d(t,{A:()=>r,s:()=>s});var o=n(98670);function s(e,t){void 0===e&&(e={});var n=i(t)?t:function(e){return function(t){return e?(0,o.Cl)((0,o.Cl)({},t),e):t}}(t);return n(e)}function r(e,t){return void 0===e&&(e={}),(i(t)?t:(void 0===(n=t)&&(n={}),function(e){var t=(0,o.Cl)({},e);for(var s in n)n.hasOwnProperty(s)&&(t[s]=(0,o.Cl)((0,o.Cl)({},e[s]),n[s]));return t}))(e);var n}function i(e){return"function"==typeof e}},21618:(e,t,n)=>{"use strict";n.d(t,{m:()=>i});var o=n(30538),s=n(24301),r=n(61977);function i(e,t){var n,i=(n=o.useState(0)[1],function(){return n((function(e){return++e}))}),a=o.useContext(r.z).customizations,l=a.inCustomizerContext;return o.useEffect((function(){return l||s.X.observe(i),function(){l||s.X.unobserve(i)}}),[l]),s.X.getSettings(e,t,a)}},50950:(e,t,n)=>{"use strict";n.d(t,{Y:()=>s});var o=n(41771);function s(e){if(!o.Q&&"undefined"!=typeof document){var t=e;return t&&t.ownerDocument?t.ownerDocument:document}}},16285:(e,t,n)=>{"use strict";function o(e){var t;return e&&(e===window?t={left:0,top:0,width:window.innerWidth,height:window.innerHeight,right:window.innerWidth,bottom:window.innerHeight}:e.getBoundingClientRect&&(t=e.getBoundingClientRect())),t}n.d(t,{l:()=>o})},19559:(e,t,n)=>{"use strict";n.d(t,{z:()=>r});var o=n(41771),s=void 0;try{s=window}catch(e){}function r(e){if(!o.Q&&void 0!==s){var t=e;return t&&t.ownerDocument&&t.ownerDocument.defaultView?t.ownerDocument.defaultView:s}}},97778:(e,t,n)=>{"use strict";function o(e,t,n,o){return e.addEventListener(t,n,o),function(){return e.removeEventListener(t,n,o)}}n.d(t,{on:()=>o})},41771:(e,t,n)=>{"use strict";n.d(t,{Q:()=>o,v:()=>s});var o=!1;function s(e){o=e}},19063:(e,t,n)=>{"use strict";n.d(t,{i:()=>s});var o=n(6674);function s(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=(0,o.$)(e,e[n],t[n]))}},77588:(e,t,n)=>{"use strict";n.d(t,{Cm:()=>g,Ep:()=>I,HC:()=>w,J9:()=>b,S0:()=>S,SE:()=>C,Z5:()=>T,_l:()=>_,dm:()=>p,eX:()=>v,j5:()=>h,lo:()=>E,nA:()=>A,oR:()=>f,vO:()=>m,yv:()=>y});var o=n(60552),s=n(41602),r=n(93483),i=n(19559),a=n(50950),l="data-is-focusable",c="data-is-visible",u="data-focuszone-id",d="data-is-sub-focuszone";function h(e,t,n){return v(e,t,!0,!1,!1,n)}function p(e,t,n){return y(e,t,!0,!1,!0,n)}function f(e,t,n,o){return void 0===o&&(o=!0),v(e,t,o,!1,!1,n,!1,!0)}function g(e,t,n,o){return void 0===o&&(o=!0),y(e,t,o,!1,!0,n,!1,!0)}function m(e){var t=v(e,e,!0,!1,!1,!0);return!!t&&(E(t),!0)}function y(e,t,n,o,s,r,i,a){if(!t||!i&&t===e)return null;var l=b(t);if(s&&l&&(r||!w(t)&&!T(t))){var c=y(e,t.lastElementChild,!0,!0,!0,r,i,a);if(c){if(a&&S(c,!0)||!a)return c;var u=y(e,c.previousElementSibling,!0,!0,!0,r,i,a);if(u)return u;for(var d=c.parentElement;d&&d!==t;){var h=y(e,d.previousElementSibling,!0,!0,!0,r,i,a);if(h)return h;d=d.parentElement}}}return n&&l&&S(t,a)?t:y(e,t.previousElementSibling,!0,!0,!0,r,i,a)||(o?null:y(e,t.parentElement,!0,!1,!1,r,i,a))}function v(e,t,n,o,s,r,i,a){if(!t||t===e&&s&&!i)return null;var l=b(t);if(n&&l&&S(t,a))return t;if(!s&&l&&(r||!w(t)&&!T(t))){var c=v(e,t.firstElementChild,!0,!0,!1,r,i,a);if(c)return c}return t===e?null:v(e,t.nextElementSibling,!0,!0,!1,r,i,a)||(o?null:v(e,t.parentElement,!1,!1,!0,r,i,a))}function b(e){if(!e||!e.getAttribute)return!1;var t=e.getAttribute(c);return null!=t?"true"===t:0!==e.offsetHeight||null!==e.offsetParent||!0===e.isVisible}function S(e,t){if(!e||e.disabled)return!1;var n=0,o=null;e&&e.getAttribute&&(o=e.getAttribute("tabIndex"))&&(n=parseInt(o,10));var s=e.getAttribute?e.getAttribute(l):null,r=null!==o&&n>=0,i=!!e&&"false"!==s&&("A"===e.tagName||"BUTTON"===e.tagName||"INPUT"===e.tagName||"TEXTAREA"===e.tagName||"SELECT"===e.tagName||"true"===s||r);return t?-1!==n&&i:i}function w(e){return!!(e&&e.getAttribute&&e.getAttribute(u))}function T(e){return!(!e||!e.getAttribute||"true"!==e.getAttribute(d))}function C(e){var t=(0,a.Y)(e),n=t&&t.activeElement;return!(!n||!(0,s.s)(e,n))}function _(e,t){return"true"!==(0,o.m)(e,t)}var k=void 0;function E(e){if(e){if(k)return void(k=e);k=e;var t=(0,i.z)(e);t&&t.requestAnimationFrame((function(){var e=k;k=void 0,e&&(e.getAttribute&&"true"===e.getAttribute(l)&&(e.getAttribute("tabindex")||e.setAttribute("tabindex","0")),e.focus())}))}}function A(e,t){for(var n=e,o=0,s=t;o<s.length;o++){var r=s[o],i=n.children[Math.min(r,n.children.length-1)];if(!i)break;n=i}return S(n)&&b(n)?n:v(e,n,!0)||y(e,n)}function I(e,t){for(var n=[];t&&e&&t!==e;){var o=(0,r.P)(t,!0);if(null===o)return[];n.unshift(Array.prototype.indexOf.call(o.children,t)),t=o}return n}},91177:(e,t,n)=>{"use strict";n.d(t,{O:()=>c,q:()=>u});var o=n(19559),s=n(95876),r="__currentId__",i="id__",a=(0,o.z)()||{};void 0===a[r]&&(a[r]=0);var l=!1;function c(e){if(!l){var t=s.n.getInstance();t&&t.onReset&&t.onReset(u),l=!0}var n=a[r]++;return(void 0===e?i:e)+n}function u(e){void 0===e&&(e=0),a[r]=e}},8001:(e,t,n)=>{"use strict";n.d(t,{_:()=>r});var o=n(35407),s={label:o.q6,audio:o.Sg,video:o.Fo,ol:o.p3,li:o.P4,a:o.t0,button:o.uw,input:o.QQ,textarea:o.Sh,select:o.Cq,option:o.tK,table:o.al,tr:o.g0,th:o.cr,td:o.k3,colGroup:o.lA,col:o.Qf,form:o.Gp,iframe:o.Cs,img:o.xM};function r(e,t,n){var r=e&&s[e]||o.vt;return(0,o.G1)(t,r,n)}},44527:(e,t,n)=>{"use strict";n.d(t,{G:()=>s,P:()=>r});var o=["setState","render","componentWillMount","UNSAFE_componentWillMount","componentDidMount","componentWillReceiveProps","UNSAFE_componentWillReceiveProps","shouldComponentUpdate","componentWillUpdate","getSnapshotBeforeUpdate","UNSAFE_componentWillUpdate","componentDidUpdate","componentWillUnmount"];function s(e,t,n){void 0===n&&(n=o);var s=[],r=function(o){"function"!=typeof t[o]||void 0!==e[o]||n&&-1!==n.indexOf(o)||(s.push(o),e[o]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t[o].apply(t,e)})};for(var i in t)r(i);return s}function r(e,t){t.forEach((function(t){return delete e[t]}))}},22948:(e,t,n)=>{"use strict";function o(e,t){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}n.d(t,{D:()=>o})},36456:(e,t,n)=>{"use strict";n.d(t,{l:()=>s});var o=n(19559),s=function(){var e,t,n=(0,o.z)();return!!(null===(t=null===(e=n)||void 0===e?void 0:e.navigator)||void 0===t?void 0:t.userAgent)&&n.navigator.userAgent.indexOf("rv:11.0")>-1}},35759:(e,t,n)=>{"use strict";n.d(t,{jg:()=>o.j,ZZ:()=>s.Z,$G:()=>r.$,XI:()=>k.X,KP:()=>E.K,zd:()=>A.z,xS:()=>ke.xS,rm:()=>V.r,Ph:()=>i.P,g6:()=>a.g,II:()=>c,MO:()=>ie.M,h$:()=>u.h,Y2:()=>te.Y2,cK:()=>d.c,M_:()=>h.M,Nx:()=>Ee.Nx,oA:()=>ee.o,Ty:()=>g.Ty,K0:()=>ke.K0,c8:()=>ke.c8,t0:()=>ye.t0,$N:()=>p.$,r1:()=>g.r1,x9:()=>b,xb:()=>S,kp:()=>fe.kp,Sg:()=>ye.Sg,$f:()=>ye.$f,TJ:()=>ye.TJ,uw:()=>ye.uw,lS:()=>ce.lS,ZO:()=>w.Z,lA:()=>ye.lA,Qf:()=>ye.Qf,CR:()=>T.C,jk:()=>ve.j,Kz:()=>g.Kz,J5:()=>ue.J5,KD:()=>Fe.K,AH:()=>_.A,Tx:()=>I.T,mh:()=>ke.mh,JM:()=>ye.JM,SE:()=>Q.SE,s8:()=>R.s,mB:()=>D.m,fY:()=>ke.fY,iU:()=>j.i,Xs:()=>fe.Xs,I6:()=>g.I6,wI:()=>O.w,SL:()=>g.SL,Hc:()=>ke.Hc,x2:()=>ce.x2,Bq:()=>g.Bq,lo:()=>Q.lo,vO:()=>Q.vO,Gp:()=>ye.Gp,GP:()=>Ae.G,i0:()=>L,JV:()=>ce.JV,YE:()=>F.Y,Ep:()=>Q.Ep,j5:()=>Q.j5,oR:()=>Q.oR,nA:()=>Q.nA,OX:()=>J.O,IM:()=>ae.I,Z0:()=>le.Z,dm:()=>Q.dm,Cm:()=>Q.Cm,_B:()=>K._,G1:()=>ye.G1,eX:()=>Q.eX,PA:()=>B.P,yv:()=>Q.yv,Nu:()=>Ne,jI:()=>Te.jI,SM:()=>Te.SM,l:()=>W.l,Al:()=>Se,XJ:()=>ke.XJ,cI:()=>U.c,zk:()=>G.z,D1:()=>me.D1,RK:()=>me.RK,Nh:()=>me.Nh,Gj:()=>Y.G,DI:()=>X.D,vt:()=>ye.vt,Cs:()=>ye.Cs,Ho:()=>ye.Ho,xM:()=>ye.xM,fi:()=>Z.f,as:()=>ne,QQ:()=>ye.QQ,RF:()=>C.R,nY:()=>ee.n,Z5:()=>Q.Z5,HC:()=>Q.HC,S0:()=>Q.S0,J9:()=>Q.J9,lw:()=>Oe.l,un:()=>he.u,cX:()=>ge.c,qQ:()=>N.q,q6:()=>ye.q6,P4:()=>ye.P4,cg:()=>fe.cg,Bj:()=>ue.Bj,av:()=>ue.J9,h1:()=>de.h,_A:()=>f._,NG:()=>M.N,A4:()=>x.A,ss:()=>x.s,qe:()=>pe.q,Ke:()=>r.K,p3:()=>ye.p3,cJ:()=>fe.cJ,on:()=>H.on,tK:()=>ye.tK,s6:()=>q.s,Pj:()=>ce.Pj,BM:()=>$,xR:()=>g.xR,fx:()=>g.fx,Bt:()=>xe.B,qD:()=>J.q,Tk:()=>ue.Tk,Qk:()=>Ce.Q,vY:()=>_e,Cq:()=>ye.Cq,pf:()=>we,Fy:()=>te.Fy,xC:()=>le.x,ET:()=>ue.lw,VR:()=>V.V,DU:()=>Te.DU,v9:()=>Le.v,gs:()=>z.g,K9:()=>Pe.K,ab:()=>fe.ab,_l:()=>Q._l,I4:()=>Ie.I,al:()=>ye.al,k3:()=>ye.k3,Sh:()=>ye.Sh,cr:()=>ye.cr,D3:()=>g.D3,g0:()=>ye.g0,PP:()=>Y.P,mk:()=>P.m,vk:()=>ie.v,zu:()=>fe.zu,Fo:()=>ye.Fo,R8:()=>Pe.R,Jc:()=>Me.J,Ac:()=>xe.A,AW:()=>Re.A,Y8:()=>De.Y});var o=n(18264),s=n(38480),r=n(18064),i=n(34086),a=n(2941),l=function(){return"undefined"!=typeof performance&&performance.now?performance.now():Date.now()},c=function(){function e(){}return e.measure=function(t,n){e._timeoutId&&e.setPeriodicReset();var o=l();n();var s=l(),r=e.summary[t]||{totalDuration:0,count:0,all:[]},i=s-o;r.totalDuration+=i,r.count++,r.all.push({duration:i,timeStamp:s}),e.summary[t]=r},e.reset=function(){e.summary={},clearTimeout(e._timeoutId),e._timeoutId=NaN},e.setPeriodicReset=function(){e._timeoutId=setTimeout((function(){return e.reset()}),18e4)},e.summary={},e}(),u=n(9724),d=n(73413),h=n(90693),p=n(6674),f=n(88723),g=n(1341),m=n(98670),y=n(30538),v="undefined"!=typeof WeakMap?new WeakMap:void 0;function b(e){var t=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.state={Component:v?v.get(e.load):void 0},n}return(0,m.C6)(n,t),n.prototype.render=function(){var e=this.props,t=e.forwardedRef,n=e.asyncPlaceholder,o=(0,m.Tt)(e,["forwardedRef","asyncPlaceholder"]),s=this.state.Component;return s?y.createElement(s,(0,m.Cl)((0,m.Cl)({},o),{ref:t})):n?y.createElement(n,null):null},n.prototype.componentDidMount=function(){var t=this;this.state.Component||e.load().then((function(n){n&&(v&&v.set(e.load,n),t.setState({Component:n},e.onLoad))})).catch(e.onError)},n}(y.Component);return y.forwardRef((function(e,n){return y.createElement(t,(0,m.Cl)({},e,{forwardedRef:n}))}))}function S(e){throw new Error("Unexpected object: "+e)}var w=n(4262),T=n(38353),C=n(23584),_=n(76539),k=n(24301),E=n(55844),A=n(61977),I=n(96031),P=n(21618),M=n(86073),x=n(49814),R=n(41602),D=n(60552),O=n(88948),N=n(80566);function L(e,t){void 0===t&&(t=!0);var n=[];if(e){for(var o=0;o<e.children.length;o++)n.push(e.children.item(o));t&&(0,N.q)(e)&&n.push.apply(n,e._virtual.children)}return n}var F=n(50950),B=n(93483),W=n(16285),U=n(72148),G=n(19559),H=n(97778),q=n(15846);function $(e){var t=function(e){var t;return"function"==typeof Event?t=new Event(e):(t=document.createEvent("Event")).initEvent(e,!0,!0),t}("MouseEvents");t.initEvent("click",!0,!0),e.dispatchEvent(t)}var V=n(7821),z=n(97672),j=n(19063),Q=n(77588),J=n(91177),K=n(8001),Y=n(44527),X=n(22948),Z=n(66320),ee=n(4519),te=n(69746);function ne(e){var t,n=e||(0,G.z)();n&&!0!==(null===(t=n.FabricConfig)||void 0===t?void 0:t.disableFocusRects)&&(n.__hasInitializeFocusRects__||(n.__hasInitializeFocusRects__=!0,n.addEventListener("mousedown",oe,!0),n.addEventListener("pointerdown",se,!0),n.addEventListener("keydown",re,!0)))}function oe(e){(0,te.Fy)(!1,e.target)}function se(e){"mouse"!==e.pointerType&&(0,te.Fy)(!1,e.target)}function re(e){(0,ee.n)(e.which)&&(0,te.Fy)(!0,e.target)}var ie=n(81180),ae=n(16235),le=n(24823),ce=n(14936),ue=n(78572),de=n(66672),he=n(67290),pe=n(15139),fe=n(79433),ge=n(96858),me=n(48108),ye=n(35407),ve=n(70473),be="";function Se(e){return be+e}function we(e){be=e}var Te=n(41914),Ce=n(51969),_e=function(e){var t;return function(n,o){t||(t=new Set,(0,j.i)(e,{componentWillUnmount:function(){t.forEach((function(e){return clearTimeout(e)}))}}));var s=setTimeout((function(){t.delete(s),n()}),o);t.add(s)}},ke=n(58207),Ee=n(28020),Ae=n(40883),Ie=n(26989),Pe=n(82729),Me=n(11641),xe=n(72592),Re=n(74010),De=n(34924),Oe=n(36456);function Ne(e,t){for(var n=(0,m.Cl)({},t),o=0,s=Object.keys(e);o<s.length;o++){var r=s[o];void 0===n[r]&&(n[r]=e[r])}return n}var Le=n(41771),Fe=n(16829);(0,n(30620).v)("@uifabric/utilities","7.38.1")},66320:(e,t,n)=>{"use strict";n.d(t,{f:()=>s});var o=n(19063);function s(e){(0,o.i)(e,{componentDidMount:r,componentDidUpdate:i,componentWillUnmount:a})}function r(){l(this.props.componentRef,this)}function i(e){e.componentRef!==this.props.componentRef&&(l(e.componentRef,null),l(this.props.componentRef,this))}function a(){l(this.props.componentRef,null)}function l(e,t){e&&("object"==typeof e?e.current=t:"function"==typeof e&&e(t))}},16235:(e,t,n)=>{"use strict";n.d(t,{I:()=>l});var o=/[\(\[\{][^\)\]\}]*[\)\]\}]/g,s=/[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/g,r=/^\d+[\d\s]*(:?ext|x|)\s*\d+$/i,i=/\s+/g,a=/[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF\u3040-\u309F\u30A0-\u30FF\u3400-\u4DBF\u4E00-\u9FFF\uF900-\uFAFF]|[\uD840-\uD869][\uDC00-\uDED6]/;function l(e,t,n){return e?(e=function(e){return(e=(e=(e=e.replace(o,"")).replace(s,"")).replace(i," ")).trim()}(e),a.test(e)||!n&&r.test(e)?"":function(e,t){var n="",o=e.split(" ");return 2===o.length?(n+=o[0].charAt(0).toUpperCase(),n+=o[1].charAt(0).toUpperCase()):3===o.length?(n+=o[0].charAt(0).toUpperCase(),n+=o[2].charAt(0).toUpperCase()):0!==o.length&&(n+=o[0].charAt(0).toUpperCase()),t&&n.length>1?n.charAt(1)+n.charAt(0):n}(e,t)):""}},4519:(e,t,n)=>{"use strict";n.d(t,{n:()=>i,o:()=>a});var o,s=n(73413),r=((o={})[s.c.up]=1,o[s.c.down]=1,o[s.c.left]=1,o[s.c.right]=1,o[s.c.home]=1,o[s.c.end]=1,o[s.c.tab]=1,o[s.c.pageUp]=1,o[s.c.pageDown]=1,o);function i(e){return!!r[e]}function a(e){r[e]=1}},24823:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l,x:()=>c});var o,s=n(50950),r=n(19559),i=n(23519),a="language";function l(e){if(void 0===e&&(e="localStorage"),void 0===o){var t=(0,s.Y)(),n="localStorage"===e?function(e){var t=null;try{var n=(0,r.z)();t=n?n.localStorage.getItem(e):null}catch(e){}return t}(a):"sessionStorage"===e?i.G(a):void 0;n&&(o=n),void 0===o&&t&&(o=t.documentElement.getAttribute("lang")),void 0===o&&(o="en")}return o}function c(e,t){var n=(0,s.Y)();n&&n.documentElement.setAttribute("lang",e);var l=!0===t?"none":t||"localStorage";"localStorage"===l?function(e,t){try{var n=(0,r.z)();n&&n.localStorage.setItem(e,t)}catch(e){}}(a,e):"sessionStorage"===l&&i.S(a,e),o=e}},14936:(e,t,n)=>{"use strict";function o(e,t){var n=e.left||e.x||0,o=e.top||e.y||0,s=t.left||t.x||0,r=t.top||t.y||0;return Math.sqrt(Math.pow(n-s,2)+Math.pow(o-r,2))}function s(e){var t,n=e.contentSize,o=e.boundsSize,s=e.mode,r=void 0===s?"contain":s,i=e.maxScale,a=void 0===i?1:i,l=n.width/n.height,c=o.width/o.height;t=("contain"===r?l>c:l<c)?o.width/n.width:o.height/n.height;var u=Math.min(a,t);return{width:n.width*u,height:n.height*u}}function r(e){var t=/[1-9]([0]+$)|\.([0-9]*)/.exec(String(e));return t?t[1]?-t[1].length:t[2]?t[2].length:0:0}function i(e,t,n){void 0===n&&(n=10);var o=Math.pow(n,t);return Math.round(e*o)/o}n.d(t,{JV:()=>o,Pj:()=>i,lS:()=>r,x2:()=>s})},78572:(e,t,n)=>{"use strict";n.d(t,{Bj:()=>d,J5:()=>p,J9:()=>h,Tk:()=>u,lw:()=>c});var o=n(95876),s=!1,r=0,i={empty:!0},a={},l="undefined"==typeof WeakMap?null:WeakMap;function c(e){l=e}function u(){r++}function d(e,t,n){var o=h(n.value&&n.value.bind(null));return{configurable:!0,get:function(){return o}}}function h(e,t,n){if(void 0===t&&(t=100),void 0===n&&(n=!1),!l)return e;if(!s){var c=o.n.getInstance();c&&c.onReset&&o.n.getInstance().onReset(u),s=!0}var d,h=0,p=r;return function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];var l,c=d;(void 0===d||p!==r||t>0&&h>t)&&(d=f(),h=0,p=r),c=d;for(var u=0;u<o.length;u++){var g=(l=o[u])?"object"==typeof l||"function"==typeof l?l:(a[l]||(a[l]={val:l}),a[l]):i;c.map.has(g)||c.map.set(g,f()),c=c.map.get(g)}return c.hasOwnProperty("value")||(c.value=e.apply(void 0,o),h++),!n||null!==c.value&&void 0!==c.value||(c.value=e.apply(void 0,o)),c.value}}function p(e){if(!l)return e;var t=new l;return function(n){if(!n||"function"!=typeof n&&"object"!=typeof n)return e(n);if(t.has(n))return t.get(n);var o=e(n);return t.set(n,o),o}}function f(){return{map:l?new l:null}}},66672:(e,t,n)=>{"use strict";function o(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var o=0,r=t;o<r.length;o++)s(e||{},r[o]);return e}function s(e,t,n){for(var o in void 0===n&&(n=[]),n.push(t),t)if(t.hasOwnProperty(o)&&"__proto__"!==o&&"constructor"!==o&&"prototype"!==o){var r=t[o];if("object"!=typeof r||null===r||Array.isArray(r))e[o]=r;else{var i=n.indexOf(r)>-1;e[o]=i?r:s(e[o]||{},r,n)}}return n.pop(),e}n.d(t,{h:()=>o})},67290:(e,t,n)=>{"use strict";n.d(t,{u:()=>o});var o=function(){return!!(window&&window.navigator&&window.navigator.userAgent)&&/iPad|iPhone|iPod/i.test(window.navigator.userAgent)}},15139:(e,t,n)=>{"use strict";n.d(t,{q:()=>s});var o=n(50950);function s(e){for(var t,n=[],s=(0,o.Y)(e)||document;e!==s.body;){for(var r=0,i=e.parentElement.children;r<i.length;r++){var a=i[r];a!==e&&"true"!==(null===(t=a.getAttribute("aria-hidden"))||void 0===t?void 0:t.toLowerCase())&&n.push(a)}if(!e.parentElement)break;e=e.parentElement}return n.forEach((function(e){e.setAttribute("aria-hidden","true")})),function(){!function(e){e.forEach((function(e){e.setAttribute("aria-hidden","false")}))}(n),n=[]}}},79433:(e,t,n)=>{"use strict";function o(e,t){for(var n in e)if(e.hasOwnProperty(n)&&(!t.hasOwnProperty(n)||t[n]!==e[n]))return!1;for(var n in t)if(t.hasOwnProperty(n)&&!e.hasOwnProperty(n))return!1;return!0}function s(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return r.apply(this,[null,e].concat(t))}function r(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];t=t||{};for(var s=0,r=n;s<r.length;s++){var i=r[s];if(i)for(var a in i)!i.hasOwnProperty(a)||e&&!e(a)||(t[a]=i[a])}return t}function i(e,t){return Object.keys(e).map((function(n){if(String(Number(n))!==n)return t(n,e[n])})).filter((function(e){return!!e}))}function a(e){return Object.keys(e).reduce((function(t,n){return t.push(e[n]),t}),[])}function l(e,t){var n={};for(var o in e)-1===t.indexOf(o)&&e.hasOwnProperty(o)&&(n[o]=e[o]);return n}n.d(t,{Xs:()=>r,ab:()=>o,cJ:()=>l,cg:()=>i,kp:()=>s,zu:()=>a})},96858:(e,t,n)=>{"use strict";n.d(t,{c:()=>r});var o,s=n(19559);function r(e){if(void 0===o||e){var t=(0,s.z)(),n=t&&t.navigator.userAgent;o=!!n&&-1!==n.indexOf("Macintosh")}return!!o}},48108:(e,t,n)=>{"use strict";function o(e){return e.clientWidth<e.scrollWidth}function s(e){return e.clientHeight<e.scrollHeight}function r(e){return o(e)||s(e)}n.d(t,{D1:()=>o,Nh:()=>s,RK:()=>r})},35407:(e,t,n)=>{"use strict";n.d(t,{$f:()=>s,Cq:()=>m,Cs:()=>k,Fo:()=>c,G1:()=>P,Gp:()=>_,Ho:()=>A,JM:()=>I,P4:()=>d,QQ:()=>f,Qf:()=>C,Sg:()=>l,Sh:()=>g,TJ:()=>r,al:()=>v,cr:()=>S,g0:()=>b,k3:()=>w,lA:()=>T,p3:()=>u,q6:()=>a,t0:()=>h,tK:()=>y,uw:()=>p,vt:()=>i,xM:()=>E});var o=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n={},o=0,s=e;o<s.length;o++)for(var r=s[o],i=0,a=Array.isArray(r)?r:Object.keys(r);i<a.length;i++)n[a[i]]=1;return n},s=o(["onCopy","onCut","onPaste","onCompositionEnd","onCompositionStart","onCompositionUpdate","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onInput","onSubmit","onLoad","onError","onKeyDown","onKeyDownCapture","onKeyPress","onKeyUp","onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting","onClick","onClickCapture","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onMouseUpCapture","onSelect","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onScroll","onWheel","onPointerCancel","onPointerDown","onPointerEnter","onPointerLeave","onPointerMove","onPointerOut","onPointerOver","onPointerUp","onGotPointerCapture","onLostPointerCapture"]),r=o(["accessKey","children","className","contentEditable","dir","draggable","hidden","htmlFor","id","lang","ref","role","style","tabIndex","title","translate","spellCheck","name"]),i=o(r,s),a=o(i,["form"]),l=o(i,["height","loop","muted","preload","src","width"]),c=o(l,["poster"]),u=o(i,["start"]),d=o(i,["value"]),h=o(i,["download","href","hrefLang","media","rel","target","type"]),p=o(i,["autoFocus","disabled","form","formAction","formEncType","formMethod","formNoValidate","formTarget","type","value"]),f=o(p,["accept","alt","autoCapitalize","autoComplete","checked","dirname","form","height","inputMode","list","max","maxLength","min","multiple","pattern","placeholder","readOnly","required","src","step","size","type","value","width"]),g=o(p,["autoCapitalize","cols","dirname","form","maxLength","placeholder","readOnly","required","rows","wrap"]),m=o(p,["form","multiple","required"]),y=o(i,["selected","value"]),v=o(i,["cellPadding","cellSpacing"]),b=i,S=o(i,["rowSpan","scope"]),w=o(i,["colSpan","headers","rowSpan","scope"]),T=o(i,["span"]),C=o(i,["span"]),_=o(i,["acceptCharset","action","encType","encType","method","noValidate","target"]),k=o(i,["allow","allowFullScreen","allowPaymentRequest","allowTransparency","csp","height","importance","referrerPolicy","sandbox","src","srcDoc","width"]),E=o(i,["alt","crossOrigin","height","src","srcSet","useMap","width"]),A=E,I=i;function P(e,t,n){for(var o,s=Array.isArray(t),r={},i=0,a=Object.keys(e);i<a.length;i++){var l=a[i];!(!s&&t[l]||s&&t.indexOf(l)>=0||0===l.indexOf("data-")||0===l.indexOf("aria-"))||n&&-1!==(null===(o=n)||void 0===o?void 0:o.indexOf(l))||(r[l]=e[l])}return r}},70473:(e,t,n)=>{"use strict";n.d(t,{j:()=>r});var o=n(78572),s=(0,o.J5)((function(e){return(0,o.J5)((function(t){var n=(0,o.J5)((function(e){return function(n){return t(n,e)}}));return function(o,s){return e(o,s?n(s):t)}}))}));function r(e,t){return s(e)(t)}},41914:(e,t,n)=>{"use strict";n.d(t,{DU:()=>u,SM:()=>d,jI:()=>c});var o,s=n(73413),r=n(50950),i=n(23519),a=n(17060),l="isRTL";function c(e){if(void 0===e&&(e={}),void 0!==e.rtl)return e.rtl;if(void 0===o){var t=(0,i.G)(l);null!==t&&u(o="1"===t);var n=(0,r.Y)();void 0===o&&n&&(o="rtl"===(n.body&&n.body.getAttribute("dir")||n.documentElement.getAttribute("dir")),(0,a.DU)(o))}return!!o}function u(e,t){void 0===t&&(t=!1);var n=(0,r.Y)();n&&n.documentElement.setAttribute("dir",e?"rtl":"ltr"),t&&(0,i.S)(l,e?"1":"0"),o=e,(0,a.DU)(o)}function d(e,t){return void 0===t&&(t={}),c(t)&&(e===s.c.left?e=s.c.right:e===s.c.right&&(e=s.c.left)),e}},51969:(e,t,n)=>{"use strict";n.d(t,{Q:()=>s});var o=n(19063),s=function(e){var t;return function(n){t||(t=new Set,(0,o.i)(e,{componentWillUnmount:function(){t.forEach((function(e){return cancelAnimationFrame(e)}))}}));var s=requestAnimationFrame((function(){t.delete(s),n()}));t.add(s)}}},58207:(e,t,n)=>{"use strict";n.d(t,{Hc:()=>m,K0:()=>d,XJ:()=>g,c8:()=>u,fY:()=>f,mh:()=>p,xS:()=>c});var o,s=n(50950),r=n(16536),i=n(19559),a=0,l=(0,r.Z)({overflow:"hidden !important"}),c="data-is-scrollable",u=function(e,t){if(e){var n=0,o=null;t.on(e,"touchstart",(function(e){1===e.targetTouches.length&&(n=e.targetTouches[0].clientY)}),{passive:!1}),t.on(e,"touchmove",(function(e){if(1===e.targetTouches.length&&(e.stopPropagation(),o)){var t=e.targetTouches[0].clientY-n,s=m(e.target);s&&(o=s),0===o.scrollTop&&t>0&&e.preventDefault(),o.scrollHeight-Math.ceil(o.scrollTop)<=o.clientHeight&&t<0&&e.preventDefault()}}),{passive:!1}),o=e}},d=function(e,t){e&&t.on(e,"touchmove",(function(e){e.stopPropagation()}),{passive:!1})},h=function(e){e.preventDefault()};function p(){var e=(0,s.Y)();e&&e.body&&!a&&(e.body.classList.add(l),e.body.addEventListener("touchmove",h,{passive:!1,capture:!1})),a++}function f(){if(a>0){var e=(0,s.Y)();e&&e.body&&1===a&&(e.body.classList.remove(l),e.body.removeEventListener("touchmove",h)),a--}}function g(){if(void 0===o){var e=document.createElement("div");e.style.setProperty("width","100px"),e.style.setProperty("height","100px"),e.style.setProperty("overflow","scroll"),e.style.setProperty("position","absolute"),e.style.setProperty("top","-9999px"),document.body.appendChild(e),o=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return o}function m(e){for(var t=e,n=(0,s.Y)(e);t&&t!==n.body;){if("true"===t.getAttribute(c))return t;t=t.parentElement}for(t=e;t&&t!==n.body;){if("false"!==t.getAttribute(c)){var o=getComputedStyle(t),r=o?o.getPropertyValue("overflow-y"):"";if(r&&("scroll"===r||"auto"===r))return t}t=t.parentElement}return t&&t!==n.body||(t=(0,i.z)(e)),t}},499:(e,t,n)=>{"use strict";n.d(t,{L:()=>r});var o=n(28020),s=n(2941),r=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[0]||{},s=n.onSelectionChanged,r=n.onItemsChanged,a=n.getKey,l=n.canSelectItem,c=void 0===l?function(){return!0}:l,u=n.items,d=n.selectionMode,h=void 0===d?o.Qc.multiple:d;this.mode=h,this._getKey=a||i,this._changeEventSuppressionCount=0,this._exemptedCount=0,this._anchoredIndex=0,this._unselectableCount=0,this._onSelectionChanged=s,this._onItemsChanged=r,this._canSelectItem=c,this._keyToIndexMap={},this._isModal=!1,this.setItems(u||[],!0),this.count=this.getSelectedCount()}return e.prototype.canSelectItem=function(e,t){return!("number"==typeof t&&t<0)&&this._canSelectItem(e,t)},e.prototype.getKey=function(e,t){var n=this._getKey(e,t);return"number"==typeof n||n?""+n:""},e.prototype.setChangeEvents=function(e,t){this._changeEventSuppressionCount+=e?-1:1,0===this._changeEventSuppressionCount&&this._hasChanged&&(this._hasChanged=!1,t||this._change())},e.prototype.isModal=function(){return this._isModal},e.prototype.setModal=function(e){this._isModal!==e&&(this.setChangeEvents(!1),this._isModal=e,e||this.setAllSelected(!1),this._change(),this.setChangeEvents(!0))},e.prototype.setItems=function(e,t){void 0===t&&(t=!0);var n={},r={},i=!1;this.setChangeEvents(!1),this._unselectableCount=0;for(var a=!1,l=0;l<e.length;l++)(h=e[l])&&(v=this.getKey(h,l))&&(a||v in this._keyToIndexMap&&this._keyToIndexMap[v]===l||(a=!0),n[v]=l),r[l]=h&&!this.canSelectItem(h),r[l]&&this._unselectableCount++;(t||0===e.length)&&this._setAllSelected(!1,!0);var c={},u=0;for(var d in this._exemptedIndices)if(this._exemptedIndices.hasOwnProperty(d)){var h,p=Number(d),f=(h=this._items[p])?this.getKey(h,Number(p)):void 0,g=f?n[f]:p;void 0===g?i=!0:(c[g]=!0,u++,i=i||g!==p)}if(this._items&&0===this._exemptedCount&&e.length!==this._items.length&&this._isAllSelected&&(i=!0),!a)for(var m=0,y=Object.keys(this._keyToIndexMap);m<y.length;m++){var v;if(!((v=y[m])in n)){a=!0;break}}this._exemptedIndices=c,this._exemptedCount=u,this._keyToIndexMap=n,this._unselectableIndices=r,this._items=e,this._selectedItems=null,i&&this._updateCount(),a&&(s.g.raise(this,o.Nx),this._onItemsChanged&&this._onItemsChanged()),i&&this._change(),this.setChangeEvents(!0)},e.prototype.getItems=function(){return this._items},e.prototype.getSelection=function(){if(!this._selectedItems){this._selectedItems=[];var e=this._items;if(e)for(var t=0;t<e.length;t++)this.isIndexSelected(t)&&this._selectedItems.push(e[t])}return this._selectedItems},e.prototype.getSelectedCount=function(){return this._isAllSelected?this._items.length-this._exemptedCount-this._unselectableCount:this._exemptedCount},e.prototype.getSelectedIndices=function(){if(!this._selectedIndices){this._selectedIndices=[];var e=this._items;if(e)for(var t=0;t<e.length;t++)this.isIndexSelected(t)&&this._selectedIndices.push(t)}return this._selectedIndices},e.prototype.getItemIndex=function(e){var t=this._keyToIndexMap[e];return null!=t?t:-1},e.prototype.isRangeSelected=function(e,t){if(0===t)return!1;for(var n=e+t,o=e;o<n;o++)if(!this.isIndexSelected(o))return!1;return!0},e.prototype.isAllSelected=function(){var e=this._items.length-this._unselectableCount;return this.mode===o.Qc.single&&(e=Math.min(e,1)),this.count>0&&this._isAllSelected&&0===this._exemptedCount||!this._isAllSelected&&this._exemptedCount===e&&e>0},e.prototype.isKeySelected=function(e){var t=this._keyToIndexMap[e];return this.isIndexSelected(t)},e.prototype.isIndexSelected=function(e){return!!(this.count>0&&this._isAllSelected&&!this._exemptedIndices[e]&&!this._unselectableIndices[e]||!this._isAllSelected&&this._exemptedIndices[e])},e.prototype.setAllSelected=function(e){if(!e||this.mode===o.Qc.multiple){var t=this._items?this._items.length-this._unselectableCount:0;this.setChangeEvents(!1),t>0&&(this._exemptedCount>0||e!==this._isAllSelected)&&(this._exemptedIndices={},(e!==this._isAllSelected||this._exemptedCount>0)&&(this._exemptedCount=0,this._isAllSelected=e,this._change()),this._updateCount()),this.setChangeEvents(!0)}},e.prototype.setKeySelected=function(e,t,n){var o=this._keyToIndexMap[e];o>=0&&this.setIndexSelected(o,t,n)},e.prototype.setIndexSelected=function(e,t,n){if(this.mode!==o.Qc.none&&!((e=Math.min(Math.max(0,e),this._items.length-1))<0||e>=this._items.length)){this.setChangeEvents(!1);var s=this._exemptedIndices[e];!this._unselectableIndices[e]&&(t&&this.mode===o.Qc.single&&this._setAllSelected(!1,!0),s&&(t&&this._isAllSelected||!t&&!this._isAllSelected)&&(delete this._exemptedIndices[e],this._exemptedCount--),!s&&(t&&!this._isAllSelected||!t&&this._isAllSelected)&&(this._exemptedIndices[e]=!0,this._exemptedCount++),n&&(this._anchoredIndex=e)),this._updateCount(),this.setChangeEvents(!0)}},e.prototype.setRangeSelected=function(e,t,n,s){if(this.mode!==o.Qc.none&&(e=Math.min(Math.max(0,e),this._items.length-1),t=Math.min(Math.max(0,t),this._items.length-e),!(e<0||e>=this._items.length||0===t))){this.setChangeEvents(!1);for(var r=e,i=e+t-1,a=(this._anchoredIndex||0)>=i?r:i;r<=i;r++)this.setIndexSelected(r,n,!!s&&r===a);this.setChangeEvents(!0)}},e.prototype.selectToKey=function(e,t){this.selectToIndex(this._keyToIndexMap[e],t)},e.prototype.selectToRange=function(e,t,n){if(this.mode!==o.Qc.none)if(this.mode!==o.Qc.single){var s=this._anchoredIndex||0,r=Math.min(e,s),i=Math.max(e+t-1,s);for(this.setChangeEvents(!1),n&&this._setAllSelected(!1,!0);r<=i;r++)this.setIndexSelected(r,!0,!1);this.setChangeEvents(!0)}else 1===t&&this.setIndexSelected(e,!0,!0)},e.prototype.selectToIndex=function(e,t){if(this.mode!==o.Qc.none)if(this.mode!==o.Qc.single){var n=this._anchoredIndex||0,s=Math.min(e,n),r=Math.max(e,n);for(this.setChangeEvents(!1),t&&this._setAllSelected(!1,!0);s<=r;s++)this.setIndexSelected(s,!0,!1);this.setChangeEvents(!0)}else this.setIndexSelected(e,!0,!0)},e.prototype.toggleAllSelected=function(){this.setAllSelected(!this.isAllSelected())},e.prototype.toggleKeySelected=function(e){this.setKeySelected(e,!this.isKeySelected(e),!0)},e.prototype.toggleIndexSelected=function(e){this.setIndexSelected(e,!this.isIndexSelected(e),!0)},e.prototype.toggleRangeSelected=function(e,t){if(this.mode!==o.Qc.none){var n=this.isRangeSelected(e,t),s=e+t;if(!(this.mode===o.Qc.single&&t>1)){this.setChangeEvents(!1);for(var r=e;r<s;r++)this.setIndexSelected(r,!n,!1);this.setChangeEvents(!0)}}},e.prototype._updateCount=function(e){void 0===e&&(e=!1);var t=this.getSelectedCount();t!==this.count&&(this.count=t,this._change()),this.count||e||this.setModal(!1)},e.prototype._setAllSelected=function(e,t){if(void 0===t&&(t=!1),!e||this.mode===o.Qc.multiple){var n=this._items?this._items.length-this._unselectableCount:0;this.setChangeEvents(!1),n>0&&(this._exemptedCount>0||e!==this._isAllSelected)&&(this._exemptedIndices={},(e!==this._isAllSelected||this._exemptedCount>0)&&(this._exemptedCount=0,this._isAllSelected=e,this._change()),this._updateCount(t)),this.setChangeEvents(!0)}},e.prototype._change=function(){0===this._changeEventSuppressionCount?(this._selectedItems=null,this._selectedIndices=void 0,s.g.raise(this,o.ij),this._onSelectionChanged&&this._onSelectionChanged()):this._hasChanged=!0},e}();function i(e,t){var n=(e||{}).key;return void 0===n?""+t:n}},28020:(e,t,n)=>{"use strict";n.d(t,{Nx:()=>i,Qc:()=>o,SB:()=>s,ij:()=>r});var o,s,r="change",i="items-change";!function(e){e[e.none=0]="none",e[e.single=1]="single",e[e.multiple=2]="multiple"}(o||(o={})),function(e){e[e.horizontal=0]="horizontal",e[e.vertical=1]="vertical"}(s||(s={}))},23519:(e,t,n)=>{"use strict";n.d(t,{G:()=>s,S:()=>r});var o=n(19559);function s(e){var t=null;try{var n=(0,o.z)();t=n?n.sessionStorage.getItem(e):null}catch(e){}return t}function r(e,t){var n;try{null===(n=(0,o.z)())||void 0===n||n.sessionStorage.setItem(e,t)}catch(e){}}},69746:(e,t,n)=>{"use strict";n.d(t,{Fy:()=>i,Y2:()=>s});var o=n(19559),s="ms-Fabric--isFocusVisible",r="ms-Fabric--isFocusHidden";function i(e,t){var n=t?(0,o.z)(t):(0,o.z)();if(n){var i=n.document.body.classList;i.add(e?s:r),i.remove(e?r:s)}}},40883:(e,t,n)=>{"use strict";n.d(t,{G:()=>r});var o=/[\{\}]/g,s=/\{\d+\}/g;function r(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=t;return e.replace(s,(function(e){var t=r[e.replace(o,"")];return null==t&&(t=""),t}))}},26989:(e,t,n)=>{"use strict";n.d(t,{I:()=>l});var o=n(98670),s=n(30538),r=n(49742),i=n(21618),a=["theme","styles"];function l(e,t,n,l,c){var u=(l=l||{scope:"",fields:void 0}).scope,d=l.fields,h=void 0===d?a:d,p=s.forwardRef((function(a,l){var c=s.useRef(),d=(0,i.m)(h,u),p=d.styles,f=(d.dir,(0,o.Tt)(d,["styles","dir"])),g=n?n(a):void 0,m=c.current&&c.current.__cachedInputs__||[];if(!c.current||p!==m[1]||a.styles!==m[2]){var y=function(e){return(0,r.p)(e,t,p,a.styles)};y.__cachedInputs__=[t,p,a.styles],y.__noStyleOverride__=!p&&!a.styles,c.current=y}return s.createElement(e,(0,o.Cl)({ref:l},f,g,a,{styles:c.current}))}));p.displayName="Styled"+(e.displayName||e.name);var f=c?s.memo(p):p;return p.displayName&&(f.displayName=p.displayName),f}},81180:(e,t,n)=>{"use strict";n.d(t,{M:()=>u,v:()=>c});var o=n(30538),s=n(19559),r=n(4519),i=n(69746),a=new WeakMap;function l(e,t){var n,o=a.get(e);return n=o?o+t:1,a.set(e,n),n}function c(e){o.useEffect((function(){var t,n,o=(0,s.z)(null===(t=e)||void 0===t?void 0:t.current);if(o&&!0!==(null===(n=o.FabricConfig)||void 0===n?void 0:n.disableFocusRects)){var r=l(o,1);return r<=1&&(o.addEventListener("mousedown",d,!0),o.addEventListener("pointerdown",h,!0),o.addEventListener("keydown",p,!0)),function(){var e;o&&!0!==(null===(e=o.FabricConfig)||void 0===e?void 0:e.disableFocusRects)&&0===(r=l(o,-1))&&(o.removeEventListener("mousedown",d,!0),o.removeEventListener("pointerdown",h,!0),o.removeEventListener("keydown",p,!0))}}}),[e])}var u=function(e){return c(e.rootRef),null};function d(e){(0,i.Fy)(!1,e.target)}function h(e){"mouse"!==e.pointerType&&(0,i.Fy)(!1,e.target)}function p(e){(0,r.n)(e.which)&&(0,i.Fy)(!0,e.target)}},82729:(e,t,n)=>{"use strict";function o(e){console&&console.warn&&console.warn(e)}function s(e){}n.d(t,{K:()=>s,R:()=>o})},11641:(e,t,n)=>{"use strict";function o(e,t,n,o,s){}n.d(t,{J:()=>o})},72592:(e,t,n)=>{"use strict";function o(){}function s(e){}n.d(t,{A:()=>s,B:()=>o})},74010:(e,t,n)=>{"use strict";function o(e,t,n){}n.d(t,{A:()=>o})},34924:(e,t,n)=>{"use strict";function o(e,t,n){}n.d(t,{Y:()=>o})},65618:function(e,t){var n="undefined"!=typeof self?self:this,o=function(){function e(){this.fetch=!1,this.DOMException=n.DOMException}return e.prototype=n,new e}();!function(e){!function(t){var n="URLSearchParams"in e,o="Symbol"in e&&"iterator"in Symbol,s="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),r="FormData"in e,i="ArrayBuffer"in e;if(i)var a=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],l=ArrayBuffer.isView||function(e){return e&&a.indexOf(Object.prototype.toString.call(e))>-1};function c(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function u(e){return"string"!=typeof e&&(e=String(e)),e}function d(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return o&&(t[Symbol.iterator]=function(){return t}),t}function h(e){this.map={},e instanceof h?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function p(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function f(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function g(e){var t=new FileReader,n=f(t);return t.readAsArrayBuffer(e),n}function m(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function y(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:s&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:r&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:n&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():i&&s&&(t=e)&&DataView.prototype.isPrototypeOf(t)?(this._bodyArrayBuffer=m(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):i&&(ArrayBuffer.prototype.isPrototypeOf(e)||l(e))?this._bodyArrayBuffer=m(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},s&&(this.blob=function(){var e=p(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?p(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(g)}),this.text=function(){var e,t,n,o=p(this);if(o)return o;if(this._bodyBlob)return e=this._bodyBlob,n=f(t=new FileReader),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),o=0;o<t.length;o++)n[o]=String.fromCharCode(t[o]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},r&&(this.formData=function(){return this.text().then(S)}),this.json=function(){return this.text().then(JSON.parse)},this}h.prototype.append=function(e,t){e=c(e),t=u(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},h.prototype.delete=function(e){delete this.map[c(e)]},h.prototype.get=function(e){return e=c(e),this.has(e)?this.map[e]:null},h.prototype.has=function(e){return this.map.hasOwnProperty(c(e))},h.prototype.set=function(e,t){this.map[c(e)]=u(t)},h.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},h.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),d(e)},h.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),d(e)},h.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),d(e)},o&&(h.prototype[Symbol.iterator]=h.prototype.entries);var v=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function b(e,t){var n,o,s=(t=t||{}).body;if(e instanceof b){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new h(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,s||null==e._bodyInit||(s=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new h(t.headers)),this.method=(o=(n=t.method||this.method||"GET").toUpperCase(),v.indexOf(o)>-1?o:n),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&s)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(s)}function S(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),o=n.shift().replace(/\+/g," "),s=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(o),decodeURIComponent(s))}})),t}function w(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new h(t.headers),this.url=t.url||"",this._initBody(e)}b.prototype.clone=function(){return new b(this,{body:this._bodyInit})},y.call(b.prototype),y.call(w.prototype),w.prototype.clone=function(){return new w(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new h(this.headers),url:this.url})},w.error=function(){var e=new w(null,{status:0,statusText:""});return e.type="error",e};var T=[301,302,303,307,308];w.redirect=function(e,t){if(-1===T.indexOf(t))throw new RangeError("Invalid status code");return new w(null,{status:t,headers:{location:e}})},t.DOMException=e.DOMException;try{new t.DOMException}catch(e){t.DOMException=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function C(e,n){return new Promise((function(o,r){var i=new b(e,n);if(i.signal&&i.signal.aborted)return r(new t.DOMException("Aborted","AbortError"));var a=new XMLHttpRequest;function l(){a.abort()}a.onload=function(){var e,t,n={status:a.status,statusText:a.statusText,headers:(e=a.getAllResponseHeaders()||"",t=new h,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var n=e.split(":"),o=n.shift().trim();if(o){var s=n.join(":").trim();t.append(o,s)}})),t)};n.url="responseURL"in a?a.responseURL:n.headers.get("X-Request-URL");var s="response"in a?a.response:a.responseText;o(new w(s,n))},a.onerror=function(){r(new TypeError("Network request failed"))},a.ontimeout=function(){r(new TypeError("Network request failed"))},a.onabort=function(){r(new t.DOMException("Aborted","AbortError"))},a.open(i.method,i.url,!0),"include"===i.credentials?a.withCredentials=!0:"omit"===i.credentials&&(a.withCredentials=!1),"responseType"in a&&s&&(a.responseType="blob"),i.headers.forEach((function(e,t){a.setRequestHeader(t,e)})),i.signal&&(i.signal.addEventListener("abort",l),a.onreadystatechange=function(){4===a.readyState&&i.signal.removeEventListener("abort",l)}),a.send(void 0===i._bodyInit?null:i._bodyInit)}))}C.polyfill=!0,e.fetch||(e.fetch=C,e.Headers=h,e.Request=b,e.Response=w),t.Headers=h,t.Request=b,t.Response=w,t.fetch=C,Object.defineProperty(t,"__esModule",{value:!0})}({})}(o),o.fetch.ponyfill=!0,delete o.fetch.polyfill;var s=o;(t=s.fetch).default=s.fetch,t.fetch=s.fetch,t.Headers=s.Headers,t.Request=s.Request,t.Response=s.Response,e.exports=t},60221:e=>{"use strict";function t(e){if(this._capacity=o(e),this._length=0,this._front=0,n(e)){for(var t=e.length,s=0;s<t;++s)this[s]=e[s];this._length=t}}t.prototype.toArray=function(){for(var e=this._length,t=new Array(e),n=this._front,o=this._capacity,s=0;s<e;++s)t[s]=this[n+s&o-1];return t},t.prototype.push=function(e){var t=arguments.length,n=this._length;if(t>1){var o=this._capacity;if(n+t>o){for(var s=0;s<t;++s)this._checkCapacity(n+1),this[r=this._front+n&this._capacity-1]=arguments[s],n++,this._length=n;return n}var r=this._front;for(s=0;s<t;++s)this[r+n&o-1]=arguments[s],r++;return this._length=n+t,n+t}return 0===t?n:(this._checkCapacity(n+1),this[s=this._front+n&this._capacity-1]=e,this._length=n+1,n+1)},t.prototype.pop=function(){var e=this._length;if(0!==e){var t=this._front+e-1&this._capacity-1,n=this[t];return this[t]=void 0,this._length=e-1,n}},t.prototype.shift=function(){var e=this._length;if(0!==e){var t=this._front,n=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length=e-1,n}},t.prototype.unshift=function(e){var t=this._length,n=arguments.length;if(n>1){if(t+n>(s=this._capacity)){for(var o=n-1;o>=0;o--){this._checkCapacity(t+1);var s=this._capacity;this[i=(this._front-1&s-1^s)-s]=arguments[o],t++,this._length=t,this._front=i}return t}var r=this._front;for(o=n-1;o>=0;o--){var i;this[i=(r-1&s-1^s)-s]=arguments[o],r=i}return this._front=r,this._length=t+n,t+n}return 0===n?t:(this._checkCapacity(t+1),s=this._capacity,this[o=(this._front-1&s-1^s)-s]=e,this._length=t+1,this._front=o,t+1)},t.prototype.peekBack=function(){var e=this._length;if(0!==e)return this[this._front+e-1&this._capacity-1]},t.prototype.peekFront=function(){if(0!==this._length)return this[this._front]},t.prototype.get=function(e){var t=e;if(t===(0|t)){var n=this._length;if(t<0&&(t+=n),!(t<0||t>=n))return this[this._front+t&this._capacity-1]}},t.prototype.isEmpty=function(){return 0===this._length},t.prototype.clear=function(){for(var e=this._length,t=this._front,n=this._capacity,o=0;o<e;++o)this[t+o&n-1]=void 0;this._length=0,this._front=0},t.prototype.toString=function(){return this.toArray().toString()},t.prototype.valueOf=t.prototype.toString,t.prototype.removeFront=t.prototype.shift,t.prototype.removeBack=t.prototype.pop,t.prototype.insertFront=t.prototype.unshift,t.prototype.insertBack=t.prototype.push,t.prototype.enqueue=t.prototype.push,t.prototype.dequeue=t.prototype.shift,t.prototype.toJSON=t.prototype.toArray,Object.defineProperty(t.prototype,"length",{get:function(){return this._length},set:function(){throw new RangeError("")}}),t.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(o(1.5*this._capacity+16))},t.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e;var n=this._front,o=this._length;n+o>t&&function(e,t,n,o,s){for(var r=0;r<s;++r)n[r+o]=e[r+0],e[r+0]=void 0}(this,0,this,t,n+o&t-1)};var n=Array.isArray;function o(e){if("number"!=typeof e){if(!n(e))return 16;e=e.length}return t=Math.min(Math.max(16,e),1073741824),t>>>=0,t-=1,t|=t>>1,t|=t>>2,t|=t>>4,1+((t|=t>>8)|t>>16);var t}e.exports=t},6731:e=>{"use strict";var t=Object.prototype.hasOwnProperty,n="~";function o(){}function s(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function r(e,t,o,r,i){if("function"!=typeof o)throw new TypeError("The listener must be a function");var a=new s(o,r||e,i),l=n?n+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],a]:e._events[l].push(a):(e._events[l]=a,e._eventsCount++),e}function i(e,t){0==--e._eventsCount?e._events=new o:delete e._events[t]}function a(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(n=!1)),a.prototype.eventNames=function(){var e,o,s=[];if(0===this._eventsCount)return s;for(o in e=this._events)t.call(e,o)&&s.push(n?o.slice(1):o);return Object.getOwnPropertySymbols?s.concat(Object.getOwnPropertySymbols(e)):s},a.prototype.listeners=function(e){var t=n?n+e:e,o=this._events[t];if(!o)return[];if(o.fn)return[o.fn];for(var s=0,r=o.length,i=new Array(r);s<r;s++)i[s]=o[s].fn;return i},a.prototype.listenerCount=function(e){var t=n?n+e:e,o=this._events[t];return o?o.fn?1:o.length:0},a.prototype.emit=function(e,t,o,s,r,i){var a=n?n+e:e;if(!this._events[a])return!1;var l,c,u=this._events[a],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,o),!0;case 4:return u.fn.call(u.context,t,o,s),!0;case 5:return u.fn.call(u.context,t,o,s,r),!0;case 6:return u.fn.call(u.context,t,o,s,r,i),!0}for(c=1,l=new Array(d-1);c<d;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var h,p=u.length;for(c=0;c<p;c++)switch(u[c].once&&this.removeListener(e,u[c].fn,void 0,!0),d){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,o);break;case 4:u[c].fn.call(u[c].context,t,o,s);break;default:if(!l)for(h=1,l=new Array(d-1);h<d;h++)l[h-1]=arguments[h];u[c].fn.apply(u[c].context,l)}}return!0},a.prototype.on=function(e,t,n){return r(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return r(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,o,s){var r=n?n+e:e;if(!this._events[r])return this;if(!t)return i(this,r),this;var a=this._events[r];if(a.fn)a.fn!==t||s&&!a.once||o&&a.context!==o||i(this,r);else{for(var l=0,c=[],u=a.length;l<u;l++)(a[l].fn!==t||s&&!a[l].once||o&&a[l].context!==o)&&c.push(a[l]);c.length?this._events[r]=1===c.length?c[0]:c:i(this,r)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&i(this,t)):(this._events=new o,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a},18156:e=>{"use strict";var t,n="object"==typeof Reflect?Reflect:null,o=n&&"function"==typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!=e};function r(){r.init.call(this)}e.exports=r,e.exports.once=function(e,t){return new Promise((function(n,o){function s(n){e.removeListener(t,r),o(n)}function r(){"function"==typeof e.removeListener&&e.removeListener("error",s),n([].slice.call(arguments))}g(e,t,r,{once:!0}),"error"!==t&&function(e,t){"function"==typeof e.on&&g(e,"error",t,{once:!0})}(e,s)}))},r.EventEmitter=r,r.prototype._events=void 0,r.prototype._eventsCount=0,r.prototype._maxListeners=void 0;var i=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?r.defaultMaxListeners:e._maxListeners}function c(e,t,n,o){var s,r,i,c;if(a(n),void 0===(r=e._events)?(r=e._events=Object.create(null),e._eventsCount=0):(void 0!==r.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),r=e._events),i=r[t]),void 0===i)i=r[t]=n,++e._eventsCount;else if("function"==typeof i?i=r[t]=o?[n,i]:[i,n]:o?i.unshift(n):i.push(n),(s=l(e))>0&&i.length>s&&!i.warned){i.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+i.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=i.length,c=u,console&&console.warn&&console.warn(c)}return e}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(e,t,n){var o={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},s=u.bind(o);return s.listener=n,o.wrapFn=s,s}function h(e,t,n){var o=e._events;if(void 0===o)return[];var s=o[t];return void 0===s?[]:"function"==typeof s?n?[s.listener||s]:[s]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(s):f(s,s.length)}function p(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function f(e,t){for(var n=new Array(t),o=0;o<t;++o)n[o]=e[o];return n}function g(e,t,n,o){if("function"==typeof e.on)o.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function s(r){o.once&&e.removeEventListener(t,s),n(r)}))}}Object.defineProperty(r,"defaultMaxListeners",{enumerable:!0,get:function(){return i},set:function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");i=e}}),r.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},r.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},r.prototype.getMaxListeners=function(){return l(this)},r.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var s="error"===e,r=this._events;if(void 0!==r)s=s&&void 0===r.error;else if(!s)return!1;if(s){var i;if(t.length>0&&(i=t[0]),i instanceof Error)throw i;var a=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw a.context=i,a}var l=r[e];if(void 0===l)return!1;if("function"==typeof l)o(l,this,t);else{var c=l.length,u=f(l,c);for(n=0;n<c;++n)o(u[n],this,t)}return!0},r.prototype.addListener=function(e,t){return c(this,e,t,!1)},r.prototype.on=r.prototype.addListener,r.prototype.prependListener=function(e,t){return c(this,e,t,!0)},r.prototype.once=function(e,t){return a(t),this.on(e,d(this,e,t)),this},r.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,d(this,e,t)),this},r.prototype.removeListener=function(e,t){var n,o,s,r,i;if(a(t),void 0===(o=this._events))return this;if(void 0===(n=o[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete o[e],o.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(s=-1,r=n.length-1;r>=0;r--)if(n[r]===t||n[r].listener===t){i=n[r].listener,s=r;break}if(s<0)return this;0===s?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,s),1===n.length&&(o[e]=n[0]),void 0!==o.removeListener&&this.emit("removeListener",e,i||t)}return this},r.prototype.off=r.prototype.removeListener,r.prototype.removeAllListeners=function(e){var t,n,o;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var s,r=Object.keys(n);for(o=0;o<r.length;++o)"removeListener"!==(s=r[o])&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(o=t.length-1;o>=0;o--)this.removeListener(e,t[o]);return this},r.prototype.listeners=function(e){return h(this,e,!0)},r.prototype.rawListeners=function(e){return h(this,e,!1)},r.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},r.prototype.listenerCount=p,r.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},92792:e=>{"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var o,s,r;if(Array.isArray(t)){if((o=t.length)!=n.length)return!1;for(s=o;0!=s--;)if(!e(t[s],n[s]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((o=(r=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(s=o;0!=s--;)if(!Object.prototype.hasOwnProperty.call(n,r[s]))return!1;for(s=o;0!=s--;){var i=r[s];if(!e(t[i],n[i]))return!1}return!0}return t!=t&&n!=n}},20731:function(e,t,n){!function(e){"use strict";function t(e){for(var t=0,n=Math.min(65536,e.length+1),o=new Uint16Array(n),s=[],r=0;;){var i=t<e.length;if(!i||r>=n-1){var a=o.subarray(0,r);if(s.push(String.fromCharCode.apply(null,a)),!i)return s.join("");e=e.subarray(t),t=0,r=0}var l=e[t++];if(128&l){if(192==(224&l)){var c=63&e[t++];o[r++]=(31&l)<<6|c}else if(224==(240&l)){c=63&e[t++];var u=63&e[t++];o[r++]=(31&l)<<12|c<<6|u}else if(240==(248&l)){var d=(7&l)<<18|(c=63&e[t++])<<12|(u=63&e[t++])<<6|63&e[t++];d>65535&&(d-=65536,o[r++]=d>>>10&1023|55296,d=56320|1023&d),o[r++]=d}}else o[r++]=l}}var n="Failed to ",o=function(e,t,o){if(e)throw new Error("".concat(n).concat(t,": the '").concat(o,"' option is unsupported."))},s="function"==typeof Buffer&&Buffer.from,r=s?function(e){return Buffer.from(e)}:function(e){for(var t=0,n=e.length,o=0,s=Math.max(32,n+(n>>>1)+7),r=new Uint8Array(s>>>3<<3);t<n;){var i=e.charCodeAt(t++);if(i>=55296&&i<=56319){if(t<n){var a=e.charCodeAt(t);56320==(64512&a)&&(++t,i=((1023&i)<<10)+(1023&a)+65536)}if(i>=55296&&i<=56319)continue}if(o+4>r.length){s+=8,s=(s*=1+t/e.length*2)>>>3<<3;var l=new Uint8Array(s);l.set(r),r=l}if(4294967168&i){if(4294965248&i)if(4294901760&i){if(4292870144&i)continue;r[o++]=i>>>18&7|240,r[o++]=i>>>12&63|128,r[o++]=i>>>6&63|128}else r[o++]=i>>>12&15|224,r[o++]=i>>>6&63|128;else r[o++]=i>>>6&31|192;r[o++]=63&i|128}else r[o++]=i}return r.slice?r.slice(0,o):r.subarray(0,o)};function i(){this.encoding="utf-8"}i.prototype.encode=function(e,t){return o(t&&t.stream,"encode","stream"),r(e)};var a=!s&&"function"==typeof Blob&&"function"==typeof URL&&"function"==typeof URL.createObjectURL,l=["utf-8","utf8","unicode-1-1-utf-8"],c=t;s?c=function(e,t){return(e instanceof Buffer?e:Buffer.from(e.buffer,e.byteOffset,e.byteLength)).toString(t)}:a&&(c=function(e){try{return function(e){var t;try{var n=new Blob([e],{type:"text/plain;charset=UTF-8"});t=URL.createObjectURL(n);var o=new XMLHttpRequest;return o.open("GET",t,!1),o.send(),o.responseText}finally{t&&URL.revokeObjectURL(t)}}(e)}catch(n){return t(e)}});var u="construct 'TextDecoder'",d="".concat(n," ").concat(u,": the ");function h(e,t){if(o(t&&t.fatal,u,"fatal"),e=e||"utf-8",!(s?Buffer.isEncoding(e):-1!==l.indexOf(e.toLowerCase())))throw new RangeError("".concat(d," encoding label provided ('").concat(e,"') is invalid."));this.encoding=e,this.fatal=!1,this.ignoreBOM=!1}h.prototype.decode=function(e,t){var n;return o(t&&t.stream,"decode","stream"),n=e instanceof Uint8Array?e:e.buffer instanceof ArrayBuffer?new Uint8Array(e.buffer):new Uint8Array(e),c(n,this.encoding)},e.TextEncoder=e.TextEncoder||i,e.TextDecoder=e.TextDecoder||h}("undefined"!=typeof window?window:void 0!==n.g?n.g:this)},93710:e=>{"use strict";e.exports=function(e,t){for(var n=arguments.length,o=new Array(n>2?n-2:0),s=2;s<n;s++)o[s-2]=arguments[s];if(function(e){if(void 0===e)throw new Error("invariant(...): Second argument must be a string.")}(t),!e){var r;if(void 0===t)r=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var i=0;(r=new Error(t.replace(/%s/g,(function(){return String(o[i++])})))).name="Invariant Violation"}throw r.framesToPop=1,r}}},18919:(e,t,n)=>{e.exports.Dispatcher=n(1418)},1418:(e,t,n)=>{"use strict";t.__esModule=!0;var o=n(93710),s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._callbacks={},this._isDispatching=!1,this._isHandled={},this._isPending={},this._lastID=1}return e.prototype.register=function(e){var t="ID_"+this._lastID++;return this._callbacks[t]=e,t},e.prototype.unregister=function(e){this._callbacks[e]||o(!1),delete this._callbacks[e]},e.prototype.waitFor=function(e){this._isDispatching||o(!1);for(var t=0;t<e.length;t++){var n=e[t];this._isPending[n]?this._isHandled[n]||o(!1):(this._callbacks[n]||o(!1),this._invokeCallback(n))}},e.prototype.dispatch=function(e){this._isDispatching&&o(!1),this._startDispatching(e);try{for(var t in this._callbacks)this._isPending[t]||this._invokeCallback(t)}finally{this._stopDispatching()}},e.prototype.isDispatching=function(){return this._isDispatching},e.prototype._invokeCallback=function(e){this._isPending[e]=!0,this._callbacks[e](this._pendingPayload),this._isHandled[e]=!0},e.prototype._startDispatching=function(e){for(var t in this._callbacks)this._isPending[t]=!1,this._isHandled[t]=!1;this._pendingPayload=e,this._isDispatching=!0},e.prototype._stopDispatching=function(){delete this._pendingPayload,this._isDispatching=!1},e}();e.exports=s},27331:(e,t,n)=>{"use strict";n.r(t),n.d(t,{createBrowserHistory:()=>_,createHashHistory:()=>M,createLocation:()=>m,createMemoryHistory:()=>R,createPath:()=>g,locationsAreEqual:()=>y,parsePath:()=>f});var o=n(26443);function s(e){return"/"===e.charAt(0)}function r(e,t){for(var n=t,o=n+1,s=e.length;o<s;n+=1,o+=1)e[n]=e[o];e.pop()}const i=function(e,t){void 0===t&&(t="");var n,o=e&&e.split("/")||[],i=t&&t.split("/")||[],a=e&&s(e),l=t&&s(t),c=a||l;if(e&&s(e)?i=o:o.length&&(i.pop(),i=i.concat(o)),!i.length)return"/";if(i.length){var u=i[i.length-1];n="."===u||".."===u||""===u}else n=!1;for(var d=0,h=i.length;h>=0;h--){var p=i[h];"."===p?r(i,h):".."===p?(r(i,h),d++):d&&(r(i,h),d--)}if(!c)for(;d--;d)i.unshift("..");!c||""===i[0]||i[0]&&s(i[0])||i.unshift("");var f=i.join("/");return n&&"/"!==f.substr(-1)&&(f+="/"),f};function a(e){return e.valueOf?e.valueOf():Object.prototype.valueOf.call(e)}const l=function e(t,n){if(t===n)return!0;if(null==t||null==n)return!1;if(Array.isArray(t))return Array.isArray(n)&&t.length===n.length&&t.every((function(t,o){return e(t,n[o])}));if("object"==typeof t||"object"==typeof n){var o=a(t),s=a(n);return o!==t||s!==n?e(o,s):Object.keys(Object.assign({},t,n)).every((function(o){return e(t[o],n[o])}))}return!1};var c=n(49481);function u(e){return"/"===e.charAt(0)?e:"/"+e}function d(e){return"/"===e.charAt(0)?e.substr(1):e}function h(e,t){return function(e,t){return 0===e.toLowerCase().indexOf(t.toLowerCase())&&-1!=="/?#".indexOf(e.charAt(t.length))}(e,t)?e.substr(t.length):e}function p(e){return"/"===e.charAt(e.length-1)?e.slice(0,-1):e}function f(e){var t=e||"/",n="",o="",s=t.indexOf("#");-1!==s&&(o=t.substr(s),t=t.substr(0,s));var r=t.indexOf("?");return-1!==r&&(n=t.substr(r),t=t.substr(0,r)),{pathname:t,search:"?"===n?"":n,hash:"#"===o?"":o}}function g(e){var t=e.pathname,n=e.search,o=e.hash,s=t||"/";return n&&"?"!==n&&(s+="?"===n.charAt(0)?n:"?"+n),o&&"#"!==o&&(s+="#"===o.charAt(0)?o:"#"+o),s}function m(e,t,n,s){var r;"string"==typeof e?(r=f(e)).state=t:(void 0===(r=(0,o.A)({},e)).pathname&&(r.pathname=""),r.search?"?"!==r.search.charAt(0)&&(r.search="?"+r.search):r.search="",r.hash?"#"!==r.hash.charAt(0)&&(r.hash="#"+r.hash):r.hash="",void 0!==t&&void 0===r.state&&(r.state=t));try{r.pathname=decodeURI(r.pathname)}catch(e){throw e instanceof URIError?new URIError('Pathname "'+r.pathname+'" could not be decoded. This is likely caused by an invalid percent-encoding.'):e}return n&&(r.key=n),s?r.pathname?"/"!==r.pathname.charAt(0)&&(r.pathname=i(r.pathname,s.pathname)):r.pathname=s.pathname:r.pathname||(r.pathname="/"),r}function y(e,t){return e.pathname===t.pathname&&e.search===t.search&&e.hash===t.hash&&e.key===t.key&&l(e.state,t.state)}function v(){var e=null,t=[];return{setPrompt:function(t){return e=t,function(){e===t&&(e=null)}},confirmTransitionTo:function(t,n,o,s){if(null!=e){var r="function"==typeof e?e(t,n):e;"string"==typeof r?"function"==typeof o?o(r,s):s(!0):s(!1!==r)}else s(!0)},appendListener:function(e){var n=!0;function o(){n&&e.apply(void 0,arguments)}return t.push(o),function(){n=!1,t=t.filter((function(e){return e!==o}))}},notifyListeners:function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];t.forEach((function(e){return e.apply(void 0,n)}))}}}var b=!("undefined"==typeof window||!window.document||!window.document.createElement);function S(e,t){t(window.confirm(e))}var w="popstate",T="hashchange";function C(){try{return window.history.state||{}}catch(e){return{}}}function _(e){void 0===e&&(e={}),b||(0,c.A)(!1);var t,n=window.history,s=(-1===(t=window.navigator.userAgent).indexOf("Android 2.")&&-1===t.indexOf("Android 4.0")||-1===t.indexOf("Mobile Safari")||-1!==t.indexOf("Chrome")||-1!==t.indexOf("Windows Phone"))&&window.history&&"pushState"in window.history,r=!(-1===window.navigator.userAgent.indexOf("Trident")),i=e,a=i.forceRefresh,l=void 0!==a&&a,d=i.getUserConfirmation,f=void 0===d?S:d,y=i.keyLength,_=void 0===y?6:y,k=e.basename?p(u(e.basename)):"";function E(e){var t=e||{},n=t.key,o=t.state,s=window.location,r=s.pathname+s.search+s.hash;return k&&(r=h(r,k)),m(r,o,n)}function A(){return Math.random().toString(36).substr(2,_)}var I=v();function P(e){(0,o.A)(G,e),G.length=n.length,I.notifyListeners(G.location,G.action)}function M(e){(function(e){return void 0===e.state&&-1===navigator.userAgent.indexOf("CriOS")})(e)||D(E(e.state))}function x(){D(E(C()))}var R=!1;function D(e){R?(R=!1,P()):I.confirmTransitionTo(e,"POP",f,(function(t){t?P({action:"POP",location:e}):function(e){var t=G.location,n=N.indexOf(t.key);-1===n&&(n=0);var o=N.indexOf(e.key);-1===o&&(o=0);var s=n-o;s&&(R=!0,F(s))}(e)}))}var O=E(C()),N=[O.key];function L(e){return k+g(e)}function F(e){n.go(e)}var B=0;function W(e){1===(B+=e)&&1===e?(window.addEventListener(w,M),r&&window.addEventListener(T,x)):0===B&&(window.removeEventListener(w,M),r&&window.removeEventListener(T,x))}var U=!1,G={length:n.length,action:"POP",location:O,createHref:L,push:function(e,t){var o="PUSH",r=m(e,t,A(),G.location);I.confirmTransitionTo(r,o,f,(function(e){if(e){var t=L(r),i=r.key,a=r.state;if(s)if(n.pushState({key:i,state:a},null,t),l)window.location.href=t;else{var c=N.indexOf(G.location.key),u=N.slice(0,c+1);u.push(r.key),N=u,P({action:o,location:r})}else window.location.href=t}}))},replace:function(e,t){var o="REPLACE",r=m(e,t,A(),G.location);I.confirmTransitionTo(r,o,f,(function(e){if(e){var t=L(r),i=r.key,a=r.state;if(s)if(n.replaceState({key:i,state:a},null,t),l)window.location.replace(t);else{var c=N.indexOf(G.location.key);-1!==c&&(N[c]=r.key),P({action:o,location:r})}else window.location.replace(t)}}))},go:F,goBack:function(){F(-1)},goForward:function(){F(1)},block:function(e){void 0===e&&(e=!1);var t=I.setPrompt(e);return U||(W(1),U=!0),function(){return U&&(U=!1,W(-1)),t()}},listen:function(e){var t=I.appendListener(e);return W(1),function(){W(-1),t()}}};return G}var k="hashchange",E={hashbang:{encodePath:function(e){return"!"===e.charAt(0)?e:"!/"+d(e)},decodePath:function(e){return"!"===e.charAt(0)?e.substr(1):e}},noslash:{encodePath:d,decodePath:u},slash:{encodePath:u,decodePath:u}};function A(e){var t=e.indexOf("#");return-1===t?e:e.slice(0,t)}function I(){var e=window.location.href,t=e.indexOf("#");return-1===t?"":e.substring(t+1)}function P(e){window.location.replace(A(window.location.href)+"#"+e)}function M(e){void 0===e&&(e={}),b||(0,c.A)(!1);var t=window.history,n=(window.navigator.userAgent.indexOf("Firefox"),e),s=n.getUserConfirmation,r=void 0===s?S:s,i=n.hashType,a=void 0===i?"slash":i,l=e.basename?p(u(e.basename)):"",d=E[a],f=d.encodePath,y=d.decodePath;function w(){var e=y(I());return l&&(e=h(e,l)),m(e)}var T=v();function C(e){(0,o.A)(U,e),U.length=t.length,T.notifyListeners(U.location,U.action)}var _=!1,M=null;function x(){var e,t,n=I(),o=f(n);if(n!==o)P(o);else{var s=w(),i=U.location;if(!_&&(t=s,(e=i).pathname===t.pathname&&e.search===t.search&&e.hash===t.hash))return;if(M===g(s))return;M=null,function(e){if(_)_=!1,C();else{T.confirmTransitionTo(e,"POP",r,(function(t){t?C({action:"POP",location:e}):function(e){var t=U.location,n=N.lastIndexOf(g(t));-1===n&&(n=0);var o=N.lastIndexOf(g(e));-1===o&&(o=0);var s=n-o;s&&(_=!0,L(s))}(e)}))}}(s)}}var R=I(),D=f(R);R!==D&&P(D);var O=w(),N=[g(O)];function L(e){t.go(e)}var F=0;function B(e){1===(F+=e)&&1===e?window.addEventListener(k,x):0===F&&window.removeEventListener(k,x)}var W=!1,U={length:t.length,action:"POP",location:O,createHref:function(e){var t=document.querySelector("base"),n="";return t&&t.getAttribute("href")&&(n=A(window.location.href)),n+"#"+f(l+g(e))},push:function(e,t){var n="PUSH",o=m(e,void 0,void 0,U.location);T.confirmTransitionTo(o,n,r,(function(e){if(e){var t=g(o),s=f(l+t);if(I()!==s){M=t,function(e){window.location.hash=e}(s);var r=N.lastIndexOf(g(U.location)),i=N.slice(0,r+1);i.push(t),N=i,C({action:n,location:o})}else C()}}))},replace:function(e,t){var n="REPLACE",o=m(e,void 0,void 0,U.location);T.confirmTransitionTo(o,n,r,(function(e){if(e){var t=g(o),s=f(l+t);I()!==s&&(M=t,P(s));var r=N.indexOf(g(U.location));-1!==r&&(N[r]=t),C({action:n,location:o})}}))},go:L,goBack:function(){L(-1)},goForward:function(){L(1)},block:function(e){void 0===e&&(e=!1);var t=T.setPrompt(e);return W||(B(1),W=!0),function(){return W&&(W=!1,B(-1)),t()}},listen:function(e){var t=T.appendListener(e);return B(1),function(){B(-1),t()}}};return U}function x(e,t,n){return Math.min(Math.max(e,t),n)}function R(e){void 0===e&&(e={});var t=e,n=t.getUserConfirmation,s=t.initialEntries,r=void 0===s?["/"]:s,i=t.initialIndex,a=void 0===i?0:i,l=t.keyLength,c=void 0===l?6:l,u=v();function d(e){(0,o.A)(S,e),S.length=S.entries.length,u.notifyListeners(S.location,S.action)}function h(){return Math.random().toString(36).substr(2,c)}var p=x(a,0,r.length-1),f=r.map((function(e){return m(e,void 0,"string"==typeof e?h():e.key||h())})),y=g;function b(e){var t=x(S.index+e,0,S.entries.length-1),o=S.entries[t];u.confirmTransitionTo(o,"POP",n,(function(e){e?d({action:"POP",location:o,index:t}):d()}))}var S={length:f.length,action:"POP",location:f[p],index:p,entries:f,createHref:y,push:function(e,t){var o="PUSH",s=m(e,t,h(),S.location);u.confirmTransitionTo(s,o,n,(function(e){if(e){var t=S.index+1,n=S.entries.slice(0);n.length>t?n.splice(t,n.length-t,s):n.push(s),d({action:o,location:s,index:t,entries:n})}}))},replace:function(e,t){var o="REPLACE",s=m(e,t,h(),S.location);u.confirmTransitionTo(s,o,n,(function(e){e&&(S.entries[S.index]=s,d({action:o,location:s}))}))},go:b,goBack:function(){b(-1)},goForward:function(){b(1)},canGo:function(e){var t=S.index+e;return t>=0&&t<S.entries.length},block:function(e){return void 0===e&&(e=!1),u.setPrompt(e)},listen:function(e){return u.appendListener(e)}};return S}},78535:(e,t,n)=>{"use strict";var o=n(91272),s={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},r={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},i={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},a={};function l(e){return o.isMemo(e)?i:a[e.$$typeof]||s}a[o.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a[o.Memo]=i;var c=Object.defineProperty,u=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,f=Object.prototype;e.exports=function e(t,n,o){if("string"!=typeof n){if(f){var s=p(n);s&&s!==f&&e(t,s,o)}var i=u(n);d&&(i=i.concat(d(n)));for(var a=l(t),g=l(n),m=0;m<i.length;++m){var y=i[m];if(!(r[y]||o&&o[y]||g&&g[y]||a&&a[y])){var v=h(n,y);try{c(t,y,v)}catch(e){}}}}return t}},76482:e=>{e.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},80665:(e,t,n)=>{n(76442),e.exports=self.fetch.bind(self)},85085:(e,t,n)=>{var o=n(76482);e.exports=function e(t,n,s){return o(n)||(s=n||s,n=[]),s=s||{},t instanceof RegExp?function(e,t){var n=e.source.match(/\((?!\?)/g);if(n)for(var o=0;o<n.length;o++)t.push({name:o,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return d(e,t)}(t,n):o(t)?function(t,n,o){for(var s=[],r=0;r<t.length;r++)s.push(e(t[r],n,o).source);return d(new RegExp("(?:"+s.join("|")+")",h(o)),n)}(t,n,s):function(e,t,n){return p(r(e,n),t,n)}(t,n,s)},e.exports.parse=r,e.exports.compile=function(e,t){return l(r(e,t),t)},e.exports.tokensToFunction=l,e.exports.tokensToRegExp=p;var s=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function r(e,t){for(var n,o=[],r=0,a=0,l="",c=t&&t.delimiter||"/";null!=(n=s.exec(e));){var d=n[0],h=n[1],p=n.index;if(l+=e.slice(a,p),a=p+d.length,h)l+=h[1];else{var f=e[a],g=n[2],m=n[3],y=n[4],v=n[5],b=n[6],S=n[7];l&&(o.push(l),l="");var w=null!=g&&null!=f&&f!==g,T="+"===b||"*"===b,C="?"===b||"*"===b,_=g||c,k=y||v,E=g||("string"==typeof o[o.length-1]?o[o.length-1]:"");o.push({name:m||r++,prefix:g||"",delimiter:_,optional:C,repeat:T,partial:w,asterisk:!!S,pattern:k?u(k):S?".*":i(_,E)})}}return a<e.length&&(l+=e.substr(a)),l&&o.push(l),o}function i(e,t){return!t||t.indexOf(e)>-1?"[^"+c(e)+"]+?":c(t)+"|(?:(?!"+c(t)+")[^"+c(e)+"])+?"}function a(e){return encodeURI(e).replace(/[\/?#]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}function l(e,t){for(var n=new Array(e.length),s=0;s<e.length;s++)"object"==typeof e[s]&&(n[s]=new RegExp("^(?:"+e[s].pattern+")$",h(t)));return function(t,s){for(var r="",i=t||{},l=(s||{}).pretty?a:encodeURIComponent,c=0;c<e.length;c++){var u=e[c];if("string"!=typeof u){var d,h=i[u.name];if(null==h){if(u.optional){u.partial&&(r+=u.prefix);continue}throw new TypeError('Expected "'+u.name+'" to be defined')}if(o(h)){if(!u.repeat)throw new TypeError('Expected "'+u.name+'" to not repeat, but received `'+JSON.stringify(h)+"`");if(0===h.length){if(u.optional)continue;throw new TypeError('Expected "'+u.name+'" to not be empty')}for(var p=0;p<h.length;p++){if(d=l(h[p]),!n[c].test(d))throw new TypeError('Expected all "'+u.name+'" to match "'+u.pattern+'", but received `'+JSON.stringify(d)+"`");r+=(0===p?u.prefix:u.delimiter)+d}}else{if(d=u.asterisk?encodeURI(h).replace(/[?#]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})):l(h),!n[c].test(d))throw new TypeError('Expected "'+u.name+'" to match "'+u.pattern+'", but received "'+d+'"');r+=u.prefix+d}}else r+=u}return r}}function c(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function u(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function d(e,t){return e.keys=t,e}function h(e){return e&&e.sensitive?"":"i"}function p(e,t,n){o(t)||(n=t||n,t=[]);for(var s=(n=n||{}).strict,r=!1!==n.end,i="",a=0;a<e.length;a++){var l=e[a];if("string"==typeof l)i+=c(l);else{var u=c(l.prefix),p="(?:"+l.pattern+")";t.push(l),l.repeat&&(p+="(?:"+u+p+")*"),i+=p=l.optional?l.partial?u+"("+p+")?":"(?:"+u+"("+p+"))?":u+"("+p+")"}}var f=c(n.delimiter||"/"),g=i.slice(-f.length)===f;return s||(i=(g?i.slice(0,-f.length):i)+"(?:"+f+"(?=$))?"),i+=r?"$":s&&g?"":"(?="+f+"|$)",d(new RegExp("^"+i,h(n)),t)}},97550:(e,t,n)=>{"use strict";var o=n(51605);function s(){}function r(){}r.resetWarningCache=s,e.exports=function(){function e(e,t,n,s,r,i){if(i!==o){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:r,resetWarningCache:s};return n.PropTypes=n,n}},87468:(e,t,n)=>{e.exports=n(97550)()},51605:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},77669:(e,t,n)=>{"use strict";var o=n(30538),s=n(82300);function r(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,a={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(a[e]=t,e=0;e<t.length;e++)i.add(t[e])}var u=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function g(e,t,n,o,s,r,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=o,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=r,this.removeEmptyString=i}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new g(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new g(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new g(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new g(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new g(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new g(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function b(e,t,n,o){var s=m.hasOwnProperty(t)?m[t]:null;(null!==s?0!==s.type:o||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,o){if(null==t||function(e,t,n,o){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!o&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,o))return!0;if(o)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,s,o)&&(n=null),o||null===s?function(e){return!!d.call(f,e)||!d.call(p,e)&&(h.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=null===n?3!==s.type&&"":n:(t=s.attributeName,o=s.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(s=s.type)||4===s&&!0===n?"":""+n,o?e.setAttributeNS(o,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(y,v);m[t]=new g(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(y,v);m[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(y,v);m[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)}));var S=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),T=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),A=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),x=Symbol.for("react.memo"),R=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var O=Symbol.iterator;function N(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=O&&e[O]||e["@@iterator"])?e:null}var L,F=Object.assign;function B(e){if(void 0===L)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);L=t&&t[1]||""}return"\n"+L+e}var W=!1;function U(e,t){if(!e||W)return"";W=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var o=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){o=e}e.call(t.prototype)}else{try{throw Error()}catch(e){o=e}e()}}catch(t){if(t&&o&&"string"==typeof t.stack){for(var s=t.stack.split("\n"),r=o.stack.split("\n"),i=s.length-1,a=r.length-1;1<=i&&0<=a&&s[i]!==r[a];)a--;for(;1<=i&&0<=a;i--,a--)if(s[i]!==r[a]){if(1!==i||1!==a)do{if(i--,0>--a||s[i]!==r[a]){var l="\n"+s[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=i&&0<=a);break}}}finally{W=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?B(e):""}function G(e){switch(e.tag){case 5:return B(e.type);case 16:return B("Lazy");case 13:return B("Suspense");case 19:return B("SuspenseList");case 0:case 2:case 15:return U(e.type,!1);case 11:return U(e.type.render,!1);case 1:return U(e.type,!0);default:return""}}function H(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case C:return"Fragment";case T:return"Portal";case k:return"Profiler";case _:return"StrictMode";case P:return"Suspense";case M:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case A:return(e.displayName||"Context")+".Consumer";case E:return(e._context.displayName||"Context")+".Provider";case I:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case x:return null!==(t=e.displayName||null)?t:H(e.type)||"Memo";case R:t=e._payload,e=e._init;try{return H(e(t))}catch(e){}}return null}function q(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return H(t);case 8:return t===_?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function $(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function V(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function z(e){e._valueTracker||(e._valueTracker=function(e){var t=V(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),o=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var s=n.get,r=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(e){o=""+e,r.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return o},setValue:function(e){o=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function j(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),o="";return e&&(o=V(e)?e.checked?"true":"false":e.value),(e=o)!==n&&(t.setValue(e),!0)}function Q(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function J(e,t){var n=t.checked;return F({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function K(e,t){var n=null==t.defaultValue?"":t.defaultValue,o=null!=t.checked?t.checked:t.defaultChecked;n=$(null!=t.value?t.value:n),e._wrapperState={initialChecked:o,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Y(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function X(e,t){Y(e,t);var n=$(t.value),o=t.type;if(null!=n)"number"===o?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===o||"reset"===o)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,$(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var o=t.type;if(!("submit"!==o&&"reset"!==o||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Q(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,o){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&o&&(e[n].defaultSelected=!0)}else{for(n=""+$(n),t=null,s=0;s<e.length;s++){if(e[s].value===n)return e[s].selected=!0,void(o&&(e[s].defaultSelected=!0));null!==t||e[s].disabled||(t=e[s])}null!==t&&(t.selected=!0)}}function oe(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(r(91));return F({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function se(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(r(92));if(te(n)){if(1<n.length)throw Error(r(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:$(n)}}function re(e,t){var n=$(t.value),o=$(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=o&&(e.defaultValue=""+o)}function ie(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,o){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function ge(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function me(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var o=0===n.indexOf("--"),s=ge(n,t[n],o);"float"===n&&(n="cssFloat"),o?e.setProperty(n,s):e[n]=s}}Object.keys(pe).forEach((function(e){fe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var ye=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(r(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(r(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(r(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(r(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Se=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Te=null,Ce=null,_e=null;function ke(e){if(e=Ss(e)){if("function"!=typeof Te)throw Error(r(280));var t=e.stateNode;t&&(t=Ts(t),Te(e.stateNode,e.type,t))}}function Ee(e){Ce?_e?_e.push(e):_e=[e]:Ce=e}function Ae(){if(Ce){var e=Ce,t=_e;if(_e=Ce=null,ke(e),t)for(e=0;e<t.length;e++)ke(t[e])}}function Ie(e,t){return e(t)}function Pe(){}var Me=!1;function xe(e,t,n){if(Me)return e(t,n);Me=!0;try{return Ie(e,t,n)}finally{Me=!1,(null!==Ce||null!==_e)&&(Pe(),Ae())}}function Re(e,t){var n=e.stateNode;if(null===n)return null;var o=Ts(n);if(null===o)return null;n=o[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(o=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!o;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(r(231,t,typeof n));return n}var De=!1;if(u)try{var Oe={};Object.defineProperty(Oe,"passive",{get:function(){De=!0}}),window.addEventListener("test",Oe,Oe),window.removeEventListener("test",Oe,Oe)}catch(ue){De=!1}function Ne(e,t,n,o,s,r,i,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(e){this.onError(e)}}var Le=!1,Fe=null,Be=!1,We=null,Ue={onError:function(e){Le=!0,Fe=e}};function Ge(e,t,n,o,s,r,i,a,l){Le=!1,Fe=null,Ne.apply(Ue,arguments)}function He(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function qe(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&null!==(e=e.alternate)&&(t=e.memoizedState),null!==t)return t.dehydrated}return null}function $e(e){if(He(e)!==e)throw Error(r(188))}function Ve(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=He(e)))throw Error(r(188));return t!==e?null:e}for(var n=e,o=t;;){var s=n.return;if(null===s)break;var i=s.alternate;if(null===i){if(null!==(o=s.return)){n=o;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return $e(s),e;if(i===o)return $e(s),t;i=i.sibling}throw Error(r(188))}if(n.return!==o.return)n=s,o=i;else{for(var a=!1,l=s.child;l;){if(l===n){a=!0,n=s,o=i;break}if(l===o){a=!0,o=s,n=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===n){a=!0,n=i,o=s;break}if(l===o){a=!0,o=i,n=s;break}l=l.sibling}if(!a)throw Error(r(189))}}if(n.alternate!==o)throw Error(r(190))}if(3!==n.tag)throw Error(r(188));return n.stateNode.current===n?e:t}(e))?ze(e):null}function ze(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=ze(e);if(null!==t)return t;e=e.sibling}return null}var je=s.unstable_scheduleCallback,Qe=s.unstable_cancelCallback,Je=s.unstable_shouldYield,Ke=s.unstable_requestPaint,Ye=s.unstable_now,Xe=s.unstable_getCurrentPriorityLevel,Ze=s.unstable_ImmediatePriority,et=s.unstable_UserBlockingPriority,tt=s.unstable_NormalPriority,nt=s.unstable_LowPriority,ot=s.unstable_IdlePriority,st=null,rt=null,it=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(at(e)/lt|0)|0},at=Math.log,lt=Math.LN2,ct=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var o=0,s=e.suspendedLanes,r=e.pingedLanes,i=268435455&n;if(0!==i){var a=i&~s;0!==a?o=dt(a):0!=(r&=i)&&(o=dt(r))}else 0!=(i=n&~s)?o=dt(i):0!==r&&(o=dt(r));if(0===o)return 0;if(0!==t&&t!==o&&!(t&s)&&((s=o&-o)>=(r=t&-t)||16===s&&4194240&r))return t;if(4&o&&(o|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=o;0<t;)s=1<<(n=31-it(t)),o|=e[n],t&=~s;return o}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!=(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function gt(){var e=ct;return!(4194240&(ct<<=1))&&(ct=64),e}function mt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-it(t)]=n}function vt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var o=31-it(n),s=1<<o;s&t|e[o]&t&&(e[o]|=t),n&=~s}}var bt=0;function St(e){return 1<(e&=-e)?4<e?268435455&e?16:536870912:4:1}var wt,Tt,Ct,_t,kt,Et=!1,At=[],It=null,Pt=null,Mt=null,xt=new Map,Rt=new Map,Dt=[],Ot="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Nt(e,t){switch(e){case"focusin":case"focusout":It=null;break;case"dragenter":case"dragleave":Pt=null;break;case"mouseover":case"mouseout":Mt=null;break;case"pointerover":case"pointerout":xt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rt.delete(t.pointerId)}}function Lt(e,t,n,o,s,r){return null===e||e.nativeEvent!==r?(e={blockedOn:t,domEventName:n,eventSystemFlags:o,nativeEvent:r,targetContainers:[s]},null!==t&&null!==(t=Ss(t))&&Tt(t),e):(e.eventSystemFlags|=o,t=e.targetContainers,null!==s&&-1===t.indexOf(s)&&t.push(s),e)}function Ft(e){var t=bs(e.target);if(null!==t){var n=He(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=qe(n)))return e.blockedOn=t,void kt(e.priority,(function(){Ct(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Bt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Jt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=Ss(n))&&Tt(t),e.blockedOn=n,!1;var o=new(n=e.nativeEvent).constructor(n.type,n);Se=o,n.target.dispatchEvent(o),Se=null,t.shift()}return!0}function Wt(e,t,n){Bt(e)&&n.delete(t)}function Ut(){Et=!1,null!==It&&Bt(It)&&(It=null),null!==Pt&&Bt(Pt)&&(Pt=null),null!==Mt&&Bt(Mt)&&(Mt=null),xt.forEach(Wt),Rt.forEach(Wt)}function Gt(e,t){e.blockedOn===t&&(e.blockedOn=null,Et||(Et=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,Ut)))}function Ht(e){function t(t){return Gt(t,e)}if(0<At.length){Gt(At[0],e);for(var n=1;n<At.length;n++){var o=At[n];o.blockedOn===e&&(o.blockedOn=null)}}for(null!==It&&Gt(It,e),null!==Pt&&Gt(Pt,e),null!==Mt&&Gt(Mt,e),xt.forEach(t),Rt.forEach(t),n=0;n<Dt.length;n++)(o=Dt[n]).blockedOn===e&&(o.blockedOn=null);for(;0<Dt.length&&null===(n=Dt[0]).blockedOn;)Ft(n),null===n.blockedOn&&Dt.shift()}var qt=S.ReactCurrentBatchConfig,$t=!0;function Vt(e,t,n,o){var s=bt,r=qt.transition;qt.transition=null;try{bt=1,jt(e,t,n,o)}finally{bt=s,qt.transition=r}}function zt(e,t,n,o){var s=bt,r=qt.transition;qt.transition=null;try{bt=4,jt(e,t,n,o)}finally{bt=s,qt.transition=r}}function jt(e,t,n,o){if($t){var s=Jt(e,t,n,o);if(null===s)Vo(e,t,o,Qt,n),Nt(e,o);else if(function(e,t,n,o,s){switch(t){case"focusin":return It=Lt(It,e,t,n,o,s),!0;case"dragenter":return Pt=Lt(Pt,e,t,n,o,s),!0;case"mouseover":return Mt=Lt(Mt,e,t,n,o,s),!0;case"pointerover":var r=s.pointerId;return xt.set(r,Lt(xt.get(r)||null,e,t,n,o,s)),!0;case"gotpointercapture":return r=s.pointerId,Rt.set(r,Lt(Rt.get(r)||null,e,t,n,o,s)),!0}return!1}(s,e,t,n,o))o.stopPropagation();else if(Nt(e,o),4&t&&-1<Ot.indexOf(e)){for(;null!==s;){var r=Ss(s);if(null!==r&&wt(r),null===(r=Jt(e,t,n,o))&&Vo(e,t,o,Qt,n),r===s)break;s=r}null!==s&&o.stopPropagation()}else Vo(e,t,o,null,n)}}var Qt=null;function Jt(e,t,n,o){if(Qt=null,null!==(e=bs(e=we(o))))if(null===(t=He(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=qe(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Qt=e,null}function Kt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case ot:return 536870912;default:return 16}default:return 16}}var Yt=null,Xt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Xt,o=n.length,s="value"in Yt?Yt.value:Yt.textContent,r=s.length;for(e=0;e<o&&n[e]===s[e];e++);var i=o-e;for(t=1;t<=i&&n[o-t]===s[r-t];t++);return Zt=s.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function on(){return!1}function sn(e){function t(t,n,o,s,r){for(var i in this._reactName=t,this._targetInst=o,this.type=n,this.nativeEvent=s,this.target=r,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(s):s[i]);return this.isDefaultPrevented=(null!=s.defaultPrevented?s.defaultPrevented:!1===s.returnValue)?nn:on,this.isPropagationStopped=on,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var rn,an,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=sn(cn),dn=F({},cn,{view:0,detail:0}),hn=sn(dn),pn=F({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(rn=e.screenX-ln.screenX,an=e.screenY-ln.screenY):an=rn=0,ln=e),rn)},movementY:function(e){return"movementY"in e?e.movementY:an}}),fn=sn(pn),gn=sn(F({},pn,{dataTransfer:0})),mn=sn(F({},dn,{relatedTarget:0})),yn=sn(F({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=F({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=sn(vn),Sn=sn(F({},cn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Tn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _n(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Cn[e])&&!!t[e]}function kn(){return _n}var En=F({},dn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Tn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),An=sn(En),In=sn(F({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Pn=sn(F({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kn})),Mn=sn(F({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),xn=F({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Rn=sn(xn),Dn=[9,13,27,32],On=u&&"CompositionEvent"in window,Nn=null;u&&"documentMode"in document&&(Nn=document.documentMode);var Ln=u&&"TextEvent"in window&&!Nn,Fn=u&&(!On||Nn&&8<Nn&&11>=Nn),Bn=String.fromCharCode(32),Wn=!1;function Un(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Gn(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Hn=!1,qn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $n(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!qn[e.type]:"textarea"===t}function Vn(e,t,n,o){Ee(o),0<(t=jo(t,"onChange")).length&&(n=new un("onChange","change",null,n,o),e.push({event:n,listeners:t}))}var zn=null,jn=null;function Qn(e){Wo(e,0)}function Jn(e){if(j(ws(e)))return e}function Kn(e,t){if("change"===e)return t}var Yn=!1;if(u){var Xn;if(u){var Zn="oninput"in document;if(!Zn){var eo=document.createElement("div");eo.setAttribute("oninput","return;"),Zn="function"==typeof eo.oninput}Xn=Zn}else Xn=!1;Yn=Xn&&(!document.documentMode||9<document.documentMode)}function to(){zn&&(zn.detachEvent("onpropertychange",no),jn=zn=null)}function no(e){if("value"===e.propertyName&&Jn(jn)){var t=[];Vn(t,jn,e,we(e)),xe(Qn,t)}}function oo(e,t,n){"focusin"===e?(to(),jn=n,(zn=t).attachEvent("onpropertychange",no)):"focusout"===e&&to()}function so(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Jn(jn)}function ro(e,t){if("click"===e)return Jn(t)}function io(e,t){if("input"===e||"change"===e)return Jn(t)}var ao="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function lo(e,t){if(ao(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),o=Object.keys(t);if(n.length!==o.length)return!1;for(o=0;o<n.length;o++){var s=n[o];if(!d.call(t,s)||!ao(e[s],t[s]))return!1}return!0}function co(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function uo(e,t){var n,o=co(e);for(e=0;o;){if(3===o.nodeType){if(n=e+o.textContent.length,e<=t&&n>=t)return{node:o,offset:t-e};e=n}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=co(o)}}function ho(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ho(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function po(){for(var e=window,t=Q();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(e){n=!1}if(!n)break;t=Q((e=t.contentWindow).document)}return t}function fo(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function go(e){var t=po(),n=e.focusedElem,o=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&ho(n.ownerDocument.documentElement,n)){if(null!==o&&fo(n))if(t=o.start,void 0===(e=o.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var s=n.textContent.length,r=Math.min(o.start,s);o=void 0===o.end?r:Math.min(o.end,s),!e.extend&&r>o&&(s=o,o=r,r=s),s=uo(n,r);var i=uo(n,o);s&&i&&(1!==e.rangeCount||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&((t=t.createRange()).setStart(s.node,s.offset),e.removeAllRanges(),r>o?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"==typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mo=u&&"documentMode"in document&&11>=document.documentMode,yo=null,vo=null,bo=null,So=!1;function wo(e,t,n){var o=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;So||null==yo||yo!==Q(o)||(o="selectionStart"in(o=yo)&&fo(o)?{start:o.selectionStart,end:o.selectionEnd}:{anchorNode:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset},bo&&lo(bo,o)||(bo=o,0<(o=jo(vo,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:o}),t.target=yo)))}function To(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Co={animationend:To("Animation","AnimationEnd"),animationiteration:To("Animation","AnimationIteration"),animationstart:To("Animation","AnimationStart"),transitionend:To("Transition","TransitionEnd")},_o={},ko={};function Eo(e){if(_o[e])return _o[e];if(!Co[e])return e;var t,n=Co[e];for(t in n)if(n.hasOwnProperty(t)&&t in ko)return _o[e]=n[t];return e}u&&(ko=document.createElement("div").style,"AnimationEvent"in window||(delete Co.animationend.animation,delete Co.animationiteration.animation,delete Co.animationstart.animation),"TransitionEvent"in window||delete Co.transitionend.transition);var Ao=Eo("animationend"),Io=Eo("animationiteration"),Po=Eo("animationstart"),Mo=Eo("transitionend"),xo=new Map,Ro="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Do(e,t){xo.set(e,t),l(t,[e])}for(var Oo=0;Oo<Ro.length;Oo++){var No=Ro[Oo];Do(No.toLowerCase(),"on"+(No[0].toUpperCase()+No.slice(1)))}Do(Ao,"onAnimationEnd"),Do(Io,"onAnimationIteration"),Do(Po,"onAnimationStart"),Do("dblclick","onDoubleClick"),Do("focusin","onFocus"),Do("focusout","onBlur"),Do(Mo,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fo=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lo));function Bo(e,t,n){var o=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,o,s,i,a,l,c){if(Ge.apply(this,arguments),Le){if(!Le)throw Error(r(198));var u=Fe;Le=!1,Fe=null,Be||(Be=!0,We=u)}}(o,t,void 0,e),e.currentTarget=null}function Wo(e,t){t=!!(4&t);for(var n=0;n<e.length;n++){var o=e[n],s=o.event;o=o.listeners;e:{var r=void 0;if(t)for(var i=o.length-1;0<=i;i--){var a=o[i],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==r&&s.isPropagationStopped())break e;Bo(s,a,c),r=l}else for(i=0;i<o.length;i++){if(l=(a=o[i]).instance,c=a.currentTarget,a=a.listener,l!==r&&s.isPropagationStopped())break e;Bo(s,a,c),r=l}}}if(Be)throw e=We,Be=!1,We=null,e}function Uo(e,t){var n=t[ms];void 0===n&&(n=t[ms]=new Set);var o=e+"__bubble";n.has(o)||($o(t,e,2,!1),n.add(o))}function Go(e,t,n){var o=0;t&&(o|=4),$o(n,e,o,t)}var Ho="_reactListening"+Math.random().toString(36).slice(2);function qo(e){if(!e[Ho]){e[Ho]=!0,i.forEach((function(t){"selectionchange"!==t&&(Fo.has(t)||Go(t,!1,e),Go(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Ho]||(t[Ho]=!0,Go("selectionchange",!1,t))}}function $o(e,t,n,o){switch(Kt(t)){case 1:var s=Vt;break;case 4:s=zt;break;default:s=jt}n=s.bind(null,t,n,e),s=void 0,!De||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(s=!0),o?void 0!==s?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):void 0!==s?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function Vo(e,t,n,o,s){var r=o;if(!(1&t||2&t||null===o))e:for(;;){if(null===o)return;var i=o.tag;if(3===i||4===i){var a=o.stateNode.containerInfo;if(a===s||8===a.nodeType&&a.parentNode===s)break;if(4===i)for(i=o.return;null!==i;){var l=i.tag;if((3===l||4===l)&&((l=i.stateNode.containerInfo)===s||8===l.nodeType&&l.parentNode===s))return;i=i.return}for(;null!==a;){if(null===(i=bs(a)))return;if(5===(l=i.tag)||6===l){o=r=i;continue e}a=a.parentNode}}o=o.return}xe((function(){var o=r,s=we(n),i=[];e:{var a=xo.get(e);if(void 0!==a){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=An;break;case"focusin":c="focus",l=mn;break;case"focusout":c="blur",l=mn;break;case"beforeblur":case"afterblur":l=mn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=gn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Pn;break;case Ao:case Io:case Po:l=yn;break;case Mo:l=Mn;break;case"scroll":l=hn;break;case"wheel":l=Rn;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=In}var u=!!(4&t),d=!u&&"scroll"===e,h=u?null!==a?a+"Capture":null:a;u=[];for(var p,f=o;null!==f;){var g=(p=f).stateNode;if(5===p.tag&&null!==g&&(p=g,null!==h&&null!=(g=Re(f,h))&&u.push(zo(f,g,p))),d)break;f=f.return}0<u.length&&(a=new l(a,c,null,n,s),i.push({event:a,listeners:u}))}}if(!(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===Se||!(c=n.relatedTarget||n.fromElement)||!bs(c)&&!c[gs])&&(l||a)&&(a=s.window===s?s:(a=s.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=o,null!==(c=(c=n.relatedTarget||n.toElement)?bs(c):null)&&(c!==(d=He(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=o),l!==c)){if(u=fn,g="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=In,g="onPointerLeave",h="onPointerEnter",f="pointer"),d=null==l?a:ws(l),p=null==c?a:ws(c),(a=new u(g,f+"leave",l,n,s)).target=d,a.relatedTarget=p,g=null,bs(s)===o&&((u=new u(h,f+"enter",c,n,s)).target=p,u.relatedTarget=d,g=u),d=g,l&&c)e:{for(h=c,f=0,p=u=l;p;p=Qo(p))f++;for(p=0,g=h;g;g=Qo(g))p++;for(;0<f-p;)u=Qo(u),f--;for(;0<p-f;)h=Qo(h),p--;for(;f--;){if(u===h||null!==h&&u===h.alternate)break e;u=Qo(u),h=Qo(h)}u=null}else u=null;null!==l&&Jo(i,a,l,u,!1),null!==c&&null!==d&&Jo(i,d,c,u,!0)}if("select"===(l=(a=o?ws(o):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var m=Kn;else if($n(a))if(Yn)m=io;else{m=so;var y=oo}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(m=ro);switch(m&&(m=m(e,o))?Vn(i,m,n,s):(y&&y(e,a,o),"focusout"===e&&(y=a._wrapperState)&&y.controlled&&"number"===a.type&&ee(a,"number",a.value)),y=o?ws(o):window,e){case"focusin":($n(y)||"true"===y.contentEditable)&&(yo=y,vo=o,bo=null);break;case"focusout":bo=vo=yo=null;break;case"mousedown":So=!0;break;case"contextmenu":case"mouseup":case"dragend":So=!1,wo(i,n,s);break;case"selectionchange":if(mo)break;case"keydown":case"keyup":wo(i,n,s)}var v;if(On)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Hn?Un(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Fn&&"ko"!==n.locale&&(Hn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Hn&&(v=en()):(Xt="value"in(Yt=s)?Yt.value:Yt.textContent,Hn=!0)),0<(y=jo(o,b)).length&&(b=new Sn(b,e,null,n,s),i.push({event:b,listeners:y}),(v||null!==(v=Gn(n)))&&(b.data=v))),(v=Ln?function(e,t){switch(e){case"compositionend":return Gn(t);case"keypress":return 32!==t.which?null:(Wn=!0,Bn);case"textInput":return(e=t.data)===Bn&&Wn?null:e;default:return null}}(e,n):function(e,t){if(Hn)return"compositionend"===e||!On&&Un(e,t)?(e=en(),Zt=Xt=Yt=null,Hn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fn&&"ko"!==t.locale?null:t.data}}(e,n))&&0<(o=jo(o,"onBeforeInput")).length&&(s=new Sn("onBeforeInput","beforeinput",null,n,s),i.push({event:s,listeners:o}),s.data=v)}Wo(i,t)}))}function zo(e,t,n){return{instance:e,listener:t,currentTarget:n}}function jo(e,t){for(var n=t+"Capture",o=[];null!==e;){var s=e,r=s.stateNode;5===s.tag&&null!==r&&(s=r,null!=(r=Re(e,n))&&o.unshift(zo(e,r,s)),null!=(r=Re(e,t))&&o.push(zo(e,r,s))),e=e.return}return o}function Qo(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Jo(e,t,n,o,s){for(var r=t._reactName,i=[];null!==n&&n!==o;){var a=n,l=a.alternate,c=a.stateNode;if(null!==l&&l===o)break;5===a.tag&&null!==c&&(a=c,s?null!=(l=Re(n,r))&&i.unshift(zo(n,l,a)):s||null!=(l=Re(n,r))&&i.push(zo(n,l,a))),n=n.return}0!==i.length&&e.push({event:t,listeners:i})}var Ko=/\r\n?/g,Yo=/\u0000|\uFFFD/g;function Xo(e){return("string"==typeof e?e:""+e).replace(Ko,"\n").replace(Yo,"")}function Zo(e,t,n){if(t=Xo(t),Xo(e)!==t&&n)throw Error(r(425))}function es(){}var ts=null,ns=null;function os(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ss="function"==typeof setTimeout?setTimeout:void 0,rs="function"==typeof clearTimeout?clearTimeout:void 0,is="function"==typeof Promise?Promise:void 0,as="function"==typeof queueMicrotask?queueMicrotask:void 0!==is?function(e){return is.resolve(null).then(e).catch(ls)}:ss;function ls(e){setTimeout((function(){throw e}))}function cs(e,t){var n=t,o=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&8===s.nodeType)if("/$"===(n=s.data)){if(0===o)return e.removeChild(s),void Ht(t);o--}else"$"!==n&&"$?"!==n&&"$!"!==n||o++;n=s}while(n);Ht(t)}function us(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ds(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var hs=Math.random().toString(36).slice(2),ps="__reactFiber$"+hs,fs="__reactProps$"+hs,gs="__reactContainer$"+hs,ms="__reactEvents$"+hs,ys="__reactListeners$"+hs,vs="__reactHandles$"+hs;function bs(e){var t=e[ps];if(t)return t;for(var n=e.parentNode;n;){if(t=n[gs]||n[ps]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ds(e);null!==e;){if(n=e[ps])return n;e=ds(e)}return t}n=(e=n).parentNode}return null}function Ss(e){return!(e=e[ps]||e[gs])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function ws(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(r(33))}function Ts(e){return e[fs]||null}var Cs=[],_s=-1;function ks(e){return{current:e}}function Es(e){0>_s||(e.current=Cs[_s],Cs[_s]=null,_s--)}function As(e,t){_s++,Cs[_s]=e.current,e.current=t}var Is={},Ps=ks(Is),Ms=ks(!1),xs=Is;function Rs(e,t){var n=e.type.contextTypes;if(!n)return Is;var o=e.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===t)return o.__reactInternalMemoizedMaskedChildContext;var s,r={};for(s in n)r[s]=t[s];return o&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=r),r}function Ds(e){return null!=e.childContextTypes}function Os(){Es(Ms),Es(Ps)}function Ns(e,t,n){if(Ps.current!==Is)throw Error(r(168));As(Ps,t),As(Ms,n)}function Ls(e,t,n){var o=e.stateNode;if(t=t.childContextTypes,"function"!=typeof o.getChildContext)return n;for(var s in o=o.getChildContext())if(!(s in t))throw Error(r(108,q(e)||"Unknown",s));return F({},n,o)}function Fs(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Is,xs=Ps.current,As(Ps,e),As(Ms,Ms.current),!0}function Bs(e,t,n){var o=e.stateNode;if(!o)throw Error(r(169));n?(e=Ls(e,t,xs),o.__reactInternalMemoizedMergedChildContext=e,Es(Ms),Es(Ps),As(Ps,e)):Es(Ms),As(Ms,n)}var Ws=null,Us=!1,Gs=!1;function Hs(e){null===Ws?Ws=[e]:Ws.push(e)}function qs(){if(!Gs&&null!==Ws){Gs=!0;var e=0,t=bt;try{var n=Ws;for(bt=1;e<n.length;e++){var o=n[e];do{o=o(!0)}while(null!==o)}Ws=null,Us=!1}catch(t){throw null!==Ws&&(Ws=Ws.slice(e+1)),je(Ze,qs),t}finally{bt=t,Gs=!1}}return null}var $s=[],Vs=0,zs=null,js=0,Qs=[],Js=0,Ks=null,Ys=1,Xs="";function Zs(e,t){$s[Vs++]=js,$s[Vs++]=zs,zs=e,js=t}function er(e,t,n){Qs[Js++]=Ys,Qs[Js++]=Xs,Qs[Js++]=Ks,Ks=e;var o=Ys;e=Xs;var s=32-it(o)-1;o&=~(1<<s),n+=1;var r=32-it(t)+s;if(30<r){var i=s-s%5;r=(o&(1<<i)-1).toString(32),o>>=i,s-=i,Ys=1<<32-it(t)+s|n<<s|o,Xs=r+e}else Ys=1<<r|n<<s|o,Xs=e}function tr(e){null!==e.return&&(Zs(e,1),er(e,1,0))}function nr(e){for(;e===zs;)zs=$s[--Vs],$s[Vs]=null,js=$s[--Vs],$s[Vs]=null;for(;e===Ks;)Ks=Qs[--Js],Qs[Js]=null,Xs=Qs[--Js],Qs[Js]=null,Ys=Qs[--Js],Qs[Js]=null}var or=null,sr=null,rr=!1,ir=null;function ar(e,t){var n=xc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function lr(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,or=e,sr=us(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,or=e,sr=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Ks?{id:Ys,overflow:Xs}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=xc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,or=e,sr=null,!0);default:return!1}}function cr(e){return!(!(1&e.mode)||128&e.flags)}function ur(e){if(rr){var t=sr;if(t){var n=t;if(!lr(e,t)){if(cr(e))throw Error(r(418));t=us(n.nextSibling);var o=or;t&&lr(e,t)?ar(o,n):(e.flags=-4097&e.flags|2,rr=!1,or=e)}}else{if(cr(e))throw Error(r(418));e.flags=-4097&e.flags|2,rr=!1,or=e}}}function dr(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;or=e}function hr(e){if(e!==or)return!1;if(!rr)return dr(e),rr=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!os(e.type,e.memoizedProps)),t&&(t=sr)){if(cr(e))throw pr(),Error(r(418));for(;t;)ar(e,t),t=us(t.nextSibling)}if(dr(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(r(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){sr=us(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}sr=null}}else sr=or?us(e.stateNode.nextSibling):null;return!0}function pr(){for(var e=sr;e;)e=us(e.nextSibling)}function fr(){sr=or=null,rr=!1}function gr(e){null===ir?ir=[e]:ir.push(e)}var mr=S.ReactCurrentBatchConfig;function yr(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(r(309));var o=n.stateNode}if(!o)throw Error(r(147,e));var s=o,i=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=s.refs;null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!=typeof e)throw Error(r(284));if(!n._owner)throw Error(r(290,e))}return e}function vr(e,t){throw e=Object.prototype.toString.call(t),Error(r(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function br(e){return(0,e._init)(e._payload)}function Sr(e){function t(t,n){if(e){var o=t.deletions;null===o?(t.deletions=[n],t.flags|=16):o.push(n)}}function n(n,o){if(!e)return null;for(;null!==o;)t(n,o),o=o.sibling;return null}function o(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function s(e,t){return(e=Dc(e,t)).index=0,e.sibling=null,e}function i(t,n,o){return t.index=o,e?null!==(o=t.alternate)?(o=o.index)<n?(t.flags|=2,n):o:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,o){return null===t||6!==t.tag?((t=Fc(n,e.mode,o)).return=e,t):((t=s(t,n)).return=e,t)}function c(e,t,n,o){var r=n.type;return r===C?d(e,t,n.props.children,o,n.key):null!==t&&(t.elementType===r||"object"==typeof r&&null!==r&&r.$$typeof===R&&br(r)===t.type)?((o=s(t,n.props)).ref=yr(e,t,n),o.return=e,o):((o=Oc(n.type,n.key,n.props,null,e.mode,o)).ref=yr(e,t,n),o.return=e,o)}function u(e,t,n,o){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Bc(n,e.mode,o)).return=e,t):((t=s(t,n.children||[])).return=e,t)}function d(e,t,n,o,r){return null===t||7!==t.tag?((t=Nc(n,e.mode,o,r)).return=e,t):((t=s(t,n)).return=e,t)}function h(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=Fc(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Oc(t.type,t.key,t.props,null,e.mode,n)).ref=yr(e,null,t),n.return=e,n;case T:return(t=Bc(t,e.mode,n)).return=e,t;case R:return h(e,(0,t._init)(t._payload),n)}if(te(t)||N(t))return(t=Nc(t,e.mode,n,null)).return=e,t;vr(e,t)}return null}function p(e,t,n,o){var s=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n)return null!==s?null:l(e,t,""+n,o);if("object"==typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===s?c(e,t,n,o):null;case T:return n.key===s?u(e,t,n,o):null;case R:return p(e,t,(s=n._init)(n._payload),o)}if(te(n)||N(n))return null!==s?null:d(e,t,n,o,null);vr(e,n)}return null}function f(e,t,n,o,s){if("string"==typeof o&&""!==o||"number"==typeof o)return l(t,e=e.get(n)||null,""+o,s);if("object"==typeof o&&null!==o){switch(o.$$typeof){case w:return c(t,e=e.get(null===o.key?n:o.key)||null,o,s);case T:return u(t,e=e.get(null===o.key?n:o.key)||null,o,s);case R:return f(e,t,n,(0,o._init)(o._payload),s)}if(te(o)||N(o))return d(t,e=e.get(n)||null,o,s,null);vr(t,o)}return null}function g(s,r,a,l){for(var c=null,u=null,d=r,g=r=0,m=null;null!==d&&g<a.length;g++){d.index>g?(m=d,d=null):m=d.sibling;var y=p(s,d,a[g],l);if(null===y){null===d&&(d=m);break}e&&d&&null===y.alternate&&t(s,d),r=i(y,r,g),null===u?c=y:u.sibling=y,u=y,d=m}if(g===a.length)return n(s,d),rr&&Zs(s,g),c;if(null===d){for(;g<a.length;g++)null!==(d=h(s,a[g],l))&&(r=i(d,r,g),null===u?c=d:u.sibling=d,u=d);return rr&&Zs(s,g),c}for(d=o(s,d);g<a.length;g++)null!==(m=f(d,s,g,a[g],l))&&(e&&null!==m.alternate&&d.delete(null===m.key?g:m.key),r=i(m,r,g),null===u?c=m:u.sibling=m,u=m);return e&&d.forEach((function(e){return t(s,e)})),rr&&Zs(s,g),c}function m(s,a,l,c){var u=N(l);if("function"!=typeof u)throw Error(r(150));if(null==(l=u.call(l)))throw Error(r(151));for(var d=u=null,g=a,m=a=0,y=null,v=l.next();null!==g&&!v.done;m++,v=l.next()){g.index>m?(y=g,g=null):y=g.sibling;var b=p(s,g,v.value,c);if(null===b){null===g&&(g=y);break}e&&g&&null===b.alternate&&t(s,g),a=i(b,a,m),null===d?u=b:d.sibling=b,d=b,g=y}if(v.done)return n(s,g),rr&&Zs(s,m),u;if(null===g){for(;!v.done;m++,v=l.next())null!==(v=h(s,v.value,c))&&(a=i(v,a,m),null===d?u=v:d.sibling=v,d=v);return rr&&Zs(s,m),u}for(g=o(s,g);!v.done;m++,v=l.next())null!==(v=f(g,s,m,v.value,c))&&(e&&null!==v.alternate&&g.delete(null===v.key?m:v.key),a=i(v,a,m),null===d?u=v:d.sibling=v,d=v);return e&&g.forEach((function(e){return t(s,e)})),rr&&Zs(s,m),u}return function e(o,r,i,l){if("object"==typeof i&&null!==i&&i.type===C&&null===i.key&&(i=i.props.children),"object"==typeof i&&null!==i){switch(i.$$typeof){case w:e:{for(var c=i.key,u=r;null!==u;){if(u.key===c){if((c=i.type)===C){if(7===u.tag){n(o,u.sibling),(r=s(u,i.props.children)).return=o,o=r;break e}}else if(u.elementType===c||"object"==typeof c&&null!==c&&c.$$typeof===R&&br(c)===u.type){n(o,u.sibling),(r=s(u,i.props)).ref=yr(o,u,i),r.return=o,o=r;break e}n(o,u);break}t(o,u),u=u.sibling}i.type===C?((r=Nc(i.props.children,o.mode,l,i.key)).return=o,o=r):((l=Oc(i.type,i.key,i.props,null,o.mode,l)).ref=yr(o,r,i),l.return=o,o=l)}return a(o);case T:e:{for(u=i.key;null!==r;){if(r.key===u){if(4===r.tag&&r.stateNode.containerInfo===i.containerInfo&&r.stateNode.implementation===i.implementation){n(o,r.sibling),(r=s(r,i.children||[])).return=o,o=r;break e}n(o,r);break}t(o,r),r=r.sibling}(r=Bc(i,o.mode,l)).return=o,o=r}return a(o);case R:return e(o,r,(u=i._init)(i._payload),l)}if(te(i))return g(o,r,i,l);if(N(i))return m(o,r,i,l);vr(o,i)}return"string"==typeof i&&""!==i||"number"==typeof i?(i=""+i,null!==r&&6===r.tag?(n(o,r.sibling),(r=s(r,i)).return=o,o=r):(n(o,r),(r=Fc(i,o.mode,l)).return=o,o=r),a(o)):n(o,r)}}var wr=Sr(!0),Tr=Sr(!1),Cr=ks(null),_r=null,kr=null,Er=null;function Ar(){Er=kr=_r=null}function Ir(e){var t=Cr.current;Es(Cr),e._currentValue=t}function Pr(e,t,n){for(;null!==e;){var o=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==o&&(o.childLanes|=t)):null!==o&&(o.childLanes&t)!==t&&(o.childLanes|=t),e===n)break;e=e.return}}function Mr(e,t){_r=e,Er=kr=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(!!(e.lanes&t)&&(ba=!0),e.firstContext=null)}function xr(e){var t=e._currentValue;if(Er!==e)if(e={context:e,memoizedValue:t,next:null},null===kr){if(null===_r)throw Error(r(308));kr=e,_r.dependencies={lanes:0,firstContext:e}}else kr=kr.next=e;return t}var Rr=null;function Dr(e){null===Rr?Rr=[e]:Rr.push(e)}function Or(e,t,n,o){var s=t.interleaved;return null===s?(n.next=n,Dr(t)):(n.next=s.next,s.next=n),t.interleaved=n,Nr(e,o)}function Nr(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Lr=!1;function Fr(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Br(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Wr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ur(e,t,n){var o=e.updateQueue;if(null===o)return null;if(o=o.shared,2&Il){var s=o.pending;return null===s?t.next=t:(t.next=s.next,s.next=t),o.pending=t,Nr(e,n)}return null===(s=o.interleaved)?(t.next=t,Dr(o)):(t.next=s.next,s.next=t),o.interleaved=t,Nr(e,n)}function Gr(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,4194240&n)){var o=t.lanes;n|=o&=e.pendingLanes,t.lanes=n,vt(e,n)}}function Hr(e,t){var n=e.updateQueue,o=e.alternate;if(null!==o&&n===(o=o.updateQueue)){var s=null,r=null;if(null!==(n=n.firstBaseUpdate)){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===r?s=r=i:r=r.next=i,n=n.next}while(null!==n);null===r?s=r=t:r=r.next=t}else s=r=t;return n={baseState:o.baseState,firstBaseUpdate:s,lastBaseUpdate:r,shared:o.shared,effects:o.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function qr(e,t,n,o){var s=e.updateQueue;Lr=!1;var r=s.firstBaseUpdate,i=s.lastBaseUpdate,a=s.shared.pending;if(null!==a){s.shared.pending=null;var l=a,c=l.next;l.next=null,null===i?r=c:i.next=c,i=l;var u=e.alternate;null!==u&&(a=(u=u.updateQueue).lastBaseUpdate)!==i&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l)}if(null!==r){var d=s.baseState;for(i=0,u=c=l=null,a=r;;){var h=a.lane,p=a.eventTime;if((o&h)===h){null!==u&&(u=u.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var f=e,g=a;switch(h=t,p=n,g.tag){case 1:if("function"==typeof(f=g.payload)){d=f.call(p,d,h);break e}d=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null==(h="function"==typeof(f=g.payload)?f.call(p,d,h):f))break e;d=F({},d,h);break e;case 2:Lr=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(h=s.effects)?s.effects=[a]:h.push(a))}else p={eventTime:p,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=p,l=d):u=u.next=p,i|=h;if(null===(a=a.next)){if(null===(a=s.shared.pending))break;a=(h=a).next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}if(null===u&&(l=d),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=u,null!==(t=s.shared.interleaved)){s=t;do{i|=s.lane,s=s.next}while(s!==t)}else null===r&&(s.shared.lanes=0);Ll|=i,e.lanes=i,e.memoizedState=d}}function $r(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var o=e[t],s=o.callback;if(null!==s){if(o.callback=null,o=n,"function"!=typeof s)throw Error(r(191,s));s.call(o)}}}var Vr={},zr=ks(Vr),jr=ks(Vr),Qr=ks(Vr);function Jr(e){if(e===Vr)throw Error(r(174));return e}function Kr(e,t){switch(As(Qr,t),As(jr,e),As(zr,Vr),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Es(zr),As(zr,t)}function Yr(){Es(zr),Es(jr),Es(Qr)}function Xr(e){Jr(Qr.current);var t=Jr(zr.current),n=le(t,e.type);t!==n&&(As(jr,e),As(zr,n))}function Zr(e){jr.current===e&&(Es(zr),Es(jr))}var ei=ks(0);function ti(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(128&t.flags)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ni=[];function oi(){for(var e=0;e<ni.length;e++)ni[e]._workInProgressVersionPrimary=null;ni.length=0}var si=S.ReactCurrentDispatcher,ri=S.ReactCurrentBatchConfig,ii=0,ai=null,li=null,ci=null,ui=!1,di=!1,hi=0,pi=0;function fi(){throw Error(r(321))}function gi(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ao(e[n],t[n]))return!1;return!0}function mi(e,t,n,o,s,i){if(ii=i,ai=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,si.current=null===e||null===e.memoizedState?Zi:ea,e=n(o,s),di){i=0;do{if(di=!1,hi=0,25<=i)throw Error(r(301));i+=1,ci=li=null,t.updateQueue=null,si.current=ta,e=n(o,s)}while(di)}if(si.current=Xi,t=null!==li&&null!==li.next,ii=0,ci=li=ai=null,ui=!1,t)throw Error(r(300));return e}function yi(){var e=0!==hi;return hi=0,e}function vi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ci?ai.memoizedState=ci=e:ci=ci.next=e,ci}function bi(){if(null===li){var e=ai.alternate;e=null!==e?e.memoizedState:null}else e=li.next;var t=null===ci?ai.memoizedState:ci.next;if(null!==t)ci=t,li=e;else{if(null===e)throw Error(r(310));e={memoizedState:(li=e).memoizedState,baseState:li.baseState,baseQueue:li.baseQueue,queue:li.queue,next:null},null===ci?ai.memoizedState=ci=e:ci=ci.next=e}return ci}function Si(e,t){return"function"==typeof t?t(e):t}function wi(e){var t=bi(),n=t.queue;if(null===n)throw Error(r(311));n.lastRenderedReducer=e;var o=li,s=o.baseQueue,i=n.pending;if(null!==i){if(null!==s){var a=s.next;s.next=i.next,i.next=a}o.baseQueue=s=i,n.pending=null}if(null!==s){i=s.next,o=o.baseState;var l=a=null,c=null,u=i;do{var d=u.lane;if((ii&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),o=u.hasEagerState?u.eagerState:e(o,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=h,a=o):c=c.next=h,ai.lanes|=d,Ll|=d}u=u.next}while(null!==u&&u!==i);null===c?a=o:c.next=l,ao(o,t.memoizedState)||(ba=!0),t.memoizedState=o,t.baseState=a,t.baseQueue=c,n.lastRenderedState=o}if(null!==(e=n.interleaved)){s=e;do{i=s.lane,ai.lanes|=i,Ll|=i,s=s.next}while(s!==e)}else null===s&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ti(e){var t=bi(),n=t.queue;if(null===n)throw Error(r(311));n.lastRenderedReducer=e;var o=n.dispatch,s=n.pending,i=t.memoizedState;if(null!==s){n.pending=null;var a=s=s.next;do{i=e(i,a.action),a=a.next}while(a!==s);ao(i,t.memoizedState)||(ba=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,o]}function Ci(){}function _i(e,t){var n=ai,o=bi(),s=t(),i=!ao(o.memoizedState,s);if(i&&(o.memoizedState=s,ba=!0),o=o.queue,Li(Ai.bind(null,n,o,e),[e]),o.getSnapshot!==t||i||null!==ci&&1&ci.memoizedState.tag){if(n.flags|=2048,xi(9,Ei.bind(null,n,o,s,t),void 0,null),null===Pl)throw Error(r(349));30&ii||ki(n,t,s)}return s}function ki(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=ai.updateQueue)?(t={lastEffect:null,stores:null},ai.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ei(e,t,n,o){t.value=n,t.getSnapshot=o,Ii(t)&&Pi(e)}function Ai(e,t,n){return n((function(){Ii(t)&&Pi(e)}))}function Ii(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ao(e,n)}catch(e){return!0}}function Pi(e){var t=Nr(e,1);null!==t&&nc(t,e,1,-1)}function Mi(e){var t=vi();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Si,lastRenderedState:e},t.queue=e,e=e.dispatch=Qi.bind(null,ai,e),[t.memoizedState,e]}function xi(e,t,n,o){return e={tag:e,create:t,destroy:n,deps:o,next:null},null===(t=ai.updateQueue)?(t={lastEffect:null,stores:null},ai.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(o=n.next,n.next=e,e.next=o,t.lastEffect=e),e}function Ri(){return bi().memoizedState}function Di(e,t,n,o){var s=vi();ai.flags|=e,s.memoizedState=xi(1|t,n,void 0,void 0===o?null:o)}function Oi(e,t,n,o){var s=bi();o=void 0===o?null:o;var r=void 0;if(null!==li){var i=li.memoizedState;if(r=i.destroy,null!==o&&gi(o,i.deps))return void(s.memoizedState=xi(t,n,r,o))}ai.flags|=e,s.memoizedState=xi(1|t,n,r,o)}function Ni(e,t){return Di(8390656,8,e,t)}function Li(e,t){return Oi(2048,8,e,t)}function Fi(e,t){return Oi(4,2,e,t)}function Bi(e,t){return Oi(4,4,e,t)}function Wi(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ui(e,t,n){return n=null!=n?n.concat([e]):null,Oi(4,4,Wi.bind(null,t,e),n)}function Gi(){}function Hi(e,t){var n=bi();t=void 0===t?null:t;var o=n.memoizedState;return null!==o&&null!==t&&gi(t,o[1])?o[0]:(n.memoizedState=[e,t],e)}function qi(e,t){var n=bi();t=void 0===t?null:t;var o=n.memoizedState;return null!==o&&null!==t&&gi(t,o[1])?o[0]:(e=e(),n.memoizedState=[e,t],e)}function $i(e,t,n){return 21&ii?(ao(n,t)||(n=gt(),ai.lanes|=n,Ll|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,ba=!0),e.memoizedState=n)}function Vi(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var o=ri.transition;ri.transition={};try{e(!1),t()}finally{bt=n,ri.transition=o}}function zi(){return bi().memoizedState}function ji(e,t,n){var o=tc(e);n={lane:o,action:n,hasEagerState:!1,eagerState:null,next:null},Ji(e)?Ki(t,n):null!==(n=Or(e,t,n,o))&&(nc(n,e,o,ec()),Yi(n,t,o))}function Qi(e,t,n){var o=tc(e),s={lane:o,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ji(e))Ki(t,s);else{var r=e.alternate;if(0===e.lanes&&(null===r||0===r.lanes)&&null!==(r=t.lastRenderedReducer))try{var i=t.lastRenderedState,a=r(i,n);if(s.hasEagerState=!0,s.eagerState=a,ao(a,i)){var l=t.interleaved;return null===l?(s.next=s,Dr(t)):(s.next=l.next,l.next=s),void(t.interleaved=s)}}catch(e){}null!==(n=Or(e,t,s,o))&&(nc(n,e,o,s=ec()),Yi(n,t,o))}}function Ji(e){var t=e.alternate;return e===ai||null!==t&&t===ai}function Ki(e,t){di=ui=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Yi(e,t,n){if(4194240&n){var o=t.lanes;n|=o&=e.pendingLanes,t.lanes=n,vt(e,n)}}var Xi={readContext:xr,useCallback:fi,useContext:fi,useEffect:fi,useImperativeHandle:fi,useInsertionEffect:fi,useLayoutEffect:fi,useMemo:fi,useReducer:fi,useRef:fi,useState:fi,useDebugValue:fi,useDeferredValue:fi,useTransition:fi,useMutableSource:fi,useSyncExternalStore:fi,useId:fi,unstable_isNewReconciler:!1},Zi={readContext:xr,useCallback:function(e,t){return vi().memoizedState=[e,void 0===t?null:t],e},useContext:xr,useEffect:Ni,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,Di(4194308,4,Wi.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Di(4194308,4,e,t)},useInsertionEffect:function(e,t){return Di(4,2,e,t)},useMemo:function(e,t){var n=vi();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var o=vi();return t=void 0!==n?n(t):t,o.memoizedState=o.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},o.queue=e,e=e.dispatch=ji.bind(null,ai,e),[o.memoizedState,e]},useRef:function(e){return e={current:e},vi().memoizedState=e},useState:Mi,useDebugValue:Gi,useDeferredValue:function(e){return vi().memoizedState=e},useTransition:function(){var e=Mi(!1),t=e[0];return e=Vi.bind(null,e[1]),vi().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var o=ai,s=vi();if(rr){if(void 0===n)throw Error(r(407));n=n()}else{if(n=t(),null===Pl)throw Error(r(349));30&ii||ki(o,t,n)}s.memoizedState=n;var i={value:n,getSnapshot:t};return s.queue=i,Ni(Ai.bind(null,o,i,e),[e]),o.flags|=2048,xi(9,Ei.bind(null,o,i,n,t),void 0,null),n},useId:function(){var e=vi(),t=Pl.identifierPrefix;if(rr){var n=Xs;t=":"+t+"R"+(n=(Ys&~(1<<32-it(Ys)-1)).toString(32)+n),0<(n=hi++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=pi++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ea={readContext:xr,useCallback:Hi,useContext:xr,useEffect:Li,useImperativeHandle:Ui,useInsertionEffect:Fi,useLayoutEffect:Bi,useMemo:qi,useReducer:wi,useRef:Ri,useState:function(){return wi(Si)},useDebugValue:Gi,useDeferredValue:function(e){return $i(bi(),li.memoizedState,e)},useTransition:function(){return[wi(Si)[0],bi().memoizedState]},useMutableSource:Ci,useSyncExternalStore:_i,useId:zi,unstable_isNewReconciler:!1},ta={readContext:xr,useCallback:Hi,useContext:xr,useEffect:Li,useImperativeHandle:Ui,useInsertionEffect:Fi,useLayoutEffect:Bi,useMemo:qi,useReducer:Ti,useRef:Ri,useState:function(){return Ti(Si)},useDebugValue:Gi,useDeferredValue:function(e){var t=bi();return null===li?t.memoizedState=e:$i(t,li.memoizedState,e)},useTransition:function(){return[Ti(Si)[0],bi().memoizedState]},useMutableSource:Ci,useSyncExternalStore:_i,useId:zi,unstable_isNewReconciler:!1};function na(e,t){if(e&&e.defaultProps){for(var n in t=F({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function oa(e,t,n,o){n=null==(n=n(o,t=e.memoizedState))?t:F({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var sa={isMounted:function(e){return!!(e=e._reactInternals)&&He(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var o=ec(),s=tc(e),r=Wr(o,s);r.payload=t,null!=n&&(r.callback=n),null!==(t=Ur(e,r,s))&&(nc(t,e,s,o),Gr(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var o=ec(),s=tc(e),r=Wr(o,s);r.tag=1,r.payload=t,null!=n&&(r.callback=n),null!==(t=Ur(e,r,s))&&(nc(t,e,s,o),Gr(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),o=tc(e),s=Wr(n,o);s.tag=2,null!=t&&(s.callback=t),null!==(t=Ur(e,s,o))&&(nc(t,e,o,n),Gr(t,e,o))}};function ra(e,t,n,o,s,r,i){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(o,r,i):!(t.prototype&&t.prototype.isPureReactComponent&&lo(n,o)&&lo(s,r))}function ia(e,t,n){var o=!1,s=Is,r=t.contextType;return"object"==typeof r&&null!==r?r=xr(r):(s=Ds(t)?xs:Ps.current,r=(o=null!=(o=t.contextTypes))?Rs(e,s):Is),t=new t(n,r),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=sa,e.stateNode=t,t._reactInternals=e,o&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=r),t}function aa(e,t,n,o){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,o),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,o),t.state!==e&&sa.enqueueReplaceState(t,t.state,null)}function la(e,t,n,o){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},Fr(e);var r=t.contextType;"object"==typeof r&&null!==r?s.context=xr(r):(r=Ds(t)?xs:Ps.current,s.context=Rs(e,r)),s.state=e.memoizedState,"function"==typeof(r=t.getDerivedStateFromProps)&&(oa(e,t,r,n),s.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof s.getSnapshotBeforeUpdate||"function"!=typeof s.UNSAFE_componentWillMount&&"function"!=typeof s.componentWillMount||(t=s.state,"function"==typeof s.componentWillMount&&s.componentWillMount(),"function"==typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),t!==s.state&&sa.enqueueReplaceState(s,s.state,null),qr(e,n,s,o),s.state=e.memoizedState),"function"==typeof s.componentDidMount&&(e.flags|=4194308)}function ca(e,t){try{var n="",o=t;do{n+=G(o),o=o.return}while(o);var s=n}catch(e){s="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:s,digest:null}}function ua(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function da(e,t){try{console.error(t.value)}catch(e){setTimeout((function(){throw e}))}}var ha="function"==typeof WeakMap?WeakMap:Map;function pa(e,t,n){(n=Wr(-1,n)).tag=3,n.payload={element:null};var o=t.value;return n.callback=function(){$l||($l=!0,Vl=o),da(0,t)},n}function fa(e,t,n){(n=Wr(-1,n)).tag=3;var o=e.type.getDerivedStateFromError;if("function"==typeof o){var s=t.value;n.payload=function(){return o(s)},n.callback=function(){da(0,t)}}var r=e.stateNode;return null!==r&&"function"==typeof r.componentDidCatch&&(n.callback=function(){da(0,t),"function"!=typeof o&&(null===zl?zl=new Set([this]):zl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ga(e,t,n){var o=e.pingCache;if(null===o){o=e.pingCache=new ha;var s=new Set;o.set(t,s)}else void 0===(s=o.get(t))&&(s=new Set,o.set(t,s));s.has(n)||(s.add(n),e=kc.bind(null,e,t,n),t.then(e,e))}function ma(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ya(e,t,n,o,s){return 1&e.mode?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Wr(-1,1)).tag=2,Ur(n,t,1))),n.lanes|=1),e)}var va=S.ReactCurrentOwner,ba=!1;function Sa(e,t,n,o){t.child=null===e?Tr(t,null,n,o):wr(t,e.child,n,o)}function wa(e,t,n,o,s){n=n.render;var r=t.ref;return Mr(t,s),o=mi(e,t,n,o,r,s),n=yi(),null===e||ba?(rr&&n&&tr(t),t.flags|=1,Sa(e,t,o,s),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,$a(e,t,s))}function Ta(e,t,n,o,s){if(null===e){var r=n.type;return"function"!=typeof r||Rc(r)||void 0!==r.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Oc(n.type,null,o,t,t.mode,s)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=r,Ca(e,t,r,o,s))}if(r=e.child,!(e.lanes&s)){var i=r.memoizedProps;if((n=null!==(n=n.compare)?n:lo)(i,o)&&e.ref===t.ref)return $a(e,t,s)}return t.flags|=1,(e=Dc(r,o)).ref=t.ref,e.return=t,t.child=e}function Ca(e,t,n,o,s){if(null!==e){var r=e.memoizedProps;if(lo(r,o)&&e.ref===t.ref){if(ba=!1,t.pendingProps=o=r,!(e.lanes&s))return t.lanes=e.lanes,$a(e,t,s);131072&e.flags&&(ba=!0)}}return Ea(e,t,n,o,s)}function _a(e,t,n){var o=t.pendingProps,s=o.children,r=null!==e?e.memoizedState:null;if("hidden"===o.mode)if(1&t.mode){if(!(1073741824&n))return e=null!==r?r.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,As(Dl,Rl),Rl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},o=null!==r?r.baseLanes:n,As(Dl,Rl),Rl|=o}else t.memoizedState={baseLanes:0,cachePool:null,transitions:null},As(Dl,Rl),Rl|=n;else null!==r?(o=r.baseLanes|n,t.memoizedState=null):o=n,As(Dl,Rl),Rl|=o;return Sa(e,t,s,n),t.child}function ka(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ea(e,t,n,o,s){var r=Ds(n)?xs:Ps.current;return r=Rs(t,r),Mr(t,s),n=mi(e,t,n,o,r,s),o=yi(),null===e||ba?(rr&&o&&tr(t),t.flags|=1,Sa(e,t,n,s),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,$a(e,t,s))}function Aa(e,t,n,o,s){if(Ds(n)){var r=!0;Fs(t)}else r=!1;if(Mr(t,s),null===t.stateNode)qa(e,t),ia(t,n,o),la(t,n,o,s),o=!0;else if(null===e){var i=t.stateNode,a=t.memoizedProps;i.props=a;var l=i.context,c=n.contextType;c="object"==typeof c&&null!==c?xr(c):Rs(t,c=Ds(n)?xs:Ps.current);var u=n.getDerivedStateFromProps,d="function"==typeof u||"function"==typeof i.getSnapshotBeforeUpdate;d||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(a!==o||l!==c)&&aa(t,i,o,c),Lr=!1;var h=t.memoizedState;i.state=h,qr(t,o,i,s),l=t.memoizedState,a!==o||h!==l||Ms.current||Lr?("function"==typeof u&&(oa(t,n,u,o),l=t.memoizedState),(a=Lr||ra(t,n,a,o,h,l,c))?(d||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||("function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"==typeof i.componentDidMount&&(t.flags|=4194308)):("function"==typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=o,t.memoizedState=l),i.props=o,i.state=l,i.context=c,o=a):("function"==typeof i.componentDidMount&&(t.flags|=4194308),o=!1)}else{i=t.stateNode,Br(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:na(t.type,a),i.props=c,d=t.pendingProps,h=i.context,l="object"==typeof(l=n.contextType)&&null!==l?xr(l):Rs(t,l=Ds(n)?xs:Ps.current);var p=n.getDerivedStateFromProps;(u="function"==typeof p||"function"==typeof i.getSnapshotBeforeUpdate)||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(a!==d||h!==l)&&aa(t,i,o,l),Lr=!1,h=t.memoizedState,i.state=h,qr(t,o,i,s);var f=t.memoizedState;a!==d||h!==f||Ms.current||Lr?("function"==typeof p&&(oa(t,n,p,o),f=t.memoizedState),(c=Lr||ra(t,n,c,o,h,f,l)||!1)?(u||"function"!=typeof i.UNSAFE_componentWillUpdate&&"function"!=typeof i.componentWillUpdate||("function"==typeof i.componentWillUpdate&&i.componentWillUpdate(o,f,l),"function"==typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(o,f,l)),"function"==typeof i.componentDidUpdate&&(t.flags|=4),"function"==typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof i.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof i.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=o,t.memoizedState=f),i.props=o,i.state=f,i.context=l,o=c):("function"!=typeof i.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof i.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),o=!1)}return Ia(e,t,n,o,r,s)}function Ia(e,t,n,o,s,r){ka(e,t);var i=!!(128&t.flags);if(!o&&!i)return s&&Bs(t,n,!1),$a(e,t,r);o=t.stateNode,va.current=t;var a=i&&"function"!=typeof n.getDerivedStateFromError?null:o.render();return t.flags|=1,null!==e&&i?(t.child=wr(t,e.child,null,r),t.child=wr(t,null,a,r)):Sa(e,t,a,r),t.memoizedState=o.state,s&&Bs(t,n,!0),t.child}function Pa(e){var t=e.stateNode;t.pendingContext?Ns(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ns(0,t.context,!1),Kr(e,t.containerInfo)}function Ma(e,t,n,o,s){return fr(),gr(s),t.flags|=256,Sa(e,t,n,o),t.child}var xa,Ra,Da,Oa,Na={dehydrated:null,treeContext:null,retryLane:0};function La(e){return{baseLanes:e,cachePool:null,transitions:null}}function Fa(e,t,n){var o,s=t.pendingProps,i=ei.current,a=!1,l=!!(128&t.flags);if((o=l)||(o=(null===e||null!==e.memoizedState)&&!!(2&i)),o?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(i|=1),As(ei,1&i),null===e)return ur(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(1&t.mode?"$!"===e.data?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=s.children,e=s.fallback,a?(s=t.mode,a=t.child,l={mode:"hidden",children:l},1&s||null===a?a=Lc(l,s,0,null):(a.childLanes=0,a.pendingProps=l),e=Nc(e,s,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=La(n),t.memoizedState=Na,e):Ba(t,l));if(null!==(i=e.memoizedState)&&null!==(o=i.dehydrated))return function(e,t,n,o,s,i,a){if(n)return 256&t.flags?(t.flags&=-257,Wa(e,t,a,o=ua(Error(r(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(i=o.fallback,s=t.mode,o=Lc({mode:"visible",children:o.children},s,0,null),(i=Nc(i,s,a,null)).flags|=2,o.return=t,i.return=t,o.sibling=i,t.child=o,1&t.mode&&wr(t,e.child,null,a),t.child.memoizedState=La(a),t.memoizedState=Na,i);if(!(1&t.mode))return Wa(e,t,a,null);if("$!"===s.data){if(o=s.nextSibling&&s.nextSibling.dataset)var l=o.dgst;return o=l,Wa(e,t,a,o=ua(i=Error(r(419)),o,void 0))}if(l=!!(a&e.childLanes),ba||l){if(null!==(o=Pl)){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}0!==(s=s&(o.suspendedLanes|a)?0:s)&&s!==i.retryLane&&(i.retryLane=s,Nr(e,s),nc(o,e,s,-1))}return gc(),Wa(e,t,a,o=ua(Error(r(421))))}return"$?"===s.data?(t.flags|=128,t.child=e.child,t=Ac.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,sr=us(s.nextSibling),or=t,rr=!0,ir=null,null!==e&&(Qs[Js++]=Ys,Qs[Js++]=Xs,Qs[Js++]=Ks,Ys=e.id,Xs=e.overflow,Ks=t),(t=Ba(t,o.children)).flags|=4096,t)}(e,t,l,s,o,i,n);if(a){a=s.fallback,l=t.mode,o=(i=e.child).sibling;var c={mode:"hidden",children:s.children};return 1&l||t.child===i?(s=Dc(i,c)).subtreeFlags=14680064&i.subtreeFlags:((s=t.child).childLanes=0,s.pendingProps=c,t.deletions=null),null!==o?a=Dc(o,a):(a=Nc(a,l,n,null)).flags|=2,a.return=t,s.return=t,s.sibling=a,t.child=s,s=a,a=t.child,l=null===(l=e.child.memoizedState)?La(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~n,t.memoizedState=Na,s}return e=(a=e.child).sibling,s=Dc(a,{mode:"visible",children:s.children}),!(1&t.mode)&&(s.lanes=n),s.return=t,s.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=s,t.memoizedState=null,s}function Ba(e,t){return(t=Lc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Wa(e,t,n,o){return null!==o&&gr(o),wr(t,e.child,null,n),(e=Ba(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ua(e,t,n){e.lanes|=t;var o=e.alternate;null!==o&&(o.lanes|=t),Pr(e.return,t,n)}function Ga(e,t,n,o,s){var r=e.memoizedState;null===r?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:o,tail:n,tailMode:s}:(r.isBackwards=t,r.rendering=null,r.renderingStartTime=0,r.last=o,r.tail=n,r.tailMode=s)}function Ha(e,t,n){var o=t.pendingProps,s=o.revealOrder,r=o.tail;if(Sa(e,t,o.children,n),2&(o=ei.current))o=1&o|2,t.flags|=128;else{if(null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ua(e,n,t);else if(19===e.tag)Ua(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}o&=1}if(As(ei,o),1&t.mode)switch(s){case"forwards":for(n=t.child,s=null;null!==n;)null!==(e=n.alternate)&&null===ti(e)&&(s=n),n=n.sibling;null===(n=s)?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),Ga(t,!1,s,n,r);break;case"backwards":for(n=null,s=t.child,t.child=null;null!==s;){if(null!==(e=s.alternate)&&null===ti(e)){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}Ga(t,!0,n,null,r);break;case"together":Ga(t,!1,null,null,void 0);break;default:t.memoizedState=null}else t.memoizedState=null;return t.child}function qa(e,t){!(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function $a(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ll|=t.lanes,!(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(r(153));if(null!==t.child){for(n=Dc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Dc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Va(e,t){if(!rr)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var o=null;null!==n;)null!==n.alternate&&(o=n),n=n.sibling;null===o?t||null===e.tail?e.tail=null:e.tail.sibling=null:o.sibling=null}}function za(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,o=0;if(t)for(var s=e.child;null!==s;)n|=s.lanes|s.childLanes,o|=14680064&s.subtreeFlags,o|=14680064&s.flags,s.return=e,s=s.sibling;else for(s=e.child;null!==s;)n|=s.lanes|s.childLanes,o|=s.subtreeFlags,o|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=o,e.childLanes=n,t}function ja(e,t,n){var o=t.pendingProps;switch(nr(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return za(t),null;case 1:case 17:return Ds(t.type)&&Os(),za(t),null;case 3:return o=t.stateNode,Yr(),Es(Ms),Es(Ps),oi(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),null!==e&&null!==e.child||(hr(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,null!==ir&&(ic(ir),ir=null))),Ra(e,t),za(t),null;case 5:Zr(t);var s=Jr(Qr.current);if(n=t.type,null!==e&&null!=t.stateNode)Da(e,t,n,o,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!o){if(null===t.stateNode)throw Error(r(166));return za(t),null}if(e=Jr(zr.current),hr(t)){o=t.stateNode,n=t.type;var i=t.memoizedProps;switch(o[ps]=t,o[fs]=i,e=!!(1&t.mode),n){case"dialog":Uo("cancel",o),Uo("close",o);break;case"iframe":case"object":case"embed":Uo("load",o);break;case"video":case"audio":for(s=0;s<Lo.length;s++)Uo(Lo[s],o);break;case"source":Uo("error",o);break;case"img":case"image":case"link":Uo("error",o),Uo("load",o);break;case"details":Uo("toggle",o);break;case"input":K(o,i),Uo("invalid",o);break;case"select":o._wrapperState={wasMultiple:!!i.multiple},Uo("invalid",o);break;case"textarea":se(o,i),Uo("invalid",o)}for(var l in ve(n,i),s=null,i)if(i.hasOwnProperty(l)){var c=i[l];"children"===l?"string"==typeof c?o.textContent!==c&&(!0!==i.suppressHydrationWarning&&Zo(o.textContent,c,e),s=["children",c]):"number"==typeof c&&o.textContent!==""+c&&(!0!==i.suppressHydrationWarning&&Zo(o.textContent,c,e),s=["children",""+c]):a.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Uo("scroll",o)}switch(n){case"input":z(o),Z(o,i,!0);break;case"textarea":z(o),ie(o);break;case"select":case"option":break;default:"function"==typeof i.onClick&&(o.onclick=es)}o=s,t.updateQueue=o,null!==o&&(t.flags|=4)}else{l=9===s.nodeType?s:s.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof o.is?e=l.createElement(n,{is:o.is}):(e=l.createElement(n),"select"===n&&(l=e,o.multiple?l.multiple=!0:o.size&&(l.size=o.size))):e=l.createElementNS(e,n),e[ps]=t,e[fs]=o,xa(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,o),n){case"dialog":Uo("cancel",e),Uo("close",e),s=o;break;case"iframe":case"object":case"embed":Uo("load",e),s=o;break;case"video":case"audio":for(s=0;s<Lo.length;s++)Uo(Lo[s],e);s=o;break;case"source":Uo("error",e),s=o;break;case"img":case"image":case"link":Uo("error",e),Uo("load",e),s=o;break;case"details":Uo("toggle",e),s=o;break;case"input":K(e,o),s=J(e,o),Uo("invalid",e);break;case"option":default:s=o;break;case"select":e._wrapperState={wasMultiple:!!o.multiple},s=F({},o,{value:void 0}),Uo("invalid",e);break;case"textarea":se(e,o),s=oe(e,o),Uo("invalid",e)}for(i in ve(n,s),c=s)if(c.hasOwnProperty(i)){var u=c[i];"style"===i?me(e,u):"dangerouslySetInnerHTML"===i?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===i?"string"==typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"==typeof u&&he(e,""+u):"suppressContentEditableWarning"!==i&&"suppressHydrationWarning"!==i&&"autoFocus"!==i&&(a.hasOwnProperty(i)?null!=u&&"onScroll"===i&&Uo("scroll",e):null!=u&&b(e,i,u,l))}switch(n){case"input":z(e),Z(e,o,!1);break;case"textarea":z(e),ie(e);break;case"option":null!=o.value&&e.setAttribute("value",""+$(o.value));break;case"select":e.multiple=!!o.multiple,null!=(i=o.value)?ne(e,!!o.multiple,i,!1):null!=o.defaultValue&&ne(e,!!o.multiple,o.defaultValue,!0);break;default:"function"==typeof s.onClick&&(e.onclick=es)}switch(n){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break e;case"img":o=!0;break e;default:o=!1}}o&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return za(t),null;case 6:if(e&&null!=t.stateNode)Oa(e,t,e.memoizedProps,o);else{if("string"!=typeof o&&null===t.stateNode)throw Error(r(166));if(n=Jr(Qr.current),Jr(zr.current),hr(t)){if(o=t.stateNode,n=t.memoizedProps,o[ps]=t,(i=o.nodeValue!==n)&&null!==(e=or))switch(e.tag){case 3:Zo(o.nodeValue,n,!!(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Zo(o.nodeValue,n,!!(1&e.mode))}i&&(t.flags|=4)}else(o=(9===n.nodeType?n:n.ownerDocument).createTextNode(o))[ps]=t,t.stateNode=o}return za(t),null;case 13:if(Es(ei),o=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(rr&&null!==sr&&1&t.mode&&!(128&t.flags))pr(),fr(),t.flags|=98560,i=!1;else if(i=hr(t),null!==o&&null!==o.dehydrated){if(null===e){if(!i)throw Error(r(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(r(317));i[ps]=t}else fr(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;za(t),i=!1}else null!==ir&&(ic(ir),ir=null),i=!0;if(!i)return 65536&t.flags?t:null}return 128&t.flags?(t.lanes=n,t):((o=null!==o)!=(null!==e&&null!==e.memoizedState)&&o&&(t.child.flags|=8192,1&t.mode&&(null===e||1&ei.current?0===Ol&&(Ol=3):gc())),null!==t.updateQueue&&(t.flags|=4),za(t),null);case 4:return Yr(),Ra(e,t),null===e&&qo(t.stateNode.containerInfo),za(t),null;case 10:return Ir(t.type._context),za(t),null;case 19:if(Es(ei),null===(i=t.memoizedState))return za(t),null;if(o=!!(128&t.flags),null===(l=i.rendering))if(o)Va(i,!1);else{if(0!==Ol||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(l=ti(e))){for(t.flags|=128,Va(i,!1),null!==(o=l.updateQueue)&&(t.updateQueue=o,t.flags|=4),t.subtreeFlags=0,o=n,n=t.child;null!==n;)e=o,(i=n).flags&=14680066,null===(l=i.alternate)?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return As(ei,1&ei.current|2),t.child}e=e.sibling}null!==i.tail&&Ye()>Hl&&(t.flags|=128,o=!0,Va(i,!1),t.lanes=4194304)}else{if(!o)if(null!==(e=ti(l))){if(t.flags|=128,o=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Va(i,!0),null===i.tail&&"hidden"===i.tailMode&&!l.alternate&&!rr)return za(t),null}else 2*Ye()-i.renderingStartTime>Hl&&1073741824!==n&&(t.flags|=128,o=!0,Va(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=i.last)?n.sibling=l:t.child=l,i.last=l)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Ye(),t.sibling=null,n=ei.current,As(ei,o?1&n|2:1&n),t):(za(t),null);case 22:case 23:return dc(),o=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==o&&(t.flags|=8192),o&&1&t.mode?!!(1073741824&Rl)&&(za(t),6&t.subtreeFlags&&(t.flags|=8192)):za(t),null;case 24:case 25:return null}throw Error(r(156,t.tag))}function Qa(e,t){switch(nr(t),t.tag){case 1:return Ds(t.type)&&Os(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Yr(),Es(Ms),Es(Ps),oi(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Zr(t),null;case 13:if(Es(ei),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(r(340));fr()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Es(ei),null;case 4:return Yr(),null;case 10:return Ir(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}xa=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ra=function(){},Da=function(e,t,n,o){var s=e.memoizedProps;if(s!==o){e=t.stateNode,Jr(zr.current);var r,i=null;switch(n){case"input":s=J(e,s),o=J(e,o),i=[];break;case"select":s=F({},s,{value:void 0}),o=F({},o,{value:void 0}),i=[];break;case"textarea":s=oe(e,s),o=oe(e,o),i=[];break;default:"function"!=typeof s.onClick&&"function"==typeof o.onClick&&(e.onclick=es)}for(u in ve(n,o),n=null,s)if(!o.hasOwnProperty(u)&&s.hasOwnProperty(u)&&null!=s[u])if("style"===u){var l=s[u];for(r in l)l.hasOwnProperty(r)&&(n||(n={}),n[r]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(a.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in o){var c=o[u];if(l=null!=s?s[u]:void 0,o.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(r in l)!l.hasOwnProperty(r)||c&&c.hasOwnProperty(r)||(n||(n={}),n[r]="");for(r in c)c.hasOwnProperty(r)&&l[r]!==c[r]&&(n||(n={}),n[r]=c[r])}else n||(i||(i=[]),i.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(i=i||[]).push(u,c)):"children"===u?"string"!=typeof c&&"number"!=typeof c||(i=i||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(a.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Uo("scroll",e),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(t.updateQueue=u)&&(t.flags|=4)}},Oa=function(e,t,n,o){n!==o&&(t.flags|=4)};var Ja=!1,Ka=!1,Ya="function"==typeof WeakSet?WeakSet:Set,Xa=null;function Za(e,t){var n=e.ref;if(null!==n)if("function"==typeof n)try{n(null)}catch(n){_c(e,t,n)}else n.current=null}function el(e,t,n){try{n()}catch(n){_c(e,t,n)}}var tl=!1;function nl(e,t,n){var o=t.updateQueue;if(null!==(o=null!==o?o.lastEffect:null)){var s=o=o.next;do{if((s.tag&e)===e){var r=s.destroy;s.destroy=void 0,void 0!==r&&el(t,n,r)}s=s.next}while(s!==o)}}function ol(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var o=n.create;n.destroy=o()}n=n.next}while(n!==t)}}function sl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"==typeof t?t(e):t.current=e}}function rl(e){var t=e.alternate;null!==t&&(e.alternate=null,rl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&null!==(t=e.stateNode)&&(delete t[ps],delete t[fs],delete t[ms],delete t[ys],delete t[vs]),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function il(e){return 5===e.tag||3===e.tag||4===e.tag}function al(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||il(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var o=e.tag;if(5===o||6===o)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=es));else if(4!==o&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var o=e.tag;if(5===o||6===o)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==o&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var ul=null,dl=!1;function hl(e,t,n){for(n=n.child;null!==n;)pl(e,t,n),n=n.sibling}function pl(e,t,n){if(rt&&"function"==typeof rt.onCommitFiberUnmount)try{rt.onCommitFiberUnmount(st,n)}catch(e){}switch(n.tag){case 5:Ka||Za(n,t);case 6:var o=ul,s=dl;ul=null,hl(e,t,n),dl=s,null!==(ul=o)&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?cs(e.parentNode,n):1===e.nodeType&&cs(e,n),Ht(e)):cs(ul,n.stateNode));break;case 4:o=ul,s=dl,ul=n.stateNode.containerInfo,dl=!0,hl(e,t,n),ul=o,dl=s;break;case 0:case 11:case 14:case 15:if(!Ka&&null!==(o=n.updateQueue)&&null!==(o=o.lastEffect)){s=o=o.next;do{var r=s,i=r.destroy;r=r.tag,void 0!==i&&(2&r||4&r)&&el(n,t,i),s=s.next}while(s!==o)}hl(e,t,n);break;case 1:if(!Ka&&(Za(n,t),"function"==typeof(o=n.stateNode).componentWillUnmount))try{o.props=n.memoizedProps,o.state=n.memoizedState,o.componentWillUnmount()}catch(e){_c(n,t,e)}hl(e,t,n);break;case 21:hl(e,t,n);break;case 22:1&n.mode?(Ka=(o=Ka)||null!==n.memoizedState,hl(e,t,n),Ka=o):hl(e,t,n);break;default:hl(e,t,n)}}function fl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Ya),t.forEach((function(t){var o=Ic.bind(null,e,t);n.has(t)||(n.add(t),t.then(o,o))}))}}function gl(e,t){var n=t.deletions;if(null!==n)for(var o=0;o<n.length;o++){var s=n[o];try{var i=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,dl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,dl=!0;break e}l=l.return}if(null===ul)throw Error(r(160));pl(i,a,s),ul=null,dl=!1;var c=s.alternate;null!==c&&(c.return=null),s.return=null}catch(e){_c(s,t,e)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)ml(t,e),t=t.sibling}function ml(e,t){var n=e.alternate,o=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gl(t,e),yl(e),4&o){try{nl(3,e,e.return),ol(3,e)}catch(t){_c(e,e.return,t)}try{nl(5,e,e.return)}catch(t){_c(e,e.return,t)}}break;case 1:gl(t,e),yl(e),512&o&&null!==n&&Za(n,n.return);break;case 5:if(gl(t,e),yl(e),512&o&&null!==n&&Za(n,n.return),32&e.flags){var s=e.stateNode;try{he(s,"")}catch(t){_c(e,e.return,t)}}if(4&o&&null!=(s=e.stateNode)){var i=e.memoizedProps,a=null!==n?n.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===i.type&&null!=i.name&&Y(s,i),be(l,a);var u=be(l,i);for(a=0;a<c.length;a+=2){var d=c[a],h=c[a+1];"style"===d?me(s,h):"dangerouslySetInnerHTML"===d?de(s,h):"children"===d?he(s,h):b(s,d,h,u)}switch(l){case"input":X(s,i);break;case"textarea":re(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var f=i.value;null!=f?ne(s,!!i.multiple,f,!1):p!==!!i.multiple&&(null!=i.defaultValue?ne(s,!!i.multiple,i.defaultValue,!0):ne(s,!!i.multiple,i.multiple?[]:"",!1))}s[fs]=i}catch(t){_c(e,e.return,t)}}break;case 6:if(gl(t,e),yl(e),4&o){if(null===e.stateNode)throw Error(r(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(t){_c(e,e.return,t)}}break;case 3:if(gl(t,e),yl(e),4&o&&null!==n&&n.memoizedState.isDehydrated)try{Ht(t.containerInfo)}catch(t){_c(e,e.return,t)}break;case 4:default:gl(t,e),yl(e);break;case 13:gl(t,e),yl(e),8192&(s=e.child).flags&&(i=null!==s.memoizedState,s.stateNode.isHidden=i,!i||null!==s.alternate&&null!==s.alternate.memoizedState||(Gl=Ye())),4&o&&fl(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Ka=(u=Ka)||d,gl(t,e),Ka=u):gl(t,e),yl(e),8192&o){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&1&e.mode)for(Xa=e,d=e.child;null!==d;){for(h=Xa=d;null!==Xa;){switch(f=(p=Xa).child,p.tag){case 0:case 11:case 14:case 15:nl(4,p,p.return);break;case 1:Za(p,p.return);var g=p.stateNode;if("function"==typeof g.componentWillUnmount){o=p,n=p.return;try{t=o,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(e){_c(o,n,e)}}break;case 5:Za(p,p.return);break;case 22:if(null!==p.memoizedState){wl(h);continue}}null!==f?(f.return=p,Xa=f):wl(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{s=h.stateNode,u?"function"==typeof(i=s.style).setProperty?i.setProperty("display","none","important"):i.display="none":(l=h.stateNode,a=null!=(c=h.memoizedProps.style)&&c.hasOwnProperty("display")?c.display:null,l.style.display=ge("display",a))}catch(t){_c(e,e.return,t)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(t){_c(e,e.return,t)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:gl(t,e),yl(e),4&o&&fl(e);case 21:}}function yl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(il(n)){var o=n;break e}n=n.return}throw Error(r(160))}switch(o.tag){case 5:var s=o.stateNode;32&o.flags&&(he(s,""),o.flags&=-33),cl(e,al(e),s);break;case 3:case 4:var i=o.stateNode.containerInfo;ll(e,al(e),i);break;default:throw Error(r(161))}}catch(t){_c(e,e.return,t)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vl(e,t,n){Xa=e,bl(e,t,n)}function bl(e,t,n){for(var o=!!(1&e.mode);null!==Xa;){var s=Xa,r=s.child;if(22===s.tag&&o){var i=null!==s.memoizedState||Ja;if(!i){var a=s.alternate,l=null!==a&&null!==a.memoizedState||Ka;a=Ja;var c=Ka;if(Ja=i,(Ka=l)&&!c)for(Xa=s;null!==Xa;)l=(i=Xa).child,22===i.tag&&null!==i.memoizedState?Tl(s):null!==l?(l.return=i,Xa=l):Tl(s);for(;null!==r;)Xa=r,bl(r,t,n),r=r.sibling;Xa=s,Ja=a,Ka=c}Sl(e)}else 8772&s.subtreeFlags&&null!==r?(r.return=s,Xa=r):Sl(e)}}function Sl(e){for(;null!==Xa;){var t=Xa;if(8772&t.flags){var n=t.alternate;try{if(8772&t.flags)switch(t.tag){case 0:case 11:case 15:Ka||ol(5,t);break;case 1:var o=t.stateNode;if(4&t.flags&&!Ka)if(null===n)o.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:na(t.type,n.memoizedProps);o.componentDidUpdate(s,n.memoizedState,o.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;null!==i&&$r(t,i,o);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}$r(t,a,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Ht(h)}}}break;default:throw Error(r(163))}Ka||512&t.flags&&sl(t)}catch(e){_c(t,t.return,e)}}if(t===e){Xa=null;break}if(null!==(n=t.sibling)){n.return=t.return,Xa=n;break}Xa=t.return}}function wl(e){for(;null!==Xa;){var t=Xa;if(t===e){Xa=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Xa=n;break}Xa=t.return}}function Tl(e){for(;null!==Xa;){var t=Xa;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{ol(4,t)}catch(e){_c(t,n,e)}break;case 1:var o=t.stateNode;if("function"==typeof o.componentDidMount){var s=t.return;try{o.componentDidMount()}catch(e){_c(t,s,e)}}var r=t.return;try{sl(t)}catch(e){_c(t,r,e)}break;case 5:var i=t.return;try{sl(t)}catch(e){_c(t,i,e)}}}catch(e){_c(t,t.return,e)}if(t===e){Xa=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Xa=a;break}Xa=t.return}}var Cl,_l=Math.ceil,kl=S.ReactCurrentDispatcher,El=S.ReactCurrentOwner,Al=S.ReactCurrentBatchConfig,Il=0,Pl=null,Ml=null,xl=0,Rl=0,Dl=ks(0),Ol=0,Nl=null,Ll=0,Fl=0,Bl=0,Wl=null,Ul=null,Gl=0,Hl=1/0,ql=null,$l=!1,Vl=null,zl=null,jl=!1,Ql=null,Jl=0,Kl=0,Yl=null,Xl=-1,Zl=0;function ec(){return 6&Il?Ye():-1!==Xl?Xl:Xl=Ye()}function tc(e){return 1&e.mode?2&Il&&0!==xl?xl&-xl:null!==mr.transition?(0===Zl&&(Zl=gt()),Zl):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Kt(e.type):1}function nc(e,t,n,o){if(50<Kl)throw Kl=0,Yl=null,Error(r(185));yt(e,n,o),2&Il&&e===Pl||(e===Pl&&(!(2&Il)&&(Fl|=n),4===Ol&&ac(e,xl)),oc(e,o),1===n&&0===Il&&!(1&t.mode)&&(Hl=Ye()+500,Us&&qs()))}function oc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,o=e.pingedLanes,s=e.expirationTimes,r=e.pendingLanes;0<r;){var i=31-it(r),a=1<<i,l=s[i];-1===l?a&n&&!(a&o)||(s[i]=pt(a,t)):l<=t&&(e.expiredLanes|=a),r&=~a}}(e,t);var o=ht(e,e===Pl?xl:0);if(0===o)null!==n&&Qe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=o&-o,e.callbackPriority!==t){if(null!=n&&Qe(n),1===t)0===e.tag?function(e){Us=!0,Hs(e)}(lc.bind(null,e)):Hs(lc.bind(null,e)),as((function(){!(6&Il)&&qs()})),n=null;else{switch(St(o)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=ot}n=Pc(n,sc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function sc(e,t){if(Xl=-1,Zl=0,6&Il)throw Error(r(327));var n=e.callbackNode;if(Tc()&&e.callbackNode!==n)return null;var o=ht(e,e===Pl?xl:0);if(0===o)return null;if(30&o||o&e.expiredLanes||t)t=mc(e,o);else{t=o;var s=Il;Il|=2;var i=fc();for(Pl===e&&xl===t||(ql=null,Hl=Ye()+500,hc(e,t));;)try{vc();break}catch(t){pc(e,t)}Ar(),kl.current=i,Il=s,null!==Ml?t=0:(Pl=null,xl=0,t=Ol)}if(0!==t){if(2===t&&0!==(s=ft(e))&&(o=s,t=rc(e,s)),1===t)throw n=Nl,hc(e,0),ac(e,o),oc(e,Ye()),n;if(6===t)ac(e,o);else{if(s=e.current.alternate,!(30&o||function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var o=0;o<n.length;o++){var s=n[o],r=s.getSnapshot;s=s.value;try{if(!ao(r(),s))return!1}catch(e){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(s)||(t=mc(e,o),2===t&&(i=ft(e),0!==i&&(o=i,t=rc(e,i))),1!==t)))throw n=Nl,hc(e,0),ac(e,o),oc(e,Ye()),n;switch(e.finishedWork=s,e.finishedLanes=o,t){case 0:case 1:throw Error(r(345));case 2:case 5:wc(e,Ul,ql);break;case 3:if(ac(e,o),(130023424&o)===o&&10<(t=Gl+500-Ye())){if(0!==ht(e,0))break;if(((s=e.suspendedLanes)&o)!==o){ec(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=ss(wc.bind(null,e,Ul,ql),t);break}wc(e,Ul,ql);break;case 4:if(ac(e,o),(4194240&o)===o)break;for(t=e.eventTimes,s=-1;0<o;){var a=31-it(o);i=1<<a,(a=t[a])>s&&(s=a),o&=~i}if(o=s,10<(o=(120>(o=Ye()-o)?120:480>o?480:1080>o?1080:1920>o?1920:3e3>o?3e3:4320>o?4320:1960*_l(o/1960))-o)){e.timeoutHandle=ss(wc.bind(null,e,Ul,ql),o);break}wc(e,Ul,ql);break;default:throw Error(r(329))}}}return oc(e,Ye()),e.callbackNode===n?sc.bind(null,e):null}function rc(e,t){var n=Wl;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=mc(e,t))&&(t=Ul,Ul=n,null!==t&&ic(t)),e}function ic(e){null===Ul?Ul=e:Ul.push.apply(Ul,e)}function ac(e,t){for(t&=~Bl,t&=~Fl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-it(t),o=1<<n;e[n]=-1,t&=~o}}function lc(e){if(6&Il)throw Error(r(327));Tc();var t=ht(e,0);if(!(1&t))return oc(e,Ye()),null;var n=mc(e,t);if(0!==e.tag&&2===n){var o=ft(e);0!==o&&(t=o,n=rc(e,o))}if(1===n)throw n=Nl,hc(e,0),ac(e,t),oc(e,Ye()),n;if(6===n)throw Error(r(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,Ul,ql),oc(e,Ye()),null}function cc(e,t){var n=Il;Il|=1;try{return e(t)}finally{0===(Il=n)&&(Hl=Ye()+500,Us&&qs())}}function uc(e){null!==Ql&&0===Ql.tag&&!(6&Il)&&Tc();var t=Il;Il|=1;var n=Al.transition,o=bt;try{if(Al.transition=null,bt=1,e)return e()}finally{bt=o,Al.transition=n,!(6&(Il=t))&&qs()}}function dc(){Rl=Dl.current,Es(Dl)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,rs(n)),null!==Ml)for(n=Ml.return;null!==n;){var o=n;switch(nr(o),o.tag){case 1:null!=(o=o.type.childContextTypes)&&Os();break;case 3:Yr(),Es(Ms),Es(Ps),oi();break;case 5:Zr(o);break;case 4:Yr();break;case 13:case 19:Es(ei);break;case 10:Ir(o.type._context);break;case 22:case 23:dc()}n=n.return}if(Pl=e,Ml=e=Dc(e.current,null),xl=Rl=t,Ol=0,Nl=null,Bl=Fl=Ll=0,Ul=Wl=null,null!==Rr){for(t=0;t<Rr.length;t++)if(null!==(o=(n=Rr[t]).interleaved)){n.interleaved=null;var s=o.next,r=n.pending;if(null!==r){var i=r.next;r.next=s,o.next=i}n.pending=o}Rr=null}return e}function pc(e,t){for(;;){var n=Ml;try{if(Ar(),si.current=Xi,ui){for(var o=ai.memoizedState;null!==o;){var s=o.queue;null!==s&&(s.pending=null),o=o.next}ui=!1}if(ii=0,ci=li=ai=null,di=!1,hi=0,El.current=null,null===n||null===n.return){Ol=1,Nl=t,Ml=null;break}e:{var i=e,a=n.return,l=n,c=t;if(t=xl,l.flags|=32768,null!==c&&"object"==typeof c&&"function"==typeof c.then){var u=c,d=l,h=d.tag;if(!(1&d.mode||0!==h&&11!==h&&15!==h)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=ma(a);if(null!==f){f.flags&=-257,ya(f,a,l,0,t),1&f.mode&&ga(i,u,t),c=u;var g=(t=f).updateQueue;if(null===g){var m=new Set;m.add(c),t.updateQueue=m}else g.add(c);break e}if(!(1&t)){ga(i,u,t),gc();break e}c=Error(r(426))}else if(rr&&1&l.mode){var y=ma(a);if(null!==y){!(65536&y.flags)&&(y.flags|=256),ya(y,a,l,0,t),gr(ca(c,l));break e}}i=c=ca(c,l),4!==Ol&&(Ol=2),null===Wl?Wl=[i]:Wl.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t,Hr(i,pa(0,c,t));break e;case 1:l=c;var v=i.type,b=i.stateNode;if(!(128&i.flags||"function"!=typeof v.getDerivedStateFromError&&(null===b||"function"!=typeof b.componentDidCatch||null!==zl&&zl.has(b)))){i.flags|=65536,t&=-t,i.lanes|=t,Hr(i,fa(i,l,t));break e}}i=i.return}while(null!==i)}Sc(n)}catch(e){t=e,Ml===n&&null!==n&&(Ml=n=n.return);continue}break}}function fc(){var e=kl.current;return kl.current=Xi,null===e?Xi:e}function gc(){0!==Ol&&3!==Ol&&2!==Ol||(Ol=4),null===Pl||!(268435455&Ll)&&!(268435455&Fl)||ac(Pl,xl)}function mc(e,t){var n=Il;Il|=2;var o=fc();for(Pl===e&&xl===t||(ql=null,hc(e,t));;)try{yc();break}catch(t){pc(e,t)}if(Ar(),Il=n,kl.current=o,null!==Ml)throw Error(r(261));return Pl=null,xl=0,Ol}function yc(){for(;null!==Ml;)bc(Ml)}function vc(){for(;null!==Ml&&!Je();)bc(Ml)}function bc(e){var t=Cl(e.alternate,e,Rl);e.memoizedProps=e.pendingProps,null===t?Sc(e):Ml=t,El.current=null}function Sc(e){var t=e;do{var n=t.alternate;if(e=t.return,32768&t.flags){if(null!==(n=Qa(n,t)))return n.flags&=32767,void(Ml=n);if(null===e)return Ol=6,void(Ml=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}else if(null!==(n=ja(n,t,Rl)))return void(Ml=n);if(null!==(t=t.sibling))return void(Ml=t);Ml=t=e}while(null!==t);0===Ol&&(Ol=5)}function wc(e,t,n){var o=bt,s=Al.transition;try{Al.transition=null,bt=1,function(e,t,n,o){do{Tc()}while(null!==Ql);if(6&Il)throw Error(r(327));n=e.finishedWork;var s=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(r(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var o=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-it(n),r=1<<s;t[s]=0,o[s]=-1,e[s]=-1,n&=~r}}(e,i),e===Pl&&(Ml=Pl=null,xl=0),!(2064&n.subtreeFlags)&&!(2064&n.flags)||jl||(jl=!0,Pc(tt,(function(){return Tc(),null}))),i=!!(15990&n.flags),15990&n.subtreeFlags||i){i=Al.transition,Al.transition=null;var a=bt;bt=1;var l=Il;Il|=4,El.current=null,function(e,t){if(ts=$t,fo(e=po())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var o=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(o&&0!==o.rangeCount){n=o.anchorNode;var s=o.anchorOffset,i=o.focusNode;o=o.focusOffset;try{n.nodeType,i.nodeType}catch(e){n=null;break e}var a=0,l=-1,c=-1,u=0,d=0,h=e,p=null;t:for(;;){for(var f;h!==n||0!==s&&3!==h.nodeType||(l=a+s),h!==i||0!==o&&3!==h.nodeType||(c=a+o),3===h.nodeType&&(a+=h.nodeValue.length),null!==(f=h.firstChild);)p=h,h=f;for(;;){if(h===e)break t;if(p===n&&++u===s&&(l=a),p===i&&++d===o&&(c=a),null!==(f=h.nextSibling))break;p=(h=p).parentNode}h=f}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ns={focusedElem:e,selectionRange:n},$t=!1,Xa=t;null!==Xa;)if(e=(t=Xa).child,1028&t.subtreeFlags&&null!==e)e.return=t,Xa=e;else for(;null!==Xa;){t=Xa;try{var g=t.alternate;if(1024&t.flags)switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var m=g.memoizedProps,y=g.memoizedState,v=t.stateNode,b=v.getSnapshotBeforeUpdate(t.elementType===t.type?m:na(t.type,m),y);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var S=t.stateNode.containerInfo;1===S.nodeType?S.textContent="":9===S.nodeType&&S.documentElement&&S.removeChild(S.documentElement);break;default:throw Error(r(163))}}catch(e){_c(t,t.return,e)}if(null!==(e=t.sibling)){e.return=t.return,Xa=e;break}Xa=t.return}g=tl,tl=!1}(e,n),ml(n,e),go(ns),$t=!!ts,ns=ts=null,e.current=n,vl(n,e,s),Ke(),Il=l,bt=a,Al.transition=i}else e.current=n;if(jl&&(jl=!1,Ql=e,Jl=s),0===(i=e.pendingLanes)&&(zl=null),function(e){if(rt&&"function"==typeof rt.onCommitFiberRoot)try{rt.onCommitFiberRoot(st,e,void 0,!(128&~e.current.flags))}catch(e){}}(n.stateNode),oc(e,Ye()),null!==t)for(o=e.onRecoverableError,n=0;n<t.length;n++)o((s=t[n]).value,{componentStack:s.stack,digest:s.digest});if($l)throw $l=!1,e=Vl,Vl=null,e;!!(1&Jl)&&0!==e.tag&&Tc(),1&(i=e.pendingLanes)?e===Yl?Kl++:(Kl=0,Yl=e):Kl=0,qs()}(e,t,n,o)}finally{Al.transition=s,bt=o}return null}function Tc(){if(null!==Ql){var e=St(Jl),t=Al.transition,n=bt;try{if(Al.transition=null,bt=16>e?16:e,null===Ql)var o=!1;else{if(e=Ql,Ql=null,Jl=0,6&Il)throw Error(r(331));var s=Il;for(Il|=4,Xa=e.current;null!==Xa;){var i=Xa,a=i.child;if(16&Xa.flags){var l=i.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Xa=u;null!==Xa;){var d=Xa;switch(d.tag){case 0:case 11:case 15:nl(8,d,i)}var h=d.child;if(null!==h)h.return=d,Xa=h;else for(;null!==Xa;){var p=(d=Xa).sibling,f=d.return;if(rl(d),d===u){Xa=null;break}if(null!==p){p.return=f,Xa=p;break}Xa=f}}}var g=i.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var y=m.sibling;m.sibling=null,m=y}while(null!==m)}}Xa=i}}if(2064&i.subtreeFlags&&null!==a)a.return=i,Xa=a;else e:for(;null!==Xa;){if(2048&(i=Xa).flags)switch(i.tag){case 0:case 11:case 15:nl(9,i,i.return)}var v=i.sibling;if(null!==v){v.return=i.return,Xa=v;break e}Xa=i.return}}var b=e.current;for(Xa=b;null!==Xa;){var S=(a=Xa).child;if(2064&a.subtreeFlags&&null!==S)S.return=a,Xa=S;else e:for(a=b;null!==Xa;){if(2048&(l=Xa).flags)try{switch(l.tag){case 0:case 11:case 15:ol(9,l)}}catch(e){_c(l,l.return,e)}if(l===a){Xa=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Xa=w;break e}Xa=l.return}}if(Il=s,qs(),rt&&"function"==typeof rt.onPostCommitFiberRoot)try{rt.onPostCommitFiberRoot(st,e)}catch(e){}o=!0}return o}finally{bt=n,Al.transition=t}}return!1}function Cc(e,t,n){e=Ur(e,t=pa(0,t=ca(n,t),1),1),t=ec(),null!==e&&(yt(e,1,t),oc(e,t))}function _c(e,t,n){if(3===e.tag)Cc(e,e,n);else for(;null!==t;){if(3===t.tag){Cc(t,e,n);break}if(1===t.tag){var o=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof o.componentDidCatch&&(null===zl||!zl.has(o))){t=Ur(t,e=fa(t,e=ca(n,e),1),1),e=ec(),null!==t&&(yt(t,1,e),oc(t,e));break}}t=t.return}}function kc(e,t,n){var o=e.pingCache;null!==o&&o.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Pl===e&&(xl&n)===n&&(4===Ol||3===Ol&&(130023424&xl)===xl&&500>Ye()-Gl?hc(e,0):Bl|=n),oc(e,t)}function Ec(e,t){0===t&&(1&e.mode?(t=ut,!(130023424&(ut<<=1))&&(ut=4194304)):t=1);var n=ec();null!==(e=Nr(e,t))&&(yt(e,t,n),oc(e,n))}function Ac(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ec(e,n)}function Ic(e,t){var n=0;switch(e.tag){case 13:var o=e.stateNode,s=e.memoizedState;null!==s&&(n=s.retryLane);break;case 19:o=e.stateNode;break;default:throw Error(r(314))}null!==o&&o.delete(t),Ec(e,n)}function Pc(e,t){return je(e,t)}function Mc(e,t,n,o){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xc(e,t,n,o){return new Mc(e,t,n,o)}function Rc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Dc(e,t){var n=e.alternate;return null===n?((n=xc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Oc(e,t,n,o,s,i){var a=2;if(o=e,"function"==typeof e)Rc(e)&&(a=1);else if("string"==typeof e)a=5;else e:switch(e){case C:return Nc(n.children,s,i,t);case _:a=8,s|=8;break;case k:return(e=xc(12,n,t,2|s)).elementType=k,e.lanes=i,e;case P:return(e=xc(13,n,t,s)).elementType=P,e.lanes=i,e;case M:return(e=xc(19,n,t,s)).elementType=M,e.lanes=i,e;case D:return Lc(n,s,i,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case E:a=10;break e;case A:a=9;break e;case I:a=11;break e;case x:a=14;break e;case R:a=16,o=null;break e}throw Error(r(130,null==e?e:typeof e,""))}return(t=xc(a,n,t,s)).elementType=e,t.type=o,t.lanes=i,t}function Nc(e,t,n,o){return(e=xc(7,e,o,t)).lanes=n,e}function Lc(e,t,n,o){return(e=xc(22,e,o,t)).elementType=D,e.lanes=n,e.stateNode={isHidden:!1},e}function Fc(e,t,n){return(e=xc(6,e,null,t)).lanes=n,e}function Bc(e,t,n){return(t=xc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Wc(e,t,n,o,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=o,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Uc(e,t,n,o,s,r,i,a,l){return e=new Wc(e,t,n,a,l),1===t?(t=1,!0===r&&(t|=8)):t=0,r=xc(3,null,null,t),e.current=r,r.stateNode=e,r.memoizedState={element:o,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fr(r),e}function Gc(e){if(!e)return Is;e:{if(He(e=e._reactInternals)!==e||1!==e.tag)throw Error(r(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ds(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(r(171))}if(1===e.tag){var n=e.type;if(Ds(n))return Ls(e,n,t)}return t}function Hc(e,t,n,o,s,r,i,a,l){return(e=Uc(n,o,!0,e,0,r,0,a,l)).context=Gc(null),n=e.current,(r=Wr(o=ec(),s=tc(n))).callback=null!=t?t:null,Ur(n,r,s),e.current.lanes=s,yt(e,s,o),oc(e,o),e}function qc(e,t,n,o){var s=t.current,r=ec(),i=tc(s);return n=Gc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Wr(r,i)).payload={element:e},null!==(o=void 0===o?null:o)&&(t.callback=o),null!==(e=Ur(s,t,i))&&(nc(e,s,i,r),Gr(e,s,i)),i}function $c(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Vc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function zc(e,t){Vc(e,t),(e=e.alternate)&&Vc(e,t)}Cl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ms.current)ba=!0;else{if(!(e.lanes&n||128&t.flags))return ba=!1,function(e,t,n){switch(t.tag){case 3:Pa(t),fr();break;case 5:Xr(t);break;case 1:Ds(t.type)&&Fs(t);break;case 4:Kr(t,t.stateNode.containerInfo);break;case 10:var o=t.type._context,s=t.memoizedProps.value;As(Cr,o._currentValue),o._currentValue=s;break;case 13:if(null!==(o=t.memoizedState))return null!==o.dehydrated?(As(ei,1&ei.current),t.flags|=128,null):n&t.child.childLanes?Fa(e,t,n):(As(ei,1&ei.current),null!==(e=$a(e,t,n))?e.sibling:null);As(ei,1&ei.current);break;case 19:if(o=!!(n&t.childLanes),128&e.flags){if(o)return Ha(e,t,n);t.flags|=128}if(null!==(s=t.memoizedState)&&(s.rendering=null,s.tail=null,s.lastEffect=null),As(ei,ei.current),o)break;return null;case 22:case 23:return t.lanes=0,_a(e,t,n)}return $a(e,t,n)}(e,t,n);ba=!!(131072&e.flags)}else ba=!1,rr&&1048576&t.flags&&er(t,js,t.index);switch(t.lanes=0,t.tag){case 2:var o=t.type;qa(e,t),e=t.pendingProps;var s=Rs(t,Ps.current);Mr(t,n),s=mi(null,t,o,e,s,n);var i=yi();return t.flags|=1,"object"==typeof s&&null!==s&&"function"==typeof s.render&&void 0===s.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ds(o)?(i=!0,Fs(t)):i=!1,t.memoizedState=null!==s.state&&void 0!==s.state?s.state:null,Fr(t),s.updater=sa,t.stateNode=s,s._reactInternals=t,la(t,o,e,n),t=Ia(null,t,o,!0,i,n)):(t.tag=0,rr&&i&&tr(t),Sa(null,t,s,n),t=t.child),t;case 16:o=t.elementType;e:{switch(qa(e,t),e=t.pendingProps,o=(s=o._init)(o._payload),t.type=o,s=t.tag=function(e){if("function"==typeof e)return Rc(e)?1:0;if(null!=e){if((e=e.$$typeof)===I)return 11;if(e===x)return 14}return 2}(o),e=na(o,e),s){case 0:t=Ea(null,t,o,e,n);break e;case 1:t=Aa(null,t,o,e,n);break e;case 11:t=wa(null,t,o,e,n);break e;case 14:t=Ta(null,t,o,na(o.type,e),n);break e}throw Error(r(306,o,""))}return t;case 0:return o=t.type,s=t.pendingProps,Ea(e,t,o,s=t.elementType===o?s:na(o,s),n);case 1:return o=t.type,s=t.pendingProps,Aa(e,t,o,s=t.elementType===o?s:na(o,s),n);case 3:e:{if(Pa(t),null===e)throw Error(r(387));o=t.pendingProps,s=(i=t.memoizedState).element,Br(e,t),qr(t,o,null,n);var a=t.memoizedState;if(o=a.element,i.isDehydrated){if(i={element:o,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=Ma(e,t,o,n,s=ca(Error(r(423)),t));break e}if(o!==s){t=Ma(e,t,o,n,s=ca(Error(r(424)),t));break e}for(sr=us(t.stateNode.containerInfo.firstChild),or=t,rr=!0,ir=null,n=Tr(t,null,o,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fr(),o===s){t=$a(e,t,n);break e}Sa(e,t,o,n)}t=t.child}return t;case 5:return Xr(t),null===e&&ur(t),o=t.type,s=t.pendingProps,i=null!==e?e.memoizedProps:null,a=s.children,os(o,s)?a=null:null!==i&&os(o,i)&&(t.flags|=32),ka(e,t),Sa(e,t,a,n),t.child;case 6:return null===e&&ur(t),null;case 13:return Fa(e,t,n);case 4:return Kr(t,t.stateNode.containerInfo),o=t.pendingProps,null===e?t.child=wr(t,null,o,n):Sa(e,t,o,n),t.child;case 11:return o=t.type,s=t.pendingProps,wa(e,t,o,s=t.elementType===o?s:na(o,s),n);case 7:return Sa(e,t,t.pendingProps,n),t.child;case 8:case 12:return Sa(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(o=t.type._context,s=t.pendingProps,i=t.memoizedProps,a=s.value,As(Cr,o._currentValue),o._currentValue=a,null!==i)if(ao(i.value,a)){if(i.children===s.children&&!Ms.current){t=$a(e,t,n);break e}}else for(null!==(i=t.child)&&(i.return=t);null!==i;){var l=i.dependencies;if(null!==l){a=i.child;for(var c=l.firstContext;null!==c;){if(c.context===o){if(1===i.tag){(c=Wr(-1,n&-n)).tag=2;var u=i.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=n,null!==(c=i.alternate)&&(c.lanes|=n),Pr(i.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===i.tag)a=i.type===t.type?null:i.child;else if(18===i.tag){if(null===(a=i.return))throw Error(r(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),Pr(a,n,t),a=i.sibling}else a=i.child;if(null!==a)a.return=i;else for(a=i;null!==a;){if(a===t){a=null;break}if(null!==(i=a.sibling)){i.return=a.return,a=i;break}a=a.return}i=a}Sa(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,o=t.pendingProps.children,Mr(t,n),o=o(s=xr(s)),t.flags|=1,Sa(e,t,o,n),t.child;case 14:return s=na(o=t.type,t.pendingProps),Ta(e,t,o,s=na(o.type,s),n);case 15:return Ca(e,t,t.type,t.pendingProps,n);case 17:return o=t.type,s=t.pendingProps,s=t.elementType===o?s:na(o,s),qa(e,t),t.tag=1,Ds(o)?(e=!0,Fs(t)):e=!1,Mr(t,n),ia(t,o,s),la(t,o,s,n),Ia(null,t,o,!0,e,n);case 19:return Ha(e,t,n);case 22:return _a(e,t,n)}throw Error(r(156,t.tag))};var jc="function"==typeof reportError?reportError:function(e){console.error(e)};function Qc(e){this._internalRoot=e}function Jc(e){this._internalRoot=e}function Kc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Xc(){}function Zc(e,t,n,o,s){var r=n._reactRootContainer;if(r){var i=r;if("function"==typeof s){var a=s;s=function(){var e=$c(i);a.call(e)}}qc(t,i,e,s)}else i=function(e,t,n,o,s){if(s){if("function"==typeof o){var r=o;o=function(){var e=$c(i);r.call(e)}}var i=Hc(t,o,e,0,null,!1,0,"",Xc);return e._reactRootContainer=i,e[gs]=i.current,qo(8===e.nodeType?e.parentNode:e),uc(),i}for(;s=e.lastChild;)e.removeChild(s);if("function"==typeof o){var a=o;o=function(){var e=$c(l);a.call(e)}}var l=Uc(e,0,!1,null,0,!1,0,"",Xc);return e._reactRootContainer=l,e[gs]=l.current,qo(8===e.nodeType?e.parentNode:e),uc((function(){qc(t,l,n,o)})),l}(n,t,e,s,o);return $c(i)}Jc.prototype.render=Qc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(r(409));qc(e,t,null,null)},Jc.prototype.unmount=Qc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc((function(){qc(null,e,null,null)})),t[gs]=null}},Jc.prototype.unstable_scheduleHydration=function(e){if(e){var t=_t();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dt.length&&0!==t&&t<Dt[n].priority;n++);Dt.splice(n,0,e),0===n&&Ft(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(vt(t,1|n),oc(t,Ye()),!(6&Il)&&(Hl=Ye()+500,qs()))}break;case 13:uc((function(){var t=Nr(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}})),zc(e,1)}},Tt=function(e){if(13===e.tag){var t=Nr(e,134217728);null!==t&&nc(t,e,134217728,ec()),zc(e,134217728)}},Ct=function(e){if(13===e.tag){var t=tc(e),n=Nr(e,t);null!==n&&nc(n,e,t,ec()),zc(e,t)}},_t=function(){return bt},kt=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},Te=function(e,t,n){switch(t){case"input":if(X(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var o=n[t];if(o!==e&&o.form===e.form){var s=Ts(o);if(!s)throw Error(r(90));j(o),X(o,s)}}}break;case"textarea":re(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ie=cc,Pe=uc;var eu={usingClientEntryPoint:!1,Events:[Ss,ws,Ts,Ee,Ae,cc]},tu={findFiberByHostInstance:bs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:S.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ve(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ou=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ou.isDisabled&&ou.supportsFiber)try{st=ou.inject(nu),rt=ou}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Kc(t))throw Error(r(200));return function(e,t,n){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:T,key:null==o?null:""+o,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Kc(e))throw Error(r(299));var n=!1,o="",s=jc;return null!=t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(o=t.identifierPrefix),void 0!==t.onRecoverableError&&(s=t.onRecoverableError)),t=Uc(e,1,!1,null,0,n,0,o,s),e[gs]=t.current,qo(8===e.nodeType?e.parentNode:e),new Qc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(r(188));throw e=Object.keys(e).join(","),Error(r(268,e))}return null===(e=Ve(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Yc(t))throw Error(r(200));return Zc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Kc(e))throw Error(r(405));var o=null!=n&&n.hydratedSources||null,s=!1,i="",a=jc;if(null!=n&&(!0===n.unstable_strictMode&&(s=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=Hc(t,null,e,1,null!=n?n:null,s,0,i,a),e[gs]=t.current,qo(e),o)for(e=0;e<o.length;e++)s=(s=(n=o[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new Jc(t)},t.render=function(e,t,n){if(!Yc(t))throw Error(r(200));return Zc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Yc(e))throw Error(r(40));return!!e._reactRootContainer&&(uc((function(){Zc(null,null,e,!1,(function(){e._reactRootContainer=null,e[gs]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,o){if(!Yc(n))throw Error(r(200));if(null==e||void 0===e._reactInternals)throw Error(r(38));return Zc(e,t,n,!1,o)},t.version="18.3.1-next-f1338f8080-20240426"},95491:(e,t,n)=>{"use strict";!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}(),e.exports=n(77669)},85017:(e,t,n)=>{"use strict";var o,s=(o=n(30538))&&"object"==typeof o&&"default"in o?o.default:o;function r(e){return r.warnAboutHMRDisabled&&(r.warnAboutHMRDisabled=!0,console.error("React-Hot-Loader: misconfiguration detected, using production version in non-production environment."),console.error("React-Hot-Loader: Hot Module Replacement is not enabled.")),s.Children.only(e.children)}r.warnAboutHMRDisabled=!1},1876:(e,t,n)=>{"use strict";n(85017)},65860:(e,t)=>{"use strict";var n,o=Symbol.for("react.element"),s=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),c=Symbol.for("react.context"),u=Symbol.for("react.server_context"),d=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),p=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),m=Symbol.for("react.offscreen");function y(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case o:switch(e=e.type){case r:case a:case i:case h:case p:return e;default:switch(e=e&&e.$$typeof){case u:case c:case d:case g:case f:case l:return e;default:return t}}case s:return t}}}n=Symbol.for("react.module.reference"),t.ContextConsumer=c,t.ContextProvider=l,t.Element=o,t.ForwardRef=d,t.Fragment=r,t.Lazy=g,t.Memo=f,t.Portal=s,t.Profiler=a,t.StrictMode=i,t.Suspense=h,t.SuspenseList=p,t.isAsyncMode=function(){return!1},t.isConcurrentMode=function(){return!1},t.isContextConsumer=function(e){return y(e)===c},t.isContextProvider=function(e){return y(e)===l},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===o},t.isForwardRef=function(e){return y(e)===d},t.isFragment=function(e){return y(e)===r},t.isLazy=function(e){return y(e)===g},t.isMemo=function(e){return y(e)===f},t.isPortal=function(e){return y(e)===s},t.isProfiler=function(e){return y(e)===a},t.isStrictMode=function(e){return y(e)===i},t.isSuspense=function(e){return y(e)===h},t.isSuspenseList=function(e){return y(e)===p},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===r||e===a||e===i||e===h||e===p||e===m||"object"==typeof e&&null!==e&&(e.$$typeof===g||e.$$typeof===f||e.$$typeof===l||e.$$typeof===c||e.$$typeof===d||e.$$typeof===n||void 0!==e.getModuleId)},t.typeOf=y},91272:(e,t,n)=>{"use strict";e.exports=n(65860)},24318:(e,t,n)=>{"use strict";function o(e,t){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},o(e,t)}function s(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,o(e,t)}n.r(t),n.d(t,{BrowserRouter:()=>J,HashRouter:()=>K,Link:()=>ne,MemoryRouter:()=>C,NavLink:()=>re,Prompt:()=>k,Redirect:()=>M,Route:()=>N,Router:()=>T,StaticRouter:()=>G,Switch:()=>H,generatePath:()=>P,matchPath:()=>O,useHistory:()=>V,useLocation:()=>z,useParams:()=>j,useRouteMatch:()=>Q,withRouter:()=>q});var r=n(30538),i=n(87468),a=n.n(i),l=n(27331),c=n(49481),u=n(26443),d=n(85085),h=n.n(d);function p(e,t){if(null==e)return{};var n={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(-1!==t.indexOf(o))continue;n[o]=e[o]}return n}n(91272);var f=n(78535),g=n.n(f),m=1073741823,y="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:{},v=r.createContext||function(e,t){var n,o,i,l="__create-react-context-"+((y[i="__global_unique_id__"]=(y[i]||0)+1)+"__"),c=function(e){function n(){for(var t,n,o,s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return(t=e.call.apply(e,[this].concat(r))||this).emitter=(n=t.props.value,o=[],{on:function(e){o.push(e)},off:function(e){o=o.filter((function(t){return t!==e}))},get:function(){return n},set:function(e,t){n=e,o.forEach((function(e){return e(n,t)}))}}),t}s(n,e);var o=n.prototype;return o.getChildContext=function(){var e;return(e={})[l]=this.emitter,e},o.componentWillReceiveProps=function(e){if(this.props.value!==e.value){var n,o=this.props.value,s=e.value;((r=o)===(i=s)?0!==r||1/r==1/i:r!=r&&i!=i)?n=0:(n="function"==typeof t?t(o,s):m,0!=(n|=0)&&this.emitter.set(e.value,n))}var r,i},o.render=function(){return this.props.children},n}(r.Component);c.childContextTypes=((n={})[l]=a().object.isRequired,n);var u=function(t){function n(){for(var e,n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))||this).observedBits=void 0,e.state={value:e.getValue()},e.onUpdate=function(t,n){e.observedBits&n&&e.setState({value:e.getValue()})},e}s(n,t);var o=n.prototype;return o.componentWillReceiveProps=function(e){var t=e.observedBits;this.observedBits=null==t?m:t},o.componentDidMount=function(){this.context[l]&&this.context[l].on(this.onUpdate);var e=this.props.observedBits;this.observedBits=null==e?m:e},o.componentWillUnmount=function(){this.context[l]&&this.context[l].off(this.onUpdate)},o.getValue=function(){return this.context[l]?this.context[l].get():e},o.render=function(){return(e=this.props.children,Array.isArray(e)?e[0]:e)(this.state.value);var e},n}(r.Component);return u.contextTypes=((o={})[l]=a().object,o),{Provider:c,Consumer:u}},b=function(e){var t=v();return t.displayName=e,t},S=b("Router-History"),w=b("Router"),T=function(e){function t(t){var n;return(n=e.call(this,t)||this).state={location:t.history.location},n._isMounted=!1,n._pendingLocation=null,t.staticContext||(n.unlisten=t.history.listen((function(e){n._pendingLocation=e}))),n}s(t,e),t.computeRootMatch=function(e){return{path:"/",url:"/",params:{},isExact:"/"===e}};var n=t.prototype;return n.componentDidMount=function(){var e=this;this._isMounted=!0,this.unlisten&&this.unlisten(),this.props.staticContext||(this.unlisten=this.props.history.listen((function(t){e._isMounted&&e.setState({location:t})}))),this._pendingLocation&&this.setState({location:this._pendingLocation})},n.componentWillUnmount=function(){this.unlisten&&(this.unlisten(),this._isMounted=!1,this._pendingLocation=null)},n.render=function(){return r.createElement(w.Provider,{value:{history:this.props.history,location:this.state.location,match:t.computeRootMatch(this.state.location.pathname),staticContext:this.props.staticContext}},r.createElement(S.Provider,{children:this.props.children||null,value:this.props.history}))},t}(r.Component),C=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(t=e.call.apply(e,[this].concat(o))||this).history=(0,l.createMemoryHistory)(t.props),t}return s(t,e),t.prototype.render=function(){return r.createElement(T,{history:this.history,children:this.props.children})},t}(r.Component),_=function(e){function t(){return e.apply(this,arguments)||this}s(t,e);var n=t.prototype;return n.componentDidMount=function(){this.props.onMount&&this.props.onMount.call(this,this)},n.componentDidUpdate=function(e){this.props.onUpdate&&this.props.onUpdate.call(this,this,e)},n.componentWillUnmount=function(){this.props.onUnmount&&this.props.onUnmount.call(this,this)},n.render=function(){return null},t}(r.Component);function k(e){var t=e.message,n=e.when,o=void 0===n||n;return r.createElement(w.Consumer,null,(function(e){if(e||(0,c.A)(!1),!o||e.staticContext)return null;var n=e.history.block;return r.createElement(_,{onMount:function(e){e.release=n(t)},onUpdate:function(e,o){o.message!==t&&(e.release(),e.release=n(t))},onUnmount:function(e){e.release()},message:t})}))}var E={},A=1e4,I=0;function P(e,t){return void 0===e&&(e="/"),void 0===t&&(t={}),"/"===e?e:function(e){if(E[e])return E[e];var t=h().compile(e);return I<A&&(E[e]=t,I++),t}(e)(t,{pretty:!0})}function M(e){var t=e.computedMatch,n=e.to,o=e.push,s=void 0!==o&&o;return r.createElement(w.Consumer,null,(function(e){e||(0,c.A)(!1);var o=e.history,i=e.staticContext,a=s?o.push:o.replace,d=(0,l.createLocation)(t?"string"==typeof n?P(n,t.params):(0,u.A)({},n,{pathname:P(n.pathname,t.params)}):n);return i?(a(d),null):r.createElement(_,{onMount:function(){a(d)},onUpdate:function(e,t){var n=(0,l.createLocation)(t.to);(0,l.locationsAreEqual)(n,(0,u.A)({},d,{key:n.key}))||a(d)},to:n})}))}var x={},R=1e4,D=0;function O(e,t){void 0===t&&(t={}),("string"==typeof t||Array.isArray(t))&&(t={path:t});var n=t,o=n.path,s=n.exact,r=void 0!==s&&s,i=n.strict,a=void 0!==i&&i,l=n.sensitive,c=void 0!==l&&l;return[].concat(o).reduce((function(t,n){if(!n&&""!==n)return null;if(t)return t;var o=function(e,t){var n=""+t.end+t.strict+t.sensitive,o=x[n]||(x[n]={});if(o[e])return o[e];var s=[],r={regexp:h()(e,s,t),keys:s};return D<R&&(o[e]=r,D++),r}(n,{end:r,strict:a,sensitive:c}),s=o.regexp,i=o.keys,l=s.exec(e);if(!l)return null;var u=l[0],d=l.slice(1),p=e===u;return r&&!p?null:{path:n,url:"/"===n&&""===u?"/":u,isExact:p,params:i.reduce((function(e,t,n){return e[t.name]=d[n],e}),{})}}),null)}var N=function(e){function t(){return e.apply(this,arguments)||this}return s(t,e),t.prototype.render=function(){var e=this;return r.createElement(w.Consumer,null,(function(t){t||(0,c.A)(!1);var n=e.props.location||t.location,o=e.props.computedMatch?e.props.computedMatch:e.props.path?O(n.pathname,e.props):t.match,s=(0,u.A)({},t,{location:n,match:o}),i=e.props,a=i.children,l=i.component,d=i.render;return Array.isArray(a)&&function(e){return 0===r.Children.count(e)}(a)&&(a=null),r.createElement(w.Provider,{value:s},s.match?a?"function"==typeof a?a(s):a:l?r.createElement(l,s):d?d(s):null:"function"==typeof a?a(s):null)}))},t}(r.Component);function L(e){return"/"===e.charAt(0)?e:"/"+e}function F(e,t){if(!e)return t;var n=L(e);return 0!==t.pathname.indexOf(n)?t:(0,u.A)({},t,{pathname:t.pathname.substr(n.length)})}function B(e){return"string"==typeof e?e:(0,l.createPath)(e)}function W(e){return function(){(0,c.A)(!1)}}function U(){}var G=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(t=e.call.apply(e,[this].concat(o))||this).handlePush=function(e){return t.navigateTo(e,"PUSH")},t.handleReplace=function(e){return t.navigateTo(e,"REPLACE")},t.handleListen=function(){return U},t.handleBlock=function(){return U},t}s(t,e);var n=t.prototype;return n.navigateTo=function(e,t){var n=this.props,o=n.basename,s=void 0===o?"":o,r=n.context,i=void 0===r?{}:r;i.action=t,i.location=function(e,t){return e?(0,u.A)({},t,{pathname:L(e)+t.pathname}):t}(s,(0,l.createLocation)(e)),i.url=B(i.location)},n.render=function(){var e=this.props,t=e.basename,n=void 0===t?"":t,o=e.context,s=void 0===o?{}:o,i=e.location,a=void 0===i?"/":i,c=p(e,["basename","context","location"]),d={createHref:function(e){return L(n+B(e))},action:"POP",location:F(n,(0,l.createLocation)(a)),push:this.handlePush,replace:this.handleReplace,go:W(),goBack:W(),goForward:W(),listen:this.handleListen,block:this.handleBlock};return r.createElement(T,(0,u.A)({},c,{history:d,staticContext:s}))},t}(r.Component),H=function(e){function t(){return e.apply(this,arguments)||this}return s(t,e),t.prototype.render=function(){var e=this;return r.createElement(w.Consumer,null,(function(t){t||(0,c.A)(!1);var n,o,s=e.props.location||t.location;return r.Children.forEach(e.props.children,(function(e){if(null==o&&r.isValidElement(e)){n=e;var i=e.props.path||e.props.from;o=i?O(s.pathname,(0,u.A)({},e.props,{path:i})):t.match}})),o?r.cloneElement(n,{location:s,computedMatch:o}):null}))},t}(r.Component);function q(e){var t="withRouter("+(e.displayName||e.name)+")",n=function(t){var n=t.wrappedComponentRef,o=p(t,["wrappedComponentRef"]);return r.createElement(w.Consumer,null,(function(t){return t||(0,c.A)(!1),r.createElement(e,(0,u.A)({},o,t,{ref:n}))}))};return n.displayName=t,n.WrappedComponent=e,g()(n,e)}var $=r.useContext;function V(){return $(S)}function z(){return $(w).location}function j(){var e=$(w).match;return e?e.params:{}}function Q(e){var t=z(),n=$(w).match;return e?O(t.pathname,e):n}var J=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(t=e.call.apply(e,[this].concat(o))||this).history=(0,l.createBrowserHistory)(t.props),t}return s(t,e),t.prototype.render=function(){return r.createElement(T,{history:this.history,children:this.props.children})},t}(r.Component),K=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(t=e.call.apply(e,[this].concat(o))||this).history=(0,l.createHashHistory)(t.props),t}return s(t,e),t.prototype.render=function(){return r.createElement(T,{history:this.history,children:this.props.children})},t}(r.Component),Y=function(e,t){return"function"==typeof e?e(t):e},X=function(e,t){return"string"==typeof e?(0,l.createLocation)(e,null,null,t):e},Z=function(e){return e},ee=r.forwardRef;void 0===ee&&(ee=Z);var te=ee((function(e,t){var n=e.innerRef,o=e.navigate,s=e.onClick,i=p(e,["innerRef","navigate","onClick"]),a=i.target,l=(0,u.A)({},i,{onClick:function(e){try{s&&s(e)}catch(t){throw e.preventDefault(),t}e.defaultPrevented||0!==e.button||a&&"_self"!==a||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)||(e.preventDefault(),o())}});return l.ref=Z!==ee&&t||n,r.createElement("a",l)})),ne=ee((function(e,t){var n=e.component,o=void 0===n?te:n,s=e.replace,i=e.to,a=e.innerRef,d=p(e,["component","replace","to","innerRef"]);return r.createElement(w.Consumer,null,(function(e){e||(0,c.A)(!1);var n=e.history,h=X(Y(i,e.location),e.location),p=h?n.createHref(h):"",f=(0,u.A)({},d,{href:p,navigate:function(){var t=Y(i,e.location),o=(0,l.createPath)(e.location)===(0,l.createPath)(X(t));(s||o?n.replace:n.push)(t)}});return Z!==ee?f.ref=t||a:f.innerRef=a,r.createElement(o,f)}))})),oe=function(e){return e},se=r.forwardRef;void 0===se&&(se=oe);var re=se((function(e,t){var n=e["aria-current"],o=void 0===n?"page":n,s=e.activeClassName,i=void 0===s?"active":s,a=e.activeStyle,l=e.className,d=e.exact,h=e.isActive,f=e.location,g=e.sensitive,m=e.strict,y=e.style,v=e.to,b=e.innerRef,S=p(e,["aria-current","activeClassName","activeStyle","className","exact","isActive","location","sensitive","strict","style","to","innerRef"]);return r.createElement(w.Consumer,null,(function(e){e||(0,c.A)(!1);var n=f||e.location,s=X(Y(v,n),n),p=s.pathname,w=p&&p.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1"),T=w?O(n.pathname,{path:w,exact:d,sensitive:g,strict:m}):null,C=!!(h?h(T,n):T),_="function"==typeof l?l(C):l,k="function"==typeof y?y(C):y;C&&(_=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((function(e){return e})).join(" ")}(_,i),k=(0,u.A)({},k,a));var E=(0,u.A)({"aria-current":C&&o||null,className:_,style:k,to:s},S);return oe!==se?E.ref=t||b:E.innerRef=b,r.createElement(ne,E)}))}))},36517:(e,t)=>{"use strict";var n=Symbol.for("react.element"),o=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator,f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function y(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||f}function v(){}function b(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||f}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=y.prototype;var S=b.prototype=new v;S.constructor=b,g(S,y.prototype),S.isPureReactComponent=!0;var w=Array.isArray,T=Object.prototype.hasOwnProperty,C={current:null},_={key:!0,ref:!0,__self:!0,__source:!0};function k(e,t,o){var s,r={},i=null,a=null;if(null!=t)for(s in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(i=""+t.key),t)T.call(t,s)&&!_.hasOwnProperty(s)&&(r[s]=t[s]);var l=arguments.length-2;if(1===l)r.children=o;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];r.children=c}if(e&&e.defaultProps)for(s in l=e.defaultProps)void 0===r[s]&&(r[s]=l[s]);return{$$typeof:n,type:e,key:i,ref:a,props:r,_owner:C.current}}function E(e){return"object"==typeof e&&null!==e&&e.$$typeof===n}var A=/\/+/g;function I(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function P(e,t,s,r,i){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case o:l=!0}}if(l)return i=i(l=e),e=""===r?"."+I(l,0):r,w(i)?(s="",null!=e&&(s=e.replace(A,"$&/")+"/"),P(i,t,s,"",(function(e){return e}))):null!=i&&(E(i)&&(i=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,s+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(A,"$&/")+"/")+e)),t.push(i)),1;if(l=0,r=""===r?".":r+":",w(e))for(var c=0;c<e.length;c++){var u=r+I(a=e[c],c);l+=P(a,t,s,u,i)}else if(u=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"==typeof u)for(e=u.call(e),c=0;!(a=e.next()).done;)l+=P(a=a.value,t,s,u=r+I(a,c++),i);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function M(e,t,n){if(null==e)return e;var o=[],s=0;return P(e,o,"","",(function(e){return t.call(n,e,s++)})),o}function x(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R={current:null},D={transition:null},O={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:D,ReactCurrentOwner:C};function N(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:M,forEach:function(e,t,n){M(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return M(e,(function(){t++})),t},toArray:function(e){return M(e,(function(e){return e}))||[]},only:function(e){if(!E(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=s,t.Profiler=i,t.PureComponent=b,t.StrictMode=r,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,t.act=N,t.cloneElement=function(e,t,o){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=g({},e.props),r=e.key,i=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(i=t.ref,a=C.current),void 0!==t.key&&(r=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)T.call(t,c)&&!_.hasOwnProperty(c)&&(s[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)s.children=o;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];s.children=l}return{$$typeof:n,type:e.type,key:r,ref:i,props:s,_owner:a}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=k,t.createFactory=function(e){var t=k.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:x}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.transition;D.transition={};try{e()}finally{D.transition=t}},t.unstable_act=N,t.useCallback=function(e,t){return R.current.useCallback(e,t)},t.useContext=function(e){return R.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return R.current.useDeferredValue(e)},t.useEffect=function(e,t){return R.current.useEffect(e,t)},t.useId=function(){return R.current.useId()},t.useImperativeHandle=function(e,t,n){return R.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return R.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return R.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return R.current.useMemo(e,t)},t.useReducer=function(e,t,n){return R.current.useReducer(e,t,n)},t.useRef=function(e){return R.current.useRef(e)},t.useState=function(e){return R.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return R.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return R.current.useTransition()},t.version="18.3.1"},30538:(e,t,n)=>{"use strict";e.exports=n(36517)},84577:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var o=n-1>>>1,s=e[o];if(!(0<r(s,t)))break e;e[o]=t,e[n]=s,n=o}}function o(e){return 0===e.length?null:e[0]}function s(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var o=0,s=e.length,i=s>>>1;o<i;){var a=2*(o+1)-1,l=e[a],c=a+1,u=e[c];if(0>r(l,n))c<s&&0>r(u,l)?(e[o]=u,e[c]=n,o=c):(e[o]=l,e[a]=n,o=a);else{if(!(c<s&&0>r(u,n)))break e;e[o]=u,e[c]=n,o=c}}}return t}function r(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],d=1,h=null,p=3,f=!1,g=!1,m=!1,y="function"==typeof setTimeout?setTimeout:null,v="function"==typeof clearTimeout?clearTimeout:null,b="undefined"!=typeof setImmediate?setImmediate:null;function S(e){for(var t=o(u);null!==t;){if(null===t.callback)s(u);else{if(!(t.startTime<=e))break;s(u),t.sortIndex=t.expirationTime,n(c,t)}t=o(u)}}function w(e){if(m=!1,S(e),!g)if(null!==o(c))g=!0,D(T);else{var t=o(u);null!==t&&O(w,t.startTime-e)}}function T(e,n){g=!1,m&&(m=!1,v(E),E=-1),f=!0;var r=p;try{for(S(n),h=o(c);null!==h&&(!(h.expirationTime>n)||e&&!P());){var i=h.callback;if("function"==typeof i){h.callback=null,p=h.priorityLevel;var a=i(h.expirationTime<=n);n=t.unstable_now(),"function"==typeof a?h.callback=a:h===o(c)&&s(c),S(n)}else s(c);h=o(c)}if(null!==h)var l=!0;else{var d=o(u);null!==d&&O(w,d.startTime-n),l=!1}return l}finally{h=null,p=r,f=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var C,_=!1,k=null,E=-1,A=5,I=-1;function P(){return!(t.unstable_now()-I<A)}function M(){if(null!==k){var e=t.unstable_now();I=e;var n=!0;try{n=k(!0,e)}finally{n?C():(_=!1,k=null)}}else _=!1}if("function"==typeof b)C=function(){b(M)};else if("undefined"!=typeof MessageChannel){var x=new MessageChannel,R=x.port2;x.port1.onmessage=M,C=function(){R.postMessage(null)}}else C=function(){y(M,0)};function D(e){k=e,_||(_=!0,C())}function O(e,n){E=y((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||f||(g=!0,D(T))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return o(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,s,r){var i=t.unstable_now();switch(r="object"==typeof r&&null!==r&&"number"==typeof(r=r.delay)&&0<r?i+r:i,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:d++,callback:s,priorityLevel:e,startTime:r,expirationTime:a=r+a,sortIndex:-1},r>i?(e.sortIndex=r,n(u,e),null===o(c)&&e===o(u)&&(m?(v(E),E=-1):m=!0,O(w,r-i))):(e.sortIndex=a,n(c,e),g||f||(g=!0,D(T))),e},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},82300:(e,t,n)=>{"use strict";e.exports=n(84577)},98670:(e,t,n)=>{"use strict";n.d(t,{C6:()=>s,Cg:()=>a,Cl:()=>r,Tt:()=>i,aN:()=>l});var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},o(e,t)};function s(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var r=function(){return r=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},r.apply(this,arguments)};function i(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(o=Object.getOwnPropertySymbols(e);s<o.length;s++)t.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(e,o[s])&&(n[o[s]]=e[o[s]])}return n}function a(e,t,n,o){var s,r=arguments.length,i=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(i=(r<3?s(i):r>3?s(t,n,i):s(t,n))||i);return r>3&&i&&Object.defineProperty(t,n,i),i}function l(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),s=0;for(t=0;t<n;t++)for(var r=arguments[t],i=0,a=r.length;i<a;i++,s++)o[s]=r[i];return o}},7547:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"NIL",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"v1",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"v3",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"v4",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"v5",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"validate",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(t,"version",{enumerable:!0,get:function(){return l.default}});var o=h(n(38066)),s=h(n(61832)),r=h(n(58397)),i=h(n(8830)),a=h(n(52892)),l=h(n(44179)),c=h(n(74353)),u=h(n(79418)),d=h(n(88132));function h(e){return e&&e.__esModule?e:{default:e}}},35155:(e,t)=>{"use strict";function n(e){return 14+(e+64>>>9<<4)+1}function o(e,t){const n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function s(e,t,n,s,r,i){return o((a=o(o(t,e),o(s,i)))<<(l=r)|a>>>32-l,n);var a,l}function r(e,t,n,o,r,i,a){return s(t&n|~t&o,e,t,r,i,a)}function i(e,t,n,o,r,i,a){return s(t&o|n&~o,e,t,r,i,a)}function a(e,t,n,o,r,i,a){return s(t^n^o,e,t,r,i,a)}function l(e,t,n,o,r,i,a){return s(n^(t|~o),e,t,r,i,a)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=function(e){if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(let n=0;n<t.length;++n)e[n]=t.charCodeAt(n)}return function(e){const t=[],n=32*e.length,o="0123456789abcdef";for(let s=0;s<n;s+=8){const n=e[s>>5]>>>s%32&255,r=parseInt(o.charAt(n>>>4&15)+o.charAt(15&n),16);t.push(r)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[n(t)-1]=t;let s=1732584193,c=-271733879,u=-1732584194,d=271733878;for(let t=0;t<e.length;t+=16){const n=s,h=c,p=u,f=d;s=r(s,c,u,d,e[t],7,-680876936),d=r(d,s,c,u,e[t+1],12,-389564586),u=r(u,d,s,c,e[t+2],17,606105819),c=r(c,u,d,s,e[t+3],22,-1044525330),s=r(s,c,u,d,e[t+4],7,-176418897),d=r(d,s,c,u,e[t+5],12,1200080426),u=r(u,d,s,c,e[t+6],17,-1473231341),c=r(c,u,d,s,e[t+7],22,-45705983),s=r(s,c,u,d,e[t+8],7,1770035416),d=r(d,s,c,u,e[t+9],12,-1958414417),u=r(u,d,s,c,e[t+10],17,-42063),c=r(c,u,d,s,e[t+11],22,-1990404162),s=r(s,c,u,d,e[t+12],7,1804603682),d=r(d,s,c,u,e[t+13],12,-40341101),u=r(u,d,s,c,e[t+14],17,-1502002290),c=r(c,u,d,s,e[t+15],22,1236535329),s=i(s,c,u,d,e[t+1],5,-165796510),d=i(d,s,c,u,e[t+6],9,-1069501632),u=i(u,d,s,c,e[t+11],14,643717713),c=i(c,u,d,s,e[t],20,-373897302),s=i(s,c,u,d,e[t+5],5,-701558691),d=i(d,s,c,u,e[t+10],9,38016083),u=i(u,d,s,c,e[t+15],14,-660478335),c=i(c,u,d,s,e[t+4],20,-405537848),s=i(s,c,u,d,e[t+9],5,568446438),d=i(d,s,c,u,e[t+14],9,-1019803690),u=i(u,d,s,c,e[t+3],14,-187363961),c=i(c,u,d,s,e[t+8],20,1163531501),s=i(s,c,u,d,e[t+13],5,-1444681467),d=i(d,s,c,u,e[t+2],9,-51403784),u=i(u,d,s,c,e[t+7],14,1735328473),c=i(c,u,d,s,e[t+12],20,-1926607734),s=a(s,c,u,d,e[t+5],4,-378558),d=a(d,s,c,u,e[t+8],11,-2022574463),u=a(u,d,s,c,e[t+11],16,1839030562),c=a(c,u,d,s,e[t+14],23,-35309556),s=a(s,c,u,d,e[t+1],4,-1530992060),d=a(d,s,c,u,e[t+4],11,1272893353),u=a(u,d,s,c,e[t+7],16,-155497632),c=a(c,u,d,s,e[t+10],23,-1094730640),s=a(s,c,u,d,e[t+13],4,681279174),d=a(d,s,c,u,e[t],11,-358537222),u=a(u,d,s,c,e[t+3],16,-722521979),c=a(c,u,d,s,e[t+6],23,76029189),s=a(s,c,u,d,e[t+9],4,-640364487),d=a(d,s,c,u,e[t+12],11,-421815835),u=a(u,d,s,c,e[t+15],16,530742520),c=a(c,u,d,s,e[t+2],23,-995338651),s=l(s,c,u,d,e[t],6,-198630844),d=l(d,s,c,u,e[t+7],10,1126891415),u=l(u,d,s,c,e[t+14],15,-1416354905),c=l(c,u,d,s,e[t+5],21,-57434055),s=l(s,c,u,d,e[t+12],6,1700485571),d=l(d,s,c,u,e[t+3],10,-1894986606),u=l(u,d,s,c,e[t+10],15,-1051523),c=l(c,u,d,s,e[t+1],21,-2054922799),s=l(s,c,u,d,e[t+8],6,1873313359),d=l(d,s,c,u,e[t+15],10,-30611744),u=l(u,d,s,c,e[t+6],15,-1560198380),c=l(c,u,d,s,e[t+13],21,1309151649),s=l(s,c,u,d,e[t+4],6,-145523070),d=l(d,s,c,u,e[t+11],10,-1120210379),u=l(u,d,s,c,e[t+2],15,718787259),c=l(c,u,d,s,e[t+9],21,-343485551),s=o(s,n),c=o(c,h),u=o(u,p),d=o(d,f)}return[s,c,u,d]}(function(e){if(0===e.length)return[];const t=8*e.length,o=new Uint32Array(n(t));for(let n=0;n<t;n+=8)o[n>>5]|=(255&e[n/8])<<n%32;return o}(e),8*e.length))}},99688:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};t.default=n},52892:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default="00000000-0000-0000-0000-000000000000"},88132:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,s=(o=n(74353))&&o.__esModule?o:{default:o};t.default=function(e){if(!(0,s.default)(e))throw TypeError("Invalid UUID");let t;const n=new Uint8Array(16);return n[0]=(t=parseInt(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=255&t,n[4]=(t=parseInt(e.slice(9,13),16))>>>8,n[5]=255&t,n[6]=(t=parseInt(e.slice(14,18),16))>>>8,n[7]=255&t,n[8]=(t=parseInt(e.slice(19,23),16))>>>8,n[9]=255&t,n[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=255&t,n}},48180:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},47454:(e,t)=>{"use strict";let n;Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){if(!n&&(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!n))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(o)};const o=new Uint8Array(16)},73118:(e,t)=>{"use strict";function n(e,t,n,o){switch(e){case 0:return t&n^~t&o;case 1:case 3:return t^n^o;case 2:return t&n^t&o^n&o}}function o(e,t){return e<<t|e>>>32-t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=function(e){const t=[1518500249,1859775393,2400959708,3395469782],s=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=[];for(let n=0;n<t.length;++n)e.push(t.charCodeAt(n))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);const r=e.length/4+2,i=Math.ceil(r/16),a=new Array(i);for(let t=0;t<i;++t){const n=new Uint32Array(16);for(let o=0;o<16;++o)n[o]=e[64*t+4*o]<<24|e[64*t+4*o+1]<<16|e[64*t+4*o+2]<<8|e[64*t+4*o+3];a[t]=n}a[i-1][14]=8*(e.length-1)/Math.pow(2,32),a[i-1][14]=Math.floor(a[i-1][14]),a[i-1][15]=8*(e.length-1)&4294967295;for(let e=0;e<i;++e){const r=new Uint32Array(80);for(let t=0;t<16;++t)r[t]=a[e][t];for(let e=16;e<80;++e)r[e]=o(r[e-3]^r[e-8]^r[e-14]^r[e-16],1);let i=s[0],l=s[1],c=s[2],u=s[3],d=s[4];for(let e=0;e<80;++e){const s=Math.floor(e/20),a=o(i,5)+n(s,l,c,u)+d+t[s]+r[e]>>>0;d=u,u=c,c=o(l,30)>>>0,l=i,i=a}s[0]=s[0]+i>>>0,s[1]=s[1]+l>>>0,s[2]=s[2]+c>>>0,s[3]=s[3]+u>>>0,s[4]=s[4]+d>>>0}return[s[0]>>24&255,s[0]>>16&255,s[0]>>8&255,255&s[0],s[1]>>24&255,s[1]>>16&255,s[1]>>8&255,255&s[1],s[2]>>24&255,s[2]>>16&255,s[2]>>8&255,255&s[2],s[3]>>24&255,s[3]>>16&255,s[3]>>8&255,255&s[3],s[4]>>24&255,s[4]>>16&255,s[4]>>8&255,255&s[4]]}},79418:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.unsafeStringify=i;var o,s=(o=n(74353))&&o.__esModule?o:{default:o};const r=[];for(let e=0;e<256;++e)r.push((e+256).toString(16).slice(1));function i(e,t=0){return(r[e[t+0]]+r[e[t+1]]+r[e[t+2]]+r[e[t+3]]+"-"+r[e[t+4]]+r[e[t+5]]+"-"+r[e[t+6]]+r[e[t+7]]+"-"+r[e[t+8]]+r[e[t+9]]+"-"+r[e[t+10]]+r[e[t+11]]+r[e[t+12]]+r[e[t+13]]+r[e[t+14]]+r[e[t+15]]).toLowerCase()}t.default=function(e,t=0){const n=i(e,t);if(!(0,s.default)(n))throw TypeError("Stringified UUID is invalid");return n}},38066:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,s=(o=n(47454))&&o.__esModule?o:{default:o},r=n(79418);let i,a,l=0,c=0;t.default=function(e,t,n){let o=t&&n||0;const u=t||new Array(16);let d=(e=e||{}).node||i,h=void 0!==e.clockseq?e.clockseq:a;if(null==d||null==h){const t=e.random||(e.rng||s.default)();null==d&&(d=i=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==h&&(h=a=16383&(t[6]<<8|t[7]))}let p=void 0!==e.msecs?e.msecs:Date.now(),f=void 0!==e.nsecs?e.nsecs:c+1;const g=p-l+(f-c)/1e4;if(g<0&&void 0===e.clockseq&&(h=h+1&16383),(g<0||p>l)&&void 0===e.nsecs&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");l=p,c=f,a=h,p+=122192928e5;const m=(1e4*(268435455&p)+f)%4294967296;u[o++]=m>>>24&255,u[o++]=m>>>16&255,u[o++]=m>>>8&255,u[o++]=255&m;const y=p/4294967296*1e4&268435455;u[o++]=y>>>8&255,u[o++]=255&y,u[o++]=y>>>24&15|16,u[o++]=y>>>16&255,u[o++]=h>>>8|128,u[o++]=255&h;for(let e=0;e<6;++e)u[o+e]=d[e];return t||(0,r.unsafeStringify)(u)}},61832:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(341)),s=r(n(35155));function r(e){return e&&e.__esModule?e:{default:e}}var i=(0,o.default)("v3",48,s.default);t.default=i},341:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.URL=t.DNS=void 0,t.default=function(e,t,n){function o(e,o,i,a){var l;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));const t=[];for(let n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t}(e)),"string"==typeof o&&(o=(0,r.default)(o)),16!==(null===(l=o)||void 0===l?void 0:l.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let c=new Uint8Array(16+e.length);if(c.set(o),c.set(e,o.length),c=n(c),c[6]=15&c[6]|t,c[8]=63&c[8]|128,i){a=a||0;for(let e=0;e<16;++e)i[a+e]=c[e];return i}return(0,s.unsafeStringify)(c)}try{o.name=e}catch(e){}return o.DNS=i,o.URL=a,o};var o,s=n(79418),r=(o=n(88132))&&o.__esModule?o:{default:o};const i="6ba7b810-9dad-11d1-80b4-00c04fd430c8";t.DNS=i;const a="6ba7b811-9dad-11d1-80b4-00c04fd430c8";t.URL=a},58397:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(99688)),s=i(n(47454)),r=n(79418);function i(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t,n){if(o.default.randomUUID&&!t&&!e)return o.default.randomUUID();const i=(e=e||{}).random||(e.rng||s.default)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=i[e];return t}return(0,r.unsafeStringify)(i)}},8830:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(341)),s=r(n(73118));function r(e){return e&&e.__esModule?e:{default:e}}var i=(0,o.default)("v5",80,s.default);t.default=i},74353:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,s=(o=n(48180))&&o.__esModule?o:{default:o};t.default=function(e){return"string"==typeof e&&s.default.test(e)}},44179:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,s=(o=n(74353))&&o.__esModule?o:{default:o};t.default=function(e){if(!(0,s.default)(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)}},76442:function(){!function(e){"use strict";if(!e.fetch){var t="URLSearchParams"in e,n="Symbol"in e&&"iterator"in Symbol,o="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),s="FormData"in e,r="ArrayBuffer"in e;if(r)var i=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],a=function(e){return e&&DataView.prototype.isPrototypeOf(e)},l=ArrayBuffer.isView||function(e){return e&&i.indexOf(Object.prototype.toString.call(e))>-1};f.prototype.append=function(e,t){e=d(e),t=h(t);var n=this.map[e];this.map[e]=n?n+","+t:t},f.prototype.delete=function(e){delete this.map[d(e)]},f.prototype.get=function(e){return e=d(e),this.has(e)?this.map[e]:null},f.prototype.has=function(e){return this.map.hasOwnProperty(d(e))},f.prototype.set=function(e,t){this.map[d(e)]=h(t)},f.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},f.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),p(e)},f.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),p(e)},f.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),p(e)},n&&(f.prototype[Symbol.iterator]=f.prototype.entries);var c=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];S.prototype.clone=function(){return new S(this,{body:this._bodyInit})},b.call(S.prototype),b.call(T.prototype),T.prototype.clone=function(){return new T(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},T.error=function(){var e=new T(null,{status:0,statusText:""});return e.type="error",e};var u=[301,302,303,307,308];T.redirect=function(e,t){if(-1===u.indexOf(t))throw new RangeError("Invalid status code");return new T(null,{status:t,headers:{location:e}})},e.Headers=f,e.Request=S,e.Response=T,e.fetch=function(e,t){return new Promise((function(n,s){var r=new S(e,t),i=new XMLHttpRequest;i.onload=function(){var e,t,o={status:i.status,statusText:i.statusText,headers:(e=i.getAllResponseHeaders()||"",t=new f,e.split(/\r?\n/).forEach((function(e){var n=e.split(":"),o=n.shift().trim();if(o){var s=n.join(":").trim();t.append(o,s)}})),t)};o.url="responseURL"in i?i.responseURL:o.headers.get("X-Request-URL");var s="response"in i?i.response:i.responseText;n(new T(s,o))},i.onerror=function(){s(new TypeError("Network request failed"))},i.ontimeout=function(){s(new TypeError("Network request failed"))},i.open(r.method,r.url,!0),"include"===r.credentials&&(i.withCredentials=!0),"responseType"in i&&o&&(i.responseType="blob"),r.headers.forEach((function(e,t){i.setRequestHeader(t,e)})),i.send(void 0===r._bodyInit?null:r._bodyInit)}))},e.fetch.polyfill=!0}function d(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function h(e){return"string"!=typeof e&&(e=String(e)),e}function p(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return n&&(t[Symbol.iterator]=function(){return t}),t}function f(e){this.map={},e instanceof f?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function g(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function m(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function y(e){var t=new FileReader,n=m(t);return t.readAsArrayBuffer(e),n}function v(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function b(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(o&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(s&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(r&&o&&a(e))this._bodyArrayBuffer=v(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!r||!ArrayBuffer.prototype.isPrototypeOf(e)&&!l(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=v(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o&&(this.blob=function(){var e=g(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?g(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(y)}),this.text=function(){var e,t,n,o=g(this);if(o)return o;if(this._bodyBlob)return e=this._bodyBlob,n=m(t=new FileReader),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),o=0;o<t.length;o++)n[o]=String.fromCharCode(t[o]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},s&&(this.formData=function(){return this.text().then(w)}),this.json=function(){return this.text().then(JSON.parse)},this}function S(e,t){var n,o,s=(t=t||{}).body;if(e instanceof S){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new f(e.headers)),this.method=e.method,this.mode=e.mode,s||null==e._bodyInit||(s=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new f(t.headers)),this.method=(o=(n=t.method||this.method||"GET").toUpperCase(),c.indexOf(o)>-1?o:n),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&s)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(s)}function w(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),o=n.shift().replace(/\+/g," "),s=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(o),decodeURIComponent(s))}})),t}function T(e,t){t||(t={}),this.type="default",this.status="status"in t?t.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new f(t.headers),this.url=t.url||"",this._initBody(e)}}("undefined"!=typeof self?self:this)},26443:(e,t,n)=>{"use strict";function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)({}).hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},o.apply(null,arguments)}n.d(t,{A:()=>o})},49481:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var o=!0,s="Invariant failed";function r(e,t){if(!e){if(o)throw new Error(s);var n="function"==typeof t?t():t,r=n?"".concat(s,": ").concat(n):s;throw new Error(r)}}},5866:(e,t,n)=>{"use strict";n.r(t),n.d(t,{__addDisposableResource:()=>N,__assign:()=>r,__asyncDelegator:()=>k,__asyncGenerator:()=>_,__asyncValues:()=>E,__await:()=>C,__awaiter:()=>f,__classPrivateFieldGet:()=>R,__classPrivateFieldIn:()=>O,__classPrivateFieldSet:()=>D,__createBinding:()=>m,__decorate:()=>a,__disposeResources:()=>F,__esDecorate:()=>c,__exportStar:()=>y,__extends:()=>s,__generator:()=>g,__importDefault:()=>x,__importStar:()=>M,__makeTemplateObject:()=>A,__metadata:()=>p,__param:()=>l,__propKey:()=>d,__read:()=>b,__rest:()=>i,__rewriteRelativeImportExtension:()=>B,__runInitializers:()=>u,__setFunctionName:()=>h,__spread:()=>S,__spreadArray:()=>T,__spreadArrays:()=>w,__values:()=>v,default:()=>W});var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},o(e,t)};function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var r=function(){return r=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},r.apply(this,arguments)};function i(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(o=Object.getOwnPropertySymbols(e);s<o.length;s++)t.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(e,o[s])&&(n[o[s]]=e[o[s]])}return n}function a(e,t,n,o){var s,r=arguments.length,i=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(i=(r<3?s(i):r>3?s(t,n,i):s(t,n))||i);return r>3&&i&&Object.defineProperty(t,n,i),i}function l(e,t){return function(n,o){t(n,o,e)}}function c(e,t,n,o,s,r){function i(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var a,l=o.kind,c="getter"===l?"get":"setter"===l?"set":"value",u=!t&&e?o.static?e:e.prototype:null,d=t||(u?Object.getOwnPropertyDescriptor(u,o.name):{}),h=!1,p=n.length-1;p>=0;p--){var f={};for(var g in o)f[g]="access"===g?{}:o[g];for(var g in o.access)f.access[g]=o.access[g];f.addInitializer=function(e){if(h)throw new TypeError("Cannot add initializers after decoration has completed");r.push(i(e||null))};var m=(0,n[p])("accessor"===l?{get:d.get,set:d.set}:d[c],f);if("accessor"===l){if(void 0===m)continue;if(null===m||"object"!=typeof m)throw new TypeError("Object expected");(a=i(m.get))&&(d.get=a),(a=i(m.set))&&(d.set=a),(a=i(m.init))&&s.unshift(a)}else(a=i(m))&&("field"===l?s.unshift(a):d[c]=a)}u&&Object.defineProperty(u,o.name,d),h=!0}function u(e,t,n){for(var o=arguments.length>2,s=0;s<t.length;s++)n=o?t[s].call(e,n):t[s].call(e);return o?n:void 0}function d(e){return"symbol"==typeof e?e:"".concat(e)}function h(e,t,n){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function f(e,t,n,o){return new(n||(n=Promise))((function(s,r){function i(e){try{l(o.next(e))}catch(e){r(e)}}function a(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))}function g(e,t){var n,o,s,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=a(0),i.throw=a(1),i.return=a(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(s=2&a[0]?o.return:a[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,a[1])).done)return s;switch(o=0,s&&(a=[2&a[0],s.value]),a[0]){case 0:case 1:s=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!((s=(s=r.trys).length>0&&s[s.length-1])||6!==a[0]&&2!==a[0])){r=0;continue}if(3===a[0]&&(!s||a[1]>s[0]&&a[1]<s[3])){r.label=a[1];break}if(6===a[0]&&r.label<s[1]){r.label=s[1],s=a;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(a);break}s[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(e){a=[6,e],o=0}finally{n=s=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}var m=Object.create?function(e,t,n,o){void 0===o&&(o=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,s)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]};function y(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||m(t,e,n)}function v(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],o=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function b(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,s,r=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(o=r.next()).done;)i.push(o.value)}catch(e){s={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return i}function S(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(b(arguments[t]));return e}function w(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),s=0;for(t=0;t<n;t++)for(var r=arguments[t],i=0,a=r.length;i<a;i++,s++)o[s]=r[i];return o}function T(e,t,n){if(n||2===arguments.length)for(var o,s=0,r=t.length;s<r;s++)!o&&s in t||(o||(o=Array.prototype.slice.call(t,0,s)),o[s]=t[s]);return e.concat(o||Array.prototype.slice.call(t))}function C(e){return this instanceof C?(this.v=e,this):new C(e)}function _(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,s=n.apply(e,t||[]),r=[];return o=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),i("next"),i("throw"),i("return",(function(e){return function(t){return Promise.resolve(t).then(e,c)}})),o[Symbol.asyncIterator]=function(){return this},o;function i(e,t){s[e]&&(o[e]=function(t){return new Promise((function(n,o){r.push([e,t,n,o])>1||a(e,t)}))},t&&(o[e]=t(o[e])))}function a(e,t){try{(n=s[e](t)).value instanceof C?Promise.resolve(n.value.v).then(l,c):u(r[0][2],n)}catch(e){u(r[0][3],e)}var n}function l(e){a("next",e)}function c(e){a("throw",e)}function u(e,t){e(t),r.shift(),r.length&&a(r[0][0],r[0][1])}}function k(e){var t,n;return t={},o("next"),o("throw",(function(e){throw e})),o("return"),t[Symbol.iterator]=function(){return this},t;function o(o,s){t[o]=e[o]?function(t){return(n=!n)?{value:C(e[o](t)),done:!1}:s?s(t):t}:s}}function E(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=v(e),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(n){t[n]=e[n]&&function(t){return new Promise((function(o,s){!function(e,t,n,o){Promise.resolve(o).then((function(t){e({value:t,done:n})}),t)}(o,s,(t=e[n](t)).done,t.value)}))}}}function A(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var I=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},P=function(e){return P=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},P(e)};function M(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=P(e),o=0;o<n.length;o++)"default"!==n[o]&&m(t,e,n[o]);return I(t,e),t}function x(e){return e&&e.__esModule?e:{default:e}}function R(e,t,n,o){if("a"===n&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?o:"a"===n?o.call(e):o?o.value:t.get(e)}function D(e,t,n,o,s){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?s.call(e,n):s?s.value=n:t.set(e,n),n}function O(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function N(e,t,n){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var o,s;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");o=t[Symbol.asyncDispose]}if(void 0===o){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");o=t[Symbol.dispose],n&&(s=o)}if("function"!=typeof o)throw new TypeError("Object not disposable.");s&&(o=function(){try{s.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:o,async:n})}else n&&e.stack.push({async:!0});return t}var L="function"==typeof SuppressedError?SuppressedError:function(e,t,n){var o=new Error(n);return o.name="SuppressedError",o.error=e,o.suppressed=t,o};function F(e){function t(t){e.error=e.hasError?new L(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}var n,o=0;return function s(){for(;n=e.stack.pop();)try{if(!n.async&&1===o)return o=0,e.stack.push(n),Promise.resolve().then(s);if(n.dispose){var r=n.dispose.call(n.value);if(n.async)return o|=2,Promise.resolve(r).then(s,(function(e){return t(e),s()}))}else o|=1}catch(e){t(e)}if(1===o)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}()}function B(e,t){return"string"==typeof e&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,(function(e,n,o,s,r){return n?t?".jsx":".js":!o||s&&r?o+s+"."+r.toLowerCase()+"js":e})):e}const W={__extends:s,__assign:r,__rest:i,__decorate:a,__param:l,__esDecorate:c,__runInitializers:u,__propKey:d,__setFunctionName:h,__metadata:p,__awaiter:f,__generator:g,__createBinding:m,__exportStar:y,__values:v,__read:b,__spread:S,__spreadArrays:w,__spreadArray:T,__await:C,__asyncGenerator:_,__asyncDelegator:k,__asyncValues:E,__makeTemplateObject:A,__importStar:M,__importDefault:x,__classPrivateFieldGet:R,__classPrivateFieldSet:D,__classPrivateFieldIn:O,__addDisposableResource:N,__disposeResources:F,__rewriteRelativeImportExtension:B}},74325:e=>{"use strict";e.exports={r:"2.37.256"}}}]);
//# sourceMappingURL=vendor.js.map