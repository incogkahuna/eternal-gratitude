"use strict";(self.webpackChunkTypeScriptModule=self.webpackChunkTypeScriptModule||[]).push([["augloop-chunk"],{646:(e,t,s)=>{s.d(t,{kZ:()=>n});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_CopilotChatTeachingUi_CopilotChatTeachingUISignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_CopilotChatTeachingUi_Operation"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_CopilotChatTeachingUi_GetTUIEverShownStateOperation"}static getBaseTypes(){return["AugLoop_CopilotChatTeachingUi_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_CopilotChatTeachingUi_SetTUIEverShownStateOperation"}static getBaseTypes(){return["AugLoop_CopilotChatTeachingUi_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},1193:(e,t,s)=>{s.d(t,{L:()=>n});var o={util:{},roots:{default:{}}},n=(o.util,o.roots.default||(o.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.sessionKey="",e.prototype.annotationType="",e.prototype.annotationState=0,e.prototype.workflowId="",e.prototype.traceId="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/AnnotationMetaDataChangeEvent"},e}())},1789:(e,t,s)=>{var o,n;s.d(t,{Q:()=>o}),function(e){e.GET="Get",e.PROCESSED="Processed"}(o||(o={})),function(e){e.GET="Get",e.STORE="Store"}(n||(n={}))},12855:(e,t,s)=>{var o,n,i,a,r,c,l,u;s.d(t,{Rk:()=>i,b_:()=>n,lp:()=>c,ss:()=>p,w2:()=>u,ye:()=>o}),function(e){e[e.None=0]="None",e[e.Unrecognized=1]="Unrecognized",e[e.RowMajor=2]="RowMajor",e[e.HasMergedCells=4]="HasMergedCells",e[e.UnsupportedAggregations=8]="UnsupportedAggregations",e[e.NoHeaderRow=16]="NoHeaderRow",e[e.MultipleHeaderRows=32]="MultipleHeaderRows",e[e.HeaderColumns=64]="HeaderColumns",e[e.LowInterpretationConfidence=128]="LowInterpretationConfidence",e[e.EmptyHeaders=256]="EmptyHeaders",e[e.DuplicateHeaders=512]="DuplicateHeaders",e[e.Crosstab=1024]="Crosstab",e[e.TotalsRow=2048]="TotalsRow",e[e.MultipleHeaderColumns=4096]="MultipleHeaderColumns",e[e.NoHeaderColumn=8192]="NoHeaderColumn",e[e.HeaderRows=16384]="HeaderRows",e[e.All=-2049]="All"}(o||(o={})),function(e){e[e.None=0]="None",e[e.ChartSelected=1]="ChartSelected",e[e.PivotTableSelected=2]="PivotTableSelected",e[e.PayloadTooLarge=4]="PayloadTooLarge",e[e.All=-1]="All"}(n||(n={})),function(e){e.Pill="pill",e.ZQM="zqm",e.ChatUserPrompt="chatUserPrompt",e.ChatPill="chatPill",e.ChatZQM="chatZqm",e.GridFormulaGenerationIPEOnCellEdit="gridFormulaGenerationIPEOnCellEdit",e.GridSkittleMenu="gridSkittleMenu",e.GridContextMenu="gridContextMenu",e.GridExplanationOnCellEdit="gridExplanationOnCellEdit",e.GridFormulaErrorCard="gridFormulaErrorCard",e.GridCopilotTab="gridCopilotTab",e.MsFormsSDX="msFormsSDX",e.MsFormsServer="msFormsServer",e.MsFormsWeb="msFormsWeb",e.CopilotSDX="copilotSDX",e.GridFormulaCompletion="onGridCompletion",e.AAChartingRibbon="AAChartingRibbon",e.GridSkittleContextualSuggestion="gridSkittleContextualSuggestion",e.GridChartInsights="gridChartInsights"}(i||(i={})),function(e){e.Insights="get_insights",e.CalculatedColumns="calculated_columns;create_columns",e.EditDocument="edit_document",e.Data_shaping="data_shaping",e.CalculatedRows="calculated_columns;aggregate",e.PythonCode="get_python_code",e.PythonCalculatedColumns="python_calculated_columns",e.ImportData="import_data",e.Else="excel_else"}(a||(a={})),function(e){e.Command="Command",e.ConditionalFormatting="Conditional format",e.GenerateFormula="Generate formula",e.FormulaCorrection="Formula correction and repair",e.FormulaSimplification="Formula simplification",e.FormulaModification="Formula modification",e.FormulaExplanation="Formula explanation",e.FormulaHelp="Formula help",e.CopilotCapabilities="Copilot capabilities",e.ExcelHelp="Excel help",e.HowToGeneric="How-to generic",e.HowToCustom="How-to custom",e.AnalysisDescribe="Analysis describe",e.AnalysisSummarize="Analysis summarize",e.AnalysisPredict="Analysis predict",e.AnalysisCalculate="Analysis calculate",e.AnalysisHelp="Analysis help",e.AnalysisVisualize="Analysis visualize",e.Answers="Answers",e.VBAGenerate="VBA generate",e.VBAExplain="VBA explain",e.VBAFix="VBA fix",e.VBAHelp="VBA help",e.PivotCreate="Pivot create",e.PivotModify="Pivot modify",e.PivotHelp="Pivot help",e.Python="Python",e.Else="Else"}(r||(r={})),function(e){e.StandardTable="StandardTable",e.TableLikeRange="TableLikeRange"}(c||(c={})),function(e){e.MSForms="MSForms"}(l||(l={})),function(e){e[e.None=0]="None",e[e.TooManyPivotTables=1]="TooManyPivotTables",e[e.TooManyCharts=2]="TooManyCharts",e[e.TooManyCellsInWorkbook=4]="TooManyCellsInWorkbook"}(u||(u={}));const p="a1c76418-b11e-465f-9b75-c8095676380e"},14149:(e,t,s)=>{s.d(t,{w:()=>n});var o=s(596498);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_TenantFeedbackData_DiagnosticUploadResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},16244:(e,t,s)=>{var o,n;s.d(t,{O:()=>o,o:()=>n}),function(e){e.UnknownError="UnknownError",e.SubstrateSearchError="SubstrateSearchError",e.FailedToProcessFile="FailedToProcessFile",e.FailedToGeneratePowerQueryFormula="FailedToGeneratePowerQueryFormula",e.Timeout="Timeout",e.RAI="RAI",e.FailedToParseRelevancyResponse="FailedToParseRelevancyResponse",e.UserQueryNotFound="UserQueryNotFound",e.NoDataSourcesFound="NoDataSourcesFound",e.DLPPolicyCheckFailed="DLPPolicyCheckFailed"}(o||(o={})),function(e){e.ExcelFile="ExcelFile"}(n||(n={}))},20213:(e,t,s)=>{s.d(t,{c:()=>T});var o=s(153420),n=s(125952),i=s(263682),a=s(599243),r=s(937410),c=s(346261);function l(e,t,s){var o;if(!t||void 0===s)return[];const n=t.substring(0,s).trimEnd(),i=t.substring(s+(null!==(o=1+(null==e?void 0:e.length))&&void 0!==o?o:0)).trim();return(0,c.pR)(n,i)||[]}var u=s(241798),p=s(972091),g=s(309708),h=s(68580),d=s(775352),m=s(825688);class y{constructor(e){var t,s,o,n;this.memoryPoints=new Set,this.memoryTimestamps=[],this.startMemorySize=0,this.startTimestamp=Date.now(),this.growthFrequencyThreshold=null!==(t=e.growthFrequencyThreshold)&&void 0!==t?t:5,this.shortTermWindow=null!==(s=e.shortTermWindow)&&void 0!==s?s:6e4,this.longTermGrowthThreshold=null!==(o=e.longTermGrowthThreshold)&&void 0!==o?o:.5,this.longTermWindow=null!==(n=e.longTermWindow)&&void 0!==n?n:288e5}recordMemoryUsage(e){const t=Date.now();0===this.memoryPoints.size&&(this.startMemorySize=e,this.startTimestamp=t),this.memoryPoints.add(e),this.memoryTimestamps.push(t),this.checkShortTermGrowths(t),this.checkLongTermGrowth(e,t)}checkShortTermGrowths(e){const t=e-this.shortTermWindow;for(;this.memoryTimestamps.length>0&&this.memoryTimestamps[0]<t;)this.memoryTimestamps.shift();const s=new Set(this.memoryTimestamps.map((t=>Array.from(this.memoryPoints).find((()=>-1!==this.memoryTimestamps.findIndex((s=>s>=t&&s<=e)))))).filter(Boolean));if(s.size>=this.growthFrequencyThreshold)throw new Error(`Potential memory leak detected: ${s.size} unique memory points in the last ${this.shortTermWindow/1e3} seconds.`)}checkLongTermGrowth(e,t){const s=t-this.startTimestamp;if(s>=this.longTermWindow){const o=(e-this.startMemorySize)/this.startMemorySize;if(o>this.longTermGrowthThreshold)throw new Error(`Potential memory leak detected: ${(100*o).toFixed(2)}% growth over ${(s/36e5).toFixed(2)} hours.`);this.startMemorySize=e,this.startTimestamp=t}}getUniqueMemoryPointCount(){return this.memoryPoints.size}getCurrentMemoryUsage(){return Array.from(this.memoryPoints).pop()}resetDetector(){this.memoryPoints.clear(),this.memoryTimestamps=[],this.startMemorySize=0,this.startTimestamp=Date.now()}}class T{constructor(e,t,s){var o,a;this.ariaNamespace="GraphSearch",this.prodAriaToken="beee531d6e2444fe9a9a1c9aaa5b53cd-78755306-c8fb-4c51-9e77-9eb483e17ceb-6535",this.devAriaToken="30d62489eb65462bb3a5c93b0cad786b-0260e5be-afb3-4f7c-a14a-f0b25b00a080-7662",this.isDisposed=!1,this.wasmConfig=s,this.propertyName=e,this.ariaToken=void 0!==t.environment&&t.environment===i.O.dev?this.devAriaToken:this.prodAriaToken;const r=t.scenarios&&t.scenarios.includes(n.Nz.BIZ_CHAT)?{getHeuristicIntents:l}:void 0;this.config={...t,...void 0===t.scenarioLength?{scenarioLength:t.scenarios.length}:{},heuristicIntentsConfig:r};const c=null!==(o=null==s?void 0:s.jsAssetName)&&void 0!==o?o:"GraphSearchLocalWorkflow.js",u=`${s.wasmRoot}/${c}`;this.wasmConfig={...void 0===s?{}:s,wasmRoot:u},t.enableMemoryLeakDetection&&(this.memoryLeakDetector=new y(null!==(a=t.memoryLeakDetectorConfig)&&void 0!==a?a:{}))}async init(e,t){var s;const n=this.startLogOperation("GraphSearchWorkflowInstance"===this.propertyName?"GraphSearchWorkflowInit":"GraphSearchJoinWorkflowInit",new Date);n.setDataFields({isPrefetch:this.config.prefetchOnly});try{await this.initializeWasmModule(this.wasmConfig.wasmRoot,this.wasmConfig.locateFile,this.wasmConfig.cacheModule,this.wasmConfig.wasmModuleCache,this.wasmConfig.scriptSrcSetter),this.logWasmStats(n),this.workflowLambda=this.wasmModule[this.propertyName](this.config);const s=t?(0,o.buildEmscriptenCustomContext)(t,(()=>this.wasmModule)):(0,o.buildEmscriptenCustomContextFromSite)(e,(()=>this.wasmModule));this.workflowLambda.init(s)}catch(e){const t=null!==(s=null==e?void 0:e.stack)&&void 0!==s?s:"";n.resultDescription=e&&e.message?`${e.message} // ${t}`:"Unknown error.",n.success=!1}a.tG.info(507573794,a.nh.WorkflowDefault,n.stop())}executeWorkflowLambda(e,t,s,n,i){var r;let c=!1;if(!this.wasmModule||!this.workflowLambda)return e.resultDescription="null lambda",e.success=!1,a.tG.info(507564037,a.nh.WorkflowDefault,e.stop()),"GraphSearchWorkflowInstance"===this.propertyName?this.sendDummyAndTriggerServiceFallback(n,t):this.sendInputAnnotation(n,t,i),!1;try{const e=(0,o.buildEmscriptenCustomContext)(s,this.wasmModule);void 0===i?this.workflowLambda.execute(t,e,n):this.workflowLambda.execute(t,i,e,n)}catch(t){const s=null!==(r=null==t?void 0:t.stack)&&void 0!==r?r:"";e.resultDescription=t&&t.message?`${t.message} // ${s}`:"Unknown error.",e.success=!1,c=!0}return c}dispose(){this.isDisposed=!0,void 0!==this.workflowLambda&&this.workflowLambda.delete(),this.workflowLambda=void 0,this.wasmModule=void 0}async initializeWasmModule(e,t,s=!0,n,i){if(this.wasmModule=await(0,o.loadWasmWebFromModularizeFunction)(e,"createGSWLocalInstance","GraphSearchWorkflowWasm_Prefetch",s,t,n,i),this.isDisposed)throw new Error("Workflow was disposed while initializing WASM module")}startLogOperation(e,t,s){const o=new r.I({operationName:"GraphSearchWorkflowInstance"===this.propertyName?"graphsearchworkflow_ts":"graphsearchjoinworkflow_ts",success:!0,resultDescription:"",ariaTenant:this.ariaToken,ariaNamespace:this.ariaNamespace}).start();return o.setDataFields({msg:e,startTimestamp:t.toISOString(),inputCount:s?s.length:0}),o}logWasmStats(e){this.wasmModule&&e.setDataFields({version:this.wasmModule.version,sdkVersion:this.wasmModule.sdkVersion,wasmModuleHeapSize:this.wasmModule.HEAP8?this.wasmModule.HEAP8.buffer.byteLength:void 0}),this.config.enableMemoryLeakDetection&&this.wasmModule&&this.wasmModule.HEAP8&&this.memoryLeakDetector.recordMemoryUsage(this.wasmModule.HEAP8.buffer.byteLength)}sendDummyAndTriggerServiceFallback(e,t){if(g.VP.typeGuard(t)||u.Z5.typeGuard(t)){const s={ownerId:"GraphSearchClient",conversationId:t.conversationId,logicalId:t.logicalId,entityResults:[],status:h.i.Success},o=g.VP.typeGuard(t)?d.SM.getTypeName():p.J_.getTypeName();e.setAnnotations(t,o,[s],{immediate:!0}),e.submitSignals([new u.tE({cachedIntents:[],inputObject:t,entityTypesResolved:this.config.entityTypes})])}}sendInputAnnotation(e,t,s){void 0!==s&&s.length>0&&(d.SM.typeGuard(s[0])?this.sendEccInputAnnotation(e,t,s):p.J_.typeGuard(s[0])&&this.sendSearchSuggestionInputAnnotation(e,t,s))}sendEccInputAnnotation(e,t,s){if(void 0!==s&&s.length>0&&d.SM.typeGuard(s[0])){const o=new m.os({entityResults:s[0].entityResults,status:h.i.Success});e.setAnnotations(t,m.os.getTypeName(),[o],{immediate:!0})}}sendSearchSuggestionInputAnnotation(e,t,s){if(void 0!==s&&s.length>0&&p.J_.typeGuard(s[0])){const o=new p.VL({results:s[0].results,status:h.i.Success});e.setAnnotations(t,p.VL.getTypeName(),[o],{immediate:!0})}}}},20214:(e,t,s)=>{var o;s.d(t,{v:()=>o}),function(e){e[e.Undefined=0]="Undefined",e[e.Schema=1]="Schema",e[e.Boolean=2]="Boolean",e[e.Number=3]="Number",e[e.String=4]="String",e[e.Buffer=5]="Buffer",e[e.Function=6]="Function"}(o||(o={}))},28488:(e,t,s)=>{s.r(t),s.d(t,{AnnotationMetaDataChangeEvent:()=>h.L,AnonymizedOperationEvent:()=>o.O,CircuitBreakerStateChangeEvent:()=>g,HttpRequestQueueEvent:()=>c.F,HttpSocketListEvent:()=>u.k,OperationEvent:()=>n.A,OutboundHttpRequestEvent:()=>l.g,PrivacyGuardIssueEvent:()=>C.F,ProcessIdentificationEvent:()=>r.m,ScenarioStatsEvent:()=>_.A,SessionHealthEvent:()=>y.R,SessionHealthEventAggregation:()=>T.Z,SessionIssueEvent:()=>f.Q,SessionStatsEvent:()=>m,WorkflowOperationEvent:()=>a});var o=s(42748),n=s(524243),i={util:{},roots:{default:{}}},a=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.count=0,e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.durationMs=0,e.prototype.success=!1,e.prototype.resultDescription="",e.prototype.resultSignature="",e.prototype.operationName="",e.prototype.resourceId="",e.prototype.dimension0="",e.prototype.dimension1="",e.prototype.dimension2="",e.prototype.dimension3="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.workflow="",e.prototype.joinContextId="",e.prototype.ariaTenant="",e.prototype.ariaNamespace="",e.prototype.dataFields="",e.prototype.userDataBoundaryType="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/WorkflowOperationEvent"},e}()),r=s(795048),c=s(463192),l=s(563485),u=s(441759),p={util:{},roots:{default:{}}},g=(p.util,p.roots.default||(p.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.group="",e.prototype.name="",e.prototype.state=0,e.prototype.failurePercent=0,e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/CircuitBreakerStateChangeEvent"},e}()),h=s(1193),d={util:{},roots:{default:{}}},m=(d.util,d.roots.default||(d.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.sessionKey="",e.prototype.healthy=!1,e.prototype.fullLogs=!1,e.prototype.traceId="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientAppVersion="",e.prototype.clientSessionId="",e.prototype.clientRuntimeVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientUserAgent="",e.prototype.isClientTelemetrySampled=!1,e.prototype.clientDocSessionId="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.userOid="",e.prototype.protocolVersion=0,e.prototype.totalDurationMs=0,e.prototype.idleDurationMs=0,e.prototype.closeReason="",e.prototype.firstClientConnectionDurationMs=0,e.prototype.seedMode="",e.prototype.seedSuccess=!1,e.prototype.seedItems=0,e.prototype.seedMessageCount=0,e.prototype.seedBatchSize=0,e.prototype.seedGroupSize=0,e.prototype.seedDurationMs=0,e.prototype.sendMessageCount=0,e.prototype.sendMessageErrors=0,e.prototype.sendMessageWarnings=0,e.prototype.sendMessageDurationMsMax=0,e.prototype.processMessageCount=0,e.prototype.processMessageErrors=0,e.prototype.processMessageWarnings=0,e.prototype.processMessageDurationMsMax=0,e.prototype.syncMessageCount=0,e.prototype.syncMessagesOutOfSequence=0,e.prototype.syncMessagesAbandoned=0,e.prototype.syncMessagesIgnored=0,e.prototype.syncMessageQueueLimitReached=!1,e.prototype.modelItemsMax=0,e.prototype.modelSizeInKb=0,e.prototype.modelConsistencyErrors=0,e.prototype.modelItemsCountBucket="",e.prototype.modelConsistencyErrorsAndWarnings=0,e.prototype.modelConsistencyQuietStateValid=!1,e.prototype.modelConsistencyQuietStateWarnings=0,e.prototype.modelConsistencyQuietStateErrors=0,e.prototype.documentUrlAvailable=!1,e.prototype.documentUrlWasProvided=!1,e.prototype.workflowsRegistered=0,e.prototype.workflowExecutions=0,e.prototype.workflowExecutionErrors=0,e.prototype.workflowExecutionDurationMsMax=0,e.prototype.workflowExecutionInfraErrors=0,e.prototype.annotationTypesActivated=0,e.prototype.annotationsAdded=0,e.prototype.annotationsUpdated=0,e.prototype.annotationsDeleted=0,e.prototype.augLoopLowPrivilegeTokenExistenceStatus="",e.prototype.augLoopLowPrivilegeTokenFirstArrivalDurationMs=0,e.prototype.wacTokenProvisionTokenExistenceStatus="",e.prototype.wacTokenProvisionTokenFirstArrivalDurationMs=0,e.prototype.seedingWorkflowPerformanceTimesValid=!1,e.prototype.timeFromFirstSeedMessageToFirstWorkflowFinishedMs=0,e.prototype.timeFromFirstSeedMessageToFirstAnnotationMs=0,e.prototype.timeFromFirstSeedMessageToLastAnnotationMs=0,e.prototype.timeFromFirstSeedMessageToLastWorkflowFinishedMs=0,e.prototype.timeFromLastSeedMessageToLastAnnotationMs=0,e.prototype.timeFromLastSeedMessageToLastWorkflowFinishedMs=0,e.prototype.syncMessagesWorkflowPerformanceNotMeasured=0,e.prototype.timeToAllWorkflowsFinishedMsMax=0,e.prototype.timeFromSessionStartToLastWorkflowFinishedMs=0,e.prototype.healthBucket="",e.prototype.coreHealthBucket="",e.prototype.coreHealthReason="",e.prototype.coreHealthBucketWithSuppressions="",e.prototype.coreHealthReasonWithSuppressions="",e.prototype.healthReason="",e.prototype.healthReasonCategory="",e.prototype.healthBucketWithSuppressions="",e.prototype.healthReasonWithSuppressions="",e.prototype.healthReasonCategoryWithSuppressions="",e.prototype.eventAnalysisFindings="",e.prototype.mappedHealthBucketsToReasons="",e.prototype.userDataBoundaryType="",e.prototype.ecsConfigIDs="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SessionStatsEvent"},e}()),y=s(108783),T=s(978632),f=s(563308),_=s(973330),C=s(297546)},32359:(e,t,s)=>{var o,n,i,a,r,c;s.d(t,{$O:()=>i,El:()=>r,Y3:()=>o,o2:()=>n,sP:()=>c,wM:()=>a}),function(e){e.UNKNOWN="Unknown",e.CONNECTION_RETRY="ConnectionRetry",e.CONNECTION_RETRY_FAILURE="ErrorConnectionRetryFailure",e.SPEECH_HANDLER_WS_FAILURE="ErrorSpeechHandlerWebSocketFailure",e.PROTOBUF_DESERIALIZATION_FAILURE="ErrorProtobufDeserializationFailure",e.EXPLICITLY_DISABLED="ExplicitlyDisabled",e.SPEECH_RECOGNITION_CANCELED="ErrorSpeechRecognitionCanceled"}(o||(o={})),function(e){e.INTERMITTENT="Intermittent",e.FINAL="Final"}(n||(n={})),function(e){e.NO_DICTATION="NoDictation",e.NO_COMMANDING="NoCommanding",e.NO_TOKEN="NoPfaToken"}(i||(i={})),function(e){e.version1="1",e.version2="2"}(a||(a={})),function(e){e[e.NoMatch=0]="NoMatch"}(r||(r={})),function(e){e.INTERNAL_ERROR="INTERNAL_ERROR",e.UNSUPPORTED_FILE_FORMAT="UNSUPPORTED_FILE_FORMAT",e.UPLOADING="UPLOADING",e.PROCESSING="PROCESSING",e.DELETED="DELETED",e.FILE_NOT_EXIST="FILE_NOT_EXIST",e.FILE_DECODE_ERROR="FILE_DECODE_ERROR",e.REQUEST_TIMEOUT_ERROR="REQUEST_TIMEOUT_ERROR"}(c||(c={}))},42748:(e,t,s)=>{s.d(t,{O:()=>n});var o={util:{},roots:{default:{}}},n=(o.util,o.roots.default||(o.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.operationName="",e.prototype.key="",e.prototype.value="",e.prototype.buildVersion="",e.prototype.datafield0="",e.prototype.datafield1="",e.prototype.datafield2="",e.prototype.datafield3="",e.prototype.tagId=0,e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/AnonymizedOperationEvent"},e}())},47717:(e,t,s)=>{var o,n,i,a,r,c,l,u,p,g,h,d,m,y,T,f,_,C,S,A,v,N,E,I,w,b,k,M,L,B,D,P;s.d(t,{HZ:()=>j,YA:()=>n,_I:()=>$,f$:()=>a,gL:()=>m,h2:()=>x,n3:()=>P,o5:()=>b}),function(e){e[e.Read=0]="Read",e[e.ReadMetadata=1]="ReadMetadata",e[e.Create=2]="Create"}(o||(o={})),function(e){e.PowerPoint="PowerPoint",e.Excel="Excel",e.Word="Word",e.OneNote="OneNote",e.Outlook="Outlook",e.Teams="Teams",e.Event="Event",e.Meeting="Meeting",e.TeamsMeeting="TeamsMeeting",e.TeamsQueues="TeamsQueues",e.SharePoint="SharePoint",e.Web="Web",e.PDF="PDF",e.Zip="Zip",e.HTML="HTML",e.Visio="Visio",e.Image="Image",e.Fluid="Fluid",e.Video="Video",e.Vector="Vector",e.Txt="Txt",e.ThirdParty="ThirdParty",e.Topic="Topic",e.Loop="Loop",e.Planner="Planner"}(n||(n={})),function(e){e[e.ChatResponse=0]="ChatResponse",e[e.GetMessagesResponse=1]="GetMessagesResponse",e[e.GetConversationResponse=2]="GetConversationResponse",e[e.GetSharedMessagesResponse=3]="GetSharedMessagesResponse",e[e.CopyConversationResponse=4]="CopyConversationResponse",e[e.SerpCachedResponse=5]="SerpCachedResponse",e[e.CaptchaResponse=6]="CaptchaResponse"}(i||(i={})),function(e){e.Default="Default",e.Early="Early",e.OnUse="OnUse",e.Never="Never"}(a||(a={})),function(e){e[e.None=0]="None",e[e.Allow=1]="Allow",e[e.AlwaysAllow=2]="AlwaysAllow",e[e.Deny=3]="Deny"}(r||(r={})),function(e){e.Quiet="0",e.Verbose="1"}(c||(c={})),function(e){e.TurnBased="turnbased",e.Realtime="realtime",e.All="all"}(l||(l={})),function(e){e.Full="Full",e.Concise="Concise",e.ConciseWithPadding="ConciseWithPadding"}(u||(u={})),function(e){e.Text="text",e.Video="video",e.Voice="voice"}(p||(p={})),function(e){e.Unknown="Unknown",e.TeamsToolKit="TeamsToolKit",e.CopilotStudioFamily="CopilotStudioFamily",e.SharePoint="SharePoint",e.CopilotStudio="CopilotStudio",e.EmbeddedCopilotStudio="EmbeddedCopilotStudio",e.Notebook="Notebook"}(g||(g={})),function(e){e.WordDraftingAgent="WordDraftingAgent"}(h||(h={})),function(e){e.SharePoint="SharePoint",e.OneDrive="OneDrive",e.DeepResearch="DeepResearch",e.GraphicArt="GraphicArt",e.CodeInterpreter="CodeInterpreter",e.WebSearch="WebSearch",e.OneDriveAndSharePoint="OneDriveAndSharePoint",e.GraphConnectors="GraphConnectors",e.TeamsMessages="TeamsMessages",e.Dataverse="Dataverse",e.RegisteredPlugins="RegisteredPlugins",e.Email="Email",e.BizchatExperimental="BizchatExperimental",e.People="People",e.DeepResearchWork="DeepResearchWork",e.ScenarioModels="ScenarioModels",e.Pages="Pages",e.DeepInsightsViaCodeExecution="DeepInsightsViaCodeExecution",e.EmbeddedKnowledge="EmbeddedKnowledge",e.FirstPartyAgent="FirstPartyAgent",e.Meetings="Meetings",e.EnterpriseGrounding="EnterpriseGrounding",e.Photo="Photo",e.WorkSearch="WorkSearch",e.ServiceDRI="ServiceDRI",e.ComputerUse="ComputerUse"}(d||(d={})),function(e){e.Unknown="Unknown",e.Success="Success",e.InternalError="InternalError",e.InvalidSession="InvalidSession",e.ConfigurationError="ConfigurationError",e.InvalidRequest="InvalidRequest",e.ProcessingMessage="ProcessingMessage",e.UnauthorizedRequest="UnauthorizedRequest",e.UnexpectedError="UnexpectedError",e.Canceled="Canceled",e.CaptchaChallenge="CaptchaChallenge",e.Throttled="Throttled",e.NotFound="NotFound",e.NoResponseReturned="NoResponseReturned",e.ThrottledByLLM="ThrottledByLLM",e.NoResponseText="NoResponseText",e.ApologyResponseReturned="ApologyResponseReturned",e.NoValidMessageTypePresentInBotResponse="NoValidMessageTypePresentInBotResponse",e.ServiceNotEnabled="ServiceNotEnabled",e.ContentForbidden="ContentForbidden",e.ContentNotFound="ContentNotFound",e.InvalidLicense="InvalidLicense",e.NotEnoughContext="NotEnoughContext",e.OutOfCredits="OutOfCredits",e.VoiceSystemSignal="VoiceSystemSignal"}(m||(m={})),function(e){e.Success="Success",e.Failure="Failure",e.Pending="Pending",e.BotTurnStarting="BotTurnStarting"}(y||(y={})),function(e){e.Audio="audio",e.Text="text"}(T||(T={})),function(e){e.SearchWeb="SearchWeb",e.EnterpriseFileSearch="EnterpriseFileSearch",e.CodeInterpreter="CodeInterpreter"}(f||(f={})),function(e){e.Error="Error",e.Warning="Warning"}(_||(_={})),function(e){e[e.None=0]="None",e[e.MessagesDeleted=1]="MessagesDeleted"}(C||(C={})),function(e){e.MissingName="MissingName",e.TooLongName="TooLongName",e.InvalidCharacterInName="InvalidCharacterInName",e.MissingDescription="MissingDescription",e.TooLongDescription="TooLongDescription",e.InvalidCharacterInDescription="InvalidCharacterInDescription",e.MissingInstructions="MissingInstructions",e.TooLongInstructions="TooLongInstructions",e.InvalidCharacterInInstructions="InvalidCharacterInInstructions",e.InvalidIconUrl="InvalidIconUrl",e.InvalidGptId="InvalidGptId",e.TooManyConversationStarters="TooManyConversationStarters",e.InvalidCharacterInConversationStarter="InvalidCharacterInConversationStarter",e.InvalidConversationStarterImageUrl="InvalidConversationStarterImageUrl",e.TooLongConversationStarter="TooLongConversationStarter",e.MissingPluginShortName="MissingPluginShortName",e.TooLongShortName="TooLongShortName",e.InvalidCharacterInShortName="InvalidCharacterInShortName",e.MissingPluginLongName="MissingPluginLongName",e.TooLongLongName="TooLongLongName",e.InvalidCharacterInLongName="InvalidCharacterInLongName",e.MissingPluginShortDescription="MissingPluginShortDescription",e.TooLongShortDescription="TooLongShortDescription",e.InvalidCharacterInShortDescription="InvalidCharacterInShortDescription",e.MissingPluginFullDescription="MissingPluginFullDescription",e.TooLongFullDescription="TooLongFullDescription",e.InvalidCharacterInFullDescription="InvalidCharacterInFullDescription",e.MissingPluginFunction="MissingPluginFunction",e.MissingFunctionId="MissingFunctionId",e.TooLongFunctionId="TooLongFunctionId",e.InvalidCharacterInFunctionId="InvalidCharacterInFunctionId",e.MissingFunctionTitle="MissingFunctionTitle",e.TooLongFunctionTitle="TooLongFunctionTitle",e.InvalidCharacterInFunctionTitle="InvalidCharacterInFunctionTitle",e.MissingFunctionDescription="MissingFunctionDescription",e.TooLongFunctionDescription="TooLongFunctionDescription",e.InvalidCharacterInFunctionDescription="InvalidCharacterInFunctionDescription",e.MissingParameterName="MissingParameterName",e.TooLongParameterName="TooLongParameterName",e.InvalidCharacterInParameterName="InvalidCharacterInParameterName",e.MissingParameterDescription="MissingParameterDescription",e.TooLongParameterDescription="TooLongParameterDescription",e.InvalidCharacterInParameterDescription="InvalidCharacterInParameterDescription",e.MissingParameterTitle="MissingParameterTitle",e.TooLongParameterTitle="TooLongParameterTitle",e.InvalidCharacterInParameterTitle="InvalidCharacterInParameterTitle",e.InvalidTeamsMessagesCapabilityUrl="InvalidTeamsMessagesCapabilityUrl",e.OffensiveContent="OffensiveContent",e.Jailbreak="Jailbreak",e.RAIViolation="RAIViolation"}(S||(S={})),function(e){e.None="None",e.Limit="Limit",e.Billing="Billing"}(A||(A={})),function(e){e.ActionMETaskModule="ActionMETaskModule",e.AuthenticationCard="AuthenticationCard",e.CodeInterpreter="CodeInterpreter",e.ConfirmationCard="ConfirmationCard",e.GraphicArt="GraphicArt",e.MultiMessageResponse="MultiMessageResponse"}(v||(v={})),function(e){e.User="User",e.Tenant="Tenant",e.System="System"}(N||(N={})),function(e){e.Unknown="Unknown",e.User="User",e.Tenant="Tenant",e.System="System"}(E||(E={})),function(e){e.Active="Active",e.Draft="Draft",e.Deleted="Deleted",e.Blocked="Blocked"}(I||(I={})),function(e){e.Bot="bot",e.User="user",e.System="system"}(w||(w={})),function(e){e.AnnRules="AnnRules",e.Apology="Apology",e.BingContent="Bing Content",e.Chitchat="Chitchat",e.NluDirectResponse="NluDirectResponse",e.Qna="Qna",e.TopicChanger="TopicChanger",e.Delighterdluni="Delighterdluni",e.DeepLeo="DeepLeo",e.TransformContent="transform_content",e.LocalPluginRunner="local-plugin-runner",e.ImageChat="image-chat",e.GenerateResponse="generate_response"}(b||(b={})),function(e){e.Image="IMAGE"}(k||(k={})),function(e){e.WebPage="WebPage",e.ClientApp="ClientApp"}(M||(M={})),function(e){e.None="None",e.Positive="Positive",e.Negative="Negative",e.Laugh="Laugh",e.Surprised="Surprised",e.UnknownBf="UnknownBf"}(L||(L={})),function(e){e.Keyboard="Keyboard",e.Speech="Speech"}(B||(B={})),function(e){e.AudioUrl="AudioUrl",e.None="None",e.Simple="Simple",e.Ssml="Ssml"}(D||(D={})),function(e){e.ActionRequest="ActionRequest",e.Ads="Ads",e.AdsQuery="AdsQuery",e.Any="Any",e.AuthError="AuthError",e.ChatCompleted="ChatCompleted",e.CaptchaChallenge="CaptchaChallenge",e.Chat="Chat",e.ChatName="ChatName",e.ConfirmationCard="ConfirmationCard",e.Context="Context",e.Disengaged="Disengaged",e.SearchQuery="SearchQuery",e.Internal="Internal",e.InvokeAction="InvokeAction",e.Suggestion="Suggestion",e.InternalSuggestions="InternalSuggestions",e.InternalSearchResult="InternalSearchResult",e.InternalSearchQuery="InternalSearchQuery",e.InternalReasoningSearchResult="InternalReasoningSearchResult",e.InternalActionMarker="InternalActionMarker",e.InternalStateMarker="InternalStateMarker",e.InternalLoaderMessage="InternalLoaderMessage",e.Progress="Progress",e.GenerateContentQuery="GenerateContentQuery",e.GeneratedCode="GeneratedCode",e.RenderCardRequest="RenderCardRequest",e.RequireHumanInTheLoop="RequireHumanInTheLoop",e.SemanticSerp="SemanticSerp",e.ResumePluginAuth="ResumePluginAuth",e.TriggerPluginAuth="TriggerPluginAuth",e.ResumeInvokeAction="ResumeInvokeAction",e.TriggerConfirmation="TriggerConfirmation",e.InternalContentDescription="InternalContentDescription",e.TriggerPlugin="TriggerPlugin",e.CompletePlugin="CompletePlugin",e.AttachmentAction="AttachmentAction"}(P||(P={}));new Set([P.Chat,P.ChatCompleted,P.Disengaged,P.RenderCardRequest,P.RequireHumanInTheLoop]);var R,O,x,F,G,W,H,U,q,V,$,j,z,K;!function(e){e.IncomingBotResponse=void 0}(P||(P={})),function(e){e.Blank="BLANK",e.BingFrontPageSkill="BING_FRONT_PAGE_SKILL",e.BingSkill="BING_SKILL",e.Chitchat="CHITCHAT",e.Infoseeking="INFOSEEKING",e.InitialBingFrontPageSkill="INITIAL_BING_FRONT_PAGE_SKILL",e.InitialQNA="INITIAL_QNA",e.InitialVideos="INITIAL_VIDEOS",e.InitialWebpages="INITIAL_WEBPAGES",e.MedicalHealth="MEDICAL_HEALTH",e.MicrosoftBrands="MICROSOFT_BRANDS",e.NeedEmpathy="NEED_EMPATHY",e.Offensive="OFFENSIVE",e.OpinionGiving="OPINION_GIVING",e.OpinionSeeking="OPINION_SEEKING",e.OUTOFDomain="OUT_OF_DOMAIN",e.QNA="QNA",e.SettingsChange="SETTINGS_CHANGE",e.SettingsCheck="SETTINGS_CHECK",e.SuicideHelp="SUICIDE_HELP",e.TuringBOTSafe="TURING_BOT_SAFE",e.Unhandled="UNHANDLED",e.Videos="VIDEOS",e.Webpages="WEBPAGES"}(R||(R={})),function(e){e.Amount="AMOUNT",e.Setting="SETTING",e.Type="TYPE",e.Unknown="UNKNOWN",e.Unit="UNIT",e.Value="VALUE"}(O||(O={})),function(e){e.Unknown="Unknown",e.None="None",e.Offensive="Offensive",e.OffenseTrigger="OffenseTrigger",e.OffenseResponse="OffenseResponse",e.Blocklist="Blocklist"}(x||(x={})),function(e){e.Finished="FINISHED",e.Intermediate="INTERMEDIATE",e.FinishedAwaitingCommit="FINISHED_AWAITING_COMMIT"}(F||(F={})),function(e){e.General="General",e.Internal="Internal"}(G||(G={})),function(e){e.Testing="Testing",e.AdminCenterCopilot="AdminCenterCopilot",e.AIHubAppChatCopilot="AIHubAppChatCopilot",e.AIHubBrowseCopilot="AIHubBrowseCopilot",e.AIHubHome="AIHubHome",e.Assist365Copilot="Assist365Copilot",e.BizChatScheduledActions_MacOutlookHub="BizChatScheduledActions_MacOutlookHub",e.BizChatScheduledActions_MonarchHub="BizChatScheduledActions_MonarchHub",e.BizChatScheduledActions_OfficeDesktop="BizChatScheduledActions_OfficeDesktop",e.BizChatScheduledActions_OfficeWeb="BizChatScheduledActions_OfficeWeb",e.BizChatScheduledActions_OwaHub="BizChatScheduledActions_OwaHub",e.BizChatScheduledActions_TeamsHub="BizChatScheduledActions_TeamsHub",e.BizChatScheduledActions_Win32OutlookHub="BizChatScheduledActions_Win32OutlookHub",e.CopilotClips="CopilotClips",e.ExcelCopilot="ExcelCopilot",e.ExcelCopilotConsumer="ExcelCopilotConsumer",e.ExcelCopilotConsumerOSv2="ExcelCopilotConsumerOSv2",e.ExchangeAdminCenterCopilot="ExchangeAdminCenterCopilot",e.FormsCopilot="FormsCopilot",e.LoopCopilot="LoopCopilot",e.LoopCopilotOnCanvas="LoopCopilotOnCanvas",e.ODSPCopilot="ODSPCopilot",e.OfficeAiAppIncubation="OfficeAiAppIncubation",e.OfficeCopilotSearchAnswer="OfficeCopilotSearchAnswer",e.OfficePersonalAgentsCopilot="OfficePersonalAgentsCopilot",e.OneNoteCopilot="OneNoteCopilot",e.OneNoteCopilotConsumer="OneNoteCopilotConsumer",e.OneNoteCopilotConsumerOSv2="OneNoteCopilotConsumerOSv2",e.OperaWordCopilot="OperaWordCopilot",e.OutlookCopilot="OutlookCopilot",e.OutlookCopilotBizchatBase="OutlookCopilotBizchatBase",e.OutlookCopilotConsumerOSv2="OutlookCopilotConsumerOSv2",e.OutlookSearchChatCopilot="outlooksearchchatcopilot",e.PodcastCopilot="PodcastCopilot",e.PPTCopilot="PPTCopilot",e.PPTCopilotConsumer="PPTCopilotConsumer",e.PPTCopilotConsumerOSv2="PPTCopilotConsumerOSv2",e.PPTOnCanvasCopilot="PPTOnCanvasCopilot",e.PlannerCopilot="PlannerCopilot",e.SharePointAdminCenterCopilot="SharePointAdminCenterCopilot",e.SharepointAuthoringCopilot="SharepointAuthoringCopilot",e.StreamCopilot="StreamCopilot",e.TeamsAdminCenterCopilot="TeamsAdminCenterCopilot",e.TeamsChatAgentCopilot="TeamsChatAgentCopilot",e.TeamsQueuesIntelligence="TeamsQueuesIntelligence",e.TeamsChatCopilot="TeamsChatCopilot",e.TeamsMessagesSerpAICopilot="TeamsMessagesSerpAICopilot",e.TeamsSerpCopilot="TeamsSerpCopilot",e.TeamsGroupCopilot="TeamsGroupCopilot",e.TeamsMeetingCopilot="teamsmeetingcp",e.TeamsMeetingGroupCopilot="TeamsMeetingGroupCopilot",e.TeamsWorkflowsCopilotActions="TeamsWorkflowsCopilotActions",e.VivaCopilot="VivaCopilot",e.VivaEngageCopilot="VivaEngageCopilot",e.VivaGoalsCopilot="VivaGoalsCopilot",e.WhiteboardCopilotOnCanvas="WhiteboardCopilotOnCanvas",e.WordCopilot="WordCopilot",e.WordBackstageCopilot="WordBackstageCopilot",e.WordCopilotConsumer="WordCopilotConsumer",e.WordCopilotConsumerOsv2="WordCopilotConsumerOSv2",e.WordOnCanvasCopilot="WordOnCanvasCopilot",e.LegacyDefault="Default",e.RealtimeChat="AugmentationLoopRealTimeChat",e.AIHubCreateCopilot="AIHubCreateCopilot",e.OfficeCopilotNotebook="OfficeCopilotNotebook"}(W||(W={}));!function(e){e.Creative="Creative",e.Balanced="Balanced",e.Precise="Precise"}(H||(H={})),function(e){e.AppChat="appchat"}(U||(U={})),function(e){e.Default="Default",e.Reasoning="Reasoning",e.Responding="Responding"}(q||(q={})),function(e){e.AdaptiveCard="AdaptiveCard"}(V||(V={})),function(e){e[e.InternalError=-32603]="InternalError",e[e.InvalidParams=-32602]="InvalidParams",e[e.InvalidRequest=-32600]="InvalidRequest",e[e.InvocationError=-32e3]="InvocationError",e[e.InvocationErrorWithException=-32004]="InvocationErrorWithException",e[e.MethodNotFound=-32601]="MethodNotFound",e[e.NoMarshaledObjectFound=-32001]="NoMarshaledObjectFound",e[e.ParseError=-32700]="ParseError",e[e.RequestCanceled=-32800]="RequestCanceled",e[e.ResponseSerializationFailure=-32003]="ResponseSerializationFailure"}($||($={})),function(e){e.SUCCESS="success",e.FAILURE="failure"}(j||(j={})),function(e){e.AlwaysOn="AlwaysOn",e.Dynamic="Dynamic"}(z||(z={})),function(e){e.Document="document",e.Workbook="workbook",e.Presentation="presentation"}(K||(K={}))},52076:(e,t,s)=>{s.d(t,{X8:()=>T});var o=s(357635),n=s(599243),i=s(596498),a=s(241798),r=s(972091),c=s(120501),l=s(309708),u=s(775352),p=s(20213),g=s(125952);class h{constructor(e){this.outlookDataHandle=e}getLocalPeopleData(){const e=this.outlookDataHandle.getAllRecipients(),t=[];for(const s of e)t.push({DisplayName:s.displayName,EmailAddresses:[s.emailAddress],Id:s.id,confidence:0,entityType:"",providerName:"",text:""});return t}}const d=new Map([["AugLoop_GraphSearch_SearchSuggestionsRequest",0],["AugLoop_ObservationalAssistance_UserInitiatedRequestClient",1],["AugLoop_GraphIntentDetection_SystemInitiatedWithIntentClient",2]]);class m extends p.c{constructor(e,t){super("GraphSearchWorkflowInstance",e,t)}async execute(e,t,s){var o;let a=!1,r=!1;const u=new Date,p=this.startLogOperation("GraphSearchWorkflowExecute",u);this.logWasmStats(p);const g=d.get(i.h.getTypeNameFor(e));void 0!==g&&p.setDataFields({scenario:g}),(l.VP.typeGuard(e)||c.iU.typeGuard(e))&&(p.setDataFields({conversationId:e.conversationId,logicalId:e.logicalId,sessionId:t.clientMetadata.sessionId}),c.iU.typeGuard(e)&&0===(null===(o=e.multiIntents)||void 0===o?void 0:o.length)&&(r=!0)),a=this.executeWorkflowLambda(p,e,t,s),r&&!a||n.tG.info(509638755,n.nh.WorkflowDefault,p.stop())}}const y=(e,t)=>new m(e,t),T=(e,t)=>{const s=t.localContext?new h(t.localContext):null;return o.z.create("GraphSearchLocalWorkflowOA").setStateful().setInputTypes([a.$9.getTypeName(),c.iU.getTypeName(),l.VP.getTypeName(),a.zV.getTypeName()]).setOutputTypes([r.nm.getTypeName(),r.t9.getTypeName(),u.SM.getTypeName(),r.NG.getTypeName(),a.tE.getTypeName(),r.rQ.getTypeName(),r.xz.getTypeName()]).setLambdaType(y.bind(null,{...e,localContext:s},t))};f=g.aU,_=g.zb,o.z.create("GraphSearchLocalWorkflow").setStateful().setInputTypes([a.$9.getTypeName(),a.Z5.getTypeName(),a.zV.getTypeName()]).setOutputTypes([r.J_.getTypeName(),a.tE.getTypeName(),r.rQ.getTypeName(),r.xz.getTypeName()]).setLambdaType(y.bind(null,f,_));var f,_},59765:(e,t,s)=>{var o;s.d(t,{D:()=>n,T:()=>o}),function(e){e[e.JoinContext=0]="JoinContext",e[e.Session=1]="Session"}(o||(o={}));class n extends Error{constructor(e="ExpectedError"){super(e),this.__proto__=n.prototype}}},61431:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AudioStreamPerfTracker=t.RunningAveragesTracker=t.getOffsetAndDurationInMs=void 0;var o=s(274070),n=s(965787);t.getOffsetAndDurationInMs=function(e){return{offsetMs:e.Offset/1e4,durationMs:e.Duration/1e4}};var i=function(){function e(){this.count=0,this.total={service:0,perceived:0},this.min={service:Number.MAX_VALUE,perceived:Number.MAX_VALUE},this.max={service:0,perceived:0}}return e.prototype.add=function(e){this.count++,this.total.perceived+=e.perceived,this.total.service+=e.service,this.min.perceived=Math.min(e.perceived,this.min.perceived),this.min.service=Math.min(e.service,this.min.service),this.max.perceived=Math.max(e.perceived,this.max.perceived),this.max.service=Math.max(e.service,this.max.service)},e.prototype.getAverages=function(){return 0===this.count?{perceived:-1,service:-1}:{perceived:this.total.perceived/this.count,service:this.total.service/this.count}},e}();t.RunningAveragesTracker=i;var a=function(){function e(e,t){this.finals=new i,this.partials=new i,this.getNow=n.now,this.list=[],this.maxListLength=e,this.warnListLength=.8*e,this.getNow=null!=t?t:n.now}return Object.defineProperty(e.prototype,"length",{get:function(){return this.list.length},enumerable:!1,configurable:!0}),e.prototype.getChunk=function(e){return this.list[e]},e.prototype.track=function(e,t,s){var n={audioStart:e-t,audioEnd:e,localEnd:this.getNow(),seq:s},i=this.list.length-1;if(-1===i||n.audioStart>=this.list[i].audioEnd)this.list.push(n);else if(n.audioEnd<=this.list[0].audioStart)this.list.unshift(n);else{for(;i>0&&n.audioEnd<this.list[i].audioStart;)i--;if(i>=0&&n.audioStart===this.list[i].audioStart)throw new Error("Why are we double tracking the same chunk of audio? newChunk: ".concat(JSON.stringify(n),", existing chunk: ").concat(JSON.stringify(this.list[i])));this.list.splice(i,0,n)}if(this.list.length>this.maxListLength){var a=this.list.length-this.maxListLength;this.list.splice(0,a),o.Log.warn(572662883,o.LogCategory.WorkflowDefault,"AudioStreamPerfTracker.track: list length has exceeded max by ".concat(a," items!"))}else this.list.length>=this.warnListLength&&o.Log.warn(572662912,o.LogCategory.WorkflowDefault,"AudioStreamPerfTracker.track: list length: ".concat(this.list.length," approaching max: ").concat(this.maxListLength))},e.prototype.trimBefore=function(e){if(0!==this.list.length){for(var t="".concat(this.list[0].audioStart," to ").concat(this.list[this.list.length-1].audioEnd),s=0;s<this.list.length&&this.list[s].audioEnd<e;)s++;s===this.list.length&&o.Log.warn(561628760,o.LogCategory.WorkflowDefault,"AudioStreamPerfTracker.trimBefore: no match found for audioEnd: ".concat(e,". List length: ").concat(this.list.length,", audio span: ").concat(t));var n=this.list.splice(0,s),i=n.length>0?"".concat(n[0].audioStart," to ").concat(n[n.length-1].audioEnd):"none",a=this.list.length>0?"".concat(this.list[0].audioStart," to ").concat(this.list[this.list.length-1].audioEnd):"none";o.Log.info(572662914,o.LogCategory.WorkflowDefault,"AudioStreamPerfTracker.trimBefore: audioEnd: ".concat(e,", culling ").concat(n.length," chunks (audio span ").concat(i,"), new list.length: ").concat(this.list.length,". Audio span was: ").concat(t,", now: ").concat(a))}else o.Log.info(572662913,o.LogCategory.WorkflowDefault,"AudioStreamPerfTracker.trimBefore: list is empty - nothing to trim!")},e.prototype.clear=function(){o.Log.info(506045275,o.LogCategory.WorkflowDefault,"AudioStreamPerfTracker.clear: clearing all ".concat(this.list.length," entries")),this.list.splice(0,this.list.length)},e.prototype.getChunksFrom=function(e,t){for(var s,o,n=e+t,i=0;i<this.list.length&&(!s||!o);){var a=this.list[i];!s&&e>=a.audioStart&&e<=a.audioEnd&&(s=a),!o&&n>=a.audioStart&&n<=a.audioEnd&&(o=a),i++}return[s,o]},e.prototype.measureLatency=function(e,t,s){var n=this.getNow(),i=e+t,a=this.getChunksFrom(e,t),r=a[0],c=a[1];if(!r&&!c)return o.Log.warn(572662915,o.LogCategory.WorkflowDefault,"AudioStreamPerfTracker.getRelatedAudioChunks: Zero audio chunks not found for speechEnd: ".concat(i," (").concat(e," + ").concat(t,")")),{service:-1,perceived:-1};if(!r||!c){var l=r?"end":"start",u="none",p=NaN;this.list.length>0&&(u="".concat(this.list[0].audioStart," to ").concat(this.list[this.list.length-1].audioEnd),p=r?i-this.list[this.list.length-1].audioEnd:i-this.list[0].audioStart),o.Log.warn(572662916,o.LogCategory.WorkflowDefault,"AudioStreamPerfTracker.getRelatedAudioChunks: Expected audio chunk not found for ".concat(l," of audio, for speechEnd: ").concat(i," (").concat(e," + ").concat(t,"), tracked audio span: ").concat(u,", delta: ").concat(p))}var g=n-Math.max((null==r?void 0:r.localEnd)||0,(null==c?void 0:c.localEnd)||0),h=r?this.getLatencyForChunk(r,e,t,n):-1,d=c?this.getLatencyForChunk(c,i,0,n):-1,m={service:g,perceived:Math.max(h,d)};return(s?this.finals:this.partials).add(m),m},e.prototype.getLatencyForChunk=function(e,t,s,o){return o-(e.localEnd-(e.audioEnd-t))-s},e}();t.AudioStreamPerfTracker=a},65565:(e,t,s)=>{s.d(t,{C3:()=>a,H0:()=>i,bW:()=>r,f_:()=>n});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_ExcelAgentExperimental_ExcelAgentExperimentalSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_ExcelAgentExperimental_ExcelAgentExperimentalCancelQuerySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_ExcelAgentExperimental_ExcelAgentExperimentalCheckPermissionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_ExcelAgentExperimental_ExcelAgentExperimentalRunScriptResponseObject"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},68063:(e,t,s)=>{var o,n;s.d(t,{H:()=>o,n:()=>n}),function(e){e.GetTUIEverShownState="GetTUIEverShownState",e.SetTUIEverShownState="SetTUIEverShownState"}(o||(o={})),function(e){e.Success="Success",e.Failure="Failure"}(n||(n={}))},68580:(e,t,s)=>{var o;s.d(t,{i:()=>o}),function(e){e[e.Success=0]="Success",e[e.NoResults=1]="NoResults",e[e.Cancelled=2]="Cancelled",e[e.Timeout=3]="Timeout",e[e.UnexpectedError=4]="UnexpectedError",e[e.EarlyExit=5]="EarlyExit"}(o||(o={}))},69614:(e,t,s)=>{s.d(t,{$j:()=>E,B_:()=>R,D0:()=>x,F_:()=>g,GA:()=>I,Gs:()=>U,LQ:()=>y,Ol:()=>b,PR:()=>G,PY:()=>N,Qq:()=>w,Sy:()=>te,TV:()=>W,Tb:()=>L,VR:()=>B,YK:()=>i,Yp:()=>r,Zy:()=>f,_p:()=>p,eE:()=>d,eG:()=>Y,fZ:()=>D,fr:()=>q,g$:()=>X,gy:()=>J,i:()=>a,iT:()=>ie,kd:()=>O,l0:()=>M,lj:()=>Z,n4:()=>v,pr:()=>_,ru:()=>h,ry:()=>T,uN:()=>m,vG:()=>Q,w9:()=>C,wU:()=>ee,z_:()=>S});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Message"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Response"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_StreamingResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_StreamingRequest"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ExecutionError"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetAnnotationsClientError"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetAnnotationsErrorInfo"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){o.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TimeoutErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_ErrorResponse","AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){o.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_RateLimitErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_ErrorResponse","AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{constructor(e){o.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{constructor(e){o.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{constructor(e){o.h.assign(y,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionLongPollMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class T{constructor(e){o.h.assign(T,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionLongPollResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[T.getTypeName()])}}T.H_={T_:T.getTypeName(),B_:T.getBaseTypes()};class f{constructor(e){o.h.assign(f,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionCloseReason"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class _{constructor(e){o.h.assign(_,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionSwapOnClose"}static getBaseTypes(){return["AugLoop_Session_Protocol_SessionCloseReason"]}static typeGuard(e){return o.h.matchesTypesFor(e,[_.getTypeName()])}}_.H_={T_:_.getTypeName(),B_:_.getBaseTypes()};class C{constructor(e){o.h.assign(C,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionCloseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[C.getTypeName()])}}C.H_={T_:C.getTypeName(),B_:C.getBaseTypes()};class S{constructor(e){o.h.assign(S,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_CacheDumpRequestMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[S.getTypeName()])}}S.H_={T_:S.getTypeName(),B_:S.getBaseTypes()};class A{constructor(e){o.h.assign(A,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_CacheDumpRequestResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[A.getTypeName()])}}A.H_={T_:A.getTypeName(),B_:A.getBaseTypes()};class v{constructor(e){o.h.assign(v,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationActivationMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[v.getTypeName()])}}v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class N{constructor(e){o.h.assign(N,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationActivationResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[N.getTypeName()])}}N.H_={T_:N.getTypeName(),B_:N.getBaseTypes()};class E{constructor(e){o.h.assign(E,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationResultStateMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[E.getTypeName()])}}E.H_={T_:E.getTypeName(),B_:E.getBaseTypes()};class I{constructor(e){o.h.assign(I,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationReleaseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[I.getTypeName()])}}I.H_={T_:I.getTypeName(),B_:I.getBaseTypes()};class w{constructor(e){o.h.assign(w,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationReleaseResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[w.getTypeName()])}}w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class b{constructor(e){o.h.assign(b,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[b.getTypeName()])}}b.H_={T_:b.getTypeName(),B_:b.getBaseTypes()};class k{constructor(e){o.h.assign(k,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[k.getTypeName()])}}k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()};class M{constructor(e){o.h.assign(M,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_BatchedMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[M.getTypeName()])}}M.H_={T_:M.getTypeName(),B_:M.getBaseTypes()};class L{constructor(e){o.h.assign(L,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SyncMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[L.getTypeName()])}}L.H_={T_:L.getTypeName(),B_:L.getBaseTypes()};class B{constructor(e){o.h.assign(B,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_MicroSyncMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[B.getTypeName()])}}B.H_={T_:B.getTypeName(),B_:B.getBaseTypes()};class D{constructor(e){o.h.assign(D,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SyncResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[D.getTypeName()])}}D.H_={T_:D.getTypeName(),B_:D.getBaseTypes()};class P{constructor(e){o.h.assign(P,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionDeleteMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[P.getTypeName()])}}P.H_={T_:P.getTypeName(),B_:P.getBaseTypes()};class R{constructor(e){o.h.assign(R,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationResultsMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SyncMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[R.getTypeName()])}}R.H_={T_:R.getTypeName(),B_:R.getBaseTypes()};class O{constructor(e){o.h.assign(O,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TokenProvisionMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[O.getTypeName()])}}O.H_={T_:O.getTypeName(),B_:O.getBaseTypes()};class x{constructor(e){o.h.assign(x,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TokenFailureMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[x.getTypeName()])}}x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()};class F{constructor(e){o.h.assign(F,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TokenProvisionResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[F.getTypeName()])}}F.H_={T_:F.getTypeName(),B_:F.getBaseTypes()};class G{constructor(e){o.h.assign(G,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_KeepAlive"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[G.getTypeName()])}}G.H_={T_:G.getTypeName(),B_:G.getBaseTypes()};class W{constructor(e){o.h.assign(W,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowGraphInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[W.getTypeName()])}}W.H_={T_:W.getTypeName(),B_:W.getBaseTypes()};class H{constructor(e){o.h.assign(H,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowGraphInitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[H.getTypeName()])}}H.H_={T_:H.getTypeName(),B_:H.getBaseTypes()};class U{constructor(e){o.h.assign(U,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionCompleteMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SyncMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[U.getTypeName()])}}U.H_={T_:U.getTypeName(),B_:U.getBaseTypes()};class q{constructor(e){o.h.assign(q,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SeedingStatusChangeMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[q.getTypeName()])}}q.H_={T_:q.getTypeName(),B_:q.getBaseTypes()};class V{constructor(e){o.h.assign(V,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitV2Message"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[V.getTypeName()])}}V.H_={T_:V.getTypeName(),B_:V.getBaseTypes()};class ${constructor(e){o.h.assign($,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitV2Response"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[$.getTypeName()])}}$.H_={T_:$.getTypeName(),B_:$.getBaseTypes()};class j{constructor(e){o.h.assign(j,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[j.getTypeName()])}}j.H_={T_:j.getTypeName(),B_:j.getBaseTypes()};class z{constructor(e){o.h.assign(z,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[z.getTypeName()])}}z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()};class K{constructor(e){o.h.assign(K,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2CallbackMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[K.getTypeName()])}}K.H_={T_:K.getTypeName(),B_:K.getBaseTypes()};class Q{constructor(e){o.h.assign(Q,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_BridgeMessage"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[Q.getTypeName()])}}Q.H_={T_:Q.getTypeName(),B_:Q.getBaseTypes()};class J{constructor(e){o.h.assign(J,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionConnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[J.getTypeName()])}}J.H_={T_:J.getTypeName(),B_:J.getBaseTypes()};class Y{constructor(e){o.h.assign(Y,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionDisconnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[Y.getTypeName()])}}Y.H_={T_:Y.getTypeName(),B_:Y.getBaseTypes()};class Z{constructor(e){o.h.assign(Z,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionReconnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[Z.getTypeName()])}}Z.H_={T_:Z.getTypeName(),B_:Z.getBaseTypes()};class X{constructor(e){o.h.assign(X,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SubmittedCustomMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[X.getTypeName()])}}X.H_={T_:X.getTypeName(),B_:X.getBaseTypes()};class ee{constructor(e){o.h.assign(ee,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ServerAuthenticationStateChangeMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[ee.getTypeName()])}}ee.H_={T_:ee.getTypeName(),B_:ee.getBaseTypes()};class te{constructor(e){o.h.assign(te,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ClaimsChallengeMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[te.getTypeName()])}}te.H_={T_:te.getTypeName(),B_:te.getBaseTypes()};class se{constructor(e){o.h.assign(se,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_BlobUploadResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[se.getTypeName()])}}se.H_={T_:se.getTypeName(),B_:se.getBaseTypes()};class oe{constructor(e){o.h.assign(oe,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetPluginsMetadataMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[oe.getTypeName()])}}oe.H_={T_:oe.getTypeName(),B_:oe.getBaseTypes()};class ne{constructor(e){o.h.assign(ne,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetPluginsMetadataResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[ne.getTypeName()])}}ne.H_={T_:ne.getTypeName(),B_:ne.getBaseTypes()};class ie{constructor(e){o.h.assign(ie,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ExecutionCorrelatedClientResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[ie.getTypeName()])}}ie.H_={T_:ie.getTypeName(),B_:ie.getBaseTypes()}},70239:(e,t,s)=>{s.d(t,{I:()=>a,XP:()=>u,Xr:()=>c,fZ:()=>p,g0:()=>C,hW:()=>l,n4:()=>g,xU:()=>f});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Core_ItemDelta"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Core_ItemChangesDelta"}static getBaseTypes(){return["AugLoop_Core_ItemDelta"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Core_Operation"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_OperationWithSiblingContext"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Core_AddOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Core_UpdateAnnotationMetaDataOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Core_UpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){o.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Core_DeleteOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){o.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Core_PurgeOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{constructor(e){o.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Core_PurgeSubtreeExceptTypesOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{constructor(e){o.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Core_PurgeByTypesOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{constructor(e){o.h.assign(y,this,e)}static getTypeName(){return"AugLoop_Core_FocusOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class T{constructor(e){o.h.assign(T,this,e)}static getTypeName(){return"AugLoop_Core_VisibilityOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[T.getTypeName()])}}T.H_={T_:T.getTypeName(),B_:T.getBaseTypes()};class f{constructor(e){o.h.assign(f,this,e)}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class _{constructor(e){o.h.assign(_,this,e)}static getTypeName(){return"AugLoop_Core_MicroSyncOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[_.getTypeName()])}}_.H_={T_:_.getTypeName(),B_:_.getBaseTypes()};class C{constructor(e){o.h.assign(C,this,e)}static getTypeName(){return"AugLoop_Signals_SignalOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[C.getTypeName()])}}C.H_={T_:C.getTypeName(),B_:C.getBaseTypes()};class S{constructor(e){o.h.assign(S,this,e)}static getTypeName(){return"AugLoop_Core_CancelSignalTriggeredWorkflowExecutionOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[S.getTypeName()])}}S.H_={T_:S.getTypeName(),B_:S.getBaseTypes()}},73401:(e,t,s)=>{s.d(t,{E:()=>o});const o=e=>n(e,Number.POSITIVE_INFINITY),n=(e,t)=>{let s=0;const o=[],n=[e];for(;n.length>0;){const e=n.pop(),i=typeof e;if("boolean"===i)s+=4;else if("string"===i)s+=2*e.length;else if("number"===i)s+=8;else if("object"===i&&e&&-1===o.indexOf(e))if(e instanceof Uint8Array)s+=e.length;else{o.push(e);for(const t in e)n.push(e[t])}if(s>t)return s}return s}},83302:(e,t,s)=>{var o=s(72715);Object.defineProperty(t,"__esModule",{value:!0}),t.LogCategory=t.tagIdToString=t.getNumLoggers=t.logCategoryToString=t.argsToString=t.Log=void 0;const n=s(791177),i=s(622681),a=void 0!==o&&o.env?o.env.SERVICE_NAME:"client",r="abcdefghijklmnopqrstuvwxyz0123456789",c={97:0,98:1,99:2,100:3,101:4,102:5,103:6,104:7,105:8,106:9,107:10,108:11,109:12,110:13,111:14,112:15,113:16,114:17,115:18,116:19,117:20,118:21,119:22,120:23,121:24,122:25,48:26,49:27,50:28,51:29,52:30,53:31,54:32,55:33,56:34,57:35};let l,u=[],p=[],g=e=>null,h=e=>{};const d=new Map,m=new Map,y=new Map,T=new Map;var f,_;!function(e){e.Default="",e.EDPSCompliant="edps"}(f||(f={})),function(e){e.defineCoreLogCategory=e=>({root:"Core",name:e}),e.defineWorkflowLogCategory=e=>({root:"Workflow",name:e}),e.clearLoggers=()=>{u=[],p=[],m.clear(),y.clear()},e.clearAggregators=()=>{d.clear()},e.addLogger=e=>{-1===u.indexOf(e)&&(u.push(e),C(m,e))},e.addDecidingLogger=e=>{-1===p.indexOf(e)&&(p.push(e),C(y,e))},e.setCorrelationContextCallback=e=>{l=e},e.setStartPerformanceEventCallback=e=>{g=e},e.setStopPerformanceEventCallback=e=>{h=e},e.addAggregator=e=>{e.init(((e,t)=>{w(e,t)})),d.has(e.eventName)?d.get(e.eventName).push(e):d.set(e.eventName,[e])},e.flushAggregators=e=>{d.forEach((t=>{t.forEach((t=>t.flush(e)))}))},e.setTagLevelOverride=(e,t)=>{const s=L(e);T.set(s,t)},e.resetTagLevelOverrides=()=>{T.clear()},e.error=(e,t,s,o,i,a,r,c,l,u)=>{I(e,t,n.LoggingLevel.error,s,o,i,a,r,c,l,u)},e.warn=(e,t,s,o,i,a,r,c,l,u)=>{I(e,t,n.LoggingLevel.warn,s,o,i,a,r,c,l,u)},e.info=(e,t,s,o,i,a,r,c,l,u)=>{I(e,t,n.LoggingLevel.info,s,o,i,a,r,c,l,u)},e.verbose=(e,t,s,o,i,a,r,c,l,u)=>{I(e,t,n.LoggingLevel.verbose,s,o,i,a,r,c,l,u)},e.debug=(e,t,s,o,i,a,r,c,l,u)=>{I(e,t,n.LoggingLevel.debug,s,o,i,a,r,c,l,u)},e.metric=(e,t,s,o,i,a,r,c,l,u)=>{I(e,t,n.LoggingLevel.metric,s,o,i,a,r,c,l,u)},e.formatMetric=(e,t,s,o)=>{const n={};return n[e]={dimensionNames:s,dimensionValues:o,value:t},n},e.dynamic=e=>{w(e)}}(_||(t.Log=_={}));const C=(e,t)=>{const s=t.level;Object.keys(n.LoggingLevel).map((e=>n.LoggingLevel[e])).filter((e=>"string"!=typeof e)).filter((e=>e<=s)).forEach((s=>{e.has(s)?e.get(s).push(t):e.set(s,[t])}))};t.argsToString=e=>{if("string"==typeof e)return e;let t="";for(let s=0;s<e.length;s++){s>0&&(t+=" ");const o=e[s];o instanceof Error?t+=JSON.stringify({message:o.message,name:o.name,stack:o.stack}):t+="object"==typeof o?JSON.stringify(o):o}return t};t.logCategoryToString=e=>`${e.root}.${e.name}`;const S=[],A=["Level","Tag"],v=["Level","Tag","Workflow"];t.getNumLoggers=e=>N(e).length;const N=e=>void 0!==e?m.get(e)||S:u,E=(e,t)=>(void 0!==e?y.get(e)||[]:p).filter((e=>e.shouldLog(t))),I=(e,s,o,n,a,r,c,u,p,m,y)=>{o=T.get(e)||o;const f=N(o),_=E(o,n);if(0==f.length&&0==_.length)return;const C=g(i.PerformanceEventType.Log),S=(0,t.tagIdToString)(e),I=((e,t,s,o,n,i,a,r)=>{if(void 0===t&&("string"==typeof e||"object"==typeof e))return e;if(void 0===t&&"function"==typeof e)return e();const c=[];for(const l of[e,t,s,o,n,i,a,r])void 0!==l&&c.push("function"==typeof l?l():l);return c})(n,a,r,c,u,p,m,y);if(b(s))k(I)&&w({eventName:"Metrics",tagId:S,category:(0,t.logCategoryToString)(s),traceLevel:o,message:"",getMetrics:()=>I},!1,f,_);else if(k(I)){const e=I;e.tagId=S,e.category=(0,t.logCategoryToString)(s),"Operation"===e.eventName&&"Workflow"===s.root&&(e.eventName="WorkflowOperation",l&&(e.joinContextId=l().joinContextId,e.workflow=l().workflow)),e.traceLevel=o;const n=d.get(e.eventName);if(n)for(let t=0;t<n.length;++t){const s=n[t];if(s&&s.add(e,t===n.length-1))break}else w(e,!1,f,_)}else{const e=()=>{var e;return"Core"===s.root?{TraceEventV2:{dimensionNames:()=>A,dimensionValues:[String(o),S],value:1}}:{WorkflowTraceEvent:{dimensionNames:()=>v,dimensionValues:[String(o),S,l?null===(e=l())||void 0===e?void 0:e.workflow:""],value:1}}};w({eventName:"Log",tagId:S,category:(0,t.logCategoryToString)(s),traceLevel:o,message:(0,t.argsToString)(I),getMetrics:e},!1,f,_)}h(C)},w=(e,t=!1,s,o)=>{var n,i,r,c,u,p,g,h,d,m,y,T,f,_;let C;if(null==s&&(s=N(e.traceLevel)),o=o||S,s.length>0||o.length>0){if(e.serviceName=a,!t&&l){const t=l();t&&(C={disableLogging:t.disableLogging,userDataBoundaryType:null===(i=null===(n=t.sessionDescriptor)||void 0===n?void 0:n.userContext)||void 0===i?void 0:i.userDataBoundaryType},e.cv=e.cv?e.cv:t.cv.toString(),e.sessionKey=e.sessionKey?e.sessionKey:t.sessionKey,e.userTenantId=e.userTenantId?e.userTenantId:t.userTenantId,e.workflow=e.workflow?e.workflow:t.workflow,e.clientAppName=e.clientAppName?e.clientAppName:null===(r=t.clientMetadata)||void 0===r?void 0:r.appName,e.clientAppPlatform=e.clientAppPlatform?e.clientAppPlatform:null===(c=t.clientMetadata)||void 0===c?void 0:c.appPlatform,e.clientAppVersion=e.clientAppVersion?e.clientAppVersion:null===(u=t.clientMetadata)||void 0===u?void 0:u.appVersion,e.clientDocSessionId=e.clientDocSessionId?e.clientDocSessionId:null===(p=t.clientMetadata)||void 0===p?void 0:p.docSessionId,e.clientReleaseAudienceGroup=e.clientReleaseAudienceGroup?e.clientReleaseAudienceGroup:null===(g=t.clientMetadata)||void 0===g?void 0:g.releaseAudienceGroup,e.clientReleaseChannel=e.clientReleaseChannel?e.clientReleaseChannel:null===(h=t.clientMetadata)||void 0===h?void 0:h.releaseChannel,e.clientReleaseFork=e.clientReleaseFork?e.clientReleaseFork:null===(d=t.clientMetadata)||void 0===d?void 0:d.releaseFork,e.clientRuntimeVersion=e.clientRuntimeVersion?e.clientRuntimeVersion:null===(m=t.clientMetadata)||void 0===m?void 0:m.runtimeVersion,e.clientSessionId=e.clientSessionId?e.clientSessionId:null===(y=t.clientMetadata)||void 0===y?void 0:y.sessionId,e.clientUserAgent=e.clientUserAgent?e.clientUserAgent:null===(T=t.clientMetadata)||void 0===T?void 0:T.userAgent,e.traceId=e.traceId||t.traceId,e.isClientTelemetrySampled=e.isClientTelemetrySampled?e.isClientTelemetrySampled:null===(f=t.clientMetadata)||void 0===f?void 0:f.isClientTelemetrySampled,e.userDataBoundaryType=M(C),e.ecsConfigIDs=null===(_=t.ecsConfigIDsManager)||void 0===_?void 0:_.getAllConfigIDsString())}for(const t of s)t.log(e,C);for(const t of o)t.log(e)}},b=e=>e.name===B.WorkflowMetricsOnly.name&&e.root===B.WorkflowMetricsOnly.root,k=e=>!Array.isArray(e)&&"object"==typeof e,M=e=>(null==e?void 0:e.userDataBoundaryType)===n.UserDataBoundaryType.EDPSCompliant?f.EDPSCompliant:f.Default;t.tagIdToString=e=>r[e>>24&63]+r[e>>18&63]+r[e>>12&63]+r[e>>6&63]+r[63&e];const L=e=>e&&5===e.length?c[e.charCodeAt(0)]<<24|c[e.charCodeAt(1)]<<18|c[e.charCodeAt(2)]<<12|c[e.charCodeAt(3)]<<6|c[e.charCodeAt(4)]:-1;class B{}t.LogCategory=B,B.CoreDefault=_.defineCoreLogCategory("Default"),B.CoreSystem=_.defineCoreLogCategory("System"),B.CoreUnsampled=_.defineCoreLogCategory("Unsampled"),B.WorkflowDefault=_.defineWorkflowLogCategory("Default"),B.WorkflowUnsampled=_.defineWorkflowLogCategory("Unsampled"),B.WorkflowMetricsOnly=_.defineWorkflowLogCategory("MetricsOnly"),B.PrivacyGuardEvent=_.defineCoreLogCategory("PrivacyGuardEvent")},83556:(e,t,s)=>{s.d(t,{vF:()=>i});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffPropertiesSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffInboundMessage"}static getBaseTypes(){return["AugLoop_HandoffSkill_HandoffPropertiesSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_AppHandoffInboundMessage"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffInternalMessage"}static getBaseTypes(){return["AugLoop_HandoffSkill_HandoffPropertiesSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffMessageId"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffPrompt"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffDocUrlSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()}},93548:(e,t,s)=>{s.d(t,{g:()=>n});var o=s(596498);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_ContentIntelligencePlatformEvaluation_SemanticTreeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},108783:(e,t,s)=>{s.d(t,{R:()=>n});var o={util:{},roots:{default:{}}},n=(o.util,o.roots.default||(o.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.sessionHealthEventName="",e.prototype.source="",e.prototype.reason="",e.prototype.reasonDependency="",e.prototype.subReason="",e.prototype.impact="",e.prototype.success=!1,e.prototype.durationMs=0,e.prototype.count=0,e.prototype.message="",e.prototype.affectedWorkflows="",e.prototype.resourceId="",e.prototype.dimension0="",e.prototype.dimension1="",e.prototype.dimension2="",e.prototype.dimension3="",e.prototype.resultDescription="",e.prototype.resultSignature="",e.prototype.joinContextId="",e.prototype.userDataBoundaryType="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SessionHealthEvent"},e}())},113243:(e,t,s)=>{var o;s.d(t,{O:()=>o}),function(e){e.Disabled="Disabled",e.Predictive="Predictive",e.UserInitiated="UserInitiated"}(o||(o={}))},117921:(e,t,s)=>{s.d(t,{G:()=>n});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_CopilotPluginConfigBrokering_CopilotPluginSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},120501:(e,t,s)=>{s.d(t,{N0:()=>n,NC:()=>p,Xv:()=>i,Z8:()=>l,aD:()=>u,f4:()=>g,hl:()=>r,iU:()=>c,ub:()=>a});var o=s(596498);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_GraphIntentSuggestion"}static getBaseTypes(){return["AugLoop_SmartCompose_Suggestion","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_GraphIntentPrefilterTriggered"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_SystemInitiatedWithIntentBase"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_SystemInitiatedWithIntent"}static getBaseTypes(){return["AugLoop_GraphIntentDetection_SystemInitiatedWithIntentBase","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_SystemInitiatedWithIntentClient"}static getBaseTypes(){return["AugLoop_GraphIntentDetection_SystemInitiatedWithIntentBase","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_SystemInitiatedWithIntentHybrid"}static getBaseTypes(){return["AugLoop_GraphIntentDetection_SystemInitiatedWithIntentBase","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_Prefetch"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_FlagWithIntent"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(g,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_EntityPrediction"}static getBaseTypes(){return["AugLoop_GraphIntentDetection_SystemInitiatedWithIntentBase","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()}},122409:(e,t,s)=>{s.d(t,{v:()=>n});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_ExcelIntelligence_ExcelIntelligenceTableSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},125952:(e,t,s)=>{s.d(t,{Nz:()=>o,Xe:()=>n,aU:()=>a,zb:()=>r});var o,n,i=s(376305);!function(e){e[e.OWA_REACT_COMPOSE=0]="OWA_REACT_COMPOSE",e[e.OUTLOOK_WEB_OA=1]="OUTLOOK_WEB_OA",e[e.OWA_PEOPLE_NAME_PRED=2]="OWA_PEOPLE_NAME_PRED",e[e.OUTLOOKMOBILE_IOS_PEOPLE_COMPOSE=3]="OUTLOOKMOBILE_IOS_PEOPLE_COMPOSE",e[e.DYNAMIC_SEARCH_BOX=4]="DYNAMIC_SEARCH_BOX",e[e.WORKPLACE_SEARCH=5]="WORKPLACE_SEARCH",e[e.COPILOT=6]="COPILOT",e[e.COPILOT_POWERPOINT=7]="COPILOT_POWERPOINT",e[e.PEOPLE_FLYOUT=100]="PEOPLE_FLYOUT",e[e.BIZ_CHAT=1e4]="BIZ_CHAT"}(o||(o={})),function(e){e[e.SUBSTRATE_AAD=0]="SUBSTRATE_AAD",e[e.SUBSTRATE_MSA=1]="SUBSTRATE_MSA"}(n||(n={}));const a={emailId:"",puid:"",scenarios:[o.OWA_REACT_COMPOSE],market:"",tenantId:"",substrateAuthTokenType:n.SUBSTRATE_AAD,entityTypes:[i.ck.People,i.ck.File,i.ck.Scope],prefetchOnly:!1},r={wasmRoot:"graph-search-local"}},131481:(e,t,s)=>{var o,n,i,a,r,c,l,u,p,g,h,d,m,y,T;s.d(t,{f9:()=>o,rS:()=>r}),function(e){e.Podcast="Podcast",e.AudioOverview="AudioOverview",e.Assistant="Assistant"}(o||(o={})),function(e){e.NewsBriefing="NewsBriefing"}(n||(n={})),function(e){e.ODSP="ODSP"}(i||(i={})),function(e){e.Long="long",e.Medium="medium",e.Short="short",e.VeryShort="very short",e.ExtremelyShort="extremely short",e.VeryLong="very long"}(a||(a={})),function(e){e.Script="script",e.Ssml="ssml",e.Audio="audio",e.RawContent="rawContent",e.SupportedConfiguration="supportedConfiguration"}(r||(r={})),function(e){e.EN_US="en-us"}(c||(c={})),function(e){e.Professional="Professional",e.Casual="Casual"}(l||(l={})),function(e){e.OneHost="One Host",e.TwoHost="Two Host"}(u||(u={})),function(e){e.AudioCast_Error="AudioCast_Error",e.CONTENT_ACQUISITION_ERROR="CONTENT_ACQUISITION_ERROR",e.GRAPH_ERROR="GRAPH_ERROR",e.FILE_SENSITIVITY_FETCH_ERROR="FILE_SENSITIVITY_FETCH_ERROR",e.FILE_METADATA_FETCH_ERROR="FILE_METADATA_FETCH_ERROR",e.FILE_CONTENT_FETCH_ERROR="FILE_CONTENT_FETCH_ERROR",e.NORMALIZATION_ERROR="NORMALIZATION_ERROR",e.TTS_ERROR="TTS_ERROR",e.DLP_ERROR="DLP_ERROR",e.LLM_ERROR="LLM_ERROR",e.RAI_ERROR="RAI_ERROR",e.TOKEN_ERROR="TOKEN_ERROR",e.UNKNOWN_ERROR="UNKNOWN_ERROR",e.SCRIPT_HANDLER_ERROR="SCRIPT_HANDLER_ERROR",e.SPE_CONTAINER_ERROR="SPE_CONTAINER_ERROR",e.METERING_ERROR="METERING_ERROR",e.CACHE_ERROR="CACHE_ERROR"}(p||(p={})),function(e){e.INTERNAL_SERVER_ERROR="INTERNAL_SERVER_ERROR",e.PODCAST_GENERATION_IN_PROGRESS="PODCAST_GENERATION_IN_PROGRESS",e.THROTTLED="THROTTLED",e.TOO_SMALL_AUDIO_BUFFER="TOO_SMALL_AUDIO_BUFFER",e.CREATE_SPE_CONTAINER_FAILED="CREATE_SPE_CONTAINER_FAILED",e.WRITE_CONTENT_TO_SPE_CONTAINER_FAILED="WRITE_CONTENT_TO_SPE_CONTAINER_FAILED",e.UPDATE_CONTENT_TO_SPE_CONTAINER_FAILED="UPDATE_CONTENT_TO_SPE_CONTAINER_FAILED",e.GET_CONTENT_FROM_SPE_CONTAINER_FAILED="GET_CONTENT_FROM_SPE_CONTAINER_FAILED",e.CACHE_READ_FAILED="CACHE_READ_FAILED",e.REQUEST_TOO_LARGE="REQUEST_TOO_LARGE",e.RETRY_LIMIT_REACHED="RETRY_LIMIT_REACHED",e.LIMITED_RESOURCES="LIMITED_RESOURCES",e.TOKEN_NOT_AVAILABLE="TOKEN_NOT_AVAILABLE",e.LOCAL_FILES_NOT_SUPPORTED="LOCAL_FILES_NOT_SUPPORTED",e.NETWORK_ERROR="NETWORK_ERROR",e.FAILED_TO_PARSE_FILES="FAILED_TO_PARSE_FILES",e.FAILED_TO_DOWNLOAD_FILES="FAILED_TO_DOWNLOAD_FILES",e.FAILED_TO_FETCH_FILE_METADATA="FAILED_TO_FETCH_FILE_METADATA",e.FAILED_TO_FETCH_SENSITIVITY_INFO="FAILED_TO_FETCH_SENSITIVITY_INFO",e.EMPTY_SENSITIVITY_INFO="EMPTY_SENSITIVITY_INFO",e.SENSITIVE_FILES_NOT_SUPPORTED="SENSITIVE_FILES_NOT_SUPPORTED",e.IRM_PROTECTED_ENCRYPTED_FILE="IRM_PROTECTED_ENCRYPTED_FILE",e.RAI_INPUT_CHECK_FAILED="RAI_INPUT_CHECK_FAILED",e.RAI_OUTPUT_CHECK_FAILED="RAI_OUTPUT_CHECK_FAILED",e.UNSUPPORTED_LANGUAGE="UNSUPPORTED_LANGUAGE",e.UNSUPPORTED_FILE_TYPE="UNSUPPORTED_FILE_TYPE",e.NOT_FOUND="NOT_FOUND",e.DLP_POLICY_ACCESS_DENIED="DLP_POLICY_ACCESS_DENIED",e.EXTRACT_RIGHTS_MISSING="EXTRACT_RIGHTS_MISSING",e.UNSUPPORTED_VOICE="UNSUPPORTED_VOICE",e.GROUNDING_CONTENT_INPUT_LIMIT_EXCEED="GROUNDING_CONTENT_INPUT_LIMIT_EXCEED",e.AUTHENTICATION_FAILED="AUTHENTICATION_FAILED",e.BAD_REQUEST="BAD_REQUEST",e.BAD_REQUEST_LLM="BAD_REQUEST_LLM",e.REQUEST_TIMEOUT="REQUEST_TIMEOUT",e.ABORTED="Aborted",e.UNKNOWN="Unknown",e.CLIENT_NOT_WHITELISTED="CLIENT_NOT_WHITELISTED",e.UNSUPPORTED_REQUEST="UNSUPPORTED_REQUEST",e.INVALID_CONTENT_ACQUISITION_SCRIPT="INVALID_CONTENT_ACQUISITION_SCRIPT",e.INVALID_CONTENT_NORMALIZATION_SCRIPT="INVALID_CONTENT_NORMALIZATION_SCRIPT",e.CONTENT_ACQUISITION_REQUEST_TIMEOUT="CONTENT_ACQUISITION_REQUEST_TIMEOUT",e.NO_CONTENT="NO_CONTENT",e.CONTENT_FETCH_FAILED_FOR_ALL_FILES="CONTENT_FETCH_FAILED_FOR_ALL_FILES",e.INCOMPLETE_CONTENT="INCOMPLETE_CONTENT",e.EMPTY_IMAGE_DATA="EMPTY_IMAGE_DATA",e.EMPTY_IMAGE_CONFIG="EMPTY_IMAGE_CONFIG",e.INVALID_IMAGE_FORMAT="INVALID_IMAGE_FORMAT",e.MULTIMODAL_LLM_CALL_FAILED="MULTIMODAL_LLM_CALL_FAILED",e.TOO_SMALL_GROUNDING_CONTENT="TOO_SMALL_GROUNDING_CONTENT",e.ALLOWED_ALLOWANCE_EXHAUSTED="ALLOWED_ALLOWANCE_EXHAUSTED",e.LLM_TOKEN_LIMIT_EXCEED="LLM_TOKEN_LIMIT_EXCEED",e.FILE_DOWNLOAD_CONDITIONAL_ACCESS_BLOCKED="FILE_DOWNLOAD_CONDITIONAL_ACCESS_BLOCKED"}(g||(g={})),function(e){e.BLOB="blob",e.BASE64="base64"}(h||(h={})),function(e){e.eTag="eTag",e.cTag="cTag"}(d||(d={})),function(e){e.TypeBPlugin="TypeBPlugin",e.TypeBPluginGlobal="TypeBPluginGlobal",e.CopilotApp="CopilotApp",e.Canvas="Canvas"}(m||(m={})),function(e){e.IDLE="IDLE",e.FETCHING_CONTENT="FETCHING_CONTENT",e.GENERATING_PLAN="GENERATING_PLAN",e.GENERATING_SCRIPT="GENERATING_SCRIPT",e.SCRIPT_GENERATED="SCRIPT_GENERATED",e.GENERATING_AUDIO_BLOB="GENERATING_AUDIO_BLOB",e.AUDIO_BLOB_GENERATED="AUDIO_BLOB_GENERATED",e.SUCCESS="SUCCESS",e.FAILED="FAILED"}(y||(y={})),function(e){e.DOCX="docx",e.DOC="doc",e.XLSX="xlsx",e.TEXT="txt",e.PDF="pdf",e.PPTX="pptx",e.JSON="json",e.EMAIL="eml",e.FLUID="fluid",e.LOOP="loop",e.NOTE="note",e.PAGE="page",e.ONE="one",e.UNKNOWN="unknown",e.CSV="csv",e.EXTENSION_NOT_AVAILABLE="extension_not_available",e.YAML="yaml",e.ASPX="aspx"}(T||(T={}))},133858:(e,t,s)=>{s.d(t,{I3:()=>u,SB:()=>T,W1:()=>m,hD:()=>y,yo:()=>l});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Core_BlobContainer"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Core_Blob"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Core_Binary"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_TileGroup"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Core_Session"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Core_Document"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Core_SubDocument"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Core_GridCell"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){o.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Core_GridNeighborhoodContext"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){o.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Core_ItemFilter"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{constructor(e){o.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Core_DynamicContext"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{constructor(e){o.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Core_ContextHolder"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{constructor(e){o.h.assign(y,this,e)}static getTypeName(){return"AugLoop_Core_UserContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(e){return o.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class T{constructor(e){o.h.assign(T,this,e)}static getTypeName(){return"AugLoop_Core_TenantContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(e){return o.h.matchesTypesFor(e,[T.getTypeName()])}}T.H_={T_:T.getTypeName(),B_:T.getBaseTypes()};class f{constructor(e){o.h.assign(f,this,e)}static getTypeName(){return"AugLoop_Core_EventsHolder"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class _{constructor(e){o.h.assign(_,this,e)}static getTypeName(){return"AugLoop_Core_UserCommandsHolder"}static getBaseTypes(){return["AugLoop_Core_EventsHolder"]}static typeGuard(e){return o.h.matchesTypesFor(e,[_.getTypeName()])}}_.H_={T_:_.getTypeName(),B_:_.getBaseTypes()}},134084:(e,t,s)=>{var o,n;s.r(t),s.d(t,{EntityPrediction:()=>i.f4,FlagWithIntent:()=>i.NC,GraphIntentDetectionBaseSignal:()=>r,GraphIntentDetectionSignal:()=>c,GraphIntentPrefilterTriggered:()=>i.Xv,GraphIntentSuggestion:()=>i.N0,IntentConfidenceLevel:()=>o,IntentScope:()=>n,Prefetch:()=>i.aD,SystemInitiatedRequestSignalHybrid:()=>l,SystemInitiatedWithIntent:()=>i.hl,SystemInitiatedWithIntentBase:()=>i.ub,SystemInitiatedWithIntentClient:()=>i.iU,SystemInitiatedWithIntentHybrid:()=>i.Z8}),function(e){e[e.Unspecified=0]="Unspecified",e[e.Low=1]="Low",e[e.Medium=2]="Medium",e[e.High=3]="High"}(o||(o={})),function(e){e.FirstParty="FirstParty",e.ThirdParty="ThirdParty"}(n||(n={}));var i=s(120501),a=s(596498);class r{constructor(e){a.h.assign(r,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_GraphIntentDetectionBaseSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return a.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){a.h.assign(c,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_GraphIntentDetectionSignal"}static getBaseTypes(){return["AugLoop_GraphIntentDetection_GraphIntentDetectionBaseSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return a.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){a.h.assign(l,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_SystemInitiatedRequestSignalHybrid"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return a.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()}},134542:(e,t,s)=>{s.d(t,{Al:()=>u,D_:()=>c,Pm:()=>r,U1:()=>p,ZF:()=>i,_K:()=>l,lM:()=>a,m7:()=>g,mh:()=>n});var o=s(596498),n=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_SpeechToTextFinalResult"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),i=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_SpeechToTextPartialResult"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),a=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_SpeechErrorEvent"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),r=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_VoiceCommandRequest"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),c=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_SpeechSessionEvent"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),l=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_SpeechQualityEvent"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),u=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_VoiceLatencyOutput"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),p=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_BatchTranscriptionResult"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),g=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_RehearsalNotificationResult"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()},137375:(e,t,s)=>{var o;s.d(t,{t:()=>o}),function(e){e.ZQM="ZQM",e.ChatPaneZQM="chatPaneZQM",e.AIR="AIR",e.RelatedFiles="RelatedFiles",e.AppHomeChatPage="AppHomeChatPage",e.AppHomeProactiveStart="AppHomeProactiveStart"}(o||(o={}))},138084:(e,t,s)=>{var o,n;s.d(t,{E:()=>n,b:()=>o}),function(e){e[e.ProductServiceUsage=2]="ProductServiceUsage",e[e.ProductServicePerformance=4]="ProductServicePerformance"}(o||(o={})),function(e){e[e.BasicEvent=10]="BasicEvent",e[e.FullEvent=100]="FullEvent",e[e.RequiredServiceDataEvent=110]="RequiredServiceDataEvent"}(n||(n={}))},141780:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationMetaDataChange=void 0;const o=s(28488);class n extends o.AnnotationMetaDataChangeEvent{constructor(e){super(e),this.eventName="AnnotationMetaDataChange"}}t.AnnotationMetaDataChange=n},152871:(e,t,s)=>{s.d(t,{Pq:()=>i,aM:()=>o,l6:()=>n,vf:()=>c});var o,n,i,a=s(108783),r=s(672103);!function(e){e[e.Unknown=0]="Unknown",e[e.Core=1]="Core",e[e.Workflow=2]="Workflow",e[e.SessionExtension=3]="SessionExtension",e[e.Client=4]="Client",e[e.ClientRuntime=5]="ClientRuntime"}(o||(o={})),function(e){e[e.Unknown=0]="Unknown",e[e.Core=1]="Core",e[e.Workflow=2]="Workflow",e[e.SessionExtension=3]="SessionExtension",e[e.Client=4]="Client",e[e.Network=5]="Network",e[e.AugLoopDependency=6]="AugLoopDependency",e[e.WorkflowDependency=7]="WorkflowDependency",e[e.ClientRuntime=8]="ClientRuntime"}(n||(n={})),function(e){e[e.Unknown=0]="Unknown",e[e.None=1]="None",e[e.MissingInput=2]="MissingInput",e[e.MissingOutput=3]="MissingOutput"}(i||(i={}));class c extends a.R{constructor(e,t){var s,a;super({source:o[e.source],reason:n[e.reason],reasonDependency:e.reasonDependency,subReason:e.subReason,sessionHealthEventName:e.sessionHealthEventName,impact:i[e.impact],success:e.success,durationMs:null!==(s=e.durationMs)&&void 0!==s?s:0,count:"number"==typeof e.count?e.count:1,message:e.message,affectedWorkflows:(null!==(a=e.affectedWorkflows)&&void 0!==a?a:[]).join(","),resourceId:e.resourceId,dimension0:e.dimension0,dimension1:e.dimension1,dimension2:e.dimension2,dimension3:e.dimension3,cv:e.cv,resultSignature:e.resultSignature,resultDescription:e.resultDescription,joinContextId:e.joinContextId}),this.eventName="SessionHealth",this.aggregationEnabled=!1,t&&this.setClientMetadata(t),this.metricCount=e.metricCount,this.metricDuration=e.metricDuration}getMetrics(){const e={};return(void 0===this.metricCount||this.metricCount)&&(e[`${this.sessionHealthEventName}.CountV2`]={dimensionNames:()=>c.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.count}),(void 0===this.metricDuration||this.metricDuration)&&(e[`${this.sessionHealthEventName}.DurationMsV2`]={dimensionNames:()=>c.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.durationMs}),e}setClientMetadata(e){return e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,this.clientFlights=e.flights,this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientReleaseChannel=e.releaseChannel,this.clientReleaseFork=e.releaseFork,this.clientRuntimeVersion=e.runtimeVersion,this.clientSessionId=e.sessionId,this.clientDocSessionId=e.docSessionId,this.clientUserAgent=e.userAgent),this}setUserContext(e){return e&&(this.userId=e.puid||e.oid,this.userType=e.userType&&e.userType.toString(),this.userTenantId=e.tid),this}setReason(e){return this.reason=n[e],this}setSource(e){return this.source=o[e],this}setImpact(e){return this.impact=i[e],this}setAffectedWorkflows(e){return this.affectedWorkflows=(null!=e?e:[]).join(","),this}getAffectedWorkflows(){return this.affectedWorkflows.split(",")}enableAggregation(){return this.aggregationEnabled=!0,this}shouldBeAggregated(){return this.aggregationEnabled}start(){return this.startTime=(0,r.t)(),this}stop(){const e=(0,r.t)();return this.durationMs=Math.round(e-this.startTime),this}getDimensionValues(){var e;return[this.clientAppName,this.clientAppPlatform,this.clientAppVersion,this.success?"1":"0",`${this.reason}_${this.reasonDependency}`,this.impact,null!==(e=this.getAffectedWorkflows()[0])&&void 0!==e?e:"",this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}}c.dimensionNames=["ClientAppName","ClientAppPlatform","ClientAppVersion","Success","Reason","Impact","FirstAffectedWorkflow","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"]},153420:function(e,t,s){var o=this&&this.__createBinding||(Object.create?function(e,t,s,o){void 0===o&&(o=s);var n=Object.getOwnPropertyDescriptor(t,s);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,o,n)}:function(e,t,s,o){void 0===o&&(o=s),e[o]=t[s]}),n=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||o(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),n(s(190028),t),n(s(584104),t)},154148:(e,t,s)=>{var o,n,i;s.d(t,{Xh:()=>o,dT:()=>i}),function(e){e.User="user",e.Assistant="assistant",e.System="system",e.Developer="developer"}(o||(o={})),function(e){e.Default="Default",e.Promoted="Promoted",e.Next="Next",e.Claude="Claude"}(n||(n={})),function(e){e.ReturnResult="returnResult",e.ErrorResult="errorResult",e.NoReturn="noReturn"}(i||(i={}))},164151:(e,t,s)=>{var o;s.d(t,{v:()=>o}),function(e){e[e.General=0]="General",e[e.Number=1]="Number",e[e.Text=2]="Text",e[e.Date=3]="Date",e[e.Time=4]="Time",e[e.Currency=5]="Currency",e[e.Accounting=6]="Accounting"}(o||(o={}))},172141:(e,t,s)=>{s.d(t,{BG:()=>l,Kh:()=>r,M4:()=>p,NR:()=>u,m9:()=>c});var o=s(69614),n=s(596498),i=s(599243),a=s(622908);const r=e=>{var t,s;if(o.B_.typeGuard(e)){const s=e.ops.filter((e=>n.h.matchesTypesFor(e,["AugLoop_Core_AddOperation"])));for(const e of s)for(const s of e.items)if(s.body&&(null===(t=s.body)||void 0===t?void 0:t.isFirstUserPerceivedResponse))return!0}else if(a.rK.typeGuard(e))return null===(s=e.content)||void 0===s?void 0:s.some((e=>{var t;return null===(t=e.body)||void 0===t?void 0:t.isFirstUserPerceivedResponse}));return!1},c=(e,t,s)=>{var o,n,a,r;s.resultSignature=t,s.resourceId=`${null===(o=e.sourceInfo)||void 0===o?void 0:o.featureId}-${null===(n=e.sourceInfo)||void 0===n?void 0:n.entryPoint}`,s.cv=e.cv,s.setDataFields({AnnotationTypes:null===(a=e.annotationTypes)||void 0===a?void 0:a.toString(),MaxDelayMs:null===(r=e.maxDelayMs)||void 0===r?void 0:r.toString()}),i.tG.info(505455200,i.nh.CoreDefault,s.stop())},l=(e,t,s,o,a)=>{const r=(e=>{const t=e.filter((e=>n.h.matchesTypesFor(e,["AugLoop_Signals_SignalOperation"])));for(const e of t)for(const t of e.items)if(t.body&&n.h.matchesTypesFor(t.body,["AugLoop_CopilotChatHistory_CopilotChatHistorySignal","AugLoop_Copilot_CopilotInputSignal"]))return t})(e);r&&(a.setDataField("CurrentTimestamp",s),a.cv=t||"",a.resultSignature=o,a.resourceId=n.h.getTypeNameFor(r.body),r.contextId&&a.setDataField("ContextId",r.contextId),r.sourceTimestamp&&a.setDataField("SourceTimestamp",r.sourceTimestamp),i.tG.info(505983429,i.nh.CoreDefault,a.stop()))},u=(e,t,s,o)=>{l(e.ops,e.cv,t,s,o)},p=(e,t,s,o,n)=>{o&&!r(e)||(n.setDataField("CurrentTimestamp",t),n.cv=e.cv,n.resultSignature=s,n.resourceId=e.annotationType,n.dimension1=`AreApologies: ${e.areApologies}`,i.tG.info(505983428,i.nh.CoreDefault,n.stop()))}},174025:(e,t,s)=>{s.d(t,{Cg:()=>i,qf:()=>n});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Text_TextTile"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Text_FormattedTextTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Text_InlineTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Text_DynamicTextContext"}static getBaseTypes(){return["AugLoop_Core_DynamicContext"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Text_TaskTile"}static getBaseTypes(){return["AugLoop_Text_FormattedTextTile","AugLoop_Text_TextTile"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Text_PersonTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Text_DateTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Text_LinkTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){o.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Text_CommentTile"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()}},177556:(e,t,s)=>{s.d(t,{A2:()=>p,ZC:()=>h,wM:()=>g});var o=s(336831),n=s(599243),i=s(87477),a=s(758488),r=s(69614),c=function(e,t,s,o){return new(s||(s=Promise))((function(n,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function r(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((o=o.apply(e,t||[])).next())}))};function l(e,t){return c(this,void 0,void 0,(function*(){const{authToken:s,origin:o,sessionUrl:n}=e,{body:a,cv:r,method:c,requestUrl:l}=t,u=yield(0,i.fetch)(l||n,{method:c,headers:Object.assign({Authorization:`Bearer ${s}`,"x-origin":o,"x-correlationid":r},t.headers),body:a});if(200!==u.status)throw new Error(`Unexpected status code: ${u.status}`);return u}))}const u=(e,t)=>{t?(e.resultDescription=t,e.success=!1,n.tG.error(507646878,n.nh.CoreDefault,e.stop())):n.tG.info(507646877,n.nh.CoreDefault,e.stop())};function p(e,t,s,o){let n;l(e,{headers:{"Content-Type":"application/jsond"},body:a.r.serialize(t),cv:s.cv,method:"POST"}).then((e=>e.json())).catch((e=>{n=new r._p({messageId:t.messageId,error:e.message})})).then((e=>{u(s,n?n.error:void 0),o(n,e)}))}function g(e,t,s,o){let n;l(e,{headers:{"Content-Type":"application/octet-stream"},body:t,cv:s.cv,method:"POST",requestUrl:`${e.sessionUrl}/blob`}).then((e=>e.json())).catch((e=>{n=new r._p({error:e.message})})).then((e=>{u(s,n?n.error:void 0),o(n,e)}))}function h(e,t,s,n){const{sessionUrl:i}=e;let a;l(e,{cv:n.cv,method:"GET",requestUrl:t.refType===o.J1.AlCodedLocation?`${i}/blob/${t.value}`:t.value}).then((e=>e.arrayBuffer())).then((e=>new Uint8Array(e))).catch((e=>{a=e})).then((e=>{u(n,a?a.message:void 0),s(a,e)}))}},177848:(e,t,s)=>{s.d(t,{G:()=>i});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_CopilotSubstrateIntegration_SuggestionAPISignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_CopilotSubstrateIntegration_SubstrateSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},177918:(e,t,s)=>{s.r(t),s.d(t,{AudioMode:()=>c,BaseVoiceCommandResult:()=>f,BaseVoiceCommandSuggestion:()=>N,BatchTranscriptionConversation:()=>y.Qu,BatchTranscriptionErrorCode:()=>u.sP,BatchTranscriptionResult:()=>h.U1,BatchWorkflowStage:()=>l.Cu,ClientApp:()=>l.jr,CommandSuggestionContextType:()=>n,CommandSuggestionDisplayType:()=>o,DictationEventsType:()=>T.Ff,DictationSettingsManager:()=>p.A,IEventName:()=>l.$O,ISpeechError:()=>l.IZ,QualityStatusCode:()=>l.ZE,RehearsalNotificationResult:()=>h.m7,SelectionType:()=>a,SelectionWhich:()=>r,SpeechErrorEvent:()=>h.lM,SpeechErrorEventCode:()=>u.Y3,SpeechErrorEventImpact:()=>u.$O,SpeechErrorEventState:()=>u.o2,SpeechQualityEvent:()=>h._K,SpeechSessionEvent:()=>h.D_,SpeechSessionEventIds:()=>T.P_,SpeechToTextFinalResult:()=>h.mh,SpeechToTextPartialResult:()=>h.ZF,SpeechToTextProfile:()=>g.A,TraceLevel:()=>l.kp,UtteranceRecognitionType:()=>i,VoiceCommandError:()=>u.El,VoiceCommandInternalResult:()=>C,VoiceCommandRequest:()=>h.Pm,VoiceCommandResultV2:()=>_,VoiceCommandResultsInternalSignal:()=>S,VoiceCommandSuggestion:()=>E,VoiceCommandSuggestionInternalSignal:()=>A,VoiceCommandSuggestionResult:()=>I,VoiceDictationSessionInitiatedSignal:()=>v,VoiceLatencyInput:()=>y.VR,VoiceLatencyOutput:()=>h.Al,VoiceOperation:()=>m,VoiceResponseVersion:()=>u.wM,VoiceTile:()=>y.jP,WordVoiceCommandIds:()=>T.oJ,WordVoiceCommandValueKeys:()=>T.n4,internalCommandIds:()=>T.XH});var o,n,i,a,r,c,l=s(434705),u=s(32359),p=s(880085),g=s(410972),h=s(134542),d=s(596498),m=function(){function e(t){d.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_VoiceOperation"},e.getBaseTypes=function(){return["AugLoop_Core_Operation"]},e.typeGuard=function(t){return d.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),y=s(340305),T=s(988412);!function(e){e.Persistent="Persistent",e.Discardable="Discardable"}(o||(o={})),function(e){e.NONE="none",e.BLANK="blankDocument",e.PARAGRAPH="paragraph",e.LIST="list",e.TABLE="table",e.WHATCANISAY="whatCanISay"}(n||(n={})),function(e){e.Final="Final",e.Fragment="Fragment",e.Hypothesis="Hypothesis"}(i||(i={})),function(e){e.Paragraph="paragraph",e.Sentence="sentence",e.Character="character",e.Word="word",e.That="that",e.This="this",e.Table="table",e.Row="row",e.Column="column",e.Cell="cell",e.Page="page",e.Bullet="bullet",e.To="to",e.Bcc="bcc",e.Cc="cc",e.Subject="subject",e.EmailBody="emailBody",e.Field="field",e.All="all"}(a||(a={})),function(e){e.Next="next",e.Last="last",e.Previous="previous",e.Current="current",e.Left="left",e.Right="right",e.Above="above",e.Below="below",e.Start="start",e.End="end",e.Up="up",e.Down="down",e.Before="before",e.After="after",e.Beginning="start"}(r||(r={})),function(e){e.Play="play",e.Pause="pause",e.Resume="resume"}(c||(c={}));var f=function(){function e(t){d.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_BaseVoiceCommandResult"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return d.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),_=function(){function e(t){d.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_VoiceCommandResultV2"},e.getBaseTypes=function(){return["AugLoop_Voice_BaseVoiceCommandResult","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return d.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),C=function(){function e(t){d.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_VoiceCommandInternalResult"},e.getBaseTypes=function(){return["AugLoop_Voice_BaseVoiceCommandResult","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return d.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),S=function(){function e(t){d.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_VoiceCommandResultsInternalSignal"},e.getBaseTypes=function(){return["AugLoop_Signals_Signal"]},e.typeGuard=function(t){return d.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),A=function(){function e(t){d.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_VoiceCommandSuggestionInternalSignal"},e.getBaseTypes=function(){return["AugLoop_Signals_Signal"]},e.typeGuard=function(t){return d.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),v=function(){function e(t){d.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_VoiceDictationSessionInitiatedSignal"},e.getBaseTypes=function(){return["AugLoop_Signals_Signal"]},e.typeGuard=function(t){return d.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),N=function(){function e(t){d.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_BaseVoiceCommandSuggestion"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return d.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),E=function(){function e(t){d.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_VoiceCommandSuggestion"},e.getBaseTypes=function(){return["AugLoop_Voice_BaseVoiceCommandSuggestion","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return d.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),I=function(){function e(t){d.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_VoiceCommandSuggestionResult"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return d.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()},180138:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LoggingAggregator=void 0;const s="n~",o=/\|\~/g;class n{constructor(){this.count=0,this.measureSums=new Map}}t.LoggingAggregator=class{constructor(e,t,i,a,r){this.buckets=new Map,this.init=e=>{this.log=e},this.add=(e,t=!0)=>{if(!this.condition||!this.condition(e))return!0===t&&this.log(e,!1),!1;const i=[];for(const t of this.dimensions)if(void 0===e[t]||null===e[t])i.push(null);else{let n="";"boolean"==typeof e[t]?n="b~":"number"==typeof e[t]&&(n=s),i.push(`${n}${e[t].toString().replace(o,"_")}`)}const a=i.join("|");let r=this.buckets.get(a);if(!r){r=new n,r.traceLevel=e.traceLevel;for(const e of this.avgMeasures)r.measureSums.set(e,0);this.buckets.set(a,r)}r.count++;for(const t of this.avgMeasures)e[t]&&r.measureSums.set(t,r.measureSums.get(t)+e[t]);return!0},this.flush=(e=!1)=>{this.buckets.forEach(((e,t)=>{const o={traceLevel:e.traceLevel,eventName:this.eventName,count:e.count},n=t.split("|");for(let e=0;e<this.dimensions.length;e++){const t=this.dimensions[e],i=n[e];0===i.indexOf("b~")?o[t]="b~true"===i:0===i.indexOf(s)?o[t]=parseInt(i.slice(2),10):o[t]=i}for(const t of this.avgMeasures)o[t]=Math.round(e.measureSums.get(t)/e.count);this.log(o,!0)})),this.buckets.clear(),e&&(this.condition=null,clearInterval(this.interval))},this.eventName=e,this.condition=t,this.dimensions=i,this.avgMeasures=a,r>0&&(this.interval=setInterval(this.flush,1e3*r))}}},182238:(e,t,s)=>{s.d(t,{b:()=>n,u:()=>i});var o=s(596498);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_ConditionalFormattingSuggestion_ConditionalFormattingSuggestionAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_ConditionalFormattingSuggestion_ConditionalFormattingSuggestionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},190028:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.loadWasmWebFromModularizeFunction=void 0;const o=s(653141),n=new Set,i=new Map,a="function"==typeof globalThis.importScripts;function r(e,t){e.src=t}function c(){return globalThis&&!globalThis.top&&(globalThis.top={}),null===globalThis||void 0===globalThis?void 0:globalThis.top}function l(e,t,s,n,i){if(!n)return!1;const a=i||c;return!!a()[e+"Module"]&&(t.resultDescription="Module Loaded From Cache",o.Log.info(538576341,o.LogCategory.WorkflowDefault,t.stop()),s(a()[e+"Module"]),!0)}t.loadWasmWebFromModularizeFunction=async function(e,t,s,u,p,g,h){const d=new o.Operation({operationName:"LoadWasmWebFromModularizeFunction",success:!0,resourceId:s,resultDescription:""}).start();return new Promise(((m,y)=>{if(l(t,d,m,u,g))return;const T=()=>{if(l(t,d,m,u,g))return;if(!self[t])return d.success=!1,d.resultDescription="ModularizeFunction Missing",o.Log.info(538576343,o.LogCategory.WorkflowDefault,d.stop()),void y(new Error("ModularizeFunction Missing"));const e={};void 0!==p&&(e.locateFile=p),e.onAbort=function(e){const t=new o.Operation({operationName:"WasmCrashHappenedOnAbortCalled",resourceId:s}).start();"string"==typeof e&&(t.resultDescription=e),o.Log.error(509154189,o.LogCategory.WorkflowDefault,t.stop())},self[t](e).then((e=>{!function(e,t,s,n,r,u){var p;if(l(e,t,s,n,u))return;a&&(globalThis.top=self);const g=u||c;n&&(g()[e+"Module"]=r,null===(p=i.get(e))||void 0===p||p.forEach((t=>{t.onSuccess(g()[e+"Module"])})),i.set(e,[])),t.dimension0=n.toString(),o.Log.info(512237901,o.LogCategory.WorkflowDefault,t.stop()),s(r)}(t,d,m,u,e,g)})).catch((e=>{var s,n;d.success=!1,d.resultDescription="ModularizeFunction Failed: "+(null!==(s=e.message)&&void 0!==s?s:"Unknown Error Message"),o.Log.info(512237900,o.LogCategory.WorkflowDefault,d.stop()),null===(n=i.get(t))||void 0===n||n.forEach((t=>{t.onError(e)})),i.set(t,[]),y(e)}))},f=e=>{var s;d.success=!1,d.resultDescription="ScriptLoad Failed: "+("string"==typeof e?e:"Unknown Error Message"),o.Log.info(538706265,o.LogCategory.WorkflowDefault,d.stop()),null===(s=i.get(t))||void 0===s||s.forEach((t=>{t.onError(e)})),i.set(t,[]),y(e)};if(u&&n.has(t)){if(l(t,d,m,u,g))return;let e=i.get(t);void 0===e&&(e=[],i.set(t,e)),e.push({onSuccess:e=>m(e),onError:e=>y(e)})}else!function(e,t,s,o){if(a)try{globalThis.importScripts(e),t()}catch(e){s(e)}else{const n=document.createElement("script");(o||r)(n,e),n.onload=function(){t(),n.remove()},n.onerror=function(e){s(e),n.remove()},document.body.appendChild(n)}}(e,T,f,h);u&&n.add(t)}))}},206855:(e,t,s)=>{s.d(t,{xB:()=>ss,Nd:()=>Yt,HF:()=>Xt,RQ:()=>Zt,fA:()=>ts});var o=s(540949),n=s(937410),i=s(599243);var a,r;!function(e){e[e.JSWebSockets=0]="JSWebSockets",e[e.LocalWorkflowsOnly=1]="LocalWorkflowsOnly",e[e.HostWebSockets=2]="HostWebSockets",e[e.HttpFallback=3]="HttpFallback"}(a||(a={})),function(e){e.Workflow="Workflow",e.Client="Client",e.HttpEndpoint="HttpEndpoint"}(r||(r={}));var c=s(679853);function l(e){if(!e)return new u([],new Set,new Map,new Map);const t=e.split(";"),s=new Set,o=new Map,n=new Map;for(const e of t){const t=e.trim();if(""===t)continue;s.add(u.normalizeName(t));const[i,...a]=t.split(":"),r=a.join(":"),c=u.normalizeName(i);if(c){o.set(c,r);const e=u.parseName(c);e&&e!==c&&n.set(e,c)}}return new u(t,s,o,n)}class u{constructor(e,t,s,o){this.originalFlights=e,this.normalizedFlights=t,this.keyValueFlightsMap=s,this.parsedFlightsMap=o}static normalizeName(e){return null==e?void 0:e.toLowerCase()}static parseName(e){const t=null==e?void 0:e.split(".");return t?t[t.length-1]:void 0}hasFlight(e){const t=u.normalizeName(e),s=this.normalizedFlights.has(t),o=this.keyValueFlightsMap.has(t),n=this.parsedFlightsMap.has(t);return s||o||n}getBooleanValue(e,t){var s,o;const n=null===(s=this.getStringValue(e))||void 0===s?void 0:s.toLowerCase(),i=null===(o=this.getStringValue(this.parsedFlightsMap.get(u.normalizeName(e))))||void 0===o?void 0:o.toLowerCase();return"true"===n||"true"===i||"false"!==n&&"false"!==i&&t}getIntValue(e,t){const s=this.getStringValue(e),o=Number.parseInt(s,10);return Number.isNaN(o)?t:o}getStringValue(e,t){var s;return null!==(s=this.keyValueFlightsMap.get(u.normalizeName(e)))&&void 0!==s?s:t}getAll(){return this.originalFlights}getAllParsed(){const e=[];return this.keyValueFlightsMap.forEach(((t,s)=>{const o=null==t?void 0:t.toLowerCase();switch(o){case"true":e.push({name:s,value:!0});break;case"false":e.push({name:s,value:!1});break;default:{const n=Number.parseInt(o,10);Number.isNaN(n)?e.push({name:s,value:t}):e.push({name:s,value:n})}}})),e}}class p{constructor(e=500,t=!1){this.prevSeq=-1,this.bufferingTimeMs=e,this.rejectOutdatedSequenceNumbers=t}sequence(e){return new Promise(((t,s)=>{if(e<this.prevSeq){if(this.rejectOutdatedSequenceNumbers){const t=new Error(`BufferingSequencer: Item out of order. Expecting seqId > ${this.prevSeq}. Actual seqId ${e}`);return t.name=p.Rejected,void s(t)}this.prevSeq=-1}e!=this.prevSeq+1&&i.tG.warn(542712385,i.nh.CoreDefault,`BufferingSequencer: got out of order sequence number. Got ${e}, expected ${this.prevSeq+1}`);const o={seq:e,resolve:t};this.insertItem(o),this.runInOrder(o,!0,!1)}))}insertItem(e){if(!this.firstQueueItem)return this.firstQueueItem=e,void(this.lastQueueItem=e);let t=this.lastQueueItem,s=null;do{if(e.seq>t.seq)return e.prev=t,t.next=e,void(s?(s.prev=e,e.next=s):this.lastQueueItem=e);s=t,t=t.prev}while(t);s&&(s.prev=e),e.next=s,this.firstQueueItem=e}runInOrder(e,t,s){let o=this.prevSeq,n=!1;const i=[];for(;this.firstQueueItem;){const t=this.firstQueueItem;if(o+1!=t.seq&&(!s||t.seq>e.seq))break;o=t.seq,t.timeout&&clearTimeout(t.timeout),i.push(t),e==t&&(n=!0),this.firstQueueItem=this.firstQueueItem.next,this.firstQueueItem&&(this.firstQueueItem.prev=null)}i.length>0&&setTimeout((()=>{for(const e of i)e.resolve(e.seq)}),0),this.prevSeq=o,!n&&t&&(e.timeout=setTimeout((()=>{this.runInOrder(e,!1,!0)}),this.bufferingTimeMs))}}p.Rejected="SequenceItemRejected";class g{constructor(e=500){this.bufferingTimeMs=500,this.workflowIdToSequencersMap=new Map,this.bufferingTimeMs=e}create(e){if(!e.ownerId)return null;let t=this.workflowIdToSequencersMap.get(e.ownerId);return t||(t=new p(this.bufferingTimeMs),this.workflowIdToSequencersMap.set(e.ownerId,t)),t}}var h=function(e,t,s,o){return new(s||(s=Promise))((function(n,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function r(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((o=o.apply(e,t||[])).next())}))};class d{constructor(e=500,t){this.sequencerFactory=null!=t?t:new g(e)}sequence(e){var t;return h(this,void 0,void 0,(function*(){const s=null===(t=null==e?void 0:e.M_)||void 0===t?void 0:t.seq;if(null==s)return;const o=this.sequencerFactory.create(e);o&&(yield o.sequence(e.M_.seq))}))}}class m{constructor(e){this.annotationSequencer=null!=e?e:new d}process(e,t,s,o){const n=[];for(const o of e.ops){const i=[];if(null==o?void 0:o.items)for(const e of o.items){const s=this.annotationSequencer.sequence(e.body).then((()=>{t(o,e)}));i.push(s)}n.push(Promise.all(i).then((()=>{s(o,e.cv)})))}Promise.all(n).then((()=>o(e)))}}class y{process(e,t,s,o){for(const o of e.ops){if(null==o?void 0:o.items)for(const e of o.items)t(o,e);s(o,e.cv)}o(e)}}class T{constructor(e,t,s){this.isOrderingEnabled=e,this.orderedAnnotationResultsProcessor=null!=t?t:new m,this.unorderedAnnotationResultsProcessor=null!=s?s:new y}process(e,t,s,o){this.isOrderingEnabled()?this.orderedAnnotationResultsProcessor.process(e,t,s,o):this.unorderedAnnotationResultsProcessor.process(e,t,s,o)}}var f=function(e,t,s,o){return new(s||(s=Promise))((function(n,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function r(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((o=o.apply(e,t||[])).next())}))};class _{constructor(e,t){this.changeGatesInitialized=!1,this.hostCallbacks=e,this.changeGateMap=t||new Map}init(){return f(this,void 0,void 0,(function*(){const e=[];this.hostCallbacks&&this.hostCallbacks.isChangeGateEnabled&&this.changeGateMap.forEach(((t,s)=>{e.push(this.hostCallbacks.isChangeGateEnabled(s).then((e=>{this.changeGateMap.set(s,e)})))})),yield Promise.all(e).then((()=>{this.changeGatesInitialized=!0})).catch((e=>{}))}))}isFeatureEnabled(e,t=!1,s="None"){return this.hostCallbacks&&this.hostCallbacks.isFeatureEnabled?this.hostCallbacks.isFeatureEnabled(e,s).catch((()=>Promise.resolve(t))):Promise.resolve(t)}isChangeGateEnabled(e){var t;return f(this,void 0,void 0,(function*(){return!this.changeGateMap||(this.changeGatesInitialized&&this.changeGateMap.has(e)?this.changeGateMap.get(e):!(!this.changeGatesInitialized&&(null===(t=this.hostCallbacks)||void 0===t?void 0:t.isChangeGateEnabled))||(yield this.hostCallbacks.isChangeGateEnabled(e)))}))}isChangeGateEnabledSync(e){var t;if(!this.changeGatesInitialized&&(null===(t=this.hostCallbacks)||void 0===t?void 0:t.isChangeGateEnabled)){const t=new n.I({operationName:"GateUtilsNotInitialized",success:!1,resultDescription:`${e}`});i.tG.error(505529628,i.nh.CoreDefault,t)}return!this.changeGateMap||(!this.changeGatesInitialized||!this.changeGateMap.has(e)||this.changeGateMap.get(e))}isChangeGatesInitialized(){return this.changeGatesInitialized}getChangeGateMap(){return this.changeGateMap}}var C,S=s(596498),A=s(133858),v=s(70239);!function(e){e[e.Undefined=0]="Undefined",e[e.Created=10]="Created",e[e.Sent=20]="Sent",e[e.Duplicated=30]="Duplicated",e[e.Seen=40]="Seen",e[e.Tried=50]="Tried",e[e.Kept=60]="Kept",e[e.Rejected=70]="Rejected"}(C||(C={}));var N=s(222709),E=s(644514),I=s(256226),w=s(59765),b=s(330328),k=s(262449),M=s(69614),L=s(622908),B=s(174025),D=s(414190),P=s(556263);function R(e,t,s=!1){let o,n,i={firstDiffLeft:0,firstDiffRight:t.length};return e.length<t.length?(o=e,n=t):(o=t,n=e),0===n.indexOf(o)?(i.firstDiffLeft=o.length,i.firstDiffRight=0):n.endsWith(o)?(i.firstDiffLeft=0,i.firstDiffRight=o.length):(i=function(e,t,s=!1){const o={firstDiffLeft:0,firstDiffRight:t.length};let n;for(n=0;n<e.length&&n<t.length;n+=1){const o=e.charCodeAt(n),i=t.charCodeAt(n);if(!(o===i||O(o,s)&&O(i,s)))break}for(o.firstDiffLeft=n,n=0;n<e.length&&n<t.length;n+=1){const o=e.charCodeAt(e.length-n-1),i=t.charCodeAt(t.length-n-1);if(!(o===i||O(o,s)&&O(i,s)))break}return o.firstDiffRight=n,o}(e,t,s),i.firstDiffLeft+i.firstDiffRight>o.length&&(i.firstDiffRight=o.length-i.firstDiffLeft)),function(e,t,s){if(e.firstDiffLeft>0){const o=e.firstDiffLeft<t.length&&x(t,e.firstDiffLeft),n=e.firstDiffLeft<s.length&&x(s,e.firstDiffLeft);(o||n)&&(e.firstDiffLeft-=1)}if(e.firstDiffRight>1){const o=e.firstDiffRight<t.length&&x(t,t.length-e.firstDiffRight),n=e.firstDiffRight<s.length&&x(s,s.length-e.firstDiffRight);(o||n)&&(e.firstDiffRight-=1)}}(i,e,t),i}function O(e,t=!1){switch(e){case 12288:case 8197:case 32:case 11:case 9:case 160:return!0;case 13:case 10:case 65532:return!t}return!1}function x(e,t){return e.charCodeAt(t)>=56320&&e.charCodeAt(t)<=57343}var F=s(297288),G=s.n(F);const W=/[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]/g,H=/[.!?]/g;function U(e,t){const s=[],o=V(e,t);return o&&s.push(o),s}function q(e,t){const s=[],o=V(e,t);o&&s.push(o);const n=function(e,t,s){var o,n,i,a,r,c;const l=e,u=t;if((null==l?void 0:l.ipPosition)===(null==u?void 0:u.ipPosition)&&(null==l?void 0:l.isColdIp)===(null==u?void 0:u.isColdIp))return;if((null==l?void 0:l.isColdIp)===(null==u?void 0:u.isColdIp)&&s)if(s.deltaType===D.WI.Add){if((null==u?void 0:u.ipPosition)===(null!==(o=s.position)&&void 0!==o?o:0)+(null!==(n=s.length)&&void 0!==n?n:0))return}else if(s.deltaType===D.WI.Update){if((null==u?void 0:u.ipPosition)===(null!==(i=s.position)&&void 0!==i?i:0)+(null!==(r=null===(a=s.content)||void 0===a?void 0:a.length)&&void 0!==r?r:0))return}else if(s.deltaType===D.WI.Delete&&(null==u?void 0:u.ipPosition)===(null!==(c=s.position)&&void 0!==c?c:0))return;return new P.s({deltaType:D.WI.CursorUpdate,cursorData:{ipPosition:null==u?void 0:u.ipPosition,isColdIp:null==u?void 0:u.isColdIp}})}(e,t,o);n&&s.push(n);const i=function(e,t,s){var o,n,i,a,r,c,l;const u=e,p=t;if((null===(o=p.formattedRanges)||void 0===o?void 0:o.length)<=(null===(n=u.formattedRanges)||void 0===n?void 0:n.length))if(s){let e=u.formattedRanges?[...u.formattedRanges]:[];const t=function(e,t,s){if(!e)return;if(t.deltaType===D.WI.Add){const t=e.find((e=>e.start===s&&0===e.length));if(t)return t;s=Math.max(s-1,0)}const o=e.find((e=>0===e.length?e.start===s:e.start<=s&&s<e.start+e.length));return o}(u.formattedRanges,s,s.position),o=t?e.indexOf(t):-1;if(-1!==o&&(s.position+(s.length||0)>t.start+t.length?t.length=s.position+(null!==(i=s.content)&&void 0!==i?i:"").length-t.start:t.length+=(null!==(a=s.content)&&void 0!==a?a:"").length-(s.length||0),e[o]=t),e.length>0){for(const t of e.slice(o+1))t.start<s.position||(s.position+(s.length||0)>t.start?(t.length=t.start+t.length-(s.position+(s.length||0)),t.start=s.position+(null!==(r=s.content)&&void 0!==r?r:"").length):t.start+=(null!==(c=s.content)&&void 0!==c?c:"").length-(s.length||0));e=e.filter((e=>e.length>0))}const n=null!==(l=null==p?void 0:p.formattedRanges)&&void 0!==l?l:[];if(G()(e,n)||0===e.length&&0===n.length)return}else if(G()(null==u?void 0:u.formattedRanges,null==p?void 0:p.formattedRanges))return;return new P.s({deltaType:D.WI.FormattingUpdate,formattedRanges:null==p?void 0:p.formattedRanges})}(e,t,o);i&&s.push(i);const a=function(e,t,s){var o;const n=e,i=t;if(!(null==n?void 0:n.attributionRanges)&&!i.attributionRanges&&!(null===(o=null==s?void 0:s.attributionData)||void 0===o?void 0:o.ranges)||G()(null==n?void 0:n.attributionRanges,null==i?void 0:i.attributionRanges))return;if(n.attributionRanges&&i.attributionRanges){const e=[];for(const t of i.attributionRanges)n.attributionRanges.some((e=>G()(e,t)))||e.push(t);if(0===e.length)return;return new P.s({deltaType:D.WI.AttributionUpdate,attributionData:{ranges:e}})}return new P.s({deltaType:D.WI.AttributionUpdate,attributionData:{ranges:null==i?void 0:i.attributionRanges}})}(e,t,o);a&&s.push(a);const r=function(e,t){const s=e,o=t;let n;const i={};let a=!1;for(n in o)-1===["ipPosition","isColdIp","content","formattedRanges","attributionRanges"].indexOf(n)&&(G()(o[n],s[n])||(a=!0,i[n]=o[n]));if(a)return new P.s({deltaType:D.WI.OtherNonContentUpdate,otherNonContentData:i});return}(e,t);return r&&s.push(r),s}function V(e,t){const s=e.content,o=t.content,n=R(s,o),i=n.firstDiffLeft,a=s.length-n.firstDiffRight,r=o.length-n.firstDiffRight;let c,l=D.WI.Update;if(s.length!==o.length)a===i?(l=D.WI.Add,c=s[s.length-1]):r===i&&(l=D.WI.Delete,c=o[o.length-1]);else if(s===o)return;let u,p=0;switch(l){case D.WI.Update:p=a-i,u=o.substring(i,r);break;case D.WI.Add:u=o.substring(i,r);break;case D.WI.Delete:p=a-i,u=s.substring(i,a)}const g=function(e,t){const s=Array.from(e.matchAll(W));if(W.lastIndex=0,0===s.length)return D.OD.Chars;if(1===s.length){if(0===s[0].index)return t&&H.test(t)?D.OD.Sentence:t&&!W.test(t)?D.OD.Word:D.OD.Chars;if(s[0].index+1===e.length)return H.test(e[s[0].index-1])?D.OD.Sentence:W.test(e[s[0].index-1])?D.OD.Chars:D.OD.Word;if(e[s[0].index-1]){const t=e[s[0].index-1];if(H.test(t))return D.OD.Sentence;if(W.test(t))return D.OD.Chars}return D.OD.Word}const o=Array.from(e.matchAll(H));if(H.lastIndex=0,0===o.length)return D.OD.PartialSentence;if(o.length>1)return D.OD.Paragraph;if(o[0].index+1<=e.length)return W.test(e[o[0].index+1])?D.OD.Sentence:D.OD.Paragraph;return}(u,c);if(void 0!==g)return new P.s({content:l!==D.WI.Delete?u:void 0,deltaType:l,unit:g,position:i,length:l!==D.WI.Add?p:0})}class ${constructor(){this.deltaBuilderHandlers=new Map,this.registerDeltaBuilderHandler(B.qf.getTypeName(),U),this.registerDeltaBuilderHandler(B.Cg.getTypeName(),q)}registerDeltaBuilderHandler(e,t){this.deltaBuilderHandlers.set(e,t)}executeDeltaBuilderHandler(e,t,s){const o=this.deltaBuilderHandlers.get(e);return o?o(t,s):[]}}const j=(e,t)=>t?z([...t,e]):e,z=e=>e.join("\\");class K{constructor(e){this.createTextTileDeltasFromItem=(e,t)=>{var s;const o=new n.I({operationName:"CreateTextTileDeltaFromItem",success:!0}).start();try{if(!e)return o.success=!1,o.resultDescription="Unable to create text tile delta, parent item is undefined",void i.tG.info(524883085,i.nh.CoreDefault,o.stop());if(!e.body)return o.success=!1,o.resultDescription="Unable to create text tile delta, parent item has undefined body",void i.tG.info(524883086,i.nh.CoreDefault,o.stop());const n=e.body;if(!B.qf.typeGuard(n))return o.success=!1,void(o.resultDescription=`Unable to create text tile delta, parent item body is not proper type: expected ${B.qf.getTypeName()}, received ${S.h.getTypeNameFor(n)}`);const a=j(e.id,t),r=null!==(s=this.lastSeenTileByTileId.get(a))&&void 0!==s?s:new B.qf({content:""}),c=this.createDeltas(r,n);return c&&0!==c.length?(o.dimension0=c.length.toString(),this.lastSeenTileByTileId.set(a,n)):(o.dimension0="0",o.resultDescription="No delta differences found"),i.tG.info(524883087,i.nh.CoreDefault,o.stop()),c}catch(e){return o.success=!1,o.resultDescription=`Error creating text tile delta: ${e}`,void i.tG.info(524883088,i.nh.CoreDefault,o.stop())}},this.lastSeenTileByTileId=null!=e?e:new Map,this.deltaBuilder=new $}addItemToLocalMap(e,t){const s=j(e.id,t),o=e.body;B.qf.typeGuard(o)&&!this.lastSeenTileByTileId.has(s)&&this.lastSeenTileByTileId.set(s,o)}deleteItemFromLocalMap(e,t){const s=j(e.id,t);this.lastSeenTileByTileId.has(s)&&this.lastSeenTileByTileId.delete(s)}moveItemsInLocalMap(e,t,s){const o=new Set(s),n=z(t),i=z(e),a=[],r=(e,t)=>e.length>t.length?e.substring(t.length+1).split("\\")[0]:void 0;for(const[e,t]of this.lastSeenTileByTileId)if(e.startsWith(n)){const s=r(e,n);if(void 0===s||o.has(s)){const s=e.replace(n,i);a.push({item:t,newPathKey:s,prevPathKey:e})}}for(const e of a)this.lastSeenTileByTileId.delete(e.prevPathKey),this.lastSeenTileByTileId.set(e.newPathKey,e.item)}createDeltas(e,t){return this.deltaBuilder.executeDeltaBuilderHandler(S.h.getTypeNameFor(t),e,t)}}var Q,J=s(366548),Y=s(447119);!function(e){e[e.Local=0]="Local",e[e.External=1]="External"}(Q||(Q={}));class Z{constructor(){this.graphNodeByLocationAndWorkflowId=new Map}getWorkflow(e,t){var s;const o=this.getLocation(t);return null===(s=this.graphNodeByLocationAndWorkflowId.get(o))||void 0===s?void 0:s.get(e)}addWorkflow(e,t=!1){if(this.getWorkflow(e.id,t)){const s=new n.I({operationName:"AddWorkflowToGraphFailure",success:!1,resourceId:e.id,resultDescription:`Adding a new with workflow with a duplicated workflowId: ${t}`}).start();return void i.tG.error(524300630,i.nh.CoreDefault,s.stop())}const s=this.getLocation(t),o=new X(e,s);this.addWorkflowAsDependency(o);let a=this.graphNodeByLocationAndWorkflowId.get(s);a||(a=new Map,this.graphNodeByLocationAndWorkflowId.set(s,a)),a.set(e.id,o)}getUpstreamRuntimeVisibleWorkflows(){const e=[];for(const t of this.graphNodeByLocationAndWorkflowId.values()||[])for(const s of t.values()||[]){const t=this.createWorkflowDefinition(s.workflow);s.workflow.visibility===I.Y$.LocalOnly?this.compressDownstreamWorkflows(t,s):t.outputTypes.push(...s.workflow.outputTypes),0!==t.inputTypes.length&&e.push(t)}return e}removeWorkflows(e){const t=this.getLocation(e),s=this.graphNodeByLocationAndWorkflowId.get(t),o=Array.from((null==s?void 0:s.values())||[]);for(const e of o){for(const t of e.upstreamWorkflows.values())t.downstreamWorkflows.delete(e);for(const t of e.downstreamWorkflows.values())t.upstreamWorkflows.delete(e);s.delete(e.workflow.id)}}getWorkflowsDefinitions(){const e=[];for(const t of this.graphNodeByLocationAndWorkflowId.values()||[])for(const s of t.values()||[])e.push(s.workflow);return e}getWorkflowNodes(e){const t=[];for(const e of this.graphNodeByLocationAndWorkflowId.values())for(const s of e.values())t.push(s);return t}getLocation(e){return e?Q.External:Q.Local}createWorkflowDefinition(e){return Object.assign(Object.assign({},e),{outputTypes:[]})}compressDownstreamWorkflows(e,t){for(const s of t.downstreamWorkflows)if(s.workflow.visibility!==I.Y$.LocalOnly){if(s.workflow.kind!==I.wC.Join||-1!==e.inputTypes.indexOf(s.workflow.collectionScopeType))for(const t of s.workflow.outputTypes)-1===e.outputTypes.indexOf(t)&&e.outputTypes.push(t)}else this.compressDownstreamWorkflows(e,s)}addWorkflowAsDependency(e){for(const t of this.graphNodeByLocationAndWorkflowId.values())for(const s of t.values()){for(const t of s.workflow.inputTypes)-1!==e.workflow.outputTypes.indexOf(t)&&this.addWorkflowChain(e,s);for(const t of s.workflow.outputTypes)-1!==e.workflow.inputTypes.indexOf(t)&&this.addWorkflowChain(s,e)}}addWorkflowChain(e,t){e.downstreamWorkflows.add(t),t.upstreamWorkflows.add(e)}}class X{constructor(e,t){this.isActivated=!0,this.upstreamWorkflows=new Set,this.downstreamWorkflows=new Set,this.location=t,this.workflow=Object.assign(Object.assign({},e),{inputTypes:Array.isArray(e.inputTypes)?e.inputTypes:[],outputTypes:Array.isArray(e.outputTypes)?e.outputTypes:[]})}}var ee=s(529510);new ee.eU("enableRichContentApis",!1);const te=e=>({id:e.id,kind:e.kind,visibility:e.visibility,collectionScopeType:e.collectionScopeType,inputTypes:e.inputTypes,outputTypes:e.outputTypes,correlatedSignals:e.correlatedSignals}),se=(e,t)=>null!=e&&(null!=t&&(e.length>0&&(e===t||0===t.indexOf(e)&&"."===t.charAt(e.length))));class oe{constructor(){this.workflowDefByWorkflowAndContextId=new Map,this.workflowDefByWorkflow=new Map}static mergeDefinitions(e,t,s){return Object.assign(Object.assign(Object.assign({},e),t),s)}mergeWorkflowDefinition(e,t,s){if(s){const o=((e,t,s)=>{let o=e.get(t);return o||(o=s(),e.set(t,o)),o})(this.workflowDefByWorkflowAndContextId,e.id,(()=>new Map));o.set(s,oe.mergeDefinitions(e,o.get(s),t))}else this.workflowDefByWorkflow.set(e.id,oe.mergeDefinitions(e,this.workflowDefByWorkflow.get(e.id),t))}getWorkflowDefinition(e,t){var s;let o;return t&&(o=null===(s=this.workflowDefByWorkflowAndContextId.get(e.id))||void 0===s?void 0:s.get(t)),o||(o=this.workflowDefByWorkflow.get(e.id)),o||(o=e),o}deleteWorkflowDefinition(e,t){const s=this.workflowDefByWorkflowAndContextId.get(e.id);s&&(s.delete(t),0===s.size&&this.workflowDefByWorkflowAndContextId.delete(e.id))}}var ne;!function(e){e.JsClient="C",e.Server="S"}(ne||(ne={}));const ie=new Set([v.Xr.getTypeName(),v.fZ.getTypeName(),v.g0.getTypeName(),v.xU.getTypeName()]);class ae{constructor(e,t){this.nextId=1,this.runtimeKind=e,this.workflowGraph=t}static isParentContextId(e,t){return se(e,t)}applyContextIdOnOperations(e){for(const t of e){const e=S.h.getTypeNameFor(t);if(this.isSupportedOperation(e))for(const e of t.items)e.contextId?e.source&&this.workflowGraph.getWorkflow(e.source,!1)?e.contextId=this.addNewContextId(e.contextId):this.tryLogMessage(new n.I({operationName:"ApplyContextIdOnOperations",success:!0}).start(),"Item with a contextId but without a workflow source atribute"):e.contextId=this.addNewContextId()}}addNewContextId(e){const t=`${this.runtimeKind}${this.nextId++}`;return e?`${e}.${t}`:t}isSupportedOperation(e){return ie.has(e)}tryLogMessage(e,t,s=!0){e&&(e.success=s,e.resultDescription=t,i.tG.verbose(527308633,i.nh.CoreDefault,e.stop()))}}var re;!function(e){e[e.Idle=1]="Idle",e[e.Pending=2]="Pending",e[e.Running=3]="Running",e[e.Executed=4]="Executed"}(re||(re={}));const ce="\\",le=(e,t)=>Object.assign(Object.assign({},t),{parentPath:e}),ue=e=>Array.isArray(e)?5===e.length?`${e[0]}${ce}${e[1]}${ce}${e[2]}${ce}${e[3]}${ce}${e[4]}`:4===e.length?`${e[0]}${ce}${e[1]}${ce}${e[2]}${ce}${e[3]}`:3===e.length?`${e[0]}${ce}${e[1]}${ce}${e[2]}`:2===e.length?`${e[0]}${ce}${e[1]}`:1===e.length?e[0]:e.join(ce):"(malformed path)";class pe{constructor(e){this.scopeItemsByContextId=new Map,this.itemsByWorkflowAndContextId=new Map,this.workflowDefinitionManager=e}setScopeItem(e,t){var s;const o=e.contextId;if(o)if(this.itemsByWorkflowAndContextId.has(t.id)||this.itemsByWorkflowAndContextId.set(t.id,new Map),this.itemsByWorkflowAndContextId.get(t.id).set(o,[]),this.scopeItemsByContextId.has(o)){if(null===(s=this.itemsByWorkflowAndContextId.get(t.id))||void 0===s?void 0:s.has(o)){const s=new n.I({resultDescription:`Trying to set new scope item: ${e.id} with already existing contextId ${o} for workflow ${t.id}`,operationName:"WIS.setScopeItem",resourceId:t.id,success:!0}).start();i.tG.verbose(527291288,i.nh.CoreDefault,s.stop())}}else this.scopeItemsByContextId.set(o,e)}updateScopeItemPath(e,t,s){var o,n;if(!e)return;const i=this.scopeItemsByContextId.get(e);if(!i)return;const a=i.parentPath;this.scopeItemsByContextId.set(e,le(t,i));const r=null!==(n=null===(o=this.itemsByWorkflowAndContextId.get(s.id))||void 0===o?void 0:o.get(e))&&void 0!==n?n:[];for(let e=0;e<r.length;e++)r[e]=le([...t,...r[e].parentPath.slice(0,a.length)],r[e])}getScopeItem(e,t){var s;for(const o of(null===(s=this.itemsByWorkflowAndContextId.get(t.id))||void 0===s?void 0:s.keys())||[])if(se(o,e))return this.scopeItemsByContextId.get(o)}addItemToWorkflowList(e,t){const s=e.contextId;if(!s)return;const o=this.itemsByWorkflowAndContextId.get(t.id);if(o)for(const[a,r]of o)if(se(a,s)){r.push(e);const s=new n.I({resultDescription:`Items for contextId ${a}: [${r.map((e=>e.id)).join(",")}]`,operationName:"WIS.addItemOnContextIdList",resourceId:t.id,success:!0}).start();i.tG.info(526403808,i.nh.CoreDefault,s.stop())}}isWorkflowReady(e,t){const s=this.workflowDefinitionManager.getWorkflowDefinition(t,e).maxAnnotations;return this.getGeneratedItems(e,t).length>=s}getItemsToExecute(e,t){const s=this.getGeneratedItems(e,t);return this.itemsByWorkflowAndContextId.get(t.id).delete(e),s}onWorkflowExecuted(e,t){const s=e.contextId,o=this.itemsByWorkflowAndContextId.get(t.id);o&&(o.delete(s),0===o.size&&this.itemsByWorkflowAndContextId.delete(t.id)),this.hasWorkflowsAwaitingExecution(s)||this.scopeItemsByContextId.delete(s)}getGeneratedItems(e,t){var s;if(!(null===(s=this.itemsByWorkflowAndContextId.get(t.id))||void 0===s?void 0:s.get(e)))return[];const o=this.workflowDefinitionManager.getWorkflowDefinition(t,e).maxAnnotations;return this.itemsByWorkflowAndContextId.get(t.id).get(e).slice(0,o)}hasWorkflowsAwaitingExecution(e){for(const t of this.itemsByWorkflowAndContextId.values())for(const s of t.keys())if(s===e)return!0;return!1}}var ge,he=s(303129),de=s(292627),me=s(152871),ye=s(440714),Te=s(934142);!function(e){e.InvalidType="invalid_type",e.InvalidEnum="invalid_enum",e.NumberMax="number_max",e.NumberMin="number_min",e.LengthMin="length_min",e.LengthMax="length_max",e.ItemsMax="items_max",e.ItemsMin="items_min",e.ItemsUnique="items_unique",e.PropertiesMax="properties_max",e.PropertiesMin="properties_min",e.Required="required",e.Custom="custom"}(ge||(ge={}));var fe=function(e,t,s,o){return new(s||(s=Promise))((function(n,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function r(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((o=o.apply(e,t||[])).next())}))};const _e=new ee.eU("processAndRejectMessageEndpointValidation",!1),Ce=new ee.eU("messageValidationAllowList",[{code:ge.Required,className:"",path:[],message:""},{code:ge.InvalidType,className:"SchemaObjectHeader",path:["config"],message:"SchemaObjectHeader: Expected object, got undefined object for SchemaObjectHeaderValidator"},{code:ge.InvalidType,className:"Item",path:["item","id"],message:'Required field "id" is wrong type'},{code:ge.InvalidType,className:"Item",path:["ops","*","items","0","id"],message:'Required field "id" is wrong type'}]);var Se,Ae;function ve(e){const t=["AugLoop_Excel_Session_Protocol_","AugLoop_Powerpoint_Session_Protocol_","AugLoop_Session_Protocol_"];let s;for(const o of t)if(0===e.indexOf(o)){s=o;break}if(!s)return"MalformedMessageName";const o="Message",n=e.indexOf(o,e.length-7)===e.length-7;return e.slice(s.length,n?-7:void 0)}!function(e){e.ClientDisconnected="Client disconnected.",e.ClientClosed="Client closed",e.UnsupportedSyncMessage="SyncMessages with seq = -1 are not supported anymore.",e.UnexpectedSeedMessage="Unexpected seed message",e.SyncMessageUnsupportedBatch="SyncMessage with unsupported batching.",e.AnnotationTokenNotFound="Token not found",e.TooManyDeltaOperations="SyncMessage with too many delta operations",e.UnsupportedSyncMessageSeq0NonSeeding="SyncMessages with seq 0 are not supported in non seeding sequencer (SenderId)."}(Se||(Se={})),function(e){e.ProvisionTokenValidationError="Token provision message didn't pass token validation.",e.ProvisionTokenDecryptAndTransformError="Token provision message didn't pass token decrypt and transform."}(Ae||(Ae={}));class Ne{constructor(e){this.config=e,this.nextMessageId=1,this.pendingResponseCallbacks=new Te.l({sweepInterval:5e3}),this.messageCallbacks=new Map,this.messageValidators=new Map,this.messageIdPrefix=e.messageIdPrefix,this.source="c"===e.messageIdPrefix?me.aM.ClientRuntime:me.aM.Core,this.stats={sendMessageCount:0,sendMessageClientDisconnectedErrors:0,sendMessageErrors:0,sendMessageDurationMsMax:0,processMessageCount:0,processMessageProvisionTokenErrors:0,processMessageErrors:0,processMessageDurationMsMax:0};const t=e=>e.map((e=>({code:(null==e?void 0:e.code)||"",className:(null==e?void 0:e.className)||"",path:(null==e?void 0:e.path)||[]}))),s=t(Ce.getDefaultValue()),o=t(Ce.getValue());Ce.getDefaultValue()===Ce.getValue()?this.messageValidationAllowListFull=s:this.messageValidationAllowListFull=[...s,...o.filter((e=>e.code))]}setClientMetadata(e){this.clientMetadata=e}setEgress(e){this.egress=e,this.config.resendPendingMessagesOnReconnect&&this.egress&&this.pendingResponseCallbacks.forEach(((e,t)=>{e.logOp.dimension1=(e.sendCount++).toString(),this.egress(e.message,(t=>this.onEgressError(t,e)))}))}ingress(e,t){M.YK.typeGuard(e)?(this.processResponse(e),t()):this.processMessage(e,t),M.w9.typeGuard(e)&&!e.reconnectAllowed&&this.clearAllPendingResponses()}sendMessage(e,t,s,o=0){var n,a;const r=new me.vf({sessionHealthEventName:"SendMessage",source:this.source,reason:me.l6.Client,impact:this.source===me.aM.ClientRuntime?me.Pq.MissingInput:me.Pq.MissingOutput,success:!0,message:"",affectedWorkflows:["All"],cv:e.cv,resourceId:ve(S.h.getTypeNameFor(e)),dimension0:o.toString()}).start().enableAggregation(),c=()=>{if(r.setClientMetadata(this.clientMetadata),r.success)i.tG.info(572836e3,i.nh.CoreDefault,r.stop());else{const e="ErrorWithoutPendingResponse"===r.resultSignature||"ResponseCallbackException"===r.resultSignature||"We called into done callback"!==r.message;r.message=JSON.stringify({errorNotPropagatedToDoneCallback:e}),i.tG.error(572836001,i.nh.CoreDefault,r.stop())}};(0,ye.I)("PersistMessageId")?e.messageId=null!==(n=e.messageId)&&void 0!==n?n:`${this.messageIdPrefix}${this.nextMessageId++}`:e.messageId=`${this.messageIdPrefix}${this.nextMessageId++}`,M.l0.typeGuard(e)&&e.messages.forEach(((t,s)=>t.messageId=e.messageId+"."+s));const l=S.h.getTypeNameFor(e)===M.w9.getTypeName(),u={message:e,logOp:r,logEvent:c,callback:void 0,sendCount:1};if(!s&&!l){u.callback=(s,o)=>{var n;if(s?(0,ye.I)("IgnoreUnsupportedMessageErrorForOldClientVersion")&&s.code===de.xv.UnsupportedMessage?(r.resultSignature="Success",r.resultDescription=`Ignore error for ${S.h.getTypeNameFor(e)} message ${e.messageId}${M.Tb.typeGuard(e)?`, seq ${e.seq}`:""}: ${s.error}`):(r.success=!1,r.resultSignature=s.error,r.resultDescription=`Error for ${S.h.getTypeNameFor(e)} message ${e.messageId}${M.Tb.typeGuard(e)?`, seq ${e.seq}`:""}: ${s.error}`):r.resultSignature="Success",t)try{r.message="We called into done callback",t(s,o)}catch(e){r.success=!1,r.resultSignature="ResponseCallbackException",r.resultDescription="Web"===(null===(n=this.clientMetadata)||void 0===n?void 0:n.appPlatform)?JSON.stringify({message:e.message,stack:e.stack}):JSON.stringify({message:e.message})}c(),this.updateSendMessageStats(r.success,r.durationMs,s?new Error(s.error):void 0)};const s=()=>{u.callback(new M.F_({code:de.xv.RequestTimeout,error:"Timeout waiting for response"}),void 0)};let o=this.config.responseTimeoutMs;if(M.LQ.typeGuard(e)){const t=e;o=t.longPollTimeoutHint>=15e3&&t.longPollTimeoutHint<=3e5?t.longPollTimeoutHint+5e3:12e4}else M.Yp.typeGuard(e)&&(o=null!==(a=e.maxDelayMs)&&void 0!==a?a:12e4);this.pendingResponseCallbacks.put(e.messageId,u,o,s)}this.egress&&this.egress(e,(e=>this.onEgressError(e,u)),o)}onEgressError(e,t){var s,o;if(e){const n=t.message,i=this.pendingResponseCallbacks.get(t.message.messageId);i?(this.pendingResponseCallbacks.del(n.messageId),i.callback(new M._p({messageId:n.messageId,code:de.xv.EgressError,error:e.message}))):M.w9.typeGuard(n)?(t.logOp.success=null!==(o=null===(s=e.message)||void 0===s?void 0:s.endsWith("Client disconnected."))&&void 0!==o&&o,t.logOp.resultSignature="ErrorSendingSessionCloseMessage",t.logOp.resultDescription=`Error for ${S.h.getTypeNameFor(n)} message ${n.messageId}: ${e.message}`,t.logEvent()):(t.logOp.success=!1,t.logOp.resultSignature="ErrorWithoutPendingResponse",t.logOp.resultDescription=`Error for ${S.h.getTypeNameFor(n)} message ${n.messageId}: ${e.message}`,t.logEvent())}}queryEgressCacheSize(){return this.pendingResponseCallbacks.size()}onMessage(e,t,s){this.messageCallbacks.set(e,t),s&&this.messageValidators.set(e,s)}onMessageAsync(e,t,s){this.messageCallbacks.set(e,((e,s)=>fe(this,void 0,void 0,(function*(){try{const o=yield t(e);M._p.typeGuard(o)?s(o,void 0):s(void 0,o)}catch(e){s(e)}})))),s&&this.messageValidators.set(e,s)}getStats(){return this.stats}hasMessageCallback(e){return this.messageCallbacks.has(e)}cancelPendingResponseCallbacks(e){this.pendingResponseCallbacks.forEach(((t,s)=>{t&&(this.pendingResponseCallbacks.del(s),t.callback(new M._p({messageId:s,code:de.xv.Cancelled,error:`Cancelled. Reason: ${e}`})))}))}clearAllPendingResponses(){if(0==this.pendingResponseCallbacks.size())return;const e=new n.I({operationName:"PurgePendingResponses",resultDescription:this.pendingResponseCallbacks.size().toString(),success:!0});i.tG.info(572836002,i.nh.CoreDefault,e),this.pendingResponseCallbacks.clear()}processMessage(e,t){var s,o,a,r;const c=new me.vf({sessionHealthEventName:"ProcessMessage",source:this.source,reason:me.l6.Client,impact:this.source===me.aM.ClientRuntime?me.Pq.MissingOutput:me.Pq.MissingInput,success:!0,message:"",affectedWorkflows:["All"],cv:e.cv}).start().enableAggregation(),l=()=>{if(c.setClientMetadata(this.clientMetadata),c.success)i.tG.info(572836003,i.nh.CoreDefault,c.stop());else{const e="UnsupportedMessage"===c.resourceId||"Timeout"===c.resultSignature||"OnResponseInvokedMoreThanOnce"===c.resultSignature||"MessageCallbackException"===c.resultSignature||"We called into messageCallback"!==c.message;c.message=JSON.stringify({errorHappenedOutsideRegisteredMessageCallback:e}),i.tG.error(572836032,i.nh.CoreDefault,c.stop())}},u=this.messageValidators.get(S.h.getTypeNameFor(e)),p=(null===(o=null===(s=this.clientMetadata)||void 0===s?void 0:s.userAgent)||void 0===o?void 0:o.startsWith("test-suite"))||(null===(r=null===(a=this.clientMetadata)||void 0===a?void 0:a.userAgent)||void 0===r?void 0:r.startsWith("e2e-test"));let g;if((0,ye.I)("enableMessageValidation")&&u&&!p){const t=new n.I({operationName:"MessageValidationFailure",resourceId:ve(S.h.getTypeNameFor(e)),success:!1,resultDescription:""},{metricDuration:!0}).start(),s=u.validate(e);if(t.success=s.success,!s.success){const o=s.errors;let n=!0;for(const e of o){let t=!1;for(const s of this.messageValidationAllowListFull)if(e.code!==s.code||s.className||0!==s.path.length){if(e.code===s.code&&e.className===s.className&&e.path.length===s.path.length&&e.path.every(((e,t)=>e===s.path[t]||"*"===s.path[t]))){t=!0;break}}else t=!0;n=n&&t}n?t.dimension0="ValidationErrorAllowed":(t.dimension0="ValidationErrorNotAllowed",g=`Message type ${S.h.getTypeNameFor(e)} had a type validation error`),s.errors?(s.errors.length>0&&(t.dimension1=s.errors[0].code),t.setDataFields({errors:JSON.stringify(s.errors)}),t.resultDescription="List of error messages: "+s.errors.map((e=>e.message)).join(", ")):(t.setDataFields({errors:"No validation errors provided"}),t.resultDescription="Validation failed with no specific errors"),i.tG.info(504971855,i.nh.CoreDefault,t.stop())}}let h=this.messageCallbacks.get(S.h.getTypeNameFor(e));h?(c.resourceId=ve(S.h.getTypeNameFor(e)),_e.getValue()&&g&&(i.tG.error(504729920,i.nh.CoreDefault,`Rejecting message ${e.messageId} due to validation error`),h=(e,t)=>{t(new M._p({messageId:e.messageId,code:de.xv.MessageValidationError,error:g}))})):h=(e,t)=>{c.resourceId=ve(S.h.getTypeNameFor(e)),"MalformedMessageName"!==c.resourceId&&(c.resourceId="UnsupportedMessage"),t(new M._p({messageId:e.messageId,code:de.xv.UnsupportedMessage,error:`Message type ${S.h.getTypeNameFor(e)} is not supported`}))};const d=(e,t)=>void 0!==t?JSON.stringify({message:e,stack:t}):e;let m=!1;const y=(s,o)=>{if(m){c.success=!1,c.resultSignature="OnResponseInvokedMoreThanOnce";const t=`Invoked onResponse for ${S.h.getTypeNameFor(e)} message ${e.messageId} more than once`;c.resultDescription=d(t)}else if(s){c.success=!1,c.resultSignature=s.error,void 0!==s.code&&(c.dimension0=de.xv[s.code]);const t=`Error for ${S.h.getTypeNameFor(e)} message ${e.messageId}: ${s.error}`;c.resultDescription=d(t)}else c.resultSignature="Success",c.resultDescription=d("");m=!0,l(),s&&!S.h.matchesTypesFor(s,[M._p.getTypeName()])&&(s=new M._p({error:"Internal Server Error"})),this.updateProcessMessageStats(c.success,c.durationMs,s?new Error(s.error):void 0),s?(s.messageId=e.messageId,t(s)):o?(o.messageId=e.messageId,t(void 0,o)):t()};try{c.message="We called into messageCallback",h(e,y)}catch(e){c.success=!1,c.resultSignature="MessageCallbackException",c.resultDescription=d(e.message,e.stack),l(),this.updateProcessMessageStats(!1,c.durationMs,e),t()}}processResponse(e){var t;const s=new n.I({operationName:"ProcessResponse"});if(s.success=!0,s.setClientMetadata(this.clientMetadata),s.start(),e.messageId){const t=this.pendingResponseCallbacks.get(e.messageId),o=null==t?void 0:t.callback;if(o){if(M.i.typeGuard(e)&&!e.finalResponse){const s=t.message.maxDelayMs;this.pendingResponseCallbacks.updateExpireTime(e.messageId,s)}else this.pendingResponseCallbacks.del(e.messageId);S.h.matchesTypesFor(e,[M._p.getTypeName()])?o(e):o(void 0,e)}else s.resultSignature="NoPendingMessage",s.resultDescription=`${e.messageId}`,s.success=!1}else s.resultSignature="NoMessageIdSetInResponse",M._p.typeGuard(e)?s.resultDescription=e.error:s.resultDescription="MessageId is not available",s.success=!1;"Production"!==(null===(t=this.clientMetadata)||void 0===t?void 0:t.releaseAudienceGroup)&&(s.resourceId=ve(S.h.getTypeNameFor(e)),i.tG.info(572836034,i.nh.CoreDefault,s.stop()))}updateSendMessageStats(e,t,s){this.stats.sendMessageCount++,this.stats.sendMessageDurationMsMax=Math.max(t,this.stats.sendMessageDurationMsMax),e||s?e&&s&&i.tG.warn(572836036,i.nh.CoreDefault,"Succeeded send message provided error object."):i.tG.warn(572836035,i.nh.CoreDefault,"Failed send message did not provide error object."),e||(s&&s.message===Se.ClientDisconnected?this.stats.sendMessageClientDisconnectedErrors++:this.stats.sendMessageErrors++)}updateProcessMessageStats(e,t,s){this.stats.processMessageCount++,this.stats.processMessageDurationMsMax=Math.max(t,this.stats.processMessageDurationMsMax),e||s?e&&s&&i.tG.warn(572836038,i.nh.CoreDefault,"Succeeded process message provided error object."):i.tG.warn(572836037,i.nh.CoreDefault,"Failed process message did not provide error object."),e||(s&&s.message===Ae.ProvisionTokenValidationError?this.stats.processMessageProvisionTokenErrors++:this.stats.processMessageErrors++)}}var Ee=s(336831);class Ie{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){S.h.assign(Ie,this,e)}static getTypeName(){return"AugLoop_Core_Apology"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return S.h.matchesTypesFor(e,[Ie.getTypeName()])}}Ie.H_={T_:Ie.getTypeName(),B_:Ie.getBaseTypes()};class we{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){S.h.assign(we,this,e)}static getTypeName(){return"AugLoop_Core_SecondaryApology"}static getBaseTypes(){return["AugLoop_Core_Apology","AugLoop_Core_Annotation"]}static typeGuard(e){return S.h.matchesTypesFor(e,[we.getTypeName()])}}we.H_={T_:we.getTypeName(),B_:we.getBaseTypes()};class be{constructor(e){S.h.assign(be,this,e)}static getTypeName(){return"AugLoop_Core_WorkflowActivationFailureDetails"}static getBaseTypes(){return[]}static typeGuard(e){return S.h.matchesTypesFor(e,[be.getTypeName()])}}be.H_={T_:be.getTypeName(),B_:be.getBaseTypes()};class ke{constructor(e){S.h.assign(ke,this,e)}static getTypeName(){return"AugLoop_Core_AuthTokenIsMissingDetails"}static getBaseTypes(){return["AugLoop_Core_WorkflowActivationFailureDetails"]}static typeGuard(e){return S.h.matchesTypesFor(e,[ke.getTypeName()])}}ke.H_={T_:ke.getTypeName(),B_:ke.getBaseTypes()};class Me{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){S.h.assign(Me,this,e)}static getTypeName(){return"AugLoop_Core_NotActivatedWorkflowApology"}static getBaseTypes(){return["AugLoop_Core_Apology","AugLoop_Core_Annotation"]}static typeGuard(e){return S.h.matchesTypesFor(e,[Me.getTypeName()])}}Me.H_={T_:Me.getTypeName(),B_:Me.getBaseTypes()};var Le=s(73401);const Be=(e,t)=>{const s=[];for(const o of null!=e?e:[])if(void 0===t||t===o.cardinality)for(const e of o.contextTypes)s.push([e,o.cardinality,o.producerWaitPolicy]);return s};class De{constructor(e,t,s,o){this.sendMessage=e,this.annotationType=t,this.options=s,this.token=`${t}-${De.nextActivationResultBatchId++}`,this.annotationDoesNotExistOnServiceEnabled=o}activate(e,t,s){return new Promise(((o,n)=>{this.sendMessage(new M.n4({annotationType:this.annotationType,token:this.token,config:this.options?this.options.config:void 0,ignoreExistingAnnotations:e,sendStateUpdates:this.options?!!this.options.stateUpdateCallback:void 0,forceReturnCachedAnnotations:this.options?this.options.forceReturnCachedAnnotations:void 0,returnAnnotationDoesNotExist:this.annotationDoesNotExistOnServiceEnabled||!1,sendApologies:s}),((e,t)=>{e?n(new Error(e.error)):(M.PY.typeGuard(t)&&this.annotationDoesNotExistOnServiceEnabled&&(this.annotationDoesNotExistOnService=t.annotationNotExists),o({token:this.token}))}),t)}))}release(){return new Promise(((e,t)=>{this.annotationDoesNotExistOnService&&this.annotationDoesNotExistOnServiceEnabled?e(!1):this.sendMessage(new M.GA({token:this.token}),((s,o)=>{s?t(new Error(s.error)):e(o.lastRelease)}))}))}}De.nextActivationResultBatchId=1;var Pe=s(946233),Re=s(177556),Oe=s(309156);class xe extends Oe.EventEmitter{init(){return Promise.resolve()}sendMessage(e,t,s){}onMessage(e,t){}forceReconnect(){return Promise.resolve()}closeSession(){}sendBytes(e){}getCorrelationVector(){return new Y.W}getNetworkWorkerManager(){}setState(e){}}var Fe=s(172141),Ge=s(796462),We=function(e,t,s,o){return new(s||(s=Promise))((function(n,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function r(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((o=o.apply(e,t||[])).next())}))},He=function(e){return this instanceof He?(this.v=e,this):new He(e)},Ue=function(e,t,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,n=s.apply(e,t||[]),i=[];return o={},a("next"),a("throw"),a("return"),o[Symbol.asyncIterator]=function(){return this},o;function a(e){n[e]&&(o[e]=function(t){return new Promise((function(s,o){i.push([e,t,s,o])>1||r(e,t)}))})}function r(e,t){try{(s=n[e](t)).value instanceof He?Promise.resolve(s.value.v).then(c,l):u(i[0][2],s)}catch(e){u(i[0][3],e)}var s}function c(e){r("next",e)}function l(e){r("throw",e)}function u(e,t){e(t),i.shift(),i.length&&r(i[0][0],i[0][1])}};var qe;!function(e){e[e.LocalWorkflow=0]="LocalWorkflow",e[e.ServerWorkflow=1]="ServerWorkflow",e[e.Submitted=2]="Submitted"}(qe||(qe={}));const Ve=(e,t)=>{t?(e.resultDescription=t,e.success=!1,i.tG.error(509203144,i.nh.CoreDefault,e.stop())):i.tG.info(509203143,i.nh.CoreDefault,e.stop())},$e=e=>!e.items.some((e=>e.source&&0===e.source.indexOf("ThirdParty")));class je{constructor(e){var t,s;this.annotationActivationTrackers=new Map,this.annotationCallbacks=new Map,this.apologyCallbacks=new Map,this.annotationResultStates=new Map,this.tokensByAnnotationType=new Map,this.registeredContextTypes=new Set,this.availableContexts=new Map,this.nextSyncSequenceId=1,this.allowSeed=!0,this.allowGroupSeed=!0,this.seedGroupSize=0,this.batchedSeedMessageGroupSize=0,this.hasSessionConnected=!1,this.isSessionClosed=!1,this.serverAuthenticationState=k.f.NotAuthenticated,this.sessionCloseCallbacks=new Map,this.connectCallbacks=new Map,this.reconnectCallbacks=new Map,this.disconnectCallbacks=new Map,this.sessionStateCallbackToken=0,this.workflowGraph=new Z,this.workflowDefinitionManager=new oe,this.contextIdManager=new ae(ne.JsClient,this.workflowGraph),this.workflowItemStorage=new pe(this.workflowDefinitionManager),this.pendingConnectCallbacks=[],this.onAnnotationsSubmittedEnabled=!1,this.reduceBatchOperationsEnabled=!1,this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled=!1,this.batchMessagesEnabled=!1,this.seedingStatus=de.e9.NotStarted,this.onConnectTelemetryCG=void 0,this.cachedClaimsChallenge={claimsVersion:0,actionRequired:!1},this.tokenMessageVersion=1,this.hostCallbacks=e.hostCallbacks,this.sessionManager=e.sessionManager,this.batchMessagesEnabled=e.batchMessagesEnabled||!1,this.reduceBatchOperationsEnabled=e.reduceBatchOperationsEnabled||!1,this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled=e.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled||!1,this.operationBatchConfig=e.batchOptions?this.getOperationBatchConfig(e.batchOptions):void 0,this.extensionConfigs=e.extensionConfigs,this.clientMetadata=e.clientMetadata,this.userContext=e.userContext,this.localWorkflowManager=e.localWorkflowManager,this.annotationResultsProcessor=e.annotationResultsProcessor,this.gateUtils=e.gateUtils,this.localRegisteredWorkflows=e.localRegisteredWorkflows||[],this.enableRemoteExecutionNotification=e.enableRemoteExecutionNotification||!1,this.networkMode=e.networkMode,this.egress=e.egress,this.serverAuthenticationStateChangeCallback=[],this.claimsChallengeCallback=[],this.seedingStatusChangeCallbacks=[],this.onAnnotationsSubmittedEnabled=e.onAnnotationsSubmittedEnabled||!1,this.annotationDoesNotExistOnServiceEnabled=e.annotationDoesNotExistOnServiceEnabled||!1,this.sessionManager.on("sessionClose",this.onSessionClose.bind(this)),this.sessionManager.on("reconnect",this.onReconnect.bind(this)),this.sessionManager.on("connect",this.onConnect.bind(this)),this.sessionManager.on("disconnect",this.onDisconnect.bind(this)),this.sessionManager.on("resetNextSyncSequenceId",this.resetNextSyncSequenceId.bind(this)),this.sessionManager.on("serverAuthenticationStateChange",this.onServerAuthenticationStateChange.bind(this)),this.sessionManager.onMessage(M.B_.getTypeName(),this.onAnnotationResultsFromServer.bind(this)),this.sessionManager.onMessage(M.$j.getTypeName(),this.onAnnotationResultStateMessage.bind(this)),this.sessionManager.onMessage(M.Gs.getTypeName(),this.onWorkflowExecutionCompleteMessage.bind(this)),this.sessionManager.onMessage(M.Sy.getTypeName(),this.onClaimsChallengeMessage.bind(this)),this.sessionManager.onMessage(M.fr.getTypeName(),this.onSeedingStatusChangeMessage.bind(this)),e.isDeltaGeneratorEnabled&&(this.enableSyncDeltaSending=!e.disableSyncDeltaSending,this.syncDeltaTimeout=null!==(t=e.syncDeltaTimeout)&&void 0!==t?t:700,this.enableDeltaGenerator()),this.setServerAuthenticationStateChangeCallback(this.updateGraphOnAuthStateChange.bind(this)),(null===(s=this.gateUtils)||void 0===s?void 0:s.isChangeGateEnabledSync(Yt))||this.setClaimsChallengeCallback(this.requestAuthTokenWithClaims.bind(this))}enabledRemoteExecutionNotification(){return this.enableRemoteExecutionNotification}getSessionReconnectParams(){if(!this.connectParams)throw new Error("Session has not been established yet.");return{sessionUrl:this.connectParams.sessionUrl,origin:this.connectParams.origin,authToken:this.connectParams.authToken,nextSyncSequenceId:this.nextSyncSequenceId}}setNextSequenceId(e){this.nextSyncSequenceId=e}tryGetDocSessionId(){if(this.clientMetadata&&this.clientMetadata.docSessionId)return this.clientMetadata.docSessionId}getSessionStateCallbackToken(e){var t;return e+"-callback-"+(null!==(t=this.tryGetDocSessionId())&&void 0!==t?t:"unknown")+"-"+this.sessionStateCallbackToken++}updateGraphOnAuthStateChange(e){this.tryActivateWorkflows()}tryActivateWorkflows(){if(this.enableRemoteExecutionNotification){const e=new n.I({operationName:"GraphServerWorkflowActivation",success:!0}).setClientMetadata(this.clientMetadata).start(),t=[];this.workflowGraph.getWorkflowNodes().filter((e=>e.location===Q.External)).forEach((e=>{this.localWorkflowManager.canActivateWorkflow(e,this)?e.isActivated=!0:(this.localWorkflowManager.deactivateServerWorkflow(e,this),t.push(e.workflow.id))})),e.resultDescription=`deactivated workflows: [${t.join()}]`,i.tG.info(508879493,i.nh.CoreDefault,e.stop())}}initialize(){return We(this,void 0,void 0,(function*(){return this.localWorkflowManager&&this.localWorkflowManager.addSession(this),this.registerLocalWorkflowsWithoutGraphInit(this.localRegisteredWorkflows),this.gateUtils&&!this.onConnectTelemetryCG&&(this.onConnectTelemetryCG=yield this.gateUtils.isChangeGateEnabled("OnConnectTelemetry")),yield this.sessionManager.init(this.extensionConfigs,this.hostCallbacks.onInitSession?this.hostCallbacks.onInitSession:void 0,this.egress),this.localWorkflowManager&&this.localWorkflowManager.setTokenCallback(this.getAuthToken.bind(this)),this}))}isLocalWorkflowRegistered(e){return this.getLocalRegisteredWorkflows().some((t=>e===t.id))}get isConnected(){return!!this.connectParams}get hasConnected(){return this.hasSessionConnected}get isClosed(){return this.isSessionClosed}getServerAuthenticationState(){return this.serverAuthenticationState}getContextIdManager(){return this.contextIdManager}getWorkflowItemStorage(){return this.workflowItemStorage}getWorkflowDefinition(e,t){return this.workflowDefinitionManager.getWorkflowDefinition(e,t)}registerLocalWorkflows(e){this.registerLocalWorkflowsWithoutGraphInit(e),this.trySendWorkflowGraphInitMessage()}registerLocalWorkflowsWithoutGraphInit(e){if(e.length&&this.localWorkflowManager)for(const t of e)this.localWorkflowManager.registerLocalWorkflow(t,this)}registerLocalWorkflow(e){this.registerLocalWorkflows([e]);const t=new n.I({operationName:"SessionRegisterLocalWorkflow",resourceId:e.id,success:!0}).setClientMetadata(this.clientMetadata).start();Ve(t)}activateAnnotation(e,t,s){var o;const n=new De(this.sendMessageToSession.bind(this),e,t,this.annotationDoesNotExistOnServiceEnabled),i=(t,s)=>{let o=t.get(e);o||(o=new Map,t.set(e,o)),o.set(n.token,s)};(null==t?void 0:t.callback)&&i(this.annotationCallbacks,null==t?void 0:t.callback),(null==t?void 0:t.apologyCallback)&&i(this.apologyCallbacks,null==t?void 0:t.apologyCallback);const a=null!==(o=this.tokensByAnnotationType.get(e))&&void 0!==o?o:[];return-1===a.indexOf(n.token)&&a.push(n.token),this.tokensByAnnotationType.set(e,a),this.annotationActivationTrackers.set(n.token,n),this.activateAnnotationForTracker(n,{ignoreExistingAnnotations:!1,sendOnlyIfConnected:!1,sendApologies:void 0!==(null==t?void 0:t.apologyCallback)})}activateServerRequestResponse(e,t,s){return We(this,void 0,void 0,(function*(){yield this.activateAnnotation(e,{callback:(e,s)=>{for(const s of e.items){const e=new n.I({operationName:"ServerRequestResponseAnnotationReceived",success:!0}).setClientMetadata(this.clientMetadata).start(),o=s.body;if(!(null==o?void 0:o.workflowExecutionCorrelation)){const t="Received annotation without workflowExecutionCorrelation";throw Ve(e,t),new Error(t)}let i=!1;const a=(t,s)=>{if(i){const t="Final response has already been sent for this annotation";throw Ve(e,t),new Error(t)}i=void 0===s||s;const n=new M.iT({workflowExecutionCorrelation:o.workflowExecutionCorrelation,finalResponse:i,content:t}),a=this.submitCustomMessage(n).catch((t=>{throw Ve(e,`Error submitting response: ${t.message}`),t}));return s&&Ve(e),a};null==t||t.onAnnotationCallback(o,a).catch((t=>{Ve(e,`Error in onAnnotationCallback: ${t.message}`)}))}}},s)}))}activateAnnotationForTracker(e,t){const s=new n.I({operationName:"ActivateAnnotation",resourceId:e.annotationType,success:!0}).setClientMetadata(this.clientMetadata).start();return s.setDataField("StartTimestamp",Date.now()),e.activate(t.ignoreExistingAnnotations,t.sendOnlyIfConnected,t.sendApologies).then((o=>(s.resultSignature="Ok",s.resultDescription=`Activated annotation ${e.annotationType} with token ${e.token}; sendOnlyIfConnected: ${t.sendOnlyIfConnected}`,Ve(s),o))).catch((o=>{throw Ve(s,`error on activate annotation type ${e.annotationType}: ${o}; sendOnlyIfConnected: ${t.sendOnlyIfConnected}`),o}))}updateAnnotationConfig(e,t){const s=new M.Ol({token:e,config:t});this.sendMessageToSession(s);const o=this.annotationActivationTrackers.get(e);o&&o.options&&(o.options.config=t)}releaseAnnotation(e){const t=this.annotationActivationTrackers.get(e);if(t){this.annotationActivationTrackers.delete(e);const s=s=>{const o=s.get(t.annotationType);o&&(o.delete(e),0==o.size&&s.delete(t.annotationType))};return s(this.annotationCallbacks),s(this.apologyCallbacks),t.release()}return Promise.resolve(!1)}setAnnotationState(e,t,s){const o={state:s};this.submitOperation(new v.XP({parentPath:e,items:[{id:t}],M_:o}))}setAnnotationMetadata(e,t,s){this.submitOperation(new v.XP({parentPath:e,items:[{id:t}],M_:s}))}submitOperation(e,t){this.submitOperations([e],t)}submitOperations(e,t){var s,o;if(t||(t=this.generateCorrelationId()),(0,Fe.BG)(e,t,Date.now(),"SubmitInRuntimeClient",new n.I({operationName:"AugloopClientPerfTracker",success:!0}).setClientMetadata(this.clientMetadata).start()),this.contextIdManager.applyContextIdOnOperations(e),this.updateWorkflowExecutionStates(e),!this.onAnnotationsSubmittedEnabled){const[s,o]=this.partitionAnnotationOperations(e);this.executeCallbacksOnAnnotationSubmitted(s,t)}const i=e.filter(this.filterOperationsForSession.bind(this)).filter($e),a=[];if(this.deltaGenerator){const e=new n.I({operationName:"ExecuteDeltaGenerator",success:!0}).setClientMetadata(this.clientMetadata).start();for(const e of i)if(v.fZ.typeGuard(e))a.push(...this.createDeltasFromUpdateOperation(e));else{const t=e;for(const n of t.items)v.Xr.typeGuard(e)?this.deltaGenerator.addItemToLocalMap(n,t.parentPath):v.n4.typeGuard(e)?this.deltaGenerator.deleteItemFromLocalMap(n,t.parentPath):v.hW.typeGuard(e)&&this.deltaGenerator.moveItemsInLocalMap(e.parentPath,e.prevParentPath,null!==(o=null===(s=e.items)||void 0===s?void 0:s.map((e=>e.id)))&&void 0!==o?o:[]);a.push(e)}Ve(e)}if(this.onAnnotationsSubmittedEnabled){const[e,s]=this.partitionAnnotationOperations(a.length?a:i);this.onAnnotationsSubmitted(e,t),this.submitOperationsToSession(s,t)}else this.submitOperationsToSession(a.length?a:i,t);this.localWorkflowManager&&this.localWorkflowManager.runLocalWorkflows(e,this,!0)}submitSeedOperations(e,t){if(!this.allowSeed)throw new Error("Cannot submit seed operations more than once per session");if(this.networkMode===a.LocalWorkflowsOnly&&this.localWorkflowManager)return void this.localWorkflowManager.runLocalWorkflows(e,this);t||(t=this.generateCorrelationId()),this.allowSeed=!1,this.allowGroupSeed=!1;const[s,o]=this.partitionAnnotationOperations(e);this.onAnnotationsSubmittedEnabled?this.onAnnotationsSubmitted(s,t):this.executeCallbacksOnAnnotationSubmitted(s,t),this.operationBatchConfig?this.sendSeedMessagesViaBatchManager(this.onAnnotationsSubmittedEnabled?o:e,!0,t):this.sendMessageToSession(new M.Tb({cv:t,seq:0,ops:this.onAnnotationsSubmittedEnabled?o:e}))}submitSeedGroupOperations(e,t,s){if(!this.allowGroupSeed)throw new Error("Seed operations are not allowed for this session");if(this.networkMode===a.LocalWorkflowsOnly&&this.localWorkflowManager)return void this.localWorkflowManager.runLocalWorkflows(e,this);s||(s=this.generateCorrelationId()),t&&(this.allowGroupSeed=!1),this.allowSeed=!1;const[o,n]=this.partitionAnnotationOperations(e);this.executeCallbacksOnAnnotationSubmitted(o,s),this.onAnnotationsSubmittedEnabled?this.onAnnotationsSubmitted(o,s):this.executeCallbacksOnAnnotationSubmitted(o,s),this.operationBatchConfig?this.sendSeedMessagesViaBatchManager(this.onAnnotationsSubmittedEnabled?n:e,!!t,s):(this.seedGroupSize++,this.sendMessageToSession(new M.Tb({cv:s,seq:0,ops:this.onAnnotationsSubmittedEnabled?n:e,groupId:"Seed",groupSize:t?this.seedGroupSize:void 0,groupComplete:t||void 0})))}submitCustomMessage(e){return new Promise(((t,s)=>{this.sendMessageToSession(e,((o,n)=>{o?s(new Error(`${o.error}; for message type: ${S.h.getTypeNameFor(e)}`)):t(n)}))}))}submitLargeBinaryDataMessage(e){return new Promise(((t,s)=>{this.sendMessageToSessionPostEndpoint(e,((e,o)=>{e?s(new Error(e.error)):t(o)}))}))}submitBinaryStreamUploadMessage(e){return new Promise(((t,s)=>{const o=new n.I({operationName:"sendBinaryStreamUploadMessage",success:!0}).setClientMetadata(this.clientMetadata).start();if(this.connectParams)(0,Re.wM)(this.connectParams,e,o,((e,o)=>{e?s(new Error(e.error)):t(o)}));else{const n=(n=>(0,Re.wM)(n,e,o,((e,o)=>{e?s(new Error(e.error)):t(o)}))).bind(this);this.pendingConnectCallbacks.push(n)}}))}requestBinaryDataForBlob(e){return e.data?Promise.resolve(e.data):e.dataPointer&&e.dataPointer.refType!==Ee.J1.None?new Promise(((t,s)=>{this.requestBinaryDataFromSessionBlobEndpoint(e.dataPointer,((e,o)=>{e?s(e):t(o)}))})):Promise.reject(new Error("Blob does not have a data pointer"))}requestCacheDump(e){if(e)throw new Error("NYI");return this.submitCustomMessage(new M.z_)}forceReconnect(e){return this.extensionConfigs=e,this.sessionManager.forceReconnect(e)}close(e){var t;this.isSessionClosed=!0,this.sessionManager.closeSession(e),this.localWorkflowManager&&this.localWorkflowManager.closeSession(this),this.graphInitMessageTimer&&(clearTimeout(this.graphInitMessageTimer),this.graphInitMessageTimer=void 0),(null===(t=this.gateUtils)||void 0===t?void 0:t.isChangeGateEnabledSync(Zt))||this.batchedOperationsManager&&this.batchedOperationsManager.close()}authenticateInteractive(e){return We(this,void 0,void 0,(function*(){if(!(e&&e.forceUserPrompt)&&this.cachedClaimsChallenge.claimsVersion>0&&!this.cachedClaimsChallenge.actionRequired)return;const t=yield this.requestAuthTokenInteractive(this.cachedClaimsChallenge,{interactive:!0});if(M.D0.typeGuard(t))throw new Error(t.reason)}))}getClientMetadata(){return this.clientMetadata}getUserContext(){return this.userContext}setSessionCloseCallback(e){const t=this.getSessionStateCallbackToken("close");return e&&this.sessionCloseCallbacks.set(t,e),t}setConnectCallback(e){const t=this.getSessionStateCallbackToken("connect");return e&&this.connectCallbacks.set(t,e),t}setDisconnectCallback(e){const t=this.getSessionStateCallbackToken("disconnect");return e&&this.disconnectCallbacks.set(t,e),t}setReconnectCallback(e){const t=this.getSessionStateCallbackToken("reconnect");return e&&this.reconnectCallbacks.set(t,e),t}removeSessionStateCallback(e){function t(t){return!!t.has(e)&&(t.delete(e),!0)}return t(this.sessionCloseCallbacks)||t(this.reconnectCallbacks)||t(this.disconnectCallbacks)||t(this.connectCallbacks)}setServerAuthenticationStateChangeCallback(e){this.serverAuthenticationStateChangeCallback.push(e),e(this.serverAuthenticationState)}setClaimsChallengeCallback(e){this.cachedClaimsChallenge.actionRequired&&e(this.cachedClaimsChallenge),this.claimsChallengeCallback.push(e)}setSeedingStatusChangeCallback(e){e(new M.fr({newStatus:this.seedingStatus})),this.seedingStatusChangeCallbacks.push(e)}getConnectParams(){return this.connectParams}setOfflineMode(){this.sessionManager=new xe}onAnnotationResults(e,t,s){i.tG.info(508916486,i.nh.CoreDefault,new n.I({operationName:"OnAnnotationResultsEgress",dimension0:null==e?void 0:e.annotationType,success:!0,cv:e.cv})),s(void 0,new M.YK),t===qe.LocalWorkflow&&this.contextIdManager.applyContextIdOnOperations(e.ops),this.updateWorkflowExecutionStates(e.ops),this.egress&&this.egress(e,(()=>{})),this.annotationResultsProcessor.process(e,((e,s)=>{this.applyOperationForContext(e,s,t)}),((s,o)=>{const i=Date.now();this.triggerRegisteredAnnotationCallbacks(s,e.annotationType,o,e.areApologies),t===qe.ServerWorkflow&&(0,Fe.M4)(e,i,"CallbackInRuntimeClient",!0,new n.I({operationName:"AugloopClientPerfTracker",success:!0}).setClientMetadata(this.clientMetadata).start())}),(e=>{if(t!==qe.ServerWorkflow){const t=e.ops.filter(this.filterOperationsForSession.bind(this)).filter($e);this.submitOperationsToSession(t,e.cv)}this.localWorkflowManager&&this.localWorkflowManager.runLocalWorkflows(e.ops,this)}))}onAnnotationResultStateMessage(e,t){var s;t(void 0,new M.YK);for(const t of e.updates){const{annotationType:e,state:o}=t;if(!this.tokensByAnnotationType.has(e))continue;let n;n=this.annotationResultStates.has(e)?this.annotationResultStates.get(e):o===de.K7.Idle?de.K7.Pending:de.K7.Idle;for(const t of this.tokensByAnnotationType.get(e)){const e=this.annotationActivationTrackers.get(t);(null===(s=e.options)||void 0===s?void 0:s.stateUpdateCallback)&&e.options.stateUpdateCallback(n,o)}}}submitOperationsToSession(e,t){t||(t=this.generateCorrelationId());const s=e.filter((e=>v.g0.typeGuard(e))),o=e.filter((e=>!v.g0.typeGuard(e)));if(s.length>0&&this.sendMessageToSession(new M.Tb({cv:t,ops:s})),o.length>0)if(this.operationBatchConfig){if(!this.batchedOperationsManager){let e;e=this.batchMessagesEnabled?(e,t,s)=>{if(e.length){const t=new M.l0;t.messages=[],e.forEach((e=>{t.messages.push(new M.Tb({cv:e.cv,seq:this.nextSyncSequenceId++,ops:e.input}))})),this.sendMessageToSession(t,(e=>{s(e?new Error(e.error):void 0)}))}}:(e,t,s)=>{this.sendMessageToSession(new M.Tb({cv:t.cv,seq:this.nextSyncSequenceId++,ops:e}),(e=>{s(e?new Error(e.error):void 0)}))},this.batchedOperationsManager=new Pe.Y(e,this.reduceBatchOperationsEnabled,this.batchMessagesEnabled,void 0,this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled)}this.batchedOperationsManager.addBatchItem(o,this.operationBatchConfig,{name:"SubmitOperations"},t)}else this.sendMessageToSession(new M.Tb({cv:t,seq:this.nextSyncSequenceId++,ops:o}))}sendMessageToSession(e,t){this.sessionManager.sendMessage(e,t),M.w9.typeGuard(e)&&this.close()}sendMessageToSessionPostEndpoint(e,t){const s=new n.I({operationName:"SendLargeBinaryDataMessage",success:!0,cv:e.cv}).setClientMetadata(this.clientMetadata).start();if(this.connectParams)(0,Re.A2)(this.connectParams,e,s,t);else{const o=(o=>(0,Re.A2)(o,e,s,t)).bind(this);this.pendingConnectCallbacks.push(o)}}requestBinaryDataFromSessionBlobEndpoint(e,t){const s=new n.I({operationName:"RequestBinaryData",success:!0,cv:(new Y.W).toString()}).setClientMetadata(this.clientMetadata).start();if(this.connectParams)(0,Re.ZC)(this.connectParams,e,t,s);else{const o=(o=>(0,Re.ZC)(o,e,t,s)).bind(this);this.pendingConnectCallbacks.push(o)}}registerContextTypes(e){for(const t of e)this.activateAnnotation(t),this.registeredContextTypes.add(t)}applyOperationForContext(e,t,s){let o=S.h.getTypeNameFor(e);if(o!=v.Xr.getTypeName()&&o!=v.I.getTypeName()&&o!=v.fZ.getTypeName()&&o!=v.n4.getTypeName())return;o==v.I.getTypeName()&&(o=v.Xr.getTypeName());const n=le(this.resolvePlaceholdersInOperationParentPath(e.parentPath),t),a=ue(n.parentPath);if(o==v.Xr.getTypeName()||o==v.fZ.getTypeName()){if(!n.body)return;const e=S.h.getTypeNameFor(n.body);if(!this.registeredContextTypes.has(e))return;let t=this.availableContexts.get(e);t||(t=new Map,this.availableContexts.set(e,t));let r=t.get(s);if(r||(r=[],t.set(s,r)),n.id||this.localWorkflowManager&&(n.id=this.localWorkflowManager.getNextClientAnnotationId()),o==v.Xr.getTypeName())0==r.filter((e=>ue(e.parentPath)==a&&e.id==n.id)).length?r.push(n):i.tG.info(540848911,i.nh.CoreDefault,`AddOperation for (${s}, ${n.id}, ${n.source}) can't be applied as the context item with matching path and ID already exists. Use UpdateOperation instead.`);else for(let e=0;e<r.length;e++)if(r[e].id==n.id&&ue(r[e].parentPath)==a){if(r[e].source==n.source){r[e]=n;break}i.tG.warn(540848912,i.nh.CoreDefault,`UpdateOperation for (${s}, ${n.id}, ${n.source}) can't be applied as the context item with provided path and ID has different source: ${r[e].source}`)}else i.tG.warn(540848913,i.nh.CoreDefault,`UpdateOperation for (${s}, ${n.id}, ${n.source}) can't be applied as the context item with matching path and ID was not found. AddOperation should be used instead`)}else if(o==v.n4.getTypeName()){if(!n.id)return;this.availableContexts.forEach(((e,t)=>{let o=e.get(s);o&&(o=o.filter((e=>!(ue(e.parentPath)==a&&e.id==n.id))),0==o.length?e.delete(s):e.set(s,o),0==e.size?this.availableContexts.delete(t):this.availableContexts.set(t,e))}))}}updateWorkflowExecutionStates(e){if(this.localWorkflowManager){const t=this.enableRemoteExecutionNotification?this.workflowGraph.getWorkflowNodes().map((e=>e.workflow)):this.localWorkflowManager.getAllRegisteredWorkflowsFromSession(this);for(const s of e)if(ie.has(S.h.getTypeNameFor(s)))for(const e of s.items)for(const s of t||[])this.localWorkflowManager.preProcessItemToWorkflow(s,e,this)}}resolveRequestedContexts(e){const t=[];for(const[s,o,n]of Be(e.requestedContextTypesRules)){if(!this.availableContexts.has(s)){if(o==I.in.Required)return[!1,[]];continue}const e=Array.from(this.availableContexts.get(s).values()).reduce(((e,t)=>e.concat(t)),[]);if(0==e.length)throw new Error(`Assert: availableContexts have the entry for ${s} which does not contain any context annotation.`);t.push(...e)}return[!0,this.removeDuplicatedContextItems(t)]}removeDuplicatedContextItems(e){return e.filter(((e,t,s)=>s.findIndex((t=>Ge.Aq.deepEquals(t,e)))===t))}getContextAnnotations(e,t,s,o){var n,i;const a=s?ue(s):void 0;return null===(i=null===(n=this.availableContexts.get(e))||void 0===n?void 0:n.get(t))||void 0===i?void 0:i.filter((e=>!(a&&ue(e.parentPath)!=a||o&&e.source!=o)))}onWorkflowDefinitionOverrideMessage(e){const t=new n.I({operationName:"WorkflowDefinitionOverride",success:!0}).setClientMetadata(this.clientMetadata).start(),s=e=>{throw Ve(t,e),Error(`WorkflowDefinitionOverride: ${e}`)};if(!this.localWorkflowManager)return void s("Not supported by this local SessionProxy instance.");const o=this.localWorkflowManager.getWorkflowDefinitionsByName(this),i=o.get(e.sourceWorkflowId);if(!i)return void s(`Workflow registration for source workflow '${e.targetWorkflowId}' was not found.`);t.resourceId=i.id;const a=o.get(e.targetWorkflowId);a&&(a.allowDefinitionOverride?i.definitionOverrideTargetWorkflows&&-1!==i.definitionOverrideTargetWorkflows.indexOf(a.id)?(this.workflowDefinitionManager.mergeWorkflowDefinition(a,e.definition,e.contextId),t.resultDescription=`Updated config for workflow: ${e.targetWorkflowId}, context id: ${e.contextId}`,Ve(t)):s(`Workflow '${i.id}' does not allow workflow definition for workflow '${a.id}'.`):s(`Workflow '${a.id}' does not allow workflow definition override.`))}applyContextIdOnOperations(e){this.contextIdManager.applyContextIdOnOperations(e)}attachToWorkflowGraph(e){this.addToWorkflowGraph(e),this.attachExecutionTrackerToEachWorkflow()}triggerRegisteredAnnotationCallbacks(e,t,s,o){if(this.callAnnotationCallbacks(e,t,s,o),this.hostCallbacks.onAnnotationResult)try{o?this.hostCallbacks.onApologyResult&&this.hostCallbacks.onApologyResult(e,s):this.hostCallbacks.onAnnotationResult(e,s)}catch(e){i.tG.error(540301151,i.nh.CoreDefault,new n.I({operationName:"HostCallbackOnAnnotationResultError",dimension0:t,resultDescription:`onAnnotationResult error: ${e}`}))}}attachExecutionTrackerToEachWorkflow(){this.localWorkflowManager&&this.localWorkflowManager.attachExecutionTrackerToEachWorkflow(this.workflowGraph,this,this.onWorkflowExecutionComplete.bind(this))}onWorkflowExecutionCompleteMessage(e,t){t(void 0,new M.YK),this.localWorkflowManager&&this.localWorkflowManager.onExternalWorkflowExecuted(e.contextId,e.workflowId,this)}onWorkflowExecutionComplete(e,t){}enableDeltaGenerator(){var e,t;this.deltaGenerator=null!==(e=this.deltaGenerator)&&void 0!==e?e:new K,this.syncDeltaTimers=null!==(t=this.syncDeltaTimers)&&void 0!==t?t:new Map}createDeltasFromUpdateOperation(e){var t,s;const o=[];i.tG.info(523776396,i.nh.CoreDefault,`Calling delta create for UpdateOperation under parent path [${e.parentPath}] (${null===(t=e.items)||void 0===t?void 0:t.length} item(s), first item id: ${(null===(s=e.items)||void 0===s?void 0:s.length)>0?e.items[0].id:"(no items)"})`);let n=[...e.parentPath];for(const t of e.items){const s=[],a=this.deltaGenerator.createTextTileDeltasFromItem(t,e.parentPath);if(null==a?void 0:a.length){for(const o of a){const i=(0,c.v4)();n=[...e.parentPath,t.id];const a={id:i,revId:t.revId,body:o,contextId:t.contextId,source:t.source};s.push(a)}s.length>0&&(o.push(new v.xU({parentPath:n,items:s})),this.enableSyncDeltaSending&&this.setupSyncDeltaAfterDelay(t,n,s))}else i.tG.info(523329632,i.nh.CoreDefault,`Failed to create delta on item ${t.id}`)}return o}setupSyncDeltaAfterDelay(e,t,s){var o,n,i;const a=this.syncDeltaTimers.get(e.id);a&&(clearTimeout(a),this.syncDeltaTimers.delete(e.id));const r=s.find((e=>{var t;return(null===(t=e.body)||void 0===t?void 0:t.unit)===D.OD.Chars}));if(r){const s=r.body,a={content:"",deltaType:D.WI.Update,length:0,position:(null!==(o=null==s?void 0:s.position)&&void 0!==o?o:0)+(null!==(i=null===(n=null==s?void 0:s.content)||void 0===n?void 0:n.length)&&void 0!==i?i:0),unit:D.OD.Sentence},l=B.Cg.typeGuard(e.body)?new P.s(a):new P.Q(a),u={id:(0,c.v4)(),revId:e.revId,body:l,contextId:e.contextId,source:e.source},p=new v.xU({parentPath:t,items:[u]}),g=setTimeout(((e,t)=>{this.submitOperation(e),this.syncDeltaTimers.delete(t)}),this.syncDeltaTimeout,p,e.id);this.syncDeltaTimers.set(e.id,g)}}addToWorkflowGraph(e){this.workflowGraph.addWorkflow(te(e))}getAnnotations(e,t){var s,o,i;const a=null!==(s=e.cv)&&void 0!==s?s:this.sessionManager.getCorrelationVector().newChild().toString(),c=new n.I({operationName:"GetAnnotations",success:!0,resultSignature:"GetAnnotationsEntry",resourceId:`${e.sourceInfo.featureId}-${e.sourceInfo.entryPoint}`,cv:a}).setClientMetadata(this.clientMetadata).start();c.setDataFields({AnnotationType:null===(o=e.annotationType)||void 0===o?void 0:o.toString(),MaxDelayMs:null===(i=e.maxDelayMs)||void 0===i?void 0:i.toString()});const l=new L.x5({annotationTypes:e.annotationType,transientItems:e.transientItems,configs:e.configs,maxDelayMs:e.maxDelayMs,sourceInfo:e.sourceInfo,caller:r.Client,tryResolveUpstreamDependencies:e.tryResolveUpstreamDependencies,correlationInfo:{cvString:a},cv:a}),u=[];let p;Ve(c),this.sendMessageToSession(l,((e,s)=>{(null==t?void 0:t.IsCancellationRequested)||(u.push({error:e,response:s}),null==p||p(!0))}));const g=this;let h=!1;const d=new Promise(((e,s)=>{null==t||t.onCancel((t=>{h?e():s(new Error(je.requestCancelledError))}))}));return{[Symbol.asyncIterator](){var e,s,o,n,i,a,r;return Ue(this,arguments,(function*(){for(;!h;)try{0===u.length&&(yield He(Promise.race([new Promise((e=>p=e)),d]))),c.resultSignature="AnnotationReceived";const l=u.shift();if(null==t?void 0:t.IsCancellationRequested)throw new Error(je.requestCancelledError);h=(null===(e=l.response)||void 0===e?void 0:e.finalResponse)||void 0!==l.error,c.setDataField("FinalResponse",h);const m=(0,Fe.Kh)(l.response);let y,T,f;if(c.setDataField("FirstUserPerceivedResponse",m),l.error){const e=`ErrorCode: ${l.error.code}, Error: ${l.error.error}, Retryable: ${l.error.retryable}`;c.setDataField("ServerError",e),f=l.error.error,y={serviceError:[{code:de.Qn.ServerError,error:l.error.error,retryable:null==g?void 0:g.canBeRetried(l.error)}]}}else if((null===(o=null===(s=l.response)||void 0===s?void 0:s.errorInfo)||void 0===o?void 0:o.length)>0){const e=l.response.errorInfo.map((e=>`ErrorCode: ${e.code}, Error: ${e.error}, Retryable: ${e.retryable}, ResourceId: ${e.resourceId}`)).join("\n");c.setDataField("WorkflowErrors",e),f="Workflow execution error",y={serviceError:l.response.errorInfo}}else c.resultDescription="OK";if((null===(i=null===(n=l.response)||void 0===n?void 0:n.warningInfo)||void 0===i?void 0:i.length)>0){T={serviceError:l.response.warningInfo};const e=l.response.warningInfo.map((e=>`ErrorCode: ${e.code}, Error: ${e.error}, Retryable: ${e.retryable}, ResourceId: ${e.resourceId}`)).join("\n");c.setDataField("WorkflowWarnings",e)}Ve(c,f),yield yield He({content:null===(a=l.response)||void 0===a?void 0:a.content,error:null!=y?y:void 0,warning:null!=T?T:void 0,finalResponse:null===(r=l.response)||void 0===r?void 0:r.finalResponse})}catch(e){const t=e.message===je.requestCancelledError?de.zy.RequestCancelled:de.zy.Unknown;c.setDataField("ClientError",`ErrorCode: ${t}, Error: ${e.message}`),Ve(c,null==e?void 0:e.message),yield yield He({content:void 0,error:{clientError:{code:t,error:null==e?void 0:e.message}}}),h=!0;break}}))}}}isHttpFallback(){const e=this.sessionManager.getNetworkWorkerManager();return!(!e||e.getInitNetworkMode()!==a.JSWebSockets||e.getNetworkMode()!==a.HttpFallback)}canBeRetried(e){return(null==e?void 0:e.code)===de.xv.TooManyRequests||(null==e?void 0:e.code)===de.xv.RequestTimeout||e.error.includes(Se.ClientDisconnected)}getAuthToken(e,t){const s={Tickets:[]};this.clientMetadata.docSessionId&&(s.DocSessionId=this.clientMetadata.docSessionId);const o=(e=>{if(e===J.OY.Substrate)return he.OY.Substrate})(e);o&&(s.TokenType=o),this.hostCallbacks.requestAuthToken(s).then((s=>{var o;if(!s)throw new Error("Missing AuthTokenResponse from requestAuthToken");if(!s.Token)throw new Error("Missing Token from requestAuthToken");t(void 0,s.Token,{returnedTokenType:e,timeToLiveSec:null===(o=s.TokenProperties)||void 0===o?void 0:o.timeToLiveSec})})).catch((e=>{t(e)}))}resetNextSyncSequenceId(){this.nextSyncSequenceId=1}onReconnect(){if(this.annotationActivationTrackers.forEach((e=>{var t;this.activateAnnotationForTracker(e,{ignoreExistingAnnotations:!0,sendOnlyIfConnected:!0,sendApologies:void 0!==(null===(t=e.options)||void 0===t?void 0:t.apologyCallback)}).catch((()=>{}))})),this.reconnectCallbacks.forEach(((e,t)=>{e()})),!this.connectParams)throw new Error("Expected onConnect before onReconnect")}onSessionClose(e){this.isSessionClosed=!0,this.connectParams=void 0,this.sessionCloseCallbacks.forEach(((t,s)=>{t(e)}))}onConnect(e,t,s,o,i,a,r,c){const l=new n.I({operationName:"OnConnect",success:!0}).setClientMetadata(this.clientMetadata).start();l.setDataField("HasSessionConnected",this.hasSessionConnected),l.setDataField("IsSeedingRequired",e),l.setDataField("SeedingStatus",this.seedingStatus);let u=!1;e&&(this.hasSessionConnected&&(this.allowSeed=!0,this.allowGroupSeed=!0,u=this.changeSeedingStatus(de.e9.NotStarted,"ReconnectReset",!1),this.seedGroupSize=0,this.batchedSeedMessageGroupSize=0,this.seedBatchedOperationsManager&&(this.seedBatchedOperationsManager.removeAllBatchedItems(),this.seedBatchedOperationsManager=void 0),this.batchedOperationsManager&&(this.batchedOperationsManager.removeAllBatchedItems(),this.batchedOperationsManager=void 0)),this.cachedClaimsChallenge=Object.assign(Object.assign({},this.cachedClaimsChallenge),{claimsVersion:0})),this.enableRemoteExecutionNotification&&!this.hasSessionConnected&&this.addDownstreamWorkflowsIntoClientGraph(a),this.connectParams={isSeedingRequired:e,sessionUrl:t,origin:s,authToken:o,routingSessionKey:r,blobFileId:c},this.hasSessionConnected=!0,this.tryActivateWorkflows();for(const e of this.pendingConnectCallbacks)e(this.connectParams);this.connectCallbacks.forEach(((n,i)=>{n(e,t,s,o,r,c)})),u&&this.triggerSeedingStatusChangeCallbacks(),this.serverInputTypes=i,this.onConnectTelemetryCG&&Ve(l)}onDisconnect(e){this.connectParams=void 0,this.disconnectCallbacks.forEach(((t,s)=>{t(e)}))}onSeedingStatusChangeMessage(e,t){t(void 0,new M.YK),this.changeSeedingStatus(e.newStatus,"SeedingStatusChangeMessage")}changeSeedingStatus(e,t,s=!0){const o=new n.I({operationName:"SeedingStatusChange",success:!0}).setClientMetadata(this.clientMetadata).start();return o.setDataField("Status",de.e9[e]),o.setDataField("Reason",t),Ve(o),this.seedingStatus!=e&&(this.seedingStatus=e,s&&this.triggerSeedingStatusChangeCallbacks(),!0)}triggerSeedingStatusChangeCallbacks(){this.seedingStatusChangeCallbacks.forEach((e=>{e(new M.fr({newStatus:this.seedingStatus}))}))}onServerAuthenticationStateChange(e){if(e!=this.serverAuthenticationState){if(this.serverAuthenticationState==k.f.Authenticated&&e==k.f.Pending)return;const t=new n.I({operationName:"ServerAuthStateChange",dimension0:k.f[e],dimension1:k.f[this.serverAuthenticationState],success:!0}).setClientMetadata(this.clientMetadata).start();t.resultDescription=`Changing Server Authentication State newState: ${k.f[e]}, previousState: ${k.f[this.serverAuthenticationState]}`,Ve(t),this.serverAuthenticationState=e;for(const e of this.serverAuthenticationStateChangeCallback)e(this.serverAuthenticationState)}}callAnnotationCallbacks(e,t,s,o){if(0===this.annotationCallbacks.size&&0===this.apologyCallbacks.size)return;const n=o?this.apologyCallbacks.get(t):this.annotationCallbacks.get(t);n&&n.forEach((t=>{t(e,s)}))}getOperationBatchConfig(e){let t;t=this.batchMessagesEnabled?e=>({input:e,demultiplex:()=>[[]]}):e=>({input:e.filter((e=>e.length)).reduce(((e,t)=>e.concat(t)),[]),demultiplex:()=>[[]]});return{delayMs:e.delayMs,delayMsMax:e.delayMsMax,maxInputSize:e.maxInputSize,estimateSize:Le.E,groupingKeyExtractor:()=>"operations",multiplex:t,split:e=>{if(!(e.length<=1))return{inputs:e.reduce(((e,t)=>(e.push([t]),e)),[]),join:()=>[]}}}}sendSeedMessagesViaBatchManager(e,t,s){if(!this.seedBatchedOperationsManager){let e;e=this.batchMessagesEnabled?(e,t,s)=>{if(this.batchedSeedMessageGroupSize+=e.length,e.length){const o=new M.l0;o.messages=[],e.forEach((e=>{o.messages.push(new M.Tb({cv:e.cv,seq:0,ops:e.input,groupId:"Seed",groupSize:t.groupComplete?this.batchedSeedMessageGroupSize:void 0,groupComplete:t.groupComplete?t.groupComplete:void 0}))})),this.sendMessageToSession(o,(e=>{s(e?new Error(e.error):void 0)}))}}:(e,t,s)=>{this.seedGroupSize++,this.sendMessageToSession(new M.Tb({cv:t.cv,seq:0,ops:e,groupId:"Seed",groupSize:t.groupComplete?this.seedGroupSize:void 0,groupComplete:t.groupComplete?t.groupComplete:void 0}),(e=>{s(e?new Error(e.error):void 0)}))},this.seedBatchedOperationsManager=new Pe.Y(e,this.reduceBatchOperationsEnabled,this.batchMessagesEnabled,void 0,this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled)}this.seedBatchedOperationsManager.addBatchItem(e,this.operationBatchConfig,{name:"SubmitSeedOperations"},s,t)}onAnnotationResultsFromServer(e,t){(0,Fe.M4)(e,Date.now(),"ReceiveFromNetwork",!0,new n.I({operationName:"AugloopClientPerfTracker",success:!0}).setClientMetadata(this.clientMetadata).start()),this.onAnnotationResults(e,qe.ServerWorkflow,t)}getLocalRegisteredWorkflows(){return this.localWorkflowManager?this.localWorkflowManager.getAllRegisteredWorkflowsFromSession(this).map((e=>te(e))):[]}sendWorkflowGraphInitMessage(){const e=this.getLocalRegisteredWorkflows(),t=new n.I({operationName:"WorkflowGraphInit",success:!0}).setClientMetadata(this.clientMetadata).start(),s=new M.TV({upstreamRuntimeWorkflows:e});this.sendMessageToSession(s,((s,o)=>{s?Ve(t,s.error):(t.resultDescription=`local workflows: ${e.map((e=>e.id))}, remote workflows: ${o.downstreamRuntimeWorkflows.map((e=>e.id))}`,Ve(t),this.onWorkflowGraphInitResponse(o))}))}trySendWorkflowGraphInitMessage(){!this.graphInitMessageTimer&&this.enableRemoteExecutionNotification&&(this.graphInitMessageTimer=setTimeout((()=>{this.graphInitMessageTimer=void 0,this.sendWorkflowGraphInitMessage()}),10))}onWorkflowGraphInitResponse(e){this.addDownstreamWorkflowsIntoClientGraph(e.downstreamRuntimeWorkflows),this.tryActivateWorkflows()}addDownstreamWorkflowsIntoClientGraph(e){this.workflowGraph.removeWorkflows(!0);for(const t of e||[])this.workflowGraph.addWorkflow(t,!0);this.attachExecutionTrackerToEachWorkflow()}resolvePlaceholdersInOperationParentPath(e){let t=e;return 3==t.length&&"session"==t[0]&&"user"==t[1]&&t[2].startsWith("user_")&&(i.tG.info(540848914,i.nh.CoreDefault,`Replacing user context placeholder for: ${ue(e)}.`),t=["session","#userContext#"]),3==t.length&&"session"==t[0]&&"user"==t[1]&&t[2].startsWith("tenant_")&&(i.tG.info(540848915,i.nh.CoreDefault,`Replacing tenant context placeholder for: ${ue(e)}.`),t=["session","#tenantContext#"]),t}filterOperationsForSession(e){return(0,Ge.zX)(e,this.serverInputTypes)}executeCallbacksOnAnnotationSubmitted(e,t){const{annotationOpsMap:s,apologyOpsMap:o}=this.getAnnotationOperationsByType(e);s.forEach(((e,s)=>{Array.from(e).forEach((e=>this.triggerRegisteredAnnotationCallbacks(e,s,t,!1)))})),o.forEach(((e,s)=>{Array.from(e).forEach((e=>this.triggerRegisteredAnnotationCallbacks(e,s,t,!0)))}))}partitionAnnotationOperations(e){return e.reduce((([e,t],s)=>s.items.some((e=>e.body&&N.YH.typeGuard(e.body)))?[[...e,s],t]:[e,[...t,s]]),[[],[]])}onAnnotationsSubmitted(e,t){const{annotationOpsMap:s,apologyOpsMap:o}=this.getAnnotationOperationsByType(e);s.forEach(((e,s)=>{const o=Array.from(e);this.onAnnotationResults(new M.B_({annotationType:s,ops:o,cv:t,areApologies:!1}),qe.Submitted,(()=>{}))})),o.forEach(((e,s)=>{const o=Array.from(e);this.onAnnotationResults(new M.B_({annotationType:s,ops:o,cv:t,areApologies:!0}),qe.Submitted,(()=>{}))}))}getAnnotationOperationsByType(e){const t=new Map,s=new Map;for(const o of e)for(const e of o.items)if(e.body&&N.YH.typeGuard(e.body)){const n=(e,t)=>{const s=e.get(t)||new Set;s.add(o),e.set(t,s)};Ie.typeGuard(e.body)?n(s,e.body.annotationTypeName):n(t,S.h.getTypeNameFor(e.body))}return{annotationOpsMap:t,apologyOpsMap:s}}onClaimsChallengeMessage(e,t){var s;const o=new n.I({operationName:"OnClaimsChallengeMessage",dimension0:e.claimsVersion.toString(),dimension1:e.error,success:!0}).setClientMetadata(this.clientMetadata).start(),i=e.claims&&e.claims.length>0;o.resultSignature=`HasClaims: ${i}`,o.resultDescription="Received Claims Challenge Message from Server",Ve(o),e.claimsVersion>this.cachedClaimsChallenge.claimsVersion&&(this.cachedClaimsChallenge=Object.assign(Object.assign({},e),{actionRequired:!0})),(null===(s=this.gateUtils)||void 0===s?void 0:s.isChangeGateEnabledSync(Yt))?this.requestAuthTokenInteractive(e).then((e=>{M.D0.typeGuard(e)&&this.invokeClaimsChallengeCallbacks()})).catch((()=>{})):this.invokeClaimsChallengeCallbacks(),t(void 0,new M.YK)}generateCorrelationId(){return this.sessionManager.getCorrelationVector().newChild().toString()}onTokenProvisionResponse(e){e&&this.onServerAuthenticationStateChange(k.f.Authenticated)}invokeClaimsChallengeCallbacks(){for(const e of this.claimsChallengeCallback)e(this.cachedClaimsChallenge)}requestAuthTokenWithClaims(e){this.requestAuthTokenInteractive(e).catch((()=>{}))}requestAuthTokenInteractive(e,t){var s;const o=new n.I({operationName:"RequestAuthTokenInteractive",success:!0,dimension0:`isInteractive: ${null!==(s=null==t?void 0:t.interactive)&&void 0!==s&&s}`}).start();o.dimension1=`HasClaims: ${!!e.claims&&e.claims.length>0}`;const i={Tickets:[],DocSessionId:this.clientMetadata.docSessionId,TokenType:he.OY.Augloop,ConnectParams:this.connectParams,Claims:e.claims,Interactive:null==t?void 0:t.interactive};return this.hostCallbacks.requestAuthToken(i).then((t=>{if(!t)throw new Error("Missing AuthTokenResponse from requestAuthToken claims");if(!t.Token)throw new Error("Missing Token from requestAuthToken claims");return o.resultSignature="Token",new M.kd({authToken:t.Token,version:++this.tokenMessageVersion,claimsVersion:e.claimsVersion})})).catch((t=>(o.resultSignature="NoToken",o.dimension2=t.message,new M.D0({reason:t.message,version:++this.tokenMessageVersion,claimsVersion:e.claimsVersion,clientHandlesResponse:!0})))).then((e=>new Promise(((t,s)=>{this.sendMessageToSession(e,((n,i)=>{Ve(o,null==n?void 0:n.error),n?s(new Error(n.error)):(M.kd.typeGuard(e)&&(this.cachedClaimsChallenge.actionRequired=!1,this.onTokenProvisionResponse(i)),t(e))}))}))))}ensureConnection(){return Promise.resolve()}keepAlive(){}}je.requestCancelledError="Request cancelled";class ze{constructor(e){this.item=e,this.operation=e.op,this.delta=e.delta,this.deltas=e.deltas,this.id=ue(this.itemPath),this.revId=e.revId}get itemPath(){return[...this.item.parentPath,this.item.id]}getModelIterator(){throw new Error("Method not implemented.")}getBody(){return this.item.body}getItemReference(){throw new Error("Method not implemented.")}getParentItem(e){throw new Error("Method not implemented.")}getParentItemBody(e){throw new Error("Method not implemented.")}getPrevItem(e,t){throw new Error("Method not implemented.")}getPrevItemBody(e,t){throw new Error("Method not implemented.")}getNextItem(e,t){throw new Error("Method not implemented.")}getNextItemBody(e,t){throw new Error("Method not implemented.")}getChildItem(e){throw new Error("Method not implemented.")}getChildItemBody(e){throw new Error("Method not implemented.")}getChildItems(e){throw new Error("Method not implemented.")}getChildItemBodies(e){throw new Error("Method not implemented.")}getSubtreeItem(e){throw new Error("Method not implemented.")}getSubtreeItemBody(e){throw new Error("Method not implemented.")}getSubtreeItems(e){throw new Error("Method not implemented.")}getSubtreeItemBodies(e){throw new Error("Method not implemented.")}getContextItem(e){throw new Error("Method not implemented.")}getContextItemBody(e){throw new Error("Method not implemented.")}getContextItems(e){throw new Error("Method not implemented.")}getContextItemBodies(e){throw new Error("Method not implemented.")}addAnnotation(e,t){throw new Error("Method not implemented.")}updateAnnotation(e,t){throw new Error("Method not implemented.")}deleteAnnotation(e){throw new Error("Method not implemented.")}loadSubtree(e){throw new Error("Method not implemented.")}getSourceTimestamp(){return this.item.sourceTimestamp}getContextId(){return this.item.contextId}}class Ke{constructor(e,t=[]){this.scopeItem=void 0,this.rootItem=void 0,this.normalizeFilter=e=>{if(!e)return e=>void 0!==e;if("function"==typeof e)throw new Error("Not implemented yet");if((e.id?1:0)+(e.ids?1:0)+(e.itemType?1:0)+(e.itemTypes?1:0)!=1)throw new Error("Exactly one condition expected on IItemFilter");if(e.itemType)return t=>t&&S.h.matchesTypesFor(t.body,[e.itemType]);if(e.itemTypes)return t=>t&&S.h.matchesTypesFor(t.body,e.itemTypes);throw new Error("Not implemented yet")},this.items=[...t,e],this.scopeItem=new ze(e)}getItem(e){throw new Error("Method not implemented.")}getItems(e){throw new Error("Method not implemented.")}getItemBody(e){return this.getItemBodies(e)[0]}getItemBodies(e){const t=this.normalizeFilter(e);return this.items.filter(t).map((e=>e.body))}getItemByReference(e){throw new Error("Method not implemented.")}getItemBodyByReference(e){throw new Error("Method not implemented.")}}const Qe=[D.WI.CursorUpdate,D.WI.FormattingUpdate,D.WI.OtherNonContentUpdate,D.WI.AttributionUpdate];function Je(e,t,s){const o=new n.I({operationName:"ApplyTextTileDeltaForLocalWorkflows",dimension0:"0",success:!0}).start();try{if(!t)return o.success=!1,o.resultDescription="Unable to apply text tile delta, parent tile is undefined",void i.tG.info(538798173,i.nh.CoreDefault,o.stop());if(S.h.getTypeNameFor(t)!==B.qf.getTypeName())return o.success=!1,o.resultDescription=`Unable to apply text tile delta, parent tile is not proper type: expected ${P.Q.getTypeName()}, received ${S.h.getTypeNameFor(t)}`,void i.tG.info(538798174,i.nh.CoreDefault,o.stop());const s=e,n=t.content;let a="";if(void 0===s.position||s.position<0)return o.success=!1,o.resultDescription="Unable to apply text tile delta, invalid text tile position",void i.tG.info(538798175,i.nh.CoreDefault,o.stop());switch(s.deltaType){case D.WI.Add:a=s.position<n.length?`${n.slice(0,s.position)}${s.content}${n.slice(s.position,n.length)}`:n+s.content;break;case D.WI.Update:s.content||s.unit!==D.OD.Sentence||(o.dimension0="1"),a=`${n.slice(0,s.position)}${s.content}${n.slice(s.position+(s.length||0),n.length)}`;break;case D.WI.Delete:a=`${n.slice(0,s.position)}${n.slice(s.position+(s.length||0),n.length)}`}return i.tG.info(538837071,i.nh.CoreDefault,o.stop()),new B.qf({content:a})}catch(e){return o.success=!1,o.resultDescription=`Error applying text tile delta: ${e}`,void i.tG.info(538798176,i.nh.CoreDefault,o.stop())}}function Ye(e,t){var s,o,n,i,a;const r=(null===(s=t.attributionData)||void 0===s?void 0:s.ranges)||t.attributionRanges;if((null===(o=t.attributionData)||void 0===o?void 0:o.isFullUpdate)||t.deltaType!==D.WI.AttributionUpdate&&void 0!==r)return r;if(!(null===(n=e.attributionRanges)||void 0===n?void 0:n.length)&&!r||t.deltaType===D.WI.Update&&0===t.length)return e.attributionRanges;let c=e.attributionRanges?[...e.attributionRanges]:[];if(t.deltaType!==D.WI.AttributionUpdate){const s=Xe(e.attributionRanges,t.deltaType,t.position),o=s?c.indexOf(s):-1;-1!==o&&(s.length=t.position-s.start);const n=(null!==(i=t.content)&&void 0!==i?i:"").length,r=null!==(a=t.length)&&void 0!==a?a:0,l=t.position+r,u=t.position+n;for(const e of c.slice(o+1)){if(e.start<t.position)continue;const s=e.start+e.length;l>e.start&&(e.length=s-l),e.start=Math.max(e.start+n-r,u)}return c=c.filter((e=>e.length>0)),c}const l=[];for(const e of r)0!==l.length&&l[l.length-1].start+l[l.length-1].length>=e.start?l[l.length-1].length=e.start+e.length-l[l.length-1].start:l.push({start:e.start,length:e.length});c=c.filter((e=>e.length>0&&!(e=>{for(const t of l)if(t.start<=e.start&&t.start+t.length>=e.start+e.length)return!0;return!1})(e))),null==r||r.forEach((e=>{c.push(e)})),c.sort(((e,t)=>e.start-t.start));const u=[];for(const e of c){const t=u.length>0?u[u.length-1]:void 0;t&&t.start+t.length>e.start&&(t.length=Math.max(e.start-t.start,0)),!t||(g=e,(p=t).attribution.userId!==g.attribution.userId||p.attribution.timestamp!==g.attribution.timestamp||p.attribution.dataSource!==g.attribution.dataSource)||e.start>t.start+t.length?u.push(e):t.length+=Math.max(e.start+e.length-(t.start+t.length),0)}var p,g;return u}function Ze(e,t,s){var o,a,r,c;const l=new n.I({operationName:"ApplyFormattedTextTileDeltaForLocalWorkflows",dimension0:"0",success:!0}).start();l.clientFlights=s;try{if(!t)return l.success=!1,l.resultDescription="Unable to apply formatted text tile delta, parent tile is undefined",void i.tG.info(538798177,i.nh.CoreDefault,l.stop());if(S.h.getTypeNameFor(t)!==B.Cg.getTypeName())return l.success=!1,l.resultDescription=`Unable to apply formatted text tile delta, parent tile is not proper type: expected ${B.Cg.getTypeName()}, received ${S.h.getTypeNameFor(t)}`,void i.tG.info(538798178,i.nh.CoreDefault,l.stop());const s=t,u=e,p=s.content;let g="";if((void 0===u.position||u.position<0)&&!tt(u.deltaType))return l.success=!1,l.resultDescription="Unable to apply formatted text tile delta, invalid text tile position",void i.tG.info(538798179,i.nh.CoreDefault,l.stop());if(void 0===u.content&&!tt(u.deltaType))return l.success=!1,l.resultDescription="Unable to apply formatted text tile delta, non-delete, non-formatting, non-other-non-content-update and non-cursor-update operation without content defined",void i.tG.info(538798208,i.nh.CoreDefault,l.stop());if(u.deltaType===D.WI.Add&&0!==u.length?i.tG.info(538798209,i.nh.CoreDefault,new n.I({operationName:"ApplyDeltaChecks",resultDescription:"Received formatted text tile delta add operation with delta length, expected length 0",success:!0})):tt(u.deltaType)&&void 0!==u.content&&i.tG.info(538798210,i.nh.CoreDefault,new n.I({operationName:"ApplyDeltaChecks",resultDescription:"Received formatted text tile delta delete or non-content related operation with content defined, expected undefined",success:!0})),!et(u.deltaType)){const e=function(e,t){var s,o,n,i;const a=Xe(e.formattedRanges,t.deltaType,t.position);let r=e.formattedRanges?[...e.formattedRanges]:[];const c=a?r.indexOf(a):-1;-1!==c&&(t.position+(t.length||0)>a.start+a.length?a.length=t.position+(null!==(s=t.content)&&void 0!==s?s:"").length-a.start:a.length+=(null!==(o=t.content)&&void 0!==o?o:"").length-(t.length||0),r[c]=a);for(const e of r.slice(c+1))e.start<t.position||(t.position+(t.length||0)>e.start?(e.length=e.start+e.length-(t.position+(t.length||0)),e.start=t.position+(null!==(n=t.content)&&void 0!==n?n:"").length):e.start+=(null!==(i=t.content)&&void 0!==i?i:"").length-(t.length||0));return r=r.filter((e=>e.length>0)),r}(s,u),t=Ye(s,u);let n=s.ipPosition;switch(u.deltaType){case D.WI.Add:g=u.position<p.length?`${p.slice(0,u.position)}${u.content}${p.slice(u.position,p.length)}`:p+u.content,n=u.position+u.length;break;case D.WI.Update:u.content||u.unit!==D.OD.Sentence||(l.dimension0="1"),g=`${p.slice(0,u.position)}${u.content}${p.slice(u.position+(null!==(o=u.length)&&void 0!==o?o:0),p.length)}`,n=u.position+u.content.length;break;case D.WI.Delete:g=`${p.slice(0,u.position)}${p.slice(u.position+(null!==(a=u.length)&&void 0!==a?a:0),p.length)}`,n=u.position}const r=new B.Cg(Object.assign(Object.assign({},s),{ipPosition:n,content:g,formattedRanges:e,attributionRanges:t,queryRange:u.queryRange}));return i.tG.info(538837073,i.nh.CoreDefault,l.stop()),r}if(u.deltaType===D.WI.CursorUpdate)return new B.Cg(Object.assign(Object.assign({},s),{ipPosition:null===(r=u.cursorData)||void 0===r?void 0:r.ipPosition,isColdIp:null===(c=u.cursorData)||void 0===c?void 0:c.isColdIp}));if(u.deltaType===D.WI.FormattingUpdate)return new B.Cg(Object.assign(Object.assign({},s),{formattedRanges:u.formattedRanges}));if(u.deltaType===D.WI.OtherNonContentUpdate){let e;const t={};for(e in u.otherNonContentData)t[e]=u.otherNonContentData[e];return new B.Cg(Object.assign(Object.assign({},s),t))}return u.deltaType===D.WI.AttributionUpdate?new B.Cg(Object.assign(Object.assign({},s),{attributionRanges:Ye(s,u)})):void 0}catch(e){return l.success=!1,l.resultDescription=`Error applying formatted text tile delta: ${e}`,void i.tG.info(538798211,i.nh.CoreDefault,l.stop())}}function Xe(e,t,s){const o=new n.I({operationName:"FindRangeForDelta",success:!0});if(o.start(),!e)return o.resultDescription="No formatted ranges found within the tile, skipping.",void i.tG.info(538798212,i.nh.CoreDefault,o.stop());if(t===D.WI.Add){const t=e.find((e=>e.start===s&&0===e.length));if(t)return o.resultDescription=`Found a zero-length formatted range for add operation with start ${t.start}.`,i.tG.info(538798213,i.nh.CoreDefault,o.stop()),t;s=Math.max(s-1,0)}const a=e.find((e=>0===e.length?e.start===s:e.start<=s&&s<e.start+e.length));return a?(o.resultDescription=`Updating formatted range for operation with start: ${a.start} and length: ${a.length}`,i.tG.info(538798214,i.nh.CoreDefault,o.stop())):(o.resultDescription=`Unable to find formatted range for operation at position ${s}, skipping.`,i.tG.info(538798215,i.nh.CoreDefault,o.stop())),a}function et(e){return-1!==Qe.indexOf(e)}function tt(e){return et(e)||D.WI.Delete===e}class st{constructor(e){this.model=e.model,this.clientMetadata=e.clientMetadata,this.userContext=e.userContext,this.site=e.site,this.getTokenCallback=e.getTokenCallback}get flights(){var e;return null!==(e=this._flights)&&void 0!==e||(this._flights=l(this.clientMetadata.flights)),this._flights}getToken(e,t){return this.getTokenCallback(e,t)}getTokenAsync(e){return new Promise(((t,s)=>{this.getToken(e,((e,o,n)=>{e?s(e):t(Object.assign(Object.assign({},n),{token:o}))}))}))}}class ot{constructor(e,t,s){this.itemsContextId=new Set,this.executionState=new Map,this.graphNode=e,this.onContextIdWorkflowExecutionComplete=t,s&&(this.itemsContextId=s.itemsContextId,this.executionState=s.executionState)}addInputItemToProcess(e){this.itemsContextId.add(e)}removeProcessedInputItem(e){this.itemsContextId.delete(e)}countItemsToProcess(e){let t=0;for(const s of this.itemsContextId)0===s.indexOf(e)&&(t+=1);return t}getExecutionState(){return this.executionState}setExecutionState(e,t){return this.graphNode.isActivated?e?(this.executionState.set(e,t),!0):(i.tG.info(520217546,i.nh.CoreDefault,new n.I({operationName:"WorkflowExecutionTracker",resourceId:this.graphNode.workflow.id,joinContextId:e,resultDescription:`Trying to set state ${t} for a undefined contextId (setExecutionState)`})),!1):(i.tG.info(508883415,i.nh.CoreDefault,new n.I({operationName:"WorkflowExecutionTracker",resourceId:this.graphNode.workflow.id,joinContextId:e,resultDescription:`Trying to set state ${t} for a not activated workflow`})),!1)}beforeWorkflowExecution(e){this.setExecutionState(e,re.Pending)}afterWorkflowExecution(e){this.setExecutionState(e,re.Executed)&&this.tryToCompleteWorkflowExecution(e)}clearWorkflowExecutions(){this.executionState.forEach(((e,t)=>this.afterWorkflowExecution(t)))}tryToCompleteWorkflowExecution(e){if(this.executionState.get(e)===re.Executed&&this.canCompleteExecution(e)){this.executionState.delete(e),this.onContextIdWorkflowExecutionComplete&&this.onContextIdWorkflowExecutionComplete(this.graphNode.workflow.id,e);for(const t of this.downstreamWorkflowExecutionTrackers)for(const[s,o]of t.getExecutionState())o===re.Executed&&ae.isParentContextId(e,s)&&t.tryToCompleteWorkflowExecution(s)}}canCompleteExecution(e){for(const t of this.upstreamWorkflowExecutionTrackers)for(const s of t.getExecutionState().keys())if(ae.isParentContextId(s,e))return!1;return!0}}var nt;!function(e){e.Unknown="",e.InputReceived="input",e.JoinMaxAnnnotation="maxAnnotation",e.JoinMaxTimeout="maxTimeout",e.JoinEarlyCompletion="earlyCompletion"}(nt||(nt={}));class it{constructor(e,t,s){this.executionTrackersByWorkflowNameBySession=new Map,this.workflowsWithSessionAffinity=new Map,this.workflowDefinitionsWithSessionAffinity=[],this.workflowsWithoutSessionAffinity=[],this.pendingScopeExecutionNotificationsByWorkflow=new Map,this.sweepIntervalMs=200,this.sweepTimers=new Map,this.getResourceAsArrayBuffer=(e,t,s)=>this.modelDownloader?this.modelDownloader.getResourceAsArrayBuffer(e,t,s):Promise.reject(new Error("Resource Downloader never created")),this.getResourceAsURL=(e,t,s)=>this.modelDownloader?this.modelDownloader.getResourceAsURL(e,t,s):Promise.reject(new Error("Resource Downloader never created")),this.createModel=e=>(!this.inferenceService&&this.inferenceServiceFactory&&(this.inferenceService=this.inferenceServiceFactory()),this.inferenceService?this.inferenceService.then((t=>t.createModel(e))):Promise.reject(new Error("Inference Service never created"))),this.createModelInputs=()=>{if(!this.inferenceService&&this.inferenceServiceFactory&&(this.inferenceService=this.inferenceServiceFactory()),this.inferenceService)return this.inferenceService.then((e=>e.createInputs()));throw new Error("Inference Service never created")},this.nextAnnotationId=1,this.nextSignalId=1,this.modelDownloader=e,this.inferenceServiceFactory=t,s.enableDeltas&&(this.deltaHandlers=(new Map).set(S.h.getTypeNameFor(P.Q),Je).set(S.h.getTypeNameFor(P.s),Ze),this.itemsForDelta=new Map),this.enableEarlyJoin=s.enableEarlyJoin||!1,this.site={getResourceAsArrayBuffer:this.getResourceAsArrayBuffer,getResourceAsURL:this.getResourceAsURL,createModel:this.createModel,createModelInputs:this.createModelInputs}}getNextClientAnnotationId(){return"#AC"+this.nextAnnotationId++}getNextClientSignalId(){return"#SC"+this.nextSignalId++}registerLocalWorkflow(e,t){const s=new n.I({operationName:"WorkflowRegistration",resourceId:e.id}).start();if(0===e.inputTypes.length)throw new Error("Invalid workflow params");t?(this.workflowsWithSessionAffinity.get(t).push(this.createWorkflowImplementation(e,t)),t.registerContextTypes(Be(e.requestedContextTypesRules).map((([e,t])=>e))),t.attachToWorkflowGraph(e),s.setClientMetadata(t.getClientMetadata())):(e.isStateful?(this.workflowDefinitionsWithSessionAffinity.push(e),this.workflowsWithSessionAffinity.forEach(((t,s)=>{t.push(this.createWorkflowImplementation(e,s))}))):this.workflowsWithoutSessionAffinity.push(this.createWorkflowImplementation(e)),this.workflowsWithSessionAffinity.forEach(((t,s)=>{s.registerContextTypes(Be(e.requestedContextTypesRules).map((([e,t])=>e))),s.attachToWorkflowGraph(e)}))),s.success=!0,i.tG.info(572838110,i.nh.CoreDefault,s.stop())}getAllRegisteredWorkflowsFromSession(e){const t=[];return t.push(...this.workflowsWithoutSessionAffinity||[]),t.push(...this.workflowsWithSessionAffinity.get(e)||[]),t.map((e=>e.workflow))}getWorkflowDefinitionsByName(e){var t;const s=new Map;return null===(t=this.workflowsWithSessionAffinity.get(e))||void 0===t||t.forEach((e=>s.set(e.workflow.id,e.workflow))),s}getWorkflowDefinitionsWithSessionAffinity(){return this.workflowDefinitionsWithSessionAffinity}attachExecutionTrackerToEachWorkflow(e,t,s){const o=e.getWorkflowNodes(),n=this.executionTrackersByWorkflowNameBySession.get(t),i=(e,o)=>{if(s&&s(e,o),this.enableEarlyJoin){(()=>{var e;for(const s of(null===(e=this.executionTrackersByWorkflowNameBySession.get(t))||void 0===e?void 0:e.values())||[])if(s.graphNode.workflow.kind===I.wC.Join)for(const e of s.getExecutionState().keys())if(ae.isParentContextId(e,o))return!0;return!1})()&&(this.cancelSweepTimer(t),this.ensureSweepTimer(t),this.sweepScopeExecutionNotifications())}};if(n){for(const e of o){const t=n.get(e.workflow.id),s=new ot(e,i.bind(this),t);n.set(e.workflow.id,s)}for(const e of n.values())this.setDownstreamWorkflowExecutionTrackers(e,n),this.setUpstreamWorkflowExecutionTrackers(e,n)}}canActivateWorkflow(e,t){var s;return e.location===Q.Local||!!t.hasConnected&&!((null===(s=e.workflow.requiredTokenTypes)||void 0===s?void 0:s.length)>0&&t.getServerAuthenticationState()===k.f.NotAuthenticated)}setDownstreamWorkflowExecutionTrackers(e,t){if(void 0!==e.downstreamWorkflowExecutionTrackers)return;e.downstreamWorkflowExecutionTrackers=new Set;const{graphNode:s}=e;for(const o of s.downstreamWorkflows||[]){const s=t.get(o.workflow.id);this.setDownstreamWorkflowExecutionTrackers(s,t),e.downstreamWorkflowExecutionTrackers.add(s)}}setUpstreamWorkflowExecutionTrackers(e,t){if(void 0!==e.upstreamWorkflowExecutionTrackers)return;e.upstreamWorkflowExecutionTrackers=new Set;const{graphNode:s}=e;for(const o of s.upstreamWorkflows||[]){const s=t.get(o.workflow.id);this.setUpstreamWorkflowExecutionTrackers(s,t),e.upstreamWorkflowExecutionTrackers.add(s)}}deactivateServerWorkflow(e,t){var s,o;e.location!==Q.Local&&(null===(o=null===(s=this.executionTrackersByWorkflowNameBySession.get(t))||void 0===s?void 0:s.get(e.workflow.id))||void 0===o||o.clearWorkflowExecutions(),e.isActivated=!1)}addSession(e){this.isWorkflowTrackingEnabled(e)&&this.executionTrackersByWorkflowNameBySession.set(e,new Map);const t=[];for(const s of this.workflowDefinitionsWithSessionAffinity)t.push(this.createWorkflowImplementation(s)),e.attachToWorkflowGraph(s);this.workflowsWithSessionAffinity.set(e,t);for(const t of this.workflowsWithoutSessionAffinity)e.attachToWorkflowGraph(t.workflow)}isWorkflowTrackingEnabled(e){return this.enableEarlyJoin||e.enabledRemoteExecutionNotification()}closeSession(e){this.cancelSweepTimer(e);for(const t of this.workflowsWithSessionAffinity.get(e)||[])t.workflowLambda.dispose();this.workflowsWithSessionAffinity.delete(e),this.isWorkflowTrackingEnabled(e)&&this.executionTrackersByWorkflowNameBySession.delete(e)}setTokenCallback(e){this.getAuthTokenCallback=e}preProcessItemToWorkflow(e,t,s){var o;const n=null===(o=this.executionTrackersByWorkflowNameBySession.get(s))||void 0===o?void 0:o.get(e.id);n&&(e.kind===I.wC.Join&&S.h.matchesTypesFor(t.body,e.inputTypes)&&n.addInputItemToProcess(t.contextId),(e.kind===I.wC.SingleItem&&S.h.matchesTypesFor(t.body,e.inputTypes)||e.kind===I.wC.Join&&S.h.matchesTypesFor(t.body,[e.collectionScopeType]))&&n.beforeWorkflowExecution(t.contextId))}isReadyToEarlyJoin(e,t,s){if(!e)return!1;const o=o=>{var a;const r=Array.from(null!==(a=o.states)&&void 0!==a?a:[]).map((e=>`${e[0]}: ${e[1].map((e=>e.join()))}`)).join(),c=new n.I({operationName:"EarlyJoinCompletion",resourceId:e.graphNode.workflow.id,joinContextId:t,success:!0}).start();c.setClientMetadata(s),c.resultDescription=`isReadyToEarlyJoin (${this.enableEarlyJoin}) -> hasProcessedAllInputItems: ${o.hasProcessedAllInputItems}, allUpstreamComplete: ${o.allUpstreamComplete}, states: ${r}`,i.tG.info(512550800,i.nh.CoreDefault,c.stop())},a=0===e.countItemsToProcess(t);if(!a)return this.enableEarlyJoin||o({hasProcessedAllInputItems:a}),!1;const{allUpstreamComplete:r,states:c}=this.areAllUpstreamWorkflowComplete(e,t);return this.enableEarlyJoin?r:(o({hasProcessedAllInputItems:a,allUpstreamComplete:r,states:c}),!1)}areAllUpstreamWorkflowComplete(e,t){const s=new Map;for(const o of e.upstreamWorkflowExecutionTrackers){const e=[];for(const[n,i]of o.getExecutionState())if(e.push([n,i]),ae.isParentContextId(t,n))return s.set(o.graphNode.workflow.id,e),{allUpstreamComplete:!1,states:s};e.length>0&&s.set(o.graphNode.workflow.id,e)}return{allUpstreamComplete:!0,states:s}}runLocalWorkflows(e,t,s=!1){var o,a,r;const c=(e,s,o)=>{var a,r;const c=t.getWorkflowItemStorage(),{workflow:l}=e,u=null===(a=this.executionTrackersByWorkflowNameBySession.get(t))||void 0===a?void 0:a.get(l.id),p=l.inputTypes.concat(l.kind===I.wC.Join?l.collectionScopeType:[]),g=new n.I({operationName:"RunLocalWorkflows",success:!0,resourceId:l.id,joinContextId:s.contextId}).start();if(g.setClientMetadata(t.getClientMetadata()),S.h.matchesTypesFor(s.body,p)){const n=le(o.parentPath,s);if(l.kind===I.wC.Join){if(S.h.matchesTypesFor(n.body,[l.collectionScopeType]))return c.setScopeItem(n,l),g.resultDescription=`Scope item: ${s.id} (${S.h.getTypeNameFor(s.body)})`,i.tG.info(524126153,i.nh.CoreDefault,g.stop()),void this.setScopeExecutionNotification(t,e,n);{null==u||u.removeProcessedInputItem(n.contextId);const e=c.getScopeItem(n.contextId,l);if(!e)return g.resultDescription=`Filtered out join invalidation: out of scope type (${l.collectionScopeType}), item id: ${n.id}`,void i.tG.info(541173894,i.nh.CoreDefault,g.stop());c.addItemToWorkflowList(n,l),g.joinContextId=e.contextId,g.resultDescription=`Input item: ${s.id} (${S.h.getTypeNameFor(s.body)})`}}if(S.h.getBaseTypesFor(n.body).indexOf(A.W1.getTypeName())>=0){const e=[...n.parentPath,n.id];let s=!0;for(const o of null!==(r=l.outputTypes)&&void 0!==r?r:[])if(!t.getContextAnnotations(o,qe.LocalWorkflow,e,l.id)){s=!1;break}if(s)return}const a=()=>{var o;const[r,p]=t.resolveRequestedContexts(l);if(!r)return g.resultDescription=`Required contexts are not ready for ${l.id}. Retrying execution in 500 milliseconds...`,i.tG.info(545837259,i.nh.CoreDefault,g.stop()),void setTimeout(a,500);if(l.kind===I.wC.SingleItem)this.queueWorkflow({workflowInfo:e,scopeItem:n,inputItems:[n],requestedContexts:p,session:t,triggerReason:nt.InputReceived,onCompleteCallback:this.onWorkflowExecuted.bind(this,n,l,t)}).then((()=>{i.tG.info(509154263,i.nh.WorkflowDefault,g.stop())})).catch((e=>{g.resultDescription=e,i.tG.error(572838111,i.nh.CoreDefault,g.stop())}));else if(l.kind===I.wC.Join){const n=s.contextId,a=c.getScopeItem(n,e.workflow);if(!a)return g.resultDescription=`No scope item for ${l.id} workflow from contextId ${n}`,void i.tG.info(526758475,i.nh.CoreDefault,g.stop());const r=this.isReadyToEarlyJoin(u,a.contextId,t.getClientMetadata()),h=r?nt.JoinEarlyCompletion:nt.JoinMaxAnnnotation;if(c.isWorkflowReady(a.contextId,l)||r){if(!(null===(o=this.pendingScopeExecutionNotificationsByWorkflow.get(l.id))||void 0===o?void 0:o.get(a.contextId)))return g.resultDescription=`Workflow ${l.id}, contextId ${a.contextId}, already queued, skipping new scope execution`,void i.tG.info(528048977,i.nh.CoreDefault,g.stop());const s=c.getItemsToExecute(a.contextId,l);this.queueWorkflow({workflowInfo:e,scopeItem:a,inputItems:s,requestedContexts:p,session:t,triggerReason:h,onCompleteCallback:this.onWorkflowExecuted.bind(this,a,l,t)}).then((()=>{i.tG.info(509154262,i.nh.WorkflowDefault,g.stop())})).catch((e=>{g.resultDescription=e,i.tG.error(541173895,i.nh.CoreDefault,g.stop())})),this.pendingScopeExecutionNotificationsByWorkflow.get(l.id).delete(a.contextId),0===this.pendingScopeExecutionNotificationsByWorkflow.get(l.id).size&&this.pendingScopeExecutionNotificationsByWorkflow.delete(l.id)}}};a()}};let l=e;s&&(l=[new v.Xr({parentPath:["session"],items:[{id:"#userContext#",body:new A.hD}]}),new v.Xr({parentPath:["session"],items:[{id:"#tenantContext#",body:new A.SB}]})],t.getContextIdManager().applyContextIdOnOperations(l),l=l.concat(e));for(const e of l){const s=S.h.getTypeNameFor(e);for(const n of e.items)if(t.applyOperationForContext(e,n,qe.Submitted),s!==v.n4.getTypeName()){if(n.body)if(s===v.xU.getTypeName()&&this.deltaHandlers&&this.itemsForDelta)this.handleLocalDeltaUpdate(n,e,t);else{null===(a=this.itemsForDelta)||void 0===a||a.set(e.parentPath.concat(n.id).toString(),n);for(const t of this.workflowsWithoutSessionAffinity)c(t,n,e);for(const s of null!==(r=this.workflowsWithSessionAffinity.get(t))&&void 0!==r?r:[])c(s,n,e)}}else null===(o=this.itemsForDelta)||void 0===o||o.delete(e.parentPath.concat(n.id).toString())}}handleLocalDeltaUpdate(e,t,s){const o=new n.I({operationName:"LocalDeltaUpdate",dimension0:S.h.getTypeNameFor(e.body),success:!0});o.start();try{const n=this.deltaHandlers.get(S.h.getTypeNameFor(e.body)),a=this.itemsForDelta.get(t.parentPath.toString());if(n&&a){const r=t.parentPath.length>0?t.parentPath.slice(0,t.parentPath.length-1):t.parentPath,c=n(e.body,a.body);if(c){const t={id:a.id,revId:e.revId,body:c,parentPath:r,delta:e.body,contextId:e.contextId},n=new v.I({parentPath:t.parentPath,items:[t]});i.tG.info(539637591,i.nh.CoreDefault,o.stop()),this.runLocalWorkflows([n],s)}else o.success=!1,o.resultDescription="Failed because the handler did not produce valid updated item",i.tG.info(539637592,i.nh.CoreDefault,o.stop())}else o.success=!1,o.resultDescription="Failed due to lack of handler or parent item",i.tG.info(539637593,i.nh.CoreDefault,o.stop())}catch(e){o.success=!1,o.resultDescription=`Failed to apply delta, error: ${e}`,i.tG.info(539637594,i.nh.CoreDefault,o.stop())}}createWorkflowImplementation(e,t){const s=e.factory();return{workflow:e,workflowLambda:s,initPromise:this.initWorkflow(e.kind,s,t)}}initWorkflow(e,t,s){const o=new st({model:void 0,clientMetadata:s?s.getClientMetadata():void 0,userContext:s?s.getUserContext():void 0,site:this.site,getTokenCallback:this.getAuthTokenCallback});return e===I.wC.SingleItem||e===I.wC.Join?t.init(this.site,o):Promise.resolve()}queueWorkflow(e){var t,s;return null===(s=null===(t=this.executionTrackersByWorkflowNameBySession.get(e.session))||void 0===t?void 0:t.get(e.workflowInfo.workflow.id))||void 0===s||s.setExecutionState(e.scopeItem.contextId,re.Running),this.executeLocalWorkflow(e.workflowInfo,e.scopeItem,e.inputItems,e.session,e.requestedContexts,e.triggerReason).then((t=>{this.processAnnotationResults(t,e.session),e.onCompleteCallback()})).catch((t=>{throw e.onCompleteCallback(),t}))}processAnnotationResults(e,t){for(const s of e)t.onAnnotationResults(s,qe.LocalWorkflow,(()=>{}))}executeLocalWorkflow(e,t,s,o,a,r){return new Promise(((c,l)=>{var u,p,g;const h=[],d=e.workflow,m=new n.I({operationName:"ExecuteWorkflow",resourceId:d.id,joinContextId:null!==(u=null==t?void 0:t.contextId)&&void 0!==u?u:"",resultDescription:null!=r?r:"",success:!0}).setClientMetadata(o.getClientMetadata());m.start();const y=null!==(p=null==t?void 0:t.contextId)&&void 0!==p?p:s[0].contextId,T=null!==(g=null==t?void 0:t.revId)&&void 0!==g?g:s[0].revId,f=(()=>{const e=new Map;if(t&&(t.parentPath||i.tG.error(525382231,i.nh.CoreDefault,`Missing scope item parent. Workflow: ${d.id}. Type: ${S.h.getTypeNameFor(t.body)}`),e.set(t.body,t)),Array.isArray(s))for(const t of s)t&&t.body&&(t.parentPath||i.tG.error(525382232,i.nh.CoreDefault,`Missing parent. Workflow: ${d.id}. Type: ${S.h.getTypeNameFor(t.body)}`),e.set(t.body,t));return e})(),_=(e,t=m)=>{if(e)return t.success=!1,t.resultDescription+="string"==typeof e?e:e.message,t.resultSignature="Exception",i.tG.error(572838112,i.nh.CoreDefault,t.stop()),"string"==typeof e?new Error(e):e;i.tG.info(572838113,i.nh.CoreDefault,t.stop())},k=new st({model:new Ke(s[0],a),clientMetadata:o.getClientMetadata(),userContext:o.getUserContext(),site:this.site,getTokenCallback:this.getAuthTokenCallback}),B=e=>{_(e?e.message:void 0),e?l(e):c(h)},D={setAnnotations:(a,r,c,u)=>{var p;const g=new n.I({operationName:"SetAnnotations",resourceId:r,joinContextId:null!==(p=null==t?void 0:t.contextId)&&void 0!==p?p:"",success:!0}).setClientMetadata(o.getClientMetadata());g.start();const m=t=>{i.tG.info(555866112,i.nh.CoreDefault,new b.v({annotationType:r,annotationState:t,workflowId:e.workflow.id}))};for(const e of c)e.metadata=Object.assign(Object.assign({},e.metadata),{state:C.Created}),m(C.Created);const E=f.get(a),w=S.h.getTypeNameFor(E.body),k=(()=>{var e;if(d.kind===I.wC.SingleItem&&s[0].body!==a){const e=`Expected obj to be ${s[0].body} but instead it was ${a}`;return _(e,g),void l(_(e))}let t,n;if(Array.isArray(c))if(!d.outputTypes||d.outputTypes.indexOf(r)<0)t=`Workflow said it would output one of [${d.outputTypes}] but instead output ${r}`;else if(E)for(const e of c)S.h.matchesTypesFor(e,[N.YH.getTypeName()])?S.h.getTypeNameFor(e)!==r&&(t=`Workflow produced inconsistent annotation types in setAnnotations call (${S.h.getTypeNameFor(e)} did not match expected ${r})`):t=`Workflow produced an output that is not an annotation ${S.h.getTypeNameFor(e)}`;else t="No item provided";else t="Workflow produced an invalid annotation array";if(t)return _(t,g),void l(_(t));n=u&&u.isSessionAnnotation?["session"]:u&&u.ancestorType?E.parentPath:E.parentPath.concat(E.id);const p=[],h=[];for(const t of c){t.metadata=Object.assign(Object.assign({},t.metadata),{state:C.Sent}),m(C.Sent);const s=t.id,a=s?null===(e=o.getContextAnnotations(r,qe.LocalWorkflow,n,d.id))||void 0===e?void 0:e.filter((e=>{var t;return(null===(t=e.body)||void 0===t?void 0:t.id)==s})):void 0;1==(null==a?void 0:a.length)?1==a.length?h.push({id:a[0].id,source:d.id,revId:T,body:t,contextId:y}):i.tG.error(545837260,i.nh.CoreDefault,`Assert: Multiple existing context annotations with body id ${s} found for ${r} and local workflow ${d.id}).`):p.push({id:this.getNextClientAnnotationId(),source:d.id,revId:T,body:t,contextId:y})}const f=[];return p.length>0&&f.push(new v.Xr({parentPath:n,items:p,parentRevId:T})),h.length>0&&f.push(new v.fZ({parentPath:n,items:h,parentRevId:T})),new M.B_({annotationType:r,ops:f})})();k?(u&&u.immediate?o.onAnnotationResults(k,qe.LocalWorkflow,(()=>{})):h.push(k),(w==A.hD.getTypeName()||w==A.SB.getTypeName()||S.h.matchesTypesFor(E.body,[A.yo.getTypeName(),A.I3.getTypeName()]))&&o.submitOperationsToSession(k.ops),i.tG.info(509644822,i.nh.CoreDefault,g.stop())):i.tG.info(509644823,i.nh.CoreDefault,g.stop())},submitSignals:e=>{const t=new n.I({operationName:"submitSignalsAction",resourceId:d.id,success:!0}).setClientMetadata(o.getClientMetadata());for(const s of e){const e=S.h.getTypeNameFor(s);S.h.matchesTypesFor(s,[E.HN.getTypeName()])||(t.resultDescription=`Workflow produced an output that is not an signal (${S.h.getTypeNameFor(s)})`,i.tG.info(521413954,i.nh.CoreDefault,t)),d.outputTypes&&-1!==d.outputTypes.indexOf(e)||(t.resultDescription=`Workflow said it would output one of [${d.outputTypes}] but instead output ${e}`,i.tG.info(521413953,i.nh.CoreDefault,t)),s.timestamp&&(it.logTimestampUsageByWorkflowId.has(d.id)||(it.logTimestampUsageByWorkflowId.add(d.id),t.resultDescription=`Workflow "${d.id}" sets signal.timeStamp`,i.tG.info(509212803,i.nh.CoreDefault,t)))}const s=e.map((e=>({id:this.getNextClientSignalId(),source:d.id,revId:T,body:e,contextId:y}))),a=new v.g0({parentPath:["session"],parentRevId:T,items:s});o.submitOperations([a])},done:B,overrideWorkflowDefinition:(e,s,n)=>{let a;switch(n){case w.T.JoinContext:if(!t.contextId){const e="ContextId is not defined for this scope item.";throw i.tG.error(527472289,i.nh.CoreDefault,e),new Error(e)}a=t.contextId;break;case w.T.Session:a=void 0;break;default:{const e="Defined scope is not supported. "+n;throw i.tG.error(527472290,i.nh.CoreDefault,e),new Error(e)}}const r=new L.Qr({definition:s,contextId:a,sourceWorkflowId:d.id,targetWorkflowId:e});o.onWorkflowDefinitionOverrideMessage(r)},getDynamicAnnotations:void 0,setBillingDomain:void 0,sendClientRequest:void 0,sendClientRequestStreaming:void 0},P=e.workflowLambda;if(d.kind===I.wC.SingleItem){1!==s.length&&B(new Error("Single item workflows expect a single input")),k.delta=s[0].delta,k.deltas=s[0].deltas;try{const t=P;e.initPromise||(e.initPromise=t.init(this.site,k)),e.initPromise.then((()=>{t.execute(s[0].body,k,D)})).catch((e=>{_(e)}))}catch(e){_(e)}}else if(d.kind===I.wC.Join){0===s.length&&B(new Error("Join workflows expect an inputs array")),k.delta=t.delta,k.deltas=t.deltas;try{const o=P;e.initPromise||(e.initPromise=o.init(this.site,k)),e.initPromise.then((()=>{o.execute(t.body,s.map((e=>e.body)),k,D)})).catch((e=>{_(e)}))}catch(e){_(e)}}else _(`Workflow kind ${d.kind} not supported`)}))}ensureSweepTimer(e){if(!this.sweepTimers.get(e)){const t=setInterval(this.onSweep.bind(this),this.sweepIntervalMs);this.sweepTimers.set(e,t)}}cancelSweepTimer(e){const t=this.sweepTimers.get(e);this.sweepTimers.get(e)&&(clearInterval(t),this.sweepTimers.delete(e))}onSweep(){this.sweepScopeExecutionNotifications()}setScopeExecutionNotification(e,t,s){var o,a;const r=Date.now(),c={session:e,workflowImplementation:t,scopeItem:s,startTime:r,minTime:r+(0,Ge.ZF)(t.workflow.minDelayMs,1e3),maxTime:r+(0,Ge.ZF)(t.workflow.maxDelayMs,5e3)},l=t.workflow.kind===I.wC.Join?s.contextId:c.scopeItem.parentPath.concat(s.id).join("\\");this.pendingScopeExecutionNotificationsByWorkflow.get(t.workflow.id)||this.pendingScopeExecutionNotificationsByWorkflow.set(t.workflow.id,new Map);if(this.pendingScopeExecutionNotificationsByWorkflow.get(t.workflow.id).get(l)){const o=new n.I({resultDescription:`Duplicated pending scope execution for ${t.workflow.id} at ${l}`,operationName:"LocalScopeExecutionNotification",resourceId:t.workflow.id,joinContextId:null!==(a=null==s?void 0:s.contextId)&&void 0!==a?a:"",success:!0}).setClientMetadata(e.getClientMetadata()).start();i.tG.info(509727899,i.nh.CoreDefault,o.stop())}else{const a=new n.I({resultDescription:`New pending scope execution for ${t.workflow.id} at ${l}`,operationName:"LocalScopeExecutionNotification",resourceId:t.workflow.id,joinContextId:null!==(o=null==s?void 0:s.contextId)&&void 0!==o?o:"",success:!0}).setClientMetadata(e.getClientMetadata()).start();i.tG.info(539883075,i.nh.CoreDefault,a.stop()),this.pendingScopeExecutionNotificationsByWorkflow.get(t.workflow.id).set(l,c)}this.ensureSweepTimer(e)}sweepScopeExecutionNotifications(){var e,t;const s=new Set(Array.from(this.sweepTimers.keys()));for(const[o,a]of Array.from(this.pendingScopeExecutionNotificationsByWorkflow.entries()))for(const[r,c]of Array.from(a.entries())){const{session:a,workflowImplementation:{workflow:l}}=c,u=a.getWorkflowItemStorage(),p=new n.I({operationName:"LocalScopeExecutionNotification",resourceId:l.id,joinContextId:null!==(t=null===(e=c.scopeItem)||void 0===e?void 0:e.contextId)&&void 0!==t?t:"",success:!0}).setClientMetadata(a.getClientMetadata()).start(),g=()=>{var e;if(l.kind===I.wC.Join){const t=Date.now(),{workflow:s}=c.workflowImplementation,o=c.scopeItem.contextId,n=a.getWorkflowDefinition(s,o).maxDelayMs;return u.isWorkflowReady(o,s)?(p.resultDescription=`Join Workflow: ${s.id} queuing by maxAnnotation, contextId: ${o}`,i.tG.info(528048978,i.nh.CoreDefault,p.stop()),{isValid:!0,triggerReason:nt.JoinMaxAnnnotation}):c.startTime+n<t?(p.resultDescription=`Join Workflow: ${s.id} queuing by maxTimeout, contextId: ${o}`,i.tG.info(528048979,i.nh.CoreDefault,p.stop()),{isValid:!0,triggerReason:nt.JoinMaxTimeout}):this.isReadyToEarlyJoin(null===(e=this.executionTrackersByWorkflowNameBySession.get(a))||void 0===e?void 0:e.get(s.id),o,a.getClientMetadata())?(i.tG.info(512550856,i.nh.CoreDefault,`Workflow: ${s.id} queuing by early completion, contextId: ${o}, timeout: ${n}`),{isValid:!0,triggerReason:nt.JoinEarlyCompletion}):{isValid:!1,triggerReason:nt.Unknown}}return{isValid:!0,triggerReason:nt.Unknown}};(()=>{const{isValid:e,triggerReason:t}=g();if(!e)return!1;const[s,o]=a.resolveRequestedContexts(l);if(!s)return!1;try{if(l.kind===I.wC.Join){const e=c.scopeItem.contextId,s=u.getScopeItem(e,l);if(s){const n=u.getItemsToExecute(s.contextId,l);if(0===n.length)return p.resultDescription=`Failed to retrieve items for workflow: ${l.id}, contextId: ${e}, skipping execution`,i.tG.info(527472291,i.nh.CoreDefault,p.stop()),this.onWorkflowExecuted(s,l,a),!0;this.queueWorkflow({workflowInfo:c.workflowImplementation,scopeItem:s,inputItems:n,requestedContexts:o,session:a,triggerReason:t,onCompleteCallback:this.onWorkflowExecuted.bind(this,s,l,a)}).catch((e=>{p.success=!1,p.resultDescription=e.message,i.tG.error(509092189,i.nh.CoreDefault,p.stop())}))}else p.resultDescription="ContextId no longer exists, skipping workflow execution",i.tG.info(539883076,i.nh.CoreDefault,p.stop())}else p.resultDescription=`Workflow in type ${l.kind} is not supported`,i.tG.error(539883077,i.nh.CoreDefault,p.stop())}catch(e){p.resultDescription=`Trying to execute ${l.id} caused an exception: ${e}`,i.tG.warn(539883078,i.nh.CoreDefault,p.stop())}return!0})()?(this.pendingScopeExecutionNotificationsByWorkflow.get(o).delete(r),0===this.pendingScopeExecutionNotificationsByWorkflow.get(o).size&&this.pendingScopeExecutionNotificationsByWorkflow.delete(o)):s.delete(a)}if(0!==s.size)for(const e of Array.from(s)){const t=new n.I({resultDescription:"No pending scope notifications left, cancelling sweep timer",operationName:"LocalScopeExecutionNotification",success:!0}).start();i.tG.debug(539883079,i.nh.CoreDefault,t.stop()),this.cancelSweepTimer(e)}}onExternalWorkflowExecuted(e,t,s){const o={id:"",parentPath:[],contextId:e},n={id:t};this.onWorkflowExecuted(o,n,s,!1)}onWorkflowExecuted(e,t,s,o=!0){var n,i;null===(i=null===(n=this.executionTrackersByWorkflowNameBySession.get(s))||void 0===n?void 0:n.get(t.id))||void 0===i||i.afterWorkflowExecution(e.contextId),o&&t.kind===I.wC.Join&&s.getWorkflowItemStorage().onWorkflowExecuted(e,t)}}var at=s(505778),rt=s(87477);const ct=JSON.stringify(new M.ry({error:at.t$}));class lt{constructor(e){this.networkOverrideOptions=e,this.isClosed=!1,this.pendingEgress=[]}init(e,t,s,o){const a=new n.I({operationName:"HttpWorkerInit",success:!0}).start(),r=e.split("/?x-origin=");2===r.length?(this.url=Ge.Aq.convertWebSocketUrlToHttp(r[0]),this.origin=r[1]):(this.url=Ge.Aq.convertWebSocketUrlToHttp(e),this.origin=void 0),this.ingress=t,this.onOpen=s,this.onClose=o,i.tG.info(507839180,i.nh.CoreDefault,a.stop())}egress(e){const t=new n.I({operationName:"HttpEgress",success:!0}).start();if(!this.isConnectedToSession()&&!e.isHttpSessionInitMessage)return this.pendingEgress.push(e),t.success=!1,t.resultDescription="NotConnected, pendingQueueSize:  "+this.pendingEgress.length.toString(),void i.tG.info(508163394,i.nh.CoreDefault,t.stop());const s=this.getRequestInfo(e,t);if(!s.url)return t.success=!1,t.resultDescription="Could not generate HTTP request",void i.tG.error(508163393,i.nh.CoreDefault,t.stop());e.isHttpSessionLongPollMessage?this.egressLongPoll(s,t):(0,at.OW)(s.url,s.request,((e,s)=>{e?this.onEgressError(t,"OnEgressError:"+(null==e?void 0:e.message)):s&&s.ok?s.text().then((e=>{t.success=!0,i.tG.info(508163362,i.nh.CoreDefault,t.stop()),this.ingressInternal(e)})).catch((e=>{this.onEgressError(t,"OnEgressParseError: "+(null==e?void 0:e.message))})):this.onEgressError(t,"OnEgressResponseError: "+(null==e?void 0:e.message)+`, Status ${null==s?void 0:s.status}: ${null==s?void 0:s.statusText}`)}))}close(){const e=new n.I({operationName:"HttpWorkerClose",success:!0}).start();if(this.isClosed)return e.resultDescription="AlreadyClosed",void i.tG.info(508163360,i.nh.CoreDefault,e.stop());i.tG.info(508163359,i.nh.CoreDefault,e.stop()),this.isClosed=!0,this.sessionSettings=void 0,this.onClose&&(this.onClose(void 0),this.onClose=void 0)}onEgressError(e,t){e.success=!1,e.resultDescription=t,i.tG.error(508163358,i.nh.CoreDefault,e.stop()),this.isClosed||this.close()}ingressInternal(e,t){let s=e;t||(s=this.formatServerInput(e));const o=e=>{M.uN.typeGuard(e)&&this.onSessionInitResponse(e)};s&&(this.logIngressCount(s),this.ingress(s,o))}onSessionInitResponse(e){const t=new n.I({operationName:"HttpWorkerOpen",success:!0}).start();if(!(e.sessionKey&&e.origin&&e.anonymousToken&&e.sessionUrlBase))return t.success=!1,t.resultDescription="SessionInitResponse missing information",void i.tG.error(507809949,i.nh.CoreDefault,t.stop());i.tG.info(508163357,i.nh.CoreDefault,t.stop()),this.setSessionSettings(e.sessionKey,e.origin,e.anonymousToken,e.sessionUrlBase),this.onOpen(),this.pendingEgress.forEach((e=>{this.egress(e)})),this.pendingEgress=[]}egressLongPoll(e,t){(0,at._A)(e.url,2e4,e.request).then((e=>{e&&e.ok?e.text().then((e=>{t.success=!0,t.resourceId="LongPoll",i.tG.info(508163355,i.nh.CoreDefault,t.stop()),this.ingressInternal(e)})).catch((e=>{this.onEgressError(t,"LongPollFetchParseError: "+(null==e?void 0:e.message))})):this.onEgressError(t,"LongPollFetchStatusFailure: "+(null==e?void 0:e.statusText))})).catch((e=>{e.message===at.t$?(t.success=!1,t.resultDescription="LongPollFetchResponseTimeout:"+(null==e?void 0:e.message),i.tG.error(508163353,i.nh.CoreDefault,t.stop()),this.ingressInternal(ct,!0)):this.onEgressError(t,"LongPollFetchResponseError: "+(null==e?void 0:e.message))}))}getRequestInfo(e,t){const s=this.getUrl(null==e?void 0:e.isHttpSessionInitMessage),o=this.getHeader(e,t);return t.resultSignature=s,{url:s,request:{method:"POST",headers:o,body:e.obj}}}getUrl(e){const t=this.sessionSettings&&this.sessionSettings.sliceUrl?this.sessionSettings.sliceUrl:this.url;return e?t+"/sessioninit":this.isConnectedToSession()?t+"/session/"+this.sessionSettings.sessionKey:""}getHeader(e,t){var s;const o=new rt.Headers;return(null==e?void 0:e.isHttpSessionInitMessage)?(o.set("Content-Type","application/json"),this.origin&&o.set("x-origin",this.origin)):this.isConnectedToSession()&&(e.obj instanceof Uint8Array||e.obj instanceof ArrayBuffer?(o.set("Content-Type","application/jsond2"),t.dimension0=e.obj.byteLength.toString().length.toString()):o.set("Content-Type","application/json"),o.append("Authorization",`Bearer ${this.sessionSettings.anonymousToken}`),o.set("x-origin",this.sessionSettings.origin)),(null===(s=this.networkOverrideOptions)||void 0===s?void 0:s.hostHeader)&&o.set("host",this.networkOverrideOptions.hostHeader),o}setSessionSettings(e,t,s,o){const n=o.replace("/session","");this.sessionSettings={sessionKey:e,origin:t,anonymousToken:s,sliceUrl:n}}isConnectedToSession(){return this.sessionSettings&&this.sessionSettings.sessionKey.length>0&&this.sessionSettings.anonymousToken.length>0&&this.sessionSettings.origin.length>0&&this.sessionSettings.sliceUrl.length>0&&!this.isClosed}formatServerInput(e){return e.length>1?e.substring(1,e.length-1):""}logIngressCount(e){const t=e.length;if(t>1e5){const e=new n.I({operationName:"HttpIngressByteOrderOfMagnitude",success:!0}).start();e.dimension2=t.toString().length.toString(),i.tG.info(508409622,i.nh.CoreDefault,e.stop())}}}class ut{}var pt,gt=s(93440),ht=s.n(gt);!function(e){e.ArrivedBeforeReseeding="Message is dropped from queue since it arrived before reseeding is started",e.DroppedAsOldestInQueue="Message is dropped as oldest in full queue",e.DroppedBecauseClientDisconnected="Message is dropped because client is disconnected from server"}(pt||(pt={}));class dt{constructor(e){this.logOp=new n.I({operationName:"MessageQueue",success:!0}),this.queue=new(ht())(1e3),this.callbacks=e}clear(){this.queue.clear()}size(){return this.queue.length}push(e,t,s){this.logOp.start();const o=this.queue;if(1e3===o.length){this.logOp.resourceId="QueueFull",this.logOp.success=!1,i.tG.warn(508843746,i.nh.CoreDefault,this.logOp.stop());const e=o.shift();e.onResponse&&e.onResponse(new M._p({error:pt.DroppedAsOldestInQueue}))}o.push({message:e,onResponse:t,timeQueued:Ge.Aq.getCurrentTimeMs(),attemptNumber:s})}sendOnSessionInitialized(e){this.logOp.start();const t=this.queue.length;let s=0;if(t>0){const o=Ge.Aq.getCurrentTimeMs()-this.queue.get(0).timeQueued;for(;this.queue.length>0&&this.callbacks.canSendMessage();){const t=this.queue.shift();e&&this.containSequencedSyncMessage(t)?(s++,t.onResponse&&t.onResponse(new M._p({error:pt.ArrivedBeforeReseeding}))):t.message instanceof Uint8Array?this.callbacks.sendBytes(t.message):this.callbacks.sendMessage(t.message,t.onResponse,t.attemptNumber)}this.logOp.resourceId="SendOnSessionInitialized",this.logOp.resultDescription=`Queue size before: ${t}, after: ${this.queue.length}. droppedSyncMessages: ${s}`,this.logOp.setDataField("OldestMessageInQueueTimeWaitingMs",o),this.logOp.success=!0,i.tG.warn(508843745,i.nh.CoreDefault,this.logOp.stop())}}containSequencedSyncMessage(e){return e.message instanceof M.Tb&&S.h.matchesTypesFor(e.message,[M.Tb.getTypeName()])&&e.message.seq>=0||e.message instanceof M.l0&&S.h.matchesTypesFor(e.message,[M.l0.getTypeName()])}}var mt;!function(e){e[e.Initing=0]="Initing",e[e.Running=1]="Running",e[e.Disconnected=2]="Disconnected",e[e.Closed=3]="Closed"}(mt||(mt={}));const yt=(e,t,s,o)=>{t&&(t.cv||(t.cv=e.cvParent.newChild().toString()),e.messageEndpoint.sendMessage(t,((t,o)=>{t||S.h.getTypeNameFor(o)!==M.fZ.getTypeName()||(e.stats.lastSyncMessage=Date.now()),s&&s(t,o)}),void 0,o))},Tt=(e,t,s,o)=>{t&&(e.messageQueue.push(t,s,o),e.networkWorkerManager.init(void 0,e.customInitPromise).catch((e=>{const t=new n.I({operationName:"WorkerManagerInit",success:!1,resultDescription:`${e}`});i.tG.error(508843789,i.nh.CoreDefault,t)})))},ft=(e,t)=>{t&&(e.messageQueue.push(t),e.networkWorkerManager.init(void 0,e.customInitPromise).catch((e=>{i.tG.error(508843788,i.nh.CoreDefault,`Init failed: ${e}`)})))};class _t{constructor(e){this.context=e}onEnter(e){}sendMessage(e,t,s,o){}sendBytes(e){}canSendMessage(){return!1}onConnectionClose(){}}class Ct extends _t{constructor(){super(...arguments),this.stateName=mt.Initing,this.possibleNextStates=[mt.Running,mt.Disconnected,mt.Closed]}sendMessage(e,t,s){S.h.matchesTypesFor(e,[M.eE.getTypeName()])?yt(this.context,e,t,s):Tt(this.context,e,t)}sendBytes(e){ft(this.context,e)}onConnectionClose(){this.context.setState(mt.Disconnected)}}class St extends _t{constructor(){super(...arguments),this.stateName=mt.Running,this.possibleNextStates=[mt.Disconnected,mt.Closed]}onEnter(e){e&&e.isSessionReseedingStarted&&this.context.resetNextSyncSequenceId(),this.context.messageQueue.sendOnSessionInitialized(e&&e.isSessionReseedingStarted)}sendMessage(e,t,s,o){yt(this.context,e,t,s)}sendBytes(e){e&&this.context.networkWorkerManager.egressBytes(e)}canSendMessage(){return!0}onConnectionClose(){this.context.setState(mt.Disconnected)}}class At extends _t{constructor(){super(...arguments),this.stateName=mt.Disconnected,this.possibleNextStates=[mt.Initing,mt.Closed]}onEnter(e){this.context.messageEndpoint.cancelPendingResponseCallbacks(Se.ClientDisconnected)}sendMessage(e,t,s,o){if(S.h.matchesTypesFor(e,[M.eE.getTypeName()]))this.context.setState(mt.Initing),yt(this.context,e,t,s);else if(S.h.matchesTypesFor(e,[M.w9.getTypeName()]))this.context.setState(mt.Closed);else{if(!o)return void Tt(this.context,e,t,s);t&&t(new M._p({messageId:e.messageId,error:pt.DroppedBecauseClientDisconnected}))}}sendBytes(e){ft(this.context,e)}}class vt extends _t{constructor(){super(...arguments),this.stateName=mt.Closed,this.possibleNextStates=[]}onEnter(e){this.context.messageEndpoint.cancelPendingResponseCallbacks(Se.ClientClosed)}}var Nt=s(758488);const Et=3e4;class It{constructor(e,t,s,o){this.lastPingTime=0,this.lastPongTime=0,this.lastEgressTime=0,this.remainingPingFailures=3,this.isPingPongSuccessful=!1,this.reducedPingPongRetryEnabled=o,this.pingPongLogOp=new n.I({operationName:"WebSocketReliabilityManager",success:!0,resourceId:this.reducedPingPongRetryEnabled?"reducedPingPongRetryEnabled":""}).start(),this.pingPongLogOp.setClientMetadata(s,!0),this.worker=e,this.rateControllerClose=t}start(){this.reducedPingPongRetryEnabled?(this.pingPongLogOp.start(),this.pingPongLogOp.resultSignature="initial ping"):this.logOperation(!0,"ping","initial ping"),this.ping(),this.isPingPongSuccessful=!0,this.startInterval()}onResponse(){this.lastPongTime=Date.now(),this.reducedPingPongRetryEnabled&&(this.pingPongLogOp.success=!0,i.tG.info(506795283,i.nh.CoreDefault,this.pingPongLogOp.stop()))}isReliabilityResponse(e){return"string"==typeof e&&1===e.length&&e===It.pingPongMessage}close(){this.reducedPingPongRetryEnabled?(this.pingPongLogOp.start(),this.pingPongLogOp.success=!0,this.pingPongLogOp.resultSignature="close",i.tG.info(506795282,i.nh.CoreDefault,this.pingPongLogOp.stop())):this.logOperation(!0,"ping","close"),this.lastPingTime=0,this.lastPongTime=0,this.isPingPongSuccessful=!1,this.clearPingInterval(),this.worker=void 0}checkConnection(){return this.isPingPongSuccessful}postEgress(){this.lastEgressTime=Date.now()}needsParsedResponses(){return!1}ping(){this.reducedPingPongRetryEnabled?this.worker||(this.pingPongLogOp.success=!1,this.pingPongLogOp.resultDescription="websocket worker undefined",this.rateControllerClose(),i.tG.info(506795281,i.nh.CoreDefault,this.pingPongLogOp.stop())):this.lastPingTime=Date.now(),this.worker&&(this.reducedPingPongRetryEnabled&&(this.lastPingTime=Date.now()),this.worker.egress({obj:It.pingPongMessage}))}startInterval(){this.pingInterval=setInterval((()=>{if(this.reducedPingPongRetryEnabled){if(this.lastPongTime<this.lastPingTime&&Date.now()-this.lastPingTime<Et)return;this.isPingPongSuccessful=this.lastPongTime>=this.lastPingTime,this.pingPongLogOp.start(),this.isPingPongSuccessful?(this.pingPongLogOp.resultSignature="ping",this.ping()):(this.pingPongLogOp.success=!1,this.pingPongLogOp.resultDescription="Pong not received",i.tG.info(506795280,i.nh.CoreDefault,this.pingPongLogOp.stop()),this.worker?this.worker.close():this.rateControllerClose())}else{if(this.isPingPongSuccessful=this.lastPongTime>=this.lastPingTime&&this.lastPongTime-this.lastPingTime<=Et,this.lastPongTime>this.lastEgressTime)return;const e=this.lastPongTime-this.lastPingTime;this.isPingPongSuccessful?(this.remainingPingFailures=3,this.ping()):this.remainingPingFailures>0?(--this.remainingPingFailures,this.ping()):(this.logOperation(!1,"ping","Pong still not received after all retry attempts",[`${e}`,`${this.remainingPingFailures}`]),this.worker?this.worker.close():this.rateControllerClose())}}),Et)}clearPingInterval(){this.pingInterval&&(clearInterval(this.pingInterval),this.pingInterval=void 0)}logOperation(e,t,s,o){var n,a,r,c;this.pingPongLogOp.start(),this.pingPongLogOp.success=e,this.pingPongLogOp.resultSignature=t,this.pingPongLogOp.resultDescription=s,o&&(this.pingPongLogOp.dimension0=null!==(n=o[0])&&void 0!==n?n:"",this.pingPongLogOp.dimension1=null!==(a=o[1])&&void 0!==a?a:"",this.pingPongLogOp.dimension2=null!==(r=o[2])&&void 0!==r?r:"",this.pingPongLogOp.dimension3=null!==(c=o[3])&&void 0!==c?c:""),i.tG.info(507320073,i.nh.CoreDefault,this.pingPongLogOp.stop())}}It.pingPongMessage="~";const wt="Request timed out";class bt{constructor(e,t,s){this.remainingRetryAttempts=4,this.isAsleep=!1,this.isLongPollSuccessful=!1,this.isActiveLongPoll=!1,this.isResponseReceived=!1,this.lastEgressTime=0,this.longPollLogOp=new n.I({operationName:"OnLongPollMessage",success:!0}),this.clientMetadata=t,this.sessionCorrelationVector=s,this.longPollLogOp.setClientMetadata(this.clientMetadata,!0),this.worker=e}start(){const e=new n.I({operationName:"StartHttpReliabilityManager",success:!0}).start();e.setClientMetadata(this.clientMetadata,!0),i.tG.info(508163399,i.nh.CoreDefault,e.stop()),this.trySendLongPoll(de.PO.Start,!0),this.isLongPollSuccessful=!0}onResponse(e){if(!e||this.isResponseReceived){const e=new n.I({operationName:"HttpReliabilityManagerFailure",success:!1}).start();return e.setClientMetadata(this.clientMetadata,!0),void i.tG.info(508162497,i.nh.CoreDefault,e.stop())}this.isResponseReceived=!0,this.isActiveLongPoll=!1;const t=e;if(t.error)if(this.isLongPollSuccessful=!1,--this.remainingRetryAttempts,this.remainingRetryAttempts>0){this.longPollLogOp.success=!1,this.longPollLogOp.resultDescription=`Retry attempts left : ${this.remainingRetryAttempts}`,this.longPollLogOp.resultSignature=t.error,i.tG.info(508163398,i.nh.CoreDefault,this.longPollLogOp.stop());const e=t.error===wt?de.PO.TimeoutResend:de.PO.FailResend;t.error===wt||3===this.remainingRetryAttempts?this.trySendLongPoll(e,!0):this.enqueueSendLongPoll(e)}else this.longPollLogOp.success=!1,this.longPollLogOp.resultDescription="Long poll still not received after all retry attempts",i.tG.info(508163397,i.nh.CoreDefault,this.longPollLogOp.stop()),this.worker&&this.worker.close();else this.longPollLogOp.success=!0,this.longPollLogOp.resultDescription="Long poll received",i.tG.info(508163401,i.nh.CoreDefault,this.longPollLogOp.stop()),this.remainingRetryAttempts=4,this.isLongPollSuccessful=!0,this.trySendLongPoll(de.PO.Regular)}close(){const e=new n.I({operationName:"CloseHttpReliabilityManager",success:!0}).start();e.setClientMetadata(this.clientMetadata,!0),i.tG.info(508162467,i.nh.CoreDefault,e.stop()),this.sendLongPollTimer&&(clearTimeout(this.sendLongPollTimer),this.sendLongPollTimer=void 0),this.isActiveLongPoll=!1,this.isLongPollSuccessful=!1,this.worker=void 0}checkConnection(){if(this.isAsleep){this.isAsleep=!1;const e=new n.I({operationName:"AwakenHttpReliabilityManager",success:!0}).start();e.setClientMetadata(this.clientMetadata,!0),i.tG.info(508162496,i.nh.CoreDefault,e.stop()),this.trySendLongPoll(de.PO.CheckConnection,!0)}return this.isLongPollSuccessful}isReliabilityResponse(e){return"string"!=typeof e&&M.ry.typeGuard(e)}postEgress(){this.lastEgressTime=Date.now(),this.trySendLongPoll(de.PO.PostEgress)}needsParsedResponses(){return!0}enqueueSendLongPoll(e){this.sendLongPollTimer=setTimeout((()=>{this.trySendLongPoll(e,!0)}),2e4)}trySendLongPoll(e,t){if(!this.worker){const e=new n.I({operationName:"LongPollNoOp",success:!0}).start();return e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Worker is undefined",void i.tG.info(507281438,i.nh.CoreDefault,e.stop())}if(!0===this.isActiveLongPoll){const e=new n.I({operationName:"LongPollNoOp",success:!0}).start();return e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Already active long poll",void i.tG.info(508163396,i.nh.CoreDefault,e.stop())}if(this.isActiveLongPoll=!0,Date.now()-this.lastEgressTime>6e4&&!t){this.isActiveLongPoll=!1,this.isAsleep=!0;const e=new n.I({operationName:"LongPollSleep",success:!0}).start();return e.setClientMetadata(this.clientMetadata),e.resultDescription=`isAsleep: ${this.isAsleep}, isActiveLongPoll: ${this.isActiveLongPoll}`,void i.tG.info(507278739,i.nh.CoreDefault,e.stop())}this.longPollLogOp.start(),this.isResponseReceived=!1,this.worker.egress({obj:this.getLongPollMessageString(e),isHttpSessionLongPollMessage:!0,isHttpSessionInitMessage:!1})}getLongPollMessageString(e){const t=new M.LQ({longPollTimeoutHint:15e3,type:e});return this.sessionCorrelationVector&&(t.cv=this.sessionCorrelationVector().newChild().toString()),JSON.stringify(t)}}var kt=function(e,t,s,o){return new(s||(s=Promise))((function(n,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function r(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((o=o.apply(e,t||[])).next())}))};const Mt=1e5,Lt=3e6,Bt=1e3;class Dt{constructor(e){var t;this.emptyMessageId=0,this.egressMessageCount=0,this.egressByteCount=0,this.prevSeq=-1,this.rpsThreshold=150,this.bpsThreshold=5e8,this.isClosing=!1,this.messageQueue=void 0,this.egressRateLogOp=new n.I({operationName:"NetworkEgressRate",success:!0}),this.egressedCache=new Map,this.initPromise=new Promise((e=>{this.resolveInitPromise=e})),this.messageQueue=new(ht()),this.reducedPingPongRetryEnabled=null!==(t=null==e?void 0:e.reducedPingPongRetryEnabled)&&void 0!==t&&t}init(e,t,s,o,n){this.worker=e,this.ingress=t,this.clientMetadata=o,this.networkMode=s,this.reliabilityManager=((e,t,s,o,n)=>e instanceof lt?new bt(e,s,o):new It(e,t,s,n))(this.worker,this.close.bind(this),void 0,n,this.reducedPingPongRetryEnabled),this.egressRateLogOp.setClientMetadata(this.clientMetadata,!0),this.resetRateLimiter(),this.onCloseController=new Promise((e=>{this.resolveCloseControllerPromise=e})),this.queueProcessingCompletePromise=new Promise((e=>{this.resolveQueueProcessingCompletePromise=e})),this.resolveInitPromise()}open(){const e=new n.I({operationName:"NetworkRateControllerOpen",success:!0,dimension3:`networkMode: ${this.networkMode}`}).start();e.setClientMetadata(this.clientMetadata,!0),this.initPromise.then((()=>{if(!this.reliabilityManager)return e.success=!1,void(e.resultDescription="Reliability Manager is undefined");this.egressRateControlIntervalStart=Date.now(),this.reliabilityManager.start(),this.processQueue()})).catch((t=>{var s;e.success=!1,e.resultDescription="Catch: "+(null!==(s=null==t?void 0:t.message)&&void 0!==s?s:"")})).finally((()=>{i.tG.info(507834384,i.nh.CoreDefault,e.stop())}))}ingressFromWorker(e,t){this.reliabilityManager?this.reliabilityManager.needsParsedResponses()||!this.reliabilityManager.isReliabilityResponse(e)?this.ingress(e,(e=>{null==t||t(e),this.reliabilityManager.needsParsedResponses()&&this.reliabilityManager.isReliabilityResponse(e)&&this.reliabilityManager.onResponse(e)})):this.reliabilityManager.onResponse():this.ingress(e,t)}onRateLimitErrorResponse(e){const t=new n.I({operationName:"NetworkRateControllerOnRateLimitResponse",success:!0}).start();t.setClientMetadata(this.clientMetadata,!0),t.resultSignature=`rateLimitAlreadyStarted: ${void 0!==this.rateLimitTimeout}`,t.setDataField("RetryAfterMs",e.retryAfterMs),t.setDataField("QueueSize",this.messageQueue.length),this.startRateLimiting(e.retryAfterMs),i.tG.info(507388684,i.nh.CoreDefault,t.stop())}setRpsBps(e,t){const s=new n.I({operationName:"NetworkRateControllerRateLimitsSet",success:!0}).start();s.setClientMetadata(this.clientMetadata,!0),e&&(this.rpsThreshold=.8*e,s.resultDescription+=`maxRPS: ${e}, rpsThreshold: ${this.rpsThreshold}; `),t&&(this.bpsThreshold=.8*t,s.resultDescription+=`maxRPS: ${t}, rpsThreshold: ${this.bpsThreshold}; `),i.tG.info(507388683,i.nh.CoreDefault,s.stop())}close(){var e,t;return kt(this,void 0,void 0,(function*(){const s=new n.I({operationName:"NetworkRateControllerClose",success:!0,dimension3:`networkMode: ${this.networkMode}`}).start();s.setClientMetadata(this.clientMetadata,!0),this.isClosing=!0,null===(e=this.resolveCloseControllerPromise)||void 0===e||e.call(this);const o=null===(t=this.reliabilityManager)||void 0===t?void 0:t.checkConnection();s.setDataField("QueueSizeBeforeFlush",this.messageQueue.length),0!=this.messageQueue.length&&o&&(yield this.queueProcessingCompletePromise),s.setDataField("QueueSizeAfterFlush",this.messageQueue.length),s.setDataField("IsConnected",o),this.reliabilityManager?this.reliabilityManager.close():s.resultDescription="Reliability Manager is undefined",this.worker=void 0,this.prevSeq=-1,this.clearEgressControlTimeout(),this.reliabilityManager=void 0,i.tG.info(507834381,i.nh.CoreDefault,s.stop())}))}clearMessageQueues(){this.egressedCache.clear(),this.messageQueue=void 0}egress(e,t=0){var s,o;if(!this.reliabilityManager)return void this.logEgressActivity(!1,"Reliability Manager is undefined","");const a=this.getMessageSize(e);if(a>=Lt)return void this.logEgressActivity(!1,"Message size exceeded 3000000",`Message size: ${a}`);if((e.obj instanceof ArrayBuffer||e.isHttpSessionInitMessage)&&this.worker)return this.logEgressActivity(!0,`isArrayBuffer: ${e.obj instanceof ArrayBuffer}, isHttpSessionInitMessage: ${e.isHttpSessionInitMessage}`,""),void this.worker.egress(e);this.validateSyncMessage(e.messageId,e.seqId);const r=null!==(s=e.messageId)&&void 0!==s?s:"id"+this.emptyMessageId++,c={obj:e.obj,seqId:null==e?void 0:e.seqId,messageId:r,isHttpSessionInitMessage:null==e?void 0:e.isHttpSessionInitMessage},l=t>0,u=new n.I({operationName:"NetworkRateControllerQueueItem",success:!0,dimension3:`isRetry: ${l}`}).start();u.setClientMetadata(this.clientMetadata,!0);const p={message:c,logOp:u};if(l?this.messageQueue.unshift(p):this.messageQueue.push(p),this.messageQueue.length>1e4){const e=this.messageQueue.shift(),t=`NetworkRateControllerQueue max size reached. Dropping messageId: ${e.message.messageId}`;throw e.logOp.resultDescription=t,e.logOp.success=!1,i.tG.info(506001225,i.nh.CoreDefault,e.logOp.stop()),new Error(t)}null===(o=this.resolveQueueNotEmptyPromise)||void 0===o||o.call(this)}getMessageSize(e){return e.obj instanceof ArrayBuffer?e.obj.byteLength:e.obj.length}sendToNetworkWorker(e){var t;try{if(!this.worker)return void this.logEgressActivity(!1,"NetworkWorker is undefined","SendToNetworkWorkerFailure");if(!this.reliabilityManager)return void this.logEgressActivity(!1,"Reliability Manager is undefined","SendToNetworkWorkerFailure");this.worker.egress(e),this.onSendToNetworkWorker(e),null===(t=this.reliabilityManager)||void 0===t||t.postEgress();const s=this.getMessageSize(e);this.logEgressCount(s)}catch(e){this.logEgressActivity(!1,"SendToNetworkWorkerFailure",e?e.message:"")}}onSendToNetworkWorker(e){if("string"==typeof e.obj)try{const t=JSON.parse(e.obj);if(M.Tb.typeGuard(t)){const e=t;(0,Fe.NR)(e,Date.now(),"SendToNetwork",new n.I({operationName:"AugloopClientPerfTracker",success:!0}).setClientMetadata(this.clientMetadata).start())}else if(L.x5.typeGuard(t)){const e=t;(0,Fe.m9)(e,"GetAnnotationsSendToNetwork",new n.I({operationName:"AugloopClientPerfTracker",success:!0}).setClientMetadata(this.clientMetadata).start())}}catch(e){}}processQueue(){var e,t,s;return kt(this,void 0,void 0,(function*(){if(!this.reliabilityManager){const e=new n.I({operationName:"NetworkRateControllerProcessQueueFailure",success:!1,dimension3:`networkMode: ${this.networkMode}`}).start();return e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Reliability Manager is undefined",void i.tG.info(507573643,i.nh.CoreDefault,e.stop())}const o=new n.I({operationName:"NetworkRateControllerProcessQueue",success:!0}).start();for(;;){if(0===this.messageQueue.length){if(this.isClosing){o.setDataField("ExitReason","Stage#1 Closing");break}yield Promise.race([this.queueNotEmpty(),this.onCloseController])}if(this.rateLimitTimeout){const e=new n.I({operationName:"NetworkRateControllerRateLimitBackoff",dimension3:`networkMode: ${this.networkMode}`}).start();e.setClientMetadata(this.clientMetadata,!0),e.setDataField("QueueLengthBeforeBackoff",this.messageQueue.length),yield Promise.race([this.rateLimitTimeout,this.onCloseController]),e.setDataField("QueueLengthAfterBackoff",this.messageQueue.length),e.setDataField("IsClosing",this.isClosing),e.success=!0,this.rateLimitTimeout=void 0,this.resetRateLimiter(),i.tG.info(507281410,i.nh.CoreDefault,e.stop())}if(!(null===(e=this.reliabilityManager)||void 0===e?void 0:e.checkConnection())){if(this.isClosing){o.setDataField("ExitReason","Stage#2 Closing");break}yield this.checkConnectionPromise(),this.connectionPromise=void 0}if(!this.reliabilityManager){o.setDataField("ExitReason","Stage#2 ReliabilityManager null");break}for(;this.messageQueue.length>0&&this.reliabilityManager.checkConnection();){if(Date.now()-this.egressRateControlIntervalStart>=Bt)this.resetRateLimiter();else if(this.egressMessageCount>=this.rpsThreshold||this.egressByteCount>=this.bpsThreshold){const e=1100;let t="";this.egressMessageCount>=this.rpsThreshold&&(t+="RPS exceeded."),this.egressByteCount>=this.bpsThreshold&&(t+="BPS exceeded.");const s="rateLimitHit",o=new n.I({operationName:"NetworkRateControllerEgress",dimension3:`networkMode: ${this.networkMode}`}).start();o.setClientMetadata(this.clientMetadata,!0),o.success=!0,o.resultDescription=s,o.resultSignature=t,o.dimension0=this.messageQueue.length.toString().length.toString(),o.dimension1="rateLimitHit",o.setDataField("QueueLength",this.messageQueue.length),o.setDataField("RateLimitDelayMs",e),i.tG.info(507281409,i.nh.CoreDefault,o.stop()),this.startRateLimiting(e);break}const e=this.messageQueue.shift();this.sendToNetworkWorker(e.message),i.tG.info(507388682,i.nh.CoreDefault,e.logOp.stop())}this.onQueueNotEmpty=void 0,this.resolveQueueNotEmptyPromise=void 0}null===(t=this.resolveQueueProcessingCompletePromise)||void 0===t||t.call(this),this.resolveQueueProcessingCompletePromise=void 0,o.setClientMetadata(this.clientMetadata,!0),o.setDataField("QueueSize",this.messageQueue.length),o.setDataField("IsConnected",null===(s=this.reliabilityManager)||void 0===s?void 0:s.checkConnection()),o.setDataField("IsClosing",this.isClosing),i.tG.info(507368671,i.nh.CoreDefault,o.stop())}))}queueNotEmpty(){return this.onQueueNotEmpty||(this.onQueueNotEmpty=new Promise((e=>{this.resolveQueueNotEmptyPromise=e}))),this.onQueueNotEmpty}checkConnectionPromise(){return this.connectionPromise||(this.connectionPromise=new Promise((e=>{setTimeout(e,1e3)}))),this.connectionPromise}startRateLimiting(e){this.rateLimitTimeout||(this.rateLimitTimeout=new Promise((t=>{setTimeout(t,e)})))}resetRateLimiter(){this.egressRateControlIntervalStart=Date.now(),this.egressMessageCount=0,this.egressByteCount=0}clearEgressControlTimeout(){this.egressRateControlTimer&&(clearInterval(this.egressRateControlTimer),this.egressRateControlTimer=void 0)}validateSyncMessage(e,t){if(!(void 0===t||void 0===e||t<=this.prevSeq)){if(t&&t!==this.prevSeq+1){const e=new n.I({operationName:"NetworkRateControllerAbandonedSyncMessage",success:!0,dimension3:`networkMode: ${this.networkMode}`}).start();e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Gap in sync message",e.dimension0=`${this.prevSeq}`,e.dimension1=`${t}`,e.dimension2=""+(t-this.prevSeq),i.tG.info(507834370,i.nh.CoreDefault,e.stop())}this.prevSeq=t}}logEgressActivity(e,t,s,o){var a,r,c,l;const u=new n.I({operationName:"NetworkRateControllerEgress",dimension3:`networkMode: ${this.networkMode}`}).start();u.setClientMetadata(this.clientMetadata,!0),u.success=e,u.resultDescription=t,u.resultSignature=s,o&&(u.dimension0=null!==(a=o[0])&&void 0!==a?a:"",u.dimension1=null!==(r=o[1])&&void 0!==r?r:"",u.dimension2=null!==(c=o[2])&&void 0!==c?c:"",u.dimension3=null!==(l=o[3])&&void 0!==l?l:""),i.tG.info(507626007,i.nh.CoreDefault,u.stop())}logEgressCount(e){const t=Date.now();t-this.egressRateControlIntervalStart>Bt&&((this.egressMessageCount>50||this.egressByteCount>Mt)&&(this.egressRateLogOp.start(),this.egressRateLogOp.resultDescription=this.egressMessageCount>50?"rps logging threshold exceeded":"",this.egressRateLogOp.resultDescription=this.egressByteCount>Mt?"bps logging threshold exceeded":"",this.egressRateLogOp.dimension0=(t-this.egressRateControlIntervalStart).toString(),this.egressRateLogOp.dimension1=`${this.egressMessageCount}`,this.egressRateLogOp.dimension2=`${this.egressByteCount}`,this.egressRateLogOp.dimension3=`networkMode: ${this.networkMode}`,i.tG.info(508843792,i.nh.CoreDefault,this.egressRateLogOp.stop())),this.egressRateControlIntervalStart=t,this.egressMessageCount=0,this.egressByteCount=0),this.egressMessageCount++,this.egressByteCount+=null!=e?e:0}}var Pt=s(313189);class Rt{constructor(e,t,s,o,r,c,l,u,p){this.logCountLimiter=new Ge.yq(Rt.className),this.isWorkerReady=!1,this.permanentlyClosed=!1,this.currentReconnectAttempt=0,this.lastInitializationAttemptTimeMs=0,this.offlineInterval=void 0,this.alreadyLoggedReconnectAttempt=!1,this.httpTestsLeft=5,this.httpTestsSuccessCount=0,this.workerOpenCount=0,this.testHttpConnection=e=>{const t=Ge.Aq.convertWebSocketUrlToHttp(this.globalUrl),s=!e,o=null!=e?e:new n.I({operationName:"HttpsTest",resourceId:(0,Pt.k$)(t),success:!1,resultDescription:"",resultSignature:"HttpResponse:"}).start(),a={method:"POST",headers:{"content-type":"application/json","X-CorrelationId":o.cv},body:JSON.stringify(Ge.Aq.createHealthCheckRequest(this.clientMetadata))};(0,at.OW)(t,a,((e,t)=>{e?(o.dimension1="HttpErr",o.resultDescription+=`HttpErr: ${e.message}`):t&&t.ok?(o.dimension1="HttpOK",this.leaveOfflineMode(),this.httpTestsSuccessCount++,s&&(o.success=!0)):(o.dimension1="HttpNoResp",o.resultDescription+=`HttpStatus: ${null==t?void 0:t.status}`),s&&o.stop(),this.logCountLimiter.log((()=>{i.tG.info(508843780,i.nh.CoreDefault,o)}))}))},this.globalUrl=e,this.clientMetadata=t,this.workerFactory=s,this.sessionInitializer=o,this.ingress=r,this.onConnectionClose=c,this.sessionCorrelationVector=l,this.reducedPingPongRetryEnabled=u.reducedPingPongRetryEnabled,this.networkWorkerLogOp=new n.I({operationName:"CreateNetworkWorker",success:!0}),this.networkMode=p||a.JSWebSockets,this.initNetworkMode=this.networkMode}init(e,t,s=!1){if(this.permanentlyClosed)return Promise.reject(new Error("permanentlyClosed"));if(this.isWorkerReady||this.pendingInitPromise)return this.pendingInitPromise?this.pendingInitPromise:Promise.resolve();this.extensionConfigs=e||this.extensionConfigs;const o=()=>{if(s||!this.alreadyLoggedReconnectAttempt){const e=s?Rt.initialAttemptTimeout:Rt.reconnectAttemptTimeout;this.connTimeout=setTimeout((()=>{const t=new n.I({operationName:"ConnectionFailingOrSlow",dimension0:s?"Initial":"Reconnect",dimension1:e.toString(),dimension2:this.currentReconnectAttempt.toString()});i.tG.info(508843787,i.nh.CoreDefault,t),this.alreadyLoggedReconnectAttempt=!s,this.connTimeout=void 0}),e)}};return t?this.pendingInitPromise=t().catch((e=>{const t=new n.I({operationName:"WorkerManagerCustomInit",success:!1,resultDescription:`${e}`});i.tG.error(508843786,i.nh.CoreDefault,t)})).then((()=>{o(),this.initInternal()})):(this.pendingInitPromise=Promise.resolve(),o(),this.initInternal()),this.pendingInitPromise}egress(e,t){return!this.isWorkerReady&&this.pendingInitPromise?this.pendingInitPromise.then((()=>{this.egressInternal(e,t)})):(this.egressInternal(e,t),Promise.resolve())}egressBytes(e){return!this.isWorkerReady&&this.pendingInitPromise?this.pendingInitPromise.then((()=>{this.egressBytesInternal(e)})):(this.egressBytesInternal(e),Promise.resolve())}getNetworkMode(){return this.networkMode}getInitNetworkMode(){return this.initNetworkMode}onRateLimitErrorResponse(e){this.getNetworkRateController().onRateLimitErrorResponse(e)}close(e){this.isWorkerReady=!1,this.networkRateController&&this.getNetworkRateController().close(),this.worker&&(this.worker.close(),this.worker=null),this.networkRateController=null,this.permanentlyClosed=e||this.permanentlyClosed,this.permanentlyClosed&&(this.leaveOfflineMode(),clearTimeout(this.connTimeout))}initInternal(){if(this.isWorkerReady=!1,this.permanentlyClosed||this.isOffline()){const e=new n.I({operationName:"WorkerManagerInitOffline",success:!0,resultSignature:this.permanentlyClosed?"PermanentlyClosed":"Offline"});i.tG.info(508843785,i.nh.CoreDefault,e)}else this.currentReconnectAttempt>0?setTimeout((()=>{this.tryToConnectAndInitializeSession()}),((e,t,s)=>{let o=0;const n=Ge.Aq.getCurrentTimeMs()?Ge.Aq.getCurrentTimeMs()-t:0,i=[1e3,2e3,5e3,1e4,6e4];return o=i[Math.max(0,Math.min(i.length-1,e-1))],o=Math.max(o-n,1e3),o=s&&s>0?Math.min(5e3,o):o,o})(this.currentReconnectAttempt,this.lastInitializationAttemptTimeMs,this.httpTestsSuccessCount)):this.getNetworkMode()===a.HttpFallback?setTimeout((()=>{this.tryToConnectAndInitializeSession()}),100):this.tryToConnectAndInitializeSession()}egressInternal(e,t){if(!this.isWorkerReady&&!S.h.matchesTypesFor(e,[M.eE.getTypeName()]))return void(S.h.matchesTypesFor(e,[M.YK.getTypeName()])||i.tG.error(508843784,i.nh.CoreDefault,new n.I({operationName:"UnexpectedEgressCall",resultDescription:`isWorkerReady: ${this.isWorkerReady}`})));let s,o;if(S.h.matchesTypesFor(e,[M.VR.getTypeName()])?(this.castBinaryData(e),s=Nt.r.serialize(e)):s=JSON.stringify(e),M.Tb.typeGuard(e)&&(o=e.seq),this.bypassRateController(e))return void this.worker.egress({obj:s});const r=M.eE.typeGuard(e)&&this.getNetworkMode()===a.HttpFallback;this.getNetworkRateController().egress({obj:s,isHttpSessionInitMessage:r,messageId:e.messageId,seqId:o},t)}bypassRateController(e){return M.w9.typeGuard(e)}egressBytesInternal(e){this.isWorkerReady?this.getNetworkRateController().egress({obj:e}):i.tG.error(508843783,i.nh.CoreDefault,new n.I({operationName:"UnexpectedEgressBytesCall",resultDescription:`isWorkerReady: ${this.isWorkerReady}`}))}tryToConnectAndInitializeSession(){this.currentReconnectAttempt++,this.lastInitializationAttemptTimeMs=Ge.Aq.getCurrentTimeMs();const e=t=>{if(this.permanentlyClosed||this.isOffline())return;const s=this.sliceUrl?this.sliceUrl:this.globalUrl;t.setDataField("connectionUrl",(0,Pt.k$)(s)),this.connect(s),this.sessionInitializer.initSession({isTokenRefresh:!1,isReconnectOnSameSlice:!!this.sliceUrl,extensionConfigs:this.extensionConfigs,onResponse:(s,o)=>{if(t.success=!s,t.resourceId=o?(0,Pt.k$)(o.sliceUrl):"",t.dimension2=this.getNetworkModeLogString(),this.getNetworkMode()===a.HttpFallback?(t.resultDescription=s?`HTTP Error: ${s.error}`:"",t.dimension0=t.success?"HTTPOK":"HTTPFail"):(t.resultDescription=s?`WS Error: ${s.error}`:"",t.dimension0=t.success?"WSOK":"WSFail"),s||!this.worker)return this.sliceUrl=void 0,this.close(),this.httpTestsLeft>0?(this.httpTestsLeft--,this.testHttpConnection(t.stop())):(this.getNetworkMode()===a.JSWebSockets?0===this.workerOpenCount&&this.httpTestsSuccessCount>=5?(t.dimension1="WSBlocked",t.dimension3="HTTP Fallback",this.networkMode=a.HttpFallback,this.currentReconnectAttempt=0,this.resetHttpTestsCounter()):0===this.httpTestsSuccessCount&&(this.startOfflineMode(),t.dimension1="WSOffline"):0===this.httpTestsSuccessCount&&(this.startOfflineMode(),t.dimension1="HTTPOffline"),this.logCountLimiter.log((()=>{i.tG.info(508843782,i.nh.CoreDefault,t.stop())}))),void this.initInternal();if(this.logCountLimiter.log((()=>{i.tG.info(508843781,i.nh.CoreDefault,t.stop())})),o.forceReconnect){this.close();const t=new n.I({operationName:"ForcedReconnect"}).start();t.resultSignature=`globalUrl: ${this.globalUrl}. sliceUrl: ${this.sliceUrl}`,this.sliceUrl=void 0,setTimeout((()=>{e(t)}),1e3)}else clearTimeout(this.connTimeout),this.sliceUrl=o.sliceUrl,this.getNetworkRateController().setRpsBps(o.maxRPS,o.maxBPS),this.ready();this.resetHttpTestsCounter()}})},t=new n.I({operationName:"TryToConnectAndInitializeSession",resultSignature:`Reconnection attempt #${this.currentReconnectAttempt}`}).start();e(t)}getNetworkRateController(){return this.networkRateController||(this.networkRateController=new Dt({reducedPingPongRetryEnabled:this.reducedPingPongRetryEnabled})),this.networkRateController}connect(e){const t=this.getNetworkMode();this.networkWorkerLogOp.start(),this.networkWorkerLogOp.resultDescription=this.getNetworkModeLogString(),this.networkWorkerLogOp.dimension0=t.toString(),this.logCountLimiter.log((()=>i.tG.info(508372418,i.nh.CoreDefault,this.networkWorkerLogOp.stop()))),this.worker=this.workerFactory(t),this.worker.init(e,this.getNetworkRateController().ingressFromWorker.bind(this.networkRateController),(()=>{this.workerOpenCount++,this.getNetworkRateController().open(),this.leaveOfflineMode()}),(e=>{this.close(),this.onConnectionClose(e)}),this.clientMetadata),this.getNetworkRateController().init(this.worker,this.ingress,t,this.clientMetadata,this.sessionCorrelationVector)}ready(){this.isWorkerReady=!0,this.pendingInitPromise=void 0,this.currentReconnectAttempt=0}castBinaryData(e){if(e){if(Array.isArray(e.__binaryMembers__))for(const t of e.__binaryMembers__)ArrayBuffer.isView(e[t])||(e[t]=new Uint8Array(e[t]));for(const t of Object.keys(e))"object"==typeof e[t]&&null!==e[t]&&this.castBinaryData(e[t])}}isOffline(){return!!this.offlineInterval}startOfflineMode(){this.offlineInterval=setInterval((()=>{this.testHttpConnection()}),6e4)}leaveOfflineMode(){this.isOffline()&&(clearInterval(this.offlineInterval),this.offlineInterval=void 0,this.resetHttpTestsCounter(),this.tryToConnectAndInitializeSession())}resetHttpTestsCounter(){this.httpTestsLeft=5,this.httpTestsSuccessCount=0}getNetworkModeLogString(){return"NetworkMode: "+(this.getNetworkMode()===a.JSWebSockets?"WebSocket":"HTTP")}}Rt.initialAttemptTimeout=1e5,Rt.reconnectAttemptTimeout=2e4,Rt.className="NetworkWorkerManager";class Ot extends Oe.EventEmitter{constructor(e,t,s,o,i,a,r,c,l){super(),this.cvParent=new Y.W,this.logOp=new n.I({operationName:"SessionState",success:!0}).start(),this.sessionStateChangeLogCountLimiter=new Ge.yq("SessionState"),this.stats=t,this.allStates={[mt.Initing]:new Ct(this),[mt.Running]:new St(this),[mt.Disconnected]:new At(this),[mt.Closed]:new vt(this)},this.setState(mt.Initing),this.messageEndpoint=new Ne({messageIdPrefix:"c",responseTimeoutMs:3e4,resendPendingMessagesOnReconnect:!1}),this.messageEndpoint.setClientMetadata(i),this.messageEndpoint.setEgress(this.egress.bind(this)),this.messageEndpoint.onMessage(M.w9.getTypeName(),((e,t)=>{this.onSessionCloseMessage(e,t)})),this.networkWorkerManager=new Rt(e,i,s,o,this.ingress.bind(this),this.onConnectionClose.bind(this),this.getCorrelationVector.bind(this),r,l),this.messageQueue=new dt({sendMessage:(e,t,s,o)=>this.state.sendMessage(e,t,s,o),sendBytes:this.sendBytes.bind(this),canSendMessage:()=>this.state.canSendMessage()}),o.on("connect",((e,t,s,o,n,i,a,r,c)=>{this.setState(mt.Running,"",{isSessionReseedingStarted:e&&t}),this.emit("connect",e,s,o,n,i,a,r,c)})),o.on("reconnect",(()=>this.emit("reconnect"))),o.on("serverAuthenticationStateChange",(e=>this.emit("serverAuthenticationStateChange",e))),this.resetNextSyncSequenceId=()=>this.emit("resetNextSyncSequenceId"),this.tokenRefreshManager=a,this.gateUtils=c}setState(e,t,s){if(this.state&&e===this.state.stateName)return;const o=this.state?mt[this.state.stateName]:"undefined",n=this.state?this.state.possibleNextStates.indexOf(e)>=0:e===mt.Initing;this.sessionStateChangeLogCountLimiter.log((()=>{this.logOp.stop(),this.logOp.resourceId=`New state: ${n?mt[e]:o}`,this.logOp.resultDescription=`Previous state: ${o}`,this.logOp.dimension0=`Attempted state: ${mt[e]||"undefined"}`,this.logOp.resultSignature=t+(this.state&&!n?"Unexpected state change":""),this.logOp.success=n,i.tG.info(508843791,i.nh.CoreDefault,this.logOp)})),n&&(this.state=this.allStates[e],this.logOp.start(),this.state.onEnter(s))}init(e,t){return this.extensionConfigs=e,this.customInitPromise=t,this.networkWorkerManager.init(this.extensionConfigs,this.customInitPromise,!0)}sendMessage(e,t,s){this.retrySendMessage(e,t,Ot.maxRetries,s)}sendBytes(e){this.state.sendBytes(e)}onMessage(e,t){this.messageEndpoint.onMessage(e,t)}getCorrelationVector(){return this.cvParent}getNetworkWorkerManager(){return this.networkWorkerManager}forceReconnect(e){return this.extensionConfigs=e||this.extensionConfigs,this.networkWorkerManager.close(!1),new Promise((e=>setTimeout((()=>{e(this.networkWorkerManager.init(this.extensionConfigs))}),100)))}closeSession(e){this.sendMessage(new M.w9),this.networkWorkerManager.close(!0);const t=e||new M.Zy({reasonDescription:"ClientRequested"});this.onSessionClose(new M.w9({reconnectAllowed:!1,reason:t}),"ClientRequested")}ingress(e,t){let s;try{s=JSON.parse(e)}catch(e){i.tG.error(508843790,i.nh.CoreDefault,new n.I({operationName:"ProcessMessage",resourceId:"Unknown",success:!1,resultSignature:"ParseError",resultDescription:e.message,durationMs:0}))}if(s){if(t&&M.YK.typeGuard(s)&&t(s),this.networkWorkerManager.getNetworkMode()===a.HttpFallback&&M.ry.typeGuard(s)){const e=s;if(e.batch)for(const t of e.batch)this.messageEndpoint.ingress(t,((e,t)=>this.egress(e||t,(()=>{}))));return}this.messageEndpoint.ingress(s,((e,t)=>this.egress(e||t,(()=>{}))))}}egress(e,t,s){e&&this.networkWorkerManager.egress(e,s).then((()=>t())).catch((e=>t(e)))}onSessionCloseMessage(e,t){e.reconnectAllowed?this.networkWorkerManager.close():this.onSessionClose(e,"CloseMessageReceived"),t()}onSessionClose(e,t){this.setState(mt.Closed,t),this.tokenRefreshManager.clearAllTimeouts(),this.onConnectionClose(void 0),e&&this.emit("sessionClose",e)}onConnectionClose(e){this.state.onConnectionClose(),this.stats.lastConnectionClose=Ge.Aq.getCurrentTimeMs(),this.emit("disconnect",e)}retrySendMessage(e,t,s,o,a){const r=Ot.maxRetries-s;this.state.sendMessage(e,((c,l)=>{var u,p,g,h,d,m;a&&(c&&0==s?(a.dimension0=(r+1).toString(),a.success=!1,i.tG.info(507025311,i.nh.CoreDefault,a.stop())):c&&s>0?(a.dimension0=(r+1).toString(),a.dimension1=null!==(p=null===(u=c.code)||void 0===u?void 0:u.toString())&&void 0!==p?p:"NoErrorCode",a.resultSignature=null!==(g=c.error)&&void 0!==g?g:"NoErrorMessage"):(a.success=!0,i.tG.info(507025310,i.nh.CoreDefault,a.stop()))),c&&s>0&&this.canBeRetried(e)&&this.isTransientError(c)?(a||((a=new n.I({operationName:"RetrySendMessage",success:!0,dimension0:(r+1).toString()}).start()).resourceId=S.h.getTypeNameFor(e),a.dimension1=null!==(d=null===(h=c.code)||void 0===h?void 0:h.toString())&&void 0!==d?d:"NoErrorCode",a.resultSignature=null!==(m=c.error)&&void 0!==m?m:"NoErrorMessage",a.resultDescription=`Retrying message with messageId: ${e.messageId}${M.Tb.typeGuard(e)?`, seq: ${e.seq}`:""}`),S.h.matchesTypesFor(c,[M.ru.getTypeName()])&&this.networkWorkerManager.onRateLimitErrorResponse(c),this.retrySendMessage(e,t,s-1,o,a)):t&&t(c,l)}),r,o)}canBeRetried(e){return!S.h.matchesTypesFor(e,[M.eE.getTypeName(),M.VR.getTypeName(),L.x5.getTypeName()])}isTransientError(e){const t=e.error,s=e.code;return s!==de.xv.TokenValidationError&&s!==de.xv.TokenDecryptError&&s!==de.xv.SyncMessageTooLateOrDuplicate&&s!==de.xv.Gone&&(t!==Se.SyncMessageUnsupportedBatch&&t!==Se.UnexpectedSeedMessage&&t!==Se.UnsupportedSyncMessage&&t!==Se.AnnotationTokenNotFound&&t!==pt.ArrivedBeforeReseeding&&t!==pt.DroppedAsOldestInQueue&&t!==pt.DroppedBecauseClientDisconnected)}}var xt;Ot.maxRetries=2,function(e){e[e.Anonymous=0]="Anonymous",e[e.Host=1]="Host"}(xt||(xt={}));class Ft{constructor(){this.timers=new Map}scheduleRefresh(e,t,s,o){let n=this.timers.get(e);n||(n={numberOfAttempts:0},this.timers.set(e,n)),n.refreshTimeoutId&&(clearTimeout(n.refreshTimeoutId),n.refreshTimeoutId=void 0),n.expiredTimeoutId&&(clearTimeout(n.expiredTimeoutId),n.expiredTimeoutId=void 0);let i=1e3*t-Ft.tokenRefreshBufferMs,a=1e3*t-Ft.tokenExpirationBufferMs;i>0?n.numberOfAttempts=0:(++n.numberOfAttempts,i=Ft.tokenRefreshBackoffIntervalMs,a=Ft.tokenExpirationBufferMs),n.numberOfAttempts<=Ft.tokenRefreshMaximumAttempts&&(n.refreshTimeoutId=setTimeout((()=>{s()}),i)),o&&(n.expiredTimeoutId=setTimeout((()=>{o()}),a))}clearRefreshTimeouts(){this.clearTimeouts(!1)}clearAllTimeouts(){this.clearTimeouts(!0)}clearTimeouts(e){this.timers.forEach(((t,s)=>{t.refreshTimeoutId&&(clearTimeout(t.refreshTimeoutId),t.refreshTimeoutId=void 0),e&&t.expiredTimeoutId&&(clearTimeout(t.expiredTimeoutId),t.expiredTimeoutId=void 0),t.expiredTimeoutId||this.timers.delete(s)}))}}Ft.tokenRefreshBufferMs=24e4,Ft.tokenExpirationBufferMs=12e4,Ft.tokenRefreshBackoffIntervalMs=3e4,Ft.tokenRefreshMaximumAttempts=3;var Gt=function(e,t,s,o){return new(s||(s=Promise))((function(n,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function r(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((o=o.apply(e,t||[])).next())}))};class Wt extends Oe.EventEmitter{constructor(e,t,s,o,n){if(super(),this.getSessionStats=e,this.clientMetadata=t,this.tokenRefreshManager=s,this.sendMessage=o,this.options=n||{},this.options.overrideSessionInitMessage=this.options.overrideSessionInitMessage||(e=>e),this.clientMetadata&&!this.clientMetadata.userSystemTimezone)try{this.clientMetadata.userSystemTimezone=Intl.DateTimeFormat().resolvedOptions().timeZone}catch(e){}}initSession(e){e.onResponse=e.onResponse||(()=>{});const t=Ge.Aq.getCurrentTimeMs(),s=this.getSessionStats().lastConnectionClose&&t-this.getSessionStats().lastConnectionClose,o=this.getSessionStats().lastSyncMessage&&t-this.getSessionStats().lastSyncMessage,a=new n.I({operationName:"SessionInit"}).start(),r={sessionKey:this.sessionKey,sessionId:this.clientMetadata.sessionId,timeSinceLastConnectionClose:s,timeSinceLastSyncMessage:o,isTokenRefresh:e.isTokenRefresh,enableRemoteExecutionNotification:this.options.enableRemoteExecutionNotification,error:void 0,isSeedingRequired:void 0,enableCreateBlobStorageContainer:this.options.createBlobStorageContainerEnabled};let c;c=this.options.createCopyOfClientMetadataInSessionInit?Object.assign({},this.clientMetadata):this.clientMetadata;const l=this.options.overrideSessionInitMessage(new M.eE({protocolVersion:de.mH,clientMetadata:c,sessionKey:this.sessionKey,origin:this.origin,authToken:this.anonymousToken,extensionConfigs:e.extensionConfigs,returnWorkflowInputTypes:!0,enableRemoteExecutionNotification:this.options.enableRemoteExecutionNotification,createBlobStorageContainer:this.options.createBlobStorageContainerEnabled}));this.sendMessage(l,((t,s)=>{if(a.success=!t,a.resultSignature=this.getSessionStats().lastConnectionClose?"Reconnect":"FirstConnect",a.resourceId=(0,Pt.k$)(null==s?void 0:s.sliceUrl),a.setClientMetadata(this.clientMetadata),(null==s?void 0:s.sessionKey)&&r.sessionKey!==s.sessionKey&&(r.sessionKey=s.sessionKey),t&&(r.error=t.error),r.isSeedingRequired=this.sessionKey!==(null==s?void 0:s.sessionKey),a.resultDescription=JSON.stringify(r),i.tG.info(508843779,i.nh.CoreDefault,a.stop()),e.onResponse(t,s),t)this.emit("serverAuthenticationStateChange",k.f.NotAuthenticated);else if(e.isReconnectOnSameSlice&&s.forceReconnect)this.emit("serverAuthenticationStateChange",k.f.NotAuthenticated);else{if(!s.anonymousToken||!s.tokenExpirationSeconds)return this.emit("serverAuthenticationStateChange",k.f.NotAuthenticated),void i.tG.error(508843778,i.nh.CoreDefault,"AL Anonymous token was not generated for the session");this.anonymousToken=s.anonymousToken,this.onSuccessfulSessionInitOnServerSide(s)}}))}onSuccessfulSessionInitOnServerSide(e){var t,s;this.tokenRefreshManager.scheduleRefresh(xt.Anonymous,e.tokenExpirationSeconds,this.initSession.bind(this,{isTokenRefresh:!0}),(()=>{this.anonymousToken=void 0})),this.connectParams={isSeedingRequired:this.sessionKey!==e.sessionKey,sessionUrl:`${e.sessionUrlBase}/${e.sessionKey}`,origin:e.origin,authToken:this.anonymousToken},(null===(t=this.options)||void 0===t?void 0:t.dontSendTokenOnReconnectChangeGate)&&e.existingTokenProvisionResponse&&(null===(s=e.existingTokenProvisionResponse)||void 0===s?void 0:s.tokenType)===J.OY.AugLoopLowPrivilege||(this.options.sendTokenFailureMessageChangeGate?this.initHostAuthTokenNew().catch((()=>{})):this.initHostAuthToken());const o=!!this.sessionKey;this.sessionKey=e.sessionKey,this.origin=e.origin,this.emit("connect",this.connectParams.isSeedingRequired,o,this.connectParams.sessionUrl,this.connectParams.origin,this.connectParams.authToken,e.workflowInputTypes,e.downstreamRuntimeWorkflows,e.routingSessionKey,e.blobFileId),o&&this.emit("reconnect")}getAuthToken(){const e={Tickets:[],DocSessionId:this.clientMetadata.docSessionId,TokenType:he.OY.Augloop,ConnectParams:this.connectParams};return this.options.requestAuthToken(e).then((e=>e)).catch((()=>{}))}getAuthTokenNew(){const e={Tickets:[],DocSessionId:this.clientMetadata.docSessionId,TokenType:he.OY.Augloop,ConnectParams:this.connectParams};return this.options.requestAuthToken(e).then((e=>e))}getAuthTokenTimeoutPromise(){const e=this.options.authTokenTimeoutMs;return new Promise(((t,s)=>{setTimeout((()=>{s(new Error(`Host auth token provision took longer than ${e} ms`))}),e)}))}initHostAuthToken(){const e=this.getAuthToken.bind(this);if(this.options.requestAuthToken&&e){const t=new n.I({operationName:"RefreshAuthToken",success:!0}).setClientMetadata(this.clientMetadata).start();e().then((e=>{if(e){if(!e.Token)return e.TokenError==he.Pu.TokenMissingInteractionRequired?(this.emit("serverAuthenticationStateChange",k.f.TokenMissingInteractionRequired),t.resultDescription="Host auth token provision failed interaction required"):(this.emit("serverAuthenticationStateChange",k.f.NotAuthenticated),t.resultDescription="Host auth token provision failed"),t.success=!1,void i.tG.info(508843777,i.nh.CoreDefault,t.stop());i.tG.info(508843776,i.nh.CoreDefault,t.stop()),this.sendTokenProvisionMessage(e.Token)}else t.resultDescription="TokenResponse is not set"})).catch((e=>{this.emit("serverAuthenticationStateChange",k.f.NotAuthenticated),t.success=!1,t.resultDescription=`Error happened while attempting to fetch host token: ${e}`,i.tG.error(508843747,i.nh.CoreDefault,t.stop())}))}}initHostAuthTokenNew(){return Gt(this,void 0,void 0,(function*(){const e=this.getAuthTokenNew.bind(this);if(this.options.requestAuthToken&&e){const t=new n.I({operationName:"RefreshAuthToken",success:!0}).setClientMetadata(this.clientMetadata).start();let s,o,a=k.f.NotAuthenticated;try{if(s=this.options.authTokenTimeoutMs>0?yield Promise.race([e(),this.getAuthTokenTimeoutPromise()]):yield e(),!s)throw new Error("TokenResponse is not set");if(!s.Token)throw s.TokenError==he.Pu.TokenMissingInteractionRequired?(a=k.f.TokenMissingInteractionRequired,new Error("Host auth token provision failed interaction required")):new Error("Host auth token provision failed")}catch(e){o=e.message,this.emit("serverAuthenticationStateChange",a),t.success=!1,t.resultDescription=`Error happened while attempting to fetch host token: ${e}`}try{o?this.sendMessage(new M.D0({reason:o,version:Wt.initialTokenVersion,clientHandlesResponse:!0})):this.sendTokenProvisionMessage(s.Token)}catch(e){o||(o=e.message,this.emit("serverAuthenticationStateChange",a),t.success=!1,t.resultDescription=`Error happened while attempting to send host token: ${e}`)}finally{o?i.tG.error(506074845,i.nh.CoreDefault,t.stop()):i.tG.info(506074846,i.nh.CoreDefault,t.stop())}}}))}sendTokenProvisionMessage(e){const t=new M.kd({authToken:e,version:Wt.initialTokenVersion});this.emit("serverAuthenticationStateChange",k.f.Pending),this.sendMessage(t,this.onTokenProvisionResponse.bind(this),!0)}onTokenProvisionResponse(e,t){!e&&t&&t.tokenExpirationSeconds?(this.emit("serverAuthenticationStateChange",k.f.Authenticated),this.tokenRefreshManager.scheduleRefresh(xt.Host,t.tokenExpirationSeconds,this.initHostAuthToken.bind(this))):this.emit("serverAuthenticationStateChange",k.f.NotAuthenticated)}}Wt.initialTokenVersion=1;var Ht=s(399115),Ut=s(72715);const qt="object"==typeof Ut&&"object"==typeof Ut.versions&&void 0!==Ut.versions.node,Vt=1e5;class $t{constructor(e,t){this.networkOverrideOptions=e,this.settings=t,this.hadEgressError=!1,this.isClosing=!1,this.pendingEgress=[]}get egressByteCountOp(){return this._egressByteCountOp||(this._egressByteCountOp=new n.I({operationName:"WSEgressByteOrderOfMagnitude",success:!0}),this._egressByteCountOp.setClientMetadata(this.clientMetadata,!0)),this._egressByteCountOp}init(e,t,s,o,a){var r,c;if(this.clientMetadata=a,qt&&this.networkOverrideOptions){const t={servername:null===(r=this.networkOverrideOptions)||void 0===r?void 0:r.hostHeader,headers:(null===(c=this.networkOverrideOptions)||void 0===c?void 0:c.hostHeader)?{host:this.networkOverrideOptions.hostHeader}:void 0};this.ws=new Ht.A(e,t)}else this.ws=new Ht.A(e);this.logOp=new n.I({operationName:$t.className,success:!0}).start(),this.logOp.setClientMetadata(a,!0),this.ingressByteCountOp=new n.I({operationName:"WSIngressByteOrderOfMagnitude",success:!0}),this.ingressByteCountOp.setClientMetadata(a,!0),this.ws.addEventListener("open",(e=>{s(),this.logOp.resourceId="OnOpen",this.logOp.resultDescription="",this.logOp.success=!0,this.logOp.dimension0=this.pendingEgress.length.toString(),i.tG.info(508843801,i.nh.CoreDefault,this.logOp.stop())})),this.ws.addEventListener("message",(e=>{this.logIngressCount(e.data),t(e.data)})),this.ws.addEventListener("error",(e=>{this.errorMessage=e.message,this.logOp.resourceId="OnError",this.logOp.resultDescription=this.errorMessage,this.logOp.success=!1,i.tG.info(508843800,i.nh.CoreDefault,this.logOp.stop()),this.ws?this.ws.close():this.logWsUndefinedError("error event handler")})),this.ws.addEventListener("close",(e=>{this.logOp.resourceId="OnClose",this.logOp.resultDescription=e?`code: ${e.code}. reason: ${e.reason}`:"",this.logOp.success=!0,i.tG.info(508843799,i.nh.CoreDefault,this.logOp.stop()),o(this.errorMessage),this.isClosing=!1}))}egress(e){var t;const s=e.obj;(null===(t=this.settings)||void 0===t?void 0:t.webSocketWorkerShouldLogEgressCount)&&this.logEgressCount(s),this.ws.send(s,(e=>{e&&!this.hadEgressError&&(this.hadEgressError=!0,this.logOp.resourceId="OnEgressError",this.logOp.resultDescription=e.message,this.logOp.success=!1,i.tG.info(508843797,i.nh.CoreDefault,this.logOp.stop()))}))}close(){this.isClosing||(this.isClosing=!0,this.ws?this.ws.close():this.logWsUndefinedError("close"))}logIngressCount(e){const t=e.length;t>Vt&&(this.ingressByteCountOp.start(),this.ingressByteCountOp.dimension2=t.toString().length.toString(),i.tG.info(508843794,i.nh.CoreDefault,this.ingressByteCountOp.stop()))}logEgressCount(e){const t="string"==typeof e?e.length:e.byteLength;t>Vt&&(this.egressByteCountOp.start(),this.egressByteCountOp.dimension2=t.toString().length.toString(),i.tG.info(505710625,i.nh.CoreDefault,this.egressByteCountOp.stop()))}logWsUndefinedError(e){const t=new n.I({operationName:$t.className,success:!1}).start();t.setClientMetadata(this.clientMetadata,!0),t.resourceId="webSocketUndefined",t.resultDescription=e+": this.ws null or undefined",i.tG.info(506566722,i.nh.CoreDefault,t.stop())}}$t.className="WebSocketWorker";var jt=function(e,t,s,o){return new(s||(s=Promise))((function(n,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function r(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((o=o.apply(e,t||[])).next())}))};const zt="CloseSessionsOnRuntimeUninit",Kt="ShouldAppendClientFeatureFlights",Qt="DontSendNewTokenOnReconnect",Jt="WebSocketWorkerShouldLogEgressCount",Yt="FixIncorrectInvocationOfClaimsCallbacks",Zt="LogExpiredTimeoutTasksInBatchManager",Xt=()=>s(580772).r;class es{constructor(e,t,s,o){this.sessionsByDocSessionId=new Map,this.isDeltaGeneratorEnabled=!1,this.disableSyncDeltaSending=!1,this.hasBeenInitialized=!1,this.telemetryLogger=null,this.changeGateList=new Map([["SkipCheckingCachedClaimsChallenge",!0],[zt,!0],[Kt,!0],[Qt,!0],[Jt,!0],[Yt,!0],[Zt,!0]]),this.settings={annotationsOrderingEnabled:!0,deltaOperationsEnabled:!1,defaultBatchingEnabled:!0,batchingWith20msIntervalEnabled:!0,onAnnotationsSubmittedEnabled:!1,reduceBatchOperationsEnabled:!1,batchMessagesEnabled:!1,removeDuplicateFlights:!0,annotationDoesNotExistOnService:!0,reducedPingPongRetryEnabled:!1,maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled:!1,sendTokenFailureMessage:!0,closeSessionsOnRuntimeUninit:!1,shouldAppendClientFeatureFlights:!0,authTokenTimeoutMs:0,doNotSendNewTokenOnReconnect:!1,webSocketWorkerShouldLogEgressCount:!0,createBlobStorageContainerEnabled:!1,createCopyOfClientMetadataInSessionInit:!0,doNotAddCustomLogger:!1},this.settingToChangeGateName={closeSessionsOnRuntimeUninit:zt,shouldAppendClientFeatureFlights:Kt,doNotSendNewTokenOnReconnect:Qt,webSocketWorkerShouldLogEgressCount:Jt},this.isDownloaderCompatible=()=>"undefined"!=typeof Array&&void 0!==Array.from&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL,o&&(this.settings=o),this.workerFactory=e||(e=>e&&e===a.HttpFallback?new lt:new $t(void 0,this.settings));const n=this.createDefaultSessionManagerFactory();this.sessionManagerFactory=(...e)=>(null==t?void 0:t(...e))||n(...e),this.sessionFactory=s||(e=>new je(e))}init(e,t,s,r){var c,u,p,g,h,d,m,y,f,C;const S=new n.I({operationName:"InitRuntime",resourceId:(0,Pt.k$)(e),dimension1:this.hasBeenInitialized.toString()});S.start(),this.hasBeenInitialized=!0,this.hostCallbacks=s,this.gateUtils=new _(this.hostCallbacks,this.changeGateList),this.clientMetadata=t,this.clientMetadata&&(this.clientMetadata.runtimeVersion=Xt()),this.telemetryLogger=new Pt.MP(this.hostCallbacks),this.settings.doNotAddCustomLogger=this.settings.doNotAddCustomLogger||!!r.doNotAddCustomLogger,this.settings.doNotAddCustomLogger||(this.shouldAddLogger(S)?(i.tG.addLogger(this.telemetryLogger),this.addLoggingAggregator(r)):(i.tG.clearLoggers(),i.tG.addLogger(this.telemetryLogger))),es.haveCalledInit=!0,this.annotationResultsProcessor=new T((()=>this.settings.annotationsOrderingEnabled)),this.inferenceServiceFactory=r.inferenceServiceFactory,S.dimension2=(0,i.OD)(o.q.info).toString();const A=[];e&&(this.defaultServiceUrl=Ge.Aq.convertServiceUrlToWebSocket(e),this.serviceProtocol=this.defaultServiceUrl.split(":")[0].toLowerCase()),A.push(this.gateUtils.init().then((()=>jt(this,void 0,void 0,(function*(){yield Promise.all(Object.keys(this.settingToChangeGateName).map((e=>jt(this,void 0,void 0,(function*(){try{const t=yield this.gateUtils.isChangeGateEnabled(this.settingToChangeGateName[e]);this.settings[e]=t}catch(t){this.settings[e]=!1}})))))}))))),A.push(this.isFeatureEnabled("AnnotationsOrderingEnabled",!0).then((e=>{this.settings.annotationsOrderingEnabled=e}))),A.push(this.isFeatureEnabled("DefaultBatchingDisabled").then((e=>{var t;(t=this.settings).defaultBatchingEnabled&&(t.defaultBatchingEnabled=!e)}))),A.push(this.isFeatureEnabled("BatchingWith20msIntervalDisabled").then((e=>{var t;(t=this.settings).batchingWith20msIntervalEnabled&&(t.batchingWith20msIntervalEnabled=!e)}))),A.push(this.isFeatureEnabled("OnAnnotationsSubmittedDisabled").then((e=>{var t;(t=this.settings).onAnnotationsSubmittedEnabled&&(t.onAnnotationsSubmittedEnabled=!e)}))),A.push(this.isFeatureEnabled("ReduceBatchOperationsEnabled").then((e=>{var t;(t=this.settings).reduceBatchOperationsEnabled||(t.reduceBatchOperationsEnabled=e)}))),A.push(this.isFeatureEnabled("BatchMessagesEnabled").then((e=>{var t;(t=this.settings).batchMessagesEnabled||(t.batchMessagesEnabled=e)}))),A.push(Ge.Aq.isChangeGateEnabled(this.hostCallbacks,"AnnotationDoesNotExistOnService").then((e=>{this.settings.annotationDoesNotExistOnService=e}))),A.push(Ge.Aq.isFeatureEnabled(this.hostCallbacks,"ReducedPingPongRetryEnabled").then((e=>{var t;(t=this.settings).reducedPingPongRetryEnabled||(t.reducedPingPongRetryEnabled=e)}))),A.push(this.isFeatureEnabled("MaxNumberOfDeltaUpdateOpsPerItemPerBatch").then((e=>{var t;(t=this.settings).maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled||(t.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled=e)}))),A.push(Ge.Aq.isChangeGateEnabled(this.hostCallbacks,"SendTokenFailureMessage").then((e=>{this.settings.sendTokenFailureMessage=e}))),A.push(this.isFeatureEnabled("CreateBlobStorageContainerEnabled").then((e=>{var t;(t=this.settings).createBlobStorageContainerEnabled||(t.createBlobStorageContainerEnabled=e)}))),A.push(Ge.Aq.isChangeGateEnabled(this.hostCallbacks,"CreateCopyOfClientMetadataInSessionInit").then((e=>{var t;(t=this.settings).createCopyOfClientMetadataInSessionInit||(t.createCopyOfClientMetadataInSessionInit=e)})));const v={enableDeltas:!1,enableEarlyJoin:!1};A.push(Promise.all([this.isFeatureEnabled("DeltaOperationsEnabled").then((e=>v.enableDeltas=e)).catch((()=>v.enableDeltas=!1)),this.isFeatureEnabled("EarlyJoinCompletionEnabled").then((e=>v.enableEarlyJoin=e)).catch((()=>v.enableEarlyJoin=!1))]).then((()=>{this.localWorkflowManager=new it(r.modelDownloader&&this.isDownloaderCompatible()?r.modelDownloader:void 0,this.inferenceServiceFactory,v)})));const N=l(null!==(c=t.flights)&&void 0!==c?c:"");return this.isDeltaGeneratorEnabled=N.getBooleanValue("Microsoft.Office.WordOnline.AugloopDeltas",null!==(u=r.isDeltaGeneratorEnabled)&&void 0!==u&&u),this.disableSyncDeltaSending=N.getBooleanValue("Microsoft.Office.WordOnline.DisableSyncDeltaSending",null!==(p=r.disableSyncDeltaSending)&&void 0!==p&&p),this.syncDeltaTimeout=N.getIntValue("Microsoft.Office.WordOnline.SyncDeltaTimeout",r.syncDeltaTimeout),(g=this.settings).defaultBatchingEnabled&&(g.defaultBatchingEnabled=!N.getBooleanValue("DefaultBatchingDisabled",!1)),(h=this.settings).batchingWith20msIntervalEnabled&&(h.batchingWith20msIntervalEnabled=!N.getBooleanValue("BatchingWith20msIntervalDisabled",!1)),(d=this.settings).reduceBatchOperationsEnabled||(d.reduceBatchOperationsEnabled=N.getBooleanValue("ReduceBatchOperationsEnabled",!1)),(m=this.settings).batchMessagesEnabled||(m.batchMessagesEnabled=N.getBooleanValue("BatchMessagesEnabled",!1)),(y=this.settings).removeDuplicateFlights&&(y.removeDuplicateFlights=N.getBooleanValue("RemoveDuplicateFlights",!0)),(f=this.settings).reducedPingPongRetryEnabled||(f.reducedPingPongRetryEnabled=N.getBooleanValue("ReducedPingPongRetryEnabled",!1)),(C=this.settings).maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled||(C.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled=N.getBooleanValue("maxNumberOfDeltaUpdateOpsPerItemPerBatch",!1)),this.settings.authTokenTimeoutMs=N.getIntValue("AuthTokenTimeoutMs",0),S.setDataField("Flights",JSON.stringify(this.settings)),r&&r.loggableUrls&&(0,Pt.sI)(r.loggableUrls),Promise.all(A).then((()=>{this.batchOptions=r.batchOptions,!this.batchOptions&&this.settings.defaultBatchingEnabled&&(this.batchOptions={delayMs:1,maxInputSize:1e6,delayMsMax:50},this.settings.batchingWith20msIntervalEnabled&&(this.batchOptions.delayMs=20)),this.batchOptions&&!this.batchOptions.delayMsMax&&(this.batchOptions.delayMsMax=50),r&&r.networkMode&&(this.networkMode=r.networkMode,r.networkMode===a.LocalWorkflowsOnly&&(this.sessionManagerFactory=()=>new xe)),S.dimension0=JSON.stringify(this.batchOptions),this.logOperation(S,!0)})).catch((e=>{this.logOperation(S,!1,"Error",e?e.message:"(no error)")}))}getServiceProtocol(){return this.serviceProtocol}registerLocalWorkflow(e){this.localWorkflowManager.registerLocalWorkflow(e)}flushTelemetry(e){i.tG.flushAggregators(e)}createSession(e){var t;const s=e&&e.docSessionId?e.docSessionId:(0,c.v4)(),o=e&&e.documentId?e.documentId:void 0,i=this.sessionsByDocSessionId.get(s),r=new n.I({operationName:"CreateSession",resourceId:s,dimension1:this.hasBeenInitialized.toString()});if(r.start(),i&&!1===i.isClosed)throw this.logOperation(r,!1,"Error","docSessionId already exists"),new Error("docSessionId already exists");let l=e&&null!==(t=e.serviceUrl)&&void 0!==t?t:this.defaultServiceUrl;l=Ge.Aq.convertServiceUrlToWebSocket(l),l||((e=e||{}).networkMode=a.LocalWorkflowsOnly),!this.networkMode||void 0!==(null==e?void 0:e.networkMode)&&null!==(null==e?void 0:e.networkMode)||((e=e||{}).networkMode=this.networkMode),void 0!==(null==e?void 0:e.networkMode)&&null!==(null==e?void 0:e.networkMode)&&(null==e?void 0:e.networkMode)!==a.JSWebSockets||!this.hasHttpFallbackSession()||((e=e||{}).networkMode=a.HttpFallback);const p=Object.assign({},this.clientMetadata);if(p.docSessionId=s,o&&(p.documentId=o),e&&e.tid3pHost&&(p.tid3pHost=e.tid3pHost),e&&e.flights&&(p.flights=p.flights?p.flights+";"+e.flights:e.flights),this.settings.shouldAppendClientFeatureFlights){const e=["_acceptsClaimsChallengeMessages","_acceptsSeedingStatusChangeMessages"].join(";");p.flights=p.flights?`${p.flights};${e}`:e}this.settings.removeDuplicateFlights&&p.flights&&(p.flights=function(e){if(!e)return"";const t=new Set,s=[];for(const o of e.split(";").reverse()){const e=o.split(":")[0],n=u.normalizeName(e);t.has(n)||(t.add(n),s.push(o))}return s.reverse().join(";")}(p.flights)),r.setDataField("Flights",p.flights||"");const g=this.sessionFactory({hostCallbacks:this.hostCallbacks,sessionManager:this.sessionManagerFactory(p,l,e),batchOptions:this.batchOptions,extensionConfigs:(null==e?void 0:e.extensionConfigs)||[],clientMetadata:p,userContext:e?e.userContext:void 0,localWorkflowManager:this.localWorkflowManager,annotationResultsProcessor:this.annotationResultsProcessor,localRegisteredWorkflows:(null==e?void 0:e.localRegisteredWorkflows)||[],enableRemoteExecutionNotification:(null==e?void 0:e.enableRemoteExecutionNotification)||!1,networkMode:null==e?void 0:e.networkMode,egress:e?e.egress:void 0,isDeltaGeneratorEnabled:this.isDeltaGeneratorEnabled,onAnnotationsSubmittedEnabled:this.settings.onAnnotationsSubmittedEnabled,disableSyncDeltaSending:this.disableSyncDeltaSending,syncDeltaTimeout:this.syncDeltaTimeout,reduceBatchOperationsEnabled:this.settings.reduceBatchOperationsEnabled,batchMessagesEnabled:this.settings.batchMessagesEnabled,annotationDoesNotExistOnServiceEnabled:this.settings.annotationDoesNotExistOnService,maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled:this.settings.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled,gateUtils:this.gateUtils});return this.sessionsByDocSessionId.set(s,g),e&&(e.onSessionConnect&&g.setConnectCallback(e.onSessionConnect),e.onSessionDisconnect&&g.setDisconnectCallback(e.onSessionDisconnect),e.onSessionReconnect&&g.setReconnectCallback(e.onSessionReconnect),e.onSessionClose&&g.setSessionCloseCallback(e.onSessionClose),e.onServerAuthenticationStateChangeCallback&&g.setServerAuthenticationStateChangeCallback(e.onServerAuthenticationStateChangeCallback),e.onClaimsChallengeCallback&&g.setClaimsChallengeCallback(e.onClaimsChallengeCallback),e.onSeedingStatusChangeCallback&&g.setSeedingStatusChangeCallback(e.onSeedingStatusChangeCallback)),this.logOperation(r,!0),g.initialize?g.initialize():Promise.resolve(g)}getSession(e){return this.sessionsByDocSessionId.get(e)}getSessionManagerFactory(){return this.sessionManagerFactory}shouldAddLogger(e){if(es.haveCalledInit){const t=new Error("Runtime already initialized");return e.dimension3=t.stack,e.dimension2=(0,i.OD)(o.q.info).toString(),this.logOperation(e,!1,"Error",t.message),!1}return!0}createDefaultSessionManagerFactory(){return(e,t,s)=>{if(s&&s.networkMode==a.LocalWorkflowsOnly)return new xe;const o=new Ft,n=new ut;let r=()=>{i.tG.error(573321615,i.nh.CoreDefault,"Unexpectedly not set sendMessage")};const c=new Wt((()=>n),e,o,((e,t,s)=>{r(e,t,s)}),{requestAuthToken:this.hostCallbacks.requestAuthToken,overrideSessionInitMessage:this.hostCallbacks.overrideSessionInitMessage,enableRemoteExecutionNotification:(null==s?void 0:s.enableRemoteExecutionNotification)||!1,sendTokenFailureMessageChangeGate:this.settings.sendTokenFailureMessage,authTokenTimeoutMs:this.settings.authTokenTimeoutMs,dontSendTokenOnReconnectChangeGate:this.settings.doNotSendNewTokenOnReconnect,createBlobStorageContainerEnabled:this.settings.createBlobStorageContainerEnabled,createCopyOfClientMetadataInSessionInit:this.settings.createCopyOfClientMetadataInSessionInit}),l=new Ot(Ge.Aq.convertServiceUrlToWebSocket(t),n,this.workerFactory,c,e,o,this.settings,this.gateUtils,null==s?void 0:s.networkMode);return r=l.sendMessage.bind(l),l.on("disconnect",(()=>o.clearRefreshTimeouts())),l.on("connect",((e,t,s,o)=>{e&&this.hostCallbacks.setSessionData&&this.hostCallbacks.setSessionData(t,s,o);const n=t.substring(t.lastIndexOf("/")+1);this.telemetryLogger.setServerSessionKey(n)})),l}}isFeatureEnabled(e,t=!1,s="None"){return Ge.Aq.isFeatureEnabled(this.hostCallbacks,e,t,s)}hasHttpFallbackSession(){let e=!1;return this.sessionsByDocSessionId.forEach((t=>{t.isHttpFallback()&&(e=!0)})),e}logOperation(e,t,s,o){e.stop(),e.success=t,e.resultSignature=s,e.resultDescription=o,i.tG.info(573321622,i.nh.CoreDefault,e)}addLoggingAggregator(e){var t,s,o,n;"Dogfood"!==this.clientMetadata.releaseAudienceGroup&&"Automation"!==this.clientMetadata.releaseAudienceGroup&&(i.tG.addAggregator((0,Pt.cS)("Operation","operationName",["ExecuteBatch","ReduceBatchOperations","ProcessResponse","LocalDeltaUpdate","ApplyFormattedTextTileDeltaForLocalWorkflows","ApplyTextTileDeltaForLocalWorkflows","FindRangeForDelta","RunModelForInferencing","GetResource","CreateTextTileDeltaFromItem","NetworkEgressControl","HttpEgress","LongPollNoOp","NetworkRateControllerAbandonedSyncMessage","NetworkRateControllerEgress","NetworkRateControllerQueueItem","NetworkRateControllerOnRateLimitResponse","NetworkRateControllerOnRateLimitError","NetworkRateControllerRateLimitsSet"],null!==(t=e.telemetryAggregationIntervalSec)&&void 0!==t?t:30)),i.tG.addAggregator((0,Pt.cS)("Operation","operationName",["ExecuteWorkflow","ExecuteLambda","EarlyJoinCompletion","OnLongPollMessage","OnAnnotationResultsEgress"],null!==(s=e.telemetryAggregationIntervalSec)&&void 0!==s?s:60)),i.tG.addAggregator((0,Pt.cS)("Operation","operationName",["LocalScopeExecutionNotification","RunLocalWorkflows","EarlyJoinCompletion","SetAnnotations","WIS.addItemOnContextIdList","WIS.setScopeItem"],null!==(o=e.telemetryAggregationIntervalSec)&&void 0!==o?o:120)),i.tG.addAggregator((0,Pt.cS)("SessionHealth","sessionHealthEventName",["SendMessage","ProcessMessage"],null!==(n=e.telemetryAggregationIntervalSec)&&void 0!==n?n:60)))}uninitialize(){this.settings.closeSessionsOnRuntimeUninit&&(this.sessionsByDocSessionId.forEach((e=>{e.close()})),this.sessionsByDocSessionId.clear()),this.flushTelemetry(!0),this.hostCallbacks=null,this.hasBeenInitialized=!1,this.telemetryLogger=null,es.haveCalledInit=!1,this.settings.doNotAddCustomLogger||(i.tG.clearAggregators(),i.tG.clearLoggers())}}const ts=new es,ss=()=>new es},217160:(e,t,s)=>{var o;s.d(t,{lC:()=>o}),function(e){e[e.Success=0]="Success",e[e.OffensiveContentInput=1]="OffensiveContentInput",e[e.OffensiveContentOutput=2]="OffensiveContentOutput",e[e.EmptyResponse=3]="EmptyResponse",e[e.ErrorInExecution=4]="ErrorInExecution",e[e.ResourcesNotAvailable=5]="ResourcesNotAvailable",e[e.RaiUnsupportedLanguageInContentInput=6]="RaiUnsupportedLanguageInContentInput",e[e.RaiUnsupportedLanguageInContentOutput=7]="RaiUnsupportedLanguageInContentOutput",e[e.InputBlockedByDynamicGuardList=8]="InputBlockedByDynamicGuardList",e[e.OutputBlockedByDynamicGuardList=9]="OutputBlockedByDynamicGuardList",e[e.InputAttackDetected=10]="InputAttackDetected",e[e.OutputAttackDetected=11]="OutputAttackDetected",e[e.EnumValueNotInUse=12]="EnumValueNotInUse",e[e.PartialResult=13]="PartialResult",e[e.ModelContentFilter=14]="ModelContentFilter",e[e.Unknown=15]="Unknown",e[e.Overloaded=16]="Overloaded",e[e.Timeout=17]="Timeout",e[e.TooLargeRequest=18]="TooLargeRequest",e[e.BadRequest=19]="BadRequest",e[e.InternalServerError=20]="InternalServerError",e[e.UserNotAuthenticated=21]="UserNotAuthenticated",e[e.UserNotAuthorized=22]="UserNotAuthorized",e[e.UserThrottled=23]="UserThrottled",e[e.ScenarioThrottled=24]="ScenarioThrottled",e[e.InvalidFormatting=25]="InvalidFormatting",e[e.WorkflowQuotaLimitExceeded=26]="WorkflowQuotaLimitExceeded",e[e.UnsupportedRequirement=27]="UnsupportedRequirement",e[e.UrlPresentInInput=28]="UrlPresentInInput",e[e.DocumentUrlChangeDetected=29]="DocumentUrlChangeDetected",e[e.ExpectedError=30]="ExpectedError",e[e.BlockedByUserPrompt=31]="BlockedByUserPrompt",e[e.PromptDefinedError=32]="PromptDefinedError",e[e.FailedToGetFileContents=33]="FailedToGetFileContents",e[e.OutputBlockedByDynamicBlockList=34]="OutputBlockedByDynamicBlockList",e[e.ProtectedMaterial=35]="ProtectedMaterial",e[e.Skipped=36]="Skipped",e[e.DeferredRaiFailure=37]="DeferredRaiFailure",e[e.OutOfCredits=38]="OutOfCredits",e[e.InputGroundingAttackDetected=39]="InputGroundingAttackDetected",e[e.ToolCalls=40]="ToolCalls",e[e.UnknownSydneyError=41]="UnknownSydneyError",e[e.GenericSydneyError=42]="GenericSydneyError",e[e.HttpStatusCodeSydneyError=43]="HttpStatusCodeSydneyError",e[e.AuthenticationSydneyError=44]="AuthenticationSydneyError",e[e.DisengagedSydneyError=45]="DisengagedSydneyError",e[e.NotEnoughTranscript=46]="NotEnoughTranscript",e[e.NotFoundError=47]="NotFoundError",e[e.DlpPromptBlocked=48]="DlpPromptBlocked"}(o||(o={}));var n,i,a,r,c,l,u,p;!function(e){e.text="text",e.image="image"}(n||(n={})),function(e){e.System="system",e.User="user",e.Assistant="assistant",e.Tool="tool",e.Developer="developer"}(i||(i={})),function(e){e.text="text",e.image_url="image_url",e.input_audio="input_audio",e.file="file",e.refusal="refusal"}(a||(a={})),function(e){e.auto="auto",e.low="low",e.high="high"}(r||(r={})),function(e){e.wav="wav",e.mp3="mp3"}(c||(c={})),function(e){e.Function="function"}(l||(l={})),function(e){e.NotStarted="NotStarted",e.Running="Running",e.Succeeded="Succeeded",e.Failed="Failed"}(u||(u={})),function(e){e.Preprocessing="preprocessing",e.Queued="queued",e.Processing="processing",e.Running="running",e.Cancelled="cancelled",e.Succeeded="succeeded",e.Failed="failed",e.Unknown="unknown"}(p||(p={}))},222709:(e,t,s)=>{s.d(t,{YH:()=>n});var o=s(596498);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Core_Annotation"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Core_BinaryClassificationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Core_StreamAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_ExecutionCorrelatedAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Core_ClaimsChallengeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()}},225014:(e,t,s)=>{s.d(t,{wB:()=>B,QH:()=>D});var o=s(313189),n=s(172141),i=s(177556),a=s(262449),r=s(69614),c=s(721646),l=s(292627),u=s(596498),p=s(336831),g=s(182755);class h{constructor(){this.messageCallbackRegistrationReady=void 0}sendMessage(e){if("undefined"==typeof OfficeFirstParty)throw new Error("OfficeFirstParty global not available in SDX running AL");if(!this.messageCallbackRegistrationReady)throw new Error("MessageReceivedCallback not registered");this.messageCallbackRegistrationReady.then((()=>{OfficeFirstParty.AugLoop.SendMessage(e)})).catch((e=>{throw e}))}registerMessageReceivedCallback(e){if("undefined"==typeof OfficeFirstParty)throw new Error("OfficeFirstParty global not available in SDX running AL");if(this.messageCallbackRegistrationReady)throw new Error("MessageReceivedCallback already registered");this.messageCallbackRegistrationReady=OfficeFirstParty.AugLoop.onHostMessageReceived((t=>e(t)))}}class d{sendTelemetryEvent(e){if("undefined"==typeof Office)throw new Error("Office global not available in SDX running AL");Office.sendTelemetryEvent(e)}}class m{constructor(){this.telemetryLogger=new g.M,this.telemetryLogger.addSink(new d)}convertTelemetryEvent(e,t,s,o,n,i,a){const r={telemetryProperties:{ariaTenantToken:e,nexusTenantToken:-1},eventName:t.split("_").join("."),dataFields:this.convertDataFields(s),eventFlags:{dataCategories:6,diagnosticLevel:110,samplingPolicy:1}};return o&&(r.eventContract={name:o,dataFields:this.convertDataFields(n,o.split(".").slice(-1)[0])}),r}convertDataFields(e,t){const s=[];for(const o of Object.keys(e)){if(void 0===e[o]||null===e[o])continue;const n={name:t?`${t}.${o}`:o,dataType:this.getDataFieldType(e[o]),value:e[o],classification:4};s.push(n)}return s}getDataFieldType(e){return"string"==typeof e?0:"boolean"==typeof e?1:"number"==typeof e?2:void 0}sendTelemetryEvent(e,t,s,o,n,i,a,r){this.telemetryLogger.sendTelemetryEvent(this.convertTelemetryEvent(e,t,s,o,n,a,r))}sendDiagnosticTrace(e,t,s){}addCustomSync(e){this.telemetryLogger.addSink(e)}}var y=s(679853),T=s(599243),f=s(937410),_=s(758488),C=s(93440),S=s.n(C);class A{constructor(e){this.queue=void 0,this.options={},this.maxSize=void 0,this.options=e,this.maxSize=this.options&&this.options.maxSize?this.options.maxSize:void 0,this.queue=new(S())}push(e){this.queue.push(e),this.maxSize&&this.queue.length>this.maxSize&&this.queue.shift()(new Error("TaskQueue Max size reached."))}processAll(){for(;this.queue.length>0;)this.queue.shift()(void 0)}}var v=s(622908),N=function(e,t,s,o){return new(s||(s=Promise))((function(n,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function r(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((o=o.apply(e,t||[])).next())}))},E=function(e){return this instanceof E?(this.v=e,this):new E(e)},I=function(e,t,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,n=s.apply(e,t||[]),i=[];return o={},a("next"),a("throw"),a("return"),o[Symbol.asyncIterator]=function(){return this},o;function a(e){n[e]&&(o[e]=function(t){return new Promise((function(s,o){i.push([e,t,s,o])>1||r(e,t)}))})}function r(e,t){try{(s=n[e](t)).value instanceof E?Promise.resolve(s.value.v).then(c,l):u(i[0][2],s)}catch(e){u(i[0][3],e)}var s}function c(e){r("next",e)}function l(e){r("throw",e)}function u(e,t){e(t),i.shift(),i.length&&r(i[0][0],i[0][1])}};const w="cst-";let b=(0,y.v4)(),k=!1,M=null;const L=e=>{k||(M=new o.MP(e),T.tG.addLogger(M),k=!0)},B=(e,t)=>{L(new m);const s=R("GetAugLoopSession",!0,e),o=new F(e,new h,t);return o.initialize().catch((()=>{})),T.tG.info(505442513,T.nh.CoreDefault,s.stop()),o},D=(e,t)=>{L(new m);const s=R("GetHostBridgeSession",!0,e),o=new F(e,new h,t);return T.tG.info(505442512,T.nh.CoreDefault,s.stop()),o.initialize()};let P=!1;const R=(e,t,s)=>{const o=new f.I({operationName:e,ariaNamespace:"Office_AugLoop_Client_SDX",clientDocSessionId:s,dimension0:b}).start();return o.success=t,o},O=(e,t)=>{t?(e.resultDescription=t,e.success=!1,T.tG.error(505201632,T.nh.CoreDefault,e.stop())):T.tG.info(505201631,T.nh.CoreDefault,e.stop())};class x extends Error{constructor(e){super(e),Object.setPrototypeOf(this,x.prototype)}}class F{constructor(e,t,s){this.sessionOptions=void 0,this.docSessionId="",this.messageBridge=void 0,this.activationsMapTypeToTokens=new Map,this.activationsMapTokenToCallback=new Map,this.activationsMapTokenToApologyCallback=new Map,this.waitingForResponse=new Map,this.messageId=0,this.customMessageSeq=0,this.activationToken=0,this.connectParams=void 0,this.seedGroupSize=0,this.connectionPendingTaskQueue=new A({maxSize:1e4}),this.sessionCloseMessages=[],this.sessionCloseCallbacks=new Map,this.sessionConnectCallbacks=new Map,this.sessionReconnectCallbacks=new Map,this.sessionDisconnectCallbacks=new Map,this.sessionCallbackToken=0,this.currentAuthenticationState=a.f.Pending,this.serverAuthenticationStateChangeCallbacks=[],this.claimsChallengeCallbacks=new Map,this.seedingStatusChangeCallbacks=new Map,this.internalSessionNumber=0,this.getAnnotationsResponseQueues=new Map,F.internalSessionCounter++,this.internalSessionNumber=F.internalSessionCounter,this.sessionOptions=s,P||(T.tG.addAggregator((0,o.cS)("Operation","operationName",["SubmitOperations","SubmitCustomMessage","SendLargeBinaryDataMessage","SendBinaryStreamUploadMessage","RequestBinaryData"],30)),T.tG.addAggregator((0,o.cS)("Operation","operationName",["ProcessMessage","EnsureConnection","KeepAlive"],300)),P=!0),this.docSessionId=e,this.messageBridge=t,this.prevMessageInfo={sequenceId:-1},t.registerMessageReceivedCallback((e=>{const t=JSON.parse(e),s=this.createLoggingOperation("ProcessMessage",!0);if(!t)return s.dimension2="ParseFailed",s.success=!1,void T.tG.info(509088289,T.nh.CoreDefault,s.stop());const o=t.message||t.response;if(this.verifyMessageOrder(t,o),!(t.bridgeId!=b&&"*"!=t.bridgeId||t.docSessionId!=this.docSessionId&&"*"!=t.docSessionId)){if(!o)return s.dimension2="NoMessageOrResponse",s.success=!1,void T.tG.info(509088288,T.nh.CoreDefault,s.stop());r.uN.typeGuard(o)?this.handleSessionInitResponse(o):r.B_.typeGuard(o)?this.handleAnnotationResults(o,s):r.w9.typeGuard(o)?this.handleSessionCloseMessage(o):r.gy.typeGuard(o)?this.handleSessionConnectMessage(o):r.lj.typeGuard(o)?this.handleSessionReconnectMessage(o):r.eG.typeGuard(o)?this.handleSessionDisconnectMessage(o):r.wU.typeGuard(o)?this.handleServerAuthenticationStateChange(o):c.Td.typeGuard(o)?this.handleFireClaimsChallengeCallback(o):c.U8.typeGuard(o)?this.handleFireSeedingStatusChangeCallback(o):c.wR.typeGuard(o)?this.handleGetAnnotationsResponse(o,s):r.YK.typeGuard(o)?this.handleResponse(o,s):s.dimension2="UnknownType",s.resourceId=u.h.getTypeNameFor(o),T.tG.info(509088287,T.nh.CoreDefault,s.stop())}}))}initialize(){return N(this,void 0,void 0,(function*(){const e=R("Initialize",!0,this.docSessionId);try{const t=new c.Cs({docSessionId:this.docSessionId,messageId:this.getMessageId()}),s=yield this.sendMessageWithOpAsync("GetHostBridgeSession",t);return this.handleGetHostBridgeSessionResponse(s),T.tG.info(505442511,T.nh.CoreDefault,e.stop()),this}catch(t){if(t instanceof x)return e.dimension2="UnknownMessageTypeError",T.tG.info(505251788,T.nh.CoreDefault,e.stop()),this.handleGetHostBridgeSessionResponse(void 0),this;throw e.success=!1,t instanceof Error?e.resultDescription=t.message:"string"==typeof t&&(e.resultDescription=t),T.tG.error(505442510,T.nh.CoreDefault,e.stop()),t}}))}getCallbackToken(e){return e+"-callback-"+this.internalSessionNumber+"-"+this.sessionCallbackToken++}createLoggingOperation(e,t){return R(e,t,this.docSessionId)}handleFireClaimsChallengeCallback(e){if(!e.messageId||!e.claimsChallengeMessage)return;const t=this.claimsChallengeCallbacks.get(e.messageId);t&&t(e.claimsChallengeMessage)}handleGetHostBridgeSessionResponse(e){e&&(this.isClosed=e.isClosed,this.isConnected=e.isConnected);const t=new r.eE({bridgeId:b,clientMetadata:void 0,protocolVersion:2,messageId:this.getMessageId()});this.sendMessageWithOp("SessionInit",t)}handleSessionInitResponse(e){if(this.connectParams={authToken:e.anonymousToken,origin:e.origin,sessionUrl:`${e.sessionUrlBase}/${e.sessionKey}`,isSeedingRequired:!1,routingSessionKey:e.routingSessionKey,blobFileId:e.blobFileId},M){const e=this.connectParams.sessionUrl.substring(this.connectParams.sessionUrl.lastIndexOf("/")+1);M.setServerSessionKey(e)}this.sessionConnectCallbacks.forEach(((e,t)=>{e(this.connectParams.isSeedingRequired,this.connectParams.sessionUrl,this.connectParams.origin,this.connectParams.authToken,this.connectParams.routingSessionKey,this.connectParams.blobFileId)})),this.connectionPendingTaskQueue.processAll()}handleGetAnnotationsResponse(e,t){var s,o;if(!e.messageId)return t.resultDescription="NoMessageId",void(t.success=!1);const i=JSON.parse(e.serverResponse),a=this.getAnnotationsResponseQueues.get(e.messageId);null==a||a.queue.push({content:i.content,error:{serviceError:i.errorInfo,clientError:e.clientError},warning:{serviceError:i.warningInfo},finalResponse:e.finalResponse}),null===(s=null==a?void 0:a.responseReceived)||void 0===s||s.call(a,!0);const r=(0,n.Kh)(i);t.cv=null==i?void 0:i.cv,t.resultSignature="CallbackInHostBridge",t.setDataFields({FirstUserPerceivedResponse:r,AnnotationType:null===(o=null==i?void 0:i.annotationType)||void 0===o?void 0:o.toString(),FinalResponse:e.finalResponse}),t.success=!0}handleResponse(e,t){const s=e.messageId;return s?this.waitingForResponse.has(s)?(this.waitingForResponse.get(s)(e),this.waitingForResponse.delete(s),void(t.success=!0)):(t.resultDescription="NoResponseCallback",void(t.success=!1)):(t.resultDescription="NoMessageId",void(t.success=!1))}handleAnnotationResults(e,t){const s=Date.now();let o=0;t.resultSignature=e.annotationType;const i=this.activationsMapTypeToTokens.get(e.annotationType);if(t.dimension1=e.ops.length.toString(),i)for(const t of i)for(const s of e.ops){const n=e.areApologies?this.activationsMapTokenToApologyCallback.get(t):this.activationsMapTokenToCallback.get(t);n&&(n.callback(s,e.cv),o++)}t.success=!0,t.dimension2=o.toString(),t.dimension3=`AreApologies: ${e.areApologies}`,o>0&&(0,n.M4)(e,s,"CallbackInHostBridge",!1,this.createLoggingOperation("AugloopClientPerfTracker",!0))}handleSessionCloseMessage(e){this.isClosed=!0,this.sessionCloseMessages.push(e),this.sessionCloseCallbacks.forEach(((t,s)=>{t(e)}))}handleSessionConnectMessage(e){if(this.isConnected=!0,this.connectParams={authToken:e.authToken,origin:e.origin,sessionUrl:e.sessionUrl,isSeedingRequired:e.isSeedingRequired,routingSessionKey:e.routingSessionKey,blobFileId:e.blobFileId},M){const e=this.connectParams.sessionUrl.substring(this.connectParams.sessionUrl.lastIndexOf("/")+1);M.setServerSessionKey(e)}e.isSeedingRequired&&(this.seedGroupSize=0),this.sessionConnectCallbacks.forEach(((t,s)=>{t(e.isSeedingRequired,e.sessionUrl,e.origin,e.authToken,e.routingSessionKey,e.blobFileId)})),this.connectionPendingTaskQueue.processAll()}handleSessionReconnectMessage(e){this.sessionReconnectCallbacks.forEach(((e,t)=>{e()}))}handleSessionDisconnectMessage(e){this.isConnected=!1,this.connectParams=void 0,this.sessionDisconnectCallbacks.forEach(((t,s)=>{t(e.error)}))}handleServerAuthenticationStateChange(e){this.currentAuthenticationState!=e.serverAuthenticationState&&(this.currentAuthenticationState=e.serverAuthenticationState,this.serverAuthenticationStateChangeCallbacks.forEach((t=>{t(e.serverAuthenticationState)})))}handleFireSeedingStatusChangeCallback(e){if(!e.messageId||!e.seedingStatusChangeMessage)return;const t=this.seedingStatusChangeCallbacks.get(e.messageId);t&&t(e.seedingStatusChangeMessage)}getMessageId(){return"cl-"+this.internalSessionNumber+"-"+this.messageId++}getNextCustomMessageSeq(){return this.internalSessionNumber+"-"+this.customMessageSeq++}getNextActivationToken(){return"ac-"+b+"-"+this.internalSessionNumber+"-"+this.activationToken++}getServerAuthenticationState(){throw new Error("Method not implemented.")}registerLocalWorkflow(e){throw new Error("Method not implemented.")}registerLocalWorkflows(e){throw new Error("Method not implemented.")}isLocalWorkflowRegistered(e){throw new Error("Method not implemented.")}activateAnnotation(e,t,s){const o=this.getMessageId(),n=this.getNextActivationToken(),i=this.createLoggingOperation("ActivateAnnotation",!0);i.resourceId=e,i.dimension1=`ApologyCallback: ${void 0!==(null==t?void 0:t.apologyCallback)}`,i.setDataField("StartTimestamp",Date.now());const a=new Promise(((s,a)=>{this.waitingForResponse.set(o,(o=>r.PY.typeGuard(o)?(t&&(this.activationsMapTypeToTokens.has(e)||this.activationsMapTypeToTokens.set(e,new Set),t.callback&&this.activationsMapTokenToCallback.set(o.token,{annotationType:e,callback:t.callback}),t.apologyCallback&&this.activationsMapTokenToApologyCallback.set(o.token,{annotationType:e,callback:t.apologyCallback}),(t.callback||t.apologyCallback)&&this.activationsMapTypeToTokens.get(e).add(o.token)),i.resultDescription=`Activated annotation with token ${o.token}`,T.tG.info(509088286,T.nh.CoreDefault,i.stop()),void s(new r.PY({token:o.token}))):r._p.typeGuard(o)?(this.activationsMapTypeToTokens.get(e).delete(n),this.activationsMapTokenToCallback.delete(n),this.activationsMapTokenToApologyCallback.delete(n),i.success=!1,i.resultDescription=o.error,T.tG.error(509088285,T.nh.CoreDefault,i.stop()),void a(new Error(o.error))):(i.success=!1,i.resultDescription="Unknown Response",T.tG.error(509088284,T.nh.CoreDefault,i.stop()),void a(new Error("Unknown Response")))))})),c=new r.n4({annotationType:e,token:n,config:t?t.config:void 0,bridgeId:b,messageId:o,forceReturnCachedAnnotations:t?t.forceReturnCachedAnnotations:void 0,sendApologies:void 0!==(null==t?void 0:t.apologyCallback)});return this.sendMessage(c,{hostConfig:s}),a}updateAnnotationConfig(e,t){throw new Error("Method not implemented.")}releaseAnnotation(e){const t=this.createLoggingOperation("ReleaseAnnotation",!0);if(t.dimension2=e,!this.activationsMapTokenToCallback.has(e)&&!this.activationsMapTokenToApologyCallback.has(e)){const s="AnnotationActivation already released:"+e;return t.success=!1,t.resultDescription=s,T.tG.info(508937629,T.nh.CoreDefault,t.stop()),Promise.reject(new Error(s))}let s=this.activationsMapTokenToCallback.get(e);s||(s=this.activationsMapTokenToApologyCallback.get(e)),s&&this.activationsMapTypeToTokens.get(s.annotationType).delete(e),this.activationsMapTokenToCallback.delete(e),this.activationsMapTokenToApologyCallback.delete(e);const o=this.getMessageId(),n=new r.GA({token:e,messageId:o}),i=new Promise(((e,s)=>{this.waitingForResponse.set(o,(o=>r.Qq.typeGuard(o)?(T.tG.info(508937628,T.nh.CoreDefault,t.stop()),void e(o.lastRelease)):r._p.typeGuard(o)?(t.success=!1,t.resultDescription=o.error,T.tG.error(508937627,T.nh.CoreDefault,t.stop()),void s(new Error(o.error))):(t.success=!1,t.resultDescription="Unknown Response",T.tG.error(508937626,T.nh.CoreDefault,t.stop()),void s(new Error("Unknown Response")))))}));return this.sendMessage(n),i}setAnnotationState(e,t,s){throw new Error("Method not implemented.")}setAnnotationMetadata(e,t,s){throw new Error("Method not implemented.")}submitOperation(e,t){this.submitOperations([e],t)}submitOperations(e,t){const s=Date.now(),o=new r.Tb({bridgeId:b,ops:e,messageId:this.getMessageId(),cv:t});this.sendMessageWithOpAsync("SubmitOperations",o).catch((e=>{})),(0,n.BG)(e,t,s,"SubmitInHostBridge",this.createLoggingOperation("AugloopClientPerfTracker",!0))}submitSeedOperations(e,t){if(!this.sessionOptions.allowSeeding)throw new Error("Method not implemented.");const s=new r.Tb({bridgeId:b,ops:e,messageId:this.getMessageId(),cv:t,seq:0});this.sendMessageWithOpAsync("SubmitSeedOperations",s).catch((e=>{}))}submitSeedGroupOperations(e,t,s){if(!this.sessionOptions.allowSeeding)throw new Error("Method not implemented.");this.seedGroupSize++;const o=new r.Tb({bridgeId:b,ops:e,messageId:this.getMessageId(),groupId:"Seed",groupSize:t?this.seedGroupSize:void 0,groupComplete:t||void 0,cv:s,seq:0});this.sendMessageWithOpAsync("SubmitSeedGroupOperations",o).catch((e=>{}))}submitCustomMessage(e){const t=this.createLoggingOperation("SubmitCustomMessage",!0),s=e.messageId;e.messageId=e.messageId?w+e.messageId:w+this.getNextCustomMessageSeq();const o=this.getMessageId(),n=new Promise(((e,n)=>{this.waitingForResponse.set(o,(o=>r.YK.typeGuard(o)?(t.resultDescription="Got response for submitted custom message",T.tG.info(508420945,T.nh.CoreDefault,t.stop()),s&&(o.messageId=s),void e(o)):r._p.typeGuard(o)?(t.success=!1,t.resultDescription=o.error,T.tG.error(508420944,T.nh.CoreDefault,t.stop()),void n(new Error(o.error))):(t.success=!1,t.resultDescription="Unknown Response",T.tG.error(508420943,T.nh.CoreDefault,t.stop()),void n(new Error("Unknown Response")))))}));let i;u.h.matchesTypesFor(e,[r.VR.getTypeName()])&&(i=_.r.serialize(e));const a=new r.g$({messageId:o,customMessage:e,binaryMessage:i?Array.from(i):void 0});return this.sendMessage(a),T.tG.info(508436875,T.nh.CoreDefault,t.stop()),n}sendLargeBinaryDataMessageInternal(e,t,s,o){(0,i.A2)(e,t,s,o)}sendBlobUploadStreamMessageInternal(e,t,s,o){(0,i.wM)(e,t,s,o)}submitLargeBinaryDataMessage(e){const t=this.createLoggingOperation("SendLargeBinaryDataMessage",!0),s=new Promise(((s,o)=>{this.connectionPendingTaskQueue.push((n=>{n?o(n):this.sendLargeBinaryDataMessageInternal(this.connectParams,e,t,((e,t)=>{e?o(new Error(e.error)):s(t)}))}).bind(this))}));return this.connectParams&&this.connectionPendingTaskQueue.processAll(),s}submitBinaryStreamUploadMessage(e){const t=this.createLoggingOperation("sendBinaryStreamUploadMessage",!0),s=new Promise(((s,o)=>{this.connectionPendingTaskQueue.push((n=>{n?o(n):this.sendBlobUploadStreamMessageInternal(this.connectParams,e,t,((e,t)=>{e?o(new Error(e.error)):s(t)}))}).bind(this))}));return this.connectParams&&this.connectionPendingTaskQueue.processAll(),s}activateServerRequestResponse(e,t,s){return N(this,void 0,void 0,(function*(){yield this.activateAnnotation(e,{callback:(e,s)=>{for(const s of e.items){const e=R("ActivateServerRequestResponse",!0,this.docSessionId),o=s.body;if(!(null==o?void 0:o.workflowExecutionCorrelation)){const t="Received annotation without workflowExecutionCorrelation";throw O(e,t),new Error(t)}let n=!1;const i=(t,s)=>{if(n){const t="Final response has already been sent for this annotation";throw O(e,t),new Error(t)}n=void 0===s||s;const i=new r.iT({workflowExecutionCorrelation:o.workflowExecutionCorrelation,finalResponse:n,content:t}),a=this.submitCustomMessage(i).catch((t=>{throw O(e,`Error submitting response: ${t.message}`),t}));return s&&O(e),a};null==t||t.onAnnotationCallback(o,i).catch((t=>{O(e,`Error in onAnnotationCallback: ${t.message}`)}))}}},s)}))}fetchBlobFromRefInternal(e,t,s,o){(0,i.ZC)(e,t,s,o)}requestBinaryDataForBlob(e){const t=this.createLoggingOperation("RequestBinaryData",!0);if(e.data)return T.tG.info(507646876,T.nh.CoreDefault,t.stop()),Promise.resolve(e.data);if(!e.dataPointer||e.dataPointer.refType===p.J1.None){const e="Blob does not have a data pointer";return t.success=!1,t.resultDescription=e,T.tG.error(507646875,T.nh.CoreDefault,t.stop()),Promise.reject(new Error(e))}const s=new Promise(((s,o)=>{this.connectionPendingTaskQueue.push((n=>{n?o(n):this.fetchBlobFromRefInternal(this.connectParams,e.dataPointer,((e,t)=>{e?o(e):s(t)}),t)}).bind(this))}));return this.connectParams&&this.connectionPendingTaskQueue.processAll(),s}requestCacheDump(e){throw new Error("Method not implemented.")}forceReconnect(e){throw new Error("Method not implemented.")}close(){const e=this.createLoggingOperation("CloseSession",!0);this.activationsMapTokenToCallback.forEach(((t,s)=>{this.releaseAnnotation(s).catch((t=>{e.resultDescription+=" "+t.message,e.success=!1}))})),this.activationsMapTokenToApologyCallback.size>0&&this.activationsMapTokenToApologyCallback.forEach(((t,s)=>{this.releaseAnnotation(s).catch((t=>{e.resultDescription+=" ApologyCallbacks "+t.message,e.success=!1}))})),T.tG.info(508937625,T.nh.CoreDefault,e.stop()),T.tG.flushAggregators(!0)}authenticateInteractive(e){return N(this,void 0,void 0,(function*(){const t=new c.i2({messageId:this.getMessageId(),forceUserPrompt:null==e?void 0:e.forceUserPrompt});yield this.sendMessageWithOpAsync("AuthenticateInteractive",t)}))}setConnectCallback(e){const t=this.getCallbackToken("connect");return e&&this.sessionConnectCallbacks.set(t,e),t}setDisconnectCallback(e){const t=this.getCallbackToken("disconnect");return e&&this.sessionDisconnectCallbacks.set(t,e),t}setReconnectCallback(e){const t=this.getCallbackToken("reconnect");return e&&this.sessionReconnectCallbacks.set(t,e),t}setSessionCloseCallback(e){const t=this.getCallbackToken("close");return e&&(this.sessionCloseCallbacks.set(t,e),this.isClosed&&this.sessionCloseMessages.forEach((t=>{e(t)}))),t}removeSessionStateCallback(e){function t(t){return!!t.has(e)&&(t.delete(e),!0)}return t(this.sessionCloseCallbacks)||t(this.sessionReconnectCallbacks)||t(this.sessionDisconnectCallbacks)||t(this.sessionConnectCallbacks)}setServerAuthenticationStateChangeCallback(e){this.serverAuthenticationStateChangeCallbacks.push(e),e(this.currentAuthenticationState)}setClaimsChallengeCallback(e){if(!e)return;const t=this.getCallbackToken("claimsChallenge");this.claimsChallengeCallbacks.set(t,e);const s=new c.tj({messageId:t});this.sendMessageWithOp("SetClaimsChallengeCallback",s)}setSeedingStatusChangeCallback(e){if(!e)return;const t=this.getCallbackToken("seedingStatus");this.seedingStatusChangeCallbacks.set(t,e);const s=new c.og({messageId:t});this.sendMessageWithOp("SetSeedingStatusChangeCallback",s)}getConnectParams(){return this.connectParams}setOfflineMode(){throw new Error("Method not available.")}getAnnotations(e,t){var s,o;const n=this.createLoggingOperation("GetAnnotations",!0);n.cv=e.cv,n.resultSignature="SubmitInHostBridge",n.resourceId=`${e.sourceInfo.featureId}-${e.sourceInfo.entryPoint}`,n.setDataFields({AnnotationType:null===(s=e.annotationType)||void 0===s?void 0:s.toString(),MaxDelayMs:null===(o=e.maxDelayMs)||void 0===o?void 0:o.toString()});const i=new v.x5({annotationTypes:e.annotationType,configs:e.configs,transientItems:e.transientItems,maxDelayMs:e.maxDelayMs,correlationInfo:{cvString:e.cv},messageId:this.getMessageId(),tryResolveUpstreamDependencies:e.tryResolveUpstreamDependencies,sourceInfo:e.sourceInfo,cv:e.cv});this.getAnnotationsResponseQueues.set(i.messageId,{queue:[]}),this.sendMessage(i);const a=this;let r=!1;const c=new Promise(((e,s)=>{if(t){const o=t.cancel.bind(t);t.cancel=()=>{r?e():(o(),s(new Error(F.requestCancelledError)))}}}));return{[Symbol.asyncIterator](){return I(this,arguments,(function*(){for(;!r;)try{const e=a.getAnnotationsResponseQueues.get(i.messageId);0===(null==e?void 0:e.queue.length)&&(yield E(Promise.race([new Promise((t=>e.responseReceived=t)),c])));const s=null==e?void 0:e.queue.shift();if(null==t?void 0:t.IsCancellationRequested)throw new Error(F.requestCancelledError);r=null==s?void 0:s.finalResponse,n.resultDescription="OK",T.tG.info(506575007,T.nh.CoreDefault,n.stop()),yield yield E(s)}catch(e){const t=e.message===F.requestCancelledError?l.zy.RequestCancelled:l.zy.Unknown;n.resultDescription="Error",n.setDataField("ClientError",`ErrorCode: ${t}, Error: ${e.message}`),T.tG.info(506575006,T.nh.CoreDefault,n.stop()),yield yield E({content:void 0,error:{clientError:{code:t,error:null==e?void 0:e.message}}}),r=!0;break}a.getAnnotationsResponseQueues.delete(i.messageId)}))}}}sendMessage(e,t){const s=new r.vG(Object.assign({bridgeId:b,docSessionId:this.docSessionId,messageType:u.h.getTypeNameFor(e),message:e},t));this.messageBridge.sendMessage(JSON.stringify(s))}sendMessageAsync(e,t){const s=new Promise(((t,s)=>{this.waitingForResponse.set(e.messageId,(e=>{r._p.typeGuard(e)?e.error&&e.error.includes("Unknown message type to handle")?s(new x(e.error)):s(new Error(e.error)):t(e)}))}));return this.sendMessage(e,t),s}sendMessageWithOp(e,t,s){const o=this.createLoggingOperation(e,!0);this.sendMessage(t,s),T.tG.info(507105996,T.nh.CoreDefault,o.stop())}sendMessageWithOpAsync(e,t,s){return N(this,void 0,void 0,(function*(){const o=this.createLoggingOperation(e,!0);try{return yield this.sendMessageAsync(t,s)}catch(e){throw o.success=!1,o.resultDescription=e.message,e}finally{o.success?T.tG.info(507105995,T.nh.CoreDefault,o.stop()):T.tG.error(507105994,T.nh.CoreDefault,o.stop())}}))}verifyMessageOrder(e,t){if(void 0===e.seq)return;const s={sequenceId:e.seq};if(t&&(s.messageType=u.h.getTypeNameFor(t),s.annotationCv=t.cv,r.B_.typeGuard(t))){const e=t;s.annotationType=e.annotationType}if(this.prevMessageInfo.sequenceId>s.sequenceId){const e=this.createLoggingOperation("OutOfOrderBridgeMessage",!1);e.setDataField("prevSeqId",this.prevMessageInfo.sequenceId),e.setDataField("prevMessageType",this.prevMessageInfo.messageType),e.setDataField("prevAnnotation",this.prevMessageInfo.annotationType),e.setDataField("prevAnnotationCv",this.prevMessageInfo.annotationCv),e.setDataField("currSeqId",s.sequenceId),e.setDataField("currMessageType",s.messageType),e.setDataField("currAnnotation",s.annotationType),e.setDataField("currAnnotationCv",s.annotationCv),T.tG.info(506799568,T.nh.CoreUnsampled,e.stop())}this.prevMessageInfo=s}ensureConnection(){return new Promise(((e,t)=>{const s=this.createLoggingOperation("EnsureConnection",!0);if(this.isClosed)return s.success=!1,s.resultDescription="Session is closed",T.tG.error(505192454,T.nh.CoreDefault,s.stop()),void t(new Error("Session is closed"));this.submitCustomMessage(new r.PR).then((t=>{T.tG.info(505192451,T.nh.CoreDefault,s.stop()),e()})).catch((e=>{s.success=!1,s.resultDescription=e.message,T.tG.error(505192452,T.nh.CoreDefault,s.stop()),t(e)}))}))}keepAlive(){this.ensureConnection().catch((e=>{}))}}F.internalSessionCounter=0,F.requestCancelledError="Request cancelled"},226089:(e,t,s)=>{s.d(t,{TR:()=>n});var o=s(596498);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_CopilotChatTeachingUi_CopilotChatTeachingUIAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_CopilotChatTeachingUi_OperationResponse"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_CopilotChatTeachingUi_SetTUIEverShownStateOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatTeachingUi_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_CopilotChatTeachingUi_GetTUIEverShownStateOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatTeachingUi_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},233812:(e,t,s)=>{s.d(t,{i:()=>i});var o=s(596498);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_CopilotWarmup_CopilotWarmupAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_CopilotWarmup_CopilotUserContextAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},241798:(e,t,s)=>{s.d(t,{$9:()=>a,Z5:()=>n,tE:()=>i,zV:()=>r});var o=s(596498);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_GraphSearch_SearchSuggestionsRequest"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_GraphSearch_GraphSearchSignalHybrid"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_GraphSearch_ClientPrefetch"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_GraphSearch_StorageDelete"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},248967:(e,t,s)=>{s.d(t,{Ix:()=>g,MZ:()=>f,Zk:()=>N,dx:()=>y,ft:()=>A,uv:()=>m});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadCalculateColumnPreviewSignal"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadCalculateRowPreviewSignal"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadGetRangeSignal"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadGetItemsSignal"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadWorkbookTableMetadataSignal"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadGetFileTablesMetadataSignal"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadSingleCellPreviewSignal"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){o.h.assign(g,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadCommandingSignal"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){o.h.assign(h,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadExecutePythonCodeRequestSignal"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{constructor(e){o.h.assign(d,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadGetPythonCodeResultSignal"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{constructor(e){o.h.assign(m,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadChartRecommendationSignal"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{constructor(e){o.h.assign(y,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadStartNewSessionSignal"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class T{constructor(e){o.h.assign(T,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadExecuteScriptOnScratchpadSignal"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[T.getTypeName()])}}T.H_={T_:T.getTypeName(),B_:T.getBaseTypes()};class f{constructor(e){o.h.assign(f,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadExecuteRichApiBatchSignal"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class _{constructor(e){o.h.assign(_,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadGeneratedFormulaPreviewSignal"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[_.getTypeName()])}}_.H_={T_:_.getTypeName(),B_:_.getBaseTypes()};class C{constructor(e){o.h.assign(C,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadStartSnapshotSignal"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[C.getTypeName()])}}C.H_={T_:C.getTypeName(),B_:C.getBaseTypes()};class S{constructor(e){o.h.assign(S,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadCloseSnapshotSignal"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[S.getTypeName()])}}S.H_={T_:S.getTypeName(),B_:S.getBaseTypes()};class A{constructor(e){o.h.assign(A,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadScriptExecutionCompleteSignal"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[A.getTypeName()])}}A.H_={T_:A.getTypeName(),B_:A.getBaseTypes()};class v{constructor(e){o.h.assign(v,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadApplyChangesSignal"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[v.getTypeName()])}}v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class N{constructor(e){o.h.assign(N,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadApplyChangesCompleteSignal"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[N.getTypeName()])}}N.H_={T_:N.getTypeName(),B_:N.getBaseTypes()}},249643:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CorrelationVector=void 0;class s{constructor(e){this.childCount=0,this.id=e||function(){for(let e=0;e<n;e++)i[e]=o[Math.floor(Math.random()*o.length)];return i.join("")}()}static fromString(e,t){if(!e)throw new Error("Received invalid correlation vector string");let o;return o=e.endsWith(".0")?new s(e.substring(0,e.length-2)):new s(e),t&&(o.childCount=t),o}newChild(){return++this.childCount,new s(this.id+"."+this.childCount.toString())}toString(){return this.id.length>127?this.id.substring(0,127)+"!":this.id}}t.CorrelationVector=s;const o=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],n=22,i=new Array(n)},253292:(e,t,s)=>{s.d(t,{xc:()=>a});var o=s(596498);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_OfficeCopilotOrchestration_CopilotBase"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_OfficeCopilotOrchestration_CopilotPrompts"}static getBaseTypes(){return["AugLoop_OfficeCopilotOrchestration_CopilotBase","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_OfficeCopilotOrchestration_CopilotRelatedFiles"}static getBaseTypes(){return["AugLoop_OfficeCopilotOrchestration_CopilotBase","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_OfficeCopilotOrchestration_CopilotRelatedFilesStream"}static getBaseTypes(){return["AugLoop_OfficeCopilotOrchestration_CopilotBase","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},256226:(e,t,s)=>{var o,n,i,a,r,c,l,u,p,g,h,d;s.d(t,{Bh:()=>i,RN:()=>u,Uy:()=>d,XJ:()=>r,Y$:()=>a,gd:()=>h,in:()=>c,mk:()=>n,ni:()=>g,ov:()=>p,qW:()=>l,wC:()=>o}),function(e){e[e.SingleItem=0]="SingleItem",e[e.Reduce=1]="Reduce",e[e.Grid=2]="Grid",e[e.DynamicText=3]="DynamicText",e[e.Join=4]="Join",e[e.Generic=5]="Generic"}(o||(o={})),function(e){e.Default="Default",e.Copilot="Copilot"}(n||(n={})),function(e){e[e.None=0]="None",e[e.ContentFiltering_M365Copilot=1]="ContentFiltering_M365Copilot"}(i||(i={})),function(e){e[e.Default=0]="Default",e[e.LocalOnly=1]="LocalOnly",e[e.Exclusive=2]="Exclusive"}(a||(a={})),function(e){e[e.PreActivate=0]="PreActivate",e[e.Default=1]="Default",e[e.DelayActivate=1]="DelayActivate",e[e.NeverActivate=2]="NeverActivate"}(r||(r={})),function(e){e[e.Required=-3]="Required",e[e.Optional=-1]="Optional"}(c||(c={})),function(e){e[e.Never=0]="Never",e[e.Always=1]="Always"}(l||(l={})),function(e){e[e.PreSeed=1]="PreSeed",e[e.OnSeed=2]="OnSeed",e[e.PostSeed=4]="PostSeed",e[e.All=5]="All"}(u||(u={})),function(e){e[e.UpstreamWorkflowsReady=0]="UpstreamWorkflowsReady",e[e.AnnotationMetadataUpdated=1]="AnnotationMetadataUpdated",e[e.DeltaUpdate=2]="DeltaUpdate",e[e.NonExclusiveTriggerSignals=3]="NonExclusiveTriggerSignals"}(p||(p={})),function(e){e[e.Character=1]="Character",e[e.Paragraph=2]="Paragraph"}(g||(g={})),function(e){e.Input="Input",e.Delta="Delta",e.UILanguage="UILanguage",e.MaxInputCount="MaxInputCount",e.ExtensionLimits="ExtensionLimits"}(h||(h={})),function(e){e.SetPredefinedAnnotation="SetPredefinedAnnotation",e.ClearAnnotations="ClearAnnotations"}(d||(d={}))},258021:(e,t,s)=>{s.d(t,{L4:()=>f});var o=s(972091),n=s(241798),i=s(599243),a=s(512755),r=s(596498),c=s(775352),l=s(825688),u=s(309708),p=s(120501),g=s(20213),h=s(125952);const d=e=>"GraphSearchClient"===e.ownerId,m=new Map([["AugLoop_GraphSearch_SearchSuggestionsAnnotationHybrid",0],["AugLoop_ObservationalAssistance_EccAnnotationClient",1],["AugLoop_GraphSearch_EccAnnotationHybrid",1],["AugLoop_GraphSearch_PredictionAnnotationHybrid",2],["AugLoop_GraphSearch_NudgeAnnotationHybrid",3]]);class y extends g.c{constructor(e,t){super("GraphSearchJoinWorkflowInstance",e,t)}async execute(e,t,s,n){let a=!1,l=!1;const u=new Date,p=this.startLogOperation("GraphSearchJoinWorkflowExecute",u,t);this.logWasmStats(p);const g=m.get(r.h.getTypeNameFor(t[0]));if(void 0!==g&&p.setDataFields({scenario:g}),2===t.length){if(c.SM.typeGuard(t[0])||c.SM.typeGuard(t[1])){const e=t[d(t[0])?0:1];p.setDataFields({conversationId:e.conversationId,logicalId:e.logicalId,sessionId:s.clientMetadata.sessionId})}if(o.nm.typeGuard(t[0])||o.nm.typeGuard(t[1])){const e=t[d(t[0])?0:1];p.setDataFields({logicalId:e.logicalId,sessionId:s.clientMetadata.sessionId}),"Ignore"===e.entityType&&(l=!0)}}p.setDataFields({dimension0:(new Date).getTime()-u.getTime()}),a=this.executeWorkflowLambda(p,e,s,n,t),l&&!a||i.tG.info(509638786,i.nh.WorkflowDefault,p.stop())}}const T=(e,t)=>new y(e,t),f=(e,t)=>a.a.create("GraphSearchJoinECC").setCollectionScopeType(u.VP.getTypeName()).setInputTypes([c.SM.getTypeName(),o.NG.getTypeName()]).setOutputTypes([l.os.getTypeName()]).setMaxAnnotations(2).setMaxDelayTime(1500).setLambdaType(T.bind(null,e,t));_=h.aU,C=h.zb,a.a.create("GraphSearchJoinWorkflow").setCollectionScopeType(n.Z5.getTypeName()).setInputTypes([o.J_.getTypeName()]).setOutputTypes([o.VL.getTypeName()]).setMaxAnnotations(2).setMaxDelayTime(1500).setLambdaType(T.bind(null,_,C));var _,C;((e,t)=>{a.a.create("GraphSearchJoinPrediction").setCollectionScopeType(p.iU.getTypeName()).setInputTypes([o.nm.getTypeName(),o.t9.getTypeName()]).setOutputTypes([c.k2.getTypeName(),c.KL.getTypeName(),l.Vm.getTypeName()]).setMaxAnnotations(2).setMaxDelayTime(1500).setLambdaType(T.bind(null,e,t))})(h.aU,h.zb),f(h.aU,h.zb)},262449:(e,t,s)=>{var o;s.d(t,{f:()=>o}),function(e){e[e.NotAuthenticated=0]="NotAuthenticated",e[e.Pending=1]="Pending",e[e.Authenticated=2]="Authenticated",e[e.WacUserInfoAuthenticated=3]="WacUserInfoAuthenticated",e[e.TokenMissingInteractionRequired=4]="TokenMissingInteractionRequired"}(o||(o={}))},263682:(e,t,s)=>{var o;s.d(t,{O:()=>o,Q:()=>n}),function(e){e.dev="dev",e.int="int",e.test="test",e.dogfood="dogfood",e.msit="msit",e.prod="prod",e.gcc="gcc",e.dod="dod",e.gccHigh="gcchigh",e.ag08="ag08",e.ag09="ag09",e.gallatin="gallatin",e.bleu="bleu"}(o||(o={}));const n={gcc:"fairfax"}},274070:function(e,t,s){var o=this&&this.__createBinding||(Object.create?function(e,t,s,o){void 0===o&&(o=s);var n=Object.getOwnPropertyDescriptor(t,s);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,o,n)}:function(e,t,s,o){void 0===o&&(o=s),e[o]=t[s]}),n=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||o(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),t.SessionHealthSource=t.SessionHealthReason=t.SessionHealthImpact=t.SessionHealthEvent=void 0,n(s(141780),t),n(s(249643),t),n(s(83302),t),n(s(180138),t),n(s(965787),t),n(s(661478),t);var i=s(758787);Object.defineProperty(t,"SessionHealthEvent",{enumerable:!0,get:function(){return i.SessionHealth}}),Object.defineProperty(t,"SessionHealthImpact",{enumerable:!0,get:function(){return i.SessionHealthImpact}}),Object.defineProperty(t,"SessionHealthReason",{enumerable:!0,get:function(){return i.SessionHealthReason}}),Object.defineProperty(t,"SessionHealthSource",{enumerable:!0,get:function(){return i.SessionHealthSource}})},274852:(e,t,s)=>{var o;s.d(t,{e:()=>o}),function(e){e.OfficeScript="OfficeScript",e.OfficeJs="OfficeJs"}(o||(o={}))},281180:(e,t,s)=>{s.d(t,{L:()=>n});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_ObservationalAssistanceAction_OAActionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},290291:(e,t,s)=>{var o,n,i;s.d(t,{g$:()=>o}),function(e){e.ProjectStatusReport="projectstatusreport",e.InternalReport="internalreport",e.Newsletter="newsletter",e.Email="emailcampaign",e.BlogPost="blogpost",e.Unknown="unknown"}(o||(o={})),function(e){e.qna="qna",e.summary="summary",e.unknown="unknown"}(n||(n={})),function(e){e.CIPTree="CIPTree",e.ChosenTopics="ChosenTopics"}(i||(i={}))},291436:(e,t,s)=>{var o,n,i;s.d(t,{Aw:()=>i,NQ:()=>o,Pf:()=>n}),function(e){e.ResumeInvokeAction="ResumeInvokeAction",e.ResumePluginAuth="ResumePluginAuth",e.CompletePlugin="CompletePlugin"}(o||(o={})),function(e){e[e.None=0]="None",e[e.Allow=1]="Allow",e[e.AlwaysAllow=2]="AlwaysAllow",e[e.Deny=3]="Deny"}(n||(n={})),function(e){e.failed="failed",e.success="success",e.cancelled="cancelled"}(i||(i={}))},292627:(e,t,s)=>{s.d(t,{K7:()=>l,PO:()=>r,Qn:()=>n,e9:()=>u,mH:()=>o,xv:()=>a,zy:()=>i});const o=2;var n,i,a,r,c,l,u;!function(e){e[e.ServerError=0]="ServerError",e[e.WorkflowDisabled=100]="WorkflowDisabled",e[e.TokenNotReady=101]="TokenNotReady",e[e.FlightNotReady=102]="FlightNotReady",e[e.ContextNotReady=103]="ContextNotReady",e[e.WorkflowExcluded=104]="WorkflowExcluded",e[e.WorkflowExecutionTimeout=105]="WorkflowExecutionTimeout",e[e.LambdaExecutionError=106]="LambdaExecutionError",e[e.UnexpectedOutput=107]="UnexpectedOutput",e[e.FailedToFetchInputs=108]="FailedToFetchInputs",e[e.FailedToFetchRequestedContexts=109]="FailedToFetchRequestedContexts"}(n||(n={})),function(e){e[e.Unknown=0]="Unknown",e[e.InvalidRequest=1]="InvalidRequest",e[e.InvalidResponse=2]="InvalidResponse",e[e.RuntimeNotInitialized=3]="RuntimeNotInitialized",e[e.RequestCancelled=4]="RequestCancelled",e[e.ResponseReceivedAfterFinalResponse=5]="ResponseReceivedAfterFinalResponse"}(i||(i={})),function(e){e[e.Unknown=0]="Unknown",e[e.Found=302]="Found",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.RequestTimeout=408]="RequestTimeout",e[e.Conflict=409]="Conflict",e[e.Gone=410]="Gone",e[e.RequestEntityTooLarge=413]="RequestEntityTooLarge",e[e.UnsupportedMediaType=415]="UnsupportedMediaType",e[e.UnprocessableContent=422]="UnprocessableContent",e[e.TooManyRequests=429]="TooManyRequests",e[e.SocketDisconnect=499]="SocketDisconnect",e[e.InternalServerError=500]="InternalServerError",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout",e[e.UnsupportedMessage=1e3]="UnsupportedMessage",e[e.Cancelled=1001]="Cancelled",e[e.EgressError=1002]="EgressError",e[e.MessageValidationError=1003]="MessageValidationError",e[e.SyncMessageException=2e3]="SyncMessageException",e[e.SyncMessageUnsupported=2001]="SyncMessageUnsupported",e[e.SyncMessageUnexpectedSeed=2002]="SyncMessageUnexpectedSeed",e[e.SyncMessageUnsupportedBatch=2003]="SyncMessageUnsupportedBatch",e[e.SyncMessageQueueFull=2004]="SyncMessageQueueFull",e[e.SyncMessageTooLateOrDuplicate=2005]="SyncMessageTooLateOrDuplicate",e[e.SyncMessageGroupIdMismatch=2006]="SyncMessageGroupIdMismatch",e[e.SyncMessageGroupStop=2007]="SyncMessageGroupStop",e[e.SyncMessageLost=2008]="SyncMessageLost",e[e.SyncMessageUnprocessedDuplicate=2009]="SyncMessageUnprocessedDuplicate",e[e.SyncMessageSessionClosed=2010]="SyncMessageSessionClosed",e[e.SyncMessageAbandoned=2011]="SyncMessageAbandoned",e[e.SyncMessageTooManyDeltaOperations=2012]="SyncMessageTooManyDeltaOperations",e[e.SyncMessageSessionSizeLimitExceeded=2013]="SyncMessageSessionSizeLimitExceeded",e[e.TokenValidationError=2100]="TokenValidationError",e[e.TokenDecryptError=2101]="TokenDecryptError",e[e.TokenTypeError=2102]="TokenTypeError",e[e.TokenUserBlocked=2103]="TokenUserBlocked",e[e.AnnotationActivationInvalidType=2200]="AnnotationActivationInvalidType",e[e.AnnotationReleaseTokenNotFound=2300]="AnnotationReleaseTokenNotFound"}(a||(a={})),function(e){e[e.UnKnown=0]="UnKnown",e[e.Start=1]="Start",e[e.Regular=2]="Regular",e[e.CheckConnection=3]="CheckConnection",e[e.PostEgress=4]="PostEgress",e[e.TimeoutResend=5]="TimeoutResend",e[e.FailResend=6]="FailResend"}(r||(r={})),function(e){e[e.IdentityChange=0]="IdentityChange"}(c||(c={})),function(e){e[e.Idle=0]="Idle",e[e.Pending=1]="Pending"}(l||(l={})),function(e){e[e.NotStarted=0]="NotStarted",e[e.Started=1]="Started",e[e.Incomplete=2]="Incomplete",e[e.Finished=3]="Finished"}(u||(u={}))},297546:(e,t,s)=>{s.d(t,{F:()=>n});var o={util:{},roots:{default:{}}},n=(o.util,o.roots.default||(o.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.suspiciousStringValue="",e.prototype.PG_ConcernEventName="",e.prototype.PG_TableName="",e.prototype.PG_ColumnName="",e.prototype.PG_EventTime="",e.prototype.PG_ConcernTypeText="",e.prototype.PG_ShouldIgnore=!1,e.prototype.PG_EventLocatorName="",e.prototype.PG_EventLocatorValue="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/PrivacyGuardIssueEvent"},e}())},298084:(e,t,s)=>{var o,n,i,a,r,c,l,u,p,g,h;s.d(t,{pc:()=>a}),function(e){e[e.Unspecified=0]="Unspecified",e[e.Inline=1]="Inline",e[e.Floating=2]="Floating"}(o||(o={})),function(e){e[e.ThumbsUp=0]="ThumbsUp"}(n||(n={})),function(e){e[e.Active=0]="Active",e[e.Resolved=1]="Resolved",e[e.Closed=2]="Closed"}(i||(i={})),function(e){e[e.Undefined=0]="Undefined",e[e.Bullet=1]="Bullet",e[e.Numbered=2]="Numbered",e[e.Lim=3]="Lim",e[e.Nil=4]="Nil",e[e.Any=5]="Any",e[e.NoList=6]="NoList",e[e.Invalid=7]="Invalid"}(a||(a={})),function(e){e[e.DontCare=1]="DontCare",e[e.Thin=2]="Thin",e[e.ExtraLight=3]="ExtraLight",e[e.Light=4]="Light",e[e.Normal=5]="Normal",e[e.Medium=6]="Medium",e[e.SemiBold=7]="SemiBold",e[e.Bold=8]="Bold",e[e.ExtraBold=9]="ExtraBold",e[e.Heavy=10]="Heavy"}(r||(r={})),function(e){e[e.NoCaps=0]="NoCaps",e[e.SmallCaps=1]="SmallCaps",e[e.AllCaps=2]="AllCaps",e[e.AllPetiteCaps=3]="AllPetiteCaps",e[e.PetiteCaps=4]="PetiteCaps",e[e.Unicase=5]="Unicase",e[e.Titling=6]="Titling",e[e.Other=7]="Other"}(c||(c={})),function(e){e[e.None=0]="None",e[e.Words=1]="Words",e[e.SingleLine=2]="SingleLine",e[e.DoubleLine=3]="DoubleLine",e[e.HeavyLine=4]="HeavyLine",e[e.DottedLine=5]="DottedLine",e[e.DottedHeavyLine=6]="DottedHeavyLine",e[e.DashLine=7]="DashLine",e[e.DashHeavyLine=8]="DashHeavyLine",e[e.DashLongLine=9]="DashLongLine",e[e.DashLongHeavyLine=10]="DashLongHeavyLine",e[e.DotDashLine=11]="DotDashLine",e[e.DotDashHeavyLine=12]="DotDashHeavyLine",e[e.DotDotDashLine=13]="DotDotDashLine",e[e.DotDotDashHeavyLine=14]="DotDotDashHeavyLine",e[e.WavyLine=15]="WavyLine",e[e.WavyHeavyLine=16]="WavyHeavyLine",e[e.WavyDoubleLine=17]="WavyDoubleLine"}(l||(l={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Center=2]="Center",e[e.Justified=3]="Justified",e[e.Other=4]="Other",e[e.None=5]="None",e[e.JustifyLow=6]="JustifyLow",e[e.Distributed=7]="Distributed",e[e.ThaiDistributed=8]="ThaiDistributed"}(u||(u={})),function(e){e[e.Image=0]="Image",e[e.TextBox=1]="TextBox",e[e.Chart=2]="Chart",e[e.SmartArt=3]="SmartArt",e[e.Drawing=4]="Drawing",e[e.EquationObject=5]="EquationObject",e[e.Ink=6]="Ink",e[e.InkSpace=7]="InkSpace",e[e.InkEndOfLine=8]="InkEndOfLine",e[e.LineBreak=9]="LineBreak",e[e.PageBreak=10]="PageBreak",e[e.PageNumbers=11]="PageNumbers",e[e.FootnoteEndnote=12]="FootnoteEndnote",e[e.FootnoteEndnoteReferenceMark=13]="FootnoteEndnoteReferenceMark",e[e.Tab=14]="Tab",e[e.UnsupportedObject=15]="UnsupportedObject",e[e.Other=16]="Other",e[e.Person=17]="Person",e[e.Date=18]="Date"}(p||(p={})),function(e){e[e.Initial=0]="Initial",e[e.FirstLine=1]="FirstLine",e[e.Hanging=2]="Hanging"}(g||(g={})),function(e){e[e.LeftToRight=0]="LeftToRight",e[e.RightToLeft=1]="RightToLeft"}(h||(h={}))},303129:(e,t,s)=>{var o,n,i;s.d(t,{OY:()=>n,Pu:()=>i}),function(e){e[e.Unknown=0]="Unknown",e[e.LiveId=1]="LiveId",e[e.OrgId=2]="OrgId",e[e.ActiveDirectory=3]="ActiveDirectory",e[e.ADAL=4]="ADAL",e[e.SSPI=5]="SSPI",e[e.OAuth2=6]="OAuth2",e[e.Badger=7]="Badger"}(o||(o={})),function(e){e[e.Augloop=0]="Augloop",e[e.Substrate=1]="Substrate"}(n||(n={})),function(e){e[e.Unknown=0]="Unknown",e[e.TokenMissingInteractionRequired=1]="TokenMissingInteractionRequired"}(i||(i={}))},303266:(e,t,s)=>{var o;s.d(t,{B:()=>o}),function(e){e.OPENED="opened",e.CLOSED="closed",e.LOADING="loading",e.LOADED="loaded",e.UNKNOWN="unknown"}(o||(o={}))},303341:(e,t,s)=>{var o,n;s.d(t,{F:()=>o,b:()=>n}),function(e){e[e.Client=0]="Client",e[e.Server=1]="Server"}(o||(o={})),function(e){e.None="None",e.RecentlyAccessed="RecentlyAccessed",e.Frequent="Frequent",e.Trending="Trending",e.Uploaded="Uploaded"}(n||(n={}))},307053:(e,t,s)=>{s.d(t,{pW:()=>r,yZ:()=>E});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelMetadata"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Excel_Worksheet"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Excel_WorksheetMetadata"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelRange"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelRangeWrapper"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelRangeWrapperAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Excel_BaseExcelBlock"}static getBaseTypes(){return["AugLoop_Excel_ExcelRangeWrapper"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelBlock"}static getBaseTypes(){return["AugLoop_Excel_BaseExcelBlock","AugLoop_Excel_ExcelRangeWrapper"]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){o.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelExtendedBlock"}static getBaseTypes(){return["AugLoop_Excel_BaseExcelBlock","AugLoop_Excel_ExcelRangeWrapper"]}static typeGuard(e){return o.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){o.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelMergedCellInfo"}static getBaseTypes(){return["AugLoop_Excel_ExcelRange"]}static typeGuard(e){return o.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{constructor(e){o.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelRangeFilter"}static getBaseTypes(){return["AugLoop_Core_ItemFilter"]}static typeGuard(e){return o.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{constructor(e){o.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Excel_PathFilter"}static getBaseTypes(){return["AugLoop_Core_ItemFilter"]}static typeGuard(e){return o.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{constructor(e){o.h.assign(y,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelGridSubtreeFilter"}static getBaseTypes(){return["AugLoop_Core_ItemFilter"]}static typeGuard(e){return o.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class T{constructor(e){o.h.assign(T,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelRangeSampleFilter"}static getBaseTypes(){return["AugLoop_Excel_ExcelRangeFilter","AugLoop_Core_ItemFilter"]}static typeGuard(e){return o.h.matchesTypesFor(e,[T.getTypeName()])}}T.H_={T_:T.getTypeName(),B_:T.getBaseTypes()};class f{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(f,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelTableColumn"}static getBaseTypes(){return["AugLoop_Excel_ExcelRangeWrapperAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class _{constructor(e){o.h.assign(_,this,e)}static getTypeName(){return"AugLoop_Excel_BaseExcelTable"}static getBaseTypes(){return["AugLoop_Excel_ExcelRangeWrapper"]}static typeGuard(e){return o.h.matchesTypesFor(e,[_.getTypeName()])}}_.H_={T_:_.getTypeName(),B_:_.getBaseTypes()};class C{constructor(e){o.h.assign(C,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelTable"}static getBaseTypes(){return["AugLoop_Excel_BaseExcelTable","AugLoop_Excel_ExcelRangeWrapper"]}static typeGuard(e){return o.h.matchesTypesFor(e,[C.getTypeName()])}}C.H_={T_:C.getTypeName(),B_:C.getBaseTypes()};class S{constructor(e){o.h.assign(S,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelPivotTable"}static getBaseTypes(){return["AugLoop_Excel_BaseExcelTable","AugLoop_Excel_ExcelRangeWrapper"]}static typeGuard(e){return o.h.matchesTypesFor(e,[S.getTypeName()])}}S.H_={T_:S.getTypeName(),B_:S.getBaseTypes()};class A{constructor(e){o.h.assign(A,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelCell"}static getBaseTypes(){return["AugLoop_Core_GridCell"]}static typeGuard(e){return o.h.matchesTypesFor(e,[A.getTypeName()])}}A.H_={T_:A.getTypeName(),B_:A.getBaseTypes()};class v{constructor(e){o.h.assign(v,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelMergedCell"}static getBaseTypes(){return["AugLoop_Excel_ExcelRangeWrapper"]}static typeGuard(e){return o.h.matchesTypesFor(e,[v.getTypeName()])}}v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class N{constructor(e){o.h.assign(N,this,e)}static getTypeName(){return"AugLoop_ExcelTableAi_ExcelRangeAddressNew"}static getBaseTypes(){return["AugLoop_Excel_ExcelRange"]}static typeGuard(e){return o.h.matchesTypesFor(e,[N.getTypeName()])}}N.H_={T_:N.getTypeName(),B_:N.getBaseTypes()};class E{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(E,this,e)}static getTypeName(){return"AugLoop_ExcelTableAi_ExcelRecognizedTableNew"}static getBaseTypes(){return["AugLoop_Excel_ExcelRangeWrapperAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[E.getTypeName()])}}E.H_={T_:E.getTypeName(),B_:E.getBaseTypes()};class I{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(I,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelDetectedTableBoundaryPartNew"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[I.getTypeName()])}}I.H_={T_:I.getTypeName(),B_:I.getBaseTypes()};class w{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(w,this,e)}static getTypeName(){return"AugLoop_ExcelTableAi_ExcelDetectedTableBoundaryNew"}static getBaseTypes(){return["AugLoop_Excel_ExcelRangeWrapperAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[w.getTypeName()])}}w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class b{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(b,this,e)}static getTypeName(){return"AugLoop_ExcelTableAi_ExcelTableDataGridPartNew"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[b.getTypeName()])}}b.H_={T_:b.getTypeName(),B_:b.getBaseTypes()};class k{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(k,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelComparisonAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[k.getTypeName()])}}k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()};class M{constructor(e){o.h.assign(M,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelComparisonItem"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[M.getTypeName()])}}M.H_={T_:M.getTypeName(),B_:M.getBaseTypes()};class L{constructor(e){o.h.assign(L,this,e)}static getTypeName(){return"AugLoop_Excel_EcsAccessInfo"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[L.getTypeName()])}}L.H_={T_:L.getTypeName(),B_:L.getBaseTypes()};class B{constructor(e){o.h.assign(B,this,e)}static getTypeName(){return"AugLoop_Excel_DirtyRangeSignal"}static getBaseTypes(){return["AugLoop_Core_DirtyAreaSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[B.getTypeName()])}}B.H_={T_:B.getTypeName(),B_:B.getBaseTypes()};class D{constructor(e){o.h.assign(D,this,e)}static getTypeName(){return"AugLoop_Excel_DirtyDocumentSignalForBdReducer"}static getBaseTypes(){return["AugLoop_Core_DirtyDocumentSignal","AugLoop_Core_DirtyAreaSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[D.getTypeName()])}}D.H_={T_:D.getTypeName(),B_:D.getBaseTypes()};class P{constructor(e){o.h.assign(P,this,e)}static getTypeName(){return"AugLoop_Excel_DirtyDocumentSignalForCleanData"}static getBaseTypes(){return["AugLoop_Core_DirtyDocumentSignal","AugLoop_Core_DirtyAreaSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[P.getTypeName()])}}P.H_={T_:P.getTypeName(),B_:P.getBaseTypes()};class R{constructor(e){o.h.assign(R,this,e)}static getTypeName(){return"AugLoop_Excel_WorkflowLimitsRestoredSignal"}static getBaseTypes(){return["AugLoop_Core_DirtyAreaSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[R.getTypeName()])}}R.H_={T_:R.getTypeName(),B_:R.getBaseTypes()};class O{constructor(e){o.h.assign(O,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelWorkflowTriggerParameters"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[O.getTypeName()])}}O.H_={T_:O.getTypeName(),B_:O.getBaseTypes()};class x{constructor(e){o.h.assign(x,this,e)}static getTypeName(){return"AugLoop_Excel_WorkbookCoauthVersion"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[x.getTypeName()])}}x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()};class F{constructor(e){o.h.assign(F,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelWorkflowContext"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[F.getTypeName()])}}F.H_={T_:F.getTypeName(),B_:F.getBaseTypes()}},309708:(e,t,s)=>{s.d(t,{JM:()=>i,Qo:()=>n,VP:()=>r,sr:()=>a});var o=s(596498),n=(function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_Request"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_FlagRequest"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SessionStartRequest"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),i=(function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedRequestBase"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedRequest"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedRequestBase","AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedRequestClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedRequestBase","AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),a=(function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedRequestBase"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedRequest"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedRequestBase","AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),r=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedRequestClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedRequestBase","AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()},313189:(e,t,s)=>{s.d(t,{MP:()=>u,cS:()=>r,k$:()=>l,sI:()=>c});var o=s(540949),n=s(138084),i=s(684078);const a=["cloud.dev.microsoft","officeppe.com","cloud.microsoft","office.com","office365.us","ic.gov","microsoft.scloud","microsoftonline.cn"],r=(e,t,s,o)=>new i.D(e,(e=>e.success&&s.indexOf(e[t])>=0),[t,"ariaNamespace","resourceId","success","resultSignature","clientDocSessionId","dimension0","dimension1","dimension2","dimension3"],["durationMs"],o),c=e=>{a.push(...e)},l=e=>{if(!e)return e;for(const t of a)if(e.indexOf(t)>=0)return e;return"**redacted**"};class u{constructor(e){this.level=o.q.info,this.hostCallbacks=e}log(e){if(null==this.hostCallbacks||null==this.hostCallbacks.sendTelemetryEvent)return;const t=(e,t,s,o,i)=>{let a=t.charAt(0).toUpperCase()+t.slice(1),r={DocSessionId:e.clientDocSessionId,ResourceId:e.resourceId,ResultDescription:e.resultDescription,ResultSignature:e.resultSignature,Dimension0:e.dimension0,Dimension1:e.dimension1,Dimension2:e.dimension2,Dimension3:e.dimension3,JoinContextId:e.joinContextId,ServerSessionKey:this.serverSessionKey};s&&(r=Object.assign(Object.assign({},r),JSON.parse(s)));const c=o||u.augLoopAriaTenantToken,l=i||c!=u.augLoopAriaTenantToken?i:u.augLoopAriaNamespace;a=a||u.operationNamePlaceholder;const p={CV:e.cv,Duration:1e3*(e.durationMs||0),Count:e.count,AggMode:2,Success:e.success};this.hostCallbacks.sendTelemetryEvent(c,l?`${l}_${a}`:a,r,"Office.System.Activity",p,!1,n.b.ProductServiceUsage|n.b.ProductServicePerformance,n.E.RequiredServiceDataEvent)},s=(e,t,s)=>{this.hostCallbacks.sendDiagnosticTrace&&this.hostCallbacks.sendDiagnosticTrace(e,t,s)};if("Workflow.MetricsOnly"==e.category);else if("Operation"===e.eventName){const s=e;t(s,s.operationName,s.dataFields,void 0,s.ariaNamespace)}else if("SessionHealth"===e.eventName){t(e,e.sessionHealthEventName)}else if("WorkflowOperation"===e.eventName){const s=e;t(s,s.operationName,s.dataFields,s.ariaTenant,s.ariaNamespace)}else"Log"===e.eventName&&s(e.tagId,e.traceLevel,e.message)}setServerSessionKey(e){this.serverSessionKey=e}}u.augLoopAriaTenantToken="3de4087d4de34817b1c376e3d1e6e293-983c4292-5ba9-485a-ab10-9797863c788b-6770",u.augLoopAriaNamespace="Office_AugLoop_Client",u.operationNamePlaceholder="OperationNameNotProvided"},315838:(e,t,s)=>{s.d(t,{BN:()=>n,T9:()=>r});var o=s(596498);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_CopilotPluginConfigBrokering_CopilotPluginConfigAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_CopilotPluginConfigBrokering_OperationResponse"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_CopilotPluginConfigBrokering_GetPluginConfigOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotPluginConfigBrokering_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_CopilotPluginConfigBrokering_GetPluginDefinitionOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotPluginConfigBrokering_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_CopilotPluginConfigBrokering_GetBotResultOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotPluginConfigBrokering_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_CopilotPluginConfigBrokering_ReadFreFlagOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotPluginConfigBrokering_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_CopilotPluginConfigBrokering_WriteFreFlagOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotPluginConfigBrokering_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()}},322438:(e,t,s)=>{var o;s.d(t,{X:()=>o}),function(e){e.TURN_OFF_PERSONALIZATION="0",e.TURN_ON_PERSONALIZATION="1",e.TOGGLE_PERSONALIZATION="2",e.SET_PROFILE="3",e.GET_PROFILE="4",e.DELETE_PROFILE="5"}(o||(o={}))},330328:(e,t,s)=>{s.d(t,{v:()=>n});var o=s(1193);class n extends o.L{constructor(e){super(e),this.eventName="AnnotationMetaDataChange"}}},330499:(e,t,s)=>{s.d(t,{x:()=>i});var o=s(596498);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_CopilotSubstrateIntegration_SuggestionAPIResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_CopilotSubstrateIntegration_SubstrateAPIResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},336831:(e,t,s)=>{s.d(t,{J1:()=>o});var o,n;!function(e){e[e.None=0]="None",e[e.HttpsGetDownloadUrl=1]="HttpsGetDownloadUrl",e[e.AlCodedLocation=2]="AlCodedLocation",e[e.Token=3]="Token",e[e.SpeAlCodedLocation=4]="SpeAlCodedLocation"}(o||(o={})),function(e){e[e.NewDocument=0]="NewDocument",e[e.EditDocument=1]="EditDocument",e[e.ViewOnlyDocument=2]="ViewOnlyDocument"}(n||(n={}));class i{}i.lowerIndexBound=1,i.maxNumberOfRows=1048576,i.maxNumberOfColumns=16384,i.firstColumnName="A",i.lastColumnName="XFD"},340305:(e,t,s)=>{s.d(t,{Qu:()=>a,VR:()=>i,jP:()=>n});var o=s(596498),n=function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_VoiceTile"},e.getBaseTypes=function(){return["AugLoop_Core_Binary"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),i=function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_VoiceLatencyInput"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),a=function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_BatchTranscriptionConversation"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()},343536:(e,t,s)=>{s.d(t,{f:()=>n});var o=s(596498),n=function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_TimeResult"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ResultInfo"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()},343978:(e,t,s)=>{s.d(t,{f3:()=>r,fS:()=>n,pq:()=>c,s:()=>a,x8:()=>i});var o=s(596498);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_ExcelAgentExperimental_ExcelAgentExperimentalOutputAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_ExcelAgentExperimental_ExcelAgentExperimentalCancelQueryResponseAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_ExcelAgentExperimental_ExcelAgentExperimentalRunScriptAnnotation"}static getBaseTypes(){return["AugLoop_Core_ExecutionCorrelatedAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_ExcelAgentExperimental_ExcelAgentExperimentalUserAllowedAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_ExcelAgentExperimental_ExcelAgentExperimentalForbiddenAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()}},346261:(e,t,s)=>{t.pR=t.O7=t.i6=t.Jq=t.wS=t._C=void 0;const o=s(134084);var n,i;!function(e){e[e.Person=0]="Person",e[e.NonPerson=1]="NonPerson",e[e.File=2]="File",e[e.WordDocument=3]="WordDocument",e[e.Powerpoint=4]="Powerpoint",e[e.PDF=5]="PDF",e[e.Excel=6]="Excel",e[e.Meeting=7]="Meeting",e[e.Chat=8]="Chat",e[e.Email=9]="Email",e[e.Unknown=10]="Unknown"}(n||(n={})),function(e){e[e.PastMeeting=0]="PastMeeting",e[e.FutureMeeting=1]="FutureMeeting",e[e.Unknown=2]="Unknown"}(i||(i={}));t._C={"whats the latest from":n.Person,"when is my next meeting with":n.Person,"what s the latest from":n.Person,"when s my next meeting with":n.Person,"what did":n.Person,recap:n.Meeting,"draft an email with action items from":n.Meeting,"what are the unresolved issues from":n.Meeting,"help me prepare for my next meeting":n.Meeting,"what were the key takeaways from":n.Meeting,"what are the key takeaways from":n.Meeting,"list key points from":n.File,"create a faq based on":n.File,"propose a new introduction to":n.File,"suggest edits make this more concise":n.File},t.wS={"¿cuáles fueron los problemas abiertos de":i.PastMeeting,"¿cuáles fueron los problemas abiertos de la":i.PastMeeting,"rédige un courriel contenant des notes et des éléments d’action de la":i.PastMeeting,"rédige un e-mail contenant des notes et des éléments d’action de la":i.PastMeeting,"crea una bozza di e-mail con le note e le attività definite durante la":i.PastMeeting,"entwirf eine e-mail mit notizen und aktionselementen aus":i.PastMeeting,"redacta un borrador de correo electrónico con notas y acciones de":i.PastMeeting,使用来自:i.PastMeeting,"draft an email with notes and action items from":i.PastMeeting,"¿cuáles son los elementos de acción de":i.PastMeeting,"elabore um email com anotações e itens de ação":i.PastMeeting,"was waren die offenen fragen in":i.PastMeeting,"what were the open issues from":i.PastMeeting,"quels étaient les problèmes en suspens par rapport à la":i.PastMeeting,"quali sono state le questioni discusse nella":i.PastMeeting,"quais foram os problemas em aberto da":i.PastMeeting,"what are the action items from":i.PastMeeting,"quali sono le attività da svolgere definite nella":i.PastMeeting,"was sind die aktionselemente aus":i.PastMeeting,"quels sont les points d'action issus de la":i.PastMeeting,"quais são os itens de ação da":i.PastMeeting,recap:i.PastMeeting,"resuma a":i.PastMeeting,"récap. la":i.PastMeeting,"resume las conclusiones y elementos de acción de la":i.PastMeeting,"crea un riepilogo della":i.PastMeeting,回顾:i.PastMeeting,récap:i.PastMeeting},t.Jq={"のオープンしている問題は何でしたか?":i.PastMeeting,"を要約し、主要な要点とアクション アイテムを別のセクションとしてまとめ、各責任者を含めます":i.PastMeeting,"中的未解决问题有哪些?":i.PastMeeting,"のアクション アイテムは何ですか?":i.PastMeeting,"中的拟办事项有哪些?":i.PastMeeting,"zusammen, mit ergebnissen/aktionselementen als abschnitten, mit zuständigen.":i.PastMeeting,"のメモとアクション アイテムを含むメールの下書きを作成します":i.PastMeeting},t.i6={"latest from":n.Person,"manager of":n.Person,who:n.Person,"who is":n.Person,message:n.NonPerson,messages:n.NonPerson,summarize:n.NonPerson,concise:n.NonPerson,elaborate:n.NonPerson,"introduction to":n.NonPerson,"points from":n.NonPerson,"items from":n.NonPerson,"issues from":n.NonPerson,"based on":n.NonPerson,in:n.NonPerson,meeting:n.Meeting,event:n.Meeting,meet:n.Meeting,sync:n.Meeting,"sync up":n.Meeting,call:n.Meeting,huddle:n.Meeting,scrum:n.Meeting,conference:n.Meeting,conf:n.Meeting,review:n.Meeting,discussion:n.Meeting,brief:n.Meeting,briefing:n.Meeting,appointment:n.Meeting,recap:n.Meeting,"prepare for":n.Meeting,"prep for":n.Meeting,file:n.File,files:n.File,document:n.WordDocument,documents:n.WordDocument,doc:n.WordDocument,word:n.WordDocument,docx:n.WordDocument,excel:n.Excel,sheet:n.Excel,spreadsheet:n.Excel,"spread sheet":n.Excel,presentation:n.Powerpoint,deck:n.Powerpoint,powerpoint:n.Powerpoint,"power point":n.Powerpoint,ppt:n.Powerpoint,pptx:n.Powerpoint,pdf:n.PDF,email:n.Email,emails:n.Email,"e mail":n.Email,"e mails":n.Email,chat:n.Chat,chats:n.Chat,group:n.Chat,groups:n.Chat,conversation:n.Chat,conversations:n.Chat};const a=new Set(["with","by"]);function r(e){let s=n.Unknown;const o=h(e);if(t._C.hasOwnProperty(o))return t._C[o];const i=o.split(" "),r=i[i.length-1];if(t.i6.hasOwnProperty(r)&&(s=t.i6[r]),i.length>=2){const e=i.slice(Math.max(0,i.length-2)).join(" ");t.i6.hasOwnProperty(e)&&(s=t.i6[e]);const o=i[i.length-2];("from"===r&&t.i6.hasOwnProperty(o)||a.has(r))&&(s=n.Person)}return s}function c(e,s){const o=e.trim().toLowerCase();if(t.wS.hasOwnProperty(o))return t.wS[o];if(s){const e=s.trim().toLowerCase();if(t.Jq.hasOwnProperty(e))return t.Jq[e]}return i.Unknown}function l(e){const s=h(e).split(" "),o=Math.min(s.length,5),n=s.slice(Math.max(0,s.length-o)).join(" ");for(const e in t.O7)if(n.includes(e))return t.O7[e];return i.Unknown}function u(e){const t=[];if(void 0!==e&&e!==n.Unknown)switch(e){case n.Person:t.push({name:"#people#",scope:o.IntentScope.FirstParty,score:1,confidenceLevel:o.IntentConfidenceLevel.High,highConfidenceSign:!0});break;case n.NonPerson:t.push({name:"#people#",scope:o.IntentScope.FirstParty,score:0,confidenceLevel:o.IntentConfidenceLevel.Low,highConfidenceSign:!1});break;case n.File:t.push({name:"#file#",scope:o.IntentScope.FirstParty,score:1,confidenceLevel:o.IntentConfidenceLevel.High,highConfidenceSign:!0});break;case n.WordDocument:t.push({name:"#file#",scope:o.IntentScope.FirstParty,score:1,confidenceLevel:o.IntentConfidenceLevel.High,slots:[{slotName:"file_type",slotValue:"doc"},{slotName:"file_type",slotValue:"docx"}],highConfidenceSign:!0});break;case n.Powerpoint:t.push({name:"#file#",scope:o.IntentScope.FirstParty,score:1,confidenceLevel:o.IntentConfidenceLevel.High,slots:[{slotName:"file_type",slotValue:"ppt"},{slotName:"file_type",slotValue:"pptx"}],highConfidenceSign:!0});break;case n.PDF:t.push({name:"#file#",scope:o.IntentScope.FirstParty,score:1,confidenceLevel:o.IntentConfidenceLevel.High,slots:[{slotName:"file_type",slotValue:"pdf"}],highConfidenceSign:!0});break;case n.Excel:t.push({name:"#file#",scope:o.IntentScope.FirstParty,score:1,confidenceLevel:o.IntentConfidenceLevel.High,slots:[{slotName:"file_type",slotValue:"xls"},{slotName:"file_type",slotValue:"xlsx"}],highConfidenceSign:!0});break;case n.Meeting:t.push({name:"#event#",scope:o.IntentScope.FirstParty,score:1,confidenceLevel:o.IntentConfidenceLevel.High,highConfidenceSign:!0});break;case n.Chat:t.push({name:"#chat#",scope:o.IntentScope.FirstParty,score:1,confidenceLevel:o.IntentConfidenceLevel.High,highConfidenceSign:!0});break;case n.Email:t.push({name:"#email#",scope:o.IntentScope.FirstParty,score:1,confidenceLevel:o.IntentConfidenceLevel.High,highConfidenceSign:!0})}return t}function p(e,t,s){const n=function(e,t){let s;if(void 0!==e&&e!==i.Unknown)switch(e){case i.FutureMeeting:s={name:"#event#",scope:o.IntentScope.FirstParty,score:t?1:.5,confidenceLevel:t?o.IntentConfidenceLevel.High:o.IntentConfidenceLevel.Medium,slots:[{slotName:"event_time",slotValue:"future"}],highConfidenceSign:!!t};break;case i.PastMeeting:s={name:"#event#",scope:o.IntentScope.FirstParty,score:t?1:.5,confidenceLevel:t?o.IntentConfidenceLevel.High:o.IntentConfidenceLevel.Medium,slots:[{slotName:"event_time",slotValue:"past"}],highConfidenceSign:!!t}}return s}(e,s);if(void 0===n)return;const a=t.find((e=>e.name===n.name));a?(a.score=Math.max(a.score,n.score),a.confidenceLevel=Math.max(a.confidenceLevel,n.confidenceLevel),a.highConfidenceSign=a.highConfidenceSign||n.highConfidenceSign,a.slots=g(a.slots,n.slots)):t.push(n)}function g(e,t){if(t){if(e){const s=t.filter((t=>!e.some((e=>t.slotName===e.slotName))));return[...e,...s]}return t}return e}function h(e){let t=e.toLowerCase().trim().replace(/[^\w\s]/g," ").trim().toLowerCase();return t=t.replace(/\s+/g," "),t}t.O7={"prepare for":i.FutureMeeting,"prep for":i.FutureMeeting,"prepare me for":i.FutureMeeting,"prep me for":i.FutureMeeting,"next meeting":i.FutureMeeting,"next event":i.FutureMeeting,"next sync":i.FutureMeeting,"next call":i.FutureMeeting,upcoming:i.FutureMeeting,"to be discussed":i.FutureMeeting,recap:i.PastMeeting,"last meeting":i.PastMeeting,"previous meeting":i.PastMeeting,summarize:i.PastMeeting,"summary of":i.PastMeeting,"points from":i.PastMeeting,"items from":i.PastMeeting,"takeaways from":i.PastMeeting,discussed:i.PastMeeting,"issues from":i.PastMeeting,"based on":i.PastMeeting},t.pR=function(e,t){var s,o;if((null!==(s=null==e?void 0:e.length)&&void 0!==s?s:0)<=0&&(null!==(o=null==t?void 0:t.length)&&void 0!==o?o:0)<=0)return;const n=u(r(e)),a=c(e,t);return a!==i.Unknown?p(a,n,!0):p(l(e),n),n}},347887:(e,t,s)=>{s.d(t,{m:()=>n});var o=s(596498);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_OperaCopilot_OperaCopilotOutputAnnotation"}static getBaseTypes(){return["AugLoop_Copilot_CopilotOutputAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_OperaCopilot_OperaValidateGptAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},355232:(e,t,s)=>{var o,n;s.d(t,{f:()=>o,h:()=>n}),function(e){e[e.Unspecified=0]="Unspecified",e[e.Other=1]="Other",e[e.Jpg=2]="Jpg",e[e.Png=3]="Png",e[e.Bmp=4]="Bmp"}(o||(o={})),function(e){e[e.Unspecified=0]="Unspecified",e[e.Other=1]="Other",e[e.Small=2]="Small",e[e.Medium=3]="Medium",e[e.Large=4]="Large"}(n||(n={}))},357635:(e,t,s)=>{s.d(t,{z:()=>i});var o=s(256226),n=s(796462);class i{constructor(e,t){var s,n,i,a,r,c;this.kind=o.wC.SingleItem,this.isStateful=!1,this.id=e,t&&(this.inputTypes=null!==(s=t.inputTypes)&&void 0!==s?s:this.inputTypes,this.outputTypes=null!==(n=t.outputTypes)&&void 0!==n?n:this.outputTypes,this.isStateful=null!==(i=t.isStateful)&&void 0!==i?i:this.isStateful,this.requestedContextTypesRules=null!==(a=t.requestedContextTypesRules)&&void 0!==a?a:this.requestedContextTypesRules,this.definitionOverrideTargetWorkflows=null!==(r=t.definitionOverrideTargetWorkflows)&&void 0!==r?r:this.definitionOverrideTargetWorkflows,this.correlatedSignals=0!==(null===(c=t.correlatedSignals)||void 0===c?void 0:c.length)?t.correlatedSignals:this.correlatedSignals)}static create(e){return new i(e)}setInputTypes(e){return this.inputTypes=(0,n.MY)(e),this}setOutputTypes(e){return this.outputTypes=(0,n.MY)(e),this}setStateful(){return this.isStateful=!0,this}setRequestedContexts(e){var t;return this.requestedContextTypesRules=(null!==(t=this.requestedContextTypesRules)&&void 0!==t?t:this.requestedContextTypesRules=[]).concat(e),this}setLambdaType(e){return this.factory=e,this}setDefinitionOverrideTargetWorkflows(e){return this.definitionOverrideTargetWorkflows=e,this}setCorrelatedSignals(e){return 0!==e.length&&(this.correlatedSignals=e),this}setLambda(e,t){return this.factory=()=>({init:t||(e=>Promise.resolve()),execute:e,dispose:()=>{}}),this}validateOptions(){return{isValid:!0}}}},360033:(e,t,s)=>{s.d(t,{TE:()=>_});var o=s(474655),n=s(825688),i=s(68580),a=s(174025),r=s(512755),c=s(599243),l=s(383129),u=s(440714);const p=new Map([[o.c.People,1300],[o.c.PeopleInGroup,1250],[o.c.File,1200],[o.c.Event,1100],[o.c.Message,1e3],[o.c.Chat,920],[o.c.Team,910],[o.c.Channel,900],[o.c.MessageExtensionApp,800],[o.c.External,700],[o.c.Topic,600],[o.c.Loop,500],[o.c.Address,400],[o.c.Scope,100],[o.c.App,90],[o.c.Prompt,85],[o.c.CopilotPlugin,80]]),g=e=>!Number.isFinite(e)||e<0?0:e>1?1:e,h=e=>{const t=p.get(e);return void 0===t?(c.tG.error(509743565,c.nh.WorkflowDefault,`unsupported entity type:'${e}'`),1):t},d=(e,t)=>{const s=h(e.entityType),o=h(t.entityType);return s===o?(c.tG.warn(509743564,c.nh.WorkflowDefault,`unexpected priority:'${e.entityType}','${t.entityType}'`),e.entityType.localeCompare(t.entityType)):o-s},m=(e,t,s)=>{t||c.tG.warn(e,c.nh.WorkflowDefault,s)};class y{constructor(){this.seqCounter=0,this.seqCounter=0}async init(e){this.seqCounter=0}async execute(e,t,s,o){const i=(new Date).toISOString();c.tG.info(524066818,c.nh.WorkflowDefault,`Executing oa-client client-server ranker workflow. sequence number : ${this.seqCounter}`),this.seqCounter++;const a=(0,l.K)("Ranker_Ecc",s).start(),r=this.getRankedResults(t,a);r&&o.setAnnotations(e,n.c$.getTypeName(),[r]);const u=(new Date).toISOString();a.setDataFields({startTimeStamp:i,endTimeStamp:u}),c.tG.info(512500928,c.nh.WorkflowDefault,a.stop()),o.done()}dispose(){this.seqCounter=0}getRankedResults(e,t){var s,o,a,r,l,p,h,y,T,f,_,C;if(0===e.length||this.seqCounter<0)return t.success=!1,t.resultDescription="oa-client-server ecc result ranker lambda has no inputs",void c.tG.warn(524066819,c.nh.WorkflowDefault,t.resultDescription);if(e.length>2)return t.success=!1,t.resultDescription="Unexpected. Client-server ranker can never have more than 2 inputs",void c.tG.warn(523854672,c.nh.WorkflowDefault,t.resultDescription);const S=null!==(o=null===(s=e[0])||void 0===s?void 0:s.conversationId)&&void 0!==o?o:"",A=null!==(r=null===(a=e[0])||void 0===a?void 0:a.logicalId)&&void 0!==r?r:"";if(t.setDataFields({conversationId:S,logicalId:A}),0===(e=e.filter((e=>e.status!==i.i.EarlyExit))).length)return t.success=!0,t.resultDescription="oa-client-server ecc result ranker skipping execution due to receiving early-exit annotations only",void c.tG.warn(509112707,c.nh.WorkflowDefault,t.resultDescription);const v=e.length.toString(),N=e.map((e=>e.ownerId)).join(";");let E;if(t.setDataFields({providerCount:v,souces:N}),1===e.length&&e[0].entityResults)E=new n.c$({conversationId:S,entityResults:e[0].entityResults,logicalId:A,status:e[0].status,treatments:e[0].treatments});else{const t=new Map,s=e[0].entityResults.length>=e[1].entityResults.length?0:1,o=(s+1)%2,a=new Set,r=e[s];for(let s=0;s<r.entityResults.length;++s){const n=r.entityResults[s],i=n.entityType;a.add(i);const c=n.entities,l=e[o];let u=n.modelInfo,p=c,g=r.entityResults[s].intent;for(let e=0;e<l.entityResults.length;++e){const t=l.entityResults[e];if(i===t.entityType){const s=l.entityResults[e].intent;s&&(g=Math.max(null!=g?g:0,s)),p=this.getDeDupedEntityList(c,t.entities),u=this.getMergedModelInfo(n.modelInfo,t.modelInfo);break}}const h={entities:p,entityType:i,modelInfo:u,intent:g};t.set(i,h)}const v=e[o];for(let e=0;e<v.entityResults.length;++e){const s=v.entityResults[e],o=s.entityType;a.has(o)||t.set(o,s)}const N=Array.from(t.values()).sort(d),I=[];let w=[],b=!1;if((0,u.I)("UseLocallyGeneratedBM")&&(null===(l=null==r?void 0:r.entityResults)||void 0===l?void 0:l.length)>0&&"GraphSearchClient"===(null==r?void 0:r.ownerId)&&(null===(h=null===(p=null==r?void 0:r.treatments)||void 0===p?void 0:p.bestMatchEntries)||void 0===h?void 0:h.length)>0)w=r.treatments.bestMatchEntries;else if((0,u.I)("UseLocallyGeneratedBM")&&(null===(y=null==v?void 0:v.entityResults)||void 0===y?void 0:y.length)>0&&"GraphSearchClient"===(null==v?void 0:v.ownerId)&&(null===(f=null===(T=null==v?void 0:v.treatments)||void 0===T?void 0:T.bestMatchEntries)||void 0===f?void 0:f.length)>0)w=v.treatments.bestMatchEntries;else{const e=null===(_=null==r?void 0:r.treatments)||void 0===_?void 0:_.bestMatchEntries,t=null===(C=null==v?void 0:v.treatments)||void 0===C?void 0:C.bestMatchEntries;if(e)for(let t=0;t<e.length;t++)I.push(e[t]);if(t)for(let e=0;e<t.length;e++)I.push(t[e]);w=I.sort(((e,t)=>g(t.confidence)-g(e.confidence))).sort(d).slice(0,3),b=((e,t)=>{var s;const o=null===(s=t.find((e=>e.entities.length>0)))||void 0===s?void 0:s.entityType,n=o&&!e.some((e=>e.entityType!=o));return n&&c.tG.info(509662157,c.nh.WorkflowDefault,"Best Match results suppressed"),n})(w,N)}m(520135894,(null==r?void 0:r.conversationId)===(null==v?void 0:v.conversationId),"Unexpected mismatch of conversation id in ranker"),m(520135893,(null==r?void 0:r.logicalId)===(null==v?void 0:v.logicalId),"Unexpected mismatch of logical id in ranker"),E=new n.c$({conversationId:null!=S?S:"",entityResults:N,logicalId:null!=A?A:"",status:0===N.length?i.i.NoResults:i.i.Success,treatments:new n.Fe({bestMatchEntries:b?[]:w})})}var I;return t.setDataFields({entityCount:(I=[E],I.reduce(((e,t)=>{var s;return e+((null===(s=t.entityResults)||void 0===s?void 0:s.reduce(((e,t)=>{var s;return e+((null===(s=t.entities)||void 0===s?void 0:s.length)||0)}),0))||0)}),0).toString())}),E}getDeDupedEntityList(e,t){const s=[],o=new Set;for(let t=0;t<e.length;++t){const n=e[t],i=n.text.toLocaleLowerCase();o.has(i)||(o.add(i),s.push(n))}for(let e=0;e<t.length;++e){const n=t[e];o.has(n.text.toLocaleLowerCase())||s.push(n)}return s}getMergedModelInfo(e,t){return{elapsedTime:Math.max(e.elapsedTime,t.elapsedTime),name:`${e.name}|${t.name}`,version:`${e.version}|${t.version}`}}}const T=()=>new y,f=(e,t)=>r.a.create("OaClientServerEccResultRanker").setCollectionScopeType(a.Cg.getTypeName()).setInputTypes(t).setOutputTypes([n.c$.getTypeName()]).setMaxAnnotations(e).setMaxDelayTime(3400).setLambdaType(T),_=(f(2,[n.J2.getTypeName(),n.os.getTypeName()]),f(2,[n.os.getTypeName()]))},361388:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.rangeEquals=t.isRangeContained=t.rangesIntersect=t.gridRangeToExcelRange=t.excelRangeToGridRange=t.getTopRowAddress=t.getColumnRangeToTheRight=t.isCellPartOfRange=t.hasSheetNameInRangeAddress=t.parseRangeAddressWithEmbeddedSheetName=t.parseRangeAddress=t.areCellsEqual=t.parseCellAddress=t.convertRowColumnToCellAddress=t.makeRangeAddress=t.countColumnsInRanges=t.countRowsInRanges=t.countCellsInRanges=t.convertToRanges=t.isIntersect=t.compareRanges=t.getStartIndexForColumnData=t.mergeCellsToRanges=t.unionRanges=t.mergeConsecutiveRangesByColumn=t.areAllRowsEqual=t.columnNumberToTitle=t.columnNumberFromTitle=t.GridConstants=void 0;class s{}function o(e){let t=0;const s=e.toUpperCase();for(let e=s.length-1,o=e;o>=0;--o){t+=(s.charCodeAt(o)-n+1)*Math.pow(i,e-o)}return t}t.GridConstants=s,s.lowerIndexBound=1,s.maxNumberOfRows=1048576,s.maxNumberOfColumns=16384,t.columnNumberFromTitle=o;const n="A".charCodeAt(0),i=26;function a(e){if(e<s.lowerIndexBound||e>s.maxNumberOfColumns)throw new Error(`column: ${e} is out of bounds`);const t=[];for(e--;e>=0;){const s=n+e%i,o=String.fromCharCode(s);t.unshift(o),e=Math.floor(e/i)-1}return t.join("")}function r(e,t){return{left:Math.min(e.left,t.left),top:Math.min(e.top,t.top),right:Math.max(e.right,t.right),bottom:Math.max(e.bottom,t.bottom),worksheetId:e.worksheetId}}function c(e){const t=[];e.sort(((e,t)=>e.row===t.row?e.column-t.column:e.row-t.row));for(let s=0;s<e.length;s++){const o=e[s].row;let n=o;for(;s<e.length-1&&e[s].column===e[s+1].column&&e[s+1].row-n<=1;)n=e[s+1].row,s++;t.push({left:e[s].column,top:o,right:e[s].column,bottom:n})}return t}function l(e){const{top:t,bottom:s,left:o,right:n}=e,i=u(s,n);return u(t,o)+":"+i}function u(e,t){if(e<s.lowerIndexBound||e>s.maxNumberOfRows)throw new Error(`row: ${e} is out of bounds`);if(t<s.lowerIndexBound||t>s.maxNumberOfColumns)throw new Error(`column: ${t} is out of bounds`);return`${a(t)}${e}`}function p(e){const t=/^([a-zA-Z]+)(\d+)$/g.exec(e);if(!t)return;const[,s,n]=t;return{row:parseInt(n,10),column:o(s)}}function g(e,t){if(e.includes("!")){if(!e.startsWith("'"))return g(e.split("!")[1],t);const s=/^\'(.*?)\'!(.*)$/.exec(e);if(s)return g(s[2],t)}const[n,i,...a]=e.split(":");if(a.length>0)throw new Error("Invalid range address: multiple instances of ':' found");const r=p(n);if(!r){const n=/^([a-zA-Z]+):([a-zA-Z]+)$/.exec(e);if(n){const e=o(n[1]),i=o(n[2]);return{top:s.lowerIndexBound,left:Math.min(e,i),bottom:s.maxNumberOfRows,right:Math.max(e,i),worksheetId:t}}const i=/^(\d+):(\d+)$/.exec(e);if(i){const e=parseInt(i[1],10),o=parseInt(i[2],10);return{top:Math.min(e,o),left:s.lowerIndexBound,bottom:Math.max(e,o),right:s.maxNumberOfColumns,worksheetId:t}}throw new Error("Invalid range address: failed to parse left top cell")}const c={top:r.row,left:r.column,bottom:-1,right:-1,worksheetId:t};if(i){const e=p(i);if(!e)throw new Error("Invalid range address: failed to parse right bottom cell");if(c.bottom=e.row,c.right=e.column,c.bottom<c.top){const e=c.top;c.top=c.bottom,c.bottom=e}if(c.right<c.left){const e=c.left;c.left=c.right,c.right=e}}else c.bottom=c.top,c.right=c.left;return c}function h(e,t,s=!0){return(!s||e.worksheetId===t.worksheetId)&&(Math.min(e.right,t.right)>=Math.max(e.left,t.left)&&Math.min(e.bottom,t.bottom)>=Math.max(e.top,t.top))}t.columnNumberToTitle=a,t.areAllRowsEqual=function(e,t){return e.length===t.length&&e.every(((e,s)=>{const o=t[s];return e.top===o.top&&e.bottom===o.bottom}))},t.mergeConsecutiveRangesByColumn=function(e){function t(e,t){const s=e.left===t.left&&e.right===t.right,o=t.top-e.bottom<=1;return s&&o}const s=e.sort(((e,t)=>e.top-t.top)),o=[];for(let e=0;e<s.length;e++){for(;e<s.length-1&&t(s[e],s[e+1]);)s[e+1]=r(s[e+1],s[e]),e++;o.push(s[e])}return o},t.unionRanges=r,t.mergeCellsToRanges=c,t.getStartIndexForColumnData=function(e,t,s){if(s>=1)for(let o=0;o<e.length;o++){const n=e[o];if(n&&n.row>=t.top+s)return o}return s},t.compareRanges=function(e,t){return e.left===t.left?e.top-t.top:e.left-t.left},t.isIntersect=function(e,t){return h(e,t.range,!1)},t.convertToRanges=function(e,t){return c(e.map((e=>({row:e,column:t}))))},t.countCellsInRanges=function(e){return e.reduce(((e,t)=>e+(t.right-t.left+1)*(t.bottom-t.top+1)),0)},t.countRowsInRanges=function(e){return e.reduce(((e,t)=>e+(t.bottom-t.top+1)),0)},t.countColumnsInRanges=function(e){return e.reduce(((e,t)=>e+(t.right-t.left+1)),0)},t.makeRangeAddress=l,t.convertRowColumnToCellAddress=u,t.parseCellAddress=p,t.areCellsEqual=function(e,t){return e.row===t.row&&e.column===t.column},t.parseRangeAddress=g,t.parseRangeAddressWithEmbeddedSheetName=function(e,t){if(e.includes("!")){const t=/^(?:'([^']+)'|([^!]+))!/.exec(e);if(t){return g(e,t[1]||t[2])}}if(!t)throw new Error("WorksheetId must be provided if range address does not include a sheet name.");return g(e,t)},t.hasSheetNameInRangeAddress=function(e){return e.includes("!")},t.isCellPartOfRange=function(e,t){return h(e,function(e,t){return{top:e.row,left:e.column,bottom:e.row,right:e.column,worksheetId:t}}(t,e.worksheetId))},t.getColumnRangeToTheRight=function(e){return{top:e.top,left:e.right+1,bottom:e.bottom,right:e.right+1,worksheetId:e.worksheetId}},t.getTopRowAddress=function(e){return l({top:e.top,left:e.left,bottom:e.top,right:e.right})},t.excelRangeToGridRange=function(e){return{row:e.top-1,rows:e.bottom-e.top+1,col:e.left-1,cols:e.right-e.left+1}},t.gridRangeToExcelRange=function(e,t){const s={top:e.row+1,bottom:e.row+e.rows,left:e.col+1,right:e.col+e.cols,worksheetId:t};return{...s,address:l(s)}},t.rangesIntersect=h,t.isRangeContained=function(e,t){return e.worksheetId===t.worksheetId&&(e.left<=t.left&&e.right>=t.right&&e.top<=t.top&&e.bottom>=t.bottom)},t.rangeEquals=function(e,t){return e.worksheetId===t.worksheetId&&(e.bottom===t.bottom&&e.left===t.left&&e.right===t.right&&e.top===t.top)}},363496:(e,t,s)=>{s.d(t,{f:()=>n,w:()=>i});var o=s(596498);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_ExcelChartStyles_ExcelChartStylesAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_ExcelChartStyles_ExcelChartStylesSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},366548:(e,t,s)=>{var o,n,i,a,r;s.d(t,{Av:()=>a,OY:()=>o,Om:()=>i,rN:()=>r,ut:()=>n}),function(e){e[e.EditorLowPrivilege=0]="EditorLowPrivilege",e[e.AugLoopLowPrivilege=1]="AugLoopLowPrivilege",e[e.Anonymous=2]="Anonymous",e[e.ClientAssertion=3]="ClientAssertion",e[e.ClientAssertionV2=4]="ClientAssertionV2",e[e.AutoClpLowPrivilege=5]="AutoClpLowPrivilege",e[e.AutoClpAppOnlyLowPrivilege=6]="AutoClpAppOnlyLowPrivilege",e[e.Substrate=7]="Substrate",e[e.WacUserInfo=8]="WacUserInfo",e[e.OwaExchange=9]="OwaExchange",e[e.SmartCompose=10]="SmartCompose",e[e.WritingAnalyticsLowPrivilege=11]="WritingAnalyticsLowPrivilege",e[e.DWEngineLowPrivilege=12]="DWEngineLowPrivilege",e[e.SubstrateApp=13]="SubstrateApp",e[e.CortanaAppPop=14]="CortanaAppPop",e[e.OfficeAppsAppOnly=15]="OfficeAppsAppOnly",e[e.PPTFrontdoorAppPop=16]="PPTFrontdoorAppPop",e[e.EditorAppOnlyLowPrivilege=17]="EditorAppOnlyLowPrivilege",e[e.AugLoopApp=18]="AugLoopApp",e[e.MeetingIntelligenceApp=19]="MeetingIntelligenceApp",e[e.GraphApp=20]="GraphApp",e[e.IceServicesApp=21]="IceServicesApp",e[e.AzureMapsApp=22]="AzureMapsApp",e[e.SpoApp=23]="SpoApp",e[e.OneDrive=24]="OneDrive",e[e.GoogleDrive=25]="GoogleDrive",e[e.GettyApp=26]="GettyApp",e[e.Dropbox=27]="Dropbox",e[e.GooglePhotos=28]="GooglePhotos",e[e.EditorApp=29]="EditorApp",e[e.AmazonKindle=30]="AmazonKindle",e[e.ShredderApp=31]="ShredderApp",e[e.FormsLowPrivilege=32]="FormsLowPrivilege",e[e.VivaSalesLowPrivilege=33]="VivaSalesLowPrivilege",e[e.IntentSvcApp=34]="IntentSvcApp",e[e.DcgLowPrivilege=35]="DcgLowPrivilege",e[e.CSALowPrivilege=36]="CSALowPrivilege",e[e.ConsumerSydneyLowPrivilege=37]="ConsumerSydneyLowPrivilege",e[e.CompliantSydneyApp=38]="CompliantSydneyApp",e[e.M365AdminApp=39]="M365AdminApp",e[e.MeetingArtifactsServiceLowPrivilege=40]="MeetingArtifactsServiceLowPrivilege",e[e.AlchemyApp=41]="AlchemyApp",e[e.M365Admin=42]="M365Admin",e[e.ConsumerShellApp=43]="ConsumerShellApp",e[e.PowerQueryLowPrivilege=44]="PowerQueryLowPrivilege",e[e.CIIApp=45]="CIIApp",e[e.ConsumerShell=46]="ConsumerShell",e[e.AssistCopilotLowPrivilege=47]="AssistCopilotLowPrivilege",e[e.Pva=48]="Pva",e[e.TeamsCopilotServiceLowPrivilege=49]="TeamsCopilotServiceLowPrivilege",e[e.CallAnalytics=50]="CallAnalytics",e[e.IncomingPFT=51]="IncomingPFT",e[e.GraphExchange=52]="GraphExchange",e[e.EXOAdmin=53]="EXOAdmin",e[e.InsightsServicesLowPrivilege=54]="InsightsServicesLowPrivilege",e[e.VivaServicesLowPrivilege=55]="VivaServicesLowPrivilege",e[e.EcsAppOnly=56]="EcsAppOnly",e[e.ShredderLowPrivilege=57]="ShredderLowPrivilege",e[e.SpoLowPrivilege=58]="SpoLowPrivilege",e[e.PromptValidationApp=59]="PromptValidationApp",e[e.CompliantSydneyLowPrivilege=60]="CompliantSydneyLowPrivilege",e[e.SubstrateTenantFeedbackApp=61]="SubstrateTenantFeedbackApp",e[e.MonitoringPlatform=62]="MonitoringPlatform",e[e.YammerLowPrivilege=63]="YammerLowPrivilege",e[e.VivaLearningLowPrivilege=64]="VivaLearningLowPrivilege",e[e.VivaInsightsLowPrivilege=65]="VivaInsightsLowPrivilege",e[e.ClientAugLoopApp=66]="ClientAugLoopApp",e[e.AssistAuthLowPrivilege=67]="AssistAuthLowPrivilege",e[e.VivaLearningSearchPreProdLowPrivilege=68]="VivaLearningSearchPreProdLowPrivilege",e[e.SubstrateSearchApp=69]="SubstrateSearchApp",e[e.SparkContentPlatformLowPrivilege=70]="SparkContentPlatformLowPrivilege",e[e.SparkContentPlatformPopApp=71]="SparkContentPlatformPopApp",e[e.ConsumerSydneyApp=72]="ConsumerSydneyApp",e[e.BusinessAssistAuthLowPrivilege=73]="BusinessAssistAuthLowPrivilege",e[e.AzureResourceManager=74]="AzureResourceManager",e[e.AlchemyPortal=75]="AlchemyPortal",e[e.VivaUserSkillsApp=76]="VivaUserSkillsApp",e[e.VivaEngageAppPop=77]="VivaEngageAppPop",e[e.SubstrateAppOnly=78]="SubstrateAppOnly",e[e.PowerAutomateFlowCreationLowPrivilege=79]="PowerAutomateFlowCreationLowPrivilege",e[e.PowerAutomateConnectionCreationLowPrivilege=80]="PowerAutomateConnectionCreationLowPrivilege",e[e.PowerAutomateAuthorizeConnectionLowPrivilege=81]="PowerAutomateAuthorizeConnectionLowPrivilege",e[e.TCAAppPop=82]="TCAAppPop",e[e.BusinessAssistAuthAppPop=83]="BusinessAssistAuthAppPop",e[e.HolmesApp=84]="HolmesApp",e[e.GraphAppOnly=85]="GraphAppOnly",e[e.SimsApp=86]="SimsApp",e[e.VivaOrgInsightsLowPrivilege=87]="VivaOrgInsightsLowPrivilege",e[e.VivaGoalsAppPop=88]="VivaGoalsAppPop",e[e.GCBotAppPop=89]="GCBotAppPop",e[e.ShredderV2App=90]="ShredderV2App",e[e.ShredderV2LowPrivilege=91]="ShredderV2LowPrivilege",e[e.AmplifyProfileService=92]="AmplifyProfileService",e[e.AzureDevopsLowPrivilege=93]="AzureDevopsLowPrivilege",e[e.CommuteServices=94]="CommuteServices",e[e.GCBotAppOnly=95]="GCBotAppOnly",e[e.TCAAppOnly=96]="TCAAppOnly",e[e.MavenAgentLowPrivilege=97]="MavenAgentLowPrivilege",e[e.VivaOrgInsightsAppPop=98]="VivaOrgInsightsAppPop",e[e.EduAssignmentsPftAtPop=99]="EduAssignmentsPftAtPop",e[e.AugloopAppPop=100]="AugloopAppPop",e[e.OneNoteLowPrivilege=101]="OneNoteLowPrivilege",e[e.TeamsAuthzSvcAppPop=102]="TeamsAuthzSvcAppPop",e[e.LoopAppPop=103]="LoopAppPop",e[e.LoopAppOnly=104]="LoopAppOnly",e[e.BapLowPrivilege=105]="BapLowPrivilege",e[e.IC3AppPop=106]="IC3AppPop",e[e.PowerPlatformApiGateway=107]="PowerPlatformApiGateway",e[e.OdspNotifyAppPop=108]="OdspNotifyAppPop",e[e.MIPSyncService=109]="MIPSyncService",e[e.RightsManagementServices=110]="RightsManagementServices",e[e.TCAV2AppPop=111]="TCAV2AppPop",e[e.SubstrateLLMLowPrivilege=112]="SubstrateLLMLowPrivilege",e[e.SubstrateSearchLowPrivilege=113]="SubstrateSearchLowPrivilege",e[e.CloudPolicyServiceAppPop=114]="CloudPolicyServiceAppPop",e[e.TCAV2LowPrivilege=115]="TCAV2LowPrivilege",e[e.AiHubServicesAppPop=116]="AiHubServicesAppPop",e[e.TMRAppOnly=117]="TMRAppOnly",e[e.PacmanAppPop=118]="PacmanAppPop",e[e.AugloopAlternativeIdentity=119]="AugloopAlternativeIdentity",e[e.SpoAppOnly=120]="SpoAppOnly",e[e.DataverseLowPrivilege=121]="DataverseLowPrivilege",e[e.SubstrateLLMApp=122]="SubstrateLLMApp",e[e.SimsAppOnly=123]="SimsAppOnly",e[e.PythonService=124]="PythonService",e[e.PythonServiceAppOnly=125]="PythonServiceAppOnly",e[e.DesignerAppServiceLowPrivilege=126]="DesignerAppServiceLowPrivilege",e[e.DesignerAppServiceAppPop=127]="DesignerAppServiceAppPop",e[e.AmplifyProfileServiceAppOnly=128]="AmplifyProfileServiceAppOnly",e[e.MARSAppPop=129]="MARSAppPop",e[e.PlannerAppPop=130]="PlannerAppPop",e[e.BingForBusinessLowPrivilege=131]="BingForBusinessLowPrivilege",e[e.OLS=132]="OLS",e[e.OLSAppPop=133]="OLSAppPop",e[e.GCS=134]="GCS",e[e.AugLoopConsumer=135]="AugLoopConsumer",e[e.ContentValidationServiceAppOnly=136]="ContentValidationServiceAppOnly",e[e.FabricLowPrivilege=137]="FabricLowPrivilege",e[e.FeatureAccessManagementAppPop=138]="FeatureAccessManagementAppPop",e[e.FireIntelligenceAppOnly=139]="FireIntelligenceAppOnly",e[e.MARSLowPrivilege=140]="MARSLowPrivilege",e[e.EXOAdminAppPop=141]="EXOAdminAppPop",e[e.IncomingAT=142]="IncomingAT",e[e.CopilotLabLowPrivilege=143]="CopilotLabLowPrivilege",e[e.VivaPulseLowPrivilege=144]="VivaPulseLowPrivilege",e[e.WacAppPop=145]="WacAppPop",e[e.PowerAppsAiBuilderLowPrivilege=146]="PowerAppsAiBuilderLowPrivilege",e[e.CognitiveApiAppOnly=147]="CognitiveApiAppOnly",e[e.CopilotMetricsAppOnly=148]="CopilotMetricsAppOnly",e[e.ShredderAppOnly=149]="ShredderAppOnly",e[e.TeamsAuthzSvcLowPrivilege=150]="TeamsAuthzSvcLowPrivilege",e[e.PlannerLowPrivilege=151]="PlannerLowPrivilege",e[e.VivaGlintLowPrivilege=152]="VivaGlintLowPrivilege",e[e.DiscoveryServiceAppPop=153]="DiscoveryServiceAppPop",e[e.PowerAppsOrchardLowPrivilege=154]="PowerAppsOrchardLowPrivilege",e[e.EduSkillingPlatformPftAtPop=155]="EduSkillingPlatformPftAtPop",e[e.IncomingPFTAppOnly=156]="IncomingPFTAppOnly",e[e.EduSkillingPlatformLowPrivilege=157]="EduSkillingPlatformLowPrivilege",e[e.MCPSAppOnly=158]="MCPSAppOnly",e[e.TeamsMiddleTierLowPrivilege=159]="TeamsMiddleTierLowPrivilege",e[e.SharePointESignatureAppPop=160]="SharePointESignatureAppPop",e[e.SparkContentPlatformAppOnly=161]="SparkContentPlatformAppOnly",e[e.LuminaLowPrivilege=162]="LuminaLowPrivilege",e[e.OfficeScriptsServiceAppPop=163]="OfficeScriptsServiceAppPop",e[e.OfficeScriptsServiceLowPrivilege=164]="OfficeScriptsServiceLowPrivilege"}(o||(o={})),function(e){e[e.Unknown=0]="Unknown",e[e.Consumer=1]="Consumer",e[e.Enterprise=2]="Enterprise"}(n||(n={})),function(e){e[e.Default=0]="Default",e[e.EDPSCompliant=1]="EDPSCompliant"}(i||(i={})),function(e){e.AuthorizationCode="authorization_code",e.ClientCredentials="client_credentials",e.RefreshToken="refresh_token"}(a||(a={})),function(e){e[e.LoggedIn=0]="LoggedIn",e[e.LoggedOut=1]="LoggedOut"}(r||(r={}))},373502:function(e,t,s){var o=this&&this.__createBinding||(Object.create?function(e,t,s,o){void 0===o&&(o=s);var n=Object.getOwnPropertyDescriptor(t,s);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,o,n)}:function(e,t,s,o){void 0===o&&(o=s),e[o]=t[s]}),n=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||o(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),t.SequencedValueTracker=t.completePromiseWithin=t.getOffsetAndDurationInMs=t.AudioStreamPerfTracker=void 0;var i=s(61431);Object.defineProperty(t,"AudioStreamPerfTracker",{enumerable:!0,get:function(){return i.AudioStreamPerfTracker}}),Object.defineProperty(t,"getOffsetAndDurationInMs",{enumerable:!0,get:function(){return i.getOffsetAndDurationInMs}});var a=s(601869);Object.defineProperty(t,"completePromiseWithin",{enumerable:!0,get:function(){return a.completePromiseWithin}});var r=s(457482);Object.defineProperty(t,"SequencedValueTracker",{enumerable:!0,get:function(){return r.SequencedValueTracker}}),n(s(650408),t)},376305:(e,t,s)=>{var o,n,i,a,r,c,l,u,p,g;s.d(t,{E6:()=>a,Nm:()=>l,O2:()=>r,ck:()=>u}),function(e){e.Unknown="Unknown",e.File="File",e.Folder="Folder",e.Attachment="Attachment",e.Link="Link"}(o||(o={})),function(e){e.Unknown="Unknown",e.SharepointOnline="SharepointOnline",e.ModernAttachment="ModernAttachment",e.ClassicAttachment="ClassicAttachment",e.EmailLink="EmailLink",e.OneDriveForBusiness="OneDriveForBusiness"}(n||(n={})),function(e){e.Unknown="Unknown",e.DownloadableUrl="DownloadableUrl",e.ReaderUrl="ReaderUrl"}(i||(i={})),function(e){e.Person="Person",e.Group="Group",e.Other="Other"}(a||(a={})),function(e){e.OrganizationUser="OrganizationUser",e.OrganizationContact="OrganizationContact",e.PersonalContact="PersonalContact",e.ImplicitContact="ImplicitContact",e.ChatImplicitContact="ChatImplicitContact",e.Room="Room",e.Guest="Guest",e.UnifiedGroup="UnifiedGroup",e.PublicDistributionList="PublicDistributionList",e.PersonalDistributionList="PersonalDistributionList"}(r||(r={})),function(e){e.None="None",e.Organizer="Organizer",e.TentativelyAccepted="TentativelyAccepted",e.Accepted="Accepted",e.Declined="Declined",e.NotResponded="NotResponded"}(c||(c={})),function(e){e.Membership="Membership",e.Address="Address",e.Invalid="Invalid"}(l||(l={})),function(e){e.Message="Message",e.Email="Email",e.Conversation="Conversation",e.Document="Document",e.Keywords="Keywords",e.People="People",e.Bookmark="Bookmark",e.Building="Building",e.EditorialQnA="EditorialQnA",e.Floorplan="Floorplan",e.Flight="Flight",e.Acronym="Acronym",e.TuringQnA="TuringQnA",e.Task="Task",e.External="External",e.Topic="Topic",e.MeetingCatchUp="MeetingCatchUp",e.MeetingProposal="MeetingProposal",e.MeetingRoomProposal="MeetingRoomProposal",e.Report="Report",e.Streams="Streams",e.Group="Group",e.Site="Site",e.Team="Team",e.Chat="Chat",e.Channel="Channel",e.Link="Link",e.EmployeeOffer="EmployeeOffer",e.Fact="Fact",e.Text="Text",e.Event="Event",e.File="File",e.SharePoint="SharePoint",e.Attachment="Attachment",e.PIM="PIM",e.MessageExtensionApp="MessageExtensionApp",e.Scope="Scope",e.TranscriptLlmAnswer="TranscriptLlmAnswer",e.Prompt="Prompt",e.PeopleInGroup="PeopleInGroup",e.App="App"}(u||(u={})),function(e){e.Off="Off",e.Forward="Forward",e.Reverse="Reverse"}(p||(p={})),function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning"}(g||(g={}))},379422:(e,t,s)=>{s.d(t,{DE:()=>a,aO:()=>r,qO:()=>i});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_ExcelCopilot_ExcelCopilotOdslSignal"}static getBaseTypes(){return["AugLoop_CopilotOdsl_CopilotOdslSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_ExcelCopilot_ExcelCopilotInputSignal"}static getBaseTypes(){return["AugLoop_Copilot_CopilotInputSignal","AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_ExcelCopilot_ExcelCopilotProgramResponseSignal"}static getBaseTypes(){return["AugLoop_Copilot_CopilotProgramResponseSignal","AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_ExcelCopilot_ExcelHandoffMessageId"}static getBaseTypes(){return["AugLoop_HandoffSkill_HandoffMessageId","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},383129:(e,t,s)=>{s.d(t,{K:()=>n});var o=s(937410);const n=(e,t)=>{var s,n;const i=new o.I({operationName:e,success:!0,resultDescription:"",ariaTenant:"71cc1046851042108843d90e5d3ef6c1-61e5de5c-238c-4de5-95de-3b40d20ea6e5-6899",ariaNamespace:"Oa_Client"});return i.setClientMetadata(null==t?void 0:t.clientMetadata),i.setUserContext(null==t?void 0:t.userContext),i.setDataFields({contextId:null===(n=null===(s=null==t?void 0:t.model)||void 0===s?void 0:s.scopeItem)||void 0===n?void 0:n.getContextId()}),i}},383340:(e,t,s)=>{s.d(t,{A9:()=>a,XO:()=>i,aG:()=>r});var o=s(444954);const n=new(s(409273).O);class i{constructor(){this._isCancellationRequested=!1,this.onCancelCallbacks=[]}cancel(){if(!this._isCancellationRequested){this._isCancellationRequested=!0;for(const e of this.onCancelCallbacks)e(this);this.onCancelCallbacks=[]}}get IsCancellationRequested(){return this._isCancellationRequested}onCancel(e){this._isCancellationRequested?e(this):this.onCancelCallbacks.push(e)}rejectWhenCancellationRequested(){return new Promise(((e,t)=>{this.onCancel((()=>t(new o._b("Token cancelled"))))}))}removeCancelCallback(e){const t=this.onCancelCallbacks.indexOf(e);t>-1&&this.onCancelCallbacks.splice(t,1)}dispose(){this.onCancelCallbacks=[]}}class a{constructor(e){this.internalToken=new i,this.clearScheduledCancel=null,this.scheduler=null!=e?e:n}get token(){return this.internalToken}cancel(){var e;this.internalToken.IsCancellationRequested||(this.internalToken.cancel(),null===(e=this.clearScheduledCancel)||void 0===e||e.call(this))}cancelAfter(e){var t;if(this.token.IsCancellationRequested)return;if(e<0)throw new Error("Duration can not be negative");null===(t=this.clearScheduledCancel)||void 0===t||t.call(this);const s=this.scheduler.executeAfter((()=>{this.cancel(),this.clearScheduledCancel=null}),e);this.clearScheduledCancel=()=>{s(),this.clearScheduledCancel=null}}dispose(){var e;this.internalToken&&(null===(e=this.clearScheduledCancel)||void 0===e||e.call(this),this.internalToken.dispose(),this.internalToken=null)}}class r{constructor(...e){this.innerCancelSource=new a,this.unsubscribeFromTokens=null,this.onLinkedTokenCancelled=()=>{var e;this.innerCancelSource.cancel(),null===(e=this.unsubscribeFromTokens)||void 0===e||e.call(this)},this.subscribeToTokens(e)}get token(){return this.innerCancelSource.token}dispose(){var e;null===(e=this.unsubscribeFromTokens)||void 0===e||e.call(this)}subscribeToTokens(e){e.some((e=>e.IsCancellationRequested))?this.innerCancelSource.cancel():(e.forEach((e=>e.onCancel(this.onLinkedTokenCancelled))),this.unsubscribeFromTokens=()=>{this.unsubscribeFromTokens=null,e.forEach((e=>e.removeCancelCallback(this.onLinkedTokenCancelled)))})}}},384169:(e,t,s)=>{s.d(t,{Dv:()=>r,lL:()=>a,sG:()=>i});var o=s(596498);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_ExcelIntelligence_GeneratedFormulaSuggestion"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_ExcelIntelligence_ExtendedFormulaSuggestion"}static getBaseTypes(){return["AugLoop_ExcelIntelligence_GeneratedFormulaSuggestion","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_ExcelIntelligence_CalculatedColumnSuggestion"}static getBaseTypes(){return["AugLoop_ExcelIntelligence_GeneratedFormulaSuggestion","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_ExcelIntelligence_CalculatedCellSuggestion"}static getBaseTypes(){return["AugLoop_ExcelIntelligence_GeneratedFormulaSuggestion","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},388498:(e,t,s)=>{s.d(t,{I9:()=>n,c7:()=>a,ep:()=>i});var o=s(596498),n=(function(){function e(t){o.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ControlSignal"},e.getBaseTypes=function(){return["AugLoop_Signals_Signal"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_InteractionModeSignal"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ControlSignal","AugLoop_Signals_Signal"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),i=function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_StartupSignal"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ControlSignal","AugLoop_Signals_Signal"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),a=function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ClientConfigSignal"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ControlSignal","AugLoop_Signals_Signal"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();!function(){function e(t){o.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ShutdownSignal"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ControlSignal","AugLoop_Signals_Signal"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}()},408295:(e,t,s)=>{s.d(t,{P:()=>n});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_CopilotWarmup_CopilotGetUserContextSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},409273:(e,t,s)=>{s.d(t,{O:()=>o});class o{executeAfter(e,t){let s=setTimeout((()=>{s=null,e()}),t);return()=>{null!==s&&(clearTimeout(s),s=null)}}}},410972:(e,t,s)=>{var o;s.d(t,{A:()=>o}),function(e){e.Dictation="Dictation",e.Transcription="Transcription",e.ConversationTranscription="ConversationTranscription",e.Rehearsal="Rehearsal",e.Subtitle="Subtitle"}(o||(o={}))},413431:(e,t,s)=>{s.d(t,{In:()=>u,e3:()=>a,el:()=>c,kQ:()=>l});var o=s(937410),n=s(599243),i=s(497601);function a(){return globalThis&&!globalThis.top&&(globalThis.top={}),null===globalThis||void 0===globalThis?void 0:globalThis.top}function r(e,t){e.src=t}function c(e,t,s,a,c){const l=new o.I({operationName:"CreateOnnxInferenceService",success:!0,resultDescription:""});if(l.start(),(0,i.fE)(l)){const e="Browser lacks necessary support for inference service";return l.success=!1,l.resultDescription=e,n.tG.info(540406803,n.nh.CoreDefault,l.stop()),Promise.reject(new Error(e))}return new Promise(((o,n)=>{if("undefined"!=typeof document){const i=document.createElement("script");(c||r)(i,e),i.onload=()=>{p(t,s)?(a&&(t()[s].env.wasm.wasmPaths=a),o()):(i.remove(),n(new Error("ort.Tensor and/or ort.InferenceSession are undefined")))},i.onerror=n,document.body.appendChild(i)}else globalThis.importScripts?(globalThis.importScripts(e),globalThis[s]=self[s],p(t,s)?(a&&(t()[s].env.wasm.wasmPaths=a),o()):n(new Error("ort.Tensor and/or ort.InferenceSession are undefined"))):n(new Error("Unexpected lack of document and importScripts"))})).then((()=>{n.tG.info(540406804,n.nh.CoreDefault,l.stop())})).catch((e=>{throw l.success=!1,l.resultDescription=e.message,n.tG.info(509871835,n.nh.CoreDefault,l.stop()),e}))}function l(e,t,s){return i.Kx.create(e,t,s)}function u(){return i.G0.create()}function p(e,t){const s=globalThis[t];if(s&&s.InferenceSession&&s.Tensor){const o=e();return o&&!o[t]&&(o[t]=s),!0}return!1}},414190:(e,t,s)=>{var o,n,i;s.d(t,{HS:()=>i,OD:()=>n,WI:()=>o}),function(e){e[e.Add=0]="Add",e[e.Delete=1]="Delete",e[e.Update=2]="Update",e[e.CursorUpdate=3]="CursorUpdate",e[e.FormattingUpdate=4]="FormattingUpdate",e[e.OtherNonContentUpdate=5]="OtherNonContentUpdate",e[e.AttributionUpdate=6]="AttributionUpdate"}(o||(o={})),function(e){e[e.Chars=0]="Chars",e[e.Word=1]="Word",e[e.PartialSentence=2]="PartialSentence",e[e.Sentence=3]="Sentence",e[e.Paragraph=4]="Paragraph"}(n||(n={})),function(e){e[e.SessionUser=0]="SessionUser",e[e.Programmatic=1]="Programmatic",e[e.Collaborator=2]="Collaborator"}(i||(i={}))},416135:(e,t,s)=>{var o;s.d(t,{m:()=>o}),function(e){e.FormulaGenerationSkill="FormulaGenerationSkill",e.NonODSLFormulaGenerationSkill="NonODSLFormulaGenerationSkill",e.UnifiedNLToFormulaGenerationSkill="UnifiedNLToFormulaGenerationSkill"}(o||(o={}))},421649:(e,t)=>{var s,o,n,i,a,r,c,l,u,p,g,h,d,m,y,T,f,_,C,S,A,v,N,E,I,w,b,k,M,L,B,D,P,R,O,x,F,G,W,H,U,q,V,$,j,z;t.n3=t.nC=void 0,function(e){e[e.Read=0]="Read",e[e.ReadMetadata=1]="ReadMetadata",e[e.Create=2]="Create"}(s||(s={})),function(e){e.PowerPoint="PowerPoint",e.Excel="Excel",e.Word="Word",e.OneNote="OneNote",e.Outlook="Outlook",e.Teams="Teams",e.Event="Event",e.Meeting="Meeting",e.TeamsMeeting="TeamsMeeting",e.TeamsQueues="TeamsQueues",e.SharePoint="SharePoint",e.Web="Web",e.PDF="PDF",e.Zip="Zip",e.HTML="HTML",e.Visio="Visio",e.Image="Image",e.Fluid="Fluid",e.Video="Video",e.Vector="Vector",e.Txt="Txt",e.ThirdParty="ThirdParty",e.Topic="Topic",e.Loop="Loop",e.Planner="Planner"}(o||(o={})),function(e){e[e.ChatResponse=0]="ChatResponse",e[e.GetMessagesResponse=1]="GetMessagesResponse",e[e.GetConversationResponse=2]="GetConversationResponse",e[e.GetSharedMessagesResponse=3]="GetSharedMessagesResponse",e[e.CopyConversationResponse=4]="CopyConversationResponse",e[e.SerpCachedResponse=5]="SerpCachedResponse",e[e.CaptchaResponse=6]="CaptchaResponse"}(n||(n={})),function(e){e.Default="Default",e.Early="Early",e.OnUse="OnUse",e.Never="Never"}(i||(i={})),function(e){e[e.None=0]="None",e[e.Allow=1]="Allow",e[e.AlwaysAllow=2]="AlwaysAllow",e[e.Deny=3]="Deny"}(a||(a={})),function(e){e.Quiet="0",e.Verbose="1"}(r||(r={})),function(e){e.TurnBased="turnbased",e.Realtime="realtime",e.All="all"}(c||(c={})),function(e){e.Full="Full",e.Concise="Concise",e.ConciseWithPadding="ConciseWithPadding"}(l||(l={})),function(e){e.Text="text",e.Video="video",e.Voice="voice"}(u||(u={})),function(e){e.Unknown="Unknown",e.TeamsToolKit="TeamsToolKit",e.CopilotStudioFamily="CopilotStudioFamily",e.SharePoint="SharePoint",e.CopilotStudio="CopilotStudio",e.EmbeddedCopilotStudio="EmbeddedCopilotStudio",e.Notebook="Notebook"}(p||(p={})),function(e){e.WordDraftingAgent="WordDraftingAgent"}(g||(g={})),function(e){e.SharePoint="SharePoint",e.OneDrive="OneDrive",e.DeepResearch="DeepResearch",e.GraphicArt="GraphicArt",e.CodeInterpreter="CodeInterpreter",e.WebSearch="WebSearch",e.OneDriveAndSharePoint="OneDriveAndSharePoint",e.GraphConnectors="GraphConnectors",e.TeamsMessages="TeamsMessages",e.Dataverse="Dataverse",e.RegisteredPlugins="RegisteredPlugins",e.Email="Email",e.BizchatExperimental="BizchatExperimental",e.People="People",e.DeepResearchWork="DeepResearchWork",e.ScenarioModels="ScenarioModels",e.Pages="Pages",e.DeepInsightsViaCodeExecution="DeepInsightsViaCodeExecution",e.EmbeddedKnowledge="EmbeddedKnowledge",e.FirstPartyAgent="FirstPartyAgent",e.Meetings="Meetings",e.EnterpriseGrounding="EnterpriseGrounding",e.Photo="Photo",e.WorkSearch="WorkSearch",e.ServiceDRI="ServiceDRI",e.ComputerUse="ComputerUse"}(h||(h={})),function(e){e.Unknown="Unknown",e.Success="Success",e.InternalError="InternalError",e.InvalidSession="InvalidSession",e.ConfigurationError="ConfigurationError",e.InvalidRequest="InvalidRequest",e.ProcessingMessage="ProcessingMessage",e.UnauthorizedRequest="UnauthorizedRequest",e.UnexpectedError="UnexpectedError",e.Canceled="Canceled",e.CaptchaChallenge="CaptchaChallenge",e.Throttled="Throttled",e.NotFound="NotFound",e.NoResponseReturned="NoResponseReturned",e.ThrottledByLLM="ThrottledByLLM",e.NoResponseText="NoResponseText",e.ApologyResponseReturned="ApologyResponseReturned",e.NoValidMessageTypePresentInBotResponse="NoValidMessageTypePresentInBotResponse",e.ServiceNotEnabled="ServiceNotEnabled",e.ContentForbidden="ContentForbidden",e.ContentNotFound="ContentNotFound",e.InvalidLicense="InvalidLicense",e.NotEnoughContext="NotEnoughContext",e.OutOfCredits="OutOfCredits",e.VoiceSystemSignal="VoiceSystemSignal"}(d||(d={})),function(e){e.Success="Success",e.Failure="Failure",e.Pending="Pending",e.BotTurnStarting="BotTurnStarting"}(m||(m={})),function(e){e.Audio="audio",e.Text="text"}(y||(y={})),function(e){e.SearchWeb="SearchWeb",e.EnterpriseFileSearch="EnterpriseFileSearch",e.CodeInterpreter="CodeInterpreter"}(T||(T={})),function(e){e.Error="Error",e.Warning="Warning"}(f||(f={})),function(e){e[e.None=0]="None",e[e.MessagesDeleted=1]="MessagesDeleted"}(_||(_={})),function(e){e.MissingName="MissingName",e.TooLongName="TooLongName",e.InvalidCharacterInName="InvalidCharacterInName",e.MissingDescription="MissingDescription",e.TooLongDescription="TooLongDescription",e.InvalidCharacterInDescription="InvalidCharacterInDescription",e.MissingInstructions="MissingInstructions",e.TooLongInstructions="TooLongInstructions",e.InvalidCharacterInInstructions="InvalidCharacterInInstructions",e.InvalidIconUrl="InvalidIconUrl",e.InvalidGptId="InvalidGptId",e.TooManyConversationStarters="TooManyConversationStarters",e.InvalidCharacterInConversationStarter="InvalidCharacterInConversationStarter",e.InvalidConversationStarterImageUrl="InvalidConversationStarterImageUrl",e.TooLongConversationStarter="TooLongConversationStarter",e.MissingPluginShortName="MissingPluginShortName",e.TooLongShortName="TooLongShortName",e.InvalidCharacterInShortName="InvalidCharacterInShortName",e.MissingPluginLongName="MissingPluginLongName",e.TooLongLongName="TooLongLongName",e.InvalidCharacterInLongName="InvalidCharacterInLongName",e.MissingPluginShortDescription="MissingPluginShortDescription",e.TooLongShortDescription="TooLongShortDescription",e.InvalidCharacterInShortDescription="InvalidCharacterInShortDescription",e.MissingPluginFullDescription="MissingPluginFullDescription",e.TooLongFullDescription="TooLongFullDescription",e.InvalidCharacterInFullDescription="InvalidCharacterInFullDescription",e.MissingPluginFunction="MissingPluginFunction",e.MissingFunctionId="MissingFunctionId",e.TooLongFunctionId="TooLongFunctionId",e.InvalidCharacterInFunctionId="InvalidCharacterInFunctionId",e.MissingFunctionTitle="MissingFunctionTitle",e.TooLongFunctionTitle="TooLongFunctionTitle",e.InvalidCharacterInFunctionTitle="InvalidCharacterInFunctionTitle",e.MissingFunctionDescription="MissingFunctionDescription",e.TooLongFunctionDescription="TooLongFunctionDescription",e.InvalidCharacterInFunctionDescription="InvalidCharacterInFunctionDescription",e.MissingParameterName="MissingParameterName",e.TooLongParameterName="TooLongParameterName",e.InvalidCharacterInParameterName="InvalidCharacterInParameterName",e.MissingParameterDescription="MissingParameterDescription",e.TooLongParameterDescription="TooLongParameterDescription",e.InvalidCharacterInParameterDescription="InvalidCharacterInParameterDescription",e.MissingParameterTitle="MissingParameterTitle",e.TooLongParameterTitle="TooLongParameterTitle",e.InvalidCharacterInParameterTitle="InvalidCharacterInParameterTitle",e.InvalidTeamsMessagesCapabilityUrl="InvalidTeamsMessagesCapabilityUrl",e.OffensiveContent="OffensiveContent",e.Jailbreak="Jailbreak",e.RAIViolation="RAIViolation"}(C||(C={})),function(e){e.None="None",e.Limit="Limit",e.Billing="Billing"}(S||(S={})),function(e){e.ActionMETaskModule="ActionMETaskModule",e.AuthenticationCard="AuthenticationCard",e.CodeInterpreter="CodeInterpreter",e.ConfirmationCard="ConfirmationCard",e.GraphicArt="GraphicArt",e.MultiMessageResponse="MultiMessageResponse"}(A||(A={})),function(e){e.User="User",e.Tenant="Tenant",e.System="System"}(v||(v={})),function(e){e.Unknown="Unknown",e.User="User",e.Tenant="Tenant",e.System="System"}(N||(N={})),function(e){e.Active="Active",e.Draft="Draft",e.Deleted="Deleted",e.Blocked="Blocked"}(E||(E={})),function(e){e.Bot="bot",e.User="user",e.System="system"}(I||(t.nC=I={})),function(e){e.AnnRules="AnnRules",e.Apology="Apology",e.BingContent="Bing Content",e.Chitchat="Chitchat",e.NluDirectResponse="NluDirectResponse",e.Qna="Qna",e.TopicChanger="TopicChanger",e.Delighterdluni="Delighterdluni",e.DeepLeo="DeepLeo",e.TransformContent="transform_content",e.LocalPluginRunner="local-plugin-runner",e.ImageChat="image-chat",e.GenerateResponse="generate_response"}(w||(w={})),function(e){e.Image="IMAGE"}(b||(b={})),function(e){e.WebPage="WebPage",e.ClientApp="ClientApp"}(k||(k={})),function(e){e.None="None",e.Positive="Positive",e.Negative="Negative",e.Laugh="Laugh",e.Surprised="Surprised",e.UnknownBf="UnknownBf"}(M||(M={})),function(e){e.Keyboard="Keyboard",e.Speech="Speech"}(L||(L={})),function(e){e.AudioUrl="AudioUrl",e.None="None",e.Simple="Simple",e.Ssml="Ssml"}(B||(B={})),function(e){e.ActionRequest="ActionRequest",e.Ads="Ads",e.AdsQuery="AdsQuery",e.Any="Any",e.AuthError="AuthError",e.ChatCompleted="ChatCompleted",e.CaptchaChallenge="CaptchaChallenge",e.Chat="Chat",e.ChatName="ChatName",e.ConfirmationCard="ConfirmationCard",e.Context="Context",e.Disengaged="Disengaged",e.SearchQuery="SearchQuery",e.Internal="Internal",e.InvokeAction="InvokeAction",e.Suggestion="Suggestion",e.InternalSuggestions="InternalSuggestions",e.InternalSearchResult="InternalSearchResult",e.InternalSearchQuery="InternalSearchQuery",e.InternalReasoningSearchResult="InternalReasoningSearchResult",e.InternalActionMarker="InternalActionMarker",e.InternalStateMarker="InternalStateMarker",e.InternalLoaderMessage="InternalLoaderMessage",e.Progress="Progress",e.GenerateContentQuery="GenerateContentQuery",e.GeneratedCode="GeneratedCode",e.RenderCardRequest="RenderCardRequest",e.RequireHumanInTheLoop="RequireHumanInTheLoop",e.SemanticSerp="SemanticSerp",e.ResumePluginAuth="ResumePluginAuth",e.TriggerPluginAuth="TriggerPluginAuth",e.ResumeInvokeAction="ResumeInvokeAction",e.TriggerConfirmation="TriggerConfirmation",e.InternalContentDescription="InternalContentDescription",e.TriggerPlugin="TriggerPlugin",e.CompletePlugin="CompletePlugin",e.AttachmentAction="AttachmentAction"}(D||(t.n3=D={})),new Set([D.Chat,D.ChatCompleted,D.Disengaged,D.RenderCardRequest,D.RequireHumanInTheLoop]),function(e){e.IncomingBotResponse=void 0}(D||(t.n3=D={})),function(e){e.Blank="BLANK",e.BingFrontPageSkill="BING_FRONT_PAGE_SKILL",e.BingSkill="BING_SKILL",e.Chitchat="CHITCHAT",e.Infoseeking="INFOSEEKING",e.InitialBingFrontPageSkill="INITIAL_BING_FRONT_PAGE_SKILL",e.InitialQNA="INITIAL_QNA",e.InitialVideos="INITIAL_VIDEOS",e.InitialWebpages="INITIAL_WEBPAGES",e.MedicalHealth="MEDICAL_HEALTH",e.MicrosoftBrands="MICROSOFT_BRANDS",e.NeedEmpathy="NEED_EMPATHY",e.Offensive="OFFENSIVE",e.OpinionGiving="OPINION_GIVING",e.OpinionSeeking="OPINION_SEEKING",e.OUTOFDomain="OUT_OF_DOMAIN",e.QNA="QNA",e.SettingsChange="SETTINGS_CHANGE",e.SettingsCheck="SETTINGS_CHECK",e.SuicideHelp="SUICIDE_HELP",e.TuringBOTSafe="TURING_BOT_SAFE",e.Unhandled="UNHANDLED",e.Videos="VIDEOS",e.Webpages="WEBPAGES"}(P||(P={})),function(e){e.Amount="AMOUNT",e.Setting="SETTING",e.Type="TYPE",e.Unknown="UNKNOWN",e.Unit="UNIT",e.Value="VALUE"}(R||(R={})),function(e){e.Unknown="Unknown",e.None="None",e.Offensive="Offensive",e.OffenseTrigger="OffenseTrigger",e.OffenseResponse="OffenseResponse",e.Blocklist="Blocklist"}(O||(O={})),function(e){e.Finished="FINISHED",e.Intermediate="INTERMEDIATE",e.FinishedAwaitingCommit="FINISHED_AWAITING_COMMIT"}(x||(x={})),function(e){e.General="General",e.Internal="Internal"}(F||(F={})),function(e){e.Testing="Testing",e.AdminCenterCopilot="AdminCenterCopilot",e.AIHubAppChatCopilot="AIHubAppChatCopilot",e.AIHubBrowseCopilot="AIHubBrowseCopilot",e.AIHubHome="AIHubHome",e.Assist365Copilot="Assist365Copilot",e.BizChatScheduledActions_MacOutlookHub="BizChatScheduledActions_MacOutlookHub",e.BizChatScheduledActions_MonarchHub="BizChatScheduledActions_MonarchHub",e.BizChatScheduledActions_OfficeDesktop="BizChatScheduledActions_OfficeDesktop",e.BizChatScheduledActions_OfficeWeb="BizChatScheduledActions_OfficeWeb",e.BizChatScheduledActions_OwaHub="BizChatScheduledActions_OwaHub",e.BizChatScheduledActions_TeamsHub="BizChatScheduledActions_TeamsHub",e.BizChatScheduledActions_Win32OutlookHub="BizChatScheduledActions_Win32OutlookHub",e.CopilotClips="CopilotClips",e.ExcelCopilot="ExcelCopilot",e.ExcelCopilotConsumer="ExcelCopilotConsumer",e.ExcelCopilotConsumerOSv2="ExcelCopilotConsumerOSv2",e.ExchangeAdminCenterCopilot="ExchangeAdminCenterCopilot",e.FormsCopilot="FormsCopilot",e.LoopCopilot="LoopCopilot",e.LoopCopilotOnCanvas="LoopCopilotOnCanvas",e.ODSPCopilot="ODSPCopilot",e.OfficeAiAppIncubation="OfficeAiAppIncubation",e.OfficeCopilotSearchAnswer="OfficeCopilotSearchAnswer",e.OfficePersonalAgentsCopilot="OfficePersonalAgentsCopilot",e.OneNoteCopilot="OneNoteCopilot",e.OneNoteCopilotConsumer="OneNoteCopilotConsumer",e.OneNoteCopilotConsumerOSv2="OneNoteCopilotConsumerOSv2",e.OperaWordCopilot="OperaWordCopilot",e.OutlookCopilot="OutlookCopilot",e.OutlookCopilotBizchatBase="OutlookCopilotBizchatBase",e.OutlookCopilotConsumerOSv2="OutlookCopilotConsumerOSv2",e.OutlookSearchChatCopilot="outlooksearchchatcopilot",e.PodcastCopilot="PodcastCopilot",e.PPTCopilot="PPTCopilot",e.PPTCopilotConsumer="PPTCopilotConsumer",e.PPTCopilotConsumerOSv2="PPTCopilotConsumerOSv2",e.PPTOnCanvasCopilot="PPTOnCanvasCopilot",e.PlannerCopilot="PlannerCopilot",e.SharePointAdminCenterCopilot="SharePointAdminCenterCopilot",e.SharepointAuthoringCopilot="SharepointAuthoringCopilot",e.StreamCopilot="StreamCopilot",e.TeamsAdminCenterCopilot="TeamsAdminCenterCopilot",e.TeamsChatAgentCopilot="TeamsChatAgentCopilot",e.TeamsQueuesIntelligence="TeamsQueuesIntelligence",e.TeamsChatCopilot="TeamsChatCopilot",e.TeamsMessagesSerpAICopilot="TeamsMessagesSerpAICopilot",e.TeamsSerpCopilot="TeamsSerpCopilot",e.TeamsGroupCopilot="TeamsGroupCopilot",e.TeamsMeetingCopilot="teamsmeetingcp",e.TeamsMeetingGroupCopilot="TeamsMeetingGroupCopilot",e.TeamsWorkflowsCopilotActions="TeamsWorkflowsCopilotActions",e.VivaCopilot="VivaCopilot",e.VivaEngageCopilot="VivaEngageCopilot",e.VivaGoalsCopilot="VivaGoalsCopilot",e.WhiteboardCopilotOnCanvas="WhiteboardCopilotOnCanvas",e.WordCopilot="WordCopilot",e.WordBackstageCopilot="WordBackstageCopilot",e.WordCopilotConsumer="WordCopilotConsumer",e.WordCopilotConsumerOsv2="WordCopilotConsumerOSv2",e.WordOnCanvasCopilot="WordOnCanvasCopilot",e.LegacyDefault="Default",e.RealtimeChat="AugmentationLoopRealTimeChat",e.AIHubCreateCopilot="AIHubCreateCopilot",e.OfficeCopilotNotebook="OfficeCopilotNotebook"}(G||(G={}));(function(e){e.Creative="Creative",e.Balanced="Balanced",e.Precise="Precise"})(W||(W={})),function(e){e.AppChat="appchat"}(H||(H={})),function(e){e.Default="Default",e.Reasoning="Reasoning",e.Responding="Responding"}(U||(U={})),function(e){e.AdaptiveCard="AdaptiveCard"}(q||(q={})),function(e){e[e.InternalError=-32603]="InternalError",e[e.InvalidParams=-32602]="InvalidParams",e[e.InvalidRequest=-32600]="InvalidRequest",e[e.InvocationError=-32e3]="InvocationError",e[e.InvocationErrorWithException=-32004]="InvocationErrorWithException",e[e.MethodNotFound=-32601]="MethodNotFound",e[e.NoMarshaledObjectFound=-32001]="NoMarshaledObjectFound",e[e.ParseError=-32700]="ParseError",e[e.RequestCanceled=-32800]="RequestCanceled",e[e.ResponseSerializationFailure=-32003]="ResponseSerializationFailure"}(V||(V={})),function(e){e.SUCCESS="success",e.FAILURE="failure"}($||($={})),function(e){e.AlwaysOn="AlwaysOn",e.Dynamic="Dynamic"}(j||(j={})),function(e){e.Document="document",e.Workbook="workbook",e.Presentation="presentation"}(z||(z={}))},423687:(e,t,s)=>{s.d(t,{L:()=>n});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_ObservationalAssistanceAction_EntityLabelAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_ObservationalAssistanceAction_SensitivityLabel"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},428349:(e,t,s)=>{var o,n,i,a;s.d(t,{S5:()=>n,ss:()=>i}),function(e){e.ExcelSheetReference="ExcelSheetReference",e.ExcelTableReference="ExcelTableReference",e.ExcelRangeReference="ExcelRangeReference",e.ExcelTableLikeRangeReference="ExcelTableLikeRangeReference",e.ExcelPivotTableReference="ExcelPivotTableReference",e.ExcelChartReference="ExcelChartReference"}(o||(o={})),function(e){e.Add="Add",e.Delete="Delete",e.Change="Change",e.Rename="Rename"}(n||(n={})),function(e){e.Sheet="Sheet",e.Table="Table",e.PivotTable="PivotTable",e.Range="Range",e.Chart="Chart",e.TableLikeRange="TableLikeRange"}(i||(i={})),function(e){e.RangeEdited="RangeEdited",e.RowInserted="RowInserted",e.RowDeleted="RowDeleted",e.ColumnInserted="ColumnInserted",e.ColumnDeleted="ColumnDeleted",e.CellInsertedRight="CellInsertedRight",e.CellInsertedDown="CellInsertedDown",e.CellDeletedLeft="CellDeletedLeft",e.CellDeletedUp="CellDeletedUp"}(a||(a={}))},434705:(e,t,s)=>{var o,n,i,a,r,c,l;s.d(t,{$O:()=>r,Cu:()=>n,IZ:()=>a,ZE:()=>c,jr:()=>i,kp:()=>o}),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(o||(o={})),function(e){e.AnalyzeAudio="AnalyzeAudio",e.GetBatchResult="GetBatchResult"}(n||(n={})),function(e){e[e.PowerPoint=0]="PowerPoint",e[e.Word=1]="Word",e[e.OneNote=2]="OneNote",e[e.Outlook=3]="Outlook",e[e.Unknown=4]="Unknown",e[e.LinkedIn=5]="LinkedIn",e[e.Flipgrid=6]="Flipgrid",e[e.OfficeMobie=7]="OfficeMobie",e[e.OfficeSuite=8]="OfficeSuite",e[e.Teams=9]="Teams"}(i||(i={})),function(e){e.ErrorNone="ErrorNone",e.ErrorInvalidSubscriptionFromConfig="ErrorInvalidSubscriptionFromConfig",e.ErrorInvalidRegionFromConfig="ErrorInvalidRegionFromConfig",e.ErrorAddSessionFailure="ErrorAddSessionFailure",e.ErrorCreateSpeechSessionBadRequest="ErrorCreateSpeechSessionBadRequest",e.ErrorSpeechHandlerWebSocketFailure="ErrorSpeechHandlerWebSocketFailure",e.ErrorInvalidMessage="ErrorInvalidMessage",e.ErrorWaitAudioTimeout="ErrorWaitAudioTimeout",e.ErrorInitialSilenceTimeout="ErrorInitialSilenceTimeout",e.ErrorInitialBabbleTimeout="ErrorInitialBabbleTimeout",e.ErrorProtobufDeserializationFailure="ErrorProtobufDeserializationFailure",e.ErrorSpeechRecognitionFailure="ErrorSpeechRecognitionFailure",e.ErrorTranslationFailure="ErrorTranslationFailure",e.ErrorFailedToGetSupportedTextLanguages="ErrorFailedToGetSupportedTextLanguages",e.ErrorCustomEndpointTimeout="ErrorCustomEndpointTimeout",e.ErrorAudioAbortError="ErrorAudioAbortError",e.ErrorAudioNotAllowedError="ErrorAudioNotAllowedError",e.ErrorAudioNotFoundError="ErrorAudioNotFoundError",e.ErrorAudioNotReadableError="ErrorAudioNotReadableError",e.ErrorAudioOverconstrainedError="ErrorAudioOverconstrainedError",e.ErrorAudioSecurityError="ErrorAudioSecurityError",e.ErrorAudioTypeError="ErrorAudioTypeError",e.ErrorAudioSetupFailure="ErrorAudioSetupFailure",e.ErrorAudioCaptureStalePermission="ErrorAudioCaptureStalePermission",e.ErrorConnectionRetryFailure="ErrorConnectionRetryFailure",e.ErrorWebcamSamplingUnsupportedSpeechMode="ErrorWebcamSamplingUnsupportedSpeechMode",e.ErrorWebcamSetupFailure="ErrorWebcamSetupFailure",e.ErrorWebcamNotFoundError="ErrorWebcamNotFoundError",e.ErrorMultipleWebcamsFound="ErrorMultipleWebcamsFound",e.ErrorMaxConnectionRetryFailureInSession="ErrorMaxConnectionRetryFailureInSession",e.ErrorUnknown="ErrorUnknown"}(a||(a={})),function(e){e.RehearsalDashboardUpdate="RehearsalDashboardUpdate",e.MediaEvent="MediaEvent",e.QualityStatusUpdate="QualityStatusUpdate",e.ConnectionRetry="ConnectionRetry"}(r||(r={})),function(e){e[e.None=0]="None",e[e.Listening=1]="Listening",e[e.Warning_CannotHearYou=2]="Warning_CannotHearYou",e[e.Warning_BackgroundNoise=3]="Warning_BackgroundNoise",e[e.Warning_TooLoud=4]="Warning_TooLoud",e[e.Warning_TooQuiet=5]="Warning_TooQuiet",e[e.Warning_WeakConnection=6]="Warning_WeakConnection",e[e.Warning_SlowConnection=7]="Warning_SlowConnection",e[e.Warning_UnstableConnection=8]="Warning_UnstableConnection",e[e.Warning_ServiceIssue=9]="Warning_ServiceIssue",e[e.Error_CannotHearYou=10]="Error_CannotHearYou",e[e.Error_BackgroundNoise=11]="Error_BackgroundNoise",e[e.Error_TooLoud=12]="Error_TooLoud",e[e.Error_TooQuiet=13]="Error_TooQuiet",e[e.Error_WeakConnection=14]="Error_WeakConnection",e[e.Error_SlowConnection=15]="Error_SlowConnection",e[e.Error_UnstableConnection=16]="Error_UnstableConnection",e[e.Error_ServiceIssue=17]="Error_ServiceIssue"}(c||(c={})),function(e){e.Closed="Closed",e.Closing="Closing",e.Connecting="Connecting",e.Open="Open"}(l||(l={}))},440714:(e,t,s)=>{s.d(t,{I:()=>n});const o=new(s(529510).eU)("disabledChangeGates",[]),n=(e,t,...s)=>{const n=-1===o.getValue().indexOf(e);return i(n,t,...s)},i=(e,t,...s)=>t?e?t(...s):void 0:e},441759:(e,t,s)=>{s.d(t,{k:()=>n});var o={util:{},roots:{default:{}}},n=(o.util,o.roots.default||(o.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.Name="",e.prototype.Length=0,e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/HttpSocketListEvent"},e}())},444954:(e,t,s)=>{s.d(t,{Ek:()=>a,TQ:()=>r,Xq:()=>n,_b:()=>o,m6:()=>i});class o extends Error{constructor(e){super(e),Object.setPrototypeOf(this,o.prototype)}}class n extends Error{constructor(e){super(e),Object.setPrototypeOf(this,n.prototype)}}class i extends Error{constructor(e,t){super(e),Object.setPrototypeOf(this,i.prototype),this.erroInfo=t}}class a extends Error{constructor(e){super(e),Object.setPrototypeOf(this,a.prototype)}}class r extends Error{constructor(e){super(e),Object.setPrototypeOf(this,r.prototype)}}Error},447119:(e,t,s)=>{s.d(t,{W:()=>o});class o{constructor(e){this.childCount=0,this.id=e||function(){for(let e=0;e<i;e++)a[e]=n[Math.floor(Math.random()*n.length)];return a.join("")}()}static fromString(e,t){if(!e)throw new Error("Received invalid correlation vector string");let s;return s=e.endsWith(".0")?new o(e.substring(0,e.length-2)):new o(e),t&&(s.childCount=t),s}newChild(){return++this.childCount,new o(this.id+"."+this.childCount.toString())}toString(){return this.id.length>127?this.id.substring(0,127)+"!":this.id}}const n=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],i=22,a=new Array(i)},457482:function(e,t,s){var o=this&&this.__spreadArray||function(e,t,s){if(s||2===arguments.length)for(var o,n=0,i=t.length;n<i;n++)!o&&n in t||(o||(o=Array.prototype.slice.call(t,0,n)),o[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.SequencedValueTracker=void 0;var n=s(274070),i=function(){function e(e){this.list=e?o([],e,!0):[]}return Object.defineProperty(e.prototype,"length",{get:function(){return this.list.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"keys",{get:function(){return this.list.map((function(e){return e.seq}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"values",{get:function(){return this.list.map((function(e){return e.value}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"first",{get:function(){if(0!==this.list.length)return this.list[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"last",{get:function(){if(0!==this.list.length)return this.list[this.list.length-1]},enumerable:!1,configurable:!0}),e.prototype.clear=function(){n.Log.info(528794771,n.LogCategory.WorkflowDefault,"Clearing tracked values. Old length: ".concat(this.length)),this.list=[]},e.prototype.track=function(e,t){var s=this.list.find((function(t){return t.seq===e}));if(s){if(s.value===t)return;throw new Error("Cannot double-track the same sequence: #".concat(e,"! Previous value: ").concat(s.value,", new value: ").concat(t))}var o={seq:e,value:t};if(0===this.list.length||this.last.seq<e)this.list.push(o);else{var i=this.getIndexBefore(e);this.list.splice(i+1,0,o)}n.Log.info(528794772,n.LogCategory.WorkflowDefault,"track #".concat(e,': "').concat(t,'" (new length: ').concat(this.length,")"))},e.prototype.valueAt=function(e){if(null!=e)if(0!==this.list.length){var t=this.getIndexBefore(e);if(!(t<0))return n.Log.info(528794776,n.LogCategory.WorkflowDefault,"valueAt #".concat(e," - found: "),this.list[t]),this.list[t];n.Log.info(528794775,n.LogCategory.WorkflowDefault,"valueAt #".concat(e," - found nothing prior"))}else n.Log.info(528794774,n.LogCategory.WorkflowDefault,"valueAt #".concat(e," - nothing is tracked"));else n.Log.info(528794773,n.LogCategory.WorkflowDefault,"valueAt #".concat(e," - nothing is tracked"))},e.prototype.trimUntil=function(e,t){void 0===t&&(t=!1);var s=this.getIndexBefore(e);t&&s--,n.Log.info(528794777,n.LogCategory.WorkflowDefault,"trimUntil #".concat(e," - preserveLast:").concat(t,", removing up to idx: ").concat(s)),s>=0&&this.list.splice(0,s+1)},e.prototype.getIndexBefore=function(e){for(var t=this.list.length-1;t>=0&&this.list[t].seq>e;)t--;return t},e}();t.SequencedValueTracker=i},458772:(e,t,s)=>{s.d(t,{M5:()=>n,M6:()=>c,XE:()=>r});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_OperaCopilot_OperaCopilotInputSignal"}static getBaseTypes(){return["AugLoop_Copilot_CopilotInputSignal","AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_OperaCopilot_OperaCopilotResearchInputSignal"}static getBaseTypes(){return["AugLoop_Copilot_CopilotInputSignal","AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_OperaCopilot_OperaCopilotProgramResponseSignal"}static getBaseTypes(){return["AugLoop_Copilot_CopilotProgramResponseSignal","AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_OperaCopilot_UIStateSyncSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_OperaCopilot_InvokeSkillSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_OperaCopilot_InvokeResearchSkillSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_OperaCopilot_OperaValidateGptSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()}},463192:(e,t,s)=>{s.d(t,{F:()=>n});var o={util:{},roots:{default:{}}},n=(o.util,o.roots.default||(o.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.Name="",e.prototype.Length=0,e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/HttpRequestQueueEvent"},e}())},464266:(e,t,s)=>{var o;s.d(t,{r:()=>o}),function(e){e.AnswersLlmLoopLimitHit="AnswersLlmLoopLimitHit",e.AnswersCallingElseSkill="AnswersCallingElseSkill",e.AnswersElseSkillDone="AnswersElseSkillDone",e.AnswersTooManyCells="AnswersTooManyCells"}(o||(o={}))},474655:(e,t,s)=>{var o;s.d(t,{c:()=>o}),function(e){e.Acronym="Acronym",e.Address="Address",e.Attachment="Attachment",e.Bookmark="Bookmark",e.Building="Building",e.Channel="Channel",e.Chat="Chat",e.Conversation="Conversation",e.CopilotPlugin="CopilotPlugin",e.DateTime="DateTime",e.Document="Document",e.EditorialQnA="EditorialQnA",e.Email="Email",e.EmployeeOffer="EmployeeOffer",e.Event="Event",e.External="External",e.Fact="Fact",e.File="File",e.Flight="Flight",e.Floorplan="Floorplan",e.Folder="Folder",e.Group="Group",e.Keywords="Keywords",e.Link="Link",e.LocalBusiness="LocalBusiness",e.Loop="Loop",e.MeetingCatchUp="MeetingCatchUp",e.MeetingProposal="MeetingProposal",e.MeetingRoomProposal="MeetingRoomProposal",e.Message="Message",e.MessageExtensionApp="MessageExtensionApp",e.PIM="PIM",e.People="People",e.Report="Report",e.Satori="Satori",e.Scope="Scope",e.SharePoint="SharePoint",e.Site="Site",e.Streams="Streams",e.Task="Task",e.Team="Team",e.Text="Text",e.Time="Time",e.Topic="Topic",e.TranscriptLlmAnswer="TranscriptLlmAnswer",e.TuringQnA="TuringQnA",e.Prompt="Prompt",e.PeopleInGroup="PeopleInGroup",e.App="App"}(o||(o={}))},497601:(e,t,s)=>{s.d(t,{G0:()=>l,Kx:()=>c,fE:()=>r});var o=s(671930),n=s(599243),i=s(937410),a=function(e,t,s,o){return new(s||(s=Promise))((function(n,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function r(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((o=o.apply(e,t||[])).next())}))};function r(e){let t="";if("undefined"!=typeof navigator&&navigator.userAgent){const e=navigator.userAgent;!e.indexOf||e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0?t="Error: IE lacks necessary support":"undefined"==typeof Promise?t="Error: Promise is not supported":"undefined"==typeof WebAssembly&&(t="Error: WASM is not supported")}else t="Error: No window userAgent";return""!=t&&(e.resultDescription=t,n.tG.info(540406806,n.nh.CoreDefault,e.stop()),!0)}class c{constructor(e,t,s){this.session=e,this.onnxObject=s,this.modelName=t}static create(e,t,s){return a(this,void 0,void 0,(function*(){const o=new i.I({operationName:"CreateModelForInferencing",success:!0,resourceId:t});return o.start(),s[e]?(o.resultDescription="Model already existed",n.tG.info(509699716,n.nh.CoreDefault,o.stop()),s[e]):s[e]=this.getInferenceSession(s).create(e).then((e=>(n.tG.info(540406807,n.nh.CoreDefault,o.stop()),new c(e,t,s)))).catch((e=>{throw o.resultDescription=`Error: ${e}`,n.tG.info(540406808,n.nh.CoreDefault,o.stop()),e}))}))}static getInferenceSession(e){if(null==e?void 0:e.InferenceSession)return e.InferenceSession;throw new Error("InferenceSession is not defined")}run(e){var t;return a(this,void 0,void 0,(function*(){const s=new i.I({operationName:"RunModelForInferencing",success:!0,resourceId:this.modelName});if(s.start(),null===(t=this.onnxObject)||void 0===t?void 0:t.Tensor){const t=e.getInputs(),o={};return Object.keys(t).forEach((e=>{const s=t[e];if(Array.isArray(s.values)&&s.values.length>0&&"boolean"==typeof s.values[0]){const t=new Uint8Array(s.values);o[e]=new this.onnxObject.Tensor(t,s.dimensions)}else o[e]=new this.onnxObject.Tensor(s.values,s.dimensions)})),this.session.run(o).then((e=>(n.tG.info(540406809,n.nh.CoreDefault,s.stop()),new u(e)))).catch((e=>{s.resultDescription=`Problem running model. ${e.message}`,n.tG.info(540406810,n.nh.CoreDefault,s.stop())}))}throw s.resultDescription="Unable to run model. Tensor not defined",n.tG.info(540406811,n.nh.CoreDefault,s.stop()),new Error("Tensor is not defined")}))}}class l{constructor(){this.map={}}static create(){return new l}getInputs(){return this.map}add(e,t,s){return this.map[e]={dimensions:t,values:s},this}}class u{constructor(e){for(const t of Object.keys(e))this[t]=new p(t,e[t])}}class p{constructor(e,t){this.resultName=e,this.result=t}name(){return this.resultName}outputType(){switch(this.result.type){case"string":return o.Z.Strings;case"int8":return o.Z.Int8s;case"int16":return o.Z.Int16s;case"int32":return o.Z.Int32s;case"bool":return o.Z.Booleans;case"uint8":return o.Z.UnsignedInt8s;case"uint16":return o.Z.UnsignedInt16s;case"uint32":return o.Z.UnsignedInt32s;case"float32":return o.Z.Float32s;case"float64":return o.Z.Float64s;default:throw new Error(`The output type ${this.result.type} is not supported.`)}}dimensions(){return this.result.dims}asBooleans(){if(this.outputType()===o.Z.Booleans)return this.result.data.map((e=>!!e));throw new Error(`asBooleans() was called; however, outputType() is ${this.outputType()}, not Type.Booleans.`)}asFloat32s(){if(this.outputType()===o.Z.Float32s)return this.result.data;throw new Error(`asFloat32s() was called; however, outputType() is ${this.outputType()}, not Type.Float32s.`)}asFloat64s(){if(this.outputType()===o.Z.Float64s)return this.result.data;throw new Error(`asFloat64s() was called; however, outputType() is ${this.outputType()}, not Type.Float64s.`)}asInt8s(){if(this.outputType()===o.Z.Int8s)return this.result.data;throw new Error(`asInt8s() was called; however, outputType() is ${this.outputType()}, not Type.Int8s.`)}asInt16s(){if(this.outputType()===o.Z.Int16s)return this.result.data;throw new Error(`asInt16s() was called; however, outputType() is ${this.outputType()}, not Type.Int16s.`)}asInt32s(){if(this.outputType()===o.Z.Int32s)return this.result.data;throw new Error(`asInt32s() was called; however, outputType() is ${this.outputType()}, not Type.Int32s.`)}asStrings(){if(this.outputType()===o.Z.Strings)return this.result.data;throw new Error(`asStrings() was called; however, outputType() is ${this.outputType()}, not Type.Strings.`)}asUnsignedInt8s(){if(this.outputType()===o.Z.UnsignedInt8s)return this.result.data;throw new Error(`asUnsignedInt8s() was called; however, outputType() is ${this.outputType()}, not Type.UnsignedInt8s.`)}asUnsignedInt16s(){if(this.outputType()===o.Z.UnsignedInt16s)return this.result.data;throw new Error(`asUnsignedInt16s() was called; however, outputType() is ${this.outputType()}, not Type.UnsignedInt16s.`)}asUnsignedInt32s(){if(this.outputType()===o.Z.UnsignedInt32s)return this.result.data;throw new Error(`asUnsignedInt32s() was called; however, outputType() is ${this.outputType()}, not Type.UnsignedInt32s.`)}}},505778:(e,t,s)=>{s.d(t,{_A:()=>r,OW:()=>i,t$:()=>n});var o=s(87477);const n="Request timed out";function i(e,t,s){const n=new o.Request(e,t);return a.add(n,s)}const a=new class{constructor(e,t,s){if(this.requestInProgress=!1,this.queuedRequests=[],null==e)throw new Error("No request.");this.fetch=e,this.fetchTimeout=t,this.queueTimeout=s}tryProcessNextRequest(){if(this.requestInProgress=!1,this.queuedRequests.length>0){const[e,t,s]=this.queuedRequests.shift();clearTimeout(s),this.add(e,t)}}add(e,t){if(this.requestInProgress){const s=setTimeout((()=>{t(new Error("Timed out waiting in queue"),null),this.queuedRequests.shift()}),this.queueTimeout);this.queuedRequests.push([e,t,s])}else{this.requestInProgress=!0;new Promise(((t,s)=>{let o=!1;const n=setTimeout((()=>{o=!0,s(new Error("Fetch timed out"))}),this.fetchTimeout);this.fetch(e).then((e=>{o||(clearTimeout(n),t(e))})).catch((e=>{o||(clearTimeout(n),s(e))}))})).then((e=>{t(null,e),this.tryProcessNextRequest()})).catch((e=>{t(e,null),this.tryProcessNextRequest()}))}}}(o.fetch,2e4,12e4);function r(e,t,s){return new Promise(((i,a)=>{const r=setTimeout((()=>{a(new Error(n))}),t);(0,o.fetch)(e,s||{}).then((e=>{clearTimeout(r),i(e)})).catch((e=>{clearTimeout(r),a(e)}))}))}},512030:(e,t,s)=>{s.d(t,{xx:()=>n,zi:()=>i});var o=s(596498),n=(function(){function e(t){o.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ConversationalCopilot_ConversationalTile"},e.getBaseTypes=function(){return["AugLoop_Core_Binary"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ConversationalCopilot_AudioCopilotTile"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),i=function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ConversationalCopilot_OAAudioCopilotTile"},e.getBaseTypes=function(){return["AugLoop_ConversationalCopilot_AudioCopilotTile"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();!function(){function e(t){o.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ConversationalCopilot_ActionAudioCopilotTile"},e.getBaseTypes=function(){return["AugLoop_ConversationalCopilot_AudioCopilotTile"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}()},512755:(e,t,s)=>{s.d(t,{a:()=>i});var o=s(256226),n=s(796462);class i{constructor(e,t){var s,n,i,a,r;this.kind=o.wC.Join,this.isStateful=!1,this.maxDelayMs=1e3,this.maxAnnotations=1,this.allowDefinitionOverride=!1,this.id=e,t&&(this.inputTypes=null!==(s=t.inputTypes)&&void 0!==s?s:this.inputTypes,this.outputTypes=null!==(n=t.outputTypes)&&void 0!==n?n:this.outputTypes,this.isStateful=null!==(i=t.isStateful)&&void 0!==i?i:this.isStateful,this.maxDelayMs=null!==(a=t.maxDelayMs)&&void 0!==a?a:this.maxDelayMs,this.requestedContextTypesRules=null!==(r=t.requestedContextTypesRules)&&void 0!==r?r:this.requestedContextTypesRules)}static create(e){return new i(e)}setCollectionScopeType(e){return this.collectionScopeType=e,this}setInputTypes(e){return this.inputTypes=(0,n.MY)(e),this}setOutputTypes(e){return this.outputTypes=(0,n.MY)(e),this}setStateful(){return this.isStateful=!0,this}setMaxDelayTime(e){return this.maxDelayMs=e?Math.max(0,e):void 0,this}setMaxAnnotations(e){return this.maxAnnotations=e,this}setRequestedContexts(e){var t;return this.requestedContextTypesRules=(null!==(t=this.requestedContextTypesRules)&&void 0!==t?t:this.requestedContextTypesRules=[]).concat(e),this}setLambdaType(e){return this.factory=e,this}setAllowDefinitionOverride(){return this.allowDefinitionOverride=!0,this}setLambda(e,t){return this.factory=()=>({init:t||(e=>Promise.resolve()),execute:e,dispose:()=>{}}),this}validateOptions(){return{isValid:!0}}}},522333:(e,t,s)=>{var o;s.d(t,{P:()=>o}),function(e){e.CipTree="CipTree",e.TopicTree="TopicTree",e.ContentTree="ContentTree",e.MergedCipTree="MergedCipTree"}(o||(o={}))},524243:(e,t,s)=>{s.d(t,{A:()=>n});var o={util:{},roots:{default:{}}},n=(o.util,o.roots.default||(o.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.count=0,e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.durationMs=0,e.prototype.success=!1,e.prototype.resultDescription="",e.prototype.resultJSON="",e.prototype.resultSignature="",e.prototype.operationName="",e.prototype.resourceId="",e.prototype.dimension0="",e.prototype.dimension1="",e.prototype.dimension2="",e.prototype.dimension3="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.joinContextId="",e.prototype.ariaTenant="",e.prototype.ariaNamespace="",e.prototype.dataFields="",e.prototype.userDataBoundaryType="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/OperationEvent"},e}())},529510:(e,t,s)=>{s.d(t,{eU:()=>h});var o,n,i=s(599243),a=s(937410),r=s(297288),c=s.n(r);class l{constructor(){this.listeners=new Map,this.lastId=0}addListener(e){if(!e)throw new Error("No callback provided for data listener");return this.listeners.set(this.lastId,e),this.lastId++}removeListener(e){this.listeners.delete(e)}notifyListeners(e){this.listeners.forEach((t=>{t(e)}))}}!function(e){e.Add="Add",e.Remove="Remove",e.Set="Set",e.Delete="Delete"}(n||(n={}));class u{static applyECSPatchOperation(e,t){let s=!1;if("object"==typeof t||Array.isArray(t))switch(e.operation){case n.Add:case n.Remove:s=u.applyAddOrRemoveOperation(e.path,t,e.value,e.operation);break;case n.Set:s=u.applySetOperation(e.path,t,e.value);break;case n.Delete:s=u.applyDeleteOperation(e.path,t,e.value)}return s?i.tG.verbose(505956121,i.nh.CoreDefault,`PATCH operation succeeded for ${e.operation} on ${e.settingName} with path: ${e.path}.`):i.tG.error(505956122,i.nh.CoreDefault,`PATCH operation failed for ${e.operation} on ${e.settingName} with path: ${e.path}`),s}static applyAddOrRemoveOperation(e,t,s,o){let a=!1;try{let i=[];if("object"!=typeof t||Array.isArray(t)?Array.isArray(t)&&(i=t):i=e.reduce(((e,t)=>e&&e[t]),t),Array.isArray(i))if(o===n.Add)i.push(s),a=!0;else if(o===n.Remove){const e=i.indexOf(s);e>=0&&(i.splice(e,1),a=!0)}}catch(e){i.tG.info(505968832,i.nh.CoreDefault,`Exception thrown while applying operation type: ${o} for an array. Error: ${e}`),a=!1}return a}static applySetOperation(e,t,s){let o=!1;try{const n=e.slice(0,-1),i=e[e.length-1];let a={};"object"!=typeof t||Array.isArray(t)||(a=n.reduce(((e,t)=>e&&e[t]),t),"object"!=typeof a||Array.isArray(a)||(a[i]=s,o=!0))}catch(e){i.tG.info(505968802,i.nh.CoreDefault,`Exception thrown while applying set operation. Error: ${e}`),o=!1}return o}static applyDeleteOperation(e,t,s){let o=!1;try{let n={};"object"!=typeof t||Array.isArray(t)||(n=e.reduce(((e,t)=>e&&e[t]),t),"object"!=typeof n||Array.isArray(n)||"string"!=typeof s||n.hasOwnProperty(s)&&(delete n[s],o=!0))}catch(e){i.tG.info(505968801,i.nh.CoreDefault,`Exception thrown while applying delete operation. Error: ${e}`),o=!1}return o}}o=u,u.parseECSOperation=(e,t)=>{if(!t.hasOwnProperty("operationType")||!t.hasOwnProperty("path")||!t.hasOwnProperty("value"))throw new Error(`Invalid format for PATCH operation on setting: ${e}`);const s=t.operationType.toLowerCase(),n=o.convertToConfigPatchOperationType(s);return{settingName:e,path:t.path?t.path.split("."):[],operation:n,value:t.value}},u.convertToConfigPatchOperationType=e=>{switch(e){case"add":return n.Add;case"remove":return n.Remove;case"set":return n.Set;case"delete":return n.Delete;default:throw new Error(`Invalid operation type: ${e}`)}};var p=function(e,t,s,o){return new(s||(s=Promise))((function(n,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function r(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((o=o.apply(e,t||[])).next())}))};class g extends l{constructor(e){super(),this.name=e}static initEcsSettingsProvider(e){i.tG.info(505999498,i.nh.CoreDefault,"Initializing ECS settings provider."),g.ecsSettingsProvider=e}static enableEcsPatchConfig(e){g.ecsPatchConfigEnabled=e}static getInstance(e){let t=this.allSettings.get(e);if(!t){t=new g(e);const s=g.tryGetConfigProperty(g.currentConfig,e);s.success&&t.updateValue(s.value),this.allSettings.set(e,t)}return t}static getPatternInstance(e){let t=this.allPatternSettings.get(e);if(!t){t={regex:new RegExp(e),setting:new g(e)};const s=g.tryGetConfigPropertyByPattern(g.currentConfig,t.regex);t.setting.updateValue(s),this.allPatternSettings.set(e,t)}return t.setting}static setNewConfig(e){g.currentConfig=e,i.tG.info(572837966,i.nh.CoreDefault,`New config: ${JSON.stringify(e)}`),g.allSettings.forEach(((e,t)=>{const s=g.tryGetConfigProperty(g.currentConfig,t).value;e.updateValue(s)&&(i.tG.info(572837967,i.nh.CoreDefault,`Setting new value for ${t}: ${s instanceof Object?JSON.stringify(s):s}`),e.notifyListeners(s))})),g.allPatternSettings.forEach(((t,s)=>{const o=g.tryGetConfigPropertyByPattern(e,t.regex);t.setting.updateValue(o)&&(i.tG.info(508432774,i.nh.CoreDefault,`Setting new value for pattern ${s}: ${JSON.stringify(o)}`),t.setting.notifyListeners(o))}))}static tryGetConfigProperty(e,t){return e&&e.hasOwnProperty(t)?{success:!0,value:g.selectApplicableValue(e[t])}:{success:!1,value:void 0}}static tryGetConfigPropertyByPattern(e,t){const s=[];if(e){const o=Object.getOwnPropertyNames(e).filter((e=>t.test(e)));for(const t of o)s.push({name:t,value:g.selectApplicableValue(e[t])})}return s}static setGlobalFilter(e){g.globalFilter=e}static setLocalConfig(e){g.localConfig=e,i.tG.info(506053841,i.nh.CoreDefault,`Setting localConfig field in Setting class: ${JSON.stringify(g.localConfig)}`)}static clear(){g.currentConfig=void 0,g.localConfig=void 0,g.allSettings.clear(),g.allPatternSettings.clear(),g.ecsSettingsProvider=void 0}static selectApplicableValue(e){let t;if(e){const s=e.find((e=>!g.globalFilter||g.globalFilter(e)));s&&(t=s.value)}return t}getName(){return this.name}getValue(){if(function(){var e;return void 0!==globalThis.process&&"true"===(null===(e=globalThis.process.env)||void 0===e?void 0:e.VALIDATE_CORRECT_USAGE_OF_GET_VALUE)}()&&0===this.listeners.size){const e=new Error(`SettingInstance or ChangeGate is being used incorrectly. Make sure .getValue() or ChangeGate is called during runtime or there is a listener set up on the setting. For more info visit: ${g.troubleshootUrl}`);throw e.name="Incorrect usage of getValue()",e}return this.value}getValueAdvancedAsync(e){return p(this,void 0,void 0,(function*(){const t=new a.I({operationName:"ECSGetValueAsync"},{metricDuration:!0}).start();let s;try{const o=yield g.ecsSettingsProvider.getSettingValue(this.name,e);t.dimension0=o.userAuthenticated?"Authenticated":"Anonymous",t.success=!0;let n=o.value,i=o.ecsSection;return n||(n=g.tryGetConfigProperty(g.localConfig,this.name).value,n&&o.patchValue&&(n=g.applyPatchOperationOnSetting(this.name,n,o.patchValue),i=o.ecsPatchSection)),s=`Setting value for ${this.name} is ${JSON.stringify(n)}.\n Config IDs: ${JSON.stringify(i)}.`,n}catch(e){i.tG.error(505226379,i.nh.CoreDefault,`Exception thrown while getting setting value for ${this.name}. Error: ${e}\n Error stack trace: ${e.stack}`),t.success=!1;const o=g.tryGetConfigProperty(g.localConfig,this.name).value;return s=`Setting value for ${this.name} is ${JSON.stringify(o)}.`,o}finally{i.tG.info(506053839,i.nh.CoreDefault,t.stop()),i.tG.info(505821320,i.nh.CoreDefault,s)}}))}updateValue(e){return!c()(this.value,e)&&(i.tG.info(572837968,i.nh.CoreDefault,`Received new property value for ${this.getName()}:`,e),this.value=e,!0)}static applyPatchOperationsOnConfig(e){try{if(!g.ecsPatchConfigEnabled)return e;const t=this.tryGetConfigProperty(e,"patchOperations").value;if(!t||0===t.length)return e;const s=[];for(const[e,o]of Object.entries(t))try{s.push(u.parseECSOperation(e,o))}catch(t){i.tG.error(505734922,i.nh.CoreDefault,`Exception thrown while parsing ECS PATCH operation for setting: ${e}. Error: ${t}`);continue}const o=new Map;for(const t of s)if(null==e?void 0:e.hasOwnProperty(t.settingName)){const s=JSON.parse(JSON.stringify(e[t.settingName])),n=g.selectApplicableValue(s);u.applyECSPatchOperation(t,n)&&(o.set(t.settingName,n),e[t.settingName]=s)}if(o.size>0){const e={};o.forEach(((t,s)=>{e[s]=t})),i.tG.info(505788322,i.nh.CoreDefault,`Resulting settings after PATCHes were applied: ${JSON.stringify(e)}`)}return e}catch(t){return i.tG.error(505788321,i.nh.CoreDefault,`Exception thrown while applying ECS PATCH operations. Error: ${t}`),e}}static applyPatchOperationOnSetting(e,t,s){try{if(!g.ecsPatchConfigEnabled)return t;const o=JSON.parse(JSON.stringify(t)),n=s,i=u.parseECSOperation(e,n);return u.applyECSPatchOperation(i,o),o}catch(e){return i.tG.error(505788323,i.nh.CoreDefault,`Exception thrown while applying ECS PATCH operation on setting. Error: ${e}`),t}}}g.allSettings=new Map,g.allPatternSettings=new Map,g.ecsPatchConfigEnabled=!1,g.troubleshootUrl="https://eng.ms/docs/experiences-devices/opg/office-ai/augloop-ai-platform/augmentation-loop/documentation/server-workflow-tutorials/settings/troubleshoot";class h extends l{constructor(e,t){super(),this.listenerId=NaN,this.defaultValue=t,this.setting=g.getInstance(e)}getDefaultValue(){return this.defaultValue}addListener(e){return Number.isNaN(this.listenerId)&&(this.listenerId=this.setting.addListener((()=>{this.notifyListeners(this.getValue())}))),super.addListener(e)}removeListener(e){super.removeListener(e),0!==this.listeners.size||Number.isNaN(this.listenerId)||(this.setting.removeListener(this.listenerId),this.listenerId=NaN)}getValue(){const e=this.setting.getValue();return void 0===e?this.defaultValue:e}getValueAdvancedAsync(e){return p(this,void 0,void 0,(function*(){const t=yield this.setting.getValueAdvancedAsync(e);return void 0===t?this.defaultValue:t}))}}},531336:(e,t,s)=>{var o,n,i,a,r,c,l,u;s.d(t,{T8:()=>o}),function(e){e[e.EntityClicked=0]="EntityClicked",e[e.RelatedEntityClicked=1]="RelatedEntityClicked",e[e.EntityRefinerClicked=2]="EntityRefinerClicked",e[e.EntityActionTaken=3]="EntityActionTaken",e[e.PreviewOpen=4]="PreviewOpen",e[e.PreviewClose=5]="PreviewClose",e[e.OptionsMenuOpen=6]="OptionsMenuOpen",e[e.OptionsMenuClose=7]="OptionsMenuClose",e[e.MouseHover=8]="MouseHover"}(o||(o={})),function(e){e[e.Suggestions=0]="Suggestions",e[e.Query=1]="Query",e[e.Answers=2]="Answers"}(n||(n={})),function(e){e[e.File=0]="File",e[e.Site=1]="Site",e[e.App=2]="App"}(i||(i={})),function(e){e[e.Link=0]="Link"}(a||(a={})),function(e){e[e.Vertical=0]="Vertical",e[e.Horizontal=1]="Horizontal",e[e.Grid=2]="Grid"}(r||(r={})),function(e){e[e.Files=0]="Files",e[e.Videos=1]="Videos",e[e.Images=2]="Images",e[e.Office=3]="Office"}(c||(c={})),function(e){e[e.Visible=0]="Visible",e[e.Partial=1]="Partial",e[e.Hidden=2]="Hidden"}(l||(l={})),function(e){e[e.Entity=0]="Entity",e[e.Group=1]="Group"}(u||(u={}))},540598:(e,t,s)=>{s.d(t,{qS:()=>c});var o=s(596498);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_ExcelTableai_ExcelRangeMetadata"}static getBaseTypes(){return["AugLoop_ExcelTableAi_ExcelRecognizedTableNew","AugLoop_Excel_ExcelRangeWrapperAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_ExcelTableai_XLIMCorrelationIdentifier"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_ExcelTableai_ExcelBoundaryDetectionLimitExceededAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_ExcelTableai_ExcelBoundaryDetectionConfiguration"}static getBaseTypes(){return["AugLoop_Excel_ExcelRangeWrapperAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_ExcelTableai_ExcelBlobRange"}static getBaseTypes(){return["AugLoop_Excel_ExcelRangeWrapperAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_ExcelTableai_ExcelBoundaryDetectionStatus"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()}},540949:(e,t,s)=>{var o;s.d(t,{q:()=>o}),function(e){e[e.error=0]="error",e[e.warn=1]="warn",e[e.info=3]="info",e[e.metric=4]="metric",e[e.verbose=5]="verbose",e[e.debug=6]="debug",e[e.disabled=7]="disabled"}(o||(o={}))},543028:(e,t,s)=>{s.d(t,{H:()=>n});var o=s(596498);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_UserStore_UserProfileResponseAnnotation"}static getBaseTypes(){return["AugLoop_Copilot_CopilotOutputAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},546756:(e,t,s)=>{s.d(t,{Cm:()=>g,Lg:()=>m,U$:()=>S,h2:()=>y});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingBaseSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingTableSignal"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_ExcelDataShapingBaseSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingSignal"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_ExcelDataShapingTableSignal","AugLoop_ExcelDataShaping_ExcelDataShapingBaseSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingCreateQuerySignal"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_ExcelDataShapingTableSignal","AugLoop_ExcelDataShaping_ExcelDataShapingBaseSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingWithMScriptSignal"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_ExcelDataShapingTableSignal","AugLoop_ExcelDataShaping_ExcelDataShapingBaseSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingEditQueryBaseSignal"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_ExcelDataShapingWithMScriptSignal","AugLoop_ExcelDataShaping_ExcelDataShapingTableSignal","AugLoop_ExcelDataShaping_ExcelDataShapingBaseSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingEditQuerySignal"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_ExcelDataShapingEditQueryBaseSignal","AugLoop_ExcelDataShaping_ExcelDataShapingWithMScriptSignal","AugLoop_ExcelDataShaping_ExcelDataShapingTableSignal","AugLoop_ExcelDataShaping_ExcelDataShapingBaseSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingEditQueryV2Signal"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_ExcelDataShapingEditQueryBaseSignal","AugLoop_ExcelDataShaping_ExcelDataShapingWithMScriptSignal","AugLoop_ExcelDataShaping_ExcelDataShapingTableSignal","AugLoop_ExcelDataShaping_ExcelDataShapingBaseSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){o.h.assign(g,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingCreateTableUpdatePlanSignal"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_ExcelDataShapingTableSignal","AugLoop_ExcelDataShaping_ExcelDataShapingBaseSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){o.h.assign(h,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingEvaluateSampleSignal"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_ExcelDataShapingTableSignal","AugLoop_ExcelDataShaping_ExcelDataShapingBaseSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{constructor(e){o.h.assign(d,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingValidateScriptSignal"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_ExcelDataShapingBaseSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{constructor(e){o.h.assign(m,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingEnterModeSignal"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_ExcelDataShapingTableSignal","AugLoop_ExcelDataShaping_ExcelDataShapingBaseSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{constructor(e){o.h.assign(y,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingExitModeSignal"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_ExcelDataShapingBaseSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class T{constructor(e){o.h.assign(T,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingApplyTransformationSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[T.getTypeName()])}}T.H_={T_:T.getTypeName(),B_:T.getBaseTypes()};class f{constructor(e){o.h.assign(f,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingGenerateTransformationScriptSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class _{constructor(e){o.h.assign(_,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingApplyTransformationV2Signal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[_.getTypeName()])}}_.H_={T_:_.getTypeName(),B_:_.getBaseTypes()};class C{constructor(e){o.h.assign(C,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingGetContextSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[C.getTypeName()])}}C.H_={T_:C.getTypeName(),B_:C.getBaseTypes()};class S{constructor(e){o.h.assign(S,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingQueryScriptUpdatedSignal"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_ExcelDataShapingBaseSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[S.getTypeName()])}}S.H_={T_:S.getTypeName(),B_:S.getBaseTypes()}},556016:(e,t,s)=>{var o;s.d(t,{Y:()=>o}),function(e){e[e.Connecting=0]="Connecting",e[e.Listening=1]="Listening",e[e.Thinking=2]="Thinking",e[e.Speaking=3]="Speaking",e[e.Error=4]="Error",e[e.Interrupted=5]="Interrupted",e[e.Disconnected=6]="Disconnected",e[e.Blocked=7]="Blocked",e[e.OnHold=8]="OnHold"}(o||(o={}))},556263:(e,t,s)=>{s.d(t,{Q:()=>n,s:()=>i});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Text_TextTileDelta"}static getBaseTypes(){return["AugLoop_Core_ItemDelta"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Text_FormattedTextTileDelta"}static getBaseTypes(){return["AugLoop_Text_TextTileDelta","AugLoop_Core_ItemDelta"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},563308:(e,t,s)=>{s.d(t,{Q:()=>n});var o={util:{},roots:{default:{}}},n=(o.util,o.roots.default||(o.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientAppVersion="",e.prototype.clientRuntimeVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientUserAgent="",e.prototype.healthBucket="",e.prototype.healthReason="",e.prototype.healthSubreason="",e.prototype.summarizedFindings="",e.prototype.affectedResource="",e.prototype.affectedSessions="",e.prototype.suppressionReason="",e.prototype.modelItemsCountBucket="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.userDataBoundaryType="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SessionIssueEvent"},e}())},563485:(e,t,s)=>{s.d(t,{g:()=>n});var o={util:{},roots:{default:{}}},n=(o.util,o.roots.default||(o.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.host="",e.prototype.statusCode=0,e.prototype.success=!1,e.prototype.wait=0,e.prototype.dns=0,e.prototype.tcp=0,e.prototype.firstByte=0,e.prototype.download=0,e.prototype.total=0,e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/OutboundHttpRequestEvent"},e}())},565248:(e,t,s)=>{s.d(t,{B:()=>n});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_AudioCastGenerator_GenerateAudioCastSignal"}static getBaseTypes(){return["AugLoop_Copilot_CopilotInputSignal","AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},571728:(e,t,s)=>{s.d(t,{CP:()=>i,ht:()=>n});var o=s(596498);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_CopilotComprehensionArchitecture_CopilotComprehensionChunkAnnotation"}static getBaseTypes(){return["AugLoop_Core_StreamAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_CopilotComprehensionArchitecture_CopilotComprehensionCompletionAnnotation"}static getBaseTypes(){return["AugLoop_Core_StreamAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_CopilotComprehensionArchitecture_CopilotComprehensionAiFirstAnnotation"}static getBaseTypes(){return["AugLoop_Text_MultiTileRangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},574684:(e,t,s)=>{var o;s.d(t,{T:()=>o}),function(e){e.CommentSummarization="CommentSummarization",e.SuggestedQuestions="SuggestedQuestions",e.DocumentSummaryDynamicLength="DocumentSummaryDynamicLength",e.DocumentSummaryGlance="DocumentSummaryGlance",e.DocumentSummaryKeyPoints="DocumentSummaryKeyPoints",e.DocumentSummaryDetailed="DocumentSummaryDetailed",e.DocumentSummaryDynamicLengthNoCitations="DocumentSummaryDynamicLengthNoCitations",e.DocumentSummaryGlanceNoCitations="DocumentSummaryGlanceNoCitations",e.DocumentSummaryKeyPointsNoCitations="DocumentSummaryKeyPointsNoCitations",e.DocumentSummaryDetailedNoCitations="DocumentSummaryDetailedNoCitations",e.DocumentSummaryCachePreload="DocumentSummaryCachePreload",e.ProactiveDocumentSummaryDynamicLength="ProactiveDocumentSummaryDynamicLength",e.ProactiveDocumentSummaryGlance="ProactiveDocumentSummaryGlance",e.ProactiveDocumentSummaryKeyPoints="ProactiveDocumentSummaryKeyPoints",e.ProactiveDocumentSummaryDetailed="ProactiveDocumentSummaryDetailed",e.ProactiveCollapsedDocumentSummaryDynamicLength="ProactiveCollapsedDocumentSummaryDynamicLength",e.ProactiveCollapsedDocumentSummaryGlance="ProactiveCollapsedDocumentSummaryGlance",e.ProactiveCollapsedDocumentSummaryKeyPoints="ProactiveCollapsedDocumentSummaryKeyPoints",e.ProactiveCollapsedDocumentSummaryDetailed="ProactiveCollapsedDocumentSummaryDetailed",e.ShareNative="ShareNative",e.KeyStats="KeyStats",e.DocumentInsights="DocumentInsights",e.DocumentRelevance="DocumentRelevance",e.CollabCatchup="CollabCatchup",e.CollabCatchupThreeDays="CollabCatchupThreeDays",e.CollabCatchupOneWeek="CollabCatchupOneWeek",e.CollabCatchupTwoWeeks="CollabCatchupTwoWeeks",e.CollabCatchupLastSeenTime="CollabCatchupLastSeenTime",e.PersonalizedSummary="PersonalizedSummary",e.SydneyDocumentRelevance="SydneyDocumentRelevance",e.SydneyDocumentInsights="SydneyDocumentInsights",e.SydneyDocumentSummaryByDeclarativeAgent="SydneyDocumentSummaryByDeclarativeAgent",e.ComprehensionPlayground="ComprehensionPlayground",e.SummarizationGrounding="SummarizationGrounding",e.RelatedFiles="RelatedFiles",e.DocumentCommentator="DocumentCommentator",e.TestingAgent="TestingAgent",e.FileSearchTool="FileSearchTool",e.FileDownloadTool="FileDownloadTool",e.ChatCompletionsTestingAgent="ChatCompletionsTestingAgent",e.RecentFilesTool="RecentFilesTool",e.DocumentReplace="DocumentReplace",e.DocumentSummaryServiceCall="DocumentSummaryServiceCall",e.MessageSearchTool="MessageSearchTool",e.PromptSuggestion="PromptSuggestion",e.GetCoaching="GetCoaching",e.DeepKnowledgeSynthesis="DeepKnowledgeSynthesis"}(o||(o={}))},574803:(e,t,s)=>{var o,n;s.d(t,{G:()=>n,O:()=>o}),function(e){e.Thoughts="thoughts",e.ToolCall="tool_call",e.Response="response"}(o||(o={})),function(e){e.Partial="partial",e.Complete="complete",e.Error_UnknownResponseId="error_unknown_response_id",e.Error_InternalError="error_internal_error",e.Error_QueryCanceled="error_query_canceled",e.Error_WorkflowTimeout="error_workflow_timeout",e.Error_Throttled="error_throttled",e.Error_RaiPolicy="error_rai_policy"}(n||(n={}))},580632:(e,t)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.countExcelErrors=t.toExcelError=t.ExcelError=void 0,function(e){e.Div0="#DIV/0!",e.NA="#N/A",e.Name="#NAME?",e.Null="#NULL!",e.Num="#NUM!",e.Ref="#REF!",e.Value="#VALUE!",e.GettingData="#GETTING_DATA",e.Calc="#CALC!",e.Spill="#SPILL!",e.Field="#FIELD!",e.Data="#DATA",e.Unknown="#UNKNOWN!",e.Busy="#BUSY!"}(s||(t.ExcelError=s={}));const o=new Set(Object.values(s));function n(e){if(o.has(e))return e}t.toExcelError=n,t.countExcelErrors=function(e){let t=0;const o=e.map(n).reduce(((e,s)=>(s&&(t++,e[s]=(e[s]||0)+1),e)),{}),i=t-(o[s.NA]||0),a=0===e.length?0:t/e.length*100,r=0===e.length?0:i/e.length*100;return{totalErrors:t,errorCounts:o,errorPercentage:a,errorPercentageWithoutNA:r}}},580772:e=>{e.exports={r:"2.37.197"}},581716:(e,t,s)=>{var o,n,i,a,r,c,l;s.d(t,{d2:()=>r}),function(e){e.USER_PROMPT="userPrompt",e.INVOKE_SKILL="invokeSkill",e.GENERATE_TABLE="generateTable",e.GENERATE_SUMMARY="generateSummary",e.GENERATE_CONTENT_LENGTH_SPECIFIED="generateContentLengthSpecified",e.GENERATE_CONTENT="generateContent",e.GENERATE_CONTENT_WITH_EMOJI="generateContentWithEmoji",e.REWRITE_CONTENT="rewriteContent",e.REWRITE_CONTENT_WITH_EMOJIS="rewriteContentWithEmojis",e.REWRITE_CONTENT_WITH_GROUNDING_CONTENT_FROM_FILE="rewriteContentWithGroundingContentFromFile",e.FORMAT_CONTENT="formatContent",e.TRANSLATE_CONTENT="translateContent",e.USER_QUERY="userQuery",e.USER_QUERY_CIP="userQueryCIP",e.OPERATE_ON_TABLE="operateOnTable",e.CONTENT_GENERATION_FROM_FILES="contentGenerationFromFiles",e.GENERATE_DATA_VISUALISATION_CHART="generateChartVisualisation",e.GENERATE_IMAGE="generateImage",e.GENERATE_ARTIFACT="generateArtifact",e.GENERATE_ARTIFACT_FROM_FILE="generateArtifactFromFile",e.ORGANIZE_FILES_IN_FOLDER="organizeFilesInFolder",e.REFRESH_DATA="refreshData",e.GENERATE_PODCAST="generatePodcast",e.NOT_KNOWN="notKnown"}(o||(o={})),function(e){e.INSERT="insert",e.UPDATE="update"}(n||(n={})),function(e){e.HTML="html",e.JSON="json",e.XML="xml",e.TEXT="text",e.ERROR_TEXT="error_text",e.MARKDOWN="markdown"}(i||(i={})),function(e){e.WEB_SEARCH_DETERMINATION="webSearchDetermination",e.INTENT_DETECTION="intentDetection",e.CONTENT_GENERATION="contentGeneration",e.CONTENT_EVALUATION="contentEvaluation",e.CONTENT_GENERATION_WITH_WEB_SEARCH="contentGenerationWithWebSearch"}(a||(a={})),function(e){e.INIT_SERVICE="initService",e.FETCH_FILE_LIST="fetchFileList",e.FETCH_CONTENT="fetchContent",e.GENERATE_DATA="generateData",e.GENERATE_CONTENT_WITH_EMOJIS_FROM_CONTENT="generateContentWithEmojisFromContent",e.SERVICE_RESPONSE="serviceResponse",e.CLIENT_ACK="clientAck",e.FETCH_CHAT_HISTORY="fetchChatHistory",e.FETCH_CONTENT_METADATA="fetchContentMetadata",e.GENERATE_SUGGESTIONS="generateSuggestions",e.CLEAN_UP="cleanUp",e.CONVERT_TO_BLOG="convertToBlog",e.SET_CONFIG="setConfig",e.REFRESH_DATA="refreshData",e.EVAL_AND_PERF_METRICS="evalAndPerfMetrics",e.GENERATE_ARTIFACT="generateArtifact",e.ORGANIZE_FILES_IN_FOLDER="organizeFilesInFolder",e.FETCH_FILES_USING_CONTEXT_SEARCH="fetchFilesUsingContextSearch",e.GENERATE_HIERARCHY_TREE_FOR_FOLDER="generateHierarchyTreeForFolder",e.GENERATE_ARTIFACT_FROM_FILE="generateArtifactFromFile",e.PODCAST_CREATION="podcastCreation"}(r||(r={})),function(e){e.DOCX="docx",e.DOC="doc",e.XLSX="xlsx",e.TEXT="txt",e.PDF="pdf",e.PEOPLE="people",e.PPTX="pptx",e.HTML="html",e.JSON="json",e.EMAIL="eml",e.UNKNOWN="unknown",e.MP4="mp4",e.AVI="avi",e.WMV="wmv",e.MP3="mp3",e.PNG="png",e.JPG="jpg",e.CSV="csv",e.EXTENSION_NOT_AVAILABLE="extension_not_available",e.YAML="yaml"}(c||(c={})),function(e){e.SENSITIVE_FILE="Sensitive file",e.METADATA_DOWNLOAD_FAILED="File metadata download failed",e.CONTENT_DOWNLOAD_FAILED="File content download failed",e.ACCESS_DENIED="No permission to access the file."}(l||(l={}))},584104:(e,t,s)=>{var o=s(758651);Object.defineProperty(t,"__esModule",{value:!0}),t.buildEmscriptenCustomContextFromSite=t.buildEmscriptenCustomContext=void 0;const n=s(653141);function i(e,t){function s(e,t,s,o){const n=function(e,t,s){const o=new Headers,n=s.keys();for(let e=0;e<n.size();e++){const t=n.get(e);o.append(t,s.get(t))}const i={};return i.method=e,void 0!==t&&(i.body=t),n.size()>0&&(i.headers=o),n.delete(),i}(t,s,o);let i=0;return fetch(e,n).then((e=>{if(i=e.status,!e.ok)throw new Error(`HTTP ${e.status} - ${e.statusText}`);return e.arrayBuffer()})).then((e=>({bufferArray:new Uint8Array(e),length:e.byteLength,isError:!1,statusCode:i}))).catch((e=>{const t=e;return t.isError=!0,t.statusCode=i,t}))}function i(e,t,s){if(e||t&&0!==t.length){if(e){const t=e;return t.isError=!0,t}return{token:t,ttl:s?s.timeToLiveSec:void 0}}return{name:"Missing Token",message:"Unable to fetch token",isError:!0}}function a(e){if(!e)return;const t=new Map,s=e.keys();for(let o=0;o<s.size();o++){const n=s.get(o);t.set(n,e.get(n))}return t}function r(e,t){return new Promise((async(s,o)=>{try{if(!e.run)throw new Error("WorkflowSite is unimplemented.");const o=await e.run(t);if(!o)throw new Error("Outputs returned as undefined.");s(o)}catch(e){const t=e;t.isError=!0,s(t)}}))}function c(e,t,s){if(!e||!e.run){const e=new Error("WorkflowSite is unimplemented.");return e.isError=!0,void s(e)}const o=s.clone();e.run(t).then((e=>{if(!e)throw new Error("Outputs returned as undefined.");o.opcall(e)})).catch((e=>{const t=e;t.isError=!0,o.opcall(t)})).finally((()=>{o.delete()}))}const l={createModel:function(t){return new Promise((async(s,o)=>{try{if(!e.site)throw new Error("WorkflowSite is unimplemented.");const o=await e.site.createModel(t);o.customRun=r.bind(null,o),o.customRunInCallback=c.bind(null,o),s(o)}catch(e){const t=e;t.isError=!0,s(t)}}))},createModelInCallback:function(t,s){if(!e.site){const e=new Error("WorkflowSite is unimplemented.");return e.isError=!0,void s(e)}const o=s.clone();e.site.createModel(t).then((e=>{e.customRun=r.bind(null,e),e.customRunInCallback=c.bind(null,e),o.opcall(e)})).catch((e=>{const t=e;t.isError=!0,o.opcall(t)})).finally((()=>{o.delete()}))},createModelInputs:function(){return new Promise((async(t,s)=>{try{if(!e.site)throw new Error("WorkflowSite is unimplemented.");t(await e.site.createModelInputs())}catch(e){const s=e;s.isError=!0,t(s)}}))},createModelInputsInCallback:function(t){if(!e.site){const e=new Error("WorkflowSite is unimplemented.");return e.isError=!0,void t(e)}const s=t.clone();e.site.createModelInputs().then((e=>{s.opcall(e)})).catch((e=>{const t=e;t.isError=!0,s.opcall(t)})).finally((()=>{s.delete()}))}},u={};return u.docSessionId=e.clientMetadata.docSessionId,u.getToken=function(t){return new Promise(((s,o)=>{e.getToken(t,((e,t,o)=>{if(e||t&&0!==t.length)if(e){const t=e;t.isError=!0,s(t)}else s(t);else s({name:"Missing Token",message:"Unable to fetch token",isError:!0})}))}))},u.getTokenWithPropertiesAsync=function(t){return new Promise(((s,o)=>{e.getToken(t,((e,t,o)=>{const n=i(e,t,o);s(n)}))}))},u.getTokenWithPropertiesInCallback=function(t,s){const o=s.clone();e.getToken(t,((e,t,s)=>{const n=i(e,t,s);o.opcall(n),o.delete()}))},u.getResourceAsUrlInCallback=function(t,s,o,n){if(!e.site){const e=new Error("WorkflowSite is unimplemented.");return e.isError=!0,void n(e)}const i=n.clone();e.site.getResourceAsURL(t,s,a(o)).then((e=>{const t=Object.entries(e),s=new Map(t);i.opcall(s)})).catch((e=>{const t=e;t.isError=!0,i.opcall(t)})).finally((()=>{i.delete()}))},u.httpRequest=s,u.httpRequestInCallback=function(e,t,o,n,i){const a=i.clone();s(e,t,o,n).then((e=>{a.opcall(e)})).catch((e=>{})).finally((()=>{a.delete()}))},u.copyUint8ArrayToWasmMemory=function(e,s){t().HEAPU8.set(e,s)},u.copyUint16ArrayToWasmMemory=function(e,s){t().HEAPU16.set(e,s>>1)},u.copyUint32ArrayToWasmMemory=function(e,s){t().HEAPU32.set(e,s>>2)},u.copyInt8ArrayToWasmMemory=function(e,s){t().HEAP8.set(e,s)},u.copyInt16ArrayToWasmMemory=function(e,s){t().HEAP16.set(e,s>>1)},u.copyInt32ArrayToWasmMemory=function(e,s){t().HEAP32.set(e,s>>2)},u.copyFloat32ArrayToWasmMemory=function(e,s){t().HEAPF32.set(e,s>>2)},u.copyFloat64ArrayToWasmMemory=function(e,s){t().HEAPF64.set(e,s>>3)},u.getResourceAsUrl=function(t,s,o){return new Promise((async(n,i)=>{try{if(!e.site)throw new Error("WorkflowSite is unimplemented.");const i=await e.site.getResourceAsURL(t,s,a(o)),r=Object.entries(i);n(new Map(r))}catch(e){const t=e;t.isError=!0,n(t)}}))},u.getResourceAsByteArray=function(t,s,n){return new Promise((async(i,r)=>{try{if(!e.site)throw new Error("WorkflowSite is unimplemented.");const r=await e.site.getResourceAsArrayBuffer(t,s,a(n)),c=new Map;for(const[e,t]of Object.entries(r)){o.log(e,t);const s=new Uint8Array(t),n={};n.bufferArray=s,n.length=t.byteLength,c.set(e,n)}i(c)}catch(e){const t=e;t.isError=!0,i(t)}}))},u.site=l,u.context=e,u.logOperationClass=n.Operation,u.logInfoFunction=n.Log.info.bind(null,0,n.LogCategory.WorkflowDefault),u.dummyPromise=Promise.resolve("Success"),u.logDebugTrace=function(e,t){n.Log.debug(e,n.LogCategory.WorkflowDefault,t)},u.logInfoTrace=function(e,t){n.Log.info(e,n.LogCategory.WorkflowDefault,t)},u.logWarnTrace=function(e,t){n.Log.warn(e,n.LogCategory.WorkflowDefault,t)},u.logErrorTrace=function(e,t){n.Log.error(e,n.LogCategory.WorkflowDefault,t)},u.getUserContext=function(){if(!e.userContext)return;const t={UserContextObject:e.userContext};return JSON.stringify(t)},u}t.buildEmscriptenCustomContext=i,t.buildEmscriptenCustomContextFromSite=function(e,t){return i({clientMetadata:void 0,getToken:function(e,t){throw new Error("GetToken not available in init.")},getTokenAsync:async function(){throw new Error("GetTokenAsync not available in init.")},site:e},t)}},586910:(e,t,s)=>{s.d(t,{D:()=>i});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_OfficeCopilotOrchestration_CopilotPromptsSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_OfficeCopilotOrchestration_CopilotRelatedFilesSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},596498:(e,t,s)=>{s.d(t,{h:()=>o});class o{constructor(e){o.assign(o,this,e)}static getTypeName(){return"AugLoop_Core_SchemaObject"}static getBaseTypes(){return[]}static getTypeNameFor(e){return e&&e.H_?e.H_.T_:void 0}static getBaseTypesFor(e){return e&&e.H_&&e.H_.B_&&Array.isArray(e.H_.B_)?e.H_.B_:[]}static getAllTypesFor(e){const t=o.getTypeNameFor(e);return t?[t,...o.getBaseTypesFor(e)]:[]}static matchesTypesFor(e,t){if(!Array.isArray(t)||0===t.length)return!0;const s=o.getTypeNameFor(e),n=o.getBaseTypesFor(e);for(const e of t){if(e===s)return!0;if(n.indexOf(e)>=0)return!0}return!1}static assign(e,t,s){if(s)for(const e of Object.keys(s))t[e]=s[e];return t.H_=e.H_,t}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()}},596760:(e,t,s)=>{var o,n,i;s.d(t,{PH:()=>i}),function(e){e.Success="Success",e.FetchingError="fetchingError",e.NotImplementedExcelFunction="notImplementedExcelFunction",e.CalcError="calcError",e.NotHybrid="notHybrid",e.NotSupported="notSupported",e.IncompleteDataError="incompleteDataError",e.ScratchpadError="scratchpadError",e.IntentionallyWithheld="intentionallyWithheld"}(o||(o={})),function(e){e[e.Insertion=0]="Insertion",e[e.FromColumn=1]="FromColumn"}(n||(n={})),function(e){e[e.OverrideSelection=0]="OverrideSelection",e[e.ToTableWithoutOverride=1]="ToTableWithoutOverride",e[e.OverrideFixedRange=2]="OverrideFixedRange",e[e.ToTableWithOverride=3]="ToTableWithOverride",e[e.ShiftRight=4]="ShiftRight",e[e.ShiftDown=5]="ShiftDown",e[e.InsertIntoEmptyCells=6]="InsertIntoEmptyCells"}(i||(i={}))},598418:(e,t,s)=>{s.d(t,{n:()=>n});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_TenantFeedbackData_FeedbackDiagnosticDataSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},599243:(e,t,s)=>{s.d(t,{tG:()=>C,nh:()=>x,am:()=>A,OD:()=>w,lI:()=>v,ih:()=>R});var o,n=s(540949),i=s(366548);!function(e){e.Log="Log"}(o||(o={}));var a=s(72715);const r=void 0!==a&&a.env?a.env.SERVICE_NAME:"client",c="abcdefghijklmnopqrstuvwxyz0123456789",l={97:0,98:1,99:2,100:3,101:4,102:5,103:6,104:7,105:8,106:9,107:10,108:11,109:12,110:13,111:14,112:15,113:16,114:17,115:18,116:19,117:20,118:21,119:22,120:23,121:24,122:25,48:26,49:27,50:28,51:29,52:30,53:31,54:32,55:33,56:34,57:35};let u,p=[],g=[],h=e=>null,d=e=>{};const m=new Map,y=new Map,T=new Map,f=new Map;var _,C;!function(e){e.Default="",e.EDPSCompliant="edps"}(_||(_={})),function(e){e.defineCoreLogCategory=e=>({root:"Core",name:e}),e.defineWorkflowLogCategory=e=>({root:"Workflow",name:e}),e.clearLoggers=()=>{p=[],g=[],y.clear(),T.clear()},e.clearAggregators=()=>{m.clear()},e.addLogger=e=>{-1===p.indexOf(e)&&(p.push(e),S(y,e))},e.addDecidingLogger=e=>{-1===g.indexOf(e)&&(g.push(e),S(T,e))},e.setCorrelationContextCallback=e=>{u=e},e.setStartPerformanceEventCallback=e=>{h=e},e.setStopPerformanceEventCallback=e=>{d=e},e.addAggregator=e=>{e.init(((e,t)=>{L(e,t)})),m.has(e.eventName)?m.get(e.eventName).push(e):m.set(e.eventName,[e])},e.flushAggregators=e=>{m.forEach((t=>{t.forEach((t=>t.flush(e)))}))},e.setTagLevelOverride=(e,t)=>{const s=O(e);f.set(s,t)},e.resetTagLevelOverrides=()=>{f.clear()},e.error=(e,t,s,o,i,a,r,c,l,u)=>{M(e,t,n.q.error,s,o,i,a,r,c,l,u)},e.warn=(e,t,s,o,i,a,r,c,l,u)=>{M(e,t,n.q.warn,s,o,i,a,r,c,l,u)},e.info=(e,t,s,o,i,a,r,c,l,u)=>{M(e,t,n.q.info,s,o,i,a,r,c,l,u)},e.verbose=(e,t,s,o,i,a,r,c,l,u)=>{M(e,t,n.q.verbose,s,o,i,a,r,c,l,u)},e.debug=(e,t,s,o,i,a,r,c,l,u)=>{M(e,t,n.q.debug,s,o,i,a,r,c,l,u)},e.metric=(e,t,s,o,i,a,r,c,l,u)=>{M(e,t,n.q.metric,s,o,i,a,r,c,l,u)},e.formatMetric=(e,t,s,o)=>{const n={};return n[e]={dimensionNames:s,dimensionValues:o,value:t},n},e.dynamic=e=>{L(e)}}(C||(C={}));const S=(e,t)=>{const s=t.level;Object.keys(n.q).map((e=>n.q[e])).filter((e=>"string"!=typeof e)).filter((e=>e<=s)).forEach((s=>{e.has(s)?e.get(s).push(t):e.set(s,[t])}))},A=e=>{if("string"==typeof e)return e;let t="";for(let s=0;s<e.length;s++){s>0&&(t+=" ");const o=e[s];o instanceof Error?t+=JSON.stringify({message:o.message,name:o.name,stack:o.stack}):t+="object"==typeof o?JSON.stringify(o):o}return t},v=e=>`${e.root}.${e.name}`,N=[],E=["Level","Tag"],I=["Level","Tag","Workflow"],w=e=>b(e).length,b=e=>void 0!==e?y.get(e)||N:p,k=(e,t)=>(void 0!==e?T.get(e)||[]:g).filter((e=>e.shouldLog(t))),M=(e,t,s,n,i,a,r,c,l,p,g)=>{s=f.get(e)||s;const y=b(s),T=k(s,n);if(0==y.length&&0==T.length)return;const _=h(o.Log),C=R(e),S=((e,t,s,o,n,i,a,r)=>{if(void 0===t&&("string"==typeof e||"object"==typeof e))return e;if(void 0===t&&"function"==typeof e)return e();const c=[];for(const l of[e,t,s,o,n,i,a,r])void 0!==l&&c.push("function"==typeof l?l():l);return c})(n,i,a,r,c,l,p,g);if(B(t))D(S)&&L({eventName:"Metrics",tagId:C,category:v(t),traceLevel:s,message:"",getMetrics:()=>S},!1,y,T);else if(D(S)){const e=S;e.tagId=C,e.category=v(t),"Operation"===e.eventName&&"Workflow"===t.root&&(e.eventName="WorkflowOperation",u&&(e.joinContextId=u().joinContextId,e.workflow=u().workflow)),e.traceLevel=s;const o=m.get(e.eventName);if(o)for(let t=0;t<o.length;++t){const s=o[t];if(s&&s.add(e,t===o.length-1))break}else L(e,!1,y,T)}else{const e=()=>{var e;return"Core"===t.root?{TraceEventV2:{dimensionNames:()=>E,dimensionValues:[String(s),C],value:1}}:{WorkflowTraceEvent:{dimensionNames:()=>I,dimensionValues:[String(s),C,u?null===(e=u())||void 0===e?void 0:e.workflow:""],value:1}}};L({eventName:"Log",tagId:C,category:v(t),traceLevel:s,message:A(S),getMetrics:e},!1,y,T)}d(_)},L=(e,t=!1,s,o)=>{var n,i,a,c,l,p,g,h,d,m,y,T,f,_;let C;if(null==s&&(s=b(e.traceLevel)),o=o||N,s.length>0||o.length>0){if(e.serviceName=r,!t&&u){const t=u();t&&(C={disableLogging:t.disableLogging,userDataBoundaryType:null===(i=null===(n=t.sessionDescriptor)||void 0===n?void 0:n.userContext)||void 0===i?void 0:i.userDataBoundaryType},e.cv=e.cv?e.cv:t.cv.toString(),e.sessionKey=e.sessionKey?e.sessionKey:t.sessionKey,e.userTenantId=e.userTenantId?e.userTenantId:t.userTenantId,e.workflow=e.workflow?e.workflow:t.workflow,e.clientAppName=e.clientAppName?e.clientAppName:null===(a=t.clientMetadata)||void 0===a?void 0:a.appName,e.clientAppPlatform=e.clientAppPlatform?e.clientAppPlatform:null===(c=t.clientMetadata)||void 0===c?void 0:c.appPlatform,e.clientAppVersion=e.clientAppVersion?e.clientAppVersion:null===(l=t.clientMetadata)||void 0===l?void 0:l.appVersion,e.clientDocSessionId=e.clientDocSessionId?e.clientDocSessionId:null===(p=t.clientMetadata)||void 0===p?void 0:p.docSessionId,e.clientReleaseAudienceGroup=e.clientReleaseAudienceGroup?e.clientReleaseAudienceGroup:null===(g=t.clientMetadata)||void 0===g?void 0:g.releaseAudienceGroup,e.clientReleaseChannel=e.clientReleaseChannel?e.clientReleaseChannel:null===(h=t.clientMetadata)||void 0===h?void 0:h.releaseChannel,e.clientReleaseFork=e.clientReleaseFork?e.clientReleaseFork:null===(d=t.clientMetadata)||void 0===d?void 0:d.releaseFork,e.clientRuntimeVersion=e.clientRuntimeVersion?e.clientRuntimeVersion:null===(m=t.clientMetadata)||void 0===m?void 0:m.runtimeVersion,e.clientSessionId=e.clientSessionId?e.clientSessionId:null===(y=t.clientMetadata)||void 0===y?void 0:y.sessionId,e.clientUserAgent=e.clientUserAgent?e.clientUserAgent:null===(T=t.clientMetadata)||void 0===T?void 0:T.userAgent,e.traceId=e.traceId||t.traceId,e.isClientTelemetrySampled=e.isClientTelemetrySampled?e.isClientTelemetrySampled:null===(f=t.clientMetadata)||void 0===f?void 0:f.isClientTelemetrySampled,e.userDataBoundaryType=P(C),e.ecsConfigIDs=null===(_=t.ecsConfigIDsManager)||void 0===_?void 0:_.getAllConfigIDsString())}for(const t of s)t.log(e,C);for(const t of o)t.log(e)}},B=e=>e.name===x.WorkflowMetricsOnly.name&&e.root===x.WorkflowMetricsOnly.root,D=e=>!Array.isArray(e)&&"object"==typeof e,P=e=>(null==e?void 0:e.userDataBoundaryType)===i.Om.EDPSCompliant?_.EDPSCompliant:_.Default,R=e=>c[e>>24&63]+c[e>>18&63]+c[e>>12&63]+c[e>>6&63]+c[63&e],O=e=>e&&5===e.length?l[e.charCodeAt(0)]<<24|l[e.charCodeAt(1)]<<18|l[e.charCodeAt(2)]<<12|l[e.charCodeAt(3)]<<6|l[e.charCodeAt(4)]:-1;class x{}x.CoreDefault=C.defineCoreLogCategory("Default"),x.CoreSystem=C.defineCoreLogCategory("System"),x.CoreUnsampled=C.defineCoreLogCategory("Unsampled"),x.WorkflowDefault=C.defineWorkflowLogCategory("Default"),x.WorkflowUnsampled=C.defineWorkflowLogCategory("Unsampled"),x.WorkflowMetricsOnly=C.defineWorkflowLogCategory("MetricsOnly"),x.PrivacyGuardEvent=C.defineCoreLogCategory("PrivacyGuardEvent")},601869:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.completePromiseWithin=void 0;var o=s(274070);t.completePromiseWithin=function(e,t,s){return e<=0?s:new Promise((function(n,i){var a=!1,r=setTimeout((function(){a||(a=!0,i(new Error("Timeout after ".concat(e,"ms. ").concat(t))))}),e);s.then((function(e){a||(a=!0,clearTimeout(r),n(e))}),(function(e){o.Log.error(539821445,o.LogCategory.WorkflowDefault,e),a||(a=!0,clearTimeout(r),i(e))}))}))}},605424:(e,t,s)=>{var o,n,i,a;s.d(t,{Ay:()=>n,VF:()=>o,XO:()=>i,b:()=>a}),function(e){e.CopilotChatResponseMeta="CopilotChatResponseMeta",e.DocumentGroundingMeta="DocumentGroundingMeta",e.ElseResponseMeta="ElseResponseMeta",e.FormulaResponseMeta="FormulaResponseMeta"}(o||(o={})),function(e){e.OK="OK",e.ServiceTimeout="ServiceTimeout",e.ServiceError="ServiceError",e.RAICheckFailed="RAICheckFailed",e.FormulaError="FormulaError",e.ExternalWorkbookFormulaError="ExternalWorkbookFormulaError",e.SecurityBlockedFormulaError="SecurityBlockedFormulaError",e.SearchAndActionNotAllowed="SearchAndActionNotAllowed",e.OutOfCredit="OutOfCredit",e.ImageChatChainingNotAllowed="ImageChatChainingNotAllowed"}(n||(n={})),function(e){e.OK="OK",e.ServiceTimeout="ServiceTimeout",e.ServiceError="ServiceError",e.RAICheckFailed="RAICheckFailed",e.Unknown="Unknown"}(i||(i={})),function(e){e.Started="Started",e.OK="OK",e.Unsuccessful="Unsuccessful",e.FallbackToElse="FallbackToElse",e.ServiceTimeout="ServiceTimeout",e.ServiceError="ServiceError"}(a||(a={}))},618854:(e,t,s)=>{s.d(t,{nL:()=>p});var o=s(596498);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Text_RangeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Text_MultiTileRangeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Text_LanguageDetectionSummaryAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Text_LanguageCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Text_LanguageCountAnnotationLocalized"}static getBaseTypes(){return["AugLoop_Text_LanguageCountAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Text_Definition"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Text_SuggestionsAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Text_Critique"}static getBaseTypes(){return["AugLoop_Text_SuggestionsAnnotation","AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Text_NeuralRewriteCritique"}static getBaseTypes(){return["AugLoop_Text_Critique","AugLoop_Text_SuggestionsAnnotation","AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Text_CritiqueCategoryCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Text_UniqueWordsCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Text_EmptyDocumentAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(y,this,e)}static getTypeName(){return"AugLoop_Text_IdeasPersonalizationSettingsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class T{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(T,this,e)}static getTypeName(){return"AugLoop_Text_CommentContextAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[T.getTypeName()])}}T.H_={T_:T.getTypeName(),B_:T.getBaseTypes()};class f{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(f,this,e)}static getTypeName(){return"AugLoop_Text_TextToSpeechAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class _{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(_,this,e)}static getTypeName(){return"AugLoop_Text_AutoreplaceAnnotation"}static getBaseTypes(){return["AugLoop_Text_Critique","AugLoop_Text_SuggestionsAnnotation","AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[_.getTypeName()])}}_.H_={T_:_.getTypeName(),B_:_.getBaseTypes()};class C{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(C,this,e)}static getTypeName(){return"AugLoop_Text_TextStreamAnnotation"}static getBaseTypes(){return["AugLoop_Core_StreamAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[C.getTypeName()])}}C.H_={T_:C.getTypeName(),B_:C.getBaseTypes()}},622681:(e,t)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.PerformanceEventType=void 0,function(e){e.Log="Log"}(s||(t.PerformanceEventType=s={}))},622908:(e,t,s)=>{s.d(t,{Qr:()=>h,rK:()=>m,x5:()=>d});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_WorkflowRegistrationMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionRequest"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowCancellationRequest"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_RuntimeInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_DiagnosticTraceMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_TelemetryMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_TelemetryFlushMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){o.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_SessionCloseResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){o.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_WorkflowDefinitionOverrideMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{constructor(e){o.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_GetAnnotationsRequestMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_StreamingRequest","AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{constructor(e){o.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_GetAnnotationsResponseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_StreamingResponse","AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()}},623160:(e,t,s)=>{s.d(t,{CT:()=>n,Pd:()=>a,tP:()=>i});var o=s(596498);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_CopilotChatHistoryAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_SharedCopilotChatHistoryAnnotation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_CopilotChatHistoryAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_FluxCopilotChatHistoryAnnotation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_CopilotChatHistoryAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_OperationResponse"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_CopilotChatHistoryErrorOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_AddChatOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_AddMessageOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_GetAllChatsOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){o.h.assign(g,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_GetChatOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){o.h.assign(h,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_GetCurrentChatOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{constructor(e){o.h.assign(d,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_GetMessagesOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{constructor(e){o.h.assign(m,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_GetMessagesInCurrentChatSessionOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{constructor(e){o.h.assign(y,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_RemoveAllMessagesFromCurrentChatOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class T{constructor(e){o.h.assign(T,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_DeleteChatOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[T.getTypeName()])}}T.H_={T_:T.getTypeName(),B_:T.getBaseTypes()};class f{constructor(e){o.h.assign(f,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_UpdateMessageOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class _{constructor(e){o.h.assign(_,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_UpdateChatOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[_.getTypeName()])}}_.H_={T_:_.getTypeName(),B_:_.getBaseTypes()}},626938:(e,t,s)=>{s.d(t,{f$:()=>a});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_AcsTextToSpeech_ACSTextToSpeechSynthesizeSSMLSignal"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_AcsTextToSpeech_ACSTextToSpeechSynthesizeTextSignal"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_AcsTextToSpeech_ReadAloudSpeechSynthesizeTextSignal"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_AcsTextToSpeech_ACSTextToSpeechGetVoicesSignal"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_AcsTextToSpeech_ReadAloudSpeechGetVoicesSignal"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()}},627123:(e,t,s)=>{s.d(t,{I:()=>n});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_ContentIntelligencePlatformEvaluation_ContentIntelligencePlatformEvaluationSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},629509:(e,t,s)=>{var o,n;s.d(t,{R:()=>n}),function(e){e.Submit="Action.Submit",e.Execute="Action.Execute",e.OpenUrl="Action.OpenUrl",e.ShowCard="Action.ShowCard",e.ToggleVisibility="Action.ToggleVisibility",e.OpenUrlDialog="Action.OpenUrlDialog"}(o||(o={})),function(e){e.ActionSet="ActionSet",e.Carousel="Carousel",e.CarouselPage="CarouselPage",e.ColumnSet="ColumnSet",e.Column="Column",e.Container="Container",e.FactSet="FactSet",e.Image="Image",e.ImageSet="ImageSet",e.ChoiceSetInput="Input.ChoiceSet",e.DateInput="Input.Date",e.NumberInput="Input.Number",e.TextInput="Input.Text",e.TimeInput="Input.Time",e.ToggleInput="Input.Toggle",e.Media="Media",e.ResponseAction="ResponseAction",e.RichTextBlock="RichTextBlock",e.TextRun="TextRun",e.Table="Table",e.TableCell="TableCell",e.TableRow="TableRow",e.TextBlock="TextBlock"}(n||(n={}))},632769:(e,t,s)=>{var o,n,i,a,r,c;s.d(t,{Cu:()=>c,Ww:()=>n,pT:()=>a,v1:()=>o}),function(e){e.MARKDOWN="markdown",e.HTML="html",e.TEXT="text",e.JSON="json",e.BASE64="base64",e.NONE="none"}(o||(o={})),function(e){e.NONE="none",e.TESTING="testing",e.WORD="word",e.EXCEL="excel",e.POWERPOINT="powerpoint",e.OUTLOOK="outlook",e.BIZ_CHAT="bizchat",e.BING_CHAT="bingchat",e.ONENOTE="onenote",e.FORMS="forms",e.LOOP="loop",e.COPILOTLAB="copilotlab",e.ONEDRIVE="OneDriveForBusiness",e.SHAREPOINT="SharePointPages",e.TEAMS="Teams",e.CREATEMODULE="CreateModule"}(n||(n={})),function(e){e.NONE="none",e.APP_CHAT="AppChat",e.CANVAS="Canvas",e.NARRATIVE_BUILDER="NarrativeBuilder",e.DRAFT_COMPOSE="DraftCompose",e.START_COPILOT="StartCopilot"}(i||(i={})),function(e){e.NONE="none",e.WEB="Web",e.Win32="Win32",e.MAC="Mac",e.IOS="iOS",e.ANDROID="Android"}(a||(a={})),function(e){e.People="People",e.File="File",e.Event="Event"}(r||(r={})),function(e){e.NONE="default_scenario",e.NEW="new",e.GENERATE="generate",e.OPEN="open",e.INAPP="inapp",e.EDIT="edit",e.GENERATE_AND_OPEN="generate_and_open"}(c||(c={}))},644514:(e,t,s)=>{s.d(t,{HN:()=>n});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Signals_Signal"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Core_DirtyAreaSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Core_DirtyDocumentSignal"}static getBaseTypes(){return["AugLoop_Core_DirtyAreaSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},650408:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SpeechErrorHandler=void 0;var o=s(177918),n=s(274070),i=function(){function e(){}return e.eventToMsg=function(e){switch(e){case"ConnectionRetry":return"Frontdoor Websocket Connection Retry";case"ErrorConnectionRetryFailure":return"Frontdoor Websocket Connection Retry Failed after MaxConnectionRetry";case"ErrorSpeechHandlerWebSocketFailure":return"Frontdoor Speech Handler Websocket Failure";case"ErrorProtobufDeserializationFailure":return"Frontdoor Protobuf Deserialization Failure";case"ErrorSpeechRecognitionCanceled":return"Frontdoor Speech Recognition canceled error";default:return e}},e.eventToErrorCode=function(e){switch(e){case"ConnectionRetry":return o.SpeechErrorEventCode.CONNECTION_RETRY;case"ErrorConnectionRetryFailure":return o.SpeechErrorEventCode.CONNECTION_RETRY_FAILURE;case"ErrorSpeechHandlerWebSocketFailure":return o.SpeechErrorEventCode.SPEECH_HANDLER_WS_FAILURE;case"ErrorProtobufDeserializationFailure":return o.SpeechErrorEventCode.PROTOBUF_DESERIALIZATION_FAILURE;case"ErrorSpeechRecognitionCanceled":return o.SpeechErrorEventCode.SPEECH_RECOGNITION_CANCELED;default:return o.SpeechErrorEventCode.UNKNOWN}},e.sendSpeechErrorEvent=function(e,t,s,i,a){if(e){var r=new o.SpeechErrorEvent({ErrorCode:t,ErrorMsg:s,ErrorState:i,ErrorImpact:a});e.setAnnotations(null,o.SpeechErrorEvent.getTypeName(),[r],{isSessionAnnotation:!0,immediate:!0})}else n.Log.warn(571013264,n.LogCategory.WorkflowDefault,"AL current Actions missing, won't emit SpeechErrorEvent to client.")},e}();t.SpeechErrorHandler=i},651043:(e,t,s)=>{s.d(t,{bR:()=>n});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_CopilotComprehensionArchitecture_CopilotComprehensionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_CopilotComprehensionArchitecture_CopilotComprehensionSignalFromSydneyPlugin"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_CopilotComprehensionArchitecture_CopilotComprehensionSignalWithUserPrompt"}static getBaseTypes(){return["AugLoop_CopilotComprehensionArchitecture_CopilotComprehensionSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_CopilotComprehensionArchitecture_CopilotComprehensionSignalWithRelatedDocuments"}static getBaseTypes(){return["AugLoop_CopilotComprehensionArchitecture_CopilotComprehensionSignalWithUserPrompt","AugLoop_CopilotComprehensionArchitecture_CopilotComprehensionSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_CopilotComprehensionArchitecture_CopilotComprehensionSignalWithDocumentUrl"}static getBaseTypes(){return["AugLoop_CopilotComprehensionArchitecture_CopilotComprehensionSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_CopilotComprehensionArchitecture_CopilotComprehensionSignalWithLocalization"}static getBaseTypes(){return["AugLoop_CopilotComprehensionArchitecture_CopilotComprehensionSignalWithDocumentUrl","AugLoop_CopilotComprehensionArchitecture_CopilotComprehensionSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_CopilotComprehensionArchitecture_CopilotComprehensionSignalWithPacToken"}static getBaseTypes(){return["AugLoop_CopilotComprehensionArchitecture_CopilotComprehensionSignalWithDocumentUrl","AugLoop_CopilotComprehensionArchitecture_CopilotComprehensionSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_CopilotComprehensionArchitecture_CopilotComprehensionSignalWithExchangeAttachment"}static getBaseTypes(){return["AugLoop_CopilotComprehensionArchitecture_CopilotComprehensionSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){o.h.assign(g,this,e)}static getTypeName(){return"AugLoop_CopilotComprehensionArchitecture_CopilotComprehensionSignalWithConfig"}static getBaseTypes(){return["AugLoop_CopilotComprehensionArchitecture_CopilotComprehensionSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){o.h.assign(h,this,e)}static getTypeName(){return"AugLoop_CopilotComprehensionArchitecture_CopilotComprehensionCatchUpSignal"}static getBaseTypes(){return["AugLoop_CopilotComprehensionArchitecture_CopilotComprehensionSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{constructor(e){o.h.assign(d,this,e)}static getTypeName(){return"AugLoop_CopilotComprehensionArchitecture_RelatedFilesScenarioSignal"}static getBaseTypes(){return["AugLoop_CopilotComprehensionArchitecture_CopilotComprehensionSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()}},653141:(e,t,s)=>{s.r(t),s.d(t,{AnnotationMetaDataChange:()=>h.v,AnonymizedOperation:()=>v,CorrelationContext:()=>p,CorrelationVector:()=>l.W,CustomBlockListLogger:()=>ae,ExtensionCloseReason:()=>G,ExtensionCloseType:()=>M,HttpRequestQueue:()=>a,HttpSocketList:()=>k,Log:()=>o.tG,LogCategory:()=>o.nh,LoggingAggregator:()=>g.D,Operation:()=>n.I,OutboundHttpRequest:()=>w,PrivacyGuardIssue:()=>B,ProcessIdentification:()=>c,ScenarioStats:()=>S,SessionHealthEvent:()=>d.vf,SessionHealthEventAggregation:()=>T,SessionHealthImpact:()=>d.Pq,SessionHealthReason:()=>d.l6,SessionHealthSource:()=>d.aM,SessionIssue:()=>_,Timer:()=>E,argsToString:()=>o.am,createChildCorrelation:()=>X,enter:()=>K,excelExtensionCloseEventName:()=>D,excelExtensionExpectedCloseEventName:()=>O,excelExtensionExpectedErrorEventName:()=>x,excelExtensionUnexpectedCloseEventName:()=>F,excelKeepAliveAggregationName:()=>R,excelKeepAliveMessageName:()=>P,exit:()=>Q,getCorrelation:()=>Y,getCorrelationVectorString:()=>Z,getLastEnterCorrelationContext:()=>q,getLastExitCorrelationContext:()=>$,getNumLoggers:()=>o.OD,initAsyncHooks:()=>J,logCategoryToString:()=>o.lI,now:()=>oe.t,nowMicroSeconds:()=>oe.g,resumeCorrelation:()=>se,startChildCorrelation:()=>ee,startCorrelation:()=>te,tagIdToString:()=>o.ih});var o=s(599243),n=s(937410),i=s(463192);class a extends i.F{getMetrics(){return{HttpRequestQueueV2:{dimensionNames:()=>[],dimensionValues:[],value:this.Length}}}constructor(e){super(e),this.eventName="HttpRequestQueue"}}var r=s(795048);class c extends r.m{constructor(){super(...arguments),this.eventName="ProcessIdentification"}}var l=s(447119);class u{constructor(){this.ecsConfigIDsMap={},this.ecsConfigIDs=""}updateConfigIDs(e,t,s){const o=e=>Array.isArray(e)?e:"string"==typeof e?[e]:[],n=new Set,i=o(t);i.length>0?i.forEach((e=>n.add(e))):o(s).forEach((e=>n.add(e))),this.ecsConfigIDsMap[e]=Array.from(n),this.ecsConfigIDs=Object.values(this.ecsConfigIDsMap).flat().join(",")}getAllConfigIDsString(){return this.ecsConfigIDs}getConfigIDsMap(){return this.ecsConfigIDsMap}clear(){this.ecsConfigIDsMap={}}}class p{get sessionKey(){var e;return null===(e=this.sessionDescriptor)||void 0===e?void 0:e.sessionKey}get userTenantId(){var e,t;return null===(t=null===(e=this.sessionDescriptor)||void 0===e?void 0:e.userContext)||void 0===t?void 0:t.tid}get interactionSessionId(){return this._interactionSessionId}set interactionSessionId(e){if(this._interactionSessionId&&this._interactionSessionId!==e)throw new Error("InteractionSessionId is already set");this._interactionSessionId=e}get interactionId(){return this._interactionId}set interactionId(e){if(this._interactionId&&this._interactionId!==e)throw new Error("InteractionId is already set");this._interactionId=e}constructor(e,t,s,o){var n;this.cv=e,this.sessionDescriptor=t,this.clientMetadata=s,this.workflow=null==o?void 0:o.workflow,this.joinContextId=null==o?void 0:o.joinContextId,this.performanceEvent=null==o?void 0:o.performanceEvent,this.sessionLogsSampled=void 0,this._interactionId=null==o?void 0:o.interactionId,this._interactionSessionId=null==o?void 0:o.interactionSessionId,this.traceId=null==o?void 0:o.traceId,this.disableLogging=null!==(n=null==o?void 0:o.disableLogging)&&void 0!==n&&n,this.ecsConfigIDsManager=new u}static deserialize(e){var t,s;if(e)try{const o=JSON.parse(e),n={appName:o.clientAppName,appPlatform:o.clientAppPlatform,releaseAudienceGroup:o.clientReleaseAudienceGroup,flights:o.clientFlights},i=null!==(t=o.userContext)&&void 0!==t?t:{};return i.userDataBoundaryType=null!==(s=i.userDataBoundaryType)&&void 0!==s?s:o.userDataBoundaryType,new p(new l.W(o.cv),{sessionKey:o.sessionKey,userId:o.userId,mastermindEndpoint:o.mastermindEndpoint,userContext:i},n,{workflow:o.workflow,joinContextId:o.joinContextId,interactionId:o.interactionId,interactionSessionId:o.interactionSessionId,traceId:o.traceId,disableLogging:o.disableLogging})}catch(t){return new p(new l.W(e))}}static fromExisting(e,t,s,o,n){return new p(t||e.cv,s||e.sessionDescriptor,o||e.clientMetadata,{workflow:(null==n?void 0:n.workflow)||e.workflow,joinContextId:(null==n?void 0:n.joinContextId)||e.joinContextId,performanceEvent:(null==n?void 0:n.performanceEvent)||e.performanceEvent,interactionId:(null==n?void 0:n.interactionId)||e.interactionId,interactionSessionId:(null==n?void 0:n.interactionSessionId)||e.interactionSessionId,traceId:(null==n?void 0:n.traceId)||e.traceId,disableLogging:(null==n?void 0:n.disableLogging)||e.disableLogging})}toString(){var e,t;return`${null===(e=this.clientMetadata)||void 0===e?void 0:e.appName};${null===(t=this.clientMetadata)||void 0===t?void 0:t.appPlatform};${this.sessionKey};${this.cv}`}serialize(){var e,t,s,o,n,i;const a=null===(e=this.clientMetadata)||void 0===e?void 0:e.appName,r=null===(t=this.clientMetadata)||void 0===t?void 0:t.appPlatform,c=null===(s=this.clientMetadata)||void 0===s?void 0:s.releaseAudienceGroup,l=null===(o=this.clientMetadata)||void 0===o?void 0:o.flights,u=null===(n=this.sessionDescriptor)||void 0===n?void 0:n.userContext;return p.stringify(Object.assign(Object.assign({cv:this.cv.toString()},null!==(i=this.sessionDescriptor)&&void 0!==i?i:{}),{clientAppName:a,clientAppPlatform:r,clientReleaseAudienceGroup:c,clientFlights:l,workflow:this.workflow,joinContextId:this.joinContextId,interactionId:this.interactionId,interactionSessionId:this.interactionSessionId,traceId:this.traceId,disableLogging:this.disableLogging,userContext:{tid:null==u?void 0:u.tid,oid:null==u?void 0:u.oid,userDataBoundaryType:null==u?void 0:u.userDataBoundaryType},userDataBoundaryType:null==u?void 0:u.userDataBoundaryType}))}newChild(){return new p(this.cv.newChild(),this.sessionDescriptor,this.clientMetadata,{workflow:this.workflow,joinContextId:this.joinContextId,interactionId:this.interactionId,interactionSessionId:this.interactionSessionId,traceId:this.traceId,disableLogging:this.disableLogging})}}p.schema={type:"object",properties:{cv:{type:"string"},clientAppName:{type:"string"},clientAppPlatform:{type:"string"},clientReleaseAudienceGroup:{type:"string"},clientFlights:{type:"string"},sessionKey:{type:"string"},userId:{type:"string"},mastermindEndpoint:{type:"string"},workflow:{type:"string"},joinContextId:{type:"string"},interactionId:{type:"string"},interactionSessionId:{type:"string"},traceId:{type:"string"},disableLogging:{type:"boolean"},userDataBoundaryType:{type:"number"},userContext:{type:"object",properties:{tid:{type:"string"},oid:{type:"string"},userDataBoundaryType:{type:"number"}}}}},p.stringify=(p.schema,JSON.stringify);var g=s(684078),h=s(330328),d=s(152871),m=s(978632);const y=(e,t)=>"reason"===e?d.l6[t]:"impact"===e?d.Pq[t]:t;class T extends m.Z{constructor(e,t){super({sessionHealthEventName:e,count:t.count,successes:t.successes,failures:t.failures,cancellations:t.cancellations,maxDurationMs:t.maxDurationMs,sumDurationMs:t.sumDurationMs,failureBuckets:JSON.stringify(t.failureBuckets,y),firstFailureReason:t.failureBuckets.length>0?d.l6[t.failureBuckets[0].reason]:"",firstFailureImpact:t.failureBuckets.length>0?d.Pq[t.failureBuckets[0].impact]:""}),this.eventName="SessionHealthAggregation",t.lastEvent&&(this.lastEventAffectedWorkflows=t.lastEvent.affectedWorkflows,this.lastEventCount=t.lastEvent.count,this.lastEventDurationMs=t.lastEvent.durationMs,this.lastEventImpact=t.lastEvent.impact,this.lastEventMessage=t.lastEvent.message,this.lastEventReason=t.lastEvent.reason,this.lastEventReasonDependency=t.lastEvent.reasonDependency,this.lastEventSource=t.lastEvent.source,this.lastEventSuccess=t.lastEvent.success)}}var f=s(563308);class _ extends f.Q{getMetrics(){return{"SessionIssue.CountV2":{dimensionNames:()=>_.dimensionNames,dimensionValues:this.getDimensionValues(),value:1}}}constructor(e,t){super(e),this.eventName="SessionIssue",t&&this.setClientMetadata(t)}setClientMetadata(e){e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientRuntimeVersion=e.runtimeVersion,this.clientUserAgent=e.userAgent)}getDimensionValues(){return[this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.modelItemsCountBucket,this.healthBucket,this.healthReason,this.healthSubreason,this.affectedResource,this.affectedSessions,this.suppressionReason]}}_.dimensionNames=["ClientAppName","ClientAppPlatform","ClientReleaseAudienceGroup","ModelItemsCountBucket","HealthBucket","HealthReason","HealthSubreason","AffectedResource","AffectedSessions","SuppressionReason"];var C=s(973330);class S extends C.A{getMetrics(){return{"ScenarioStats.CountV2":{dimensionNames:()=>S.dimensionNames,dimensionValues:this.getDimensionValues(),value:1},"ScenarioStatsWithSuppressions.CountV2":{dimensionNames:()=>S.dimensionNames,dimensionValues:this.getSuppressionsDimensionValues(),value:1},"ScenarioStatsScenario.CountV2":{dimensionNames:()=>S.dimensionNames,dimensionValues:this.getScenarioDimensionValues(),value:1},"ScenarioStatsScenarioWithSuppressions.CountV2":{dimensionNames:()=>S.dimensionNames,dimensionValues:this.getScenarioSuppressionsDimensionValues(),value:1}}}constructor(e,t){super(e),this.eventName="ScenarioStats",t&&this.setClientMetadata(t)}setClientMetadata(e){e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientRuntimeVersion=e.runtimeVersion,this.clientUserAgent=e.userAgent)}getDimensionValues(){return[this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.healthBucket,this.healthReason]}getSuppressionsDimensionValues(){return[this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.healthBucketWithSuppressions,this.healthReasonWithSuppressions]}getScenarioDimensionValues(){return[this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.scenarioHealthBucket,this.scenarioHealthReason]}getScenarioSuppressionsDimensionValues(){return[this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.scenarioHealthBucketWithSuppressions,this.scenarioHealthReasonWithSuppressions]}}S.dimensionNames=["ClientAppName","ClientAppPlatform","ClientReleaseAudienceGroup","ResourceId","HealthBucket","HealthReason"];var A=s(42748);class v extends A.O{constructor(e){if(super(e),this.eventName="AnonymizedOperation",this.allowListedLogs=[508856344,508688156],!this.allowListedLogs.includes(e.tagId))throw new Error("AnonymizedOperations must be allow-listed and reviewed by AugLoop engineering team. Please include your privacy approval in the review.")}}var N=s(72715);class E{constructor(e){null==e?this.reset():this.start=e}diffInMs(){const e=N.hrtime(this.start),t=1e3*e[0]+e[1]/1e6;return Math.floor(t)}diffInUs(){const e=N.hrtime(this.start),t=1e6*e[0]+e[1]/1e3;return Math.floor(t)}reset(){this.start=N.hrtime()}}var I=s(563485);class w extends I.g{getMetrics(){return{"OutboundHttpRequestV2.Wait":{dimensionNames:()=>w.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.wait},"OutboundHttpRequestV2.DNS":{dimensionNames:()=>w.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.dns},"OutboundHttpRequestV2.TCP":{dimensionNames:()=>w.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.tcp},"OutboundHttpRequestV2.FirstByte":{dimensionNames:()=>w.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.firstByte},"OutboundHttpRequestV2.Download":{dimensionNames:()=>w.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.download},"OutboundHttpRequestV2.Total":{dimensionNames:()=>w.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.total}}}constructor(e){super(e),this.eventName="OutboundHttpRequest"}getDimensionValues(){return[this.host,this.statusCode,this.success]}}w.dimensionNames=["Host","StatusCode","Success"];var b=s(441759);class k extends b.k{getMetrics(){return{HttpSocketListV2:{dimensionNames:()=>[],dimensionValues:[],value:this.Length}}}constructor(e){super(e),this.eventName="HttpSocketList"}}var M,L=s(297546);class B extends L.F{constructor(e){super(e),this.eventName="PrivacyGuardIssue"}}!function(e){e.UnexpectedClose="UnexpectedClose",e.ExpectedClose="ExpectedClose",e.ExpectedError="ExpectedError"}(M||(M={}));const D="ExcelExtensionClose",P="ExcelKeepAlive",R=`ProcessMessage_${D}`,O=`${D}_${M[M.ExpectedClose]}`,x=`${D}_${M[M.ExpectedError]}`,F=`${D}_${M[M.UnexpectedClose]}`;var G;!function(e){e[e.Unknown=0]="Unknown",e[e.SessionClosedOutside=1]="SessionClosedOutside",e[e.EcsProxyFailedToFetchWorkbookMetadata=2]="EcsProxyFailedToFetchWorkbookMetadata",e[e.EcsProxyFailedToRequestWaitForWorkbookChange=3]="EcsProxyFailedToRequestWaitForWorkbookChange",e[e.EcsProxyReconnect=4]="EcsProxyReconnect",e[e.EcsProxyUnexpected=5]="EcsProxyUnexpected",e[e.EcsSessionClosedNotification=6]="EcsSessionClosedNotification",e[e.SessionIdle=7]="SessionIdle",e[e.FailedToProducePubSubMessage=8]="FailedToProducePubSubMessage",e[e.FailedToSetSessionData=9]="FailedToSetSessionData",e[e.FailedToGetSessionData=10]="FailedToGetSessionData",e[e.ReachUnexpectedCode=11]="ReachUnexpectedCode",e[e.RequestIdMismatch=12]="RequestIdMismatch",e[e.SeedingNotRequired=13]="SeedingNotRequired",e[e.ShortAccessTokenTTLReconnect=14]="ShortAccessTokenTTLReconnect",e[e.ModelActivationWithNullRestURL=15]="ModelActivationWithNullRestURL",e[e.InvalidExcelRestUrl=16]="InvalidExcelRestUrl"}(G||(G={}));let W=new p(new l.W);const H=[];let U;const q=()=>U;let V;const $=()=>V,j=new Map;let z;const K=e=>{H.push(W),W=e,U=e},Q=e=>{if(V=e,W===e)return void(W=H.pop());const t=H.lastIndexOf(e);if(t<0)throw new Error("Context not found");if(0===t)throw new Error("Cannot remove top context");H.splice(t,1)},J=e=>{z||(z=e.createHook({init(t){const s=Y();if(s)j.set(t,s);else if(0===e.executionAsyncId()){const s=e.triggerAsyncId(),o=j.get(s);o&&j.set(t,o)}},before(e){const t=j.get(e);t&&K(t)},after(e){const t=j.get(e);t&&Q(t)},destroy(e){j.delete(e)}}),z.enable())},Y=()=>W,Z=()=>W&&W.cv&&W.cv.toString()||null,X=()=>{var e,t;return new p((null===(e=null==W?void 0:W.cv)||void 0===e?void 0:e.newChild())||new l.W,null==W?void 0:W.sessionDescriptor,null==W?void 0:W.clientMetadata,{workflow:null==W?void 0:W.workflow,joinContextId:null==W?void 0:W.joinContextId,performanceEvent:null==W?void 0:W.performanceEvent,interactionId:null==W?void 0:W.interactionId,interactionSessionId:W.interactionSessionId,traceId:null==W?void 0:W.traceId,disableLogging:null!==(t=null==W?void 0:W.disableLogging)&&void 0!==t&&t})},ee=e=>{const t=X();return se((t=>e(t&&t.cv||void 0)),t)},te=(e,t,s,o,n)=>{const i=new p(t&&l.W.fromString(t)||(null==W?void 0:W.cv)||new l.W,s||(null==W?void 0:W.sessionDescriptor),o||(null==W?void 0:W.clientMetadata),{workflow:(null==n?void 0:n.workflow)||(null==W?void 0:W.workflow),joinContextId:(null==n?void 0:n.joinContextId)||(null==W?void 0:W.joinContextId),performanceEvent:(null==n?void 0:n.performanceEvent)||(null==W?void 0:W.performanceEvent),interactionId:(null==n?void 0:n.interactionId)||(null==W?void 0:W.interactionId),interactionSessionId:(null==n?void 0:n.interactionSessionId)||(null==W?void 0:W.interactionSessionId),traceId:(null==n?void 0:n.traceId)||(null==W?void 0:W.traceId),disableLogging:(null==n?void 0:n.disableLogging)||(null==W?void 0:W.disableLogging)||!1});return se(e,i)},se=(e,t)=>{K(t);try{return e(t)}finally{Q(t)}};var oe=s(672103),ne=s(934142),ie=s(72715);class ae{constructor(e,t,s,o,n=5,i){this.severity=e,this.resourceId=t,this.tokenExpirationInMS=s,this.idleDurationInMS=o,this.kAnonUser=n,this.log=i,this.cache=new ne.l({idleDurationMs:this.idleDurationInMS,sweepInterval:6e4}),this.kAnonUser=Math.min(5,this.kAnonUser),this.log=i||this.logHits}updateTokenCount(e,t,s){this.flush();const o=Date.now(),n=this.cache.get(e);if(!n)return void this.cache.put(e,{users:[{userId:t,timestamp:o,count:s}]},this.tokenExpirationInMS);const i=n.users.find((e=>e.userId===t));if(i)i.timestamp=o,i.count+=s;else if(n.users.push({userId:t,timestamp:o,count:s}),n.users.length>=this.kAnonUser){const t=n.users.reduce(((e,t)=>e+t.count),0);this.cache.del(e),this.log(e,t)}}logHits(e,t){o.tG.info(508688156,o.nh.CoreSystem,new v({operationName:"BlocklistMatchEvent",key:e,value:t+"",datafield0:this.severity,datafield1:this.resourceId,buildVersion:ie.env.BUILD_BUILDNUMBER||"DEV",tagId:508688156}))}flush(){this.cache.forEach((e=>{e.users=e.users.filter((e=>Date.now()<e.timestamp+this.tokenExpirationInMS))}))}getCount(e){this.flush();const t=this.cache.get(e);return t?t.users.reduce(((e,t)=>e+t.count),0):0}shutdown(){this.cache.clear(),this.cache=void 0}}},653598:(e,t,s)=>{var o,n,i;s.d(t,{$n:()=>o,hc:()=>i}),function(e){e.Unknown="Unknown",e.Unlimited="Unlimited",e.Limited="Limited"}(o||(o={})),function(e){e.Unknown="Unknown",e.Substrate="Substrate",e.CopilotAgentBilling="CopilotAgentBilling",e.CopilotAgentBillingPromo="CopilotAgentBillingPromo",e.CopilotAgentBillingPAYG="CopilotAgentBillingPAYG"}(n||(n={})),function(e){e[e.Success=0]="Success",e[e.BadRequest=1]="BadRequest",e[e.Unauthorized=2]="Unauthorized",e[e.ResourcesNotFound=3]="ResourcesNotFound",e[e.Forbidden=4]="Forbidden",e[e.Timeout=5]="Timeout",e[e.InternalServerError=6]="InternalServerError",e[e.ServiceUnavailable=7]="ServiceUnavailable",e[e.Unknown=8]="Unknown",e[e.ErrorInExecution=9]="ErrorInExecution",e[e.OutOfCredits=10]="OutOfCredits",e[e.BypassDeduction=11]="BypassDeduction",e[e.Overloaded=12]="Overloaded",e[e.AgentBillingNotAvailable=13]="AgentBillingNotAvailable"}(i||(i={}))},661478:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Operation=void 0;const o=s(28488),n=s(965787),i=Symbol("dataFieldsObject"),a=Symbol("dataFieldsAreDirty"),r=Symbol("_dataFields");class c extends o.OperationEvent{constructor(e,t){super(e),this.eventName="Operation",this.options=t,this.durationMs=null==e?void 0:e.durationMs,e&&null!=e.count||(this.count=1),(null==e?void 0:e.dataFields)&&(this.dataFields=e.dataFields)}setClientMetadata(e,t){return e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,null!=t&&t||(this.clientFlights=e.flights),this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientReleaseChannel=e.releaseChannel,this.clientReleaseFork=e.releaseFork,this.clientRuntimeVersion=e.runtimeVersion,this.clientSessionId=e.sessionId,this.clientDocSessionId=e.docSessionId,this.clientUserAgent=e.userAgent),this}setUserContext(e){return e&&(this.userId=e.puid||e.oid,this.userType=e.userType&&e.userType.toString(),this.userTenantId=e.tid),this}setMetricCustomDimensions(e,t){if(!this.options)throw new Error(`Attempting to set custom dimensions ${e} to operation ${this.operationName} without activating MetricCount or MetricDuration`);this.options.metricCustomDimensions=this.options.metricCustomDimensions||{},this.options.metricCustomDimensions[e]=t}setDataField(e,t){this[i]||(this[i]={}),this[i][e]=t,this[a]=!0}setDataFields(e){this[i]||(this[i]={}),this[i]=Object.assign(Object.assign({},this[i]),e),this[a]=!0}start(){return this.startTime=(0,n.now)(),this}recordStep(e){return this.setDataField(e,Math.floor((0,n.now)()-this.startTime)),this}stop(){const e=(0,n.now)();return this.durationMs=Math.round(e-this.startTime),this}addCustomMetric(e){void 0===this.customMetrics&&(this.customMetrics=[]),this.customMetrics.push(e)}getCustomMetrics(){const e=[];if(void 0!==this.customMetrics){const t=e=>[...this.getDimensionNames(),...e.extraDimensions.map((e=>e.name))];for(const s of this.customMetrics){const o={};o[`${this.operationName}.${s.nameSuffix}`]={dimensionNames:()=>t(s),dimensionValues:[...this.getDimensionValues(),...s.extraDimensions.map((e=>e.value))],value:s.value},e.push(o)}}return e}getMetrics(e){var t,s;const o={};if(this.operationName)switch(this.operationName){case"SessionHealthOrphanedEventsWithoutProperSessionKey":case"SessionHealthOrphanedSessions":case"WorkflowActivationState":o[this.operationName+".CountV2"]={dimensionNames:c.getOrphanedSessionHealthDimensionNames.bind(c),dimensionValues:this.getOrphanedSessionHealthDimensionValues(),value:this.count};break;case"MarkUnhealthySession":case"MarkHealthWarningSession":o[this.operationName+".Reason"]={dimensionNames:c.getSessionHealthDimensionNames.bind(c),dimensionValues:this.getSessionHealthDimensionValues(),value:1};break;default:if("matchmaker_timer"===this.operationName&&(o["Workflow.DurationMs"]={dimensionNames:c.getWorkflowDimensionNames.bind(c),dimensionValues:this.getWorkflowDimensionValues(),value:this.durationMs||0},o["Workflow.Count"]={dimensionNames:c.getWorkflowDimensionNames.bind(c),dimensionValues:this.getWorkflowDimensionValues(),value:1}),void 0!==this.durationMs){const s=`${this.operationName}.DurationMsV2`;((null===(t=this.options)||void 0===t?void 0:t.metricDuration)||e.indexOf(s)>=0)&&(o[s]={dimensionNames:this.getDimensionNames.bind(this),dimensionValues:this.getDimensionValues(),value:this.durationMs})}{const t=`${this.operationName}.CountV2`;((null===(s=this.options)||void 0===s?void 0:s.metricCount)||e.indexOf(t)>=0)&&(o[t]={dimensionNames:this.getDimensionNames.bind(this),dimensionValues:this.getDimensionValues(),value:this.count})}}return o}getDimensionNames(){var e,t;let s=c.dimensionNames;if(null===(e=this.options)||void 0===e?void 0:e.metricCustomDimensions){s=s.slice();for(const e in null===(t=this.options)||void 0===t?void 0:t.metricCustomDimensions)s.push(e)}return s}getDimensionValues(){var e,t;const s=[this.success,this.clientAppName,this.clientAppPlatform,this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3];if(null===(e=this.options)||void 0===e?void 0:e.metricCustomDimensions)for(const e in null===(t=this.options)||void 0===t?void 0:t.metricCustomDimensions)s.push(this.options.metricCustomDimensions[e]);return s}static getOrphanedSessionHealthDimensionNames(){return this.orphanedSessionHealthDimensionNames}getOrphanedSessionHealthDimensionValues(){return[this.success,this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}static getSessionHealthDimensionNames(){return this.sessionHealthDimensionNames}getSessionHealthDimensionValues(){return[this.resultSignature,this.clientAppName,this.clientAppPlatform,this.clientAppVersion,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}static getWorkflowDimensionNames(){return this.workflowDimensionNames}getWorkflowDimensionValues(){return[this.resultSignature,this.resourceId,this.resourceId,this.success]}}t.Operation=c,c.dimensionNames=["Success","ClientAppName","ClientAppPlatform","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"],c.orphanedSessionHealthDimensionNames=["Success","ClientAppName","ClientAppPlatform","ClientReleaseAudienceGroup","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"],c.sessionHealthDimensionNames=["Reason","ClientAppName","ClientAppPlatform","ClientAppVersion","Dimension0","Dimension1","Dimension2","Dimension3"],c.workflowDimensionNames=["ResultSignature","WorkflowId","ResourceId","Success"],Object.defineProperty(c.prototype,"dataFields",{get:function(){var e,t;return this[a]&&(this[r]=JSON.stringify(null!==(e=this[i])&&void 0!==e?e:{}),this[a]=!1),void 0!==this[a]?this[r]:null!==(t=this[r])&&void 0!==t?t:""},set:function(e){this[i]=e&&""!==e?JSON.parse(e):{},this[r]=e,this[a]=!1},enumerable:!0,configurable:!0})},671930:(e,t,s)=>{var o;s.d(t,{Z:()=>o}),function(e){e[e.None=0]="None",e[e.Booleans=1]="Booleans",e[e.Float32s=2]="Float32s",e[e.Float64s=3]="Float64s",e[e.Int8s=4]="Int8s",e[e.Int16s=5]="Int16s",e[e.Int32s=6]="Int32s",e[e.Strings=7]="Strings",e[e.UnsignedInt8s=8]="UnsignedInt8s",e[e.UnsignedInt16s=9]="UnsignedInt16s",e[e.UnsignedInt32s=10]="UnsignedInt32s"}(o||(o={}))},672103:(e,t,s)=>{s.d(t,{g:()=>i,t:()=>n});var o=s(72715);const n=void 0!==o&&o.hrtime?()=>{const e=o.hrtime();return 1e3*e[0]+e[1]/1e6}:"undefined"!=typeof performance&&performance.now?()=>performance.now():()=>Date.now(),i=void 0!==o&&o.hrtime?()=>{const e=o.hrtime();return 1e6*e[0]+e[1]/1e3}:"undefined"!=typeof performance&&performance.now?()=>Math.round(1e3*performance.now()):()=>1e3*Date.now()},672151:(e,t,s)=>{s.d(t,{Pv:()=>i,vp:()=>n});var o=s(596498),n=(function(){function e(t){o.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_CustomProp"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EntityConfig"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccEntityConfig"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EntityConfig"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccFeatureConfig"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_FeatureConfig"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_BestMatchConfig"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_FeatureConfig"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ScopeConfig"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_FeatureConfig"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccConfig"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccFeatureConfig"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_FlagConfig"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_FeatureConfig"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_NudgeConfig"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_FeatureConfig"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_PredictionConfig"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_FeatureConfig"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ClientConfig"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SessionConfig"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),i=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_HostConfig"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();!function(){function e(t){o.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ClientMetadata"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}()},674412:(e,t,s)=>{var o,n,i,a,r,c;s.d(t,{fq:()=>o,mO:()=>i}),function(e){e[e.Success=0]="Success",e[e.BadRequest=1]="BadRequest",e[e.Unauthorized=2]="Unauthorized",e[e.ResourcesNotFound=3]="ResourcesNotFound",e[e.Forbidden=4]="Forbidden",e[e.Timeout=5]="Timeout",e[e.InternalServerError=6]="InternalServerError",e[e.ServiceUnavailable=7]="ServiceUnavailable",e[e.Unknown=8]="Unknown",e[e.ErrorInExecution=9]="ErrorInExecution",e[e.OutOfCredits=10]="OutOfCredits",e[e.BypassDeduction=11]="BypassDeduction",e[e.Overloaded=12]="Overloaded",e[e.AgentBillingNotAvailable=13]="AgentBillingNotAvailable",e[e.OutOfLimits=14]="OutOfLimits"}(o||(o={})),function(e){e[e.SubstrateMetering=1]="SubstrateMetering",e[e.SubstrateCredit=2]="SubstrateCredit"}(n||(n={})),function(e){e.Credits="Credits",e.FileReference="FileReference",e.VoiceRealTime="VoiceRealTime",e.VisionRealTime="VisionRealTime",e.DeepResearch="DeepResearch",e.CuaCapability="CuaCapability",e.ImagesCapability="ImagesCapability",e.PodcastsRealTime="PodcastsRealTime"}(i||(i={})),function(e){e.NotApplicable="N/A",e.Hourly_1="Hourly-1",e.Daily="Daily",e.Weekly="Weekly",e.Monthly="Monthly"}(a||(a={})),function(e){e.Unmetered="Unmetered",e.LimitEnabled="LimitEnabled",e.LimitUpgrade="LimitUpgrade",e.PayAsYouGo="PayAsYouGo"}(r||(r={})),function(e){e.None="None",e.Limit="Limit",e.Billing="Billing",e.Utilization="Utilization"}(c||(c={}))},675327:(e,t,s)=>{s.d(t,{B3:()=>E,NL:()=>k,NU:()=>I,PM:()=>A,eg:()=>x,g_:()=>L,ik:()=>D,oj:()=>b,sA:()=>S,vH:()=>P,zr:()=>F});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_TableUpdateStep"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_TableUpdateColumnRename"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_TableUpdateWithColumnNamesStep"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_TableUpdateStep"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_TableUpdateWithDataProviderStep"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_TableUpdateStep"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_TableUpdateWithRowIndexAndDataProviderStep"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_TableUpdateStep"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_TableUpdateWithRowIndexProviderStep"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_TableUpdateStep"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_TableUpdateAddColumnStep"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_TableUpdateWithDataProviderStep","AugLoop_ExcelDataShaping_TableUpdateStep"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_TableUpdateAddRowsStep"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_TableUpdateWithRowIndexAndDataProviderStep","AugLoop_ExcelDataShaping_TableUpdateStep"]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){o.h.assign(g,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_TableUpdateRenameColumnsStep"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_TableUpdateStep"]}static typeGuard(e){return o.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){o.h.assign(h,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_TableUpdateReplaceColumnStep"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_TableUpdateWithDataProviderStep","AugLoop_ExcelDataShaping_TableUpdateStep"]}static typeGuard(e){return o.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{constructor(e){o.h.assign(d,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_TableUpdateReplaceRowsStep"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_TableUpdateWithRowIndexAndDataProviderStep","AugLoop_ExcelDataShaping_TableUpdateStep"]}static typeGuard(e){return o.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{constructor(e){o.h.assign(m,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_TableUpdateReplaceTableStep"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_TableUpdateWithDataProviderStep","AugLoop_ExcelDataShaping_TableUpdateStep"]}static typeGuard(e){return o.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{constructor(e){o.h.assign(y,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_TableUpdateSelectColumnsStep"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_TableUpdateWithColumnNamesStep","AugLoop_ExcelDataShaping_TableUpdateStep"]}static typeGuard(e){return o.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class T{constructor(e){o.h.assign(T,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_TableUpdateSelectRowsStep"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_TableUpdateWithRowIndexProviderStep","AugLoop_ExcelDataShaping_TableUpdateStep"]}static typeGuard(e){return o.h.matchesTypesFor(e,[T.getTypeName()])}}T.H_={T_:T.getTypeName(),B_:T.getBaseTypes()};class f{constructor(e){o.h.assign(f,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_TableUpdateSortStep"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_TableUpdateWithRowIndexProviderStep","AugLoop_ExcelDataShaping_TableUpdateStep"]}static typeGuard(e){return o.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class _{constructor(e){o.h.assign(_,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_TableUpdateSplitColumnStep"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_TableUpdateWithDataProviderStep","AugLoop_ExcelDataShaping_TableUpdateStep"]}static typeGuard(e){return o.h.matchesTypesFor(e,[_.getTypeName()])}}_.H_={T_:_.getTypeName(),B_:_.getBaseTypes()};class C{constructor(e){o.h.assign(C,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_TableUpdatePlan"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[C.getTypeName()])}}C.H_={T_:C.getTypeName(),B_:C.getBaseTypes()};class S{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(S,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingAnnotationBase"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[S.getTypeName()])}}S.H_={T_:S.getTypeName(),B_:S.getBaseTypes()};class A{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(A,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingCreateQueryAnnotation"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_ExcelDataShapingAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[A.getTypeName()])}}A.H_={T_:A.getTypeName(),B_:A.getBaseTypes()};class v{constructor(e){o.h.assign(v,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingTransformationStep"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[v.getTypeName()])}}v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class N{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(N,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingEvaluateSampleAnnotation"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_ExcelDataShapingAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[N.getTypeName()])}}N.H_={T_:N.getTypeName(),B_:N.getBaseTypes()};class E{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(E,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingEditQueryAnnotation"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_ExcelDataShapingAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[E.getTypeName()])}}E.H_={T_:E.getTypeName(),B_:E.getBaseTypes()};class I{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(I,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingTableUpdatePlanAnnotation"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_ExcelDataShapingAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[I.getTypeName()])}}I.H_={T_:I.getTypeName(),B_:I.getBaseTypes()};class w{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(w,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingAgentBaseAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[w.getTypeName()])}}w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class b{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(b,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingStartSuccessAnnotation"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_ExcelDataShapingAgentBaseAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[b.getTypeName()])}}b.H_={T_:b.getTypeName(),B_:b.getBaseTypes()};class k{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(k,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingStartFailAnnotation"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_ExcelDataShapingAgentBaseAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[k.getTypeName()])}}k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()};class M{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(M,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingGeneratedScriptAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[M.getTypeName()])}}M.H_={T_:M.getTypeName(),B_:M.getBaseTypes()};class L{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(L,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingApplyTransformationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[L.getTypeName()])}}L.H_={T_:L.getTypeName(),B_:L.getBaseTypes()};class B{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(B,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingGetContextAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[B.getTypeName()])}}B.H_={T_:B.getTypeName(),B_:B.getBaseTypes()};class D{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(D,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingQueryScriptUpdateRequestAnnotation"}static getBaseTypes(){return["AugLoop_Core_ExecutionCorrelatedAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[D.getTypeName()])}}D.H_={T_:D.getTypeName(),B_:D.getBaseTypes()};class P{constructor(e){o.h.assign(P,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingQueryScriptUpdateResult"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[P.getTypeName()])}}P.H_={T_:P.getTypeName(),B_:P.getBaseTypes()};class R{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(R,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingExitModeAnnotation"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_ExcelDataShapingAgentBaseAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[R.getTypeName()])}}R.H_={T_:R.getTypeName(),B_:R.getBaseTypes()};class O{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(O,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingKeyValueStore"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[O.getTypeName()])}}O.H_={T_:O.getTypeName(),B_:O.getBaseTypes()};class x{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(x,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingClientStoreHydrationRequestAnnotation"}static getBaseTypes(){return["AugLoop_Core_ExecutionCorrelatedAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[x.getTypeName()])}}x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()};class F{constructor(e){o.h.assign(F,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingClientStoreHydrationResult"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[F.getTypeName()])}}F.H_={T_:F.getTypeName(),B_:F.getBaseTypes()}},679853:(e,t,s)=>{function o(){return"xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}s.d(t,{v4:()=>o})},684078:(e,t,s)=>{s.d(t,{D:()=>a});const o="n~",n=/\|\~/g;class i{constructor(){this.count=0,this.measureSums=new Map}}class a{constructor(e,t,s,a,r){this.buckets=new Map,this.init=e=>{this.log=e},this.add=(e,t=!0)=>{if(!this.condition||!this.condition(e))return!0===t&&this.log(e,!1),!1;const s=[];for(const t of this.dimensions)if(void 0===e[t]||null===e[t])s.push(null);else{let i="";"boolean"==typeof e[t]?i="b~":"number"==typeof e[t]&&(i=o),s.push(`${i}${e[t].toString().replace(n,"_")}`)}const a=s.join("|");let r=this.buckets.get(a);if(!r){r=new i,r.traceLevel=e.traceLevel;for(const e of this.avgMeasures)r.measureSums.set(e,0);this.buckets.set(a,r)}r.count++;for(const t of this.avgMeasures)e[t]&&r.measureSums.set(t,r.measureSums.get(t)+e[t]);return!0},this.flush=(e=!1)=>{this.buckets.forEach(((e,t)=>{const s={traceLevel:e.traceLevel,eventName:this.eventName,count:e.count},n=t.split("|");for(let e=0;e<this.dimensions.length;e++){const t=this.dimensions[e],i=n[e];0===i.indexOf("b~")?s[t]="b~true"===i:0===i.indexOf(o)?s[t]=parseInt(i.slice(2),10):s[t]=i}for(const t of this.avgMeasures)s[t]=Math.round(e.measureSums.get(t)/e.count);this.log(s,!0)})),this.buckets.clear(),e&&(this.condition=null,clearInterval(this.interval))},this.eventName=e,this.condition=t,this.dimensions=s,this.avgMeasures=a,r>0&&(this.interval=setInterval(this.flush,1e3*r))}}},693226:(e,t,s)=>{var o,n,i,a,r,c,l;s.d(t,{CY:()=>a,Go:()=>c,Rq:()=>l,S5:()=>n,gG:()=>i,nW:()=>r}),function(e){e.Document="Document",e.Enterprise="Enterprise"}(o||(o={})),function(e){e.GetCurrentChatOperation="GetCurrentChatOperation",e.GetAllChatsOperation="GetAllChatsOperation",e.GetChatOperation="GetChatOperation",e.AddChatOperation="AddChatOperation",e.AddMessageOperation="AddMessageOperation",e.GetMessagesOperation="GetMessagesOperation",e.GetMessagesInCurrentChatSession="GetMessagesInCurrentChatSession",e.RemoveAllMessagesFromCurrentChatOperation="RemoveAllMessagesFromCurrectChatOperation",e.DeleteChatOperation="DeleteChatOperation",e.UpdateMessageOperation="UpdateMessageOperation",e.UpdateChatOperation="UpdateChatOperation"}(n||(n={})),function(e){e.User="User",e.Copilot="Copilot",e.System="System"}(i||(i={})),function(e){e.Unknown="Unknown",e.Canvas="Canvas",e.Pane="Pane"}(a||(a={})),function(e){e.Success="Success",e.Failure="Failure"}(r||(r={})),function(e){e.PlainText="PlainText",e.RichText="RichText",e.AdaptiveCard="AdaptiveCard"}(c||(c={})),function(e){e.AIResponse="AIResponse",e.ContentCreation="ContentCreation",e.Python="Python"}(l||(l={}))},694597:(e,t,s)=>{s.d(t,{P:()=>i});var o=s(596498);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_GenerativeAi_MeteringApiResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_GenerativeAi_GenerativeAIMeteringResponse"}static getBaseTypes(){return["AugLoop_GenerativeAi_MeteringApiResponse","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},695934:(e,t,s)=>{s.d(t,{G2:()=>h,IW:()=>c,Lm:()=>p,Yc:()=>y,oS:()=>r,pw:()=>u});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_ExcelServerSessionExtensionConfig"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_ExcelWorkbookUpdated"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_ExcelAccessTokenRefreshed"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_ExcelKeepAlive"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_ExcelRetrieveModelRequest"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_ExcelRetrieveModelResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_ExcelSessionDiagnosticsRequest"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_ExcelSessionDiagnosticsResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){o.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_AdvanceMockGridState"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){o.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_ExcelSessionCloseReason"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_ObserverStatusAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_FullSeedingAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(y,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_WorkflowProgressAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()}},700209:(e,t,s)=>{s.d(t,{Mw:()=>a,VT:()=>i,Wd:()=>n});var o=s(596498),n=(function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ConversationalCopilot_GPT4oFinalResult"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ConversationalCopilot_GPT4oTranscript"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ConversationalCopilot_GPT4oProcessingEvent"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ConversationalCopilot_GPT4oErrorEvent"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ConversationalCopilot_AudioCopilotAnnotation"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),i=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ConversationalCopilot_CVChunkCompleteAnnotation"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),a=(function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ConversationalCopilot_CVContextAnnotation"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ConversationalCopilot_DocumentHandlerResponse"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ConversationalCopilot_PodcastHandlerResponse"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ConversationalCopilot_OAAudioCopilotAnnotation"},e.getBaseTypes=function(){return["AugLoop_ConversationalCopilot_AudioCopilotAnnotation","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}());!function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ConversationalCopilot_ActionsAudioAnnotation"},e.getBaseTypes=function(){return["AugLoop_ConversationalCopilot_AudioCopilotAnnotation","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}()},716148:(e,t,s)=>{s.d(t,{KJ:()=>n,Ob:()=>i,pK:()=>r});var o=s(596498);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_DynamicQuestionGenerator_DynamicQuestionGeneratorAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_DynamicQuestionGenerator_DynamicQuestionGeneratorStreamAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_DynamicQuestionGenerator_DynamicQuestionGeneratorStreamCompletionAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_DynamicQuestionGenerator_DynamicQuestionGeneratorSuggestedQnAAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},721646:(e,t,s)=>{s.d(t,{Cs:()=>u,Td:()=>i,U8:()=>r,f8:()=>p,i2:()=>c,og:()=>a,tj:()=>n,wR:()=>l});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SetClaimsChallengeCallbackMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_FireClaimsChallengeCallbackResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SetSeedingStatusChangeCallbackMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_FireSeedingStatusChangeCallbackResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_InteractiveAuthMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetAnnotationsResponseBridgeMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetHostBridgeSessionRequestMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetHostBridgeSessionResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()}},737649:(e,t,s)=>{s.d(t,{Yn:()=>a,jR:()=>n});var o=s(596498);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_ExcelCopilot_ExcelCopilotOdslAnnotation"}static getBaseTypes(){return["AugLoop_CopilotOdsl_CopilotOdslAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_ExcelCopilot_ExcelCopilotOdslImageAnnotation"}static getBaseTypes(){return["AugLoop_CopilotOdsl_CopilotOdslImageAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_ExcelCopilot_ExcelCopilotOutputAnnotation"}static getBaseTypes(){return["AugLoop_Copilot_CopilotOutputAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_ExcelCopilot_ExcelHandoffInboundMessage"}static getBaseTypes(){return["AugLoop_HandoffSkill_HandoffInternalMessage","AugLoop_HandoffSkill_HandoffPropertiesSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},752232:(e,t,s)=>{var o,n;s.d(t,{S:()=>o}),function(e){e.GetPluginConfig="GetPluginConfig",e.GetPluginDefinition="GetPluginDefinition",e.GetBotResult="GetBotResult",e.ReadFreFlag="ReadFreFlag",e.WriteFreFlag="WriteFreFlag"}(o||(o={})),function(e){e.DISMISSED="dismissed",e.COMPLETED="completed"}(n||(n={}))},758488:(e,t,s)=>{s.d(t,{r:()=>r});const{AugLoopTextEncoder:o,AugLoopTextDecoder:n}=(()=>{if("undefined"==typeof TextEncoder||"undefined"==typeof TextDecoder){s(395621);const e={AugLoopTextEncoder:TextEncoder,AugLoopTextDecoder:TextDecoder};return TextEncoder=void 0,TextDecoder=void 0,e}return{AugLoopTextEncoder:TextEncoder,AugLoopTextDecoder:TextDecoder}})();var i=s(837542).hp,a=function(e,t,s,o){return new(s||(s=Promise))((function(n,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function r(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((o=o.apply(e,t||[])).next())}))};class r{static extractFragments(e){if(e[0]!==r.IDENTIFIERBYTE)throw new Error("Invalid Binary: Incorrect Identifier");let t=1;const s=[],o=new DataView(e.buffer,e.byteOffset,e.byteLength);for(;t<e.byteLength;){if(t+4>e.byteLength)throw new Error("Invalid Binary: Error reading fragment length");const n=o.getUint32(t);if(t+n+4>e.byteLength)throw new Error("Invalid Binary: Fragment out of range");void 0!==i&&i.from?s.push(i.from(e.buffer,e.byteOffset+t+4,n)):s.push(new Uint8Array(e.buffer,e.byteOffset+t+4,n)),t+=4+n}if(s.length<1)throw new Error("Invalid Binary: No fragments found");return s}static deserialize(e,t=e=>e){const s=r.extractFragments(e),o=r.textDecoder.decode(s[0]);return JSON.parse(o,((e,o)=>{if("string"==typeof o){if(o.substring(0,r.BINARYKEYWORD.length)===r.BINARYKEYWORD){const e=parseInt(o.substring(r.BINARYKEYWORD.length),10);if("number"!=typeof e||e>=s.length-1)throw new Error("Invalid Binary: Binary index out of range");return t(s[e+1])}if(o.substring(0,r.ESCAPEKEYWORD.length)===r.ESCAPEKEYWORD)return o.substring(r.ESCAPEKEYWORD.length)}return o}))}static deserializeAsync(e,t=e=>a(this,void 0,void 0,(function*(){return e}))){return a(this,void 0,void 0,(function*(){const s=r.extractFragments(e),o=r.textDecoder.decode(s[0]),n=[],i=Symbol("placeholder"),a=e=>{if(Array.isArray(e)){for(let t=0;t<e.length;t++)e[t]=a(e[t]);return e}if(null!==e&&"object"==typeof e){if(e[i])return e.value;for(const t of Object.keys(e))e[t]=a(e[t]);return e}return e};let c=JSON.parse(o,((e,o)=>{if("string"==typeof o){if(o.startsWith(r.BINARYKEYWORD)){const e=parseInt(o.substring(r.BINARYKEYWORD.length),10);if("number"!=typeof e||e>=s.length-1)throw new Error("Invalid Binary: Binary index out of range");const a=t(s[e+1]);return n.push(a),(e=>{const t={[i]:!0,value:void 0};return e.then((e=>{t.value=e})),t})(a)}if(o.startsWith(r.ESCAPEKEYWORD))return o.substring(r.ESCAPEKEYWORD.length)}return o}));return yield Promise.all(n),c=yield a(c),c}))}static serializeInternal(e){const t=[void 0],s=JSON.stringify(e,((e,s)=>ArrayBuffer.isView(s)?(t.push(s),`${r.BINARYKEYWORD}${t.length-2}`):s&&"Buffer"===s.type&&Array.isArray(s.data)?(t.push(new Uint8Array(s.data)),`${r.BINARYKEYWORD}${t.length-2}`):"string"==typeof s&&s.substring(0,r.ESCAPEKEYWORD.length)===r.ESCAPEKEYWORD?r.ESCAPEKEYWORD+s:s));t[0]=r.textEncoder.encode(s);const o=t.reduce(((e,t)=>e+4+t.byteLength),0),n=new Uint8Array(o+1);n[0]=r.IDENTIFIERBYTE;let i=1;const a=new DataView(n.buffer,n.byteOffset,n.byteLength);for(const e of t)a.setUint32(i,e.byteLength),n.set(e,i+4),i+=4+e.byteLength;return n}static serialize(e){return r.serializeInternal(e)}static serializeAsync(e){return a(this,void 0,void 0,(function*(){return new Promise(((t,s)=>{try{t(r.serializeInternal(e))}catch(e){s(e)}}))}))}}r.IDENTIFIERBYTE=3,r.BINARYKEYWORD=":b",r.ESCAPEKEYWORD=":",r.textDecoder=new n,r.textEncoder=new o},758787:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SessionHealth=t.SessionHealthImpact=t.SessionHealthReason=t.SessionHealthSource=void 0;const o=s(28488),n=s(965787);var i,a,r;!function(e){e[e.Unknown=0]="Unknown",e[e.Core=1]="Core",e[e.Workflow=2]="Workflow",e[e.SessionExtension=3]="SessionExtension",e[e.Client=4]="Client",e[e.ClientRuntime=5]="ClientRuntime"}(i||(t.SessionHealthSource=i={})),function(e){e[e.Unknown=0]="Unknown",e[e.Core=1]="Core",e[e.Workflow=2]="Workflow",e[e.SessionExtension=3]="SessionExtension",e[e.Client=4]="Client",e[e.Network=5]="Network",e[e.AugLoopDependency=6]="AugLoopDependency",e[e.WorkflowDependency=7]="WorkflowDependency",e[e.ClientRuntime=8]="ClientRuntime"}(a||(t.SessionHealthReason=a={})),function(e){e[e.Unknown=0]="Unknown",e[e.None=1]="None",e[e.MissingInput=2]="MissingInput",e[e.MissingOutput=3]="MissingOutput"}(r||(t.SessionHealthImpact=r={}));class c extends o.SessionHealthEvent{constructor(e,t){var s,o;super({source:i[e.source],reason:a[e.reason],reasonDependency:e.reasonDependency,subReason:e.subReason,sessionHealthEventName:e.sessionHealthEventName,impact:r[e.impact],success:e.success,durationMs:null!==(s=e.durationMs)&&void 0!==s?s:0,count:"number"==typeof e.count?e.count:1,message:e.message,affectedWorkflows:(null!==(o=e.affectedWorkflows)&&void 0!==o?o:[]).join(","),resourceId:e.resourceId,dimension0:e.dimension0,dimension1:e.dimension1,dimension2:e.dimension2,dimension3:e.dimension3,cv:e.cv,resultSignature:e.resultSignature,resultDescription:e.resultDescription,joinContextId:e.joinContextId}),this.eventName="SessionHealth",this.aggregationEnabled=!1,t&&this.setClientMetadata(t),this.metricCount=e.metricCount,this.metricDuration=e.metricDuration}getMetrics(){const e={};return(void 0===this.metricCount||this.metricCount)&&(e[`${this.sessionHealthEventName}.CountV2`]={dimensionNames:()=>c.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.count}),(void 0===this.metricDuration||this.metricDuration)&&(e[`${this.sessionHealthEventName}.DurationMsV2`]={dimensionNames:()=>c.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.durationMs}),e}setClientMetadata(e){return e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,this.clientFlights=e.flights,this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientReleaseChannel=e.releaseChannel,this.clientReleaseFork=e.releaseFork,this.clientRuntimeVersion=e.runtimeVersion,this.clientSessionId=e.sessionId,this.clientDocSessionId=e.docSessionId,this.clientUserAgent=e.userAgent),this}setUserContext(e){return e&&(this.userId=e.puid||e.oid,this.userType=e.userType&&e.userType.toString(),this.userTenantId=e.tid),this}setReason(e){return this.reason=a[e],this}setSource(e){return this.source=i[e],this}setImpact(e){return this.impact=r[e],this}setAffectedWorkflows(e){return this.affectedWorkflows=(null!=e?e:[]).join(","),this}getAffectedWorkflows(){return this.affectedWorkflows.split(",")}enableAggregation(){return this.aggregationEnabled=!0,this}shouldBeAggregated(){return this.aggregationEnabled}start(){return this.startTime=(0,n.now)(),this}stop(){const e=(0,n.now)();return this.durationMs=Math.round(e-this.startTime),this}getDimensionValues(){var e;return[this.clientAppName,this.clientAppPlatform,this.clientAppVersion,this.success?"1":"0",`${this.reason}_${this.reasonDependency}`,this.impact,null!==(e=this.getAffectedWorkflows()[0])&&void 0!==e?e:"",this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}}t.SessionHealth=c,c.dimensionNames=["ClientAppName","ClientAppPlatform","ClientAppVersion","Success","Reason","Impact","FirstAffectedWorkflow","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"]},764738:(e,t,s)=>{s.d(t,{Dd:()=>i,bV:()=>n});var o=s(596498);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_ExcelImportData_ExcelImportDataSourcesMetadataAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_ExcelImportData_ExcelImportDataSourcesRelevancyAnnotation"}static getBaseTypes(){return["AugLoop_ExcelImportData_ExcelImportDataSourcesMetadataAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_ExcelImportData_ExcelStartRelevantMetadataAnnotation"}static getBaseTypes(){return["AugLoop_ExcelImportData_ExcelImportDataSourcesRelevancyAnnotation","AugLoop_ExcelImportData_ExcelImportDataSourcesMetadataAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},773610:(e,t,s)=>{s.d(t,{_:()=>i});var o=s(413431),n=s(497601);class i{static createFactory(e=".",t,s,n){return a=>{var r;const c=s||o.e3;return!i.onnxRetrievalPromise||a?e?((null===(r=c())||void 0===r?void 0:r.ai_outlook)&&!a?Promise.resolve():(0,o.el)(`${e}/ai_outlook.min.js`,c,"ai_outlook",t,n)).then((()=>{i.onnxRetrievalPromise=Promise.resolve(new i(c))})).catch((e=>{i.onnxRetrievalPromise=Promise.reject(e)})).then((()=>i.onnxRetrievalPromise)):Promise.reject(new Error("Error: folderPath not provided")):i.onnxRetrievalPromise}}constructor(e){this.getCache=null,this.getCache=e}createModel(e,t){var s;const o=null===(s=this.getCache())||void 0===s?void 0:s.ai_outlook;return o?(o.env.wasm.simd=!0,o.env.wasm.numThreads=0,n.Kx.create(e,t||"",o)):Promise.reject(new Error("Error: aiOutlook is undefined"))}createInputs(){return n.G0.create()}}},774414:(e,t,s)=>{var o,n,i,a;s.d(t,{$k:()=>o}),function(e){e.Unknown="Unknown",e.Canvas="Canvas",e.CopilotChat="CopilotChat",e.Test="Test"}(o||(o={})),function(e){e[e.None=0]="None",e[e.Added=1]="Added",e[e.Updated=2]="Updated",e[e.Deleted=3]="Deleted"}(n||(n={})),function(e){e[e.ContentChanged=0]="ContentChanged",e[e.ContentWasEmpty=1]="ContentWasEmpty",e[e.FormattingChanged=2]="FormattingChanged",e[e.ContentWasInsideOfTheTable=3]="ContentWasInsideOfTheTable"}(i||(i={})),function(e){e[e.AddOfZeroElements=0]="AddOfZeroElements",e[e.AddOfItemsWithExtraOrMissingIds=1]="AddOfItemsWithExtraOrMissingIds",e[e.AddOfItemWithUndefinedId=2]="AddOfItemWithUndefinedId",e[e.AddOfUndefinedItem=3]="AddOfUndefinedItem",e[e.AddOfItemsWithDuplicateIds=4]="AddOfItemsWithDuplicateIds",e[e.SetHeadToNonExistingItem=5]="SetHeadToNonExistingItem",e[e.DeleteOfNonExistingItem=6]="DeleteOfNonExistingItem",e[e.UpdateOfNonExistentItem=7]="UpdateOfNonExistentItem",e[e.UpdateOfStubbedItem=8]="UpdateOfStubbedItem",e[e.MoveOfNonExistentItem=9]="MoveOfNonExistentItem",e[e.UpdateMetaDataOfNonAnnotationType=10]="UpdateMetaDataOfNonAnnotationType",e[e.SequentialyInvertedUpdate=11]="SequentialyInvertedUpdate",e[e.MoveToTheSamePath=12]="MoveToTheSamePath",e[e.UnknownOperation=13]="UnknownOperation",e[e.DeltaOfNonExistingItem=100]="DeltaOfNonExistingItem"}(a||(a={}))},775352:(e,t,s)=>{s.d(t,{KL:()=>i,SM:()=>u,Yd:()=>r,aO:()=>n,dV:()=>l,k2:()=>c,uH:()=>a});var o=s(596498),n=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_NudgeAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),i=(function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_NudgeAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_NudgeAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_NudgeAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_NudgeAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),a=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_FlagAnnotation"},e.getBaseTypes=function(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),r=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_PredictionAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),c=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_PredictionAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_PredictionAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),l=(function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_PredictionAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_PredictionAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedAnnotation"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),u=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();!function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedAnnotation","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}()},775573:(e,t,s)=>{var o;s.d(t,{N:()=>o}),function(e){e.Unknown="Unknown",e.Testing="Testing",e.CopilotSummary="Copilot Summary",e.CopilotCompose="Copilot Compose",e.Rewrite="Copilot Rewrite",e.ChatQnA="Copilot Chat Question & Answer",e.CIQ="Context IQ",e.Editor="Editor",e.Handoff="Handoff",e.ReadAloud="Read Aloud"}(o||(o={}))},778685:(e,t,s)=>{var o,n,i,a;s.d(t,{az:()=>n,sR:()=>o}),function(e){e.InternalError="internalError",e.Success="success",e.NoSuggestion="noSuggestion",e.MultipleFormulas="multipleFormulas",e.NoCopilotLicense="noCopilotLicense",e.AuthFailure="authFailure",e.UserThrottled="userThrottled",e.HarmfulContent="harmfulContent",e.IrrelevantQuery="irrelevantQuery",e.LlmGeneralErrorFailure="llmGeneralErrorFailure",e.InsufficientInputError="insufficientInputError"}(o||(o={})),function(e){e.ColumnSuggestion="ColumnSuggestion",e.CellSuggestion="CellSuggestion",e.NlToFormulaSuggestion="NlToFormulaSuggestion"}(n||(n={})),function(e){e.MonthDayYear="MonthDayYear",e.DayMonthYear="DayMonthYear",e.YearMonthDay="YearMonthDay",e.MonthYearDay="MonthYearDay",e.DayYearMonth="DayYearMonth",e.YearDayMonth="YearDayMonth"}(i||(i={})),function(e){e.Parenthesis="Parenthesis",e.Lead="Lead",e.Internal="Internal",e.Trail="Trail"}(a||(a={}))},782593:(e,t,s)=>{var o,n;s.d(t,{G:()=>o,K:()=>n}),function(e){e[e.Input=0]="Input",e[e.Exception=1]="Exception",e[e.WaitOn=2]="WaitOn",e[e.StopAndFilterWorkflow=3]="StopAndFilterWorkflow"}(o||(o={})),function(e){e[e.Unknown=0]="Unknown",e[e.NoOutput=1]="NoOutput",e[e.Authentication=2]="Authentication",e[e.JoinTimedOut=3]="JoinTimedOut",e[e.LambdaThrow=4]="LambdaThrow",e[e.LambdaErrorCallback=5]="LambdaErrorCallback"}(n||(n={}))},790900:(e,t,s)=>{s.d(t,{Ex:()=>m,OE:()=>_,TM:()=>S,Wh:()=>d,Ww:()=>v,fm:()=>h,hM:()=>C,j5:()=>g});var o=s(596498);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadAnnotation"}static getBaseTypes(){return["AugLoop_Core_ExecutionCorrelatedAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadCalculateColumnPreviewAnnotation"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadAnnotation","AugLoop_Core_ExecutionCorrelatedAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadCalculateRowPreviewAnnotation"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadAnnotation","AugLoop_Core_ExecutionCorrelatedAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadGetRangeAnnotation"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadAnnotation","AugLoop_Core_ExecutionCorrelatedAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadGetItemsAnnotation"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadAnnotation","AugLoop_Core_ExecutionCorrelatedAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadWorkbookTableMetadataAnnotation"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadAnnotation","AugLoop_Core_ExecutionCorrelatedAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadGetFileTablesMetadataAnnotation"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadAnnotation","AugLoop_Core_ExecutionCorrelatedAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadSingleCellPreviewAnnotation"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadAnnotation","AugLoop_Core_ExecutionCorrelatedAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(g,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadCommandingAnnotation"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadAnnotation","AugLoop_Core_ExecutionCorrelatedAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(h,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadChartRecommendationAnnotation"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadAnnotation","AugLoop_Core_ExecutionCorrelatedAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(d,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadStartNewSessionAnnotation"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadAnnotation","AugLoop_Core_ExecutionCorrelatedAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(m,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadExecuteScriptInClientAnnotation"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadAnnotation","AugLoop_Core_ExecutionCorrelatedAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(y,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadGeneratedFormulaPreviewAnnotation"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadAnnotation","AugLoop_Core_ExecutionCorrelatedAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class T{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(T,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadExecutePythonCodeRequestAnnotation"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadAnnotation","AugLoop_Core_ExecutionCorrelatedAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[T.getTypeName()])}}T.H_={T_:T.getTypeName(),B_:T.getBaseTypes()};class f{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(f,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadGetPythonCodeResultAnnotation"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadAnnotation","AugLoop_Core_ExecutionCorrelatedAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class _{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(_,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadStartSnapshotAnnotation"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadAnnotation","AugLoop_Core_ExecutionCorrelatedAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[_.getTypeName()])}}_.H_={T_:_.getTypeName(),B_:_.getBaseTypes()};class C{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(C,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadExecuteRichApiBatchAnnotation"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadAnnotation","AugLoop_Core_ExecutionCorrelatedAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[C.getTypeName()])}}C.H_={T_:C.getTypeName(),B_:C.getBaseTypes()};class S{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(S,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadApplyChangesAnnotation"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadAnnotation","AugLoop_Core_ExecutionCorrelatedAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[S.getTypeName()])}}S.H_={T_:S.getTypeName(),B_:S.getBaseTypes()};class A{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(A,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadApplyChangesCompleteAnnotation"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadAnnotation","AugLoop_Core_ExecutionCorrelatedAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[A.getTypeName()])}}A.H_={T_:A.getTypeName(),B_:A.getBaseTypes()};class v{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(v,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadScriptExecutionCompleteAnnotation"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadAnnotation","AugLoop_Core_ExecutionCorrelatedAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[v.getTypeName()])}}v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()}},791177:(e,t,s)=>{s.r(t),s.d(t,{ActivationTier:()=>R.XJ,AsyncBoundaryLoaderKind:()=>r,AsyncBoundaryLoaderType:()=>a,AsyncBoundaryRequest:()=>u,AuthTokenType:()=>i.OY,BillingDomain:()=>R.mk,BlobStorageType:()=>o,CoherencyError:()=>O,DataCategories:()=>M.b,DiagnosticLevel:()=>M.E,DlpPolicyScope:()=>R.Bh,Environment:()=>c.O,EnvironmentNameTranslation:()=>c.Q,EventStatus:()=>N,ExpectedError:()=>A.D,FilteringAsyncBoundaryRequest:()=>p,GridRangeFilter:()=>m,GridRangeSampleFilter:()=>y,GridSubtreeFilter:()=>d,InputStage:()=>R.RN,ItemCardinality:()=>B,ItemRole:()=>L,LoggingLevel:()=>E.q,ModelIteratingAsyncBoundaryRequest:()=>g,OAuth2GrantFlow:()=>i.Av,OAuth2V2LoginStatus:()=>i.rN,Pattern:()=>S,PrefilterActionType:()=>R.Uy,PrefilterType:()=>R.gd,ProducerWaitPolicy:()=>R.qW,RequestedContextCardinality:()=>R.in,RichContentBlobNodeName:()=>w,SequentialItemFilter:()=>h,SerializationProfile:()=>b,SetMessagesOperationType:()=>n,TriggerCondition:()=>R.ov,Type:()=>T.Z,UnitType:()=>R.ni,UserDataBoundaryType:()=>i.Om,UserType:()=>i.ut,WorkflowCancellationReason:()=>k,WorkflowDefinitionScope:()=>A.T,WorkflowExecutionThrottleResponse:()=>P,WorkflowKind:()=>R.wC,WorkflowStoreType:()=>D,WorkflowVisibility:()=>R.Y$,blobContainerNodeName:()=>I,gatewayType:()=>v,isExceptionMessage:()=>C,stringifyReplacer:()=>f,wwwAuthenticateHeaderString:()=>x});var o,n,i=s(366548);!function(e){e.Azure="azure",e.Spe="spe",e.Local="local"}(o||(o={})),function(e){e[e.Add=1]="Add",e[e.Update=2]="Update",e[e.Delete=3]="Delete"}(n||(n={}));var a,r,c=s(263682),l=s(596498);class u{constructor(e){l.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Interfaces_AsyncBoundaryRequest"}static getBaseTypes(){return[]}static typeGuard(e){return l.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){l.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Interfaces_FilteringAsyncBoundaryRequest"}static getBaseTypes(){return["AugLoop_Interfaces_AsyncBoundaryRequest"]}static typeGuard(e){return l.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){l.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Interfaces_ModelIteratingAsyncBoundaryRequest"}static getBaseTypes(){return["AugLoop_Interfaces_AsyncBoundaryRequest"]}static typeGuard(e){return l.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){l.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Interfaces_SequentialItemFilter"}static getBaseTypes(){return["AugLoop_Core_ItemFilter"]}static typeGuard(e){return l.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{constructor(e){l.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Interfaces_GridSubtreeFilter"}static getBaseTypes(){return["AugLoop_Core_ItemFilter"]}static typeGuard(e){return l.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{constructor(e){l.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Interfaces_GridRangeFilter"}static getBaseTypes(){return["AugLoop_Core_ItemFilter"]}static typeGuard(e){return l.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{constructor(e){l.h.assign(y,this,e)}static getTypeName(){return"AugLoop_Interfaces_GridRangeSampleFilter"}static getBaseTypes(){return["AugLoop_Interfaces_GridRangeFilter","AugLoop_Core_ItemFilter"]}static typeGuard(e){return l.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()},function(e){e[e.MastermindAsyncBoundaryLoader=0]="MastermindAsyncBoundaryLoader",e[e.TruncatedModelIteratingLoader=1]="TruncatedModelIteratingLoader",e[e.ExcelAsyncBoundaryLoader=2]="ExcelAsyncBoundaryLoader",e[e.TruncatedModelNoPulling=3]="TruncatedModelNoPulling"}(a||(a={})),function(e){e[e.Filtering=0]="Filtering",e[e.ModelIterating=1]="ModelIterating"}(r||(r={}));var T=s(671930);const f=(e,t)=>"object"==typeof t&&null!==t&&0===Object.keys(t).length?void 0:t;var _=s(782593);const C=e=>null==e||null==e.messageType||e.messageType==_.G.Exception;var S;!function(e){e[e.PubSub=0]="PubSub",e[e.RequestReply=1]="RequestReply"}(S||(S={}));var A=s(59765);const v="Gateway";var N,E=s(540949);!function(e){e[e.Active=0]="Active",e[e.Stopped=1]="Stopped",e[e.Paused=2]="Paused"}(N||(N={}));const I="filesBlobs";var w,b;!function(e){e.FileParts="fileParts",e.FullFile="fullFile"}(w||(w={})),function(e){e[e.JSONB=0]="JSONB",e[e.JSON=1]="JSON",e[e.JSOND=2]="JSOND",e[e.Disabled=3]="Disabled",e[e.COMPRESSEDJSON=4]="COMPRESSEDJSON",e[e.MESSAGEPACK=5]="MESSAGEPACK",e[e.COMPRESSEDMESSAGEPACK=6]="COMPRESSEDMESSAGEPACK"}(b||(b={}));var k,M=s(138084);!function(e){e[e.Other=0]="Other",e[e.DocumentUpdate=1]="DocumentUpdate",e[e.Timeout=2]="Timeout",e[e.CloseSession=3]="CloseSession",e[e.PurgeOrDelete=4]="PurgeOrDelete",e[e.Client=5]="Client",e[e.Merged=6]="Merged",e[e.MergedPendingTask=7]="MergedPendingTask",e[e.GridSplit=8]="GridSplit"}(k||(k={}));var L,B,D,P,R=s(256226);class O extends Error{constructor(e="CoherencyError"){super(e),this.__proto__=O.prototype}}!function(e){e[e.Input=1]="Input",e[e.Output=2]="Output"}(L||(L={})),function(e){e[e.Single=1]="Single",e[e.Any=-1]="Any",e[e.Optional=-2]="Optional",e[e.Some=-3]="Some"}(B||(B={})),function(e){e[e.WorkflowSession=0]="WorkflowSession",e[e.User=1]="User"}(D||(D={})),function(e){e[e.NoThrottle=0]="NoThrottle",e[e.SoftThrottle=1]="SoftThrottle",e[e.HardThrottle=2]="HardThrottle"}(P||(P={}));const x="www-authenticate"},795048:(e,t,s)=>{s.d(t,{m:()=>n});var o={util:{},roots:{default:{}}},n=(o.util,o.roots.default||(o.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.Pid=0,e.prototype.ApplicationName="",e.prototype.ServiceName="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/ProcessIdentificationEvent"},e}())},795167:(e,t,s)=>{s.d(t,{dF:()=>r,kp:()=>n,uC:()=>i});var o=s(596498);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffOutboundMessage"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffMessage"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffEncodedPrompt"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffDocUrlAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffPluginAnswer"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()}},796462:(e,t,s)=>{s.d(t,{Aq:()=>g,MY:()=>m,ZF:()=>y,yq:()=>h,zX:()=>T});var o=s(599243),n=s(937410),i=s(20214),a=s(596498),r=s(222709),c=s(644514),l=s(70239),u=s(297288),p=s.n(u);class g{static createHealthCheckRequest(e){return{payload:{},payloadSchema:{category:i.v.Schema,schema:{name:"HealthCheckRequest"}},requestedSchema:{category:i.v.Schema,schema:{name:"HealthCheckResponse"}},clientMetadata:Object.assign(Object.assign({},e),{flights:""})}}static isFeatureEnabled(e,t,s=!1,o="None"){return e&&e.isFeatureEnabled?e.isFeatureEnabled("Microsoft.Office.AugLoop."+t,o).catch((()=>Promise.resolve(s))):Promise.resolve(s)}static isChangeGateEnabled(e,t){return e&&e.isChangeGateEnabled?e.isChangeGateEnabled(t):Promise.resolve(!1)}static convertWebSocketUrlToHttp(e){return this.convertUrl(e,!1)}static convertServiceUrlToWebSocket(e){return this.convertUrl(e,!0)}static convertUrl(e,t){if(!e)return e;const s=e.split(":");let o=s[0].toLowerCase();return 0==o.indexOf(t?"http":"ws")?(o=t?o.replace("http","ws"):o.replace("ws","http"),s[0]=o,s.join(":")):e}static deepEquals(e,t){return p()(e,t)}static collectTelemetry(e,t,s,n,i,a){var r,c,l,u;e.start(),e.resultSignature=null!=n?n:"",e.resultDescription=null!=i?i:"",e.success=s,a?(e.dimension0=null!==(r=a[0])&&void 0!==r?r:"",e.dimension1=null!==(c=a[1])&&void 0!==c?c:"",e.dimension2=null!==(l=a[2])&&void 0!==l?l:"",e.dimension3=null!==(u=a[3])&&void 0!==u?u:""):(e.dimension0="",e.dimension1="",e.dimension2="",e.dimension3=""),t.log((()=>o.tG.info(508367457,o.nh.CoreDefault,e.stop())))}}g.getCurrentTimeMs=()=>Date.now?Date.now():(new Date).getTime();class h{constructor(e){this.maxNumberOfLogs=40,this.numberOfLogs=0,this.id=e}log(e){if(this.numberOfLogs<this.maxNumberOfLogs&&(this.numberOfLogs++,e(),this.numberOfLogs===this.maxNumberOfLogs)){const e=new n.I({operationName:"OnLastLog",success:!0,resourceId:this.id,resultDescription:`Limit for number of logs for id: ${this.id} reached - all next logs will be dropped`});o.tG.warn(572838107,o.nh.CoreDefault,e)}}}const d=[a.h.getTypeName(),r.YH.getTypeName(),c.HN.getTypeName()],m=e=>{const t=new Set;for(const s of e)if("string"==typeof s)-1===d.indexOf(s)&&t.add(s);else for(const e of[s.getTypeName(),...s.getBaseTypes()])-1===d.indexOf(e)&&t.add(e);return Array.from(t)},y=(e,t=0)=>Number.isFinite(e)?e:t,T=(e,t)=>{if(!Array.isArray(t)||0===t.length)return!0;if(l.xU.typeGuard(e)||l.XP.typeGuard(e))return!0;for(const s of e.items)if(!s.body||a.h.matchesTypesFor(s.body,t))return!0;return!1}},802484:function(e,t,s){var o=this&&this.__createBinding||(Object.create?function(e,t,s,o){void 0===o&&(o=s);var n=Object.getOwnPropertyDescriptor(t,s);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,o,n)}:function(e,t,s,o){void 0===o&&(o=s),e[o]=t[s]}),n=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||o(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),n(s(361388),t),n(s(580632),t)},817658:(e,t,s)=>{s.d(t,{H6:()=>n});var o=s(596498);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_OfficeaiIncubationApp_OfficeaiIncubationAppAnnotation"}static getBaseTypes(){return["AugLoop_Copilot_CopilotOutputAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_OfficeaiIncubationApp_OfficeaiIncubationAppStreamingAnnotation"}static getBaseTypes(){return["AugLoop_OfficeaiIncubationApp_OfficeaiIncubationAppAnnotation","AugLoop_Copilot_CopilotOutputAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_OfficeaiIncubationApp_OfficeaiIncubationAppCopilotChatHistoryAnnotation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_FluxCopilotChatHistoryAnnotation","AugLoop_CopilotChatHistory_CopilotChatHistoryAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},817685:(e,t,s)=>{s.d(t,{d:()=>n});var o=s(596498);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_CreditBalance_CreditBalanceAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},825688:(e,t,s)=>{s.d(t,{$g:()=>i,Fe:()=>n,J2:()=>r,Nh:()=>g,Vm:()=>p,Vn:()=>h,Zx:()=>l,c$:()=>c,gh:()=>u,os:()=>a});var o=s(596498),n=function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UxTreatments"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),i=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccResultAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),a=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccResultAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),r=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccResultAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),c=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccResultAnnotationHybrid"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),l=(function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccResultAnnotationODSP"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccResultAnnotation","AugLoop_ObservationalAssistance_EccResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedResultAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),u=(function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationHybrid"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),p=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),g=(function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationHybrid"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),h=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_FlagResultAnnotation"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()},850195:(e,t,s)=>{s.d(t,{b:()=>je});var o=s(206855),n=s(596498);class i{constructor(){this._fulfilled=!1,this.completion=new Promise(((e,t)=>{this.onResolve=e,this.onReject=t}))}resolve(e){this._fulfilled=!0,this.onResolve(e)}reject(e){this._fulfilled=!0,this.onReject(e)}get fulfilled(){return this._fulfilled}}var a=s(383340),r=s(444954),c=function(e,t,s,o){return new(s||(s=Promise))((function(n,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function r(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((o=o.apply(e,t||[])).next())}))};class l{constructor(e,t,s){this.scheduler=e,this.callerCancelToken=t,this.timeoutMs=s}runWithCombinedToken(e){return c(this,void 0,void 0,(function*(){const t=new a.A9(this.scheduler),s=new a.aG(this.callerCancelToken,t.token);try{return void 0!==this.timeoutMs&&t.cancelAfter(this.timeoutMs),yield e(s.token)}catch(e){if(e instanceof r._b&&!this.callerCancelToken.IsCancellationRequested&&t.token.IsCancellationRequested)throw new r.Xq(`strategy timeout: ${this.timeoutMs}`);throw e}finally{s.dispose(),t.dispose()}}))}}var u=function(e,t,s,o){return new(s||(s=Promise))((function(n,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function r(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((o=o.apply(e,t||[])).next())}))};class p{constructor(e,t){this.value=null,this.error=null,this.value=e,this.error=t}static createValue(e){return new p(e,null)}static createError(e){return new p(null,e)}isError(){return null!==this.error}}class g{constructor(){this.items=[],this.pendingDequeuePromise=null}enqueue(e){var t;this.items.push(p.createValue(e)),null===(t=this.pendingDequeuePromise)||void 0===t||t.resolve()}enqueueError(e){var t;this.items.push(p.createError(e)),null===(t=this.pendingDequeuePromise)||void 0===t||t.resolve()}dequeue(e){return u(this,void 0,void 0,(function*(){if(0===this.items.length){if(this.pendingDequeuePromise)throw new Error("Cannot have simultaneous dequeues");this.pendingDequeuePromise=new i;try{yield Promise.race([this.pendingDequeuePromise.completion,e.rejectWhenCancellationRequested()])}finally{this.pendingDequeuePromise=null}}return this.items.shift()}))}empty(){return 0===this.items.length}}var h,d=s(599243),m=function(e,t,s,o){return new(s||(s=Promise))((function(n,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function r(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((o=o.apply(e,t||[])).next())}))},y=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,s=e[Symbol.asyncIterator];return s?s.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(s){t[s]=e[s]&&function(t){return new Promise((function(o,n){(function(e,t,s,o){Promise.resolve(o).then((function(t){e({value:t,done:s})}),t)})(o,n,(t=e[s](t)).done,t.value)}))}}};class T{constructor(e,t,s,o,n){this.session=e,this.request=t,this.cancelToken=s,this.scheduler=o,this.logOp=n,this.logOp.resourceId="StreamingRequest"}execute(){return m(this,void 0,void 0,(function*(){const e=this.request.firstAnnotationTimeoutMs?Math.min(this.request.firstAnnotationTimeoutMs,this.request.perAnnotationTimeoutMs):this.request.perAnnotationTimeoutMs,t={annotationType:[this.request.chunks.getTypeName(),this.request.completion.getTypeName()],transientItems:this.request.operation.items.map((e=>Object.assign(Object.assign({},e),{parentPath:this.request.operation.parentPath}))),maxDelayMs:e,sourceInfo:{}},s=this.session.getAnnotations(t,this.cancelToken),o=new g,n=new f(s,this.scheduler,this.cancelToken,this.request,o,this.logOp);return n.initialize().catch((e=>{o.enqueueError(e)})),Promise.resolve(n)}))}}class f{constructor(e,t,s,o,n,a){this.iterable=e,this.scheduler=t,this.cancelToken=s,this.request=o,this.queue=n,this.logOp=a,this.completionPromise=new i,this.complete=!1,this.isFirstAnnotation=!0}subscribeResults(e){var t,s,o,n,i,a,r;return m(this,void 0,void 0,(function*(){try{try{for(t=!0,s=y(e);o=yield s.next(),!(n=o.done);t=!0){r=o.value,t=!1;const e=r;if(this.completionPromise.fulfilled)break;this.onGetAnnotationResponse(e)}}catch(e){i={error:e}}finally{try{t||n||!(a=s.return)||(yield a.call(s))}finally{if(i)throw i.error}}}catch(e){this.queue.enqueueError(e)}}))}initialize(){return m(this,void 0,void 0,(function*(){return this.subscribeResults(this.iterable)}))}onGetAnnotationResponse(e){if(e.error)throw new r.m6(JSON.stringify(e.error),e.error);const t=e.content.map((e=>e.body));for(const e of t)this.isFirstAnnotation&&(this.isFirstAnnotation=!1),this.queue.enqueue(e);e.finalResponse&&(this.complete=!0)}[Symbol.asyncIterator](){return this}get chunks(){return this}get completion(){return this.completionPromise.completion}next(){return m(this,void 0,void 0,(function*(){try{const e=this.request.firstAnnotationTimeoutMs&&this.request.firstAnnotationTimeoutMs?this.request.firstAnnotationTimeoutMs:this.request.perAnnotationTimeoutMs,t=new l(this.scheduler,this.cancelToken,e),s=yield t.runWithCombinedToken(this.waitForNextEvent.bind(this)),{value:o}=s;return s.isError()?this.handleError(s.error):this.complete&&this.queue.empty()?this.request.completion.typeGuard(o)?(this.completionPromise.resolve(o),this.handleFinalResult(o)):this.handleError(new r.Ek(`(Streaming completion) expect: ${this.request.completion.getTypeName()}, received: ${n.h.getTypeNameFor(o)}`)):this.request.chunks.typeGuard(o)?{done:!1,value:o}:this.handleError(new r.Ek(`(Streaming chunks) expect: ${this.request.chunks.getTypeName()}, received: ${n.h.getTypeNameFor(o)}`))}catch(e){return this.handleError(e)}}))}handleError(e){return this.completionPromise.reject(e),this.logOp.success=!1,this.logOp.resultDescription=`[name, message, stack]: [${e.name}, ${e.message}, ${e.stack}]`,this.handleFinalResult(e)}handleFinalResult(e){return d.tG.info(505427165,d.nh.CoreDefault,this.logOp.stop()),{done:!0,value:e}}waitForNextEvent(e){return m(this,void 0,void 0,(function*(){return yield this.queue.dequeue(e)}))}}!function(e){e[e.SingleAnnotation=0]="SingleAnnotation",e[e.Streaming=1]="Streaming",e[e.CustomMessage=2]="CustomMessage"}(h||(h={}));var _=function(e,t,s,o){return new(s||(s=Promise))((function(n,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function r(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((o=o.apply(e,t||[])).next())}))},C=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,s=e[Symbol.asyncIterator];return s?s.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(s){t[s]=e[s]&&function(t){return new Promise((function(o,n){(function(e,t,s,o){Promise.resolve(o).then((function(t){e({value:t,done:s})}),t)})(o,n,(t=e[s](t)).done,t.value)}))}}};class S{constructor(e,t,s,o,n){this.session=e,this.request=t,this.cancelToken=s,this.scheduler=o,this.logOp=n,this.completionPromise=new i,this.logOp.resourceId="SingleAnnotationRequest"}execute(){return _(this,void 0,void 0,(function*(){try{const e=new l(this.scheduler,this.cancelToken,this.request.timeoutMs);return yield e.runWithCombinedToken(this.executeOnAnnotation.bind(this))}catch(e){throw this.logOp.success=!1,this.logOp.resultDescription=`[name, message, stack]: [${e.name}, ${e.message}, ${e.stack}]`,e}finally{d.tG.info(505427166,d.nh.CoreDefault,this.logOp.stop())}}))}executeOnAnnotation(e){return _(this,void 0,void 0,(function*(){try{const t={annotationType:[this.request.annotation.getTypeName()],transientItems:this.request.operation.items.map((e=>Object.assign(Object.assign({},e),{parentPath:this.request.operation.parentPath}))),maxDelayMs:this.request.timeoutMs,sourceInfo:{}},s=this.session.getAnnotations(t,e);return yield Promise.race([this.subscribeAnnotations(s),e.rejectWhenCancellationRequested()])}catch(e){throw e}}))}subscribeAnnotations(e){var t,s,o,i,a,c,l;return _(this,void 0,void 0,(function*(){try{for(t=!0,s=C(e);o=yield s.next(),!(i=o.done);t=!0){l=o.value,t=!1;const e=l;if(e.error){this.completionPromise.reject(new r.m6(JSON.stringify(e.error),e.error));break}const s=e.content.map((e=>e.body));1==s.length?this.request.annotation.typeGuard(s[0])?this.completionPromise.resolve(s[0]):this.completionPromise.reject(new r.Ek(`(SingleAnnotation) expect: ${this.request.annotation.getTypeName()}, received: ${n.h.getTypeNameFor(s[0])}`)):this.completionPromise.reject(new r.TQ(`Number of annotations received: ${s.length}`));break}}catch(e){a={error:e}}finally{try{t||i||!(c=s.return)||(yield c.call(s))}finally{if(a)throw a.error}}return this.completionPromise.completion}))}}var A=function(e,t,s,o){return new(s||(s=Promise))((function(n,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function r(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((o=o.apply(e,t||[])).next())}))};class v{constructor(e,t,s,o,n){this.session=e,this.request=t,this.cancelToken=s,this.scheduler=o,this.logOp=n,this.logOp.resourceId="CustomMessageRequest"}execute(){return A(this,void 0,void 0,(function*(){try{const e=new l(this.scheduler,this.cancelToken,this.request.timeoutMs);return yield e.runWithCombinedToken(this.executeOnAnnotation.bind(this))}catch(e){throw this.logOp.success=!1,this.logOp.resultDescription=`[name, message, stack]: [${e.name}, ${e.message}, ${e.stack}]`,e}finally{d.tG.info(505427164,d.nh.CoreDefault,this.logOp.stop())}}))}executeOnAnnotation(e){return A(this,void 0,void 0,(function*(){return yield Promise.race([this.submitRequest(),e.rejectWhenCancellationRequested()])}))}submitRequest(){return A(this,void 0,void 0,(function*(){const e=yield this.session.submitCustomMessage(this.request.message);if(!this.request.responseType.typeGuard(e))throw new r.Ek(`Response type do not match. Actual: ${n.h.getTypeNameFor(e)}, Expected: ${this.request.responseType}`);return e}))}}var N=s(409273),E=s(937410);class I{static create(e){var t;return new I(e.session,null!==(t=e.scheduler)&&void 0!==t?t:new N.O)}constructor(e,t){this.session=e,this.scheduler=t}execute(e,t){return this.createExecutor(e,t).execute()}createExecutor(e,t){const s=new E.I({operationName:"AsyncClientExecute",success:!0}).setClientMetadata(this.session.getClientMetadata()).start();switch(e.type){case h.SingleAnnotation:return s.resourceId="SingleAnnotationRequest",new S(this.session,e,t,this.scheduler,s);case h.Streaming:return s.resourceId="StreamingRequest",new T(this.session,e,t,this.scheduler,s);case h.CustomMessage:return s.resourceId="CustomMessageRequest",new v(this.session,e,t,this.scheduler,s);default:throw new Error("Request Type not supported")}}}var w=s(20214),b=s(782593);const k={category:w.v.Schema,schema:{name:"Exception",path:"message-schema.proto"}},M=(w.v.Schema,(e,t=!1)=>{if(null==e)return"Invalid message passed";if(null==e.payload)return`${b.K[b.K.NoOutput]}: Payload is null`;if(null==e.payload.exceptionType)return"Payload is not an exception";{let s=b.K[e.payload.exceptionType];return s+=e.payload.message?`: ${e.payload.message}`:": No description",s+=t&&e.payload.data?`\n${e.payload.data.toString()}`:"",s}}),L=(e,t)=>{if(null==e)throw new Error("Cannot set exception on null message");e.payload=t,e.payloadSchema=k,e.messageType=b.G.Exception};var B,D,P=s(447119),R=s(313189),O=s(796462),x=s(946233);!function(e){let t,s,o,n,i,a;!function(e){e[e.Unknown=0]="Unknown",e[e.Text=1]="Text",e[e.Slide=2]="Slide"}(t=e.TileType||(e.TileType={})),function(e){e[e.Generic=0]="Generic",e[e.Title=1]="Title",e[e.SmartArt=2]="SmartArt",e[e.TableCell=3]="TableCell",e[e.TextBox=4]="TextBox",e[e.Notes=5]="Notes"}(s=e.TextTileType||(e.TextTileType={})),function(e){e[e.Undefined=0]="Undefined",e[e.Word=1]="Word",e[e.Phrase=2]="Phrase",e[e.Sentence=3]="Sentence",e[e.Paragraph=4]="Paragraph"}(o=e.TextTileElementUnit||(e.TextTileElementUnit={})),function(e){e[e.Undefined=0]="Undefined",e[e.Bullet=1]="Bullet",e[e.Numbered=2]="Numbered"}(n=e.ListType||(e.ListType={})),function(e){e[e.Undefined=0]="Undefined",e[e.AlphaLcParenBoth=1]="AlphaLcParenBoth",e[e.AlphaUcParenBoth=2]="AlphaUcParenBoth",e[e.AlphaLcParenR=3]="AlphaLcParenR",e[e.AlphaUcParenR=4]="AlphaUcParenR",e[e.AlphaLcPeriod=5]="AlphaLcPeriod",e[e.AlphaUcPeriod=6]="AlphaUcPeriod",e[e.ArabicParenBoth=7]="ArabicParenBoth",e[e.ArabicParenR=8]="ArabicParenR",e[e.ArabicPeriod=9]="ArabicPeriod",e[e.ArabicPlain=10]="ArabicPlain",e[e.RomanLcParenBoth=11]="RomanLcParenBoth",e[e.RomanUcParenBoth=12]="RomanUcParenBoth",e[e.RomanLcParenR=13]="RomanLcParenR",e[e.RomanUcParenR=14]="RomanUcParenR",e[e.RomanLcPeriod=15]="RomanLcPeriod",e[e.RomanUcPeriod=16]="RomanUcPeriod",e[e.CircleNumDbPlain=17]="CircleNumDbPlain",e[e.CircleNumWdBlackPlain=18]="CircleNumWdBlackPlain",e[e.CircleNumWdWhitePlain=19]="CircleNumWdWhitePlain",e[e.ArabicDbPeriod=20]="ArabicDbPeriod",e[e.ArabicDbPlain=21]="ArabicDbPlain",e[e.Ea1ChsPeriod=22]="Ea1ChsPeriod",e[e.Ea1ChsPlain=23]="Ea1ChsPlain",e[e.Ea1ChtPeriod=24]="Ea1ChtPeriod",e[e.Ea1ChtPlain=25]="Ea1ChtPlain",e[e.Ea1JpnChsDbPeriod=26]="Ea1JpnChsDbPeriod",e[e.Ea1JpnKorPlain=27]="Ea1JpnKorPlain",e[e.Ea1JpnKorPeriod=28]="Ea1JpnKorPeriod",e[e.Arabic1Minus=29]="Arabic1Minus",e[e.Arabic2Minus=30]="Arabic2Minus",e[e.Hebrew2Minus=31]="Hebrew2Minus",e[e.ThaiAlphaPeriod=32]="ThaiAlphaPeriod",e[e.ThaiAlphaParenR=33]="ThaiAlphaParenR",e[e.ThaiAlphaParenBoth=34]="ThaiAlphaParenBoth",e[e.ThaiNumPeriod=35]="ThaiNumPeriod",e[e.ThaiNumParenR=36]="ThaiNumParenR",e[e.ThaiNumParenBoth=37]="ThaiNumParenBoth",e[e.HindiAlphaPeriod=38]="HindiAlphaPeriod",e[e.HindiNumPeriod=39]="HindiNumPeriod",e[e.HindiNumParenR=40]="HindiNumParenR",e[e.HindiAlpha1Period=41]="HindiAlpha1Period"}(i=e.ListNumeration||(e.ListNumeration={})),function(e){e[e.Undefined=0]="Undefined",e[e.Delete=1]="Delete",e[e.Add=2]="Add",e[e.Change=3]="Change",e[e.Refresh=4]="Refresh"}(a=e.TextTileEventType||(e.TextTileEventType={}))}(B||(B={})),function(e){let t;!function(e){e[e.Undefined=0]="Undefined",e[e.Delete=1]="Delete",e[e.Add=2]="Add",e[e.Change=3]="Change",e[e.Refresh=4]="Refresh"}(t=e.SlideTileEventType||(e.SlideTileEventType={}))}(D||(D={}));var F=s(73401);class G{constructor(){this.cache=new Map}setReduceTimer(e,t,s,o=500,n=()=>!1,i=5e3){this.cache.has(e)||this.cache.set(e,new Map);const a=this.cache.get(e);a.has(t)&&clearTimeout(a.get(t).timer);const r=()=>{const r=a.get(t),c=Date.now()-r.start;n()&&c<i?r.timer=setTimeout(r.timerCallback,Math.min(o,i-c)):(a.size>1?a.delete(t):this.cache.delete(e),s())};a.set(t,{start:Date.now(),timerCallback:r,timer:setTimeout(r,o)})}clear(e,t){this.cache.forEach(((s,o)=>{e&&e!==o||s.forEach(((e,s)=>{t&&t!==s||clearTimeout(e.timer)}))})),this.cache.clear()}}var W=s(505778);class H{constructor(e=33e5){this.tokenCache=new Map,this.requestMap=new Map,this.requestRecordMap=new Map,this.tokenExpirationMs=e}updateAuthToken(e,t){const s=JSON.stringify(t);let o=this.requestRecordMap.get(s);return(void 0===o||this.isTokenExpired(o))&&(o={requestPromise:e.requestAuthToken(t).then((e=>{if(!e||!e.Token)throw new Error(`No token available for request ${s}`);this.tokenCache.set(s,e.Token)})),requestTime:O.Aq.getCurrentTimeMs()},this.requestRecordMap.set(s,o)),o.requestPromise}getAuthTokenEntries(e,t){return Array.from(this.tokenCache.keys()).map((e=>{let t=this.requestMap.get(e);return void 0===t&&(t=JSON.parse(e),this.requestMap.set(e,t)),{requestKey:e,request:t}})).filter((({request:e})=>!t||e.DocId===t)).map((({requestKey:t,request:s})=>(this.isTokenExpired(this.requestRecordMap.get(t))&&this.updateAuthToken(e,s),{ticket:s.Tickets[0],token:this.tokenCache.get(t)})))}isTokenExpired(e){return O.Aq.getCurrentTimeMs()>e.requestTime+this.tokenExpirationMs}}let U;const q=()=>{U=new H};q();const V=(e,t,s,o,n,i,a,r,c,l)=>{const u={method:"POST",headers:{"content-type":"application/json","X-CorrelationId":n},body:JSON.stringify({payload:t.payload,payloadSchema:s,requestedSchema:o,clientMetadata:i,tokens:U.getAuthTokenEntries(a,c.docId)})};(0,W.OW)(e,u,((u,p)=>{u?l(new Error(`Fetch error in remote lambda request to ${e}: ${u}`)):401===p.status?r>0?(d.tG.info(572838109,d.nh.CoreDefault,"Auth token required for remote lambda request"),p.json().then((e=>U.updateAuthToken(a,{Tickets:[e],DocId:c.docId}))).then((()=>{V(e,t,s,o,n,i,a,r-1,c,l)})).catch((e=>{l({exceptionType:b.K.Authentication,message:e.message})}))):l({exceptionType:b.K.Authentication,message:"Remote lambda request retry with authentication token failed"}):p.ok?p.json().then((e=>{if(Array.isArray(e))if(e.length>0){let s=0;for(const o of e)t.moreResults=++s<e.length,l(null,o)}else l(new Error("No output"));else l(new Error("Did not receive a valid response for remote lambda request"))})).catch((e=>{l({exceptionType:b.K.LambdaThrow,message:e.message})})):l(new Error(`Remote lambda request failed with status ${p.status}`))}))},$=(e,t,s,o,n,i,a,r,c)=>{Array.isArray(r.authTickets)?U.updateAuthToken(a,{Tickets:r.authTickets,DocId:r.docId}).then((()=>{V(e,t,s,o,n.id,i,a,1,r,c)})).catch((e=>{c({exceptionType:b.K.Authentication,message:e.message})})):V(e,t,s,o,n.id,i,a,1,r,c)};var j=s(399115);class z{constructor(){this.hasBeenOpened=!1,this.hadEgressError=!1,this.lastEgressTime=0,this.lastPongTime=0,this.remainingPingFailures=3,this.egressMessageCount=0,this.egressByteCount=0,this.isClosing=!1,this.pendingEgress=[]}init(e,t,s,o){this.ws=new j.A(e),this.logOp=new E.I({operationName:z.className,success:!0,dimension1:"V1"}).start(),this.egressTimer=Date.now(),this.egressMessageCountOp=new E.I({operationName:"WSEgressMessageCount",success:!0,dimension1:"V1"}),this.egressByteCountOp=new E.I({operationName:"WSEgressByteOrderOfMagnitude",success:!0,dimension1:"V1"}),this.ingressByteCountOp=new E.I({operationName:"WSIngressByteOrderOfMagnitude",success:!0,dimension1:"V1"});const n=e=>{this.logPingLatencyOp&&(this.logPingLatencyOp.success=e,d.tG.info(507789790,d.nh.CoreDefault,this.logPingLatencyOp.stop()),this.logPingLatencyOp=void 0)};this.ws.addEventListener("open",(e=>{s(),z.logCountLimiter.log((()=>{this.logOp.resourceId="OnOpen",this.logOp.resultDescription="",this.logOp.success=!0,this.logOp.dimension0=this.pendingEgress.length.toString(),d.tG.info(507789789,d.nh.CoreDefault,this.logOp.stop())})),this.hasBeenOpened=!0,this.pendingEgress.forEach((e=>{this.egress({obj:e})})),this.pendingEgress=[],this.pingInterval=setInterval((()=>{this.logPingLatencyOp&&(--this.remainingPingFailures,n(!1)),this.remainingPingFailures>0&&this.hasBeenOpened&&this.lastPongTime<this.lastEgressTime&&(this.logPingLatencyOp=new E.I({operationName:"Ping",success:!0,dimension0:this.ws.bufferedAmount>=0?this.ws.bufferedAmount.toString().length.toString():void 0,dimension1:"V1"}).start(),this.ws.send(z.pingPongMessage,(e=>{e&&(--this.remainingPingFailures,n(!1))})))}),3e4)})),this.ws.addEventListener("message",(e=>{this.logPingLatencyOp&&"string"==typeof e.data&&1===e.data.length&&e.data[0]===z.pingPongMessage?(n(!0),this.lastPongTime=Date.now()):(this.logIngressCount(e.data),t(e.data))})),this.ws.addEventListener("error",(e=>{this.errorMessage=e.message,z.logCountLimiter.log((()=>{this.logOp.resourceId="OnError",this.logOp.resultDescription=this.errorMessage,this.logOp.success=!1,d.tG.info(507789788,d.nh.CoreDefault,this.logOp.stop())})),this.ws.close()})),this.ws.addEventListener("close",(e=>{z.logCountLimiter.log((()=>{this.logOp.resourceId="OnClose",this.logOp.resultDescription=e?`code: ${e.code}. reason: ${e.reason}`:"",this.logOp.success=!0,d.tG.info(507789787,d.nh.CoreDefault,this.logOp.stop())})),this.pingInterval&&(clearInterval(this.pingInterval),this.pingInterval=void 0),o(this.errorMessage),this.isClosing=!1}))}egress(e){const t=e.obj;this.logEgressCount(t instanceof ArrayBuffer||t instanceof Uint8Array?t.byteLength:t.length),this.lastEgressTime=Date.now(),this.hasBeenOpened?this.ws.send(t,(e=>{e&&!this.hadEgressError&&(this.hadEgressError=!0,z.logCountLimiter.log((()=>{this.logOp.resourceId="OnFirstEgressError",this.logOp.resultDescription=e.message,this.logOp.success=!1,d.tG.info(507789786,d.nh.CoreDefault,this.logOp.stop())})))})):this.pendingEgress.push(t)}close(){this.isClosing||(this.isClosing=!0,this.pingInterval&&(clearInterval(this.pingInterval),this.pingInterval=void 0),this.ws.close())}logEgressCount(e){const t=Date.now(),s=t-this.egressTimer;s>1e3&&(this.egressMessageCount>50&&(this.egressMessageCountOp.start(),this.egressMessageCountOp.resultDescription="Egress message count: "+this.egressMessageCount.toString()+", Buffered amount: "+(this.ws.bufferedAmount>=0?this.ws.bufferedAmount.toString():"-")+", Time elapsed: "+s.toString(),d.tG.info(507789785,d.nh.CoreDefault,this.egressMessageCountOp.stop())),this.egressByteCount>1e5&&(this.egressByteCountOp.start(),this.egressByteCountOp.dimension2=this.egressByteCount.toString().length.toString(),this.egressMessageCountOp.resultDescription="Buffered amount: "+(this.ws.bufferedAmount>=0?this.ws.bufferedAmount.toString():"-")+", Time elapsed: "+s.toString(),d.tG.info(507789784,d.nh.CoreDefault,this.egressByteCountOp.stop())),this.egressTimer=t,this.egressMessageCount=0,this.egressByteCount=0),this.egressMessageCount++,this.egressByteCount+=null!=e?e:0}logIngressCount(e){const t=e.length;t>1e5&&(this.ingressByteCountOp.start(),this.ingressByteCountOp.dimension2=t.toString().length.toString(),d.tG.info(507789783,d.nh.CoreDefault,this.ingressByteCountOp.stop()))}}z.className="WebSocketWorker",z.logCountLimiter=new O.yq(z.className),z.pingPongMessage="~";class K{constructor(e,t,s,o,n,i){this.requestId=e,this.correlationId=t,this.schemaName=s,this.data=o,this.callback=n,this.requestTimeoutInMs=i,this.ended=!1,this.startTime=0}startRequest(){this.startTime=O.Aq.getCurrentTimeMs()}getMsUntilTimeout(){const e=O.Aq.getCurrentTimeMs()-this.startTime;return this.requestTimeoutInMs-e}endRequest(e){this.ended||(this.invokeCallback(null,e,!0),this.ended=!0)}addResponseData(e){this.invokeCallback(e,null,!1)}invokeCallback(e,t,s){new Promise((()=>this.callback(e,t,s))).catch((e=>{}))}}let Q;const J=()=>{Q=new H};J();const Y=new class{constructor(e,t,s){this.requestCounter=0,this.activeRequests=[],this.pendingRequests=[],this.requestTimeoutInMs=e,this.workerFactory=t,this.maxActiveRequests=s}testConnection(e,t){let s=!1;const o=new E.I({cv:(new P.W).toString(),operationName:"WebSocketTest",resourceId:(0,R.k$)(e),success:!0}).start();return new Promise((n=>{const i=O.Aq.createHealthCheckRequest(t);e?this.addRequest(e,i,o.cv,"HealthCheckRequest",((e,t,i)=>{t&&(o.success=!1,o.resultSignature="Error",o.resultDescription=t.message||t),e&&"OK"===e.status&&(s=!0),i&&(o.success&&!s&&(o.success=!1,o.resultSignature="NoResponseData"),d.tG.info(556617949,d.nh.CoreDefault,o.stop()),n(o.success))})):(o.success=!1,o.resultSignature="EmptyUrl",d.tG.info(557641870,d.nh.CoreDefault,o.stop()),n(o.success))}))}addRequest(e,t,s,o,n){const i=(this.requestCounter++).toString(),a=new K(i,s,o,t,n,this.requestTimeoutInMs);this.getWorker(e),this.pendingRequests.push(a),this.egressPendingRequests()}egressPendingRequests(){for(;this.pendingRequests.length>0&&this.activeRequests.length<this.maxActiveRequests;){const e=this.pendingRequests.shift();if(this.activeRequests.push(e),1===this.activeRequests.length){const t=e.getMsUntilTimeout();setTimeout(this.onTimeout.bind(this),t)}e.startRequest(),this.worker&&this.worker.egress({obj:this.createRequestMessage(e.data,e.requestId,e.correlationId)})}}createRequestMessage(e,t,s){return JSON.stringify({correlationId:s,requestId:t,body:e})}onTimeout(){for(;this.activeRequests.length>0;){const e=this.activeRequests[0],t=e.getMsUntilTimeout();if(!(t<=0))return void setTimeout(this.onTimeout.bind(this),t);{const t=new Error("Request timed out");e.endRequest(t),this.activeRequests.shift(),this.egressPendingRequests()}}}onMessage(e){try{const t=JSON.parse(e);for(let e=0;e<this.activeRequests.length;e++){const s=this.activeRequests[e];if(s.requestId===t.requestId){t.end?(this.activeRequests.splice(e,1),s.endRequest(t.error),this.egressPendingRequests()):t.body&&s.addResponseData(t.body);break}}}catch(e){d.tG.error(557641871,d.nh.CoreDefault,e)}}onClose(e){const t=new Error(`Connection closed: ${e}`);for(const e of this.activeRequests)e.endRequest(t);this.activeRequests=[];for(const e of this.pendingRequests)e.endRequest(t);this.pendingRequests=[],this.worker=void 0}getWorker(e){return this.worker||(this.worker=this.workerFactory(),this.worker.init(e,this.onMessage.bind(this),(()=>{}),this.onClose.bind(this))),this.worker}}(3e4,(()=>new z),50),Z=(e,t,s,o,n,i,a,r,c,l)=>{const u={payload:t.payload,payloadSchema:s,requestedSchema:o,clientMetadata:i,tokens:Q.getAuthTokenEntries(a,c.docId)};let p="";o&&o.schema&&(p=o.schema.name);let g=!1;Y.addRequest(e,u,n,p,((u,p,h)=>{if(!g)if(g=!0,null!=p)if(p.exceptionType===b.K.Authentication)try{const u=JSON.parse(p.data);r>0?(d.tG.info(572838108,d.nh.CoreDefault,"Auth token required for remote lambda WebSocket request"),Q.updateAuthToken(a,{Tickets:[u],DocId:c.docId}).then((()=>{Z(e,t,s,o,n,i,a,r-1,c,l)})).catch((e=>{l({exceptionType:b.K.Authentication,message:e.message})}))):l({exceptionType:b.K.Authentication,message:"Remote lambda request retry with authentication token failed"})}catch(e){l({exceptionType:b.K.Authentication,message:e.message})}else l(new Error(`Error in remote lambda WebSocket request to ${e}: ${p}`));else t.moreResults=!1,l(null,u)}))},X=(e,t,s,o,n,i,a,r,c)=>{Array.isArray(r.authTickets)?Q.updateAuthToken(a,{Tickets:r.authTickets,DocId:r.docId}).then((()=>{Z(e,t,s,o,n.id,i,a,1,r,c)})).catch((e=>{c({exceptionType:b.K.Authentication,message:e.message})})):Z(e,t,s,o,n.id,i,a,1,r,c)};class ee{constructor(){this.cache=new Map,this.bucketSizes=new Map}setBucketSize(e,t){this.bucketSizes.set(e,t)}setResult(e,t,s){if(!t.primary)return;let o=this.cache.get(e);o||(o=new Map,this.cache.set(e,o));let n=o.get(t.primary);if(n||(n=t.secondary?new Map:[],o.set(t.primary,n)),t.secondary){n.set(t.secondary,s)}else{const t=n;t.length==this.getBucketSize(e)&&t.shift(),t.push(s)}}getResults(e,t){const s=this.cache.get(e);if(s){const e=s.get(t.primary);if(e){if(!t.secondary)return e;const s=Array.from(e.values());if(s.length>0)return s}}return[]}clear(e,t){t?this.cache.forEach(((s,o)=>{if(!e||e===o)if(t.secondary){const e=s.get(t.primary);e&&e.delete(t.secondary)}else s.delete(t.primary)})):e?this.cache.delete(e):this.cache.clear()}getBucketSize(e){return this.bucketSizes.get(e)||10}}var te,se;!function(e){e[e.Unknown=0]="Unknown",e[e.Local=1]="Local",e[e.Custom=2]="Custom",e[e.Remote=3]="Remote",e[e.BatchedRemote=4]="BatchedRemote"}(te||(te={}));class oe{constructor(){this.throttleInfoMap=new Map}execute(e,t,s){if(t.throttleSettings.shouldBeThrottled&&t.throttleSettings.throttlingInterval>0){const o=this.getWorkflowThrottleInfo(t.name);if(null==o.currentTileId)o.currentTileId=e,o.timeOfPreviousStartedEvent=O.Aq.getCurrentTimeMs(),s();else if(o.currentTileId===e){const e=O.Aq.getCurrentTimeMs(),n=this.delayTime(o,e,t.throttleSettings.throttlingInterval);n>0?(o.latestCallback=s,null==o.lastTimeout&&(o.lastTimeout=setTimeout((()=>{const e=this.getWorkflowThrottleInfo(t.name);e.lastTimeout=void 0,e.timeOfPreviousStartedEvent=O.Aq.getCurrentTimeMs(),e.latestCallback()}),n))):(o.timeOfPreviousStartedEvent=e,s())}else null!=o.lastTimeout&&(clearTimeout(o.lastTimeout),o.latestCallback(),o.lastTimeout=void 0),o.currentTileId=e,o.timeOfPreviousStartedEvent=O.Aq.getCurrentTimeMs(),s()}else s()}delayTime(e,t,s){const o=t-e.timeOfPreviousStartedEvent;return Math.max(s-o,0)}getWorkflowThrottleInfo(e){let t=this.throttleInfoMap.get(e);return t||(t={currentTileId:void 0,timeOfPreviousStartedEvent:-1,latestCallback:()=>{},lastTimeout:void 0},this.throttleInfoMap.set(e,t)),t}}!function(e){e[e.Restricted=0]="Restricted",e[e.Unrestricted=1]="Unrestricted",e[e.Suppressed=2]="Suppressed"}(se||(se={}));class ne{constructor(){this.canaryTextTileEventSubmittedByDocSessionId=new Set,this.stateByDocSessionId=new Map,this.executionQueueByDocSessionId=new Map,this.executionCountByDocSessionId=new Map}getOutputSchema(){return this.lambdas[this.lambdas.length-1].outputSchema}scheduleExecution(e,t){const s=this.docSessionIdExtractor?this.docSessionIdExtractor(e):void 0,o=this.getStateForDocSessionId(s);if(o===se.Restricted){const e=this.getExecutionQueueForDocSessionId(s);e.push(t),1===e.length&&t()}else o===se.Unrestricted?t():se.Suppressed}onStart(e){this.incrementExecutionCountForDocSessionId(e)}onFinish(e,t){if(this.decrementExecutionCountForDocSessionId(e),t===b.K.Authentication)this.stateByDocSessionId.set(e,se.Suppressed),this.executionQueueByDocSessionId.delete(e);else if(this.stateByDocSessionId.get(e)===se.Restricted){const s=this.getExecutionQueueForDocSessionId(e);if(s.shift(),void 0===t){this.stateByDocSessionId.set(e,se.Unrestricted),this.executionQueueByDocSessionId.delete(e);for(const e of s)e()}else if(s.length>0){(0,s[0])()}}}onRefresh(e){this.stateByDocSessionId=new Map,this.triggerOnRefresh&&(e?(this.executionQueueByDocSessionId.delete(e),this.executionCountByDocSessionId.delete(e)):(this.executionQueueByDocSessionId=new Map,this.executionCountByDocSessionId=new Map)),this.canaryTextTileEventSubmittedByDocSessionId.delete(e)}getStateForDocSessionId(e){let t=this.stateByDocSessionId.get(e);return void 0===t&&(t=ne.executionQueuesEnabled?se.Restricted:se.Unrestricted,this.stateByDocSessionId.set(e,t)),t}getExecutionQueueForDocSessionId(e){let t=this.executionQueueByDocSessionId.get(e);return void 0===t&&(t=[],this.executionQueueByDocSessionId.set(e,t)),t}incrementExecutionCountForDocSessionId(e){const t=this.executionCountByDocSessionId.get(e)||0;this.executionCountByDocSessionId.set(e,t+1)}decrementExecutionCountForDocSessionId(e){const t=this.executionCountByDocSessionId.get(e)||0;t<=1?this.executionCountByDocSessionId.delete(e):this.executionCountByDocSessionId.set(e,t-1)}}ne.executionQueuesEnabled=!0;const ie=e=>({category:w.v.Schema,schema:{name:e}}),ae="Tiling.TextTileEvent",re="ClpSlideTile",ce=(e,t)=>e===ae&&t&&t.type==B.TextTileEventType.Refresh,le=(e,t)=>e===re&&t&&t.eventType==D.SlideTileEventType.Refresh,ue=(e,t)=>ce(e,t)||le(e,t),pe=(e,t)=>{var s,o;return e===ae?null===(o=null===(s=t.tile)||void 0===s?void 0:s.metadata)||void 0===o?void 0:o.docSessionId:e===re?t.docId:void 0};const ge=new class{constructor(){this.inputSchemasToWorkflows=new Map,this.inputSchemasToReduceWorkflows=new Map,this.reduceWorkflowsGroupingKeyExtractors=new Map,this.defaultWorkflowOptions={canProduceNullResult:!1,shouldSendResultsToHost:!0,enabledByDefault:!1,throttleSettings:{shouldBeThrottled:!1},triggerOnRefresh:!1},this.resultCache=new ee,this.reduceTimerCache=new G,this.lookupTableCache=new Map,this.throttling=new oe,this.lastTileRefreshSeq=-1,this.lastTileRefreshSeqByDocSessionId=new Map,this.tileRefreshByDocSessionIdEnabled=!0}init(e,t,s){const n=new E.I({operationName:"InitRuntimeALv1",resourceId:(0,R.k$)(e)});n.start(),this.clientMetadata=t,this.clientMetadata&&(this.clientMetadata.runtimeVersion=(0,o.HF)()),this.hostCallbacks=s;const i=[];return i.push(this.isFeatureEnabled("DisableWebSocket").then((s=>{if(!!s)return!1;return!(["Outlook Mac","Outlook Win32","PowerPoint Mac","PowerPoint Web","PowerPoint Win32","Word Mac","Word Win32"].indexOf(`${t.appName} ${t.appPlatform}`)>=0)||((e,t)=>Y.testConnection(e,t))(O.Aq.convertServiceUrlToWebSocket(e),this.clientMetadata)})).then((t=>{e&&(this.serviceUrl=t?O.Aq.convertServiceUrlToWebSocket(e):e,this.executeRemoteLambda=t?X:$,this.clearRemoteLambdaTokenCache=t?J:q,this.serviceProtocol=this.serviceUrl.split(":")[0].toLowerCase())}))),i.push(this.isFeatureEnabled("WorkflowQueuesDisabled").then((e=>{ne.executionQueuesEnabled=!e}))),i.push(this.isFeatureEnabled("TileRefreshByDocSessionIdDisabled").then((e=>{this.tileRefreshByDocSessionIdEnabled=!e}))),Promise.all(i).then((()=>{this.logOperation(n,!0)})).catch((e=>{this.logOperation(n,!1,"Error",e?e.message:"(no error)")}))}getServiceProtocol(){return this.serviceProtocol}registerSchemas(e,t){return Promise.resolve()}registerSimpleLocalWorkflow(e,t,s=this.defaultWorkflowOptions){return t.source=t.source||te.Custom,this.registerHardcodedWorkflow(e,[t],this.inputSchemasToWorkflows,s)}registerSimpleRemoteWorkflow(e,t,s,o,n=this.defaultWorkflowOptions){const i=[];return t&&(t.source=te.Custom,i.push(t)),s.source=s.func?te.Custom:te.Remote,i.push(s),o&&(o.source=te.Custom,i.push(o)),this.registerHardcodedWorkflow(e,i,this.inputSchemasToWorkflows,n)}registerMultipleLambdasWorkflow(e,t,s=this.defaultWorkflowOptions){return this.registerHardcodedWorkflow(e,t,this.inputSchemasToWorkflows,s)}registerReduceWorkflow(e,t,s,o=10,n=this.defaultWorkflowOptions){return this.reduceWorkflowsGroupingKeyExtractors.set(t.inputSchema,s),this.resultCache.setBucketSize(t.inputSchema,o),t.source=t.source||te.Custom,this.registerHardcodedWorkflow(e,[t],this.inputSchemasToReduceWorkflows,n)}registerMultipleLambdasReduceWorkflow(e,t,s,o=10,n=this.defaultWorkflowOptions){return this.reduceWorkflowsGroupingKeyExtractors.set(t[0].inputSchema,s),this.resultCache.setBucketSize(t[0].inputSchema,o),this.registerHardcodedWorkflow(e,t,this.inputSchemasToReduceWorkflows,n)}submit(e,t,s){this.submitToWorkflows(e,t,s,this.inputSchemasToWorkflows)}getGroupingKey(e,t,s){const o=this.reduceWorkflowsGroupingKeyExtractors.get(s);if(null==o)throw new Error("Reduce workflow does not have a grouping extractor");return o(t,e)}submitToWorkflows(e,t,s,o=this.inputSchemasToWorkflows){if(!this.hostCallbacks)return;let n;n=s?P.W.fromString(s):new P.W,this.handleTileRefresh(e,t,n);const i=o.get(e)||[];for(const s of i)ue(e,t)&&!s.triggerOnRefresh||(s.useCanaryTextTile&&e===ae&&!s.canaryTextTileEventSubmittedByDocSessionId.has(pe(e,t))&&(this.submitToWorkflow(ae,{type:(a=t).type,tile:{metadata:{docSessionId:a.tile.metadata.docSessionId,docId:a.tile.metadata.docId,seqnoCLPRefresh:a.tile.metadata.seqnoCLPRefresh,tileId:"A56B3127DBDFD0D6"},elements:[{text:"B91153AE828B4E48"}]}},n,s,o),s.canaryTextTileEventSubmittedByDocSessionId.add(pe(e,t))),this.submitToWorkflow(e,t,n,s,o));var a}submitToWorkflow(e,t,s,o,n){const i={messageType:b.G.Input,correlationVector:s.newChild(),payload:t,payloadSchema:ie(o.lambdas[0].inputSchema),clientMetadata:this.clientMetadata},a=new E.I({cv:i.correlationVector.toString(),operationName:"ExecuteWorkflow",resourceId:o.name});a.setClientMetadata(this.clientMetadata),a.start(),o.scheduleExecution(t,(()=>{try{if(i.payload&&i.payload.tile&&i.payload.tile.metadata&&i.payload.tile.metadata.tileId){const s=i.payload.tile.metadata.tileId;this.throttling.execute(s,o,(()=>this.executeWorkflow(a,i,t,o,e,n)))}else this.executeWorkflow(a,i,t,o,e,n)}catch(e){a.success=!1,a.resultSignature="ExecuteException",a.resultDescription=e?e.message:"(no error)",d.tG.error(559290447,d.nh.CoreDefault,a.stop())}}))}handleTileRefresh(e,t,s){if(!ue(e,t))return;const o=this.tileRefreshByDocSessionIdEnabled?pe(e,t):void 0,n=((e,t)=>{var s,o;return ce(e,t)?null===(o=null===(s=t.tile)||void 0===s?void 0:s.metadata)||void 0===o?void 0:o.seqnoCLPRefresh:(le(e,t),-1)})(e,t);if(this.tileRefreshByDocSessionIdEnabled){const e=this.lastTileRefreshSeqByDocSessionId.get(o);if(e>=0&&n<=e)return}else if(n<=this.lastTileRefreshSeq)return;const i=new E.I({cv:s.toString(),operationName:"TileRefresh",resultDescription:"",success:!0});if(i.start(),this.tileRefreshByDocSessionIdEnabled&&!o)return i.success=!1,i.resultDescription="NoDocSessionId",void d.tG.info(559290448,d.nh.CoreDefault,i.stop());this.inputSchemasToReduceWorkflows.forEach(((e,t)=>{e.some((e=>e.triggerOnRefresh))&&(this.tileRefreshByDocSessionIdEnabled?(this.resultCache.clear(t,{primary:o}),this.resultCache.clear(this.getForcedDocLevelSchema(t),{primary:o}),this.reduceTimerCache.clear(t,o)):(this.resultCache.clear(t),this.resultCache.clear(this.getForcedDocLevelSchema(t)),this.reduceTimerCache.clear(t)),e.some((e=>!e.triggerOnRefresh))&&(i.resultDescription+="X_"),i.resultDescription+=t+" ")})),this.clearRemoteLambdaTokenCache();const a=[];this.inputSchemasToWorkflows.forEach((e=>a.push(...e))),this.inputSchemasToReduceWorkflows.forEach((e=>a.push(...e)));for(const e of a)this.tileRefreshByDocSessionIdEnabled?e.onRefresh(o):e.onRefresh();this.tileRefreshByDocSessionIdEnabled?this.lastTileRefreshSeqByDocSessionId.set(o,n):this.lastTileRefreshSeq=n,d.tG.info(559290449,d.nh.CoreDefault,i.stop())}executeWorkflow(e,t,s,o,n,i){const a=o.docIdExtractor?o.docIdExtractor(t.payload):void 0,r=o.docSessionIdExtractor(s),c=this.tileRefreshByDocSessionIdEnabled?this.lastTileRefreshSeqByDocSessionId.get(r):this.lastTileRefreshSeq;o.onStart(r);const l=t=>{const a=this.tileRefreshByDocSessionIdEnabled?this.lastTileRefreshSeqByDocSessionId.get(r):this.lastTileRefreshSeq;if(o.triggerOnRefresh&&a!==c)return e.success=!0,e.resultSignature="TileRefreshIgnore",void d.tG.info(559290450,d.nh.CoreDefault,e.stop());const l=t.messageType==b.G.Exception&&t.payload.exceptionType==b.K.NoOutput,u=l&&o.canProduceNullResult,p=u?o.lambdas[o.lambdas.length-1].outputSchema:t.payloadSchema.schema.name,g=u?null:t.payload;t.messageType===b.G.Input||u?(o.shouldSendResultsToHost&&(i===this.inputSchemasToReduceWorkflows?this.hostCallbacks.onResult("Reduce.Input",s,p,g):this.hostCallbacks.onResult(n,s,p,g)),e.success=!0,e.resultSignature=l?"NoOutput":"ValidOutput"):l?(e.success=!0,e.resultSignature="NoOutput"):(e.success=!1,e.resultSignature="Exception",e.resultDescription=M(t)),i!==this.inputSchemasToReduceWorkflows&&this.updateResultCacheForReduceWorkflows(n,s,p,g,t.correlationVector.toString()),t.moreResults||(e.stop(),d.tG.info(559290451,d.nh.CoreDefault,e),o.onFinish(r,t.payload&&t.payload.exceptionType?(e=>null==e||null==e.payload||null==e.payload.exceptionType?b.K.Unknown:e.payload.exceptionType)(t):void 0))};o.preExecutionPromise.then((()=>{const e={lookupTable:this.lookupTableCache.get(o.name),docId:a,docSessionId:r};let s=l;for(let t=o.lambdas.length-1;t>=0;t--)s=this.createLambdaExecutionStep(o.name,o.lambdas[t],e,s,l);s(t)}))}getForcedDocLevelSchema(e){return`~${e}`}updateResultCacheForReduceWorkflows(e,t,s,o,n){const i=this.inputSchemasToReduceWorkflows.get(s);if(i){let a;"docSessionId"===e?(a=this.getGroupingKey(e,t,s),this.resultCache.setResult(this.getForcedDocLevelSchema(s),a,o),a.secondary="*"):(a=this.getGroupingKey(e,t,s),((e,t)=>e===ae&&t&&t.type==B.TextTileEventType.Delete||e===re&&t&&t.eventType==D.SlideTileEventType.Delete)(e,t)&&null!=a.primary&&null!=a.secondary?this.resultCache.clear(void 0,a):this.resultCache.setResult(s,a,o));const r=i.some((e=>e.deferReduceUntilIdle)),c=[];this.inputSchemasToWorkflows.forEach((e=>c.push(...e.filter((e=>e.getOutputSchema()===s)))));const l=()=>r&&c.some((e=>e.executionCountByDocSessionId.get(a.primary)>0)),u=i.map((e=>e.deferReduceUntilIdleMaxDelayMs||0)).reduce(((e,t)=>Math.max(e,t)));this.reduceTimerCache.setReduceTimer(s,a.primary,(()=>{const e=this.resultCache.getResults(s,a);if(e.push(...this.resultCache.getResults(this.getForcedDocLevelSchema(s),{primary:a.primary})),Array.isArray(e)){const t={id:a.primary,values:e,isReduceInput:!0};this.submitToWorkflows(s,t,n,this.inputSchemasToReduceWorkflows)}else d.tG.error(559290452,d.nh.CoreDefault,`Cached results have unexpected type "${typeof e}"`)}),500,l,u)}}isFeatureEnabled(e,t=!1,s="None"){return this.hostCallbacks&&this.hostCallbacks.isFeatureEnabled?this.hostCallbacks.isFeatureEnabled("Microsoft.Office.AugLoop."+e,s).catch((()=>Promise.resolve(t))):Promise.resolve(t)}areLicenseFeaturesEnabled(e){return this.hostCallbacks&&this.hostCallbacks.areLicenseFeaturesEnabled?this.hostCallbacks.areLicenseFeaturesEnabled(e).catch((()=>Promise.resolve(!1))):Promise.resolve(!1)}isWorkflowEnabled(e,t,s,o,n){if(t.some((e=>e.source===te.Remote||e.source===te.BatchedRemote))){if(!this.serviceUrl)return n.resultDescription="Disabled because no service URL available for remote workflow",Promise.resolve(!1);if(this.clientMetadata&&this.clientMetadata.privateMode&&t.some((e=>(e.source===te.Remote||e.source===te.BatchedRemote)&&!e.canRunInPrivateMode)))return n.resultDescription="Disabled because we are running in private mode",Promise.resolve(!1)}let i;return(!this.clientMetadata||"Mac"!==this.clientMetadata.appPlatform&&"Win32"!==this.clientMetadata.appPlatform)&&(o=!0,n.resultDescription="Enabled by default due to platform name"),i=o?Promise.resolve(!0):this.isFeatureEnabled("WorkflowEnabled."+e),i.then((t=>t?this.isFeatureEnabled("WorkflowDisabled."+e).then((e=>e?(n.resultDescription="Disabled because explicitly disabled",!1):!s||this.areLicenseFeaturesEnabled(s).then((e=>(e||(n.resultDescription="Disabled because license check failed"),e))))):(n.resultDescription="Disabled because not explicitly enabled",!1)))}registerHardcodedWorkflow(e,t,s=this.inputSchemasToWorkflows,o){if(!e||e.length>40)throw new Error("Workflow name has invalid length");if(!1===new RegExp(/^[A-Z][a-zA-Z0-9_]+$/).test(e))throw new Error("Workflow name has invalid format");s.forEach((t=>{if(t.some((t=>t.name===e)))throw new Error("Workflow name already registered.")}));const n=new E.I({operationName:"WorkflowRegistration",resourceId:e,success:!0});return n.setClientMetadata(this.clientMetadata),n.start(),this.isWorkflowEnabled(e,t,o.licenseFeatures,o.enabledByDefault,n).then((i=>{if(n.resultSignature=i?"Enabled":"Disabled",n.stop(),d.tG.info(559290453,d.nh.CoreDefault,n),i){const n=t[0].inputSchema;let i=s.get(n);i||(i=[],s.set(n,i));let a=Promise.resolve();o.lookupTableLambda&&(a=new Promise(((t,s)=>{const n=new P.W,i={messageType:b.G.Input,correlationVector:n,payloadSchema:ie(o.lookupTableLambda.inputSchema),clientMetadata:this.clientMetadata,payload:{}},a=s=>{s.messageType===b.G.Input&&s.payload&&this.lookupTableCache.set(e,s.payload),t()};this.createLambdaExecutionStep("",o.lookupTableLambda,{},a,a)(i)})));const r=new ne;r.name=e,r.lambdas=t,r.canProduceNullResult=o.canProduceNullResult,r.shouldSendResultsToHost=o.shouldSendResultsToHost,r.triggerOnRefresh=o.triggerOnRefresh,r.throttleSettings=o.throttleSettings||this.defaultWorkflowOptions.throttleSettings,r.docIdExtractor=o.docIdExtractor,r.docSessionIdExtractor=e=>e.isReduceInput?e.id:pe(n,e),r.deferReduceUntilIdle=o.deferReduceUntilIdle,r.deferReduceUntilIdleMaxDelayMs=o.deferReduceUntilIdleMaxDelayMs,r.useCanaryTextTile=o.useCanaryTextTile,r.preExecutionPromise=a,i.push(r)}}))}logOperation(e,t,s,o){e.stop(),e.success=t,e.resultSignature=s,e.resultDescription=o,d.tG.info(559290454,d.nh.CoreDefault,e)}handleLambdaError(e,t,s,o,n){null!=e.exceptionType?L(t,e):e instanceof Error?L(t,{exceptionType:o,message:e.message}):L(t,{exceptionType:b.K.Unknown,message:e?e.toString():void 0}),this.logOperation(s,!1,"Exception",M(t)),n(t)}handleLambdaOutput(e,t,s,o,n,i){e&&e.exceptionType!==b.K.NoOutput?null!=e.exceptionType?this.handleLambdaError(e,t,s,e.exceptionType,i):e instanceof Error?this.handleLambdaError(e,t,s,b.K.LambdaErrorCallback,i):(t.payload=e,t.payloadSchema=ie(o),this.logOperation(s,!0),n(t)):(L(t,{exceptionType:b.K.NoOutput}),this.logOperation(s,!0,"NoOutput"),i(t))}executeCustomLambdaStep(e,t,s,o,n,i){if(null==s.func)L(e,{exceptionType:b.K.LambdaThrow,message:"No lambda function set"}),this.logOperation(t,!1,"Error",M(e)),i(e);else{const a=o=>{this.handleLambdaOutput(o,e,t,s.outputSchema,n,i)},r=(s,o)=>{this.handleLambdaOutput(s,e,t,o,i,i)};try{s.func(e.payload,s.config,o,a,r)}catch(s){this.handleLambdaError(s,e,t,b.K.LambdaThrow,i)}}}executeLocalLambdaStep(e,t,s,o,n){null==this.hostCallbacks.executeLocalLambda?(L(e,{exceptionType:b.K.LambdaThrow,message:"No local lambda host callback set"}),this.logOperation(t,!1,"Error",M(e)),n(e)):this.hostCallbacks.executeLocalLambda(s.inputSchema,e.payload,s.outputSchema).then((i=>{this.handleLambdaOutput(i,e,t,s.outputSchema,o,n)})).catch((s=>{this.handleLambdaError(s,e,t,b.K.LambdaThrow,n)}))}executeRemoteLambdaStep(e,t,s,o,n,i){if(this.serviceUrl){t.resourceId+=`.${this.serviceProtocol}`;const a=(o,a)=>{o?this.handleLambdaError(o,e,t,o.exceptionType||b.K.LambdaErrorCallback,i):this.handleLambdaOutput(a,e,t,s.outputSchema,n,i)};if(o.authTickets=s.authTickets,s.source===te.Remote)this.executeRemoteLambda(this.serviceUrl,e,ie(s.inputSchema),ie(s.outputSchema),e.correlationVector,this.clientMetadata,this.hostCallbacks,o,a);else{this.batchedRemoteLambdaManager||(this.batchedRemoteLambdaManager=new x.Y(((e,t,s)=>{const{remoteLambda:o,lambdaContext:n}=t.context;this.executeRemoteLambda(this.serviceUrl,{messageType:b.G.Input,correlationVector:{id:t.cv},payload:e,payloadSchema:ie(o.inputSchema),clientMetadata:this.clientMetadata},ie(o.remoteInputSchema),ie(o.remoteOutputSchema),{id:t.cv},this.clientMetadata,this.hostCallbacks,n,s)}),!1,!1,((e,t,s)=>{var o;const{lambdaContext:n}=s;this.updateResultCacheForReduceWorkflows("docSessionId",null!==(o=n.docSessionId)&&void 0!==o?o:n.docId,e,t)})));const{batchOptions:t}=s,n=this.normalizeBatchOptions(t),{groupingKeyExtractor:i}=n;n.groupingKeyExtractor=e=>`${s.name}-${i(e)}`;const r={name:s.name,remoteLambda:s,lambdaContext:o};this.batchedRemoteLambdaManager.addBatchItem(e.payload,n,r,e.correlationVector.id.length>127?e.correlationVector.id.substring(0,127)+"!":e.correlationVector.id,void 0,a)}}else L(e,{exceptionType:b.K.LambdaThrow,message:"No URL for remote lambda"}),this.logOperation(t,!1,"Error",M(e)),i(e)}createLambdaExecutionStep(e,t,s,o,n){return i=>{const a=new E.I({cv:i.correlationVector.toString(),operationName:"ExecuteLambda",resourceId:t.name,dimension0:e});a.start(),t.source===te.Custom?this.executeCustomLambdaStep(i,a,t,s,o,n):t.source===te.Local?this.executeLocalLambdaStep(i,a,t,o,n):t.source===te.Remote||t.source===te.BatchedRemote?this.executeRemoteLambdaStep(i,a,t,s,o,n):(L(i,{exceptionType:b.K.LambdaThrow,message:"Unknown/No lambda location set"}),this.logOperation(a,!1,"Error",M(i)),n(i))}}normalizeBatchOptions(e){if(!e)throw new Error("Expected batchConfig");const t=Object.assign({},e);return e.estimateSize||(t.estimateSize=F.E),t}};var he=s(540949),de=s(885118),me=s(413431);class ye{static createFactory(e,t,s,o,n){return i=>{var a;const r=o||me.e3;return!ye.onnxRetrievalPromise||i?e&&t?((null===(a=r())||void 0===a?void 0:a.ort)&&!i?Promise.resolve():(0,me.el)(this.createCdnUrl(e,t),r,"ort",s,n)).then((()=>{ye.onnxRetrievalPromise=Promise.resolve(new ye(r))})).catch((e=>{ye.onnxRetrievalPromise=Promise.reject(e)})).then((()=>ye.onnxRetrievalPromise)):Promise.reject(new Error("Error: appName and/or version not provided")):ye.onnxRetrievalPromise}}static createCdnUrl(e,t){return`https://${e}${t}`}constructor(e){this.getCache=null,this.getCache=e}createModel(e,t){var s;const o=null===(s=this.getCache())||void 0===s?void 0:s.ort;return(0,me.kQ)(e,t||"",o)}createInputs(){return(0,me.In)()}}var Te=s(262449),fe=s(69614),_e=s(292627),Ce=s(721646),Se=s(622908),Ae=function(e,t,s,o){return new(s||(s=Promise))((function(n,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function r(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((o=o.apply(e,t||[])).next())}))},ve=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,s=e[Symbol.asyncIterator];return s?s.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(s){t[s]=e[s]&&function(t){return new Promise((function(o,n){(function(e,t,s,o){Promise.resolve(o).then((function(t){e({value:t,done:s})}),t)})(o,n,(t=e[s](t)).done,t.value)}))}}};class Ne{constructor(){this.bridgeMessageSequenceId=0,this.sessionCloseReasonMap=new Map,this.addCallbacksAlreadySet=new Set,this.sendBridgeMessage=e=>{this.messageBridge&&(e.seq=this.bridgeMessageSequenceId++,this.messageBridge.sendMessage(JSON.stringify(new fe.vG(e))))},this.sendResponseAcrossBridge=(e,t,s,o)=>{e.catch((e=>(this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.error,e.message),new fe._p({messageId:t.messageId,error:e.message})))).then((e=>{this.sendBridgeMessage({bridgeId:s,docSessionId:o,response:e})})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.error,e.message)}))}}initialize(e){this.messageBridge=e.messageBridge,this.getSessionCallback=e.getSessionCallback,this.hostTelemetryCallbacks=e.hostTelemetryCallbacks,this.messageBridge.registerMessageReceivedCallback(this.onBridgeMessageReceived.bind(this))}setInterceptor(e){this.interceptorBridge=e,this.interceptorBridge.registerMessageReceivedCallback(this.onBridgeMessageReceivedFromInterceptor.bind(this))}onBridgeMessageReceived(e){null!=this.interceptorBridge?this.interceptorBridge.sendMessage(e):this.handleBridgeMessage(e)}onBridgeMessageReceivedFromInterceptor(e){this.handleBridgeMessage(e)}handleBridgeMessage(e){try{const{bridgeId:t,docSessionId:s,message:o}=JSON.parse(e),i=n.h.getTypeNameFor(o);this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.info,`Received message with messageTypeName ${i} on bridgeId ${t} and docSessionId ${s}`);const a=this.getSessionCallback(s);if(this.sessionCloseReasonMap.has(s)){const e=this.sessionCloseReasonMap.get(s);this.sendBridgeMessage({bridgeId:t,docSessionId:s,message:new fe.w9({reason:e})}),this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.info,`Session whose doc session id is ${s} is close due to ${e}`)}if(Ce.Cs.typeGuard(o))if(this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.info,`Sending GetHostBridgeSessionResponse to bridge with docSessionId ${s}`),a)a.then((e=>{this.sendBridgeMessage({bridgeId:t,docSessionId:s,response:new Ce.f8({messageId:o.messageId,isConnected:e.isConnected,isClosed:e.isClosed})})})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.error,e),this.sendBridgeMessage({bridgeId:t,docSessionId:s,response:new fe._p({messageId:o.messageId,error:e})})}));else{const e="GetHostBridgeSessionRequestMessage called before session init";this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.error,e),this.sendBridgeMessage({bridgeId:t,docSessionId:s,response:new fe._p({messageId:o.messageId,error:e})})}else if(fe.n4.typeGuard(o))this.handleAnnotationActivationMessage(o,t,s,a);else if(Se.x5.typeGuard(o))this.handleGetAnnotationRequestBridgeMessage(o,t,s,a);else if(fe.Tb.typeGuard(o)){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.info,"Receiving Sync Message");for(const e of o.ops)a.then((t=>{t.submitOperation(e,o.cv)})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.error,e.message)}));this.sendBridgeMessage({bridgeId:t,docSessionId:s,response:new fe.YK({messageId:o.messageId})})}else if(fe.GA.typeGuard(o)){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.info,`Releasing Annotation Activation token = ${o.token}`);const e=a.then((e=>e.releaseAnnotation(o.token).then((e=>(this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.info,`Sending Annotation Activation token = ${o.token}`),new fe.Qq({messageId:o.messageId,lastRelease:e}))))));this.sendResponseAcrossBridge(e,o,t,s)}else if(fe.g$.typeGuard(o))this.handleSubmittedCustomMessage(o,t,s,a);else if(fe.eE.typeGuard(o))this.handleSessionInitMessage(t,s,a);else if(n.h.matchesTypesFor(o,[Ce.i2.getTypeName()]))this.handleInteractiveAuthMessage(o,t,s,a);else if(n.h.matchesTypesFor(o,[Ce.og.getTypeName()])){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.info,"Setting seeding status change callback");const e=(e=>{this.sendBridgeMessage({bridgeId:t,docSessionId:s,message:new Ce.U8({messageId:o.messageId,seedingStatusChangeMessage:e})})}).bind(this);a.then((t=>{t.setSeedingStatusChangeCallback(e)})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.error,e.message)}))}else if(n.h.matchesTypesFor(o,[Ce.tj.getTypeName()])){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.info,"Setting claims challenge callback");const e=(e=>{this.sendBridgeMessage({bridgeId:t,docSessionId:s,message:new Ce.Td({messageId:o.messageId,claimsChallengeMessage:e})})}).bind(this);a.then((t=>{t.setClaimsChallengeCallback(e)})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.error,e.message)}))}else this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.error,`Did not respond to ${i} with Id ${o.messageId}`),this.sendBridgeMessage({bridgeId:t,docSessionId:s,response:new fe._p({messageId:o.messageId,error:"Unknown message type to handle"})})}catch(e){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.error,e.message),this.sendBridgeMessage({bridgeId:"unknown",docSessionId:"unknown",response:new fe._p({messageId:"unknown",error:e.message})})}}addBridgeCallbacksForSession(e,t){e.then((e=>{e.setServerAuthenticationStateChangeCallback((e=>{this.sendBridgeMessage({bridgeId:"*",docSessionId:t,message:new fe.wU({serverAuthenticationState:e})})})),e.setSessionCloseCallback((e=>{this.sessionCloseReasonMap.set(t,e.reason),this.sendBridgeMessage({bridgeId:"*",docSessionId:t,message:e})})),e.setConnectCallback(((e,s,o,n,i)=>{this.sendBridgeMessage({bridgeId:"*",docSessionId:t,message:new fe.uN({origin:o,sessionKey:s.split("/").pop(),sessionUrlBase:s.split("/").slice(0,-1).join("/"),anonymousToken:n,routingSessionKey:i})}),this.sendBridgeMessage({bridgeId:"*",docSessionId:t,message:new fe.gy({isSeedingRequired:e,sessionUrl:s,origin:o,authToken:n,routingSessionKey:i})})})),e.setReconnectCallback((()=>{this.sendBridgeMessage({bridgeId:"*",docSessionId:t,message:new fe.lj})})),e.setDisconnectCallback((e=>{this.sendBridgeMessage({bridgeId:"*",docSessionId:t,message:new fe.eG({error:e})})}))})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.error,e.message)}))}handleAnnotationActivationMessage(e,t,s,o){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.info,`Activate Annotation of type = ${e.annotationType} token = ${e.token}`);const n=((o,n)=>{this.sendBridgeMessage({bridgeId:t,docSessionId:s,message:new fe.B_({annotationType:e.annotationType,areApologies:!0,ops:[o],cv:n})})}).bind(this),i=o.then((o=>o.activateAnnotation(e.annotationType,{config:e.config,callback:(o,n)=>{this.sendBridgeMessage({bridgeId:t,docSessionId:s,message:new fe.B_({annotationType:e.annotationType,ops:[o],cv:n})})},apologyCallback:e.sendApologies?n:void 0,forceReturnCachedAnnotations:e.forceReturnCachedAnnotations}).then((t=>(this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.info,`Annotation Activation Response Recieved with token = ${t.token}`),new fe.PY({messageId:e.messageId,token:t.token}))))));this.sendResponseAcrossBridge(i,e,t,s)}handleSessionInitMessage(e,t,s){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.info,`Initing session with doc session id ${t}`),this.addCallbacksAlreadySet.has(t)||(this.addBridgeCallbacksForSession(s,t),this.addCallbacksAlreadySet.add(t)),s.then((s=>{const o=s.getConnectParams();if(void 0===o)return;const n=o.sessionUrl;this.sendBridgeMessage({bridgeId:e,docSessionId:t,message:new fe.uN({origin:o.origin,sessionKey:n.split("/").pop(),sessionUrlBase:n.split("/").slice(0,-1).join("/"),anonymousToken:o.authToken,routingSessionKey:o.routingSessionKey})}),this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.info,`Inited session with doc session id ${t}`),this.sendBridgeMessage({bridgeId:e,docSessionId:t,message:new fe.wU({serverAuthenticationState:s.getServerAuthenticationState()})})})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.error,e.message)}))}handleGetAnnotationRequestBridgeMessage(e,t,s,o){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.info,"Sending Get Annotation request");const n=o.then((t=>t.getAnnotations({annotationType:e.annotationTypes,sourceInfo:e.sourceInfo,configs:e.configs,transientItems:e.transientItems,maxDelayMs:e.maxDelayMs,tryResolveUpstreamDependencies:e.tryResolveUpstreamDependencies,cv:e.cv})));Promise.resolve(n).then((o=>{var n,i,a;return Ae(this,void 0,void 0,(function*(){var r,c,l,u,p,g,h;try{for(n=!0,i=ve(o);!(r=(a=yield i.next()).done);n=!0){u=a.value,n=!1;const o=u;this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.info,"Receiving Get Annotation request");const i=new Se.rK({content:o.content,errorInfo:null===(p=o.error)||void 0===p?void 0:p.serviceError,warningInfo:null===(g=o.warning)||void 0===g?void 0:g.serviceError}),r=new Ce.wR({messageId:e.messageId,serverResponse:JSON.stringify(i),clientError:null===(h=o.error)||void 0===h?void 0:h.clientError,finalResponse:o.finalResponse});this.sendBridgeMessage({bridgeId:t,docSessionId:s,response:r})}}catch(e){c={error:e}}finally{try{n||r||!(l=i.return)||(yield l.call(i))}finally{if(c)throw c.error}}}))})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.error,e.message)}))}handleSubmittedCustomMessage(e,t,s,o){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.info,`Receiving SubmittedCustomMessage via message ${e.messageId}`),o.then((o=>{o.submitCustomMessage(e.customMessage).then((o=>{fe.YK.typeGuard(o)?o.messageId=e.messageId:this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.error,"Unexpeced response type from SubmitCustomMessage"),this.sendBridgeMessage({bridgeId:t,docSessionId:s,response:o})})).catch((o=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.error,o.message),this.sendBridgeMessage({bridgeId:t,docSessionId:s,response:new fe._p({messageId:e.messageId,error:o.message})})}))})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.error,e.message)}))}handleInteractiveAuthMessage(e,t,s,o){let n;this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.info,`Interactive auth requested via message ${e.messageId}`),o.then((o=>{o.authenticateInteractive().then((()=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.info,`Interactive auth succeeded for message ${e.messageId}`),n=new fe.YK({messageId:e.messageId})})).catch((t=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.error,`Interactive auth failed for message ${e.messageId}`),n=new fe._p({messageId:e.messageId,error:t.message})})).finally((()=>{this.sendBridgeMessage({bridgeId:t,docSessionId:s,response:n})}))})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.error,e.message)}))}}var Ee=s(427420),Ie=s(676916),we=s(726529);class be{constructor(e){n.h.assign(be,this,e)}static getTypeName(){return"AugLoop_Powerpoint_Session_Protocol_PowerPointSessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SessionInitMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[be.getTypeName()])}}be.H_={T_:be.getTypeName(),B_:be.getBaseTypes()};class ke{constructor(e){n.h.assign(ke,this,e)}static getTypeName(){return"AugLoop_Powerpoint_Session_Protocol_PowerPointSessionExtensionConfig"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[ke.getTypeName()])}}ke.H_={T_:ke.getTypeName(),B_:ke.getBaseTypes()};var Me=function(e,t,s,o){return new(s||(s=Promise))((function(n,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function r(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((o=o.apply(e,t||[])).next())}))},Le=function(e){return this instanceof Le?(this.v=e,this):new Le(e)},Be=function(e,t,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,n=s.apply(e,t||[]),i=[];return o={},a("next"),a("throw"),a("return"),o[Symbol.asyncIterator]=function(){return this},o;function a(e){n[e]&&(o[e]=function(t){return new Promise((function(s,o){i.push([e,t,s,o])>1||r(e,t)}))})}function r(e,t){try{(s=n[e](t)).value instanceof Le?Promise.resolve(s.value.v).then(c,l):u(i[0][2],s)}catch(e){u(i[0][3],e)}var s}function c(e){r("next",e)}function l(e){r("throw",e)}function u(e,t){e(t),i.shift(),i.length&&r(i[0][0],i[0][1])}},De=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,s=e[Symbol.asyncIterator];return s?s.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(s){t[s]=e[s]&&function(t){return new Promise((function(o,n){(function(e,t,s,o){Promise.resolve(o).then((function(t){e({value:t,done:s})}),t)})(o,n,(t=e[s](t)).done,t.value)}))}}};const Pe=(e,t)=>{const s=[];for(const n of Object.keys(e)){if(void 0===e[n]||null===e[n])continue;const i={name:t?`${t}.${n}`:n,dataType:(o=e[n],"string"==typeof o?0:"boolean"==typeof o?1:"number"==typeof o?2:void Ee.Hv.sendTraceTag(572838285,Ie.n.msoulscat_Wac_BrowserGeneral,we.k.Warning,"Unsupported data field type")),value:e[n],classification:4};s.push(i)}var o;return s},Re=e=>Promise.resolve(!1);class Oe{constructor(){this._telemetryAggregationIntervalSec=30,this._eventHandlerDictionary={},this._changeGateEnabledCallback=void 0,this._bridge=null,this._bridgeInterceptor=null,this._sessionCloseReason=null,this._isSessionClosed=null,this._isSessionConnected=null,this._sessionConnectParams=null,this._serverAuthenticationState=Te.f.NotAuthenticated,this._connectCallbacks=new Map,this._connectionStateCallbackToken=0,this._claimsChallengeCallbacks=[],this._seedingStatusChangeCallbacks=[],this._bridgeMessageSequenceId=0,this._runtimeClientBridge=void 0,this._useBridgePackage=void 0,this.initialize=e=>{if(this._runtimeInitPromise)return void Ee.Hv.sendTraceTag(572838286,Ie.n.msoulscat_Wac_BrowserGeneral,we.k.Info,"Runtime already initialized");Ee.Hv.sendTraceTag(572838287,Ie.n.msoulscat_Wac_BrowserGeneral,we.k.Info,"Start and initialize augloop runtime ..."),this.checkParametersAndThrow("initialize",e);const t=[];t.push(this.isFeatureEnabled("Microsoft.Office.AugLoop.UseBridgePackage","None").then((e=>{this._useBridgePackage=e,Ee.Hv.sendTraceTag(505419218,Ie.n.msoulscat_Wac_BrowserGeneral,we.k.Info,`Use bridge package: ${e}`)}))),t.push(this.isFeatureEnabled("ModelDownloaderEbrake","None").then((t=>{t?Ee.Hv.sendTraceTag(556376070,Ie.n.msoulscat_Wac_BrowserGeneral,we.k.Info,"Resource downloader not created due to feature gate"):this.modelDownloaderFromCDN=e.appName&&e.downloadBaseUrl||e.downloadPolymerBaseUrl?new de.$(e.appName,e.downloadBaseUrl,e.downloadPolymerBaseUrl):void 0}))),this.inferenceServiceFactory=e.appName&&e.inferenceServiceVersion?ye.createFactory(e.appName,e.inferenceServiceVersion):void 0,this.powerpointParameters=e.powerpoint;const s={appName:e.appName,appPlatform:"Web",appVersion:e.appVersion,uiLanguage:e.uiLanguage,releaseAudienceGroup:e.releaseAudienceGroup,releaseChannel:e.releaseChannel,releaseCustomAudience:e.releaseCustomAudience,releaseFork:e.releaseFork,sessionId:e.sessionId,flights:e.flights,privateMode:e.privateMode,disabledServiceGroups:e.disabledServiceGroups,userSystemTimezone:e.userSystemTimezone,isClientTelemetrySampled:e.isClientTelemetrySampled},n={onResult:this.onResult.bind(this),onAnnotationResult:this.onAnnotationResult.bind(this),sendTelemetryEvent:this.sendTelemetryEvent.bind(this),sendDiagnosticTrace:this.sendDiagnosticTrace.bind(this),requestAuthToken:this.requestAuthToken.bind(this),isFeatureEnabled:this.isFeatureEnabled.bind(this),isChangeGateEnabled:this.isChangeGateEnabled.bind(this),setSessionData:this.setSessionData.bind(this),areLicenseFeaturesEnabled:Re,onInitSession:this.onInitSession.bind(this),overrideSessionInitMessage:this.overrideSessionInitMessage.bind(this)},i=Promise.all(t).then((()=>o.fA.init(e.serviceUrl,s,n,{telemetryAggregationIntervalSec:this._telemetryAggregationIntervalSec,modelDownloader:this.modelDownloaderFromCDN,inferenceServiceFactory:this.inferenceServiceFactory,isDeltaGeneratorEnabled:e.isDeltaGeneratorEnabled,disableSyncDeltaSending:e.disableSyncDeltaSending,syncDeltaTimeout:e.syncDeltaTimeout}))).then((()=>ge.init(e.serviceUrl,s,n)));this.createSession=()=>{this._runtimeInitPromise=i.then((()=>{let t=e.sessionCreationOptions;if(t||(t={}),this._useBridgePackage){if(this._runtimeClientBridge=new Ne,this._bridge){const e={sendDiagnosticTrace:(e,t,s)=>{const o=(()=>{switch(t){case he.q.error:return we.k.Error;case he.q.warn:return we.k.Warning;case he.q.info:return we.k.Info;case he.q.verbose:case he.q.debug:return we.k.Verbose;default:return we.k.Info}})();Ee.Hv.sendTraceTag(e,Ie.n.msoulscat_Wac_BrowserGeneral,o,s)},sendTelemetryEvent:(e,t,s,o,n,i,a,r)=>{throw new Error("Method not implemented.")}};this._runtimeClientBridge.initialize({messageBridge:this._bridge,getSessionCallback:this.getSessionCallback.bind(this),hostTelemetryCallbacks:e,changeGateFeatureGateCallbacks:{isFeatureEnabled:this.isFeatureEnabled.bind(this),isChangeGateEnabled:this.isChangeGateEnabled.bind(this)}})}else Ee.Hv.sendTraceTag(505415107,Ie.n.msoulscat_Wac_BrowserGeneral,we.k.Error,"bridge is not set, cannot initialize RuntimeClientBridge");this._bridgeInterceptor&&this._runtimeClientBridge.setInterceptor(this._bridgeInterceptor)}else{this._bridge&&this._bridge.registerMessageReceivedCallback(this.onBridgeMessage.bind(this)),this._bridgeInterceptor&&this._bridgeInterceptor.registerMessageReceivedCallback(this.onBridgeMessageFromInterceptor.bind(this));const e=t.onServerAuthenticationStateChangeCallback;t.onServerAuthenticationStateChangeCallback=t=>{this._serverAuthenticationState=t,e&&e(t),this._bridge&&this.sendBridgeMessage({bridgeId:"*",docSessionId:"*",message:new fe.wU({serverAuthenticationState:t})})};const s=t.onSessionClose;t.onSessionClose=e=>{this._sessionCloseReason=e.reason,this._isSessionClosed=!0,s&&s(e),this._bridge&&this.sendBridgeMessage({bridgeId:"*",docSessionId:"*",message:e})};const o=t.onSessionReconnect;t.onSessionReconnect=()=>{o&&o(),this._bridge&&this.sendBridgeMessage({bridgeId:"*",docSessionId:"*",message:new fe.lj})};const n=t.onSessionDisconnect;t.onSessionDisconnect=e=>{this._isSessionConnected=!1,n&&n(e),this._bridge&&(this._sessionConnectParams=void 0,this.sendBridgeMessage({bridgeId:"*",docSessionId:"*",message:new fe.eG({error:e})}))}}const s=t.onSessionConnect;t.onSessionConnect=(e,t,o,n,i)=>{this._isSessionConnected=!0,this._isSessionClosed=!1,s&&s(e,t,o,n,i),this._connectCallbacks.forEach(((s,a)=>{s(e,t,o,n,i)})),this._bridge&&!this._useBridgePackage&&(this._sessionConnectParams||(this._sessionConnectParams={authToken:n,isSeedingRequired:e,sessionUrl:t,origin:o,routingSessionKey:i},this.sendSessionInitResponseToBridge("*","*")),this.sendBridgeMessage({bridgeId:"*",docSessionId:"*",message:new fe.gy({isSeedingRequired:e,sessionUrl:t,origin:o,authToken:n,routingSessionKey:i})}))};const n=t.onClaimsChallengeCallback;t.onClaimsChallengeCallback=e=>{n&&n(e),this._claimsChallengeCallbacks.forEach((t=>{t(e)}))};const i=t.onSeedingStatusChangeCallback;t.onSeedingStatusChangeCallback=e=>{i&&i(e),this._seedingStatusChangeCallbacks.forEach((t=>{t(e)}))};const a=t&&t.docSessionId||e.sessionId;return o.fA.createSession(Object.assign(Object.assign({},t),{docSessionId:a}))}))},this.createSession()},this.getSession=()=>this._runtimeInitPromise,this.setULSLogger=e=>{this.checkParametersAndThrow("setULSLogger",e&&e.ulsLogger),Ee.Hv.setLogger(e.ulsLogger)},this.setSendOTelEventCallback=e=>{this.checkParametersAndPropertyAndThrow("setSendOTelEventCallback",e&&e.sendOTelEvent,this._sendOTelEventCallback),this._sendOTelEventCallback=e.sendOTelEvent},this.setSendDiagnosticTraceCallback=e=>{this.checkParametersAndPropertyAndThrow("setSendDiagnosticTraceCallback",e&&e.sendDiagnosticTraceCallback,this._sendDiagnosticTraceCallback),this._sendDiagnosticTraceCallback=e.sendDiagnosticTraceCallback},this.setRequestAuthTokenCallback=e=>{this.checkParametersAndPropertyAndThrow("setRequestAuthTokenCallback",e&&e.requestAuthTokenCallback,this._requestAuthTokenCallback),this._requestAuthTokenCallback=e.requestAuthTokenCallback},this.setIsFeatureEnabledCallback=e=>{this.checkParametersAndPropertyAndThrow("setIsFeatureEnabledCallback",e&&e.featureEnabledCallback,this._featureEnabledCallback),this._featureEnabledCallback=e.featureEnabledCallback},this.setIsChangeGateEnabledCallback=e=>{this.checkParametersAndPropertyAndThrow("setIsChangeGateEnabledCallback",e&&e.changeGateEnabledCallback,this._changeGateEnabledCallback),this._changeGateEnabledCallback=e.changeGateEnabledCallback},this.registerLocalWorkflow=e=>{const t="registerLocalWorkflow";this.checkParametersAndThrow(t,e&&e.workflow),this.checkRuntimeInitAndThrow(t),this._runtimeInitPromise.then((t=>{t.registerLocalWorkflow(e.workflow)}))},this.activateAnnotation=e=>{const t="activateAnnotation",s=this.checkParameters(t,e&&e.annotationType)||this.checkRuntimeInit(t);return s?Promise.reject(s):this._runtimeInitPromise.then((t=>{let s;return(e.config||e.handler||e.stateUpdateHandler)&&(s={config:e.config,callback:e.handler,apologyCallback:e.apologyHandler,stateUpdateCallback:e.stateUpdateHandler,forceReturnCachedAnnotations:e.forceReturnCachedAnnotations}),t.activateAnnotation(e.annotationType,s)}))},this.updateAnnotationConfig=e=>{const t="updateAnnotationConfig",s=this.checkParameters(t,e&&e.token&&e.config)||this.checkRuntimeInit(t);return s?Promise.reject(s):this._runtimeInitPromise.then((t=>{t.updateAnnotationConfig(e.token,e.config)}))},this.releaseAnnotation=e=>{const t="releaseAnnotation",s=this.checkParameters(t,e&&e.token)||this.checkRuntimeInit(t);return s?Promise.reject(s):this._runtimeInitPromise.then((t=>t.releaseAnnotation(e.token)))},this.submitOperation=e=>{const t="submitOperation";this.checkParametersAndThrow(t,e&&e.operation),this.checkRuntimeInit(t),this._runtimeInitPromise.then((t=>{t.submitOperation(e.operation,e.cv)}))},this.setSessionDataCallback=e=>{this.checkParametersAndPropertyAndThrow("setSessionDataCallback",e&&(e.sessionDataCallback||e.handler),this._setSessionDataCallback),e.sessionDataCallback?this._setSessionDataCallback=e.sessionDataCallback:e.handler&&(this._setSessionDataCallback=(t,s,o)=>e.handler(t,s))},this.setAnnotationResultCallback=e=>{const t="setAnnotationResultCallback";if(this.checkParametersAndThrow(t,e&&e.handler),this._annotationResultCallback){const e=`${t} already called`;Ee.Hv.sendTraceTag(537401028,Ie.n.msoulscat_Wac_BrowserGeneral,we.k.Error,e)}this._annotationResultCallback=e.handler},this.setAnnotationState=e=>{const t="setAnnotationState";this.checkParametersAndThrow(t,e&&e.parentPath&&e.id&&e.value),this.checkRuntimeInitAndThrow(t),this._runtimeInitPromise.then((t=>{t.setAnnotationState(e.parentPath,e.id,e.value)}))},this.setAnnotationMetadata=e=>{const t="setAnnotationMetadata";this.checkParametersAndThrow(t,e&&e.parentPath&&e.id&&e.value),this.checkRuntimeInitAndThrow(t),this._runtimeInitPromise.then((t=>{t.setAnnotationMetadata(e.parentPath,e.id,e.value)}))},this.setInitSessionCallback=e=>{this.checkParametersAndPropertyAndThrow("setInitSessionCallback",e&&e.initSessionCallback,this._initSessionCallback),this._initSessionCallback=e.initSessionCallback},this.setSessionInitOverrideCallback=e=>{this.checkParametersAndPropertyAndThrow("setSessionInitOverrideCallback",e&&e.handler,this._sessionInitOverrideCallback),this._sessionInitOverrideCallback=e.handler},this.setMessageBridge=e=>{this.checkParametersAndPropertyAndThrow("setMessageBridge",e&&e.bridge,this._bridge),this._bridge=e.bridge},this.setMessageBridgeToALInterceptor=e=>{this.checkParametersAndPropertyAndThrow("setMessageBridgeToALInterceptor",e&&e.bridge,this._bridgeInterceptor),this._bridgeInterceptor=e.bridge},this.forceReconnectSession=e=>{const t="forceReconnectSession",s=this.checkParameters(t,e)||this.checkRuntimeInit(t);return s?Promise.reject(s):this._runtimeInitPromise.then((e=>e.forceReconnect()))},this.setSessionCloseCallback=e=>{const t="setSessionCloseCallback",s=this.checkParameters(t,e&&e.callback)||this.checkRuntimeInit(t);return s?Promise.reject(s):this._runtimeInitPromise.then((t=>{t.setSessionCloseCallback(e.callback)}))},this.setConnectCallback=e=>{const t=this.getSessionStateCallbackToken("connect");return e.callback&&this._connectCallbacks.set(t,e.callback),t},this.removeConnectionStateCallback=e=>!!this._connectCallbacks.has(e.token)&&(this._connectCallbacks.delete(e.token),!0),this.setSeedingStatusChangeCallback=e=>{this._seedingStatusChangeCallbacks.push(e.callback)},this.submitCustomMessage=e=>{const t="submitCustomMessage",s=this.checkParameters(t,e&&e.message)||this.checkRuntimeInit(t);return s?Promise.reject(s):this._runtimeInitPromise.then((t=>t.submitCustomMessage(e.message)))},this.submitLargeBinaryDataMessage=e=>{const t="submitLargeBinaryDataMessage",s=this.checkParameters(t,e&&e.message)||this.checkRuntimeInit(t);return s?Promise.reject(s):fe.VR.typeGuard(e.message)?this._runtimeInitPromise.then((t=>t.submitLargeBinaryDataMessage(e.message))):Promise.reject(`${t} only supports MicroSyncMessage`)},this.requestBinaryDataForBlob=e=>{const t="requestBinaryDataForBlob",s=this.checkParameters(t,e&&e.blob)||this.checkRuntimeInit(t);return s?Promise.reject(s):this._runtimeInitPromise.then((t=>t.requestBinaryDataForBlob(e.blob)))},this.closeSession=()=>{const e=this.checkRuntimeInit("closeSession");return e?Promise.reject(e):this._runtimeInitPromise.then((e=>{e.close()}))},this.startNewSession=()=>{if(!this.createSession){const e="startNewSession called before runtime init";throw Ee.Hv.sendTraceTag(537408074,Ie.n.msoulscat_Wac_BrowserGeneral,we.k.Error,e),new Error(e)}this.createSession(),this._sessionCloseReason=null,this._sessionConnectParams=null},this.authenticateInteractive=()=>{const e=this.checkRuntimeInit("authenticateInteractive");return e?Promise.reject(e):this._runtimeInitPromise.then((e=>e.authenticateInteractive()))},this.getAnnotations=e=>{const t="getAnnotations",s=this.checkParameters(t,e&&e.request),o=this.checkRuntimeInit(t),n=s||o;return n?Promise.resolve({[Symbol.asyncIterator](){return Be(this,arguments,(function*(){const e=s?_e.zy.InvalidRequest:_e.zy.RuntimeNotInitialized;Ee.Hv.sendTraceTag(505952348,Ie.n.msoulscat_Wac_BrowserGeneral,we.k.Error,`ClientError. Code: ${e}, Error: ${null==n?void 0:n.message}`),yield yield Le({content:void 0,error:{clientError:{code:e,error:null==n?void 0:n.message}}})}))}}):this._runtimeInitPromise.then((t=>t.getAnnotations(e.request,e.cancellationToken)))},this.getAsyncClient=e=>{const t=this.checkRuntimeInit("getAsyncClient");return t?Promise.reject(t):this._runtimeInitPromise.then((t=>I.create({session:t,scheduler:e.scheduler})))},this.submit=e=>{const t="submit";this.checkParametersAndThrow(t,e&&e.inputSchema&&e.input),this.checkRuntimeInitAndThrow(t),this._runtimeInitPromise.then((()=>{ge.submit(e.inputSchema,e.input,e.correlationVector)}))},this.addEventHandler=e=>{this.checkParametersAndThrow("addEventHandler",e&&e.schemaName&&e.handler);const t=this._eventHandlerDictionary[e.schemaName]||[];t.push(e.handler),this._eventHandlerDictionary[e.schemaName]=t},this.removeEventHandler=e=>{this.checkParametersAndThrow("removeEventHandler",e&&e.schemaName&&e.handler);const t=this._eventHandlerDictionary[e.schemaName];if(!Array.isArray(t))return;const s=t.indexOf(e.handler);s>=0&&t.splice(s,1)},this.registerSimpleRemoteWorkflow=e=>{const t="registerSimpleRemoteWorkflow",s=this.checkParameters(t,e&&e.name&&e.lambdaRemote)||this.checkRuntimeInit(t);return s?Promise.reject(s):this._runtimeInitPromise.then((()=>ge.registerSimpleRemoteWorkflow(e.name,e.lambdaBefore,e.lambdaRemote,e.lambdaAfter)))},this.registerSimpleLocalWorkflow=e=>{const t="registerSimpleLocalWorkflow",s=this.checkParameters(t,e&&e.name&&e.lambda)||this.checkRuntimeInit(t);return s?Promise.reject(s):this._runtimeInitPromise.then((()=>ge.registerSimpleLocalWorkflow(e.name,e.lambda)))},this.registerReduceWorkflow=e=>Promise.resolve(),this.registerSchemas=e=>Promise.resolve(),this.onResult=(e,t,s,o)=>{const n=this._eventHandlerDictionary[s];if(n)for(const i of n)if(i){i({inputSchema:e,input:t,outputSchema:s,output:o})}},this.onAnnotationResult=(e,t)=>{this._annotationResultCallback&&this._annotationResultCallback(e,t)},this.requestAuthToken=e=>{if(!this._requestAuthTokenCallback)return Promise.resolve({Token:""});return(this._requestAuthTokenCallback(e)||Promise.resolve("")).then((e=>{const t=e||"";return Promise.resolve({Token:t})}))},this.sendTelemetryEvent=(e,t,s,o,n,i,a,r)=>{this._sendOTelEventCallback&&this._sendOTelEventCallback(((e,t,s,o,n,i,a)=>{const r={telemetryProperties:{ariaTenantToken:e,nexusTenantToken:-1},eventName:t.split("_").join("."),dataFields:Pe(s),eventFlags:{dataCategories:i,diagnosticLevel:a,samplingPolicy:1}};return o&&(r.eventContract={name:o,dataFields:Pe(n,o.split(".").slice(-1)[0])}),r})(e,t,s,o,n,a,r))},this.sendDiagnosticTrace=(e,t,s)=>{this._sendDiagnosticTraceCallback&&this._sendDiagnosticTraceCallback(e,t,s)},this.isFeatureEnabled=(e,t)=>{if(!e)return Promise.resolve(!1);const s="Microsoft.Office.AugLoop.";if(0===e.indexOf(s)&&this._featureEnabledCallback){const t=e.slice(25);return Promise.resolve(this._featureEnabledCallback(t)||this._featureEnabledCallback(e))}return Promise.resolve(!1)},this.isChangeGateEnabled=e=>e&&this._changeGateEnabledCallback?Promise.resolve(this._changeGateEnabledCallback(e)):Promise.resolve(!1),this.setSessionData=(e,t,s)=>{this._setSessionDataCallback&&this._setSessionDataCallback(e,t,s)},this.overrideSessionInitMessage=e=>this._sessionInitOverrideCallback?this._sessionInitOverrideCallback(e):0===e.clientMetadata.appName.indexOf("PowerPoint")&&this.powerpointParameters?this.overridePowerPointSessionInitMessage(e):e,this.overridePowerPointSessionInitMessage=e=>{const t={downloadUrl:this.powerpointParameters.downloadUrl,getItemsEndPoint:this.powerpointParameters.getItemsEndPoint,documentOpenType:this.powerpointParameters.documentOpenType};for(const s of Object.keys(e))t[s]=e[s];return new be(t)},this.onInitSession=()=>this._initSessionCallback?this._initSessionCallback():Promise.resolve(),this.checkParameters=(e,t)=>{if(!t){const t=`${e} called with invalid parameters`;return Ee.Hv.sendTraceTag(537408075,Ie.n.msoulscat_Wac_BrowserGeneral,we.k.Error,t),new Error(t)}},this.checkParametersAndThrow=(e,t)=>{const s=this.checkParameters(e,t);if(s)throw s},this.checkParametersAndPropertyAndThrow=(e,t,s)=>{if(this.checkParametersAndThrow(e,t),s){const t=`${e} already called`;throw Ee.Hv.sendTraceTag(537408076,Ie.n.msoulscat_Wac_BrowserGeneral,we.k.Error,t),new Error(t)}},this.checkRuntimeInit=e=>{if(!this._runtimeInitPromise){const t=`${e} called before runtime init`;return Ee.Hv.sendTraceTag(537408077,Ie.n.msoulscat_Wac_BrowserGeneral,we.k.Error,t),new Error(t)}},this.checkRuntimeInitAndThrow=e=>{const t=this.checkRuntimeInit(e);if(t)throw t},this.sendBridgeMessage=e=>{this._bridge&&(e.seq=this._bridgeMessageSequenceId++,this._bridge.sendMessage(JSON.stringify(new fe.vG(e))))},this.onBridgeMessage=e=>{null!=this._bridgeInterceptor?this._bridgeInterceptor.sendMessage(e):this.handleReceivedBridgeMessage(e)},this.sendSessionInitResponseToBridge=(e,t)=>{if(this._sessionConnectParams){const s=this._sessionConnectParams.sessionUrl;this.sendBridgeMessage({bridgeId:e,docSessionId:t,message:new fe.uN({origin:this._sessionConnectParams.origin,sessionKey:s.split("/").pop(),sessionUrlBase:s.split("/").slice(0,-1).join("/"),anonymousToken:this._sessionConnectParams.authToken,routingSessionKey:this._sessionConnectParams.routingSessionKey})})}},this.handleReceivedBridgeMessage=e=>{try{const{bridgeId:t,docSessionId:s,message:o}=JSON.parse(e),i=n.h.getTypeNameFor(o);if(Ee.Hv.sendTraceTag(509092291,Ie.n.msoulscat_Wac_BrowserGeneral,we.k.Info,`Received ${i}`),null!=this._sessionCloseReason&&this.sendBridgeMessage({bridgeId:"*",docSessionId:"*",message:new fe.w9({reason:this._sessionCloseReason})}),Ce.Cs.typeGuard(o)){Ee.Hv.sendTraceTag(505448338,Ie.n.msoulscat_Wac_BrowserGeneral,we.k.Info,`Sending GetHostBridgeSessionResponse to bridge with docSessionId ${s}`);const e=this.checkRuntimeInit("GetHostBridgeSessionRequestMessage");e?this.sendBridgeMessage({bridgeId:t,docSessionId:s,response:new fe._p({messageId:o.messageId,error:e.message})}):this.sendBridgeMessage({bridgeId:t,docSessionId:s,response:new Ce.f8({messageId:o.messageId,isConnected:this._isSessionConnected,isClosed:this._isSessionClosed})})}else if(fe.n4.typeGuard(o)){const e=((e,n)=>{this.sendBridgeMessage({bridgeId:t,docSessionId:s,message:new fe.B_({annotationType:o.annotationType,areApologies:!0,ops:[e],cv:n})})}).bind(this),n=this.activateAnnotation({annotationType:o.annotationType,config:o.config,handler:(e,n)=>{this.sendBridgeMessage({bridgeId:t,docSessionId:s,message:new fe.B_({annotationType:o.annotationType,ops:[e],cv:n})})},apologyHandler:o.sendApologies?e:void 0,forceReturnCachedAnnotations:o.forceReturnCachedAnnotations}).then((e=>new fe.PY({messageId:o.messageId,token:e.token})));this.sendResponseAcrossBridge(n,o,t,s)}else if(Se.x5.typeGuard(o))this.handleGetAnnotationsRequestMessage(t,s,o);else if(fe.Tb.typeGuard(o)){for(const e of o.ops)this.submitOperation({operation:e,cv:o.cv});this.sendBridgeMessage({bridgeId:t,docSessionId:s,response:new fe.YK({messageId:o.messageId})}),Ee.Hv.sendTraceTag(509092288,Ie.n.msoulscat_Wac_BrowserGeneral,we.k.Info,`Responded to ${i}`)}else if(fe.GA.typeGuard(o)){const e=this.releaseAnnotation({token:o.token}).then((e=>new fe.Qq({messageId:o.messageId,lastRelease:e})));this.sendResponseAcrossBridge(e,o,t,s)}else if(fe.g$.typeGuard(o))this.submitCustomMessage({message:o.customMessage}).then((e=>{fe.YK.typeGuard(e)?(e.messageId=o.messageId,Ee.Hv.sendTraceTag(508432467,Ie.n.msoulscat_Wac_BrowserGeneral,we.k.Info,`Responded to ${i}`)):Ee.Hv.sendTraceTag(508420946,Ie.n.msoulscat_Wac_BrowserGeneral,we.k.Error,"Unexpeced response type from SubmitCustomMessage"),this.sendBridgeMessage({bridgeId:t,docSessionId:s,response:e})})).catch((e=>{Ee.Hv.sendTraceTag(508436636,Ie.n.msoulscat_Wac_BrowserGeneral,we.k.Error,e.message),this.sendBridgeMessage({bridgeId:t,docSessionId:s,response:new fe._p({messageId:o.messageId,error:e.message})})}));else if(fe.eE.typeGuard(o))this.sendSessionInitResponseToBridge(t,s),this.sendBridgeMessage({bridgeId:t,docSessionId:s,message:new fe.wU({serverAuthenticationState:this._serverAuthenticationState})});else if(n.h.matchesTypesFor(o,[Ce.i2.getTypeName()])){const e=this._runtimeInitPromise.then((e=>e.authenticateInteractive())).then((()=>new fe.YK({messageId:o.messageId})));this.sendResponseAcrossBridge(e,o,t,s)}else if(n.h.matchesTypesFor(o,[Ce.og.getTypeName()])){const e=(e=>{this.sendBridgeMessage({bridgeId:t,docSessionId:s,message:new Ce.U8({messageId:o.messageId,seedingStatusChangeMessage:e})})}).bind(this);this._runtimeInitPromise.then((t=>{t.setSeedingStatusChangeCallback(e)})).catch((e=>{Ee.Hv.sendTraceTag(506474634,Ie.n.msoulscat_Wac_BrowserGeneral,we.k.Warning,`RuntimeInitPromiseException for message with Id ${o.messageId}`)}))}else if(n.h.matchesTypesFor(o,[Ce.tj.getTypeName()])){const e=(e=>{this.sendBridgeMessage({bridgeId:t,docSessionId:s,message:new Ce.Td({messageId:o.messageId,claimsChallengeMessage:e})})}).bind(this);this._runtimeInitPromise.then((t=>{t.setClaimsChallengeCallback(e)})).catch((e=>{Ee.Hv.sendTraceTag(506987159,Ie.n.msoulscat_Wac_BrowserGeneral,we.k.Warning,`RuntimeInitPromiseException for message with Id ${o.messageId}`)}))}else Ee.Hv.sendTraceTag(509092259,Ie.n.msoulscat_Wac_BrowserGeneral,we.k.Warning,`Did not respond to ${i} with Id ${o.messageId}`),this.sendBridgeMessage({bridgeId:t,docSessionId:s,response:new fe._p({messageId:o.messageId,error:"Unknown message type to handle"})})}catch(e){Ee.Hv.sendTraceTag(509092363,Ie.n.msoulscat_Wac_BrowserGeneral,we.k.Error,e.message),this.sendBridgeMessage({bridgeId:"unknown",docSessionId:"unknown",response:new fe._p({messageId:"unknown",error:e.message})})}},this.handleGetAnnotationsRequestMessage=(e,t,s)=>{const o={request:{annotationType:s.annotationTypes,sourceInfo:s.sourceInfo,configs:s.configs,transientItems:s.transientItems,maxDelayMs:s.maxDelayMs,tryResolveUpstreamDependencies:s.tryResolveUpstreamDependencies,cv:s.cv}};this.getAnnotations(o).then((o=>{var n,i,a;return Me(this,void 0,void 0,(function*(){var r,c,l,u,p,g,h;try{for(n=!0,i=De(o);!(r=(a=yield i.next()).done);n=!0){u=a.value,n=!1;const o=u,i=new Se.rK({content:o.content,errorInfo:null===(p=o.error)||void 0===p?void 0:p.serviceError,warningInfo:null===(g=o.warning)||void 0===g?void 0:g.serviceError}),r=new Ce.wR({messageId:s.messageId,serverResponse:JSON.stringify(i),clientError:null===(h=o.error)||void 0===h?void 0:h.clientError,finalResponse:o.finalResponse});this.sendResponseAcrossBridge(Promise.resolve(r),s,e,t)}}catch(e){c={error:e}}finally{try{n||r||!(l=i.return)||(yield l.call(i))}finally{if(c)throw c.error}}}))}))},this.sendResponseAcrossBridge=(e,t,s,o)=>{e.catch((e=>new fe._p({messageId:t.messageId,error:e.message}))).then((e=>{this.sendBridgeMessage({bridgeId:s,docSessionId:o,response:e}),Ee.Hv.sendTraceTag(508937624,Ie.n.msoulscat_Wac_BrowserGeneral,we.k.Info,`Responded to ${n.h.getTypeNameFor(t)}`)})).catch((e=>{Ee.Hv.sendTraceTag(508937623,Ie.n.msoulscat_Wac_BrowserGeneral,we.k.Error,e.message)}))},this.onBridgeMessageFromInterceptor=e=>{this.handleReceivedBridgeMessage(e)},this.getSessionCallback=e=>this._runtimeInitPromise}getSessionStateCallbackToken(e){return e+"-callback-"+this._connectionStateCallbackToken++}}var xe=s(357635);class Fe{constructor(e){n.h.assign(Fe,this,e)}static getTypeName(){return"AugLoop_Chat_ChatsHolder"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return n.h.matchesTypesFor(e,[Fe.getTypeName()])}}Fe.H_={T_:Fe.getTypeName(),B_:Fe.getBaseTypes()};class Ge{constructor(e){n.h.assign(Ge,this,e)}static getTypeName(){return"AugLoop_Chat_Chat"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[Ge.getTypeName()])}}Ge.H_={T_:Ge.getTypeName(),B_:Ge.getBaseTypes()};class We{constructor(e){n.h.assign(We,this,e)}static getTypeName(){return"AugLoop_Chat_MessagesHolder"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return n.h.matchesTypesFor(e,[We.getTypeName()])}}We.H_={T_:We.getTypeName(),B_:We.getBaseTypes()};class He{constructor(e){n.h.assign(He,this,e)}static getTypeName(){return"AugLoop_Chat_ChatMessage"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[He.getTypeName()])}}He.H_={T_:He.getTypeName(),B_:He.getBaseTypes()};class Ue{constructor(e){n.h.assign(Ue,this,e)}static getTypeName(){return"AugLoop_Chat_TextChatMessage"}static getBaseTypes(){return["AugLoop_Chat_ChatMessage"]}static typeGuard(e){return n.h.matchesTypesFor(e,[Ue.getTypeName()])}}Ue.H_={T_:Ue.getTypeName(),B_:Ue.getBaseTypes()};var qe=s(70239),Ve=s(679853);class $e{static create(e){const t=new $e(e);return t.activateAnnotation(e.responseType).then((()=>t))}constructor(e){this.config=e,this.nextMessageId=0,this.responseCallbacks=new Map;const t=["session","chats"],s=(0,Ve.v4)(),o="messages",n=[...t,s];this.messagesPath=[...n,o],this.config.session.submitOperations([new qe.Xr({parentPath:t,items:[{id:s,body:e.chat}]}),new qe.Xr({parentPath:n,items:[{id:o,body:new We}]})])}send(e,t){const s=""+this.nextMessageId++;this.responseCallbacks.set(s,t),this.config.session.submitOperations([new qe.Xr({parentPath:this.messagesPath,items:[{id:s,body:e}]})])}close(){return this.config.session.releaseAnnotation(this.activatedAnnotationToken)}activateAnnotation(e){return this.config.session.activateAnnotation(e,{callback:e=>{if(qe.Xr.typeGuard(e)&&this.isUnderSubtree(e.parentPath,this.messagesPath))for(const t of e.items){const s=e.parentPath[e.parentPath.length-1],o=this.responseCallbacks.get(s);o&&(o(t.body),this.responseCallbacks.delete(s))}}}).then((({token:e})=>{this.activatedAnnotationToken=e}))}isUnderSubtree(e,t){if(e.length<t.length)return!1;for(let s=0;s<t.length;s++)if(e[s]!==t[s])return!1;return!0}}const je=new class{constructor(){this._augLoopRuntimeManager=new Oe}getAugLoopRuntimeManager(){return this._augLoopRuntimeManager}createSingleItemWorkflow(e){return xe.z.create(e)}createChatHelper(e){return this.getAugLoopRuntimeManager().getSession().then((t=>$e.create(Object.assign({session:t},e))))}createAugLoopRuntimeManager(){return new Oe}}},857070:(e,t,s)=>{var o,n;s.d(t,{y:()=>n}),function(e){e.BaseQueryFailure="BaseQueryFailure",e.ExplanationFailure="ExplanationFailure",e.NoRange="NoRange",e.PowerQueryApiFailure="PowerQueryApiFailure",e.QueryTable="QueryTable",e.StepFromNLFailure="StepFromNLFailure",e.QueryFromNLFailure="QueryFromNLFailure",e.QueryFromNLGiveup="QueryFromNLGiveup",e.TableNotFound="TableNotFound",e.TableEvaluationFailure="TableEvaluationFailure",e.UnexpectedError="UnexpectedError"}(o||(o={})),function(e){e.DataShapingSessionId="dataShapingSessionId",e.DataShapingTableName="dataShapingTableName",e.DataShapingBaseQueryScript="dataShapingBaseQueryScript",e.DataShapingCurrentQueryScript="dataShapingCurrentQueryScript"}(n||(n={}))},864910:(e,t,s)=>{s.d(t,{Ml:()=>n});var o=s(596498);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicensingAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicenseEnabledAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicenseEnabledForBusinessChatAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicenseEnabledForIntelligentSearchAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicenseEnabledForM365TeamsAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicenseEnabledForM365AppsAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CheckCopilotLicenseSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicenseEnabledForSharePointAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(g,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_PlannerPremiumLicenseEnabledAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(h,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_TeamsPremiumLicenseEnabledAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(d,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicensingOnDemandAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(m,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_TeamsCopilotLicensingAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(y,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotUserContextAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()}},867202:(e,t,s)=>{s.d(t,{mu:()=>n,qV:()=>r,vW:()=>i});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_CreditBalance_CreditBalanceSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_CreditBalance_CreditDeductionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_CreditBalance_MeterSignalBase"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_CreditBalance_MeterBalanceSignal"}static getBaseTypes(){return["AugLoop_CreditBalance_MeterSignalBase","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_CreditBalance_MeterSpinSignal"}static getBaseTypes(){return["AugLoop_CreditBalance_MeterSignalBase","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()}},880085:(e,t,s)=>{s.d(t,{A:()=>n});var o=function(){function e(e){this.mergeDictationSettings(e)}return e.prototype.mergeDictationSettings=function(e){var t=this;Object.keys(e).forEach((function(s){t[s]=e[s]}))},e}(),n=function(){function e(){}return Object.defineProperty(e,"dictationSettings",{get:function(){if(e._instance)return e._instance;throw new Error("Dictation Settings not initialized")},set:function(t){e._instance?e._instance.mergeDictationSettings(t):e._instance=new o(t)},enumerable:!1,configurable:!0}),e}()},885118:(e,t,s)=>{s.d(t,{$:()=>c});var o,n=s(937410),i=s(599243),a=s(743210),r=s(87477);!function(e){e.URL="URL",e.ArrayBuffer="ArrayBuffer"}(o||(o={}));class c{constructor(e,t,s,o){this.dbName="ALModels_db",this.osName="ALModels_os",this.dbVersion=2,this.modelPathsCache=new Map,this.isPolymerSupported=Boolean(s),this.baseURL=`https://${t}/web/${e}`,this.polymerBaseURL=this.isPolymerSupported?`https://${s}`:"",this.fetchResource=null!=o?o:"undefined"!=typeof fetch?fetch:r.fetch;const a=new n.I({operationName:"CreateModelDownloader",success:!0,resultDescription:""});a.start(),this.isBrowserIdbCompatible().then((e=>{if(e){let e,t=0,s=0,o=0;const n=new Promise(((t,s)=>{e=setTimeout((()=>{s(new Error("Took longer than 10000 ms"))}),1e4)})),i=this.accessDB().then((e=>{const n=e.transaction(this.osName,"readwrite");return n.objectStore(this.osName).openCursor().then((function e(i){if(o++,i){const o=i.value;let n;return o.timesSinceUsage||(o.timesSinceUsage=0),o.timesSinceUsage++,o.timesSinceUsage>5?(s++,n=i.delete()):(t++,n=i.update(o)),n.then((()=>i.continue())).then(e)}return n.done}))}));this.initPromise=Promise.race([n,i]).catch((e=>{a.success=!1,a.resultDescription+=`${e.message} `})).then((()=>{a.dimension0=`${o}`,a.dimension1=`${t}`,a.dimension2=`${s}`,clearTimeout(e),this.closeDBAndEndLog(a,"initializing idb storage")}))}else a.resultDescription="Incompatible browser for IDB",i.tG.info(538706242,i.nh.CoreDefault,a.stop())})).catch((()=>{a.resultDescription="Issue determining idb compatibility",i.tG.info(536966936,i.nh.CoreDefault,a.stop())}))}getResourceAsArrayBuffer(e,t,s){const i=new n.I({operationName:"GetResource",success:!0,resultDescription:"",dimension0:o.ArrayBuffer,dimension1:e,dimension2:t});i.start();const a={};return this.getResource(e,t,s,o.ArrayBuffer,i,(e=>Promise.all(Array.from(e.keys()).map((t=>{const s=e.get(t);return s.arrayBuffer?s.arrayBuffer().then((e=>{a[t]=e})):new Promise(((e,o)=>{const n=new FileReader;n.readAsArrayBuffer(s),n.onload=s=>{const n=s.target.result;n instanceof ArrayBuffer?(a[t]=n,e()):o(new Error("Unable to obtain ArrayBuffer"))}}))}))))).then((()=>a))}getKey(e,t,s){return s?`${e}_${t}_${JSON.stringify(Array.from(s.entries()))}`:`${e}_${t}`}updateCache(e,t,s,o){this.modelPathsCache.set(this.getKey(e,t,s),o)}getCache(e,t,s){return this.modelPathsCache.get(this.getKey(e,t,s))}getResourceAsURL(e,t,s){const i=new n.I({operationName:"GetResource",success:!0,resultDescription:"",dimension0:o.URL,dimension1:e,dimension2:t});i.start();const a={},r=this.getCache(e,t,s);return r?Promise.resolve(r):this.getResource(e,t,s,o.URL,i,(e=>Promise.all(Array.from(e.keys()).map((t=>{a[t]=URL.createObjectURL(e.get(t))}))))).then((()=>{const o=this.getCache(e,t,s);return o||(this.updateCache(e,t,s,a),a)}))}getResource(e,t,s,o,n,i){return this.getFiles(e,t,s,n).then((e=>i(e))).then((()=>{this.closeDBAndEndLog(n,`retrieving ${e}`)})).catch((t=>{throw n.resultDescription.indexOf(t.message)>=0&&(n.success=!1,n.resultDescription+=`${t.message} `),n.resultSignature=`Issue retrieving from CDN or translating to ${o}`,this.closeDBAndEndLog(n,`retrieving ${e}`),t}))}checkFirefoxCompatibility(e){const t=globalThis.navigator.userAgent.substring(e+8,e+11);return t.replace(".",""),parseInt(t,10)<=70?new Promise((function(e,t){const s=globalThis.indexedDB.open(this.dbName,this.dbVersion);s.onsuccess=function(){e(!0)},s.onerror=function(e){return t(e),!0}})):Promise.resolve(!0)}isBrowserIdbCompatible(){var e,t;return"undefined"==typeof Array||void 0===Array.from||"undefined"==typeof Proxy||"undefined"==typeof URL||void 0===URL.createObjectURL?Promise.resolve(!1):"undefined"!=typeof globalThis&&(null===(e=globalThis.navigator)||void 0===e?void 0:e.userAgent)?globalThis.navigator.userAgent.toLowerCase().indexOf("firefox")>-1?globalThis.indexedDB?this.checkFirefoxCompatibility(globalThis.navigator.userAgent.toLowerCase().indexOf("firefox")):Promise.resolve(!1):globalThis.navigator.userAgent.toLowerCase().indexOf("safari")>-1&&globalThis.navigator.userAgent.toLowerCase().indexOf("chrome")<=-1?(null===(t=globalThis.document)||void 0===t?void 0:t.hasStorageAccess)?globalThis.document.hasStorageAccess().then((()=>!0)).catch((()=>!1)):Promise.resolve(!1):Promise.resolve(!0):Promise.resolve(!1)}accessDB(){return this.accessDBPromise?this.accessDBPromise.then((e=>e.transaction(this.osName).done)).then((()=>this.accessDBPromise)).catch((()=>this.callOpenDB())):this.callOpenDB()}callOpenDB(){return this.accessDBPromise=(0,a.P2)(this.dbName,this.dbVersion,{upgrade:e=>{e.objectStoreNames.contains(this.osName)&&e.deleteObjectStore(this.osName),e.createObjectStore(this.osName,{keyPath:"id",autoIncrement:!0})}})}endLog(e,t){e.success?(e.resultDescription=`Success ${t}`,i.tG.info(573329487,i.nh.CoreDefault,e.stop())):(e.resultDescription+=`error ${t}`,i.tG.error(573329488,i.nh.CoreDefault,e.stop()))}closeDBAndEndLog(e,t){this.accessDBPromise?this.accessDBPromise.then((e=>{e.close()})).catch((t=>{e.resultDescription.indexOf(t.message)>=0&&(e.success=!1,e.resultDescription+=`${t.message?t.message:"Error closing db"} `,e.resultSignature="Issue closing db")})).then((()=>{this.accessDBPromise=void 0,this.endLog(e,t)})):this.endLog(e,t)}getFiles(e,t,s,o){return this.isBrowserIdbCompatible().catch((e=>(o.success=!1,o.resultDescription+=`${e.message} `,o.resultSignature="Issue determining idb compatibility",!1))).then((n=>{const i=()=>{if(s){if(this.isPolymerSupported)return this.downloadFiles1CDN(e,t,s,o,n);throw new Error("Missing polymerBaseURL provided at host level for queries with modelFilters")}return this.downloadFiles(e,t,o,n)};return n?this.getFilesFromIDB(e,t,s,o).catch((e=>(e&&(o.resultDescription.indexOf(e.message)>=0&&(o.success=!1,o.resultDescription+=`${e.message} `),o.resultSignature="Issue retrieving from DB"),i()))):i()}))}getFilesFromIDB(e,t,s,o){return this.initPromise.catch((e=>{o.success=!1,o.resultDescription+=`${e.message} `,o.resultSignature="Issue initializing"})).then((()=>this.getModelOptions(e))).then((n=>{for(const i of n)if(i&&i.model&&i.version==t){if(!this.checkModelFiltersPass(s,i.filters))continue;return this.putModel(e,i.model,t,i.filters,o,i.id),Promise.resolve(i.model)}return Promise.reject()}))}checkModelFiltersPass(e,t){var s;for(const o of e){const e=null===(s=t.get(o[0]))||void 0===s?void 0:s.map((e=>e.toLocaleLowerCase()));if(!e)throw new Error(`Expected filter ${o[0]} to exist in metadata file`);if(e.indexOf(o[1].toLocaleLowerCase())<0)return!1}return!0}downloadFiles1CDN(e,t,s,o,n){let i;return o.dimension3="Polymer",s||(s=new Map),this.fetchResource(`${this.polymerBaseURL}/${e}/${t}/metadata.json`).then((e=>{if(e.ok)return e.text();throw new Error(`CDN download response status: ${e.status}`)})).then((n=>{var a,r;const c=JSON.parse(n);if(c.name!==e||c.version!==t)throw new Error(`Expected: ${e} version ${t}, received: ${c.name} version ${c.version}`);for(const e of c.variants)if(i=new Map(Object.entries(e)),this.checkModelFiltersPass(s,i))return(c.catalog?s.size+2:s.size+1!==i.size)&&(o.success=!1,o.resultDescription+=`Expected ${null===(a=i.keys)||void 0===a?void 0:a.length} # of filters, received ${null===(r=s.keys)||void 0===r?void 0:r.length}`),e.model_files;throw new Error("No model found with given filters")})).then((s=>Promise.all(s.map((s=>this.fetchResource(`${this.polymerBaseURL}/${e}/${t}/${s}`).then((e=>{if(e.ok)return e.blob();throw new Error(`CDN download response status: ${e.status}`)})).then((e=>[s,e]))))))).then((s=>{const a=new Map(s);return n?this.putModel(e,a,t,i,o):a}))}downloadFiles(e,t,s,o){return s.dimension3="FS",this.fetchResource(`${this.baseURL}/catalog_${e}_${t}.json`).then((e=>{if(e.ok)return e.text();throw new Error(`CDN download response status: ${e.status}`)})).then((s=>{const o=JSON.parse(s),n=`${o.MajorVersion}.${o.MinorVersion}/ModelResources`,i=`${e}/${t}/`;return Promise.all(o.Resources.map((e=>(e.Name.length>i.length&&e.Name.substring(0,i.length)===i&&(e.Name=e.Name.substring(i.length)),this.fetchResource(`${this.baseURL}/${n}/${i}${e.Name}.${e.Type}`).then((e=>{if(e.ok)return e.blob();throw new Error(`CDN download response status: ${e.status}`)})).then((t=>[`${e.Name}.${e.Type}`,t]))))))})).then((n=>{const i=new Map(n);return o?this.putModel(e,i,t,new Map,s):i}))}getModelOptions(e){return this.accessDB().then((t=>{const s=[],o=t.transaction(this.osName,"readonly");return o.objectStore(this.osName).openCursor().then((function t(n){if(n){const o=n.value;return o.modelId==e&&s.push(o),n.continue().then(t)}return o.done})).then((()=>s))}))}putModel(e,t,s,o,n,i){return o||(o=new Map),this.accessDB().then((n=>n.put(this.osName,{modelId:e,model:t,version:s,filters:o,timesSinceUsage:0},i))).catch((e=>{n.resultDescription.indexOf(e.message)>=0&&(n.success=!1,n.resultDescription+=`${e.message} `),n.resultSignature="Issue adding to DB"})).then((()=>t))}}},905098:(e,t,s)=>{s.d(t,{g:()=>n});var o=s(596498);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_SubstrateEventsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},923805:(e,t,s)=>{s.d(t,{f8:()=>i});var o=s(596498);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_AcsTextToSpeech_ACSTextToSpeechSynthesizeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_AcsTextToSpeech_ReadAloudSpeechSynthesizeFinalAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_AcsTextToSpeech_ACSTextToSpeechGetVoicesAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_AcsTextToSpeech_ACSTextToSpeechGetVoicesRAAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},928981:(e,t,s)=>{s.d(t,{l:()=>n});var o=s(596498);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_ExcelRunScript_ExcelRunScriptAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},930759:(e,t,s)=>{s.d(t,{h:()=>n});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_DynamicQuestionGenerator_DynamicQuestionGeneratorSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},934142:(e,t,s)=>{s.d(t,{l:()=>o});class o{constructor(e){if(this.cache=new Map,this.options=e||{sweepInterval:100},null!=this.options.idleDurationMs&&this.options.idleDurationMs<=0)throw new Error("Idle duration must be positive");if(this.interval=this.options.sweepInterval||100,this.interval<=0)throw new Error("Sweep interval must be a positive number")}static setLogIntervalError(e){o.logIntervalError=e}put(e,t,s,o,n,i,a){if(null==s||s<=0)throw new Error("Cache timeout must be a positive number");(null==n||n<=0)&&(n=this.options.idleDurationMs);const r={value:t,lastUsed:n?Date.now():void 0,expire:s+Date.now(),idleDurationMs:n,expireCallback:o,expiringTriggerTime:i+Date.now(),expiringCallback:a};return this.cache.set(e,r),this.timeout||(this.timeout=setInterval(this.onInterval.bind(this),this.interval),this.timeout.unref&&this.timeout.unref()),t}del(e){if(this.options.delCallback){const t=this.cache.get(e);t&&this.options.delCallback(e,t.value)}const t=this.cache.delete(e);return 0===this.size()&&this.clear(),t}clear(){this.timeout&&(clearInterval(this.timeout),this.timeout=void 0),this.cache.clear()}get(e){let t=this.cache.get(e);if(t){if(this.options.idleDurationMs&&(t.lastUsed=Date.now()),t.expire<Date.now()&&(this.del(e),t.expireCallback&&t.expireCallback(e,t.value),t=this.cache.get(e),!t))return;return t.value}}keys(){return this.cache.keys()}forEach(e){this.cache.forEach(((t,s)=>{e(t.value,s)}))}size(){return this.cache.size}updateExpireTime(e,t){return!!(this.cache.has(e)&&t>=0)&&(this.cache.get(e).expire=t+Date.now(),!0)}onInterval(){const e=Date.now();this.cache.forEach(((t,s)=>{try{if(t.idleDurationMs&&t.lastUsed<e-t.idleDurationMs)return this.del(s),void(this.options.idleCallback&&this.options.idleCallback(s,t.value));t.expire<e&&(this.del(s),t.expireCallback&&t.expireCallback(s,t.value)),t.expiringTriggerTime<e&&t.expiringCallback&&(t.expiringCallback(s,t.value),t.expiringCallback=void 0)}catch(e){o.logIntervalError&&o.logIntervalError(e)}}))}}},937410:(e,t,s)=>{s.d(t,{I:()=>c});var o=s(524243),n=s(672103);const i=Symbol("dataFieldsObject"),a=Symbol("dataFieldsAreDirty"),r=Symbol("_dataFields");class c extends o.A{constructor(e,t){super(e),this.eventName="Operation",this.options=t,this.durationMs=null==e?void 0:e.durationMs,e&&null!=e.count||(this.count=1),(null==e?void 0:e.dataFields)&&(this.dataFields=e.dataFields)}setClientMetadata(e,t){return e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,null!=t&&t||(this.clientFlights=e.flights),this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientReleaseChannel=e.releaseChannel,this.clientReleaseFork=e.releaseFork,this.clientRuntimeVersion=e.runtimeVersion,this.clientSessionId=e.sessionId,this.clientDocSessionId=e.docSessionId,this.clientUserAgent=e.userAgent),this}setUserContext(e){return e&&(this.userId=e.puid||e.oid,this.userType=e.userType&&e.userType.toString(),this.userTenantId=e.tid),this}setMetricCustomDimensions(e,t){if(!this.options)throw new Error(`Attempting to set custom dimensions ${e} to operation ${this.operationName} without activating MetricCount or MetricDuration`);this.options.metricCustomDimensions=this.options.metricCustomDimensions||{},this.options.metricCustomDimensions[e]=t}setDataField(e,t){this[i]||(this[i]={}),this[i][e]=t,this[a]=!0}setDataFields(e){this[i]||(this[i]={}),this[i]=Object.assign(Object.assign({},this[i]),e),this[a]=!0}start(){return this.startTime=(0,n.t)(),this}recordStep(e){return this.setDataField(e,Math.floor((0,n.t)()-this.startTime)),this}stop(){const e=(0,n.t)();return this.durationMs=Math.round(e-this.startTime),this}addCustomMetric(e){void 0===this.customMetrics&&(this.customMetrics=[]),this.customMetrics.push(e)}getCustomMetrics(){const e=[];if(void 0!==this.customMetrics){const t=e=>[...this.getDimensionNames(),...e.extraDimensions.map((e=>e.name))];for(const s of this.customMetrics){const o={};o[`${this.operationName}.${s.nameSuffix}`]={dimensionNames:()=>t(s),dimensionValues:[...this.getDimensionValues(),...s.extraDimensions.map((e=>e.value))],value:s.value},e.push(o)}}return e}getMetrics(e){var t,s;const o={};if(this.operationName)switch(this.operationName){case"SessionHealthOrphanedEventsWithoutProperSessionKey":case"SessionHealthOrphanedSessions":case"WorkflowActivationState":o[this.operationName+".CountV2"]={dimensionNames:c.getOrphanedSessionHealthDimensionNames.bind(c),dimensionValues:this.getOrphanedSessionHealthDimensionValues(),value:this.count};break;case"MarkUnhealthySession":case"MarkHealthWarningSession":o[this.operationName+".Reason"]={dimensionNames:c.getSessionHealthDimensionNames.bind(c),dimensionValues:this.getSessionHealthDimensionValues(),value:1};break;default:if("matchmaker_timer"===this.operationName&&(o["Workflow.DurationMs"]={dimensionNames:c.getWorkflowDimensionNames.bind(c),dimensionValues:this.getWorkflowDimensionValues(),value:this.durationMs||0},o["Workflow.Count"]={dimensionNames:c.getWorkflowDimensionNames.bind(c),dimensionValues:this.getWorkflowDimensionValues(),value:1}),void 0!==this.durationMs){const s=`${this.operationName}.DurationMsV2`;((null===(t=this.options)||void 0===t?void 0:t.metricDuration)||e.indexOf(s)>=0)&&(o[s]={dimensionNames:this.getDimensionNames.bind(this),dimensionValues:this.getDimensionValues(),value:this.durationMs})}{const t=`${this.operationName}.CountV2`;((null===(s=this.options)||void 0===s?void 0:s.metricCount)||e.indexOf(t)>=0)&&(o[t]={dimensionNames:this.getDimensionNames.bind(this),dimensionValues:this.getDimensionValues(),value:this.count})}}return o}getDimensionNames(){var e,t;let s=c.dimensionNames;if(null===(e=this.options)||void 0===e?void 0:e.metricCustomDimensions){s=s.slice();for(const e in null===(t=this.options)||void 0===t?void 0:t.metricCustomDimensions)s.push(e)}return s}getDimensionValues(){var e,t;const s=[this.success,this.clientAppName,this.clientAppPlatform,this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3];if(null===(e=this.options)||void 0===e?void 0:e.metricCustomDimensions)for(const e in null===(t=this.options)||void 0===t?void 0:t.metricCustomDimensions)s.push(this.options.metricCustomDimensions[e]);return s}static getOrphanedSessionHealthDimensionNames(){return this.orphanedSessionHealthDimensionNames}getOrphanedSessionHealthDimensionValues(){return[this.success,this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}static getSessionHealthDimensionNames(){return this.sessionHealthDimensionNames}getSessionHealthDimensionValues(){return[this.resultSignature,this.clientAppName,this.clientAppPlatform,this.clientAppVersion,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}static getWorkflowDimensionNames(){return this.workflowDimensionNames}getWorkflowDimensionValues(){return[this.resultSignature,this.resourceId,this.resourceId,this.success]}}c.dimensionNames=["Success","ClientAppName","ClientAppPlatform","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"],c.orphanedSessionHealthDimensionNames=["Success","ClientAppName","ClientAppPlatform","ClientReleaseAudienceGroup","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"],c.sessionHealthDimensionNames=["Reason","ClientAppName","ClientAppPlatform","ClientAppVersion","Dimension0","Dimension1","Dimension2","Dimension3"],c.workflowDimensionNames=["ResultSignature","WorkflowId","ResourceId","Success"],Object.defineProperty(c.prototype,"dataFields",{get:function(){var e,t;return this[a]&&(this[r]=JSON.stringify(null!==(e=this[i])&&void 0!==e?e:{}),this[a]=!1),void 0!==this[a]?this[r]:null!==(t=this[r])&&void 0!==t?t:""},set:function(e){this[i]=e&&""!==e?JSON.parse(e):{},this[r]=e,this[a]=!1},enumerable:!0,configurable:!0})},946233:(e,t,s)=>{s.d(t,{Y:()=>c});var o,n=s(599243),i=s(937410),a=s(782593),r=s(70239);!function(e){e[e.ExceedingMaxSize=0]="ExceedingMaxSize",e[e.GroupComplete=1]="GroupComplete",e[e.BatchIntervalElapsed=2]="BatchIntervalElapsed"}(o||(o={}));class c{constructor(e,t,s,o,n){this.batchesByGroupingKey=new Map,this.getOrderOfMagnitudeDimension=e=>e<0?"Negative":0===e?"0":1===e?"1":`Magnitude ${e.toString().length}`,this.submit=e,this.onSummary=o,this.reduceBatchOperationsEnabled=t,this.batchMessagesEnabled=s,this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled=n}addBatchItem(e,t,s,i,a,r){const{delayMs:c,delayMsMax:l,maxInputSize:u,estimateSize:p,groupingKeyExtractor:g}=t,h=p(e),d=g(e);if(t.split&&h>u){let o;try{o=t.split(e)}catch(e){const t=new Error("Split error: "+e.message);return void(r?r(t):n.tG.error(573366352,n.nh.CoreDefault,t))}if(o&&Array.isArray(o.inputs)&&o.inputs.length>1){let e;const n=[],c=r?(t,s)=>{if(e=e||t,n.push(s),n.length===o.inputs.length){let s;try{s=o.join(n)}catch(t){return void r(new Error("Join error: "+t.message))}r(e,s)}}:void 0;for(let e=0;e<o.inputs.length;e++){const n=o.inputs[e];this.addBatchItem(n,t,s,i,a&&e===o.inputs.length-1,c)}return}}let m=this.batchesByGroupingKey.get(d);if(m&&m.size+h>u&&(this.executeBatch(d,m,t,o.ExceedingMaxSize),m=void 0),m||(m={items:[],size:0,hasItemsWithCallbacks:!1,context:s,creationTime:Date.now()},this.batchesByGroupingKey.set(d,m)),this.batchMessagesEnabled){const t=m.items[m.items.length-1];t&&t.cv===i&&t.callback===r?(t.input=[...t.input,...e],t.size+=h):m.items.push({input:e,size:h,cv:i,callback:r,creationTime:Date.now()})}else m.items.push({input:e,size:h,callback:r,creationTime:Date.now()});m.size+=h,m.hasItemsWithCallbacks=m.hasItemsWithCallbacks||!!r,this.batchMessagesEnabled||(m.cv=i),m.groupComplete=a,m.groupComplete?this.executeBatch(d,m,t,o.GroupComplete):(Date.now()-m.creationTime+c<l&&(clearTimeout(m.timeout),m.timeout=void 0),m.timeout||(m.timeout=setTimeout((()=>{this.executeBatch(d,m,t,o.BatchIntervalElapsed)}),c)))}removeAllBatchedItems(){this.batchesByGroupingKey.forEach((e=>{e.timeout&&clearTimeout(e.timeout)})),this.batchesByGroupingKey.clear()}close(){for(const[e,t]of this.batchesByGroupingKey){const s=1e3;void 0!==t.creationTime&&void 0!==t.timeout&&void 0!==t.timeoutDuration&&Date.now()-t.creationTime>t.timeoutDuration+s&&n.tG.info(504690067,n.nh.CoreDefault,{operationName:"BatchStillPendingAfterTimeout",resourceId:t.context.name,resultDescription:`Batch with groupingKey "${e}" still pending after timeout. Items: ${t.items.length}, Size: ${t.size}`,dimension0:t.items.length>0?`LastItemAge: ${Date.now()-t.items[t.items.length-1].creationTime}ms`:"No items in batch"})}}reduceBatchOperations(e){const t=new i.I({operationName:"ReduceBatchOperations"}).start();let s=0,o=0,a=0;const c=new Set,l=[],u=(e,t)=>e.parentPath.toString()+"/"+e.parentRevId+"/"+t.id;for(const t of e.input.reverse()){const e=[];for(const n of t.input.reverse())if(r.fZ.typeGuard(n)){const t=[];for(const e of n.items){a++;const i=u(n,e);c.has(i)?o++:(t.push(e),c.add(i),s++)}0!==t.length&&(n.items=t,e.push(n))}else if(r.Xr.typeGuard(n)){for(const e of n.items){const t=u(n,e);c.delete(t)}e.push(n)}else e.push(n);0!==e.length&&l.push({input:e.reverse(),size:t.size,cv:t.cv,callback:t.callback,creationTime:t.creationTime})}e.input=l.reverse(),0!=a&&(t.dimension0=`${this.getOrderOfMagnitudeDimension(o)}`,t.dimension1=`noOp: ${0===o}`),t.success=a-o==s,n.tG.info(507839488,n.nh.CoreDefault,t.stop())}maxNumberOfDeltaUpdateOpsPerItemPerBatch(e){const t=(e,t)=>e.parentPath.toString()+"/"+t.id;let s=0;const o=new Map;for(const n of e.input)if(r.xU.typeGuard(n))for(const e of n.items){const i=t(n,e);o.has(i)||o.set(i,0),o.set(i,o.get(i)+1),s=Math.max(s,o.get(i))}return s}executeBatch(e,t,s,o){clearTimeout(t.timeout),t.timeout=void 0,this.batchesByGroupingKey.delete(e);const r=t.items,c=new i.I({operationName:"ExecuteBatch",cv:this.batchMessagesEnabled?"":t.cv,resourceId:t.context.name,resultDescription:`batching duration: ${Date.now()-t.creationTime}ms`,dimension0:`${this.batchMessagesEnabled?"Batched items count":"Batched ops count:"} ${this.getOrderOfMagnitudeDimension(r.length)}`,dimension1:`Size ${this.getOrderOfMagnitudeDimension(t.size)}`,dimension2:o.toString()}).start(),l=(e,s,o)=>{let i;if(s&&s.exceptionType===a.K.NoOutput)c.success=!0,n.tG.info(573366353,n.nh.CoreDefault,c.stop());else{const o=`${e} error: ${s?s.message||s:"Unknown error"}`;i=s||new Error(o),c.success=!1,c.resultDescription=`Batch of ${r.length} items of size ${t.size} with ${o}`,c.resultSignature=`${e} Error`,n.tG.error(573366354,n.nh.CoreDefault,c.stop())}if(t.hasItemsWithCallbacks)for(const e of r)e.callback&&e.callback(i,o)};let u;try{u=s.multiplex(this.batchMessagesEnabled?r:r.map((e=>e.input)))}catch(e){return void l("Multiplex",e)}this.reduceBatchOperationsEnabled&&this.batchMessagesEnabled&&"operations"==e&&this.reduceBatchOperations(u),!this.batchMessagesEnabled&&"operations"==e&&this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled&&(c.dimension3=this.getOrderOfMagnitudeDimension(this.maxNumberOfDeltaUpdateOpsPerItemPerBatch(u))),this.submit(u.input,t,((e,o)=>{if(e||o&&("exceptionType"in o||o instanceof Error))l("Submit",e||o,o);else if(t.hasItemsWithCallbacks||s.summaryExtractor){let i,a,p;if(t.hasItemsWithCallbacks)try{if(i=u.demultiplex(o),i.length!==r.length)throw new Error("Mismatched output length")}catch(e){return void l("Demultiplex",e)}if(s.summaryExtractor)try{[p,a]=s.summaryExtractor(o)}catch(e){return void l("SummaryExtractor",e)}if(c.success=!0,n.tG.info(573366342,n.nh.CoreDefault,c.stop()),t.hasItemsWithCallbacks)for(let e=0;e<r.length;e++)r[e].callback&&r[e].callback(void 0,i[e]);a&&this.onSummary(p,a,t.context)}else c.success=!0,n.tG.info(573366343,n.nh.CoreDefault,c.stop())}))}}},950210:(e,t,s)=>{var o;s.d(t,{G:()=>o}),function(e){e.Success="Success",e.Failed="Failed"}(o||(o={}))},951260:(e,t,s)=>{s.d(t,{A:()=>h});var o=s(825688),n=s(68580),i=s(309708),a=s(599243),r=s(357635),c=s(174025),l=s(414190),u=s(507628),p=s(383129);class g{constructor(){this.seqCounter=0,this.lastInput="",this.lastConversationId="",this.lastLogicalId=""}async init(e){}initialize(e){var t,s;!0!==this.initialized&&(this.enableUserInitiatedRequests=null===(t=null==e?void 0:e.flights)||void 0===t?void 0:t.hasFlight("mc-editor-oa-client-ecc"),this.enableSystemInitiatedRequest=null===(s=null==e?void 0:e.flights)||void 0===s?void 0:s.hasFlight("mc-editor-oa-client-predictions"),this.initialized=!0)}async execute(e,t,s){this.executeInner(e,t,s),s.done()}executeInner(e,t,s){var o;if(a.tG.info(526713100,a.nh.WorkflowDefault,"Executing oa-client router workflow"),e&&e.content&&t&&s){if(this.initialize(t),c.Cg.typeGuard(e)||c.qf.typeGuard(e))if(null===(o=null==t?void 0:t.flights)||void 0===o?void 0:o.hasFlight("mc-editor-oa-client-router-refactor"))this.processTextTileInput(e.content,e,s,t);else{if(this.tryGenerateUserInitiatedRequest(e.content,e,s,t))return;this.tryGenerateSystemInitiatedRequest(e.content,e,s,t)}}else a.tG.warn(526713101,a.nh.WorkflowDefault,"unexpected inputs, ignoring request")}dispose(){this.seqCounter=0}processTextTileInput(e,t,s,i){var r,c,l,g,h,d,m;const y=(new Date).toISOString(),T=(0,p.K)("Router_UserInitiated",i).start(),f=i.delta,_=null!==(c=null===(r=null==f?void 0:f.additionalData)||void 0===r?void 0:r.conversationId)&&void 0!==c?c:"",C=null!==(g=null===(l=null==f?void 0:f.additionalData)||void 0===l?void 0:l.logicalId)&&void 0!==g?g:"",S=this.getValidUserInitQuery(t,i,T);if(S){const o=null!==(d=null===(h=null==f?void 0:f.additionalData)||void 0===h?void 0:h.scopeInfo)&&void 0!==d?d:void 0,n=void 0===o&&this.sameAsLastUserInitRequest(e,f),i=null!==(m=null==o?void 0:o.entityType)&&void 0!==m?m:"";return T.setDataFields({hasScope:void 0!==o,entityType:i,repeatedReuquest:n}),this.generateUserInitiatedRequest(e,t,s,S,C,_,o,T),void this.finalizeLogging(T,y,C,_)}if(this.enableUserInitiatedRequests){const e=new o.os({conversationId:null!=_?_:"",entityResults:[],logicalId:null!=C?C:"",status:n.i.EarlyExit});s.setAnnotations(t,o.os.getTypeName(),[e]),T.setDataFields({resultDescription:"Invalid or undefined query info provided, setting client empty annotation"}),this.finalizeLogging(T,y,C,_)}else T.setDataFields({statusDescription:"Request to send empty annotation skipped because required flight is missing"}),this.finalizeLogging(T,y,C,_);const A=(new Date).toISOString(),v=(0,p.K)("Router_SystemInitiated",i).start(),N=(0,u.A)();this.isValidSystemInitQuery(t,i,v)?this.generateSystemInitiatedRequest(e,t,s,N,v):this.enableSystemInitiatedRequest?v.setDataFields({resultDescription:"Invalid query sent, skipped sending client empty annotation"}):v.setDataFields({statusDescription:"Request to send empty annotation skipped because required flight is missing"}),a.tG.info(508408097,a.nh.WorkflowDefault,`sending SystemInitiatedRequestClient (${this.seqCounter})`),this.finalizeLogging(v,A,N)}finalizeLogging(e,t,s,o){const n=(new Date).toISOString();o&&e.setDataFields({conversationId:o}),e.setDataFields({startTimeStamp:t,endTimeStamp:n,logicalId:s}),a.tG.info(508356445,a.nh.WorkflowDefault,e.stop())}generateUserInitiatedRequest(e,t,s,o,n,a,r,c){if(!this.enableUserInitiatedRequests)return void c.setDataFields({statusDescription:"Request skipped because required flight is missing"});const l=new i.VP({content:this.sanitizeText(e),logicalId:n,conversationId:a,seq:++this.seqCounter,scope:r,...o});s.setAnnotations(t,i.VP.getTypeName(),[l]),c.setDataFields({statusDescription:"User-Initiated request generated"})}generateSystemInitiatedRequest(e,t,s,o,n){if(!this.enableSystemInitiatedRequest)return void n.setDataFields({statusDescription:"Request skipped because required flight is missing"});const a=new i.JM({content:this.sanitizeText(e),logicalId:o,seq:++this.seqCounter});s.setAnnotations(t,i.JM.getTypeName(),[a]),n.setDataFields({statusDescription:"System-Initiated request generated"})}tryGenerateUserInitiatedRequest(e,t,s,r){var c,l,u,g,h,d,m,y;let T=!1;const f=(new Date).toISOString(),_=(0,p.K)("Router_UserInitiated",r).start(),C=r.delta,S=null!==(l=null===(c=null==C?void 0:C.additionalData)||void 0===c?void 0:c.conversationId)&&void 0!==l?l:"",A=null!==(g=null===(u=null==C?void 0:C.additionalData)||void 0===u?void 0:u.logicalId)&&void 0!==g?g:"";if(null===(h=null==r?void 0:r.flights)||void 0===h?void 0:h.hasFlight("mc-editor-oa-client-ecc")){const a=this.getValidUserInitQuery(t,r,_);if(a){const o=null!==(m=null===(d=null==C?void 0:C.additionalData)||void 0===d?void 0:d.scopeInfo)&&void 0!==m?m:void 0,n=void 0===o&&this.sameAsLastUserInitRequest(e,C),r=null!==(y=null==o?void 0:o.entityType)&&void 0!==y?y:"";_.setDataFields({hasScope:void 0!==o,entityType:r,repeatedReuquest:n});const c=new i.VP({content:this.sanitizeText(e),logicalId:A,conversationId:S,seq:++this.seqCounter,scope:o,...a});s.setAnnotations(t,i.VP.getTypeName(),[c]),_.setDataFields({statusDescription:"User-Initiated request generated"}),T=!0}else{const e=new o.os({conversationId:null!=S?S:"",entityResults:[],logicalId:null!=A?A:"",status:n.i.EarlyExit});s.setAnnotations(t,o.os.getTypeName(),[e]),_.setDataFields({resultDescription:"Invalid or undefined query info provided, setting client empty annotation"})}}else _.setDataFields({statusDescription:"Request skipped because required flight is missing"});const v=(new Date).toISOString();return _.setDataFields({startTimeStamp:f,endTimeStamp:v,conversationId:S,logicalId:A}),a.tG.info(508409808,a.nh.WorkflowDefault,_.stop()),T}tryGenerateSystemInitiatedRequest(e,t,s,o){var n;const r=(new Date).toISOString(),c=(0,p.K)("Router_SystemInitiated",o).start(),l=(0,u.A)();if(null===(n=null==o?void 0:o.flights)||void 0===n?void 0:n.hasFlight("mc-editor-oa-client-predictions")){if(this.isValidSystemInitQuery(t,o,c)){const o=new i.JM({content:this.sanitizeText(e),logicalId:l,seq:++this.seqCounter});s.setAnnotations(t,i.JM.getTypeName(),[o]),c.setDataFields({statusDescription:"System-Initiated request generated"})}else c.setDataFields({resultDescription:"Invalid query sent, skipped sending client empty annotation"});a.tG.info(508409807,a.nh.WorkflowDefault,`sending SystemInitiatedRequestClient(${this.seqCounter})`)}else c.setDataFields({statusDescription:"Request skipped because required flight is missing"});const g=(new Date).toISOString();c.setDataFields({startTimeStamp:r,endTimeStamp:g,logicalId:l}),a.tG.info(508409806,a.nh.WorkflowDefault,c.stop())}sanitizeText(e,t){if("number"!=typeof(null==e?void 0:e.length))return"";"\n"===e[e.length-1]&&(e=e.substring(0,e.length-1));const s=e.replace(/\s/g," ");return t?s.trim():s}sameAsLastUserInitRequest(e,t){var s,o,n,i;const a=null!==(o=null===(s=null==t?void 0:t.additionalData)||void 0===s?void 0:s.conversationId)&&void 0!==o?o:"",r=null!==(i=null===(n=null==t?void 0:t.additionalData)||void 0===n?void 0:n.logicalId)&&void 0!==i?i:"";let c=!1;return e===this.lastInput&&a===this.lastConversationId&&r===this.lastLogicalId&&(c=!0),this.lastInput=e,this.lastConversationId=a,this.lastLogicalId=r,c}getValidUserInitQuery(e,t,s){var o,n;if(!c.Cg.typeGuard(e))return void s.setDataFields({statusDescription:"Invalid input type"});const i=e;if((null===(o=t.delta)||void 0===o?void 0:o.unit)!==l.OD.Chars&&this.sanitizeText(i.content,!0).length<1)return void s.setDataFields({statusDescription:"Ignore empty tile"});const a=t.delta;if(a&&(a.unit!==l.OD.Sentence||a.queryRange&&a.content)){const t=e.content;let o;const i=a.queryRange;if(i){const{length:e,start:s}=i,a=null!==(n=i.prefix)&&void 0!==n?n:g.userInitiatedIntentChar;o={query:this.sanitizeText(t.substring(s+a.length,s+e)),queryChar:a,queryCharIndex:s}}else s.setDataFields({statusDescription:"Invalid or non-existent queryRange provided."});if(o){const e={start:o.queryCharIndex,end:o.queryCharIndex+o.query.length+1};return(a.position>=e.start||a.position+a.content.length>=e.start)&&a.position<=e.end?(s.setDataFields({seqCounter:this.seqCounter,querylength:i.length}),o):void s.setDataFields({statusDescription:"Delta outside of query bounds"})}s.setDataFields({statusDescription:"Invalid query to generate user init request."})}else s.setDataFields({statusDescription:"Delta is undefined. Cannot proceed with query detection logic."})}isValidSystemInitQuery(e,t,s){var o;if(!c.Cg.typeGuard(e))return s.setDataFields({statusDescription:"Invalid input type, ignore"}),!1;const n=e.content,i=this.sanitizeText(n,!0),a=t.delta;if(!a)return s.setDataFields({statusDescription:"Delta is undefined."}),!1;{if(a.unit===l.OD.Sentence||a.unit===l.OD.Paragraph)return!1;if(a.unit!==l.OD.Chars&&i.length<1)return s.setDataFields({statusDescription:"Empty tile, ignore"}),!1;const e=n.endsWith("\n")?n.substring(0,n.length-1):n;if((null===(o=null==t?void 0:t.flights)||void 0===o?void 0:o.hasFlight("mc-editor-oa-client-router-refactor"))&&a.position>=e.length-1)return!0;if(a.position>=e.length-1&&g.triggerCharacters.has(i[i.length-1]))return s.setDataFields({statusDescription:"Router should not generate system initiated requests for ECC requests"}),!1}return!0}}g.userInitiatedIntentChar="@",g.triggerCharacters=new Set(["@","/"]);const h=r.z.create("oaClientRouter").setInputTypes([c.qf.getTypeName()]).setOutputTypes([o.os.getTypeName(),i.JM.getTypeName(),i.VP.getTypeName()]).setLambdaType((()=>new g))},951323:(e,t,s)=>{s.d(t,{T:()=>n});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_CopilotChatHistorySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_Operation"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_GetCurrentChatOperation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_GetAllChatsOperation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_GetMessagesOperation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_GetMessagesInCurrentChatSession"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_RemoveAllMessagesFromCurrectChatOperation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_GetChatOperation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){o.h.assign(g,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_AddChatOperation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){o.h.assign(h,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_AddMessageOperation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{constructor(e){o.h.assign(d,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_DeleteChatOperation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{constructor(e){o.h.assign(m,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_UpdateMessageOperation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{constructor(e){o.h.assign(y,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_UpdateChatOperation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()}},951713:(e,t,s)=>{var o,n;s.d(t,{p:()=>n,y:()=>o}),function(e){e.GET="GET",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(o||(o={})),function(e){e.Suggestion="Suggestion",e.UserActivity="UserActivity",e.UserPrompts="UserPrompts",e.Link="Link",e.Publish="Publish"}(n||(n={}))},959943:(e,t,s)=>{s.d(t,{t:()=>n});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_UserStore_UserProfileSignal"}static getBaseTypes(){return["AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},965465:(e,t,s)=>{var o,n,i,a,r,c,l,u;s.d(t,{Hu:()=>c,QE:()=>o,ss:()=>n,yl:()=>l}),function(e){e.None="None",e.MessageExtension="MessageExtension",e.PowerPlatform="PowerPlatform",e.DataVerse="DataVerse",e.OpenAIPlugin="OpenAIPlugin"}(o||(o={})),function(e){e[e.PowerPoint=0]="PowerPoint",e[e.Excel=1]="Excel",e[e.Word=2]="Word",e[e.OneNote=3]="OneNote",e[e.Outlook=4]="Outlook",e[e.Teams=5]="Teams",e[e.Event=6]="Event",e[e.Meeting=7]="Meeting",e[e.TeamsMeeting=8]="TeamsMeeting",e[e.SharePoint=9]="SharePoint",e[e.Web=10]="Web",e[e.PDF=11]="PDF",e[e.Zip=12]="Zip",e[e.HTML=13]="HTML",e[e.Visio=14]="Visio",e[e.Image=15]="Image",e[e.Fluid=16]="Fluid",e[e.Video=17]="Video",e[e.Vector=18]="Vector",e[e.Txt=19]="Txt",e[e.ThirdParty=20]="ThirdParty",e[e.Loop=21]="Loop",e[e.Planner=22]="Planner"}(n||(n={})),function(e){e[e.Read=0]="Read",e[e.ReadMetadata=1]="ReadMetadata",e[e.Create=2]="Create"}(i||(i={})),function(e){e.Word="Word",e.PowerPoint="PowerPoint",e.OneNote="OneNote",e.Excel="Excel",e.Outlook="Outlook",e.Web="Web",e.Pdf="Pdf",e.Planner="Planner",e.Loop="Loop"}(a||(a={})),function(e){e.BodyText="BodyText",e.Title="Title",e.SubTitle="SubTitle",e.Heading="Heading",e.Table="Table",e.ImageAltText="ImageAltText",e.SmartArtText="SmartArtText",e.Comment="Comment",e.VisualDescription="VisualDescription",e.SlideText="SlideText",e.InkHandwriting="Ink Handwriting"}(r||(r={})),function(e){e[e.Personalization_Indicator=1]="Personalization_Indicator"}(c||(c={})),function(e){e[e.Confirm_Set_Personalization_Profile=1]="Confirm_Set_Personalization_Profile",e[e.Confirm_Delete_Personalization_Profile=2]="Confirm_Delete_Personalization_Profile",e[e.Visual_Summary=3]="Visual_Summary",e[e.PPT_Summary=4]="PPT_Summary",e[e.PPT_Speaker_Notes=5]="PPT_Speaker_Notes"}(l||(l={})),function(e){e.Text="Text",e.Section="Section"}(u||(u={}))},965787:(e,t,s)=>{var o=s(72715);Object.defineProperty(t,"__esModule",{value:!0}),t.nowMicroSeconds=t.now=void 0;t.now=void 0!==o&&o.hrtime?()=>{const e=o.hrtime();return 1e3*e[0]+e[1]/1e6}:"undefined"!=typeof performance&&performance.now?()=>performance.now():()=>Date.now(),t.nowMicroSeconds=void 0!==o&&o.hrtime?()=>{const e=o.hrtime();return 1e6*e[0]+e[1]/1e3}:"undefined"!=typeof performance&&performance.now?()=>Math.round(1e3*performance.now()):()=>1e3*Date.now()},971135:(e,t,s)=>{var o;s.d(t,{i:()=>o}),function(e){e.choose_topic="choose_topic",e.choose_input_files="choose_input_files",e.generate_draft="generate_draft",e.review_draft="generate_review",e.define_objective="define_objective",e.choose_audience="choose_audience",e.publish_draft="publish_draft",e.generate_outline="generate_outline",e.generate_ppt="generate_ppt",e.generate_semantic_tree="generate_semantic_tree",e.generate_artifacts="generate_artifacts",e.summarize_semantic_tree="summarize_semantic_tree",e.generate_markdown="generate_markdown",e.multi_file_summary="multi_file_summary",e.multi_file_qna="multi_file_qna",e.multi_file_preview="multi_file_preview",e.sydney_query="sydney_query"}(o||(o={}))},972091:(e,t,s)=>{s.d(t,{J_:()=>r,NG:()=>u,VL:()=>a,nm:()=>c,rQ:()=>i,t9:()=>l,xz:()=>n});var o=s(596498);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_GraphSearch_ClientPrefetchCompletedAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_GraphSearch_StorageDeleteCompletedAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_GraphSearch_SearchSuggestionsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_GraphSearch_SearchSuggestionsAnnotationHybrid"}static getBaseTypes(){return["AugLoop_GraphSearch_SearchSuggestionsAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_GraphSearch_PredictionAnnotationHybrid"}static getBaseTypes(){return["AugLoop_ObservationalAssistance_PredictionAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_GraphSearch_NudgeAnnotationHybrid"}static getBaseTypes(){return["AugLoop_ObservationalAssistance_NudgeAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_GraphSearch_EccAnnotationHybrid"}static getBaseTypes(){return["AugLoop_ObservationalAssistance_EccAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_GraphSearch_UserInitiatedAnnotationHybrid"}static getBaseTypes(){return["AugLoop_ObservationalAssistance_UserInitiatedAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()}},973231:(e,t,s)=>{var o,n,i,a;s.d(t,{bx:()=>o,lb:()=>n,xv:()=>i}),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low",e[e.Informational=3]="Informational"}(o||(o={})),function(e){e[e.NotificationOnly=0]="NotificationOnly",e[e.Delete=1]="Delete",e[e.Ignore=2]="Ignore",e[e.IgnoreAll=4]="IgnoreAll",e[e.IgnoreCritiqueType=8]="IgnoreCritiqueType",e[e.AddToDictionary=16]="AddToDictionary",e[e.ShowDetails=32]="ShowDetails"}(n||(n={})),function(e){e[e.None=0]="None",e[e.ChangeOnce=1]="ChangeOnce",e[e.ChangeAll=2]="ChangeAll",e[e.AutoCorrect=4]="AutoCorrect",e[e.ReadAloud=8]="ReadAloud",e[e.PersonalizedAutoCorrect=16]="PersonalizedAutoCorrect"}(i||(i={})),function(e){e[e.None=0]="None",e[e.CAT_Spelling=1]="CAT_Spelling",e[e.CAT_Grammar=2]="CAT_Grammar",e[e.CAT_Clarity=3]="CAT_Clarity",e[e.CAT_Conciseness=4]="CAT_Conciseness",e[e.CAT_Formality=5]="CAT_Formality",e[e.CAT_Inclusiveness=6]="CAT_Inclusiveness",e[e.CAT_PunctuationConventions=7]="CAT_PunctuationConventions",e[e.CAT_Resume=8]="CAT_Resume",e[e.CAT_SensitiveGeopoliticalReferences=9]="CAT_SensitiveGeopoliticalReferences",e[e.CAT_Vocabulary=10]="CAT_Vocabulary",e[e.CAT_ConsistentWrittenForms=11]="CAT_ConsistentWrittenForms",e[e.CAT_ErrorCorrections=12]="CAT_ErrorCorrections",e[e.CAT_WritingConventions=13]="CAT_WritingConventions",e[e.CAT_Acronyms=14]="CAT_Acronyms",e[e.CAT_Perspectives=15]="CAT_Perspectives",e[e.CAT_UncommonWords=16]="CAT_UncommonWords",e[e.CAT_TypingErrors=17]="CAT_TypingErrors",e[e.CAT_Rewrite=18]="CAT_Rewrite"}(a||(a={}))},973330:(e,t,s)=>{s.d(t,{A:()=>n});var o={util:{},roots:{default:{}}},n=(o.util,o.roots.default||(o.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientAppVersion="",e.prototype.clientRuntimeVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientUserAgent="",e.prototype.resourceId="",e.prototype.healthBucket="",e.prototype.healthReason="",e.prototype.healthReasonCategory="",e.prototype.healthBucketWithSuppressions="",e.prototype.healthReasonWithSuppressions="",e.prototype.healthReasonCategoryWithSuppressions="",e.prototype.scenarioHealthBucket="",e.prototype.scenarioHealthReason="",e.prototype.scenarioHealthBucketWithSuppressions="",e.prototype.scenarioHealthReasonWithSuppressions="",e.prototype.activationState="",e.prototype.modelItemsCountBucket="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.userDataBoundaryType="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/ScenarioStatsEvent"},e}())},978632:(e,t,s)=>{s.d(t,{Z:()=>n});var o={util:{},roots:{default:{}}},n=(o.util,o.roots.default||(o.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.sessionHealthEventName="",e.prototype.count=0,e.prototype.successes=0,e.prototype.failures=0,e.prototype.maxDurationMs=0,e.prototype.sumDurationMs=0,e.prototype.cancellations=0,e.prototype.failureBuckets="",e.prototype.firstFailureReason="",e.prototype.firstFailureImpact="",e.prototype.lastEventSource="",e.prototype.lastEventReason="",e.prototype.lastEventReasonDependency="",e.prototype.lastEventImpact="",e.prototype.lastEventSuccess=!1,e.prototype.lastEventDurationMs=0,e.prototype.lastEventCount=0,e.prototype.lastEventMessage="",e.prototype.lastEventAffectedWorkflows="",e.prototype.userDataBoundaryType="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SessionHealthEventAggregation"},e}())},980343:(e,t,s)=>{s.d(t,{qW:()=>n});var o=s(596498);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_AudioCastGenerator_GenerateAudioCastResponse"}static getBaseTypes(){return["AugLoop_Copilot_CopilotOutputStreamAnnotation","AugLoop_Core_StreamAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_AudioCastGenerator_PodcastModelContext"}static getBaseTypes(){return["AugLoop_ConversationalCopilot_CVContextAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_AudioCastGenerator_AudioCastSpeStorageInfo"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_AudioCastGenerator_GenerateAudioCastStatusReport"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_AudioCastGenerator_AudioCastSupportedConfiguration"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()}},986885:(e,t,s)=>{s.d(t,{Uk:()=>i,sN:()=>a});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_ExcelImportData_ExcelImportDataBaseSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_ExcelImportData_ExcelImportDataFileMetadataSignal"}static getBaseTypes(){return["AugLoop_ExcelImportData_ExcelImportDataBaseSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_ExcelImportData_ExcelImportDataSourcesRelevancySignal"}static getBaseTypes(){return["AugLoop_ExcelImportData_ExcelImportDataBaseSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_ExcelImportData_ExcelStartRelevantMetadataSignal"}static getBaseTypes(){return["AugLoop_ExcelImportData_ExcelImportDataBaseSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},988412:(e,t,s)=>{var o;s.d(t,{Ff:()=>a,P_:()=>i,XH:()=>r,n4:()=>n,oJ:()=>o}),function(e){e.Bold="Word.Editing.Bold",e.CenterJustify="Word.Editing.CenterJustify",e.CreateBulletList="Word.Editing.CreateBulletList",e.CreateNumberedList="Word.Editing.CreateNumberedList",e.Delete="Word.Editing.Delete",e.Deselect="Word.Editing.Deselect",e.Exit="Command.Exit",e.ExitList="Word.Editing.ExitList",e.FullJustify="Word.Editing.FullJustify",e.Highlight="Word.Editing.Highlight",e.SetFont="Word.Editing.SetFont",e.InsertText="Word.Editing.InsertText",e.InsertBullet="Word.Editing.InsertBullet",e.InsertComment="Word.Editing.InsertComment",e.InsertEmoji="Word.Editing.InsertEmoji",e.InsertTable="Word.Editing.Table.Insert",e.DeleteTable="Word.Editing.Table.Delete",e.NavigateTable="Word.Editing.Table.Navigate",e.Navigation="Word.Editing.Navigation",e.InsertSpace="Word.Editing.InsertSpace",e.Italics="Word.Editing.Italics",e.LeftJustify="Word.Editing.LeftJustify",e.NewLine="Word.Editing.NewLine",e.NextBullet="Word.Editing.NextBullet",e.NextLine="Word.Editing.NextLine",e.Pause="Command.Pause",e.Paste="Word.Editing.Paste",e.ReadBack="Word.Editing.ReadBack",e.Redo="Word.Editing.Redo",e.RightJustify="Word.Editing.RightJustify",e.RemoveBold="Word.Editing.RemoveBold",e.RemoveItalics="Word.Editing.RemoveItalics",e.RemoveUnderline="Word.Editing.RemoveUnderline",e.RemoveHighlight="Word.Editing.RemoveHighlight",e.RemoveSuperscript="Word.Editing.RemoveSuperscript",e.RemoveStrikeThrough="Word.Editing.RemoveStrikeThrough",e.RemoveSubscript="Word.Editing.RemoveSubscript",e.RemoveFormatting="Word.Editing.RemoveFormatting",e.Quote="Word.Editing.Quote",e.Select="Word.Editing.Select",e.Superscript="Word.Editing.Superscript",e.Subscript="Word.Editing.Subscript",e.StrikeThrough="Word.Editing.StrikeThrough",e.ShowHelp="Command.ShowHelp",e.ShowCommands="Command.ShowCommand",e.Undo="Word.Editing.Undo",e.Underline="Word.Editing.Underline",e.IncreaseIndent="Word.Editing.IncreaseIndent",e.DecreaseIndent="Word.Editing.DecreaseIndent",e.Backspace="Word.Editing.Backspace",e.VoiceCommand="Command.VoiceCommand",e.Type="Command.Type",e.ShrinkFont="Word.Editing.ShrinkFont",e.GrowFont="Word.Editing.GrowFont",e.AllCaps="Word.Editing.AllCaps",e.SentenceCase="Word.Editing.SentenceCase",e.LowerCase="Word.Editing.LowerCase",e.Tab="Word.Editing.Tab",e.ZoomOut="Word.View.ZoomOut",e.ZoomIn="Word.View.ZoomIn",e.ScrollUp="Word.View.ScrollUp",e.ScrollDown="Word.View.ScrollDown",e.ShowOutline="Word.View.ShowOutline",e.PageBreak="Word.Editing.PageBreak",e.ResumeDictation="Word.Editing.ResumeDictation",e.Correction="Word.Editing.Correction",e.Style="Word.Editing.Style",e.CorrectionOption="Word.Editing.CorrectionOption",e.SpellOut="Word.Editing.SpellOut",e.ShowSuggestions="Word.Editing.ShowSuggestions",e.Send="Outlook.Send",e.Cancel="Outlook.Cancel",e.Yes="Outlook.Yes",e.AddRecipient="Outlook.AddRecipient",e.AtMention="Outlook.AtMention",e.FieldEdit="Outlook.FieldEdit",e.MoonshotAbout="Annotation.Document.About",e.MoonshotReadFromBeginning="Annotation.Document.FromBeginning",e.MoonshotKeyPoints="Annotation.Document.KeyPoints",e.MoonshotOutline="Annotation.Document.Outline",e.MoonshotReadInFull="Annotation.Document.ReadInFull",e.MoonshotSummarize="Annotation.Document.Summary",e.MoonshotMicrophoneOff="Audio.MicrophoneOff",e.MoonshotPause="Audio.Pause",e.MoonshotPlay="Audio.Play",e.MoonshotReplay="Audio.Replay",e.MoonshotSlowDown="Audio.SlowDown",e.MoonshotSpeedUp="Audio.SpeedUp",e.MoonshotReadSection="Document.Action.ReadSection",e.MoonshotRepeat="Document.Action.Repeat",e.MoonshotReview="Document.Action.Review",e.MoonshotDocumentAge="Document.Metadata.Age",e.MoonshotDocumentAuthor="Document.Metadata.Author",e.MoonshotDocumentHits="Document.Metadata.Hits",e.MoonshotDocumentLength="Document.Metadata.Length",e.MoonshotDocumentPreview="Document.Metadata.Preview",e.MoonshotDocumentTitle="Document.Metadata.Title",e.MoonshotNo="General.No",e.MoonshotYes="General.Yes",e.MoonshotIntro="intro",e.MoonshotNextDocument="Navigate.Document.Next",e.MoonshotPreviousDocument="Navigate.Document.Previous",e.ExcelIntent="ExcelIntent",e.InternalReadBack="Internal.Word.Editing.ReadBack",e.NoOp="NoOp"}(o||(o={}));var n,i,a,r=new Set([o.InternalReadBack]);!function(e){e.TableColumns="Word.Editing.InsertTable.TableColumns",e.TableRows="Word.Editing.InsertTable.TableRows",e.SelectionType="Word.Editing.ActOnSelection.SelectionType"}(n||(n={})),function(e){e.SpeechRecognitionStarted="SpeechRecognitionStarted",e.SpeechRecognitionStopped="SpeechRecognitionStopped",e.SpeechSessionStarted="SpeechSessionStarted",e.SpeechSessionStopped="SpeechSessionStopped"}(i||(i={})),function(e){e.MicrophoneError="ErrorAudioCaptureAsync"}(a||(a={}))},993256:(e,t,s)=>{s.d(t,{YV:()=>a});var o;!function(e){e[e.None=0]="None",e[e.FormulaR1C1=1]="FormulaR1C1",e[e.Text=2]="Text",e[e.NumberFormat=4]="NumberFormat",e[e.RawValue=8]="RawValue",e[e.NumberFormatCategory=16]="NumberFormatCategory",e[e.Borders=32]="Borders",e[e.FillColor=64]="FillColor",e[e.FontColor=128]="FontColor",e[e.FontOptions=256]="FontOptions",e[e.UseNewFormatFetcher=512]="UseNewFormatFetcher",e[e.SparseCells=1024]="SparseCells",e[e.OmitCoordsForAdjacentCell=2048]="OmitCoordsForAdjacentCell",e[e.FormulaA1=4096]="FormulaA1",e[e.IsFormula=8192]="IsFormula",e[e.IncludeRichFormattedEmptyCells=16384]="IncludeRichFormattedEmptyCells",e[e.NumberFormatNonLocalized=32768]="NumberFormatNonLocalized",e[e.NotSupportedInAugloop=65536]="NotSupportedInAugloop",e[e.FetchMultipleRanges=131072]="FetchMultipleRanges",e[e.NotSupportedInAugloop2=262144]="NotSupportedInAugloop2"}(o||(o={}));var n,i,a,r,c,l,u,p,g,h,d;!function(e){e.Dimension="dimension",e.Measure="measure"}(n||(n={})),function(e){e.None="none",e.Sum="sum",e.Count="count",e.Average="average",e.Min="min",e.Max="max",e.DistinctCount="distinctCount",e.StdDev="stdDev",e.Variance="variance"}(i||(i={})),function(e){e.RowMajor="rowMajor",e.ColumnMajor="columnMajor"}(a||(a={})),function(e){e[e.None=0]="None",e[e.RowsSampled=1]="RowsSampled",e[e.ColumnsSampled=2]="ColumnsSampled"}(r||(r={})),function(e){e.None="none",e.Other="other",e.ColumnMajorFlat="columnMajorFlat",e.RowMajorFlat="rowMajorFlat",e.SimpleCrossTable="simpleCrossTable"}(c||(c={})),function(e){e.None="none",e.ColumnMajorTabularSkipRows="columnMajorTabularSkipRows",e.RowMajorTabularSkipColumns="rowMajorTabularSkipColumns "}(l||(l={})),function(e){e.Dimension="dimension",e.Measure="measure"}(u||(u={})),function(e){e.None="none",e.Sum="sum",e.Count="count",e.Average="average",e.Min="min",e.Max="max",e.DistinctCount="distinctCount",e.StdDev="stdDev",e.Variance="variance"}(p||(p={})),function(e){e.RowMajor="rowMajor",e.ColumnMajor="columnMajor"}(g||(g={})),function(e){e.None="none",e.ColumnMajorTabularSkipRows="columnMajorTabularSkipRows",e.RowMajorTabularSkipColumns="rowMajorTabularSkipColumns "}(h||(h={})),function(e){e.None="None",e.Invisible="Invisible",e.Visible="Visible",e.InferredByCopilotLicense="InferredByCopilotLicense"}(d||(d={}))},995747:(e,t,s)=>{var o;s.d(t,{m:()=>o}),function(e){e[e.Unknown=0]="Unknown",e[e.Fatal=1]="Fatal",e[e.TokenExpired=2]="TokenExpired",e[e.ModelWorkflowNotSupported=3]="ModelWorkflowNotSupported",e[e.LargeWorkbooksNotSupported=4]="LargeWorkbooksNotSupported"}(o||(o={}))},995842:(e,t,s)=>{s.d(t,{r:()=>n});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_ExcelRunScript_ExcelRunScriptResponseSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},997445:(e,t,s)=>{s.d(t,{Cc:()=>c,RN:()=>n});var o=s(596498);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_SubstrateEventsInput"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_SubstrateEvent"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_ResponseReceivedSubstrateEvent"}static getBaseTypes(){return["AugLoop_SubstrateEvents_SubstrateEvent"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_ResultsRenderedSubstrateEvent"}static getBaseTypes(){return["AugLoop_SubstrateEvents_SubstrateEvent"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_SearchEntityActionsSubstrateEvent"}static getBaseTypes(){return["AugLoop_SubstrateEvents_SubstrateEvent"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_ClientDataSourceSubstrateEvent"}static getBaseTypes(){return["AugLoop_SubstrateEvents_SubstrateEvent"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_ClientLayoutSubstrateEvent"}static getBaseTypes(){return["AugLoop_SubstrateEvents_SubstrateEvent"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_ResultsView"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){o.h.assign(g,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_ResultsViewEntity"}static getBaseTypes(){return["AugLoop_SubstrateEvents_ResultsView"]}static typeGuard(e){return o.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){o.h.assign(h,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_ResultsViewGroup"}static getBaseTypes(){return["AugLoop_SubstrateEvents_ResultsView"]}static typeGuard(e){return o.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{constructor(e){o.h.assign(d,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_CachedContentRenderedSubstrateEvent"}static getBaseTypes(){return["AugLoop_SubstrateEvents_SubstrateEvent"]}static typeGuard(e){return o.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{constructor(e){o.h.assign(m,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_SearchFeedbackSubstrateEvent"}static getBaseTypes(){return["AugLoop_SubstrateEvents_SubstrateEvent"]}static typeGuard(e){return o.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()}}}]);
//# sourceMappingURL=augloop-chunk.js.map