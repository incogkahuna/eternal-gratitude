/*! For license information please see appchat.js.LICENSE.txt */
var TypeScriptModule;(()=>{var __webpack_modules__={1329:(e,t,n)=>{"use strict";n.d(t,{r:()=>a});class a{static generateId(){return a.operationId++,"AugLoop-ChatExcel-"+a.operationId.toString()}}a.operationId=0},1541:(e,t,n)=>{"use strict";n.d(t,{SB:()=>c,f9:()=>d,gV:()=>s,vc:()=>l,xb:()=>u});var a=n(279395),o=n(650444);function r(e,t){return e.length===t.length&&e.every(((e,n)=>e===t[n]))}function i(e){let t=e.length-1;for(;t>0&&e[t]===e[t-1];t--);return e.slice(0,t+1)}function l(e){const t=e.length;let n=[...e],a=t-1;for(;a>0&&r(n[a],n[a-1]);a--);return n=n.slice(0,a+1),n.map(i)}function s(e,t,n){const a=e[t<e.length?t:e.length-1];return a[n<a.length?n:a.length-1]}function c(e){if(!e)return null;if(0===e.length)return{keys:[],values:[],positions:[]};const t=e.map((e=>e.map((()=>-1)))),n=[],a=[];return e.forEach(((e,o)=>{e.forEach(((e,r)=>{const i=n.indexOf(e);"General"===e?t[o][r]=-1:i<0?(t[o][r]=n.length,n.push(e),a.push({row:o,column:r})):t[o][r]=i}))})),{keys:t,values:n,positions:a}}function d(e){const t=e>=60&&e<61,n=e<60?e+1:e,a=new Date(1e3*Math.round(86400*(n-25569)));return{is29Feb1900:t,adjustedRaw:n,date:new Date(1e3*Math.round(86400*(n-25569+a.getTimezoneOffset()/1440)))}}function u(e,t){if(null==e)return(0,a.Atw)();if("number"!=typeof e)throw new Error("Only numerics and blanks are expected in DatePartOverride grouped data");const{is29Feb1900:n,adjustedRaw:r,date:i}=d(e);if(Number.isNaN(i.getDay()))return r.toString();const l=e=>{const t=`0${e.toString()}`;return t.substr(t.length-2)},s=(i.getFullYear()-i.getFullYear()%10).toString(),c=i.getFullYear().toString(),u=l(i.getMonth()+1),m=n?"29":l(i.getDate()),g=l(i.getHours()),h=l(i.getMinutes()),p=l(i.getSeconds()),b=(Math.floor(i.getMonth()/3)+1).toString();switch(t){case"date":return`${c}-${u}-${m}`;case"decade":return`${s}`;case"monthAndDay":return`${u}-${m}`;case"dayOfMonth":return`${m}`;case"month":return`${u}`;case"quarter":return`Q${b}`;case"year":return`${c}`;case"yearAndMonth":return`${c}-${u}`;case"yearAndQuarter":return`${c} Q${b}`;case"hour":return`${g}:00`;case"minute":return`${h}`;case"hourAndMinute":return`${g}:${h}`;case"hourMinuteAndSecond":return`${g}:${h}:${p}`;case"dateAndHour":return`${c}-${u}-${m} ${g}:00`;case"dateHourAndMinute":return`${c}-${u}-${m} ${g}:${h}`;case"dateHourMinuteAndSecond":return`${c}-${u}-${m} ${g}:${h}:${p}`;default:return(0,o.x)(t)}}},2928:(e,t,n)=>{"use strict";n.d(t,{$o:()=>v,X$:()=>T,rE:()=>w});var a=n(86940),o=n(708353),r=n(83437),i=n(279395),l=n(12855),s=n(857677),c=n(75496),d=n(316904),u=n(109174),m=n(158058),g=n(851452),h=n(347145),p=n(306148),b=n(464077),f=n(311538),C=n(124445),y=n(507628);function v(e){return e===s.q0.UnsupportedTabularRange||e===s.q0.NoTableLikeEntityFound||e===s.q0.UnsupportedObjectDetected||e===s.q0.TLRAutofixSuggestion}async function T(e){const t=u.CP.getActiveTable()?.address,n=u.CP.getActiveTable()?.tableLikeRangeFeatures,v=()=>({message:I((0,i.MKr)().replace("\n\n","\n\n&nbsp;\n\n")),telemetry:{featureName:s.q.ContextInference,eventType:s.a5.ErrorMessage,errorType:s.q0.NoTableLikeEntityFound}}),T=(0,m.kB)(e);if(t&&n&&T){const e=T&n;if(0===e)return d.M.getInstance().logError({eventType:c.S2.TabularRange,errorMessage:"No unsupported TLR features found",logLevel:r.$b.Warning}),v();const s=(0,m.kw)(e),u=await(0,m.Ks)(s);return 1===u.length?await E(t,e,u):await async function(e,t,n){let r=n;t&l.ye.RowMajor&&(r=[l.ye.RowMajor]);if(r=(0,m.S5)(r),1===r.length)return E(e,t,r);if(await(0,C.f6)(t)){return{message:await(0,g.ge)(e,t),telemetry:S(t)}}const s=r.map((e=>({header:(0,m.Ah)(e),description:(0,m.f0)(e)}))),c=(0,i.S7l)().replace("{range}",(0,b.G2)(e)),d=(0,h.yw9)("OfficeVSO_9267571_DisplayConvertToTableConclusionMessage")?(0,m.hd)(r):(0,i.VH3)(),u=function(e,t,n){const r=(0,y.A)();return{chatCardType:a._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:R(e,t,n),horizontalTableScroll:!0,componentsOverride:(0,f.G)(e)}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:o.O.Footer,feedbackData:{feedbackArea:"Copilot\\Context Inference"},shouldShowFeedbackSection:!0,messageId:r,actionButtonList:(0,h.jHv)()?[(0,p.yo)(r)]:void 0},addCardToChatHistory:!0}}(s,c,d),v=x(t);return{message:u,telemetry:v}}(t,e,u)}return v()}function x(e){return{featureName:s.q.ContextInference,eventType:s.a5.ErrorMessage,errorType:s.q0.UnsupportedTabularRange,errorDetails:{TabularRangeUnsupportedFeature:e}}}function S(e){return{featureName:s.q.ContextInference,eventType:s.a5.ErrorMessage,errorType:s.q0.TLRAutofixSuggestion,errorDetails:{TabularRangeUnsupportedFeature:e}}}function w(e){const t=function(e){const t=(0,y.A)();return{chatCardType:a._.Default,chatMessageData:{defaultMessageProps:{user:"chat",messageHeader:{text:e}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:o.O.Footer,shouldShowFeedbackSection:!0,messageId:t,actionButtonList:(0,h.jHv)()?[(0,p.yo)(t)]:void 0,feedbackData:{feedbackArea:"Copilot\\Context Inference"}},addCardToChatHistory:!0}}((0,m.ey)(e)),n=function(e){const t=e===l.b_.PayloadTooLarge?s.q0.LargeData:s.q0.UnsupportedObjectDetected;return{featureName:s.q.ContextInference,eventType:s.a5.ErrorMessage,errorType:t,errorDetails:{UnsupportedContextFeature:e}}}(e);return{message:t,telemetry:n}}async function E(e,t,n){const a=n[0];let o;if(await(0,C.f6)(a)){o=await(0,g.ge)(e,a);return{message:o,telemetry:S(a)}}o=I((0,m.Zv)(a).replace("{range}",(0,b.G2)(e)));return{message:o,telemetry:x(t)}}function I(e){const t=(0,y.A)();return{chatCardType:a._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:e,horizontalTableScroll:!0}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:o.O.Footer,shouldShowFeedbackSection:!0,messageId:t,actionButtonList:(0,h.jHv)()?[(0,p.yo)(t)]:void 0,feedbackData:{feedbackArea:"Copilot\\Context Inference"}},addCardToChatHistory:!0}}function R(e,t,n){let a=`${t}\n`;return e.forEach((e=>{a+=`\n- ${e.header}\n\n`})),a+=`\n\n${n}`,a}},5288:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var a=n(535718),o=n.n(a),r=n(871038),i=n.n(r)()(o());i.push([e.id,'@media (forced-colors: active) {\n  svg > path.OfficeIconColors_HighContrast:not([class*="OfficeIconColors_m"]) {\n    forced-color-adjust: auto;\n    fill: currentColor;\n  }\n}\n\n@media (forced-colors: active) {\n  svg > path[class*="OfficeIconColors_m"]:not(.OfficeIconColors_HighContrast) {\n    forced-color-adjust: auto;\n    fill: none;\n  }\n}\n\n@media (forced-colors: active) {\n  div.conditional-formatting-response-card-sample-text {\n    display: none;\n  }\n}\n\n/* ConditionalFormatResponseCardSample.tsx */\n.conditional-formatting-response-card-icon {\n  height: 20px;\n  width: 20px;\n  margin-left: 1px;\n  margin-right: 10px;\n}\n\ndiv.conditional-formatting-response-card-icon-renderer {\n  display: flex;\n  border: none;\n  flex-basis: 100%;\n  direction: ltr;\n  height: 20px;\n  width: 110px;\n}\n\n/* commandingChatCard.tsx */\ndiv.conditional-formatting-response-card-swatch {\n  margin: auto;\n  width: 50%;\n  padding-top: 0.5rem;\n  padding-bottom: 0.5rem;\n}\n\ndiv.conditional-formatting-response-card-formula {\n  padding-top: 1rem;\n  padding-bottom: 1rem;\n  margin-inline-start: -2rem;\n  width: auto;\n}\n',"",{version:3,sources:["webpack://./src/frontend/components/ConditionalFormatResponseCardSample/Styles/ConditionalFormatIcons.css"],names:[],mappings:"AAAA;EACE;IACE,yBAAyB;IACzB,kBAAkB;EACpB;AACF;;AAEA;EACE;IACE,yBAAyB;IACzB,UAAU;EACZ;AACF;;AAEA;EACE;IACE,aAAa;EACf;AACF;;AAEA,4CAA4C;AAC5C;EACE,YAAY;EACZ,WAAW;EACX,gBAAgB;EAChB,kBAAkB;AACpB;;AAEA;EACE,aAAa;EACb,YAAY;EACZ,gBAAgB;EAChB,cAAc;EACd,YAAY;EACZ,YAAY;AACd;;AAEA,2BAA2B;AAC3B;EACE,YAAY;EACZ,UAAU;EACV,mBAAmB;EACnB,sBAAsB;AACxB;;AAEA;EACE,iBAAiB;EACjB,oBAAoB;EACpB,0BAA0B;EAC1B,WAAW;AACb",sourcesContent:['@media (forced-colors: active) {\n  svg > path.OfficeIconColors_HighContrast:not([class*="OfficeIconColors_m"]) {\n    forced-color-adjust: auto;\n    fill: currentColor;\n  }\n}\n\n@media (forced-colors: active) {\n  svg > path[class*="OfficeIconColors_m"]:not(.OfficeIconColors_HighContrast) {\n    forced-color-adjust: auto;\n    fill: none;\n  }\n}\n\n@media (forced-colors: active) {\n  div.conditional-formatting-response-card-sample-text {\n    display: none;\n  }\n}\n\n/* ConditionalFormatResponseCardSample.tsx */\n.conditional-formatting-response-card-icon {\n  height: 20px;\n  width: 20px;\n  margin-left: 1px;\n  margin-right: 10px;\n}\n\ndiv.conditional-formatting-response-card-icon-renderer {\n  display: flex;\n  border: none;\n  flex-basis: 100%;\n  direction: ltr;\n  height: 20px;\n  width: 110px;\n}\n\n/* commandingChatCard.tsx */\ndiv.conditional-formatting-response-card-swatch {\n  margin: auto;\n  width: 50%;\n  padding-top: 0.5rem;\n  padding-bottom: 0.5rem;\n}\n\ndiv.conditional-formatting-response-card-formula {\n  padding-top: 1rem;\n  padding-bottom: 1rem;\n  margin-inline-start: -2rem;\n  width: auto;\n}\n'],sourceRoot:""}]);const l=i},5532:(e,t,n)=>{"use strict";var a;n.d(t,{D:()=>a,J:()=>o}),function(e){e[e.None=0]="None",e[e.CellValue=1]="CellValue",e[e.ColorScale=2]="ColorScale",e[e.DataBar=3]="DataBar",e[e.IconSet=4]="IconSet",e[e.Preset=5]="Preset",e[e.TopBottom=6]="TopBottom",e[e.CustomCreated=7]="CustomCreated",e[e.Dates=8]="Dates",e[e.UniqueValue=9]="UniqueValue",e[e.TextComparison=10]="TextComparison"}(a||(a={}));class o{constructor(e=0,t,n,a,o,r,i){this.cardTitle=e,this.iconSetNumber=t,this.originalHexColors=n,this.customFormula=a,this.formulaExplanation=o,this.customFormat=r,this.dataBarFormat=i}}},8403:(e,t,n)=>{"use strict";n.d(t,{F_:()=>o,KA:()=>l,YQ:()=>r});var a=n(508491);const o=(0,n(644476).Nc)();function r(e){return(...t)=>(n,a)=>e(n,a,...t)}let i;function l(){return i||(i=(0,a.U)()),i}},9361:(e,t,n)=>{"use strict";n.d(t,{z:()=>o});var a=n(831922);const o=()=>(0,a.getDefaultClientInfo)()},12163:(e,t,n)=>{"use strict";function a(e,t,n){return s(e,1,t,n)}function o(e,t,n){return s(e,2,t,n)}function r(e,t,n){return s(e,3,t,n)}function i(e,t,n){return s(e,0,t,n)}function l(e,t,n){return s(e,4,t,n)}function s(e,t,n,a){return{name:e,dataType:t,value:n,classification:a||4}}n.d(t,{LK:()=>a,Ug:()=>o,ip:()=>r,k:()=>l,m9:()=>i})},13161:(e,t,n)=>{"use strict";n.d(t,{DH:()=>o,w2:()=>r,wv:()=>a});class a{}var o,r;a.Worksheet={Activate:"Worksheet.activated",Filter:{Icon:"Worksheet.filtered.Icon",BottomItems:"Worksheet.filtered.BottomItems",BottomPercent:"Worksheet.filtered.BottomPercent",TopItems:"Worksheet.filtered.TopItems",TopPercent:"Worksheet.filtered.TopPercent",Values:"Worksheet.filtered.Values",Custom:"Worksheet.filtered.Custom",Dynamic:"Worksheet.filtered.Dynamic",FontColor:"Worksheet.filtered.FontColor",CellColor:"Worksheet.filtered.CellColor"},ClearFilter:"Worksheet.clearedFilter",ClearColumnFilter:"Worksheet.clearedColumnFilter"},a.Range={Sort:"Range.sorted"},a.Table={Sort:"Table.sorted",TotalRow:"Table.totalRowToggled",HeaderRow:"Table.headerRowToggled",BandedRows:"Table.bandedRowsToggled",BandedColumns:"Table.bandedColumnsToggled",FirstColumn:"Table.firstColumnToggled",LastColumn:"Table.lastColumnToggled",FilterButton:"Table.filterButtonToggled",FilterColor:"Table.filterColor",ApplyStyle:"Table.styleApplied",ApplyTableUpdatePlan:"Table.applyPowerQueryTableUpdatePlan"},a.Format={IndentChange:"Format.indentChange",RemoveAutofitColumns:"Format.removeAutofitColumns",RemoveAutofitRows:"Format.removeAutofitRows"},a.ConditionalFormatting={ApplyIconSetConditionalFormatting:"ConditionalFormatting.applyIconSetConditionalFormatting"},function(e){e.Undo="Undo",e.TableAltText="TableAltText",e.RefreshData="RefreshData",e.AddComment="AddComment",e.DataValidation="DataValidation",e.CreatePivotTable="CreatePivotTable",e.InsertWorksheets="InsertWorksheets",e.DeleteWorksheets="DeleteWorksheets",e.InsertTables="InsertTables",e.FreezePanes="FreezePanes",e.Formatting="Formatting"}(o||(o={})),function(e){e[e.OfficeScripts=0]="OfficeScripts",e[e.OfficeJS=1]="OfficeJS",e[e.Insights=2]="Insights",e[e.FormulaGeneration=3]="FormulaGeneration",e[e.DataShaping=4]="DataShaping",e[e.UnsupportedEvent=5]="UnsupportedEvent",e[e.ConditionalFormatSuggestion=6]="ConditionalFormatSuggestion",e[e.ImportData=7]="ImportData"}(r||(r={}))},16796:(e,t,n)=>{"use strict";n.d(t,{y:()=>u});var a=n(639765),o=n(548366),r=n(316904);var i=n(838446);var l=n(347145);var s=n(857786);var c=n(634883),d=n(394201);function u(e,t){const n=e.category,u=(0,d.D)(e),m=u.errorCode,g=u.errorReason;switch(n){case c.E.ClientProgramResponseError:!function(e,t){let n=o.W.Unclassified_Chat_Failure,i=a.c.Client_Program_Response_Error;e&&"timeout"===e&&(n=o.W.Response_Delayed_Or_Timed_Out,i=a.c.Service_Timeout);r.M.getInstance().logStandardizedAshaErrorEvent(n,i,t)}(m,t);break;case c.E.DisengagedError:(0,i.I)(m,t);break;case c.E.ExcelTabularSkillFailedError:break;case c.E.InferenceAPIError:!function(e,t){let n=o.W.LLM_Service_Side_Issue_Prevents_Output,i=a.c.InferenceAPI;if(e)switch(e){case"user-throttled":n=o.W.Unable_To_Generate_Response_Due_To_Capacity_Issue,i=a.c.User_Throttled;break;case"scenario-throttled":n=o.W.Unable_To_Generate_Response_Due_To_Capacity_Issue,i=a.c.Scenario_Throttled;break;case"throttled":n=o.W.Unable_To_Generate_Response_Due_To_Capacity_Issue,i=a.c.Throttled;break;case"not-available":i=a.c.InferenceAPI_Not_Available;break;case"timeout":n=o.W.Response_Delayed_Or_Timed_Out,i=a.c.InferenceAPI_Timeout}r.M.getInstance().logStandardizedAshaErrorEvent(n,i,t)}(m,t);break;case c.E.InputQueryError:!function(e,t){let n=o.W.LLM_Service_Side_Issue_Prevents_Output,i=a.c.Augloop_Failed_Input_Error;if(e)switch(e){case"unsupported-multi-agent":n=o.W.User_Input_Could_Not_Be_Processed,i=a.c.Multiple_Intents_Detected;break;case"bad-token":n=o.W.User_Access_Issue_For_Copilot,i=a.c.Augloop_Failed_Token_Validation;break;case"too-short":n=o.W.User_Input_Could_Not_Be_Processed,i=a.c.Input_Too_Short;break;case"too-long":n=o.W.User_Input_Could_Not_Be_Processed,i=a.c.Input_Too_Long;break;case"invalid":n=o.W.User_Input_Could_Not_Be_Processed,i=a.c.Input_Query_Error_Invalid;break;case"out-of-scope":n=o.W.User_Input_Could_Not_Be_Processed,i=a.c.Input_Query_Error_Out_Of_Scope}r.M.getInstance().logStandardizedAshaErrorEvent(n,i,t)}(m,t);break;case c.E.LicensingError:!function(e,t,n){const i=o.W.User_Access_Issue_For_Copilot;let s=a.c.Augloop_Failed_Entitlement_Validation;(0,l.yw9)("OfficeVSO_9748131_ASHAErrorLoggingForAugLoopLicensingErrors")&&e&&("missing-service-plan"===e?t&&(s="MissingServicePlanBYOA"===t?a.c.Augloop_Failed_License_Check_Due_To_Missing_Service_Plan_BYOA:a.c.Augloop_Failed_License_Check_Due_To_Uncategorized_Error_Reason):s=a.c.Augloop_Failed_License_Check_Due_To_Uncategorized_Error_Code);r.M.getInstance().logStandardizedAshaErrorEvent(i,s,n)}(m,g,t);break;case c.E.ODSLParseError:!function(e,t){let n=o.W.LLM_Service_Side_Issue_Prevents_Output,i=a.c.Failed_Parse_ODSL;if(e)switch(e){case"zero-parsed":i=a.c.Failed_Parse_ODSL_Zero;break;case"date-logic":n=o.W.Missing_Copilot_Functionality,i=a.c.Failed_Parse_ODSL_Date_Logic;break;case"no-op":i=a.c.Failed_Parse_ODSL_No_Op}r.M.getInstance().logStandardizedAshaErrorEvent(n,i,t)}(m,t);break;case c.E.ODSLSyntaxError:!function(e,t){const n=o.W.Unable_To_Complete_Task,i=a.c.Invalid_ODSL_Generated;r.M.getInstance().logStandardizedAshaErrorEvent(n,i,t)}(0,t);break;case c.E.OffensiveContent:!function(e,t){let n=a.c.Input_Was_Offensive_So_No_Response;const i=o.W.Responsible_AI_Filter_Blocked_Response;if(e)switch(e){case"input-query:guardlist":n=a.c.Input_Blocked_Guardlist;break;case"input-query:content-safety-jailbreak-classifier":n=a.c.Input_Blocked_Prompt_Injection;break;case"generated-output:open-ai-moderation":n=a.c.Suggestion_Blocked_Due_To_Code_Generated_Being_Protected_By_Copyright_Licensing;break;default:e.indexOf("input-query")>-1?n=a.c.Input_Query_Error:e.indexOf("generated-output")>-1&&(n=a.c.Generated_Output_Error)}r.M.getInstance().logStandardizedAshaErrorEvent(i,n,t)}(m,t);break;case c.E.SkillFailedError:!function(e,t){const n=o.W.LLM_Service_Side_Issue_Prevents_Output,i=a.c.Failed_Due_To_Skill_Failure;r.M.getInstance().logStandardizedAshaErrorEvent(n,i,t)}(0,t);break;case c.E.PythonSkillFailedError:!function(e,t){const n=o.W.LLM_Service_Side_Issue_Prevents_Output,i=a.c.Python_Skill_Failed;r.M.getInstance().logStandardizedAshaErrorEvent(n,i,t),(0,s.hb)(),(0,s.P_)(!0)}(0,t);break;case c.E.SydneyCancelledError:!function(e,t){const n=o.W.LLM_Service_Side_Issue_Prevents_Output,i=a.c.Sydney_Cancelled_Error;r.M.getInstance().logStandardizedAshaErrorEvent(n,i,t)}(0,t);break;case c.E.IgnorableError:case c.E.SydneyError:!function(e,t){const n=o.W.LLM_Service_Side_Issue_Prevents_Output;let i=a.c.Orchestration_Failed_Sydney;if(e)switch(e){case"unknown":i=a.c.Sydney_Unknown_Error;break;case"bad-conversation-id":i=a.c.Sydney_Bad_Converstaion_Id;break;case"error-response":i=a.c.Sydney_Error;break;case"server-timeout":i=a.c.Sydney_Timeout;break;case"websocket-failed-to-connect":i=a.c.Sydney_Websocket_Failed;break;case"out-of-credits":i=a.c.Out_Of_Credits}r.M.getInstance().logStandardizedAshaErrorEvent(n,i,t)}(m,t);break;case c.E.TokenCountError:!function(e,t){const n=o.W.User_Input_Could_Not_Be_Processed,i=a.c.Input_Exceeded_Max_Length;r.M.getInstance().logStandardizedAshaErrorEvent(n,i,t)}(0,t);break;case c.E.UnsupportedLanguageError:!function(e,t){const n=o.W.Missing_Copilot_Functionality,i=a.c.Input_Language_Unsupported;r.M.getInstance().logStandardizedAshaErrorEvent(n,i,t)}(0,t);break;default:r.M.getInstance().logStandardizedAshaErrorEvent(o.W.Unclassified_ASHA_Error,a.c.Augloop_Error,t)}}},19213:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(154836),o=n(178360),r=n(241821);t.default=function(e,t,n){e??={},n??=0;let i=(0,o.default)({...e,_v6:!0},new Uint8Array(16));if(i=(0,r.default)(i),t){for(let e=0;e<16;e++)t[n+e]=i[e];return t}return(0,a.unsafeStringify)(i)}},20847:(e,t,n)=>{"use strict";n.d(t,{q:()=>s,w:()=>d});var a=n(279395),o=n(83437),r=n(75496),i=n(316904),l=n(851295);function s(e,t=(0,l.gl)()){const n=function(e){try{const t=new Intl.ListFormat(e,{});return e=>t.format(e)}catch(t){return i.M.getInstance().logError({eventType:r.S2.Localization,errorMessage:`Failed to create Intl.ListFormat for locale ${e}. ${t}`,logLevel:o.$b.Warning}),c}}(t);return n(e)}function c(e){const t=[...e];if(0===t.length)return"";if(1===t.length)return t[0];const n=t.pop(),o=a.olU.And;return`${t.join(", ")} ${o} ${n}`}function d(e){if(e){return new Intl.DisplayNames([(0,l.gl)()],{type:"language"}).of(e)}}},21187:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>s,BY:()=>u,CS:()=>d,Md:()=>m,TC:()=>l,k_:()=>c});var a=n(458835),o=n(208520),r=n(134306);const i=(0,a.m)(void 0,"SharedCopilotContext"),l=i.Provider;function s(){const e=o.useContext(i);if(!e)throw new Error("useSharedCopilotContext must be used within a SharedCopilotProvider");return e}function c(){return o.useContext(i)}function d(){var e;return null===(e=c())||void 0===e?void 0:e.serviceProvider.markdown}function u(){var e;return null===(e=d())||void 0===e?void 0:e.links}function m(){var e,t;return(null===(t=null===(e=c())||void 0===e?void 0:e.serviceProvider.react)||void 0===t?void 0:t.ErrorBoundary)||r.I}},22992:(e,t,n)=>{"use strict";n.d(t,{g:()=>a});class a{getIsFirstColumnEntityResolved(){return this.isFirstColumnEntityResolved}getHasShownFirstColumnHint(){return this.hasShownFirstColumnHint}setIsFirstColumnEntityResolved(e,t){const n=JSON.parse(e);let a=!1;for(let e=0;e<n.length;e++)if(t?.includes(n[e])){a=!0;break}a||(this.isFirstColumnEntityResolved=!0)}setHiddenColumnSuffixMessage(e,t){const n=JSON.parse(e.headers),a=t.map((e=>n[e]));a.length>1?this.hiddenColumnSuffixMessage="I noticed that some columns are hidden, so you'll need to unhide them to see what I did.":this.hiddenColumnSuffixMessage=`I noticed that column ${a[0]} is hidden, so you'll need to unhide this column to see what I did.`}getHiddenColumnSuffixMessageAndReset(){const e=this.hiddenColumnSuffixMessage?.slice();return this.hiddenColumnSuffixMessage=void 0,e}setHasShownFirstColumnHint(e){this.hasShownFirstColumnHint=e}constructor(){this.isFirstColumnEntityResolved=!1,this.hasShownFirstColumnHint=!1}}a.instance=()=>(a._instance||(a._instance=new a),a._instance)},39206:(e,t,n)=>{"use strict";n.d(t,{$h:()=>u,We:()=>p,hf:()=>h,lx:()=>g});var a=n(45698),o=n(823860),r=n(347145),i=n(892221),l=n(980096),s=n.n(l),c=n(731137),d=n(895486);async function u(e){const{sheetName:t,rangeAddress:n,entityName:a,entityType:o,columnIndex:r,filteredDataDisplayName:i,filterCriteria:l}=e;return await Excel.run({delayForCellEdit:!0},(async e=>{const i=e.workbook.worksheets.getItem(t).getRange(n);e.workbook[o].getItem(a).autoFilter.apply(i,r,l),await e.sync()})),g(i,l)}const m=(0,r.k64)()&&(0,r.yw9)("OfficeVSO_9122912_HiTLTLRFilterOfficeJS");function g(e,t){const{filterOn:n,criterion1:l,color:u}=t;let g=m?ExcelCopilotCommandingHitlStrings.WorksheetDefaultFilterLabel:c.Intents.WorksheetDefaultFilterLabel;switch(n){case"CellColor":g=m?ExcelCopilotCommandingHitlStrings.WorksheetCellColorFilterLabel:c.Intents.WorksheetCellColorFilterLabel;break;case"FontColor":g=m?ExcelCopilotCommandingHitlStrings.WorksheetFontColorFilterLabel:c.Intents.WorksheetFontColorFilterLabel;break;case"Values":g=m?ExcelCopilotCommandingHitlStrings.WorksheetValuesFilterAppliedLabel:c.Intents.WorksheetValuesFilterAppliedLabel;break;case"Dynamic":g=m?ExcelCopilotCommandingHitlStrings.WorksheetDynamicFilterAppliedLabel:c.Intents.WorksheetDynamicFilterAppliedLabel;break;case"TopItems":g=m?ExcelCopilotCommandingHitlStrings.WorksheetTopItemsFilterLabel:c.Intents.WorksheetTopItemsFilterLabel;break;case"TopPercent":g=m?ExcelCopilotCommandingHitlStrings.WorksheetTopPercentFilterLabel:c.Intents.WorksheetTopPercentFilterLabel;break;case"BottomItems":g=m?ExcelCopilotCommandingHitlStrings.WorksheetBottomItemsFilterLabel:c.Intents.WorksheetBottomItemsFilterLabel;break;case"BottomPercent":g=m?ExcelCopilotCommandingHitlStrings.WorksheetBottomPercentFilterLabel:c.Intents.WorksheetBottomPercentFilterLabel;break;case"Custom":return function(e,t){if(!t.criterion1)return(0,d.A)(m?ExcelCopilotCommandingHitlStrings.WorksheetCustomFilterAppliedLabel:c.Intents.WorksheetCustomFilterAppliedLabel,{columnName:e});let n,a=m?o.O.UnhandledIntent:c.Intents.WorksheetCustomFilterAppliedLabel,{valueCompareType:l,value:u}=s().getCustomFilterCompareType(t.criterion1);if(t.criterion2)if((0,r.yw9)("OfficeVSO_9126157_FixTLRFilterBetween")){const{valueCompareType:e,value:a}=s().getCustomFilterCompareType(t.criterion2);n=a,l===i.default.IsGreaterThenOrEqualTo&&e===i.default.IsLessThanOrEqualTo&&t.operator===Excel.FilterOperator.and?l=i.default.IsBetween:l===i.default.IsLessThen&&e===i.default.IsGreaterThan&&t.operator===Excel.FilterOperator.or&&(l=i.default.IsNotBetween)}else n=s().getCustomFilterCompareType(t.criterion2)?.value;switch(l){case i.default.Equals:a=m?ExcelCopilotCommandingHitlStrings.TableColumnEqualsFilterLabel:c.Intents.TableColumnEqualsFilterLabel;break;case i.default.DoesNotEqual:a=m?ExcelCopilotCommandingHitlStrings.TableColumnDoesNotEqualFilterLabel:c.Intents.TableColumnDoesNotEqualFilterLabel;break;case i.default.BeginsWith:a=void 0!==n?m?ExcelCopilotCommandingHitlStrings.TableColumnBeginsWithFilterLabel2:c.Intents.TableColumnBeginsWithFilterLabel2:m?ExcelCopilotCommandingHitlStrings.TableColumnBeginsWithFilterLabel1:c.Intents.TableColumnBeginsWithFilterLabel1;break;case i.default.DoesNotBeginWith:a=void 0!==n?m?ExcelCopilotCommandingHitlStrings.TableColumnDoesNotBeginWithFilterLabel2:c.Intents.TableColumnDoesNotBeginWithFilterLabel2:m?ExcelCopilotCommandingHitlStrings.TableColumnDoesNotBeginWithFilterLabel1:c.Intents.TableColumnDoesNotBeginWithFilterLabel1;break;case i.default.EndsWith:a=void 0!==n?m?ExcelCopilotCommandingHitlStrings.TableColumnEndsWithFilterLabel2:c.Intents.TableColumnEndsWithFilterLabel2:m?ExcelCopilotCommandingHitlStrings.TableColumnEndsWithFilterLabel1:c.Intents.TableColumnEndsWithFilterLabel1;break;case i.default.DoesNotEndWith:a=void 0!==n?m?ExcelCopilotCommandingHitlStrings.TableColumnDoesNotEndWithFilterLabel2:c.Intents.TableColumnDoesNotEndWithFilterLabel2:m?ExcelCopilotCommandingHitlStrings.TableColumnDoesNotEndWithFilterLabel1:c.Intents.TableColumnDoesNotEndWithFilterLabel1;break;case i.default.Contains:a=void 0!==n?m?ExcelCopilotCommandingHitlStrings.TableColumnContainsFilterLabel2:c.Intents.TableColumnContainsFilterLabel2:m?ExcelCopilotCommandingHitlStrings.TableColumnContainsFilterLabel1:c.Intents.TableColumnContainsFilterLabel1;break;case i.default.DoesNotContain:a=void 0!==n?m?ExcelCopilotCommandingHitlStrings.TableColumnDoesNotContainFilterLabel2:c.Intents.TableColumnDoesNotContainFilterLabel2:m?ExcelCopilotCommandingHitlStrings.TableColumnDoesNotContainFilterLabel1:c.Intents.TableColumnDoesNotContainFilterLabel1;break;case i.default.IsGreaterThan:a=m?ExcelCopilotCommandingHitlStrings.TableColumnIsGreaterThanFilterLabel:c.Intents.TableColumnIsGreaterThanFilterLabel;break;case i.default.IsGreaterThenOrEqualTo:a=m?ExcelCopilotCommandingHitlStrings.TableColumnIsGreaterThanOrEqualToFilterLabel:c.Intents.TableColumnIsGreaterThanOrEqualToFilterLabel;break;case i.default.IsLessThen:a=m?ExcelCopilotCommandingHitlStrings.TableColumnIsLessThanFilterLabel:c.Intents.TableColumnIsLessThanFilterLabel;break;case i.default.IsLessThanOrEqualTo:a=m?ExcelCopilotCommandingHitlStrings.TableColumnIsLessThanOrEqualToFilterLabel:c.Intents.TableColumnIsLessThanOrEqualToFilterLabel;break;case i.default.IsBetween:a=m?ExcelCopilotCommandingHitlStrings.TableColumnBetweenFilterLabel:c.Intents.TableColumnBetweenFilterLabel;break;case i.default.IsNotBetween:a=m?ExcelCopilotCommandingHitlStrings.TableColumnNotBetweenFilterLabel:c.Intents.TableColumnNotBetweenFilterLabel;break;default:a=m?o.O.UnhandledIntent:c.Intents.WorksheetCustomFilterAppliedLabel}return(0,d.A)(a,{columnName:e,value1:u,value2:n})}(e,t);default:g=m?o.O.UnhandledIntent:c.Intents.WorksheetDefaultFilterLabel}return(0,d.A)(g,{range:e,criterion:l,color:m&&u?a.g.colorNameFromHEX(u):u})}async function h(e){const{entityName:t,entityType:n,columnIndex:a,changedDataDisplayName:o}=e;return await Excel.run({delayForCellEdit:!0},(async e=>{e.workbook[n].getItem(t).autoFilter.clearColumnCriteria(a),await e.sync()})),(0,d.A)(c.Intents.WorksheetRangeClearFiltersLabel,{range:o})}async function p(e){const{entityName:t,entityType:n,changedDataDisplayName:a}=e;return await Excel.run({delayForCellEdit:!0},(async e=>{e.workbook[n].getItem(t).autoFilter.clearCriteria(),await e.sync()})),(0,d.A)(c.Intents.WorksheetRangeClearFiltersLabel,{range:a})}},41490:(e,t,n)=>{"use strict";n.d(t,{L7:()=>f,Si:()=>h,VL:()=>b,sR:()=>p});var a=n(531093),o=n(936243),r=n(380317),i=n(741975),l=n(128958);const s={type:l.default.automin,formula:"",number:0},c={type:l.default.automax,formula:"",number:0},d={borderColor:"#FF0000",borderStyle:a.BorderLineStyle.Thin,borderWeight:o.BorderWeight.thin,scaleFactor:.25,defaultHeightWidth:15,fontColor:"#000000",fontSizeChange:2},u={isGradientFill:!0,borderColor:null,fillColor:"#FFFF00",isLTRDirection:!0,isNegativeValuesFillColorCustom:!1,negativeValuesFillColor:"#FFFF00",isNegativeValuesBorderColorCustom:!1,negativeValuesBorderColor:null,isShowValueEnabled:!0,axisColor:"#000000",axisPositionType:i.default.none,minBoundCFObjectValues:s,maxBoundCFObjectValues:c,minimumColorDeprecated:"#FF0000",minimumColor:"#F8696B",maximumColorDeprecated:"#00FF00",maximumColor:"#63be7b",midpointColor:"",maximumCFObjectValues:{type:l.default.max,formula:null,number:0},midpointCFObjectValuesDeprecated:{type:l.default.percent,formula:"=50",number:0},midpointCFObjectValues:{type:l.default.percentile,formula:"=50",number:50},minimumCFObjectValues:{type:l.default.min,formula:null,number:0},shouldGenerateGetRule:!1,defaultCustomFormat:{BackgroundColor:null,TextColor:"#000000",IsTextBold:!1,IsTextItalic:!1,IsTextStrikethrough:!1,IsTextUnderlined:!1,IsTextDoubleUnderlined:!1,BorderFormat:{Position:15,LineStyle:[a.BorderLineStyle.None,a.BorderLineStyle.None,a.BorderLineStyle.None,a.BorderLineStyle.None],Color:[0,0,0,0],ThemeBorderColor:[{ThemeColorIndex:0,ThemeColorRow:0},{ThemeColorIndex:0,ThemeColorRow:0},{ThemeColorIndex:0,ThemeColorRow:0},{ThemeColorIndex:0,ThemeColorRow:0}],ColorTypeOption:r.hU.rgbColor,Thickness:[0,0,0,0]},PreserveBackgroundColor:!1,PreserveTextColor:!1},BorderStyle:a.BorderLineStyle.Thin,defaultBackgroundColor:"#FFFF00",topBottomRank:10,topBottomType:"topItems"},m={"#FF0000":"#FF555A","#00FF00":"#63BE7B","#FFFF00":"#FFEF9C","#FFFFFF":"#FCFCFF","#0000FF":"#5A8AC6","#FFC0CB":"#FFC7CE","#8B0000":"#9C0006","#006400":"#63BE7B","#4169E1":"#5A8AC6","#FFA500":"#FCBF7B"},g={isAscending:!0,caseMatch:!1};function h(e){return d[e]}function p(e){return u[e]}function b(e){return g[e]}function f(e){return e in m?m[e]:e}},45698:(e,t,n)=>{"use strict";n.d(t,{g:()=>a});class a{static hslFromRgb(e){const t=(e>>16&255)*this.maxHslValue/this.maxRGBValue,n=(e>>8&255)*this.maxHslValue/this.maxRGBValue,a=(255&e)*this.maxHslValue/this.maxRGBValue,o=Math.max(t,Math.max(n,a)),r=Math.min(t,Math.min(n,a)),i=o+r,l=o-r;let s,c;const d=i/2;return 0===l?(s=0,c=0):(c=l*this.maxHslValue/(d<=this.maxHslValue/2?i:2*this.maxHslValue-i),s=t===o?(n-a)*(this.maxHslValue/6)/l:n===o?this.maxHslValue/3+(a-t)*(this.maxHslValue/6)/l:2*this.maxHslValue/3+(t-n)*(this.maxHslValue/6)/l,s<0?s+=this.maxHslValue:s>this.maxHslValue&&(s-=this.maxHslValue)),[s,c,d]}static colorNameFromHEX(e,t=!1){if(!e)return;if(!t&&e in a.HexColorMap)return a.HexColorMap[e]();let n,o,r;const i=parseInt("0x"+e.slice(1,7),16);if([n,o,r]=this.hslFromRgb(i),n=255*n/this.maxHslValue,r=255*r/this.maxHslValue,o=255*o/this.maxHslValue,r>240)return ExcelCopilotCommandingHitlStrings.ColorWhite;if(r<20)return ExcelCopilotCommandingHitlStrings.ColorBlack;if(o<=20)return t?ExcelCopilotCommandingHitlStrings.ColorGray:r>170?ExcelCopilotCommandingHitlStrings.ColorLightGray:r>100?ExcelCopilotCommandingHitlStrings.ColorGray:ExcelCopilotCommandingHitlStrings.ColorDarkGray;let l;l=o>20&&o<=75?a.HueLimitsForSatLevel1:o>75&&o<=115?a.HueLimitsForSatLevel2:o>115&&o<=150?a.HueLimitsForSatLevel3:o>150&&o<=240?a.HueLimitsForSatLevel4:a.HueLimitsForSatLevel5;let s=0;for(;s<l.length&&n>=l[s];)s++;return s!==l.length?t?a.ColorNamesMid[s]():r>a.LumLimitsForHueIndexHigh[s]?a.ColorNamesLight[s]():r<a.LumLimitsForHueIndexLow[s]?a.ColorNamesDark[s]():a.ColorNamesMid[s]():void 0}}a.HexColorMap={"#FFBF00":()=>ExcelCopilotCommandingHitlStrings.ColorAmber,"#F5F5DC":()=>ExcelCopilotCommandingHitlStrings.ColorBeige,"#000000":()=>ExcelCopilotCommandingHitlStrings.ColorBlack,"#5A8AC6":()=>ExcelCopilotCommandingHitlStrings.ColorBlue,"#73d8ff":()=>ExcelCopilotCommandingHitlStrings.ColorBlue,"#CD7F32":()=>ExcelCopilotCommandingHitlStrings.ColorBronze,"#964B00":()=>ExcelCopilotCommandingHitlStrings.ColorBrown,"#c45100":()=>ExcelCopilotCommandingHitlStrings.ColorBrown,"#E1C699":()=>ExcelCopilotCommandingHitlStrings.ColorBrown,"#3B2F2F":()=>ExcelCopilotCommandingHitlStrings.ColorBrunette,"#800020":()=>ExcelCopilotCommandingHitlStrings.ColorBurgundy,"#36454F":()=>ExcelCopilotCommandingHitlStrings.ColorCharcoal,"#4B3621":()=>ExcelCopilotCommandingHitlStrings.ColorMocha,"#FF7F50":()=>ExcelCopilotCommandingHitlStrings.ColorCoral,"#DC143C":()=>ExcelCopilotCommandingHitlStrings.ColorCrimson,"#00FFFF":()=>ExcelCopilotCommandingHitlStrings.ColorCyan,"#00008B":()=>ExcelCopilotCommandingHitlStrings.ColorDarkBlue,"#A9A9A9":()=>ExcelCopilotCommandingHitlStrings.ColorDarkGray,"#006400":()=>ExcelCopilotCommandingHitlStrings.ColorDarkGreen,"#4B0082":()=>ExcelCopilotCommandingHitlStrings.ColorDarkPurple,"#8B0000":()=>ExcelCopilotCommandingHitlStrings.ColorDarkRed,"#50C878":()=>ExcelCopilotCommandingHitlStrings.ColorEmerald,"#FFD700":()=>ExcelCopilotCommandingHitlStrings.ColorGold,"#808080":()=>ExcelCopilotCommandingHitlStrings.ColorGray,"#194d33":()=>ExcelCopilotCommandingHitlStrings.ColorGreen,"#63BE7B":()=>ExcelCopilotCommandingHitlStrings.ColorGreen,"#808900":()=>ExcelCopilotCommandingHitlStrings.ColorGreen,"#b0bc00":()=>ExcelCopilotCommandingHitlStrings.ColorGreen,"#b0bf1a":()=>ExcelCopilotCommandingHitlStrings.ColorGreen,"#cddf19":()=>ExcelCopilotCommandingHitlStrings.ColorGreen,"#E6E6FA":()=>ExcelCopilotCommandingHitlStrings.ColorLavender,"#FFF44F":()=>ExcelCopilotCommandingHitlStrings.ColorLemonYellow,"#ADD8E6":()=>ExcelCopilotCommandingHitlStrings.ColorLightBlue,"#D3D3D3":()=>ExcelCopilotCommandingHitlStrings.ColorLightGray,"#DABDE4":()=>ExcelCopilotCommandingHitlStrings.ColorLightPurple,"#C8A2C8":()=>ExcelCopilotCommandingHitlStrings.ColorLilac,"#00FF00":()=>ExcelCopilotCommandingHitlStrings.ColorLime,"#FF00FF":()=>ExcelCopilotCommandingHitlStrings.ColorMagenta,"#800000":()=>ExcelCopilotCommandingHitlStrings.ColorMaroon,"#E0B0FF":()=>ExcelCopilotCommandingHitlStrings.ColorMauve,"#FFDB58":()=>ExcelCopilotCommandingHitlStrings.ColorMustard,"#000080":()=>ExcelCopilotCommandingHitlStrings.ColorNavyBlue,"#808000":()=>ExcelCopilotCommandingHitlStrings.ColorOliveGreen,"#fb9e00":()=>ExcelCopilotCommandingHitlStrings.ColorOrange,"#FCBF7B":()=>ExcelCopilotCommandingHitlStrings.ColorOrange,"#fe9200":()=>ExcelCopilotCommandingHitlStrings.ColorOrange,"#FFDAB9":()=>ExcelCopilotCommandingHitlStrings.ColorPeach,"#CCCCFF":()=>ExcelCopilotCommandingHitlStrings.ColorPeriwinkle,"#fda1ff":()=>ExcelCopilotCommandingHitlStrings.ColorPink,"#FF9994":()=>ExcelCopilotCommandingHitlStrings.ColorPink,"#FFC0CB":()=>ExcelCopilotCommandingHitlStrings.ColorPink,"#FFC7CE":()=>ExcelCopilotCommandingHitlStrings.ColorPink,"#DDA0DD":()=>ExcelCopilotCommandingHitlStrings.ColorPlum,"#58427C":()=>ExcelCopilotCommandingHitlStrings.ColorPurple,"#800080":()=>ExcelCopilotCommandingHitlStrings.ColorPurple,"#9370DB":()=>ExcelCopilotCommandingHitlStrings.ColorPurple,"#ab149e":()=>ExcelCopilotCommandingHitlStrings.ColorPurple,"#aea1ff":()=>ExcelCopilotCommandingHitlStrings.ColorPurple,"#A52A2A":()=>ExcelCopilotCommandingHitlStrings.ColorRed,"#b10000":()=>ExcelCopilotCommandingHitlStrings.ColorRed,"#DB2D43":()=>ExcelCopilotCommandingHitlStrings.ColorRed,"#E74C3C":()=>ExcelCopilotCommandingHitlStrings.ColorRed,"#F8696B":()=>ExcelCopilotCommandingHitlStrings.ColorRed,"#FF0044":()=>ExcelCopilotCommandingHitlStrings.ColorRed,"#E0115F":()=>ExcelCopilotCommandingHitlStrings.ColorRuby,"#8B2500":()=>ExcelCopilotCommandingHitlStrings.ColorRust,"#F4C430":()=>ExcelCopilotCommandingHitlStrings.ColorSaffron,"#FA8072":()=>ExcelCopilotCommandingHitlStrings.ColorSalmon,"#0F52BA":()=>ExcelCopilotCommandingHitlStrings.ColorSapphire,"#2E8B57":()=>ExcelCopilotCommandingHitlStrings.ColorSeaGreen,"#C0C0C0":()=>ExcelCopilotCommandingHitlStrings.ColorSilver,"#87CEEB":()=>ExcelCopilotCommandingHitlStrings.ColorSkyBlue,"#D2B48C":()=>ExcelCopilotCommandingHitlStrings.ColorTan,"#008080":()=>ExcelCopilotCommandingHitlStrings.ColorTeal,"#40E0D0":()=>ExcelCopilotCommandingHitlStrings.ColorTurquoise,"#EE82EE":()=>ExcelCopilotCommandingHitlStrings.ColorViolet,"#FCFCFF":()=>ExcelCopilotCommandingHitlStrings.ColorWhite,"#FFFFFF":()=>ExcelCopilotCommandingHitlStrings.ColorWhite,"#fcc400":()=>ExcelCopilotCommandingHitlStrings.ColorYellow,"#FFEF9C":()=>ExcelCopilotCommandingHitlStrings.ColorYellow,"#FFFF00":()=>ExcelCopilotCommandingHitlStrings.ColorYellow},a.ColorNamesLight=[()=>ExcelCopilotCommandingHitlStrings.ColorLightOrange,()=>ExcelCopilotCommandingHitlStrings.ColorPink,()=>ExcelCopilotCommandingHitlStrings.ColorLightOrange,()=>ExcelCopilotCommandingHitlStrings.ColorTan,()=>ExcelCopilotCommandingHitlStrings.ColorTan,()=>ExcelCopilotCommandingHitlStrings.ColorLightYellow,()=>ExcelCopilotCommandingHitlStrings.ColorLightYellow,()=>ExcelCopilotCommandingHitlStrings.ColorTan,()=>ExcelCopilotCommandingHitlStrings.ColorLightGreen,()=>ExcelCopilotCommandingHitlStrings.ColorLightGreen,()=>ExcelCopilotCommandingHitlStrings.ColorLightGreen,()=>ExcelCopilotCommandingHitlStrings.ColorLightGreen,()=>ExcelCopilotCommandingHitlStrings.ColorBlue,()=>ExcelCopilotCommandingHitlStrings.ColorBlue,()=>ExcelCopilotCommandingHitlStrings.ColorLightBlueGreen,()=>ExcelCopilotCommandingHitlStrings.ColorPaleBlue,()=>ExcelCopilotCommandingHitlStrings.ColorLightBlue,()=>ExcelCopilotCommandingHitlStrings.ColorBlue,()=>ExcelCopilotCommandingHitlStrings.ColorLightPurple,()=>ExcelCopilotCommandingHitlStrings.ColorLightPurple,()=>ExcelCopilotCommandingHitlStrings.ColorPink,()=>ExcelCopilotCommandingHitlStrings.ColorTan,()=>ExcelCopilotCommandingHitlStrings.ColorRed],a.ColorNamesMid=[()=>ExcelCopilotCommandingHitlStrings.ColorOrange,()=>ExcelCopilotCommandingHitlStrings.ColorRed,()=>ExcelCopilotCommandingHitlStrings.ColorOrange,()=>ExcelCopilotCommandingHitlStrings.ColorBrown,()=>ExcelCopilotCommandingHitlStrings.ColorTan,()=>ExcelCopilotCommandingHitlStrings.ColorGold,()=>ExcelCopilotCommandingHitlStrings.ColorYellow,()=>ExcelCopilotCommandingHitlStrings.ColorGreen,()=>ExcelCopilotCommandingHitlStrings.ColorGreen,()=>ExcelCopilotCommandingHitlStrings.ColorGreen,()=>ExcelCopilotCommandingHitlStrings.ColorGreen,()=>ExcelCopilotCommandingHitlStrings.ColorBrightGreen,()=>ExcelCopilotCommandingHitlStrings.ColorBlueGreen,()=>ExcelCopilotCommandingHitlStrings.ColorBlue,()=>ExcelCopilotCommandingHitlStrings.ColorBlueGreen,()=>ExcelCopilotCommandingHitlStrings.ColorBlue,()=>ExcelCopilotCommandingHitlStrings.ColorBlue,()=>ExcelCopilotCommandingHitlStrings.ColorBlueGray,()=>ExcelCopilotCommandingHitlStrings.ColorPurple,()=>ExcelCopilotCommandingHitlStrings.ColorPurple,()=>ExcelCopilotCommandingHitlStrings.ColorPink,()=>ExcelCopilotCommandingHitlStrings.ColorBrown,()=>ExcelCopilotCommandingHitlStrings.ColorRed],a.ColorNamesDark=[()=>ExcelCopilotCommandingHitlStrings.ColorBrown,()=>ExcelCopilotCommandingHitlStrings.ColorDarkRed,()=>ExcelCopilotCommandingHitlStrings.ColorBrown,()=>ExcelCopilotCommandingHitlStrings.ColorBrown,()=>ExcelCopilotCommandingHitlStrings.ColorBrown,()=>ExcelCopilotCommandingHitlStrings.ColorDarkYellow,()=>ExcelCopilotCommandingHitlStrings.ColorDarkYellow,()=>ExcelCopilotCommandingHitlStrings.ColorBrown,()=>ExcelCopilotCommandingHitlStrings.ColorDarkGreen,()=>ExcelCopilotCommandingHitlStrings.ColorDarkGreen,()=>ExcelCopilotCommandingHitlStrings.ColorDarkGreen,()=>ExcelCopilotCommandingHitlStrings.ColorDarkGreen,()=>ExcelCopilotCommandingHitlStrings.ColorDarkBlueGreen,()=>ExcelCopilotCommandingHitlStrings.ColorDarkBlueGreen,()=>ExcelCopilotCommandingHitlStrings.ColorDarkBlueGreen,()=>ExcelCopilotCommandingHitlStrings.ColorDarkBlue,()=>ExcelCopilotCommandingHitlStrings.ColorDarkBlue,()=>ExcelCopilotCommandingHitlStrings.ColorBlueGray,()=>ExcelCopilotCommandingHitlStrings.ColorDarkPurple,()=>ExcelCopilotCommandingHitlStrings.ColorDarkPurple,()=>ExcelCopilotCommandingHitlStrings.ColorPurple,()=>ExcelCopilotCommandingHitlStrings.ColorBrown,()=>ExcelCopilotCommandingHitlStrings.ColorDarkRed],a.maxRGBValue=255,a.maxHslValue=6*a.maxRGBValue,a.HueLimitsForSatLevel1=[8,0,0,44,0,0,0,63,0,0,122,0,134,0,0,0,0,166,176,241,0,256,0],a.HueLimitsForSatLevel2=[0,10,0,32,46,0,0,0,61,0,106,0,136,144,0,0,0,158,166,241,0,0,256],a.HueLimitsForSatLevel3=[0,8,0,0,39,46,0,0,0,71,120,0,131,144,0,0,163,0,177,211,249,0,256],a.HueLimitsForSatLevel4=[0,11,26,0,0,38,45,0,0,56,100,121,129,0,140,0,180,0,0,224,241,0,256],a.HueLimitsForSatLevel5=[0,13,27,0,0,36,45,0,0,59,118,0,127,136,142,0,185,0,0,216,239,0,256],a.LumLimitsForHueIndexLow=[130,100,115,100,100,100,110,75,100,90,100,100,100,100,80,100,100,100,100,100,100,100,100],a.LumLimitsForHueIndexHigh=[170,170,170,155,170,170,170,170,170,115,170,170,170,170,170,170,170,170,150,150,170,140,165]},46692:(e,t,n)=>{"use strict";var a;n.d(t,{o:()=>a}),function(e){e.DataClassification={EssentialServiceMetadata:1,AccountData:2,SystemMetadata:4,OrganizationIdentifiableInformation:8,EndUserIdentifiableInformation:16,CustomerContent:32,AccessControl:64,PublicNonPersonalData:128,EndUserPseudonymousInformation:256,PublicPersonalData:512,SupportData:1024,DirectMeasurementData:2048,Everything:65535},e.DataFieldType={String:0,Boolean:1,Int64:2,Double:3,Guid:4},e.SamplingPolicy={NotSet:0,Measure:1,Diagnostics:2,CriticalBusinessImpact:191,CriticalCensus:192,CriticalExperimentation:193,CriticalUsage:194},e.PersistencePriority={NotSet:0,Normal:1,High:2},e.CostPriority={NotSet:0,Normal:1,High:2},e.DataCategories={NotSet:0,SoftwareSetup:1,ProductServiceUsage:2,ProductServicePerformance:4,DeviceConfiguration:8,InkingTypingSpeech:16},e.DiagnosticLevel={ReservedDoNotUse:0,Required:10,BasicEvent:10,Optional:100,FullEvent:100,RequiredServiceData:110,NecessaryServiceDataEvent:110,RequiredServiceDataForEssentialServices:120,AlwaysOnNecessaryServiceDataEvent:120},e.DnmInterval={Hourly:1,Daily:2},e.AllowedPartA={ReleaseAudienceGroup:1,WacRing:2,AppName:3,AppPlatform:4,AppVersion:5},e.CustomerContentType={None:0,MocaAddIn:1},e.LogLevel={Error:0,Warning:1,Info:2,Verbose:3},e.Category={Core:0,Sink:1,Transport:2},e.PrimaryIdentitySpace={UserObjectId:"UserObjectId",MSACID:"MSACID",OrgIdPuid:"OrgIdPuid",OrgIdPUID:"OrgIdPUID",OrgIdCID:"OrgIdCID",MsaPuid:"MsaPuid",MSAPUID:"MSAPUID",WopiAuth:"WopiAuth",ThirdParty:"ThirdParty",Other:"Other"},e.AudienceGroup={Automation:"Automation",Dogfood:"Dogfood",Microsoft:"Microsoft",Insiders:"Insiders",Production:"Production"},e.QosPillarName={Interruptions:"Interruptions",Open:"Open",Save:"Save",RealTimeCoauth:"RealTimeCoauth",NotebookNavigation:"NotebookNavigation",Fidelity:"Fidelity",AsyncCollab:"AsyncCollab",Present:"Present",ContentConsumption:"ContentConsumption",ContentCreation:"ContentCreation"}}(a||(a={}))},50863:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var a=n(83437),o=n(855391),r=n(75496),i=n(316904),l=n(857677),s=n(92520),c=n(507628);class d{succeed(e){this.endCalled&&this.sendError(`Telemetry already ended for ${this.operationType}.`,a.$b.Warning,0),(0,s.cY)(`MakerStorageTelemetry sending succeed for ${this.operationType}`,e,{id:this.id}),e.operationType=`${this.operationType}.Succeeded`,e.duration=Date.now()-this.createdTime,this.sendTelemetryEvent(e),this.endCalled=!0}fail(e,t,n){this.endCalled&&this.sendError(`Telemetry already ended for ${this.operationType}.`,a.$b.Warning,0),(0,s.cY)(`MakerStorageTelemetry sending fail for ${this.operationType}`,e,t,n,{id:this.id}),t.operationType=`${this.operationType}.Failed`,t.level=e,t.error=this.stringifyError(n),t.duration=Date.now()-this.createdTime,this.sendTelemetryEvent(t),this.endCalled=!0}sendStart(e){(0,s.cY)(`MakerStorageTelemetry sending start for ${this.operationType}`,e,{id:this.id}),e.operationType=`${this.operationType}.Start`,this.sendTelemetryEvent(e)}sendTelemetryEvent(e){e.Id=this.id;const t=[];Object.keys(e).forEach((n=>{t.push({key:n,value:e[n]})}));const n={eventType:this.eventType,eventData:t};i.M.getInstance().logEvent(n)}sendError(e,t,n){const o={eventType:r.S2.MakerStorageEvent,errorMessage:"",logLevel:a.$b.Error},s=[{key:l.dA.ErrorMessage,value:e},{key:l.dA.LogLevel,value:t},{key:l.dA.TimeOut,value:n},{key:l.dA.Id,value:this.id}];i.M.getInstance().logError(o,void 0,s)}stringifyError(e){return e instanceof Error?e.message:e instanceof o.qD?JSON.stringify({message:e.message,errorCode:e.errorCode}):e instanceof o.Je?JSON.stringify({message:e.message,status:e.status,errorCode:e.errorCode}):e.toString()}constructor(e,t=[]){this.eventType=r.S2.MakerStorageEvent,this.endCalled=!1,this.createTimeout=(e,t)=>{(0,s.uk)(t).then((()=>{this.endCalled||this.sendError(`Telemetry Activity timed out waiting for ${this.operationType}`,e,t)}))},this.id=(0,c.A)(),this.createdTime=Date.now(),this.operationType=e,t.forEach((e=>{this.createTimeout(e.level,e.timeout)}))}}},54947:e=>{"use strict";e.exports=JSON.parse('{"G":{"O":"to whole table"}}')},57852:(e,t,n)=>{"use strict";n.d(t,{g:()=>x});var a,o,r,i=n(233812),l=n(408295),s=n(207545),c=n(265167),d=n(70239),u=n(426689),m=n(83437),g=n(660606),h=n(225014),p=n(423905),b=n(638753),f=n(822606),C=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{s(a.next(e))}catch(e){r(e)}}function l(e){try{s(a.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((a=a.apply(e,t||[])).next())}))},y=function(e,t){var n,a,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(n=1,a&&(o=2&l[0]?a.return:l[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,l[1])).done)return o;switch(a=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,a=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],a=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}};function v(e){return C(this,void 0,void 0,(function(){var t;return y(this,(function(n){switch(n.label){case 0:return(0,g.cY)("Activating User Context Annotation"),function(){(0,g.cY)("Fetching AL Session");var e=s.kH.getSettingAsString(s.zj.AugloopSharedSessionID);o=(0,h.wB)((0,b.hX)(e)?"ALDummySession":e)}(),[4,o.activateAnnotation(i.i.getTypeName(),{callback:function(t){return function(e,t){(0,g.cY)("Entering user Context Annotation handler"),g.EG.updateTelemetryOnAnnotationReceived(i.i.getTypeName(),void 0,m.CT.UserContextResponseTime,f.u1,void 0,r);for(var n=0,a=e.items;n<a.length;n++){var o=a[n];o.body&&i.i.typeGuard(o.body)&&S(o,t)}}(t,e)}})];case 1:return t=n.sent(),a=t.token,(0,g.cY)("User Context Annotation activated with token: "+a),[2]}}))}))}function T(){return C(this,void 0,void 0,(function(){var e;return y(this,(function(t){switch(t.label){case 0:(0,g.cY)("Releasing User Context Annotation with token: "+a),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,o.releaseAnnotation(a)];case 2:return t.sent(),[3,4];case 3:return e=t.sent(),(0,g.cY)("Error while releasing User Context Annotation: "+e),[3,4];case 4:return(0,g.cY)("User Context Released"),[2]}}))}))}function x(e){return C(this,void 0,void 0,(function(){var t,n,a,i,s;return y(this,(function(h){switch(h.label){case 0:return(0,g.cY)("Sending signal to Copilot Warmup Flow"),t=(new Date).getTime(),[4,v(e)];case 1:h.sent(),(0,g.cY)("User Context Annotation Time is "+(0,u.W)(t)),g.EG.sendLatencyTelemetry((0,p.pN)(((i={})[m.CT.UserContextAnnotationActivationTime]=(0,u.W)(t),i))),n=new d.g0({parentPath:["Signal",l.P.getTypeName()],items:[{id:c.r.generateId(),body:new l.P}]}),a=l.P.getTypeName(),(0,g.cY)("Submitting User Context signal"+JSON.stringify(n)),r=(new Date).getTime();try{o.submitOperation(n)}catch(e){(0,g.cY)("Error while submitting signal to Copilot Warmup Flow"+e)}return(0,g.cY)("User Context signal submitted..."),g.EG.sendChatEventTelemetry((0,p.pN)(((s={})[m.h3.ChatEventType]=m.a5.UserContextSignalSubmitted,s[m.h3.ChatEventParameters]=a,s))),[2]}}))}))}function S(e,t){return C(this,void 0,void 0,(function(){var n,a,o,r,i;return y(this,(function(l){switch(l.label){case 0:return(0,g.cY)("Entering user Context Annotation item handler"),e.body?(n=e.body.userType,(0,g.cY)("User Type returned is: ",n),a=null===(i=e.body)||void 0===i?void 0:i.isEUDBUser,(0,g.cY)("isEUDBUser returned is: ",a),n?(g.EG.sendChatEventTelemetry((0,p.pN)(((o={})[m.h3.ChatEventType]=m.a5.ALUserType,o[m.h3.ChatEventParameters]=(0,b.nh)(n),o))),t(n,a),[4,T()]):[3,2]):[2];case 1:return l.sent(),(0,g.cY)("User Context Annotation Released"),[3,3];case 2:g.EG.sendChatEventTelemetry((0,p.pN)(((r={})[m.h3.ChatEventType]=m.a5.ALUserType,r[m.h3.ChatEventParameters]="UserTypeNotFound",r))),l.label=3;case 3:return[2]}}))}))}},59653:(e,t,n)=>{"use strict";n.d(t,{p:()=>Nt});var a,o=n(279395),r=n(702864),i=n(83437),l=n(328831),s=n(354535),c=n(822606),d=n(241273),u=n(817990),m=n(448514),g=n(308849),h=n(951903),p=n(638753),b=n(755657),f=n(207545),C=n(764081),y=n(448526),v=n(653972),T=n(293879),x=n(70239),S=n(792168),w=n(639765),E=n(548366),I=n(40413),R=n(384169);!function(e){e.getInsights="getInsights",e.getColumnsFromNL="getColumnsFromNL",e.getColumnsGeneral="getColumnsGeneral",e.getConditionalFormatSuggestion="getConditionalFormatSuggestion",e.transformTableFromNL="transformTableFromNL",e.getTableSummary="getTableSummary",e.getCellsFromNL="getCellsFromNL"}(a||(a={}));const A={getInsights:'[\n    {\n        "name": "selectTables",\n        "returns": "activeTables",\n        "arguments": {}\n    },\n    {\n        "name": "getInsights",\n        "returns": null,\n        "arguments": {\n            "tables": {\n                "type": "var",\n                "name": "activeTables"\n            },\n            "instruction": {\n              "type": "string",\n              "string": "{{messageText}}"\n            }\n        }\n    }\n]',getColumnsFromNL:'[\n{\n    "name": "selectTables",\n    "returns": "activeTables",\n    "arguments": {}\n},\n{\n    "name": "addCalculatedColumns",\n    "returns": null,\n    "arguments": {\n        "tables": {\n            "type": "var",\n            "name": "activeTables"\n        },\n        "instruction": {\n            "type": "string",\n            "string": "{{messageText}}"\n        }\n    }\n}\n]',getCellsFromNL:'[\n  {\n      "name": "selectTables",\n      "returns": "activeTables",\n      "arguments": {}\n  },\n  {\n      "name": "aggregateColumns",\n      "returns": null,\n      "arguments": {\n          "tables": {\n              "type": "var",\n              "name": "activeTables"\n          },\n          "instruction": {\n              "type": "string",\n              "string": "{{messageText}}"\n          },\n          "cell": {},\n      }\n  }\n  ]',getColumnsGeneral:'[\n{\n  "name": "selectTables",\n  "returns": "activeTables",\n  "arguments": {}\n},\n{\n  "name": "addCalculatedColumns",\n  "returns": null,\n  "arguments": {\n      "tables": {\n          "type": "var",\n          "name": "activeTables"\n      }\n  }\n}\n]',transformTableFromNL:'[\n{\n  "name": "selectTables",\n  "returns": "activeTables",\n  "arguments": {}\n},\n{\n  "name": "transformTable",\n  "returns": null,\n  "arguments": {\n    "tables": {\n        "type": "var",\n        "name": "activeTables"\n    },\n    "instruction": {\n        "type": "string",\n        "string": "{{messageText}}"\n    }\n}\n}\n]',getTableSummary:'[\n{\n    "name": "selectTables",\n    "returns": "activeTables",\n    "arguments": {}\n},\n{\n    "name": "summarizeTable",\n    "returns": null,\n    "arguments": {\n        "tables": {\n            "type": "var",\n            "name": "activeTables"\n        }\n    }\n}\n]',getConditionalFormatSuggestion:'[\n{\n    "name": "selectTables",\n    "returns": "activeTables",\n    "arguments": {}\n},\n{\n    "name": "conditionalFormatSuggestionPill",\n    "returns": null,\n    "arguments": {\n        "tables": {\n            "type": "var",\n            "name": "activeTables"\n        }\n    }\n}\n]'};var L=n(737649),k=n(379422),F=n(12855),_=n(416135),P=n(881707),N=n(182238),M=n(178365),O=n(831922),D=n(867202),B=n(817685),$=n(75496),H=n(793868),U=n(367980),q=n(705147),V=n(616166),W=n(648982),G=n(656931),z=n(540598),Q=n(363496),j=n(675327),J=n(552398),Y=n(764738),X=n(307053),Z=n(928981),K=n(274852),ee=n(995842),te=n(790900),ne=n(248967),ae=n(429257),oe=n(891693),re=n(517582),ie=n(197665),le=n(795167),se=n(1789),ce=n(632769),de=n(260197),ue=n(749832),me=n(274576),ge=n(8403),he=n(306148),pe=n(857677),be=n(639969),fe=n(100062),Ce=n(545564),ye=n(1329),ve=n(291436),Te=n(857786),xe=n(698013),Se=n(798110),we=n(623160),Ee=n(693226),Ie=n(255507),Re=n(76872),Ae=n(316904),Le=n(859981),ke=n(92520),Fe=n(14149),_e=n(314793),Pe=n(695934),Ne=n(347145);const Me=[X.yZ.getTypeName(),z.qS.getTypeName(),j.g_.getTypeName(),j.PM.getTypeName(),j.B3.getTypeName(),j.NL.getTypeName(),j.oj.getTypeName(),Pe.Yc.getTypeName()];function Oe(){const e=[],t={staticStrings:[{key:"formulaError",value:(0,o.Obq)()},{key:"externalWorkbookFormulaError",value:o.olU.ElseExternalWorkbookFormulaError},{key:"securityBlockedFormulaError",value:o.olU.ElseSecurityBlockedFormulaError},{key:"raiError",value:(0,o.KC)()},{key:"fallbackLatencyMessage",value:(0,o.I3c)()},...(0,Ne.yw9)("OfficeVSO_8656872_ConsumeNewRaiErrorString")?[{key:"raiErrorSuccessfulActionBlockedResponse",value:(0,o.b4o)()}]:[],{key:"generalError",value:(0,o.UuN)()},...(0,Ne.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.SearchAndActionErrorImproved",!1)?[{key:"searchChainingError",value:(0,o.AUM)()}]:[{key:"searchChainingError",value:(0,o.RVs)()}],{key:"noTableError",value:(0,o.SCL)()},{key:"imageChatChainingError",value:(0,o.sWz)()}]},n=!1;return e.push({workflowAnnotationType:L.Yn.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:_e.R.getAugloopWorkflowTimeout(),config:t}),(0,Ne.KV_)()&&!(0,Ne.Jym)()&&e.push({workflowAnnotationType:Z.l.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1,augloopResponseTimeout:_e.R.getAugloopWorkflowTimeout()}),e.push({workflowAnnotationType:Fe.w.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!1,augloopResponseTimeout:_e.R.getAugloopWorkflowTimeout()}),e.push({workflowAnnotationType:we.Pd.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!0,augloopResponseTimeout:_e.R.getChatHistoryWorkflowTimeout()}),e.push({workflowAnnotationType:X.yZ.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:n,augloopResponseTimeout:_e.R.getAugloopWorkflowTimeout(),forceReturnCachedAnnotations:!0,activateAnnotationInALRequestResponse:!!(0,Ne.NT7)()||void 0}),(0,Ne.Y$0)()&&e.push({workflowAnnotationType:z.qS.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:n,augloopResponseTimeout:_e.R.getAugloopWorkflowTimeout(),forceReturnCachedAnnotations:!0,activateAnnotationInALRequestResponse:!!(0,Ne.NT7)()||void 0}),e.push({workflowAnnotationType:R.lL.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:n,augloopResponseTimeout:_e.R.getAugloopWorkflowTimeout()}),e.push({workflowAnnotationType:R.Dv.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:n,augloopResponseTimeout:_e.R.getAugloopWorkflowTimeout()}),(0,Ne.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.FormulaGenerationNewNlToFormulaSkill",!1)&&e.push({workflowAnnotationType:R.sG.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:n,augloopResponseTimeout:_e.R.getAugloopWorkflowTimeout()}),(0,Ne.eFk)()&&e.push({workflowAnnotationType:j.PM.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:n,augloopResponseTimeout:_e.R.getAugloopWorkflowTimeout()},{workflowAnnotationType:j.B3.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:n,augloopResponseTimeout:_e.R.getAugloopWorkflowTimeout()}),(0,Ne.lht)()&&e.push({workflowAnnotationType:j.g_.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:n,augloopResponseTimeout:_e.R.getAugloopWorkflowTimeout()},{workflowAnnotationType:j.NL.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:n,augloopResponseTimeout:_e.R.getAugloopWorkflowTimeout()},{workflowAnnotationType:j.oj.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:n,augloopResponseTimeout:_e.R.getAugloopWorkflowTimeout()}),((0,Ne.eFk)()||(0,Ne.lht)())&&e.push({workflowAnnotationType:j.NU.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:n,augloopResponseTimeout:_e.R.getAugloopWorkflowTimeout()}),(0,Ne.UDM)()&&(e.push({workflowAnnotationType:Y.bV.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:n,augloopResponseTimeout:_e.R.getAugloopWorkflowTimeout()}),(0,Ne.iPS)("Microsoft.Office.Excel.FA000000124.ImportDataEnableRelevancyCheck",!0)&&e.push({workflowAnnotationType:Y.Dd.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:n,augloopResponseTimeout:_e.R.getAugloopWorkflowTimeout()})),e.push({workflowAnnotationType:N.b.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:_e.R.getAugloopWorkflowTimeout()}),(0,Ne.WFw)()&&e.push({workflowAnnotationType:le.uC.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1,augloopResponseTimeout:_e.R.getAugloopWorkflowTimeout()}),e.push({workflowAnnotationType:B.d.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!1}),(0,Ne.jGm)()&&e.push({workflowAnnotationType:Q.f.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1,augloopResponseTimeout:_e.R.getAugloopWorkflowTimeout()}),(0,Ne.JZX)()&&e.push({workflowAnnotationType:Pe.Yc.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),((0,Ne.IU1)()||(0,Ne.GBi)())&&(e.push({workflowAnnotationType:te.j5.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),e.push({workflowAnnotationType:te.hM.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),e.push({workflowAnnotationType:te.OE.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),e.push({workflowAnnotationType:te.Ex.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),e.push({workflowAnnotationType:te.Ww.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1})),(0,Ne.jGm)()&&(0,Ne.IU1)()&&e.push({workflowAnnotationType:te.fm.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),e}var De=n(860730),Be=n(823465);class $e{async handleSharedLoggingEvent({event:e,args:t}){switch((0,ke.cY)("client logging event received\n\tevent - ",e,"\n\targs: ",t),e){case v.Yk.ALSessionInitialized:return this.onALSessionInitialized(t);case v.Yk.AnnotationActivated:return this.onAnnotationActivated(t);case v.Yk.AugloopErrorReceived:return this.onAugloopErrorReceived(t);case v.Yk.ChatHistorySignalSent:return this.onChatHistorySignalSent(t);case v.Yk.ChatHistoryResponseReceived:return this.onChatHistoryResponseReceived(t);case v.Yk.ChatPaneInitalized:return this.onChatPaneInitialized(t);case v.Yk.ChatPaneLoaded:return this.onChatPaneLoaded(t);case v.Yk.CopyButtonClicked:return this.onCopyButtonClicked(t);case v.Yk.SubmitButtonClicked:return this.onSubmitButtonClicked(t);case v.Yk.MenuButtonItemClicked:return this.onMenuButtonItemClicked({event:e,args:t});case v.Yk.SuggestionPillClicked:return this.onSuggestionPillClicked(t);case v.Yk.ZQMLoaded:return this.onZQMLoaded({event:e,args:t});case v.Yk.ZQMButtonItemClicked:return this.onZQMButtonItemClicked({event:e,args:t});default:return this.defaultCallback({event:e,args:t})}}defaultCallback(e){this.telemetryEventHandler.updateTelemetryChatEventData({[pe.h3.ChatEventType]:pe.a5.SharedCopilotChatLogEvent,[pe.h3.ChatEventParameters]:JSON.stringify(e)},this.telemetryLogger)}onChatPaneInitialized(e){this.copilotChatBootStartTime=e?.timestamp??Date.now()}onAugloopErrorReceived(e){const t=JSON.parse(e?.chatEventParams??"{}");this.telemetryLogger.logError({eventType:$.S2.Augloop,logLevel:i.$b.Warning,errorMessage:`Augloop Error: code - ${t?.errorCode}`},this.telemetryLogger.getDefaultEventFlags())}onALSessionInitialized(e){const t=this.getDurationInSeconds(this.copilotChatBootStartTime,void 0,e?.timeInMs);this.telemetryEventHandler.updateTelemetryLatencyData({[pe.CT.AugloopInitializationTime]:t},this.telemetryLogger)}onAnnotationActivated(e){const t=this.getDurationInSeconds(this.copilotChatBootStartTime,void 0,e?.timeInMs);this.telemetryEventHandler.updateTelemetryChatEventData({[pe.h3.ChatEventType]:pe.a5.AnnotationActivated,[pe.h3.ChatEventParameters]:JSON.stringify({activeAnnotations:this.getActiveAnnotationTypes()})},this.telemetryLogger),this.telemetryEventHandler.updateTelemetryLatencyData({[pe.CT.AnnotationActivationTime]:t},this.telemetryLogger)}onChatHistorySignalSent(e){e&&e.operationType===Ee.S5.GetCurrentChatOperation&&(this.chatHistorySignalTime=e.timestamp??Date.now())}onChatHistoryResponseReceived(e){if(!e||e.operationType!==Ee.S5.GetCurrentChatOperation)return;const t=this.getDurationInSeconds(this.chatHistorySignalTime,void 0,e?.timeInMs);this.telemetryEventHandler.updateTelemetryChatEventData({[pe.h3.ChatEventType]:pe.a5.ChatHistoryLoaded},this.telemetryLogger),this.telemetryEventHandler.updateTelemetryLatencyData({[pe.CT.ChatHistoryLoadTime]:t},this.telemetryLogger)}onChatPaneLoaded(e){const t=this.getDurationInSeconds(this.copilotChatBootStartTime,e?.timestamp);this.telemetryEventHandler.updateTelemetryChatEventData({[pe.h3.ChatEventType]:pe.a5.ChatPaneLoaded,[pe.h3.ChatEventParameters]:JSON.stringify({copilotEntryPoint:ue.V.getSettingAsString(ue.z.CopilotEntryPoint)})},this.telemetryLogger),this.telemetryEventHandler.updateTelemetryLatencyData({[pe.CT.ChatPaneLoadTime]:t},this.telemetryLogger)}onCopyButtonClicked(e){this.telemetryEventHandler.updateTelemetryChatEventData({[pe.h3.ChatEventType]:pe.a5.CopyButtonClicked},this.telemetryLogger)}onSubmitButtonClicked(e){this.telemetryEventHandler.updateTelemetryChatEventData({[pe.h3.ChatEventType]:pe.a5.SubmitButtonClicked},this.telemetryLogger)}static handleZqmLoadedLoggingEvent(e){const t=(0,De.dW)(),n=(0,De.eD)();for(const a of e?.promptSuggestionList??[])switch(a.suggestionText){case t[Le.fM.Search]:Ie.B.getInstance().logSeenEvent(pe.q.Search);break;case t[Le.fM.FormulaAction]:case n[Le.X6.SuggestColumn]:case n[Le.X6.WriteFormula]:case n[Le.X6.AddFormulaColumn]:case n[Le.X6.SplitColumns]:case n[Le.X6.LookupFormula]:Ie.B.getInstance().logSeenEvent(pe.q.CalculatedColumns);break;case n[Le.X6.TotalRow]:Ie.B.getInstance().logSeenEvent(pe.q.CalculatedRows);break;case t[Le.fM.HowToSum]:case n[Le.X6.ExplainFormula]:case n[Le.X6.InvestigateError]:case n[Le.X6.CreateTable]:case n[Le.X6.KeyboardShortcuts]:case n[Le.X6.TipsAndTricks]:case n[Le.X6.FreezeColumn]:case n[Le.X6.HowToCreateDropdown]:(0,Be.mN)();break;case n[Le.X6.GetDataInsights]:case n[Le.X6.PerformForecasting]:case n[Le.X6.CreateBoxplot]:case n[Le.X6.SetOfCharts]:case n[Le.X6.GenerateWordCloud]:Ie.B.getInstance().logSeenEvent(pe.q.Answers);break;case t[Le.fM.Python]:case n[Le.X6.AdvancedAnalysis]:{let e=pe.q.Python;if((0,Ne.ggM)()&&(e=pe.q.Answers),(0,Ne.yw9)("OfficeVSO_10385590_addSubFeatureNameForAnswers")){let t=pe.BJ.Python;(0,Ne.ggM)()&&(t=pe.BJ.Answers),Ie.B.getInstance().logSeenEvent(t,e)}else Ie.B.getInstance().logSeenEvent(e);break}case n[Le.X6.DataPreparation]:Ie.B.getInstance().logSeenEvent(pe.q.DataShaping);break;case t[Le.fM.Insights]:case n[Le.X6.SummarizeColumn]:case n[Le.X6.ShowDataInsights]:case n[Le.X6.CreatePivotTable]:case n[Le.X6.CreatePieChart]:case n[Le.X6.GenerateGraph]:Ie.B.getInstance().logSeenEvent(pe.q.AnalyzeData);break;case t[Le.fM.HighlightAction]:case n[Le.X6.HighlightCells]:case n[Le.X6.ApplyColorCoding]:Ie.B.getInstance().logSeenEvent((0,Ne.yw9)("OfficeVSO_9564930_SplitCommandingTelemetry")?pe.q.ConditionalFormatting:pe.q.Commanding);break;case n[Le.X6.WebSearchCreateTable]:case n[Le.X6.WebSearchLearn]:case n[Le.X6.ImportTable]:case n[Le.X6.PrepareForMeetings]:Ie.B.getInstance().logSeenEvent(pe.q.Search);break;default:Ie.B.getInstance().logSeenEvent(pe.q.CopilotChat)}}sendLoggingEventToPane(e,t){switch(this.telemetryLogger||(this.telemetryLogger=Ae.M.getInstance()),e){case v.Yk.ZQMLoaded:(0,ke.cY)("ZQM Loaded: ${loggingEventArgs}"),$e.handleZqmLoadedLoggingEvent(this.zeroQueryMessageProps);break;case v.Yk.MenuButtonItemClicked:(0,ke.cY)(`Menu Button Item Clicked: ${t}`)}}onZQMButtonItemClicked({event:e,args:t}){this.telemetryLogger.setQuerySource(pe.BC.ZQM),Ie.B.getInstance().setQuerySource(pe.BC.ZQM),this.defaultCallback({event:e,args:t})}onZQMLoaded({event:e,args:t}){this.sendLoggingEventToPane(e,t)}onMenuButtonItemClicked({event:e,args:t}){this.telemetryLogger.setQuerySource(pe.BC.MenuItem),Ie.B.getInstance().setQuerySource(pe.BC.MenuItem),this.sendLoggingEventToPane(e,t)}onSuggestionPillClicked(e){this.telemetryLogger.setQuerySource(pe.BC.SuggestionPill),Ie.B.getInstance().setQuerySource(pe.BC.SuggestionPill),this.telemetryEventHandler.updateTelemetryChatEventData({[pe.h3.ChatEventType]:pe.a5.BasicChatSuggestionClicked},this.telemetryLogger)}getDurationInSeconds(e,t,n){return n?this.toSeconds(n):this.toSeconds((t??Date.now())-e)}toSeconds(e){return e/1e3}getActiveAnnotationTypes(){return Oe().map((e=>e.workflowAnnotationType))}constructor(e){this.telemetryLogger=Ae.M.getInstance(),this.telemetryEventHandler=Re.E.getInstance(),this.copilotChatBootStartTime=0,this.chatHistorySignalTime=0,this.zeroQueryMessageProps={promptSuggestionList:[]},this.zeroQueryMessageProps=(0,De.uC)(e)}}var He=n(769506),Ue=n(330123),qe=n(721794),Ve=n(109174);class We{getIsWorkflowInProgress(){return void 0!==this.workflowStartTime}getShouldAlertUser(){return this.getIsWorkflowInProgress()&&!this.hasAlertedUserForThisWorkflowRun&&!Ve.CP.pythonContextManager.isPythonMode}setWorkflowStarted(){this.workflowStartTime=(new Date).getTime()}setWorkflowEnded(){this.workflowEndTime=(new Date).getTime(),this.workflowStartTime&&this.telemetryEventHandler.logLatency((0,m.x)(this.workflowStartTime),pe.OP.XLIMWorkflowDuration),this.lastUserSubmitWhileWorkflowRunningTime&&this.telemetryEventHandler.logLatency((0,m.x)(this.lastUserSubmitWhileWorkflowRunningTime),pe.OP.SubmitToXLIMWorkflowComplete),this.reset()}handleQuerySubmittedWhileWorkflowRunning(){this.lastUserSubmitWhileWorkflowRunningTime=(new Date).getTime(),this.hasAlertedUserForThisWorkflowRun=!0}handleRecognizedTableAnnotationsReceived(){this.workflowEndTime&&this.telemetryEventHandler.logLatency((0,m.x)(this.workflowEndTime),pe.OP.XLIMWorkflowCompleteToAnnotationsReceived)}reset(){this.workflowStartTime=void 0,this.lastUserSubmitWhileWorkflowRunningTime=void 0,this.hasAlertedUserForThisWorkflowRun=!1}constructor(){this.telemetryEventHandler=Re.E.getInstance(),this.workflowStartTime=void 0,this.workflowEndTime=void 0,this.lastUserSubmitWhileWorkflowRunningTime=void 0,this.hasAlertedUserForThisWorkflowRun=!1}}We.XLIMProgressFlowId="XLIMProgressFlow";var Ge=n(664007),ze=n(650444),Qe=n(261720),je=n(469486),Je=n(468967),Ye=n(694592),Xe=n(995619),Ze=n(672270),Ke=n(857070),et=n(546756),tt=n(281161),nt=n(888520),at=n(795786),ot=n(507628);async function rt(e,t){const n=(0,ot.A)(),a=(0,ot.A)();if(!t)return await async function(e,t,n,a){const r={success:!1,sessionId:a,errorSource:t,errorCode:n};try{let t=e((0,be.SW)()).started?(0,o.$oZ)():(0,o.A99)();switch(n){case"QueryTable":t=(0,o.bLM)();break;case"StepFromNLFailure":case"QueryFromNLFailure":case"QueryFromNLGiveup":t=(0,o.kSh)();break;case"NoRange":case"TableNotFound":t=(0,o.eMD)();break;case"PowerQueryApiFailure":case"ExplanationFailure":case"BaseQueryFailure":case"UnexpectedError":break;default:(0,nt.x)(n)}(0,ke.cY)(`showDataShapingErrorMessage: ${t}`),await ae.s.getInstance().NativeServices.IDataShapingPrivateSdxApiService.value.showErrorMessage(t),r.success=!0}finally{Re.E.getInstance().updateTelemetryChatEventData({[pe.h3.ChatEventType]:pe.a5.DataShapingShowErrorCard,[pe.h3.ChatEventParameters]:JSON.stringify(r)},Ae.M.getInstance())}}(e,"EnterMode","TableNotFound"),void(0,Ye.vo)();const r={success:!1,requestId:a,sessionId:n},l=ae.s.getInstance().NativeServices.IDataShapingPrivateSdxApiService.value;try{(0,ke.cY)("enterShapingModeForDA called with tableName:",t);const i=await Nt.getInstance().getALSession();if((0,Ne.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.ExcelDataShapingWorkflowContext",!1)){const e=new x.g0({parentPath:["Signal",et.Lg.getTypeName()],items:[{id:a,body:new et.Lg({requestId:a,conversationId:(0,ot.A)(),tableId:t,dataShapingSessionId:n,enableDebugging:(0,ke.K_)()})}]});i.submitOperation(e)}const s={annotationType:[j.oj.getTypeName(),j.NL.getTypeName()],transientItems:[{parentPath:["Signal",et.Lg.getTypeName()],id:ye.r.generateId(),body:new et.Lg({requestId:a,conversationId:(0,ot.A)(),tableId:t,dataShapingSessionId:n,enableDebugging:(0,ke.K_)()})}],maxDelayMs:3e4,sourceInfo:{}},c=i.getAnnotations(s),d=await async function(e){for await(const t of e){if(t.error?.clientError||t.error?.workflowError||t.error?.serviceError||t.error?.serverError)throw new Error(`getFirstShapingStartAnnotation: Client error: ${t.error.clientError}, Workflow error: ${t.error.workflowError}, Service error: ${t.error.serviceError}, Server error: ${t.error.serverError}`);if(!(t.content.length<=0)&&t.content[0].body&&(j.NL.typeGuard(t.content[0].body)||j.oj.typeGuard(t.content[0].body)))return t.content[0].body}throw new Error("getFirstShapingStartAnnotation: No annotations found.")}(c);if(j.NL.typeGuard(d))throw new Error("Failed to start data shaping mode.");{const t={requestId:a,sessionId:d.dataShapingSessionId,queryName:d.queryName,mashupDocument:d.mashupDocument,tableName:d.tableId,queryScript:d.queryScript};e(Ge.m.enterDataShapingMode(t)),async function(e,t){const n=ae.s.getInstance().NativeServices.IDataShapingPrivateSdxApiService.value,a=n.onQueryScriptChanged.subscribe((async n=>{const a={started:!1,disableQueryScriptUpdates:!1,requestId:t.requestId,sessionId:t.sessionId};try{const o=e((0,be.SW)());if(a.started=o.started,!o.started)return;const r=new x.g0({parentPath:["Signal",et.U$.getTypeName()],items:[{id:t.requestId,body:new et.U$({requestId:t.requestId,conversationId:t.requestId,queryScript:n,enableDebugging:(0,ke.K_)()})}]});(await Nt.getInstance().getALSession()).submitOperation(r),(0,he.s_)(he.H0.DisableUndo)}finally{Re.E.getInstance().updateTelemetryChatEventData({[pe.h3.ChatEventType]:pe.a5.DataShapingQueryScriptChanged,[pe.h3.ChatEventParameters]:JSON.stringify(a)},Ae.M.getInstance())}})),r=n.onPreviewClosed.subscribe((async i=>{const l={reason:i,requestId:t.requestId,sessionId:t.sessionId};try{"FAILURE"!==i&&"ERROR"!==i||(await lt(e,i,!0,"Discard"),n.showErrorMessage((0,o.y3x)()))}finally{try{a.unsubscribe(),r.unsubscribe()}catch{}Re.E.getInstance().updateTelemetryChatEventData({[pe.h3.ChatEventType]:pe.a5.DataShapingPreviewClosed,[pe.h3.ChatEventParameters]:JSON.stringify(l)},Ae.M.getInstance())}}));await n.startPreview(t.queryName,t.mashupDocument,t.tableName);const i=JSON.stringify({queryScript:t.queryScript});at.n.displayDataShapingIntroResponse(i,t.requestId)}(e,t),(0,Ne.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.ExcelDataShapingClientStore",!1)||await i.activateServerRequestResponse(j.ik.getTypeName(),{onAnnotationCallback:async(t,n)=>{let a;const o={success:!1,started:!1,sessionId:""};try{try{const n=e((0,be.SW)());o.started=n.started,n.started&&(o.sessionId=n.sessionId),await l.updateQueryScript(t.queryScript);const r=await l.getQueryScript();a={dataShapingSessionId:t.dataShapingSessionId,success:!0,actualQueryScriptOrError:r},o.success=!0}catch(e){a={dataShapingSessionId:t.dataShapingSessionId,success:!1,actualQueryScriptOrError:e.message}}await n(new j.vH(a))}finally{Re.E.getInstance().updateTelemetryChatEventData({[pe.h3.ChatEventType]:pe.a5.DataShapingEditQuery,[pe.h3.ChatEventParameters]:JSON.stringify(o)},Ae.M.getInstance())}}}),r.success=!0}}catch(t){Ae.M.getInstance().logError({eventType:$.S2.DataShaping,errorMessage:`got error during handling start mode: ${t} (${JSON.stringify(t)})`,logLevel:i.$b.Error}),await l.showErrorMessage((0,o.A99)()),await lt(e,"ERROR",!0,"Discard")}finally{Re.E.getInstance().updateTelemetryChatEventData({[pe.h3.ChatEventType]:pe.a5.DataShapingAgentStartMode,[pe.h3.ChatEventParameters]:JSON.stringify(r)},Ae.M.getInstance())}}async function it(e,t,n){let a="DECLINE";const r={success:!1,exitModeError:!1,started:!1,sessionId:"",exitReason:n};try{const l=e((0,be.SW)());let s;switch(r.started=l.started,l.started&&(r.sessionId=l.sessionId),n){case"ReplaceTable":s="replace";break;case"NewSheet":s="newSheet";break;default:s="discard"}const c=ae.s.getInstance().NativeServices.IDataShapingPrivateSdxApiService.value;try{a=(await(0,tt.ci)(e,s)).reason,r.success=!0}catch(e){r.exitModeError=!0,await c.showErrorMessage((0,o.qmi)()),a="ERROR",Ae.M.getInstance().logError({eventType:$.S2.DataShaping,errorMessage:`Failed to apply exit mode action: ${s}, ${e} (${JSON.stringify(e)})`,logLevel:i.$b.Error})}finally{await lt(e,a,t,n)}}catch(e){r.exitModeError=!0,Ae.M.getInstance().logError({eventType:$.S2.DataShaping,errorMessage:`got error during handling exit mode: ${e} (${JSON.stringify(e)})`,logLevel:i.$b.Error})}finally{Re.E.getInstance().updateTelemetryChatEventData({[pe.h3.ChatEventType]:pe.a5.DataShapingAgentEndMode,[pe.h3.ChatEventParameters]:JSON.stringify(r)},Ae.M.getInstance())}}async function lt(e,t,n,a){(0,ke.cY)("exitMode called with kind:",a," and reason:",t),e(Ge.m.exitDataShapingMode()),n&&(0,Ye.vo)();const o=ae.s.getInstance().NativeServices.IDataShapingPrivateSdxApiService.value;await o.endPreview("FAILURE"===t?"ERROR":t);const r=(0,ot.A)(),i=new x.g0({parentPath:["Signal",et.h2.getTypeName()],items:[{id:r,body:new et.h2({requestId:r,conversationId:r,kind:a??"Discard",enableDebugging:(0,ke.K_)()})}]});(await Nt.getInstance().getALSession()).submitOperation(i)}var st=n(164584),ct=n(531093);function dt(e,t){return new X.pW({worksheetId:t,left:e.topLeft.column??0,top:e.topLeft.row??0,right:e.bottomRight.column??0,bottom:e.bottomRight.row??0})}var ut=n(382736);var mt=n(215939),gt=n(110686);var ht=n(803716);var pt=n(135829),bt=n(851295),ft=n(318969),Ct=n(792312);var yt=n(297848),vt=n(652382);var Tt=n(147091),xt=n(261237),St=n(799765),wt=n(414542),Et=n(903173),It=n(808943),Rt=n(15536),At=n(252120);const Lt=JSON.parse('{"UU":"sdx_copilotchatexcel","rE":"9.57.2"}');var kt=n(837542).hp;function Ft(e){return void 0!==e?.eventName&&void 0!==e?.promptProperties}const _t="externalDisplayMessages";const Pt={"flux-chartsAndPivotTables":"charts_and_pivot_tables","flux-textAnalysis":"text_analysis","flux-getInsights":"get_insights","flux-createCalculatedColumns":"calculated_columns;create_columns","flux-editDocument":"edit_document","flux-dataShaping":"data_shaping","flux-createCalculatedCell":"calculated_columns;aggregate","flux-pythonAda":"get_python_code","flux-pythonCalculatedColumns":"python_calculated_columns","flux-importData":"import_data","flux-else":"excel_else","flux-startAnalysisMode":"start_analysis_mode","flux-answers":"answers"};class Nt extends O.CopilotCommunicationHandler{get isModelWorkflowSupported(){return!this.sessionRestartedDueToModelWorkflowNotSupported}static init(e,t,n){Nt.instance=new Nt(e,t,n)}static getInstance(){return Nt.instance}getQueryOriginValue(){return this.queryOrigin}shouldShowPythonAASuggestions(){return this.showPythonAASuggestions}setSuggestionList(e){e.forEach((e=>{const t=(0,qe.e)(e.suggestionType);t&&(Ie.B.getInstance().logSeenEvent(t),this.suggestionPillShown.has(e.suggestionType)||(this.telemetryEventHandler.updateTelemetryChatEventData({[pe.h3.ChatEventType]:pe.a5.SuggestionPaneSuggestionShown,[pe.h3.ChatEventParameters]:e.suggestionType},this.telemetryLogger),this.suggestionPillShown.add(e.suggestionType)))})),this.suggestionList=e}setZqmSuggestionList(e){const t=(0,De.uC)(e);$e.handleZqmLoadedLoggingEvent(t)}set cannedOption(e){Re.E.getInstance().updateTelemetryChatEventData({[pe.h3.ChatEventType]:pe.a5.SkillOverride,[pe.h3.ChatEventParameters]:`[{"skillOverride": ${e}]`},this.telemetryLogger),this._cannedOption=e}get cannedOption(){return this._cannedOption}setZeroQueryMessageTitles(e){this.zeroQueryMessageTitles=e}sendResponseToClient(e,t,n){if(e.body?.H_){switch(e.body.H_.T_){case L.jR.getTypeName():case L.Yn.getTypeName():this.responseHandler.handleResponse(e);break;case X.yZ.getTypeName():this.onExcelTableRecognitionAnnotationResult(e,n);break;case z.qS.getTypeName():this.onExcelBlobRangeAnnotationResult(e,n);break;case Pe.Yc.getTypeName():this.onWorkflowProgressAnnotationResult(e);break;case we.tP.getTypeName():(0,ke.cY)("Received SharedCopilotChatHistoryAnnotation, not handled yet");break;case R.lL.getTypeName():case R.Dv.getTypeName():case R.sG.getTypeName():(R.lL.typeGuard(e.body)||R.Dv.typeGuard(e.body)||R.sG.typeGuard(e.body))&&(0,Tt.UN)(this.store.dispatch,e.body);break;case j.NU.getTypeName():(0,wt.o)(e,e.body.requestId);break;case Y.bV.getTypeName():(0,Ne.yw9)("OfficeVSO_9523129_refactorCitationSignalAwait")?(0,wt.o)(e,e.body.requestId):(0,Ue.bn)(e);break;case Y.Dd.getTypeName():(0,Ne.yw9)("OfficeVSO_9523129_refactorCitationSignalAwait")?(0,wt.o)(e,e.body.requestId):(0,Ue.RD)(e);break;case N.b.getTypeName():this.onConditionalFormattingSuggestionAnnotationResult(e);break;case Q.f.getTypeName():this.onExcelChartStylesAnnotationResult(e);break;case le.uC.getTypeName():J.Y.getInstance().handleHandoffMessage(e,t,!1,this.copilotChatUIHelper?.getCopilotRef());break;case te.j5.getTypeName():((0,Ne.IU1)()||(0,Ne.GBi)())&&(0,wt.o)(e,e.body.requestId);break;case te.hM.getTypeName():(0,Ne.t9T)()||(0,wt.o)(e,e.body.requestId);break;case Z.l.getTypeName():(0,Ne.KV_)()&&!(0,Ne.Jym)()&&this.onExcelRunScriptAnnotation(e);break;case te.fm.getTypeName():(0,Ne.jGm)()&&(0,Ne.IU1)()&&(0,wt.o)(e,e.body.requestId);break;case te.OE.getTypeName():(0,Ne.t9T)()||this.onExcelScratchpadStartSnapshotAnnotation(e);break;case te.Ex.getTypeName():(0,Ne.t9T)()||this.onExcelScratchpadExecuteScriptInClientAnnotation(e);break;default:(0,ke.cY)("sendResponseToClient: No matching annotation found")}if(e.body.H_.T_!==L.Yn.getTypeName()&&e.body.H_.T_!==L.jR.getTypeName()){const t=e.body,n=t?.queryId,a=t?.contentOriginInformationalOnly;Qe.MK.augloopResponseReceived(n,a,t)}}}updateCopilotState(e){(0,ke.cY)(`updateCopilotState: ${e}`),e===v.SG.QUERY_SUBMITTED&&((0,Ne.UxI)()&&r.xP.getCurrentAddinState()===r.aB.ShowButton&&((0,he.s_)(he.H0.RemoveUndo),Ie.B.getInstance().sendChatEventTelemetry((0,pe.pN)({[pe.h3.ChatEventType]:i.a5.UndoButtonHiddenOnSubmittingQueryAfterAddinSuccess})),r.xP.transitionAddinState(r.aB.Idle)),(0,Ne.yw9)("OfficeVSO_10216180_logTriedWhenQueryIsEntered")||this.telemetryLogger.startTriedActivity()),(0,Ne.yw9)("OfficeVSO_10216180_logTriedWhenQueryIsEntered")&&e===v.SG.QUERY_ENTERED&&this.telemetryLogger.startTriedActivity()}sendLoggingEventToClient(e,t){this.loggingEventHelper.handleSharedLoggingEvent({event:e,args:t}).catch((t=>{Ae.M.getInstance().logError({eventType:$.S2.ChatEvents,logLevel:i.$b.Warning,errorMessage:`Failed to log share copilot logging event; ${{event:e,error:t?.message}}`},this.telemetryLogger.getDefaultEventFlags())}))}isFeatureGateEnabledFromClient(e){switch(e){case T.WT.SkipHydrateEnabled:return!(0,Ne.yw9)("OfficeVSO_8996286_reenablingRehydration");case T.WT.HydratedMessagesSquashingEnabled:return(0,Ne.yw9)("OfficeVSO_8996286_reenablingRehydration");case T.WT.IsApplyClpFromHydratedMessagedEnabled:return(0,Ne._bw)();case T.WT.EnableRestrictiveSearchBanner:case T.WT.IsPersistanceInPhase2UxEnabled:return(0,Ne.vIj)()&&(0,Ne.Dl1)();case T.WT.IsSharedCopilotLabEnabled:return!0;case T.WT.IsWebSearchDefaultOn:return(0,Ne.iPS)("Microsoft.Office.Excel.FA000000124.IsWebSearchDefaultOn",!0)&&(0,Ne.vIj)();case T.WT.EnableSendTenantFeedback:return(0,Ne.REo)();case T.WT.ExtractContentFromCardForFeedback:return!(0,vt.OK)()||(0,Ne.iPS)(`Microsoft.Office.Excel.FA000000124.${e}`,!1);default:return(0,Ne.iPS)(`Microsoft.Office.Excel.FA000000124.${e}`,!1)}}getWorkflowsToRegister(){(0,ke.cY)("registering workflows"),(0,ke.cY)(`session restarted due to model workflows not supported: ${this.sessionRestartedDueToModelWorkflowNotSupported}`),(0,Ne.yw9)("OfficeVSO_8772262_updateAugloopModelStatusOnAppState2")&&(this.responseHandler.setAugloopModelWorkflowUnsupported(this.sessionRestartedDueToModelWorkflowNotSupported),this.telemetryEventHandler.updateTelemetryChatEventData({[pe.h3.ChatEventType]:pe.a5.AugLoopSessionModelWorkflowUnsupported,[pe.h3.ChatEventParameters]:JSON.stringify({modelWorkflowNotSupported:this.sessionRestartedDueToModelWorkflowNotSupported})},this.telemetryLogger));const e=function(e){const t=Oe();return e?t.filter((e=>!Me.includes(e.workflowAnnotationType))):t}(this.sessionRestartedDueToModelWorkflowNotSupported);return e}async sendEventToClient(e,t){switch((0,ke.cY)(`sendEventToClient - event: ${e}`,{eventArgs:t}),t&&this.debugEvents.dispatchEvent(new CustomEvent(String(e),{detail:t})),e){case v.PV.AugloopResponseTimeout:(0,ke.cY)("AUGLOOP_RESPONSE_TIMEOUT:",{eventArgs:t}),this.handleAugloopResponseTimeout(t.workflowAnnotationType);break;case v.PV.AnnotationActivated:if((0,ke.cY)(`Annotation Activated: ${t.workflowAnnotationType}`),t.workflowAnnotationType===le.uC.getTypeName()){const e=J.Y.getInstance().getDocumentHandoffMessageId();J.Y.getInstance().sendHandoffMessageId(se.Q.GET,e)}break;case v.PV.StopGeneratingButtonClicked:(0,ke.cY)("Stop Generating Button Clicked:",{eventArgs:t}),this.handleStopButtonOnClick();break;case v.PV.CopilotChatLoaded:if(t&&t){const e=t.gptId;(0,ke.cY)(`Current Selected Copilot Extension Id: ${e}`),(0,l.P7)(e??"")}if(M.$.getInstance().clearLoadingPaneTimeout(),(0,ke.cY)("Copilot Chat Loaded:",{eventArgs:t}),(0,Ze.sZ)(),Ie.B.getInstance().logTelemetryForSharedChatPaneLoad(),(0,Se.J)("CopilotChatLoaded"),(0,Ne.KOx)()&&(0,s.r7)(),this.resetExternalQuerySubmitted(),await this.handleStartQuery(),this.logExternalQuerySubmitted(),(0,Ne.yw9)("OfficeVSO_9113126_copilotchatrefnulltimeoutfix")&&(0,bt.C6)()){const{message:e,telemetry:t}=at.n.getLanguageUnavailableResponse();M.$.getInstance().displayResponse(e,t)}if(!(0,Ne.UW0)()&&ue.V.IsSettingTrue(ue.z.ExcelSdxPrivateApiEnabled)&&(void 0===(0,mt.getPreloadCopilot)()||(0,mt.getPreloadCopilot)()&&((0,mt.getHasPreloadedCopilotBeenShown)()||!(0,Ne.K5)()))&&this.attachPrivateApiHandlers(),(0,Ne.yw9)("OfficeVSO_10152794_CopilotCanvasHandoffEnabled")&&await J.Y.getInstance().handleHandoffMessageHostAppSettings(),(0,Ne.afi)()){let e=ue.V.getSetting(ue.z.CopilotAgentToLoadAfterLaunch);e||(e=ue.V.getSetting(ue.z.CopilotAgentToLoadAfterLaunchLegacy)),(0,ke.cY)("Chat Loaded: Switch to Agent Post Load with AgentId: ",e),e&&e!==c.u1&&(ue.V.set(ue.z.CopilotAgentToLoadAfterLaunch,c.u1),ue.V.set(ue.z.CopilotAgentToLoadAfterLaunchLegacy,c.u1),this.handleCopilotAgentFromHostRequest({actionType:d.At.Activated,titleId:e}))}this.setCopilotChatLoadedState(!0);break;case v.PV.BizChatNativeLoaded:if((0,Ne.KOx)()){const e=ue.V.IsSettingTrue(ue.z.AutoOpenChatPane),n=t;(0,s.jg)("ExcelCopilotMessage",e,n,(e=>(0,Se.J)(e.type,e.message)),(0,Ne.Qq4)()),(0,Ne.Ak0)()&&"TTVR"===n?.measureType&&Ie.B.getInstance().logTelemetryForSharedChatPaneLoad()}break;case v.PV.CopilotChatOnAppRenderSuccess:if(!(0,Ne.P5X)())break;(0,s.kV)("ExcelCopilotMessage",(e=>(0,Se.J)(e.type,e.message)));break;case v.PV.BasicChatSuggestionPills:(0,ke.cY)("SuggestionPills event triggered:",{eventArgs:t});break;case v.PV.CitationLinkClicked:(0,ke.cY)("Citation Link Clicked:",{eventArgs:t});break;case v.PV.ChatTopicChanged:(0,ke.cY)("Chat Topic Changed:",{eventArgs:t}),this.handleChangeTopicButtonOnClick();break;case v.PV.ChatHistoryHydrationFailed:(0,ke.cY)("Chat History Hydration Failed:",{eventArgs:t});break;case v.PV.BasicChatStatus:(0,ke.cY)("Basic Chat Status:",{eventArgs:t});break;case v.PV.QuerySubmitted:(0,ke.cY)("Query Submitted:",{eventArgs:t});break;case v.PV.ResetContextId:(0,ke.cY)("Reset Context Id:",{eventArgs:t});break;case v.PV.PluginsStateUpdated:{(0,ke.cY)("Plugin state updated",{eventArgs:t});let e;if((0,Ne.vIj)()&&!(0,Ne.oJj)()&&((0,Ne.HSC)()||!(0,Ne.ULj)())){const n=t;e=n.pluginsInfo.findIndex((e=>e&&e.id===o.VMi&&e.state===o.hiv))>=0,e&&((0,It.LA)(!0),this.setEnterpriseSearchIsEnabled&&this.setEnterpriseSearchIsEnabled(!0),(0,ke.cY)("ExcelCopilotChat: Enterprise search is enabled by default"));const a=n.pluginsInfo.findIndex((e=>e&&e.id===o.AF5&&e.state===o.hiv&&e.isEnabled))>=0;(0,It.u$)(a)}this.telemetryEventHandler.updateTelemetryChatEventData({[pe.h3.ChatEventType]:pe.a5.GroundingSourceUpdated,[pe.h3.ChatEventParameters]:"Work:Auto"+(e?"On":"Off")});break}case v.PV.UpdateChatClpFromChatHistory:{(0,ke.cY)("Update Chat Clp From Chat History:",{eventArgs:t});const e=t?.messagesClpLabels,n=await P.n.getInstance().updateSdxSensitiveLabelFromChatHistory(e);this.telemetryEventHandler.updateTelemetryChatEventData({[pe.h3.ChatEventType]:pe.a5.ClpLabelUpdateFromChatHistory,[pe.h3.ChatEventParameters]:"result: "+n},this.telemetryLogger);break}case v.PV.PythonExitAnalysisButtonClicked:(0,ke.cY)("Python Exit Analysis:",{eventArgs:t}),(0,je.Tk)();break;case v.PV.SharedHeaderRendered:(0,Ne.aC$)()&&!window.StaticHeaderLoadTime&&(0,Ye.hC)(),(0,ke.cY)("Shared Header Rendered:",{eventArgs:t});break;case v.PV.QueryEndOnGptSwitch:(0,ke.cY)("Query End On Gpt Switch:",{eventArgs:t}),this.handleStopQueryWhenGptSwitched();break;case v.PV.NewChatButtonClicked:(0,ke.cY)("New Chat Button Clicked:",{eventArgs:t}),(0,Ne.yw9)("OfficeVSO_9717706_ExitPythonModeOnNewChat")&&Ve.CP.pythonContextManager.isPythonMode&&(0,je.Tk)();break;case v.PV.DifferentChatOpened:(0,ke.cY)("Different Chat Opened:",{eventArgs:t}),(0,Ne.yw9)("OfficeVSO_9717706_ExitPythonModeOnNewChat")&&Ve.CP.pythonContextManager.isPythonMode&&(0,je.Tk)();break;case v.PV.CreateNewConversationButtonClicked:(0,ke.cY)("Create New Conversation Button Clicked:",{eventArgs:t});break;case v.PV.LowOnCredits:(0,ke.cY)("Low on credits:",{eventArgs:t});break;case v.PV.OutOfCredits:(0,ke.cY)("Out of credits:",{eventArgs:t});break;case v.PV.CreditsNotAvailable:(0,ke.cY)("Credits not available:",{eventArgs:t});break;case v.PV.StartNewChatCalled:(0,ke.cY)("Start New Chat Called:",{eventArgs:t});break;case v.PV.AddInLocalPluginActionInvoked:case v.PV.AddInLocalPluginActionsInvoked:{(0,ke.cY)("AddInLocalPluginActionInvoked:",{eventArgs:t});const e=t,n=ie.iJ.startUndoScope,a=ie.iJ.endUndoScope,o=ie.iJ.performUndo;(0,u.f)(e,n,a,o);break}case v.PV.ALConnectedWithSameALSessionKey:case v.PV.ALConnectedWithNewALSessionKey:case v.PV.ALDisconnected:case v.PV.ALReconnected:case v.PV.ALClosed:case v.PV.ALSeedingStatusChanged:case v.PV.HandleSubmitForDQGCLicked:(0,ke.cY)(`AL callback event: ${e}`,{eventArgs:t});break;case v.PV.NewSuggestionPills:(0,ke.cY)("NewSuggestionPills:",{eventArgs:t});break;case v.PV.FluxResponseHandlingCompleted:(0,ke.cY)("FluxResponseHandlingCompleted:",{eventArgs:t});break;case v.PV.FluxResponseHandlingErroredOut:(0,ke.cY)("FluxResponseHandlingErroredOut:",{eventArgs:t});break;case v.PV.QueryExecutionCompleted:(0,ke.cY)("QueryExecutionCompleted:",{eventArgs:t});break;case v.PV.QueryExecutionStarted:(0,ke.cY)("QueryExecutionStarted:",{eventArgs:t});break;case v.PV.GenericMessageEvent:{const e=t;switch(e.type){case"CloseSessionPane":this.handleCloseSessionPane(this.store.dispatch);break;case"AgentChanged":await this.handleAgentChangedEvent(e.args,this.store.dispatch);break;case"ExitDataShapingMode":await it(this.store.dispatch,!0,e.args?.action);break;default:(0,ke.cY)("GenericMessageEvent:",{eventArgs:t})}break}default:(0,ke.cY)(`Unhandled event: ${e}`,{eventArgs:t}),(0,ze.x)(e)}}handleCloseSessionPane(e){(0,ke.cY)("Close Session Pane event triggered"),(0,Ye.vo)();e((0,be.SW)()).started&&it(e,!1)}async handleAgentChangedEvent(e,t){(0,ke.cY)("Agent Changed Event:",{agentChangedEventArgs:e});const n=(0,Ne.beW)("Microsoft.Office.Excel.FA000000124.DataShapingAgentId","T_33851110-0645-e53b-50ab-a31ccd8044cc.declarativeCopilot");if(!n||n===c.u1||!(0,Ne.lht)())return;const a=e?.gptId===n,o={isDataShapingAgent:a};this.telemetryEventHandler.updateTelemetryChatEventData({[pe.h3.ChatEventType]:pe.a5.DataShapingAgentChange,[pe.h3.ChatEventParameters]:JSON.stringify(o)},this.telemetryLogger);const r=t((0,be.SW)());if(a){const e=Ve.CP.getActiveTable()?.name||Ve.CP.getSelectedTableName();await rt(t,e)}else r.started&&await it(t,!1)}async handleChangeTopicButtonOnClick(){const{message:e,telemetry:t}=at.n.getChangeTopicResponse();this.copilotChatUIHelper.displayResponse(e,t),this.store.dispatch((0,be.Nl)()),Ce.y.getInstance().clearODSLCache()}async handleCommandExecutionStart(e,t,n,a){(0,ke.cY)(e),(0,Ne.geU)()&&await Ve.CP.releaseContextLock(),Ae.M.userQueryGuid=t,Ae.M.userQueryOrder++,this.telemetryLogger?.resetActiveFeature(),Ie.B.userQueryGuid=t,Ie.B.getInstance().resetActiveFeature(),(0,Ne.yw9)("OfficeVSO_9260844_FixContextTreeBuildTime")?this.store.dispatch((0,be.eM)(pe.OP.FluxReasoning,t)):(Ve.CP.lockContextRefresh(),this.store.dispatch(Ge.m.startExecutingCommand({command:pe.OP.FluxReasoning,id:t}))),this.telemetryEventHandler.updateTelemetryChatEventData({[pe.h3.ChatEventType]:n,...(0,pe.j)(Ve.CP)},this.telemetryLogger);const o=(new Date).getTime();this.copilotChatUIHelper.setLastUserUtterance(e),this.copilotChatUIHelper.setLastUserImage(a||[]),this.responseHandler.setAugloopSignalSentTime(o),(0,Ne.cTR)()&&((0,ke.cY)(`Setting User Utterance for ${t} to "${e}"`),this.store.dispatch(At.m.setQueryUserUtterance({queryId:t,userUtterance:e})));const r=(0,pe.xJ)(o);this.telemetryEventHandler.updateTelemetryLatencyData({[pe.CT.ContextTreeBuildTime]:(0,m.W)(o),[pe.CT.Duration]:r,[pe.CT.OperationName]:pe.OP.ContextTreeBuild,[pe.CT.IsSuccessful]:!0},this.telemetryLogger),(0,Ne.iPS)("Microsoft.Office.Excel.FA000000124.EnableDynamicPlanner",!1)&&(0,Ne.yw9)("OfficeVSO_10375249_PassRawQueryToInsights")&&this.store.dispatch(Et.m.setRawQuery({userQueryGuid:t,messageText:e})),(0,ke.cY)(`Context Tree Build. Time Taken ${r/1e3} sec`)}getQueryAnnotationsTypes(e){return e?e.map((e=>e.QueryAnnotationType)):[]}async getDefaultSignalOperation(e,t,n,a,r,i,s,d,u,m,p,b,f,C,y,v,T,S){(0,It.j3)(v),this.showPythonAASuggestions=S,await this.handleCommandExecutionStart(e,t,pe.a5.UserUtteranceSubmitted,s);const w=(0,g.TR)(u,d,O.defaultCopilotChatMenuItemId);if((0,l.P7)(w??c.u1),(0,Ne.JZX)()&&this.xlimWorkflowProgressHandler.getShouldAlertUser()){const{message:e,telemetry:t}=at.n.getTableLikeRangesLoadingResponse();this.copilotChatUIHelper.displayResponse(e,t,{shouldShowWhenFluxSkillResponseRequired:!0}),this.xlimWorkflowProgressHandler.handleQuerySubmittedWhileWorkflowRunning()}const E=s?.map(h.pi)[0],I=s?.length??0;void 0===E&&s&&I>0&&((0,ke.cY)(`Invalid image data URI in image chat: ${s[0]}`),Ie.B.getInstance().sendErrorTelemetry((0,pe.pN)({[pe.IC.ErrorMessage]:"Image chat bad image data URI in getFluxInputSignal",[pe.IC.ErrorCategory]:$.S2.ImageChat}))),I>0&&((0,ke.cY)(`image chat image count: ${I}`),Ie.B.getInstance().sendChatEventTelemetry((0,pe.pN)({[pe.h3.ChatEventType]:pe.a5.TriggerImageChatOperation,[pe.h3.ChatEventParameters]:`image chat image count: ${I}`,[pe.h3.UserQueryGuid]:t})));const R=((0,Ne.yw9)("OfficeVSO_9483632_fluxOverrideForMessage")?this.getFluxSkillOverrideForMessage(e):void 0)??this.getFluxSkillOverride(e,T);(0,Ne.yw9)("OfficeVSO_9776293_LogSkillOverride")&&R&&Ie.B.getInstance().sendChatEventTelemetry((0,pe.pN)({[pe.h3.ChatEventType]:pe.a5.SignalWithSkillOverride,[pe.h3.ChatEventParameters]:R,[pe.h3.UserQueryGuid]:t})),re.Q.getInstance().startRecordingFluxWorkflow();const A=await(0,Ze.mm)(Ve.CP,e,t,n,R,r,i,E,(0,Ne.Pz_)()?d:void 0,u,p,b,this.getUserQueryLanguageIfSkippingLanguageDetection(e),this.getClientCapabilities());(0,Ne.geU)()&&this.store.dispatch(At.m.setCommandingResponseUtterance({queryId:t,userUtterance:e,context:A.context??""}));const F=new x.g0({parentPath:["Signal",k.qO.getTypeName()],items:[{id:ye.r.generateId(),body:A}]}),_=kt.byteLength(JSON.stringify(F));if(_>o.dKK)throw M.$.getInstance().stopLoadingUi(),Ve.CP.pythonContextManager.isPythonMode&&(0,St.fU)(_,kt.byteLength(JSON.stringify(Ve.CP)),kt.byteLength(JSON.stringify(e)),kt.byteLength(JSON.stringify(r)),kt.byteLength(JSON.stringify(E))),new Error(`Message size exceeds AugLoop limit.  Size: ${_}`);const P={userQueryGuid:t,GroundingMode:(0,pe.Q6)(),queryAnnotations:this.getQueryAnnotationsTypes(r)};this.telemetryEventHandler.updateTelemetryChatEventData({[pe.h3.ChatEventType]:pe.a5.QuerySubmittedToAL,[pe.h3.ChatEventParameters]:JSON.stringify(P)},this.telemetryLogger);const N={operation:F,workflowAnnotationType:L.Yn.getTypeName()};return(0,ke.cY)(`getDefaultSignalOperation: ${JSON.stringify(N,void 0,4)}`),N}getUserQueryLanguageIfSkippingLanguageDetection(e){if((0,ft.XX)().some((t=>t.suggestionText.toLowerCase()===e.toLowerCase())))return(0,bt.gl)()}deductCopilotCredit(e){const t=new D.vW({scenarioGuid:F.ss,interactionId:e,interactionSessionId:W.s.getInstance().getConversationId()??""}),n={operation:new x.g0({parentPath:["Signal",D.vW.getTypeName()],items:[{id:ye.r.generateId(),body:t}]}),workflowAnnotationType:B.d.getTypeName()};M.$.getInstance().submitOperation(n)}anyHandledMessage(e){return(!W.s.getInstance().hasSeenDisengagedError()||0===e.status)&&(!(void 0!==e.messagesToAddOrReplace&&(0,ke.Pk)(e.messages)&&(0,ke.Pk)(e.messagesToUpdate)&&(0,ke.Pk)(e.messagesToDelete))||e.messagesToAddOrReplace.some((e=>W.s.getInstance().isHandledResponseMessage(e))))}async shouldIgnoreResponse(e){if(e.body?.H_)switch(e.body.H_.T_){case L.jR.getTypeName():case R.lL.getTypeName():case R.Dv.getTypeName():case R.sG.getTypeName():case j.sA.getTypeName():case we.tP.getTypeName():case X.yZ.getTypeName():case Y.bV.getTypeName():case N.b.getTypeName():case Q.f.getTypeName():case le.uC.getTypeName():return!1;case L.Yn.getTypeName():{if(!L.Yn.typeGuard(e.body))return!1;const t=e.body.queryId;return t&&function(e){if(36!==e.length)return!1;const t=e.charAt(19);return!(8&parseInt(t,16))&&"0"===e.charAt(0)&&"4"===e.charAt(14)}(t)?((0,ke.cY)(`shouldIgnoreResponse: Ignoring response for CopilotOnGrid queryId: ${t}`),!0):void 0!==e.body.chatResponse&&void 0===e.body.odslResponse&&!this.anyHandledMessage(e.body.chatResponse)}default:return(0,ke.cY)("shouldIgnoreResponse: No matching annotation found"),Ae.M.getInstance().logError({eventType:$.S2.Augloop,errorMessage:`No matching annotation found for type: ${e.body.H_.T_}`,logLevel:i.$b.Warning}),!0}return!0}async getALSession(){return(0,st.qD)()}initializeExcelAgentPluginCallbacks(e){if(e.activateServerRequestResponse(Z.l.getTypeName(),{onAnnotationCallback:async(e,t)=>t(await this.runExcelAgentOfficeJSScript(e),!0)}),(0,Ne.t9T)()){const t=async(e,t)=>(this.responseHandler.startChangeCollector(e.caller),t({},!0));e.activateServerRequestResponse(te.OE.getTypeName(),{onAnnotationCallback:t});const n=async(e,t)=>{const n=await this.responseHandler.applyAllBatches(e.caller);return t(new ne.Zk({success:n.success,caller:e.caller,requestId:(0,ot.A)(),errorMessage:n.errorMessage}),!0)};e.activateServerRequestResponse(te.TM.getTypeName(),{onAnnotationCallback:n});const a=async(e,t)=>{xe.p.sendResponseCallback=t;const n=await this.onExecuteScratchpadScriptInClientAnnotation(e),a=xe.p.sendResponseCallback(n,!0);if(!Nt.scriptExecutionDeferredPromise){const e="CommunicationHandler.scriptExecutionDeferredPromise not created in continueRichApiBatchCallback.";throw this.telemetryLogger.logError({eventType:$.S2.ChatEvents,errorMessage:e,logLevel:i.$b.Error}),new Error(e)}return Nt.scriptExecutionDeferredPromise.resolve(a),Nt.scriptExecutionDeferredPromise=void 0,a};e.activateServerRequestResponse(te.Ex.getTypeName(),{onAnnotationCallback:a});const o=async(e,t)=>{xe.p.resolveAnnotationPromise(e,t),Nt.scriptExecutionDeferredPromise=(0,q.p)();const n=setTimeout((()=>{if(Nt.scriptExecutionDeferredPromise){const e="Timeout waiting for annotation response";Nt.scriptExecutionDeferredPromise.reject(new Error(e)),this.telemetryLogger.logError({eventType:$.S2.ChatEvents,errorMessage:e,logLevel:i.$b.Error}),Nt.scriptExecutionDeferredPromise=void 0}}),12e4);try{const e=await Nt.scriptExecutionDeferredPromise.promise;return clearTimeout(n),e}finally{Nt.scriptExecutionDeferredPromise=void 0}};e.activateServerRequestResponse(te.hM.getTypeName(),{onAnnotationCallback:o}),async function(e,t){(0,Ne.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.ExcelDataShapingClientStore",!1)&&(await t.activateServerRequestResponse(j.ik.getTypeName(),{onAnnotationCallback:async(t,n)=>{let a;const o={success:!1,started:!1,sessionId:""};try{try{const n=ae.s.getInstance().NativeServices.IDataShapingPrivateSdxApiService.value,r=e((0,be.SW)());if(o.started=r.started,!r.started)throw new Error("Data shaping not started");if(r.sessionId!==t.dataShapingSessionId)throw new Error("Data shaping session ID mismatch");o.sessionId=r.sessionId,await n.updateQueryScript(t.queryScript);const i=await n.getQueryScript();a={dataShapingSessionId:t.dataShapingSessionId,success:!0,actualQueryScriptOrError:i},o.success=!0}catch(e){a={dataShapingSessionId:t.dataShapingSessionId,success:!1,actualQueryScriptOrError:e.message}}await n(new j.vH(a))}finally{Re.E.getInstance().updateTelemetryChatEventData({[pe.h3.ChatEventType]:pe.a5.DataShapingEditQuery,[pe.h3.ChatEventParameters]:JSON.stringify(o)},Ae.M.getInstance())}}}),await t.activateServerRequestResponse(j.eg.getTypeName(),{onAnnotationCallback:async(t,n)=>{const a={success:!1,started:!1,sessionId:""};try{const t=[],o=e((0,be.SW)());a.started=o.started,o.started?(a.sessionId=o.sessionId,t.push({key:Ke.y.DataShapingSessionId,value:o.sessionId}),t.push({key:Ke.y.DataShapingTableName,value:o.tableName}),t.push({key:Ke.y.DataShapingBaseQueryScript,value:o.baseScript}),t.push({key:Ke.y.DataShapingCurrentQueryScript,value:o.queryScript})):t.push({key:Ke.y.DataShapingSessionId,value:void 0});const r={items:t};await n(new j.zr(r)),a.success=!0}finally{Re.E.getInstance().updateTelemetryChatEventData({[pe.h3.ChatEventType]:pe.a5.DataShapingHydration,[pe.h3.ChatEventParameters]:JSON.stringify(a)},Ae.M.getInstance())}}}))}(this.store.dispatch,e)}}initializeAlCallbacks(){(0,st.UC)((async e=>{((0,Ne.Jym)()||(0,Ne.t9T)())&&this.initializeExcelAgentPluginCallbacks(e)})),(0,st.jl)((async(e,t)=>{this.sessionRestartedDueToModelWorkflowNotSupported=t,M.$.getInstance().startReinitializeALSession(),(0,Ne.yw9)("OfficeVSO_8772262_updateAugloopModelStatusOnAppState")&&this.responseHandler.setAugloopModelWorkflowUnsupported(t),Ae.M.getInstance().logError({eventType:$.S2.Augloop,errorMessage:"Augloop session restarted",logLevel:i.$b.Warning},void 0,[{key:$.Wg.UnsupportedWorkflow,value:t}])})),(0,st.s6)((()=>{(0,ke.cY)("AugLoop session closed on permanent error."),this.store.dispatch(Et.m.setIsPermanentError(!0));const e=(0,Ne.yw9)("OfficeVSO_9792561_AttributionForAugLoopFailure")&&this.telemetryLogger?this.telemetryLogger.getActiveFeature():pe.BJ.CopilotChat;Ae.M.getInstance().logStandardizedAshaErrorEvent(E.W.User_Input_Could_Not_Be_Processed,w.c.Input_Failed_Due_To_Augloop_Session_Close,e),Ae.M.getInstance().logError({eventType:$.S2.Augloop,errorMessage:"AugLoop connection closed on permanent error.",logLevel:i.$b.ASHA})}))}stringToQueryOrigin(e){if(void 0!==e)return F.Rk[e]}getHostSettings(){const e={appName:Office.context.diagnostics.host.toString(),appPlatform:(0,ie.vI)().toString().toUpperCase(),devBuild:(0,ke.K_)(),environment:this.getAppEnvironment(),sessionId:"",augloopUrl:"https://augloop-dogfood.officeppe.com",m365ChatConfiguration:{environment:this.getM365ChatEnvironment(),host:me.vb.Excel,clientPlatform:(0,ie.ET)()},substrateScenarioName:o.rGh[(0,ie.vI)().toString().toUpperCase()],language:(0,bt.gl)(),sessionStorageKey:this.getSessionStorageKey(),enterpriseUser:(0,Ne.Dl1)(),feedbackSettings:(0,Xe.f)(),getDocumentUrlAsync:(0,Ne.uPG)()?ie.H5:void 0};return(0,Ne.etf)()&&(e.m365ChatDevBuild=!1),e}getSessionStorageKey(){const e=window.Office.context,t=e?.platform;let n;const a=e?.hostSettings?._settings?.IsCopilotPreloaded;if(t===window.Office.PlatformType.OfficeOnline)n=e?.hostSettings?.get("AppStartTimestamp");else if(a){const t=e?.document?.settings?._clientSettingsManager?._osfClientContext;let a=t?.GetCorrelationId();const o=t?.GetDocUrl();a&&(a=a.replace(/[{}]/g,"")),o&&a&&(n=`${a}${"string"==typeof o?(0,p.if)((new TextEncoder).encode(o)):""}`)}return n}async setPythonContext(e,t){let n=!0;return Ve.CP.pythonContextManager.lastPythonUserRequestId=(0,ot.A)(),this.store.dispatch(Ge.m.startNewPythonQuery()),t&&(Ae.M.userQueryGuid=t,Ie.B.userQueryGuid=t),(0,Te.F5)(),(0,Ne.H2A)()&&(n=await Ve.CP.pythonContextManager.setPythonAdaContext(Ve.CP.isPythonCellSelected,e,Ve.CP.selectedPythonSheetId,Ve.CP.selectedPythonAddress,this.stringToQueryOrigin(this.getQueryOriginValue()))),n}async shouldSendRequestToAugloop(e,t,n,a){if(this.onNewUserUtterance(),(0,Ne.WFw)()&&Ie.B.getInstance().sendHandoffQuerySubmittedEvent(e),"python"===this.cannedOption)return await this.setPythonContext(e,a),(0,ke.cY)("Canned option set - Showing Python card"),(0,Ne.H2A)()&&(this.updateCopilotState(v.SG.QUERY_SUBMITTED),this.responseHandler.showPythonStartAnalysisCard((0,ot.A)(),!1)),!1;const r=((e,t)=>{if((0,Ze.jZ)(e)){(0,Ze.cY)("Help query detected:"+e);const{message:n,telemetry:a}=at.n.getHelpQueryResponse();return M.$.getInstance().displayResponse(n,a),t((0,be.Nl)()),!1}if(e===(0,o.vMn)()){const{message:e,telemetry:n}=at.n.getLearnMoreResponse();return M.$.getInstance().displayResponse(e,n),t((0,be.Nl)()),!1}return!0})(e,this.store.dispatch);if(!r)return this.telemetryLogger.endTriedActivityFailure(),!1;const i=this.suggestionList.find((t=>t.suggestionText.toLowerCase()===e.toLowerCase()));if((0,Ne.yw9)("OfficeVSO_9205086_LogSuggestionPillExecutes")&&i){const e=a??(0,ot.A)();Ae.M.userQueryGuid=e,Ie.B.userQueryGuid=e,this.telemetryEventHandler.updateTelemetryChatEventData({[pe.h3.ChatEventType]:pe.a5.SuggestionPaneSuggestionClicked,[pe.h3.ChatEventParameters]:i.suggestionType},this.telemetryLogger),a=e}const l=this.getShouldHandleSuggestionClientSide(i);if(i&&l)return this.handleSuggestionPillClick(i,a),!1;i&&this.resetUnsupportedTlrPromptSuggestions(i);const s=Object.values(this.zeroQueryMessageTitles).find((t=>t.toLowerCase()===e.toLowerCase()));if(a){const t=this.getQueryOrigin(e);t&&this.store.dispatch(Ge.m.setQueryOriginByQueryId({queryId:a,queryOrigin:t}))}if((0,Ne.H2A)()){Ve.CP.pythonContextManager.shouldGenerate=!0;const e=await(0,je.J7)(Ve.CP);Ve.CP.pythonContextManager.pythonAnalysisSheetExistsOnUserQuerySubmit=e}if((0,Ne.H2A)()){if(!await this.setPythonContext(e,a))return this.telemetryLogger.endTriedActivityFailure(pe.q.Python),!1;if((0,Ne.ggM)()){if((0,Ne.B8x)()){if(!Ve.CP.pythonContextManager.isPythonMode&&s&&s===(0,o.fkZ)()){this.updateCopilotState(v.SG.QUERY_SUBMITTED);try{(0,Je.iY)("en-us")}catch(e){return this.telemetryLogger.endTriedActivityFailure(pe.q.Python),(0,Je.Kx)(this.store.dispatch,e,"shouldSendRequestToAugloop",!1),!1}return this.responseHandler.showPythonStartAnalysisCard((0,ot.A)(),!0),!1}(0,Te.lu)()}}else{if(!Ve.CP.pythonContextManager.isPythonMode&&s&&s===(0,o.ONP)()){this.updateCopilotState(v.SG.QUERY_SUBMITTED);try{(0,Je.iY)("en-us")}catch(e){return this.telemetryLogger.endTriedActivityFailure(pe.q.Python),(0,Je.Kx)(this.store.dispatch,e,"shouldSendRequestToAugloop",!1),!1}return this.responseHandler.showPythonStartAnalysisCard((0,ot.A)(),!0),!1}(0,Te.lu)()}}if((0,Ne.vom)()&&await(Ve.CP.pythonCalculatedColumnContextManager?.updatePythonColumns()),(0,Ne._bw)()){if(!await(0,b.aW)())return(0,ke.cY)("Sensitivity Label APIs failed, not sending request to AL"),Promise.resolve(!1)}return!0}getFluxSkillOverrideForMessage(e){if((0,Ne.eFk)()&&Office.context.platform===Office.PlatformType.OfficeOnline&&!this.store.dispatch((0,be.SW)()).started&&(0,o.fEB)().find((t=>t.toLowerCase()===e.toLowerCase().trim())))return Pt["flux-dataShaping"]}getShouldHandleSuggestionClientSide(e){return!!e&&("Commanding_Suggestion"!==e.suggestionType&&((!(0,Ne.iPS)("Microsoft.Office.Excel.FA000000124.EnableDynamicPlanner",!1)||"AnalyzeData_ShowCharts"!==e.suggestionType&&"AnalyzeData_ShowPivotTables"!==e.suggestionType)&&("AnalyzeData_InsertAll"===e.suggestionType||"GiveMeMorePrompts"===e.suggestionType||"Commanding_TellMe"===e.suggestionType||"AnalyzeData_ShowMore"===e.suggestionType||"CalculatedColumns_ShowMore"===e.suggestionType||"AnalyzeData_ShowCharts"===e.suggestionType||"AnalyzeData_ShowMoreCharts"===e.suggestionType||"AnalyzeData_ShowPivotTables"===e.suggestionType||"AnalyzeData_ShowMorePivotTables"===e.suggestionType||"AnalyzeData_InsertAllCharts"===e.suggestionType||"ConditionalFormat_Suggestion"===e.suggestionType||"ImportDataFromFile"===e.suggestionType)))}getFeedbackData(){return(0,Ye.M5)()}async getCanvasSelection(){xt.isPublicApiInitialized&&((0,Ne.wQA)()||xt.isPublicApiInitialized||!(0,Ne.yw9)("OfficeVSO_10475169_InitContextManager"))||await Ve.CP.initPublic((0,ge.KA)().dispatch);const e=JSON.parse(await Ve.CP.getContextString("")),t=Object.fromEntries(["activeWorksheet","activeRangeAreas","activeCell","activeChart","activePivotTable"].filter((t=>null!=e[t])).map((t=>[t,e[t]])));return{selection:JSON.stringify(t),isValid:!0,objects:[]}}async getDocumentContext(){const{spoId:e,fileName:t}=await this.getDocumentContextFromDocumentUrlAsync(),n={spoId:e,fileName:t};if((0,Ne.VKb)()){const e=await this.getPopulateCellCount();n.count=e}return n}feedbackButtonClicked(e,t){(0,ke.cY)("Feedback clicked");let n=t?.feedbackArea??"Copilot";if("Copilot\\Python"===n&&this.getQueryOriginValue()===F.Rk.MsFormsSDX&&(n="Copilot\\PythonForms"),(0,Ne.yw9)("OfficeVSO_8546828_SupportingSuggestionIdForExcelCopilotCC")){const a=JSON.parse(t?.contextData?.cardMetaData??"{}");e===v.Gb.LIKE?this.telemetryLogger?.logThumbsUpEvent(n,a?.suggestionId,a?.promptId,a?.groundingMode):this.telemetryLogger?.logThumbsDownEvent(n,a?.suggestionId,a?.promptId,a?.groundingMode)}}async copyButtonClicked(e,t,n){(0,ke.cY)("Copy button clicked called"),(0,he.Kv)(e,t,n)}async handleAugloopResponseTimeout(e){if(this.responseHandler.markRequestCanceled(),M.$.getInstance().handleEndOfQuery(void 0),G.Z.getInstance().isWaitingForStreamEnd())return re.Q.getInstance().stopRecordingFluxWorkflow(!1),void G.Z.getInstance().cleanupStreamHandler();(0,ke.cY)("Augloop Response Timed Out");const{message:t,telemetry:n}=at.n.getAugloopTimeoutResponse(this.telemetryLogger.getActiveFeature());if((0,Ne.yw9)("OfficeVSO_10479488_SkipDuplicateALTimeoutAshaError")){const e=e=>{switch(Ae.M.getInstance().getStandardizedFeatureForSubFeature(e.featureName)){case pe.BJ.CopilotChat:case pe.BJ.ExcelChatHelper:return!0;default:return!1}};this.copilotChatUIHelper.displayResponse(t,n,{shouldShowWhenFluxSkillResponseRequired:!0,logAshaError:!e(n)})}else this.copilotChatUIHelper.displayResponse(t,n,{shouldShowWhenFluxSkillResponseRequired:!0});Ve.CP.pythonContextManager.isPythonMode&&((0,Te.hb)(),(0,Te.P_)(!0)),re.Q.getInstance().stopRecordingFluxWorkflow(!1),M.$.getInstance().handleEndOfQuery(void 0),this.store.dispatch((0,be.Nl)());const a=await this.store.dispatch((0,be.q9)());this.logAugloopTimeoutAshaError(a),this.telemetryLogger.logError({eventType:$.S2.ChatEvents,errorMessage:`"Augloop Response Timed Out: workflowAnnotationType ${e}, executingCommand: ${a}`,logLevel:i.$b.Error})}logAugloopTimeoutAshaError(e){if(!e)return;const t=this.getFeatureNameFromLatencyOperation(e)??pe.BJ.CopilotChat;this.telemetryLogger.assertFeatureIsActive(t,"logAugloopTimeoutAshaError: Feature from executing command does not match active feature."),Ae.M.getInstance().logStandardizedAshaErrorEvent(E.W.Response_Delayed_Or_Timed_Out,w.c.Augloop_Response_Timed_Out,t,!1)}async handleStopAlGeneration(e){Ve.CP.pythonContextManager.shouldGenerate=!1,Ue.qx.getInstance().stopGeneratingCurrentMessageId();const t=await this.store.dispatch((0,be.q9)());this.logUserStopGeneratingAshaError(t),this.logIsTriedFailedDueToUserStopGenerating(t);const n=this.getFeatureNameFromLatencyOperation(t)??pe.BJ.CopilotChat;if(this.telemetryLogger.assertFeatureIsActive(n,"handleStopButtonClick: Feature from executing command does not match active feature."),this.telemetryEventHandler.logStopGeneratingLatencyTelemetry(O.querySubmitTime,this.telemetryLogger,n),(0,Ne.yw9)("OfficeVSO_8531310_UndoForStopGenerating")&&this.store.dispatch((0,gt.f1)()),e){const{message:e,telemetry:n}=at.n.getStopGeneratingResponse(t);this.copilotChatUIHelper.displayResponse(e,n);const a=(0,ut.N)(e);this.store.dispatch((0,be.nv)(a,ve.Aw.cancelled,n,!1))}W.s.getInstance().isWaitingForStreamEnd()&&W.s.getInstance().cleanupStreamHandler(),this.responseHandler.markRequestCanceled()}async handleStopButtonOnClick(){const e=(0,Ne.UxI)()&&r.xP.isAddinFlow(),t=e&&r.xP.getCurrentAddinState()===r.aB.HasAction;this.endAddinOperationsAndTriggerUndo(t),e&&Ie.B.getInstance().sendChatEventTelemetry((0,pe.pN)({[pe.h3.ChatEventType]:i.a5.StopGeneratingButtonClickedDuringAddinExecution})),this.handleStopAlGeneration(!0),e&&r.xP.setIsAddinFlow(!1,(()=>{(0,p.An)(M.$.getInstance().getCopilotRef(),!1)}))}async endAddinOperationsAndTriggerUndo(e){await ie.iJ.endUndoScope(),e&&await ie.iJ.performUndo()}async handleStopQueryWhenGptSwitched(){(0,Ne.Pz_)()&&this.handleStopAlGeneration(!1)}logIsTriedFailedDueToUserStopGenerating(e){if(e&&e===pe.OP.ElseSkillExecuting)(0,Be.Or)(Ae.M.getInstance())}getFeatureNameFromLatencyOperation(e){switch(e){case pe.OP.CalculatedColumns:case pe.OP.CalculatedCells:return pe.BJ.FormulaGeneration;case pe.OP.AnalyzeData:return pe.BJ.AnalyzeData;case pe.OP.ChartDesignRecommendations:return pe.BJ.ChartDesignRecommendations;case pe.OP.Commanding:return pe.BJ.Commanding;case pe.OP.ConditionalFormatting:return pe.BJ.ConditionalFormatting;case pe.OP.Search:return pe.BJ.Search;case pe.OP.ElseSkillExecuting:return pe.BJ.ExcelChatHelper;case pe.OP.PythonStartAnalysis:case pe.OP.Python:return pe.BJ.Python;default:return void Ae.M.getInstance().logError({eventType:$.S2.ChatEvents,errorMessage:`Error mapping TelemetryStandardizedFeature for operation: ${e}`,logLevel:i.$b.Error})}}logUserStopGeneratingAshaError(e){if(!e)return;const t=this.getFeatureNameFromLatencyOperation(e)??pe.BJ.CopilotChat;this.telemetryLogger.assertFeatureIsActive(t,"logUserStopGeneratingAshaError: Feature from executing command does not match active feature.");const n=(0,pe.xJ)(O.querySubmitTime)<=(0,Ne.Z8j)("Microsoft.Office.Excel.FA000000124.UserCanceledVetoThresholdMs",5e3)?w.c.User_Stopped_Execution_Short:w.c.User_Stopped_Execution;n&&t&&Ae.M.getInstance().logStandardizedAshaErrorEvent(E.W.User_Rejected_Or_Cancelled_Response,n,t)}onExcelTableRecognitionAnnotationResult(e,t){const n=e.body;n&&((0,Ne.JZX)()&&this.xlimWorkflowProgressHandler.handleRecognizedTableAnnotationsReceived(),this.store.dispatch((0,ht.tP)(n,t?.parentRevId)))}onExcelBlobRangeAnnotationResult(e,t){const n=e.body;n&&this.store.dispatch((0,ht.Nn)(n,t?.parentRevId))}onWorkflowProgressAnnotationResult(e){const t=e.body;t.flowId===We.XLIMProgressFlowId&&((0,ke.cY)("XLIMProgressFlow running:",t.running),t.running?this.xlimWorkflowProgressHandler.setWorkflowStarted():this.xlimWorkflowProgressHandler.setWorkflowEnded())}onExcelScratchpadStartSnapshotAnnotation(e){if(e.body&&te.OE.typeGuard(e.body)){const t=e.body;this.responseHandler.startChangeCollector(t.caller)}}async onExecuteScratchpadScriptInClientAnnotation(e){const t=await this.responseHandler.executeScript(e.script,e.caller);return new ne.ft({requestId:(0,ot.A)(),success:t.success,result:JSON.stringify(t.result),documentChanges:t.documentChanges,apiDescriptionHeader:t.apiDescriptionHeader,apiDescriptions:t.apiDescriptions,caller:e.caller,useVisibleObserver:!0})}async onExcelScratchpadExecuteScriptInClientAnnotation(e){if(e.body&&te.Ex.typeGuard(e.body)){const t=e.body,n=await this.responseHandler.executeScript(t.script,t.caller),a=new ne.ft({requestId:(0,ot.A)(),success:n.success,result:JSON.stringify(n.result),documentChanges:n.documentChanges,apiDescriptionHeader:n.apiDescriptionHeader,apiDescriptions:n.apiDescriptions,caller:t.caller,useVisibleObserver:!0}),o=new x.g0({parentPath:["Signal",ne.ft.getTypeName()],items:[{id:ye.r.generateId(),body:a}]});M.$.getInstance().submitOperation({operation:o,workflowAnnotationType:te.Ww.getTypeName()})}}async runExcelAgentOfficeJSScript(e){let t={documentChanges:[]};try{if(e.scriptRequest.scriptType!==K.e.OfficeJs){const t="Unsupported script type: "+e.scriptRequest.scriptType;throw Ae.M.getInstance().logError({eventType:$.S2.ChatEvents,errorMessage:t,logLevel:i.$b.Error}),new oe.f(t)}const{returnResult:n,documentChanges:a,excelDocumentContext:o}=await this.responseHandler.executeOfficeJsFromScriptRunner(e.scriptRequest.script);t={documentChanges:a,returnResult:n,updatedWorkbookContextJson:o}}catch(e){t={documentChanges:[],errorResult:e instanceof oe.f?e.message:"runExcelAgentOfficeJSScript: Unknown error"},Ae.M.getInstance().logError({eventType:$.S2.ChatEvents,errorMessage:t.errorResult??"runExcelAgentOfficeJSScript: Unknown error",logLevel:i.$b.Error})}return new ee.r({requestId:e.requestId,scriptResponse:t})}async onExcelRunScriptAnnotation(e){if(e.body&&Z.l.typeGuard(e.body)){const t=e.body,n=await this.runExcelAgentOfficeJSScript(t),a=new x.g0({parentPath:["Signal",ee.r.getTypeName()],items:[{id:ye.r.generateId(),body:n}]});M.$.getInstance().submitOperation({operation:a,workflowAnnotationType:Z.l.getTypeName()})}}async onConditionalFormattingSuggestionAnnotationResult(e){if(e.body&&N.b.typeGuard(e.body)){const t=e.body,{message:n,telemetry:a}=at.n.getConditionalFormattingSuggestionsResponseMessage(t.Suggestions,t.errorMessage,t.headerMessage,t.guid);this.copilotChatUIHelper.displayResponse(n,a);const o=void 0===t.errorMessage;await this.store.dispatch((0,be.L4)(o))}}async onExcelChartStylesAnnotationResult(e){if((0,Ne.jGm)())if(e.body&&Q.f.typeGuard(e.body)){const t=e.body,n=t.requestId;if(n&&this.chartDesignActiveQueryId!==n)return Ae.M.getInstance().logError({eventType:$.S2.ChartDesignRecommendations,errorMessage:`[ChartDesignRecommendations]: Ignoring late response for timed out chart operation: ${n}`,logLevel:i.$b.Warning}),void this.clearChartDesignTimeout();this.clearChartDesignTimeout();const a=n??(0,ot.A)();this.store.dispatch(Ge.m.setLatestRequestId(a));let r=!0;if(t.ExcelChartStylesSuggestions.length>0&&t.chartId&&t.chartName&&t.sheetId)Re.E.getInstance().updateTelemetryChatEventData({[pe.h3.ChatEventType]:pe.a5.ChartDesignRecommendationsAnnotionReceived,[pe.h3.ChatEventParameters]:JSON.stringify({chartId:t.chartId})},Ae.M.getInstance()),await this.responseHandler.handleChartDesignRecommendationResult(a,t.ExcelChartStylesSuggestions,t.chartId,t.chartName,t.sheetId);else{Ae.M.getInstance().logStandardizedAshaErrorEvent(E.W.Unable_To_Complete_Task,w.c.ChartDesignRecommendationsWorkflowFailed,pe.BJ.ChartDesignRecommendations),Ae.M.getInstance().logError({eventType:$.S2.ChartDesignRecommendations,errorMessage:"[ChartDesignRecommendations]: No suggestions received from Augloop",logLevel:i.$b.Error});const{message:e,telemetry:t}=at.n.getChartDesignRecommendationsFailedResponse((0,o.Hum)(),pe.q0.NoSuggestions);M.$.getInstance().displayResponse(e,t),await this.responseHandler.handleChartDesignNoRecommendationResult(),r=!1}await this.store.dispatch((0,be.L4)(r))}else{Ae.M.getInstance().logError({eventType:$.S2.ChartDesignRecommendations,errorMessage:"[ChartDesignRecommendations]: Did not receive ExcelChartStylesAnnotation object",logLevel:i.$b.Error});const{message:e,telemetry:t}=at.n.getChartDesignRecommendationsFailedResponse((0,o.Hum)(),pe.q0.NoSuggestions);M.$.getInstance().displayResponse(e,t),await this.responseHandler.handleChartDesignNoRecommendationResult()}else Ae.M.getInstance().logError({eventType:$.S2.ChartDesignRecommendations,errorMessage:"[ChartDesignRecommendations]: We should not have received ExcelChartStylesAnnotation when the flight is off",logLevel:i.$b.Error})}handleSuggestionPillClick(e,t=(0,ot.A)()){let n,o;if((0,Ne.ZAR)()){const e=this.store.getState().chat;n=e.currentNLResultTableContext,o=e.currentNLResultTableName}else n=Ve.CP.getActiveTable(),o=n?.name;switch((0,Ne.yw9)("OfficeVSO_9205086_LogSuggestionPillExecutes")||(Ae.M.userQueryGuid=t,this.telemetryLogger.setQuerySource(pe.BC.SuggestionPill),this.telemetryLogger?.resetActiveFeature(),Ie.B.userQueryGuid=t,Ie.B.getInstance().setQuerySource(pe.BC.SuggestionPill),Ie.B.getInstance().resetActiveFeature(),this.telemetryEventHandler.updateTelemetryChatEventData({[pe.h3.ChatEventType]:pe.a5.SuggestionPaneSuggestionClicked,[pe.h3.ChatEventParameters]:e.suggestionType},this.telemetryLogger)),e.suggestionType){case"AnalyzeData_ShowMore":case"AnalyzeData_ShowMoreCharts":case"AnalyzeData_ShowMorePivotTables":case"AnalyzeData_ShowCharts":case"AnalyzeData_ShowPivotTables":this.handleTableSuggestionPillClick(e.suggestionType,n,o);break;case"AnalyzeData_InsertAllCharts":this.store.dispatch((0,ht.AR)());break;case"GiveMeMorePrompts":this.store.dispatch((0,be.Nl)());break;case"AnalyzeData_InsertAll":this.store.dispatch((0,ht.eS)());break;case"AnalyzeData_Suggestion":case"AnalyzeData_SpecificSuggestion":case"AnalyzeData_RelatedQuestions":this.handleSuggestionODSL(e.suggestionText,a.getInsights,t);break;case"Commanding_TellMe":!function(e){e((0,be.Yx)(["Commanding_Suggestion"]));const{message:t,telemetry:n}=at.n.getCommandingTellMeResponse();M.$.getInstance().displayResponse(t,n)}(this.store.dispatch);break;case"CalculatedColumns_ShowMore":if(void 0===e.calculatedFormulaSuggestionMessage)return void(0,ke.cY)("No calculatedFormulaSuggestionMessage found, not enough info to show the CC suggestion");this.store.dispatch((0,Ct.ph)(e.calculatedFormulaSuggestionMessage.requestId,e.calculatedFormulaSuggestionMessage.requestIndex));break;case"CalculatedColumns_GeneralSuggestion":this.handleSuggestionODSL(e.suggestionText,a.getColumnsGeneral,t);break;case"CalculatedColumns_SpecificSuggestion":this.handleSuggestionODSL(e.suggestionText,a.getColumnsFromNL,t);break;case"CalculatedCell_Suggestion":this.handleSuggestionODSL(e.suggestionText,a.getCellsFromNL,t);break;case"ConditionalFormat_Suggestion":this.handleSuggestionODSL(e.suggestionText,a.getConditionalFormatSuggestion,t);break;case"ImportDataFromFile":if(e.properties){const n=e.properties.messageId;(0,yt.yU)(n,t,this.store.dispatch,e.itemClp)}}}handleTableSuggestionPillClick(e,t,n){if(t&&n)switch(e){case"AnalyzeData_ShowMore":this.store.dispatch((0,be.oh)(n,t));break;case"AnalyzeData_ShowMoreCharts":case"AnalyzeData_ShowMorePivotTables":this.store.dispatch((0,be.zA)(n,t));break;case"AnalyzeData_ShowCharts":this.store.dispatch(Ge.m.setLatestRequestId(Ae.M.userQueryGuid)),this.store.dispatch((0,ht.Dz)(n,t,Ae.M.userQueryGuid,"ChartReco"));break;case"AnalyzeData_ShowPivotTables":this.store.dispatch(Ge.m.setLatestRequestId(Ae.M.userQueryGuid)),this.store.dispatch((0,ht.Dz)(n,t,Ae.M.userQueryGuid,"PivotTableReco"))}else Ae.M.getInstance().logError({eventType:$.S2.SuggestionEvents,errorMessage:"handleSuggestionPill failed. No active table found",logLevel:i.$b.Error})}async handleSuggestionODSL(e,t,n){this.telemetryLogger.startTriedActivity(),await this.handleCommandExecutionStart(e,n,pe.a5.SuggestionPaneSuggestionClicked);let a=A[t];a=a.replace("{{messageText}}",e);const o=JSON.parse(a);try{await this.responseHandler.executeOdsl(o,n)}catch(e){throw e}}resetUnsupportedTlrPromptSuggestions(e){switch(e.suggestionType){case"Tlr_ExplainHeaders":case"Tlr_ExplainTables":case"Tlr_ExplainUnmergingCells":this.store.dispatch(Ge.m.clearSuggestionList())}}async getPromptById(e,t){const n=await this.getContextSensitiveHelpPrompt(e,t);if(void 0!==n){const t={promptId:e.toLowerCase()};return Ie.B.getInstance().sendChatEventTelemetry((0,pe.pN)({[pe.h3.ChatEventType]:pe.a5.CSHScenarioRun,[pe.h3.ChatEventParameters]:JSON.stringify(t)})),n}}async getPromptWithFormulaPlaceholer(e,t,n){if(void 0!==n.cellRow&&void 0!==n.cellCol){const t=await async function(e,t){let n="";return await Excel.run((async a=>{const o=a.workbook.worksheets.getActiveWorksheet().getCell(e,t);o.load("formulas"),await a.sync(),1===o.formulas.length&&(n=o.formulas[0].toString())})),n}(n.cellRow,n.cellCol);if(t)return(0,Ze.VY)(e,{formula:t})}return t}async getContextSensitiveHelpPrompt(e,t){switch(e.toLowerCase()){case"dd656fbd-fc5b-4e21-88bb-2b6ce622cc2e":if(void 0!==t.cellRow&&void 0!==t.cellCol){const e=await async function(e,t){let n="";return await Excel.run((async a=>{const o=a.workbook.worksheets.getActiveWorksheet().getCell(e,t);if(o.load(["valuesAsJsonLocal"]),await a.sync(),1===o.valuesAsJsonLocal.length){const e=o.valuesAsJsonLocal[0][0];e.errorMessage&&e.errorName?n=`${e.errorName}: ${e.errorMessage}`:e.errorMessage&&(n=e.errorMessage)}})),n}(t.cellRow,t.cellCol);if(e)return(0,Ze.VY)((0,o.P82)(),{error:e})}return;case"f9ad6e18-f3c7-4346-8e1a-896849997b0d":return this.getPromptWithFormulaPlaceholer((0,o.ENk)(),(0,o.fRc)(),t);case"606f60ec-8401-418d-9f19-3c133e933ab1":return this.getPromptWithFormulaPlaceholer((0,o.mk8)(),(0,o.nhC)(),t);case"fd986fa8-18fa-47e6-bd6c-5278924c4fe3":return this.getPromptWithFormulaPlaceholer((0,o.EW5)(),(0,o.fu2)(),t);case"f4d3aafb-8190-46a9-bc20-cafe606dfd2d":return this.getPromptWithFormulaPlaceholer((0,o.IpP)(),(0,o.TTT)(),t);case"a49c05e9-ca3b-4a32-ac67-c56bd16a583b":return this.getPromptWithFormulaPlaceholer((0,o.B3O)(),(0,o.qbB)(),t);case"60baa1dd-aecf-42b2-9f89-a0be53a05a5a":return this.getPromptWithFormulaPlaceholer((0,o.gNJ)(),(0,o.JAc)(),t);case"8e05d9ff-5505-4c7d-925d-2cdbc7555da9":return this.getPromptWithFormulaPlaceholer((0,o.t8C)(),(0,o.I$d)(),t);case"117a47c2-8673-4631-af47-ab87bd8db3d3":return this.getPromptWithFormulaPlaceholer((0,o.I$I)(),(0,o.fzU)(),t);case"520eb606-caea-4c4d-9ebb-7da8aa8a76e5":return this.getPromptWithFormulaPlaceholer((0,o.J$y)(),(0,o.irK)(),t);case"4caf9f84-2dcd-4018-a8b1-8d3ea494eb5d":return this.getPromptWithFormulaPlaceholer((0,o.pDo)(),(0,o.I64)(),t);case"cfa8a08b-607b-435e-96b7-fa3c171da97b":return this.getPromptWithFormulaPlaceholer((0,o.ijW)(),(0,o.LC$)(),t);case"e8cd5204-4fe3-4564-82b1-cf17942c0da6":return(0,o.hEI)();case"73dba87b-93cd-4d77-92a7-f0eec75c3a3f":return(0,o.v3q)();case"c78d7f1e-3542-4463-b844-5eb8b5d53cdf":return(0,o.uVJ)();case"58fb1fe7-479e-42bd-a5e4-d270934a39d1":return(0,o.j0F)();case"b52dc308-99ca-48b2-9611-9f108902bf48":return(0,o.NSY)();case"a6b2d8eb-8c55-4d1f-81ae-be3e8f21122c":return(0,o.wUB)();case"de300c60-54c6-49f8-b049-418fdfc14bda":return(0,o.Q0)();case"a229a616-09dc-4f98-ab74-ef5e6ecb72e3":return(0,o.RT6)();case"12f792d7-c735-469e-8ef3-15fd1031e776":return(0,o.kDR)();case"e90809a8-1c84-4f53-bbcf-b1dccf36c528":return(0,o.Y2N)();case"c5900890-e61e-43ce-a549-03915cc3310c":return(0,o.qU2)();case"c0917abf-f982-4435-9b1b-37cad3f3d104":return(0,o.RV_)()}}async handleStartQuery(){let e=ue.V.getSetting(ue.z.CopilotInitialPrompt);if((0,Ne.wQA)()||xt.isPublicApiInitialized||await Ve.CP.initPublic((0,ge.KA)().dispatch),(0,Ne.yw9)("OfficeVSO_9601910_ExcelSdxUnifiedSendPrompt")&&e){(0,ke.cY)("Handling CopilotInitialPrompt: "+e.toString());try{e=JSON.parse(e)}catch(e){}if(Ft(e))return void await this.handleUnifiedPrivateApiExternalTriggeredPrompt(e);(0,ke.cY)("CopilotInitialPrompt not recognized as correct type")}let t=ue.V.getSettingAsString(ue.z.CopilotStartQuery);if(t){try{t=JSON.parse(t)}catch(e){}return(0,ke.cY)("Handling legacy CopilotStartQuery: "+t),void await this.submitExternalQuery(t,pe.BC.ExternalQuery)}const n=ue.V.getSettingAsString(ue.z.CopilotStartPromptId);if(n){const e=JSON.parse(n),t={cellRow:ue.V.getSetting(ue.z.CopilotStartPromptCellRow),cellCol:ue.V.getSetting(ue.z.CopilotStartPromptCellCol)},a=await this.getPromptById(e,t);a&&await this.submitExternalQuery(a,pe.BC.ExternalQuery)}}async submitExternalQuery(e,t,n,a,o,r,l,s,c,d,u,m,g){const{message:h,telemetry:p}=at.n.getExternalTriggeredQueryResponse(e,!!a),b="PythonAASuggestion"===u;if((0,Ne.jGm)()&&"ExcelChartStyles"===u){if(this.ignoreExcelChartStylesWorkflow){const{message:e,telemetry:t}=at.n.getChartRecommendationsInProgressResponse();return void M.$.getInstance().displayResponse(e,t)}this.ignoreExcelChartStylesWorkflow=!0,Re.E.getInstance().updateTelemetryChatEventData({[pe.h3.ChatEventType]:pe.a5.ChartDesignRecommendationsActivated,[pe.h3.ChatEventParameters]:JSON.stringify({chartId:c})},Ae.M.getInstance())}else this.copilotChatUIHelper.displayResponse(h,p);if(this.updateCopilotState(v.SG.QUERY_ENTERED),(0,Ne.yw9)("OfficeVSO_9579802_ContextMenuPromptDelay")){const n=o??(0,ot.A)();let a;if((0,Ne.xLF)()&&(r&&this.store.dispatch(Ge.m.setQueryOriginByQueryId({queryId:n,queryOrigin:r})),l&&this.store.dispatch(Ge.m.setOnGridQueryCellAddressByQueryId({queryId:n,onGridQueryCellAddress:l})),g&&this.store.dispatch(Ge.m.setOnGridQueryElseCategoryOverrideByQueryId({queryId:n,elseCategoryOverride:g}))),this.telemetryLogger.setQuerySource(t),Ie.B.getInstance().setQuerySource(t),(0,Ne.jGm)()&&"ExcelChartStyles"===u&&c){const e=r===F.Rk.GridSkittleMenu||"ViaOOUI"===r?.toString(),t=new Q.w;try{[t.chartProperties,t.sheetId]=await async function(e,t,n){return Excel.run((async a=>{const o=t?a.workbook.worksheets.getItemOrNullObject(t):a.workbook.worksheets.getActiveWorksheet(),r=o.charts.getItem(e);r.load(["chartType","name","id"]),o.load(["name"]);const i=r.getDataRange();if(await a.sync(),t&&o.isNullObject)throw new Error("Worksheet sent from the prompt does not exist.");const l=r.chartType,s=ct.ExcelCalc.sheetAddressToExcelSheetRange(i.value);let c=dt(s.range,o.id);if(n&&s){const e=a.workbook.worksheets.getItemOrNullObject(s.sheet);if(await a.sync(),!e.isNullObject){const t=await Ve.CP.getClosestTableInfo(e.id,i.value);if(!t)throw new Error("No closest table found for snowball chart");if(t.tabularRange)c=dt(t.tabularRange.range,e.id);else{if(!t.name)throw new Error("No range found for snowball chart");const n=e.tables.getItemOrNullObject(t.name);if(await a.sync(),n.isNullObject)throw new Error("No table found for snowball chart");const r=n.getRange();await a.sync(),r.load(["address"]),await a.sync();const i=r.address;if(!i)throw new Error("No table address found for snowball chart");c=dt(ct.ExcelCalc.sheetAddressToExcelSheetRange(i).range,o.id)}}}return[{chartType:l.toString(),chartSourceDataRange:c,seriesSourceDataRange:[],chartId:r.id,chartName:r.name},o.name]}))}(c,s,d)}catch(t){if(Ae.M.getInstance().logError({eventType:$.S2.ChartDesignRecommendations,errorMessage:"[ChartDesignRecommendations]: Error fetching chart properties",logLevel:i.$b.Error}),d){const{message:t,telemetry:n}=at.n.getChartDesignRecommendationsSnowballChartResponseMessage(o||(0,ot.A)(),e);this.copilotChatUIHelper.displayResponse(t,n)}return void(this.ignoreExcelChartStylesWorkflow=!1)}this.copilotChatUIHelper.displayChartStylesResponse(o||(0,ot.A)(),e,(()=>{this.ignoreExcelChartStylesWorkflow=!1})),t.guid=n,t.uiLocale=(0,ie.Yd)(),t.outputLanguage="English";const l=await Excel.run((async e=>(0,pt.A7)(e)));t.themeColors=l();a={operation:new x.g0({parentPath:["Signal",Q.w.getTypeName()],items:[{id:ye.r.generateId(),body:t}]}),workflowAnnotationType:Q.f.getTypeName()},setTimeout((()=>{(0,He.qK)("OfficeJsChartDesignRecommendations",this.store.dispatch((0,gt.Z)()).dataLocale||"en-us",!0)}),6e3),this.startChartDesignTimeout(n)}else a=await this.getDefaultSignalOperation(e,n,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,m,b);if(await Ve.CP.initMemo.promise(),!await this.shouldSendRequestToAugloop(e))return;(0,Ne.xLF)()||(r&&this.store.dispatch(Ge.m.setQueryOriginByQueryId({queryId:n,queryOrigin:r})),l&&this.store.dispatch(Ge.m.setOnGridQueryCellAddressByQueryId({queryId:n,onGridQueryCellAddress:l}))),this.copilotChatUIHelper.submitOperation(a)}else{if(await Ve.CP.initMemo.promise(),!await this.shouldSendRequestToAugloop(e))return;const n=o??(0,ot.A)();this.telemetryLogger.setQuerySource(t),Ie.B.getInstance().setQuerySource(t),r&&this.store.dispatch(Ge.m.setQueryOriginByQueryId({queryId:n,queryOrigin:r})),l&&this.store.dispatch(Ge.m.setOnGridQueryCellAddressByQueryId({queryId:n,onGridQueryCellAddress:l})),(0,Ne.xLF)()&&g&&this.store.dispatch(Ge.m.setOnGridQueryElseCategoryOverrideByQueryId({queryId:n,elseCategoryOverride:g}));const a=await this.getDefaultSignalOperation(e,n,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,m,b);this.copilotChatUIHelper.submitOperation(a)}n||this.updateCopilotState(v.SG.QUERY_SUBMITTED)}async handlePrivateApiExternalTriggeredQuery(e){if(!e.query)return void(0,ke.cY)("externalTriggeredQuery query is missing");if(e.deprecated&&(0,Ne.yw9)("OfficeVSO_9601910_ExcelSdxUnifiedSendPrompt"))return void(0,ke.cY)("Ignoring deprecated PrivateApiExternalTriggeredQuery");const t=await this.store.dispatch((0,be.q9)());if(t)return void(0,ke.cY)("Cannot handle externalTriggeredQuery, busy executing: "+t);const n=e.query;await this.submitExternalQuery(n,pe.BC.ExternalQuery)}async handleUnifiedPrivateApiExternalTriggeredPrompt(e){if(!(0,Ne.yw9)("OfficeVSO_9601910_ExcelSdxUnifiedSendPrompt"))return;if(!e.promptProperties)return void(0,ke.cY)("promptProperties is missing");const t=e.promptProperties,n=await this.store.dispatch((0,be.q9)());if(n)return void(0,ke.cY)("Cannot handle externalTriggeredQuery, busy executing: "+n);if(!(0,Ne.jWB)()&&(0,Ne.UW0)()&&(0,Ne.uY4)()){if(this.shouldHandoffToBizChat())return void J.Y.getInstance().handleHandoffMessage({id:t.sendPromptText,body:new le.uC({query:t.sendPromptText,sourceApp:ce.Ww.EXCEL,destinationApp:ce.Ww.EXCEL,scenarioName:ce.Cu.INAPP,context:JSON.stringify({featureName:de.ur.CopilotContextMenuClickAction}),queryId:(0,ot.A)(),language:this.store.getState().app.localeInfo.dataLocale||"en-US"})},"",!0,this.copilotChatUIHelper?.getCopilotRef(),this.setBizChatHostContextState,this.bizChatHostContext,J.Y.getInstance().getBizChatHandoffPropertiesHandler());this.setBizChatHostContextState({PrimaryUserAccountInfo:{...this.bizChatHostContext?.PrimaryUserAccountInfo,CopilotExperience:"AppChat"}})}if(!t.sendPromptText)return void(0,ke.cY)("sendPromptText is missing");const a=t.sendPromptText;this.userQueryGuid=t.userQueryGuid,this.isExternalQuerySubmitted=!0,this.queryOrigin=t.queryOrigin;let o=pe.BC.ExternalQuery;t.queryOrigin===F.Rk.MsFormsSDX?o=pe.BC.MsFormsSDX:t.queryOrigin===F.Rk.AAChartingRibbon&&(o=pe.BC.AAChartingRibbon),await this.submitExternalQuery(a,o,t.isAutomaticPrompt,t.isMarkdownText,t.userQueryGuid,t.queryOrigin,t.queryOriginCellAddress,t.sheetName,t.chartId,t.isSnowballChart,t.activateWorkflow,t.fluxSkillOverride,t.elseCategoryOverride)}async handlePrivateApiExternalTriggeredPromptId(e){if(!e.promptId)return void(0,ke.cY)("externalTriggeredPromptId, promptId is missing");const t=await this.store.dispatch((0,be.q9)());if(t)return void(0,ke.cY)("Cannot handle externalTriggeredPromptId, busy executing: "+t);const n={cellRow:e.cellRow,cellCol:e.cellCol},a=await this.getPromptById(e.promptId,n);a?await this.submitExternalQuery(a,pe.BC.ExternalQuery):(0,ke.cY)("No prompt found for promptId",e.promptId)}handlePrivateApiExternalDisplayMessages(e){(0,ke.cY)("Received externalDisplayMessages",e);const t=e.messages;for(const e of t){if(this.copilotChatUIHelper.getHasMessageBeenShown(e.messageId,!0))continue;const{message:t,telemetry:n}=at.n.getExternalMessageResponse(e);if(this.copilotChatUIHelper.displayResponse(t,n),e.suggestions){const t=e.suggestions.map((e=>({suggestionText:e,suggestionType:"SydneySuggestion"})));t.length>0&&this.store.dispatch(Ge.m.setSuggestionListDetails({suggestionList:t}))}}t.length>0&&this.copilotChatUIHelper.scrollToBottom()}resetExternalQuerySubmitted(){this.isExternalQuerySubmitted=!1,this.userQueryGuid=void 0}logExternalQuerySubmitted(){this.userQueryGuid&&this.telemetryEventHandler.updateTelemetryChatEventData({[pe.h3.ChatEventType]:pe.a5.ExternalQuery,[pe.h3.Submitted]:this.isExternalQuerySubmitted?"true":"false",[pe.h3.UserQueryGuid]:this.userQueryGuid},this.telemetryLogger)}attachPrivateApiHandlers(){ae.s.getInstance().attachPrivateEventHandler("externalTriggeredQuery",(e=>{var t;t=e,void 0!==t?.eventName&&void 0!==t?.query&&this.handlePrivateApiExternalTriggeredQuery(e)})),(0,Ne.jWB)()||ae.s.getInstance().attachPrivateEventHandler("unifiedExternalTriggeredPrompt",this.unifiedPromptHandler),ae.s.getInstance().attachPrivateEventHandler("externalTriggeredPromptId",(e=>{var t;t=e,void 0!==t?.eventName&&void 0!==t?.promptId&&this.handlePrivateApiExternalTriggeredPromptId(e)})),ae.s.getInstance().attachPrivateEventHandler(_t,(e=>{var t;t=e,t?.eventName===_t&&void 0!==t?.messages&&this.handlePrivateApiExternalDisplayMessages(e)})),ae.s.getInstance().sendOnReadyEvent("copilotMessageHandlerAttached")}preloadAcceessTokenForOfficePySvc(){if((0,Ne.Ap6)()){(0,Rt.J)(Lt.UU,Lt.rE);const e=(new Date).getTime();fe.v.instance().authorizeOfficePyService((0,ot.A)()).then((()=>{(0,Te.l5)(Te.xk.PreloadOfficePyServiceAccessToken,e,0)})).catch((t=>{(0,Te.l5)(Te.xk.GetOfficePyServiceAccessToken,e,0,!0);const n=(0,Je.MQ)(t,"preloadAcceessTokenForOfficePySvc"),a=(0,Je.Uc)(V.O.GetOfficePyServiceAccessTokenFailed,n,void 0);(0,Je.QX)(this.store.dispatch,a,!1)}))}}async handlePythonStartAnalysis(e){const t=(new Date).getTime();try{this.store.dispatch(Ge.m.setPythonStartAnalysisButtonDisabled(!0)),Ve.CP.pythonContextManager.shouldGenerate=!0,this.updateCopilotState(v.SG.QUERY_ENTERED);const n=(0,ot.A)();Ae.M.userQueryGuid=n,Ie.B.userQueryGuid=n,e&&(this.telemetryLogger.setQuerySource(e),Ie.B.getInstance().setQuerySource(e)),this.preloadAcceessTokenForOfficePySvc(),(0,Te.F5)();const a=Ve.CP.pythonContextManager.pythonTrimmedContext.getTrimmedContextSheetId(),o=Ve.CP.pythonContextManager.pythonTrimmedContext.getTrimmedContextAddress(),r=await Ve.CP.pythonContextManager.pythonContextBuilder.getAllPythonCellsUptoAnalysisSheetWithTimeout(this.store.dispatch,a,o);if(await Ve.CP.pythonContextManager.pythonTrimmedContext.insertDataFrameIfNecessaryForStartAnalysis(r,this.store.dispatch),!Ve.CP.pythonContextManager.shouldGenerate)return;await Ve.CP.pythonContextManager.pythonTrimmedContext.setPythonStartAnalysisContext(r),(0,Te.Cc)(Te.xk.StartAnalysisContextExtraction,t,!1);const i=Ve.CP.pythonContextManager.pythonTrimmedContext.getTrimmedContextQuery();if(!i){const e="Undefined Item: query, Function: handleStartPythonAnalysis";throw(0,Je.Uc)(V.O.PythonContextUndefinedParameter,e,void 0)}this.store.dispatch(Ge.m.stopExecuting({isSuccess:!0,keepShowingLoadingUIIfAlreadyActive:!0}));const l=await this.getDefaultSignalOperation(i,n);(0,Te.lu)(),this.copilotChatUIHelper.submitOperation(l),this.updateCopilotState(v.SG.QUERY_SUBMITTED),this.store.dispatch(Ge.m.setSuggestionListDetails({suggestionList:[],nextSuggestionTypePriorities:[],shouldResetRecentPrompts:!0,isPythonSuggestion:!0})),Ve.CP.pythonContextManager.lastStartAnalysisQueryGuid=n}catch(e){throw(0,Te.Cc)(Te.xk.StartAnalysisContextExtraction,t,!0),e}}async handlePythonAdaExecutionResult(){this.updateCopilotState(v.SG.QUERY_ENTERED);const e=(0,ot.A)();Ae.M.userQueryGuid=e,Ie.B.userQueryGuid=e;const t=Ve.CP.pythonContextManager.pythonTrimmedContext.getTrimmedContextQuery();if(!t){const e="Undefined Item: query, Function: handlePythonAdaExecutionResult";throw(0,Je.Uc)(V.O.PythonContextUndefinedParameter,e,void 0)}this.store.dispatch(Ge.m.stopExecuting({isSuccess:!0,keepShowingLoadingUIIfAlreadyActive:!0}));const n=await this.getDefaultSignalOperation(t,e);(0,ke.cY)(`signalOperationData: ${n}`),(0,Te.lu)(),this.copilotChatUIHelper.submitOperation(n),this.updateCopilotState(v.SG.QUERY_SUBMITTED)}async handleTextAnalysisSuggestionQuerySubmission(e){await this.submitExternalQuery(e,pe.BC.MenuItem)}getPythonMode(){return Ve.CP.pythonContextManager.isPythonMode}getIsAutoScrollingEnabled(){return Ve.CP.pythonContextManager.isAutoScrollingEnabled}onNewUserUtterance(){(0,he.s_)(he.H0.RemoveAll)}getFluxSkillOverride(e,t){const n=!!(0,Ne.eFk)()&&this.store.dispatch((0,be.SW)()).started;if((0,Ne.EJJ)()&&!Ve.CP.pythonContextManager.isPythonMode&&this.isZQMForAnswers(e))return Pt["flux-answers"];if((0,Ne.H2A)()&&Ve.CP.pythonContextManager.isPythonMode)return(0,Ne.EJJ)()?Pt["flux-startAnalysisMode"]:Pt["flux-pythonAda"];if(n)return Pt["flux-dataShaping"];if(this.cannedOption)return Pt[this.cannedOption];if((0,Ne.geU)()){return(0,Ne.wyh)()??void 0}return t&&(0,Ne.xLF)()&&(0,Ne.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.FluxSkillOverrideFromGrid",!1)?t:void 0}isZQMForAnswers(e){const t=e.trim().toLowerCase(),n=t===(0,o.N_T)().toLowerCase().trim(),a=t===(0,o.xf7)().toLowerCase().trim(),r=t===(0,o.pKA)().toLowerCase().trim(),i=t===(0,o.YYh)().toLowerCase().trim(),l=t===(0,o.Coj)().toLowerCase().trim(),s=(0,Ne.ggM)()&&t===(0,o.Bzb)().toLowerCase().trim();return n||a||r||i||l||s}getQueryOrigin(e){function t(t){return t.map((e=>e.toLowerCase())).includes(e.toLowerCase())}return t(Object.values(this.zeroQueryMessageTitles))?F.Rk.ChatZQM:t(this.suggestionList.map((({suggestionText:e})=>e)))?F.Rk.ChatPill:void 0}getClientCapabilities(){const e=[];return(0,Tt.Qo)(this.store.dispatch)&&e.push(_.m.NonODSLFormulaGenerationSkill),(0,Ne.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.FormulaGenerationNewNlToFormulaSkill",!1)&&e.push(_.m.UnifiedNLToFormulaGenerationSkill),e.length>0?e:void 0}getAppEnvironment(){switch(ue.V.getSettingAsString(ue.z.AudienceGroup)){case f.Bv.Automation:case f.Bv.Test:case f.Bv.Dogfood:return S.D.DOGFOOD;case f.Bv.MSIT:case f.Bv.Microsoft:return S.D.PRODUCTION;case f.Bv.GCC:return S.D.GCC;default:return S.D.PRODUCTION}}getM365ChatEnvironment(){switch(ue.V.getSettingAsString(ue.z.AudienceGroup)){case f.Bv.Automation:case f.Bv.Test:case f.Bv.Dogfood:return me.RD.Dogfood;case f.Bv.MSIT:case f.Bv.Microsoft:return me.RD.MSIT;case f.Bv.Prod:case f.Bv.Production:return me.RD.Production;case f.Bv.GCC:return me.RD.GCCModerate;default:return me.RD.Unknown}}setBizChatHostContext(e){this.bizChatHostContext=e}setBizChatHostContextSetter(e){this.setBizChatHostContextState=e}setCopilotChatLoadedSetter(e){this.setCopilotChatLoadedState=e}getPopulateCellCount(){return Excel.run((e=>{const t=e.workbook.worksheets.getActiveWorksheet().getUsedRange();return t.load("values"),e.sync().then((()=>{let e=0;return t.values.forEach((t=>{t.forEach((t=>{null!=t&&""!==t&&e++}))})),e}))}))}async getDocumentContextFromDocumentUrlAsync(){const e=await(0,ie.H5)(),t=I.Kj.init({authProvider:async e=>{const t=await(0,Ze.m4)(),n=t.preferredAuthenticationStrategy??"Default";let a;a=(0,Ne.AJD)()&&t.nestedAppAuthRedirectUri&&"NestedAppAuth"===n?new H.G({userPrincipalName:t.userPrincipalName,redirectUri:t.nestedAppAuthRedirectUri,clientId:C.pL}):new U.a({userPrincipalName:t.userPrincipalName,redirectUri:t.redirectUri,clientId:C.pL});e(null,(await(0,y.v)(a,"https://graph.microsoft.com")).accessToken)},baseUrl:"https://graph.microsoft.com"}),n=await t.api(`/shares/u!${btoa(e)}/root?$select=sharepointIds,id,name`).get(),a=n?.sharepointIds?.siteId,o=n?.sharepointIds?.webId,r=n?.sharepointIds?.listId,i=n?.id;return{spoId:`SPO_${btoa(`${a},${o},${r}`)}_${i}`.replace(/=/g,""),fileName:n.name}}shouldHandoffToBizChat(){return this.isCopilotChatLicensedUser()&&(0,Ne.UIZ)()}isCopilotChatLicensedUser(){if(!this.bizChatHostContext?.PrimaryUserAccountInfo)return!1;const e=this.bizChatHostContext.PrimaryUserAccountInfo.AggregatedLicensedFeatures??this.bizChatHostContext.PrimaryUserAccountInfo.LicensedFeatures??void 0;return!!e&&(!e.includes("Copilot")&&(e.includes("CopilotStarter")||e.includes("CopilotChat")))}startChartDesignTimeout(e){const t=(0,Ne.kRR)();this.chartDesignActiveQueryId=e,this.chartDesignActiveQueryTimeoutId=setTimeout((async()=>{(0,ke.cY)(`Chart design operation timed out: ${e}`),this.chartDesignActiveQueryId=void 0,Ae.M.getInstance().logError({eventType:$.S2.ChartDesignRecommendations,errorMessage:`[ChartDesignRecommendations]: Chart operation timed out after ${t}ms: ${e}`,logLevel:i.$b.Error});try{const{message:e,telemetry:t}=at.n.getChartDesignRecommendationsFailedResponse((0,o.Hum)(),pe.q0.NoSuggestions);M.$.getInstance().displayResponse(e,t),await this.responseHandler.handleChartDesignNoRecommendationResult()}catch(e){Ae.M.getInstance().logError({eventType:$.S2.ChartDesignRecommendations,errorMessage:`[ChartDesignRecommendations]: Error handling timeout: ${e}`,logLevel:i.$b.Error})}}),t)}clearChartDesignTimeout(){this.chartDesignActiveQueryTimeoutId&&(clearTimeout(this.chartDesignActiveQueryTimeoutId),this.chartDesignActiveQueryTimeoutId=void 0),this.chartDesignActiveQueryId=void 0}handleHandoffMessageHostAppSettingsIfNeeded(){this.shouldHandoffToBizChat()&&J.Y.getInstance().handleHandoffMessageHostAppSettings(this.setBizChatHostContextState,this.bizChatHostContext,this.handleStartQuery.bind(this))}constructor(e,t,n){super(),this.telemetryLogger=Ae.M.getInstance(),this.telemetryEventHandler=Re.E.getInstance(),this.copilotChatUIHelper=M.$.getInstance(),this.suggestionList=[],this.zeroQueryMessageTitles={},this.loggingEventHelper=new $e([]),this._cannedOption=void 0,this.sessionRestartedDueToModelWorkflowNotSupported=(0,st.$q)(),this.xlimWorkflowProgressHandler=new We,this.isExternalQuerySubmitted=!1,this.ignoreExcelChartStylesWorkflow=!1,this.suggestionPillShown=new Set,this.debugEvents=new EventTarget,this.bizChatHostContext=void 0,this.setBizChatHostContextState=()=>{},this.setCopilotChatLoadedState=()=>{},this.unifiedPromptHandler=async e=>{Ft(e)&&(this.resetExternalQuerySubmitted(),await this.handleUnifiedPrivateApiExternalTriggeredPrompt(e),this.logExternalQuerySubmitted())},this.store=e,this.responseHandler=t,this.handleCopilotAgentFromHostRequest=n,this.initializeAlCallbacks()}}},65448:(e,t,n)=>{"use strict";n.d(t,{Fl:()=>r,OY:()=>c,ub:()=>d});var a=n(279395),o=n(573367);function r(e,t,n){if(t)return"...";const a=Number.parseFloat(e.toPrecision(9));return-1===n?a.toString():a.toFixed(n)}function i(e,t){let n;return n="number"!=typeof e||t?e?.value?.toString()||"":r(e,!1,-1),n}function l(e){return e?a.olU.NoValueAnswerTextForNLInsight:a.olU.NoValueAnswerTextForIdeas}function s(e,t){const n=e=>"|"+e.join("|")+"|\n";let a="";for(let t=0;t<e.length;t++)a+=n(e[t]);a+=n(e[0].map((e=>"---")));for(let e=0;e<t.length;e++)a+=n(t[e]);return a}function c(e){const{pivotTableData:t,grandTotalRowIndex:n,subTotalRowIndices:a}=e;if(t&&0===t.length)return l(!1);const r=(0,o.HF)(e),c=t[0].map(((e,n)=>t.map((e=>e[n]))));return s(c.slice(0,r).map((e=>e.map((e=>i(e,!0))))),(()=>{const e=[],t=c.slice(r,n);for(let n=0;n<t.length;n++){if(!!a&&a.length>0&&a.some((e=>e===n+r)))continue;const o=t[n].map((e=>i(e,!1)));e.push(o)}return e})())}function d(e){if(0===e.fields.length)return l(!0);if(0===e.fields[0].values.raw.length)return l(!1);const t=[e.fieldHeaders.map((e=>i({value:e.runs.map((e=>e.text)).join(""),isNumber:!1,indent:0},!0)))],n=e.fields[0].values.raw.length,a=[];for(let t=0;t<n;t++){const n=[];for(let a=0;a<e.fields.length;a++){const o=e.fields[a].values;if(o.formattedValues){const e=o.formattedValues[t];n.push(i(e,!1))}else{const e=o.strings[t],a=o.raw[t],r={value:e||a,isNumber:!1,indent:0};n.push(i(r,!1))}}a.push(n)}return s(t,a)}},69336:(e,t,n)=>{"use strict";e.exports=n.p+"assets/like-icon.svg"},75496:(e,t,n)=>{"use strict";var a,o,r,i,l,s,c,d,u,m,g,h,p,b,f,C,y,v,T,x,S;n.d(t,{$:()=>m,A:()=>S,E_:()=>i,HR:()=>C,IC:()=>c,IM:()=>T,IX:()=>p,L3:()=>h,Qs:()=>s,S2:()=>a,Wg:()=>o,Zf:()=>x,d:()=>g,f8:()=>y,fQ:()=>d,j9:()=>v,jo:()=>b,nn:()=>r,tE:()=>l,tM:()=>u,xm:()=>f}),function(e){e.Augloop="Augloop",e.Error="Error",e.Latency="Latency",e.Warning="Warning",e.ChatEvents="ChatEvents",e.OfficeJsOperations="OfficeJsOperations",e.Converter="Converter",e.Executor="Executor",e.NoEventGenerated="NoEventGenerated",e.NoEventExecuted="NoEventExecuted",e.StatementArgumentError="StatementArgumentError",e.ConverterError="ConverterError",e.AnalyzeDataDuration="AnalyzeDataDuration",e.AnalyzeDataError="AnalyzeDataError",e.AnalyzeDataEvents="AnalyzeDataEvents",e.SuggestionEvents="SuggestionEvents",e.ContextManager="ContextManager",e.CitationFileUtils="CitationFileUtils",e.ImportData="ImportData",e.PowerQueryHelper="PowerQueryHelper",e.Usage="Usage",e.TabularRange="TabularRange",e.WorkbookContext="WorkbookContext",e.AuthError="AuthError",e.Undo="Undo",e.FormulaGeneration="FormulaGeneration",e.UncaughtException="UncaughtException",e.PythonDuration="PythonDuration",e.PythonEvents="PythonEvents",e.PythonError="PythonError",e.OfficeScriptSkillHandler="OfficeScriptSkillHandler",e.OfficeScriptsContextManager="OfficeScriptsContextManager",e.OfficeScriptsRename="OfficeScriptsRename",e.Localization="Localization",e.FetchCitationMetadata="FetchCitationMetadata",e.FetchTablesRelevancy="FetchTablesRelevancy",e.GetResolvedCitations="GetResolvedCitations",e.StreamHandler="StreamHandler",e.RefreshRibbonGallery="RefreshRibbonGallery",e.MakerStorageEvent="MakerStorageEvent",e.SpecialRefApiUpdated="SpecialRefApiUpdated",e.UserContextAnnotation="UserContextAnnotation",e.AssertionFailed="AssertionFailed",e.AuthSuccess="AuthSuccess",e.AutoFixTLR="AutoFixTLR",e.ImageChat="ImageChat",e.FormatMetadataFallback="FormatMetadataFallback",e.AugloopDiagnostics="AugloopDiagnostics",e.DataShaping="DataShaping",e.ZeroQueryMessageClicks="ZeroQueryMessageClicks",e.CommandingScratchpad="CommandingScratchpad",e.CommandingError="CommandingError",e.ChartDesignRecommendations="ChartDesignRecommendations",e.Safelinks="Safelinks"}(a||(a={})),function(e){e.UserQueryGuid="UserQueryGuid",e.UserQueryGuid_="userQueryGuid",e.ClientVersion="ClientVersion",e.GroundingMode="GroundingMode",e.IsDevBuild="IsDevBuild",e.UiLanguage="UiLanguage",e.QuerySource="querySource",e.IsPythonAdaInCopilotEnabled="IsPythonAdaInCopilotEnabled",e.GroundingMode_="groundingMode",e.SuggestionId="suggestionId",e.Source="Source",e.SelectionChange="selectionChange",e.UnsupportedWorkflow="UnsupportedWorkflow",e.TableMetadata="TableMetadata",e.FetchType="FetchType",e.PythonFlights="PythonFlights",e.IsPythonThinkDeeperMode="IsPythonThinkDeeperMode",e.IsModelessPythonAAEnabled="IsModelessPythonAAEnabled",e.ActiveFeatureName="ActiveFeatureName",e.CopilotExperience="CopilotExperience"}(o||(o={})),function(e){e.Operation="operation"}(r||(r={})),function(e){e.Event="event",e.QueryId="queryId",e.Success="success",e.FoundCallback="foundCallback",e.Duration="duration"}(i||(i={})),function(e){e.ActionType="ActionType",e.FeatureName="FeatureName",e.Source="Source",e.SuggestionId="SuggestionId",e.UserQueryGuid="UserQueryGuid",e.ActionVariant="ActionVariant"}(l||(l={})),function(e){e.PromptDescription="PromptDescription"}(s||(s={})),function(e){e.RequestId="RequestId",e.Success="Success",e.ExecutionTime="ExecutionTime",e.Error="Error",e.TotalFiles="TotalFiles",e.ResolvedCitations="ResolvedCitations",e.ResolvedValidCitations="ResolvedValidCitations",e.UnresolvedCitations="UnresolvedCitations",e.ResolvedDataSources="ResolvedDataSources",e.ValidDataSources="ValidDataSources"}(c||(c={})),function(e){e.Source="Source",e.Operations="Operations"}(d||(d={})),function(e){e.ConversationHistoryCount="ConversationHistoryCount",e.DidAugloopCallFail="DidAugloopCallFail",e.DidInsert="DidInsert",e.Duration="Duration",e.CodeErrorCount="CodeErrorCount",e.FormulasProcessed="FormulasProcessed",e.FormulasProcessedPerWorksheet="FormulasProcessedPerWorksheet",e.IsErrorCaught="IsErrorCaught",e.IsPythonCellSelected="IsPythonCellSelected",e.IsStopGenerating="IsStopGenerating",e.IsSuccess="IsSuccess",e.OptionalDetails="OptionalDetails",e.OtherPythonCellsCount="OtherPythonCellsCount",e.PythonDurationEvent="PythonDurationEvent",e.RetryCount="RetryCount",e.TimerName="TimerName",e.IsFirstCodeExecution="IsFirstCodeExecution",e.ResponseNumber="ResponseNumber",e.UserScenarioId="UserScenarioId",e.WorksheetsProcessed="WorksheetsProcessed"}(u||(u={})),function(e){e.AddLocalImageReferenceCellAddress="AddLocalImageReferenceCellAddress",e.ApiFailure="ApiFailure",e.AugLoopCalls="AugLoopCalls",e.CalculationMode="CalculationMode",e.CalloutScenario="CallOutScenario",e.CardInsertionButtonType="CardInsertionButtonType",e.CardInsertionContentType="CardInsertionContentType",e.CardType="CardType",e.ChartType="ChartType",e.ChunkType="ChunkType",e.Code="Code",e.ColumnHidden="ColumnHidden",e.CurrentIsPythonCellSelected="CurrentIsPythonCellSelected",e.ErrorMessage="ErrorMessage",e.ErrorName="ErrorName",e.ErrorStack="ErrorStack",e.ErrorSubType="ErrorSubType",e.ErrorType="ErrorType",e.ExecutePythonCodeCorrelationId="ExecutePythonCodeCorrelationId",e.FinalText="FinalText",e.IsSuccess="IsSuccess",e.MissingData="MissingData",e.OldPythonCellSelected="OldPythonCellSelected",e.OutputType="OutputType",e.PythonComplexType="PythonComplexType",e.RequestId="RequestId",e.RetryAttempts="RetryAttempts",e.RowHidden="RowHidden",e.StartAnalysis="StartAnalysis",e.StatusMessage="StatusMessage",e.Suggestions="Suggestions",e.TableNameHasBackslash="TableNameHasBackslash",e.Text="Text"}(m||(m={})),function(e){e.LabelRowHidden="LabelRowHidden",e.LabelColumnHidden="LabelColumnHidden",e.ContentRowHidden="ContentRowHidden",e.ContentColumnHidden="ContentColumnHidden"}(g||(g={})),function(e){e.AddLocalImageReference="AddLocalImageReference",e.AddResultsToAnotherSheetButtonClicked="AddResultsToAnotherSheetButtonClicked",e.AugLoopCallsCompleted="AugLoopCallsCompleted",e.AdvancedAnalysisStartedFromAnalysisSheet="AdvancedAnalysisStartedFromAnalysisSheet",e.CannotConnectToOfficePyService="CannotConnectToOfficePyService",e.CardInsertionButtonClicked="CardInsertionButtonClicked",e.CardShownWithInsertionButton="CardShownWithInsertionButton",e.CopyButtonClicked="CopyButtonClicked",e.DataFrameCodeProperty="DataFrameCodeProperty",e.ExecutePythonCodeApi="ExecutePythonCodeApi",e.ExecutionResult="ExecutionResult",e.ExitAnalysisClicked="ExitAnalysis",e.ForcedCalculation="ForcedCalculation",e.GetOfficePyServiceAccessTokenFailed="GetOfficePyServiceAccessTokenFailed",e.GetPythonContextObjectFailed="GetPythonContextObjectFailed",e.GoBackToAnalysisSheetFailed="GoBackToAnalysisSheetFailed",e.IncompleteContext="IncompleteContext",e.InsertInHiddenCell="InsertInHiddenCell",e.InteractiveChartImageInserted="InteractiveChartImageInserted",e.InteractiveChartRendered="InteractiveChartRendered",e.IsPythonCellFailed="IsPythonCellFailed",e.Key="PythonEvent",e.ListenerAttached="ListenerAttached",e.MessageToAugLoopIsTooLarge="MessageToAugLoopIsTooLarge",e.ModelessMissingProperty="ModelessMissingProperty",e.ModelessUnsupportedType="ModelessUnsupportedType",e.PickAWinnerAdvancedAnalysisClicked="PickAWinnerAdvancedAnalysisClicked",e.PickAWinnerPivotsAndChartsClicked="PickAWinnerPivotsAndChartsClicked",e.PythonComplexTypeEncountered="PythonComplexTypeEncountered",e.RecalcSheetMissingSheetId="RecalcSheetMissingSheetId",e.ResponseShown="ResponseCardShown",e.StartAnalysisClicked="StartAnalysisClicked",e.StaticChartImageInserted="StaticChartImageInserted",e.StaticChartRendered="StaticChartRendered",e.TrimmedContextModified="TrimmedContextModified",e.UpdateContextTLRCalledOnNonTLR="UpdateContextTLRCalledOnNonTLR",e.UpdateIsPythonCellSelected="UpdateIsPythonCellSelected"}(h||(h={})),function(e){e.OperationSize="OperationSize",e.ContextMemoSize="ContextMemoSize",e.MessageTextSize="MessageTextSize",e.QueryAnnotationSize="QueryAnnotationSize",e.ImageTileSize="ImageTileSize"}(p||(p={})),function(e){e.PythonAnalysisSessionId="PythonAnalysisSessionId",e.PythonModeValue="PythonModeValue",e.IsPythonThinkDeeperMode="IsPythonThinkDeeperMode",e.IsModelessPythonAAEnabled="IsModelessPythonAAEnabled",e.IsModelessPython="IsModelessPython"}(b||(b={})),function(e){e.IsPythonAdaInCopilotEnabled="IsPythonAdaInCopilotEnabled",e.IsPythonManualPromptEnabled="IsPythonManualPromptEnabled",e.IsPythonPlannerEnabled="IsPythonPlannerEnabled",e.IsModelessPythonAAEnabled="IsModelessPythonAAEnabled",e.IsPythonAAStartAnalysisButtonGreenExperimentEnabled="IsPythonAAStartAnalysisButtonGreenExperimentEnabled"}(f||(f={})),function(e){e.DetailedErrorMessage="DetailedErrorMessage",e.FormulasProcessed="FormulasProcessed",e.Stack="Stack",e.IsAceImpacting="IsAceImpacting",e.WorksheetsProcessed="WorksheetsProcessed",e.FeatureName="FeatureName"}(C||(C={})),function(e){e.IsPythonFormula="IsPythonFormula"}(y||(y={})),function(e){e.Operation="Operation",e.IsQueryNull="QueryNull",e.Stack="Stack"}(v||(v={})),function(e){e.InsertButton="InsertButton",e.InsertToSheetButton="InsertToSheetButton"}(T||(T={})),function(e){e.Image="Image",e.Table="Table"}(x||(x={})),function(e){e.AutoRefreshEnabled="autoRefreshEnabled"}(S||(S={}))},75542:(e,t,n)=>{"use strict";t.tI=t.zI=t.hl=void 0;var a=n(119893);var o=n(480870);Object.defineProperty(t,"hl",{enumerable:!0,get:function(){return o.SafetyOptions}});var r=n(938674);Object.defineProperty(t,"zI",{enumerable:!0,get:function(){return r.WebRuntime}});var i=n(538204);Object.defineProperty(t,"tI",{enumerable:!0,get:function(){return i.createRuntimePatchIsSetSupportedOverride}})},76872:(e,t,n)=>{"use strict";n.d(t,{E:()=>m});var a=n(75496),o=n(857677),r=n(448514),i=n(83437),l=n(316904),s=n(301128);let c=null,d=null,u=0;class m{static getInstance(){return m.telemetryEventHandler||(m.telemetryEventHandler=new m),m.telemetryEventHandler}initTelemetryLatencyObject(){d=(()=>{const e={};return Object.keys(o.CT).forEach((t=>{e[t]=0})),e})()}initTelemetryChatEventObject(){c=function(){const e={};return Object.keys(o.h3).forEach((t=>{e[t]=""})),e}()}updateTelemetryChatEventData(e,t){null===c&&this.initTelemetryChatEventObject(),Object.keys(e).forEach((t=>{c[t]=e[t]})),t&&this.sendTelemetryChatEventData(t)}logUserPerceivedLatencyTelemetry(e,t,n=!1,a,i,l){null===d&&this.initTelemetryLatencyObject(),d&&a&&this.updateTelemetryLatencyData({[o.CT.OperationName]:e?o.OP.FirstChunkFinalResponse:o.OP.LastChunkFinalResponse,[o.CT.UserPerceivedLatency]:(0,r.W)(a),[o.CT.IsQuerySuccess]:t,[o.CT.IsSuccessful]:t,[o.CT.IsFromCache]:n??"",[o.CT.FeatureName]:i?l??i.getActiveFeature():""},i)}logStopGeneratingLatencyTelemetry(e,t,n){null===d&&this.initTelemetryLatencyObject(),d&&e&&(d[o.CT.StopGeneratingTime]=(0,r.W)(e),t&&(d[o.CT.FeatureName]=n??t.getActiveFeature(),this.sendTelemetryLatencyData(t)))}updateTelemetryLatencyData(e,t){null===d&&this.initTelemetryLatencyObject(),Object.keys(e).forEach((t=>{d&&(d[t]=e[t])})),t&&this.sendTelemetryLatencyData(t)}sendTelemetryLatencyData(e){null!=e&&null!=d&&(e.logEvent(g(d),e.getDefaultEventFlags()),this.initTelemetryLatencyObject())}logLatency(e,t,n=!0,a=""){const r={[o.CT.Duration]:e,[o.CT.OperationName]:t,[o.CT.IsSuccessful]:n,[o.CT.FeatureName]:a};l.M.getInstance().logEvent(g(r))}sendTelemetryChatEventData(e){null!=e&&c&&(e.logEvent(function(e){return e[o.h3.UserQueryGuid]=l.M.userQueryGuid,e[o.h3.UserQueryOrder]=l.M.userQueryOrder,{eventType:a.S2.ChatEvents,eventData:Object.keys(e).map((t=>({key:t,value:e[t]})))}}(c)),this.initTelemetryChatEventObject())}static redactUrl(e,t){switch(e){case"spoppe-b.azureedge.net":return t.endsWith("assets/icons/fabric-icons-a13498cf.woff")?e+t:"";case"fa000000124.resources.office.net":return t.endsWith("taskpane.css")||t.endsWith("officethemes.css")||t.endsWith("assets/office-js/excel.js")||t.endsWith("taskpane.js")||t.endsWith("office_strings.js")||t.endsWith("assets/office-js/webauth/webauth.browserauth.js")||t.endsWith("favicon.ico")||t.endsWith("calc.js")||t.endsWith("oss.js")||t.endsWith("ts.js")||t.endsWith("vendors~calc.js")||t.endsWith("vendors~oss.js")?e+t:"";case"login.microsoftonline.com":return"/common/discovery/instance"===t||"/organizations/oauth2/v2.0/authorize"===t||"/organizations/oauth2/v2.0/token"===t||"/organizations/v2.0/.well-known/openid-configuration"===t?e+t:"";case"alcdn.msauth.net":return t.endsWith("js/msal-browser-1p.min.js")?e+t:"";case"browser.events.data.microsoft.com":return"/OneCollector/1.0/"===t?e+t:"";default:return e.endsWith("officescripts.microsoftusercontent.com")&&"/eed0a086-3498-4f91-a377-1e0265ecc0cc"===t?`officescripts.microsoftusercontent.com${t}`:""}}logPerformanceEntries(e){try{for(const t of e)switch(t.entryType){case"navigation":this.logLatency(t.duration,o.OP.Navigation);break;case"resource":if("xmlhttprequest"!==t.initiatorType){const e=new URL(t.name),n={[o.CT.Duration]:t.duration,[o.CT.OperationName]:o.OP.FetchResource,[o.CT.IsSuccessful]:!0,FullUrl:m.redactUrl(e.hostname,e.pathname),SafeDomain:e.hostname.split(".").slice(-2).join("."),StartTime:t.startTime};l.M.getInstance().logEvent(g(n))}}}catch(e){l.M.getInstance().logError({eventType:a.S2.Latency,errorMessage:e instanceof Error?e.message:"Unknown error encountered logging performance entries",logLevel:i.$b.Error})}}setInitContextTime(){u=performance.now()}logTableRecognized(){0!==u&&(u=0,this.logLatency(performance.now()-u,o.OP.RecognizeTable))}logTableMetadata(e){l.M.getInstance().logEvent({eventType:a.S2.TabularRange,eventData:[{key:a.Wg.TableMetadata,value:JSON.stringify(e)}]})}}function g(e){return e[o.CT.UserQueryGuid]=l.M.userQueryGuid,e[o.CT.AugloopSessionGuid]=s.O,{eventType:a.S2.Latency,eventData:Object.keys(e).map((t=>({key:t,value:e[t]})))}}},76913:(e,t,n)=>{"use strict";n.d(t,{n:()=>P,r:()=>R});var a=n(279395),o=n(874003),r=n(639765),i=n(548366),l=n(86940),s=n(293879),c=n(708353),d=n(898701),u=n(178365),m=n(548923),g=n(615397),h=n(857677),p=n(316904),b=n(109174),f=n(164976),C=n(126521),y=n(347145),v=n(493284),T=n(779939),x=n(99558),S=n(972424),w=n(306148);const E=h.q.Commanding,I="Copilot\\Commanding";function R(e,t){return{chatCardType:l._.Default,chatMessageData:{defaultMessageProps:{user:s.Q9.Chat,messageHeader:{text:A(t.length)},embeddedLists:(0,y.k64)()?[]:[{listItems:t}],messageFooter:{text:e}}}}}function A(e){if(!(0,y.yw9)("OfficeVSO_8977646_RemoveRangeFromHiTLConfirmationCard")){const t=b.CP.getActiveTable()?.address,n=b.CP.getHumanInTheLoopRange()??(0,S.r)(t??"");if(n)return(0,a.go9)(e).replace("{0}",n)}return(0,a.lj0)(e)}function L(){return(0,y.yw9)("OfficeVSO_9564930_SplitCommandingTelemetry")?p.M.getInstance().getUsageFeatureForStandardizedFeature(p.M.getInstance().getActiveFeature()):E}function k(e,t){const n=b.CP.getActiveTable();if(!n?.address)throw new g.sF("No active table",g.UP.NoActiveTable);const o=(0,S.r)(n.address);return(0,y.ZAR)()?function(e,t,n,o){let r="";r=e&&1===t?(0,a.Bfv)():e&&t>1?(0,a.nEe)():t>1?(0,a.LhO)():(0,a.UQX)();t>1&&(r=r.replace("{numChanges}",t.toString()));return r.replace("{range}",n).replace("{sheet}",o)}(e,t,o,n.sheetRange.sheet):function(e,t,n){return e&&1===t?(0,C.L)((0,a.Af3)(),n):e&&t>1?(0,C.L)((0,a.Edn)(),n,t):t>1?(0,C.L)((0,a.syu)(),n,t):(0,C.L)((0,a.$Mo)(),n)}(e,t,o)}function F(e){return{type:o.jA.Default,title:(0,a.yZI)(),text:(0,a.yZI)(),iconRegular:d.N5_,iconHover:d.FUA,isDisabled:!0,handleButtonOnClick:async()=>{const t=p.M.getInstance(),n=L();t.logEvent((0,h.SV)(h.he.Apply,n,h.KZ.ApplyButton,void 0,p.M.userQueryGuid));const{message:o,telemetry:r}={message:{chatCardType:l._.Default,chatMessageData:{defaultMessageProps:{user:s.Q9.Human,messageHeader:{text:(0,a.yZI)()}}}},telemetry:{featureName:L(),eventType:h.a5.HumanInput}};u.$.getInstance().displayResponse(o,r),await e()}}}function _(e,t,n=void 0){const a=h.q.ConditionalFormattingSuggestion,o=(0,x.v)(e,{errorType:t,featureName:a},{},{feedbackData:(0,y.yw9)("OfficeVSO_9575103_AddFeedBackAreaToHiTLCard")?{feedbackArea:"Copilot\\Commanding Conditional Formatting"}:{feedbackArea:"Copilot\\Commanding CF Suggestions"}});o.message.addCardToChatHistory=!1,(0,y.jHv)()&&(o.telemetry.devInfo={category:t,message:n});const l=(0,y.yw9)("OfficeVSO_9564930_SplitCommandingTelemetry")?h.BJ.ConditionalFormatting:h.BJ.Commanding;return t===h.q0.ClientError?p.M.getInstance().logStandardizedAshaErrorEvent(i.W.Unable_To_Complete_Task,r.c.Conditional_Formatting_Suggestions_Error_Due_To_No_Table_Selected,l):p.M.getInstance().logStandardizedAshaErrorEvent(i.W.Unable_To_Complete_Task,r.c.Conditional_Formatting_Suggestions_Error,l),o}const P={getOdslExecutionFailedResponse:function(e,t){return(0,x.v)(e,{featureName:L(),errorType:t},{},{feedbackData:{feedbackArea:I}})},getMultipleEventsErrorResponse:function(e,{showUndo:t}={showUndo:!1},n=h.BJ.CopilotChat){return(0,x.v)(e,{errorType:h.q0.DetectedMultipleIntents,featureName:(0,y.yw9)("OfficeVSO_9771900_ErrorFeatureAttribution")?p.M.getInstance().getUsageFeatureForStandardizedFeature(n):h.q.CopilotChat},{},{actionButtonList:t&&(0,y.BAK)()?[(0,w.FW)(L())]:[]})},getCommandingSuccessResponse:function(e,t){const n=t.some((e=>m.yT.test(e.text))),a=L(),o={shouldShowAIGeneratedIndicator:!0,feedbackData:{feedbackArea:a===h.q.Commanding?"Copilot\\Commanding":"Copilot\\Commanding Conditional Formatting"},feedbackSectionPosition:c.O.Footer,actionButtonList:(0,y.BAK)()?[(0,w.FW)(a)]:[]};let r;if(!(0,y.k64)()&&n){const n={header:A(t.length),listItems:t,footer:e},a=(0,T.KI)(n);r={chatCardType:l._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:s.Q9.Chat,renderData:(0,f.IM)("ChatCardListWithColorSwatch_V1",n),textContent:a}},chatMessageBodyData:o}}else r={...R(e,t),chatMessageBodyData:o};return{message:r,telemetry:{featureName:a,eventType:h.a5.ActionConfirmationMessage}}},getUnsupportedCommandResponse:function(e,t=[]){const{message:n,telemetry:a}=(0,x.v)(e,{featureName:L(),errorType:h.q0.UnsupportedCommand},{embeddedLists:[{listItems:t}]},{feedbackData:{feedbackArea:I},feedbackSectionPosition:c.O.None});return{message:n,telemetry:a}},getCommandingFeatureName:L,getCommandingTellMeResponse:function(){return{message:{chatCardType:l._.Default,chatMessageData:{defaultMessageProps:{user:s.Q9.Chat,embeddedLists:[{listHeader:(0,a.ZcJ)(),listItems:[{text:(0,a.UFE)()},{text:(0,a.$nW)()}]},{listHeader:(0,a.Sur)(),listItems:[{text:(0,a.Gpd)()},{text:(0,a.N9u)()}]}]}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:c.O.Footer,feedbackData:{feedbackArea:I}}},telemetry:{featureName:E,eventType:h.a5.HelpMessage}}},getCommandingHumanInTheLoopResponse:function(e,t){const n={header:k(!1,e.length),events:e},a=(0,y.yw9)("OfficeVSO_8990694_HiTLChatHistorySignalContent")?(0,T.NP)(n):"";return{message:{chatCardType:l._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:s.Q9.Chat,renderData:(0,f.IM)("ChatCardHumanInTheLoop_V1",n),textContent:a}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,actionButtonList:[F(t)],feedbackSectionPosition:c.O.Footer,feedbackData:(0,y.yw9)("OfficeVSO_9575103_AddFeedBackAreaToHiTLCard")?{feedbackArea:"Copilot\\Commanding"}:{}}},telemetry:{featureName:E,eventType:h.a5.HumanInTheLoopMessage}}},getCommandingHumanInTheLoopResponseDeprecated:function(e,t){return{message:{chatCardType:l._.Default,chatMessageData:{defaultMessageProps:{user:s.Q9.Chat,messageHeader:{text:k(!1,e.length)},embeddedLists:[{listItems:e.map((e=>({text:e})))}]}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,actionButtonList:[F(t)],feedbackSectionPosition:c.O.Footer}},telemetry:{featureName:E,eventType:h.a5.HumanInTheLoopMessage}}},getCommandingCFHumanInTheLoopResponse:function(e,t,n){const a={header:k(0===t.length,e.length+t.length),cfHitlItems:e,eventIntents:t};return{message:{chatCardType:l._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:s.Q9.Chat,renderData:(0,f.IM)("ChatCardWithConditionalFormatting_V1",a),textContent:(0,T.EM)(a)}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,actionButtonList:[F(n)],feedbackSectionPosition:c.O.Footer,feedbackData:(0,y.yw9)("OfficeVSO_9575103_AddFeedBackAreaToHiTLCard")?{feedbackArea:"Copilot\\Commanding Conditional Formatting"}:{}}},telemetry:{featureName:(0,y.yw9)("OfficeVSO_9564930_SplitCommandingTelemetry")?h.q.ConditionalFormatting:h.q.Commanding,eventType:h.a5.HumanInTheLoopMessage}}},getConditionalFormattingSuggestionsResponseMessage:function(e,t,n,o){const d=b.CP.getActiveTable();if("out-of-credits"===t)return _((0,a.R_I)(),h.q0.OutOfCreditsError,t);if(t)return _((0,a.t_C)(),h.q0.ServiceError,t);if(d){const t=d.address,u=d.sheetRange.sheet;return 0===e.length?function(e){const t=h.q0.NoSuggestions,n=h.q.ConditionalFormattingSuggestion,o=(0,C.L)((0,a.yNF)(),e),l=(0,x.v)(o,{errorType:t,featureName:n},{},{feedbackData:(0,y.yw9)("OfficeVSO_9575103_AddFeedBackAreaToHiTLCard")?{feedbackArea:"Copilot\\Commanding Conditional Formatting"}:{feedbackArea:"Copilot\\Commanding CF Suggestions"}});l.message.addCardToChatHistory=!1;const s=(0,y.yw9)("OfficeVSO_9564930_SplitCommandingTelemetry")?h.BJ.ConditionalFormatting:h.BJ.Commanding;return p.M.getInstance().logStandardizedAshaErrorEvent(i.W.Unable_To_Complete_Task,r.c.Conditional_Formatting_No_Suggestions_Error,s),l}(t):function(e,t,n,o,r){const i={featureName:h.q.ConditionalFormattingSuggestion,eventType:h.a5.SuggestionMessage},d=(0,S.r)(t);let u="";u=(0,y.ZAR)()?(0,a.z4t)().replace("{range}",d).replace("{sheet}",r):(0,C.L)(n??(0,a.AsH)(),d);const m={header:u,suggestions:e,footer:void 0,guid:o},g=(0,T.iN)(m);return{message:{chatCardType:l._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:s.Q9.Chat,renderData:(0,f.IM)("ConditionalFormattingSuggestionCard_V1",m),textContent:g}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:c.O.Footer,feedbackData:(0,y.yw9)("OfficeVSO_9575103_AddFeedBackAreaToHiTLCard")?{feedbackArea:"Copilot\\Commanding Conditional Formatting"}:{feedbackArea:"Copilot\\Commanding CF Suggestions"}}},telemetry:i}}(e,t,n,o,u)}return _((0,a.LNV)(),h.q0.ClientError)},getConditionalFormattingSuggestionsErrorResponse:_,getExcelChartStylesResponseMessage:function(e,t,n){return(0,v.k)({requestId:t,adaptiveCardDefinition:JSON.parse(e.adaptiveCardDefinition??""),cardButtonCallback:n})}}},80765:(e,t,n)=>{"use strict";n.d(t,{X:()=>d});var a=n(500461),o=n(382316),r=n(245965),i=n(249443),l=n(208520);const s=(e,t)=>(0,l.useCallback)((()=>{const e=(0,i.wP)(),t=(0,i.Xj)(e).palette,n=(o=e)===i._f.Black||o===i._f.DarkGray;var o;return(0,r.l8)({errorOutput:{color:t.red},stringOutput:{color:t.themeSecondary,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",display:"flow"},staticOutput:{color:t.themeSecondary},numberOutput:{color:n?"#B5CEA8":"#098658",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",display:"flow"},booleanOutput:{color:n?"#569CD6":"#0000FF",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",display:"flow"},webImage:{objectFit:"contain",maxWidth:"calc(min(80%, 100px))",maxHeight:"100px"},localImage:{objectFit:"contain"},pythonProps:{color:t.neutralSecondary,fontSize:"12px","> code":{color:"inherit !important"}},pythonTable:{whiteSpace:"nowrap",overflowX:"auto",textOverflow:"ellipsis",display:"flow",width:"100%",tableLayout:"fixed",borderSpacing:0,borderCollapse:"collapse","& tr > td":{border:`1px solid ${t.neutralSecondaryAlt}`,padding:"2px 4px",minWidth:"30px"},"& > thead > tr > td":{background:t.neutralLight,fontWeight:r.BO.semibold,"> code":{fontWeight:"inherit !important",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",display:"flow"}},"& > tbody > tr > td":{}},showPythonCodeToggleButtonStyle:{color:a.k1.colorNeutralForeground3,paddingLeft:"2px !important",marginLeft:"4px !important","&:hover":{color:a.k1.colorNeutralForeground2Hover,paddingLeft:"2px",marginLeft:"4px"},"&:hover:active":{color:a.k1.colorNeutralForeground2Pressed,paddingLeft:"2px",marginLeft:"4px"},"@media (forced-colors: active)":{"> span":{color:"inherit","> svg":{color:"inherit"}}}},diagnosticsOutputContainer:{display:"flex",flexDirection:"column",alignItems:"flex-start",fontFamily:"Consolas, monospace",fontSize:"16px",fontWeight:"400",whiteSpace:"pre-wrap",lineHeight:"20px",marginBottom:"8px",overflowWrap:"anywhere"},stdOut:{color:t.neutralSecondary,padding:"2px 0 2px 0"},Error:{color:t.red,padding:"2px 0 2px 0"},outputText:{color:a.k1.colorNeutralForeground3,fontWeight:"600"}})}),[e,t]);var c=n(622753);function d(){const{sdxTheme:e,highContrastClientMode:t}=(0,l.useContext)(c.D),[n,r]=(0,l.useState)(t!==a.QJ.disabled);(0,l.useEffect)((()=>{r(t!==a.QJ.disabled)}),[t]);return{linkTheme:(0,a.eS)(e||o.G.defaultWhite,n),getStyles:s(e,n),sdxTheme:e,isHighContrast:n}}},83437:(e,t,n)=>{"use strict";var a,o,r,i,l,s,c,d,u,m,g,h,p;n.d(t,{$b:()=>p,CC:()=>s,CT:()=>a,Ff:()=>d,G8:()=>u,IC:()=>l,S2:()=>o,T_:()=>c,a5:()=>i,av:()=>h,h3:()=>r,kD:()=>g}),function(e){e.UserContextAnnotationActivationTime="UserContextAnnotationActivationTime",e.UserContextResponseTime="UserContextResponseTime",e.AnnotationType="AnnotationType",e.FeatureName="FeatureName",e.SubFeatureName="SubFeatureName",e.UserProfileResponseTime="UserProfileResponseTime",e.PersonalizationCardUserInteractionTime="PersonalizationCardUserInteractionTime",e.UserPerceivedLatency="UserPerceivedLatency",e.IsQuerySuccess="IsQuerySuccess",e.ErrorType="ErrorType",e.ErrorParameter="ErrorParameter",e.ErrorChatEventType="ErrorChatEventType",e.ErrorChatEventParameter="ErrorChatEventParameter",e.IsPersonalizedResponse="IsPersonalizedResponse",e.CIPEvaluationResponseTime="CIPEvaluationResponseTime"}(a||(a={})),function(e){e.CLP="CLP",e.Personalization="Personalization",e.MSAL="MSAL",e.ExtensibilityDialog="ExtensibilityDialog",e.LocalAddinActionExecution="LocalAddinActionExecution"}(o||(o={})),function(e){e.ChatEventType="ChatEventType",e.ChatEventParameters="ChatEventParameters",e.ChatErrorType="ChatErrorType",e.ChatErrorKey="ChatErrorKey",e.Cv="Cv",e.UserQueryGuid="UserQueryGuid",e.IsPersonalizedResponse="IsPersonalizedResponse"}(r||(r={})),function(e){e.OfficeJsApiCallForCLP="OfficeJs_Api_Call_For_CLP",e.OfficeJsApiCallForCLPError="OfficeJs_Api_Call_For_CLP_Error",e.IsDocumentProtected="IsDocumentProtected",e.ALUserType="AL_User_Type",e.PrimaryUserType="Primary_User_Type",e.EnterpriseGroundingDisabled="Enterprise_Grounding_Disabled",e.CopilotConfig="Copilot_Config",e.UserContextSignalSubmitted="User_Context_Signal_Submitted",e.ContentIntelligencePlatformEvaluationSignalSubmitted="ContentIntelligence_Platform_Evaluation_Signal_Submitted",e.SummaryFromNudgeTriggered="Summary_From_Nudge_Triggered",e.PodcastFromNudgeTriggered="Podcast_From_Nudge_Triggered",e.DescribeImageFromNudgeTriggered="Describe_Image_From_Nudge_Triggered",e.ErrorBoundaryCaughtError="Error_Boundary_Caught_Error",e.ResponseReceivedFromAL="Response_Received_From_Augloop",e.ApiPluginDataReceived="ApiPlugin_Data_Received",e.MsgExtDataReceived="MsgExt_Data_Received",e.QuerySuccessful="Query_Successful",e.UserProfileOperationSubmitted="UserProfile_Operation_Submitted",e.PersonalizationHITLCardShown="Personalization_HITL_Card_Shown",e.UserOverridedPersonalizationHITL="User_Overrided_Personalization_HITL",e.UndefinedQueryIDInHITLCard="Undefined_QueryID_In_HITL_Card",e.IncompleteUserProfileResponse="Incomplete_User_Profile_Response",e.PersonalizationIndicatorShown="Personalization_Indicator_Shown",e.CLPErrorShown="CLP_Error_Shown",e.CLPErrorIgnored="CLP_Error_Ignored",e.MSALTokenRequested="MSAL_Token_Requested",e.TaskModuleServiceRequest="Task_Module_Service_Request",e.TaskModuleServiceResponse="Task_Module_Service_Response",e.TaskModuleServiceError="Task_Module_Service_Error",e.ExtensibilityDialogLoad="Extensibility_Dialog_Load",e.CloudFilesDialogOpened="Cloud_Files_Dialog_Opened",e.OpenMOSDialog="Open_MOS_Store_To_Get_Agents",e.MOSStoreDialogResponse="MOS_Store_Dialog_Response",e.VoiceCopilotZQMSubmitted="Voice_Copilot_ZQM_Submitted",e.VoiceCopilotZQMResponseRendered="Voice_Copilot_ZQM_Response_Rendered",e.VoiceCopilotZQMResponseClicked="Voice_Copilot_ZQM_Response_Clicked",e.VoiceCopilotZQMAutoStarted="Voice_Copilot_ZQM_Auto_Started",e.ChatHistorySignalSubmitted="Chat_History_Signal_Submitted",e.ConversationIdUndefined="Conversation_Id_Undefined",e.UpdateChatSessionId="Update_Chat_Session_Id",e.CannotUpdateChatSessionId="Cannot_Update_Chat_Session_Id",e.SubmitOperationUndefined="Submit_Operation_Undefined",e.ConnectionHealth="Connection_Health",e.InsightsCardRelatedFilesResponse="Insights_Card_RelatedFiles_Response",e.AugLoopOfficeCopilotOrchestrationCopilotRelatedFilesError="AugLoop_OfficeCopilotOrchestration_CopilotRelatedFiles_Error",e.InsightsCardRelatedFilesSignalSent="Insights_Card_RelatedFiles_Signal_Sent",e.InsightsCardCocoaSkillResponse="Insights_Card_CocoaSkill_{Skill}_Response",e.InsightsCardCocoaSkillResponseUpdating="Insights_Card_CocoaSkill_{Skill}_Response_Updating",e.InsightsCardCocoaSkillResponseLoaded="Insights_Card_CocoaSkill_{Skill}_Response_Loaded",e.InsightsCardCocoaSkillResponseError="Insights_Card_CocoaSkill_{Skill}_Response_Error",e.InsightsCardCocoaSkillResponseTimedOut="Insights_Card_CocoaSkill_{Skill}_Response_TimedOut",e.InsightsCardCocoaSkillResponseRetryTimedOut="Insights_Card_CocoaSkill_{Skill}_Response_Retry_TimedOut",e.InsightsCardCocoaSkillCardClicked="Insights_Card_CocoaSkill_{Skill}_CardClicked",e.InsightsCardCocoaSkillCardNavigatedTo="Insights_Card_CocoaSkill_{Skill}_CardNavigatedTo",e.LocalAddinActionInvoked="Local_Addin_Action_Invoked",e.LocalAddinExecutionCompletedFromHost="Local_Addin_Action_Completed_From_Host",e.LocalAddinExecutionFailedFromHost="Local_Addin_Action_Failed_From_Host",e.LocalAddinExecutionReceivedMultipleRequests="Local_Addin_Action_Received_Multiple_Requests",e.LocalAddinExecutionReceivedSingleRequest="Local_Addin_Action_Received_Single_Request",e.LocalAddinExecutionStarted="Local_Addin_Action_Started",e.StopGeneratingButtonClickedDuringAddinExecution="Stop_Generating_Button_Clicked_During_Addin_Execution",e.UndoButtonClickedAfterAddinSuccess="Undo_Button_Clicked_After_Addin_Success",e.UndoButtonHiddenOnSubmittingQueryAfterAddinSuccess="Undo_Button_Hidden_On_Submitting_Query_After_Addin_Success",e.UndoButtonShownAfterAddinSuccess="Undo_Button_Shown_After_Addin_Success"}(i||(i={})),function(e){e.ErrorMessage="ErrorMessage",e.ErrorCategory="ErrorCategory",e.ErrorCode="ErrorCode",e.ErrorStack="ErrorStack"}(l||(l={})),function(e){e.Customize="Customize",e.CopilotChat="CopilotChat",e.Extensibility="Extensibility"}(s||(s={})),function(e){e.Client="Client",e.Server="Server",e.SubstrateService="SubstrateService",e.UnsupportedAction="UnsupportedAction"}(c||(c={})),function(e){e.PersonalizationHITL="Personalization HITL",e.PersonalizationUserProfile="Personalization User Profile",e.AddInActionsForAgents="Add-in Actions for Agents"}(d||(d={})),function(e){e.UnsupportedFunctionality="Unsupported Copilot Functionality",e.TimedOut="Response Delayed or Timed Out",e.UnableToCompleteTask="Unable to Complete Task",e.UnclassifiedError="Unclassified ASHA Error",e.UserAccessIssue="User Access Issue for Copilot",e.RAIError="Responsible AI Filter Blocked Response",e.CapacityIssue="Unable to Generate Response Due to Capacity Issue",e.ReferencingFileIssue="Referencing a File Failed",e.LLMIssue="LLM Service Side Issue Prevents Output",e.UserInputIssue="User Input Could Not Be Processed",e.UserRejectedResponse="User Rejected or Cancelled Response "}(u||(u={})),function(e){e.Unknown="Error is unknown",e.MissingProfileId="Error occurred because profileId in signal is invalid",e.StaleProfileId="Error occurred because user input is stale",e.NotSupportedProfileOperation="Error occurred because operation requested by user is not supported",e.InvalidUserQuery="Error occurred because input query is invalid",e.FailedToRead="Error occurred because service failed to read from roaming service",e.FailedToWrite="Error occurred because service failed to write to roaming service",e.UninitializedUserStoreEntities="Error occurred because the roaming setting was uninitialized",e.UndefinedUserStoreEntities="Error occurred because the roaming setting was not found",e.BadResponse="Error occurred because of bad response",e.Timeout="Error occurred timeout waiting for LLM",e.Throttled="Error occurred because number of requests per hour limit exceeded",e.UserThrottled="Error occurred because user has issued too many requests",e.ScenarioThrottled="Error occurred because scenario has issued too many requests",e.Token="Error occurred because of token",e.NotAvailable="Error occurred because server is unavailable",e.SkillFailed="Error occurred because skill failed",e.IncorrectServiceResponse="Error occurred due  to incorrect service response",e.EmptyResponse="Error occurred because of empty response"}(m||(m={})),function(e){e.Customize="Customize Customize",e.Summarize="Summarize Summarize",e.Command="Command Command",e.UnclearIntent="Unclear Intent CopilotChat",e.AddContent="Create Add Content",e.ChatQnA="Ask ChatQnA"}(g||(g={})),function(e){e.ExecutionStatusFailed="Error occurred because execution on client side has failed",e.SensitivityExecutionFailed="Error occurred because execution for sensitivity API failed",e.UnexpectedFailure="Error occurred because of unexpected failure caught on client side"}(h||(h={})),function(e){e[e.Warning=400]="Warning",e[e.ASHA=450]="ASHA",e[e.Error=500]="Error",e[e.Critical=600]="Critical"}(p||(p={})),function(e){e.Error="Error",e.UncaughtException="UncaughtException",e.ChatEvents="ChatEvents",e.AssertionFailed="AssertionFailed"}(o||(o={}))},83478:(e,t,n)=>{"use strict";n.d(t,{D:()=>f,J:()=>b});var a=n(86940),o=n(874003),r=n(174116),i=n(293879),l=n(178365),s=n(207545),c=n(347145),d=n(652382),u=n(887648),m=n(208520);const g="FormulaDev",h=(e,t)=>(0,c.yw9)("OfficeVSO_9205837_formulasDevButton")&&e&&Boolean(t)&&((0,s.I_)()||(0,c.iPS)("Microsoft.Office.Excel.FA000000124.EnableTestUi",!1)),p=async e=>{const t={chatCardType:a._.MarkdownCard,chatMessageData:{markDownCardProps:{user:i.Q9.Chat,message:`\`\`\`json\n${JSON.stringify(JSON.parse(e),null,2)}\n\`\`\``}},addCardToChatHistory:!1};l.$.getInstance().displayResponse(t)};function b(e,t){if(h(e,t))return{type:o.jA.Default,title:g,text:(0,d.dD)()?void 0:g,iconRegular:r.SFT,iconHover:r.qTo,handleButtonOnClick:async()=>{p(t)}}}function f(e){const t=(0,u.d4)((e=>e.dataAI.shouldShowFormulaDevButton));if(h(t,e))return{buttonTitle:g,buttonText:g,icon:m.createElement(r.SFT,null),handleButtonOnClick:async()=>{p(e)}}}},88568:(e,t,n)=>{"use strict";n.d(t,{y:()=>d});var a=n(83437),o=n(963002),r=n(75496),i=n(316904),l=n(573367);const s="#".repeat(255);class c{get resolve(){return this._resolve}constructor(){this.promise=new Promise((e=>{this._resolve=e}))}}class d{getOrCreateCellJobs(e,t){const n=d.hash(e,t);let a=this.cellJobs[n];return a||(a={formatAggregatedValues:{}},this.cellJobs[n]=a),a}getValue(e,t){this.hasResolved&&i.M.getInstance().logError({eventType:r.S2.Error,errorMessage:"Attempted to get deferred value after deferred jobs have resolved. This can impact performance",logLevel:a.$b.Error});const n=this.getOrCreateCellJobs(e,t);return n.value||(n.value=new c),n.value.promise}getText(e,t){this.hasResolved&&i.M.getInstance().logError({eventType:r.S2.Error,errorMessage:"Attempted to get deferred text after deferred jobs have resolved. This can impact performance",logLevel:a.$b.Error});const n=this.getOrCreateCellJobs(e,t);return n.text||(n.text=new c),n.text.promise}getFormat(e,t){this.hasResolved&&i.M.getInstance().logError({eventType:r.S2.Error,errorMessage:"Attempted to get deferred number format after deferred jobs have resolved. This can impact performance",logLevel:a.$b.Error});const n=this.getOrCreateCellJobs(e,t);return n.numberFormat||(n.numberFormat=new c),n.numberFormat.promise}getFormatLocal(e,t){this.hasResolved&&i.M.getInstance().logError({eventType:r.S2.Error,errorMessage:"Attempted to get deferred local number format after deferred jobs have resolved. This can impact performance",logLevel:a.$b.Error});const n=this.getOrCreateCellJobs(e,t);return n.numberFormatLocal||(n.numberFormatLocal=new c),n.numberFormatLocal.promise}formatAggregateValue(e,t,n){this.hasResolved&&i.M.getInstance().logError({eventType:r.S2.Error,errorMessage:"Attempted to format aggregated value after jobs have resolved. This can impact performance",logLevel:a.$b.Error}),this.getFormatLocal(e,t);const o=this.getOrCreateCellJobs(e,t);return o.formatAggregatedValues[n]||(o.formatAggregatedValues[n]=new c),o.formatAggregatedValues[n].promise}formatSourceValue(e,t){this.hasResolved&&i.M.getInstance().logError({eventType:r.S2.Error,errorMessage:"Attempted to format source value after jobs have resolved. This can impact performance",logLevel:a.$b.Error}),this.getValue(e,t),this.getFormatLocal(e,t);const n=this.getOrCreateCellJobs(e,t);return n.formatSourceValue||(n.formatSourceValue=new c),n.formatSourceValue.promise}formatSourceDate(e,t){this.hasResolved&&i.M.getInstance().logError({eventType:r.S2.Error,errorMessage:"Attempted to format date after jobs have resolved. This can impact performance",logLevel:a.$b.Error}),this.getValue(e,t);const n=this.getOrCreateCellJobs(e,t);return n.formatSourceDate||(n.formatSourceDate=new c),n.formatSourceDate.promise}getTranslations(e,t){return{getValue:this.translate(this.getValue,e,t),getText:this.translate(this.getText,e,t),getFormat:this.translate(this.getFormat,e,t),getFormatLocal:this.translate(this.getFormatLocal,e,t),formatAggregateValue:this.translate(this.formatAggregateValue,e,t),formatSourceValue:this.translate(this.formatSourceValue,e,t),formatSourceDate:this.translate(this.formatSourceDate,e,t)}}translate(e,t,n){return(a,o,...r)=>e.call(this,a+t,o+n,...r)}async resolveJobs(){this.hasResolved=!0;const{sheetId:e}=this;for(;Object.keys(this.cellJobs).length>0;){const{cellJobs:t}=this;this.cellJobs={},await d.resolveJobs(t,e)}}static async resolveJobs(e,t){await Excel.run((async n=>{const a={},r=n.workbook.worksheets.getItem(t);for(const[t,n]of Object.entries(e)){const{row:e,column:o}=d.unhash(t),i=[];n.text&&i.push("text"),n.value&&i.push("values"),n.numberFormat&&i.push("numberFormat"),n.numberFormatLocal&&i.push("numberFormatLocal"),a[t]=r.getCell(e,o).load(i)}await n.sync();for(const t in a){const n=e[t],o=a[t];n.text&&n.text.resolve(o.text[0][0]),n.value&&n.value.resolve(o.values[0][0]),n.numberFormat&&n.numberFormat.resolve(o.numberFormat[0][0]),n.numberFormatLocal&&n.numberFormatLocal.resolve(o.numberFormatLocal[0][0])}const i=Excel.NumberFormattingService.newObject(n),c=[];function u(e,t,n,a){if(Number.isNaN(e)||o.P.getNumberFormatCache().isDateTime(n)&&!function(e){return!(e<0||e>2958465.99999999)}(e))a(s);else{const n=t.format(e);c.push((()=>a(n.value)))}}for(const t in e){const n=e[t],o=a[t];if(n.formatSourceValue||Object.keys(n.formatAggregatedValues).length>0){const e=o.numberFormatLocal[0][0],t=i.getFormatter(e);if(n.formatSourceValue){const a=o.values[0][0];"number"==typeof a?u(a,t,e,n.formatSourceValue.resolve):n.formatSourceValue.resolve(void 0)}for(const a in n.formatAggregatedValues){const{resolve:o}=n.formatAggregatedValues[a];u(Number.parseFloat(a),t,e,o)}}if(n.formatSourceDate){const e=o.values[0][0];if("number"==typeof e){u(e,i.getFormatter(l.D4),l.D4,n.formatSourceDate.resolve)}else n.formatSourceDate.resolve(void 0)}}0!==c.length&&(await n.sync(),c.forEach((e=>e())))}))}static hash(e,t){return`${e},${t}`}static unhash(e){const[t,n]=e.split(",");return{row:Number.parseInt(t),column:Number.parseInt(n)}}constructor(e){this.sheetId=e,this.cellJobs={},this.hasResolved=!1}}},92520:(e,t,n)=>{"use strict";n.d(t,{K_:()=>g,Pk:()=>d,SA:()=>h,cY:()=>p,g5:()=>b,gZ:()=>f,hX:()=>c,kc:()=>u,qw:()=>m,uk:()=>s});var a=n(13161),o=n(207545),r=n(267022),i=n.n(r),l=n(758651);function s(e){return new Promise(((t,n)=>{setTimeout((()=>{t()}),e)}))}function c(e){return null==e}function d(e){return void 0===e||0===e.length}function u(e){return 0!==e.length&&!e.every((t=>e[0].agent===a.w2.OfficeScripts||e[0].agent===a.w2.OfficeJS||e[0].agent===a.w2.UnsupportedEvent?t.agent===a.w2.OfficeScripts||t.agent===a.w2.OfficeJS||t.agent===a.w2.UnsupportedEvent:t.agent===e[0].agent))}function m(e){return e.every((e=>e.agent===a.w2.OfficeScripts))}const g=()=>(0,o.I_)()||(0,o.B2)();var h;function p(e,...t){if(!g())return;let n="info";e&&Object.values(h).includes(e)?n=e:e&&t.unshift(e);const a="Excel Copilot Chat";switch(n){case"verbose":l.debug(`${a}`,...t);break;case"warning":l.warn(`${a}`,...t);break;case"error":l.error(`${a}`,...t);break;default:l.log(`${a}:`,...t)}}function b(e,t,n){const a=i()(e,t,n);return async(...e)=>{const t=a(...e);return void 0===t?Promise.resolve():t}}function f(e){return"string"==typeof e&&e.length>=2&&e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1)),e}!function(e){e.Verbose="verbose",e.Info="info",e.Warning="warning",e.Error="error"}(h||(h={}))},99415:(e,t,n)=>{"use strict";n.d(t,{X:()=>l,j:()=>r});var a=n(624654);const o={General:e=>"General",Number:e=>i(e),Currency:e=>"$#,##"+i(e),Accounting:e=>{const t=i(e);return`_($* #,##${t}_);_($* (#,##${t};_($* "-"??_);_(@_)`},"Short Date":e=>"m/d/yyyy","Long Date":e=>"[$-x-sysdate]dddd, mmmm dd, yyyy",Time:e=>"[$-x-systime]h:mm:ss AM/PM",Comma:e=>{const t=i(e);return`_(* #,##${t}_);_(* (#,##${t});_(* "-"??_);_(@_)`},Percentage:e=>`${i(e)}%`,Fraction:e=>"# ?/?",Scientific:e=>`${i(e)}E+00`,Text:e=>"@"};function r(e,t){try{return o[e](t)}catch{return e}}function i(e){if(void 0===e||e<0)return"0.00";if(0===e)return"0";{let t="0.";for(let n=0;n<e;n++)t+="0";return t}}function l(e,t){let n=(t?{General:ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionGeneral,"m/d/yyyy":ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionShortDate,"[$-x-sysdate]dddd, mmmm dd, yyyy":ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionLongDate,"[$-x-systime]h:mm:ss AM/PM":ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionTime,"# ?/?":ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionFraction,"@":ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionText}:{General:"a general format","m/d/yyyy":"a short date format","[$-x-sysdate]dddd, mmmm dd, yyyy":"a long date format","[$-x-systime]h:mm:ss AM/PM":"a time format","# ?/?":"a fraction format","@":"a text format"})[e];return void 0===n?(e.startsWith("[$-")||(0,a.xs)(e)?n=t?ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionDateTime:"a date/time format":e.startsWith("_($")||e.startsWith("_(€")||e.startsWith("_(£")||e.startsWith("_(¥")||e.startsWith("_(₹")||e.startsWith("_(₩")||e.startsWith("_(₽")?n=t?ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionAccounting:"an accounting format":e.includes("$")||e.includes("€")||e.includes("£")||e.includes("¥")||e.includes("₹")||e.includes("₩")||e.includes("₽")||e.includes("kr")||e.includes("₪")||e.includes("₴")||e.includes("zł")||e.includes("₺")||e.includes("฿")||e.includes("Kč")||e.includes("Ft")||e.includes("Rp")||e.includes("₫")||e.includes("kn")||e.includes("lei")||e.includes("лв")||e.includes("din")||e.includes("₱")?n=t?ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionCurrency:"a currency format":e.startsWith("_(* #,##")?n=t?ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionComma:"a comma format":e.endsWith("%")?n=t?ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionPercentage:"a percentage format":e.endsWith("E+00")?n=t?ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionScientific:"a scientific format":e.startsWith("0")&&(n=t?ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionNumber:"a number format"),void 0!==n?n:(t?ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionCustom:"a custom format")+"("+e+")"):n}},99558:(e,t,n)=>{"use strict";n.d(t,{v:()=>d});var a=n(86940),o=n(293879),r=n(708353),i=n(857677),l=n(306148),s=n(347145),c=n(507628);function d(e,t={},n={},d={},u={}){const m=(0,c.A)();return{message:{...u,chatCardType:a._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:e},...n}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:"Copilot"},isFailure:!0,messageId:m,actionButtonList:(0,s.jHv)()?[(0,l.yo)(m)]:void 0,...d}},telemetry:{featureName:i.q.CopilotChat,eventType:i.a5.ErrorMessage,...t}}}},100062:(e,t,n)=>{"use strict";n.d(t,{v:()=>s});var a=n(856135),o=n(649405),r=n(375746),i=n(618175);const l={resource:"https://officepyservice.office.net"};class s{async authorizeOfficePyService(e){const t=s.getOfficepyScope();return this.authorizeScope(t,e)}async authorizeScope(e,t){const n=this.tokenCache;if(n){if(!(Date.now()>n.expirationTime))return n.token;this.clearStorageToken()}return this.pendingPromise||(this.pendingPromise=this.auth.authorize(e,t,s.fallbackFn).then((e=>(this.pendingPromise=void 0,this.cacheStorageToken(e,Date.now()+s.getExpirationTime()),e))).catch((e=>{throw this.pendingPromise=void 0,e}))),this.pendingPromise}static putFallbackFn(e){s.fallbackFn=e}static getOfficepyScope(){return l}cacheStorageToken(e,t){Number.isInteger(t)&&(this.tokenCache={token:e,expirationTime:t})}getCachedStorageToken(){return this.tokenCache}static getExpirationTime(){return 3e6}clearStorageToken(){this.tokenCache=void 0}static getAuthProviders(){return[new i.f]}static instance(){const e=s.getAuthProviders();return s._instance||(s._instance=new s(new r.W(new a.N(new o.f(e))))),s._instance}constructor(e){this.auth=e}}},109174:(e,t,n)=>{"use strict";n.d(t,{CP:()=>Le,En:()=>Ae});var a=n(531093),o=n(12855),r=n(910480),i=n(118565),l=n.n(i),s=n(639765),c=n(548366),d=n(92520),u=n(616166),m=n(8403),g=n(306148),h=n(857677),p=n(380473),b=n(561187),f=n(279395),C=n(545564),y=n(76872),v=n(75496),T=n(316904),x=n(903173),S=n(565095),w=n(664007),E=n(803716),I=n(446751),R=n(347145),A=n(639969),L=n(464077),k=n(141858);async function F(e,t){return Excel.run({delayForCellEdit:!0},(async n=>{let r,i,l=!1;const s=n.workbook.tables.getItemOrNullObject(e);s.load(["name","id"]),n.workbook.load(["autoSave"]);const c=s.getRange().load("cellCount, columnCount, columnIndex, address");try{if(r=s.getHeaderRowRange().load("values,numberFormat,numberFormatCategories"),await n.sync(),s.isNullObject)return void T.M.getInstance().logErrorCode(u.O.GetTableContextFailed,new Error("Table is NullObject"))}catch(e){if(T.M.getInstance().logErrorCode(u.O.GetTableContextFailed,e),e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.itemNotFound&&"Table.getHeaderRowRange"===e.debugInfo.errorLocation)l=!0;else if(e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.itemNotFound&&"TableCollection.getItem"===e.debugInfo.errorLocation)return;r=void 0,(0,R.tgf)()&&(i=o.ye.EmptyHeaders)}try{if(!n.workbook.autoSave)return;s.load("showTotals"),l&&s.load("showHeaders");const e=["rowCount","columnCount"],o=["values","numberFormat","numberFormatCategories"];let d="values";(0,R.yw9)("OfficeVSO_8534150_PassVisibleRowData")&&(e.push("text"),o.push("text"),d="text"),o.push("numberFormatLocal");const u=s.getDataBodyRange().load(e),m=u.getRow(0).load(o),g=u.getLastRow().load(d),h=[];for(let e=0;e<c.columnCount;e++)h.push(s.worksheet.getCell(0,c.columnIndex+e).getEntireColumn().load("hidden"));let p,b,f,C,y,v,T;try{await n.sync(),p=u.rowCount,b=u.columnCount,(0,R.yw9)("OfficeVSO_8534150_PassVisibleRowData")?(f=m.text,v=g.text):(f=m.values,v=g.values),C=q(m),y=m.numberFormatCategories,T=h.map((e=>e.hidden))}catch(e){if(!(z(e)||e instanceof OfficeExtension.Error&&e.code===OfficeExtension.ErrorCodes.generalException))throw e;{s.load("name, showTotals"),l&&s.load("showHeaders");const e=s.getDataBodyRange().load(["rowCount","columnCount"]),t=e.getRow(0).load(o),a=e.getLastRow().load("values"),r=[];for(let e=0;e<c.columnCount;e++)r.push(s.worksheet.getCell(0,c.columnIndex+e).getEntireColumn().load("hidden"));await n.sync(),p=e.rowCount,b=e.columnCount,f=t.values,C=q(t),y=t.numberFormatCategories,v=a.values,T=r.map((e=>e.hidden))}}const x=e=>V(e?e[0]:[]),S=x(r?.values),w=x(f),E=x(v),I=x(C),A=x(y),L=[];for(const[e,t]of T.entries())t||L.push(e);let F=!1;if(s.showTotals){const e=s.getTotalRowRange();e.load("hidden"),await n.sync(),F=!e.hidden}const _=a.ExcelCalc.sheetAddressToExcelSheetRange(c.address);let P;(0,R.iPS)("Microsoft.Office.Excel.FA000000124.OfficeVSO_8415279_PassColorsUsedInTableForFormatting",!1)&&(P=await async function(e,t,n){let a;if(t){const o=await(0,k.q)(e,t,"cell",n);a=[...new Set(o.flat())]}return a}(s.name,L,n));return{id:s.id,name:s.name,address:c.address,headers:S,numRows:p,numColumns:b,firstRowValues:w,lastRowValues:E,numberFormats:I,numberFormatCategories:A,visibleColumns:L,sheetRange:_,totalRow:F,ColorAlreadyUsedForConditionalFormatting:P,tableContained:t?.isContained,tableIntersected:t?0===t.distance:void 0,tableLikeRangeFeatures:i}}catch(e){throw T.M.getInstance().logErrorCode(u.O.GetTableContextFailed,e),e}}))}async function _(e,t){try{return Excel.run({delayForCellEdit:!0},(async n=>{const a=e.interpretation.orientation,r=(0,L.K7)(e),{left:i,top:l,right:s,bottom:c,worksheetId:d}=r;let u=e?.unsupportedFeatures;const m=n.workbook.worksheets.getItem(d);m.load("name");const g=(0,L.vs)(m,r,a);g.load("values");m.getRangeByIndexes(l+1,i,c-l,1).load("values");const h=(0,L._f)(m,r);h.load(["values","numberFormat","numberFormatCategories","numberFormatLocal"]);const p=m.getRangeByIndexes(c,i,1,s-i+1);p.load("values");const b=[];for(let e=i;e<=s;e++){const t=m.getCell(l,e);t.load("hidden"),b.push(t)}await n.sync();const f=(0,L.Sy)(g,a,e.unsupportedFeatures),C=f.some((e=>""===e));(0,R.tgf)()&&(C&&(u|=o.ye.EmptyHeaders),new Set(f).size!==f.length&&(u|=o.ye.DuplicateHeaders));const y=[];for(let e=0;e<s-i+1;e++)b[e].hidden||y.push(e);const v={sheet:m.name,range:{topLeft:{row:l,column:i},bottomRight:{row:c,column:s}}},T=V(h.numberFormatCategories),x=q(h);return{name:e.name,address:e.name,headers:V(f),numRows:c-l,numColumns:s-i+1,firstRowValues:V(h.values[0]),lastRowValues:V(p.values[0]),numberFormats:V(x[0]),numberFormatCategories:T,visibleColumns:y,sheetRange:v,totalRow:!!(0,R.tgf)()&&e.hasTotalRow,tableLikeRange:!0,tableContained:t?.isContained,tableIntersected:t?0===t.distance:void 0,tableLikeRangeFeatures:u}}))}catch(e){throw T.M.getInstance().logErrorCode(u.O.GetTabularRangeContextFailed,e),e}}const P={name:!0};async function N(){return Excel.run((async e=>{const t=e.workbook;return t.load(P),await e.sync(),t.name}))}const M={name:!0,id:!0};async function O(){return Excel.run((async e=>{const t=e.workbook.worksheets;t.load(M),await e.sync();return{worksheets:t.items.map((e=>({id:e.id,name:e.name})))}}))}const D={charts:{name:!0,chartType:!0,title:{text:!0},pivotOptions:{showLegendFieldButtons:!0},worksheet:{id:!0}}};const B={address:!0,rowIndex:!0,rowCount:!0,columnIndex:!0,columnCount:!0},$={name:!0,worksheet:{id:!0},layout:{showColumnGrandTotals:!0,showRowGrandTotals:!0,layoutType:!0}},H={name:!0,fields:{name:!0}},U={name:!0,field:{name:!0}};function q(e){return void 0!==e.numberFormatLocal?e.numberFormatLocal:e.numberFormat}function V(e){return JSON.stringify(e)}function W(e){return V(e?e[0]:[])}function G(e,t){return{worksheetId:t,top:e.rowIndex+1,left:e.columnIndex+1,bottom:e.rowIndex+e.rowCount,right:e.columnIndex+e.columnCount}}function z(e){return e instanceof OfficeExtension.Error&&(e.code===Excel.ErrorCodes.responsePayloadSizeLimitExceeded||"RequestPayloadSizeLimitExceeded"===e.code)}var Q=n(147091),j=n(972424),J=n(486894),Y=n(469486),X=n(83437);class Z{getPythonCalculatedColumnContext(){return{columnCode:this.columnCode}}async updatePythonColumns(){return Excel.run((async e=>{const t=Le.getActiveWorksheetId();if(!t)return;const n=e.workbook.worksheets.getItem(t),a=Le.getActiveTable();if(a){const t=n.getRange(a.address).getRow(1).load(["formulas","values"]);await e.sync();const o=t.formulas[0],r=t.values[0],i=[];for(let e=0;e<o.length;e++){const t=o[e],n=r[e];if(!t.toString().startsWith("=PY")||t===n)continue;const a=(0,Y.vv)(t);""!==a&&i.push(a)}this.columnCode=i}}))}constructor(){this.columnCode=[]}}Z.getInstance=()=>(void 0===Z._instance&&(Z._instance=new Z),Z._instance);var K,ee,te,ne=n(693257),ae=n(468967);function oe(e,t,n){const a=e instanceof DOMException&&"QuotaExceededError"===e.name&&window.localStorage&&0!==window.localStorage.length;switch(n){case"PythonAaTuiShown":{const e=`Failed to ${t} ${n} in local storage. Local storage is ${a?"available":"not available"}.`,o=(0,ae.h3)(u.O.PythonTuiNotShownError,e,void 0);(0,ae.QX)(void 0,o,!1);break}}return a?"QuotaExceeded":"LocalStorageNotAvailable"}!function(e){e.PythonAaTuiShown="PythonAaTuiShown",e.PythonIsThinkDeeperMode="PythonIsThinkDeeperMode",e.UseModelessPythonAA="UseModelessPythonAA"}(K||(K={})),function(e){e.KeyNotFound="KeyNotFound",e.QuotaExceeded="QuotaExceeded",e.LocalStorageNotAvailable="LocalStorageNotAvailable"}(ee||(ee={})),function(e){e.Read="Read",e.Write="Write"}(te||(te={}));var re=n(100062),ie=n(15536),le=n(543435),se=n(857786),ce=n(775568);class de{getPythonConversationHistory(){return this.pythonConversationHistory}getFormulasProcessedPerWorksheet(){return this.formulasProcessedPerWorksheet}getFormulasProcessed(){return this.formulasProcessed}getWorksheetsProcessed(){return this.worksheetsProcessed}resetFormulasProcessedPerWorksheet(){this.formulasProcessedPerWorksheet=0}clearPythonContextBuilder(){this.pythonConversationHistory=[],this.otherPythonCells=[],this.pythonPrompt="",this.pythonCellsUptoAnalysisSheet.clear(),this.resetAllProcessedCounters()}getOtherPythonCells(){return this.otherPythonCells}setQuery(e){this.pythonConversationHistory.push({query:e})}setSelectedPythonTableContext(e){this.pythonConversationHistory.push({tableContext:e})}setSelectedPythonCellContext(e){this.pythonConversationHistory.push({pythonContext:e})}setLlmText(e){this.pythonConversationHistory.push({llmResponse:e})}setCodeAndOutput(e){this.pythonConversationHistory.push({codeAndOutput:e})}setFinalResponse(e){this.pythonConversationHistory.push({finalResponse:e})}setPythonPrompt(e){this.pythonPrompt=e}getPythonPrompt(){return this.pythonPrompt}async updateConversationHistory(e){const t=new Set;for(let n=0;n<this.pythonConversationHistory.length;n++){const a=this.pythonConversationHistory[n];if(a.tableContext){const e=a.tableContext,t=a.tableContext.tableType===le.lp.TableLikeRange?await Le.pythonContextManager.getUpdatedPythonTableContextForTableLikeRange(e):await Le.pythonContextManager.getUpdatedPythonTableContext(a.tableContext);t?this.pythonConversationHistory[n]={tableContext:t}:a.tableContext.wasDeleted=!0}if(a.pythonContext){const o=a.pythonContext.sheetAddress,r=e.get(a.pythonContext.sheetAddress??"");r?(this.pythonConversationHistory[n]={pythonContext:r},t.add(o??"")):a.pythonContext.wasDeleted=!0}if(a.codeAndOutput){const o=a.codeAndOutput.sheetAddress,r=e.get(a.codeAndOutput.sheetAddress??"");r?(this.pythonConversationHistory[n]={codeAndOutput:r},t.add(o??"")):a.codeAndOutput.wasDeleted=!0}}const n=Array.from(e.values()).filter((e=>!t.has(e.sheetAddress??"")));this.otherPythonCells=n}calculatePythonRangeDifference(e,t){return e.rowIndex!==t.rowIndex?e.rowIndex-t.rowIndex:e.columnIndex-t.columnIndex}async callGetSpecialCellsOrNullObjectApi(e,t){const n=t.getUsedRange().getSpecialCellsOrNullObject(Excel.SpecialCellType.formulas).load(["areas","areaCount","isNullObject"]);return await e.sync(),n}async getPythonCellsFromSpecialCellsAreas(e,t,n){const a=[];for(let o=0;o<e.areaCount;o++){const r=e.areas.getItemAt(o).load(["address","formulas","rowIndex","columnIndex"]);await t.sync();const i=r.formulas;let l=r.rowIndex;for(const e of i){let t=r.columnIndex;for(const o of e){if(Y.sy.test(o)){const e=n.getRangeByIndexes(l,t,1,1);e.track(),a.push(e),e.load(["address","rowIndex","columnIndex"])}this.formulasProcessed++,this.formulasProcessedPerWorksheet++,t++}l++}}return await t.sync(),a.sort(((e,t)=>this.calculatePythonRangeDifference(e,t))),a}async getPythonCellsFromWorksheet(e,t){const n=(new Date).getTime();try{const a=await(0,se.Mg)((async()=>await this.callGetSpecialCellsOrNullObjectApi(e,t)),se.xk.CallGetSpecialCellsOrNullObjectApi);if(a.isNullObject)return[];const o=await(0,se.Mg)((async()=>await this.getPythonCellsFromSpecialCellsAreas(a,e,t)),se.xk.GetPythonCellsFromSpecialCellsAreas);return(0,se.Cc)(se.xk.GetPythonCellsFromWorksheet,n,!1),o}catch(e){throw(0,se.Cc)(se.xk.GetPythonCellsFromWorksheet,n,!0),(0,ae.R_)(e)}finally{Le.pythonContextManager.pythonContextBuilder.resetFormulasProcessedPerWorksheet()}}resetAllProcessedCounters(){this.worksheetsProcessed=0,this.formulasProcessed=0,this.formulasProcessedPerWorksheet=0}async getAllPythonCellsUptoAnalysisSheetWithTimeout(e,t,n){const a=(0,R.Z8j)("Microsoft.Office.Excel.FA000000124.PythonAdaContextGetAllPythonCellsUpToAnalysisSheetTimeoutInMS",6e4);this.pythonCellsUptoAnalysisSheet.clear(),this.resetAllProcessedCounters();let o=new Map;try{(0,R.uze)()?await Le.pythonContextManager.executeWithTimeout(a,(a=>this.getAllPythonCellContextOfAASessionAnalysisSheet(e,t,n,a)),se.xk.GetAllPythonCellsOfAASessionAnalysisSheet,"getPythonCellsOfAASessionAnalysisSheetWithTimeout",u.O.GetAllPythonCellsOfAASessionAnalysisSheetTimeout):await Le.pythonContextManager.executeWithTimeout(a,(a=>this.getAllPythonCellContextUptoAnalysisSheet(e,t,n,a)),se.xk.GetAllPythonCellsUptoAnalysisSheet,"getPythonCellsUpToAnalysisSheetWithTimeout",u.O.GetAllPythonCellsUpToAnalysisSheetTimeout)}catch(t){if(!(t instanceof ce.H&&t.errorCode===u.O.GetAllPythonCellsUpToAnalysisSheetTimeout))throw t;{let n=[];n=[{key:v.HR.FormulasProcessed,value:this.formulasProcessed},{key:v.HR.WorksheetsProcessed,value:this.worksheetsProcessed}],(0,ae.QX)(e,t,!0,n)}}finally{o=(0,r.cloneDeep)(this.pythonCellsUptoAnalysisSheet);const e=Array.from(this.pythonCellsUptoAnalysisSheet.entries()).reverse();o=new Map(e),this.pythonCellsUptoAnalysisSheet.clear(),this.resetAllProcessedCounters()}return o}async getAllPythonCellsUptoAnalysisSheet(e,t,n){try{await this.getAllPythonCellContextUptoAnalysisSheet(e,t,n);return(0,r.cloneDeep)(this.pythonCellsUptoAnalysisSheet)}catch(e){throw e}finally{this.pythonCellsUptoAnalysisSheet.clear(),this.resetAllProcessedCounters()}}async getAllPythonCellContextOfAASessionAnalysisSheet(e,t,n,a){return Excel.run({delayForCellEdit:!1},(async o=>{const r=o.workbook.worksheets.load("items"),i=o.workbook.worksheets.getActiveWorksheet();await o.sync();const l=r.items;await(0,Y.Dh)(i,o);const s=Le.pythonContextManager.pythonAnalysisSheetId;if(!s)return;const c=l.find((e=>e.id===s));if(!c)return;let d;try{d=await e((0,A.q9)()),d!==h.OP.PythonCellsCalculating?e(w.m.startExecutingCommand({command:h.OP.PythonCellsCalculating})):d=void 0,await this.loadPythonCellsContextFromWorksheet(o,c,t,n,a),this.worksheetsProcessed++}catch(e){if((0,ae.CS)(e,a))return;throw e instanceof ce.H&&e.errorCode===u.O.GetPythonCellContextTimeoutRecoverable?(0,ae.Uc)(u.O.GetPythonCellContextTimeout,e.errorDetailsNoPII??"",e):e}finally{d&&e(w.m.startExecutingCommand({command:d}))}}))}async getAllPythonCellContextUptoAnalysisSheet(e,t,n,a){return Excel.run({delayForCellEdit:!1},(async o=>{const r=o.workbook.worksheets.load("items");await o.sync();const i=r.items,l=Le.pythonContextManager.pythonAnalysisSheetId;let s,c;s=l?i.findIndex((e=>e.id===l)):i.length-1,-1===s&&(s=i.length-1);const d=i.slice(0,s+1);let m=d[length-1];try{c=await e((0,A.q9)()),c!==h.OP.PythonCellsCalculating?e(w.m.startExecutingCommand({command:h.OP.PythonCellsCalculating})):c=void 0;for(let e=d.length-1;e>=0;e--){if(a?.signal.aborted)return;m=d[e],await this.loadPythonCellsContextFromWorksheet(o,m,t,n,a),this.worksheetsProcessed++}}catch(t){if((0,ae.CS)(t,a))return;if(m.load("id"),await o.sync(),m.id===l)throw t instanceof ce.H&&t.errorCode===u.O.GetPythonCellContextTimeoutRecoverable?(0,ae.Uc)(u.O.GetPythonCellContextTimeout,t.errorDetailsNoPII??"",t):t;{const n=(0,ae.Y8)(t);(0,ae.QX)(e,n,!0)}}finally{c&&e(w.m.startExecutingCommand({command:c}))}}))}async loadPythonCellsContextFromWorksheet(e,t,n,a,o){try{if(o?.signal.aborted)throw(0,ae.Uc)(u.O.PythonContextExtractionAborted,"loadPythonCellsContextFromWorksheet operation aborted by caller.",void 0);let r=[];if(r=await this.getPythonCellsFromWorksheet(e,t),!(0,R.yw9)("OfficeVSO_9052463_UsePythonAnalysisSheetRangeForContextExtraction"))if(t.id===n){const n=t.getRange(a);n.load(["rowIndex","columnIndex"]),await e.sync(),r=r.filter((e=>{const t=this.calculatePythonRangeDifference(e,n)<=0;return e.untrack(),t}))}else r.forEach((e=>{e.untrack()}));for(let e=r.length-1;e>=0;e--){const n=(0,Y.c3)(r[e].address);if(o?.signal.aborted)throw(0,ae.Uc)(u.O.PythonContextExtractionAborted,"loadPythonCellsContextFromWorksheet operation aborted by caller.",void 0);const a=await Le.pythonContextManager.getPythonCellContextWithTimeout(t.id,n,!0,o);this.pythonCellsUptoAnalysisSheet.set(n,a),r[e].untrack()}}catch(e){if((0,ae.CS)(e,o))return;throw e}finally{await e.sync()}}async getLastPythonCellOnSheet(e,t){return Excel.run({delayForCellEdit:!1},(async n=>{const a=(new Date).getTime(),o=n.workbook.worksheets.getItem(e);let r=[];r=await this.getPythonCellsFromWorksheet(n,o);const i=r.length;if(0===i)return;const l=(0,Y.c3)(r[i-1].address);let s;return s=t.get(l),s||(s=await Le.pythonContextManager.getPythonCellContextWithTimeout(o.id,l)),(0,se.Cc)(se.xk.GetLastPythonCellOnSheet,a,!1),s}))}constructor(){this.pythonConversationHistory=[],this.otherPythonCells=[],this.pythonPrompt="",this.pythonCellsUptoAnalysisSheet=new Map,this.worksheetsProcessed=0,this.formulasProcessed=0,this.formulasProcessedPerWorksheet=0}}de._instance=void 0,de.getInstance=()=>(void 0===de._instance&&(de._instance=new de),de._instance);var ue=n(799765),me=n(615956),ge=n(126521),he=n(181730);var pe=n(661588),be=n(212605),fe=n(312422),Ce=n(507628);class ye extends me.r{getDataFrameCodeHelper(e,t=!1){return t?((0,ue.PB)(v.L3.DataFrameCodeProperty,[{key:v.$.TableNameHasBackslash,value:!0}]),`${this.dataFrameName}=xl(r"${e}", headers=${this.hasHeaders?"True":"False"})`):`${this.dataFrameName}=xl("${e}", headers=${this.hasHeaders?"True":"False"})`}getDataFrameCode(e){if(this.tableLikeRange){const e=(0,Y.VF)(this.address,this.hasTotalRow);return this.getDataFrameCodeHelper(e)}{const t=`[${e}]`,n=this.name+t,a=this.name.includes("\\");return this.getDataFrameCodeHelper(n,a)}}getDataFrameLabel(e,t){return(0,ge.L)((0,f.YYS)(),e,t)}clearState(){this.resolve=void 0,this.reject=void 0}resolveAndClear(e){this.resolve&&this.resolve(e),this.clearState()}rejectAndClear(e){this.reject&&this.reject(e),this.clearState()}getAddressAndPythonCellContext(e){const t=Array.from(this.pythonCells.entries()).find((t=>{const[n,a]=t;return!!e(n,a)}));if(void 0!==t)return{address:t[0],pythonCellContext:t[1]}}codeRegexTest(e,t,n){return e.test(n.code)}codeRegexMissingSheetNameTest(e,t,n,o){return a.ExcelCalc.sheetNameFromSheetAddresses(t)===n&&e.test(o.code)}findDataFrame(e){if(this.tableLikeRange){const e=a.ExcelCalc.sheetNameFromSheetAddresses(this.name),t=a.ExcelCalc.localAddressesFromSheetAddresses(this.name),n=(0,Y.UH)(e),o=(0,Y.gQ)(n,t,!0),r=this.getAddressAndPythonCellContext(((e,t)=>this.codeRegexTest(o,e,t)));if(r)return r;const i=(0,Y.gQ)(n,t,!1);return this.getAddressAndPythonCellContext(((t,n)=>this.codeRegexMissingSheetNameTest(i,t,e,n)))}{const t=(0,Y.WM)(this.name,e);return this.getAddressAndPythonCellContext(((e,n)=>this.codeRegexTest(t,e,n)))}}async getListSeparator(e){return e.application.cultureInfo.formulaCulture.load("listSeparator"),await e.sync(),e.application.cultureInfo.formulaCulture.listSeparator??","}autoInsertPythonFormula(){return new Promise(((e,t)=>{this.resolve=e,this.reject=t,(0,fe.F5)((async e=>{try{const t=await this.getListSeparator(e),n=await async function(){return await Excel.run({delayForCellEdit:!1},(async e=>(e.application.load("cultureInfo/formulaCulture/specialRefNames"),await e.sync(),e.application.cultureInfo.formulaCulture.specialRefNames)))}(),o=`[#${n[1]}]${t}[#${n[2]}]`,r=this.findDataFrame(o);if(r){const{address:e,pythonCellContext:t}=r,n=(0,ae.L7)(t);return n?void this.rejectAndClear(n):void this.resolveAndClear(e)}(0,se.Fr)(se.xk.DataFrameInsert),(0,se.BW)(this.dispatch);let i=this.getDataFrameCode(o);const l=(0,Y.ZK)(i,!0,pe.M),[s,c]=(0,Y.Jy)(this.address),d=this.tableLikeRange?c:this.name;this.codeLabel=this.getDataFrameLabel(s,d),i=(0,Y.MA)(i,this.codeLabel);const u=await(0,Y.WH)(e,this.sheetId),m=this.codeLabel,g=await(0,se.Mg)((async()=>this.insertLabelAndContentForPreviewOrFormula(e,u,m,l,!0,!0)),se.xk.InsertContentToGrid),h=a.ExcelCalc.localAddressesFromSheetAddresses(g),p=a.ExcelCalc.sheetNameFromSheetAddresses(g);let b;if((0,R.EJJ)()){const e={type:"code",value:{code:i,codeLabel:this.codeLabel}};b=(0,he.C)([e])}Le.pythonContextManager.lastCodeAndPostViewMessage=be.n.displayPythonCodeCardWithPendingPostView(this.dispatch,(0,Ce.A)(),i,p,h,!0,(0,ge.L)((0,f.vCA)(),s,d),this.codeLabel,b)}catch(e){(0,se.i5)(!1),(0,se.$k)(this.dispatch);const n=(0,ae.MF)(e,"PythonDataFrameInserter","autoInsertPythonFormula",!0);t(n)}}),{delayForCellEdit:!1})}))}onCalculatedHandlerShouldNotGenerate(){super.onCalculatedHandlerShouldNotGenerate(),this.resolveAndClear(null)}async handlePythonCellExecutionResult(e,t){const n=(0,ae.L7)(e);if(n)return void this.rejectAndClear(n);this.addCodeAndOutputToBuilder(e);const a=e.sheetAddress;this.pythonCells.set(a??"",e),this.resolveAndClear(a??"")}constructor(e,t,n,a,o,r,i,l,s){super(i,l,me.n.PythonDataFrameInserter),this.name=e,this.address=t,this.tableLikeRange=n,this.hasHeaders=a,this.hasTotalRow=o,this.pythonCells=r,this.dataFrameName=(0,Y.Yp)(e,t,s)}}async function ve(e,t,n,a,o,r,i){const l=await(0,Y.nC)(i,Le),[s,c]=(0,Y.Jy)(t),d=await async function(e){return await Excel.run((async t=>{const n=t.workbook.worksheets.getItem(e);return n.load("position"),await t.sync(),n.position}))}(s),u=new ye(e,t,n,a,o,r,i,l,d);return await u.autoInsertPythonFormula()}class Te{async setPythonStartAnalysisContext(e){if(!this.query){const e=`Undefined Item: query, Function: setPythonStartAnalysisContext, isPythonCellSelected: ${Le.isPythonCellSelected}`;throw(0,ae.Uc)(u.O.PythonContextUndefinedParameter,e,void 0)}if(!this.sheetId||!this.address){const e=`\n      Address: ${this.address?"Defined":"Undefined"},\n      Sheet Id: ${this.sheetId?"Defined":"Undefined"},\n      Function: setPythonStartAnalysisContext, isPythonCellSelected: ${Le.isPythonCellSelected}`;throw(0,ae.Uc)(u.O.PythonContextUndefinedParameter,e,void 0)}Le.pythonContextManager.pythonContextBuilder.clearPythonContextBuilder(),this.pythonCellContext?this.pythonContextBuilder.setSelectedPythonCellContext(this.pythonCellContext):this.pythonTableContext&&this.pythonContextBuilder.setSelectedPythonTableContext(this.pythonTableContext),this.pythonContextBuilder.setQuery(this.query),await(0,se.ek)((async()=>{await this.pythonContextBuilder.updateConversationHistory(e)}),se.xk.UpdateConversationHistory)}updateTrimmedContext(e){const{query:t,sheetId:n,address:a,pythonCellContext:o,pythonTableContext:r}=e;this.query=t,this.sheetId=n,this.address=a,this.pythonCellContext=o,this.pythonTableContext=r,(0,ue.xX)(ue.Am.Update,!t,Error().stack)}setPythonCellContext(e){this.pythonCellContext=e}setPythonTableContext(e){this.pythonTableContext=e}getTrimmedContextQuery(){return this.query}getTrimmedContextSheetId(){return this.sheetId}getTrimmedContextAddress(){return this.address}getPythonTableContext(){return this.pythonTableContext}clearTrimmedContext(){this.query=void 0,this.sheetId=void 0,this.address=void 0,this.pythonCellContext=void 0,this.pythonTableContext=void 0,(0,ue.xX)(ue.Am.Clear,!0,Error().stack)}async insertDataFrameIfNecessaryForStartAnalysis(e,t){const n=(new Date).getTime(),a=this.getPythonTableContext();if(a){const n=a.tableName,o=a.tableType===le.lp.TableLikeRange,r=a.headers!==f.r$C,i=a.hasTotalRow,l=await ve(n,a.sheetAddress,o,r,i,e,t);if(!Le.pythonContextManager.shouldGenerate)return;const{sheet:s,address:c}=(0,Y.B4)(l,e),d=await Le.pythonContextManager.getPythonCellContextWithTimeout(s,c);d&&(this.setPythonCellContext(d),this.setPythonTableContext(void 0))}else(0,Y.nC)(t,Le);(0,se.QO)(se.xk.InsertDataFrameIfNecessaryForStartAnalysis,n)}constructor(){this.pythonContextBuilder=de.getInstance()}}Te.getInstance=()=>(void 0===Te._instance&&(Te._instance=new Te),Te._instance);var xe=n(579786),Se=n(447773),we=n(821845);class Ee{async getMaxRetryAttempts(e){switch(e){case"ExecutePythonCode":return this.MAX_RETRY_ATTEMPTS_EXECUTE_PYTHON_CODE;case"GetCodeAndOutput":case"GetCellTypeAndValueIfNotBusy":return Math.ceil(await this.getPythonExecutionTimeoutInMilliseconds()/this.RETRY_WAIT_IN_MILLISECONDS);default:return this.MAX_RETRY_ATTEMPTS}}registerOnNewEntry(){this.requestContext.workbook.externalCodeService.diagnostics.onNewEntry.add(ne.w)}setIsPythonMode(e){this.isPythonMode=e,(0,we.z)(e),(0,R.gnD)()&&(this.dispatch(w.m.setIsPythonMode(e)),e||this.setIsPythonThinkDeeperMode(e))}setIsPythonThinkDeeperMode(e){this.isPythonThinkDeeperMode=e,this.dispatch(w.m.setIsPythonThinkDeeperMode(e))}unregisterOnNewEntry(){this.requestContext.workbook.externalCodeService.diagnostics.onNewEntry.remove(ne.w)}enterAdvancedAnalysisMode(){Le.pythonContextManager.setIsPythonMode(!0),Le.pythonContextManager.analysisSessionId=(0,Ce.A)(),Le.pythonContextManager.isFirstCodeExecution=!0,Le.pythonContextManager.registerOnNewEntry()}async init(e){this.dispatch=e}get alreadyShownTui(){return this._alreadyShownTui}set alreadyShownTui(e){this._alreadyShownTui=e,function(e,t){try{return localStorage.setItem(e,t),{isSuccess:!0,errorType:void 0}}catch(t){return{isSuccess:!1,errorType:oe(t,"Write",e)}}}(K.PythonAaTuiShown,e?"true":"false")}async recalcSheet(e=!1){const t=(new Date).getTime(),n=this.pythonTrimmedContext.sheetId;if(!n)return void(0,ue.PB)(v.L3.RecalcSheetMissingSheetId,[]);const a=await(0,Y.eU)();if(a===Excel.CalculationMode.automatic){if(e)this.requestContext.application.calculate(Excel.CalculationType.full);else{this.requestContext.workbook.worksheets.getItem(n).calculate(!0)}await this.requestContext.sync()}(0,se.Cc)(se.xk.RecalcSheet,t,!1,`Calculation Mode: ${a}`)}async getActiveTableContext(e){let t;if(t=(0,R.ZAR)()?await Le.getNearestTable():Le.getActiveTable(),t){const n=(new Date).getTime(),r=a.ExcelCalc.IExcelSheetRangeToSheetAddress(t.sheetRange),i=await(0,xe.vq)(t,e,r,this.dispatch,this.requestContext,this.MAX_SAMPLE_ROWS),l=(0,Y.c3)(r),s={tableName:t.name,headers:t.headers,hasTotalRow:t.totalRow,numRows:t.numRows,numColumns:t.numColumns,sampleRows:i,numberFormat:t.numberFormatCategories,sheetId:e,sheetAddress:l,tableType:t.tableLikeRange?o.lp.TableLikeRange:o.lp.StandardTable};return(0,se.Cc)(se.xk.GetActiveTableContext,n,!1),s}}async insertDataFrameAndGetPythonContext(e,t){const n=(new Date).getTime(),a=e.name,o=e.tableLikeRange??!1,r=e.headers!==f.r$C,i=e.totalRow,l=await ve(a,e.address,o,r,i,t,this.dispatch),{sheet:s,address:c}=(0,Y.B4)(l,t),d=await this.getPythonCellContextWithTimeout(s,c);return(0,se.QO)(se.xk.InsertDataFrameAndGetPythonContext,n),d}getPythonAdaContext(){let e=this.pythonContextBuilder.getPythonConversationHistory().slice(-this.MAX_CONVERSATION_HISTORY);return e=structuredClone(e),e.forEach((e=>{e.pythonContext?delete e.pythonContext.sheetId:e.codeAndOutput&&delete e.codeAndOutput.sheetId})),{staticPromptOverride:"",hasActivePythonLicense:(0,Y.Gd)(),isPythonCellSelected:Le.isPythonCellSelected,conversationHistory:e,otherPythonCells:this.pythonContextBuilder.getOtherPythonCells().slice(-this.MAX_PYTHON_CELLS),queryOrigin:this.queryOrigin}}async setPythonAdaContext(e,t,n,a,r){const i=(new Date).getTime();try{if(this.prePythonModeError=void 0,this.prePythonModeErrorFunction=void 0,this.queryOrigin=r??o.Rk.CopilotSDX,(0,ue.Jr)(this.augloopCallsPerQuery,this.codeRetryAttempts),this.codeRetryAttempts=0,this.augloopCallsPerQuery=0,(0,R.LhK)()&&(this.renderedCardCount=0,Le.pythonContextManager.isAutoScrollingEnabled=!0),!(0,R.H2A)()||!(0,Y.Gd)())return this.pythonContextBuilder.clearPythonContextBuilder(),!0;if(!n||!a){const e=`\n        Address: ${a?"Defined":"Undefined"},\n        Sheet Id: ${n?"Defined":"Undefined"},\n        Function: setPythonAdaContext, isPythonCellSelected: ${Le.isPythonCellSelected}`;throw(0,ae.Uc)(u.O.PythonContextUndefinedParameter,e,void 0)}const l=await this.isPythonCell(n,a);l!==e&&((0,ue.hp)(e,l),Le.isPythonCellSelected=l,e=l);const s={query:t,sheetId:n,address:a};let c;if(c=this.isPythonMode?await this.pythonContextBuilder.getAllPythonCellsUptoAnalysisSheetWithTimeout(this.dispatch,n,a):new Map,e){const e=(0,Y.c3)(a),t=c.get(e);s.pythonCellContext=t||await this.getPythonCellContextWithTimeout(n,a)}else if(this.isPythonMode){const e=Le.pythonContextManager.pythonAnalysisSheetId;if(e&&e===n){const t=await this.pythonContextBuilder.getLastPythonCellOnSheet(e,c);s.pythonCellContext=t}else{let e;if(e=(0,R.ZAR)()?await Le.getNearestTable():Le.getActiveTable(),e)s.pythonCellContext=await this.insertDataFrameAndGetPythonContext(e,c);else{(0,Y.nC)(this.dispatch,Le);const e=await this.pythonContextBuilder.getLastPythonCellOnSheet(n,c);s.pythonCellContext=e}}}else s.pythonTableContext=await this.getActiveTableContext(n);return this.isPythonMode?this.updatePythonContextFieldsForPythonMode(s,c):this.pythonTrimmedContext.updateTrimmedContext(s),(0,se.Cc)(se.xk.AdaContextExtraction,i,!1),!0}catch(e){return this.isPythonMode?((0,se.Cc)(se.xk.AdaContextExtraction,i,!0),(0,ae.Kx)(this.dispatch,e,"setPythonAdaContext",!1),!1):(this.prePythonModeErrorFunction="setPythonAdaContext",this.prePythonModeError=e,!0)}}async isPythonCell(e,t){const n=(new Date).getTime();try{const a=await this.getPythonCellRange(e,t);return await this.requestContext.sync(),await this.getPythonCellType(a),a.untrack(),await this.requestContext.sync(),(0,se.Cc)(se.xk.IsPythonCell,n,!1),!0}catch(e){return(0,se.Cc)(se.xk.IsPythonCell,n,!0),!1}}async getCodeAndOutput(e,t){if(t||(t=await this.getPythonCellType(e)),e.load("valuesAsJson"),await this.requestContext.sync(),"Error"===e.valuesAsJson[0][0].type)return await this.getErrorValue(e);switch(t){case le.px.SinglePythonObjectCell:return await this.getPythonObjectOutput(e);case le.px.SingleExcelValueCell:return await this.getExcelValueSingleCellOutput(e);case le.px.SpilledExcelValueCell:return await this.getExcelValueSpilledRangeOutput(e)}}async getUpdatedPythonTableContext(e){const t=e.tableName,n=this.requestContext.workbook.tables.getItemOrNullObject(t);if(n.load(["isNullObject","showTotals"]),await this.requestContext.sync(),n.isNullObject)return;const a=n.getHeaderRowRange().load("values"),o=n.getDataBodyRange().load(["rowCount","columnCount"]),r=o.getRow(0);r.load("numberFormatCategories"),await this.requestContext.sync();const i=a?JSON.stringify(a.values[0]):"",l=await(0,xe.GF)(t,this.MAX_SAMPLE_ROWS),s=r.numberFormatCategories?JSON.stringify(r.numberFormatCategories):"";return{tableName:t,headers:i,hasTotalRow:n.showTotals,numRows:o.rowCount,numColumns:o.columnCount,sampleRows:l,numberFormat:s,sheetId:e.sheetId,sheetAddress:e.sheetAddress,tableType:e.tableType}}async getUpdatedPythonTableContextForTableLikeRange(e){if(!e.sheetId){throw(0,ae.Uc)(u.O.PythonContextUndefinedParameter,"Undefined Parameter: sheetId, Function: getUpdatedPythonTableContextForTableLikeRange",void 0)}const t=(0,L.R1)(this.dispatch,e.sheetId,e.sheetAddress);if(t){const n=(0,L.K7)(t),{left:a,top:o,right:r,bottom:i,worksheetId:l}=n,s=t.interpretation.orientation,c=this.requestContext.workbook.worksheets.getItem(l),d=(0,L.vs)(c,n,s);d.load("values");const u=(0,L._f)(c,n);u.load("numberFormat");const m=await(0,L.m)(this.requestContext,c,n,this.MAX_SAMPLE_ROWS),g=(0,L.Sy)(d,s,t.unsupportedFeatures);return{tableName:t.name,headers:JSON.stringify(g),hasTotalRow:t.hasTotalRow,numRows:i-o,numColumns:r-a+1,sampleRows:m,numberFormat:JSON.stringify(u.numberFormat[0]),sheetId:e.sheetId,sheetAddress:e.sheetAddress,tableType:e.tableType}}(0,ue.PB)(v.L3.UpdateContextTLRCalledOnNonTLR,[])}async getPythonCellContextWithTimeout(e,t,n=!1,a){if(a?.signal.aborted)throw(0,ae.Uc)(u.O.PythonContextExtractionAborted,"getPythonCellContextWithTimeout was aborted.",void 0);const o=await this.getPythonExecutionTimeoutInMilliseconds()+5e3,r=(0,R.Z8j)("Microsoft.Office.Excel.FA000000124.PythonAdaContextGetPythonCellContextTimeoutInMS",o),i=n?u.O.GetPythonCellContextTimeoutRecoverable:u.O.GetPythonCellContextTimeout;return await this.executeWithTimeout(r,(n=>this.getPythonCellContext(e,t,n)),se.xk.GetPythonCellContext,"getPythonCellContext",i,a)}async getPythonCellContext(e,t,n){try{if(n?.signal.aborted)throw(0,ae.Uc)(u.O.PythonContextExtractionAborted,"getPythonCellContext was aborted.",void 0);if(!e||!t){const e=`Undefined Parameter: ${t?"sheetId":"address"}, Function: getPythonCellContext, isPythonCellSelected: ${Le.isPythonCellSelected}`;throw(0,ae.Uc)(u.O.PythonContextUndefinedParameter,e,void 0)}const a=await this.getPythonCellRange(e,t);await this.requestContext.sync();const o=await this.getPythonCellType(a),r=e=>!(0,ae.U6)(e)&&(!(0,ae.s$)(e)||(this.recalcSheet(!0),!1)),i=performance.now(),l=await this.getMaxRetryAttempts("GetCodeAndOutput"),s=await(0,Y.AJ)((async()=>await this.getCodeAndOutput(a,o)),r,l,this.RETRY_WAIT_IN_MILLISECONDS,!1,this.dispatch,n);a.load(["worksheet/id","address"]).untrack(),await this.requestContext.sync();let c="";if((0,ae.U6)(s)){throw c=`Busy State in codeAndOutput, Total Wait Time (ms): ${performance.now()-i}}, Retry Wait Interval (ms): ${this.RETRY_WAIT_IN_MILLISECONDS}, Python execution timeout (ms): ${await this.getPythonExecutionTimeoutInMilliseconds()}, Max Attempts: ${l}`,(0,ae.jv)(c,void 0)}return{sheetId:a.worksheet.id,sheetAddress:(0,Y.c3)(a.address),code:s.code,output:s.output,outputType:s.outputType}}catch(e){throw(0,R.yw9)("OfficeVSO_9900533_ImproveErrorTelemetryForPythonCellContext")?e instanceof ce.H?e:(0,ae.Uc)(u.O.PythonGeneralContextError,"Unknown error in getPythonCellContext.",e):e}}isStartAnalysisCard(){return this.lastStartAnalysisQueryGuid===T.M.userQueryGuid}exitAdvancedAnalysisMode(){this.pythonAnalysisSheetId=void 0,this.pythonAnalysisSheetExistsOnUserQuerySubmit=!1,this.setIsPythonMode(!1),this.analysisSessionId=void 0,this.pythonContextBuilder.clearPythonContextBuilder(),this.pythonTrimmedContext.clearTrimmedContext(),this.isFirstCodeExecution=!0,Le.pythonContextManager.shouldGenerate=!1,this.unregisterOnNewEntry(),Le.pythonContextManager.lastPythonUserRequestId="",(0,R.LhK)()&&(this.isAutoScrollingEnabled=!0,this.renderedCardCount=0)}async getPythonCellType(e){try{e.load(["formulas","hasSpill"]),await this.requestContext.sync();const t=e.formulas[0][0];if(Y.sy.test(t))return e.hasSpill?le.px.SpilledExcelValueCell:Y.OU.test(t)?le.px.SingleExcelValueCell:le.px.SinglePythonObjectCell;{const e="getPythonCellType: pythonCellType is PythonCellType.None";throw(0,ae.Uc)(u.O.PythonGeneralContextError,e,void 0)}}catch(e){if((0,R.yw9)("OfficeVSO_9900533_ImproveErrorTelemetryForPythonCellContext")){const t="Unknown error in getPythonCellType.";throw(0,ae.Uc)(u.O.PythonGeneralContextError,t,e)}throw e}}async getExcelValueSingleCellOutput(e){const t=(new Date).getTime();e.load(["formulas","valuesAsJson"]),await this.requestContext.sync();const n=(0,Y.vv)(e.formulas[0][0]),a=e.valuesAsJson[0][0];let o,r;switch(a.type){case"LocalImage":o="",r="Image";break;case Excel.CellValueType.notAvailable:o="#Unknown!",r=Excel.CellValueType.error;break;default:o=String(a.basicValue??""),r=String(a.basicType??"")}return(0,se.Cc)(se.xk.GetExcelValueSingleCellOutput,t,!1),{code:n,output:o,outputType:r}}async getExcelValueSpilledRangeOutput(e){const t=(new Date).getTime(),n=e.getSpillingToRangeOrNullObject().load(["isNullObject","rowCount","columnCount"]);if(n.track(),await this.requestContext.sync(),n.isNullObject){n.untrack(),await this.requestContext.sync();const e="getExcelValueSpilledRangeOutput: fullSpilledRange is null";throw(0,ae.Uc)(u.O.PythonGeneralContextError,e,void 0)}const a=n.getRow(0).load("formulas");await this.requestContext.sync();const o=(0,Y.vv)(a.formulas[0][0]),r=[],i=[],l=n.rowCount,s=n.columnCount;for(let e=0;e<this.MAX_SAMPLE_ROWS&&!(e>=l);e++){const t=[],a=n.getRow(e).load(["formulas","valuesAsJson"]);await this.requestContext.sync();const o=[];for(const e of a.valuesAsJson[0])t.push(String(e.basicValue??"")),o.push(String(e.basicType??""));r.push(o),!(t.length>0)||i.push(t)}n.untrack(),await this.requestContext.sync();const c={columnNames:[],dataTypes:r[0],sampleRows:i,numRows:l,numColumns:s};return(0,se.Cc)(se.xk.GetExcelValueSingleCellOutput,t,!1),{code:o,output:c,outputType:"TableLikeRange"}}async composePythonOutputString(e){try{if((0,ue.$y)(e.Python_typeName),e.preview){const t=e.preview;if(t.properties?.arrayPreview?.elements){const e=t.properties.arrayPreview.elements;if(e&&!Y.Xn.test(e[0][0].basicValue)){const t=e.map((e=>e.map((async e=>{if("FormattedNumber"===e.type){return await(0,Se.k0)(e)}return e.basicValue})))).map((async e=>await Promise.all(e.map((e=>Promise.resolve(e)))))),n=await Promise.all(t);return JSON.stringify(n)}}}return e.Python_str}catch{return e.Python_str}}async connectToOfficePySvcToExecutePythonCodeWithRetry(e){const t=(new Date).getTime(),n=e.getPythonContextObject();n.load(["pythonObjectReferenceIds","runtimeUrl"]),await this.requestContext.sync();try{const a=n.pythonObjectReferenceIds[0][0];if(!a)throw(0,ae.Uc)(u.O.GetPythonContextObjectFailed,"pythonObjectReferenceId is empty",void 0);const o=(0,Y.yK)(a),r=JSON.parse(n.runtimeUrl);if(!Array.isArray(r)||0===r.length||!r[0]||"object"!=typeof r[0])throw(0,ae.Uc)(u.O.GetPythonContextObjectFailed,"Invalid or empty runtimeUrl data",void 0);const i=r[0].RuntimeUrl;if(!i)throw(0,ae.Uc)(u.O.GetPythonContextObjectFailed,"runtimeurl is empty",void 0);return(0,se.l5)(se.xk.GetPythonContextObjectApiCall,t,0),await this.executePythonCodeWithRetry(o,e,i)}catch(e){if((0,se.l5)(se.xk.GetPythonContextObjectApiCall,t,0,!0),(0,R.yw9)("OfficeVSO_10004713_updateExecutePythonCodeErrorToEvent")){const t=e instanceof ce.H&&e.errorDetailsNoPII?e.errorDetailsNoPII:"connectToOfficePySvcToExecutePythonCodeWithRetry unknown error",n=[];n.push({key:v.$.ErrorMessage,value:t}),(0,ue.PB)(v.L3.GetPythonContextObjectFailed,n)}else{let t;if(e instanceof ce.H)t=e;else{const n=(0,ae.MQ)(e,"tryConnectingOfficePyServiceToExecuteCode");t=(0,ae.Uc)(u.O.GetPythonContextObjectFailed,n,void 0)}(0,ae.QX)(this.dispatch,t,!1)}}}async getPythonObjectOutputWithRetry(e){if((0,R.Ap6)())if((0,R.yw9)("OfficeVSO_10004713_fixEmptyRuntimeUrl")){const t=await this.connectToOfficePySvcToExecutePythonCodeWithRetry(e);if(t)return t}else{const t=e.getPythonContextObject();t.load(["pythonObjectReferenceIds","runtimeUrl"]),await this.requestContext.sync();const n=(0,Y.yK)(t.pythonObjectReferenceIds[0][0]);try{const a=JSON.parse(t.runtimeUrl)[0].RuntimeUrl;return await this.executePythonCodeWithRetry(n,e,a)}catch(e){const t=(0,ae.MQ)(e,"getPythonObjectOutputWithRetry"),n=(0,ae.Uc)(u.O.GetOfficePyServiceRuntimeUrlFailed,t,void 0);(0,ae.QX)(this.dispatch,n,!1)}}e.load("address");const t=await this.getPythonObjectReferenceIdWithRetry(e),n=(0,Y.yK)(t);return await this.executePythonCodeWithRetry(n,e)}async getPythonObjectOutput(e){const t=(new Date).getTime();let n;e.load("formulas"),await this.requestContext.sync();const a=e.valuesAsJson[0][0],o=(0,Y.vv)(e.formulas[0][0]);if("DataFrame"!==a.Python_typeName)n={code:o,output:await this.composePythonOutputString(a),outputType:a.Python_type};else{const t=await this.getPythonObjectOutputWithRetry(e),a=t?.result;if(!a)throw(0,ae.Uc)(u.O.PythonPayloadEmptyError,"Python payload is undefined in getPythonObjectOutput",void 0);const r=a.value,i=a.value_type,l=r.sampleRows;for(let e=0;e<l.length;e++)l[e]=(0,Y.LC)(l[e]);n={code:o,output:{columnNames:r.columnNames,dataTypes:r.dataTypes,sampleRows:l,numRows:r.numRows,numColumns:r.numColumns},outputType:i}}return(0,se.Cc)(se.xk.GetPythonObjectOutput,t,!1,`Python Object Output Type: ${n.outputType}`),n}async executeWithTimeout(e,t,n,a,o,r){const i=(new Date).getTime();let l,s=!1;const c=r||new AbortController,d=new Promise(((t,n)=>{l=window.setTimeout((()=>{c.abort(),t()}),e)})),u=t(c).finally((()=>{l&&window.clearTimeout(l),s=!0,(0,se.Cc)(n,i,!1)}));if(await Promise.race([d,u]),s)return await u;{const e=(0,h.xJ)(i);throw(0,ae.Uc)(o,`${a} after ${e} ms`,void 0)}}async connectToOfficePySvcToExecutePythonCode(e,t,n,a){const o=(new Date).getTime(),r=a||(0,Ce.A)();let i;try{i=await re.v.instance().authorizeOfficePyService(r),(0,se.l5)(se.xk.GetOfficePyServiceAccessToken,o,t)}catch(e){if((0,R.yw9)("OfficeVSO_10004713_fixEmptyRuntimeUrl")){const e=[];e.push({key:v.$.ExecutePythonCodeCorrelationId,value:r}),(0,ue.PB)(v.L3.GetOfficePyServiceAccessTokenFailed,e)}(0,se.l5)(se.xk.GetOfficePyServiceAccessToken,o,t,!0);const n=(0,ae.MQ)(e,"connectToOfficePySvcToExecutePythonCode");throw(0,ae.Uc)(u.O.GetOfficePyServiceAccessTokenFailed,n,void 0)}const l=(0,R.Z8j)("Microsoft.Office.Excel.FA000000124.ExecutePythonCodeTimeoutInMS",5e3),s=(new Date).getTime();let c,d=!1;const m=new Promise(((e,t)=>{c=window.setTimeout((()=>{e()}),l)})),g={code:e};(0,R.yw9)("OfficeVSO_10004713_passOfficePyTraceId")&&(g.traceId=r.replace(/-/g,""));const p=(0,ie.Jx)({url:n,requestToken:i}).execute(g).then((e=>(c&&window.clearTimeout(c),d=!0,(0,se.l5)(se.xk.ConnectOfficePySvcToExecutePythonCode,s,t),e))).catch((e=>{if(c&&window.clearTimeout(c),d=!0,(0,R.yw9)("OfficeVSO_10004713_passOfficePyTraceId")){(0,se.l5)(se.xk.ConnectOfficePySvcToExecutePythonCode,s,t,!0);throw(0,ae.Uc)(u.O.ConnectOfficePyServiceExecuteCodeException,`connectToOfficePySvc and executePythonCode exception. CorrelationId: ${r}.`,void 0)}throw(0,se.l5)(se.xk.ConnectOfficePySvcToExecutePythonCode,s,t),e}));if(await Promise.race([m,p]),d)return await p;{const e=(0,h.xJ)(s);throw(0,ae.Uc)(u.O.ConnectOfficePyServiceExecuteCodeTimeout,`connectToOfficePySvc and executePythonCode timed out after ${e} ms. CorrelationId: ${r}`,void 0)}}async executePythonCodeWithTimeout(e,t,n,a){if(!(0,R.yw9)("OfficeVSO_10004713_fixEmptyRuntimeUrl")&&(0,R.Ap6)()&&!a){const e=(0,ae.Uc)(u.O.GetOfficePyServiceRuntimeUrlFailed,"empty runtimeurl",void 0);(0,ae.QX)(this.dispatch,e,!1)}if((0,R.Ap6)()&&a)try{return await this.connectToOfficePySvcToExecutePythonCode(e,t,a,n)}catch(e){if((0,R.yw9)("OfficeVSO_10004713_updateExecutePythonCodeErrorToEvent")){const t=e instanceof ce.H&&e.errorDetailsNoPII?e.errorDetailsNoPII:"connectToOfficePySvcToExecutePythonCode unknown error",n=[];n.push({key:v.$.ErrorMessage,value:t}),(0,ue.PB)(v.L3.CannotConnectToOfficePyService,n)}else{let t;if(e instanceof ce.H)t=e;else{if((0,R.yw9)("OfficeVSO_10004713_fixEmptyRuntimeUrl")){const n=(0,ae.MQ)(e,"ConnectToOfficePySvcToExecutePythonCode");t=(0,ae.Uc)(u.O.ConnectToOfficePySvcToExecutePythonCodeUnexpectedError,n,e)}else{const n=(0,ae.MQ)(e,"executePythonCodeWithTimeout");t=(0,ae.Uc)(u.O.GetOfficePyServiceRuntimeUrlFailed,n,e)}(0,ae.QX)(this.dispatch,t,!1)}}}const o=(0,R.Z8j)("Microsoft.Office.Excel.FA000000124.ExecutePythonCodeTimeoutInMS",5e3),r=(new Date).getTime();let i,l=!1;const s=new Promise(((e,t)=>{i=window.setTimeout((()=>{e()}),o)})),c=OfficeFirstParty.externalCodeService.executePythonCode(e,{correlationId:n}).finally((()=>{i&&window.clearTimeout(i),l=!0,(0,se.l5)(se.xk.ExecutePythonCodeApiCall,r,t)}));if(await Promise.race([s,c]),l){const e=await c;return JSON.parse(e)}return{error_name:"executeTimedOut",error_message:`executePythonCode timed out after ${(0,h.xJ)(r)} ms`}}async executePythonCodeWithObjectReferenceRetry(e,t,n,a,o){const r=await this.getPythonObjectReferenceId(t);if(r)return e=(0,Y.yK)(r),await this.executePythonCodeWithTimeout(e,n,a,o)}async executePythonCodeWithRetry(e,t,n){let a,o=0;const r=(new Date).getTime(),i=(0,Ce.A)();if(a=await this.executePythonCodeWithTimeout(e,o++,i,n),void 0===a?.error_name&&a?.result&&a?.result.value)return a;let l;if(l=void 0!==a?.error_name?`executePythonCode API Call Failed - ErrorName: ${a?.error_name}, ErrorMessage: ${a?.error_message}`:`executePythonCode API Call Failed - Value_Type: ${a?.result.value_type}, Value: ${a?.result.value}`,(0,ue.nQ)(i,l),await Excel.run((async()=>{this.requestContext.application.calculate(Excel.CalculationType.full)})),await this.requestContext.sync(),a=await(0,Y.AJ)((async()=>await this.executePythonCodeWithObjectReferenceRetry(e,t,o,i,n)),(e=>(o++,void 0===e?.error_name&&e?.result&&e?.result.value)),await this.getMaxRetryAttempts("ExecutePythonCode"),this.RETRY_WAIT_IN_MILLISECONDS,!0,this.dispatch),void 0===a?.error_name&&a?.result&&a?.result.value)return a;const s=`executePythonCodeWithRetry:\nHResult: ${a?.hresult}\nError Name: ${a?.error_name}\nError Message: ${a?.error_message}`;if(""===a?.error_name&&""===a?.error_message)throw(0,ae.w5)(s);if(a?.result&&a?.result.value_type===le.qf.None){const e=`executePythonCodeWithRetry:\nValue_Type: ${a?.result.value_type}\nValue ${a?.result.value}}`;throw(0,ae.Pi)(e)}if("executeTimedOut"===a?.error_name){const e=(0,h.xJ)(r),t=`executePythonCodeWithRetry:\nHResult: ${a?.hresult}\nError Name: ${a?.error_name}\nError Message: ${a?.error_message}\nRetry Attempts: ${o}\nTotal Retry Wait: ${e} ms`;throw(0,ae.Uc)(u.O.ExecutePythonCodeApiCallTimeout,t,void 0)}throw(0,ae.Uc)(u.O.PythonGeneralContextError,s,void 0)}async getPythonObjectReferenceId(e){const t=e.getPythonObjectReferenceIds();await this.requestContext.sync();return t.value[0][0]}async getPythonObjectReferenceIdWithRetry(e){const t=(new Date).getTime();let n=await this.getPythonObjectReferenceId(e);if(n)return n;if(await Excel.run((async()=>{this.requestContext.application.calculate(Excel.CalculationType.full)})),await this.requestContext.sync(),n=await(0,Y.AJ)((async()=>await this.getPythonObjectReferenceId(e)),(e=>!!e),await this.getMaxRetryAttempts("GetPythonObjectReferenceId"),this.RETRY_WAIT_IN_MILLISECONDS,!0,this.dispatch),n)return(0,se.l5)(se.xk.GetPythonObjectReferenceIdWithRetry,t),n;throw(0,ae.Uc)(u.O.PythonGeneralContextError,"getPythonObjectReferenceIdWithRetry: id is undefined.",void 0)}async getErrorValue(e){e.load(["formulas","valuesAsJson"]),await this.requestContext.sync();const t=(0,Y.vv)(e.formulas[0][0]),{errorName:n,errorType:a,errorSubType:o,errorMessage:r}=(0,Y.$e)(e);let i;i=o||(n&&r?`${n}: ${r}`:"");return{code:t,output:{errorType:a,errorDetail:i},outputType:"Error"}}async getPythonCellRange(e,t){const n=(new Date).getTime(),a=this.requestContext.workbook.worksheets.getItem(e).getRange(t).getCell(0,0).load("hasSpill").track();let o;if(await this.requestContext.sync(),a.hasSpill){if(o=a.getSpillParentOrNullObject().load("isNullObject"),o.track(),a.untrack(),await this.requestContext.sync(),o.isNullObject){o.untrack();const e="getPythonCellRange: pythonCellRange is unexpectedly null for spilled Python cell.";throw(0,ae.Uc)(u.O.PythonGeneralContextError,e,void 0)}return(0,se.Cc)(se.xk.GetPythonCellRange,n,!1),o}return a}async updatePythonContextFieldsForPythonMode(e,t){const{query:n,pythonCellContext:a,pythonTableContext:o}=e,r=a&&o;if(r){const e=`updatePythonContextFields: isBothDefined: ${r}.`;throw(0,ae.Uc)(u.O.PythonInvalidSelectedContext,e,void 0)}a?this.pythonContextBuilder.setSelectedPythonCellContext(a):o&&this.pythonContextBuilder.setSelectedPythonTableContext(o),this.pythonContextBuilder.setQuery(n),await(0,se.ek)((async()=>{await this.pythonContextBuilder.updateConversationHistory(t)}),se.xk.UpdateConversationHistory)}getLastPythonCell(e){const t=this.pythonContextBuilder.getPythonConversationHistory();for(let n=t.length-1;n>=0;n--){const a=t[n];if(e&&a.query)return null;if(a.codeAndOutput&&!a.codeAndOutput.wasDeleted)return a.codeAndOutput}return null}constructor(e){this.RETRY_WAIT_IN_MILLISECONDS=1e3,this.MAX_RETRY_ATTEMPTS=10,this.MAX_RETRY_ATTEMPTS_EXECUTE_PYTHON_CODE=5,this.MAX_CODE_RETRY_ATTEMPTS=(0,R.Z8j)("Microsoft.Office.Excel.FA000000124.PythonAdaMaxCodeRetryAttempts",2),this.MAX_AUGLOOP_CALLS_PER_QUERY_THINK_DEEPER=(0,R.Z8j)("Microsoft.Office.Excel.FA000000124.PythonAdaMaxAugLoopCallsPerQuery",10),this.MAX_AUGLOOP_CALLS_PER_QUERY=(0,R.Z8j)("Microsoft.Office.Excel.FA000000124.PythonAaMaxAugLoopCallsPerQueryRegularMode",10),this.isPythonMode=!1,this.isPythonThinkDeeperMode=!1,this.isFirstCodeExecution=!0,this.pythonAnalysisSheetExistsOnUserQuerySubmit=!1,this.codeRetryAttempts=0,this.disableAutoScroll=!1,this.isAutoScrollingEnabled=!0,this.renderedCardCount=0,this.augloopCallsPerQuery=0,this.ocvErrorDetails={},this.diagnosticsEntriesMap=new Map,this.lastPythonUserRequestId="",this.queryOrigin=o.Rk.CopilotSDX,this.shouldGenerate=!0,this.getPythonExecutionTimeoutInMilliseconds=async()=>this.pythonExecutionTimeout?this.pythonExecutionTimeout:await Excel.run((async e=>{e.workbook.load(["externalCodeServiceTimeout"]),await e.sync();const t=1e3*(e.workbook.externalCodeServiceTimeout??30);return this.pythonExecutionTimeout=t+5e3,this.pythonExecutionTimeout})),this.MAX_SAMPLE_ROWS=(0,R.Z8j)("Microsoft.Office.Excel.FA000000124.PythonAdaContextMaxSampleRows",5),this.MAX_CONVERSATION_HISTORY=(0,R.Z8j)("Microsoft.Office.Excel.FA000000124.PythonAdaContextMaxConversationHistory",50),this.MAX_PYTHON_CELLS=(0,R.Z8j)("Microsoft.Office.Excel.FA000000124.PythonAdaContextMaxPythonCells",50),this.pythonContextBuilder=de.getInstance(),this.pythonTrimmedContext=Te.getInstance(),this.requestContext=e;const t=function(e){try{const t=localStorage.getItem(e);return null===t?{value:void 0,errorType:"KeyNotFound"}:{value:t,errorType:void 0}}catch(t){return{value:void 0,errorType:oe(t,"Read",e)}}}(K.PythonAaTuiShown);t.errorType?this._alreadyShownTui=!1:this._alreadyShownTui="true"===t.value}}Ee._instance=void 0,Ee.getInstance=e=>(void 0===Ee._instance&&(Ee._instance=new Ee(e)),Ee._instance);var Ie=n(110686);class Re{get dispatch(){return(0,R.yw9)("OfficeVSO_10501487_ContextManagerStore")?(0,m.KA)().dispatch:this.dispatch_DEPRECATED}lockContextRefresh(e){const t=this.mutex.tryAcquire(e);void 0!==t?this.mutexToken=t:this.mutex.logMutexTokenError("Context already locked.","ContextManager",e)}async releaseContextLock(){try{this.mutexToken?.release(),this.mutexToken=void 0,await this.updateSelection()}catch(e){}}async runWithNoContextRefresh(e){const t=void 0!==this.mutexToken;(0,d.cY)("ContextManager.runWithNoContextRefresh",{currentlyLocked:t}),t||this.lockContextRefresh();try{return await e()}finally{t||this.releaseContextLock()}}async runWithContextRefreshAndLoader(e,t=h.OP.ActionAI){this.dispatch(w.m.startExecutingCommand({command:t}));const n=void 0!==this.mutexToken;n||this.lockContextRefresh(t);try{return await e()}finally{n||await this.dispatch((0,A.L4)())}}clearMergedCellsFromActiveTable(){const e=this.activeWorksheetId,t=this.getActiveTable();if(e&&t?.tableLikeRangeFeatures){const n={hasMergedCells:!1,unsupportedFeatures:t.tableLikeRangeFeatures&~o.ye.HasMergedCells};this.dispatch((0,E.mI)(e,t.name,n))}}clearCachedTableInterpretationsForUndo(){this.dispatch(x.m.clearCachedTableInterpretationsForUndo())}isContextLocked(){return!!this.mutexToken}getActiveWorksheetName(){return this.activeWorksheetName}getActiveWorksheetId(){return this.activeWorksheetId}getPythonActiveTableSheetId(){return this.activePythonTableSheetId}getActiveTable(e=0){return this.activeTables.length?this.activeTables[e]:void 0}getSelectedTableName(e=0){return this.selectedTableNames?.length?this.selectedTableNames[e]:void 0}async getNearestTable(){if(this.activeWorksheetId&&this.activeCell){const e=await this.getClosestTableInfo(this.activeWorksheetId,this.activeCell);if(e)return e?.tabularRange?await _(e.tabularRange,e):await F(e.name,e)}}getRangeAddressesFromAddress(e){return e.includes("!")?a.ExcelCalc.localAddressesFromSheetAddresses(e).split(","):e.split(",")}getActiveRangeAddresses(){if(!this.activeRangeAddress)return[];return this.getRangeAddressesFromAddress(this.activeRangeAddress).map((e=>`${this.activeWorksheetName}!${e}`))}getActiveTableRowNumber(){return this.getActiveTable()?.numRows??0}getHumanInTheLoopRange(){return this.humanInTheLoopRange}setHumanInTheLoopRange(e){this.humanInTheLoopRange=e}setPythonAdaStaticPromptOverride(e){this.pythonAdaStaticPromptOverride=e}getSheetGoBackButtonPointTo(){return this.sheetGoBackButtonPointTo}setSheetGoBackButtonPointTo(e){this.sheetGoBackButtonPointTo=e}async getContextString(e){(0,R.yw9)("OfficeVSO_8434690_ContextManagerIntegrityCheck")&&(0,R.tgf)()&&await this.doSelectionIntegrityCheck();const t=this.getActiveTable(),n={activeTables:this.activeTables};(0,R.ZAR)()&&(n.hiddenSheetIds=this.hiddenSheetIds),this.activeUxRail&&(0,R.xyg)("CopilotUxRailsOverride")&&(n.activeUxRail={type:this.activeUxRail});const a=(0,R.geU)();if(a&&(0,R.wyh)()&&(n.activeUxRail={type:"Office Js"}),(0,R.H2A)()){const e=this.pythonContextManager.getPythonAdaContext();n.pythonAdaContext=e,(0,Y.mx)(e),(0,R.w9F)()&&this.pythonAdaStaticPromptOverride&&(n.pythonAdaContext.staticPromptOverride=this.pythonAdaStaticPromptOverride)}if((0,R.vom)()){const e=this.pythonCalculatedColumnContextManager?.getPythonCalculatedColumnContext();n.pythonCalculatedColumnContext=e}a&&(n.activeChart=this.activeChart,n.activeRange=this.activeRange,n.activePivotTable=this.activePivotTable,n.nearestChart=this.nearestChart,n.allCharts=this.allCharts),(0,R.avT)()&&(n.officeScriptsContext=C.y.getInstance().getOfficeScriptsContext()),(0,R.tgf)()&&(n.activeChart=this.activeChart,n.activeRangeAreas=this.activeRangeAreas,n.activePivotTable=this.activePivotTable),n.activeCell=this.activeCell;const r=(0,Q.Qo)(this.dispatch);if(r&&(n.formulaSkillContext=await(0,Q.w2)(this.dispatch,e,t)),(0,R.LrR)()){const e=this.dispatch((0,Ie.Z)());e.isLoaded&&(n.localeInfo=(0,I.Ft)(e.calcLocaleInfo),n.dataLocale=e.dataLocale)}else if(t){const e=this.dispatch((0,E.xQ)(t.name));e&&(n.localeInfo=(0,I.Ft)(e.localeCacheDeprecated.calcLocaleInfo),n.dataLocale=e.localeCacheDeprecated.dataLocale)}if(n.localeInfo&&n.dataLocale||(0,Q.yT)(this.dispatch,e,"localeInfo"),n.isActiveTableCtrlT=!t?.tableLikeRange,"PAYLOAD_TOO_LARGE"===this.selectionError&&(n.unsupportedContext=(n.unsupportedContext??0)|o.b_.PayloadTooLarge),(0,R.yw9)("OfficeVSO_9679906_AlwaysSetActiveWorksheetInContext")&&this.activeWorksheetId&&this.activeWorksheetName&&(n.activeWorksheet={id:this.activeWorksheetId,name:this.activeWorksheetName}),(0,R.CpS)()&&this.activeWorksheetId&&this.activeCell){const e=await this.getClosestTableInfo(this.activeWorksheetId,this.activeCell);if(e)if(e?.tabularRange)try{n.nearestTable=await _(e.tabularRange,e)}catch(e){(0,d.cY)("Failed to add TLR nearestTable to context",e)}else try{n.nearestTable=await F(e.name,e)}catch(e){(0,d.cY)("Failed to add ctrl-t nearestTable to context",e)}if(!(0,R.yw9)("OfficeVSO_10165383_disableTlrCellBlobHarvesting")&&(0,R.Y$0)()||(0,R.JMu)()||r){const e=this.dispatch((0,E.QF)());n.workbookTables=e}}if((0,R.Y$0)()){const e=Date.now(),[t,a,o,r]=await Promise.all([N(),O(),Excel.run((async e=>{const t=e.workbook.worksheets;t.load(D),await e.sync();const n=t.items.map((e=>e.charts)),a=(0,R.bx9)(),o=n.flatMap((e=>e.items.map((e=>({chart:e,range:e.getDataRange(),jsonDOM:a?e.getContextDOM():void 0})))));return await e.sync(),{workbookCharts:o.map((e=>({worksheetId:e.chart.worksheet.id,name:e.chart.name,title:e.chart.title.text,chartType:e.chart.chartType,dataRange:e.range.value,isPivotChart:e.chart.pivotOptions.showLegendFieldButtons,jsonDOM:e.jsonDOM})))}})),Excel.run((async e=>{const t=e.workbook.pivotTables;t.load($),await e.sync(),t.items.forEach((e=>{e.hierarchies.load(H),e.rowHierarchies.load(H),e.columnHierarchies.load(H),e.filterHierarchies.load(H),e.dataHierarchies.load(U)})),await e.sync();const n=t.items.map((e=>{const t=e.columnHierarchies.items.filter((e=>"Values"!==e.name)).length,n=e.rowHierarchies.items.length,a=e.dataHierarchies.items.length,o=e.filterHierarchies.items.length;return{pivotTable:e,dataSource:e.getDataSourceString(),dataSourceType:e.getDataSourceType(),range:e.layout.getRange().load(B),columnLabelRange:t>0?e.layout.getColumnLabelRange().load(B):void 0,rowLabelRange:n>0?e.layout.getRowLabelRange().load(B):void 0,dataBodyRange:a>0?e.layout.getDataBodyRange().load(B):void 0,filterRange:o>0?e.layout.getFilterAxisRange().load(B):void 0}}));return await e.sync(),{workbookPivotTables:n.map((e=>{const{pivotTable:t,dataSource:n,dataSourceType:a,range:o,columnLabelRange:r,rowLabelRange:i,dataBodyRange:l,filterRange:s}=e;return{name:t.name,range:G(o,t.worksheet.id),columnLabelAddress:r?.address,rowLabelAddress:i?.address,dataBodyAddress:l?.address,filterAddress:s?.address,dataSourceType:a.value,dataSourceString:n.value,fields:t.hierarchies.items.map((e=>e.name)),rows:t.rowHierarchies.items.map((e=>({name:e.name,fields:e.fields.items.map((e=>e.name))}))),columns:t.columnHierarchies.items.map((e=>({name:e.name,fields:e.fields.items.map((e=>e.name))}))),filters:t.filterHierarchies.items.map((e=>({name:e.name,fields:e.fields.items.map((e=>e.name))}))),values:t.dataHierarchies.items.map((e=>({name:e.name,field:e.field.name}))),layout:{showColumnGrandTotals:t.layout.showColumnGrandTotals,showRowGrandTotals:t.layout.showRowGrandTotals,layoutType:t.layout.layoutType}}}))}}))]);y.E.getInstance().logLatency(Date.now()-e,h.OP.DocumentContextCollection),n.workbookName=t,n.worksheets=a.worksheets,(0,R.yw9)("OfficeVSO_10165383_disableTlrCellBlobHarvesting")||(n.workbookBlobRanges=this.dispatch((0,E.H7)())),Re.addChartsAndPivotTablesToDocumentContext(n,o.workbookCharts,r.workbookPivotTables)}if(n.activeWorksheet||(0,Q.yT)(this.dispatch,e,"activeWorksheet"),(0,R.eFk)()){const e=this.dispatch((0,A.SW)());n.dataShapingContext=function(e){return{enableDebugging:e.enableDebugging,...e.started?{sessionId:e.sessionId,queryScript:e.queryScript,baseScript:e.baseScript,tableName:e.tableName,chatHistory:e.chatHistory}:{sessionId:void 0}}}(e)}(r||(0,R.xLF)())&&(n.queryOrigin=this.dispatch((0,A.HE)(e)),n.onGridQueryCellAddress=this.dispatch((0,A.Y4)(e))),(0,R.xLF)()&&(n.elseCategory=this.dispatch((0,A.jc)(e)));const i=new Set(["sheetRange","totalRow","tableLikeRange","tableContained"]);(0,R.tgf)()||(i.add("tableLikeRangeFeatures"),i.add("tableIntersected")),r&&(i.delete("address"),i.delete("totalRow"));const l=Object.fromEntries(Array.from(i.keys(),(e=>[e,void 0])));return JSON.stringify(n,((e,t)=>"activeTables"===e&&t?t.map((e=>({...e,tableContextOverrides:l}))):t))}static addChartsAndPivotTablesToDocumentContext(e,t,n){const a=(0,R.bzg)(),r=(0,R.tsg)(),i=e.activeWorksheet?.id;if(e.documentContextFlags=o.w2.None,t&&t.length>r){e.documentContextFlags|=o.w2.TooManyCharts;const n=(i?t.filter((e=>e.worksheetId===i)):t).slice(0,r);e.workbookCharts=n}else e.workbookCharts=t;if(n&&n.length>a){e.documentContextFlags|=o.w2.TooManyPivotTables;const t=(i?n.filter((e=>e.range?.worksheetId===i)):n).slice(0,a);e.workbookPivotTables=t}else e.workbookPivotTables=n;const l=JSON.stringify({documentContextFlags:e.documentContextFlags,pivotTableCount:n?.length??0,chartCount:t?.length??0,undefinedWorksheetId:void 0===i});y.E.getInstance().updateTelemetryChatEventData({[h.h3.ChatEventType]:h.a5.DocumentContextFlags,[h.h3.ChatEventParameters]:l},T.M.getInstance())}getQueryIdShouldNotShowFluxResponse(){return this.queryIdShouldNotShowFluxResponse}setQueryIdShouldNotShowFluxResponse(e){this.queryIdShouldNotShowFluxResponse=e}isTableHeaderShown(e=0){return this.activeTables.length>0&&!!this.activeTables[e].headers}async ensureSheetName(e,t){return e||(t===this.activeWorksheetId&&this.activeWorksheetName?this.activeWorksheetName:await Excel.run({delayForCellEdit:!0},(async e=>{const n=e.workbook.worksheets.getItem(t);return n.load("name"),await e.sync(),n.name})))}async initPublic(e){return(0,R.yw9)("OfficeVSO_10501487_ContextManagerStore")||(this.dispatch_DEPRECATED=e),this.initMemo.promise()}async init(){const e=performance.now();try{await this.pythonContextManager.init(this.dispatch);const e=(0,R.eFk)();y.E.getInstance().setInitContextTime(),await this.updateSelection(),(0,R.avT)()&&(await C.y.getInstance().initOfficeScriptsContext(),(0,R.Lap)()&&await C.y.getInstance().checkIfFlowCreatedFromPowerAutomate()),e&&await(0,J.uR)(),await Excel.run({delayForCellEdit:!0},(async t=>{try{const e=t.workbook.worksheets.getActiveWorksheet().load(["protection/protected","protection/isPaused"]);await t.sync(),e.protection.protected&&!e.protection.isPaused&&this.dispatch(x.m.setIsWorksheetProtected(!0))}catch(e){if(!(e instanceof OfficeExtension.Error&&"InvalidSelection"===e.code))throw e;this.setSelectionError("INVALID_SELECTION"),this.dispatch(x.m.setIsWorksheet(!1))}t.workbook.load(["autoSave"]),t.workbook.worksheets.onSelectionChanged.add((async e=>{this.mutexToken?((0,d.cY)("ContextManager.onSelectionChanged skipped"),this.mutexToken.logSelectionChangeEvent()):((0,d.cY)("ContextManager.onSelectionChanged called",e),await this.updateSelection())})),t.workbook.worksheets.onDeactivated.add((async()=>{await this.onWorksheetDeactivated()})),t.workbook.onAutoSaveSettingChanged.add((async()=>{await this.updateSelection()})),t.workbook.worksheets.onChanged.add((0,d.g5)((async e=>{if(this.mutexToken)return;const t=this.getActiveTable();t?.tableLikeRange&&await this.isWorksheetChangeWithinTable(e,t)&&await this.refreshActiveTable(!0,t.name)}),250)),(0,R.yw9)("OfficeVSO_9451523_renameWorksheetAssortedIssues")&&t.workbook.worksheets.onNameChanged.add((async e=>{this.mutexToken||(await this.dispatch((0,E.fx)(e.worksheetId)),await this.updateSelection()),e.nameBefore!==e.nameAfter&&this.getSheetGoBackButtonPointTo()===e.worksheetId&&(0,g.s_)(g.H0.UpdateGoBackToData,e.nameBefore,e.nameAfter)})),t.workbook.worksheets.onFormatChanged.add((async e=>{if(this.mutexToken)return;if(e.worksheetId!==this.activeWorksheetId)return;const t=this.getActiveTable()?.address;t?.includes("!")&&a.ExcelCalc.IExcelRangeIntersect(a.ExcelCalc.addressToExcelRange(e.address),a.ExcelCalc.addressToExcelRange(t.split("!")[1]))&&this.debouncedOnFormatChangeHandler(e)})),t.workbook.worksheets.onRowSorted.add((0,d.g5)((async e=>{if(this.mutexToken)return;const t=await this.getTableNameFromWorksheetIdAndAddress(e.worksheetId,e.address);void 0!==t&&t===this.getActiveTable()?.name&&this.clearTableAndInvalidateNL(t),await this.refreshActiveTable(!0,t)}),0)),t.workbook.tables.onAdded.add((0,d.g5)((async t=>{(0,R.geU)()&&this.isContextLocked()||("Local"===t.source&&(this.fetchAndSetActiveTable(t.tableId),(0,R.avT)()&&C.y.getInstance().addTable(t.tableId)),e&&await(0,J.Vq)(t.tableId))}),0)),t.workbook.tables.onChanged.add((async e=>{this.mutexToken?(0,d.cY)("ContextManager.tables.onChanged refreshActiveTable skipped"):void 0!==e.tableId&&e.tableId===this.getActiveTable()?.id&&this.debouncedTableOnChangeHandler(e)})),t.workbook.tables.onFiltered.add((0,d.g5)((async e=>{await this.onTablesFiltered(e)}),0)),t.workbook.worksheets.onActivated.add((async()=>{this.mutexToken?(0,d.cY)(d.SA.Verbose,"ContextManager.worksheets.onActivated skipped"):(await this.updateSelection(),await this.refreshActiveTable(!1))})),t.workbook.tables.onDeleted.add((async t=>{this.activeTables=this.activeTables.filter((e=>e.name!==t.tableName)),this.dispatch((0,E.o4)(t.tableName)),(0,R.avT)()&&C.y.getInstance().removeTable(t.tableName),e&&(0,J.q9)(t.tableName)})),t.workbook.worksheets.onProtectionChanged.add((async e=>{this.onProtectionChanged(e)})),t.workbook.worksheets.onDeleted.add((async e=>{this.mutexToken||"Local"===e.source||e.worksheetId===this.activeWorksheetId&&await this.updateSelection()})),this.updateHiddenSheetIds(),t.workbook.worksheets.onVisibilityChanged.add((async e=>{this.updateHiddenSheetIds()})),await t.sync(),t.workbook.autoSave||this.dispatch(x.m.setIsWorkbookAutoSaved(t.workbook.autoSave))})),y.E.getInstance().updateTelemetryChatEventData({[h.h3.ChatEventType]:h.a5.ContextManagerInitialized},T.M.getInstance())}catch(e){throw T.M.getInstance().logErrorCode(u.O.ContextManagerInitializationFailed,e),e}finally{T.M.getInstance().logDuration("ContextManagerInitialization",performance.now()-e)}}setActivePythonTableProps(e){this.activePythonTableSheetId=e}setActiveTable(e,t=!1,n){e?(t?this.activeTables.push(e):this.activeTables=[e],(0,g.s_)(g.H0.RemoveGoBackToData)):this.activeTables=[],this.setActivePythonTableProps(n),this.dispatch((0,E.GL)(e))}setActiveChart(e){this.activeChart=e,(0,R.geU)()&&this.dispatch(x.m.setActiveChart(e))}setNearestChart(e){this.nearestChart=e}setAllCharts(e){this.allCharts=e}setActivePivotTable(e){this.activePivotTable=e,(0,R.geU)()&&this.dispatch(x.m.setActivePivotTable(e))}setActiveRange(e){this.activeRange=e,(0,R.geU)()&&this.dispatch(x.m.setActiveRange(e))}async onWorksheetDeactivated(){await Excel.run((async e=>{try{e.workbook.worksheets.getActiveWorksheet(),await e.sync()}catch(e){(0,d.cY)("!==== "+e),this.setSelectionError("INVALID_SELECTION"),this.dispatch(x.m.setIsWorksheet(!1))}return Promise.resolve()}))}setSelectionError(e){(0,R.ZAR)()&&"INVALID_SELECTION"!==e||("PAYLOAD_TOO_LARGE"===e&&e!==this.selectionError&&T.M.getInstance().logStandardizedAshaErrorEvent(c.W.User_Input_Could_Not_Be_Processed,s.c.Input_Failed_Due_To_Memory,h.BJ.AnalyzeData),this.selectionError=e,this.dispatch(x.m.setSelectionError(e)))}clearSelectionError(){this.selectionError=void 0,this.dispatch(x.m.setSelectionError(void 0))}setHasTFCDeliveredQueryResult(){this.hasTFCDeliveredQueryResult=!0}getHasTFCDeliveredQueryResult(){return(0,R.ZAR)()&&this.hasTFCDeliveredQueryResult}async handleBlankContextForPythonAa(e,t){try{e&&(this.isPythonCellSelected=!1,this.selectedPythonSheetId=t,this.selectedPythonAddress=e)}catch(e){return void(0,d.cY)(d.SA.Warning,e)}}loadSelectionDetails(e){const t=e.workbook,n=t.worksheets.getActiveWorksheet(),a=t.getSelectedRanges(),o=t.getActiveCell(),r=a.areas,i=n.getUsedRangeOrNullObject(),l=(0,R.ZAR)()?a.getTables():void 0;return r.load("items/address"),a.load("address"),o.load("address"),n.load("name,id,protection/protected,protection/isPaused"),t.load("autoSave"),l?.load("items/name"),{workbook:t,selectedSheet:n,selectedRanges:a,selectedCell:o,selectedAreas:r,selectedTables:l,usedRange:i}}getSelectedAddress(e){const{selectedRanges:t,selectedCell:n,selectedAreas:a,selectedTables:o,selectedSheet:r}=e;this.activeWorksheetName=r.name,this.activeWorksheetId=r.id,this.activeCell=n.address?(0,j.r)(n.address):void 0,(0,R.ZAR)()&&(this.activeRangeAreas=t.address,this.selectedTableNames=o?.items.map((e=>e.name)));const i=a.items.map((e=>e.address)),l=i.length;return l>0?i[l-1]:void 0}async updateSelection(){if(this.isUpdatingSelection)this.pendingSelection=!0;else{this.isUpdatingSelection=!0;try{await Excel.run({delayForCellEdit:!0},(async e=>{const t=this.loadSelectionDetails(e),{selectedSheet:n,workbook:a,usedRange:o}=t;await e.sync();const r=a.autoSave;if(this.dispatch(x.m.setIsWorkbookAutoSaved(r)),!r)return;const i=n.name,l=n.id,s=o.isNullObject,c=this.getSelectedAddress(t),d=n.protection.protected&&!n.protection.isPaused;if(this.dispatch(x.m.setIsWorksheetProtected(d)),this.dispatch(x.m.setIsWorksheet(!0)),await this.registerChartActivationHandlers(n,l,e),(0,R.geU)()&&await this.updateActiveRange(e,c,l),!(0,R.ZAR)()&&s)return"BLANK_WORKSHEET"!==this.selectionError&&T.M.getInstance().logEvent((0,h.SV)(h.he.SuggestionShown,h.q.SampleData)),this.setActiveTable(void 0),this.setSelectionError("BLANK_WORKSHEET"),void this.handleBlankContextForPythonAa(c,l);try{await this.setContextWithAddressValidation(l,i,c)}catch(e){this.setActiveTable(void 0),this.isInvalidSelection(e)?this.setSelectionError("INVALID_SELECTION"):(this.setSelectionError("UNKNOWN_ERROR"),T.M.getInstance().logErrorCode(u.O.SetContextWithAddressValidationFailed,e))}}))}catch(e){if(this.isInvalidSelection(e))return this.setSelectionError("INVALID_SELECTION"),void this.setActiveTable(void 0);let t=u.O.UpdateSelectionFailed;e instanceof OfficeExtension.Error&&"PropertyNotLoaded"===e.code&&!this.pendingSelection&&(this.pendingSelection=!0,t=u.O.UpdateSelectionFailedWillRetry),T.M.getInstance().logErrorCode(t,e)}finally{this.isUpdatingSelection=!1,this.pendingSelection&&(this.pendingSelection=!1,await this.updateSelection())}}}isInvalidSelection(e){return e instanceof OfficeExtension.Error&&"InvalidSelection"===e.code}async updateHiddenSheetIds(){(0,R.ZAR)()&&await Excel.run({delayForCellEdit:!0},(async e=>{const t=e.workbook.worksheets;t.load("items/id, items/visibility"),await e.sync(),this.hiddenSheetIds=t.items.filter((e=>e.visibility!==Excel.SheetVisibility.visible)).map((e=>e.id))}))}async registerChartActivationHandlers(e,t,n){if(this.worksheetsWithChartsOnActivated.includes(t))return;const a=(0,R.geU)()||(0,R.tgf)(),o=async()=>{this.setActiveChart(void 0)};a&&e.charts.onDeactivated.add(o),e.charts.onActivated.add((async e=>{a?await this.updateActiveChart(e):this.setChartSelectedError()})),await n.sync(),this.worksheetsWithChartsOnActivated.push(t)}setChartSelectedError(){this.setActiveTable(void 0),this.setSelectionError("CHART_SELECTED")}makeChartContext(e,t){return{name:e.name,title:e.title.text,chartType:e.chartType,series:(e.series??[]).map((e=>e.name)),dataSource:e["data range"],jsonDOM:t}}async updateActiveChart(e){try{await Excel.run({delayForCellEdit:!0},(async t=>{const n=(0,R.bx9)(),a=t.workbook.worksheets.getItemOrNullObject(e.worksheetId).charts.getItemOrNullObject(e.chartId);if(n){if(await t.sync(),a.isNullObject)throw new Error("Chart is null object");const e=a.getContextDOM();await t.sync();const n=JSON.parse(e.value);this.setActiveChart(this.makeChartContext(n,e.value))}else{const e="series/items/name,chartType,title/text,isNullObject";if(a.load(e),await t.sync(),a.isNullObject)throw new Error("Chart is null object");this.setActiveChart({title:a.title.text,series:a.series.items.map((e=>e.name)),chartType:"string"==typeof a.chartType?a.chartType:Excel.ChartType[a.chartType]})}this.setActiveRange(void 0),this.setChartSelectedError()}))}catch(e){T.M.getInstance().logErrorCode(u.O.SetActiveChartFailed,e),this.setActiveChart(void 0)}}async onTablesFiltered(e){await Excel.run({delayForCellEdit:!0},(async t=>{const n=t.workbook.tables.getItem(e.tableId);n.load("name"),await t.sync(),await this.refreshActiveTable(!0,n.name)}))}async onProtectionChanged(e){e.worksheetId===this.activeWorksheetId&&(e.isProtected?await Excel.run({delayForCellEdit:!0},(async t=>{const n=t.workbook.worksheets.getItem(e.worksheetId).load(["protection/protected","protection/isPaused"]);await t.sync(),this.dispatch(x.m.setIsWorksheetProtected(n.protection.protected&&!n.protection.isPaused))})):this.dispatch(x.m.setIsWorksheetProtected(e.isProtected)))}async fetchAndSetActiveTableLikeEntity(e){const t=this.dispatch((0,E.m)(e));try{if(t)await this.fetchAndSetTabularRangeAsActiveTable(t);else{if(e.includes("!"))throw new Error(u.O.TLRNotFound);await this.fetchAndSetActiveTable(e)}}catch(e){T.M.getInstance().logErrorCode(u.O.FetchAndSetActiveTableLikeEntityFailed,e)}}async fetchAndSetActiveTable(e,t=!1,n){if(this.tooLargeTableIds.includes(e))return;const a=performance.now();try{const a=await F(e,n);a?(this.setActiveTable(a,t),this.dispatch((0,E.Wc)({type:le.lp.StandardTable,table:a}))):this.setActiveTable(void 0)}catch(t){T.M.getInstance().logErrorCode(u.O.FetchAndSetActiveTableFailed,t),this.setActiveTable(void 0),z(t)?(this.pendingSelectionError="PAYLOAD_TOO_LARGE",this.tooLargeTableIds.push(e)):this.setSelectionError("UNKNOWN_ERROR")}finally{T.M.getInstance().logDuration("FetchAndSetActiveTable",performance.now()-a)}}async fetchAndSetActiveTableArray(e){try{let t=[];if(this.selectedTableNames)for(const e of this.selectedTableNames)await this.fetchAndSetActiveTable(e,!0);if(this.activeRangeAreas){t=this.activeRangeAreas.split(",").map((t=>this.dispatch((0,E.oR)(e,t)))).flat();for(const e of t)await this.fetchAndSetTabularRangeAsActiveTable(e,!0)}(0,R.yw9)("OfficeVSO_10278048_MinimizeUnnecessaryRerenders")&&(this.selectedTableNames?.length||t?.length||this.setActiveTable(void 0))}catch(e){(0,R.yw9)("OfficeVSO_10278048_MinimizeUnnecessaryRerenders")&&this.setActiveTable(void 0),(0,d.cY)(e)}}async getTableNamesUndefinedForDeletedTables(e){return await Excel.run({delayForCellEdit:!0},(async t=>{const n=e.map((e=>{const n=t.workbook.tables.getItemOrNullObject(e);return n.load("name"),n}));await t.sync();return n.map((e=>{if(!e.isNullObject)return e.name;(0,d.cY)("Table not found in getTableNamesUndefinedForDeletedTables - likely recently deleted")}))}))}async clearTableAndInvalidateNLResultFromId(e){if(this.pendingTableClear.add(e),this.isTableClearing)return;this.isTableClearing=!0;const t=Array.from(this.pendingTableClear);this.isTableClearing=!1,this.pendingTableClear.clear();(await this.getTableNamesUndefinedForDeletedTables(t)).filter((e=>void 0!==e)).forEach((e=>this.clearTableAndInvalidateNL(e)))}clearTableAndInvalidateNL(e){this.dispatch(x.m.clearTable(e)),this.dispatch((0,A.YS)())}async getClosestTableInfo(e,t){if(!t)return;const n=await Excel.run({delayForCellEdit:!0},(async t=>await l().getTablesNameToRangeMapOnSheet(t,e)));let o,r;const i=this.getRangeAddressesFromAddress(t);for(const t of i){if(Object.keys(n).length>0){const e=Object.keys(n);for(const r of e){const e=n[r],i=a.ExcelCalc.addressToExcelRange(t);if(a.ExcelCalc.IExcelRangeContainedIn(i,e.range))return{name:r,distance:0,isContained:!0};if(a.ExcelCalc.IExcelRangeIntersect(i,e.range))return{name:r,distance:0};{const t=(0,S._)(i,e.range);(!o||t<o.distance)&&(o={name:r,distance:t})}}}const i=this.dispatch((0,E.Vy)(e,t));(!r||i&&i.distance<r.distance)&&(r=i)}return 0===o?.distance?o:o?.distance&&0!==r?.distance?(r?.distance&&r.distance<o.distance&&(o=r),o):r}async getNearestChartContext(e,t){return t&&(0,R.bx9)()?await Excel.run((async n=>{let o=null;const r=n.workbook.worksheets.getItemOrNullObject(e);if(await n.sync(),r.isNullObject)return o;if(r.load("charts"),await n.sync(),0===r.charts.items.length)return o;if(!r.charts.items[0].getContextDOM){const e=r.charts.items[0];e.load(this.chartLoadOptions);const t=e.getDataRange();return await n.sync(),o={name:e.name,title:e.title.text,chartType:e.chartType,series:e.series.items.map((e=>e.name)),dataSource:t.value,jsonDOM:void 0},o}const i=r.charts.items.map((e=>({jsonDOM:e.getContextDOM()})));await n.sync();let l,s=Number.MAX_VALUE;return l=-1===t.indexOf("!")?a.ExcelCalc.addressToExcelRange(t):a.ExcelCalc.sheetAddressToExcelSheetRange(t).range,i.forEach((e=>{const t=JSON.parse(e.jsonDOM.value);let n;n=t["location range"]?{topLeft:{row:t["location range"].top,column:t["location range"].left},bottomRight:{row:t["location range"].bottom,column:t["location range"].right}}:a.ExcelCalc.addressToExcelRange(t["data range"]);const r=(0,S._)(n,l);r<s&&(s=r,o=this.makeChartContext(t,e.jsonDOM.value))})),o})):null}async getAllCharts(e){return await Excel.run((async t=>{let n=[];if(!(0,R.bx9)())return n;const a=t.workbook.worksheets.getItemOrNullObject(e).load("isNullObject");if(await t.sync(),a.isNullObject)return n;if(a.load("charts"),await t.sync(),0===a.charts.items.length)return n;if(!a.charts.items[0].getContextDOM){a.charts.load(this.chartLoadOptions),await t.sync();const e=a.charts.items.map((e=>({chart:e,dataSource:e.getDataRange()})));return await t.sync(),n=e.map((e=>({name:e.chart.name,title:e.chart.title.text,chartType:e.chart.chartType,series:e.chart.series.items.map((e=>e.name)),dataSource:e.dataSource.value,jsonDOM:void 0}))),n}const o=a.charts.items.map((e=>({jsonDOM:e.getContextDOM()})));return await t.sync(),n=o.filter((e=>e.jsonDOM)).map((e=>{const t=JSON.parse(e.jsonDOM.value);return this.makeChartContext(t,e.jsonDOM.value)})),n}))}async doesRangeContainPivotTable(e,t){try{return await Excel.run({delayForCellEdit:!0},(async n=>{const a=this.getRangeAddressesFromAddress(t)[0],o=n.workbook.worksheets.getItem(e).getRange(a).getPivotTables().getCount();return await n.sync(),o.value>0}))}catch(e){return T.M.getInstance().logErrorCode(u.O.FetchPivotTableFailed,e),!1}}async setContext(e,t){this.isPythonCellSelected=await this.pythonContextManager.isPythonCell(e,t),this.selectedPythonSheetId=e,this.selectedPythonAddress=t;let n=!1;if((0,R.geU)()){if(this.activeChart)this.setNearestChart(this.activeChart);else{const n=await this.getNearestChartContext(e,t);this.setNearestChart(n??void 0)}const n=await this.getAllCharts(e);this.setAllCharts(n)}if((0,R.ZAR)()&&this.activeRangeAreas){if((0,R.yw9)("OfficeVSO_10278048_MinimizeUnnecessaryRerenders")?this.activeTables=[]:this.setActiveTable(void 0),await this.fetchAndSetActiveTableArray(e),this.activeTables.length)return}else{this.setActivePivotTable(void 0);const a=await this.getClosestTableInfo(e,t);if(a){if(a?.tabularRange?await this.fetchAndSetTabularRangeAsActiveTable(a.tabularRange,void 0,a):await this.fetchAndSetActiveTable(a.name,void 0,a),!(0,R.tgf)())return;n=!!a}}let a,o=!1;if((0,R.tgf)()?a=await this.fetchActivePivotTable(e,t):o=await this.doesRangeContainPivotTable(e,t),o||a)return((0,R.geU)()||(0,R.tgf)())&&(a&&this.setActivePivotTable(a),n||this.setActiveTable(void 0)),void this.setSelectionError("PIVOT_TABLE_SELECTED");if((0,R.tgf)()){if(n)return void(this.pendingSelectionError?(this.setSelectionError(this.pendingSelectionError),this.pendingSelectionError=void 0):this.clearSelectionError());if(await this.fetchAndSetUnrecognizedRange(e))return}this.setNoTableSelectedError()}getPivotTableAttributes(e){return{name:e.name,hierarchies:e.hierarchies.items.map((e=>e.name)),columnHierarchies:e.columnHierarchies.items.map((e=>e.name)),dataHierarchies:e.dataHierarchies.items.map((e=>e.name)),filterHierarchies:e.filterHierarchies.items.map((e=>e.name)),rowHierarchies:e.rowHierarchies.items.map((e=>e.name))}}async fetchActivePivotTable(e,t){let n=u.O.FetchPivotTableFailedToLoadRange;const a=performance.now();try{return await Excel.run({delayForCellEdit:!0},(async a=>{const o=a.workbook.worksheets.getItem(e).getRanges(t).areas;o.load("items/isNullObject"),await a.sync();n=u.O.FetchActivePivotTableFailed;const r=o.items.map((e=>{const t=e.getPivotTables().getFirstOrNullObject();return t.load("name,columnHierarchies/items/name,dataHierarchies/items/name,filterHierarchies/items/name,hierarchies/items/name,rowHierarchies/items/name"),t}));await a.sync();const i=r.find((e=>!e.isNullObject));if(i)return this.getPivotTableAttributes(i)}))}catch(e){return T.M.getInstance().logErrorCode(n,e),void(e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.invalidArgument&&(0,d.cY)(d.SA.Error,n,e.code,e.debugInfo.errorLocation,t,this.activeWorksheetName))}finally{T.M.getInstance().logDuration("FetchActivePivotTable",performance.now()-a)}}async setContextWithAddressValidation(e,t,n){this.activeWorksheetId=e,this.activeWorksheetName=t,this.activeRangeAddress=n,n?await this.setContext(e,n):(this.setActiveTable(void 0),this.setSelectionError("NOTHING_SELECTED"))}async fetchAndSetTabularRangeAsActiveTable(e,t=!1,n){const a=performance.now();try{const a=await _(e,n);if((0,R.yw9)("OfficeVSO_10278048_MinimizeUnnecessaryRerenders")){const n=e.interpretation.location.worksheetId;this.setActiveTable(a,t,n),this.selectionError=void 0,this.dispatch((0,E.Wc)({type:le.lp.TableLikeRange,table:a})),(0,R.tgf)()||this.clearSelectionError()}else if(a){const n=e.interpretation.location.worksheetId;this.setActiveTable(a,t,n),this.selectionError=void 0,this.dispatch((0,E.Wc)({type:le.lp.TableLikeRange,table:a})),(0,R.tgf)()||this.clearSelectionError()}}catch(e){if((0,R.yw9)("OfficeVSO_10278048_MinimizeUnnecessaryRerenders")&&this.setActiveTable(void 0),T.M.getInstance().logErrorCode(u.O.FetchAndSetTabularRangeAsActiveTableFailed,e),z(e))return void(this.pendingSelectionError="PAYLOAD_TOO_LARGE")}finally{T.M.getInstance().logDuration("FetchAndSetTabularRangeAsActiveTable",performance.now()-a)}}async fetchAndSetUnrecognizedRange(e){const t=performance.now(),n=e=>e instanceof OfficeExtension.Error&&(e.code===Excel.ErrorCodes.itemNotFound||e.code===Excel.ErrorCodes.invalidSelection);try{return await Excel.run({delayForCellEdit:!0},(async t=>{const r=t.workbook.getActiveCell(),i=r.getSurroundingRegion(),l=i.getPivotTables().getCount(),s=["numberFormat","numberFormatCategories","text"];s.push("numberFormatLocal"),r.load("valuesAsJson, isNullObject"),i.load(["address","rowCount","columnCount","cellCount"]);const c=i.getRow(0).load(s),u=i.getLastRow().load(["text"]);let m,g,h,p,b,C,y,v;(0,R.ZAR)()&&(y=i.getTables().getCount(),v=()=>{const t=this.dispatch((0,E.Vy)(e,i.address));return!!t&&0===t.distance});try{if(await t.sync(),i.cellCount<4||l.value>0||y&&y.value>0||v?.())return;m=i.rowCount,g=i.columnCount,h=c.text,C=u.text,p=q(c),b=c.numberFormatCategories}catch(e){if(n(e))return;throw(0,d.cY)(d.SA.Error,e),e}const T=W(h),x=W(C),S=W(p);let w=()=>Array.from({length:g},((e,t)=>t));const I=t.workbook.getActiveCell().getSurroundingRegion(),A=Array.from({length:g},((e,t)=>t)).map(((e,t)=>{const n=I.getCell(0,t);return n.load("hidden"),{index:t,cell:n}}));w=()=>A.filter((({cell:e})=>!e.hidden)).map((({index:e})=>e));const L=W(b),k=a.ExcelCalc.sheetAddressToExcelSheetRange(i.address);await t.sync();const F=w(),_={name:i.address,address:i.address,headers:f.r$C,numRows:m,numColumns:g,firstRowValues:T,lastRowValues:x,numberFormats:S,numberFormatCategories:L,visibleColumns:F,sheetRange:k,totalRow:!1,tableLikeRange:!0,tableContained:!0,tableIntersected:!0,tableLikeRangeFeatures:o.ye.Unrecognized};return this.setActiveTable(_,void 0,e),this.dispatch((0,E.Wc)({type:le.lp.Range,table:_})),this.clearSelectionError(),i.address}))}catch(e){if(n(e))return;return T.M.getInstance().logErrorCode(u.O.FetchAndSetUnrecognizedRangeFailed,e),z(e)?void(this.pendingSelectionError="PAYLOAD_TOO_LARGE"):void 0}finally{T.M.getInstance().logDuration("FetchAndSetUnrecognizedRange",performance.now()-t)}}async isWorksheetChangeWithinTable(e,t){try{return await Excel.run({delayForCellEdit:!0},(async n=>{if(e.worksheetId!==this.activeWorksheetId||t.sheetRange.sheet!==this.activeWorksheetName||e.changeType===Excel.DataChangeType.unknown||!e.address)return!1;const a=(0,j.r)(t.address),o=n.workbook.worksheets.getItemOrNullObject(t.sheetRange.sheet),r=n.workbook.worksheets.getItemOrNullObject(e.worksheetId).getRanges(e.address),i=o.getRanges(a),l=r.getIntersectionOrNullObject(i);return await n.sync(),!l.isNullObject}))}catch(e){return T.M.getInstance().logErrorCode(u.O.CheckIntersectingRemoteChangesFailed,e,void 0,void 0,(0,h.RE)(Le)),!1}}async updateActiveRange(e,t,n){try{const a=e.workbook,o=a.getActiveChartOrNullObject();if(await e.sync(),!o.isNullObject)return;const r=n?a.worksheets.getItem(n):a.worksheets.getActiveWorksheet(),i=t?r.getRange(t):a.getSelectedRange();i.load(["rowCount","columnCount","rowIndex","columnIndex","address"]);const l=2,s=10,c=["text","rowIndex","columnIndex"],d=["areas/items/rowCount","areas/items/columnCount","areas/items/rowIndex","areas/items/columnIndex"],u=i.getIntersection(i.getAbsoluteResizedRange(s,s)),m=i.getMergedAreasOrNullObject();await e.sync();const{columnCount:g,columnIndex:h,rowCount:p,rowIndex:b}=i;if(g*p>1){u.load(c),m.load(d);const t={topLeft:{range:u,mergedAreas:m}},n=b+p,a=h+g;if(p>s){const e=r.getRangeByIndexes(n-l,h,l,Math.min(s,g)).load(c),a=e.getMergedAreasOrNullObject().load(d);t.lastRows={range:e,mergedAreas:a}}if(g>s){const e=r.getRangeByIndexes(b,a-l,Math.min(s,p),l).load(c),n=e.getMergedAreasOrNullObject().load(d);t.lastCols={range:e,mergedAreas:n}}if(g>s&&p>s){const e=r.getRangeByIndexes(n-l,a-l,l,l).load(c),o=e.getMergedAreasOrNullObject().load(d);t.bottomRight={range:e,mergedAreas:o}}await e.sync();for(const e of Object.values(t)){const{range:t,mergedAreas:n}=e,a=e.values=t.text;if(!n.isNullObject)for(const e of n.areas.items){const n=e.rowIndex-t.rowIndex,o=e.columnIndex-t.columnIndex;if(n>=a.length||o>=a[o].length)continue;const r=a[n][o];for(let t=n;t<n+e.rowCount&&t<a.length;t++)for(let n=o;n<o+e.columnCount&&n<a[t].length;n++)a[t][n]=r}}this.setActiveRange({address:i.address,numRows:i.rowCount,numCols:i.columnCount,topLeftValues:t.topLeft.values,lastRowsValues:t.lastRows?.values,lastColsValues:t.lastCols?.values,bottomRightValues:t.bottomRight?.values})}else this.setActiveRange(void 0)}catch(e){(0,d.cY)(e),this.setActiveRange(void 0)}}setNoTableSelectedError(){this.setActiveTable(void 0),this.setActivePivotTable(void 0),this.setSelectionError("NO_TABLE_SELECTED")}async getTableNameFromWorksheetIdAndAddress(e,t){const n=await this.getClosestTableInfo(e,t);return n?.name}async doSelectionIntegrityCheck(){const e=performance.now();let t=u.O.SelectionIntegrityCheckFlushingSelectionFailed;try{return await Excel.run({delayForCellEdit:!0},(async e=>{this.isUpdatingSelection=!1,this.pendingSelection&&((0,d.cY)("Flushing pending selection update in doSelectionIntegrityCheck"),this.pendingSelection=!1,await this.updateSelection()),t=(0,R.ZAR)()?void 0:u.O.SelectionIntegrityCheckEncounteredNonWorksheet;const n=e.workbook.worksheets.getActiveWorksheet();n.load("id"),await e.sync(),t=(0,R.ZAR)()?void 0:u.O.SelectionIntegrityCheckEncounteredNoGridSelection;const a=e.workbook.getSelectedRanges();a.load("address,areas/isNullObject,worksheet/id");const o=a.areas.getItemAt(0);o.load("address,worksheet/id,worksheet/name");const r=e.workbook.getActiveCell();r.load("address,worksheet/id");const i=(0,R.ZAR)()?a.getTables().load("name"):void 0;if(await e.sync(),t=u.O.SelectionIntegrityCheckFailed,o.worksheet.id===n.id&&r.worksheet.id===n.id&&o.worksheet.id===r.worksheet.id||T.M.getInstance().logError({eventType:v.S2.ContextManager,errorMessage:"OfficeJS reported inconsistent worksheet ID between active worksheet, selected range, and active cell",logLevel:X.$b.Warning}),(0,R.ZAR)()){const e=this.selectedTableNames?.sort().join(","),n=i.items.map((e=>e.name)).sort().join(",");if(n!==e){const a=!e&&n?u.O.SelectionIntegrityCheckFoundNoTableButOneShouldBePresent:u.O.SelectionIntegrityCheckFoundTableMismatch;T.M.getInstance().logErrorCode(t,new Error(a)),await this.setContextWithAddressValidation(o.worksheet.id,o.worksheet.name,o.address)}}else{const e=await this.getClosestTableInfo(o.worksheet.id,o.address),n=this.getActiveTable();if(e?.name!==n?.name&&"PAYLOAD_TOO_LARGE"!==this.selectionError){const a=!n&&e?u.O.SelectionIntegrityCheckFoundNoTableButOneShouldBePresent:u.O.SelectionIntegrityCheckFoundTableMismatch;T.M.getInstance().logErrorCode(t,new Error(a)),await this.setContextWithAddressValidation(o.worksheet.id,o.worksheet.name,o.address)}}}))}catch(e){if(void 0===t)return;if(e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.invalidSelection)return;T.M.getInstance().logErrorCode(t,e)}finally{T.M.getInstance().logDuration("DoSelectionIntegrityCheck",performance.now()-e)}}constructor(e){this.selectionError=void 0,this.pendingSelectionError=void 0,this.tooLargeTableIds=[],this.activeWorksheetName=void 0,this.activeWorksheetId=void 0,this.activeRangeAddress=void 0,this.activeTables=[],this.activeRangeAreas=void 0,this.selectedTableNames=void 0,this.activeCell=void 0,this.hiddenSheetIds=[],this.activeRange=void 0,this.activeChart=void 0,this.nearestChart=void 0,this.allCharts=void 0,this.activePivotTable=void 0,this.activeUxRail=void 0,this.humanInTheLoopRange=void 0,this.worksheetsWithChartsOnActivated=[],this.pendingSelection=!1,this.isUpdatingSelection=!1,this.isTableClearing=!1,this.pendingTableClear=new Set,this.sheetGoBackButtonPointTo=void 0,this.hasTFCDeliveredQueryResult=!1,this.isPythonCellSelected=!1,this.selectedPythonSheetId=void 0,this.selectedPythonAddress=void 0,this.pythonAdaStaticPromptOverride=void 0,this.activePythonTableSheetId=void 0,this.calculatedFormulaInsertLocation=void 0,this.queryIdShouldNotShowFluxResponse=void 0,this.initMemo=new p.d((async()=>{await this.init()})),this.refreshSelectionContext=(0,r.debounce)((async()=>{if(!this.mutexToken)return await this.updateSelection()}),0),this.refreshActiveTable=(0,d.g5)((async(e,t)=>{const n=this.getActiveTable();if((!e||t===n?.name)&&n)try{await this.dispatch((0,E.v)(n))}catch(e){const t=v.S2.AnalyzeDataError;T.M.getInstance().logErrorCode(u.O.RefreshActiveTableFailed,e,t,void 0,(0,h.RE)(Le))}}),500),this.chartLoadOptions={name:!0,chartType:!0,title:{text:!0},series:{name:!0}},this.debouncedOnFormatChangeHandler=(0,d.g5)((async e=>{if(this.getActiveTable()?.name){const t=await this.getTableNameFromWorksheetIdAndAddress(e.worksheetId,e.address);void 0!==t&&t===this.getActiveTable()?.name&&this.clearTableAndInvalidateNL(t)}if("Local"===e.source)await this.updateSelection();else if(this.getActiveTable())if((0,R.geU)())await this.updateSelection();else{await this.getTableNameFromWorksheetIdAndAddress(e.worksheetId,e.address)===this.getActiveTable()?.name&&await this.updateSelection()}}),f.gtW),this.debouncedTableOnChangeHandler=(0,d.g5)((async e=>{await this.fetchAndSetActiveTable(e.tableId);(e.changeType!==Excel.DataChangeType.rangeEdited||void 0===e.details||e.details.valueBefore!==e.details.valueAfter)&&await this.refreshActiveTable(!1),await this.clearTableAndInvalidateNLResultFromId(e.tableId)}),f.gtW),this.mutex=new b.e,this.pythonContextManager=new Ee(e),(0,R.vom)()&&(this.pythonCalculatedColumnContextManager=new Z)}}function Ae(e){return!e.tableLikeRange}const Le=new Re(new Excel.RequestContext)},110686:(e,t,n)=>{"use strict";n.d(t,{OA:()=>v,Z:()=>y,f1:()=>f,gf:()=>C});var a=n(86940),o=n(874003),r=n(178365),i=n(713441),l=n(75496),s=n(656931),c=n(749832),d=n(857677),u=n(279395),m=n(316904),g=n(805020),h=n(664007),p=n(312422),b=n(882329);const f=()=>async(e,t)=>{(0,p.TA)({ignoreIfNotOpened:!0}),t().app.doesFluxTurnRequireUndo&&((0,p.tN)(),e(g.m.resetDoesFluxTurnRequireUndo()),s.Z.getInstance().setShowUndoButton(!1))},C=(e=()=>()=>{})=>async(t,n)=>{const i=performance.now();try{if("NotStarted"===n().app.tokenState)try{await(0,b.Nd)(),t(g.m.loadAuth())}catch{return void t(g.m.fetchTokenFailed())}if("Loaded"!==n().app.tokenState&&"Cached"!==n().app.tokenState)return;try{let i;if(Office.context.platform===Office.PlatformType.OfficeOnline&&(i=await(0,b.EH)(),i))return t(g.m.fetchTokenSuccess()),m.M.getInstance().logEvent({eventType:l.S2.AuthSuccess,eventData:[{key:l.Wg.FetchType,value:"OAuthManager"}]}),i;if(i=await(0,b.js)(),i)return t(g.m.fetchTokenSuccess()),m.M.getInstance().logEvent({eventType:l.S2.AuthSuccess,eventData:[{key:l.Wg.FetchType,value:"Silent"}]}),i;const s=e(),{executingCommand:c,executingId:p}=n().chat;let f;const C=new Promise((e=>{f=e})),y=u.olU.ShowPopupMessage,[v,T]=y.split("{0}");return r.$.getInstance().displayResponse({chatCardType:a._.WarningMessage,chatMessageData:{warningMessageCardProps:{user:"chat",warningPrefix:v,warningEmphasizedText:u.olU.ShowPopupButton,warningSuffix:T}},chatMessageBodyData:{actionButtonList:[{type:o.jA.Default,text:u.olU.ShowPopupButton,title:u.olU.ShowPopupButton,handleButtonOnClick:()=>{t(h.m.startExecutingCommand({command:c??d.OP.AnalyzeData,id:p})),f((0,b.IN)())}}]}},{featureName:d.q.AnalyzeData,eventType:d.a5.PromptAuthPopup}),i=await C,i?(s(),t(g.m.fetchTokenSuccess()),m.M.getInstance().logEvent({eventType:l.S2.AuthSuccess,eventData:[{key:l.Wg.FetchType,value:"Popup"}]}),i):void 0}catch{return void t(g.m.fetchTokenFailed())}}finally{m.M.getInstance().logDuration("GetToken",performance.now()-i)}},y=()=>(e,t)=>t().app.localeInfo,v=e=>c.V.IsSettingTrue(c.z.ButtonEnabledForLocalFiles)?e.app.copilotState:i.$.Enabled},116510:(e,t,n)=>{"use strict";var a,o;n.d(t,{T:()=>a,q:()=>o}),function(e){e[e.None=0]="None",e[e.IRMTemplate=1]="IRMTemplate",e[e.IRMUserDefinedPermission=2]="IRMUserDefinedPermission",e[e.IRMEncryptOnly=3]="IRMEncryptOnly",e[e.IRMDoNotForward=4]="IRMDoNotForward"}(a||(a={})),function(e){e[e.S_APPLYLABEL_OK=0]="S_APPLYLABEL_OK",e[e.E_APPLYLABEL_FAIL=2147467259]="E_APPLYLABEL_FAIL",e[e.E_APPLYLABEL_UNSUPPORTED_CROSSTENANT=2147205120]="E_APPLYLABEL_UNSUPPORTED_CROSSTENANT",e[e.E_APPLYLABEL_DOCUMENT_READONLY=2147205119]="E_APPLYLABEL_DOCUMENT_READONLY",e[e.E_APPLYLABEL_INSUFFICIENTPERMISSION=2147205118]="E_APPLYLABEL_INSUFFICIENTPERMISSION",e[e.E_APPLYLABEL_LABELDISABLED=2147205117]="E_APPLYLABEL_LABELDISABLED",e[e.E_APPLYLABEL_UNSUPPORTED_UDP=2147205116]="E_APPLYLABEL_UNSUPPORTED_UDP",e[e.E_APPLYLABEL_LABELING_DISABLED=2147205115]="E_APPLYLABEL_LABELING_DISABLED",e[e.E_APPLYLABEL_UNSUPPORTED_CONTENTTYPE=2147205114]="E_APPLYLABEL_UNSUPPORTED_CONTENTTYPE",e[e.E_APPLYLABEL_UNSUPPORTED_DKE=2147205113]="E_APPLYLABEL_UNSUPPORTED_DKE",e[e.E_APPLYLABEL_LABELNOTFOUND=2147205112]="E_APPLYLABEL_LABELNOTFOUND",e[e.E_APPLYLABEL_USERNOTFOUND=2147220727]="E_APPLYLABEL_USERNOTFOUND",e[e.E_APPLYLABEL_NEWLABELSENSITIVITYORDER=2147205105]="E_APPLYLABEL_NEWLABELSENSITIVITYORDER"}(o||(o={}))},119893:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.RuntimeState=void 0,function(e){e.Loading="Loading",e.Ready="Ready",e.Executing="Executing",e.Done="Done",e.Error="Error"}(n||(t.RuntimeState=n={}))},123551:(e,t,n)=>{"use strict";async function a(){return await Promise.all([n.e("vendors-npm_store_sdx_officecopilot_typescript_5_0_4-007004e2f84938dc12ca_node_modules_typesc-351a83"),n.e("vendors-npm_store_sdx_officecopilot_office-script-synchronous_0_0_97-8bbd4c10a11390e6ba99_nod-a80310"),n.e("oss")]).then(n.t.bind(n,992715,23))}async function o(){return(await a()).code}n.d(t,{J:()=>a,Q:()=>o})},123963:(e,t,n)=>{"use strict";n.d(t,{H5:()=>l,IC:()=>i,iK:()=>r,rK:()=>s});var a=n(672270),o=n(208520);function r(e){const t=o.useRef(e);t.current=e,o.useEffect((()=>()=>t.current()),[])}function i(e,t){const n=o.useRef(!1),a=o.useRef(t);a.current=t,o.useEffect((()=>{!n.current&&e&&(n.current=!0,a.current())}),[e])}function l(e){i(!0,e)}function s(e,t,n,r){const i=(0,o.useRef)(performance.now()),[l,s]=(0,o.useState)((()=>t?"loaded":"loading")),c=function(e,t){const n=(0,o.useRef)(e);n.current=e;const a=(0,o.useRef)();return(0,o.useEffect)((()=>{const e=setTimeout((()=>{n.current?.()}),t);return a.current=()=>{clearTimeout(e),a.current=void 0},()=>a.current?.()}),[]),()=>a.current?.()}((()=>{(0,a.cY)(`useLoadingTimeout(${e}): timed out after ${n/1e3}s`),s("timeout"),r?.onTimeout?.()}),n);return(0,o.useEffect)((()=>{const n=performance.now()-i.current,o=`useLoadingTimeout(${e}, t=${(n/1e3).toFixed(2)}s)`;if(t)switch(l){case"loaded":r?.onLoaded?.(Math.round(n),!1),(0,a.cY)(`${o}: already loaded`),c();break;case"loading":(0,a.cY)(`${o}: loaded`),c(),s("loaded");break;case"timeout":(0,a.cY)(`${o}: loaded after timeout`),r?.onLoaded?.(Math.round(n),!0)}}),[t,l]),l}},124445:(e,t,n)=>{"use strict";n.d(t,{Be:()=>x,I1:()=>y,K4:()=>v,Xs:()=>a,f6:()=>f,ge:()=>C});var a,o,r=n(616166),i=n(993256),l=n(279395),s=n(12855),c=n(316904),d=n(857677),u=n(109174),m=n(342935),g=n(972424),h=n(158058),p=n(347145),b=n(312422);async function f(e){if(!(0,p.qTy)()||!e)return!1;if(0===(e&(s.ye.DuplicateHeaders|s.ye.HasMergedCells|s.ye.EmptyHeaders)))return!1;const t=s.ye.RowMajor|s.ye.TotalsRow|s.ye.DuplicateHeaders,n=t|s.ye.HasMergedCells|s.ye.EmptyHeaders;return 0===(e&~t)||!(!Office.context.requirements.isSetSupported("excelapiundo","1.31")||0!==(e&~n))&&(!(e&s.ye.EmptyHeaders)||await async function(){try{return await Excel.run((async e=>{const t=u.CP.getActiveTable();if(!t)throw new Error("NoActiveTable");const n=e.workbook.worksheets.getItemOrNullObject(t.sheetRange.sheet),a=n.getRange((0,g.r)(t.address)),o=I(t),r=E(a,o);if(r.load("valueTypes, isNullObject"),await e.sync(),r.isNullObject||n.isNullObject)throw new Error("NoHeaderRange");const i=r.valueTypes,l="rowMajor"===o,s=i.flatMap(((e,t)=>e.map(((e,n)=>e===Excel.RangeValueType.empty?l?t:n:void 0)))).filter((e=>void 0!==e));if(0===s.length)return!1;const c=s.map((e=>{const t=l?a.getRow(e):a.getColumn(e);return t.load("isNullObject, valueTypes"),t}));await e.sync();return 0===c.filter((e=>!e.isNullObject&&e.valueTypes.every((e=>e.every((e=>e===Excel.RangeValueType.empty)))))).length}))}catch(e){return c.M.getInstance().logErrorCode(r.O.TLRValidateEmptyHeadersFailed,e),!1}}())}async function C(){try{return await Excel.run((async e=>{const t=u.CP.getActiveTable();if(!t)throw new Error("NoActiveTable");const n=S(e,t).tableRange.getMergedAreasOrNullObject();return n.load("areas/items/addressLocal"),await e.sync(),n.isNullObject?[]:n.areas.items.map((e=>e.addressLocal))}))}catch(e){return c.M.getInstance().logErrorCode(r.O.TLRRetrieveMergeCellsFailed,e),[]}}async function y(){return R("EmptyHeaders")}async function v(){return R("DuplicateHeaders")}async function T(e){let t=1;try{const{context:n,tableRange:a,orientation:o}=e,r=E(a,o),i="rowMajor"===o;let l;if(r.load("values"),await n.sync(),l=i?r.values.flat():r.values[0],w(l)){const e=function(e,t){const n=new Map;let a=2;return e.map((e=>{const o=n.get(e)||0;if(n.set(e,o+1),0===o)return e;let r=`${e}${a}`;for(;t.has(r);)a++,r=`${e}${a}`;return a++,r}))}(l,function(e){const t=new Map;return e.forEach((e=>{const n=t.get(e)||0;t.set(e,n+1)})),t}(l));w(e)?t=2:(r.values=i?e.map((e=>[e])):[e],await n.sync(),t=0)}return t}catch(e){t=2,c.M.getInstance().logErrorCode(r.O.TLRFixDuplicatesFailed,e)}return t}async function x(e){await u.CP.fetchAndSetActiveTableLikeEntity(e);const t=u.CP.getActiveTable();if(!t||!(0,h.P9)(e,t.name))return c.M.getInstance().logErrorCode(r.O.AutoFixTLRFailed,new Error("NoActiveTable")),2;try{return await(0,b.F5)((async e=>{const n=S(e,t),a=t.tableLikeRangeFeatures;if(!a)return 1;if(a===s.ye.DuplicateHeaders)return await T(n);if(Office.context.requirements.isSetSupported("excelapiundo","1.31")){const e=await async function(e,t){const n=[];t&s.ye.HasMergedCells&&n.push(await async function(e){try{const{context:t,tableRange:n}=e,a=n.getMergedAreasOrNullObject();return a.load("areas/items/values"),await t.sync(),a.isNullObject?(n.unmerge(),await t.sync(),0):(a.areas.items.forEach((e=>{const t=e.values.flat().find((e=>e!==Excel.RangeValueType.empty));e.unmerge(),e.values=e.values.map((e=>e.map((()=>t))))})),n.unmerge(),await t.sync(),0)}catch(e){return c.M.getInstance().logErrorCode(r.O.TLRFixMergedCellsFailed,e),2}}(e));t&s.ye.EmptyHeaders&&n.push(await async function(e){try{const{context:t,tableRange:n,orientation:a}=e,o=E(n,a);if(o.load("valueTypes, isNullObject"),await t.sync(),o.isNullObject)throw new Error("NoHeaderRange");const r=o.valueTypes,i="rowMajor"===a,s=r.flatMap(((e,t)=>e.map(((e,a)=>{if(e===Excel.RangeValueType.empty){const e=n.getCell(t,a),o=i?`${(0,l.yfY)()}${t+1}`:`${(0,l.AWH)()}${a+1}`;return e.values=[[o]],e}})))).filter((e=>void 0!==e));return await t.sync(),s.length>0?0:1}catch(e){return c.M.getInstance().logErrorCode(r.O.TLRFixEmptyHeadersFailed,e),2}}(e));return n.push(await T(e)),n}(n,a);if(e.includes(2))throw new Error("AutoFixUnsuccessful");if(e.includes(0))return a&s.ye.HasMergedCells&&u.CP.clearMergedCellsFromActiveTable(),0}return 1}))}catch(e){return"AutoFixUnsuccessful"===e.message?await(0,b.tN)(d.q.ContextInference):c.M.getInstance().logErrorCode(r.O.AutoFixTLRFailed,e),2}}function S(e,t){const n=e.workbook.worksheets.getItem(t.sheetRange.sheet),a=n.getRange((0,g.r)(t.address));return{context:e,sheet:n,tableRange:a,orientation:I(t)}}function w(e){return new Set(e).size!==e.length}function E(e,t=i.YV.ColumnMajor){return t===i.YV.RowMajor?e.getColumn(0):e.getRow(0)}function I(e){return e?.tableLikeRangeFeatures&&e.tableLikeRangeFeatures&s.ye.RowMajor?i.YV.RowMajor:i.YV.ColumnMajor}async function R(e){try{const t=u.CP.getActiveTable();if(!t)throw new Error("NoActiveTable");return await Excel.run((async n=>{const a=S(n,t),o=E(a.tableRange,a.orientation);o.load("values"),await n.sync();const r=o.values[0],i=t.sheetRange.range.topLeft;if("EmptyHeaders"===e)return r.map(((e,t)=>{if(!e){if(!i.column||!i.row)throw new Error("Invalid table address format");return(0,m.LM)(i.row+1,i.column+t+1)}return null})).filter((e=>null!==e));{const e=new Map;return r.forEach(((t,n)=>{if(t){if(!i.column||!i.row)throw new Error("Invalid table address format");const a=(0,m.LM)(i.row+1,i.column+n+1);e.has(t)?e.get(t)?.push(a):e.set(t,[a])}})),Array.from(e.values()).filter((e=>e.length>1)).flat()}}))}catch(t){return"EmptyHeaders"===e?c.M.getInstance().logErrorCode(r.O.TLRRetrieveEmptyHeaderCellsFailed,t):c.M.getInstance().logErrorCode(r.O.TLRRetrieveDuplicateHeaderCellsFailed,t),[]}}!function(e){e[e.Success=0]="Success",e[e.NoChangeMade=1]="NoChangeMade",e[e.Unsuccessful=2]="Unsuccessful"}(a||(a={})),function(e){e.NoActiveTable="NoActiveTable",e.NoHeaderRange="NoHeaderRange",e.AutoFixUnsuccessful="AutoFixUnsuccessful"}(o||(o={}))},126521:(e,t,n)=>{"use strict";function a(e,...t){return e.replace(/{(\d+)}/gm,((e,n)=>{const a=parseInt(n,10);return t[a]?t[a]:""}))}n.d(t,{L:()=>a})},135829:(e,t,n)=>{"use strict";n.d(t,{A7:()=>A,VQ:()=>y,px:()=>E});var a=n(616166),o=n(963002),r=n(543435),i=n(316904),l=n(347145),s=n(659126),c=n(624654),d=n(400665),u=n(464077);const m=4,g=5e6,h=5e5,p=5e8,b={maxCellCount:1e4,entryLimit:1e3};class f{log(){i.M.getInstance().logGetSelectionContext(this.columnCount,this.rowCount,this.selectionExpanded,this.tableSelectionContext,this.isSmallSelection,this.areaCount)}constructor(){this.selectionExpanded=!1,this.columnCount=0,this.rowCount=0,this.tableSelectionContext={isTable:!1,hasTableHeaders:!1,showTotals:!1},this.isSmallSelection=!1,this.areaCount=0}}function C(e){e.load(["isNullObject","cellCount","isEntireRow","isEntireColumn","worksheet/id","worksheet/name","address","columnCount","rowCount","rowIndex","columnIndex","rowHidden"])}async function y(e,t,n,a,o,r){r&&i.M.getInstance().addAnalyzeDataStep(r,"getSelectionDataForFormulas");const l=Date.now(),s=Math.min(b.entryLimit,Math.ceil(b.maxCellCount/n)),c=await Excel.run((async r=>{const i=r.workbook.worksheets.getItem(o),l=i.getRangeByIndexes(t,a,e,n),c=v(l),d=x(i,Math.min(s,e),t,n,a);await l.context.sync();return{...c(),formulas:d()}}));return i.M.getInstance().logLoadFormulaData(Date.now()-l,e,n),r&&i.M.getInstance().removeAnalyzeDataStep(r,"getSelectionDataForFormulas"),c}function v(e){return e.load(["values","numberFormat","numberFormatLocal","text","valueTypes"]),()=>{let t=!1;const n=e.values.map(((n,a)=>n.map(((n,o)=>"#VALUE!"===n?(t=!0,e.text[a][o]):e.valueTypes[a][o]===Excel.RangeValueType.empty?null:e.values[a][o]))));return i.M.getInstance().logGetDataFromRange(t),{values:n,formats:e.numberFormat,formatLocals:e.numberFormatLocal,text:e.text}}}function T(e,t,n,a,o){const r=e.getRangeByIndexes(n,o,t,a).getMergedAreas(),i=r.areas;return i.load(["columnIndex","rowIndex","columnCount","rowCount"]),()=>r.isNullObject?[]:i.items.map((e=>{const{columnIndex:t,rowIndex:a,columnCount:r,rowCount:i}=e,l=a-n,s=t-o;return{top:l,left:s,bottom:l+i-1,right:s+r-1}}))}function x(e,t,n,a,o){const r=e.getRangeByIndexes(n,o,t,a);return r.load(["formulas","rowCount","columnCount"]),()=>r.formulas}function S(e,t,n,a,o){let r;if(t*a<g)r=e.getRangeByIndexes(n,o,t,a).getNumberFormatProperties().load("items/*");else{const i=Math.min(t,b.entryLimit),l=Math.min(a,b.maxCellCount/i),c=(0,s.uT)(n,o,i,l),d=e.getRange(c);r=d.getNumberFormatProperties().load("items/*")}return()=>r.items}function w(e){const t=e.map((e=>e.values)),n=e.map((e=>e.text)),a=e.map((e=>e.formats)),o=e.map((e=>e.formatLocals));return{values:[].concat(...t),formats:[].concat(...a),formatLocals:[].concat(...o),text:[].concat(...n)}}async function E(e,t){t&&i.M.getInstance().addAnalyzeDataStep(t,"getSelectionContextAndData");const n=new f,y=performance.now();let E;const L=()=>(E=performance.now(),E);try{return await Excel.run((async f=>async function(e,t,n,f,y,E){E&&i.M.getInstance().addAnalyzeDataStep(E,"getSelectionContextAndDataImp");const L=(0,c.dI)(e),k=A(e),F=await async function(e,t,n,o){o&&i.M.getInstance().addAnalyzeDataStep(o,"getNewSelectedRange");const c=e.workbook.getSelectedRanges().load("areaCount"),g=c.getUsedRangeAreasOrNullObject(!0);let h;if(n.type===r.lp.StandardTable)h=e.workbook.tables.getItem(n.name).getRange();else{if(n.type!==r.lp.TableLikeRange)throw new Error("InvalidTableLikeEntityType");{const t=(0,u.G2)(n.name);h=e.workbook.worksheets.getItem(n.sheetId).getRange(t),n.showTotals&&(h=h.getResizedRange(-1,0))}}h.load(["cellCount","rowCount"]);const p=h.getUsedRangeOrNullObject(!0).load(["cellCount","rowCount"]),b={selected:{range:h},usedSelected:{range:p}};!function(e){const t=e.selected.range.worksheet;t.tables.load(["items","showHeaders","showTotals","name"]),t.pivotTables.load("items"),t.load("id"),[e.selected.range,e.usedSelected.range].forEach((e=>C(e)))}(b);const f=function(e){const t=e.getTables().load({name:!0,showHeaders:!0,showTotals:!0});return async()=>{if(1!==t.items.length)return;const e=t.items[0],n=(0,d.U2)(e,e.showHeaders);return C(n),await e.context.sync(),{range:n,isPivotTable:!1,getTableData:()=>({tableName:e.name,hasTableHeaders:e.showHeaders,showTotals:e.showTotals}),getHasHiddenRows:()=>!1!==n.rowHidden}}}(h),y=function(e){const t=function(e){const t=e.getSurroundingDataRegion();return C(t),{range:t,usedRange:t}}(e.selected.range),n=function(e){return C(e.selected.range),{range:e.selected.range,usedRange:e.usedSelected.range}}(e),a=R(t.range,t.usedRange),o=R(n.range,n.usedRange);return a.next(),o.next(),{smallSelectionGenerator:a,largeSelectionGenerator:o}}(b);try{let o;await e.sync();const i=h.isEntireRow||h.isEntireColumn;t.areaCount=c.areaCount;const d=g.isNullObject;if(c.areaCount>1&&!(0,l.yw9)("OfficeVSO_9209788_allowMultiSelectedRanges"))throw new a.u(a.O.MultiSelectionError);{const a=e=>e.usedSelected.range.isNullObject||d||e.usedSelected.range.cellCount<=m||e.usedSelected.range.rowCount<2||1===e.usedSelected.range.columnCount;if(n.type!==r.lp.TableLikeRange&&((0,l.yw9)("OfficeVSO_9858693_fixCalculatedRowPostioningForTableWithEmptyRows")||a(b))){t.selectionExpanded=!0,t.isSmallSelection=!0;const n=await f(),a=!n||i?await(0,s.H)(e,y.smallSelectionGenerator):n;o=n??a}else o=await(0,s.H)(e,y.largeSelectionGenerator)}return{selected:o}}catch(e){if(e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.invalidOperationInCellEditMode)throw new a.u(a.O.CellEditModeError,e);if(e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.invalidSelection)throw new a.u(a.O.InvalidSelection,e);throw e}finally{o&&i.M.getInstance().removeAnalyzeDataStep(o,"getNewSelectedRange")}}(e,t,y,E),_=F.selected,P=L(),N=k();if(!_)return i.M.getInstance().logDuration("GetSelectionContext",performance.now()-n,E),E&&i.M.getInstance().removeAnalyzeDataStep(E,"getSelectionContextAndDataImp"),{context:I,localeDeprecated:P,theme:N,dataGenerator:(0,l.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.AnalyzeDataSkill",!1)?void 0:async function*(){}()};try{!function(e){if(e.range.isEntireRow||e.range.isEntireColumn)throw new a.u(a.O.UnboundedRange)}(_)}catch(e){throw E&&i.M.getInstance().removeAnalyzeDataStep(E,"getSelectionContextAndDataImp"),e}i.M.getInstance().logDuration("GetSelectionContext",f()-n,E);const{rowCount:M,rowIndex:O,columnCount:D,columnIndex:B,worksheet:$}=_.range,H=(0,l.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.AnalyzeDataSkill",!1)?void 0:async function*(e,t,n,a,r,s){const c=Office.context.platform===Office.PlatformType.OfficeOnline?g:h;let d=Math.floor(Math.min(e,c/n));const u=2**(0,l.Z8j)("Microsoft.Office.Excel.FA000000124.MaxPayloadSizeRetries",7),m=Math.min(b.entryLimit,Math.ceil(b.maxCellCount/n));let f=t,C=t;for(;f<t+e;){s&&i.M.getInstance().addAnalyzeDataStep(s,"getSelectionDataFromSelectedRangeInfo");const l=Date.now(),g=[],h=[];let y,E,I=0;try{const R=await Excel.run((async i=>{const l=i.workbook.worksheets.getItem(r);for(;f<t+e&&f-C<Math.floor(c/n);){let r=0;if(g.length===u||r>=p){const e=w(g),t=[].concat(...h);return{...e,mergedCells:E,formulas:t}}const i=l.getRangeByIndexes(f,a,Math.min(d,t+e-f),n),s=v(i);let c,C,R=()=>[];f===t&&(c=T(l,e,t,n,a),R=S(l,e,t,n,a));const A=f-t;A<m&&A*n<b.maxCellCount&&(C=x(l,Math.min(m-A,d),f,n,a)),I++;try{await i.context.sync();const e=s();g.push(e),void 0!==C&&h.push(C()),f===t&&(E=c(),y=R(),o.P.getNumberFormatCache().addNumberFormatPropertiesToCache(y)),r+=JSON.stringify(e).length,f+=d}catch(e){if(!(e instanceof OfficeExtension.Error&&(e.code===Excel.ErrorCodes.responsePayloadSizeLimitExceeded||e.code===OfficeExtension.ErrorCodes.generalException)&&d>1))throw e;d=Math.ceil(d/2)}}const s=w(g),R=[].concat(...h);return{...s,mergedCells:E,formulas:R}}));i.M.getInstance().logLoadDataWithChunking("GetSelectionData",Date.now()-l,e,n,!0,g.length,I,d),C+=R.values.length,s&&i.M.getInstance().removeAnalyzeDataStep(s,"getSelectionDataFromSelectedRangeInfo"),yield R}catch(t){throw i.M.getInstance().logLoadDataWithChunking("GetSelectionData",Date.now()-l,e,n,!1,g.length,I,d),t}}}(M,O,D,B,$.id,E);let U=function(e,t){if(!e)return;return function(e,t){const n=t.range;e.columnCount=n.columnCount,e.rowCount=n.rowCount;const a=t.getTableData();let o;o=a?a.tableName:void 0;const r={isTable:!!a,hasTableHeaders:!!a&&a.hasTableHeaders,showTotals:!!a&&a.showTotals,tableName:o,hasHiddenRows:t.getHasHiddenRows()};return e.tableSelectionContext=r,i.M.getInstance().logDuration("GenerateSelectionContext",0),{address:(0,s.gx)(n.address),sheetId:n.worksheet.id,sheetName:n.worksheet.name,rowCount:n.rowCount,rowIndex:n.rowIndex,columnCount:n.columnCount,columnIndex:n.columnIndex,...r}}(t,e)}(_,t)??I;y.type===r.lp.TableLikeRange&&(U={...U,tableName:y.name,showTotals:y.showTotals,hasTableHeaders:y.hasTableHeaders});t.log(),E&&i.M.getInstance().removeAnalyzeDataStep(E,"getSelectionContextAndDataImp");return{context:U,dataGenerator:H,localeDeprecated:P,theme:N}}(f,n,y,L,e,t)))}catch(e){throw e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.inactiveWorkbook?new a.u(a.O.InactiveWorkbook,e):e instanceof a.u?e:new a.u(a.O.SelectionFailed,e)}finally{E&&i.M.getInstance().logDuration("GetSelectionData",performance.now()-E,t),t&&i.M.getInstance().removeAnalyzeDataStep(t,"getSelectionContextAndData")}}const I={rowCount:0,rowIndex:0,columnCount:0,columnIndex:0,isTable:!1,hasTableHeaders:!1,showTotals:!1};function*R(e,t){const n=e.getTables().load("items"),o=e.getPivotTables(!1).getFirstOrNullObject(),r=o.layout.getRange();C(r);const i={range:t,getTableData:()=>{},getHasHiddenRows:()=>!1!==r.rowHidden};if(yield,o.isNullObject&&0===n.items.length)return i;n.items.forEach((e=>{e.load(["showHeaders","name","showTotals"])}));const l=n.items.map((e=>{const t=e.getRange();return C(t),t}));if(o.isNullObject){if(n.items.length>0){let e=t;if(1===l.length&&(yield,function(e,t){return null!==e&&null!==t&&e.rowIndex>=t.rowIndex&&e.columnIndex>=t.columnIndex&&e.rowIndex+e.rowCount<=t.rowIndex+t.rowCount&&e.columnIndex+e.columnCount<=t.columnIndex+t.columnCount}(l[0],t)&&(e=l[0])),n.items.some((e=>e.showTotals))){const t=n.items.map((e=>e.getTotalRowRange().load(["rowIndex","columnIndex","columnCount"]))),a=1===e.rowCount?void 0:e.getResizedRange(-1,0);a&&(C(a),yield,t.some(((t,a)=>n.items[a].showTotals&&t.columnIndex>=e.columnIndex&&t.columnIndex+t.columnCount<=e.columnIndex+e.columnCount&&t.rowIndex===e.rowIndex+e.rowCount-1))&&(e=a))}return{range:e,getTableData:()=>{const t=l.findIndex((t=>function(e,t){return e.rowIndex<=t.rowIndex&&e.columnIndex<=t.columnIndex&&e.rowIndex+e.rowCount>=t.rowIndex+t.rowCount&&e.columnIndex+e.columnCount>=t.columnIndex+t.columnCount}(t,e)));return-1===t?void 0:{hasTableHeaders:n.items[t].showHeaders,tableName:n.items[t].name,showTotals:n.items[t].showTotals}},getHasHiddenRows:()=>!1!==e.rowHidden}}return i}throw new a.u(a.O.PivotTableSelection)}function A(e){if(Office.context.requirements.isSetSupported("ExcelApi","1.17")){const t=e.workbook.getThemeColors();return()=>{const e={accentColors:[]},n=t.value;if(n.length<10)return e;for(let t=4;t<10;t++)e.accentColors.push(L(n[t]));return e.lightColor=L(n[0]),e.darkColor=L(n[1]),e}}const t={accentColors:[]};return()=>t}function L(e){return{r:(255&e)/255,g:(e>>8&255)/255,b:(e>>16&255)/255,a:1}}},140235:(e,t,n)=>{"use strict";n.d(t,{q:()=>l,t:()=>i});var a=n(279395),o=n(650444),r=n(65448);const i=(e,t,n,a)=>{switch(e.visual.visualType){case"PivotTableVisual":{const o=e.visual.pivotTable,i=(0,r.OY)(o);return c(i,n??t,"PivotTable",a)}case"PivotChartVisual":{const o=e.visual.pivotTable,i=(0,r.OY)(o);return c(i,n??t,"PivotChart",a)}case"QueryResultVisual":case"QueryChartVisual":{const o=e.visual.result,i=(0,r.ub)(o);return c(i,n??t,"QueryResultVisual"===e.visual.visualType?"QueryResult":"QueryChart",a)}case"TextAnalysisVisual":{const{interpretationId:t,...n}=e;return c(n,void 0,"TextAnalysisVisual",a)}case"ChartVisual":case"ForecastVisual":{let o=t;n&&(o=n);const r=s(e);return c(r,o,void 0,a)}default:(0,o.x)(e.visual)}},l=e=>{const t=[];let n=1;for(let o=e.length-1;o>=0;o--){const r=e[o];if(r.visualAnswer&&r.visualAnswer.length>0){const e=i(r.visualAnswer[0],"",r.textAnswer?.tokens.map((e=>e.text)).join("")),o=n+e.length+3;if(o>a._A_)break;t.unshift(e),n=o}}return JSON.stringify(t)},s=e=>{const{id:t,interpretationId:n,...a}=e;return a},c=(e,t,n,o)=>{let r=JSON.stringify({text:t,visualType:n,visual:e,mustExplain:o});return r.length>a._A_&&(r="TextAnalysisVisual"===n?(0,a.NOF)():JSON.stringify({text:t,visualType:n,mustExplain:o})),r}},141858:(e,t,n)=>{"use strict";n.d(t,{B:()=>o,q:()=>r});var a=n(615397);async function o(e,t,n){try{return await Excel.run({delayForCellEdit:!0},(async a=>{const o=i(a,e,t,n);return await a.sync(),l(o,n)}))}catch{throw new a.tF(`Failed to read the ${n} colors from table column.`,"getTableColumnColors")}}async function r(e,t,n,o){try{const a=t.map((t=>i(o,e,t,n)));return await o.sync(),a.map((e=>l(e,n)))}catch{throw new a.tF(`Failed to read the ${n} colors from table column.`,"getTableColumnColors")}}function i(e,t,n,a){const o="font"===a?{format:{font:{color:!0}}}:{format:{fill:{color:!0}}};return e.workbook.tables.getItem(t).columns.getItemAt(n).getDataBodyRange().getCellProperties(o)}function l(e,t){return e.value.map((e=>"font"===t?e[0].format?.font?.color??"#000000":e[0].format?.fill?.color??"#FFFFFF"))}},147091:(e,t,n)=>{"use strict";n.d(t,{CT:()=>D,E_:()=>O,OC:()=>N,Qo:()=>F,UN:()=>H,VI:()=>U,tb:()=>M,w2:()=>_,yT:()=>P});var a=n(639765),o=n(548366),r=n(384169),i=n(616166),l=n(605424),s=n(778685),c=n(446751),d=n(75496),u=n(857677),m=n(279395),g=n(83437),h=n(76872),p=n(316904),b=n(314793),f=n(650444),C=n(664007),y=n(109174),v=n(855539),T=n(92520),x=n(347145),S=n(803716),w=n(792312),E=n(252120);const I={logError(e,t,n=g.$b.Error){p.M.getInstance().logErrorCode(i.O.FormulaGenerationSkillError,(0,u.Jr)(t),d.S2.FormulaGeneration,n,{key:u.tj.UserQueryGuid,value:e??"undefined"})},logWarning(e,t){this.logError(e,t,g.$b.Warning)},logSkillData(e,t={}){h.E.getInstance().updateTelemetryChatEventData({[u.h3.ChatEventType]:u.a5.FormulaSuggestionSkillData,[u.h3.ChatEventParameters]:JSON.stringify({event:e,...t})},p.M.getInstance())}},R=new Map;function A(e){return R.has(e)||R.set(e,{requestId:e,timeoutId:void 0,startTime:void 0,receivedFormulaAnnotation:!1,receivedSkillMetadata:!1}),R.get(e)}const L={[s.az.CellSuggestion]:u.OP.CalculatedCells,[s.az.NlToFormulaSuggestion]:u.OP.CalculatedCells,[s.az.ColumnSuggestion]:u.OP.CalculatedColumns};function k(){return(0,x.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.EnableFormulaContext",!1)}function F(e){return(0,x.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.EnableS2SFormulaSkill",!1)&&(k()||!e((0,S.MN)()))}async function _(e,t,n){if(k()){if(n)return p.M.getInstance().runTimedAsyncFunction("FormulaSkillContextCreation",(async()=>{try{const a=await e((0,S.CQ)(n.name,t)),o=e((0,S.cQ)(n.name)),r={visibleRows:await(0,c.e1)(o),cells:(0,c.Ys)(o,a),isHybrid:!e((0,S.MN)())};return I.logSkillData("FormulaSkillContext",{cells:r.cells.length,visibleRows:r.visibleRows?.length,contextSize:JSON.stringify(r).length}),r}catch(e){return void I.logError(t,e)}}),t??"");I.logError(t,"Error while getting formula context: activeTable is undefined")}}function P(e,t,n){F(e)&&I.logError(t,`Missing formula context: ${n}`)}function N(e,t,n){F(e)&&I.logError(t,`Unexpected formula ODSL flow: ${n}`)}function M(e){U(e)&&I.logSkillData("SkillAshaEvent",{formulaType:e.formulaType,chatResponseCode:e.chatResponseCode,result:e.suggestionMetadata?.result,shouldFallbackToElse:e.suggestionMetadata?.shouldFallbackToElse})}async function O(e,t,a){if(F(a))if(e)switch(A(e).receivedSkillMetadata=!0,t.chatResponseCode){case l.b.Started:I.logSkillData("SkillStarted",{formulaType:t.formulaType}),await async function(e,t,a,o){if(void 0===a)return void I.logWarning(e,"onSkillStarted: Metadata missing formulaType");if("inProgress"===t((0,w.iT)(e)))return void I.logWarning(e,"onSkillStarted: Already processing a request");A(e).startTime=performance.now(),t(C.m.setLatestRequestId(e));const r=o??y.CP.getActiveTable()?.name;r?((0,x.ZAR)()&&await y.CP.fetchAndSetActiveTableLikeEntity(r),t(v.m.updateTableName({requestId:e,table:r}))):I.logError(e,"onSkillStarted: No active table found");t(v.m.startFetching(e)),t(C.m.startExecutingCommand({id:e,command:L[a]})),A(e).timeoutId=window.setTimeout((()=>B(e,t,"SDX")),b.R.getFormulaAITimeout()),Promise.all([n.e("chunk1jsfluent"),n.e("vendors-npm_store_sdx_officecopilot_1js-excel-copilot-calc_8_3_43-1adabd76bb06679768ec_node_m-dd2f81"),n.e("calc")]).then(n.bind(n,478565))}(e,a,t.formulaType,(0,x.ZAR)()?t.tableName:void 0);break;case l.b.OK:$(e),I.logSkillData("SkillCompleted"),A(e).receivedFormulaAnnotation||I.logWarning(e,"handleFormulaSuggestionMetadata: Received OK without a formula annotation");break;case l.b.ServiceTimeout:B(e,a,"AL");break;case l.b.Unsuccessful:case l.b.ServiceError:$(e),I.logSkillData("SkillFailed",{chatResponseCode:t.chatResponseCode,result:t.suggestionMetadata?.result}),A(e).receivedFormulaAnnotation||(I.logWarning(e,"handleFormulaSuggestionMetadata: Received unsuccessful without a formula annotation"),(0,w.aP)(e,a,void 0,void 0,!0));break;case l.b.FallbackToElse:$(e),I.logSkillData("SkillFallbackToElse",{formulaType:t.formulaType});break;default:I.logWarning(e,`Unexpected chatResponseCode: ${t.chatResponseCode}`),(0,f.x)(t.chatResponseCode)}else I.logError(e,"Metadata received without a queryId");else I.logWarning(e,"Metadata received when the skill is not enabled/supported")}function D(e,t,n,...r){(0,w.aP)(e,t,m.olU.CalculatedColumnsFailureGeneral,u.q0.AugloopTimeout),p.M.getInstance().logStandardizedAshaErrorEvent(o.W.Response_Delayed_Or_Timed_Out,a.c.Calculate_Suggestion_Timeout,u.BJ.FormulaGeneration),p.M.getInstance().logErrorCode(i.O.ShowSuggestionsTimeout,(0,u.Jr)(n),d.S2.FormulaGeneration,g.$b.Warning,{key:u.tj.Message,value:n},...r)}function B(e,t,n){$(e),(0,T.cY)(`onSkillTimeout: requestId: ${e}, source: ${n}`);const a=t((0,w.iT)(e));switch(I.logSkillData("SkillTimeout",{source:n,currentState:a}),a){case"inProgress":{const n=A(e);D(e,t,"Timeout while waiting for suggestions from AL",{key:u.tj.TimeoutAfter,value:void 0!==n.startTime?(performance.now()-n.startTime/1e3).toFixed(2):"unknown"});break}case"failed":I.logWarning(e,`onSkillTimeout: Timeout on ${n}, but already failed`);break;case"succeeded":case"notStarted":I.logWarning(e,`onSkillTimeout: Timeout on ${n}, unexpected state: ${a}`);break;default:(0,f.x)(a)}}function $(e){const t=A(e);t.timeoutId&&(clearTimeout(t.timeoutId),t.timeoutId=void 0)}async function H(e,t){if(!F(e))return void e((0,w.UN)(t,r.Dv.typeGuard(t)?c.VS.Cell:c.VS.Column));const{requestId:n}=t,a=A(n);a.receivedFormulaAnnotation=!0,a.receivedSkillMetadata||I.logWarning(n,"Received formula annotation without metadata"),e((0,w.P_)(n))?((0,x.cTR)()&&e(E.m.addQueryMetrics({queryId:n,metrics:t.telemetry?.metrics})),e((0,w.y1)(n)),e((0,w.uX)(t)),await e((0,w.GZ)(t,!0))):I.logWarning(n,"Received formula annotation of non-active or failed request")}function U(e){return e?.type===l.VF.FormulaResponseMeta}},154836:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unsafeStringify=void 0;const a=n(904967),o=[];for(let e=0;e<256;++e)o.push((e+256).toString(16).slice(1));function r(e,t=0){return(o[e[t+0]]+o[e[t+1]]+o[e[t+2]]+o[e[t+3]]+"-"+o[e[t+4]]+o[e[t+5]]+"-"+o[e[t+6]]+o[e[t+7]]+"-"+o[e[t+8]]+o[e[t+9]]+"-"+o[e[t+10]]+o[e[t+11]]+o[e[t+12]]+o[e[t+13]]+o[e[t+14]]+o[e[t+15]]).toLowerCase()}t.unsafeStringify=r,t.default=function(e,t=0){const n=r(e,t);if(!(0,a.default)(n))throw TypeError("Stringified UUID is invalid");return n}},156085:e=>{"use strict";e.exports="data:application/font-woff;charset=utf-8;base64, d09GRgABAAAAAAZgABAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAAGRAAAABoAAAAci6qHkUdERUYAAAWgAAAAIwAAACQAYABXR1BPUwAABhQAAAAuAAAANuAY7+xHU1VCAAAFxAAAAFAAAABm2fPczU9TLzIAAAHcAAAASgAAAGBP9V5RY21hcAAAAkQAAACIAAABYt6F0cBjdnQgAAACzAAAAAQAAAAEABEBRGdhc3AAAAWYAAAACAAAAAj//wADZ2x5ZgAAAywAAADMAAAD2MHtryVoZWFkAAABbAAAADAAAAA2E2+eoWhoZWEAAAGcAAAAHwAAACQC9gDzaG10eAAAAigAAAAZAAAArgJkABFsb2NhAAAC0AAAAFoAAABaFQAUGG1heHAAAAG8AAAAHwAAACAAcABAbmFtZQAAA/gAAAE5AAACXvFdBwlwb3N0AAAFNAAAAGIAAACE5s74hXjaY2BkYGAAYpf5Hu/j+W2+MnAzMYDAzaX6QjD6/4//Bxj5GA8AuRwMYGkAPywL13jaY2BkYGA88P8Agx4j+/8fQDYfA1AEBWgDAIB2BOoAeNpjYGRgYNBh4GdgYgABEMnIABJzYNADCQAACWgAsQB42mNgYfzCOIGBlYGB0YcxjYGBwR1Kf2WQZGhhYGBiYGVmgAFGBiQQkOaawtDAoMBQxXjg/wEGPcYDDA4wNUA2CCgwsAAAO4EL6gAAeNpj2M0gyAACqxgGNWBkZ2D4/wMA+xkDdgAAAHjaY2BgYGaAYBkGRgYQiAHyGMF8FgYHIM3DwMHABGQrMOgyWDLEM1T9/w8UBfEMgLzE////P/5//f/V/xv+r4eaAAeMbAxwIUYmIMHEgKYAYjUcsDAwsLKxc3BycfPw8jEQA/gZBASFhEVExcQlJKWkZWTl5BUUlZRVVNXUNTQZBgMAAMR+E+gAEQFEAAAAKgAqACoANAA+AEgAUgBcAGYAcAB6AIQAjgCYAKIArAC2AMAAygDUAN4A6ADyAPwBBgEQARoBJAEuATgBQgFMAVYBYAFqAXQBfgGIAZIBnAGmAbIBzgHsAAB42u2NMQ6CUAyGW568x9AneYYgm4MJbhKFaExIOAVX8ApewSt4Bic4AfeAid3VOBixDxfPYEza5O+Xfi04YADggiUIULCuEJK8VhO4bSvpdnktHI5QCYtdi2sl8ZnXaHlqUrNKzdKcT8cjlq+rwZSvIVczNiezsfnP/uznmfPFBNODM2K7MTQ45YEAZqGP81AmGGcF3iPqOop0r1SPTaTbVkfUe4HXj97wYE+yNwWYxwWu4v1ugWHgo3S1XdZEVqWM7ET0cfnLGxWfkgR42o2PvWrDMBSFj/IHLaF0zKjRgdiVMwScNRAoWUoH78Y2icB/yIY09An6AH2Bdu/UB+yxopYshQiEvnvu0dURgDt8QeC8PDw7Fpji3fEA4z/PEJ6YOB5hKh4dj3EvXhxPqH/SKUY3rJ7srZ4FZnh1PMAtPhwP6fl2PMJMPDgeQ4rY8YT6Gzao0eAEA409DuggmTnFnOcSCiEiLMgxCiTI6Cq5DZUd3Qmp10vO0LaLTd2cjN4fOumlc7lUYbSQcZFkutRG7g6JKZKy0RmdLY680CDnEJ+UMkpFFe1RN7nxdVpXrC4aTtnaurOnYercZg2YVmLN/d/gczfEimrE/fs/bOuq29Zmn8tloORaXgZgGa78yO9/cnXm2BpaGvq25Dv9S4E9+5SIc9PqupJKhYFSSl47+Qcr1mYNAAAAeNptw0cKwkAAAMDZJA8Q7OUJvkLsPfZ6zFVERPy8qHh2YER+3i/BP83vIBLLySsoKimrqKqpa2hp6+jq6RsYGhmbmJqZSy0sraxtbO3sHRydnEMU4uR6yx7JJXveP7WrDycAAAAAAAH//wACeNpjYGRgYOABYhkgZgJCZgZNBkYGLQZtIJsFLMYAAAw3ALgAeNolizEKgDAQBCchRbC2sFER0YD6qVQiBCv/H9ezGI6Z5XBAw8CBK/m5iQQVauVbXLnOrMZv2oLdKFa8Pjuru2hJzGabmOSLzNMzvutpB3N42mNgZGBg4GKQYzBhYMxJLMlj4GBgAYow/P/PAJJhLM6sSoWKfWCAAwDAjgbRAAB42mNgYGBkAIIbCZo5IPrmUn0hGA0AO8EFTQAA"},158058:(e,t,n)=>{"use strict";n.d(t,{$j:()=>z,AG:()=>N,Ah:()=>I,GT:()=>b,Ks:()=>F,M$:()=>f,MQ:()=>y,OK:()=>C,P9:()=>G,S5:()=>j,TF:()=>A,TP:()=>x,Zv:()=>w,bp:()=>T,ey:()=>M,f0:()=>E,f_:()=>p,hd:()=>S,ie:()=>L,kB:()=>P,kw:()=>_,py:()=>v,xl:()=>R});var a=n(279395),o=n(59653),r=n(531093),i=n(12855),l=n(910480),s=n(109174),c=n(464077),d=n(92520),u=n(347145),m=n(124445),g=n(972424),h=n(672270);function p(e,t,n,a){const o=v(e),r=a?t[a]:t[o];if(!r)return t;const i=(0,l.cloneDeep)(t),s={...r,...n};return a&&o!==a&&(i[o]=i[a],delete i[a]),i[o]=s,i}function b(e){if(1===e.length&&!f(e[0]))throw new Error("Single range that is not fully specified");const t={topLeft:{row:Math.min(...e.map((e=>(e=>null!==e.topLeft.row?e.topLeft.row:1/0)(e)))),column:Math.min(...e.map((e=>(e=>null!==e.topLeft.column?e.topLeft.column:1/0)(e))))},bottomRight:{row:Math.max(...e.map((e=>(e=>null!==e.bottomRight.row?e.bottomRight.row:0)(e)))),column:Math.max(...e.map((e=>(e=>null!==e.bottomRight.column?e.bottomRight.column:0)(e))))}};if(!f(t))throw new Error("Bounding rect does not produce a fully specified range");return t}function f(e){return null!==e.topLeft.column&&null!==e.topLeft.row&&null!==e.bottomRight.column&&null!==e.bottomRight.row&&e.bottomRight.column>=e.topLeft.column&&e.bottomRight.row>=e.topLeft.row}function C(e,t,n,a){if(!f(e))throw new Error("Invalid TLR range");const o={worksheetId:a,left:e.topLeft.column+1,top:e.topLeft.row+1,right:e.bottomRight.column+1,bottom:e.bottomRight.row+1},r=t[n],i=(0,c.Jm)((0,c.zC)(r.name),o);return p(i,t,{range:e,name:i,interpretation:{...r.interpretation,location:o}},n)}function y(e){if(!f(e))throw new Error("Invalid TLR range");return`${e.topLeft.column+1}|${e.bottomRight.column+1}|${e.topLeft.row+1}|${e.bottomRight.row+1}`}function v(e){return y(r.ExcelCalc.addressToExcelRange((0,c.G2)(e)))}function T(e,t){let n=i.ye.None;t.hasMergedcells&&(n|=i.ye.HasMergedCells);const a=e.aggregationLines?.length,o=t.primaryTable?.hasTotalRow??!1;o&&(n|=i.ye.TotalsRow),a&&(a>1||1===a&&!o)&&(n|=i.ye.UnsupportedAggregations);return n|=[{check:"columnMajor"===e.orientation&&0===e.headerRowCount,flag:i.ye.NoHeaderRow},{check:"columnMajor"===e.orientation&&e.headerRowCount>1,flag:i.ye.MultipleHeaderRows},{check:"columnMajor"===e.orientation&&e.headerColumnCount>0,flag:i.ye.HeaderColumns},{check:"rowMajor"===e.orientation,flag:i.ye.RowMajor},{check:"rowMajor"===e.orientation&&0===e.headerColumnCount,flag:i.ye.NoHeaderColumn},{check:"rowMajor"===e.orientation&&e.headerColumnCount>1,flag:i.ye.MultipleHeaderColumns},{check:"rowMajor"===e.orientation&&e.headerRowCount>0,flag:i.ye.HeaderRows},{check:.5===e.confidence,flag:i.ye.Crosstab}].reduce(((e,t)=>t.check?e|t.flag:e),i.ye.None),{unsupportedFeatures:n,hasTotalRow:o}}function x(e,t){return"columnMajor"===e?!!(t&i.ye.NoHeaderRow):!!(t&i.ye.NoHeaderColumn)}function S(e){return function(e){const t=new Set(e);return e.some((e=>function(e,t){const n=W[e];return!!n&&n.every((e=>!t.has(e)))}(e,t)))}(e)?(0,a.nYf)():(0,a.VH3)()}function w(e){const t=D(e);return t?.singleErrorMessage??""}function E(e){const t=D(e);return t?.multipleErrorMessage??""}function I(e){const t=D(e);return t?.header??""}async function R(e){const t=O(e);return{header:await t.header(),description:t.description}}function A(e){if(1===e.length){return O(e[0]).successfulResponse}return(0,a.qPG)()}function L(e){if(1===e.length){return O(e[0]).unsuccessfulResponse}return(0,a.Py2)()}const k=(e,t,n)=>n.includes(t[0])&&n.includes(t[1])&&e===t[0];async function F(e){if(e=e.filter((t=>!V.some((n=>k(t,n,e))))),(0,u.yw9)("OfficeVSO_9858186_bug9828739tlrerrornotindicateemptyandduplicateheader")){const t=await(0,m.K4)();0!==(await(0,m.I1)()).length&&0===t.length&&(e=e.filter((e=>e!==i.ye.DuplicateHeaders)))}return e}function _(e){return Object.values(i.ye).filter((t=>"number"==typeof t&&t!==i.ye.All&&e&t))}function P(e){try{return e.reduce(((e,t)=>e|t[1]),i.ye.None)}catch(e){return(0,d.cY)("Error getting unsupported skill features:",e),i.ye.None}}function N(e){try{return e.reduce(((e,t)=>e|t[1]),0)}catch(e){return(0,d.cY)("Error getting unsupported context features:",e),0}}function M(e){switch(e){case i.b_.PayloadTooLarge:return(0,a.OX0)();case i.b_.PivotTableSelected:case i.b_.ChartSelected:default:return(0,u.yw9)("OfficeVSO_9364126_UpdateAnalyzeDataInsertResponse")?(0,a.zGM)():(0,a.FxF)()}}function O(e){switch(e){case i.ye.DuplicateHeaders:return{header:(0,u.yw9)("OfficeVSO_9858186_bug9828739tlrerrornotindicateemptyandduplicateheader")?q:async()=>(0,a.c_T)(),description:(0,a.P$N)(),successfulResponse:(0,a.MIy)(),unsuccessfulResponse:(0,a.bor)()};case i.ye.HasMergedCells:return{header:H,description:(0,a.Pqn)(),successfulResponse:(0,a.uvg)(),unsuccessfulResponse:(0,a.R3b)()};case i.ye.EmptyHeaders:return{header:(0,u.yw9)("OfficeVSO_9858186_bug9828739tlrerrornotindicateemptyandduplicateheader")?U:async()=>(0,a.mJ6)(),description:(0,a.z56)(),successfulResponse:(0,a.MuJ)(),unsuccessfulResponse:(0,a.VJh)()};default:return{header:async()=>{},description:void 0,successfulResponse:(0,a.qPG)(),unsuccessfulResponse:(0,a.Py2)()}}}function D(e){switch(e){case i.ye.RowMajor:return{singleErrorMessage:(0,a.DIq)(),multipleErrorMessage:(0,a.NXr)(),header:(0,a.L0V)()};case i.ye.HeaderColumns:return{singleErrorMessage:(0,a.ujQ)(),multipleErrorMessage:(0,a.kMm)(),header:(0,a.pOf)()};case i.ye.HasMergedCells:return{singleErrorMessage:(0,a.ZkE)(),multipleErrorMessage:(0,a.Thz)(),header:(0,a.C$7)()};case i.ye.UnsupportedAggregations:case i.ye.TotalsRow:return{singleErrorMessage:(0,a.qre)(),multipleErrorMessage:(0,a.Gp3)(),header:(0,a.Pxj)()};case i.ye.NoHeaderRow:return{singleErrorMessage:(0,a.ujQ)(),multipleErrorMessage:(0,a.kMm)(),header:(0,a.pOf)()};case i.ye.MultipleHeaderRows:return{singleErrorMessage:(0,a.nMc)(),multipleErrorMessage:(0,a.pP4)(),header:(0,a.mcb)()};case i.ye.EmptyHeaders:return{singleErrorMessage:(0,a.jLG)(),multipleErrorMessage:(0,a.z56)(),header:(0,a.mJ6)()};case i.ye.DuplicateHeaders:return{singleErrorMessage:(0,a.Tlk)(),multipleErrorMessage:(0,a.Dh1)(),header:(0,a.c_T)()};case i.ye.Crosstab:return{singleErrorMessage:(0,a.up8)(),multipleErrorMessage:(0,a.ev2)(),header:(0,a.h_t)()};case i.ye.MultipleHeaderColumns:case i.ye.NoHeaderColumn:case i.ye.HeaderRows:case i.ye.LowInterpretationConfidence:return{singleErrorMessage:(0,a.c7Y)(),multipleErrorMessage:(0,a.GIT)(),header:(0,a.vkL)()};case i.ye.Unrecognized:default:{const e=o.p.getInstance();if(e&&!e.isModelWorkflowSupported)return{singleErrorMessage:(0,a.YMx)(),multipleErrorMessage:void 0,header:void 0};{const e=s.CP.getActiveTable();return{singleErrorMessage:B(e),multipleErrorMessage:void 0,header:void 0}}}}}const B=e=>$(e)?(0,a.p8O)():(0,a.eGo)(),$=e=>!!e&&(e.numColumns<2||e.numRows<3);async function H(){const e=await(0,m.ge)(),t=e.length;let n;if(0===t)n=(0,h.VY)((0,a.yo8)(),{count:""});else if(t>2)n=(0,h.VY)((0,a.yo8)(),{count:t});else if(2===t){const[t,o]=e.map((e=>(0,g.r)(e)));n=(0,h.VY)((0,a.qp3)(),{range1:t,range2:o})}else{const t=(0,g.r)(e[0]);n=(0,h.VY)((0,a.ay0)(),{range:t})}return n}async function U(){const e=await(0,m.I1)(),t=e.length;let n;if(0===t)n=(0,h.VY)((0,a.z32)(),{count:""});else if(t>2)n=(0,h.VY)((0,a.z32)(),{count:t});else if(2===t){const[t,o]=e.map((e=>(0,g.r)(e)));n=(0,h.VY)((0,a.DqZ)(),{range1:t,range2:o})}else{const t=(0,g.r)(e[0]);n=(0,h.VY)((0,a.XD3)(),{range:t})}return n}async function q(){const e=await(0,m.K4)(),t=e.length;let n;if(0===t)n=(0,h.VY)((0,a.P13)(),{count:""});else if(t>2)n=(0,h.VY)((0,a.P13)(),{count:t});else if(2===t){const[t,o]=e.map((e=>(0,g.r)(e)));n=(0,h.VY)((0,a.H6H)(),{range1:t,range2:o})}else n=(0,h.VY)((0,a.P13)(),{count:t});return n}const V=[[i.ye.HeaderColumns,i.ye.NoHeaderRow],[i.ye.TotalsRow,i.ye.UnsupportedAggregations]],W={[i.ye.EmptyHeaders]:[i.ye.HasMergedCells,i.ye.UnsupportedAggregations,i.ye.MultipleHeaderRows],[i.ye.Crosstab]:[i.ye.HasMergedCells,i.ye.UnsupportedAggregations,i.ye.MultipleHeaderRows]};function G(e,t){if(e===t)return!0;if(!e.includes("!")||!t.includes("!"))return!1;if(r.ExcelCalc.sheetNameFromSheetAddresses(e)!==r.ExcelCalc.sheetNameFromSheetAddresses(t))return!1;return Q(r.ExcelCalc.addressToExcelRange((0,c.G2)(e)),r.ExcelCalc.addressToExcelRange((0,c.G2)(t)))}function z(e,t){if(e===t.name)return!0;if(!e.includes("!"))return!1;if(r.ExcelCalc.sheetNameFromSheetAddresses(e)!==r.ExcelCalc.sheetNameFromSheetAddresses(t.name))return!1;return Q(r.ExcelCalc.addressToExcelRange((0,c.G2)(e)),t.range)}function Q(e,t){if(!f(e)||!f(t))return!1;if(!r.ExcelCalc.IExcelRangeIntersect(e,t))return!1;const n=Math.abs(e.topLeft.row-t.topLeft.row),a=Math.abs(e.bottomRight.row-t.bottomRight.row);return n<=1&&a<=1}function j(e){const t=[i.ye.UnsupportedAggregations,i.ye.HeaderColumns,i.ye.Crosstab,i.ye.MultipleHeaderRows,i.ye.EmptyHeaders,i.ye.DuplicateHeaders,i.ye.HasMergedCells];return e.sort((function(e,n){let a=t.indexOf(e),o=t.indexOf(n);return-1===a&&(a=t.length),-1===o&&(o=t.length),a-o}))}},161581:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getZeroedWebRuntimeMetrics=void 0,t.getZeroedWebRuntimeMetrics=function(){return{runtimeCreatedTime:0,iframeLoadedTime:0,loadCodeStartTime:0,loadCodeTotalMilliseconds:0,executeStartTime:0,executeEndTime:0,syncStarted:0,syncsPerformed:0,syncsOutstanding:0,totalSyncMilliseconds:0,nonundoableWritesSeen:0}}},163724:(e,t,n)=>{"use strict";async function a(){return await Promise.all([n.e("vendors-npm_store_sdx_officecopilot_typescript_5_0_4-007004e2f84938dc12ca_node_modules_typesc-351a83"),n.e("ts")]).then(n.t.bind(n,508479,23))}async function o(e){const t=await a(),n=t.ScriptTarget.ES2019,o=t.transpileModule(e,{reportDiagnostics:!0,compilerOptions:{target:n,lib:["dom","es2019"],allowJs:!0}});if(o.diagnostics.length){return{compileErrorMessage:o.diagnostics.map((t=>{const n=e.substr(0,t.start),a=e.substr(t.start+1),o=n.split("\n").length,r=n.lastIndexOf("\n"),i=e.substring(r,t.start+Math.max(a.indexOf("\n"),0)).trim();return function(e,t){return`Line #${e}: ${t}`}(o,`${t.messageText}\n ${i}`)})).join("\n\n")}}return{outputText:o.outputText.replace('Object.defineProperty(exports, "__esModule", { value: true });',"")}}n.d(t,{V:()=>s});var r=n(123551);function i(e){return e.map((({name:e,version:t})=>({name:e,version:t,support:Office.context.requirements.isSetSupported(e,t)})))}var l=n(719733);async function s(e,t,n,s){let c="";const d=function(e){if(e){const t=e.storageScript.apiInfo;return!!t&&JSON.parse(t).variant===l.MH}return!0}(t),u={apiInfo:t.storageScript.apiInfo,storageId:t.storageScript.id,cacheHit:!1,parentCallId:s};JSON.parse(JSON.stringify(n)).cachedVersion=3;try{c=d?await async function(e,t,n){const l=await(0,r.J)(),s=!1;let c;try{const r=e=>e;c=await l.transformSynchronousCodeForBatchExecutionLegacy(e,o,{logger:void 0,scan:s,getSetSupport:i,mergeOverride:r,...t});const d=await a();if(c.outputText){const a=(e,t)=>{const a=[1107,1123,1155,1157,1182,1184,1188,1232,1312,1344,2300,2364,2393,2451,2481,2792],o=d.getPreEmitDiagnostics(t);n.syntaxErrorCodes=JSON.stringify(o.map((e=>e.code)));const r=o.filter((e=>a.indexOf(e.code)>=0)).filter((e=>e.file));return l.diagnosticsToErrorMessage(e,r)},o=l.transformSynchronousCodeForBatchExecution(e,{logger:void 0,scan:s,getSetSupport:i,mergeOverride:r,syntaxOverride:a,...t});o.outputText||(c=o)}}catch(e){throw e}const{outputText:d,failureStage:u,failureMessage:m}=c;if(u&&m)throw new SyntaxError(m);if(d)return d;throw new SyntaxError("No Code")}(e,n,u):await async function(e){const t=await o(e),n=t.compileErrorMessage,a=t.outputText;if(n)throw new SyntaxError(n);if(a)return a;throw new SyntaxError("No Code")}(e)}catch(e){throw e.isCompileError=!0,e}return c}},164584:(e,t,n)=>{"use strict";n.d(t,{$q:()=>B,E:()=>D,UC:()=>P,V1:()=>F,jl:()=>N,qD:()=>O,s6:()=>M});var a=n(430459),o=n(695934),r=n(995747),i=n(749832),l=n(83437),s=n(207545),c=n(596498),d=n(69614),u=n(857677),m=n(76872),g=n(75496),h=n(316904),p=n(92520),b=n(225014),f=n(347145);const C="DefaultAugLoopSharedSessionID";let y,v,T,x="",S=0,w=0,E=()=>{};const I=(0,f.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.ExcelIncreaseCopilotCellLimit",!1),R=(0,f.Z8j)("Microsoft.Office.Excel.FA000000124.MaxAugloopRestartsToAllowModelWorkflows",2),A=(0,f.Z8j)("Microsoft.Office.Excel.FA000000124.AugloopRestartsTimeRangeInMs",12e4),L=e=>{const t=(0,b.wB)(e);return t.setSessionCloseCallback(k),t},k=e=>{(0,p.cY)("AugLoop session closing"),m.E.getInstance().updateTelemetryChatEventData({[u.h3.ChatEventType]:u.a5.AugLoopSessionClosed},h.M.getInstance()),y.close(),S=w&&_(w)<A?S+1:1,w=Date.now();let t=C;if(d.w9.typeGuard(e)&&e.reason&&d.pr.typeGuard(e.reason)&&e.reason.newDocSessionId)t=e.reason.newDocSessionId;else if(Office.context.platform!==Office.PlatformType.OfficeOnline){if(e.reason&&d.Zy.typeGuard(e.reason)&&"PermanentError"===e.reason?.reasonDescription)return void T();h.M.getInstance().logError({eventType:g.S2.Augloop,errorMessage:"AugLoop failed to provide the new docSessionId.",logLevel:l.$b.Warning})}if(Office.context.platform===Office.PlatformType.OfficeOnline||t!==C){y=L(t);let n=!1;if(e.reason&&o.G2.typeGuard(e.reason)){const t=e.reason;n=I?t.errorType===r.m.LargeWorkbooksNotSupported:t.errorType===r.m.ModelWorkflowNotSupported}const a=S>R;n=n||a,n&&m.E.getInstance().updateTelemetryChatEventData({[u.h3.ChatEventType]:u.a5.AugLoopSessionModelWorkflowUnsupported,[u.h3.ChatEventParameters]:JSON.stringify({restartLoopDetected:a})},h.M.getInstance()),E(y,n)}};const F=e=>{""===x&&(x=e)},_=e=>Date.now()-e,P=e=>{v=e},N=e=>{E=e},M=e=>{T=e},O=async()=>{if((0,p.cY)("getting AugLoop from host"),!y){if((0,p.cY)("sdxAugLoopSession does not exist, creating a new one"),i.V.IsSettingTrue(i.z.ButtonEnabledForLocalFiles)){if(""===x)return(0,f.R$m)()?Promise.resolve(void 0):Promise.reject(new Error("getAugLoopSessionFromHost called before DocSessionID provided by host"));y=L(x)}else{const e=i.V.getSettingAsString(i.z.AugloopSharedSessionID);y=L(e??C)}if(await v(y),(0,f.KV_)()&&(0,f.yw9)("OfficeVSO_10454920_AugloopSessionPolling")){const e=1e4,t=Date.now();for(;Date.now()-t<e&&!y.getConnectParams()?.routingSessionKey;){const e=Date.now()-t;h.M.getInstance().logError({eventType:g.S2.Augloop,errorMessage:`routingSessionKey not available (${e}ms)`,logLevel:l.$b.Warning}),await new Promise((e=>setTimeout(e,1e3)))}}(0,f.yw9)("OfficeVSO_9503894_AugloopDiagnosticsPane")&&(0,s.I_)()&&a.$.getInstance().init(y)}return y},D=e=>void 0===e?"undefined":c.h.getTypeNameFor(e),B=()=>i.V.IsSettingTrue(i.z.AugloopEverHadModelError)},164976:(e,t,n)=>{"use strict";n.d(t,{IM:()=>d,np:()=>c,Av:()=>u});var a=n(83437),o=n(75496),r=n(316904),i=n(92520),l=n(468967);function s(e){return null==e||("string"==typeof e||"number"==typeof e||"boolean"==typeof e||(Array.isArray(e)?e.every(s):"object"==typeof e&&null!==e&&(Object.keys(e).every((e=>"string"==typeof e))&&Object.values(e).every(s))))}function c(e,t,n,o){switch(e){case"CodeAndPostView":case"PythonStartAnalysis_V1":case"PythonStartAnalysisButtonExperiment_V1":case"PythonAdaRecommendation_V1":case"PythonCalculatedColumn_V1":(0,l.$n)(n,!1,o);break;case"ModelessOutput":case"PythonMergedCard_V1":(0,l.$n)(n,!0,o);break;default:r.M.getInstance().logError({eventType:t,errorMessage:n,logLevel:a.$b.ASHA})}}function d(e,t){if((0,i.cY)(`customSerializableRenderer(${e})`,t),!s(t)){const n=`Props for ${e} are not serializable, therefore we cannot save them in the chat history and rehydrate the chat.`;c(e,o.S2.Error,n,t),(0,i.cY)(n)}return{component:e,props:t}}function u(e,t,n,a){if(!s(n)||!s(t)){c(e,a,`Props used to update ${e} are not serializable, therefore we cannot save them in the chat history and rehydrate the chat.`,t)}return{component:e,props:{...t,...n}}}},166840:(e,t,n)=>{"use strict";n.d(t,{rc:()=>p});var a=n(83437),o=n(472096),r=n(75496),i=n(316904),l=n(359730),s=n(705147),c=n(347145),d=n(312422);let u=!1;const m=new Map;var g;!function(e){e.LoadCalledWithoutWaiting="LoadCalledWithoutWaiting",e.QueryRefreshSuccess="QueryRefreshSuccess",e.QueryRefreshFailure="QueryRefreshFailure",e.QueryStillPending="QueryStillPending",e.CalledWhileSameQueryPending="CalledWhileSameQueryPending",e.InternalError="InternalError",e.AuthenticateRefreshDisabled="AuthenticateRefreshDisabled"}(g||(g={}));const h=async e=>{const t=Array.from(m).find((([t,n])=>n.exactQueryNameMatch?t===e.queryName:e.queryName.includes(t)))?.[1];i.M.getInstance().logEvent({eventType:r.S2.PowerQueryHelper,eventData:[{key:r.E_.Event,value:"onQueryRefreshCompleted"},{key:r.E_.QueryId,value:t?.queryId?t.queryId:"N/A"},{key:r.E_.Success,value:e.success.toString()},{key:r.E_.FoundCallback,value:(!!t).toString()},{key:r.E_.Duration,value:t?(performance.now()-t.startTime).toString():"N/A"}]}),t&&(e.success?t.callback(t.queryName,"QueryRefreshSuccess"):t.callback(t.queryName,"QueryRefreshFailure"))};async function p(e,t,n=!1,g){return Excel.run((async p=>await(0,d.F5)((async d=>{let p;const b=(0,c.Z8j)("Microsoft.Office.Excel.FA000000124.MaxTimeWaitingForLoadQueryCallback",3e3);n&&(p=async function(e,t,n,l){m.has(e)&&i.M.getInstance().logError({errorMessage:"waitForRefreshToCompleteWithTimeout Called while same query is pending",eventType:r.S2.PowerQueryHelper,logLevel:a.$b.Error});if((0,o.QK)()&&!(0,c.iPS)("Microsoft.Office.Excel.FA000000124.PowerQueryAuthenticateRefresh",!1))return"AuthenticateRefreshDisabled";const d=(0,s.p)(),g=setTimeout((()=>{d.resolve("QueryStillPending")}),t);return function(e,t,n,a){u||(n.workbook.queries.onQueryRefreshCompleted.add(h),u=!0);const o=!1;m.set(e,{startTime:performance.now(),queryId:a,queryName:e,exactQueryNameMatch:o,callback:t})}(e,((e,t)=>{clearTimeout(g),d.resolve(t)}),n,l),d.promise}(t,b,d,g));const f=d.workbook.queries.loadQuery(t,e,Excel.PowerQueryObjectType.table);d.load(f),await d.sync();const C=f.name;n&&function(e,t){const n=m.get(e);n&&(m.delete(e),m.set(t,{...n,exactQueryNameMatch:!0,queryName:t}))}(t,C);const y=d.workbook.worksheets.getItem(C);if(await d.sync(),y){const e=(0,l.x)(d,y);await e()(d),await d.sync()}return p??"LoadCalledWithoutWaiting"}))))}},176664:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var a=n(252163);function o(){return(0,a.P)("AudienceGroup")}},177115:(e,t,n)=>{"use strict";n.d(t,{Gr:()=>r,Y:()=>i,iN:()=>s,oO:()=>l});let a="",o="";function r(e){a=e}function i(){return a}function l(e){o=e}function s(){return o}},177551:(e,t,n)=>{"use strict";var a=n(758651),o=n(208520),r=n(223401),i=n(340847);function l(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!o)throw Error(l(227));var s=new Set,c={};function d(e,t){u(e,t),u(e+"Capture",t)}function u(e,t){for(c[e]=t,e=0;e<t.length;e++)s.add(t[e])}var m=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),g=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h=Object.prototype.hasOwnProperty,p={},b={};function f(e,t,n,a,o,r,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=a,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=r,this.removeEmptyString=i}var C={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){C[e]=new f(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];C[t]=new f(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){C[e]=new f(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){C[e]=new f(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){C[e]=new f(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){C[e]=new f(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){C[e]=new f(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){C[e]=new f(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){C[e]=new f(e,5,!1,e.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function T(e,t,n,a){var o=C.hasOwnProperty(t)?C[t]:null;(null!==o?0===o.type:!a&&(2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1])))||(function(e,t,n,a){if(null==t||function(e,t,n,a){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!a&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,a))return!0;if(a)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,o,a)&&(n=null),a||null===o?function(e){return!!h.call(b,e)||!h.call(p,e)&&(g.test(e)?b[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=null===n?3!==o.type&&"":n:(t=o.attributeName,a=o.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(o=o.type)||4===o&&!0===n?"":""+n,a?e.setAttributeNS(a,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(y,v);C[t]=new f(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(y,v);C[t]=new f(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(y,v);C[t]=new f(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){C[e]=new f(e,1,!1,e.toLowerCase(),null,!1,!1)})),C.xlinkHref=new f("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){C[e]=new f(e,1,!1,e.toLowerCase(),null,!0,!0)}));var x=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,S=60103,w=60106,E=60107,I=60108,R=60114,A=60109,L=60110,k=60112,F=60113,_=60120,P=60115,N=60116,M=60121,O=60128,D=60129,B=60130,$=60131;if("function"==typeof Symbol&&Symbol.for){var H=Symbol.for;S=H("react.element"),w=H("react.portal"),E=H("react.fragment"),I=H("react.strict_mode"),R=H("react.profiler"),A=H("react.provider"),L=H("react.context"),k=H("react.forward_ref"),F=H("react.suspense"),_=H("react.suspense_list"),P=H("react.memo"),N=H("react.lazy"),M=H("react.block"),H("react.scope"),O=H("react.opaque.id"),D=H("react.debug_trace_mode"),B=H("react.offscreen"),$=H("react.legacy_hidden")}var U,q="function"==typeof Symbol&&Symbol.iterator;function V(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=q&&e[q]||e["@@iterator"])?e:null}function W(e){if(void 0===U)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);U=t&&t[1]||""}return"\n"+U+e}var G=!1;function z(e,t){if(!e||G)return"";G=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var a=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){a=e}e.call(t.prototype)}else{try{throw Error()}catch(e){a=e}e()}}catch(e){if(e&&a&&"string"==typeof e.stack){for(var o=e.stack.split("\n"),r=a.stack.split("\n"),i=o.length-1,l=r.length-1;1<=i&&0<=l&&o[i]!==r[l];)l--;for(;1<=i&&0<=l;i--,l--)if(o[i]!==r[l]){if(1!==i||1!==l)do{if(i--,0>--l||o[i]!==r[l])return"\n"+o[i].replace(" at new "," at ")}while(1<=i&&0<=l);break}}}finally{G=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?W(e):""}function Q(e){switch(e.tag){case 5:return W(e.type);case 16:return W("Lazy");case 13:return W("Suspense");case 19:return W("SuspenseList");case 0:case 2:case 15:return e=z(e.type,!1);case 11:return e=z(e.type.render,!1);case 22:return e=z(e.type._render,!1);case 1:return e=z(e.type,!0);default:return""}}function j(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case E:return"Fragment";case w:return"Portal";case R:return"Profiler";case I:return"StrictMode";case F:return"Suspense";case _:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case L:return(e.displayName||"Context")+".Consumer";case A:return(e._context.displayName||"Context")+".Provider";case k:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case P:return j(e.type);case M:return j(e._render);case N:t=e._payload,e=e._init;try{return j(e(t))}catch(e){}}return null}function J(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function Y(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function X(e){e._valueTracker||(e._valueTracker=function(e){var t=Y(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),a=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var o=n.get,r=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(e){a=""+e,r.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return a},setValue:function(e){a=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Z(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),a="";return e&&(a=Y(e)?e.checked?"true":"false":e.value),(e=a)!==n&&(t.setValue(e),!0)}function K(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function ee(e,t){var n=t.checked;return r({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function te(e,t){var n=null==t.defaultValue?"":t.defaultValue,a=null!=t.checked?t.checked:t.defaultChecked;n=J(null!=t.value?t.value:n),e._wrapperState={initialChecked:a,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function ne(e,t){null!=(t=t.checked)&&T(e,"checked",t,!1)}function ae(e,t){ne(e,t);var n=J(t.value),a=t.type;if(null!=n)"number"===a?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===a||"reset"===a)return void e.removeAttribute("value");t.hasOwnProperty("value")?re(e,t.type,n):t.hasOwnProperty("defaultValue")&&re(e,t.type,J(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function oe(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var a=t.type;if(!("submit"!==a&&"reset"!==a||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function re(e,t,n){"number"===t&&K(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}function ie(e,t){return e=r({children:void 0},t),(t=function(e){var t="";return o.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(t.children))&&(e.children=t),e}function le(e,t,n,a){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&a&&(e[n].defaultSelected=!0)}else{for(n=""+J(n),t=null,o=0;o<e.length;o++){if(e[o].value===n)return e[o].selected=!0,void(a&&(e[o].defaultSelected=!0));null!==t||e[o].disabled||(t=e[o])}null!==t&&(t.selected=!0)}}function se(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(l(91));return r({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ce(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(l(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(l(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:J(n)}}function de(e,t){var n=J(t.value),a=J(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=a&&(e.defaultValue=""+a)}function ue(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}var me="http://www.w3.org/1999/xhtml",ge="http://www.w3.org/2000/svg";function he(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pe(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?he(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var be,fe,Ce=(fe=function(e,t){if(e.namespaceURI!==ge||"innerHTML"in e)e.innerHTML=t;else{for((be=be||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=be.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,a){MSApp.execUnsafeLocalFunction((function(){return fe(e,t)}))}:fe);function ye(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var ve={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Te=["Webkit","ms","Moz","O"];function xe(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||ve.hasOwnProperty(e)&&ve[e]?(""+t).trim():t+"px"}function Se(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var a=0===n.indexOf("--"),o=xe(n,t[n],a);"float"===n&&(n="cssFloat"),a?e.setProperty(n,o):e[n]=o}}Object.keys(ve).forEach((function(e){Te.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ve[t]=ve[e]}))}));var we=r({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ee(e,t){if(t){if(we[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(l(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(l(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(l(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(l(62))}}function Ie(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function Re(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ae=null,Le=null,ke=null;function Fe(e){if(e=oo(e)){if("function"!=typeof Ae)throw Error(l(280));var t=e.stateNode;t&&(t=io(t),Ae(e.stateNode,e.type,t))}}function _e(e){Le?ke?ke.push(e):ke=[e]:Le=e}function Pe(){if(Le){var e=Le,t=ke;if(ke=Le=null,Fe(e),t)for(e=0;e<t.length;e++)Fe(t[e])}}function Ne(e,t){return e(t)}function Me(e,t,n,a,o){return e(t,n,a,o)}function Oe(){}var De=Ne,Be=!1,$e=!1;function He(){null===Le&&null===ke||(Oe(),Pe())}function Ue(e,t){var n=e.stateNode;if(null===n)return null;var a=io(n);if(null===a)return null;n=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(a=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!a;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(l(231,t,typeof n));return n}var qe=!1;if(m)try{var Ve={};Object.defineProperty(Ve,"passive",{get:function(){qe=!0}}),window.addEventListener("test",Ve,Ve),window.removeEventListener("test",Ve,Ve)}catch(fe){qe=!1}function We(e,t,n,a,o,r,i,l,s){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(e){this.onError(e)}}var Ge=!1,ze=null,Qe=!1,je=null,Je={onError:function(e){Ge=!0,ze=e}};function Ye(e,t,n,a,o,r,i,l,s){Ge=!1,ze=null,We.apply(Je,arguments)}function Xe(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(1026&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ze(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ke(e){if(Xe(e)!==e)throw Error(l(188))}function et(e){if(e=function(e){var t=e.alternate;if(!t){if(null===(t=Xe(e)))throw Error(l(188));return t!==e?null:e}for(var n=e,a=t;;){var o=n.return;if(null===o)break;var r=o.alternate;if(null===r){if(null!==(a=o.return)){n=a;continue}break}if(o.child===r.child){for(r=o.child;r;){if(r===n)return Ke(o),e;if(r===a)return Ke(o),t;r=r.sibling}throw Error(l(188))}if(n.return!==a.return)n=o,a=r;else{for(var i=!1,s=o.child;s;){if(s===n){i=!0,n=o,a=r;break}if(s===a){i=!0,a=o,n=r;break}s=s.sibling}if(!i){for(s=r.child;s;){if(s===n){i=!0,n=r,a=o;break}if(s===a){i=!0,a=r,n=o;break}s=s.sibling}if(!i)throw Error(l(189))}}if(n.alternate!==a)throw Error(l(190))}if(3!==n.tag)throw Error(l(188));return n.stateNode.current===n?e:t}(e),!e)return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function tt(e,t){for(var n=e.alternate;null!==t;){if(t===e||t===n)return!0;t=t.return}return!1}var nt,at,ot,rt,it=!1,lt=[],st=null,ct=null,dt=null,ut=new Map,mt=new Map,gt=[],ht="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function pt(e,t,n,a,o){return{blockedOn:e,domEventName:t,eventSystemFlags:16|n,nativeEvent:o,targetContainers:[a]}}function bt(e,t){switch(e){case"focusin":case"focusout":st=null;break;case"dragenter":case"dragleave":ct=null;break;case"mouseover":case"mouseout":dt=null;break;case"pointerover":case"pointerout":ut.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":mt.delete(t.pointerId)}}function ft(e,t,n,a,o,r){return null===e||e.nativeEvent!==r?(e=pt(t,n,a,o,r),null!==t&&(null!==(t=oo(t))&&at(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,null!==o&&-1===t.indexOf(o)&&t.push(o),e)}function Ct(e){var t=ao(e.target);if(null!==t){var n=Xe(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ze(n)))return e.blockedOn=t,void rt(e.lanePriority,(function(){i.unstable_runWithPriority(e.priority,(function(){ot(n)}))}))}else if(3===t&&n.stateNode.hydrate)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function yt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=en(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=oo(n))&&at(t),e.blockedOn=n,!1;t.shift()}return!0}function vt(e,t,n){yt(e)&&n.delete(t)}function Tt(){for(it=!1;0<lt.length;){var e=lt[0];if(null!==e.blockedOn){null!==(e=oo(e.blockedOn))&&nt(e);break}for(var t=e.targetContainers;0<t.length;){var n=en(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n){e.blockedOn=n;break}t.shift()}null===e.blockedOn&&lt.shift()}null!==st&&yt(st)&&(st=null),null!==ct&&yt(ct)&&(ct=null),null!==dt&&yt(dt)&&(dt=null),ut.forEach(vt),mt.forEach(vt)}function xt(e,t){e.blockedOn===t&&(e.blockedOn=null,it||(it=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Tt)))}function St(e){function t(t){return xt(t,e)}if(0<lt.length){xt(lt[0],e);for(var n=1;n<lt.length;n++){var a=lt[n];a.blockedOn===e&&(a.blockedOn=null)}}for(null!==st&&xt(st,e),null!==ct&&xt(ct,e),null!==dt&&xt(dt,e),ut.forEach(t),mt.forEach(t),n=0;n<gt.length;n++)(a=gt[n]).blockedOn===e&&(a.blockedOn=null);for(;0<gt.length&&null===(n=gt[0]).blockedOn;)Ct(n),null===n.blockedOn&&gt.shift()}function wt(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Et={animationend:wt("Animation","AnimationEnd"),animationiteration:wt("Animation","AnimationIteration"),animationstart:wt("Animation","AnimationStart"),transitionend:wt("Transition","TransitionEnd")},It={},Rt={};function At(e){if(It[e])return It[e];if(!Et[e])return e;var t,n=Et[e];for(t in n)if(n.hasOwnProperty(t)&&t in Rt)return It[e]=n[t];return e}m&&(Rt=document.createElement("div").style,"AnimationEvent"in window||(delete Et.animationend.animation,delete Et.animationiteration.animation,delete Et.animationstart.animation),"TransitionEvent"in window||delete Et.transitionend.transition);var Lt=At("animationend"),kt=At("animationiteration"),Ft=At("animationstart"),_t=At("transitionend"),Pt=new Map,Nt=new Map,Mt=["abort","abort",Lt,"animationEnd",kt,"animationIteration",Ft,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",_t,"transitionEnd","waiting","waiting"];function Ot(e,t){for(var n=0;n<e.length;n+=2){var a=e[n],o=e[n+1];o="on"+(o[0].toUpperCase()+o.slice(1)),Nt.set(a,t),Pt.set(a,o),d(o,[a])}}(0,i.unstable_now)();var Dt=8;function Bt(e){if(1&e)return Dt=15,1;if(2&e)return Dt=14,2;if(4&e)return Dt=13,4;var t=24&e;return 0!==t?(Dt=12,t):32&e?(Dt=11,32):0!==(t=192&e)?(Dt=10,t):256&e?(Dt=9,256):0!==(t=3584&e)?(Dt=8,t):4096&e?(Dt=7,4096):0!==(t=4186112&e)?(Dt=6,t):0!==(t=62914560&e)?(Dt=5,t):67108864&e?(Dt=4,67108864):134217728&e?(Dt=3,134217728):0!==(t=805306368&e)?(Dt=2,t):1073741824&e?(Dt=1,1073741824):(Dt=8,e)}function $t(e,t){var n=e.pendingLanes;if(0===n)return Dt=0;var a=0,o=0,r=e.expiredLanes,i=e.suspendedLanes,l=e.pingedLanes;if(0!==r)a=r,o=Dt=15;else if(0!==(r=134217727&n)){var s=r&~i;0!==s?(a=Bt(s),o=Dt):0!==(l&=r)&&(a=Bt(l),o=Dt)}else 0!==(r=n&~i)?(a=Bt(r),o=Dt):0!==l&&(a=Bt(l),o=Dt);if(0===a)return 0;if(a=n&((0>(a=31-Gt(a))?0:1<<a)<<1)-1,0!==t&&t!==a&&0===(t&i)){if(Bt(t),o<=Dt)return t;Dt=o}if(0!==(t=e.entangledLanes))for(e=e.entanglements,t&=a;0<t;)o=1<<(n=31-Gt(t)),a|=e[n],t&=~o;return a}function Ht(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function Ut(e,t){switch(e){case 15:return 1;case 14:return 2;case 12:return 0===(e=qt(24&~t))?Ut(10,t):e;case 10:return 0===(e=qt(192&~t))?Ut(8,t):e;case 8:return 0===(e=qt(3584&~t))&&(0===(e=qt(4186112&~t))&&(e=512)),e;case 2:return 0===(t=qt(805306368&~t))&&(t=268435456),t}throw Error(l(358,e))}function qt(e){return e&-e}function Vt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Wt(e,t,n){e.pendingLanes|=t;var a=t-1;e.suspendedLanes&=a,e.pingedLanes&=a,(e=e.eventTimes)[t=31-Gt(t)]=n}var Gt=Math.clz32?Math.clz32:function(e){return 0===e?32:31-(zt(e)/Qt|0)|0},zt=Math.log,Qt=Math.LN2;var jt=i.unstable_UserBlockingPriority,Jt=i.unstable_runWithPriority,Yt=!0;function Xt(e,t,n,a){Be||Oe();var o=Kt,r=Be;Be=!0;try{Me(o,e,t,n,a)}finally{(Be=r)||He()}}function Zt(e,t,n,a){Jt(jt,Kt.bind(null,e,t,n,a))}function Kt(e,t,n,a){var o;if(Yt)if((o=!(4&t))&&0<lt.length&&-1<ht.indexOf(e))e=pt(null,e,t,n,a),lt.push(e);else{var r=en(e,t,n,a);if(null===r)o&&bt(e,a);else{if(o){if(-1<ht.indexOf(e))return e=pt(r,e,t,n,a),void lt.push(e);if(function(e,t,n,a,o){switch(t){case"focusin":return st=ft(st,e,t,n,a,o),!0;case"dragenter":return ct=ft(ct,e,t,n,a,o),!0;case"mouseover":return dt=ft(dt,e,t,n,a,o),!0;case"pointerover":var r=o.pointerId;return ut.set(r,ft(ut.get(r)||null,e,t,n,a,o)),!0;case"gotpointercapture":return r=o.pointerId,mt.set(r,ft(mt.get(r)||null,e,t,n,a,o)),!0}return!1}(r,e,t,n,a))return;bt(e,a)}Oa(e,t,a,null,n)}}}function en(e,t,n,a){var o=Re(a);if(null!==(o=ao(o))){var r=Xe(o);if(null===r)o=null;else{var i=r.tag;if(13===i){if(null!==(o=Ze(r)))return o;o=null}else if(3===i){if(r.stateNode.hydrate)return 3===r.tag?r.stateNode.containerInfo:null;o=null}else r!==o&&(o=null)}}return Oa(e,t,a,o,n),null}var tn=null,nn=null,an=null;function on(){if(an)return an;var e,t,n=nn,a=n.length,o="value"in tn?tn.value:tn.textContent,r=o.length;for(e=0;e<a&&n[e]===o[e];e++);var i=a-e;for(t=1;t<=i&&n[a-t]===o[r-t];t++);return an=o.slice(e,1<t?1-t:void 0)}function rn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function ln(){return!0}function sn(){return!1}function cn(e){function t(t,n,a,o,r){for(var i in this._reactName=t,this._targetInst=a,this.type=n,this.nativeEvent=o,this.target=r,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(o):o[i]);return this.isDefaultPrevented=(null!=o.defaultPrevented?o.defaultPrevented:!1===o.returnValue)?ln:sn,this.isPropagationStopped=sn,this}return r(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=ln)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=ln)},persist:function(){},isPersistent:ln}),t}var dn,un,mn,gn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hn=cn(gn),pn=r({},gn,{view:0,detail:0}),bn=cn(pn),fn=r({},pn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ln,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==mn&&(mn&&"mousemove"===e.type?(dn=e.screenX-mn.screenX,un=e.screenY-mn.screenY):un=dn=0,mn=e),dn)},movementY:function(e){return"movementY"in e?e.movementY:un}}),Cn=cn(fn),yn=cn(r({},fn,{dataTransfer:0})),vn=cn(r({},pn,{relatedTarget:0})),Tn=cn(r({},gn,{animationName:0,elapsedTime:0,pseudoElement:0})),xn=r({},gn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Sn=cn(xn),wn=cn(r({},gn,{data:0})),En={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},In={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Rn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function An(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Rn[e])&&!!t[e]}function Ln(){return An}var kn=r({},pn,{key:function(e){if(e.key){var t=En[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=rn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?In[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ln,charCode:function(e){return"keypress"===e.type?rn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?rn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Fn=cn(kn),_n=cn(r({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Pn=cn(r({},pn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ln})),Nn=cn(r({},gn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Mn=r({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),On=cn(Mn),Dn=[9,13,27,32],Bn=m&&"CompositionEvent"in window,$n=null;m&&"documentMode"in document&&($n=document.documentMode);var Hn=m&&"TextEvent"in window&&!$n,Un=m&&(!Bn||$n&&8<$n&&11>=$n),qn=String.fromCharCode(32),Vn=!1;function Wn(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Gn(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var zn=!1;var Qn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Qn[e.type]:"textarea"===t}function Jn(e,t,n,a){_e(a),0<(t=Ba(t,"onChange")).length&&(n=new hn("onChange","change",null,n,a),e.push({event:n,listeners:t}))}var Yn=null,Xn=null;function Zn(e){ka(e,0)}function Kn(e){if(Z(ro(e)))return e}function ea(e,t){if("change"===e)return t}var ta=!1;if(m){var na;if(m){var aa="oninput"in document;if(!aa){var oa=document.createElement("div");oa.setAttribute("oninput","return;"),aa="function"==typeof oa.oninput}na=aa}else na=!1;ta=na&&(!document.documentMode||9<document.documentMode)}function ra(){Yn&&(Yn.detachEvent("onpropertychange",ia),Xn=Yn=null)}function ia(e){if("value"===e.propertyName&&Kn(Xn)){var t=[];if(Jn(t,Xn,e,Re(e)),e=Zn,Be)e(t);else{Be=!0;try{Ne(e,t)}finally{Be=!1,He()}}}}function la(e,t,n){"focusin"===e?(ra(),Xn=n,(Yn=t).attachEvent("onpropertychange",ia)):"focusout"===e&&ra()}function sa(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Kn(Xn)}function ca(e,t){if("click"===e)return Kn(t)}function da(e,t){if("input"===e||"change"===e)return Kn(t)}var ua="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},ma=Object.prototype.hasOwnProperty;function ga(e,t){if(ua(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(a=0;a<n.length;a++)if(!ma.call(t,n[a])||!ua(e[n[a]],t[n[a]]))return!1;return!0}function ha(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function pa(e,t){var n,a=ha(e);for(e=0;a;){if(3===a.nodeType){if(n=e+a.textContent.length,e<=t&&n>=t)return{node:a,offset:t-e};e=n}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=ha(a)}}function ba(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ba(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function fa(){for(var e=window,t=K();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(e){n=!1}if(!n)break;t=K((e=t.contentWindow).document)}return t}function Ca(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var ya=m&&"documentMode"in document&&11>=document.documentMode,va=null,Ta=null,xa=null,Sa=!1;function wa(e,t,n){var a=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;Sa||null==va||va!==K(a)||("selectionStart"in(a=va)&&Ca(a)?a={start:a.selectionStart,end:a.selectionEnd}:a={anchorNode:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset},xa&&ga(xa,a)||(xa=a,0<(a=Ba(Ta,"onSelect")).length&&(t=new hn("onSelect","select",null,t,n),e.push({event:t,listeners:a}),t.target=va)))}Ot("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),Ot("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),Ot(Mt,2);for(var Ea="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),Ia=0;Ia<Ea.length;Ia++)Nt.set(Ea[Ia],0);u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),d("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),d("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),d("onBeforeInput",["compositionend","keypress","textInput","paste"]),d("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),d("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),d("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ra="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Aa=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ra));function La(e,t,n){var a=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,a,o,r,i,s,c){if(Ye.apply(this,arguments),Ge){if(!Ge)throw Error(l(198));var d=ze;Ge=!1,ze=null,Qe||(Qe=!0,je=d)}}(a,t,void 0,e),e.currentTarget=null}function ka(e,t){t=!!(4&t);for(var n=0;n<e.length;n++){var a=e[n],o=a.event;a=a.listeners;e:{var r=void 0;if(t)for(var i=a.length-1;0<=i;i--){var l=a[i],s=l.instance,c=l.currentTarget;if(l=l.listener,s!==r&&o.isPropagationStopped())break e;La(o,l,c),r=s}else for(i=0;i<a.length;i++){if(s=(l=a[i]).instance,c=l.currentTarget,l=l.listener,s!==r&&o.isPropagationStopped())break e;La(o,l,c),r=s}}}if(Qe)throw e=je,Qe=!1,je=null,e}function Fa(e,t){var n=lo(t),a=e+"__bubble";n.has(a)||(Ma(t,e,2,!1),n.add(a))}var _a="_reactListening"+Math.random().toString(36).slice(2);function Pa(e){e[_a]||(e[_a]=!0,s.forEach((function(t){Aa.has(t)||Na(t,!1,e,null),Na(t,!0,e,null)})))}function Na(e,t,n,a){var o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,r=n;if("selectionchange"===e&&9!==n.nodeType&&(r=n.ownerDocument),null!==a&&!t&&Aa.has(e)){if("scroll"!==e)return;o|=2,r=a}var i=lo(r),l=e+"__"+(t?"capture":"bubble");i.has(l)||(t&&(o|=4),Ma(r,e,o,t),i.add(l))}function Ma(e,t,n,a){var o=Nt.get(t);switch(void 0===o?2:o){case 0:o=Xt;break;case 1:o=Zt;break;default:o=Kt}n=o.bind(null,t,n,e),o=void 0,!qe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(o=!0),a?void 0!==o?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):void 0!==o?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function Oa(e,t,n,a,o){var r=a;if(!(1&t||2&t||null===a))e:for(;;){if(null===a)return;var i=a.tag;if(3===i||4===i){var l=a.stateNode.containerInfo;if(l===o||8===l.nodeType&&l.parentNode===o)break;if(4===i)for(i=a.return;null!==i;){var s=i.tag;if((3===s||4===s)&&((s=i.stateNode.containerInfo)===o||8===s.nodeType&&s.parentNode===o))return;i=i.return}for(;null!==l;){if(null===(i=ao(l)))return;if(5===(s=i.tag)||6===s){a=r=i;continue e}l=l.parentNode}}a=a.return}!function(e,t,n){if($e)return e(t,n);$e=!0;try{return De(e,t,n)}finally{$e=!1,He()}}((function(){var a=r,o=Re(n),i=[];e:{var l=Pt.get(e);if(void 0!==l){var s=hn,c=e;switch(e){case"keypress":if(0===rn(n))break e;case"keydown":case"keyup":s=Fn;break;case"focusin":c="focus",s=vn;break;case"focusout":c="blur",s=vn;break;case"beforeblur":case"afterblur":s=vn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":s=Cn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":s=yn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":s=Pn;break;case Lt:case kt:case Ft:s=Tn;break;case _t:s=Nn;break;case"scroll":s=bn;break;case"wheel":s=On;break;case"copy":case"cut":case"paste":s=Sn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":s=_n}var d=!!(4&t),u=!d&&"scroll"===e,m=d?null!==l?l+"Capture":null:l;d=[];for(var g,h=a;null!==h;){var p=(g=h).stateNode;if(5===g.tag&&null!==p&&(g=p,null!==m&&(null!=(p=Ue(h,m))&&d.push(Da(h,p,g)))),u)break;h=h.return}0<d.length&&(l=new s(l,c,null,n,o),i.push({event:l,listeners:d}))}}if(!(7&t)){if(s="mouseout"===e||"pointerout"===e,(!(l="mouseover"===e||"pointerover"===e)||16&t||!(c=n.relatedTarget||n.fromElement)||!ao(c)&&!c[to])&&(s||l)&&(l=o.window===o?o:(l=o.ownerDocument)?l.defaultView||l.parentWindow:window,s?(s=a,null!==(c=(c=n.relatedTarget||n.toElement)?ao(c):null)&&(c!==(u=Xe(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(s=null,c=a),s!==c)){if(d=Cn,p="onMouseLeave",m="onMouseEnter",h="mouse","pointerout"!==e&&"pointerover"!==e||(d=_n,p="onPointerLeave",m="onPointerEnter",h="pointer"),u=null==s?l:ro(s),g=null==c?l:ro(c),(l=new d(p,h+"leave",s,n,o)).target=u,l.relatedTarget=g,p=null,ao(o)===a&&((d=new d(m,h+"enter",c,n,o)).target=g,d.relatedTarget=u,p=d),u=p,s&&c)e:{for(m=c,h=0,g=d=s;g;g=$a(g))h++;for(g=0,p=m;p;p=$a(p))g++;for(;0<h-g;)d=$a(d),h--;for(;0<g-h;)m=$a(m),g--;for(;h--;){if(d===m||null!==m&&d===m.alternate)break e;d=$a(d),m=$a(m)}d=null}else d=null;null!==s&&Ha(i,l,s,d,!1),null!==c&&null!==u&&Ha(i,u,c,d,!0)}if("select"===(s=(l=a?ro(a):window).nodeName&&l.nodeName.toLowerCase())||"input"===s&&"file"===l.type)var b=ea;else if(jn(l))if(ta)b=da;else{b=sa;var f=la}else(s=l.nodeName)&&"input"===s.toLowerCase()&&("checkbox"===l.type||"radio"===l.type)&&(b=ca);switch(b&&(b=b(e,a))?Jn(i,b,n,o):(f&&f(e,l,a),"focusout"===e&&(f=l._wrapperState)&&f.controlled&&"number"===l.type&&re(l,"number",l.value)),f=a?ro(a):window,e){case"focusin":(jn(f)||"true"===f.contentEditable)&&(va=f,Ta=a,xa=null);break;case"focusout":xa=Ta=va=null;break;case"mousedown":Sa=!0;break;case"contextmenu":case"mouseup":case"dragend":Sa=!1,wa(i,n,o);break;case"selectionchange":if(ya)break;case"keydown":case"keyup":wa(i,n,o)}var C;if(Bn)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else zn?Wn(e,n)&&(y="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(y="onCompositionStart");y&&(Un&&"ko"!==n.locale&&(zn||"onCompositionStart"!==y?"onCompositionEnd"===y&&zn&&(C=on()):(nn="value"in(tn=o)?tn.value:tn.textContent,zn=!0)),0<(f=Ba(a,y)).length&&(y=new wn(y,e,null,n,o),i.push({event:y,listeners:f}),C?y.data=C:null!==(C=Gn(n))&&(y.data=C))),(C=Hn?function(e,t){switch(e){case"compositionend":return Gn(t);case"keypress":return 32!==t.which?null:(Vn=!0,qn);case"textInput":return(e=t.data)===qn&&Vn?null:e;default:return null}}(e,n):function(e,t){if(zn)return"compositionend"===e||!Bn&&Wn(e,t)?(e=on(),an=nn=tn=null,zn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Un&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(a=Ba(a,"onBeforeInput")).length&&(o=new wn("onBeforeInput","beforeinput",null,n,o),i.push({event:o,listeners:a}),o.data=C))}ka(i,t)}))}function Da(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Ba(e,t){for(var n=t+"Capture",a=[];null!==e;){var o=e,r=o.stateNode;5===o.tag&&null!==r&&(o=r,null!=(r=Ue(e,n))&&a.unshift(Da(e,r,o)),null!=(r=Ue(e,t))&&a.push(Da(e,r,o))),e=e.return}return a}function $a(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Ha(e,t,n,a,o){for(var r=t._reactName,i=[];null!==n&&n!==a;){var l=n,s=l.alternate,c=l.stateNode;if(null!==s&&s===a)break;5===l.tag&&null!==c&&(l=c,o?null!=(s=Ue(n,r))&&i.unshift(Da(n,s,l)):o||null!=(s=Ue(n,r))&&i.push(Da(n,s,l))),n=n.return}0!==i.length&&e.push({event:t,listeners:i})}function Ua(){}var qa=null,Va=null;function Wa(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function Ga(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var za="function"==typeof setTimeout?setTimeout:void 0,Qa="function"==typeof clearTimeout?clearTimeout:void 0;function ja(e){1===e.nodeType?e.textContent="":9===e.nodeType&&(null!=(e=e.body)&&(e.textContent=""))}function Ja(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break}return e}function Ya(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var Xa=0;var Za=Math.random().toString(36).slice(2),Ka="__reactFiber$"+Za,eo="__reactProps$"+Za,to="__reactContainer$"+Za,no="__reactEvents$"+Za;function ao(e){var t=e[Ka];if(t)return t;for(var n=e.parentNode;n;){if(t=n[to]||n[Ka]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Ya(e);null!==e;){if(n=e[Ka])return n;e=Ya(e)}return t}n=(e=n).parentNode}return null}function oo(e){return!(e=e[Ka]||e[to])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function ro(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(l(33))}function io(e){return e[eo]||null}function lo(e){var t=e[no];return void 0===t&&(t=e[no]=new Set),t}var so=[],co=-1;function uo(e){return{current:e}}function mo(e){0>co||(e.current=so[co],so[co]=null,co--)}function go(e,t){co++,so[co]=e.current,e.current=t}var ho={},po=uo(ho),bo=uo(!1),fo=ho;function Co(e,t){var n=e.type.contextTypes;if(!n)return ho;var a=e.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===t)return a.__reactInternalMemoizedMaskedChildContext;var o,r={};for(o in n)r[o]=t[o];return a&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=r),r}function yo(e){return null!=(e=e.childContextTypes)}function vo(){mo(bo),mo(po)}function To(e,t,n){if(po.current!==ho)throw Error(l(168));go(po,t),go(bo,n)}function xo(e,t,n){var a=e.stateNode;if(e=t.childContextTypes,"function"!=typeof a.getChildContext)return n;for(var o in a=a.getChildContext())if(!(o in e))throw Error(l(108,j(t)||"Unknown",o));return r({},n,a)}function So(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ho,fo=po.current,go(po,e),go(bo,bo.current),!0}function wo(e,t,n){var a=e.stateNode;if(!a)throw Error(l(169));n?(e=xo(e,t,fo),a.__reactInternalMemoizedMergedChildContext=e,mo(bo),mo(po),go(po,e)):mo(bo),go(bo,n)}var Eo=null,Io=null,Ro=i.unstable_runWithPriority,Ao=i.unstable_scheduleCallback,Lo=i.unstable_cancelCallback,ko=i.unstable_shouldYield,Fo=i.unstable_requestPaint,_o=i.unstable_now,Po=i.unstable_getCurrentPriorityLevel,No=i.unstable_ImmediatePriority,Mo=i.unstable_UserBlockingPriority,Oo=i.unstable_NormalPriority,Do=i.unstable_LowPriority,Bo=i.unstable_IdlePriority,$o={},Ho=void 0!==Fo?Fo:function(){},Uo=null,qo=null,Vo=!1,Wo=_o(),Go=1e4>Wo?_o:function(){return _o()-Wo};function zo(){switch(Po()){case No:return 99;case Mo:return 98;case Oo:return 97;case Do:return 96;case Bo:return 95;default:throw Error(l(332))}}function Qo(e){switch(e){case 99:return No;case 98:return Mo;case 97:return Oo;case 96:return Do;case 95:return Bo;default:throw Error(l(332))}}function jo(e,t){return e=Qo(e),Ro(e,t)}function Jo(e,t,n){return e=Qo(e),Ao(e,t,n)}function Yo(){if(null!==qo){var e=qo;qo=null,Lo(e)}Xo()}function Xo(){if(!Vo&&null!==Uo){Vo=!0;var e=0;try{var t=Uo;jo(99,(function(){for(;e<t.length;e++){var n=t[e];do{n=n(!0)}while(null!==n)}})),Uo=null}catch(t){throw null!==Uo&&(Uo=Uo.slice(e+1)),Ao(No,Yo),t}finally{Vo=!1}}}var Zo=x.ReactCurrentBatchConfig;function Ko(e,t){if(e&&e.defaultProps){for(var n in t=r({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var er=uo(null),tr=null,nr=null,ar=null;function or(){ar=nr=tr=null}function rr(e){var t=er.current;mo(er),e.type._context._currentValue=t}function ir(e,t){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)===t){if(null===n||(n.childLanes&t)===t)break;n.childLanes|=t}else e.childLanes|=t,null!==n&&(n.childLanes|=t);e=e.return}}function lr(e,t){tr=e,ar=nr=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(Bi=!0),e.firstContext=null)}function sr(e,t){if(ar!==e&&!1!==t&&0!==t)if("number"==typeof t&&1073741823!==t||(ar=e,t=1073741823),t={context:e,observedBits:t,next:null},null===nr){if(null===tr)throw Error(l(308));nr=t,tr.dependencies={lanes:0,firstContext:t,responders:null}}else nr=nr.next=t;return e._currentValue}var cr=!1;function dr(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function ur(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function mr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function gr(e,t){if(null!==(e=e.updateQueue)){var n=(e=e.shared).pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}}function hr(e,t){var n=e.updateQueue,a=e.alternate;if(null!==a&&n===(a=a.updateQueue)){var o=null,r=null;if(null!==(n=n.firstBaseUpdate)){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===r?o=r=i:r=r.next=i,n=n.next}while(null!==n);null===r?o=r=t:r=r.next=t}else o=r=t;return n={baseState:a.baseState,firstBaseUpdate:o,lastBaseUpdate:r,shared:a.shared,effects:a.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function pr(e,t,n,a){var o=e.updateQueue;cr=!1;var i=o.firstBaseUpdate,l=o.lastBaseUpdate,s=o.shared.pending;if(null!==s){o.shared.pending=null;var c=s,d=c.next;c.next=null,null===l?i=d:l.next=d,l=c;var u=e.alternate;if(null!==u){var m=(u=u.updateQueue).lastBaseUpdate;m!==l&&(null===m?u.firstBaseUpdate=d:m.next=d,u.lastBaseUpdate=c)}}if(null!==i){for(m=o.baseState,l=0,u=d=c=null;;){s=i.lane;var g=i.eventTime;if((a&s)===s){null!==u&&(u=u.next={eventTime:g,lane:0,tag:i.tag,payload:i.payload,callback:i.callback,next:null});e:{var h=e,p=i;switch(s=t,g=n,p.tag){case 1:if("function"==typeof(h=p.payload)){m=h.call(g,m,s);break e}m=h;break e;case 3:h.flags=-4097&h.flags|64;case 0:if(null==(s="function"==typeof(h=p.payload)?h.call(g,m,s):h))break e;m=r({},m,s);break e;case 2:cr=!0}}null!==i.callback&&(e.flags|=32,null===(s=o.effects)?o.effects=[i]:s.push(i))}else g={eventTime:g,lane:s,tag:i.tag,payload:i.payload,callback:i.callback,next:null},null===u?(d=u=g,c=m):u=u.next=g,l|=s;if(null===(i=i.next)){if(null===(s=o.shared.pending))break;i=s.next,s.next=null,o.lastBaseUpdate=s,o.shared.pending=null}}null===u&&(c=m),o.baseState=c,o.firstBaseUpdate=d,o.lastBaseUpdate=u,Vl|=l,e.lanes=l,e.memoizedState=m}}function br(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var a=e[t],o=a.callback;if(null!==o){if(a.callback=null,a=n,"function"!=typeof o)throw Error(l(191,o));o.call(a)}}}var fr=(new o.Component).refs;function Cr(e,t,n,a){n=null==(n=n(a,t=e.memoizedState))?t:r({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var yr={isMounted:function(e){return!!(e=e._reactInternals)&&Xe(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var a=hs(),o=ps(e),r=mr(a,o);r.payload=t,null!=n&&(r.callback=n),gr(e,r),bs(e,o,a)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var a=hs(),o=ps(e),r=mr(a,o);r.tag=1,r.payload=t,null!=n&&(r.callback=n),gr(e,r),bs(e,o,a)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=hs(),a=ps(e),o=mr(n,a);o.tag=2,null!=t&&(o.callback=t),gr(e,o),bs(e,a,n)}};function vr(e,t,n,a,o,r,i){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(a,r,i):!t.prototype||!t.prototype.isPureReactComponent||(!ga(n,a)||!ga(o,r))}function Tr(e,t,n){var a=!1,o=ho,r=t.contextType;return"object"==typeof r&&null!==r?r=sr(r):(o=yo(t)?fo:po.current,r=(a=null!=(a=t.contextTypes))?Co(e,o):ho),t=new t(n,r),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=yr,e.stateNode=t,t._reactInternals=e,a&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=r),t}function xr(e,t,n,a){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,a),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,a),t.state!==e&&yr.enqueueReplaceState(t,t.state,null)}function Sr(e,t,n,a){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs=fr,dr(e);var r=t.contextType;"object"==typeof r&&null!==r?o.context=sr(r):(r=yo(t)?fo:po.current,o.context=Co(e,r)),pr(e,n,o,a),o.state=e.memoizedState,"function"==typeof(r=t.getDerivedStateFromProps)&&(Cr(e,t,r,n),o.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof o.getSnapshotBeforeUpdate||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||(t=o.state,"function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),t!==o.state&&yr.enqueueReplaceState(o,o.state,null),pr(e,n,o,a),o.state=e.memoizedState),"function"==typeof o.componentDidMount&&(e.flags|=4)}var wr=Array.isArray;function Er(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(l(309));var a=n.stateNode}if(!a)throw Error(l(147,e));var o=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=a.refs;t===fr&&(t=a.refs={}),null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!=typeof e)throw Error(l(284));if(!n._owner)throw Error(l(290,e))}return e}function Ir(e,t){if("textarea"!==e.type)throw Error(l(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t))}function Rr(e){function t(t,n){if(e){var a=t.lastEffect;null!==a?(a.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n,n.nextEffect=null,n.flags=8}}function n(n,a){if(!e)return null;for(;null!==a;)t(n,a),a=a.sibling;return null}function a(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function o(e,t){return(e=js(e,t)).index=0,e.sibling=null,e}function r(t,n,a){return t.index=a,e?null!==(a=t.alternate)?(a=a.index)<n?(t.flags=2,n):a:(t.flags=2,n):n}function i(t){return e&&null===t.alternate&&(t.flags=2),t}function s(e,t,n,a){return null===t||6!==t.tag?((t=Zs(n,e.mode,a)).return=e,t):((t=o(t,n)).return=e,t)}function c(e,t,n,a){return null!==t&&t.elementType===n.type?((a=o(t,n.props)).ref=Er(e,t,n),a.return=e,a):((a=Js(n.type,n.key,n.props,null,e.mode,a)).ref=Er(e,t,n),a.return=e,a)}function d(e,t,n,a){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Ks(n,e.mode,a)).return=e,t):((t=o(t,n.children||[])).return=e,t)}function u(e,t,n,a,r){return null===t||7!==t.tag?((t=Ys(n,e.mode,a,r)).return=e,t):((t=o(t,n)).return=e,t)}function m(e,t,n){if("string"==typeof t||"number"==typeof t)return(t=Zs(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case S:return(n=Js(t.type,t.key,t.props,null,e.mode,n)).ref=Er(e,null,t),n.return=e,n;case w:return(t=Ks(t,e.mode,n)).return=e,t}if(wr(t)||V(t))return(t=Ys(t,e.mode,n,null)).return=e,t;Ir(e,t)}return null}function g(e,t,n,a){var o=null!==t?t.key:null;if("string"==typeof n||"number"==typeof n)return null!==o?null:s(e,t,""+n,a);if("object"==typeof n&&null!==n){switch(n.$$typeof){case S:return n.key===o?n.type===E?u(e,t,n.props.children,a,o):c(e,t,n,a):null;case w:return n.key===o?d(e,t,n,a):null}if(wr(n)||V(n))return null!==o?null:u(e,t,n,a,null);Ir(e,n)}return null}function h(e,t,n,a,o){if("string"==typeof a||"number"==typeof a)return s(t,e=e.get(n)||null,""+a,o);if("object"==typeof a&&null!==a){switch(a.$$typeof){case S:return e=e.get(null===a.key?n:a.key)||null,a.type===E?u(t,e,a.props.children,o,a.key):c(t,e,a,o);case w:return d(t,e=e.get(null===a.key?n:a.key)||null,a,o)}if(wr(a)||V(a))return u(t,e=e.get(n)||null,a,o,null);Ir(t,a)}return null}function p(o,i,l,s){for(var c=null,d=null,u=i,p=i=0,b=null;null!==u&&p<l.length;p++){u.index>p?(b=u,u=null):b=u.sibling;var f=g(o,u,l[p],s);if(null===f){null===u&&(u=b);break}e&&u&&null===f.alternate&&t(o,u),i=r(f,i,p),null===d?c=f:d.sibling=f,d=f,u=b}if(p===l.length)return n(o,u),c;if(null===u){for(;p<l.length;p++)null!==(u=m(o,l[p],s))&&(i=r(u,i,p),null===d?c=u:d.sibling=u,d=u);return c}for(u=a(o,u);p<l.length;p++)null!==(b=h(u,o,p,l[p],s))&&(e&&null!==b.alternate&&u.delete(null===b.key?p:b.key),i=r(b,i,p),null===d?c=b:d.sibling=b,d=b);return e&&u.forEach((function(e){return t(o,e)})),c}function b(o,i,s,c){var d=V(s);if("function"!=typeof d)throw Error(l(150));if(null==(s=d.call(s)))throw Error(l(151));for(var u=d=null,p=i,b=i=0,f=null,C=s.next();null!==p&&!C.done;b++,C=s.next()){p.index>b?(f=p,p=null):f=p.sibling;var y=g(o,p,C.value,c);if(null===y){null===p&&(p=f);break}e&&p&&null===y.alternate&&t(o,p),i=r(y,i,b),null===u?d=y:u.sibling=y,u=y,p=f}if(C.done)return n(o,p),d;if(null===p){for(;!C.done;b++,C=s.next())null!==(C=m(o,C.value,c))&&(i=r(C,i,b),null===u?d=C:u.sibling=C,u=C);return d}for(p=a(o,p);!C.done;b++,C=s.next())null!==(C=h(p,o,b,C.value,c))&&(e&&null!==C.alternate&&p.delete(null===C.key?b:C.key),i=r(C,i,b),null===u?d=C:u.sibling=C,u=C);return e&&p.forEach((function(e){return t(o,e)})),d}return function(e,a,r,s){var c="object"==typeof r&&null!==r&&r.type===E&&null===r.key;c&&(r=r.props.children);var d="object"==typeof r&&null!==r;if(d)switch(r.$$typeof){case S:e:{for(d=r.key,c=a;null!==c;){if(c.key===d){if(7===c.tag){if(r.type===E){n(e,c.sibling),(a=o(c,r.props.children)).return=e,e=a;break e}}else if(c.elementType===r.type){n(e,c.sibling),(a=o(c,r.props)).ref=Er(e,c,r),a.return=e,e=a;break e}n(e,c);break}t(e,c),c=c.sibling}r.type===E?((a=Ys(r.props.children,e.mode,s,r.key)).return=e,e=a):((s=Js(r.type,r.key,r.props,null,e.mode,s)).ref=Er(e,a,r),s.return=e,e=s)}return i(e);case w:e:{for(c=r.key;null!==a;){if(a.key===c){if(4===a.tag&&a.stateNode.containerInfo===r.containerInfo&&a.stateNode.implementation===r.implementation){n(e,a.sibling),(a=o(a,r.children||[])).return=e,e=a;break e}n(e,a);break}t(e,a),a=a.sibling}(a=Ks(r,e.mode,s)).return=e,e=a}return i(e)}if("string"==typeof r||"number"==typeof r)return r=""+r,null!==a&&6===a.tag?(n(e,a.sibling),(a=o(a,r)).return=e,e=a):(n(e,a),(a=Zs(r,e.mode,s)).return=e,e=a),i(e);if(wr(r))return p(e,a,r,s);if(V(r))return b(e,a,r,s);if(d&&Ir(e,r),void 0===r&&!c)switch(e.tag){case 1:case 22:case 0:case 11:case 15:throw Error(l(152,j(e.type)||"Component"))}return n(e,a)}}var Ar=Rr(!0),Lr=Rr(!1),kr={},Fr=uo(kr),_r=uo(kr),Pr=uo(kr);function Nr(e){if(e===kr)throw Error(l(174));return e}function Mr(e,t){switch(go(Pr,t),go(_r,e),go(Fr,kr),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:pe(null,"");break;default:t=pe(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}mo(Fr),go(Fr,t)}function Or(){mo(Fr),mo(_r),mo(Pr)}function Dr(e){Nr(Pr.current);var t=Nr(Fr.current),n=pe(t,e.type);t!==n&&(go(_r,e),go(Fr,n))}function Br(e){_r.current===e&&(mo(Fr),mo(_r))}var $r=uo(0);function Hr(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(64&t.flags)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ur=null,qr=null,Vr=!1;function Wr(e,t){var n=zs(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=t,n.return=e,n.flags=8,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function Gr(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);default:return!1}}function zr(e){if(Vr){var t=qr;if(t){var n=t;if(!Gr(e,t)){if(!(t=Ja(n.nextSibling))||!Gr(e,t))return e.flags=-1025&e.flags|2,Vr=!1,void(Ur=e);Wr(Ur,n)}Ur=e,qr=Ja(t.firstChild)}else e.flags=-1025&e.flags|2,Vr=!1,Ur=e}}function Qr(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Ur=e}function jr(e){if(e!==Ur)return!1;if(!Vr)return Qr(e),Vr=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!Ga(t,e.memoizedProps))for(t=qr;t;)Wr(e,t),t=Ja(t.nextSibling);if(Qr(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(l(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){qr=Ja(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}qr=null}}else qr=Ur?Ja(e.stateNode.nextSibling):null;return!0}function Jr(){qr=Ur=null,Vr=!1}var Yr=[];function Xr(){for(var e=0;e<Yr.length;e++)Yr[e]._workInProgressVersionPrimary=null;Yr.length=0}var Zr=x.ReactCurrentDispatcher,Kr=x.ReactCurrentBatchConfig,ei=0,ti=null,ni=null,ai=null,oi=!1,ri=!1;function ii(){throw Error(l(321))}function li(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ua(e[n],t[n]))return!1;return!0}function si(e,t,n,a,o,r){if(ei=r,ti=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Zr.current=null===e||null===e.memoizedState?Ni:Mi,e=n(a,o),ri){r=0;do{if(ri=!1,!(25>r))throw Error(l(301));r+=1,ai=ni=null,t.updateQueue=null,Zr.current=Oi,e=n(a,o)}while(ri)}if(Zr.current=Pi,t=null!==ni&&null!==ni.next,ei=0,ai=ni=ti=null,oi=!1,t)throw Error(l(300));return e}function ci(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ai?ti.memoizedState=ai=e:ai=ai.next=e,ai}function di(){if(null===ni){var e=ti.alternate;e=null!==e?e.memoizedState:null}else e=ni.next;var t=null===ai?ti.memoizedState:ai.next;if(null!==t)ai=t,ni=e;else{if(null===e)throw Error(l(310));e={memoizedState:(ni=e).memoizedState,baseState:ni.baseState,baseQueue:ni.baseQueue,queue:ni.queue,next:null},null===ai?ti.memoizedState=ai=e:ai=ai.next=e}return ai}function ui(e,t){return"function"==typeof t?t(e):t}function mi(e){var t=di(),n=t.queue;if(null===n)throw Error(l(311));n.lastRenderedReducer=e;var a=ni,o=a.baseQueue,r=n.pending;if(null!==r){if(null!==o){var i=o.next;o.next=r.next,r.next=i}a.baseQueue=o=r,n.pending=null}if(null!==o){o=o.next,a=a.baseState;var s=i=r=null,c=o;do{var d=c.lane;if((ei&d)===d)null!==s&&(s=s.next={lane:0,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null}),a=c.eagerReducer===e?c.eagerState:e(a,c.action);else{var u={lane:d,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null};null===s?(i=s=u,r=a):s=s.next=u,ti.lanes|=d,Vl|=d}c=c.next}while(null!==c&&c!==o);null===s?r=a:s.next=i,ua(a,t.memoizedState)||(Bi=!0),t.memoizedState=a,t.baseState=r,t.baseQueue=s,n.lastRenderedState=a}return[t.memoizedState,n.dispatch]}function gi(e){var t=di(),n=t.queue;if(null===n)throw Error(l(311));n.lastRenderedReducer=e;var a=n.dispatch,o=n.pending,r=t.memoizedState;if(null!==o){n.pending=null;var i=o=o.next;do{r=e(r,i.action),i=i.next}while(i!==o);ua(r,t.memoizedState)||(Bi=!0),t.memoizedState=r,null===t.baseQueue&&(t.baseState=r),n.lastRenderedState=r}return[r,a]}function hi(e,t,n){var a=t._getVersion;a=a(t._source);var o=t._workInProgressVersionPrimary;if(null!==o?e=o===a:(e=e.mutableReadLanes,(e=(ei&e)===e)&&(t._workInProgressVersionPrimary=a,Yr.push(t))),e)return n(t._source);throw Yr.push(t),Error(l(350))}function pi(e,t,n,a){var o=Ml;if(null===o)throw Error(l(349));var r=t._getVersion,i=r(t._source),s=Zr.current,c=s.useState((function(){return hi(o,t,n)})),d=c[1],u=c[0];c=ai;var m=e.memoizedState,g=m.refs,h=g.getSnapshot,p=m.source;m=m.subscribe;var b=ti;return e.memoizedState={refs:g,source:t,subscribe:a},s.useEffect((function(){g.getSnapshot=n,g.setSnapshot=d;var e=r(t._source);if(!ua(i,e)){e=n(t._source),ua(u,e)||(d(e),e=ps(b),o.mutableReadLanes|=e&o.pendingLanes),e=o.mutableReadLanes,o.entangledLanes|=e;for(var a=o.entanglements,l=e;0<l;){var s=31-Gt(l),c=1<<s;a[s]|=e,l&=~c}}}),[n,t,a]),s.useEffect((function(){return a(t._source,(function(){var e=g.getSnapshot,n=g.setSnapshot;try{n(e(t._source));var a=ps(b);o.mutableReadLanes|=a&o.pendingLanes}catch(e){n((function(){throw e}))}}))}),[t,a]),ua(h,n)&&ua(p,t)&&ua(m,a)||((e={pending:null,dispatch:null,lastRenderedReducer:ui,lastRenderedState:u}).dispatch=d=_i.bind(null,ti,e),c.queue=e,c.baseQueue=null,u=hi(o,t,n),c.memoizedState=c.baseState=u),u}function bi(e,t,n){return pi(di(),e,t,n)}function fi(e){var t=ci();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:ui,lastRenderedState:e}).dispatch=_i.bind(null,ti,e),[t.memoizedState,e]}function Ci(e,t,n,a){return e={tag:e,create:t,destroy:n,deps:a,next:null},null===(t=ti.updateQueue)?(t={lastEffect:null},ti.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(a=n.next,n.next=e,e.next=a,t.lastEffect=e),e}function yi(e){return e={current:e},ci().memoizedState=e}function vi(){return di().memoizedState}function Ti(e,t,n,a){var o=ci();ti.flags|=e,o.memoizedState=Ci(1|t,n,void 0,void 0===a?null:a)}function xi(e,t,n,a){var o=di();a=void 0===a?null:a;var r=void 0;if(null!==ni){var i=ni.memoizedState;if(r=i.destroy,null!==a&&li(a,i.deps))return void Ci(t,n,r,a)}ti.flags|=e,o.memoizedState=Ci(1|t,n,r,a)}function Si(e,t){return Ti(516,4,e,t)}function wi(e,t){return xi(516,4,e,t)}function Ei(e,t){return xi(4,2,e,t)}function Ii(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ri(e,t,n){return n=null!=n?n.concat([e]):null,xi(4,2,Ii.bind(null,t,e),n)}function Ai(){}function Li(e,t){var n=di();t=void 0===t?null:t;var a=n.memoizedState;return null!==a&&null!==t&&li(t,a[1])?a[0]:(n.memoizedState=[e,t],e)}function ki(e,t){var n=di();t=void 0===t?null:t;var a=n.memoizedState;return null!==a&&null!==t&&li(t,a[1])?a[0]:(e=e(),n.memoizedState=[e,t],e)}function Fi(e,t){var n=zo();jo(98>n?98:n,(function(){e(!0)})),jo(97<n?97:n,(function(){var n=Kr.transition;Kr.transition=1;try{e(!1),t()}finally{Kr.transition=n}}))}function _i(e,t,n){var a=hs(),o=ps(e),r={lane:o,action:n,eagerReducer:null,eagerState:null,next:null},i=t.pending;if(null===i?r.next=r:(r.next=i.next,i.next=r),t.pending=r,i=e.alternate,e===ti||null!==i&&i===ti)ri=oi=!0;else{if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var l=t.lastRenderedState,s=i(l,n);if(r.eagerReducer=i,r.eagerState=s,ua(s,l))return}catch(e){}bs(e,o,a)}}var Pi={readContext:sr,useCallback:ii,useContext:ii,useEffect:ii,useImperativeHandle:ii,useLayoutEffect:ii,useMemo:ii,useReducer:ii,useRef:ii,useState:ii,useDebugValue:ii,useDeferredValue:ii,useTransition:ii,useMutableSource:ii,useOpaqueIdentifier:ii,unstable_isNewReconciler:!1},Ni={readContext:sr,useCallback:function(e,t){return ci().memoizedState=[e,void 0===t?null:t],e},useContext:sr,useEffect:Si,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,Ti(4,2,Ii.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ti(4,2,e,t)},useMemo:function(e,t){var n=ci();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var a=ci();return t=void 0!==n?n(t):t,a.memoizedState=a.baseState=t,e=(e=a.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=_i.bind(null,ti,e),[a.memoizedState,e]},useRef:yi,useState:fi,useDebugValue:Ai,useDeferredValue:function(e){var t=fi(e),n=t[0],a=t[1];return Si((function(){var t=Kr.transition;Kr.transition=1;try{a(e)}finally{Kr.transition=t}}),[e]),n},useTransition:function(){var e=fi(!1),t=e[0];return yi(e=Fi.bind(null,e[1])),[e,t]},useMutableSource:function(e,t,n){var a=ci();return a.memoizedState={refs:{getSnapshot:t,setSnapshot:null},source:e,subscribe:n},pi(a,e,t,n)},useOpaqueIdentifier:function(){if(Vr){var e=!1,t=function(e){return{$$typeof:O,toString:e,valueOf:e}}((function(){throw e||(e=!0,n("r:"+(Xa++).toString(36))),Error(l(355))})),n=fi(t)[1];return!(2&ti.mode)&&(ti.flags|=516,Ci(5,(function(){n("r:"+(Xa++).toString(36))}),void 0,null)),t}return fi(t="r:"+(Xa++).toString(36)),t},unstable_isNewReconciler:!1},Mi={readContext:sr,useCallback:Li,useContext:sr,useEffect:wi,useImperativeHandle:Ri,useLayoutEffect:Ei,useMemo:ki,useReducer:mi,useRef:vi,useState:function(){return mi(ui)},useDebugValue:Ai,useDeferredValue:function(e){var t=mi(ui),n=t[0],a=t[1];return wi((function(){var t=Kr.transition;Kr.transition=1;try{a(e)}finally{Kr.transition=t}}),[e]),n},useTransition:function(){var e=mi(ui)[0];return[vi().current,e]},useMutableSource:bi,useOpaqueIdentifier:function(){return mi(ui)[0]},unstable_isNewReconciler:!1},Oi={readContext:sr,useCallback:Li,useContext:sr,useEffect:wi,useImperativeHandle:Ri,useLayoutEffect:Ei,useMemo:ki,useReducer:gi,useRef:vi,useState:function(){return gi(ui)},useDebugValue:Ai,useDeferredValue:function(e){var t=gi(ui),n=t[0],a=t[1];return wi((function(){var t=Kr.transition;Kr.transition=1;try{a(e)}finally{Kr.transition=t}}),[e]),n},useTransition:function(){var e=gi(ui)[0];return[vi().current,e]},useMutableSource:bi,useOpaqueIdentifier:function(){return gi(ui)[0]},unstable_isNewReconciler:!1},Di=x.ReactCurrentOwner,Bi=!1;function $i(e,t,n,a){t.child=null===e?Lr(t,null,n,a):Ar(t,e.child,n,a)}function Hi(e,t,n,a,o){n=n.render;var r=t.ref;return lr(t,o),a=si(e,t,n,a,r,o),null===e||Bi?(t.flags|=1,$i(e,t,a,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~o,ll(e,t,o))}function Ui(e,t,n,a,o,r){if(null===e){var i=n.type;return"function"!=typeof i||Qs(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Js(n.type,null,a,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,qi(e,t,i,a,o,r))}return i=e.child,0===(o&r)&&(o=i.memoizedProps,(n=null!==(n=n.compare)?n:ga)(o,a)&&e.ref===t.ref)?ll(e,t,r):(t.flags|=1,(e=js(i,a)).ref=t.ref,e.return=t,t.child=e)}function qi(e,t,n,a,o,r){if(null!==e&&ga(e.memoizedProps,a)&&e.ref===t.ref){if(Bi=!1,0===(r&o))return t.lanes=e.lanes,ll(e,t,r);16384&e.flags&&(Bi=!0)}return Gi(e,t,n,a,r)}function Vi(e,t,n){var a=t.pendingProps,o=a.children,r=null!==e?e.memoizedState:null;if("hidden"===a.mode||"unstable-defer-without-hiding"===a.mode)if(4&t.mode){if(!(1073741824&n))return e=null!==r?r.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e},ws(t,e),null;t.memoizedState={baseLanes:0},ws(t,null!==r?r.baseLanes:n)}else t.memoizedState={baseLanes:0},ws(t,n);else null!==r?(a=r.baseLanes|n,t.memoizedState=null):a=n,ws(t,a);return $i(e,t,o,n),t.child}function Wi(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=128)}function Gi(e,t,n,a,o){var r=yo(n)?fo:po.current;return r=Co(t,r),lr(t,o),n=si(e,t,n,a,r,o),null===e||Bi?(t.flags|=1,$i(e,t,n,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~o,ll(e,t,o))}function zi(e,t,n,a,o){if(yo(n)){var r=!0;So(t)}else r=!1;if(lr(t,o),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),Tr(t,n,a),Sr(t,n,a,o),a=!0;else if(null===e){var i=t.stateNode,l=t.memoizedProps;i.props=l;var s=i.context,c=n.contextType;"object"==typeof c&&null!==c?c=sr(c):c=Co(t,c=yo(n)?fo:po.current);var d=n.getDerivedStateFromProps,u="function"==typeof d||"function"==typeof i.getSnapshotBeforeUpdate;u||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(l!==a||s!==c)&&xr(t,i,a,c),cr=!1;var m=t.memoizedState;i.state=m,pr(t,a,i,o),s=t.memoizedState,l!==a||m!==s||bo.current||cr?("function"==typeof d&&(Cr(t,n,d,a),s=t.memoizedState),(l=cr||vr(t,n,l,a,m,s,c))?(u||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||("function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"==typeof i.componentDidMount&&(t.flags|=4)):("function"==typeof i.componentDidMount&&(t.flags|=4),t.memoizedProps=a,t.memoizedState=s),i.props=a,i.state=s,i.context=c,a=l):("function"==typeof i.componentDidMount&&(t.flags|=4),a=!1)}else{i=t.stateNode,ur(e,t),l=t.memoizedProps,c=t.type===t.elementType?l:Ko(t.type,l),i.props=c,u=t.pendingProps,m=i.context,"object"==typeof(s=n.contextType)&&null!==s?s=sr(s):s=Co(t,s=yo(n)?fo:po.current);var g=n.getDerivedStateFromProps;(d="function"==typeof g||"function"==typeof i.getSnapshotBeforeUpdate)||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(l!==u||m!==s)&&xr(t,i,a,s),cr=!1,m=t.memoizedState,i.state=m,pr(t,a,i,o);var h=t.memoizedState;l!==u||m!==h||bo.current||cr?("function"==typeof g&&(Cr(t,n,g,a),h=t.memoizedState),(c=cr||vr(t,n,c,a,m,h,s))?(d||"function"!=typeof i.UNSAFE_componentWillUpdate&&"function"!=typeof i.componentWillUpdate||("function"==typeof i.componentWillUpdate&&i.componentWillUpdate(a,h,s),"function"==typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(a,h,s)),"function"==typeof i.componentDidUpdate&&(t.flags|=4),"function"==typeof i.getSnapshotBeforeUpdate&&(t.flags|=256)):("function"!=typeof i.componentDidUpdate||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),"function"!=typeof i.getSnapshotBeforeUpdate||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=256),t.memoizedProps=a,t.memoizedState=h),i.props=a,i.state=h,i.context=s,a=c):("function"!=typeof i.componentDidUpdate||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),"function"!=typeof i.getSnapshotBeforeUpdate||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=256),a=!1)}return Qi(e,t,n,a,r,o)}function Qi(e,t,n,a,o,r){Wi(e,t);var i=!!(64&t.flags);if(!a&&!i)return o&&wo(t,n,!1),ll(e,t,r);a=t.stateNode,Di.current=t;var l=i&&"function"!=typeof n.getDerivedStateFromError?null:a.render();return t.flags|=1,null!==e&&i?(t.child=Ar(t,e.child,null,r),t.child=Ar(t,null,l,r)):$i(e,t,l,r),t.memoizedState=a.state,o&&wo(t,n,!0),t.child}function ji(e){var t=e.stateNode;t.pendingContext?To(0,t.pendingContext,t.pendingContext!==t.context):t.context&&To(0,t.context,!1),Mr(e,t.containerInfo)}var Ji,Yi,Xi,Zi,Ki={dehydrated:null,retryLane:0};function el(e,t,n){var a,o=t.pendingProps,r=$r.current,i=!1;return(a=!!(64&t.flags))||(a=(null===e||null!==e.memoizedState)&&!!(2&r)),a?(i=!0,t.flags&=-65):null!==e&&null===e.memoizedState||void 0===o.fallback||!0===o.unstable_avoidThisFallback||(r|=1),go($r,1&r),null===e?(void 0!==o.fallback&&zr(t),e=o.children,r=o.fallback,i?(e=tl(t,e,r,n),t.child.memoizedState={baseLanes:n},t.memoizedState=Ki,e):"number"==typeof o.unstable_expectedLoadTime?(e=tl(t,e,r,n),t.child.memoizedState={baseLanes:n},t.memoizedState=Ki,t.lanes=33554432,e):((n=Xs({mode:"visible",children:e},t.mode,n,null)).return=t,t.child=n)):(e.memoizedState,i?(o=al(e,t,o.children,o.fallback,n),i=t.child,r=e.child.memoizedState,i.memoizedState=null===r?{baseLanes:n}:{baseLanes:r.baseLanes|n},i.childLanes=e.childLanes&~n,t.memoizedState=Ki,o):(n=nl(e,t,o.children,n),t.memoizedState=null,n))}function tl(e,t,n,a){var o=e.mode,r=e.child;return t={mode:"hidden",children:t},2&o||null===r?r=Xs(t,o,0,null):(r.childLanes=0,r.pendingProps=t),n=Ys(n,o,a,null),r.return=e,n.return=e,r.sibling=n,e.child=r,n}function nl(e,t,n,a){var o=e.child;return e=o.sibling,n=js(o,{mode:"visible",children:n}),!(2&t.mode)&&(n.lanes=a),n.return=t,n.sibling=null,null!==e&&(e.nextEffect=null,e.flags=8,t.firstEffect=t.lastEffect=e),t.child=n}function al(e,t,n,a,o){var r=t.mode,i=e.child;e=i.sibling;var l={mode:"hidden",children:n};return 2&r||t.child===i?n=js(i,l):((n=t.child).childLanes=0,n.pendingProps=l,null!==(i=n.lastEffect)?(t.firstEffect=n.firstEffect,t.lastEffect=i,i.nextEffect=null):t.firstEffect=t.lastEffect=null),null!==e?a=js(e,a):(a=Ys(a,r,o,null)).flags|=2,a.return=t,n.return=t,n.sibling=a,t.child=n,a}function ol(e,t){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),ir(e.return,t)}function rl(e,t,n,a,o,r){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:n,tailMode:o,lastEffect:r}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=a,i.tail=n,i.tailMode=o,i.lastEffect=r)}function il(e,t,n){var a=t.pendingProps,o=a.revealOrder,r=a.tail;if($i(e,t,a.children,n),2&(a=$r.current))a=1&a|2,t.flags|=64;else{if(null!==e&&64&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&ol(e,n);else if(19===e.tag)ol(e,n);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}if(go($r,a),2&t.mode)switch(o){case"forwards":for(n=t.child,o=null;null!==n;)null!==(e=n.alternate)&&null===Hr(e)&&(o=n),n=n.sibling;null===(n=o)?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),rl(t,!1,o,n,r,t.lastEffect);break;case"backwards":for(n=null,o=t.child,t.child=null;null!==o;){if(null!==(e=o.alternate)&&null===Hr(e)){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}rl(t,!0,n,null,r,t.lastEffect);break;case"together":rl(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}else t.memoizedState=null;return t.child}function ll(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Vl|=t.lanes,0!==(n&t.childLanes)){if(null!==e&&t.child!==e.child)throw Error(l(153));if(null!==t.child){for(n=js(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=js(e,e.pendingProps)).return=t;n.sibling=null}return t.child}return null}function sl(e,t){if(!Vr)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var a=null;null!==n;)null!==n.alternate&&(a=n),n=n.sibling;null===a?t||null===e.tail?e.tail=null:e.tail.sibling=null:a.sibling=null}}function cl(e,t,n){var a=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:case 17:return yo(t.type)&&vo(),null;case 3:return Or(),mo(bo),mo(po),Xr(),(a=t.stateNode).pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),null!==e&&null!==e.child||(jr(t)?t.flags|=4:a.hydrate||(t.flags|=256)),Yi(t),null;case 5:Br(t);var o=Nr(Pr.current);if(n=t.type,null!==e&&null!=t.stateNode)Xi(e,t,n,a,o),e.ref!==t.ref&&(t.flags|=128);else{if(!a){if(null===t.stateNode)throw Error(l(166));return null}if(e=Nr(Fr.current),jr(t)){a=t.stateNode,n=t.type;var i=t.memoizedProps;switch(a[Ka]=t,a[eo]=i,n){case"dialog":Fa("cancel",a),Fa("close",a);break;case"iframe":case"object":case"embed":Fa("load",a);break;case"video":case"audio":for(e=0;e<Ra.length;e++)Fa(Ra[e],a);break;case"source":Fa("error",a);break;case"img":case"image":case"link":Fa("error",a),Fa("load",a);break;case"details":Fa("toggle",a);break;case"input":te(a,i),Fa("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!i.multiple},Fa("invalid",a);break;case"textarea":ce(a,i),Fa("invalid",a)}for(var s in Ee(n,i),e=null,i)i.hasOwnProperty(s)&&(o=i[s],"children"===s?"string"==typeof o?a.textContent!==o&&(e=["children",o]):"number"==typeof o&&a.textContent!==""+o&&(e=["children",""+o]):c.hasOwnProperty(s)&&null!=o&&"onScroll"===s&&Fa("scroll",a));switch(n){case"input":X(a),oe(a,i,!0);break;case"textarea":X(a),ue(a);break;case"select":case"option":break;default:"function"==typeof i.onClick&&(a.onclick=Ua)}a=e,t.updateQueue=a,null!==a&&(t.flags|=4)}else{switch(s=9===o.nodeType?o:o.ownerDocument,e===me&&(e=he(n)),e===me?"script"===n?((e=s.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof a.is?e=s.createElement(n,{is:a.is}):(e=s.createElement(n),"select"===n&&(s=e,a.multiple?s.multiple=!0:a.size&&(s.size=a.size))):e=s.createElementNS(e,n),e[Ka]=t,e[eo]=a,Ji(e,t,!1,!1),t.stateNode=e,s=Ie(n,a),n){case"dialog":Fa("cancel",e),Fa("close",e),o=a;break;case"iframe":case"object":case"embed":Fa("load",e),o=a;break;case"video":case"audio":for(o=0;o<Ra.length;o++)Fa(Ra[o],e);o=a;break;case"source":Fa("error",e),o=a;break;case"img":case"image":case"link":Fa("error",e),Fa("load",e),o=a;break;case"details":Fa("toggle",e),o=a;break;case"input":te(e,a),o=ee(e,a),Fa("invalid",e);break;case"option":o=ie(e,a);break;case"select":e._wrapperState={wasMultiple:!!a.multiple},o=r({},a,{value:void 0}),Fa("invalid",e);break;case"textarea":ce(e,a),o=se(e,a),Fa("invalid",e);break;default:o=a}Ee(n,o);var d=o;for(i in d)if(d.hasOwnProperty(i)){var u=d[i];"style"===i?Se(e,u):"dangerouslySetInnerHTML"===i?null!=(u=u?u.__html:void 0)&&Ce(e,u):"children"===i?"string"==typeof u?("textarea"!==n||""!==u)&&ye(e,u):"number"==typeof u&&ye(e,""+u):"suppressContentEditableWarning"!==i&&"suppressHydrationWarning"!==i&&"autoFocus"!==i&&(c.hasOwnProperty(i)?null!=u&&"onScroll"===i&&Fa("scroll",e):null!=u&&T(e,i,u,s))}switch(n){case"input":X(e),oe(e,a,!1);break;case"textarea":X(e),ue(e);break;case"option":null!=a.value&&e.setAttribute("value",""+J(a.value));break;case"select":e.multiple=!!a.multiple,null!=(i=a.value)?le(e,!!a.multiple,i,!1):null!=a.defaultValue&&le(e,!!a.multiple,a.defaultValue,!0);break;default:"function"==typeof o.onClick&&(e.onclick=Ua)}Wa(n,a)&&(t.flags|=4)}null!==t.ref&&(t.flags|=128)}return null;case 6:if(e&&null!=t.stateNode)Zi(e,t,e.memoizedProps,a);else{if("string"!=typeof a&&null===t.stateNode)throw Error(l(166));n=Nr(Pr.current),Nr(Fr.current),jr(t)?(a=t.stateNode,n=t.memoizedProps,a[Ka]=t,a.nodeValue!==n&&(t.flags|=4)):((a=(9===n.nodeType?n:n.ownerDocument).createTextNode(a))[Ka]=t,t.stateNode=a)}return null;case 13:return mo($r),a=t.memoizedState,64&t.flags?(t.lanes=n,t):(a=null!==a,n=!1,null===e?void 0!==t.memoizedProps.fallback&&jr(t):n=null!==e.memoizedState,a&&!n&&2&t.mode&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||1&$r.current?0===Hl&&(Hl=3):(0!==Hl&&3!==Hl||(Hl=4),null===Ml||!(134217727&Vl)&&!(134217727&Wl)||vs(Ml,Dl))),(a||n)&&(t.flags|=4),null);case 4:return Or(),Yi(t),null===e&&Pa(t.stateNode.containerInfo),null;case 10:return rr(t),null;case 19:if(mo($r),null===(a=t.memoizedState))return null;if(i=!!(64&t.flags),null===(s=a.rendering))if(i)sl(a,!1);else{if(0!==Hl||null!==e&&64&e.flags)for(e=t.child;null!==e;){if(null!==(s=Hr(e))){for(t.flags|=64,sl(a,!1),null!==(i=s.updateQueue)&&(t.updateQueue=i,t.flags|=4),null===a.lastEffect&&(t.firstEffect=null),t.lastEffect=a.lastEffect,a=n,n=t.child;null!==n;)e=a,(i=n).flags&=2,i.nextEffect=null,i.firstEffect=null,i.lastEffect=null,null===(s=i.alternate)?(i.childLanes=0,i.lanes=e,i.child=null,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=s.childLanes,i.lanes=s.lanes,i.child=s.child,i.memoizedProps=s.memoizedProps,i.memoizedState=s.memoizedState,i.updateQueue=s.updateQueue,i.type=s.type,e=s.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return go($r,1&$r.current|2),t.child}e=e.sibling}null!==a.tail&&Go()>jl&&(t.flags|=64,i=!0,sl(a,!1),t.lanes=33554432)}else{if(!i)if(null!==(e=Hr(s))){if(t.flags|=64,i=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),sl(a,!0),null===a.tail&&"hidden"===a.tailMode&&!s.alternate&&!Vr)return null!==(t=t.lastEffect=a.lastEffect)&&(t.nextEffect=null),null}else 2*Go()-a.renderingStartTime>jl&&1073741824!==n&&(t.flags|=64,i=!0,sl(a,!1),t.lanes=33554432);a.isBackwards?(s.sibling=t.child,t.child=s):(null!==(n=a.last)?n.sibling=s:t.child=s,a.last=s)}return null!==a.tail?(n=a.tail,a.rendering=n,a.tail=n.sibling,a.lastEffect=t.lastEffect,a.renderingStartTime=Go(),n.sibling=null,t=$r.current,go($r,i?1&t|2:1&t),n):null;case 23:case 24:return Es(),null!==e&&null!==e.memoizedState!=(null!==t.memoizedState)&&"unstable-defer-without-hiding"!==a.mode&&(t.flags|=4),null}throw Error(l(156,t.tag))}function dl(e){switch(e.tag){case 1:yo(e.type)&&vo();var t=e.flags;return 4096&t?(e.flags=-4097&t|64,e):null;case 3:if(Or(),mo(bo),mo(po),Xr(),64&(t=e.flags))throw Error(l(285));return e.flags=-4097&t|64,e;case 5:return Br(e),null;case 13:return mo($r),4096&(t=e.flags)?(e.flags=-4097&t|64,e):null;case 19:return mo($r),null;case 4:return Or(),null;case 10:return rr(e),null;case 23:case 24:return Es(),null;default:return null}}function ul(e,t){try{var n="",a=t;do{n+=Q(a),a=a.return}while(a);var o=n}catch(e){o="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:o}}function ml(e,t){try{a.error(t.value)}catch(e){setTimeout((function(){throw e}))}}Ji=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Yi=function(){},Xi=function(e,t,n,a){var o=e.memoizedProps;if(o!==a){e=t.stateNode,Nr(Fr.current);var i,l=null;switch(n){case"input":o=ee(e,o),a=ee(e,a),l=[];break;case"option":o=ie(e,o),a=ie(e,a),l=[];break;case"select":o=r({},o,{value:void 0}),a=r({},a,{value:void 0}),l=[];break;case"textarea":o=se(e,o),a=se(e,a),l=[];break;default:"function"!=typeof o.onClick&&"function"==typeof a.onClick&&(e.onclick=Ua)}for(u in Ee(n,a),n=null,o)if(!a.hasOwnProperty(u)&&o.hasOwnProperty(u)&&null!=o[u])if("style"===u){var s=o[u];for(i in s)s.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(c.hasOwnProperty(u)?l||(l=[]):(l=l||[]).push(u,null));for(u in a){var d=a[u];if(s=null!=o?o[u]:void 0,a.hasOwnProperty(u)&&d!==s&&(null!=d||null!=s))if("style"===u)if(s){for(i in s)!s.hasOwnProperty(i)||d&&d.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in d)d.hasOwnProperty(i)&&s[i]!==d[i]&&(n||(n={}),n[i]=d[i])}else n||(l||(l=[]),l.push(u,n)),n=d;else"dangerouslySetInnerHTML"===u?(d=d?d.__html:void 0,s=s?s.__html:void 0,null!=d&&s!==d&&(l=l||[]).push(u,d)):"children"===u?"string"!=typeof d&&"number"!=typeof d||(l=l||[]).push(u,""+d):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(c.hasOwnProperty(u)?(null!=d&&"onScroll"===u&&Fa("scroll",e),l||s===d||(l=[])):"object"==typeof d&&null!==d&&d.$$typeof===O?d.toString():(l=l||[]).push(u,d))}n&&(l=l||[]).push("style",n);var u=l;(t.updateQueue=u)&&(t.flags|=4)}},Zi=function(e,t,n,a){n!==a&&(t.flags|=4)};var gl="function"==typeof WeakMap?WeakMap:Map;function hl(e,t,n){(n=mr(-1,n)).tag=3,n.payload={element:null};var a=t.value;return n.callback=function(){Zl||(Zl=!0,Kl=a),ml(0,t)},n}function pl(e,t,n){(n=mr(-1,n)).tag=3;var a=e.type.getDerivedStateFromError;if("function"==typeof a){var o=t.value;n.payload=function(){return ml(0,t),a(o)}}var r=e.stateNode;return null!==r&&"function"==typeof r.componentDidCatch&&(n.callback=function(){"function"!=typeof a&&(null===es?es=new Set([this]):es.add(this),ml(0,t));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}var bl="function"==typeof WeakSet?WeakSet:Set;function fl(e){var t=e.ref;if(null!==t)if("function"==typeof t)try{t(null)}catch(t){qs(e,t)}else t.current=null}function Cl(e,t){switch(t.tag){case 0:case 11:case 15:case 22:case 5:case 6:case 4:case 17:return;case 1:if(256&t.flags&&null!==e){var n=e.memoizedProps,a=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?n:Ko(t.type,n),a),e.__reactInternalSnapshotBeforeUpdate=t}return;case 3:return void(256&t.flags&&ja(t.stateNode.containerInfo))}throw Error(l(163))}function yl(e,t,n){switch(n.tag){case 0:case 11:case 15:case 22:if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{if(!(3&~e.tag)){var a=e.create;e.destroy=a()}e=e.next}while(e!==t)}if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{var o=e;a=o.next,4&(o=o.tag)&&1&o&&($s(n,e),Bs(n,e)),e=a}while(e!==t)}return;case 1:return e=n.stateNode,4&n.flags&&(null===t?e.componentDidMount():(a=n.elementType===n.type?t.memoizedProps:Ko(n.type,t.memoizedProps),e.componentDidUpdate(a,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate))),void(null!==(t=n.updateQueue)&&br(n,t,e));case 3:if(null!==(t=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 5:case 1:e=n.child.stateNode}br(n,t,e)}return;case 5:return e=n.stateNode,void(null===t&&4&n.flags&&Wa(n.type,n.memoizedProps)&&e.focus());case 6:case 4:case 12:case 19:case 17:case 20:case 21:case 23:case 24:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&St(n)))))}throw Error(l(163))}function vl(e,t){for(var n=e;;){if(5===n.tag){var a=n.stateNode;if(t)"function"==typeof(a=a.style).setProperty?a.setProperty("display","none","important"):a.display="none";else{a=n.stateNode;var o=n.memoizedProps.style;o=null!=o&&o.hasOwnProperty("display")?o.display:null,a.style.display=xe("display",o)}}else if(6===n.tag)n.stateNode.nodeValue=t?"":n.memoizedProps;else if((23!==n.tag&&24!==n.tag||null===n.memoizedState||n===e)&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}}function Tl(e,t){if(Io&&"function"==typeof Io.onCommitFiberUnmount)try{Io.onCommitFiberUnmount(Eo,t)}catch(e){}switch(t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var n=e=e.next;do{var a=n,o=a.destroy;if(a=a.tag,void 0!==o)if(4&a)$s(t,n);else{a=t;try{o()}catch(e){qs(a,e)}}n=n.next}while(n!==e)}break;case 1:if(fl(t),"function"==typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(e){qs(t,e)}break;case 5:fl(t);break;case 4:Rl(e,t)}}function xl(e){e.alternate=null,e.child=null,e.dependencies=null,e.firstEffect=null,e.lastEffect=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.return=null,e.updateQueue=null}function Sl(e){return 5===e.tag||3===e.tag||4===e.tag}function wl(e){e:{for(var t=e.return;null!==t;){if(Sl(t))break e;t=t.return}throw Error(l(160))}var n=t;switch(t=n.stateNode,n.tag){case 5:var a=!1;break;case 3:case 4:t=t.containerInfo,a=!0;break;default:throw Error(l(161))}16&n.flags&&(ye(t,""),n.flags&=-17);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||Sl(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.flags)continue t;if(null===n.child||4===n.tag)continue t;n.child.return=n,n=n.child}if(!(2&n.flags)){n=n.stateNode;break e}}a?El(e,n,t):Il(e,n,t)}function El(e,t,n){var a=e.tag,o=5===a||6===a;if(o)e=o?e.stateNode:e.stateNode.instance,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=Ua));else if(4!==a&&null!==(e=e.child))for(El(e,t,n),e=e.sibling;null!==e;)El(e,t,n),e=e.sibling}function Il(e,t,n){var a=e.tag,o=5===a||6===a;if(o)e=o?e.stateNode:e.stateNode.instance,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==a&&null!==(e=e.child))for(Il(e,t,n),e=e.sibling;null!==e;)Il(e,t,n),e=e.sibling}function Rl(e,t){for(var n,a,o=t,r=!1;;){if(!r){r=o.return;e:for(;;){if(null===r)throw Error(l(160));switch(n=r.stateNode,r.tag){case 5:a=!1;break e;case 3:case 4:n=n.containerInfo,a=!0;break e}r=r.return}r=!0}if(5===o.tag||6===o.tag){e:for(var i=e,s=o,c=s;;)if(Tl(i,c),null!==c.child&&4!==c.tag)c.child.return=c,c=c.child;else{if(c===s)break e;for(;null===c.sibling;){if(null===c.return||c.return===s)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}a?(i=n,s=o.stateNode,8===i.nodeType?i.parentNode.removeChild(s):i.removeChild(s)):n.removeChild(o.stateNode)}else if(4===o.tag){if(null!==o.child){n=o.stateNode.containerInfo,a=!0,o.child.return=o,o=o.child;continue}}else if(Tl(e,o),null!==o.child){o.child.return=o,o=o.child;continue}if(o===t)break;for(;null===o.sibling;){if(null===o.return||o.return===t)return;4===(o=o.return).tag&&(r=!1)}o.sibling.return=o.return,o=o.sibling}}function Al(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var a=n=n.next;do{!(3&~a.tag)&&(e=a.destroy,a.destroy=void 0,void 0!==e&&e()),a=a.next}while(a!==n)}return;case 1:case 12:case 17:return;case 5:if(null!=(n=t.stateNode)){a=t.memoizedProps;var o=null!==e?e.memoizedProps:a;e=t.type;var r=t.updateQueue;if(t.updateQueue=null,null!==r){for(n[eo]=a,"input"===e&&"radio"===a.type&&null!=a.name&&ne(n,a),Ie(e,o),t=Ie(e,a),o=0;o<r.length;o+=2){var i=r[o],s=r[o+1];"style"===i?Se(n,s):"dangerouslySetInnerHTML"===i?Ce(n,s):"children"===i?ye(n,s):T(n,i,s,t)}switch(e){case"input":ae(n,a);break;case"textarea":de(n,a);break;case"select":e=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!a.multiple,null!=(r=a.value)?le(n,!!a.multiple,r,!1):e!==!!a.multiple&&(null!=a.defaultValue?le(n,!!a.multiple,a.defaultValue,!0):le(n,!!a.multiple,a.multiple?[]:"",!1))}}}return;case 6:if(null===t.stateNode)throw Error(l(162));return void(t.stateNode.nodeValue=t.memoizedProps);case 3:return void((n=t.stateNode).hydrate&&(n.hydrate=!1,St(n.containerInfo)));case 13:return null!==t.memoizedState&&(Ql=Go(),vl(t.child,!0)),void Ll(t);case 19:return void Ll(t);case 23:case 24:return void vl(t,null!==t.memoizedState)}throw Error(l(163))}function Ll(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new bl),t.forEach((function(t){var a=Ws.bind(null,e,t);n.has(t)||(n.add(t),t.then(a,a))}))}}function kl(e,t){return null!==e&&(null===(e=e.memoizedState)||null!==e.dehydrated)&&(null!==(t=t.memoizedState)&&null===t.dehydrated)}var Fl=Math.ceil,_l=x.ReactCurrentDispatcher,Pl=x.ReactCurrentOwner,Nl=0,Ml=null,Ol=null,Dl=0,Bl=0,$l=uo(0),Hl=0,Ul=null,ql=0,Vl=0,Wl=0,Gl=0,zl=null,Ql=0,jl=1/0;function Jl(){jl=Go()+500}var Yl,Xl=null,Zl=!1,Kl=null,es=null,ts=!1,ns=null,as=90,os=[],rs=[],is=null,ls=0,ss=null,cs=-1,ds=0,us=0,ms=null,gs=!1;function hs(){return 48&Nl?Go():-1!==cs?cs:cs=Go()}function ps(e){if(!(2&(e=e.mode)))return 1;if(!(4&e))return 99===zo()?1:2;if(0===ds&&(ds=ql),0!==Zo.transition){0!==us&&(us=null!==zl?zl.pendingLanes:0),e=ds;var t=4186112&~us;return 0===(t&=-t)&&(0===(t=(e=4186112&~e)&-e)&&(t=8192)),t}return e=zo(),4&Nl&&98===e?e=Ut(12,ds):e=Ut(e=function(e){switch(e){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(e),ds),e}function bs(e,t,n){if(50<ls)throw ls=0,ss=null,Error(l(185));if(null===(e=fs(e,t)))return null;Wt(e,t,n),e===Ml&&(Wl|=t,4===Hl&&vs(e,Dl));var a=zo();1===t?8&Nl&&!(48&Nl)?Ts(e):(Cs(e,n),0===Nl&&(Jl(),Yo())):(!(4&Nl)||98!==a&&99!==a||(null===is?is=new Set([e]):is.add(e)),Cs(e,n)),zl=e}function fs(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function Cs(e,t){for(var n=e.callbackNode,a=e.suspendedLanes,o=e.pingedLanes,r=e.expirationTimes,i=e.pendingLanes;0<i;){var s=31-Gt(i),c=1<<s,d=r[s];if(-1===d){if(0===(c&a)||0!==(c&o)){d=t,Bt(c);var u=Dt;r[s]=10<=u?d+250:6<=u?d+5e3:-1}}else d<=t&&(e.expiredLanes|=c);i&=~c}if(a=$t(e,e===Ml?Dl:0),t=Dt,0===a)null!==n&&(n!==$o&&Lo(n),e.callbackNode=null,e.callbackPriority=0);else{if(null!==n){if(e.callbackPriority===t)return;n!==$o&&Lo(n)}15===t?(n=Ts.bind(null,e),null===Uo?(Uo=[n],qo=Ao(No,Xo)):Uo.push(n),n=$o):14===t?n=Jo(99,Ts.bind(null,e)):(n=function(e){switch(e){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(l(358,e))}}(t),n=Jo(n,ys.bind(null,e))),e.callbackPriority=t,e.callbackNode=n}}function ys(e){if(cs=-1,us=ds=0,48&Nl)throw Error(l(327));var t=e.callbackNode;if(Ds()&&e.callbackNode!==t)return null;var n=$t(e,e===Ml?Dl:0);if(0===n)return null;var a=n,o=Nl;Nl|=16;var r=As();for(Ml===e&&Dl===a||(Jl(),Is(e,a));;)try{Fs();break}catch(t){Rs(e,t)}if(or(),_l.current=r,Nl=o,null!==Ol?a=0:(Ml=null,Dl=0,a=Hl),0!==(ql&Wl))Is(e,0);else if(0!==a){if(2===a&&(Nl|=64,e.hydrate&&(e.hydrate=!1,ja(e.containerInfo)),0!==(n=Ht(e))&&(a=Ls(e,n))),1===a)throw t=Ul,Is(e,0),vs(e,n),Cs(e,Go()),t;switch(e.finishedWork=e.current.alternate,e.finishedLanes=n,a){case 0:case 1:throw Error(l(345));case 2:case 5:Ns(e);break;case 3:if(vs(e,n),(62914560&n)===n&&10<(a=Ql+500-Go())){if(0!==$t(e,0))break;if(((o=e.suspendedLanes)&n)!==n){hs(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=za(Ns.bind(null,e),a);break}Ns(e);break;case 4:if(vs(e,n),(4186112&n)===n)break;for(a=e.eventTimes,o=-1;0<n;){var i=31-Gt(n);r=1<<i,(i=a[i])>o&&(o=i),n&=~r}if(n=o,10<(n=(120>(n=Go()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Fl(n/1960))-n)){e.timeoutHandle=za(Ns.bind(null,e),n);break}Ns(e);break;default:throw Error(l(329))}}return Cs(e,Go()),e.callbackNode===t?ys.bind(null,e):null}function vs(e,t){for(t&=~Gl,t&=~Wl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Gt(t),a=1<<n;e[n]=-1,t&=~a}}function Ts(e){if(48&Nl)throw Error(l(327));if(Ds(),e===Ml&&0!==(e.expiredLanes&Dl)){var t=Dl,n=Ls(e,t);0!==(ql&Wl)&&(n=Ls(e,t=$t(e,t)))}else n=Ls(e,t=$t(e,0));if(0!==e.tag&&2===n&&(Nl|=64,e.hydrate&&(e.hydrate=!1,ja(e.containerInfo)),0!==(t=Ht(e))&&(n=Ls(e,t))),1===n)throw n=Ul,Is(e,0),vs(e,t),Cs(e,Go()),n;return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ns(e),Cs(e,Go()),null}function xs(e,t){var n=Nl;Nl|=1;try{return e(t)}finally{0===(Nl=n)&&(Jl(),Yo())}}function Ss(e,t){var n=Nl;Nl&=-2,Nl|=8;try{return e(t)}finally{0===(Nl=n)&&(Jl(),Yo())}}function ws(e,t){go($l,Bl),Bl|=t,ql|=t}function Es(){Bl=$l.current,mo($l)}function Is(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,Qa(n)),null!==Ol)for(n=Ol.return;null!==n;){var a=n;switch(a.tag){case 1:null!=(a=a.type.childContextTypes)&&vo();break;case 3:Or(),mo(bo),mo(po),Xr();break;case 5:Br(a);break;case 4:Or();break;case 13:case 19:mo($r);break;case 10:rr(a);break;case 23:case 24:Es()}n=n.return}Ml=e,Ol=js(e.current,null),Dl=Bl=ql=t,Hl=0,Ul=null,Gl=Wl=Vl=0}function Rs(e,t){for(;;){var n=Ol;try{if(or(),Zr.current=Pi,oi){for(var a=ti.memoizedState;null!==a;){var o=a.queue;null!==o&&(o.pending=null),a=a.next}oi=!1}if(ei=0,ai=ni=ti=null,ri=!1,Pl.current=null,null===n||null===n.return){Hl=1,Ul=t,Ol=null;break}e:{var r=e,i=n.return,l=n,s=t;if(t=Dl,l.flags|=2048,l.firstEffect=l.lastEffect=null,null!==s&&"object"==typeof s&&"function"==typeof s.then){var c=s;if(!(2&l.mode)){var d=l.alternate;d?(l.updateQueue=d.updateQueue,l.memoizedState=d.memoizedState,l.lanes=d.lanes):(l.updateQueue=null,l.memoizedState=null)}var u=!!(1&$r.current),m=i;do{var g;if(g=13===m.tag){var h=m.memoizedState;if(null!==h)g=null!==h.dehydrated;else{var p=m.memoizedProps;g=void 0!==p.fallback&&(!0!==p.unstable_avoidThisFallback||!u)}}if(g){var b=m.updateQueue;if(null===b){var f=new Set;f.add(c),m.updateQueue=f}else b.add(c);if(!(2&m.mode)){if(m.flags|=64,l.flags|=16384,l.flags&=-2981,1===l.tag)if(null===l.alternate)l.tag=17;else{var C=mr(-1,1);C.tag=2,gr(l,C)}l.lanes|=1;break e}s=void 0,l=t;var y=r.pingCache;if(null===y?(y=r.pingCache=new gl,s=new Set,y.set(c,s)):void 0===(s=y.get(c))&&(s=new Set,y.set(c,s)),!s.has(l)){s.add(l);var v=Vs.bind(null,r,c,l);c.then(v,v)}m.flags|=4096,m.lanes=t;break e}m=m.return}while(null!==m);s=Error((j(l.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==Hl&&(Hl=2),s=ul(s,l),m=i;do{switch(m.tag){case 3:r=s,m.flags|=4096,t&=-t,m.lanes|=t,hr(m,hl(0,r,t));break e;case 1:r=s;var T=m.type,x=m.stateNode;if(!(64&m.flags||"function"!=typeof T.getDerivedStateFromError&&(null===x||"function"!=typeof x.componentDidCatch||null!==es&&es.has(x)))){m.flags|=4096,t&=-t,m.lanes|=t,hr(m,pl(m,r,t));break e}}m=m.return}while(null!==m)}Ps(n)}catch(e){t=e,Ol===n&&null!==n&&(Ol=n=n.return);continue}break}}function As(){var e=_l.current;return _l.current=Pi,null===e?Pi:e}function Ls(e,t){var n=Nl;Nl|=16;var a=As();for(Ml===e&&Dl===t||Is(e,t);;)try{ks();break}catch(t){Rs(e,t)}if(or(),Nl=n,_l.current=a,null!==Ol)throw Error(l(261));return Ml=null,Dl=0,Hl}function ks(){for(;null!==Ol;)_s(Ol)}function Fs(){for(;null!==Ol&&!ko();)_s(Ol)}function _s(e){var t=Yl(e.alternate,e,Bl);e.memoizedProps=e.pendingProps,null===t?Ps(e):Ol=t,Pl.current=null}function Ps(e){var t=e;do{var n=t.alternate;if(e=t.return,2048&t.flags){if(null!==(n=dl(t)))return n.flags&=2047,void(Ol=n);null!==e&&(e.firstEffect=e.lastEffect=null,e.flags|=2048)}else{if(null!==(n=cl(n,t,Bl)))return void(Ol=n);if(24!==(n=t).tag&&23!==n.tag||null===n.memoizedState||1073741824&Bl||!(4&n.mode)){for(var a=0,o=n.child;null!==o;)a|=o.lanes|o.childLanes,o=o.sibling;n.childLanes=a}null!==e&&!(2048&e.flags)&&(null===e.firstEffect&&(e.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=t.firstEffect),e.lastEffect=t.lastEffect),1<t.flags&&(null!==e.lastEffect?e.lastEffect.nextEffect=t:e.firstEffect=t,e.lastEffect=t))}if(null!==(t=t.sibling))return void(Ol=t);Ol=t=e}while(null!==t);0===Hl&&(Hl=5)}function Ns(e){var t=zo();return jo(99,Ms.bind(null,e,t)),null}function Ms(e,t){do{Ds()}while(null!==ns);if(48&Nl)throw Error(l(327));var n=e.finishedWork;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(l(177));e.callbackNode=null;var a=n.lanes|n.childLanes,o=a,r=e.pendingLanes&~o;e.pendingLanes=o,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=o,e.mutableReadLanes&=o,e.entangledLanes&=o,o=e.entanglements;for(var i=e.eventTimes,s=e.expirationTimes;0<r;){var c=31-Gt(r),d=1<<c;o[c]=0,i[c]=-1,s[c]=-1,r&=~d}if(null!==is&&!(24&a)&&is.has(e)&&is.delete(e),e===Ml&&(Ol=Ml=null,Dl=0),1<n.flags?null!==n.lastEffect?(n.lastEffect.nextEffect=n,a=n.firstEffect):a=n:a=n.firstEffect,null!==a){if(o=Nl,Nl|=32,Pl.current=null,qa=Yt,Ca(i=fa())){if("selectionStart"in i)s={start:i.selectionStart,end:i.selectionEnd};else e:if(s=(s=i.ownerDocument)&&s.defaultView||window,(d=s.getSelection&&s.getSelection())&&0!==d.rangeCount){s=d.anchorNode,r=d.anchorOffset,c=d.focusNode,d=d.focusOffset;try{s.nodeType,c.nodeType}catch(e){s=null;break e}var u=0,m=-1,g=-1,h=0,p=0,b=i,f=null;t:for(;;){for(var C;b!==s||0!==r&&3!==b.nodeType||(m=u+r),b!==c||0!==d&&3!==b.nodeType||(g=u+d),3===b.nodeType&&(u+=b.nodeValue.length),null!==(C=b.firstChild);)f=b,b=C;for(;;){if(b===i)break t;if(f===s&&++h===r&&(m=u),f===c&&++p===d&&(g=u),null!==(C=b.nextSibling))break;f=(b=f).parentNode}b=C}s=-1===m||-1===g?null:{start:m,end:g}}else s=null;s=s||{start:0,end:0}}else s=null;Va={focusedElem:i,selectionRange:s},Yt=!1,ms=null,gs=!1,Xl=a;do{try{Os()}catch(e){if(null===Xl)throw Error(l(330));qs(Xl,e),Xl=Xl.nextEffect}}while(null!==Xl);ms=null,Xl=a;do{try{for(i=e;null!==Xl;){var y=Xl.flags;if(16&y&&ye(Xl.stateNode,""),128&y){var v=Xl.alternate;if(null!==v){var T=v.ref;null!==T&&("function"==typeof T?T(null):T.current=null)}}switch(1038&y){case 2:wl(Xl),Xl.flags&=-3;break;case 6:wl(Xl),Xl.flags&=-3,Al(Xl.alternate,Xl);break;case 1024:Xl.flags&=-1025;break;case 1028:Xl.flags&=-1025,Al(Xl.alternate,Xl);break;case 4:Al(Xl.alternate,Xl);break;case 8:Rl(i,s=Xl);var x=s.alternate;xl(s),null!==x&&xl(x)}Xl=Xl.nextEffect}}catch(e){if(null===Xl)throw Error(l(330));qs(Xl,e),Xl=Xl.nextEffect}}while(null!==Xl);if(T=Va,v=fa(),y=T.focusedElem,i=T.selectionRange,v!==y&&y&&y.ownerDocument&&ba(y.ownerDocument.documentElement,y)){null!==i&&Ca(y)&&(v=i.start,void 0===(T=i.end)&&(T=v),"selectionStart"in y?(y.selectionStart=v,y.selectionEnd=Math.min(T,y.value.length)):(T=(v=y.ownerDocument||document)&&v.defaultView||window).getSelection&&(T=T.getSelection(),s=y.textContent.length,x=Math.min(i.start,s),i=void 0===i.end?x:Math.min(i.end,s),!T.extend&&x>i&&(s=i,i=x,x=s),s=pa(y,x),r=pa(y,i),s&&r&&(1!==T.rangeCount||T.anchorNode!==s.node||T.anchorOffset!==s.offset||T.focusNode!==r.node||T.focusOffset!==r.offset)&&((v=v.createRange()).setStart(s.node,s.offset),T.removeAllRanges(),x>i?(T.addRange(v),T.extend(r.node,r.offset)):(v.setEnd(r.node,r.offset),T.addRange(v))))),v=[];for(T=y;T=T.parentNode;)1===T.nodeType&&v.push({element:T,left:T.scrollLeft,top:T.scrollTop});for("function"==typeof y.focus&&y.focus(),y=0;y<v.length;y++)(T=v[y]).element.scrollLeft=T.left,T.element.scrollTop=T.top}Yt=!!qa,Va=qa=null,e.current=n,Xl=a;do{try{for(y=e;null!==Xl;){var S=Xl.flags;if(36&S&&yl(y,Xl.alternate,Xl),128&S){v=void 0;var w=Xl.ref;if(null!==w){var E=Xl.stateNode;Xl.tag,v=E,"function"==typeof w?w(v):w.current=v}}Xl=Xl.nextEffect}}catch(e){if(null===Xl)throw Error(l(330));qs(Xl,e),Xl=Xl.nextEffect}}while(null!==Xl);Xl=null,Ho(),Nl=o}else e.current=n;if(ts)ts=!1,ns=e,as=t;else for(Xl=a;null!==Xl;)t=Xl.nextEffect,Xl.nextEffect=null,8&Xl.flags&&((S=Xl).sibling=null,S.stateNode=null),Xl=t;if(0===(a=e.pendingLanes)&&(es=null),1===a?e===ss?ls++:(ls=0,ss=e):ls=0,n=n.stateNode,Io&&"function"==typeof Io.onCommitFiberRoot)try{Io.onCommitFiberRoot(Eo,n,void 0,!(64&~n.current.flags))}catch(e){}if(Cs(e,Go()),Zl)throw Zl=!1,e=Kl,Kl=null,e;return 8&Nl||Yo(),null}function Os(){for(;null!==Xl;){var e=Xl.alternate;gs||null===ms||(8&Xl.flags?tt(Xl,ms)&&(gs=!0):13===Xl.tag&&kl(e,Xl)&&tt(Xl,ms)&&(gs=!0));var t=Xl.flags;256&t&&Cl(e,Xl),!(512&t)||ts||(ts=!0,Jo(97,(function(){return Ds(),null}))),Xl=Xl.nextEffect}}function Ds(){if(90!==as){var e=97<as?97:as;return as=90,jo(e,Hs)}return!1}function Bs(e,t){os.push(t,e),ts||(ts=!0,Jo(97,(function(){return Ds(),null})))}function $s(e,t){rs.push(t,e),ts||(ts=!0,Jo(97,(function(){return Ds(),null})))}function Hs(){if(null===ns)return!1;var e=ns;if(ns=null,48&Nl)throw Error(l(331));var t=Nl;Nl|=32;var n=rs;rs=[];for(var a=0;a<n.length;a+=2){var o=n[a],r=n[a+1],i=o.destroy;if(o.destroy=void 0,"function"==typeof i)try{i()}catch(e){if(null===r)throw Error(l(330));qs(r,e)}}for(n=os,os=[],a=0;a<n.length;a+=2){o=n[a],r=n[a+1];try{var s=o.create;o.destroy=s()}catch(e){if(null===r)throw Error(l(330));qs(r,e)}}for(s=e.current.firstEffect;null!==s;)e=s.nextEffect,s.nextEffect=null,8&s.flags&&(s.sibling=null,s.stateNode=null),s=e;return Nl=t,Yo(),!0}function Us(e,t,n){gr(e,t=hl(0,t=ul(n,t),1)),t=hs(),null!==(e=fs(e,1))&&(Wt(e,1,t),Cs(e,t))}function qs(e,t){if(3===e.tag)Us(e,e,t);else for(var n=e.return;null!==n;){if(3===n.tag){Us(n,e,t);break}if(1===n.tag){var a=n.stateNode;if("function"==typeof n.type.getDerivedStateFromError||"function"==typeof a.componentDidCatch&&(null===es||!es.has(a))){var o=pl(n,e=ul(t,e),1);if(gr(n,o),o=hs(),null!==(n=fs(n,1)))Wt(n,1,o),Cs(n,o);else if("function"==typeof a.componentDidCatch&&(null===es||!es.has(a)))try{a.componentDidCatch(t,e)}catch(e){}break}}n=n.return}}function Vs(e,t,n){var a=e.pingCache;null!==a&&a.delete(t),t=hs(),e.pingedLanes|=e.suspendedLanes&n,Ml===e&&(Dl&n)===n&&(4===Hl||3===Hl&&(62914560&Dl)===Dl&&500>Go()-Ql?Is(e,0):Gl|=n),Cs(e,t)}function Ws(e,t){var n=e.stateNode;null!==n&&n.delete(t),0===(t=0)&&(2&(t=e.mode)?4&t?(0===ds&&(ds=ql),0===(t=qt(62914560&~ds))&&(t=4194304)):t=99===zo()?1:2:t=1),n=hs(),null!==(e=fs(e,t))&&(Wt(e,t,n),Cs(e,n))}function Gs(e,t,n,a){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function zs(e,t,n,a){return new Gs(e,t,n,a)}function Qs(e){return!(!(e=e.prototype)||!e.isReactComponent)}function js(e,t){var n=e.alternate;return null===n?((n=zs(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Js(e,t,n,a,o,r){var i=2;if(a=e,"function"==typeof e)Qs(e)&&(i=1);else if("string"==typeof e)i=5;else e:switch(e){case E:return Ys(n.children,o,r,t);case D:i=8,o|=16;break;case I:i=8,o|=1;break;case R:return(e=zs(12,n,t,8|o)).elementType=R,e.type=R,e.lanes=r,e;case F:return(e=zs(13,n,t,o)).type=F,e.elementType=F,e.lanes=r,e;case _:return(e=zs(19,n,t,o)).elementType=_,e.lanes=r,e;case B:return Xs(n,o,r,t);case $:return(e=zs(24,n,t,o)).elementType=$,e.lanes=r,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case A:i=10;break e;case L:i=9;break e;case k:i=11;break e;case P:i=14;break e;case N:i=16,a=null;break e;case M:i=22;break e}throw Error(l(130,null==e?e:typeof e,""))}return(t=zs(i,n,t,o)).elementType=e,t.type=a,t.lanes=r,t}function Ys(e,t,n,a){return(e=zs(7,e,a,t)).lanes=n,e}function Xs(e,t,n,a){return(e=zs(23,e,a,t)).elementType=B,e.lanes=n,e}function Zs(e,t,n){return(e=zs(6,e,null,t)).lanes=n,e}function Ks(e,t,n){return(t=zs(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function ec(e,t,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=Vt(0),this.expirationTimes=Vt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Vt(0),this.mutableSourceEagerHydrationData=null}function tc(e,t,n,a){var o=t.current,r=hs(),i=ps(o);e:if(n){t:{if(Xe(n=n._reactInternals)!==n||1!==n.tag)throw Error(l(170));var s=n;do{switch(s.tag){case 3:s=s.stateNode.context;break t;case 1:if(yo(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break t}}s=s.return}while(null!==s);throw Error(l(171))}if(1===n.tag){var c=n.type;if(yo(c)){n=xo(n,c,s);break e}}n=s}else n=ho;return null===t.context?t.context=n:t.pendingContext=n,(t=mr(r,i)).payload={element:e},null!==(a=void 0===a?null:a)&&(t.callback=a),gr(o,t),bs(o,i,r),i}function nc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function ac(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function oc(e,t){ac(e,t),(e=e.alternate)&&ac(e,t)}function rc(e,t,n){var a=null!=n&&null!=n.hydrationOptions&&n.hydrationOptions.mutableSources||null;if(n=new ec(e,t,null!=n&&!0===n.hydrate),t=zs(3,null,null,2===t?7:1===t?3:0),n.current=t,t.stateNode=n,dr(t),e[to]=n.current,Pa(8===e.nodeType?e.parentNode:e),a)for(e=0;e<a.length;e++){var o=(t=a[e])._getVersion;o=o(t._source),null==n.mutableSourceEagerHydrationData?n.mutableSourceEagerHydrationData=[t,o]:n.mutableSourceEagerHydrationData.push(t,o)}this._internalRoot=n}function ic(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function lc(e,t,n,a,o){var r=n._reactRootContainer;if(r){var i=r._internalRoot;if("function"==typeof o){var l=o;o=function(){var e=nc(i);l.call(e)}}tc(t,i,e,o)}else{if(r=n._reactRootContainer=function(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var n;n=e.lastChild;)e.removeChild(n);return new rc(e,0,t?{hydrate:!0}:void 0)}(n,a),i=r._internalRoot,"function"==typeof o){var s=o;o=function(){var e=nc(i);s.call(e)}}Ss((function(){tc(t,i,e,o)}))}return nc(i)}function sc(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!ic(t))throw Error(l(200));return function(e,t,n){var a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==a?null:""+a,children:e,containerInfo:t,implementation:n}}(e,t,null,n)}Yl=function(e,t,n){var a=t.lanes;if(null!==e)if(e.memoizedProps!==t.pendingProps||bo.current)Bi=!0;else{if(0===(n&a)){switch(Bi=!1,t.tag){case 3:ji(t),Jr();break;case 5:Dr(t);break;case 1:yo(t.type)&&So(t);break;case 4:Mr(t,t.stateNode.containerInfo);break;case 10:a=t.memoizedProps.value;var o=t.type._context;go(er,o._currentValue),o._currentValue=a;break;case 13:if(null!==t.memoizedState)return 0!==(n&t.child.childLanes)?el(e,t,n):(go($r,1&$r.current),null!==(t=ll(e,t,n))?t.sibling:null);go($r,1&$r.current);break;case 19:if(a=0!==(n&t.childLanes),64&e.flags){if(a)return il(e,t,n);t.flags|=64}if(null!==(o=t.memoizedState)&&(o.rendering=null,o.tail=null,o.lastEffect=null),go($r,$r.current),a)break;return null;case 23:case 24:return t.lanes=0,Vi(e,t,n)}return ll(e,t,n)}Bi=!!(16384&e.flags)}else Bi=!1;switch(t.lanes=0,t.tag){case 2:if(a=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,o=Co(t,po.current),lr(t,n),o=si(null,t,a,e,o,n),t.flags|=1,"object"==typeof o&&null!==o&&"function"==typeof o.render&&void 0===o.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,yo(a)){var r=!0;So(t)}else r=!1;t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,dr(t);var i=a.getDerivedStateFromProps;"function"==typeof i&&Cr(t,a,i,e),o.updater=yr,t.stateNode=o,o._reactInternals=t,Sr(t,a,e,n),t=Qi(null,t,a,!0,r,n)}else t.tag=0,$i(null,t,o,n),t=t.child;return t;case 16:o=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,o=(r=o._init)(o._payload),t.type=o,r=t.tag=function(e){if("function"==typeof e)return Qs(e)?1:0;if(null!=e){if((e=e.$$typeof)===k)return 11;if(e===P)return 14}return 2}(o),e=Ko(o,e),r){case 0:t=Gi(null,t,o,e,n);break e;case 1:t=zi(null,t,o,e,n);break e;case 11:t=Hi(null,t,o,e,n);break e;case 14:t=Ui(null,t,o,Ko(o.type,e),a,n);break e}throw Error(l(306,o,""))}return t;case 0:return a=t.type,o=t.pendingProps,Gi(e,t,a,o=t.elementType===a?o:Ko(a,o),n);case 1:return a=t.type,o=t.pendingProps,zi(e,t,a,o=t.elementType===a?o:Ko(a,o),n);case 3:if(ji(t),a=t.updateQueue,null===e||null===a)throw Error(l(282));if(a=t.pendingProps,o=null!==(o=t.memoizedState)?o.element:null,ur(e,t),pr(t,a,null,n),(a=t.memoizedState.element)===o)Jr(),t=ll(e,t,n);else{if((r=(o=t.stateNode).hydrate)&&(qr=Ja(t.stateNode.containerInfo.firstChild),Ur=t,r=Vr=!0),r){if(null!=(e=o.mutableSourceEagerHydrationData))for(o=0;o<e.length;o+=2)(r=e[o])._workInProgressVersionPrimary=e[o+1],Yr.push(r);for(n=Lr(t,null,a,n),t.child=n;n;)n.flags=-3&n.flags|1024,n=n.sibling}else $i(e,t,a,n),Jr();t=t.child}return t;case 5:return Dr(t),null===e&&zr(t),a=t.type,o=t.pendingProps,r=null!==e?e.memoizedProps:null,i=o.children,Ga(a,o)?i=null:null!==r&&Ga(a,r)&&(t.flags|=16),Wi(e,t),$i(e,t,i,n),t.child;case 6:return null===e&&zr(t),null;case 13:return el(e,t,n);case 4:return Mr(t,t.stateNode.containerInfo),a=t.pendingProps,null===e?t.child=Ar(t,null,a,n):$i(e,t,a,n),t.child;case 11:return a=t.type,o=t.pendingProps,Hi(e,t,a,o=t.elementType===a?o:Ko(a,o),n);case 7:return $i(e,t,t.pendingProps,n),t.child;case 8:case 12:return $i(e,t,t.pendingProps.children,n),t.child;case 10:e:{a=t.type._context,o=t.pendingProps,i=t.memoizedProps,r=o.value;var s=t.type._context;if(go(er,s._currentValue),s._currentValue=r,null!==i)if(s=i.value,0===(r=ua(s,r)?0:0|("function"==typeof a._calculateChangedBits?a._calculateChangedBits(s,r):1073741823))){if(i.children===o.children&&!bo.current){t=ll(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var c=s.dependencies;if(null!==c){i=s.child;for(var d=c.firstContext;null!==d;){if(d.context===a&&0!==(d.observedBits&r)){1===s.tag&&((d=mr(-1,n&-n)).tag=2,gr(s,d)),s.lanes|=n,null!==(d=s.alternate)&&(d.lanes|=n),ir(s.return,n),c.lanes|=n;break}d=d.next}}else i=10===s.tag&&s.type===t.type?null:s.child;if(null!==i)i.return=s;else for(i=s;null!==i;){if(i===t){i=null;break}if(null!==(s=i.sibling)){s.return=i.return,i=s;break}i=i.return}s=i}$i(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,a=(r=t.pendingProps).children,lr(t,n),a=a(o=sr(o,r.unstable_observedBits)),t.flags|=1,$i(e,t,a,n),t.child;case 14:return r=Ko(o=t.type,t.pendingProps),Ui(e,t,o,r=Ko(o.type,r),a,n);case 15:return qi(e,t,t.type,t.pendingProps,a,n);case 17:return a=t.type,o=t.pendingProps,o=t.elementType===a?o:Ko(a,o),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,yo(a)?(e=!0,So(t)):e=!1,lr(t,n),Tr(t,a,o),Sr(t,a,o,n),Qi(null,t,a,!0,e,n);case 19:return il(e,t,n);case 23:case 24:return Vi(e,t,n)}throw Error(l(156,t.tag))},rc.prototype.render=function(e){tc(e,this._internalRoot,null,null)},rc.prototype.unmount=function(){var e=this._internalRoot,t=e.containerInfo;tc(null,e,null,(function(){t[to]=null}))},nt=function(e){13===e.tag&&(bs(e,4,hs()),oc(e,4))},at=function(e){13===e.tag&&(bs(e,67108864,hs()),oc(e,67108864))},ot=function(e){if(13===e.tag){var t=hs(),n=ps(e);bs(e,n,t),oc(e,n)}},rt=function(e,t){return t()},Ae=function(e,t,n){switch(t){case"input":if(ae(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var a=n[t];if(a!==e&&a.form===e.form){var o=io(a);if(!o)throw Error(l(90));Z(a),ae(a,o)}}}break;case"textarea":de(e,n);break;case"select":null!=(t=n.value)&&le(e,!!n.multiple,t,!1)}},Ne=xs,Me=function(e,t,n,a,o){var r=Nl;Nl|=4;try{return jo(98,e.bind(null,t,n,a,o))}finally{0===(Nl=r)&&(Jl(),Yo())}},Oe=function(){!(49&Nl)&&(function(){if(null!==is){var e=is;is=null,e.forEach((function(e){e.expiredLanes|=24&e.pendingLanes,Cs(e,Go())}))}Yo()}(),Ds())},De=function(e,t){var n=Nl;Nl|=2;try{return e(t)}finally{0===(Nl=n)&&(Jl(),Yo())}};var cc={Events:[oo,ro,io,_e,Pe,Ds,{current:!1}]},dc={findFiberByHostInstance:ao,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},uc={bundleType:dc.bundleType,version:dc.version,rendererPackageName:dc.rendererPackageName,rendererConfig:dc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=et(e))?null:e.stateNode},findFiberByHostInstance:dc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var mc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!mc.isDisabled&&mc.supportsFiber)try{Eo=mc.inject(uc),Io=mc}catch(fe){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cc,t.createPortal=sc,t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(l(188));throw Error(l(268,Object.keys(e)))}return e=null===(e=et(t))?null:e.stateNode},t.flushSync=function(e,t){var n=Nl;if(48&n)return e(t);Nl|=1;try{if(e)return jo(99,e.bind(null,t))}finally{Nl=n,Yo()}},t.hydrate=function(e,t,n){if(!ic(t))throw Error(l(200));return lc(null,e,t,!0,n)},t.render=function(e,t,n){if(!ic(t))throw Error(l(200));return lc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!ic(e))throw Error(l(40));return!!e._reactRootContainer&&(Ss((function(){lc(null,null,e,!1,(function(){e._reactRootContainer=null,e[to]=null}))})),!0)},t.unstable_batchedUpdates=xs,t.unstable_createPortal=function(e,t){return sc(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},t.unstable_renderSubtreeIntoContainer=function(e,t,n,a){if(!ic(n))throw Error(l(200));if(null==e||void 0===e._reactInternals)throw Error(l(38));return lc(e,t,n,!1,a)},t.version="17.0.2"},178360:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateV1State=void 0;const a=n(575976),o=n(154836),r={};function i(e,t,n){return e.msecs??=-1/0,e.nsecs??=0,t===e.msecs?(e.nsecs++,e.nsecs>=1e4&&(e.node=void 0,e.nsecs=0)):t>e.msecs?e.nsecs=0:t<e.msecs&&(e.node=void 0),e.node||(e.node=n.slice(10,16),e.node[0]|=1,e.clockseq=16383&(n[8]<<8|n[9])),e.msecs=t,e}function l(e,t,n,a,o,r,i=0){if(e.length<16)throw new Error("Random bytes length must be >= 16");if(r){if(i<0||i+16>r.length)throw new RangeError(`UUID byte range ${i}:${i+15} is out of buffer bounds`)}else r=new Uint8Array(16),i=0;t??=Date.now(),n??=0,a??=16383&(e[8]<<8|e[9]),o??=e.slice(10,16);const l=(1e4*(268435455&(t+=122192928e5))+n)%4294967296;r[i++]=l>>>24&255,r[i++]=l>>>16&255,r[i++]=l>>>8&255,r[i++]=255&l;const s=t/4294967296*1e4&268435455;r[i++]=s>>>8&255,r[i++]=255&s,r[i++]=s>>>24&15|16,r[i++]=s>>>16&255,r[i++]=a>>>8|128,r[i++]=255&a;for(let e=0;e<6;++e)r[i++]=o[e];return r}t.updateV1State=i,t.default=function(e,t,n){let s;const c=e?._v6??!1;if(e){const t=Object.keys(e);1===t.length&&"_v6"===t[0]&&(e=void 0)}if(e)s=l(e.random??e.rng?.()??(0,a.default)(),e.msecs,e.nsecs,e.clockseq,e.node,t,n);else{const e=Date.now(),o=(0,a.default)();i(r,e,o),s=l(o,r.msecs,r.nsecs,c?void 0:r.clockseq,c?void 0:r.node,t,n)}return t??(0,o.unsafeStringify)(s)}},178365:(e,t,n)=>{"use strict";n.d(t,{$:()=>w});var a=n(639765),o=n(548366),r=n(86940),i=n(293879),l=n(656931),s=n(517582),c=n(306148),d=n(857677),u=n(83437),m=n(76872),g=n(75496),h=n(316904),p=n(314793),b=n(109174),f=n(92520),C=n(347145),y=n(694592),v=n(2928),T=n(795786);const x=h.M.getInstance(),S=m.E.getInstance();class w{static getInstance(){return w.instance||(w.instance=new w),w.instance}setCopilotRef(e){this.copilotChatRef=e}getCopilotRef(){return this.copilotChatRef}getChatLog(){return this.chatLog}getChatHistory(){return this.chatLog.map((e=>this.convertResponseMessageToOCVChatHistoryMessage(e)))}setLastUserUtterance(e){this.lastUserUtterance=e,this.chatLog.push({chatCardType:r._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Human,messageHeader:{text:e}}}})}setLastUserImage(e){e.length>0?this.lastUserImage=e[e.length-1]:this.lastUserImage=""}setIsSkillResponseRequired(e){this.isSkillResponseRequired=e}getIsSkillResponseRequired(){return this.isSkillResponseRequired}getLastUserUtterance(){return this.lastUserUtterance}getLastUserImage(){return this.lastUserImage}getHasMessageBeenShown(e,t=!1){return!!(this.displayedMessageIds.includes(e)||t&&e&&this.copilotChatRef?.current?.hasMessage(e))}getInputText(){return this.copilotChatRef?.current?.getInputText?.()??""}setInputText(e){(0,f.cY)("Setting input text"),this.copilotChatRef?.current?.setInputAreaText(e),this.setInputFocus()}scrollToBottom(){(0,f.cY)("scroll to bottom"),this.copilotChatRef?.current?.scrollToBottom()}shouldScrollToBottom(){return!b.CP.pythonContextManager.isPythonMode||b.CP.pythonContextManager.isAutoScrollingEnabled||!(0,C.LhK)()}addMessageIfNeeded(e,t,n){const a=!this.getHasMessageBeenShown(e);(0,f.cY)("Trying to add messageId: ",e),a&&(this.displayedMessageIds.push(e),this.displayResponse(t,n),(0,f.cY)("Added messageId: ",e))}displayResponse(e,t,n={}){const{shouldShowWhenFluxSkillResponseRequired:a=!0,logAshaError:o=!0}=n;if(t&&(this.submitChatMessageTelemetry(t,o),e.chatMessageBodyData&&(e.chatMessageBodyData.telemetryData=JSON.stringify(t))),!this.getShouldShowMessage(a))return void(0,f.cY)("Skipping response display : ",e);(0,f.cY)("Displaying response : ",e),this.addFeedbackDataToMessage(e),this.chatLog.push(e),n?.replaceExistingMessage?this.copilotChatRef?.current?.updateMessage(e):(this.copilotChatRef?.current?.addResponseMessage(e),(0,C.LhK)()&&b.CP.pythonContextManager.isPythonMode&&(b.CP.pythonContextManager.renderedCardCount+=1)),this.getIsHumanMessage(e)&&(0,c.s_)(c.H0.RemoveAll),this.getIsSkillResponseRequired()&&s.Q.getInstance().recordFluxCopilotStep({operation:d.OP.FluxSkillCardShown});const r=h.M.getInstance().getStandardizedFeatureForSubFeature(t?.featureName);l.Z.getInstance().endUserPerceivedLatency(!0!==e.chatMessageBodyData?.isFailure,r===d.BJ.CopilotChat?void 0:r,"displayResponse: Feature from telemetry.featureName does not match active feature.")}displayErrorResponseIfNeeded(e,t,n={}){return t?.errorType!==d.q0.BadToken&&t?.errorType!==d.q0.LicensingError||0!==this.chatLog.length&&this.getIsHumanMessage(this.chatLog[this.chatLog.length-1])?(this.displayResponse(e,t,n),!0):(x.logError({eventType:g.S2.ChatEvents,errorMessage:`Not showing the error message for ${t.errorType} as the last message is not from the user`,logLevel:u.$b.Warning}),!1)}updateLastMessage(e){(0,f.cY)("Updating response : ",e);const t=this.chatLog[this.chatLog.length-1]?.chatMessageBodyData?.messageId;this.updateChatLogMessage(t,e),this.copilotChatRef?.current?.updateLastMessage(e)}updateMessage(e){(0,f.cY)("Updating response : ",e),this.updateChatLogMessage(e?.chatMessageBodyData?.messageId,e),this.copilotChatRef?.current?.updateMessage(e)}resendChatHistorySignal(e,t){this.copilotChatRef?.current?.resendChatHistorySignal(e,t)}deleteMessage(e){(0,f.cY)("Deleting response : "+e),this.copilotChatRef?.current?.deleteMessage(e)}startReinitializeALSession(){(0,f.cY)("startReinitializeALSession"),this.copilotChatRef?.current?.startReinitializeALSession()}activateAugloopAnnotations(){(0,f.cY)("activate augloop anotations"),this.copilotChatRef?.current?.activateClientALAnnotations()}submitOperation(e){(0,f.cY)("Submitting signal : ",e),this.copilotChatRef?.current?.submitOperation(e)}updateLoadingComponentProps(e){(0,f.cY)("Updating loading component props"),this.copilotChatRef?.current?.updateLoadingComponentProps(e)}getIsHumanMessage(e){const t=e.chatMessageData;return t?.defaultMessageProps?.user===i.Q9.Human||t?.accordionCardProps?.user===i.Q9.Human||t?.chatCardWrapperProps?.user===i.Q9.Human||t?.contentCardProps?.user===i.Q9.Human||t?.copilotWorkflowsCardProps?.user===i.Q9.Human||t?.markDownCardProps?.user===i.Q9.Human||t?.paginatedCardProps?.user===i.Q9.Human||t?.proactiveSuggestionCardProps?.user===i.Q9.Human||t?.reviewAgentCardProps?.user===i.Q9.Human||t?.reviewerSummaryCardProps?.user===i.Q9.Human||t?.selfHelpAdaptiveCardProps?.user===i.Q9.Human||t?.streamingAdaptiveCardProps?.user===i.Q9.Human||t?.warningMessageCardProps?.user===i.Q9.Human}getLastMessage(e){return(0,f.cY)("Getting last message"),this.copilotChatRef?.current?.getLastMessage(e)}startLoadingPaneTimeout(e){(0,f.cY)("PaneBoot - Start loading pane"),this.startLoadingPaneId=window.setTimeout((()=>{(0,f.cY)(`PaneBoot - logging ASHA: ${o.W.Copilot_Chat_Pane_Failed_To_Load}; Hang ${e?"after disabled screen":""}`),h.M.getInstance().logStandardizedAshaErrorEvent(o.W.Copilot_Chat_Pane_Failed_To_Load,e?a.c.Pane_Taking_Too_Long_To_Load_After_Disabled_Screen:a.c.Pane_Taking_Too_Long_To_Load,d.BJ.CopilotChat,!1)}),p.R.getLoadPaneAshaTimeout())}clearLoadingPaneTimeout(){(0,f.cY)("PaneBoot - Stop loading pane"),this.startLoadingPaneId&&clearTimeout(this.startLoadingPaneId)}startLoadingUi(){(0,f.cY)("Start loading ui"),this.startLoadingUiId=window.setTimeout((()=>{this.startLoadingUiId=void 0,this.copilotChatRef?.current?.startLoadingUi()}),0),(0,C.yw9)("OfficeVSO_10215994_LogErrorIfLoadingUIRunningForOver1Min")&&(this.startLoadingUiIdTelemetryId=window.setTimeout((()=>{x.logError({eventType:g.S2.ChatEvents,errorMessage:"CopilotChatUIHelper: Loading UI has been running for over 1 minute.",logLevel:u.$b.Error})}),6e4))}setInputFocus(){(0,f.cY)("Setting input focus"),this.copilotChatRef?.current?.setInputFocus()}stopLoadingUi(){if((0,f.cY)("Stop loading ui"),(0,C.yw9)("OfficeVSO_10215994_LogErrorIfLoadingUIRunningForOver1Min")&&this.startLoadingUiIdTelemetryId&&clearTimeout(this.startLoadingUiIdTelemetryId),this.startLoadingUiId)return void clearTimeout(this.startLoadingUiId);const e=w.getInstance().getLastMessage();(0,C.yw9)("OfficeVSO_8923945_UpdateLastMessage")?w.getInstance().updateMessage({chatCardType:r._.Default,chatMessageBodyData:{messageId:e?.messageId},addCardToChatHistory:!1,stopLoadingUi:!0}):this.updateLastMessage({chatCardType:r._.Default,addCardToChatHistory:!1,stopLoadingUi:!0})}submitUserQuery(e){this.copilotChatRef?.current?.submitUserQuery({text:e})}displayChartStylesResponse(e,t,n){if((0,C.IU1)()){const a={queryId:e,initializeUpdateCallbackLogic:(e,t)=>{this.onChartNewRecommendationAvailable=e,this.onChartRecommendationPreprocessing=t},isTriggeredViaOOUI:t,onAllRecommendationsAdded:n},{message:o,telemetry:r}=T.n.getChartDesignRecommendationsResponseMessage(e,a);w.getInstance().displayResponse(o,r)}}getShouldShowMessage(e){return!this.isSkillResponseRequired||!!e}handleEndOfQuery(e){(0,C.yw9)("OfficeVSO_10021705_SendTelemetryForMultipleCardsOnError")&&this.validateExpectedResponseContentAndStructure(e)}validateExpectedResponseContentAndStructure(e){if(""===e)return;void 0===e&&(e=this.getRequestIdFromMessage(this.chatLog[this.chatLog.length-1]));const t=[];for(let n=this.chatLog.length-1;n>=0;n--){const a=this.chatLog[n],o=this.getRequestIdFromMessage(a);if(!o)continue;if(!("Copilot\\Else"===a.chatMessageBodyData?.feedbackData?.feedbackArea)||o!==e)if(o!==e){if(o!==e)break}else t.push(a)}let n=!1;if(n=t.length>1&&t.some((e=>!0===e.chatMessageBodyData?.isFailure)),n){const e=[{key:"numberOfMessages",value:t.length}];x.logError({eventType:g.S2.ChatEvents,errorMessage:"Unexpected response structure - multiple responses including one or more errors",logLevel:u.$b.Error},void 0,e)}}getRequestIdFromMessage(e){const t=e.chatMessageBodyData?.feedbackData?.contextData?.cardMetaData;let n="";try{n=JSON.parse(t??"{}")?.promptId}catch(e){return}return n}addFeedbackDataToMessage(e){e.chatMessageBodyData={...e.chatMessageBodyData??{},feedbackData:{contextData:{cardMetaData:JSON.stringify({prompt:this.lastUserUtterance,promptId:h.M.userQueryGuid,...(0,C.yw9)("OfficeVSO_8546828_SupportingSuggestionIdForExcelCopilotCC")?JSON.parse(e.chatMessageBodyData?.feedbackData?.contextData?.cardMetaData??"{}")??{}:{}}),feedbackClientAppName:(0,y.f2)()},feedbackArea:e.chatMessageBodyData?.feedbackData?.feedbackArea??"Copilot"}}}isChatMessageError(e){return(e.eventType===d.a5.ErrorMessage||e.eventType===d.a5.HandoffMessageIdResponseError)&&!(0,v.$o)(e.errorType)}convertResponseMessageToOCVChatHistoryMessage(e){if(e.chatMessageBodyData?.telemetryData){const t=JSON.parse(e.chatMessageBodyData.telemetryData);if(t.errorType)return{user:i.Q9.Chat,message:e.chatMessageData?.defaultMessageProps?.messageHeader?.text,errorType:t.errorType}}let t="";switch(e.chatCardType){case r._.Default:t=e.chatMessageData?.defaultMessageProps?.messageHeader?.text;break;case r._.MarkdownCard:t=e.chatMessageData?.markDownCardProps?.message;break;case r._.ChatCardWrapper:t=e.chatMessageData?.chatCardWrapperProps?.textContent;break;case r._.SelfHelpAdaptiveCard:t="A SelfHelpAdaptiveCard was shown with the following props: "+JSON.stringify(e.chatMessageData?.selfHelpAdaptiveCardProps);break;case r._.StreamingAdaptiveCard:t="A StreamingAdaptiveCard was shown with the following props: "+JSON.stringify(e.chatMessageData?.streamingAdaptiveCardProps);break;case r._.WarningMessage:t="A WarningMessage was shown with the following props: "+JSON.stringify(e.chatMessageData?.warningMessageCardProps);break;default:t=JSON.stringify(e.chatMessageData)}return(0,C.eFk)()?{user:this.getIsHumanMessage(e)?i.Q9.Human:i.Q9.Chat,message:t,metadata:e.chatMessageBodyData?.aiResponseMetadata}:{user:this.getIsHumanMessage(e)?i.Q9.Human:i.Q9.Chat,message:t}}updateChatLogMessage(e,t){if(!e)return;const n=this.chatLog.find((t=>t?.chatMessageBodyData?.messageId===e));if(n?.chatCardType!==r._.MarkdownCard)return;const a=n?.chatMessageData?.markDownCardProps,o=t?.chatMessageData?.markDownCardProps;a&&o&&(a.message=o.message)}constructor(){this.chatLog=[],this.lastUserUtterance="",this.lastUserImage="",this.displayedMessageIds=[],this.isSkillResponseRequired=!1,this.doesLastResponseHaveTable=!1,this.onChartNewRecommendationAvailable=()=>{},this.onChartRecommendationPreprocessing=()=>{},this.submitChatMessageTelemetry=(e,t)=>{if((0,f.cY)("submitChatMessageTelemetry",e),e){if(S.updateTelemetryChatEventData({[d.h3.ChatEventType]:e.eventType,...(0,d.j)(b.CP),[d.h3.ChatEventParameters]:JSON.stringify({featureName:e.featureName,errorType:e.errorType,errorDetails:e.errorDetails})},x),this.isChatMessageError(e)&&t){const t=h.M.getInstance().getStandardizedFeatureForSubFeature(e?.featureName);h.M.getInstance().logStandardizedAshaErrorEvent(o.W.Unclassified_Chat_Failure,a.c.Chat_Error_Message_Shown,t)}}else(0,f.cY)("[ERROR] Failed to emit chat log telemetry!!!")}}}},181730:(e,t,n)=>{"use strict";n.d(t,{C:()=>i,p:()=>l});var a=n(693226),o=n(795786),r=n(507628);function i(e,t=!1){const n={chunks:e,isUpdatedCodeChunk:t};return{type:a.Rq.Python,metadata:JSON.stringify(n)}}class l{static getInstance(e){return l.instance||(l.instance=new l(e)),l.instance}updateCard(e,t){this.pythonResponseChunks=[...this.pythonResponseChunks,t];const n=this.pythonResponseChunks.length>1;o.n.displayPythonMergedCardResponse(this.dispatch,this.pythonResponseChunks,n,"finalText"===t.type,e,this.messageId),"finalText"===t.type&&(this.pythonResponseChunks=[],this.messageId=(0,r.A)())}dismissLoadingUI(e){const t=this.pythonResponseChunks.length>1;o.n.displayPythonMergedCardResponse(this.dispatch,this.pythonResponseChunks,t,!0,e,this.messageId),this.pythonResponseChunks=[],this.messageId=(0,r.A)()}resetCard(){this.pythonResponseChunks=[],this.messageId=(0,r.A)()}constructor(e){this.pythonResponseChunks=[],this.messageId=(0,r.A)(),this.dispatch=e}}},185877:e=>{"use strict";e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},188053:(e,t,n)=>{"use strict";n.d(t,{N:()=>a});class a{getTable(e){return this.tableName?e.workbook.worksheets.getItem(this.sheetId).tables.getItem(this.tableName):null}getSheet(e){return e.workbook.worksheets.getItem(this.sheetId)}getRange(e){return e.workbook.worksheets.getItem(this.sheetId).getRange(this.address)}getRangeFromReferences(e,t){if(1!==t.length)throw new Error("Invalid number of references.");const n=this.getRange(e),{top:a,right:o,bottom:r,left:i}=t[0],l=n.getCell(a,i),s=n.getCell(r,o);return l.getBoundingRect(s)}getTopLeftCell(e){return e.workbook.worksheets.getItem(this.sheetId).getRange(this.address).getCell(0,0)}constructor(e,t,n,a){this.sheetId=e,this.sheetName=t,this.address=n,this.tableName=a}}},197665:(e,t,n)=>{"use strict";n.d(t,{ET:()=>u,H5:()=>c,Yd:()=>s,iJ:()=>l,vI:()=>d});var a=n(472096),o=n(702864),r=n(274576),i=n(507628);class l extends a.Gt{static async performUndo(){await Excel.run((async e=>{e.application.undo(),await e.sync()}))}static async startUndoScope(){await Excel.run((async e=>{e.application.undoScope.open((0,i.A)()),await e.sync()})),o.xP.transitionAddinState(o.aB.ScopeStarted)}static async endUndoScope(){await Excel.run((async e=>{e.application.undoScope.close(),await e.sync()}))}}function s(){return Office.context.displayLanguage}function c(){return new Promise((function(e){Office.context.document.getFilePropertiesAsync((function(t){e(t.value?.url)}))}))}function d(){return Office.context.diagnostics.platform}function u(){switch(Office.context.diagnostics.platform){case Office.PlatformType.PC:return r.mp.Win32;case Office.PlatformType.Mac:return r.mp.MacOS;case Office.PlatformType.iOS:return r.mp.iPad;case Office.PlatformType.OfficeOnline:return r.mp.Web;default:return r.mp.Unknown}}},198588:(e,t,n)=>{"use strict";function a(e){const t=e.visual.visualType;return"PivotChartVisual"===t||"PivotTableVisual"===t}function o(e){const{row:t,column:n,dataFieldIndex:a,value:o}=e;return void 0!==t&&void 0!==n&&void 0===a&&void 0===o}function r(e){const{row:t,column:n,dataFieldIndex:a,value:o}=e;return void 0===t&&void 0===n&&void 0===a&&void 0!==o}function i(e){const{row:t,column:n,dataFieldIndex:a,value:o}=e;return void 0===t&&void 0===n&&void 0!==a&&void 0===o}function l(e){const{row:t,column:n,dataFieldIndex:a,value:o}=e;return void 0!==t&&void 0!==n&&void 0!==a&&void 0===o}function s(e){return!e.some((e=>e.some((e=>!!e&&(void 0!==e.value||(void 0!==e.row||void 0!==e.column)&&void 0===e.dataFieldIndex)))))}var c;n.d(t,{Bs:()=>l,J:()=>c,MB:()=>r,RY:()=>s,ir:()=>o,tz:()=>a,vL:()=>i}),function(e){e.Self="self",e.EvaluateQuery="evaluate-query",e.AnalyzeTyping="analyze-typing",e.GenerateSuggestedQueries="generate-suggested-queries",e.GenerateResultForNLEvaluation="generate-result-for-nl-evaluation",e.NLEvaluationResult="nl-evaluation-result",e.Interpretations="interpretations"}(c||(c={}))},206389:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{z:()=>getOfficeJSClientProps});var _utils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(92520),_insights_api_excel_flighting__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(347145);function getOfficeJSClientProps(){if(!(0,_insights_api_excel_flighting__WEBPACK_IMPORTED_MODULE_1__.NbV)())return;const officeJSTool={name:"OfficeJSExecutor",description:"Executor for OfficeJS code",inputSchema:{type:"object",properties:{officejs:{type:"string",description:(0,_insights_api_excel_flighting__WEBPACK_IMPORTED_MODULE_1__.qMK)()||'OfficeJS code in format "{(async () => {<insert code here>); resolve(<result>)})();}". Should always resolve result that can be used as input for jsonify. No output to console or use of return. No data processing or mix of document set/gets in a script.'}},required:["officejs"],additionalProperties:!1,$schema:"https://json-schema.org/draft-07/schema#"}},getOfficeJSTools=()=>({tools:[officeJSTool]}),callOfficeJSTool=async(toolName,args)=>{if(toolName!==officeJSTool.name)throw new Error(`Unknown tool name: ${toolName}`);const executeOfficeJSCodeForChatInput=async officejs=>{const waitEval=ev=>new Promise(((resolve,reject)=>{eval(ev)})),transpileTypeScript=async function(e){return(await Promise.all([__webpack_require__.e("vendors-npm_store_sdx_officecopilot_typescript_5_0_4-007004e2f84938dc12ca_node_modules_typesc-351a83"),__webpack_require__.e("ts")]).then(__webpack_require__.t.bind(__webpack_require__,508479,23))).transpile(e)},jsCode=await transpileTypeScript(officejs),result=await(async()=>{try{return await waitEval(jsCode)}catch(e){const t=e instanceof Error?e.message:String(e);return(0,_utils__WEBPACK_IMPORTED_MODULE_0__.cY)(`Syntax Error jsCode: ${jsCode}\n Error: ${t}`),t}})();return result};return await executeOfficeJSCodeForChatInput(args.officejs)};return{getLocalTools:getOfficeJSTools,callLocalTool:callOfficeJSTool}}},207545:(e,t,n)=>{"use strict";n.d(t,{B2:()=>c,Bv:()=>i,I_:()=>s,TB:()=>u,kH:()=>l,xC:()=>d,zj:()=>r});var a=n(77296),o=n(638753),r={AugloopSharedSessionID:"AugloopSharedSessionID",HandoffMessageId:"HandoffMessageId",HandoffMessage:"HandoffMessage",AugLoopCloudALServiceUrl:"AugloopClouldALServiceUrl",CopilotEntryPoint:"CopilotEntryPoint",CopilotStartResponse:"copilotStartResponse",CopilotStartQuery:"CopilotStartQuery",CopilotInitialPrompt:"CopilotInitialPrompt",CopilotStartPromptId:"CopilotStartPromptId",AugloopEverHadModelError:"AugloopEverHadModelError",AudienceGroup:"AudienceGroup",AppStartTimestamp:"AppStartTimestamp",CopilotPaneStartTimestamp:"StartTimeMs",AutoOpenChatPane:"AutoOpenChatPane",BizChatHostContext:"BizChatHostContext"},i={Dogfood:"Dogfood",GCC:"GCC",MSIT:"MSIT",Prod:"Prod",Test:"Test",Microsoft:"Microsoft",Production:"Production",Automation:"Automation"},l=function(){function e(){}return e.getSettingsArray=function(e){return e?"undefined"!=typeof Office&&Office.context&&Office.context.document?Office.context.document.settings:void 0:"undefined"!=typeof Office&&Office.context?Office.context.hostSettings:void 0},e.getSettingAsString=function(e,t){var n;if((0,a.isTest)())return"TestSetting";var r=null===(n=this.getSettingsArray(t))||void 0===n?void 0:n.get(e);return(0,o.hX)(r)?r:r.toString()},e.getSetting=function(e,t){var n;return null===(n=this.getSettingsArray(t))||void 0===n?void 0:n.get(e.toString())},e.removeSetting=function(e,t){var n;null===(n=this.getSettingsArray(t))||void 0===n||n.remove(e)},e.set=function(e,t,n){var a;null===(a=this.getSettingsArray(n))||void 0===a||a.set(e,"string"==typeof t?t:JSON.stringify(t))},e.setByKey=function(e,t,n){var a;null===(a=this.getSettingsArray(n))||void 0===a||a.set(e,"string"==typeof t?t:JSON.stringify(t))},e.setHostSettings=function(e,t){var n=this;Object.keys(e).forEach((function(a){var r=(0,o.gZ)(e[a]);n.setByKey(a,r,t)}))},e.IsSettingTrue=function(e,t){var n=this.getSettingAsString(e,t);return!!n&&"true"===n.toLowerCase()},e}();function s(){var e=l.getSettingAsString(r.AudienceGroup);return e===i.Automation||e===i.Dogfood}function c(){var e=l.getSettingAsString(r.AudienceGroup);return e===i.Microsoft||e===i.MSIT}function d(){var e=l.getSettingAsString(r.AudienceGroup);return e===i.Production||e===i.Prod}function u(){var e=l.getSettingAsString(r.AugLoopCloudALServiceUrl);return!!(null==e?void 0:e.toLowerCase().includes("augloop-gcc"))}},211006:(e,t,n)=>{"use strict";n.d(t,{Hg:()=>u,PE:()=>g,lW:()=>s,tx:()=>c,vH:()=>m,zz:()=>d});var a=n(843338),o=n(111201),r=n(197665),i=n(92520),l=n(208520);const s=async e=>{try{await navigator.clipboard.writeText(e)}catch(e){(0,i.cY)("Failed to copy text to clipboard:",e)}},c=(e,t)=>l.createElement("div",{"aria-label":e,role:"button",tabIndex:0},l.createElement(a.Q,{truncate:!0,wrap:!1},e),l.createElement("br",null),l.createElement(o.M,null,"[queryId: ",t,"]")),d=e=>{let t=`${e.serviceName}:${e.metricType}`;if("PolymerLLMImprovedNetworking"===e.serviceName||"DeepLeoImprovedNetworking"===e.serviceName){t=`Sydney:${e.tags.length>0?e.tags[0]:e.metricType}`}return l.createElement("div",null,l.createElement("span",null,t)," ",l.createElement("span",{style:{color:"Success"===e.status?"green":"red"}},"[",e.status,"]")," ",l.createElement("span",null,"[",e.latencyMilliseconds,"ms]"))},u=e=>{try{const t=e.indexOf("{"),n=e.lastIndexOf("}"),a=-1!==t&&-1!==n?e.substring(t,n+1):e,o=JSON.parse(a);return o.prompt?o.prompt.replace(/\\n/g,"\n"):o.text?o.text.replace(/\\n/g,"\n"):o.choices&&o.choices.length>0?o.choices[0]?.text:JSON.stringify(o,null,2)}catch(t){return e}},m=()=>(0,r.vI)()!==Office.PlatformType.OfficeOnline&&!!window.showDirectoryPicker,g=async(e,t,n,a)=>{const o=new Blob([e],{type:t});if(n=(e=>e.replace(/[/?<>\\:*|"]/g,"").replace(/[\x00-\x1f\x80-\x9f]/g,"").replace(/^\.+$/,"").replace(/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,"").replace(/[. ]+$/,"").substring(0,255))(n),a&&m()){const e=await a.getFileHandle(n,{create:!0}),t=await e.createWritable();return await t.write(o),void t.close()}const r=window.URL.createObjectURL(o),i=document.createElement("a");i.href=r,i.download=n,i.click()}},212605:(e,t,n)=>{"use strict";n.d(t,{n:()=>M});var a=n(86940),o=n(293879),r=n(708353),i=n(59653),l=n(178365),s=n(279395),c=n(291436),d=n(879162),u=n(12855),m=n(857677),g=n(75496),h=n(664007),p=n(109174),b=n(164976),f=n(126521),C=n(181730),y=n(468967),v=n(347145),T=n(779939),x=n(694592),S=n(382736),w=n(639969),E=n(306148),I=n(799765),R=n(821845),A=n(469486),L=n(507628);function k(e,t,n){try{const n=t.extractOper(e);return t.checkIsBusy(n)?void 0:n}catch(e){const t=(0,y.pz)((0,y.MQ)(e,"getCellTypeAndValueIfNotBusy"),e);return void(0,y.QX)(n,t,!1)}}function F(){const e=p.CP.pythonContextManager.lastCodeAndPostViewMessage;if(void 0===e)throw(0,y.pz)("Cannot find the last postview message while updating. Function: getPythonCodeAndPostViewCardProps.",void 0);return{message:e,component:e.chatMessageData.chatCardWrapperProps.renderData.component,props:e.chatMessageData.chatCardWrapperProps.renderData.props}}function _(e,t,n,a){t.chatMessageData.chatCardWrapperProps.renderData=(0,b.Av)(n,a,{isPythonExecutionSuccess:!1},g.S2.PythonError);const o={featureName:m.q.Python,eventType:m.a5.PythonCodeAndPostViewCardUpdatedWithError};l.$.getInstance().updateMessage(t),N(e,t,o,c.Aw.success,!1)}function P({shouldShowAIGeneratedIndicator:e,shouldHideFeedbackSection:t,pythonError:n,actionButtonList:a=[],shouldShowReadAloudButton:o=!1,messageId:l=(0,L.A)(),metadata:s}){const c=function(){let e="Copilot\\Python";const t=(0,v.yw9)("OfficeVSO_9902870_UseFormsAreaPath"),n=i.p.getInstance().getQueryOriginValue()===u.Rk.MsFormsSDX;return(0,R.i)()?e="Copilot\\Answers":t&&n&&(e="Copilot\\PythonForms"),e}(),d={shouldShowAIGeneratedIndicator:e,feedbackData:t?void 0:(0,x.M5)(c),feedbackSectionPosition:t?void 0:r.O.Footer,messageId:l,shouldShowReadAloudButton:o,actionButtonList:n&&(0,v.jHv)()||(0,v.yw9)("OfficeVSO_10238808_answers_add_dev_button")&&(0,v.jHv)()&&(0,R.i)()?[...a,(0,E.yo)(l)]:a};return(0,v.UaO)()&&s&&(d.aiResponseMetadata=s),d}function N(e,t,n,a,o,r=!1){let i="";if(i=JSON.stringify({text:(0,S.N)(t),publishPreference:"Never",stopLoadingUi:o}),o){const t=a===c.Aw.success;e((0,w.L4)(t,r))}e((0,w.nv)(i,a,n,!0,o))}const M={displayPythonAdaRecommendationResponse:function({dispatch:e,requestId:t,code:n,codeExplanation:r,codeLabel:i}){const s=(0,T.if)(n,r),d={chatCardType:a._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:o.Q9.Chat,renderData:(0,b.IM)("PythonAdaRecommendation_V1",{requestId:t,code:n,codeExplanation:r,codeLabel:i}),textContent:s}},stopLoadingUi:!1,chatMessageBodyData:P({shouldShowAIGeneratedIndicator:!0})},u={featureName:m.q.Python,eventType:m.a5.SuggestionMessage};l.$.getInstance().displayResponse(d,u),N(e,d,u,c.Aw.success,!1)},displayPythonModelessResponse:function(e,t,n,r,i=!1,s=!1,u=!1,g){const h={chatCardType:a._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:o.Q9.Chat,renderData:{component:"ModelessOutput",props:{output:t,outputType:n}},textContent:n}},stopLoadingUi:s,chatMessageBodyData:P({shouldShowAIGeneratedIndicator:r,shouldHideFeedbackSection:i,actionButtonList:g,shouldShowReadAloudButton:u})},p={featureName:(0,I.SG)(),eventType:m.a5.SuggestionMessage};if(l.$.getInstance().displayResponse(h,p),n===d.z.Image){let n;try{const e=JSON.parse(t);n=(0,T.YS)(e.base64_data),n&&l.$.getInstance().resendChatHistorySignal("",(e=>({...e,richTextJson:e.richTextJson,images:n?[n]:[]})))}catch(t){const n=(0,y.Wx)((0,y.MQ)(t,"RenderModelessOutput"),t);(0,y.QX)(e,n,!1)}}N(e,h,p,c.Aw.success,!1)},displayPythonStartAnalysisResponse:function(e,t,n,r,i){const s=(0,T.F)(),d={chatCardType:a._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:o.Q9.Chat,renderData:(0,b.IM)("PythonStartAnalysis_V1",{requestId:t,shouldShowRecalcNotice:n,pythonAnalysisSheetName:r}),textContent:s}},stopLoadingUi:!0,chatMessageBodyData:P({shouldShowAIGeneratedIndicator:!1})},u={featureName:m.q.Python,eventType:m.a5.SuggestionMessage};e(h.m.setSuggestionListDetails({suggestionList:[],nextSuggestionTypePriorities:[],shouldResetRecentPrompts:!0,isPythonSuggestion:!0})),l.$.getInstance().displayResponse(d,u),N(e,d,u,c.Aw.success,!0,!i)},displayPythonStartAnalysisButtonExperimentResponse:function(e,t,n,r,i){const s=(0,T.F)(),d=[(0,E.HZ)()],u={chatCardType:a._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:o.Q9.Chat,renderData:(0,b.IM)("PythonStartAnalysisButtonExperiment_V1",{requestId:t,shouldShowRecalcNotice:n,pythonAnalysisSheetName:r}),textContent:s}},stopLoadingUi:!0,chatMessageBodyData:P({shouldShowAIGeneratedIndicator:!1,shouldHideFeedbackSection:!1,actionButtonList:d})},g={featureName:m.q.Python,eventType:m.a5.SuggestionMessage};e(h.m.setSuggestionListDetails({suggestionList:[],nextSuggestionTypePriorities:[],shouldResetRecentPrompts:!0,isPythonSuggestion:!0})),l.$.getInstance().displayResponse(u,g),N(e,u,g,c.Aw.success,!0,!i)},displayPythonTextResponse:function(e,t,n,r=!1,i=!1,s,d){if("string"!=typeof t){const e="Python text response is not a string. Message type: "+typeof t;throw(0,y.i_)(e)}const u={chatCardType:a._.MarkdownCard,chatMessageData:{markDownCardProps:{user:o.Q9.Chat,message:t,horizontalTableScroll:!0,disableLinksProcessing:!1,shouldApplyInputLinkTheme:!0}},stopLoadingUi:i,chatMessageBodyData:P({shouldShowAIGeneratedIndicator:n,shouldHideFeedbackSection:r,actionButtonList:s,metadata:d})},g={featureName:m.q.Python,eventType:m.a5.SuggestionMessage};l.$.getInstance().displayResponse(u,g),N(e,u,g,c.Aw.success,i)},displayPythonErrorResponse:function(e,t,n){(0,A.FN)(t);const r={chatCardType:a._.MarkdownCard,chatMessageData:{markDownCardProps:{user:o.Q9.Chat,message:t.errorDisplayMessage,disableLinksProcessing:!0,shouldApplyInputLinkTheme:!0}},stopLoadingUi:!0,chatMessageBodyData:P({shouldShowAIGeneratedIndicator:!1,shouldHideFeedbackSection:!1,pythonError:t,actionButtonList:n})},i={featureName:(0,I.SG)(),eventType:m.a5.ErrorMessage,errorType:m.q0.PythonError,devInfo:t.toString()};p.CP.pythonContextManager.ocvErrorDetails={lastMessageTelemetry:i,...t.errorDetailsOCVOnly},l.$.getInstance().displayResponse(r,i),N(e,r,i,c.Aw.failed,!0)},displayPythonCodeCardWithPendingPostView:function(e,t,n,r,i,d,u,g,h){const p=(0,f.L)(d?(0,s.oMg)():(0,s.vX0)(),[i])+"\n"+(0,T.if)(n,u),C=e((0,w.HO)()),y=P({shouldShowAIGeneratedIndicator:!0,shouldHideFeedbackSection:!1,metadata:h}),v={chatCardType:a._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:o.Q9.Chat,renderData:(0,b.IM)("CodeAndPostView",{requestId:t,code:n,cellAddress:i,sheetId:r,pythonCell:void 0,codeLabel:g,codeExplanation:u,pythonUserRequestId:C,isInitialDataFrame:d}),textContent:p}},stopLoadingUi:!1,chatMessageBodyData:y},x={featureName:m.q.Python,eventType:m.a5.PythonCodeAndPostViewCardShown};return l.$.getInstance().displayResponse(v,x),N(e,v,x,c.Aw.success,!1),v},updatePythonCodeAndPostViewCardWithPostView:async function(e,t,n,a,o,r,i){const{message:s,component:d,props:u}=F(),{pythonCell:h,cellTypeAndValue:f}=await async function(e,t,n,a,o){let r;try{r=await a}catch(a){const r=(0,y.pz)((0,y.MQ)(a,"getCellTypeAndValueWithRetry"),a);(0,y.QX)(o,r,!1);const i=e.getRange(n).load(["valuesAsJson"]);return await t.sync(),{pythonCell:i.valuesAsJson[0][0],cellTypeAndValue:void 0}}return await(0,A.AJ)((async()=>{const a=e.getRange(n).load(["valuesAsJson"]);await t.sync();const i=a.valuesAsJson[0][0];return{pythonCell:i,cellTypeAndValue:k(i,r,o)}}),(e=>void 0!==e),await p.CP.pythonContextManager.getMaxRetryAttempts("GetCellTypeAndValueIfNotBusy"),p.CP.pythonContextManager.RETRY_WAIT_IN_MILLISECONDS,!1,o)}(a,o,t,n,e);if((0,v.EJJ)()){const e={type:"code",value:{code:i?.code??"",codeLabel:i?.codeLabel,codeExplanation:i?.codeExplanation,output:JSON.stringify(i?.output),outputType:i?.outputType}},t=(0,C.C)([e],!0);s.chatMessageBodyData&&(s.chatMessageBodyData.aiResponseMetadata=t)}if(void 0!==f&&void 0!==h){let t=s.chatMessageData.chatCardWrapperProps.textContent??"";let n;t+=JSON.stringify(h);const a=h.preview?.properties?.image?.image?.cachedUid;if(a){const e=(o?.workbook).localImage.getBase64EncodedImageData(a);await o.sync(),e?.value&&(n=(0,T.YS)(e.value))}s.chatMessageData.chatCardWrapperProps.textContent=t,s.chatMessageData.chatCardWrapperProps.renderData=(0,b.Av)(d,u,{pythonCell:h,diagnosticsEntry:r,chartImageUrl:n},g.S2.PythonError);const i={featureName:m.q.Python,eventType:m.a5.PythonCodeAndPostViewCardUpdatedWithResult};n&&l.$.getInstance().resendChatHistorySignal("",(e=>({...e,richTextJson:e.richTextJson,images:n?[n]:[]}))),l.$.getInstance().updateMessage(s),N(e,s,i,c.Aw.success,!1)}else _(e,s,d,u)},updatePythonCodeAndPostViewCardWithError:function(e){const{message:t,component:n,props:a}=F();_(e,t,n,a)},displayPythonMergedCardResponse:function(e,t,n,r,i,s){const d=(0,C.C)(t),u=(0,v.cGu)()?e((0,w.HO)()):void 0,g={chatCardType:a._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:o.Q9.Chat,renderData:(0,b.IM)("PythonMergedCard_V1",{requestId:i,pythonUserRequestId:u,messageId:s,chunks:t}),textContent:(0,T.VF)(t)}},stopLoadingUi:r,chatMessageBodyData:{shouldShowCopyButton:!0,...P({shouldShowAIGeneratedIndicator:!1,shouldHideFeedbackSection:!1,shouldShowReadAloudButton:!0,messageId:s,metadata:d})},addCardToChatHistory:r},h={featureName:(0,I.SG)(),eventType:m.a5.PythonMergedCardShown};l.$.getInstance().displayResponse(g,h,{replaceExistingMessage:n}),N(e,g,h,c.Aw.success,!0,!r)}}},215751:(e,t,n)=>{"use strict";n.d(t,{Q:()=>s});var a=n(485596),o=n(906248),r=n(208520),i=function(e){},l=(0,a.mL)(o.N,{currentLocale:void 0,strings:{},errorHandler:i,loaders:[],stringMapInitialized:!1});function s(e,t){void 0===t&&(t=i);var n=(0,r.useState)(l),o=n[0],s=n[1];return(0,r.useEffect)((function(){(0,a.Au)((0,a.U5)(e,"en-us"),o).then(s)}),[e]),(0,r.useEffect)((function(){s((0,a._c)(t,o))}),[t]),(0,a.zB)(o)}},215939:(e,t,n)=>{"use strict";var a,o,r,i,l,s,c,d,u,m,g;n.d(t,{_fShowPreloadedCopilot:()=>le,copilotPaneStartTimestampAfterPreload:()=>ie,excelTaskPaneStartTime:()=>ce,getHasPreloadedCopilotBeenShown:()=>Z,getPreloadCopilot:()=>G,isSDXRenderingForPreload:()=>se,useHasPreloadedCopilotBeenShown:()=>X,usePreloadCopilot:()=>W,useUnifiedPromptPrivateApiMessage:()=>K}),function(e){e.Activated="Activated",e.Removed="Removed",e.ActivateCopilotAgent="activateCopilotAgent",e.RemoveCopilotAgent="removeCopilotAgent"}(a||(a={})),function(e){e[e.LaunchMos=2001]="LaunchMos",e[e.GetFullDocumentHtml=2003]="GetFullDocumentHtml",e[e.InvokeCanvasTool=2004]="InvokeCanvasTool",e[e.ReadAloud=2005]="ReadAloud"}(o||(o={})),function(e){e.BizchatHostContextUpdate="BizChatHostContextUpdate"}(r||(r={})),function(e){e.ChatType="ChatType",e.TaskPaneStart="TaskPane_Start",e.AppLoadStart="AppLoad_Start",e.OfficeJSReady="OfficeJS_Ready",e.PreloadCopilot="PreloadCopilot",e.LazyLoadCopilot="LazyLoadCopilot",e.FirstCopilotExperience="FirstCopilotExperience",e.ChatFirstRenderTime="ChatFirstRenderTime",e.IsPerfImprovementBizChatEnabled="IsPerfImprovementBizChatEnabled"}(i||(i={})),function(e){e.CHAT="chat",e.ERROR="error",e.LATENCY="latency"}(l||(l={})),function(e){e.ShowPreloadedCopilot="ShowPreloadedCopilot",e.PreloadCopilot="PreloadCopilot",e.TaskPaneVisibilityModeChanged="TaskPaneVisibilityModeChanged",e.TaskPaneVisibilityContextSwitch="TaskPaneVisibilityContextSwitch",e.PrivateAPIChatContextSwitch="PrivateAPIChatContextSwitch",e.CopilotEntryPointSelectorInfo="CopilotEntryPointSelectorInfo",e.BizChatDownloadFinishTime="BizChat_DownloadFinishTime",e.AppChatDownloadFinishTime="AppChat_DownloadFinishTime",e.ShowingPaneWhilePreloading="ShowingPaneWhilePreloading",e.MOSStoreDialogResponse="MOS_Store_Dialog_Response",e.OfficeAuthContextAccountType="OfficeAuthContextAccountType",e.BizChatInitialAppRunningState="BizChatInitialAppRunningState",e.BizChatAppRunningStateChange="BizChatAppRunningStateChange"}(s||(s={})),function(e){e.FeatureName="FeatureName",e.PPTUserCopilotPaneLoadTime="PPTUserCopilotPaneLoadTime",e.WordUserCopilotPaneLoadTime="WordUserCopilotPaneLoadTime",e.UserCopilotPaneLoadTime="UserCopilotPaneLoadTime",e.SDXResourcesLoadTime="SDXResourcesLoadTime"}(c||(c={})),function(e){e.ChatEventType="ChatEventType",e.ChatEventParameters="ChatEventParameters",e.CopilotSource="CopilotSource",e.ToolFunctionName="ToolFunctionName",e.RequestId="RequestId",e.ConversationId="ConversationId",e.DurationMs="DurationMs",e.ErrorMessage="ErrorMessage",e.IsSuccess="IsSuccess",e.EditSessionId="EditSessionId",e.HostEventType="HostEventType",e.IsSoftKeep="IsSoftKeep",e.IsLifecycleEvent="IsLifecycleEvent"}(d||(d={})),function(e){e.FeatureActionType="FeatureActionType",e.FeatureName="FeatureName",e.SubFeatureName="SubFeatureName",e.EntryPoint="EntryPoint",e.InteractionId="InteractionId",e.ConversationId="ConversationId",e.IsUserInitiated="IsUserInitiated"}(u||(u={})),function(e){e.BizChatPaneLoad="BizChatPaneLoad",e.AppChatPaneLoad="AppChatPaneLoad"}(m||(m={})),function(e){e.M365CopilotChat="M365CopilotChat",e.AppChat="AppChat",e.Researcher="Researcher",e.Analyst="Analyst",e.DataShaping="DataShaping",e.Disabled="Disabled"}(g||(g={}));var h=function(e){return(new Date).getTime()-e};var p,b,f=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{s(a.next(e))}catch(e){r(e)}}function l(e){try{s(a.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((a=a.apply(e,t||[])).next())}))},C=function(e,t){var n,a,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(n=1,a&&(o=2&l[0]?a.return:l[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,l[1])).done)return o;switch(a=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,a=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],a=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}};!function(e){e.EnableBizchatHostContext="EnableBizchatHostContext",e.UseHandoffMessagePropertiesValue="UseHandoffMessagePropertiesValue",e.ShouldDefaultToBizChat="ShouldDefaultToBizChat",e.EnableInsecureHostAppSettings="EnableInsecureHostAppSettings",e.EnableM365UserClickTimePerformanceMark="EnableM365UserClickTimePerformanceMark",e.EnableAgentSwitchInCatalystViaEntryPoint="EnableAgentSwitchInCatalystViaEntryPoint",e.IsHandoffsToAppChatDisabled="IsHandoffsToAppChatDisabled",e.UseHandoffSettingNameInCaps="UseHandoffSettingNameInCaps",e.EnablePassingAppRunningStateToBizChat="EnablePassingAppRunningStateToBizChat",e.EnableOfficeAuthContextAccountTypeLog="EnableOfficeAuthContextAccountTypeLog",e.RemoveSDXConsumerFGCheck="RemoveSDXConsumerFGCheck",e.RemoveUppercaseHandoffMessage="RemoveUppercaseHandoffMessage"}(p||(p={})),function(e){e.FallbackHandoffsToAppChat="FallbackHandoffsToAppChat",e.ShouldCheckUserLicense="ShouldCheckUserLicense",e.EnableM365CopilotChatStarter="EnableM365CopilotChatStarter",e.EnableM365CopilotChat="EnableM365CopilotChat"}(b||(b={}));var y=n(758651),v=function(e,t,n){if(n||2===arguments.length)for(var a,o=0,r=t.length;o<r;o++)!a&&o in t||(a||(a=Array.prototype.slice.call(t,0,o)),a[o]=t[o]);return e.concat(a||Array.prototype.slice.call(t))},T=function(){function e(){this.queuedEvents=[]}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.logEvent=function(e,t){var n={type:e,data:t};this.telemetryHandler?this.sendTelemetryEvent(n):(this.queuedEvents.push(n),y.log("Telemetry event queued:",n))},e.prototype.setHandler=function(e){var t=this;this.telemetryHandler=e;var n=v([],this.queuedEvents,!0);this.queuedEvents=[],n.forEach((function(e){return t.sendTelemetryEvent(e)}))},e.prototype.getHandler=function(){return this.telemetryHandler},e.prototype.getQueuedEventCount=function(){return this.queuedEvents.length},e.prototype.clearQueue=function(){this.queuedEvents=[]},e.prototype.reset=function(){this.telemetryHandler=void 0,this.queuedEvents=[]},e.prototype.sendTelemetryEvent=function(e){if(this.telemetryHandler)try{switch(e.type){case l.CHAT:this.telemetryHandler.sendTelemetryChatEventData(e.data);break;case l.ERROR:this.telemetryHandler.sendTelemetryErrorData(e.data);break;case l.LATENCY:this.telemetryHandler.sendTelemetryLatencyData(e.data)}}catch(e){}},e}(),x=function(){function e(){this.logEntries=[]}return e.prototype.addInitializationLogs=function(e){var t,n;return e.taskPaneStartTime&&this.logEntries.push({key:i.TaskPaneStart,value:e.taskPaneStartTime.toString()}),e.appLoadStartTime&&this.logEntries.push({key:i.AppLoadStart,value:e.appLoadStartTime.toString()}),e.officeOnReadyTime&&this.logEntries.push({key:i.OfficeJSReady,value:e.officeOnReadyTime.toString()}),e.firstCopilotExperience&&this.logEntries.push({key:i.FirstCopilotExperience,value:e.firstCopilotExperience}),e.chatFirstRenderTime&&this.logEntries.push({key:i.ChatFirstRenderTime,value:e.chatFirstRenderTime}),e.isPerfImprovementBizChatEnabled&&this.logEntries.push({key:i.IsPerfImprovementBizChatEnabled,value:e.isPerfImprovementBizChatEnabled}),e.preloadTime?this.logEntries.push({key:i.PreloadCopilot,value:e.preloadTime,copilotSource:e.isBizChat?"BizChat":"AppChat"}):this.logEntries.push({key:i.LazyLoadCopilot,value:null!==(n=null===(t=e.taskPaneStartTime)||void 0===t?void 0:t.toString())&&void 0!==n?n:"",copilotSource:e.isBizChat?"BizChat":"AppChat"}),this},e.prototype.enqueue=function(){var e=T.getInstance();this.logEntries.forEach((function(t){var n,a;e.logEvent(l.CHAT,[{key:d.ChatEventType,value:t.key},{key:d.ChatEventParameters,value:null!==(n=t.value)&&void 0!==n?n:""},{key:d.CopilotSource,value:null!==(a=t.copilotSource)&&void 0!==a?a:""}])}))},e}(),S=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{s(a.next(e))}catch(e){r(e)}}function l(e){try{s(a.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((a=a.apply(e,t||[])).next())}))},w=function(e,t){var n,a,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(n=1,a&&(o=2&l[0]?a.return:l[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,l[1])).done)return o;switch(a=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,a=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],a=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}};var E,I=function(){return I=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},I.apply(this,arguments)},R=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{s(a.next(e))}catch(e){r(e)}}function l(e){try{s(a.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((a=a.apply(e,t||[])).next())}))},A=function(e,t){var n,a,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(n=1,a&&(o=2&l[0]?a.return:l[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,l[1])).done)return o;switch(a=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,a=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],a=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},L=function(){function e(){var t=this;this.initialState=null,this.state={isAppInForeground:!1,userOpenedCopilotUtcTime:void 0},this.listeners=new Set,this.getSnapshot=function(){return t.state},this.sendLog=function(t,n){e.telemetryEventManager.logEvent(l.CHAT,[{key:d.ChatEventType,value:t},{key:d.ChatEventParameters,value:JSON.stringify({appRunningState:n})}])}}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.setIntialValue=function(e,t){var n=this;this.initialState=function(e){return S(this,void 0,void 0,(function(){var t,n,a,o;return w(this,(function(r){switch(r.label){case 0:if(!(null==e?void 0:e.addin))return[2,!0];if(t="Taskpane"===(null===(n=null==e?void 0:e.addin)||void 0===n?void 0:n.visibilityMode),"function"!=typeof(null===(o=null===(a=null===window||void 0===window?void 0:window.Office)||void 0===a?void 0:a.addin)||void 0===o?void 0:o._getState)||"OfficeOnline"===(null==e?void 0:e.platform))return[2,t];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,window.Office.addin._getState()];case 2:return[2,"Visible"===r.sent()];case 3:return r.sent(),[2,t];case 4:return[2]}}))}))}(e).then((function(e){n.doSetState({isAppInForeground:e,userOpenedCopilotUtcTime:t},!1),n.sendLog(s.BizChatInitialAppRunningState,n.state)}))},e.prototype.setState=function(e){return R(this,void 0,void 0,(function(){var t,n=this;return A(this,(function(a){return null===(t=this.initialState)||void 0===t||t.then((function(){n.doSetState(e)})),[2]}))}))},e.prototype.getState=function(){return this.state},e.prototype.subscribe=function(e){var t=this;return this.listeners.add(e),function(){t.listeners.delete(e)}},e.prototype.doSetState=function(e,t){void 0===t&&(t=!0),this.state.isAppInForeground!==e.isAppInForeground&&(this.state=I(I({},this.state),e),t&&this.sendLog(s.BizChatAppRunningStateChange,this.state)),this.listeners.forEach((function(e){return e()}))},e.telemetryEventManager=T.getInstance(),e}(),k=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{s(a.next(e))}catch(e){r(e)}}function l(e){try{s(a.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((a=a.apply(e,t||[])).next())}))},F=function(e,t){var n,a,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(n=1,a&&(o=2&l[0]?a.return:l[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,l[1])).done)return o;switch(a=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,a=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],a=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},_=function(){function e(){this.apiHandlers=new Map}return e.getInstance=function(){return e.PrivateApi||(e.PrivateApi=new e),e.PrivateApi},e.prototype.initializePrivateApi=function(){return k(this,arguments,void 0,(function(e){var t=this;return void 0===e&&(e=0),F(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,OfficeFirstParty.PrivateApi.onPrivateEvent((function(n){return k(t,void 0,void 0,(function(){var t,a;return F(this,(function(o){switch(o.label){case 0:return e>0?[4,new Promise((function(t){return setTimeout(t,e)}))]:[3,2];case 1:o.sent(),o.label=2;case 2:0;try{t=JSON.parse(n)}catch(e){t=null}return(null==t?void 0:t.eventName)&&(a=this.apiHandlers.get(t.eventName))&&a instanceof Function&&(a(t),!0),[2]}}))}))}))];case 1:return n.sent(),[3,3];case 2:return n.sent(),[3,3];case 3:return[2]}}))}))},e.prototype.openMOSDialog=function(){return k(this,void 0,void 0,(function(){var e;return F(this,(function(t){switch(t.label){case 0:return e={dispidMethod:o.LaunchMos},[4,this.execute(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.getFullDocumentHtml=function(){return k(this,void 0,void 0,(function(){var e;return F(this,(function(t){return e={dispidMethod:o.GetFullDocumentHtml},[2,this.execute(e)]}))}))},e.prototype.execute=function(e){return k(this,void 0,void 0,(function(){return F(this,(function(t){return[2,OfficeFirstParty.PrivateApi.execute(JSON.stringify(e))]}))}))},e.prototype.triggerReadAloud=function(){return k(this,void 0,void 0,(function(){var e;return F(this,(function(t){return e={dispidMethod:o.ReadAloud},[2,this.execute(e)]}))}))},e.prototype.attachPrivateEventHandler=function(e,t){this.apiHandlers.has(e),this.apiHandlers.set(e,t)},e}();!function(e){e.TellMe="TellMe",e.WordCopilotComposeSelection="WordCopilotComposeSelection",e.ContextMenuRewriteClickAction="ContextMenuRewriteClickAction",e.WordCopilotRewriteSelection="WordCopilotRewriteSelection",e.SkittleContextMenuUserClickAction="SkittleContextMenuUserClickAction",e.WordCopilotComprehensionPodcast="WordCopilotComprehensionPodcast",e.ResearcherAgent="ResearcherAgent",e.CopilotContextMenuClickAction="CopilotContextMenuClickAction",e.WordCopilotVisualAssistantDescribeImage="WordCopilotVisualAssistantDescribeImage",e.PPTFileNameRenamed="PPTFileNameRenamed",e.CopilotTranslatedPPTInfo="CopilotTranslatedPPTInfo"}(E||(E={}));E.WordCopilotComprehensionPodcast,E.WordCopilotVisualAssistantDescribeImage,E.PPTFileNameRenamed,E.CopilotTranslatedPPTInfo,new Map([[E.TellMe,g.M365CopilotChat],[E.WordCopilotComposeSelection,g.M365CopilotChat],[E.ContextMenuRewriteClickAction,g.M365CopilotChat],[E.WordCopilotRewriteSelection,g.M365CopilotChat],[E.SkittleContextMenuUserClickAction,g.M365CopilotChat],[E.ResearcherAgent,g.M365CopilotChat],[E.CopilotContextMenuClickAction,g.M365CopilotChat],[E.WordCopilotComprehensionPodcast,g.AppChat]]);var P=n(197665),N=n(795167),M=n(632769);function O(e,t=!1){const n=OfficeRuntime.experimentation.getBooleanFeatureGate("Microsoft.Office.Excel.FA000000124."+e);return void 0!==n?n:t}function D(e){return O(e,!0)}var B=n(507628),$=n(208520),H=n(794329),U=n(758651);let q,V;function W(){const[e,t]=(0,$.useState)(q);return V=t,[e,t]}function G(){return q}function z(e){q=e,V&&V(e)}let Q,j,J,Y=!1;function X(){const[e,t]=(0,$.useState)(Y);return Q=t,[e,t]}function Z(){return Y}function K(){const[e,t]=(0,$.useState)(j),n=$.useCallback((e=>{t((t=>{const n="function"==typeof e?e(t):e;return j=n,n}))}),[]);return J=n,[e,n]}function ee(e=!0){sessionStorage?.setItem("preloadCopilot",JSON.stringify({isPreloaded:!0,isHidden:e}))}function te(){const e=sessionStorage?.getItem("preloadCopilot");return!!e&&JSON.parse(e).isPreloaded}function ne(e){const t=sessionStorage?.getItem("preloadCopilot");t&&ee(e)}let ae=!1,oe=!1;const re=(new Date).getTime().toString();let ie,le=!1,se=!1;const ce=window.excelTaskPaneStartTime;let de;var ue;!function(e){e.Verbose="verbose",e.Info="info",e.Warning="warning",e.Error="error"}(ue||(ue={}));const me="shimmer";function ge(){window.document.getElementById(me)?.style.setProperty("display","none")}const he=$.memo((e=>($.useEffect((()=>(window.document.getElementById(me)?.style.setProperty("display","block"),()=>{e.hideOnUnmount&&ge()})),[e.hideOnUnmount]),null)));function pe(e,t){if(Office?.context){const n="string"==typeof t?t:JSON.stringify(t);Office.context.hostSettings.set(e,n)}}function be(e){return"string"==typeof e&&e.length>=2&&e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1)),e}function fe(){let e;return e=Office.context.hostSettings.get("BizChatHostContext"),ye(e)}function Ce(e){if(e)return new N.uC({query:e.sendPromptText,sourceApp:M.Ww.EXCEL,destinationApp:M.Ww.EXCEL,scenarioName:M.Cu.INAPP,context:JSON.stringify({featureName:E.CopilotContextMenuClickAction}),queryId:(0,B.A)(),language:(0,P.Yd)()||"en-US"})}function ye(e){if("string"!=typeof e)return e;try{return JSON.parse(e)}catch(e){return void Te("error","Failed to parse BizChatHostContext:",e)}}const ve=()=>function(){const e=Office.context.hostSettings.get("AudienceGroup");return["Automation","Dogfood","MSIT","Microsoft"].includes(e)}();function Te(e,...t){if(!ve())return;let n="info";e&&Object.values(ue).includes(e)?n=e:e&&t.unshift(e);const a="Excel Copilot Chat";switch(n){case"verbose":U.debug(`${a}`,...t);break;case"warning":U.warn(`${a}`,...t);break;case"error":U.error(`${a}`,...t);break;default:U.log(`${a}:`,...t)}}const xe=e=>{const t=(new Date).getTime(),a=$.useMemo((()=>$.lazy((()=>Promise.all([n.e("chunk1jsfluent"),n.e("chatcore"),n.e("augloop-chunk"),n.e("office-iss"),n.e("vendors-npm_store_sdx_officecopilot_parse5_6_0_1-6346061a9d49819048e1_node_modules_parse5_lib-b0e687"),n.e("vendors-npm_store_sdx_officecopilot_griffel-core_1_19_2-a53c0f7bf03872bf6af3_node_modules_gri-ab40e9"),n.e("vendors-npm_store_sdx_officecopilot_buffer_6_0_3-1a644f28c27d2b46696c_node_modules_buffer_index_js"),n.e("vendors-npm_store_sdx_officecopilot_1js-clipboard-utils_12_2_19-7b1edb59856b7f7e8ab5_node_mod-a7c812"),n.e("vendors-npm_store_sdx_officecopilot_1js-localization-components_6_0_0-0c0b7e15b5ac32c3a95c_no-6b9913"),n.e("vendors-npm_store_sdx_officecopilot_1js-scc-service-cloud-files_4_1_67-1045017c5d52d60593cb_n-fe1d3a"),n.e("vendors-npm_store_sdx_officecopilot_1js-officeaicopilot-chat_51_8_1-596d1bcb82941be50f70_node-4055ed"),n.e("vendors-npm_store_sdx_officecopilot_1js-officeaicopilot-utils_5_5_3-8d180d3d597b338833b1_node-15faf2"),n.e("vendors~appchat-lazy~excelagentexperimental-lazy"),n.e("vendors-npm_store_sdx_officecopilot_hoist-non-react-statics_3_3_2-2c5f76ff0fb3eca13720_node_m-889939"),n.e("vendors-npm_store_sdx_officecopilot_1js-localization-components_6_0_0-0c0b7e15b5ac32c3a95c_no-f552c9"),n.e("default~appchat-lazy"),n.e("appchat-lazy")]).then(n.bind(n,261237)).then((e=>(T.getInstance().logEvent(l.CHAT,[{key:d.ChatEventType,value:s.AppChatDownloadFinishTime},{key:d.ChatEventParameters,value:h(t).toString()}]),{default:e.EntryPoint})))))),[]);return $.createElement($.Suspense,{fallback:$.createElement(he,{hideOnUnmount:!1})},$.createElement(a,e))},Se=e=>{const{shouldReset:t}=e,[a,o]=$.useState(!1);$.useEffect((()=>{r()}),[t]);const r=$.useCallback((()=>{o((e=>!e))}),[]),i=(new Date).getTime(),s=$.useMemo((()=>$.lazy((()=>Promise.all([n.e("chunk1jsfluent"),n.e("augloop-chunk"),n.e("vendors-npm_store_sdx_officecopilot_parse5_6_0_1-6346061a9d49819048e1_node_modules_parse5_lib-b0e687"),n.e("vendors-npm_store_sdx_officecopilot_griffel-core_1_19_2-a53c0f7bf03872bf6af3_node_modules_gri-ab40e9"),n.e("vendors-npm_store_sdx_officecopilot_buffer_6_0_3-1a644f28c27d2b46696c_node_modules_buffer_index_js"),n.e("vendors-npm_store_sdx_officecopilot_1js-clipboard-utils_12_2_19-7b1edb59856b7f7e8ab5_node_mod-a7c812"),n.e("vendors-npm_store_sdx_officecopilot_character-entities-legacy_3_0_0-9d0f86663a05531bbde7_node-1bb3e3"),n.e("vendors~appchat-lazy~excelagentexperimental-lazy"),n.e("vendors-npm_store_sdx_officecopilot_1js-scc-react-markdown-renderer_9_19_2-e5e2c50bbd5a973c19-845c0b"),n.e("vendors-npm_store_sdx_officecopilot_1js-scc-react-source-control-manager_1_7_34-309469cccadb3-0700b9"),n.e("excelagentexperimental-lazy")]).then(n.bind(n,81995)).then((e=>(ge(),T.getInstance().logEvent(l.CHAT,[{key:d.ChatEventType,value:"ExcelAgentExperimentalDownloadFinishTime"},{key:d.ChatEventParameters,value:h(i).toString()}]),{default:e.AgentFrame})))))),[]);return $.createElement($.Suspense,{fallback:$.createElement(he,{hideOnUnmount:!1})},$.createElement(s,e))},we=e=>{const t=(new Date).getTime(),a=$.useMemo((()=>$.lazy((()=>Promise.all([n.e("chunk1jsfluent"),n.e("vendors-npm_store_sdx_officecopilot_buffer_6_0_3-1a644f28c27d2b46696c_node_modules_buffer_index_js"),n.e("vendors~bizchat")]).then(n.t.bind(n,636767,23)).then((e=>(T.getInstance().logEvent(l.CHAT,[{key:d.ChatEventType,value:"BizChatDownloadFinishTime"},{key:d.ChatEventParameters,value:h(t).toString()}]),{default:e.ExcelBizChatNativeRenderer})))))),[]);return $.createElement($.Suspense,{fallback:$.createElement(he,{hideOnUnmount:!0})},$.createElement(a,e))},Ee=$.memo((e=>{const[t,n]=$.useState(fe()),a=$.useRef(t),[o,r]=$.useState(function(){let e;return e=Office.context.hostSettings.get("CopilotInitialPrompt"),Ce(e?.promptProperties)}()),i=$.useMemo((()=>T.getInstance()),[]),c=D("OfficeVSO_10534523_enablePassingAppRunningStateToBizChat"),u=c?L.getInstance():void 0,m=$.useCallback((e=>({appRunningStateStore:u,initTelemetryHandler:n=>{var a,o;ae||(a={isBizChat:e,taskPaneStartTime:ce,officeOnReadyTime:de,appLoadStartTime:re,preloadTime:q?.toString()??"",firstCopilotExperience:t?.PrimaryUserAccountInfo?.CopilotExperience,chatFirstRenderTime:(new Date).getTime().toString(),isPerfImprovementBizChatEnabled:O("IsPerfImprovementBizChatEnabled")?"true":"false"},(o=new x).addInitializationLogs(a),o.enqueue(),ae=!0),i.setHandler(n)},...e&&{handoffMessage:o},...e&&D("OfficeVSO_10539287_preventAutoFocusOnInput")&&{isPanePreloadingInBackground:oe}})),[u]),h=e=>{if("Taskpane"!==e.visibilityMode)return void(c&&L.getInstance().setState({isAppInForeground:!1}));c&&L.getInstance().setState({isAppInForeground:!0,userOpenedCopilotUtcTime:(new Date).getTime()});const t=fe();Te("info","BizchatHostContext re-initialized: ",t);const o=t?.PrimaryUserAccountInfo?.CopilotExperience;o!==a.current?.PrimaryUserAccountInfo?.CopilotExperience&&(n(t),a.current=t,i.logEvent(l.CHAT,[{key:d.ChatEventType,value:s.TaskPaneVisibilityContextSwitch},{key:d.ChatEventParameters,value:o??""},{key:d.CopilotSource,value:"BizChat"}]))};$.useEffect((()=>{const e=()=>{if(!a?.current?.PrimaryUserAccountInfo)return!1;const e=a.current.PrimaryUserAccountInfo.AggregatedLicensedFeatures??a.current.PrimaryUserAccountInfo.LicensedFeatures??void 0;return!!e&&(!e.includes("Copilot")&&(e.includes("CopilotStarter")||e.includes("CopilotChat")))},t=_.getInstance(),o=t=>{const o=t.promptProperties;if(o){if(e()&&O("EnableCopilotStarterBizChat"))return a?.current?.PrimaryUserAccountInfo?.CopilotExperience!==g.M365CopilotChat&&n({PrimaryUserAccountInfo:{...a?.current?.PrimaryUserAccountInfo,CopilotExperience:g.M365CopilotChat}}),void r(Ce(o));a?.current?.PrimaryUserAccountInfo?.CopilotExperience!==g.AppChat&&n({PrimaryUserAccountInfo:{...a?.current?.PrimaryUserAccountInfo,CopilotExperience:g.AppChat}}),i=t,J&&J(i)}var i};O("IsPerfImprovementBizChatEnabled")&&t.attachPrivateEventHandler("unifiedExternalTriggeredPrompt",o),t.attachPrivateEventHandler("BizChatHostContextUpdate",(e=>{if(D("OfficeVSO_10489599_OnlyRerenderOnContextChange")){const t=ye(e.eventData),o=t?.PrimaryUserAccountInfo?.CopilotExperience;o!==a.current?.PrimaryUserAccountInfo?.CopilotExperience&&(n(t),a.current=t,t&&(pe("BizChatHostContext",t),i.logEvent(l.CHAT,[{key:d.ChatEventType,value:s.PrivateAPIChatContextSwitch},{key:d.ChatEventParameters,value:t?.PrimaryUserAccountInfo?.CopilotExperience??""},{key:d.CopilotSource,value:"BizChat"}])))}else{const t=ye(e.eventData);n(t),a.current=t,t&&(pe("BizChatHostContext",t),i.logEvent(l.CHAT,[{key:d.ChatEventType,value:s.PrivateAPIChatContextSwitch},{key:d.ChatEventParameters,value:t?.PrimaryUserAccountInfo?.CopilotExperience??""},{key:d.CopilotSource,value:"BizChat"}]))}})),t.initializePrivateApi(),Office.addin.onVisibilityModeChanged?.(h)}),[]);const p=D("RemoveSDXConsumerFGCheck")||"AAD"===e.accountInfo.accountType||function(e,t=!1){const n=OfficeRuntime.experimentation.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FA000000124."+e);if(void 0!==n)return n;const a=OfficeRuntime.experimentation.getBooleanFeatureGate("Microsoft.Office.Shared.fa000000124."+e);return void 0!==a?a:t}("EnableM365CopilotForConsumers"),b=t?.PrimaryUserAccountInfo?.CopilotExperience,f=O("EnableExcelAgentExperimental",!1),C=O("EnableEAEInFrontier",!1),[y,v]=$.useState(!1),S=b===g.AppChat&&C&&f,w=!!b&&(b===g.M365CopilotChat||b===g.Researcher||b===g.Analyst||b===g.DataShaping||S),E=O("IsPerfImprovementBizChatEnabled"),I=p&&w&&E,[R,A]=$.useState(!1),[k,F]=$.useState(!0),P=$.useCallback((()=>{v(!1),A(!0),F(!1),D("OfficeVSO_10702224_ReloadOnSwapToBizchat")&&location.reload()}),[]);return $.createElement($.Fragment,null,$.createElement("div",{style:{display:S&&k||y?"block":"none"}},(S||y||R)&&$.createElement(Se,{shouldReset:k,exitAgentMode:P})),$.createElement("div",{style:{display:S&&k||y?"none":"block"}},I?$.createElement(we,{...m(!0),hostAccountInfo:e.accountInfo,onAgentChanged:e=>{f&&"ExcelAgent"===e&&v(!0)}}):$.createElement(xe,{...m(!1),accountInfo:e.accountInfo})))}));Ee.displayName="CopilotEntryPointSelector";let Ie={accountType:"",objectId:"",tenantId:""};const Re=e=>{let t;var n,a,o;if(le=!0,oe=!1,se=!1,e?.copilotPaneStartTimestamp&&(ie=e.copilotPaneStartTimestamp,t=parseFloat(be(e?.copilotPaneStartTimestamp)),T.getInstance().logEvent(l.LATENCY,[{key:c.FeatureName,value:"Preload_ChatPaneLoad"},{key:c.UserCopilotPaneLoadTime,value:(a=t,((new Date).getTime()-a)/1e3)}]),n=e,Object.keys(n).forEach((e=>{pe(e,be(n[e]))}))),T.getInstance().logEvent(l.CHAT,[{key:d.ChatEventType,value:s.ShowPreloadedCopilot},{key:d.ChatEventParameters,value:(new Date).getTime()}]),Y=o=!0,Q&&Q(o),Office.addin.showAsTaskpane(),D("OfficeVSO_10534523_enablePassingAppRunningStateToBizChat")&&L.getInstance().setState({isAppInForeground:!0,userOpenedCopilotUtcTime:t}),D("OfficeVSO_10441007_EnableM365UserClickTimePerformanceMark")){const e=performance.now()-(Date.now()-t);e>0&&performance.mark("bizchat-metaOS-app.UserClickTime",{startTime:e})}};(async()=>{function e(e){const n=()=>{t(e)};"function"==typeof window.requestIdleCallback?requestIdleCallback(n,{timeout:5e3}):setTimeout(n,0)}function t(e){Te("info","renderUIToScreen"),de=(new Date).getTime();const t=document.getElementById("container");t?H.render($.createElement("div",null,$.createElement(Ee,{accountInfo:e})),t):Te("error","Container element not found")}await new Promise((e=>{const t=()=>{"undefined"!=typeof Office?e():setTimeout(t,50)};t()})),Office.onReady().then((async n=>{if(Office.ExtensionLifeCycle.taskpane?.notifyHeaderLoaded(),D("OfficeVSO_10534523_enablePassingAppRunningStateToBizChat")&&L.getInstance().setIntialValue(n,ce),Ie=await function(e){return f(this,void 0,void 0,(function(){var t,n,a,o,r,i,l,s,c;return C(this,(function(d){switch(d.label){case 0:return[4,new Promise((function(t){return e.context.auth.getAuthContextAsync(t)}))];case 1:return t=d.sent(),n="",a="",o="","succeeded"===t.status&&(r=t.value)&&(n=null!==(l=null===(i=r.authorityType)||void 0===i?void 0:i.toUpperCase())&&void 0!==l?l:"",a=null!==(s=r.userObjectId)&&void 0!==s?s:"",o=null!==(c=r.tenantId)&&void 0!==c?c:""),[2,{accountType:n,objectId:a,tenantId:o}]}}))}))}(Office),D("EnableOfficeAuthContextAccountTypeLog")&&T.getInstance().logEvent(l.CHAT,[{key:d.ChatEventType,value:s.OfficeAuthContextAccountType},{key:d.ChatEventParameters,value:Ie.accountType}]),n.addin)"Hidden"===n.addin.visibilityMode?(Te("info","hostAndPlatform.addin.visibilityMode: Hidden"),se=!0,Te("info","hostAndPlatform.addin.visibilityMode:"+n.addin.visibilityMode),Te("info",`Office.OnReady PreloadCopilot ${te()} ${q}`),q||(z((new Date).getTime()),window.preloadCopilotTime=q?.toString(),ee(),oe=!0,O("renderPreloadUIOnIdleOnly")?e(Ie):t(Ie))):"Taskpane"===n.addin.visibilityMode?t(Ie):Te("error",`Office.OnReady None handled visibility mode ${n.addin.visibilityMode}`),Office.addin.onVisibilityModeChanged((function(e){T.getInstance().logEvent(l.CHAT,[{key:d.ChatEventType,value:s.TaskPaneVisibilityModeChanged},{key:d.ChatEventParameters,value:e.visibilityMode},{key:d.CopilotSource,value:"BizChat"}]),"Taskpane"===e.visibilityMode?(Te("info","Office.addin.onVisibilityModeChanged: Taskpane"),le&&(le=!1),se=!1,ne(!1)):"Hidden"===e.visibilityMode&&(Te("info","Office.addin.onVisibilityModeChanged: Hidden"),ne(!0))}));else if(Te("info","hostAndPlatform.addin is null"),t(Ie),D("OfficeVSO_10441007_EnableM365UserClickTimePerformanceMark")){const e=performance.now()-(Date.now()-ce);e>0&&performance.mark("bizchat-metaOS-app.UserClickTime",{startTime:e})}})).catch((e=>{Te("error","Office.onReady() error: "+e)})),Office.actions.associate("ShowPreloadedCopilot",(function(e){Re(e)})),Office.actions.associate("PreloadCopilot",(function(){Te("info",`Office actions PreloadCopilot ${te()} ${q}`),q||(z((new Date).getTime()),window.preloadCopilotTime=q?.toString(),oe=!0,ee(),O("renderPreloadUIOnIdleOnly")?e(Ie):t(Ie))}))})()},217425:(e,t,n)=>{"use strict";n.d(t,{L6:()=>c,MA:()=>i,Ss:()=>l,dX:()=>s,ky:()=>o,mr:()=>r,w8:()=>a});var a={augloop:"https://augloop.office.com/v2/AugLoop.All",loki:"https://loki.delve.office.com",graph:"https://graph.microsoft.com",sharepoint:"https://microsoft-my.sharepoint-df.com",onenote:"https://onenote.com",substrate:"https://substrate.office.com/search",ic3:"https://ic3.teams.office.com",cognitive:"https://cognitiveservices.azure.com"},o="6d8f24e8-a97e-4bb5-bbee-a1949aba8fb4",r="https://login.microsoftonline.com/common",i="https://login.microsoftonline.us/common",l="https://titles.prod.mos.microsoft.com",s="https://safelinks.protection.office365.com",c="https://dataservice.o365filtering.com"},233356:(e,t,n)=>{"use strict";n.d(t,{e:()=>a});const a="#156082"},241273:(e,t,n)=>{"use strict";var a,o,r,i,l,s,c,d,u,m,g,h,p,b,f;n.d(t,{At:()=>p,Gm:()=>i,OZ:()=>d,T7:()=>f,Th:()=>b,YY:()=>u,ut:()=>a,zg:()=>m}),function(e){e[e.Unknown=0]="Unknown",e[e.Consumer=1]="Consumer",e[e.Enterprise=2]="Enterprise"}(a||(a={})),function(e){e.dark="highcontrast_dark",e.light="highcontrast_light",e.disabled="highcontrast_none"}(o||(o={})),function(e){e.web="web",e.win32="win32",e.mac="mac"}(r||(r={})),function(e){e.defaultWhite="defaultWhite",e.defaultBlack="defaultBlack",e.defaultDarkGrey="defaultDarkGrey",e.themeColorful="themeColorful"}(i||(i={})),function(e){e.IN_PROGRESS="IN_PROGRESS",e.COMPLETED="COMPLETED",e.FAILED="FAILED",e.STARTED="STARTED",e.NONE="NONE"}(l||(l={})),function(e){e.InvalidSignal="PersonalizationInvalidSignalError",e.InvalidInput="PersonalizationInvalidInputError",e.RoamingServiceError="PersonalizationRoamingServiceError",e.OpenAITextClientError="PersonalizationOpenAITextClientError",e.SkillExecutionError="PersonalizationSkillExecutionError",e.OpenAIChatClientError="PersonalizationOpenAIChatClientError"}(s||(s={})),function(e){e.InvalidUserQuery="invalid-user-query",e.MissingProfileId="missing-profile-id",e.StaleProfileId="stale-profile-id",e.NotSupportedProfileOperation="not-supported-profile-operation",e.FailedToRead="failed-to-read",e.FailedToWrite="failed-to-write",e.UninitializedUserStoreEntities="uninitialized-user-store-entities",e.UndefinedUserStoreEntities="undefined-user-store-entities",e.NotAvailable="not-available",e.Timeout="timeout",e.Throttled="throttled",e.Token="token",e.Unknown="unknown",e.BadResponse="bad-response",e.UserThrottled="user-throttled",e.ScenarioThrottled="scenario-throttled",e.EmptyResponse="empty-response"}(c||(c={})),function(e){e.CLP_Get="CLP_Get",e.CLP_Upgrade="CLP_Upgrade"}(d||(d={})),function(e){e.ApplyLabelUnsupportedCrossTenantErrorCode="2147205120",e.ApplyLabelDocumentReadOnlyErrorCode="2147205119",e.ApplyLabelInsufficientPermissionErrorCode="2147205118",e.ApplyLabelLabelDisabledErrorCode="2147205117",e.ApplyLabelUnsupportedUdpErrorCode="2147205116",e.ApplyLabelLabelingDisabledErrorCode="2147205115",e.ApplyLabelUnsupportedContentTypeErrorCode="2147205114",e.ApplyLabelUnsupportedDkeErrorCode="2147205113",e.ApplyLabelLabelNotFoundErrorCode="2147205112",e.OsfControlContainerErrorCode="2147205111",e.OfficeSolutionFrameworkHostErrorCode="2147205110",e.DocCookieErrorCode="2147205109",e.HostIntegrationManagerErrorCode="2147205108",e.MsoOLDocumentErrorCode="2147205107",e.ClpSessionErrorCode="2147205106",e.ApplyLabelNewLabelSensitivityOrderErrorCode="2147205105",e.OMWorkflowUserNotFoundErrorCode="2147220727",e.OMOfficePerpetualNotSupportedErrorCode="2147220726",e.LabelingDisabledProtectedViewErrorCode="2147205104",e.LabelingDisabledAppguardErrorCode="2147205103",e.LabelingDisabledPrivacySettingsErrorCode="2147205102",e.LabelingDisabledUnsupportedLabelClientErrorCode="2147205101",e.LabelingDisabledNoSignedInClpCompatibleUsersErrorCode="2147205100",e.OMOfficeClientNotLicensedForLabelingErrorCode="2147220725",e.PolicyManagerUnavailableErrorCode="2147942488",e.ErrorCode2147647531="2147647531",e.ErrorCode2147500033="2147500033"}(u||(u={})),function(e){e.Ack="Ack",e.CloseEvent="CloseEvent",e.OnItemSelected="OnItemSelected",e.OnErrorInLoading="OnErrorInLoading"}(m||(m={})),function(e){e.Image="IMAGE",e.Video="VIDEO"}(g||(g={})),function(e){e.KeepIt="KeepIt",e.Undo="Undo",e.Insert="Insert",e.Copy="Copy",e.Custom="Custom",e.CustomiPad="CustomiPad",e.None="None"}(h||(h={})),function(e){e.Activated="Activated",e.Removed="Removed",e.ActivateCopilotAgent="activateCopilotAgent",e.RemoveCopilotAgent="removeCopilotAgent"}(p||(p={})),function(e){e.BizchatHostContextUpdate="BizChatHostContextUpdate"}(b||(b={})),function(e){e[e.LaunchMos=2001]="LaunchMos",e[e.GetFullDocumentHtml=2003]="GetFullDocumentHtml",e[e.InvokeCanvasTool=2004]="InvokeCanvasTool",e[e.ReadAloud=2005]="ReadAloud"}(f||(f={}))},241821:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(997434),o=n(154836);t.default=function(e){const t=function(e){return Uint8Array.of((15&e[6])<<4|e[7]>>4&15,(15&e[7])<<4|(240&e[4])>>4,(15&e[4])<<4|(240&e[5])>>4,(15&e[5])<<4|(240&e[0])>>4,(15&e[0])<<4|(240&e[1])>>4,(15&e[1])<<4|(240&e[2])>>4,96|15&e[2],e[3],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}("string"==typeof e?(0,a.default)(e):e);return"string"==typeof e?(0,o.unsafeStringify)(t):t}},243583:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runtimeIframeHtml=void 0,t.runtimeIframeHtml='<!doctype html>\n<html>\n    <head>\n        <meta charset="utf-8" />\n        <script id="workerJs" type="workerJs">\n            "use strict";\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\n    if (kind === "m") throw new TypeError("Private method is not writable");\n    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");\n    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");\n    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n};\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");\n    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");\n    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar _WorkerRequestExecutor_callbackList;\nconst window = self;\nconst logTypes = ["log", "info", "warn", "error"];\nlogTypes.forEach((logType) => {\n    console[logType] = (...consoleArgs) => {\n        consoleArgs.forEach((arg, index) => {\n            consoleArgs[index] = _getCloneableValue(arg);\n        });\n        if (consoleArgs.length > 0) {\n            const packet = {\n                scriptId: window._scriptId,\n                runtimeId: window._scriptId,\n                eventType: "consoleLog",\n                logType,\n                consoleArgs,\n            };\n            try {\n                postMessage(packet);\n            }\n            catch (e) {\n                packet.consoleArgs = packet.consoleArgs.map((consoleArgObj) => JSON.stringify(consoleArgObj));\n                postMessage(packet);\n            }\n        }\n    };\n});\nconst sendTelemetry = (success, eventName, data) => {\n    const packet = {\n        scriptId: window._scriptId,\n        runtimeId: window._scriptId,\n        eventType: "telemetry",\n        eventName,\n        success,\n        data,\n    };\n    postMessage(packet);\n};\nconst realFetch = self.fetch;\nself.fetch = (resource, init) => {\n    const f = realFetch(resource, init);\n    const id = Math.floor(1000000000 * Math.random()).toString(16);\n    sendTelemetry(true, "fetchStarted", { resource, id });\n    f.then(() => sendTelemetry(true, "fetchEnded", { resource, id })).catch((error) => sendTelemetry(false, "fetchEnded", { resource, id, error }));\n    return f;\n};\nasync function externalMessage(message) {\n    const executor = WorkerRequestExecutor.getWorkerRequestExecutor();\n    const response = await executor.externalMessage(message);\n    return response;\n}\nclass WorkerRequestExecutor {\n    static getWorkerRequestExecutor() {\n        if (!WorkerRequestExecutor.globalWorkerRequestExecutor) {\n            WorkerRequestExecutor.globalWorkerRequestExecutor = new WorkerRequestExecutor();\n        }\n        return WorkerRequestExecutor.globalWorkerRequestExecutor;\n    }\n    constructor() {\n        _WorkerRequestExecutor_callbackList.set(this, void 0);\n        this.m_callbackList = {};\n        this.m_sequenceId = 0;\n        __classPrivateFieldSet(this, _WorkerRequestExecutor_callbackList, {}, "f");\n        addEventListener("message", this.handleMessage.bind(this));\n    }\n    executeAsync(customData, requestFlags, requestMessage) {\n        const messageSafearray = OfficeExtension.RichApiMessageUtility.buildMessageArrayForIRequestExecutor(customData, requestFlags, requestMessage, "officejs");\n        return new OfficeExtension.Promise((resolve, _reject) => {\n            const sequenceId = ++this.m_sequenceId;\n            this.m_callbackList[sequenceId] = resolve;\n            const message = {\n                scriptId: window._scriptId,\n                runtimeId: window._scriptId,\n                eventType: "officeJsMessage",\n                sequenceId,\n                message: messageSafearray,\n            };\n            postMessage(message);\n        });\n    }\n    externalMessage(data) {\n        return new OfficeExtension.Promise((resolve, reject) => {\n            const sequenceId = ++this.m_sequenceId;\n            __classPrivateFieldGet(this, _WorkerRequestExecutor_callbackList, "f")[sequenceId] = { resolve, reject };\n            const message = {\n                scriptId: window._scriptId,\n                runtimeId: window._scriptId,\n                eventType: "externalMessage",\n                sequenceId,\n                message: data,\n            };\n            postMessage(message);\n        });\n    }\n    handleMessage(event) {\n        const data = event.data;\n        const eventType = data.eventType;\n        if (eventType === "officeJsMessageResponse") {\n            this.handleOfficeJsMessageResponse(data);\n        }\n        else if (eventType === "externalMessageResponse") {\n            this.handleExternalMessageResponse(data);\n        }\n    }\n    handleOfficeJsMessageResponse(event) {\n        const result = event.result;\n        const sequenceId = event.sequenceId;\n        const resolve = this.m_callbackList[sequenceId];\n        if (!resolve) {\n            return;\n        }\n        delete this.m_callbackList[sequenceId];\n        OfficeExtension.CoreUtility.log("Response:");\n        OfficeExtension.CoreUtility.log(JSON.stringify(result));\n        let response;\n        if (result.status === "succeeded") {\n            response = OfficeExtension.RichApiMessageUtility.buildResponseOnSuccess(OfficeExtension.RichApiMessageUtility.getResponseBody(result), OfficeExtension.RichApiMessageUtility.getResponseHeaders(result));\n        }\n        else {\n            response = OfficeExtension.RichApiMessageUtility.buildResponseOnError(result.error.code, result.error.message);\n        }\n        resolve(response);\n    }\n    handleExternalMessageResponse(event) {\n        const { result, type, sequenceId } = event;\n        const { resolve, reject } = __classPrivateFieldGet(this, _WorkerRequestExecutor_callbackList, "f")[sequenceId];\n        if (!resolve || !reject) {\n            return;\n        }\n        delete __classPrivateFieldGet(this, _WorkerRequestExecutor_callbackList, "f")[sequenceId];\n        if (type === "resolve") {\n            resolve(result);\n        }\n        else {\n            reject(result);\n        }\n    }\n}\n_WorkerRequestExecutor_callbackList = new WeakMap();\nfunction _loadLibraryUrl(url) {\n    importScripts(url);\n}\nfunction _loadLibraryCode(code) {\n    try {\n        importScripts(URL.createObjectURL(new Blob([code], { type: "application/javascript" })));\n    }\n    catch (error) {\n        eval.call(self, code);\n    }\n}\nfunction _loadLibrary(library) {\n    const { load, value } = library;\n    if (load === "url") {\n        _loadLibraryUrl(value);\n    }\n    else if (load === "code") {\n        _loadLibraryCode(value);\n    }\n    else {\n        throw new Error(`invalid load option [${load}]`);\n    }\n}\nfunction _loadCode(data) {\n    window._scriptId = data.scriptId;\n    const response = {\n        scriptId: data.scriptId,\n        runtimeId: data.scriptId,\n        sequenceId: data.sequenceId,\n        eventType: "loadCodeComplete",\n        message: { status: "Success", result: null },\n    };\n    for (const library of data.libraries) {\n        try {\n            _loadLibrary(library);\n        }\n        catch (error) {\n            const { load, name } = library;\n            const responseError = new Error(`failed to load [${load}] [${name}]`);\n            responseError.innerError = error;\n            response.message.status = "Failed";\n            response.message.error = _getCloneableValue(responseError);\n            break;\n        }\n    }\n    postMessage(response);\n}\nasync function _executeCode(data) {\n    const response = {\n        scriptId: data.scriptId,\n        runtimeId: data.scriptId,\n        sequenceId: data.sequenceId,\n        eventType: "executeComplete",\n        message: { status: "Success", result: "" },\n    };\n    try {\n        const { host } = data;\n        const entryPointFn = window[data.functionName];\n        if (!entryPointFn) {\n            throw new Error(`Expected entrypoint function \'${data.functionName}\' not found.`);\n        }\n        const session = {\n            _resolveRequestUrlAndHeaderInfo: () => OfficeExtension.Utility._createPromiseFromResult(null),\n            _createRequestExecutorOrNull: WorkerRequestExecutor.getWorkerRequestExecutor,\n        };\n        let result;\n        switch (host) {\n            case "None":\n                result = await entryPointFn(...data.functionArgs);\n                break;\n            case "Excel":\n                result = await Excel.run(session, async (context) => {\n                    return await entryPointFn(context, ...data.functionArgs);\n                });\n                break;\n            case "Word":\n                OfficeExtension.SessionBase._overrideSession = session;\n                result = await Word.run(async (context) => {\n                    return await entryPointFn(context, ...data.functionArgs);\n                });\n                break;\n            case "PowerPoint":\n                OfficeExtension.SessionBase._overrideSession = session;\n                result = await PowerPoint.run(async (context) => {\n                    return await entryPointFn(context, ...data.functionArgs);\n                });\n                break;\n            default:\n                result = null;\n                response.message.status = "Failed";\n                response.message.error = "Host not supported";\n                break;\n        }\n        response.message.result = _getCloneableValue(result);\n    }\n    catch (error) {\n        response.message.result = null;\n        response.message.status = "Failed";\n        response.message.error = _getCloneableValue(error);\n    }\n    postMessage(response);\n}\nonmessage = (event) => {\n    const eventType = event.data.eventType;\n    if (eventType === "loadCode") {\n        _loadCode(event.data);\n    }\n    if (eventType === "execute") {\n        _executeCode(event.data);\n    }\n};\nfunction _getCloneableValue(value) {\n    const { cloned, changed } = _clonify(value, new WeakSet());\n    return changed ? cloned : value;\n}\nfunction _clonify(obj, circularReferenceSet) {\n    if (obj && circularReferenceSet.has(obj)) {\n        return { cloned: "<CIRCULAR REFERENCE OBJECT>", changed: true };\n    }\n    if (obj instanceof Function) {\n        return { cloned: obj.toString(), changed: true };\n    }\n    let ch = false;\n    if (obj instanceof Array) {\n        const elements = obj.map((v) => _clonify(v, circularReferenceSet));\n        elements.forEach((val) => {\n            ch = ch || val.changed;\n        });\n        const ret = elements.map((val, index) => (val.changed ? val.cloned : obj[index]));\n        return { cloned: ret, changed: ch };\n    }\n    let newObject = {};\n    if (obj instanceof Object) {\n        circularReferenceSet.add(obj);\n        Object.keys(obj).forEach((property) => {\n            const propVal = obj[property];\n            const { cloned, changed } = _clonify(propVal, circularReferenceSet);\n            if (cloned !== null) {\n                newObject[property] = changed ? cloned : propVal;\n                ch = ch || changed;\n            }\n        });\n        if (obj instanceof Error) {\n            const newObj = {};\n            newObj.message = obj.message;\n            newObj.name = obj.name;\n            newObj.stack = obj.stack;\n            Object.keys(obj).forEach((property) => {\n                newObj[property] = _clonify(obj[property], circularReferenceSet).cloned;\n            });\n            newObject = newObj;\n            ch = true;\n        }\n    }\n    else {\n        newObject = obj;\n    }\n    if (obj) {\n        circularReferenceSet.delete(obj);\n    }\n    return { cloned: newObject, changed: ch };\n}\n\n        <\/script>\n        <script>\n            "use strict";\nconst parentOrigin = "PLACEHOLDER_PARENT_ORIGIN";\nconst nonce = "PLACEHOLDER_NONCE";\nconst allowedSources = "PLACEHOLDER_ALLOWED_SOURCES";\nconst loadCodeDomainList = ["PLACEHOLDER_LOAD_CODE_DOMAIN_LIST"];\nconst permissivePolicy = "default-src \'none\';";\nlet worker;\nfunction isValidHostOrigin(host) {\n    const allowedOrigins = [\n        parentOrigin,\n    ];\n    const matchingOrigin = allowedOrigins.filter((origin) => host.toLowerCase().endsWith(origin.toLowerCase()));\n    return matchingOrigin.length > 0 && host.toLowerCase().startsWith("https://");\n}\nfunction windowMessageHandler(event) {\n    if (isValidHostOrigin(event.origin)) {\n        window.eventOrigin = event.origin;\n        const data = event.data;\n        worker.postMessage(data);\n    }\n}\nfunction workerMessageHandler(event) {\n    let data = event.data;\n    data.nonce = nonce;\n    window.parent.postMessage(data, parentOrigin);\n}\nwindow.addEventListener("message", windowMessageHandler, false);\n(async () => {\n    const code = document.getElementById("workerJs")?.textContent ?? "";\n    const meta = document.createElement("meta");\n    meta.httpEquiv = "Content-Security-Policy";\n    meta.content = permissivePolicy;\n    let scriptSrc = "";\n    if (allowedSources !== "") {\n        meta.content = meta.content + `connect-src ${allowedSources};`;\n    }\n    if (allowedSources !== "*") {\n        loadCodeDomainList.forEach((domain) => {\n            scriptSrc = scriptSrc.concat(domain + " ");\n        });\n    }\n    else {\n        scriptSrc += "* ";\n    }\n    scriptSrc += "\'self\' blob: \'unsafe-eval\' \'unsafe-inline\';";\n    meta.content = meta.content + ` script-src ${scriptSrc}`;\n    const head = document.getElementsByTagName("head")[0];\n    head.appendChild(meta);\n    const blob = new Blob([code], { type: "application/javascript" });\n    worker = new Worker(URL.createObjectURL(blob));\n    worker.onmessage = workerMessageHandler;\n    if (isValidHostOrigin(parentOrigin)) {\n        const message = {\n            eventType: "onWorkerLoaded",\n            nonce,\n        };\n        window.parent.postMessage(message, parentOrigin);\n    }\n})();\n\n        <\/script>\n        <title></title>\n    </head>\n    <body></body>\n</html>\n'},249443:(e,t,n)=>{"use strict";n.d(t,{_f:()=>l,wP:()=>c,Xj:()=>s});var a=n(63212),o=n(347145);function r(e){switch(e){case l.Colorful:case l.White:return{buttonBackgroundDisabled:"#F0F0F0",buttonBackgroundHovered:"#FAFAFA",buttonBackgroundPressed:"#F5F5F5",menuBackground:"#FAFAFA",menuItemBackgroundHovered:"#F0F0F0",menuItemBackgroundPressed:"#DBDBDB"};case l.Black:return{buttonBackgroundDisabled:"#0A0A0A",buttonBackgroundHovered:"#1F1F1F",buttonBackgroundPressed:"#000000",menuBackground:"#1F1F1F",menuItemBackgroundHovered:"#333333",menuItemBackgroundPressed:"#141414"};case l.DarkGray:return{buttonBackgroundDisabled:"#2E2E2E",buttonBackgroundHovered:"#3D3D3D",buttonBackgroundPressed:"#242424",menuBackground:"#424242",menuItemBackgroundHovered:"#525252",menuItemBackgroundPressed:"#383838"};default:return{}}}const i={White:"#FFFFFF",GrayB:"#E6E6E6",GrayE2:"#666666",GrayI:"#262626",GrayJ:"#0a0a0a",Gray18:"#2e2e2e",Gray94:"#f0f0f0",Gray96:"#f5f5f5",ExcelGreen:"#107C41",MacDark:"#323232"};var l;function s(e){const t=function(e){switch(e){case l.DarkGray:return{neutralLight:"#242424",neutralSecondary:"#FFFFFF",themeSecondary:"#E6E6E6"};case l.Black:case l.MacDark:return{neutralLight:"#000000",neutralSecondary:"#FFFFFF",themeSecondary:"#D6D6D6"};case l.White:case l.Colorful:default:return{neutralLight:"#F5F5F5",neutralSecondary:"#212121",themeSecondary:"#424242"}}}(e),n=(0,a.a)({palette:t,semanticColors:r(e)});n.name=e,function(e){const t=document.getElementsByTagName("body").item(0);switch(e){case"DarkGray":return t.classList.toggle("black",!1),void t.classList.toggle("dark-gray",!0);case"Black":return t.classList.toggle("dark-gray",!1),void t.classList.toggle("black",!0);default:t.classList.toggle("dark-gray",!1),t.classList.toggle("black",!1)}}(e);const o=document.documentElement;return o.style.setProperty("--theme-themePrimary",n.palette.themePrimary),o.style.setProperty("--theme-themeLighterAlt",n.palette.themeLighterAlt),o.style.setProperty("--theme-themeLighter",n.palette.themeLighter),o.style.setProperty("--theme-themeLight",n.palette.themeLight),o.style.setProperty("--theme-themeTertiary",n.palette.themeTertiary),o.style.setProperty("--theme-themeSecondary",n.palette.themeSecondary),o.style.setProperty("--theme-themeDarkAlt",n.palette.themeDarkAlt),o.style.setProperty("--theme-themeDark",n.palette.themeDark),o.style.setProperty("--theme-themeDarker",n.palette.themeDarker),o.style.setProperty("--theme-neutralLighterAlt",n.palette.neutralLighterAlt),o.style.setProperty("--theme-neutralLighter",n.palette.neutralLighter),o.style.setProperty("--theme-neutralLight",n.palette.neutralLight),o.style.setProperty("--theme-neutralQuaternaryAlt",n.palette.neutralQuaternaryAlt),o.style.setProperty("--theme-neutralQuaternary",n.palette.neutralQuaternary),o.style.setProperty("--theme-neutralTertiaryAlt",n.palette.neutralTertiaryAlt),o.style.setProperty("--theme-neutralTertiary",n.palette.neutralTertiary),o.style.setProperty("--theme-neutralSecondary",n.palette.neutralSecondary),o.style.setProperty("--theme-neutralPrimaryAlt",n.palette.neutralPrimaryAlt),o.style.setProperty("--theme-neutralPrimary",n.palette.neutralPrimary),o.style.setProperty("--theme-neutralDark",n.palette.neutralDark),o.style.setProperty("--theme-white",n.palette.white),o.style.setProperty("--theme-redDark",n.palette.redDark),o.style.setProperty("--theme-whiteTranslucent40",n.palette.whiteTranslucent40),o.style.setProperty("--theme-green",n.palette.green),o.style.setProperty("--theme-black",n.palette.black),n}function c(){if(!!!window.Office)return"Colorful";try{const e=Office.context.officeTheme;return function(e){switch(e){case i.GrayB:return"Colorful";case i.GrayE2:return"DarkGray";case i.GrayI:return"Black";case i.White:return"White";case i.MacDark:return(0,o.yw9)("OfficeVSO_9748572_PythonAccessibilityBugFixForMac")?"MacDark":"Colorful";default:return"Colorful"}}(e?e.bodyBackgroundColor.toUpperCase():"")}catch{return"Colorful"}}!function(e){e.Colorful="Colorful",e.DarkGray="DarkGray",e.Black="Black",e.White="White",e.MacDark="MacDark"}(l||(l={}))},252120:(e,t,n)=>{"use strict";n.d(t,{F:()=>d,m:()=>c});var a=n(644476),o=n(92520),r=n(347145);const i={alSessionKey:void 0,sydneyConversationId:void 0,sydneyEndpoint:void 0,queryMetrics:{},commandingResponses:{}},l=(e,t,n)=>(e[t]||((0,o.cY)(`Creating new telemetry entry for query ${t}`),e[t]=n),e[t]),s=(0,a.Z0)({name:"telemetry",initialState:i,reducers:{addQueryMetrics(e,t){const{queryId:n,metrics:a}=t.payload;if(!a||0===a.length)return;const o=l(e.queryMetrics,n,{metrics:[]}),r=a.filter((e=>(e=>!e.serviceName?.startsWith("ExtensionRunner:ext:")&&!(!e.input||!e.output)&&("PolymerLLMImprovedNetworking"===e.serviceName||"DeepLeoImprovedNetworking"===e.serviceName||e.isUsed))(e))).filter((e=>((e,t)=>{const n=e.tags?.find((e=>e?.startsWith("unique-id-")));return!n||!t.some((e=>e.tags.includes(n)))})(e,o.metrics)));o.metrics.push(...r)},setAugLoopSessionKey(e,t){e.alSessionKey=t.payload},setSydneyConversationId(e,t){e.sydneyConversationId=t.payload},setSydneyEndpoint(e,t){e.sydneyEndpoint=t.payload},setQueryUserUtterance(e,t){const{queryId:n,userUtterance:a}=t.payload;l(e.queryMetrics,n,{metrics:[]}).userUtterance=a},setCommandingResponseUtterance(e,t){if(!(0,r.geU)())return;const{queryId:n,userUtterance:a,context:o}=t.payload,i=l(e.commandingResponses,n,{context:o});i.userUtterance=a,i.context=o},setCommandingResponse(e,t){if(!(0,r.geU)())return;const{queryId:n,response:a}=t.payload;l(e.commandingResponses,n,{context:""}).response=a},setCommandingResponseCompletion(e,t){if(!(0,r.geU)())return;const{queryId:n,codeCompletedSuccessfully:a,returnedMessage:o}=t.payload,i=l(e.commandingResponses,n,{context:""});i.codeCompletedSuccessfully=a,i.returnedMessage=o}}}),{actions:c,reducer:d}=s},252163:(e,t,n)=>{"use strict";function a(e){if(Office.context.document?.settings?.get){const t=Office.context.document.settings.get(e);if(null===t)return;return t}throw new Error("Unable to get initial taskpane state. 'Office.context.document.settings.get' is not defined.")}function o(){return{AudienceGroup:a("AudienceGroup"),Script:a("Script"),StorageModePreference:a("StorageModePreference"),StartTimeMs:a("StartTimeMs"),copilotPaneStartTimestamp:a("copilotPaneStartTimestamp"),CopilotSaveAutomation:a("CopilotSaveAutomation"),CopilotPAIntegration:a("CopilotPAIntegration"),HandoffMessageId:a("HandoffMessageId"),LaunchOfficeScriptsSDXOptionalProperties:a("LaunchOfficeScriptsSDXOptionalProperties"),optionalProperties:a("optionalProperties"),FlowCreated:a("FlowCreated"),SessionLocation:a("SessionLocation")}}n.d(t,{P:()=>a,i:()=>o})},255507:(e,t,n)=>{"use strict";n.d(t,{B:()=>E});var a=n(857677),o=n(24784),r=n(12163),i=n(46692),l=n(75496),s=n(197665),c=n(749832),d=n(529856),u=n(729851),m=n(831922),g=n(76872),h=n(316904),p=n(261237),b=n(215939),f=n(92520),C=n(347145),y=n(308849),v=n(328831),T=n(993821),x=n(448514),S=n(177115),w=n(301128);class E extends m.TelemetryHandler{initializeCheckPoint(){if(this.recordCheckPoint(a._R.TaskPaneStart,Number(b.excelTaskPaneStartTime)),this.recordCheckPoint(a._R.AppLoadStart,Number(p.appLoadStartTime)),p.officeOnReadyTime&&this.recordCheckPoint(a._R.OfficeJSReady,p.officeOnReadyTime),(0,C.yw9)("OfficeVSO_9262045_ShouldRecordAppAndCopilotPaneStartCheckpoints")){const e=c.V.getSetting(c.z.AppStartTimestamp);e&&this.recordCheckPoint(a._R.AppStart,e);const t=c.V.getSetting(c.z.CopilotPaneStartTimestamp);t&&!(0,b.getPreloadCopilot)()&&this.recordCheckPoint(a._R.CopilotPaneStart,t)}}setCopilotPaneStartPerfMark(){const e=c.V.getSetting(c.z.CopilotPaneStartTimestamp);let t=e?performance.timeOrigin-e:0;t=t>0?t:0,performance.measure("bizchat-metaOS-app.ClickToNavigationStart",{start:0,duration:t})}sendChatEventTelemetry(e,t){return e.push({key:a.h3.ExtensibilityInfo,value:(0,y.Sd)((0,v.Ld)(),(0,v.Gn)())}),this.telemetryLoggerUtils.sendTelemetryChatEventData(e,t)}sendLatencyTelemetry(e,t){return e.push({key:a.h3.ExtensibilityInfo,value:(0,y.Sd)((0,v.Ld)(),(0,v.Gn)())}),this.telemetryLoggerUtils.sendTelemetryLatencyData(e,t)}sendErrorTelemetry(e){e.push({key:a.h3.ExtensibilityInfo,value:(0,y.Sd)((0,v.Ld)(),(0,v.Gn)())}),this.telemetryLoggerUtils.sendTelemetryErrorData(e)}sendTelemetryChatEventData(e){this.sendChatEventTelemetry(e)}sendTelemetryErrorData(e){this.sendErrorTelemetry(e)}sendTelemetryLatencyData(e){this.sendLatencyTelemetry(e)}static getInstance(){return E.instance||(E.instance=new E,m.TelemetryLoggerUtils.getInstance().setTelemetryHandler(E.instance)),E.instance}updateTelemetryOnAnnotationReceived(e,t,n,a,o,r,i){}resetActiveFeature(){E.querySource=E.nextQuerySource?E.nextQuerySource:a.BC.Default,E.nextQuerySource=a.BC.Default,E.querySource===a.BC.ExternalQuery?E.currentEntryPoint=a.Y9.Canvas:E.currentEntryPoint=a.Y9.Chat}setQuerySource(e){E.nextQuerySource=e}LogTelemetryEvent(e){let t=!1;switch(e.GetEventName()){case d.lr.AshaError:case d.lr.Chat:if(e.GetEventName()===d.lr.AshaError&&(t=!0),e.GetShouldLog()){e.SetIsRequired(!0);const n=e.GetLogs().some((e=>"Copilot.FeatureActionType"===e.name&&e.value===o.TA.FeatureActionType.IsTried));this.logSharedCopilotChatTelemetryEvent(e,n,t)}break;case d.lr.ChatEvents:if(!e.GetShouldLog()){for(const t of e.GetLogs())t.name!==a.h3.UserQueryGuid&&(this.telemetryChatEventObject[t.name]=t.value);break}e.SetIsRequired(!0),e.SetLogs([...e.GetLogs(),...this.getDataFields([{key:a.h3.UserQueryGuid,value:h.M.userQueryGuid},{key:a.h3.UserQueryOrder,value:h.M.userQueryOrder},{key:a.h3.ExtensibilityInfo,value:(0,y.Sd)((0,v.Ld)(),(0,v.Gn)())},...(0,C.yw9)("OfficeVSO_9857355_addDevBuildChatEvent")?this.getDefaultTelemetryData():[],...Object.keys(this.telemetryChatEventObject).map((e=>({key:e,value:this.telemetryChatEventObject[e]})))])]),this.logSharedTelemetryEvent(e),this.telemetryChatEventObject={};break;case d.lr.Latency:if(!e.GetShouldLog()){for(const t of e.GetLogs())t.name===a.CT.CopilotChatHistoryInfoJson?this.chatHistoryLog=this.chatHistoryLog.concat(JSON.parse(t.value)):t.name!==a.CT.UserQueryGuid&&(this.telemetryLatencyObject[t.name]=t.value);break}e.SetIsRequired(!0),e.SetLogs([...e.GetLogs().filter((e=>e.name!==a.CT.CopilotChatHistoryInfoJson)),...this.getDataFields([{key:a.CT.CopilotChatHistoryInfoJson,value:JSON.stringify(this.chatHistoryLog)},{key:a.CT.UserQueryGuid,value:h.M.userQueryGuid},{key:a.CT.AugloopSessionGuid,value:w.O},{key:a.CT.FeatureName,value:this.telemetryLogger.getActiveFeature()},{key:a.h3.ExtensibilityInfo,value:(0,y.Sd)((0,v.Ld)(),(0,v.Gn)())},...Object.keys(this.telemetryLatencyObject).map((e=>({key:e,value:this.telemetryLatencyObject[e]})))])]),this.logSharedTelemetryEvent(e),this.chatHistoryLog=[],this.telemetryLatencyObject={};break;case d.lr.Error:if(!e.GetShouldLog())break;e.SetLogs([...e.GetLogs(),...this.getDataFields([{key:a.h3.UserQueryGuid,value:h.M.userQueryGuid},{key:a.h3.ExtensibilityInfo,value:(0,y.Sd)((0,v.Ld)(),(0,v.Gn)())},...(0,C.yw9)("OfficeVSO_9857355_addDevBuildChatEvent")?this.getDefaultTelemetryData():[]])]),this.logSharedErrorEvent(e)}}getDataFields(e){return e.map((e=>"number"==typeof e.value?(0,r.ip)(e.key,e.value):"string"==typeof e.value?(0,r.m9)(e.key,e.value):"boolean"==typeof e.value?(0,r.LK)(e.key,e.value):(0,r.m9)(e.key,e.value)),[])}logSharedCopilotChatTelemetryEvent(e,t,n){const a={telemetryProperties:this.telemetryLogger.getTelemetryProperties(),eventName:"Office.Voice.Copilot.Chat",eventFlags:{dataCategories:e.GetDataCategory(),diagnosticLevel:e.IsRequired()&&(t||n)?i.o.DiagnosticLevel.RequiredServiceData:e.GetDiagnosticLevel(),samplingPolicy:e.IsRequired()?i.o.SamplingPolicy.CriticalUsage:i.o.SamplingPolicy.NotSet},dataFields:e.GetLogs()};this.telemetryLogger.sendTelemetryEvent(a)}logSharedTelemetryEvent(e){const t={eventName:"Office.Voice.ActionAI."+e.GetEventName(),eventFlags:{dataCategories:e.GetDataCategory(),diagnosticLevel:e.GetDiagnosticLevel(),samplingPolicy:e.IsRequired()?i.o.SamplingPolicy.CriticalUsage:i.o.SamplingPolicy.NotSet},dataFields:e.GetLogs()};this.telemetryLogger.sendTelemetryEvent(t)}logSharedErrorEvent(e){const t={eventName:"Office.Voice.ActionAI."+l.S2.Error,error:{errorGroup:e.GetLogs().find((e=>e.name===a.IC.ErrorCategory))?.value,tag:0},eventFlags:{dataCategories:e.GetDataCategory(),diagnosticLevel:e.GetDiagnosticLevel(),samplingPolicy:e.IsRequired()?i.o.SamplingPolicy.CriticalUsage:i.o.SamplingPolicy.NotSet},dataFields:e.GetLogs()};this.telemetryLogger.sendTelemetryEvent(t)}sendTelemetryEvent(e){this.telemetryLogger.sendTelemetryEvent(e)}logKeptEvent(e,t=a.q.Unset,n,r){this.telemetryLoggerUtils.logKeptEvent(r||[...this.getDefaultTelemetryData(),...this.convertDataFieldsToTelemetryData(this.getCopilotDataFields(o.TA.FeatureActionType.IsKept))],E.currentEntryPoint??a.Y9.Chat,e,void 0,void 0,n,t)}logSeenEvent(e,t=a.q.Unset,n,r){if(this.seenEvents.has(t))return;const i=e??this.getStandardizedFeatureForSubFeature(t);this.telemetryLoggerUtils.logSeenEvent(r||[...this.getDefaultTelemetryData(),...this.convertDataFieldsToTelemetryData(this.getCopilotDataFields(o.TA.FeatureActionType.IsSeen))],a.Y9.Chat,i,void 0,n??this.getVerbForStandardizedFeature(i),t),this.seenEvents.add(t)}getStandardizedFeatureForSubFeature(e){switch(e){case a.q.AnalyzeData:return a.BJ.AnalyzeData;case a.q.CalculatedColumns:case a.q.CalculatedRows:case a.q.NLToFormula:return a.BJ.FormulaGeneration;case a.q.Commanding:case a.q.OfficeJsCommanding:case a.q.ShowHeaders:case a.q.SmartHelp:return a.BJ.Commanding;case a.q.ConditionalFormatting:case a.q.ConditionalFormattingSuggestion:return(0,C.yw9)("OfficeVSO_9564930_SplitCommandingTelemetry")?a.BJ.ConditionalFormatting:a.BJ.Commanding;case a.q.DataShaping:return a.BJ.PrepareData;case a.q.HandOff:return a.BJ.Handoff;case a.q.ImportDataFromSearch:return a.BJ.ImportData;case a.q.Search:return a.BJ.Search;case a.q.OfficeScripts:return a.BJ.OfficeScripts;case a.q.Python:return a.BJ.Python;case a.q.InsertTable:return a.BJ.Search;case a.q.SelfHelp:return a.BJ.ChatQnA;case a.q.ImageChat:case a.q.ChatPaneLoad:case a.q.ConvertToTable:case a.q.CopilotChat:case a.q.SampleData:case a.q.ContextInference:return a.BJ.CopilotChat;case a.q.Else:return a.BJ.ExcelChatHelper;case a.q.Answers:return a.BJ.Answers;case a.q.CopyMessage:case a.q.ExternalTriggeredQuery:case a.q.UndoMessage:default:return a.BJ.CopilotChat}}getVerbForStandardizedFeature(e){switch(e){case a.BJ.AnalyzeData:case a.BJ.PrepareData:case a.BJ.Python:case a.BJ.Answers:return u.RX.Analyze;case a.BJ.ChatQnA:case a.BJ.Search:return u.RX.Ask;case a.BJ.FormulaGeneration:case a.BJ.ImportData:return u.RX.Create;case a.BJ.Commanding:case a.BJ.ConditionalFormatting:case a.BJ.OfficeScripts:return u.RX.Command;case a.BJ.CopilotChat:case a.BJ.ExcelChatHelper:case a.BJ.Handoff:default:return}}getDefaultTelemetryData(){const e=[{key:l.Wg.UserQueryGuid,value:E.userQueryGuid},{key:l.Wg.ClientVersion,value:"9.57.2"},{key:l.Wg.GroundingMode,value:(0,a.Q6)()},{key:l.Wg.IsDevBuild,value:!1},{key:l.Wg.UiLanguage,value:(0,s.Yd)()}];return void 0!==E.querySource&&e.push({key:l.Wg.QuerySource,value:E.querySource}),(0,C.yw9)("OfficeVSO_10534295_LogCopilotExperience")&&(0,C.UW0)()&&e.push({key:l.Wg.CopilotExperience,value:(0,T.dL)()?.PrimaryUserAccountInfo?.CopilotExperience??"AppChat"}),e}getCopilotDataFields(e,t,n,a){const r=e===o.TA.FeatureActionType.IsTried||e===o.TA.FeatureActionType.IsKept||e===o.TA.FeatureActionType.IsRejected||void 0!==t,i=e===o.TA.FeatureActionType.IsTried||e===o.TA.FeatureActionType.IsKept||e===o.TA.FeatureActionType.IsRejected||void 0!==t;return[...o.TA.getFields({interactionId:r?n??E.userQueryGuid:"",conversationId:i?a??E.conversationId:""})]}convertDataFieldsToTelemetryData(e){return e.map((e=>({key:e.name,value:e.value})))}logTelemetryForSharedChatPaneLoad(){if(p.copilotPaneStartTimestamp){const e={[a.CT.SDXResourcesLoadTime]:(0,x.W)(b.excelTaskPaneStartTime),[a.CT.FeatureName]:a.BJ.ChatPaneLoad};(0,b.getPreloadCopilot)()?(0,C.wQA)()||b.copilotPaneStartTimestampAfterPreload&&(e[a.CT.UserCopilotPaneLoadTime]=(0,x.W)(b.copilotPaneStartTimestampAfterPreload)):e[a.CT.UserCopilotPaneLoadTime]=(0,x.W)(p.copilotPaneStartTimestamp),g.E.getInstance().updateTelemetryLatencyData(e,this.telemetryLogger)}else g.E.getInstance().updateTelemetryLatencyData({[a.CT.SDXResourcesLoadTime]:(0,x.W)(b.excelTaskPaneStartTime),[a.CT.FeatureName]:a.BJ.ChatPaneLoad},this.telemetryLogger);g.E.getInstance().updateTelemetryChatEventData({[a.h3.ChatEventType]:a.a5.TaskPaneStart,[a.h3.ChatEventParameters]:b.excelTaskPaneStartTime},this.telemetryLogger),g.E.getInstance().updateTelemetryChatEventData({[a.h3.ChatEventType]:a.a5.AppLoadStart,[a.h3.ChatEventParameters]:p.appLoadStartTime},this.telemetryLogger),p.officeOnReadyTime&&g.E.getInstance().updateTelemetryChatEventData({[a.h3.ChatEventType]:a.a5.OfficeJSReady,[a.h3.ChatEventParameters]:p.officeOnReadyTime.toString()},this.telemetryLogger),g.E.getInstance().updateTelemetryChatEventData({[a.h3.ChatEventType]:a.a5.CopilotEnabledAfterAutoSave,[a.h3.ChatEventParameters]:(0,S.Y)()},this.telemetryLogger),g.E.getInstance().updateTelemetryChatEventData({[a.h3.ChatEventType]:a.a5.ShowDisabledScreen,[a.h3.ChatEventParameters]:(0,S.iN)()},this.telemetryLogger);const e=(0,b.getPreloadCopilot)();e&&g.E.getInstance().updateTelemetryChatEventData({[a.h3.ChatEventType]:a.a5.PreloadCopilot,[a.h3.ChatEventParameters]:e.toString()},this.telemetryLogger);const t=JSON.stringify({isDeclarativeAgentsEnabled:(0,C.Pz_)(),shouldUseMsalGetTokenRequestCaching:(0,C.xZX)(),enableSwitcherMenuV2:(0,C.o25)(),loadGptListOnCopilotIconClick:(0,C.AFi)(),enableAgentsBasedOnSkill:(0,C.VDk)()});(0,f.cY)(`Sending extensibility config telemetry for chat pane load ${t}`),this.sendChatEventTelemetry((0,a.pN)({[a.h3.ChatEventType]:a.a5.ExtensibilityConfig,[a.h3.ChatEventParameters]:t})),this.recordCheckPoint(a._R.ChatPaneLoaded)}recordCheckPoint(e,t){t&&0!==t&&!Number.isNaN(t)||(t=(new Date).getTime()),0===this.checkPointStartTime?(this.checkPointStartTime=t,this.checkPoints[e]=0):this.checkPoints[e]=t-this.checkPointStartTime}sendLatencyTelemetryForCheckPoints(e){const t=JSON.stringify(this.checkPoints);(0,f.cY)("sendLatencyTelemetryForCheckPoints: ",t),this.sendLatencyTelemetry((0,a.pN)({[a.CT.CheckPoints]:t}),e)}setInitialHandoffQuery(e){(0,f.cY)("setInitialHandoffQuery: ",e),this.initialHandoffQuery=e}sendHandoffQuerySubmittedEvent(e){if(!this.initialHandoffQuery)return;e=e.trim();const t=this.initialHandoffQuery.trim(),n=!(e===t||e.includes(t));(0,f.cY)("Handoff query is submitted. IsModified: "+n),E.getInstance().sendChatEventTelemetry([{key:a.h3.ChatEventType,value:a.a5.HandoffQuerySubmittedByUser},{key:a.h3.ChatEventParameters,value:`${a.CD.IsModified}:${n}`}]),this.initialHandoffQuery=void 0}constructor(){super(),this.chatHistoryLog=[],this.seenEvents=new Set,this.logUserCopilotPaneLoadTelemetry=(e,t=a.CT.ExcelUserCopilotPaneLoadTime,n=a.BJ.Preload_ChatPaneLoad)=>{const o=parseFloat((0,f.gZ)(e));g.E.getInstance().updateTelemetryLatencyData({[t]:(0,x.W)(o),[a.CT.FeatureName]:n},this.telemetryLogger),this.recordCheckPoint(a._R.CopilotPaneStart,o)},this.sendVisibilityModeChangedTelemetry=e=>{E.getInstance().sendChatEventTelemetry((0,a.pN)({[a.h3.ChatEventType]:a.a5.TaskPaneVisibilityModeChanged,[a.h3.ChatEventParameters]:e}))},this.telemetryLogger=h.M.getInstance(),this.telemetryLoggerUtils=m.TelemetryLoggerUtils.getInstance(),this.telemetryLoggerUtils.setTelemetryHandler(E.instance),this.telemetryChatEventObject={},this.telemetryLatencyObject={},this.checkPoints={},this.checkPointStartTime=0,this.initializeCheckPoint(),this.setCopilotPaneStartPerfMark()}}E.querySource=void 0,E.nextQuerySource=void 0,E.currentEntryPoint=void 0,E.conversationId=void 0,E.userQueryGuid=""},260197:(e,t,n)=>{"use strict";n.d(t,{Fc:()=>a,I5:()=>l,Wr:()=>r,i$:()=>d,q7:()=>c,ur:()=>i,xT:()=>s});var a,o=n(795917);!function(e){e.NoGeneratedLinks="NoGeneratedLinks",e.NoQuery="NoQuery",e.NoResponse="NoResponse",e.OutboundMessageResponse="OutboundMessageResponse",e.HandoffMessageResponse="HandoffMessageResponse"}(a||(a={}));var r,i,l="I ran into a problem while completing your request. Please try again.",s="The query in handoff message is empty or undefined.";!function(e){e.CrossAppCanvasHandoff="CrossAppCanvasHandoff",e.CrossAppHandoff="CrossAppHandoff",e.InAppHandoff="InAppHandoff"}(r||(r={})),function(e){e.TellMe="TellMe",e.WordCopilotComposeSelection="WordCopilotComposeSelection",e.ContextMenuRewriteClickAction="ContextMenuRewriteClickAction",e.WordCopilotRewriteSelection="WordCopilotRewriteSelection",e.SkittleContextMenuUserClickAction="SkittleContextMenuUserClickAction",e.WordCopilotComprehensionPodcast="WordCopilotComprehensionPodcast",e.ResearcherAgent="ResearcherAgent",e.CopilotContextMenuClickAction="CopilotContextMenuClickAction",e.WordCopilotVisualAssistantDescribeImage="WordCopilotVisualAssistantDescribeImage",e.PPTFileNameRenamed="PPTFileNameRenamed",e.CopilotTranslatedPPTInfo="CopilotTranslatedPPTInfo"}(i||(i={}));var c=[i.WordCopilotComprehensionPodcast,i.WordCopilotVisualAssistantDescribeImage,i.PPTFileNameRenamed,i.CopilotTranslatedPPTInfo],d=new Map([[i.TellMe,o.$.M365CopilotChat],[i.WordCopilotComposeSelection,o.$.M365CopilotChat],[i.ContextMenuRewriteClickAction,o.$.M365CopilotChat],[i.WordCopilotRewriteSelection,o.$.M365CopilotChat],[i.SkittleContextMenuUserClickAction,o.$.M365CopilotChat],[i.ResearcherAgent,o.$.M365CopilotChat],[i.CopilotContextMenuClickAction,o.$.M365CopilotChat],[i.WordCopilotComprehensionPodcast,o.$.AppChat]])},261237:(e,t,n)=>{"use strict";n.r(t),n.d(t,{EntryPoint:()=>q,appLoadStartTime:()=>M,copilotPaneStartTimestamp:()=>D,copilotStringsLoaded:()=>B,isPublicApiInitialized:()=>$,officeOnReadyTime:()=>O});var a=n(639765),o=n(548366),r=n(178365),i=n(279395),l=n(905666),s=n(777555),c=n(451511),d=n(347145),u=n(851295),m=n(208520);const g={root:{height:"100vh",width:"100vw",justifyContent:"center",alignItems:"center"}},h=()=>{let e;return(0,d.yw9)("OfficeVSO_9227275_RtlErrorScreen")&&(e=(0,u.xt)()?"rtl":"ltr"),m.createElement(l.B,{styles:g,dir:e},m.createElement(s.E,{variant:"large"},(0,i.Oj_)()),m.createElement(s.E,{variant:"medium"},(0,i.RCr)()),m.createElement("br",null),m.createElement(c.j,{onClick:()=>{window.location.reload()},text:(0,i.BVL)()}),m.createElement("br",null))};var p=n(316904),b=n(758651);class f extends m.Component{static getDerivedStateFromError(e){return p.M.getInstance().logUncaughtException(e),{hasError:!0,error:e}}componentDidCatch(e,t){b.error(e,t)}render(){return this.state.hasError?m.createElement(h,null):this.props.children}constructor(e){super(e),this.state={hasError:!1,error:void 0}}}var C=n(749832),y=n(911443),v=n(857677),T=n(887648),x=n(255507),S=n(76872),w=n(215939),E=n(109174),I=n(92520),R=n(630530),A=n(819415),L=n(8403),k=n(252163),F=n(672270),_=n(794329),P=n(652382),N=n(622753);const M=(new Date).getTime().toString();let O,D,B=!1,$=!1;const H=async()=>{Office.onReady((async e=>{e.addin?("Hidden"===e.addin.visibilityMode&&!(0,d.wQA)()&&(0,d.lSN)()&&U(),(0,d.At2)()&&(await A.u$.promise(),(0,w.getPreloadCopilot)()||(await R.So.promise(),E.CP.initPublic((0,L.KA)().dispatch),$=!0)),Office.addin.onVisibilityModeChanged((function(e){if((0,I.cY)(`Visibility_mode changed to  ${e.visibilityMode}`),e.visibilityMode===i.DwS){if(w._fShowPreloadedCopilot){const e=C.V.getSetting(C.z.CopilotPaneStartTimestamp);e&&x.B.getInstance().logUserCopilotPaneLoadTelemetry(e.toString(),v.CT.UserCopilotPaneLoadTime_PreloadTime,v.BJ.ShowPreloadedCopilot)}p.M.getInstance().releaseHeldTelemetryEvents();const e=r.$.getInstance();e.shouldScrollToBottom()&&e.scrollToBottom()}}))):((0,I.cY)("hostAndPlatform.addin is null"),await async function(){try{if(O=(new Date).getTime(),(0,P.Ok)(),S.E.getInstance().logPerformanceEntries(performance.getEntriesByType("resource")),new PerformanceObserver((e=>{S.E.getInstance().logPerformanceEntries(e.getEntries())})).observe({entryTypes:["navigation","resource"]}),D=(0,k.P)("copilotPaneStartTimestamp"),D)S.E.getInstance().logLatency(performance.timeOrigin-D,v.OP.OpenSdx);else{const e=(0,k.P)("StartTimeMs");e&&S.E.getInstance().logLatency(performance.timeOrigin-e,v.OP.OpenSdx)}(0,d.H_5)()&&await U(),await A.u$.promise(),(0,w.getPreloadCopilot)()||(await R.So.promise(),E.CP.initPublic((0,L.KA)().dispatch),$=!0)}catch(e){e instanceof y.DY&&(0,I.cY)(e.message),p.M.getInstance().logUncaughtException(e),p.M.getInstance().logStandardizedAshaErrorEvent(o.W.Copilot_Chat_Pane_Failed_To_Load,a.c.Pane_Crashed,v.BJ.CopilotChat),(0,d.yw9)("OfficeVSO_9680233_ErrorScreenHideShimmer")&&(0,F.sZ)(),(0,_.render)(m.createElement(h,null),document.getElementById("container"))}}())}))};async function U(){if(B)return void(0,I.cY)("preload Strings already loaded");const e=(new Date).getTime();await(0,u.XX)();const t=((new Date).getTime()-e)/1e3;S.E.getInstance().logLatency(t,v.OP.LoadLocalizedStrings),B=!0}const q=m.memo((e=>(m.useEffect((()=>{H()}),[]),m.createElement("div",null,m.createElement(f,null,m.createElement(T.Kq,{store:(0,L.KA)()},m.createElement(N.A,e)))))))},261720:(e,t,n)=>{"use strict";n.d(t,{uq:()=>v,KF:()=>D,U2:()=>p,xR:()=>_,GM:()=>S,MK:()=>B,pE:()=>T});var a=n(507628),o=n(178365),r=n(769506),i=n(857677),l=n(758651);const s={Equals:async function(e){if(!e.path||void 0===e.value)throw new Error("Invalid 'Equals' assertion data");const t=e.path.match(/worksheets\.\[(\d+)\]\.\[([A-Z0-9:]+)\]\.value/);if(!t)return!1;const n=parseInt(t[1],10),a=t[2];return Excel.run((async t=>{const o=t.workbook.worksheets;o.load("items"),await t.sync();const r=o.items[n],i=r.getRange(a);return i.load("values"),await t.sync(),l.log(`Grading: Checking if values: ${i.values} on range address ${a} in worksheet ${r.name} matches assertion values ${e.value}`),JSON.stringify(i.values)===JSON.stringify(e.value)}))}};async function c(e){const t=e.expression.map((e=>e.map((e=>e.startsWith("!")?{name:e.substring(1),negate:!0}:{name:e,negate:!1}))));const n={};for(const t of Object.keys(e.assertions)){const a=e.assertions[t],o=s[a.kind];void 0!==o?n[t]=await o(a):l.log(`Grading: Skipping computing assertions of the kind, "${a.kind}", for it to be computed in the later stages.`)}for(const e of t){let t=!0,a=!0;for(const o of e){const e=n[o.name];if(void 0===e){a=!1;break}if(e===o.negate){t=!1;break}}if(t||!a)return!0}return!1}var d=n(347145),u=n(279395),m=n(45698),g=n(301735);class h{static generateRows(e){return e.map(((e,t)=>{const n=e.test,a=n.worked?"Passed":"Failed",o=n.endToEndTime,r=n.create.workbook;return`\n          <tr class="${a}">\n              <td>${t+1}</td>\n              <td>${n.query}</td>\n              <td>${r}</td>\n              <td>${a}</td>\n              <td>${o}</td>\n          </tr>\n        `})).join("")}static generateHTMLReport(e){return`\n      <!DOCTYPE html>\n      <html lang="en">\n      <head>\n          <meta charset="UTF-8">\n          <title>Automated End-to-End Tests Report</title>\n          <style>\n              body { font-family: Arial, sans-serif; padding: 20px; }\n              table { width: 100%; border-collapse: collapse; margin-top: 20px; }\n              th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }\n              th { background-color: #f2f2f2; }\n              .passed { background-color: #d4edda; }\n              .failed { background-color: #f8d7da; }\n          </style>\n      </head>\n      <body>\n          <h1>Automated End-to-End Tests Report</h1>\n          <table>\n              <thead>\n                  <tr>\n                      <th>#</th>\n                      <th>Query</th>\n                      <th>File</th>\n                      <th>Status</th>\n                      <th>End-To-End Time(ms)</th>\n                  </tr>\n              </thead>\n              <tbody>\n                  ${this.generateRows(e)}\n              </tbody>\n          </table>\n      </body>\n      </html>\n    `}}var p,b=n(109174),f=n(211006),C=n(92520),y=n(758651);!function(e){e[e.Running=0]="Running",e[e.Success=1]="Success",e[e.Failure=2]="Failure"}(p||(p={}));const v=["None","Test Started","Creating Test Workbook","Using Existing Workbook State","Test Workbook Created","Deleting temporary worksheet","Starting Test Execution","Using Prefetched Server Output","Using Prefetched Server Error","Creating AugLoop Signal","Sending Augloop Signal","Augloop Data Received","Reached Executor","Finished Editing","Test Execution Finished","Manually Checking Test Changes","Automatically Checking Test Changes","Automatically Checking Test With No Checking Code","Workbook Context Extracted"];function T(e){return v.includes(e)}class x extends Error{extractAllProperties(e){if("object"==typeof e){if(Array.isArray(e))return e.map((e=>this.extractAllProperties(e)));if(null===e)return e;const t={},n=new Set(Object.getOwnPropertyNames(e));for(const t of Object.keys(e))n.add(t);for(const a of n)t[a]=e[a];return t}return e}assign(e){e[this.name[0].toLowerCase()+this.name.substring(1)]=this.extractAllProperties(this.propertyValue)}constructor(e,t=!0){super(),this.propertyValue=t,this.name=e}}class S extends x{constructor(e){super("WorkbookPreparationError",e)}}class w extends x{constructor(e){super("WorkbookCheckingError",e)}}class E extends x{constructor(){super("ManualChangeCheckFailed")}}class I extends x{constructor(){super("AutomatedChangeCheckFailed")}}class R extends x{constructor(){super("NoCheckProvidedError")}}class A extends x{constructor(){super("TimeoutError")}}class L extends x{constructor(e,t){super("WrongSkillCalledError",{actual:e,required:t})}}class k extends x{constructor(e){super("AugloopServerError",e)}}class F extends x{constructor(e){super("EditingError",e)}}class _ extends x{constructor(e,t){super("TestingError",{testingFunction:e,error:t})}}class P{tryTestingFunction(e,t,n){if(this.activeTestId===e&&this.callbacks)try{n()}catch(e){this.callbacks.error(new _(t.name,e))}}startTest(e,t,n,a=!1,o){(0,d.usH)()&&(this.startAugloopCallTime=Date.now(),this.activeTestId=e,this.callbacks=n,this.requiredSkillUsed=t,this.receivedAugloopResponse=!1,this.isEvalVNextFlow=a,this.evalVNextOptions=o,this.cancelTimeout=window.setTimeout((()=>this.callbacks?.error(new A)),P.TEST_TIME_LIMIT))}stopTest(){this.activeTestId=null,this.callbacks=null,this.requiredSkillUsed=void 0,this.startAugloopCallTime=null,this.endAugloopCallTime=null,this.startEditTime=null,this.endEditTime=null,this.receivedAugloopResponse=!1,clearTimeout(this.cancelTimeout),this.cancelTimeout=void 0}getAugloopCallTime(){return null!==this.startAugloopCallTime&&null!==this.endAugloopCallTime?this.endAugloopCallTime-this.startAugloopCallTime:null}getEditTime(){return null!==this.startEditTime&&null!==this.endEditTime?this.endEditTime-this.startEditTime:null}augloopErrorReceived(e,t){this.tryTestingFunction(e,this.augloopErrorReceived,(()=>{const e=t.json?JSON.parse(t.json):t;this.callbacks.error(new k(e))}))}augloopResponseReceived(e,t,n){this.tryTestingFunction(e,this.augloopResponseReceived,(()=>{if(this.receivedAugloopResponse)return;this.endAugloopCallTime=Date.now(),!0===n.isFinalResponse&&(this.receivedAugloopResponse=!0);let e="";switch(this.requiredSkillUsed){case i.q.OfficeJsCommanding:e=g.w.EditDocumentName;break;case i.q.CalculatedColumns:e=g.w.CalculatedColumnsName;break;case i.q.AnalyzeData:e=g.w.ChartsAndPivotTablesName;break;case i.q.DataShaping:e=g.w.DataShapingName;break;case i.q.Python:e=(0,d.yw9)("OfficeVSO_10393641_UpdateAASkillName")&&(0,d.EJJ)()?g.w.NewPythonSkillName:g.w.PythonSkillName;break;case i.q.Answers:e=g.w.AnswersName}if(this.callbacks.augloopResponseReceived(t,n),e&&e!==t)this.callbacks.error(new L(t,e));else if(this.isEvalVNextFlow&&this.receivedAugloopResponse)if(this.endAugloopCallTime=Date.now(),this.evalVNextOptions?.applySuggestion){const e=o.$.getInstance().getLastMessage(),t=e&&Array.isArray(e.actionBarButtons)?e.actionBarButtons:[],n=t.length>0?t[0]:void 0;if(n){n.handleButtonOnClick();const e=5e3,t=this.evalVNextOptions?.pageOperationTimeout??9e4,a=Date.now(),r=o.$.getInstance().getLastMessage(!1),i=(e,n)=>e.getLastMessage(!1)?.messageId===n?.messageId?Date.now()-a>t?(clearInterval(this.pollInterval),clearTimeout(this.pollTimeout),void this.callbacks.finished()):void 0:(clearInterval(this.pollInterval),clearTimeout(this.pollTimeout),void this.callbacks.finished());i(o.$.getInstance(),r),this.pollInterval=window.setInterval((()=>i(o.$.getInstance(),r)),e),this.pollTimeout=window.setTimeout((()=>{clearInterval(this.pollInterval),this.callbacks.finished(),clearTimeout(this.pollTimeout)}),t)}else this.callbacks.error(new F("No suggestion button found to apply"))}else this.callbacks.finished()}))}reachedSkillExecutor(e,t,...n){this.tryTestingFunction(e,this.reachedSkillExecutor,(()=>{this.callbacks.reachedSkillExecutor(t,...n)}))}acceptUpcomingChange(e,t){this.tryTestingFunction(e,this.acceptUpcomingChange,(async()=>{const e=`button[title="${(0,u.yZI)()}"]`;try{await new Promise(((t,n)=>{let a=0;const o=window.setInterval((()=>{const n=document.querySelector(e);n&&!n.disabled&&(clearInterval(o),clearTimeout(a),t(n))}),200);a=window.setTimeout((()=>{clearInterval(o),n(new Error(`"${e}" not enabled within 50000ms`))}),5e4)})),t()}catch(e){this.callbacks.error(new F(e))}}))}editStarted(e){this.tryTestingFunction(e,this.editStarted,(()=>{this.startEditTime=Date.now()}))}editFinished(e,t,n,...a){this.tryTestingFunction(e,this.editFinished,(()=>{this.endEditTime=Date.now(),this.callbacks.editFinished(t,n,...a),n?this.callbacks.finished(t):this.callbacks.error(new F(a))}))}constructor(){this.activeTestId=null,this.callbacks=null,this.requiredSkillUsed=void 0,this.isEvalVNextFlow=!1,this.evalVNextOptions=void 0,this.startAugloopCallTime=null,this.endAugloopCallTime=null,this.startEditTime=null,this.endEditTime=null,this.cancelTimeout=void 0,this.receivedAugloopResponse=!1,this.pollInterval=void 0,this.pollTimeout=void 0}}async function N(){let e,t=0,n=0,a=new Uint8Array(0);return new Promise((o=>{function r(i){e?.getSliceAsync(i,(e=>{if(e.status===Office.AsyncResultStatus.Succeeded){const{data:l}=e.value,s=new Uint8Array(a.length+l.length);s.set(a),s.set(l,a.length),a=s,t++,t===n?o(a):r(i+1)}}))}Office.context.document.getFileAsync(Office.FileType.Compressed,{sliceSize:4194304},(function(t){t.status===Office.AsyncResultStatus.Succeeded?(e=t.value,n=e.sliceCount,r(0)):o(null)}))})).finally((()=>e?.closeAsync()))}async function M(e,t){const n=await N();n&&(0,f.PE)(n,"application/octet-stream",e+".xlsx",t)}async function O(){const e=await N();if(!e)return null;let t="";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return btoa(t)}P.TEST_TIME_LIMIT=18e4;class D{addTestToActive(e){this.setTestInfo((t=>(t.push({test:e,state:0,runningState:"Test Started",stateDetails:["Test Started"],initialWorkbookBase64:"",finalWorkbookBase64:""}),this.finishedTests=[...t])))}updateActiveTestInfo(e,t){this.setTestInfo((n=>{const a=n.find((t=>t.test===e));return t(a),this.finishedTests=[...n]}))}failTest(e,t){return this.updateActiveTestInfo(e,(n=>{const a=e.endToEndErrors=e.endToEndErrors??{};a.statesBeforeError=n.stateDetails,n.state=2,n.stateDetails.push("Failed"),t instanceof x?(t.assign(a),n.stateDetails.push(t.name)):(a.unclassified=a.unclassified??[],a.unclassified.push(t)),e.worked=!!e.expectedFailureStates&&e.expectedFailureStates.includes(n.runningState),n.runningState="None"})),!1}passTest(e){this.updateActiveTestInfo(e,(e=>{e.state=1,e.runningState="None",e.stateDetails.push("Passed"),e.test.worked=!0}))}updateTestStateDetails(e,t,n){this.updateActiveTestInfo(e,(e=>{e.runningState=t,n&&e.stateDetails.push(t+": "+n),e.stateDetails.push(t)}))}addTestData(e,t){this.updateActiveTestInfo(e,(e=>{Object.assign(e.test,t)}))}async usePrefetchedData(e,t,n){if(n===i.q.OfficeJsCommanding)this.officeJsCommanding.handleOfficeJsResult(e,t)}transformMessagesToCopilotResponse(e){const t=[];for(const n of e)"bot"===n.author&&(n.text&&t.push({type:"text",content:n.text}),n.code&&t.push({type:"code",content:n.code}),n.output&&t.push({type:"output",content:n.output}));return t}addChatLogToTest(e,t){const n=t?.chatResponse;let a=[];Array.isArray(n?.messagesToAddOrReplace)?a=n.messagesToAddOrReplace:Array.isArray(n?.messages)&&(a=n.messages);const o=e.chatLog??{},r=a.length>0?this.transformMessagesToCopilotResponse(a):void 0,i=[...o.errors??[],...t?.error?[t.error]:[]],l={augloopAnnotations:[...o.augloopAnnotations??[],t],copilotResponse:r?[...o.copilotResponse??[],...r]:o.copilotResponse,messages:a.length>0?[...o.messages??[],...a]:o.messages,errors:i.length>0?i:o.errors};this.addTestData(e,{chatLog:l})}async startTestCase(e){if(this.addTestToActive(e),!e.create.workbook)return this.updateTestStateDetails(e,"Using Existing Workbook State"),!0;this.updateTestStateDetails(e,"Creating Test Workbook"),b.CP.lockContextRefresh();const t=await async function(){return Excel.run((async e=>{const t=e.workbook,n=t.worksheets.load("items");await e.sync();const a="_"+Math.random().toString(16)+"__";t.worksheets.add(a),n.items.forEach((e=>e.delete()));const o=t.names.load("items"),r=t.queries.load("items"),i=t.slicerStyles.load("items/readOnly"),l=t.tableStyles.load("items/readOnly"),s=t.timelineStyles.load("items/readOnly"),c=t.pivotTableStyles.load("items/readOnly");await e.sync(),o.items.forEach((e=>e.delete())),r.items.forEach((e=>e.delete())),i.items.forEach((e=>!e.readOnly&&e.delete())),l.items.forEach((e=>!e.readOnly&&e.delete())),s.items.forEach((e=>!e.readOnly&&e.delete())),c.items.forEach((e=>!e.readOnly&&e.delete()));try{const n=t.styles.load("items/builtIn");await e.sync(),n.items.forEach((e=>!e.builtIn&&e.delete()))}catch{}return a}))}();return this.isEvalVNextFlow||await(0,C.uk)(2e3),await Excel.run((async t=>{const n=this.workbooks[e.create.workbook];if(t.workbook.insertWorksheetsFromBase64(n),this.evalVNextOptions?.fetchWorkbookBase64){await t.sync();const n=await O();this.updateActiveTestInfo(e,(e=>{e.initialWorkbookBase64=n||""}))}})),this.isEvalVNextFlow||await(0,C.uk)(2e3),await Excel.run((async t=>{await async function(e,t){const n=e.workbook;let a=n.worksheets.getActiveWorksheet(),o=t?.name,r="",i=null;switch(t?.type){case"range":{const[i,l]=t.name.split("!");r=l??t.name,o=i;const s=n.worksheets.getItemOrNullObject(o);await e.sync(),s.isNullObject||(a=s);break}case"chart":{const o=n.worksheets.load("items");await e.sync();const r=[];for(const e of o.items)r.push(e.charts.getItemOrNullObject(t.name));await e.sync();const l=r.find((e=>!e.isNullObject));l&&(i=l,a=l.worksheet);break}case"worksheet":{const t=void 0===o||""===o?n.worksheets.getActiveWorksheet():n.worksheets.getItemOrNullObject(o);await e.sync(),t.isNullObject||(a=t,r="A1");break}case"table":{const o=n.tables.getItemOrNullObject(t.name),i=o.getRange().getCell(0,0).load("address");await e.sync(),o.isNullObject||(a=o.worksheet,r=i.address.split("!")[1]??i.address);break}case"pivot table":{const o=n.pivotTables.getItemOrNullObject(t.name),i=o.layout.getRange().getCell(0,0).load("address");await e.sync(),o.isNullObject||(a=o.worksheet,r=i.address.split("!")[1]??i.address);break}}await e.sync(),a.activate(),r&&a.getRange(r).select(),i&&i.activate()}(t,e.create)})),e.create.afterCreationScript&&await new Function("return "+e.create.afterCreationScript.replace(/^await /,""))(),this.updateTestStateDetails(e,"Deleting temporary worksheet"),this.isEvalVNextFlow||await(0,C.uk)(2e3),await Excel.run((async e=>{e.workbook.worksheets.getItemOrNullObject(t).delete()})),await b.CP.releaseContextLock(),this.updateTestStateDetails(e,"Test Workbook Created"),!0}async executeTestCase(e){let t,n,r=null;if(this.updateTestStateDetails(e,"Starting Test Execution"),e.requiredFeatureUsed===i.q.OfficeJsCommanding)e.officeScripts&&(t=e.officeScripts,n=e.officeScripts.error);t&&(r=e.serverTime?e.serverTime:0);let l=null;await new Promise(((r,i)=>{const l=(0,a.A)();return B.startTest(l,e.requiredFeatureUsed,{finished:r,error:i,augloopResponseReceived:this.augloopResponseReceived.bind(this,e),reachedSkillExecutor:this.reachedSkillExecutor.bind(this,e),editFinished:this.editFinished.bind(this,e)},this.isEvalVNextFlow,this.evalVNextOptions),n?(this.updateTestStateDetails(e,"Using Prefetched Server Error"),void B.augloopErrorReceived(l,n)):t?(this.updateTestStateDetails(e,"Using Prefetched Server Output"),this.reachedSkillExecutor(e,e.requiredFeatureUsed,t),void this.usePrefetchedData(l,t,e.requiredFeatureUsed)):(this.updateTestStateDetails(e,"Creating AugLoop Signal"),void this.communicationHandler.getDefaultSignalOperation(e.query,l).then((t=>{this.updateTestStateDetails(e,"Sending Augloop Signal");const n=t.operation.items[0].body;n.context=e.context=e.context??n.context,this.addTestData(e,{augloopInputBody:n}),o.$.getInstance().submitOperation(t)})))})).catch((e=>l=e)),r=r||B.getAugloopCallTime();const s=B.getEditTime(),c=null!==r&&null!==s?r+s:null;if(this.addTestData(e,{endToEndTime:c,serverTime:r,editTime:s}),B.stopTest(),l)throw l;return this.updateTestStateDetails(e,"Test Execution Finished"),!0}async checkTestCase(e){if(this.manuallyCheckTest){this.updateTestStateDetails(e,"Manually Checking Test Changes");const t=await new Promise((t=>{this.manuallyCheckTest({test:e,resolve:t})}));return this.manuallyCheckTest(void 0),t?this.passTest(e):this.failTest(e,new E),t}let t=e.check;if(e.grader&&!t&&(t=`evaluateGrader(JSON.parse(${JSON.stringify(JSON.stringify(e.grader))}));`),t){this.updateTestStateDetails(e,"Automatically Checking Test Changes");const n=await new Function("checkHelpers","evaluateGrader","return "+t.replace(/^await /,""))(D.checkHelpers,c);let a=!1;return"boolean"==typeof n?a=n:(a=n?.passed,this.addTestData(e,{evaluationDetails:n})),a?this.passTest(e):this.failTest(e,new I),a}return this.updateTestStateDetails(e,"Automatically Checking Test With No Checking Code"),this.passOnNoCheck?(this.passTest(e),!0):(this.failTest(e,new R),!1)}async run(){let e=!1;const t=Math.ceil(Math.log10(this.tests.length)),n=this.tests.map((e=>e.category)).filter(((e,t,n)=>e&&n.indexOf(e)===t)).length===this.tests.length;for(const[a,o]of this.tests.entries()){a&&!this.isEvalVNextFlow&&await(0,C.uk)(2e3);const r=n?`${o.category}.${this.testFilename}`:`#${a.toString().padStart(t,"0")} (${o.query.length>50?o.query.substring(0,50)+" ...":o.query})`;try{this.setCancelTests({reject:()=>{e=!0,t=!1}});let t=!0;if(t=await this.startTestCase(o).catch((e=>this.failTest(o,new S(e)))),!t)continue;if(this.saveStates&&await M(`${r}  --  (before)`,this.workbookDirHandle),t=await this.executeTestCase(o).catch((e=>this.failTest(o,e))),this.saveStates&&await M(`${r}  --  (after)`,this.workbookDirHandle),!t)continue;if(await this.checkTestCase(o).catch((e=>{this.failTest(o,new w(e))})),this.evalVNextOptions?.fetchWorkbookBase64){const e=await O();this.updateActiveTestInfo(o,(t=>{t.finalWorkbookBase64=e||""}))}this.setCancelTests({reject:()=>{}})}catch(e){this.failTest(o,new _(this.run.name,e))}if(e)return this.finishedTests}y.log(this.finishedTests);let a=JSON.stringify(this.finishedTests.map((e=>e.test)));for(const[e,t]of Object.entries(this.workbooks))a=a.replace(t,`<${e} base64 data>`);if(!this.isEvalVNextFlow){const e=h.generateHTMLReport(this.finishedTests);await(0,f.PE)(a,"application/json",`results-${this.testFilename}.json`,this.resultFileDirHandle),await(0,f.PE)(e,"text/html",`report-${this.testFilename}.html`,this.resultFileDirHandle)}return this.finishedTests}constructor(e,t,n,a,o,l,s,c,d,u,m,g=!1,h=void 0){this.workbooks=t,this.communicationHandler=a,this.passOnNoCheck=o,this.saveStates=l,this.setTestInfo=s,this.setCancelTests=c,this.manuallyCheckTest=d,this.resultFileDirHandle=u,this.workbookDirHandle=m,this.isEvalVNextFlow=g,this.evalVNextOptions=h,this.finishedTests=[],this.augloopResponseReceived=(e,t,n)=>{this.addChatLogToTest(e,n),this.addTestData(e,{skillCalled:t,augloopOutputBody:n}),!0===n.isFinalResponse&&this.updateTestStateDetails(e,"Augloop Data Received")},this.reachedSkillExecutor=(e,t,...n)=>{switch(this.updateTestStateDetails(e,"Reached Executor",t),t){case i.q.OfficeJsCommanding:{const t=n[0];this.addTestData(e,{officeScripts:t});break}}},this.editFinished=(e,t,n,...a)=>{switch(this.updateTestStateDetails(e,"Finished Editing",t),t){case i.q.OfficeJsCommanding:{const t=a[0],o={...e.officeScripts=e.officeScripts??{}};o.codeCompletedSuccessfully=n,this.addTestData(e,{officeScripts:o,returnedMessage:t});break}}},this.tests=e.tests,this.testFilename=e.filename,this.officeJsCommanding=new r.$v(n),this.evalVNextOptions=h,this.isEvalVNextFlow=g}}D.checkHelpers=new class{getExactColorName(e){return m.g.colorNameFromHEX(e)?.toLowerCase()??""}getGeneralColorName(e){return m.g.colorNameFromHEX(e,!0)?.toLowerCase()??""}levenshteinDistance(e,t){let n=e,a=t;n.length>a.length&&(n=t,a=e);const o=[];for(let e=0;e<=n.length;e++)o[e]=e;for(let e=1;e<=a.length;e++){let t=e;for(let r=1;r<=n.length;r++){let i=-1;i=a.charAt(e-1)===n.charAt(r-1)?o[r-1]:Math.min(o[r-1]+1,t+1,o[r]+1),o[r-1]=t,t=i}o[n.length]=t}return o[n.length]}closestString(e,t){let n="",a=1/0;for(const o of t){const t=this.levenshteinDistance(e,o);if(0===t)return o;t<a&&(n=o,a=t)}return n}getGeneralChartType(e){switch(e){case Excel.ChartType.columnClustered:case Excel.ChartType.columnStacked:case Excel.ChartType.columnStacked100:case Excel.ChartType._3DColumn:case Excel.ChartType._3DColumnClustered:case Excel.ChartType._3DColumnStacked:case Excel.ChartType._3DColumnStacked100:return Excel.ChartType.columnClustered;case Excel.ChartType.barClustered:case Excel.ChartType.barStacked:case Excel.ChartType.barStacked100:case Excel.ChartType._3DBarClustered:case Excel.ChartType._3DBarStacked:case Excel.ChartType._3DBarStacked100:return Excel.ChartType.barClustered;case Excel.ChartType.line:case Excel.ChartType.lineStacked:case Excel.ChartType.lineStacked100:case Excel.ChartType.lineMarkers:case Excel.ChartType.lineMarkersStacked:case Excel.ChartType.lineMarkersStacked100:case Excel.ChartType._3DLine:return Excel.ChartType.line;case Excel.ChartType.pie:case Excel.ChartType.pieOfPie:case Excel.ChartType.pieExploded:case Excel.ChartType._3DPieExploded:case Excel.ChartType.barOfPie:case Excel.ChartType._3DPie:return Excel.ChartType.pie;case Excel.ChartType.xyscatter:case Excel.ChartType.xyscatterSmooth:case Excel.ChartType.xyscatterSmoothNoMarkers:case Excel.ChartType.xyscatterLines:case Excel.ChartType.xyscatterLinesNoMarkers:return Excel.ChartType.xyscatter;case Excel.ChartType.area:case Excel.ChartType.areaStacked:case Excel.ChartType.areaStacked100:case Excel.ChartType._3DArea:case Excel.ChartType._3DAreaStacked:case Excel.ChartType._3DAreaStacked100:return Excel.ChartType.area;case Excel.ChartType.surface:case Excel.ChartType.surfaceWireframe:case Excel.ChartType.surfaceTopView:case Excel.ChartType.surfaceTopViewWireframe:return Excel.ChartType.surface;case Excel.ChartType.doughnut:case Excel.ChartType.doughnutExploded:return Excel.ChartType.doughnut;case Excel.ChartType.radar:case Excel.ChartType.radarMarkers:case Excel.ChartType.radarFilled:return Excel.ChartType.radar;case Excel.ChartType.bubble:case Excel.ChartType.bubble3DEffect:return Excel.ChartType.bubble;case Excel.ChartType.stockHLC:case Excel.ChartType.stockOHLC:case Excel.ChartType.stockVHLC:case Excel.ChartType.stockVOHLC:return Excel.ChartType.stockHLC;case Excel.ChartType.cylinderColClustered:case Excel.ChartType.cylinderColStacked:case Excel.ChartType.cylinderColStacked100:case Excel.ChartType.cylinderBarClustered:case Excel.ChartType.cylinderBarStacked:case Excel.ChartType.cylinderBarStacked100:case Excel.ChartType.cylinderCol:return Excel.ChartType.cylinderBarClustered;case Excel.ChartType.coneColClustered:case Excel.ChartType.coneColStacked:case Excel.ChartType.coneColStacked100:case Excel.ChartType.coneBarClustered:case Excel.ChartType.coneBarStacked:case Excel.ChartType.coneBarStacked100:case Excel.ChartType.coneCol:return Excel.ChartType.coneColClustered;case Excel.ChartType.pyramidColClustered:case Excel.ChartType.pyramidColStacked:case Excel.ChartType.pyramidColStacked100:case Excel.ChartType.pyramidBarClustered:case Excel.ChartType.pyramidBarStacked:case Excel.ChartType.pyramidBarStacked100:case Excel.ChartType.pyramidCol:return Excel.ChartType.pyramidColClustered;default:return e}}};const B=new P},265167:(e,t,n)=>{"use strict";n.d(t,{r:()=>r});var a=n(660606),o="AugLoopChat".concat(a.JB),r=function(){function e(){}return e.generateId=function(){return e.operationId++,o+e.operationId.toString()},e.operationId=0,e}()},269636:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},279395:(e,t,n)=>{"use strict";n.d(t,{Yhj:()=>va,CnK:()=>ag,Tem:()=>og,Ub7:()=>rg,p8k:()=>ig,S08:()=>ng,inn:()=>jt,MiK:()=>zc,W4k:()=>pt,zVb:()=>bt,U2P:()=>id,AXy:()=>Oc,V7x:()=>da,WJg:()=>ua,I5y:()=>Qs,PDm:()=>js,Rzj:()=>la,fDp:()=>fa,_Q4:()=>Ca,Hum:()=>ca,mRA:()=>pa,P6V:()=>ba,S5F:()=>ia,zr:()=>ir,sJU:()=>lr,l7G:()=>sr,s46:()=>cr,lqT:()=>dr,cRY:()=>rr,OSb:()=>gn,a0$:()=>ya,$Sd:()=>sa,hiC:()=>Di,YTh:()=>Pi,bUh:()=>Mi,aI5:()=>Oi,wT9:()=>Ni,YXQ:()=>Kn,Q40:()=>Zn,wYv:()=>Yn,Dvy:()=>jn,SqW:()=>ma,NUW:()=>ha,ynC:()=>ga,Tr2:()=>Jn,z15:()=>Sa,n00:()=>wa,IyO:()=>Xn,YgX:()=>E,t9X:()=>Ih,ht0:()=>k,xJ7:()=>z,YB4:()=>Q,yZI:()=>zd,nuZ:()=>ol,iUs:()=>_t,BFD:()=>It,MCi:()=>Lt,l_I:()=>kt,UDz:()=>Ft,sWz:()=>iu,CY_:()=>Rt,RVs:()=>ou,AUM:()=>ru,HTR:()=>bn,PEH:()=>fn,Vx2:()=>pn,dKK:()=>ki,CDl:()=>Um,P13:()=>sh,z32:()=>rh,yo8:()=>th,Pqn:()=>oh,XD3:()=>lh,ay0:()=>ah,H6H:()=>ch,DqZ:()=>ih,qp3:()=>nh,o9V:()=>wc,omg:()=>hc,Atw:()=>bc,qcV:()=>Hl,ZKU:()=>ht,HGr:()=>j,qjK:()=>dt,Goo:()=>Y,u3x:()=>ne,YbA:()=>Z,ZX_:()=>ee,yUb:()=>J,_1n:()=>ut,wzr:()=>mt,SXB:()=>X,mYV:()=>ae,wQR:()=>K,Rc5:()=>te,jcG:()=>gt,zQo:()=>Bi,imT:()=>I,tOz:()=>Qn,Xxp:()=>R,eZ0:()=>Nc,Wuy:()=>Js,CDV:()=>Ys,QKr:()=>Xs,AUu:()=>Zs,wnp:()=>Ks,yid:()=>ec,nsJ:()=>uc,bo$:()=>tc,H1r:()=>nc,N0H:()=>ac,$c5:()=>lc,paF:()=>dc,PKs:()=>oc,Dt7:()=>rc,dcf:()=>ic,DXl:()=>sc,HPY:()=>cc,Bjy:()=>Sr,NIQ:()=>Kt,ahY:()=>en,tl8:()=>tn,IZs:()=>an,ir6:()=>nn,Hn3:()=>on,LA5:()=>rn,aXL:()=>Wt,svm:()=>$t,L1E:()=>Ht,UVk:()=>Ut,$cm:()=>qt,UGc:()=>Vt,q7F:()=>ji,Lii:()=>L,uy0:()=>Lg,vdP:()=>ll,KCq:()=>dl,Muj:()=>Ui,XsD:()=>Qi,dw7:()=>qm,ICT:()=>el,XM5:()=>Mc,zSd:()=>Pr,hJV:()=>Mr,yPQ:()=>Or,AbP:()=>_r,DSt:()=>Dr,lj0:()=>_i,go9:()=>Fi,vqw:()=>fr,oOi:()=>Cr,v7j:()=>yr,vks:()=>vr,YKk:()=>br,DwD:()=>Nr,ZcJ:()=>ea,Sur:()=>aa,UFE:()=>ta,$nW:()=>na,Gpd:()=>oa,N9u:()=>ra,VCG:()=>Gm,$0s:()=>Pc,T0z:()=>Wd,yNF:()=>qd,I77:()=>Bd,t_C:()=>Ud,LNV:()=>Vd,AsH:()=>$d,z4t:()=>Hd,$5J:()=>Gd,mjl:()=>zn,ax8:()=>Gn,OfU:()=>oe,q_f:()=>re,TaP:()=>Hs,H6b:()=>Wn,COL:()=>Vr,Klw:()=>qr,eII:()=>Wr,JF4:()=>Ai,rZm:()=>Ii,O0M:()=>Ec,Pzq:()=>pg,GyK:()=>bg,TMJ:()=>fg,OpW:()=>Cg,rho:()=>yg,xmO:()=>hg,DPI:()=>ph,tMN:()=>hh,erl:()=>Qd,rBP:()=>jd,Ib6:()=>cn,NKv:()=>mn,OXO:()=>dn,xqS:()=>un,PUb:()=>sn,LxC:()=>jc,wzs:()=>Ie,fYt:()=>Re,yXE:()=>ce,A99:()=>Ee,Bdz:()=>Ae,Bms:()=>Fe,qmi:()=>Me,SpP:()=>Le,bCm:()=>ke,$oZ:()=>ve,lp5:()=>_e,CcC:()=>pe,aRL:()=>be,gXw:()=>Ne,eMD:()=>Se,i3R:()=>fe,pF5:()=>Ce,bLM:()=>xe,K1Z:()=>Pe,vK1:()=>me,m$v:()=>ge,Y9M:()=>de,O8z:()=>ue,AS_:()=>he,y3x:()=>Te,kSh:()=>we,FuV:()=>sg,yWY:()=>cg,tPp:()=>dg,YSs:()=>ug,di6:()=>mg,ean:()=>gg,TVz:()=>lg,fOb:()=>Jt,Xlr:()=>ri,y9Z:()=>si,Hdt:()=>ii,EoV:()=>Og,uvk:()=>Dg,ZDb:()=>xh,K2I:()=>al,Obq:()=>Nt,UuN:()=>nu,u1i:()=>Zt,mT9:()=>Nn,VMi:()=>hi,Ogc:()=>Bt,Oj_:()=>Lr,RCr:()=>kr,BVL:()=>Fr,M8Q:()=>P,tFi:()=>N,wZB:()=>Er,vvX:()=>mh,aDv:()=>uh,R7A:()=>gh,ySS:()=>Sh,I3c:()=>au,m1B:()=>Uc,FA0:()=>qg,gAP:()=>Ws,_h7:()=>zs,Twc:()=>Gs,_A_:()=>Li,SHb:()=>St,czL:()=>Eg,jh3:()=>Ig,M76:()=>wg,u1Q:()=>Xt,YWO:()=>Wi,qbK:()=>G,XBr:()=>wt,vG7:()=>vn,zyf:()=>Tn,AWH:()=>Xg,yfY:()=>Zg,jdI:()=>Ji,QEp:()=>Gt,ekx:()=>Ta,vMn:()=>ar,Edn:()=>gd,nEe:()=>hd,syu:()=>cd,LhO:()=>dd,Af3:()=>ud,Bfv:()=>md,$Mo:()=>ld,UQX:()=>sd,$Eq:()=>Vi,M_y:()=>il,koJ:()=>cl,hIB:()=>ml,OS6:()=>vd,Txd:()=>fd,h9u:()=>pd,u1U:()=>bd,zb:()=>Cd,yWm:()=>Rd,pZZ:()=>Dd,Z4S:()=>kd,N0D:()=>Td,k0o:()=>Nd,kM:()=>Md,uLY:()=>Od,U45:()=>Ld,n1d:()=>Ed,Rcx:()=>Id,Dqz:()=>wd,m3r:()=>Sd,Iiw:()=>Ad,Vd6:()=>yd,gTs:()=>xd,w$T:()=>Pd,NLG:()=>_d,J40:()=>En,E$x:()=>yt,aVz:()=>ft,oOI:()=>vh,BqH:()=>Ct,IKl:()=>Rn,Nbb:()=>Bs,EWN:()=>vt,Yyo:()=>In,fLI:()=>Rg,LLM:()=>An,imX:()=>g,WlT:()=>m,u7V:()=>b,w_Q:()=>p,W32:()=>h,Vno:()=>c,gu1:()=>d,mDj:()=>u,VHx:()=>Rr,bcx:()=>Ir,Amo:()=>Ri,BU1:()=>Ar,Kc4:()=>tl,M_1:()=>We,tZV:()=>Ge,SUe:()=>ze,zZj:()=>Qe,uo4:()=>Ke,x4R:()=>et,znb:()=>ye,_lL:()=>Ze,tJt:()=>rt,aaC:()=>it,wvg:()=>Xe,BaS:()=>at,CP3:()=>ot,XQw:()=>je,$LK:()=>Je,_73:()=>Ye,_9M:()=>tt,Bpz:()=>nt,XFR:()=>Be,ZYo:()=>qe,w7p:()=>$e,T8g:()=>He,ZU3:()=>Ue,De1:()=>Ve,j9u:()=>Th,UOv:()=>De,C3N:()=>or,olU:()=>U,WpK:()=>$i,PX_:()=>Rc,T1Y:()=>S,cGI:()=>w,ifF:()=>F,Sak:()=>Ei,XWM:()=>Si,ReY:()=>wi,_C5:()=>xi,Pjp:()=>gc,dlV:()=>Ic,hAn:()=>mr,aS7:()=>gr,VdU:()=>hr,aDZ:()=>pr,o3Z:()=>ur,xau:()=>se,L8i:()=>ie,AKP:()=>le,J0g:()=>Oe,Rff:()=>Sm,nKX:()=>Wm,Tg4:()=>Zi,_:()=>zm,L0p:()=>Vn,QOn:()=>qn,GRk:()=>Jg,r$C:()=>A,V0i:()=>Ug,aYy:()=>Fg,Pot:()=>kg,SS1:()=>Pg,nx1:()=>_g,SCL:()=>lu,MKr:()=>su,_ZG:()=>Vm,Ehc:()=>Ng,BVu:()=>eu,ir3:()=>tu,v3A:()=>$r,KVc:()=>Hr,f7s:()=>Br,CLD:()=>Ur,Nfx:()=>li,_kX:()=>Kr,IH5:()=>ti,Y55:()=>ei,CPY:()=>Gr,ak4:()=>jr,s2u:()=>Zr,mF:()=>Qr,T5i:()=>Jr,r8x:()=>Yr,nPU:()=>Xr,gnM:()=>oi,kAS:()=>zr,gtW:()=>_,R_I:()=>bh,xxz:()=>V,OX0:()=>Ln,gGJ:()=>nl,FxF:()=>$g,zGM:()=>Hg,NRU:()=>Fc,gOS:()=>ad,Gn5:()=>Dc,e0T:()=>od,ds$:()=>_m,sY1:()=>Om,kTv:()=>Hm,Fsb:()=>km,DIE:()=>Lm,jpr:()=>Mm,pRP:()=>Nm,KBQ:()=>Fm,I53:()=>Pm,JGR:()=>$m,NeW:()=>Bm,sGO:()=>Dm,vKl:()=>Em,CNP:()=>Im,v$B:()=>Rm,C2X:()=>Am,AZo:()=>_c,ft7:()=>Bc,VDh:()=>kc,hLq:()=>td,ZSg:()=>rd,u6S:()=>$c,n0L:()=>nd,hiv:()=>bi,zDx:()=>Fd,y$1:()=>hl,Sa0:()=>Jc,Ony:()=>Yc,KdV:()=>yc,$98:()=>vc,UTd:()=>Rh,kDR:()=>_u,NSY:()=>Lu,RT6:()=>Pu,j0F:()=>ku,Q0:()=>Ru,fzU:()=>xu,I$I:()=>Tu,JAc:()=>Cu,gNJ:()=>fu,nhC:()=>wu,fu2:()=>mu,EW5:()=>uu,mk8:()=>Su,I$d:()=>vu,t8C:()=>yu,TTT:()=>hu,IpP:()=>gu,qbB:()=>bu,B3O:()=>pu,fRc:()=>du,ENk:()=>cu,LC$:()=>qu,ijW:()=>Uu,irK:()=>Bu,J$y:()=>Du,RV_:()=>Ou,uVJ:()=>Fu,hEI:()=>Eu,qU2:()=>Mu,P82:()=>xm,v3q:()=>Iu,Y2N:()=>Nu,I64:()=>Hu,pDo:()=>$u,wUB:()=>Au,Vl3:()=>is,ELg:()=>as,J9g:()=>rs,LAW:()=>es,Efv:()=>Kl,I_l:()=>Zl,Rpx:()=>ts,Sl:()=>Rl,Gyx:()=>Ll,kQP:()=>Ol,ZgC:()=>At,jv5:()=>xl,GLO:()=>vl,WIE:()=>gs,Sk4:()=>Il,gg6:()=>Us,JIA:()=>$s,pa_:()=>qs,YvV:()=>Vs,kvH:()=>pl,YCq:()=>$l,mq0:()=>Al,IiW:()=>Bl,x75:()=>ms,vCA:()=>fs,YYS:()=>bs,Toc:()=>xs,g$5:()=>Ts,r5N:()=>ns,g9p:()=>Dl,Yzk:()=>Xl,ABr:()=>Ml,Lby:()=>Jl,lL1:()=>Fs,o7M:()=>ks,A1r:()=>Fl,O4H:()=>_l,jYw:()=>kl,xUh:()=>wl,wW0:()=>os,Lw5:()=>Ps,OKX:()=>Ls,lgi:()=>Cl,FCw:()=>fl,ivT:()=>As,XZh:()=>ps,pKU:()=>Ds,Huq:()=>ct,aDI:()=>st,EwU:()=>lt,UvY:()=>Nl,zOC:()=>Pl,V8T:()=>Ns,S3X:()=>yl,vX0:()=>ls,oPd:()=>ds,oMg:()=>ss,csN:()=>cs,g1k:()=>Tl,ZOw:()=>Cs,$L3:()=>El,rfR:()=>us,NCh:()=>ql,gU_:()=>_s,QAQ:()=>jl,dvg:()=>Sl,zqN:()=>Vl,LMV:()=>Ql,PxQ:()=>zl,XXH:()=>Ul,Dpi:()=>Yl,lQ6:()=>Wl,WQT:()=>Gl,YVl:()=>Is,rhr:()=>ys,EB5:()=>Os,PHI:()=>Ms,GRh:()=>Ss,dI9:()=>ws,PX7:()=>Rs,CsI:()=>Es,ie5:()=>hs,V9X:()=>bl,DjY:()=>vs,hn:()=>fi,epH:()=>Ti,Pqm:()=>Ci,ZB_:()=>vi,BaM:()=>yi,b4o:()=>Mt,KC:()=>Pt,bj$:()=>wn,r9E:()=>Xi,Rp5:()=>ai,mnG:()=>Hi,XKD:()=>ci,QbU:()=>di,ejy:()=>ui,YtG:()=>Xc,qvS:()=>Zc,W9h:()=>Tc,JuZ:()=>xc,pwZ:()=>Ag,Is:()=>Qc,Iy7:()=>vg,Qv5:()=>Tg,Xdl:()=>xg,QaT:()=>Sg,OsU:()=>f,QCY:()=>kn,ZOE:()=>Fn,$TB:()=>dh,FIy:()=>Ki,byP:()=>xa,brP:()=>rl,t3j:()=>sl,Kve:()=>ul,yMF:()=>qi,fVE:()=>Ac,lJi:()=>xr,s_X:()=>Tr,ZQs:()=>qc,iMG:()=>Vc,xKU:()=>Gc,cFM:()=>Wc,gZd:()=>Ra,JEr:()=>_a,hzZ:()=>La,lkD:()=>Ia,dYE:()=>ka,gax:()=>Aa,jmZ:()=>Ea,G5z:()=>ln,fkZ:()=>ho,EZu:()=>Fa,PFs:()=>Pa,h8D:()=>Ch,BZb:()=>fh,b_h:()=>yh,Qte:()=>Sc,etO:()=>zi,rGh:()=>v,HhS:()=>Km,$S6:()=>tg,gq9:()=>eg,xFL:()=>Zm,hAW:()=>Qt,S0l:()=>wm,Pxj:()=>Ku,Gp3:()=>Zu,qre:()=>Xu,P$N:()=>Yg,MIy:()=>Vg,bor:()=>Wg,MuJ:()=>Qg,VJh:()=>jg,uvg:()=>Gg,R3b:()=>zg,h_t:()=>fm,ev2:()=>bm,up8:()=>pm,c_T:()=>hm,Dh1:()=>gm,Tlk:()=>mm,mJ6:()=>um,z56:()=>dm,jLG:()=>cm,vkL:()=>sm,GIT:()=>lm,c7Y:()=>im,C$7:()=>Yu,Thz:()=>Ju,ZkE:()=>ju,VH3:()=>ym,S7l:()=>Cm,nYf:()=>vm,mcb:()=>nm,pP4:()=>tm,nMc:()=>em,pOf:()=>rm,kMm:()=>om,ujQ:()=>am,L0V:()=>Qu,NXr:()=>zu,DIq:()=>Gu,p8O:()=>Tm,YMx:()=>Wu,eGo:()=>Vu,HZc:()=>Dt,DwS:()=>C,fw9:()=>y,Ykh:()=>Mg,wzu:()=>gi,xtr:()=>M,Yuw:()=>O,NOF:()=>mi,Moz:()=>Eh,$sl:()=>wh,vLX:()=>mc,qPG:()=>Kg,Py2:()=>eh,pH2:()=>wr,fhV:()=>Hc,OJx:()=>Gi,chZ:()=>pc,px2:()=>Cn,_J3:()=>yn,HRg:()=>gl,sUU:()=>xn,W1n:()=>Sn,mLK:()=>Xm,wEx:()=>Ym,Y91:()=>Jm,vuT:()=>jm,J_P:()=>zt,Eyh:()=>hn,DUN:()=>Qm,AWW:()=>Et,KeO:()=>Tt,ooE:()=>xt,xk_:()=>Bg,ORJ:()=>Lc,H2U:()=>ni,iVS:()=>Yi,AF5:()=>pi,USL:()=>Pn,tDq:()=>_n,UEB:()=>On,v01:()=>Mn,gk_:()=>Bn,DyN:()=>Dn,Fxc:()=>$n,MED:()=>Un,TSg:()=>Hn,VAP:()=>Yt,zvE:()=>Kc,tdb:()=>fc,mjS:()=>ed,kfS:()=>Cc,KsV:()=>Xa,ztP:()=>Za,Oz3:()=>go,Bzb:()=>po,gsW:()=>Go,bgS:()=>zo,ixU:()=>wo,BhF:()=>Eo,E9A:()=>Co,pKA:()=>yo,BIf:()=>$o,wwj:()=>Ho,D02:()=>Do,QHr:()=>Bo,nHd:()=>ro,KtU:()=>io,lun:()=>qa,fEB:()=>Wa,On3:()=>Va,qag:()=>Ha,d0n:()=>Ua,no:()=>Ka,qAx:()=>eo,$dh:()=>Ma,U7J:()=>ko,roM:()=>Uo,esl:()=>qo,D8x:()=>xo,Coj:()=>So,H5o:()=>mo,I1u:()=>co,N_T:()=>uo,_JR:()=>za,jI0:()=>Oa,lFW:()=>Vo,aW0:()=>Wo,_ok:()=>_o,Z2X:()=>Fo,Ghz:()=>Ga,nby:()=>Xo,_BM:()=>Zo,zp5:()=>Na,$OL:()=>to,C_C:()=>no,wvv:()=>Io,hCI:()=>Ro,sqX:()=>bo,xf7:()=>fo,vJt:()=>Ko,ST4:()=>er,vNK:()=>$a,ONP:()=>Ba,_0P:()=>tr,tMQ:()=>nr,IZv:()=>Da,xMZ:()=>vo,YYh:()=>To,NyX:()=>Mo,WNU:()=>Oo,xOV:()=>ao,_zy:()=>oo,UXx:()=>Qa,VG_:()=>ja,XAy:()=>Po,kvY:()=>No,qhm:()=>Ao,DqS:()=>Lo,Qhk:()=>Qo,rnM:()=>jo,r3R:()=>Jo,_xk:()=>Yo,ptM:()=>Ja,K0f:()=>Ya,itS:()=>lo,f00:()=>so,Z1M:()=>x,GHt:()=>Ah,OKS:()=>Kd,sj0:()=>Jd,Vgn:()=>Yd,ZAw:()=>Xd,Ovt:()=>Zd,fn_:()=>T,SGs:()=>D,N1d:()=>$,kK2:()=>H});var a=n(197665),o=n(347145);function r(e,t=3e3){window.setTimeout((()=>{throw new Error(e)}),t)}function i(e,t,n=r){return new Proxy(t,{get(t,a){if("string"!=typeof a)return n("Unexpected string name type"),"";const o=a,r=globalThis[e];return r?r[o]:(n(`Requesting string ${e}.${a} before strings have loaded`),t[o])}})}const l=JSON.parse('{"FREHeader":"Introducing Copilot","FREDescriptionMessage":"Use the power of AI to add columns with formulas, format tables, and generate insights about data in your tables.\\n\\nCopilot can make mistakes, so remember to verify info and share your feedback.","ServerErrorMessage":"Whoops! I\'m not able to understand this yet. Is there something else I can do to help?","QueryLengthTooShortError":"Your message is too short. Please provide more information.","RaiErrorUserMessage":"I\'m not able to do that. What else can I do for you?","RaiErrorSuccessfulActionBlockedResponse":"Done! I made some changes, but I\'m not able to provide a description of the changes right now.","ServerErrorWithNoRetry":"I can\'t help with that. Try another prompt or use the prompt guide to see how I can help.","ServerErrorWithNoRetrySuggestionPill":"While I don\'t have a suggestion for you right now, try asking a specific question about the data.","ThrottlingErrorMessage":"You\'ve reached the limit on the total number of Copilot requests per hour. Try again in a little while.","LicensingErrorMessage":"Your account is not licensed to use Copilot, please contact your admin","ErrorQueryTooLarge":"I\'m still learning. That request is too large. Would you mind simplifying your request to one thing you want me to do?","ErrorServerBusy":"The server is really busy right now. Please try again later.","ZQMPromptItemAsk":"Ask","ZQMPromptItemSummarize":"Summarize","CitationTitle":"This workbook","ClpLabelError":"I wasn\'t able to apply a sensitivity label to this file. Please choose another file or try again.","BlankWorksheetButtonText":"Try an example","BlankWorksheetButtonSuccess":"Done! I\'ve added the sample table. Try some of the suggestions to see how I can help.","ConvertToTableButtonSuccess":"Done! I\'ve created a Table from your data in {0}. How else can I help?","InsertTableSummaryCommentSuccessMessage":"Done! I added the description as a comment at {0}","TableTooLargeMessage":"Copilot doesn\'t work with tables that have more than 40,000 cells. Try again with a smaller table.","TLRTooSmallMessage":"I can only work on data ranges that have at least 3 rows and 2 columns. If the range doesn\'t meet this criteria, convert it to a table by selecting **Insert** in the ribbon, and then selecting **Table**.","LoadingTableLikeRangesWarning":"While I\'m understanding your data, feel free to ask general Excel questions or try again later if my answer is inaccurate.","ShowHeadersButtonTitle":"Show Header Row","ShowHeadersSuccessMessage":"Done! I\'ve made the header row of the table visible. How else can I help?","WorkbookTooLargeTitle":"Workbook too large","WorkbookTooLargeMessage":"Copilot doesn\'t work with workbooks that have more than 150,000 cells. Try using Copilot with a smaller workbook.","WorksheetAutosaveOffTitle":"AutoSave is turned off","WorksheetAutosaveOffMessage":"I only work with files that have AutoSave turned on. Turn it on to continue.","EnableAutosaveButtonText":"Turn on AutoSave","WorksheetProtectedTitle":"This sheet is protected","WorksheetProtectedMessage":"I can\'t work on sheets that are protected or require a password. If you remove the protection temporarily, I can help you explore your data. Don\'t worry, you can add the protection back anytime.","NonWorksheetActivatedTitle":"Start with a different sheet","NonWorksheetActivatedMessage":"I don\'t work in chart, macro, or dialog sheets. Select another sheet with data in an Excel table to continue.","ActionButtonGoToTable":"Go back to table","ActionButtonGoToData":"Go back to data","ActionButtonGoToWorksheet":"Go back to {0}","ActionButtonInsert":"Insert to new sheet","ActionButtonUndo":"Undo","ActionButtonUndoSuccessMessage":"Sure, I just reversed the last change I made.","ActionButtonApply":"Apply","InsertSingleTableSuccessMessage":"Done! A new table was inserted to {0}.","InsertMultiTablesSuccessMessage":"Done! {0} tables were added to your workbook.","InsertTableErrorMessage":"Sorry, something went wrong. Try your request again later.","InsertAllDataConfirmationMessage1":"Done! All insights from","InsertAllDataConfirmationMessage2":"were added to a new sheet.","InsertAllDataConfirmationMessage":"Done! I added all insights from {0} to a new sheet.","InsertDataConfirmationMessage1":"Done!","InsertDataConfirmationMessage2":"was added to","InsertDataConfirmationMessage":"Done! I added {0} to {1}.","CalculatedColumnsColumnConfirmationMessage":"Done! I inserted \'{0}\' to column {1}.","CalculatedColumnsTableConfirmationMessage":"Done! I inserted \'{0}\' to \'{1}\'.","MultipleCalculatedColumnsAddedToColumnsConfirmationMessage":"Done! I inserted {columnNames} to columns {columnHeaders}.","MultipleCalculatedColumnsAddedToTableConfirmationMessage":"Done! I inserted {columnNames} to \'{tableName}\'.","MoreThanThreeColumnsAddedToTableConfirmationMessage":"Done! I inserted {columnLength} formula columns to the table.","And":"and","EnterDataShapingNoTableError":"Whoops! This feature only works on formatted tables. Please format your data as an Excel table and try again. (Hint: select the table and run CTRL+T)","EnterDataShapingGenericError":"Data Preparation in Excel isn\'t available. Try your request again later.","DataShapingGenericError":"I\'m having trouble working on prompts. If you want help with something other than preparing the data for analysis, exit the mode and continue.","DataShapingUnsupportedPromptError":"I can\'t generate a high-quality answer for this prompt. Stop preparing the data and use another prompt.","DataShapingSuggestEnterModeHeaderText":"I can prepare the data for you, so it\'s easier to perform analysis and get accurate results.","DataShapingSuggestEnterModeText1":"Here\'s what I\'ll do:","DataShapingSuggestEnterModeTextBullet1":"Show a preview of the changes to apply","DataShapingSuggestEnterModeTextBullet2":"Apply the changes you want in the current sheet or a new one","DataShapingSuggestEnterModeText3":"Stop preparing the data if you\'d like help with other tasks.","DataShapingEnterModeButton":"Start preparing data","DataShapingLoadingStartDataShapingMode":"Entering data preparation.. ","DataShapingPostEnterModeText1":"Before you start analyzing data in this workbook, I can help identify ways to prepare your data for the most accurate answers.","DataShapingPostEnterModeText2":"Describe what you\'d like help with.","LoadingUIApplyDataShapingStep":"Working on it...","LoadingUIApplyDataShapingStep2":"Reviewing the data...","LoadingUIApplyDataShapingStep3":"Preparing the data...","LoadingUIApplyDataShapingStep4":"Almost there...","DataShapingDone":"Done! {0}","DataShapingApplyOrExit":"Apply changes and stop preparing","DataShapingApplyToExistingTable":"Replace original table","DataShapingApplyToNewSheet":"Apply to new sheet","DataShapingDiscardChanges":"Discard Changes ","LoadingUIExitDataShapingMode":"Stopping data preparation...","DataShapingDiscardChangesDone":"OK, I stopped preparing the data","DataShapingApplyToExistingTableDone":"Ok, I replaced the original table","DataShapingApplyToNewSheetDone":"OK, I applied it to a new sheet","ExplainInsights":"Explain insights","ExplainFormula":"Explain formula","ExplainFormulas":"Explain formulas","ExplainCode":"Explain code","NoInsightsMessage":"I didn\'t find any relevant insights in your data. Try adding more data or use another data set.","NoAnalyzeDataMessage":"I don\'t have a helpful answer. Try another prompt.","AnalyzePotentialBiasMessage":"I\'m not able to work on that. However, I can try getting other insights for you.","AddMoreInfoMessage":"The more I know, the better I can answer. Try adding more information.","AnalyzeNotSupportedMessage":"I can\'t do that just yet. What else would you like me to do?","AnalyzeDataGenericError":"I\'m having trouble right now. Try inserting the content later.","AnalyzeDataGenericError2":"I\'m having trouble working on prompts right now. Try sending your prompt later.","AccessDeniedMessage":"Looks like this is a password-protected sheet. I\'m unable to insert this suggestion. Unprotect this sheet for a moment and try again.","CellEditingMessage":"I can\'t insert a suggestion while you\'re editing. Try again when you finish.","ChatPlaceholderMessageV2":"Ask a question, or tell me how I can help","ChatPlaceholderMessageSearch":"Search for content, ask a question, or tell me how I can help","ChatPlaceholderMessageRange":"Ask a question, or tell me what you\'d like to do with {0}","ChatPlaceholderMessageSearchWithRange":"Search for content, ask a question, or tell me what you\'d like to do with {0}","ChatPlaceholderMessageInputV2NoGrounding":"Ask questions and work with this workbook","ChatPlaceholderMessageInputV2Enterprise":"Ask questions regarding people and files across your organization","ChatPlaceholderMessageAnalyzeData":"Describe what you want to know about the data","ChatPlaceholderMessageFormatTable":"Describe the changes you want to make to the table","ChatPlaceholderMessageFormulaColumn":"Describe the formula column you want to add","ChatRestShyPlaceholderMessage":"Ask a question","ChatRestShyPlaceholderMessageRange":"Ask a question about {0}","LoadingUIWorkingOnItStep":"Working on it...","LoadingUiUnderstandingDataStep":"Understanding your data...","LoadingUIAlmostThereStep":"Almost there...","LoadingUILookingAtDataRangeStep":"Looking at data range {0}...","LoadingUILookingAtDataRangeStepWithSheet":"Looking at data range {range} on \'{sheet}\'...","LoadingUILookingAtDataRangeStepWithNamedSheet":"Looking at data range {range} on the \'{sheet}\' sheet...","LoadingUIAddingColumnStep":"Adding column...","LoadingUIAddingColumnsStep":"Adding columns...","LoadingUIInsertingContentStep":"Inserting content...","LoadingUIAnalyzingDataStep":"Analyzing your data...","LoadingUIAnalyzingDataTLRStep":"Analyzing {0}...","LoadingUIAnalyzingDataTLRStepWithSheet":"Analyzing {range} on \'{sheet}\'...","LoadingUIAnalyzingDataTLRStepWithNamedSheet":"Analyzing {range} on the \'{sheet}\' sheet...","LoadingUIFinishingUpStep":"Finishing up...","LoadingUIMakingChangesStep":"Making changes to your table...","LoadingUIMakingChangesChartStep":"Making changes to your chart...","LoadingUIMakingChangesTLRStep":"Making changes to {0}...","LoadingUIMakingChangesTLRStepWithSheet":"Making changes to {range} on \'{sheet}\'...","LoadingUIMakingChangesTLRStepWithNamedSheet":"Making changes to {range} on the \'{sheet}\' sheet...","LoadingUIGeneratingFormulaColumnSuggestionsStep":"Generating formula column suggestions...","LoadingUIGeneratingFormulaColumnSuggestionsTLRStep":"Generating formula column suggestions for {0}...","LoadingUIGeneratingFormulaColumnSuggestionsTLRStepWithSheet":"Generating formula column suggestions for {range} on \'{sheet}\'...","LoadingUIGeneratingFormulaColumnSuggestionsTLRStepWithNamedSheet":"Generating formula column suggestions for {range} on the \'{sheet}\' sheet...","LoadingUIMakingChangesStepTableOfficeJSLikeRange":"Making changes to your workbook...","RecommendationAddToNewSheet":"Add to a new sheet","RecommendationAddToSheet":"Add to sheet","RecommendationInsertColumn":"Insert column","RecommendationInsertMultipleColumns":"Insert columns","RecommendationSuggestionHeader":"Here\'s 1 formula column to review and insert:","RecommendationSuggestionHeaderGrounded":"Here\'s 1 formula column to review and insert into {range}:","RecommendationSuggestionHeaderGroundedWithSheet":"Here\'s 1 formula column to review and insert into {range} on \'{sheet}\':","RecommendationSuggestionHeaderGroundedWithNamedSheet":"Here\'s 1 formula column to review and insert into {range} on the \'{sheet}\' sheet:","RecommendationFormulaSuggestionHeaderGrounded":"Here\'s 1 formula to review and insert into {range}:","RecommendationFormulaSuggestionHeaderGroundedWithSheet":"Here\'s 1 formula to review and insert into {range} on \'{sheet}\':","RecommendationFormulaSuggestionHeaderGroundedWithNamedSheet":"Here\'s 1 formula to review and insert into {range} on the \'{sheet}\' sheet:","RecommendationSuggestionMultipleColumnsHeader":"Here are {columnLength} formula columns to review and insert:","RecommendationSuggestionMultipleColumnsHeaderGrounded":"Here are {columnLength} formula columns to review and insert into {range}:","RecommendationSuggestionMultipleColumnsHeaderGroundedWithSheet":"Here are {columnLength} formula columns to review and insert into {range} on \'{sheet}\':","RecommendationSuggestionMultipleColumnsHeaderGroundedWithNamedSheet":"Here are {columnLength} formula columns to review and insert into {range} on the \'{sheet}\' sheet:","RecommendationAnotherSuggestionHeader":"Here\'s another suggestion for you:","RecommendationAnotherSuggestionMultipleColumnsHeader":"Here are another {columnLength} suggestions for you:","FormulaSuggestion_Header_Singular":"Looking at {tableRange}, here\'s 1 formula column to review and insert in {location}:","FormulaSuggestion_Header_SingularWithSheet":"Looking at {tableRange} on \'{sheet}\', here\'s 1 formula column to review and insert in {location}:","FormulaSuggestion_Header_SingularWithNamedSheet":"Looking at {tableRange} on the \'{sheet}\' sheet, here\'s 1 formula column to review and insert in {location}:","FormulaSuggestion_Header_Plural":"Looking at {tableRange}, here are {columnLength} formula columns to review and insert in {location}:","FormulaSuggestion_Header_PluralWithSheet":"Looking at {tableRange} on \'{sheet}\', here are {columnLength} formula columns to review and insert in {location}:","FormulaSuggestion_Header_PluralWithNamedSheet":"Looking at {tableRange} on the \'{sheet}\' sheet, here are {columnLength} formula columns to review and insert in {location}:","FormulaSuggestion_Header_Singular_Location":"Column {columnLetter}","FormulaSuggestion_Header_Plural_Location":"Columns {columnLetters}","FormulaSuggestion_FormulaSnippet_AriaLabel":"Formula snippet","JunkPhrase1":"hey","JunkPhrase2":"hi","JunkPhrase3":"whats happening","JunkPhrase4":"hey there","JunkPhrase5":"whats up","JunkPhrase6":"who are you","JunkPhrase7":"heyo","JunkPhrase8":"whats going on","JunkPhrase9":"what up","JunkPhrase10":"hi there","JunkPhrase11":"how are you","JunkPhrase12":"good morning","JunkPhrase13":"good afternoon","JunkPhrase14":"good evening","JunkPhrase15":"whats your name","JunkPhrase16":"where are you from","JunkPhrase17":"where do you live","JunkPhrase18":"who made you","JunkPhrase19":"what is this","JunkPhrase20":"what do you do","JunkPhrase21":"what does this do","OptOutMessageTitle":"Thanks for giving me a try!","OptOutMessageSubTitle":"I know it\'s not you, it\'s me. But if you want me back, click the Ribbon Display Options down arrow and choose Beta","OptOutPhrase1":"quit","OptOutPhrase2":"return","OptOutPhrase3":"stop","OptOutPhrase4":"leave","OptOutPhrase5":"i dont like this","OptOutPhrase6":"i dont want this","OptOutPhrase7":"i hate this","OptOutPhrase8":"i dont want to use this","OptOutPhrase9":"i want the ribbon","OptOutPhrase10":"i want the regular Excel","OptOutPhrase11":"i want the old Excel","OptOutPhrase12":"old toolbar","OptOutPhrase13":"classic toolbar","OptOutPhrase14":"opt out","OptOutPhrase15":"goodbye","OptOutPhrase16":"bye","OptOutPhrase17":"leave me alone","OptOutPhrase18":"this sucks","OptOutPhrase19":"exit","OptOutPhrase20":"exit out","OptOutPhrase21":"leave beta","OptOutPhrase22":"leave experiment","OptOutPhrase23":"i want to quit","OptOutPhrase24":"i want to leave","OptOutPhrase25":"i want to opt out","OptOutPhrase26":"i want to exit","OptOutPhrase27":"i want to exit out","OptOutPhrase28":"i want to stop","OptOutPhrase29":"take me back","OptOutPhrase30":"take me back to old toolbar","OptOutPhrase31":"take me back to classic toolbar","OptOutPhrase32":"take me back to regular excel","OptOutPhrase33":"take me back to old excel","OptOutPhrase34":"old excel","OptOutPhrase35":"regular excel","HelpQueryPhrase1":"what can i say","HelpQueryPhrase2":"what else","HelpQueryPhrase3":"what else can i say","HelpQueryPhrase4":"what do i do","HelpQueryPhrase5":"what do i say","HelpQueryPhrase6":"what do i type","HelpQueryPhrase7":"commands","HelpQueryPhrase8":"show commands","HelpQueryPhrase9":"show me","HelpQueryPhrase10":"show me how to use","HelpQueryPhrase11":"tell me how to use","HelpQueryPhrase12":"tell me","HelpQueryPhrase13":"search","HelpQueryPhrase14":"help","HelpQueryPhrase15":"help me","HelpQueryPhrase16":"help me use","HelpQueryPhrase17":"how","HelpQueryPhrase18":"how do i","HelpQueryPhrase19":"how do i use","HelpQueryPhrase20":"how do I use this","HelpQueryPhrase21":"how does this work","HelpQueryPhrase22":"im confused","HelpQueryPhrase23":"what works","HelpQueryPhrase24":"what can you do","UnsupportedQueryUndoPhrase1":"undo","UnsupportedQueryUndoPhrase2":"cancel","UnsupportedQueryUndoPhrase3":"revert","UnsupportedQueryUndoPhrase4":"that\'s wrong","UnsupportedQueryUndoPhrase5":"that\'s not what I wanted","UnsupportedQueryAltTextPhrase1":"alt text","UnsupportedQueryAltTextPhrase2":"alternative text","UnsupportedQueryAltTextPhrase3":"accessible text","UnsupportedQueryAltTextPhrase4":"accessibility text","UnsupportedQueryAddCommentPhrase1":"add a comment","UnsupportedQueryAddCommentPhrase2":"add comment","UnsupportedQueryAddCommentPhrase3":"comment","UnsupportedQueryDataValidationPhrase1":"validate data","UnsupportedQueryDataValidationPhrase2":"restrict input","UnsupportedQueryDataValidationPhrase3":"add a drop down","UnsupportedQueryWorksheetPhrase1":"add a sheet","UnsupportedQueryWorksheetPhrase2":"rename the sheet","UnsupportedQueryWorksheetPhrase3":"delete the sheet","UnsupportedQueryFreezePanePhrase1":"freeze","UnsupportedQueryFreezePanePhrase2":"lock","PromptMenuSectionTable":"Work with my table","PromptMenuItemAddFormulaColumn":"Add a formula column","PromptMenuItemHighlightData":"Highlight data","PromptMenuItemAnalyzeData":"Analyze this data","PromptMenuItemSortFilter":"Sort and filter data","PromptMenuItemAnalyzeUsingPython":"Python","PromptMenuItemHowCanCopilotHelp":"How can Copilot help?","LearnMoreResponsePrefix":"I can make calculations and help you understand more about your data by working with tables to:","LearnMoreResponseLinkText":"Learn more about Copilot","LearnMoreResponseContentFirst":"Add columns that include formulas for calculating and manipulating data","LearnMoreResponseContentSecond":"Sort, filter, and apply formatting to your table to organize and highlight data","LearnMoreResponseContentThird":"Find insights like trends, summaries, and comparisons","SuggestionPillAnotherColumnSuggestion":"Give me another column suggestion","SuggestionPillCreateColumn":"Create a \'{0}\' column","SuggestionPillPromptBasedAnotherSuggestion":"Give me another suggestion based on my prompt","SuggestionPillSeeInsight":"Can I see another insight?","SuggestionPillAddInsights":"Add all insights to grid","SuggestionPillOutliers":"Are there any outliers in my data?","SuggestionPillCompareColumns":"Add a column to compare \'{0}\' and \'{1}\'","SuggestionPillBoldColumn":"Bold the first column","SuggestionPillHowMany":"How many \'{0}\' of \'{DataFromColCell-0}\'?","SuggestionPillCombineColumns":"Add a column that combines \'{0}\' and \'{1}\'","SuggestionPillHighlightHighest":"Highlight the highest values in \'{0}\'","SuggestionPillShowItems":"Show items with \'{0}\' of \'{DataFromColCell-0}\'","SuggestionPillBold":"Bold the top 10 values in \'{0}\'","SuggestionPillSortColumn":"Sort \'{0}\' from smallest to largest","SuggestionPillInsights":"Give me insights on my data","SuggestionPillUpdatedInsights":"Give me updated insights on my data","SuggestionPillInsights2":"Show data insights","SuggestionPillUpdatedInsights2":"Show updated data insights","SuggestionPillShowPivotTables":"Show PivotTables","SuggestionPillAnotherPivotTable":"Can I see another PivotTable?","SuggestionPillShowCharts":"Show charts","SuggestionPillAnotherChart":"Can I see another chart?","SuggestionPillHighlightFilterSort":"How can I highlight, filter, and sort data?","HintCardAnalyzeDataSuggestionHeader":"Find trends, summaries, and insights","HintCardAnalyzeDataSuggestionMessage1":"For example, \\"Plot sales by category over time\\"","HintCardAnalyzeDataSuggestionMessage2":"For example, \\"Show total sales for each product\\"","HintCardAnalyzeDataSuggestionMessage3":"For example, \\"Plot the total units sold by category over time\\"","HintCardAnalyzeDataSuggestionMessage4":"For example, \\"Identify the highest month for sales in 2022\\"","HintCardAnalyzeDataSuggestionMessage5":"For example, \\"Identify the lowest price for each product in 2022\\"","HintCardMoonshotSuggestionHeader":"Quickly get new data using formulas","HintCardMoonshotSuggestionMessage1":"For example, \\"Add a column that calculates profit per marketing campaign\\"","HintCardMoonshotSuggestionMessage2":"For example, \\"Add a column that calculates the number of days after the product launch\\"","HintCardMoonshotSuggestionMessage3":"For example, \\"Add a column that tells me which reviewers left notes\\"","HintCardMoonshotSuggestionMessage4":"For example, \\"Add a column that calculates the ratio of the park boundary area to the total area of each park\\"","HintCardFormatDataSuggestionHeader":"Change the data\'s format and view","HintCardFormatDataSuggestionMessage1":"For example, \\"Bold the top 10 values in the Sales column\\"","HintCardFormatDataSuggestionMessage2":"For example, \\"Highlight the highest values in Units Sold\\"","HintCardFormatDataSuggestionMessage3":"For example, \\"Hide rows that are past due\\"","HintCardFormatDataSuggestionMessage5":"For example, \\"Filter to only show products made in Canada\\"","StopGeneratingResponseTableExplain":"OK, I stopped working on your question. If you want to analyze, I only work with data in a table or range with a single header row with different column names, no empty rows or columns, consistent data formatting per column, and no subtotals.\\n\\nTry selecting data that meets the criteria or is formatted as a table (go to Insert in the ribbon, and then select Table).","FluxWorkflowCancelledMessage":"My query was cancelled.","FluxWorkflowSucceededMessage":"I succeeded in my task.","FluxWorkflowFailedMessage":"I failed in my task.","FluxWorkflowColumnRecommendation":"I suggested adding a column named {0} that uses the formula, {1}, to calculate the results.","AnalyzeDataResponseTextInsights":"Here\'s a {0} that shows an insight about your data.","AnalyzeDataResponseTextSpecificAnswer":"Here\'s a {0} based on your prompt.","AnalyzeDataResponseTextNotFullyUnderstood":"This {0} may include some of the information you\'re looking for. If it doesn\'t show everything you requested, try another prompt.","AnalyzeDataResponseTextNotFullyUnderstoodEmptyAnswer":"I looked through your data for this criteria: {0}. There were no matches. If you want to try again, use another prompt.","AnalyzeDataResponseTextEmptyAnswer":"I looked through your data for this criteria: {0}. There are no matches.","CardTypeChart":"chart","CardTypePivotChart":"PivotChart","CardTypePivotTable":"PivotTable","CardTypeFormula":"formula","MapChartType":"a Map Chart","ScatterChartType":"a Scatter Chart","ClusteredComboChartType":"a Clustered Combo Chart","StackedComboChartType":"a Stacked Combo Chart","HundredPercentComboChartType":"a Hundred Percent Combo Chart","FunnelChartType":"a Funnel Chart","TreemapChartType":"a Treemap Chart","SunburstChartType":"a Sunburst Chart","ColorFilledMapChartType":"a Color Filled Map Chart","CircularTreemapChartType":"a Circular Treemap Chart","HeatMapChartType":"a Heat Map Chart","WaterfallChartType":"a Waterfall Chart","RoseChartType":"a Rose Chart","NetworkMapChartType":"a Network Map Chart","SmoothLineChartType":"a Smooth Line Chart","ComboChartType":"a Combo Chart","LineChartType":"a Line Chart","PieChartType":"a Pie Chart","DonutChartType":"a Donut Chart","AreaChartType":"an Area Chart","StackedAreaChartType":"a Stacked Area Chart","HundredPercentStackedAreaChartType":"a Hundred Percent Stacked Area Chart","ClusteredBarChartType":"a Clustered Bar Chart","StackedBarChartType":"a Stacked Bar Chart","HundredPercentStackedBarChartType":"a Hundred Percent Stacked Bar Chart","ClusteredColumnChartType":"a Clustered Column Chart","StackedColumnChartType":"a Stacked Column Chart","HundredPercentStackedColumnChartType":"a Hundred Percent Stacked Column Chart","UndefinedChartType":"that type of chart","SampleColumnHeaderCampaignOwner":"Campaign Owner","SampleColumnHeaderCampaignName":"Campaign Name","SampleColumnHeaderLaunchDate":"Launch Date","SampleColumnHeaderCampaignType":"Campaign Type","SampleColumnHeaderBudget":"Budget","SampleColumnHeaderRevenue":"Revenue","SampleColumnHeaderTotalUsersTargeted":"Total Users Targeted","SampleColumnHeaderEngagedUsers":"Engaged Users","SampleDataTextLateJanEmail":"Late Jan Email","SampleDataTextBillboardsSmall":"Billboards small","SampleDataTextBillboardsLarge":"Billboards large","SampleDataTextProductReview3x":"Product review 3x","SampleDataTextTargetedGroup1":"Targeted - Group 1","SampleDataTextIndustryConference":"Industry Conference","SampleDataTextTargetedGroup2":"Targeted - Group 2","SampleDataTextFebEmailNorth":"Feb email - North","SampleDataTextFebEmailSouth":"Feb email - South","SampleDataTextFebEmailWest":"Feb email - West","SampleDataTextProductMention5x":"Product mention 5x","SampleDataTextDigitalMarketing":"Digital marketing","SampleDataTextBrandMarketing":"Brand marketing","SampleDataTextCustomerExperience":"Customer Experience","TableSummaryGeneralNoResults":"Sorry, I can\'t summarize this table. Try again with some different data.","TableSummaryGeneralInsertFailed":"Sorry, I couldn\'t insert the comment.","TableSummaryInsertFailedProtectedSheet":"Looks like this is a password-protected sheet. I\'m unable to insert this comment. Unprotect this sheet for a moment and try again.","CalculatedColumnsFailureGeneral":"I\'m having trouble working on prompts right now. Try sending your prompt later.","CalculatedColumnsGeneralNoResults":"I can\'t generate any column suggestions right now. Try adding more columns or rows to the table.","CalculatedColumnsNLNoResults":"I need more information to start working on your request. Use these tips to write a new request:","CalculatedColumnsNLMultipleColumns":"I can only add one column at a time. Try again with a request about one column.","CalculatedColumnsNLNoResultSuggestionIdentifyColumnAndTable":"Mention specific columns or tables you want me to use.","CalculatedColumnsNLNoResultSuggestionIdentifyColumn":"Mention specific columns you want me to use.","CalculatedColumnsNLNoResultSuggestionCreateColumn":"State specific calculations you want me to do.","CalculatedColumnsTimeout":"Something went wrong. Try your formula column request again later.","CalculatedColumnsInsertFailedDeleteConflict":"I\'m working to insert the column, but it looks like there may be a PivotTable, an AutoFilter applied to a data range, or another Excel table in the way. Move any objects and try again.","CalculatedColumnsInsertFailedConflict":"I can\'t add the new column because there may be a PivotTable, an AutoFilter applied to a data range, or another Excel table in the way. Move any objects and try again.","CalculatedColumnsInsertFailedProtectedSheet":"Looks like this is a password-protected sheet. I\'m unable to insert any formula columns. Unprotect this sheet for a moment and try again.","CalculatedColumnsInsertFailedTableNotFound":"I can\'t insert any formula columns because it looks like no table is selected. Double check to make sure a table is selected and try again.","CalculatedColumnsInsertFailedGeneral":"I\'m having trouble inserting formula columns right now. Try sending your prompt later.","MultipleCalculatedColumnsInsertFailedConflict":"I\'m working to insert the columns, but it looks like there may be a PivotTable, an AutoFilter applied to a data range, or another Excel table in the way. Move any objects and try again.","MultipleCalculatedColumnsInsertFailedProtectedSheet":"Looks like this is a password-protected sheet. I\'m unable to insert these columns. Unprotect this sheet for a moment and try again.","MultipleCalculatedColumnsInsertFailedTableNotFound":"I couldn\'t insert the columns. Double check to make sure a table is selected.","MultipleCalculatedColumnsInsertFailedGeneral":"I couldn\'t insert the columns.","MultipleCalculatedColumnsInsertPartiallyFailedConflict":"I can\'t add some of the new columns because there may be a PivotTable, an AutoFilter applied to a data range, or another Excel table in the way. Move any objects and try again.","MultipleCalculatedColumnsInsertPartiallyFailedProtectedSheet":"Looks like this is a password-protected sheet. I\'m unable to insert some of these columns. Unprotect this sheet for a moment and try again.","MultipleCalculatedColumnsInsertPartiallyFailedTableNotFound":"I couldn\'t insert some of the columns. Double check to make sure a table is selected.","MultipleCalculatedColumnsInsertPartiallyFailedGeneral":"I couldn\'t insert some of the columns.","FormulaSuggestion_PreviewOnGridButton_ShowPreview":"Preview on grid","FormulaSuggestion_PreviewOnGridButton_HidePreview":"Hide from grid","FormulaSuggestion_Description_NotAvailable":"No description available.","FormulaSuggestion_Preview_NotAvailable":"No image available.","FormulaSuggestion_Preview_AriaLabel":"Table preview","CalculatedRowsInsertFailedDeleteConflict":"I\'m working to insert the row, but it looks like there may be a PivotTable, an AutoFilter applied to a data range, or another Excel table in the way. Move any objects and try again.","CalculatedRowsInsertFailedProtectedSheet":"Looks like this is a password-protected sheet. I\'m unable to insert any rows. Unprotect this sheet for a moment and try again.","CalculatedRowsInsertFailedTableNotFound":"I can\'t insert any formulas because it looks like no table is selected. Double check to make sure a table is selected and try again.","CalculatedRowsNLMultipleRows":"I can only add one formula per column at a time. Edit your prompt accordingly and try again.","CalculatedRowsNLMultipleFormulaTypes":"I can only add one formula type at a time. Try again with a request about one formula type.","CalculatedRowsTimeout":"Something went wrong. Try your request again later.","CalculatedRowsInsertFailedGeneral":"I\'m having trouble inserting rows right now. Try sending your prompt later.","CalculatedRowsConfirmationTextForCell":"Done! I inserted the formula.","CalculatedRowsConfirmationTextForRow":"Done! I inserted the formulas.","CalculatedRowsConfirmationTextForUpdateCell":"Done! I updated the formula.","CalculatedRowsConfirmationTextForUpdateRow":"Done! I updated the formulas.","CalculatedRowsConfirmationTextForCellWithAddress":"Done! I inserted the formula in {0}.","CalculatedRowsConfirmationTextForRowWithAddress":"Done! I inserted the formulas in {0}.","CalculatedRowsConfirmationTextForUpdateCellWithAddress":"Done! I updated the formula in {0}.","CalculatedRowsConfirmationTextForUpdateRowWithAddress":"Done! I updated the formulas in {0}.","LoadingUIAddingCellStep":"Inserting formula...","LoadingUIAddingCellsStep":"Inserting formulas...","LoadingUIAddingCellWithAddressStep":"Inserting formula in {0}...","LoadingUIAddingCellsWithAddressStep":"Inserting formulas in {0}...","LoadingUIAddingCellUpdateWithAddressStep":"Updating formula in {0}...","LoadingUIAddingCellsUpdateWithAddressStep":"Updating formulas in {0}...","LoadingUIGeneratingFormulaRowSuggestionsStep":"Generating formula suggestions...","LoadingUIGeneratingFormulaRowSuggestionsTLRStep":"Generating formula suggestions for {0}...","LoadingUIAddingCellWithAddressStepWithSheet":"Inserting formula in {range} on \'{sheet}\'...","LoadingUIAddingCellsWithAddressStepWithSheet":"Inserting formulas in {range} on \'{sheet}\'...","LoadingUIAddingCellUpdateWithAddressStepWithSheet":"Updating formula in {range} on \'{sheet}\'...","LoadingUIAddingCellsUpdateWithAddressStepWithSheet":"Updating formulas in {range} on \'{sheet}\'...","LoadingUIGeneratingFormulaRowSuggestionsTLRStepWithSheet":"Generating formula suggestions for {range} on \'{sheet}\'...","LoadingUIAddingCellWithAddressStepWithNamedSheet":"Inserting formula in {range} on the \'{sheet}\' sheet...","LoadingUIAddingCellsWithAddressStepWithNamedSheet":"Inserting formulas in {range} on the \'{sheet}\' sheet...","LoadingUIAddingCellUpdateWithAddressStepWithNamedSheet":"Updating formula in {range} on the \'{sheet}\' sheet...","LoadingUIAddingCellsUpdateWithAddressStepWithNamedSheet":"Updating formulas in {range} on the \'{sheet}\' sheet...","LoadingUIGeneratingFormulaRowSuggestionsTLRStepWithNamedSheet":"Generating formula suggestions for {range} on the \'{sheet}\' sheet...","CalculatedRowsShowMorePill":"Give me another row suggestion","CalculatedRowsInsertCellTitle":"Insert cell","CalculatedRowsInsertRowTitle":"Insert row","CalculatedRowsUpdateCellTitle":"Update cell","CalculatedRowsUpdateRowTitle":"Update row","CalculatedRowsFormulaSuggestionHeader":"Here\'s 1 formula to review and insert:","CalculatedRowsCellHeader":"cell {cellAddress}","CalculatedRowsSelectedCellHeader":"the selected cell","CalculatedRowsRowHeader":"row {rowNumber}","CalculatedRowsSelectedCellNothingSelected":"I\'m working to insert the formula, but it looks like no cell is selected. Select a cell and try again.","CalculatedRowsSelectedCellPivotTableSelected":"I\'m working to insert the formula, but it looks like there may be a PivotTable in the way. Select a different cell and try again.","CalculatedRowsFormulaSuggestionHeaderSingular":"Looking at {tableRange}, here\'s 1 formula to review and insert in {location}:","CalculatedRowsFormulaSuggestionHeaderSingularWithSheet":"Looking at {tableRange} on \'{sheet}\', here\'s 1 formula to review and insert in {location}:","CalculatedRowsFormulaSuggestionHeaderSingularWithNamedSheet":"Looking at {tableRange} on the \'{sheet}\' sheet, here\'s 1 formula to review and insert in {location}:","CalculatedRowsFormulaSuggestionHeaderPlural":"Looking at {tableRange}, here are {formulasLength} formulas to review and insert in {location}:","CalculatedRowsFormulaSuggestionHeaderPluralWithSheet":"Looking at {tableRange} on \'{sheet}\', here are {formulasLength} formulas to review and insert in {location}:","CalculatedRowsFormulaSuggestionHeaderPluralWithNamedSheet":"Looking at {tableRange} on the \'{sheet}\' sheet, here are {formulasLength} formulas to review and insert in {location}:","CalculatedRowsFormulaTotalHeader":"Total","CalculatedRowsFormulaSuggestionHeaderUpdateSingular":"Looking at {tableRange}, here\'s 1 formula to review and update in {location}:","CalculatedRowsFormulaSuggestionHeaderUpdateSingularWithSheet":"Looking at {tableRange} on \'{sheet}\', here\'s 1 formula to review and update in {location}:","CalculatedRowsFormulaSuggestionHeaderUpdateSingularWithNamedSheet":"Looking at {tableRange} on the \'{sheet}\' sheet\', here\'s 1 formula to review and update in {location}:","CalculatedRowsFormulaSuggestionHeaderUpdatePlural":"Looking at {tableRange}, here are {formulasLength} formulas to review and update in {location}:","CalculatedRowsFormulaSuggestionHeaderUpdatePluralWithSheet":"Looking at {tableRange} on \'{sheet}\', here are {formulasLength} formulas to review and update in {location}:","CalculatedRowsFormulaSuggestionHeaderUpdatePluralWithNamedSheet":"Looking at {tableRange} on the \'{sheet}\' sheet, here are {formulasLength} formulas to review and update in {location}:","FormulaExplanation_ShowExplanationButton":"Show explanation","FormulaExplanation_HideExplanationButton":"Hide explanation","CodeSnippetWithExplanation_ExplanationButton_Show":"Show explanation","CodeSnippetWithExplanation_ExplanationButton_Hide":"Hide explanation","CodeSnippetWithExplanation_ExplanationNotAvailable":"No explanation available","CodeSnippetWithExplanation_AriaLabel":"Code snippet","TableSummaryText":"Describe my data","CalculatedColumnsGeneral":"Show suggestions for formula columns","CalculatedColumnsGeneralSingular":"Show a suggestion for a formula column","AddAsCommentText":"Add as comment","UnsupportedOperationMessage":"I\'m not able to work on that. Try a new prompt or use a suggested one for ideas.","AugloopResponseTimeoutMessage":"Sorry, I\'m having some trouble right now. Try reopening the workbook and sending your prompt again later.","AugloopErrorOTE":"I\'m still working to support other languages. For now, please try your prompt again in English.","AugloopErrorUnsupportedLanguage":"I\'m still working to support this language. For now, please try your prompt again in English or another supported language.","ChatSuggestionHeader":"Here\'s what I can do with data selected in Excel tables:","ChatSuggestionAddColumns":"Add formula columns","ChatSuggestionHighlight":"Highlight","ChatSuggestionFilterAndSort":"Filter and sort","ChatSuggestionAnalyze":"Analyze","DialogSheetUnsupportedTitle":"This workbook has a dialog sheet","DialogSheetUnsupportedMessage":"I can\'t work on files that contain dialog sheets. If you delete the dialog sheet and reopen the workbook or open a workbook without a dialog sheet, I can help you explore your data.","FileLocationUnsupportedTitle":"Unsupported file location","FileLocationUnsupportedMessage":"I only work with files saved to OneDrive or Microsoft 365 SharePoint locations with AutoSave turned on. Save the file to a supported location to continue.","FileStateUnsupportedTitle":"Unsupported file state","FileStateUnsupportedMessage":"I do not currently support this type of workbook.","FileStateUnsupportedLearnMoreLinkText":"Learn more","ChatSuggestionFooterText":"Describe what you\'d like help with, or use one of the suggestions to get started.","DashboardSourceDataLabel":"PivotTable sources for charts","UndoScopeName":"Copilot Action","AugloopSessionClosedTitle":"Something went wrong","AugloopSessionClosedDesktopMessage":"Sorry, I\'m having some trouble right now. Restart Excel and try sending the prompt again.","AugloopSessionClosedWebMessage":"Sorry, I\'m having some trouble right now. Try refreshing the webpage.","ZeroQueryHeader":"Select an option to learn how I can work with your data in Excel tables:","ZeroQueryHeaderAsk":"Ask Copilot","ZeroQueryFormulaTitle":"Add formula columns","ZeroQueryFormulaMessage":"I can quickly add new columns with formulas. Select a suggested prompt, or describe what columns you\'d like to add.","ZeroQueryHighlightingTitle":"Highlight","ZeroQueryHighlightingMessage":"Need to highlight portions of data? I can help with that! Select a suggested prompt, or describe what you\'d like to highlight.","ZeroQuerySortFilterTitle":"Sort and filter","ZeroQueryFilterSortMessage":"I can sort and filter data to keep things organized. Select a suggested prompt, or describe what you\'d like to do.","ZeroQueAnalyzingTitle":"Analyze","ZeroQueAnalyzingMessage":"I can analyze data and show insights in charts and PivotTables. Select a suggested prompt, or describe what you\'d like to know.","ZeroQueryInsightsTitle":"Summarize using PivotTables or charts","ZeroQueryFormulaActionTitle":"Suggest a formula column","ZeroQueryHighlightActionTitle":"Highlight all cells with [incomplete in red]","ZeroQuerySearchTitle":"Create a table for my recent emails about [sales targets]","ZeroQueryHowToSumTitle":"How do I sum values based on [criteria]","ZeroQueryDataShapingText":"Prepare data for analysis","ZeroQueryDataShapingText2":"Prepare my data for analysis","ZeroQueryDataShapingText3":"Transform my data for analysis","ZeroQueryDataShapingText4":"Ready my data for analysis","ZeroQueryDataShapingText5":"Organize data for analysis","ZeroQueryDataShapingHeader":"Data Preparation","ZeroQuerySuggestAColumnTitle":"Suggest a column","ZeroQuerySuggestAColumnMessage":"Suggest a formula column for my data","ZeroQueryWriteAFormulaTitle":"Write a formula","ZeroQueryWriteAFormulaMessage":"Write a formula that...","ZeroQueryAddAFormulaColumnTitle":"Add a formula column","ZeroQueryAddAFormulaColumnMessage":"Add a column that...","ZeroQueryExplainAFormulaTitle":"Explain a formula","ZeroQueryExplainAFormulaMessage":"Explain this formula: [paste formula here]","ZeroQueryInvestigateErrorTitle":"Investigate error","ZeroQueryInvestigateErrorMessage":"Investigate formula error: [paste formula here]","ZeroQuerySplitColumnsTitle":"Split columns","ZeroQuerySplitColumnsMessage":"Write a formula that creates new columns by splitting [column A]","ZeroQueryCombineColumnsTitle":"Combine columns","ZeroQueryCombineColumnsMessage":"Combine [column A and B] with a space","ZeroQueryCreateTotalRowTitle":"Create a total row","ZeroQueryCreateTotalRowMessage":"Create a row that calculates column [averages]","ZeroQueryWriteLookupFormulaTitle":"Write a lookup formula","ZeroQueryWriteLookupFormulaMessage":"Write a formula that combines two tables together by matching [product ID]","ZeroQueryGetDataInsightsTitle":"Get data insights","ZeroQueryGetDataInsightsMessage":"Give a unique data insight using Python","ZeroQueryGetDataInsightsAnswersMessage":"Give a unique insight using Python","ZeroQueryAdvancedAnalysisTitle":"Advanced analysis","ZeroQueryAdvancedAnalysisMessage":"Get deeper analysis results using Python","ZeroQueryEditPythonCodeTitle":"Edit Python code","ZeroQueryEditPythonCodeMessage":"Edit this Python code","ZeroQueryPerformForecastingTitle":"Perform forecasting","ZeroQueryPerformForecastingMessage":"Perform forecasting using Python","ZeroQueryCreateBoxplotTitle":"Create a boxplot","ZeroQueryCreateBoxplotMessage":"Create a boxplot of this data using Python","ZeroQuerySetOfChartsTitle":"Set of charts","ZeroQuerySetOfChartsMessage":"Create a set of charts using Python","ZeroQueryGenerateWordCloudTitle":"Generate a word cloud","ZeroQueryGenerateWordCloudMessage":"Generate a word cloud using Python","ZeroQueryCreateATableTitle":"Create a table","ZeroQueryCreateATableMessage":"Create a table comparing planets","ZeroQueryKeyboardShortcutsTitle":"Keyboard shortcuts","ZeroQueryKeyboardShortcutsMessage":"What are 15 intermediate level shortcuts?","ZeroQueryTipsAndTricksTitle":"Tips and tricks","ZeroQueryTipsAndTricksMessage":"What are some tricks for working with dates?","ZeroQueryFreezeColumnTitle":"Freeze column","ZeroQueryFreezeColumnMessage":"How do I freeze one column while scrolling?","ZeroQueryHowDoITitle":"How do I?","ZeroQueryHowDoIUnpivotMessage":"How do I unpivot a table?","ZeroQueryHowDoIDropdownMessage":"How do I create a dropdown menu?","ZeroQueryHowDoIFormulaMessage":"How do I write a formula that [forecasts sales]","ZeroQuerySummarizeColumnTitle":"Summarize column","ZeroQuerySummarizeColumnMessage":"Summarize [column A] in bullet points","ZeroQueryShowDataInsightsTitle":"Show data insights","ZeroQueryShowDataInsightsMessage":"Show a data insight","ZeroQuerySumByCategoryTitle":"Sum by category","ZeroQuerySumByCategoryMessage":"Sum [total revenue] for each [category]","ZeroQueryCreatePivotTableTitle":"Create a PivotTable","ZeroQueryCreatePivotTableMessage":"Create a PivotTable grouped by [category]","ZeroQueryCreatePieChartTitle":"Create a pie chart","ZeroQueryCreatePieChartMessage":"Create a pie chart for my data","ZeroQueryGenerateAGraphTitle":"Generate a graph","ZeroQueryGenerateAGraphMessage":"Generate a graph of [x against y]","ZeroQueryHighlightDuplicatesTitle":"Highlight duplicates in a column","ZeroQueryHighlightDuplicatesMessage":"Highlight duplicates in [column A]","ZeroQueryHighlightCellsTitle":"Highlight cells in the table","ZeroQueryHighlightCellsMessage":"Highlight cells in the table that are [complete]","ZeroQueryApplyColorCodingTitle":"Add a color scale to a column","ZeroQueryApplyColorCodingMessage":"Add a color scale to [column A]","ZeroQueryWebSearchCreateTableTitle":"Find financial data","ZeroQueryWebSearchCreateTableMessage":"Search the web for the top 10 stocks in the S&P 500 and their current market cap in a table format.","ZeroQueryWebSearchTravelTitle":"Create a travel itinerary","ZeroQueryWebSearchTravelMessage":"Search the web for an itinerary for a month trip to Europe in a table format","ZeroQueryWebSearchLearnTitle":"Learn in table form","ZeroQueryWebSearchLearnMessage":"Search the web for a list of 15 intermediate level vocabulary words in Spanish and their translations","ZeroQueryImportTableTitle":"Import table from file","ZeroQueryImportTableMessage":"Import the table from /[file]","ZeroQueryPrepareForMeetingsTitle":"Prepare for my meetings","ZeroQueryPrepareForMeetingsMessage":"Show me next week\'s meetings and to-do items in a table format","ZeroQueryRecapEmailsTitle":"Recap emails","ZeroQueryRecapEmailsMessage":"List yesterday\'s emails in a table, with sender, subject and importance","FluxWorkflowColumnRecommendationPrefix":"I suggested adding a column named {0} that uses the formula,","FluxWorkflowColumnRecommendationSuffix":", to calculate the results.","FluxWorkflowColumnsRecommendation":"I suggested adding the column named {columnName}, that uses the formula {formula}, to the column location {columnLocation} to calculate the results.","FluxWorkflowColumnsNoLocationsRecommendation":"I suggested adding the column named {columnName}, that uses the formula {formula}, to calculate the results.","FluxWorkflowMultipleColumnsRecommendation":"I suggested adding the columns named {columnNames}, that use the formulas {formulas}, to the column locations {columnLocations} to calculate the results.","FluxWorkflowMultipleColumnsNoLocationsRecommendation":"I suggested adding the columns named {columnNames}, that use the formulas {formulas}, to calculate the results.","ErrorScreenHeader":"We ran into an error.","ErrorScreenInstruction":"Please reopen the Copilot pane to try again.","ErrorScreenReopenButton":"Reopen","CommandingUndoWarningSuffix":"Do you want me to continue?","CommandingUndoWarningActionListHeader":"I am about to perform the following actions that cannot be undone by clicking \\"Undo\\":","CommandingUndoWarningConfirm":"Yes","CommandingUndoWarningReject":"No","CommandingExplanationPrefix":"Done! These are the steps I took:","OfficeJSResponseExplain":"Explain Result","OfficeJSErrorExplanationPrefix":"I couldn\'t complete that task, but here\'s what I tried to do:","OfficeJSExplanationPrefix":"I took the following actions to create the result:","OfficeJSSimpleSuccessResponse":"Done! What else can I help you with?","CopilotLicenseHelpPrefix":"We encountered a problem validating your Copilot license. For more information, see ","CopilotLicenseHelpHeader":"Validate your Copilot License","OfficeScriptRunScriptSuccessPrefix":"I\'ve successfully run \'{0}\' which performed the following steps:","OfficeScriptRunScriptFailPrefix":"I wasn\'t able to successfully run script \'{0}\'.","OfficeScriptSaveScriptSuccessPrefix":"Done! I just saved a script that does the following:","OfficeScriptSaveScriptFailPrefix":"Something went wrong while saving your script.","PromptGuideMenuTitle":"Prompts","PromptGuideMenuSelectionCreate":"Create formulas","PromptGuideMenuSelectionUnderstand":"Understand","PromptGuideMenuSelectionEdit":"Apply color and formatting","OfficeScriptSaveScriptFailPrefixAsk":"Ask","PromptGuideViewMorePrompts":"View more prompts","PromptGuideMenuSectionItemGenerateFormulaColumnSuggestion":"Generate a formula column suggestion","PromptGuideMenuSectionItemAddAColumnThatCombines":"Add a column that combines [the customer\'s first and last name]","PromptGuideMenuSectionItemAddAColumnToExtract":"Add a column to extract [the month from the date]","PromptGuideMenuSectionItemAddAColumnThatCalculates":"Add a column that calculates [the profit per order]","PromptGuideMenuSectionItemShowDataInsights":"Show insights about the data","PromptGuideMenuSectionItemPercentageCalculation":"What is the percentage of [total revenue from each region?]","PromptGuideMenuSectionItemHowManyDifferent":"How many different [teams are represented in this table]","PromptGuideMenuSectionItemWhichItems":"Which items [have the most remaining inventory?]","PromptGuideMenuSectionItemHighlight":"Highlight the [lowest 5 budgets]","PromptGuideMenuSectionItemSort":"Sort [engaged users from smallest to largest]","PromptGuideMenuSectionItemFilter":"Filter by [items from this month]","PromptGuideMenuSectionItemApplyRYG":"Apply a red-yellow-green color scale to [the \'Total\' column]","PromptGuideMenuSectionItemHelp":"How can Copilot help?","MicrophonePermissionErrorTitleWeb":"No Microphone Permission","MicrophonePermissionErrorTextWeb":"Copilot can\'t access your microphone. Click the lock icon in the browser address bar above, set your permissions to allow microphone access, and then try again.","MicrophonePermissionErrorTitleWin32":"Oops, unable to capture your audio","MicrophonePermissionErrorTextWin32":"There is a problem with your microphone. Please check your microphone permission settings.","CommandingFinishedResponseHeader":"Done! I made the following changes:","CommandingHumanInTheLoopApplyingChangesMessage":"Applying changes in {range}...","CommandingHumanInTheLoopApplyingChangesMessageWithSheet":"Applying changes in {range} on \'{sheet}\'...","CommandingHumanInTheLoopApplyingChangesMessageWithNamedSheet":"Applying changes in {range} on the \'{sheet}\' sheet...","CommandingHumanInTheLoopSingleChangeResponseMessage":"Done! I made the change in {0}.","CommandingHumanInTheLoopSingleChangeResponseMessageWithSheet":"Done! I made the change in {range} on \'{sheet}\'.","CommandingHumanInTheLoopSingleChangeResponseMessageWithNamedSheet":"Done! I made the change in {range} on the \'{sheet}\' sheet.","CommandingHumanInTheLoopMultipleChangesResponseMessage":"Done! I made the changes in {0}.","CommandingHumanInTheLoopMultipleChangesResponseMessageWithSheet":"Done! I made the changes in {range} on \'{sheet}\'.","CommandingHumanInTheLoopMultipleChangesResponseMessageWithNamedSheet":"Done! I made the changes in {range} on the \'{sheet}\' sheet.","CommandingHumanInTheLoopSingleChangeNoRangeResponseMessage":"Done! I made the change.","CommandingHumanInTheLoopMultipleChangesNoRangeResponseMessage":"Done! I made the changes.","CommandingHumanInTheLoopSingleEventHeader":"Sure! Looking at {0}, here’s 1 change to review and apply:","CommandingHumanInTheLoopMultipleEventsHeader":"OK! Looking at {0}, here are {1} changes to review and apply:","CommandingHumanInTheLoopSingleCFEventHeader":"Sure! Looking at {0}, here\'s 1 conditional formatting rule to review and apply:","CommandingHumanInTheLoopMultipleCFEventsHeader":"OK! Looking at {0}, here are {1} conditional formatting rules to review and apply:","CommandingHumanInTheLoopSingleEventHeaderWithSheet":"Sure! Looking at {range} on \'{sheet}\', here’s 1 change to review and apply:","CommandingHumanInTheLoopMultipleEventsHeaderWithSheet":"OK! Looking at {range} on \'{sheet}\', here are {numChanges} changes to review and apply:","CommandingHumanInTheLoopSingleCFEventHeaderWithSheet":"Sure! Looking at {range} on \'{sheet}\', here\'s 1 conditional formatting rule to review and apply:","CommandingHumanInTheLoopMultipleCFEventsHeaderWithSheet":"OK! Looking at {range} on \'{sheet}\', here are {numChanges} conditional formatting rules to review and apply:","CommandingHumanInTheLoopSingleEventHeaderWithNamedSheet":"Sure! Looking at {range} on the \'{sheet}\' sheet, here’s 1 change to review and apply:","CommandingHumanInTheLoopMultipleEventsHeaderWithNamedSheet":"OK! Looking at {range} on the \'{sheet}\' sheet, here are {numChanges} changes to review and apply:","CommandingHumanInTheLoopSingleCFEventHeaderWithNamedSheet":"Sure! Looking at {range} on the \'{sheet}\' sheet, here\'s 1 conditional formatting rule to review and apply:","CommandingHumanInTheLoopMultipleCFEventsHeaderWithNamedSheet":"OK! Looking at {range} on the \'{sheet}\' sheet, here are {numChanges} conditional formatting rules to review and apply:","AnalyzeDataTooLargeError":"This table has over two million cells of data, which is too large for me to analyze. Select a table with less data and try again.","AnalyzeDataTooLargeErrorFourMillion":"This table has over four million cells of data, which is too large for me to analyze. Select a table with less data and try again.","AnalyzeDataCardHeader":"I analyzed data in {0}, and here\'s what I found:","AnalyzeDataCardHeaderWithSheet":"I analyzed data in {range} on \'{sheet}\', and here\'s what I found:","AnalyzeDataCardHeaderWithNamedSheet":"I analyzed data in {range} on the \'{sheet}\' sheet, and here\'s what I found:","GroundingSourcePrefix":"Using ","GroundingWithDocument":"This workbook","GroundingWithDocumentLabel":"Using this workbook","GroundingWithDocumentDescription":"Ask questions and work with data in a table","GroundingWithEnterpriseData":"Your organization\'s data","GroundingWithEnterpriseDataLabel":"Using your organization\'s data","GroundingWithEnterpriseDataDescription":"Ask questions regarding people and files across your organization","GroundingWithEnterpriseDataDescriptionV2":"Unrelated to working with data in a table, ask questions regarding people and files across your organization.","GroundingSourceInformationTooltip":"In addition to answering general questions, Copilot can respond to requests that pertain either to this workbook or to organizational data, such as files and people\'s contact info.","GroundingSourceInformationTooltipV2":"For general questions and working on your content, use \\"this workbook\\". For questions that pertain to your organization, not related to creating or editing content, use \\"your organization\'s data\\".","GroundingDocToWorkModeSwitchMessage":"I\'m using your organization\'s data to respond to you. Ask me questions regarding people and files across your organization. Note that I won\'t be able to work with your content while I\'m in this mode.","GroundingWorkToDocModeSwitchMessage":"I\'m using this workbook and general knowledge to respond to you. Ask me questions and make requests for working with your data.","PythonInsertCodeActiveSheetButtonText":"Insert","PythonInsertAllCodeActiveSheetButtonText":"Insert all","PythonInsertCodeNewSheetButtonText":"Insert in new sheet","PythonInsertProtectedSheetErrorText":"Looks like this is a password-protected sheet and Python in Excel can\'t automatically insert code into the sheet. Remove the password and try again, but we recommend adding the password back to keep this sheet protected when you\'re done.","PythonInsertProtectedSheetInstructionText":"{0} Unprotect this sheet and try inserting the code again.","PythonLicensingErrorText":"You need to have an active license to use Python in Excel.","PythonPlatformErrorText":"Sorry, Python isn’t supported on this platform. Use another platform and try again.","PythonSelectedTableErrorResponseText":"Sorry, I cannot do that. Please select a table you want to work with.","PythonCodeCardBodyText":"Here\'s the Python code you can use:","PythonDataFrameSnippetBodyText":"First, create a DataFrame with your data.","PythonCodeSnippetBodyText":"Then, use this code.","PythonDataFrameCopySuccessText":"Copied! Paste the code in any cell to create a DataFrame.","PythonCodeInsertNewSheetSuccessText":"Done! The code was inserted in a new sheet.","PythonDataFrameAndCodeInsertNewSheetSuccessText":"Done! The DateFrame and code was inserted in a new sheet.","PythonDataFrameAndCodeInsertSameSheetSuccessText":"Done! The DataFrame and code were inserted.","PythonCodeInsertSameSheetSuccessText":"Done! The code was inserted.","PythonCodeCopySuccessText":"Copied! Paste the code in any cell below the selected Python cell.","PythonDataFrameCodeExplanationText":"We create a DataFrame in a variable referencing the Excel table using the xl() function.","PythonGenericErrorText":"Sorry, I\'m having trouble working on this request. Try a new prompt or view the suggested ones for ideas.","PythonDataFrameCodeComment":"Import data into a DataFrame","PythonRestartRuntimeErrorText":"The Python runtime is having issues. In order for me to continue working on your question, go to **Formulas** in the ribbon, and then select **Reset runtime**.","PythonRestartRuntimeFormulaCommandText":"Formulas","PythonRestartRuntimeResetCommandText":"Reset","PythonRestartRuntimeResetRuntimeCommandText":"Reset Runtime","PythonLoadingStartAnalysis":"Starting the analysis...","PythonAugloopCallsPerQueryMaximumHitErrorText":"I\'ll pause for now. Let me know if you want me to share more, or work on another prompt.","PythonAugloopResponseTimeoutMessage":"I\'m having trouble working on prompts right now. Try sending your prompt later.","ChatPlaceholderMessagePythonMode":"Type a message for advanced analysis","SuggestionPillPythonAAText":"Get deeper results using advanced analysis mode","ZeroQueryPythonTitle":"Get deeper analysis results using Python","ZeroQueryPythonHeader":"Advanced analysis","StopGeneratingResponsePythonMode":"OK, I stopped working on your question.","PrePythonModeErrorText":"I\'m having trouble running an advanced analysis. Try your prompt again or try another one.","PythonSelectTableOrPythonCellErrorText":"Looks like an empty grid cell was selected. In order to answer your question, select a range or a Python cell and try your question again.","PythonStartAnalysisEditModeErrorText":"Excel is in cell-editing mode. To start advanced analysis, exit the mode by selecting **Enter** or **Tab** and try your prompt again.","PythonGenericEditModeErrorText":"Excel is in cell-editing mode. To continue the analysis, exit the mode by selecting **Enter** or **Tab** and try your prompt again.","PythonBusyStateErrorText":"Python formulas are still calculating. Wait a moment and try again.","PythonAnalysisSheetWasDeletedDuringGenerationErrorText":"It looks like the sheet was deleted while I was generating code. Please send your question again or send a new one to continue.","PythonCodeRetryMaximumHitErrorText":"I\'m having trouble with this Python code, and I can\'t correct it after trying multiple times. You can tell me to try again or use another prompt.","PythonGeneralErrorTextWithLink":"An error happened with the Python cell that\'s not #PYTHON or #CONNECT. To resolve this issue, review some troubleshooting tips before trying again. {0}.","PythonGeneralErrorLinkText":"View troubleshooting tips","PythonNoSuggestionGenericErrorText":"I\'m having trouble working on this request. Try a new prompt or view the suggested ones for ideas.","PythonCodeRetryResponseText":"A #PYTHON error occurred while I tried to execute the code. I\'m generating new code to continue with the analysis.","PythonCodeRetryResponseWithAddressText":"A {0} error occurred while I tried to execute the code in **{1}**. I\'m generating new code to continue with the analysis.","PythonCodeDefaultErrorMessage":"An error occurred while I tried to execute the code. I\'m generating new code to continue with the analysis.","PythonStartAnalysisFirstBulletText":"Create a new sheet for the results","PythonStartAnalysisFirstBulletTextWithExistingSheet":"Use the existing sheet \'{sheet}\' for the results","PythonStartAnalysisSecondBulletText":"Automatically write and insert Python formulas","PythonStartAnalysisThirdBulletText":"Answer your prompt in multiple messages","PythonStartAnalysisFourthBulletText":"Calculate formulas, even in manual calculation mode","PythonStartAnalysisButtonText":"Start advanced analysis","PythonExistAnalysisConfirmationText":"OK, I stopped the advanced analysis.","PythonStartAnalysisRAIErrorText":"I can\'t start advanced analysis for the data in this sheet. Use another data set or Excel workbook and try again.","PythonErrorTryAgainSuggestionPillText":"Try again","PythonAnalysisSheetNameText":"Analysis","PythonAnalysisSheetHeaderText":"Advanced analysis","PythonAnalysisSheetDescriptionText":"This sheet will include all the Python formulas generated by Copilot.","PythonAnalysisSheetWasDeletedBeforeGenerationText":"It looks like the sheet was deleted or changed. I made a new one to continue the advanced analysis.","PythonPostviewHeaderText":"Here\'s what I inserted in {0}:","PythonPostviewLoadingHeaderText":"Here\'s what I\'m loading in {0} to run the analysis:","PythonPostviewNotSupportedText":"Sorry, results for this Python cell aren\'t supported.","PythonCodeButtonRoleDescription":"Button","PythonLabelFallbackText":"Python code","PythonDataframeLabelText":"Load data from {0}, {1}","PythonDataframeCodeExplanationText":"The code loads data from {0}, {1}","PythonPreviewLabelText":"Preview","PythonSuggestMoreIdeasPill":"Suggest more ideas","PythonWhatElseCanIDoPill":"What else can I do?","PythonRunningCodeText":"Running code...","PythonStartAnalysisFooterText":"Ready to get started?","PythonStartAnalysisHeaderTextFirst30s":"I can use advanced analysis for that. Here\'s what I\'ll do once you start the analysis:","PythonStartAnalysisButtonTextFirst30s":"Start advanced analysis","PythonAnalysisSheetHeaderTextFirst30s":"Analysis Sheet","PythonDetailSheetNameText":"Detail","PythonInsertToSheetButtonText":"Insert to sheet","PythonInsertDataConfirmationMessage":"Done! I added to {0}.","PythonAddResultsToAnotherSheetConfirmationText":"Done! I added the results to {0}.","PythonGoBackToAnalysisSheetButtonText":"Go back to analysis sheet","PythonAddResultsToAnotherSheetErrorText":"I\'m having trouble inserting your results into the sheet. Try again later.","PythonAddResultsToAnotherSheetButtonText":"Add results to new sheet","PythonDataframeTeachingCalloutHeaderText":"Reference with DataFrames","PythonDataframeTeachingCalloutBodyText":"When asking for deeper analysis with Python, Copilot references your original, source data in a DataFrame – never changing it. Any edits you make to the source data will be synced to analysis results.","PythonRowsText":"{0} rows","PythonColumnsText":"{0} columns","PythonBlankText":"(Blank)","PythonUnknownText":"UNKNOWN","PythonCellsStartAnalysisError":"I\'m having trouble loading all existing Python cells, so results may be less accurate.","PythonWorkbookLostFocusError":"Looks like another workbook has been opened. To continue working on your question, stay in this workbook before changing to another one.","PythonCellsCalculatingLoadingText":"Calculating Python formulas...","PythonLookingAtFormulasText":"Looking at Python formulas in this workbook...","PythonThinkDeeperButtonTitleText":"Think Deeper","PythonThinkDeeperButtonTooltipText":"Use advanced reasoning (~30sec)","PythonThinkDeeperStartAnalysisButtonText":"Start","PythonStartWithThinkDeeperButtonText":"Start with Think Deeper","PythonThinkDeeperStartingText":"With Think Deeper, I take longer to respond with more in-depth answers for complex tasks.","PythonPostviewImageUnavailableText":"This Python formula was deleted, so the results are no longer available.","PythonFormulaText":"Python formula","PythonFormulaSecondaryText":"Results will update when data referenced is changed.","PythonShowAnalysisText":"Show analysis","PythonHideAnalysisText":"Hide analysis","PythonOutputText":"Output:","PythonExecutionBlockedByAdminText":"Sorry, I can’t complete the action. This action may be blocked by your administrator.","PythonTableExpand":"Expand","PythonTableCollapse":"Collapse","PythonAugloopLlmLoopLimitHitMessage":"I\'ll pause for now. Let me know if you want me to share more, or work on another prompt.","PythonElseFallbackMessage":"I\'m having trouble working on this answer. I\'ll try a different approach now.","PythonLargeDataMessage":"My answer is too long to show here in the chat. I\'ll try to summarize it for you.","ImportDataCardHeaderMultipleTables":"Here are {0} tables to import. You can refresh the imported data to see the latest updates in the source file:","ImportDataCardHeaderSingleTable":"Here\'s 1 table to import. You can refresh the imported data to see the latest updates in the source file:","ImportDataCardHeaderFallbackShowAll":"I am unable to find relevant tables to import, here are all the tables from the referred files that you can import:","ImportDataCardHeaderSomeFiltered":"I found relevant tables within the search results that you can import.\\nPlease note that I was not able to process some of the files.","ImportDataStaticSuggestionPillText":"Show tables import options for Excel files","ImportDataStaticSuggestionButtonText":"Show tables to import","ImportDataLoadQueryAddedToDocumentMessageText":"The table has been imported!\\nTo see the latest information, refresh your imported data by selecting \'Data\' in the ribbon, and then \'Refresh\'. ","ImportDataLoadQueryAddedToDocumentMessageNoBindingText":"Import request sent.\\nOnce the table is in the sheet, you can refresh the imported data to get the latest information.                         ","ImportDataShowImportQuery":"Show import query","ImportDataHideImportQuery":"Hide import query","ImportDataImportToNewSheet":"Import to new sheet","ImportDataSuccessButtonText":"Import requested","ImportDataQuerySnippetTitle":"Import query","ImportDataCaruselText":"{0} of {1}","ImportDataCaruselNext":"Next","ImportDataCaruselPrevious":"Previous","ImportDataExcelFileTooltip":".xlsx file","ImportDataNoTableFoundMessageText":"No tables from the cited files could be imported into the workbook. Open the cited files to manually import the data","ImportDataNoTableFoundAndSomeFilteredMessageText":"No tables from the cited files could be imported into the workbook.\\nPlease note that I was not able to process some of the files.\\n\\n You can open the cited files to manually import the data.","ImportDataFailureGeneralMessageText":"Sorry, something went wrong. Try your request again later.","ImportDataFailureNoAuthRefreshText":"Unfortunately, table refresh requests are not currently available on our web app. Please try again later or use our desktop app.","ImportDataShortFailureMessageText":"The table couldn\'t be imported.\\nTry again a bit later.","ImportDataPrepareImportOptions1":"Generating table previews...","ImportDataPrepareImportOptions2":"Almost there...","ImportDataToGridOption1":"Importing table...","ImportDataQueryExplanation":"This query imports data from the selected table to your workbook","LearnMoreLinkText":"Learn more","CommandingTellMeHeader1":"OK, here\'s how:","CommandingTellMeSuggestion1":"To highlight the data, try \\"Bold the top 10 values in the Sales column\\"","CommandingTellMeSuggestion2":"To filter and sort, try \\"Filter to items that are due next week\\"","CommandingTellMeHeader2":"Here are more things you can do:","CommandingTellMeSuggestion3":"To edit table properties, try \\"Add a Total row\\"","CommandingTellMeSuggestion4":"To adjust the number formatting, try \\"Show the Sales column in currency format\\"","CseSelfHelpSkillSourceLabel":"Excel Help","ShowPopupMessage":"Your Microsoft 365 account needs to be verified, but your browser settings are blocking this action. Select {0} to continue.","ShowPopupButton":"Verify","TableUsesTooMuchMemoryError2":"I can\'t work on this question because the content in the table exceeds the maximum memory load. Reduce the amount of content such as formulas, columns, or rows, and try again. You can also select another table with less content before retrying.","ElseFormulaBlocksError":"I\'m not able to do that. Try another request or use a suggested prompt.","ElseSecurityBlockedFormulaError":"A formula containing the {FunctionName} function won\'t be generated for this prompt to protect your privacy. Use another prompt and I\'ll try to help.","ElseExternalWorkbookFormulaError":"A formula containing external references to other Excel workbooks won\'t be generated for this prompt. Use another prompt and I\'ll try to help.","ElseSkillGeneralError":"I\'m having trouble answering your question right now. Try again later.","FallbackSkillLatencyMessage":"Still working on suggestions...","AugLoopSearchAndActionError":"I can\'t yet make changes that leverage information from your organization/from the web.","AugLoopSearchAndActionErrorImproved":"I can\'t yet make changes that leverage information from your organization/from the web, but here\'s some information that might help: ","AugLoopNoTableError":"I couldn\'t find a table or data range that answers your question. I only work with data in a table or range with a single header row with different column names, no empty rows or columns, consistent data formatting per column, and no subtotals.\\n\\nTry selecting data that meets the criteria or is formatted as a table (go to Insert in the ribbon, and then select Table).","AugLoopNoTableError2":"I couldn\'t find a table or data range that answers your question. I only work with data in a table or range with a single header row with different column names, no empty rows or columns, consistent data formatting per column, and no subtotals.\\n\\nTry selecting data that meets the criteria or is formatted as a table (go to **Insert** in the ribbon, and then select **Table**).","AugLoopImageChatError":"I can\'t yet use images for this request.","TabularRangeUnrecognizedTableError":"I can\'t identify the structure of the data range starting in **{range}**. Double check to ensure the range has a single row of headers on top. If the range meets the criteria, select the entire range. Then, go to **Insert** in the ribbon and select **Table**.","TabularRangeUnrecognizedTableDueToWorkbookSizeError":"Looks like this file has over one million cells or exceeds the amount of content I can work with. Try converting the data range to an Excel table or reducing the content in the workbook and reopen Excel.","TabularRangeRowMajorSingleError":"The headers in data range **{range}** should be in columns, as a single row on top of the data. Ask me how to use the TRANSPOSE() function to switch the format from columns to rows.","TabularRangeRowMajorMultipleError":"The headers should be in columns, as a single row on top of the data. Make sure all headers have different names. To quickly switch the format to columns and rows, ask me how to use the TRANSPOSE() function.","TabularRangeRowMajorErrorHeader":"Place headers in columns","TabularRangeMergedCellsSingleError":"There are merged cells in the data range **{range}**, but data in those cells won\'t be included in my answer. To get accurate results, follow these quick steps:\\n- Go to **Home** in the ribbon, and then select **Merge and Center** to choose the option to unmerge cells.\\n- Copy and paste the data into the unmerged cells.","TabularRangeMergedCellsMultipleError":"There are merged cells in the data range, but data in merged cells won\'t be included in my answer. To get accurate results, follow these quick steps:\\n- Go to **Home** in the ribbon, and then select **Merge and Center** to choose the option to unmerge cells.\\n- Copy and paste the data into the unmerged cells.","TabularRangeMergeCellsErrorHeader":"Unmerge cells","TabularRangeAggregationsSingleError":"It looks like the data range **{range}** may have subsections. I only work with ranges that have a single total row at the bottom, not ones with subtotals or grouped rows. Remove the grouped rows and subtotals and try again.","TabularRangeAggregationsMultipleError":"There may be subsections in the data range. Remove the grouped rows and subtotals.","TabularRangeAggregationsErrorHeader":"Remove grouped rows and subtotals","TabularRangeMultipleHeaderRowsSingleError":"The data range **{range}** has more than one row of headers. I only work with data ranges that have a single row of headers. Consolidate the headers into a single row and try your question again.","TabularRangeMultipleHeaderRowsMultipleError":"There are more than one row of headers. I only work with data ranges that have a single row of headers. Consolidate the headers into a single row.","TabularRangeMultipleHeaderRowsErrorHeader":"Consolidate headers into a single row","TabularRangeNoHeaderColumnsSingleError":"There are no headers in the data range **{range}**. Create a row of headers with different names on the top of the data range and try your question again.","TabularRangeNoHeaderColumnsMultipleError":"There are no headers. Create a row of headers with different names on the top of the data range.","TabularRangeNoHeaderColumnsErrorHeader":"Create a row of headers","TabularRangeInterpretationConfidenceSingleError":"I can\'t identify the structure of the data range starting in **{range}**. Double check to ensure the range has a single row of headers on top. If the range meets the criteria, select the entire range. Then, go to **Insert** in the ribbon and select **Table**.","TabularRangeInterpretationConfidenceMultipleError":"I can\'t identify the structure of the data range. Double check to ensure the range has a single row of headers on top. If the range meets the criteria, select the entire range. Then, go to **Insert** in the ribbon and select **Table**.","TabularRangeInterpretationConfidenceErrorHeader":"Check data structure","TabularRangeEmptyHeadersSingleError":"It looks like some of the headers in the data range **{range}** have empty cells. Make sure all columns have header names and are different before trying your question again. If the range already meets the criteria, select the entire range. Then, go to **Insert** and select **Table**.","TabularRangeEmptyHeadersMultipleError":"It looks like some of the headers have empty cells. Make sure all columns have header names.","TabularRangeEmptyHeadersErrorHeader":"Add header names","TabularRangeDuplicateHeadersSingleError":"It looks like there are headers with identical names in the data range **{range}**. Review and add different header names to each column before trying your question again.","TabularRangeDuplicateHeadersMultipleError":"It looks like there are headers with identical names. Review and add different header names to each column.","TabularRangeDuplicateHeadersErrorHeader":"Add different headers","TabularRangeCrosstabSingleError":"In the data range **{range}**, there are headers in rows and columns. Modify the range to have a single row of headers on top of the data or select another range that fits the criteria before trying your question again. If the range already meets the criteria, select the entire range. Then, go to **Insert** and select **Table**.","TabularRangeCrosstabMultipleError":"There are headers in rows and columns. Modify the range to have a single row of headers on top of the data or select another range that fits the criteria.","TabularRangeCrosstabErrorHeader":"Modify headers to be in a single row","TabularRangeMultipleErrorCardIntro":"In order to answer your question, the data range **{range}** needs some revisions:","TabularRangeMultipleErrorCardConclusion":"Once you\'ve made the recommended changes, try your question again.","TabularRangeMultipleErrorCardConvertToTableConclusion":"If the range already meets the criteria, select the entire range. Then, go to **Insert** and select **Table**. Once you\'ve made the recommended changes, try your question again.","SuggestionPillConditionalFormatting":"Suggest conditional formatting","ConditionalFormattingSuggestionResponse":"Okay! Here are some conditional formatting suggestions for data in {0}","ConditionalFormattingSuggestionResponseWithSheet":"Okay! Here are some conditional formatting suggestions for data in {range} on \'{sheet}\'","ConditionalFormattingSuggestionResponseWithNamedSheet":"Okay! Here are some conditional formatting suggestions for data in {range} on the \'{sheet}\' sheet","ConditionalFormattingSuggestionResponseError":"Sorry, something went wrong. Try asking for conditional formatting suggestions again later.","ConditionalFormattingSuggestionResponseNoTable":"Sorry, I can\'t find the data I need to generate conditional formatting suggestions. Try selecting the table with your data, then asking for conditional formatting suggestions again.","ConditionalFormattingSuggestionResponseNoSuggestion":"Sorry, I have no suggestions at this time. Try suggest conditional formatting again later.","ConditionalFormattingSuggestionResponseNoSuggestionForRange":"Sorry, I don\'t have any conditional formatting suggestions for data in {0}. Try adding more data or selecting a different table, then asking for conditional formatting suggestions again.","UnsupportedConditionalFormatEntityRangeText":"I\'m sorry, but I can only apply formatting to rows or columns within tables. Try asking me to apply formatting to the whole table instead.","ConditionalFormatFormulaInvalidErrorText":"Sorry, I can\'t create that conditional format rule right now. Is there anything else I can help you with?","ODSLGeneralError":"Sorry, I can\'t do that right now. Try again or select a suggestion.","VariableCacheEntityTypeMismatched":"Sorry, I can\'t modify the entity. Make sure the correct entity is selected and try again.","MultipleEventsExecutionErrorText":"I couldn\'t finish your request. If something isn\'t right, use Undo to remove my changes.","ColumnRowOutOfBoundaryErrorText":"I\'m not able to make changes in those cells because they\'re outside of the Excel Table. Try making changes to cells inside of the Excel Table.","UnsupportedCommandIntroductionText":"I need more practice before I can do that. For now, I\'ll share the steps you can follow.","SelectedColumnRowErrorText":"I don\'t currently have a way to know which cells you selected. Please specify the cells, columns, or rows you want me to work with.","ClearSortErrorText":"Sorry, I can\'t remove sorting from the table. Please tell me how you\'d like to sort the table, or make a new request.","NoSupportedNumberFormatCategoriesNumberErrorText":"Sorry, I can\'t apply conditional formatting to this range. Make sure it includes accounting, currency, fraction, number, percentage, or scientific formatting and try again.","NoSupportedNumberFormatCategoriesDateErrorText":"Sorry, I can\'t apply conditional formatting to this range. Make sure it includes a date or time format and try again.","NoSupportedNumberFormatCategoriesTextErrorText":"Sorry, I can\'t apply conditional formatting to this range. Make sure it includes a text, special, date, or time format and try again.","NoSupportedNumberFormatCategoriesOtherErrorText":"Sorry, I can\'t apply conditional formatting to this range. Remove any general, custom, or text formatting for the range and try again.","NumericFilterOnNonNumberErrorText":"Sorry, I can\'t apply a numeric filter (greater than, less than, between, or their negations) to a column that\'s not numeric. Make sure it doesn\'t contain text or true/false data, and try again.","TextualFilterOnNonTextErrorText":"Sorry, I can\'t apply a text filter (begins with, ends with, contains, or their negations) to a column that\'s not textual. Make sure it doesn\'t contain numeric or true/false data, and try again.","DeleteUnexpectedTableRowsErrorText":"Sorry, I can\'t delete the row(s). Is there anything else I can help you with?","DeleteWithInsertColumnsErrorText":"Sorry, I can\'t modify the column(s). Is there anything else I can help you with?","PivotTableChartPresentWithoutTableTLRError":"Currently, I don\'t analyze PivotTables and charts in sheets. I can continue to help if you select the source table and try your question again.","PivotTableChartPresentWithoutTableTLRError2":"To continue analyzing with more prompts, go back to the source table.","PivotTableChartSelectedError":"I don\'t analyze PivotTables or charts in sheets. Select a source table and ask me a question. If you\'d like to keep working with the PivotTable or chart, try asking me how to analyze these objects.","NoPatternsFoundError":"I couldn\'t find any insights from your data, but here but here are a few steps to follow if you\'d like to try.","FixItButtonText":"Fix it","TabularRangeAutoFixDuplicateHeadersSuccessfulResponse":"Thanks for changing the header names! You can try your question again.","TabularRangeAutoFixDuplicateHeadersUnsuccessfulResponse":"I couldn\'t fix the duplicate headers. Go to **Insert** in the ribbon, and then select **Table**.","TabularRangeAutoFixMergedCellsSuccessfulResponse":"Thanks for unmerging the cells! You can try your question again.","TabularRangeAutoFixMergedCellsUnsuccessfulResponse":"I couldn\'t unmerge the cells. Go to **Insert** in the ribbon, and then select **Table**.","TabularRangeAutoEmptyHeadersSuccessfulResponse":"Thanks for adding header names to the empty cells! You can try your question again.","TabularRangeAutoEmptyHeadersUnsuccessfulResponse":"I couldn\'t fix the empty headers. Go to **Insert** in the ribbon, and then select **Table**.","NoAutoFixCompleted":"No changes are needed. Try your question again.","TabularRangeAutoFixDuplicateHeaders":"Some headers have duplicate names. Review and change to different header names.","HeaderColumnLabel":"Column","HeaderRowLabel":"Row","TlrAutoFixConfirmationMultipleCases":"Thanks for making those changes! Try your question again.","TlrAutoFixUnsuccessful":"I couldn\'t make those changes. Go to **Insert** in the ribbon, and then select **Table**. ","ExplainTablesPill":"Tell me more about Excel tables","ExplainHeadersPill":"What are headers?","ExplainUnmergingCellsPill":"What are the benefits of unmerging cells?","AutoFixIntroduction":"In order to answer your question, the data range in **{range}** needs a revision:","AutoFixMoreThanTwoMergedCells":"Unmerge {count} cells","AutoFixOneMergedCells":"Unmerge cell in {range}","AutoFixTwoMergedCells":"Unmerge cells in {range1} and {range2}","AutoFixMultipleMergedCellsDescription":"Unmerge cells and paste the data","AutoFixMoreThanTwoEmptyCells":"Add {count} header names","AutoFixOneEmptyCells":"Add header name in {range}","AutoFixTwoEmptyCells":"Add header names in {range1} and {range2}","AutoFixMoreThanTwoDuplicateCells":"Add {count} different headers","AutoFixTwoDuplicateCells":"Add different headers in {range1} and {range2}","AnalyzeDataInsertErrorMessage":"Sorry, something went wrong. Try again.","InsertedWorksheetName":"Suggestion{0}","InsertedPivotTableName":"PivotTable{0}","NoValueAnswerTextForIdeas":"Based on your question, we didn\'t find a match for the answer in the data.","NoValueAnswerTextForNLInsight":"Based on your question, we didn\'t find any insights that would match the answer.","CopilotUnsupportedlanguageMessage":"Your request includes a language that Copilot doesn\'t currently support. ","CopilotUnsupportedLanguageError":"I don\'t yet support %s. For a list of supported languages, please visit ","CopilotSupportedLanguagesLearnMoreLink":"Supported languages for Microsoft Copilot","FeedbackPrompt":"If you feel I\'m mistaken, please send feedback.","SuggestFullThemeAnalysisPrompt":"The quick summary above considers only part of your data. Would you like a full theme analysis that you can insert in a new column? It may take a few minutes.","SuggestFullThemeAnalysisButton":"Run full theme analysis","SuggestFullThemeAnalysisQuery":"Run a full theme analysis on the \\"{columnName}\\" column","OperationProgress":"{percentProgress}% ({timeLeft} min left)","TextAnalysisSummayInsertionColumnName":"Themes","TextAnalysisSentimentInsertionColumnName":"Sentiment","ChartDesignRecommendationsCardText":"Chart Design Recommendations","ChartDesignRecommendationsPreviewDesignLabel":"I noticed that you are adding a chart to the sheet. Here are some additional ideas you can try.","ChartDesignRecommendationsPreviewDesignLabelViaOOUI":"Here are some designs you can try.","ChartDesignRecommendationsPreviewDesignSnowballChartLabel1":"Your chart has no data.","ChartDesignRecommendationsPreviewDesignSnowballChartLabel2":"Enter data into the grid and try again.","ChartDesignRecommendationsPreviewButtonLabel":"Preview design","ChartDesignRecommendationsCardFooterText":"Don\'t show me suggestions.","ChartDesignRecommendationsBackToResultsButtonLabel":"Back to results","ChartDesignRecommendationsApplyDesignLabel":"Here are the changes for you to review and apply.","ChartDesignRecommendationsApplyButtonLabel":"Apply design","ChartDesignRecommendationsCardErrorPreviewUnavailable":"Preview Unavailable","ChartDesignRecommendationsCardErrorFailedValidation":"Failed Validation","ChartDesignRecommendationsCardErrorInternalError":"Internal Error","ChartDesignRecommendationsCardErrorNoSuggestion":"Unavailable","ChartDesignRecommendationsCardInProgressText":"Chart recommendations are already in progress. Please wait before generating new ones.","ChartDesignRecommendationsAnalyzingCardText":"Analyzing your chart data to inform chart designs...","ChartDesignRecommendationsCardSelectingText":"Selecting relevant chart designs...","ChartDesignRecommendationsCardGeneratingText":"Generating design {chartNumber} of {chartTotal}...","ChartDesignRecommendationsCardProcessingText1":"Processing chart and axes titles...","ChartDesignRecommendationsCardProcessingText2":"Processing colors and styles...","ChartDesignRecommendationsCardProcessingText3":"Processing chart formatting...","ChartDesignRecommendationsCardProcessingText4":"Processing axes and gridlines...","ChartDesignRecommendationsCardProcessingText5":"Processing labels...","ChartDesignRecommendationCardErrorMessage":"I wasn\'t able to finish creating recommendations.","PythonInsertObjectProtectedSheetErrorText":"Looks like this is a password-protected sheet and I can\'t automatically insert objects into the sheet. Remove the password and try again, but I recommend adding the password back to keep this sheet protected when you\'re done."}');var s=n(785388);const c="X-NLInteractionId",d="https://ppe.insights.microsoft.com",u="https://insights.microsoft.com",m="https://dev.insights.microsoft.com",g="https://dev2.insights.microsoft.com",h="https://api.gcc.insights.usgovcloudapi.net",p="https://api.gcch.insights.usgovcloudapi.net",b="https://api.dod.insights.usgovcloudapi.net",f="shimmer",C="Taskpane",y="closeButton",v={OFFICEONLINE:"Excel.Web.Copilot_Lib",PC:"Excel.Win32.Copilot_Lib",MAC:"Excel.Mac.Copilot_Lib",IOS:"Excel.iPad.Copilot_Lib"},T="Excel",x="Copilot",S=150,w=18,E="ANNOTATION",I=.5,R=100*I,A="[]",L=5e3,k="div[data-testid='APIPluginCard']",F=5,_=1e3,P="ExcelSidepaneWorkCopilot",N="excel",M=2e3,O=18e4;let D=!1,B=!1;const $=function(e,t){D=e,B=t},H=function(e){return(0,o.yw9)("OfficeVSO_8940802_WrapNTierRtlUIStrings")&&B&&!D?"⁧"+e+"⁩":e},U=i("ExcelCopilotStrings",l),q=i("ExcelCopilotStrings",l,(()=>{})),V=i("OfficeaicopilotStrings",s),W=function(){return"undefined"!=typeof ExcelCopilotStringsNTier},G={Columns:{SingleColumnRecommendation:"I suggested adding the column named {columnName}, that use the formula {formula}, to the column location {columnLocation} to calculate the results.",SingleColumnRecommendationWithNoLocation:"I suggested adding the column named {columnName}, that use the formula {formula}, to calculate the results.",MultipleColumnsRecommendation:"I suggested adding the columns named {columnNames}, that use the formulas {formulas}, to the column locations {columnLocations} to calculate the results.",MultipleColumnsRecommendationWithNoLocation:"I suggested adding the columns named {columnNames}, that use the formulas {formulas}, to calculate the results."},Rows:{SingleFormulaRecommendation:"I suggested adding the formula {formula}, that calculates {title}, under the column {location} to calculate the results.",SingleFormulaRecommendationWithNoLocation:"I suggested adding the formula {formula}, that calculates {title}, to calculate the results.",MultipleFormulaRecommendation:"I suggested adding the formulas {formulas}, that calculate {titles}, under the columns {columnLocations} to calculate the results.",MultipleFormulaRecommendationWithNoLocation:"I suggested adding the formulas {formulas}, that calculate {titles}, to calculate the results."},HumanInTheLoop:{Error:"There was an error while generating the human in the loop card.",CardShown:"I showed the human in the loop card, prompting to confirm application of commanding operation."}},z=function(){return[U.CommandingHumanInTheLoopApplyingChangesMessage]},Q=function(){return[U.CommandingHumanInTheLoopApplyingChangesMessageWithSheet]},j=function(){return U.CalculatedColumnsFailureGeneral},J=function(e){return[e?U.CalculatedColumnsNLNoResultSuggestionIdentifyColumn:U.CalculatedColumnsNLNoResultSuggestionIdentifyColumnAndTable,U.CalculatedColumnsNLNoResultSuggestionCreateColumn]},Y=function(){return U.CalculatedColumnsInsertFailedDeleteConflict},X=function(){return U.CalculatedRowsInsertFailedDeleteConflict},Z=function(){return U.CalculatedColumnsInsertFailedProtectedSheet},K=function(){return U.CalculatedRowsInsertFailedProtectedSheet},ee=function(){return U.CalculatedColumnsInsertFailedTableNotFound},te=function(){return U.CalculatedRowsInsertFailedTableNotFound},ne=function(){return U.CalculatedColumnsInsertFailedGeneral},ae=function(){return U.CalculatedRowsInsertFailedGeneral},oe=function(){return U.CalculatedColumnsColumnConfirmationMessage},re=function(){return U.CalculatedColumnsTableConfirmationMessage},ie=function(){return U.MultipleCalculatedColumnsAddedToColumnsConfirmationMessage},le=function(){return U.MultipleCalculatedColumnsAddedToTableConfirmationMessage},se=function(){return U.MoreThanThreeColumnsAddedToTableConfirmationMessage},ce=function(){return U.DataShapingEnterModeButton},de=function(){return U.DataShapingSuggestEnterModeHeaderText},ue=function(){return U.DataShapingSuggestEnterModeText1},me=function(){return U.DataShapingSuggestEnterModeTextBullet1},ge=function(){return U.DataShapingSuggestEnterModeTextBullet2},he=function(){return U.DataShapingSuggestEnterModeText3},pe=function(){return[U.DataShapingLoadingStartDataShapingMode]},be=function(){return[U.LoadingUIExitDataShapingMode]},fe=function(){return U.DataShapingPostEnterModeText1},Ce=function(){return U.DataShapingPostEnterModeText2},ye=function(){return[U.LoadingUIApplyDataShapingStep,U.LoadingUIApplyDataShapingStep2,U.LoadingUIApplyDataShapingStep3,U.LoadingUIApplyDataShapingStep4]},ve=function(){return U.DataShapingGenericError},Te=function(){return"An unexpected error occurred while preparing the data and we exit the mode. please try again."},xe=function(){return"Preparing data on query tables is not supported."},Se=function(){return U.EnterDataShapingNoTableError},we=function(){return U.DataShapingUnsupportedPromptError},Ee=function(){return U.EnterDataShapingGenericError},Ie=function(){return U.DataShapingDone},Re=function(){return U.DataShapingDone},Ae=function(){return U.DataShapingApplyOrExit},Le=function(){return U.DataShapingApplyToNewSheet},ke=function(){return U.DataShapingApplyToExistingTable},Fe=function(){return U.DataShapingDiscardChanges},_e=function(){return U.DataShapingDiscardChangesDone},Pe=function(){return U.DataShapingApplyToExistingTableDone},Ne=function(){return U.DataShapingApplyToNewSheetDone},Me=function(){return U.DataShapingGenericError},Oe=function(){return U.MultipleCalculatedColumnsInsertFailedConflict},De=["Saving your automation..."],Be=["Creating your automation..."],$e=function(){return[U.LoadingUIWorkingOnItStep,U.LoadingUiUnderstandingDataStep,U.LoadingUILookingAtDataRangeStep]},He=function(){return[U.LoadingUIWorkingOnItStep,U.LoadingUiUnderstandingDataStep,U.PythonLookingAtFormulasText]},Ue=function(){return[U.LoadingUIWorkingOnItStep,U.LoadingUiUnderstandingDataStep,U.LoadingUILookingAtDataRangeStepWithSheet]},qe=function(e){return e?[q.LoadingUIWorkingOnItStep,q.LoadingUiUnderstandingDataStep,q.LoadingUIAlmostThereStep]:[U.LoadingUIWorkingOnItStep,U.LoadingUiUnderstandingDataStep,U.LoadingUIAlmostThereStep]},Ve=function(){return[U.LoadingUIFinishingUpStep]},We=function(){return[U.LoadingUIAddingColumnStep]},Ge=function(){return[U.LoadingUIAddingColumnsStep]},ze=function(){return[U.LoadingUIInsertingContentStep]},Qe=function(){return[U.LoadingUIAnalyzingDataStep]},je=function(){return[U.LoadingUIMakingChangesStep]},Je=function(){return[U.LoadingUIMakingChangesChartStep]},Ye=function(){return[U.LoadingUIMakingChangesStepTableOfficeJSLikeRange]},Xe=function(){return[U.LoadingUIGeneratingFormulaColumnSuggestionsStep]},Ze=function(){return[U.LoadingUIGeneratingFormulaRowSuggestionsStep]},Ke=function(){return[U.LoadingUIAnalyzingDataTLRStep]},et=function(){return[U.LoadingUIAnalyzingDataTLRStepWithSheet]},tt=function(){return[U.LoadingUIMakingChangesTLRStep]},nt=function(){return[U.LoadingUIMakingChangesTLRStepWithSheet]},at=function(){return[U.LoadingUIGeneratingFormulaColumnSuggestionsTLRStep]},ot=function(){return[U.LoadingUIGeneratingFormulaColumnSuggestionsTLRStepWithSheet]},rt=function(){return[U.LoadingUIGeneratingFormulaRowSuggestionsTLRStep]},it=function(){return[U.LoadingUIGeneratingFormulaRowSuggestionsTLRStepWithSheet]},lt=function(){return[U.PythonLoadingStartAnalysis]},st=function(){return[U.PythonCellsCalculatingLoadingText]},ct=function(){return[U.LoadingUIWorkingOnItStep]},dt=function(e){return e?q.CalculatedColumnsGeneralSingular:U.CalculatedColumnsGeneralSingular},ut=function(){return U.SuggestionPillAnotherColumnSuggestion},mt=function(){return U.SuggestionPillPromptBasedAnotherSuggestion},gt=function(){return U.CalculatedRowsShowMorePill},ht=function(){return U.SuggestionPillCreateColumn},pt=function(){return U.RecommendationAddToNewSheet},bt=function(){return U.RecommendationAddToSheet},ft=function(){return U.RecommendationInsertColumn},Ct=function(){return U.RecommendationInsertMultipleColumns},yt=function(){return U.CalculatedRowsInsertCellTitle},vt=function(){return U.CalculatedRowsInsertRowTitle},Tt=function(){return U.CalculatedRowsUpdateCellTitle},xt=function(){return U.CalculatedRowsUpdateRowTitle},St=function(){return U.CalculatedRowsFormulaSuggestionHeader},wt={PreviewOnGridButton_ShowPreview:()=>U.FormulaSuggestion_PreviewOnGridButton_ShowPreview,PreviewOnGridButton_HidePreview:()=>U.FormulaSuggestion_PreviewOnGridButton_HidePreview},Et=function(){return U.UnsupportedOperationMessage},It=function(){return U.ServerErrorMessage},Rt=function(){return U.AugloopResponseTimeoutMessage},At=function(){return U.PythonAugloopResponseTimeoutMessage},Lt=function(){return W()?H(ExcelCopilotStringsNTier.AugloopErrorUnsupportedLanguage):"I'm still working to support other languages. For now, please try your prompt again in English."},kt=function(){return U.QueryLengthTooShortError},Ft=function(){return U.ThrottlingErrorMessage},_t=function(){return U.LicensingErrorMessage},Pt=function(){return U.RaiErrorUserMessage},Nt=function(){return U.ElseFormulaBlocksError},Mt=function(){return U.RaiErrorSuccessfulActionBlockedResponse},Ot=function(){return U.ErrorServerBusy},Dt=function(){return"Tag"},Bt=()=>[{error:"Blocked potentially offensive input",errorMessageUser:Pt()},{error:"Output was blocked for offensive content",errorMessageUser:Pt()},{error:"The query is too long, try again with a shorter query.",errorMessageUser:U.ErrorQueryTooLarge},{error:"Detected languages",errorMessageUser:U.AugloopErrorOTE},{error:"InferenceAPI: Too busy",errorMessageUser:Ot()},{error:"InferenceAPI: Timeout",errorMessageUser:Ot()},{error:"InferenceAPI: User throttled",errorMessageUser:Ft()}],$t=function(){return U.ChatSuggestionHeader},Ht=function(){return U.ChatSuggestionAddColumns},Ut=function(){return U.ChatSuggestionHighlight},qt=function(){return U.ChatSuggestionFilterAndSort},Vt=function(){return U.ChatSuggestionAnalyze},Wt=function(){return U.ChatSuggestionFooterText},Gt=function(){return[U.HelpQueryPhrase1,U.HelpQueryPhrase2,U.HelpQueryPhrase3,U.HelpQueryPhrase4,U.HelpQueryPhrase5,U.HelpQueryPhrase6,U.HelpQueryPhrase7,U.HelpQueryPhrase8,U.HelpQueryPhrase9,U.HelpQueryPhrase10,U.HelpQueryPhrase11,U.HelpQueryPhrase12,U.HelpQueryPhrase13,U.HelpQueryPhrase14,U.HelpQueryPhrase15,U.HelpQueryPhrase16,U.HelpQueryPhrase17,U.HelpQueryPhrase18,U.HelpQueryPhrase19,U.HelpQueryPhrase20,U.HelpQueryPhrase21,U.HelpQueryPhrase22,U.HelpQueryPhrase23,U.HelpQueryPhrase24]},zt=function(){return[U.UnsupportedQueryUndoPhrase1,U.UnsupportedQueryUndoPhrase2,U.UnsupportedQueryUndoPhrase3,U.UnsupportedQueryUndoPhrase4,U.UnsupportedQueryUndoPhrase5]},Qt=function(){return[U.UnsupportedQueryAltTextPhrase1,U.UnsupportedQueryAltTextPhrase2,U.UnsupportedQueryAltTextPhrase3,U.UnsupportedQueryAltTextPhrase4]},jt=function(){return[U.UnsupportedQueryAddCommentPhrase1,U.UnsupportedQueryAddCommentPhrase2,U.UnsupportedQueryAddCommentPhrase3]},Jt=function(){return[U.UnsupportedQueryDataValidationPhrase1,U.UnsupportedQueryDataValidationPhrase2,U.UnsupportedQueryDataValidationPhrase3]},Yt=function(){return[U.UnsupportedQueryWorksheetPhrase1,U.UnsupportedQueryWorksheetPhrase2,U.UnsupportedQueryWorksheetPhrase3]},Xt=function(){return[U.UnsupportedQueryFreezePanePhrase1,U.UnsupportedQueryFreezePanePhrase2]},Zt="",Kt=function(){return U.ChatPlaceholderMessageV2},en=function(){return U.ChatPlaceholderMessagePythonMode},tn=function(){return U.ChatPlaceholderMessageRange},nn=function(){return U.ChatPlaceholderMessageSearch},an=function(){return U.ChatPlaceholderMessageSearchWithRange},on=function(){return U.ChatRestShyPlaceholderMessage},rn=function(){return U.ChatRestShyPlaceholderMessageRange},ln=function(){return[U.SuggestionPillSeeInsight,U.SuggestionPillAddInsights]},sn=function(){return U.DashboardSourceDataLabel},cn="#F0F0F0",dn="#595959",un=25,mn=60,gn=function(){return U.AnalyzeDataGenericError},hn=function(){return U.UndoScopeName},pn=function(){return W()?H(ExcelCopilotStringsNTier.AugloopSessionClosedTitle):"Something went wrong"},bn=function(){return W()?H(ExcelCopilotStringsNTier.AugloopSessionClosedDesktopMessage):"Sorry, I'm having some trouble right now. Restart Excel and try sending the prompt again."},fn=function(){return W()?H(ExcelCopilotStringsNTier.AugloopSessionClosedWebMessage):"Sorry, I'm having some trouble right now. Try refreshing the webpage."},Cn=function(){return U.BlankWorksheetButtonText},yn=function(){return U.BlankWorksheetButtonSuccess},vn=function(){return U.ActionButtonGoToData},Tn=function(){return(0,o.iPS)("Microsoft.Office.Excel.FA000000124.OfficeVSO_9657578_LocalizeGoBackToSheetNameButton",!1)?"Go back to {0}":vn()},xn=function(){return U.ActionButtonUndo},Sn=function(){return V.UndoCompletionOutputText},wn=function(){return V.RebrandedChatPlaceHolderMessage??"Ask a question"},En=function(){return U.ActionButtonInsert},In=function(){return U.InsertSingleTableSuccessMessage},Rn=function(){return U.InsertMultiTablesSuccessMessage},An=function(){return U.InsertTableErrorMessage},Ln=function(){return U.TableUsesTooMuchMemoryError2},kn=function(){return U.ShowHeadersButtonTitle},Fn=function(){return U.ShowHeadersSuccessMessage},_n=function(){return W()?H(ExcelCopilotStringsNTier.WorksheetAutosaveOffTitle):"AutoSave is turned off"},Pn=function(){return W()?H(ExcelCopilotStringsNTier.WorksheetAutosaveOffMessage):"I only work with files that have AutoSave turned on. Turn it on to continue."},Nn=function(){return W()?H(ExcelCopilotStringsNTier.EnableAutosaveButtonText):"Turn on AutoSave"},Mn=function(){return U.DialogSheetUnsupportedTitle},On=function(){return U.DialogSheetUnsupportedMessage},Dn=function(){return U.FileLocationUnsupportedTitle},Bn=function(){return U.FileLocationUnsupportedMessage},$n="https://support.microsoft.com/office/frequently-asked-questions-about-copilot-in-excel-7a13758f-d61e-4a56-8440-f2c9a07802ec",Hn=function(){return U.WorksheetProtectedTitle},Un=function(){return U.WorksheetProtectedMessage},qn=function(){return U.NonWorksheetActivatedTitle},Vn=function(){return U.NonWorksheetActivatedMessage},Wn=function(){return U.ConvertToTableButtonSuccess},Gn=function(){return U.InsertAllDataConfirmationMessage},zn=function(){return U.InsertDataConfirmationMessage},Qn=function(){return U.ChartDesignRecommendationsCardInProgressText},jn=function(e){return e?q.SuggestionPillInsights2:U.SuggestionPillInsights2},Jn=function(){return U.SuggestionPillUpdatedInsights2},Yn=function(){return U.SuggestionPillShowPivotTables},Xn=function(){return U.SuggestionPillShowCharts},Zn=function(){return U.SuggestionPillAnotherPivotTable},Kn=function(){return U.SuggestionPillAnotherChart},ea=function(){return U.CommandingTellMeHeader1},ta=function(){return U.CommandingTellMeSuggestion1},na=function(){return U.CommandingTellMeSuggestion2},aa=function(){return U.CommandingTellMeHeader2},oa=function(){return U.CommandingTellMeSuggestion3},ra=function(){return U.CommandingTellMeSuggestion4},ia=function(){return U.NoInsightsMessage},la=function(){return U.NoAnalyzeDataMessage},sa=function(){return U.AnalyzeNotSupportedMessage},ca=function(){return U.AnalyzeDataGenericError2},da=function(){return U.AccessDeniedMessage},ua=function(){return U.CellEditingMessage},ma=function(){return U.AnalyzeDataTooLargeError},ga=function(){return U.AnalyzeDataTooLargeErrorFourMillion},ha=function(){return"There's too much content for me to summarize. Reduce the number of rows and try again."},pa=function(){return"I've run into a problem. Try asking me again later"},ba=function(){return"I've run into a problem. Try asking another question."},fa=function(){return"LLM throttled. Wait and retry may help"},Ca=function(){return"LLM API issue. Wait and retry may help"},ya=function(){return"There is an error in the network connection. Please check your network connection and try again."},va=function(){return U.PromptMenuItemAddFormulaColumn},Ta=function(){return U.PromptMenuItemHighlightData},xa=function(){return U.PromptMenuItemSortFilter},Sa=function(){return U.PromptMenuItemAnalyzeData},wa=function(){return U.PromptMenuItemAnalyzeUsingPython},Ea=function(){return U.SuggestionPillOutliers},Ia=function(){return U.SuggestionPillCompareColumns},Ra=function(){return U.SuggestionPillBoldColumn},Aa=function(){return U.SuggestionPillHowMany},La=function(){return U.SuggestionPillCombineColumns},ka=function(){return U.SuggestionPillHighlightHighest},Fa=function(){return U.SuggestionPillShowItems},_a=function(){return U.SuggestionPillBold},Pa=function(){return U.SuggestionPillSortColumn},Na=function(){return U.ZeroQueryInsightsTitle},Ma=function(){return U.ZeroQueryFormulaActionTitle},Oa=function(){return U.ZeroQueryHighlightActionTitle},Da=function(){return U.ZeroQuerySearchTitle},Ba=function(){return U.ZeroQueryPythonTitle},$a=function(){return U.ZeroQueryPythonHeader},Ha=function(){return U.ZeroQueryEditPythonCodeTitle},Ua=function(){return U.ZeroQueryEditPythonCodeMessage},qa=function(){return U.ZeroQueryDataShapingHeader},Va=function(){return U.ZeroQueryDataShapingText},Wa=function(){return[U.ZeroQueryDataShapingText,U.ZeroQueryDataShapingText2,U.ZeroQueryDataShapingText3,U.ZeroQueryDataShapingText4,U.ZeroQueryDataShapingText5]},Ga=function(){return U.ZeroQueryHowToSumTitle},za=function(){return U.ZeroQueryHeaderAsk},Qa=function(){return U.ZeroQuerySuggestAColumnTitle},ja=function(){return U.ZeroQuerySuggestAColumnMessage},Ja=function(){return U.ZeroQueryWriteAFormulaTitle},Ya=function(){return U.ZeroQueryWriteAFormulaMessage},Xa=function(){return U.ZeroQueryAddAFormulaColumnTitle},Za=function(){return U.ZeroQueryAddAFormulaColumnMessage},Ka=function(){return U.ZeroQueryExplainAFormulaTitle},eo=function(){return U.ZeroQueryExplainAFormulaMessage},to=function(){return U.ZeroQueryInvestigateErrorTitle},no=function(){return U.ZeroQueryInvestigateErrorMessage},ao=function(){return U.ZeroQuerySplitColumnsTitle},oo=function(){return U.ZeroQuerySplitColumnsMessage},ro=function(){return U.ZeroQueryCreateTotalRowTitle},io=function(){return U.ZeroQueryCreateTotalRowMessage},lo=function(){return U.ZeroQueryWriteLookupFormulaTitle},so=function(){return U.ZeroQueryWriteLookupFormulaMessage},co=function(){return U.ZeroQueryGetDataInsightsTitle},uo=function(){return U.ZeroQueryGetDataInsightsMessage},mo=function(){return U.ZeroQueryGetDataInsightsAnswersMessage},go=function(){return U.ZeroQueryAdvancedAnalysisTitle},ho=function(){return U.SuggestionPillPythonAAText},po=function(){return U.ZeroQueryAdvancedAnalysisMessage},bo=function(){return U.ZeroQueryPerformForecastingTitle},fo=function(){return U.ZeroQueryPerformForecastingMessage},Co=function(){return U.ZeroQueryCreateBoxplotTitle},yo=function(){return U.ZeroQueryCreateBoxplotMessage},vo=function(){return U.ZeroQuerySetOfChartsTitle},To=function(){return U.ZeroQuerySetOfChartsMessage},xo=function(){return U.ZeroQueryGenerateWordCloudTitle},So=function(){return U.ZeroQueryGenerateWordCloudMessage},wo=function(){return U.ZeroQueryCreateATableTitle},Eo=function(){return U.ZeroQueryCreateATableMessage},Io=function(){return U.ZeroQueryKeyboardShortcutsTitle},Ro=function(){return U.ZeroQueryKeyboardShortcutsMessage},Ao=function(){return U.ZeroQueryTipsAndTricksTitle},Lo=function(){return U.ZeroQueryTipsAndTricksMessage},ko=function(){return U.ZeroQueryFreezeColumnMessage},Fo=function(){return U.ZeroQueryHowDoITitle},_o=function(){return U.ZeroQueryHowDoIDropdownMessage},Po=function(){return U.ZeroQuerySummarizeColumnTitle},No=function(){return U.ZeroQuerySummarizeColumnMessage},Mo=function(){return U.ZeroQueryShowDataInsightsTitle},Oo=function(){return U.ZeroQueryShowDataInsightsMessage},Do=function(){return U.ZeroQueryCreatePivotTableTitle},Bo=function(){return U.ZeroQueryCreatePivotTableMessage},$o=function(){return U.ZeroQueryCreatePieChartTitle},Ho=function(){return U.ZeroQueryCreatePieChartMessage},Uo=function(){return U.ZeroQueryGenerateAGraphTitle},qo=function(){return U.ZeroQueryGenerateAGraphMessage},Vo=function(){return U.ZeroQueryHighlightCellsTitle},Wo=function(){return U.ZeroQueryHighlightCellsMessage},Go=function(){return U.ZeroQueryApplyColorCodingTitle},zo=function(){return U.ZeroQueryApplyColorCodingMessage},Qo=function(){return U.ZeroQueryWebSearchCreateTableTitle},jo=function(){return U.ZeroQueryWebSearchCreateTableMessage},Jo=function(){return U.ZeroQueryWebSearchLearnTitle},Yo=function(){return U.ZeroQueryWebSearchLearnMessage},Xo=function(){return U.ZeroQueryImportTableTitle},Zo=function(){return U.ZeroQueryImportTableMessage},Ko=function(){return U.ZeroQueryPrepareForMeetingsTitle},er=function(){return U.ZeroQueryPrepareForMeetingsMessage},tr=function(){return U.ZeroQueryRecapEmailsTitle},nr=function(){return U.ZeroQueryRecapEmailsMessage},ar=function(){return U.PromptMenuItemHowCanCopilotHelp},or=function(){return U.LoadingTableLikeRangesWarning},rr=function(){return U.HintCardAnalyzeDataSuggestionHeader},ir=function(){return U.HintCardAnalyzeDataSuggestionMessage1},lr=function(){return U.HintCardAnalyzeDataSuggestionMessage2},sr=function(){return U.HintCardAnalyzeDataSuggestionMessage3},cr=function(){return U.HintCardAnalyzeDataSuggestionMessage4},dr=function(){return U.HintCardAnalyzeDataSuggestionMessage5},ur=function(){return U.HintCardMoonshotSuggestionHeader},mr=function(){return U.HintCardMoonshotSuggestionMessage1},gr=function(){return U.HintCardMoonshotSuggestionMessage2},hr=function(){return U.HintCardMoonshotSuggestionMessage3},pr=function(){return U.HintCardMoonshotSuggestionMessage4},br=function(){return U.HintCardFormatDataSuggestionHeader},fr=function(){return U.HintCardFormatDataSuggestionMessage1},Cr=function(){return U.HintCardFormatDataSuggestionMessage2},yr=function(){return U.HintCardFormatDataSuggestionMessage3},vr=function(){return U.HintCardFormatDataSuggestionMessage5},Tr=function(){return U.StopGeneratingResponseTableExplain},xr=function(){return U.StopGeneratingResponsePythonMode},Sr=function(){return V.ChatHistoryHydrationError},wr=function(){return V.TopicChangedResponseText},Er="https://support.microsoft.com/office/welcome-to-microsoft-365-copilot-in-excel-e5faf5c4-aa48-437a-b5b2-b35ac2c4a01b",Ir=function(){return U.LearnMoreResponsePrefix},Rr=function(){return U.LearnMoreResponseLinkText},Ar=function(){return[U.LearnMoreResponseContentFirst,U.LearnMoreResponseContentSecond,U.LearnMoreResponseContentThird]},Lr=function(){return W()?H(ExcelCopilotStringsNTier.ErrorScreenHeader):"We ran into an error."},kr=function(){return W()?H(ExcelCopilotStringsNTier.ErrorScreenInstruction):"Please reopen the Copilot pane to try again."},Fr=function(){return W()?H(ExcelCopilotStringsNTier.ErrorScreenReopenButton):"Reopen"},_r=function(){return U.CommandingUndoWarningSuffix},Pr=function(){return"I am about to perform the following actions:"},Nr=function(){return"For {0}:"},Mr=function(){return U.CommandingUndoWarningConfirm},Or=function(){return U.CommandingUndoWarningReject},Dr=function(){return U.CommandingExplanationPrefix},Br=function(){return U.OfficeJSResponseExplain},$r=function(){return U.OfficeJSErrorExplanationPrefix},Hr=function(){return U.OfficeJSExplanationPrefix},Ur=function(){return U.OfficeJSSimpleSuccessResponse},qr="https://aka.ms/copilotlicensecheck",Vr="https://aka.ms/copilotlicensecheck",Wr=function(){return U.CopilotLicenseHelpPrefix},Gr=function(){return U.OfficeScriptSaveScriptFailPrefix},zr=function(){return"I was not able to find an Office Script called '{0}'"},Qr=function(){return"Something went wrong while trying to schedule your script"},jr=function(){return"Sure, I've created an Office Script called '{0}' to automate your previous requests. Click \"Save Script\" to keep it for future use."},Jr=function(){return"Schedule script '{0}' to run:"},Yr=function(){return"Sure. Based on your automation request, here is an option for you."},Xr=function(){return"Starting"},Zr=function(){return"Repeat every"},Kr=function(){return"I cannot run the script '{0}' for you. Please run it manually in Automate tab."},ei=function(){return"Done! I saved your Office Script."},ti=function(){return"You can find it in the Gallery in the Automate tab to re-run later."},ni=function(){return"View Script"},ai=function(){return"Save Script"},oi=function(){return"Script name: '{0}'"},ri=function(){return"Delete Script"},ii=function(){return"I'm unable to delete your script '{0}'. Please try again later or delete it from the {1} folder in your OneDrive."},li=function(){return'"Office Scripts"'},si=function(){return"Sure, I've deleted script '{0}'."},ci=function(){return"Confirm or edit the flow"},di=function(){return"Script"},ui=function(){return"Your automation has been scheduled successfully."},mi=function(){return"The response is too large to be displayed. Please try a smaller dataset."},gi=function(){return"Similar cells referenced"},hi="EnterpriseSearch",pi="BingWebSearch",bi="acquired",fi={menuTitle:()=>U.PromptGuideMenuTitle,menuSectionCreate:()=>U.PromptGuideMenuSelectionCreate,menuSectionUnderstand:()=>U.PromptGuideMenuSelectionUnderstand,menuSectionEdit:()=>U.PromptGuideMenuSelectionEdit,menuSectionAsk:()=>U.OfficeScriptSaveScriptFailPrefixAsk,viewMorePrompts:()=>U.PromptGuideViewMorePrompts},Ci={generateFormulaColumnSuggestion:()=>U.PromptGuideMenuSectionItemGenerateFormulaColumnSuggestion,addAColumnThatCombines:()=>U.PromptGuideMenuSectionItemAddAColumnThatCombines,addAColumnToExtract:()=>U.PromptGuideMenuSectionItemAddAColumnToExtract,addAColumnThatCalculates:()=>U.PromptGuideMenuSectionItemAddAColumnThatCalculates},yi={showDataInsights:()=>U.PromptGuideMenuSectionItemShowDataInsights,percentageCalculation:()=>U.PromptGuideMenuSectionItemPercentageCalculation,howManyDifferent:()=>U.PromptGuideMenuSectionItemHowManyDifferent,whichItems:()=>U.PromptGuideMenuSectionItemWhichItems},vi={highlight:()=>U.PromptGuideMenuSectionItemHighlight,sort:()=>U.PromptGuideMenuSectionItemSort,filter:()=>U.PromptGuideMenuSectionItemFilter,applyRYG:()=>U.PromptGuideMenuSectionItemApplyRYG},Ti={help:()=>ar()},xi=function(){return U.MicrophonePermissionErrorTitleWeb},Si=function(){return U.MicrophonePermissionErrorTextWeb},wi=function(){return U.MicrophonePermissionErrorTitleWin32},Ei=function(){return U.MicrophonePermissionErrorTextWin32},Ii=function(){return W()?H(ExcelCopilotStringsNTier.CopilotNotAvailableInYourLanguageOthersSupported):"Copilot isn't available in your language yet. For now, you can try Copilot in English."},Ri=function(){return W()?H(ExcelCopilotStringsNTier.LearnMoreLinkText):"Learn more"},Ai="https://go.microsoft.com/fwlink/?linkid=2247434",Li=6e4,ki=3e6,Fi=function(e){return(0,o.k64)()?e>1?U.CommandingHumanInTheLoopMultipleChangesResponseMessage:U.CommandingHumanInTheLoopSingleChangeResponseMessage:"Done! I made the following changes in range {0}:"},_i=function(e){return(0,o.k64)()?e>1?U.CommandingHumanInTheLoopMultipleChangesNoRangeResponseMessage:U.CommandingHumanInTheLoopSingleChangeNoRangeResponseMessage:"Done! I made the following changes:"},Pi=function(){return"Here's a {0} that shows an insight about your data."},Ni=function(){return"Here's a {0} based on your prompt."},Mi=function(){return"This {0} may include some of the information you're looking for. If it doesn't show everything you requested, try another prompt."},Oi=function(){return"I looked through your data for this criteria: {0}. There were no matches. If you want to try again, use another prompt."},Di=function(){return"I looked through your data for this criteria: {0}. There are no matches."},Bi=function(){return["chart","PivotChart","PivotTable","formula"]},$i=function(){return"a Map Chart"},Hi=function(){return"a Scatter Chart"},Ui=function(){return"a Clustered Combo Chart"},qi=function(){return"a Stacked Combo Chart"},Vi=function(){return"a Hundred Percent Combo Chart"},Wi=function(){return"a Funnel Chart"},Gi=function(){return"a Treemap Chart"},zi=function(){return"a Sunburst Chart"},Qi=function(){return"a Color Filled Map Chart"},ji=function(){return"a Circular Treemap Chart"},Ji=function(){return"a Heat Map Chart"},Yi=function(){return"a Waterfall Chart"},Xi=function(){return"a Rose Chart"},Zi=function(){return"a Network Map Chart"},Ki=function(){return"a Smooth Line Chart"},el=function(){return"a Combo Chart"},tl=function(){return"a Line Chart"},nl=function(){return"a Pie Chart"},al=function(){return"a Donut Chart"},ol=function(){return"an Area Chart"},rl=function(){return"a Stacked Area Chart"},il=function(){return"a Hundred Percent Stacked Area Chart"},ll=function(){return"a Clustered Bar Chart"},sl=function(){return"a Stacked Bar Chart"},cl=function(){return"a Hundred Percent Stacked Bar Chart"},dl=function(){return"a Clustered Column Chart"},ul=function(){return"a Stacked Column Chart"},ml=function(){return"a Hundred Percent Stacked Column Chart"},gl=function(){return"that type of chart"},hl=function(){return U.PrePythonModeErrorText},pl=function(){return U.PythonCellsStartAnalysisError},bl=function(){return W()?H(ExcelCopilotStringsNTier.PythonUnsupportedLocaleErrorText):"I'm still working to support other languages when I help you with Python. For now, please try your prompt again in English."},fl=function(){return U.PythonInsertProtectedSheetErrorText},Cl=function(){return U.PythonInsertObjectProtectedSheetErrorText},yl=function(){return W()?ExcelCopilotStringsNTier.PythonPlatformErrorTextWithLink:"Python in Excel is only available for Excel for Windows. {0}."},vl=function(){return W()?ExcelCopilotStringsNTier.PythonAvailabilityErrorTextWithLink:"Python in Excel isn't available. {0}"},Tl=function(){return W()?ExcelCopilotStringsNTier.PythonPrerequisiteValidationErrorLinkText:"View more information"},xl="https://go.microsoft.com/fwlink/?linkid=2279837",Sl=function(){return U.PythonStartAnalysisEditModeErrorText},wl=function(){return U.PythonGenericEditModeErrorText},El=function(){return U.PythonRestartRuntimeErrorText},Il=function(){return U.PythonBusyStateErrorText},Rl=function(){return U.PythonAnalysisSheetWasDeletedDuringGenerationErrorText},Al=function(){return U.PythonCodeRetryMaximumHitErrorText},Ll=function(){return U.PythonAugloopCallsPerQueryMaximumHitErrorText},kl=function(){return U.PythonGeneralErrorTextWithLink},Fl=function(){return U.PythonGeneralErrorLinkText},_l="https://go.microsoft.com/fwlink/?linkid=2281206",Pl=function(){return U.PythonNoSuggestionGenericErrorText},Nl=function(){return U.PythonWorkbookLostFocusError},Ml=function(){return U.PythonExecutionBlockedByAdminText},Ol=function(){return U.PythonAugloopLlmLoopLimitHitMessage},Dl=function(){return U.PythonElseFallbackMessage},Bl=function(){return U.PythonCodeRetryResponseWithAddressText},$l=function(){return U.PythonCodeDefaultErrorMessage},Hl=function(){return U.PythonCodeButtonRoleDescription},Ul=function(){return U.PythonStartAnalysisHeaderTextFirst30s},ql=function(){return[U.PythonRunningCodeText]},Vl=function(e){return e&&""!==e?U.PythonStartAnalysisFirstBulletTextWithExistingSheet.replace("{sheet}",e):U.PythonStartAnalysisFirstBulletText},Wl=function(){return U.PythonStartAnalysisSecondBulletText},Gl=function(){return U.PythonStartAnalysisThirdBulletText},zl=function(){return U.PythonStartAnalysisFourthBulletText},Ql=function(){return U.PythonStartAnalysisFooterText},jl=function(){return U.PythonStartAnalysisButtonTextFirst30s},Jl=function(){return U.PythonExistAnalysisConfirmationText},Yl=function(){return U.PythonStartAnalysisRAIErrorText},Xl=function(){return U.PythonErrorTryAgainSuggestionPillText},Zl=function(){return q.PythonAnalysisSheetNameText},Kl=function(){return U.PythonAnalysisSheetHeaderTextFirst30s},es=function(){return U.PythonAnalysisSheetDescriptionText},ts=function(){return U.PythonAnalysisSheetWasDeletedBeforeGenerationText},ns=function(){return U.PythonDetailSheetNameText},as=function(){return U.PythonAddResultsToAnotherSheetConfirmationText},os=function(){return U.PythonGoBackToAnalysisSheetButtonText},rs=function(){return U.PythonAddResultsToAnotherSheetErrorText},is=function(){return U.PythonAddResultsToAnotherSheetButtonText},ls=function(){return U.PythonPostviewHeaderText},ss=function(){return U.PythonPostviewLoadingHeaderText},cs=function(){return U.PythonPostviewNotSupportedText},ds=function(){return U.PythonPostviewImageUnavailableText},us=function(){return U.PythonRowsText},ms=function(){return U.PythonColumnsText},gs=function(){return U.PythonBlankText},hs=function(){return U.PythonUnknownText},ps=function(){return U.PythonLabelFallbackText},bs=function(){return U.PythonDataframeLabelText},fs=function(){return U.PythonDataframeCodeExplanationText},Cs=function(){return U.PythonPreviewLabelText},ys=function(){return U.PythonSuggestMoreIdeasPill},vs=function(){return U.PythonWhatElseCanIDoPill},Ts=function(){return U.PythonDataframeTeachingCalloutHeaderText},xs=function(){return U.PythonDataframeTeachingCalloutBodyText},Ss=function(){return U.PythonThinkDeeperButtonTitleText},ws=function(){return U.PythonThinkDeeperButtonTooltipText},Es=function(){return U.PythonThinkDeeperStartAnalysisButtonText},Is=function(){return U.PythonStartWithThinkDeeperButtonText},Rs=function(){return U.PythonThinkDeeperStartingText},As=function(){return U.PythonInsertToSheetButtonText},Ls=function(){return U.PythonInsertDataConfirmationMessage},ks=function(){return U.PythonFormulaText},Fs=function(){return U.PythonFormulaSecondaryText},_s=function(){return U.PythonShowAnalysisText},Ps=function(){return U.PythonHideAnalysisText},Ns=function(){return U.PythonOutputText},Ms=function(){return U.PythonTableExpand},Os=function(){return U.PythonTableCollapse},Ds=function(){return U.PythonLargeDataMessage},Bs=function(){return"Insert Python column"},$s=function(){return"Sorry, something went wrong with Python calculated columns. Try your request again later."},Hs=function(){return"Done! I inserted the new Python column to column {0}."},Us=function(){return"I can't insert any Python columns because it looks like no table is selected. Double check to make sure a table is selected and try again."},qs=function(){return"Whoops! This code generated a {0} error. Please try again later."},Vs=function(){return"Whoops! This feature only works on formatted tables. Please format your data as an Excel table and try again. (Hint: select the table and run CTRL+T)"},Ws=function(){return"My query was cancelled."},Gs=function(){return"I succeeded in my task."},zs=function(){return"I failed in my task."},Qs=function(){return U.AnalyzeDataCardHeader},js=function(){return U.AnalyzeDataCardHeaderWithSheet},Js=function(){return W()?ExcelCopilotStringsNTier.ChartTypeArea:"Area"},Ys=function(){return W()?ExcelCopilotStringsNTier.ChartTypeAreaStacked:"Stacked Area"},Xs=function(){return W()?ExcelCopilotStringsNTier.ChartTypeAreaStacked100:"100% Stacked Area"},Zs=function(){return W()?ExcelCopilotStringsNTier.ChartTypeBarClustered:"Clustered Bar"},Ks=function(){return W()?ExcelCopilotStringsNTier.ChartTypeBarStacked:"Stacked Bar"},ec=function(){return W()?ExcelCopilotStringsNTier.ChartTypeBarStacked100:"100% Stacked Bar"},tc=function(){return W()?ExcelCopilotStringsNTier.ChartTypeColumnClustered:"Clustered Column"},nc=function(){return W()?ExcelCopilotStringsNTier.ChartTypeColumnStacked:"Stacked Column"},ac=function(){return W()?ExcelCopilotStringsNTier.ChartTypeColumnStacked100:"100% Stacked Column"},oc=function(){return W()?ExcelCopilotStringsNTier.ChartTypeLine:"Line"},rc=function(){return W()?ExcelCopilotStringsNTier.ChartTypeLineStacked:"Stacked Line"},ic=function(){return W()?ExcelCopilotStringsNTier.ChartTypeLineStacked100:"100% Stacked Line"},lc=function(){return W()?ExcelCopilotStringsNTier.ChartTypeDoughnut:"Doughnut"},sc=function(){return W()?ExcelCopilotStringsNTier.ChartTypePie:"Pie"},cc=function(){return W()?ExcelCopilotStringsNTier.ChartTypeScatter:"Scatter"},dc=function(){return W()?ExcelCopilotStringsNTier.ChartTypeHistogram:"Histogram"},uc=function(){return W()?ExcelCopilotStringsNTier.ChartTypeBubble:"Bubble"},mc=function(){return W()?ExcelCopilotStringsNTier.ThousandsUnitsLabel:"Thousands"},gc=function(){return W()?ExcelCopilotStringsNTier.MillionsUnitsLabel:"Millions"},hc=function(){return W()?ExcelCopilotStringsNTier.BillionsUnitsLabel:"Billions"},pc=function(){return W()?ExcelCopilotStringsNTier.TrillionsUnitsLabel:"Trillions"},bc=function(){return W()?ExcelCopilotStringsNTier.BlankCellValue:"(blank)"},fc=function(){return W()?ExcelCopilotStringsNTier.XAxisDescriptor:"X"},Cc=function(){return W()?ExcelCopilotStringsNTier.YAxisDescriptor:"Y"},yc=function(){return W()?ExcelCopilotStringsNTier.PrimaryXAxisDescriptor:"Primary X-Axis"},vc=function(){return W()?ExcelCopilotStringsNTier.PrimaryYAxisDescriptor:"Primary Y-Axis"},Tc=function(){return W()?ExcelCopilotStringsNTier.SecondaryXAxisDescriptor:"Secondary X-Axis"},xc=function(){return W()?ExcelCopilotStringsNTier.SecondaryYAxisDescriptor:"Secondary Y-Axis"},Sc=function(){return W()?ExcelCopilotStringsNTier.SumAggregationLabel:"Sum"},wc=function(){return W()?ExcelCopilotStringsNTier.AverageAggregationLabel:"Average"},Ec=function(){return W()?ExcelCopilotStringsNTier.CountAggregationLabel:"Count"},Ic=function(){return W()?ExcelCopilotStringsNTier.MinAggregationLabel:"Min"},Rc=function(){return W()?ExcelCopilotStringsNTier.MaxAggregationLabel:"Max"},Ac=function(){return W()?ExcelCopilotStringsNTier.StdDevAggregationLabel:"StdDev"},Lc=function(){return W()?ExcelCopilotStringsNTier.VarAggregationLabel:"Var"},kc=function(){return W()?ExcelCopilotStringsNTier.PivotTableRowLabels:"Row Labels"},Fc=function(){return W()?ExcelCopilotStringsNTier.PivotTableColumnLabels:"Column Labels"},_c=function(){return W()?ExcelCopilotStringsNTier.PivotTableGrandTotal:"Grand Total"},Pc=function(){return W()?ExcelCopilotStringsNTier.ConcatenatedAriaLabel:"{0}, {1}"},Nc=function(){return W()?ExcelCopilotStringsNTier.ChartTypeAlternativeText:"Chart type: {0}."},Mc=function(){return W()?ExcelCopilotStringsNTier.ComboChartTypeAlternativeText:"Chart type: Combo: {0}; {1}."},Oc=function(){return W()?ExcelCopilotStringsNTier.AltTextDisclaimer:"Description automatically generated"},Dc=function(){return W()?ExcelCopilotStringsNTier.PivotTableDataFieldHeader:"{0} of {1}"},Bc=function(){return W()?ExcelCopilotStringsNTier.PivotTableGrandTotalWithDataField:"Total {0} of {1}"},$c=function(){return W()?ExcelCopilotStringsNTier.PivotTableSubtotalWithDataField:"{0} {1} of {2}"},Hc=function(){return W()?ExcelCopilotStringsNTier.TransformedColumnName:"{0}{1}"},Uc=function(){return W()?ExcelCopilotStringsNTier.FieldTitle:"Field{0}"},qc=function(){return W()?ExcelCopilotStringsNTier.SubtitleNameUnits:"{0} ({1})"},Vc=function(){return W()?ExcelCopilotStringsNTier.SubtitleNameUnits2:"{0} ({1}); {2} ({3})"},Wc=function(){return W()?ExcelCopilotStringsNTier.SubtitleWithSemicolon:"{0}; "},Gc=function(){return W()?ExcelCopilotStringsNTier.SubtitleUnits:"({0})"},zc=function(){return W()?ExcelCopilotStringsNTier.AddPeriodToText:"{0}."},Qc=function(){return W()?ExcelCopilotStringsNTier.SeriesCountAlternativeText:"{0} series."},jc=function(){return W()?ExcelCopilotStringsNTier.DatapointCountAlternativeText:"Series {0}: {1} datapoints."},Jc=function(){return W()?ExcelCopilotStringsNTier.PrimaryHorizontalAxisAlternativeText:"Primary Horizontal axis title: {0}."},Yc=function(){return W()?ExcelCopilotStringsNTier.PrimaryVerticalAxisAlternativeText:"Primary Vertical axis title: {0}."},Xc=function(){return W()?ExcelCopilotStringsNTier.SecondaryHorizontalAxisAlternativeText:"Secondary Horizontal axis title: {0}."},Zc=function(){return W()?ExcelCopilotStringsNTier.SecondaryVerticalAxisAlternativeText:"Secondary Vertical axis title: {0}."},Kc=function(){return W()?ExcelCopilotStringsNTier.XAxisAlternativeText:"X axis title: {0}."},ed=function(){return W()?ExcelCopilotStringsNTier.YAxisAlternativeText:"Y axis title: {0}."},td=function(){return W()?ExcelCopilotStringsNTier.PivotTableSingleRowTitle:"{0} as row"},nd=function(){return W()?ExcelCopilotStringsNTier.PivotTableTwoRowTitle:"{0} and {1} as rows"},ad=function(){return W()?ExcelCopilotStringsNTier.PivotTableColumnTitle:"{0} as column"},od=function(){return W()?ExcelCopilotStringsNTier.PivotTableDataTitle:"{0} as values"},rd=function(){return W()?ExcelCopilotStringsNTier.PivotTableSubtotal:"{0} Total"},id="This code was made by Copilot for your specific needs. Please review it before you use it in another workbook.",ld=function(){return U.CommandingHumanInTheLoopSingleEventHeader},sd=function(){return U.CommandingHumanInTheLoopSingleEventHeaderWithSheet},cd=function(){return U.CommandingHumanInTheLoopMultipleEventsHeader},dd=function(){return U.CommandingHumanInTheLoopMultipleEventsHeaderWithSheet},ud=function(){return U.CommandingHumanInTheLoopSingleCFEventHeader},md=function(){return U.CommandingHumanInTheLoopSingleCFEventHeaderWithSheet},gd=function(){return U.CommandingHumanInTheLoopMultipleCFEventsHeader},hd=function(){return U.CommandingHumanInTheLoopMultipleCFEventsHeaderWithSheet},pd=function(){return U.ImportDataCardHeaderMultipleTables},bd=function(){return U.ImportDataCardHeaderSingleTable},fd=function(){return U.ImportDataCardHeaderFallbackShowAll},Cd=function(){return U.ImportDataCardHeaderSomeFiltered},yd=function(){return U.FluxWorkflowCancelledMessage},vd=function(){return U.ImportDataStaticSuggestionButtonText},Td=function(){return U.ImportDataImportToNewSheet},xd=function(){return U.ImportDataSuccessButtonText},Sd=function(){return U.ImportDataQuerySnippetTitle},wd=function(){return U.ImportDataCaruselText},Ed=function(){return U.ImportDataCaruselNext},Id=function(){return U.ImportDataCaruselPrevious},Rd=function(){return U.ImportDataExcelFileTooltip},Ad=function(){return U.ImportDataQueryExplanation},Ld=function(){return U.ImportDataShowImportQuery},kd=function(){return U.ImportDataHideImportQuery},Fd=function(){return[U.ImportDataPrepareImportOptions1]},_d=function(){return[U.ImportDataPrepareImportOptions2]},Pd=function(){return[U.ImportDataToGridOption1]},Nd=function(){return U.ImportDataLoadQueryAddedToDocumentMessageNoBindingText},Md=function(){return U.ImportDataNoTableFoundMessageText},Od=function(){return U.ImportDataNoTableFoundAndSomeFilteredMessageText},Dd=function(){return U.ImportDataFailureGeneralMessageText},Bd=function(e){return e?q.SuggestionPillConditionalFormatting:U.SuggestionPillConditionalFormatting},$d=function(){return U.ConditionalFormattingSuggestionResponse},Hd=function(){return U.ConditionalFormattingSuggestionResponseWithSheet},Ud=function(){return U.ConditionalFormattingSuggestionResponseError},qd=function(){return U.ConditionalFormattingSuggestionResponseNoSuggestionForRange},Vd=function(){return U.ConditionalFormattingSuggestionResponseNoTable},Wd=function(){return U.ConditionalFormatFormulaInvalidErrorText},Gd=function(){return U.UnsupportedConditionalFormatEntityRangeText},zd=function(){return U.ActionButtonApply};var Qd;!function(e){e.CopilotChat="copilotChat",e.Reviewer="reviewerAgent",e.DirectSkill="directSkill",e.DevTools="devTools",e.AugloopDiagnostics="augloopDiagnostics",e.AugloopModelVisualizer="augloopModelVisualizer"}(Qd||(Qd={}));const jd={copilotChat:"Copilot",reviewerAgent:"Reviewer",directSkill:"Direct Skill",devTools:"Dev tools",augloopDiagnostics:"Augloop Diagnostics",augloopModelVisualizer:"Augloop Model Visualizer"},Jd=()=>V.CseSelfHelpSkillContentRetrievedQuickAnswer,Yd=()=>V.CseSelfHelpSkillContentRetrievedSingleArticle,Xd=()=>V.CseSelfHelpSkillErrorOrNoContentRetrieved,Zd=()=>U.CseSelfHelpSkillSourceLabel,Kd=()=>V.ChatInputCharacterLimitExceededMessage,eu=()=>U.ODSLGeneralError,tu=function(){return U.ServerErrorWithNoRetry},nu=()=>U.ElseSkillGeneralError,au=()=>U.FallbackSkillLatencyMessage,ou=()=>U.AugLoopSearchAndActionError,ru=()=>U.AugLoopSearchAndActionErrorImproved,iu=()=>U.AugLoopImageChatError,lu=()=>U.AugLoopNoTableError,su=()=>U.AugLoopNoTableError2,cu=()=>W()?ExcelCopilotStringsNTier.PromptFormulaErrorValueFormula:"How do I fix the #VALUE! error in my table when using the {formula} formula?",du=()=>W()?ExcelCopilotStringsNTier.PromptFormulaErrorValue:"How do I fix the #VALUE! error in my table?",uu=()=>W()?ExcelCopilotStringsNTier.PromptFormulaErrorNameFormula:"How do I fix the #NAME! error in my table when using the {formula} formula?",mu=()=>W()?ExcelCopilotStringsNTier.PromptFormulaErrorName:"How do I fix the #NAME! error in my table?",gu=()=>W()?ExcelCopilotStringsNTier.PromptFormulaErrorRefFormula:"How do I fix the #REF! error in my table when using the {formula} formula?",hu=()=>W()?ExcelCopilotStringsNTier.PromptFormulaErrorRef:"How do I fix the #REF! error in my table?",pu=()=>W()?ExcelCopilotStringsNTier.PromptFormulaErrorSpillFormula:"How do I fix the #SPILL! error in my table when using the {formula} formula?",bu=()=>W()?ExcelCopilotStringsNTier.PromptFormulaErrorSpill:"How do I fix the #SPILL! error in my table?",fu=()=>W()?ExcelCopilotStringsNTier.PromptFormulaErrorDiv0Formula:"How do I fix the #DIV/0! error in my table when using the {formula} formula?",Cu=()=>W()?ExcelCopilotStringsNTier.PromptFormulaErrorDiv0:"How do I fix the #DIV/0! error in my table?",yu=()=>W()?ExcelCopilotStringsNTier.PromptFormulaErrorNumFormula:"How do I fix the #NUM! error in my table when using the {formula} formula?",vu=()=>W()?ExcelCopilotStringsNTier.PromptFormulaErrorNum:"How do I fix the #NUM! error in my table?",Tu=()=>W()?ExcelCopilotStringsNTier.PromptFormulaErrorCalcFormula:"How do I fix the #CALC! error in my table when using the {formula} formula?",xu=()=>W()?ExcelCopilotStringsNTier.PromptFormulaErrorCalc:"How do I fix the #CALC! error in my table?",Su=()=>W()?ExcelCopilotStringsNTier.PromptFormulaErrorNAFormula:"How do I fix the #N/A error in my table when using the {formula} formula?",wu=()=>W()?ExcelCopilotStringsNTier.PromptFormulaErrorNA:"How do I fix the #N/A error in my table?",Eu=()=>W()?ExcelCopilotStringsNTier.PromptNumbersStoredAsText:"How do I convert numbers stored as text to numbers?",Iu=()=>W()?ExcelCopilotStringsNTier.PromptSortData:"How do I sort data?",Ru=()=>W()?ExcelCopilotStringsNTier.PromptFormatNumbers:"How do I format numbers in Excel?",Au=()=>W()?ExcelCopilotStringsNTier.PromptWrapText:"How do I wrap text in a cell?",Lu=()=>W()?ExcelCopilotStringsNTier.PromptApplyDataValidation:"How do I apply data validation to cells?",ku=()=>W()?ExcelCopilotStringsNTier.PromptFilerData:"How do I filter data in a table?",Fu=()=>W()?ExcelCopilotStringsNTier.PromptMergeCells:"How do I merge and unmerge cells?",_u=()=>W()?ExcelCopilotStringsNTier.PromptAccessibilityChecker:"How do I improve accessibility with the accessibility checker?",Pu=()=>W()?ExcelCopilotStringsNTier.PromptConditionalFormattingHighlighting:"How do I use conditional formatting to highlight information?",Nu=()=>W()?ExcelCopilotStringsNTier.PromptSplitText:"How do I spilt text into different columns?",Mu=()=>W()?ExcelCopilotStringsNTier.PromptPageBreaks:"How do I insert, move, or delete page breaks?",Ou=()=>W()?ExcelCopilotStringsNTier.PromptInsertDeleteRowsColumns:"How do I insert or delete rows and columns?",Du=()=>W()?ExcelCopilotStringsNTier.PromptInconsistentFormulaFormula:"How do I fix the inconsistent formula in my table when using the {formula} formula?",Bu=()=>W()?ExcelCopilotStringsNTier.PromptInconsistentFormula:"How do I fix the inconsistent formula in my table?",$u=()=>W()?ExcelCopilotStringsNTier.PromptUnprotectedFormulaFormula:'How do I fix the "Unprotected Formula" error when using the {formula} formula?',Hu=()=>W()?ExcelCopilotStringsNTier.PromptUnprotectedFormula:'How do I fix the "Unprotected Formula" error?',Uu=()=>W()?ExcelCopilotStringsNTier.PromptInconsistentCalculatedColumnFormula:"How do I fix the inconsistent calculated column error when using {formula} formula?",qu=()=>W()?ExcelCopilotStringsNTier.PromptInconsistentCalculatedColumn:"How do I fix the inconsistent calculated column error?",Vu=()=>U.TabularRangeUnrecognizedTableError,Wu=()=>U.TabularRangeUnrecognizedTableDueToWorkbookSizeError,Gu=()=>U.TabularRangeRowMajorSingleError,zu=()=>U.TabularRangeRowMajorMultipleError,Qu=()=>U.TabularRangeRowMajorErrorHeader,ju=()=>U.TabularRangeMergedCellsSingleError,Ju=()=>U.TabularRangeMergedCellsMultipleError,Yu=()=>U.TabularRangeMergeCellsErrorHeader,Xu=()=>U.TabularRangeAggregationsSingleError,Zu=()=>U.TabularRangeAggregationsMultipleError,Ku=()=>U.TabularRangeAggregationsErrorHeader,em=()=>U.TabularRangeMultipleHeaderRowsSingleError,tm=()=>U.TabularRangeMultipleHeaderRowsMultipleError,nm=()=>U.TabularRangeMultipleHeaderRowsErrorHeader,am=()=>U.TabularRangeNoHeaderColumnsSingleError,om=()=>U.TabularRangeNoHeaderColumnsMultipleError,rm=()=>U.TabularRangeNoHeaderColumnsErrorHeader,im=()=>U.TabularRangeInterpretationConfidenceSingleError,lm=()=>U.TabularRangeInterpretationConfidenceMultipleError,sm=()=>U.TabularRangeInterpretationConfidenceErrorHeader,cm=()=>U.TabularRangeEmptyHeadersSingleError,dm=()=>U.TabularRangeEmptyHeadersMultipleError,um=()=>U.TabularRangeEmptyHeadersErrorHeader,mm=()=>U.TabularRangeDuplicateHeadersSingleError,gm=()=>U.TabularRangeDuplicateHeadersMultipleError,hm=()=>U.TabularRangeDuplicateHeadersErrorHeader,pm=()=>U.TabularRangeCrosstabSingleError,bm=()=>U.TabularRangeCrosstabMultipleError,fm=()=>U.TabularRangeCrosstabErrorHeader,Cm=()=>U.TabularRangeMultipleErrorCardIntro,ym=()=>U.TabularRangeMultipleErrorCardConclusion,vm=()=>U.TabularRangeMultipleErrorCardConvertToTableConclusion,Tm=()=>U.TLRTooSmallMessage,xm=()=>W()?ExcelCopilotStringsNTier.PromptPythonError:'Help with the Python error "{error}"',Sm=function(){return(0,o.k64)()&&(0,o.yw9)("OfficeVSO_9196996_LocalizeMultipleEventsError")?U.MultipleEventsExecutionErrorText:"I couldn't finish your request. If something isn't right, use Undo to remove my changes."},wm=function(){return void 0!==ExcelCopilotCommandingHitlStrings?ExcelCopilotCommandingHitlStrings.TableClearSortLabel:"Remove sorting on table ${tableName}"},Em=()=>"Qtr1",Im=()=>"Qtr2",Rm=()=>"Qtr3",Am=()=>"Qtr4",Lm=()=>"Jan",km=()=>"Feb",Fm=()=>"Mar",_m=()=>"Apr",Pm=()=>"May",Nm=()=>"Jun",Mm=()=>"Jul",Om=()=>"Aug",Dm=()=>"Sep",Bm=()=>"Oct",$m=()=>"Nov",Hm=()=>"Dec",Um=function(){return"Sorry, I can't do multiple things at once. For the best experience, add one request at a time."},qm=function(){return"I'm not able to make changes in those cells because they're outside of the Excel Table. Try making changes to cells inside of the Excel Table."},Vm=function(){return"I can only modify table structures relative to the visible cells in your table. Please unhide cells, clear filters, or phrase your prompt using a target location relative to the visible cells. If you need further assistance, let me know."},Wm=function(){return"I can't make those changes at the same time. The order of the changes would impact the cell locations and effect the target locations of the next changes. Please separate your changes into independent prompts, and try them again."},Gm=function(){return"I couldn't complete your request. Please restate the part of your request that needs to be finished."},zm=function(){return"I couldn't create {0}, but here's an answer that may be helpful."},Qm=function(){return"I need more practice before I can do that. For now, I'll share the steps you can follow."},jm=function(){return"Want to undo?  Here's how:"},Jm=function(){return'Select "Home" > "Undo"'},Ym=function(){return'Press "Ctrl"+ "Z" on your keyboard'},Xm=function(){return'Press "CMD"+ "Z" on your keyboard'},Zm=function(){return"Want to add alternative text (alt text) to this table? Here's how:"},Km=function(){return"Right-click on the table."},eg=function(){return'Select "Table" > "Alt Text".'},tg=function(){return'Select "Table" > "Alternative Text".'},ng=function(){return"Want to add a comment? Here's how:"},ag=function(){return"Right-click on the cell."},og=function(){return'Select "New Comment".'},rg=function(){return"Enter your comment and mention people who need to view it if needed."},ig=function(){return'Select "Post".'},lg=function(){return"Want to apply data validation to cells? Here's how: "},sg=function(){return"Select one or more cells you want to create a rule for."},cg=function(){return'Select "Data" > "Data Validation".'},dg=function(){return'On the "Settings" tab, under Allow, select an option.'},ug=function(){return"Enter information for additional settings."},mg=function(){return'Select "Error Alert" to customize the error message.'},gg=function(){return'Select "OK".'},hg=function(){return"Want to create a pivot table? Here's how:"},pg=function(){return"Select the cells you want to use to create the pivot table."},bg=function(){return'Select "Insert" > "PivotTable" > "Select a table or range".'},fg=function(){return"Make sure the cell range is correct."},Cg=function(){return'Select "New Woksheet" or "Existing Worksheet" to set where you want the pivot table to appear. '},yg=function(){return'Select "OK".'},vg=function(){return"Want to add, delete, or rename a worksheet?"},Tg=function(){return'To add a worksheet: Select the "New Sheet" icon or "Home" > "Insert" > "Insert Sheet".'},xg=function(){return'To delete a worksheet: Right-click the "Sheet" tab and select "Delete" or "Home" > "Delete" > "Delete Sheet".'},Sg=function(){return'To rename a worksheet: Double-click the name on the "Sheet" tab. You can also right-click on the "Sheet" tab, select "Rename", and type a new name.'},wg=function(){return"Want to freeze rows or columns?  Here's how:"},Eg=function(){return"Select the cell below the rows, and to the right of the columns you want to freeze."},Ig=function(){return'Select "View" > "Freeze Panes" > "Freeze Panes". Or, choose another option depending on what you want to freeze.'},Rg=function(){return"I can't insert a table into the sheet. However, I can try to help you using a table that's already in the sheet."},Ag=function(){return"I don't currently have a way to know which cells you selected. Please specify the cells, columns, or rows you want me to work with."},Lg=function(){return"Sorry, I can't remove sorting from the table. Please tell me how you'd like to sort the table, or make a new request."},kg=function(){return"Sorry, I can't apply conditional formatting to this range. Make sure it includes accounting, currency, fraction, number, percentage, or scientific formatting and try again."},Fg=function(){return"Sorry, I can't apply conditional formatting to this range. Make sure it includes a date or time format and try again."},_g=function(){return"Sorry, I can't apply conditional formatting to this range. Make sure it includes a text, special, date, or time format and try again."},Pg=function(){return"Sorry, I can't apply conditional formatting to this range. Remove any general, custom, or text formatting for the range and try again."},Ng=function(){return"Sorry, I can't apply a numeric filter (greater than, less than, between, or their negations) to a column that's not numeric. Make sure it doesn't contain text or true/false data, and try again."},Mg=function(){return"Sorry, I can't apply a text filter (begins with, ends with, contains, or their negations) to a column that's not textual. Make sure it doesn't contain numeric or true/false data, and try again."},Og=function(){return"Sorry, I can't delete the row(s). Is there anything else I can help you with?"},Dg=function(){return"Sorry, I can't modify the column(s). Is there anything else I can help you with?"},Bg=function(){return"Sorry, I can't modify the entity. Make sure the correct entity is selected and try again."},$g=()=>U.PivotTableChartPresentWithoutTableTLRError,Hg=()=>U.PivotTableChartPresentWithoutTableTLRError2,Ug=()=>U.NoPatternsFoundError,qg=function(){return U.FixItButtonText},Vg=function(){return U.TabularRangeAutoFixDuplicateHeadersSuccessfulResponse},Wg=function(){return U.TabularRangeAutoFixDuplicateHeadersUnsuccessfulResponse},Gg=function(){return U.TabularRangeAutoFixMergedCellsSuccessfulResponse},zg=function(){return U.TabularRangeAutoFixMergedCellsUnsuccessfulResponse},Qg=function(){return U.TabularRangeAutoEmptyHeadersSuccessfulResponse},jg=function(){return U.TabularRangeAutoEmptyHeadersUnsuccessfulResponse},Jg=function(){return U.NoAutoFixCompleted},Yg=function(){return U.TabularRangeAutoFixDuplicateHeaders},Xg=function(){return U.HeaderColumnLabel},Zg=function(){return U.HeaderRowLabel},Kg=function(){return U.TlrAutoFixConfirmationMultipleCases},eh=function(){return U.TlrAutoFixUnsuccessful},th=function(){return U.AutoFixMoreThanTwoMergedCells},nh=function(){return U.AutoFixTwoMergedCells},ah=function(){return U.AutoFixOneMergedCells},oh=function(){return U.AutoFixMultipleMergedCellsDescription},rh=function(){return U.AutoFixMoreThanTwoEmptyCells},ih=function(){return U.AutoFixTwoEmptyCells},lh=function(){return U.AutoFixOneEmptyCells},sh=function(){return U.AutoFixMoreThanTwoDuplicateCells},ch=function(){return U.AutoFixTwoDuplicateCells},dh=function(){return U.AutoFixIntroduction},uh=()=>U.ExplainTablesPill,mh=()=>U.ExplainHeadersPill,gh=()=>U.ExplainUnmergingCellsPill,hh=()=>{switch((0,a.vI)()){case Office.PlatformType.OfficeOnline:return"cmmyfd4mgl3";case Office.PlatformType.Mac:return"cmmweb1zw6v";case Office.PlatformType.PC:return"cmml0h1c9sd";case Office.PlatformType.iOS:return"cmmuefjswpd";default:return}},ph=()=>(0,a.vI)()===Office.PlatformType.Mac?"excelmac":"excel",bh=()=>V.OutOfCreditsError,fh=()=>U.SuggestFullThemeAnalysisPrompt,Ch=()=>U.SuggestFullThemeAnalysisButton,yh=()=>U.SuggestFullThemeAnalysisQuery,vh=()=>"Insert Suggestion",Th=()=>["Inserting suggestion..."],xh=()=>"Done! I inserted the formula suggestion.",Sh=()=>"I'm having trouble inserting formula columns right now. Try sending your prompt later.",wh=()=>U.TextAnalysisSummayInsertionColumnName,Eh=()=>U.TextAnalysisSentimentInsertionColumnName,Ih=()=>"Unable to render the chart. Please try again later.",Rh=()=>V.DKEAndNotExtractLabelErrorString??"Copilot can't reference this content because your organization's policy doesn't allow it.",Ah={colorBrandForeground1:"#60BD82",colorBrandForegroundLink:"#60BD82",colorBrandForegroundLinkPressed:"#37A660",colorBrandForegroundLinkSelected:"#60BD82",colorBrandForegroundLinkHover:"#A0D8B9",colorNeutralForeground2BrandHover:"#60BD82",colorNeutralForeground2BrandPressed:"#37A660",colorBrandForeground2:"#A0D8B9",colorBrandForeground2Hover:"#FFFFFF"}},281161:(e,t,n)=>{"use strict";n.d(t,{Kz:()=>R,Nl:()=>w,UD:()=>S,bs:()=>I,ci:()=>E,fo:()=>A});var a=n(178365),o=n(279395),r=n(546756),i=n(764738),l=n(429257),s=n(306148),c=n(857677),d=n(83437),u=n(70239),m=n(76872),g=n(75496),h=n(316904),p=n(664007),b=n(486894),f=n(650444),C=n(639969),y=n(166840),v=n(795786),T=n(414542),x=n(507628);async function S(e,t){const n=l.s.getInstance().NativeServices.IDataShapingPrivateSdxApiService.value,r={success:!1,requestId:t.requestId,sessionId:t.sessionId};try{e((0,C.eM)(c.OP.EnterDataShapingMode)),e(p.m.clearSuggestionList());const i=n.onQueryScriptChanged.subscribe((n=>{const a={started:!1,disableQueryScriptUpdates:!1,requestId:t.requestId,sessionId:t.sessionId};try{const t=e((0,C.SW)());if(a.started=t.started,a.disableQueryScriptUpdates=t.started&&t.disableQueryScriptUpdates,!t.started||t.disableQueryScriptUpdates||t.queryScript===n)return;e(p.m.updateDataShapingQueryScript(n)),e(p.m.addDataShapingChatEntry({kind:"ManualEdit"})),(0,s.s_)(s.H0.DisableUndo)}finally{m.E.getInstance().updateTelemetryChatEventData({[c.h3.ChatEventType]:c.a5.DataShapingQueryScriptChanged,[c.h3.ChatEventParameters]:JSON.stringify(a)},h.M.getInstance())}})),l=n.onPreviewClosed.subscribe((n=>{const r={reason:n,requestId:t.requestId,sessionId:t.sessionId};try{if("FAILURE"===n||"ERROR"===n){e((0,C.L4)()),e(p.m.exitDataShapingMode()),e(p.m.exitSingleMode());const{message:t,telemetry:n}=v.n.getDataShapingErrorResponse((0,o.y3x)());a.$.getInstance().displayResponse(t,n)}}finally{try{i.unsubscribe(),l.unsubscribe()}catch{}m.E.getInstance().updateTelemetryChatEventData({[c.h3.ChatEventType]:c.a5.DataShapingPreviewClosed,[c.h3.ChatEventParameters]:JSON.stringify(r)},h.M.getInstance())}}));await n.startPreview(t.queryName,t.mashupDocument,t.tableName),e(p.m.enterDataShapingMode(t)),e(p.m.enterSingleMode({feature:"dataShaping",caption:(0,o.Bdz)(),exitMenuOptions:[{key:"replace",text:(0,o.bCm)()},{key:"newSheet",text:(0,o.SpP)()},{key:"discard",text:(0,o.Bms)()}]})),e((0,C.L4)()),e(p.m.setLatestRequestId(t.requestId));const d=JSON.stringify({queryScript:t.queryScript});v.n.displayDataShapingIntroResponse(d,t.requestId),r.success=!0}catch(t){h.M.getInstance().logError({eventType:g.S2.DataShaping,errorMessage:`got error during handling start mode: ${t} (${JSON.stringify(t)})`,logLevel:d.$b.Error}),await n.endPreview("ERROR"),e((0,C.L4)()),e(p.m.exitDataShapingMode()),e(p.m.exitSingleMode());const{message:r,telemetry:i}=v.n.getDataShapingErrorResponse((0,o.A99)());a.$.getInstance().displayResponse(t.message||r,i)}finally{m.E.getInstance().updateTelemetryChatEventData({[c.h3.ChatEventType]:c.a5.DataShapingStartMode,[c.h3.ChatEventParameters]:JSON.stringify(r)},h.M.getInstance())}}async function w(e,t){let n="DECLINE";const r={success:!1,exitModeError:!1,started:!1,sessionId:"",exitReason:t?.key};try{const i=e((0,C.SW)());r.started=i.started,i.started&&(r.sessionId=i.sessionId);const u=l.s.getInstance().NativeServices.IDataShapingPrivateSdxApiService.value,m=t?.key;try{if(!m)return void h.M.getInstance().logError({eventType:g.S2.DataShaping,errorMessage:"Unexpected: endDataShapingMode called without an exit option",logLevel:d.$b.Error});e((0,C.eM)(c.OP.ExitDataShapingMode)),(0,s.s_)(s.H0.DisableUndo);const t=await E(e,m);n=t.reason;const{message:o,telemetry:i}=v.n.getExitModeResponse(m,t.metadata);a.$.getInstance().displayResponse(o,i),r.success=!0}catch(e){const{message:t,telemetry:r}=v.n.getDataShapingErrorResponse((0,o.qmi)());a.$.getInstance().displayResponse(t,r),n="ERROR",h.M.getInstance().logError({eventType:g.S2.DataShaping,errorMessage:`Failed to apply exit mode action: ${m}, ${e} (${JSON.stringify(e)})`,logLevel:d.$b.Error})}finally{const t="FAILURE"===n?"ERROR":n;await u.endPreview(t),e((0,C.L4)()),e(p.m.exitDataShapingMode()),e(p.m.exitSingleMode())}}catch(e){r.exitModeError=!0,h.M.getInstance().logError({eventType:g.S2.DataShaping,errorMessage:`got error during handling exit mode: ${e} (${JSON.stringify(e)})`,logLevel:d.$b.Error})}finally{m.E.getInstance().updateTelemetryChatEventData({[c.h3.ChatEventType]:c.a5.DataShapingEndMode,[c.h3.ChatEventParameters]:JSON.stringify(r)},h.M.getInstance())}}async function E(e,t){const n=l.s.getInstance().NativeServices.IDataShapingPrivateSdxApiService.value,a=await n.getQueryScript();switch(t){case"replace":{const t=await async function(e,t){const n=(0,x.A)(),a=e((0,C.SW)()),o=a.started?a.tableName:"",l=new u.g0({parentPath:["Signal",r.Cm.getTypeName()],items:[{id:n,body:new r.Cm({requestId:n,conversationId:n,tableId:o,queryScript:t,enableDebugging:a.enableDebugging})}]}),s=await(0,T.T)(l,n,g.S2.DataShaping,c.OP.DataShaping,i.Dd.getTypeName());if(!s?.success)throw new Error(`Failed to retrieve table update plan. ${s?.errorMessage}`);return await(0,b.UO)(s),s}(e,a);return{reason:"ACCEPT",metadata:{queryScript:a,requestJson:t.requestJson}}}case"newSheet":{const t=e((0,C.SW)()),n=t.started?t.tableName:"";return await(0,y.rc)(a,n),{reason:"ACCEPT",metadata:{queryScript:a}}}case"discard":break;default:(0,f.x)(t)}return{reason:"DECLINE",metadata:{}}}async function I(e,t){const n={success:!1,started:!1,sessionId:""};try{const a=e((0,C.SW)());n.started=a.started,a.started&&(n.sessionId=a.sessionId),e(p.m.setDisableQueryScriptUpdates(!0)),await l.s.getInstance().NativeServices.IDataShapingPrivateSdxApiService.value.appendSteps(t);const o=await l.s.getInstance().NativeServices.IDataShapingPrivateSdxApiService.value.getQueryScript();e(p.m.updateDataShapingQueryScript(o)),e(p.m.setDisableQueryScriptUpdates(!1)),n.success=!0}finally{m.E.getInstance().updateTelemetryChatEventData({[c.h3.ChatEventType]:c.a5.DataShapingAddSteps,[c.h3.ChatEventParameters]:JSON.stringify(n)},h.M.getInstance())}}async function R(e,t){const n={success:!1,started:!1,sessionId:""};try{const a=e((0,C.SW)());n.started=a.started,a.started&&(n.sessionId=a.sessionId);for(const e of t.reverse())await l.s.getInstance().NativeServices.IDataShapingPrivateSdxApiService.value.removeStep(e.name);n.success=!0}catch(e){h.M.getInstance().logError({eventType:g.S2.DataShaping,errorMessage:`IDataShapingPrivateSdxApiService.removeStep failed with error ${e} (${JSON.stringify(e)})`,logLevel:d.$b.Warning})}finally{m.E.getInstance().updateTelemetryChatEventData({[c.h3.ChatEventType]:c.a5.DataShapingUndoSteps,[c.h3.ChatEventParameters]:JSON.stringify(n)},h.M.getInstance())}}async function A(e,t){const n={success:!1,started:!1,sessionId:""};try{const a=e((0,C.SW)());n.started=a.started,a.started&&(n.sessionId=a.sessionId),e(p.m.setDisableQueryScriptUpdates(!0)),await l.s.getInstance().NativeServices.IDataShapingPrivateSdxApiService.value.updateQueryScript(t),t=await l.s.getInstance().NativeServices.IDataShapingPrivateSdxApiService.value.getQueryScript(),e(p.m.updateDataShapingQueryScript(t)),n.success=!0}finally{e(p.m.setDisableQueryScriptUpdates(!1)),m.E.getInstance().updateTelemetryChatEventData({[c.h3.ChatEventType]:c.a5.DataShapingEditQuery,[c.h3.ChatEventParameters]:JSON.stringify(n)},h.M.getInstance())}}},281695:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default="ffffffff-ffff-ffff-ffff-ffffffffffff"},282667:(e,t,n)=>{"use strict";n.d(t,{i:()=>S});var a=n(780866),o=n(641565),r=n(391060),i=n(312584),l=n(831007),s=n(238488),c=n(208520);const d=({title:e,duration:t,trigger:n,withArrow:a})=>{const[o,r]=function(e){const[t,n]=(0,c.useState)(!1),a=(0,c.useRef)(void 0);return(0,c.useEffect)((()=>{if(t)return u(a),a.current=window.setTimeout((()=>{n(!1),u(a)}),e),()=>u(a)}),[t]),[t,n]}(t);return c.createElement(i.A,{withArrow:a,closeOnIframeFocus:!0,closeOnScroll:!0,size:"small",open:o,onOpenChange:(e,{open:t})=>{r(t)}},c.createElement(l.W,null,n),c.createElement(s.H,{"aria-live":"assertive",role:"alert"},e))};function u(e){e.current&&(clearTimeout(e.current),e.current=void 0)}var m=n(767439),g=n(192207),h=n(673805),p=n(279395),b=n(75496),f=n(672270),C=n(500461),y=n(347145),v=n(652382);const T=(0,m.A)(g.cAv,g.c2D),x=(0,a.n)({iconContainer:{[`&:hover .${h.ru}`]:{color:C.k1.themePrimary}}});function S({getClipboardItem:e,telemetryUsageData:t,ariaLabelSuffix:n=""}){const[a,i]=(0,c.useState)(null),l=!(0,v.dD)(),s=x();(0,c.useEffect)((()=>{(0,y.yw9)("OfficeVSO_10036667_CopyButtonLazyClipboardItem")||(async()=>{const t=await e();i(t)})()}),[e]);const u=c.createElement(o.$,{size:"small",appearance:"transparent",icon:c.createElement(T,null),className:s.iconContainer,"aria-label":`${p.xxz.CopyButtonLabel} ${n}`.trim(),"aria-expanded":void 0,onClick:async n=>{(0,y.yw9)("OfficeVSO_9770243_MacCopyButtonFix")&&n.stopPropagation(),(0,f.Kv)((0,y.yw9)("OfficeVSO_10036667_CopyButtonLazyClipboardItem")?await e():a,b.S2.Error,t)}});return c.createElement(d,{duration:3e3,title:p.xxz.CopyButtonPopover,trigger:l?c.createElement(r.m,{content:p.xxz.CopyButtonLabel,relationship:"label"},u):u})}},290235:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectStore=void 0;t.ObjectStore=class{constructor(){this.store={}}create(e,t){return!this.store[e]&&(this.store[e]=t,!0)}read(e){if(void 0!==this.store[e])return this.store[e];throw new Error("No such item: "+JSON.stringify(e))}keyExists(e){return void 0!==this.store[e]}delete(e){const t=!!this.store[e];return delete this.store[e],t}keys(){return Object.keys(this.store)}}},294426:(e,t,n)=>{"use strict";n.d(t,{g:()=>c,z:()=>s});var a=n(531093),o=n(83437),r=n(75496),i=n(316904),l=n(347145);function s(){return(0,l.iPS)("Microsoft.Office.Excel.FA000000124.IsContextFoilEnabled",!1)||(0,l.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.IsContextFoilEnabled",!1)}class c{static getInstance(){return c.instance||(c.instance=new c),c.instance}async showGridFoil(e){this.sheetName&&(await this.removeGridFoil(),window.clearTimeout(this.timeout));const t=a.ExcelCalc.sheetNameFromSheetAddresses(e),n=a.ExcelCalc.localAddressesFromSheetAddresses(e);try{await Excel.run((async e=>{const a=e.workbook.worksheets.getItem(t),o=a.getRange(n);a.gridFoils.add(o,this.getCopilotFoilOptions()),await e.sync(),this.sheetName=t}))}catch{i.M.getInstance().logError({eventType:r.S2.Error,errorMessage:"GridFoil failed to show",logLevel:o.$b.Warning})}}async removeGridFoil(){if(!this.sheetName)return;const e=this.sheetName;try{await Excel.run((async t=>{t.workbook.worksheets.getItem(e).gridFoils.removeAll(),await t.sync(),this.sheetName=void 0}))}catch{i.M.getInstance().logError({eventType:r.S2.Error,errorMessage:"GridFoil failed to remove",logLevel:o.$b.Warning})}}async showGridFoils(e){this.sheetName&&(await this.removeGridFoil(),window.clearTimeout(this.timeout));try{await Excel.run((async t=>{const n=a.ExcelCalc.sheetNameFromSheetAddresses(e[0]),o=t.workbook.worksheets.getItem(n);e.forEach((e=>{const t=a.ExcelCalc.localAddressesFromSheetAddresses(e),n=o.getRange(t);o.gridFoils.add(n,this.getCopilotFoilOptions())})),await t.sync(),this.sheetName=n}))}catch(e){i.M.getInstance().logError({eventType:r.S2.Error,errorMessage:"GridFoil failed to show",logLevel:o.$b.Warning})}}static async removeGridFoilWithSheetName(e){if(e)try{await Excel.run((async t=>{t.workbook.worksheets.getItem(e).gridFoils.removeAll(),await t.sync()}))}catch{i.M.getInstance().logError({eventType:r.S2.Error,errorMessage:"GridFoil failed to remove",logLevel:o.$b.Warning})}}async highlightWithDuration(e,t){const n=a.ExcelCalc.sheetNameFromSheetAddresses(e[0]);await c.getInstance().showGridFoils(e),this.timeout=window.setTimeout((async()=>{await c.removeGridFoilWithSheetName(n)}),t)}getCopilotFoilOptions(){return{borderColor:"copilotBorder",tintColor:"copilotTint",gradientColor:"copilotGradient"}}}},297591:(e,t,n)=>{"use strict";n.d(t,{X:()=>$,u:()=>V});n(554094);var a=n(279395),o=n(831922),r=n(616166),i=n(544861),l=n(639765),s=n(548366),c=n(780866),d=n(242660),u=n(395285),m=n(486092),g=n(454592),h=n(857677),p=n(585305),b=n(518377),f=n(905666),C=n(76872),y=n(316904),v=n(123963),T=n(208520);const x=(0,c.n)({description:{...d.g.body1,"& > p:first-child":{marginTop:0}}});function S({id:e,suggestionId:t,title:n,formula:o,explanation:r,description:i,role:s,onFirstTimeExplanationShown:c,loadingTimeouts:d,icon:C,descriptionAfterFormula:y}){const v=(0,u.Bi)("formula-title-"),S=x(),E=w(`explanation[${e}]`,Boolean(r),d.explanation,l.c.Formula_Explanation_Failed_To_Display,h.OP.FormulaExplanationAvailable),I=w(`description[${e}]`,Boolean(i),d.description,l.c.Formula_Description_Failed_To_Display,h.OP.FormulaDescriptionAvailable);const R=T.createElement(p.u,{text:function(e){switch(I){case"loading":return;case"timeout":return a.olU.FormulaSuggestion_Description_NotAvailable;default:return e}}(i),className:(0,m.z)(S.description,"formula-description")});return T.createElement(f.B,{role:s,tokens:{childrenGap:8},"aria-labelledby":v},n&&T.createElement(g.V,{id:v,role:"heading","aria-level":2,"data-testid":"formula-title"},n),!y&&R,T.createElement(b.$,{icon:C??"math",content:o,explanation:{explanation:r,isLoading:"loading"===E,isNotAvailable:"timeout"===E,onFirstTimeExplanationShown:c},telemetryUsageFeatureName:h.q.CalculatedColumns,suggestionId:t,getClipboardItem:async()=>new ClipboardItem({"text/plain":new Blob([o],{type:"text/plain"})}),ariaAttributes:{"aria-label":a.olU.FormulaSuggestion_FormulaSnippet_AriaLabel}}),y&&R)}function w(e,t,n,a,o){return(0,v.rK)(e,t,n,{onTimeout(){y.M.userQueryGuid&&y.M.getInstance().logStandardizedAshaErrorEvent(s.W.UI_Failed_To_Update_Or_Load,a,h.BJ.FormulaGeneration)},onLoaded(e,t){C.E.getInstance().logLatency(e,o,!t)}})}var E=n(881608),I=n(446751),R=n(603222),A=n(384453);const L=({title:e,preview:t,loadingTimeout:n})=>{const a=(0,v.rK)("previewForHeader",Boolean(t),n),o=null!==t&&"object"==typeof t&&"string"==typeof t.headerPreviewValue;switch(a){case"loading":return T.createElement(R.E,{animation:"wave",appearance:"translucent",style:{width:"100%",height:12,marginLeft:4,marginRight:4}},T.createElement(A.H,{size:12}));case"timeout":return null;default:return T.createElement(g.V,null,e," ",o?`: ${t.headerPreviewValue}`:"")}};var k=n(83437),F=n(418218),_=n(352893),P=n(75496),N=n(314793),M=n(92520),O=n(347145),D=n(318457),B=n(972160);function $({recommendation:e,...t}){return e?T.createElement(H,{recommendation:e,...t}):(y.M.getInstance().logErrorCode(r.O.ColumnRecommendationsNotAvailable,new Error("No visible recommendation"),P.S2.FormulaGeneration,k.$b.Warning),T.createElement(q,null))}function H({requestId:e,recommendation:t,isMainRecommendation:n,targetAddress:a,targetSheet:o,columnLetters:l,rowNumber:s,showPreview:c,isChatHistoryRehydration:d}){(0,M.cY)("FormulaSuggestion.render",{requestId:e,recommendation:t,isMainRecommendation:n,targetAddress:a,targetSheet:o,columnLetters:l,rowNumber:s,isChatHistoryRehydration:d});const u=(0,B.i)(e,t);void 0===t.suggestionType&&(t.suggestionType=I.VS.Column);const g=(0,D.t)();(0,v.IC)(function(e,t){return t&&"object"==typeof e.preview&&String(e.preview.columnLetters)!==String(t)}(t,l),(()=>{const e={key:h.un.RecommendationId,value:`${t.id}`};y.M.getInstance().logError({logLevel:k.$b.Warning,eventType:P.S2.FormulaGeneration,errorMessage:"columnLetters in the header are different than in the preview."},void 0,[e])}));const p=t.calculatedFormulas.length>1,b=N.R.getFormulaSuggestionUiTimeouts();return T.createElement(i.lJ,{contentBody:T.createElement(f.B,{tokens:{childrenGap:12},className:(0,m.z)(g.columnRecommendation,"column-recommendation")},U(t)&&T.createElement(L,{title:t.calculatedFormulas[0]?.title,preview:t.preview,loadingTimeout:b.preview}),T.createElement(E.A,{recommendation:t,isMainRecommendation:n,targetAddress:a,targetSheet:o,columnLetters:l,rowNumber:s}),T.createElement(f.B,{tokens:{childrenGap:12},role:p?"list":void 0},t.calculatedFormulas.map(((e,n)=>T.createElement(S,{loadingTimeouts:b,key:e.id,id:`${t.id}_${e.id}`,suggestionId:t.id,role:p?"listitem":"group",title:U(t)?void 0:p?`${n+1}. ${e.title}`:e.title,description:e.description,descriptionAfterFormula:U(t),formula:e.formula,explanation:e.formulaExplanation,onFirstTimeExplanationShown:()=>{V(t.id,h.a5.CalculatedColumnsExplainButtonClicked)}})))),c&&T.createElement(_.J,{uiTimeout:b.preview,theme:F.Q1.neutralV2,preview:t.preview,type:t.suggestionType,errorData:{errorCode:r.O.CalculatedColumnPreviewNotUpdated,telemetryType:P.S2.FormulaGeneration,telemetryFeature:h.BJ.FormulaGeneration},isChatHistoryRehydration:!!(0,O.yw9)("OfficeVSO_9899849_dontSendAshaOnRehydration")&&d})),requestId:e,cardButtons:u})}function U(e){return e.suggestionType===I.VS.Cell&&!!e.isSingleFormula}function q(){return T.createElement(o.DefaultMessage,{body:{user:"chat",messageHeader:{text:(0,a.HGr)()}},styles:(0,D.t)(),shouldShowAIGeneratedIndicator:!1})}function V(e,t){C.E.getInstance().updateTelemetryChatEventData({[h.h3.ChatEventType]:t,[h.h3.ChatEventParameters]:e},y.M.getInstance())}},297848:(e,t,n)=>{"use strict";n.d(t,{I2:()=>w,Nl:()=>E,yU:()=>I});var a,o=n(639765),r=n(548366),i=n(178365),l=n(16244),s=n(279395),c=n(857677),d=n(83437),u=n(639969),m=n(291436),g=n(330123),h=n(76872),p=n(75496),b=n(316904),f=n(664007),C=n(347145),y=n(382736),v=n(166840),T=n(795786),x=n(507628);!function(e){e.GetImportOptionsCancelled="GetImportOptionsCancelled",e.QueryRefreshFailure="QueryRefreshFailure",e.AuthenticateRefreshDisabled="AuthenticateRefreshDisabled"}(a||(a={}));class S extends Error{toString(){return`SignalError: ${this.message} (ErrorCode: ${this.errorCode})`}constructor(e,t){super(e),this.errorCode=t}}function w(e,t,n,a,l,m=b.M.getInstance(),g=h.E.getInstance(),y=T.n,x=f.m,S=c.xJ,w=v.rc){return async h=>{let b,f=!1;const v=(new Date).getTime();n(x.startExecutingCommand({command:c.OP.ImportDataLoadQuery,id:t}));try{const t=(0,C.iPS)("Microsoft.Office.Excel.FA000000124.AttachQueryRefreshCallback",!0),n=`{${e}_${l}}`;b=await w(h.powerQueryScript,h.sourceName,t,n),f=!0;const{message:o,telemetry:r}=y.getImportDataSimpleMessage((0,s.k0o)(),a);i.$.getInstance().displayResponse(o,r)}catch(e){m.logError({eventType:p.S2.ImportData,errorMessage:`failed to load query with error:  ${e} ${JSON.stringify(e)}`,logLevel:d.$b.Error});const{message:t,telemetry:n}=y.getImportDataSimpleMessage((0,s.pZZ)(),a);i.$.getInstance().displayResponse(t,n),m.logStandardizedAshaErrorEvent(r.W.Unable_To_Complete_Task,o.c.Import_Data_Load_Query_Error,c.BJ.ImportData)}finally{g.updateTelemetryChatEventData({[c.h3.ChatEventType]:c.a5.ImportDataLoadQuery,[c.h3.ChatEventParameters]:JSON.stringify({success:f,loadQueryResult:b,messageId:e,duration:S(v)})},m),n((0,u.L4)(f)),n(x.clearSuggestionList())}}}async function E(e,t,n,a,o,r=g.qx.getInstance(),i=b.M.getInstance(),l=h.E.getInstance(),s=T.n,d=f.m,u=c.xJ){await A(c.q.ImportDataSkill,e,t,n,a,i,l,s,d,u,(async()=>({requestId:t,dataSources:o})),r)}async function I(e,t,n,a,o=g.qx.getInstance(),r=b.M.getInstance(),i=h.E.getInstance(),l=T.n,s=f.m,d=c.xJ){r.startTriedActivity(c.q.ImportDataFromSearch);const u=(0,C.Z8j)("Microsoft.Office.Excel.FA000000124.MaxTimeWaitingForCitations",3e4),m=(0,C.Z8j)("Microsoft.Office.Excel.FA000000124.MaxTimeWaitingForRelevancy",3e4);await A(c.q.ImportDataFromSearch,e,t,n,a,r,i,l,s,d,(async()=>await o.fetchRelevantTablesForMessageId(e,u,m,n,t,s)),o)}function R(e,t,n,a){const o=(0,y.N)(n);e((0,u.nv)(o,t?m.Aw.success:m.Aw.failed,a,!1,!0))}async function A(e,t,n,a,m,g,h,b,f,y,v,T){const w=(new Date).getTime(),E={success:!1,isCardShown:!1,resolvedDataSources:0,shownDataSources:0,messageId:t,duration:0},I=(0,x.A)();a(f.setLatestRequestId(I));let A=!1;try{const h=await v();let y=h.dataSources;if(E.resolvedDataSources=y.length,T.isMessageCancelled(t))throw new S(`Message is cancelled. will ignore the ${E.resolvedDataSources} dataSources`,"GetImportOptionsCancelled");if(h.error&&h.error?.errorCode!==l.O.Timeout)throw h.error.errorCode===l.O.RAI&&g.logStandardizedAshaErrorEvent(r.W.Unable_To_Complete_Task,o.c.Import_Data_RAI_Error,c.BJ.ImportData),new S(h.error.errorMessage,h.error.errorCode);const x=(0,C.iPS)("Microsoft.Office.Excel.FA000000124.ImportDataShowAllTables",!0);if((0===y.length&&x||h.error?.errorCode===l.O.Timeout)&&(A=!0,y=await T.getAllResolvedDataSourcesForMessageId(t,0),g.logError({eventType:p.S2.ImportData,errorMessage:`falling back to show all tables for message id: ${t}. errorCode?: ${h.error?.errorCode}`,logLevel:d.$b.Warning})),0===y.length){const n=T.doesMessageHaveFilteredExcelFiles(t)?(0,s.uLY)():(0,s.kM)(),{message:o,telemetry:r}=b.getImportDataSimpleMessage(n,e);i.$.getInstance().displayResponse(o,r),a((0,u.Nl)()),R(a,!0,o,r)}else{const{message:o,telemetry:r}=b.getImportDataResponse({importType:e,requestId:I,dataSources:y,messageId:t,userQueryGuid:n,clpData:m,performedFallbackToAllTables:A});i.$.getInstance().displayResponse(o,r),E.isCardShown=!0,E.shownDataSources=y.length,a(f.clearSuggestionList()),R(a,!0,o,r)}E.success=!0,g.endTriedActivitySuccess(e)}catch(n){if(g.logError({eventType:p.S2.ImportData,errorMessage:`got error during handling import data: ${n} ${JSON.stringify(n)}`,logLevel:d.$b.Error}),g.endTriedActivityFailure(e),g.logStandardizedAshaErrorEvent(r.W.Unable_To_Complete_Task,o.c.Import_Data_Card_Rendering_Error,c.BJ.ImportData),!T.isMessageCancelled(t)){const t=function(e){return e instanceof S&&e.errorCode===l.O.RAI?(0,s.KC)():(0,s.pZZ)()}(n),{message:o,telemetry:r}=b.getImportDataSimpleMessage(t,e);i.$.getInstance().displayResponse(o,r),R(a,!1,o,r)}}finally{E.duration=y(w),h.updateTelemetryChatEventData({[c.h3.ChatEventType]:c.a5.ImportDataShowCard,[c.h3.ChatEventParameters]:JSON.stringify(E)},g),a((0,u.L4)(E.success))}}},301128:(e,t,n)=>{"use strict";n.d(t,{O:()=>a});const a=(0,n(507628).A)()},301735:(e,t,n)=>{"use strict";var a,o;n.d(t,{w:()=>a,x:()=>o}),function(e){e.AnswersName="answers",e.CannedResponse="annrules",e.ElseSkillName="excel_else",e.GetInsightsName="get_insights",e.ChartsAndPivotTablesName="charts_and_pivot_tables",e.TextAnalysisName="text_analysis",e.SelfHelpSkillName="self_help_search",e.CalculatedColumnsName="calculated_columns",e.CreateCalculatedColumnsName="create_calculated_columns",e.DataShapingName="data_shaping",e.EditDocumentName="edit_document",e.SearchEnterpriseName="search-enterprise",e.OfficeScriptsName="office_scripts",e.PythonSkillName="get_python_code",e.PythonCalculatedColumnsName="python_calculated_columns",e.GenerateResponseName="generate_response",e.ImageChatName="image-chat",e.AugLoopEvalName="AugmentationLoopEval",e.AugLoopName="AugmentationLoop",e.GetContextName="get_context",e.FormulasName="formulas",e.FormatDocumentName="format_document",e.Workflow="workflow",e.DeepLeo="DeepLeo",e.SearchToolsRequestInterstitialsPublisher="SearchToolsRequestInterstitialsPublisher",e.SearchToolsResponseInterstitials="SearchToolsResponseInterstitials",e.Unknown="Unknown",e.ExcelAnalysis="excel_analysis",e.NewPythonSkillName="start_analysis_mode"}(a||(a={})),function(e){e.QuickAnswer="QuickAnswer",e.HelpArticle="HelpArticle"}(o||(o={}))},306148:(e,t,n)=>{"use strict";n.d(t,{H0:()=>Pe,Kv:()=>ze,Oy:()=>rt,J3:()=>nt,z3:()=>je,vu:()=>qe,AH:()=>$e,zY:()=>at,E_:()=>Ze,A6:()=>Ke,AU:()=>et,HZ:()=>He,JE:()=>We,NQ:()=>Ue,yo:()=>tt,FW:()=>De,yq:()=>Be,zL:()=>Ve,s_:()=>ot});var a=n(279395),o=n(874003),r=n(729851),i=n(708353),l=n(86940),s=n(293879),c=n(255563),d=n(437489),u=n(192207),m=n(147487),g=n(174116),h=n(347969),p=n(333772),b=n(639765),f=n(548366),C=n(178365),y=n(656931),v=n(531093),T=n(822606),x=n(83437),S=n(956933),w=n(857677),E=n(551896),I=n(402769),R=n(762030),A=n(504280),L=n(402488),k=n(255507),F=n(76872),_=n(75496),P=n(316904),N=n(664007),M=n(639969),O=n(109174),D=n(92520),B=n(347145),$=n(851452),H=n(126521),U=n(831922),q=n(252163),V=n(855391);async function W(e,t,n,o){const r=function(){const e=(0,q.P)("LaunchOfficeScriptsSDXOptionalProperties");if(!e)throw new Error("LaunchOfficeScriptsSDXOptionalProperties is undefined");let t;try{const n=JSON.parse(e);t=JSON.parse(n?.devProperties?.DocumentHostInfo)}catch{throw new L.Q0("Unable to parse DocumentHostInfo.")}if(!t.ClientUrl)throw new L.Q0("Object does not contain a 'ClientUrl'.");return t}().ClientUrl,i=await(0,V.Jv)(r,o),l=r.split("/").filter((e=>""!==e)),s=l.length>=2?"/"+l.slice(-2).join("/"):"",c=decodeURIComponent(s);return{properties:{categoryNames:["diet"],summary:"On a recurring basis, run an Office Script on an Excel workbook.",description:"On a recurring basis, run an Office Script on an Excel workbook.",author:{displayName:"Microsoft",source:"Microsoft"},metadata:{dietDesignerMarkup:{showParameterWithValue:{Recurrence:["frequency","interval","StartTime"]},parameterLabelOverrides:[{operationNodeId:"recurrence",parameterName:"interval",label:(0,a.s2u)()},{operationNodeId:"recurrence",parameterName:"StartTime",label:(0,a.nPU)()}],parameterDisplayInlineOverrides:[{operationNodeId:"recurrence",parameterName:"frequency",displayInline:!0},{operationNodeId:"recurrence",parameterName:"interval",displayInline:!0}]}},definition:{$schema:"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",contentVersion:"1.0.0.0",parameters:{$connections:{defaultValue:{},type:"Object"},$authentication:{defaultValue:{},type:"SecureObject"}},triggers:{Recurrence:{recurrence:n,type:"Recurrence"}},actions:{Run_script:{runAfter:{},metadata:{[i.fileId]:c,[e]:t},type:"OpenApiConnection",inputs:{host:{apiId:"/providers/Microsoft.PowerApps/apis/shared_excelonlinebusiness",connectionName:"shared_excelonlinebusiness",operationId:"RunScriptProd"},parameters:{source:i.locationId,drive:i.driveId,file:i.fileId,scriptId:e},authentication:"@parameters('$authentication')"}}}},connectionReferences:{shared_excelonlinebusiness:{api:{id:"/providers/Microsoft.PowerApps/apis/shared_excelonlinebusiness"},source:"NotSpecified",connectionNamingMode:"NotSpecified"}}}}}var G=n(469486),z=n(297848),Q=n(359730),j=n(659126),J=n(542769);async function Y(e,t,n){return await async function(e,t,n){const a=[];try{let t;const o=(0,j.me)(e);if(await e.sync(),o())t=e.workbook.worksheets.getActiveWorksheet();else{const n=(0,Q.d)(e);await e.sync();const o=await n()(e);a.push(o.undo),t=o.result}n(t);const r=(0,Q.x)(e,t),i=await r()(e);return a.push(i.undo),t.m_name}catch(e){throw await t((0,M.L4)()),await(0,J.q)(a),e}}(n,t,(t=>function(e,t){const n=t.rows.length,a=t.headers.length,o=n+1;if(0===a)throw new Error("Parsed table has no columns");const r=e.getRangeByIndexes(0,0,o,a);r.numberFormat=(0,B.yw9)("OfficeVSO_9297500_CopilotSDXInsertTableFormatAsGeneral")?[["General"]]:[["@"]];const i=[t.headers,...t.rows.map((e=>e.cells.map((e=>e.value))))];r.values=i,e.tables.add(r,!0),r.select(),r.format.autofitColumns()}(t,e)))}var X=n(652382),Z=n(377159),K=n(176664);async function ee(e){const t=function(e){const t=(0,q.P)("LaunchOfficeScriptsSDXOptionalProperties");let n;if(t){const a=JSON.parse(t);n={DevProperties:a.devProperties,OptionalProperties:a.optionalProperties},n.DevProperties.Destination="Details",n.DevProperties.Source="Copilot",n.DevProperties.UnconditionalForceRefresh="",n.DevProperties.Script=JSON.stringify(e),n.DevProperties.CodeEditorUrl=te(),n.DevProperties.IsOwner=!0,n.OptionalProperties.SourceLocationOverrideResourceId=te()}else n={OptionalProperties:{TaskPaneTitle:"Office Scripts",TaskPaneWidth:360,SourceLocationOverrideResourceId:te(),HeaderCssClass:"ewa-ptp-header-maker",TitleCssClass:"ewa-ptp-title-maker-react"},DevProperties:{Script:JSON.stringify(e),CodeEditorUrl:te(),StorageModePreference:(0,Z.o8)(),Source:"ExcelCopilot",Destination:"Details",CopilotEnabled:"true",wacFlights:JSON.stringify({CopilotSaveAutomation:(0,B.avT)()}),UnconditionalForceRefresh:""}};return n}(e);await ne("FA000000043",t.OptionalProperties,t.DevProperties)}function te(){switch((0,K.A)()){case"Dogfood":case"Microsoft":return"CodeEditor.URL";default:return"ProdCodeEditor.URL"}}async function ne(e,t,n={}){if(!Office?.context?.extensionLifeCycle?.launchExtensionComponent)throw new Error("Unable to launch taskpane. 'Office.context.extensionLifeCycle.launchExtensionComponent' is not defined");const a={extId:{Id:e,StoreId:"sdxcatalog",StoreType:"sdxcatalog",AppVersion:"1.0.0"},componentType:"Taskpane",componentId:e,hostProperties:{HostType:"Excel-Online",FormFactor:"Desktop",Locale:Office.context.displayLanguage},optionalProperties:{DevProperties:n,OptionalProperties:t}};await Office.context.extensionLifeCycle.launchExtensionComponent(a.extId,a.componentType,a.componentId,a.hostProperties,a.optionalProperties)}var ae=n(990219);function oe(e){return!isNaN(Number(e))}function re(e,t){var n;oe(e)?t.cellFormatType.number++:"true"===(n=e).toLowerCase()||"false"===n.toLowerCase()?t.cellFormatType.boolean++:!function(e){return e.startsWith("=")}(e)?!function(e){return e.includes("http://")||e.includes("https://")}(e)?!function(e){return e.startsWith("$")||e.startsWith("£")||e.startsWith("€")||e.startsWith("¥")||e.startsWith("₹")||e.startsWith("₽")}(e)?!function(e){return!(e.length<8)&&(!oe(e)&&(/^(0?[1-9]|1[0-2])[./](0?[1-9]|[12][0-9]|3[01])[./]\d{4}$/.test(e)&&!isNaN(Date.parse(e))))}(e)?t.cellFormatType.string++:t.cellFormatType.date++:t.cellFormatType.currency++:t.cellFormatType.linkCount++:t.cellFormatType.formula++}function ie(e,t){const n={headers:[""],rows:[]};return e(t).find("li").each(((t,a)=>{const o={value:""},r={cells:[]};le(e,a,o),r.cells.push(o),n.rows.push(r)})),n}function le(e,t,n,a=void 0){const o=/^\^\d+\^$/g;e(t).find("a").each(((t,r)=>{e(r).text().match(o)?(a&&a.citationsCount++,e(r).remove()):(a&&a.hyperlinkCount++,n.hyperlink=e(r).attr("href"))})),n.value=e(t).text().trim()}var se=n(540287),ce=n(354350),de=n(395285),ue=n(641565),me=n(355908),ge=n(59653),he=n(616166),pe=n(775568),be=n(468967),fe=n(799765),Ce=n(508491),ye=n(480005),ve=n(210466),Te=n(242660),xe=n(780866);const Se={display:"flex",flexDirection:"row",gap:ye.L.spacingHorizontalS,justifyContent:"flex-start",width:"100%",alignItems:"center",flexWrap:"wrap",marginTop:ye.L.spacingVerticalXS},we={minWidth:"20px",height:"24px",...ve.Pt.border(ye.L.strokeWidthThin,"solid",ye.L.colorNeutralStroke1),...ve.Pt.padding(ye.L.spacingVerticalXS,ye.L.spacingHorizontalS),...Te.g.caption1,borderRadius:ye.L.borderRadiusMedium,":hover":{backgroundColor:ye.L.colorTransparentBackground},":focus":{backgroundColor:ye.L.colorTransparentBackground},":disabled":{backgroundColor:ye.L.colorNeutralBackgroundDisabled,color:ye.L.colorNeutralForegroundDisabled,cursor:"not-allowed"},":hover:disabled":{backgroundColor:ye.L.colorNeutralBackgroundDisabled,color:ye.L.colorNeutralForegroundDisabled,cursor:"not-allowed"}},Ee={...we,color:"#FFFFFF",backgroundColor:ye.L.colorPaletteGreenBackground3,":hover":{color:"#FFFFFF",backgroundColor:ye.L.colorPaletteGreenBackground3},":focus":{color:"#FFFFFF",backgroundColor:ye.L.colorPaletteGreenBackground3},":active":{color:"#FFFFFF",backgroundColor:ye.L.colorPaletteGreenBackground3}},Ie={...we,color:ye.L.colorNeutralForeground1,backgroundColor:ye.L.colorTransparentBackground},Re={marginRight:ye.L.spacingHorizontalS},Ae=(0,xe.n)({pythonStartAnalysisRoot:Ee,pythonThinkDeeperRoot:Ie,icon:Re,container:Se});var Le=n(887648),ke=n(208520);const Fe=()=>{const e=(0,Ce.j)(),t=(0,Le.d4)((e=>e.chat.showLoadingUI)),n=(0,de.Bi)(),o=(0,de.Bi)(),r=Ae();return ke.createElement("div",{className:r.container},ke.createElement(ue.$,{className:r.pythonStartAnalysisRoot,size:"medium",disabled:t,"aria-label":(0,a.CsI)(),"aria-labelledby":n,onClick:e=>i(),icon:{children:ke.createElement(g.u9I,null),className:r.icon},iconPosition:"before"},ke.createElement("span",{id:n},(0,a.CsI)())),ke.createElement(ue.$,{className:r.pythonThinkDeeperRoot,size:"medium",disabled:t,"aria-label":(0,a.YVl)(),"aria-labelledby":o,onClick:e=>async function(){O.CP.pythonContextManager.setIsPythonThinkDeeperMode(!0),await i(!0)}(),icon:{children:ke.createElement(ce.W66,null),className:r.icon},iconPosition:"before"},ke.createElement("span",{id:o},(0,a.YVl)())));async function i(t){try{const n=(0,B.yw9)("OfficeVSO_10320925_ThinkDeeperStringUpdate")&&t;(0,fe.PB)(_.L3.StartAnalysisClicked,[]);const o={chatCardType:l._.Default,chatMessageData:{defaultMessageProps:{user:me.Q9.Human,messageHeader:{text:n?(0,a.YVl)():(0,a.QAQ)()}}}},r={featureName:w.q.Python,eventType:w.a5.SuggestionMessage};if(C.$.getInstance().displayResponse(o,r),O.CP.pythonContextManager.isPythonThinkDeeperMode){const e={chatCardType:l._.Default,chatMessageData:{defaultMessageProps:{user:me.Q9.Chat,messageHeader:{text:(0,a.PX7)()}}}};C.$.getInstance().displayResponse(e,r)}if(O.CP.pythonContextManager.prePythonModeError)return void(0,be.Kx)(e,O.CP.pythonContextManager.prePythonModeError,O.CP.pythonContextManager.prePythonModeErrorFunction??"handleStartAnalysisOnClick - prePythonModeError",!1,!0);e((0,M.eM)(w.OP.PythonStartAnalysis)),O.CP.pythonContextManager.enterAdvancedAnalysisMode(),await ge.p.getInstance().handlePythonStartAnalysis()}catch(t){(0,G.Tk)(!1);let n=t;(0,B.yw9)("OfficeVSO_10264922_AdditionalErrorHandlingMAA")&&(n=new pe.H({errorCode:he.O.PythonStartAnalysisFailed,innerError:t})),(0,be.Kx)(e,n,"handleStartAnalysisOnClick",!1,!1,[],!0)}}},_e=()=>ke.createElement(Fe,null);var Pe,Ne=n(795786),Me=n(312422);function Oe(){return{type:o.jA.Default,title:(0,a.sUU)(),text:(0,X.dD)()?void 0:(0,a.sUU)(),iconRegular:c.t2R,iconHover:c.JL$}}function De(e,t,n,a=[]){return Be((async()=>{await(0,Me.tN)(e),n&&n()}),e,t,a)}function Be(e,t,n,o=[]){const r=P.M.userQueryGuid;return{...Oe(),handleButtonOnClick:async()=>{const i=P.M.getInstance();i.logRejectedEvent(t,n),i.logEvent((0,w.SV)(w.he.Undo,t,w.KZ.UndoButton,n,r));let{message:c,telemetry:d}=function(){const e={chatCardType:l._.Default,chatMessageData:{defaultMessageProps:{user:s.Q9.Human,messageHeader:{text:a.olU.ActionButtonUndo}}}},t={featureName:w.q.UndoMessage,eventType:w.a5.ActionConfirmationMessage};return{message:e,telemetry:t}}();C.$.getInstance().displayResponse(c,d),await e(t),ot("RemoveUndo"),({message:c,telemetry:d}=function(e=[]){const t={chatCardType:l._.Default,chatMessageData:{defaultMessageProps:{user:s.Q9.Chat,messageHeader:{text:a.olU.ActionButtonUndoSuccessMessage}}},chatMessageBodyData:{actionButtonList:e}},n={featureName:w.q.UndoMessage,eventType:w.a5.ActionConfirmationMessage};return{message:t,telemetry:n}}(o)),C.$.getInstance().displayResponse(c,d)}}}function $e(e,t){return{title:(0,a.wW0)(),text:(0,a.wW0)(),type:o.jA.Default,handleButtonOnClick:()=>{(0,G.EA)(e,t)},isDisabled:!1}}function He(){return{title:"",type:o.jA.CustomButton,position:o.SC.ActionButtonBar,customButtonUI:_e(),handleButtonOnClick:()=>{(0,D.cY)("Custom Python Start Analysis Button Clicked")}}}async function Ue(e,t,n,i){const l=P.M.userQueryGuid;let s;if(t!==I.jy.Recurrence)throw new L.Q0(`Unknown schedule type ${t}`,L.y3.unknownScheduleType);return s=await W(e.id,e.name,n,i),{type:o.jA.Default,title:(0,a.XKD)(),text:(0,X.dD)()?void 0:(0,a.XKD)(),iconRegular:(0,X.dD)()?d.FQP:d.EO2,iconHover:(0,X.dD)()?d.NDW:d.Ov,handleButtonOnClick:async()=>{const e=P.M.getInstance();k.B.getInstance().logKeptEvent(w.BJ.OfficeScripts,w.q.OfficeScripts,r.RX.Command),e.logEvent((0,w.SV)(w.he.ScheduleScriptClicked,w.q.OfficeScripts,w.KZ.ScheduleScriptButton,i,l)),async function(e){const t=(0,q.i)();t.Script=void 0,t.FlowCreated=!0;const n={LaunchSource:"ExcelCopilot",TemplateDefinition:e,CopilotPAIntegration:(0,B.Lap)(),CopilotSDXLaunchDevProps:JSON.stringify(t)};await ne("FA000000113",{SourceLocationOverrideResourceId:"ProdPowerAutomate.URL"},n)}(JSON.stringify(s))}}}function qe(e,t,n){const r=P.M.userQueryGuid;return{type:o.jA.Default,title:(0,a.Xlr)(),text:(0,X.dD)()?void 0:(0,a.Xlr)(),iconRegular:(0,X.dD)()?u.aYy:u.va_,iconHover:(0,X.dD)()?u.i00:u.TTy,handleButtonOnClick:async()=>{const o=P.M.getInstance();o.logRejectedEvent(e,n),o.logEvent((0,w.SV)(w.he.DeleteScript,e,w.KZ.DeleteScriptButton,n,r));const i=C.$.getInstance(),{message:l,telemetry:s}=Ne.n.getOfficeScriptSimpleResponse((0,a.Xlr)(),w.a5.DeleteScriptClicked);i.displayResponse(l,s),await async function(e){const t=C.$.getInstance();try{const n=new E.L,a=R.H.getInstance();await n.removeScriptShim(e),a.popScript();const o={operationName:"Delete",scriptMetadata:e};(0,se.q)(o);const{message:r,telemetry:i}=Ne.n.getOfficeScriptDeleteScriptSuccessResponse(e.name);t.displayResponse(r,i)}catch(n){P.M.getInstance().logError({eventType:_.S2.ChatEvents,errorMessage:"Remove script failed",logLevel:x.$b.Warning});const{message:a,telemetry:o}=Ne.n.getOfficeScriptDeleteScriptErrorResponse(e);t.displayResponse(a,o)}}(t),ot("RemoveUndo")}}}function Ve(e){return{type:o.jA.Default,title:(0,a.H2U)(),text:(0,X.dD)()?void 0:(0,a.H2U)(),iconRegular:(0,X.dD)()?m.y_M:m.Fr0,iconHover:(0,X.dD)()?m.iKN:m.Pdb,position:(0,X.dD)()?o.SC.FeedbackSection:o.SC.ActionButtonBar,handleButtonOnClick:async()=>{P.M.getInstance().logEvent((0,w.SV)(w.he.ViewScript,w.q.OfficeScripts,w.KZ.ViewScriptButton,void 0,P.M.userQueryGuid)),ee(e)},popoverProps:{popoverTitle:(0,a.H2U)()}}}function We(e,t,n){return{type:o.jA.Default,title:(0,a.Rp5)(),text:(0,X.dD)()?void 0:(0,a.Rp5)(),iconRegular:(0,X.dD)()?m.osE:m.jFZ,iconHover:(0,X.dD)()?m.WlZ:m.fml,position:(0,X.dD)()?o.SC.FeedbackSection:o.SC.ActionButtonBar,handleButtonOnClick:async()=>{const o=P.M.getInstance();k.B.getInstance().logKeptEvent(w.BJ.OfficeScripts,w.q.OfficeScripts,r.RX.Command),o.logEvent((0,w.SV)(w.he.SaveScript,w.q.OfficeScripts,w.KZ.SaveScriptButton,void 0,P.M.userQueryGuid));const i=C.$.getInstance(),{message:l,telemetry:s}=Ne.n.getOfficeScriptSimpleResponse((0,a.Rp5)(),w.a5.SaveScriptClicked);i.displayResponse(l,s),n(N.m.startExecutingCommand({command:w.OP.SaveOfficeScripts}));const c=await(0,I.fS)(e,t);if(c){ot("RemoveSaveScript"),y.Z.getInstance().setShowUndoButton(!0);const{message:e,telemetry:t}=Ne.n.getSavedScriptCompletedResponse(c,!0);i.displayResponse(e,t,{shouldShowWhenFluxSkillResponseRequired:!1}),n(N.m.stopExecuting({isSuccess:!0}))}else{const{message:e,telemetry:t}=Ne.n.getOfficeScriptErrorResponse((0,a.CPY)(),A.m.SaveScript);i.displayResponse(e,t,{shouldShowWhenFluxSkillResponseRequired:!1}),n(N.m.stopExecuting({isSuccess:!1}))}},popoverProps:{popoverTitle:(0,a.Rp5)()}}}!function(e){e.DisableUndo="DisableUndo",e.RemoveUndo="RemoveUndo",e.RemoveGoBackToData="RemoveGoBackToData",e.RemoveExplain="RemoveExplain",e.RemoveSaveScript="RemoveSaveScript",e.RemoveAll="RemoveAll",e.EnableApply="EnableApply",e.ImportData="ImportData",e.InsertToNewSheet="InsertToNewSheet",e.UpdateGoBackToData="UpdateGoBackToData",e.InsertFormulaSuggestion="InsertFormulaSuggestion"}(Pe||(Pe={}));const Ge=()=>{const e=[];return(0,B.CDX)()&&(e.push(a.ht0),e.push(T.D0)),e},ze=async(e,t,n)=>{(0,D.cY)("Copy button clicked");const a=P.M.getInstance();a.logEvent((0,w.SV)(w.he.CopyMessageClicked,w.q.CopyMessage,void 0,void 0,P.M.userQueryGuid));try{await(0,U.handleCopyOnClicked)(e,Ge())}catch(e){(0,D.cY)("Error copying html to clipboard",e.message),a.logError({eventType:_.S2.ChatEvents,errorMessage:"Error copying html to clipboard "+e.message,logLevel:x.$b.ASHA}),P.M.getInstance().logStandardizedAshaErrorEvent(f.W.Unable_To_Complete_Task,b.c.Failed_To_Copy_Response,w.BJ.CopilotChat)}};function Qe(e){return{title:a.xxz.CopyButtonLabel,text:e&&!(0,X.dD)()?a.xxz.CopyButtonLabel:void 0,iconRegular:(0,X.dD)()?u.c2D:u.Jg_,iconHover:(0,X.dD)()?u.cAv:u.Z1B,popoverProps:{popoverTitle:a.xxz.CopyButtonPopover}}}function je(e=!0){return{type:o.jA.Default,...Qe(e),position:(0,X.dD)()?o.SC.FeedbackSection:o.SC.ActionButtonBar,handleButtonOnClick:ze}}function Je(){return{type:o.jA.Default,title:(0,a.J40)(),text:(0,X.dD)()?void 0:(0,a.J40)(),iconRegular:g.rz9,iconHover:g.dLz}}async function Ye(e,t,n,o,r=[]){t((0,M._Z)({caller:e?"InsertList":"InsertTable",numberOfTables:n.length})),F.E.getInstance().updateTelemetryChatEventData({[w.h3.ChatEventType]:w.a5.InsertingListsFromResponse,[w.h3.ChatEventParameters]:JSON.stringify({numberOfTables:n.length,tablesStatistics:r})},P.M.getInstance());let i=(0,a.CLD)();1===n.length&&o?i=(0,a.Yyo)().replace("{0}",o):n.length>1&&(i=(0,a.IKl)().replace("{0}",n.length.toString()));const{message:l,telemetry:s}=Ne.n.getInsertTableSuccessResponse(i);(0,B.yw9)("OfficeVSO_9260802_ActionBarButtonReleaseLock")&&await t((0,M.L4)()),C.$.getInstance().displayResponse(l,s),P.M.getInstance().logEvent((0,w.SV)(e?w.he.InsertListSuccess:w.he.InsertTableSuccess,e?w.q.InsertList:w.q.InsertTable,void 0,void 0,P.M.userQueryGuid))}async function Xe(e,t){P.M.getInstance().logError({eventType:_.S2.ChatEvents,errorMessage:"Error in handle insert table click"+e.message,logLevel:x.$b.ASHA}),(0,B.yw9)("OfficeVSO_9260802_ActionBarButtonReleaseLock")&&await t((0,M.L4)()),P.M.getInstance().logStandardizedAshaErrorEvent(f.W.Unable_To_Complete_Task,b.c.Failed_To_Insert_Table,w.BJ.CopilotChat);const{message:n,telemetry:o}=Ne.n.getInsertTableErrorResponse((0,a.LLM)());C.$.getInstance().displayResponse(n,o)}function Ze(e,t,n,i){return P.M.getInstance().logEvent((0,w.SV)(w.he.ImportDataButtonShowed,w.q.ImportDataFromSearch,void 0,void 0,t)),k.B.getInstance().logSeenEvent(w.q.ImportDataFromSearch),{type:o.jA.Default,title:(0,a.OS6)(),text:(0,X.dD)()?void 0:(0,a.OS6)(),iconRegular:h.$7G,iconHover:h.B5Q,handleButtonOnClick:async(a,o,l)=>{const s=P.M.getInstance();k.B.getInstance().logKeptEvent(w.BJ.Search,w.q.Search,r.RX.Ask),s.logEvent((0,w.SV)(w.he.ImportDataButtonClicked,w.q.ImportDataFromSearch,void 0,void 0,t)),(0,z.yU)(e,t,i,(0,S.Q9)(n)),ot("ImportData")}}}function Ke(e,t){return P.M.getInstance().logEvent((0,w.SV)(w.he.InsertListShowed,w.q.InsertList,void 0,void 0,P.M.userQueryGuid)),{...Je(),handleButtonOnClick:async(n,a,o)=>{const i=P.M.getInstance();t&&k.B.getInstance().logKeptEvent(w.BJ.Search,w.q.Search,r.RX.Ask),i.logEvent((0,w.SV)(w.he.InsertListClicked,w.q.InsertList,void 0,void 0,P.M.userQueryGuid));try{if(ot("InsertToNewSheet"),!n)throw(0,D.cY)("No messageContentElementId"),i.logError({eventType:_.S2.ChatEvents,errorMessage:"Error in handle insert list click, no messageContentElementId",logLevel:x.$b.Warning}),new Error("No messageContentElementId");const t=function(e){const t=(0,ae.load)(e),n=[];return t("ul").each(((e,a)=>{const o=ie(t,a);n.push(o)})),t("ol").each(((e,a)=>{const o=ie(t,a);n.push(o)})),n}((0,U.getElementHtmlWithAllStylesInline)(n,void 0,void 0,Ge()));let a;e((0,M.eM)(w.OP.InsertList)),await(0,Me.F5)((async n=>{for(let o=0;o<t.length;o++){const r=t[o];0!==r.headers.length&&0!==r.rows.length?a=await Y(r,e,n):i.logError({eventType:_.S2.ChatEvents,errorMessage:"Error in handle insert list click, empty lists is invalid",logLevel:x.$b.Error})}})),await Ye(!0,e,t,a)}catch(t){await Xe(t,e)}}}}function et(e,t){return P.M.getInstance().logEvent((0,w.SV)(w.he.InsertTableShowed,w.q.InsertTable,void 0,void 0,P.M.userQueryGuid)),{...Je(),handleButtonOnClick:async(n,a,o)=>{const i=P.M.getInstance();t&&k.B.getInstance().logKeptEvent(w.BJ.Search,w.q.Search,r.RX.Ask),i.logEvent((0,w.SV)(w.he.InsertTableClicked,w.q.InsertTable,t?w.KZ.SearchResponse:w.KZ.ChatResponse,void 0,P.M.userQueryGuid));try{if(ot("InsertToNewSheet"),!n)throw(0,D.cY)("No messageContentElementId"),i.logError({eventType:_.S2.ChatEvents,errorMessage:"Error in handle insert table click, no messageContentElementId",logLevel:x.$b.Warning}),new Error("No messageContentElementId");const t=function(e){const t=(0,ae.load)(e),n=[],a=[];return t("table").each(((e,o)=>{const r=[],i=[],l={columns:0,rows:0,citationsCount:0,hyperlinkCount:0,cellFormatType:{date:0,number:0,boolean:0,formula:0,string:0,currency:0,linkCount:0},cellStyleType:{bold:0}};t(o).find("thead th").each(((e,n)=>{r.push(t(n).text().trim())})),t(o).find("tbody tr").each(((e,n)=>{const a={cells:[]};t(n).find("td").each(((e,n)=>{const o={value:""};le(t,n,o,l),t(n).find("strong").each(((e,t)=>{l.cellStyleType.bold++})),re(o.value,l),a.cells.push(o)})),i.push(a)})),l.columns=r.length,l.rows=i.length,a.push(l),n.push({headers:r,rows:i})})),{tables:n,tablesStatistics:a}}((0,U.getElementHtmlWithAllStylesInline)(n,void 0,void 0,Ge())),a=t.tables;let o;e((0,M.eM)(w.OP.InsertTable)),await(0,Me.F5)((async t=>{for(let n=0;n<a.length;n++){const r=a[n];0!==r.headers.length?o=await Y(r,e,t):i.logError({eventType:_.S2.ChatEvents,errorMessage:"Error in handle insert table click, empty table headers is invalid",logLevel:x.$b.Error})}})),await Ye(!1,e,a,o,t.tablesStatistics)}catch(t){await Xe(t,e)}}}}function tt(e){const t="Dev",n=O.CP.getActiveTable();return{type:o.jA.Default,title:t,text:(0,X.dD)()?void 0:t,iconRegular:g.SFT,iconHover:g.qTo,handleButtonOnClick:async(a,o,r)=>{(0,D.cY)(`Show Dev Detail Button Clicked for message ID: ${e}`);const c=C.$.getInstance().getChatLog().find((t=>t?.chatMessageBodyData?.messageId===e));if(!c)return;c.startAugloopTimerForStreaming=!1;let d=r;if(r||(d=c?.chatMessageBodyData?.telemetryData),!d)return;try{const e=JSON.parse(d);if(c?.chatMessageBodyData?.feedbackData?.contextData?.cardMetaData){const t=JSON.parse(c.chatMessageBodyData.feedbackData.contextData.cardMetaData);t.promptId&&(e.promptId=t.promptId)}n&&(e.activeTableName=n.name,n.tableLikeRange||(e.activeTableAddress=n.address));d=JSON.stringify(e,null,2)}catch(e){}const u=(e,n)=>{if(e.chatMessageBodyData?.actionButtonList){if(!e.chatMessageBodyData?.messageId)return;e.chatMessageBodyData.actionButtonList=e.chatMessageBodyData.actionButtonList.filter((e=>e.title!==t)),n&&C.$.getInstance().updateMessage(e)}},m=c.chatMessageData?.defaultMessageProps;if(m?.messageHeader?.text)return m.messageHeader.text+=`\n\n ${d}`,u(c,!1),void C.$.getInstance().updateMessage(c);const g=c.chatMessageData?.markDownCardProps;if(g?.message){g.message+=`\n\n ${d}`,u(c,!1);const e=c.chatMessageBodyData;return e?.feedbackSectionPosition&&(e.feedbackSectionPosition=i.O.Footer,e.shouldShowAIGeneratedIndicator=!0),void C.$.getInstance().updateMessage(c)}const h={chatCardType:l._.Default,chatMessageData:{defaultMessageProps:{user:s.Q9.Chat,messageHeader:{text:d}}},addCardToChatHistory:!1};u(c,!0),C.$.getInstance().displayResponse(h)}}}function nt(e,t){const n=(0,a.FA0)();return{type:o.jA.Default,title:n,text:n,iconRegular:p.ZwM,iconHover:p.XWm,handleButtonOnClick:async()=>{try{const{message:n,telemetry:a}=(0,$.b7)();C.$.getInstance().displayResponse(n,a),await(0,$.iT)(e,t)}catch(e){P.M.getInstance().logError({eventType:_.S2.ChatEvents,errorMessage:`$"Error in auto fix button" ${e.message}`,logLevel:x.$b.Error})}}}}function at(e,t){const n=e.sheetRange.sheet;O.CP.setSheetGoBackButtonPointTo(t);const r=(0,H.L)((0,a.zyf)(),e.sheetRange.sheet),i="Error in go back to data button";return{type:o.jA.Default,title:r,text:r,handleButtonOnClick:async()=>{try{await Excel.run((async a=>{if(!e)return void P.M.getInstance().logError({eventType:_.S2.ChatEvents,errorMessage:`${i}, no tableContext`,logLevel:x.$b.Warning});const o=v.ExcelCalc.IExcelRangeToAddress(e.sheetRange.range);a.workbook.worksheets.getItem(t||n).getRange(o).select(),await a.sync()}))}catch(e){P.M.getInstance().logError({eventType:_.S2.ChatEvents,errorMessage:i,logLevel:x.$b.ASHA})}}}}function ot(e,t,n){const o=C.$.getInstance().getLastMessage();if(!o?.actionBarButtons?.length)return;const r=[...o.actionBarButtons];let i=o.strikeThroughText,l=!1;const s=r.findIndex((e=>e.title===(0,a.sUU)())),c=r.findIndex((e=>{const n=t?(0,H.L)((0,a.zyf)(),t):(0,a.vG7)();return e.title===n})),d=r.findIndex((e=>e.title===(0,a.f7s)())),u=r.findIndex((e=>e.title===(0,a.H2U)())),m=r.findIndex((e=>e.title===(0,a.Rp5)())),g=r.findIndex((e=>e.title===(0,a.yZI)())),h=r.findIndex((e=>e.title===(0,a.OS6)())),p=r.findIndex((e=>e.title===(0,a.J40)())),b=r.findIndex((e=>e.title===(0,a.oOI)()));switch(e){case"EnableApply":-1!==g&&(r[g].isDisabled=!1,l=!0);break;case"DisableUndo":O.CP.clearCachedTableInterpretationsForUndo(),-1!==s&&(r[s]={...Oe(),isDisabled:!0,handleButtonOnClick:()=>{}},l=!0);break;case"RemoveUndo":O.CP.clearCachedTableInterpretationsForUndo(),-1!==s&&(r.splice(s,1),i=!0,l=!0,-1!==u&&r.splice(u,1));break;case"RemoveSaveScript":-1!==m&&r.splice(m,1);break;case"RemoveGoBackToData":-1!==c&&(r.splice(c,1),O.CP.setSheetGoBackButtonPointTo(void 0),l=!0);break;case"RemoveExplain":-1!==d&&(r.splice(d,1),l=!0);break;case"RemoveAll":r.length=0,l=!0;break;case"ImportData":-1!==h&&(r.splice(h,1),l=!0);break;case"InsertToNewSheet":-1!==p&&(r.splice(p,1),l=!0);break;case"InsertFormulaSuggestion":-1!==b&&(r.splice(b,1),l=!0);break;case"UpdateGoBackToData":if(-1!==c){if(n&&""!==n){const e=(0,H.L)((0,a.zyf)(),n);r[c].title=e,r[c].text=e}else r[c].isDisabled=!0;O.CP.setSheetGoBackButtonPointTo(void 0),l=!0}}l&&((0,B.yw9)("OfficeVSO_8923945_UpdateLastMessage")?C.$.getInstance().updateMessage({chatCardType:o.messageType,chatMessageBodyData:{actionButtonList:[...r],strikeThroughText:i,messageId:o.messageId},addCardToChatHistory:!1}):C.$.getInstance().updateLastMessage({chatCardType:o.messageType,chatMessageBodyData:{actionButtonList:[...r],strikeThroughText:i},addCardToChatHistory:!1}))}function rt(e,t){const n=[...e];return(0,B.jHv)()&&n.push(tt(t)),n}},307271:(e,t,n)=>{"use strict";n.d(t,{e:()=>o});var a=n(208520),o=function(){return a.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M13.6696 3.98972C13.469 3.39807 12.9137 3 12.2889 3L11.3884 3C10.6873 3 10.0855 3.49905 9.95572 4.18803L9.02441 9.13282L9.48743 7.54883C9.66914 6.92722 10.2391 6.5 10.8867 6.5L13.7655 6.5L15.01 8.12858L16.118 6.5L15.5658 6.5C14.9411 6.5 14.3858 6.10193 14.1852 5.51027L13.6696 3.98972Z",fill:"url(#paint0_radial_1429_128522)"}),a.createElement("path",{d:"M6.50309 16.0036C6.70167 16.5987 7.25866 17 7.88598 17H9.35221C10.148 17 10.7967 16.3619 10.8099 15.5662L10.883 11.1348L10.4977 12.4516C10.3158 13.073 9.74595 13.5 9.09849 13.5L6.20857 13.5L4.97822 12.4147L4.07031 13.5H4.61719C5.24451 13.5 5.80149 13.9013 6.00008 14.4964L6.50309 16.0036Z",fill:"url(#paint1_radial_1429_128522)"}),a.createElement("path",{d:"M12.0004 3H6.16755C4.50102 3 3.50109 5.20235 2.83448 7.40471C2.04471 10.0139 1.01129 13.5035 4.00105 13.5035H6.69024C7.34194 13.5035 7.91403 13.0727 8.09306 12.4461C8.52129 10.9472 9.32308 8.15282 9.94795 6.04403C10.2543 5.01026 10.5094 4.12243 10.901 3.56954C11.1206 3.25958 11.4865 3 12.0004 3Z",fill:"url(#paint2_linear_1429_128522)"}),a.createElement("path",{d:"M12.0004 3H6.16755C4.50102 3 3.50109 5.20235 2.83448 7.40471C2.04471 10.0139 1.01129 13.5035 4.00105 13.5035H6.69024C7.34194 13.5035 7.91403 13.0727 8.09306 12.4461C8.52129 10.9472 9.32308 8.15282 9.94795 6.04403C10.2543 5.01026 10.5094 4.12243 10.901 3.56954C11.1206 3.25958 11.4865 3 12.0004 3Z",fill:"url(#paint3_linear_1429_128522)"}),a.createElement("path",{d:"M8 17.0004H13.8329C15.4994 17.0004 16.4993 14.7983 17.166 12.5962C17.9557 9.98726 18.9891 6.49805 15.9994 6.49805H13.3102C12.6585 6.49805 12.0864 6.92885 11.9073 7.55545C11.4791 9.05414 10.6773 11.8482 10.0525 13.9567C9.74615 14.9904 9.49099 15.8781 9.0994 16.4309C8.87985 16.7408 8.51395 17.0004 8 17.0004Z",fill:"url(#paint4_radial_1429_128522)"}),a.createElement("path",{d:"M8 17.0004H13.8329C15.4994 17.0004 16.4993 14.7983 17.166 12.5962C17.9557 9.98726 18.9891 6.49805 15.9994 6.49805H13.3102C12.6585 6.49805 12.0864 6.92885 11.9073 7.55545C11.4791 9.05414 10.6773 11.8482 10.0525 13.9567C9.74615 14.9904 9.49099 15.8781 9.0994 16.4309C8.87985 16.7408 8.51395 17.0004 8 17.0004Z",fill:"url(#paint5_linear_1429_128522)"}),a.createElement("defs",null,a.createElement("radialGradient",{id:"paint0_radial_1429_128522",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(15.0851 9.1729) rotate(-128.772) scale(6.41931 6.01261)"},a.createElement("stop",{offset:"0.0955758",stopColor:"#00AEFF"}),a.createElement("stop",{offset:"0.773185",stopColor:"#2253CE"}),a.createElement("stop",{offset:"1",stopColor:"#0736C4"})),a.createElement("radialGradient",{id:"paint1_radial_1429_128522",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(5.30628 13.0661) rotate(51.1538) scale(5.67928 5.53958)"},a.createElement("stop",{stopColor:"#FFB657"}),a.createElement("stop",{offset:"0.633728",stopColor:"#FF5F3D"}),a.createElement("stop",{offset:"0.923392",stopColor:"#C02B3C"})),a.createElement("linearGradient",{id:"paint2_linear_1429_128522",x1:"5.81844",y1:"4.2727",x2:"6.65052",y2:"13.8998",gradientUnits:"userSpaceOnUse"},a.createElement("stop",{offset:"0.156162",stopColor:"#0D91E1"}),a.createElement("stop",{offset:"0.487484",stopColor:"#52B471"}),a.createElement("stop",{offset:"0.652394",stopColor:"#98BD42"}),a.createElement("stop",{offset:"0.937361",stopColor:"#FFC800"})),a.createElement("linearGradient",{id:"paint3_linear_1429_128522",x1:"6.54577",y1:"3",x2:"7.00014",y2:"13.5035",gradientUnits:"userSpaceOnUse"},a.createElement("stop",{stopColor:"#3DCBFF"}),a.createElement("stop",{offset:"0.246674",stopColor:"#0588F7",stopOpacity:"0"})),a.createElement("radialGradient",{id:"paint4_radial_1429_128522",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(16.299 5.46979) rotate(109.281) scale(13.9554 16.7229)"},a.createElement("stop",{offset:"0.0661714",stopColor:"#8C48FF"}),a.createElement("stop",{offset:"0.5",stopColor:"#F2598A"}),a.createElement("stop",{offset:"0.895833",stopColor:"#FFB152"})),a.createElement("linearGradient",{id:"paint5_linear_1429_128522",x1:"16.7598",y1:"5.85685",x2:"16.7539",y2:"8.71732",gradientUnits:"userSpaceOnUse"},a.createElement("stop",{offset:"0.0581535",stopColor:"#F8ADFA"}),a.createElement("stop",{offset:"0.708063",stopColor:"#A86EDD",stopOpacity:"0"}))))}},308849:(e,t,n)=>{"use strict";n.d(t,{GZ:()=>C,Hr:()=>h,Sd:()=>v,TR:()=>f,iB:()=>y});var a=n(822606),o=n(660606),r=n(818067),i=n(423905),l=n(83437),s=n(328215),c=n(993821),d=n(795917),u=function(){return u=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},u.apply(this,arguments)},m=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{s(a.next(e))}catch(e){r(e)}}function l(e){try{s(a.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((a=a.apply(e,t||[])).next())}))},g=function(e,t){var n,a,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(n=1,a&&(o=2&l[0]?a.return:l[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,l[1])).done)return o;switch(a=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,a=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],a=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},h=function(e){if(e)return[{id:"CopilotPlugins.".concat(e.appType,".").concat(e.appId),source:"MOS3"}]},p=function(){var e,t=a.ps;null===(e=null===window||void 0===window?void 0:window.open)||void 0===e||e.call(window,t,"_blank","noopener,noreferrer")};function b(e){return void 0===e||""===e}var f=function(e,t,n){var a=(0,s.Z)(e),r=t===n?void 0:t;return(0,o.cY)("AtMentioned GPT: ",a),(0,o.cY)("Selected menu GPT: ",r),null!=a?a:r};function C(e){return m(this,arguments,void 0,(function(e,t,n,a){var r,s,h,p=this;return void 0===t&&(t=0),void 0===a&&(a=!1),g(this,(function(b){switch(b.label){case 0:r=function(r){return m(p,void 0,void 0,(function(){var s,m,h;return g(this,(function(g){switch(g.label){case 0:return(0,o.cY)("handleCopilotAgentEvent in client",JSON.stringify(u(u({},r),{delayValue:t}))),o.EG.sendChatEventTelemetry((0,i.pN)(((h={})[l.h3.ChatEventType]=l.a5.MOSStoreDialogResponse,h[l.h3.ChatEventParameters]=JSON.stringify(u(u({},r),{delayValue:t})),h))),s=r,t>0?[4,new Promise((function(e){return setTimeout(e,t)}))]:[3,2];case 1:g.sent(),g.label=2;case 2:return a&&n&&(m=(0,c.dL)())&&n(u(u({},m),{PrimaryUserAccountInfo:u(u({},m.PrimaryUserAccountInfo),{CopilotExperience:d.$.M365CopilotChat})})),e(s),[2]}}))}))},b.label=1;case 1:return b.trys.push([1,3,,4]),[4,OfficeFirstParty.UnifiedStore.onCopilotAgentEvent(r)];case 2:return b.sent(),[3,4];case 3:return s=b.sent(),(0,o.cY)("Error in initializing CopilotAgent listener",s),o.EG.sendErrorTelemetry((0,i.pN)(((h={})[l.IC.ErrorMessage]="".concat(s),h[l.IC.ErrorCategory]=l.a5.MOSStoreDialogResponse,h))),[3,4];case 4:return[2]}}))}))}var y=function(e,t,n){return m(void 0,void 0,void 0,(function(){var s,c,d,u;return g(this,(function(m){switch(m.label){case 0:return m.trys.push([0,6,,7]),e?[4,OfficeFirstParty.UnifiedStore.launchStore(a.Bx)]:[3,2];case 1:return m.sent(),[3,5];case 2:return t?[4,r.B.getInstance().openMOSDialog()]:[3,4];case 3:return m.sent(),[3,5];case 4:p(),m.label=5;case 5:return s={RichAPI:e,PrivateAPI:t,Source:n},o.EG.sendChatEventTelemetry((0,i.pN)(((d={})[l.h3.ChatEventType]=l.a5.OpenMOSDialog,d[l.h3.ChatEventParameters]=JSON.stringify(s),d))),[3,7];case 6:return c=m.sent(),(0,o.cY)("Error in launching MOS dialog",c),p(),o.EG.sendErrorTelemetry((0,i.pN)(((u={})[l.IC.ErrorMessage]="".concat(c),u[l.IC.ErrorCategory]=l.a5.OpenMOSDialog,u))),[3,7];case 7:return[2]}}))}))},v=function(e,t){return!e||b(e)?a.u1:JSON.stringify({gptId:null!=e?e:a.u1,agentType:null!=t?t:a.u1})}},311538:(e,t,n)=>{"use strict";n.d(t,{i:()=>L,G:()=>k});var a=n(780866),o=n(363747),r=n(204419),i=n(830463),l=n(14838),s=n(121924),c=n(500461),d=n(208520);const u=(0,a.n)({inlineCode:{border:`1px solid ${c.k1.colorNeutralStroke1}`,borderRadius:`${c.k1.borderRadiusMedium}`,backgroundColor:`${c.k1.colorNeutralBackground4}`,padding:"0em 0.2em",margin:"1px"}});function m({code:e}){const t=u();return d.createElement(s.E,{font:"monospace",className:t.inlineCode},e)}var g=n(279395),h=n(518377),p=n(857677),b=n(76872),f=n(316904),C=n(653984);function y({className:e,children:t,featureName:n}){const a=function(e){const t=(0,C.decode)(e);return t!==e&&b.E.getInstance().updateTelemetryChatEventData({[p.h3.ChatEventType]:p.a5.FormulaSnippetData,[p.h3.ChatEventParameters]:JSON.stringify({decoding:!0,original:e.length,decoded:t.length})},f.M.getInstance()),t}("string"==typeof t[0]?t[0]:"");if(a)switch(e){case"language-formula-signature":case"language-number-format":return d.createElement(m,{code:a});case"language-excel":return d.createElement(h.$,{icon:"math",content:a,copyButtonAriaLabelSuffix:a,telemetryUsageFeatureName:n,getClipboardItem:async()=>new ClipboardItem({"text/plain":new Blob([a],{type:"text/plain"})}),ariaAttributes:{"aria-label":g.olU.FormulaSuggestion_FormulaSnippet_AriaLabel}})}return d.createElement("code",{className:e},t)}var v=n(480005),T=n(210466),x=n(486092);const S="markdown-table",w=(0,a.n)({table:{[`&.${S}`]:{fontSize:v.L.fontSizeBase200,"& thead, & th, & td":{...T.Pt.border("1px","solid",v.L.colorNeutralStroke1)},"& th":{backgroundColor:v.L.colorNeutralBackground4},"& th:first-child":{width:"1px"},"& td:first-child":{whiteSpace:"nowrap"}}}}),E=({node:e,className:t,...n})=>{const a=w();return d.createElement("table",{...n,className:(0,x.z)(a.table,S,t)})};var I=n(585305),R=n(347145);const A=(0,a.n)({accordionPanel:{marginBottom:"6px"}});function L(e){return{...(0,R.yw9)("OfficeVSO_10219135_GridTableInMarkdown")&&e===p.q.CalculatedColumns&&{table:E},code:t=>d.createElement(y,{...t,featureName:e})}}function k(e){return{li:({index:t})=>d.createElement(F,e[t]),ul:({children:e})=>d.createElement(o.n,{collapsible:!0,multiple:!0},e)}}function F(e){const t=function(e){let t=e.replace(/\*\*(.*?)\*\*/g,"<b>$1</b>").replace(/^-\s+(.*)/gm,"<li>$1</li>");if(/<li>/.test(t)){const e=t.indexOf("<li>"),n=t.lastIndexOf("</li>")+5;t=`${t.slice(0,e)}\n    <ul>${t.slice(e,n)}</ul>\n    ${t.slice(n)}`}return t}(e.description),n=A();return d.createElement(r.A,{value:e.header},d.createElement(i.u,{expandIconPosition:"end"},`• ${e.header}`),d.createElement(l.v,{className:n.accordionPanel},d.createElement(I.u,{text:t})))}},312422:(e,t,n)=>{"use strict";n.d(t,{$r:()=>g,F5:()=>b,TA:()=>h,tN:()=>p});var a=n(639765),o=n(548366),r=n(83437),i=n(347145),l=n(474353),s=n(75496),c=n(316904),d=n(857677),u=n(279395);let m=!1;async function g(e,{delayForCellEdit:t=!0,operationTimers:n=new l.q}={}){try{return await n.measure("openUndoScope",Excel.run({delayForCellEdit:t},(async t=>{await n.measure("undoScope.open",t.application.undoScope.open(e)),m=!0})))}catch(e){const t=[{key:d.qJ.FeatureName,value:c.M.getInstance().getActiveFeature()},{key:d.qJ.HasUndoScopeOpened,value:m}];c.M.getInstance().logError({eventType:s.S2.ChatEvents,errorMessage:`ctx.application.undoScope.open() failed with code ${e.code}`,logLevel:r.$b.Warning},void 0,(0,i.yw9)("OfficeVSO_8866568_UndoScopeErrors")?t:void 0)}}async function h({delayForCellEdit:e=!0,operationTimers:t=new l.q,ignoreIfNotOpened:n=!1,rollback:a}={}){if(!(0,i.yw9)("OfficeVSO_8866568_UndoScopeErrors")||!n||m)try{return await t.measure("closeUndoScope",Excel.run({delayForCellEdit:e},(async e=>{await t.measure("undoScope.close",e.application.undoScope.close(a)),m=!1})))}catch(e){const t=[{key:d.qJ.FeatureName,value:c.M.getInstance().getActiveFeature()},{key:d.qJ.HasUndoScopeOpened,value:m}];c.M.getInstance().logError({eventType:s.S2.ChatEvents,errorMessage:`ctx.application.undoScope.close() failed with code ${e.code}`,logLevel:r.$b.Warning},void 0,(0,i.yw9)("OfficeVSO_8866568_UndoScopeErrors")?t:void 0)}}async function p(e){try{return await Excel.run({delayForCellEdit:!0},(async e=>{await e.application.undo()}))}catch(t){let n;switch(c.M.getInstance().logError({eventType:s.S2.ChatEvents,errorMessage:`ctx.application.undo() failed with code ${t.code}`,logLevel:r.$b.Warning}),e){case d.q.CalculatedColumns:case d.q.CalculatedRows:case d.q.NLToFormula:n=a.c.Undo_Calculated_Columns_Error;break;case d.q.AnalyzeData:n=a.c.Analyze_Data_Undo_Failed;break;case d.q.Commanding:n=a.c.Command_Execution_Undo_Failed;break;case d.q.ConditionalFormatting:n=a.c.Conditional_Formatting_Undo_Failed;break;case d.q.ContextInference:n=a.c.TLR_Auto_Fix_Undo_Failed;break;case d.q.Python:n=a.c.Python_Undo_Failed;break;case d.q.Answers:n=a.c.Answers_Undo_Failed}n&&c.M.getInstance().logStandardizedAshaErrorEvent(o.W.User_Input_Could_Not_Be_Processed,n,c.M.getInstance().getStandardizedFeatureForSubFeature(e))}}async function b(e,{delayForCellEdit:t=!0,operationTimers:n=new l.q}={}){n.start("total");try{await g((0,u.Eyh)(),{delayForCellEdit:t,operationTimers:n});const a=await n.measure("batch",Excel.run({delayForCellEdit:t},e));return await n.measure("forcesOnUndoChanged",Excel.run({delayForCellEdit:t},(async e=>{await e.sync()}))),a}finally{await h({delayForCellEdit:t,operationTimers:n}),n.end("total")}}},313853:(e,t,n)=>{"use strict";n.d(t,{Ns:()=>In,RU:()=>kn,h7:()=>An,q:()=>Rn,Ms:()=>_n});var a,o=n(764080),r=n(616166),i=n(650444);class l{toString(){return this.address}constructor(e){this.address=e}}class s{toString(){return null==this.value?'""':`"${we(this.value)}"`}getValue(){return this.value&&we(this.value)}constructor(e){this.value=e}}class c{toString(){return null==this.value?"":this.value?"TRUE":"FALSE"}constructor(e){this.value=e}}class d{toString(){return null==this.value?"":this.value.toString()}constructor(e){this.value=e}}class u{toString(){return null==this.valueOrArray?"":"number"==typeof this.valueOrArray?`${this.valueOrArray}`:this.valueOrArray.length>0&&"number"==typeof this.valueOrArray[0]?1===this.valueOrArray.length?`${this.valueOrArray[0]}`:`{${this.valueOrArray.join(",")}}`:`{${this.valueOrArray.map((e=>e.join(","))).join(";")}}`}constructor(e){this.valueOrArray=e}}class m{toString(){return null==this.valueOrArray?"":"string"==typeof this.valueOrArray?new s(this.valueOrArray).toString():this.valueOrArray.length>0&&"string"==typeof this.valueOrArray[0]?1===this.valueOrArray.length?new s(this.valueOrArray[0]).toString():`{${this.valueOrArray.map((e=>new s(e).toString())).join(",")}}`:`{${this.valueOrArray.map((e=>e.map((e=>new s(e).toString())).join(","))).join(";")}}`}constructor(e){this.valueOrArray=e}}class g{toString(){return this.brackets?`(${this.left.toString()}${this.op}${this.right.toString()})`:`${this.left.toString()}${this.op}${this.right.toString()}`}constructor(e,t,n,a){this.op=e,this.left=t,this.right=n,this.brackets=a}}class h{toString(){return this.brackets?`(${this.left.toString()}${this.op}${this.right.toString()})`:`${this.left.toString()}${this.op}${this.right.toString()}`}constructor(e,t,n,a){this.op=e,this.left=t,this.right=n,this.brackets=a}}class p{toString(){let e=this.params.length;for(;e>=1&&(null===this.params[e-1]||void 0===this.params[e-1]);e--);return`${this.functionName}(${this.params.slice(0,e).map((e=>null==e?"":e.toString())).join(",")})`}constructor(...e){this.params=e}}class b extends p{constructor(...e){super(...e),this.functionName="ROUND"}}class f extends p{constructor(...e){super(...e),this.functionName="CEILING.MATH"}}class C extends p{toString(){const[e,t]=this.params;return null==t?`${this.functionName}(${e.toString()})`:super.toString()}constructor(...e){super(...e),this.functionName="FLOOR.MATH"}}class y extends p{constructor(...e){super(...e),this.functionName="MEDIAN"}}class v extends p{constructor(...e){super(...e),this.functionName="TRANSPOSE"}}class T extends p{constructor(...e){super(...e),this.functionName="SUBSTITUTE"}}class x extends p{toString(){const[e,t,n]=this.params;return null==n?null==t?`${this.functionName}(${e.toString()},,)`:`${this.functionName}(${e.toString()},${t.toString()})`:super.toString()}constructor(...e){super(...e),this.functionName="INDEX"}}class S extends p{constructor(...e){super(...e),this.functionName="ISBLANK"}}class w extends p{constructor(...e){super(...e),this.functionName="ISNUMBER"}}class E extends p{constructor(...e){super(...e),this.functionName="ISTEXT"}}class I extends p{constructor(...e){super(...e),this.functionName="ISERROR"}}class R extends p{constructor(...e){super(...e),this.functionName="ISLOGICAL"}}class A extends p{constructor(...e){super(...e),this.functionName="MATCH"}}class L extends p{constructor(...e){super(...e),this.functionName="XMATCH"}}class k extends p{constructor(...e){super(...e),this.functionName="XLOOKUP"}}class F extends p{constructor(...e){super(...e),this.functionName="MUNIT"}}class _ extends p{constructor(...e){super(...e),this.functionName="AVERAGEIFS"}}class P extends p{constructor(...e){super(...e),this.functionName="MAXIFS"}}class N extends p{constructor(...e){super(...e),this.functionName="MINIFS"}}class M extends p{constructor(...e){super(...e),this.functionName="COUNTIFS"}}class O extends p{constructor(...e){super(...e),this.functionName="SUMIFS"}}class D{toString(){const e=this.formula instanceof s||this.formula instanceof d||this.formula instanceof c,t=this.formula instanceof s?this.formula.getValue():this.formula.toString();switch(this.op){case"startWith":return e?`"=${t}*"`:`"="&${t}&"*"`;case"endWith":return e?`"=*${t}"`:`"=*"&${t}`;case"contain":return e?`"=*${t}*"`:`"=*"&${t}&"*"`;default:return e?`"${this.op}${t}"`:`"${this.op}"&${t}`}}constructor(e,t){this.op=e,this.formula=t}}class B{toString(){return`${this.range.toString()},${this.criteria.toString()}`}constructor(e,t){this.range=e,this.criteria=t}}class $ extends p{constructor(...e){super(...e),this.functionName="SUM"}}class H extends p{constructor(...e){super(...e),this.functionName="AVERAGE"}}class U extends p{constructor(...e){super(...e),this.functionName="MAX"}}class q extends p{constructor(...e){super(...e),this.functionName="MIN"}}class V extends p{constructor(...e){super(...e),this.functionName="MOD"}}class W extends p{constructor(...e){super(...e),this.functionName="COUNTA"}}class G extends p{constructor(...e){super(...e),this.functionName="COLUMN"}}class z extends p{constructor(...e){super(...e),this.functionName="ROW"}}class Q extends p{constructor(...e){super(...e),this.functionName="COLUMNS"}}class j extends p{constructor(...e){super(...e),this.functionName="ROWS"}}class J extends p{constructor(...e){super(...e),this.functionName="SEQUENCE"}}class Y extends p{constructor(...e){super(...e),this.functionName="SORTBY"}}class X{toString(){return`${this.array.toString()},${this.order}`}constructor(e,t){this.array=e,this.order=t}}class Z extends p{toString(){const[e,t,n]=this.params;return t?n?`${this.functionName}(${e.toString()},${t.toString()},${n.toString()})`:`${this.functionName}(${e.toString()},${t.toString()})`:`${this.functionName}(${e.toString()})`}constructor(...e){super(...e),this.functionName="SORT"}}class K{}class ee extends K{toString(){return`(TRUE)-(${this.condition.toString()})`}constructor(e){super(),this.condition=e}}class te extends K{toString(){return`${this.left instanceof te||this.left instanceof p?this.left.toString():`(${this.left.toString()})`}*${this.right instanceof te||this.right instanceof p?this.right.toString():`(${this.right.toString()})`}`}constructor(e,t){super(),this.left=e,this.right=t}}class ne extends K{toString(){return`${this.left instanceof ne||this.left instanceof te||this.left instanceof p?this.left.toString():`(${this.left.toString()})`}+${this.right instanceof ne||this.right instanceof te||this.right instanceof p?this.right.toString():`(${this.right.toString()})`}`}constructor(e,t){super(),this.left=e,this.right=t}}class ae extends p{constructor(...e){super(...e),this.functionName="FILTER"}}class oe extends p{constructor(...e){super(...e),this.functionName="CHOOSE"}}class re extends p{toString(){const[e,t,n]=this.params;return t||n?super.toString():`${this.functionName}(${e.toString()})`}constructor(...e){super(...e),this.functionName="UNIQUE"}}class ie extends p{constructor(...e){super(...e),this.functionName="MMULT"}}class le extends p{constructor(...e){super(...e),this.functionName="FIND"}}class se extends p{constructor(...e){super(...e),this.functionName="SEARCH"}}class ce extends p{constructor(...e){super(...e),this.functionName="IF"}}class de extends p{constructor(...e){super(...e),this.functionName="IFERROR"}}class ue extends p{constructor(...e){super(...e),this.functionName="LEN"}}class me extends p{constructor(...e){super(...e),this.functionName="RIGHT"}}class ge extends p{constructor(...e){super(...e),this.functionName="DATE"}}class he extends p{constructor(...e){super(...e),this.functionName="TIME"}}class pe extends p{constructor(...e){super(...e),this.functionName="NA"}}class be extends p{constructor(...e){super(...e),this.functionName="YEAR"}}class fe extends p{constructor(...e){super(...e),this.functionName="MONTH"}}class Ce extends p{constructor(...e){super(...e),this.functionName="DAY"}}class ye extends p{constructor(...e){super(...e),this.functionName="HOUR"}}class ve extends p{constructor(...e){super(...e),this.functionName="MINUTE"}}class Te extends p{constructor(...e){super(...e),this.functionName="SECOND"}}class xe extends p{constructor(...e){super(...e),this.functionName="TEXT"}}class Se{static formulaRound(e,t){return new b(e,new d(t))}static formulaCeilingMath(e){return new f(e)}static formulaFloorMath(e,t){return new C(e,t?new d(t):null)}static formulaMedian(e){return new y(e)}static formulaTranspose(e){return new v(e)}static formulaSubstitute(e,t,n){return new T(e,"string"==typeof t?new s(t):t,"string"==typeof n?new s(n):n)}static formulaIndex(e,t,n){let a,o;return a=null==t?null:"number"==typeof t||t instanceof Array?new u(t):t,o=null==n?null:"number"==typeof n||n instanceof Array?new u(n):n,new x(e,a,o)}static formulaIsBlank(e){return new S(e)}static formulaIsNumber(e){return new w(e)}static formulaIsText(e){return new E(e)}static formulaIsError(e){return new I(e)}static formulaIsLogical(e){return new R(e)}static formulaMatch(e,t,n){return new A(e,t,new d(null==n?1:n))}static formulaXMatch(e,t,n,a){return new L(e,t,new d(null==n?0:n),new u(null==a?1:a))}static formulaXLookup(e,t,n,a,o,r){return new k(e,t,n,a,new d(o||0),new d(null==r?1:r))}static formulaMunit(e){return new F("number"==typeof e?new d(e):e)}static formulaAverageifs(e,t){return new _(e,...t)}static formulaMaxifs(e,t){return new P(e,...t)}static formulaMinifs(e,t){return new N(e,...t)}static formulaCountifs(e){return new M(...e)}static formulaSumifs(e,t){return new O(e,...t)}static formulaSum(e){return e instanceof Array?new $(...e):new $(e)}static formulaAverage(e){return new H(e)}static formulaCountA(e){return new W(e)}static formulaMax(e){return new U(e)}static formulaMin(e){return e instanceof Array?new q(...e):new q(e)}static formulaMod(e,t){return new V(e,new u(t))}static formulaColumn(e){return new G(e)}static formulaRow(e){return new z(e)}static formulaColumns(e){return new Q(e)}static formulaRows(e){return new j(e)}static formulaSequence(e,t,n,a){const o="number"==typeof e?new d(e):e;let r,i,l;return r=null==a?null:"number"==typeof a?new d(a):a,i=null==n?null:"number"==typeof n?new d(n):n,l=null==t?null:"number"==typeof t?new d(t):t,new J(o,l,i,r)}static formulaSortBy(e,t){return new Y(e,...t)}static formulaSort(e,t,n){return null==(t||n)?new Z(e,null,null):new Z(e,"number"==typeof t||t instanceof Array?new u(t):t,null==n?null:new u(n))}static formulaFilter(e,t){return new ae(e,t)}static formulaChoose(e,...t){return new oe(e,...t)}static formulaUnique(e,t,n){return new re(e,null==t?null:new c(t),null==n?null:new c(t))}static formulaMmult(e,t){return new ie(e,t)}static formulaFind(e,t){return new le("string"==typeof e?new s(e):e,t)}static formulaSearch(e,t){return new se("string"==typeof e?new s(e):e,t)}static formulaIf(e,t,n){return new ce(e,t,n)}static formulaIfError(e,t){return new de(e,t)}static formulaLen(e){return new ue(e)}static formulaRight(e,t){return new me(e,t)}static formulaDate(e,t,n){const a="number"==typeof e?new d(e):e,o="number"==typeof t?new d(t):t,r="number"==typeof n?new d(n):n;return new ge(a,o,r)}static formulaTime(e,t,n){const a="number"==typeof e?new d(e):e,o="number"==typeof t?new d(t):t,r="number"==typeof n?new d(n):n;return new he(a,o,r)}static formulaNA(){return new pe}static formulaYear(e){return new be("number"==typeof e?new d(e):e)}static formulaMonth(e){return new fe("number"==typeof e?new d(e):e)}static formulaDay(e){return new Ce("number"==typeof e?new d(e):e)}static formulaHour(e){return new ye("number"==typeof e?new d(e):e)}static formulaMinute(e){return new ve("number"==typeof e?new d(e):e)}static formulaSecond(e){return new Te("number"==typeof e?new d(e):e)}static formulaText(e,t){return new xe(e,new s(t))}}function we(e){return e.replace(/"/g,'""')}function Ee(e){return e.replace(/~/g,"~~").replace(/\*/g,"~*").replace(/\?/g,"~?")}function Ie(e,t){return Se.formulaSubstitute(Se.formulaSubstitute(Se.formulaSubstitute(e,"~",t?"~~":Se.formulaIf(new h(">",Se.formulaMmult(Se.formulaIfError(Se.formulaFind(new m(["*","?"]),e),new d(0)),new u([[1],[1]])),new d(0)),new s("~~"),new s("~"))),"*","~*"),"?","~?")}function Re(e){const t=/^([0-9]+)-([0-9]+)-([0-9]+)T([0-9]+):([0-9]+):([0-9]+\.[0-9]+)/.exec(e);if(7!==t.length)throw new Error("wrong datetime structure");const[n,a,o,r,i,l]=t.filter(((e,t)=>t>0)).map((e=>parseFloat(e)));return new g("+",Se.formulaDate(n,a,o),Se.formulaTime(r,i,l))}class Ae extends Error{constructor(e,t){super(t||""),this.errorCode=e,Object.setPrototypeOf(this,Ae.prototype)}}function Le(e,t,n){const[a,o,r,s,c,u]=(e=>{if(Me(e)){const t=new l(n(e.sourceDataReference.left));return[Se.formulaYear(t),Se.formulaMonth(t),Se.formulaDay(t),Se.formulaHour(t),Se.formulaMinute(t),Se.formulaSecond(t)]}{const t=/^([0-9]+)-([0-9]+)-([0-9]+)T([0-9]+):([0-9]+):([0-9]+\.[0-9]+)/.exec(e.value);if(7!==t.length)throw new Error("wrong datetime structure");return t.filter(((e,t)=>t>0)).map((e=>new d(parseFloat(e))))}})(t);switch(e){case"date":return Se.formulaDate(a,o,r);case"decade":return Se.formulaFloorMath(Se.formulaMod(a,100),10);case"year":return a;case"quarter":return Se.formulaCeilingMath(new g("/",o,new d(3)));case"month":return o;case"dayOfMonth":return r;case"hour":return s;case"minute":return c;case"hourAndMinute":return Se.formulaTime(s,c,0);case"hourMinuteAndSecond":return Se.formulaTime(s,c,u);case"dateAndHour":return new g("+",Se.formulaDate(a,o,r),Se.formulaTime(s,0,0));case"dateHourAndMinute":return new g("+",Se.formulaDate(a,o,r),Se.formulaTime(s,c,0));case"dateHourMinuteAndSecond":return new g("+",Se.formulaDate(a,o,r),Se.formulaTime(s,c,u));case"monthAndDay":return Se.formulaDate(0,o,r);case"yearAndMonth":return Se.formulaDate(a,o,1);case"yearAndQuarter":return Se.formulaCeilingMath(new g("/",new g("+",new g("*",a,new d(12)),o),new d(3)));default:return(0,i.x)(e)}}function ke(e,t){if(!Me(e.source))throw new Ae("TranslationFailure","only column name expressions are supported as source of Date Function in project or group columns");switch(e.datePartFunction){case"date":return Se.formulaText(t,"yyyy-mm-dd");case"decade":return Se.formulaText(Se.formulaFloorMath(Se.formulaMod(Se.formulaYear(t),100),10),"00");case"year":return Se.formulaText(t,"yyyy");case"quarter":return Se.formulaText(Se.formulaCeilingMath(new g("/",Se.formulaMonth(t),new d(3))),'"Q"0');case"month":return Se.formulaText(t,"mm");case"dayOfMonth":case"hour":return Se.formulaText(t,"dd");case"minute":return Se.formulaText(Se.formulaMinute(t),"00");case"hourAndMinute":return Se.formulaText(t,"hh:mm AM/PM");case"hourMinuteAndSecond":return Se.formulaText(t,"hh:mm:ss AM/PM");case"dateAndHour":return Se.formulaText(t,"yyyy-mm-dd h AM/PM");case"dateHourAndMinute":return Se.formulaText(t,"yyyy-mm-dd h:mm AM/PM");case"dateHourMinuteAndSecond":return Se.formulaText(t,"yyyy-mm-dd h:mm:ss AM/PM");case"monthAndDay":return Se.formulaText(t,"mm-dd");case"yearAndMonth":return Se.formulaText(t,"yyyy-mm");case"yearAndQuarter":return new g("&",Se.formulaYear(t),Se.formulaText(Se.formulaCeilingMath(new g("/",Se.formulaMonth(t),new d(3))),'" Q"0'));default:return(0,i.x)(e.datePartFunction)}}!function(e){e.ProactiveLimitation="ProactiveLimitation",e.ValidationIssue="ValidationIssue",e.TranslationFailure="TranslationFailure",e.ExceedLengthLimitation="ExceedLengthLimitation",e.ContentTooLarge="ContentTooLarge",e.Unknown="Unknown"}(a||(a={}));class Fe{getTableAddress(){return this.isFake?null:this.address}getColumnAddress(e){return this.isFake?null:this.columns[e].columnAddress}getColumnLength(){return this.isFake?-1:this.columns.length}constructor(e,t,n){this.isFake=e,this.columns=t,this.address=n}}function _e(e){return!!e&&"query"===e.exprType}function Pe(e){return!!e&&"inQuery"===e.exprType}function Ne(e){return!!e&&"distinct"===e.exprType}function Me(e){return!!e&&"columnName"===e.exprType}function Oe(e){return!!e&&"datePart"===e.exprType}function De(e){return!!e&&["average","count","max","median","min","sum"].some((t=>t===e.exprType))}function Be(e){return!!e&&["and","or"].some((t=>t===e.exprType))}function $e(e){return!!e&&"not"===e.exprType}function He(e){return!!e&&["contains","equality","greaterThan","greaterThanOrEqual","lessThan","lessThanOrEqual","startsWith","endsWith"].some((t=>t===e.exprType))}function Ue(e){return!!e&&"numberLiteral"===e.exprType}function qe(e){return!!e&&"booleanLiteral"===e.exprType}function Ve(e){return!!e&&("dateTimeLiteral"===e.exprType||"stringLiteral"===e.exprType)}function We(e,t){return JSON.stringify(e)===JSON.stringify(t)}const Ge=8e5,ze=5e4,Qe=1e3,je=3e4,Je=5e4;class Ye{translate(){const{projectClause:e,whereClause:t,havingClause:n,sortClause:o,takeClause:r,groupClause:i,rankingClause:l}=this.queryResult;if(l)throw new Ae(a.TranslationFailure,"ranking clause is not supported at present");const s=e.length;let d=!1;if(o&&o.length>0)for(let t=0;t<o.length;t++)e.findIndex((e=>We(o[t].expr,e)))<0&&(d=!0,e.push(o[t].expr));if(e.length>254)throw new Ae(a.TranslationFailure,"length of project clause can not be larger than 254");const m=e.some((e=>De(e))),g=e.some((e=>Me(e)||Oe(e)));let h;const p=e.map((e=>Me(e)?e.sourceDataReference.left:null)),b=this.calculateColumnIndexNeedNumberCheckForFilter(t),f=this.includeNumberCheckInFilterCondition(b,t&&this.calculateFilterInclude(h,t));let C;if(!m&&g?h=this.calculateOnlyNonAggregations(p,f):(C=this.calculateBothColumnsAndAggregations(f,b),h=1===C.valueList.length?C.valueList[0]:Se.formulaChoose(new u(C.indexStartFromOneList),...C.valueList)),n&&(h=Se.formulaFilter(h,Se.formulaIfError(this.calculateFilterInclude(h,n),new c(!1)))),o){const t=o.map((t=>e.findIndex((e=>We(t.expr,e)))+1)),n=o.map((e=>"asc"===e.order?1:-1));h=Se.formulaSort(h,t,n)}else i&&(h=Se.formulaSort(h,1===e.length?null:e.map(((e,t)=>Me(e)||Oe(e)?t+1:null)).filter((e=>null!=e))));return r&&(h=Se.formulaIndex(h,Se.formulaSequence(r),Se.formulaSequence(1,e.length))),d&&(h=Se.formulaIndex(h,Se.formulaSequence(Se.formulaRows(h)),Se.formulaSequence(1,s))),h}calculateColumnIndexNeedNumberCheckForFilter(e){if(!e)return[];if(He(e)){const t=[];return!Me(e.left)||"greaterThanOrEqual"!==e.exprType&&"greaterThan"!==e.exprType&&"lessThanOrEqual"!==e.exprType&&"lessThan"!==e.exprType||t.push(e.left.sourceDataReference.left),!Me(e.right)||"greaterThanOrEqual"!==e.exprType&&"greaterThan"!==e.exprType&&"lessThanOrEqual"!==e.exprType&&"lessThan"!==e.exprType||t.push(e.right.sourceDataReference.left),t.filter(((e,t,n)=>n.indexOf(e)===t))}return $e(e)?this.calculateColumnIndexNeedNumberCheckForFilter(e.expr):Be(e)?[...this.calculateColumnIndexNeedNumberCheckForFilter(e.left),...this.calculateColumnIndexNeedNumberCheckForFilter(e.right)].filter(((e,t,n)=>n.indexOf(e)===t)):[]}includeNumberCheckInFilterCondition(e,t){let n=t;for(let t=0;t<e.length;t++)n=n?new te(Se.formulaIsNumber(new l(this.content.getColumnAddress(e[t]))),n):Se.formulaIsNumber(new l(this.content.getColumnAddress(e[t])));return n}calculateBothColumnsAndAggregations(e,t){const{projectClause:n,groupClause:o,whereClause:r}=this.queryResult,i=[],s=new l(this.content.getTableAddress()),c=Se.formulaUnique(this.calculateNonAggregatedPart(o||[],s,e)),d=[];let u=0;const m=!!o&&We(o,n.slice(0,o.length));return m&&(i.push(c),u=1),n.forEach((n=>{if(Me(n)||Oe(n)){if(!o)throw new Ae(a.TranslationFailure,"non-aggregated columns must be in the group clause if there are aggregations");m?d.push(1):(i.push(1===o.length?c:Se.formulaIndex(c,null,o.findIndex((e=>We(e,n)))+1)),u+=1,d.push(u))}else{if(!De(n))throw new Error;i.push(this.calculateAggregationWithCustomFunction(n,e,t)),u+=1,d.push(u)}})),{indexStartFromOneList:d,valueList:i}}calculateNonAggregatedPart(e,t,n){const a=this.calculateNonAggregatedPartWithoutFilter(e,t),o=1===a.valueList.length?a.valueList[0]:Se.formulaChoose(new u(a.indexStartFromOneList),...a.valueList);return n?Se.formulaFilter(o,n):o}calculateNonAggregatedPartWithoutFilter(e,t,n){const o=[];let r=0;const i=[],l=e.filter((e=>Me(e))).length,s=e.length-l,c=!n&&(l>3||0===s);if(c){const n=e.map((e=>Me(e)?e.sourceDataReference.left:0)),a=this.getSubTableWithSeveralColumns(n,t,!0);o.push(a),r=1}for(let n=0;n<e.length;n++){const l=e[n];if(Me(l))if(c)i.push(1);else{r+=1,i.push(r);const e=this.getSubTableWithSeveralColumns([l.sourceDataReference.left],t,!0);o.push(e)}else{if(r+=1,i.push(r),!Me(l.source))throw new Ae(a.TranslationFailure,"only columnName expressions are supported as the source of date part function in project or group clause");const e=this.getSubTableWithSeveralColumns([l.source.sourceDataReference.left],t,!0);o.push(ke(l,e))}}return{indexStartFromOneList:i,valueList:o}}calculateDatePartComparison(e){const{left:t,right:n,exprType:o}=e;if(!Oe(t)||!Oe(n)||t.datePartFunction!==n.datePartFunction)throw new Ae(a.TranslationFailure,"only two date part expressions with the same date part function could be compared");const r={greaterThan:">",greaterThanOrEqual:">=",lessThan:"<",lessThanOrEqual:"<=",equality:"="};if(!Object.prototype.hasOwnProperty.call(r,o))throw new Ae(a.TranslationFailure,"only >,>=,<,<=,= are supported in date part comparison");const i=Le(t.datePartFunction,t.source,this.content.getColumnAddress.bind(this.content)),l=Le(n.datePartFunction,n.source,this.content.getColumnAddress.bind(this.content));return new h(r[o],i,l)}calculateOnlyNonAggregations(e,t){const{groupClause:n,projectClause:a}=this.queryResult,o=new l(this.content.getTableAddress());let r=this.calculateNonAggregatedPart(a,o,t);return e&&e.length===this.content.getColumnLength()&&e.every(((e,t)=>e===t))&&(r=t?Se.formulaFilter(o,t):o),n&&(r=Se.formulaUnique(r)),r}calculateAggregationWithNativeFunction(e,t,n){const a=[...t||[],...n||[]],o=null!=(t||n),r=e.expr;if(Me(r)){const t=new l(this.content.getColumnAddress(r.sourceDataReference.left));switch(e.exprType){case"sum":return o?Se.formulaSumifs(t,a):Se.formulaSum(t);case"average":return o?Se.formulaAverageifs(t,a):Se.formulaAverage(t);case"count":{const e=(this.queryResult.groupClause||[]).map((e=>e.sourceDataReference.left));if(this.queryResult.groupClause&&!e.some((e=>e===r.sourceDataReference.left)))throw new Error("use custom calculation when there are group columns but the counted column is not one of them");return o?Se.formulaCountifs(a):Se.formulaCountA(t)}case"max":return o?Se.formulaMaxifs(t,a):Se.formulaMax(t);case"min":return o?Se.formulaMinifs(t,a):Se.formulaMin(t);case"median":if(!o)return Se.formulaMedian(t);break;default:(0,i.x)(e.exprType)}}if(null==r&&"count"===e.exprType)return o?Se.formulaCountifs(a):Se.formulaRows(new l(this.content.getTableAddress()));throw new Error}calculateAggregationWithCustomFunction(e,t,n){const{whereClause:a,groupClause:o}=this.queryResult,r=(o||[]).length,s=e.expr,c=new l(this.content.getTableAddress());if(!o||0===r){if(Me(s)){const n=new l(this.content.getColumnAddress(s.sourceDataReference.left)),a=t?Se.formulaFilter(n,t):n;switch(e.exprType){case"sum":return Se.formulaSum(a);case"count":{const e=t?Se.formulaFilter(n,new te(new ee(Se.formulaIsBlank(n)),t)):n;return Se.formulaCountA(e)}case"average":return Se.formulaAverage(a);case"median":return Se.formulaMedian(a);case"min":return Se.formulaMin(a);case"max":return Se.formulaMax(a);default:(0,i.x)(e.exprType)}}else{if(Ne(s)){if(s.exprs&&0!==s.exprs.length){if(1!==s.exprs.length)throw Error("doesn't support more than 1 expression in Distinct Expression");{const e=s.exprs[0],n=new l(this.content.getColumnAddress(e.sourceDataReference.left)),a=t?Se.formulaFilter(n,t):n;return t?Se.formulaSum(Se.formulaIf(Se.formulaIsError(Se.formulaUnique(a)),new d(0),new d(1))):Se.formulaCountA(Se.formulaUnique(a))}}throw Error("invalid arguments")}if(null==s&&"count"===e.exprType){const e=t?Se.formulaFilter(c,t):c;return Se.formulaRows(e)}}throw new Error("currently not support such expression")}const u=this.calculateNonAggregatedPart(o,c,t),m=this.calculateNonAggregatedPartWithoutFilter(o,c,!0),g=Ye.concatColumns(r,m.valueList,m.indexStartFromOneList);if(Me(s)){const h=new l(this.content.getColumnAddress(s.sourceDataReference.left)),p=a?this.includeNumberCheckInFilterCondition([...n,s.sourceDataReference.left].filter(((e,t,n)=>n.indexOf(e)===t)),this.calculateFilterInclude(c,a)):Se.formulaIsNumber(h),b=this.calculateNonAggregatedPart([...o||[],s],c,p),f=Se.formulaSort(b,Se.formulaSequence(1,r+1)),C=this.calculateNonAggregatedPart(o,c,p),y=Se.formulaSort(u,Se.formulaSequence(1,r)),v=t?Se.formulaFilter(g,t):g,T=Se.formulaSortBy(v,m.valueList.map((e=>new X(t?Se.formulaFilter(e,t):e,1)))),x=Se.formulaSort(C,Se.formulaSequence(1,r)),S=Se.formulaFilter(g,p),w=Se.formulaSortBy(S,m.valueList.map((e=>new X(Se.formulaFilter(e,p),1)))),E=Ye.getHelperMatrix(r,u,r),I=t?Se.formulaFilter(h,t):h,R=Se.formulaIndex(f,null,r+1),A=Se.formulaSortBy(Se.formulaSequence(Se.formulaRows(Se.formulaUnique(u))),(o||[]).map(((e,t)=>new X(r>1?Se.formulaIndex(Se.formulaUnique(u),null,t+1):Se.formulaUnique(u),1))));switch(e.exprType){case"sum":return Ye.customSumGroupBy(E,Se.formulaIf(Se.formulaIsNumber(I),I,new d(0)));case"count":return Ye.customCountGroupBy(E,I,!1,!1);case"average":{const e=Ye.customSumGroupBy(E,Se.formulaIf(Se.formulaIsNumber(I),I,new d(0))),t=Ye.customCountGroupBy(E,I,!0,!1);return Ye.customAverageGroupBy(e,t)}case"median":return Se.formulaSortBy(Ye.customMedianGroupBy(r,y,x,R,T,w),[new X(A,1)]);case"min":return Se.formulaSortBy(Ye.customMinMaxGroupBy(r,y,x,R,!1),[new X(A,1)]);case"max":return Se.formulaSortBy(Ye.customMinMaxGroupBy(r,y,x,R,!0),[new X(A,1)]);default:(0,i.x)(e.exprType)}}else if(Ne(s)){if(!s.exprs||0===s.exprs.length)throw Error("invalid arguments");if(1!==s.exprs.length)throw Error("doesn't support more than 1 expression in Distinct Expression");{const e=s.exprs[0];if(Me(e)){const n=Se.formulaUnique(this.calculateNonAggregatedPart([...o||[],e],c,t)),a=Ye.getHelperMatrix(r,n,r+1);return Ye.customCountGroupBy(a,Se.formulaIndex(n,null,r+1),!1,!0)}}}else if(null==s&&"count"===e.exprType){const e=Ye.getHelperMatrix(r,u,r),n=t?Se.formulaFilter(c,t):c,a=Se.formulaSequence(Se.formulaRows(n),1,1,0);return Se.formulaMmult(e,a)}throw new Error("currently not support such expression")}getSubTableWithSeveralColumns(e,t,n){return n&&1===e.length?new l(this.content.getColumnAddress(e[0])):Se.formulaIndex(t,1===e.length?null:Se.formulaSequence(Se.formulaRows(t)),1===e.length?e[0]+1:e.map((e=>e+1)))}static getHelperMatrix(e,t,n){const a=Ye.joinColumnText(e,t,n),o=Se.formulaUnique(a);return new g("+",new h("=",o,Se.formulaTranspose(a),!0),new d(0),!0)}static concatColumns(e,t,n){if(e<2)return t[0];let a=Se.formulaSubstitute(Se.formulaSubstitute(t[n[0]-1],"\\","\\\\"),",","\\,");for(let o=1;o<e;o++)a=new g("&",new g("&",a,new s(",")),Se.formulaSubstitute(Se.formulaSubstitute(t[n[o]-1],"\\","\\\\"),",","\\,"));return a}static joinColumnText(e,t,n){if(e<2)return n<2?t:Se.formulaIndex(t,null,1);let a=Se.formulaSubstitute(Se.formulaSubstitute(Se.formulaIndex(t,null,1),"\\","\\\\"),",","\\,");for(let n=1;n<e;n++)a=new g("&",new g("&",a,new s(",")),Se.formulaSubstitute(Se.formulaSubstitute(Se.formulaIndex(t,null,n+1),"\\","\\\\"),",","\\,"));return a}static customSumGroupBy(e,t){return Se.formulaMmult(e,t)}static customAverageGroupBy(e,t){return new g("/",e,t)}static customCountGroupBy(e,t,n,a){let o;return o=n?new g("+",Se.formulaIsNumber(t),new d(0)):a?Se.formulaSequence(Se.formulaRows(t),1,1,0):new g("-",new d(1),Se.formulaIsBlank(t)),Se.formulaMmult(e,o)}static customMedianGroupBy(e,t,n,a,o,r){const i=e>1?o:Ye.joinColumnText(e,t,e),l=Se.formulaUnique(i),s=e>1?r:Ye.joinColumnText(e,n,e),c=Se.formulaXMatch(l,s,0,1),m=Se.formulaXMatch(l,s,0,[1,-1]),h=Se.formulaMmult(Se.formulaIfError(m,new d(1)),new u([[.5],[.5]])),p=Se.formulaRound(new g("+",new g("*",h,new u([1,1])),new u([0,-.5])),0);return Se.formulaIf(Se.formulaIsNumber(c),Se.formulaMmult(Se.formulaIndex(a,p),new u([[.5],[.5]])),Se.formulaNA())}static customMinMaxGroupBy(e,t,n,a,o){const r=Ye.joinColumnText(e,t),i=Se.formulaUnique(r),l=Ye.joinColumnText(e,n),s=Se.formulaXMatch(i,l,0,1),c=Se.formulaXMatch(i,l,0,-1),u=o?c:s;return Se.formulaIfError(Se.formulaIndex(a,u),new d(0))}calculateWhereCriteria(e){if(Be(e)){if("or"===e.exprType)throw new Error('aggregation-ifs function could only deal with "AND" logic, fall back to custom function');return[...this.calculateWhereCriteria(e.left),...this.calculateWhereCriteria(e.right)]}if(He(e)){if(!Me(e.left)||(!(t=e.right)||!["numberLiteral","stringLiteral","booleanLiteral","dateTimeLiteral"].some((e=>e===t.exprType))))throw new Error("aggregation-ifs function could only deal with comparison of column and literals");const n=new l(this.content.getColumnAddress(e.left.sourceDataReference.left)),a=Ye.calculateLiteralPartInCriteria(e.right,!1),o=Ye.calculateLiteralPartInCriteria(e.right,!0);switch(e.exprType){case"greaterThan":return[new B(n,new D(">",a))];case"greaterThanOrEqual":return[new B(n,new D(">=",a))];case"lessThan":return[new B(n,new D("<",a))];case"lessThanOrEqual":return[new B(n,new D("<=",a))];case"equality":return[new B(n,new D("=",a))];case"contains":return[new B(n,new D("contain",o))];case"startsWith":return[new B(n,new D("startWith",o))];case"endsWith":return[new B(n,new D("endWith",o))];default:throw new Error("unsupported comparison type")}}var t;throw new Error}static calculateLiteralPartInCriteria(e,t){return Ve(e)?"dateTimeLiteral"===e.exprType?Re(e.value):new s(function(e,t){let n=t||e.includes("*")||e.includes("?")?e.replace(/~/g,"~~"):e;return n=n.replace(/\*/g,"~*").replace(/\?/g,"~?"),n}(e.value,t)):Ue(e)?new d(e.value):qe(e)?new c(e.value):(0,i.x)(e)}calculateGroupCriteria(e){const{groupClause:t,whereClause:n}=this.queryResult;let a=new l(this.content.getTableAddress());const o=(t||[]).map((e=>e.sourceDataReference.left+1));if(n){const t=this.calculateFilterInclude(a,n);a=Se.formulaFilter(a,this.includeNumberCheckInFilterCondition(e,t))}if(a=Se.formulaUnique(Se.formulaIndex(a,Se.formulaSequence(Se.formulaRows(a)),o)),1===t.length&&!n){const e=t[0],n=this.content.getColumnAddress(e.sourceDataReference.left);return[new B(new l(n),new g("&",new s("="),Ie(Se.formulaUnique(new l(n)))))]}return t.map(((e,t)=>{const n=e.sourceDataReference.left,o=this.content.getColumnAddress(n);return new B(new l(o),new g("&",new s("="),Se.formulaIndex(Ie(a),null,t+1)))}))}calculateFilterInclude(e,t){if(Be(t))switch(t.exprType){case"and":return new te(this.calculateFilterInclude(e,t.left),this.calculateFilterInclude(e,t.right));case"or":return new ne(this.calculateFilterInclude(e,t.left),this.calculateFilterInclude(e,t.right));default:(0,i.x)(t)}if($e(t))return new ee(this.calculateFilterInclude(e,t.expr));if(He(t)){if(["startsWith","endsWith","contains"].includes(t.exprType)&&!Ve(t.right))throw new Ae(a.TranslationFailure,"only string literals are supported as the right operator in startWith/endWith/contain.");if(Oe(t.left)&&Oe(t.right))return this.calculateDatePartComparison(t);switch(t.exprType){case"greaterThan":return new h(">",this.calculateFilterInclude(e,t.left),this.calculateFilterInclude(e,t.right));case"greaterThanOrEqual":return new h(">=",this.calculateFilterInclude(e,t.left),this.calculateFilterInclude(e,t.right));case"lessThan":return new h("<",this.calculateFilterInclude(e,t.left),this.calculateFilterInclude(e,t.right));case"lessThanOrEqual":return new h("<=",this.calculateFilterInclude(e,t.left),this.calculateFilterInclude(e,t.right));case"equality":{const n=new h("=",this.calculateFilterInclude(e,t.left),this.calculateFilterInclude(e,t.right));return!Ve(t.right)||"true"!==t.right.value.toLowerCase()&&"false"!==t.right.value.toLowerCase()?n:new ne(n,new h("=",this.calculateFilterInclude(e,t.left),this.calculateFilterInclude(e,{exprType:"booleanLiteral",value:"true"===t.right.value.toLowerCase()})))}case"startsWith":return new h("=",Se.formulaIfError(Se.formulaSearch(new s(Ee(t.right.value)),this.calculateFilterInclude(e,t.left)),new d(-1)),new d(1));case"endsWith":return new h("=",Se.formulaIfError(Se.formulaSearch(new s(Ee(t.right.value)),Se.formulaRight(this.calculateFilterInclude(e,t.left),Se.formulaLen(this.calculateFilterInclude(e,t.right)))),new d(-1)),new d(1));case"contains":return Se.formulaIsNumber(Se.formulaSearch(new s(Ee(t.right.value)),this.calculateFilterInclude(e,t.left)));default:(0,i.x)(t)}}if(De(t))return Se.formulaIndex(e,null,this.queryResult.projectClause.findIndex((e=>We(e,t)))+1);if(Me(t))return new l(this.content.getColumnAddress(t.sourceDataReference.left));if(Ve(t))return"dateTimeLiteral"===t.exprType?Re(t.value):new s(t.value);if(Ue(t))return new d(t.value);if(qe(t))return new c(t.value);if(Pe(t)){const e=this.content.getColumnAddress(t.columnNameExpr.sourceDataReference.left);return Se.formulaIsNumber(Se.formulaXMatch(new l(e),Se.formulaIndex(new Ye(t.query,this.content).translate(),null,t.query.projectClause.findIndex((e=>Me(e)&&e.sourceDataReference.left===t.columnNameExpr.sourceDataReference.left))+1),0,1))}if(_e(t))return new Ye(t,this.content).translate();throw new Error}constructor(e,t){this.queryResult=e,this.content=t}}var Xe=n(715227),Ze=n(83437),Ke=n(188053),et=n(279395),tt=n(857677),nt=n(75496),at=n(316904),ot=n(803716),rt=n(359730);async function it(e,t,n){const o=t.getTable(e),r=(o?o.getRange():t.getRange(e)).load(["rowIndex","columnIndex","rowCount","columnCount","address"]),i=o?.getHeaderRowRange().load("values"),l=o?.getDataBodyRange().load(["address","rowCount","columnCount"]);await e.sync();const{rowIndex:s,columnIndex:c,rowCount:d,columnCount:u}=r,m=Office.context.platform===Office.PlatformType.OfficeOnline;if(d*u>(m?ze:Ge))throw new Ae(a.ContentTooLarge,"exceed max supported cell count"+(m?" in XLO":""));const g=l||t.getSheet(e).getRangeByIndexes(s+1,c,d-1,u).load(["address","rowCount","columnCount"]),h=i||t.getSheet(e).getRangeByIndexes(s,c,1,u).load("values"),p=Array(u).fill(0).map(((e,t)=>g.getColumn(t).load(["address","valueTypes"]))),b=e=>{const t=/(^.+!)([a-zA-Z]+)([0-9]+:)([a-zA-Z]+)([0-9]+)$/.exec(e);if(6!==t.length)throw new Error("wrong address structure");return t.map(((e,t)=>t>1?`$${e}`:t>0?e:"")).join("")};return await e.sync(),function(e,t,n){const o=st(e),r=ct(e);if(o.length>0&&r.length>0){if(n.rowCount>Qe)throw new Ae(a.ContentTooLarge,"exceed max supported row count for queries with aggregation group-by")}else if(o.length>0){if(n.rowCount>je)throw new Ae(a.ContentTooLarge,"exceed max supported row count for queries with group-by")}else if(n.rowCount>Je)throw new Ae(a.ContentTooLarge,"exceed max supported row count");t.forEach((e=>{if(e.valueTypes.filter((e=>e.some((e=>e===Excel.RangeValueType.error||e===Excel.RangeValueType.richValue||e===Excel.RangeValueType.unknown)))).length>0)throw new Ae(a.ValidationIssue,"errors or rich values or unknown values in source are not supported")})),r.map((e=>e.index)).filter(((e,t,n)=>n.indexOf(e)===t)).forEach((e=>{if(t[e].valueTypes.filter((e=>e.some((e=>e===Excel.RangeValueType.string||e===Excel.RangeValueType.empty)))).length>0)throw new Ae(a.ValidationIssue,"strings or blanks in aggregated columns are not supported")})),o.forEach((e=>{const n=t[e].valueTypes.every((e=>e.some((e=>e===Excel.RangeValueType.double||e===Excel.RangeValueType.integer)))),o=t[e].valueTypes.every((e=>e.some((e=>e===Excel.RangeValueType.string))));if(!n&&!o)throw new Ae(a.ValidationIssue,"only support all numbers or all strings in group column")}))}(n,p,g),new Fe(!1,p.map(((e,n)=>{return{index:n,columnName:String(h.values[0][n]),columnAddress:o?(a=t.tableName,r=h.values[0][n],`${a}[${r.replace(/'/g,"''").replace(/#/g,"'#").replace(/\[/g,"'[").replace(/\]/g,"']").replace(/@/g,"'@")}]`):b(e.address),columnIndex:c+n,rowStartIndex:s+1,rowEndIndex:s+d-1};var a,r})),o?t.tableName:b(g.address))}function lt(e){const{whereClause:t,projectClause:n,havingClause:a,groupClause:o}=e;return[...[...n,...o||[]].filter((e=>Oe(e)&&Me(e.source))).map((e=>e.source.sourceDataReference.left)),...t?mt(t):[],...t?mt(a):[]].filter(((e,t,n)=>n.indexOf(e)===t))}function st(e){const{whereClause:t,groupClause:n,havingClause:a}=e;return[...n?n.filter((e=>Me(e))).map((e=>e.sourceDataReference.left)):[],...t?dt(t):[],...a?dt(a):[]].filter(((e,t,n)=>n.indexOf(e)===t))}function ct(e){const{projectClause:t,whereClause:n,havingClause:a,sortClause:o}=e;return[...t.filter((e=>De(e)&&Me(e.expr))).map((e=>({index:e.expr.sourceDataReference.left,aggregationType:e.exprType}))),...o?o.filter((e=>De(e.expr)&&Me(e.expr.expr))).map((e=>({index:e.expr.expr.sourceDataReference.left,aggregationType:e.expr.exprType}))):[],...n?ut(n):[],...a?ut(a):[]].filter(((e,t,n)=>n.findIndex((t=>t.index===e.index&&t.aggregationType===e.aggregationType))===t))}function dt(e){const t=gt(e);let n=[];return t.forEach((e=>{n=[...n,...st(e)]})),n}function ut(e){const t=gt(e);let n=[];return t.forEach((e=>{n=[...n,...ct(e)]})),n}function mt(e){return e?.exprType?Be(e)?[...mt(e.left),...mt(e.right)]:$e(e)?mt(e.expr):He(e)?[...mt(e.left),...mt(e.right)]:Pe(e)?lt(e.query):_e(e)?lt(e):Oe(e)&&Me(e.source)?[e.source.sourceDataReference.left]:[]:[]}function gt(e){return e?.exprType?Be(e)?[...gt(e.left),...gt(e.right)]:$e(e)?gt(e.expr):He(e)?[...gt(e.left),...gt(e.right)]:Pe(e)?[e.query]:_e(e)?[e]:[]:[]}var ht=n(312422),pt=n(342935),bt=n(391981),ft=n(540084),Ct=n(347145),yt=n(575934),vt=n(519272),Tt=n(542769),xt=n(400665),St=n(659126),wt=n(875100),Et=n(586428),It=n(126521),Rt=n(639599),At=n(581389),Lt=n(423235);const kt=8;function Ft(e,t,n){!function(e,t,n){const a=t.title;if(!1===n?.title?.visible)return void(e.title.visible=!1);if(n?.title?.text)return void(e.title.text=n.title.text);if(void 0===a)return;!function(e,t){const n=t.title;if(!n)throw new Error("Unsupported title type.");const a=255;let o=!1;e.title.text=Pt(n,a,(()=>{o=!0}));let r=0;const i=o?a-1:a;n.runs.every((t=>{const n=Math.min(t.text.length,i-r);if(null!=t.highlightStyleIndex&&n>0){e.title.getSubstring(r,n).font.color=Et.vA[t.highlightStyleIndex]}return r+=t.text.length,r<=i}))}(e,t)}(e,t,n),function(e,t,n){!function(e,t,n){const a=t.series,o=a.length,r=a.some((e=>"secondary"===e.valueAxisGroup)),i=a.some((e=>null!=e.highlightStyleIndex));a.forEach(((t,a)=>{const l=e.series.getItemAt(a),{hasDoughnutHoleSize:s,hasGapWidth:c,hasDataMarkers:d,hasSeriesOverlap:u,isClustered:m}=(0,Lt.Y)(t.layout),g=!!t.highlightedLineSegments&&t.highlightedLineSegments.length>0,h=t.exceptions&&t.exceptions.length>0,p=(0,vt.Pg)(t.layout);!(0,vt.iZ)(p.excelType)&&r&&(l.chartType=p.excelType);"secondary"===t.valueAxisGroup&&(l.axisGroup=Excel.AxisGroup.secondary),g&&(l.format.line.color=Et.Zx),i&&function(e,t){const{hasDataMarkers:n,isLine:a}=(0,Lt.Y)(t.layout),o=null!=t.highlightStyleIndex?Et.hr[t.highlightStyleIndex]:Et.wm;n?(e.markerBackgroundColor=o,e.markerForegroundColor=Et.ON):a?e.format.line.color=o:e.format.fill.setSolidColor(o)}(l,t),h&&function(e,t){const{hasDataMarkers:n,isLine:a}=(0,Lt.Y)(t.layout);n?e.markerBackgroundColor=Et.Zx:a?e.format.line.color=Et.Zx:e.format.fill.setSolidColor(Et.Zx)}(l,t),s&&(l.doughnutHoleSize=Et.Az),c&&(l.gapWidth=m&&o>1?Math.min(Et.tF+o*Et.P6,500):Et.BC),d&&(l.markerStyle=Excel.ChartMarkerStyle.circle,l.markerSize=Et.Qi,l.markerForegroundColor=Et.ON),l.hasDataLabels=n?.series?.[a]?.dataLabels?.visible??!1;u&&!r&&(l.overlap=Et.z8)}))}(e,t,n)}(e,t,n),function(e,t,n){const a=t.series,o=a.some((e=>null!=e.highlightStyleIndex));a.forEach(((t,a)=>{if(t.trendlines&&t.trendlines.length>0){if("linear"===t.trendlines[0].trendType){const r=t.exceptions&&t.exceptions.length>0,i=e.series.getItemAt(a).trendlines.add(Excel.TrendlineType.linear);i.format.line.lineStyle=Excel.ChartLineStyle.roundDot,o&&(null!=t.highlightStyleIndex?i.format.line.color=Et.hr[t.highlightStyleIndex]:i.format.line.color=Et.wm),r&&(i.format.line.color=Et.Zx),null!=n?.series?.[a]?.trendline?.showEquation&&(i.showEquation=n.series[a]?.trendline?.showEquation??!1)}}}))}(e,t,n),function(e,t,n){const a=t.series.length,o=t.series[0],r=o.exceptions&&o.exceptions.length>0,i=(0,vt.Pg)(o.layout).hasCategoryLegend,l=null!=n?.legend?.visible?n.legend.visible:a>1||i&&!r;e.legend.visible=l,l&&(e.legend.position=a<=kt?Excel.ChartLegendPosition.bottom:Excel.ChartLegendPosition.right)}(e,t,n),function(e,t,n){if(!t.axes)return;(function(e,t){const n=(0,vt.ip)(t);t.axes.forEach((t=>{if(t.reversePlotOrder){const a=t.dimensionType,o="secondary"===t.axisGroup&&n.secondary?n.secondary.insightsType:n.primary.insightsType,r=(0,Rt.C$)(o,a),i=e.axes.getItem(r.excelAxisType,Nt(t.axisGroup));i.crosses=Excel.AxisCrosses.maximum,i.reversePlotOrder=!0}}))})(e,t),function(e,t,n){const a=(0,vt.ip)(t);t.axes.forEach((t=>{const o=t.title;if(o){const r=t.dimensionType,i="secondary"===t.axisGroup&&a.secondary?a.secondary.insightsType:a.primary.insightsType,l=(0,Rt.C$)(i,r),s=e.axes.getItem(l.excelAxisType,Nt(t.axisGroup));s.title.text=Pt(o,255),l.excelAxisType===Excel.AxisType.category&&"primary"===t.axisGroup?(n?.primaryCategoryAxis?.title?.text&&(s.title.text=n.primaryCategoryAxis.title.text),null!=n?.primaryCategoryAxis?.title?.visible&&(s.title.visible=n.primaryCategoryAxis.title.visible)):l.excelAxisType===Excel.AxisType.value&&"primary"===t.axisGroup&&(n?.primaryValueAxis?.title?.text&&(s.title.text=n.primaryValueAxis.title.text),null!=n?.primaryValueAxis?.title?.visible&&(s.title.visible=n.primaryValueAxis.title.visible))}}))}(e,t,n),function(e,t){const n=(0,vt.ip)(t),a=n.secondary?n.primary.positionAxisOnTick&&n.secondary.positionAxisOnTick:n.primary.positionAxisOnTick;Office.context.requirements.isSetSupported("ExcelApi","1.8")&&a&&(e.axes.categoryAxis.isBetweenCategories=!1)}(e,t),function(e,t,n){if(null==n?.primaryCategoryAxis?.minimum&&null==n?.primaryCategoryAxis?.maximum&&null==n?.primaryValueAxis?.minimum&&null==n?.primaryValueAxis?.maximum)return;const a=(0,vt.ip)(t);t.axes.forEach((t=>{const o="secondary"===t.axisGroup&&a.secondary?a.secondary.insightsType:a.primary.insightsType,r=t.dimensionType,i=(0,Rt.C$)(o,r),l=e.axes.getItem(i.excelAxisType,Nt(t.axisGroup));i.isValue&&"primary"===i.axisGroup&&(i.excelAxisType===Excel.AxisType.category&&(null!=n.primaryCategoryAxis?.minimum&&(l.minimum=n.primaryCategoryAxis.minimum),null!=n.primaryCategoryAxis?.maximum&&(l.maximum=n.primaryCategoryAxis.maximum)),i.excelAxisType===Excel.AxisType.value&&(null!=n.primaryValueAxis?.minimum&&(l.minimum=n.primaryValueAxis.minimum),null!=n.primaryValueAxis?.maximum&&(l.maximum=n.primaryValueAxis.maximum)))}))}(e,t,n)}(e,t,n);(0,vt.ip)(t).primary.excelType===Excel.ChartType.histogram?function(e,t){if(1!==t.series.length)return;const n=e.series.getItemAt(0);n.format.fill.setSolidColor(Et.w8);const a=t.series[0].binOptions;a&&(a.usingBinCount?(n.binOptions.type=Excel.ChartBinType.binCount,n.binOptions.count=a.binCount):(n.binOptions.type=Excel.ChartBinType.binWidth,n.binOptions.width=a.binWidth),a.overflow&&(n.binOptions.overflowValue=a.overflow),a.underflow&&(n.binOptions.underflowValue=a.underflow),n.gapWidth=Et.Wx);e.axes.valueAxis.majorGridlines.visible=!0}(e,t):function(e,t,n){if(!n)return;const a=(0,vt.ip)(t);t.axes.forEach((t=>{const o=t.dimensionType,r="secondary"===t.axisGroup&&a.secondary?a.secondary.insightsType:a.primary.insightsType,i=(0,Rt.C$)(r,o),l=e.axes.getItem(i.excelAxisType,Nt(t.axisGroup));i.excelAxisType===Excel.AxisType.category&&"primary"===t.axisGroup&&null!=n.primaryCategoryAxis?.majorGridlines?.visible?l.majorGridlines.visible=n.primaryCategoryAxis.majorGridlines.visible:i.excelAxisType===Excel.AxisType.value&&"primary"===t.axisGroup&&null!=n.primaryValueAxis?.majorGridlines?.visible&&(l.majorGridlines.visible=n.primaryValueAxis.majorGridlines.visible)}))}(e,t,n)}function _t(e,t,n){!function(e,t){const n=t.series;n.forEach(((t,n)=>{const a=e.series.getItemAt(n);t.exceptions&&t.exceptions.length>0&&function(e,t){const{hasDataMarkers:n,isLine:a}=(0,Lt.Y)(t.layout);t.exceptions.forEach((t=>{const o=e.points.getItemAt(t);a||n?(o.markerStyle=Excel.ChartMarkerStyle.circle,o.markerSize=Et.Qi,o.markerBackgroundColor=Et.SB,o.markerForegroundColor=Et.ON):o.format.fill.setSolidColor(Et.SB)}))}(a,t),(0,o.o_)(t,["highlightedLineSegments"])&&t.highlightedLineSegments.length>0&&function(e,t){t.highlightedLineSegments.forEach((n=>{const a=e.points.getItemAt(n+1),o=null!=t.highlightStyleIndex?t.highlightStyleIndex:0;a.format.border.color=Et.hr[o],a.format.border.weight=Et.D9}))}(a,t)})),function(e,t){const n=t.series,a=(o=n,o.every((e=>e.dataBindings.some((e=>"title"===e.dimensionType)))));var o;n.forEach(((n,o)=>{const r=e.series.getItemAt(o),i=n.title;if(!i)return;const l=(0,vt.ip)(t);(0,vt.iZ)(l.primary.excelType)||l.secondary&&(0,vt.iZ)(l.secondary.excelType)||a||(r.name=Pt(i,255))}))}(e,t)}(e,t),function(e,t){if(Office.context.requirements.isSetSupported("ExcelApi","1.9")){const n=t.title,a=n?(0,yt.HW)(n):"",o=(0,vt.ip)(t),r=o.secondary?(0,It.L)((0,et.$0s)(),o.primary.localizedName,o.secondary.localizedName):o.primary.localizedName,i=`${(0,It.L)((0,et.eZ0)(),r)} ${a}`,l=(0,et.AXy)();e.worksheet.shapes.getItem(e.id).altTextDescription=`${i}\n\n${l}`}}(e,t);const a=function(e,t,n){if(!t.axes)return()=>{};const a=function(e,t){const n=(0,vt.ip)(t),a=t.axes.filter((e=>!!e.linearValueScale&&"includeZero"===e.linearValueScale.zeroPolicy)).map((t=>{const a=t.dimensionType,o="secondary"===t.axisGroup&&n.secondary?n.secondary.insightsType:n.primary.insightsType,r=(0,Rt.C$)(o,a);return e.axes.getItem(r.excelAxisType,Nt(t.axisGroup)).load(["minimum","maximum"])}));return()=>{a.forEach((e=>{Math.sign(e.minimum)===Math.sign(e.maximum)&&(e.minimum>0?e.minimum=0:e.maximum=0)}))}}(e,t),o=function(e,t){const n=(0,vt.ip)(t);return()=>{t.axes.forEach((a=>{const o="secondary"===a.axisGroup&&n.secondary?n.secondary.insightsType:n.primary.insightsType;if("histogram"===o||"areaStacked100"===o||"barStacked100"===o||"columnStacked100"===o||"lineStacked100"===o)return;const r=a.dimensionType,l=(0,Rt.C$)(o,r);if(l.isValue){const n=(0,At.r)(t,r,a.axisGroup);if(!n)return;const o=e.axes.getItem(l.excelAxisType,Nt(a.axisGroup)),s=(0,wt.wM)(n.min,n.max);if(!s)return void(o.displayUnit=Excel.ChartAxisDisplayUnit.none);const c=s.languageUnitsValue;switch(c){case wt.YO.Thousands:o.displayUnit=Excel.ChartAxisDisplayUnit.thousands;break;case wt.YO.Millions:o.displayUnit=Excel.ChartAxisDisplayUnit.millions;break;case wt.YO.Billions:o.displayUnit=Excel.ChartAxisDisplayUnit.billions;break;case wt.YO.Trillions:o.displayUnit=Excel.ChartAxisDisplayUnit.trillions;break;case wt.YO.None:o.displayUnit=Excel.ChartAxisDisplayUnit.none;break;default:(0,i.c)(c)}}}))}}(e,t),r=function(e,t,n){const a=(0,vt.ip)(t),o=[...(0,Rt.lf)(a.primary.insightsType)];if(a.secondary){const e=(0,Rt.C$)(a.secondary.insightsType,"values");e&&o.push(e)}const r=o.map(((t,n)=>t.isValue?{valueAxis:a.secondary&&n===o.length-1?e.axes.getItem(t.excelAxisType,Excel.ChartAxisGroup.secondary).load(["minimum","maximum"]):e.axes.getItem(t.excelAxisType,Excel.ChartAxisGroup.primary).load(["minimum","maximum"]),crossingAxis:a.secondary&&n===o.length-1?void 0:e.axes.getItem(o[1-n].excelAxisType)}:null)).filter((e=>null!==e));return()=>{if(2===o.length||3===o.length){if(r.forEach((e=>{const t=e.valueAxis.maximum>0,n=e.valueAxis.minimum<0;n&&!t&&(e.valueAxis.position=Excel.ChartAxisPosition.maximum),n&&t&&e.crossingAxis&&(e.crossingAxis.tickLabelPosition=Excel.AxisTickLabelPosition.low)})),!1===n?.primaryCategoryAxis?.tickLabel?.visible){e.axes.getItem(Excel.AxisType.category,Excel.AxisGroup.primary).tickLabelPosition=Excel.AxisTickLabelPosition.none}if(!1===n?.primaryValueAxis?.tickLabel?.visible){e.axes.getItem(Excel.AxisType.value,Excel.AxisGroup.primary).tickLabelPosition=Excel.AxisTickLabelPosition.none}}}}(e,t,n);return()=>{a(),o(),r()}}(e,t,n);return()=>{a()}}function Pt(e,t=-1,n){const a=e.runs.map((e=>e.text)).join("");return a.length<=t||-1===t?a:(n&&n(),`${a.slice(0,t-1)}…`)}function Nt(e){if(void 0!==e)switch(e){case"primary":return Excel.AxisGroup.primary;case"secondary":return Excel.AxisGroup.secondary;default:(0,i.c)(e)}}var Mt=n(507628);const Ot=250,Dt=250;function Bt(e,t,n){const a=n.indexOf("!"),o=n.lastIndexOf(":");if(-1!==a&&o>a){const r=e.getRange(n.substring(a+1,o)),i=e.getRange(n.substring(o+1));t.setPosition(r,i)}else t.setPosition(n)}async function $t(e,t,n,a,o){const r=n.getSheet(e),i=await async function(e,t,n,a,o,r){const i=(0,vt.ip)(t);if((0,vt.iZ)(i.primary.excelType)||i.secondary&&(0,vt.iZ)(i.secondary.excelType)){const i=await function(e,t,n,a){return async o=>{const r=(0,vt.ip)(e),i=e.data;if(1!==e.series.length)return Promise.reject(new Error("Ivy Chart contains incorrect series."));const l=e.series[0];if(1!==l.dataBindings.length)return Promise.reject(new Error("Ivy Chart contains incorrect dataBindings."));const s=l.dataBindings[0];if("values"!==s.dimensionType)return Promise.reject(new Error("Unrecognized dimension type."));const c=Ut(i,s.dimensionId),d=t.getRangeFromReferences(o,c.references);Office.context.platform===Office.PlatformType.OfficeOnline&&d.getCell(0,0).select();const u=n.charts.add(r.primary.excelType,d);u.top=Ot,u.left=Dt,Ft(u,e,a);const m=(0,Mt.A)();o.trace(m);const g=(0,Tt.U)((()=>u.delete()),m);n.load("name"),u.load(["name","id"]);try{await o.sync()}catch(e){await g(e)}const h=e=>(e.workbook.worksheets.getItem(n.name).charts.getItem(u.name).delete(),e.sync());return(0,Ct.iPS)("Microsoft.Office.Excel.FA000000124.QueryCharts",!1)||u.activate(),await o.sync(),{result:u,undo:h}}}(t,n,o,r)(e);return a.push(i.undo),i.result}{const i=await function(e,t){return async n=>{const a=(0,xt.wZ)(t);await n.sync();const o=(0,vt.ip)(e),r=a()||t.getCell(0,0),i=t.charts.add(o.primary.excelType,r);i.top=Ot,i.left=Dt;const l=(0,Mt.A)();n.trace(l);const s=(0,Tt.U)((()=>i.delete()),l);i.series.load("count"),t.load("name"),i.load(["name","id"]);try{await n.sync()}catch(e){await s(e)}const c=e=>(e.workbook.worksheets.getItem(t.name).charts.getItem(i.name).delete(),e.sync());(0,Ct.iPS)("Microsoft.Office.Excel.FA000000124.QueryCharts",!1)||i.activate();for(let e=i.series.count-1;e>=0;e--)i.series.getItemAt(e).delete();return await n.sync(),{result:i,undo:c}}}(t,o)(e);return a.push(i.undo),async function(e,t,n,a,o){const r=n.data,i=n.series,l=[];i.forEach((()=>{t.series.add()})),Ft(t,n,o),i.forEach(((n,o)=>{const i=t.series.getItemAt(o);n.dataBindings.forEach((t=>{const n=Ut(r,t.dimensionId),s=a.getRangeFromReferences(e,n.references);switch(t.dimensionType){case"values":case"yValues":i.setValues(s);break;case"categories":case"xValues":i.setXAxisValues(s);break;case"title":s.load("address"),l.push({index:o,range:s});break;default:throw new Error("Unrecognized dimension type.")}}))})),0!==l.length&&await e.sync();return l.forEach((e=>{t.series.getItemAt(e.index).name=`=${e.range.address}`})),t}(e,i.result,t,n,r)}}(e,t,n,a,r,o),l=_t(i,t,o),s=(0,Ct.iPS)("Microsoft.Office.Excel.FA000000124.QueryCharts",!1)?void 0:(0,rt.x)(e,i.worksheet);if(i.worksheet.load("name"),await e.sync(),l(),(0,Ct.iPS)("Microsoft.Office.Excel.FA000000124.QueryCharts",!1))i.activate();else{const t=await s()(e);a.push(t.undo)}return i}async function Ht(e,t,n){const a=[];n.forEach((t=>{const n=(0,St.dn)(e,t.destination);a.push({visualChart:t.visualChart,dataProvider:t.dataProvider,insertionSheet:n,chartConfig:t.chartConfig,destination:t.destination})}));const o=await async function(e,t,n){const a=Array(n.length),o=[],r=[],i=[],l=[];for(let e=0;e<n.length;++e){const t=n[e],a=(0,vt.ip)(t.visualChart);(0,vt.iZ)(a.primary.excelType)||a.secondary&&(0,vt.iZ)(a.secondary.excelType)?(o.push(t),r.push(e)):(i.push(t),l.push(e))}if(o.length>0){const n=await function(e){return async t=>{const n=[],a=[];for(const o of e){const e=(0,vt.ip)(o.visualChart),r=o.visualChart.data;if(1!==o.visualChart.series.length)return Promise.reject(new Error("Ivy Chart contains incorrect series."));const i=o.visualChart.series[0];if(1!==i.dataBindings.length)return Promise.reject(new Error("Ivy Chart contains incorrect dataBindings."));const l=i.dataBindings[0];if("values"!==l.dimensionType)return Promise.reject(new Error("Unrecognized dimension type."));const s=Ut(r,l.dimensionId),c=o.dataProvider.getRangeFromReferences(t,s.references),d=o.insertionSheet.charts.add(e.primary.excelType,c);Bt(o.insertionSheet,d,o.destination),Ft(d,o.visualChart,o.chartConfig),o.insertionSheet.load("name"),d.load(["name","id"]),n.push(d);const u=(0,Mt.A)();t.trace(u),a.push(u)}try{await t.sync()}catch(e){for(let e=0;e<n.length;++e)(0,Tt.U)((()=>n[e].delete()),a[e])}const o=t=>{for(let a=0;a<n.length;++a){t.workbook.worksheets.getItem(e[a].insertionSheet.name).charts.getItem(n[a].name).delete()}return t.sync()};return await t.sync(),{result:n,undo:o}}}(o)(e);t.push(n.undo);const i=n.result;for(let e=0;e<i.length;++e)a[r[e]]=i[e]}if(i.length>0){const n=[];for(let e=0;e<i.length;++e)n.push({visualChart:i[e].visualChart,insertionSheet:i[e].insertionSheet,destination:i[e].destination});const o=await function(e){return async t=>{const n=[];e.forEach((e=>{const t=(0,xt.wZ)(e.insertionSheet);n.push(t)})),await t.sync();const a=[],o=[];for(let r=0;r<e.length;++r){const i=e[r],l=(0,vt.ip)(i.visualChart),s=(0,n[r])()||i.insertionSheet.getCell(0,0),c=i.insertionSheet.charts.add(l.primary.excelType,s);Bt(i.insertionSheet,c,i.destination),c.series.load("count"),i.insertionSheet.load("name"),c.load(["name","id"]),a.push(c);const d=(0,Mt.A)();t.trace(d),o.push(d)}try{await t.sync();const n=t=>{for(let n=0;n<a.length;++n){t.workbook.worksheets.getItem(e[n].insertionSheet.name).charts.getItem(a[n].name).delete()}return t.sync()};return a.forEach((e=>{for(let t=e.series.count-1;t>=0;t--)e.series.getItemAt(t).delete()})),await t.sync(),{result:a,undo:n}}catch(e){for(let e=0;e<a.length;++e)(0,Tt.U)((()=>a[e].delete()),o[e]);throw e}}}(n)(e);t.push(o.undo);const r=[];for(let e=0;e<i.length;++e)r.push({chart:o.result[e],visualChart:i[e].visualChart,dataProvider:i[e].dataProvider,chartConfig:i[e].chartConfig});const s=await async function(e,t){const n=[],a=[];for(let o=0;o<t.length;++o){const r=t[o],i=r.visualChart.data,l=r.visualChart.series;for(let e=0;e<l.length;++e)r.chart.series.add();Ft(r.chart,r.visualChart,r.chartConfig),l.forEach(((t,n)=>{const l=r.chart.series.getItemAt(n);t.dataBindings.forEach((t=>{const s=Ut(i,t.dimensionId),c=r.dataProvider.getRangeFromReferences(e,s.references);switch(t.dimensionType){case"values":case"yValues":l.setValues(c);break;case"categories":case"xValues":l.setXAxisValues(c);break;case"title":c.load("address"),a.push({chartIndex:o,seriesIndex:n,range:c});break;default:throw new Error("Unrecognized dimension type.")}}))})),n.push(r.chart)}0!==a.length&&await e.sync();return a.forEach((e=>{n[e.chartIndex].series.getItemAt(e.seriesIndex).name=`=${e.range.address}`})),n}(e,r);for(let e=0;e<s.length;++e)a[l[e]]=s[e]}return a}(e,t,a),r=[];for(let e=0;e<o.length;++e){const t=_t(o[e],a[e].visualChart,a[e].chartConfig);r.push(t)}return await e.sync(),r.forEach((e=>{e()})),o}function Ut(e,t){const n=e.dimensions.find((e=>e.id===t));if(void 0===n)throw new Error("Cannot find dimension by id.");return n}function qt(e,t,n,a,o,r){const i=t.length>0?t[0].length:0;if(r>0&&i>0){const l=e.getRangeByIndexes(a,o,r,i);l.numberFormat=t.slice(0,r),l.numberFormatLocal=n.slice(0,r)}for(let l=0;l<i;l++){const i=t.slice(r).map((e=>[e[l]])),s=n.slice(r).map((e=>[e[l]]));let c=0;for(let t=0;t<=i.length;t++)if(t===i.length&&i.length>=1||0!==t&&i[t-1][0]!==i[t][0]){const n=e.getRangeByIndexes(a+r+c,o+l,t-c,1);n.numberFormat=i.slice(c,c+1),n.numberFormatLocal=s.slice(c,c+1),c=t}}}function Vt(e,t,n,a,o,r,i){const l=function(e,t,n,a,o,r,i){const l=t.length,s=l>0?t[0].length:0,c=e.getRangeByIndexes(o,r,l,s);return c.values=t,qt(e,n,a,o,r,i),c}(e,t,n,a,o,r,i);l.format.autofitColumns();const s=e.tables.add(l,!0);let c=async e=>{};if((0,Ct.iPS)("Microsoft.Office.Excel.FA000000124.QueryCharts",!1)){const t=e.id;c=async e=>{e.workbook.worksheets.getItem(t).tables.getItemAt(0).delete()}}return{result:s,undo:c}}const Wt=1,Gt=0,zt="A";var Qt=n(321231),jt=n(1541);function Jt(e,t){const{is29Feb1900:n,adjustedRaw:a,date:o}=(0,jt.f9)(e);if(Number.isNaN(o.getDay()))return a.toString();const r=o.getFullYear().toString(),l=o.getMonth(),s=function(e){switch(e){case 0:return(0,et.DIE)();case 1:return(0,et.Fsb)();case 2:return(0,et.KBQ)();case 3:return(0,et.ds$)();case 4:return(0,et.I53)();case 5:return(0,et.pRP)();case 6:return(0,et.jpr)();case 7:return(0,et.sY1)();case 8:return(0,et.sGO)();case 9:return(0,et.NeW)();case 10:return(0,et.JGR)();case 11:return(0,et.kTv)();default:throw new Error(`invalid month in date part month grouping, month = ${e}`)}}(l),c=function(e){switch(Math.floor(e/3)){case 0:return(0,et.vKl)();case 1:return(0,et.CNP)();case 2:return(0,et.v$B)();case 3:return(0,et.C2X)();default:throw new Error(`invalid month in date part quarter grouping, month = ${e}`)}}(l),d=n?"29":o.getDate().toString();switch(t){case Excel.PivotTableDateGroupBy.bySeconds:case Excel.PivotTableDateGroupBy.byMinutes:case Excel.PivotTableDateGroupBy.byHours:case Excel.PivotTableDateGroupBy.byDays:return`${d}-${s}`;case Excel.PivotTableDateGroupBy.byMonths:return s;case Excel.PivotTableDateGroupBy.byQuarters:return`Qtr${c}`;case Excel.PivotTableDateGroupBy.byYears:return r;case Excel.PivotTableDateGroupBy.invalid:return"";default:return(0,i.x)(t)}}function Yt(e,t,n){const a=function(e,t,n){const a=new Map,o=new Map;if(t.filterFields.forEach((t=>{const r=t.datePart;if(r){const i=[],l=n.get(t.name)||t.name;Xt(r.datePartOverride).forEach((t=>{const n=e.hierarchies.getItem(l).fields.getItem(l),a=e.addDateGroup(n,t);a.load("name"),i.push(a);const s=r.values.map((e=>Jt(e,t)));o.set(a,s)})),i.length>0&&a.set(t,i)}})),0===a.size)return;const r=e=>{const t=[];return e.forEach((e=>{const n=a.get(e);n?n.forEach((e=>{t.push({name:e.name,datePart:void 0,values:o.get(e)||[]})})):t.push(e)})),t};return()=>({...t,filterFields:r(t.filterFields)})}(e,t,n),o=function(e,t,n){const a=new Map;if(t.rowFields.concat(t.columnFields).forEach((t=>{if(t.datePartOverride){const o=[],r=n.get(t.name)||t.name;Xt(t.datePartOverride).forEach((t=>{const n=e.hierarchies.getItem(r).fields.getItem(r),a=e.addDateGroup(n,t);a.load("name"),o.push(a)})),o.length>0&&a.set(t,o)}})),0===a.size)return;const o=e=>{const t=[];return e.forEach((e=>{const n=a.get(e);n?n.forEach((n=>{t.push({...e,name:n.name,datePartOverride:void 0})})):t.push(e)})),t};return()=>({...t,rowFields:o(t.rowFields),columnFields:o(t.columnFields)})}(e,t,n);if(a||o)return()=>{const e=a?a():t,n=o?o():t;return{...t,filterFields:e.filterFields,rowFields:n.rowFields,columnFields:n.columnFields}}}function Xt(e){switch(e){case"year":case"quarter":return[Excel.PivotTableDateGroupBy.byYears];case"yearAndQuarter":return[Excel.PivotTableDateGroupBy.byYears,Excel.PivotTableDateGroupBy.byQuarters];case"yearAndMonth":return[Excel.PivotTableDateGroupBy.byYears,Excel.PivotTableDateGroupBy.byMonths];case"month":return[Excel.PivotTableDateGroupBy.byMonths];case"date":return[Excel.PivotTableDateGroupBy.byYears,Excel.PivotTableDateGroupBy.byMonths,Excel.PivotTableDateGroupBy.byDays];case"dateAndHour":return[Excel.PivotTableDateGroupBy.byYears,Excel.PivotTableDateGroupBy.byMonths,Excel.PivotTableDateGroupBy.byDays,Excel.PivotTableDateGroupBy.byHours];case"dateHourAndMinute":return[Excel.PivotTableDateGroupBy.byYears,Excel.PivotTableDateGroupBy.byMonths,Excel.PivotTableDateGroupBy.byDays,Excel.PivotTableDateGroupBy.byHours,Excel.PivotTableDateGroupBy.byMinutes];default:return[]}}const Zt={rowFields:[],columnFields:[],filterFields:[],dataFields:[],valueFilters:[],labelFilters:[],dateFilters:[],highlightCellReferences:[]};async function Kt(e,t,n){const a=[];n.forEach((e=>{a.push({visualPivotTable:e.visualPivotTable,dataProvider:e.dataProvider,interpretation:e.interpretation})}));const o=function(e,t){const n=e.workbook.pivotTables,a=e.workbook.worksheets.getActiveWorksheet().protection.load("protected"),o=[];t.forEach((t=>{const n=t.dataProvider.getTopLeftCell(e).load(["rowIndex","columnIndex"]);o.push(n)})),n.load({name:!0,worksheet:{id:!0,protection:{protected:!0}}});const i=[];return t.forEach((t=>{let n=null;t.dataProvider.tableName&&(n=e.workbook.worksheets.getItem(t.dataProvider.sheetId).tables.getItemOrNullObject(t.dataProvider.tableName)),i.push(n)})),e=>async l=>{const s=n.items.filter((e=>e.worksheet.protection.protected));if(a.protected&&Office.context.platform!==Office.PlatformType.OfficeOnline)throw new r.u(r.O.InsertionFailedCurrentWorksheetProtected);if(s.length>0&&Office.context.requirements.isSetSupported("ExcelApi","1.15")){const e=s.map((e=>({type:e.getDataSourceType(),sourceString:e.getDataSourceString()})));await n.context.sync();const a=e.map((e=>({type:e.type.value,sourceString:e.sourceString.value})));t.forEach((e=>{if(a.filter((t=>t.sourceString.length>0&&(t.type===Excel.DataSourceType.localTable&&t.sourceString===e.dataProvider.tableName||t.type===Excel.DataSourceType.localRange&&t.sourceString===`${e.dataProvider.sheetName}!${e.dataProvider.address}`))).length>0)throw new r.u(r.O.InsertionFailedPivotCacheProtected)}))}const c=new Set(n.items.map((e=>e.name)));let d=1;const u=[],m=[],g=[];for(let a=0;a<e.length;++a){const r=i[a],s=t[a],h=e[a],p=o[a],b=!r||r.isNullObject?Tn(l,s.interpretation,s.dataProvider,p):r;let f;do{f=(0,It.L)(et.olU.InsertedPivotTableName,d.toString()),++d}while(c.has(f));c.add(f),g.push(f);const C=n.add(f,b,h),y=new Map,v=on(C,s.visualPivotTable,y);ln(C,s.visualPivotTable,v,y),C.refresh(),Office.context.requirements.isSetSupported("TableStyle","1.1")&&C.layout.setStyle("PivotStyleLight16"),u.push(C);const T=(0,Mt.A)();l.trace(T),m.push(T)}await l.sync();const h=e=>{for(let t=0;t<u.length;++t){const n=e.workbook.pivotTables.getItem(g[t]),a=Office.context.requirements.isSetSupported("ExcelApi","1.9")&&Office.context.platform!==Office.PlatformType.OfficeOnline,o=e.workbook.worksheets.getActiveWorksheet();a&&(e.application.suspendScreenUpdatingUntilNextSync(),n.worksheet.activate()),n.delete(),a&&o.activate()}return e.sync()},p=[];for(let e=0;e<u.length;++e)p.push({pivotTable:u[e],hierarchyNameMap:new Map});return{result:p,undo:h}}}(e,a),i=[];for(let t=0;t<n.length;++t){const a=n[t];i.push((0,St.dn)(e,a.destination).getRange((0,St.gx)(a.destination)))}await e.sync();const l=await o(i)(e);t.push(l.undo);const s=[];let c=!1;for(let e=0;e<l.result.length;++e){const t=n[e],a=Yt(l.result[e].pivotTable,t.visualPivotTable,l.result[e].hierarchyNameMap);a&&(c=!0),s.push(a)}c&&await e.sync();const d=[];for(let e=0;e<l.result.length;++e){const t=n[e],a=s[e];a&&(t.visualPivotTable=a());const o=nn(l.result[e].pivotTable,t.visualPivotTable,l.result[e].hierarchyNameMap);d.push(o)}await e.sync(),d.forEach((e=>{e()}));const u=[];return l.result.forEach((e=>{e.pivotTable.load({name:!0,worksheet:{id:!0}}),u.push(e.pivotTable)})),u}async function en(e,t,n,a,o,r,i){const l=await async function(e,t,n,a,o){const r=tn(e,n,o);await e.sync();const i=await(0,St.oc)(e,a),l=await r(i.getCell(vn(t),0))(e);a.push(l.undo);const s=l.result.pivotTable,c=Yt(s,t,l.result.hierarchyNameMap);let d=t;c&&(await e.sync(),d=c());const u=an(s,d,l.result.hierarchyNameMap);return await e.sync(),u(),s}(e,t,a,o,r),s=await function(e,t,n){return async a=>{const o=(0,vt.ip)(t).primary,r=e.layout.getRange(),i=e.worksheet,l=r.getColumnsAfter(2).getEntireColumn().getCell(3,1);l.select();const s=i.charts.add(o.excelType,l);s.setPosition(l),s.setData(r),s.showAllFieldButtons=!1,Ft(s,t,n);const c=(0,Mt.A)();a.trace(c);const d=(0,Tt.U)((()=>{s.delete()}),c);i.load("name"),s.load(["name","id"]),i.getRange("A1").select();try{await a.sync()}catch(e){await d(e)}return{result:s,undo:e=>(e.workbook.worksheets.getItem(i.name).charts.getItem(s.name).delete(),e.sync())}}}(l,n,i)(e);o.push(s.undo);const c=_t(s.result,n,i),d=(0,rt.x)(e,s.result.worksheet);s.result.worksheet.load("name"),await e.sync(),c();const u=await d()(e);return o.push(u.undo),s.result}function tn(e,t,n){const a=e.workbook.pivotTables,o=e.workbook.worksheets.getActiveWorksheet().protection.load("protected"),i=t.getTopLeftCell(e).load(["rowIndex","columnIndex"]);a.load({name:!0,worksheet:{id:!0,protection:{protected:!0}}});let l=null;return t.tableName&&(l=e.workbook.worksheets.getItem(t.sheetId).tables.getItemOrNullObject(t.tableName)),e=>async s=>{const c=a.items.filter((e=>e.worksheet.protection.protected));if(o.protected&&Office.context.platform!==Office.PlatformType.OfficeOnline)throw new r.u(r.O.InsertionFailedCurrentWorksheetProtected);if(c.length>0&&Office.context.requirements.isSetSupported("ExcelApi","1.15")){const e=c.map((e=>({type:e.getDataSourceType(),sourceString:e.getDataSourceString()})));await a.context.sync();if(e.map((e=>({type:e.type.value,sourceString:e.sourceString.value}))).filter((e=>e.sourceString.length>0&&(e.type===Excel.DataSourceType.localTable&&e.sourceString===t.tableName||e.type===Excel.DataSourceType.localRange&&e.sourceString===`${t.sheetName}!${t.address}`))).length>0)throw new r.u(r.O.InsertionFailedPivotCacheProtected)}const d=!l||l.isNullObject?Tn(s,n,t,i):l,u=new Set(a.items.map((e=>e.name)));let m,g=1;do{m=(0,It.L)(et.olU.InsertedPivotTableName,g.toString()),++g}while(u.has(m));const h=a.add(m,d,e);h.refresh();const p=function(e,t,n){const a=e.hierarchies,o=t.getRange(n).getRow(0).load("text,rowCount");return a.load("items/name"),()=>{const e=new Set(a.items.map((e=>e.name.toUpperCase()))),t=new Set,n=new Map;let r=[];return o.rowCount>0&&(r=o.text[0]),r.forEach((a=>{const o=a.toUpperCase();if(e.has(o)&&!t.has(o))t.add(o);else{let r=2,i=(0,It.L)((0,et.fhV)(),o,r);for(;e.has(i);){if(!t.has(i)){n.set(a,i),t.add(i);break}++r,i=(0,It.L)((0,et.fhV)(),o,r)}}})),n}}(h,t,s);e.worksheet.showGridlines=!1,Office.context.requirements.isSetSupported("TableStyle","1.1")&&h.layout.setStyle("PivotStyleLight16");const b=(0,Mt.A)();s.trace(b);const f=(0,Tt.U)((()=>h.delete()),b);try{await s.sync()}catch(e){await f(e)}const C=p();return{result:{pivotTable:h,hierarchyNameMap:C},undo:e=>{const t=e.workbook.pivotTables.getItem(m),n=Office.context.requirements.isSetSupported("ExcelApi","1.9")&&Office.context.platform!==Office.PlatformType.OfficeOnline,a=e.workbook.worksheets.getActiveWorksheet();return n&&(e.application.suspendScreenUpdatingUntilNextSync(),t.worksheet.activate()),t.delete(),n&&a.activate(),e.sync()}}}}function nn(e,t,n){(t.valueFilters.length>0||t.labelFilters.length>0||t.dateFilters.length>0)&&(e.allowMultipleFiltersPerField=!0),e.layout.layoutType=Excel.PivotLayoutType.tabular;const a=[];t.filterFields&&t.filterFields.forEach((t=>{const o=n.get(t.name)||t.name,r=e.hierarchies.getItem(o),i=e.filterHierarchies.add(r);0!==t.values.length&&(a.push({filterField:i.fields.getItem(o),visibleItemNames:t.values}),i.enableMultipleFilterItems=!0)}));const o=rn(a);return()=>{o(),dn(e,t,n),mn(e,t,n),bn(e,t,n),fn(e,t),Cn(e,t)}}function an(e,t,n){(t.valueFilters.length>0||t.labelFilters.length>0||t.dateFilters.length>0)&&(e.allowMultipleFiltersPerField=!0),e.layout.layoutType=Excel.PivotLayoutType.tabular;const a=[];t.filterFields&&t.filterFields.forEach((t=>{const o=n.get(t.name)||t.name,r=e.hierarchies.getItem(o),i=e.filterHierarchies.add(r);0!==t.values.length&&(a.push({filterField:i.fields.getItem(o),visibleItemNames:t.values}),i.enableMultipleFilterItems=!0)}));const o=rn(a);return()=>{o();const a=on(e,t,n);ln(e,t,a,n),dn(e,t,n),mn(e,t,n),bn(e,t,n),fn(e,t),Cn(e,t)}}function on(e,t,n){return t.dataFields.map((t=>{const a=e.hierarchies.getItem(n.get(t.name)||t.name),o=e.dataHierarchies.add(a);o.summarizeBy=function(e){switch(e){case"sum":return Excel.AggregationFunction.sum;case"count":return Excel.AggregationFunction.count;case"average":return Excel.AggregationFunction.average;case"min":return Excel.AggregationFunction.min;case"max":return Excel.AggregationFunction.max;case"distinctCount":return Excel.AggregationFunction.countNumbers;case"stdDev":return Excel.AggregationFunction.standardDeviation;case"variance":return Excel.AggregationFunction.variance;default:throw new Error("Unsupported calculation function")}}(t.dataCalculation),t.numberFormat&&(o.numberFormat=t.numberFormat);const r=function(e){if(void 0===e)return Excel.ShowAsCalculation.none;switch(e){case"percentOf":return Excel.ShowAsCalculation.percentOf;case"percentOfColumnTotal":return Excel.ShowAsCalculation.percentOfColumnTotal;case"percentOfRowTotal":return Excel.ShowAsCalculation.percentOfRowTotal;case"percentOfGrandTotal":return Excel.ShowAsCalculation.percentOfGrandTotal;case"percentOfParentTotal":return Excel.ShowAsCalculation.percentOfParentTotal;case"percentOfParentColumnTotal":return Excel.ShowAsCalculation.percentOfParentColumnTotal;case"percentOfParentRowTotal":return Excel.ShowAsCalculation.percentOfParentRowTotal;case"percentRunningTotal":return Excel.ShowAsCalculation.percentRunningTotal;case"rankAscending":return Excel.ShowAsCalculation.rankAscending;case"rankDecending":return Excel.ShowAsCalculation.rankDecending;case"runningTotal":return Excel.ShowAsCalculation.runningTotal;case"none":return Excel.ShowAsCalculation.none;default:(0,i.c)(e)}}(t.showAsCalculation);return o.showAs={calculation:r},{dataPivotHierarchy:o,visualDataField:t}}))}function rn(e){const t={name:!0,items:{name:!0}};return e.forEach((e=>{e.filterField.load(t)})),()=>{e.forEach((e=>{e.filterField.items.items.forEach((t=>{t.visible=e.visibleItemNames.includes(t.name)}))}))}}function ln(e,t,n,a){t.rowFields&&t.rowFields.forEach((t=>{const o=a.get(t.name)||t.name,r=e.hierarchies.getItem(o);e.rowHierarchies.add(r),yn(r.fields.getItem(o),n,t)})),t.columnFields&&t.columnFields.forEach((t=>{const o=a.get(t.name)||t.name,r=e.hierarchies.getItem(o);e.columnHierarchies.add(r),yn(r.fields.getItem(o),n,t)}))}function sn(e){switch(e.filterType){case"between":case"notBetween":return{condition:Excel.ValueFilterCondition.between,exclusive:"notBetween"===e.filterType,lowerBound:e.value,upperBound:e.value2};case"bottomItems":return{condition:Excel.ValueFilterCondition.bottomN,selectionType:Excel.TopBottomSelectionType.items,threshold:e.value};case"bottomPercent":return{condition:Excel.ValueFilterCondition.bottomN,selectionType:Excel.TopBottomSelectionType.percent,threshold:e.value};case"bottomSum":return{condition:Excel.ValueFilterCondition.bottomN,selectionType:Excel.TopBottomSelectionType.sum,threshold:e.value};case"equal":case"notEqual":return{condition:Excel.ValueFilterCondition.equals,exclusive:"notEqual"===e.filterType,comparator:e.value};case"greaterThan":return{condition:Excel.ValueFilterCondition.greaterThan,comparator:e.value};case"greaterThanOrEqual":return{condition:Excel.ValueFilterCondition.greaterThanOrEqualTo,comparator:e.value};case"lessThan":return{condition:Excel.ValueFilterCondition.lessThan,comparator:e.value};case"lessThanOrEqual":return{condition:Excel.ValueFilterCondition.lessThanOrEqualTo,comparator:e.value};case"topItems":return{condition:Excel.ValueFilterCondition.topN,selectionType:Excel.TopBottomSelectionType.items,threshold:e.value};case"topPercent":return{condition:Excel.ValueFilterCondition.topN,selectionType:Excel.TopBottomSelectionType.percent,threshold:e.value};case"topSum":return{condition:Excel.ValueFilterCondition.topN,selectionType:Excel.TopBottomSelectionType.sum,threshold:e.value};default:(0,i.c)(e,`Invalid ValueFilter type: ${e.filterType}`)}}function cn(e,t){switch(e){case"rowField":return t.rowFields;case"columnField":return t.columnFields;default:return(0,i.x)(e)}}function dn(e,t,n){t.valueFilters.forEach((a=>{const o=cn(a.labelFieldType,t)[a.labelFieldIndex],r=n.get(o.name)||o.name,i=t.dataFields[a.dataFieldIndex],l=n.get(i.name)||i.name;e.hierarchies.getItem(r).fields.getItem(r).applyFilter({valueFilter:{...sn(a),value:(0,It.L)((0,et.Gn5)(),(0,Qt.i)(i.dataCalculation),l)}})}))}function un(e){const t=e.value.toString();switch(e.filterType){case"equal":case"notEqual":return{condition:Excel.LabelFilterCondition.equals,comparator:t,exclusive:"notEqual"===e.filterType};case"greaterThan":return{condition:Excel.LabelFilterCondition.greaterThan,comparator:t};case"greaterThanOrEqual":return{condition:Excel.LabelFilterCondition.greaterThanOrEqualTo,comparator:t};case"lessThan":return{condition:Excel.LabelFilterCondition.lessThan,comparator:t};case"lessThanOrEqual":return{condition:Excel.LabelFilterCondition.lessThanOrEqualTo,comparator:t};case"between":case"notBetween":return{condition:Excel.LabelFilterCondition.between,exclusive:"notBetween"===e.filterType,lowerBound:t,upperBound:e.value2.toString()};case"startsWith":case"notStartsWith":return{condition:Excel.LabelFilterCondition.beginsWith,substring:t,exclusive:"notStartsWith"===e.filterType};case"endsWith":case"notEndsWith":return{condition:Excel.LabelFilterCondition.endsWith,substring:t,exclusive:"notEndsWith"===e.filterType};case"contains":case"notContains":return{condition:Excel.LabelFilterCondition.contains,substring:t,exclusive:"notContains"===e.filterType};default:return(0,i.x)(e)}}function mn(e,t,n){t.labelFilters.forEach((a=>{const o=cn(a.labelFieldType,t)[a.labelFieldIndex],r=n.get(o.name)||o.name;e.hierarchies.getItem(r).fields.getItem(r).applyFilter({labelFilter:un(a)})}))}function gn(e,t){switch(e){case"equal":case"notEqual":return{condition:Excel.DateFilterCondition.equals,exclusive:"notEqual"===e};case"after":return{condition:Excel.DateFilterCondition.after};case"afterOrEqual":return{condition:Excel.DateFilterCondition.afterOrEqualTo};case"before":return{condition:Excel.DateFilterCondition.before};case"beforeOrEqual":return{condition:Excel.DateFilterCondition.beforeOrEqualTo};case"between":case"notBetween":return{condition:Excel.DateFilterCondition.between,exclusive:"notBetween"===e};case"inDynamicPeriod":return{condition:hn(t)};default:return(0,i.x)(e)}}function hn(e){switch(e){case"tomorrow":return Excel.DateFilterCondition.tomorrow;case"today":return Excel.DateFilterCondition.today;case"yesterday":return Excel.DateFilterCondition.yesterday;case"nextWeek":return Excel.DateFilterCondition.nextWeek;case"thisWeek":return Excel.DateFilterCondition.thisWeek;case"lastWeek":return Excel.DateFilterCondition.lastWeek;case"nextMonth":return Excel.DateFilterCondition.nextMonth;case"thisMonth":return Excel.DateFilterCondition.thisMonth;case"lastMonth":return Excel.DateFilterCondition.lastMonth;case"nextQuarter":return Excel.DateFilterCondition.nextQuarter;case"thisQuarter":return Excel.DateFilterCondition.thisQuarter;case"lastQuarter":return Excel.DateFilterCondition.lastQuarter;case"nextYear":return Excel.DateFilterCondition.nextYear;case"thisYear":return Excel.DateFilterCondition.thisYear;case"lastYear":return Excel.DateFilterCondition.lastYear;case"yearToDate":return Excel.DateFilterCondition.yearToDate;case"quarter1":return Excel.DateFilterCondition.allDatesInPeriodQuarter1;case"quarter2":return Excel.DateFilterCondition.allDatesInPeriodQuarter2;case"quarter3":return Excel.DateFilterCondition.allDatesInPeriodQuarter3;case"quarter4":return Excel.DateFilterCondition.allDatesInPeriodQuarter4;case"january":return Excel.DateFilterCondition.allDatesInPeriodJanuary;case"february":return Excel.DateFilterCondition.allDatesInPeriodFebruary;case"march":return Excel.DateFilterCondition.allDatesInPeriodMarch;case"april":return Excel.DateFilterCondition.allDatesInPeriodApril;case"may":return Excel.DateFilterCondition.allDatesInPeriodMay;case"june":return Excel.DateFilterCondition.allDatesInPeriodJune;case"july":return Excel.DateFilterCondition.allDatesInPeriodJuly;case"august":return Excel.DateFilterCondition.allDatesInPeriodAugust;case"september":return Excel.DateFilterCondition.allDatesInPeriodSeptember;case"october":return Excel.DateFilterCondition.allDatesInPeriodOctober;case"november":return Excel.DateFilterCondition.allDatesInPeriodNovember;case"december":return Excel.DateFilterCondition.allDatesInPeriodDecember;default:return(0,i.x)(e)}}function pn(e){return(0,o.S$)(e)?{...gn(e.filterType),comparator:{date:e.value.toISOString(),specificity:Excel.FilterDatetimeSpecificity.second},wholeDays:e.wholeDays}:(0,o.kp)(e)?{...gn(e.filterType),lowerBound:{date:e.value.toISOString(),specificity:Excel.FilterDatetimeSpecificity.second},upperBound:{date:e.value2.toISOString(),specificity:Excel.FilterDatetimeSpecificity.second},wholeDays:e.wholeDays}:(0,o.vr)(e)?gn(e.filterType):(0,i.x)(e)}function bn(e,t,n){t.dateFilters.forEach((a=>{const o=cn(a.fieldType,t)[a.fieldIndex],r=n.get(o.name)||o.name;e.hierarchies.getItem(r).fields.getItem(r).applyFilter({dateFilter:pn(a)})}))}function fn(e,t){(t.subTotalRowIndices||t.subTotalColumnIndices)&&(e.layout.subtotalLocation=Excel.SubtotalLocationType.atTop)}function Cn(e,t){const n=e.worksheet;if(t.highlightCellReferences){const e=vn(t);t.highlightCellReferences.forEach((t=>{n.getCell(t.row+e,t.column).format.font.color="#ED7331"}))}}function yn(e,t,n){const a=n.sortOrder;if(!a||"default"===a)return;const o=function(e){switch(e){case"ascending":return Excel.SortBy.ascending;case"descending":return Excel.SortBy.descending;case"default":throw new Error("Unsupported sort order");default:return(0,i.x)(e)}}(a);if(n.sortBy){const a=t.find((e=>e.visualDataField.name===n.sortBy)).dataPivotHierarchy;e.sortByValues(o,a)}else e.sortByLabels(o)}function vn(e){const t=(e.filterFields||[]).length;return t>0?t+2:1}function Tn(e,t,n,a){const o=e.workbook.worksheets.getItem(n.sheetId);if(t){const{top:e,left:n,bottom:r,right:i}=t.table.tableLocation;return o.getRangeByIndexes(e+a.rowIndex,n+a.columnIndex,r-e+1,i-n+1)}return n.getRange(e)}const xn=1,Sn=0,wn=0,En=0;function In(e,t,n){return Excel.run((a=>{const{type:r}=e;switch(r){case"ChartVisual":case"PivotChartVisual":case"QueryChartVisual":t.some((t=>t.sheetId===e.sheetId&&(0,o.VZ)(t.type)))||a.workbook.worksheets.getItem(e.sheetId).charts.onDeleted.add((e=>n(e.chartId,ot.D0.Chart,e.source)));break;case"PivotTableVisual":t.some((e=>"PivotTableVisual"===e.type))||a.workbook.worksheets.onDeleted.add((e=>n(e.worksheetId,ot.D0.Sheet,e.source)));break;case"QueryResultVisual":if(!e.sheetId)break;e.sheetId&&!t.some((t=>"QueryResultVisual"===t.type&&t.sheetId===e.sheetId))&&(e.isFormulaInsertion?a.workbook.worksheets.onDeleted.add((e=>n(e.worksheetId,ot.D0.Sheet,e.source))):a.workbook.worksheets.getItem(e.sheetId).tables.onDeleted.add((e=>n(e.tableId,ot.D0.Table,e.source))));break;case"ForecastVisual":case"TextAnalysisVisual":break;default:(0,i.x)(r)}return Promise.resolve()}))}async function Rn(e,t,n,a,o){const l=[];try{const r=[],s=[],c=[];o.failureLocation=Xe.lA.convertingDashboardArgs,t.forEach((e=>{const t=e=>(0,pt.LM)(1+e.position.y,1+e.position.x),o=(e,t)=>{const n=e.filterFields.length>0?e.filterFields.length+1:0;return(0,pt.LM)(1+t.position.y+n,1+t.position.x)},l=e=>(0,pt.LM)(1+e.position.y+e.dim.y-1,1+e.position.x+e.dim.x-1);switch(e.recommendation.visual.visualType){case"ChartVisual":{const o=e.layoutPlacement.chart;if(!o)throw new Error("Chart layout rectangle not found for ChartVisual");const i=t(o),s=l(o),c=`'${n}'!${i}:${s}`;r.push({recommendation:e.recommendation,dataProvider:a,destination:c});break}case"PivotTableVisual":{const t=e.layoutPlacement.pivotTable;if(!t)throw new Error("Pivot table layout rectangle not found for PivotTableVisual");const r=o(e.recommendation.visual.pivotTable,t),i=`'${n}'!${r}`;s.push({recommendation:e.recommendation,dataProvider:a,interpretation:e.interpretation,destination:i,layoutPlacement:t});break}case"PivotChartVisual":{const r=e.layoutPlacement.pivotTable,i=e.layoutPlacement.chart;if(!i)throw new Error("Chart layout rectangle not found for PivotChartVisual");if(!r)throw new Error("Pivot table layout rectangle not found for PivotChartVisual");const d=t(i),u=l(i),m=o(e.recommendation.visual.pivotTable,r),g=`'${n}'!${m}`,h=`'${n}'!${d}:${u}`;c.push({recommendation:e.recommendation,dataProvider:a,destination:h,pivotTableSheetId:null,pivotTableRange:null}),s.push({recommendation:e.recommendation,dataProvider:a,interpretation:e.interpretation,destination:g,layoutPlacement:r});break}case"QueryResultVisual":case"QueryChartVisual":case"ForecastVisual":case"TextAnalysisVisual":throw new Error(`Unsupported dashboard visual type: ${e.recommendation.visual.visualType}`);default:(0,i.x)(e.recommendation.visual)}})),o.failureLocation=Xe.lA.insertCharts;const d=await async function(e,t,n){if(n.length<=0)return[];const a=[];n.forEach((e=>{const t=e.recommendation.visual;let n=t.chart;void 0===n.title&&(n={...n,title:e.recommendation.title}),a.push({visualChart:n,dataProvider:e.dataProvider,chartConfig:t.chartConfig,destination:e.destination})}));const o=await Ht(e,t,a),r=[];for(let e=0;e<o.length;++e)r.push({objectId:o[e].id,sheetId:o[e].worksheet.id,recommendationId:n[e].recommendation.id,type:"ChartVisual"});return r}(e,l,r);o.failureLocation=Xe.lA.insertPivotTables;const u=await async function(e,t,n){if(n.length<=0)return[];const a=n.sort(((e,t)=>e.layoutPlacement.position.y>t.layoutPlacement.position.y?1:e.layoutPlacement.position.y<t.layoutPlacement.position.y?-1:e.layoutPlacement.position.x-t.layoutPlacement.position.x)),o=a.map((e=>{const t=e.recommendation.visual;return{dataProvider:e.dataProvider,interpretation:e.interpretation,destination:e.destination,visualPivotTable:t.pivotTable}})),r=await Kt(e,t,o);await e.sync();return r.map(((e,t)=>({objectId:e.id,sheetId:e.worksheet.id,range:e.layout.getRange(),recommendationId:a[t].recommendation.id,type:"PivotTableVisual"})))}(e,l,s);c.forEach((e=>{const t=u.find((t=>t.recommendationId===e.recommendation.id));e.pivotTableRange=t?.range,e.pivotTableSheetId=t?.sheetId})),o.failureLocation=Xe.lA.insertPivotCharts;const m=await async function(e,t,n){if(n.length<=0)return[];const a=[];n.forEach((e=>{if(!e.pivotTableRange)throw new Error(`Pivot table range not provided for recommendation: ${e.recommendation.id}`);if(!e.pivotTableSheetId)throw new Error(`Pivot table sheet id not provided for recommendation: ${e.recommendation.id}`);let t=e.recommendation.visual.chart;void 0===t.title&&(t={...t,title:e.recommendation.title}),a.push({visualChart:t,dataProvider:e.dataProvider,destination:e.destination,pivotTableRange:e.pivotTableRange,pivotTableSheetId:e.pivotTableSheetId})}));const o=await async function(e,t,n){const a=[],o=[];n.forEach((t=>{const n=(0,vt.ip)(t.visualChart).primary;let r,i,l=!1;const s=(0,St.dn)(e,t.destination);try{const e=(0,St.gx)(t.destination);if(e){const t=(0,ft.AW)(e);r=s.getCell(t.top-1,t.left-1),t.top===t.bottom&&t.left===t.right||(i=s.getCell(t.bottom-1,t.right-1),l=!0)}}catch(e){l=!1}if(!r)throw new Error("Starting cell not found.");r.select();const c=s.charts.add(n.excelType,r);l?c.setPosition(r,i):c.setPosition(r),c.setData(t.pivotTableRange),c.showAllFieldButtons=!1,Ft(c,t.visualChart,t.chartConfig),s.load("name"),c.load(["name","id"]),s.getRange("A1").select(),a.push(c);const d=(0,Mt.A)();e.trace(d),o.push(d)})),await e.sync();const r=[];for(let e=0;e<a.length;++e){const t=_t(a[e],n[e].visualChart,n[e].chartConfig);r.push(t)}try{await e.sync(),r.forEach((e=>{e()}))}catch(e){for(let e=0;e<a.length;++e)(0,Tt.U)((()=>a[e].delete()),o[e])}return t.push((e=>{for(let t=0;t<a.length;++t)e.workbook.worksheets.getItem(n[t].pivotTableSheetId).charts.getItem(a[t].name).delete();return e.sync()})),a}(e,t,a),r=[];for(let e=0;e<o.length;++e)r.push({objectId:o[e].id,sheetId:o[e].worksheet.id,recommendationId:n[e].recommendation.id,type:"PivotChartVisual"});return r}(e,l,c);return d.concat(u.concat(m))}catch(e){try{await(0,Tt.q)(l)}catch(e){at.M.getInstance().logErrorCode(r.O.InsertionCleanupFailed,e,nt.S2.Undo,Ze.$b.Error)}throw e}}async function An(e,t,n){const o=[];try{return await(0,ht.$r)((0,et.Eyh)()),await Excel.run({delayForCellEdit:!0},(async s=>{const c=e.visual;switch(c.visualType){case"ChartVisual":{const n=await async function(e,t,n,a){const o=t.visual;let r=o.chart;void 0===r.title&&(r={...r,title:t.title});Office.context.platform===Office.PlatformType.OfficeOnline&&n.getSheet(e).getRange("A1").select();const i=await $t(e,r,n,a,o.chartConfig);return{objectId:i.id,sheetId:i.worksheet.id,recommendationId:t.id,type:"ChartVisual",sheetName:i.worksheet.name}}(s,e,t,o);return n}case"PivotTableVisual":{const a=await async function(e,t,n,a,o){const r=t.visual,i=await async function(e,t,n,a,o=Zt){const r=tn(e,t,a),i=(0,rt.d)(e);await e.sync();const l=await i()(e);n.push(l.undo);const s=await r(l.result.getCell(vn(o),0))(e),c=s.result.pivotTable;n.push(s.undo);const d=Yt(c,o,s.result.hierarchyNameMap);let u=o;d&&(await e.sync(),u=d());const m=an(c,u,s.result.hierarchyNameMap),g=(0,rt.x)(e,c.worksheet);c.worksheet.load("name"),await e.sync(),m();const h=await g()(e);return n.push(h.undo),c}(e,n,a,o,r.pivotTable);return{objectId:i.id,sheetId:i.worksheet.id,recommendationId:t.id,type:"PivotTableVisual",sheetName:i.worksheet.name}}(s,e,t,o,n);return a}case"PivotChartVisual":{const a=await async function(e,t,n,a,o){const r=t.visual;let i=r.chart;const l=r.pivotTable;void 0===i.title&&(i={...i,title:t.title});const s=await en(e,l,i,n,a,o,r.chartConfig);return{objectId:s.id,sheetId:s.worksheet.id,recommendationId:t.id,type:"PivotChartVisual",sheetName:s.worksheet.name}}(s,e,t,o,n);return a}case"QueryResultVisual":try{return await async function(e,t,n,o){const r=t.visual;if(void 0===r.query)throw new Error("The recommendation is not a query result visual.");const i=function(e){const{projectClause:t,groupClause:n}=e;return!(t&&t.length>1||!t.some((e=>De(e)))||n)}(r.query);let s;if((0,Ct.iPS)("Microsoft.Office.Excel.FA000000124.UseLLMFormula",!1)&&r.formula&&r.formula.length>0)s=r.formula;else{new Ye(r.query,new Fe(!0)).translate();const t=await it(e,n,r.query);try{const e=new Ye(r.query,t).translate();s=`=${function(e,t,n){const a=st(e),o=ct(e).filter((e=>"average"===e.aggregationType)).map((e=>e.index)),r=lt(e),i=[new g("*",Se.formulaIsError(new l(t.getTableAddress())),new d(1))];if(a.forEach((e=>{const n=new l(t.getColumnAddress(e));i.push(Se.formulaMin([Se.formulaSum(new g("-",new d(1),Se.formulaIsNumber(n))),Se.formulaSum(new g("-",new d(1),Se.formulaIsText(n)))]))})),o.length>0){const e=1===o.length?new l(t.getColumnAddress(o[0])):Se.formulaIndex(new l(t.getTableAddress()),Se.formulaSequence(Se.formulaRows(new l(t.getTableAddress()))),o.map((e=>e+1)));i.push(new g("*",Se.formulaIsBlank(e),new d(1)))}if(r.length>0){const e=1===r.length?new l(t.getColumnAddress(r[0])):Se.formulaIndex(new l(t.getTableAddress()),Se.formulaSequence(Se.formulaRows(new l(t.getTableAddress()))),r.map((e=>e+1)));i.push(new g("*",Se.formulaIsError(Se.formulaYear(e)),new d(1)))}return Se.formulaIf(new h(">",Se.formulaSum(i),new d(0)),Se.formulaNA(),n)}(r.query,t,e).toString()}`}catch(e){throw e instanceof Ae?e:new Ae(a.TranslationFailure)}}if(s.length>8192)throw new Ae(a.ExceedLengthLimitation);const c=await(0,St.oc)(e,o);await function(e,t,n,a,o){const r=a.fields,i=a.fieldHeaders.map(yt.HW),l=r.length,s=r[0].values.raw.length,c=(0,bt.Kz)(s,(e=>r.map((t=>t.values.formats?.[e])))),d=(0,bt.Kz)(s,(e=>r.map((t=>t.values.formatLocals?.[e])))),u=new Array(l).fill(null),m=[u,...c],g=[u,...d];t.showGridlines=!1;const h=Wt,p=Gt,b=zt;t.getRangeByIndexes(h,p,1,l).set({values:[i],format:{font:{color:"white",bold:!0,size:11},fill:{color:"4472C4"}}});const{formulaCellAddress:f,formulaCellTop:C,formulaCellLeft:y}=function(e,t,n,a){return{formulaCellAddress:e?`${a}${t+2}`:`${a}${t+3}`,formulaCellTop:e?t:t+1,formulaCellLeft:n}}(o,h,p,b),v=o?s+1:s+2;return t.getRange(f).formulas=[[n]],qt(t,m,g,C,y,1),t.getRangeByIndexes(3,2,v,l).format.autofitColumns(),e.sync()}(e,c,s,r.result,i);const u=(0,rt.x)(e,c);c.load("name"),await e.sync();const m=await u()(e);return o.push(m.undo),{objectId:null,sheetId:c.id,recommendationId:t.id,type:"QueryResultVisual",isFormulaInsertion:!0,sheetName:c.name}}(s,e,t,o)}catch(t){return at.M.getInstance().logErrorCode(t instanceof Ae?function(e){switch(e){case"ContentTooLarge":return r.O.FormulaErrorContentTooLarge;case"ExceedLengthLimitation":return r.O.FormulaErrorExceedLengthLimitation;case"ProactiveLimitation":return r.O.FormulaErrorProactiveLimitation;case"TranslationFailure":return r.O.FormulaErrorTranslationFailure;case"Unknown":return r.O.FormulaErrorUnknown;case"ValidationIssue":return r.O.FormulaErrorValidationIssue;default:return(0,i.x)(e)}}(t.errorCode):r.O.FormulaErrorUnknown,t,nt.S2.AnalyzeDataError,Ze.$b.Warning,{key:tt.un.RecommendationId,value:e.id}),await(0,Tt.q)(o),async function(e,t,n){const a=t.visual,o=a.result,{targetSheet:r,table:i}=await Ln(e,o,n,xn,Sn);return r.getRange("A1").select(),r.load("name"),await e.sync(),{objectId:i.id,sheetId:r.id,recommendationId:t.id,type:"QueryResultVisual",isFormulaInsertion:!1,sheetName:r.name}}(s,e,o)}case"QueryChartVisual":return async function(e,t,n){const a=t.visual,o=a.result,{targetSheet:r,table:i}=await Ln(e,o,n,xn,Sn);r.load("name"),i.load("name"),await e.sync();const l=await $t(e,a.chart,new Ke.N(r.id,r.name,(0,ft.XK)({top:3,left:1,bottom:a.result.fields[0].values.raw.length+3,right:a.result.fields.length}),i.name),n);return{objectId:l.id,sheetId:r.id,recommendationId:t.id,type:"QueryChartVisual",isFormulaInsertion:!1,sheetName:r.name}}(s,e,o);case"ForecastVisual":return async function(e,t,n){const a=t.visual,o=a.formulasTable,{targetSheet:r,table:i}=await Ln(e,o,n,wn,En);r.getRange("A1").select();const l=r.getUsedRange();l.load("address"),await e.sync();const s=new Ke.N(r.id,r.name,l.address),c=await $t(e,a.chart,s,n);return c.width=500,c.height=300,await e.sync(),{objectId:i.id,sheetId:r.id,recommendationId:t.id,type:"ForecastVisual",isFormulaInsertion:!0,sheetName:r.name}}(s,e,o);case"TextAnalysisVisual":return async function(e,t,n){const a=n.getTable(e),o=(a?a.getRange():n.getRange(e)).load(["rowIndex","columnIndex","rowCount","columnCount","address"]);await e.sync();const{rowIndex:r,columnIndex:i,rowCount:l,columnCount:s}=o,c=r,d=i+s,u=t.visual,{header:m,values:g}=kn(u.textAnalysisResult),h=n.sheetName,p=e.workbook.worksheets.getItem(h),b=[m,...g];if(a)a.columns.add(void 0,new Array(b.length).fill(new Array(m.length).fill("")));else{p.getRangeByIndexes(c,d,l,m.length).insert(Excel.InsertShiftDirection.right)}await e.sync();const f=p.getRangeByIndexes(c,d,l,m.length);return f.values=b,p.load(["name","id"]),f.load(["values","columnIndex"]),await e.sync(),{objectId:null,sheetId:p.id,recommendationId:t.id,type:"TextAnalysisVisual",isFormulaInsertion:!1,sheetName:p.name,range:f}}(s,e,t);default:return(0,i.x)(c)}}))}catch(e){try{await(0,Tt.q)(o)}catch(e){at.M.getInstance().logErrorCode(r.O.InsertionCleanupFailed,e,nt.S2.Undo,Ze.$b.Error)}throw e}finally{await(0,ht.TA)()}}async function Ln(e,t,n,a,o){const r=t.fields,i=r[0].values.raw.length,l=(0,bt.Kz)(i,(e=>r.map((t=>t.values.raw[e])))),s=t.fieldHeaders.map(yt.HW);l.unshift(s);const c=l[0].length,d=(0,bt.Kz)(i,(e=>r.map((t=>t.values.formats?.[e])))),u=(0,bt.Kz)(i,(e=>r.map((t=>t.values.formatLocals?.[e])))),m=new Array(c).fill(null),g=[m,...d],h=[m,...u],p=await(0,St.oc)(e,n),{result:b,undo:f}=Vt(p,l,g,h,a,o,1);return b.load("id"),(0,Ct.iPS)("Microsoft.Office.Excel.FA000000124.QueryCharts",!1)&&n.push(f),{targetSheet:p,table:b}}function kn(e){const t=e.bulletList;if(!t)throw new Error("Invalid text analysis result to insert. Only result with bulletList can be inserted.");const n=e.columnReference.bottom-e.columnReference.top+1,{augmentedColumnNames:a,augmentedColumnValues:o}=function(e,t){const n=e.map((e=>e.title)),a=[];for(let e=0;e<t;e++)a.push(Array(n.length).fill(!1));for(let t=0;t<n.length;t++){const n=e[t].reference;if(n)for(let e=0;e<n.length;e++){const o=n[e];if(o<0||o>=a.length)throw new Error("Invalid BulletResult. Reference out of range.");a[o][t]=!0}}return{augmentedColumnNames:n,augmentedColumnValues:a}}(t,n),{success:r,columnValues:i,columnName:l}=function(e,t,n,a){const o=[],r=(0,Ct.yw9)("OfficeVSO_10200801_UseInsertionColumnHeaderForTextAnalysis")?a??Fn(n):Fn(n);for(const n of t){const t=n.filter((e=>!0===e)).length;if(1===t)o.push(e[n.indexOf(!0)]);else{if(0!==t)return{success:!1};o.push(null)}}return{success:!0,columnValues:o,columnName:r}}(a,o,e.analysisType,e.insertionColumnHeader);if(r){if(void 0===l||void 0===i)throw new Error("Invalid result. When success is true, columnName and columnValues should not be undefined.");return{header:[l],values:i.map((e=>[e]))}}return{header:a,values:o}}function Fn(e){return e===o.uK.Sentiment?(0,et.Moz)():(0,et.$sl)()}async function _n(e){const t=[];try{return await(0,ht.$r)((0,et.Eyh)()),await Excel.run({delayForCellEdit:!0},(async n=>{const a=await(0,St.oc)(n,t),o=[];if(0===e.series.length)throw new Error("At least one series is required");if(!e.series[0].data.categoryNames)throw new Error("Category names are required for the first series");e.series[0].data.categoryNames[0].forEach((e=>{o.push([e])})),e.series.forEach(((e,t)=>{e.data.values&&e.data.values[0].forEach(((e,n)=>{if(!o[n]){o[n]=[`Category${n+1}`];for(let e=0;e<t;e++)o[n].push(null)}o[n].push(e)}))}));const r=[];for(let e=0;e<o[0].length;e++)r.push(`Column ${e+1}`);o.unshift(r);const{result:i,undo:l}=Vt(a,o,[],[],0,0,1);t.push(l);const s=(0,vt.oe)(e.series[0].layout??"");a.charts.add(s.excelType,i.getRange()).activate()}))}catch(e){try{await(0,Tt.q)(t)}catch(e){at.M.getInstance().logErrorCode(r.O.InsertionCleanupFailed,e,nt.S2.Undo,Ze.$b.Error)}throw e}finally{await(0,ht.TA)()}}},314793:(e,t,n)=>{"use strict";n.d(t,{R:()=>r});var a=n(279395),o=n(347145);class r{static getAugloopWorkflowTimeout(){return(0,o.iPS)("Microsoft.Office.Excel.FA000000124.NeverTimeout",!1)?2**31-1:(0,o.Z8j)("Microsoft.Office.Excel.FA000000124.AugloopWorkflowDefaultTimeout",65e3)}static getChatHistoryWorkflowTimeout(){return(0,o.yw9)("OfficeVSO_8996311_chatHistoryTimeout")?5e3:3e3}static getAnalyzeDataNetworkTimeout(){return(0,o.Z8j)("Microsoft.Office.Excel.FA000000124.AnalyzeDataNetworkTimeout",5e4)}static getAnalyzeDataTimeout(e){const t=i(e);return t||(0,o.Z8j)("Microsoft.Office.Excel.FA000000124.AnalyzeDataTimeout",4e4)}static getOdslExecutionTimeout(e,t){if(e){const e=i(t);if(e)return e}return(0,o.Z8j)("Microsoft.Office.Excel.FA000000124.OdslExecutionTimeout",6e4)}static getFormulaAITimeout(){const e=(0,o.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.FormulaGenerationNewNlToFormulaSkill",!1)?9e4:4e4;return(0,o.Z8j)("Microsoft.Office.Excel.FA000000124.FormulaAITimeout",e)}static getInsertColumnTimeout(){return 1e4}static getFormulaSuggestionUiTimeouts(){const[e,t,n]=(0,o.xtK)("Microsoft.Office.Excel.FA000000124.FormulaSuggestionsUITimeouts",[2e4,2e4,3e4]);return{description:e,preview:t,explanation:n}}static getLoadPaneAshaTimeout(){return(0,o.Z8j)("Microsoft.Office.Excel.FA000000124.SDXLoadTimeout",1e4)}static getLoadAuthLibraryAshaTimeout(){return 1e4}static getLoadAuthLibraryAceTimeout(){return 3e4}static getLoadAuthLibraryTimeout(){return this.getLoadAuthLibraryAceTimeout()-3e3}static getScratchpadScriptExecutionTimeout(){return(0,o.Z8j)("Microsoft.Office.Excel.FA000000124.ScratchpadScriptExecutionTimeout",6e4)}}function i(e){const t=e>a.xtr,n=(0,o.iPS)("Microsoft.Office.Excel.FA000000124.EnableDynamicPlanner",!1),r=(0,o.Z8j)("Microsoft.Office.Excel.FA000000124.AugLoop.DynamicPlannerTimeout",73e3);if(t||n)return Math.max(t?a.Yuw:0,n?r:0)}},316904:(e,t,n)=>{"use strict";n.d(t,{M:()=>N});var a,o,r,i=n(616166),l=n(639765),s=n(548366),c=n(301735),d=n(46692),u=n(24784),m=n(75496),g=n(279395),h=n(197665),p=n(857677);!function(e){e.AnalyzeReceived="AnalyzeReceived",e.AnswersReceived="AnswersReceived",e.FormulaGenerationReceived="GenerateReceived",e.CommandReceived="CommandReceived",e.DeeperAnalysisReceived="DeeperAnalysisReceived",e.CopilotChatReceived="CopilotChatReceived",e.ElseReceived="ElseReceived",e.DataShapingReceived="DataShapingReceived"}(a||(a={})),function(e){e.AnalyzeApplied="AnalyzeApplied",e.AnswersApplied="AnswersApplied",e.FormulaGenerationApplied="GenerateApplied",e.CommandApplied="CommandApplied",e.DeeperAnalysisApplied="DeeperAnalysisApplied",e.CopilotChatApplied="CopilotChatApplied",e.ElseApplied="ElseApplied",e.DataShapingApplied="DataShapingApplied"}(o||(o={})),function(e){e.AppLevelReceived="AppLevelReceived",e.AppLevelApplied="AppLevelApplied"}(r||(r={}));const b="Office.Excel.Copilot";var f=n(182755),C=n(12163),y=n(83437),v=function(){return v=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},v.apply(this,arguments)},T=function(e,t,n){if(n||2===arguments.length)for(var a,o=0,r=t.length;o<r;o++)!a&&o in t||(a||(a=Array.prototype.slice.call(t,0,o)),a[o]=t[o]);return e.concat(a||Array.prototype.slice.call(t))},x=function(){function e(){}return e.prototype.sendTelemetryEvent=function(e){"undefined"!=typeof Office&&Office.sendTelemetryEvent(e)},e}(),S=function(){function e(){this.alwaysCriticalEvents=null,this.oTelLogger=new f.M,this.telemSink=new x,this.setupTelemetryLogger(this.oTelLogger)}return e.prototype.getDefaultEventFlags=function(){return{dataCategories:d.o.DataCategories.ProductServicePerformance|d.o.DataCategories.ProductServiceUsage,diagnosticLevel:d.o.DiagnosticLevel.RequiredServiceData}},e.prototype.getTelemetrySink=function(){return this.telemSink},e.prototype.sendTelemetryEvent=function(e){this.isAlwaysCriticalEvent(e)&&(e.eventFlags.samplingPolicy=d.o.SamplingPolicy.CriticalUsage),this.oTelLogger.sendTelemetryEvent(e)},e.prototype.logEvent=function(e,t){this.logTelemetryEvent(e,t)},e.prototype.logUncaughtException=function(e){var t=[],n="";e instanceof Error&&(e.message&&(n=e.message),e.stack&&t.push({key:"Stack",value:e.stack})),this.logTelemetryErrorEvent({eventType:y.S2.UncaughtException,errorMessage:n,logLevel:y.$b.Critical},void 0,t)},e.prototype.logError=function(e,t,n){this.logTelemetryErrorEvent(e,t,n)},e.prototype.isAlwaysCriticalEvent=function(e){return!1},e.prototype.getTelemetryProperties=function(){return{ariaTenantToken:e.AriaTenantToken,nexusTenantToken:e.NexusTenantToken}},e.prototype.getDefaultEventDataFields=function(){return this.getDataFields(this.getDefaultTelemetryData())},e.prototype.getDefaultTelemetryData=function(){return[{key:"UserQueryGuid",value:e.userQueryGuid}]},e.prototype.logTelemetryEvent=function(e,t){var n={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.ActionAI."+e.eventType,eventFlags:t?v(v({},t),this.getDefaultEventFlags()):this.getDefaultEventFlags(),dataFields:T(T([],this.getDefaultEventDataFields(),!0),this.getDataFields(e.eventData||[]),!0)};this.sendTelemetryEvent(n)},e.prototype.getActionAITelemetryErrorEvent=function(e,t,n){return n||(n=[]),n.find((function(e){return"Message"===e.key}))||n.push({key:"Message",value:e.errorMessage}),n.find((function(e){return"LogLevel"===e.key}))||n.push({key:"LogLevel",value:e.logLevel}),{eventName:"Office.Voice.ActionAI."+y.S2.Error,error:{errorGroup:e.eventType,tag:0},eventFlags:t?v(v({},this.getDefaultEventFlags()),t):this.getDefaultEventFlags(),dataFields:T(T([],this.getDefaultEventDataFields(),!0),this.getDataFields(n),!0)}},e.prototype.logTelemetryErrorEvent=function(e,t,n){this.oTelLogger.sendError(this.getActionAITelemetryErrorEvent(e,t,n))},e.prototype.getDataFields=function(e){return e.map((function(e){return"number"==typeof e.value?(0,C.ip)(e.key,e.value):"string"==typeof e.value?(0,C.m9)(e.key,e.value):"boolean"==typeof e.value?(0,C.LK)(e.key,e.value):(0,C.m9)(e.key,String(e.value))}))},e.prototype.setupTelemetryLogger=function(t){t.setTenantToken("Office.Voice.ActionAI",e.AriaTenantToken,e.NexusTenantToken),t.setTenantToken("Office.Voice.Copilot",e.AriaTenantToken,e.NexusTenantToken),t.addSink(this.telemSink)},e.prototype.getLogLevelForErrorCategory=function(e){return y.$b.Error},e.AriaTenantToken="9783945ebc2b468fbb8a2890cdab903b-787355a5-74c8-4a89-b06a-9c82635d75fa-7162",e.NexusTenantToken=1763,e.userQueryGuid="",e.userQueryOrder=0,e.conversationId=void 0,e}(),w=n(993821),E=n(715227),I=n(798110),R=n(831922),A=n(314793);var L=n(347145),k=n(821845),F=n(215939),_=n(474353);const P=(e,t)=>({dataCategories:d.o.DataCategories.ProductServiceUsage,samplingPolicy:t||d.o.SamplingPolicy.Measure,diagnosticLevel:e||d.o.DiagnosticLevel.FullEvent});class N extends S{static getInstance(){return N.telemetryLogger||(N.telemetryLogger=new N),N.telemetryLogger}clearAnalyzeDataSteps(e){delete this.analyzeDataSteps[e]}addAnalyzeDataStep(e,t){this.analyzeDataSteps[e]?this.analyzeDataSteps[e].push(t):this.analyzeDataSteps[e]=[t]}removeAnalyzeDataStep(e,t){if(!this.analyzeDataSteps[e])return;const n=this.analyzeDataSteps[e].indexOf(t);n>-1&&this.analyzeDataSteps[e].splice(n,1)}getLastAnalyzeDataStep(e){if(this.analyzeDataSteps[e]&&0!==this.analyzeDataSteps[e].length)return this.analyzeDataSteps[e][this.analyzeDataSteps[e].length-1]}log(e,t){e.push({key:p.W0.CorrelationId,value:this.correlationId}),this.excelCorrelationId&&e.push({key:p.W0.ExcelCorrelationId,value:this.excelCorrelationId}),this.fetchRecommendationsCorrelationId&&e.push({key:p.W0.FetchRecommendationsCorrelationId,value:this.fetchRecommendationsCorrelationId}),this.logEvent({eventType:m.S2.AnalyzeDataEvents,eventData:e},t)}runTimedAsyncFunction(e,t,n,a){return(0,_.H)(t(),(t=>this.logDuration(e,t,n,a)))}logDuration(e,t,n,a){this.checkForAshaTimeouts(e,t);const o=[{key:p.EB.Type,value:e},{key:p.EB.Duration,value:t},{key:p.EB.CorrelationId,value:this.correlationId}];this.excelCorrelationId&&o.push({key:p.EB.ExcelCorrelationId,value:this.excelCorrelationId}),this.fetchRecommendationsCorrelationId&&o.push({key:p.EB.FetchRecommendationsCorrelationId,value:this.fetchRecommendationsCorrelationId}),n&&o.push({key:p.EB.RequestId,value:n}),a&&o.push({key:p.EB.SuggestionId,value:a}),this.logEvent({eventType:m.S2.AnalyzeDataDuration,eventData:o},P(d.o.DiagnosticLevel.RequiredServiceData,d.o.SamplingPolicy.CriticalBusinessImpact))}checkForAshaTimeouts(e,t){"InsertColumn"===e&&t>A.R.getInsertColumnTimeout()&&this.logStandardizedAshaErrorEvent(s.W.Response_Delayed_Or_Timed_Out,l.c.Inserting_Column_Took_Too_Long_Time,p.BJ.FormulaGeneration)}logGetSelectionContext(e,t,n,a,o,r){const{isTable:i,hasTableHeaders:l}=a,s=[{key:p.W0.EventType,value:"GetSelectionContext"},{key:p.W0.NumRows,value:t},{key:p.W0.NumColumns,value:e},{key:p.W0.SelectionExpanded,value:n},{key:p.W0.IsSmallSelection,value:o},{key:p.W0.IsTable,value:i},{key:p.W0.HasTableHeaders,value:l},{key:p.W0.AreaCount,value:r}];this.log(s,P(d.o.DiagnosticLevel.RequiredServiceData,d.o.SamplingPolicy.CriticalBusinessImpact))}logGetDataFromRange(e){this.log([{key:p.W0.EventType,value:"GetDataFromRange"},{key:p.W0.HasInvalidValues,value:e}],P(d.o.DiagnosticLevel.RequiredServiceData,d.o.SamplingPolicy.CriticalBusinessImpact))}logInsightsApiCall(e,t,n,a,o){const r=[{key:p.W0.EventType,value:"InsightsApiCall"},{key:p.W0.Method,value:e},{key:p.W0.Api,value:t},{key:p.W0.ResponseCode,value:n},{key:p.W0.RetryCount,value:a},...o],i=P(d.o.DiagnosticLevel.RequiredServiceData,d.o.SamplingPolicy.CriticalBusinessImpact);this.log(r,i)}logRangeDataPerformance(e){const t=P(d.o.DiagnosticLevel.RequiredServiceData,d.o.SamplingPolicy.CriticalBusinessImpact);e.push({key:p.W0.EventType,value:"RangeDataPerformance"}),this.log([{key:p.W0.EventType,value:"RangeDataPerformance"},...e],t)}logInsertRecommendationDashboard(e){this.log([{key:p.W0.EventType,value:"InsertRecommendationsDashboard"},{key:p.W0.IsSuccessful,value:e.isSuccessful},{key:p.W0.FailureReason,value:e.failureReason},{key:p.W0.FailureLocation,value:E.lA[e.failureLocation]},{key:p.W0.RecommendationData,value:JSON.stringify(e.recommendationData)}],P(d.o.DiagnosticLevel.RequiredServiceData,d.o.SamplingPolicy.CriticalBusinessImpact))}logFlightingSuccess(){this.log([{key:p.W0.EventType,value:"FlightingSuccess"}],P(d.o.DiagnosticLevel.RequiredServiceData,d.o.SamplingPolicy.CriticalBusinessImpact))}logLoadDataWithChunking(e,t,n,a,o,r,i,l){this.log([{key:p.W0.EventType,value:"LoadDataWithChunking"},{key:p.W0.Type,value:e},{key:p.W0.Duration,value:t},{key:p.W0.NumRows,value:n},{key:p.W0.NumColumns,value:a},{key:p.W0.IsSuccessful,value:o},{key:p.W0.NumChunks,value:r},{key:p.W0.NumSyncs,value:i},{key:p.W0.MinRowsInChunk,value:l}],P(d.o.DiagnosticLevel.RequiredServiceData,d.o.SamplingPolicy.CriticalBusinessImpact))}logLoadFormulaData(e,t,n){this.log([{key:p.W0.EventType,value:"LoadFormulaData"},{key:p.W0.Duration,value:e},{key:p.W0.NumRows,value:t},{key:p.W0.NumColumns,value:n}],P(d.o.DiagnosticLevel.NecessaryServiceDataEvent,d.o.SamplingPolicy.CriticalBusinessImpact))}logEvaluateQuery(e,t){const n=[{key:p.W0.EventType,value:"EvaluateQuery"},{key:p.W0.ResponseType,value:e.responseType}],a=e.visualAnswer?.at(0)?.visual?.visualType;if(a&&n.push({key:p.W0.VisualType,value:a}),"TextAnalysisVisual"===a){const a=e.visualAnswer.at(0).visual.textAnalysisResult;n.push({key:p.W0.TextAnalysisResultType,value:a?.resultType}),n.push({key:p.W0.NumRowsSelected,value:t.rowCount});const o=a?.bulletList?.flatMap((e=>e.reference))??[],r=new Set([...o]).size;n.push({key:p.W0.NumRowsReferenced,value:r})}e.reasonForError&&n.push({key:p.W0.ReasonForError,value:e.reasonForError}),e.queryType&&n.push({key:p.W0.QueryType,value:e.queryType}),e.caveats&&e.caveats.length>0&&n.push({key:p.W0.Caveats,value:e.caveats.map((e=>e.code)).join(", ")}),this.log(n,P(d.o.DiagnosticLevel.RequiredServiceData,d.o.SamplingPolicy.CriticalBusinessImpact))}logInvalidInsightsSession(e){const t=[{key:p.W0.InvalidInsightsSessionSource,value:e},{key:p.W0.IsInvalidInsightsSession,value:!0}];this.log(t,P(d.o.DiagnosticLevel.RequiredServiceData,d.o.SamplingPolicy.CriticalBusinessImpact))}getLogLevelForErrorCategory(e){switch(e){case"UnsupportedLanguageError":case"LicensingError":case"ODSLParseError":case"ODSLSyntaxError":case"InputQueryError":case"":return y.$b.Warning;default:return y.$b.Error}}logUncaughtException(e){const t=[];let n="";(e instanceof Error||e instanceof OfficeExtension.Error)&&(e.message&&(n=e.message),e.stack&&t.push({key:p.un.Stack,value:e.stack})),this.logTelemetryErrorEvent({eventType:m.S2.UncaughtException,errorMessage:n,logLevel:y.$b.Critical},void 0,t)}logStandardizedAshaErrorEvent(e,t,n,a){if(F.isSDXRenderingForPreload)return void this.heldAshaErrorEvents.push({ashaVeto:e,ashaError:t,featureName:n,ashaInStaging:a});const o=this.getDefaultTelemetryData();o.push({key:"AshaScenarioName",value:n}),R.TelemetryLoggerUtils.getInstance().logErrorWithAshaVetoAndError(o,n,g.u1i,this.getVerbForStandardizedFeature(n)+" "+n+" "+e,t,a)}logAshaEvent(e,t,n,a){const o=this.getDefaultTelemetryData();o.push({key:"AshaScenarioName",value:n}),R.TelemetryLoggerUtils.getInstance().logErrorWithAshaVetoAndError(o,n,g.u1i,e,t,a)}logErrorCode(e,t,n,a,...o){const r=[{key:p.un.ErrorCode,value:e}],l=t instanceof i.u&&t.error?t.error:t;(l instanceof Error||l instanceof OfficeExtension.Error)&&(r.push({key:p.un.Name,value:l.name},{key:p.un.InnerError,value:l.message}),l.stack&&r.push({key:p.un.Stack,value:l.stack}),l instanceof OfficeExtension.Error&&(r.push({key:p.un.OfficeErrorCode,value:l.code}),l.debugInfo.errorLocation&&r.push({key:p.un.ErrorLocation,value:l.debugInfo.errorLocation}))),r.push(...o),this.logTelemetryErrorEvent({eventType:n??m.S2.Error,errorMessage:e,logLevel:a??y.$b.Warning},void 0,r)}releaseHeldTelemetryEvents(){this.heldTelemetryEvents.forEach((({featureName:e,telemetryEvent:t})=>{this.sendTelemetryEvent(t),this.seenEvents.add(e)})),this.heldTelemetryEvents=[],this.heldAshaErrorEvents.forEach((({ashaVeto:e,ashaError:t,featureName:n,ashaInStaging:a})=>{const o=this.getDefaultTelemetryData();o.push({key:"AshaScenarioName",value:n}),R.TelemetryLoggerUtils.getInstance().logErrorWithAshaVetoAndError(o,n,g.u1i,this.getVerbForStandardizedFeature(n)+" "+n+" "+e,t,a)})),this.heldAshaErrorEvents=[]}startTriedActivity(e){null!=this.pendingTriedActivity&&this.endTriedActivityFailure();const t={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.Copilot.Chat",eventFlags:this.getCopilotEventFlags(!0),dataFields:this.getCopilotDataFields(u.TA.FeatureActionType.IsTried,e)};this.pendingTriedActivity=this.oTelLogger.createActivity(t),this.currentStandardizedFeature=void 0,this.currentUsageFeature=void 0}endTriedActivitySuccess(e){if(null==this.pendingTriedActivity)return void(0,I.J)("CopilotResponseDisplayed");if(this.pendingTriedActivity.dataFields=this.getCopilotDataFields(u.TA.FeatureActionType.IsTried,e),this.pendingTriedActivity.success=!0,this.pendingTriedActivity.endNow(),this.pendingTriedActivity=void 0,this.sendSurveyTriggerEvent(!1,e),(0,L.yw9)("OfficeVSO_9249393_AttributionFromAugLoop")&&e===p.q.CopilotChat)return;const t=this.getStandardizedFeatureForSubFeature(e);(0,L.yw9)("OfficeVSO_9249393_AttributionFromAugLoop")&&this.assertFeatureIsActive(t,"endTriedActivitySuccess: Feature from tried success does not match active feature from AugLoop."),this.currentStandardizedFeature=t,this.currentUsageFeature=e}endTriedActivityFailure(e){null!=this.pendingTriedActivity?(e?this.pendingTriedActivity.dataFields=this.getCopilotDataFields(u.TA.FeatureActionType.IsTried,e):(0,L.yw9)("OfficeVSO_9249393_AttributionFromAugLoop")&&this.currentUsageFeature?this.pendingTriedActivity.dataFields=this.getCopilotDataFields(u.TA.FeatureActionType.IsTried,this.currentUsageFeature):(0,L.yw9)("OfficeVSO_9249393_AttributionFromAugLoop")&&(this.pendingTriedActivity.dataFields=this.getCopilotDataFields(u.TA.FeatureActionType.IsTried,this.getUsageFeatureForStandardizedFeature(this.currentStandardizedFeature))),this.pendingTriedActivity.success=!1,this.pendingTriedActivity.endNow(),this.pendingTriedActivity=void 0):(0,I.J)("CopilotResponseDisplayed")}resetActiveFeature(){this.currentStandardizedFeature=void 0,this.currentUsageFeature=void 0,N.querySource=N.nextQuerySource?N.nextQuerySource:p.BC.Default,N.nextQuerySource=p.BC.Default,N.querySource===p.BC.ExternalQuery?N.currentEntryPoint=p.Y9.Canvas:N.currentEntryPoint=p.Y9.Chat}setQuerySource(e){N.nextQuerySource=e}setActiveFeature(e){this.currentStandardizedFeature=this.getStandardizedFeatureForSubFeature(e),this.currentUsageFeature=e}setActiveFeatureWithContentOrigin(e){if(e&&e!==c.w.AugLoopEvalName&&e!==c.w.AugLoopName&&e!==c.w.DeepLeo&&e!==c.w.Workflow)if(e.includes(",")){const t=e.split(",");for(const n of t){const t=(0,p.eQ)(n);if(t){if(void 0!==this.currentStandardizedFeature&&t===p.BJ.ExcelChatHelper)continue;this.assertFeatureIsActive(t,"setActiveFeatureWithContentOrigin, multiple skills"),void 0===this.currentStandardizedFeature&&(this.currentStandardizedFeature=t,this.currentUsageFeature=void 0,this.logError({eventType:m.S2.ChatEvents,errorMessage:`AugLoop returned multiple skills: ${e}, and we are setting feature as ${this.currentStandardizedFeature}`,logLevel:y.$b.Warning}));break}}}else{const t=(0,p.eQ)(e);if(t){if(void 0!==this.currentStandardizedFeature&&t===p.BJ.ExcelChatHelper)return;this.assertFeatureIsActive(t,"setActiveFeatureWithContentOrigin, single skill"),void 0===this.currentStandardizedFeature&&(this.currentStandardizedFeature=t,this.currentUsageFeature=void 0)}}}getActiveFeature(){return this.currentStandardizedFeature?this.currentStandardizedFeature:p.BJ.CopilotChat}logRejectedEvent(e,t){if(t&&this.rejectedIds.has(t))return;const n={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.Copilot.Chat",eventFlags:this.getCopilotEventFlags(!1),dataFields:this.getCopilotDataFields(u.TA.FeatureActionType.IsRejected,e)};this.sendTelemetryEvent(n),t&&this.rejectedIds.add(t)}logThumbsUpEvent(e,t,n,a){const o=(0,p.rI)(e),r={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.Copilot.Chat",eventFlags:this.getCopilotEventFlags(!1),dataFields:this.getCopilotDataFields(void 0,o,!0,(0,L.yw9)("OfficeVSO_8546828_SupportingSuggestionIdForExcelCopilotCC")?t:void 0,n,a)};this.sendTelemetryEvent(r)}logThumbsDownEvent(e,t,n,a){const o=(0,p.rI)(e),r={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.Copilot.Chat",eventFlags:this.getCopilotEventFlags(!1),dataFields:this.getCopilotDataFields(void 0,o,!1,(0,L.yw9)("OfficeVSO_8546828_SupportingSuggestionIdForExcelCopilotCC")?t:void 0,n,a)};this.sendTelemetryEvent(r),this.logUserThumbsDownAshaError(o)}logCitationOnClickEvent(){const e={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.Copilot.Chat",eventFlags:this.getCopilotEventFlags(!0),dataFields:this.getCopilotDataFields(u.TA.FeatureActionType.IsTried,p.q.AnalyzeData)};this.sendTelemetryEvent(e)}logUserThumbsDownAshaError(e){let t,n;switch(e){case p.q.CalculatedColumns:case p.q.CalculatedRows:case p.q.NLToFormula:t=l.c.User_Dissatisfied_With_Suggestion_Calculated_Columns,n=this.getStandardizedFeatureForSubFeature(n);break;case p.q.Search:t=l.c.Search_User_Thumbs_Down,n=p.BJ.Search;break;case p.q.ImportDataFromSearch:t=l.c.import_Data_Thumbs_Down,n=p.BJ.ImportData;break;case p.q.Else:t=l.c.Else_User_Thumbs_Down,n=p.BJ.ExcelChatHelper;break;case p.q.Python:t=l.c.Python_User_Thumbs_Down,n=p.BJ.Python;break;case p.q.Answers:t=l.c.Answers_User_Thumbs_Down,n=p.BJ.Answers;break;default:t=l.c.Chat_User_Thumbs_Down,n=p.BJ.CopilotChat}t&&n&&N.getInstance().logStandardizedAshaErrorEvent(s.W.User_Rejected_Or_Cancelled_Response,t,n)}sendSurveyTriggerEvent(e,t){if(!(0,L.yw9)("OfficeVSO_8378717_TriggerExcelCopilotSurvey")||void 0===t)return;const n=function(e,t){let n;switch(e){case p.q.AnalyzeData:n=t?"AnalyzeApplied":"AnalyzeReceived";break;case p.q.CalculatedColumns:case p.q.CalculatedRows:case p.q.NLToFormula:n=t?"GenerateApplied":"GenerateReceived";break;case p.q.Commanding:case p.q.ConditionalFormatting:n=t?"CommandApplied":"CommandReceived";break;case p.q.Python:n=t?"DeeperAnalysisApplied":"DeeperAnalysisReceived";break;case p.q.CopilotChat:n=t?"CopilotChatApplied":"CopilotChatReceived";break;case p.q.Else:n=t?"ElseApplied":"ElseReceived";break;case p.q.DataShaping:n=t?"DataShapingApplied":"DataShapingReceived";break;case p.q.Answers:n=t?"AnswersApplied":"AnswersReceived";break;default:return}return b+"."+n}(t,e),a=function(e){return b+"."+(e?"AppLevelApplied":"AppLevelReceived")}(e);this.logEventName(a),void 0!==n&&(this.logEventName(n),(0,L.yw9)("OfficeVSO_8396253_sendToHostCopilotVerticals")&&(0,I.J)(n))}logEventName(e){const t={telemetryProperties:this.getTelemetryProperties(),eventName:e,eventFlags:this.getCopilotEventFlags(!1)};this.sendTelemetryEvent(t)}featureNameToFeedbackArea(e){switch(e){case p.q.Commanding:return"Copilot\\Commanding";case p.q.ConditionalFormatting:return(0,L.yw9)("OfficeVSO_9575103_AddFeedBackAreaToHiTLCard")?"Copilot\\Commanding Conditional Formatting":"Copilot\\Commanding CF Suggestions";case p.q.AnalyzeData:return"Copilot\\Analyze Data";case p.q.CalculatedColumns:return"Copilot\\Formula Generation";case p.q.Search:return"Copilot\\Search";case p.q.ImportDataFromSearch:return"Copilot\\Import Data";case p.q.Answers:return"Copilot\\Answers";case p.q.Python:return"Copilot\\Python";case p.q.PythonForms:return"Copilot\\PythonForms";case p.q.ChartDesignRecommendations:return"Copilot\\Chart Design Recommendations";case p.q.Else:return"Copilot\\Else";default:return"Copilot"}}getDefaultTelemetryData(){const e=[{key:m.Wg.UserQueryGuid,value:N.userQueryGuid},{key:m.Wg.ClientVersion,value:"9.57.2"},{key:m.Wg.GroundingMode,value:(0,p.Q6)()},{key:m.Wg.IsDevBuild,value:!1},{key:m.Wg.UiLanguage,value:(0,h.Yd)()}];return void 0!==N.querySource&&e.push({key:m.Wg.QuerySource,value:N.querySource}),(0,L.yw9)("OfficeVSO_9979155_PythonFlightsAsJSONString")?e.push({key:m.Wg.PythonFlights,value:(0,L.bdK)()}):e.push({key:m.Wg.IsPythonAdaInCopilotEnabled,value:(0,L.H2A)()}),e.push({key:m.Wg.IsModelessPythonAAEnabled,value:(0,k.i)()}),(0,L.yw9)("OfficeVSO_10534295_LogCopilotExperience")&&(0,L.UW0)()&&e.push({key:m.Wg.CopilotExperience,value:(0,w.dL)()?.PrimaryUserAccountInfo?.CopilotExperience??"AppChat"}),e}isAlwaysCriticalEvent(e){if(!(0,L.yw9)("OfficeVSO_9246195_AllowAlwaysCriticalEvents"))return!1;if(null===this.alwaysCriticalEvents){const e=(0,L.beW)("Microsoft.Office.Excel.FA000000124.AlwaysCriticalEvents","");this.alwaysCriticalEvents=e?e.split("|"):["Office.Voice.ActionAI.ChatEvents","Office.Voice.ActionAI.ShowMe","Office.Voice.ActionAI.Commanding","Office.Voice.ActionAI.OfficeJsOperations","Office.Voice.ActionAI.Latency","Office.Voice.ActionAI.Usage","Office.Voice.ActionAI.Error","Office.Voice.ActionAI.PythonEvents","Office.Voice.ActionAI.PythonDuration"]}return this.alwaysCriticalEvents.includes(e.eventName)}getCopilotEventFlags(e){return{dataCategories:d.o.DataCategories.ProductServiceUsage,diagnosticLevel:e?d.o.DiagnosticLevel.RequiredServiceData:d.o.DiagnosticLevel.Optional,samplingPolicy:d.o.SamplingPolicy.CriticalUsage}}getCopilotDataFields(e,t,n,a,o,r,i,l){t!==p.q.UndoMessage&&t!==p.q.CopyMessage&&t!==p.q.ExternalTriggeredQuery||(t=void 0);const s=null!=t?this.getStandardizedFeatureForSubFeature(t):null!=this.currentStandardizedFeature?this.currentStandardizedFeature:p.BJ.CopilotChat,c=s,d=t,g=this.getVerbForStandardizedFeature(s),h=e===u.TA.FeatureActionType.IsTried||e===u.TA.FeatureActionType.IsKept||e===u.TA.FeatureActionType.IsRejected||void 0!==n,b=e===u.TA.FeatureActionType.IsTried||e===u.TA.FeatureActionType.IsKept||e===u.TA.FeatureActionType.IsRejected||void 0!==n,f=(0,L.yw9)("OfficeVSO_10216180_AddActiveFeatureName")?{key:m.Wg.ActiveFeatureName,value:this.getActiveFeature()??""}:{key:"",value:""};return[...u.TA.getFields({featureActionType:null==e?"":u.TA.FeatureActionType[e],isUserInitiated:!0,verb:g,featureName:c,subFeatureName:d,isThumbsUp:n,interactionId:h?o??N.userQueryGuid:"",conversationId:b?l??N.conversationId:"",entryPoint:i??N.currentEntryPoint}),...this.getDefaultEventDataFields(),...this.getDataFields([{key:m.Wg.SuggestionId,value:a??""},{key:m.Wg.GroundingMode_,value:r??""},f])]}getStandardizedFeatureForSubFeature(e){switch(e){case p.q.AnalyzeData:return p.BJ.AnalyzeData;case p.q.CalculatedColumns:case p.q.CalculatedRows:case p.q.NLToFormula:return p.BJ.FormulaGeneration;case p.q.Commanding:case p.q.OfficeJsCommanding:case p.q.ShowHeaders:case p.q.SmartHelp:return p.BJ.Commanding;case p.q.ConditionalFormatting:case p.q.ConditionalFormattingSuggestion:return(0,L.yw9)("OfficeVSO_9564930_SplitCommandingTelemetry")?p.BJ.ConditionalFormatting:p.BJ.Commanding;case p.q.DataShaping:return p.BJ.PrepareData;case p.q.HandOff:return p.BJ.Handoff;case p.q.ImportDataFromSearch:return p.BJ.ImportData;case p.q.Search:return p.BJ.Search;case p.q.OfficeScripts:return p.BJ.OfficeScripts;case p.q.Python:case p.q.PythonForms:return p.BJ.Python;case p.q.SelfHelp:return p.BJ.ChatQnA;case p.q.ChatPaneLoad:case p.q.ConvertToTable:case p.q.CopilotChat:case p.q.SampleData:case p.q.ContextInference:case p.q.InsertTable:return p.BJ.CopilotChat;case p.q.ChartDesignRecommendations:return p.BJ.ChartDesignRecommendations;case p.q.Else:return p.BJ.ExcelChatHelper;case p.q.Answers:return p.BJ.Answers;case p.q.CopyMessage:case p.q.ExternalTriggeredQuery:case p.q.UndoMessage:default:return this.logError({eventType:m.S2.ChatEvents,errorMessage:`StandardizedFeature mapping error for: ${e}`,logLevel:y.$b.Error}),p.BJ.CopilotChat}}getUsageFeatureForStandardizedFeature(e){switch(e){case p.BJ.AnalyzeData:return p.q.AnalyzeData;case p.BJ.FormulaGeneration:return p.q.CalculatedColumns;case p.BJ.Commanding:return p.q.Commanding;case p.BJ.ConditionalFormatting:return(0,L.yw9)("OfficeVSO_9564930_SplitCommandingTelemetry")?p.q.ConditionalFormatting:p.q.Commanding;case p.BJ.PrepareData:return p.q.DataShaping;case p.BJ.Handoff:return p.q.HandOff;case p.BJ.ImportData:return p.q.ImportDataFromSearch;case p.BJ.Search:return p.q.Search;case p.BJ.OfficeScripts:return p.q.OfficeScripts;case p.BJ.Python:return p.q.Python;case p.BJ.ChatQnA:return p.q.SelfHelp;case p.BJ.ChartDesignRecommendations:return p.q.ChartDesignRecommendations;case p.BJ.CopilotChat:return p.q.CopilotChat;case p.BJ.ExcelChatHelper:return p.q.Else;case p.BJ.Answers:return p.q.Answers;default:return this.logError({eventType:m.S2.ChatEvents,errorMessage:`UsageFeature mapping error for: ${e}`,logLevel:y.$b.Error}),p.q.CopilotChat}}getVerbForStandardizedFeature(e){switch(e){case p.BJ.AnalyzeData:case p.BJ.Python:case p.BJ.PrepareData:case p.BJ.Answers:return p.uF.Analyze;case p.BJ.ChatQnA:case p.BJ.Search:return p.uF.Ask;case p.BJ.FormulaGeneration:case p.BJ.ImportData:case p.BJ.ChartDesignRecommendations:return p.uF.Create;case p.BJ.Commanding:case p.BJ.ConditionalFormatting:case p.BJ.OfficeScripts:return p.uF.Command;case p.BJ.CopilotChat:case p.BJ.ExcelChatHelper:case p.BJ.Handoff:return p.uF.UnknownIntent;default:!function(e,t){if(!1===e)throw new Error(t)}(!1,"Missing verb map.")}}assertFeatureIsActive(e,t){if((!(0,L.yw9)("OfficeVSO_9564930_SplitCommandingTelemetry")||e!==p.BJ.Commanding||this.getActiveFeature()!==p.BJ.ConditionalFormatting)&&e&&e!==this.getActiveFeature()&&this.getActiveFeature()!==p.BJ.CopilotChat){const n=t+" - feature: "+e+" activeFeature: "+this.getActiveFeature();this.logError({eventType:m.S2.AssertionFailed,errorMessage:n,logLevel:y.$b.Error})}}constructor(){super(),this.seenEvents=new Set,this.rejectedIds=new Set,this.heldTelemetryEvents=[],this.heldAshaErrorEvents=[],this.correlationId="",this.excelCorrelationId="",this.fetchRecommendationsCorrelationId=null,this.analyzeDataSteps={},this.logException=()=>e=>t=>{const n=t.type;try{e(t)}catch(e){throw this.logErrorCode(i.O.ReducerException,e,m.S2.AnalyzeDataError,y.$b.Warning,{key:p.un.Source,value:n}),e}}}}N.querySource=void 0,N.nextQuerySource=void 0,N.currentEntryPoint=void 0},318457:(e,t,n)=>{"use strict";n.d(t,{t:()=>s});var a=n(500461),o=n(347145),r=n(780866);const i=(0,r.n)({columnRecommendation:{backgroundColor:a.k1.neutralLight,color:a.k1.black,forcedColorAdjust:"auto"},text:{}}),l=(0,r.n)({columnRecommendation:{backgroundColor:a.k1.neutralLight,color:a.k1.black},text:{}});function s(){return(0,o.yw9)("OfficeVSO_9625778_fixFormulaCardsHighContrast")?i():l()}},318969:(e,t,n)=>{"use strict";n.d(t,{$c:()=>T,XX:()=>h,g4:()=>y,jc:()=>m,xP:()=>g,zH:()=>p});var a,o=n(279395),r=n(83437),i=n(12855),l=n(75496),s=n(316904),c=n(982306),d=n(347145),u=n(624654);!function(e){e.Number="Number",e.String="String",e.Any="Any"}(a||(a={}));const m=3,g=2,h=()=>{const e=!(0,d.H_5)();return[{suggestionText:(0,o.Dvy)(e),suggestionType:"AnalyzeData_Suggestion",alwaysInList:!0},{suggestionText:(0,o.qjK)(e),suggestionType:"CalculatedColumns_GeneralSuggestion",alwaysInList:!0},{suggestionText:(0,o.I77)(e),suggestionType:"ConditionalFormat_Suggestion",alwaysInList:!0}]},p=()=>[{suggestionText:(0,o.jmZ)(),suggestionType:"AnalyzeData_SpecificSuggestion"},{suggestionText:(0,o.lkD)(),suggestionType:"CalculatedColumns_SpecificSuggestion",numColsRequired:2,requiredColsType:"Number"},{suggestionText:(0,o.gZd)(),suggestionType:"Commanding_Suggestion"},{suggestionText:(0,o.gax)(),suggestionType:"AnalyzeData_SpecificSuggestion",numColsRequired:1,requiredColsType:"String"},{suggestionText:(0,o.hzZ)(),suggestionType:"CalculatedColumns_SpecificSuggestion",numColsRequired:2,requiredColsType:"String"},{suggestionText:(0,o.dYE)(),suggestionType:"Commanding_Suggestion",numColsRequired:1,requiredColsType:"Number"},{suggestionText:(0,o.EZu)(),suggestionType:"Commanding_Suggestion",numColsRequired:1,requiredColsType:"Any"},{suggestionText:(0,o.JEr)(),suggestionType:"Commanding_Suggestion",numColsRequired:1,requiredColsType:"Number"},{suggestionText:(0,o.PFs)(),suggestionType:"Commanding_Suggestion",numColsRequired:1,requiredColsType:"Number"},{suggestionText:(0,o.IyO)(),suggestionType:"AnalyzeData_ShowCharts",alwaysInList:!0},{suggestionText:(0,o.wYv)(),suggestionType:"AnalyzeData_ShowPivotTables",alwaysInList:!0}],b=(e,t)=>{let n=e;return t.forEach(((e,t)=>{n=n.replace(`{${t}}`,e.header),n=n.replace(`{DataFromColCell-${t}}`,e.firstCell.toString())})),n},f=e=>Math.floor(Math.random()*e),C=(e,t)=>{const n=[],a={Number:f(e.Number.length),String:f(e.String.length),Any:f(e.Any.length)};return t.forEach((t=>{const o=t.requiredColsType??"Any",r=e[o],i=t.numColsRequired??0;if(r.length<i)return;const l=((e,t,n)=>{const a=[],o=(0,d.yw9)("OfficeVSO_9675416_FixPromptSuggestionsCrash");if(o&&!e.length)return a;let r=o?t%e.length:t;for(let t=0;t<n;t++)(o?e[r]?.header?.trim().length:e[r].header.trim().length)&&(a.push(e[r]),r=(r+1)%e.length);return a})(r,a[o],i);l.length<i||(a[o]=(a[o]+l.length)%r.length,n.push({suggestionText:b(t.suggestionText,l),suggestionType:t.suggestionType,suggestionLanguage:t.suggestionLanguage}))})),n},y=(e,t,n=[])=>{try{if((0,c.K)(t,"AnalyzeData_RelatedQuestions")){const e=v(t,n),a=n.slice(-1*g),o=v(t,a),r=(0===e.length?o:e).slice(0,g);return{suggestionList:r,shouldResetRecentPrompts:0===e.length}}let a=!1;const o=C((e=>{const t={Number:[],String:[],Any:[]};if(!e)return t;try{const n=JSON.parse(e.firstRowValues),a=JSON.parse(e.headers),o=JSON.parse(e.numberFormats);return e.visibleColumns.forEach((e=>{const r=n[e],i=o[e],l={header:a[e],firstCell:r};"number"!=typeof r||(0,u.xs)(i)?"string"==typeof r&&r.length&&"true"!==r&&"false"!==r&&(t.String.push(l),t.Any.push(l)):(t.Number.push(l),t.Any.push(l))})),t}catch(e){return s.M.getInstance().logError({eventType:l.S2.ChatEvents,errorMessage:`Error sorting columns by type: ${e.message}`,logLevel:r.$b.Warning}),t}})(e),t);let i=v(o,n);i.length<=m&&(i=o,a=!0);return{suggestionList:i.slice(0,Math.min(m,o.length)),shouldResetRecentPrompts:a}}catch(e){return s.M.getInstance().logError({eventType:l.S2.ChatEvents,errorMessage:`Error generating prompt suggestions: ${e.message}`,logLevel:r.$b.Warning}),{suggestionList:h().slice(0,m).map((e=>({suggestionType:e.suggestionType,suggestionText:e.suggestionText})))}}},v=(e,t)=>e.filter((e=>!t.includes(e.suggestionText))),T=e=>{if(!e)return;const t=i.ye.EmptyHeaders|i.ye.DuplicateHeaders;return e&t&&!(e&~t)?[{suggestionText:(0,o.aDv)(),suggestionType:"Tlr_ExplainTables"},{suggestionText:(0,o.vvX)(),suggestionType:"Tlr_ExplainHeaders"}]:e===i.ye.Unrecognized||e===i.ye.Crosstab?[{suggestionText:(0,o.aDv)(),suggestionType:"Tlr_ExplainTables"}]:e===i.ye.HasMergedCells?[{suggestionText:(0,o.R7A)(),suggestionType:"Tlr_ExplainUnmergingCells"}]:void 0}},321231:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d,i:()=>c});var a=n(279395),o=n(639599),r=n(650444),i=n(126521),l=n(519272),s=n(575934);function c(e){switch(e){case"sum":return(0,a.Qte)();case"count":return(0,a.O0M)();case"average":return(0,a.o9V)();case"min":return(0,a.dlV)();case"max":return(0,a.PX_)();case"stdDev":return(0,a.fVE)();case"variance":return(0,a.ORJ)();case"none":case"distinctCount":throw new Error("Invalid Data Calculation type.");default:(0,r.c)(e,"Invalid Data Calculation type.")}}function d(e){switch(e.visualType){case"ChartVisual":case"PivotChartVisual":case"QueryChartVisual":{const t=e.chart,n=(0,l.ip)(t),r=(0,i.L)((0,a.Is)(),t.series.length),c=t.data,d=(e,t)=>{const n=function(e,t){if(0===e.dataBindings.length)return 0;const n=e.dataBindings[0].dimensionId;return t.dimensions.find((e=>e.id===n)).values.raw.length}(e,c);return(0,i.L)((0,a.LxC)(),t+1,n)};if(n.secondary){const e=(0,i.L)((0,a.XM5)(),n.primary.localizedName,n.secondary.localizedName),l=(e,t,a)=>{const r=t===e.axisGroup||"primary"===t&&void 0===e.axisGroup,i=(0,o.C$)(n.primary.insightsType,e.dimensionType),l=!!i&&i.orientation===a;return r&&l},c=t.axes.find((e=>l(e,"primary",o.UQ.Horizontal))),u=c?.title?(0,i.L)((0,a.Sa0)(),(0,s.HW)(c.title)):"",m=t.axes.find((e=>l(e,"primary",o.UQ.Vertical))),g=m?.title?(0,i.L)((0,a.Ony)(),(0,s.HW)(m.title)):"",h=t.axes.find((e=>l(e,"secondary",o.UQ.Horizontal))),p=h?.title?(0,i.L)((0,a.YtG)(),(0,s.HW)(h.title)):u,b=t.axes.find((e=>l(e,"secondary",o.UQ.Vertical))),f=b?.title?(0,i.L)((0,a.qvS)(),(0,s.HW)(b.title)):"",C=`${(0,i.L)((0,a.MiK)(),n.primary.localizedName)} ${u} ${g}`,y=`${(0,i.L)((0,a.MiK)(),n.secondary.localizedName)} ${p} ${f}`,v=[],T=[];t.series.forEach(((e,t)=>{"secondary"!==e.valueAxisGroup?v.push({series:e,index:t}):T.push({series:e,index:t})}));return`${e} ${r} ${C} ${v.map((e=>d(e.series,e.index))).join(" ")} ${y} ${T.map((e=>d(e.series,e.index))).join(" ")}`.trim()}return`${(0,i.L)((0,a.eZ0)(),n.primary.localizedName)} ${r} ${t.series.map(d).join(" ")} ${(t.axes||[]).map((e=>{const t=(0,o.C$)(n.primary.insightsType,e.dimensionType);if(!t||!e.title)return"";const r=(0,s.HW)(e.title);if(t.orientation===o.UQ.Horizontal)return(0,i.L)((0,a.zvE)(),r);if(t.orientation===o.UQ.Vertical)return(0,i.L)((0,a.mjS)(),r);throw new Error("Invalid orientation")})).join(" ")}`.trim()}case"PivotTableVisual":{const{rowFields:t,columnFields:n,dataFields:o,pivotTableData:r}=e.pivotTable;if(r&&0===r.length)return a.olU.NoValueAnswerTextForIdeas;const l=[];switch((t||[]).length){case 1:l.push((0,i.L)((0,a.hLq)(),t[0].name));break;case 2:l.push((0,i.L)((0,a.n0L)(),t[0].name,t[1].name))}if(1===(n||[]).length&&l.push((0,i.L)((0,a.gOS)(),n[0].name)),1===(o||[]).length){const{name:e,dataCalculation:t}=o[0],n=c(t),r=(0,i.L)((0,a.Gn5)(),n,e);l.push((0,i.L)((0,a.e0T)(),r))}return`${l.join(", ")}.`.trim()}case"QueryResultVisual":return 0===e.result.fields.length||0===e.result.fields[0].values.raw.length?a.olU.NoValueAnswerTextForIdeas:"";case"ForecastVisual":case"TextAnalysisVisual":return"";default:return(0,r.x)(e)}}},321627:(e,t,n)=>{"use strict";n.d(t,{u:()=>o});var a=n(507628);function o(){let e;try{e=OSF._OfficeAppFactory.getHostInfo().osfControlAppCorrelationId}catch(e){}return e||(e=`local.${(0,a.A)()}`),e}},324482:(e,t,n)=>{"use strict";n.d(t,{c:()=>a});class a{constructor(e,t){this.finished=!1,this.reject=e=>{this.finished||(this.rejectFn(e),this.finished=!0)},this.resolve=e=>{this.finished||(this.resolveFn(e),this.finished=!0)},this.resolveFn=e,this.rejectFn=t}}},328831:(e,t,n)=>{"use strict";n.d(t,{Gn:()=>s,Ld:()=>l,P7:()=>i});var a=n(454658),o=n(822606),r=o.u1,i=function(e){r=null!=e?e:o.u1},l=function(){return r};function s(){if(r)return(0,a.UD)(r)}},329739:(e,t,n)=>{"use strict";n.d(t,{j:()=>u});var a=n(660606),o=n(423905),r=n(83437),i=n(217425),l=n(792168),s=n(758651),c=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{s(a.next(e))}catch(e){r(e)}}function l(e){try{s(a.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((a=a.apply(e,t||[])).next())}))},d=function(e,t){var n,a,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(n=1,a&&(o=2&l[0]?a.return:l[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,l[1])).done)return o;switch(a=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,a=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],a=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},u=function(){function e(e){this.params=e}return e.prototype.loadMsalBrowser=function(){return c(this,void 0,void 0,(function(){var e,t,a;return d(this,(function(o){switch(o.label){case 0:e=1,o.label=1;case 1:if(!(e<=3))return[3,6];o.label=2;case 2:return o.trys.push([2,4,,5]),t=this,[4,Promise.all([n.e("vendors~auth-msal-browser"),n.e("vendors-npm_store_sdx_officecopilot_azure-msal-common_15_8_0-5ddec09c577d7d05edc7_node_module-52eaa3"),n.e("vendors-npm_store_sdx_officecopilot_azure-msal-common_14_16_0-73649867aca99b9381a4_node_modul-293e7c")]).then(n.bind(n,599807))];case 3:return t.msalModule=o.sent(),this.publicClientApplication=this.createPublicClientApplication(this.msalModule.PublicClientApplication),[2];case 4:if(a=o.sent(),s.error("Attempt ".concat(e," to load @azure/msal-browser failed:"),a),3===e)throw a;return[3,5];case 5:return e++,[3,1];case 6:return[2]}}))}))},e.prototype.getAuthorityAsPerEnv=function(){var e;return!!(null===(e=this.params)||void 0===e?void 0:e.appEnvironment)&&this.params.appEnvironment.length>0&&this.params.appEnvironment===l.D.DOD?i.MA:i.mr},e.prototype.createPublicClientApplication=function(e){return c(this,void 0,void 0,(function(){var t,n,a,o,r;return d(this,(function(l){return t=null!==(r=null===(o=this.params)||void 0===o?void 0:o.clientId)&&void 0!==r?r:i.ky,n=this.params.redirectUri,a=this.getAuthorityAsPerEnv(),[2,new e({auth:{clientId:t,authority:a,redirectUri:new URL(n,window.location.origin).toString(),navigateToLoginRequestUrl:!1},cache:{cacheLocation:"sessionStorage"},system:{iframeHashTimeout:12e3}})]}))}))},e.prototype.getToken=function(e,t,n){return c(this,void 0,void 0,(function(){var t,i,l,s,c,u;return d(this,(function(d){switch(d.label){case 0:return(0,a.cY)("AppChatMsalTokenService.getToken called for resource: "+e),this.publicClientApplication?[3,2]:[4,this.loadMsalBrowser()];case 1:d.sent(),d.label=2;case 2:return[4,this.publicClientApplication];case 3:if(!(t=d.sent()))throw new Error("Failed to acquire token - Could not load msal module");(null===(u=this.params)||void 0===u?void 0:u.logTelemetry)&&a.EG.sendChatEventTelemetry((0,o.pN)(((c={})[r.h3.ChatEventType]=r.a5.MSALTokenRequested,c))),i=void 0,d.label=4;case 4:return d.trys.push([4,10,,14]),[4,t.initialize()];case 5:return d.sent(),0!==(null==(l=t.getAllAccounts())?void 0:l.length)?[3,7]:[4,this.ssoSilentNoAccount(e,t)];case 6:return[2,d.sent()];case 7:return[4,this.getSelectedAccount(l,t)];case 8:if(!(i=d.sent()))throw this.logTokenAcquiredError("Failed to acquire token - No account found."),new Error("Failed to acquire token - No account found.");return[4,this.acquireTokenSilent(e,i,t,n)];case 9:return[2,d.sent()];case 10:return s=d.sent(),(0,a.cY)("Failed to get access token: ".concat(null==s?void 0:s.message)),this.msalModule&&s instanceof this.msalModule.InteractionRequiredAuthError?[4,this.acquireTokenPopup(e,i,t)]:[3,12];case 11:return[2,d.sent()];case 12:throw this.logTokenAcquiredError("Failed to acquire token - No token acquired."),s;case 13:return[3,14];case 14:return[2]}}))}))},e.prototype.getAccountInfoFromCache=function(){return c(this,void 0,void 0,(function(){var e,t,n=this;return d(this,(function(a){switch(a.label){case 0:return this.publicClientApplication?[3,2]:[4,this.loadMsalBrowser()];case 1:a.sent(),a.label=2;case 2:return[4,this.publicClientApplication];case 3:if(!(e=a.sent()))throw this.logTokenAcquiredError("Failed to get account info - Could not load msal module"),new Error("Failed to get account info - Could not load msal module");return[4,e.initialize()];case 4:return a.sent(),[2,null!==(t=e.getAllAccounts().find((function(e){var t,a,o;return(null===(t=e.username)||void 0===t?void 0:t.toLowerCase())===(null===(o=null===(a=n.params)||void 0===a?void 0:a.userPrincipalName)||void 0===o?void 0:o.toLowerCase())})))&&void 0!==t?t:null]}}))}))},e.prototype.getSelectedAccount=function(e,t){return c(this,void 0,void 0,(function(){var n,a,o,r,i=this;return d(this,(function(l){switch(l.label){case 0:return this.loginPopupPromise?[4,this.loginPopupPromise]:[3,2];case 1:return[2,null==(o=l.sent())?void 0:o.account];case 2:if(!e||0===e.length)return[2,null];if(n=this.params?null!==(r=e.find((function(e){var t,n,a;return(null===(t=e.username)||void 0===t?void 0:t.toLowerCase())===(null===(a=null===(n=i.params)||void 0===n?void 0:n.userPrincipalName)||void 0===a?void 0:a.toLowerCase())})))&&void 0!==r?r:null:e[0],n)return[2,n];a=this.params?{loginHint:this.params.userPrincipalName}:void 0,l.label=3;case 3:return l.trys.push([3,,5,6]),this.loginPopupPromise=t.loginPopup(a),[4,this.loginPopupPromise];case 4:return[2,null==(o=l.sent())?void 0:o.account];case 5:return this.loginPopupPromise=void 0,[7];case 6:return[2]}}))}))},e.prototype.ssoSilentNoAccount=function(e,t){return c(this,void 0,void 0,(function(){var n,a,o;return d(this,(function(r){switch(r.label){case 0:return n={scopes:["".concat(e,"/.default")],loginHint:null===(o=this.params)||void 0===o?void 0:o.userPrincipalName},[4,t.ssoSilent(n)];case 1:return(a=r.sent())||this.logTokenAcquiredError("Failed to acquire token using ssoSilent - No token acquired."),[2,a]}}))}))},e.prototype.acquireTokenSilent=function(e,t,n,a){return c(this,void 0,void 0,(function(){var o,r;return d(this,(function(i){switch(i.label){case 0:return o={scopes:null!=a?a:["".concat(e,"/.default")],account:t},[4,n.acquireTokenSilent(o)];case 1:return(r=i.sent())||this.logTokenAcquiredError("Failed to acquire token using acquireTokenSilent - No token acquired."),[2,r]}}))}))},e.prototype.acquireTokenPopup=function(e,t,n){return c(this,void 0,void 0,(function(){var a,o;return d(this,(function(r){switch(r.label){case 0:return a={scopes:["".concat(e,"/.default")],account:t},[4,n.acquireTokenPopup(a)];case 1:return(o=r.sent())||this.logTokenAcquiredError("Failed to acquire token using acquireTokenPopup - No token acquired."),[2,o]}}))}))},e.prototype.logTokenAcquiredError=function(e){var t,n;(null===(n=this.params)||void 0===n?void 0:n.logTelemetry)&&a.EG.sendErrorTelemetry((0,o.pN)(((t={})[r.IC.ErrorCategory]=r.S2.MSAL,t[r.IC.ErrorMessage]=e,t)))},e}()},330123:(e,t,n)=>{"use strict";n.d(t,{JK:()=>L,RD:()=>O,bn:()=>M,qx:()=>D});var a=n(639765),o=n(548366),r=n(881707),i=n(178365),l=n(986885),s=n(764738),c=n(16244),d=n(965465),u=n(414542),m=n(857677),g=n(83437),h=n(70239),p=n(47717),b=n(76872),f=n(75496),C=n(316904),y=n(664007),v=n(994481),T=n(705147),x=n(883),S=n(164584),w=n(347145),E=n(507628);const I=(0,w.Z8j)("Microsoft.Office.Excel.FA000000124.CitationMetadataFetchRequestTimeoutMs",3e4),R=C.M.getInstance(),A=b.E.getInstance();function L(e){return void 0!==e.sourceAttributions&&void 0!==e.messageId}const k=new Map,F=new Map;async function _(e,t,n,r){try{const d=new h.g0({parentPath:["Signal",l.Uk.getTypeName()],items:[{id:n,body:new l.Uk({locale:r,fileIdentifiers:[{fileUrl:t,fileName:e}],requestId:n})}]});if((0,w.yw9)("OfficeVSO_9523129_refactorCitationSignalAwait"))return(0,u.T)(d,n,f.S2.FetchCitationMetadata,m.OP.FetchCitationFileMetadata,s.bV.getTypeName(),I);{const e=(0,T.p)();i.$.getInstance().submitOperation({operation:d,workflowAnnotationType:s.bV.getTypeName()});const t=setTimeout((()=>{N(n,{id:n,body:{requestId:n,error:{errorCode:c.O.Timeout,errorMessage:`ExcelImportDataFileMetadataSignal Request timed out after ${I} ms. request id ${n}`}}}),R.logStandardizedAshaErrorEvent(o.W.Unable_To_Complete_Task,a.c.Import_Data_File_Fetching_Timeout,m.BJ.ImportData)}),I);return k.set(n,{deferredPromise:e,requestId:n,timeoutId:t,startTime:performance.now(),telemetryEventType:f.S2.CitationFileUtils,latencyOperation:m.OP.FetchCitationFileMetadata}),e.promise}}catch(e){throw R.logError({eventType:f.S2.CitationFileUtils,errorMessage:`Error while submitting signal to fetch citation file details: ${e} ${JSON.stringify(e)}`,logLevel:g.$b.Error}),R.logStandardizedAshaErrorEvent(o.W.Unable_To_Complete_Task,a.c.Import_Data_File_Fetching_Error,m.BJ.ImportData),e}}function P(e,t){const n=F.get(e);if(n){F.delete(e),clearTimeout(n.timeoutId);const a=performance.now()-n.startTime;A.logLatency(a,m.OP.FetchTablesRelevancy),t instanceof Error?n.deferredPromise.reject(t):n.deferredPromise.resolve(t.body),R.logEvent((0,m.P1)(f.S2.FetchTablesRelevancy,{[f.IC.RequestId]:e,[f.IC.ExecutionTime]:a,[f.IC.Success]:!(t instanceof Error),[f.IC.Error]:t instanceof Error?t.message:""}))}else R.logStandardizedAshaErrorEvent(o.W.Unable_To_Complete_Task,a.c.Import_Data_Relevancy_Error,m.BJ.ImportData),R.logError({eventType:f.S2.CitationFileUtils,errorMessage:`Received data import annotation for unknown request ${e}`,logLevel:g.$b.Warning})}function N(e,t){const n=k.get(e);if(n){k.delete(e),clearTimeout(n.timeoutId);const a=performance.now()-n.startTime;A.logLatency(a,m.OP.FetchCitationFileMetadata),t instanceof Error?n.deferredPromise.reject(t):n.deferredPromise.resolve(t.body),R.logEvent((0,m.P1)(f.S2.FetchCitationMetadata,{[f.IC.RequestId]:e,[f.IC.ExecutionTime]:a,[f.IC.Success]:!(t instanceof Error),[f.IC.Error]:t instanceof Error?t.message:""}))}else R.logStandardizedAshaErrorEvent(o.W.Unable_To_Complete_Task,a.c.Import_Data_File_Fetching_Error,m.BJ.ImportData),R.logError({eventType:f.S2.CitationFileUtils,errorMessage:`Received data import annotation for unknown request ${e}`,logLevel:g.$b.Warning})}function M(e){e.body&&s.bV.typeGuard(e.body)&&N(e.body.requestId,e)}function O(e){e.body&&s.Dd.typeGuard(e.body)&&P(e.body.requestId,e)}class D{static getInstance(){return D._instance||(D._instance=new D((()=>(0,E.A)()),S.qD)),D._instance}stopGeneratingCurrentMessageId(){this.stoppedMessages.add(this.currentImportOperationMessageId)}doesMessageHaveFilteredExcelFiles(e){return this.messageIdsFilteredExcelFiles.has(e)}isMessageCancelled(e){return this.stoppedMessages.has(e)}setMessageMetadata(e,t){const n=t.messages?.filter((e=>"user"===e.author))[0]?.text??"";this.messageIdToMessageMetaDataMap.set(e.messageId,{userQuery:n,chatResponse:e.text,locale:e.locale??"",sensitivityLabel:e.sensitivityLabel})}doMessageContainsExcelCitation(e){return this.messageIdToFileUrlsMap.has(e)}doMessageContainsCitation(e){return this.messagesWithCitations.has(e)}async processCitations(e,t){try{this.augloopSession?e.sourceAttributions?.forEach((async n=>{this.messagesWithCitations.add(e.messageId);const a=await this.getReferenceMetadataForValidExcelFile(n,e.messageId);if(!a)return(0,x.debuglog)("Skipping citation file details fetch for non valid excel file"),Promise.resolve();const o=n.seeMoreUrl;if(this.messageIdToFileUrlsMap.has(e.messageId)||this.messageIdToFileUrlsMap.set(e.messageId,new Set),(0,w.iPS)("Microsoft.Office.Excel.FA000000124.Limit10FilesPerMessage",!0)&&this.messageIdToFileUrlsMap.get(e.messageId).size>=10)return void R.logError({eventType:f.S2.CitationFileUtils,errorMessage:"Number of files per message exceeds the limit of 10. skipping excel citation file",logLevel:g.$b.Warning});this.messageIdToFileUrlsMap.get(e.messageId)?.add(o);const r=`${C.M.userQueryGuid}_${e.messageId}_${this.requestIdGenerator()}`;if(!this.inProgressItems?.has(o)&&!this.resolvedItems?.has(o)){const e=async()=>{try{const e=await this.fetchCitationFileDetailsImpl(a.fileName,o,r,t??"");return this.resolvedItems?.has(o),this.resolvedItems?.set(o,e),this.inProgressItems?.delete(o),this.notifyItemResolvedEventHandlers(e),e}catch(e){return this.inProgressItems?.delete(o),R.logError({eventType:f.S2.CitationFileUtils,errorMessage:`Error while fetching citation file details: ${e} ${JSON.stringify(e)}`,logLevel:g.$b.Error}),Promise.resolve(void 0)}};this.inProgressItems?.set(o,e())}})):R.logError({eventType:f.S2.CitationFileUtils,errorMessage:"AugLoop session is not available to process citations",logLevel:g.$b.Warning})}catch(e){R.logError({eventType:f.S2.CitationFileUtils,errorMessage:`Error while processing citations: ${e} ${JSON.stringify(e)}`,logLevel:g.$b.Error}),R.logStandardizedAshaErrorEvent(o.W.Unable_To_Complete_Task,a.c.Import_Data_File_Fetching_Error,m.BJ.ImportData)}}intersectResolvedCitations(e){return e?.filter((e=>e.seeMoreUrl&&this.resolvedItems?.has(e.seeMoreUrl)))?.map((e=>this.resolvedItems.get(e.seeMoreUrl)))?.filter((e=>void 0!==e))}async fetchRelevantTablesForMessageId(e,t,n,r,d,p=y.m){this.currentImportOperationMessageId=e;try{r(p.startExecutingCommand({command:m.OP.ImportDataGenerateSuggestion,id:d}));const b=await this.getAllResolvedDataSourcesForMessageId(e,t),y=this.messageIdToMessageMetaDataMap.get(e);if(!y||0===b.length){const t=`Message metadata or dataSources not found.\nskipping relevancy check.\ndataSources length: ${b.length},\nmessageMetaData undefined: ${!y},\nmessage id: ${e}`;return R.logError({eventType:f.S2.CitationFileUtils,errorMessage:t,logLevel:g.$b.Error}),Promise.resolve({requestId:"",dataSources:b})}if(!(0,w.iPS)("Microsoft.Office.Excel.FA000000124.ImportDataEnableRelevancyCheck",!0))return Promise.resolve({requestId:"",dataSources:b});r(p.stopExecuting({isSuccess:!0,keepShowingLoadingUIIfAlreadyActive:!0})),r(p.startExecutingCommand({command:m.OP.ImportDataRelevancyCheck,id:d}));const v=`${C.M.userQueryGuid}_${e}_${this.requestIdGenerator()}`,S=new h.g0({parentPath:["Signal","ExcelImportDataSourcesRelevancySignal"],items:[{id:v,body:new l.sN({requestId:v,userQuery:y?.userQuery??"",chatResponse:y?.chatResponse??"",sources:b})}]});if((0,w.yw9)("OfficeVSO_9523129_refactorCitationSignalAwait"))return(0,u.T)(S,v,f.S2.FetchTablesRelevancy,m.OP.FetchTablesRelevancy,s.Dd.getTypeName(),n,{dataSourcesLength:b.length});{const e=(0,T.p)();(0,x.debuglog)(`SENDING SIGNAL TO RUN RELEVANCY CHECK: ${JSON.stringify(S)}`),i.$.getInstance().submitOperation({operation:S,workflowAnnotationType:s.Dd.getTypeName()});const t=setTimeout((()=>{P(v,{id:v,body:{requestId:v,dataSources:b,error:{errorCode:c.O.Timeout,errorMessage:`ExcelImportDataSourcesRelevancySignal Request timed out after ${n} ms. returning sources without relevancy. request id ${v}`}}}),R.logStandardizedAshaErrorEvent(o.W.Unable_To_Complete_Task,a.c.Import_Data_Relevancy_Timeout,m.BJ.ImportData)}),n);return F.set(v,{deferredPromise:e,requestId:v,timeoutId:t,telemetryEventType:f.S2.CitationFileUtils,latencyOperation:m.OP.FetchTablesRelevancy,startTime:performance.now()}),e.promise}}catch(e){throw R.logError({eventType:f.S2.CitationFileUtils,errorMessage:`Error while submitting signal to run relevancy check: ${e} ${JSON.stringify(e)}`,logLevel:g.$b.Error}),R.logStandardizedAshaErrorEvent(o.W.Unable_To_Complete_Task,a.c.Import_Data_Relevancy_Error,m.BJ.ImportData),e}}async getAllResolvedDataSourcesForMessageId(e,t){const n=this.messageIdToFileUrlsMap.get(e)??new Set,r=this.getCurrentTime()+t,i=()=>Array.from(n).filter((e=>!this.resolvedItems.has(e)&&this.inProgressItems.has(e)));let l=i();for(;l.length>0&&this.getCurrentTime()<r;)await Promise.race([B(r-this.getCurrentTime()),this.waitForItemResolved()]),l=i();const s=Array.from(n).map((e=>this.resolvedItems.get(e))),d=s.filter((t=>{const n=void 0!==t&&void 0===t.error&&t.dataSources&&t.dataSources.length>0;if(!n&&(t&&!t.error||this.messageIdsFilteredExcelFiles.add(e),R.logError({eventType:f.S2.CitationFileUtils,errorMessage:`Filtering resolved citation: citationDetails: ${!!t} citationDetails.error: ${JSON.stringify(t?.error)}\n            } citationDetails.dataSources count: ${t?.dataSources?.length}, requestId: ${t?.requestId}`,logLevel:g.$b.Error}),t?.error?.errorCode)){const e=t.error.errorCode===c.O.Timeout?a.c.Import_Data_File_Fetching_Timeout:a.c.Import_Data_File_Fetching_Error;R.logStandardizedAshaErrorEvent(o.W.Unable_To_Complete_Task,e,m.BJ.ImportData)}return n})),u=d.map((e=>e.dataSources)).flat(),h=u.filter((e=>{const t=void 0===e.error&&e.sourceName&&e.sourceLocation&&e.powerQueryScript;return t||R.logError({eventType:f.S2.CitationFileUtils,errorMessage:`Filtering data source: dataSource.error: ${JSON.stringify(e.error)} dataSource.sourceName: ${!!e.sourceName} dataSource.sourceLocation: ${!!e.sourceLocation} dataSource.powerQueryScript: ${!!e.powerQueryScript}`,logLevel:g.$b.Error}),t}));return R.logEvent((0,m.P1)(f.S2.GetResolvedCitations,{[f.IC.TotalFiles]:n.size,[f.IC.UnresolvedCitations]:l.length,[f.IC.ResolvedCitations]:s.length,[f.IC.ResolvedValidCitations]:d.length,[f.IC.ResolvedDataSources]:u.length,[f.IC.ValidDataSources]:h.length})),h}registerOnItemResolvedEventHandler(e){this.onItemResolvedEventHandlers.push(e)}unregisterOnItemResolvedEventHandler(e){const t=this.onItemResolvedEventHandlers.indexOf(e);t>-1&&this.onItemResolvedEventHandlers.splice(t,1)}waitForItemResolved(){return new Promise((e=>{this.registerOnItemResolvedEventHandler((t=>{this.unregisterOnItemResolvedEventHandler(e),e(t)}))}))}notifyItemResolvedEventHandlers(e){setTimeout((()=>{this.onItemResolvedEventHandlers.forEach((t=>t(e)))}),0)}async getReferenceMetadataForValidExcelFile(e,t,n=(0,w.Te4)("Microsoft.Office.Excel.FA000000124.ImportAllowedFileTypes",["xlsx","xlsm"]),a=(0,w.iPS)("Microsoft.Office.Excel.FA000000124.DecryptProtectedExcelFileV2",!1)){if(e.referenceMetadata)try{const o=JSON.parse(e.referenceMetadata);if(!o)throw new Error("referenceMetadata could not be parsed");const i=o.referenceType===p.YA.Excel||o.referenceType===d.ss.Excel,l=void 0!==e.providerDisplayName,s=o.sensitivityLabel?.isEncrypted,c=(0,w.iPS)("Microsoft.Office.Excel.FA000000124.ImportFilterEncryptedAndHigherCLPFiles",!0)&&!a;if(!i)return R.logError({eventType:f.S2.CitationFileUtils,errorMessage:`Skipping none excel file. referenceType: ${o.referenceType}`,logLevel:g.$b.Warning}),Promise.resolve(void 0);if(o.fileName?.includes(".")){const e=o.fileName?.split(".").pop()?.toLowerCase();if(e&&!n.includes(e))return R.logError({eventType:f.S2.CitationFileUtils,errorMessage:`Skipping file: fileExtension: ${e}`,logLevel:g.$b.Warning}),Promise.resolve(void 0)}return!l||s&&c?(R.logError({eventType:f.S2.CitationFileUtils,errorMessage:`Skipping file: hasDisplayName: ${l}, isEncrypted: ${s}`,logLevel:g.$b.Warning}),this.messageIdsFilteredExcelFiles.add(t),Promise.resolve(void 0)):c&&await async function(e){const t=(0,v.oR)(e.sensitivityLabel);return await r.n.getInstance().isSensitivityHigherThanDoc(t)}(o)?((0,x.debuglog)(`Skipping citation file details fetch for sensitive file ${o.fileName} with sensitivity ${o.sensitivityLabel}`),R.logError({eventType:f.S2.CitationFileUtils,errorMessage:`Skipping citation file details fetch for sensitive file with sensitivity ${o.sensitivityLabel?.displayName}`,logLevel:g.$b.Warning}),this.messageIdsFilteredExcelFiles.add(t),Promise.resolve(void 0)):e.seeMoreUrl?(o.fileName=e.providerDisplayName,Promise.resolve(o)):(R.logError({eventType:f.S2.CitationFileUtils,errorMessage:"Citation file url is missing in source attribution",logLevel:g.$b.Warning}),this.messageIdsFilteredExcelFiles.add(t),Promise.resolve(void 0))}catch(e){R.logError({eventType:f.S2.CitationFileUtils,errorMessage:`Error while parsing reference metadata: ${e} ${JSON.stringify(e)}`,logLevel:g.$b.Error}),this.messageIdsFilteredExcelFiles.add(t)}return Promise.resolve(void 0)}constructor(e,t,n=new Map,a=new Map,o=new Map,r=new Set,i=new Map,l=new Set,s=Date.now,c=_,d=new Set){this.requestIdGenerator=e,this.inProgressItems=n,this.resolvedItems=a,this.messageIdToFileUrlsMap=o,this.messagesWithCitations=r,this.messageIdToMessageMetaDataMap=i,this.messageIdsFilteredExcelFiles=l,this.getCurrentTime=s,this.fetchCitationFileDetailsImpl=c,this.stoppedMessages=d,this.augloopSession=void 0,this.onItemResolvedEventHandlers=[],this.currentImportOperationMessageId="",t().then((e=>{this.augloopSession=e}))}}function B(e){return new Promise((t=>setTimeout(t,e)))}D._instance=void 0},338649:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var a=n(535718),o=n.n(a),r=n(871038),i=n.n(r)()(o());i.push([e.id,'.chart>svg{overflow:hidden}.pivot-table-light16{font-size:12px;font-size:15px;line-height:21px;overflow:hidden;width:100%}.pivot-table-light16 thead tr:first-child{border-top:1px solid rgba(0,0,0,0);border-bottom:1px solid #dce6f1}.pivot-table-light16 thead tr:last-child{border-bottom:1px solid #7ca6d5}.pivot-table-light16__ellipsis{font-size:20px;line-height:21px;overflow:hidden;width:100%}.pivot-table-light16__table{border:none;border-collapse:collapse}.pivot-table-light16__text{height:21px;overflow:hidden;padding:0 4px;text-overflow:ellipsis;white-space:nowrap}html[dir=ltr] .pivot-table-light16__text{text-align:left}html[dir=rtl] .pivot-table-light16__text{text-align:right}.pivot-table-light16__header{font-weight:bold}.pivot-table-light16__body{border-bottom:1px solid rgba(0,0,0,0)}html[dir=ltr] .pivot-table-light16__right-aligned{text-align:right}html[dir=rtl] .pivot-table-light16__right-aligned{text-align:left}.pivot-table-light16__grand-total{font-weight:bold}.pivot-table-light16__subtotal{font-weight:bold}.pivot-table-light16__highlight-cell{color:#ed7331}.pivot-table-light16__subtotal-row{border-bottom:1px solid #7ca6d5}.pivot-table-light16__grand-total{border-top:1px solid #7ca6d5;border-bottom:1px solid rgba(0,0,0,0)}.pivot-table-light16__subtotal{border-bottom:1px solid #7ca6d5}.query-result{font-size:15px;line-height:21px;overflow:hidden;width:100%}.query-result thead tr:first-child{border-top:1px solid rgba(0,0,0,0);border-bottom:1px solid #dce6f1}.query-result thead tr:last-child{border-bottom:1px solid #7ca6d5}.query-result__ellipsis{font-size:20px;line-height:21px;overflow:hidden;width:100%}.query-result__table{border:none;border-collapse:collapse}.query-result__text{height:21px;overflow:hidden;padding:0 4px;text-overflow:ellipsis;white-space:nowrap}html[dir=ltr] .query-result__text{text-align:left}html[dir=rtl] .query-result__text{text-align:right}.query-result__header{font-weight:bold}.query-result__body{border-bottom:1px solid rgba(0,0,0,0)}html[dir=ltr] .query-result__right-aligned{text-align:right}html[dir=rtl] .query-result__right-aligned{text-align:left}.query-result__grand-total{font-weight:bold}.query-result__subtotal{font-weight:bold}.query-result__highlight-cell{color:#ed7331}.query-result__no-headers{padding:0 4px}.recommendation{list-style:none;margin-left:20px;margin-right:20px;border:1px solid #e0e0e0;position:relative;outline:none;border-style:none}.theme-colorful .recommendation{background-color:#fff}.theme-dark-gray .recommendation{background-color:#fff}.theme-black .recommendation{background-color:#fff}.theme-white .recommendation{background-color:#fff}.theme-colorful .recommendation{color:#262626}.theme-dark-gray .recommendation{color:#262626}.theme-black .recommendation{color:#262626}.theme-white .recommendation{color:#262626}.recommendation::after{-webkit-pointer-events:none;-o-pointer-events:none;-moz-pointer-events:none;-ms-pointer-events:none;pointer-events:none;content:"";position:absolute;left:0;top:0;bottom:0;right:0;border-radius:2px;border-width:2px}.theme-colorful .recommendation::after{border-color:#c6c6c6}.theme-dark-gray .recommendation::after{border-color:#444}.theme-black .recommendation::after{border-color:#505050}.theme-white .recommendation::after{border-color:#c6c6c6}html[dir=ltr] .recommendation::after{box-shadow:0 2px 4px -0.75px rgba(0,0,0,.1)}html[dir=rtl] .recommendation::after{box-shadow:0 2px 4px -0.75px rgba(0,0,0,.1)}.theme-colorful.ms-Fabric--isFocusVisible .recommendation:focus::after{border-color:#107c41}.theme-dark-gray.ms-Fabric--isFocusVisible .recommendation:focus::after{border-color:#4e9668}.theme-black.ms-Fabric--isFocusVisible .recommendation:focus::after{border-color:#4e9668}.theme-white.ms-Fabric--isFocusVisible .recommendation:focus::after{border-color:#107c41}@media screen and (-ms-high-contrast: active),screen and (forced-colors: active){.recommendation:focus::after{border-style:dashed}}.theme-colorful .recommendation:hover::after{border-color:#107c41}.theme-dark-gray .recommendation:hover::after{border-color:#4e9668}.theme-black .recommendation:hover::after{border-color:#4e9668}.theme-white .recommendation:hover::after{border-color:#107c41}@media screen and (-ms-high-contrast: active),screen and (forced-colors: active){.recommendation:hover::after{border-style:dashed}}.recommendation__chart,.recommendation__pivot-table,.recommendation__empty-pivot-table,.recommendation__query-result,.recommendation__text-analysis-tagging{margin:8px 0 0}.recommendation__chart{padding-top:50%;position:relative;border:1px solid #e0e0e0;border-radius:2px}.recommendation__chart .chart{position:absolute;top:0;left:0;right:0;bottom:0}.recommendation__pivot-table{border:1px solid #e0e0e0;border-radius:2px}.recommendation__empty-pivot-table,.recommendation__query-result,.recommendation__text-analysis-tagging{padding:12px;border:1px solid #e0e0e0;border-radius:2px}.recommendation__invalid{background-color:#edebe9;opacity:.5}.recommendation__title{display:flex}.recommendation__title button{margin-top:13px;width:16px;height:16px;top:0;z-index:1}html[dir=ltr] .recommendation__title button{margin-left:10px}html[dir=rtl] .recommendation__title button{margin-right:10px}.recommendation__title button i{font-size:12px}.recommendation__title-group:last-child{padding-bottom:8px}.recommendation__collapsed{cursor:pointer}.recommendation__footer{font-family:"Segoe UI";font-style:normal;font-weight:400;font-size:12px;line-height:16px;display:flex;align-items:center;color:#242424}.recommendation__footer-insert-explain{margin:0px 8px 8px 8px;border:1px solid #d1d1d1;border-radius:4px}.recommendation-title{font-size:14px;font-weight:700;line-height:20px;margin:0;vertical-align:top;text-overflow:ellipsis;overflow:hidden}.recommendation-title__rich-text__0{color:rgb(187.975,85.775,16.425)}.recommendation-title__rich-text__1{color:blue}.recommendation-subtitle{color:#323130;font-size:12px;margin:0;padding:2px 0 4px;vertical-align:top;word-wrap:break-word;overflow-wrap:break-word}.explanation-dropdown{color:#107c41;font-size:12px}.explanation-dropdown:hover{color:#0f703b}.explanation-dropdown:active{color:#094624}.explanation-dropdown:disabled{color:#bdbdbd}.explanation-dropdown i{color:inherit}.explanation-content{margin:0px 8px}.column-recommendation .formula-description{padding:0;box-sizing:border-box}.column-recommendation .formula-description p{all:inherit}.python-recommendation__title{font-weight:600;margin-top:12px;color:#242424}.python-recommendation .monaco-read-only{width:auto}.python-recommendation .monaco-read-only .monaco-editor .cursors-layer>.cursor{display:none !important}.python-recommendation .python-description{margin:8px 0px 0px;padding:0;box-sizing:border-box}.python-recommendation .python-description p{all:inherit}.recommendation__text-analysis__bullet-header{font-weight:bold}.AugloopDiganosticsPaneContainer{overflow:auto;padding-left:"2%";margin:0;width:"96%"}.hideOverflow{width:90%;text-overflow:ellipsis}.tree{--spacing: 1rem;--radius: 7px;padding-left:0;padding-inline-start:0}.tree li{display:block;position:relative;padding-inline-start:0;padding-left:calc(2*var(--spacing) - var(--radius) - 2px)}.tree ul{margin-left:calc(var(--radius) - var(--spacing));padding-left:0;padding-inline-start:0}.tree ul li{border-left:2px solid #ddd}.tree ul li:last-child{border-color:rgba(0,0,0,0)}.tree ul li::before{content:"";display:block;position:absolute;top:calc(var(--spacing)/-2);left:-2px;width:calc(var(--spacing) + 2px);height:calc(var(--spacing) + 1px);border:solid #ddd;border-width:0 0 2px 2px}.tree summary{display:block;cursor:pointer}.tree summary::marker,.tree summary::-webkit-details-marker{display:none}.tree summary:focus{outline:none}.tree summary:focus-visible{outline:1px dotted #000}.tree li::after,.tree summary::before{content:"";display:block;position:absolute;top:calc(var(--spacing)/2 - var(--radius));left:calc(var(--spacing) - var(--radius) - 1px);width:calc(2*var(--radius));height:calc(2*var(--radius));border-radius:50%;background:#ddd}.tree summary::before{z-index:1;background:#7196c7 0 0}.tree details[open]>summary::before{background-position:calc(-2*var(--radius)) 0}.text-analysis-tagging{font-size:15px;line-height:21px;overflow:hidden;width:100%}.text-analysis-tagging thead tr:first-child{border-top:1px solid rgba(0,0,0,0);border-bottom:1px solid #dce6f1}.text-analysis-tagging thead tr:last-child{border-bottom:1px solid #7ca6d5}.text-analysis-tagging__ellipsis{font-size:20px;line-height:21px;overflow:hidden;width:100%}.text-analysis-tagging__table{border:none;border-collapse:collapse}.text-analysis-tagging__text{height:21px;overflow:hidden;padding:0 4px;text-overflow:ellipsis;white-space:nowrap}html[dir=ltr] .text-analysis-tagging__text{text-align:left}html[dir=rtl] .text-analysis-tagging__text{text-align:right}.text-analysis-tagging__header{font-weight:bold}.text-analysis-tagging__body{border-bottom:1px solid rgba(0,0,0,0)}html[dir=ltr] .text-analysis-tagging__right-aligned{text-align:right}html[dir=rtl] .text-analysis-tagging__right-aligned{text-align:left}.text-analysis-tagging__grand-total{font-weight:bold}.text-analysis-tagging__subtotal{font-weight:bold}.text-analysis-tagging__highlight-cell{color:#ed7331}.text-analysis-tagging__no-headers{padding:0 4px}',"",{version:3,sources:["webpack://./src/frontend/styles/components/_chart.scss","webpack://./src/frontend/styles/components/_pivot-table.scss","webpack://./src/frontend/styles/components/_preview-table.scss","webpack://./../../../../npm/.store/sdx_officecopilot/@fluentui-common-styles@1.2.58-938c4d7a801cd37a7015/node_modules/@fluentui/common-styles/dist/sass/_i18n.scss","webpack://./src/frontend/styles/components/_query-result.scss","webpack://./src/frontend/styles/components/_recommendation.scss","webpack://./src/frontend/styles/abstracts/_mixins.scss","webpack://./src/frontend/styles/abstracts/_theming.scss","webpack://./src/frontend/styles/abstracts/_palette.scss","webpack://./src/frontend/styles/components/_recommendation-title.scss","webpack://./src/frontend/styles/components/_explanation.scss","webpack://./src/frontend/styles/components/_column-recommendation.scss","webpack://./src/frontend/styles/components/_python-recommendation.scss","webpack://./src/frontend/styles/components/_text-analysis.scss","webpack://./src/frontend/styles/components/augloop-diagnostics.scss","webpack://./src/frontend/styles/components/_text-analysis-tagging.scss"],names:[],mappings:"AAGE,WACE,eAAA,CAAA,qBCCF,cAAA,CCFA,cAAA,CACA,gBAAA,CACA,eAAA,CACA,UAAA,CAEA,0CACE,kCAAA,CACA,+BAAA,CAGF,yCACE,+BAAA,CAGF,+BACE,cAAA,CACA,gBAAA,CACA,eAAA,CACA,UAAA,CAGF,4BACE,WAAA,CACA,wBAAA,CAGF,2BACE,WAAA,CACA,eAAA,CACA,aAAA,CACA,sBAAA,CACA,kBAAA,CC7BA,yCA8NQ,eAAA,CAvNR,yCA0NQ,gBAAA,CDhMV,6BACE,gBAAA,CAGF,2BACE,qCAAA,CCtCA,kDAqOQ,gBAAA,CA9NR,kDAiOQ,eAAA,CD3LV,kCACE,gBAAA,CAGF,+BACE,gBAAA,CAGF,qCACE,aAAA,CDlDF,mCACE,+BAAA,CAGF,kCACE,4BAAA,CACA,qCAAA,CAGF,+BACE,+BAAA,CGfJ,cFDE,cAAA,CACA,gBAAA,CACA,eAAA,CACA,UAAA,CAEA,mCACE,kCAAA,CACA,+BAAA,CAGF,kCACE,+BAAA,CAGF,wBACE,cAAA,CACA,gBAAA,CACA,eAAA,CACA,UAAA,CAGF,qBACE,WAAA,CACA,wBAAA,CAGF,oBACE,WAAA,CACA,eAAA,CACA,aAAA,CACA,sBAAA,CACA,kBAAA,CC7BA,kCA8NQ,eAAA,CAvNR,kCA0NQ,gBAAA,CDhMV,sBACE,gBAAA,CAGF,oBACE,qCAAA,CCtCA,2CAqOQ,gBAAA,CA9NR,2CAiOQ,eAAA,CD3LV,2BACE,gBAAA,CAGF,wBACE,gBAAA,CAGF,8BACE,aAAA,CEpDF,0BACE,aAAA,CCJJ,gBACE,eAAA,CAEA,gBAAA,CACA,iBAAA,CACA,wBAAA,CCsHA,iBAAA,CACA,YAAA,CACA,iBAAA,CCsLE,gCACE,qBAAA,CADF,iCACE,qBAAA,CADF,6BACE,qBAAA,CADF,6BACE,qBAAA,CADF,gCACE,aAAA,CADF,iCACE,aAAA,CADF,6BACE,aAAA,CADF,6BACE,aAAA,CDtMJ,uBA5DA,2BAAA,CACA,sBAAA,CACA,wBAAA,CACA,uBAAA,CACA,mBAAA,CA2DE,UAAA,CACA,iBAAA,CACA,MAAA,CACA,KAAA,CACA,QAAA,CACA,OAAA,CACA,iBAAA,CAEA,gBAAA,CC0LA,uCACE,oBAAA,CADF,wCACE,iBAAA,CADF,oCACE,oBAAA,CADF,oCACE,oBAAA,CJnTF,qCA+OI,2CAAA,CAxOJ,qCA4OI,2CAAA,CI+EJ,uEACE,oBAAA,CADF,wEACE,oBAAA,CADF,oEACE,oBAAA,CADF,oEACE,oBAAA,CDnMJ,iFA3CA,6BAiBE,mBAAA,CAAA,CC4MA,6CACE,oBAAA,CADF,8CACE,oBAAA,CADF,0CACE,oBAAA,CADF,0CACE,oBAAA,CDnLJ,iFAxCA,6BAGI,mBAAA,CAAA,CDnFJ,4JAKE,cAAA,CAIF,uBACE,eAAA,CACA,iBAAA,CACA,wBAAA,CACA,iBAAA,CAGA,8BACE,iBAAA,CACA,KAAA,CACA,MAAA,CACA,OAAA,CACA,QAAA,CAIJ,6BACE,wBAAA,CACA,iBAAA,CAGF,wGAGE,YAAA,CACA,wBAAA,CACA,iBAAA,CAGF,yBACE,wBG3CK,CH4CL,UAAA,CAGF,uBAGE,YAAA,CACA,8BAEE,eAAA,CACA,UAAA,CACA,WAAA,CACA,KAAA,CACA,SAAA,CF7DF,4CAyKI,gBEjHwB,CFjD5B,4CAqKI,iBEpHwB,CAO1B,gCACE,cAAA,CAKN,wCACE,kBAAA,CAGF,2BACE,cAAA,CAGF,wBACE,sBAAA,CACA,iBAAA,CACA,eAAA,CACA,cAAA,CACA,gBAAA,CACA,YAAA,CACA,kBAAA,CACA,aAAA,CAGF,uCACE,sBAAA,CACA,wBAAA,CACA,iBAAA,CI1FJ,sBACE,cAAA,CACA,eAAA,CACA,gBAAA,CACA,QAAA,CACA,kBAAA,CACA,sBAAA,CACA,eAAA,CAGE,oCACE,gCAAA,CAEF,oCACE,UD6BU,CCxBhB,yBACE,aDpBQ,CCqBR,cAAA,CACA,QAAA,CACA,iBAAA,CACA,kBAAA,CHgIA,oBAAA,CAEA,wBAAA,CIhKF,sBACE,aAAA,CACA,cAAA,CAEA,4BACE,aAAA,CAEF,6BACE,aAAA,CAEF,+BACE,aAAA,CAGF,wBACE,aAAA,CAIJ,qBACE,cAAA,CCnBA,4CACE,SAAA,CACA,qBAAA,CAEA,8CACE,WAAA,CCLJ,8BACE,eAAA,CACA,eAAA,CACA,aAAA,CAGF,yCACE,UAAA,CAEA,+EACE,uBAAA,CAIJ,2CACE,kBAAA,CACA,SAAA,CACA,qBAAA,CAEA,6CACE,WAAA,CCnBN,8CACE,gBAAA,CCDF,iCACE,aAAA,CACA,iBAAA,CACA,QAAA,CACA,WAAA,CAGF,cACE,SAAA,CACA,sBAAA,CAMF,MACE,eAAA,CACA,aAAA,CACA,cAAA,CACA,sBAAA,CAGF,SACE,aAAA,CACA,iBAAA,CACA,sBAAA,CACA,yDAAA,CAGF,SACE,gDAAA,CACA,cAAA,CACA,sBAAA,CAGF,YACE,0BAAA,CAGF,uBACE,0BAAA,CAGF,oBACE,UAAA,CACA,aAAA,CACA,iBAAA,CACA,2BAAA,CACA,SAAA,CACA,gCAAA,CACA,iCAAA,CACA,iBAAA,CACA,wBAAA,CAGF,cACE,aAAA,CACA,cAAA,CAGF,4DAEE,YAAA,CAGF,oBACE,YAAA,CAGF,4BACE,uBAAA,CAGF,sCAEE,UAAA,CACA,aAAA,CACA,iBAAA,CACA,0CAAA,CACA,+CAAA,CACA,2BAAA,CACA,4BAAA,CACA,iBAAA,CACA,eAAA,CAGF,sBACE,SAAA,CACA,sBAAA,CAGF,oCACE,4CAAA,CC1FF,uBbDE,cAAA,CACA,gBAAA,CACA,eAAA,CACA,UAAA,CAEA,4CACE,kCAAA,CACA,+BAAA,CAGF,2CACE,+BAAA,CAGF,iCACE,cAAA,CACA,gBAAA,CACA,eAAA,CACA,UAAA,CAGF,8BACE,WAAA,CACA,wBAAA,CAGF,6BACE,WAAA,CACA,eAAA,CACA,aAAA,CACA,sBAAA,CACA,kBAAA,CC7BA,2CA8NQ,eAAA,CAvNR,2CA0NQ,gBAAA,CDhMV,+BACE,gBAAA,CAGF,6BACE,qCAAA,CCtCA,oDAqOQ,gBAAA,CA9NR,oDAiOQ,eAAA,CD3LV,oCACE,gBAAA,CAGF,iCACE,gBAAA,CAGF,uCACE,aAAA,CapDF,mCACE,aAAA",sourcesContent:['\ufeff@use "../abstracts/mixins";\n\n.chart {\n  > svg {\n    overflow: hidden;\n  }\n}\n','@use "preview-table";\n\n// Matches the default PivotTabyle style, which is "Light Blue, Pivot Style Light 16"\n// For use in clients that don\'t support the TableStyle API\n.pivot-table-light16 {\n  font-size: 12px;\n\n  @include preview-table.preview-table;\n\n  &__subtotal-row {\n    border-bottom: 1px solid #7ca6d5;\n  }\n\n  &__grand-total {\n    border-top: 1px solid #7ca6d5;\n    border-bottom: 1px solid transparent;\n  }\n\n  &__subtotal {\n    border-bottom: 1px solid #7ca6d5;\n  }\n}\n','@use "~@fluentui/common-styles/dist/sass/_i18n";\n\n@mixin preview-table {\n  font-size: 15px;\n  line-height: 21px;\n  overflow: hidden;\n  width: 100%;\n\n  & thead tr:first-child {\n    border-top: 1px solid transparent;\n    border-bottom: 1px solid #dce6f1;\n  }\n\n  & thead tr:last-child {\n    border-bottom: 1px solid #7ca6d5;\n  }\n\n  &__ellipsis {\n    font-size: 20px;\n    line-height: 21px;\n    overflow: hidden;\n    width: 100%;\n  }\n\n  &__table {\n    border: none;\n    border-collapse: collapse;\n  }\n\n  &__text {\n    height: 21px;\n    overflow: hidden;\n    padding: 0 4px;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    @include i18n.text-align(left);\n  }\n\n  &__header {\n    font-weight: bold;\n  }\n\n  &__body {\n    border-bottom: 1px solid transparent;\n  }\n\n  &__right-aligned {\n    @include i18n.text-align(right);\n  }\n\n  &__grand-total {\n    font-weight: bold;\n  }\n\n  &__subtotal {\n    font-weight: bold;\n  }\n\n  &__highlight-cell {\n    color: #ed7331;\n  }\n}\n',"// Some things copied from WinJS with <3\n\n\n// LTR mixin definition\n@mixin LTR {\n    html[dir='ltr'] & {\n        @content;\n    }\n}\n\n// RTL mixin definition\n@mixin RTL {\n    html[dir='rtl'] & {\n        @content;\n    }\n}\n\n// Use baseRTL for a root element of a control that needs rtl support\n@mixin baseRtl {\n    @include RTL {\n        direction: rtl;\n        unicode-bidi: bidi-override;\n    }\n}\n\n/*\n    Common CSS property mixins with support for RTL.\n    Use these mixins when you want to automatically create RTL versions of your properties.\n    They are in alphabetical order (a-z).\n*/\n\n@mixin border-color($top, $right, $bottom, $left) {\n    border-color: $top $right $bottom $left;\n    @include RTL {\n        border-color: $top $left $bottom $right;\n    }\n}\n\n@mixin border-left($width, $style, $color) {\n    @include LTR {\n        border-left: $width $style $color;\n    }\n    @include RTL {\n        border-right: $width $style $color;\n    }\n}\n\n@mixin border-left-color($color) {\n    @include LTR {\n        border-left-color: $color;\n    }\n    @include RTL {\n        border-right-color: $color;\n    }\n}\n\n@mixin border-left-style($style) {\n    @include LTR {\n        border-left-style: $style;\n    }\n    @include RTL {\n        border-right-style: $style;\n    }\n}\n\n@mixin border-left-width($width) {\n    @include LTR {\n        border-left-width: $width;\n    }\n    @include RTL {\n        border-right-width: $width;\n    }\n}\n\n@mixin border-radius($topLeft, $topRight, $bottomRight, $bottomLeft) {\n    border-radius: $topLeft $topRight $bottomRight $bottomLeft;\n    @include RTL {\n        border-radius: $topRight $topLeft $bottomLeft $bottomRight;\n    }\n}\n\n@mixin border-right($width, $style, $color) {\n    @include LTR {\n        border-right: $width $style $color;\n    }\n    @include RTL {\n        border-left: $width $style $color;\n    }\n}\n\n@mixin border-right-color($color) {\n    @include LTR {\n        border-right-color: $color;\n    }\n    @include RTL {\n        border-left-color: $color;\n    }\n}\n\n@mixin border-right-style($style) {\n    @include LTR {\n         border-right-style: $style;\n    }\n    @include RTL {\n        border-left-style: $style;\n    }\n}\n\n@mixin border-right-width($width) {\n    @include LTR {\n        border-right-width: $width;\n    }\n    @include RTL {\n        border-left-width: $width;\n    }\n}\n\n@mixin clear($side) {\n    @if $side == left {\n        @include LTR {\n            clear: $side;\n        }\n        @include RTL {\n            clear: right;\n        }\n    } @else if $side == right {\n        @include LTR {\n            clear: $side;\n        }\n\n        @include RTL {\n            clear: left;\n        }\n    } @else {\n        clear: $side;\n    }\n}\n\n@mixin float($direction) {\n    @if $direction == left {\n        @include LTR {\n            float: left;\n        }\n        @include RTL {\n            float: right;\n        }\n    } @else {\n        @include LTR {\n            float: right;\n        }\n        @include RTL {\n            float: left;\n        }\n    }\n}\n\n@mixin left($distance) {\n    @include LTR {\n        left: $distance;\n    }\n    @include RTL {\n        right: $distance;\n    }\n}\n\n@mixin margin($top, $right, $bottom, $left) {\n    margin: $top $right $bottom $left;\n    @include RTL {\n        margin: $top $left $bottom $right;\n    }\n}\n\n@mixin margin-left($distance) {\n    @include LTR {\n        margin-left: $distance;\n    }\n    @include RTL {\n        margin-right: $distance;\n    }\n}\n\n@mixin margin-right($distance) {\n    @include LTR {\n        margin-right: $distance;\n    }\n    @include RTL {\n        margin-left: $distance;\n    }\n}\n\n@mixin padding($top, $right, $bottom, $left) {\n    padding: $top $right $bottom $left;\n    @include RTL {\n        padding: $top $left $bottom $right;\n    }\n}\n\n@mixin padding-left($distance) {\n    @include LTR {\n        padding-left: $distance;\n    }\n    @include RTL {\n        padding-right: $distance;\n    }\n}\n\n@mixin padding-right($distance) {\n    @include LTR {\n        padding-right: $distance;\n    }\n    @include RTL {\n        padding-left: $distance;\n    }\n}\n\n@mixin right($distance) {\n    @include LTR {\n        right: $distance;\n    }\n    @include RTL {\n        left: $distance;\n    }\n}\n\n@mixin text-align($direction) {\n    @if $direction == left {\n        @include LTR {\n            text-align: left;\n        }\n        @include RTL {\n            text-align: right;\n        }\n    } @else {\n        @include LTR {\n            text-align: right;\n        }\n        @include RTL {\n            text-align: left;\n        }\n    }\n}\n\n@mixin box-shadow($left, $etc) {\n    @include LTR {\n        box-shadow: $left $etc;\n    }\n\n    @include RTL {\n        box-shadow: -$left $etc;\n    }\n}\n\n@mixin transform-scaleX($scaleX: 1) {\n    @include LTR {\n        transform: scaleX($scaleX);\n    }\n    @include RTL {\n        transform: scaleX(-$scaleX);\n    }\n}\n\n@mixin transform-translateX($distance) {\n    @include LTR {\n        transform: translateX($distance);\n    }\n    @include RTL {\n        transform: translateX(-$distance);\n    }\n}\n\n// only supported when ONLY left/right are declared\n@mixin transition-property($direction) {\n    @if $direction == left {\n        @include LTR {\n            transition-property: left;\n        }\n        @include RTL {\n            transition-property: right;\n        }\n    } @else {\n        @include LTR {\n            transition-property: right;\n        }\n        @include RTL {\n            transition-property: left;\n        }\n    }\n}\n\n// Disables high contrast color adjusts for Edge/IE11\n@mixin highContrastAdjust {\n  @media screen and (-ms-high-contrast: active), screen and (forced-colors: active) {\n    -ms-high-contrast-adjust: none;\n    forced-color-adjust: none;\n  }\n}\n",'@use "../abstracts/mixins";\n@use "../abstracts/variables";\n@use "preview-table";\n\n.query-result {\n  @include preview-table.preview-table;\n\n  &__no-headers {\n    padding: 0 4px;\n  }\n}\n','@use "../abstracts/mixins";\n@use "~@fluentui/common-styles/dist/sass/_i18n";\n@use "../abstracts/palette";\n\n.recommendation {\n  list-style: none;\n  // margin in copilot\n  margin-left: 20px;\n  margin-right: 20px;\n  border: 1px solid #e0e0e0;\n\n  @include mixins.card;\n\n  &__chart,\n  &__pivot-table,\n  &__empty-pivot-table,\n  &__query-result,\n  &__text-analysis-tagging {\n    margin: 8px 0 0;\n  }\n\n  // Maintain a 2:1 aspect ratio for the chart\n  &__chart {\n    padding-top: 50%;\n    position: relative;\n    border: 1px solid #e0e0e0;\n    border-radius: 2px;\n\n    // Fill the entire available area\n    .chart {\n      position: absolute;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n    }\n  }\n\n  &__pivot-table {\n    border: 1px solid #e0e0e0;\n    border-radius: 2px;\n  }\n\n  &__empty-pivot-table,\n  &__query-result,\n  &__text-analysis-tagging {\n    padding: 12px;\n    border: 1px solid #e0e0e0;\n    border-radius: 2px;\n  }\n\n  &__invalid {\n    background-color: palette.$Gray30;\n    opacity: 0.5;\n  }\n\n  &__title {\n    // @include expandable-card-button;\n    /* stylelint-disable-next-line plugin/no-unsupported-browser-features */\n    display: flex;\n    button {\n      @include i18n.margin-left(10px);\n      margin-top: 13px;\n      width: 16px;\n      height: 16px;\n      top: 0;\n      z-index: 1;\n\n      i {\n        font-size: 12px;\n      }\n    }\n  }\n\n  &__title-group:last-child {\n    padding-bottom: 8px;\n  }\n\n  &__collapsed {\n    cursor: pointer;\n  }\n\n  &__footer {\n    font-family: "Segoe UI";\n    font-style: normal;\n    font-weight: 400;\n    font-size: 12px;\n    line-height: 16px;\n    display: flex;\n    align-items: center;\n    color: #242424;\n  }\n\n  &__footer-insert-explain {\n    margin: 0px 8px 8px 8px;\n    border: 1px solid #d1d1d1;\n    border-radius: 4px;\n  }\n}\n','@use "~@fluentui/common-styles/dist/sass/_i18n";\n@use "_theming";\n\n@mixin box-shadow-inset($left, $top, $blur, $spread, $color, $inset: false) {\n  @if $inset {\n    @include i18n.LTR {\n      -webkit-box-shadow: inset $left $top $blur $spread $color;\n      -moz-box-shadow: inset $left $top $blur $spread $color;\n      box-shadow: inset $left $top $blur $spread $color;\n    }\n    // @include RTL {\n    //     -webkit-box-shadow: inset -$left $top $blur $spread $color;\n    //     -moz-box-shadow: inset -$left $top $blur $spread $color;\n    //     box-shadow: inset -$left $top $blur $spread $color;\n    // }\n  } @else {\n    @include i18n.LTR {\n      -webkit-box-shadow: $left $top $blur $spread $color;\n      -moz-box-shadow: $left $top $blur $spread $color;\n      box-shadow: $left $top $blur $spread $color;\n    }\n    @include i18n.RTL {\n      -webkit-box-shadow: -$left $top $blur $spread $color;\n      -moz-box-shadow: -$left $top $blur $spread $color;\n      box-shadow: -$left $top $blur $spread $color;\n    }\n  }\n}\n\n@mixin user-select($value: none) {\n  -webkit-touch-callout: $value;\n  -webkit-user-select: $value;\n  -khtml-user-select: $value;\n  -moz-user-select: $value;\n  -ms-user-select: $value;\n  user-select: $value;\n}\n\n@mixin transform($transforms) {\n  -moz-transform: $transforms;\n  -o-transform: $transforms;\n  -ms-transform: $transforms;\n  -webkit-transform: $transforms;\n  transform: $transforms;\n}\n\n@mixin no-transitions {\n  -webkit-transition-property: none;\n  -moz-transition-property: none;\n  -o-transition-property: none;\n  transition-property: none;\n}\n\n@mixin no-pointer-events {\n  -webkit-pointer-events: none;\n  -o-pointer-events: none;\n  -moz-pointer-events: none;\n  -ms-pointer-events: none;\n  pointer-events: none;\n}\n\n@mixin shimmer-table {\n  padding: 14px;\n\n  .ms-Shimmer-container {\n    margin: 10px 0;\n  }\n\n  &__top {\n    margin: 8px 0;\n  }\n\n  &__first-row {\n    margin-bottom: 13px;\n  }\n\n  &__main-row {\n    margin: 5px 0;\n  }\n\n  &__bottom-row {\n    margin-top: 18px;\n  }\n}\n\n@mixin card {\n  @include card-without-focus;\n\n  // This mirrors how Office UI Fabric does keyboard focus indicators. Use ::after pseudo-element\n  // with z-index so that no part of the focus outline is hidden.\n  &:focus::after {\n    @include card-focus-after-pseudo;\n  }\n  &:hover::after {\n    @include theming.themify("border-color", "InsightsCardKeyboardStroke");\n    @include high-contrast {\n      border-style: dashed;\n    }\n  }\n}\n\n@mixin card-focus-after-pseudo {\n  @include theming.themifyForFocus(\n    "border-color",\n    "InsightsCardKeyboardStroke"\n  );\n  @include high-contrast {\n    border-style: dashed;\n  }\n}\n\n@mixin card-without-focus {\n  @include theming.themify("background-color", "InsightsCardBkg");\n  @include theming.themify("color", "InsightsCardText");\n  &::after {\n    @include theming.themify("border-color", "InsightsCardStroke");\n    @include no-pointer-events;\n    content: "";\n    position: absolute;\n    left: 0;\n    top: 0;\n    bottom: 0;\n    right: 0;\n    border-radius: 2px;\n    @include i18n.box-shadow(0, 2px 4px -0.75px rgba(0, 0, 0, 0.1));\n    border-width: 2px;\n  }\n  position: relative;\n  outline: none;\n  border-style: none;\n}\n\n@mixin high-contrast {\n  @media screen and (-ms-high-contrast: active),\n    screen and (forced-colors: active) {\n    @content;\n  }\n}\n\n@mixin not-high-contrast {\n  @media screen and (-ms-high-contrast: none),\n    screen and (forced-colors: none) {\n    @content;\n  }\n}\n\n@mixin highlighted-option {\n  -ms-high-contrast-adjust: none;\n  forced-color-adjust: none;\n\n  @include high-contrast {\n    color: HighlightText;\n    background-color: Highlight;\n  }\n}\n\n@mixin overflow-wrap-break-word {\n  /* IE11 implementation of overflow-wrap */\n  word-wrap: break-word;\n  /* stylelint-disable-next-line plugin/no-unsupported-browser-features */\n  overflow-wrap: break-word;\n}\n','@use "sass:map";\n@use "../abstracts/palette";\n\n/**\n * Each theme is divided into \'Taskpane\', \'Callout\', and \'Custom\' sections.  Theme names for \'Taskpane\' and \'Callout\'\n * are based upon real components in Excel.  Theme names for \'Custom\' are Insights-specific components that have no\n * Excel equivalent. We try to use the \'Taskpane\' and \'Callout\' theme names wherever possible, as they have actual\n * semantic meaning in Excel.\n */\n\n$themes: (\n  "colorful": (\n    // Taskpane\n    "Bkg": palette.$GrayB,\n    "BkgSVFluentRefresh": palette.$Gray94,\n    "Text": palette.$GrayI,\n    "TextSecondary": palette.$GrayE2,\n    "TextEmphasis": palette.$XL7,\n    "TextEmphasisHover": palette.$XL8,\n    "TextEmphasisPressed": palette.$XL7,\n    "TextEmphasisSelected": palette.$XL8,\n    "BkgCtlDisabled": palette.$GrayA,\n    "TextCtlDisabled": palette.$GrayC3,\n    "StrokeCtl": palette.$GrayD,\n    "StrokeCtlDisabled": palette.$GrayC,\n    "TextHyperlink": palette.$XL6,\n    "TextHyperlinkHover": palette.$XL5,\n    "TextHyperlinkPressed": palette.$XL7,\n    "TextHyperlinkFocusRectangle": palette.$GrayE2,\n    // Callout\n    "CalloutBkg": palette.$White,\n    "CalloutText": palette.$GrayI,\n    "CalloutTextSecondary": palette.$GrayI,\n    "CalloutBkgCtl": palette.$White,\n    "CalloutBkgCtlHover": palette.$GrayA,\n    "CalloutBkgCtlPressed": palette.$GrayB,\n    "CalloutTextCtl": palette.$GrayI,\n    "CalloutTextCtlHover": palette.$GrayI,\n    "CalloutTextCtlPressed": palette.$GrayI,\n    "CalloutStrokeCtl": palette.$GrayD,\n    "CalloutStrokeCtlHover": palette.$GrayD,\n    "CalloutStrokeCtlPressed": palette.$GrayD,\n    "CalloutTextHyperlink": palette.$XL6,\n    "CalloutTextHyperlinkHover": palette.$XL4,\n    "CalloutTextHyperlinkPressed": palette.$XL7,\n    // Custom\n    "InsightsCardBkg": palette.$White,\n    "InsightsCardText": palette.$GrayI,\n    "InsightsCardStroke": palette.$GrayC2,\n    "InsightsCardKeyboardStroke": palette.$XLPrimary,\n    "InsightsChartBorder": palette.$GrayB,\n    "InsightsDefaultKeyboardStroke": palette.$GrayI,\n    "InsightsDialogKeyboardStroke": palette.$GrayI,\n    "InsightsScrollBkg": palette.$GrayC2,\n    "InsightsScrollSeparatorStroke": palette.$GrayC2,\n    "InsightsSpinnerBkg": palette.$XL6 palette.$GrayC2 palette.$GrayC2,\n    "InsightsRecommendationFeedbackTextCtl": palette.$GrayE,\n    "InsightsRecommendationFeedbackTextCtlHover": palette.$GrayI,\n    "InsightsRecommendationFeedbackCalloutTextCtl": palette.$GrayI,\n    "InsightsRecommendationFeedbackCalloutBkg": palette.$White,\n    "InsightsRecommendationFeedbackCalloutBkgCtl": palette.$White,\n    "InsightsRecommendationFeedbackCalloutBkgCtlHover": palette.$GrayB,\n    "InsightsRecommendationFeedbackCalloutBkgCtlPressed": palette.$GrayC,\n    "InsightsRecommendationFeedbackCalloutStroke": palette.$GrayC,\n    "InsightsRecommendationFeedbackCalloutMessageText": palette.$GrayI,\n    "InsightsPreferencesCheckbox": palette.$GrayI,\n    "InsightsPreferencesFieldListBkg": palette.$White,\n    "InsightsPreferencesFieldListBorder": palette.$GrayC2,\n    "InsightsPreferencesFieldBkgHover": palette.$XL2,\n    "InsightsPreferencesFieldText": palette.$GrayI,\n    "InsightsPreferencesDropdownBkgHover": palette.$XL2,\n    "InsightsPreferencesDropdownBkg": palette.$White,\n    "InsightsPreferencesDropdownBorder": palette.$GrayC2,\n    "InsightsPreferencesFocusOutline": palette.$GrayE2,\n    "InsightsSecondaryBkgCtl": palette.$GrayB,\n    "InsightsSecondaryBkgCtlHover": palette.$GrayC,\n    "InsightsSecondaryBkgCtlPressed": palette.$GrayC2,\n    "InsightsSecondaryTextCtl": palette.$GrayI,\n    "InsightsSecondaryTextCtlHover": palette.$GrayI,\n    "InsightsSecondaryTextCtlPressed": palette.$GrayI,\n    "InsightsSecondaryStrokeCtl": palette.$GrayD,\n    "InsightsSecondaryStrokeCtlHover": palette.$GrayD,\n    "InsightsSecondaryStrokeCtlPressed": palette.$GrayD,\n  ),\n  "dark-gray": (\n    // Taskpane\n    "Bkg": palette.$GrayE2,\n    "BkgSVFluentRefresh": palette.$Gray18,\n    "Text": palette.$White,\n    "TextSecondary": palette.$White,\n    "TextEmphasis": palette.$White,\n    "TextEmphasisHover": palette.$White,\n    "TextEmphasisPressed": palette.$White,\n    "TextEmphasisSelected": palette.$White,\n    "BkgCtlDisabled": palette.$GrayG,\n    "TextCtlDisabled": palette.$GrayE2,\n    "StrokeCtl": palette.$GrayE,\n    "StrokeCtlDisabled": palette.$GrayF,\n    "TextHyperlink": palette.$HyperlinkA,\n    "TextHyperlinkHover": palette.$White,\n    "TextHyperlinkPressed": palette.$HyperlinkB,\n    "TextHyperlinkFocusRectangle": palette.$Gray18,\n    // Callout\n    "CalloutBkg": palette.$GrayE2,\n    "CalloutText": palette.$White,\n    "CalloutTextSecondary": palette.$White,\n    "CalloutBkgCtl": palette.$GrayE2,\n    "CalloutBkgCtlHover": palette.$GrayE,\n    "CalloutBkgCtlPressed": palette.$GrayD2,\n    "CalloutTextCtl": palette.$White,\n    "CalloutTextCtlHover": palette.$White,\n    "CalloutTextCtlPressed": palette.$White,\n    "CalloutStrokeCtl": palette.$GrayD,\n    "CalloutStrokeCtlHover": palette.$GrayD,\n    "CalloutStrokeCtlPressed": palette.$GrayD,\n    "CalloutTextHyperlink": palette.$XL6,\n    "CalloutTextHyperlinkHover": palette.$XL4,\n    "CalloutTextHyperlinkPressed": palette.$XL7,\n    // Custom\n    "InsightsCardBkg": palette.$White,\n    "InsightsCardText": palette.$GrayI,\n    "InsightsCardStroke": palette.$GrayG,\n    "InsightsCardKeyboardStroke": palette.$XL4,\n    "InsightsChartBorder": palette.$GrayB,\n    "InsightsDefaultKeyboardStroke": palette.$White,\n    "InsightsDialogKeyboardStroke": palette.$GrayI,\n    "InsightsScrollBkg": palette.$GrayC2,\n    "InsightsScrollSeparatorStroke": palette.$GrayG,\n    "InsightsSpinnerBkg": palette.$XL6 palette.$GrayC2 palette.$GrayC2,\n    "InsightsRecommendationFeedbackTextCtl": palette.$GrayE,\n    "InsightsRecommendationFeedbackTextCtlHover": palette.$GrayI,\n    "InsightsRecommendationFeedbackCalloutTextCtl": palette.$GrayI,\n    "InsightsRecommendationFeedbackCalloutBkg": palette.$White,\n    "InsightsRecommendationFeedbackCalloutBkgCtl": palette.$White,\n    "InsightsRecommendationFeedbackCalloutBkgCtlHover": palette.$GrayB,\n    "InsightsRecommendationFeedbackCalloutBkgCtlPressed": palette.$GrayC,\n    "InsightsRecommendationFeedbackCalloutStroke": palette.$GrayC,\n    "InsightsRecommendationFeedbackCalloutMessageText": palette.$GrayI,\n    "InsightsPreferencesCheckbox": palette.$White,\n    "InsightsPreferencesFieldListBkg": palette.$GrayK,\n    "InsightsPreferencesFieldListBorder": palette.$GrayD,\n    "InsightsPreferencesFieldBkgHover": palette.$Grey36,\n    "InsightsPreferencesFieldText": palette.$White,\n    "InsightsPreferencesDropdownBkgHover": palette.$Grey36,\n    "InsightsPreferencesDropdownBkg": palette.$GrayK,\n    "InsightsPreferencesDropdownBorder": palette.$GrayD,\n    "InsightsPreferencesFocusOutline": palette.$White,\n    "InsightsSecondaryBkgCtl": palette.$GrayE2,\n    "InsightsSecondaryBkgCtlHover": palette.$GrayE,\n    "InsightsSecondaryBkgCtlPressed": palette.$GrayD2,\n    "InsightsSecondaryTextCtl": palette.$White,\n    "InsightsSecondaryTextCtlHover": palette.$White,\n    "InsightsSecondaryTextCtlPressed": palette.$White,\n    "InsightsSecondaryStrokeCtl": palette.$GrayD,\n    "InsightsSecondaryStrokeCtlHover": palette.$GrayD,\n    "InsightsSecondaryStrokeCtlPressed": palette.$GrayD,\n  ),\n  "black": (\n    // Taskpane\n    "Bkg": palette.$GrayI,\n    "BkgSVFluentRefresh": palette.$GrayJ,\n    "Text": palette.$White,\n    "TextSecondary": palette.$GrayC3,\n    "TextEmphasis": palette.$XL2,\n    "TextEmphasisHover": palette.$XL2,\n    "TextEmphasisPressed": palette.$XL2,\n    "TextEmphasisSelected": palette.$White,\n    "BkgCtlDisabled": palette.$GrayG,\n    "TextCtlDisabled": palette.$GrayE2,\n    "StrokeCtl": palette.$GrayD,\n    "StrokeCtlDisabled": palette.$GrayF,\n    "TextHyperlink": palette.$HyperlinkD,\n    "TextHyperlinkHover": palette.$HyperlinkB,\n    "TextHyperlinkPressed": palette.$White,\n    "TextHyperlinkFocusRectangle": palette.$Gray20,\n    // Callout\n    "CalloutBkg": palette.$GrayI,\n    "CalloutText": palette.$White,\n    "CalloutTextSecondary": palette.$White,\n    "CalloutBkgCtl": palette.$GrayI,\n    "CalloutBkgCtlHover": palette.$GrayH,\n    "CalloutBkgCtlPressed": palette.$GrayG,\n    "CalloutTextCtl": palette.$White,\n    "CalloutTextCtlHover": palette.$White,\n    "CalloutTextCtlPressed": palette.$White,\n    "CalloutStrokeCtl": palette.$GrayE2,\n    "CalloutStrokeCtlHover": palette.$GrayE2,\n    "CalloutStrokeCtlPressed": palette.$GrayE2,\n    "CalloutTextHyperlink": palette.$HyperlinkC,\n    "CalloutTextHyperlinkHover": palette.$HyperlinkA,\n    "CalloutTextHyperlinkPressed": palette.$White,\n    // Custom\n    "InsightsCardBkg": palette.$White,\n    "InsightsCardText": palette.$GrayI,\n    "InsightsCardStroke": palette.$GrayF,\n    "InsightsCardKeyboardStroke": palette.$XL4,\n    "InsightsChartBorder": palette.$GrayB,\n    "InsightsDefaultKeyboardStroke": palette.$White,\n    "InsightsDialogKeyboardStroke": palette.$White,\n    "InsightsScrollBkg": palette.$GrayF,\n    "InsightsScrollSeparatorStroke": palette.$GrayF,\n    "InsightsSpinnerBkg": palette.$XL6 palette.$GrayC2 palette.$GrayC2,\n    "InsightsRecommendationFeedbackTextCtl": palette.$GrayE,\n    "InsightsRecommendationFeedbackTextCtlHover": palette.$GrayI,\n    "InsightsRecommendationFeedbackCalloutTextCtl": palette.$GrayI,\n    "InsightsRecommendationFeedbackCalloutBkg": palette.$White,\n    "InsightsRecommendationFeedbackCalloutBkgCtl": palette.$White,\n    "InsightsRecommendationFeedbackCalloutBkgCtlHover": palette.$GrayB,\n    "InsightsRecommendationFeedbackCalloutBkgCtlPressed": palette.$GrayC,\n    "InsightsRecommendationFeedbackCalloutStroke": palette.$GrayC,\n    "InsightsRecommendationFeedbackCalloutMessageText": palette.$GrayI,\n    "InsightsPreferencesCheckbox": palette.$White,\n    "InsightsPreferencesFieldListBkg": palette.$GrayH,\n    "InsightsPreferencesFieldListBorder": palette.$GrayE,\n    "InsightsPreferencesFieldBkgHover": palette.$XL7,\n    "InsightsPreferencesFieldText": palette.$White,\n    "InsightsPreferencesDropdownBkgHover": palette.$XL7,\n    "InsightsPreferencesDropdownBkg": palette.$GrayH,\n    "InsightsPreferencesDropdownBorder": palette.$GrayE,\n    "InsightsPreferencesFocusOutline": palette.$Gray20,\n    "InsightsSecondaryBkgCtl": palette.$GrayI,\n    "InsightsSecondaryBkgCtlHover": palette.$GrayH,\n    "InsightsSecondaryBkgCtlPressed": palette.$GrayG,\n    "InsightsSecondaryTextCtl": palette.$White,\n    "InsightsSecondaryTextCtlHover": palette.$White,\n    "InsightsSecondaryTextCtlPressed": palette.$White,\n    "InsightsSecondaryStrokeCtl": palette.$GrayE2,\n    "InsightsSecondaryStrokeCtlHover": palette.$GrayE2,\n    "InsightsSecondaryStrokeCtlPressed": palette.$GrayE2,\n  ),\n  "white": (\n    // Taskpane\n    "Bkg": palette.$White,\n    "BkgSVFluentRefresh": palette.$Gray94,\n    // Override $GrayA with $White\n    "Text": palette.$GrayI,\n    "TextSecondary": palette.$GrayE2,\n    "TextEmphasis": palette.$XL6,\n    "TextEmphasisHover": palette.$XL5,\n    "TextEmphasisPressed": palette.$XL7,\n    "TextEmphasisSelected": palette.$XL6,\n    "BkgCtlDisabled": palette.$GrayA,\n    "TextCtlDisabled": palette.$GrayC3,\n    "StrokeCtl": palette.$GrayD,\n    "StrokeCtlDisabled": palette.$GrayC,\n    "TextHyperlink": palette.$XL6,\n    "TextHyperlinkHover": palette.$XL4,\n    "TextHyperlinkPressed": palette.$XL7,\n    "TextHyperlinkFocusRectangle": palette.$GrayE2,\n    // Callout\n    "CalloutBkg": palette.$White,\n    "CalloutText": palette.$GrayI,\n    "CalloutTextSecondary": palette.$GrayI,\n    "CalloutBkgCtl": palette.$White,\n    "CalloutBkgCtlHover": palette.$GrayA,\n    "CalloutBkgCtlPressed": palette.$GrayB,\n    "CalloutTextCtl": palette.$GrayI,\n    "CalloutTextCtlHover": palette.$GrayI,\n    "CalloutTextCtlPressed": palette.$GrayI,\n    "CalloutStrokeCtl": palette.$GrayD,\n    "CalloutStrokeCtlHover": palette.$GrayD,\n    "CalloutStrokeCtlPressed": palette.$GrayD,\n    "CalloutTextHyperlink": palette.$XL6,\n    "CalloutTextHyperlinkHover": palette.$XL5,\n    "CalloutTextHyperlinkPressed": palette.$XL7,\n    // Custom\n    "InsightsCardBkg": palette.$White,\n    "InsightsCardText": palette.$GrayI,\n    "InsightsCardStroke": palette.$GrayC2,\n    "InsightsCardKeyboardStroke": palette.$XLPrimary,\n    "InsightsChartBorder": palette.$GrayB,\n    "InsightsDefaultKeyboardStroke": palette.$GrayI,\n    "InsightsDialogKeyboardStroke": palette.$GrayI,\n    "InsightsScrollBkg": palette.$GrayC2,\n    "InsightsScrollSeparatorStroke": palette.$GrayC2,\n    "InsightsSpinnerBkg": palette.$XL6 palette.$GrayC2 palette.$GrayC2,\n    "InsightsRecommendationFeedbackTextCtl": palette.$GrayE,\n    "InsightsRecommendationFeedbackTextCtlHover": palette.$GrayI,\n    "InsightsRecommendationFeedbackCalloutTextCtl": palette.$GrayI,\n    "InsightsRecommendationFeedbackCalloutBkg": palette.$White,\n    "InsightsRecommendationFeedbackCalloutBkgCtl": palette.$White,\n    "InsightsRecommendationFeedbackCalloutBkgCtlHover": palette.$GrayB,\n    "InsightsRecommendationFeedbackCalloutBkgCtlPressed": palette.$GrayC,\n    "InsightsRecommendationFeedbackCalloutStroke": palette.$GrayC,\n    "InsightsRecommendationFeedbackCalloutMessageText": palette.$GrayI,\n    "InsightsPreferencesCheckbox": palette.$GrayI,\n    "InsightsPreferencesFieldListBkg": palette.$White,\n    "InsightsPreferencesFieldListBorder": palette.$GrayC,\n    "InsightsPreferencesFieldBkgHover": palette.$XL2,\n    "InsightsPreferencesFieldText": palette.$GrayI,\n    "InsightsPreferencesDropdownBkgHover": palette.$XL2,\n    "InsightsPreferencesDropdownBkg": palette.$White,\n    "InsightsPreferencesDropdownBorder": palette.$GrayC,\n    "InsightsPreferencesFocusOutline": palette.$GrayE2,\n    "InsightsSecondaryBkgCtl": palette.$White,\n    "InsightsSecondaryBkgCtlHover": palette.$GrayA,\n    "InsightsSecondaryBkgCtlPressed": palette.$GrayB,\n    "InsightsSecondaryTextCtl": palette.$GrayI,\n    "InsightsSecondaryTextCtlHover": palette.$GrayI,\n    "InsightsSecondaryTextCtlPressed": palette.$GrayI,\n    "InsightsSecondaryStrokeCtl": palette.$GrayD,\n    "InsightsSecondaryStrokeCtlHover": palette.$GrayD,\n    "InsightsSecondaryStrokeCtlPressed": palette.$GrayD,\n  ),\n) !default;\n\n// Themify mixin\n// Source: https://www.sitepoint.com/sass-theming-neverending-story/\n// Extended to allow overriding themes.\n@mixin themify($property, $key, $themes: $themes) {\n  @each $theme, $colors in $themes {\n    .theme-#{$theme} & {\n      #{$property}: map.get($colors, $key);\n    }\n  }\n}\n\n// Themify mixin for styles which apply when focus is visible.\n// .ms-Fabric--isFocusVisible and .theme-* class names are both on body element.\n// It does not work properly to use the mixin themify() in the way below.\n// .ms-Fabric--isFocusVisible &.ms-Button--default:focus::after {\n//      @include themify(\'border-color\', \'InsightsCardKeyboardStroke\');\n// }\n// because there will be a space between .theme-* and .ms-Fabric--isFocusVisible in generated css.\n// Please use this mixin to thimfy the style which applied when focus is visible.\n@mixin themifyForFocus($property, $key, $themes: $themes) {\n  @each $theme, $colors in $themes {\n    .theme-#{$theme}.ms-Fabric--isFocusVisible & {\n      #{$property}: map.get($colors, $key);\n    }\n  }\n}\n',"// Office Palette\n\n$White: #ffffff;\n$Gray110: #8a8886;\n$Gray130: #605e5c;\n$Gray140: #484644;\n$Gray160: #323130;\n$Gray18: #2e2e2e;\n$Gray20: #f3f2f1;\n$Gray30: #edebe9;\n$Gray40: #e1dfdd;\n$Gray60: #c8c6c4;\n$Gray94: #f0f0f0;\n$GrayA: #f3f3f3;\n$GrayB: #e6e6e6;\n$GrayC: #d2d2d2;\n$GrayC2: #c6c6c6;\n$GrayC3: #b1b1b1;\n$GrayD: #969696;\n$GrayD2: #808080;\n$GrayE: #737373;\n$GrayE2: #666666;\n$GrayF: #505050;\n$GrayG: #444444;\n$GrayH: #363636;\n$GrayI: #262626;\n$GrayJ: #0a0a0a;\n$GrayK: #4d4d4d;\n$Black: #000000;\n$Grey36: #5c5c5c;\n\n$HyperlinkA: #c5e9fe;\n$HyperlinkB: #79cdfe;\n$HyperlinkC: #56bdfc;\n$HyperlinkD: #23a6e8;\n\n$XL1: #e9f5ee;\n$XL2: #9fcdb3;\n$XL3: #6eb38a;\n$XL4: #4e9668;\n$XL5: #3f8159;\n$XL6: #217346;\n$XL7: #0e5c2f;\n$XL8: #004b1c;\n$XLPrimary: #107c41;\n\n// Insights Palette\n\n$insights-orange: #ed7d31;\n$insights-blue: #0000ff;\n$ErrorRed: #a80000;\n\n// XLO\n$xlo-headergray: #f5f5f5;\n",'@use "sass:color";\n@use "../abstracts/theming";\n@use "../abstracts/palette";\n@use "../abstracts/mixins";\n@use "../abstracts/variables";\n\n.recommendation-title {\n  font-size: 14px;\n  font-weight: 700;\n  line-height: 20px;\n  margin: 0;\n  vertical-align: top;\n  text-overflow: ellipsis;\n  overflow: hidden;\n\n  &__rich-text {\n    &__0 {\n      color: color.adjust($color: palette.$insights-orange, $lightness: -16%);\n    }\n    &__1 {\n      color: palette.$insights-blue;\n    }\n  }\n}\n\n.recommendation-subtitle {\n  color: palette.$Gray160;\n  font-size: 12px;\n  margin: 0;\n  padding: variables.$default-pt * 0.5 0 variables.$default-pt;\n  vertical-align: top;\n  @include mixins.overflow-wrap-break-word;\n}\n',".explanation-dropdown {\n  color: #107c41;\n  font-size: 12px;\n\n  &:hover {\n    color: #0f703b;\n  }\n  &:active {\n    color: #094624;\n  }\n  &:disabled {\n    color: #bdbdbd;\n  }\n\n  i {\n    color: inherit;\n  }\n}\n\n.explanation-content {\n  margin: 0px 8px;\n}\n",".column-recommendation {\n  .formula-description {\n    padding: 0;\n    box-sizing: border-box;\n\n    p {\n      all: inherit;\n    }\n  }\n}\n",".python-recommendation {\n  &__title {\n    font-weight: 600;\n    margin-top: 12px;\n    color: #242424;\n  }\n\n  .monaco-read-only {\n    width: auto;\n\n    .monaco-editor .cursors-layer > .cursor {\n      display: none !important;\n    }\n  }\n\n  .python-description {\n    margin: 8px 0px 0px;\n    padding: 0;\n    box-sizing: border-box;\n\n    p {\n      all: inherit;\n    }\n  }\n}\n",'@use "../abstracts/mixins";\n\n.recommendation__text-analysis__bullet-header {\n  font-weight: bold;\n}\n','@use "../abstracts/mixins";\n\n.AugloopDiganosticsPaneContainer {\n  overflow: auto;\n  padding-left: "2%";\n  margin: 0;\n  width: "96%";\n}\n\n.hideOverflow {\n  width: 90%;\n  text-overflow: ellipsis;\n}\n\n// ----------------------------------------\n// tree view styles\n\n.tree {\n  --spacing: 1rem;\n  --radius: 7px;\n  padding-left: 0;\n  padding-inline-start: 0;\n}\n\n.tree li {\n  display: block;\n  position: relative;\n  padding-inline-start: 0;\n  padding-left: calc(2 * var(--spacing) - var(--radius) - 2px);\n}\n\n.tree ul {\n  margin-left: calc(var(--radius) - var(--spacing));\n  padding-left: 0;\n  padding-inline-start: 0;\n}\n\n.tree ul li {\n  border-left: 2px solid #ddd;\n}\n\n.tree ul li:last-child {\n  border-color: transparent;\n}\n\n.tree ul li::before {\n  content: "";\n  display: block;\n  position: absolute;\n  top: calc(var(--spacing) / -2);\n  left: -2px;\n  width: calc(var(--spacing) + 2px);\n  height: calc(var(--spacing) + 1px);\n  border: solid #ddd;\n  border-width: 0 0 2px 2px;\n}\n\n.tree summary {\n  display: block;\n  cursor: pointer;\n}\n\n.tree summary::marker,\n.tree summary::-webkit-details-marker {\n  display: none;\n}\n\n.tree summary:focus {\n  outline: none;\n}\n\n.tree summary:focus-visible {\n  outline: 1px dotted #000;\n}\n\n.tree li::after,\n.tree summary::before {\n  content: "";\n  display: block;\n  position: absolute;\n  top: calc(var(--spacing) / 2 - var(--radius));\n  left: calc(var(--spacing) - var(--radius) - 1px);\n  width: calc(2 * var(--radius));\n  height: calc(2 * var(--radius));\n  border-radius: 50%;\n  background: #ddd;\n}\n\n.tree summary::before {\n  z-index: 1;\n  background: rgb(113, 150, 199) 0 0;\n}\n\n.tree details[open] > summary::before {\n  background-position: calc(-2 * var(--radius)) 0;\n}\n','@use "../abstracts/mixins";\n@use "../abstracts/variables";\n@use "preview-table";\n\n.text-analysis-tagging {\n  @include preview-table.preview-table;\n\n  &__no-headers {\n    padding: 0 4px;\n  }\n}\n'],sourceRoot:""}]);const l=i},341240:e=>{"use strict";var t=[];function n(e){for(var n=-1,a=0;a<t.length;a++)if(t[a].identifier===e){n=a;break}return n}function a(e,a){for(var r={},i=[],l=0;l<e.length;l++){var s=e[l],c=a.base?s[0]+a.base:s[0],d=r[c]||0,u="".concat(c," ").concat(d);r[c]=d+1;var m=n(u),g={css:s[1],media:s[2],sourceMap:s[3],supports:s[4],layer:s[5]};if(-1!==m)t[m].references++,t[m].updater(g);else{var h=o(g,a);a.byIndex=l,t.splice(l,0,{identifier:u,updater:h,references:1})}i.push(u)}return i}function o(e,t){var n=t.domAPI(t);n.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,o){var r=a(e=e||[],o=o||{});return function(e){e=e||[];for(var i=0;i<r.length;i++){var l=n(r[i]);t[l].references--}for(var s=a(e,o),c=0;c<r.length;c++){var d=n(r[c]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}r=s}}},342698:(e,t,n)=>{"use strict";n.d(t,{fB:()=>l,ps:()=>g,q3:()=>i,tJ:()=>r});var a=n(371120),o=n(581389);function r(e){return e.some((e=>"secondary"===e.valueAxisGroup))}function i(e){return!!r(e)&&e.some((e=>"line"===e.layout&&"primary"===e.valueAxisGroup))}function l(e,t){const n=(0,a.Q)(e,0,"categories"),o=!!n&&!!n.formatInfo&&n.formatInfo.isDateTime,r=!!n&&n.values.raw.every((e=>"number"==typeof e));if("values"===t.dimension&&i(e.series)&&o&&r){const n="primary"===t.axisGroup?"secondary":"primary";return e.axes.find((e=>e.dimensionType===t.dimension&&e.axisGroup===n))}return e.axes.find((e=>e.dimensionType===t.dimension&&e.axisGroup===t.axisGroup))}const s=10,c=1/6,d=.05,u=1.5,m=6;function g(e,t,n,a){const r=(0,o.r)(e,t,n);if(null===r)return null;const i=r.max-r.min;if(i<0)throw new Error("Invalid MinMax: max should not be less than min");if(0===i){if(0===r.min)return{minimum:0,maximum:1};r.min<0?r.max=0:r.min=0}let l=r.max,s=r.min;if(s>0||l<0){const e=s>0?l:Math.abs(s),t=l-s;t>e/m?s>0?s=0:l=0:s>0?s-=t/2:l+=t/2}const g=l-s,p=(1+d)*g,b=d*g,f=p*u;let C,y;const v=e=>{s=s-r.min+b>0?r.min-b:s;const t=h(e||-1*s);return Math.floor(s/t)*t},T=e=>{l=l-r.max-b<0?r.max+b:l;const t=h(e||l);return Math.ceil(l/t)*t};if(l>0&&s<0)C=v(p),y=T(p);else if(l>0){g<c*l&&!a?(C=v(f),y=T(f)):(C=0,y=T())}else if(s<0){g<-1*c*s&&!a?(C=v(f),y=T(f)):(C=v(),y=0)}return void 0!==C&&void 0!==y?{minimum:C,maximum:y}:null}function h(e){const t=[.1,.2,.5,1,2,5,10],{base:n,exponent:a}=function(e){if(e<0)throw new Error("Input number should be greater than or equal to 0");if(0===e)return{base:0,exponent:0};const t=Math.floor(Math.log10(e)),n=e/s**t;return{base:n,exponent:t}}(e);for(let e=t.length-1;e>1;--e)if(n>t[e]){return t[e-2]*s**a}return t[0]*s**a}},342935:(e,t,n)=>{"use strict";n.d(t,{CU:()=>h,Ej:()=>C,GC:()=>f,LM:()=>s,PX:()=>d,_c:()=>b,c3:()=>l,ch:()=>g,fB:()=>u,g8:()=>c,gD:()=>m,s6:()=>p});var a=n(446751),o=n(764080),r=n(347145),i=n(540084);function l(e){let t="",n=e;for(;n>0;){const e=n%26;0===e?(t+="Z",n=Math.floor(n/26)-1):(t=String.fromCharCode(e-1+"A".charCodeAt(0))+t,n=Math.floor(n/26))}return t}function s(e,t){return`${l(t)}${e}`}const c=(e,t)=>{if(!m(e,t))return!1;if((0,r.iPS)("Microsoft.Office.Excel.FA000000124.EnableDynamicPlanner",!1)&&y(e?.visual))return!1;if("TextAnalysisVisual"===e?.visual?.visualType){if(!(0,r.iPS)("Microsoft.Office.Excel.FA000000124.EnableTextAnalysisCitation",!1))return!1;if((0,r.iPS)("Microsoft.Office.Excel.FA000000124.EnableHideAddToSheetButton",!1)&&e?.visual?.textAnalysisResult?.analysisType===o.uK.Summary&&e?.visual?.textAnalysisResult?.resultType===o.rb.QuickSummary)return!1;const t=e?.visual?.textAnalysisResult?.bulletList?.some((e=>e.reference.length>0));if(!t)return!1}return!0},d=(e,t)=>{const n=e.map((e=>e.visualAnswer[0])).filter((e=>!!e&&c(e,t)));return n.some((e=>"TextAnalysisVisual"===e.visual?.visualType))&&n.length>=2?n:[]},u=e=>"TextAnalysisVisual"!==e?.visual?.visualType||!e?.visual?.textAnalysisResult?.bulletList,m=(e,t)=>t?.find((({id:t})=>t===e.interpretationId)),g=e=>{switch(e.visualType){case"PivotTableVisual":return e.pivotTable.pivotTableData&&0===e.pivotTable.pivotTableData.length;case"QueryResultVisual":return 0===e.result.fields.length||0===e.result.fields[0].values.raw.length;default:return!1}};function h(e){return e.calculatedFormulas.every((e=>e.formula))}function p(e,{columnIndex:t}){return(0,a.JM)(e).map((e=>(0,i.z)(t+e+1)))}function b(e,t){return(0,a.iM)(e)?f(e,t):(0,a.cY)(e)?p(e,t):[]}function f(e,{columnCount:t,columnIndex:n}){return e.calculatedFormulas.map(((e,a)=>{const o=(e.insertionIndex??t)+1+a;return(0,i.z)(n+o)}))}function C(e,t,n,a){return`${(0,i.z)(t+1)}${e+1}:${(0,i.z)(t+a)}${e+n}`}const y=e=>"QueryResultVisual"===e?.visualType&&!0===e?.isStagingTable},347145:(e,t,n)=>{"use strict";n.d(t,{$0$:()=>Oe,$Cf:()=>xa,$Xf:()=>Z,$bq:()=>aa,$ii:()=>ka,A9c:()=>j,AFi:()=>cn,AJD:()=>Ia,Ak0:()=>Ha,AmF:()=>Ga,Ap6:()=>Ke,At2:()=>rr,Awf:()=>L,B0c:()=>Ln,B8x:()=>Ge,BAK:()=>me,BCo:()=>co,BOx:()=>An,C6:()=>ya,CDX:()=>Rn,CGU:()=>ue,CLb:()=>un,CUx:()=>Qt,CpS:()=>lt,Cpg:()=>Ft,CyP:()=>Yo,DBC:()=>Ht,DBQ:()=>Ve,DDL:()=>K,DI8:()=>Da,DU1:()=>Y,Dl1:()=>k,DnQ:()=>Fa,DtK:()=>Gn,EJJ:()=>qe,EeR:()=>Je,F3m:()=>qt,FFf:()=>zt,FYS:()=>lo,FsT:()=>xo,Fz9:()=>oe,G7K:()=>Be,GBi:()=>ce,GIC:()=>we,GKX:()=>Xt,GpD:()=>pe,GqX:()=>He,H2A:()=>ke,H45:()=>on,HHv:()=>Tn,HSC:()=>q,H_5:()=>fe,H_b:()=>W,Hvn:()=>bo,I3H:()=>ln,ID5:()=>Ee,IQJ:()=>oo,IU1:()=>se,IdM:()=>na,IfU:()=>Pa,JMu:()=>st,JZX:()=>hn,J_:()=>ra,Jhm:()=>Et,Jqb:()=>pa,Jym:()=>ut,K$3:()=>Tt,K5:()=>Pt,K7T:()=>ee,KOx:()=>wa,KT8:()=>yn,KV_:()=>dt,KWs:()=>Sn,Kuk:()=>La,KxH:()=>so,L4b:()=>Ut,LKL:()=>Kn,LNg:()=>Bn,LSW:()=>Wn,LUs:()=>ro,L_n:()=>ze,LaH:()=>Ho,Lap:()=>R,LhK:()=>Me,LrR:()=>Rt,Lzg:()=>jt,MHS:()=>Gt,MNq:()=>dn,N6k:()=>z,NBG:()=>Lt,NT7:()=>_n,NbV:()=>Jo,O74:()=>_a,O8_:()=>On,OSh:()=>To,OUH:()=>lr,OWE:()=>ho,Oc9:()=>Ja,Om4:()=>Jn,Oo4:()=>Dn,P5X:()=>Ea,PiX:()=>tr,Pol:()=>la,PrP:()=>Qn,Pz_:()=>Dt,Q11:()=>kn,QI_:()=>ar,Qq4:()=>Ma,Qyj:()=>vt,R$m:()=>Pn,REo:()=>_,RNg:()=>De,SAS:()=>fo,SBS:()=>Ta,Sdn:()=>$o,Shf:()=>Q,Skv:()=>Cn,Slc:()=>Xn,T$f:()=>N,TGR:()=>Do,TS5:()=>ua,Te4:()=>ft,ThR:()=>za,Tlo:()=>Fo,Ton:()=>po,TyP:()=>O,U4g:()=>Wa,UBP:()=>ye,UDM:()=>$,UIZ:()=>_o,ULj:()=>U,UTV:()=>xn,UW0:()=>Ra,UaO:()=>Ye,UiV:()=>In,UjX:()=>fa,UxI:()=>P,VDk:()=>Hn,VKb:()=>ha,WFw:()=>xt,WIm:()=>gn,Wmj:()=>qn,Wo:()=>oa,Wp2:()=>Go,Wuj:()=>ia,XLK:()=>Wt,XPY:()=>uo,XXz:()=>Kt,Xfp:()=>Wo,Xsz:()=>Qe,Y$0:()=>ct,YAc:()=>vo,Z8j:()=>x,ZAR:()=>it,ZNg:()=>Ro,_7P:()=>go,_Ij:()=>qa,_NB:()=>ve,_SP:()=>St,_bw:()=>ae,_dF:()=>nt,_k_:()=>Oa,_mi:()=>xe,aC$:()=>Ot,aFB:()=>ko,aJZ:()=>Fn,afi:()=>ta,am:()=>Ko,avT:()=>I,b13:()=>ba,bdK:()=>rt,beW:()=>S,bx9:()=>ie,bzg:()=>sa,cGu:()=>et,cMx:()=>to,cTR:()=>gt,cjy:()=>Qo,cpQ:()=>io,cts:()=>Yn,cz7:()=>Mn,dA9:()=>Zn,dOo:()=>wn,ddP:()=>Na,de5:()=>Vt,dl3:()=>nn,dru:()=>yo,dw_:()=>rn,e7E:()=>Qa,eFk:()=>Ie,eHf:()=>jo,eOl:()=>eo,eUQ:()=>er,eh5:()=>Xa,etf:()=>ir,f7I:()=>nr,fFf:()=>Co,fnY:()=>te,g6K:()=>tt,g92:()=>Zt,gPg:()=>$t,gQ_:()=>bn,geU:()=>re,ggM:()=>We,gnD:()=>Ue,gr8:()=>V,hrE:()=>Un,i3k:()=>Aa,i9S:()=>No,iAi:()=>Ao,iPS:()=>T,iYf:()=>qo,iq2:()=>Xe,jEg:()=>Vo,jGm:()=>Nn,jHv:()=>mt,jI5:()=>Uo,jWB:()=>Ya,jjh:()=>ma,jxV:()=>zn,k64:()=>Se,kRR:()=>or,kh6:()=>En,kkU:()=>It,l6e:()=>tn,l9B:()=>Va,lCC:()=>E,lDp:()=>B,lJI:()=>Ca,lSN:()=>Mt,lYv:()=>Lo,lht:()=>Re,ljm:()=>At,mXJ:()=>Za,mdc:()=>ne,n7$:()=>mo,nmB:()=>Ze,o25:()=>$n,o2C:()=>Ne,o94:()=>wo,oJj:()=>H,oVT:()=>be,oaD:()=>pn,osS:()=>G,pBW:()=>an,pRQ:()=>Ce,pS6:()=>at,pv3:()=>jn,qJy:()=>kt,qMK:()=>Zo,qTy:()=>pt,qcw:()=>Po,qvj:()=>Io,rFv:()=>Oo,rY0:()=>fn,rbw:()=>Te,rpM:()=>no,s2L:()=>Jt,s9k:()=>en,sDe:()=>So,sK$:()=>zo,sSY:()=>Eo,sx$:()=>Ua,t9T:()=>de,tCt:()=>ea,tMD:()=>Fe,tO4:()=>Sa,tgf:()=>ht,thH:()=>bt,tmD:()=>mn,tsg:()=>ca,u5T:()=>Xo,uEU:()=>$a,uPA:()=>Bo,uPG:()=>ga,uY4:()=>Ba,usH:()=>w,uze:()=>je,v1l:()=>Le,v2n:()=>J,v5R:()=>Vn,vCb:()=>he,vEQ:()=>Pe,vIj:()=>D,vK$:()=>ge,vNc:()=>X,vPK:()=>da,vcx:()=>Ka,vom:()=>$e,vzv:()=>Bt,w9F:()=>_e,wBl:()=>wt,wOI:()=>Mo,wOV:()=>_t,wQA:()=>Nt,wpe:()=>ot,wyh:()=>le,xLF:()=>Ae,xZX:()=>sn,xtK:()=>Ct,xyg:()=>C,yjA:()=>va,yqt:()=>vn,yw9:()=>y,zd8:()=>Yt,zf$:()=>ja,zn0:()=>ao});var a=n(92520),o=n(749832),r=n(207545),i=n(241273),l=n(993821),s=n(650444),c=n(252163),d=n(652382),u=n(958252);const m={showDiscoverInsightsForShortQueries:{featureName:"Microsoft.Office.Excel.ShowDiscoverInsightsForShortQueries",defaultValue:!0},ConditionalFormattingConverter:{featureName:"Microsoft.Office.Excel.ConditionalFormattingConverter",defaultValue:!1},ExcelWorkflow:{featureName:"Microsoft.Office.Excel.ExcelWorkflow",defaultValue:!1},InsightsEndpointOverride:{featureName:"Microsoft.Office.Excel.InsightsEndpointOverride",defaultValue:""},CopilotUxRailsOverride:{featureName:"Microsoft.Office.Excel.CopilotUxRailsOverride",defaultValue:!0},CannedOdslDropdown:{featureName:"Microsoft.Office.Excel.CannedOdslDropdown",defaultValue:!1},CalculatedColumnsMaxRows:{featureName:"Microsoft.Office.Excel.CalculatedColumnsMaxRows",defaultValue:200},CalculatedColumnsMaxCells:{featureName:"Microsoft.Office.Excel.CalculatedColumnsMaxCells",defaultValue:2e3},CalculatedColumnsMaxPreviewRows:{featureName:"Microsoft.Office.Excel.CalculatedColumnsMaxPreviewRows",defaultValue:1024},AutofitSelectedRowsColumns:{featureName:"Microsoft.Office.Excel.AutofitSelectedRowsColumns",defaultValue:!0},NeverTimeout:{featureName:"Microsoft.Office.Excel.NeverTimeout",defaultValue:!1},CopilotInsertTable:{featureName:"Microsoft.Office.Excel.CopilotInsertTable",defaultValue:!1}},g="Microsoft.Office.SharedOnline.FA000000124.",h="Microsoft.Office.Shared.fa000000124.",p={AugLoopSessionClosedMessageCard:"OfficeVSO_8253114_AugLoopSessionClosedMessageCard",DefaultColorScales:"OfficeVSO_8317167_DefaultColorScales",CalculatedColumnsTLRSupport:"OfficeVSO_8329492_CalculatedColumnsTLRSupport"},b={showDiscoverInsightsForShortQueries:{featureName:"Microsoft.Office.Excel.FA000000124.ShowDiscoverInsightsForShortQueries",defaultValue:!0},enableForecasting:{featureName:"Microsoft.Office.Excel.FA000000124.EnableForecasting",defaultValue:!1},enableTextAnalysisCitation:{featureName:"Microsoft.Office.Excel.FA000000124.EnableTextAnalysisCitation",defaultValue:!1},enableQuickSummarization:{featureName:"Microsoft.Office.Excel.FA000000124.EnableQuickSummarization",defaultValue:!1},enableFullTheming:{featureName:"Microsoft.Office.Excel.FA000000124.EnableFullTheming",defaultValue:!1},enableHideAddToSheetButton:{featureName:"Microsoft.Office.Excel.FA000000124.EnableHideAddToSheetButton",defaultValue:!1},enableSentimentAnalysis:{featureName:"Microsoft.Office.Excel.FA000000124.EnableSentimentAnalysis",defaultValue:!1},useMetadataV2:{featureName:"Microsoft.Office.Excel.FA000000124.UseMetadataV2",defaultValue:!1},enableAdvancedTextAnalysis:{featureName:"Microsoft.Office.Excel.FA000000124.EnableAdvancedTextAnalysis",defaultValue:!1},enableDynamicPlanner:{featureName:"Microsoft.Office.Excel.FA000000124.EnableDynamicPlanner",defaultValue:!1},enableGPT4o20241120Model:{featureName:"Microsoft.Office.Excel.FA000000124.EnableGPT4o20241120Model",defaultValue:!1},useMetadataAML:{featureName:"Microsoft.Office.Excel.FA000000124.UseMetadataAML",defaultValue:!1},enableTextAnalysisSuggestionPill:{featureName:"Microsoft.Office.Excel.FA000000124.EnableTextAnalysisSuggestionPill",defaultValue:!1},useLLMFormula:{featureName:"Microsoft.Office.Excel.FA000000124.UseLLMFormula",defaultValue:!1}},f="Microsoft.Office.Excel.FA000000124.";function C(e){const{featureName:t,defaultValue:n}=m[e];if(u.N)switch(typeof n){case"boolean":return!0;case"string":return"";case"number":return 0;default:throw new Error("Flighting type must be a string, boolean, or integer")}const a=t.split(".").pop(),o=`${f}${a}`;switch(typeof n){case"boolean":return T(o,n);case"string":return S(o,n);case"number":return x(o,n);default:throw new Error("Flighting type must be a string, boolean, or integer")}}function y(e){return/^OfficeVSO_\d+_/.test(e)?T(`${f}${e}`,!0):T(`${f}${p[e]}`,!0)}function v(e,t=!1){return OfficeRuntime.experimentation.getBooleanFeatureGate(g+e,t)||OfficeRuntime.experimentation.getBooleanFeatureGate(h+e,t)}function T(e,t){return OfficeRuntime.experimentation.getBooleanFeatureGate(e,t)}function x(e,t){return OfficeRuntime.experimentation.getIntFeatureGate(e,t)}function S(e,t){return OfficeRuntime.experimentation.getStringFeatureGate(e,t)}function w(){return((0,r.I_)()||(0,r.B2)())&&(T("Microsoft.Office.Excel.FA000000124.EnableTestUi",!1)||T("Microsoft.Office.Excel.FA000000124.EnableUsingFluxSkillsDirectly",!1))}function E(){const e=Object.fromEntries(Object.entries(b).map((([e,t])=>{const{defaultValue:n,featureName:a}=t;switch(typeof n){case"boolean":return[e,T(a,n)];case"number":return[e,x(a,n)];case"string":return[e,S(a,n)];default:(0,s.x)(n)}})));return e.enableGPT4o20241120Model=function(){const e=o.V.getSettingAsString(o.z.InsightsEndpoint);return!("Insights.Https.GCC.Bundle"===e||"Insights.Https.DOD.Bundle"===e||"Insights.Https.GCCH.Bundle"===e)}(),function(e){const t=Microsoft.Office.WebExtension.FeatureGates;Object.keys(t).filter((e=>e.toLowerCase().startsWith("microsoft.office.excel.fa000000124.insights."))).forEach((n=>{const a=n.split(".").pop(),o=t[n];"true"===o.toLowerCase()||"false"===o.toLowerCase()?e[a]="true"===o.toLowerCase():isNaN(Number(o))?e[a]=o:e[a]=Number(o)}))}(e),e.enableLLMChartReco=!0,JSON.stringify(e)}const I=()=>!u.N&&"true"===(0,c.P)("CopilotSaveAutomation"),R=()=>!u.N&&"true"===(0,c.P)("CopilotPAIntegration");let A;const L=e=>{A=e},k=()=>A?A===i.ut.Enterprise:((0,a.cY)(a.SA.Warning,"isUserTypeOrganization: userType is not defined. Returning false."),!1),F=()=>A?A===i.ut.Consumer:((0,a.cY)(a.SA.Warning,"isUserTypeConsumer: userType is not defined. Returning false."),!1);function _(){return k()&&!(0,r.TB)()}function P(){return T("Microsoft.Office.Excel.FA000000124.AddinLocalPluginActionsEnabled",!1)}const N=()=>!1;function M(){return y("OfficeVSO_8910862_IsGroundingPhase2UxEnabled")}function O(){return M()&&y("OfficeVSO_8910862_isUserTypeCheckEnabled")}function D(){return M()&&k()||F()&&y("OfficeVSO_8910862_IsGroundingPhase2UxEnabledForConsumer")}function B(){return T("Microsoft.Office.Excel.FA000000124.IsEnableAppGptsInCIQ",!1)&&J()&&k()}function $(){return D()&&!(0,d.dD)()&&T("Microsoft.Office.Excel.FA000000124.ImportDataEnabledForSearch",!1)}function H(){return T("Microsoft.Office.Excel.FA000000124.EnableEnterpriseToggleInPhase2Ux",!1)}function U(){return T("Microsoft.Office.Excel.FA000000124.EnterpriseToggleInPhase2UxHiddenAndDisabled",!1)}function q(){return y("OfficeVSO_8910862_IsEnterpriseSearchDefaultOn")}function V(){return y("OfficeVSO_8910862_IsWebSearchDefaultOn")}function W(){return M()&&k()&&T("Microsoft.Office.Excel.FA000000124.IsCIQEnabled",!1)}function G(){return T("Microsoft.Office.Excel.FA000000124.IsCiqEnabledInDAs",!1)}function z(){return T("Microsoft.Office.Excel.FA000000124.CIQAttachmentList",!1)}function Q(){return W()&&T("Microsoft.Office.Excel.FA000000124.IsCloudFileUploadEnabled",!1)}function j(){return W()&&T("Microsoft.Office.Excel.FA000000124.IsLocalFileUploadEnabled",!1)}function J(){return T("Microsoft.Office.Excel.FA000000124.IsEnableAppGptsInCIQ",!1)}function Y(){return T("Microsoft.Office.Excel.FA000000124.IsEnableAppPluginsInCIQ",!1)}function X(){return T("Microsoft.Office.Excel.FA000000124.IsEnableAppMsgExtInCIQ",!1)}function Z(){return T("Microsoft.Office.Excel.FA000000124.IsEnableAppPPInCIQ",!1)}function K(){return T("Microsoft.Office.Excel.FA000000124.IsEnableAppTypeBInCIQ",!1)}function ee(){return T("Microsoft.Office.Excel.FA000000124.IsEnableTopicECC",!1)}function te(){return W()&&T("Microsoft.Office.Excel.FA000000124.EnablePluginSearchInFlyout",!1)}function ne(){return W()&&T("Microsoft.Office.Excel.FA000000124.EnableMorePluginHyperLinkInFlyout",!1)}function ae(){return M()&&"OfficeFirstParty"in window&&"Sensitivity"in OfficeFirstParty}function oe(){return y("OfficeVSO_9988652_IsAgentsLoggingEnabledInShared")}const re=()=>T("Microsoft.Office.Excel.FA000000124.AugLoop.OfficeJsCommanding",!1),ie=()=>T("Microsoft.Office.Excel.FA000000124.AugLoop.ChartContextJsonDOM",!1),le=()=>S("Microsoft.Office.Excel.FA000000124.ForceOfficeJsCommandingSkill",""),se=()=>T("Microsoft.Office.Excel.FA000000124.AugLoop.CommandingScratchpad",!1),ce=()=>T("Microsoft.Office.Excel.FA000000124.AugLoop.ScratchpadPassiveTesting",!1),de=()=>T("Microsoft.Office.Excel.FA000000124.AugLoop.EnableScratchpadInExcelAgent",!1),ue=()=>!(0,d.dD)(),me=()=>T("Microsoft.Office.Excel.FA000000124.showUndoButton",!0),ge=()=>T("Microsoft.Office.Excel.FA000000124.IsTierTwoLocalizationEnabled",!1),he=()=>T("Microsoft.Office.Excel.FA000000124.IsTierTwoRTLLocalizationEnabled",!1),pe=()=>T("Microsoft.Office.Excel.FA000000124.IsTierTwoPointFiveLocalizationEnabled",!1),be=()=>T("Microsoft.Office.Excel.FA000000124.IsTierThreeLocalizationEnabled",!1),fe=()=>y("OfficeVSO_9680114_LoadStringsEarly"),Ce=()=>y("OfficeVSO_8996286_reenablingRehydration"),ye=()=>y("OfficeVSO_9043928_AlwaysSendCellsToCCSignal"),ve=()=>T("Microsoft.Office.Excel.FA000000124.AugLoop.CFResponseCardShowFormulaExplanation",!1),Te=()=>T("Microsoft.Office.Excel.FA000000124.doNotResolveTableForHybridCCEnabled",!1),xe=()=>y("OfficeVSO_9117932_calculatedColumnsUseTablesFromSignal"),Se=()=>y("OfficeVSO_9473972_OdslCommandingHumanInTheLoop"),we=()=>y("OfficeVSO_9473973_ConditionalFormattingResponseCardWithSample"),Ee=()=>y("OfficeVSO_9473975_ConditionalFormattingCustomFormula"),Ie=()=>T("Microsoft.Office.Excel.FA000000124.AugLoop.DataShaping",!1),Re=()=>T("Microsoft.Office.Excel.FA000000124.AugLoop.DataShapingAgent",!1),Ae=()=>T("Microsoft.Office.Excel.FA000000124.AugLoop.FormulaRepairExplainContext",!1),Le=()=>T("Microsoft.Office.Excel.FA000000124.SelfHelpSearchRenderingEnabled",!1),ke=()=>F()&&T("Microsoft.Office.Excel.FA000000124.AugLoop.EnablePythonAaForConsumers",!1)||T("Microsoft.Office.Excel.FA000000124.PythonAdaInCopilot",!1),Fe=()=>T("Microsoft.Office.Excel.FA000000124.AugLoop.EnablePythonInteractiveCharts",!1),_e=()=>T("Microsoft.Office.Excel.FA000000124.EnablePythonManualPrompt",!1),Pe=()=>!Ne()&&T("Microsoft.Office.Excel.FA000000124.IsPython30SecondsWave1",!1),Ne=()=>T("Microsoft.Office.Excel.FA000000124.IsPython30SecondsWave2",!1),Me=()=>T("Microsoft.Office.Excel.FA000000124.PythonAAAddScrollingFreeze",!1),Oe=()=>T("Microsoft.Office.Excel.FA000000124.AugLoop.PythonAdaInExcelOnline",!1),De=()=>T("Microsoft.Office.Excel.FA000000124.AugLoop.PythonAASuggestionState",!1),Be=()=>T("Microsoft.Office.Excel.FA000000124.AugLoop.PythonAdaInMac",!1),$e=()=>T("Microsoft.Office.Excel.FA000000124.PythonCalculatedColumns",!1),He=()=>T("Microsoft.Office.Excel.FA000000124.PythonEditInPlace",!1),Ue=()=>T("Microsoft.Office.Excel.FA000000124.AugLoop.PythonAdaO1AsPlanner",!1),qe=()=>T("Microsoft.Office.Excel.FA000000124.AugLoop.ModelessPythonAAFallback",!1),Ve=()=>T("Microsoft.Office.Excel.FA000000124.AugLoop.ModelessPythonAAInsert",!1),We=()=>T("Microsoft.Office.Excel.FA000000124.AugLoop.ModelessPythonAAZQM",!1),Ge=()=>We(),ze=()=>T("Microsoft.Office.Excel.FA000000124.AugLoop.EnablePythonStatusResponseChunk",!1),Qe=()=>T("Microsoft.Office.Excel.FA000000124.EnablePythonStatusResponseChunkShowMessage",!1);function je(){return T("Microsoft.Office.Excel.FA000000124.OtherPythonAACellsOptimization",!1)}const Je=()=>T("Microsoft.Office.Excel.FA000000124.PythonAnalysisSheetMetadataEnabled",!1),Ye=()=>T("Microsoft.Office.Excel.FA000000124.AugLoop.PythonLosslessChatHistoryConversion",!0),Xe=()=>T("Microsoft.Office.Excel.FA000000124.PythonAAStartAnalysisButtonGreenExperiment",!1);function Ze(){return qe()&&T("Microsoft.Office.Excel.FA000000124.AugLoop.AnalyzeDataFallbackToPython",!1)}function Ke(){return T("Microsoft.Office.Excel.FA000000124.ConnectOfficePySvcToExecutePythonCode",!1)}function et(){return T("Microsoft.Office.Excel.FA000000124.PythonRemoveInsertToDetailSheetButtonEnabled",!1)}const tt=()=>T("Microsoft.Office.Excel.FA000000124.AugLoop.EnablePythonInteractiveChartsMaa",!1),nt=()=>T("Microsoft.Office.Excel.FA000000124.AugLoop.IsMAAOutputMetadataFormatEnabled",!1),at=()=>{const e=T("Microsoft.Office.Excel.FA000000124.AugLoop.IsDiceBerryForMAAEnabled",!1),t=y(" OfficeVSO_10354151_FormatDiceberryOutput_ChangeGate"),n=T("Microsoft.Office.Excel.FA000000124.AugLoop.ModelessPythonAA",!1);return(qe()||n)&&e&&t},ot=()=>qe()&&y("OfficeVSO_10356778_AddAnswersZQM");function rt(){const e={IsPythonAdaInCopilotEnabled:ke(),IsPythonManualPromptEnabled:_e(),IsPython30SecondsWave1:Pe(),IsPython30SecondsWave2:Ne(),IsAddScrollingFreezeEnabled:Me(),IsPythonAdaInExcelOnlineEnabled:Oe(),IsPythonAASuggestionStateEnabled:De(),IsPythonAdaInMacEnabled:Be(),IsPythonAdaO1AsPlannerEnabled:Ue(),IsPythonInteractiveChartEnabled:Fe(),IsPythonEditInPlaceEnabled:He(),IsModelessPythonAAFallbackFlightEnabled:qe(),IsPythonAAStartAnalysisButtonGreenExperimentEnabled:Xe(),IsAnalyzeDataFallbackToPythonEnabled:Ze(),IsConnectOfficePySvcToExecutePythonCodeEnabled:Ke(),IsPythonRemoveInsertToDetailSheetButtonEnabled:et(),isModelessPythonAAInsertFlightEnabled:Ve(),isOtherPythonCellsOptimizationEnabled:je(),IsPythonAnalysisSheetMetadataEnabled:Je(),isPythonInteractiveChartsEnabledMaa:tt(),isModelessPythonAAZQMEnabled:We(),isMAAOutputMetadataFormatEnabled:nt(),isModelessPythonAADiceBerryEnabled:at()};return JSON.stringify(e)}const it=()=>ht()&&T("Microsoft.Office.Excel.FA000000124.AugLoop.TableFreeCopilot",!1),lt=()=>it(),st=()=>it(),ct=()=>T("Microsoft.Office.Excel.FA000000124.AugLoop.Copilot.WholeWorkbookContext",!1),dt=()=>T("Microsoft.Office.Excel.FA000000124.AugLoop.Copilot.ExcelAgent",!1),ut=()=>T("Microsoft.Office.Excel.FA000000124.AugLoop.CatalystExcelAgentDirectJS",!1),mt=()=>T("Microsoft.Office.Excel.FA000000124.DevDiagButton",!1),gt=()=>y("OfficeVSO_9412591_telemetryDevButton")&&(0,r.I_)(),ht=()=>y("OfficeVSO_9694412_CleanUpTLRImprovementsGate")||T("Microsoft.Office.Excel.FA000000124.AugLoop.TLRImprovements",!1),pt=()=>y("OfficeVSO_9796513_CleanUpTLRAutoFixGate")||T("Microsoft.Office.Excel.FA000000124.TLRAutoFix",!1),bt=()=>y("OfficeVSO_9876590_SendAugLoopErrorAnnotationWithChatResponse");function ft(e,t){return yt(e,t)}function Ct(e,t){return yt(e,t)}function yt(e,t){const n=S(e,JSON.stringify(t));try{return JSON.parse(n)}catch(e){return t}}function vt(){return y("OfficeVSO_9231431_ElseZQM")}const Tt=()=>k()||T("Microsoft.Office.Excel.FA000000124.isChatHistoryV2EnabledForConsumer",!1)&&F(),xt=()=>y("OfficeVSO_9489189_xlCopilotAppChatHandoff");function St(){return T("Microsoft.Office.Excel.FA000000124.isReviewerAgentEnabled",!1)}function wt(){return St()&&T("Microsoft.Office.Excel.FA000000124.isReviewerAgentToggleEnabled",!1)}function Et(){return y("OfficeVSO_9845131_FormulaSuggestionsInvalidation")}function It(){return T("Microsoft.Office.Excel.FA000000124.IsMsgExtEnabled",!1)&&k()}function Rt(){return y("OfficeVSO_9298835_SeparateLocaleInfoFromSelection")}const At=()=>T("Microsoft.Office.Excel.FA000000124.IsImageInputEnabled",!1),Lt=()=>T("Microsoft.Office.Excel.FA000000124.IsPasteFromClipboardButtonEnabled",!1);function kt(){return T("Microsoft.Office.Excel.FA000000124.IsZQMEarlyLoadAndSessionStorageForChatHistoryEnabled",!1)}function Ft(){return T("Microsoft.Office.Excel.FA000000124.enableProactiveZQMWith3SAPISuggestions",!1)}function _t(){return T("Microsoft.Office.Excel.FA000000124.enableProactiveZQMWithSuggestedQnA",!1)}function Pt(){return T("Microsoft.Office.Excel.FA000000124.disableALAnnotationsOnPreload",!1)}function Nt(){return T("Microsoft.Office.Excel.FA000000124.isRenderOnPreloadEnabled",!0)}function Mt(){return T("Microsoft.Office.Excel.FA000000124.isPrefetchOnPreloadEnabled",!1)}function Ot(){return T("Microsoft.Office.Excel.FA000000124.CopilotSharedHeader",!1)}function Dt(){return T("Microsoft.Office.Excel.FA000000124.IsCustomGPTsEnabled",!1)&&k()}function Bt(){return T("Microsoft.Office.Excel.FA000000124.IsSccReadAloudAugloopEnabled",!0)}function $t(){if(!(0,r.I_)()&&!(0,r.B2)()&&!(0,r.xC)())return!1;return!!T("Microsoft.Office.Excel.FA000000124.IsSccReadAloudEnabled",!0)&&(k()||Bt())}function Ht(){return T("Microsoft.Office.Excel.FA000000124.IsAddButtonToLeftEnabled",!1)}function Ut(){return T("Microsoft.Office.Excel.FA000000124.IsAppChatGlowUXEnabled",!1)}function qt(){return T("Microsoft.Office.Excel.FA000000124.IsNewAttachmentListUiEnabled",!1)}function Vt(){return(v("EnableM365CopilotChatStarter",!1)||v("EnableM365CopilotChat",!1)||ua())&&v("IsAppChatRebrandingEnabled",!1)}function Wt(){return T("Microsoft.Office.Excel.FA000000124.IsUXRefreshEnabledForInput",!1)}function Gt(){return T("Microsoft.Office.Excel.FA000000124.ShowWelcomeExperience",!1)}function zt(){return T("Microsoft.Office.Excel.FA000000124.EnableQueryEndOnGptSwitch",!1)&&k()}function Qt(){return T("Microsoft.Office.Excel.FA000000124.IsNewChatOnGPTItemsEnabled",!1)&&k()}function jt(){return T("Microsoft.Office.Excel.FA000000124.IsNewChatOnCopilotGPTItemEnabled",!1)&&k()}function Jt(){return T("Microsoft.Office.Excel.FA000000124.IsViewMorePromptsIconV2Enabled",!1)}function Yt(){return T("Microsoft.Office.Excel.FA000000124.IsViewMorePromptsOneClickEnabled",!0)}function Xt(){return T("Microsoft.Office.Excel.FA000000124.RotatingZQM",!1)}function Zt(){return T("Microsoft.Office.Excel.FA000000124.EnableCIQGlowUpVisualRefresh",!1)}function Kt(){return T("Microsoft.Office.Excel.FA000000124.IsChatHistoryOnSwitcherMenuEnabled",!1)}function en(){return T("Microsoft.Office.Excel.FA000000124.IsSettingsPanelOnSwitcherMenuEnabled",!1)}function tn(){return y("OfficeVSO_3557215_IsApiPluginsCardsEnabled")}function nn(){return y("OfficeVSO_9446244_IsFluentV9TaskPaneTabBehaviorEnabled")}function an(){return T("Microsoft.Office.Excel.FA000000124.IsSavePromptEnabled",!1)}function on(){return T("Microsoft.Office.Excel.FA000000124.IsSharePromptEnabled",!1)}function rn(){return y("OfficeVSO_3557154_EnableInterstitialConfirmation")}function ln(){return y("OfficeVSO_3557154_EnableInterstitialAuthentication")}function sn(){return y("OfficeVSO_3557154_ShouldUseMsalGetTokenRequestCaching")}function cn(){return y("OfficeVSO_3557154_LoadGptListOnCopilotIconClick")}function dn(){return y("OfficeVSO_3557154_IsDAOutputV2Enabled")}function un(){return y("OfficeVSO_3557154_IsDACopilotBrandingEnabled")}function mn(){return y("OfficeVSO_3557417_RenameToAgentsEnabled")}function gn(){return y("OfficeVSO_3557417_DisableClientConfigQueryCharacterForEditorService")}function hn(){return T("Microsoft.Office.Excel.FA000000124.IsTableLikeRangeProgressEnabled",!1)}function pn(){return T("Microsoft.Office.Excel.FA000000124.IsHandoffButtonEnabled",!1)}function bn(){return y("OfficeVSO_10105240_IsHandoffRTLEnabled")}function fn(){return e="Microsoft.Office.Excel.FA000000124.OpenInWordMinimumForHeuristic",t=5,OfficeRuntime.experimentation.getIntFeatureGate(e,t);var e,t}function Cn(){return T("Microsoft.Office.Excel.FA000000124.IsHandoffBookendingEnabled",!1)}function yn(){return y("OfficeVSO_10082702_AppValueChecksForBookending")}function vn(){return T("Microsoft.Office.Excel.FA000000124.RenderChatHistoryInHandoffDestination",!1)}function Tn(){return T("Microsoft.Office.Excel.FA000000124.IsHandoffLoadingPageEnabled",!1)}function xn(){return T("Microsoft.Office.Excel.FA000000124.isALHookEnabled",!1)}function Sn(){return T("Microsoft.Office.Excel.FA000000124.IsHandoffGetAnnotationsEnabled",!1)}function wn(){return T("Microsoft.Office.Excel.FA000000124.IsHandoffInteractiveSummaryAndContentCallbackEnabled",!1)}function En(){return S("Microsoft.Office.Excel.FA000000124.LaunchThisVersionOfSDX","")}function In(){return y("OfficeVSO_9623025_ClearLoadingMessagesOnHandleSubmit")}const Rn=()=>T("Microsoft.Office.Excel.FA000000124.DisableFooterActionsForAdaptiveCard",!1);function An(){return y("OfficeVSO_9628072_GenerateVisibleRow")}const Ln=()=>T("Microsoft.Office.Excel.FA000000124.ShowAgentMenuNudgeAndTooltip",!1),kn=()=>T("Microsoft.Office.Excel.FA000000124.ShowAgentMenuExploreBadge",!0);function Fn(){return T("Microsoft.Office.Excel.FA000000124.IsCitationSupportForAvalonEnabled",!1)&&k()}function _n(){return T("Microsoft.Office.Excel.FA000000124.IsALRequestResponseEnabled",!1)}const Pn=()=>T("Microsoft.Office.Excel.FA000000124.TipCardConstantForDisabledScreen",!1);function Nn(){return T("Microsoft.Office.Excel.FA000000124.ChartStylesRecommendation",!1)}function Mn(){return T("Microsoft.Office.Excel.FA000000124.isTextDirectionEnabled",!1)}function On(){return T("Microsoft.Office.Excel.FA000000124.IsUploadImageFromPhoneEnabled",!1)}function Dn(){return S("Microsoft.Office.Excel.FA000000124.ImageUploadEndpoint","")}function Bn(){return T("Microsoft.Office.Excel.FA000000124.EnableSystemMessageActions",!1)&&k()}function $n(){return y("OfficeVSO_10172346_enableSwitcherMenuV2")}function Hn(){return T("Microsoft.Office.Excel.FA000000124.EnableAgentsBasedOnSkill",!1)}function Un(){return T("Microsoft.Office.Excel.FA000000124.EnableAgentWithBizChatProfileType",!1)}function qn(){return T("Microsoft.Office.Excel.FA000000124.EnableAgentsWithFluxV3",!1)}function Vn(){return T("Microsoft.Office.Excel.FA000000124.EnableMultiAccessDisablementCheck",!1)}function Wn(){return y("OfficeVSO_9623025_IsCodeInterpreterEnabled")}function Gn(){return T("Microsoft.Office.Excel.FA000000124.IsCodeInterpreterEnabledForDefaultCopilot",!1)}function zn(){return y("OfficeVSO_9623025_IsCodePreviewEnabled")&&Wn()}function Qn(){return T("Microsoft.Office.Excel.FA000000124.EnableLocalCUAAgent",!1)}function jn(){return y("OfficeVSO_10172346_IsEnableAppAgentsInCiqOverride")}const Jn=()=>y("OfficeVSO_9473972_IsDABrandingRefactorEnabled");function Yn(){return T("Microsoft.Office.Excel.FA000000124.IsClickButtonStyleHamburgerEnabled",!1)}function Xn(){return T("Microsoft.Office.Excel.FA000000124.showPromptSuggestionsWithOutput",!1)}function Zn(){return T("Microsoft.Office.Excel.FA000000124.IsRichAPIForAcquirePluginsEnabled",!1)&&Office.context.requirements.isSetSupported("unifiedstoreservice","1.1")}function Kn(){return Zn()?x("Microsoft.Office.Excel.FA000000124.DelayTimeForAgentSwitch",2e3):0}function ea(){return Zn()?x("Microsoft.Office.Excel.FA000000124.MosAgentInstallTimeout",7e3):0}function ta(){return y("OfficeVSO_9623025_EnableSwitchToAgentPostLoad")&&Zn()}function na(){return Xn()&&T("Microsoft.Office.Excel.FA000000124.DisableSuggestionPromptsWithZeroQueryInteraction",!1)}function aa(){return T("Microsoft.Office.Excel.FA000000124.EnableStopGeneratingButtonInChatInput",!1)}function oa(){return y("OfficeVSO_9987285_UseResponsiveSystemMessage")}const ra=()=>T("Microsoft.Office.Excel.FA000000124.IsTierFourLocalizationEnabled",!1);function ia(){return T("Microsoft.Office.Excel.FA000000124.isResponseDoubleBrandingHidden",!1)}function la(){return T("Microsoft.Office.Excel.FA000000124.IsLatencyArrowEnabled",!1)}function sa(){return x("Microsoft.Office.Excel.FA000000124.MaxDocumentSearchPivotTableCount",250)}function ca(){return x("Microsoft.Office.Excel.FA000000124.MaxDocumentSearchChartCount",500)}function da(){return k()&&T("Microsoft.Office.Excel.FA000000124.EnableBizChat",!1)}function ua(){return T("Microsoft.Office.Excel.FA000000124.EnableBizChatInAppChat",!1)}function ma(){return y("OfficeVSO_10250099_EnableBizChatAgentsInAppChat")}function ga(){return T("Microsoft.Office.Excel.FA000000124.EnableImplicitContextForBizChatInAppChat",!1)}function ha(){return T(f+"EnableCatalystContextualPrompts",!1)}function pa(){return S(f+"M365ChatCdnVersion","")}function ba(){return S(f+"M365ChatDeploymentRing","")}function fa(){return S(f+"M365ChatDeploymentEnvironment","")}function Ca(){return T(f+"EnableM365EcsProvidedProps",!1)}function ya(){return T(f+"UseM365ChatAppVersionEcsProject",!1)}function va(){return y("OfficeVSO_10250099_EnableBizInAppChatScenarioName")}function Ta(){return T("Microsoft.Office.Excel.FA000000124.IsSafeLinksEnabled",!1)}function xa(){return T("Microsoft.Office.Excel.FA000000124.EnableBizChatInAppAuthDialog",!0)}function Sa(){return T("Microsoft.Office.Excel.FA000000124.EnableM365ChatLogger",!0)}function wa(){return T("Microsoft.Office.Excel.FA000000124.EnableBizchatInAppPerfMonitor",!1)}function Ea(){return T("Microsoft.Office.Excel.FA000000124.EnableBizChatHideShimmerMessageEvent",!0)}function Ia(){return T(f+"EnableBizchatNestedAppAuthSupport",!0)}function Ra(){return T(f+"EnableBizchatHostContext",!0)}function Aa(){return T(f+"EnableM365ChatEligibilityCheck",!0)}function La(){return T(f+"EnableM365ChatEligibilityCache",!0)}function ka(){return T(f+"EnableBizChatFeedbackCompliancePolicyFetching",!0)}function Fa(){return T(f+"EnableBizChatDefaultFeedbackAppId",!0)}function _a(){return y("OfficeVSO_10271447_EnableOcpsPolicyFetching")}function Pa(){return T(f+"EnableBizChatInAppSettings",!1)}function Na(){return T(f+"EnableBizChatOtelLogger",!0)}function Ma(){return T(f+"EnableBizChatInteractiveApiOnTtfr",!0)}function Oa(){return y("OfficeVSO_10293336_EnableLocalFileMessageBanner")}function Da(){return y("OfficeVSO_10293342_EnableFileAccessMessageBanner")}function Ba(){return y("OfficeVSO_10261209_ChatExperienceSwitch")}function $a(){return T(f+"EnableBizChatIdsInOtelLog",!0)}function Ha(){return T(f+"EnableBizChatPerfOtelLog",!0)}function Ua(){return T(f+"EnableWaitForM365ChatEcsSettings",!0)}function qa(){return T(f+"EnableM365ChatRehydration",!0)}function Va(){return x(f+"M365ChatEcsSettingTimeout",2e3)}function Wa(){return T(f+"EnableIsEuCheck",!0)}function Ga(){return S(f+"HrdServiceProviderId","174")}function za(){return T(f+"EnableBizChatInAppAuthDialogV2",!0)}function Qa(){return T(f+"EnableKeepAliveForALSessionV2",!1)}function ja(){return x(f+"KeepAliveForALSessionIntervalInSecond",60)}function Ja(){return T("Microsoft.Office.Excel.FA000000124.EnableSPOFileIdForCloudFiles",!1)}function Ya(){return T("Microsoft.Office.Excel.FA000000124.IsPerfImprovementBizChatEnabled",!1)}function Xa(){return T(f+"EnableOcpsLogging",!0)}function Za(){return T(f+"EnableEligibilityTelemetry",!0)}function Ka(){return T(f+"ForceDfSydney",!1)}function eo(){return T(f+"IsInsertImageEnabledForDesignerInCatalyst",!1)}function to(){return T(f+"EnableBizChatAuthTelemetry",!0)}function no(){return T(f+"EnableNullCheckBizChatHostContext",!0)}function ao(){return T(f+"EnableBizChatInfiniteAuthShimmerFix",!0)}function oo(){return T(f+"EnableBizChatPuidCompliantCheck",!0)}function ro(){return y("OfficeVSO_10315251_EnableFetchImplicitQueryAnnotations")}function io(){return T(f+"EnableEcsSettingWaitOnExpiredCache",!0)}function lo(){return T(f+"EnableBizChatRingSwitcher",!1)}function so(){return T(f+"EnableBizChatInactiveLog",!0)}function co(){return T("Microsoft.Office.Excel.FA000000124.IsSafeLinksNonLegacyUrlEnabled",!1)}function uo(){return T(f+"EnableBizChatPairwiseBrokerSupport",!1)}function mo(){return x(f+"M365ChatPairwiseBrokerHandshakeTimeout",5e3)}function go(){return y("OfficeVSO_10267314_EnableAccessibilityContrastColorTheme")}function ho(){return T(f+"EnableBizchatEcsSettingsTelemetry",!0)}function po(){return T(f+"EnableIsDevLog",!0)}function bo(){return T(f+"EnableM365AuthLiveUrlHandling",!0)}function fo(){return T(f+"EnableM365ChatWaitForBroker",!0)}function Co(){return T(f+"EnableM365ChatTokenPrefetch",!0)}function yo(){return T(f+"EnableM365ChatHandleAuthBackgroundVisibility",!0)}function vo(){return T(f+"EnableM365ChatHandleBackgroundVisibilityForRequests",!0)}function To(){return x(f+"M365ChatPairwiseBrokerConnectionTimeout",3e3)}function xo(){return T(f+"EnableM365ChatTrustedDomainForPairwise",!0)}function So(){return T(f+"EnableM365ChatReuseSameRedirectUriForNaa",!0)}function wo(){return T(f+"IsHandoffToBizChatEnabled",!0)}function Eo(){return T(f+"HandoffPrivateApiEnabled",!1)&&k()&&((0,l.gt)()||da()||ua())&&T(f+"HandoffALBridgeEnabled",!0)}function Io(){return T(f+"EnableBizchatHostContext",!0)}function Ro(){return T(f+"FallbackHandoffsToAppChat",!1)}function Ao(){return T(f+"ShouldCheckUserLicense",!1)}function Lo(){return T(f+"ShouldDefaultToBizChat",!0)}function ko(){return T(f+"UseHandoffMessagePropertiesValue",!0)}function Fo(){return T(f+"EnableM365CopilotChatStarter",!1)||T(f+"EnableM365CopilotChat",!1)}function _o(){return T(f+"EnableCopilotStarterBizChat",!1)}function Po(){return T(f+"EnableBizChatNativePerfMark",!1)}function No(){return T(f+"EnableAppChatMsalUpnFix",!1)}function Mo(){return x(f+"EligibilityCacheDurationMs",864e5)}function Oo(){return v("EnableM365CopilotForConsumers",!1)}function Do(){return Fo()&&y("OfficeVSO_10391844_EnableAgentSwitchInCatalyst")}function Bo(){return T(f+"EnableNovaEventingProvider",!1)}function $o(){return T(f+"EnableM365ChatAuthWaitForRaf",!1)}function Ho(){return T(f+"enableM365ChatUseBackupResourceScopes",!0)}function Uo(){return T(f+"EnableUsePlumbedHostAccountInfo",!0)}function qo(){return T(f+"EnableOcpsTokenProviderLogFix",!0)}function Vo(){return T(f+"FallbackToastEnabled",!1)}function Wo(){return T(f+"BizChatFallbackToastDisabled",!1)}function Go(){const e=x(f+"CommandingChatLogLevel",0);return Math.max(0,Math.min(e,2))}function zo(){return S(f+"OpenAIApiKey","")}function Qo(){return S(f+"AnthropicClaudeModel","3.7")}function jo(){return S(f+"LocalMCPServerURL","")}function Jo(){return T(f+"EnableOfficeJSTool",!1)}function Yo(){return S(f+"AnthropicKeyTicket","")}function Xo(){return T(f+"AWSAnthropic",!0)}function Zo(){const e=S(f+"OfficeJSToolDescription","");if(e.length>0)return e}function Ko(){return T(f+"EnableTeamsDeeplyNestedAppAuthSupport",!1)}function er(){return T(f+"EnableCatalystConsumerToPacman",!1)}function tr(){return T(f+"EnableM365ChatAuthTreatFallbackAsFatalError",!0)}function nr(){return T(f+"EnableM365ChatAuthHandleNonInteractiveFatalErrors",!0)}function ar(){return T(f+"EnableM365ChatFatalErrorCallback",!0)}function or(){return x(f+"ChartDesignsRecommendationsResponseTimeoutInMillisecond",6e4)}function rr(){return T(f+"EnableProvideDynamicScreenshot",!0)}function ir(){return T(f+"EnableUseM365ChatDevMode",!0)}function lr(){return T(f+"EnableClientSelectionContext",!1)}},352628:(e,t,n)=>{"use strict";n.d(t,{$9:()=>d,$n:()=>c,GN:()=>s,LJ:()=>l,b_:()=>r,h7:()=>a,k$:()=>o,zi:()=>i});var a=["de-DE","en-GB","en-US","es-ES","es-MX","fr-CA","fr-FR","it-IT","ja-JP","pt-BR","zh-CN"],o=["cs-CZ","da-DK","fi-FI","hu-HU","ko-KR","nl-NL","nb-NO","pl-PL","pt-PT","ru-RU","sv-SE","th-TH","tr-TR","uk-UA","zh-TW"],r=["ar-SA","he-IL"],i=["ca-ES","cy-GB"],l=["bg-BG","el-GR","et-EE","hr-HR","id-ID","lt-LT","lv-LV","ro-RO","sk-SK","sl-SI","sr-Latn-RS","vi-VN"],s=["sq-AL","fil-PH","is-IS","kk-KZ","ms-MY","mt-MT","sr-Cyrl-RS"],c=["ar-SA","fa-IR","he-IL","ug-CN","ur-PK"],d=["af-ZA","am-ET","ar-SA","as-IN","az-Latn-AZ","bg-BG","bn-IN","bs-Latn-BA","ca-ES","ca-Es-VALENCIA","cs-CZ","cy-GB","da-DK","de-DE","el-GR","en-GB","en-US","es-ES","es-MX","et-EE","eu-ES","fa-IR","fi-FI","fil-PH","fr-CA","fr-FR","ga-IE","gd-gb","gl-ES","gu-IN","he-IL","hi-IN","hr-HR","hu-HU","hy-AM","id-ID","is-IS","it-IT","ja-JP","ka-GE","kk-KZ","km-KH","kn-IN","ko-KR","kok-IN","lb-LU","lo-LA","lt-LT","lv-LV","mi-NZ","mk-MK","ml-IN","mr-IN","ms-MY","mt-MT","nb-NO","ne-NP","nl-NL","nn-NO","or-IN","pa-IN","pl-PL","pt-BR","pt-PT","quz-PE","ro-RO","ru-RU","sk-SK","sl-SI","sq-AL","sr-Cyrl-BA","sr-Cyrl-RS","sr-Latn-RS","sv-SE","ta-IN","te-IN","th-TH","tr-TR","tt-RU","ug-CN","uk-UA","ur-PK","uz-Latn-UZ","vi-VN","zh-CN","zh-TW"]},352893:(e,t,n)=>{"use strict";n.d(t,{J:()=>L});var a=n(639765),o=n(548366),r=n(616166),i=n(446751),l=n(857677),s=n(279395),c=n(83437),d=n(418218),u=n(603222),m=n(384453),g=n(486092),h=n(208520);function p({rows:e,numberColumnWidth:t}){const n=d.Q1.neutral,a=(0,d.gY)(n),o=h.createElement(u.E,{animation:"wave",appearance:"translucent",style:{width:"100%",height:12,marginLeft:4,marginRight:4}},h.createElement(m.H,{size:12}));return h.createElement("div",{className:a.tablePreview},h.createElement("div",{className:a.numberRowColumn,style:{width:t}},Array.from({length:e}).map(((e,t)=>h.createElement("div",{className:a.numberRowCell,key:t},0===t?null:o)))),h.createElement("div",{className:(0,g.z)(a.dataColumn,a.lastDataColumn),style:{width:"100%"}},Array.from({length:e}).map(((e,t)=>h.createElement("div",{className:0===t?(0,g.z)(a.dataCell,a.headerCell):a.dataCell,key:t},o)))))}var b=n(76872),f=n(75496),C=n(316904),y=n(650444),v=n(92520);n(554094);const T=(e,t,n)=>Math.min(Math.max(((e,t="12px Segoe UI")=>{const n=document.createElement("canvas").getContext("2d");if(n)return n.font=t,n.measureText(e).width;return 12*e.length})(e),t),n);var x=n(540084),S=n(500461),w=n(210466),E=n(780866);const I={smallScrollbarStyle:{"::-webkit-scrollbar":{height:"7px",backgroundColor:"transparent",...w.Pt.borderRadius(S.k1.borderRadiusLarge)},"::-webkit-scrollbar-thumb":{backgroundColor:S.k1.colorScrollbarOverlay,...w.Pt.borderRadius(S.k1.borderRadiusLarge),...w.Pt.border("1px","solid",S.k1.colorNeutralBackground1),":hover":{backgroundColor:S.k1.colorNeutralForeground3}},"::-webkit-scrollbar-track":{backgroundColor:"transparent",...w.Pt.borderRadius(S.k1.borderRadiusLarge)}}},R=(0,E.n)(I);var A=n(123963);const L=({preview:e,type:t,theme:n,uiTimeout:r,errorData:i,isChatHistoryRehydration:u})=>{(0,A.IC)("Failed"===e,(()=>{C.M.userQueryGuid&&!u&&(C.M.getInstance().logStandardizedAshaErrorEvent(o.W.UI_Failed_To_Update_Or_Load,a.c.Preview_On_Card_Failed_To_Display,i.telemetryFeature),C.M.getInstance().logErrorCode(i.errorCode,new Error("Preview is 'Failed'"),i.telemetryType,c.$b.Warning))}));const m=(0,A.rK)("preview",Boolean(e),r,{onTimeout(){C.M.userQueryGuid&&!u&&(C.M.getInstance().logStandardizedAshaErrorEvent(o.W.Response_Delayed_Or_Timed_Out,a.c.Calculate_Preview_Timeout,i.telemetryFeature),C.M.getInstance().logErrorCode(i.errorCode,new Error("Preview took too long to load"),i.telemetryType,c.$b.Warning))},onLoaded(e,t){b.E.getInstance().logLatency(e,l.OP.FormulaPreviewAvailable,!t)}}),g=h.createElement("div",null,s.olU.FormulaSuggestion_Preview_NotAvailable);switch(m){case"timeout":return g;case"loading":return h.createElement(p,{rows:7,numberColumnWidth:d.i$});case"loaded":switch(e){case"Failed":return g;case"previewDisabled":case void 0:return null;default:return h.createElement(k,{preview:e,type:t,theme:n,errorData:i})}default:(0,y.x)(m)}},k=({preview:e,type:t,theme:n})=>{const a=(0,d.gY)(n),o=R();if(!e.rows.length||!e.rows[0].values.length)return(0,v.cY)("TablePreview: No rows or values in preview"),null;const l=e.rows[0].values.length,u=({children:e})=>h.createElement("div",{className:a.numberRowCell},h.createElement("div",null,e)),m=({children:e,className:t,contentClassName:n})=>h.createElement("div",{className:t},h.createElement("div",{className:(0,g.z)(a.contentDataCell,n)},e)),p=Array.from({length:l}),b=p.length-1,y=T(String(e.rows.at(-1)?.row),d.i$,d.oz);return h.createElement("div",{className:a.tablePreview,role:"group","aria-label":s.olU.FormulaSuggestion_Preview_AriaLabel},h.createElement("div",{className:a.numberRowColumn,style:{width:y},"aria-hidden":!0},h.createElement(u,null)," ",h.createElement(u,null,e.headerRow),e.rows.map((e=>h.createElement(u,{key:e.row},e.row)))),h.createElement("div",{className:(0,g.z)(a.dataColumnsContainer,o.smallScrollbarStyle)},p.map(((n,o)=>{const l=0===o,s=o===b,d=e.columnLetters[o];void 0===d&&C.M.getInstance().logErrorCode(r.O.CalculatedColumnPreviewNoColumnLetters,new Error(`columnLetters is undefined for column ${o} out of ${b}`),f.S2.FormulaGeneration,c.$b.Warning);const u=l?void 0:e.columnLetters[o-1],y=s?void 0:e.columnLetters[o+1],{isBeforeSkip:v,isAfterSkip:T}=function(e,t,n){if(void 0===e)return{isBeforeSkip:!1,isAfterSkip:!1};const a=void 0!==t&&(0,x.$Y)(e)+1!==(0,x.$Y)(t),o=void 0!==n&&(0,x.$Y)(n)+1!==(0,x.$Y)(e);return{isBeforeSkip:a,isAfterSkip:o}}(d,y,u);return h.createElement("div",{key:o,className:(0,g.z)(a.dataColumn,s&&a.lastDataColumn),style:{maxWidth:1===p.length?"100%":"50%"}},h.createElement(m,{className:(0,g.z)(a.dataCell,a.headerCell,v&&a.headerCellBeforeSkip,T&&a.headerCellAfterSkip)},d),h.createElement(m,{className:(0,g.z)(a.dataCell,a.columnTitleCell)},e.columnHeaders[o]),e.rows.map(((e,n,r)=>{const l=n===r.length-1;return h.createElement(m,{key:e.row,className:(0,g.z)(a.dataCell,t===i.VS.Cell&&l&&a.dataCellTotal),contentClassName:t===i.VS.Cell&&l?a.contentDataCellTotal:void 0},e.values[o])})))}))))}},354535:(e,t,n)=>{"use strict";n.d(t,{jg:()=>i,kV:()=>l,r7:()=>s});var a,o=n(660606);!function(e){e.AutoOpenTTVR="visuallyReady",e.AutoOpenTTFR="functionallyReady"}(a||(a={}));var r="[BizChat Perf]:";function i(e,t,n,i,l){var s=n;(0,o.cY)("".concat(r,": chat load event triggered at ").concat(performance.now()),n);var d=function(e){var t=void 0;switch(null==e?void 0:e.measureType){case"TTVR":t=a.AutoOpenTTVR;break;case"TTFR":t=a.AutoOpenTTFR}return t}(s);if(d)if(c())d===(l?a.AutoOpenTTFR:a.AutoOpenTTVR)&&(Microsoft.Office.WebExtension.Interactive(!0),(0,o.cY)("".concat(r,": Interactive API called with true param")));else if(t){var u=function(e,t,n){var a={MessageId:e,SendTime:void 0!==n?n:Date.now(),Values:{Payload:{type:"CopilotAutoOpen",CopilotTTVRCheckpoint:{ttvrCheckpoint:t},fromBizChat:!0}}};return JSON.stringify(a)}(e,d,s.eventTime);i({type:"CopilotChatTTVRMessage",message:u}),(0,o.cY)("".concat(r,": Perf PostMessage Sent"),u)}else(0,o.cY)("".concat(r,": Skipping post message for non-auto open"));else(0,o.cY)("".concat(r,": Invalid event arg"),s)}function l(e,t){var n={MessageId:e,SendTime:Date.now(),Values:{Payload:{mark:"dismiss"}}},a=JSON.stringify(n);t({type:"CopilotChatShimmerMessage",message:a}),(0,o.cY)("".concat(r,": Hide Shimmer PostMessage Sent"),a)}function s(){c()&&(Microsoft.Office.WebExtension.Interactive(!0),(0,o.cY)("".concat(r,": Interactive API called with true param")))}function c(){var e,t;return"undefined"!=typeof Microsoft&&"function"==typeof(null===(t=null===(e=null===Microsoft||void 0===Microsoft?void 0:Microsoft.Office)||void 0===e?void 0:e.WebExtension)||void 0===t?void 0:t.Interactive)}},359730:(e,t,n)=>{"use strict";n.d(t,{d:()=>c,x:()=>d});var a=n(279395),o=n(542769),r=n(126521),i=n(507628);let l,s;function c(e){const t=e.workbook.worksheets.load("items");return()=>async e=>{const n=function(e){if(void 0===l)return null;let t,n=l;do{n++,t=(0,r.L)(a.olU.InsertedWorksheetName,n)}while(e.some((e=>e.name===t)));return s(n),t}(t.items),c=t.getActiveWorksheet().load("id");await e.sync();const d=n?t.add(n):t.add(),u=(0,i.A)();e.trace(u);const m=(0,o.U)((()=>d.delete()),u);try{await e.sync()}catch(e){await m(e)}d.load(["id","name"]);const g=(0,i.A)();e.trace(g);const h=(0,o.U)((()=>d.delete()),g);try{await e.sync()}catch(e){await h(e)}const p=c.id;return{result:d,undo:e=>(e.workbook.worksheets.getItem(p).activate(),e.sync())}}}function d(e,t){const n=e.workbook.worksheets.getActiveWorksheet();return n.load("name"),()=>e=>(t.activate(),Promise.resolve({result:t,undo:t=>(e.workbook.worksheets.getItem(n.name).activate(),t.sync())}))}},360449:(e,t,n)=>{"use strict";function a(e,t){const n=[];return e.forEach((e=>{for(let a=e.top;a<=e.bottom;a++)for(let o=e.left;o<=e.right;o++)n.push(t(a,o))})),n}function o(e,t){return e.map((({row:e,column:n})=>t(e,n)))}n.d(t,{O:()=>o,w:()=>a})},371120:(e,t,n)=>{"use strict";function a(e){switch(e){case"values":case"xValues":case"yValues":return!0;default:return!1}}function o(e,t,n){const a=e.series[t].dataBindings,o=e.data.dimensions,r=a.find((e=>e.dimensionType===n));return r&&o.find((e=>e.id===r.dimensionId))}n.d(t,{$:()=>a,Q:()=>o})},374315:(e,t,n)=>{"use strict";n.d(t,{JU:()=>O,GU:()=>F,wF:()=>A,fp:()=>R,LS:()=>D,ke:()=>$,bl:()=>B,xX:()=>M,Dz:()=>N,oO:()=>S,mo:()=>H,gp:()=>L,yt:()=>k});var a=n(616166),o=n(88568),r=n(749832),i=n(279395),l=n(207545),s=n(198588),c=n(764080),d=n(857677),u=n(316904),m=n(314793),g=n(507628);function h(e,t){e.onerror=()=>{t(new a.u(a.O.NetworkError))},e.timeout=m.R.getAnalyzeDataNetworkTimeout(),e.ontimeout=()=>{t(new a.u(a.O.NetworkTimeout))}}function p(e,t){t&&Object.keys(t).forEach((n=>{e.setRequestHeader(n,t[n])}))}function b(e,t,n){const a=(0,g.A)().replace(/-/g,"").slice(0,16);let o;o=t?.[i.Vno]?t[i.Vno]:(0,g.A)(),o=o.replace(/-/g,"");const r=`00-${o}-${a}-01`;e.setRequestHeader("traceparent",r),n.push({key:d.W0.TraceId,value:o}),n.push({key:d.W0.SpanId,value:a})}var f=n(530499),C=n(558976),y=n(347145),v=n(819415),T=n(659126),x=n(851295);function S(e,t,n){const a={"Accept-Language":(0,x.gl)(),Flights:(0,y.lCC)(),DeferredFlights:(0,v.RJ)(),SessionId:(0,v.u0)()};return e&&(a.Authorization=`Bearer ${e}`),t&&(a["New-Authorization"]=t),n&&(a[i.Vno]=n),a}const w=1e4;function E(){return w}function I(e){return 400===e?new a.u(a.O.BadRequest):401===e?new a.u(a.O.Unauthorized):403===e?new a.u(a.O.Forbidden):406===e?new a.u(a.O.NotAcceptable):404===e?new a.u(a.O.NotFound):410===e?new a.u(a.O.Gone):429===e?new a.u(a.O.NetworkThrottleError):500===e?new a.u(a.O.InternalServerError):new Error}function R(){return"F940464D-7313-4BF9-B3F4-60A4E3DC50B7"}function A(){switch((0,y.xyg)("InsightsEndpointOverride")){case"dev":return i.WlT;case"dev2":return i.imX;case"ppe":return i.gu1;case"prod":return i.mDj}const e=r.V.getSettingAsString(r.z.InsightsEndpoint);return"Insights.Https.GCC.Bundle"===e?i.W32:"Insights.Https.DOD.Bundle"===e?i.u7V:"Insights.Https.GCCH.Bundle"===e?i.w_Q:(0,l.I_)()||(0,l.B2)()?i.gu1:i.mDj}async function L(e,t,n,o,r){const{address:i,rowCount:l,columnCount:s}=t,c={contentLanguageHint:e.contentLanguageHint,topLeftCellAddress:(0,T.D$)(i),sheetName:n,tableName:o,dataSize:{width:s,height:l},data:await(0,f.yu)(e)};return V((e=>function(e,t,n){return new Promise(((o,r)=>{const i=new XMLHttpRequest,l=[],s=[{key:d.W0.NumRows,value:e.data.valueRows.length},{key:d.W0.NumColumns,value:e.data.valueRows[0].length},{key:d.W0.Height,value:e.dataSize.height},{key:d.W0.Width,value:e.dataSize.width}];let c=0;const m=new URLSearchParams;m.set("clientId","F940464D-7313-4BF9-B3F4-60A4E3DC50B7");const g=`${A()}/v3.0/ranges/initialize?${m.toString()}`;i.open("POST",g,!0),i.setRequestHeader("Content-Type","application/json"),b(i,t,s),p(i,t),h(i,r),i.onreadystatechange=()=>{if(4===i.readyState){if(l.push({key:d.W0.ServiceTime,value:performance.now()-c}),0===i.status);else if(201===i.status){const e=i.getResponseHeader("Range-Id"),t=i.getResponseHeader("Location"),n=i.getResponseHeader("Auth-Token");s.push({key:d.W0.RangeId,value:e}),l.push({key:d.W0.RangeId,value:e}),o({...JSON.parse(i.responseText),rangeId:e,location:t,authToken:n})}else r(I(i.status));u.M.getInstance().logInsightsApiCall("POST","initialize",i.status,n,s),u.M.getInstance().logRangeDataPerformance(l)}};try{const t=e.data.valueRows.length*e.data.valueRows[0].length,n=performance.now(),a=JSON.stringify(e);if(l.push({key:d.W0.SerializationTime,value:performance.now()-n}),t>E()){const e=performance.now(),t=(0,C.Kc)(a,{level:1});l.push({key:d.W0.CompressionMethod,value:"deflate"},{key:d.W0.CompressionTime,value:performance.now()-e},{key:d.W0.RequestSize,value:t.length}),c=performance.now(),i.setRequestHeader("Content-Encoding","deflate"),i.send(t)}else l.push({key:d.W0.CompressionMethod,value:"none"},{key:d.W0.RequestSize,value:a.length}),c=performance.now(),i.send(a)}catch(e){r(new a.u(a.O.InitializeRangesFailure,e))}}))}(c,r,e)))}async function k(e,t,n,o){const r={rowOffset:n,data:await(0,f.yu)(t)};return V((t=>function(e,t,n,o){return new Promise(((r,i)=>{const l=new XMLHttpRequest,s=[],c=[{key:d.W0.NumRows,value:t.data.valueRows.length},{key:d.W0.NumColumns,value:t.data.valueRows[0].length},{key:d.W0.RowOffset,value:t.rowOffset}];let m=0;const g=new URLSearchParams;g.set("clientId","F940464D-7313-4BF9-B3F4-60A4E3DC50B7");const f=`${A()}${e}/data?${g.toString()}`;l.open("POST",f,!0),l.setRequestHeader("Content-Type","application/json"),b(l,n,c),p(l,n),h(l,i),l.onreadystatechange=()=>{4===l.readyState&&(s.push({key:d.W0.ServiceTime,value:performance.now()-m}),0===l.status||(200===l.status?r(JSON.parse(l.responseText)):i(I(l.status))),u.M.getInstance().logInsightsApiCall("POST","data",l.status,o,c),u.M.getInstance().logRangeDataPerformance(s))};try{const e=t.data.valueRows.length*t.data.valueRows[0].length,n=performance.now(),a=JSON.stringify(t);if(s.push({key:d.W0.SerializationTime,value:performance.now()-n}),e>E()){const e=performance.now(),t=(0,C.Kc)(a,{level:1});s.push({key:d.W0.CompressionMethod,value:"deflate"},{key:d.W0.CompressionTime,value:performance.now()-e},{key:d.W0.RequestSize,value:t.length}),m=performance.now(),l.setRequestHeader("Content-Encoding","deflate"),l.send(t)}else s.push({key:d.W0.CompressionMethod,value:"none"},{key:d.W0.RequestSize,value:a.length}),m=performance.now(),l.send(a)}catch(e){i(new a.u(a.O.StoreDataFailure,e))}}))}(e,r,o,t)))}async function F(e,t,n){return V((a=>function(e,t,n,a){return new Promise(((o,r)=>{const i=new XMLHttpRequest,l=new URLSearchParams;l.set("clientId","F940464D-7313-4BF9-B3F4-60A4E3DC50B7");const s=`${A()}${e}/generateResults?${l.toString()}`;i.open("POST",s,!0),i.setRequestHeader("Content-Type","application/json"),p(i,n),h(i,r);const c=[];b(i,n,c),i.onreadystatechange=()=>{if(4===i.readyState){if(0===i.status);else if(202===i.status){const e=i.getResponseHeader("Operation-Id"),t=i.getResponseHeader("Operation-Location");o({operationId:e,operationLocation:t}),c.push({key:d.W0.OperationId,value:e})}else r(I(i.status));u.M.getInstance().logInsightsApiCall("POST","generateResultsForRange",i.status,a,c)}},i.send(JSON.stringify(t))}))}(e,t,n,a)))}async function _(e,t,n,a){const r=await V((n=>async function(e,t,n){return new Promise(((a,o)=>{const r=new XMLHttpRequest,i=new URLSearchParams;i.set("clientId","F940464D-7313-4BF9-B3F4-60A4E3DC50B7");const l=`${A()}${e}?${i.toString()}`;r.open("GET",l,!0),p(r,t),h(r,o);const s=[];b(r,t,s),r.onreadystatechange=()=>{if(4===r.readyState){if(0===r.status);else if(200===r.status){const e=JSON.parse(r.responseText);s.push({key:d.W0.OperationStatus,value:e.status}),a(e)}else o(I(r.status));u.M.getInstance().logInsightsApiCall("GET","operation",r.status,n,s)}},r.send()}))}(e,t,n)));return await async function(e,t,n){const a={...e.resourceLocations};e.links[s.J.NLEvaluationResult]&&(a.nlEvaluationResult=e.links[s.J.NLEvaluationResult].href);const r=await async function(e,t,n){if(t&&n&&e&&e.length>0){const a=new o.y(n.sheetId),r=Promise.all(e.map((e=>(0,f.sy)(a.getTranslations(n.rowIndex,n.columnIndex),e,t,!1))));return await a.resolveJobs(),await r}return}(e.statusDetails?.nlEvaluationState?.intermediateResults,t,n),i=e.statusDetails?{...e.statusDetails,nlEvaluationState:e.statusDetails.nlEvaluationState?{...e.statusDetails.nlEvaluationState,intermediateResults:r}:void 0}:void 0,l={...e,statusDetails:i,resourceLocations:a};return l}(r,n,a)}async function P(e,t){await V((n=>async function(e,t,n){return new Promise(((a,o)=>{const r=new XMLHttpRequest,i=new URLSearchParams;i.set("clientId","F940464D-7313-4BF9-B3F4-60A4E3DC50B7");const l=`${A()}${e}?${i.toString()}`;r.open("DELETE",l,!0),p(r,t),h(r,o);const s=[];b(r,t,s),r.onreadystatechange=()=>{4===r.readyState&&(0===r.status||(200===r.status?a():o(I(r.status))),u.M.getInstance().logInsightsApiCall("DELETE","operation",r.status,n,s))},r.send()}))}(e,t,n)))}async function N(e,t,n,a,r){const i=await V((t=>function(e,t,n,a){return new Promise(((o,r)=>{const i=new XMLHttpRequest,l=new URLSearchParams;l.set("clientId","F940464D-7313-4BF9-B3F4-60A4E3DC50B7"),n&&(l.set("chartWidth",n.chartWidth.toString()),l.set("chartHeight",n.chartHeight.toString()));const s=`${A()}${e}?${l.toString()}`;i.open("GET",s,!0),p(i,t),h(i,r);const c=[];b(i,t,c),i.onreadystatechange=()=>{4===i.readyState&&(0===i.status||(200===i.status?o(JSON.parse(i.responseText)):r(I(i.status))),u.M.getInstance().logInsightsApiCall("GET","recommendations",i.status,a,c))},i.send()}))}(e,n,a,t))),l=[],s=new o.y(t.sheetId),c=s.getTranslations(t.rowIndex,t.columnIndex);i.recommendations&&l.push(...i.recommendations);const d=Promise.all(l.map((e=>{const t=i.interpretations.find((({id:t})=>t===e.interpretationId));return(0,f.gT)(c,e,t,r??!1)}))),m=Promise.all(i.interpretations.map((e=>(0,f.r9)(c,e))));await s.resolveJobs();const[g,C]=await Promise.all([m,d]);return{interpretations:g,recommendations:C}}async function M(e,t,n,a,r){let i=await V((n=>W(e,t,r,n)),q);(function(e){if(e.responseType!==c.WZ.Answered||!e.visualAnswer||!e.visualAnswer.visual)return!1;if(!(0,s.tz)(e.visualAnswer))return!1;const t=e.visualAnswer.visual.pivotTable,n=!!t.labelFilters&&t.labelFilters.length>0,a=!!t.valueFilters&&t.valueFilters.some((e=>"between"===e.filterType||"notBetween"===e.filterType)),o=Office.context.requirements.isSetSupported.bind(Office.context.requirements);if(t.dateFilters&&t.dateFilters.length>0){if(!o("ExcelApi","1.12")&&!o("PivotFilters","1.2"))return!0;if(!!t.dateFilters&&t.dateFilters.some((e=>!!e.wholeDays))&&!o("PivotTableNativeGrouping","1.1")&&!o("ExcelApi","1.14"))return!0}if((n||a)&&!o("ExcelApi","1.12")&&!o("PivotFilters","1.1"))return!0;const r=e=>!!e.datePartOverride,i=t.rowFields?.some(r)??!1,l=t.columnFields?.some(r)??!1;if((i||l)&&!o("PivotTableNativeGrouping","1.1"))return!0;return!1})(i)&&(t.forceStaticAnswer=!0,i=await V((n=>W(e,t,r,n)),q));const l=new o.y(a.sheetId),d=(0,f.sy)(l.getTranslations(a.rowIndex,a.columnIndex),i,n,!!t.forceStaticAnswer);return await l.resolveJobs(),await d}async function O(e,t,n){return V((a=>function(e,t,n,a){return new Promise(((o,r)=>{const i=new XMLHttpRequest;(new URLSearchParams).set("clientId","F940464D-7313-4BF9-B3F4-60A4E3DC50B7"),i.open("POST",e,!0),i.setRequestHeader("Content-Type","application/json"),p(i,n),h(i,r);const l=[];b(i,n,l);const s=e.split("/"),c=s[3],m=s[5];l.push({key:d.W0.RangeId,value:c}),l.push({key:d.W0.NLContextId,value:m}),l.push({key:d.W0.AllowRewrite,value:t.allowRewrite??!1}),i.onreadystatechange=()=>{if(4===i.readyState){if(0===i.status);else if(202===i.status){const e=i.getResponseHeader("Operation-Id"),t=i.getResponseHeader("Operation-Location");o({operationId:e,operationLocation:t}),l.push({key:d.W0.OperationId,value:e})}else r(I(i.status));u.M.getInstance().logInsightsApiCall("POST","generateResultForNaturalLanguage",i.status,a,l)}},i.send(JSON.stringify(t))}))}(e,t,n,a)))}async function D(e,t,n,a,r){const i=await V((t=>function(e,t,n){return new Promise(((a,o)=>{const r=new XMLHttpRequest;(new URLSearchParams).set("clientId","F940464D-7313-4BF9-B3F4-60A4E3DC50B7"),r.open("GET",e,!0),p(r,t),h(r,o);const i=[];b(r,t,i),r.onreadystatechange=()=>{4===r.readyState&&(0===r.status||(200===r.status?a(JSON.parse(r.responseText)):o(I(r.status))),u.M.getInstance().logInsightsApiCall("GET","getResultForNaturalLanguage",r.status,n,i))},r.send()}))}(e,r,t)),q),l=new o.y(n.sheetId),s=(0,f.sy)(l.getTranslations(n.rowIndex,n.columnIndex),i,t,!!a);return await l.resolveJobs(),await s}async function B(e,t,n){const a=await V((a=>function(e,t,n,a){return new Promise(((o,r)=>{const i=new XMLHttpRequest,l=new URLSearchParams;l.set("clientId","F940464D-7313-4BF9-B3F4-60A4E3DC50B7");const s=`${A()}${e}?${l.toString()}`;i.open("POST",s,!0),i.setRequestHeader("Content-Type","application/json"),p(i,n),h(i,r);const c=[];b(i,n,c),i.onreadystatechange=()=>{4===i.readyState&&(0===i.status||(201===i.status?o(JSON.parse(i.responseText)):r(I(i.status))),u.M.getInstance().logInsightsApiCall("POST","naturalLanguageContext",i.status,a,c))},i.send(JSON.stringify(t))}))}(e,t,n,a)),q);return{id:a.id,evaluateQueryLocation:a.evaluateQueryLocation,generateResultForNLEvaluationLocation:a.links[s.J.GenerateResultForNLEvaluation]?.href,language:a.language,suggestedQueries:a.suggestedQueries}}async function $(e,t,n){const a=await V((t=>function(e,t,n){return new Promise(((a,o)=>{const r=new XMLHttpRequest,i=new URLSearchParams;i.set("clientId","F940464D-7313-4BF9-B3F4-60A4E3DC50B7");const l=`${A()}${e}?${i.toString()}`;r.open("GET",l,!0),p(r,t),h(r,o);const s=[];b(r,t,s),r.onreadystatechange=()=>{4===r.readyState&&(0===r.status||(200===r.status?a(JSON.parse(r.responseText)):o(I(r.status))),u.M.getInstance().logInsightsApiCall("GET","interpretations",r.status,n,s))},r.send()}))}(e,n,t))),r=new o.y(t.sheetId),i=r.getTranslations(t.rowIndex,t.columnIndex),l=Promise.all(a.interpretations.map((e=>(0,f.r9)(i,e))));return await r.resolveJobs(),{interpretations:await l}}function H(e,t,n,a,o,r,i=()=>!1){return function(e,t,n,a,o,r,i){const l=[],s={};function d(e){Object.keys(e||{}).forEach((n=>{const a=t[n],o=e[n];!s[n]&&a&&(l.push(a(o)),s[n]=!0)}))}async function u(e){if(!a||!e)return Promise.resolve({shouldDeleteOperation:!1});const t=Object.keys(e||{}).map((t=>{const n=a[t],o=e[t];return n?n(o):Promise.resolve({shouldDeleteOperation:!1})})),n=(await Promise.all(t)).some((e=>e.shouldDeleteOperation));return Promise.resolve({shouldDeleteOperation:n})}async function m(){const t=await _(e,o,r,i);if(n())return await P(e,o),[];const{resourceLocations:a,retryAfterMs:s,status:g}=t,h=s||2e3,p=new Promise((e=>{setTimeout(e,h)}));switch(g){case c.Uh.NotStarted:return await p,n()?(await P(e,o),[]):m();case c.Uh.Running:{d(a);const{shouldDeleteOperation:r}=await u(t.statusDetails);return(0,y.yw9)("OfficeVSO_10449020_LoopFallBack")&&r||n()?(await P(e,o),[]):(await p,n()?(await P(e,o),[]):m())}case c.Uh.Succeeded:return d(a),await u(t.statusDetails),n()?(await P(e,o),[]):Promise.all(l);default:return Promise.reject(new Error("Unexpected operation result."))}}return m()}(e,t,i,n,a,o,r)}const U=4,q=2;function V(e,t=U){let n=0;const o=async()=>{try{return await e(n)}catch(e){return(e.errorCode===a.O.NetworkError||e.errorCode===a.O.NetworkTimeout)&&n<t?(n++,await new Promise((e=>{window.setTimeout(e,1===n?0:200)})),o()):Promise.reject(e)}};return o()}function W(e,t,n,a){return new Promise(((o,r)=>{const i=new XMLHttpRequest,l=new URLSearchParams;l.set("clientId","F940464D-7313-4BF9-B3F4-60A4E3DC50B7");const s=`${A()}${e}?${l.toString()}`;i.open("POST",s,!0),i.setRequestHeader("Content-Type","application/json"),p(i,n),h(i,r);const c=[];b(i,n,c);const m=e.split("/"),g=m[3],f=m[5];c.push({key:d.W0.RangeId,value:g}),c.push({key:d.W0.NLContextId,value:f}),c.push({key:d.W0.AllowRewrite,value:t.allowRewrite??!1}),i.onreadystatechange=()=>{4===i.readyState&&(0===i.status||(200===i.status?o(JSON.parse(i.responseText)):r(I(i.status))),u.M.getInstance().logInsightsApiCall("POST","naturalLanguageResult",i.status,a,c))},i.send(JSON.stringify(t))}))}},375746:(e,t,n)=>{"use strict";n.d(t,{W:()=>l});var a=n(83437),o=n(459524),r=n(715834),i=n(50863);class l{async getPrimaryIdentityEmail(){const e=new i.A("GetPrimaryIdentityEmail");try{const t=await this.authHost.providers.getCurrent().getPrimaryIdentityEmail();return e.succeed({}),t}catch(t){throw e.fail(a.$b.Warning,{},t),new Error}}async authorize(e,t,n){let r;for(;this.authHost.providers.hasMore();){const l=this.authHost.providers.getCurrent().getName(),s=new i.A("Authorize");s.sendStart({scope:JSON.stringify(e),parentCallId:t});try{const n=await this.getAccessTokenSilent(e,t);return s.succeed({parentCallId:t,usedPopup:!1,usedLastAttempt:!1,provider:l}),n}catch(e){r=r||e}if("WebOAuthApiProvider"!==l){if(!(0,o.f)())try{const n=await this.getAccessTokenInternal(e,!0,t);return s.succeed({parentCallId:t,usedPopup:!0,usedLastAttempt:!1,provider:l}),n}catch(e){}try{if(n){const a=await n(e,t);return s.succeed({parentCallId:t,usedPopup:!0,usedLastAttempt:!0,provider:l}),a}}catch(e){}}s.fail(a.$b.Warning,{parentCallId:t,usedPopup:!0,usedLastAttempt:!!n,provider:l},r),this.authHost.providers.removeCurrent()}throw new Error("Authorization Error")}async getAccessTokenSilent(e,t){return this.getAccessTokenInternal(e,!1,t)}async getAccessTokenInternal(e,t,n){return await this.authHost.ensureAuthLibraryLoaded(n),(0,r.U)((async()=>this.getAccessTokenFn(e,t,n)),(()=>!0),(()=>!1),1)}async getAccessTokenFn(e,t,n){const o=new i.A("GetAccessToken");try{const a=await this.authHost.providers.getCurrent().getToken(e,t);return o.succeed({parentCallId:n,usePopup:t}),a}catch(e){throw o.fail(a.$b.Warning,{parentCallId:n,usePopup:t},e),e}}constructor(e){this.authHost=e}}},376075:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(378482),o=n(575976),r=n(154836);t.default=function(e,t,n){if(a.default.randomUUID&&!t&&!e)return a.default.randomUUID();const i=(e=e||{}).random??e.rng?.()??(0,o.default)();if(i.length<16)throw new Error("Random bytes length must be >= 16");if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){if((n=n||0)<0||n+16>t.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[n+e]=i[e];return t}return(0,r.unsafeStringify)(i)}},377159:(e,t,n)=>{"use strict";n.d(t,{P1:()=>m,XT:()=>g,o8:()=>h});var a=n(856135),o=n(649405),r=n(375746),i=n(855391),l=n(618175),s=n(252163),c=n(176664);const d={resource:i.Vs},u={resource:i.U4};class m{async authorizeStorageService(e){const t=m.getStorageScope();return this.authorizeScope(t,e)}async authorizeScope(e,t){const n=this.tokenCache;if(n){if(!(Date.now()>n.expirationTime))return n.token;this.clearStorageToken()}return this.pendingPromise||(this.pendingPromise=this.auth.authorize(e,t,m.fallbackFn).then((e=>(this.pendingPromise=void 0,this.cacheStorageToken(e,Date.now()+m.getExpirationTime()),e)))),this.pendingPromise}static putFallbackFn(e){m.fallbackFn=e}static getStorageScope(){return"makerserviceint"===h()?u:d}cacheStorageToken(e,t){Number.isInteger(t)&&(this.tokenCache={token:e,expirationTime:t})}getCachedStorageToken(){return this.tokenCache}static getExpirationTime(){return 864e5}clearStorageToken(){this.tokenCache=void 0}static getAuthProviders(){return[new l.f]}static instance(){const e=m.getAuthProviders();return m._instance||(m._instance=new m(new r.W(new a.N(new o.f(e))))),m._instance}constructor(e){this.auth=e}}var g;function h(){const e=(0,s.P)("StorageModePreference");if(e)return e;return"Dogfood"===(0,c.A)()?"makerserviceint":"makerserviceprodnew"}!function(e){e.makerserviceprodnew="makerserviceprodnew",e.makerserviceint="makerserviceint"}(g||(g={}))},378482:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n="undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);t.default={randomUUID:n}},379510:(e,t,n)=>{"use strict";n.d(t,{I:()=>c,O:()=>o});var a=n(1541);function o(e){const{valueRows:t,formatRows:n,textRows:a,formulas:o}=e;return{values:t,numberFormats:n,texts:a,formulas:o}}function r(e,t,n){return e.values[t][n]}function i(e,t,n){return e.texts[t][n]}function l(e,t,n){return e.formulas?.[t][n]}function s(e,t,n){return(0,a.gV)(e.numberFormats,t,n)}function c(e,t,n,a,o){return{row:t+a,column:n+o,displayText:i(e,t,n),rawValueJson:JSON.stringify(r(e,t,n)),numberFormat:s(e,t,n),formulaJson:JSON.stringify(l(e,t,n))}}},380070:(e,t)=>{"use strict";var n,a=Symbol.for("react.element"),o=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),c=Symbol.for("react.context"),d=Symbol.for("react.server_context"),u=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),g=Symbol.for("react.suspense_list"),h=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),b=Symbol.for("react.offscreen");function f(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case a:switch(e=e.type){case r:case l:case i:case m:case g:return e;default:switch(e=e&&e.$$typeof){case d:case c:case u:case p:case h:case s:return e;default:return t}}case o:return t}}}n=Symbol.for("react.module.reference"),t.ContextConsumer=c,t.ContextProvider=s,t.Element=a,t.ForwardRef=u,t.Fragment=r,t.Lazy=p,t.Memo=h,t.Portal=o,t.Profiler=l,t.StrictMode=i,t.Suspense=m,t.SuspenseList=g,t.isAsyncMode=function(){return!1},t.isConcurrentMode=function(){return!1},t.isContextConsumer=function(e){return f(e)===c},t.isContextProvider=function(e){return f(e)===s},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===a},t.isForwardRef=function(e){return f(e)===u},t.isFragment=function(e){return f(e)===r},t.isLazy=function(e){return f(e)===p},t.isMemo=function(e){return f(e)===h},t.isPortal=function(e){return f(e)===o},t.isProfiler=function(e){return f(e)===l},t.isStrictMode=function(e){return f(e)===i},t.isSuspense=function(e){return f(e)===m},t.isSuspenseList=function(e){return f(e)===g},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===r||e===l||e===i||e===m||e===g||e===b||"object"==typeof e&&null!==e&&(e.$$typeof===p||e.$$typeof===h||e.$$typeof===s||e.$$typeof===c||e.$$typeof===u||e.$$typeof===n||void 0!==e.getModuleId)},t.typeOf=f},380473:(e,t,n)=>{"use strict";n.d(t,{d:()=>a});class a{promise(){return this.cachedPromise||(this.cachedPromise=this.initFn().then((e=>(this.cachedPromise&&(this.cachedValue=e),e)))),this.cachedPromise}forget(){this.cachedPromise=void 0,this.cachedValue=void 0}isStarted(){return void 0!==this.cachedPromise}value(){return this.cachedValue}get(){return()=>this.promise()}constructor(e){this.initFn=e}}},382736:(e,t,n)=>{"use strict";n.d(t,{N:()=>o});var a=n(92520);function o(e){if(!e.chatMessageData?.defaultMessageProps)return(0,a.cY)("Message provided to getFluxProgramResponseFromDefaultMessage had no defaultMessageProps"),"";const t=e.chatMessageData.defaultMessageProps;let n="";if(t?.messageHeader&&(n=n+r(t.messageHeader)+"\n"),t?.embeddedLists)for(const e of t.embeddedLists){if(e.listHeader&&(n=n+e.listHeader+"\n"),e.listItems)for(const t of e.listItems)n+=t.title?`${t.title}: ${t.text+"\n"}`:""+(t.text+"\n");e.listFooter&&(n=n+r(e.listFooter)+"\n")}return t?.messageFooter&&(n+=r(t.messageFooter)),n}function r(e){let t="";return e?.text&&(t+=e.text),e?.linkText&&(t=t+e.linkText.text+e.linkText.linkSuffix??""),t}},389064:(e,t,n)=>{"use strict";e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},389618:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i},393035:(e,t,n)=>{"use strict";n.d(t,{X:()=>c,u:()=>d});var a=n(301735),o=n(708353),r=n(857677),i=n(347145),l=n(311538);const s=()=>(0,i.yw9)("OfficeVSO_9565005_InsertImageOCV");function c(e){return e.useExcelMDComponents?(0,l.i)(e.telemetryFeatureName):void 0}function d(e,t){switch(e){case a.w.ElseSkillName:return{showAiGenerated:!1,feedbackPosition:o.O.None,useExcelMDComponents:!0,telemetryFeatureName:r.q.Else,feedbackData:{feedbackArea:"Copilot\\Else"},shouldShowDevDiagnosticsButton:!1,addCardToChatHistory:!1};case a.w.GetInsightsName:case a.w.ExcelAnalysis:case a.w.ChartsAndPivotTablesName:case a.w.TextAnalysisName:return{showAiGenerated:!0,feedbackPosition:o.O.Footer,useExcelMDComponents:!0,telemetryFeatureName:r.q.AnalyzeData,feedbackData:{feedbackArea:"Copilot\\Analyze Data"},shouldShowDevDiagnosticsButton:!0,addCardToChatHistory:!1};case a.w.ImageChatName:return s()?{showAiGenerated:!0,feedbackPosition:o.O.Footer,useExcelMDComponents:!0,telemetryFeatureName:r.q.ImageChat,feedbackData:{feedbackArea:"Copilot\\Image Chat"},shouldShowDevDiagnosticsButton:!0,addCardToChatHistory:!1}:{showAiGenerated:!1,feedbackPosition:o.O.Footer,useExcelMDComponents:!1,telemetryFeatureName:t?r.q.Search:r.q.CopilotChat,feedbackData:{feedbackArea:t?"Copilot\\Search":"Copilot"},shouldShowDevDiagnosticsButton:!1,addCardToChatHistory:!1};default:return{showAiGenerated:!1,feedbackPosition:o.O.Footer,useExcelMDComponents:!1,telemetryFeatureName:t?r.q.Search:r.q.CopilotChat,feedbackData:{feedbackArea:t?"Copilot\\Search":"Copilot"},shouldShowDevDiagnosticsButton:!1,addCardToChatHistory:!1}}}},394201:(e,t,n)=>{"use strict";n.d(t,{D:()=>r});var a=n(92520),o=n(347145);function r(e){let t,n,r,i,l;if(e.json)try{const a=JSON.parse(e.json);i=a.code,(0,o.yw9)("OfficeVSO_9748131_ASHAErrorLoggingForAugLoopLicensingErrors")&&(l=a.reason),t=a.tabularRangeUnsupportedFeatureSkillFailures,n=a.unsupportedContextFeatures,(0,o.ZAR)()&&(r=a.inferredTableName)}catch(e){(0,a.cY)(a.SA.Error,"Failed to parse augloop error JSON: ",e)}return{errorCode:i,errorReason:l,tlrSkillSupport:t,contextFailures:n,inferredTableName:r}}},400665:(e,t,n)=>{"use strict";function a(e,t){const n=e.getDataBodyRange();return t?e.getHeaderRowRange().getBoundingRect(n):n}function o(e){const t=e.getUsedRangeOrNullObject().getCell(0,0).load(["rowIndex","columnIndex"]),n=e.getUsedRangeOrNullObject().getLastColumn().getCell(0,0).load(["rowIndex","columnIndex"]),a=e.getUsedRangeOrNullObject().getLastRow().getCell(0,0).load(["rowIndex","columnIndex"]),o=e.getRange().getLastCell().load(["rowIndex","columnIndex"]);return()=>t.columnIndex-2>=0?t.getOffsetRange(0,-2):t.rowIndex-2>=0?t.getOffsetRange(-2,0):n.columnIndex+2<=o.columnIndex?n.getOffsetRange(0,2):a.rowIndex+2<=o.rowIndex?a.getOffsetRange(2,0):null}n.d(t,{U2:()=>a,wZ:()=>o})},402488:(e,t,n)=>{"use strict";n.d(t,{Q0:()=>s,hs:()=>c,y3:()=>a});var a,o=n(83437),r=n(75496),i=n(316904),l=n(857677);!function(e){e.scriptNotFound="scriptNotFound",e.unknownScheduleType="unknownScheduleType"}(a||(a={}));class s extends Error{constructor(e,t){super(e),this.isOfficeScriptSkillHandlerError=!0,this.errorType=t}}const c=(e,t,n)=>{const a=i.M.getInstance(),s={eventType:r.S2.OfficeScriptSkillHandler,errorMessage:e.message,logLevel:o.$b.ASHA},c=e.isOfficeScriptSkillHandlerError?e.errorType:void 0,d=[{key:l.ib.OperationType,value:t},{key:l.ib.ErrorMessage,value:e.message},{key:l.ib.RequestId,value:n},...c?[{key:l.ib.ErrorType,value:c}]:[]];a.logError(s,void 0,d)}},402769:(e,t,n)=>{"use strict";n.d(t,{jy:()=>T,I:()=>S,TQ:()=>x,fS:()=>w});var a=n(279395),o=n(622998),r=n(13161),i=n(823860),l=n(551896),s=n(762030),c=n(402488),d=n(109174),u=n(963491),m=n(514450),g=n(540287),h=n(83437),p=n(75496),b=n(316904),f=n(857677);const C=255,y=1;var v,T;async function x(e,t){const n=s.H.getInstance().getScripts();if(0===n.length)throw new c.Q0("No script found in the office script cache layer.",c.y3.scriptNotFound);const a=n.find((t=>t.name===e));if(!a)throw new c.Q0("No matched script to run.",c.y3.scriptNotFound);try{const e=new l.L;return await e.getScript(a,t)}catch{throw new c.Q0("Something went wrong while fetching the script to run.",c.y3.scriptNotFound)}}async function S(e,t){let n,l=!1,s=[];try{const g=JSON.parse(e.statements),v=new o.K,T=await v.convert(g),x=[];for(const e of T){if(e.agent!==r.w2.OfficeScripts)throw new c.Q0("ODSL cannot be saved other than Office Script agent.");x.push(...e.items)}s=(0,u.yC)(x).filter((e=>e!==i.O.MissingIntent));const S=function(e,t){const n=(0,a.QbU)(),o=[];let r=e;const i=new RegExp(/^(\s*)$/g);r&&!i.test(r)||(o.push("empty"),r=n);const l=new RegExp(/(["&%*:<>?/\\|.])/g);r.match(l)&&(o.push("invalid character"),r=r.replaceAll(l,""));const s=new RegExp(/(^((\.lock)|(CON)|(PRN)|(AUX)|(NUL)|(COM\d{1})|(LPT\d{1})|(desktop.ini))$)|(_vti_)|^~(\$)?/g);r.match(s)&&(o.push("invalid file name"),r=r.replaceAll(s,""));const c=new RegExp(/(table|Table)\s*\d+/g);r.match(c)&&(o.push("contains numbered table"),r=r.replaceAll(c,"Table"));const d=r.trim();if(d!==r&&(o.push("ends in whitespace"),r=d),r.length<y&&(o.push("too short"),r=n),r.length>C&&(o.push("too long"),r=r.substring(0,C)),0!==o.length){const e=[{key:f.ib.ErrorMessage,value:o.toString()},{key:f.ib.RequestId,value:t}];b.M.getInstance().logError({eventType:p.S2.OfficeScriptsRename,errorMessage:"",logLevel:h.$b.Warning},void 0,e)}return r}(e.scriptNameToSave,t),w=d.CP.getActiveTable();let E;w&&(0,d.En)(w)&&(E=w.name);const I=await(0,m.V)(x,S,s.join("\n"),E,a.U2P);if(!I.storageScript.body||!I.storageScript.description)throw new c.Q0("Script body or description is undefined when saving a script.");n={...I.storageScript,...I.localUpdates,body:I.localUpdates.body,description:I.storageScript.description},l=!0}catch(e){(e.isOfficeScriptSkillHandlerError||e.isExecutorError||e.isConverterError)&&(0,c.hs)(e,"save_script",t)}return{success:l,intents:s,scriptToSave:n}}async function w(e,t){let n;try{const a=s.H.getInstance(),o=new l.L;n=await o.saveCopilotScript(e,t),a.pushScript(n),(0,g.q)({operationName:"Publish",scriptMetadata:n})}catch(e){const n=new c.Q0("Something went wrong while saving the script.");(0,c.hs)(n,"save_script",t)}return n}!function(e){e.Empty="empty",e.TooLong="too long",e.TooShort="too short",e.InvalidCharacter="invalid character",e.InvalidFileName="invalid file name",e.EndsInWhitespace="ends in whitespace",e.ContainsNumberedTable="contains numbered table"}(v||(v={})),function(e){e.Recurrence="recurrence"}(T||(T={}))},412339:e=>{"use strict";var t={};e.exports=function(e,n){var a=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(n)}},414542:(e,t,n)=>{"use strict";n.d(t,{T:()=>b,o:()=>f});var a=n(178365),o=n(705147),r=n(16244),i=n(857677),l=n(83437),s=n(76872),c=n(75496),d=n(316904),u=n(883);const m=3e4,g=d.M.getInstance(),h=new Map,p=s.E.getInstance();async function b(e,t,n,i,s,c=m,d=void 0){try{const l=(0,o.p)();(0,u.debuglog)(`SENDING AWAITABLE SIGNAL: ${JSON.stringify(e)}`),a.$.getInstance().submitOperation({operation:e,workflowAnnotationType:s});const m=setTimeout((()=>{C({id:t,body:{requestId:t,error:{errorCode:r.O.Timeout,errorMessage:`triggerSignalAndWaitForAnnotation Request timed out after ${c} ms. request id ${t}`,...d||{}}}},t)}),c);if(h.has(t))throw new Error(`triggerSignalAndWaitForAnnotation: requestId ${t} already exists`);return h.set(t,{deferredPromise:l,requestId:t,timeoutId:m,telemetryEventType:n,latencyOperation:i,startTime:performance.now()}),l.promise}catch(e){throw g.logError({eventType:n,errorMessage:`Error while submitting signal. requestID: ${t}, error: ${e}`,logLevel:l.$b.Error}),e}}function f(e,t){C(e,t)}function C(e,t){const n=h.get(t);if(n){const a=function(e,t){h.delete(e),clearTimeout(t.timeoutId);const n=performance.now()-t.startTime;return p.logLatency(n,t.latencyOperation),n}(t,n);e.body&&"error"in e.body&&e.body.error?n.deferredPromise.reject(e.body):n.deferredPromise.resolve(e.body),g.logEvent((0,i.P1)(n.telemetryEventType,{[c.IC.RequestId]:t,[c.IC.ExecutionTime]:a,[c.IC.Success]:!(e instanceof Error),[c.IC.Error]:e instanceof Error?e.message:""}))}else g.logError({eventType:c.S2.Error,errorMessage:`Received annotation for unknown request ${t}`,logLevel:l.$b.Warning})}},418218:(e,t,n)=>{"use strict";n.d(t,{Q1:()=>p,gY:()=>b,i$:()=>s,oz:()=>c});var a=n(650444),o=n(500461),r=n(780866),i=n(210466),l=n(242660);const s=38,c=50;function d(e){return(0,r.n)({tablePreview:{marginTop:"12px",display:"flex"},numberRowColumn:{display:"flex",flexDirection:"column","& > :first-child":{...i.Pt.borderTop("1px","solid",e.borderColor),borderStartStartRadius:"4px"},"& > :last-child":{borderEndStartRadius:"4px",...i.Pt.borderBottom("1px","solid",e.borderColor)}},dataColumn:{display:"flex",flexDirection:"column",...i.Pt.flex(1),...i.Pt.borderTop("1px","solid",e.borderColor),...i.Pt.borderBottom("1px","solid",e.borderColor),"& > :nth-child(2n+3)":{backgroundColor:e.dataBackgroundOdd},"&:last-child > *":{borderInlineEndWidth:"1px",borderInlineEndStyle:"solid",borderInlineEndColor:e.borderColor},"&:last-child":{borderStartEndRadius:"4px",borderEndEndRadius:"4px"}},numberRowCell:{display:"flex",alignItems:"center",justifyContent:"center",height:"20px",...i.Pt.border("1px","solid",e.borderColor),...i.Pt.borderTop(0),backgroundColor:e.rowColCellBackground,"& > *":{...i.Pt.overflow("hidden"),whiteSpace:"nowrap",textOverflow:"ellipsis",...i.Pt.padding("2px","4px"),...l.g.caption1,color:o.k1.colorNeutralForeground3}},dataColumnsContainer:{display:"flex",flexGrow:1,overflowX:"auto",overflowY:"hidden"},lastDataColumn:{"& > :first-child":{borderStartEndRadius:"4px"},"& > :last-child":{borderEndEndRadius:"4px"}},dataCell:{height:"20px",display:"flex",alignItems:"center",...i.Pt.borderBottom("1px","solid",e.dataBorderHorizontalColor),borderInlineEndWidth:"1px",borderInlineEndStyle:"solid",borderInlineEndColor:e.dataBorderVerticalColor,backgroundColor:e.dataBackgroundEven,"&:last-child":{...i.Pt.borderBottom("0px")}},dataCellTotal:{boxShadow:`0 0px 0 0 ${e.dataBorderHorizontalColor} inset, 0 1px 0 0 ${e.rowColCellBackground} inset, 0 2px 0 0 ${e.dataBorderHorizontalColor} inset`,"&:last-child":{backgroundColor:e.totalRowBackground}},contentDataCellTotal:{...l.g.caption1Strong},contentDataCell:{whiteSpace:"nowrap",textOverflow:"ellipsis",color:o.k1.colorNeutralForeground1,...i.Pt.padding("2px","4px"),...i.Pt.overflow("hidden"),...l.g.caption1},headerCell:{...i.Pt.borderColor(e.borderColor),borderInlineEndWidth:"1px",borderInlineEndStyle:"solid",borderInlineEndColor:e.borderColor,backgroundColor:e.rowColCellBackground,justifyContent:"center",color:o.k1.colorNeutralForeground3,"& > *":{color:o.k1.colorNeutralForeground3}},headerCellBeforeSkip:{marginInlineEnd:"1px"},headerCellAfterSkip:{borderInlineStartStyle:"solid",borderInlineStartWidth:"1px"},columnTitleCell:{backgroundColor:e.titleBackground,"& > *":{color:e.titleForeground,...l.g.caption1Strong}}})}const u=d({rowColCellBackground:o.k1.colorNeutralBackground2,titleBackground:o.k1.colorCompoundBrandBackground,titleForeground:o.k1.colorNeutralForegroundInverted,dataBackgroundOdd:o.k1.colorBrandBackground2,dataBackgroundEven:o.k1.colorNeutralBackground1,totalRowBackground:o.k1.colorNeutralBackground1,borderColor:o.k1.colorNeutralStroke2,dataBorderVerticalColor:o.k1.colorBrandStroke2,dataBorderHorizontalColor:o.k1.colorBrandStroke2}),m=d({rowColCellBackground:o.k1.colorNeutralBackground4,titleBackground:o.k1.colorNeutralBackground6,titleForeground:o.k1.colorNeutralForeground1,dataBackgroundOdd:"unset",dataBackgroundEven:"unset",totalRowBackground:"unset",borderColor:o.k1.colorNeutralStroke1Selected,dataBorderVerticalColor:o.k1.colorNeutralStroke1,dataBorderHorizontalColor:o.k1.colorNeutralStroke1}),g=d({rowColCellBackground:o.k1.colorNeutralBackground3,titleBackground:o.k1.colorNeutralBackground6,titleForeground:o.k1.colorNeutralForeground1,dataBackgroundOdd:o.k1.colorNeutralBackground1,dataBackgroundEven:o.k1.colorNeutralBackground1,totalRowBackground:o.k1.colorNeutralBackground1,borderColor:o.k1.colorNeutralStroke1Selected,dataBorderVerticalColor:o.k1.colorNeutralStroke1,dataBorderHorizontalColor:o.k1.colorNeutralStroke1}),h=d({rowColCellBackground:"lightgreen",titleBackground:o.k1.colorCompoundBrandBackground,titleForeground:o.k1.colorNeutralForegroundInverted,dataBackgroundOdd:"lightblue",dataBackgroundEven:"deepskyblue",totalRowBackground:"green",borderColor:"red",dataBorderVerticalColor:"yellow",dataBorderHorizontalColor:"pink"});var p;function b(e){const t=g(),n=u(),o=(h(),m());switch(e){case 1:case 3:return t;case 2:return o;case 0:return n;default:return(0,a.x)(e)}}!function(e){e[e.grid=0]="grid",e[e.neutral=1]="neutral",e[e.neutralV2=2]="neutralV2",e[e.crazy=3]="crazy"}(p||(p={}))},420748:(e,t,n)=>{"use strict";n.d(t,{U:()=>a});var a=new(function(){function e(e){this.value=e,this.listeners=new Set}return e.prototype.subscribe=function(e){var t=this;return this.listeners.add(e),function(){return t.listeners.delete(e)}},e.prototype.setValue=function(e){this.value!==e&&(this.value=e,this.listeners.forEach((function(t){return t(e)})))},e.prototype.getValue=function(){return this.value},e}())({iteration:0})},420988:(e,t,n)=>{"use strict";n.d(t,{U:()=>s,_:()=>c});var a=n(616166),o=n(83437),r=n(857677),i=n(75496),l=n(316904);function s(e,t,n){return l.M.getInstance().runTimedAsyncFunction("GetIsCellsEmptyInTotalRow",(()=>async function(e,t,n){try{const{sheetName:n}=t;if(!n)throw new Error("getIsCellsEmpty: sheetName is undefined");return await async function(e,t,n){return Excel.run((async a=>{const{rowCount:o,rowIndex:r,columnIndex:i,columnCount:l}=e,{range:s,columnOffset:c}=function(e,t,n,a,o,r,i){const l=i.workbook.worksheets.getItem(o);if(1===r.length)return{range:l.getRangeByIndexes(n+e,a+r[0],1,1),columnOffset:r[0]};if(r.every(((e,t,n)=>0===t||e===n[t-1]+1)))return{range:l.getRangeByIndexes(n+e,a+r[0],1,r.length),columnOffset:r[0]};return{range:l.getRangeByIndexes(n+e,a,1,t),columnOffset:0}}(o,l,r,i,t,[...new Set(n.flat())].sort(((e,t)=>e-t)),a);return s.load("valueTypes"),await a.sync(),n.map((e=>e.map((e=>s.valueTypes[0][e-c]===Excel.RangeValueType.empty)).every((e=>e))))}))}(t,n,e)}catch(e){return void l.M.getInstance().logErrorCode(a.O.CalculatedCellsGetIsTotalRowCellsEmptyFailed,e,i.S2.FormulaGeneration,o.$b.Warning,{key:r.un.SuggestionID,value:n})}}(e,t,n)),n)}async function c(e,t){return 0===t.length?[]:Excel.run((async n=>{const a=n.workbook.worksheets.getItem(e),o=t.map((e=>a.getRange(e)));return o.forEach((e=>e.load("valueTypes"))),await n.sync(),o.map((e=>e.valueTypes[0][0]===Excel.RangeValueType.empty))}))}},423235:(e,t,n)=>{"use strict";n.d(t,{Y:()=>r});const a={isLine:!1,isPie:!1,isClustered:!1,hasDoughnutHoleSize:!1,hasGapWidth:!1,hasDataMarkers:!1,hasSeriesOverlap:!1},o={area:{...a},areaStacked:{...a},areaStacked100:{...a},barClustered:{...a,hasGapWidth:!0,hasSeriesOverlap:!0,isClustered:!0},barStacked:{...a,hasGapWidth:!0},barStacked100:{...a,hasGapWidth:!0},columnClustered:{...a,hasGapWidth:!0,hasSeriesOverlap:!0,isClustered:!0},columnStacked:{...a,hasGapWidth:!0},columnStacked100:{...a,hasGapWidth:!0},line:{...a,isLine:!0},lineStacked:{...a,isLine:!0},lineStacked100:{...a,isLine:!0},doughnut:{...a,isPie:!0,hasDoughnutHoleSize:!0},pie:{...a,isPie:!0},scatter:{...a,hasDataMarkers:!0},bubble:{...a},radar:{...a,isLine:!0},histogram:{...a}};function r(e){return o[e]}},423905:(e,t,n)=>{"use strict";n.d(t,{CI:()=>g,IT:()=>u,YI:()=>d,Zy:()=>s,d_:()=>p,jC:()=>f,js:()=>b,mQ:()=>l,pN:()=>c,ys:()=>h});var a=n(83437),o=n(660606),r=n(426689),i=function(){var e=0,t=n(831922);if(void 0!==(null==t?void 0:t.querySubmitTime))return e=t.querySubmitTime;var a=n(422019);return void 0!==(null==a?void 0:a.querySubmitTime)?e=a.querySubmitTime:e},l=function(e,t,n){var r;o.EG.sendErrorTelemetry(c(((r={})[a.IC.ErrorMessage]="".concat(e),r[a.IC.ErrorCategory]=a.S2.CLP,r[a.IC.ErrorCode]=t,r[a.IC.ErrorStack]=n,r)))},s=function(e){var t;o.EG.sendChatEventTelemetry(c(((t={})[a.h3.ChatEventType]=a.a5.OfficeJsApiCallForCLP,t[a.h3.ChatEventParameters]="CLP_OfficeJsApi : ".concat(e),t)))},c=function(e){return Object.keys(e).map((function(t){return{key:t,value:e[t]}}))};var d=function(e){return e||(e=a.CC.CopilotChat),JSON.stringify({featureName:e})};function u(e,t,n){var l,s;void 0===n&&(n=!0);var d={};if(t){o.EG.sendChatEventTelemetry(c(((l={})[a.h3.ChatEventType]=t.chatEventType,l[a.h3.ChatEventParameters]=t.chatEventParam,l[a.h3.ChatErrorType]=t.chatErrorType,l))),(s={})[a.CT.ErrorType]=a.T_.Client,s[a.CT.ErrorParameter]=t.chatEventType,s[a.CT.ErrorChatEventType]=t.chatEventType,s[a.CT.ErrorChatEventParameter]=t.chatEventParam,d=s;var u=t.ashaErrorDetails;u&&m(u)}e&&((0,o.cY)("User Perceived Latency :  ".concat((0,r.W)(i())," sec")),d[a.CT.UserPerceivedLatency]=(0,r.W)(i()),d[a.CT.IsQuerySuccess]=!1,o.EG.sendLatencyTelemetry(c(d),n))}function m(e){o.EG.logAshaErrorEvent(e.vetoName,e.errorString,e.featureName)}function g(e,t){return e+" "+t}var h=function(e){var t;o.EG.sendChatEventTelemetry(c(((t={})[a.h3.ChatEventType]=a.a5.ApiPluginDataReceived,t[a.h3.ChatEventParameters]=e.toString(),t)))},p=function(e){var t;o.EG.sendChatEventTelemetry(c(((t={})[a.h3.ChatEventType]=a.a5.MsgExtDataReceived,t[a.h3.ChatEventParameters]=e.toString(),t)))},b=function(e,t,n){var r;o.EG.sendLatencyTelemetry(c(((r={})[a.CT.FeatureName]="ExtensibilityDialogLoad",r[a.CT.UserPerceivedLatency]=e,r[a.CT.IsQuerySuccess]=t,r[a.CT.ErrorChatEventType]=t?"":a.a5.ExtensibilityDialogLoad,r[a.CT.ErrorChatEventParameter]=t?"":n,r)),!0)},f=function(e){var t;o.EG.sendErrorTelemetry(c(((t={})[a.IC.ErrorMessage]=e,t[a.IC.ErrorCategory]=a.S2.ExtensibilityDialog,t[a.IC.ErrorCode]="ExtensibilityDialogLoadError",t)))}},425903:(e,t,n)=>{"use strict";n.d(t,{SL:()=>h,Xh:()=>f,a2:()=>b,q1:()=>g});var a=n(702864),o=n(507628),r=n(708353),i=n(86940),l=n(293879),s=n(423905),c=n(660606),d=n(83437),u=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{s(a.next(e))}catch(e){r(e)}}function l(e){try{s(a.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((a=a.apply(e,t||[])).next())}))},m=function(e,t){var n,a,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(n=1,a&&(o=2&l[0]?a.return:l[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,l[1])).done)return o;switch(a=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,a=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],a=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},g=function(e){return u(void 0,void 0,void 0,(function(){return m(this,(function(t){switch(t.label){case 0:return e&&a.xP.getCurrentAddinState()===a.aB.HasAction?[4,e()]:[3,2];case 1:t.sent(),a.xP.transitionAddinState(a.aB.Idle),t.label=2;case 2:return[2]}}))}))},h=function(e){try{var t=JSON.parse(e);if(p(t))return{id:(0,o.A)(),type:"text/adaptivecardtemplate",data:e,description_for_model:e}}catch(e){}return{id:(0,o.A)(),type:"text/plain",data:e,description_for_model:e}},p=function(e){return!(!e||"object"!=typeof e)&&("type"in e&&"AdaptiveCard"===e.type&&("body"in e&&"object"==typeof e.body))};function b(e,t,n){void 0===t&&(t=!0),void 0===n&&(n=!0);var a={shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:r.O.Footer,showAnimation:!1,isFailure:!0,telemetryData:void 0},o={chatCardType:i._.Default,chatMessageData:{defaultMessageProps:{user:l.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:a,stopLoadingUi:n,startAugloopTimerForStreaming:!1,addCardToChatHistory:t};return(0,c.cY)("Add in invocation error response message: ".concat(o)),o}function f(e){var t;c.EG.sendErrorTelemetry((0,s.pN)(((t={})[d.IC.ErrorCategory]=d.S2.LocalAddinActionExecution,t[d.IC.ErrorMessage]=e,t))),(0,c.cY)("Error executing client skill from TriggerPlugin message: \n",e)}},426689:(e,t,n)=>{"use strict";n.d(t,{W:()=>a,x:()=>o});var a=function(e){return o(e)/1e3},o=function(e){return(new Date).getTime()-e}},429257:(e,t,n)=>{"use strict";n.d(t,{s:()=>u});var a=n(818067);class o{invokeNative(e){OfficeFirstParty.PrivateApi.execute(JSON.stringify(e))}constructor(){this.RekaConstants={}}}var r=n(534756),i=n(92520);r.ft.registerTypeInfos({"Excel::Copilot::DataShapingPrivateSdxApiTransformationStep":{name:"$string",script:"$string"}});const l={IDataShapingPrivateSdxApiService:["Excel::Copilot::IDataShapingPrivateSdxApiService",{startPreview:["ReturnsPromiseMethod","$any",["$string","$string","$string"],{}],endPreview:["ReturnsPromiseMethod","$any",["$string"],{}],appendSteps:["ReturnsPromiseMethod","$any",[["$array","Excel::Copilot::DataShapingPrivateSdxApiTransformationStep"]],{}],removeStep:["ReturnsPromiseMethod","$any",["$string"],{}],getQueryScript:["ReturnsPromiseMethod","$string",[],{}],updateQueryScript:["ReturnsPromiseMethod","$any",["$string"],{}],showErrorMessage:["ReturnsPromiseMethod","$any",["$string"],{}],onQueryScriptChanged:["Event","$string"],onPreviewClosed:["Event","$string"]}]};r.ft.registerTypeInfos({"Excel::Copilot::AddQueryResultSuccess":{kind:"$string",actualQueryName:"$string"},"Excel::Copilot::AddQueryResultFail":{kind:"$string",error:"$string"},"Excel::Copilot::AddStepResultSuccess":{kind:"$string",actualStepName:"$string"},"Excel::Copilot::AddStepResultFail":{kind:"$string",error:"$string"}});const s={IPowerQueryPrivateSdxApiService:["Excel::Copilot::IPowerQueryPrivateSdxApiService",{showEditor:["ReturnsPromiseMethod","$any",[],{}],addQuery:["ReturnsPromiseMethod",["$union",["Excel::Copilot::AddQueryResultSuccess","Excel::Copilot::AddQueryResultFail"]],["$string","$string","$boolean"],{}],appendStep:["ReturnsPromiseMethod",["$union",["Excel::Copilot::AddStepResultSuccess","Excel::Copilot::AddStepResultFail"]],["$string","$string","$string"],{}],onCommit:["Event","$string"],onCancel:["Event","$any"]}]},c={IPythonAAPrivateSdxApiService:["Excel::Copilot::IPythonAAPrivateSdxApiService",{showTeachingCalloutScenario:["ReturnsPromiseMethod","$any",["$string"],{}]}]};class d{constructor(e){this._factory=e}get value(){return void 0===this._value&&(this._value=this._factory()),this._value}}class u{static getInstance(){return u.excelSdxPrivateApi||(u.excelSdxPrivateApi=new u),u.excelSdxPrivateApi}get NativeServices(){return this.nativeServices}async initializePrivateApi(){await this.appChatPrivateApi.initializePrivateApi(),this.rekaEnvironment.RekaInstance.initBridge(new o,[]),this.attachPrivateEventHandler("RekaBridgeMessage",(e=>{(0,i.cY)("PrivateApi response: "+e),this.rekaEnvironment?.RekaInstance.invokeJavaScript(e)}))}sendOnReadyEvent(e){const t={messageType:"commonPrivateApiEvent",eventName:e};this.appChatPrivateApi.execute(t)}attachPrivateEventHandler(e,t){this.appChatPrivateApi.attachPrivateEventHandler(e,t)}constructor(){var e;this.appChatPrivateApi=a.B.getInstance(),this.rekaEnvironment=(0,r.NU)(),this.nativeServices=(e=this.rekaEnvironment.RekaServiceRegistry,{IPythonAAPrivateSdxApiService:new d((()=>e.getNativeService(c.IPythonAAPrivateSdxApiService))),IPowerQueryPrivateSdxApiService:new d((()=>e.getNativeService(s.IPowerQueryPrivateSdxApiService))),IDataShapingPrivateSdxApiService:new d((()=>e.getNativeService(l.IDataShapingPrivateSdxApiService)))})}}},430459:(e,t,n)=>{"use strict";n.d(t,{$:()=>d,b:()=>s});var a=n(69614),o=n(92520),r=n(695934),i=n(207545),l=n(910480);const s="unknown";class c{constructor(e){this.activatedAnnotationTypes=new Map,this.releasedAnnotationTypes=new Map,this.annotationActivationStatus=new Map,this.clientSentMessages=new Map,this.annotationsReceived=new Map,this.connectionMessages=[],this.isActive=!0,this.sessionKey=e}}class d{static getInstance(){return d.instance||(d.instance=new d),d.instance}getSessionsMap(){return this.sessionsMap}registerUIUpdater(e){this.updateUi=e}isAugloopSessionActive(e){return void 0!==e?.getConnectParams()}async onWebSocketActivity(){this.isAugloopSessionActive(this.activeSession)?(await this.refreshSessionDiagnosticsData(),this.updatesFromAugloopCount++,this.updateUi()):(0,o.cY)(o.SA.Info,"AugloopDiagnosticsManager.onWebSocketActivity: not sending request as augloop session is inactive.")}async syncCachedActiveSessionKey(){const e=this.getActiveSessionKeyFromConnectPramas();e!==this.cachedActiveSessionKey&&(this.createSessionDiagnosticsEntryIfNotExists(e),await this.refreshSessionDiagnosticsData())}getActiveSessionKey(){return this.debouncedSyncCachedActiveSessionKey(),this.cachedActiveSessionKey}setActiveSessionKey(e){this.cachedActiveSessionKey=e}setActiveSession(e){this.activeSession=e}getActiveSession(){return this.activeSession}init(e){if(!(0,i.I_)())return void(0,o.cY)(o.SA.Error,"AugloopDiagnosticsManager.init: Not initializing in dogfood or dev build or without feature flag");this.setActiveSession(e);const t=this.getActiveSessionKeyFromConnectPramas();this.createSessionDiagnosticsEntryIfNotExists(t);const n=e;n.messageBridge={...n.messageBridge,originalSendMessage:n.messageBridge.sendMessage},n.originalHandleSessionInitResponse=n.handleSessionInitResponse,n.handleSessionInitResponse=e=>{this.onSessionInitResponse(e),n.originalHandleSessionInitResponse(e)},n.originalHandleAnnotationResults=n.handleAnnotationResults,n.handleAnnotationResults=(e,t)=>{this.onAnnotationReceived(e,t),n.originalHandleAnnotationResults(e,t)},n.messageBridge.sendMessage=e=>{this.blockAnnotationReleaseMessageEnabled&&this.isAnnotationReleaseMessage(e)||(this.onSendMessage(e),n.messageBridge.originalSendMessage(e))},n.originalHandleSessionCloseMessage=n.handleSessionCloseMessage,n.handleSessionCloseMessage=e=>{this.onSessionCloseMessage(e),n.originalHandleSessionCloseMessage(e)},n.originalHandleSessionConnectMessage=n.handleSessionConnectMessage,n.handleSessionConnectMessage=e=>{this.onSessionConnectMessage(e),n.originalHandleSessionConnectMessage(e)},n.originalHandleSessionReconnectMessage=n.handleSessionReconnectMessage,n.handleSessionReconnectMessage=e=>{this.onSessionReconnectMessage(e),n.originalHandleSessionReconnectMessage(e)},n.originalHandleSessionDisconnectMessage=n.handleSessionDisconnectMessage,n.handleSessionDisconnectMessage=e=>{this.onSessionDisconnectMessage(e),n.originalHandleSessionDisconnectMessage(e)}}isAnnotationReleaseMessage(e){return e.includes(a.GA.getTypeName())}getActiveSessionKeyFromConnectPramas(){const e=this.getActiveSession()?.getConnectParams(),t=e?.sessionUrl.split("/").pop();return t??s}async retrieveModelFromAugloop(){const e=this.getActiveSession();if(!this.isAugloopSessionActive(e))return(0,o.cY)(o.SA.Info,"AugloopDiagnosticsManager.onWebSocketActivity: not sending request as augloop session is inactive."),Promise.reject(new Error("No active session found"));const t=await e.submitCustomMessage(new r.IW);return 0===t.itemsCount?Promise.reject(new Error("Failed to retrieve model. No items found in the model response")):t}async retrieveSessionDiagnosticsFromAugloop(){const e=this.getActiveSession();return e?e.submitCustomMessage(new r.pw):Promise.reject(new Error("No active session found"))}async refreshSessionDiagnosticsData(){this.sessionsMap.forEach((e=>{e.isActive=!1}));try{const e=await this.retrieveSessionDiagnosticsFromAugloop();if(void 0===e||void 0===e.sessionKey)throw new Error("sessionKey not found in response");const t=e.sessionKey;this.createSessionDiagnosticsEntryIfNotExists(t);const n=this.sessionsMap.get(t);if(!n)throw new Error("diagnosticsSession not found for sessionKey");n.isActive=!0,n.sessionKey=e.sessionKey,n.clientMetadata=e.clientMetadata,n.sessionMode=e.sessionMode,n.isCopilotLicensed=e.isCopilotLicensed,n.isCopilotActivated=e.isCopilotActivated,n.activatedAnnotationTypes=new Map(JSON.parse(e.activatedAnnotations)),n.releasedAnnotationTypes=new Map(JSON.parse(e.releasedAnnotations)),n.annotationActivationStatus=new Map(JSON.parse(e.annotationStatus)),n.annotationsReceived=new Map(JSON.parse(e.sentAnnotations)),n.clientSentMessages=new Map(JSON.parse(e.clientSubmittedMessages)),n.isLargeWorkbookSession=e.isLargeWorkbookSession,n.observerSessionType=e.observerSessionType,n.ecsSessionId=e.ecsSessionId,n.ecsStateId=e.ecsStateId}catch(e){(0,o.cY)(o.SA.Error,"AugloopDiagnosticsManager.refreshSessionDiagnosticsData: error:",e)}}onSessionInitResponse(e){if(!this.autoRefreshEnabled)return;this.createSessionDiagnosticsEntryIfNotExists(e.sessionKey);this.sessionsMap.get(e.sessionKey).sessionInitResponse=e,this.storeConnectivityMessage(e),this.debouncedOnWebSocketActivity()}onSendMessage(e){this.autoRefreshEnabled&&(e.includes(r.pw.getTypeName())||e.includes(r.Lm.getTypeName())||this.debouncedOnWebSocketActivity())}onAnnotationReceived(e,t){this.autoRefreshEnabled&&this.debouncedOnWebSocketActivity()}onSessionDisconnectMessage(e){this.handleConnectivityMessage(e)}onSessionReconnectMessage(e){this.handleConnectivityMessage(e)}onSessionConnectMessage(e){this.handleConnectivityMessage(e)}onSessionCloseMessage(e){this.handleConnectivityMessage(e)}handleConnectivityMessage(e){this.storeConnectivityMessage(e),this.autoRefreshEnabled&&this.debouncedOnWebSocketActivity()}storeConnectivityMessage(e){if(JSON.stringify(e).includes(a.uN.getTypeName())){const t=e.sessionKey;this.createSessionDiagnosticsEntryIfNotExists(t)}const t=this.getActiveSessionKey(),n=this.sessionsMap.get(t);n?n.connectionMessages.unshift(JSON.stringify(e)):(0,o.cY)(o.SA.Error,"AugloopDiagnosticsManager.storeConnectivityMessage: sessionKey not found in sessions collection")}createSessionDiagnosticsEntryIfNotExists(e){e!==this.cachedActiveSessionKey&&(this.cachedActiveSessionKey===s&&this.sessionsMap.has(s)?(this.sessionsMap.set(e,this.sessionsMap.get(s)),this.sessionsMap.delete(s)):this.sessionsMap.set(e,new c(e)),this.setActiveSessionKey(e))}constructor(){this.debounceIntervalForOnWebSocketActivityMs=2e3,this.debounceIntervalForSyncingActiveSessionKeyMs=5e3,this.sessionsMap=new Map,this.cachedActiveSessionKey=s,this.updatesFromAugloopCount=0,this.autoRefreshEnabled=!1,this.blockAnnotationReleaseMessageEnabled=!1,this.updateUi=()=>{},this.debouncedOnWebSocketActivity=(0,l.debounce)(this.onWebSocketActivity,this.debounceIntervalForOnWebSocketActivityMs,{leading:!0,trailing:!0}),this.debouncedSyncCachedActiveSessionKey=(0,l.debounce)(this.syncCachedActiveSessionKey,this.debounceIntervalForSyncingActiveSessionKeyMs,{leading:!0,trailing:!1})}}},432874:(e,t,n)=>{"use strict";n.d(t,{D:()=>o});var a=n(638753),o=function(e,t,n){var o,r,i,l;return!!(null===(r=null===(o=null==e?void 0:e.chatResponse)||void 0===o?void 0:o.messages)||void 0===r?void 0:r.find((function(e){return(0,a._H)(e)})))&&(!!t&&(!!n||(null===(l=null===(i=null==e?void 0:e.chatResponse)||void 0===i?void 0:i.messages)||void 0===l?void 0:l.find((function(e){return((null==e?void 0:e.gptIdentifiers)||[]).length>0})))))}},439573:(e,t,n)=>{"use strict";n.d(t,{W:()=>b});var a=n(279395),o=n(57848),r=n(775623),i=n(879162),l=n(661588),s=n(208520);const c=e=>s.createElement("svg",{width:"16",height:"16",viewBox:"0 0 2048 2048",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M 512.0,731.0 L 658.0,731.0 Q 702.0,731.0 742.0,747.5 Q 782.0,764.0 813.0,795.0 Q 845.0,826.0 861.5,866.0 Q 878.0,906.0 878.0,950.0 Q 878.0,994.0 861.5,1034.0 Q 845.0,1074.0 813.0,1105.0 Q 782.0,1136.0 742.0,1152.5 Q 702.0,1169.0 658.0,1169.0 L 585.0,1169.0 L 585.0,1389.0 Q 585.0,1420.0 564.0,1441.0 Q 541.0,1462.0 512.0,1462.0 Q 483.0,1462.0 460.0,1441.0 Q 439.0,1420.0 439.0,1389.0 L 439.0,804.0 Q 439.0,773.0 460.0,752.0 Q 481.0,731.0 512.0,731.0 M 585.0,1023.0 L 658.0,1023.0 Q 687.0,1023.0 710.0,1002.0 Q 731.0,981.0 731.0,950.0 Q 731.0,919.0 710.0,898.0 Q 687.0,877.0 658.0,877.0 L 585.0,877.0 L 585.0,1023.0 M 1668.0,848.0 L 1463.0,1120.0 L 1463.0,1389.0 Q 1463.0,1419.0 1441.0,1441.0 Q 1420.0,1462.0 1390.0,1462.0 Q 1361.0,1462.0 1338.0,1441.0 Q 1317.0,1420.0 1317.0,1389.0 L 1317.0,1120.0 L 1112.0,848.0 Q 1104.0,838.0 1099.0,822.0 Q 1097.0,814.0 1096.5,807.5 Q 1096.0,801.0 1098.0,793.0 Q 1099.0,780.0 1107.0,766.0 Q 1111.0,760.0 1116.0,755.0 Q 1121.0,750.0 1126.0,745.0 Q 1138.0,737.0 1152.0,733.0 Q 1166.0,729.0 1181.0,731.0 Q 1211.0,736.0 1229.0,760.0 L 1390.0,974.0 L 1551.0,760.0 Q 1568.0,736.0 1599.0,731.0 Q 1613.0,729.0 1627.5,733.0 Q 1642.0,737.0 1653.0,745.0 Q 1677.0,763.0 1682.0,793.0 Q 1685.0,823.0 1668.0,848.0 M 439.0,292.0 L 146.0,292.0 L 146.0,1901.0 L 439.0,1901.0 L 439.0,2047.0 L 0.0,2047.0 L 0.0,145.0 L 439.0,145.0 L 439.0,292.0 M 1609.0,1901.0 L 1902.0,1901.0 L 1902.0,292.0 L 1609.0,292.0 L 1609.0,145.0 L 2048.0,145.0 L 2048.0,2047.0 L 1609.0,2047.0 L 1609.0,1901.0",fill:e.theme.black,stroke:e.theme.black}));var d=n(79105),u=n(468967),m=n(347145),g=n(469486),h=n(312422),p=n(887648);function b(e){const t=(0,p.wA)(),{styles:n,linkTheme:b,requestId:f,code:C,output:y,outputType:v,isPythonOutputCollapsable:T,codeExplanation:x,codeLabel:S,isLargeOutput:w,tableHasHeader:E}=e,I=!y||!v||'""'===y,[R,A]=s.useState(!1),L=(0,m.DBQ)()?(0,s.useMemo)((()=>({shouldFocusOnMount:!0,items:[{key:"Python formula",text:(0,a.o7M)(),secondaryText:(0,a.lL1)(),onClick:()=>{!function(e){try{(0,h.F5)((async t=>{const n=t.workbook.worksheets.add();n.activate();const a=n.getRange("A1"),o=(0,g.ZK)(e,!0,0);a.values=[[o]],await t.sync()}))}catch(e){const n=(0,u.GI)(e);(0,u.Kx)(t,n,"pythonCollapsableCodeOnClick",!1)}}(C)}}]})),[C]):void 0;return s.createElement(s.Fragment,null,s.createElement("div",{style:{display:"flex",alignItems:"center",marginTop:"8px",marginBottom:"8px"}},s.createElement(c,{theme:b}),s.createElement(d.f,{"aria-roledescription":(0,a.qcV)(),checked:R,size:"small",appearance:"transparent",iconPosition:"after",onClick:()=>{A(!R)},className:n.showPythonCodeToggleButtonStyle,icon:R?s.createElement(o.g4$,{className:n.showPythonCodeToggleButtonStyle}):s.createElement(o.rLf,{className:n.showPythonCodeToggleButtonStyle})},s.createElement("span",{className:n.showPythonCodeToggleButtonStyle},R?(0,a.Lw5)():(0,a.gU_)()," "))),R?s.createElement("div",{style:{margin:"10px 2px 16px"}},s.createElement(l.m,{requestId:f,code:C,codeExplanation:x,codeLabel:S})):null,(R||!T)&&(w&&(0,m.yw9)("OfficeVSO_10346383_AnswersShowLargeDataMessage")?s.createElement("div",{style:{paddingTop:"12px"}},s.createElement(i.e,{output:(0,a.pKU)(),outputType:i.z.String,tableHasHeader:E})):I?null:s.createElement("div",{style:{paddingTop:"12px"}},s.createElement("p",{className:n.outputText},(0,a.V8T)()),s.createElement(i.e,{output:y,outputType:v,tableHasHeader:E}))),(0,m.DBQ)()?s.createElement(r.Y,{text:(0,a.J40)(),menuProps:L}):null)}},446751:(e,t,n)=>{"use strict";n.d(t,{VS:()=>U,mZ:()=>ve,Ft:()=>Ce,JM:()=>X,Ys:()=>be,jI:()=>ne,e1:()=>Z,hK:()=>ae,g0:()=>se,cY:()=>Q,$k:()=>j,iM:()=>G,L$:()=>z,be:()=>J,s9:()=>Y,fJ:()=>le,xw:()=>oe,gA:()=>K,fS:()=>te,wr:()=>ee,uq:()=>ye,aG:()=>Te,Fw:()=>ie,jL:()=>re});var a=n(639765),o=n(548366),r=n(596760),i=n(122409),l=n(384169),s=n(178365),c=n(616166),d=n(778685),u=n(279395),m=n(83437),g=n(1329),h=n(474353),p=n(12855),b=n(70239),f=n(857677),C=n(76872),y=n(75496),v=n(316904),T=n(819415),x=n(447773),S=n(659126),w=n(109174),E=n(92520),I=n(379510),R=n(347145),A=n(540084),L=n(996211),k=n(803716),F=n(650444),_=n(802484);class P extends Error{constructor(e){super(e),this.name="insertionModeError"}}class N extends Error{constructor(e){super(e),this.name="formulaMissingError"}}class M extends Error{constructor(e){super(e),this.name="rangeError"}}async function O(e,t,n){if(!t.fixedInsertionRange)throw new N("Formula missing required fixedInsertionRange property");const a=H(e.workbook.worksheets.getItem(n).getRange(t.fixedInsertionRange),t.insertionMode),{rows:o,cols:r}=(0,_.excelRangeToGridRange)((0,_.parseRangeAddress)(t.fixedInsertionRange,""));return 1===o&&1===r?await async function(e,t,n){t.formulasLocal=[[n.formula]],n.numberFormat&&(t.numberFormat=[[n.numberFormat]]);return await D(e,t,n.numberFormat),await e.sync(),t}(e,a,t):await async function(e,t,n,a,o){const r=t.getCell(0,0);r.formulasLocal=[[n.formula]],n.numberFormat&&(r.numberFormat=[[n.numberFormat]]);return await e.sync(),await D(e,r,n.numberFormat),await async function(e,t,n,a,o,r){if(a>1&&o>1){const e=n.getRow(0);t.autoFill(e),e.autoFill(n)}else t.autoFill(n);r.numberFormat&&(n.numberFormat=[[r.numberFormat]]);await e.sync()}(e,r,t,a,o,n),t}(e,a,t,o,r)}async function D(e,t,n){const a=t.getSpillingToRangeOrNullObject();if(a.load("isNullObject"),await e.sync(),!a.isNullObject)return n&&(a.numberFormat=[[n]],await e.sync()),a}async function B(e,t,n,a,o){if(n.includes(":"))throw new M("The cellAddress must be a single cell address, not a range");let r=e.workbook.worksheets.getItem(a).getRange(n);return r=H(r,o),r.values=[[t]],await e.sync(),r}async function $(e,t){return async function(e,t,n){return t.load(n),await e.sync(),t}(e,t,["address"])}function H(e,t){try{switch(t){case r.PH.ShiftDown:return e.insert(Excel.InsertShiftDirection.down);case r.PH.ShiftRight:return e.insert(Excel.InsertShiftDirection.right);case r.PH.OverrideFixedRange:case r.PH.ToTableWithOverride:case r.PH.ToTableWithoutOverride:case r.PH.OverrideSelection:case r.PH.InsertIntoEmptyCells:case void 0:return e;default:return(0,F.x)(t),e}}catch(e){throw new P(`Failed to apply insertion mode: ${e}`)}}var U,q=n(20847),V=n(667977),W=n(312422);function G(e){return 0===e.suggestionType}function z(e){return e.every(G)}function Q(e){return 1===e.suggestionType}function j(e){return e.every(Q)}function J(e){return 2===e.suggestionType}function Y(e){return e.every(J)}function X(e){return e.calculatedFormulas.flatMap((e=>e.insertionIndexes)).filter((e=>void 0!==e)).sort(((e,t)=>e-t))}async function Z(e){if(!(0,L.k8)(e))return;const t=Math.min(V.do+1,e.rowCount-(e.hasTableHeaders?1:0));return e.hasHiddenRows?Excel.run((async n=>{if(e.address){const a=n.workbook.worksheets.getItem(e.sheetName).getRange(e.address).getColumn(0).getVisibleView();a.load("cellAddresses"),await n.sync();const o=function(e,t,n){const a=e.split(",").slice(n.hasTableHeaders?1:0,t+(n.hasTableHeaders?1:0));return a.map((e=>{const t=e.match(/\d+$/);return t?parseInt(t[0],10):NaN}))}(a.cellAddresses.toString(),t,e);return o}})):Array.from({length:Math.min(t,e.rowCount-(e.hasTableHeaders?1:0))},((t,n)=>e.rowIndex+(e.hasTableHeaders?1:0)+(n+1)))}function K(e,t,n,a,o=!1,r){const{tableName:i,sheetName:l,address:s}=t;if(!i||!l||!s)return Promise.resolve();if((0,R.yw9)("OfficeVSO_9658083_enableInsertOverride")&&!r)return Promise.resolve();if(0===n.length)return Promise.resolve();const c=t.hasTableHeaders?[e,...n]:[];return Excel.run((async e=>{const n=o&&t.sheetId?e.workbook.worksheets.getItem(t.sheetId):e.workbook.worksheets.getActiveWorksheet();if(o)n.activate();else if(n.load("name"),await e.sync(),n.name!==l)return;const i=n.rangeValuesPreview;if(i.onDismissed.add(a),i.show((0,R.yw9)("OfficeVSO_9658083_enableInsertOverride")?r:(0,S.cc)(s)??s,c,{autoexpandTable:!0,autofitColumns:!0}),o){const t=n.getRange(r),a=t.getOffsetRange(0,(c[0]?.length??0)+1);await w.CP.runWithNoContextRefresh((async()=>{t.getBoundingRect(a).select(),await e.sync();t.getOffsetRange(0,-1).select(),await e.sync()}))}else await e.sync()}))}function ee(e,t,n,a,o=!1,r){if((0,R.yw9)("OfficeVSO_9753947_insertCellToFixedRange")&&!r)return Promise.resolve();const{tableName:i,sheetName:l,showTotals:s,address:c}=e;return i&&l&&c?0===t.length||void 0===n?Promise.resolve():Excel.run((async i=>{const d=o&&e.sheetId?i.workbook.worksheets.getItem(e.sheetId):i.workbook.worksheets.getActiveWorksheet();if(o)d.activate();else if(d.load("name"),await i.sync(),d.name!==l)return;const u=d.rangeValuesPreview,m=(0,R.yw9)("OfficeVSO_9753947_insertCellToFixedRange")&&r?r:(0,S.K3)(c,n)??c;if(u.onDismissed.add(a),u.show(m,[t],{autoexpandTable:!0,autofitColumns:!0}),o){const e=d.getRange(r);if(s)e.select(),await i.sync();else{const t=e.getOffsetRange(1,0),n=e.getOffsetRange(-1,0);await w.CP.runWithNoContextRefresh((async()=>{t.select(),await i.sync(),n.select(),await i.sync()}))}}else await i.sync()})):Promise.resolve()}function te(e,t,n){return 0===t.length?Promise.resolve():Excel.run((async a=>{const o=a.workbook.worksheets.getActiveWorksheet().rangeValuesPreview;o.onDismissed.add(n),o.show(e,t,{autoexpandTable:!0,autofitColumns:!0})}))}async function ne(e){const{rowIndex:t,rowCount:n,columnIndex:a,columnCount:o,sheetName:r}=e;if(!r)throw new Error("getRowValuesUnderneathTable: sheetName is undefined");return Excel.run((async e=>{const i=e.workbook.worksheets.getItem(r).getRangeByIndexes(t+n,a,1,o);return i.load("text"),await e.sync(),i.text[0]}))}function ae(e){return Excel.run((async t=>{(e?t.workbook.worksheets.getItem(e):t.workbook.worksheets.getActiveWorksheet()).rangeValuesPreview.dismiss(),await t.sync()}))}function oe(e,t,n,a,o){return v.M.getInstance().runTimedAsyncFunction("InsertColumn",(()=>async function(e,t,n,a,o){const r=[];try{if(!t.calculatedFormulas)return{insertionAddresses:r};let{calculatedFormulas:i}=t;const l=(0,L.UN)(t);let s;l&&(i=[...i],i.sort(((e,t)=>(e.insertionIndex??Number.MAX_SAFE_INTEGER)-(t.insertionIndex??Number.MAX_SAFE_INTEGER))));const c=[],d=new h.q("insertColumnApi");try{await(0,W.F5)((async e=>{for(let t=0;t<i.length;t++){const u=t,{address:m,selectedRange:g}=await de(i[t],n,a,u,s,c,e,o,d.withPrefix(`column${t}`));r.push(m),l||(s=g)}}),{operationTimers:d.withPrefix("undoScope")})}finally{C.E.getInstance().updateTelemetryChatEventData({[f.h3.ChatEventType]:f.a5.FormulaSuggestionInsertColumnTimings,[f.h3.ChatEventParameters]:JSON.stringify({requestId:e,recommendationId:t.id,timers:d.getAll()})},v.M.getInstance())}return{insertionAddresses:r}}catch(e){return{insertionAddresses:r,insertionError:e}}}(a,e,t,n,o)),a,e.id)}function re(e,t,n,r){return(0,R.yw9)("OfficeVSO_9546218_validatePreviewForRow")?v.M.getInstance().runTimedAsyncFunction("verifyCalcValueMatchesRowPreviewApi",(()=>async function(e,t,n,r){async function i(){let e=0,a=!1;const o=[];return await Excel.run({delayForCellEdit:!0},(async r=>{const{sheetName:i}=n;if(!i)throw new Error("Sheet name is undefined in selectionContext");const s=r.workbook.worksheets.getItem(i);for(let n=0;n<t.length;n++){const i=t[n],c=s.getRange(i);c.load("text, values"),await r.sync();const d=c.text[0];for(let t=0;t<d.length;t++)if(o.push(d[t]),d[t]!==l[e++]){a=!0;break}if(a)break}})),{isMismatch:a,gridTexts:o}}if(!e||0===e.length)return;t.sort(((e,t)=>(0,S.Jx)(e)-(0,S.Jx)(t)));const l=e[0],{isMismatch:s,gridTexts:d}=await i();if(s){const e=l.slice(0,d.length);v.M.getInstance().logStandardizedAshaErrorEvent(o.W.UI_Failed_To_Update_Or_Load,a.c.Mismatch_Between_Preview_And_Grid_Values,f.BJ.FormulaGeneration);const t=(0,S.sq)([e]),n=(0,S.sq)([d]);v.M.getInstance().logErrorCode(c.O.PreviewValidationFailed,new Error(`Preview value doesn't match the value on the grid. anonymized preview values: ${t}. anonymized grid values: ${n}`),y.S2.FormulaGeneration,m.$b.Warning,{key:f.un.SuggestionID,value:r})}}(e,t,n,r)),r):Promise.resolve()}function ie(e,t,n,r){return v.M.getInstance().runTimedAsyncFunction("VerifyCalcValueMatchesPreview",(()=>async function(e,t,n,r){async function i(e){return await Excel.run({delayForCellEdit:!0},(async a=>{const{sheetName:o,hasTableHeaders:r}=n,i=a.workbook.worksheets.getItem(o).getRange(t[0]),l=e.length-1,s=i.getCell(r?1:0,0).getResizedRange(l,0);s.load("text, values"),await a.sync();let c=!1;for(let t=0;t<l;t++)if(e[t][0]!==s.text[t][0]){c=!0;break}return{isMismatch:c,allZeroes:s.values.every((e=>0===e[0])),gridRangeValues:s.text}}))}async function l(){return await Excel.run({delayForCellEdit:!0},(async e=>(e.application.load("calculationMode"),await e.sync(),"Automatic"===e.application.calculationMode&&(e.application.calculate("Recalculate"),!0))))}if(!e||0===e.length)return;const s=Math.min(5,e.length),d=e.slice(0,s);let{isMismatch:u,allZeroes:g,gridRangeValues:h}=await i(d),p=!1;u&&g&&(p=await l(),p&&({isMismatch:u}=await i(d)));if(u){const e=/^#.+[?|!]$/,t=(0,S.sq)(d),n=(0,S.sq)(h);t.some((t=>e.test(t)))||n.some((t=>e.test(t)))||v.M.getInstance().logStandardizedAshaErrorEvent(o.W.UI_Failed_To_Update_Or_Load,a.c.Mismatch_Between_Preview_And_Grid_Values,f.BJ.FormulaGeneration),v.M.getInstance().logErrorCode(c.O.PreviewValidationFailed,new Error(`Preview value doesn't match the value on the grid. attempted recalc: ${p}. anonymized preview values: ${t}. anonymized grid values: ${n}`),y.S2.FormulaGeneration,m.$b.Warning,{key:f.un.SuggestionID,value:r})}}(e,t,n,r)),r)}async function le(e,t,n,a){return e.calculatedFormulas?(0,S.th)(e)?v.M.getInstance().runTimedAsyncFunction("InsertCellToSelection",(()=>async function(e){try{if(!e.isSingleFormula)throw new Error("insertCellToSelection: expected a single formula");const t=await(0,W.F5)((async t=>await ce(t,e.calculatedFormulas[0],t.workbook.getActiveCell())));return{insertionAddresses:t?[t]:[]}}catch(t){return v.M.getInstance().logErrorCode(c.O.InsertCalculatedCellToSelectionFailed,t,y.S2.FormulaGeneration,m.$b.Warning,{key:f.un.SuggestionID,value:e.id}),{insertionAddresses:[],insertionError:t}}}(e)),a,e.id):(0,S.By)(e)?v.M.getInstance().runTimedAsyncFunction("InsertCellToFixedRange",(()=>async function(e){try{const t=e.calculatedFormulas[0]?.fixedInsertionRange;if(!t)throw new Error("insertCellToFixedRange: first formula is missing or doesn't have a fixedInsertionRange");const n=(0,A.vt)(t),a=await(0,W.F5)((async t=>{const a=t.workbook.worksheets.getActiveWorksheet();return await ce(t,e.calculatedFormulas[0],a.getCell(n.row-1,n.column-1))}));return{insertionAddresses:a?[a]:[]}}catch(t){return v.M.getInstance().logErrorCode(c.O.InsertCalculatedCellToFixedRangeFailed,t,y.S2.FormulaGeneration,m.$b.Warning,{key:f.un.SuggestionID,value:e.id}),{insertionAddresses:[],insertionError:t}}}(e)),a,e.id):v.M.getInstance().runTimedAsyncFunction("InsertCell",(()=>async function(e,t){const n=[];let a,o=!1;try{const r=e.calculatedFormulas.flatMap((e=>{const t=(0,L.Ne)(e.insertionIndexes??[]),n=t.reduce(((e,t)=>e+t.length),0);if(!e.formulasToInsert||e.formulasToInsert.length!==n)throw new Error(`insertCellRecommendationApi: formula ${e.id} - formulasToInsert is not defined or has different length than insertionIndexes`);let a=0;return t.map((t=>({...e,insertionIndexes:t,formulasToInsert:t.map((()=>{const t=e.formulasToInsert?.[a]??e.formula;return a++,t}))})))})),i=new h.q("insertCellRecommendationApi");try{await(0,W.F5)((async l=>{t.showTotals||await i.measure("addEmptyRowIfNeededApi",async function(e,t,n){try{const{rowCount:e,rowIndex:a,columnIndex:o,sheetName:r,columnCount:i}=t;if(!r)throw new Error("addEmptyRowIfNeededApi: sheetName or showTotals are null or undefined");if(!n)throw new Error("addEmptyRowIfNeededApi: context is undefined");const l=await async function(e,t,n,a,o,r){const i=r.workbook.worksheets.getItem(o),l=i.getRangeByIndexes(n+e,a,1,t);l.load("valueTypes"),await r.sync();const s=(0,S.RV)(l);return s}(e,i,a,o,r,n);l||await async function(e,t,n,a,o,r){const i=e.workbook.worksheets.getItem(r);let l=i.getRangeByIndexes(a+t,o,1,n);return l=l.insert(Excel.InsertShiftDirection.down),l.clear(),l}(n,e,i,a,o,r)}catch(t){throw v.M.getInstance().logErrorCode(c.O.CalculatedCellPartialInsertFailed,t,y.S2.FormulaGeneration,m.$b.Warning,{key:f.un.SuggestionID,value:e}),t}}(e.id,t,l));for(let s=0;s<r.length;s++){const c=r[s],d=i.withPrefix(`formulaGroup:${s}`);try{const{address:a}=await ue(c,t,l,Boolean(t.showTotals&&e.allowReplacementOfExistingValue),d);n.push(a)}catch(e){a=e,o=!0}}if(e.insertRowTitle){const n=i.withPrefix("Title");await async function(e,t,n,a){a.start("total");try{return await async function(e,t){const{rowCount:n,rowIndex:a,columnIndex:o,sheetName:r}=e,i=t.workbook.worksheets.getItem(r),l=i.getRangeByIndexes(a+n,o,1,1);if(l.load("valueTypes"),await t.sync(),!(0,S.RV)(l))return;l.values=[[u.olU.CalculatedRowsFormulaTotalHeader]],await t.sync()}(t,n)}catch(t){throw v.M.getInstance().logErrorCode(c.O.DefaultInsertCalculatedCellTitleFailed,t,y.S2.FormulaGeneration,m.$b.Warning,{key:f.un.SuggestionID,value:e}),t}finally{a.end("total")}}(e.id,t,l,n)}if(await async function(e,t){const{rowCount:n,rowIndex:a,columnIndex:o,columnCount:r,sheetName:i}=e,l=t.workbook.worksheets.getItem(i);return l.getRangeByIndexes(a+n,o,1,r).format.font.bold=!0,t.sync()}(t,l),o)throw a}),{operationTimers:i.withPrefix("undoScope")})}finally{C.E.getInstance().updateTelemetryChatEventData({[f.h3.ChatEventType]:f.a5.FormulaSuggestionInsertRowTimings,[f.h3.ChatEventParameters]:JSON.stringify({requestId:e.id,timers:i.getAll()})},v.M.getInstance())}return{insertionAddresses:n}}catch(e){return{insertionAddresses:n,insertionError:e}}}(e,n)),a,e.id):{insertionAddresses:[]}}async function se(e){return await(0,W.F5)((async t=>{const n=t.workbook.worksheets.getActiveWorksheet();n.load("name"),await t.sync();const a=[];for(const o of e.calculatedFormulas){o.title&&o.titleTargetRange&&await B(t,o.title,o.titleTargetRange.address,n.name,o.titleTargetRange.insertionMethod);const e=await O(t,o,n.name);await $(t,e),a.push(e.address)}return(0,q.q)(a)}))}async function ce(e,t,n){return n.set({formulasLocal:[[t.formula]],numberFormat:[[t.numberFormat]]}),n.select(),n.load("address"),await e.sync(),n.address}async function de(e,t,n,a,o,i,l,s,d){try{if(e.insertionMode===r.PH.ToTableWithOverride&&(0,R.yw9)("OfficeVSO_9658083_enableInsertOverride"))return await async function(e,t,n,a,o,r){if(!o)throw new Error("overrideColumnInTable: context is undefined");const{showTotals:i,rowIndex:l,columnIndex:s,columnCount:c,sheetName:d,hasTableHeaders:u}=t,m=t.rowCount;if(!d||null==i)throw new Error("overrideColumnInTable: sheetName or showTotals are null or undefined");const g=o.workbook.worksheets.getItem(d),h=m+(i?1:0),p=g.getRangeByIndexes(l,s+(e.insertionIndex??c),h,1);return await he(o,p,e,i,u,n,a,!1,r)}(e,n,o,d.withPrefix("overrideColumnInTable"),l,s);if(void 0!==e.insertionIndex)return await me(e,t,n,a,o,i,d.withPrefix("partialInsertColumn"),l,e.insertionIndex,s);try{return await async function(e,t,n,a,o,r,i,l){try{r.start("total");const s=t.hasTableHeaders,{showTotals:d,rowCount:u,rowIndex:m,columnCount:g,columnIndex:h,sheetName:p,isTable:b}=t;if(!p||null==d)throw new Error("expandTableWithNewColumn: sheetName or showTotals are null or undefined");if(!i)throw new Error("expandTableWithNewColumn: context is undefined");let f=e;if(o.length>0){const t=await r.measure("adjustFormulaReferencesToNewColAddition",(0,x.tn)(e.formula,o,p,m,u,h,g,l));f={...e,formula:t}}return await function(e,t,n,a,o,r,i,l,s,d,u,m,g){return async h=>{const p=h.workbook.worksheets.getItem(l),b=a+(n?1:0),f=p.getRangeByIndexes(o,i+r+t,b,1);f.load("valueTypes"),await m.measure("newColRange.load(valueTypes)",h.sync());if(f.valueTypes.every((e=>e.every((e=>e===Excel.RangeValueType.empty)))))return s||f.clear(),await ge(h,f,e,n,s,d,u,m.withPrefix("fillFormulaAndFormat"),g);throw new Error(c.O.CalculatedColumnExpandFailedNotEmptyColumn)}}(f,n,d,u,m,g,h,p,b,s,a,r,l)(i)}catch(t){throw t.message===c.O.CalculatedColumnExpandFailedNotEmptyColumn?C.E.getInstance().updateTelemetryChatEventData({[f.h3.ChatEventType]:f.a5.CalculatedColumnExpandFailedNotEmptyColumn,[f.h3.ChatEventParameters]:JSON.stringify({suggestionID:e.id})},v.M.getInstance()):C.E.getInstance().updateTelemetryChatEventData({[f.h3.ChatEventType]:f.a5.CalculatedColumnExpandFailed,[f.h3.ChatEventParameters]:JSON.stringify({suggestionID:e.id})},v.M.getInstance()),t}finally{r.end("total")}}(e,n,a,o,i,d.withPrefix("expandTableWithNewColumn"),l,s)}catch(r){if(C.E.getInstance().updateTelemetryChatEventData({[f.h3.ChatEventType]:f.a5.DefaultInsertCalculatedColumnFailed,[f.h3.ChatEventParameters]:JSON.stringify({suggestionID:e.id})},v.M.getInstance()),r.message===c.O.CalculatedColumnExpandFailedNotEmptyColumn)return await me(e,t,n,a,o,i,d.withPrefix("partialInsertColumn-ExpandFailedNotEmptyColumn"),l);throw r}}catch(n){throw await async function(e,t,n){try{await Excel.run((async n=>{const a=n.workbook.tables.getItem(t);a.columns.load("items"),await n.sync();const o=a.columns.items[a.columns.count-1];o.name===e&&(o.delete(),await n.sync())}))}catch(e){v.M.getInstance().logErrorCode(c.O.DeleteLastColumnFailed,e,y.S2.FormulaGeneration,m.$b.Warning,{key:f.un.SuggestionID,value:n})}}(e.columnName,t,e.id),n}}async function ue(e,t,n,a,o){o.start("total");try{return await async function(e,t,n,a,o){try{const{rowCount:r,rowIndex:i,columnIndex:l,sheetName:s}=t;if(!s)throw new Error("insertColumnAggregationUnderTable: sheetName null or undefined");return await async function(e,t,n,a,o,r,i,l){const s=r.workbook.worksheets.getItem(o),d=s.getRangeByIndexes(n+t,a+(e.insertionIndexes?.[0]??0),1,e.insertionIndexes?.length??1);let u=!1;i||(d.load("valueTypes"),await l.measure("newRowRange.load(valueTypes)",r.sync()),u=(0,S.RV)(d));if(u||i){const t=e.insertionIndexes?.map((()=>e.numberFormat))??[];return d.set({formulasLocal:[e.formulasToInsert],numberFormat:[t]}),d.select(),d.load("address"),await l.measure("newRowRange.set",r.sync()),{address:d.address,selectedRange:d}}throw new Error(c.O.CalculatedCellExpandFailedNotEmptyCell)}(e,r,i,l,s,n,a,o)}catch(t){throw t.message===c.O.CalculatedCellExpandFailedNotEmptyCell?C.E.getInstance().updateTelemetryChatEventData({[f.h3.ChatEventType]:f.a5.CalculatedCellExpandFailedNotEmptyCell,[f.h3.ChatEventParameters]:JSON.stringify({suggestionID:e.id})},v.M.getInstance()):C.E.getInstance().updateTelemetryChatEventData({[f.h3.ChatEventType]:f.a5.CalculatedCellExpandFailed,[f.h3.ChatEventParameters]:JSON.stringify({suggestionID:e.id})},v.M.getInstance()),t}}(e,t,n,a,o)}catch(t){throw v.M.getInstance().logErrorCode(c.O.DefaultInsertCalculatedCellFailed,t,y.S2.FormulaGeneration,m.$b.Warning,{key:f.un.SuggestionID,value:e.id}),t}finally{o.end("total")}}async function me(e,t,n,a,o,r,i,l,s,c){const{showTotals:d,rowCount:u,rowIndex:m,columnCount:g,columnIndex:h,sheetName:p,isTable:b}=n;if(!p||null==d)throw new Error("partialInsertColumn: sheetName or showTotals are null or undefined");try{if(i.start("total"),!l)throw new Error("partialInsertColumn: context is undefined");return await function(e,t,n,a,o,r,i,l,s,c,d,u,m,g,h,p){return async b=>{const f=await g.measure("partialInsertEmptyColumn",async function(e,t,n,a,o,r,i,l,s,c){let d;if(s){const t=void 0!==c?c+r:-1;d=e.workbook.tables.getItem(l).columns.add(t).getRange()}else{const l=void 0!==c?a+c+r:a+o+r;d=e.workbook.worksheets.getItem(t).getRangeByIndexes(n,l,i,1),d=d.insert(Excel.InsertShiftDirection.right),d.clear()}return d}(b,s,r,l,i,n,o,t,c,h));m.push(h??i);const C=await g.measure("adjustFormulaReferencesToNewColAddition",(0,x.tn)(e.formula,m,s,r,o,l,i,p)),y={...e,formula:C};return await ge(b,f,y,a,c,u,d,g.withPrefix("fillFormulaAndFormat"),p)}}(e,t,a,d,u,m,g,h,p,b,o,n.hasTableHeaders,r,i,s,c)(l)}catch(t){throw C.E.getInstance().updateTelemetryChatEventData({[f.h3.ChatEventType]:f.a5.CalculatedColumnPartialInsertFailed,[f.h3.ChatEventParameters]:JSON.stringify({suggestionID:e.id})},v.M.getInstance()),t}finally{i.end("total")}}async function ge(e,t,n,a,o,r,i,l,s){if(l.start("total"),!o){const e=t.getOffsetRange(0,-1);t.copyFrom(e,Excel.RangeCopyType.formats),t.conditionalFormats.clearAll()}const c=await he(e,t,n,a,r,i,l,!0,s);return l.end("total"),c}async function he(e,t,n,a,o,r,i,l,s){let d=!1,u=!1,g=null;for(let h=0;h<2;h++)try{return await pe(e,t,n.columnName,n.formula,n.nonLocalizedFormula,n.numberFormat,a,o,r,d,u,i.withPrefix(`fillFormulaAndFormatWithAutoFill:${h}`))}catch(e){if("InvalidArgument"!==e.code)throw e;if(e.debugInfo.errorLocation===g)throw e;if(g=e.debugInfo.errorLocation,"Range.formulasLocal"===e.debugInfo.errorLocation&&n.nonLocalizedFormula){if(v.M.getInstance().logErrorCode(c.O.CalculatedColumnsInvalidFormula,e,y.S2.FormulaGeneration,m.$b.Warning),(0,R.yw9)("OfficeVSO_9663933_FixFormulaSuggestionInsertionInvalidArgErrors")&&"en-us"===s?.dataLocale?.toLowerCase())throw e;d=!0}else{if("Range.autoFill"!==e.debugInfo.errorLocation)throw e;if(v.M.getInstance().logErrorCode(c.O.InsertCalculatedColumnWithTargetRangeFailed,e,y.S2.FormulaGeneration,m.$b.Warning),!l)throw e;u=!0}}throw new Error("Failed to fill formula after 2 retries")}async function pe(e,t,n,a,o,r,i,l,s,c=!1,d=!1,u){u.start("total");const m=t.getCell(0,0),g=xe();!g&&l&&(m.values=[[n]]);const h=l?m.getOffsetRange(1,0):m;h.numberFormat=[[r]],c?h.values=[[o]]:(0,T.r1)()?h.formulasLocal=[[a]]:h.values=o?[[o]]:[[a]];const p=t.getOffsetRange(l?1:0,0).getResizedRange((i?-2:-1)+(l?0:1),0);h.autoFill(d?void 0:p,Excel.AutoFillType.fillDefault),xe()||await u.measure("ContextSyncMidInsert",e.sync()),g&&l&&(m.values=[[n]]),p.numberFormat=[[r]],t.format.autofitColumns();const b=s?s.getBoundingRect(t):t;return b.select(),t.load("address"),await u.measure("ContextSyncPostInsert",e.sync()),u.end("total"),{address:t.address,selectedRange:b}}function be(e,t){const{values:n,formulas:a}=t,o=Math.min(n.length,a?.length??1/0,(0,R.xyg)("CalculatedColumnsMaxRows"),(0,R.xyg)("CalculatedColumnsMaxCells")/n[0].length),r=[];for(let a=0;a<o;a++)for(let o=0;o<n[a].length;o++)r.push((0,I.I)(t,a,o,e.rowIndex,e.columnIndex));return r}function fe(e){return{decimalSeparator:e.localeInfo.decimalPoint,thousandsSeparator:e.localeInfo.digitGrouping,currencySymbol:e.localeInfo.currencySymbol,dayNameLong:e.localeInfo.longDay,dayNameShort:e.localeInfo.shortDay,monthNameLong:e.localeInfo.longMonth,monthNameShort:e.localeInfo.medMonth}}function Ce(e){const{errorTypeNames:t,specialRefNames:n,worksheetFunctionNames:a,...o}=e;return o}async function ye(e,t,n,a,o,r,u,h,x,w,I,A,L){let F,_;if((0,R.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.FormulaGenerationNewNlToFormulaSkill",!1))try{_=await(0,S.Fr)()}catch(e){v.M.getInstance().logErrorCode(c.O.SubmitExcelIntelligenceOperationFailedOnGetActiveSheetName,e,y.S2.FormulaGeneration,m.$b.Warning)}try{F=await(0,S.Z$)()}catch(e){v.M.getInstance().logErrorCode(c.O.SubmitExcelIntelligenceOperationFailedOnGetActiveCell,e,y.S2.FormulaGeneration,m.$b.Warning)}let P;if(e){const l=await v.M.getInstance().runTimedAsyncFunction("GetVisibleRows",(()=>Z(e)),a);(0,E.cY)("visibleRows: ",l),P=function(e,t,n,a,o,r,l,s,u,g,h,b,f,C,x){if(!e.tableName||!(0,R.yw9)("CalculatedColumnsTLRSupport")&&!e.isTable)return null;const S=[];if((0,R.UBP)()||r){if(!n)return v.M.getInstance().logErrorCode(c.O.CalculatedColumnFailedToSendSignal,new Error("convertFormulaSuggestionToResult dataSourceApi is undefined"),y.S2.FormulaGeneration,m.$b.Error),null;S.push(...be(e,n))}const w=(0,k.at)(e,e.sheetId??""),E=(0,T.r1)(),I=(0,R.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.FormulaGenerationNewNlToFormulaSkill",!1);return new i.v({sheetName:I?f??"":e.sheetName??"",tableInfo:{hasHeaderRow:e.hasTableHeaders,hasTotalRow:e.showTotals??!1,tableName:e.tableName},cells:S,tableAddress:e.address,userPrompt:l,requestId:a,scenarioType:I?d.az.NlToFormulaSuggestion:o,isCtrlTTable:e.isTable,dataLocale:t.dataLocale,localeInfoForPreview:E?void 0:fe(t),range:w,outputLanguage:g,visibleRows:h,isGeneralSuggestionsRequest:u,localeInfo:E?Ce(t.calcLocaleInfo):void 0,isHybrid:!r,workbookTables:(0,R._mi)()?b:void 0,queryOrigin:s??p.Rk.ChatUserPrompt,activeCellAddress:C,onGridQueryCellAddress:x,activeWorksheetId:e.sheetId})}(e,t,n,a,o,r,h,x,u,I,l,A,_,F,L)}else P=function(e,t,n,a,o,r,l,s,c,u,m,g,h){const p=(0,T.r1)();return new i.v({sheetName:m??"",tableInfo:{hasHeaderRow:!1,hasTotalRow:!1,tableName:e},cells:[],tableAddress:void 0,userPrompt:r,requestId:n,scenarioType:(0,R.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.FormulaGenerationNewNlToFormulaSkill",!1)?d.az.NlToFormulaSuggestion:a,isCtrlTTable:void 0,dataLocale:t.dataLocale,localeInfoForPreview:p?void 0:fe(t),range:void 0,outputLanguage:c,visibleRows:void 0,isGeneralSuggestionsRequest:s,localeInfo:p?Ce(t.calcLocaleInfo):void 0,isHybrid:!o,workbookTables:u,queryOrigin:l,activeCellAddress:g,onGridQueryCellAddress:h})}(w??"",t,a,o,r,h,x,u,I,A,_,F,L);if(!P)return Promise.reject(new Error("Invalid signal object"));const N=new b.g0({parentPath:["session","doc"],items:[{id:g.r.generateId(),body:P}]});C.E.getInstance().updateTelemetryChatEventData({[f.h3.ChatEventType]:f.a5.CalculatedColumnsSignalSent,[f.h3.ChatEventParameters]:JSON.stringify({scenarioType:o})},v.M.getInstance()),s.$.getInstance().submitOperation({operation:N,workflowAnnotationType:l.lL.getTypeName()})}function ve(e,t,n){if(e.requestId===t){if(!1===e.success)return{success:!1,result:void 0,suggestionType:n,suggestionMetadata:e.suggestionMetadata,debugInfo:e.debugInfo};const a=l.lL.typeGuard(e)?e.calculatedColumns?{id:Te(e.requestId,e.suggestionId),suggestionType:0,isAlternativeSuggestion:e.isAlternativeSuggestion??!1,isInserted:!1,calculatedFormulas:e.calculatedColumns,allowReplacementOfExistingValue:!1,debugInfo:e.debugInfo}:e.calculatedColumn?{suggestionType:0,id:Te(e.requestId,e.suggestionId),isAlternativeSuggestion:e.isAlternativeSuggestion??!1,isInserted:!1,allowReplacementOfExistingValue:!1,calculatedFormulas:[{id:e.suggestionId,description:e.description,formulaExplanation:e.formulaExplanation,formula:e.calculatedColumn.formula,columnName:e.calculatedColumn.columnName,title:e.calculatedColumn.title,numberFormat:e.calculatedColumn.numberFormat,structRefsFormula:e.calculatedColumn.structRefsFormula,insertionIndex:e.calculatedColumn.insertionIndex,nonLocalizedFormula:e.calculatedColumn.nonLocalizedFormula}]}:void 0:void 0,o=l.Dv.typeGuard(e)&&e.calculatedCells?{id:Te(e.requestId,e.suggestionId),suggestionType:1,isAlternativeSuggestion:e.isAlternativeSuggestion??!1,isInserted:!1,calculatedFormulas:e.calculatedCells,allowReplacementOfExistingValue:void 0,debugInfo:e.debugInfo}:void 0,r=l.sG.typeGuard(e)&&e.extendedFormulas?{id:Te(e.requestId,e.suggestionId),suggestionType:2,isAlternativeSuggestion:e.isAlternativeSuggestion??!1,isInserted:!1,calculatedFormulas:e.extendedFormulas,debugInfo:e.debugInfo,response:e.response}:void 0,i=a||o||r;return i?{success:!0,result:[i]}:(v.M.getInstance().logErrorCode(c.O.CalculatedColumnConvertAnnotationToRecommendationFailed,new Error("convertFormulaSuggestionToResult failed"),y.S2.FormulaGeneration,m.$b.ASHA,{key:f.un.SuggestionID,value:Te(t,e.suggestionId??"not found")}),{success:!1,result:void 0,suggestionType:n,suggestionMetadata:e.suggestionMetadata,debugInfo:e.debugInfo})}return{success:!0,result:void 0}}function Te(e,t){return`${e}_${t}`}function xe(){return(0,R.yw9)("OfficeVSO_9273998_skipContextSyncByBuildVersionV2")?(0,T.w0)(["PC:17425","Mac:84.414","OfficeOnline:true"]):(0,R.iPS)("Microsoft.Office.Excel.FA000000124.RemoveContextSyncMidInsert",!1)}!function(e){e[e.Column=0]="Column",e[e.Cell=1]="Cell",e[e.Formula=2]="Formula"}(U||(U={}))},447773:(e,t,n)=>{"use strict";async function a(e,t,a,o,r,i,l,s){return(await Promise.all([n.e("chunk1jsfluent"),n.e("vendors-npm_store_sdx_officecopilot_1js-excel-copilot-calc_8_3_43-1adabd76bb06679768ec_node_m-dd2f81"),n.e("calc")]).then(n.bind(n,478565))).adjustFormulaReferencesToNewColAddition(e,t,a,o,r,i,l,s)}async function o(e,t,a){return(await Promise.all([n.e("chunk1jsfluent"),n.e("vendors-npm_store_sdx_officecopilot_1js-excel-copilot-calc_8_3_43-1adabd76bb06679768ec_node_m-dd2f81"),n.e("calc")]).then(n.bind(n,478565))).substitution.getColumnsReferencedByFormula(e,t,a)}async function r(e){return(await Promise.all([n.e("chunk1jsfluent"),n.e("vendors-npm_store_sdx_officecopilot_1js-excel-copilot-calc_8_3_43-1adabd76bb06679768ec_node_m-dd2f81"),n.e("calc")]).then(n.bind(n,478565))).configInstance.printConstantFormattedNumberValue(e)}n.d(t,{k0:()=>r,s_:()=>o,tn:()=>a})},448514:(e,t,n)=>{"use strict";n.d(t,{W:()=>a,x:()=>o});var a=function(e){return((new Date).getTime()-e)/1e3},o=function(e){return(new Date).getTime()-e}},448526:(e,t,n)=>{"use strict";n.d(t,{v:()=>c});var a=n(329739),o=n(660606),r=n(217425),i=n(632197),l=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{s(a.next(e))}catch(e){r(e)}}function l(e){try{s(a.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((a=a.apply(e,t||[])).next())}))},s=function(e,t){var n,a,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(n=1,a&&(o=2&l[0]?a.return:l[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,l[1])).done)return o;switch(a=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,a=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],a=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},c=function(e,t){return l(void 0,void 0,void 0,(function(){var n,l;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,5,,6]),n=void 0,e instanceof a.j?[4,e.getToken(null!=t?t:r.w8.graph)]:[3,2];case 1:return n=s.sent(),[3,4];case 2:return[4,e.getToken(null!=t?t:r.w8.graph,"graph")];case 3:n=s.sent(),s.label=4;case 4:return[2,(0,i.t)(n)];case 5:throw l=s.sent(),(0,o.cY)("Error fetching Graph token:",l),l;case 6:return[2]}}))}))}},450501:(e,t,n)=>{"use strict";e.exports=n.p+"assets/mic-permission-dialog.svg"},450818:(e,t,n)=>{"use strict";n.d(t,{E:()=>i});var a=n(500461),o=n(780866);const r={pythonRecommendation:{backgroundColor:a.k1.neutralLight,color:a.k1.neutralDark}},i=(0,o.n)(r)},458179:(e,t,n)=>{"use strict";n.d(t,{h:()=>f});var a=n(279395),o=n(57848),r=n(79105),i=n(121924),l=n(603222),s=n(384453),c=n(502947),d=n(857677),u=n(76872),m=n(500461),g=n(780866),h=n(210466);const p=(0,g.n)({mainContainer:{display:"flex",flexDirection:"column",alignItems:"flex-start",...h.Pt.gap("8px"),alignSelf:"stretch",borderRadius:"8px",...h.Pt.border("1px","solid",m.k1.colorNeutralStroke1),background:m.k1.neutralTertiary},summaryContainer:{display:"flex",...h.Pt.padding("12px","12px","8px"),alignItems:"center",alignSelf:"stretch"},expandedSectionContainer:{display:"flex",maxHeight:"168px",...h.Pt.padding("0","12px","0"),alignItems:"flex-start",...h.Pt.gap("10px"),alignSelf:"stretch",overflowY:"auto",flexDirection:"column"},explanationDivider:{height:"1px"},footer:{display:"flex",height:"28px",...h.Pt.padding("4px","12px"),justifyContent:"flex-end",alignItems:"center",...h.Pt.gap("12px"),alignSelf:"stretch",borderRadius:"0px 0px 4px 4px",...h.Pt.borderTop("1px","solid",m.k1.colorNeutralStroke1)},footerForeground:{color:m.k1.colorNeutralForeground3,"&:hover":{color:m.k1.colorNeutralForeground2Hover},"&:hover:active":{color:m.k1.colorNeutralForeground2Pressed},"@media (forced-colors: active)":{"> span":{color:"inherit","> svg":{color:"inherit"}}}},footerForegroundDisabled:{color:m.k1.colorNeutralForegroundDisabled},list:{listStyleType:"none",width:"100%",...h.Pt.padding("0px"),...h.Pt.margin("0","0")},listItem:{display:"flex",flexDirection:"column",alignItems:"flex-start",alignSelf:"stretch",width:"100%",...h.Pt.padding("4px","0")},listItemDivider:{height:"1px"},listItemTitle:{fontWeight:"600",lineHeight:"16px"},listItemContent:{fontWeight:"400",lineHeight:"16px",...h.Pt.margin("0","0","12px")},loadingContainer:{borderRadius:"8px",...h.Pt.border("1px","solid",m.k1.colorNeutralStroke1),...h.Pt.gap("12px"),...h.Pt.padding("12px","12px")},loadingSkeleton:{...h.Pt.margin("12px","0"),height:"8px"}});var b=n(208520);function f(e){const t=p(),[n,m]=b.useState(e.showExpandedListOnInit),[g,h]=b.useState(!1),f=(0,b.useRef)(null),C=e.isNotAvailable||0===e.expandableListItems.length;(0,b.useEffect)((()=>{C&&m(!1)}),[C]),(0,b.useEffect)((()=>{n&&null!==f.current&&requestAnimationFrame((()=>{u.E.getInstance().logLatency(performance.now()-f.current,d.OP.ExpandableListExpansion,!0,d.q.OfficeJsCommanding),f.current=null}))}),[n]);const y=()=>{g||(f.current=performance.now(),e.onFirstTimeListExpanded?.(),h(!0)),m(!n)},v=e.isLoading;return b.createElement("div",null,v?b.createElement("div",{className:t.loadingContainer},b.createElement(i.E,null,e.loadingLabel),b.createElement(l.E,{animation:"wave",appearance:"opaque",className:t.loadingSkeleton},b.createElement(s.H,null))):b.createElement("div",{className:t.mainContainer},b.createElement("div",{className:t.summaryContainer},b.createElement(i.E,null,e.summary)),n&&e.expandableListItems&&b.createElement("div",{className:t.expandedSectionContainer},b.createElement(c.c,{className:t.explanationDivider}),b.createElement("ul",{className:t.list},e.expandableListItems.map(((n,a)=>b.createElement("div",{key:a,className:t.listItem},b.createElement("li",null,n.title&&b.createElement(i.E,{className:t.listItemTitle},n.title),b.createElement("div",{className:t.listItemContent},n.content)),a!==e.expandableListItems.length-1&&b.createElement(c.c,{className:t.listItemDivider})))))),b.createElement("div",{className:t.footer},function(){const l=n?o.g4$:o.rLf;return b.createElement(r.f,{"aria-roledescription":(0,a.qcV)(),checked:n,disabled:C,size:"small",appearance:"transparent",iconPosition:"after",className:C?t.footerForegroundDisabled:t.footerForeground,onClick:y,icon:b.createElement(l,{className:C?t.footerForegroundDisabled:t.footerForeground})},b.createElement(i.E,null,n?e.expandedButtonLabel:e.collapsedButtonLabel))}())))}},459524:(e,t,n)=>{"use strict";function a(){return Office.context.platform===Office.PlatformType.PC||Office.context.platform===Office.PlatformType.Mac}n.d(t,{f:()=>a})},463323:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.URL=t.DNS=t.stringToBytes=void 0;const a=n(997434),o=n(154836);function r(e){e=unescape(encodeURIComponent(e));const t=new Uint8Array(e.length);for(let n=0;n<e.length;++n)t[n]=e.charCodeAt(n);return t}t.stringToBytes=r,t.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",t.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",t.default=function(e,t,n,i,l,s){const c="string"==typeof n?r(n):n,d="string"==typeof i?(0,a.default)(i):i;if("string"==typeof i&&(i=(0,a.default)(i)),16!==i?.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let u=new Uint8Array(16+c.length);if(u.set(d),u.set(c,d.length),u=t(u),u[6]=15&u[6]|e,u[8]=63&u[8]|128,l){s=s||0;for(let e=0;e<16;++e)l[s+e]=u[e];return l}return(0,o.unsafeStringify)(u)}},464077:(e,t,n)=>{"use strict";n.d(t,{G2:()=>p,Jm:()=>h,K7:()=>c,R1:()=>s,Sy:()=>u,_f:()=>m,m:()=>g,vs:()=>d,zC:()=>b});var a=n(540084),o=n(972424),r=n(579786),i=n(803716),l=n(158058);function s(e,t,n){return e((0,i.Vy)(t,n))?.tabularRange}function c(e){const t=e.interpretation.location,{left:n,top:a,right:o,bottom:r,worksheetId:i}={left:t.left-1,top:t.top-1,right:t.right-1,bottom:t.bottom-1,worksheetId:t.worksheetId};return{left:n,top:a,right:o,bottom:r,worksheetId:i}}function d(e,t,n){let a;return a="rowMajor"===n?e.getRangeByIndexes(t.top,t.left,t.bottom-t.top+1,1):e.getRangeByIndexes(t.top,t.left,1,t.right-t.left+1),a}function u(e,t,n){return(0,l.TP)(t,n)?[]:"rowMajor"===t?e.values.map((e=>e[0])):e.values[0]}function m(e,t){return e.getRangeByIndexes(t.top+1,t.left,1,t.right-t.left+1)}async function g(e,t,n,a){const o=function(e,t){return e.getRangeByIndexes(t.top+1,t.left,t.bottom-t.top,t.right-t.left+1)}(t,n);o.track(),o.load("rowCount"),await e.sync();const i=await(0,r.dr)(e,o,a);return o.untrack(),i}function h(e,t){return`${e}!${(0,a.XK)({top:t.top,left:t.left,right:t.right,bottom:t.bottom})}`}function p(e){return(0,o.r)(e)}function b(e){const t=e.lastIndexOf("!");return-1===t?"":e.substring(0,t)}},467407:(e,t,n)=>{"use strict";n.d(t,{R:()=>l,j:()=>s});var a=n(83437),o=n(857677),r=n(75496),i=n(316904);function l(e){const t={eventType:r.S2.ConverterError,errorMessage:e.message,logLevel:a.$b.ASHA};let n=[{key:o.Sn.ODSLProperty,value:e.property},{key:o.xL.ErrorMessage,value:e.message}];e.dataFields&&(n=n.concat(e.dataFields));i.M.getInstance().logError(t,void 0,n)}function s(e){const t=(0,o.b6)();e.forEach((e=>{t[e.key]=e.value}));i.M.getInstance().logEvent((0,o.gY)(t))}},468827:(e,t,n)=>{"use strict";n.d(t,{b:()=>p});var a=n(615397);var o=n(561187);class r{create(e,t){return!this.store[e]&&(this.store[e]=t,!0)}read(e){if(void 0!==this.store[e])return this.store[e];throw new Error("No such item: "+JSON.stringify(e))}update(e,t){const n=!!this.store[e];return this.store[e]=t,n}delete(e){const t=!!this.store[e];return delete this.store[e],t}keys(){const e=[];for(const t in this.store)e.push(t);return e}constructor(){this.store={}}}var i=n(705147),l=n(75542),s=n(724138),c=n(719733),d=n(123551);const u=["RichApiRuntimeFlag","ExcelApi","ExcelApiOnline","ExcelApiUndo"];function m(){if(Office?.context)return Office.context.platform}class g{async getRuntime(e,t,n){const a=(0,c.Ml)(e),o=!1;let r=this.getPreload(a,o);try{r||(r=new i.U((()=>this.createRuntime(a,o,t,n))));return await r.getPromise()}catch(e){throw e}finally{this.removePreload(a,o)}}getSupportedSetMap(){if(this.apiSetMap)return this.apiSetMap;const e={};return u.forEach((t=>{let n=0;for(;n<99;){if(!Office.context.requirements.isSetSupported(t,`1.${n}`)){n--;break}n++}n>=0&&(e[t]=`1.${n}`)})),this.apiSetMap=e,e}async loadCodeForRuntime(e,t,n){const a=n??await(0,d.Q)(),o=t.codeOverride||a;await e.loadCode(o);const r=this.getSupportedSetMap(),i=(0,l.tI)(r);return await e.loadCode(i),e}async createRuntime(e={variant:"synchronous",variantVersion:2},t,n,a){const o=await(0,c.Tq)(e),r=o.officeJsOverride||function(){const e=m()===Office.PlatformType.PC?"excel-win32-16.01.js":m()===Office.PlatformType.Mac?"excel-mac-16.00.js":"excel-web-16.00.js",t=(0,s.Tp)(window.location.href);return t?`${t}/lib/beta/hosted/${e}`:"https://appsforoffice.microsoft.com/lib/beta/hosted/"+e}(),i={officeJsUrl:r,allowExternalCalls:t,runtimeConsole:{log:()=>{},warn:()=>{},error:()=>{},info:()=>{}},loadCodeDomainList:[new URL(r).origin],batchHandlerFunction:a,batchSafetyFlag:l.hl.OnlyAllowMakerSafeApi};return l.zI.createRuntimeInstance(i).then((e=>this.loadCodeForRuntime(e,o,n)))}getPreload(e,t){const n=JSON.stringify([e,t]);if(!(this.preloads.keys().indexOf(n)<0))return this.preloads.read(n)}constructor(){this.preloadRuntime=async(e,t)=>{const n=(0,c.Ml)(e)||{variant:"synchronous",variantVersion:2},a=!1;if(void 0===this.getPreload(n,a)){const e=new i.U((()=>this.createRuntime(n,a,t))),o=e.getPromise();this.pushPreload(n,a,e);try{await o}catch(e){this.removePreload(n,a)}}},this.pushPreload=(e,t,n)=>{const a=JSON.stringify([e,t]);this.preloads.create(a,n)},this.removePreload=(e,t)=>{const n=JSON.stringify([e,t]);this.preloads.delete(n)},this.preloads=new r}}var h=n(163724);class p{async terminateCurrentRun(e){this.runtime&&(this.runtime.terminate(),this.ensurePreload(e))}getPrepareScriptError(e){let t="Error occurred while loading runtime.";return!!e.isCompileError&&(t="Error occurred during code compilation."),new a.WD(t)}constructor(){this.acquireMutexToken=()=>{const e=this.mutex.tryAcquire();return void 0!==e&&(this.mutexToken=e,!0)},this.releaseMutexToken=()=>{try{this.mutexToken.release(),this.mutexToken=void 0,this.resolveMutexReleasePromise()}catch(e){}},this.ensureScriptBody=e=>{const t=e.localUpdates.body;return!(null==t)},this.ensurePreload=e=>{this.runtimeTracker.preloadRuntime(e)},this.prepareCustomParams=async(e,t,n,a)=>this.prepare(e,a,t,n),this.prepareScript=async e=>{const t=e.localUpdates.body,n=await(0,c.uS)(e),a=await(0,h.V)(t,e,n);return this.prepare(a,e)},this.executeScript=async(e,t)=>{try{const n=await this.runtime.executeFunction("main",t??[],"Excel",(function(e,t,n){n("external API not supported")}));return await this.terminateCurrentRun(e),n}catch(t){await this.terminateCurrentRun(e);const n=new a.WD("Office Script execution failed.");throw t.data?.message?.error?.code&&(n.errorCode=t.data.message.error.code),n}},this.prepare=async(e,t,n,a)=>{try{this.runtime=await this.runtimeTracker.getRuntime(t,n,a),await this.runtime.loadCode("OfficeExtension._internalConfig.appendTypeNameToObjectPathInfo = true;\n        "),await this.runtime.loadCode(e)}catch(e){const n=this.getPrepareScriptError(e);throw await this.terminateCurrentRun(t),n}},this.resolveMutexReleasePromise=()=>{this.mutexPromiseResolveFn&&this.mutexPromiseResolveFn()},this.mutex=new o.e,this.runtimeTracker=new g}}p.instance=()=>(p._instance||(p._instance=new p),p._instance)},468967:(e,t,n)=>{"use strict";n.d(t,{lB:()=>C,iY:()=>f,GI:()=>oe,Wx:()=>ee,dL:()=>ae,Ix:()=>ce,au:()=>te,kh:()=>ne,Qi:()=>K,MQ:()=>v,iq:()=>J,Vp:()=>me,pX:()=>Z,x6:()=>W,jv:()=>D,Y8:()=>N,R_:()=>y,BH:()=>Y,Jk:()=>V,Uc:()=>z,LH:()=>U,pJ:()=>Q,i_:()=>X,En:()=>_,L7:()=>F,fB:()=>ue,$C:()=>G,j9:()=>ie,KG:()=>ge,zj:()=>q,MF:()=>P,xp:()=>H,XO:()=>de,Pi:()=>O,_s:()=>se,pz:()=>$,bb:()=>j,Eu:()=>le,w5:()=>M,h3:()=>re,Kx:()=>w,$n:()=>A,QX:()=>I,RA:()=>R,HH:()=>T,U6:()=>k,s$:()=>L,CS:()=>S,OE:()=>E});var a=n(543435),o=n(616166),r=n(279395),i=n(775568),l=n(316904),s=n(664007),c=n(469486),d=n(109174),u=n(347145),m=n(799765),g=n(821845);function h(e){if(!e)return!1;let t=["de","en","es","fr","it","ja","pt","zh"];if((0,u.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.SupportT2Languages",!1)){const e=["ar","cs","da","fi","he","hu","ko","nb","nl","pl","pt","ru","sv","th","tr","uk","zh"];t=t.concat(e)}if((0,u.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.SupportT25Languages",!1)){const e=["ca","cy"];t=t.concat(e)}if((0,u.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.SupportT3Languages",!1)){const e=["bg","de","el","et","hr","id","lt","lv","nl","ro","sl","sk","sr","vi"];t=t.concat(e)}if((0,u.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.SupportT4Languages",!1)){const e=["fil","is","kk","ms","mt","sq","sr-Cyrl"];t=t.concat(e)}return t.some((t=>e.startsWith(t)))}var p=n(795786),b=n(857786);function f(e){if(!(0,c.C6)())throw new i.H({errorCode:o.O.PythonUnsupportedPlatform});if(!(0,c.Gd)())throw de();if(!h(e)){throw function(e){return new i.H({errorCode:o.O.PythonUnsupportedLanguage,errorDetailsNoPII:e})}(e?"Unsupported Language Detected":"OutputLanguage Undefined")}if((0,c.$)()&&!(0,g.i)()&&(0,u.yw9)("OfficeVSO_10271339_BlockPythonAAMode"))throw ue()}function C(e){if(!(0,c.C6)())throw new i.H({errorCode:o.O.AnswersUnsupportedPlatformError});if(!h(e)){const t=e?"Unsupported Language Detected":"OutputLanguage Undefined";throw new i.H({errorCode:o.O.AnswersUnsupportedLanguageError,errorDetailsNoPII:t})}}function y(e){if(e instanceof OfficeExtension.Error){if(e.code===Excel.ErrorCodes.itemNotFound){const t="getPythonCellsFromWorksheet: sheet deleted";return z(o.O.PythonUnexpectedMissingSheetInContextExtraction,t,e)}if(e.code===Excel.ErrorCodes.responsePayloadSizeLimitExceeded)return se("payload size limit reached.",e)}return e}function v(e,t){const n=`Catching Function: ${t}: `;return e instanceof Error?n+`${e.stack?e.stack:"Unknown Type"}: `:n+"Unknown Type"}function T(e){return e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.invalidOperationInCellEditMode}function x(e){return function(e){return"object"==typeof e&&null!==e&&"name"in e}(e)&&"RichApi.Error"===e.name}function S(e,t){const n=t?.signal.aborted,a=e instanceof i.H,r=e.errorCode===o.O.PythonContextExtractionAborted||e.errorCode===o.O.GetPythonCellContextTimeout||e.errorCode===o.O.GetPythonCellContextTimeoutRecoverable||e.errorCode===o.O.GetAllPythonCellsUpToAnalysisSheetTimeout||e.errorCode===o.O.ExecutePythonCodeApiCallTimeout||e.errorCode===o.O.GetAllPythonCellsOfAASessionAnalysisSheetTimeout;return n||a&&r}async function w(e,t,n,a,r=!1,s=[],u=!1){const g=(0,m.SG)();l.M.getInstance().endTriedActivityFailure(g);const h=v(t,n);let f;var C,y;t instanceof i.H?f=t:t instanceof Error?T(t)?f=ie(o.O.PythonGenericEditModeError,h,t):r?(C=h,y=t,f=new i.H({errorCode:o.O.PrePythonModeError,innerError:y,errorDetailsNoPII:C})):f=function(e){return x(e)&&e.code===Excel.ErrorCodes.inactiveWorkbook}(t)?function(e,t){return new i.H({errorCode:o.O.PythonMultipleOpenWorkbooks,innerError:t,errorDetailsNoPII:e})}(h,t):d.CP.pythonContextManager.isPythonMode&&!u&&await async function(){try{return!await(0,c.J7)(d.CP)}catch{return!1}}()?me(o.O.PythonDeletedSheetDuringResponseGeneration,"",t):B(h,t):f=B(h,t),p.n.displayPythonErrorResponse(e,f,s),(0,m.Lv)(f),(0,m.yQ)(f),(0,b.P_)(),!u&&a&&E(e)}function E(e){e(s.m.setSuggestionListDetails({suggestionList:[{suggestionText:(0,r.Yzk)(),suggestionType:"TryAgain"}],nextSuggestionTypePriorities:[],shouldResetRecentPrompts:!0,isPythonSuggestion:!0}))}function I(e,t,n,a){n&&p.n.displayPythonTextResponse(e,t.errorDisplayMessage,!1,!1,!0),(0,m.Lv)(t,a),(0,m.yQ)(t)}function R(e){d.CP.pythonContextManager.disableAutoScroll=!1;I(void 0,re(o.O.PythonTuiNotShownError,(e instanceof Error?e.stack:"No stack trace available")??"",e),!1)}function A(e,t,n){let a=e;n&&(a+=` Props keys: ${Object.keys(n).join(", ")}`);const r=function(e,t){const n=e?o.O.AnswersComponentPropsNotSerializable:o.O.PythonCodeAndPostViewPropsNotSerializable;return new i.H({errorCode:n,errorDetailsNoPII:t})}(t,a);I(void 0,r,!1)}function L(e){return e.outputType===a.qf.Error&&e.output&&!e.output.errorType}function k(e){return e.output?.errorType===Excel.ErrorCellValueType.busy}function F(e){if(e.outputType!==a.qf.Error)return;const t=e.output.errorType,n=`Python execution failed with error type: ${t}`;return t===Excel.ErrorCellValueType.python||t===Excel.ErrorCellValueType.timeout?q(o.O.PythonDataFrameInsertFailed,n,void 0):_(e)}function _(e){if(e.outputType!==a.qf.Error)return;const t=e.output.errorType,n=`Python execution failed with error type: ${t}`;return t===Excel.ErrorCellValueType.busy?D(n,void 0):t===Excel.ErrorCellValueType.connect?M(n):t===Excel.ErrorCellValueType.name||t===Excel.ErrorCellValueType.blocked?function(e){return new i.H({errorCode:o.O.PythonAccessError,errorDetailsNoPII:e})}(n):t===Excel.ErrorCellValueType.calc?function(e){return new i.H({errorCode:o.O.PythonCalcError,errorDetailsNoPII:e})}(n):function(e){return new i.H({errorCode:o.O.PythonGeneralError,errorDetailsNoPII:e})}(n)}function P(e,t,n,a,r,l){if(e instanceof i.H)return e;if(T(e))return ie(o.O.PythonGenericEditModeError,"",e);if(e instanceof i.H&&(e.errorCode===o.O.PythonProtectedSheetError||e.errorCode===o.O.PythonProtectedSheetObjectInsertionError))return e;const s=`Class ${t}, Method: ${n}, Stack: ${e instanceof Error?e.stack:"No stack trace available"} + Details: ${r}`;return q(a?o.O.PythonDataFrameInsertFailed:o.O.PythonInsertFailed,s,e,l)}function N(e){const t=v(e,"getAllPythonCellsUptoAnalysisSheet");return x(e)?z(o.O.PythonGeneralContextError,t,e,(0,r.kvH)()):e instanceof i.H?new i.H({errorCode:e.errorCode,errorDetailsNoPII:e.errorDetailsNoPII,errorDetailsOCVOnly:e.errorDetailsOCVOnly,customDisplayMessage:(0,r.kvH)()}):B(t,e,(0,r.kvH)())}function M(e){return new i.H({errorCode:o.O.PythonStaleRuntimeError,errorDetailsNoPII:e})}function O(e){return new i.H({errorCode:o.O.PythonObjectReferenceError,errorDetailsNoPII:e})}function D(e,t){return new i.H({errorCode:o.O.PythonBusyStateError,innerError:t,errorDetailsNoPII:e})}function B(e,t,n){return new i.H({errorCode:o.O.PythonUnknownError,innerError:t,errorDetailsNoPII:e,customDisplayMessage:n})}function $(e,t){return new i.H({errorCode:o.O.PythonPostViewError,innerError:t,errorDetailsNoPII:e})}function H(e,t){return new i.H({errorCode:e,errorDetailsNoPII:t})}function U(e){return new i.H({errorCode:o.O.PythonCopyFailed,innerError:e})}function q(e,t,n,a){return new i.H({errorCode:e,errorDetailsNoPII:t,innerError:n,errorDetailsOCVOnly:a})}function V(e){return new i.H({errorCode:o.O.PythonCodeRetryMaximumHit,errorDetailsNoPII:e})}function W(e){return new i.H({errorCode:o.O.PythonAugLoopCallsPerQueryMaximumHit,errorDetailsNoPII:e})}function G(e,t){return new i.H({errorCode:o.O.PythonExitAnalysisError,innerError:t,errorDetailsNoPII:e})}function z(e,t,n,a){return new i.H({errorCode:e,innerError:n,errorDetailsNoPII:t,customDisplayMessage:a})}function Q(e){return new i.H({errorCode:o.O.PythonGetDiagnosticsError,innerError:e})}function j(){return new i.H({errorCode:o.O.PythonPrintFormattedNumberError})}function J(e,t){return new i.H({errorCode:o.O.PythonAddResultsToNewSheetError,innerError:t,errorDetailsNoPII:e})}function Y(e){return new i.H({errorCode:o.O.PythonCodeAndPostViewPropsNotSerializable,errorDetailsNoPII:e})}function X(e){return new i.H({errorCode:o.O.PythonDisplayResponseError,errorDetailsNoPII:e})}function Z(e,t){return new i.H({errorCode:o.O.PythonAnalysisSheetMetadataError,innerError:e,errorDetailsNoPII:t})}function K(e,t){return new i.H({errorCode:o.O.AnswersPostViewError,innerError:t,errorDetailsNoPII:e})}function ee(e,t){return new i.H({errorCode:o.O.AnswersInvalidImageResponse,innerError:t,errorDetailsNoPII:e})}function te(e){return new i.H({errorCode:o.O.AnswersMissingChunkProperty,errorDetailsNoPII:e})}function ne(e){return new i.H({errorCode:o.O.AnswersParsingMetadataFailed,errorDetailsNoPII:e})}function ae(e,t){return new i.H({errorCode:e,errorDetailsNoPII:void 0,innerError:t})}function oe(e){return new i.H({errorCode:o.O.AnswersCollapsableCodeOnClickError,errorDetailsNoPII:void 0,innerError:e})}function re(e,t,n){return new i.H({errorCode:e,innerError:n,errorDetailsNoPII:t})}function ie(e,t,n){return new i.H({errorCode:e,innerError:n,errorDetailsNoPII:t})}function le(){return new i.H({errorCode:o.O.PythonProtectedSheetError})}function se(e,t){return new i.H({errorCode:o.O.PayloadSizeError,innerError:t,errorDetailsNoPII:e})}function ce(e,t,n){return new i.H({errorCode:e,innerError:n,errorDetailsNoPII:t})}function de(){return new i.H({errorCode:o.O.PythonNoActiveLicense})}function ue(){return new i.H({errorCode:o.O.PythonExecutionBlockedByAdmin})}function me(e,t,n){return new i.H({errorCode:e,innerError:n,errorDetailsNoPII:t})}function ge(e){return new i.H({errorCode:o.O.PythonImageUnavailableAnalysisSheetDeletedError,errorDetailsNoPII:e})}},469486:(e,t,n)=>{"use strict";n.d(t,{MA:()=>Ue,t2:()=>$e,e1:()=>ze,nC:()=>Re,J7:()=>Le,Yp:()=>ie,jC:()=>Ge,bf:()=>Ve,lE:()=>We,ec:()=>He,UH:()=>re,OU:()=>O,vv:()=>de,Jy:()=>le,VF:()=>ke,$e:()=>be,u1:()=>ge,eU:()=>Ce,dd:()=>xe,WH:()=>ye,RW:()=>we,yK:()=>he,ZK:()=>ue,B4:()=>se,cx:()=>ne,WM:()=>oe,gQ:()=>ae,c3:()=>fe,EA:()=>je,Tk:()=>Qe,Gd:()=>k,XT:()=>N,gx:()=>P,IY:()=>Te,i_:()=>et,C6:()=>_,Hq:()=>qe,$:()=>F,U6:()=>tt,PV:()=>De,mx:()=>Me,FN:()=>Be,bh:()=>Oe,Xn:()=>D,sy:()=>M,o7:()=>ce,AJ:()=>me,ZD:()=>Se,Dh:()=>Ae,LX:()=>Ke,LC:()=>pe});var a=n(109174),o=n(92520),r=n(616166),i=n(543435),l=n(531093),s=n(429257),c=n(197665),d=n(749832),u=n(857677),m=n(279395),g=n(775568),h=n(75496),p=n(664007),b=n(468967),f=n(910480),C=n(126521),y=n(347145),v=n(639969),T=n(8403),x=n(851295),S=n(799765);class w{getNextAvailableSheetName(e){const t=this.getSheetName(),n=ne(t),a=e.map((e=>{const t=n.exec(e);return t?Number(t[1]):null})),o=a.filter((e=>null!==e&&e>=this.currentSheetNumber));o.sort(((e,t)=>e-t));for(const e of o){if(e!==this.currentSheetNumber)break;this.currentSheetNumber++}const r=t+this.currentSheetNumber;return this.currentSheetNumber++,r}constructor(e){this.currentSheetNumber=1,this.getSheetName=e}}const E=new w(m.I_l),I=new w(m.r5N);var R=n(233356),A=n(795786),L=n(715834);function k(){let e=d.V.getSettingAsString(d.z.HasActivePythonLicense)??"false";const t=d.V.getSettingAsString(d.z.AudienceGroup);return(0,y.$0$)()&&"Production"!==t&&(e="true"),"true"===e}function F(){return"true"===(d.V.getSettingAsString(d.z.IsPythonExecutionBlockedByAdmin)??"false")}function _(){const e=[Office.PlatformType.PC];return(0,y.$0$)()&&e.push(Office.PlatformType.OfficeOnline),(0,y.G7K)()&&e.push(Office.PlatformType.Mac),e.includes(Office.context.platform)}function P(){try{(0,b.iY)((0,x.gl)())}catch(e){return!1}return!0}function N(){try{(0,b.lB)((0,x.gl)())}catch(e){return!1}return!0}const M=/^=[ ]*PY\(/,O=/.*['"],\s*0\)/,D=/^<class.*>$/,B=/["'\s]/g,$=RegExp("=[ ]*PY\\(['\"](.*)['\"],\\s*[01]\\s*\\)","s"),H=/[^a-zA-Z0-9_]/g,U=/^[^a-zA-Z_].*$/,q=/([A-Z]+|[0-9]+)/g,V=/[a-zA-Z0-9]/,W=/\}/g,G=/\{/g,z=/\^/g,Q=/\$/g,j=/\(/g,J=/\)/g,Y=/\./g,X=/\+/g,Z=/\|/g,K=/"/g,ee=/'/g,te=/''/g;function ne(e){return new RegExp(`^${e}([0-9]+)$`)}function ae(e,t,n){const a=t.replace(q,"\\$?$1");return new RegExp(`.+\\s*=\\s*xl\\s*\\(\\s*\\"${n?`'?${e}'?!`:""}${a}".*\\)\\s*`)}function oe(e,t){if(e.includes("\\")){return new RegExp(`.+\\s*=\\s*xl\\s*\\(\\s*(?:r|R)\\"${(0,f.escapeRegExp)(e)}\\[${(0,f.escapeRegExp)(t)}]".*\\)\\s*`)}return new RegExp(`.+\\s*=\\s*xl\\s*\\(\\s*\\"${e}\\[${(0,f.escapeRegExp)(t)}]".*\\)\\s*`)}function re(e){return e.replaceAll(ee,"''").replaceAll(K,'\\\\"').replaceAll(W,"\\}").replaceAll(G,"\\{").replaceAll(z,"\\^").replaceAll(Q,"\\$").replaceAll(J,"\\)").replaceAll(j,"\\(").replaceAll(Y,"\\.").replaceAll(X,"\\+").replaceAll(Z,"\\|")}function ie(e,t,n){let a="";const[o,r]=le(t);a=V.test(e)?e.replaceAll(H,"_")+"_df":V.test(o)?o.replaceAll(H,"_")+"_df":(n+r).replaceAll(H,"_")+"_df";return a.match(U)?"_"+a:a}function le(e){return[l.ExcelCalc.sheetNameFromSheetAddresses(e).replaceAll(te,"'"),l.ExcelCalc.localAddressesFromSheetAddresses(e)]}function se(e,t){const[n,a]=le(e),o=t.get(e)?.sheetId;if(!o){const e="getSheetAndAddress: sheet deleted";throw(0,b.Uc)(r.O.PythonUnexpectedMissingSheetInContextExtraction,e,void 0)}return{sheet:o,address:a}}function ce(e){return e.replace(B,"")}function de(e){const t=$.exec(e);return(null!=t?t[1]:"").replace(/""/g,'"')}function ue(e,t,n){let a;return e=e.replace(/"/g,'""'),a=t?`=PY("${e}", ${n})`:`"=PY(""${e=e.replace(/"/g,'""')}"",${n})"`,a}async function me(e,t,n,a,o,l,s){const c=performance.now();let d;try{if(s?.signal.aborted)throw(0,b.Uc)(r.O.PythonContextExtractionAborted,"retryForPythonScenario was aborted.",void 0);return o&&(d=await l((0,v.q9)()),d!==u.OP.PythonCellsCalculating&&l(p.m.startExecutingCommand({command:u.OP.PythonCellsCalculating}))),await(0,L.U)(e,t,(()=>!1),n,void 0,!0,a,s)}catch(e){if(!e){let e="";throw e=`Empty response from retryIf, Total Wait Time (ms): ${performance.now()-c}, Retry Interval (ms): ${a}, Max Attempts: ${n}`,(0,b.BH)(e)}if(e instanceof Error&&e.name===i.UW.AbortError)throw(0,b.Uc)(r.O.PythonContextExtractionAborted,"retryForPythonScenario was aborted.",e);throw e}finally{d&&d!==u.OP.PythonCellsCalculating&&l(p.m.startExecutingCommand({command:d}))}}function ge(e,t){const n=new Map([[Excel.ErrorCellValueType.python,"#PYTHON"],[Excel.ErrorCellValueType.timeout,"#TIMEOUT"]]),a=(0,m.YCq)(),o=n.get(e);return o?(0,C.L)((0,m.IiW)(),o,t):a}function he(e){return`from excel import xl_ref as xl\nimport excel\n\n_ref_context = excel.get_ref_context()\n_ref_context.clear()\n_ref_context["stored_value"] = excel.ObjectReference("${e}")\n\nprimitives = (bool, str, int, float, type(None))\nvalue = None\nvalue_type = type(xl("stored_value"))\nis_data_frame = value_type == pd.DataFrame\nis_primitive = value_type in primitives\nif is_data_frame:\n  numRows = xl("stored_value").shape[0]\n  value = {\n    "columnNames": xl("stored_value").columns.values.tolist(),\n    "dataTypes": xl("stored_value").dtypes.tolist(),\n    "firstRowValues": xl("stored_value").iloc[0].values.tolist() if numRows > 0 else [],\n    "secondRowValues": xl("stored_value").iloc[1].values.tolist() if numRows > 1 else [],\n    "sampleRows": xl("stored_value").head(20).values.tolist() if numRows > 0 else [],\n    "numRows": numRows,\n    "numColumns": xl("stored_value").shape[1],\n  }\nelif is_primitive:\n  value = xl("stored_value")\nreturnValue = {\n  "value": value,\n  "value_type": value_type,\n  "is_data_frame": is_data_frame,\n  "is_primitive": is_primitive,\n}\nreturnValue`}function pe(e){return e.map((e=>void 0===e?.value?e:e.value))}function be(e){const t=e.valuesAsJson[0][0];return{errorName:t.errorName,errorType:t.errorType??"",errorSubType:t.errorSubType,errorMessage:t.errorMessage}}function fe(e){if(e.includes("!")){return`'${l.ExcelCalc.sheetNameFromSheetAddresses(e)}'!${l.ExcelCalc.localAddressesFromSheetAddresses(e)}`}return e}async function Ce(){return Excel.run((async e=>(e.application.load("calculationMode"),await e.sync(),e.application.calculationMode)))}async function ye(e,t){const n=e.workbook.worksheets.getItemOrNullObject(t);if(!n){const{sheet:t}=await Ie(e,a.CP);return t}return n}async function ve(e,t){const n=e.workbook.worksheets.load("items/name");await e.sync();const a=n.items.map((e=>e.name)),o=t(a);return n.add(o)}async function Te(e){const t=await ve(e,I.getNextAvailableSheetName.bind(I));return await e.sync(),t}async function xe(e,t){try{const n=e.customProperties.getItemOrNullObject("lastPythonCell");if(n.load("value,isNullObject"),await t.sync(),!n.isNullObject)return JSON.parse(n.value)}catch(e){const t=(0,b.pX)(e,"getLastPythonCellCustomProperty: Failed to retrieve last Python cell custom property.");(0,b.QX)((0,T.KA)().dispatch,t,!1)}return null}async function Se(e,t,n){try{e.customProperties.add("lastPythonCell",JSON.stringify(n)),await t.sync()}catch(e){const t=(0,b.pX)(e,"setLastPythonCellCustomProperty: Failed to set last Python cell custom property.");(0,b.QX)((0,T.KA)().dispatch,t,!1)}}async function we(){let e="";try{(0,y.EeR)()&&await Excel.run((async t=>{const n=t.workbook.worksheets.getActiveWorksheet();await Ee(n,t)&&((0,S.PB)(h.L3.AdvancedAnalysisStartedFromAnalysisSheet,[]),n.load("name"),await t.sync(),e=n.name)}))}catch(t){const n=(0,b.pX)(t,"getPythonAnalysisSheetName: Failed to retrieve Python analysis sheet name.");(0,b.QX)((0,T.KA)().dispatch,n,!1),e=""}return e}async function Ee(e,t){try{const n=e.customProperties.getItemOrNullObject("isPythonAnalysisSheet");return n.load("value"),await t.sync(),!!n&&"true"===n.value}catch(e){const t=(0,b.pX)(e,"getPythonAnalysisCustomProperty: Failed to retrieve custom metadata for the Python analysis sheet.");return(0,b.QX)((0,T.KA)().dispatch,t,!1),!1}}async function Ie(e,t){const n=await ve(e,E.getNextAvailableSheetName.bind(E));n.load("id");const a=n.getRange("A1");return a.values=[[(0,m.Efv)()]],a.format.font.bold=!0,a.format.font.size=24,a.format.font.color=R.e,n.getRange("A2").values=[[(0,m.LAW)()]],function(e){e.customProperties.add("isPythonAnalysisSheet","true")}(n),await e.sync(),n.activate(),t.pythonContextManager.pythonAnalysisSheetId=n.id,{id:n.id,sheet:n}}async function Re(e,t){let n="";return await Excel.run({delayForCellEdit:!1},(async a=>{const o=t.pythonContextManager.pythonAnalysisSheetId;if(o){const i=a.workbook.worksheets.getItemOrNullObject(o);if(i.load("isNullObject"),await a.sync(),i.isNullObject){if(t.pythonContextManager.pythonAnalysisSheetExistsOnUserQuerySubmit)throw(0,b.Vp)(r.O.PythonDeletedSheetDuringResponseGeneration,"",void 0);{const o=(0,b.Vp)(r.O.PythonDeletedSheetBeforeResponseGeneration,"",void 0);(0,b.QX)(e,o,!0);const{id:i}=await Ie(a,t);n=i}}else i.activate(),n=o}else{const{id:e}=await Ie(a,t);n=e}})),n}async function Ae(e,t){if((0,y.EeR)()){!a.CP.pythonContextManager.pythonAnalysisSheetId&&await Ee(e,t)&&(e.load("id"),await t.sync(),a.CP.pythonContextManager.pythonAnalysisSheetId=e.id)}}async function Le(e){const t=e.pythonContextManager.pythonAnalysisSheetId;if(t){let e=!1;return await Excel.run((async n=>{const a=n.workbook.worksheets.getItemOrNullObject(t);a.load("isNullObject"),await n.sync(),e=!a.isNullObject})),e}return!1}function ke(e,t){const n=function(e){return e.replaceAll(ee,"''").replaceAll(K,'\\"')}(l.ExcelCalc.sheetNameFromSheetAddresses(e)),a=l.ExcelCalc.addressToExcelRange(l.ExcelCalc.localAddressesFromSheetAddresses(e));return a.bottomRight.row&&(a.bottomRight.row-=t?1:0),`'${n}'!${l.ExcelCalc.IExcelRangeToAddress(a)}`}function Fe(e,t){return"sampleRows"===e||"columnNames"===e||"dataTypes"===e?JSON.stringify(t):t}function _e(e,t){(0,o.cY)(o.SA.Verbose,`%cPython Ada ${e}`,`\n      font-size: 1em;\n      padding: 0.5em 2em;\n      margin: 1em 0;\n      color: white;\n      background-color: ${t};\n      border-radius: 10%;\n      `)}function Pe(e){(0,o.cY)(o.SA.Verbose,"Python Ada: "+e)}function Ne(e){return JSON.stringify(e,Fe,4).replace(/\\n/g,"\n").replace(/\\/g,"").replace(/"\[/g,"[").replace(/\]"/g,"]").replace(/"\{/g,"{").replace(/\}"/g,"}")}function Me(e){if((0,o.K_)()){_e("Context","blue");Pe(Ne(e))}}function Oe(e){(0,o.K_)()&&(_e("Prompt","blue"),Pe(e||"Prompt is empty."))}function De(e){if((0,o.K_)()){_e("Response Chunks","blue");const t=e.filter((e=>"debugText"!==e.type));0===t.length?Pe("Response Chunks are empty."):t.forEach((e=>{Pe(Ne(e))})),_e("Debug Chunks","blue");const n=e.filter((e=>"debugText"===e.type));0===t.length?Pe("Debug Chunks are empty."):n.forEach((e=>{Pe(Ne(e))}))}}function Be(e){_e("Python Error","red");Pe(e.toString())}async function $e(e,t,n){try{t.format.autofitRows(),await e.sync(),t.untrack()}catch(e){const t=(0,b.zj)(r.O.PythonAutofitFailed,"",e);(0,b.QX)(n,t,!1)}}function He(e,t){return!e.some((e=>e.type===t))}function Ue(e,t){return(t?.trim()?"#"+t+"\n":"")+e}function qe(e){return e===i.qf.PngImageFile||e===i.qf.ImageFile||tt()&&(e===i.qf.PythonPlot||e===i.qf.MatplotlibPlot)}async function Ve(e,t){try{if((0,y.yw9)("OfficeVSO_10425729_TurnOffTeachingCalloutForMAA")&&et())return;a.CP.pythonContextManager.alreadyShownTui||await async function(e){await Excel.run({delayForCellEdit:!1},(async t=>{await e(t)}))}((async n=>{const a=n.workbook.worksheets.getItem(e).getRange(t);await Ge(a,"ShowPythonAdvancedAnalysisWave1A2")}))}catch(e){(0,b.RA)(e)}}async function We(e){try{if((0,y.yw9)("OfficeVSO_10425729_TurnOffTeachingCalloutForMAA")&&et())return;a.CP.pythonContextManager.alreadyShownTui||(a.CP.pythonContextManager.disableAutoScroll=!0,await async function(e){(0,c.vI)()===Office.PlatformType.OfficeOnline?s.s.getInstance().NativeServices.IPythonAAPrivateSdxApiService.value.showTeachingCalloutScenario(e):await OfficeFirstParty.PrivateApi.execute(e)}(e),a.CP.pythonContextManager.alreadyShownTui=!0,(0,S.Rj)(e))}catch(e){(0,b.RA)(e),a.CP.pythonContextManager.alreadyShownTui=!1}}async function Ge(e,t){try{if((0,y.yw9)("OfficeVSO_10425729_TurnOffTeachingCalloutForMAA")&&et())return;a.CP.pythonContextManager.alreadyShownTui||(a.CP.pythonContextManager.disableAutoScroll=!0,e.showTeachingCallout((0,m.g$5)(),(0,m.Toc)()),await e.context.sync(),a.CP.pythonContextManager.alreadyShownTui=!0,(0,S.Rj)(t))}catch(e){(0,b.RA)(e)}}async function ze(e){return await Excel.run({delayForCellEdit:!0},(async t=>{try{const n=t.workbook.worksheets.getActiveWorksheet().load(["protection/protected","protection/isPaused"]);return await t.sync(),!(n.protection.protected&&!n.protection.isPaused)||((0,b.Kx)(e,new g.H({errorCode:r.O.PythonProtectedSheetObjectInsertionError}),"canEditCurrentWorksheet",!1),!1)}catch(t){return(0,b.Kx)(e,new g.H({errorCode:r.O.PythonProtectedSheetObjectInsertionError,innerError:t}),"canEditCurrentWorksheet",!1),!1}}))}async function Qe(e){try{a.CP.pythonContextManager.exitAdvancedAnalysisMode()}catch(e){a.CP.pythonContextManager.setIsPythonMode(!1),a.CP.pythonContextManager.unregisterOnNewEntry();const t=e instanceof Error?`Function: pythonContextManager.exitAdvancedAnalysisMode, Stack: ${e.stack}`:"Function: pythonContextManager.exitAdvancedAnalysisMode",n=(0,b.$C)(t,e);(0,b.QX)((0,T.KA)().dispatch,n,!1)}finally{(0,S.PB)(h.L3.ExitAnalysisClicked,[]),(0,T.KA)().dispatch((0,v.Nl)()),await(0,T.KA)().dispatch((0,v.L4)(e)),A.n.displayPythonTextResponse((0,T.KA)().dispatch,(0,m.Lby)(),!1)}}function je(e,t){Excel.run((async n=>{try{const a=n.workbook.worksheets.getItemOrNullObject(e);if(await n.sync(),a.isNullObject)return;a.activate(),a.getRange(t).select(),await n.sync()}catch{(0,S.PB)(h.L3.GoBackToAnalysisSheetFailed,[])}}))}const Je=["int","int8","int16","int32","int64","pandas.core.dtypes.Int64Dtype","numpy.intp","numpy.uintp","numpy.int8","numpy.uint8","numpy.int16","numpy.uint16","numpy.int32","numpy.uint32","numpy.int64","numpy.uint64","numpy.byte","numpy.ubyte","numpy.short","numpy.ushort","numpy.intc","numpy.uintc","numpy.long","numpy.ulong","numpy.longlong","numpy.ulonglong","float","float16","float32","float64","float96","float128","Float","numpy.float16","numpy.float32","numpy.float64","numpy.float96","numpy.float128","numpy.half","numpy.single","numpy.double","numpy.longdouble","bool","bool_","numpy.bool","numpy.bool_","BoolDtype","str","string","str_","ellipsis","function","module","NoneType","type","undefined"],Ye=["scipy.","sklearn.","pandas.core.","pandas.io.","networkx."],Xe=["pandas.core.frame.DataFrame","pandas.core.series.Series","PIL.PngImagePlugin.PngImageFile"],Ze=Je.map((e=>"<class '"+e+"'>"));function Ke(e){return"Error"!==e.outputType&&(t=e.outputType,!Ze.includes(t)&&!function(e){const t=Ye.map((t=>e.includes(t))).some((e=>e));if(t){return!Xe.map((t=>e.includes(t))).some((e=>e))}return t}(e.outputType));var t}function et(){return(0,y.EJJ)()&&!a.CP.pythonContextManager.isPythonMode}function tt(){return(0,y.tMD)()&&!et()}},470131:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var a=n(535718),o=n.n(a),r=n(871038),i=n.n(r)()(o());i.push([e.id,'.ChartRecommendationCard {\n  border: 1px solid var(--colorNeutralStroke1);\n  border-radius: 18px !important;\n  margin-top: 4px;\n}\n\n.ChartRecommendationCardText {\n  font-style: normal;\n  font-weight: 600 !important;\n  font-size: 14px;\n  padding: 0px;\n}\n\n.chartContainer {\n  border: 2px solid #f5f5f5;\n  border-radius: 12px;\n  overflow: hidden;\n}\n\n.chartContainer:hover {\n  border: 2px solid var(--colorBrandStroke1);\n}\n\n.chartContainerSelected {\n  border: 2px solid var(--colorBrandStroke1);\n  border-radius: 12px;\n  overflow: hidden;\n}\n\n.previewDesignButton,\n.applyDesignButton {\n  border: 2px solid #edebe9 !important;\n  border-radius: 6px !important;\n  padding: 8px 6px 8px 6px !important;\n  margin-top: 10px !important;\n  margin-bottom: 0px !important;\n}\n\n.chartRecommendationCardFooter,\n.chartRecommendationCardFooter:hover {\n  color: var(--colorBrandStroke1) !important;\n  text-decoration: underline !important;\n  display: block !important;\n  border: none !important;\n  font-weight: normal !important;\n  font-size: 14px !important;\n  margin-top: 6px !important;\n  padding-left: 0px !important;\n}\n\n.noShowIcon,\n.noShowIcon:hover {\n  color: var(--colorBrandStroke1);\n  font-size: 12px;\n  padding-left: 0px;\n}\n\n.backToResultButton {\n  border: none;\n  margin-bottom: 8px;\n}\n\n.chartRecommendationLabel {\n  font-size: 14px;\n  font-weight: normal;\n  padding: 0px !important;\n  margin-top: 0px;\n  margin-bottom: 5px;\n}\n\n.chartRecommendationSubLabel {\n  font-size: 12px;\n  font-weight: lighter;\n  opacity: 0.7;\n}\n\n.chartRecommendationLabelApply {\n  font-size: 14px;\n  font-weight: normal;\n  padding: 0px !important;\n  margin-top: 10px;\n  margin-bottom: 10px;\n}\n\n.sparkleIcon {\n  width: 28px;\n  height: 26px;\n}\n\n.chartItem {\n  width: 50%;\n  align-items: stretch;\n}\n\n.ms-Stack.ms-Stack-child {\n  align-items: stretch !important;\n}\n\n.chartContainerError {\n  width: 100%;\n  text-align: center;\n  font-size: 14px;\n  font-family: "Aptos";\n  font-weight: 400;\n  color: #bdbdbd;\n  align-content: center;\n  border: 2px solid #f5f5f5;\n  border-radius: 12px;\n  overflow: hidden;\n}\n\n@media screen and (-ms-high-contrast: active), (forced-colors: active) {\n  .ChartRecommendationCard {\n    border-radius: 18px !important;\n    border: 2px solid buttontext;\n  }\n\n  .chartContainer,\n  .chartContainerError {\n    border: 2px solid buttontext;\n  }\n\n  .chartContainer:hover,\n  .chartContainerSelected {\n    border: 2px solid highlight;\n  }\n\n  .chartRecommendationCardFooter,\n  .chartRecommendationCardFooter:hover {\n    border: 2px solid buttontext !important;\n  }\n\n  .chartRecommendationCardFooter:hover {\n    color: highlight !important;\n    border: 2px solid highlight;\n  }\n\n  .previewDesignButton,\n  .applyDesignButton {\n    border: 2px solid buttontext !important;\n  }\n\n  .previewDesignButton:hover,\n  .applyDesignButton:hover {\n    border: 2px solid highlight !important;\n  }\n\n  .backToResultButton {\n    border: 2px solid buttontext !important;\n  }\n}\n',"",{version:3,sources:["webpack://./src/frontend/styles/ChartDesignRecommendationsCard.css"],names:[],mappings:"AAAA;EACE,4CAA4C;EAC5C,8BAA8B;EAC9B,eAAe;AACjB;;AAEA;EACE,kBAAkB;EAClB,2BAA2B;EAC3B,eAAe;EACf,YAAY;AACd;;AAEA;EACE,yBAAyB;EACzB,mBAAmB;EACnB,gBAAgB;AAClB;;AAEA;EACE,0CAA0C;AAC5C;;AAEA;EACE,0CAA0C;EAC1C,mBAAmB;EACnB,gBAAgB;AAClB;;AAEA;;EAEE,oCAAoC;EACpC,6BAA6B;EAC7B,mCAAmC;EACnC,2BAA2B;EAC3B,6BAA6B;AAC/B;;AAEA;;EAEE,0CAA0C;EAC1C,qCAAqC;EACrC,yBAAyB;EACzB,uBAAuB;EACvB,8BAA8B;EAC9B,0BAA0B;EAC1B,0BAA0B;EAC1B,4BAA4B;AAC9B;;AAEA;;EAEE,+BAA+B;EAC/B,eAAe;EACf,iBAAiB;AACnB;;AAEA;EACE,YAAY;EACZ,kBAAkB;AACpB;;AAEA;EACE,eAAe;EACf,mBAAmB;EACnB,uBAAuB;EACvB,eAAe;EACf,kBAAkB;AACpB;;AAEA;EACE,eAAe;EACf,oBAAoB;EACpB,YAAY;AACd;;AAEA;EACE,eAAe;EACf,mBAAmB;EACnB,uBAAuB;EACvB,gBAAgB;EAChB,mBAAmB;AACrB;;AAEA;EACE,WAAW;EACX,YAAY;AACd;;AAEA;EACE,UAAU;EACV,oBAAoB;AACtB;;AAEA;EACE,+BAA+B;AACjC;;AAEA;EACE,WAAW;EACX,kBAAkB;EAClB,eAAe;EACf,oBAAoB;EACpB,gBAAgB;EAChB,cAAc;EACd,qBAAqB;EACrB,yBAAyB;EACzB,mBAAmB;EACnB,gBAAgB;AAClB;;AAEA;EACE;IACE,8BAA8B;IAC9B,4BAA4B;EAC9B;;EAEA;;IAEE,4BAA4B;EAC9B;;EAEA;;IAEE,2BAA2B;EAC7B;;EAEA;;IAEE,uCAAuC;EACzC;;EAEA;IACE,2BAA2B;IAC3B,2BAA2B;EAC7B;;EAEA;;IAEE,uCAAuC;EACzC;;EAEA;;IAEE,sCAAsC;EACxC;;EAEA;IACE,uCAAuC;EACzC;AACF",sourcesContent:['.ChartRecommendationCard {\n  border: 1px solid var(--colorNeutralStroke1);\n  border-radius: 18px !important;\n  margin-top: 4px;\n}\n\n.ChartRecommendationCardText {\n  font-style: normal;\n  font-weight: 600 !important;\n  font-size: 14px;\n  padding: 0px;\n}\n\n.chartContainer {\n  border: 2px solid #f5f5f5;\n  border-radius: 12px;\n  overflow: hidden;\n}\n\n.chartContainer:hover {\n  border: 2px solid var(--colorBrandStroke1);\n}\n\n.chartContainerSelected {\n  border: 2px solid var(--colorBrandStroke1);\n  border-radius: 12px;\n  overflow: hidden;\n}\n\n.previewDesignButton,\n.applyDesignButton {\n  border: 2px solid #edebe9 !important;\n  border-radius: 6px !important;\n  padding: 8px 6px 8px 6px !important;\n  margin-top: 10px !important;\n  margin-bottom: 0px !important;\n}\n\n.chartRecommendationCardFooter,\n.chartRecommendationCardFooter:hover {\n  color: var(--colorBrandStroke1) !important;\n  text-decoration: underline !important;\n  display: block !important;\n  border: none !important;\n  font-weight: normal !important;\n  font-size: 14px !important;\n  margin-top: 6px !important;\n  padding-left: 0px !important;\n}\n\n.noShowIcon,\n.noShowIcon:hover {\n  color: var(--colorBrandStroke1);\n  font-size: 12px;\n  padding-left: 0px;\n}\n\n.backToResultButton {\n  border: none;\n  margin-bottom: 8px;\n}\n\n.chartRecommendationLabel {\n  font-size: 14px;\n  font-weight: normal;\n  padding: 0px !important;\n  margin-top: 0px;\n  margin-bottom: 5px;\n}\n\n.chartRecommendationSubLabel {\n  font-size: 12px;\n  font-weight: lighter;\n  opacity: 0.7;\n}\n\n.chartRecommendationLabelApply {\n  font-size: 14px;\n  font-weight: normal;\n  padding: 0px !important;\n  margin-top: 10px;\n  margin-bottom: 10px;\n}\n\n.sparkleIcon {\n  width: 28px;\n  height: 26px;\n}\n\n.chartItem {\n  width: 50%;\n  align-items: stretch;\n}\n\n.ms-Stack.ms-Stack-child {\n  align-items: stretch !important;\n}\n\n.chartContainerError {\n  width: 100%;\n  text-align: center;\n  font-size: 14px;\n  font-family: "Aptos";\n  font-weight: 400;\n  color: #bdbdbd;\n  align-content: center;\n  border: 2px solid #f5f5f5;\n  border-radius: 12px;\n  overflow: hidden;\n}\n\n@media screen and (-ms-high-contrast: active), (forced-colors: active) {\n  .ChartRecommendationCard {\n    border-radius: 18px !important;\n    border: 2px solid buttontext;\n  }\n\n  .chartContainer,\n  .chartContainerError {\n    border: 2px solid buttontext;\n  }\n\n  .chartContainer:hover,\n  .chartContainerSelected {\n    border: 2px solid highlight;\n  }\n\n  .chartRecommendationCardFooter,\n  .chartRecommendationCardFooter:hover {\n    border: 2px solid buttontext !important;\n  }\n\n  .chartRecommendationCardFooter:hover {\n    color: highlight !important;\n    border: 2px solid highlight;\n  }\n\n  .previewDesignButton,\n  .applyDesignButton {\n    border: 2px solid buttontext !important;\n  }\n\n  .previewDesignButton:hover,\n  .applyDesignButton:hover {\n    border: 2px solid highlight !important;\n  }\n\n  .backToResultButton {\n    border: 2px solid buttontext !important;\n  }\n}\n'],sourceRoot:""}]);const l=i},472096:(e,t,n)=>{"use strict";n.d(t,{$$:()=>i,Gt:()=>a,QK:()=>o,fU:()=>r});var a=function(){function e(){}return e.isWebPlatform=function(){return Office.context.platform===Office.PlatformType.OfficeOnline},e.isMacPlatform=function(){return Office.context.platform===Office.PlatformType.Mac},e.isIOSPlatform=function(){return Office.context.platform===Office.PlatformType.iOS},e.isWin32Platform=function(){return Office.context.platform===Office.PlatformType.PC},e}(),o=a.isWebPlatform,r=a.isMacPlatform,i=a.isIOSPlatform},474353:(e,t,n)=>{"use strict";async function a(e,t){const n=performance.now();try{return await e}finally{if(t){t(performance.now()-n)}}}n.d(t,{H:()=>a,q:()=>o});class o{getName(e){return this.prefix?`${this.prefix}:${e}`:e}start(e){const t=this.getName(e);this.parent?this.parent.start(t):this.measures.set(t,{startTime:performance.now(),duration:NaN})}end(e){const t=this.getName(e);if(this.parent)this.parent.end(t);else{const e=this.measures.get(t);e&&(e.duration=performance.now()-e.startTime)}}getAll(){return Object.fromEntries(this.measures.entries())}async measure(e,t){this.start(e);try{return await t}finally{this.end(e)}}withPrefix(e){return new o(e,this)}constructor(e="",t=null){this.prefix=e,this.parent=t,this.measures=new Map}}},474862:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateV7State=void 0;const a=n(575976),o=n(154836),r={};function i(e,t,n){return e.msecs??=-1/0,e.seq??=0,t>e.msecs?(e.seq=n[6]<<23|n[7]<<16|n[8]<<8|n[9],e.msecs=t):(e.seq=e.seq+1|0,0===e.seq&&e.msecs++),e}function l(e,t,n,a,o=0){if(e.length<16)throw new Error("Random bytes length must be >= 16");if(a){if(o<0||o+16>a.length)throw new RangeError(`UUID byte range ${o}:${o+15} is out of buffer bounds`)}else a=new Uint8Array(16),o=0;return t??=Date.now(),n??=127*e[6]<<24|e[7]<<16|e[8]<<8|e[9],a[o++]=t/1099511627776&255,a[o++]=t/4294967296&255,a[o++]=t/16777216&255,a[o++]=t/65536&255,a[o++]=t/256&255,a[o++]=255&t,a[o++]=112|n>>>28&15,a[o++]=n>>>20&255,a[o++]=128|n>>>14&63,a[o++]=n>>>6&255,a[o++]=n<<2&255|3&e[10],a[o++]=e[11],a[o++]=e[12],a[o++]=e[13],a[o++]=e[14],a[o++]=e[15],a}t.updateV7State=i,t.default=function(e,t,n){let s;if(e)s=l(e.random??e.rng?.()??(0,a.default)(),e.msecs,e.seq,t,n);else{const e=Date.now(),o=(0,a.default)();i(r,e,o),s=l(o,r.msecs,r.seq,t,n)}return t??(0,o.unsafeStringify)(s)}},475594:(e,t,n)=>{"use strict";e.exports=n(380070)},480591:(e,t,n)=>{"use strict";n.d(t,{BI:()=>f,jX:()=>a});var a,o=n(86940),r=n(47717),i=n(660606),l=n(423905),s=n(83437),c=n(638753),d=n(702864),u=n(425903),m=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{s(a.next(e))}catch(e){r(e)}}function l(e){try{s(a.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((a=a.apply(e,t||[])).next())}))},g=function(e,t){var n,a,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(n=1,a&&(o=2&l[0]?a.return:l[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,l[1])).done)return o;switch(a=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,a=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],a=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},h=new Set([r.n3.TriggerConfirmation,r.n3.TriggerPluginAuth,r.n3.TriggerPlugin]),p=function(e){return h.has(null==e?void 0:e.messageType)},b=function(e,t,n,a,r){return m(void 0,void 0,void 0,(function(){var i,l;return g(this,(function(s){switch(s.label){case 0:return d.xP.setIsAddinFlow(!0,(function(){(0,c.An)(e,!0)})),[4,null!==(l=null===(i=e.current)||void 0===i?void 0:i.executeClientSkillFromInterstitialMessage({chatCardType:o._.InterstitialMessage,stopLoadingUi:!1,chatMessageData:{interstitialMessageProps:{user:"chat",interstitialMessages:r?a:[t],skillRequest:1===n.length?n[0]:void 0,skillRequests:n.length>1?n:void 0}},chatMessageBodyData:{messageId:t.messageId},addCardToChatHistory:!1}))&&void 0!==l?l:Promise.resolve()];case 1:return s.sent(),[2]}}))}))},f=function(e,t,n){return m(void 0,void 0,void 0,(function(){var m,h,f,C,y,v;return g(this,(function(g){switch(g.label){case 0:return m=null!==(y=e.messages)&&void 0!==y?y:[],h=m[m.length-1],0!==m.length&&p(h)?h.messageType===r.n3.TriggerPlugin?[3,1]:[3,6]:[2,!1];case 1:if(!n.enableAddinLocalPluginActions)return[3,5];f=function(e){for(var t,n=null!==(t=e.messages)&&void 0!==t?t:[],a=[],o=n.length-1;o>=0;o--){var i=n[o];if((null==i?void 0:i.messageType)!==r.n3.TriggerPlugin)break;a.push(i)}return a.reverse()}(e),(0,i.cY)("TriggerPlugin messages:",f),C=function(e){return e.map((function(e){var t,n;return{correlationId:null===(t=e.localTransportRequest)||void 0===t?void 0:t.correlation_id,localEndpoint:"InvokeAddInLocalPlugin/TriggerPlugin/"+(null==e?void 0:e.pluginInfo.data.MetaOSTitleId),payload:null===(n=e.localTransportRequest)||void 0===n?void 0:n.invocation.payload,sourceRequestId:e.sourceRequestId,actionId:e.actionId}}))}(f),function(e){var t;a=Date.now(),i.EG.sendChatEventTelemetry((0,l.pN)(((t={})[s.h3.ChatEventType]=s.a5.LocalAddinActionInvoked,t[s.h3.ChatEventParameters]=JSON.stringify({numberOfTriggerPluginMessages:e}),t)))}(f.length),g.label=2;case 2:return g.trys.push([2,4,,5]),[4,b(t,h,C,m,n.passAllMessages)];case 3:return g.sent(),[3,5];case 4:return function(e,t){var n,o;d.xP.setIsAddinFlow(!1,(function(){(0,c.An)(t,!1)})),a=void 0,o=e instanceof Error?e.message:"string"==typeof e?e:"Unknown error",(0,u.Xh)(o),null===(n=t.current)||void 0===n||n.addResponseMessage((0,u.a2)(o))}(g.sent(),t),[3,5];case 5:return[3,7];case 6:null===(v=t.current)||void 0===v||v.addResponseMessage({chatCardType:o._.InterstitialMessage,stopLoadingUi:!0,chatMessageData:{interstitialMessageProps:{user:"chat",interstitialMessages:n.passAllMessages?m:[h]}},chatMessageBodyData:{messageId:h.messageId},addCardToChatHistory:!1}),g.label=7;case 7:return[2,!0]}}))}))}},480870:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.SafetyOptions=void 0,function(e){e[e.NoSafety=0]="NoSafety",e[e.OnlyAllowMakerSafeApi=1024]="OnlyAllowMakerSafeApi",e[e.OnlyAllowCopilotSafeApi=32768]="OnlyAllowCopilotSafeApi"}(n||(t.SafetyOptions=n={}))},481797:(e,t,n)=>{"use strict";n.d(t,{Cd:()=>r,Xz:()=>i,Y7:()=>c,tP:()=>l,wc:()=>s,zC:()=>o});var a=n(764081),o=function(){var e=new URL(window.location.href),t=e.pathname.split("/"),n=t.length-1;return t[n].endsWith(".html")&&(t[n]="msgExtDialog.html"),e.pathname=t.join("/"),e.toString()},r=function(e){var t;if("number"==typeof e)return e;if("string"==typeof e){var n=parseInt(e,10);if(!isNaN(n))return n;return null!==(t={large:-3,medium:-2,small:-1}[e.toLowerCase()])&&void 0!==t?t:-2}return-2},i=function(e,t){return Math.floor(e/t*100)},l=function(e){var t,n;return null!==(n=((t={})[-1]=a.yT,t[-2]=a.ag,t[-3]=a.Nz,t)[e])&&void 0!==n?n:a.ag},s=function(e){var t,n;return null!==(n=((t={})[-1]=a.fH,t[-2]=a.$H,t[-3]=a.qj,t)[e])&&void 0!==n?n:a.$H},c=12006},482454:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var a=n(535718),o=n.n(a),r=n(871038),i=n.n(r)()(o());i.push([e.id,".fai-CopilotMessage__content{width:100%}","",{version:3,sources:["webpack://./src/frontend/styles/components/_adaptive-cards.scss"],names:[],mappings:"AAEA,6BACE,UAAA",sourcesContent:["// This is a workaround to fix an infinite resizing bug in swiper + adaptivecards\n// It ensures the parent container of the adaptive card has a fixed width\n.fai-CopilotMessage__content {\n  width: 100%;\n}\n"],sourceRoot:""}]);const l=i},486894:(e,t,n)=>{"use strict";n.d(t,{UO:()=>d,Vq:()=>c,q9:()=>s,uR:()=>l});var a=n(92520),o=n(507628);const r=new Map,i={id:"",resolve:()=>{},reject:()=>{}};async function l(){await Excel.run({delayForCellEdit:!0},(async e=>{const t=e.workbook.tables.load("items/name");await e.sync();for(const n of t.items)await u(e,n)}))}function s(e){m(e,void 0,`Table ${e} was deleted.`)}async function c(e){await Excel.run({delayForCellEdit:!0},(async t=>{const n=t.workbook.tables.getItem(e).load("name");await t.sync(),r.has(n.name)||await u(t,n)}))}async function d(e){const t=r.get(e.tableId);if(!t)throw new Error(`Table ${e.tableId} was not registered for applyPowerQueryTableUpdatePlan.`);if(!e.planJson)throw new Error("planJson is missing in the annotation.");if(t!==i)throw new Error(`Table ${e.tableId} is busy.`);return await Excel.run({delayForCellEdit:!0},(async t=>{const n=t.workbook.tables.getItem(e.tableId),i=(0,o.A)(),l=function(e,t){return new Promise(((n,a)=>{r.set(e,{id:t,resolve:n,reject:a})}))}(e.tableId,i);try{n.applyPowerQueryTableUpdatePlan(i,e.planJson),await t.sync()}catch(t){(0,a.cY)(`applyPowerQueryTableUpdatePlan failed: ${t}`),t instanceof Error?m(e.tableId,i,t):m(e.tableId,i,`An unexpected error occurred during applyPowerQueryTableUpdatePlan: '${t}'`)}await l})),`I applied the following power query transformation on the table: '${e.queryScriptExplanation}'`}async function u(e,t){h(t.name),t.onApplyPowerQueryTableUpdatePlanCompleted.add((async e=>{var n,a;e.success?(n=t.name,a=e.id,g(n,a,(e=>e.resolve()))):m(t.name,e.id,e.error)})),await e.sync()}function m(e,t,n){g(e,t,(e=>{n instanceof Error?e.reject(n):e.reject(new Error(n))}))}function g(e,t,n){const a=r.get(e);if(a&&a!==i){if(t&&t!==a.id)return;try{n(a)}finally{h(e)}}}function h(e){r.set(e,i)}},493284:(e,t,n)=>{"use strict";n.d(t,{k:()=>p,n:()=>b});var a=n(86940),o=n(293879),r=n(708353),i=n(857677),l=n(164976),s=n(779939),c=n(347145),d=n(99558),u=n(306148),m=n(507628);const g=i.q.AnalyzeData,h="Copilot\\Analyze Data";function p({requestId:e,adaptiveCardDefinition:t,cardButtonCallback:n}){return{message:{chatCardType:a._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:o.Q9.Chat,renderData:(0,l.IM)("ChartAdaptiveCard_V1",{requestId:e,adaptiveCardDefinition:t,cardButtonCallback:n}),textContent:(0,s.hk)(t)}},chatMessageBodyData:{messageId:(0,m.A)(),shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:h}},addCardToChatHistory:!0},telemetry:{featureName:g,eventType:i.a5.SuggestionMessage}}}const b={getChartAdaptiveCardResponse:p,getAnalyzeDataErrorResponse:function(e,t){const{message:n,telemetry:a}=(0,d.v)(e,{errorType:t??i.q0.ClientError,featureName:g},{},{feedbackData:{feedbackArea:h},shouldShowAIGeneratedIndicator:!0});return{message:n,telemetry:a}},getAnalyzeDataRecommendationResponse:function({visual:e,requestId:t,responseText:n,caveats:d,tableName:u,tableContext:p,query:b}){const f=(0,s.Pp)(e,p.address);return{message:{chatCardType:a._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:o.Q9.Chat,renderData:(0,l.IM)("AnalyzeData_V1",{tableName:u,visual:e,requestId:t,responseText:n,caveats:d,tableContext:p,query:b}),textContent:f}},chatMessageBodyData:{messageId:(0,c.yw9)("OfficeVSO_8691849_CopilotChartToImage")?(0,m.A)():void 0,shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:h}},addCardToChatHistory:!0},telemetry:{featureName:g,eventType:i.a5.SuggestionMessage}}},getAnalyzeDataInsertSuccessResponse:function({tableContext:e,messageText:t,confirmationMessage:n,suggestionId:l="",shouldShowGoBackToTableButton:s,originalDataSheetId:d}){const m=[];return s&&e&&m.push((0,u.zY)(e,d)),(0,c.BAK)()&&m.push((0,u.FW)(g,l)),{message:{chatCardType:a._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:t},messageFooter:n?{text:n}:void 0}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:h},actionButtonList:m}},telemetry:{featureName:g,eventType:i.a5.ActionConfirmationMessage}}},getAnalyzeDataUserChat:function(e){return{message:{chatCardType:a._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Human,messageHeader:{text:e}}}},telemetry:{featureName:g,eventType:i.a5.HumanInput}}},getTextAnalysisV1Response:function({requestId:e,textAnalysis:t,title:n}){return{message:{chatCardType:a._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:o.Q9.Chat,renderData:(0,l.IM)("TextAnalysis_V1",{requestId:e,textAnalysis:t,title:n}),textContent:(0,s.oG)(n,t)}},chatMessageBodyData:{messageId:(0,c.yw9)("OfficeVSO_8691849_CopilotChartToImage")?(0,m.A)():void 0,shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:h}},addCardToChatHistory:!0},telemetry:{featureName:g,eventType:i.a5.SuggestionMessage}}},getFullThemingSuggestionResponse:function(e,t){return{message:{chatCardType:a._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:o.Q9.Chat,renderData:(0,l.IM)("TextAnalysisSuggestion",{requestId:e,columnName:t}),textContent:(0,s.qM)()}},chatMessageBodyData:{messageId:(0,m.A)(),shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:h}},addCardToChatHistory:!0},telemetry:{featureName:g,eventType:i.a5.SuggestionMessage}}},getAnalyzeDataInfoResponse:function(e,t){const n=(0,m.A)();return{message:{chatCardType:a._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:h},messageId:n,actionButtonList:(0,c.jHv)()?[(0,u.yo)(n)]:void 0},addCardToChatHistory:t},telemetry:{featureName:g,eventType:i.a5.AnalyzeDataEmptyAnswer}}},getAnalyzeDataMarkdownResponse:function(e){const t=(0,m.A)();return{message:{chatCardType:a._.MarkdownCard,chatMessageData:{markDownCardProps:{user:o.Q9.Chat,message:e}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:h},messageId:t,actionButtonList:(0,c.jHv)()?[(0,u.yo)(t)]:void 0},addCardToChatHistory:!0},telemetry:{featureName:g,eventType:i.a5.AnalyzeDataMarkdownMessage}}}}},493413:(e,t,n)=>{"use strict";n.d(t,{o:()=>h,r:()=>p});var a=n(279395),o=n(603222),r=n(384453),i=n(468967),l=n(110686),s=n(347145),c=n(508491),d=n(80765),u=n(887648),m=n(208520);const g=async(e,t,a,o,r,s,c,d,u,m,g,h,p,b,f,C,y)=>await Excel.run((async v=>{try{const T=await Promise.all([n.e("chunk1jsfluent"),n.e("vendors-npm_store_sdx_officecopilot_1js-excel-copilot-calc_8_3_43-1adabd76bb06679768ec_node_m-dd2f81"),n.e("calc")]).then(n.bind(n,478565)),x=c((0,l.Z)());let S={context:v,requestId:e,cellAddress:a,sheetId:o,calc:T,linkTheme:r,styles:s,valOper:void 0,isPythonCodeShown:g,setIsPythonCodeShown:h,dispatch:c,isLoadingUIShown:d,pythonUserRequestId:u,isInitialDataFrame:m,code:t,codeExplanation:f,codeLabel:C,isPythonExecutionSuccess:y,diagnosticsEntry:p,localeCache:x};S=await(async(e,t,n,a)=>{const o=a?e.extractOper(a):void 0;if(a&&!o){const e=`getValOperAndAddToProps: valOper is ${o?"defined":"undefined"} and pythonCell is ${a?"defined":"undefined"}.`,r=(0,i.pz)(e,void 0);(0,i.QX)(t,r,!1),n.isPythonExecutionSuccess=!1}return n.valOper=o,n})(T,c,S,b);const w=T.renderCodeAndPostView(S)??void 0;if(!w){const e="getCodeAndPostView: CodeAndPostView is undefined after renderCodeAndPostView.",t=(0,i.pz)(e,void 0);return(0,i.QX)(c,t,!1),S.isPythonExecutionSuccess=!1,T.renderCodeAndPostView(S)??void 0}return w}catch(b){return(async(e,t,a,o,r,s,c,d,u,m,g,h,p,b,f,C,y)=>{const v=(0,i.pz)((0,i.MQ)(t,"getCodeAndPostView"),t);(0,i.QX)(u,v,!1);try{const t=await Promise.all([n.e("chunk1jsfluent"),n.e("vendors-npm_store_sdx_officecopilot_1js-excel-copilot-calc_8_3_43-1adabd76bb06679768ec_node_m-dd2f81"),n.e("calc")]).then(n.bind(n,478565)),i=u((0,l.Z)()),v={context:e,requestId:a,cellAddress:r,sheetId:s,calc:t,linkTheme:c,styles:d,valOper:void 0,isPythonCodeShown:p,setIsPythonCodeShown:b,dispatch:u,isLoadingUIShown:m,pythonUserRequestId:g,isInitialDataFrame:h,code:o,codeExplanation:C,codeLabel:y,isPythonExecutionSuccess:!1,diagnosticsEntry:f,localeCache:i};return t.renderCodeAndPostView(v)??void 0}catch(t){const e=(0,i.pz)((0,i.MQ)(t,"getCodeAndPostView"),t);return void(0,i.QX)(u,e,!1)}})(v,b,e,t,a,o,r,s,c,d,u,m,g,h,p,f,C)}}));function h({requestId:e,cellAddress:t,sheetId:n,pythonCell:o,code:r,codeExplanation:i,codeLabel:l,isPythonExecutionSuccess:h,diagnosticsEntry:b,pythonUserRequestId:f,isInitialDataFrame:C}){const y=(0,c.j)(),v=(0,u.d4)((e=>e.chat.showLoadingUI)),T=(0,u.d4)((e=>e.chat.lastPythonQueryId));let x=(0,u.d4)((e=>e.chat.isPythonMode));(0,s.cGu)()||(x=void 0);const[S,w]=m.useState(),{linkTheme:E,getStyles:I,sdxTheme:R,isHighContrast:A}=(0,d.X)();return(0,m.useEffect)((()=>{(async()=>{const s=await g(e,r,t,n,E,I(),y,v,f,C,void 0,void 0,b,o,i,l,h);w(s||m.createElement("i",null,(0,a.csN)()))})()}),[R,v,A,o,h,T,x]),S??m.createElement(p,null)}function p(){return m.createElement(o.E,{animation:"wave",appearance:"translucent",style:{width:"100%",height:12,marginLeft:4,marginRight:4}},m.createElement(r.H,{size:12}))}},496931:(e,t,n)=>{"use strict";n.d(t,{W:()=>s});var a=n(660606),o=n(217425),r=n(632197),i=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{s(a.next(e))}catch(e){r(e)}}function l(e){try{s(a.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((a=a.apply(e,t||[])).next())}))},l=function(e,t){var n,a,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(n=1,a&&(o=2&l[0]?a.return:l[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,l[1])).done)return o;switch(a=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,a=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],a=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},s=function(e,t){return i(void 0,void 0,void 0,(function(){var n,i;return l(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),[4,e.getToken(null!=t?t:o.w8.loki)];case 1:return n=l.sent(),[2,(0,r.t)(n)];case 2:throw i=l.sent(),(0,a.cY)("Error fetching Loki token:",i),i;case 3:return[2]}}))}))}},500461:(e,t,n)=>{"use strict";n.d(t,{QJ:()=>a,eS:()=>h,j2:()=>g,k1:()=>y,mR:()=>m,v1:()=>v});var a,o=n(241273),r=n(652382),i=n(851295),l=n(831922),s=n(139170),c=n(245942);!function(e){e.dark="highcontrast_dark",e.light="highcontrast_light",e.disabled="highcontrast_none"}(a||(a={}));const d=[{excelPrimaryBackgroundColor:"#FFFFFF",sdxPrimaryBackgroundColor:"#fafafa",sdxTheme:o.Gm.defaultWhite},{excelPrimaryBackgroundColor:"#1B1A19",sdxPrimaryBackgroundColor:"#292827",sdxTheme:o.Gm.defaultBlack},{excelPrimaryBackgroundColor:"#262626",sdxPrimaryBackgroundColor:"#292827",sdxTheme:o.Gm.defaultBlack},{excelPrimaryBackgroundColor:"#666666",sdxPrimaryBackgroundColor:"#292827",sdxTheme:o.Gm.defaultBlack},{excelPrimaryBackgroundColor:"#323232",sdxPrimaryBackgroundColor:"#323232",sdxTheme:o.Gm.defaultBlack}],u=[{excelPrimaryBackgroundColor:"#ffffff",sdxPrimaryBackgroundColor:"#F5F5F5",sdxTheme:o.Gm.defaultWhite},{excelPrimaryBackgroundColor:"#000000",sdxPrimaryBackgroundColor:"#141414",sdxTheme:o.Gm.defaultBlack}],m=(e,t)=>{const n=(0,r.dD)()?u.find((t=>t.excelPrimaryBackgroundColor.toLowerCase()===e.toLowerCase())):d.find((t=>t.excelPrimaryBackgroundColor.toLowerCase()===e.toLowerCase()));return(0,l.setClientThemeType)(n?.sdxTheme??o.Gm.defaultWhite),t&&f(n?.sdxPrimaryBackgroundColor??"#fafafa"),n?.sdxTheme??o.Gm.defaultWhite},g=e=>e===o.Gm.defaultDarkGrey||e===o.Gm.defaultBlack,h=(e,t)=>{const n=e!==o.Gm.defaultWhite?{isDarkModeEnabled:!0,isHighContrastModeEnabled:t,...b}:{isDarkModeEnabled:!1,isHighContrastModeEnabled:t,...p};return n.dir=(0,i.xt)()?"rtl":"ltr",n},p={themePrimary:"#107c41",themeSecondary:"#007c85",themeLight:"#CAEAD8",themeDark:"#A0D8B9",themeDarker:"#37A660",themeTertiary:"#0f703b",themeLighter:"#42B8B2",themeMedium:"#A0D8B9",themeDarkAlt:"#107C41",themeLighterAlt:"#DCF51D",neutralLighter:"#f5f5f5",neutralDark:"#242424",black:"#292827",white:"#ffffff",lightBlue:"#dce6f1"},b={themePrimary:"#55B17E",themeSecondary:"#007c85",themeLight:"#084625",themeDark:"#0f7c41",themeDarker:"#0a5f33",themeTertiary:"#0f703b",themeLighter:"#42B8B2",themeMedium:"#0f7c41",themeDarkAlt:"#107C41",themeLighterAlt:"#DCF51D",neutralLighter:"#757575",neutralDark:"#ffffff",black:"#ffffff",white:"#292827",lightBlue:"#292827"},f=e=>{document.body.style.backgroundColor=e},C={...s.o,...p},y=(0,c.Q)(C),v={10:"#03160A",20:"#052912",30:"#094624",40:"#0A5325",50:"#0C5F32",60:"#0F703B",70:"#0F7937",80:"#107C41",90:"#218D51",100:"#10893C",110:"#1F954A",120:"#37A660",130:"#55B17E",140:"#60BD82",150:"#A0D8B9",160:"#CAEAD8"}},502535:(e,t,n)=>{"use strict";n.d(t,{i:()=>p,X:()=>v});var a=n(182238),o=n(70239),r=n(178365),i=n(1329),l=n(857677),s=n(109174),c=n(279395),d=n(164151),u=n(531093),m=n(1541),g=n(347145);async function h(e){return await Excel.run({delayForCellEdit:!0},(async t=>{const n=await async function(e){const t=e.workbook.getActiveCell();return t.load("address"),await e.sync(),t}(t),a=u.ExcelCalc.sheetAddressToExcelSheetRange(n.address);let o;if(-1===e.address.indexOf("!"))o=u.ExcelCalc.addressToExcelRange(e.address);else{o=u.ExcelCalc.sheetAddressToExcelSheetRange(e.address).range}if(e.sheetRange.sheet!==a.sheet)throw new Error((0,c.LNV)());const{firstRow:r,firstColumn:i,numRows:l,numColumns:s,targetColumn:h}=function(e,t,n){const a=100,o=50;let r=!0;const i=Math.min(a,n.numRows)+1,l=Math.min(o,n.numColumns);let s=t.topLeft.row;const c=t.topLeft.column;let d=t.bottomRight.row;const m=t.bottomRight.column;null==s&&null==d&&null!==c&&null!==m&&(s=0,d=n.numRows);let g=e.topLeft.row,h=e.topLeft.column;if(null==s||null==c||null==m||null==d||null==g||null==h)return{firstRow:0,firstColumn:0,numRows:0,numColumns:0};if(!u.ExcelCalc.IExcelRangeIntersect(u.ExcelCalc.getIExcelRangeTopLeftCell(e),t)){const e=function(e,t,n,a,o,r){const i=Math.abs(o-e),l=Math.abs(n-o),s=Math.abs(r-t),c=Math.abs(a-r);let d=o;i<l?d=e:l<i&&(d=n);let u=r;s<c?u=t:c<s&&(u=a);o>=e&&o<=n&&(d=o);r>=t&&r<=a&&(u=r);return{row:d,column:u}}(s,c,d,m,g,h);g=e.row,h=e.column,r=!1}let p=Math.max(g-Math.floor(i/2),s),b=p+i-1;b>d&&(b=d,p=b-i+1);let f=Math.max(h-Math.floor(l/2),c),C=f+l-1;C>m&&(C=m,f=C-l+1);return{firstRow:p,firstColumn:f,numRows:i,numColumns:l,targetColumn:r?h:void 0}}(a.range,o,e),p=t.workbook.worksheets.getActiveWorksheet().getRangeByIndexes(r,i,l,s);await async function(e,t){t.load("address"),t.load({address:!0,values:!0,numberFormatCategories:!0,numberFormat:!0,text:!0,rowIndex:!0,rowCount:!0,columnIndex:!0,columnCount:!0}),await e.sync()}(t,p);const b=function(e,t,n,a){const o={Name:e.name,Columns:[],TargetColumnId:void 0},r=t.text,i=t.values,l=t.numberFormatCategories,s=JSON.parse(e.headers),u=(0,g.yw9)("OfficeVSO_9637243_FixCFSuggestionsTLRHeaderCheck")?s.length>0:""!==e.headers;if(!u)throw new Error((0,c.LNV)());return i.forEach(((e,n)=>{e.forEach(((e,i)=>{const c=n+t.rowIndex,g=i+t.columnIndex;if(void 0===o.Columns[i]){const e=g-a;o.Columns[i]={HeaderName:u?s[e]:"",Values:[],Index:g}}else{const t=l[n][i],a=function(e,t,n,a,o){let r=function(e){switch(e){case"General":default:return d.v.General;case"Number":return d.v.Number;case"Text":return d.v.Text;case"Date":return d.v.Date;case"Time":return d.v.Time;case"Currency":return d.v.Currency;case"Accounting":return d.v.Accounting}}(n),i=e;if(isNaN(Number(e)))i=t;else if(r===d.v.Date||r===d.v.Time){const{date:n}=(0,m.f9)(e);e<1||isNaN(n.getDay())?(i=t,r=d.v.Text):i=n}return{Value:i,Style:{Bold:!1,Italic:!1,Underline:!1,Strikethrough:!1,FillColor:"",FontColor:""},Type:r,Row:a,Column:o}}(e,r[n][i],t,c,g);o.Columns[i].Values.push(a)}}))})),o.Columns.forEach(((e,t)=>{e.Index===n&&(o.TargetColumnId=t+1)})),o}(e,p,h,o.topLeft.column??0);return b}))}var p,b=n(795786),f=n(639969),C=n(197665),y=n(291436);!function(e){e.Chat="Chat",e.SuggestionPill="SuggestionPill"}(p||(p={}));const v=async(e,t,n,a)=>{if(0===e.length)return!1;for(const o of e)n(T(o,t,n,a));return!0},T=(e,t,n,a)=>async()=>{if("conditionalFormatSuggestion"!==e.func)throw new Error(`Unsupported function ${e.func} for Conditional Format Suggestion agent`);if(2!==e.args.length)throw new Error(`Incorrect number of parameters for ${e.func}`);const o=e.args[1],i=s.CP.getActiveTable();if(!i){const{message:e,telemetry:t}=b.n.getConditionalFormattingSuggestionsErrorResponse((0,c.LNV)(),l.q0.ClientError);return r.$.getInstance().displayResponse(e,t),void await S(o,y.Aw.failed,n)}await x(i,t,o,n,a),await S(o,y.Aw.success,n)},x=async(e,t,n,s,d)=>{try{const l=new a.u;l.guid=t,l.uiLocale=(0,C.Yd)(),l.outputLanguage=d,l.Table=await h(e);const c=new o.g0({parentPath:["Signal",a.u.getTypeName()],items:[{id:i.r.generateId(),body:l}]});r.$.getInstance().submitOperation({operation:c,workflowAnnotationType:a.b.getTypeName()}),await S(n,y.Aw.success,s)}catch(e){let t=(0,c.t_C)();e?.message===(0,c.LNV)()&&(t=e.message);const{message:a,telemetry:o}=b.n.getConditionalFormattingSuggestionsErrorResponse(t,l.q0.ClientError);r.$.getInstance().displayResponse(a,o),await S(n,y.Aw.failed,s),await s((0,f.L4)(!1))}},S=async(e,t,n)=>{if("Chat"!==e)return;const a=JSON.stringify({text:"ConditionalFormattingSuggestion",publishPreference:"Never"}),o={featureName:l.q.ConditionalFormattingSuggestion,eventType:l.a5.SuggestionMessage};await n((0,f.nv)(a,t,o))}},504009:(e,t,n)=>{"use strict";n.d(t,{N:()=>d,W:()=>u});var a=function(){return a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},a.apply(this,arguments)},o="Microsoft.Office.SharedOnline",r="BizchatLocalServer",i="BizchatBranch",l="SydneyEndpointOverride",s={M365ChatMode:"dev",cspoff:"true",flight:"!cspheaders.enabled",auth:"2"};function c(e){for(var t=new URL(window.location.href),n=0,a=Object.entries(e);n<a.length;n++){var o=a[n],r=o[0],i=o[1];t.searchParams.set(r,i)}window.history.replaceState({},"",t.toString())}function d(e){var t=OfficeRuntime.experimentation.getIntFeatureGate("".concat(o,".").concat(e,".").concat(r));if(void 0===t){var n=OfficeRuntime.experimentation.getStringFeatureGate("".concat(o,".").concat(e,".").concat(i));void 0===n||c(a(a({},s),{M365ChatBranch:n}))}else c(a(a({},s),{M365ChatLocal:t.toString()}))}function u(e){var t=OfficeRuntime.experimentation.getStringFeatureGate("".concat(o,".").concat(e,".").concat(l));if(void 0!==t)return t}},504280:(e,t,n)=>{"use strict";n.d(t,{m:()=>f,n:()=>y});var a=n(86940),o=n(293879),r=n(708353),i=n(279395),l=n(857677),s=n(76872),c=n(316904),d=n(306148);function u(e){if(e.fileUrl){const t=e.fileUrl.lastIndexOf("/");if(-1!==t)return e.fileUrl.slice(0,t)}}var m=n(99558),g=n(694592);const h=l.q.OfficeScripts,p="Copilot\\Office Scripts";var b,f;!function(e){e.SaveScriptHiTLCard="SaveScriptHiTLCard",e.CompletedSaveScriptCard="CompletedSaveScriptCard",e.SaveErrorCard="SaveErrorCard",e.DeleteScriptErrorCard="DeleteScriptErrorCard",e.DeleteScriptConfirmationCard="DeleteScriptCompletedCard",e.ScheduleScriptHiTLCard="ScheduleScriptHiTLCard",e.ScheduleScriptConfirmationCard="ScheduleScriptConfirmationCard",e.ScheduleErrorCard="ScheduleErrorCard"}(b||(b={})),function(e){e.SaveScript="SaveScript",e.ScheduleScript="ScheduleScript",e.RunScript="RunScript"}(f||(f={}));const C={SaveScript:"SaveErrorCard",ScheduleScript:"ScheduleErrorCard",RunScript:"RunErrorCard"};const y={getOfficeSaveScriptHiTL:function(e,t,n,s,c){const u=e.map((e=>({text:e}))),m=t.name;return{message:{chatCardType:a._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,embeddedLists:s?[]:[{listItems:u}],messageHeader:{text:s?(0,i.ak4)().replace("{0}",m):(0,i.gnM)().replace("{0}",m)}}},chatMessageBodyData:{actionButtonList:[(0,d.JE)(t,n,c)],feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:p,contextData:{cardMetaData:JSON.stringify({cardType:"SaveScriptHiTLCard"}),feedbackClientAppName:(0,g.f2)()}}}},telemetry:{featureName:h,eventType:l.a5.ActionConfirmationMessage}}},getSavedScriptCompletedResponse:function(e,t=!1){const n=e.name;return{message:{chatCardType:a._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:(0,i.Y55)()},messageFooter:{text:(0,i.IH5)().replace("{0}",n)}}},chatMessageBodyData:{actionButtonList:t?[(0,d.zL)(e),(0,d.vu)(h,e)]:[(0,d.zL)(e)],feedbackSectionPosition:r.O.Footer,shouldShowAIGeneratedIndicator:!1,feedbackData:{feedbackArea:p,contextData:{cardMetaData:JSON.stringify({cardType:"CompletedSaveScriptCard"}),feedbackClientAppName:(0,g.f2)()}}}},telemetry:{featureName:h,eventType:l.a5.ActionConfirmationMessage}}},getOfficeScriptErrorResponse:function(e,t,n){return(0,m.v)(e,{featureName:h,errorType:n??l.q0.ClientError},{},{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:p,contextData:{cardMetaData:JSON.stringify({cardType:C[t]}),feedbackClientAppName:(0,g.f2)()}}})},getOfficeScriptSimpleResponse:function(e,t,n=!1){return{message:{chatCardType:a._.Default,chatMessageData:{defaultMessageProps:{user:n?o.Q9.Human:o.Q9.Chat,messageHeader:{text:e}}}},telemetry:{featureName:h,eventType:t}}},getOfficeScriptDeleteScriptErrorResponse:function(e){const t=u(e),n=(0,i.Hdt)().replace("{0}",e.name).split("{1}"),d={chatCardType:a._.Default,chatMessageBodyData:{feedbackSectionPosition:r.O.Footer,shouldShowAIGeneratedIndicator:!1,feedbackData:{feedbackArea:p,contextData:{cardMetaData:JSON.stringify({cardType:"DeleteScriptErrorCard"}),feedbackClientAppName:(0,g.f2)()}}}},m={featureName:h,eventType:l.a5.ErrorMessage};if(t){return{message:{...d,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:n[0],linkText:{text:(0,i.Nfx)(),linkOnClick:()=>{const e=c.M.getInstance();s.E.getInstance().updateTelemetryChatEventData({[l.h3.ChatEventType]:l.a5.OfficeScriptsLinkClicked,[l.h3.ChatEventParameters]:JSON.stringify({featureName:l.q.OfficeScripts})},e)},linkUrl:u(e),linkSuffix:n[1]}}}}},telemetry:m}}return{message:{...d,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:n[0].concat((0,i.Nfx)(),n[1])}}}},telemetry:m}},getOfficeScriptDeleteScriptSuccessResponse:function(e){return{message:{chatCardType:a._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:(0,i.y9Z)().replace("{0}",e)}}},chatMessageBodyData:{feedbackSectionPosition:r.O.Footer,shouldShowAIGeneratedIndicator:!1,feedbackData:{feedbackArea:p,contextData:{cardMetaData:JSON.stringify({cardType:"DeleteScriptCompletedCard"}),feedbackClientAppName:(0,g.f2)()}}}},telemetry:{featureName:h,eventType:l.a5.ActionConfirmationMessage}}},getOfficeScriptsScheduleScriptFluxResponse:function(){return{message:{chatCardType:a._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:(0,i.r8x)()}}},chatMessageBodyData:{feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:p,contextData:{cardMetaData:JSON.stringify({cardType:"ScheduleScriptConfirmationCard"}),feedbackClientAppName:(0,g.f2)()}}}},telemetry:{featureName:h,eventType:l.a5.ActionConfirmationMessage}}},getOfficeScriptsScheduleScriptHiTLResponse:async function(e,t,n,s,c){return{message:{chatCardType:a._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:(0,i.T5i)().replace("{0}",e.name)},embeddedLists:[{listItems:[{text:t}]}]}},chatMessageBodyData:{actionButtonList:[await(0,d.NQ)(e,n,s,c)],feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:p,contextData:{cardMetaData:JSON.stringify({cardType:"ScheduleScriptHiTLCard"}),feedbackClientAppName:(0,g.f2)()}}}},telemetry:{featureName:h,eventType:l.a5.ActionConfirmationMessage}}}}},504786:(e,t,n)=>{"use strict";n.d(t,{$8:()=>A,$J:()=>v,B8:()=>w,FN:()=>h,GO:()=>p,IJ:()=>R,Is:()=>E,Mb:()=>d,RR:()=>s,US:()=>L,X7:()=>c,Yl:()=>I,ZA:()=>u,b3:()=>y,c$:()=>o,fP:()=>a,mY:()=>x,nr:()=>S,qq:()=>g,sh:()=>b,t0:()=>f,tQ:()=>T,tg:()=>m,y6:()=>C});var a,o,r=n(531093),i=n(731057),l=n(75954);!function(e){e.UniqueDuplicate="UniqueDuplicate",e.TimePeriod="TimePeriod",e.OtherPresetsNumber="OtherPresetsNumber",e.OtherPresetsGeneral="OtherPresetsGeneral"}(a||(a={})),function(e){e.Number="Number",e.Date="Date",e.Text="Text"}(o||(o={}));const s={between:i.default.Between,equalTo:i.default.EQ,greaterThan:i.default.GT,greaterThanOrEqual:i.default.GE,lessThan:i.default.LT,lessThanOrEqual:i.default.LE,notBetween:i.default.NotBetween,notEqualTo:i.default.NE},c={[i.default.Between]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellValueBetweenPrefixLabel,[i.default.EQ]:e=>e?ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellValueEqualToNumberPrefixLabel:ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellValueEqualToPrefixLabel,[i.default.GT]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellValueGreaterThanPrefixLabel,[i.default.GE]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellValueGreaterThanOrEqualToPrefixLabel,[i.default.LT]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellValueLessThanPrefixLabel,[i.default.LE]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellValueLessThanOrEqualToPrefixLabel,[i.default.NotBetween]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellValueNotBetweenPrefixLabel,[i.default.NE]:e=>e?ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellValueNotEqualToNumberPrefixLabel:ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellValueNotEqualToPrefixLabel},d={[i.default.Between]:"between",[i.default.EQ]:"equal to",[i.default.GT]:"greater than",[i.default.GE]:"greater than or equal to",[i.default.LT]:"less than",[i.default.LE]:"less than or equal to",[i.default.NotBetween]:"not between",[i.default.NE]:"not equal to"},u={bottomItems:i.default.Bot10,bottomPercent:i.default.Bot10P,topItems:i.default.Top10,topPercent:i.default.Top10P},m={[i.default.Bot10]:"bottom ${number} items",[i.default.Bot10P]:"bottom ${number} percent",[i.default.Top10]:"top ${number} items",[i.default.Top10P]:"top ${number} percent"},g={[i.default.Bot10]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingTopBottomBottomItemsPrefixLabel,[i.default.Bot10P]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingTopBottomBottomPercentPrefixLabel,[i.default.Top10]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingTopBottomTopItemsPrefixLabel,[i.default.Top10P]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingTopBottomTopPercentPrefixLabel},h={lastMonth:l.default.LastMonth,lastSevenDays:l.default.Last7Days,lastWeek:l.default.LastWeek,nextMonth:l.default.NextMonth,nextWeek:l.default.NextWeek,thisMonth:l.default.ThisMonth,thisWeek:l.default.ThisWeek,today:l.default.Today,tomorrow:l.default.Tomorrow},p={[l.default.LastMonth]:"in the last month",[l.default.Last7Days]:"in the last 7 days",[l.default.LastWeek]:"in the last week",[l.default.NextMonth]:"in the next month",[l.default.NextWeek]:"in the next week",[l.default.ThisMonth]:"in this month",[l.default.ThisWeek]:"in this week",[l.default.Today]:"for today",[l.default.Tomorrow]:"for tomorrow"},b={[l.default.LastMonth]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetDatesLastMonthPrefixLabel,[l.default.Last7Days]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetDatesLast7DaysPrefixLabel,[l.default.LastWeek]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetDatesLastWeekPrefixLabel,[l.default.NextMonth]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetDatesNextMonthPrefixLabel,[l.default.NextWeek]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetDatesNextWeekPrefixLabel,[l.default.ThisMonth]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetDatesThisMonthPrefixLabel,[l.default.ThisWeek]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetDatesThisWeekPrefixLabel,[l.default.Today]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetDatesTodayPrefixLabel,[l.default.Tomorrow]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetDatesTomorrowPrefixLabel},f={aboveAverage:i.default.AA,belowAverage:i.default.BA,equalOrAboveAverage:i.default.EqualAA,equalOrBelowAverage:i.default.EqualBA,blanks:i.default.Blanks,nonBlanks:i.default.NoBlanks,errors:i.default.Errors,nonErrors:i.default.NoErrors,invalid:i.default.Nil},C={[i.default.AA]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetAboveAveragePrefixLabel,[i.default.BA]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetBelowAveragePrefixLabel,[i.default.EqualAA]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetEqualToOrAboveAveragePrefixLabel,[i.default.EqualBA]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetEqualToOrBelowAveragePrefixLabel,[i.default.Blanks]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetBlankPrefixLabel,[i.default.NoBlanks]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetNotBlankPrefixLabel,[i.default.Errors]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetErrorsPrefixLabel,[i.default.NoErrors]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetNotErrorsPrefixLabel,[i.default.Nil]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetInvalidPrefixLabel},y={[i.default.AA]:"above average",[i.default.BA]:"below average",[i.default.EqualAA]:"equal to or above average",[i.default.EqualBA]:"equal to or below average",[i.default.Blanks]:"blank",[i.default.NoBlanks]:"not blank",[i.default.Errors]:"errors",[i.default.NoErrors]:"not errors",[i.default.Nil]:"invalid"},v={beginsWith:i.default.BeginsWith,contains:i.default.Contains,endsWith:i.default.EndsWith,notContains:i.default.NotContains},T={[i.default.BeginsWith]:"begins with",[i.default.Contains]:"contains",[i.default.EndsWith]:"ends with",[i.default.NotContains]:"does not contain"},x={[i.default.BeginsWith]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingTextComparisonBeginsWithPrefixLabel,[i.default.Contains]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingTextComparisonContainsPrefixLabel,[i.default.EndsWith]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingTextComparisonEndsWithPrefixLabel,[i.default.NotContains]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingTextComparisonDoesNotContainPrefixLabel},S={fiveArrows:i.default.IconSet5Arrows,fiveArrowsGray:i.default.IconSet5ArrowsGray,fiveBoxes:i.default.IconSet5Boxes,fiveQuarters:i.default.IconSet5Quarters,fiveRating:i.default.IconSet5Rating,fourArrows:i.default.IconSet4Arrows,fourArrowsGray:i.default.IconSet4ArrowsGray,fourRating:i.default.IconSet4Rating,fourRedToBlack:i.default.IconSet4RedToBlack,fourTrafficLights:i.default.IconSet4TrafficLights,threeArrows:i.default.IconSet3Arrows,threeArrowsGray:i.default.IconSet3ArrowsGray,threeFlags:i.default.IconSet3Flags,threeSigns:i.default.IconSet3Signs,threeStars:i.default.IconSet3Stars,threeSymbols:i.default.IconSet3Symbols,threeSymbols2:i.default.IconSet3Symbols2,threeTrafficLights1:i.default.IconSet3TrafficLights1,threeTrafficLights2:i.default.IconSet3TrafficLights2,threeTriangles:i.default.IconSet3Triangles},w={[i.default.IconSet5Arrows]:"5 Arrows",[i.default.IconSet5ArrowsGray]:"5 Arrows Gray",[i.default.IconSet5Boxes]:"5 Boxes",[i.default.IconSet5Quarters]:"5 Quarters",[i.default.IconSet5Rating]:"5 Rating",[i.default.IconSet4Arrows]:"4 Arrows",[i.default.IconSet4ArrowsGray]:"4 Arrows Gray",[i.default.IconSet4Rating]:"4 Rating",[i.default.IconSet4RedToBlack]:"4 Red to Black",[i.default.IconSet4TrafficLights]:"4 Traffic Lights",[i.default.IconSet3Arrows]:"3 Arrows",[i.default.IconSet3ArrowsGray]:"3 Arrows Gray",[i.default.IconSet3Flags]:"3 Flags",[i.default.IconSet3Signs]:"3 Signs",[i.default.IconSet3Stars]:"3 Stars",[i.default.IconSet3Symbols]:"3 Symbols",[i.default.IconSet3Symbols2]:"3 Symbols",[i.default.IconSet3TrafficLights1]:"3 Traffic Lights",[i.default.IconSet3TrafficLights2]:"3 Traffic Lights",[i.default.IconSet3Triangles]:"3 Triangles"},E={[i.default.IconSet5Arrows]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet5Arrows,[i.default.IconSet5ArrowsGray]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet5ArrowsGray,[i.default.IconSet5Boxes]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet5Boxes,[i.default.IconSet5Quarters]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet5Quarters,[i.default.IconSet5Rating]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet5Rating,[i.default.IconSet4Arrows]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet4Arrows,[i.default.IconSet4ArrowsGray]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet4ArrowsGray,[i.default.IconSet4Rating]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet4Rating,[i.default.IconSet4RedToBlack]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet4RedToBlack,[i.default.IconSet4TrafficLights]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet4TrafficLights,[i.default.IconSet3Arrows]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet3Arrows,[i.default.IconSet3ArrowsGray]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet3ArrowsGray,[i.default.IconSet3Flags]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet3Flags,[i.default.IconSet3Signs]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet3Signs,[i.default.IconSet3Stars]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet3Stars,[i.default.IconSet3Symbols]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet3Symbols,[i.default.IconSet3Symbols2]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet3Symbols,[i.default.IconSet3TrafficLights1]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet3TrafficLights,[i.default.IconSet3TrafficLights2]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet3TrafficLights,[i.default.IconSet3Triangles]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet3Triangles},I={fiveArrows:Excel.IconSet.fiveArrows,fiveArrowsGray:Excel.IconSet.fiveArrowsGray,fiveBoxes:Excel.IconSet.fiveBoxes,fiveQuarters:Excel.IconSet.fiveQuarters,fiveRating:Excel.IconSet.fiveRating,fourArrows:Excel.IconSet.fourArrows,fourArrowsGray:Excel.IconSet.fourArrowsGray,fourRating:Excel.IconSet.fourRating,fourRedToBlack:Excel.IconSet.fourRedToBlack,fourTrafficLights:Excel.IconSet.fourTrafficLights,threeArrows:Excel.IconSet.threeArrows,threeArrowsGray:Excel.IconSet.threeArrowsGray,threeFlags:Excel.IconSet.threeFlags,threeSigns:Excel.IconSet.threeSigns,threeStars:Excel.IconSet.threeStars,threeSymbols:Excel.IconSet.threeSymbols,threeSymbols2:Excel.IconSet.threeSymbols2,threeTrafficLights1:Excel.IconSet.threeTrafficLights1,threeTrafficLights2:Excel.IconSet.threeTrafficLights2,threeTriangles:Excel.IconSet.threeTriangles},R={[Excel.IconSet.fiveArrows]:"5 Arrows",[Excel.IconSet.fiveArrowsGray]:"5 Arrows Gray",[Excel.IconSet.fiveBoxes]:"5 Boxes",[Excel.IconSet.fiveQuarters]:"5 Quarters",[Excel.IconSet.fiveRating]:"5 Rating",[Excel.IconSet.fourArrows]:"4 Arrows",[Excel.IconSet.fourArrowsGray]:"4 Arrows Gray",[Excel.IconSet.fourRating]:"4 Rating",[Excel.IconSet.fourRedToBlack]:"4 Red to Black",[Excel.IconSet.fourTrafficLights]:"4 Traffic Lights",[Excel.IconSet.threeArrows]:"3 Arrows",[Excel.IconSet.threeArrowsGray]:"3 Arrows Gray",[Excel.IconSet.threeFlags]:"3 Flags",[Excel.IconSet.threeSigns]:"3 Signs",[Excel.IconSet.threeStars]:"3 Stars",[Excel.IconSet.threeSymbols]:"3 Symbols",[Excel.IconSet.threeSymbols2]:"3 Symbols",[Excel.IconSet.threeTrafficLights1]:"3 Traffic Lights",[Excel.IconSet.threeTrafficLights2]:"3 Traffic Lights",[Excel.IconSet.threeTriangles]:"3 Triangles"},A={[r.BorderLineStyle.Thin]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatThinBorderLabel,[r.BorderLineStyle.Medium]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatMediumBorderLabel,[r.BorderLineStyle.Dashed]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatDashedBorderLabel,[r.BorderLineStyle.Dotted]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatDottedBorderLabel,[r.BorderLineStyle.Thick]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatThickBorderLabel,[r.BorderLineStyle.Double]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatDoubleBorderLabel,[r.BorderLineStyle.Hair]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatHairlineBorderLabel,[r.BorderLineStyle.MediumDashed]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatMediumDashedBorderLabel,[r.BorderLineStyle.DashDot]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatDashDotBorderLabel,[r.BorderLineStyle.MediumDashDot]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatMediumDashDotBorderLabel,[r.BorderLineStyle.DashDotDot]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatDashDotDotBorderLabel,[r.BorderLineStyle.MediumDashDotDot]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatMediumDashDotDotBorderLabel,[r.BorderLineStyle.SlantDashDot]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatSlantDashDotBorderLabel},L={[r.BorderLineStyle.None]:"none",[r.BorderLineStyle.Thin]:"thin",[r.BorderLineStyle.Medium]:"medium",[r.BorderLineStyle.Dashed]:"dashed",[r.BorderLineStyle.Dotted]:"dotted",[r.BorderLineStyle.Thick]:"thick",[r.BorderLineStyle.Double]:"double",[r.BorderLineStyle.Hair]:"hairline",[r.BorderLineStyle.MediumDashed]:"medium dashed",[r.BorderLineStyle.DashDot]:"dash dot",[r.BorderLineStyle.MediumDashDot]:"medium dash dot",[r.BorderLineStyle.DashDotDot]:"dash dot dot",[r.BorderLineStyle.MediumDashDotDot]:"medium dash dot dot",[r.BorderLineStyle.SlantDashDot]:"slant dash dot"}},507628:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const a={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};var o=n(936191),r=n(673911);const i=function(e,t,n){if(a.randomUUID&&!t&&!e)return a.randomUUID();const i=(e=e||{}).random??e.rng?.()??(0,o.A)();if(i.length<16)throw new Error("Random bytes length must be >= 16");if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){if((n=n||0)<0||n+16>t.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[n+e]=i[e];return t}return(0,r.k)(i)}},508491:(e,t,n)=>{"use strict";n.d(t,{U:()=>h,j:()=>g});var a=n(316904),o=n(805020),r=n(664007),i=n(420715),l=n(644476),s=n(855539),c=n(8403),d=n(903173),u=n(252120),m=n(887648);const g=()=>(0,m.wA)();function h(e){const t={app:o.F,chat:r.F,dataAI:s.F,selection:d.F,telemetry:u.F},n=(0,i.HY)(t);return(0,l.U1)({reducer:n,middleware:e=>e().concat(a.M.getInstance().logException,c.F_.middleware),preloadedState:e})}},514450:(e,t,n)=>{"use strict";n.d(t,{V:()=>u});var a=n(531093),o=n(615397),r=n(448286),i=n(719733);function l(){const e={variant:i.MH,variantVersion:2};return JSON.stringify(e)}var s=n(507628);const c=e=>{const t={...d(),...e};return{storageScript:t,localUpdates:{dateLastModified:Date.now(),body:t.body,parameterInfo:t.parameterInfo}}},d=()=>({id:(0,s.A)(),name:"TempScript",body:r.newScriptBody,description:"",apiInfo:l(),isCreator:!0,creatorId:"0a088C17MOCKPUID",creatorDisplayName:"Name",creatorEmail:"name@contoso.com",mruItemId:(0,s.A)()});async function u(e,t,n,r,i){try{const o=await async function(){return Excel.run(a.getStartingContext)}();if(r){const e=(0,a.getParameterAliasesTableByName)({tableAliasId:r,tableAliasDisplayName:"inputTable"});o.parameterAliasInfo=e}const l=function(){const e=new a.ExcelLocalCodeGenerator([]);return new a.GeneralExtendedRangeCodeGenerator(e)}(),s=function(e){const t=e?new a.OfficeScriptsRelativeRangeExpressionGenerator(e):new a.OfficeScriptsAbsoluteRangeExpressionGenerator;return new a.OfficeScriptCodeBlockGenerator(t)}();await l.startNewRecording(o),e.forEach((e=>l.addEvent(e)));let d=await l.getCode(s,!1);return i&&(d=`// ${i}\n${d}`),c({name:t,description:n,body:d})}catch{throw new o.WD("Failed to generate Office Scripts script.")}}},517582:(e,t,n)=>{"use strict";n.d(t,{Q:()=>c});var a=n(857677),o=n(83437),r=n(76872),i=n(75496);const l=n(316904).M.getInstance(),s=r.E.getInstance();class c{static getInstance(){return c.instance||(c.instance=new c),c.instance}recordFluxCopilotStep({operation:e,featureName:t}){this.fluxExecutionStartTime?this.logChatLatency(e,this.fluxExecutionStartTime,!0,t):l.logError({eventType:i.S2.Latency,errorMessage:`Flux workflow was not running before starting ${e}`,logLevel:o.$b.Warning})}startRecordingFluxWorkflow(){this.fluxExecutionStartTime&&(l.logError({eventType:i.S2.Latency,errorMessage:`Command ${a.OP.FluxOverall} was not stopped before starting another Flux workflow`,logLevel:o.$b.Warning}),this.logChatLatency(a.OP.FluxOverall,this.fluxExecutionStartTime)),this.fluxExecutionStartTime=(new Date).getTime()}stopRecordingFluxWorkflow(e=!1){this.fluxExecutionStartTime&&this.logChatLatency(a.OP.FluxOverall,this.fluxExecutionStartTime,e),this.fluxExecutionStartTime=void 0}constructor(){this.logChatLatency=(e,t,n,o)=>{s.logLatency((0,a.xJ)(t),e,n,o)}}}},518377:(e,t,n)=>{"use strict";n.d(t,{$:()=>I});var a=n(279395),o=n(668315),r=n(57848),i=n(282667),l=n(780866),s=n(210466),c=n(395285),d=n(79105),u=n(391060),m=n(486092),g=n(502947),h=n(897729),p=n(585305),b=n(242660),f=n(208520);const C=(0,l.n)({title:b.g.body1Strong,explanation:{...b.g.body1,...s.Pt.padding(0),boxSizing:"border-box","& p":{...s.Pt.margin(0)},"& ul":{...s.Pt.margin("8px","0px","0px"),paddingInlineStart:"24px"}}});function y({id:e,explanation:t}){const n=C();return t?t.isLoading?f.createElement(h.Q,null):f.createElement(p.u,{id:e,text:t.explanation,className:n.explanation}):null}var v=n(24044),T=n(857677),x=n(500461),S=n(123963);const w=(0,l.n)({contentCondensed:{"&[data-fui-focus-visible]":{...s.Pt.outline(x.k1.strokeWidthThick,"solid",x.k1.colorStrokeFocus2),position:"relative",zIndex:1}},contentExpanded:{maxHeight:"none"},contentContainer:{textAlign:"left /* @noflip */",scrollbarGutter:"stable"},contentContainerCondensed:{maxHeight:"7.5em"},explanationDivider:{minHeight:"2em"},header:{display:"flex",flexDirection:"row",alignItems:"center",...s.Pt.gap("4px")},content:{background:"unset"},footer:{display:"flex",flexDirection:"row-reverse",...s.Pt.padding(0)},footerForeground:{color:x.k1.colorNeutralForeground3,"&:hover":{color:x.k1.colorNeutralForeground2Hover},"&:hover:active":{color:x.k1.colorNeutralForeground2Pressed},"@media (forced-colors: active)":{"> span":{color:"inherit","> svg":{color:"inherit"}}}},footerForegroundDisabled:{color:x.k1.colorNeutralForegroundDisabled}}),E={math:o.y4p,code:r.P1J},I=({icon:e,title:t,content:n,explanation:o,getClipboardItem:l,telemetryUsageFeatureName:s,suggestionId:h,ariaAttributes:p,alwaysShowExplanation:b,copyButtonAriaLabelSuffix:C})=>{const x=(0,c.Bi)("snippet-explanation-"),I=w(),[R,A]=f.useState(b);(0,S.IC)(R,(()=>{o?.onFirstTimeExplanationShown?.()}));const L=o&&(o.isNotAvailable||!o.isLoading&&!o.explanation);return(0,f.useEffect)((()=>{L&&A(!1)}),[L]),f.createElement(v.Y,{role:"group","aria-label":p?.["aria-label"]??a.olU.CodeSnippetWithExplanation_AriaLabel,header:function(){if(!e&&!t)return;const n=e&&E[e];return f.createElement("div",{className:I.header},n&&f.createElement(n,null),t||null)}(),footer:function(){if(!o||b)return;const e=R?r.g4$:r.rLf,t=f.createElement(d.f,{"aria-roledescription":(0,a.qcV)(),checked:R,disabled:L,size:"small",appearance:"transparent",iconPosition:"after",className:L?I.footerForegroundDisabled:I.footerForeground,onClick:()=>A(!R),icon:f.createElement(e,{className:L?I.footerForegroundDisabled:I.footerForeground}),"aria-expanded":R,"aria-controls":x},R?a.olU.CodeSnippetWithExplanation_ExplanationButton_Hide:a.olU.CodeSnippetWithExplanation_ExplanationButton_Show);return{className:I.footer,children:L?f.createElement(u.m,{withArrow:!0,content:a.olU.CodeSnippetWithExplanation_ExplanationNotAvailable,relationship:"label"},t):t}}(),controls:l&&f.createElement(i.i,{getClipboardItem:l,telemetryUsageData:{actionType:T.he.FormulaCopyClicked,source:T.KZ.CopyFormulaButton,featureName:s,suggestionId:h},ariaLabelSuffix:C}),content:{className:(0,m.z)(R?I.contentExpanded:I.contentCondensed,I.content),tabIndex:0}},f.createElement("div",{dir:"ltr",className:(0,m.z)(I.contentContainer,!R&&I.contentContainerCondensed)},n),R&&o&&f.createElement(f.Fragment,null,f.createElement(g.c,{className:I.explanationDivider}),f.createElement(y,{id:x,explanation:o})))}},519272:(e,t,n)=>{"use strict";n.d(t,{Pg:()=>l,iZ:()=>u,ip:()=>c,oe:()=>s,z6:()=>d});var a=n(279395);const o=[];function r(){if(o.length>0)return;const e=Office.context.requirements.isSetSupported("ExcelApi","1.9");o.push({excelType:Excel.ChartType.area,insightsType:"area",ivyLayout:"Area",localizedName:(0,a.Wuy)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!0},{excelType:Excel.ChartType.areaStacked,insightsType:"areaStacked",ivyLayout:"Area Stacked",localizedName:(0,a.CDV)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!0},{excelType:Excel.ChartType.areaStacked100,insightsType:"areaStacked100",ivyLayout:"Area Stacked (100%)",localizedName:(0,a.QKr)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!0},{excelType:Excel.ChartType.barClustered,insightsType:"barClustered",ivyLayout:"Bar Clustered",localizedName:(0,a.AUu)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!1},{excelType:Excel.ChartType.barStacked,insightsType:"barStacked",ivyLayout:"Bar Stacked",localizedName:(0,a.wnp)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!1},{excelType:Excel.ChartType.barStacked100,insightsType:"barStacked100",ivyLayout:"Bar Stacked (100%)",localizedName:(0,a.yid)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!1},{excelType:Excel.ChartType.columnClustered,insightsType:"columnClustered",ivyLayout:"Column Clustered",localizedName:(0,a.bo$)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!1},{excelType:Excel.ChartType.columnStacked,insightsType:"columnStacked",ivyLayout:"Column Stacked",localizedName:(0,a.H1r)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!1},{excelType:Excel.ChartType.columnStacked100,insightsType:"columnStacked100",ivyLayout:"Column Stacked (100%)",localizedName:(0,a.N0H)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!1},{excelType:Excel.ChartType.line,insightsType:"line",ivyLayout:"Line",localizedName:(0,a.PKs)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!0},{excelType:Excel.ChartType.lineStacked,insightsType:"lineStacked",ivyLayout:"Line Stacked",localizedName:(0,a.Dt7)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!0},{excelType:Excel.ChartType.lineStacked100,insightsType:"lineStacked100",ivyLayout:"Line Stacked (100%)",localizedName:(0,a.dcf)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!0},{excelType:Excel.ChartType.doughnut,insightsType:"doughnut",ivyLayout:"Doughnut",localizedName:(0,a.$c5)(),isSupported:!0,hasCategoryLegend:!0,datapointLimit:-1,positionAxisOnTick:!1},{excelType:Excel.ChartType.pie,insightsType:"pie",ivyLayout:"Pie",localizedName:(0,a.DXl)(),isSupported:!0,hasCategoryLegend:!0,datapointLimit:-1,positionAxisOnTick:!1},{excelType:Excel.ChartType.xyscatter,insightsType:"scatter",ivyLayout:"Scatter",localizedName:(0,a.HPY)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!1},{excelType:Excel.ChartType.histogram,insightsType:"histogram",ivyLayout:"Column Clustered",localizedName:(0,a.paF)(),isSupported:e,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!1},{excelType:Excel.ChartType.bubble,insightsType:"bubble",ivyLayout:"Scatter",localizedName:(0,a.nsJ)(),isSupported:!1,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!1})}const i=["columnClustered","columnStacked","columnStacked100","line","lineStacked","lineStacked100"];function l(e){r();const t=o.find((t=>t.insightsType===e));if(!t)throw new Error("Invalid chart type.");return t}function s(e){r();const t=o.find((t=>t.ivyLayout===e));if(!t)throw new Error("Invalid chart type.");return t}function c(e){const t=e.series;if(0===t.length)throw new Error("Chart contains no series.");if(t.map((e=>e.layout)).filter(((e,t,n)=>t===n.findIndex((t=>t===e)))).length>2)throw new Error("Currently we only support maximum 2 chart types");const n=t.find((e=>"primary"===e.valueAxisGroup));if(void 0===n)throw new Error("All series are in the Secondary axis group");if(t.some((e=>"primary"===e.valueAxisGroup&&e.layout!==n.layout)))throw new Error("All the series in the primary axis group should have same chart layout");const a=t.find((e=>"secondary"===e.valueAxisGroup));if(a){if(t.some((e=>"secondary"===e.valueAxisGroup&&e.layout!==a.layout)))throw new Error("All the series in the secondary axis group should have same chart layout");if(!i.some((e=>e===n.layout))||!i.some((e=>e===a.layout)))throw new Error("Unsupported chart layout for combo chart")}return{primary:l(n.layout),secondary:void 0===a?void 0:l(a.layout)}}function d(){return r(),o.filter((e=>e.isSupported)).map((e=>e.insightsType))}function u(e){return e===Excel.ChartType.histogram}},528003:(e,t,n)=>{"use strict";n.d(t,{CE:()=>c,bN:()=>l,fL:()=>s});var a=n(531093),o=n(615397),r=n(41490),i=n(796102);const l=5.625;async function s(e,t){return Excel.run({delayForCellEdit:!0},(async n=>{const o=n.workbook.worksheets.getItem(t.sheet).getRange(a.ExcelCalc.IExcelRangeToAddress(t.range)).getCell(0,0).load("format");await n.sync();return d(o.format.rowHeight,u(e,"rowHeight"),1)}))}async function c(e,t){return Excel.run({delayForCellEdit:!0},(async n=>{const o=n.workbook.worksheets.getItem(t.sheet).getRange(a.ExcelCalc.IExcelRangeToAddress(t.range)).getCell(0,0).load("format");await n.sync();return d(o.format.columnWidth,u(e,"columnWidth"),l)}))}function d(e,t,n){return"Increase"===t?Math.ceil(e*(1+(0,r.Si)("scaleFactor"))):"Decrease"===t?Math.ceil(e*(1-(0,r.Si)("scaleFactor"))):(e=Number(t))*n}function u(e,t){const n=(0,i.Q4)(e,t);if("string"===n)return(0,i.Am)(e,t);if("number"===n)return(0,i.mT)(e,t);throw new o.Dd(`Argument ${t} type ${n} should be enum or number on ${e.name}`,o.vb.ArgumentTypeMismatch,n,"enum | number")}},530499:(e,t,n)=>{"use strict";n.d(t,{r9:()=>me,sy:()=>he,gT:()=>ge,yu:()=>ue});var a=n(764080),o=n(963002),r=n(279395),i=n(650444),l=n(391981),s=n(126521),c=n(347145);const d="Forecast({0})",u="Lower Confidence Bound({0})",m="Upper Confidence Bound({0})",g="=FORECAST.ETS(A{0},{1},{2})",h="=C{0}-FORECAST.ETS.CONFINT(A{0},{1},{2})",p="=C{0}+FORECAST.ETS.CONFINT(A{0},{1},{2})",b="$A$2:$A$",f="$B$2:$B$",C="General";function y(e){const t=[...e.originalTimeValues,...e.resultTimeValues],n=e.originalValues.length,a=e.resultValues.length,o=n+a,r=e.originalValues[n-1],i=[...e.originalValues,...new Array(a).fill(null)],c=b+(n+1),y=f+(n+1),v=n+2,T=(0,l.Kz)(a,(e=>(0,s.L)(g,e+v,y,c))),S=(0,l.Kz)(a,(e=>(0,s.L)(h,e+v,y,c))),w=(0,l.Kz)(a,(e=>(0,s.L)(p,e+v,y,c))),E=[...new Array(n-1).fill(null),r,...T],I=[...new Array(n-1).fill(null),r,...S],R=[...new Array(n-1).fill(null),r,...w];return{fields:[x(1,t),x(2,i,new Array(o).fill(C)),x(3,E,new Array(o).fill(C)),x(4,I,new Array(o).fill(C)),x(5,R,new Array(o).fill(C))],fieldHeaders:[{runs:[{text:e.timeColumnName}]},{runs:[{text:e.valueColumnName}]},{runs:[{text:(0,s.L)(d,e.valueColumnName)}]},{runs:[{text:(0,s.L)(u,e.valueColumnName)}]},{runs:[{text:(0,s.L)(m,e.valueColumnName)}]}]}}function v(e){return{fields:[x(1,e.resultTimeValues.slice(0,5)),x(2,e.resultValues.slice(0,5))],fieldHeaders:[{runs:[{text:e.timeColumnName}]},{runs:[{text:(0,s.L)(d,e.valueColumnName)}]}]}}function T(e){const t=[{dimensionType:"categories",title:{runs:[{text:e.timeColumnName}]},axisGroup:"primary"},{dimensionType:"values",title:{runs:[{text:e.valueColumnName}]},axisGroup:"primary",linearValueScale:{zeroPolicy:"includeZero"}}],n=[...e.originalTimeValues,...e.resultTimeValues],a=e.originalValues.length,o=e.resultValues.length,r=a+o,i=e.originalValues[a-1],l=[...e.originalValues,...new Array(o).fill(null)],c=[...new Array(a-1).fill(null),i,...e.resultValues],g=[...new Array(a-1).fill(null),i,...e.lowerBound],h=[...new Array(a-1).fill(null),i,...e.upperBound],p={top:1,bottom:r,left:1,right:1},b={top:1,bottom:r,left:2,right:2},f={top:1,bottom:r,left:3,right:3},y={top:1,bottom:r,left:4,right:4};return{axes:t,data:{dimensions:[x(1,n,void 0,[{top:1,bottom:r,left:0,right:0}]),x(2,l,new Array(r).fill(C),[p]),x(3,c,new Array(r).fill(C),[b]),x(4,g,new Array(r).fill(C),[f]),x(5,h,new Array(r).fill(C),[y]),S(6,e.valueColumnName,[{top:0,bottom:0,left:1,right:1}]),S(7,(0,s.L)(d,e.valueColumnName),[{top:0,bottom:0,left:2,right:2}]),S(8,(0,s.L)(u,e.valueColumnName),[{top:0,bottom:0,left:3,right:3}]),S(9,(0,s.L)(m,e.valueColumnName),[{top:0,bottom:0,left:4,right:4}])]},series:[w(1,2,6),w(1,3,7),w(1,4,8),w(1,5,9)],showLegend:!0}}function x(e,t,n,a){return{id:e,values:{raw:t,strings:t.map((e=>e?.toString()??"")),formats:n},references:a}}function S(e,t,n){return{id:e,values:{raw:[t],strings:[t]},references:n}}function w(e,t,n){return{layout:"line",valueAxisGroup:"primary",exceptions:[],dataBindings:[{dimensionId:e,dimensionType:"categories"},{dimensionId:t,dimensionType:"values"},{dimensionId:n,dimensionType:"title"}]}}var E=n(1541),I=n(573367),R=n(321231),A=n(360449),L=n(198588),k=n(659126);const F="#VALUE!";async function _(e,t,n){const{name:a,nameReferences:o}=t;return a||(1===o.length&&void 0!==o[0].row&&void 0!==o[0].column?e.getText(o[0].row,o[0].column):(0,I.Hf)(e,t,n))}function P(e){const t=function(e){if(typeof e.rowFieldIndex==typeof e.columnFieldIndex)throw new Error(`ValueFilter: ${JSON.stringify(e)} should have exactly one of "rowFieldIndex" or "columnFieldIndex"`);return null==e.columnFieldIndex?{labelFieldIndex:e.rowFieldIndex,labelFieldType:"rowField"}:{labelFieldIndex:e.columnFieldIndex,labelFieldType:"columnField"}}(e);switch(e.filterType){case"equal":case"notEqual":case"greaterThan":case"greaterThanOrEqual":case"lessThan":case"lessThanOrEqual":case"startsWith":case"notStartsWith":case"endsWith":case"notEndsWith":case"contains":case"notContains":return{...t,filterType:e.filterType,value:e.value};case"between":case"notBetween":return{...t,filterType:e.filterType,value:e.value,value2:e.value2};default:return(0,i.x)(e.filterType)}}function N(e){const t=e=>new Date(86400*(e-25569)*1e3),n=function(e){if(typeof e.rowFieldIndex==typeof e.columnFieldIndex)throw new Error(`DateFilterBase: ${JSON.stringify(e)} should have exactly one of "rowFieldIndex" or "columnFieldIndex"`);return null==e.columnFieldIndex?{fieldIndex:e.rowFieldIndex,fieldType:"rowField"}:{fieldIndex:e.columnFieldIndex,fieldType:"columnField"}}(e);switch(e.filterType){case"inDynamicPeriod":return{...n,filterType:e.filterType,periodType:e.periodType};case"between":case"notBetween":return{...n,filterType:e.filterType,value:t(e.value),value2:t(e.value2),wholeDays:e.wholeDays};case"equal":case"notEqual":case"before":case"beforeOrEqual":case"after":case"afterOrEqual":return{...n,filterType:e.filterType,value:t(e.value),wholeDays:e.wholeDays};default:return(0,i.x)(e.filterType)}}function M(e){if(typeof e.rowFieldIndex==typeof e.columnFieldIndex)throw new Error(`ValueFilter: ${JSON.stringify(e)} should have exactly one of "rowFieldIndex" or "columnFieldIndex"`);return null!=e.rowFieldIndex?{labelFieldIndex:e.rowFieldIndex,labelFieldType:"rowField"}:{labelFieldIndex:e.columnFieldIndex,labelFieldType:"columnField"}}function O(e){const t={...M(e),dataFieldIndex:e.dataFieldIndex};switch(e.filterType){case"bottomItems":case"bottomPercent":case"bottomSum":case"equal":case"greaterThan":case"greaterThanOrEqual":case"lessThan":case"lessThanOrEqual":case"notEqual":case"topItems":case"topPercent":case"topSum":return{...t,filterType:e.filterType,value:e.value};case"between":case"notBetween":return{...t,filterType:e.filterType,value:e.value,value2:e.value2};default:return(0,i.x)(e.filterType)}}function D(e){return(e.columnFields||[]).length>0||0===(e.dataFields||[]).length}function B(e){return Math.max((e.rowFields||[]).length,1)}function $(e){const t=(e.rowFields||[]).length,n=(e.columnFields||[]).length,a=(e.dataFields||[]).length;return e.pivotTableData&&function(e){if(1===a&&(t>0&&n>0||0===t&&0===n)){return[[{dataFieldIndex:0},...e[0].slice(1)],...e.slice(1)]}return e}((o=function(t){const n=B(e);return n>1?[t.slice(0,n).reduce(((e,t)=>e.map(((e,n)=>e||t[n]))),t[0]),...t.slice(n)]:t}(e.pivotTableData),D(e)?o.map((e=>[null,...e])):o));var o}function H(e,t){return D(e)?t+1:t}function U(e,t){return Math.max(t-B(e)+1,0)}function q(e){const t=(e.rowFields||[]).length,n=(e.columnFields||[]).length,a=(e.dataFields||[]).length,o=null!=e.grandTotalRowIndex&&(0!==t||n>0&&1===a)?H(e,e.grandTotalRowIndex):void 0,r=null==e.grandTotalColumnIndex?e.grandTotalColumnIndex:U(e,e.grandTotalColumnIndex),i=e.grandTotalColumnIndices?.map((t=>U(e,t))),l=(e.dataFields||[]).map((t=>({...t,dataTableColumnIndices:t.dataTableColumnIndices?.map((t=>U(e,t)))}))),s=e.highlightCellReferences?.map((t=>{const{row:n,column:a}=t;return{row:null==n?n:H(e,n),column:null==a?a:U(e,a)}})),c=e.subTotalColumnIndices?.map((t=>U(e,t))),d=e.subTotalRowIndices?.map((t=>H(e,t)));return function(e){const t=e.pivotTableData.slice(0,I.y3).map((e=>e.slice(0,I.m6))),n=e=>void 0!==e&&e<I.m6,a=e=>void 0!==e&&e<I.y3,o=n(e.grandTotalRowIndex)?e.grandTotalRowIndex:void 0,r=a(e.grandTotalColumnIndex)?e.grandTotalColumnIndex:void 0,i=e.grandTotalColumnIndices?e.grandTotalColumnIndices.filter(a):void 0,l=e.subTotalRowIndices?e.subTotalRowIndices.filter(n):void 0,s=e.subTotalColumnIndices?e.subTotalColumnIndices.filter(a):void 0,c=e.dataFields.map((e=>({...e,dataTableColumnIndices:e.dataTableColumnIndices?.filter(a)})));return{...e,pivotTableData:t,dataFields:c,grandTotalRowIndex:o,grandTotalColumnIndex:r,grandTotalColumnIndices:i,subTotalRowIndices:l,subTotalColumnIndices:s}}({...e,pivotTableData:$(e),dataFields:l,subTotalColumnIndices:c,subTotalRowIndices:d,grandTotalRowIndex:o,grandTotalColumnIndex:r,grandTotalColumnIndices:i,highlightCellReferences:s})}async function V(e,t,n,a,o){return 0===t.pivotTableData.length||(0,L.RY)(t.pivotTableData)?[]:Promise.all((t.pivotTableData||[]).map(((i,l)=>Promise.all(i.map(((i,s)=>async function(e,t,n,a,o,i,l){const s=t.pivotTableData[a][n],{rowFields:d,columnFields:u,dataFields:m}=t,g=(d||[]).length,h=(u||[]).length,p=(m||[]).length,b=0===a?i[n]:0;if(s){if(null!=s.textValue&&(0,c.yw9)("OfficeVSO_10200297_UseTextValueForTAWithLoop"))return{value:s.textValue,isNumber:!1,indent:b};if((0,L.vL)(s)||(0,L.Bs)(s))return{value:await W(e,s,m,o),isNumber:!1,indent:b};if((0,L.ir)(s)){const t=e.getValue(s.row,s.column),n=e.getText(s.row,s.column),a=e.getFormat(s.row,s.column),o=e.formatSourceValue(s.row,s.column),[i,l,c,d]=await Promise.all([t,n,a,o]);if(i===F)return{value:l,isNumber:!1,indent:b};if(d){const e=s.datePartOverride;return e?{value:(0,E.xb)(i,e),isNumber:!1,indent:b}:{value:"General"===c?i:d,isNumber:!0,indent:b}}return{value:null==i?(0,r.Atw)():i,isNumber:!1,indent:b}}if((0,L.MB)(s)){const t=m.find((e=>e.dataTableColumnIndices.some((e=>e===a))));if(!!t&&!!t.showAsCalculation&&"percentOfGrandTotal"===t.showAsCalculation){return{value:`${s.value.toFixed(2)}%`,isNumber:!0,indent:b}}return t?.formatReference?G(e,s.value,t.formatReference,b):{value:s.value,isNumber:!0,indent:b}}throw new Error(`Invalid PivotTableDataValue. Provided entries: [${Object.entries(s)}]`)}if(g>0&&n===(0,I.HF)(t)-1&&0===a){if(l&&1===g){return{value:await _(e,d[0],o),isNumber:!1,indent:b}}return{value:(0,r.VDh)(),isNumber:!1,indent:b}}if(h>0&&0===n){if(a===(1===p||g>0?1:0)){if(l&&1===h){return{value:await _(e,u[0],o),isNumber:!1,indent:b}}return{value:(0,r.NRU)(),isNumber:!1,indent:b}}}return{value:"",isNumber:!1,indent:b}}(e,t,s,l,n,a,o)))))))}async function W(e,t,n,a){const o=t.dataFieldIndex;if(o<0||o>2*n.length)throw new Error(`Invalid PivotTableDataValue.dataFieldIndex: "${o}" for number of dataFields ${n.length}`);const i=n[o%(n.length+1)],l=i&&(0,R.i)(i.dataCalculation);let c,d=Promise.resolve(void 0),u=Promise.resolve(void 0);(0,L.Bs)(t)&&(d=e.getText(t.row,t.column)),o<n.length&&(u=_(e,i,a));const[m,g]=await Promise.all([d,u]);if(null!=m&&(c=(0,k.So)(m)?(0,r.Atw)():m),null!=g)return(0,s.L)((0,r.Gn5)(),l,g);if((0,L.Bs)(t)){if(o>n.length){const t=await _(e,i,a);return(0,s.L)((0,r.u6S)(),c,l,t)}return(0,s.L)((0,r.ZSg)(),c)}if(o>n.length){const t=await _(e,i,a);return(0,s.L)((0,r.ft7)(),l,t)}return(0,r.AZo)()}async function G(e,t,n,a){const o=e.getFormat(n.row,n.column),r=e.formatAggregateValue(n.row,n.column,t),[i,l]=await Promise.all([o,r]);return"General"===i?{value:t,isNumber:!0,indent:a}:{value:l,isNumber:!0,indent:a}}async function z(e,t,n,a,o,r){const i=Promise.all((t.dataFields||[]).map((t=>async function(e,t,n){const{formatReference:a}=t,o=(0,I.Hf)(e,t,n),r=a&&e.getFormatLocal(a.row,a.column),[i,l]=await Promise.all([o,r]);return{name:i,dataCalculation:t.dataCalculation,showAsCalculation:t.showAsCalculation,numberFormat:l}}(e,t,n)))),l=t=>async function(e,t,n,a){const o=(0,I.Hf)(e,t,a),[r,i]=await Promise.all([o,n]),l={name:r};t.sortOrder&&(l.sortOrder=t.sortOrder);const s=t.sortByDataField;if("number"==typeof s){if(!(s<i.length))throw new Error("Invalid sortByDataField.");l.sortBy=i[s].name}return t.datePartOverride&&(l.datePartOverride=t.datePartOverride),l}(e,t,i,n),s=Promise.all((t.rowFields||[]).map(l)),c=Promise.all((t.columnFields||[]).map(l)),d=Promise.all((t.filterFields||[]).map((t=>async function(e,t,n){const a=Promise.all((0,A.w)(t.valueReferences,((t,n)=>(0,I.Pe)(e,t,n)))),o=(0,I.Hf)(e,t,n);let r;const i=t.datePartOverride;let l,s;if(i){const n=async(t,n)=>{const a=await e.getValue(t,n);return"number"==typeof a?a:void 0},c=Promise.all((0,A.w)(t.valueReferences,n)),[d,u,m]=await Promise.all([a,o,c]);l=d,s=u,r={datePartOverride:i,values:m.filter((e=>void 0!==e))}}else[l,s]=await Promise.all([a,o]);return{name:s,values:l,datePart:r}}(e,t,n)))),u=a?V(e,t,n,r,o):Promise.resolve(void 0),[m,g,h,p,b]=await Promise.all([i,s,c,d,u]);return{rowFields:g,columnFields:h,filterFields:p,dataFields:m,valueFilters:(t.valueFilters||[]).map(O),labelFilters:(t.labelFilters||[]).map(P),dateFilters:(t.dateFilters||[]).map(N),pivotTableData:b,subTotalRowIndices:t.subTotalRowIndices,subTotalColumnIndices:t.subTotalColumnIndices,grandTotalRowIndex:t.grandTotalRowIndex,grandTotalColumnIndices:t.grandTotalColumnIndices,highlightCellReferences:t.highlightCellReferences||[]}}function Q(e,t,n,a,o){return z(e,a?q(t):t,n,a,o,a?function(e){if(0===e.pivotTableData.length)return[];const t=B(e),n=e.pivotTableData.slice(0,t),a=n[0].map(((e,t)=>Math.max(n.map((e=>e[t])).findIndex((e=>!!e))-1,0)));return D(e)?[0,...a]:a}(t):void 0)}var j=n(575934);const J=async(e,t,n)=>{const a=e.getFormat(t,n),r=e.getFormatLocal(t,n),[i,l]=await Promise.all([a,r]);return{format:i,formatLocal:l,isDateTime:o.P.getNumberFormatCache().isDateTime(l)}};async function Y(e,t,n,a){const o=[];t.forEach((e=>{for(let t=e.top;t<=e.bottom;t++)for(let a=e.left;a<=e.right;a++)o.push(n[a][t])}));const i=Promise.all(o.map(X.bind(null,e))),l=Promise.all(o.map(Z.bind(null,e))),[s,c]=await Promise.all([i,l]);return{raw:a?(0,j.m9)(s):s,strings:a?c.map(((e,t)=>null===s[t]?(0,r.Atw)():e)):c}}async function X(e,t){return t?(0,L.ir)(t)?e.getValue(t.row,t.column):(0,L.MB)(t)?t.value:"":""}async function Z(e,t){return t?(0,L.ir)(t)?e.getText(t.row,t.column):(0,L.MB)(t)?t.value.toString():"":""}async function K(e,t,n,a){const[o,l]=await Promise.all([(async()=>{if(t.textValues&&(0,c.yw9)("OfficeVSO_10200297_UseTextValueForTAWithLoop"))return{raw:t.textValues,strings:t.textValues};if(!t.references)return t.values?async function(e,t,n){const a={raw:t,strings:t.map((e=>e.toString()))};if(n){const o=Promise.all(t.map((t=>G(e,t,n,0)))),r=e.getFormat(n.row,n.column),i=e.getFormatLocal(n.row,n.column),[l,s,c]=await Promise.all([o,r,i]);return{...a,formattedValues:l,formats:t.map((()=>s)),formatLocals:t.map((()=>c))}}return a}(e,t.values.map((e=>"number"==typeof e?e:parseFloat(e))),t.formatReference):{raw:[],strings:[]};switch(a.type){case"pivottable":return Y(e,t.references,a.dataValues,n);case"source":return async function(e,t,n){const a=Promise.all((0,A.w)(t,e.getValue.bind(e))),o=Promise.all((0,A.w)(t,e.getText.bind(e))),i=Promise.all((0,A.w)(t,((t,n)=>e.getFormat(t,n)))),l=Promise.all((0,A.w)(t,((t,n)=>e.getFormatLocal(t,n)))),[s,c,d,u]=await Promise.all([a,o,i,l]);return{raw:n?(0,j.m9)(s):s,strings:n?c.map(((e,t)=>null===s[t]?(0,r.Atw)():e)):c,formats:d,formatLocals:u}}(e,t.references,n);case"queryResult":return async function(e,t,n){const a=Promise.all(n.fields.map((t=>K(e,t,!1,{type:"source"})))),o=await a;return{raw:(0,A.w)(t,((e,t)=>o[t].values.raw[e])),strings:(0,A.w)(t,((e,t)=>o[t].values.strings[e])),formats:(0,A.w)(t,((e,t)=>o[t].formatInfo?.format??null)),formatLocals:(0,A.w)(t,((e,t)=>o[t].formatInfo?.formatLocal??null))}}(e,t.references,a.queryResult);default:(0,i.x)(a)}})(),(async()=>{const n=t.formatReference;if(n){const{row:t,column:a}=n;if(void 0===t&&void 0===a)throw new Error("V3SourceCellReference is missing both row and column references.");return J(e,t,a)}const o=t.references;if(o&&o.length>0){const t=o[0],n=t.top,r=t.left;let l,s;switch(a.type){case"pivottable":{const e=a.dataValues[r][n];e&&(0,L.ir)(e)&&(l=e.row,s=e.column);break}case"source":l=n,s=r;break;case"queryResult":{const e=a.queryResult.fields[n].formatReference;l=e?.row,s=e?.column;break}default:(0,i.x)(a)}if(void 0!==l&&void 0!==s)return J(e,l,s)}})()]),s={id:t.id,values:o,formatInfo:l};return t.references&&(s.references=t.references),(e=>{const n=t.datePartOverride;if(null==n)return e;{const t=e.values.raw.map((e=>(0,E.xb)(e,n)));return{...e,formatInfo:void 0,values:{...e.values,raw:t,strings:t,formats:Array(t.length).fill(null),formatLocals:Array(t.length).fill(null)}}}})(s)}var ee=n(423235),te=n(586428);async function ne(e,t,n){return t?ce(e,t,n):void 0}async function ae(e,t,n,a){const o=t.axes&&function(e,t,n){return Promise.all(t.map((async t=>{const a=await ne(e,t.title,n);return{dimensionType:t.dimensionType,linearValueScale:t.linearValueScale,reversePlotOrder:t.reversePlotOrder,title:a,axisGroup:t.axisGroup?t.axisGroup:"primary"}})))}(e,t.axes,n),r=async function(e,t,n,a){return{dimensions:await Promise.all(t.dimensions.map((t=>K(e,t,n.has(t.id),a))))}}(e,t.data,function(e){const t=new Set;return e.series.forEach((e=>e.dataBindings.forEach((e=>{"categories"===e.dimensionType&&t.add(e.dimensionId)})))),t}(t),a),i=async function(e,t,n){const a=await Promise.all(t.map((async t=>{const a=await ne(e,t.title,n),o={dataBindings:t.dataBindings,exceptions:t.exceptions,highlightedLineSegments:t.highlightedLineSegments,layout:t.layout,binOptions:t.binOptions,title:a,valueAxisGroup:t.valueAxisGroup?t.valueAxisGroup:"primary"};return null!=t.highlightStyleIndex&&t.highlightStyleIndex>-1&&(o.highlightStyleIndex=t.highlightStyleIndex>=te.hr.length?0:t.highlightStyleIndex),t.trendlines&&(o.trendlines=t.trendlines),o}))),o=t.some((e=>"secondary"===e.valueAxisGroup)),r=t.some((e=>(0,ee.Y)(e.layout).isLine));return o&&r?a.sort(((e,t)=>{const n=(0,ee.Y)(e.layout).isLine,a=(0,ee.Y)(t.layout).isLine;return n&&!a?1:!n&&a?-1:0})):a}(e,t.series,n),l=ne(e,t.title,n),[s,c,d,u]=await Promise.all([o,r,i,l]),m={axes:s??[],data:c,series:d};return u&&(m.title=u),m}function oe(e){switch(e.exprType){case"and":case"or":case"contains":case"endsWith":case"equality":case"greaterThan":case"greaterThanOrEqual":case"lessThan":case"lessThanOrEqual":case"startsWith":return{exprType:e.exprType,left:oe(e.left),right:oe(e.right)};case"columnName":return re(e);case"datePart":return{exprType:e.exprType,source:oe(e.source),datePartFunction:e.datePartFunction};case"dynamicColumn":return{exprType:e.exprType,kind:e.kind};case"distinct":return{exprType:e.exprType,exprs:e.exprs.map((e=>oe(e)))};case"inQuery":return{exprType:e.exprType,columnNameExpr:re(e.columnNameExpr),query:ie(e.query)};case"numberLiteral":case"dateTimeLiteral":case"stringLiteral":return{exprType:e.exprType,value:e.value};case"query":return ie(e);case"not":return{exprType:e.exprType,expr:oe(e.expr)};case"average":case"count":case"max":case"median":case"min":case"sum":return{exprType:e.exprType,expr:e.expr&&oe(e.expr)};default:(0,i.c)(e)}}function re(e){return{exprType:e.exprType,name:e.name,sourceDataReference:e.sourceDataReference}}function ie(e){return{exprType:e.exprType,projectClause:e.projectClause.map((e=>oe(e))),...e.whereClause&&{whereClause:oe(e.whereClause)},...e.groupClause&&{groupClause:e.groupClause.map((e=>oe(e)))},...e.havingClause&&{havingClause:oe(e.havingClause)},...e.sortClause&&{sortClause:e.sortClause.map((e=>le(e)))},...e.rankingClause&&{rankingClause:{order:e.rankingClause.order.map((e=>le(e))),filter:oe(e.rankingClause.filter),partitions:e.rankingClause.partitions.map((e=>oe(e)))}},...e.takeClause&&{takeClause:e.takeClause}}}function le(e){return{expr:oe(e.expr),order:e.order}}async function se(e,t){const n=t.columnReference,o=t.bulletList?await Promise.all(t.bulletList.map((t=>async function(e,t,n){const a=[];n&&n.top<=n.bottom&&n.left===n.right&&(t.reference.length>r.ifF?(t.reference.slice(0,r.ifF-2).map((async e=>{a.push(e)})),a.push(t.reference[t.reference.length-1])):t.reference.map((async e=>{a.push(e)})));const o=await Promise.all(a.map((t=>e.getText(t+1,n.left))));return{...t,perviewCitationValues:o}}(e,t,n)))):void 0;if(t.analysisType===a.uK.Tagging&&o){const a=await async function(e,t,n){let a=[];if(n&&n.top<=n.bottom&&n.left===n.right){const o=Math.min(t.reduce(((e,t)=>e+t.reference.length),0),I.m6),r=t.map((e=>e.reference.map((t=>({reference:t,tag:e.title}))))).flat().sort(((e,t)=>e.reference-t.reference)).slice(0,o),i=await Promise.all(r.map((async t=>e.getText(t.reference+1,n.left))));return a=r.map(((e,t)=>({reference:e.reference,tag:e.tag,originalData:i[t]}))),{tagFields:a}}return}(e,o,n);return{...t,bulletList:o,tagResult:a}}return{...t,bulletList:o}}async function ce(e,t,n){const a=n?.table,o=a&&(!!a.headerColumnCount&&a.headerColumnCount>1||!!a.headerRowCount&&a.headerRowCount>1),i=await Promise.all(t.runs.map((async t=>{if(void 0!==t.text)return{text:(0,k.So)(t.text)?(0,r.Atw)():t.text};if(null!=t.references){if(!o||1===t.references.length&&(null==t.references[0].column&&null==t.references[0].row||null!=t.references[0].column&&null!=t.references[0].row)){const a=await async function(e,t,n){const{row:a,column:o}=t,i=n?.table.tableLocation;if(void 0===a&&void 0===o)throw new Error("V3SourceCellReference is missing both row and column references.");return void 0===a?(0,s.L)((0,r.m1B)(),i?o-i.left+1:o+1):void 0===o?(0,s.L)((0,r.m1B)(),i?a-i.top+1:a+1):e.getText(a,o)}(e,t.references[0],n);return{text:(0,k.So)(a)?(0,r.Atw)():a.trim()}}throw new Error("Invalid TextRun")}if(t.formattedValue){const{value:n,formatReference:a}=t.formattedValue,o={text:""},i=await e.formatAggregateValue(a.row,a.column,n);return o.text=(0,k.So)(i)?(0,r.Atw)():i,o}throw new Error("Invalid TextRun")})));return{runs:i.map(((e,n)=>{const a=t.runs[n];if(null!=a.highlightStyleIndex&&a.highlightStyleIndex>-1){const t=a.highlightStyleIndex>=te.vA.length?0:a.highlightStyleIndex;e.highlightStyleIndex=t}return e}))}}async function de(e,t,n,a,o=!0){switch(t.visualType){case"ChartVisual":return{chart:await ae(e,t.chart,n,{type:"source"}),visualType:t.visualType,chartConfig:t.chartConfig};case"PivotTableVisual":return{pivotTable:await Q(e,t.pivotTable,n,o,a),visualType:t.visualType};case"PivotChartVisual":{const r=ae(e,t.chart,n,t.pivotTable.pivotTableData?{type:"pivottable",dataValues:t.pivotTable.pivotTableData}:{type:"source"}),i=Q(e,t.pivotTable,n,o,a),[l,s]=await Promise.all([r,i]);return{chart:l,pivotTable:s,visualType:t.visualType,chartConfig:t.chartConfig}}case"QueryResultVisual":{const a=t.query?function(e){return oe(e)}(t.query):void 0,o=async function(e,t,n){const a=Promise.all((t.fields||[]).map((t=>K(e,t,!1,{type:"source"})))),o=Promise.all((t.fieldHeaders||[]).map((t=>ce(e,t,n)))),[r,i]=await Promise.all([a,o]);return{fields:r,fieldHeaders:i}}(e,t.result,n),r=(0,c.iPS)("Microsoft.Office.Excel.FA000000124.QueryCharts",!1)&&t.chart&&ae(e,t.chart,n,{type:"queryResult",queryResult:t.result}),[i,l]=await Promise.all([o,r]);return(0,c.iPS)("Microsoft.Office.Excel.FA000000124.QueryCharts",!1)&&l?{query:a,result:i,chart:l,formula:t.formula,visualType:"QueryChartVisual"}:{query:a,result:i,formula:t.formula,visualType:"QueryResultVisual",isStagingTable:t.isStagingTable}}case"ForecastVisual":return function(e){if(!(0,c.iPS)("Microsoft.Office.Excel.FA000000124.EnableForecasting",!1))throw new Error("Forecasting is disabled but a forecast visual was generated");return{visualType:"ForecastVisual",chart:T(e),previewTable:v(e),formulasTable:y(e)}}(t.forecastResult);case"TextAnalysisVisual":return{textAnalysisResult:await se(e,t.textAnalysisResult),visualType:t.visualType};default:(0,i.c)(t)}}async function ue(e){const t=(0,E.SB)(e.data.formatRows);await o.P.getNumberFormatCache().addFormatPropertiesAsync(["General",...(0,E.SB)(e.data.formatLocalRows).values]);const n=t.positions.map((t=>{const n=e.data.formatLocalRows[t.row][t.column],a=o.P.getNumberFormatCache().data[n].metadata;return{excelFormatCode:n,isDateTime:a.isDateTime,hasMonth:a.hasMonth,hasDay:a.hasDayOfWeek,hasYear:a.hasYear,isPercent:a.isPercent,isCurrency:a.isCurrency,isNumeric:a.isNumeric,isText:a.isText}}));return{valueRows:e.data.valueRows,formatKeyRows:t.keys,formatInfos:n,mergedCells:e.data.mergedCells,formulas:e.data.formulas}}async function me(e,t){const n=function(e){return{...e}}(t.table),a=n.tableLocation.top;let o;if("columnMajor"===t.table.orientation&&1===t.table.headerRowCount){const n=Promise.all(t.fields.map((async(t,n)=>{const o=e.getValue(a,n),r=e.getText(a,n),i=e.getFormat(a,n),l=e.getFormatLocal(a,n),[s,c,d,u]=await Promise.all([o,r,i,l]);return{...t,headerValue:s,headerText:c,headerFormat:d,headerFormatLocal:u}})));o=await n}return{...t,fields:o,table:n}}async function ge(e,t,n,a,o){const r=de(e,t.visual,n,a,o),i=t.title&&ce(e,t.title,n),[l,s]=await Promise.all([r,i]);return{id:t.id,interpretationId:n?n.id:t.interpretationId,title:s,visual:l,providerName:t.providerName,providerIndex:t.providerIndex}}async function he(e,t,n,o){if(t.visualAnswer&&t.responseType===a.WZ.Answered){const a=t.visualAnswer.visual.refreshable,r=null==a||a,i=Promise.all(t.discoverInsights?.map((t=>ge(e,t,n,!0)))??[]),l=ge(e,t.visualAnswer,n,!0),s=pe(e,n,t.relatedQuestions),[c,d,u]=await Promise.all([i,l,s]);return{...t,visualAnswer:[d],relatedQuestions:u,refreshable:r,forceStaticAnswer:o,discoverInsights:c}}if(t.insightsVisuals){const a=Promise.all(t.insightsVisuals.map((t=>ge(e,t,n,!0)))),r=Promise.all(t.discoverInsights?.map((t=>ge(e,t,n,!0)))??[]),i=pe(e,n,t.relatedQuestions),[l,s,c]=await Promise.all([a,r,i]);return{...t,visualAnswer:l,relatedQuestions:c,refreshable:!0,forceStaticAnswer:o,discoverInsights:s}}{const a=Promise.all(t.discoverInsights?.map((t=>ge(e,t,n,!0)))??[]),r=pe(e,n,t.relatedQuestions),[i,l]=await Promise.all([a,r]);return{...t,visualAnswer:[],relatedQuestions:l,refreshable:i.length>0,forceStaticAnswer:o,discoverInsights:i}}}async function pe(e,t,n){return n&&Promise.all(n.map((async n=>({query:{tokens:n.tokens},title:n.title?await ce(e,n.title,t):{runs:[{text:n.tokens.map((e=>e.token.text)).join("")}]}}))))}},535718:e=>{"use strict";e.exports=function(e){var t=e[1],n=e[3];if(!n)return t;if("function"==typeof btoa){var a=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),o="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),r="/*# ".concat(o," */");return[t].concat([r]).join("\n")}return[t].join("\n")}},537782:(e,t,n)=>{"use strict";n.d(t,{g:()=>h});var a=n(37072),o=n(28987),r=n(660606),i=n(822606),l=n(329739),s=n(423905),c=n(764081),d=n(481797),u=n(684531),m=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{s(a.next(e))}catch(e){r(e)}}function l(e){try{s(a.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((a=a.apply(e,t||[])).next())}))},g=function(e,t){var n,a,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(n=1,a&&(o=2&l[0]?a.return:l[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,l[1])).done)return o;switch(a=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,a=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],a=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},h=function(){function e(){var t=this;this.openedDialog={dialog:void 0,cardId:"",triggeringActionTitle:""},this.dialogProps=void 0,this.startTime=0,this.msalAccountInfo=null,this.closeActiveDialog=function(){t.openedDialog.dialog&&t.openedDialog.dialog.close(),t.openedDialog={dialog:void 0,cardId:"",triggeringActionTitle:""},(0,r.cY)("ExtensibilityDialogLauncher : Extensibility Dialog closed")},this.logDialogTelemetry=function(e,n){var a=Date.now();(0,s.js)(a-t.startTime,e,null!=n?n:""),e||(0,s.jC)(null!=n?n:"")},this.onMessageCallback=function(n){return m(t,void 0,void 0,(function(){var t,o,r,i,l,s,c;return g(this,(function(d){return this.openedDialog.dialog?((t=JSON.parse(n)).type===a.o.Ack?(o={dialogContent:null===(r=this.dialogProps)||void 0===r?void 0:r.dialogContent,appDefinition:null===(i=this.dialogProps)||void 0===i?void 0:i.appDefinition,clientInfo:null===(l=this.dialogProps)||void 0===l?void 0:l.clientInfo,cardInfo:null===(s=this.dialogProps)||void 0===s?void 0:s.card,hostConfigFlags:null===(c=this.dialogProps)||void 0===c?void 0:c.hostConfigFlags,copilotChatThemev2:e.theme,source:"BizChat",msalAccountInfo:this.msalAccountInfo},this.openedDialog.dialog.messageChild(JSON.stringify(o),{targetOrigin:window.location.origin}),this.logDialogTelemetry(!0)):t.type===a.o.CloseEvent&&this.closeActiveDialog(),[2]):(this.logDialogTelemetry(!1,"ExtensibilityDialogLauncher.onMessageCallback : No active dialog found"),[2])}))}))},this.onCloseCallback=function(){t.closeActiveDialog()},this.isDialogActive=function(){return!!t.openedDialog.dialog},this.shouldCloseActiveDialog=function(e){var n,a;return!(t.openedDialog.cardId&&t.openedDialog.cardId===e&&(null===(a=null===(n=t.dialogProps)||void 0===n?void 0:n.action)||void 0===a?void 0:a.title)&&t.openedDialog.triggeringActionTitle&&t.openedDialog.triggeringActionTitle===t.dialogProps.action.title)},this.onDialogError=function(e){var n="Error opening dialog";if(e)try{n=JSON.stringify(e)}catch(e){(0,r.cY)("ExtensibilityDialogLauncher.onDialogError : Error parsing error object",e)}t.logDialogTelemetry(!1,"ExtensibilityDialogLauncher : ".concat(n))},this.openDialogForWebPlatformAsNewWindow=function(e,n){return m(t,void 0,void 0,(function(){var t,a,o,r,i,l=this;return g(this,(function(s){switch(s.label){case 0:if(t=null!==(i=null===(r=null===(o=this.dialogProps)||void 0===o?void 0:o.card)||void 0===r?void 0:r.id)&&void 0!==i?i:"",this.isDialogActive()){if(!this.shouldCloseActiveDialog(t))return[2];this.closeActiveDialog()}return a=(0,d.zC)(),[4,Office.context.ui.displayDialogAsync(a,{displayInIframe:!1,hideTitle:!0,height:e,width:n,promptBeforeOpen:!1},(function(e){return m(l,void 0,void 0,(function(){var n,a,o,r,i,l=this;return g(this,(function(s){return e.error||!e.value?(this.onDialogError(e.error),[2]):(this.openedDialog={dialog:e.value,cardId:t,triggeringActionTitle:null!==(o=null===(a=null===(n=this.dialogProps)||void 0===n?void 0:n.action)||void 0===a?void 0:a.title)&&void 0!==o?o:""},null===(r=this.openedDialog.dialog)||void 0===r||r.addEventHandler(Office.EventType.DialogMessageReceived,(function(e){return m(l,void 0,void 0,(function(){return g(this,(function(t){switch(t.label){case 0:return[4,this.onMessageCallback(e.message)];case 1:return t.sent(),[2]}}))}))})),null===(i=this.openedDialog.dialog)||void 0===i||i.addEventHandler(Office.EventType.DialogEventReceived,(function(e){return m(l,void 0,void 0,(function(){return g(this,(function(t){return e.error===d.Y7&&this.closeActiveDialog(),[2]}))}))})),[2])}))}))}))];case 1:return s.sent(),[2]}}))}))},this.openDialogForNativePlatform=function(e,n){return m(t,void 0,void 0,(function(){var t,a,o,l,s=this;return g(this,(function(c){return t=(0,d.zC)(),OfficeFirstPartyDialog.displayWebDialog(t,{displayInIframe:!0,dialogTitle:null!==(l=null===(o=null===(a=this.dialogProps)||void 0===a?void 0:a.dialogContent)||void 0===o?void 0:o.title)&&void 0!==l?l:i.$9,hideTitle:!0,height:e,width:n,onMessage:this.onMessageCallback,onClose:this.onCloseCallback}).then((function(e){s.openedDialog.dialog=e})).catch((function(e){s.onDialogError(e),(0,r.cY)("ExtensibilityDialogLauncher : Error displaying  Extensibility Dialog",e)})),[2]}))}))},this.launchExtensibilityDialog=function(e){return m(t,void 0,void 0,(function(){var t,n,a,i,s,m,h,p,b,f,C,y;return g(this,(function(g){switch(g.label){case 0:return(null==e?void 0:e.clientInfo)?(this.startTime=Date.now(),t=!this.msalAccountInfo||(null===(p=null===(h=this.dialogProps)||void 0===h?void 0:h.clientInfo)||void 0===p?void 0:p.userPrincipalName)!==e.clientInfo.userPrincipalName,this.dialogProps=e,t?(n=new l.j({userPrincipalName:null===(b=null==e?void 0:e.clientInfo)||void 0===b?void 0:b.userPrincipalName,redirectUri:new URL(null!==(C=null===(f=null==e?void 0:e.clientInfo)||void 0===f?void 0:f.redirectUri)&&void 0!==C?C:"",window.location.origin).toString(),clientId:c.pL}),a=this,[4,n.getAccountInfoFromCache()]):[3,2]):((0,r.cY)("ExtensibilityDialogLauncher : Invalid dialog properties provided"),[2]);case 1:a.msalAccountInfo=g.sent(),g.label=2;case 2:return i=function(e){var t,n;if(e.viewMode!==u.hs.TaskModule)return{dialogHeight:c.Qt,dialogWidth:c.Qt};var a=(0,d.Cd)(null===(t=e.dialogContent)||void 0===t?void 0:t.height),o=(0,d.Cd)(null===(n=e.dialogContent)||void 0===n?void 0:n.width),r=!0,i=!0,l=c.t9,s=c.OY;a<=0&&(i=!1,l=(0,d.wc)(a)),o<=0&&(r=!1,s=(0,d.tP)(o));var m=screen.width,g=screen.height;return i&&(l=(0,d.Xz)(a,g)),r&&(s=(0,d.Xz)(o,m)),{dialogHeight:l,dialogWidth:s}}(e),s=i.dialogHeight,m=i.dialogWidth,(null===(y=e.clientInfo)||void 0===y?void 0:y.clientType)===o.WK.web?this.openDialogForWebPlatformAsNewWindow(s,m):this.openDialogForNativePlatform(s,m),[2]}}))}))}}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.setTheme=function(t){e.theme=t},e}()},538204:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSupportedSetMap=t.createRuntimePatchIsSetSupportedOverride=void 0,t.createRuntimePatchIsSetSupportedOverride=function(e){const t={};return Object.keys(e).forEach((n=>{t[n.toLowerCase()]=e[n]})),`\nOfficeExtension.CommonUtility.isSetSupportedOverride = function (name, version) {\n\n    const supportedApiSets = ${JSON.stringify(t)};\n\n    function getVersion(version) {\n        if (typeof version !== "string") {\n            return undefined;\n        }\n        const temp = version.split(".");\n\n        if (temp.length !== 2) {\n            return undefined\n        }\n        const majorString = temp[0];\n        const minorString = temp[1];\n\n        const major = Number(majorString);\n        const minor = Number(minorString);\n\n        if (isNaN(major) || isNaN(minor)) {\n            return undefined;\n        }\n\n        const result = { major, minor };\n        return result;\n    }\n\n    if (name === undefined) {\n        return false;\n    }\n\n    let testVersion = getVersion(version);\n    if (testVersion === undefined) {\n        return false;\n    }\n\n    if (supportedApiSets.hasOwnProperty(name.toLowerCase())) {\n        const supportedSet = supportedApiSets[name.toLowerCase()];\n        const setVersion = getVersion(supportedSet);\n\n        if (setVersion === undefined) {\n            // something went wrong - not supported\n            return false;\n        }\n\n        const setMajor = setVersion.major;\n        const setMinor = setVersion.minor;\n\n        const testMajor = testVersion.major;\n        const testMinor = testVersion.minor;\n\n        if (setMajor > testMajor) {\n            return true;\n        }\n\n        if (setMajor === testMajor && setMinor >= testMinor) {\n            return true;\n        }\n\n        return false;\n    }\n\n    // if we can't find the ApiSet - assume false \n    return false;\n}\n`},t.getSupportedSetMap=function(e){const t={};return e.forEach((e=>{let n=0;for(;n<99;){if(!Office.context.requirements.isSetSupported(e,`1.${n}`)){n--;break}n++}n>=0&&(t[e]=`1.${n}`)})),t}},540084:(e,t,n)=>{"use strict";n.d(t,{$Y:()=>c,AW:()=>i,XK:()=>r,vt:()=>l,z:()=>s});const a=16384,o=1048576;function r(e){const t=function(e){let t=e;if(e.left<=e.right&&e.top<=e.bottom)return e;e.left>e.right&&(t={...t,left:e.right,right:e.left});e.top>e.bottom&&(t={...t,top:e.bottom,bottom:e.top});return t}(e);return`${`${s(t.left)}${t.top}`}:${`${s(t.right)}${t.bottom}`}`}function i(e){const t=e.split(":");if(1===t.length){const t=l(e);if(0===t.row||0===t.column)throw new Error(0===t.row?"wrong cell address format with no row value":"wrong cell address format with no column value");return{left:t.column,top:t.row,right:t.column,bottom:t.row}}const n=l(t[0]),r=l(t[1]);if(0===n.column!=(0===r.column))throw new Error("wrong range address format with column value missing");if(0===n.row!=(0===r.row))throw new Error("wrong range address format with row value missing");if(n.column*r.column===0&&n.row*r.row===0)throw new Error("wrong range address format with row & column value missing");return 0===n.column&&0===r.column?{left:1,top:n.row,right:a,bottom:r.row}:0===n.row&&0===r.row?{left:n.column,top:1,right:r.column,bottom:o}:{left:n.column,top:n.row,right:r.column,bottom:r.row}}function l(e){if(e.length<1)throw new Error("Empty cell address error");let t=0,n=0;for(let a=0;a<e.length;a++)e[a]>="A"&&e[a]<="Z"?t=26*t+(e[a].charCodeAt(0)-"A".charCodeAt(0))+1:n=10*n+Number(e[a]);return{row:n,column:t}}function s(e){if(e<1)throw new Error("wrong excel column index");const t=[];let n=e;for(;0!==n;)n--,t.push(String.fromCharCode(n%26+"A".charCodeAt(0))),n=Math.floor(n/26);return t.reverse().join("")}function c(e){return l(e).column}},540287:(e,t,n)=>{"use strict";n.d(t,{q:()=>s});var a=n(83437),o=n(75496),r=n(316904),i=n(857677),l=n(459524);function s(e){if(!(0,l.f)())try{Office.context.ribbonGallery.refreshRibbon(e)}catch(e){!function(){const e=r.M.getInstance(),t={eventType:o.S2.RefreshRibbonGallery,errorMessage:"",logLevel:a.$b.ASHA},n=[{key:i.ib.ErrorMessage,value:"Something went wrong while refreshing ribbon gallery after save."}];e.logError(t,void 0,n)}()}}},542769:(e,t,n)=>{"use strict";function a(e){const t=async n=>{if(0===e.length)return Promise.resolve();await e.pop()(n),await t(n)};return Excel.run((e=>t(e)))}function o(e,t){return n=>(n instanceof OfficeExtension.Error&&n.traceMessages.includes(t)&&e(),Promise.reject(n))}n.d(t,{U:()=>o,q:()=>a})},543435:(e,t,n)=>{"use strict";var a,o,r,i;n.d(t,{UW:()=>a,lp:()=>o,px:()=>r,qf:()=>i}),function(e){e.AbortError="AbortError"}(a||(a={})),function(e){e.StandardTable="StandardTable",e.TableLikeRange="TableLikeRange",e.Range="Range"}(o||(o={})),function(e){e.SinglePythonObjectCell="SinglePythonObjectCell",e.SingleExcelValueCell="SingleExcelValueCell",e.SpilledExcelValueCell="SpilledExcelValueCell"}(r||(r={})),function(e){e.Error="Error",e.PngImageFile="<class 'PIL.PngImagePlugin.PngImageFile'>",e.ImageFile="<class 'PIL.Image.Image'>",e.None="<class 'NoneType'>",e.PythonPlot="<class 'excel.pythonplots.PlotlyPlot'>",e.MatplotlibPlot="<class 'excel.pythonplots.MatplotlibPlot'>"}(i||(i={}))},544861:(e,t,n)=>{"use strict";n.d(t,{lJ:()=>f,r1:()=>p,x8:()=>b});var a=n(174116),o=n(255563),r=n(831922),i=n(109174),l=n(347145),s=n(500461),c=n(210466),d=n(780866);const u={contentCard:{width:"100%",...c.Pt.margin("0"),boxShadow:"none",...c.Pt.border("0","none"),...c.Pt.borderRadius("0"),...c.Pt.padding("0")},contentHeader:{color:s.k1.black}},m=(0,d.n)(u);var g=n(887648),h=n(208520);const p=e=>({buttonTitle:e,buttonText:e,icon:h.createElement(a.rz9,null)}),b=e=>({buttonTitle:e,buttonText:e,icon:h.createElement(o.wm0,null)});function f({requestId:e,cardButtons:t,contentBody:n,contentHeader:a,pythonUserRequestId:o,renderHeader:s,renderBody:c,renderFooter:d}){let u=(0,g.d4)((e=>e.chat.latestRequestId))===e;const p=(0,g.d4)((e=>e.chat.lastPythonQueryId));return(0,l.cGu)()&&o?u=i.CP.pythonContextManager.isPythonMode&&o===p:i.CP.pythonContextManager.isPythonMode&&o&&(u=o===p),h.createElement(r.ContentCard,{body:{cardContent:{contentBody:n,contentHeader:a,cardButtons:u?t:void 0},renderHeader:s,renderBody:c,renderFooter:d},styles:m()})}},545564:(e,t,n)=>{"use strict";n.d(t,{y:()=>p});var a=n(178365),o=n(762030),r=n(83437),i=n(75496),l=n(316904),s=n(857677);class c{constructor(e){this.camelToSnake=e=>e.replace(/([A-Z])/g,(e=>`_${e.toLowerCase()}`)),this.getRawStatements=e=>e.map((e=>{let t="";if(e.returns&&(t+=e.returns+"="),t+=this.camelToSnake(e.name)+"(",e.arguments){const n=Object.keys(e.arguments);for(let a=0;a<n.length;a++){const o=e.arguments[n[a]];if(o){switch(t+=n[a]+"=",o.type){case"number":t+=JSON.stringify(o.number);break;case"boolean":t+=JSON.stringify(o.boolean);break;case"jsonGrid":t+=JSON.stringify(o.json);break;case"stringList":t+=JSON.stringify(o.stringList);break;case"numberList":t+=JSON.stringify(o.numberList);break;case"color":case"string":t+=JSON.stringify(o.string);break;case"var":case"scope":t+=o.name;break;default:throw new Error("Type of the argument cannot be handled.")}a!==n.length-1&&(t+=", ")}}}return t=t.trim(),t=t.replace(/,$/,""),t+=")",t})),this.logConvertRawODSLError=()=>{const e=l.M.getInstance(),t={eventType:i.S2.OfficeScriptsContextManager,errorMessage:"",logLevel:r.$b.Error},n=[{key:s.ib.ErrorMessage,value:"Something went wrong while converting statements to raw format."}];e.logError(t,void 0,n)},this.convertToRawODSLString=()=>{try{return this.getRawStatements(this.statements).join("\n")}catch{return void this.logConvertRawODSLError()}},this.statements=e}}var d=n(279395),u=n(92520);const m=e=>{const t=l.M.getInstance(),n={eventType:i.S2.OfficeScriptsContextManager,errorMessage:"",logLevel:r.$b.Warning},a=[{key:s.ib.ErrorMessage,value:e}];t.logError(n,void 0,a)};var g=n(252163),h=n(795786);class p{constructor(){this.odslCacheList=[],this.tableNames=[],this.getOfficeScriptsContext=()=>{const e=o.H.getInstance();return{odslCache:JSON.stringify(this.odslCacheList),scriptNames:e.getScripts().map((e=>e.name)),tableNames:this.tableNames}},this.pushOdslCache=(e,t)=>{const n=new c(t).convertToRawODSLString();if(n){const t={query:e,odsl:n};this.odslCacheList.push(t)}},this.clearODSLCache=()=>{this.odslCacheList=[]},this.initOfficeScriptsContext=async()=>{this.tableNames=await async function(){try{return await Excel.run({delayForCellEdit:!0},(async e=>{const t=e.workbook.tables.load("items/name");return await e.sync(),t.items.map((e=>e.name))}))}catch{return m("Office JS call failed to get all tables on current workbook"),[]}}(),await o.H.getInstance().populateScriptsList(),(0,u.cY)(`Office Scripts Context: Initial tables ${this.tableNames}`)},this.removeTable=e=>{const t=this.tableNames.findIndex((t=>t===e));t>-1&&(this.tableNames.splice(t,1),(0,u.cY)(`Office Scripts Context: Removing table ${this.tableNames}`))},this.addTable=async e=>{const t=await async function(e){try{return await Excel.run({delayForCellEdit:!0},(async t=>{const n=t.workbook.tables.getItem(e).load("name");return await t.sync(),n.name}))}catch{return void m("Office JS call failed to get table name by id")}}(e);t&&(this.tableNames.push(t),(0,u.cY)(`Office Scripts Context: Adding table ${this.tableNames}`))},this.checkIfFlowCreatedFromPowerAutomate=async()=>{if((0,g.P)("FlowCreated")){const{message:e,telemetry:t}=h.n.getOfficeScriptSimpleResponse((0,d.ejy)(),s.a5.FlowCreatedConfirmation,!1);a.$.getInstance().displayResponse(e,t)}}}}p._instance=void 0,p.getInstance=()=>(void 0===p._instance&&(p._instance=new p),p._instance)},548366:(e,t,n)=>{"use strict";var a;n.d(t,{W:()=>a}),function(e){e.Copilot_Canvas_Pane_Failed_To_Load="Copilot Canvas Pane Failed to Load",e.Copilot_Chat_Pane_Failed_To_Load="Copilot Chat Pane Failed to Load",e.LLM_Service_Side_Issue_Prevents_Output="LLM Service Side Issue Prevents Output",e.Missing_Copilot_Functionality="Missing Copilot Functionality",e.Referencing_A_File_Failed="Referencing a File Failed",e.Response_Delayed_Or_Timed_Out="Response Delayed or Timed Out",e.Responsible_AI_Filter_Blocked_Response="Responsible AI Filter Blocked Response",e.UI_Failed_To_Update_Or_Load="UI Failed to Update or Load",e.Unable_To_Complete_Task="Unable to Complete Task",e.Unable_To_Generate_Response_Due_To_Capacity_Issue="Unable to Generate Response Due to Capacity Issue",e.Unclassified_ASHA_Error="Unclassified ASHA Error",e.Unclassified_Chat_Failure="Unclassified Chat Failure",e.User_Access_Issue_For_Copilot="User Access Issue for Copilot",e.User_Input_Could_Not_Be_Processed="User Input Could Not Be Processed",e.User_Rejected_Or_Cancelled_Response="User Rejected or Cancelled Response"}(a||(a={}))},548923:(e,t,n)=>{"use strict";n.d(t,{AU:()=>at,uS:()=>ot,YV:()=>rt,g$:()=>lt,yT:()=>tt});var a=n(341240),o=n.n(a),r=n(772777),i=n.n(r),l=n(412339),s=n.n(l),c=n(389064),d=n.n(c),u=n(269636),m=n.n(u),g=n(982017),h=n.n(g),p=n(5288),b={};b.styleTagTransform=h(),b.setAttributes=d(),b.insert=s().bind(null,"head"),b.domAPI=i(),b.insertStyleElement=m();o()(p.A,b);p.A&&p.A.locals&&p.A.locals;var f=n(976026),C={};C.styleTagTransform=h(),C.setAttributes=d(),C.insert=s().bind(null,"head"),C.domAPI=i(),C.insertStyleElement=m();o()(f.A,C);f.A&&f.A.locals&&f.A.locals;var y=n(121924),v=n(641565),T=n(500461),x=n(780866);const S={swatch:{stroke:T.k1.black}},w=(0,x.n)(S);var E=n(208520);var I=n(5532),R=n(399809),A=n(279395),L=n(518377),k=n(857677),F=n(670447),_=n(215908);const P={width:"90px",height:"20px",border:"1px solid rgb(210, 208, 206)",borderRadius:"1px",borderWidth:"medium",fontSize:"12px",textAlign:"center",verticalAlign:"middle",fontWeight:"normal",fontStyle:"normal",textDecorationLine:"none",textDecorationStyle:"solid",backgroundColor:"white"},N={width:"72px",height:"16px",border:"1px solid rgb(210, 208, 206)",borderRadius:"1px",display:"flex",padding:"0.5px",flexDirection:"row"},M={background:"linear-gradient(to right, rgb(99, 142, 198), white)",width:"80%",border:"0.7px solid rgb(99, 142, 198)"},O=e=>{const t=e.IsTextDoubleUnderlined||e.IsTextUnderlined,n=e.BorderFormat.LineStyle,a=e.BorderFormat.Color;let o="rgb(210, 208, 206)",r="solid",i="medium";if(void 0!==n[0]){const e=(0,F.Cn)(a[0]);o=(0,F.S)(e),r=H(n[0]),i=$(n[0])}return{...P,backgroundColor:e.BackgroundColor?e.BackgroundColor:"white",color:e.TextColor,fontWeight:e.IsTextBold?"bold":"normal",fontStyle:e.IsTextItalic?"italic":"normal",textDecorationLine:`${e.IsTextStrikethrough?"line-through":""} ${t?"underline":""}`.trim(),textDecorationStyle:e.IsTextDoubleUnderlined?"double":void 0,border:`1px ${r} ${o}`,borderWidth:i}},D=(e,t,n)=>{let a;return a=null!=n?`linear-gradient(90deg, ${e} 0%, ${n} 50%, ${t} 100%)`:`linear-gradient(90deg, ${e} 0%, ${t} 100%)`,{...P,background:a}},B=(e,t)=>{let n;return n=t?`linear-gradient(to right, ${e}, white)`:`${e}`,{...M,background:n}},$=e=>{switch(e){case _.BorderLineStyle.Thin:return"thin";case _.BorderLineStyle.Thick:return"thick";case _.BorderLineStyle.Medium:return"medium";default:return"thin"}},H=e=>{switch(e){case _.BorderLineStyle.None:return"";case _.BorderLineStyle.Thin:case _.BorderLineStyle.Medium:case _.BorderLineStyle.Thick:case _.BorderLineStyle.Double:case _.BorderLineStyle.Hair:return"solid";case _.BorderLineStyle.Dotted:return"dotted";case _.BorderLineStyle.Dashed:case _.BorderLineStyle.DashDot:case _.BorderLineStyle.DashDotDot:case _.BorderLineStyle.MediumDashed:case _.BorderLineStyle.MediumDashDot:case _.BorderLineStyle.MediumDashDotDot:case _.BorderLineStyle.SlantDashDot:return"dashed";default:return"solid"}};var U=n(883),q=n(347145),V=n(245965),W=n(731057);n(13017);const G=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1865 954 l -271 271 l -442 -441 v 1136 h -384 v -1136 l -442 441 l -271 -271 l 905 -905 z"}),E.createElement("path",{className:"OfficeIconColors_m21",d:"M 832 1856 v -1227 l -506 506 l -181 -181 l 815 -815 l 815 815 l -181 181 l -506 -506 v 1227 z"}),E.createElement("path",{className:"OfficeIconColors_m23",d:"M 236 954 l 90 90 l 570 -569 v 1317 h 128 v -1317 l 570 569 l 90 -90 l -724 -724 m 905 724 l -271 271 l -442 -441 v 1136 h -384 v -1136 l -442 441 l -271 -271 l 905 -905 z"})),z=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 2048 2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 966 1865 l -271 -271 l 441 -442 h -1136 v -384 h 1136 l -441 -442 l 271 -271 l 905 905 z"}),E.createElement("path",{className:"OfficeIconColors_m21",d:"M 64 832 h 1227 l -506 -506 l 181 -181 l 815 815 l -815 815 l -181 -181 l 506 -506 h -1227 z"}),E.createElement("path",{className:"OfficeIconColors_m23",d:"M 966 236 l -90 90 l 569 570 h -1317 v 128 h 1317 l -569 570 l 90 90 l 724 -724 m -724 905 l -271 -271 l 441 -442 h -1136 v -384 h 1136 l -441 -442 l 271 -271 l 905 905 z"})),Q=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 2048 2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 55 966 l 271 -271 l 442 441 v -1136 h 384 v 1136 l 442 -441 l 271 271 l -905 905 z"}),E.createElement("path",{className:"OfficeIconColors_m21",d:"M 1088 64 v 1227 l 506 -506 l 181 181 l -815 815 l -815 -815 l 181 -181 l 506 506 v -1227 z"}),E.createElement("path",{className:"OfficeIconColors_m23",d:"M 1684 966 l -90 -90 l -570 569 v -1317 h -128 v 1317 l -570 -569 l -90 90 l 724 724 m -905 -724 l 271 -271 l 442 441 v -1136 h 384 v 1136 l 442 -441 l 271 271 l -905 905 z"})),j=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1792 512 v 1280 h -1280 v -384 h 619 l -848 -848 l 277 -277 l 848 848 v -619 z"}),E.createElement("path",{className:"OfficeIconColors_m21",d:"M 576 1728 v -256 h 710 l -912 -912 l 186 -186 l 912 912 v -710 h 256 v 1152 z"}),E.createElement("path",{className:"OfficeIconColors_m23",d:"M 464 560 l 976 976 h -800 v 128 h 1024 v -1024 h -128 v 800 l -976 -976 m 848 667 v -619 h 384 v 1280 h -1280 v -384 h 619 l -848 -848 l 277 -277 z"})),J=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1792 256 v 1280 h -384 v -619 l -848 848 l -277 -277 l 848 -848 h -619 v -384 z"}),E.createElement("path",{className:"OfficeIconColors_m21",d:"M 374 1488 l 912 -912 h -710 v -256 h 1152 v 1152 h -256 v -710 l -912 912 z"}),E.createElement("path",{className:"OfficeIconColors_m23",d:"M 640 384 v 128 h 800 l -976 976 l 96 96 l 976 -976 v 800 h 128 v -1024 m 128 1152 h -384 v -619 l -848 848 l -277 -277 l 848 -848 h -619 v -384 h 1280 z"})),Y=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 236 954 l 90 90 l 570 -569 v 1317 h 128 v -1317 l 570 569 l 90 -90 l -724 -724 m 905 724 l -271 271 l -442 -441 v 1136 h -384 v -1136 l -442 441 l -271 -271 l 905 -905 z"}),E.createElement("path",{className:"OfficeIconColors_m29",d:"M 832 1856 v -1227 l -506 506 l -181 -181 l 815 -815 l 815 815 l -181 181 l -506 -506 v 1227 z"}),E.createElement("path",{className:"OfficeIconColors_m28",d:"M 236 954 l 90 90 l 570 -569 v 1317 h 128 v -1317 l 570 569 l 90 -90 l -724 -724 m 905 724 l -271 271 l -442 -441 v 1136 h -384 v -1136 l -442 441 l -271 -271 l 905 -905 z"})),X=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 966 236 l -90 90 l 569 570 h -1317 v 128 h 1317 l -569 570 l 90 90 l 724 -724 m -724 905 l -271 -271 l 441 -442 h -1136 v -384 h 1136 l -441 -442 l 271 -271 l 905 905 z"}),E.createElement("path",{className:"OfficeIconColors_m212",d:"M 64 832 h 1227 l -506 -506 l 181 -181 l 815 815 l -815 815 l -181 -181 l 506 -506 h -1227 z"}),E.createElement("path",{className:"OfficeIconColors_m211",d:"M 966 236 l -90 90 l 569 570 h -1317 v 128 h 1317 l -569 570 l 90 90 l 724 -724 m -724 905 l -271 -271 l 441 -442 h -1136 v -384 h 1136 l -441 -442 l 271 -271 l 905 905 z"})),Z=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1684 966 l -90 -90 l -570 569 v -1317 h -128 v 1317 l -570 -569 l -90 90 l 724 724 m -905 -724 l 271 -271 l 442 441 v -1136 h 384 v 1136 l 442 -441 l 271 271 l -905 905 z"}),E.createElement("path",{className:"OfficeIconColors_m215",d:"M 1088 64 v 1227 l 506 -506 l 181 181 l -815 815 l -815 -815 l 181 -181 l 506 506 v -1227 z"}),E.createElement("path",{className:"OfficeIconColors_m214",d:"M 1684 966 l -90 -90 l -570 569 v -1317 h -128 v 1317 l -570 -569 l -90 90 l 724 724 m -905 -724 l 271 -271 l 442 441 v -1136 h 384 v 1136 l 442 -441 l 271 271 l -905 905 z"})),K=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 464 560 l 976 976 h -800 v 128 h 1024 v -1024 h -128 v 800 l -976 -976 m 848 667 v -619 h 384 v 1280 h -1280 v -384 h 619 l -848 -848 l 277 -277 z"}),E.createElement("path",{className:"OfficeIconColors_m212",d:"M 576 1728 v -256 h 710 l -912 -912 l 186 -186 l 912 912 v -710 h 256 v 1152 z"}),E.createElement("path",{className:"OfficeIconColors_m211",d:"M 464 560 l 976 976 h -800 v 128 h 1024 v -1024 h -128 v 800 l -976 -976 m 848 667 v -619 h 384 v 1280 h -1280 v -384 h 619 l -848 -848 l 277 -277 z"})),ee=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 640 384 v 128 h 800 l -976 976 l 96 96 l 976 -976 v 800 h 128 v -1024 m 128 1152 h -384 v -619 l -848 848 l -277 -277 l 848 -848 h -619 v -384 h 1280 z"}),E.createElement("path",{className:"OfficeIconColors_m212",d:"M 374 1488 l 912 -912 h -710 v -256 h 1152 v 1152 h -256 v -710 l -912 912 z"}),E.createElement("path",{className:"OfficeIconColors_m211",d:"M 640 384 v 128 h 800 l -976 976 l 96 96 l 976 -976 v 800 h 128 v -1024 m 128 1152 h -384 v -619 l -848 848 l -277 -277 l 848 -848 h -619 v -384 h 1280 z"})),te=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1920 1664 h -1920 l 960 -1280 m -704 1152 h 1408 l -704 -939 z"}),E.createElement("path",{className:"OfficeIconColors_m29",d:"M 128 1600 l 832 -1109 l 832 1109 z"}),E.createElement("path",{className:"OfficeIconColors_m28",d:"M 1920 1664 h -1920 l 960 -1280 m -704 1152 h 1408 l -704 -939 z"})),ne=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1920 640 v 640 h -1920 v -640 m 1792 128 h -1664 v 384 h 1664 z"}),E.createElement("path",{className:"OfficeIconColors_m212",d:"M 64 1216 v -512 h 1792 v 512 z"}),E.createElement("path",{className:"OfficeIconColors_m211",d:"M 1920 640 v 640 h -1920 v -640 m 1792 128 h -1664 v 384 h 1664 z"})),ae=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 0 384 h 1920 l -960 1280 m 704 -1152 h -1408 l 704 939 z"}),E.createElement("path",{className:"OfficeIconColors_m215",d:"M 1792 448 l -832 1109 l -832 -1109 z"}),E.createElement("path",{className:"OfficeIconColors_m214",d:"M 0 384 h 1920 l -960 1280 m 704 -1152 h -1408 l 704 939 z"})),oe=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 z"}),E.createElement("path",{className:"OfficeIconColors_m29",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),E.createElement("path",{className:"OfficeIconColors_m28",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"})),re=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1024 0 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -39 4 -77 q 3 -38 9 -76 v -4 q 19 -123 66 -235 q 46 -112 116 -208 q 70 -96 160 -175 q 90 -78 196 -134 q 106 -55 226 -85 q 119 -30 247 -30 m 896 1024 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -9 0 -18 0 q -9 1 -18 2 l 930 930 q 1 -9 2 -18 q 0 -9 0 -18 m -1572 -586 q -72 83 -122 181 q -51 98 -76 209 l 1070 1070 q 111 -25 209 -76 q 98 -50 181 -122 m -1482 -676 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 9 0 18 -1 q 9 0 18 -1 l -930 -930 q -1 9 -1 18 q -1 9 -1 18 m 1572 586 q 72 -83 123 -181 q 50 -98 75 -209 l -1070 -1070 q -111 25 -209 75 q -98 51 -181 123 z"}),E.createElement("path",{className:"OfficeIconColors_m212",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),E.createElement("path",{className:"OfficeIconColors_m211",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"})),ie=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"}),E.createElement("path",{className:"OfficeIconColors_m215",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),E.createElement("path",{className:"OfficeIconColors_m214",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"})),le=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"}),E.createElement("path",{className:"OfficeIconColors_m215",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),E.createElement("path",{className:"OfficeIconColors_m214",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"})),se=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 m -512 0 q 0 80 -30 149 q -30 70 -82 122 q -53 53 -123 83 q -70 30 -149 30 q -80 0 -149 -30 q -70 -30 -122 -83 q -53 -52 -83 -122 q -30 -69 -30 -149 q 0 -79 30 -149 q 30 -70 83 -123 q 52 -52 122 -82 q 69 -30 149 -30 q 79 0 149 30 q 70 30 123 82 q 52 53 82 123 q 30 70 30 149 z"}),E.createElement("path",{className:"OfficeIconColors_m221",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),E.createElement("path",{className:"OfficeIconColors_m220",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"})),ce=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 m -384 0 q 0 106 -40 199 q -41 93 -110 162 q -70 70 -163 110 q -93 41 -199 41 q -106 0 -199 -41 q -93 -40 -162 -110 q -70 -69 -110 -162 q -41 -93 -41 -199 q 0 -106 41 -199 q 40 -93 110 -163 q 69 -69 162 -110 q 93 -40 199 -40 q 106 0 199 40 q 93 41 163 110 q 69 70 110 163 q 40 93 40 199 z"}),E.createElement("path",{className:"OfficeIconColors_m21",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),E.createElement("path",{className:"OfficeIconColors_m22",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"})),de=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 m -256 0 q 0 88 -23 170 q -23 82 -64 153 q -42 71 -100 129 q -59 59 -130 100 q -71 42 -153 65 q -82 23 -170 23 q -88 0 -170 -23 q -82 -23 -153 -65 q -71 -41 -129 -100 q -59 -58 -100 -129 q -42 -71 -65 -153 q -23 -82 -23 -170 q 0 -88 23 -170 q 23 -82 65 -153 q 41 -71 100 -130 q 58 -58 129 -100 q 71 -41 153 -64 q 82 -23 170 -23 q 88 0 170 23 q 82 23 153 64 q 71 42 130 100 q 58 59 100 130 q 41 71 64 153 q 23 82 23 170 z"}),E.createElement("path",{className:"OfficeIconColors_m22",d:"M 1024 0 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 z"})),ue=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 0 v 2048 h -2048 v -2048 m 1920 128 h -1792 v 1792 h 1792 m -896 -1664 q 106 0 204 27 q 98 28 184 78 q 85 50 155 120 q 70 70 120 155 q 50 86 78 184 q 27 98 27 204 q 0 106 -27 204 q -28 98 -78 183 q -50 86 -120 156 q -70 70 -155 120 q -86 50 -184 77 q -98 28 -204 28 q -106 0 -204 -28 q -98 -27 -183 -77 q -86 -50 -156 -120 q -70 -70 -120 -156 q -50 -85 -77 -183 q -28 -98 -28 -204 q 0 -106 28 -204 q 27 -98 77 -184 q 50 -85 120 -155 q 70 -70 156 -120 q 85 -50 183 -78 q 98 -27 204 -27 z"}),E.createElement("path",{className:"OfficeIconColors_m29",d:"M 1024 1728 q -97 0 -187 -25 q -90 -25 -168 -71 q -78 -46 -142 -111 q -65 -64 -111 -142 q -46 -78 -71 -168 q -25 -90 -25 -187 q 0 -97 25 -187 q 25 -90 71 -168 q 46 -78 111 -143 q 64 -64 142 -110 q 78 -46 168 -71 q 90 -25 187 -25 q 97 0 187 25 q 90 25 168 71 q 78 46 143 110 q 64 65 110 143 q 46 78 71 168 q 25 90 25 187 q 0 97 -25 187 q -25 90 -71 168 q -46 78 -110 142 q -65 65 -143 111 q -78 46 -168 71 q -90 25 -187 25 z"}),E.createElement("path",{className:"OfficeIconColors_m28",d:"M 1024 256 q 106 0 204 27 q 98 28 184 78 q 85 50 155 120 q 70 70 120 155 q 50 86 78 184 q 27 98 27 204 q 0 106 -27 204 q -28 98 -78 183 q -50 86 -120 156 q -70 70 -155 120 q -86 50 -184 77 q -98 28 -204 28 q -106 0 -204 -28 q -98 -27 -183 -77 q -86 -50 -156 -120 q -70 -70 -120 -156 q -50 -85 -77 -183 q -28 -98 -28 -204 q 0 -106 28 -204 q 27 -98 77 -184 q 50 -85 120 -155 q 70 -70 156 -120 q 85 -50 183 -78 q 98 -27 204 -27 m 0 1408 q 88 0 170 -23 q 82 -23 153 -65 q 71 -41 130 -100 q 58 -58 100 -129 q 41 -71 64 -153 q 23 -82 23 -170 q 0 -88 -23 -170 q -23 -82 -64 -153 q -42 -71 -100 -130 q -59 -58 -130 -100 q -71 -41 -153 -64 q -82 -23 -170 -23 q -88 0 -170 23 q -82 23 -153 64 q -71 42 -129 100 q -59 59 -100 130 q -42 71 -65 153 q -23 82 -23 170 q 0 88 23 170 q 23 82 65 153 q 41 71 100 129 q 58 59 129 100 q 71 42 153 65 q 82 23 170 23 z"}),E.createElement("path",{className:"OfficeIconColors_m22",d:"M 2048 0 v 2048 h -2048 v -2048 m 1920 128 h -1792 v 1792 h 1792 z"})),me=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 0 v 2048 h -2048 v -2048 m 128 1920 h 1792 v -1792 h -1792 m 896 128 q 106 0 204 27 q 98 28 184 78 q 85 50 155 120 q 70 70 120 155 q 50 86 78 184 q 27 98 27 204 q 0 106 -27 204 q -28 98 -78 183 q -50 86 -120 156 q -70 70 -155 120 q -86 50 -184 77 q -98 28 -204 28 q -106 0 -204 -28 q -98 -27 -183 -77 q -86 -50 -156 -120 q -70 -70 -120 -156 q -50 -85 -77 -183 q -28 -98 -28 -204 q 0 -106 28 -204 q 27 -98 77 -184 q 50 -85 120 -155 q 70 -70 156 -120 q 85 -50 183 -78 q 98 -27 204 -27 m 640 768 q 0 -88 -23 -170 q -23 -82 -64 -153 q -42 -71 -100 -130 q -59 -58 -130 -100 q -71 -41 -153 -64 q -82 -23 -170 -23 q -9 0 -18 0 q -9 0 -18 1 l 675 675 q 1 -9 1 -18 q 0 -9 0 -18 m -1280 0 q 0 88 23 170 q 23 82 65 153 q 41 71 100 129 q 58 59 129 100 q 71 42 153 65 q 82 23 170 23 q 130 0 245 -49 l -836 -836 q -49 115 -49 245 m 1002 528 q 88 -61 153 -147 q 64 -86 96 -191 l -801 -801 q -104 32 -190 96 q -87 65 -148 153 z"}),E.createElement("path",{className:"OfficeIconColors_m212",d:"M 1024 1728 q -97 0 -187 -25 q -90 -25 -168 -71 q -78 -46 -142 -111 q -65 -64 -111 -142 q -46 -78 -71 -168 q -25 -90 -25 -187 q 0 -97 25 -187 q 25 -90 71 -168 q 46 -78 111 -143 q 64 -64 142 -110 q 78 -46 168 -71 q 90 -25 187 -25 q 97 0 187 25 q 90 25 168 71 q 78 46 143 110 q 64 65 110 143 q 46 78 71 168 q 25 90 25 187 q 0 97 -25 187 q -25 90 -71 168 q -46 78 -110 142 q -65 65 -143 111 q -78 46 -168 71 q -90 25 -187 25 z"}),E.createElement("path",{className:"OfficeIconColors_m211",d:"M 1024 256 q 106 0 204 27 q 98 28 184 78 q 85 50 155 120 q 70 70 120 155 q 50 86 78 184 q 27 98 27 204 q 0 106 -27 204 q -28 98 -78 183 q -50 86 -120 156 q -70 70 -155 120 q -86 50 -184 77 q -98 28 -204 28 q -106 0 -204 -28 q -98 -27 -183 -77 q -86 -50 -156 -120 q -70 -70 -120 -156 q -50 -85 -77 -183 q -28 -98 -28 -204 q 0 -106 28 -204 q 27 -98 77 -184 q 50 -85 120 -155 q 70 -70 156 -120 q 85 -50 183 -78 q 98 -27 204 -27 m 0 1408 q 88 0 170 -23 q 82 -23 153 -65 q 71 -41 130 -100 q 58 -58 100 -129 q 41 -71 64 -153 q 23 -82 23 -170 q 0 -88 -23 -170 q -23 -82 -64 -153 q -42 -71 -100 -130 q -59 -58 -130 -100 q -71 -41 -153 -64 q -82 -23 -170 -23 q -88 0 -170 23 q -82 23 -153 64 q -71 42 -129 100 q -59 59 -100 130 q -42 71 -65 153 q -23 82 -23 170 q 0 88 23 170 q 23 82 65 153 q 41 71 100 129 q 58 59 129 100 q 71 42 153 65 q 82 23 170 23 z"}),E.createElement("path",{className:"OfficeIconColors_m22",d:"M 2048 0 v 2048 h -2048 v -2048 m 1920 128 h -1792 v 1792 h 1792 z"})),ge=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 0 v 2048 h -2048 v -2048 m 1920 128 h -1792 v 1792 h 1792 m -896 -1664 q 106 0 204 27 q 98 28 184 78 q 85 50 155 120 q 70 70 120 155 q 50 86 78 184 q 27 98 27 204 q 0 106 -27 204 q -28 98 -78 183 q -50 86 -120 156 q -70 70 -155 120 q -86 50 -184 77 q -98 28 -204 28 q -106 0 -204 -28 q -98 -27 -183 -77 q -86 -50 -156 -120 q -70 -70 -120 -156 q -50 -85 -77 -183 q -28 -98 -28 -204 q 0 -106 28 -204 q 27 -98 77 -184 q 50 -85 120 -155 q 70 -70 156 -120 q 85 -50 183 -78 q 98 -27 204 -27 m 0 1408 q 88 0 170 -23 q 82 -23 153 -65 q 71 -41 130 -100 q 58 -58 100 -129 q 41 -71 64 -153 q 23 -82 23 -170 q 0 -88 -23 -170 q -23 -82 -64 -153 q -42 -71 -100 -130 q -59 -58 -130 -100 q -71 -41 -153 -64 q -82 -23 -170 -23 q -88 0 -170 23 q -82 23 -153 64 q -71 42 -129 100 q -59 59 -100 130 q -42 71 -65 153 q -23 82 -23 170 q 0 88 23 170 q 23 82 65 153 q 41 71 100 129 q 58 59 129 100 q 71 42 153 65 q 82 23 170 23 z"}),E.createElement("path",{className:"OfficeIconColors_m215",d:"M 1024 1728 q -97 0 -187 -25 q -90 -25 -168 -71 q -78 -46 -142 -111 q -65 -64 -111 -142 q -46 -78 -71 -168 q -25 -90 -25 -187 q 0 -97 25 -187 q 25 -90 71 -168 q 46 -78 111 -143 q 64 -64 142 -110 q 78 -46 168 -71 q 90 -25 187 -25 q 97 0 187 25 q 90 25 168 71 q 78 46 143 110 q 64 65 110 143 q 46 78 71 168 q 25 90 25 187 q 0 97 -25 187 q -25 90 -71 168 q -46 78 -110 142 q -65 65 -143 111 q -78 46 -168 71 q -90 25 -187 25 z"}),E.createElement("path",{className:"OfficeIconColors_m214",d:"M 1024 256 q 106 0 204 27 q 98 28 184 78 q 85 50 155 120 q 70 70 120 155 q 50 86 78 184 q 27 98 27 204 q 0 106 -27 204 q -28 98 -78 183 q -50 86 -120 156 q -70 70 -155 120 q -86 50 -184 77 q -98 28 -204 28 q -106 0 -204 -28 q -98 -27 -183 -77 q -86 -50 -156 -120 q -70 -70 -120 -156 q -50 -85 -77 -183 q -28 -98 -28 -204 q 0 -106 28 -204 q 27 -98 77 -184 q 50 -85 120 -155 q 70 -70 156 -120 q 85 -50 183 -78 q 98 -27 204 -27 m 0 1408 q 88 0 170 -23 q 82 -23 153 -65 q 71 -41 130 -100 q 58 -58 100 -129 q 41 -71 64 -153 q 23 -82 23 -170 q 0 -88 -23 -170 q -23 -82 -64 -153 q -42 -71 -100 -130 q -59 -58 -130 -100 q -71 -41 -153 -64 q -82 -23 -170 -23 q -88 0 -170 23 q -82 23 -153 64 q -71 42 -129 100 q -59 59 -100 130 q -42 71 -65 153 q -23 82 -23 170 q 0 88 23 170 q 23 82 65 153 q 41 71 100 129 q 58 59 129 100 q 71 42 153 65 q 82 23 170 23 z"}),E.createElement("path",{className:"OfficeIconColors_m22",d:"M 2048 0 v 2048 h -2048 v -2048 m 1920 128 h -1792 v 1792 h 1792 z"})),he=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1920 1920 h -1920 l 960 -1920 m -753 1792 h 1506 l -753 -1506 z"}),E.createElement("path",{className:"OfficeIconColors_m212",d:"M 104 1856 l 856 -1713 l 856 1713 z"}),E.createElement("path",{className:"OfficeIconColors_m211",d:"M 1920 1920 h -1920 l 960 -1920 m -753 1792 h 1506 l -753 -1506 z"})),pe=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 2020 1024 l -996 996 l -996 -996 l 996 -996 m 0 1810 l 815 -814 l -815 -814 l -815 814 z"}),E.createElement("path",{className:"OfficeIconColors_m215",d:"M 119 1024 l 905 -905 l 905 905 l -905 905 z"}),E.createElement("path",{className:"OfficeIconColors_m214",d:"M 2020 1024 l -996 996 l -996 -996 l 996 -996 m 0 1810 l 815 -814 l -815 -814 l -815 814 z"})),be=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 2019 558 l -1315 1313 l -674 -674 l 271 -271 l 403 403 l 1043 -1043 z"}),E.createElement("path",{className:"OfficeIconColors_m29",d:"M 120 1197 l 181 -181 l 403 403 l 1043 -1043 l 181 181 l -1224 1224 z"}),E.createElement("path",{className:"OfficeIconColors_m28",d:"M 704 1510 l -403 -403 l -90 90 l 493 493 l 1133 -1133 l -90 -90 m 271 90 l -1314 1314 l -674 -674 l 271 -271 l 403 403 l 1043 -1043 z"})),fe=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1280 0 v 1408 h -512 v -1408 m 0 1536 h 512 v 512 h -512 z"}),E.createElement("path",{className:"OfficeIconColors_m212",d:"M 832 1984 v -384 h 384 v 384 m -384 -640 v -1280 h 384 v 1280 z"}),E.createElement("path",{className:"OfficeIconColors_m211",d:"M 1280 0 v 1408 h -512 v -1408 m 384 128 h -256 v 1152 h 256 m 128 256 v 512 h -512 v -512 m 384 128 h -256 v 256 h 256 z"})),Ce=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1984 348 l -676 676 l 676 676 l -284 284 l -676 -676 l -676 676 l -284 -284 l 676 -676 l -676 -676 l 284 -284 l 676 676 l 676 -676 z"}),E.createElement("path",{className:"OfficeIconColors_m215",d:"M 154 1700 l 677 -676 l -677 -676 l 194 -194 l 676 677 l 676 -677 l 194 194 l -677 676 l 677 676 l -194 194 l -676 -677 l -676 677 z"}),E.createElement("path",{className:"OfficeIconColors_m214",d:"M 1024 921 l -676 -676 l -103 103 l 676 676 l -676 676 l 103 103 l 676 -676 l 676 676 l 103 -103 l -676 -676 l 676 -676 l -103 -103 m 284 103 l -676 676 l 676 676 l -284 284 l -676 -676 l -676 676 l -284 -284 l 676 -676 l -676 -676 l 284 -284 l 676 676 l 676 -676 z"})),ye=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1024 0 q 141 0 272 36 q 131 37 245 103 q 113 67 207 160 q 93 94 160 208 q 67 114 104 245 q 36 131 36 272 q 0 142 -36 272 q -37 131 -104 245 q -67 114 -160 207 q -94 94 -207 160 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -66 -207 -160 q -94 -93 -161 -207 q -67 -114 -103 -245 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -114 161 -208 q 93 -93 207 -160 q 113 -66 244 -103 q 131 -36 272 -36 m 0 1920 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 m 544 -1312 l 128 128 l -864 864 l -480 -480 l 128 -128 l 352 352 z"}),E.createElement("path",{className:"OfficeIconColors_m20",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),E.createElement("path",{className:"OfficeIconColors_m29",d:"M 1024 64 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 m 762 672 l -218 -218 l -736 736 l -352 -352 l -218 218 l 570 570 z"}),E.createElement("path",{className:"OfficeIconColors_m28",d:"M 1024 0 q 141 0 272 36 q 131 37 245 103 q 113 67 207 160 q 93 94 160 208 q 67 114 104 245 q 36 131 36 272 q 0 142 -36 272 q -37 131 -104 245 q -67 114 -160 207 q -94 94 -207 160 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -66 -207 -160 q -94 -93 -161 -207 q -67 -114 -103 -245 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -114 161 -208 q 93 -93 207 -160 q 113 -66 244 -103 q 131 -36 272 -36 m 0 1920 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 q 0 -75 -12 -146 q -12 -71 -35 -138 l -1041 1041 l -661 -661 l 309 -309 l 352 352 l 736 -736 l 301 301 q -46 -131 -129 -241 q -83 -110 -193 -190 q -111 -80 -244 -125 q -133 -44 -279 -44 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 m 672 -1184 l -128 -128 l -736 736 l -352 -352 l -128 128 l 480 480 z"})),ve=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1024 0 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 m 0 1920 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 m 0 -102 q -40 0 -75 -12 q -35 -12 -61 -33 q -26 -21 -41 -49 q -15 -28 -15 -60 q 0 -32 15 -60 q 15 -28 41 -49 q 26 -21 61 -33 q 35 -12 75 -12 q 40 0 75 12 q 35 12 61 33 q 26 21 41 49 q 15 28 15 60 q 0 32 -15 60 q -15 28 -41 49 q -26 21 -61 33 q -35 12 -75 12 m 128 -538 h -256 v -1024 h 256 z"}),E.createElement("path",{className:"OfficeIconColors_m212",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),E.createElement("path",{className:"OfficeIconColors_m20",d:"M 832 1344 v -1152 h 384 v 1152 m -192 538 q -53 0 -99 -17 q -47 -17 -82 -47 q -35 -30 -55 -70 q -20 -39 -20 -84 q 0 -45 20 -85 q 20 -39 55 -69 q 35 -30 82 -47 q 46 -17 99 -17 q 53 0 100 17 q 46 17 81 47 q 35 30 55 69 q 20 40 20 85 q 0 45 -20 84 q -20 40 -55 70 q -35 30 -81 47 q -47 17 -100 17 z"}),E.createElement("path",{className:"OfficeIconColors_m211",d:"M 1024 0 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 m 0 1818 q 40 0 75 -12 q 35 -12 61 -33 q 26 -21 41 -49 q 15 -28 15 -60 q 0 -32 -15 -60 q -15 -28 -41 -49 q -26 -21 -61 -33 q -35 -12 -75 -12 q -40 0 -75 12 q -35 12 -61 33 q -26 21 -41 49 q -15 28 -15 60 q 0 32 15 60 q 15 28 41 49 q 26 21 61 33 q 35 12 75 12 m 128 -1562 h -256 v 1024 h 256 m -1024 -256 q 0 164 56 311 q 56 147 154 264 q 98 117 232 196 q 133 80 289 109 q -70 -37 -112 -100 q -43 -62 -43 -140 q 0 -43 14 -82 q 14 -39 39 -72 q 24 -33 59 -59 q 34 -26 76 -43 h -124 v -1242 q -139 41 -256 123 q -117 83 -202 195 q -86 113 -134 251 q -48 138 -48 289 m 1061 880 q 156 -29 290 -109 q 133 -79 231 -196 q 98 -117 154 -264 q 56 -147 56 -311 q 0 -151 -48 -289 q -48 -138 -133 -251 q -86 -112 -203 -195 q -117 -82 -256 -123 v 1242 h -124 q 42 17 77 43 q 34 26 59 59 q 24 33 38 72 q 14 39 14 82 q 0 78 -42 140 q -43 63 -113 100 z"})),Te=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 m -715 0 l 422 421 l -182 182 l -421 -422 l -421 422 l -182 -182 l 422 -421 l -422 -421 l 182 -182 l 421 422 l 421 -422 l 182 182 z"}),E.createElement("path",{className:"OfficeIconColors_m215",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),E.createElement("path",{className:"OfficeIconColors_m20",d:"M 1024 1296 l -421 421 l -272 -272 l 421 -421 l -421 -421 l 272 -272 l 421 421 l 421 -421 l 272 272 l -421 421 l 421 421 l -272 272 z"}),E.createElement("path",{className:"OfficeIconColors_m214",d:"M 1024 843 l -421 -422 l -182 182 l 422 421 l -422 421 l 182 182 l 421 -422 l 421 422 l 182 -182 l -422 -421 l 422 -421 l -182 -182 m 363 182 l -422 421 l 422 421 l -363 363 l -421 -422 l -421 422 l -363 -363 l 422 -421 l -422 -421 l 363 -363 l 421 422 l 421 -422 m 603 784 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"})),xe=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1664 256 v 1024 h -768 v -256 h -512 v 1024 h -128 v -2048 h 768 v 256 z"}),E.createElement("path",{className:"OfficeIconColors_m29",d:"M 1600 320 v 896 h -640 v -256 h -640 v -896 h 640 v 256 z"}),E.createElement("path",{className:"OfficeIconColors_m28",d:"M 1664 256 v 1024 h -768 v -256 h -576 v -128 h 576 v -768 h -576 v -128 h 704 v 256 m 512 128 h -512 v 768 h 512 z"}),E.createElement("path",{className:"OfficeIconColors_m22",d:"M 384 2048 h -128 v -2048 h 128 z"})),Se=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1664 256 v 1024 h -768 v -256 h -512 v 1024 h -128 v -2048 h 768 v 256 m 512 128 h -293 l 293 293 m -640 -549 h -293 l 293 293 m -512 475 h 165 l -165 -165 m 512 165 v -293 l -475 -475 h -37 v 421 l 347 347 m 293 256 h 165 l -165 -165 m 512 165 v -293 l -475 -475 h -37 v 421 l 347 347 z"}),E.createElement("path",{className:"OfficeIconColors_m212",d:"M 1600 320 v 896 h -640 v -256 h -640 v -896 h 640 v 256 z"}),E.createElement("path",{className:"OfficeIconColors_m211",d:"M 1664 256 v 1024 h -768 v -256 h -576 v -128 h 576 v -768 h -576 v -128 h 704 v 256 m 512 128 h -512 v 768 h 512 z"}),E.createElement("path",{className:"OfficeIconColors_m22",d:"M 384 2048 h -128 v -2048 h 128 z"})),we=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1664 256 v 1024 h -768 v -256 h -512 v 1024 h -128 v -2048 h 768 v 256 m -128 -128 h -512 v 768 h 512 m 640 -512 h -512 v 768 h 512 z"}),E.createElement("path",{className:"OfficeIconColors_m215",d:"M 1600 320 v 896 h -640 v -256 h -640 v -896 h 640 v 256 z"}),E.createElement("path",{className:"OfficeIconColors_m214",d:"M 1664 256 v 1024 h -768 v -256 h -576 v -128 h 576 v -768 h -576 v -128 h 704 v 256 m 512 128 h -512 v 768 h 512 z"}),E.createElement("path",{className:"OfficeIconColors_m22",d:"M 384 2048 h -128 v -2048 h 128 z"})),Ee=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1027 0 l 253 640 h 768 l -605 608 l 317 800 l -733 -436 l -696 436 l 281 -800 l -612 -608 h 763 z"}),E.createElement("path",{className:"OfficeIconColors_m212",d:"M 1026 1537 l -574 360 l 233 -666 l -530 -527 h 650 l 221 -533 l 211 533 h 657 l -526 528 l 263 665 z"}),E.createElement("path",{className:"OfficeIconColors_m211",d:"M 1025 1466 l 478 285 l -210 -531 l 448 -452 h -548 l -169 -426 l -176 426 h -539 l 450 450 l -187 532 m 708 -1110 h 768 l -605 608 l 317 800 l -733 -436 l -696 436 l 281 -800 l -612 -608 h 763 l 264 -640 z"})),Ie=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1024 1467 l 479 284 l -210 -530 l 448 -453 h -548 l -169 -426 m 256 298 h 768 l -605 608 l 317 800 l -733 -436 l -696 436 l 281 -800 l -612 -608 h 763 l 264 -640 z"}),E.createElement("path",{className:"OfficeIconColors_m20",d:"M 1035 1530 l -575 361 l 234 -668 l -531 -530 h 651 l 221 -533 l 210 533 h 658 l -526 532 l 263 666 z"}),E.createElement("path",{className:"OfficeIconColors_m212",d:"M 460 1891 l 234 -668 l -531 -530 h 651 l 210 -507 v 1351 z"}),E.createElement("path",{className:"OfficeIconColors_m22",d:"M 1025 0 l 255 640 h 768 l -605 608 l 317 800 l -735 -434 v -148 l 478 285 l -210 -530 l 448 -453 h -548 l -168 -424 z"}),E.createElement("path",{className:"OfficeIconColors_m211",d:"M 1024 343 l -176 425 h -539 l 450 450 l -187 532 l 452 -283 v 147 l -693 434 l 281 -800 l -612 -608 h 763 l 261 -632 z"})),Re=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 572 1750 l 453 -284 l 478 285 l -210 -530 l 448 -453 h -548 l -169 -426 l -176 426 h -539 l 462 457 m 509 -585 h 768 l -605 608 l 317 800 l -733 -436 l -696 436 l 281 -800 l -612 -608 h 763 l 264 -640 z"}),E.createElement("path",{className:"OfficeIconColors_m20",d:"M 1026 1537 l -574 360 l 233 -666 l -530 -527 h 650 l 221 -533 l 211 533 h 657 l -526 528 l 263 665 z"}),E.createElement("path",{className:"OfficeIconColors_m210",d:"M 572 1750 l 453 -284 l 478 285 l -210 -530 l 448 -453 h -548 l -169 -426 l -176 426 h -539 l 462 457 m 509 -585 h 768 l -605 608 l 317 800 l -733 -436 l -696 436 l 281 -800 l -612 -608 h 763 l 264 -640 z"})),Ae=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1792 0 v 2048 h -1664 v -896 h 384 v -384 h 384 v -384 h 384 v -384 m -640 1280 h -128 v 640 h 128 m 384 -1024 h -128 v 1024 h 128 m 384 -1408 h -128 v 1408 h 128 z"}),E.createElement("path",{className:"OfficeIconColors_m26",d:"M 192 1984 v -768 h 384 v -384 h 384 v -384 h 384 v -384 h 384 v 1920 z"}),E.createElement("path",{className:"OfficeIconColors_m22",d:"M 1792 0 v 2048 h -1664 v -896 h 384 v -384 h 384 v -384 h 384 v -384 m -768 1280 h -256 v 640 h 256 m 384 -1024 h -256 v 1024 h 256 m 384 -1408 h -256 v 1408 h 256 m 384 -1792 h -256 v 1792 h 256 z"})),Le=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1792 0 v 2048 h -1664 v -896 h 384 v -384 h 384 v -384 h 384 v -384 m -640 1280 h -128 v 640 h 128 m 384 -1024 h -128 v 1024 h 128 m 640 -1792 h -256 v 1792 h 256 z"}),E.createElement("path",{className:"OfficeIconColors_m20",d:"M 192 1984 v -768 h 384 v -384 h 384 v -384 h 384 v -384 h 384 v 1920 z"}),E.createElement("path",{className:"OfficeIconColors_m26",d:"M 1344 1984 h -1152 v -768 h 384 v -384 h 384 v -384 h 384 z"}),E.createElement("path",{className:"OfficeIconColors_m22",d:"M 1792 0 v 2048 h -1664 v -896 h 384 v -384 h 384 v -384 h 384 v -384 m -768 1280 h -256 v 640 h 256 m 384 -1024 h -256 v 1024 h 256 m 384 -1408 h -256 v 1408 h 256 m 384 -1792 h -256 v 1792 h 256 z"})),ke=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1792 0 v 2048 h -1664 v -896 h 384 v -384 h 384 v -384 h 384 v -384 m -640 1280 h -128 v 640 h 128 m 640 -1408 h -256 v 1408 h 256 m 384 -1792 h -256 v 1792 h 256 z"}),E.createElement("path",{className:"OfficeIconColors_m20",d:"M 192 1984 v -768 h 384 v -384 h 384 v -384 h 384 v -384 h 384 v 1920 z"}),E.createElement("path",{className:"OfficeIconColors_m26",d:"M 960 1984 h -768 v -768 h 384 v -384 h 384 z"}),E.createElement("path",{className:"OfficeIconColors_m22",d:"M 1792 0 v 2048 h -1664 v -896 h 384 v -384 h 384 v -384 h 384 v -384 m -768 1280 h -256 v 640 h 256 m 384 -1024 h -256 v 1024 h 256 m 384 -1408 h -256 v 1408 h 256 m 384 -1792 h -256 v 1792 h 256 z"})),Fe=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1792 0 v 2048 h -1664 v -896 h 384 v -384 h 384 v -384 h 384 v -384 m -384 896 h -256 v 1024 h 256 m 384 -1408 h -256 v 1408 h 256 m 384 -1792 h -256 v 1792 h 256 z"}),E.createElement("path",{className:"OfficeIconColors_m20",d:"M 192 1984 v -768 h 384 v -384 h 384 v -384 h 384 v -384 h 384 v 1920 z"}),E.createElement("path",{className:"OfficeIconColors_m26",d:"M 576 1984 h -384 v -768 h 384 z"}),E.createElement("path",{className:"OfficeIconColors_m22",d:"M 1792 0 v 2048 h -1664 v -896 h 384 v -384 h 384 v -384 h 384 v -384 m -768 1280 h -256 v 640 h 256 m 384 -1024 h -256 v 1024 h 256 m 384 -1408 h -256 v 1408 h 256 m 384 -1792 h -256 v 1792 h 256 z"})),_e=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1792 0 v 2048 h -1664 v -896 h 384 v -384 h 384 v -384 h 384 v -384 m -768 1280 h -256 v 640 h 256 m 384 -1024 h -256 v 1024 h 256 m 384 -1408 h -256 v 1408 h 256 m 384 -1792 h -256 v 1792 h 256 z"}),E.createElement("path",{className:"OfficeIconColors_m20",d:"M 192 1984 v -768 h 384 v -384 h 384 v -384 h 384 v -384 h 384 v 1920 z"}),E.createElement("path",{className:"OfficeIconColors_m22",d:"M 1792 0 v 2048 h -1664 v -896 h 384 v -384 h 384 v -384 h 384 v -384 m -768 1280 h -256 v 640 h 256 m 384 -1024 h -256 v 1024 h 256 m 384 -1408 h -256 v 1408 h 256 m 384 -1792 h -256 v 1792 h 256 z"})),Pe=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 z"}),E.createElement("path",{className:"OfficeIconColors_m23",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),E.createElement("path",{className:"OfficeIconColors_m22",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"})),Ne=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1024 0 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 m 0 128 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 h 896 z"}),E.createElement("path",{className:"OfficeIconColors_m20",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),E.createElement("path",{className:"OfficeIconColors_m23",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 h 960 v -960 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),E.createElement("path",{className:"OfficeIconColors_m22",d:"M 0 1024 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 m 128 0 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 z"})),Me=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1024 0 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 m -896 1024 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 v -1792 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 z"}),E.createElement("path",{className:"OfficeIconColors_m20",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),E.createElement("path",{className:"OfficeIconColors_m23",d:"M 1984 1024 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 v -1920 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 z"}),E.createElement("path",{className:"OfficeIconColors_m22",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"})),Oe=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1024 0 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 m 0 1920 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 h -896 v -896 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 z"}),E.createElement("path",{className:"OfficeIconColors_m20",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),E.createElement("path",{className:"OfficeIconColors_m23",d:"M 1024 64 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 h -960 z"}),E.createElement("path",{className:"OfficeIconColors_m22",d:"M 1024 0 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 m 0 1920 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 z"})),De=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"}),E.createElement("path",{className:"OfficeIconColors_m20",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),E.createElement("path",{className:"OfficeIconColors_m22",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"})),Be=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1920 0 v 1920 h -1920 v -1920 m 1792 896 h -768 v -768 h -128 v 768 h -768 v 128 h 768 v 768 h 128 v -768 h 768 z"}),E.createElement("path",{className:"OfficeIconColors_m26",d:"M 1856 1856 h -1792 v -1792 h 1792 z"}),E.createElement("path",{className:"OfficeIconColors_m22",d:"M 1920 0 v 1920 h -1920 v -1920 m 896 1024 h -768 v 768 h 768 m 0 -1664 h -768 v 768 h 768 m 896 128 h -768 v 768 h 768 m 0 -1664 h -768 v 768 h 768 z"})),$e=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1920 0 v 1920 h -1920 v -1920 m 1792 128 h -896 v 768 h -768 v 128 h 768 v 768 h 128 v -768 h 768 z"}),E.createElement("path",{className:"OfficeIconColors_m20",d:"M 1856 1856 h -1792 v -1792 h 1792 z"}),E.createElement("path",{className:"OfficeIconColors_m26",d:"M 1860 956 v 903 h -1801 v -1794 h 903 v 891 z"}),E.createElement("path",{className:"OfficeIconColors_m22",d:"M 1920 0 v 1920 h -1920 v -1920 m 128 896 h 768 v -768 h -768 m 768 896 h -768 v 768 h 768 m 896 -768 h -768 v 768 h 768 m 0 -896 v -768 h -768 v 768 z"})),He=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1920 0 v 1920 h -1920 v -1920 m 1792 128 h -768 v 768 h -128 v -768 h -768 v 896 h 768 v 768 h 128 v -768 h 768 z"}),E.createElement("path",{className:"OfficeIconColors_m20",d:"M 1856 1856 h -1792 v -1792 h 1792 z"}),E.createElement("path",{className:"OfficeIconColors_m26",d:"M 1856 1856 h -1792 v -896 h 1792 z"}),E.createElement("path",{className:"OfficeIconColors_m22",d:"M 1920 0 v 1920 h -1920 v -1920 m 896 1024 h -768 v 768 h 768 m 0 -1664 h -768 v 768 h 768 m 896 128 h -768 v 768 h 768 m 0 -1664 h -768 v 768 h 768 z"})),Ue=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1920 0 v 1920 h -1920 v -1920 m 1792 128 h -768 v 768 h -128 v -768 h -768 v 896 h 768 v 768 h 896 v -768 h -768 v -126 h 768 z"}),E.createElement("path",{className:"OfficeIconColors_m20",d:"M 1856 1856 h -1792 v -1792 h 1792 z"}),E.createElement("path",{className:"OfficeIconColors_m26",d:"M 64 960 h 896 v 896 h -896 z"}),E.createElement("path",{className:"OfficeIconColors_m22",d:"M 1920 0 v 1920 h -1920 v -1920 m 896 1024 h -768 v 768 h 768 m 0 -1664 h -768 v 768 h 768 m 896 128 h -768 v 768 h 768 m 0 -1664 h -768 v 768 h 768 z"})),qe=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},E.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1920 0 v 1920 h -1920 v -1920 m 128 896 h 768 v -768 h -768 m 768 1664 v -768 h -768 v 768 m 1664 -768 h -768 v 768 h 768 m 0 -1664 h -768 v 768 h 768 z"}),E.createElement("path",{className:"OfficeIconColors_m20",d:"M 1856 1856 h -1792 v -1792 h 1792 z"}),E.createElement("path",{className:"OfficeIconColors_m22",d:"M 1920 0 v 1920 h -1920 v -1920 m 128 896 h 768 v -768 h -768 m 768 1664 v -768 h -768 v 768 m 1664 -768 h -768 v 768 h 768 m 0 -1664 h -768 v 768 h 768 z"})),Ve=()=>{(0,V.K1)({icons:{conditional_format_grey_arrow_up_icon:E.createElement(G,null),conditional_format_grey_arrow_right_icon:E.createElement(z,null),conditional_format_grey_arrow_down_icon:E.createElement(Q,null),conditional_format_grey_arrow_down_right_icon:E.createElement(j,null),conditional_format_grey_arrow_up_right_icon:E.createElement(J,null),conditional_format_colored_arrow_up_icon:E.createElement(Y,null),conditional_format_colored_arrow_right_icon:E.createElement(X,null),conditional_format_colored_arrow_down_icon:E.createElement(Z,null),conditional_format_colored_arrow_down_right_icon:E.createElement(K,null),conditional_format_colored_arrow_up_right_icon:E.createElement(ee,null),conditional_format_triangle_high_icon:E.createElement(te,null),conditional_format_triangle_medium_icon:E.createElement(ne,null),conditional_format_triangle_low_icon:E.createElement(ae,null),conditional_format_circle_high_icon:E.createElement(oe,null),conditional_format_circle_medium_icon:E.createElement(re,null),conditional_format_circle_low_icon:E.createElement(ie,null),conditional_format_4circle_high_icon:E.createElement(le,null),conditional_format_4circle_medium2_icon:E.createElement(se,null),conditional_format_4circle_medium1_icon:E.createElement(ce,null),conditional_format_4circle_low_icon:E.createElement(de,null),conditional_format_traffic_high_icon:E.createElement(ue,null),conditional_format_traffic_medium_icon:E.createElement(me,null),conditional_format_traffic_low_icon:E.createElement(ge,null),conditional_format_sign_medium_icon:E.createElement(he,null),conditional_format_sign_low_icon:E.createElement(pe,null),conditional_format_symbol_high_icon:E.createElement(be,null),conditional_format_symbol_medium_icon:E.createElement(fe,null),conditional_format_symbol_low_icon:E.createElement(Ce,null),conditional_format_circle_symbol_high_icon:E.createElement(ye,null),conditional_format_circle_symbol_medium_icon:E.createElement(ve,null),conditional_format_circle_symbol_low_icon:E.createElement(Te,null),conditional_format_flag_high_icon:E.createElement(xe,null),conditional_format_flag_medium_icon:E.createElement(Se,null),conditional_format_flag_low_icon:E.createElement(we,null),conditional_format_star_high_icon:E.createElement(Ee,null),conditional_format_star_medium_icon:E.createElement(Ie,null),conditional_format_star_low_icon:E.createElement(Re,null),conditional_format_signal_high_icon:E.createElement(Ae,null),conditional_format_signal_medium2_icon:E.createElement(Le,null),conditional_format_signal_medium1_icon:E.createElement(ke,null),conditional_format_signal_low_icon:E.createElement(Fe,null),conditional_format_signal_empty_icon:E.createElement(_e,null),conditional_format_circle_filled_icon:E.createElement(Pe,null),conditional_format_circle_75_icon:E.createElement(Ne,null),conditional_format_circle_half_icon:E.createElement(Me,null),conditional_format_circle_25_icon:E.createElement(Oe,null),conditional_format_circle_empty_icon:E.createElement(De,null),conditional_format_quadrant_full_icon:E.createElement(Be,null),conditional_format_quadrant_75_icon:E.createElement($e,null),conditional_format_quadrant_50_icon:E.createElement(He,null),conditional_format_quadrant_25_icon:E.createElement(Ue,null),conditional_format_quadrant_empty_icon:E.createElement(qe,null)}})};const We={[W.default.Nil]:[],[W.default.IconSet3Arrows]:["conditional_format_colored_arrow_up_icon","conditional_format_colored_arrow_right_icon","conditional_format_colored_arrow_down_icon"],[W.default.IconSet3ArrowsGray]:["conditional_format_grey_arrow_up_icon","conditional_format_grey_arrow_right_icon","conditional_format_grey_arrow_down_icon"],[W.default.IconSet4Arrows]:["conditional_format_colored_arrow_up_icon","conditional_format_colored_arrow_up_right_icon","conditional_format_colored_arrow_down_right_icon","conditional_format_colored_arrow_down_icon"],[W.default.IconSet4ArrowsGray]:["conditional_format_grey_arrow_up_icon","conditional_format_grey_arrow_up_right_icon","conditional_format_grey_arrow_down_right_icon","conditional_format_grey_arrow_down_icon"],[W.default.IconSet5Arrows]:["conditional_format_colored_arrow_up_icon","conditional_format_colored_arrow_up_right_icon","conditional_format_colored_arrow_right_icon","conditional_format_colored_arrow_down_right_icon","conditional_format_colored_arrow_down_icon"],[W.default.IconSet5ArrowsGray]:["conditional_format_grey_arrow_up_icon","conditional_format_grey_arrow_up_right_icon","conditional_format_grey_arrow_right_icon","conditional_format_grey_arrow_down_right_icon","conditional_format_grey_arrow_down_icon"],[W.default.IconSet3Triangles]:["conditional_format_triangle_high_icon","conditional_format_triangle_medium_icon","conditional_format_triangle_low_icon"],[W.default.IconSet3TrafficLights1]:["conditional_format_circle_high_icon","conditional_format_circle_medium_icon","conditional_format_circle_low_icon"],[W.default.IconSet3TrafficLights2]:["conditional_format_traffic_high_icon","conditional_format_traffic_medium_icon","conditional_format_traffic_low_icon"],[W.default.IconSet4TrafficLights]:["conditional_format_circle_high_icon","conditional_format_circle_medium_icon","conditional_format_circle_low_icon","conditional_format_4circle_low_icon"],[W.default.IconSet3Signs]:["conditional_format_circle_high_icon","conditional_format_sign_medium_icon","conditional_format_sign_low_icon"],[W.default.IconSet4RedToBlack]:["conditional_format_4circle_high_icon","conditional_format_4circle_medium2_icon","conditional_format_4circle_medium1_icon","conditional_format_4circle_low_icon"],[W.default.IconSet3Symbols]:["conditional_format_circle_symbol_high_icon","conditional_format_circle_symbol_medium_icon","conditional_format_circle_symbol_low_icon"],[W.default.IconSet3Symbols2]:["conditional_format_symbol_high_icon","conditional_format_symbol_medium_icon","conditional_format_symbol_low_icon"],[W.default.IconSet3Flags]:["conditional_format_flag_high_icon","conditional_format_flag_medium_icon","conditional_format_flag_low_icon"],[W.default.IconSet3Stars]:["conditional_format_star_high_icon","conditional_format_star_medium_icon","conditional_format_star_low_icon"],[W.default.IconSet4Rating]:["conditional_format_signal_low_icon","conditional_format_signal_medium1_icon","conditional_format_signal_medium2_icon","conditional_format_signal_high_icon"],[W.default.IconSet5Rating]:["conditional_format_signal_empty_icon","conditional_format_signal_low_icon","conditional_format_signal_medium1_icon","conditional_format_signal_medium2_icon","conditional_format_signal_high_icon"],[W.default.IconSet5Quarters]:["conditional_format_circle_filled_icon","conditional_format_circle_75_icon","conditional_format_circle_half_icon","conditional_format_circle_25_icon","conditional_format_circle_empty_icon"],[W.default.IconSet5Boxes]:["conditional_format_quadrant_full_icon","conditional_format_quadrant_75_icon","conditional_format_quadrant_50_icon","conditional_format_quadrant_25_icon","conditional_format_quadrant_empty_icon"]};let Ge=!1;function ze(e){let t,n;const a={},o=e.cfHitlItem.conditionalFormatResponseCardData.originalHexColors;null!=o&&(null!=o.minimumColor&&(a.minimumColor=o.minimumColor),null!=o.midpointColor&&(a.midpointColor=o.midpointColor),null!=o.maximumColor&&(a.maximumColor=o.maximumColor));const r=Object.keys(a).length,i=e.cfHitlItem.conditionalFormatResponseCardData.cardTitle,l=e.cfHitlItem.conditionalFormatResponseCardData.customFormat;switch(i){case I.D.CellValue:case I.D.Preset:case I.D.TopBottom:case I.D.TextComparison:case I.D.Dates:case I.D.UniqueValue:case I.D.CustomCreated:l&&(t=O(l));break;case I.D.ColorScale:2===r?t=D(a.minimumColor,a.maximumColor):3===r&&(t=D(a.minimumColor,a.maximumColor,a.midpointColor));break;case I.D.DataBar:{t=N;const a=e.cfHitlItem.conditionalFormatResponseCardData.dataBarFormat;if(a){const e=a.isGradientFill;n=B(a.fillColor,e)}break}case I.D.IconSet:Ge||(Ve(),Ge=!0);return function(e){const t=(a=We,o=e,r=[],o in a?a[o]:r),n=e=>E.createElement("div",{className:"conditional-formatting-response-card-icon-renderer","aria-label":ExcelCopilotCommandingHitlStrings.ConditionalFormattingSwatchAriaLabel,role:"img"},e.map((e=>E.createElement(R.I,{iconName:e,key:e,className:"conditional-formatting-response-card-icon"}))));var a,o,r;if(t.length>0)return E.createElement("div",null,n(t));return E.createElement("div",null)}(e.cfHitlItem.conditionalFormatResponseCardData.iconSetNumber);default:(0,U.debuglog)("unknown ConditionalFormatResponseCardType while forming style")}const s=function(e){switch(e){case I.D.ColorScale:case I.D.DataBar:case I.D.IconSet:return!1;default:return!0}}(i);return E.createElement("div",{className:"conditional-formatting-response-card-sample-text",style:t,"aria-label":ExcelCopilotCommandingHitlStrings.ConditionalFormattingSwatchAriaLabel,role:"img"},E.createElement("span",{hidden:!s},"AaBbCc"),E.createElement("div",{hidden:s,style:n}))}var Qe=n(178365),je=n(729851),Je=n(255507),Ye=n(831922),Xe=n(316904),Ze=n(109174),Ke=n(320378),et=n.n(Ke);const tt=/(#[a-fA-F0-9]{6})(?![a-zA-Z0-9])/g;function nt(e,t){const n=e.split(t);return E.createElement(y.E,null,n.map(((e,a)=>E.createElement(E.Fragment,{key:a},e,a!==n.length-1&&E.createElement("b",null,t)))))}function at(e){return E.createElement(Ye.StackV9,null,Ze.CP.getHumanInTheLoopRange()?nt(e.header,Ze.CP.getHumanInTheLoopRange()):E.createElement(y.E,null,e.header),E.createElement(Ye.StackV9,null,E.createElement("ul",null,e.events.map(((e,t)=>E.createElement(y.E,{block:!0,key:t},E.createElement("li",null,e)))))))}function ot(e){const t=e=>et()(e,tt,((e,t)=>function(e){const t=w();return E.createElement("span",{key:e.key},E.createElement("svg",{width:"10",height:"10"},E.createElement("rect",{className:t.swatch,width:"10",height:"10",rx:4,style:{fill:e.fillColor,strokeWidth:1}}))," ",e.fillColor)}({key:t,fillColor:e})));return E.createElement(Ye.StackV9,null,(0,q.yw9)("OfficeVSO_8976811_BoldRangeHiTLCard")&&Ze.CP.getHumanInTheLoopRange()?nt(e.header,Ze.CP.getHumanInTheLoopRange()):E.createElement(y.E,null,e.header),E.createElement(Ye.StackV9,null,E.createElement("ul",null,e.listItems.map(((e,n)=>E.createElement(y.E,{block:!0,key:n},E.createElement("li",null,e.title&&E.createElement("span",{style:{fontWeight:600}},e.title),t(e.text))))))),e.footer&&E.createElement(Ye.StackV9,null,E.createElement(y.E,null,e.footer)))}function rt(e){const t=e=>{const t={cfHitlItem:e};if((0,q.ID5)())return function(e){const t=e.cfHitlItem.conditionalFormatResponseCardData.customFormula,n=e.cfHitlItem.conditionalFormatResponseCardData.formulaExplanation,a={isLoading:!n,isNotAvailable:!n,explanation:n,onFirstTimeExplanationShown:()=>{}},o=(0,q.yw9)("OfficeVSO_9564930_SplitCommandingTelemetry")?k.q.ConditionalFormatting:k.q.Commanding;return E.createElement(L.$,{icon:"math",content:t,explanation:(0,q._NB)()?a:void 0,telemetryUsageFeatureName:o,getClipboardItem:async()=>new ClipboardItem({"text/plain":new Blob([t],{type:"text/plain"})}),ariaAttributes:{"aria-label":A.olU.FormulaSuggestion_FormulaSnippet_AriaLabel}})}(t)};return E.createElement(Ye.StackV9,null,(0,q.yw9)("OfficeVSO_8976811_BoldRangeHiTLCard")&&Ze.CP.getHumanInTheLoopRange()?nt(e.header,Ze.CP.getHumanInTheLoopRange()):E.createElement(y.E,null,e.header),E.createElement(Ye.StackV9,null,E.createElement("ul",null,e.eventIntents.map((e=>E.createElement("li",{key:e},e))),e.cfHitlItems.map((e=>E.createElement("li",{key:e.explanation},E.createElement(y.E,{style:{fontWeight:"bold"}},e.title),e.explanation,E.createElement("ul",null,e.subExplanations?.map((e=>E.createElement("li",{key:e},e)))),E.createElement("div",{hidden:!(0,q.GIC)(),className:"conditional-formatting-response-card-swatch"},(e=>{const t={cfHitlItem:e};if((0,q.GIC)())return ze(t)})(e)),E.createElement("div",{hidden:!(0,q.ID5)()||void 0===e.conditionalFormatResponseCardData.customFormula,className:"conditional-formatting-response-card-formula"},t(e))))))))}const it=(e,t)=>{if(Ze.CP.isContextLocked())return;const n=Xe.M.getInstance();Je.B.getInstance().logKeptEvent(k.BJ.Commanding,k.q.ConditionalFormattingSuggestion,je.RX.Command),n.logEvent((0,k.SV)(k.he.ConditionalFormattingSuggestionPillClicked,k.q.ConditionalFormattingSuggestion,k.KZ.ConditionalFormattingSuggestionPill,e.Key,t)),Qe.$.getInstance().submitUserQuery(e.Description)};function lt(e){return E.createElement(Ye.StackV9,null,E.createElement(y.E,{style:{paddingBottom:"8px"}},e.header),e.suggestions&&e.suggestions.length>0&&E.createElement("div",{style:{alignItems:"flex-start"}},e.suggestions.map(((t,n)=>E.createElement(v.$,{key:n,className:"chat-conditional-formatting-suggestion-pill",onClick:()=>{it(t,e.guid)}},t.Description)))))}},550781:(e,t,n)=>{"use strict";n.d(t,{x:()=>g,L:()=>m});var a=n(458179),o=n(857677),r=n(76872),i=n(316904),l=n(121924),s=n(780866),c=n(210466);const d=(0,s.n)({mainContainer:{display:"flex",flexDirection:"column",...c.Pt.gap("8px")},hitlDescriptionContainer:{display:"flex",flexDirection:"column",alignItems:"flex-start",...c.Pt.gap("4px"),alignSelf:"stretch"},callToActionTextContainer:{...c.Pt.margin("4px","0px","8px")},postExpandableListTextContainer:{...c.Pt.margin("8px","0px")}});var u=n(208520);function m(e){return{commandingHitlDescription:e,summary:"",expandableListItems:[],isLoading:!0,isNotAvailable:!1}}function g(e){const t=d();return u.createElement("div",{className:t.mainContainer},u.createElement("div",{className:t.hitlDescriptionContainer},u.createElement(l.E,null,e.isNotAvailable?ExcelCopilotCommandingHitlStrings.ValidateOfficeJsErrorMessage:e.commandingHitlDescription[0])),!e.isNotAvailable&&u.createElement(u.Fragment,null,u.createElement("div",{className:t.callToActionTextContainer},u.createElement(l.E,null,ExcelCopilotCommandingHitlStrings.CallToActionLabel)),u.createElement(a.h,{summary:e.summary,collapsedButtonLabel:ExcelCopilotCommandingHitlStrings.ChangeListCollapsedButtonLabel,expandedButtonLabel:ExcelCopilotCommandingHitlStrings.ChangeListExpandedButtonLabel,loadingLabel:ExcelCopilotCommandingHitlStrings.ChangeListLoadingLabel,expandableListItems:e.expandableListItems,isLoading:e.isLoading,isNotAvailable:e.isNotAvailable,onFirstTimeListExpanded:()=>{r.E.getInstance().updateTelemetryChatEventData({[o.h3.ChatEventType]:o.a5.CommandScratchpadExpandHitlListClicked},i.M.getInstance())}}),u.createElement("div",{className:t.postExpandableListTextContainer},u.createElement(l.E,null,ExcelCopilotCommandingHitlStrings.PostChangeListLabel))))}},551896:(e,t,n)=>{"use strict";n.d(t,{L:()=>A,f:()=>L});var a=n(83437),o=n(377159),r=n(316904);var i=n(855391),l=n(252163),s=n(715834);function c(e){return e instanceof i.Je&&e.errorCode===i.F4.PlatformDisabled}function d(e){return e instanceof i.Je&&e.errorCode===i.F4.ItemNotFound}function u(e){return e instanceof i.Je&&e.errorCode===i.F4.AccessDenied}function m(e){return e instanceof i.Je&&e.errorCode===i.F4.InvalidRequest}function g(e){return e instanceof i.Je&&e.errorCode===i.F4.MaxItemCountExceeded}const h=["Failed to fetch","NetworkError when attempting to fetch resource.","Network request failed"];const p=(0,s.or)(c,(function(e){return e instanceof i.Je&&e.errorCode===i.F4.NotAllowed})),b=(0,s.or)(p,m),f=(0,s.or)(p,d),C=(0,s.or)((function(e){return e instanceof i.Je&&e.errorCode===i.F4.NameAlreadyExists}),d),y=(0,s.or)(p,d,(function(e){return e instanceof i.Je&&e.errorCode===i.F4.InvalidFileName}),g),v=(0,s.or)((function(e){return!(e instanceof i.Je)&&e.message&&h.indexOf(e.message)>=0||e instanceof i.Je&&"Server returned non-json response"===e.message}),(function(e){return"Authorization Error"===e.message&&e.isExpectedError}),g);var T=n(321627);const x={token:null},S=e=>{const t=x;var n;t.token=e,n=t,(0,i.sA)({currentUserToken:n.token,currentUserMlapiToken:null})},w=()=>!0;async function E(e,t,n){const a=async t=>(await async function(e){const t=await o.P1.instance().authorizeStorageService(e);S(t),(0,i.HR)(L()),(0,i.mY)((0,T.u)())}(t),e(t));return(0,s.U)((async()=>async function(e,t){try{return await e(t.id)}catch(e){throw e instanceof i.Je&&401===e.status&&((0,i.ki)(null),o.P1.instance().clearStorageToken()),e}}(a,t)),w,(0,s.or)(y,n),3)}var I=n(50863),R=n(176664);class A{async getScript(e,t){const n=new I.A("getScript");try{const a=await E((t=>(0,i.IT)(e,t,!0)),n,f);return n.succeed({storageId:e.id,parentCallId:t}),a}catch(o){const r=f(o)||v(o)||u(o)?a.$b.Warning:a.$b.Error;throw n.fail(r,{parentCallId:t,storageId:e.id,writeMRU:!0},o),o}}async getCopilotScripts(e){const t=new I.A("getCopilotScripts"),n=await this.getRecentScripts(e);return t.succeed({copilotScriptCount:n.length,parentCallId:e}),n}async saveCopilotScript(e,t){const n=new I.A("saveCopilotScript");let o;try{return o=await E((t=>(0,i.FB)(e,t,!0)),n,(0,s.or)(C,p)),n.succeed({storageId:o.id,parentCallId:t}),o}catch(r){throw n.fail(a.$b.Error,{parentCallId:t,storageId:e.id},r),o&&this.removeScriptShim(o),r}}async removeRecentScriptShim(e,t){const n=new I.A("RemoveRecentScript");try{await E((e=>(0,i.zb)(t,e)),n,(0,s.or)(y,v)),n.succeed({storageId:e,parentCallId:r.M.userQueryGuid})}catch(t){n.fail(a.$b.Warning,{storageId:e,parentCallId:r.M.userQueryGuid},t)}}async removeScriptShim(e){const t=new I.A("DeleteScript");try{await E((t=>(0,i.Wb)(e,t)),t,(0,s.or)(d,c)),t.succeed({storageId:e.id,parentCallId:r.M.userQueryGuid,...e.driveType?{driveType:e.driveType}:{}})}catch(n){if(d(n)&&e.mruItemId&&await this.removeRecentScriptShim(e.id,e.mruItemId),d(n))return void t.succeed({storageId:e.id,parentCallId:r.M.userQueryGuid,...e.driveType?{driveType:e.driveType}:{}});const o=c(n)||v(n)||u(n)?a.$b.Warning:a.$b.Error;throw t.fail(o,{storageId:e.id,parentCallId:r.M.userQueryGuid,...e.driveType?{driveType:e.driveType}:{}},n),n}}async getRecentScripts(e){const t=new I.A("getRecentScripts");try{const n=await E((e=>(0,i.g5)("undefined"!=typeof Office&&Office.context&&Office.context.host?Office.context.displayLanguage:"en-US",e)),t,b);return t.succeed({scriptCount:n.length,parentCallId:e}),n}catch(n){const o=(0,s.or)(p,u)(n),r=m(n);throw t.fail(o||v(n)?a.$b.Warning:r?a.$b.ASHA:a.$b.Error,{parentCallId:e},n),new Error("Failed getRecentScripts call")}}}function L(){const e=(0,l.P)("StorageModePreference");if(e)return e===o.XT.makerserviceint?"int":"prodNew";return"Dogfood"===(0,R.A)()?"int":"prodNew"}},552398:(e,t,n)=>{"use strict";n.d(t,{Y:()=>v});var a=n(780033),o=n(260197),r=n(448514),i=n(178365),l=n(379422),s=n(708353),c=n(795167),d=n(1789),u=n(255507),m=n(857677),g=n(316904),h=n(92520),p=n(831922),b=n(99558),f=n(347145);class C{onError(e,t){switch(e){case o.Fc.HandoffMessageResponse:this.renderError(o.I5);break;case o.Fc.NoQuery:(0,h.cY)("Handoff error type: "+o.xT);break;default:throw(0,h.cY)("Unhandled Handoff error type: "+e+(t?` Error: ${JSON.stringify(t)}`:"")),new Error(o.I5)}}renderError(e){const{message:t,telemetry:n}=(0,b.v)("HandoffMessageIdResponseHandlerError: "+e,{errorType:m.q0.ClientError,featureName:m.q.HandOff},{},{feedbackData:{feedbackArea:s.O.Footer}});i.$.getInstance().displayErrorResponseIfNeeded(t,n),u.B.getInstance().sendChatEventTelemetry((0,m.pN)({[m.h3.ChatEventType]:m.a5.HandoffMessageIdResponseError,[m.h3.ChatErrorType]:m.q0.ClientError,[m.h3.ChatErrorParameters]:e})),v.getInstance().sendHandoffUserPerceivedLatency(!0)}onAnnotationReceived(e,t,n,a){if(e===c.uC.getTypeName()){u.B.getInstance().recordCheckPoint(m._R.HandoffMessageReceived);const a=t;a.queryId&&(g.M.userQueryGuid=a.queryId,u.B.userQueryGuid=a.queryId),u.B.getInstance().sendLatencyTelemetry((0,m.pN)({[m.CT.HandoffMessageResponseTime]:(0,r.W)(n),[m.CT.AnnotationType]:e,[m.CT.FeatureName]:m.BJ.Handoff}))}u.B.getInstance().sendChatEventTelemetry((0,m.pN)({[m.h3.ChatEventType]:m.a5.ResponseReceivedFromAL,[m.h3.ChatEventParameters]:e,[m.h3.Cv]:a??""}))}onHandoffMessageIdSubmitted(e){let t,n;switch(e.handoffOperation){case d.Q.GET:t=m.a5.HandoffMessageIdGetOperationSubmitted,n=m._R.HandoffMessageIdSent;break;case d.Q.PROCESSED:t=m.a5.HandoffMessageIdProcessedOperationSubmitted,n=m._R.HandoffMessageIdProcessed}t&&((0,h.cY)("Update telemetry for handoff message id submitted: ",t),u.B.getInstance().sendChatEventTelemetry((0,m.pN)({[m.h3.ChatEventType]:t}))),n&&u.B.getInstance().recordCheckPoint(n)}logDebug(...e){(0,h.cY)(e)}submitSignal(e,t){i.$.getInstance().submitOperation(t),u.B.getInstance().sendLatencyTelemetry((0,m.pN)({[m.CT.RequestSignalType]:e}))}submitQuery(e){i.$.getInstance().submitUserQuery(e)}renderBookending(e,t,n,a){if((0,f.Skv)()){const o=(0,p.generateAppCopilotHandoffResponseSystemMessage)(e,t,n,a);i.$.getInstance().displayResponse(o)}}getFlights(){return{renderChatHistoryInHandoffDestination:(0,f.yqt)(),isALHookEnabled:(0,f.UTV)(),appValueChecksForBookendingEnabled:(0,f.KT8)(),handoffToBizChatEnabled:(0,f.o94)(),enableHandoffALBridge:(0,f.sSY)(),enableBizchatHostContext:(0,f.qvj)(),fallbackHandoffsToAppChat:(0,f.ZNg)(),shouldCheckUserLicense:(0,f.iAi)(),isBizChatinSDXEnabled:(0,f.Tlo)(),shouldDefaultToBizChat:(0,f.lYv)(),useHandoffMessagePropertiesValue:(0,f.aFB)()}}}var y=n(749832);class v extends a.Q{static getInstance(){return v._instance||(v._instance=new v),v._instance}async handleHandoffMessageHostAppSettings(e,t,n){try{n?.()}catch(e){u.B.getInstance().sendChatEventTelemetry((0,m.pN)({[m.h3.ChatEventType]:m.a5.HandoffMessageFromHostAppSettingsError,[m.h3.ChatErrorParameters]:"Failed to handle CopilotInitialPrompt from HostAppSettings"}))}const a=y.V.getSetting(y.z.HandoffMessage);if(a)try{const n=JSON.parse(a)?.items?.[0];e&&t?this.handleHandoffMessage(n,"",!0,i.$.getInstance().getCopilotRef(),e,t,this.bizChatHandoffPropertiesHandler):this.handleHandoffMessage(n,"",!0,i.$.getInstance().getCopilotRef())}catch(e){u.B.getInstance().sendChatEventTelemetry((0,m.pN)({[m.h3.ChatEventType]:m.a5.HandoffMessageFromHostAppSettingsError,[m.h3.ChatErrorParameters]:"Failed to handle HandoffMessage from HostAppSettings"}))}}getHandoffMessageIdSignal(e,t,n){return new l.aO({queryId:e,handOffMessageId:t,handoffOperation:n})}isHandoffAutoSubmitPromptsEnabled(){return(0,f.yw9)("OfficeVSO_9277674_isHandoffAutoSubmitPromptsEnabled")}processHandoffMessage(e){(0,f.yw9)("OfficeVSO_10210356_FixHandoffClientMetrics")?(e.query&&e.query.trim().length>0?this.handleUserQuery(e):i.$.getInstance().setInputFocus(),this.onHandoffQueryPerceivedByUser(e)):(e.query&&0!==e.query.length||this.HandoffOperations.onError(o.Fc.NoQuery),this.handleUserQuery(e))}handleUserQuery(e){try{e.manualSendPrompt?i.$.getInstance().setInputText(e.query):this.autoExecuteQuery(e.query),(0,f.yw9)("OfficeVSO_10210356_FixHandoffClientMetrics")||this.onHandoffQueryPerceivedByUser(e)}catch(e){this.HandoffOperations.logDebug("[Handoff] Has caught error in excel: "+e.message)}}onHandoffQueryPerceivedByUser(e){let t,n;(0,f.yw9)("OfficeVSO_10210356_FixHandoffClientMetrics")&&!e.query?(t=m.a5.HandoffComplete,n=m._R.HandoffComplete):e.manualSendPrompt?(t=m.a5.HandoffQueryPerceivedByUser,n=m._R.HandoffQueryPerceivedByUser,e.query&&u.B.getInstance().setInitialHandoffQuery(e.query)):(t=m.a5.HandoffQueryAutoSubmitted,n=m._R.HandoffQueryAutoSubmitted),this.sendHandoffUserPerceivedLatency();const a={};if(e.sourceApp&&(a[m.CD.SourceApp]=e.sourceApp),e.context)try{const t=JSON.parse(e.context);t.promptType&&(a[m.CD.PromptType]=t.promptType),t.featureName&&(a[m.CD.FeatureName]=t.featureName)}catch(e){(0,h.cY)("Could not parse context to JSON from handoff message.")}e.scenarioName&&(a[m.CD.ScenarioName]=e.scenarioName),(0,h.cY)("Handoff query perceived by user: ",a),u.B.getInstance().sendChatEventTelemetry((0,m.pN)({[m.h3.ChatEventType]:t,[m.h3.ChatEventParameters]:JSON.stringify(a)})),e.handoffStartTime&&u.B.getInstance().recordCheckPoint(m._R.HandoffStart,e.handoffStartTime),u.B.getInstance().recordCheckPoint(n),u.B.getInstance().sendLatencyTelemetryForCheckPoints(!0)}sendHandoffUserPerceivedLatency(e){u.B.getInstance().sendLatencyTelemetry((0,m.pN)({[m.CT.UserPerceivedLatency]:(0,r.W)(this.handoffMessageIdRequestSubmitTime)}),e)}setBizChatHandoffPropertiesHandler(e){this.bizChatHandoffPropertiesHandler=e}getBizChatHandoffPropertiesHandler(){return this.bizChatHandoffPropertiesHandler}constructor(){super(new C,u.B.getInstance())}}},554094:(e,t,n)=>{"use strict";var a=n(341240),o=n.n(a),r=n(772777),i=n.n(r),l=n(412339),s=n.n(l),c=n(389064),d=n.n(c),u=n(269636),m=n.n(u),g=n(982017),h=n.n(g),p=n(338649),b={};b.styleTagTransform=h(),b.setAttributes=d(),b.insert=s().bind(null,"head"),b.domAPI=i(),b.insertStyleElement=m();o()(p.A,b),p.A&&p.A.locals&&p.A.locals},561187:(e,t,n)=>{"use strict";n.d(t,{e:()=>c});var a=n(75496),o=n(857677),r=n(83437),i=n(316904),l=n(467407);class s{constructor(e,t){this.finished=!1,this.reject=e=>{this.finished||(this.rejectFn(e),this.finished=!0)},this.resolve=e=>{this.finished||(this.resolveFn(e),this.finished=!0)},this.resolveFn=e,this.rejectFn=t}}class c{release(e){if(e!==this.outstandingToken)throw new Error("Release attempted by non-owner");this.outstandingToken=void 0,this.operation=void 0,this.processQueue()}processQueue(){if(this.waitQueue.length>0){const e=this.tryAcquire();if(e){this.waitQueue.shift().resolveFn(e)}}}tryAcquire(e){if(this.outstandingToken)return;const t=new d(this.release.bind(this));return this.outstandingToken=t,this.operation=e,t}async waitFor(){let e;const t=new Promise(((t,n)=>{e=new s(t,n),this.waitQueue.push(e)}));return this.processQueue(),t}logMutexTokenError(e,t,n=o.OP.ActionAI){const l=e,s={eventType:a.S2.ContextManager,errorMessage:l,logLevel:r.$b.Warning},c=i.M.getInstance(),d=[{key:a.fQ.Source,value:t}],u={prev:this.operation,current:n};d.push({key:a.fQ.Operations,value:JSON.stringify(u)}),c.logError(s,void 0,d)}constructor(){this.waitQueue=[]}}class d{release(){this.relFn(this)}logSelectionChangeEvent(){if(!this.selectionChanged){this.selectionChanged=!0;const e={key:a.Wg.SelectionChange,value:!0};(0,l.j)([e])}}constructor(e){this.relFn=e,this.selectionChanged=!1}}},565095:(e,t,n)=>{"use strict";n.d(t,{_:()=>s});var a=n(531093);function o(e,t){return null===e.column||null===e.row||null===t.column||null===t.row?1/0:Math.sqrt(Math.pow(e.column-t.column,2)+Math.pow(e.row-t.row,2))}function r(e,t){if(null===e.column||null===e.row||null===t.bottomRight.row||null===t.bottomRight.column||null===t.topLeft.row||null===t.topLeft.column)return 1/0;if(e.row>=t.topLeft.row&&e.row<=t.bottomRight.row)return Math.abs(e.column-t.topLeft.column);const n=o(e,t.topLeft),a=o(e,t.bottomRight);return Math.min(n,a)}function i(e,t){if(null===e.column||null===e.row||null===t.bottomRight.row||null===t.bottomRight.column||null===t.topLeft.row||null===t.topLeft.column)return 1/0;if(e.column>=t.topLeft.column&&e.column<=t.bottomRight.column)return Math.abs(e.row-t.topLeft.row);const n=o(e,t.topLeft),a=o(e,t.bottomRight);return Math.min(n,a)}function l(e,t){const n=[{topLeft:t.topLeft,bottomRight:{row:t.topLeft.row,column:t.bottomRight.column}},{topLeft:{row:t.bottomRight.row,column:t.topLeft.column},bottomRight:t.bottomRight}],a=[{topLeft:t.topLeft,bottomRight:{row:t.bottomRight.row,column:t.topLeft.column}},{topLeft:{row:t.topLeft.row,column:t.bottomRight.column},bottomRight:t.bottomRight}];let o=1/0;for(const t of n){const n=i(e,t);o=Math.min(o,n)}for(const t of a){const n=r(e,t);o=Math.min(o,n)}return o}function s(e,t){const n=[{row:e.topLeft.row,column:e.topLeft.column},{row:e.topLeft.row,column:e.bottomRight.column},{row:e.bottomRight.row,column:e.topLeft.column},{row:e.bottomRight.row,column:e.bottomRight.column}];if(a.ExcelCalc.IExcelRangeIntersect(e,t))return 0;let o=1/0;for(const e of n){const n=l(e,t);o=Math.min(o,n)}return o}},573367:(e,t,n)=>{"use strict";n.d(t,{D4:()=>h,tN:()=>p,HF:()=>f,M7:()=>m,Hf:()=>g,Pe:()=>b,y3:()=>s,m6:()=>c,mz:()=>d,tT:()=>u});var a=n(279395),o=n(963002),r=n(126521),i=n(659126);var l=n(360449);const s=15,c=30,d=1,u=2;function m(e,t){switch(typeof e){case"string":return e;case"boolean":return t.trim();default:return t}}async function g(e,t,n){const{name:o,nameReferences:s}=t;if(o)return o;if(null==s)throw new Error("V3.PivotTableField is missing nameReferences.");if(s.length>1){return async function(e,t,n){const o=Promise.all((0,l.O)(t,e.getValue.bind(e))),s=Promise.all((0,l.O)(t,e.getText.bind(e))),[c,d]=await Promise.all([o,s]);return function(e,t,n){if(null==e)return null;const o=e.map(((e,n)=>m(e,t[n])));return o.every(i.So)?(0,r.L)((0,a.m1B)(),n):o.map((e=>(0,i.So)(e)?(0,a.Atw)():e)).join(" ")}(c,d,n)}(e,s,"columnMajor"===n.table.orientation?s[s.length-1].column-n.table.tableLocation.left+1:s[s.length-1].row-n.table.tableLocation.top+1)}const{row:c,column:d}=s[0];if(void 0===c&&void 0===d)throw new Error("V3.SourceCellReference is missing both row and column references.");if(void 0===c)return(0,r.L)((0,a.m1B)(),d-n.table.tableLocation.left+1);if(void 0===d)return(0,r.L)((0,a.m1B)(),c-n.table.tableLocation.top+1);const u=e.getValue(c,d),g=e.getText(c,d),[h,p]=await Promise.all([u,g]),b=m(h,p);return(0,i.So)(b)?(0,a.Atw)():b}const h="m/d/yyyy",p={key:h,currency:!1,dateTime:!0,dateTimeHasDayOfWeek:!0,dateTimeHasMonth:!0,dateTimeHasYear:!0,numeric:!1,percent:!1,text:!1};async function b(e,t,n){const r=e.getValue(t,n),i=e.getText(t,n),l=e.getFormatLocal(t,n),s=e.formatSourceDate(t,n),[c,d,u,m]=await Promise.all([r,i,l,s]);if(m&&o.P.getNumberFormatCache().isDateTime(u))return m;{const e=function(e,t,n){return"string"==typeof e?e:"number"!=typeof e||o.P.getNumberFormatCache().isDateTime(n)?t:e.toString()}(c,d,u);return null==c?(0,a.Atw)():e}}function f(e){const t=(e.columnFields||[]).length,n=(e.dataFields||[]).length;return t+(t>0&&n>1?1:0)+1}},575934:(e,t,n)=>{"use strict";n.d(t,{HK:()=>r,HW:()=>o,m9:()=>i});var a=n(279395);function o(e){return e.runs.map((e=>e.text)).join("")}function r(e,t){const n=o(e),a=n.length,r=n.substring(0,t);return t<a?r.concat("…"):r}function i(e){return e.map((e=>null==e?(0,a.Atw)():e))}},575976:(e,t)=>{"use strict";let n;Object.defineProperty(t,"__esModule",{value:!0});const a=new Uint8Array(16);t.default=function(){if(!n){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");n=crypto.getRandomValues.bind(crypto)}return n(a)}},579786:(e,t,n)=>{"use strict";n.d(t,{GF:()=>i,dr:()=>l,vq:()=>s});var a=n(616166),o=n(464077),r=n(468967);async function i(e,t){return Excel.run({delayForCellEdit:!0},(async n=>{const a=n.workbook.tables.getItemOrNullObject(e).load("isNullObject");if(await n.sync(),a.isNullObject)return[];const o=a.getDataBodyRange().load("rowCount");return await n.sync(),l(n,o,t)}))}async function l(e,t,n){t.rowCount<n&&(n=t.rowCount);const a=[];for(let e=0;e<n;e++){const n=t.getRow(e).load(["isEntireRow","isEntireColumn","text"]);a.push(n)}await e.sync();const o=[];for(let e=0;e<a.length;e++){if(a[e].isEntireColumn||a[e].isEntireRow||!a[e].text)throw(0,r._s)("Range is null due to payload size limit.",void 0);o.push(a[e].text[0])}return o}async function s(e,t,n,l,s,c){let d=[];if(!0!==e.tableLikeRange)d=await i(e.name,c);else{if(!t){throw(0,r.Uc)(a.O.PythonContextUndefinedParameter,"Undefined Parameter: sheetId, Function: getSampleRowsForPythonAda",void 0)}d=await async function(e,t,n,a,r){const i=(0,o.R1)(e,n,a);if(i){const e=(0,o.K7)(i),n=t.workbook.worksheets.getItem(e.worksheetId);return await(0,o.m)(t,n,e,r)}return[]}(l,s,t,n,c)}return d}},579870:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default="00000000-0000-0000-0000-000000000000"},581389:(e,t,n)=>{"use strict";n.d(t,{r:()=>r});var a=n(371120),o=n(614978);function r(e,t,n){if(!(0,a.$)(t))return null;function r(e){return"number"==typeof e&&Number.isFinite(e)}let i=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,s=!1;return e.series.forEach(((c,d)=>{if(c.valueAxisGroup!==n)return;const u=(0,a.Q)(e,d,t);if(!u)return;const m="histogram"===c.layout?(0,o.Mi)(c,e.data):u.values.raw.filter(r);0!==m.length&&(i=m.reduce(((e,t)=>Math.min(e,t)),i),l=m.reduce(((e,t)=>Math.max(e,t)),l),s=!0)})),s?{min:i,max:l}:null}},584660:(e,t,n)=>{"use strict";n.d(t,{R:()=>s});var a=n(217425),o=n(632197),r=n(660606),i=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{s(a.next(e))}catch(e){r(e)}}function l(e){try{s(a.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((a=a.apply(e,t||[])).next())}))},l=function(e,t){var n,a,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(n=1,a&&(o=2&l[0]?a.return:l[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,l[1])).done)return o;switch(a=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,a=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],a=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},s=function(e,t){return i(void 0,void 0,void 0,(function(){var n,i,s;return l(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),n=t?a.dX:a.L6,[4,e.getToken(n)];case 1:return i=l.sent(),[2,(0,o.t)(i)];case 2:throw s=l.sent(),(0,r.cY)("Error fetching Safe Links token:",s),s;case 3:return[2]}}))}))}},585305:(e,t,n)=>{"use strict";n.d(t,{u:()=>l});var a=n(897729),o=n(108235),r=n.n(o),i=n(208520);const l=i.memo((({text:e,...t})=>e?i.createElement("div",{...t,dangerouslySetInnerHTML:{__html:r().sanitize(e)}}):i.createElement(a.Q,null)))},586428:(e,t,n)=>{"use strict";n.d(t,{Az:()=>m,BC:()=>g,D9:()=>h,Ei:()=>S,ON:()=>a,P6:()=>C,Pl:()=>F,QN:()=>L,Qi:()=>p,SB:()=>d,U$:()=>_,Vs:()=>E,Wn:()=>A,Wx:()=>y,Yg:()=>w,Zx:()=>c,e0:()=>R,gv:()=>k,hr:()=>u,iR:()=>v,kd:()=>x,r$:()=>T,tF:()=>f,vA:()=>s,w8:()=>i,wm:()=>o,yX:()=>I,z8:()=>b});const a="#FFFFFF",o="#D2D2D2",r="#ED7331",i="#595959",l="#0000FF",s=["#DD5A13",l],c=o,d=r,u=[r,l],m=50,g=33,h=3,p=7,b=-30,f=100,C=20,y=.33,v=.07,T=.1,x=3,S="#F0F0F0",w=i,E="Dot",I=2,R="inherit",A=8.25,L=7.4,k=["h:mm AM/PM","h:mm:ss AM/PM","AM/PM h:mm;","AM/PM h:mm:ss;","h:mm","h:mm:ss","m/d/yyyy h:mm","mm:ss","ms:ss.0","[h]:mm:ss","h:mm AM/PM;@","h:mm:ss AM/PM;@","AM/PM h:mm;@","AM/PM h:mm:ss;@","h:mm;@","h:mm:ss;@","mm:ss.0;@","[h]:mm:ss;@","m/d/yy h:mm;@"],F=255,_=255},589835:(e,t,n)=>{"use strict";n.d(t,{A:()=>C});var a=n(535718),o=n.n(a),r=n(871038),i=n.n(r),l=n(185877),s=n.n(l),c=new URL(n(69336),n.b),d=new URL(n(952978),n.b),u=new URL(n(824815),n.b),m=new URL(n(767176),n.b),g=i()(o()),h=s()(c),p=s()(d),b=s()(u),f=s()(m);g.push([e.id,`:root {\n  --bgColor: #fafafa;\n}\nhtml,\nbody {\n  height: 100%;\n  width: 100%;\n  overflow: hidden;\n  background-color: var(--bgColor);\n}\n\n#log {\n  max-height: 92%;\n  max-width: 100%;\n  overflow: auto;\n  overflow-wrap: break-word;\n}\n\n.ChatUi {\n  position: absolute;\n  top: 5px;\n  bottom: 5px;\n  left: 0;\n  right: 0;\n  background-color: var(--bgColor);\n}\n\n.chat-input-text {\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-size: 14px;\n  font-weight: 400;\n  line-height: 20px;\n}\n\n.chat-page-fre {\n  overflow-wrap: break-word;\n  overflow-y: auto;\n  scroll-behavior: smooth;\n  margin-bottom: 5px;\n}\n\n.chat-input-text:focus {\n  outline: none;\n}\n\n.chat-footer-hyper-link-text {\n  /* Hyperlink */\n  height: 16px;\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-weight: 400;\n  font-size: 12px;\n  line-height: 16px;\n  text-decoration-line: underline;\n  /* Excel Colors / XL Primary */\n  color: #107c41;\n  /* Inside auto layout */\n  margin-top: 3px;\n}\n\n.chat-footer-like-button {\n  background-image: url(${h});\n  background-color: white;\n  border: #ffffff;\n  background-repeat: no-repeat;\n  background-position-x: center;\n  background-position-y: 8px;\n  width: 28px;\n  height: 26px;\n}\n\n.chat-footer-like-button:hover {\n  background-color: #f2f2f2;\n}\n\n.chat-footer-dislike-button {\n  background-image: url(${p});\n  margin-left: 8px;\n  background-color: white;\n  border: #ffffff;\n  background-repeat: no-repeat;\n  background-position-x: center;\n  background-position-y: 8px;\n  width: 28px;\n  height: 26px;\n}\n\n.chat-footer-dislike-button:hover {\n  background-color: #f2f2f2;\n}\n\n.chat-footer-info-button {\n  background-image: url(${b});\n  background-color: white;\n  border: #ffffff;\n  margin-left: 8px;\n  background-repeat: no-repeat;\n  background-position-x: center;\n  background-position-y: 8px;\n  width: 28px;\n  height: 26px;\n}\n\n.chat-footer-info-button:hover {\n  background-color: #f2f2f2;\n}\n\n.chat-log {\n  padding-top: 5px;\n  overflow-wrap: break-word;\n  overflow-y: scroll;\n  background-color: white;\n  margin-bottom: 5px;\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-size: 14px;\n  font-weight: 400;\n  line-height: 20px;\n}\n\n.chat-log-human {\n  align-self: flex-end;\n  align-items: flex-start;\n  border: 1px solid #bebbb8;\n  background-color: #edebe9;\n  border-radius: 4px;\n  max-width: 80%;\n  margin: 0px 10px 0px 5px;\n  padding: 8px 10px;\n  gap: 4px;\n}\n\n.chat-log-chatgpt {\n  align-self: flex-start;\n  align-items: flex-start;\n  border: 1px solid #d2d0ce;\n  background-color: #ffffff;\n  border-radius: 4px;\n  max-width: 80%;\n  margin: 0px 0px 0px 15px;\n  padding: 8px 10px;\n  gap: 4px;\n}\n\n.chat-log-chatgpt-designerlink {\n  text-decoration: none;\n  color: #b1470e;\n  margin-right: 4px;\n}\n\n.chat-log-suggestion ul {\n  padding-left: 15px;\n}\n\n.chat-log-suggestion {\n  align-self: flex-start;\n  text-align: start;\n  border: 1px solid rgb(210, 208, 206);\n  border-radius: 4px;\n  padding: 8px 10px;\n  max-width: 88%;\n  text-overflow: clip;\n  margin: 0px 0px 0px 15px;\n  white-space: pre-wrap !important;\n}\n\n.chat-log-suggestion-header {\n  font-weight: 600;\n  margin-bottom: 0.5vh;\n}\n\n.welcome-message {\n  margin-top: 100px;\n  padding-top: 20px;\n}\n\n.disclaimer {\n  font-size: 0.69rem;\n  line-height: 127%;\n  color: #707070;\n  margin: 4px 20px 0px 15px;\n}\n\n.chat-suggestionPane {\n  align-items: flex-end;\n  background: transparent;\n  margin-right: 10px;\n  margin-left: 10px;\n  justify-content: flex-start;\n  font-size: 12px;\n  padding: 4px 0px;\n  gap: 8px;\n  display: flex;\n  flex-wrap: wrap;\n  font-family: "Segoe UI";\n  font-style: normal;\n}\n\n.chat-suggestionPane-heading {\n  flex-direction: row;\n  align-items: center;\n  justify-content: flex-end;\n  margin-bottom: 5px;\n  gap: 5px;\n}\n\n.chat-suggestionPane-headingImage {\n  width: 16px;\n  height: 16px;\n}\n\n.chat-suggestionPane-headingText {\n  font-weight: 700;\n  font-size: 10px;\n  line-height: 13px;\n  display: flex;\n  align-items: center;\n  text-align: right;\n  letter-spacing: 0.04em;\n  text-transform: uppercase;\n  color: #949494;\n}\n\n.chat-suggestionPane-icon {\n  align-items: center;\n  text-align: center;\n  color: #242424;\n  background-color: transparent;\n  vertical-align: middle;\n  border: 2px solid #107c41;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-radius: 6px;\n  width: 32px;\n  height: 32px;\n}\n\n.chat-suggestionPane-button {\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n  height: 32px;\n  background: #ffffff;\n  border: 2px solid #107c41;\n  border-radius: 6px;\n  line-height: 16px;\n  padding: 0px 10px;\n}\n\n.chat-suggestionPane-label {\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-weight: 400;\n  font-size: 11px;\n  align-items: center;\n  text-align: center;\n  color: #242424;\n  background-color: transparent;\n  order: 0;\n  vertical-align: middle;\n  margin: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n.user-chat-query-container {\n  margin: 12px;\n}\n\n.chat-input {\n  border: 1px solid #d1d1d1;\n  border-radius: 8px;\n  background: #ffffff;\n  margin-left: 15px;\n  margin-right: 20px;\n  padding: 4px;\n  gap: 4px;\n  position: relative;\n  z-index: 1;\n}\n\n.chat-input-onfocus-border::after {\n  position: absolute;\n  z-index: -1;\n  bottom: 0;\n  left: 0;\n  width: 100%;\n  height: 5px;\n  content: "";\n  border-radius: 0px 0px 8px 8px;\n  background-image: linear-gradient(90.5deg, #107c41 0%, #429537 100%);\n}\n\n.chat-fixed-input-text {\n  align-items: flex-start;\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-weight: 600;\n  font-size: 14px;\n  gap: 1px;\n  line-height: 20px;\n  color: #107c41;\n  white-space: pre-wrap;\n}\n\n.chat-fixed-input-text:focus {\n  outline: none;\n}\n\n.chat-input-ghost-text {\n  color: #bebebe;\n  align-items: flex-start;\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-size: 14px;\n  gap: 1px;\n  line-height: 20px;\n}\n\n.chat-input-buttons {\n  align-items: flex-start;\n  background: #ffffff;\n  flex-direction: row;\n  gap: 2px;\n  margin-bottom: 10px;\n  justify-content: space-between;\n}\n\n.chat-input-buttons-suggestion {\n  align-self: flex-start;\n  background-color: white;\n  border: #ffffff;\n  border-radius: 8px;\n  background-repeat: no-repeat;\n  background-position: center;\n  margin-left: 4px;\n  width: 32px;\n  height: 32px;\n}\n\n.chat-input-buttons-suggestion > .ms-Button-flexContainer {\n  align-items: center;\n}\n\n.chat-input-buttons-suggestion:hover {\n  background-color: #f2f2f2;\n}\n\n.chat-input-buttons-suggestion-clicked {\n  align-self: flex-start;\n  background-color: #edebe9;\n  border: #ffffff;\n  border-radius: 8px;\n  background-repeat: no-repeat;\n  background-position: center;\n  margin-left: 4px;\n  width: 32px;\n  height: 32px;\n}\n\n.chat-input-buttons-suggestion-clicked:hover {\n  background-color: #edebe9;\n}\n\n.chat-input-buttons-send {\n  align-self: flex-end;\n  background-image: url(${f});\n  background-color: white;\n  border: #ffffff;\n  border-radius: 8px;\n  background-repeat: no-repeat;\n  background-position: center;\n  margin-right: 2px;\n  width: 32px;\n  height: 32px;\n}\n\n.chat-input-buttons-send:hover {\n  background-color: #f2f2f2;\n}\n\n.chat-taskPane-learn-more-button {\n  align-items: center;\n  justify-content: center;\n  width: 77px;\n  height: 24px;\n  background: transparent;\n  border: 1px solid #616161;\n  border-radius: 4px;\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-weight: 400;\n  font-size: 12px;\n  color: #616161;\n  line-height: 16px;\n  box-sizing: border-box;\n}\n\n.chat-taskPane-learn-more-button:hover {\n  cursor: pointer;\n}\n\n/*\n  * This class is used to set the max height of the input field in the chat UI.\n  * It ensures that the input field does not exceed the height of its container,\n  * allowing for a better user experience when typing long messages.\n*/\n.fai-EditorInput {\n  max-height: 100%;\n}\n`,"",{version:3,sources:["webpack://./src/frontend/pages/ChatUiLanding/ChatUi.css"],names:[],mappings:"AAAA;EACE,kBAAkB;AACpB;AACA;;EAEE,YAAY;EACZ,WAAW;EACX,gBAAgB;EAChB,gCAAgC;AAClC;;AAEA;EACE,eAAe;EACf,eAAe;EACf,cAAc;EACd,yBAAyB;AAC3B;;AAEA;EACE,kBAAkB;EAClB,QAAQ;EACR,WAAW;EACX,OAAO;EACP,QAAQ;EACR,gCAAgC;AAClC;;AAEA;EACE,uBAAuB;EACvB,kBAAkB;EAClB,eAAe;EACf,gBAAgB;EAChB,iBAAiB;AACnB;;AAEA;EACE,yBAAyB;EACzB,gBAAgB;EAChB,uBAAuB;EACvB,kBAAkB;AACpB;;AAEA;EACE,aAAa;AACf;;AAEA;EACE,cAAc;EACd,YAAY;EACZ,uBAAuB;EACvB,kBAAkB;EAClB,gBAAgB;EAChB,eAAe;EACf,iBAAiB;EACjB,+BAA+B;EAC/B,8BAA8B;EAC9B,cAAc;EACd,uBAAuB;EACvB,eAAe;AACjB;;AAEA;EACE,yDAAqD;EACrD,uBAAuB;EACvB,eAAe;EACf,4BAA4B;EAC5B,6BAA6B;EAC7B,0BAA0B;EAC1B,WAAW;EACX,YAAY;AACd;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,yDAAwD;EACxD,gBAAgB;EAChB,uBAAuB;EACvB,eAAe;EACf,4BAA4B;EAC5B,6BAA6B;EAC7B,0BAA0B;EAC1B,WAAW;EACX,YAAY;AACd;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,yDAA4D;EAC5D,uBAAuB;EACvB,eAAe;EACf,gBAAgB;EAChB,4BAA4B;EAC5B,6BAA6B;EAC7B,0BAA0B;EAC1B,WAAW;EACX,YAAY;AACd;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,gBAAgB;EAChB,yBAAyB;EACzB,kBAAkB;EAClB,uBAAuB;EACvB,kBAAkB;EAClB,uBAAuB;EACvB,kBAAkB;EAClB,eAAe;EACf,gBAAgB;EAChB,iBAAiB;AACnB;;AAEA;EACE,oBAAoB;EACpB,uBAAuB;EACvB,yBAAyB;EACzB,yBAAyB;EACzB,kBAAkB;EAClB,cAAc;EACd,wBAAwB;EACxB,iBAAiB;EACjB,QAAQ;AACV;;AAEA;EACE,sBAAsB;EACtB,uBAAuB;EACvB,yBAAyB;EACzB,yBAAyB;EACzB,kBAAkB;EAClB,cAAc;EACd,wBAAwB;EACxB,iBAAiB;EACjB,QAAQ;AACV;;AAEA;EACE,qBAAqB;EACrB,cAAc;EACd,iBAAiB;AACnB;;AAEA;EACE,kBAAkB;AACpB;;AAEA;EACE,sBAAsB;EACtB,iBAAiB;EACjB,oCAAoC;EACpC,kBAAkB;EAClB,iBAAiB;EACjB,cAAc;EACd,mBAAmB;EACnB,wBAAwB;EACxB,gCAAgC;AAClC;;AAEA;EACE,gBAAgB;EAChB,oBAAoB;AACtB;;AAEA;EACE,iBAAiB;EACjB,iBAAiB;AACnB;;AAEA;EACE,kBAAkB;EAClB,iBAAiB;EACjB,cAAc;EACd,yBAAyB;AAC3B;;AAEA;EACE,qBAAqB;EACrB,uBAAuB;EACvB,kBAAkB;EAClB,iBAAiB;EACjB,2BAA2B;EAC3B,eAAe;EACf,gBAAgB;EAChB,QAAQ;EACR,aAAa;EACb,eAAe;EACf,uBAAuB;EACvB,kBAAkB;AACpB;;AAEA;EACE,mBAAmB;EACnB,mBAAmB;EACnB,yBAAyB;EACzB,kBAAkB;EAClB,QAAQ;AACV;;AAEA;EACE,WAAW;EACX,YAAY;AACd;;AAEA;EACE,gBAAgB;EAChB,eAAe;EACf,iBAAiB;EACjB,aAAa;EACb,mBAAmB;EACnB,iBAAiB;EACjB,sBAAsB;EACtB,yBAAyB;EACzB,cAAc;AAChB;;AAEA;EACE,mBAAmB;EACnB,kBAAkB;EAClB,cAAc;EACd,6BAA6B;EAC7B,sBAAsB;EACtB,yBAAyB;EACzB,iBAAiB;EACjB,kBAAkB;EAClB,kBAAkB;EAClB,WAAW;EACX,YAAY;AACd;;AAEA;EACE,aAAa;EACb,mBAAmB;EACnB,uBAAuB;EACvB,mBAAmB;EACnB,YAAY;EACZ,mBAAmB;EACnB,yBAAyB;EACzB,kBAAkB;EAClB,iBAAiB;EACjB,iBAAiB;AACnB;;AAEA;EACE,uBAAuB;EACvB,kBAAkB;EAClB,gBAAgB;EAChB,eAAe;EACf,mBAAmB;EACnB,kBAAkB;EAClB,cAAc;EACd,6BAA6B;EAC7B,QAAQ;EACR,sBAAsB;EACtB,WAAW;EACX,iBAAiB;EACjB,kBAAkB;AACpB;;AAEA;EACE,YAAY;AACd;;AAEA;EACE,yBAAyB;EACzB,kBAAkB;EAClB,mBAAmB;EACnB,iBAAiB;EACjB,kBAAkB;EAClB,YAAY;EACZ,QAAQ;EACR,kBAAkB;EAClB,UAAU;AACZ;;AAEA;EACE,kBAAkB;EAClB,WAAW;EACX,SAAS;EACT,OAAO;EACP,WAAW;EACX,WAAW;EACX,WAAW;EACX,8BAA8B;EAC9B,oEAAoE;AACtE;;AAEA;EACE,uBAAuB;EACvB,uBAAuB;EACvB,kBAAkB;EAClB,gBAAgB;EAChB,eAAe;EACf,QAAQ;EACR,iBAAiB;EACjB,cAAc;EACd,qBAAqB;AACvB;;AAEA;EACE,aAAa;AACf;;AAEA;EACE,cAAc;EACd,uBAAuB;EACvB,uBAAuB;EACvB,kBAAkB;EAClB,eAAe;EACf,QAAQ;EACR,iBAAiB;AACnB;;AAEA;EACE,uBAAuB;EACvB,mBAAmB;EACnB,mBAAmB;EACnB,QAAQ;EACR,mBAAmB;EACnB,8BAA8B;AAChC;;AAEA;EACE,sBAAsB;EACtB,uBAAuB;EACvB,eAAe;EACf,kBAAkB;EAClB,4BAA4B;EAC5B,2BAA2B;EAC3B,gBAAgB;EAChB,WAAW;EACX,YAAY;AACd;;AAEA;EACE,mBAAmB;AACrB;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,sBAAsB;EACtB,yBAAyB;EACzB,eAAe;EACf,kBAAkB;EAClB,4BAA4B;EAC5B,2BAA2B;EAC3B,gBAAgB;EAChB,WAAW;EACX,YAAY;AACd;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,oBAAoB;EACpB,yDAA4D;EAC5D,uBAAuB;EACvB,eAAe;EACf,kBAAkB;EAClB,4BAA4B;EAC5B,2BAA2B;EAC3B,iBAAiB;EACjB,WAAW;EACX,YAAY;AACd;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,mBAAmB;EACnB,uBAAuB;EACvB,WAAW;EACX,YAAY;EACZ,uBAAuB;EACvB,yBAAyB;EACzB,kBAAkB;EAClB,uBAAuB;EACvB,kBAAkB;EAClB,gBAAgB;EAChB,eAAe;EACf,cAAc;EACd,iBAAiB;EACjB,sBAAsB;AACxB;;AAEA;EACE,eAAe;AACjB;;AAEA;;;;CAIC;AACD;EACE,gBAAgB;AAClB",sourcesContent:[':root {\n  --bgColor: #fafafa;\n}\nhtml,\nbody {\n  height: 100%;\n  width: 100%;\n  overflow: hidden;\n  background-color: var(--bgColor);\n}\n\n#log {\n  max-height: 92%;\n  max-width: 100%;\n  overflow: auto;\n  overflow-wrap: break-word;\n}\n\n.ChatUi {\n  position: absolute;\n  top: 5px;\n  bottom: 5px;\n  left: 0;\n  right: 0;\n  background-color: var(--bgColor);\n}\n\n.chat-input-text {\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-size: 14px;\n  font-weight: 400;\n  line-height: 20px;\n}\n\n.chat-page-fre {\n  overflow-wrap: break-word;\n  overflow-y: auto;\n  scroll-behavior: smooth;\n  margin-bottom: 5px;\n}\n\n.chat-input-text:focus {\n  outline: none;\n}\n\n.chat-footer-hyper-link-text {\n  /* Hyperlink */\n  height: 16px;\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-weight: 400;\n  font-size: 12px;\n  line-height: 16px;\n  text-decoration-line: underline;\n  /* Excel Colors / XL Primary */\n  color: #107c41;\n  /* Inside auto layout */\n  margin-top: 3px;\n}\n\n.chat-footer-like-button {\n  background-image: url("./../../assets/like-icon.svg");\n  background-color: white;\n  border: #ffffff;\n  background-repeat: no-repeat;\n  background-position-x: center;\n  background-position-y: 8px;\n  width: 28px;\n  height: 26px;\n}\n\n.chat-footer-like-button:hover {\n  background-color: #f2f2f2;\n}\n\n.chat-footer-dislike-button {\n  background-image: url("./../../assets/dislike-icon.svg");\n  margin-left: 8px;\n  background-color: white;\n  border: #ffffff;\n  background-repeat: no-repeat;\n  background-position-x: center;\n  background-position-y: 8px;\n  width: 28px;\n  height: 26px;\n}\n\n.chat-footer-dislike-button:hover {\n  background-color: #f2f2f2;\n}\n\n.chat-footer-info-button {\n  background-image: url("./../../assets/information-icon.svg");\n  background-color: white;\n  border: #ffffff;\n  margin-left: 8px;\n  background-repeat: no-repeat;\n  background-position-x: center;\n  background-position-y: 8px;\n  width: 28px;\n  height: 26px;\n}\n\n.chat-footer-info-button:hover {\n  background-color: #f2f2f2;\n}\n\n.chat-log {\n  padding-top: 5px;\n  overflow-wrap: break-word;\n  overflow-y: scroll;\n  background-color: white;\n  margin-bottom: 5px;\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-size: 14px;\n  font-weight: 400;\n  line-height: 20px;\n}\n\n.chat-log-human {\n  align-self: flex-end;\n  align-items: flex-start;\n  border: 1px solid #bebbb8;\n  background-color: #edebe9;\n  border-radius: 4px;\n  max-width: 80%;\n  margin: 0px 10px 0px 5px;\n  padding: 8px 10px;\n  gap: 4px;\n}\n\n.chat-log-chatgpt {\n  align-self: flex-start;\n  align-items: flex-start;\n  border: 1px solid #d2d0ce;\n  background-color: #ffffff;\n  border-radius: 4px;\n  max-width: 80%;\n  margin: 0px 0px 0px 15px;\n  padding: 8px 10px;\n  gap: 4px;\n}\n\n.chat-log-chatgpt-designerlink {\n  text-decoration: none;\n  color: #b1470e;\n  margin-right: 4px;\n}\n\n.chat-log-suggestion ul {\n  padding-left: 15px;\n}\n\n.chat-log-suggestion {\n  align-self: flex-start;\n  text-align: start;\n  border: 1px solid rgb(210, 208, 206);\n  border-radius: 4px;\n  padding: 8px 10px;\n  max-width: 88%;\n  text-overflow: clip;\n  margin: 0px 0px 0px 15px;\n  white-space: pre-wrap !important;\n}\n\n.chat-log-suggestion-header {\n  font-weight: 600;\n  margin-bottom: 0.5vh;\n}\n\n.welcome-message {\n  margin-top: 100px;\n  padding-top: 20px;\n}\n\n.disclaimer {\n  font-size: 0.69rem;\n  line-height: 127%;\n  color: #707070;\n  margin: 4px 20px 0px 15px;\n}\n\n.chat-suggestionPane {\n  align-items: flex-end;\n  background: transparent;\n  margin-right: 10px;\n  margin-left: 10px;\n  justify-content: flex-start;\n  font-size: 12px;\n  padding: 4px 0px;\n  gap: 8px;\n  display: flex;\n  flex-wrap: wrap;\n  font-family: "Segoe UI";\n  font-style: normal;\n}\n\n.chat-suggestionPane-heading {\n  flex-direction: row;\n  align-items: center;\n  justify-content: flex-end;\n  margin-bottom: 5px;\n  gap: 5px;\n}\n\n.chat-suggestionPane-headingImage {\n  width: 16px;\n  height: 16px;\n}\n\n.chat-suggestionPane-headingText {\n  font-weight: 700;\n  font-size: 10px;\n  line-height: 13px;\n  display: flex;\n  align-items: center;\n  text-align: right;\n  letter-spacing: 0.04em;\n  text-transform: uppercase;\n  color: #949494;\n}\n\n.chat-suggestionPane-icon {\n  align-items: center;\n  text-align: center;\n  color: #242424;\n  background-color: transparent;\n  vertical-align: middle;\n  border: 2px solid #107c41;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-radius: 6px;\n  width: 32px;\n  height: 32px;\n}\n\n.chat-suggestionPane-button {\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n  height: 32px;\n  background: #ffffff;\n  border: 2px solid #107c41;\n  border-radius: 6px;\n  line-height: 16px;\n  padding: 0px 10px;\n}\n\n.chat-suggestionPane-label {\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-weight: 400;\n  font-size: 11px;\n  align-items: center;\n  text-align: center;\n  color: #242424;\n  background-color: transparent;\n  order: 0;\n  vertical-align: middle;\n  margin: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n.user-chat-query-container {\n  margin: 12px;\n}\n\n.chat-input {\n  border: 1px solid #d1d1d1;\n  border-radius: 8px;\n  background: #ffffff;\n  margin-left: 15px;\n  margin-right: 20px;\n  padding: 4px;\n  gap: 4px;\n  position: relative;\n  z-index: 1;\n}\n\n.chat-input-onfocus-border::after {\n  position: absolute;\n  z-index: -1;\n  bottom: 0;\n  left: 0;\n  width: 100%;\n  height: 5px;\n  content: "";\n  border-radius: 0px 0px 8px 8px;\n  background-image: linear-gradient(90.5deg, #107c41 0%, #429537 100%);\n}\n\n.chat-fixed-input-text {\n  align-items: flex-start;\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-weight: 600;\n  font-size: 14px;\n  gap: 1px;\n  line-height: 20px;\n  color: #107c41;\n  white-space: pre-wrap;\n}\n\n.chat-fixed-input-text:focus {\n  outline: none;\n}\n\n.chat-input-ghost-text {\n  color: #bebebe;\n  align-items: flex-start;\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-size: 14px;\n  gap: 1px;\n  line-height: 20px;\n}\n\n.chat-input-buttons {\n  align-items: flex-start;\n  background: #ffffff;\n  flex-direction: row;\n  gap: 2px;\n  margin-bottom: 10px;\n  justify-content: space-between;\n}\n\n.chat-input-buttons-suggestion {\n  align-self: flex-start;\n  background-color: white;\n  border: #ffffff;\n  border-radius: 8px;\n  background-repeat: no-repeat;\n  background-position: center;\n  margin-left: 4px;\n  width: 32px;\n  height: 32px;\n}\n\n.chat-input-buttons-suggestion > .ms-Button-flexContainer {\n  align-items: center;\n}\n\n.chat-input-buttons-suggestion:hover {\n  background-color: #f2f2f2;\n}\n\n.chat-input-buttons-suggestion-clicked {\n  align-self: flex-start;\n  background-color: #edebe9;\n  border: #ffffff;\n  border-radius: 8px;\n  background-repeat: no-repeat;\n  background-position: center;\n  margin-left: 4px;\n  width: 32px;\n  height: 32px;\n}\n\n.chat-input-buttons-suggestion-clicked:hover {\n  background-color: #edebe9;\n}\n\n.chat-input-buttons-send {\n  align-self: flex-end;\n  background-image: url("./../../assets/send-button-icon.svg");\n  background-color: white;\n  border: #ffffff;\n  border-radius: 8px;\n  background-repeat: no-repeat;\n  background-position: center;\n  margin-right: 2px;\n  width: 32px;\n  height: 32px;\n}\n\n.chat-input-buttons-send:hover {\n  background-color: #f2f2f2;\n}\n\n.chat-taskPane-learn-more-button {\n  align-items: center;\n  justify-content: center;\n  width: 77px;\n  height: 24px;\n  background: transparent;\n  border: 1px solid #616161;\n  border-radius: 4px;\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-weight: 400;\n  font-size: 12px;\n  color: #616161;\n  line-height: 16px;\n  box-sizing: border-box;\n}\n\n.chat-taskPane-learn-more-button:hover {\n  cursor: pointer;\n}\n\n/*\n  * This class is used to set the max height of the input field in the chat UI.\n  * It ensures that the input field does not exceed the height of its container,\n  * allowing for a better user experience when typing long messages.\n*/\n.fai-EditorInput {\n  max-height: 100%;\n}\n'],sourceRoot:""}]);const C=g},592071:(e,t,n)=>{"use strict";n.d(t,{j:()=>r,z:()=>i});var a=n(208520);const o=(0,a.createContext)(void 0),r=()=>(0,a.useContext)(o),i=({children:e})=>{const[t]=(0,a.useState)(new Map),n=(0,a.useCallback)((e=>(t.has(e)||t.set(e,(0,a.createRef)()),t.get(e))),[t]),r=(0,a.useCallback)((e=>t.get(e)),[t]);return a.createElement(o.Provider,{value:{chartRefs:t,registerChartRef:n,getChartRef:r}},e)}},593316:(e,t,n)=>{"use strict";n.d(t,{e:()=>h});var a=n(796084),o=n(195800),r=n(139170),i=n(92520),l=n(279395),s=n(616166),c=n(468967),d=n(799765),u=n(592071),m=n(887648),g=n(208520);function h(e){const{dispatch:t}=(0,m.wA)();return g.createElement(p,{onError:e=>{e.name=e.message;const n=(0,c.Ix)(s.O.AnswersInteractiveChartRenderingFailed,"Unable to render interactive chart",e);(0,c.QX)(t,n,!1)},onRenderSuccess:()=>{const t=JSON.parse(e.inputChartSchema).data[0].type||"InteractiveChart";(0,d._T)(t)}},g.createElement(b,e))}class p extends g.Component{static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e){(0,i.cY)("ErrorBoundary caught an error ",e),this.props.onError&&this.props.onError(e)}componentDidMount(){!this.state.hasError&&this.props.onRenderSuccess&&this.props.onRenderSuccess()}render(){return this.state.hasError?this.props.fallback??g.createElement("p",null,(0,l.t9X)()):this.props.children}constructor(e){super(e),this.state={hasError:!1,error:void 0}}}function b(e){const{inputChartSchema:t,chartId:n}=e,i=(0,u.j)();let l;if(i){const{registerChartRef:e}=i;l=e(n)}return g.createElement(o.q,{theme:r.o,style:{backgroundColor:r.o.colorNeutralBackground1}},g.createElement(a.X,{chartSchema:{plotlySchema:JSON.parse(t)},componentRef:l}))}},614978:(e,t,n)=>{"use strict";function a(e){const t=e.length;return e.map(((n,a)=>e[t-a-1]))}function o(e){return e.sort(((e,t)=>e.value<t.value?-1:e.value>t.value?1:0))}function r(e,t,n){let a=e.data[t][0].map(((e,t)=>({index:t,value:e})));(e.exceptionalDatapoints||[]).forEach((e=>{a[e.index].exceptionalDatapoint=e})),(e.dataMarkers?.exceptionalDataMarkers||[]).forEach((e=>{a[e.index].exceptionalDataMarker=e})),a=n(a);const o=Object.keys(e.data).reduce(((t,n)=>{return{...t,[n]:(o=e.data[n],r=a,o.map((e=>e.map(((t,n)=>e[r[n].index])))))};var o,r}),{}),r=[];a.forEach(((e,t)=>{e.exceptionalDatapoint&&r.push({...e.exceptionalDatapoint,index:t})}));const i=[];a.forEach(((e,t)=>{e.exceptionalDataMarker&&i.push({...e.exceptionalDataMarker,index:t})}));const l={...e,data:o,exceptionalDatapoints:r};return i.length>0&&(l.dataMarkers={...l.dataMarkers,exceptionalDataMarkers:i}),l}function i(e,t){if(1!==t.dimensions.length||!e.binOptions)return[];const n=e.binOptions,a=t.dimensions[0].values.raw.filter((e=>"number"==typeof e&&Number.isFinite(e)));a.sort(((e,t)=>e-t));let o=a[0],r=a[a.length-1],i=n.binCount;n.underflow&&(o=n.underflow,i--),n.overflow&&(r=n.overflow,i--);let l=0;const s=[];if(n.underflow){let e=0;for(;l<a.length&&a[l]<=o+Number.EPSILON;)e++,l++;s.push(e)}for(let e=1;e<=i;e++){const t=Math.min(o+e*n.binWidth,r);let i=0;for(;l<a.length&&a[l]<=t+Number.EPSILON;)i++,l++;s.push(i)}return n.overflow&&s.push(a.length-l),s}function l(e){const t=e.data.values[0];let n=!1;for(let e=0;e<t.length;e++)"NaN"!==t[e]?(!n&&(e+1>=t.length||"NaN"===t[e+1])&&(t[e]="NaN"),n=!0):n=!1;const a={...e};return a.data.values[0]=t,a}n.d(t,{Hw:()=>a,Lt:()=>r,Mi:()=>i,V0:()=>o,jx:()=>l})},615397:(e,t,n)=>{"use strict";n.d(t,{Dd:()=>u,UP:()=>i,VD:()=>p,WD:()=>g,iG:()=>b,ip:()=>f,j4:()=>s,m2:()=>c,sF:()=>h,tF:()=>d,tJ:()=>a,vb:()=>o});var a,o,r,i,l=n(616166);class s extends Error{constructor(e,t){super(e),this.isOnlyUnsupportedEventsError=!0,this.unsupportedTypes=t}}class c extends Error{constructor(e){super(e),this.isMultipeEventsExecutionError=!0}}!function(e){e.General="General",e.ColumnRowOutOfBoundary="ColumnRowOutOfBoundary",e.ColumnRowBySelection="ColumnRowBySelection",e.ConditionalFormatFormulaInvalid="conditionalFormatFormulaInvalid",e.ConditionalFormatFormulaExplanationInvalid="conditionalFormatFormulaExplanationInvalid",e.ClearSortUnsupported="ClearSortUnsupported",e.NoColumnArgument="NoColumnArgument",e.ColorDistanceExceededThreshold="ColorDistanceExceededThreshold",e.DeleteUnexpectedTableRows="DeleteUnexpectedTableRows",e.DeleteWithInsertColumns="DeleteWithInsertColumns",e.MultipleTableStructureChanges="MultipleTableStructureChanges",e.NoActiveTable="NoActiveTable",e.NoSupportedNumberFormatCategoriesNumber="NoSupportedNumberFormatCategoriesNumber",e.NoSupportedNumberFormatCategoriesDate="NoSupportedNumberFormatCategoriesDate",e.NoSupportedNumberFormatCategoriesText="NoSupportedNumberFormatCategoriesText",e.NoSupportedNumberFormatCategoriesOther="NoSupportedNumberFormatCategoriesOther",e.NoVisibleRange="NoVisibleRange",e.NumericFilterOnNonNumberError="NumericFilterOnNonNumberError",e.TextualFilterOnNonTextError="TextualFilterOnNonTextError",e.VariableCacheEntityTypeMismatched="VariableCacheEntityTypeMismatched"}(a||(a={}));class d extends Error{constructor(e,t,n,a){super(e),this.isConverterError=!0,this.property=t,this.failureType=n??"General",this.dataFields=a}}!function(e){e.ArgumentUndefined="ArgumentUndefined",e.ArgumentTypeUndefined="ArgumentTypeUndefined",e.ArgumentValueUndefined="ArgumentValueUndefined",e.ArgumentTypeMismatch="ArgumentTypeMismatch"}(o||(o={}));class u extends Error{constructor(e,t,n,a){super(e),this.isStatementArgumentError=!0,this.reason=t,this.argumentType=n,this.expectedType=a}}!function(e){e.EmptyEntityArray="EmptyEntityArray",e.UnsupportedArguments="UnsupportedArguments",e.NoMatchedArguments="NoMatchedArguments",e.Unknown="Unknown"}(r||(r={}));class m extends Error{constructor(e,t,n,a){super(`No event generate for statement: ${e}.`),this.isNoEventGeneratedError=!0,this.statementName=e,this.argumentNames=Object.keys(t),this.reason=n,this.unsupportedArgumentTypes=a}}class g extends Error{constructor(e){super(e),this.isExecutorError=!0}}!function(e){e.General="General",e.MissingIntent="MissingIntent",e.NoActiveTable="NoActiveTable"}(i||(i={}));class h extends Error{constructor(e,t){super(e),this.isHumanInTheLoopError=!0,this.failureType=t??"General"}}function p(e,t,n,a=!1){throw 0===t?new m(e.name,e.arguments,"EmptyEntityArray"):n.length>0?new m(e.name,e.arguments,"UnsupportedArguments",n):new m(e.name,e.arguments,a?"NoMatchedArguments":"Unknown")}function b(e){return e.isStatementArgumentError||e.isOnlyUnsupportedEventsError||e.isConverterError||e.isStatementArgumentError||e.isNoEventGeneratedError||e.isExecutorError||e.isHumanInTheLoopError}function f(e){return e instanceof l.u&&e.errorCode===l.O.PayloadSizeError}},615956:(e,t,n)=>{"use strict";n.d(t,{n:()=>o,r:()=>y});var a,o,r=n(693257),i=n(543435),l=n(531093),s=n(561187),c=n(279395),d=n(857786),u=n(469486),m=n(109174),g=n(468967),h=n(347145),p=n(799765),b=n(233356),f=n(795786),C=n(312422);!function(e){e.Label="Label",e.Content="Content"}(a||(a={})),function(e){e.PythonDataFrameInserter="PythonDataFrameInserter",e.PythonCodeAndPreviewInserter="PythonCodeAndPreviewInserter",e.PythonCalculatedColumnInserter="PythonCalculatedColumnInserter",e.PythonDetailSheetInserter="PythonDetailSheetInserter"}(o||(o={}));class y{conditionallySelect(e){((0,h.vEQ)()||(0,h.o2C)())&&m.CP.pythonContextManager.disableAutoScroll||e.select()}addCodeAndOutputToBuilder(e){e.codeExplanation=this.codeExplanation,e.codeLabel=this.codeLabel,m.CP.pythonContextManager.pythonContextBuilder.setCodeAndOutput(e)}getDiagnosticEntryForCell(e,t,n){try{const a=(0,r.q)(e,t,n);return m.CP.pythonContextManager.diagnosticsEntriesMap.get(a)}catch(e){(0,g.QX)(null,(0,g.pJ)(e),!1)}}async onCalculatedHandler(e,t){m.CP.pythonContextManager.shouldGenerate?await Excel.run((async a=>{try{const o=Promise.all([n.e("chunk1jsfluent"),n.e("vendors-npm_store_sdx_officecopilot_1js-excel-copilot-calc_8_3_43-1adabd76bb06679768ec_node_m-dd2f81"),n.e("calc")]).then(n.bind(n,478565)),r=a.workbook.worksheets.getItem(e.worksheetId).load("id"),i=e.address.split(",");for(const e of i){const n=r.getRange(e).load(["formulasLocal","valuesAsJson"]);await a.sync();const i=(0,u.o7)(t);for(let t=0;t<n.formulasLocal.length&&!this.onCalculatedFinished;t++)for(let l=0;l<n.formulasLocal[t].length&&!this.onCalculatedFinished;l++)await this.onAddressCalculateHandler(a,o,r,n,e,i,n.formulasLocal[t][l],t,l)}}catch(e){this.onCalculatedFinished||((0,d.i5)(!1),(0,d.$k)(this.dispatch)),f.n.updatePythonCodeAndPostViewCardWithError(this.dispatch),(0,g.Kx)(this.dispatch,e,"onCalculatedHandler",!0)}})):this.onCalculatedHandlerShouldNotGenerate()}onCalculatedHandlerShouldNotGenerate(){f.n.updatePythonCodeAndPostViewCardWithError(this.dispatch)}async onAddressCalculateHandler(e,t,n,a,o,r,s,c,g){const p=(0,u.o7)(s),b=await this.mutex.waitFor();if(this.onCalculatedFinished)b.release();else if(r===p){(0,d.i5)(!0),(0,d.$k)(this.dispatch),this.onCalculatedFinished=!0,b.release(),this.onCalculatedResult?.remove(),await(this.onCalculatedResult?.context.sync()),this.onCalculatedResult=null;const r=l.ExcelCalc.addressToExcelRange(o).topLeft;r.column=(r.column??0)+g,r.row=(r.row??0)+c;const s={topLeft:r,bottomRight:r},p=l.ExcelCalc.IExcelRangeToAddress(s),C=await m.CP.pythonContextManager.getPythonCellContextWithTimeout(n.id,p);if(!this.skipInsertPostView){const a=C.output,o=a?.errorType;if("Error"!==C.outputType&&"Python"!==o){let a;C.outputType===i.qf.None&&(a=this.getDiagnosticEntryForCell(r.row,r.column,n.id)),await(0,d.ek)((async()=>{await f.n.updatePythonCodeAndPostViewCardWithPostView(this.dispatch,p,t,n,e,a,(0,h.EJJ)()?C:void 0)}),d.xk.InsertPostView)}else f.n.updatePythonCodeAndPostViewCardWithError(this.dispatch)}this.skipInsertPreView||(0,u.LX)(C)&&await(0,d.ek)((async()=>{await this.insertPreViewInGrid(n,p,C,e)}),d.xk.InsertPreview,!0),await this.handlePythonCellExecutionResult(C,a,p),(0,h.EeR)()&&await(0,u.ZD)(n,e,C)}else b.release()}async insertImageForPreview(e,t,n,a,o){const r=t.shapes.addLocalImageReference(a);return r.incrementTop(n.height),r.lineFormat.color="#000000",(0,u.U6)()&&(r.name=`image-${n.address}`),r.altTextTitle=this.codeLabel??(0,c.XZh)(),o&&(r.load("height"),await e.sync(),r.lockAspectRatio=!0,r.scaleHeight(n.height*this.imageHeightInCells/r.height,Excel.ShapeScaleType.currentSize,Excel.ShapeScaleFrom.scaleFromTopLeft)),await e.sync(),(0,h.o2C)()&&(0,u.lE)("ShowPythonAdvancedAnalysisFreA2"),r}async insertPreViewInGrid(e,t,n,a){try{if("Error"===n.outputType||(0,u.Hq)(n.outputType)){if((0,u.Hq)(n.outputType)&&(!(0,u.U6)()||n.outputType!==i.qf.PythonPlot)){const n=e.getRange(t).load("width, height, address");n.track(),await a.sync(),await(0,C.F5)((async o=>{await this.insertImageForPreview(a,e,n,t,!0)}));const o=e.getRange(t).getOffsetRange(this.imageHeightInCells,0);this.conditionallySelect(o),await a.sync(),this.conditionallySelect(n),n.untrack(),await a.sync()}}else{const e=await(0,u.WH)(a,this.sheetId);await(0,d.ek)((async()=>{await this.insertLabelAndContentForPreviewOrFormula(a,e,(0,c.ZOw)(),`=IFERROR(${t}.arrayPreview,${t}.Python_str)`,!1,!1)}),d.xk.InsertContentToGrid)}}catch(e){const t=`class: AbstractPythonInserter, method: "insertPreViewInGrid, outputType: ${n.outputType}`,a=(0,g.MF)(e,"AbstractPythonInserter","insertPreViewInGrid","PythonDataFrameInserter"===this.inserterType,t);throw(0,g.Kx)(this.dispatch,a,"insertPreViewInGrid",!0),e}}getOffsetRange(e,t,n,a,o){try{const a=t.rowIndex+(t.rowCount-1);return e.getRangeByIndexes(a+n,t.columnIndex,1,1)}catch(e){const t=`isPythonFormula: ${o} offset: ${n} rangeType: ${a}`;throw(0,g.MF)(e,"AbstractPythonInserter","getOffsetRange","PythonDataFrameInserter"===this.inserterType,t)}}async getUsedRange(e,t){const n=t.protection.load("protected"),a=t.getUsedRangeOrNullObject();if(await e.sync(),!a.isNullObject){if(a.load(["rowIndex","rowCount","columnIndex","address"]),a.track(),await e.sync(),n.protected)throw(0,g.Eu)();return a}}async logHiddenRowsAndColumns(e,t,n){t.load("rowHidden, columnHidden"),n.load("rowHidden, columnHidden"),await e.sync(),(t.rowHidden||t.columnHidden||n.rowHidden||n.columnHidden)&&(0,p.XB)(t.rowHidden,t.columnHidden,n.rowHidden,n.columnHidden)}async checkIsPythonErrorCell(e,t,n){const[a,o]=(0,u.Jy)(n);o&&(n=o);const r=t.getRange(n);r.load(["valuesAsJson","formulas"]),await e.sync();const l=r.formulas[0][0],s=u.sy.test(l),c=r.valuesAsJson[0][0],d=String(c.type??"");return s&&d===i.qf.Error}async checkIsPythonCellImageType(e,t,n){const[a,o]=(0,u.Jy)(n);o&&(n=o);const r=t.getRange(n);r.load(["valuesAsJson","formulas"]),await e.sync();const i=r.formulas[0][0],l=u.sy.test(i),s=r.valuesAsJson[0][0],c=String(s.Python_type??"");return l&&(0,u.Hq)(c)}getRanges(e,t,n,a=0){if(void 0===t){return{labelRange:e.getRange("A1"),contentRange:e.getRange("A3")}}{let o,r;n?(o=this.codeLabelOffset,r=this.codeContentOffset):n?(o=this.labelOffset,r=this.contentOffset):(o=this.previewLabelOffset,r=this.previewContentOffset);return{labelRange:this.getOffsetRange(e,t,o+a,"Label"),contentRange:this.getOffsetRange(e,t,r+a,"Content")}}}async updateExcelRangesIfPythonError(e,t,n,a,o){let r=a,i=o,s=!1;const c=m.CP.pythonContextManager.getLastPythonCell(!0);if(c){const a=c.sheetAddress,o=c.sheetId===this.sheetId;if(e&&o&&await this.checkIsPythonErrorCell(t,n,a??"")){const e=l.ExcelCalc.sheetAddressToICellRange(a??""),t=e.FirstRow,o=e.FirstColumn;r=n.getRangeByIndexes(t-1,o,1,1),i=n.getRangeByIndexes(t,o,1,1),c.wasDeleted=!0,s=!0}}return{labelAndContentRangesUpdated:s,labelRange:r,contentRange:i}}async setLabelAndContent(e,t,n,a,o,r,i,l){try{let s,c,d=!1;const g=this.getRanges(t,n,r);if(s=g.labelRange,c=g.contentRange,({labelAndContentRangesUpdated:d,labelRange:s,contentRange:c}=await this.updateExcelRangesIfPythonError(r,e,t,s,c)),!d&&r){let a=m.CP.pythonContextManager.getLastPythonCell(!1);!a&&(0,h.EeR)()&&(a=await(0,u.dd)(t,e));const o=!a||a.sheetId===this.sheetId;if(a&&o){if(await this.checkIsPythonCellImageType(e,t,a.sheetAddress??"")){const{labelRange:e,contentRange:a}=this.getRanges(t,n,r,this.imageHeightInCells);s=e,c=a,d=!0}}}if(s.track(),c.track(),await e.sync(),s.values=[[a]],l)s.format.font.size=l;else{const e=r?14:12;s.format.font.size=e,r&&(s.format.font.color=b.e)}if(s.format.font.bold=!0,i?c.formulasLocal=[[o]]:c.values=[[o]],await e.sync(),(0,h.o2C)()&&!r){const e="PythonDataFrameInserter"===this.inserterType,t="PythonCodeAndPreviewInserter"===this.inserterType;let n="";e?n="ShowPythonAdvancedAnalysisFre":t&&(n="ShowPythonAdvancedAnalysisFreA2Plot"),""!==n&&(0,u.lE)(n)}else(0,h.vEQ)()&&r&&await(0,u.jC)(c,"ShowPythonAdvancedAnalysisWave1");return await this.logHiddenRowsAndColumns(e,s,c),{contentRange:c,labelRange:s}}catch(e){throw(0,g.MF)(e,"AbstractPythonInserter","setLabelAndContent","PythonDataFrameInserter"===this.inserterType,void 0,{lastInsertedFormula:o})}}async insertLabelAndContentForPreviewOrFormula(e,t,n,a,o,r,i){const l=await this.getUsedRange(e,t);o&&(this.onCalculatedResult=t.onCalculated.add((async e=>this.onCalculatedHandler(e,a))),(0,p.BA)(this.requestId));const{contentRange:s,labelRange:c}=await this.setLabelAndContent(e,t,l,n,a,o,r,i);s.load("address"),await e.sync();await(0,u.eU)()===Excel.CalculationMode.manual&&(await Excel.run((async e=>{e.application.calculate(Excel.CalculationType.full)})),(0,p.$J)(o)),o&&(this.conditionallySelect(s),m.CP.isPythonCellSelected=!0,m.CP.selectedPythonSheetId=this.sheetId,m.CP.selectedPythonAddress=s.address),await e.sync();const d=s.address;void 0!==l&&l.untrack(),s.untrack(),c.untrack(),await e.sync();const g=await this.getUsedRange(e,t);if(void 0!==g){if(!o){const t=g.getLastRow().getOffsetRange(1,0).getCell(0,0);try{const n=e.workbook.getSelectedRange();this.conditionallySelect(t),await e.sync(),this.conditionallySelect(n),await e.sync()}catch(e){this.conditionallySelect(t)}await e.sync()}await(0,u.t2)(e,g,this.dispatch)}return d}constructor(e,t,n,a,o,r=!1,i=!1){this.labelOffset=2,this.contentOffset=3,this.codeLabelOffset=3,this.codeContentOffset=4,this.previewLabelOffset=2,this.previewContentOffset=3,this.imageHeightInCells=16,this.mutex=new s.e,this.onCalculatedFinished=!1,this.onCalculatedResult=null,this.dispatch=e,this.sheetId=t,this.codeExplanation=a,this.codeLabel=o,this.skipInsertPreView=r,this.skipInsertPostView=i,this.inserterType=n}}},616166:(e,t,n)=>{"use strict";n.d(t,{O:()=>o,u:()=>a});class a extends Error{getErrorLocation(){return this.error instanceof OfficeExtension.Error?this.error.debugInfo.errorLocation:null}constructor(e,t){super(e),this.errorCode=e,t instanceof a&&(t.error instanceof Error||t.error instanceof OfficeExtension.Error)?this.error=t.error:(t instanceof Error||t instanceof OfficeExtension.Error)&&(this.error=t),Object.setPrototypeOf(this,a.prototype)}}var o;!function(e){e.SelectionFailed="SelectionFailed",e.LargeData="LargeData",e.UnboundedRange="UnboundedRange",e.LargePivotTableSource="LargePivotTableSource",e.NotAlignedRanges="NotAlignedRanges",e.SeparateRowsSelected="SeparateRowsSelected",e.SeparateColumnsSelectedOnRowMajorTable="SeparateColumnsSelectedOnRowMajorTable",e.SelectionsFromDifferentRanges="SelectionsFromDifferentRanges",e.NetworkError="NetworkError",e.NetworkTimeout="NetworkTimeout",e.BadRequest="BadRequest",e.InternalServerError="InternalServerError",e.NetworkThrottleError="NetworkThrottleError",e.NoRecommendations="NoRecommendations",e.RecommendationsFailed="RecommendationsFailed",e.InsertionFailed="InsertionFailed",e.InsertionFailedCellEditMode="InsertionFailedCellEditMode",e.PivotTableSelection="PivotTableSelection",e.SignInFailed="SignInFailed",e.TrySampleDataError="TrySampleDataError",e.PreferencesFailed="PreferencesFailed",e.NoRecommendationsWithPreferences="NoRecommendationsWithPreferences",e.NaturalLanguageFailed="NaturalLanguageFailed",e.NaturalLanguageVisualInsertionFailed="NaturalLanguageVisualInsertionFailed",e.NaturalLanguageVisualInsertionFailedCellEditMode="NaturalLanguageVisualInsertionFailedCellEditMode",e.NaturalLanguageFailedNoSuggestions="NaturalLanguageFailedNoSuggestions",e.NaturalLanguageFailedConversation="NaturalLanguageFailedConversation",e.Unauthorized="Unauthorized",e.Forbidden="Forbidden",e.NotAcceptable="NotAcceptable",e.NotFound="NotFound",e.Gone="Gone",e.MultiSelectionError="MultiSelectionError",e.CellEditModeError="CellEditModeError",e.InvalidSelection="InvalidSelection",e.RecommendedPivotTablesNoRecommendations="RecommendedPivotTablesNoRecommendations",e.RecommendedPivotTablesFailed="RecommendedPivotTablesFailed",e.RecommendedPivotTablesPivotTableSelection="RecommendedPivotTablesPivotTableSelection",e.RecommendedPivotTablesInsertionFailed="RecommendedPivotTablesInsertionFailed",e.RecommendedPivotTablesInsertionFailedCellEditMode="RecommendedPivotTablesInsertionFailedCellEditMode",e.RecommendedPivotTablesBlankInsertionFailedInvalidDataSource="RecommendedPivotTablesBlankInsertionFailedInvalidDataSource",e.FetchNaturalLanguageContextFailed="FetchNaturalLanguageContextFailed",e.NaturalLanguageUnsupportedLanguageError="NaturalLanguageUnsupportedLanguageError",e.NaturalLanguageFailedForShortQuery="NaturalLanguageFailedForShortQuery",e.InactiveWorkbook="InactiveWorkbook",e.LocaleFetchFailed="LocaleFetchFailed",e.NaturalLanguageFailedForPotentialBiasQuery="NaturalLanguageFailedForPotentialBiasQuery",e.RecommendedPivotTablesNoRecosForSingleLineData="RecommendedPivotTablesNoRecosForSingleLineData",e.RecommendedChartsPivotTableSourceNoDataField="RecommendedChartsPivotTableSourceNoDataField",e.RecommendedChartsPivotTableSourceNoRowField="RecommendedChartsPivotTableSourceNoRowField",e.InsertionFailedPivotCacheProtected="InsertionFailedPivotCacheProtected",e.InsertionFailedDestinationProtected="InsertionFailedDestinationProtected",e.InsertionFailedCurrentWorksheetProtected="InsertionFailedCurrentWorksheetProtected",e.OCVFeedbackError="OCVFeedbackError",e.InsertCalculatedColumnFailed="InsertCalculatedColumnFailed",e.InsertFormulaSuggestionFailed="InsertFormulaSuggestionFailed",e.InsertCalculatedColumnWithTargetRangeFailed="InsertCalculatedColumnWithTargetRangeFailed",e.InsertCalculatedColumnFailedWithInvalidArgTableRangeChanged="InsertCalculatedColumnFailedWithInvalidArgTableRangeChanged",e.InsertCommentFailed="InsertCommentFailed",e.AnalyzeTyping="AnalyzeTyping",e.DeactivateRangePickerFailed="DeactivateRangePickerFailed",e.FetchUnsetFlight="FetchUnsetFlight",e.FlightingFailure="FlightingFailure",e.FormulaErrorContentTooLarge="FormulaErrorContentTooLarge",e.FormulaErrorExceedLengthLimitation="FormulaErrorExceedLengthLimitation",e.FormulaErrorProactiveLimitation="FormulaErrorProactiveLimitation",e.FormulaErrorTranslationFailure="FormulaErrorTranslationFailure",e.FormulaErrorUnknown="FormulaErrorUnknown",e.FormulaErrorValidationIssue="FormulaErrorValidationIssue",e.FormulaGenerationSkillError="FormulaGenerationSkillError",e.GenerateSuggestedQueries="GenerateSuggestedQueries",e.InitializeAppFailure="InitializeAppFailure",e.InitializeOfficeFailure="InitializeOfficeFailure",e.InitializeSharedRuntimeFailure="InitializeSharedRuntimeFailure",e.InsertionCleanupFailed="InsertionCleanupFailed",e.IvyWebFailure="IvyWebFailure",e.LoadStringsFailure="LoadStringsFailure",e.NativeSelectionFailed="NativeSelectionFailed",e.NaturalLanguageContextFailed="NaturalLanguageContextFailed",e.ReducerException="ReducerException",e.RenderRecommendationFailed="RenderRecommendationFailed",e.FailedToParseClientVersion="FailedToParseClientVersion",e.FailedToParseSelectionContext="FailedToParseSelectionContext",e.FailedToSelectSelectionContext="FailedToSelectSelectionContext",e.SeeAllChartsFailed="SeeAllChartsFailed",e.DataRefreshFailed="DataRefreshFailed",e.XlimResolveError="XlimResolveError",e.SubstrateSignalError="SubstrateSignalError",e.FailedToParseCalculatedColumnSuggestion="FailedToParseCalculatedColumnSuggestion",e.ShowPreviewColumnFailed="ShowPreviewColumnFailed",e.HidePreviewColumnFailed="HidePreviewColumnFailed",e.DefaultInsertCalculatedColumnFailed="DefaultInsertCalculatedColumnFailed",e.PreviewValidationFailed="PreviewValidationFailed",e.UpdateAppStyleFailed="UpdateAppStyleFailed",e.NavigateToDataAIError="NavigateToDataAIError",e.ExcelIntelligenceSignalFailed="ExcelIntelligenceSignalFailed",e.ExcelIntelligenceSignalFailedWithSuggestions="ExcelIntelligenceSignalFailedWithSuggestions",e.GetInsightsFailed="GetInsightsFailed",e.GetInterpretationsFailed="GetInterpretationsFailed",e.GetNLContextFailed="GetNLContextFailed",e.InsertRecommendationsDashboard="InsertRecommendationsDashboard",e.CheckForTablesError="CheckForTablesError",e.CalculatedColumnsInsertColumnFailedGetRange="CalculatedColumnsInsertColumnFailedGetRange",e.CalculatedColumnsInsertColumnFailedResolveTableLikeEntity="CalculatedColumnsInsertColumnFailedResolveTableLikeEntity",e.DeleteLastColumnFailed="DeleteLastColumnFailed",e.CalculatedColumnExpandFailedNotEmptyColumn="CalculatedColumnExpandFailedNotEmptyColumn",e.CalculatedColumnExpandFailed="CalculatedColumnExpandFailed",e.CalculatedColumnPartialInsertFailed="CalculatedColumnPartialInsertFailed",e.FetchAndSetActiveTableFailed="FetchAndSetActiveTableFailed",e.GetTableContextFailed="GetTableContextFailed",e.GetTabularRangeContextFailed="GetTabularRangeContextFailed",e.ColumnRecommendationsNotAvailable="ColumnRecommendationsNotAvailable",e.DataLocaleUndefined="DataLocaleUndefined",e.AnalyzeDataTimeout="AnalyzeDataTimeout",e.CalculatedColumnPreviewNotUpdated="CalculatedColumnPreviewNotUpdated",e.CalculatedColumnPreviewNoColumnLetters="CalculatedColumnPreviewNoColumnLetters",e.CalculatedColumnFormulaLocalizationFailed="CalculatedColumnFormulaLocalizationFailed",e.CalculatedColumnConvertAnnotationToRecommendationFailed="CalculatedColumnConvertAnnotationToRecommendationFailed",e.CalculatedColumnFailedToSendSignal="CalculatedColumnFailedToSendSignal",e.CalculatedColumnInsertColumnFailedVerifyPreview="CalculatedColumnInsertColumnFailedVerifyPreview",e.CalculatedColumnInsertColumnError="CalculatedColumnInsertColumnError",e.CalculatedColumnVisibleRowsOutOfRange="CalculatedColumnVisibleRowsOutOfRange",e.CalculatedColumnPreviewColumnOffsetOutOfTable="CalculatedColumnPreviewColumnOffsetOutOfTable",e.CalculatedColumnPreviewColumnInTheMiddleExpected="CalculatedColumnPreviewColumnInTheMiddleExpected",e.CopyButtonError="CopyButtonError",e.PostRangesError="PostRangesError",e.InitializeRangesFailure="InitializeRangesFailure",e.StoreDataFailure="StoreDataFailure",e.PrePythonModeError="PrePythonModeError",e.PythonStaleRuntimeError="PythonStaleRuntimeError",e.PythonBusyStateError="PythonBusyStateError",e.PythonCodeAndPostViewPropsNotSerializable="PythonCodeAndPostViewPropsNotSerializable",e.PythonGeneralError="PythonGeneralError",e.PythonAccessError="PythonAccessError",e.PythonCalcError="PythonCalcError",e.PythonGeneralContextError="PythonGeneralContextError",e.PythonInsertFailed="PythonInsertFailed",e.PythonProtectedSheetError="PythonProtectedSheetError",e.PythonCopyFailed="PythonCopyFailed",e.PythonNoActiveLicense="PythonNoActiveLicense",e.PythonUnsupportedLanguage="PythonUnsupportedLanguage",e.PythonUnsupportedPlatform="PythonUnsupportedPlatform",e.PythonUnsupportedResponseType="PythonUnsupportedResponseType",e.PythonDeletedSheetBeforeResponseGeneration="PythonDeletedSheetBeforeResponseGeneration",e.PythonDeletedSheetDuringResponseGeneration="PythonDeletedSheetDuringResponseGeneration",e.PythonUnexpectedMissingSheetInContextExtraction="PythonUnexpectedMissingSheetInContextExtraction",e.PythonMissingResponseValue="PythonMissingResponseValue",e.PythonInvalidResponseOrder="PythonInvalidResponseOrder",e.PythonResponseAllDebugChunks="PythonResponseAllDebugChunks",e.PythonCodeRetryMaximumHit="PythonCodeRetryMaximumHit",e.PythonAugLoopCallsPerQueryMaximumHit="PythonAugLoopCallsPerQueryMaximumHit",e.PythonStartAnalysisEditModeError="PythonStartAnalysisEditModeError",e.PythonGenericEditModeError="PythonGenericEditModeError",e.PythonInvalidSelectedContext="PythonInvaldSelectedContext",e.PythonUnknownError="PythonUnknownError",e.PythonPostViewError="PythonPostViewError",e.PythonDataFrameInsertFailed="PythonDataFrameInsertFailed",e.PythonContextUndefinedParameter="PythonContextUndefinedParameter",e.PythonObjectReferenceError="PythonObjectReferenceError",e.PythonExitAnalysisError="PythonExitAnalysisError",e.PythonAddResultsToNewSheetError="PythonAddResultToNewSheetError",e.PythonTuiNotShownError="PythonTuiNotShownError",e.PythonGetDiagnosticsError="PythonGetDiagnosticsError",e.PythonPayloadEmptyError="PayloadEmptyError",e.PythonDisplayResponseError="PythonDisplayResponseError",e.AnswersPostViewError="AnswersPostViewError",e.AnswersInvalidImageResponse="AnswersInvalidImageResponse",e.AnswersMissingChunkProperty="AnswersMissingChunkProperty",e.AnswersParsingMetadataFailed="AnswersParsingMetadataFailed",e.PayloadSizeError="PayloadSizeError",e.PythonPrintFormattedNumberError="PythonPrintFormattedNumberError",e.PythonMultipleOpenWorkbooks="PythonMultipleOpenWorkbooks",e.PythonExecutionBlockedByAdmin="PythonExecutionBlockedByAdmin",e.CalculatedCellExpandFailedNotEmptyCell="CalculatedCellExpandFailedNotEmptyCell",e.CalculatedCellExpandFailed="CalculatedCellExpandFailed",e.GetChartRecoFailed="GetChartRecoFailed",e.GetPivotTableRecoFailed="GetPivotTableRecoFailed",e.MissingOperationLocation="MissingOperationLocation",e.FeedbackApiError="FeedbackApiError",e.CalculatedColumnsInvalidFormula="CalculatedColumnsInvalidFormula",e.ShowSuggestionsTimeout="ShowSuggestionsTimeout",e.PythonAutofitFailed="PythonAutofitFailed",e.DefaultInsertCalculatedCellFailed="DefaultInsertCalculatedCellFailed",e.DefaultInsertCalculatedCellTitleFailed="DefaultInsertCalculatedCellTitleFailed",e.InsertCalculatedCellToSelectionFailed="InsertCalculatedCellToSelectionFailed",e.InsertCalculatedCellToFixedRangeFailed="InsertCalculatedCellToFixedRangeFailed",e.CalculatedCellPartialInsertFailed="CalculatedCellPartialInsertFailed",e.CalculatedCellUndefinedColumnHeader="CalculatedCellUndefinedColumnHeader",e.BlobRangeRevisionError="BlobRangeRevisionError",e.TLRRevisionError="TLRRevisionError",e.CalculatedCellsGetIsTotalRowCellsEmptyFailed="CalculatedCellsGetIsTotalRowCellsEmptyFailed",e.EvaluateQueryFailed="EvaluateQueryFailed",e.FetchAndSetTabularRangeAsActiveTableFailed="FetchAndSetTabularRangeAsActiveTableFailed",e.FetchAndSetUnrecognizedRangeFailed="FetchAndSetUnrecognizedRangeFailed",e.ResolveTableLikeEntityFailed="ResolveTableLikeEntityFailed",e.UpdateSelectionFailed="UpdateSelectionFailed",e.UpdateSelectionFailedWillRetry="UpdateSelectionFailedWillRetry",e.FetchPivotTableFailed="FetchPivotTableFailed",e.SetActiveChartFailed="SetActiveChartFailed",e.FetchActivePivotTableFailed="fetchActivePivotTableFailed",e.FetchPivotTableFailedToLoadRange="FetchPivotTableFailedToLoadRange",e.SelectionIntegrityCheckFailed="SelectionIntegrityCheckFailed",e.SelectionIntegrityCheckEncounteredNonWorksheet="SelectionIntegrityCheckEncounteredNonWorksheet",e.SelectionIntegrityCheckEncounteredNoGridSelection="SelectionIntegrityCheckEncounteredNoGridSelection",e.SelectionIntegrityCheckFoundTableMismatch="SelectionIntegrityCheckFoundTableMismatch",e.SelectionIntegrityCheckFoundNoTableButOneShouldBePresent="SelectionIntegrityCheckFoundNoTableButOneShouldBePresent",e.SelectionIntegrityCheckFlushingSelectionFailed="SelectionIntegrityCheckFlushingSelectionFailed",e.ContextManagerInitializationFailed="ContextManagerInitializationFailed",e.FetchAndSetActiveTableLikeEntityFailed="FetchAndSetActiveTableLikeEntityFailed",e.AuthError="AuthError",e.LoadAuthError="LoadAuthError",e.SetFormulaPreviewFailed="SetFormulaPreviewFailed",e.TLRFixDuplicatesFailed="TLRFixDuplicatesFailed",e.TLRFixMergedCellsFailed="TLRFixMergedCellsFailed",e.TLRRetrieveMergeCellsFailed="TLRRetrieveMergeCellsFailed",e.TLRFixEmptyHeadersFailed="TLRFixEmptyHeadersFailed",e.TLRValidateEmptyHeadersFailed="TLRValidateEmptyHeadersFailed",e.TLRRetrieveEmptyHeaderCellsFailed="TLRRetrieveEmptyHeaderCellsFailed",e.TLRRetrieveDuplicateHeaderCellsFailed="TLRRetrieveDuplicateHeaderCellsFailed",e.AutoFixTLRFailed="AutoFixTLRFailed",e.SetContextWithAddressValidationFailed="SetContextWithAddressValidationFailed",e.FormulaGenerationCreateFetchOperationFailed="FormulaGenerationCreateFetchOperationFailed",e.FormulaGenerationGetSelectionContextsFailed="FormulaGenerationGetSelectionContextsFailed",e.SubmitExcelIntelligenceOperationFailedOnGetActiveCell="SubmitExcelIntelligenceOperationFailedOnGetActiveCell",e.SubmitExcelIntelligenceOperationFailedOnGetActiveSheetName="SubmitExcelIntelligenceOperationFailedOnGetActiveSheetName",e.CheckIntersectingRemoteChangesFailed="CheckIntersectingRemoteChangesFailed",e.TLRNotFound="TLRNotFound",e.RefreshActiveTableFailed="RefreshActiveTableFailed",e.FeedbackGetUserAccessTokenError="FeedbackGetUserAccessTokenError",e.GetPythonCellContextTimeout="GetPythonCellContextTimeout",e.GetPythonCellContextTimeoutRecoverable="GetPythonCellContextTimeoutRecoverable",e.ExecutePythonCodeApiCallTimeout="ExecutePythonCodeApiCallTimeout",e.ConnectOfficePyServiceExecuteCodeException="ConnectOfficePyServiceExecuteCodeException",e.ConnectOfficePyServiceExecuteCodeTimeout="ConnectOfficePyServiceExecuteCodeTimeout",e.ConnectToOfficePySvcToExecutePythonCodeUnexpectedError="ConnectToOfficePySvcToExecutePythonCodeUnexpectedError",e.GetOfficePyServiceAccessTokenFailed="GetOfficePyServiceAccessTokenFailed",e.GetOfficePyServiceRuntimeUrlFailed="GetOfficePyServiceRuntimeUrlFailed",e.GetPythonContextObjectFailed="GetPythonContextObjectFailed",e.GetAllPythonCellsUpToAnalysisSheetTimeout="GetAllPythonCellsUpToAnalysisSheetTimeout",e.GetAllPythonCellsOfAASessionAnalysisSheetTimeout="GetAllPythonCellsOfAASessionAnalysisSheetTimeout",e.PythonContextExtractionAborted="PythonContextExtractionAborted",e.ImportDataTablePreviewNotUpdated="ImportDataTablePreviewNotUpdated",e.PythonImageUnavailableAnalysisSheetDeletedError="PythonImageUnavailableAnalysisSheetDeletedError",e.PythonAnalysisSheetMetadataError="PythonAnalysisSheetMetadataError",e.AnswersInsertImageError="AnswersInsertImageError",e.AnswersInsertTableError="AnswersInsertTableError",e.AnswersCollapsableCodeOnClickError="AnswersCollapsableCodeOnClickError",e.AnswersComponentPropsNotSerializable="AnswersComponentPropsNotSerializable",e.AnswersInvalidChartImageResponse="AnswersInvalidChartImageResponse",e.AnswersInteractiveChartRenderingFailed="AnswersInteractiveChartRenderingFailed",e.AnswersInteractiveChartRefFailed="AnswersInteractiveChartRefFailed",e.AnswersInteractiveChartImageGenerationFailed="AnswersInteractiveChartImageGenerationFailed",e.AnswersUnsupportedLanguageError="AnswersUnsupportedLanguageError",e.AnswersUnsupportedPlatformError="AnswersUnsupportedPlatformError",e.PythonStartAnalysisFailed="PythonStartAnalysisFailed",e.RichAPIGeneralException="RichAPIGeneralException",e.PythonProtectedSheetObjectInsertionError="PythonProtectedSheetObjectInsertionError"}(o||(o={}))},618175:(e,t,n)=>{"use strict";n.d(t,{f:()=>i});var a=n(882329),o=n(314793),r=n(715834);class i{getName(){return"WebSSOApiProvider"}async getToken(e,t){return(0,r.Y)((()=>Excel.run({delayForCellEdit:!0},(async()=>(await OfficeFirstPartyAuth.getAccessToken(e,{popup:t})).accessToken))),o.R.getLoadAuthLibraryTimeout())}async getPrimaryIdentityEmail(){return await this.load(),(await OfficeFirstPartyAuth.getPrimaryIdentityInfo()).email}isLoaded(){return this.loaded}async load(){OfficeFirstPartyAuth.authFlow="authcode",0===this.delayMs&&0===OfficeFirstPartyAuth.delay&&(this.delayMs=12e3,OfficeFirstPartyAuth.delay=this.delayMs,OfficeFirstPartyAuth.delayMsal=this.delayMs),await OfficeFirstPartyAuth.load(a.dS),this.loaded=!0}getLoadProps(){return{delayAllowed:this.delayMs}}constructor(){this.delayMs=0,this.loaded=!1}}},622753:(e,t,n)=>{"use strict";n.d(t,{D:()=>Ms,A:()=>Os});var a=n(92520),o=n(347145);class r{static getInstance(){return r.instance||(r.instance=new r),r.instance}async init(){this.awsAnthropicKeys=await this.calcAwsAnthropicKeys(),this.anthropicKey=await this.calcAnthropicKey()}getAwsAnthropicKeys(){return(0,o.u5T)()?this.awsAnthropicKeys:[]}getAnthropicKey(){return(0,o.u5T)()?"":this.anthropicKey}hexStringToArrayBuffer(e){if((e=e.replace(/[^a-fA-F0-9]/g,"")).length%2!=0)throw new Error("Invalid hex string");const t=new ArrayBuffer(e.length/2),n=new Uint8Array(t);for(let t=0;t<e.length;t+=2){const a=e.substring(t,t+2);n[t/2]=parseInt(a,16)}return t}async decryptData(e,t){const n=await window.crypto.subtle.decrypt({name:this.algorithmName},e,t);return(new TextDecoder).decode(n)}async decryptKeys(e,t){let n=(0,o.CyP)();if(0===n.length)return[];n+="f5c98a0709893c84e2c6478da1b4b0a05c015dbef47721255d0905e421ef836a9516b3bdb81171ef596b3920b9193f4a3e94c30b020301000102818021920186cd1efd522ba20d0cd6bcabff78769bc07fb8b0eb2daca4ca14317035af68c3981474a370d3be51af692c111bafb76d1d08b265550a9ff104c6fd2087c5a2184b2f4b7a3438ea4bd884a457b2436fab8efd384b088bc1e33d6817af08a112ef4cd3eb66b984183a2d6cb8f32c1f368ecd8bf8de40daa5783e6e004491024100f31181cf957fae6312dd443e6d8be4ceb296de33a4983c90fbd80fea6af6ba100e37ce3591562b82530338505290e5d3fd0a3f13a4711264f9c12938a57babf3024100dda50c399ebf308aecf04df55f920fca7c5522764810dd2ed819767cb4ccdabd5a3f37843dcdf8292c59544f6a997651d351c120b5be0fcdb94365a18568ca8902401d09695d77f981c69a194eaeba7d6cbef87ca75cb9fbe9b8542d9271298801e02b22a582a6b3098d8f0722720dfafb49a0bfd99b2a18cbdebe2b42165f466fdb0240379ddbc475a62a0b224b667484e7c4d89d7c4b6a7cc8e68783a8580810e23a9d3b1113e0361602086add7b7f76134e1258417281bfb912841fd1dea5ba31426902404a52f02643b685ff70b176f6ed340d3f7107bf1bf63b3588a57da21e44b5cee7143a5a9316eb1f3437abc844e54b7ab96326042a79de7f650614405145daadf8";try{const a=await window.crypto.subtle.importKey("pkcs8",this.hexStringToArrayBuffer(n),{name:this.algorithmName,hash:"SHA-256"},!0,["decrypt"]),o=await this.decryptData(a,this.hexStringToArrayBuffer(e)),r=await this.decryptData(a,this.hexStringToArrayBuffer(t));return[o.toString(),r.toString()]}catch(e){return(0,a.cY)("MCP: Error getting Anthropic keys - ",e),[]}}async calcAwsAnthropicKeys(){(0,a.cY)("MCP: Compute AWS Anthropic keys");return this.decryptKeys("4242967b086c40eba39e223560222a30b6e4282b6dad995c44a3fa96d37b99586304ee46ff95fb1b90c0b62217fcc6997ae6bb9f3c2abfe4b940ce3e240248ec7cb7023174e0e2af88ddc2b88c6ac6db17a22d9782186e47c862d78f880e4b83681665e618546faa4ce7b6c2b1eb1143513fb3e895acd02e48f6e900a6f781df","5941633fc38f8ea62958706f2c1143af60f6a54e7945b8dee7e61bad71bf67707aa0b4ab9ca3edefad8b945488d9ba61853d0b16f9d0bc5d4981b507b48446cb481b7c0f48a98663fe3dd49cdf3adddcdc7efde29a0e693a3b25ba9100551741baa849915bf4f9f2251b1f478bd5842756201c647c1d94048f622abbbc3680ad")}async calcAnthropicKey(){(0,a.cY)("MCP: Compute Anthropic key");const e=await this.decryptKeys("01725e534f0ba5169a126d8f44718b88690996d9b3bfba6f956e6c0d3f7d55f576485bd3d7e0b19643fc97c34d51e7684b4bd4b26db7088ce5dc0671d37a89c317828213a7a5bf94a67d638b879548ee72f3ef444a61c8344da8100bea48915e11b93f2bea31ea950a99f4a3390bdd5d64a27f75eec84fe3b21ccf96725c6bc0","1d06c4b96816a60143bf9776c2f7fa3fc5a92197f07e6ce0ecf433e6a0011f65298c4386b993350c34c2c2ba6399418cb7742b8b0bfa610cd70d2c2f197eeab639c7017405d3468ac159f89214e5052c40b24a89e138124a59ac53839f580402c3873642722f7cc0e0e4c63f2c621ffa8ed2ac798764e2ce25757465936ae6b8");return 2!==e.length?"":e[0]+e[1]}constructor(){this.algorithmName="RSA-OAEP",this.awsAnthropicKeys=[],this.anthropicKey=""}}var i,l=n(178365),s=n(713441);!function(e){e.Licensed="Licensed",e.MultiAccessDisabledByAdmin="MultiAccessDisabledByAdmin"}(i||(i={}));var c=n(279395),d=n(780866),u=n(121924),m=n(708335),g=n(241273),h=n(831922),p=n(767439),b=n(347969),f=n(500461),C=n(639765),y=n(548366),v=n(857677),T=n(76872),x=n(316904);async function S(e,t){const n=(new Date).getTime();await Excel.run({delayForCellEdit:e},(async e=>{e.workbook.settings.onSettingsChanged.add((()=>Excel.run({delayForCellEdit:(0,o.yw9)("OfficeVSO_9410553_copilotInfiniteLoadOnCellEdit")},(async e=>{const n=function(e,t){const n=e.getItemOrNullObject(t);return n.load("isNullObject,value"),n}(e.workbook.settings,"setState");await e.sync(),n.isNullObject||((0,a.cY)("Setting changed: state: "+JSON.stringify(n.value)),t(Number(n.value.copilotState),n.value.augLoopId),n.delete())}))))})),await w("OnLoad"),(0,o.yw9)("OfficeVSO_9513283_getDurationOfPrivateHostMessaging")&&T.E.getInstance().updateTelemetryChatEventData({[v.h3.ChatEventType]:v.a5.InitializePrivateHostMessagingDuration,[v.h3.ChatEventParameters]:((new Date).getTime()-n).toString()})}async function w(e){const t={cmdType:e};(0,a.cY)("Sending message to host: "+JSON.stringify(t)),await Excel.run({delayForCellEdit:(0,o.yw9)("OfficeVSO_9410553_copilotInfiniteLoadOnCellEdit")},(async e=>{e.workbook.settings.add("msgToExcel",t)}))}var E=n(177115),I=n(208520);const R=(0,d.n)({chatUiStack:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",backgroundColor:"transparent"}});const A=({copilotState:e})=>e&s.$.DisabledThirdPartyHost?I.createElement(h.TipCard,{headerText:(0,c.DyN)(),descriptionTextList:[(0,c.gk_)()],icon:(0,p.A)(b.wrX,b.UhZ)}):(e&(s.$.DisabledNewWorkbook|s.$.DisabledAutoSaveOff|s.$.DisabledLocalFile))!==s.$.Enabled?I.createElement(h.TipCard,{headerText:(0,c.tDq)(),descriptionTextList:[(0,c.USL)()],buttonTitle:(0,c.mT9)(),onClick:()=>{w("EnableAutoSave")},icon:(0,p.A)(b.wrX,b.UhZ)}):(0,o.yw9)("OfficeVSO_9854459_UpdateErrorMessageForUnsupportedFileState")&&e&s.$.DisabledSharedLock?I.createElement(h.TipCard,{headerText:c.olU.FileStateUnsupportedTitle,descriptionTextList:[I.createElement(u.E,{block:!0,key:"unsupported-file-state-message"},c.olU.FileStateUnsupportedMessage,I.createElement("div",{style:{marginTop:"16px"}},I.createElement(m.N,{href:c.Fxc,target:"_blank",style:{textDecoration:"underline"}},c.olU.FileStateUnsupportedLearnMoreLinkText)))],icon:(0,p.A)(b.wrX,b.UhZ)}):(0,o.yw9)("OfficeVSO_9185107_DisabledDialogSheetError")&&e&s.$.DisabledDialogSheetExists?I.createElement(h.TipCard,{headerText:(0,c.v01)(),descriptionTextList:[(0,c.UEB)()],icon:(0,p.A)(b.wrX,b.UhZ)}):!(0,o.yw9)("OfficeVSO_9854459_UpdateErrorMessageForUnsupportedFileState")&&e&s.$.DisabledSharedLock||e&s.$.DisabledAugLoopPermanentError?I.createElement(h.TipCard,{headerText:(0,c.Vx2)(),descriptionTextList:[(0,c.HTR)()],icon:(0,p.A)(b.wrX,b.UhZ)}):(window.document.getElementById(c.OsU)?.style.removeProperty("display"),I.createElement("div",null)),L=({copilotState:e,theme:t,isHighContrast:n})=>{const[a,o]=I.useState((0,f.eS)(t,n)),r=R();return I.useEffect((()=>{t!==g.Gm.defaultWhite?(0,h.setClientThemeType)(g.Gm.defaultBlack):(0,h.setClientThemeType)(g.Gm.defaultWhite),(0,h.setIsHighContrastEnabled)(n),o((0,f.eS)(t,n))}),[t,n]),I.useEffect((()=>(l.$.getInstance().clearLoadingPaneTimeout(),(0,E.oO)((new Date).getTime().toString()),()=>{l.$.getInstance().startLoadingPaneTimeout(!0),(0,E.Gr)((new Date).getTime().toString())})),[]),I.createElement(h.ThemeProvider,{theme:a},I.createElement(h.StackV9,{reverse:!0,style:r.chatUiStack},I.createElement(A,{copilotState:e})))};var k=n(341240),F=n.n(k),_=n(772777),P=n.n(_),N=n(412339),M=n.n(N),O=n(389064),D=n.n(O),B=n(269636),$=n.n(B),H=n(982017),U=n.n(H),q=n(589835),V={};V.styleTagTransform=U(),V.setAttributes=D(),V.insert=M().bind(null,"head"),V.domAPI=P(),V.insertStyleElement=$();F()(q.A,V);q.A&&q.A.locals&&q.A.locals;var W=n(946562),G=n(207545),z=n(702864),Q=n(57852),j=n(83437),J=n(822606),Y=n(937729),X=n(537782),Z=n(307271),K=n(308849),ee=n(328831),te=n(993821),ne=n(813392),ae=n(217425),oe=n(329739),re=n(584660),ie=n(448526),le=n(496931),se=n(863165),ce=n(632197),de=n(989881),ue=n(504009),me=n(638753),ge=n(508491),he=n(504251),pe=n(729851),be=n(462618),fe=n(881707),Ce=n(59653),ye=n(656931),ve=n(552398),Te=n(749832),xe=n(197665),Se=n(306148),we=n(354350),Ee=n(395285),Ie=n(391060),Re=n(79105),Ae=n(480005);const Le={fontSize:Ae.L.fontSizeBase200,fontWeight:Ae.L.fontWeightRegular,borderRadius:"12px",border:"none",padding:`${Ae.L.spacingVerticalXXS} ${Ae.L.spacingHorizontalS} ${Ae.L.spacingVerticalXXS} ${Ae.L.spacingHorizontalSNudge}`,cursor:"pointer",height:"24px",gap:Ae.L.spacingHorizontalXS,marginRight:Ae.L.spacingHorizontalXS,whiteSpace:"nowrap"},ke={...Le,color:Ae.L.colorNeutralForeground2,backgroundColor:Ae.L.colorTransparentBackground,"&:hover":{color:Ae.L.colorNeutralForeground2BrandHover,backgroundColor:Ae.L.colorTransparentBackground}},Fe={...Le,color:Ae.L.colorNeutralForegroundInverted,backgroundColor:Ae.L.colorBrandBackground,"&:hover":{color:Ae.L.colorNeutralForegroundInverted,backgroundColor:Ae.L.colorBrandBackgroundHover}},_e={...ke,border:`1px solid ${Ae.L.colorNeutralBackground1}`},Pe={...Fe,border:`1px solid ${Ae.L.colorNeutralBackground1}`},Ne={marginRight:"0px"},Me=(0,d.n)({root:ke,checked:Fe,rootHighContrast:_e,checkedHighContrast:Pe,icon:{...Ne,fill:Ae.L.colorNeutralForeground1,"&:hover":{fill:Ae.L.colorNeutralForeground2BrandHover}},iconChecked:{...Ne,fill:Ae.L.colorNeutralForegroundInverted,"&:hover":{fill:Ae.L.colorNeutralForegroundInverted}}}),Oe={borderRadius:"12px",height:"24px",width:"24px",minWidth:"24px",border:"none",cursor:"pointer",whiteSpace:"nowrap"},De={...Oe,color:Ae.L.colorNeutralForeground2,backgroundColor:Ae.L.colorTransparentBackground,"&:hover":{color:Ae.L.colorNeutralForeground2BrandHover,backgroundColor:Ae.L.colorTransparentBackground}},Be={...Oe,color:Ae.L.colorNeutralForegroundInverted,backgroundColor:Ae.L.colorBrandBackground,"&:hover":{color:Ae.L.colorNeutralForegroundInverted,backgroundColor:Ae.L.colorBrandBackgroundHover}},$e={...De,border:`1px solid ${Ae.L.colorNeutralBackground1}`},He={...Be,border:`1px solid ${Ae.L.colorNeutralBackground1}`},Ue=(0,d.n)({root:De,checked:Be,rootHighContrast:$e,checkedHighContrast:He,icon:{...Ne,fill:Ae.L.colorNeutralForeground1,"&:hover":{fill:Ae.L.colorNeutralForeground2BrandHover}},iconChecked:{...Ne,fill:Ae.L.colorNeutralForegroundInverted,"&:hover":{fill:Ae.L.colorNeutralForegroundInverted}}}),qe=({text:e,tooltipText:t,handleClick:n,isDisabled:a,isToggleOn:o,isIconOnly:r})=>{const{highContrastClientMode:i}=(0,I.useContext)(Ms),l=i!==f.QJ.disabled,[s,c]=(0,I.useState)(!1),d=(0,Ee.Bi)(),u=(0,Ee.Bi)(),m=Me(),g=Ue(),h=r?g:m;return I.createElement(Ie.m,{content:I.createElement("span",{id:d},t),relationship:"label",positioning:"above",withArrow:!0},I.createElement(Re.f,{className:l?o?h.checkedHighContrast:h.rootHighContrast:o?h.checked:h.root,size:"medium",disabled:a,"aria-label":e,"aria-labelledby":u,"aria-describedby":d,"aria-pressed":o,onClick:n,checked:o,onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),icon:s&&!o?{children:I.createElement(we.AzQ,null),className:h.icon}:{children:I.createElement(we.W66,null),className:o?h.iconChecked:h.icon},iconPosition:"before"},r?null:I.createElement("span",{id:u},e)))};var Ve=n(217160),We=n(615397),Ge=n(605424),ze=n(737649),Qe=n(12855),je=n(622998),Je=n(769506),Ye=n(517582),Xe=n(13161),Ze=n(823860),Ke=n(291436),et=n(698013),tt=n(468827),nt=n(255507),at=n(22992),ot=n(75496),rt=n(664007),it=n(805020),lt=n(639969),st=n(312422),ct=n(163724),dt=n(109174),ut=n(963491),mt=n(502535),gt=n(297848);const ht=async(e,t,n)=>{if(0===e.length)return!1;for(const a of e)await pt(a,t,n);return!0},pt=async(e,t,n)=>{try{const a=e?.args?.[0],o=JSON.parse(a),r=JSON.parse(e?.args?.[1]);return await(0,gt.Nl)(t,x.M.userQueryGuid,n,r,o)}catch(e){x.M.getInstance().logError({eventType:ot.S2.ImportData,errorMessage:`got error during handling import data suggestion pill: ${e} ${JSON.stringify(e)}`,logLevel:j.$b.Error})}};var bt=n(888520),ft=n(382736),Ct=n(795786);const yt=async(e,t,n)=>{e.length;for(const a of e)switch(a.kind){case"addDataShapingTransformationSteps":await Tt(a.args,t,n);break;case"dataShapingFailure":xt(a.args,t,n);break;case"enterDataShapingMode":wt(a.args,t,n);break;case"editDataShapingQuery":await St(a.args,t,n);break;default:(0,bt.x)(a)}return!0};let vt=0;const Tt=async(e,t,n)=>{n(rt.m.setLatestRequestId(t));const a=JSON.parse(e.transformationStepsJson).map((e=>({name:`${e.stepName}_${++vt}`,script:e.stepScript})));await n((0,lt.DD)(a));const o=(0,c.wzs)().replace("{0}",e.transformationStepsExplanation),r=n((0,lt.SW)());if(!r.started)throw new Error("Data shaping is not started");const i=JSON.stringify({queryScript:r.queryScript,transformationStepsJson:e.transformationStepsJson,requestJson:r.enableDebugging?e.requestJson:void 0}),{message:s,telemetry:d}=Ct.n.getDataShapingSuccessResponse(o,i,(async()=>{await n((0,lt.K5)(a))}));l.$.getInstance().displayResponse(s,d);const u=(0,ft.N)(s);n((0,lt.nv)(u,Ke.Aw.success,d,!1)),n((0,lt.L4)())},xt=(e,t,n)=>{wn.getInstance(n).showDataShapingErrorCard(t,e.sessionId,e.errorSource,e.errorCode,e.requestJson)},St=async(e,t,n)=>{n(rt.m.setLatestRequestId(t));const a=n((0,lt.SW)());if(!a.started)throw new Error("Data shaping is not started");const o=a.queryScript,r=JSON.stringify({queryScript:e.queryScript,originalQueryScript:o,requestJson:e.requestJson});let i,s,d;e.queryScript?(s=e.queryScript,await n((0,lt.Q4)(e.queryScript)),i=(0,c.fYt)().replace("{0}",e.explanation),d=async()=>{n(rt.m.addDataShapingChatEntry({kind:"Undo"})),await n((0,lt.Q4)(o))}):(i=e.explanation,s=e.explanation),n(rt.m.addDataShapingChatEntry({kind:"Instruction",instruction:e.instruction,response:s}));const{message:u,telemetry:m}=Ct.n.getDataShapingSuccessResponse(i,r,d);l.$.getInstance().displayResponse(u,m);const g=(0,ft.N)(u);n((0,lt.nv)(g,Ke.Aw.success,m,!1)),n((0,lt.L4)())},wt=(e,t,n)=>{n(rt.m.exitDataShapingMode());wn.getInstance(n).showStartDataShapingCard(t,e.sessionId,e.tableName,e.mashupDocument,e.queryName,e.queryScript,e.requestJson)};var Et=n(855539),It=n(792312),Rt=n(147091);const At=async(e,t,n,a)=>{if((0,Rt.OC)(n,t,"executeFormulaGeneration"),0===e.length)return!1;for(const o of e)await Lt(o,t,n,a);return!0},Lt=async(e,t,n,o)=>{if("addCalculatedColumns"!==e.func&&"aggregateColumns"!==e.func)throw new Error(`Unsupported function ${e.func} for formula generation`);if(e.args.length<1)throw new Error(`No arguments found for ${e.func}`);if(e.args.length>3)throw new Error(`Incorrect number of parameters for ${e.func}`);n(Et.m.updateTableName({requestId:t,table:e.args[0]})),1===e.args.length?await n((0,It.hJ)(t,o)):"aggregateColumns"===e.func?((0,a.cY)("fetchCellRecommendations"),await n((0,It.JK)(t,o,e.args[1]))):((0,a.cY)("fetchColumnRecommendations"),await n((0,It.hJ)(t,o,e.args[1])))};var kt=n(803716);const Ft=async(e,t,n,a)=>{if(0===e.length)return!1;for(const o of e)await _t(o,t,n,a);return!0},_t=async(e,t,n,a)=>{if("getTableInsights"!==e.func)throw new Error(`Unsupported function ${e.func} for Insights agent`);if(e.args.length<1)throw new Error("No arguments found for getTableInsights");const o=e.args[0],r=e.args[1],i=dt.CP.getActiveTable();if(!i||i.name!==o)throw new Error("The query is not aimed at the active table");n((0,kt.ge)(o,i,r,t,a))};var Pt=n(76913),Nt=n(110686),Mt=n(719733),Ot=n(972424),Dt=n(514450);var Bt=n(467407),$t=n(903173);class Ht{async applyCommandingProgram(e,t,n,a,r,i){await(0,st.$r)((0,c.Eyh)());const l=Ct.n.getCommandingFeatureName(),s=l===v.q.ConditionalFormatting?v.OP.ConditionalFormatting:v.OP.Commanding;n((0,lt.eM)(s));const d=(new Date).getTime();for(const s of t){let t="",c=!1;const d=(new Date).getTime();try{const a=s.items;switch(i){case Xe.w2.OfficeJS:t="OfficeJS",c=await this.executeJsApiEvent(e,a,n,r);break;case Xe.w2.OfficeScripts:t="OfficeScripts",c=await this.executeOfficeScript(e,a,n,r)}c&&n((0,lt._Z)({caller:t}))}catch(e){return n($t.m.resetIsAllowRewrite()),this.logExecutorFailure(s,d),this.telemetryLogger.endTriedActivityFailure(l),await n((0,lt.L4)()),void((0,o.yw9)("OfficeVSO_10319285_AwaitOdslErrorHandling")?await a(e):a(e))}}this.logExecutionSucceed(d),nt.B.getInstance().logKeptEvent(this.telemetryLogger.getStandardizedFeatureForSubFeature(l),l,pe.RX.Command),await(0,st.TA)(),await n((0,lt.L4)()),this.addCommandingSuccessMessage(n,r,!1),(0,o.yw9)("OfficeVSO_9083629_HiTLApplyResetShowUndoButton")&&ye.Z.getInstance().setShowUndoButton(!1)}async execute(e,t,n,a,r){const i=(new Date).getTime();let l=!1,s=!1,c=!1;const d=[];let u=!1;for(const i of this.events){if(e.happened)throw new We.WD("Timeout detected during HybridEventExecutor.execute");const m=(new Date).getTime();try{switch(i.agent){case Xe.w2.OfficeJS:(0,o.k64)()?c||(l=await this.showCommandingHumanInTheLoop(e,this.events,n,(e=>a(e)),d,i.agent)||l,c=!0):(this.telemetryLogger.endTriedActivitySuccess(v.q.Commanding),s=await this.executeJsApiEvent(e,i.items,n,d)||s,s&&n((0,lt._Z)({caller:"OfficeJS"})));break;case Xe.w2.OfficeScripts:(0,o.k64)()?c||(l=await this.showCommandingHumanInTheLoop(e,this.events,n,(e=>a(e)),d,i.agent)||l,c=!0):(this.telemetryLogger.endTriedActivitySuccess(v.q.Commanding),s=await this.executeOfficeScript(e,i.items,n,d)||s,s&&n((0,lt._Z)({caller:"OfficeScripts"})));break;case Xe.w2.Insights:this.telemetryLogger.endTriedActivitySuccess(v.q.AnalyzeData),l=await Ft(i.items,t,n,r)||l;break;case Xe.w2.ImportData:(0,o.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.ImportDataAsSkill",!1)&&(this.telemetryLogger.startTriedActivity(v.q.ImportDataSkill),l=await ht(i.items,t,n)||l);break;case Xe.w2.FormulaGeneration:this.telemetryLogger.endTriedActivitySuccess("aggregateColumns"===i.items[0].func?v.q.CalculatedRows:v.q.CalculatedColumns),l=await At(i.items,t,n,r)||l;break;case Xe.w2.ConditionalFormatSuggestion:this.telemetryLogger.endTriedActivitySuccess(v.q.ConditionalFormatting),l=await(0,mt.X)(i.items,t,n,r)||l;break;case Xe.w2.DataShaping:this.telemetryLogger.endTriedActivitySuccess((0,o.yw9)("OfficeVSO_9564930_SplitCommandingTelemetry")?v.q.DataShaping:v.q.Commanding),l=await yt(i.items,t,n)||l;break;case Xe.w2.UnsupportedEvent:this.telemetryLogger.endTriedActivityFailure(),u=!0;break;default:this.telemetryLogger.endTriedActivityFailure()}}catch(e){throw n($t.m.resetIsAllowRewrite()),this.logExecutorFailure(i,m,e instanceof Error?e.message:void 0),this.telemetryLogger.endTriedActivityFailure(),e}}if(!l&&!s)throw this.telemetryLogger.endTriedActivityFailure(),this.logNoEventsExecuted(),this.hasOnlyUnsupportedEvents()?new We.j4("Only unsupported events.",function(e){let t=[];for(const n of e)n.agent===Xe.w2.UnsupportedEvent&&(t=t.concat(n.items));return t}(this.events)):new Error("No events were executed!");this.logExecutionSucceed(i),s&&(nt.B.getInstance().logKeptEvent(v.BJ.Commanding,v.q.Commanding,pe.RX.Command),this.addCommandingSuccessMessage(n,d,u))}async executeJsApiEvent(e,t,n,a){if(0===t.length)return!1;(0,o.k64)()||n(rt.m.startExecutingCommand({command:v.OP.Commanding}));let r="";try{for(let n=0;n<t.length;n++){if(e.happened){const e=new We.WD("Timeout detected during executeJsApiEvent");throw(0,o.yw9)("OfficeVSO_8814792_LogAshaCommandingTelemetry")&&(e.errorCode="Timeout"),e}const i=t[n];r=i.method.toString();const l=await i.func(i.args);a.push(l)}}catch(e){throw this.logJsApiExecutorError(e,r),this.logCommandingAshaError(e.errorCode),this.isExecutingMultipleEvents()?new We.m2("Error has occurred when executing multiple events."):e}return!0}async executeOfficeScript(e,t,n,a){if(0===t.length)return!1;(0,o.k64)()||n(rt.m.startExecutingCommand({command:v.OP.Commanding}));try{if(e.happened){const e=new We.WD("Timeout detected during executeOfficeScript");throw(0,o.yw9)("OfficeVSO_8814792_LogAshaCommandingTelemetry")&&(e.errorCode="Timeout"),e}const r=await(0,Dt.V)(t);(0,o.GBi)()&&this.performScratchpadPassiveTesting(r,n((0,Nt.Z)()).dataLocale||"en-us").catch((()=>{})),await this.runtimeHelper.prepareScript(r),await this.runtimeHelper.executeScript(r);if((0,ut.yC)(t).forEach((e=>{e!==Ze.O.MissingIntent&&a.push(e)})),0===a.length){const e=[{key:v.Dh.EventType,value:v.Mv.LogMissingIntentString}];(0,Bt.j)(e)}}catch(e){throw e.isExecutorError&&this.logOfficeScriptExecutorError(e,t),this.logCommandingAshaError(e.errorCode),this.isExecutingMultipleEvents()?new We.m2("Error has occurred when executing multiple events."):e}return!0}async performScratchpadPassiveTesting(e,t){try{if(T.E.getInstance().updateTelemetryChatEventData({[pe.h3.ChatEventType]:v.a5.CommandScratchpadPassiveTesting},x.M.getInstance()),!e.localUpdates?.body)return void x.M.getInstance().logError({eventType:ot.S2.CommandingScratchpad,errorMessage:"Error scratchpad passive test: empty script",logLevel:j.$b.Warning});const n=new et.p(t,"ScratchpadPassiveTesting"),a=tt.b.instance(),o=e.localUpdates.body,r=await(0,Mt.uS)(e),i=await(0,ct.V)(o,e,r);await a.prepareCustomParams(i,void 0,n.makeBatchHandler(),e),await a.executeScript()}catch(e){x.M.getInstance().logError({eventType:ot.S2.CommandingScratchpad,errorMessage:"Error scratchpad passive test. OfficeJs Internal Error: "+e,logLevel:j.$b.Warning})}finally{try{(0,Je.qK)("ScratchpadPassiveTesting",t)}catch(e){}}}logCommandingAshaError(e){const t=Ct.n.getCommandingFeatureName(),n=v.q.ConditionalFormatting===t;if((0,o.yw9)("OfficeVSO_8814792_LogAshaCommandingTelemetry")){let t,a;switch(e){case"AccessDenied":t=y.W.Unable_To_Complete_Task,a=n?C.c.Failed_Conditional_Formatting_Execution_Due_To_Protection_Settings:C.c.Failed_Command_Execution_Due_To_Protection_Settings;break;case"Timeout":t=y.W.Response_Delayed_Or_Timed_Out,a=n?C.c.Conditional_Formatting_Execution_Took_Too_Long:C.c.Command_Execution_Took_Too_Long;break;default:t=y.W.Unclassified_Chat_Failure,a=n?C.c.Failed_Conditional_Formatting_Execution_Due_To_Other_Error:C.c.Failed_Command_Execution_Due_To_Other_Error}x.M.getInstance().logStandardizedAshaErrorEvent(t,a,n?v.BJ.ConditionalFormatting:v.BJ.Commanding)}}logExecutionSucceed(e){const t=(0,v.b6)();t[v.Dh.EventState]=v.DD.ExecutorSucceeded,t[v.Dh.TimeDurationInMs]=(0,v.xJ)(e),this.telemetryLogger.logEvent((0,v.gY)(t))}logNoEventsExecuted(){this.logNoEventExecutedError();const e=(0,v.b6)();e[v.Dh.EventState]=v.DD.ExecutorNoneExecuted,this.telemetryLogger.logEvent((0,v.gY)(e))}logExecutorFailure(e,t,n){const a=(0,v.b6)();a[v.Dh.EventState]=v.DD.ExecutorFailed,a[v.Dh.ExecutableAgent]=e.agent,a[v.Dh.TimeDurationInMs]=(0,v.xJ)(t),e.agent===Xe.w2.OfficeJS||e.agent===Xe.w2.OfficeScripts?a[v.Dh.ExecutableNames]=JSON.stringify(e.items.map((e=>e.method))):(0,o.yw9)("OfficeVSO_9275720_addErrorMessageForExecutorFailureEventsV2")&&(a[v.Dh.ErrorMessage]=n),this.telemetryLogger.logEvent((0,v.gY)(a))}logNoEventExecutedError(){const e={eventType:ot.S2.NoEventExecuted,errorMessage:"",logLevel:j.$b.Warning},t=[{key:v.xL.ErrorMessage,value:"No event has been executed."}];this.telemetryLogger.logError(e,void 0,t)}logJsApiExecutorError(e,t){const n=JSON.stringify(e),a={eventType:ot.S2.Executor,errorMessage:n,logLevel:j.$b.ASHA},o=[{key:v.LP.FailedEventMethods,value:JSON.stringify([t])},{key:v.LP.Agent,value:Xe.w2.OfficeJS},{key:v.xL.ErrorMessage,value:"Something went wrong while executing JS API events."}];this.telemetryLogger.logError(a,void 0,o)}logOfficeScriptExecutorError(e,t){const n={eventType:ot.S2.Executor,errorMessage:e.message,logLevel:j.$b.ASHA},a=[{key:v.LP.FailedEventMethods,value:JSON.stringify(t.map((e=>e.method)))},{key:v.LP.Agent,value:Xe.w2.OfficeScripts},{key:v.xL.ErrorMessage,value:e.message}];this.telemetryLogger.logError(n,void 0,a)}addCommandingSuccessMessage(e,t,n){ye.Z.getInstance().setShowUndoButton(!0),(0,o.k64)()&&(0,o.yw9)("OfficeVSO_9008332_FixHiTLUndoState")||e(it.m.setDoesFluxTurnRequireUndo());const a=this.getMessageSuffix(n),r=t.map((e=>({text:e}))),{message:i,telemetry:s}=Ct.n.getCommandingSuccessResponse(a,r);l.$.getInstance().displayResponse(i,s,{shouldShowWhenFluxSkillResponseRequired:!1});const c=(0,Pt.r)(a,r),d=(0,ft.N)(c);e((0,lt.nv)(d,Ke.Aw.success,s)),e((0,lt.Yx)(["Commanding_Suggestion"]))}isExecutingMultipleEvents(){let e=0;return this.events.forEach((t=>{t.agent!==Xe.w2.OfficeJS&&t.agent!==Xe.w2.OfficeScripts||(e+=t.items.length)})),e>1}hasOnlyUnsupportedEvents(){let e=!0;return this.events.forEach((t=>{t.agent!==Xe.w2.UnsupportedEvent&&(e=!1)})),e}getMessageSuffix(e){let t;const n=at.g.instance().getHiddenColumnSuffixMessageAndReset();return t=n||(e?(0,c.VCG)():void 0),t}constructor(e){this.showCommandingHumanInTheLoop=async(e,t,n,a,r,i)=>{if(0===t.length)return!1;let s,d=[],u=[];for(const e of t)if((0,o.yw9)("OfficeVSO_9122912_HiTLTLRFilterOfficeJS")&&e.agent===Xe.w2.OfficeJS){const t=e.items;u=u.concat((0,ut.C2)(t)??[])}else{const t=e.items,{cfIntents:n,nonCfIntents:a}=(0,ut.NU)(t);d=d.concat(n??[]),u=u.concat(a??[])}const m=dt.CP.getActiveTable(),g=m?m.address:"";dt.CP.setHumanInTheLoopRange((0,Ot.r)(g));let h=v.q.Commanding;d.length>0?((0,o.yw9)("OfficeVSO_9564930_SplitCommandingTelemetry")&&(h=v.q.ConditionalFormatting,this.telemetryLogger.setActiveFeature(h)),s=Ct.n.getCommandingCFHumanInTheLoopResponse(d,u,(()=>this.applyCommandingProgram(e,t,n,(e=>a(e)),r,i)))):s=(0,o.yw9)("OfficeVSO_8976811_BoldRangeHiTLCard")?Ct.n.getCommandingHumanInTheLoopResponse(u,(()=>this.applyCommandingProgram(e,t,n,(e=>a(e)),r,i))):Ct.n.getCommandingHumanInTheLoopResponseDeprecated(u,(()=>this.applyCommandingProgram(e,t,n,(e=>a(e)),r,i))),l.$.getInstance().displayResponse(s.message,s.telemetry,{shouldShowWhenFluxSkillResponseRequired:!0});const p=JSON.stringify({text:c.qbK.HumanInTheLoop.CardShown,publishPreference:Ze.f.Never});return this.telemetryLogger.endTriedActivitySuccess(h),n((0,lt.nv)(p,Ke.Aw.success,s.telemetry)),!0},this.runtimeHelper=tt.b.instance(),this.telemetryLogger=x.M.getInstance(),this.events=e}}var Ut=n(464266),qt=n(545564),Vt=n(504280),Wt=n(596498),Gt=n(469486),zt=n(468967),Qt=n(402769),jt=n(672270),Jt=n(164584),Yt=n(540084);function Xt(e,t){const n=t.filter(((e,n)=>!t.slice(0,n).includes(e)));let a=!1;if(!n.includes(Xe.DH.Undo)&&!n.includes(Xe.DH.InsertTables)&&!n.includes(Xe.DH.Formatting)&&n.length>0){const{message:t,telemetry:n}=Ct.n.getUnsupportedCommandResponse((0,c.DUN)());l.$.getInstance().displayResponse(t,n,{shouldShowWhenFluxSkillResponseRequired:!1});const o=(0,ft.N)(t);e((0,lt.nv)(o,Ke.Aw.failed,n)),a=!0}return n.forEach((t=>function(e,t){const n=Office.context.platform;let a="",o=[];switch(t){case Xe.DH.Undo:{let e=[{text:(0,c.Y91)()}];n===Office.PlatformType.Mac?e=[{text:(0,c.mLK)()}]:n===Office.PlatformType.PC&&(e=[{text:(0,c.wEx)()}]),a=(0,c.vuT)(),o=e;break}case Xe.DH.TableAltText:{const e=[{text:(0,c.HhS)()}];n===Office.PlatformType.Mac||n===Office.PlatformType.PC?e.push({text:(0,c.$S6)()}):e.push({text:(0,c.gq9)()}),a=(0,c.xFL)(),o=e;break}case Xe.DH.AddComment:a=(0,c.S08)(),o=[{text:(0,c.CnK)()},{text:(0,c.Tem)()},{text:(0,c.Ub7)()},{text:(0,c.p8k)()}];break;case Xe.DH.DataValidation:a=(0,c.TVz)(),o=[{text:(0,c.FuV)()},{text:(0,c.yWY)()},{text:(0,c.tPp)()},{text:(0,c.YSs)()},{text:(0,c.di6)()},{text:(0,c.ean)()}];break;case Xe.DH.CreatePivotTable:a=(0,c.xmO)(),o=[{text:(0,c.Pzq)()},{text:(0,c.GyK)()},{text:(0,c.TMJ)()},{text:(0,c.OpW)()},{text:(0,c.rho)()}];break;case Xe.DH.InsertWorksheets:case Xe.DH.DeleteWorksheets:a=(0,c.Iy7)(),o=[{text:(0,c.Qv5)()},{text:(0,c.Xdl)()},{text:(0,c.QaT)()}];break;case Xe.DH.FreezePanes:a=(0,c.M76)(),o=[{text:(0,c.czL)()},{text:(0,c.jh3)()}];break;case Xe.DH.Formatting:a=(0,c.$5J)();break;case Xe.DH.InsertTables:a=(0,c.fLI)();break;default:a=(0,c.AWW)(),e((0,lt.Nl)())}const{message:r,telemetry:i}=Ct.n.getUnsupportedCommandResponse(a,o);l.$.getInstance().displayResponse(r,i,{shouldShowWhenFluxSkillResponseRequired:!1});const s=(0,ft.N)(r);e((0,lt.nv)(s,Ke.Aw.failed,i))}(e,t))),a}var Zt=n(823465),Kt=n(799765);function en(e){if(!function(e){return e.type===Ge.VF.CopilotChatResponseMeta}(e))return;const t=e.chatResponseCode;if(t!==Ge.XO.OK)switch(t){case Ge.XO.ServiceTimeout:return void n(y.W.Response_Delayed_Or_Timed_Out,C.c.Service_Timeout);case Ge.XO.ServiceError:return void n(y.W.LLM_Service_Side_Issue_Prevents_Output,C.c.Service_Error_Augloop);case Ge.XO.RAICheckFailed:return void n(y.W.Responsible_AI_Filter_Blocked_Response,C.c.RAI_Validation_Failed);case Ge.XO.Unknown:return void n(y.W.Unable_To_Complete_Task,C.c.Service_Error_Unknown_Error);default:return x.M.getInstance().logError({eventType:ot.S2.Error,errorMessage:`Unknown CopilotChatResponseCode - ${t}`,logLevel:j.$b.Error}),void n(y.W.Unable_To_Complete_Task,C.c.Service_Error_Unknown_Error)}function n(e,t){x.M.getInstance().logStandardizedAshaErrorEvent(e,t,v.BJ.CopilotChat)}}var tn=n(402488),nn=n(252120),an=n(507628),on=n(616166),rn=n(531093),ln=n(448514),sn=n(47717),cn=n(615956),dn=n(543435),un=n(857786),mn=n(661588),gn=n(212605);class hn extends cn.r{async autoInsertPythonFormula(){return new Promise(((e,t)=>{(0,st.F5)((async n=>{try{(0,un.Fr)(un.xk.CodeExecution),(0,un.BW)(this.dispatch);const t=(0,Gt.ZK)(this.code,!0,mn.M),a=this.codeLabel?this.codeLabel:(0,c.XZh)(),o=await(0,Gt.WH)(n,this.sheetId),r=await(0,un.Mg)((async()=>await this.insertLabelAndContentForPreviewOrFormula(n,o,a,t,!0,!1)),un.xk.InsertContentToGrid);e(r)}catch(e){(0,un.i5)(!1),(0,un.$k)(this.dispatch);const n=(0,zt.MF)(e,"PythonAutoInserter","autoInsertPythonFormula",!1);t(n)}}),{delayForCellEdit:!1})}))}async handlePythonCellExecutionResult(e,t,n){(0,Kt.M5)();const a=e.output;"Error"!==e.outputType&&"Python"!==a.errorType&&(0,un._F)(),(0,un.MO)(),this.addCodeAndOutputToBuilder(e),(0,Kt.S$)(t,e),await(0,un.ek)((async()=>{await this.handlePythonAdaExecutionResult(e,n)}),un.xk.HandlePythonAdaCellExecution,!0)}async handlePythonAdaExecutionResult(e,t){try{const n=dt.CP.pythonContextManager.isPythonThinkDeeperMode?dt.CP.pythonContextManager.MAX_AUGLOOP_CALLS_PER_QUERY_THINK_DEEPER:dt.CP.pythonContextManager.MAX_AUGLOOP_CALLS_PER_QUERY;if(dt.CP.pythonContextManager.augloopCallsPerQuery>=n){const e=`Maximum AugLoop Calls Per Query: ${n}`,t=(0,zt.x6)(e);return void(0,zt.QX)(this.dispatch,t,!0)}if(dt.CP.pythonContextManager.augloopCallsPerQuery+=1,e.outputType===dn.qf.Error){if(dt.CP.pythonContextManager.codeRetryAttempts>=dt.CP.pythonContextManager.MAX_CODE_RETRY_ATTEMPTS){const e=`Maximum Retry Attempts: ${dt.CP.pythonContextManager.MAX_CODE_RETRY_ATTEMPTS}`;throw(0,zt.Jk)(e)}{dt.CP.pythonContextManager.codeRetryAttempts+=1;const n=e.output;if(n.errorType!==Excel.ErrorCellValueType.python&&n.errorType!==Excel.ErrorCellValueType.timeout){throw(0,zt.En)(e)}{const e=(0,Gt.u1)(n.errorType,t);gn.n.displayPythonTextResponse(this.dispatch,e,!1)}}}else(0,Kt.Jr)(dt.CP.pythonContextManager.augloopCallsPerQuery,dt.CP.pythonContextManager.codeRetryAttempts),dt.CP.pythonContextManager.codeRetryAttempts=0;await Ce.p.getInstance().handlePythonAdaExecutionResult()}catch(e){throw(0,zt.Kx)(this.dispatch,e,"handlePythonAdaExecutionResult",!0),e}}constructor(e,t,n,a,o,r){super(e,n,cn.n.PythonCodeAndPreviewInserter,o,r),this.requestId=t,this.code=a}}var pn=n(126521);class bn extends cn.r{async handlePythonCellExecutionResult(e){let t;nt.B.getInstance().logKeptEvent(v.BJ.Python,v.q.PythonCalculatedColumns,pe.RX.Analyze);try{if("Error"===e.outputType){const n=e.output;t=(0,pn.L)((0,c.pa_)(),n.errorType)}else t=(0,pn.L)((0,c.TaP)(),this.columnLetters);const{message:n,telemetry:a}=Ct.n.getPythonColumnInsertResponse(t,this.requestId);l.$.getInstance().displayResponse(n,a)}catch(e){this.handlePythonColumnError(e,(0,c.JIA)())}}addResultListener(e,t){const n=t=>this.onCalculatedHandler(t,e);this.onCalculatedResult=t.onCalculated.add(n),this.handlerReference=n}removeResultListener(e){this.handlerReference&&e.onCalculated.remove(this.handlerReference)}async onCalculatedHandler(e,t){await Excel.run((async n=>{const a=n.workbook.worksheets.getItem(e.worksheetId);try{const o=e.address.split(",");for(const r of o){const o=a.getRange(r).load(["formulas","valuesAsJson","rowCount","columnCount"]);await n.sync();const i=(0,Gt.o7)(t);await Promise.all(o.formulas.flatMap((async(t,n)=>t.map((async(t,a)=>{const o=(0,Gt.o7)(t),l=await this.mutex.waitFor();if(this.onCalculatedFinished)l.release();else if(i===o){this.onCalculatedFinished=!0,l.release(),this.onCalculatedResult?.remove(),await(this.onCalculatedResult?.context.sync()),this.onCalculatedResult=null;const t=rn.ExcelCalc.addressToExcelRange(r).topLeft;t.column=(t.column??0)+a,t.row=(t.row??0)+n;const o={topLeft:t,bottomRight:t},i=rn.ExcelCalc.IExcelRangeToAddress(o),s=await dt.CP.pythonContextManager.getPythonCellContextWithTimeout(e.worksheetId,i);await this.handlePythonCellExecutionResult(s)}else l.release()})))))}}catch(e){this.removeResultListener(a),this.handlePythonColumnError(e,(0,c.JIA)())}this.removeResultListener(a)}))}async autoInsertPythonFormula(){return new Promise(((e,t)=>{try{(0,st.F5)((async t=>{const n=(0,Gt.ZK)(this.code,!0,mn.M),a=await this.insertContentForColumn(t,this.codeLabel??(0,c.XZh)(),n);e(a)}))}catch(e){this.handlePythonColumnError(e,(0,c.JIA)()),t(e)}}))}handlePythonColumnError(e,t){const{message:n,telemetry:a}=Ct.n.getPythonColumnInsertErrorResponse(e,t);l.$.getInstance().displayResponse(n,a)}async setColumnContent(e,t,n,a){const o=t.getRange(this.tableAddress).load(["rowIndex","rowCount","columnIndex","columnCount"]);await e.sync();const{headerCell:r,contentRange:i}=function(e,t){const n=t.columnIndex+t.columnCount;return{headerCell:e.getCell(t.rowIndex,n),contentRange:e.getRangeByIndexes(t.rowIndex+1,n,1,1)}}(t,o);return i.load("address"),r.values=[[n]],i.values=[[a]],i.select(),await e.sync(),i.address}async insertContentForColumn(e,t,n){const a=e.workbook.worksheets.getItemOrNullObject(this.sheetId);this.addResultListener(n,a);return await this.setColumnContent(e,a,t,n)}constructor(e,t,n,a,o,r,i,l){super(e,n,cn.n.PythonCalculatedColumnInserter,i,l),this.requestId=t,this.code=r,this.tableAddress=a,this.columnLetters=o}}var fn=n(181730),Cn=n(891693),yn=n(314793),vn=n(261720);function Tn(e){switch(e){case Ut.r.AnswersLlmLoopLimitHit:return(0,c.kQP)();case Ut.r.AnswersCallingElseSkill:return(0,c.g9p)();case Ut.r.AnswersElseSkillDone:return"";default:{const t=`Python status ${e} is not supported.`;throw(0,zt.xp)(on.O.PythonUnsupportedResponseType,t)}}}var xn=n(294426);var Sn=n(821845);class wn{static getInstance(e){return wn.instance||(wn.instance=new wn(e)),wn.instance}async applyAllBatches(e){if(!this.scratchpad)return{success:!1,errorMessage:`Scratchpad was not initialized when trying to apply all batches for caller ${e}`};const t=await this.scratchpad.applyAllBatches(e);return this.scratchpad.clearChangeCollectorForCaller(e),t}executeOfficeJsFromScriptRunner(e){return this.officeJsCommanding||(this.officeJsCommanding=new Je.$v(this.dispatch)),this.officeJsCommanding.executeOfficeJsRaw(e)}startChangeCollector(e){this.scratchpad||(this.scratchpad=new Cn.O(this.dispatch)),this.scratchpad.addOrResetChangeCollector(e)}async executeScript(e,t){return this.scratchpad||(this.scratchpad=new Cn.O(this.dispatch)),await this.scratchpad.executeScript(e,t)}applyChartStylesOfficeJsCommanding(e,t){this.officeJsCommanding||(this.officeJsCommanding=new Je.$v(this.dispatch)),this.officeJsCommanding.executeOfficeJs("",e,[t],!0,!1)}async handleChartDesignNoRecommendationResult(){this.officeJsCommanding||(this.officeJsCommanding=new Je.$v(this.dispatch)),await this.officeJsCommanding.handleChartDesignNoRecommendationResult()}async handleChartDesignRecommendationResult(e,t,n,a,o){this.officeJsCommanding||(this.officeJsCommanding=new Je.$v(this.dispatch)),await this.officeJsCommanding.handleChartDesignRecommendationResult(e,t,n,a,o)}setAugloopSignalSentTime(e){this.augloopSignalSentTime=e,this.isFirstResponse=!0,ye.Z.getInstance().resetStartQueryState(e)}markRequestCanceled(){this.dispatch((0,lt.L4)(!1));const e=x.M.userQueryGuid;this.canceledQueryIds.push(e),Ye.Q.getInstance().stopRecordingFluxWorkflow(!0),l.$.getInstance().handleEndOfQuery(void 0),this.dispatch($t.m.evaluateQueryFailed(e)),this.dispatch(Et.m.fetchRecommendationsFailed(e))}setAugloopModelWorkflowUnsupported(e){e&&this.dispatch(it.m.setAugloopModelWorkflowUnsupported())}async handleErrorResponse(e,t,n){let a={},r={};const i=this.telemetryLogger.getActiveFeature();if((0,o.thH)()&&(({message:a,telemetry:r}=await Ct.n.getAugloopErrorResponse(e,n,i)),!r.useClientSideErrorMessage))return!1;dt.CP.pythonContextManager.isPythonMode&&dt.CP.pythonContextManager.isStartAnalysisCard()&&this.dispatch(rt.m.setPythonStartAnalysisButtonDisabled(!0)),dt.CP.pythonContextManager.isPythonMode&&((0,un.hb)(),(0,un.P_)(!0)),this.dispatch((0,lt.Nl)()),this.telemetryLogger.endTriedActivityFailure(),(0,jt.cY)(`AL Error:\n${JSON.stringify(e,void 0,4)}`);const l=(0,jt.qW)(t);let s=!1;if("OffensiveContent"!==e.category&&0!==l.length)s=Xt(this.dispatch,l),(0,o.yw9)("OfficeVSO_9220746_AddAshaForUnsupportedCommand")&&(0,o.yw9)("OfficeVSO_8814792_LogAshaCommandingTelemetry")&&x.M.getInstance().logStandardizedAshaErrorEvent(y.W.Missing_Copilot_Functionality,C.c.ODSL_Execution_Failed_Due_To_Unsupported_Commands,i);else{(0,o.thH)()||({message:a,telemetry:r}=await Ct.n.getAugloopErrorResponse(e,n,i)),s=this.copilotChatUiHelper.displayErrorResponseIfNeeded(a,r,{shouldShowWhenFluxSkillResponseRequired:!1});const t=(0,ft.N)(a);this.dispatch((0,lt.nv)(t,Ke.Aw.failed,r)),this.showUnsupportedTLRSuggestionListIfNeeded(r)}return await this.dispatch((0,lt.L4)(!1)),Ye.Q.getInstance().stopRecordingFluxWorkflow(!1),this.telemetryLogger.logError({eventType:ot.S2.Augloop,errorMessage:"Failure received from Augloop.",logLevel:this.telemetryLogger.getLogLevelForErrorCategory(e?.category??"")},void 0,[{key:v.IC.ErrorCategory,value:e?.category??""}]),ye.Z.getInstance().endUserPerceivedLatency(!1),dt.CP.pythonContextManager.isPythonMode&&((0,un.P_)(),s&&(0,zt.OE)(this.dispatch)),!0}async handleResponse(e){if(this.augloopSignalSentTime){const t=(0,v.xJ)(this.augloopSignalSentTime);this.telemetryEventHandler.logLatency(t,v.OP.AugloopResponse),this.isFirstResponse&&(this.telemetryEventHandler.updateTelemetryLatencyData({[v.CT.FirstServiceResponse]:(0,ln.W)(this.augloopSignalSentTime)},this.telemetryLogger),this.isFirstResponse=!1),(0,jt.cY)(`${e.body?Wt.h.getTypeNameFor(e.body):"item.body is gone; this is a bug in"} response. Time Taken : ${t/1e3} sec \n`)}const t=this.copilotChatUiHelper.getLastUserUtterance(),n=e?.body?.odslResponse?.odsl?.responseRequired;if(e?.body?.queryId&&-1!==this.canceledQueryIds.indexOf(e?.body?.queryId))return this.telemetryLogger.endTriedActivityFailure(),(0,jt.cY)("query was cancelled"),n&&(0,lt.$U)(Ke.Aw.failed,(0,c.gAP)()),void ye.Z.getInstance().endUserPerceivedLatency(!1);n&&(this.copilotChatUiHelper.setIsSkillResponseRequired(!0),Ye.Q.getInstance().recordFluxCopilotStep({operation:v.OP.FluxSkillStart}));const a=e?.body,r=a?.error,i=this.getOdslProgram(a),l=a.responseMetadata,s=a.chatResponse,d=s?.telemetry?.metrics??a?.odslResponse?.telemetry?.metrics,u=s?.sessionKey,m=a?.queryId,g=a?.prompt,h=a?.odslResponse?.prompt,p=a?.raw,b=a?.entities,f=a?.rewrite,T=a?.odslResponse?.outputAnswerLanguage;if((0,o.yw9)("OfficeVSO_9249393_AttributionFromAugLoop")){const e=a?.contentOriginInformationalOnly;this.telemetryLogger.setActiveFeatureWithContentOrigin(e),vn.MK.augloopResponseReceived(m,e,a)}const S=this.getAiResponses(a);let w,E,I,R,A,L,k,F;if(l&&this.logResponseMetadataTelemetry(l),(0,Rt.VI)(l)){const e=l;return[Ge.b.Unsuccessful,Ge.b.ServiceError,Ge.b.ServiceTimeout].includes(e.chatResponseCode)&&vn.MK.augloopErrorReceived(m,e.suggestionMetadata),await(0,Rt.E_)(m,l,this.dispatch)}if((0,Zt.O9)(l))return(0,o.Qyj)()&&(0,Zt.mN)(),void this.dispatch(rt.m.startExecutingCommand({command:v.OP.ElseSkillExecuting}));if(_=l,_?.type===Ge.VF.DocumentGroundingMeta)return void await async function(e){if((0,xn.z)()&&e.tables){const t=e.tables.map((e=>e.sheetQualifiedAddress));await xn.g.getInstance().showGridFoils(t)}}(l);var _;if(S)for(const e of S)if(e.value){const t=e.type;if((0,o.H2A)()&&"pythonAda"===t)w=e.value;else if((0,o.vom)()&&"pythonCalculatedColumns"===t)E=e.value;else if((0,o.geU)()&&"officeJs"===t)I=e.value;else if((0,o.avT)()&&"officeScripts"===t){const t=e.value,n=t.operationType;"run_script"===n&&t.officeScriptsRun?R=t.officeScriptsRun:"save_script"===n&&t.officeScriptsSave?A=t.officeScriptsSave:(0,o.Lap)()&&"schedule_script"===n&&t.officeScriptsSchedule&&(L=t.officeScriptsSchedule)}}if((0,Jt.E)(a)===ze.Yn.getTypeName()&&a.conversationId&&(k=a.conversationId,x.M.conversationId=k,nt.B.conversationId=k,F=a.sydneyEndpoint,(0,jt.cY)(`conversation id from Excel Flux Copilot: ${a.conversationId}`)),f&&(0,jt.cY)(`Rewrite:\n${f}`),g&&(0,jt.cY)(`Prompt:\n${g}`),p&&(0,jt.cY)(`ODSL:\n${p}`),b&&(0,jt.cY)(`Entities:\n${b}`),w&&(0,jt.cY)(`PythonAdaResult:\n${JSON.stringify(w)}`),E&&(0,jt.cY)(`pythonColumnResult:\n${JSON.stringify(E)}`),R&&(0,jt.cY)(`OfficeScript to Run:\n${JSON.stringify(R)}`),A&&(0,jt.cY)(`OfficeScript ODSL to Save:\n${JSON.stringify(A)}`),L&&(0,jt.cY)(`OfficeScript to Schedule:\n${JSON.stringify(L)}`),T&&(0,jt.cY)(`outputLanguage:\n${T}`),I&&(0,jt.cY)(`OfficeJs to run:\n${JSON.stringify(I)}`),this.telemetryEventHandler.updateTelemetryChatEventData({[v.h3.ChatEventType]:v.a5.ResponseReceivedFromAL,...(0,v.j)(dt.CP),[v.h3.ChatEventParameters]:JSON.stringify({annotationType:(0,Jt.E)(a)})},this.telemetryLogger),(0,o.cTR)()&&this.updateDevTelemetry(u,k,F,m,d),r){if(vn.MK.augloopErrorReceived(m,r),!(0,o.thH)())return void await this.handleErrorResponse(r,t,a);if(await this.handleErrorResponse(r,t,a))return}if(w)return(0,Gt.i_)()&&0!==w.response.length?(0,Kt.fL)(v.KZ.Answers):(0,Kt._8)(v.KZ.SubmitPythonAdaQuery),(0,Gt.bh)(h),(0,un.Li)(),dt.CP.pythonContextManager.shouldGenerate?(dt.CP.pythonContextManager.pythonContextBuilder.setPythonPrompt(h),void await this.showPythonAdaCards((0,an.A)(),w,T)):void(0,un.P_)(!1,!0);if(E&&await this.showPythonCalculatedColumn((0,an.A)(),E),I)return this.telemetryLogger.endTriedActivitySuccess(v.q.OfficeJsCommanding),void await(this.officeJsCommanding?.handleOfficeJsResult(m??"",I));if(R){this.telemetryLogger.endTriedActivitySuccess(v.q.OfficeScripts);const{message:e,telemetry:t}=Ct.n.getOfficeScriptErrorResponse((0,c._kX)().replace("{0}",R.scriptNameToRun),Vt.m.RunScript);this.copilotChatUiHelper.displayResponse(e,t,{shouldShowWhenFluxSkillResponseRequired:!1}),this.dispatch((0,lt.nv)((0,ft.N)(e),Ke.Aw.failed,t))}if(A)return this.telemetryLogger.endTriedActivitySuccess(v.q.OfficeScripts),void await this.handleSaveODSLToOfficeScript(A,x.M.userQueryGuid);if(L)return this.telemetryLogger.endTriedActivitySuccess(v.q.OfficeScripts),void await this.handleScheduleOfficeScript(L,x.M.userQueryGuid);if(!i||0===i.length)return s?(s.status===Ve.lC.Success&&(this.telemetryLogger.endTriedActivitySuccess(v.q.CopilotChat),(0,o.ZAR)()&&dt.CP.setHasTFCDeliveredQueryResult()),(0,Zt.xY)(l,this.telemetryLogger),(0,jt.cY)(`chatResponse:\n${JSON.stringify(s)}`),await ye.Z.getInstance().handleChatResponse(s,this.dispatch,k,this.augloopSignalSentTime,F,a?.fromCache,r,m)):(this.telemetryLogger.endTriedActivityFailure(),this.telemetryLogger.logError({eventType:ot.S2.Augloop,errorMessage:"Undefined Program received from Augloop",logLevel:j.$b.Warning}),n&&(0,lt.$U)(Ke.Aw.failed,(0,c._h7)()),(0,o.yw9)("OfficeVSO_10215994_TerminateQueryOnGenericFailure")&&(x.M.getInstance().logStandardizedAshaErrorEvent(y.W.UI_Failed_To_Update_Or_Load,C.c.Augloop_Error_Occurred_No_Chat_Response,this.telemetryLogger.getActiveFeature()),this.dispatch((0,lt.L4)(!1,!1)),(0,Se.s_)(Se.H0.EnableApply)),void ye.Z.getInstance().endUserPerceivedLatency(!1));const P=JSON.stringify(i.map((e=>(e.argumentsArray=void 0,e))),void 0,4);(0,jt.cY)(`Program:\n${P}`);const N=(new Date).getTime();await this.executeOdsl(i,x.M.userQueryGuid,T),this.telemetryEventHandler.logLatency((0,v.xJ)(N),v.OP.QueryExecution)}async handleSaveODSLToOfficeScript(e,t){this.dispatch(rt.m.setLatestRequestId(t)),this.dispatch(rt.m.startExecutingCommand({command:v.OP.CreateOfficeScripts}));const{success:n,intents:a,scriptToSave:o}=await(0,Qt.I)(e,t);if(n&&o){const{message:e,telemetry:n}=Ct.n.getOfficeSaveScriptHiTL(a,o,t,!1,this.dispatch);this.copilotChatUiHelper.displayResponse(e,n,{shouldShowWhenFluxSkillResponseRequired:!0});const{message:r,telemetry:i}=Ct.n.getOfficeSaveScriptHiTL(a,o,t,!0,this.dispatch);this.dispatch((0,lt.nv)((0,ft.N)(r),Ke.Aw.success,i))}else{const{message:e,telemetry:t}=Ct.n.getOfficeScriptErrorResponse((0,c.CPY)(),Vt.m.SaveScript);this.copilotChatUiHelper.displayResponse(e,t,{shouldShowWhenFluxSkillResponseRequired:!1}),this.dispatch((0,lt.nv)((0,ft.N)(e),Ke.Aw.failed,t))}}async handleScheduleOfficeScript(e,t){const n=(e,n)=>{e.isOfficeScriptSkillHandlerError&&(0,tn.hs)(e,"schedule_script",t);const{message:r,telemetry:i}=Ct.n.getOfficeScriptErrorResponse(n,Vt.m.ScheduleScript);this.copilotChatUiHelper.displayResponse(r,i,{shouldShowWhenFluxSkillResponseRequired:!1}),(0,o.yw9)("OfficeVSO_8533885_SharedFluxProcessing")&&this.dispatch((0,lt.nv)((0,ft.N)(r),Ke.Aw.failed,i)),this.telemetryEventHandler.logLatency((0,v.xJ)(a),v.OP.ScheduleOfficeScriptsHiTLShown,!1,v.q.OfficeScripts)};this.dispatch(rt.m.setLatestRequestId(t));const a=(new Date).getTime();let r;try{r=await(0,Qt.TQ)(e.scriptNameToSchedule,t)}catch(t){return void n(t,(0,c.kAS)().replace("{0}",e.scriptNameToSchedule))}try{const{message:n,telemetry:o}=await Ct.n.getOfficeScriptsScheduleScriptHiTLResponse(r,e.schedulePlanExplanation,e.scheduleType,JSON.parse(e.schedulePlan),t);this.copilotChatUiHelper.displayResponse(n,o,{shouldShowWhenFluxSkillResponseRequired:!0}),this.telemetryEventHandler.logLatency((0,v.xJ)(a),v.OP.ScheduleOfficeScriptsHiTLShown,!0,v.q.OfficeScripts)}catch(e){return void n(e,(0,c.mF)())}if((0,o.yw9)("OfficeVSO_8533885_SharedFluxProcessing")){const{message:e,telemetry:t}=Ct.n.getOfficeScriptsScheduleScriptFluxResponse();this.dispatch((0,lt.nv)((0,ft.N)(e),Ke.Aw.success,t))}}async showPythonStartAnalysisCard(e,t){if((0,o.H2A)())try{(0,Kt._8)(v.KZ.SubmitPythonStartAnalysisQuery),this.dispatch(rt.m.setLatestRequestId(e));const n=await(0,Gt.eU)(),a=n!==Excel.CalculationMode.automatic,r=await(0,Gt.RW)();if((0,jt.cY)(`Python Analysis Sheet Metadata: ${r}`),(0,o.yw9)("OfficeVSO_10271339_BlockPythonAAMode")&&(0,Gt.$)())throw(0,zt.fB)();(0,o.iq2)()?Ct.n.displayPythonStartAnalysisButtonExperimentResponse(this.dispatch,e,a,r,t):Ct.n.displayPythonStartAnalysisResponse(this.dispatch,e,a,r,t),(0,Kt.DC)(ot.$.StartAnalysis,n),(0,un.oO)(),dt.CP.pythonContextManager.recalcSheet(!0)}catch(e){let t;t=e instanceof Error&&(0,zt.HH)(e)?(0,zt.j9)(on.O.PythonStartAnalysisEditModeError,"",e):e,(0,zt.Kx)(this.dispatch,t,"showPythonStartAnalysisCard",!0)}}showStartDataShapingCard(e,t,n,a,o,r,i){const l={success:!1,requestId:e,sessionId:t};try{this.dispatch(rt.m.setLatestRequestId(e));const{message:s,telemetry:c}=Ct.n.displayStartDataShapingResponse(e,n,t,a,o,r,i),d=(0,ft.N)(s);this.dispatch((0,lt.nv)(d,Ke.Aw.success,c,!1)),l.success=!0}finally{try{this.dispatch((0,lt.L4)())}catch{}T.E.getInstance().updateTelemetryChatEventData({[v.h3.ChatEventType]:v.a5.DataShapingShowStartCard,[v.h3.ChatEventParameters]:JSON.stringify(l)},x.M.getInstance())}}showDataShapingErrorCard(e,t,n,a,o){const r={success:!1,requestId:e,sessionId:t,errorSource:n,errorCode:a};try{this.dispatch(rt.m.setLatestRequestId(e));const t=this.dispatch((0,lt.SW)());let n=t.started?(0,c.$oZ)():(0,c.A99)();switch(a){case"QueryTable":n=(0,c.bLM)();break;case"StepFromNLFailure":case"QueryFromNLFailure":case"QueryFromNLGiveup":n=(0,c.kSh)();break;case"NoRange":case"TableNotFound":n=(0,c.eMD)();break;case"PowerQueryApiFailure":case"ExplanationFailure":case"BaseQueryFailure":case"UnexpectedError":break;default:(0,bt.x)(a)}const{message:i,telemetry:s}=Ct.n.getDataShapingErrorResponse(n,t.enableDebugging?o:void 0);l.$.getInstance().displayResponse(i,s);const d=(0,ft.N)(i);this.dispatch((0,lt.nv)(d,Ke.Aw.success,s,!1)),r.success=!0}finally{try{this.dispatch((0,lt.L4)())}catch{}T.E.getInstance().updateTelemetryChatEventData({[v.h3.ChatEventType]:v.a5.DataShapingShowErrorCard,[v.h3.ChatEventParameters]:JSON.stringify(r)},x.M.getInstance())}}async enterPythonModeDirectly(e){try{if(dt.CP.pythonContextManager.prePythonModeError)return void(0,zt.Kx)(this.dispatch,dt.CP.pythonContextManager.prePythonModeError,dt.CP.pythonContextManager.prePythonModeErrorFunction??"enterPythonModeDirectly - prePythonModeError",!1,!0);this.dispatch((0,lt.eM)(v.OP.PythonStartAnalysis)),dt.CP.pythonContextManager.enterAdvancedAnalysisMode(),await Ce.p.getInstance().handlePythonStartAnalysis(e)}catch(e){(0,Gt.Tk)(!1),(0,zt.Kx)(this.dispatch,e,"enterPythonModeDirectly",!1,!1,[],!0)}}async showPythonAdaCards(e,t,n){if((0,o.H2A)()){this.dispatch(rt.m.startExecutingCommand({command:v.OP.Python,id:e}));try{this.dispatch(rt.m.setLatestRequestId(e)),(0,o.yw9)("OfficeVSO_10277196_AnswersSkipLicenseCheckFixed")&&(0,Sn.i)()?(0,zt.lB)(n):(0,zt.iY)(n);const a=t.response;(0,Gt.PV)(a);let r=!1;const i=!!(0,Gt.i_)()||(0,Gt.ec)(a,"code");if((0,Gt.ec)(a,"suggestions")){const e=[(0,c.rhr)(),(0,c.DjY)()];this.dispatch((0,lt.dT)(e))}const l=(0,Gt.ec)(a,"code");for(let t=0;t<a.length;t++){let n=!1;const s=a[t],d=s.type;let u,m;switch((0,o.LhK)()&&dt.CP.pythonContextManager.renderedCardCount>=2&&(dt.CP.pythonContextManager.isAutoScrollingEnabled=!1),(0,o.EJJ)()&&(u=(0,fn.C)([s]),m=fn.p.getInstance(this.dispatch)),d){case"text":{const n=s.value.text;if(!n){const e="Text is missing in IPythonAdaTextResponseChunkValue";throw(0,zt.xp)(on.O.PythonMissingResponseValue,e)}if((0,Gt.i_)())m?.updateCard(e,s);else{dt.CP.pythonContextManager.pythonContextBuilder.setLlmText(n);const e=i&&t===a.length-1;Ct.n.displayPythonTextResponse(this.dispatch,n,!0,!1,e,[],u)}r=!0,(0,Kt.DC)(ot.$.Text);break}case"code":{const t=s.value;let n=t.code;const a=t.codeExplanation,i=t.codeLabel;let l="",c=null;if(!n){const e=`Code: ${n?"Defined":"Undefined"} Code Explanation: ${a?"Defined":"Undefined"} Code Label: ${i?"Defined":"Undefined"} in IPythonAdaCodeResponseChunkValue.`;throw(0,zt.xp)(on.O.PythonMissingResponseValue,e)}if((0,Gt.i_)())m?.updateCard(e,s);else{l=await(0,Gt.nC)(this.dispatch,dt.CP),this.dispatch(rt.m.setLatestRequestId(e)),n=(0,Gt.MA)(n,i);const t=new hn(this.dispatch,e,l,n,a,i);if(c=await t.autoInsertPythonFormula(),!dt.CP.pythonContextManager.shouldGenerate)break;const o=rn.ExcelCalc.localAddressesFromSheetAddresses(c);dt.CP.pythonContextManager.lastCodeAndPostViewMessage=Ct.n.displayPythonCodeCardWithPendingPostView(this.dispatch,e,n,l,o,!1,a,i,u)}r=!0,(0,o.vEQ)()&&await(0,Gt.bf)(l,"A2"),(0,Kt.DC)(ot.$.Code);break}case"suggestions":{let e=s.value.suggestions;if((0,o.yw9)("OfficeVSO_10238808_upsell_aa_from_maa_suggestion_pill")&&(0,Gt.i_)()&&!dt.CP.pythonContextManager.isPythonMode&&!(0,Gt.$)()&&(e=[(0,c.fkZ)(),...e]),!e){const e="Suggestions is missing in IPythonAdaSuggestionsResponseChunkValue";throw(0,zt.xp)(on.O.PythonMissingResponseValue,e)}this.dispatch((0,lt.dT)(e)),r=!0,(0,Kt.DC)(ot.$.Suggestions);break}case"finalText":{const l=`Final Text Index: ${t} Total Chunks: ${a.length}`;if(!o.RNg&&t!==a.length-1)throw(0,zt.xp)(on.O.PythonInvalidResponseOrder,l);const c=s.value.finalText;if(!c){const e="Final text is missing in IPythonAdaFinalTextResponseChunkValue";throw(0,zt.xp)(on.O.PythonMissingResponseValue,e)}(0,Gt.i_)()?m?.updateCard(e,s):(dt.CP.pythonContextManager.pythonContextBuilder.setFinalResponse(c),Ct.n.displayPythonTextResponse(this.dispatch,c,!0,!1,i,[],u)),r=!0,n=!0,(0,Kt.DC)(ot.$.FinalText),((0,o.vEQ)()||(0,o.o2C)())&&(dt.CP.pythonContextManager.disableAutoScroll=!1);break}case"debugText":break;case"status":{const t=(0,o.L_n)(),a=(0,o.Xsz)();if(r=!0,!t){const e="Python response type status is not supported.";throw(0,zt.xp)(on.O.PythonUnsupportedResponseType,e)}const i=s.value,l=Tn(i.status),c=i.shouldStopLoadingUi;a?""!==l?(Ct.n.displayPythonTextResponse(this.dispatch,l,!1,!1,c,[],u),n=c,(0,Kt.DC)(ot.$.StatusMessage)):c&&(await this.dispatch((0,lt.L4)()),n=!0):c&&(i.status===Ut.r.AnswersLlmLoopLimitHit?m?.dismissLoadingUI(e):await this.dispatch((0,lt.L4)()),n=!0),n&&m?.resetCard();break}default:{const e=`Python response type ${d} is not supported.`;throw(0,zt.xp)(on.O.PythonUnsupportedResponseType,e)}}(0,un.tW)(t,l,n)}if(0===t.response.length&&!dt.CP.pythonContextManager.isPythonMode){if((0,o.yw9)("OfficeVSO_10277196_AnswersSkipLicenseCheckFixed")&&!(0,Gt.Gd)())return void(0,zt.Kx)(this.dispatch,(0,zt.XO)(),"showPythonStartAnalysisCard",!1);return void(Ce.p.getInstance().getQueryOriginValue()===Qe.Rk.MsFormsSDX?(nt.B.getInstance().logSeenEvent(v.q.Python),this.enterPythonModeDirectly(v.BC.MsFormsSDX)):this.showPythonStartAnalysisCard(e,!1))}if(!r)throw(0,zt.xp)(on.O.PythonResponseAllDebugChunks);i&&Ce.p.getInstance().deductCopilotCredit(e)}catch(e){(0,zt.Kx)(this.dispatch,e,"showPythonAdaCards",!0)}}}async showPythonCalculatedColumn(e,t){if(!(0,o.vom)())return;const n=e=>{const{message:t,telemetry:n}=Ct.n.getPythonColumnSuggestionErrorResponse(e);l.$.getInstance().displayResponse(t,n);const a=(0,ft.N)(t);this.dispatch((0,lt.nv)(a,Ke.Aw.failed,n,!1)),this.dispatch((0,lt.L4)())};this.dispatch(rt.m.startExecutingCommand({command:v.OP.PythonCalculatedColumn,id:e}));try{this.dispatch(rt.m.setLatestRequestId(e));const a=dt.CP.getActiveTable(),o=a?.sheetRange.sheet,r=a?.address,i="number"==typeof a?.sheetRange.range.topLeft.column?function(e,t,n){const a=n?1:0;return(0,Yt.z)(t+e+a)}(a.numColumns,a.sheetRange.range.topLeft.column,!0):void 0;if(!o||!r||!i)return void n((0,c.gg6)());if(a.tableLikeRange)return void n((0,c.YvV)());const s=async()=>{const n=(0,c.Nbb)(),{message:a,telemetry:s}=Ct.n.getInsertSuggestionUserChat(n);l.$.getInstance().displayResponse(a,s);try{const n=new bn(this.dispatch,e,o,r,i,t.code,t.codeExplanation,t.columnName),a=v.OP.InsertPythonCalculatedColumn;this.dispatch((0,lt.eM)(a)),this.dispatch(rt.m.setLatestRequestId((0,an.A)())),await n.autoInsertPythonFormula()}catch(e){const{message:t,telemetry:n}=Ct.n.getPythonColumnInsertErrorResponse(e,(0,c.JIA)());l.$.getInstance().displayResponse(t,n)}finally{this.dispatch((0,lt.L4)())}},{message:d,telemetry:u}=Ct.n.getPythonCalculatedColumnSuggestionResponse(e,t,r,i,o,s);l.$.getInstance().displayResponse(d,u);const m=(0,ft.N)(d);this.dispatch((0,lt.nv)(m,Ke.Aw.success,u,!1))}catch(e){(0,zt.Kx)(this.dispatch,e,"showPythonAdaCards",!0)}finally{this.dispatch((0,lt.L4)())}}getAiResponses(e){return e?.odslResponse?.aiResponses}getOdslProgram(e){return e?.odslResponse?.odsl?.statements}async executeOdsl(e,t,n){try{this.dispatch(rt.m.setLatestRequestId(t));const r=new je.K,i=await r.convert(e,this.copilotChatUiHelper.getLastUserUtterance()),l=new Ht(i);if((0,a.kc)(i)){this.telemetryLogger.endTriedActivityFailure();const e=(0,c.CDl)(),{message:t,telemetry:n}=Ct.n.getMultipleEventsErrorResponse(e);this.copilotChatUiHelper.displayResponse(t,n,{shouldShowWhenFluxSkillResponseRequired:!1});const a=(0,ft.N)(t);return void this.dispatch((0,lt.nv)(a,Ke.Aw.failed,n))}(0,a.qw)(i)&&(0,o.avT)()&&qt.y.getInstance().pushOdslCache("",e),await(0,st.$r)((0,c.Eyh)());const s=i.some((e=>e.agent===Xe.w2.Insights)),d={happened:!1,id:void 0};let u=!1;const m=new Promise(((e,t)=>{d.id=setTimeout((()=>{d.happened=!0,e(d)}),yn.R.getOdslExecutionTimeout(s,dt.CP.getActiveTableRowNumber()))})),g=l.execute(d,t,this.dispatch,(e=>this.handleODSLExecutionError(e)),n).finally((()=>{d.id&&clearTimeout(d.id),u=!0}));await Promise.race([m,g]),u||await g,await(0,st.TA)()}catch(e){await this.handleODSLExecutionError(e)}}async handleODSLExecutionError(e){const t=this.telemetryLogger.getActiveFeature();if(e.isOnlyUnsupportedEventsError&&e.unsupportedTypes.length>0)return Xt(this.dispatch,e.unsupportedTypes),(0,o.yw9)("OfficeVSO_8814792_LogAshaCommandingTelemetry")&&x.M.getInstance().logStandardizedAshaErrorEvent(y.W.Missing_Copilot_Functionality,C.c.ODSL_Execution_Failed_Due_To_Unsupported_Commands,t),Promise.resolve();if(e.isMultipeEventsExecutionError){const e=(0,c.Rff)(),{message:n,telemetry:a}=Ct.n.getMultipleEventsErrorResponse(e,{showUndo:!0},t);this.copilotChatUiHelper.displayResponse(n,a,{shouldShowWhenFluxSkillResponseRequired:!1});const o=(0,ft.N)(n);return this.dispatch((0,lt.nv)(o,Ke.Aw.failed,a)),x.M.getInstance().logStandardizedAshaErrorEvent(y.W.User_Input_Could_Not_Be_Processed,C.c.ODSL_Execution_Failed_With_Multiple_Events,t),Promise.resolve()}const n=!(0,o.yw9)("OfficeVSO_9612368_ExcludeAshaForHandoffToElse")||t!==v.BJ.Commanding&&t!==v.BJ.ConditionalFormatting;if(e.isConverterError&&(this.telemetryLogger.endTriedActivityFailure(),await this.handleConverterError(e,n)))return Promise.resolve();if(e.isHumanInTheLoopError&&(this.telemetryLogger.endTriedActivityFailure(),await this.handleHumanInTheLoopError(e)))return Promise.resolve();(0,We.iG)(e)&&this.telemetryLogger.assertFeatureIsActive(v.BJ.Commanding,"handleODSLExecutionError: isCommandingError returned true but Commanding is not the active feature");const a=(0,We.ip)(e),r=a?(0,c.OX0)():(0,c.BVu)(),{message:i,telemetry:l}=Ct.n.getOdslExecutionFailedResponse(r,v.q0.OdslExecutionFailed);n&&(a?x.M.getInstance().logStandardizedAshaErrorEvent(y.W.User_Input_Could_Not_Be_Processed,C.c.ODSL_Execution_Failed_Due_To_Payload_Too_Large,t):e.isConverterError?x.M.getInstance().logStandardizedAshaErrorEvent(y.W.User_Input_Could_Not_Be_Processed,C.c.ODSL_Execution_Failed_Due_To_Converter_Error,t):x.M.getInstance().logStandardizedAshaErrorEvent(y.W.Unable_To_Complete_Task,C.c.ODSL_Execution_Failed_General_Error,t)),this.copilotChatUiHelper.displayResponse(i,l,{shouldShowWhenFluxSkillResponseRequired:!1,logAshaError:n});const s=(0,ft.N)(i);return this.dispatch((0,lt.nv)(s,Ke.Aw.failed,l)),this.dispatch((0,lt.Nl)()),Promise.resolve()}async handleHumanInTheLoopError(e){let t=(0,c.ir3)(),n=C.c.Missing_HITL_Intent_String,a=v.q0.OdslExecutionFailed;e.failureType===We.UP.NoActiveTable&&(t=(0,c.SCL)(),n=C.c.ODSL_Execution_Failed_Due_To_Out_Of_Scope_Targets,a=v.q0.NoTableLikeEntityFound);const r=(0,o.yw9)("OfficeVSO_9631333_FixHiTLErrorToElse"),{message:i,telemetry:l}=Ct.n.getOdslExecutionFailedResponse(t,a);let s;return r||this.copilotChatUiHelper.displayResponse(i,l,{shouldShowWhenFluxSkillResponseRequired:!0}),s=r?JSON.stringify({text:c.qbK.HumanInTheLoop.Error}):JSON.stringify({text:c.qbK.HumanInTheLoop.Error,publishPreference:sn.f$.Never}),this.dispatch((0,lt.nv)(s,Ke.Aw.failed,l)),r||x.M.getInstance().logStandardizedAshaErrorEvent(y.W.Missing_Copilot_Functionality,n,v.BJ.Commanding),!0}async handleConverterError(e,t){if(!e?.failureType)return!1;let n="",a=!1,r=C.c.ODSL_Execution_Failed_Due_To_Converter_Error,i=y.W.User_Input_Could_Not_Be_Processed;switch(e.failureType){case We.tJ.General:break;case We.tJ.ColumnRowOutOfBoundary:n=(0,c.dw7)(),a=!0,r=C.c.ODSL_Execution_Failed_Due_To_Out_Of_Scope_Targets,i=y.W.Missing_Copilot_Functionality;break;case We.tJ.ColumnRowBySelection:n=(0,c.pwZ)(),a=!0,r=C.c.ODSL_Execution_Failed_Due_To_Out_Of_Scope_Prompt,i=y.W.Missing_Copilot_Functionality;break;case We.tJ.ConditionalFormatFormulaInvalid:n=(0,c.T0z)(),a=!0,r=C.c.Conditional_Formatting_Failed_Due_To_Invalid_Formula,i=y.W.Unable_To_Complete_Task;break;case We.tJ.ConditionalFormatFormulaExplanationInvalid:n=(0,c.T0z)(),a=!0,r=C.c.Conditional_Formatting_Failed_Due_To_Invalid_Formula_Explanation,i=y.W.Unable_To_Complete_Task;break;case We.tJ.ClearSortUnsupported:n=(0,c.uy0)(),a=!0,r=C.c.ODSL_Execution_Failed_Due_To_Out_Of_Scope_Prompt,i=y.W.Missing_Copilot_Functionality;break;case We.tJ.NoColumnArgument:case We.tJ.ColorDistanceExceededThreshold:break;case We.tJ.DeleteUnexpectedTableRows:n=(0,c.EoV)(),a=!0,r=C.c.ODSL_Execution_Failed_Due_To_Out_Of_Scope_Prompt,i=y.W.Missing_Copilot_Functionality;break;case We.tJ.DeleteWithInsertColumns:n=(0,c.uvk)(),a=!0,r=C.c.ODSL_Execution_Failed_Due_To_Out_Of_Scope_Prompt,i=y.W.Missing_Copilot_Functionality;break;case We.tJ.MultipleTableStructureChanges:n=(0,c.nKX)(),a=!0,r=C.c.ODSL_Execution_Failed_Due_To_Out_Of_Scope_Prompt,i=y.W.Missing_Copilot_Functionality;break;case We.tJ.NoSupportedNumberFormatCategoriesNumber:n=(0,c.Pot)(),a=!0,r=C.c.Conditional_Formatting_Failed_Due_To_Invalid_Targets,i=y.W.Unable_To_Complete_Task;break;case We.tJ.NoActiveTable:n=(0,c.SCL)(),a=!0,r=C.c.ODSL_Execution_Failed_Due_To_Out_Of_Scope_Targets,i=y.W.Missing_Copilot_Functionality;break;case We.tJ.NoSupportedNumberFormatCategoriesDate:n=(0,c.aYy)(),a=!0,r=C.c.Conditional_Formatting_Failed_Due_To_Invalid_Targets,i=y.W.Unable_To_Complete_Task;break;case We.tJ.NoSupportedNumberFormatCategoriesText:n=(0,c.nx1)(),a=!0,r=C.c.Conditional_Formatting_Failed_Due_To_Invalid_Targets,i=y.W.Unable_To_Complete_Task;break;case We.tJ.NoSupportedNumberFormatCategoriesOther:n=(0,c.SS1)(),a=!0,r=C.c.Conditional_Formatting_Failed_Due_To_Invalid_Targets,i=y.W.Unable_To_Complete_Task;break;case We.tJ.NoVisibleRange:n=(0,c._ZG)(),a=!0,r=C.c.ODSL_Execution_Failed_Due_To_Out_Of_Scope_Targets,i=y.W.Missing_Copilot_Functionality;break;case We.tJ.NumericFilterOnNonNumberError:n=(0,c.Ehc)(),a=!0,r=C.c.ODSL_Execution_Failed_Due_To_Invalid_Targets,i=y.W.Unable_To_Complete_Task;break;case We.tJ.TextualFilterOnNonTextError:n=(0,c.Ykh)(),a=!0,r=C.c.ODSL_Execution_Failed_Due_To_Invalid_Targets,i=y.W.Unable_To_Complete_Task;break;case We.tJ.VariableCacheEntityTypeMismatched:n=(0,c.xk_)(),a=!0,r=C.c.ODSL_Execution_Failed_Due_To_Entity_Type_Mismatch,i=y.W.Unable_To_Complete_Task}if(a){const{message:e,telemetry:a}=Ct.n.getOdslExecutionFailedResponse(n,v.q0.OdslExecutionFailed);this.copilotChatUiHelper.displayResponse(e,a,{shouldShowWhenFluxSkillResponseRequired:!1,logAshaError:!(0,o.yw9)("OfficeVSO_9750946_DoNotLogASHABeforeElseHandoff")||t});const l=(0,ft.N)(e);this.dispatch((0,lt.nv)(l,Ke.Aw.failed,a)),(0,o.yw9)("OfficeVSO_8814792_LogAshaCommandingTelemetry")&&t&&x.M.getInstance().logStandardizedAshaErrorEvent(i,r,this.telemetryLogger.getActiveFeature()),await this.dispatch((0,lt.L4)(!1))}return a}updateDevTelemetry(e,t,n,a,o){e&&this.dispatch(nn.m.setAugLoopSessionKey(e)),t&&this.dispatch(nn.m.setSydneyConversationId(t)),n&&this.dispatch(nn.m.setSydneyEndpoint(n)),a&&o&&o.length>0&&this.dispatch(nn.m.addQueryMetrics({queryId:a,metrics:o}))}logResponseMetadataTelemetry(e){switch(e.type){case Ge.VF.ElseResponseMeta:return void(0,Zt.OP)(e);case Ge.VF.CopilotChatResponseMeta:return void en(e);case Ge.VF.DocumentGroundingMeta:return void function(){const e=T.E.getInstance(),t=x.M.getInstance();e.updateTelemetryChatEventData({[v.h3.ChatEventType]:v.a5.DocumentGroundingShown},t)}();case Ge.VF.FormulaResponseMeta:return void(0,Rt.tb)(e);default:return void x.M.getInstance().logError({eventType:ot.S2.Error,errorMessage:`Unknown ResponseMetadata type - ${e.type}`,logLevel:j.$b.Error})}}showUnsupportedTLRSuggestionListIfNeeded(e){(0,o.tgf)()&&e.errorType===v.q0.UnsupportedTabularRange&&e.errorDetails?.TabularRangeUnsupportedFeature&&this.dispatch((0,lt.x4)(e.errorDetails.TabularRangeUnsupportedFeature))}constructor(e){this.telemetryLogger=x.M.getInstance(),this.telemetryEventHandler=T.E.getInstance(),this.augloopSignalSentTime=null,this.canceledQueryIds=[],this.copilotChatUiHelper=l.$.getInstance(),this.isFirstResponse=!0,this.dispatch=e,(0,o.geU)()&&(this.officeJsCommanding=new Je.$v(e)),this.scratchpad=new Cn.O(e)}}var En=n(363747),In=n(204419),Rn=n(830463),An=n(14838),Ln=n(641565),kn=n(192207),Fn=n(174116),_n=n(430459),Pn=n(282667),Nn=n(905666),Mn=n(754949),On=n(845746);const Dn=(e,t)=>e?.length>50?I.createElement(I.Fragment,null,I.createElement("span",{title:e},t?(0,jt.Yp)(e):e),I.createElement(Pn.i,{getClipboardItem:async()=>new ClipboardItem({"text/plain":new Blob([e],{type:"text/plain"})})})):I.createElement("span",null,e??"-"),Bn=e=>{try{return JSON.stringify(e,void 0,4)}catch(t){return e}},$n=(e,t,n)=>I.createElement("div",null,I.createElement(Nn.B,{horizontal:!0,horizontalAlign:"space-between"},I.createElement("span",{style:{maxWidth:"90%",overflow:"hidden"},title:e},e),I.createElement("span",{style:{color:n,paddingRight:"3px"}},Dn(t,!0)))),Hn=(e,t)=>$n(e,t?"Active":"Inactive",t?"green":"red");function Un(){const e=_n.$.getInstance(),[t,n]=(0,I.useState)(e.updatesFromAugloopCount),[a,o]=(0,I.useState)(e.blockAnnotationReleaseMessageEnabled),[r,i]=(0,I.useState)(e.autoRefreshEnabled),l=e.getSessionsMap(),s=()=>{n(t+1)};return e.registerUIUpdater(s),I.createElement("div",{className:"AugloopDiganosticsPaneContainer"},I.createElement(Mn.K,{title:"Force Refresh",iconProps:{iconName:"Refresh"},onClick:async()=>{await e.refreshSessionDiagnosticsData(),s()}}),I.createElement(On.d,{checked:r,onChange:t=>{e.autoRefreshEnabled=t.currentTarget.checked,i(t.currentTarget.checked),x.M.getInstance()?.logEvent({eventType:ot.S2.AugloopDiagnostics,eventData:[{key:ot.A.AutoRefreshEnabled,value:t.currentTarget.checked}]})},label:"Auto Refresh",title:"Auto refresh the diagnostics on websocket activity"}),I.createElement(On.d,{checked:a,onChange:t=>{e.blockAnnotationReleaseMessageEnabled=t.currentTarget.checked,o(t.currentTarget.checked)},label:"Block Annotations Release",title:"CommunicationHandler to block annotations release messages"}),I.createElement("ul",{className:"tree"},Array.from(l.keys()).map((e=>{const t=l.get(e);return I.createElement("li",{key:e},I.createElement("details",{open:!0},I.createElement("summary",null,"SessionKey: ",e),Hn("Status:",t.isActive),I.createElement("ul",null,I.createElement("li",null,I.createElement("details",null,I.createElement("summary",null,"Session Info"),I.createElement("ul",null,I.createElement("li",null,$n("sessionMode",t.sessionMode)),I.createElement("li",null,$n("isCopilotLicensed",t.isCopilotLicensed?.toString())),I.createElement("li",null,$n("isCopilotActivated",t.isCopilotActivated?.toString())),I.createElement("li",null,$n("isLargeWorkbookSession",t.isLargeWorkbookSession?.toString())),I.createElement("li",null,$n("observerSessionType",t.observerSessionType)),I.createElement("li",null,$n("ecsSessionId",t.ecsSessionId)),I.createElement("li",null,$n("ecsStateId",t.ecsStateId)),I.createElement("li",null,$n("uiLanguage",t.clientMetadata?.uiLanguage)),I.createElement("li",null,$n("docSessionId",t.clientMetadata?.docSessionId)),I.createElement("li",null,$n("documentId",t.clientMetadata?.documentId)),I.createElement("li",null,I.createElement("details",null,I.createElement("summary",null,"Client Flights"),I.createElement("ul",null,t.clientMetadata?.flights?.split(";").map((e=>{if(0!==e.length)return I.createElement("li",{key:e},Dn(e,!1))})))))))),I.createElement("li",null,I.createElement("details",null,I.createElement("summary",null,"Annotations Status"),I.createElement("ul",null,Array.from(t.annotationActivationStatus.keys()).map((e=>I.createElement("li",{key:e},Hn(e,t.annotationActivationStatus.get(e)))))))),I.createElement("li",null,I.createElement("details",null,I.createElement("summary",null,"Annotations Activations (",t.activatedAnnotationTypes.size,"):"),I.createElement("ul",null,Array.from(t.activatedAnnotationTypes.keys()).map((e=>I.createElement("li",{key:e},$n(e,t.activatedAnnotationTypes.get(e)))))))),I.createElement("li",null,I.createElement("details",null,I.createElement("summary",null,"Annotations Releases (",t.releasedAnnotationTypes.size,"):"),I.createElement("ul",null,Array.from(t.releasedAnnotationTypes.keys()).map((e=>I.createElement("li",{key:e},$n(e,t.releasedAnnotationTypes.get(e)))))))),I.createElement("li",null,I.createElement("details",null,I.createElement("summary",null,"Annotations Received (",t.annotationsReceived.size,"):"),I.createElement("ul",null,Array.from(t.annotationsReceived.keys()).map((e=>{const n=t.annotationsReceived.get(e).length;return I.createElement("li",{key:e},I.createElement("details",null,I.createElement("summary",null,`${e} (${n})`),I.createElement("ul",null,Array.from(t.annotationsReceived.get(e)??[]).map((e=>{const t=JSON.stringify(e);return I.createElement("li",{key:t},I.createElement("details",null,I.createElement("summary",null,Dn(t,!0)),I.createElement("pre",null,Bn(e))))})))))}))))),I.createElement("li",null,I.createElement("details",null,I.createElement("summary",null,"Custom Messages Sent (",t.clientSentMessages.size,"):"),I.createElement("ul",null,Array.from(t.clientSentMessages.keys()).map((e=>I.createElement("li",{key:e},I.createElement("details",null,I.createElement("summary",null,`${e} (${t.clientSentMessages.get(e)?.length})`),I.createElement("ul",null,Array.from(t.clientSentMessages.get(e)).map((e=>{const t=JSON.stringify(e);return I.createElement("li",{key:t},I.createElement("details",null,I.createElement("summary",null,Dn(t,!0)),I.createElement("pre",null,Bn(e))))})))))))))),I.createElement("li",null,I.createElement("details",null,I.createElement("summary",null,"Connection Messages (",t.connectionMessages.length,"):"),I.createElement("ul",null,t.connectionMessages.map((e=>{const t=JSON.parse(e);return I.createElement("li",{key:e},I.createElement("details",null,I.createElement("summary",null,Dn(e,!0)),I.createElement("pre",null,Bn(t))))}))))))))}))))}var qn=n(1344);const Vn="http://www.w3.org/2000/svg";class Wn{constructor(e,t){this.name=e,this.label=JSON.stringify(t,void 0,4),this.path=[...t.parentPath,t.id],this.parentPath=t.parentPath,this.children=[],this.hidden=!1,this.numberOfRows=0}}function Gn(e){0===e.children.length?e.numberOfRows=1:(e.numberOfRows=e.children.filter((e=>!e.hidden)).reduce(((e,t)=>(Gn(t),e+t.numberOfRows)),0),0===e.numberOfRows&&(e.numberOfRows=1))}function zn(e){return 0===e.children.length?1:1+Math.max(...e.children.map(zn))}function Qn(e,t){const n=function(e){let t;const n=new Map;if(e.forEach((e=>{const t=new Wn(e.id,e);n.set(t.path.join("/"),t)})),Array.from(n.keys()).forEach((e=>{const a=n.get(e);if(0===a.parentPath.length)t=a;else{const t=a.parentPath.join("/"),o=n.get(t);if(!o)throw new Error(`mapAugloopModelToTreeNode: Parent node not found for node ${e}`);o.children.push(a)}})),!t)throw new Error("mapAugloopModelToTreeNode: Root node not found");return t}(t),a=document.createElementNS(Vn,"svg"),o=document.createElementNS(Vn,"g");o.setAttribute("transform","translate(40,0)"),a.appendChild(o);const r=e=>30*e.numberOfRows;function i(e,t,n,a){if(e.hidden)return;const r=document.createElementNS(Vn,"g");r.setAttribute("transform",`translate(${t},${n})`);const s=document.createElementNS(Vn,"title");s.textContent=e.label,r.appendChild(s);const c=document.createElementNS(Vn,"circle");c.setAttribute("r","6"),c.setAttribute("fill",0===e.children?.length?"#dddddd":"#8096c3"),r.appendChild(c);const d=document.createElementNS(Vn,"text");if(d.setAttribute("dy","3"),d.setAttribute("x",8..toString()),d.setAttribute("fill","black"),d.textContent=(0,jt.Yp)(e.name),r.appendChild(d),e.children.length>0){r.style.cursor="pointer",r.addEventListener("click",(()=>{e.children.forEach((e=>{e.hidden=!e.hidden})),l()}));const s=t+260;let c=n-e.numberOfRows/2*25;e.children.filter((e=>!e.hidden)).forEach((e=>{const r=c+e.numberOfRows/2*25;c=r+e.numberOfRows/2*25;const l=function(e,t,n,a){const o=document.createElementNS(Vn,"path"),r=Math.abs(n-e)/2,i=`M${e},${t} C${e+r},${t} ${n-r},${a} ${n},${a}`;return o.setAttribute("d",i),o.setAttribute("stroke","#dddddd"),o.setAttribute("fill","none"),o.setAttribute("class","link"),o}(t,n,s,r);o.appendChild(l),i(e,s,r,a+1)}))}o.appendChild(r)}function l(){for(;o.firstChild;)o.removeChild(o.firstChild);if(!n)throw new Error("updateTree: Tree is undefined");Gn(n);const e=268*zn(n),t=r(n);a.setAttribute("width",e.toString()),a.setAttribute("height",t.toString()),i(n,0,t/2,0)}l(),e.replaceChildren(a),null!==e.parentElement&&(e.parentElement.scrollTop+=r(n)/2)}const jn=async()=>{try{const e=_n.$.getInstance(),t=await e.retrieveModelFromAugloop();if(void 0===t.stringifiedModel)throw new Error("showModelVisualization: Stringified model is undefined");const n=JSON.parse(t.stringifiedModel),o=document.getElementById("augloopModelContainer");if(!o)return void(0,a.cY)(j.$b.Error,"Model container element not found");Qn(o,n)}catch(e){(0,a.cY)(j.$b.Error,`Failed to visualize model: ${e}`)}};function Jn(){const e=_n.$.getInstance().getActiveSessionKey();return I.createElement("div",{className:"AugloopDiganosticsPaneContainer"},I.createElement("strong",null,"Active SessionKey:"),I.createElement("br",null),I.createElement("span",null,e),I.createElement("br",null),I.createElement(qn.r,{iconProps:{iconName:"VisioDiagram"},allowDisabledFocus:!0,disabled:e===_n.b,onClick:jn},"Visualize model"),I.createElement("br",null),I.createElement("div",{id:"augloopModelContainer"}))}var Yn=n(211006);class Xn extends vn.KF{async executeTestCase(e){this.updateTestStateDetails(e,"Starting Test Execution");const t=(0,an.A)();return e.context=await dt.CP.getContextString(t),this.updateTestStateDetails(e,"Workbook Context Extracted"),!0}async startTestCase(e){return await dt.CP.runWithNoContextRefresh((()=>super.startTestCase(e)))}async run(){for(const[e,t]of this.tests.entries())try{await(0,a.uk)(2e3);let e=!0;if(e=await this.startTestCase(t).catch((e=>this.failTest(t,new vn.GM(e)))).finally((async()=>await(0,a.uk)(2e3))),!e)continue;if(e=await this.executeTestCase(t).then((()=>(this.passTest(t),!0))).catch((e=>this.failTest(t,e))),!e)continue}catch(e){this.failTest(t,new vn.xR(this.run.name,e))}const e=JSON.stringify(this.finishedTests.map((e=>e.test.worked?{...e.test}:{...e.test,stateDetails:e.stateDetails,errors:e.test.endToEndErrors})));return await(0,Yn.PE)(e,"application/json",`context-${this.testFilename}.json`,this.resultFileDirHandle),this.finishedTests}constructor(e,t,n,a,o,r){super(e,t,n,a,!1,!1,o,(()=>{}),void 0,r)}}var Zn=n(209402),Kn=n(88053),ea=n(565880),ta=n(775623),na=n(301396),aa=n(141213),oa=n(451511),ra=n(63594),ia=n(821806),la=n(719216),sa=n(89924),ca=n(891895),da=n(349590),ua=n(885994),ma=n(849729),ga=n(501466),ha=n(502947),pa=n(569602),ba=n(147487);const fa={width:"100%",height:"200px"},Ca=({isModalOpen:e,setIsModalOpen:t,sessionId:n,commandingResponse:a})=>I.createElement(ra.l,{open:e,onOpenChange:(e,n)=>{t(n.open)}},I.createElement(ia.E,{style:{maxWidth:"1000px",inset:"8px"}},I.createElement(la.R,null,I.createElement(sa.L,{action:I.createElement(ca.z,{action:"close"},I.createElement(Ln.$,{appearance:"subtle","aria-label":"Close",icon:I.createElement(pa.Jtj,null)}))},I.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},I.createElement("span",null,"Commanding Responses"),I.createElement(Ln.$,{"aria-label":"Download",size:"medium",icon:I.createElement(Fn.eiB,null),onClick:()=>(async(e,t)=>{const n=JSON.stringify(Object.entries(t).map((([t,n])=>({query:n.userUtterance,context:n.context,file:e,officeScripts:n.response,worked:n.codeCompletedSuccessfully,queryId:t,returnedMessage:n.returnedMessage})))),a="commanding-responses"+(e?"-"+e:Date.now())+".json";(0,Yn.PE)(n,"application/json",a)})(n,a)},"Download"))),I.createElement(da.C,null,ya(a))))),ya=e=>I.createElement(En.n,{multiple:!0,collapsible:!0},Object.entries(e).map((([e,{userUtterance:t,context:n,response:a,codeCompletedSuccessfully:o,returnedMessage:r}])=>{const i=(e=>{const t=(0,Yn.Hg)(e);return I.createElement(In.A,{value:"context"},I.createElement(Rn.u,null,"Context"),I.createElement(An.v,null,I.createElement(Nn.B,{horizontal:!0},I.createElement(ga.T,{contentEditable:!1,resize:"vertical",style:fa},t),I.createElement(Ie.m,{content:"Copy",relationship:"label"},I.createElement(Ln.$,{"aria-label":"Copy",icon:I.createElement(kn.k8e,null),onClick:()=>(0,Yn.lW)(t)})))))})(n),l=(e=>e?I.createElement(In.A,{value:"response"},I.createElement(Rn.u,null,"Response"),I.createElement(An.v,null,I.createElement(Nn.B,null,I.createElement(ua.D,{label:"Office Scripts Code"},I.createElement(Nn.B,{horizontal:!0},I.createElement(ga.T,{contentEditable:!1,resize:"vertical",style:fa},e.code),I.createElement(Ie.m,{content:"Copy",relationship:"label"},I.createElement(Ln.$,{"aria-label":"Copy",icon:I.createElement(kn.k8e,null),onClick:()=>(0,Yn.lW)(e.code)})))),I.createElement(ua.D,{label:"Code Explanation"},I.createElement(Nn.B,{horizontal:!0},I.createElement(ga.T,{contentEditable:!1,resize:"vertical",style:fa},e.codeExplanation),I.createElement(Ie.m,{content:"Copy",relationship:"label"},I.createElement(Ln.$,{"aria-label":"Copy",icon:I.createElement(kn.k8e,null),onClick:()=>(0,Yn.lW)(e.codeExplanation)})))),I.createElement(ua.D,{label:"Metadata"},I.createElement(Nn.B,{horizontal:!0},I.createElement(ga.T,{contentEditable:!1,resize:"vertical",style:fa},JSON.stringify({returnsValue:e.returnsValue,canMakeChanges:e.canMakeChanges,...e.apiUsageMetadata??{}},null,2))))))):I.createElement("span",{style:{color:"red"}},"No Response"))(a),s=[];return a&&void 0!==o&&(s.push((e=>e?I.createElement("span",{style:{color:"green"}},"Code Ran Successfully"):I.createElement("span",{style:{color:"red"}},"Code Run Failed"))(o)),r&&s.push((e=>I.createElement(In.A,{value:"returnedMessage"},I.createElement(Rn.u,null,"Returned From Code Completion"),I.createElement(An.v,null,I.createElement(Nn.B,{horizontal:!0},I.createElement(ga.T,{contentEditable:!1,resize:"vertical",style:fa},e),I.createElement(Ie.m,{content:"Copy",relationship:"label"},I.createElement(Ln.$,{"aria-label":"Copy",icon:I.createElement(kn.k8e,null),onClick:()=>(0,Yn.lW)(e)}))))))(r))),I.createElement(In.A,{key:e,value:e},I.createElement(Rn.u,{icon:I.createElement(ba.Roy,null),size:"large",style:{overflow:"hidden"}},(0,Yn.tx)(t,e)),I.createElement(An.v,null,I.createElement(En.n,{multiple:!0,collapsible:!0},i,l,...s)))})));var va=n(767508),Ta=n(321627),xa=n(887648);const Sa=(0,d.n)({devStack:{margin:"32px"}}),wa=e=>{window.open(e,"_blank")},Ea=({isModalOpen:e,setIsModalOpen:t,sessionId:n,augloopSessionKey:a,sydneyConversationId:o,sydneyEndpoint:r,dialogMountNode:i})=>{const l=`https://devui.sdf-devui.substrate-turing-enterprisedevui.eastus-sdf.cosmic-ppe.office.net/?entryPoint=shareUI&sourceConversationId=${o}`,s=`https://dataexplorer.azure.com/dashboards/c5389d47-6569-4e8d-bcec-4057c569820e?p-_sessionIds=v-${n}#19773814-791b-4a1c-a2ef-d1f66b692f6e`;return I.createElement(ra.l,{open:e,onOpenChange:(e,n)=>{t(n.open)}},I.createElement(ia.E,{mountNode:i},I.createElement(la.R,null,I.createElement(sa.L,{action:I.createElement(ca.z,{action:"close"},I.createElement(Ln.$,{appearance:"subtle","aria-label":"Close",icon:I.createElement(pa.Jtj,null)}))},"Session Info"),I.createElement(da.C,null,I.createElement("div",null,I.createElement("b",null,"Session Id:")," ",n,n&&I.createElement(Ie.m,{content:"Copy",relationship:"label"},I.createElement(Ln.$,{"aria-label":"Copy",icon:I.createElement(kn.Jg_,null),appearance:"subtle",onClick:()=>(0,Yn.lW)(n)}))),I.createElement("div",null,I.createElement("b",null,"Augloop Session Key:")," ",a,a&&I.createElement(Ie.m,{content:"Copy",relationship:"label"},I.createElement(Ln.$,{"aria-label":"Copy",icon:I.createElement(kn.Jg_,null),appearance:"subtle",onClick:()=>(0,Yn.lW)(a)}))),I.createElement("div",null,I.createElement("b",null,"Sydney Conversation Id:")," ",o,o&&I.createElement(Ie.m,{content:"Copy",relationship:"label"},I.createElement(Ln.$,{"aria-label":"Copy",icon:I.createElement(kn.Jg_,null),appearance:"subtle",onClick:()=>(0,Yn.lW)(o)}))),I.createElement("div",null,I.createElement("b",null,"Sydney Endpoint:")," ",r),I.createElement("div",null,n&&I.createElement("div",null,I.createElement("b",null,"Kusto Dashboard: "),I.createElement(va.N,{onClick:()=>wa(s)},"Excel Copilot Shield Session Explorer"))),I.createElement("div",null,o&&I.createElement("div",null,I.createElement("b",null,"Sydney Dashboard: "),I.createElement(va.N,{onClick:()=>wa(l)},"DevUI Session Explorer")))))))},Ia=({isModalOpen:e,setIsModalOpen:t,sessionId:n,queryMetrics:a,dialogMountNode:o})=>I.createElement(ra.l,{open:e,onOpenChange:(e,n)=>{t(n.open)}},I.createElement(ia.E,{style:{maxWidth:"1000px",inset:"8px"},mountNode:o},I.createElement(la.R,null,I.createElement(sa.L,{action:I.createElement(ca.z,{action:"close"},I.createElement(Ln.$,{appearance:"subtle","aria-label":"Close",icon:I.createElement(pa.Jtj,null)}))},I.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},I.createElement("span",null,"Session Queries"),I.createElement(Ln.$,{"aria-label":"Download",size:"medium",icon:I.createElement(Fn.eiB,null),onClick:()=>(async(e,t)=>{const n=JSON.stringify(t),a="query-telemetry"+(e?"-"+e:"")+".json";(0,Yn.PE)(n,"application/json",a)})(n,a)},"Download"))),I.createElement(da.C,null,Ra(a))))),Ra=e=>I.createElement(En.n,{multiple:!0,collapsible:!0},Object.entries(e).map((([e,{userUtterance:t,metrics:n}])=>I.createElement(In.A,{key:e,value:e},I.createElement(Rn.u,{icon:I.createElement(ba.Roy,null),size:"large",style:{overflow:"hidden"}},(0,Yn.tx)(t,e)),I.createElement(An.v,null,I.createElement(En.n,{multiple:!0,collapsible:!0},n.map(((e,t)=>I.createElement(Aa,{key:t,uniqueId:t,metric:e}))))))))),Aa=({metric:e,uniqueId:t})=>{const n=(0,Yn.zz)(e),[a,o]=(0,I.useState)(!1),r=(0,Yn.Hg)(e.input),i=(0,Yn.Hg)(e.output),l=e.input!==r||e.output!==i;return I.createElement(In.A,{value:t},I.createElement(Rn.u,null,n),I.createElement(An.v,null,I.createElement(Nn.B,null,l&&I.createElement(ua.D,{label:"Formatting"},I.createElement(ma.S,{label:"Skip json extraction?",checked:a,onChange:e=>o(e.currentTarget.checked)})),I.createElement(ua.D,{label:"Input"},I.createElement(La,{content:a?e.input:r})),I.createElement(ua.D,{label:"Output"},I.createElement(La,{content:a?e.output:i})))))};function La({content:e}){return I.createElement(Nn.B,{horizontal:!0},I.createElement(ga.T,{contentEditable:!1,resize:"vertical",style:{width:"100%"},value:e}),I.createElement(Ie.m,{content:"Copy",relationship:"label"},I.createElement(Ln.$,{"aria-label":"Copy",icon:I.createElement(kn.k8e,null),onClick:()=>(0,Yn.lW)(e)})))}function ka({setShouldShowFormulaDevButton:e}){const[t,n]=(0,I.useState)(!1),[a,r]=(0,I.useState)(!1),[i,l]=(0,I.useState)(!1),s=(0,xa.d4)((e=>e.dataAI.shouldShowFormulaDevButton)),c=(0,xa.d4)((e=>e.chat.dataShapingState.enableDebugging)),d=(0,ge.j)(),u=(0,Ta.u)()??"none",{alSessionKey:m,sydneyConversationId:g,sydneyEndpoint:h,queryMetrics:p,commandingResponses:b}=(0,xa.d4)((e=>e.telemetry)),[f,C]=I.useState(null),y=Sa();return I.createElement(Nn.B,{className:y.devStack},(0,o.cTR)()&&I.createElement(I.Fragment,null,I.createElement(Ln.$,{onClick:()=>n(!0)},"Show Session Info"),I.createElement(ha.c,null),I.createElement(Ln.$,{onClick:()=>r(!0)},"Show Query Telemetry"),I.createElement(ha.c,null),(0,o.geU)()&&b&&I.createElement(I.Fragment,null,I.createElement(Ln.$,{onClick:()=>l(!0)},"Show Commanding Responses"),I.createElement(ha.c,null))),I.createElement(On.d,{checked:s,onChange:t=>{e(t.currentTarget.checked)},label:"Formula Dev Button"}),I.createElement(On.d,{checked:c,onChange:e=>{d(rt.m.setDataShapingDebugging(e.currentTarget.checked))},label:"Data Shaping Dev Button"}),t&&I.createElement(Ea,{isModalOpen:t,setIsModalOpen:n,sessionId:u,augloopSessionKey:m,sydneyConversationId:g,sydneyEndpoint:h,dialogMountNode:f}),a&&I.createElement(Ia,{isModalOpen:a,setIsModalOpen:r,sessionId:u,queryMetrics:p,dialogMountNode:f}),i&&b&&I.createElement(Ca,{isModalOpen:i,setIsModalOpen:l,sessionId:u,commandingResponse:b}),I.createElement("div",{ref:C}))}var Fa=n(895522),_a=n(226898);const Pa=(0,d.n)({list:{paddingTop:"4px",paddingBottom:"4px",paddingLeft:"4px",display:"flex",flexDirection:"column",alignItems:"flex-start",backgroundColor:"transparent"},item:{backgroundColor:"transparent","&:hover":{backgroundColor:f.k1.colorNeutralBackground2Hover,color:f.k1.colorNeutralForeground2Hover}}});function Na({setCannedOption:e,getCannedOption:t}){const[n,a]=I.useState({skillOverride:[t()??"no-override"]}),r=Pa();return I.createElement("div",{className:r.list},I.createElement(Fa.c,{checkedValues:n,onCheckedValueChange:(t,{name:n,checkedItems:o})=>{o[0]&&"no-override"!==o[0]?e(o[0]):e(),a({[n]:o})}},I.createElement(_a.s,{name:"skillOverride",value:"flux-chartsAndPivotTables",className:r.item},"Use the Charts and PivotTables skill directly"),I.createElement(_a.s,{name:"skillOverride",value:"flux-textAnalysis",className:r.item},"Use the Text Analysis skill directly"),I.createElement(_a.s,{name:"skillOverride",value:"flux-getInsights",className:r.item},"Use the Analyze Data skill directly (deprecated)"),I.createElement(_a.s,{name:"skillOverride",value:"flux-createCalculatedColumns",className:r.item},"Use the Calculated Columns skill directly"),I.createElement(_a.s,{name:"skillOverride",value:"flux-editDocument",className:r.item},"Use the Commanding skill directly"),(0,o.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.DataShaping",!1)&&I.createElement(_a.s,{name:"skillOverride",value:"flux-dataShaping",className:r.item},"Use the Data Shaping skill directly"),I.createElement(_a.s,{name:"skillOverride",value:"python",className:r.item},"Use the Python skill directly"),I.createElement(_a.s,{name:"skillOverride",value:"flux-createCalculatedCell",className:r.item},"Use the Column Aggregation skill directly"),I.createElement(_a.s,{name:"skillOverride",value:"flux-else",className:r.item},"Use the Else skill directly"),I.createElement(_a.s,{name:"skillOverride",value:"no-override",className:r.item},"No override")))}var Ma=n(994481),Oa=n(16244),Da=n(648982);const Ba={status:-1,conversationSensitivityLabel:{id:"c179f820-d535-4b2f-b252-8a9c4ac14ec6",displayName:"Highly Confidential\\Microsoft Extended",tooltip:"Data is classified and protected. Microsoft Full Time Employees (FTE) and non employees can view, edit and reply.",priority:21,color:"#A80000",isEncrypted:!0},messagesToAddOrReplace:[{actionId:null,action:null,sourceRequestId:null,isCancelOption:!1,text:'enterprise search whats in excel file "FF document.xlsx" ?',author:"user",from:{id:null,name:null,partnerId:null},createdAt:"2024-09-29T13:04:27.4783232+00:00",timestamp:"2024-09-29T13:04:26.168+00:00",locale:"en-us",market:"en-us",region:"us",locationInfo:{timeZone:"America/New_York"},messageId:"7b8a3e38-0634-4ba8-a1b9-627cd449c3cf",requestId:"7b8a3e38-0634-4ba8-a1b9-627cd449c3cf",messageType:"Chat",experienceType:"Default",offense:"None",feedback:{tag:null,updatedOn:null,type:"None"},contentOrigin:"AugmentationLoop",groundingDataCount:0,clientContext:null,inputMethod:"Keyboard",queryAnnotations:[],turnCount:8,citations:[]},{text:'Based on the results from `search_enterprise`, there is an Excel file titled "FF document.xlsx" [1](https://microsoft.sharepoint-df.com/teams/XLIL_team/Shared%20Documents/guyomtov/FF%20document.xlsx?web=1) authored by **Guy Yom Tov**. The file was last modified this morning. The file contains multiple sheets, including "Sheet1" which contains numerical data and text in multiple columns and rows, and "Sheet2" which contains a list of tasks and notes. Another sheet, "Table1", contains a table with columns such as "Campaign Owner", "Campaign Name", "Launch Date", "Campaign Type", "Budget", "Revenue", "Total Users Targeted", and "Engaged Users". The table contains data about various campaigns, their owners, launch dates, types, budgets, revenues, total users targeted, and engaged users [1](https://microsoft.sharepoint-df.com/teams/XLIL_team/Shared%20Documents/guyomtov/FF%20document.xlsx?web=1). Is there anything specific you would like to know about this file?',hiddenText:'Based on the results from `search_enterprise`, there is an Excel file titled "FF document.xlsx" [^1^] authored by **Guy Yom Tov**. The file was last modified this morning. The file contains multiple sheets, including "Sheet1" which contains numerical data and text in multiple columns and rows, and "Sheet2" which contains a list of tasks and notes. Another sheet, "Table1", contains a table with columns such as "Campaign Owner", "Campaign Name", "Launch Date", "Campaign Type", "Budget", "Revenue", "Total Users Targeted", and "Engaged Users". The table contains data about various campaigns, their owners, launch dates, types, budgets, revenues, total users targeted, and engaged users [^1^]. Is there anything specific you would like to know about this file?',author:"bot",createdAt:"2024-09-29T13:04:48.1703965+00:00",timestamp:"2024-09-29T13:04:48.1703965+00:00",messageId:"a9d573f4-1db2-4549-9efc-5bbed7672a97",requestId:"7b8a3e38-0634-4ba8-a1b9-627cd449c3cf",messageType:"Chat",experienceType:"Default",offense:"Unknown",adaptiveCards:[{type:"AdaptiveCard",version:"1.0",body:[{type:"TextBlock",text:'Based on the results from `search_enterprise`, there is an Excel file titled "FF document.xlsx" [1](https://microsoft.sharepoint-df.com/teams/XLIL_team/Shared%20Documents/guyomtov/FF%20document.xlsx?web=1) authored by **Guy Yom Tov**. The file was last modified this morning. The file contains multiple sheets, including "Sheet1" which contains numerical data and text in multiple columns and rows, and "Sheet2" which contains a list of tasks and notes. Another sheet, "Table1", contains a table with columns such as "Campaign Owner", "Campaign Name", "Launch Date", "Campaign Type", "Budget", "Revenue", "Total Users Targeted", and "Engaged Users". The table contains data about various campaigns, their owners, launch dates, types, budgets, revenues, total users targeted, and engaged users [1](https://microsoft.sharepoint-df.com/teams/XLIL_team/Shared%20Documents/guyomtov/FF%20document.xlsx?web=1). Is there anything specific you would like to know about this file?',wrap:!0}]}],actionButtons:[],sourceAttributions:[{providerDisplayName:"FF document",seeMoreUrl:"https://microsoft.sharepoint-df.com/teams/XLIL_team/Shared%20Documents/guyomtov/FF%20document.xlsx?web=1",path:null,referenceMetadata:'{"type":"Excel","typeDescription":"Excel","referenceType":1,"context":"Guy Yom Tov modified on 9/29/24","hasAttachments":false,"refType":"Excel","dataSource":"SharePoint","sourceType":"File","resultSearchType":"Lexical","fromTuring":"","provenance":"SharePoint","itemId":"AAAAABVT5a96BHRInZE2l1Qj0D8HAEBDCM6yMvVOoNAvcu9tJI4AAAAAASMAAEBDCM6yMvVOoNAvcu9tJI4AAAIYZZYAAA2","fileName":"FF document.xlsx","fileType":"xlsx","isEnterprise":true,"sensitivityLabel":{"id":"f42aa342-8706-4288-bd11-ebb85995028c","displayName":"General","tooltip":"Business data which is NOT meant for public consumption. This can be shared with internal employees, business guests and external partners as needed.","priority":2,"color":"#0078D7","isEncrypted":false}}'}],entityRepresentations:[],feedback:{tag:null,updatedOn:null,type:"None"},contentOrigin:"DeepLeo",suggestedResponses:[{text:"What are the details of the campaigns in the 'Table1' sheet?",hiddenText:"DynamicTurnN",author:"user",createdAt:"2024-09-29T13:04:49.0970144+00:00",timestamp:"2024-09-29T13:04:49.0970144+00:00",messageId:"d78be5a0-fbd9-4f24-9b81-c4c3d6ac10bc",messageType:"Suggestion",experienceType:"SuggestionPill",offense:"Unknown",feedback:{tag:null,updatedOn:null,type:"None"},contentOrigin:"SuggestionChipsService",groundingDataCount:0,clientContext:null},{text:"Tell me more about Guy Yom Tov",hiddenText:"DynamicTurnN",author:"user",createdAt:"2024-09-29T13:04:49.0970187+00:00",timestamp:"2024-09-29T13:04:49.0970187+00:00",messageId:"eb5b9ee6-f0bb-4477-baec-3224021f0673",messageType:"Suggestion",experienceType:"SuggestionPill",offense:"Unknown",feedback:{tag:null,updatedOn:null,type:"None"},contentOrigin:"SuggestionChipsService",groundingDataCount:0,clientContext:null},{text:"What other files has Guy Yom Tov authored?",hiddenText:"DynamicTurnN",author:"user",createdAt:"2024-09-29T13:04:49.0970213+00:00",timestamp:"2024-09-29T13:04:49.0970213+00:00",messageId:"5683af45-264a-49d6-bcf6-b495398e7968",messageType:"Suggestion",experienceType:"SuggestionPill",offense:"Unknown",feedback:{tag:null,updatedOn:null,type:"None"},contentOrigin:"SuggestionChipsService",groundingDataCount:0,clientContext:null}],groundingDataCount:10,clientContext:null,turnCount:8,sensitivityLabel:{id:"c179f820-d535-4b2f-b252-8a9c4ac14ec6",displayName:"Highly Confidential\\Microsoft Extended",tooltip:"Data is classified and protected. Microsoft Full Time Employees (FTE) and non employees can view, edit and reply.",priority:21,color:"#A80000",isEncrypted:!0},citations:[]}],resultType:"Success",sessionKey:"fde07ae5-5825-4d48-a1f2-e3831f50e889"},$a="Here are the top 10 stocks in the S&P 500 and their current stock prices:\n\n| Rank | Company          | Symbol | Current Stock Price |\n|------|------------------|--------|---------------------|\n| 1    | Apple Inc.       | AAPL   | \\$244.87             |\n| 2    | NVIDIA Corporation | NVDA   | \\$139.23             |\n| 3    | Microsoft Corporation | MSFT   | \\$414.77             |\n| 4    | Amazon.com, Inc. | AMZN   | \\$226.63             |\n| 5    | Meta Platforms, Inc. | META   | \\$703.77             |\n| 6    | Alphabet Inc. (Class A) | GOOGL  | \\$185.27             |\n| 7    | Broadcom Inc.    | AVGO   | \\$228.73             |\n| 8    | Tesla, Inc.      | TSLA   | \\$360.56             |\n| 9    | Berkshire Hathaway Inc. (Class B) | BRK.B  | \\$483.77             |\n| 10   | Alphabet Inc. (Class C) | GOOG   | \\$187.13             |\n\nPlease note that this AI-generated preview may be different from the data in the sources[1](https://www.slickcharts.com/sp500)[2](https://stockanalysis.com/list/sp-500-stocks/).\n\n[1](https://www.slickcharts.com/sp500): https://www.slickcharts.com/sp500\n[2](https://stockanalysis.com/list/sp-500-stocks/): https://stockanalysis.com/list/sp-500-stocks/",Ha={status:-1,conversationSensitivityLabel:{id:"c179f820-d535-4b2f-b252-8a9c4ac14ec6",displayName:"Highly Confidential\\Microsoft Extended",tooltip:"Data is classified and protected. Microsoft Full Time Employees (FTE) and non employees can view, edit and reply.",priority:21,color:"#A80000",isEncrypted:!0},messagesToAddOrReplace:[{text:$a,hiddenText:$a,author:"bot",createdAt:"2024-09-29T13:04:48.1703965+00:00",timestamp:"2024-09-29T13:04:48.1703965+00:00",messageId:"a9d573f4-1db2-4549-9efc-5bbed7672a98",requestId:"7b8a3e38-0634-4ba8-a1b9-627cd448c3cf",messageType:"Chat",experienceType:"Default",offense:"Unknown",adaptiveCards:[{type:"AdaptiveCard",version:"1.0",body:[{type:"TextBlock",text:$a,wrap:!0}]}],actionButtons:[],sourceAttributions:[{sourceType:"CITATION",providerDisplayName:"S&P 500 Companies by Weight - SlickCharts",seeMoreUrl:"https://www.slickcharts.com/sp500",referenceMetadata:'{"type":"Web","referenceType":0,"hasAttachments":false,"suppressCitation":false}',isCitedInResponse:"True",searchQuery:"top 10 stocks in the S&P 500 and their current stock price",videoTimeLength:"0",videoDAPublicationDate:"",videoViewCount:""}],entityRepresentations:[],feedback:{tag:null,updatedOn:null,type:"None"},contentOrigin:"DeepLeo",groundingDataCount:10,clientContext:null,turnCount:8,citations:[]}],resultType:"Success",sessionKey:"fde07ae5-5825-4d48-a1f2-e3831f50e889"},Ua={status:-1,messagesToAddOrReplace:[{text:"search my contoso agent for sales",author:"user",from:{id:"2c6b42d2-89cf-4367-9b60-b3725a1930f1",name:null,partnerId:null},createdAt:"2025-05-06T13:16:09.1311892+00:00",timestamp:"2025-05-06T16:16:08.834+03:00",locale:"en",market:"en-us",region:"us",locationInfo:{country:"",state:"",city:"",timeZone:"Asia/Jerusalem",timeZoneOffset:3,isImplicitLocationIntent:!1},messageId:"54187858-297f-4a62-bd36-e4ee0f9c0673",requestId:"54187858-297f-4a62-bd36-e4ee0f9c0673",offense:"None",adaptiveCards:[],contentOrigin:"AugmentationLoop",inputMethod:"Keyboard",turnCount:2,sensitivityLabel:{id:"d9f23ae3-a239-45ea-bf23-f515f824c57b",displayName:"Confidential\\Microsoft FTE",tooltip:"Data is classified and protected. Microsoft Full Time Employees (FTE) can edit, reply, forward and print. Recipient can unprotect content with proper justification.",priority:3,color:"#FF8C00",isEncrypted:!0},filesAndLinksContextMetadata:{files:[{annotationType:"File",sensitivityLabel:null,id:"31db3845-d989-4226-aefc-949dd635e450",itemid:"31db3845-d989-4226-aefc-949dd635e450",index:null,fileName:"Fabric Data Agent POC.xlsx",annotatedFileName:null,fileType:"xlsx",fileContent:null,fileDescription:null,docMetadata:null,fileSize:null,tokenSize:null,isCopilotContext:!0,isDeclarativeAgentKnowledge:!1,isEmbedded:!1,fileInfo:{fileUrl:"https://microsoft.sharepoint-df.com/teams/XLIL_team/_layouts/15/Doc.aspx?sourcedoc=%7B31DB3845-D989-4226-AEFC-949DD635E450%7D&file=Fabric%20Data%20Agent%20POC.xlsx&action=default&mobileredirect=true",fileContainerUrl:null},isCitedInResponse:!0,copilotAction:0}],links:[],pages:null,userIpAddress:"128.94.10.80"},gptIdentifiers:[{id:"U_e21dad7c-2232-697d-3f80-c5957669543d.declarativeCopilot",source:"MOS3",version:"1.1.6",metaOSGlobalIdentifier:{metaOSSharedServicesTitleId:"U_e21dad7c-2232-697d-3f80-c5957669543d",teamsAppId:"727610b8-aa90-4392-869b-43fcbac9616e",packageRelativeAgentId:"declarativeCopilot"}}],messageType:"Chat",citations:[]},{text:"This is Excel Data Agent. I found the Contoso Sales Agent which is designed to answer sales-related questions about the Contoso company's sales data in fiscal year 2025 (FY25) [1](). \n\nHere is the data you requested [2]().",author:"bot",responseIdentifier:"Default",createdAt:"2025-05-06T13:16:16.8281882+00:00",timestamp:"2025-05-06T13:16:16.8281882+00:00",messageId:"762d134f-fe59-4ce8-a834-b6930f05d4e6",requestId:"54187858-297f-4a62-bd36-e4ee0f9c0673",offense:"None",adaptiveCards:[{type:"AdaptiveCard",version:"1.0",body:[{type:"TextBlock",text:"This is Excel Data Agent. I found the Contoso Sales Agent which is designed to answer sales-related questions about the Contoso company's sales data in fiscal year 2025 (FY25) [1](). \n\nHere is the data you requested [2]().",wrap:!0}]}],sourceAttributions:[{sourceType:"CITATION",providerDisplayDescription:"",referenceMetadata:'{"type":"ThirdParty","referenceType":0,"hasAttachments":false,"referenceSubType":"text/plain","dataSource":"{\\"id\\":\\"CopilotPlugins.GPTActionOpenAIPlugin.eyJBY3F1aXNpdGlvblRpdGxlSWQiOiJVX2UyMWRhZDdjLTIyMzItNjk3ZC0zZjgwLWM1OTU3NjY5NTQzZCIsIkFjcXVpc2l0aW9uQXBwSWQiOiI3Mjc2MTBiOC1hYTkwLTQzOTItODY5Yi00M2ZjYmFjOTYxNmUiLCJHcHRJZCI6ImRlY2xhcmF0aXZlQ29waWxvdCIsIkdwdEFjdGlvbklkIjoicGx1Z2luLW1hbmlmZXN0In0=\\",\\"source\\":\\"MOS3\\",\\"data\\":{\\"PluginType\\":\\"OpenAIPlugin\\",\\"MetaOSAppId\\":\\"727610b8-aa90-4392-869b-43fcbac9616e\\",\\"MetaOSTitleId\\":\\"U_e21dad7c-2232-697d-3f80-c5957669543d\\",\\"MetaOSBotId\\":\\"\\",\\"GptId\\":\\"declarativeCopilot\\",\\"GptActionId\\":\\"plugin-manifest\\",\\"TitleIndex\\":\\"0\\",\\"PluginName\\":\\"Excel Data Agent\\",\\"AcquisitionContext\\":\\"User\\",\\"CatalogName\\":\\"MOS3\\",\\"AppKind\\":\\"UserCreated\\"},\\"version\\":\\"1.1.6\\"}","pluginType":"OpenAIPlugin","pluginId":"727610b8-aa90-4392-869b-43fcbac9616e","appKind":"UserCreated","suppressCitation":false,"isExternal":false,"isExcluded":false}',providerDisplayName:null,seeMoreUrl:null,isCitedInResponse:"True",imageLink:"",id:"7dafab7b-1f5f-4207-9bae-2e5a17a27c4b"},{sourceType:"CITATION",adaptiveCardJson:'[{"type":"AdaptiveCard","version":"1.5","body":[{"type":"Container","items":[{"type":"TextBlock","text":"Show me sales by region","weight":"Bolder","wrap":true},{"type":"Table","columns":[{"width":"auto"},{"width":"auto"}],"rows":[{"type":"TableRow","cells":[{"type":"TableCell","items":[{"type":"TextBlock","text":"Region","weight":"Bolder"}]},{"type":"TableCell","items":[{"type":"TextBlock","text":"Sales","weight":"Bolder"}]}]},{"type":"TableRow","cells":[{"type":"TableCell","items":[{"type":"TextBlock","text":"North"}]},{"type":"TableCell","items":[{"type":"TextBlock","text":"$10,000"}]}]}]},{"type":"ActionSet","id":"toggleDown","actions":[{"type":"Action.ToggleVisibility","title":"Show Query ▼","targetElements":["hiddenCard","toggleDown","toggleUp"]}]},{"type":"ActionSet","id":"toggleUp","isVisible":false,"actions":[{"type":"Action.ToggleVisibility","title":"Hide Query ▲","targetElements":["hiddenCard","toggleDown","toggleUp"]}]},{"type":"Container","id":"hiddenCard","isVisible":false,"items":[{"type":"TextBlock","text":"SELECT Region, SUM(Sales) as Sales FROM SalesData GROUP BY Region","wrap":true},{"type":"ActionSet","actions":[{"type":"Action.Execute","title":"Import Query","data":{"query":"SELECT Region, SUM(Sales) as Sales FROM SalesData GROUP BY Region"},"role":"Button","style":"positive"}]}]}]}]}]',providerDisplayDescription:"",referenceMetadata:'{"type":"ThirdParty","referenceType":0,"hasAttachments":false,"referenceSubType":"text/adaptivecardtemplate","dataSource":"{\\"id\\":\\"CopilotPlugins.GPTActionOpenAIPlugin.eyJBY3F1aXNpdGlvblRpdGxlSWQiOiJVX2UyMWRhZDdjLTIyMzItNjk3ZC0zZjgwLWM1OTU3NjY5NTQzZCIsIkFjcXVpc2l0aW9uQXBwSWQiOiI3Mjc2MTBiOC1hYTkwLTQzOTItODY5Yi00M2ZjYmFjOTYxNmUiLCJHcHRJZCI6ImRlY2xhcmF0aXZlQ29waWxvdCIsIkdwdEFjdGlvbklkIjoicGx1Z2luLW1hbmlmZXN0In0=\\",\\"source\\":\\"MOS3\\",\\"data\\":{\\"PluginType\\":\\"OpenAIPlugin\\",\\"MetaOSAppId\\":\\"727610b8-aa90-4392-869b-43fcbac9616e\\",\\"MetaOSTitleId\\":\\"U_e21dad7c-2232-697d-3f80-c5957669543d\\",\\"MetaOSBotId\\":\\"\\",\\"GptId\\":\\"declarativeCopilot\\",\\"GptActionId\\":\\"plugin-manifest\\",\\"TitleIndex\\":\\"0\\",\\"PluginName\\":\\"Excel Data Agent\\",\\"AcquisitionContext\\":\\"User\\",\\"CatalogName\\":\\"MOS3\\",\\"AppKind\\":\\"UserCreated\\"},\\"version\\":\\"1.1.6\\"}","pluginType":"OpenAIPlugin","pluginId":"727610b8-aa90-4392-869b-43fcbac9616e","appKind":"UserCreated","suppressCitation":false,"isExternal":false,"isExcluded":false}',providerDisplayName:null,seeMoreUrl:null,isCitedInResponse:"True",imageLink:"",id:"f53197dd-5781-4d73-a2de-a7b82ae1bfcc"}],contentOrigin:"DeepLeo",turnCount:2,gptIdentifiers:[{id:"U_e21dad7c-2232-697d-3f80-c5957669543d.declarativeCopilot",source:"MOS3",version:"1.1.6",metaOSGlobalIdentifier:{metaOSSharedServicesTitleId:"U_e21dad7c-2232-697d-3f80-c5957669543d",teamsAppId:"727610b8-aa90-4392-869b-43fcbac9616e",packageRelativeAgentId:"declarativeCopilot"}}],messageType:"Chat",citations:[]}],resultType:"Success",defaultChatName:"search my contoso agent for sales",sessionKey:"a309a6c8-df7c-414b-9587-95c4ea5fa03b"},qa=async e=>{const t=(0,an.A)(),{message:n,telemetry:a}=Ct.n.getImportDataResponse({requestId:t,dataSources:[{id:"1",type:Oa.o.ExcelFile,sourceUrl:"https://microsoft-my.sharepoint-df.com/personal/shaharso_microsoft_com/Documents/Workbooks/AL/Book6.xlsx?web=1",sourceLocation:"Book6",sourceParentUrl:"XLIL_Team",sourceRelativePath:"Documents/Workbooks/AL",sourceName:"Users",seeMoreUrl:"https://microsoft-my.sharepoint-df.com/personal/shaharso_microsoft_com/Documents/Workbooks/AL/Book6.xlsx?web=1",powerQueryScript:'let Source = Excel.Workbook(File.Contents("https://microsoft-my.sharepoint-df.com/personal/shaharso_microsoft_com/Documents/Workbooks/AL/Book6.xlsx"), null, true), Users_Table = Source{[Item="Users",Kind="Table"]}[Data], ChangedType = Table.TransformColumnTypes(Users_Table,{{"Name", type text}, {"Age", Int64.Type}, {"Gender", type text}}) in ChangedType',columns:[{name:"Name"},{name:"Age"},{name:"Gender"}],sampleRows:[["John","25","male"],["Doe","30","male"],["Jane","35","female"]]},{id:"2",type:Oa.o.ExcelFile,sourceUrl:"https://microsoft-my.sharepoint-df.com/personal/shaharso_microsoft_com/Documents/Workbooks/AL/Book6.xlsx?web=1",sourceLocation:"Book6",sourceName:"Movies",seeMoreUrl:"https://microsoft-my.sharepoint-df.com/personal/shaharso_microsoft_com/Documents/Workbooks/AL/Book6.xlsx?web=1",powerQueryScript:'let Source = Excel.Workbook(File.Contents("https://microsoft-my.sharepoint-df.com/personal/shaharso_microsoft_com/Documents/Workbooks/AL/Book6.xlsx"), null, true), Movies_Table = Source{[Item="Movies",Kind="Table"]}[Data], ChangedType = Table.TransformColumnTypes(Movies_Table,{{"Movie", type text}, {"Date of Release", Int64.Type}, {"Rating", type number}, {"Genre", type text}}) in ChangedType',sourceParentUrl:"XLIL_Team",sourceRelativePath:"Documents/Workbooks/AL",columns:[{name:"Movie"},{name:"Date of Release"},{name:"Rating"},{name:"Genre"}],sampleRows:[["The Shawshank Redemption","1994","9.3","Drama"],["The Godfather","1972","9.2","Crime"],["The Dark Knight","2008","9.0","Action"],["The Godfather: Part II","1974","9.0","Crime"],["The Lord of the Rings: The Return of the King","2003","8.9","Adventure"]]}],messageId:"",userQueryGuid:"",clpData:void 0,performedFallbackToAllTables:!1,importType:v.q.ImportDataFromSearch});e(rt.m.setLatestRequestId(t)),l.$.getInstance().displayResponse(n,a)},Va=async e=>{await async function(e){const t=structuredClone(Ba),n={...t,messagesToAddOrReplace:t.messagesToAddOrReplace.map((e=>{if(!(e.sourceAttributions&&e.text&&e.messageId&&e.requestId))return e;const t=(0,an.A)(),n=(0,an.A)(),a="(encrypted) "+e.text,o=e.sourceAttributions.map((e=>{const t=JSON.parse(e.referenceMetadata);return t.sensitivityLabel&&!1===t.sensitivityLabel.isEncrypted&&(t.sensitivityLabel.isEncrypted=!0,e.referenceMetadata=JSON.stringify(t)),e}));return{...e,messageId:t,requestId:n,text:a,sourceAttributions:o}}))};await Wa(n,e)}(e)};async function Wa(e,t){await Da.s.getInstance().handleChatResponse(e,t);const n={...e,status:0,messagesToAddOrReplace:[],messages:e.messagesToAddOrReplace};Da.s.getInstance().handleChatResponse(n,t)}var Ga=n(778685);const za=async e=>{const t=(0,an.A)();e(rt.m.setLatestRequestId(t)),e(Et.m.startFetching(t)),e(rt.m.startExecutingCommand({command:v.OP.CalculatedColumns,id:t})),e((0,It.UN)(ja(t,"1",["1"],["link"],["=SOME_FORMULA()"],[["1"],["2"]]))),e((0,lt.L4)())};function Qa(e,t){const n=e.sheetRange.range.topLeft.row+1+1,a=e.sheetRange.range.bottomRight.row+1,o=[];for(let e=n;e<=a;e++)o.push(""+e*t);return o}const ja=(e,t,n,a,o,r)=>({calculatedColumns:n.map(((e,t)=>({id:e,columnName:a[t],formula:o[t],title:"Mock Title",numberFormat:"0.0",description:"<p>Mock Description.</p>",formulaExplanation:"<p>This is just a mock formula:</p>\n<ul>\n<li>It is only enabled in local SDX.</li>\n<li>It is hardcoded and does not come from LLM.</li>\n<li>The value changes every time.</li>\n</ul>"}))),isAlternativeSuggestion:!1,previewValues:r,requestId:e,suggestionId:t,suggestionMetadata:{result:Ga.sR.Success},success:!0,H_:{T_:"AugLoop_ExcelIntelligence_CalculatedColumnSuggestion",B_:["AugLoop_Core_Annotation"]},ownerId:"ExcelIntelligenceSignal"}),Ja=(e,t,n,a,o)=>({calculatedCells:n.map(((e,t)=>({id:e,formula:a[t],insertionIndexes:[1],title:"Mock Title",numberFormat:"0.0",description:"<p>Mock Description.</p>",formulaExplanation:"<p>This is just a mock formula:</p>\n<ul>\n<li>It is only enabled in local SDX.</li>\n<li>It is hardcoded and does not come from LLM.</li>\n<li>The value changes every time.</li>\n</ul>"}))),isAlternativeSuggestion:!1,previewValues:o,requestId:e,suggestionId:t,suggestionMetadata:{result:Ga.sR.Success},success:!0,H_:{T_:"AugLoop_ExcelIntelligence_CalculatedCellSuggestion",B_:["AugLoop_Core_Annotation"]},metadata:{result:Ga.sR.Success},ownerId:"ExcelIntelligenceSignal"});var Ya=n(693226),Xa=n(951323),Za=n(653972),Ka=n(86940),eo=n(293879),to=n(70239),no=n(482454),ao={};ao.styleTagTransform=U(),ao.setAttributes=D(),ao.insert=M().bind(null,"head"),ao.domAPI=P(),ao.insertStyleElement=$();F()(no.A,ao);no.A&&no.A.locals&&no.A.locals;n(554094);var oo,ro=n(743934),io=n(986571),lo=n(831253),so=n(82093),co=n(193263),uo=n(379490),mo=n(123440);!function(e){e.Cycle="Cycle"}(oo||(oo={}));class go{getExtensions(e){go.get(this.extensionsUrl,e)}getResource(e,t,n){t===mo.IvyRenderer.Image?this.getImage(e,n):this.getJson(e,n)}getImage(e,t){this.callPost("image/png",e,t)}getJson(e,t){this.callPost("application/json",e,t)}callPost(e,t,n){const a={chartSettings:t,colorizer:this.colorizer};go.post(this.layoutUrl,e,a,n)}static post(e,t,n,a){const o=new XMLHttpRequest;o.open("POST",e),o.setRequestHeader("Accept",t),o.setRequestHeader("Content-Type","text/plain"),o.send(JSON.stringify(n)),go.completeAjax(o,go.callbackWrapper(a))}static callbackWrapper(e){return function(...t){e.apply(this,[t[0],{chartResource:t[1]}])}}static get(e,t){const n=new XMLHttpRequest;n.open("GET",e),n.send(null),go.completeAjax(n,t)}static completeAjax(e,t){e.onreadystatechange=()=>{e.readyState===XMLHttpRequest.DONE&&(200===e.status?t(null,JSON.parse(e.responseText)):t(`Edera RequestFailed StatusCode: ${e.status}`,null))}}constructor(e,t){this.extensionsUrl=e.extensionsUrl??`${e.base}/charts/extensions?clientId=${e.clientId}`,this.layoutUrl=e.layoutUrl??`${e.base}/charts/layout?clientId=${e.clientId}`,this.colorizer=t}}var ho=n(910480),po=n(374315);const bo=new Map;function fo(e,t){try{l.$.getInstance().resendChatHistorySignal(t,(t=>function(e,t){if(!e.richTextJson)return void r("message has no richTextJson");const n=JSON.parse(e.richTextJson),o=n?.body?.renderData;if(!o)return void r("message has no renderData");if(T.E.getInstance().updateTelemetryChatEventData({[v.h3.ChatEventType]:v.a5.ChatHistoryImageResendEvent,[v.h3.ChatEventParameters]:JSON.stringify({featureName:v.q.CopilotChat,eventType:v.a5.ChatHistoryImageResendEvent})},x.M.getInstance()),"AnalyzeData_V1"===o.component)return o.props.chartImageUrl=t,delete o.props.visual.visual,{...e,richTextJson:JSON.stringify(n),images:[t],messageId:(0,an.A)()};if("ChartAdaptiveCard_V1"===o.component){const a=bo.get(e.messageId)??[],o=(0,an.A)(),r=[...a,t];return bo.set(e.messageId,r),bo.set(o,r),{...e,richTextJson:JSON.stringify(n),images:r,messageId:o}}return void r(`Unsupported message component: ${o.component}`);function r(e){(0,a.cY)(a.SA.Error,"Error while resending chat history signal with an image",e),T.E.getInstance().updateTelemetryChatEventData({[v.h3.ChatEventType]:v.q0.ChatHistoryImageResendFailed,[v.h3.ChatEventParameters]:JSON.stringify({featureName:v.q.CopilotChat,eventType:v.a5.ErrorMessage,errorType:v.q0.ChatHistoryImageResendFailed})},x.M.getInstance())}}(t,e)))}catch(e){(0,a.cY)("Error while resending chat history signal with an image",e)}}function Co(e){try{return`data:image/svg+xml;base64,${btoa(e.outerHTML)}`}catch(t){if("InvalidCharacterError"===t.name)return`data:image/svg+xml,${encodeURIComponent(e.outerHTML)}`;throw x.M.getInstance().logError({eventType:ot.S2.ChatEvents,errorMessage:`getSvgDataUrl: Failed to convert SVG to data URL: ${t?.message}`,logLevel:j.$b.Critical}),t}}class yo extends co.hA{get definition(){return this.getValue(yo.definitionProperty)}set definition(e){this.definition!==e&&(this.setValue(yo.definitionProperty,e),this.updateLayout())}internalRender(){return this.chartElement=document.createElement("div"),this.chartElement.className="chart",this.setupChartHost(),this.resizeObserver=new ResizeObserver((0,ho.debounce)((([e])=>{e&&this.onChartChange()}),1e3)),this.resizeObserver.observe(this.chartElement),this.chartElement}getJsonTypeName(){return yo.JsonTypeName}updateLayout(e=!0){super.updateLayout(e),this.renderedElement&&this.layoutChart()}setupChartHost(){const e={base:`${(0,po.wF)()}/v3.0`,clientId:(0,po.fp)()},t={disableChartElementResize:!1,renderer:mo.IvyRenderer.Svg},n={type:oo.Cycle};this.host=new mo.ChartHost(new go(e,n),t,this.chartElement),this.host.on("error",((e,t)=>{x.M.getInstance().logErrorCode(on.O.IvyWebFailure,new Error(t),ot.S2.AnalyzeDataError,j.$b.ASHA)}))}layoutChart(){if(this.definition){const e=JSON.parse(this.definition),t=.5,n=this.chartElement.clientWidth,a=n*t,o={attributes:!0,childList:!0,characterData:!0},r=()=>{const e=this.chartElement?.querySelector("svg");e&&(e.setAttribute("focusable","false"),e.setAttribute("role","img"),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.isChartImageSentToHistory||(fo(Co(e),""),this.isChartImageSentToHistory=!0)),this.observer.disconnect()};this.observer=new MutationObserver(r),this.observer.observe(this.chartElement,o),e.size={width:n,height:a},this.host?.setConfiguration(e)}}onChartChange(){this.layoutChart()}constructor(...e){super(...e),this.isChartImageSentToHistory=!1}}yo.JsonTypeName="Chart",yo.definitionProperty=new lo.XB(lo.uq.v1_0,"definition",!1),(0,uo.__decorate)([(0,lo.MZ)(yo.definitionProperty)],yo.prototype,"definition",null);var vo=n(544861);function To({requestId:e,adaptiveCardDefinition:t,cardButtonCallback:n}){const a=(0,ge.j)(),o=new ro.l;ro.v.populateWithDefaultElements(o),o.register("Carousel",io.FN,lo.uq.v1_6),o.register("Table",so.XI,lo.uq.v1_5),o.register(yo.JsonTypeName,yo);const r=new co.Au;r.setElementRegistry(o);const i=new co.hq;i.hostConfig.fontFamily="Segoe UI, Helvetica Neue, sans-serif",i.hostConfig.containerStyles.default.borderColor="#000000",i.parse(t,r);const l=[];i.getAllActions().forEach((e=>{if(e instanceof co.eB&&e.data){e.remove();let t=e.title??"";"insert-all"===e.verb?t=c.olU.SuggestionPillAddInsights:"insert-current"!==e.verb&&"insert"!==e.verb&&"insert-static-chart"!==e.verb||(t=c.olU.RecommendationAddToNewSheet),l.push({...(0,vo.r1)(t),handleButtonOnClick:n||(()=>{xo(i,e,a)})})}}));const s=i.render(),d=I.createElement(So,{element:s});return I.createElement(vo.lJ,{contentBody:d,cardButtons:l,requestId:e})}n(237826);const xo=(e,t,n)=>{if("insert-static-chart"===t.verb){const e=t.data;return void n((0,kt.gG)(e))}const o=t.data;if("insert-all"===t.verb){const e=o.visuals;if(!e)return void(0,a.cY)("No visuals to insert");n((0,kt.z$)(e,o.interpretation,o.tableName))}else if("insert-current"===t.verb){const t=o.visuals;if(!t)return void(0,a.cY)("No visuals to insert");const r=e.getElementById("carousel");if(!r)return void(0,a.cY)("Carousel element not found");const i=r.currentIndex;if(void 0===i||i<0||i>=t.length)return void(0,a.cY)("Invalid carousel index");n((0,kt.f0)(t[i],o.interpretation,o.tableName))}else if("insert"===t.verb){const e=o.visual;if(!e)return void(0,a.cY)("No visual to insert");n((0,kt.f0)(e,o.interpretation,o.tableName))}else(0,a.cY)("Unknown execute action")},So=({element:e})=>{const t=I.useRef();return I.useEffect((()=>(e&&t.current&&t.current.appendChild(e),()=>{e&&t.current&&t.current.removeChild(e)})),[e]),I.createElement("span",{ref:t})};var wo=n(470131),Eo={};Eo.styleTagTransform=U(),Eo.setAttributes=D(),Eo.insert=M().bind(null,"head"),Eo.domAPI=P(),Eo.insertStyleElement=$();F()(wo.A,Eo);wo.A&&wo.A.locals&&wo.A.locals;var Io=n(420717),Ro=n(864099),Ao=n(486092),Lo=n(691727),ko=n(498035),Fo=n(364326),_o=n(458179),Po=n(986259),No=n(179001),Mo=n(437489),Oo=n(798110),Do=n(847760);const Bo=(0,d.n)({textColor:{color:f.k1.black},backgroundColor:{backgroundColor:f.k1.colorSubtleBackground}}),$o=e=>{const t=(0,Do.D)();let n=!1;const[a,o]=I.useState([]),[r,i]=I.useState();I.useEffect((()=>{e.initializeUpdateCallbackLogic&&e.initializeUpdateCallbackLogic(S,l)}),[e.initializeUpdateCallbackLogic]);const l=(e,t)=>{n||(M((0,jt.VY)(c.olU.ChartDesignRecommendationsCardGeneratingText,{chartNumber:e+1,chartTotal:t})),B(c.olU.ChartDesignRecommendationsCardProcessingText1),setTimeout((()=>{n||B(c.olU.ChartDesignRecommendationsCardProcessingText2)}),1e3),setTimeout((()=>{n||B(c.olU.ChartDesignRecommendationsCardProcessingText3)}),2e3),setTimeout((()=>{n||B(c.olU.ChartDesignRecommendationsCardProcessingText4)}),3e3),setTimeout((()=>{n||B(c.olU.ChartDesignRecommendationsCardProcessingText5)}),4e3))},[s,d]=I.useState(null),[m,g]=I.useState(1),h=I.useRef(null),p=I.useRef(null),b=I.useRef(null);I.useEffect((()=>{h.current&&h.current.scrollIntoView({behavior:"smooth"}),p.current&&p.current.focus(),b.current&&b.current.focus()}),[s]);const f=e=>(e-50)/2,[C,y]=I.useState(f(400));I.useEffect((()=>{const e=document.getElementById("copilot-chat-input");if(null!==e){const t=window.getComputedStyle(e),n=parseFloat(t.width);y(f(n));const a=()=>{const t=window.getComputedStyle(e),n=parseFloat(t.width);y(f(n))};return window.addEventListener("resize",a),()=>{window.removeEventListener("resize",a)}}}),[]);const S=(t,a,r)=>{if(o([...t]),void 0!==r&&i((()=>r)),a){const a=t.filter((e=>e.resultType===Je.qv.Success));n=!0,B(""),0===a.length?(H(!0),M(c.olU.ChartDesignRecommendationCardErrorMessage)):(H(!1),M(c.olU.ChartDesignRecommendationsPreviewDesignLabelViaOOUI),a.length>0&&g(a[0].id)),e.onAllRecommendationsAdded();const o=t.filter((e=>e.resultType===Je.qv.PreviewUnavailable)),r=t.filter((e=>e.resultType===Je.qv.FailedValidation)),i=t.filter((e=>e.resultType===Je.qv.InternalError)),l=t.filter((e=>e.resultType===Je.qv.NoSuggestion));T.E.getInstance().updateTelemetryChatEventData({[v.h3.ChatEventType]:v.a5.ChartDesignRecommendationsAllPreviewsLoaded,[v.h3.ChatEventParameters]:JSON.stringify({Success:a.length,PreviewUnavailable:o.length,FailedValidation:r.length,InternalError:i.length,NoSuggestion:l.length,queryId:e.queryId})},x.M.getInstance())}},w=e=>{m!==e.id&&g(e.id)},[E,R]=I.useState(0),A=()=>{let t=null;0!==m&&(t=a[m-1],d(t),R((e=>e+1)),T.E.getInstance().updateTelemetryChatEventData({[v.h3.ChatEventType]:v.a5.ChartDesignRecommendationsPreviewButtonClicked,[v.h3.ChatEventParameters]:JSON.stringify({index:m-1,previewClickCount:E+1,queryId:e.queryId,isChartTypeChanged:t?.isChartTypeChanged??!1,isDarkMode:t?.isDarkMode??!1,colorPaletteId:t?.colorPaletteId??"",isTitleLeftAligned:t?.isTitleLeftAligned??!1,isDataSourceRangeChanged:t?.isDataSourceRangeChanged??!1})},x.M.getInstance()),x.M.getInstance().startTriedActivity(v.q.ChartDesignRecommendations),x.M.getInstance().endTriedActivitySuccess(v.q.ChartDesignRecommendations))},L=()=>{d(null)},[k,F]=I.useState(!1),_=e=>{(0,Oo.J)("Office.Excel.Copilot.DisableChartDesignRecommendations"),F(!0),T.E.getInstance().updateTelemetryChatEventData({[v.h3.ChatEventType]:v.a5.ChartDesignRecommendationsOptOut,[v.h3.ChatEventParameters]:JSON.stringify({queryId:e})},x.M.getInstance())};I.useEffect((()=>{const e=document.getElementById("chartRecommendationCardFooter");e&&k&&e.blur()}),[k]);const[P,N]=I.useState(c.olU.ChartDesignRecommendationsAnalyzingCardText),M=e=>{N(e)},[O,D]=I.useState(""),B=e=>{D(e)},[$,H]=I.useState(!0);I.useEffect((()=>{const e=document.getElementById("previewDesignButton");e&&$&&e.blur()}),[$]);const U=()=>{if(s){if(!s.batchProcessor)throw x.M.getInstance().logError({eventType:ot.S2.ChartDesignRecommendations,errorMessage:"[ChartDesignRecommendations]: Batch processor is not available for the selected chart recommendation.",logLevel:j.$b.Error}),new Error("[ChartDesignRecommendations]: Batch processor is not available for the selected chart recommendation.");r?.(s.id-1,E,s.code,s.codeExplanation,s.batchProcessor,s.isChartTypeChanged,s.isDarkMode,s.colorPaletteId,s.isTitleLeftAligned,s.isDataSourceRangeChanged)}},q={childrenGap:10},V=((e,t)=>{const n={id:-1,resultType:Je.qv.Success,scenegraphJSON:"",code:"",codeExplanation:[],summary:"",expandableListItems:[]},a=[],o=[n,n,n,n];for(let t=0;t<e.length;t++)o[t]=e[t];for(let e=0;e<o.length;e+=t)a.push(o.slice(e,e+t));return a})(a,2),W=(e,t)=>{const n=document.createElement("div");n.className="scenegraphChart";const a=document.getElementsByClassName("chart");a.length>0&&e.length>0&&a[0].parentElement?.appendChild(n);const o=new mo.OfficeRenderHost,r=new mo.ChartPlayer({renderer:mo.IvyRenderer.Svg,disableChartElementResize:!1},n,o),i=JSON.stringify(JSON.parse(e),null,2),l=JSON.parse(`{"data":${i}}`);try{r.render(l,void 0)}catch(e){x.M.getInstance().logError({eventType:ot.S2.SuggestionEvents,errorMessage:"Error rendering chart "+t,logLevel:j.$b.Error})}return n.children[0].setAttribute("width","100%"),n.children[0].setAttribute("height","100%"),n.innerHTML},G={},z=C/1.6;G.width=`${C}px`,G.height=`${z}px`;const Q=[{type:Lo.w.line,height:z}],J={width:"100%",height:"100%"},Y=Bo();return I.createElement(Io.Z,{className:"ChartRecommendationCard"},I.createElement(Ro.a,{image:I.createElement(Po.hw3,{className:"sparkleIcon",color:t.palette?.green||"#078107"}),header:I.createElement(u.E,{className:(0,Ao.z)(Y.textColor,"ChartRecommendationCardText")},c.olU.ChartDesignRecommendationsCardText)}),I.createElement("div",{className:"chart-card",ref:h},s?I.createElement("div",{className:"expanded-view"},I.createElement(ta.Y,{className:"backToResultButton",iconProps:{iconName:"Back"},text:c.olU.ChartDesignRecommendationsBackToResultsButtonLabel,"aria-label":c.olU.ChartDesignRecommendationsBackToResultsButtonLabel,label:c.olU.ChartDesignRecommendationsBackToResultsButtonLabel,tabIndex:0,onClick:()=>{L()},onKeyDown:e=>"Enter"===e.key?L():null}),I.createElement("div",{key:s.id,className:(0,Ao.z)(Y.textColor,"chartContainer"),dangerouslySetInnerHTML:{__html:W(s.scenegraphJSON,e.queryId)},"aria-label":s.codeExplanation?s.codeExplanation[0]:""}),I.createElement(ko.J,{className:(0,Ao.z)(Y.textColor,"chartRecommendationLabelApply"),tabIndex:-1},c.olU.ChartDesignRecommendationsApplyDesignLabel),I.createElement("div",{className:(0,Ao.z)(Y.textColor,Y.backgroundColor)},I.createElement(_o.h,{summary:s.summary,collapsedButtonLabel:ExcelCopilotCommandingHitlStrings.ChangeListCollapsedButtonLabel,expandedButtonLabel:ExcelCopilotCommandingHitlStrings.ChangeListExpandedButtonLabel,loadingLabel:ExcelCopilotCommandingHitlStrings.ChangeListLoadingLabel,expandableListItems:s.expandableListItems,isLoading:!1,isNotAvailable:!1})),I.createElement(ta.Y,{componentRef:p,className:"applyDesignButton",iconProps:{iconName:"Accept"},text:c.olU.ChartDesignRecommendationsApplyButtonLabel,"aria-label":c.olU.ChartDesignRecommendationsApplyButtonLabel,label:c.olU.ChartDesignRecommendationsApplyButtonLabel,tabIndex:0,onClick:()=>{U()},onKeyDown:e=>"Enter"===e.key?U():null})):I.createElement("div",{className:"chart-grid"},I.createElement(ko.J,{className:(0,Ao.z)(Y.textColor,"chartRecommendationLabel"),tabIndex:-1},P),O&&I.createElement(ko.J,{className:(0,Ao.z)(Y.textColor,"chartRecommendationSubLabel"),tabIndex:-1},O),I.createElement(Nn.B,{enableScopedSelectors:!0,tokens:{childrenGap:10}},V.map(((t,n)=>I.createElement(Nn.B,{key:n,enableScopedSelectors:!0,horizontal:!0,verticalAlign:"start",tokens:q},t.map(((t,n)=>I.createElement(Nn.B.Item,{className:"chartItem",key:n},-1===t.id?I.createElement("div",{style:G},I.createElement(Fo.W,{shimmerElements:Q,style:J})):t.resultType===Je.qv.Success?I.createElement("div",{key:t.id,className:(0,Ao.z)(Y.textColor,m===t.id?"chartContainerSelected":"chartContainer"),dangerouslySetInnerHTML:{__html:W(t.scenegraphJSON,e.queryId)},role:"button",tabIndex:0,onKeyDown:e=>"Enter"===e.key?w(t):null,onClick:()=>w(t),"aria-label":t.codeExplanation?t.codeExplanation[0]:"","aria-pressed":t.id===m?"true":"false"}):I.createElement("div",{key:t.id,style:G,className:"chartContainerError",tabIndex:-1},(e=>{switch(e){case Je.qv.PreviewUnavailable:return c.olU.ChartDesignRecommendationsCardErrorPreviewUnavailable;case Je.qv.FailedValidation:return c.olU.ChartDesignRecommendationsCardErrorFailedValidation;case Je.qv.InternalError:return c.olU.ChartDesignRecommendationsCardErrorInternalError;case Je.qv.NoSuggestion:return c.olU.ChartDesignRecommendationsCardErrorNoSuggestion;default:return""}})(t.resultType))))))))),I.createElement(Ln.$,{ref:b,className:"previewDesignButton",id:"previewDesignButton",disabled:$,icon:I.createElement(No.OBi,null),"aria-label":c.olU.ChartDesignRecommendationsPreviewButtonLabel,tabIndex:0,onClick:()=>{A()},onKeyDown:e=>"Enter"===e.key?A():null},c.olU.ChartDesignRecommendationsPreviewButtonLabel),e.isTriggeredViaOOUI?null:I.createElement(Ln.$,{className:"chartRecommendationCardFooter",id:"chartRecommendationCardFooter",disabled:k,icon:I.createElement(Mo.sTx,null),"aria-label":c.olU.ChartDesignRecommendationsCardFooterText,tabIndex:0,onClick:()=>{_(e.queryId)},onKeyDown:t=>"Enter"===t.key?_(e.queryId):null},c.olU.ChartDesignRecommendationsCardFooterText))))},Ho={v:"5.12.1",fr:60,ip:0,op:391,w:1160,h:472,nm:"E",assets:[{id:"comp_0",nm:"P",fr:60,layers:[{ind:1,ty:4,nm:"C",sr:1,ks:{o:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:0,s:[0]},{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:19,s:[100]},{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:271.002,s:[100]},{t:283,s:[0]}]},r:{a:0,k:0},p:{a:1,k:[{i:{x:.1,y:1},o:{x:.33,y:0},t:0,s:[308.253,386.538,0],to:[0,0,0],ti:[0,0,0]},{i:{x:.833,y:.833},o:{x:.167,y:.167},t:22,s:[308.253,442.538,0],to:[0,0,0],ti:[0,0,0]},{i:{x:.409,y:.503},o:{x:.51,y:0},t:35,s:[308.253,442.538,0],to:[0,0,0],ti:[-79.667,-46.667,0]},{i:{x:.513,y:1},o:{x:.206,y:.294},t:62,s:[480.725,562.237,0],to:[79.667,46.667,0],ti:[0,0,0]},{i:{x:.833,y:.833},o:{x:.167,y:.167},t:137,s:[786.253,722.538,0],to:[0,0,0],ti:[0,0,0]},{i:{x:.1,y:1},o:{x:.33,y:0},t:168,s:[786.253,722.538,0],to:[561.747,229.462,0],ti:[-298.333,-22.333,0]},{t:238,s:[2576.253,856.538,0]}],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:1,k:[{i:{x:[.1,.1,.1],y:[1,1,1]},o:{x:[.33,.33,.33],y:[0,0,0]},t:25,s:[100,100,100]},{i:{x:[.833,.833,.833],y:[.833,.833,.833]},o:{x:[.167,.167,.167],y:[.167,.167,.167]},t:36,s:[65,65,100]},{i:{x:[.1,.1,.1],y:[1,1,1]},o:{x:[.33,.33,.33],y:[0,0,0]},t:138,s:[65,65,100]},{i:{x:[.833,.833,.833],y:[.833,.833,.833]},o:{x:[.167,.167,.167],y:[.167,.167,.167]},t:149,s:[100,100,100]},{i:{x:[.1,.1,.1],y:[1,1,1]},o:{x:[.33,.33,.33],y:[0,0,0]},t:258,s:[100,100,100]},{i:{x:[.1,.1,.1],y:[1,1,1]},o:{x:[.33,.33,.33],y:[0,0,0]},t:267,s:[65,65,100]},{t:272,s:[100,100,100]}],l:2}},ao:0,ef:[{ty:25,nm:"D",np:8,en:1,ef:[{ty:2,nm:"S",v:{a:0,k:[0,0,0,1]}},{ty:0,nm:"O",v:{a:0,k:63.75}},{ty:0,nm:"D",v:{a:0,k:135}},{ty:0,nm:"D",v:{a:0,k:3}},{ty:0,nm:"S",v:{a:0,k:1}},{ty:7,nm:"S",v:{a:0,k:0}}]}],shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[-.08,-5.957],[0,0],[-4.209,5.193],[0,0],[-2.166,-.01],[0,0],[5.455,4.155],[0,0]],o:[[0,0],[.09,6.684],[0,0],[1.364,-1.683],[0,0],[6.857,.031],[0,0],[-4.74,-3.61]],v:[[-7.558,-.1],[-6.59,71.866],[6.107,76.27],[24.194,53.958],[29.778,51.312],[57.966,51.439],[62.329,38.607],[3.918,-5.882]],c:!0}},nm:"P"},{ty:"st",c:{a:0,k:[.984,.984,.984,1]},o:{a:0,k:100},w:{a:0,k:3},lc:1,lj:1,ml:4,nm:"S"},{ty:"fl",c:{a:0,k:[.067,.067,.067,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"S"}],ip:0,op:818,st:-82,ct:1},{ind:2,ty:4,nm:"G",sr:1,ks:{o:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:0,s:[0]},{t:18,s:[100]}]},r:{a:0,k:0},p:{a:0,k:[524,588,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:1,k:[{i:{x:.1,y:1},o:{x:.33,y:0},t:0,s:[{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-31,-51.312],[-31.125,-18.312],[-109.125,-18],[-109,-51]],c:!0}]},{i:{x:.1,y:1},o:{x:.167,y:.167},t:18,s:[{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-.5,-51.25],[-.625,-18.25],[-109.125,-18],[-109,-51]],c:!0}]},{i:{x:.83,y:1},o:{x:.33,y:0},t:45,s:[{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-.5,-51.25],[-.625,-18.25],[-109.125,-18],[-109,-51]],c:!0}]},{i:{x:.83,y:1},o:{x:.167,y:.167},t:60,s:[{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-.5,-51.25],[-.75,14.75],[-109.25,15],[-109,-51]],c:!0}]},{i:{x:.83,y:1},o:{x:.167,y:.167},t:69,s:[{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-.5,-51.25],[-.75,14.75],[-109.25,15],[-109,-51]],c:!0}]},{i:{x:.83,y:1},o:{x:.167,y:.167},t:80,s:[{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[109,-51],[108.75,15],[-109.25,15],[-109,-51]],c:!0}]},{i:{x:.1,y:1},o:{x:.17,y:0},t:93,s:[{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[109,-51],[108.75,15],[-109.25,15],[-109,-51]],c:!0}]},{t:114,s:[{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[109,-51],[109,51],[-109,51],[-109,-51]],c:!0}]}]},nm:"P"},{ty:"st",c:{a:0,k:[.075,.494,.263,1]},o:{a:0,k:100},w:{a:0,k:2},lc:1,lj:1,ml:4,nm:"S"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"G"}],ip:0,op:576,st:0,ct:1},{ind:3,ty:4,nm:"P",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[260,584,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,-4.418],[-4.418,0],[0,0],[0,4.418],[4.418,0]],o:[[-4.418,0],[0,4.418],[0,0],[4.418,0],[0,-4.418],[0,0]],v:[[-27,-42],[-35,-34],[-27,-26],[7,-26],[15,-34],[7,-42]],c:!0}},nm:"P"},{ind:1,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,-4.418],[-4.418,0],[0,0],[0,4.418],[4.418,0]],o:[[-4.418,0],[0,4.418],[0,0],[4.418,0],[0,-4.418],[0,0]],v:[[-27,-8],[-35,0],[-27,8],[27,8],[35,0],[27,-8]],c:!0}},nm:"P"},{ind:2,ty:"sh",ks:{a:0,k:{i:[[0,4.418],[-4.418,0],[0,0],[0,-4.418],[4.418,0],[0,0]],o:[[0,-4.418],[0,0],[4.418,0],[0,4.418],[0,0],[-4.418,0]],v:[[-35,34],[-27,26],[17,26],[25,34],[17,42],[-27,42]],c:!0}},nm:"P"},{ty:"fl",c:{a:0,k:[.879,.879,.879,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"P"}],ip:0,op:600,st:0,ct:1},{ind:4,ty:4,nm:"$",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[739.566,587.662,0],l:2},a:{a:0,k:[740.066,570.162,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[-.483,.463],[0,.757],[.433,.463],[.998,.36],[0,0],[-.638,-.387],[0,0],[.962,.046],[0,0],[0,0],[0,0],[.506,-.504],[0,-.715],[-.39,-.462],[-1.066,-.396],[0,0],[.524,.182],[.264,.214],[0,0],[-.925,-.004],[0,0],[0,0],[0,0]],o:[[.483,-.462],[0,-.656],[-.433,-.462],[0,0],[.797,.087],[0,0],[-.474,-.264],[0,0],[0,0],[0,0],[-.834,.082],[-.506,.504],[0,.665],[.39,.463],[0,0],[-.41,-.027],[-.524,-.182],[0,0],[.797,.415],[0,0],[0,0],[0,0],[.898,-.1]],v:[[3.073,-.036],[3.798,-1.864],[3.148,-3.542],[1.002,-4.776],[1.002,-7.367],[3.155,-6.656],[3.155,-8.502],[1.002,-8.967],[1.002,-10.211],[.004,-10.211],[.004,-8.939],[-2.006,-8.061],[-2.765,-6.232],[-2.18,-4.541],[.004,-3.252],[.004,-.764],[-1.397,-1.078],[-2.58,-1.673],[-2.58,.221],[.004,.85],[.004,2.292],[1.002,2.292],[1.002,.809]],c:!0}},nm:"$"},{ind:1,ty:"sh",ks:{a:0,k:{i:[[0,.469],[-.633,.114],[0,0]],o:[[0,-.547],[0,0],[-.633,-.314]],v:[[-.946,-6.349],[.004,-7.34],[.004,-5.173]],c:!0}},nm:"$"},{ind:2,ty:"sh",ks:{a:0,k:{i:[[0,-.447],[.652,-.1],[0,0]],o:[[0,.551],[0,0],[.652,.283]],v:[[1.979,-1.769],[1.002,-.791],[1.002,-2.862]],c:!0}},nm:"$"},{ty:"fl",c:{a:0,k:[.38,.38,.38,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"},{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[-.483,.463],[0,.757],[.433,.463],[.998,.36],[0,0],[-.638,-.387],[0,0],[.962,.046],[0,0],[0,0],[0,0],[.506,-.504],[0,-.715],[-.39,-.462],[-1.066,-.396],[0,0],[.524,.182],[.264,.214],[0,0],[-.925,-.004],[0,0],[0,0],[0,0]],o:[[.483,-.462],[0,-.656],[-.433,-.462],[0,0],[.797,.087],[0,0],[-.474,-.264],[0,0],[0,0],[0,0],[-.834,.082],[-.506,.504],[0,.665],[.39,.463],[0,0],[-.41,-.027],[-.524,-.182],[0,0],[.797,.415],[0,0],[0,0],[0,0],[.898,-.1]],v:[[11.126,-.036],[11.851,-1.864],[11.201,-3.542],[9.055,-4.776],[9.055,-7.367],[11.208,-6.656],[11.208,-8.502],[9.055,-8.967],[9.055,-10.211],[8.057,-10.211],[8.057,-8.939],[6.047,-8.061],[5.288,-6.232],[5.873,-4.541],[8.057,-3.252],[8.057,-.764],[6.655,-1.078],[5.473,-1.673],[5.473,.221],[8.057,.85],[8.057,2.292],[9.055,2.292],[9.055,.809]],c:!0}},nm:"$"},{ind:1,ty:"sh",ks:{a:0,k:{i:[[0,.469],[-.633,.114],[0,0]],o:[[0,-.547],[0,0],[-.633,-.314]],v:[[7.106,-6.349],[8.057,-7.34],[8.057,-5.173]],c:!0}},nm:"$"},{ind:2,ty:"sh",ks:{a:0,k:{i:[[0,-.447],[.652,-.1],[0,0]],o:[[0,.551],[0,0],[.652,.283]],v:[[10.032,-1.769],[9.055,-.791],[9.055,-2.862]],c:!0}},nm:"$"},{ty:"fl",c:{a:0,k:[.38,.38,.38,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"},{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[-.483,.463],[0,.757],[.433,.463],[.998,.36],[0,0],[-.638,-.387],[0,0],[.962,.046],[0,0],[0,0],[0,0],[.506,-.504],[0,-.715],[-.39,-.462],[-1.066,-.396],[0,0],[.524,.182],[.264,.214],[0,0],[-.925,-.004],[0,0],[0,0],[0,0]],o:[[.483,-.462],[0,-.656],[-.433,-.462],[0,0],[.797,.087],[0,0],[-.474,-.264],[0,0],[0,0],[0,0],[-.834,.082],[-.506,.504],[0,.665],[.39,.463],[0,0],[-.41,-.027],[-.524,-.182],[0,0],[.797,.415],[0,0],[0,0],[0,0],[.898,-.1]],v:[[-4.979,-.036],[-4.255,-1.864],[-4.904,-3.542],[-7.051,-4.776],[-7.051,-7.367],[-4.897,-6.656],[-4.897,-8.502],[-7.051,-8.967],[-7.051,-10.211],[-8.049,-10.211],[-8.049,-8.939],[-10.059,-8.061],[-10.817,-6.232],[-10.233,-4.541],[-8.049,-3.252],[-8.049,-.764],[-9.45,-1.078],[-10.633,-1.673],[-10.633,.221],[-8.049,.85],[-8.049,2.292],[-7.051,2.292],[-7.051,.809]],c:!0}},nm:"$"},{ind:1,ty:"sh",ks:{a:0,k:{i:[[0,.469],[-.633,.114],[0,0]],o:[[0,-.547],[0,0],[-.633,-.314]],v:[[-8.999,-6.349],[-8.049,-7.34],[-8.049,-5.173]],c:!0}},nm:"$"},{ind:2,ty:"sh",ks:{a:0,k:{i:[[0,-.447],[.652,-.1],[0,0]],o:[[0,.551],[0,0],[.652,.283]],v:[[-6.073,-1.769],[-7.051,-.791],[-7.051,-2.862]],c:!0}},nm:"$"},{ty:"fl",c:{a:0,k:[.38,.38,.38,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"},{ty:"tr",p:{a:0,k:[738,722]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"},{ty:"gr",it:[{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[-.483,.463],[0,.757],[.433,.463],[.998,.36],[0,0],[-.638,-.387],[0,0],[.962,.046],[0,0],[0,0],[0,0],[.506,-.504],[0,-.715],[-.39,-.462],[-1.066,-.396],[0,0],[.524,.182],[.264,.214],[0,0],[-.925,-.004],[0,0],[0,0],[0,0]],o:[[.483,-.462],[0,-.656],[-.433,-.462],[0,0],[.797,.087],[0,0],[-.474,-.264],[0,0],[0,0],[0,0],[-.834,.082],[-.506,.504],[0,.665],[.39,.463],[0,0],[-.41,-.027],[-.524,-.182],[0,0],[.797,.415],[0,0],[0,0],[0,0],[.898,-.1]],v:[[7.126,-.036],[7.851,-1.864],[7.201,-3.542],[5.055,-4.776],[5.055,-7.367],[7.208,-6.656],[7.208,-8.502],[5.055,-8.967],[5.055,-10.211],[4.057,-10.211],[4.057,-8.939],[2.047,-8.061],[1.288,-6.232],[1.873,-4.541],[4.057,-3.252],[4.057,-.764],[2.655,-1.078],[1.473,-1.673],[1.473,.221],[4.057,.85],[4.057,2.292],[5.055,2.292],[5.055,.809]],c:!0}},nm:"$"},{ind:1,ty:"sh",ks:{a:0,k:{i:[[0,.469],[-.633,.114],[0,0]],o:[[0,-.547],[0,0],[-.633,-.314]],v:[[3.106,-6.349],[4.057,-7.34],[4.057,-5.173]],c:!0}},nm:"$"},{ind:2,ty:"sh",ks:{a:0,k:{i:[[0,-.447],[.652,-.1],[0,0]],o:[[0,.551],[0,0],[.652,.283]],v:[[6.032,-1.769],[5.055,-.791],[5.055,-2.862]],c:!0}},nm:"$"},{ty:"fl",c:{a:0,k:[.38,.38,.38,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"},{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[-.483,.463],[0,.757],[.433,.463],[.998,.36],[0,0],[-.638,-.387],[0,0],[.962,.046],[0,0],[0,0],[0,0],[.506,-.504],[0,-.715],[-.39,-.462],[-1.066,-.396],[0,0],[.524,.182],[.264,.214],[0,0],[-.925,-.004],[0,0],[0,0],[0,0]],o:[[.483,-.462],[0,-.656],[-.433,-.462],[0,0],[.797,.087],[0,0],[-.474,-.264],[0,0],[0,0],[0,0],[-.834,.082],[-.506,.504],[0,.665],[.39,.463],[0,0],[-.41,-.027],[-.524,-.182],[0,0],[.797,.415],[0,0],[0,0],[0,0],[.898,-.1]],v:[[-.927,-.036],[-.202,-1.864],[-.852,-3.542],[-2.998,-4.776],[-2.998,-7.367],[-.845,-6.656],[-.845,-8.502],[-2.998,-8.967],[-2.998,-10.211],[-3.996,-10.211],[-3.996,-8.939],[-6.006,-8.061],[-6.765,-6.232],[-6.18,-4.541],[-3.996,-3.252],[-3.996,-.764],[-5.397,-1.078],[-6.58,-1.673],[-6.58,.221],[-3.996,.85],[-3.996,2.292],[-2.998,2.292],[-2.998,.809]],c:!0}},nm:"$"},{ind:1,ty:"sh",ks:{a:0,k:{i:[[0,.469],[-.633,.114],[0,0]],o:[[0,-.547],[0,0],[-.633,-.314]],v:[[-4.946,-6.349],[-3.996,-7.34],[-3.996,-5.173]],c:!0}},nm:"$"},{ind:2,ty:"sh",ks:{a:0,k:{i:[[0,-.447],[.652,-.1],[0,0]],o:[[0,.551],[0,0],[.652,.283]],v:[[-2.021,-1.769],[-2.998,-.791],[-2.998,-2.862]],c:!0}},nm:"$"},{ty:"fl",c:{a:0,k:[.38,.38,.38,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"},{ty:"tr",p:{a:0,k:[738,578]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"},{ty:"gr",it:[{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[-.483,.463],[0,.757],[.433,.463],[.998,.36],[0,0],[-.638,-.387],[0,0],[.962,.046],[0,0],[0,0],[0,0],[.506,-.504],[0,-.715],[-.39,-.462],[-1.066,-.396],[0,0],[.524,.182],[.264,.214],[0,0],[-.925,-.004],[0,0],[0,0],[0,0]],o:[[.483,-.462],[0,-.656],[-.433,-.462],[0,0],[.797,.087],[0,0],[-.474,-.264],[0,0],[0,0],[0,0],[-.834,.082],[-.506,.504],[0,.665],[.39,.463],[0,0],[-.41,-.027],[-.524,-.182],[0,0],[.797,.415],[0,0],[0,0],[0,0],[.898,-.1]],v:[[3.126,-.036],[3.851,-1.864],[3.201,-3.542],[1.055,-4.776],[1.055,-7.367],[3.208,-6.656],[3.208,-8.502],[1.055,-8.967],[1.055,-10.211],[.057,-10.211],[.057,-8.939],[-1.953,-8.061],[-2.712,-6.232],[-2.127,-4.541],[.057,-3.252],[.057,-.764],[-1.345,-1.078],[-2.527,-1.673],[-2.527,.221],[.057,.85],[.057,2.292],[1.055,2.292],[1.055,.809]],c:!0}},nm:"$"},{ind:1,ty:"sh",ks:{a:0,k:{i:[[0,.469],[-.633,.114],[0,0]],o:[[0,-.547],[0,0],[-.633,-.314]],v:[[-.894,-6.349],[.057,-7.34],[.057,-5.173]],c:!0}},nm:"$"},{ind:2,ty:"sh",ks:{a:0,k:{i:[[0,-.447],[.652,-.1],[0,0]],o:[[0,.551],[0,0],[.652,.283]],v:[[2.032,-1.769],[1.055,-.791],[1.055,-2.862]],c:!0}},nm:"$"},{ty:"fl",c:{a:0,k:[.38,.38,.38,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"},{ty:"tr",p:{a:0,k:[738,450]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"}],ip:0,op:600,st:0,ct:1},{ind:5,ty:4,nm:"C",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[68,364,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0]],v:[[-5,5],[5,5],[5,-5]],c:!0}},nm:"P"},{ty:"rd",nm:"R",r:{a:0,k:1}},{ty:"fl",c:{a:0,k:[.74,.74,.74,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"C"}],ip:0,op:600,st:0,ct:1},{ind:6,ty:4,nm:"A",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[302,448,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"rc",d:1,s:{a:0,k:[107,32]},p:{a:0,k:[0,0]},r:{a:0,k:0},nm:"R"},{ty:"fl",c:{a:0,k:[1,1,1,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"R"}],ip:0,op:600,st:0,ct:1},{ind:7,ty:4,nm:"A",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[302,584,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"rc",d:1,s:{a:0,k:[107,32]},p:{a:0,k:[0,0]},r:{a:0,k:0},nm:"R"},{ty:"fl",c:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:44,s:[1,1,1,1]},{t:63,s:[.906,.945,.925,1]}]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"R"}],ip:0,op:600,st:0,ct:1},{ind:8,ty:4,nm:"A",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[302,720,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"rc",d:1,s:{a:0,k:[107,32]},p:{a:0,k:[0,0]},r:{a:0,k:0},nm:"R"},{ty:"fl",c:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:92,s:[1,1,1,1]},{t:110,s:[.906,.945,.925,1]}]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"R"}],ip:0,op:600,st:0,ct:1},{ind:9,ty:4,nm:"B",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[738,448,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"rc",d:1,s:{a:0,k:[107,32]},p:{a:0,k:[0,0]},r:{a:0,k:0},nm:"R"},{ty:"fl",c:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:70,s:[1,1,1,1]},{t:88,s:[.906,.945,.925,1]}]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"R"}],ip:0,op:600,st:0,ct:1},{ind:10,ty:4,nm:"B",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[738,584,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"rc",d:1,s:{a:0,k:[107,32]},p:{a:0,k:[0,0]},r:{a:0,k:0},nm:"R"},{ty:"fl",c:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:70,s:[1,1,1,1]},{t:88,s:[.906,.945,.925,1]}]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"R"}],ip:0,op:600,st:0,ct:1},{ind:11,ty:4,nm:"B",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[738,720,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"rc",d:1,s:{a:0,k:[107,32]},p:{a:0,k:[0,0]},r:{a:0,k:0},nm:"R"},{ty:"fl",c:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:92,s:[1,1,1,1]},{t:110,s:[.906,.945,.925,1]}]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"R"}],ip:0,op:600,st:0,ct:1},{ind:12,ty:4,nm:"R",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[2239.729,438.812,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"rc",d:1,s:{a:0,k:[37,12]},p:{a:0,k:[0,0]},r:{a:0,k:12},nm:"R"},{ty:"fl",c:{a:0,k:[.879,.879,.879,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"R"}],ip:0,op:600,st:0,ct:1},{ind:13,ty:4,nm:"C",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[2683.69,440.232,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[.081,-.081],[0,0],[0,0],[0,0],[-.081,-.081],[0,0],[0,0],[0,0],[-.081,-.081],[0,0],[-.081,.081],[0,0],[0,0],[0,0],[-.081,.081],[0,0],[.081,.081],[0,0],[0,0],[0,0],[.081,.081],[0,0],[.081,-.081],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[-.063,.091],[0,0],[0,0],[0,0],[-.063,.091],[0,0],[.091,.063],[0,0],[0,0],[0,0],[.091,.063],[0,0],[.063,-.091],[0,0],[0,0],[0,0],[.063,-.091],[0,0],[-.091,-.063],[0,0],[0,0],[0,0],[-.091,-.063]],v:[[-2.719,-2.719],[-2.746,-2.687],[-2.719,-2.719],[-2.746,-2.687],[-2.719,-2.391],[-.328,0],[-2.719,2.391],[-2.746,2.423],[-2.719,2.719],[-2.687,2.746],[-2.391,2.719],[0,.328],[2.391,2.719],[2.423,2.746],[2.719,2.719],[2.746,2.687],[2.719,2.391],[.328,0],[2.719,-2.391],[2.746,-2.423],[2.719,-2.719],[2.687,-2.746],[2.391,-2.719],[0,-.328],[-2.391,-2.719],[-2.423,-2.746]],c:!0}},nm:"P"},{ty:"fl",c:{a:0,k:[.129,.129,.129,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"S"}],ip:0,op:600,st:0,ct:1},{ind:14,ty:4,nm:"C",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[2567,854,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:1,k:[{i:{x:.1,y:1},o:{x:.33,y:0},t:259,s:[{i:[[-.293,.293],[-.293,-.293],[0,0],[0,0],[-.293,-.293],[.293,-.293],[0,0],[.293,.293],[0,0]],o:[[.293,-.293],[0,0],[0,0],[.293,-.293],[.293,.293],[0,0],[-.293,.293],[0,0],[-.293,-.293]],v:[[-8.28,.47],[-7.22,.47],[-3.25,4.439],[7.22,-6.03],[8.28,-6.03],[8.28,-4.97],[-2.72,6.03],[-3.78,6.03],[-8.28,1.53]],c:!0}]},{i:{x:.1,y:1},o:{x:.33,y:0},t:274,s:[{i:[[-.293,.293],[-.293,-.293],[0,0],[0,0],[-.293,-.293],[.293,-.293],[0,0],[.293,.293],[0,0]],o:[[.293,-.293],[0,0],[0,0],[.293,-.293],[.293,.293],[0,0],[-.293,.293],[0,0],[-.293,-.293]],v:[[-8.28,.47],[-7.22,.47],[-3.25,4.439],[2.196,-1.054],[3.257,-1.054],[3.257,.007],[-2.72,6.03],[-3.78,6.03],[-8.28,1.53]],c:!0}]},{t:281,s:[{i:[[-.293,.293],[-.293,-.293],[0,0],[0,0],[-.293,-.293],[.293,-.293],[0,0],[.293,.293],[0,0]],o:[[.293,-.293],[0,0],[0,0],[.293,-.293],[.293,.293],[0,0],[-.293,.293],[0,0],[-.293,-.293]],v:[[-8.28,.47],[-7.22,.47],[-3.25,4.439],[7.22,-6.03],[8.28,-6.03],[8.28,-4.97],[-2.72,6.03],[-3.78,6.03],[-8.28,1.53]],c:!0}]}]},nm:"P"},{ty:"fl",c:{a:0,k:[1,1,1,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"S"}],ip:0,op:600,st:0,ct:1},{ind:15,ty:4,nm:"B",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[2566,852,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"rc",d:1,s:{a:0,k:[67,34]},p:{a:0,k:[0,0]},r:{a:0,k:11},nm:"R"},{ty:"fl",c:{a:1,k:[{i:{x:[.1],y:[1]},o:{x:[.33],y:[0]},t:142,s:[.741,.741,.741,1]},{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:155,s:[.063,.486,.255,1]},{i:{x:[.1],y:[1]},o:{x:[.33],y:[0]},t:259,s:[.063,.486,.255,1]},{i:{x:[.1],y:[1]},o:{x:[.33],y:[0]},t:274,s:[.438,.78,.593,1]},{t:284,s:[.063,.486,.255,1]}]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"R"}],ip:0,op:600,st:0,ct:1},{ind:16,ty:4,nm:"B",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[2566,852,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"rc",d:1,s:{a:0,k:[67,34]},p:{a:0,k:[0,0]},r:{a:0,k:11},nm:"R"},{ty:"fl",c:{a:1,k:[{i:{x:[.1],y:[1]},o:{x:[.33],y:[0]},t:142,s:[.741,.741,.741,1]},{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:155,s:[.063,.486,.255,1]},{i:{x:[.1],y:[1]},o:{x:[.33],y:[0]},t:259,s:[.063,.486,.255,1]},{i:{x:[.1],y:[1]},o:{x:[.33],y:[0]},t:274,s:[.438,.78,.593,1]},{t:284,s:[.063,.486,.255,1]}]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"R"}],ip:0,op:600,st:0,ct:1},{ind:17,ty:4,nm:"R",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[2306.528,853,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"rc",d:1,s:{a:0,k:[49.809,16.572]},p:{a:0,k:[0,0]},r:{a:0,k:12},nm:"R"},{ty:"fl",c:{a:0,k:[.879,.879,.879,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"R"}],ip:0,op:600,st:0,ct:1},{ind:18,ty:4,nm:"R",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[2342,852,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"rc",d:1,s:{a:0,k:[89,34]},p:{a:0,k:[0,0]},r:{a:0,k:11},nm:"R"},{ty:"fl",c:{a:0,k:[1,1,1,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"R"}],ip:0,op:600,st:0,ct:1},{ind:19,ty:4,nm:"R",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[2430,622,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"rc",d:1,s:{a:0,k:[133,65]},p:{a:0,k:[0,0]},r:{a:0,k:4},nm:"R"},{ty:"fl",c:{a:0,k:[.933,.933,.933,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"R"}],ip:0,op:600,st:0,ct:1},{ind:20,ty:4,nm:"R",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[2434,960,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0],[0,4.418]],o:[[0,0],[0,0],[0,0],[4.418,0],[0,0]],v:[[74.5,-144],[-74.5,-144],[-74.5,144],[66.5,144],[74.5,136]],c:!0}},nm:"P"},{ty:"fl",c:{a:0,k:[.961,.961,.961,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"R"}],ip:0,op:600,st:0,ct:1},{ind:21,ty:4,nm:"R",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[1948,936,0],l:2},a:{a:0,k:[0,240,0],l:2},s:{a:1,k:[{i:{x:[.4,.4,.4],y:[1,1,1]},o:{x:[.29,.29,.29],y:[0,1.58,0]},t:291,s:[100,0,100]},{t:318,s:[100,100,100]}],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"rc",d:1,s:{a:0,k:[40,120]},p:{a:0,k:[0,0]},r:{a:0,k:0},nm:"R"},{ty:"fl",c:{a:0,k:[.443,.698,.557,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"R"}],ip:291,op:723,st:91,ct:1},{ind:22,ty:4,nm:"R",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[1588,936,0],l:2},a:{a:0,k:[0,160,0],l:2},s:{a:1,k:[{i:{x:[.4,.4,.4],y:[1,1,1]},o:{x:[.29,.29,.29],y:[0,1.58,0]},t:285,s:[100,0,100]},{t:312,s:[100,100,100]}],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"rc",d:1,s:{a:0,k:[40,80]},p:{a:0,k:[0,0]},r:{a:0,k:0},nm:"R"},{ty:"fl",c:{a:0,k:[.631,.796,.706,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"R"}],ip:285,op:723,st:91,ct:1},{ind:23,ty:4,nm:"R",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[1228,936,0],l:2},a:{a:0,k:[0,80,0],l:2},s:{a:1,k:[{i:{x:[.4,.4,.4],y:[1,1,1]},o:{x:[.29,.29,.29],y:[0,1.58,0]},t:281,s:[100,0,100]},{t:308,s:[100,100,100]}],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"rc",d:1,s:{a:0,k:[40,40]},p:{a:0,k:[0,0]},r:{a:0,k:0},nm:"R"},{ty:"fl",c:{a:0,k:[.906,.945,.925,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"R"}],ip:281,op:723,st:91,ct:1},{ind:24,ty:4,nm:"L",sr:1,ks:{o:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:281,s:[0]},{t:295,s:[100]}]},r:{a:0,k:0},p:{a:0,k:[1589,696,0],l:2},a:{a:0,k:[1588,696,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:1,k:[{i:{x:0,y:1},o:{x:.001,y:0},t:281,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-39.25,0],[110,0]],c:!1}]},{t:321,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-110,0],[110,0]],c:!1}]}]},nm:"P"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"L"},{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:1,k:[{i:{x:0,y:1},o:{x:.001,y:0},t:281,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-39.25,-39.75],[110,-39.75]],c:!1}]},{t:321,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-110,-39.75],[110,-39.75]],c:!1}]}]},nm:"P"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"L"},{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:1,k:[{i:{x:0,y:1},o:{x:.001,y:0},t:281,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-39.25,-80],[110,-80]],c:!1}]},{t:321,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-110,-80],[110,-80]],c:!1}]}]},nm:"P"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"L"},{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:1,k:[{i:{x:0,y:1},o:{x:.001,y:0},t:281,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-39.25,-120.25],[110,-120.25]],c:!1}]},{t:321,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-110,-120.25],[110,-120.25]],c:!1}]}]},nm:"P"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"L"},{ty:"st",c:{a:0,k:[.879,.879,.879,1]},o:{a:0,k:100},w:{a:0,k:1},lc:1,lj:1,ml:4,nm:"S"},{ty:"tr",p:{a:0,k:[1588,456]},a:{a:0,k:[0,0]},s:{a:0,k:[-100,-100]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"L"}],ip:281,op:723,st:123,ct:1},{ind:25,ty:4,nm:"F",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[1598,1e3,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:1,k:[{i:{x:0,y:1},o:{x:.001,y:0},t:280,s:[{i:[[0,0],[0,-4.418],[-4.418,0],[0,0],[0,4.418],[4.418,0]],o:[[-4.418,0],[0,4.418],[0,0],[4.418,0],[0,-4.418],[0,0]],v:[[-99.375,-8],[-107.375,0],[-99.375,8],[-89.125,8],[-81.125,0],[-89.125,-8]],c:!0}]},{t:303,s:[{i:[[0,0],[0,-4.418],[-4.418,0],[0,0],[0,4.418],[4.418,0]],o:[[-4.418,0],[0,4.418],[0,0],[4.418,0],[0,-4.418],[0,0]],v:[[-109.5,-8],[-117.5,0],[-109.5,8],[-75.5,8],[-67.5,0],[-75.5,-8]],c:!0}]}]},nm:"P"},{ind:1,ty:"sh",ks:{a:1,k:[{i:{x:0,y:1},o:{x:.001,y:0},t:285,s:[{i:[[0,0],[0,-4.418],[-4.418,0],[0,0],[0,4.418],[4.418,0]],o:[[-4.418,0],[0,4.418],[0,0],[4.418,0],[0,-4.418],[0,0]],v:[[-10.75,-8],[-18.75,0],[-10.75,8],[6.125,8],[14.125,0],[6.125,-8]],c:!0}]},{t:308,s:[{i:[[0,0],[0,-4.418],[-4.418,0],[0,0],[0,4.418],[4.418,0]],o:[[-4.418,0],[0,4.418],[0,0],[4.418,0],[0,-4.418],[0,0]],v:[[-29.5,-8],[-37.5,0],[-29.5,8],[24.5,8],[32.5,0],[24.5,-8]],c:!0}]}]},nm:"P"},{ind:2,ty:"sh",ks:{a:1,k:[{i:{x:0,y:1},o:{x:.001,y:0},t:289,s:[{i:[[0,4.418],[-4.418,0],[0,0],[0,-4.418],[4.418,0],[0,0]],o:[[0,-4.418],[0,0],[4.418,0],[0,4.418],[0,0],[-4.418,0]],v:[[70.125,0],[78.125,-8],[98.375,-8],[106.375,0],[98.375,8],[78.125,8]],c:!0}]},{t:312,s:[{i:[[0,4.418],[-4.418,0],[0,0],[0,-4.418],[4.418,0],[0,0]],o:[[0,-4.418],[0,0],[4.418,0],[0,4.418],[0,0],[-4.418,0]],v:[[57.5,0],[65.5,-8],[109.5,-8],[117.5,0],[109.5,8],[65.5,8]],c:!0}]}]},nm:"P"},{ty:"fl",c:{a:0,k:[.879,.879,.879,1]},o:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:282,s:[0]},{t:292,s:[100]}]},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"F"}],ip:281,op:723,st:123,ct:1},{ind:26,ty:4,nm:"$",sr:1,ks:{o:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:281,s:[0]},{t:303,s:[100]}]},r:{a:0,k:0},p:{a:0,k:[1079.066,611.162,0],l:2},a:{a:0,k:[1080.066,598.162,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[-.483,.463],[0,.757],[.433,.463],[.998,.36],[0,0],[-.638,-.387],[0,0],[.962,.046],[0,0],[0,0],[0,0],[.506,-.504],[0,-.715],[-.39,-.462],[-1.066,-.396],[0,0],[.524,.182],[.264,.214],[0,0],[-.925,-.004],[0,0],[0,0],[0,0]],o:[[.483,-.462],[0,-.656],[-.433,-.462],[0,0],[.797,.087],[0,0],[-.474,-.264],[0,0],[0,0],[0,0],[-.834,.082],[-.506,.504],[0,.665],[.39,.463],[0,0],[-.41,-.027],[-.524,-.182],[0,0],[.797,.415],[0,0],[0,0],[0,0],[.898,-.1]],v:[[-4.979,-.036],[-4.255,-1.864],[-4.904,-3.542],[-7.051,-4.776],[-7.051,-7.367],[-4.897,-6.656],[-4.897,-8.502],[-7.051,-8.967],[-7.051,-10.211],[-8.049,-10.211],[-8.049,-8.939],[-10.059,-8.061],[-10.817,-6.232],[-10.233,-4.541],[-8.049,-3.252],[-8.049,-.764],[-9.45,-1.078],[-10.633,-1.673],[-10.633,.221],[-8.049,.85],[-8.049,2.292],[-7.051,2.292],[-7.051,.809]],c:!0}},nm:"$"},{ind:1,ty:"sh",ks:{a:0,k:{i:[[0,.469],[-.633,.114],[0,0]],o:[[0,-.547],[0,0],[-.633,-.314]],v:[[-8.999,-6.349],[-8.049,-7.34],[-8.049,-5.173]],c:!0}},nm:"$"},{ind:2,ty:"sh",ks:{a:0,k:{i:[[0,-.447],[.652,-.1],[0,0]],o:[[0,.551],[0,0],[.652,.283]],v:[[-6.073,-1.769],[-7.051,-.791],[-7.051,-2.862]],c:!0}},nm:"$"},{ty:"fl",c:{a:0,k:[.38,.38,.38,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"},{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[-.483,.463],[0,.757],[.433,.463],[.998,.36],[0,0],[-.638,-.387],[0,0],[.962,.046],[0,0],[0,0],[0,0],[.506,-.504],[0,-.715],[-.39,-.462],[-1.066,-.396],[0,0],[.524,.182],[.264,.214],[0,0],[-.925,-.004],[0,0],[0,0],[0,0]],o:[[.483,-.462],[0,-.656],[-.433,-.462],[0,0],[.797,.087],[0,0],[-.474,-.264],[0,0],[0,0],[0,0],[-.834,.082],[-.506,.504],[0,.665],[.39,.463],[0,0],[-.41,-.027],[-.524,-.182],[0,0],[.797,.415],[0,0],[0,0],[0,0],[.898,-.1]],v:[[3.073,-.036],[3.798,-1.864],[3.148,-3.542],[1.002,-4.776],[1.002,-7.367],[3.155,-6.656],[3.155,-8.502],[1.002,-8.967],[1.002,-10.211],[.004,-10.211],[.004,-8.939],[-2.006,-8.061],[-2.765,-6.232],[-2.18,-4.541],[.004,-3.252],[.004,-.764],[-1.397,-1.078],[-2.58,-1.673],[-2.58,.221],[.004,.85],[.004,2.292],[1.002,2.292],[1.002,.809]],c:!0}},nm:"$"},{ind:1,ty:"sh",ks:{a:0,k:{i:[[0,.469],[-.633,.114],[0,0]],o:[[0,-.547],[0,0],[-.633,-.314]],v:[[-.946,-6.349],[.004,-7.34],[.004,-5.173]],c:!0}},nm:"$"},{ind:2,ty:"sh",ks:{a:0,k:{i:[[0,-.447],[.652,-.1],[0,0]],o:[[0,.551],[0,0],[.652,.283]],v:[[1.979,-1.769],[1.002,-.791],[1.002,-2.862]],c:!0}},nm:"$"},{ty:"fl",c:{a:0,k:[.38,.38,.38,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"},{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[-.483,.463],[0,.757],[.433,.463],[.998,.36],[0,0],[-.638,-.387],[0,0],[.962,.046],[0,0],[0,0],[0,0],[.506,-.504],[0,-.715],[-.39,-.462],[-1.066,-.396],[0,0],[.524,.182],[.264,.214],[0,0],[-.925,-.004],[0,0],[0,0],[0,0]],o:[[.483,-.462],[0,-.656],[-.433,-.462],[0,0],[.797,.087],[0,0],[-.474,-.264],[0,0],[0,0],[0,0],[-.834,.082],[-.506,.504],[0,.665],[.39,.463],[0,0],[-.41,-.027],[-.524,-.182],[0,0],[.797,.415],[0,0],[0,0],[0,0],[.898,-.1]],v:[[11.126,-.036],[11.851,-1.864],[11.201,-3.542],[9.055,-4.776],[9.055,-7.367],[11.208,-6.656],[11.208,-8.502],[9.055,-8.967],[9.055,-10.211],[8.057,-10.211],[8.057,-8.939],[6.047,-8.061],[5.288,-6.232],[5.873,-4.541],[8.057,-3.252],[8.057,-.764],[6.655,-1.078],[5.473,-1.673],[5.473,.221],[8.057,.85],[8.057,2.292],[9.055,2.292],[9.055,.809]],c:!0}},nm:"$"},{ind:1,ty:"sh",ks:{a:0,k:{i:[[0,.469],[-.633,.114],[0,0]],o:[[0,-.547],[0,0],[-.633,-.314]],v:[[7.106,-6.349],[8.057,-7.34],[8.057,-5.173]],c:!0}},nm:"$"},{ind:2,ty:"sh",ks:{a:0,k:{i:[[0,-.447],[.652,-.1],[0,0]],o:[[0,.551],[0,0],[.652,.283]],v:[[10.032,-1.769],[9.055,-.791],[9.055,-2.862]],c:!0}},nm:"$"},{ty:"fl",c:{a:0,k:[.38,.38,.38,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"},{ty:"tr",p:{a:0,k:[1078,454]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"},{ty:"gr",it:[{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[-.483,.463],[0,.757],[.433,.463],[.998,.36],[0,0],[-.638,-.387],[0,0],[.962,.046],[0,0],[0,0],[0,0],[.506,-.504],[0,-.715],[-.39,-.462],[-1.066,-.396],[0,0],[.524,.182],[.264,.214],[0,0],[-.925,-.004],[0,0],[0,0],[0,0]],o:[[.483,-.462],[0,-.656],[-.433,-.462],[0,0],[.797,.087],[0,0],[-.474,-.264],[0,0],[0,0],[0,0],[-.834,.082],[-.506,.504],[0,.665],[.39,.463],[0,0],[-.41,-.027],[-.524,-.182],[0,0],[.797,.415],[0,0],[0,0],[0,0],[.898,-.1]],v:[[-.927,-.036],[-.202,-1.864],[-.852,-3.542],[-2.998,-4.776],[-2.998,-7.367],[-.845,-6.656],[-.845,-8.502],[-2.998,-8.967],[-2.998,-10.211],[-3.996,-10.211],[-3.996,-8.939],[-6.006,-8.061],[-6.765,-6.232],[-6.18,-4.541],[-3.996,-3.252],[-3.996,-.764],[-5.397,-1.078],[-6.58,-1.673],[-6.58,.221],[-3.996,.85],[-3.996,2.292],[-2.998,2.292],[-2.998,.809]],c:!0}},nm:"$"},{ind:1,ty:"sh",ks:{a:0,k:{i:[[0,.469],[-.633,.114],[0,0]],o:[[0,-.547],[0,0],[-.633,-.314]],v:[[-4.946,-6.349],[-3.996,-7.34],[-3.996,-5.173]],c:!0}},nm:"$"},{ind:2,ty:"sh",ks:{a:0,k:{i:[[0,-.447],[.652,-.1],[0,0]],o:[[0,.551],[0,0],[.652,.283]],v:[[-2.021,-1.769],[-2.998,-.791],[-2.998,-2.862]],c:!0}},nm:"$"},{ty:"fl",c:{a:0,k:[.38,.38,.38,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"},{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[-.483,.463],[0,.757],[.433,.463],[.998,.36],[0,0],[-.638,-.387],[0,0],[.962,.046],[0,0],[0,0],[0,0],[.506,-.504],[0,-.715],[-.39,-.462],[-1.066,-.396],[0,0],[.524,.182],[.264,.214],[0,0],[-.925,-.004],[0,0],[0,0],[0,0]],o:[[.483,-.462],[0,-.656],[-.433,-.462],[0,0],[.797,.087],[0,0],[-.474,-.264],[0,0],[0,0],[0,0],[-.834,.082],[-.506,.504],[0,.665],[.39,.463],[0,0],[-.41,-.027],[-.524,-.182],[0,0],[.797,.415],[0,0],[0,0],[0,0],[.898,-.1]],v:[[7.126,-.036],[7.851,-1.864],[7.201,-3.542],[5.055,-4.776],[5.055,-7.367],[7.208,-6.656],[7.208,-8.502],[5.055,-8.967],[5.055,-10.211],[4.057,-10.211],[4.057,-8.939],[2.047,-8.061],[1.288,-6.232],[1.873,-4.541],[4.057,-3.252],[4.057,-.764],[2.655,-1.078],[1.473,-1.673],[1.473,.221],[4.057,.85],[4.057,2.292],[5.055,2.292],[5.055,.809]],c:!0}},nm:"$"},{ind:1,ty:"sh",ks:{a:0,k:{i:[[0,.469],[-.633,.114],[0,0]],o:[[0,-.547],[0,0],[-.633,-.314]],v:[[3.106,-6.349],[4.057,-7.34],[4.057,-5.173]],c:!0}},nm:"$"},{ind:2,ty:"sh",ks:{a:0,k:{i:[[0,-.447],[.652,-.1],[0,0]],o:[[0,.551],[0,0],[.652,.283]],v:[[6.032,-1.769],[5.055,-.791],[5.055,-2.862]],c:!0}},nm:"$"},{ty:"fl",c:{a:0,k:[.38,.38,.38,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"},{ty:"tr",p:{a:0,k:[1078,614]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"},{ty:"gr",it:[{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[-.483,.463],[0,.757],[.433,.463],[.998,.36],[0,0],[-.638,-.387],[0,0],[.962,.046],[0,0],[0,0],[0,0],[.506,-.504],[0,-.715],[-.39,-.462],[-1.066,-.396],[0,0],[.524,.182],[.264,.214],[0,0],[-.925,-.004],[0,0],[0,0],[0,0]],o:[[.483,-.462],[0,-.656],[-.433,-.462],[0,0],[.797,.087],[0,0],[-.474,-.264],[0,0],[0,0],[0,0],[-.834,.082],[-.506,.504],[0,.665],[.39,.463],[0,0],[-.41,-.027],[-.524,-.182],[0,0],[.797,.415],[0,0],[0,0],[0,0],[.898,-.1]],v:[[3.126,-.036],[3.851,-1.864],[3.201,-3.542],[1.055,-4.776],[1.055,-7.367],[3.208,-6.656],[3.208,-8.502],[1.055,-8.967],[1.055,-10.211],[.057,-10.211],[.057,-8.939],[-1.953,-8.061],[-2.712,-6.232],[-2.127,-4.541],[.057,-3.252],[.057,-.764],[-1.345,-1.078],[-2.527,-1.673],[-2.527,.221],[.057,.85],[.057,2.292],[1.055,2.292],[1.055,.809]],c:!0}},nm:"$"},{ind:1,ty:"sh",ks:{a:0,k:{i:[[0,.469],[-.633,.114],[0,0]],o:[[0,-.547],[0,0],[-.633,-.314]],v:[[-.894,-6.349],[.057,-7.34],[.057,-5.173]],c:!0}},nm:"$"},{ind:2,ty:"sh",ks:{a:0,k:{i:[[0,-.447],[.652,-.1],[0,0]],o:[[0,.551],[0,0],[.652,.283]],v:[[2.032,-1.769],[1.055,-.791],[1.055,-2.862]],c:!0}},nm:"$"},{ty:"fl",c:{a:0,k:[.38,.38,.38,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"},{ty:"tr",p:{a:0,k:[1078,774]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"}],ip:281,op:723,st:123,ct:1},{ind:27,ty:4,nm:"R",sr:1,ks:{o:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:271,s:[0]},{t:285,s:[100]}]},r:{a:0,k:0},p:{a:0,k:[1548,724,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"rc",d:1,s:{a:1,k:[{i:{x:[0,0],y:[1,1]},o:{x:[.001,.001],y:[0,0]},t:271,s:[276,119]},{t:302,s:[276,170]}]},p:{a:0,k:[0,0]},r:{a:0,k:0},nm:"R"},{ty:"st",c:{a:0,k:[.38,.38,.38,1]},o:{a:0,k:100},w:{a:0,k:1},lc:1,lj:1,ml:4,nm:"S"},{ty:"fl",c:{a:0,k:[1,1,1,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"R"}],ip:271,op:723,st:123,ct:1},{ind:28,ty:4,nm:"W",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[1174,992,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-53.5,-152],[53.5,-152],[53.5,-120],[-53.5,-120]],c:!0}},nm:"P"},{ind:1,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-164.5,-50],[-271.5,-50],[-271.5,-18],[-164.5,-18]],c:!0}},nm:"P"},{ind:2,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-164.5,-16],[-271.5,-16],[-271.5,16],[-164.5,16]],c:!0}},nm:"P"},{ind:3,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-271.5,18],[-164.5,18],[-164.5,50],[-271.5,50]],c:!0}},nm:"P"},{ind:4,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-164.5,52],[-271.5,52],[-271.5,84],[-164.5,84]],c:!0}},nm:"P"},{ind:5,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-271.5,86],[-164.5,86],[-164.5,118],[-271.5,118]],c:!0}},nm:"P"},{ind:6,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-164.5,120],[-271.5,120],[-271.5,152],[-164.5,152]],c:!0}},nm:"P"},{ind:7,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-162.5,-50],[-55.5,-50],[-55.5,-18],[-162.5,-18]],c:!0}},nm:"P"},{ind:8,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-55.5,-16],[-162.5,-16],[-162.5,16],[-55.5,16]],c:!0}},nm:"P"},{ind:9,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-162.5,18],[-55.5,18],[-55.5,50],[-162.5,50]],c:!0}},nm:"P"},{ind:10,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-55.5,52],[-162.5,52],[-162.5,84],[-55.5,84]],c:!0}},nm:"P"},{ind:11,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-162.5,86],[-55.5,86],[-55.5,118],[-162.5,118]],c:!0}},nm:"P"},{ind:12,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-55.5,120],[-162.5,120],[-162.5,152],[-55.5,152]],c:!0}},nm:"P"},{ind:13,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[53.5,-118],[-53.5,-118],[-53.5,-86],[53.5,-86]],c:!0}},nm:"P"},{ind:14,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-53.5,-84],[53.5,-84],[53.5,-52],[-53.5,-52]],c:!0}},nm:"P"},{ind:15,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[53.5,-50],[-53.5,-50],[-53.5,-18],[53.5,-18]],c:!0}},nm:"P"},{ind:16,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-53.5,-16],[53.5,-16],[53.5,16],[-53.5,16]],c:!0}},nm:"P"},{ind:17,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[53.5,18],[-53.5,18],[-53.5,50],[53.5,50]],c:!0}},nm:"P"},{ind:18,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-53.5,52],[53.5,52],[53.5,84],[-53.5,84]],c:!0}},nm:"P"},{ind:19,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[53.5,86],[-53.5,86],[-53.5,118],[53.5,118]],c:!0}},nm:"P"},{ind:20,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-53.5,120],[53.5,120],[53.5,152],[-53.5,152]],c:!0}},nm:"P"},{ind:21,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[162.5,-152],[55.5,-152],[55.5,-120],[162.5,-120]],c:!0}},nm:"P"},{ind:22,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[55.5,-118],[162.5,-118],[162.5,-86],[55.5,-86]],c:!0}},nm:"P"},{ind:23,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[162.5,-84],[55.5,-84],[55.5,-52],[162.5,-52]],c:!0}},nm:"P"},{ind:24,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[55.5,-50],[162.5,-50],[162.5,-18],[55.5,-18]],c:!0}},nm:"P"},{ind:25,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[162.5,-16],[55.5,-16],[55.5,16],[162.5,16]],c:!0}},nm:"P"},{ind:26,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[55.5,18],[162.5,18],[162.5,50],[55.5,50]],c:!0}},nm:"P"},{ind:27,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[162.5,52],[55.5,52],[55.5,84],[162.5,84]],c:!0}},nm:"P"},{ind:28,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[55.5,86],[162.5,86],[162.5,118],[55.5,118]],c:!0}},nm:"P"},{ind:29,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[162.5,120],[55.5,120],[55.5,152],[162.5,152]],c:!0}},nm:"P"},{ind:30,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[164.5,-152],[271.5,-152],[271.5,-120],[164.5,-120]],c:!0}},nm:"P"},{ind:31,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[271.5,-118],[164.5,-118],[164.5,-86],[271.5,-86]],c:!0}},nm:"P"},{ind:32,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[164.5,-84],[271.5,-84],[271.5,-52],[164.5,-52]],c:!0}},nm:"P"},{ind:33,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[271.5,-50],[164.5,-50],[164.5,-18],[271.5,-18]],c:!0}},nm:"P"},{ind:34,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[164.5,-16],[271.5,-16],[271.5,16],[164.5,16]],c:!0}},nm:"P"},{ind:35,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[271.5,18],[164.5,18],[164.5,50],[271.5,50]],c:!0}},nm:"P"},{ind:36,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[164.5,52],[271.5,52],[271.5,84],[164.5,84]],c:!0}},nm:"P"},{ind:37,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[271.5,86],[164.5,86],[164.5,118],[271.5,118]],c:!0}},nm:"P"},{ind:38,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[164.5,120],[271.5,120],[271.5,152],[164.5,152]],c:!0}},nm:"P"},{ty:"fl",c:{a:0,k:[1,1,1,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"W"}],ip:0,op:600,st:0,ct:1},{ind:29,ty:4,nm:"F",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[1366,172,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[0,0],[-2.209,0],[0,0],[0,-2.209],[0,0],[2.209,0],[0,0],[0,2.209]],o:[[0,-2.209],[0,0],[2.209,0],[0,0],[0,2.209],[0,0],[-2.209,0],[0,0]],v:[[-194.5,-35],[-190.5,-39],[-11.5,-39],[-7.5,-35],[-7.5,-27],[-11.5,-23],[-190.5,-23],[-194.5,-27]],c:!0}},nm:"P"},{ind:1,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,-2.209],[0,0],[-2.209,0],[0,0],[0,2.209],[0,0],[2.209,0]],o:[[-2.209,0],[0,0],[0,2.209],[0,0],[2.209,0],[0,0],[0,-2.209],[0,0]],v:[[-329.5,-4],[-333.5,0],[-333.5,16],[-329.5,20],[329.5,20],[333.5,16],[333.5,0],[329.5,-4]],c:!0}},nm:"P"},{ind:2,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,-2.209],[0,0],[-2.209,0],[0,0],[0,2.209],[0,0],[2.209,0]],o:[[-2.209,0],[0,0],[0,2.209],[0,0],[2.209,0],[0,0],[0,-2.209],[0,0]],v:[[-178.5,23],[-182.5,27],[-182.5,35],[-178.5,39],[329.5,39],[333.5,35],[333.5,27],[329.5,23]],c:!0}},nm:"P"},{ind:3,ty:"sh",ks:{a:0,k:{i:[[0,0],[-2.209,0],[0,0],[0,-2.209],[0,0],[2.209,0],[0,0],[0,2.209]],o:[[0,-2.209],[0,0],[2.209,0],[0,0],[0,2.209],[0,0],[-2.209,0],[0,0]],v:[[-333.5,27],[-329.5,23],[-257.5,23],[-253.5,27],[-253.5,35],[-257.5,39],[-329.5,39],[-333.5,35]],c:!0}},nm:"P"},{ind:4,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,-2.209],[0,0],[-2.209,0],[0,0],[0,2.209],[0,0],[2.209,0]],o:[[-2.209,0],[0,0],[0,2.209],[0,0],[2.209,0],[0,0],[0,-2.209],[0,0]],v:[[-245.5,23],[-249.5,27],[-249.5,35],[-245.5,39],[-190.5,39],[-186.5,35],[-186.5,27],[-190.5,23]],c:!0}},nm:"P"},{ty:"fl",c:{a:0,k:[1,1,1,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"F"}],ip:0,op:600,st:0,ct:1},{ind:30,ty:4,nm:"B",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[1366,768,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"rc",d:1,s:{a:0,k:[683,384]},p:{a:0,k:[0,0]},r:{a:0,k:8},nm:"R"},{ty:"fl",c:{a:0,k:[.961,.961,.961,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"B"}],ip:0,op:600,st:0,ct:1}]}],layers:[{ind:1,ty:0,nm:"P",refId:"comp_0",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:1,k:[{i:{x:.1,y:1},o:{x:.33,y:0},t:0,s:[580,236,0],to:[0,0,0],ti:[0,0,0]},{i:{x:.1,y:.1},o:{x:.33,y:.33},t:55,s:[1e3,340,0],to:[0,0,0],ti:[0,0,0]},{i:{x:.1,y:1},o:{x:.167,y:0},t:158,s:[1e3,340,0],to:[0,0,0],ti:[0,0,0]},{t:231,s:[580,236,0]}],l:2},a:{a:0,k:[1366,768,0],l:2},s:{a:1,k:[{i:{x:[.1,.1,.1],y:[1,1,1]},o:{x:[.33,.33,.33],y:[0,0,0]},t:0,s:[25,25,100]},{i:{x:[.833,.833,.833],y:[1,1,1]},o:{x:[.33,.33,.33],y:[0,0,0]},t:55,s:[70,70,100]},{i:{x:[.1,.1,.1],y:[1,1,1]},o:{x:[.167,.167,.167],y:[0,0,0]},t:158,s:[70,70,100]},{t:231,s:[25,25,100]}],l:2}},ao:0,w:2732,h:1536,ip:0,op:600,st:0}],markers:[]};var Uo=n(611975);const qo=e=>{const t=(0,Do.D)(),n={height:"114.228px",width:"280.73px",margin:"0px !important",backgroundColor:t.palette.themeLighter,border:"1px solid #d1d1d1"},a={marginTop:"6px",marginBottom:"6px",marginRight:"6px"};return I.createElement(Io.Z,{className:"ChartRecommendationCard"},I.createElement(Ro.a,{image:I.createElement(Po.hw3,{className:"sparkleIcon",color:t.palette?.green||"#078107"}),header:I.createElement(u.E,{className:"ChartRecommendationCardText"},c.olU.ChartDesignRecommendationsCardText)}),I.createElement("div",{className:"chart-card"},I.createElement("div",{className:"chart-grid"},I.createElement(ko.J,{className:"chartRecommendationLabel",tabIndex:-1},c.olU.ChartDesignRecommendationsPreviewDesignSnowballChartLabel1),I.createElement(ko.J,{className:"chartRecommendationLabel",tabIndex:-1},I.createElement("b",null,c.olU.ChartDesignRecommendationsPreviewDesignSnowballChartLabel2)),e.isTriggeredViaOOUI?null:I.createElement("div",{className:"sourceLottie",style:a,tabIndex:-1},I.createElement(Uo.A,{options:{animationData:Ho,loop:!0,autoplay:!0,rendererSettings:{className:"sourceLottie"}},isClickToPauseDisabled:!0,style:n,ariaLabel:"animation"})))))};var Vo=n(548923),Wo=n(493413);const Go={cardStack:{"& > :first-child":{marginBottom:"2px"},backgroundColor:f.k1.neutralLight,color:f.k1.neutralDark},bulletList:{marginTop:"8px",marginBottom:"8px",paddingLeft:"25px"},bulletListHeader:{marginBottom:"4px"}},zo=(0,d.n)(Go);function Qo(e){return I.createElement(vo.lJ,{contentBody:function(){const e=zo();return I.createElement(Nn.B,{className:e.cardStack},I.createElement(u.E,null,(0,c.i3R)()),I.createElement(u.E,null,(0,c.pF5)()))}(),requestId:e.requestId,cardButtons:[]})}var jo=n(297591),Jo=n(57848),Yo=n(898701),Xo=n(823548),Zo=n(72331),Ko=n(814879),er=n(738648),tr=n(446751),nr=n(777555),ar=n(418218),or=n(518377),rr=n(210466),ir=n(245965);const lr=f.k1.neutralLight,sr=(0,ir.l8)({sliderButton:{alignSelf:"flex-end",backgroundColor:lr,border:lr,alignItems:"center",paddingLeft:0,paddingRight:0,":hover":{color:f.k1.themePrimary+" !important",cursor:"pointer",backgroundColor:"inherit"}},excelFileNameLink:{color:f.k1.colorNeutralForeground3,fontSize:f.k1.fontSizeBase200,lineHeight:"16px",padding:"5px",verticalAlign:"super",fontWeight:"600",":hover":{color:f.k1.themePrimary,cursor:"pointer"}},excelFileNameLinkInner:{color:f.k1.colorNeutralForeground3},excelFileNameSuffix:{display:"block",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",direction:"rtl",textAlign:"left",maxWidth:"100%",fontSize:f.k1.fontSizeBase200,fontWeight:"400",padding:"0",marginBottom:"-12px",color:f.k1.colorNeutralForeground3},importButton:{height:"24px",padding:"0 8px",width:"fit-content"},folderIcon:{color:f.k1.colorNeutralForeground3,marginTop:"1px"}}),cr={title:{justifyContent:"start",...rr.Pt.padding("0px",0),"&:hover":{color:f.k1.themePrimary,"&:active":{color:f.k1.themeDarkAlt}},"&:disabled":{color:f.k1.neutralQuaternary}},snippet:{transition:"max-height 0.5s ease-in-out"},snippetVisible:{maxHeight:"1000px"},snippetHidden:{maxHeight:"0"}},dr=(0,d.n)(cr);function ur(e){const[t,n]=(0,I.useState)(!1),[a,o]=(0,I.useState)(!1),[r,i]=(0,I.useState)(!1),l=dr(),s=r?(0,Ao.z)(l.snippet,l.snippetVisible):(0,Ao.z)(l.snippet,l.snippetHidden);return(0,I.useEffect)((()=>{t?(o(!0),setTimeout((()=>{i(!0)}),50)):(i(!1),setTimeout((()=>{o(!1)}),600))}),[t]),I.createElement(I.Fragment,null,I.createElement(Ln.$,{size:"small",appearance:"transparent",onClick:()=>{n(!t),e.logBodyShown&&!t&&e.logBodyShown()},"aria-expanded":t,className:l.title,icon:t?I.createElement(Jo.g4$,null):I.createElement(Jo.rLf,null),iconPosition:"after"},t?(0,c.Z4S)():(0,c.U45)()),a&&I.createElement("div",{className:s},I.createElement(or.$,{title:(0,c.m3r)(),content:I.createElement(I.Fragment,null,e.query),explanation:{explanation:e.explanation},alwaysShowExplanation:!0,telemetryUsageFeatureName:v.q.ImportDataFromSearch,getClipboardItem:async()=>new ClipboardItem({"text/plain":new Blob([e.query],{type:"text/plain"})}),ariaAttributes:{"aria-label":(0,c.m3r)()}})))}var mr=n(330123),gr=n(352893);const hr=(e,t)=>{const n=t.slice(0,4).map(((e,t)=>({row:t+2,values:e})));return t.length>4&&n.push({row:6,values:e.map((e=>"..."))}),0===n.length?(x.M.getInstance().logError({eventType:ot.S2.ImportData,errorMessage:"getSampleRows: No rows provided",logLevel:j.$b.Warning}),[{row:"...",values:e.map((e=>"..."))}]):n};var pr=n(318457);const br=()=>I.createElement("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},I.createElement("path",{fill:"#fff",d:"M7.5 22h14c.275 0 .5-.225.5-.5V7h-3.5c-.827 0-1.5-.673-1.5-1.5V2H7.5c-.275 0-.5.225-.5.5v19c0 .275.225.5.5.5z"}),I.createElement("path",{fill:"#fff",d:"M21.293 6 18 2.707V5.5c0 .275.225.5.5.5h2.793z"}),I.createElement("path",{fill:"#605E5C",fillRule:"evenodd",d:"m22.56 5.854-4.414-4.415A1.51 1.51 0 0 0 17.086 1H7.5C6.673 1 6 1.673 6 2.5v19c0 .827.673 1.5 1.5 1.5h14c.827 0 1.5-.673 1.5-1.5V6.914c0-.4-.156-.777-.44-1.06zM18 2.707 21.293 6H18.5a.501.501 0 0 1-.5-.5V2.707zM7.5 22h14c.275 0 .5-.225.5-.5V7h-3.5c-.827 0-1.5-.673-1.5-1.5V2H7.5c-.275 0-.5.225-.5.5v19a.5.5 0 0 0 .5.5z",clipRule:"evenodd",opacity:".64"}),I.createElement("path",{fill:"#134A2C",d:"M19 17h-1a1 1 0 1 1 0-2h1a1 1 0 1 1 0 2z"}),I.createElement("path",{fill:"#185C37",d:"M15 17h-1v-2h1a1 1 0 1 1 0 2z"}),I.createElement("path",{fill:"#21A366",d:"M19 14h-1a1 1 0 1 1 0-2h1a1 1 0 1 1 0 2z"}),I.createElement("path",{fill:"#107C41",d:"M15 14h-1v-2h1a1 1 0 1 1 0 2z"}),I.createElement("path",{fill:"#33C481",d:"M19 11h-1a1 1 0 1 1 0-2h1a1 1 0 1 1 0 2z"}),I.createElement("path",{fill:"#21A366",d:"M15 11h-1V9h1a1 1 0 1 1 0 2z"}),I.createElement("path",{fill:"#107C41",d:"M2 19h10a1 1 0 0 0 1-1V8a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1z"}),I.createElement("path",{fill:"#F9F7F7",d:"m4.125 16 2.06-3.009L4.298 10h1.518l1.03 1.913c.095.18.16.316.196.405h.014c.067-.145.138-.285.213-.422L8.369 10h1.394l-1.936 2.974L9.813 16H8.329l-1.19-2.1a1.75 1.75 0 0 1-.142-.28H6.98a1.28 1.28 0 0 1-.138.271L5.617 16H4.125z"}));const fr=({dataSourcesLength:e,performedFallbackToAllTables:t,messageId:n})=>I.createElement(Zo.c,null,I.createElement(er.sA,{message:(()=>{if(t)return(0,c.Txd)();return mr.qx.getInstance().doesMessageHaveFilteredExcelFiles(n)?(0,c.zb)():e>1?(0,c.h9u)():(0,c.u1U)()})(),values:[e]})),Cr=({selectedSourceIndex:e,dataSourcesLength:t,handlePrevious:n,handleNext:a})=>{const o=c.SGs;return I.createElement(Nn.B,{horizontal:!0,reversed:o,horizontalAlign:o?"end":"start"},I.createElement(Ln.$,{size:"small",name:(0,c.Rcx)(),"aria-label":(0,c.Rcx)(),appearance:"transparent",icon:I.createElement(Jo.bP_,null),className:sr.sliderButton,"aria-expanded":void 0,onClick:n}),I.createElement(Zo.c,{style:{lineHeight:"24px"}},(0,c.Dqz)().replace("{0}",`${e+1}`).replace("{1}",`${t}`)),I.createElement(Ln.$,{size:"small",name:(0,c.n1d)(),"aria-label":(0,c.n1d)(),appearance:"transparent",icon:I.createElement(Jo.KOR,null),className:sr.sliderButton,"aria-expanded":void 0,onClick:a}))},yr=({selectedTable:e,tableWasImported:t,handleAddToSheet:n,importDataStyles:a,loadingTimeouts:o})=>{const r={headerRow:1,columnLetters:Array.from({length:e.columns?.length||0},((e,t)=>String.fromCharCode(65+t))),columnHeaders:e.columns?.map((e=>e.name))||[],rows:hr(e.columns||[],e.sampleRows||[])},i=t?(0,c.gTs)():(0,c.N0D)(),l=t?I.createElement(Yo.N5_,null):I.createElement(Fn.rz9,null),s=e.powerQueryScript;return I.createElement(Io.Z,null,I.createElement(Zo.c,null,I.createElement(Nn.B,{horizontal:!0,grow:!0,horizontalAlign:"space-between",tokens:{childrenGap:5},styles:{root:{whiteSpace:"nowrap"}}},I.createElement(Nn.B.Item,{styles:{root:{overflow:"hidden"}}},I.createElement(Ie.m,{relationship:"description",content:(0,c.yWm)()},I.createElement(br,null)),I.createElement(va.N,{title:e.sourceLocation,className:a.excelFileNameLink,appearance:"subtle",href:e.seeMoreUrl,target:"_blank"},I.createElement(nr.E,{nowrap:!0,className:a.excelFileNameLinkInner},e.sourceLocation))),I.createElement(Ko.E,{title:e.sourceName,shape:"rounded",color:"informative",size:"small",appearance:"filled"},e.sourceName)),I.createElement(Nn.B,{horizontal:!0,tokens:{childrenGap:4}},I.createElement(Xo.aPM,{className:a.folderIcon}),I.createElement(ko.J,{className:a.excelFileNameSuffix,title:e.sourceRelativePath},e.sourceRelativePath))),I.createElement("div",{style:{height:"155px",marginTop:"-12px"}},I.createElement(gr.J,{uiTimeout:o.preview,theme:ar.Q1.neutralV2,preview:r,type:tr.VS.Column,errorData:{errorCode:on.O.ImportDataTablePreviewNotUpdated,telemetryType:ot.S2.ImportData,telemetryFeature:v.BJ.ImportData}})),I.createElement(Nn.B,{tokens:{childrenGap:0}},I.createElement(ur,{query:s,explanation:(0,c.Iiw)(),logBodyShown:()=>{var t,n;t=e.id,n=v.a5.ImportDataExplainButtonClicked,T.E.getInstance().updateTelemetryChatEventData({[v.h3.ChatEventType]:n,[v.h3.ChatEventParameters]:t},x.M.getInstance())}})),I.createElement(Nn.B,{tokens:{childrenGap:0}},I.createElement(Ln.$,{className:a.importButton,size:"small",title:i,icon:l,disabled:t,onClick:n},i)))},vr=({importType:e,requestId:t,dataSources:n,messageId:a,userQueryGuid:r,performedFallbackToAllTables:i})=>{const l=(0,ge.j)(),[s,c]=I.useState(0),[d,u]=I.useState(new Set),m=n[s],g=d.has(m.id),h=(0,pr.t)(),p=function(){const[e,t,n]=(0,o.xtK)("Microsoft.Office.Excel.FA000000124.FormulaSuggestionsUITimeouts",[0,15e3,25e3]);return{description:e,preview:t,explanation:n}}(),b=n.length>1;return I.createElement(vo.lJ,{contentBody:I.createElement(Nn.B,{tokens:{childrenGap:12},className:(0,Ao.z)(h.columnRecommendation,"column-recommendation")},I.createElement(fr,{dataSourcesLength:n.length,performedFallbackToAllTables:i,messageId:a}),b&&I.createElement(Cr,{selectedSourceIndex:s,dataSourcesLength:n.length,handlePrevious:()=>{c((e=>(e-1+n.length)%n.length))},handleNext:()=>{c((e=>(e+1)%n.length))}}),I.createElement(yr,{selectedTable:m,tableWasImported:g,handleAddToSheet:()=>{const t=n[s];(0,gt.I2)(a,r,l,e,s)({sourceName:t.sourceName,sourceLocation:t.sourceLocation,sourceUrl:t.sourceUrl??"",columns:t.columns??[],sampleRows:t.sampleRows??[],powerQueryScript:t.powerQueryScript}),u(new Set(d).add(t.id)),nt.B.getInstance().logKeptEvent(v.BJ.ImportData,e,pe.RX.Create),(0,jt.cY)(`Added ${t.sourceName} to sheet.`)},importDataStyles:sr,loadingTimeouts:p})),requestId:t})};var Tr=n(879162),xr=n(454592),Sr=n(585305),wr=n(123963);const Er=(0,I.lazy)((()=>Promise.all([n.e("monaco-editor"),n.e("vendors-npm_store_sdx_officecopilot_monaco-editor_0_46_0-51dbdf7e44e9cf33acc3_node_modules_mo-e5e20f"),n.e("monacoreadonly")]).then(n.bind(n,166600))));function Ir({id:e,columnName:t,code:n,codeExplanation:a,text:o,onFirstTimeExplanationShown:r,loadingTimeouts:i}){const l=Ar(`description[${e}]`,Boolean(o),i.description);return I.createElement(Nn.B,{tokens:{childrenGap:8}},I.createElement(xr.V,{role:"heading","aria-level":2,"data-testid":"formula-title"},t),I.createElement(Sr.u,{text:function(e){switch(l){case"loading":return;case"timeout":return c.olU.FormulaSuggestion_Description_NotAvailable;default:return e}}(o)}),I.createElement(Rr,{id:e,code:n,codeExplanation:a,onFirstTimeExplanationShown:r,loadingTimeouts:i}))}function Rr({id:e,code:t,codeExplanation:n,onFirstTimeExplanationShown:a,loadingTimeouts:o}){const r=Ar(`explanation[${e}]`,Boolean(n),o.explanation),i=v.q.PythonCalculatedColumns,l=I.createElement(Er,{code:t}),s=(0,Gt.ZK)(t,!0,0);return I.createElement(or.$,{title:"Python",content:l,explanation:{explanation:n,isLoading:"loading"===r,isNotAvailable:"timeout"===r,onFirstTimeExplanationShown:a},telemetryUsageFeatureName:i,getClipboardItem:async()=>new ClipboardItem({"text/plain":new Blob([s],{type:"text/plain"})})})}function Ar(e,t,n){return(0,wr.rK)(e,t,n,{onTimeout(){},onLoaded(){}})}var Lr=n(450818);function kr({recommendation:e,...t}){return e?I.createElement(Fr,{recommendation:e,...t}):I.createElement(Pr,null)}function Fr({requestId:e,recommendation:t,targetAddress:n,columnLetters:a,insertCallback:r}){if(!t)return I.createElement(Pr,null);if(!n)return I.createElement(Pr,{errorMessage:(0,c.gg6)()});const i=(0,Lr.E)().pythonRecommendation,l=function(){const[e,t,n]=(0,o.xtK)("Microsoft.Office.Excel.FA000000124.FormulaSuggestionsUITimeouts",[15e3,15e3,25e3]);return{description:e,preview:t,explanation:n}}();return I.createElement(vo.lJ,{requestId:e,contentBody:I.createElement(Nn.B,{tokens:{childrenGap:12},className:(0,Ao.z)(i,"python-recommendation")},n&&a&&I.createElement(_r,{targetAddress:n,columnLetters:a}),I.createElement(Nn.B,{tokens:{childrenGap:12}},I.createElement(Ir,{loadingTimeouts:l,key:t.id,id:`${t.id}_${t.id}`,columnName:t.columnName,text:t.text,code:t.code,codeExplanation:t.codeExplanation,onFirstTimeExplanationShown:()=>{var e,n;e=t.id,n=v.a5.PythonCalculatedColumnsExplainButtonClicked,T.E.getInstance().updateTelemetryChatEventData({[v.h3.ChatEventType]:n,[v.h3.ChatEventParameters]:e},x.M.getInstance())}}))),cardButtons:[{...(0,vo.r1)((0,c.Nbb)()),handleButtonOnClick:r}]})}function _r({targetAddress:e,columnLetters:t}){const n=(0,Ot.r)(e),a=I.createElement(er.sA,{message:c.olU.FormulaSuggestion_Header_Singular_Location,values:{columnLetter:t}});return I.createElement(Zo.c,null,I.createElement(er.sA,{message:c.olU.FormulaSuggestion_Header_Singular,values:{tableRange:I.createElement(xr.V,null,n),location:I.createElement(xr.V,null,a)}}))}function Pr({errorMessage:e}){return I.createElement(h.DefaultMessage,{body:{user:"chat",messageHeader:{text:e??(0,c.JIA)()}},styles:(0,Lr.E)(),shouldShowAIGeneratedIndicator:!1})}var Nr=n(592071),Mr=n(979011),Or=n(439573),Dr=n(901868);const Br=(0,d.n)({paddedContainer:{paddingBottom:"12px","& > *":{margin:"0 !important"},"& > * > *":{margin:"0 !important"}},paddedFinalText:{paddingBottom:"2px"}});var $r=n(80765);function Hr(e,t){const n=(0,zt.au)(`Output missing in ${e}`);(0,zt.QX)(t,n,!1)}async function Ur(e,t,n,a){try{let o="";await(0,st.F5)((async function(r){if(!t)return void Hr("handleInsertImage",e);const{left:i,top:l}=await async function(e){try{return await async function(e){const t=e.workbook.getSelectedRange().load("left,top");return await e.sync(),{left:t.left,top:t.top}}(e)}catch{return await async function(e){const t=e.workbook.worksheets.getActiveWorksheet().getRange("A1").load("left,top");return await e.sync(),{left:t.left,top:t.top}}(e)}}(r);let s=function(e){if(!e)return null;try{return JSON.parse(e)?.base64_data??null}catch{return null}}(t);if(!s){const t=(0,zt.Wx)("Base64 image data not found in output.");return void(0,zt.QX)(e,t,!0)}s.startsWith("data:image")||(s=`data:image/png;base64,${s}`);const c=r.workbook.worksheets.getActiveWorksheet(),d=new Image;d.src=s,d.onload=async()=>{const{width:e,height:t}=function(e,t){const n=600/e,a=Math.min(n,1);return{width:e*a*.75,height:t*a*.75}}(d.naturalWidth,d.naturalHeight);o=await async function(e,t,n,a,o,r,i,l){const s=e.shapes.addImage(t);return s.left=n,s.top=a,s.width=o,s.height=r,i&&(s.altTextTitle=i),l&&(s.altTextDescription=l),e.load("name"),await e.context.sync(),e.name}(c,d.src.split(",")[1],i,l,e,t,n,a)}})),qr(e,o)}catch(t){const n=(0,zt.dL)(on.O.AnswersInsertImageError,t);(0,zt.Kx)(e,n,"handleInsertImage",!1)}}function qr(e,t){const n=(0,Kt.SG)(),a=[(0,Se.FW)(n)],o=(0,c.OKX)().replace("{0}",t);Ct.n.displayPythonTextResponse(e,o,!1,!0,!0,a)}function Vr(e){const t=l.$.getInstance().getChatLog().reverse().filter(((t,n,a)=>t.chatMessageBodyData?.messageId!==e&&"Python"===t.chatMessageBodyData?.aiResponseMetadata.type&&a.findIndex((e=>e.chatMessageBodyData?.messageId===t.chatMessageBodyData?.messageId))===n)).reverse().map((e=>function(e){const t=e.chatMessageBodyData?.aiResponseMetadata.metadata;let n;try{n=JSON.parse(t)}catch(e){const t=(0,zt.kh)("handleCodeEntry parsing metadata failed");return(0,Kt.Lv)(t),[]}return n.chunks.filter((e=>"code"===e.type)).map((e=>{if(!e.value.code)return"";let t=e.value.code;return e.value.output?.includes("hresult")&&e.value.output.includes("errorName")&&e.value.output.includes("errorMessage")&&(t=t.split("\n").map((e=>`# ${e}`)).join("\n")),t=t.split("\n").map((e=>e.includes("plt")||e.includes(".plot")?`# ${e}`:e)).join("\n"),t}))}(e))).reduce(((e,t)=>e.concat(t)),[]).join("\n\n");return t}function Wr(e){if(!(0,o.pS6)())return e;try{const t=/(?:^|\.\s+)(\*\*(.+?)\*\*)([^.]+)\.?/g;return[...e.matchAll(t)].map((e=>`- [x] **${e[2].trim()}**  \n  ${e[3].trim().replace(/^[\s:–-]+/,"")}  `)).join("\n")}catch{return e}}function Gr(e){const t=(0,h.useMarkdownStyles)(),n=Br(),{linkTheme:a,getStyles:r}=(0,$r.X)(),i=["text","code","finalText"],l=(0,xa.wA)();let s=(0,o.DBQ)()?Vr(e.messageId):"";const d=(0,Nr.j)();let u;(0,o.g6K)()&&d&&(u=d.getChartRef);const m=e.chunks.filter((e=>i.includes(e.type))).map(((i,d)=>{switch(i.type){case"text":return i.value.text?I.createElement("div",{key:`text-${d}`,className:n.paddedContainer},I.createElement(h.MarkdownTextProcessor,{styles:t,body:{message:Wr(i?.value?.text)||i?.value?.text}})):((0,Kt.oA)(i.type),null);case"code":{if(!i.value.code)return(0,Kt.oA)(i.type),null;const t=i.value.isLargeOutput,g=!t||!(0,o.yw9)("OfficeVSO_10346383_AnswersShowLargeDataMessage");let h,p=!0;const b=[];let f=!0;if(g){if((0,o.yw9)("OfficeVSO_10196331_Handle_Table_With_Objects_Edge_Case")){let e,t,n=!1;try{const a=JSON.parse(i.value.output||"{}");(0,o._dF)()&&a&&"object"==typeof a&&"type"in a&&a.type!==Tr.z.Image?(e=a.rawData,t=a.type,t!==Tr.z.Table&&t!==Tr.z.TableWithObjects||(f=a.firstRowIsHeader??!0),[Tr.z.Boolean,Tr.z.String,Tr.z.Number].includes(t)&&(e="string"==typeof a.rawData?a.rawData:JSON.stringify(a.rawData)),n=!0):(e=i.value.output,t=i.value.outputType)}catch(n){e=i.value.output,t=i.value.outputType}h=n?{output:e,outputType:t}:(0,Dr._)(e,t)}else{const e=function(e,t){if(!e)return Tr.z.None;if(t===Tr.z.Image)return Tr.z.Image;if(!isNaN(Number(e))&&""!==e.trim())return Tr.z.Number;if("true"===e.toLowerCase()||"false"===e.toLowerCase())return Tr.z.Boolean;try{const t=JSON.parse(e);if(Array.isArray(t)&&t.length>0){if(t.every((e=>Array.isArray(e)&&e.length===t[0].length&&t[0].length>0))){const e=t=>typeof t===Tr.z.String||typeof t===Tr.z.Number||typeof t===Tr.z.Boolean||typeof t===Tr.z.None||!!Array.isArray(t)&&t.every((t=>e(t)));return t.every((t=>t.every((t=>e(t)))))?Tr.z.Table:Tr.z.TableWithObjects}return Tr.z.Json}if(typeof t===Tr.z.Object)return Tr.z.Json}catch(e){return(0,Kt.eA)(),Tr.z.String}return Tr.z.String}(i.value.output,i.value.outputType);h={output:i.value.output,outputType:e}}p=h.outputType!==Tr.z.Table&&h.outputType!==Tr.z.Image,h.outputType===Tr.z.Image?((0,Kt.Qc)(ot.L3.CardShownWithInsertionButton,ot.IM.InsertToSheetButton,ot.Zf.Image),b.push({...(m=(0,c.ivT)(),{buttonTitle:m,buttonText:m,icon:I.createElement(Mr.j6g,null)}),handleButtonOnClick:async()=>{if(await(0,Gt.e1)(l))if((0,o.g6K)()){const e=JSON.parse(i?.value?.output??"{}");if(e.chart_json){const t=(0,jt.RE)(e.title,e.summary),n=u(t);zr(n?.current,l,i?.value?.output),(0,Kt.PB)(ot.L3.InteractiveChartImageInserted,[])}else Ur(l,i?.value?.output),(0,Kt.PB)(ot.L3.StaticChartImageInserted,[])}else(0,o.yw9)("OfficeVSO_10222788_Insert_Image_Error")?Ur(l,i?.value?.output):async function(e,t){try{let n="";await(0,st.F5)((async function(a){if(!t)return void Hr("handleInsertImage",e);const o=a.workbook.getSelectedRange().load("left,top");await a.sync();const r=JSON.parse(t)?.base64_data;if(!r){const t=(0,zt.Wx)("Base64 image data not found in output.");return void(0,zt.QX)(e,t,!1)}const i=a.workbook.worksheets.getActiveWorksheet(),l=i.shapes.addImage(r);return l.left=o.left,l.top=o.top,l.width=480,l.height=290,i.load("name"),await a.sync(),n=i.name,a.sync()})),qr(e,n)}catch(t){const n=(0,zt.dL)(on.O.AnswersInsertImageError,t);(0,zt.Kx)(e,n,"handleInsertImage",!1)}}(l,i.value.output);(0,Kt.Qc)(ot.L3.CardInsertionButtonClicked,ot.IM.InsertToSheetButton,ot.Zf.Image)}})):h.outputType===Tr.z.Table&&((0,Kt.Qc)(ot.L3.CardShownWithInsertionButton,ot.IM.InsertButton,ot.Zf.Table),b.push({...(0,vo.r1)((0,c.J40)()),handleButtonOnClick:()=>{(0,o.yw9)("OfficeVSO_10196331_Handle_Table_With_Objects_Edge_Case")?Array.isArray(h?.output)&&async function(e,t){try{let n="";await(0,st.F5)((async a=>{if(!t)return void Hr("handleInsertTable",e);if(!Array.isArray(t)||0===t.length)return;const o=a.workbook.worksheets.add(),r=o.getRangeByIndexes(0,0,t.length,t[0].length);return r.values=t,o.tables.add(r,!0),o.activate(),o.load("name"),await a.sync(),n=o.name,await a.sync()})),qr(e,n)}catch(t){const n=(0,zt.dL)(on.O.AnswersInsertTableError,t);(0,zt.Kx)(e,n,"handleInsertTable",!1)}}(l,h?.output):async function(e,t){try{let n="";await(0,st.F5)((async a=>{if(!t)return void Hr("handleInsertTableOld",e);const o=JSON.parse(t);if(!Array.isArray(o)||0===o.length)return;const r=a.workbook.worksheets.add(),i=r.getRangeByIndexes(0,0,o.length,o[0].length);return i.values=o,r.tables.add(i,!0),r.activate(),r.load("name"),await a.sync(),n=r.name,await a.sync()})),qr(e,n)}catch(t){const n=(0,zt.dL)(on.O.AnswersInsertTableError,t);(0,zt.Kx)(e,n,"handleInsertTableOld",!1)}}(l,i.value.output),(0,Kt.Qc)(ot.L3.CardInsertionButtonClicked,ot.IM.InsertButton,ot.Zf.Table)}}))}return(0,o.DBQ)()&&(s+="\n"+i.value.code),I.createElement(I.Fragment,{key:`code-${d}`},I.createElement("div",{className:n.paddedContainer},I.createElement(Or.W,{code:(0,o.DBQ)()?s:i.value.code,codeExplanation:i.value.codeExplanation,styles:r(),linkTheme:a,requestId:"",output:h?.output,outputType:h?.outputType,isPythonOutputCollapsable:p,isLargeOutput:t,tableHasHeader:f})),g&&["image","table"].includes(h?.outputType??"")?I.createElement(vo.lJ,{requestId:e.requestId,pythonUserRequestId:e.pythonUserRequestId,renderHeader:()=>null,renderBody:()=>null,renderFooter:e=>I.createElement("div",{className:n.paddedContainer},e()),cardButtons:b}):null)}case"finalText":return i.value.finalText?I.createElement("div",{key:`finalText-${d}`,className:n.paddedFinalText},I.createElement(h.MarkdownTextProcessor,{styles:t,body:{message:i.value.finalText}})):((0,Kt.oA)(i.type),null);default:return null}var m})).filter((e=>null!==e));return I.createElement(vo.lJ,{contentBody:I.createElement(I.Fragment,null,m),requestId:e.requestId})}const zr=(e,t,n)=>{if(e)try{const a=JSON.parse(n??"{}");e.exportAsImage().then((async e=>{Ur(t,JSON.stringify({base64_data:e}),a.title??"",a.summary??"")})).catch((e=>{e.name=e.message;const n=(0,zt.Ix)(on.O.AnswersInvalidChartImageResponse,"Unable to export interactive chart as image",e);(0,zt.QX)(t,n,!0)}))}catch(e){const n=(0,zt.Ix)(on.O.AnswersInteractiveChartImageGenerationFailed,"Unable to insert interactive chart image",e);(0,zt.QX)(t,n,!0)}else{const e=(0,zt.Ix)(on.O.AnswersInteractiveChartRefFailed,"Interactive chart reference is not available.");(0,zt.QX)(t,e,!0)}},Qr=e=>I.createElement(Nr.z,null,I.createElement(Gr,e));var jr=n(775568);const Jr={pythonStartAnalysis:{"& > :first-child":{marginBottom:"2px"},"& > :nth-child(2)":{marginTop:"0px",paddingLeft:"25px"},backgroundColor:f.k1.neutralLight,color:f.k1.neutralDark}},Yr=(0,d.n)(Jr);function Xr(e){const t=(0,ge.j)(),n=(0,xa.d4)((e=>e.chat.showLoadingUI)),a=(0,xa.d4)((e=>e.chat.isPythonStartAnalysisButtonDisabled));(0,I.useEffect)((()=>{t(rt.m.setPythonStartAnalysisButtonDisabled(!1))}),[]);const r=[];if(!a){const e=(0,o.gnD)()?(0,c.CsI)():(0,c.QAQ)();r.push({buttonTitle:e,buttonText:e,handleButtonOnClick:()=>i(),icon:I.createElement(Fn.u9I,null),isDisabled:n}),(0,o.gnD)()&&r.push({buttonTitle:(0,c.YVl)(),buttonText:(0,c.YVl)(),handleButtonOnClick:()=>async function(){dt.CP.pythonContextManager.setIsPythonThinkDeeperMode(!0),await i(!0)}(),icon:I.createElement(we.W66,null),isDisabled:n})}return I.createElement(vo.lJ,{contentBody:function(e,t){const n=Yr();return I.createElement(Nn.B,{className:(0,Ao.z)(n.pythonStartAnalysis,"python-start-analysis")},I.createElement(u.E,null,(0,c.XXH)()),I.createElement("ul",null,I.createElement("li",{key:"first-bullet"},(0,c.zqN)(t)),I.createElement("li",{key:"second-bullet"},(0,c.lQ6)()),I.createElement("li",{key:"third-bullet"},(0,c.WQT)()),e?I.createElement("li",{key:"fourth-bullet"},(0,c.PxQ)()):null),I.createElement(u.E,null,(0,c.LMV)()))}(e.shouldShowRecalcNotice,e.pythonAnalysisSheetName),requestId:e.requestId,cardButtons:r});async function i(e){try{const n=(0,o.yw9)("OfficeVSO_10320925_ThinkDeeperStringUpdate")&&e;(0,Kt.PB)(ot.L3.StartAnalysisClicked,[]);const a={chatCardType:Ka._.Default,chatMessageData:{defaultMessageProps:{user:eo.Q9.Human,messageHeader:{text:n?(0,c.YVl)():(0,c.QAQ)()}}}},r={featureName:v.q.Python,eventType:v.a5.SuggestionMessage};if(l.$.getInstance().displayResponse(a,r),dt.CP.pythonContextManager.prePythonModeError)return void(0,zt.Kx)(t,dt.CP.pythonContextManager.prePythonModeError,dt.CP.pythonContextManager.prePythonModeErrorFunction??"handleStartAnalysisOnClick - prePythonModeError",!1,!0);t((0,lt.eM)(v.OP.PythonStartAnalysis)),dt.CP.pythonContextManager.enterAdvancedAnalysisMode(),await Ce.p.getInstance().handlePythonStartAnalysis()}catch(e){(0,Gt.Tk)(!1);let n=e;(0,o.yw9)("OfficeVSO_10264922_AdditionalErrorHandlingMAA")&&(n=new jr.H({errorCode:on.O.PythonStartAnalysisFailed,innerError:e})),(0,zt.Kx)(t,n,"handleStartAnalysisOnClick",!1,!1,[],!0)}}}function Zr(e){return I.createElement(vo.lJ,{contentBody:function(e,t){const n=Yr();return I.createElement(Nn.B,{className:(0,Ao.z)(n.pythonStartAnalysis,"python-start-analysis")},I.createElement(u.E,null,(0,c.XXH)()),I.createElement("ul",null,I.createElement("li",{key:"first-bullet"},(0,c.zqN)(t)),I.createElement("li",{key:"second-bullet"},(0,c.lQ6)()),I.createElement("li",{key:"third-bullet"},(0,c.WQT)()),e?I.createElement("li",{key:"fourth-bullet"},(0,c.PxQ)()):null),I.createElement(u.E,null,(0,c.LMV)()))}(e.shouldShowRecalcNotice,e.pythonAnalysisSheetName),requestId:e.requestId})}const Kr={title:{color:f.k1.black}},ei=(0,d.n)(Kr);function ti(e){const t=ei();if(!e.title)return null;const n=e.title.runs.map(((e,t)=>{const n=null!=e.highlightStyleIndex?`recommendation-title__rich-text__${e.highlightStyleIndex}`:"";return I.createElement("span",{className:n,key:t},e.text)}));return I.createElement("div",{className:(0,Ao.z)(t.title,"recommendation-title")},n)}n(849473);var ni=n(875100),ai=n(586428),oi=n(639599),ri=n(342698),ii=n(371120),li=n(519272);function si(e,t=1){if(!e||7!==e.length)throw new Error("Invalid color string.");return{r:ci(e.substr(1,2)),g:ci(e.substr(3,2)),b:ci(e.substr(5,2)),a:t}}function ci(e){const t=Number.parseInt(e[0],16),n=Number.parseInt(e[1],16);if(Number.isNaN(t)||Number.isNaN(n))throw new Error("Invalid color string.");return(16*t+n)/255}var di,ui=n(581389),mi=n(575934);function gi(e){const t=Date.UTC(0,0,-1,0,0,0);return(e.getTime()-t)/1e3/60/60/24}function hi(e,t,n=1){const a=new Date(+e);return 3===t?a.setUTCFullYear(e.getUTCFullYear()+n):2===t?a.setUTCMonth(e.getUTCMonth()+n):1===t?a.setUTCDate(e.getUTCDate()+7*n):a.setUTCDate(e.getUTCDate()+n),a}function pi(e){const t=e.filter((e=>0!==e)).reduce(((e,t)=>Math.min(e,t)),Number.MAX_VALUE),n=e.filter((e=>0!==e)).reduce(((e,t)=>Math.max(e,t)),Number.MIN_VALUE),a=function(e,t,n){const a=function(e){let t=Number.MAX_VALUE,n=e[0];for(let a=1;a<e.length;a++){const o=e[a];t=Math.min(Math.abs(n-o),t),n=o}return t}(n),o=t-e;if(a<7&&o<56)return di.Day;if(a<28&&o<365)return di.Week;if(a<365&&o<1825)return di.Month;return di.Year}(t,n,e);return function(e,t,n,a=1){const o=[];if(e===t)o.push(1);else if(n===di.Day)o.push(a);else if(n===di.Week)o.push(7*a);else{let i=e;for(;i<t;){const e=gi(hi((r=i,new Date(Date.UTC(0,0,r-1,0,0,0))),n,a));o.push(e-i),i=e}}var r;return o}(t,n,a)}!function(e){e[e.Day=0]="Day",e[e.Week=1]="Week",e[e.Month=2]="Month",e[e.Year=3]="Year"}(di||(di={}));var bi=n(573367);class fi{createAxes(e,t){return this.getAxesForChart(e,t)}static updateAxesTickLabels(e,t,n,a,o){if("histogram"===e.series[0].layout)return;const r=t&&a>bi.y3;n.forEach((t=>{if("categoryValues"!==t.dimensionType)return;const n=fi.getCategoryCountForSeries(e.data,e.series[0]);if(!r&&!o&&n>a&&t.tickLabels)return void(t.tickLabels.show=!1);const i=fi.isDateDimension(e,"categories");(0,ri.tJ)(e.series)&&(-1===n||i)||t.tickLabels&&(t.tickLabels.show=!0)}))}getAxesForChart(e,t){const n=(0,li.ip)(e),a=[...(0,oi.lf)(n.primary.insightsType)];if(n.secondary){const e=(0,oi.t7)(n.secondary.insightsType);a.push(...e)}return a.map(((n,a)=>{const o=n.dimension,r=(0,ri.tJ)(e.series)?(0,ri.fB)(e,n):e.axes.find((e=>e.dimensionType===o&&e.axisGroup===n.axisGroup)),i=(0,ni.q)(e,o,n.axisGroup),l={dimensionType:"categories"===o?"categoryValues":o,tickLabels:this.getTickLabelsForAxis(e,n),index:a};if(n.isValue&&"primary"===n.axisGroup&&(l.majorGridLines={}),"values"===n.dimension?l.lineThickness=0:l.lineColor=si(ai.Ei),r){this.isTitleForAxisRequired(e,r)&&(l.title=fi.getTitleForAxis(r));const t=r.linearValueScale;!!t&&"includeZero"===t.zeroPolicy&&(l.linearValueScale={...l.linearValueScale,zeroPolicy:"IncludeZero"})}if(this.shouldSetupIntervals(e,o)){const t=(0,ii.Q)(e,0,o).values.raw;l.intervalsScale=fi.getIntervalsScale(t),l.tickLabels={show:!1}}if(n.isHundredPercent?(l.units="Percentage",l.linearValueScale={...l.linearValueScale,autoBufferRatio:0}):i&&i.languageUnitsValue!==ni.YO.None&&(l.units=i.languageUnitsValue),(0,ii.$)(o)){const t=(0,ui.r)(e,o,n.axisGroup);t&&t.max<=0&&0!==t.min&&(l.axisCrossType="Maximum")}if(r?.reversePlotOrder&&(l.reverseDirection=!0,l.axisCrossType="Maximum"),"categories"===o&&(0,ri.q3)(e.series)&&!this.shouldSetupIntervals(e,o)&&(l.reverseDirection=!0),(0,ri.tJ)(e.series)&&(0,ii.$)(o)){const t=!!r&&!!r.linearValueScale&&"includeZero"===r.linearValueScale.zeroPolicy,a=(0,ri.ps)(e,o,n.axisGroup,t);a&&(l.linearValueScale={...l.linearValueScale,maximum:a.maximum,minimum:a.minimum})}if(t){if(null!=t.primaryCategoryAxis&&"primary"===n.axisGroup&&"Category"===n.excelAxisType)return fi.applyChartConfigToAxis(l,t.primaryCategoryAxis);if(null!=t.primaryValueAxis&&"primary"===n.axisGroup&&"Value"===n.excelAxisType)return fi.applyChartConfigToAxis(l,t.primaryValueAxis);if(null!=t.secondaryCategoryAxis&&"secondary"===n.axisGroup&&"Category"===n.excelAxisType)return fi.applyChartConfigToAxis(l,t.secondaryCategoryAxis);if(null!=t.secondaryValueAxis&&"secondary"===n.axisGroup&&"Value"===n.excelAxisType)return fi.applyChartConfigToAxis(l,t.secondaryValueAxis)}return l}))}static getIntervalsScale(e){const t=e.reduce(((e,t)=>Math.min(e,t)),Number.MAX_VALUE);return{plotLevel:0,manualLevels:[{start:Math.floor(t),intervals:pi(e)}]}}static applyChartConfigToAxis(e,t){return null!=t.minimum&&(e.linearValueScale={...e.linearValueScale,minimum:t.minimum}),null!=t.maximum&&(e.linearValueScale={...e.linearValueScale,maximum:t.maximum}),null!=t.title?.text&&(e.title={...e.title,text:t.title.text}),null==t.showTitle||t.showTitle||(e.title=void 0),null!=t.majorGridlines?.visible&&(t.majorGridlines.visible?e.majorGridLines={}:e.majorGridLines=void 0),null!=t.minorGridlines?.visible&&(t.minorGridlines.visible?e.minorGridLines={}:e.minorGridLines=void 0),null!=t.tickLabel?.visible&&(e.tickLabels={show:t.tickLabel.visible}),e}areTickLabelsAppropriate(e,t){const n="categories"===t.dimension;if(n&&"histogram"===e.series[0].layout)return!1;const a=fi.getCategoryCountForSeries(e.data,e.series[0]);if(!this.options.showHierarchicalCategoryTickLabels&&n&&a>this.options.maxCategoryLabels)return!1;const o=n&&-1===a,r=fi.isDateDimension(e,"categories");return!(0,ri.tJ)(e.series)||!o&&!r}isTitleForAxisRequired(e,t){const n=this.options.allowDateAxis&&"categories"===t.dimensionType&&fi.isDateDimension(e,"categories"),a="secondary"===t.axisGroup?(0,li.ip)(e).secondary.insightsType:(0,li.ip)(e).primary.insightsType,o=(0,oi.C$)(a,t.dimensionType),r=this.areTickLabelsAppropriate(e,o),i=(0,ii.$)(t.dimensionType),l=e.axes.filter((e=>(0,ii.$)(e.dimensionType))).length;return!(!(this.options.showAxisTitles||n||this.options.showAxisLabels&&!r||this.options.showAxisLabels&&i&&l>1)||!t.title)}static getTitleForAxis(e){return{text:e.title&&(0,mi.HK)(e.title,30),textFaceName:ai.e0,textPointSize:ai.Wn,textColor:si(ai.Yg)}}getTickLabelsForAxis(e,t){const n=!!this.options.showAxisLabels&&this.areTickLabelsAppropriate(e,t),a="categories"===t.dimension,o="secondary"===t.axisGroup,r={show:n,allowAdvancedLayout:this.options.showHierarchicalCategoryTickLabels,textFaceName:ai.e0,textPointSize:ai.QN,textColor:si(ai.Yg)},i=(0,li.ip)(e).primary.insightsType;if(n&&!a&&!t.isHundredPercent&&"histogram"!==i){const n=e.series.findIndex((e=>o?"secondary"===e.valueAxisGroup:"secondary"!==e.valueAxisGroup)),a=(0,ii.Q)(e,n,t.dimension);a?.formatInfo&&(r.numberFormat=a.formatInfo.format)}return r}shouldSetupIntervals(e,t){if(!this.options.allowDateAxis||!fi.isDateDimension(e,t))return!1;return(0,ii.Q)(e,0,t).values.raw.every((e=>"number"==typeof e))}static isDateDimension(e,t){const n=(0,ii.Q)(e,0,t);if(!n)return!1;const a=!!n.formatInfo&&n.formatInfo.isDateTime;return"categories"===t&&a}static getCategoryCountForSeries(e,t){const n=t.dataBindings.find((e=>"categories"===e.dimensionType));if(!n)return-1;const a=e.dimensions.find((e=>e.id===n.dimensionId));return a?a.values.raw.length:-1}constructor(e){this.options=e}}var Ci=n(650444),yi=n(614978),vi=n(423235),Ti=n(764080),xi=n(659126);class Si{createSeries(e){return this.getSeriesForChart(e)}getSeriesForChart(e){const t=this.options.allowDateAxis&&Si.hasDateDimension(e),n=[...e.series],a=n.some((e=>null!=e.highlightStyleIndex));return n.map(((o,r)=>{const i=o.exceptions&&o.exceptions.length>0,{hasDataMarkers:l,isLine:s,isPie:c}=(0,vi.Y)(o.layout);let d={id:`Series${r}`,title:this.getTitleForSeries(o,e.data),layout:(0,li.Pg)(o.layout).ivyLayout,data:this.getDataForSeries(o,e.data)};if((0,ri.tJ)(e.series))switch(o.valueAxisGroup){case"primary":d.boundAxes=[0,1];break;case"secondary":d.boundAxes=[0,2];break;default:(0,Ci.c)(o.valueAxisGroup)}if("histogram"===o.layout&&(d.fillColor=si(ai.w8)),(l||i&&s)&&(d.dataMarkers=Si.getDataMarkersForSeries(o,a)),o.trendlines&&o.trendlines.length>0){"linear"===o.trendlines[0].trendType&&(d.trendLines=Si.getTrendlinesForSeries(o,a))}if(a){const e=null!=o.highlightStyleIndex?ai.hr[o.highlightStyleIndex]:ai.wm;s?d.lineColor=si(e):d.fillColor=si(e)}if(i&&(s?d.lineColor=si(ai.Zx):(d.exceptionalDatapoints=Si.getExceptionsForSeries(o),d.fillColor=si(ai.Zx))),(0,Ti.o_)(o,["highlightedLineSegments"])&&o.highlightedLineSegments.length>0&&(d.lineColor=si(ai.Zx),d.exceptionalDatapoints=Si.getExceptionalDatapointsForSeries(o)),s?d.lineThickness=2:c?(d.lineColor=si(ai.ON),d.lineThickness=1):(d.lineColor=si(ai.ON,0),d.lineThickness=1),t&&void 0!==d.data.categoryValues&&(d=(0,yi.Lt)(d,"categoryValues",yi.V0)),"Line"===d.layout&&(d=(0,yi.jx)(d)),(0,ri.q3)(n)){const e=void 0===d.data.categoryNames;e&&(d.data.categoryNames=(d.data.values||[[]]).map((e=>e.map(((e,t)=>t.toString()))))),d=(0,yi.Lt)(d,"categoryNames",yi.Hw),e&&(d.data.categoryNames=void 0)}return d}))}getTitleForSeries(e,t){const n=e.dataBindings.find((e=>"title"===e.dimensionType));if(n){const e=t.dimensions.find((e=>e.id===n.dimensionId));if(e)return e.values.strings[0]}}getDataForSeries(e,t){if("histogram"===e.layout)return this.getHistogramData(e,t);return e.dataBindings.reduce(((e,n)=>{switch(n.dimensionType){case"categories":{const a=this.getDimensionForSeries(t,n);if(this.options.showHierarchicalCategoryTickLabels&&a.categoryNames&&1===a.categoryNames.length){if(a.categoryNames[0].every((e=>""===e)))return e;{const t=e.categoryNames?e.categoryNames:[];return t.unshift(a.categoryNames[0]),{...e,categoryNames:t}}}return{...e,...a}}case"values":case"xValues":case"yValues":return{...e,...this.getDimensionForSeries(t,n)};case"title":return e;default:throw new Error("Unrecognized dimension.")}}),{})}getDimensionForSeries(e,t){const n=t.dimensionId,a=e.dimensions.find((e=>e.id===n));if(!a)throw new Error("Invalid dimension.");const o=this.getDimensionName(a,t),r=this.getDimensionValues(a,t);return this.options.maxDatapoints<0?{[o]:[r]}:{[o]:[r.slice(0,this.options.maxDatapoints)]}}getDimensionName(e,t){if("categories"===t.dimensionType){const t=e.formatInfo,n=!!t&&t.isDateTime&&!(0,xi.Xw)(t.format),a=e?.values.raw&&!e.values.raw.some((e=>"number"!=typeof e));return this.options.allowDateAxis&&n&&a?"categoryValues":"categoryNames"}return t.dimensionType}getDimensionValues(e,t){const n="categoryNames"===this.getDimensionName(e,t)?e.values.strings:e.values.raw;switch(t.dimensionType){case"categories":case"title":return n;case"values":case"xValues":case"yValues":return n.map((e=>null===e||""===e?"NaN":e));default:throw new Error("Unrecognized dimension.")}}getHistogramData(e,t){const n="values",a=(0,yi.Mi)(e,t);return this.options.maxDatapoints<0?{[n]:[a]}:{[n]:[a.slice(0,this.options.maxDatapoints)]}}static hasDateDimension(e){return e.series.some((t=>t.dataBindings.some((t=>{if("categories"!==t.dimensionType)return!1;const n=t.dimensionId,a=e.data.dimensions.find((e=>e.id===n)),o=a.formatInfo,r=!!a&&a.values?.raw&&!a.values.raw.some((e=>"number"!=typeof e));return o?.isDateTime&&r&&!(0,xi.Xw)(o.format)}))))}static getDataMarkersForSeries(e,t){const n=e.exceptions&&e.exceptions.length>0,a=(0,vi.Y)(e.layout).hasDataMarkers,o={defaultSize:0};return t&&(null!=e.highlightStyleIndex?o.fillColor=si(ai.hr[e.highlightStyleIndex]):o.fillColor=si(ai.wm)),a&&(o.defaultSize=ai.iR,o.lineColor=si(ai.ON),n&&(o.fillColor=si(ai.Zx))),n&&(o.exceptionalDataMarkers=Si.getExceptionalDataMarkersForSeries(e)),o}static getExceptionalDataMarkersForSeries(e){const t=(0,vi.Y)(e.layout).hasDataMarkers?ai.iR:ai.r$;return e.exceptions.map((e=>({index:e,size:t,fillColor:si(ai.SB),lineColor:si(ai.ON)})))}static getExceptionsForSeries(e){return e.exceptions.map((e=>({index:e,fillColor:si(ai.SB),lineColor:si(ai.ON),lineThickness:1})))}static getExceptionalDatapointsForSeries(e){return e.highlightedLineSegments.map((e=>({index:e+1,lineColor:si(ai.SB),lineThickness:ai.kd})))}static getTrendlinesForSeries(e,t){const n=e.exceptions&&e.exceptions.length>0,a=!!e.highlightedLineSegments&&e.highlightedLineSegments.length>0,o={lineThickness:ai.yX,lineDashStyle:ai.Vs};return t&&(null!=e.highlightStyleIndex?o.lineColor=si(ai.hr[e.highlightStyleIndex]):o.lineColor=si(ai.wm)),(n||a)&&(o.lineColor=si(ai.Zx)),[o]}constructor(e){this.options=e}}class wi{render(e,t,n){return{...wi.getEmptyChart(),series:new Si(this.options).createSeries(e),axes:new fi(this.options).createAxes(e,n),locale:t,legend:wi.getLegend(e,n)}}static getLegend(e,t){if(t?.legend){if(!1===t.legend.visible)return;if(t.legend.position)return{position:{edge:t.legend.position}};if(!0===t.legend.visible)return{position:{edge:"Bottom"}}}return e.showLegend?{position:{edge:"Bottom"}}:void 0}static getDefaults(){return{allowDateAxis:!0,showAxisLabels:!1,showAxisTitles:!0,maxCategoryLabels:6,maxDatapoints:-1,minRangeForValueLabels:0,showHierarchicalCategoryTickLabels:!1}}static getEmptyChart(){return{series:[],size:{width:300,height:200},lineThickness:0}}constructor(e={}){this.options={...wi.getDefaults(),...e}}}var Ei=n(321231),Ii=n(8403),Ri=n(724910);class Ai extends I.Component{layoutChart(e){const t=c.imT,n=this.chartRef.clientWidth,a=n*t;this.observer=new MutationObserver((()=>{const e=this.chartRef?.querySelector("svg");e&&(e.setAttribute("focusable","false"),e.setAttribute("role","img"),e.setAttribute("aria-label",(0,Ei.Z)(this.props.visual)),(0,o.yw9)("OfficeVSO_8691849_CopilotChartToImage")&&e.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.props.onChartRendered?.(Co(e))),this.observer.disconnect()})),this.observer.observe(this.chartRef,{attributes:!0,childList:!0,characterData:!0}),this.chartSettings.size.width!==n&&this.updateAxesSettings(n,t),e&&this.updateChartColors(e.lightColor,e.darkColor),this.chartSettings.size={width:n,height:a},this.host.setConfiguration(this.chartSettings)}createChartSettings(){const e=this.props.visual;{this.chartRenderOptions={allowDateAxis:"ChartVisual"===e.visualType||"QueryChartVisual"===e.visualType,showAxisLabels:!0,showAxisTitles:!1,maxDatapoints:this.props.maxDataPoints,showHierarchicalCategoryTickLabels:!1};const t=new wi(this.chartRenderOptions),n=(0,Ii.KA)().dispatch((0,Nt.Z)())?.localeInfo;return t.render(e.chart,n,e.chartConfig)}}updateAxesSettings(e,t){const n=Math.floor((e-300)*t/20+6),a=Math.max(n,0);if(a!==this.chartRenderOptions.maxCategoryLabels&&this.chartSettings.axes){this.chartRenderOptions.maxCategoryLabels=a;const e=this.props.visual;fi.updateAxesTickLabels(e.chart,"PivotChartVisual"===e.visualType,this.chartSettings.axes,this.chartRenderOptions.maxCategoryLabels,!!this.chartRenderOptions.showHierarchicalCategoryTickLabels&&this.chartRenderOptions.showHierarchicalCategoryTickLabels)}}static areEqual(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b}updateChartColors(e,t){e&&!Ai.areEqual(e,this.defaultLightColor)&&(this.chartSettings.fillColor=e),t&&!Ai.areEqual(t,this.defaultDarkColor)&&(this.chartSettings.lineColor=t,this.chartSettings.axes&&this.chartSettings.axes.forEach((e=>{if(e.majorGridLines){const n={r:t.r,g:t.g,b:t.b,a:t.a};mo.Utils.brightenColor(n,.85),e.majorGridLines.lineColor=n}if(e.tickLabels||e.title){const n={r:t.r,g:t.g,b:t.b,a:t.a};mo.Utils.brightenColor(n,.35),e.tickLabels&&(e.tickLabels.textColor=n),e.title&&(e.title.textColor=n)}})))}componentDidMount(){const e=`${(0,po.wF)()}/v3.0`,t={cycleColors:this.props.themeColors.accentColors,type:oo.Cycle},n=new go({base:e,clientId:(0,po.fp)()},t);this.resizeObserver=new Ri.A((0,ho.debounce)((([e])=>{e&&this.layoutChart(this.props.themeColors)}),1e3)),this.host=new mo.ChartHost(n,this.ivySettings,this.chartRef),this.host.on("error",((e,t)=>{x.M.getInstance().logErrorCode(on.O.IvyWebFailure,new Error(t),ot.S2.AnalyzeDataError,j.$b.ASHA)})),this.chartSettings=this.createChartSettings(),this.layoutChart(this.props.themeColors),this.resizeObserver.observe(this.chartRef)}componentWillUnmount(){this.resizeObserver.unobserve(this.chartRef),this.host.on("error",null),this.host=void 0}render(){return I.createElement("div",{className:"chart",ref:e=>{this.chartRef=e}})}constructor(...e){super(...e),this.chartRenderOptions={},this.defaultDarkColor={r:0,g:0,b:0,a:1},this.defaultLightColor={r:1,g:1,b:1,a:1},this.ivySettings={disableChartElementResize:!0,renderer:mo.IvyRenderer.Svg}}}var Li=n(967676),ki=n(65448);function Fi(e){const{value:t}=e;if(t.toString().length<=3)return I.createElement(I.Fragment,null,t.toString());const n=function(e){const t=Math.min(Math.max(e.toString().length-e.toFixed(0).length-1,0),4);return t>0?{isFullEllipsis:!1,fractionDecimalLength:t,cacheKey:`true${t}`}:{isFullEllipsis:!0,fractionDecimalLength:0,cacheKey:"false0"}}(t);return I.createElement(Li.A,{data:{fractionDecimalLength:-1,isFullEllipsis:!1,cacheKey:"true-1"},onRenderData:e=>{const n=(0,ki.Fl)(t,e.isFullEllipsis,e.fractionDecimalLength);return I.createElement(I.Fragment,null,n)},onReduceData:e=>-1===e.fractionDecimalLength?n:0===e.fractionDecimalLength?e.isFullEllipsis?void 0:{isFullEllipsis:!0,fractionDecimalLength:0,cacheKey:"false0"}:{fractionDecimalLength:e.fractionDecimalLength-1,isFullEllipsis:!1,cacheKey:"true"+(e.fractionDecimalLength-1)}})}const _i={header:{backgroundColor:f.k1.lightBlue},grandTotal:{backgroundColor:f.k1.lightBlue}},Pi=(0,d.n)(_i);var Ni,Mi;function Oi(e){const{cellType:t,className:n,isHighlightCell:a,colspan:o,isEllipsisBodyCell:r,isRowLabelsColumn:i}=e,{value:l,isNumber:s,indent:c}=e.value,d=Pi();let u;u="number"==typeof l&&"Header"!==t?I.createElement(Fi,{value:l}):l?.toString()||"";const m=[`${n}__text`];switch(!s&&!r||i||m.push(`${n}__right-aligned`),a&&m.push(`${n}__highlight-cell`),t){case"Header":{m.push(`${n}__header`);const e=o>0?o:void 0;return I.createElement("th",{colSpan:e,className:(0,Ao.z)(d.header,m.join(" "))},u)}case"Body":m.push(`${n}__body`);break;case"SubTotal":m.push(`${n}__subtotal`);break;case"GrandTotal":m.push(`${n}__grand-total`);break;default:(0,bt.x)(t)}const g=c>0?{textIndent:10*c+"px"}:void 0;let h;return h="GrandTotal"===t?(0,Ao.z)(d.grandTotal,m.join(" ")):m.join(" "),I.createElement("td",{className:h,style:g},u)}!function(e){e.Header="Header",e.Body="Body",e.GrandTotal="GrandTotal",e.SubTotal="SubTotal"}(Ni||(Ni={})),function(e){e.PivotTable="PivotTable",e.QueryResult="QueryResult",e.TaggingResult="TaggingResult"}(Mi||(Mi={}));class Di extends I.Component{getRowCount(){switch(this.props.type){case"PivotTable":return(this.props.pivotTable.pivotTableData[0]||[]).length;case"QueryResult":return 0===this.props.data.fields.length?bi.mz:Math.min(this.props.data.fields[0].values.strings.length+1,bi.m6);case"TaggingResult":return 0===this.props.taggingResult.tagFields.length?bi.mz:Math.min(this.props.taggingResult.tagFields.length+1,bi.m6);default:return(0,Ci.x)(this.props)}}getColumnCount(){switch(this.props.type){case"PivotTable":return this.props.pivotTable.pivotTableData.length;case"QueryResult":return this.props.data.fields.length;case"TaggingResult":return bi.tT;default:return(0,Ci.x)(this.props)}}getColGroup(e){const t=this.getColumnCount(),n=[];for(let a=0;a<t;a++){const t={width:this.state.colWidths[a],visibility:this.state.collapseColIndex>0&&a>=this.state.collapseColIndex?"collapse":void 0};n.push(I.createElement("col",{key:`${a}-${e}`,id:`${e}Col${a}`,style:t}))}return I.createElement("colgroup",null,n)}getTableCell(e,t,n,a,o,r=0,i=!1){return I.createElement(Oi,{value:e,className:this.props.className,key:t,cellType:n,colspan:r,isHighlightCell:a,isEllipsisBodyCell:i,isRowLabelsColumn:o})}static getBlankPreviewTable(e){return I.createElement("div",{className:"preview-table__no-values"},e?c.olU.NoValueAnswerTextForNLInsight:c.olU.NoValueAnswerTextForIdeas)}renderPivotTable(e){const{pivotTableData:t,grandTotalRowIndex:n,subTotalRowIndices:a,highlightCellReferences:o}=e;if(t&&0===t.length)return Di.getBlankPreviewTable(!1);const r=!!a&&a.length>1,i=(0,bi.HF)(e),l=t[0].map(((e,n)=>t.map((e=>e[n])))),s=e.rowFields.length>=1,c=l.slice(0,i).map(((e,t)=>{const n=i>1&&0===t,a=e.map(((a,r)=>{const i=o?.some((e=>t===e.row&&r===e.column));if(n&&1===r){const t=e.length-1;return this.getTableCell(a,r,Ni.Header,i,!1,t)}return n&&r>1?void 0:this.getTableCell(a,r,Ni.Header,i,s&&0===r)}));return I.createElement("tr",{key:t},a)})),d=(()=>{const e=[],t=l.slice(i,n);let c=0;for(let n=0;n<t.length;n++){const l=!!a&&a.length>0&&a.some((e=>e===n+i));c=l?0:c+1;const d=[],u=t[n];if(!(!l&&c>3&&r)){for(let e=0;e<u.length;e++){const t=o?.some((t=>n+i===t.row&&e===t.column));l?d.push(this.getTableCell(u[e],e,Ni.SubTotal,t,s&&0===e)):3===c&&r?d.push(this.getTableCell({value:"...",isNumber:!1,indent:0},e,Ni.Body,!1,s&&0===e,void 0,!0)):d.push(this.getTableCell(u[e],e,Ni.Body,t,s&&0===e))}e.push(I.createElement("tr",{key:n+i,className:l?`${this.props.className}__subtotal-row`:""},d))}}return e})(),u=d.length>0?I.createElement("tbody",null,d):null,m="number"==typeof n?l.slice(n).map((e=>{const t=e.map(((e,t)=>this.getTableCell(e,t,Ni.GrandTotal,!1,s&&0===t)));return I.createElement("tr",{key:n},t)})):[],g=m.length>0?I.createElement("tfoot",null,m):null,h=this.getColGroup("PivotTable");return I.createElement("table",{className:`${this.props.className}__table`,ref:e=>{this.tableRef=e},style:{width:this.state.tableWidth,tableLayout:this.state.tableLayoutFixed?"fixed":void 0}},h,I.createElement("thead",null,c),u,g)}renderQueryResult(e){if(0===e.fields.length)return Di.getBlankPreviewTable(!0);if(0===e.fields[0].values.raw.length)return Di.getBlankPreviewTable(!1);const t=e.fieldHeaders.map(((e,t)=>{const n=e.runs.map((e=>e.text)).join("");return I.createElement(Oi,{className:"query-result",value:{value:n,isNumber:!1,indent:0},key:t,cellType:Ni.Header,isEllipsisBodyCell:!1,isRowLabelsColumn:!1})})),n=t.length>0?I.createElement("thead",null,I.createElement("tr",null,t)):null,a=this.getRowCount()-1,o=[];for(let t=0;t<a;t++){const n=[];for(let a=0;a<this.getColumnCount();a++)if(e.fields[a].values.formattedValues){const o=e.fields[a].values.formattedValues[t];n.push(I.createElement(Oi,{value:o,className:"query-result",key:a,cellType:Ni.Body,isEllipsisBodyCell:!1,isRowLabelsColumn:!1}))}else{const o=e.fields[a].values.strings[t],r=e.fields[a].values.raw[t],i=o||r;n.push(I.createElement(Oi,{className:"query-result",value:{value:i,isNumber:!1,indent:0},key:a,cellType:Ni.Body,isEllipsisBodyCell:!1,isRowLabelsColumn:!1}))}o.push(I.createElement("tr",{key:t},n))}const r=this.getColGroup("QueryResult");return I.createElement("table",{className:"query-result__table",ref:e=>{this.tableRef=e},style:{width:this.state.tableWidth,tableLayout:this.state.tableLayoutFixed?"fixed":void 0}},r,n,I.createElement("tbody",null,o))}getRawWidth(){this.rawTableWidth=this.tableRef.scrollWidth;const e=this.tableRef.getElementsByTagName("tr"),t=e.item(e.length-1).children;this.rawColumnsWidth=[];for(let e=0;e<t.length;e++)this.rawColumnsWidth.push(t.item(e).scrollWidth)}restyleTable(){const e=this.getColumnCount(),t=this.tableContainerDivRef.getBoundingClientRect().width,n=this.getColWidthsLoad(t,e),a=this.getCollapseColIndexLoad(t,e),o=this.getTableLayoutFixed(t,e);this.setState({colWidths:n,collapseColIndex:a,tableWidth:"100%",tableLayoutFixed:o})}getColWidthsLoad(e,t){const n=new Array(t);if(2===t){if(this.rawColumnsWidth[0]<=.5*e&&this.rawColumnsWidth[1]<=.5*e)return["50%","50%"];if(this.rawTableWidth>e){if(this.rawColumnsWidth[0]/e<=.67){const t=this.rawColumnsWidth[0]/e;return[`${t.toLocaleString("en",{style:"percent"})}`,`${(1-t).toLocaleString("en",{style:"percent"})}`]}return["67%","33%"]}}if(t>2){if(Math.max(...this.rawColumnsWidth)<=e/t)for(let e=0;e<n.length;e++)n[e]=`${(1/t).toLocaleString("en",{style:"percent"})}`;else if(this.rawTableWidth<=e)for(let e=0;e<n.length;e++)n[e]=`${(this.rawColumnsWidth[e]/this.rawTableWidth).toLocaleString("en",{style:"percent"})}`;else{if(!(this.rawColumnsWidth[0]+this.rawColumnsWidth[1]<=.75*e)){const t=.5,n=.75,a="25%";if(this.rawColumnsWidth[0]<=e*t){const t=this.rawColumnsWidth[0]/e;return[`${t.toLocaleString("en",{style:"percent"})}`,`${(n-t).toLocaleString("en",{style:"percent"})}`,a]}return["50%","25%","25%"]}{let t=0,a=e;for(;a>0;)n[t]=a-this.rawColumnsWidth[t]>0?`${(this.rawColumnsWidth[t]+1).toString()}px`:`${a.toString()}px`,a-=this.rawColumnsWidth[t]+1,++t}}}return n}getCollapseColIndexLoad(e,t){if(t>2&&this.rawTableWidth>e){if(this.rawColumnsWidth[0]+this.rawColumnsWidth[1]>.9*e)return 3;{let t=0,n=e;for(;n>0;)n-=this.rawColumnsWidth[t]+1,++t;return t}}return-1}getTableLayoutFixed(e,t){return!(Math.max(...this.rawColumnsWidth)>e/t&&this.rawTableWidth<=e)}componentDidMount(){this.tableRef&&(this.getRawWidth(),this.restyleTable(),this.resizeObserver.observe(this.tableContainerDivRef))}componentWillUnmount(){this.tableRef&&this.resizeObserver.unobserve(this.tableContainerDivRef)}renderTable(){switch(this.props.type){case"PivotTable":return this.renderPivotTable(this.props.pivotTable);case"QueryResult":return this.renderQueryResult(this.props.data);case"TaggingResult":return this.renderTaggingResult(this.props.taggingResult,this.props.columnName);default:return(0,Ci.x)(this.props)}}renderTaggingResult(e,t){if(0===e.tagFields.length)return Di.getBlankPreviewTable(!0);const n=[t,(0,c.HZc)()].map(((e,t)=>I.createElement(Oi,{className:"text-analysis-tagging",value:{value:e,isNumber:!1,indent:0},key:t,cellType:Ni.Header,isEllipsisBodyCell:!1,isRowLabelsColumn:!1}))),a=n.length>0?I.createElement("thead",null,I.createElement("tr",null,n)):null,o=this.getRowCount()-1,r=[];for(let t=0;t<o;t++){const n=[],a=e.tagFields[t].originalData,o=e.tagFields[t].tag;n.push(I.createElement(Oi,{className:"text-analysis-tagging",value:{value:a,isNumber:!1,indent:0},key:0,cellType:Ni.Body,isEllipsisBodyCell:!0,isRowLabelsColumn:!1})),n.push(I.createElement(Oi,{className:"text-analysis-tagging",value:{value:o,isNumber:!1,indent:0},key:1,cellType:Ni.Body,isEllipsisBodyCell:!1,isRowLabelsColumn:!1})),r.push(I.createElement("tr",{key:t},n))}const i=this.getColGroup("TaggingResult");return I.createElement("table",{className:"text-analysis-tagging__table",ref:e=>{this.tableRef=e},style:{width:this.state.tableWidth,tableLayout:this.state.tableLayoutFixed?"fixed":void 0}},i,a,I.createElement("tbody",null,r))}getEllipsisRow(){const e=this.getColumnCount(),t=[],n="PivotTable"===this.props.type&&this.props.pivotTable.rowFields.length>=1;for(let a=0;a<e;a++)t.push(I.createElement(Oi,{className:this.props.className,value:{value:"...",isNumber:!1,indent:0},cellType:Ni.Body,isHighlightCell:!1,key:a,isEllipsisBodyCell:!0,isRowLabelsColumn:n&&0===a}));return I.createElement("tr",null,t)}renderEllipsis(){const e=this.getColGroup("Ellipsis"),t=this.getEllipsisRow();return I.createElement("div",{className:`${this.props.className}__ellipsis`,"aria-hidden":!0},I.createElement("table",{className:`${this.props.className}__table`,style:{width:this.state.tableWidth,tableLayout:this.state.tableLayoutFixed?"fixed":void 0}},e,I.createElement("tbody",null,t)))}render(){const e=Math.ceil(3*this.props.windowWidth/5)-40,t=Math.floor(e/22),n=22*t;return I.createElement("div",null,I.createElement("div",{className:this.props.className,style:{maxHeight:n},ref:e=>{this.tableContainerDivRef=e}},this.renderTable()),this.getRowCount()>t?this.renderEllipsis():null)}constructor(e){super(e),this.state={colWidths:new Array(this.getColumnCount()),collapseColIndex:-1,tableWidth:"",tableLayoutFixed:!1},this.resizeObserver=new Ri.A((e=>{e.forEach((()=>{this.restyleTable()}))}))}}var Bi=n(355908),$i=n(342935);function Hi({textAnalysis:e,title:t,tableContext:n}){const a=(0,o.iPS)("Microsoft.Office.Excel.FA000000124.EnableTextAnalysisCitation",!1),r=e.textAnalysisResult.bulletList,i=function(e,t,n,a){if(!e||!a||a.length<=0)return{chatReferences:void 0,referencesForV2:void 0};const o=t.sheetRange.range.topLeft;if(null===o.column||null===o.row)throw new Error("unexpected range. The supported range should be a limited one.");const r=t.sheetRange.sheet,i=o.column+n.left+1,l=o.row+n.top+1;let s=1;const d=[],u=[];return a.forEach((e=>{const t=function(e,t,n,a){const o=e=>`${t}!${(0,$i.LM)(n+e,a)}`;return e.map(o)}(e.reference,r,l,i),n=function(e){if(e.length<=0)return"";try{let t=e[0].split("!")[0];return e.length<=3?t+=` ${e.map((e=>e.split("!")[1])).join(", ")}`:(t+=` ${e[0].split("!")[1]}`,t+=" ...",t+=` ${e[e.length-1].split("!")[1]}`),t}catch{return""}}(t),a=e.reference.length>c.ifF,o=function(e,t){if(t.length<=0)return[];if(e){const e=t.slice(0,c.ifF-2);return e.push(t[t.length-1]),e}return t}(a,t),m=function(e,t,n){if(!t||!n||t.length!==n.length)return"";try{let a="";return e?(n.slice(0,n.length-1).map(((e,n)=>{a+=`${t[n].split("!")[1]}: ${qi(e)}\n`})),a+="...\n",a+=`${t[t.length-1].split("!")[1]}: ${qi(n[n.length-1])}`):n.map(((e,n)=>{a+=`${t[n].split("!")[1]}: ${qi(e)}\n`})),a.replace(/\n$/,"")}catch{return""}}(a,o,e.perviewCitationValues),g={referenceIndex:s,referenceProps:{title:n,primarySubtitle:(0,c.wzu)(),snippet:m,iconAppName:Bi._R.Excel,referenceType:Bi._2.Internal,onClickCitationLink:Vi,path:t}};d.push(g),t.length>0&&(u.push({...g}),s++)})),{chatReferences:d,referencesForV2:u}}(a,n,e.textAnalysisResult.columnReference,r),l=i.chatReferences,s=function(e){if(!e||e.length<=0)return[];return(0,h.getCitationReferenceV2fromV1)(e,h.ChatContainerBuilder.featureFlags,!0).citationsV2}(i.referencesForV2),d=r&&r.length>0?I.createElement("ul",{className:"recommendation__text-analysis_bullet-list"},r.map(((e,t)=>I.createElement("li",{key:t},I.createElement("span",{className:"recommendation__text-analysis__bullet-header"},e.title,":"," "),I.createElement("span",{className:"recommendation__text-analysis__bullet-description"},e.description),a&&l?.length===r.length&&e.reference.length>0&&l[t]?I.createElement("span",{className:"recommendation__text-analysis__bullet-citation","aria-hidden":"true"},I.createElement(h.CitationPill,{...l[t],citationsV2:s,key:t})):null)))):void 0,u=e.textAnalysisResult.generalResponse?I.createElement("div",{className:"recommendation__text-analysis__generalResponse",style:{paddingTop:"50%"}},e.textAnalysisResult.generalResponse):void 0,m=d||u;return I.createElement("div",{className:"recommendation__text-analysis"},I.createElement(Ui,{title:t}),m)}const Ui=({title:e})=>{const t=e?.runs.map((e=>e.text)).join(" ")??"";return I.createElement("div",{className:"recommendation__text-analysis__title"},I.createElement("span",null,t))};const qi=e=>e.length>30?`${e.slice(0,27)}...`:e,Vi=async(e,t,n)=>{(0,a.cY)(`onClickCitationLink called with referenceId : ${e}, and telemetryData : ${n}`),(0,xn.z)()&&xe.iJ.isWebPlatform()&&(void 0!==t&&t.length>0&&await xn.g.getInstance().highlightWithDuration(t,c.Lii),x.M.getInstance().logCitationOnClickEvent())};var Wi=n(710729),Gi=n(313853),zi=n(652382);const Qi={recommendationTitle:{backgroundColor:f.k1.neutralLight,color:f.k1.black},recommendationSubtitle:{color:f.k1.black}},ji=(0,d.n)(Qi);function Ji({visual:e,tableName:t,requestId:n,tableContext:a,chartImageUrl:r,query:i}){const l=(0,ge.j)(),s=(0,xa.d4)((e=>e.selection.interpretations[t])),d=(0,xa.d4)((e=>e.selection.nlEvaluationStates[n]?.intermediateResults??[])),[u]=I.useState((0,xa.d4)((e=>e.selection.selectionContexts[t]))),m=(0,xa.d4)((e=>e.chat.showLoadingUI)),[g,h]=I.useState(!1),[p,b]=I.useState("gpt-o3-mini"),f=(0,o.yw9)("OfficeVSO_8691849_CopilotChartToImage")&&r?.startsWith("data:image")?I.createElement("div",{className:"recommendation__chart",style:{paddingTop:0}},I.createElement("img",{alt:"Chart",src:r})):I.createElement(Xi,{recommendationVisual:e,tableContext:a,onChartRendered:(0,o.yw9)("OfficeVSO_8691849_CopilotChartToImage")?t=>{g||(fo(t,e.id),h(!0))}:void 0}),C=[],y=(0,o.iPS)("Microsoft.Office.Excel.FA000000124.EnableTextAnalysisCitation",!1),T=(0,I.useCallback)((()=>{if(y&&"TextAnalysisVisual"===e.visual?.visualType&&e.visual.textAnalysisResult.bulletList){const{header:t,values:n}=(0,Gi.RU)(e.visual.textAnalysisResult);l((0,kt.Om)(n.map((e=>e.map((e=>null===e?"":e.toString())))),t,a))}}),[e,a,l]),S=(0,I.useCallback)((()=>{y&&"TextAnalysisVisual"===e.visual?.visualType&&e.visual.textAnalysisResult.bulletList&&l((0,kt.vW)(a))}),[e,a,l]);if((0,$i.g8)(e,s)){let n=()=>Promise.resolve(l((0,kt.A4)(t,e,a)));if((0,o.iPS)("Microsoft.Office.Excel.FA000000124.EnableDynamicPlanner",!1)){const e=(0,$i.PX)(d,s);e&&e.length>0&&(n=async()=>{let n=u;for(const o of e)await Promise.resolve(l((0,kt.A4)(t,o,a,(0,$i.gD)(o,s),n))),"TextAnalysisVisual"===o.visual.visualType&&(n={...n,columnCount:n.columnCount+1,address:(0,$i.Ej)(n.rowIndex,n.columnIndex,n.rowCount,n.columnCount+1)})})}C.push({...(0,vo.r1)(Ki(e)),handleButtonOnClick:n,handleOnMouseEnter:T,handleOnMouseLeave:S,isDisabled:m})}if(!(0,$i.fB)(e)){const t=e.visual.textAnalysisResult?.generalResponse??"",n=new ClipboardItem({"text/plain":new Blob([t],{type:"text/plain"})}),a={actionType:v.he.CopyMessageClicked,source:v.KZ.InsightsApi,featureName:v.q.AnalyzeData,userQueryGuid:x.M.userQueryGuid};C.push({buttonTitle:c.xxz.CopyButtonLabel,buttonText:c.xxz.CopyButtonLabel,icon:(0,zi.dD)()?I.createElement(kn.c2D,null):I.createElement(kn.Jg_,null),handleButtonOnClick:()=>(0,jt.Kv)(n,ot.S2.AnalyzeDataError,a),isDisabled:m,popoverText:c.xxz.CopyButtonPopover})}return(0,o.iPS)("Microsoft.Office.Excel.FA000000124.EnableExcelAnalysisWorkflow",!1)&&i&&C.push({buttonTitle:"Reanalyze",buttonText:"Reanalyze",handleButtonOnClick:()=>{l((0,kt.b9)(t,i,p,n))},isDisabled:m}),I.createElement(vo.lJ,{contentBody:I.createElement(I.Fragment,null,"TextAnalysisVisual"!==e.visual?.visualType?I.createElement(Zi,{title:e?.title,subtitleText:(0,Wi.g)(e,!1),tableName:a.address,activeTableSheetName:a.sheetRange.sheet}):void 0,f,(0,o.iPS)("Microsoft.Office.Excel.FA000000124.EnableExcelAnalysisWorkflow",!1)&&i?I.createElement("select",{value:p,onChange:e=>b(e.target.value),style:{marginTop:"10px"}},I.createElement("option",{value:"gpt-o3-mini"},"gpt-o3-mini"),I.createElement("option",{value:"gpt-4o-mini-2024-07-18"},"gpt-4o-mini-2024-07-18"),I.createElement("option",{value:"gpt-4o-11-20"},"gpt-4o-11-20"),I.createElement("option",{value:"gpt-o1"},"gpt-o1"),I.createElement("option",{value:"gpt-o1-mini"},"gpt-o1-mini"),I.createElement("option",{value:"deepseek-r1-distill-qwen-32b"},"deepseek-r1-distill-qwen-32b"),I.createElement("option",{value:"deepseek-r1-full"},"deepseek-r1-full"),I.createElement("option",{value:"phi-4"},"phi-4"),I.createElement("option",{value:"phi-35-mini-instruct"},"phi-35-mini-instruct"),I.createElement("option",{value:"phi-35-moe-instruct"},"phi-35-moe-instruct")):void 0),cardButtons:C,requestId:n})}const Yi=e=>{if(e&&"PivotChartVisual"===e.visual.visualType){if(!(1===e.visual.pivotTable.rowFields.length))return-1;const t=(0,li.ip)(e.visual.chart),n=[t.primary.datapointLimit];t.secondary&&n.push(t.secondary.datapointLimit);const a=n.filter((e=>-1!==e));return 0===a.length?-1:Math.min(...a)}},Xi=({recommendationVisual:e,tableContext:t,onChartRendered:n})=>{const a=e.visual,r=(0,xa.d4)((e=>e.selection.themeColors));switch(a.visualType){case"PivotChartVisual":case"ChartVisual":case"QueryChartVisual":{const t=`${c.Xxp}%`;return I.createElement("div",{className:"recommendation__chart",style:{paddingTop:t}},I.createElement(Ai,{visual:a,"aria-live":"assertive",maxDataPoints:Yi(e),onChartRendered:n,themeColors:r}))}case"PivotTableVisual":{const e=a.pivotTable.pivotTableData,t=e&&0===e.length?"recommendation__empty-pivot-table":"recommendation__pivot-table";return I.createElement("div",{className:t},I.createElement(Di,{"aria-live":"assertive",pivotTable:a.pivotTable,className:"pivot-table-light16",windowWidth:window.innerWidth,type:Mi.PivotTable}))}case"QueryResultVisual":return I.createElement("div",{className:"recommendation__query-result"},I.createElement(Di,{"aria-live":"assertive",className:"query-result",windowWidth:window.innerWidth,type:Mi.QueryResult,data:a.result,formula:a.query}));case"ForecastVisual":return I.createElement(I.Fragment,null,I.createElement("div",{className:"recommendation__chart"},I.createElement(Ai,{visual:a,"aria-live":"assertive",maxDataPoints:Yi(e),themeColors:r,onChartRendered:n})),I.createElement("div",{className:"recommendation__query-result"},I.createElement(Di,{"aria-live":"assertive",className:"query-result",windowWidth:window.innerWidth,type:Mi.QueryResult,data:a.previewTable})));case"TextAnalysisVisual":return(0,o.iPS)("Microsoft.Office.Excel.FA000000124.Insights.EnableTaggingInTextAnalysis",!1)&&a.textAnalysisResult?.analysisType===Ti.uK.Tagging&&a.textAnalysisResult?.tagResult?I.createElement("div",{className:"recommendation__text-analysis-tagging"},I.createElement(Di,{"aria-live":"assertive",className:"text-analysis-tagging",windowWidth:window.innerWidth,type:Mi.TaggingResult,taggingResult:a.textAnalysisResult.tagResult,columnName:a.textAnalysisResult.columnName})):I.createElement(Hi,{textAnalysis:a,title:e.title,tableContext:t});default:return(0,Ci.x)(a)}},Zi=({title:e,subtitleText:t,tableName:n,activeTableSheetName:a})=>{const r=ji();let i="";return i=(0,o.ZAR)()?(0,c.PDm)().replace("{range}",(0,Ot.r)(n)).replace("{sheet}",a):(0,c.I5y)().replace("{0}",(0,Ot.r)(n)),I.createElement("div",{className:"recommendation__title-group"},I.createElement("p",{className:(0,Ao.z)(r.recommendationSubtitle,"recommendation-subtitle")},i),I.createElement("div",{className:(0,Ao.z)(r.recommendationTitle,"recommendation__title")},I.createElement(ti,{title:e})),t&&I.createElement("p",{className:(0,Ao.z)(r.recommendationSubtitle,"recommendation-subtitle")},t))};function Ki(e){return"TextAnalysisVisual"===e.visual.visualType?(0,c.aVz)():"ChartVisual"===e.visual.visualType?(0,c.zVb)():(0,c.W4k)()}var el=n(550781);function tl(e){const t=(0,ge.j)(),[n,a]=(0,I.useState)(!0),o=(0,xa.d4)((e=>e.chat.showLoadingUI)),r=(0,I.useCallback)((()=>{a(!1),t((0,lt.RX)(e))}),[a,t]);return I.createElement(vo.lJ,{contentBody:nl(),requestId:e.requestId,cardButtons:n?[{buttonTitle:(0,c.yXE)(),buttonText:(0,c.yXE)(),handleButtonOnClick:()=>r(),icon:I.createElement(Fn.Eu3,null),isDisabled:o}]:[]})}function nl(){const e=zo();return I.createElement(Nn.B,{className:e.cardStack},I.createElement(u.E,null,(0,c.Y9M)()),I.createElement(u.E,null,(0,c.O8z)()),I.createElement("ul",{className:e.bulletList},I.createElement("li",{key:"first-bullet"},(0,c.vK1)()),I.createElement("li",{key:"second-bullet"},(0,c.m$v)())),I.createElement(u.E,null,(0,c.AS_)()))}function al({requestId:e,columnName:t}){const n=(0,ge.j)();return I.createElement(vo.lJ,{contentBody:I.createElement(I.Fragment,null,(0,c.BZb)()),cardButtons:[{buttonTitle:(0,c.h8D)(),buttonText:(0,c.h8D)(),icon:I.createElement(ba.u5x,null),handleButtonOnClick:()=>{n((0,lt.eM)(v.OP.AnalyzeData)),Ce.p.getInstance().handleTextAnalysisSuggestionQuerySubmission((0,jt.VY)((0,c.b_h)(),{columnName:t}))}}],requestId:e})}function ol({requestId:e,textAnalysis:t,title:n}){const a=(0,xa.d4)((e=>e.chat.showLoadingUI)),o=t.textAnalysisResult.bulletList&&t.textAnalysisResult.bulletList.length>0?I.createElement("ul",{className:"recommendation__text-analysis_bullet-list"},t.textAnalysisResult.bulletList.map(((e,t)=>I.createElement("li",{key:t},I.createElement("span",{className:"recommendation__text-analysis__bullet-header"},e.title,":"," "),I.createElement("span",{className:"recommendation__text-analysis__bullet-description"},e.description))))):void 0,r=t.textAnalysisResult.generalResponse?I.createElement("div",{className:"recommendation__text-analysis__generalResponse",style:{paddingTop:"50%"}},t.textAnalysisResult.generalResponse):void 0,i=o||(r||void 0),l=t.textAnalysisResult.generalResponse??"",s=new ClipboardItem({"text/plain":new Blob([l],{type:"text/plain"})}),d={actionType:v.he.CopyMessageClicked,source:v.KZ.InsightsApi,featureName:v.q.AnalyzeData,userQueryGuid:x.M.userQueryGuid};return I.createElement(vo.lJ,{contentBody:I.createElement("div",{className:"recommendation__text-analysis"},I.createElement(rl,{title:n}),i),cardButtons:[{buttonTitle:c.xxz.CopyButtonLabel,buttonText:c.xxz.CopyButtonLabel,icon:(0,zi.dD)()?I.createElement(kn.c2D,null):I.createElement(kn.Jg_,null),handleButtonOnClick:()=>(0,jt.Kv)(s,ot.S2.AnalyzeDataError,d),isDisabled:a}],requestId:e})}const rl=({title:e})=>{const t=e?.runs.map((e=>e.text)).join(" ")??"";return I.createElement("div",{className:"recommendation__text-analysis__title"},I.createElement("span",null,t))};var il=n(164976);const ll={AnalyzeData_V1:I.memo(Ji),ChartAdaptiveCard_V1:I.memo(To),StartDataShaping_V1:I.memo(tl),DataShapingIntro_V1:I.memo(Qo),FormulaSuggestion_V2:I.memo(jo.X),ChatCardHumanInTheLoop_V1:I.memo(Vo.AU),ChatCardListWithColorSwatch_V1:I.memo(Vo.uS),PythonAdaRecommendation_V1:I.memo(mn.m),PythonCalculatedColumn_V1:I.memo(kr),PythonStartAnalysis_V1:I.memo(Xr),PythonStartAnalysisButtonExperiment_V1:I.memo(Zr),ChatCardWithConditionalFormatting_V1:I.memo(Vo.YV),TextAnalysis_V1:I.memo(ol),TextAnalysisSuggestion:I.memo(al),ConditionalFormattingSuggestionCard_V1:I.memo(Vo.g$),CodeAndPostView:I.memo(Wo.o),ImportData_V1:I.memo(vr),ModelessOutput:I.memo(Tr.e),ScratchpadCommandingCard:I.memo(el.x),PythonMergedCard_V1:(0,o.g6K)()?I.memo(Qr):I.memo(Gr),ChartDesignRecommendationsCard_V1:I.memo($o),ChartDesignRecommendationsSnowballChartCard_V1:I.memo(qo)},sl=I.memo((({component:e})=>((0,wr.H5)((()=>{(0,il.np)(e,ot.S2.Error,`Missing renderer for ${e}`)})),I.createElement("i",null,"Sorry, cannot display this message.")))),cl={renderers:ll,renderFallback:e=>I.createElement(sl,{component:e.component})};var dl=n(493284);const ul=e=>{const{message:t,telemetry:n}=dl.n.getAnalyzeDataRecommendationResponse((e=>{switch(e){case"ChartVisual":return{requestId:"Request1",responseText:"Here's a Chart that shows an insight about your data",tableContext:{name:"Table1",address:"Sheet1!A1:D12",sheetRange:{range:{bottomRight:{column:3,row:11},topLeft:{column:0,row:0}},sheet:"Sheet1"}},tableName:"Table1",visual:{id:"PC1",interpretationId:"Interpretation1",title:{runs:[{text:"Mock analyze data chart title"}]},visual:{chart:{axes:[{axisGroup:"primary",dimensionType:"categories",title:{runs:[{text:"Category axis"}]}},{axisGroup:"primary",dimensionType:"values",title:{runs:[{text:"Value axis"}]}}],data:{dimensions:[{id:1,values:{raw:[2015,2016,2017],strings:["2015","2016","2017"]}},{id:3,values:{raw:[111100,249300,437900],strings:["111100","249300","437900"]}}]},series:[{dataBindings:[{dimensionId:1,dimensionType:"categories"},{dimensionId:3,dimensionType:"values"}],layout:"line",valueAxisGroup:"primary",exceptions:[]}]},chartConfig:{},visualType:e}}};case"ForecastVisual":return{requestId:"Request1",responseText:"Here's a Forecast that shows an insight about your data",tableContext:{name:"Table1",address:"Sheet1!A1:D12",sheetRange:{range:{bottomRight:{column:3,row:11},topLeft:{column:0,row:0}},sheet:"Sheet1"}},tableName:"Table1",visual:{id:"PC1",interpretationId:"Interpretation1",title:{runs:[{text:"Mock analyze data forecast title"}]},visual:{chart:{axes:[{axisGroup:"primary",dimensionType:"categories",title:{runs:[{text:"Category axis"}]}},{axisGroup:"primary",dimensionType:"values",title:{runs:[{text:"Value axis"}]}}],data:{dimensions:[{id:1,values:{raw:[2015,2016,2017],strings:["2015","2016","2017"]}},{id:3,values:{raw:[111100,249300,437900],strings:["111100","249300","437900"]}}]},series:[{dataBindings:[{dimensionId:1,dimensionType:"categories"},{dimensionId:3,dimensionType:"values"}],layout:"line",valueAxisGroup:"primary",exceptions:[]}]},previewTable:{fieldHeaders:[{runs:[{text:"Column A"}]},{runs:[{text:"Column B"}]}],fields:[{id:0,values:{raw:["a","b"],strings:["a","b"]}},{id:1,values:{raw:[1,2],strings:["1","2"]}}]},formulasTable:{fieldHeaders:[{runs:[{text:"Column A"}]},{runs:[{text:"Column B"}]}],fields:[{id:0,values:{raw:["a","b"],strings:["a","b"]}},{id:1,values:{raw:[1,2],strings:["1","2"]}}]},visualType:e}}};case"PivotChartVisual":return{requestId:"Request1",responseText:"Here's a PivotChart that shows an insight about your data",tableContext:{name:"Table1",address:"Sheet1!A1:D12",sheetRange:{range:{bottomRight:{column:3,row:11},topLeft:{column:0,row:0}},sheet:"Sheet1"}},tableName:"Table1",visual:{id:"PC1",interpretationId:"Interpretation1",title:{runs:[{text:"Mock analyze data PivotChart title"}]},visual:{chart:{axes:[{axisGroup:"primary",dimensionType:"categories",title:{runs:[{text:"Category axis"}]}},{axisGroup:"primary",dimensionType:"values",title:{runs:[{text:"Value axis"}]}}],data:{dimensions:[{id:1,values:{raw:[2015,2016,2017],strings:["2015","2016","2017"]}},{id:3,values:{raw:[111100,249300,437900],strings:["111100","249300","437900"]}}]},series:[{dataBindings:[{dimensionId:1,dimensionType:"categories"},{dimensionId:3,dimensionType:"values"}],layout:"line",valueAxisGroup:"primary",exceptions:[]}]},chartConfig:{},pivotTable:{columnFields:[],dataFields:[{name:"Sales",dataCalculation:"sum"}],dateFilters:[],filterFields:[],highlightCellReferences:[],labelFilters:[],pivotTableData:[[{value:"Year",isNumber:!1,indent:0},{value:2015,isNumber:!0,indent:0},{value:2016,isNumber:!0,indent:0},{value:2017,isNumber:!0,indent:0},{value:"Grand Total",isNumber:!1,indent:0}],[{value:"Sum of Sales",isNumber:!1,indent:0},{value:" $111,100 ",isNumber:!0,indent:0},{value:" $249,300 ",isNumber:!0,indent:0},{value:" $437,900 ",isNumber:!0,indent:0},{value:" $798,300 ",isNumber:!0,indent:0}]],rowFields:[{name:"Year"}],valueFilters:[]},visualType:e}}};case"PivotTableVisual":return{requestId:"Request1",responseText:"Here's a PivotTable that shows an insight about your data",tableContext:{name:"Table1",address:"Sheet1!A1:D12",sheetRange:{range:{bottomRight:{column:3,row:11},topLeft:{column:0,row:0}},sheet:"Sheet1"}},tableName:"Table1",visual:{id:"PC1",interpretationId:"Interpretation1",title:{runs:[{text:"Mock analyze data PivotTable title"}]},visual:{pivotTable:{columnFields:[],dataFields:[{name:"Sales",dataCalculation:"sum"}],dateFilters:[],filterFields:[],highlightCellReferences:[],labelFilters:[],pivotTableData:[[{value:"Year",isNumber:!1,indent:0},{value:2015,isNumber:!0,indent:0},{value:2016,isNumber:!0,indent:0},{value:2017,isNumber:!0,indent:0},{value:"Grand Total",isNumber:!1,indent:0}],[{value:"Sum of Sales",isNumber:!1,indent:0},{value:" $111,100 ",isNumber:!0,indent:0},{value:" $249,300 ",isNumber:!0,indent:0},{value:" $437,900 ",isNumber:!0,indent:0},{value:" $798,300 ",isNumber:!0,indent:0}]],rowFields:[{name:"Year"}],valueFilters:[]},visualType:e}}};case"QueryResultVisual":return{requestId:"Request1",responseText:"Here's a QueryResult that shows an insight about your data",tableContext:{name:"Table1",address:"Sheet1!A1:D12",sheetRange:{range:{bottomRight:{column:3,row:11},topLeft:{column:0,row:0}},sheet:"Sheet1"}},tableName:"Table1",visual:{id:"PC1",interpretationId:"Interpretation1",title:{runs:[{text:"Mock analyze data query result title"}]},visual:{result:{fieldHeaders:[{runs:[{text:"Column A"}]},{runs:[{text:"Column B"}]}],fields:[{id:0,values:{raw:["a","b"],strings:["a","b"]}},{id:1,values:{raw:[1,2],strings:["1","2"]}}]},visualType:e}}};case"QueryChartVisual":return{requestId:"Request1",responseText:"Here's a QueryResult that shows an insight about your data",tableContext:{name:"Table1",address:"Sheet1!A1:D12",sheetRange:{range:{bottomRight:{column:3,row:11},topLeft:{column:0,row:0}},sheet:"Sheet1"}},tableName:"Table1",visual:{id:"PC1",interpretationId:"Interpretation1",title:{runs:[{text:"Mock analyze data query result title"}]},visual:{result:{fieldHeaders:[{runs:[{text:"Column A"}]},{runs:[{text:"Column B"}]}],fields:[{id:0,values:{raw:["a","b"],strings:["a","b"]}},{id:1,values:{raw:[1,2],strings:["1","2"]}}]},chart:{axes:[{axisGroup:"primary",dimensionType:"categories",title:{runs:[{text:"Category axis"}]}},{axisGroup:"primary",dimensionType:"values",title:{runs:[{text:"Value axis"}]}}],data:{dimensions:[{id:1,values:{raw:[2015,2016,2017],strings:["2015","2016","2017"]}},{id:3,values:{raw:[111100,249300,437900],strings:["111100","249300","437900"]}}]},series:[{dataBindings:[{dimensionId:1,dimensionType:"categories"},{dimensionId:3,dimensionType:"values"}],layout:"line",valueAxisGroup:"primary",exceptions:[]}]},chartConfig:{},visualType:e}}};case"TextAnalysisVisual":return{requestId:"Request1",responseText:"Here's a TextAnalysis that shows an insight about your data",tableContext:{name:"Table1",address:"Sheet1!A1:D12",sheetRange:{range:{bottomRight:{column:3,row:11},topLeft:{column:0,row:0}},sheet:"Sheet1"}},tableName:"Table1",visual:{id:"PC1",interpretationId:"Interpretation1",title:{runs:[{text:"Mock analyze data text analysis title"}]},visual:{textAnalysisResult:{analysisType:Ti.uK.Summary,bulletList:[{title:"Bullet 1",description:"First description",reference:[5],perviewCitationValues:["First citation"]},{title:"Bullet 2",description:"Second description",reference:[2,7],perviewCitationValues:["Second citation 1","Second citation 2"]}],columnName:"Column A",columnReference:{top:1,right:1,bottom:100,left:1},generalResponse:'Here is a summary of "Column A" column:',resultType:Ti.rb.Others,insertionColumnHeader:"Themes"},visualType:e}}};default:(0,bt.x)(e)}})(e));l.$.getInstance().displayResponse(t,n)},ml=()=>{const e=new wi({allowDateAxis:!0,showAxisLabels:!0,showAxisTitles:!1,maxDatapoints:1e3,showHierarchicalCategoryTickLabels:!1}),{message:t,telemetry:n}=dl.n.getChartAdaptiveCardResponse({requestId:"Request1",adaptiveCardDefinition:{body:[{type:"TextBlock",text:"Mock Chart Adaptive Card",wrap:!0},{type:"Chart",definition:JSON.stringify(e.render({axes:[{axisGroup:"primary",dimensionType:"categories",title:{runs:[{text:"Category axis"}]}},{axisGroup:"primary",dimensionType:"values",title:{runs:[{text:"Value axis"}]}}],data:{dimensions:[{id:1,values:{raw:[2015,2016,2017],strings:["2015","2016","2017"]}},{id:3,values:{raw:[111100,249300,437900],strings:["111100","249300","437900"]}}]},series:[{dataBindings:[{dimensionId:1,dimensionType:"categories"},{dimensionId:3,dimensionType:"values"}],layout:"line",valueAxisGroup:"primary",exceptions:[]}]}))},{type:"TextBlock",text:"Dynamic custom response",wrap:!0}],type:"AdaptiveCard",version:"1.3"}});l.$.getInstance().displayResponse(t,n)},gl=()=>{const e=new wi({allowDateAxis:!0,showAxisLabels:!0,showAxisTitles:!1,maxDatapoints:1e3,showHierarchicalCategoryTickLabels:!1}),{message:t,telemetry:n}=dl.n.getChartAdaptiveCardResponse({requestId:"Request1",adaptiveCardDefinition:{body:[{type:"TextBlock",text:"Mock Chart Carousel Adaptive Card",wrap:!0},{type:"Carousel",timer:5e3,pages:[{type:"CarouselPage",id:"firstCarouselPage",items:[{type:"TextBlock",text:"Mock Chart 1",wrap:!0},{type:"Chart",definition:JSON.stringify(e.render({axes:[{axisGroup:"primary",dimensionType:"categories",title:{runs:[{text:"Category axis"}]}},{axisGroup:"primary",dimensionType:"values",title:{runs:[{text:"Value axis"}]}}],data:{dimensions:[{id:1,values:{raw:[2015,2016,2017],strings:["2015","2016","2017"]}},{id:3,values:{raw:[111100,249300,437900],strings:["111100","249300","437900"]}}]},series:[{dataBindings:[{dimensionId:1,dimensionType:"categories"},{dimensionId:3,dimensionType:"values"}],layout:"line",valueAxisGroup:"primary",exceptions:[]}]}))},{type:"TextBlock",text:"Dynamic custom response 1",wrap:!0}]},{type:"CarouselPage",id:"theSecondCarouselPage",items:[{type:"TextBlock",text:"Mock Chart 2",wrap:!0},{type:"Chart",definition:JSON.stringify(e.render({axes:[{axisGroup:"primary",dimensionType:"categories",title:{runs:[{text:"Category axis"}]}},{axisGroup:"primary",dimensionType:"values",title:{runs:[{text:"Value axis"}]}}],data:{dimensions:[{id:1,values:{raw:[2015,2016,2017],strings:["2015","2016","2017"]}},{id:3,values:{raw:[111100,249300,437900],strings:["111100","249300","437900"]}}]},series:[{dataBindings:[{dimensionId:1,dimensionType:"categories"},{dimensionId:3,dimensionType:"values"}],layout:"line",valueAxisGroup:"primary",exceptions:[]}]}))},{type:"TextBlock",text:"Dynamic custom response 2",wrap:!0}]},{type:"CarouselPage",id:"last-carousel-page",items:[{type:"TextBlock",text:"Mock Chart 3",wrap:!0},{type:"Chart",definition:JSON.stringify(e.render({axes:[{axisGroup:"primary",dimensionType:"categories",title:{runs:[{text:"Category axis"}]}},{axisGroup:"primary",dimensionType:"values",title:{runs:[{text:"Value axis"}]}}],data:{dimensions:[{id:1,values:{raw:[2015,2016,2017],strings:["2015","2016","2017"]}},{id:3,values:{raw:[111100,249300,437900],strings:["111100","249300","437900"]}}]},series:[{dataBindings:[{dimensionId:1,dimensionType:"categories"},{dimensionId:3,dimensionType:"values"}],layout:"line",valueAxisGroup:"primary",exceptions:[]}]}))},{type:"TextBlock",text:"Dynamic custom response 3",wrap:!0}]}]}],type:"AdaptiveCard",version:"1.3"}});l.$.getInstance().displayResponse(t,n)},hl=()=>{const{message:e,telemetry:t}=dl.n.getTextAnalysisV1Response({requestId:"Request1",textAnalysis:{textAnalysisResult:{analysisType:Ti.uK.Summary,bulletList:[{title:"Bullet 1",description:"First description",reference:[5],perviewCitationValues:["First citation"]},{title:"Bullet 2",description:"Second description",reference:[2,7],perviewCitationValues:["Second citation 1","Second citation 2"]}],columnName:"Column A",columnReference:{top:1,right:1,bottom:100,left:1},generalResponse:'Here is a summary of "Column A" column:',resultType:Ti.rb.Others,insertionColumnHeader:"Themes"},visualType:"TextAnalysisVisual"},title:{runs:[{text:"Mock text analysis title"}]}});l.$.getInstance().displayResponse(e,t)},pl=()=>{const{message:e,telemetry:t}=dl.n.getFullThemingSuggestionResponse("Request1","");l.$.getInstance().displayResponse(e,t)};var bl=n(5532);const fl=["Sort column A","Format table red"];async function Cl(){}const yl=async()=>{const{message:e,telemetry:t}=Ct.n.getCommandingHumanInTheLoopResponse(fl,Cl);l.$.getInstance().displayResponse(e,t)},vl=async()=>{const e=[{title:"Custom Formula: ",explanation:"Apply formatting using formula below",conditionalFormatResponseCardData:{cardTitle:bl.D.CustomCreated,customFormat:{BackgroundColor:"#000000",TextColor:"#FFFFFF",IsTextBold:!1,IsTextItalic:!1,IsTextStrikethrough:!1,IsTextUnderlined:!1,IsTextDoubleUnderlined:!1,BorderFormat:{Position:15,LineStyle:[0,0,0,0],Color:[0,0,0,0],ThemeBorderColor:[{ThemeColorIndex:0,ThemeColorRow:0},{ThemeColorIndex:0,ThemeColorRow:0},{ThemeColorIndex:0,ThemeColorRow:0},{ThemeColorIndex:0,ThemeColorRow:0}],ColorTypeOption:0,Thickness:[0,0,0,0]},PreserveBackgroundColor:!1,PreserveTextColor:!1},customFormula:"=$E2 > $F2",formulaExplanation:"If E2 is greater than F2"},subExplanations:["Format1","Format2"]}],{message:t,telemetry:n}=Ct.n.getCommandingCFHumanInTheLoopResponse(e,fl,Cl);l.$.getInstance().displayResponse(t,n)},Tl=async()=>{const{message:e,telemetry:t}=Ct.n.getConditionalFormattingSuggestionsResponseMessage([{Description:"Highlight cells below average in column 'Total Budget and Revenue'",TableName:"Table1",ColumnID:1,Key:"Average/Below"},{Description:"Highlight top 3 in column 'Column1'",TableName:"Table1",ColumnID:1,Key:"TopBottom/Top"}],void 0,"Okay! Here are some conditional formatting suggestions for data in {0}","guid");l.$.getInstance().displayResponse(e,t)},xl=async e=>{Ct.n.displayPythonAdaRecommendationResponse({dispatch:e,requestId:"",code:"#Import the pandas library \n import pandas",codeExplanation:"This code imports the pandas library."})},Sl=async e=>{Ct.n.displayPythonStartAnalysisResponse(e,"requestId",!1,"",!1)},wl=async e=>{Ct.n.displayPythonStartAnalysisButtonExperimentResponse(e,"requestId",!1,"",!1)},El=async e=>{Ct.n.displayPythonCodeCardWithPendingPostView(e,"requestId","import pandas","sheetId","A1",!1,"This code imports the pandas library.","Import the pandas library")},Il=async e=>{Ct.n.displayPythonModelessResponse(e,'{"base64_data":"iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEf0lEQVR4nO2bzW8NYRTGH0GJiPRDUoveSgQlImHTJQm18QcQCQvxUf+BLYmF0C5qg5WERJRGbWwEidiwwMLCRkWoaClttUoX7pFpT5Ob6Tszd3rn48w950neVeeeeeb85p33vB8FTCaTyWQySVQJwACAX9wGAXTkbUozjB8AyNd+8t9MGWvAAWOh3c3ajAlzn6ggIJOWoOw1HgJkIgc/6vU0BEi/+uxkrH0A/gXAGAPQlrUhzWoBMBwwbng9w2BkrH4fiDKAg1mbMM3rlKNn9PDfTBlrs6PUfQtgddZGTMBKAC99MP4A2GnJyUeXHZ+q7py8qNdeR4n7EMAy9ZnJQU0APvlgjABozcOMCXOLhJUwvJ7SZYnJR92OccMbS0w5lbhTPhivATRAuUq+Hbl7ANpTvmcDJ78Sxm8A26BcpYAdubGUobhK3NMp3q8uduTupHTPLkeJ6+2TmxC+I+f1ksaEs7QewBfffYZ5dVe9mgDMhgAh3rE7x3OFJPTAUeLuV08C84PnuwgYlc3rSRcBNNeQvDOOuJcMBnAYwHQMGJVtaolgtnMVVRnrlfYSdzlXN2VHoocAjHLFdZ/3H/xzBP/O3YUqwawC8Mb3+2nth91aADwKSO71gDe1hcePiYge0xex7tTr+N3JgGupxlYI7QLwwWH+b0hiXGDGqwCzwffbA44S1+uB0ArkGIAZh/HPADpjxmrmz9RkBJgeTrprwhlV4tYtkBU8+LpMP3e8yXG0DsDZiB7jatWUuHUJpBXAswDDfbxVmoS8ucn5iDGmsnmH3qIUN8HigXTy58hvdIY/X2moqYoxZuHEuiogJ3igJl/7CGB3BvdvjJjfTGgB4pWs1wKS8JjXj7LSYI1ncQsJZBOvxI5yG3IYK/Mk0JsMZqn2kOX8tnoEshHAt4hv9TQvj+Sldt4nn1zCWdzCAbkVAeN9wQ+WFQbIWj7zGra+NJvgMnleEg/EW/a4GjE7jlPFSJdIIGsAHAfwogoIcasY6RIFZAeAK0tYkohTxUhX7kC8Y/ZHeX0pKunfeeFuDw/uI3X4H0WUBZDKc09eEm9yUnv5zQ6DUOY1oCO80VPvorSBBJ17imrfeGK3FbpEaQMJO/fk6g1PeFKXVm+gGlvhgYSde1poo3z6YgvSFxmQ4CR41dShjE9ekHYgYaufN5C9SDuQDt6YcX2m8ihVKe0HLoK/UsXq51cAt3nVNg+RAZElMiCyRAZElsiAyBIZkPoGQgmX0dJfmMRFBkSWyIDIEhkQXUCiZGNIwRIoflCXXsWQ8HiJy4CEy4D4ZD3EPlmyekit15OyeIlL+gOT8HiJS/oDk/B4iUv6A5PweIsuiNuK9sAkPJ4BiZABKdgbbT1EGxBpBklZPPEGSVk88QZJWTzxBklZPPEGSVk88QZJWTzxBklZPPEGSVk88QZJWTzxBklZPPEGSVk88QZJWTzxBklZPPEGSVk88QZJWTzxBklZPPEGSVk88QZJWTzxBklZPPEGSVm8RRfEbRYPiebPgEDWC2hAYEDsEwhfD/kPC3d1fgj2RhMAAAAASUVORK5CYII="}',Tr.z.Image,!0,!1,!0)},Rl=async e=>{dt.CP.pythonContextManager.lastCodeAndPostViewMessage={chatCardType:Ka._.Default,chatMessageData:{chatCardWrapperProps:{renderData:{component:"",props:{}}}}};const t={pythonContextManager:{},workbook:{localImage:{getBase64EncodedImageData:e=>({value:e})}},sync:()=>{}},a=Promise.all([n.e("chunk1jsfluent"),n.e("vendors-npm_store_sdx_officecopilot_1js-excel-copilot-calc_8_3_43-1adabd76bb06679768ec_node_m-dd2f81"),n.e("calc")]).then(n.bind(n,478565)),o={id:"sheetId",getRange:e=>({load:t=>({address:e??"A1",valuesAsJson:[[{type:"ExternalCodeServiceObject",basicType:"Error",basicValue:"#VALUE!",preview:{type:"Entity",basicType:"Error",basicValue:"#VALUE!",text:"Image",properties:{image:{type:"LocalImage",basicType:"Error",basicValue:"#VALUE!",image:{cachedUid:"{D250033B-D6AF-4048-82FB-A4A123FBB6BF}"}}}}}]]}),valuesAsJson:()=>[[{type:"String",basicValue:"Hello"}]]}),load:e=>({})};Ct.n.updatePythonCodeAndPostViewCardWithPostView(e,"A1",a,o,t,{})},Al=async e=>{const t=[{type:"text",value:{text:"text1"}},{type:"code",value:{code:"code1",codeExplanation:"codeExplanation1"}},{type:"text",value:{text:"text2"}},{type:"code",value:{code:"code2",codeExplanation:"codeExplanation2"}}];Ct.n.displayPythonMergedCardResponse(e,t,!1,!1,"requestIdForMergedCard","messageIdForMergedCard"),t.push({type:"finalText",value:{finalText:"finalText1"}}),Ct.n.displayPythonMergedCardResponse(e,t,!0,!0,"requestIdForMergedCard","messageIdForMergedCard")},Ll=async()=>{Ct.n.displayStartDataShapingResponse((0,an.A)(),"Table1",(0,an.A)(),"testMashupDocument","NewQuery","testQueryScript")},kl="❌",Fl=`${kl} Unexpected Error`,_l=`${kl}${kl}${kl} Test Failed`,Pl="⚠️ Missing Test Coverage",Nl="✅ Test Passed",Ml=["PythonCalculatedColumn_V1","ChatCardListWithColorSwatch_V1","ChatCardWithConditionalFormatting_V1","ScratchpadCommandingCard","ChartDesignRecommendationsCard_V1","ChartDesignRecommendationsSnowballChartCard_V1"],Ol=async(e,t)=>{const n=new Map(Object.keys(cl.renderers).map((e=>[e,Pl]))),a=`Chat History Tests - ${(new Date).toLocaleTimeString()}`;n.set("SimpleTextCard",await Dl(t,e,a,(()=>{}),[{contentParts:[a]}],!0)),await async function(e,t,n){const a=[(0,c.Y9M)(),(0,c.O8z)(),(0,c.vK1)(),(0,c.m$v)(),(0,c.AS_)()];n.set("StartDataShaping_V1",await Dl(e,t,"Start Data Shaping",Ll,[{contentParts:a}]));const o=[(0,c.i3R)(),(0,c.pF5)()],r="Data Shaping Intro mock metadata";n.set("DataShapingIntro_V1",await Dl(e,t,"Data Shaping Intro",(()=>(async e=>{Ct.n.displayDataShapingIntroResponse(e,(0,an.A)())})(r)),[{contentParts:o,metadata:r}]));const i="Done! i've removed the Budget column",s="Add step mock metadata";n.set("DataShapingAddStep",await Dl(e,t,"Data Shaping Add step",(()=>(async(e,t)=>{const{message:n,telemetry:a}=Ct.n.getDataShapingSuccessResponse(e,t,(async e=>{}));l.$.getInstance().displayResponse(n,a)})(i,s)),[{contentParts:[i],metadata:s}])),n.set("DataShapingReplaceTable",await Dl(e,t,"Data Shaping replace table",(()=>(async()=>{const{message:e,telemetry:t}=Ct.n.getExitModeResponse("replace",{});l.$.getInstance().displayResponse(e,t)})()),[{contentParts:[(0,c.K1Z)()]}]))}(t,e,n),n.set("ImportData_V1",await Dl(t,e,"Import Data",qa,[{contentParts:[(0,c.h9u)().replace("{0}","2")]}])),n.set("PythonAdaRecommendation_V1",await Dl(t,e,"PythonAdaRecommendation",xl,[{contentParts:["#Import the pandas library \n import pandas","This code imports the pandas library"]}])),n.set("ChatCardHumanInTheLoop_V1",await Dl(t,e,"Commanding HiTL",yl,[{contentParts:["Sort column A","Format table red"]}])),n.set("ChatCardWithConditionalFormatting_V1",await Dl(t,e,"Commanding Conditional Formatting Formula HiTL",vl,[{contentParts:["Sort column A","Format table red","Custom Formula: Apply formatting using formula below","Format1","Format2","=$E2 > $F2","If E2 is greater than F2"]}])),n.set("ConditionalFormattingSuggestionCard_V1",await Dl(t,e,"Commanding Conditional Formatting Suggestion",Tl,[{contentParts:["Highlight cells below average in column 'Total Budget and Revenue'","Average/Below","Highlight top 3 in column 'Column1'","TopBottom/Top"]}])),n.set("FormulaSuggestion_V2",await Dl(t,e,"Calculated Column",za,[{contentParts:["=SOME_FORMULA()"]}])),await async function(e,t,n){const a=new Map,o=(0,c.PDm)().replace("{range}","A1:D12").replace("{sheet}","Sheet1");a.set("AnalyzeData_V1_PivotChart",await Dl(e,t,"Analyze Data PivotChart Recommendation",(()=>ul("PivotChartVisual")),[{contentParts:[o,"Mock analyze data PivotChart title","Sum of Sales (Thousands)"],imageCount:0},{contentParts:[o,"Mock analyze data PivotChart title","Sum of Sales (Thousands)"],imageCount:1}])),a.set("AnalyzeData_V1_Chart",await Dl(e,t,"Analyze Data Chart Recommendation",(()=>ul("ChartVisual")),[{contentParts:[o,"Mock analyze data chart title","(Thousands)"],imageCount:0},{contentParts:[o,"Mock analyze data chart title","(Thousands)"],imageCount:1}])),a.set("AnalyzeData_V1_PivotTable",await Dl(e,t,"Analyze Data PivotTable Recommendation",(()=>ul("PivotTableVisual")),[{contentParts:[o,"Mock analyze data PivotTable title"],imageCount:0}])),a.set("AnalyzeData_V1_TextAnalysis",await Dl(e,t,"Analyze Data Text Analysis Recommendation",(()=>ul("TextAnalysisVisual")),[{contentParts:["Mock analyze data text analysis title",'Here is a summary of "Column A" column:',"Bullet 1: First description","Bullet 2: Second description"]}])),a.set("AnalyzeData_V1_QueryResult",await Dl(e,t,"Analyze Data Query Result Recommendation",(()=>ul("QueryResultVisual")),[{contentParts:[o,"Mock analyze data query result title"]}])),a.set("AnalyzeData_V1_Forecast",await Dl(e,t,"Analyze Data Forecast Recommendation",(()=>ul("ForecastVisual")),[{contentParts:[o,"Mock analyze data forecast title","(Thousands)"],imageCount:0},{contentParts:[o,"Mock analyze data forecast title","(Thousands)"],imageCount:1}])),Array.from(a.values()).every((e=>e===Nl))?n.set("AnalyzeData_V1",Nl):n.set("AnalyzeData_V1",_l);a.forEach(((e,t)=>{n.set(t,e)}))}(t,e,n),await async function(e,t,n){const a=new Map;a.set("ChartAdaptiveCard_V1_Chart",await Dl(e,t,"Chart Adaptive Card",ml,[{contentParts:["Mock Chart Adaptive Card","Dynamic custom response"],imageCount:0},{contentParts:["Mock Chart Adaptive Card","Dynamic custom response"],imageCount:1}])),a.set("ChartAdaptiveCard_V1_Carousel",await Dl(e,t,"Chart Carousel Adaptive Card",gl,[{contentParts:["Mock Chart Carousel Adaptive Card","Mock Chart 1","Dynamic custom response 1","Mock Chart 2","Dynamic custom response 2","Mock Chart 3","Dynamic custom response 3"],imageCount:0},{contentParts:["Mock Chart Carousel Adaptive Card","Mock Chart 1","Dynamic custom response 1","Mock Chart 2","Dynamic custom response 2","Mock Chart 3","Dynamic custom response 3"],imageCount:1},{contentParts:["Mock Chart Carousel Adaptive Card","Mock Chart 1","Dynamic custom response 1","Mock Chart 2","Dynamic custom response 2","Mock Chart 3","Dynamic custom response 3"],imageCount:2},{contentParts:["Mock Chart Carousel Adaptive Card","Mock Chart 1","Dynamic custom response 1","Mock Chart 2","Dynamic custom response 2","Mock Chart 3","Dynamic custom response 3"],imageCount:3}])),Array.from(a.values()).every((e=>e===Nl))?n.set("ChartAdaptiveCard_V1",Nl):n.set("ChartAdaptiveCard_V1",_l);a.forEach(((e,t)=>{n.set(t,e)}))}(t,e,n),n.set("TextAnalysis_V1",await Dl(t,e,"Text Analysis",hl,[{contentParts:["Mock text analysis title",'Here is a summary of "Column A" column:',"Bullet 1: First description","Bullet 2: Second description"]}])),n.set("TextAnalysisSuggestion",await Dl(t,e,"Run Full Theme Analysis",pl,[{contentParts:["The quick summary above considers only part of your data. Would you like a full theme analysis that you can insert in a new column? It may take a few minutes.\nRun full theme analysis"]}])),n.set("ModelessOutput",await Dl(t,e,"Base64 Image Modeless output",Il,[{contentParts:["image"]},{imageCount:1,contentParts:["image"]}])),n.set("CodeAndPostView",await Dl(t,e,"Code And Post View",El,[{contentParts:[(0,pn.L)((0,c.vX0)(),["A1"])+"\nCode: import pandas\nCode Explanation: This code imports the pandas library."]}])),n.set("UpdatePythonCodeAndPostViewCardWithPostView",await Dl(t,e,"Code And PostView Card With PostView",Rl,[{imageCount:1,contentParts:["Here's what I inserted in A1:\nCode: import pandas\nCode Explanation: This code imports the pandas library."]}])),n.set("PythonStartAnalysis_V1",await Dl(t,e,"Python Start Analysis",Sl,[{contentParts:[`${(0,c.XXH)()}\n${(0,c.zqN)()}\n${(0,c.lQ6)()}\n${(0,c.WQT)()}\n${(0,c.LMV)()}`]}])),n.set("PythonStartAnalysisButtonExperiment_V1",await Dl(t,e,"Python Start Analysis Button Experiment",wl,[{contentParts:[`${(0,c.XXH)()}\n${(0,c.zqN)()}\n${(0,c.lQ6)()}\n${(0,c.WQT)()}\n${(0,c.LMV)()}`]}])),n.set("PythonMergedCard_V1",await Dl(t,e,"Python Merged Card",Al,[{contentParts:["text1\nCode: code1\nCode Explanation: codeExplanation1\ntext2\nCode: code2\nCode Explanation: codeExplanation2\nfinalText1"],metadata:'{"chunks":[{"type":"text","value":{"text":"text1"}},{"type":"code","value":{"code":"code1","codeExplanation":"codeExplanation1"}},{"type":"text","value":{"text":"text2"}},{"type":"code","value":{"code":"code2","codeExplanation":"codeExplanation2"}},{"type":"finalText","value":{"finalText":"finalText1"}}],"isUpdatedCodeChunk":false}'}]));for(const e of Ml)n.set(e,"✅ Test Skipped (not needed)");Bl(Array.from(n,(([e,t])=>`${e}: ${t}`)).sort().join("\n"))};async function Dl(e,t,n,a,o,r=!1){return new Promise((i=>{const l=new AbortController,s=setTimeout((()=>{i(`${_l}: timed out after ${Math.round(4)} seconds`),l.abort()}),4e3);let c=0;const d=t=>{clearTimeout(s),e.debugEvents.removeEventListener(String(Za.PV.QuerySubmitted),u),i(t)},u=t=>{const n=function(e,t){if(!(e instanceof CustomEvent))return void t(`${Fl}: no CustomEvent: ${JSON.stringify(e)}`);const n=e.detail;if(!("operation"in n))return void t(`${Fl}: no operation in eventArgs: ${JSON.stringify(n)}`);const a=JSON.parse(n.operation);if(!to.g0.typeGuard(a))return void t(`${Fl}: no SignalOperation: ${JSON.stringify(n)}`);const o=a.items[0]?.body;if(!o||!Xa.T.typeGuard(o))return void t(`${Fl}: no CopilotChatHistorySignal: ${JSON.stringify(a)}`);const r=o.operation;if(!r)return void t(`${Fl}: no AddMessageOperation: ${JSON.stringify(o)}`);const i=r.newMessage;if(!i)return void t(`${Fl}: no CopilotMessage: ${JSON.stringify(r)}`);return i}(t,d);if(!n)return;if(n.userRole===Ya.gG.User&&!r)return;c>=o.length?d(`${Pl}: no expectation set for update: ${c}`):c===o.length-1&&e.debugEvents.removeEventListener(String(Za.PV.QuerySubmitted),u);const a=function(e,t){const n=e.richTextJson;if(!n)return void t(`${Fl}: no richTextJson: ${JSON.stringify(e)}`);try{return JSON.parse(n)}catch(e){return void t(`${Fl}: bad richTextJson: ${JSON.stringify(n)}. Error: ${e}`)}}(n,d);if(!a)return;const{contentParts:i,imageCount:l,metadata:s}=o[c];c++,function(e,t,n){const a=e.content.trim();0===a.length&&t.length>0&&n(`${_l}: empty content field, signal: ${JSON.stringify(e)}`);a.length>0&&0===t.length&&n(`${Pl}: no expectation set. signals content: ${JSON.stringify(a)}`);t.forEach((e=>{a.includes(e)||n(`${_l}: expected content part wasn't found. Expected: ${JSON.stringify(t)}. Actual: ${JSON.stringify(a)}`)}))}(n,i,d),function(e,t,n){if(e){const a=t.messageMetadata?.metadata;a||n(`${_l}: no metadata found. Expected: ${JSON.stringify(e)}.`),a!==e&&n(`${_l}: unexpected metadata. Expected: ${JSON.stringify(e)}. Actual: ${JSON.stringify(a)}`)}}(s,n,d),function(e,t,n){if(void 0!==e){const a=t.images;(a?.length??0)!==e&&n(`${_l}: unexpected number of images. Expected: ${e}. Actual: ${a?.length??0}`)}}(l,n,d),c>=o.length&&d(Nl)};e.debugEvents.addEventListener(String(Za.PV.QuerySubmitted),u,{signal:l.signal}),Bl(n),a(t)}))}function Bl(e){(0,a.cY)(`showUserTextCard: ${e}`),l.$.getInstance().displayResponse({chatCardType:Ka._.Default,chatMessageData:{defaultMessageProps:{user:eo.Q9.Human,messageHeader:{text:e}}}})}const $l={[vn.U2.Running]:Kn.H.info,[vn.U2.Success]:Kn.H.success,[vn.U2.Failure]:Kn.H.error};function Hl({communicationHandler:e,setCannedOption:t}){const[n,r]=I.useState(!1),[i,l]=I.useState(!1),[s,c]=I.useState(void 0),[d,u]=I.useState(!0),[m,g]=I.useState(!1),[h,p]=I.useState([]),[b,f]=I.useState({resolve:()=>{}}),[C,y]=I.useState(),[T,x]=I.useState({reject:()=>{}}),S=I.createRef(),[w,E]=I.useState(0),R=(0,ge.j)(),A=async()=>{try{let e=null;const t=S.current?.files,n=t?.length;if(!t||!n)throw new Error("No test files uploaded");if(1===n&&t.item(0)?.name.endsWith(".js")){const n=await t.item(0).text(),a=t.item(0).name.slice(0,-3);return e=[{filename:a,tests:[{query:a,create:{type:"worksheet",workbook:"",name:""},officeScripts:{code:n,codeExplanation:"Test",canMakeChanges:!1,returnsValue:!0,apiUsageMetadata:{}},requiredFeatureUsed:v.q.OfficeJsCommanding}]}],void b.resolve({testSets:e,workbooks:{},savingWorksheetStates:d,dirHandle:s})}const a=[];for(let o=0;o<n;o++){const n=t.item(o);if(n)if(n.name.endsWith(".json")){const t=await n.text();try{e=e??[];const a=n.name.slice(0,-5);e.push({filename:a,tests:JSON.parse(t)})}catch{throw new Error("Could not parse "+n.name)}}else n.name.endsWith(".xlsx")&&a.push(n)}if(!e||!Array.isArray(e))throw new Error("Please upload a json file with a list of test details");const o=[];for(const{filename:t,tests:n}of e)for(let e=0;e<n.length;e++){const r=n[e],i=`${t}'s test ${e}`;if(!r.query)throw new Error(`${i} does not have a query`);if(!r.create)throw new Error(`No instructions on how to create ${i}'s workbook state`);if(r.expectedFailureStates){const e=r.expectedFailureStates.filter((e=>!(0,vn.pE)(e)));if(e.length)throw new Error(`Expected errors states [${e.join(", ")}] do not exist. Valid states are:\n${vn.uq.join("\n")}`)}if("string"==typeof r.create)continue;const l=r.create;if(!l.workbook)throw new Error(`No workbook named to create ${i}'s state`);if(!l.name)throw new Error(`No active selection was named for ${i}`);if(!l.type)throw new Error(`No active selection types was named for ${i}`);const s=a.find((e=>e.name===l.workbook));if(!s)throw new Error(`Workbook ${l.workbook} was not uploaded to create ${i}'s state`);o.includes(s)||o.push(s)}const r={};await Promise.all(o.map((e=>new Promise(((t,n)=>{const a=new FileReader;a.onload=()=>{if(!a.result)return n(new Error(e.name+" could not be uploaded"));const o=a.result.toString().indexOf("base64,"),i=a.result.toString().substr(o+7);r[e.name]=i,t(null)},a.readAsDataURL(e)}))))),b.resolve({testSets:e,workbooks:r,savingWorksheetStates:d,dirHandle:s})}catch(e){alert("Failed uploading test files: "+e.message),b.resolve({})}},L=async(t=!0,n,o,r,i,s=!1,c)=>{OfficeExtension.config.extendedErrorLogging=!0,g(!!i);const d=[],u={};let m,h=!1;if(n&&o&&r)d.push({filename:r,tests:n}),Object.assign(u,o);else{const e=await(async()=>(l(!0),new Promise((e=>f({resolve:e}))).finally((()=>l(!1)))))();if(!e.testSets||!e.workbooks)return[];g(!!i),Object.assign(d,e.testSets),Object.assign(u,e.workbooks),h=e.savingWorksheetStates,m=e.dirHandle}let b=!1;if(t){const e=d.flatMap((({filename:e,tests:t})=>t.flatMap(((t,n)=>t.check?[]:[` ${e} ${n}:  ${t.query}`]))));e.length&&((0,a.cY)("Tests without checks:",e.join("\n")),b=confirm(`You selected automated tests but have ${e.length} tests without checks (find "Tests without checks" in the console for list of queries).\nDo you want to count tests that successfully apply changes as passing?`))}i&&(h=!1);const C=await(0,Ma.Eb)((()=>({}))),v=C.documentConfig?.documentSensitivity;if(h&&v?.isEncrypted&&alert(`Before and after workbooks for each test won't be downloaded because this document's "${v.displayName}" sensitivity. An unencrypted sensitivity label is required to save to those state, but the tests will run as normal.`),h&&!confirm(`All the data in your workbook will be deleted and ${2*d.flatMap((({tests:e})=>e)).length} workbooks will be saved in your ${m?.name??"current downloads"} folder. Do you want to continue?`))return[];const T=[];for(const n of d){E(n.tests.length);let a,o=m;d.length>1&&m&&h&&(o=await m.getDirectoryHandle(n.filename.replace(/\.\w$/,""),{create:!0})),a=i?new Xn(n,u,R,e,p,m):new vn.KF(n,u,R,e,b,h,p,x,t?void 0:y,m,o,s,c);const r=await a.run();T.push(...r),p([])}return OfficeExtension.config.extendedErrorLogging=!1,T};if(I.useEffect((()=>{(0,o.usH)()&&"undefined"!=typeof window&&(window.runTests=async(e,t,n,a,o,r=!1,i=void 0)=>await L(e,t,n,a,o,r,i))}),[L]),!(0,o.usH)())return null;const k=async t=>{switch(t){case"Automated Tests":return L(!0);case"Manual Tests":return L(!1);case"Extract Test Context Only":return L(!1,void 0,void 0,void 0,!0);case"Calculated Columns":return(async e=>{const t=(0,an.A)(),n=e;n(rt.m.setLatestRequestId(t));const a=dt.CP.getActiveTable();if(!a)return;const o=a.name;await n((0,kt.VW)(o,t)),e(Et.m.updateTableName({requestId:t,table:o})),n(Et.m.startFetching(t)),e(rt.m.startExecutingCommand({command:v.OP.CalculatedColumns,id:t})),n((0,It.UN)(ja(t,"1",["1"],["link"],['=HYPERLINK("https://www.microsoft.com", "Microsoft")'],[Qa(a,1)]))),n((0,It.UN)(ja(t,"1",["1"],["row"],["=ROW()"],[Qa(a,1)]))),n((0,It.UN)(ja(t,"2",["2","3"],["Row*10","Row*100"],["=ROW() * 10","=ROW() * 100"],[Qa(a,10),Qa(a,100)]))),n((0,It.UN)(ja(t,"3",["4","5","6","7","8","9","10","11"],["Row*10","Row*100","Row*1000","Row*10000","Row*100000","long name with spaces long name with spaces","name with\n             new line","Row*100000000"],["=ROW() * 10","=ROW() * 100","=ROW() * 1000","=ROW() * 10000","=ROW() * 100000","=ROW() * 1000000","=ROW() * 10000000","=ROW() * 100000000"],[Qa(a,10),Qa(a,100),Qa(a,1e3),Qa(a,1e4),Qa(a,1e5),Qa(a,1e6),Qa(a,1e7),Qa(a,1e8)])))})(R);case"Calculated Row":return(async e=>{const t=(0,an.A)(),n=e;n(rt.m.setLatestRequestId(t));const a=dt.CP.getActiveTable();if(!a)return;const o=a.name;await n((0,kt.VW)(o,t)),e(Et.m.updateTableName({requestId:t,table:o})),n(Et.m.startFetching(t)),e(rt.m.startExecutingCommand({command:v.OP.CalculatedColumns,id:t})),n((0,It.UN)(Ja(t,"1",["1"],["=ROW()"],["1"])))})(R);case"Search With Citations":return(async e=>{const t=Ba;await Wa(t,e)})(R);case"Web Search With Table":return(async e=>{const t=Ha;await Wa(t,e)})(R);case"Adaptive Card":return(async e=>{const t=Ua;await Wa(t,e)})(R);case"Search Negative Tests":return Va(R);case"Import Data - Render Card":return qa(R);case"Chat History":return Ol(R,e)}},F=[{key:"flux-getInsights",text:"Use the Analyze Data skill directly"},{key:"flux-createCalculatedColumns",text:"Use the Calculated Columns skill directly"},...(0,o.vom)()?[{key:"flux-pythonCalculatedColumns",text:"Use the Python Calculated Columns skill directly"}]:[],{key:"flux-editDocument",text:"Use the Commanding skill directly"},...(0,o.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.DataShaping",!1)?[{key:"flux-dataShaping",text:"Use the Data Shaping skill directly"}]:[],...(0,o.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.ImportDataAsSkill",!1)?[{key:"flux-importData",text:"Use the Import Data as skill directly"}]:[],{key:"python",text:"Use the Python skill directly"},...(0,o.GqX)()?[{key:"flux-pythonEditInPlace",text:"Use the Python Edit In-Place skill directly"}]:[]];F.push({key:"flux-createCalculatedCell",text:"Use the Column Aggregation skill directly"}),F.push({key:"no-override",text:"No override",iconProps:{iconName:"Checkmark"}});const _={items:F,onItemClick(e,n){F.forEach((e=>delete e.iconProps)),n&&(n.iconProps={iconName:"Checkmark"}),"no-override"===n?.key?t?.():t?.(n?.key)}},P={items:[{key:"Automated Tests",text:"Automated End-to-End Tests"},{key:"Manual Tests",text:"Manual End-to-End Tests"},{key:"Extract Test Context Only",text:"Extract Test Context Only"},{key:"Calculated Columns",text:"Calculated Columns suggestion"},{key:"Calculated Row",text:"Calculated Row suggestion"},{key:"Import Data - Render Card",text:"Import Data - Render Card"},{key:"Search With Citations",text:"Search With Citations"},{key:"Web Search With Table",text:"Web Search With Table"},{key:"Adaptive Card",text:"Adaptive Card"},{key:"Search Negative Tests",text:"Search Negative Tests"},{key:"Chat History",text:"Chat History Tests"}],onItemClick(e,t){r(!0),k(t?.key).finally((()=>r(!1)))}};if(i){const e=()=>b.resolve({});return I.createElement(ea.a,{isOpen:!0,onDismiss:e,styles:{main:{position:"fixed",top:0,zIndex:100,minHeight:0}}},I.createElement("input",{type:"file",id:"test-selector",ref:S,multiple:!0,accept:"*.json,*.xlsx,*.js",style:{display:"none"},onChange:A}),I.createElement(Nn.B,null,I.createElement(Mn.K,{iconProps:{iconName:"Cancel"},onClick:e}),I.createElement(ta.Y,{text:"Select Test File and Workbooks",primary:!0,onClick:()=>S.current?.click()}),(0,Yn.vH)()?I.createElement(ta.Y,{text:"Select Output folder",primary:!0,onClick:()=>window.showDirectoryPicker().then(c)}):null,m?null:I.createElement(na.l,{label:"Save Workbook States",inlineLabel:!0,defaultChecked:!0,onText:"On",offText:"Off",onChange:(e,t)=>u(!!t),styles:{root:{margin:"10px auto"}}})))}return n?I.createElement(ea.a,{isOpen:!0,styles:{main:{position:"fixed",top:0,minHeight:0,maxHeight:"unset",padding:"5px"}}},I.createElement(En.n,{multiple:!0,collapsible:!0},I.createElement("h3",{style:{textAlign:"center",margin:0,fontFamily:"sans-serif"}},`Tests ${h.length}/${w}`),I.createElement(Mn.K,{iconProps:{iconName:"Cancel"},onClick:T.reject}),h.map(((e,t)=>I.createElement(In.A,{key:t,value:t},I.createElement(Rn.u,{expandIconPosition:"end"},I.createElement(aa.n,{messageBarType:$l[e.state]},e.test.query,": ",I.createElement("b",null,e.stateDetails.at(-1)))),C?.test===e.test?I.createElement("div",{style:{width:"80%",margin:"auto",marginTop:"5px"}},I.createElement("h4",{style:{textAlign:"center",margin:0,fontFamily:"sans-serif"}},"Correct?"),I.createElement(oa.j,{style:{float:"left",marginBottom:"5px"},onClick:()=>C.resolve(!0)},"Yes"),I.createElement(oa.j,{style:{float:"right"},onClick:()=>C.resolve(!1)},"No")):null,I.createElement(An.v,null,I.createElement(Ln.$,{"aria-label":"Copy",icon:I.createElement(kn.k8e,null),onClick:()=>(0,Yn.lW)(JSON.stringify(e))}),I.createElement("pre",null,JSON.stringify(e,null,2)))))).reverse())):(0,o.iPS)("Microsoft.Office.Excel.FA000000124.EnableTestUi",!1)?I.createElement(I.Fragment,null,t&&I.createElement(ta.Y,{iconProps:{iconName:"TestPlan"},split:!0,splitButtonAriaLabel:"Set Canned option","aria-roledescription":"Set Canned option",menuProps:_,style:{position:"fixed",top:0,right:100,zIndex:100,opacity:"50%"}}),I.createElement(ta.Y,{iconProps:{iconName:"TestUserSolid"},split:!0,splitButtonAriaLabel:"Run Tests","aria-roledescription":"Run Tests",menuProps:P,style:{position:"fixed",top:0,right:0,zIndex:100,opacity:"50%"}})):I.createElement(I.Fragment,null,!(0,o.yw9)("OfficeVSO_9205837_formulasDevButton")&&t&&I.createElement(ta.Y,{split:!0,splitButtonAriaLabel:"Set Canned option","aria-roledescription":"Set Canned option",menuProps:_,text:"Use skill directly",style:{position:"fixed",top:10,right:15,zIndex:100,opacity:"100%",borderColor:"green"}}))}function Ul(){return(0,o.yw9)("OfficeVSO_9205837_formulasDevButton")&&((0,G.I_)()||(0,o.iPS)("Microsoft.Office.Excel.FA000000124.EnableTestUi",!1))}var ql=n(624654);var Vl=n(882329);var Wl=n(902296),Gl=n(893759);const zl=(0,d.n)((0,Gl.f)({chatFreStack:{flexGrow:1},chatUiStack:{backgroundColor:"transparent"},spinner:{height:"100vh",width:"100vw",justifyContent:"center",alignItems:"center"}})),Ql={root:{height:"100vh",width:"100vw",justifyContent:"center",alignItems:"center"}},jl=(0,d.n)({root:{height:"10%",width:"max-content",backgroundColor:"white",zIndex:1}}),Jl={calloutStyles:{marginTop:4,borderRadius:2,paddingRight:10},containerStyles:{maxWidth:"calc(100vw - 20px)",minWidth:"calc(100vw - 20px)",borderRadius:2,paddingHorizontal:0,paddingTop:0,paddingBottom:8,maxHeight:400},itemsStyles:{fileItemStyles:{iconStyles:{margin:4}}}},Yl={calloutStyles:{marginTop:4,borderRadius:2,paddingRight:0},containerStyles:{maxWidth:"calc(100vw - 20px)",minWidth:"calc(100vw - 20px)",borderRadius:2,paddingHorizontal:0,paddingTop:0,paddingBottom:8,maxHeight:400},itemsStyles:{fileItemStyles:{iconStyles:{margin:4}}}},Xl=()=>{const e=(0,xe.vI)();switch(e){case Office.PlatformType.PC:return"Excel_Win32";case Office.PlatformType.Mac:return"Excel_Mac";case Office.PlatformType.iOS:return"Excel_iOS";case Office.PlatformType.OfficeOnline:return"Excel_Online";default:return x.M.getInstance().logError({eventType:ot.S2.ChatEvents,errorMessage:`Unknown Host Platform Type: ${e}`,logLevel:j.$b.Error}),""}},Zl=()=>{const e=(0,xe.vI)();switch(e){case Office.PlatformType.PC:return"Win32";case Office.PlatformType.Mac:return"Mac";case Office.PlatformType.iOS:return"iOS";case Office.PlatformType.OfficeOnline:return"Web";default:return x.M.getInstance().logError({eventType:ot.S2.ChatEvents,errorMessage:`Unknown Host Platform Type: ${e}`,logLevel:j.$b.Error}),""}};var Kl=n(808943),es=n(206389);const ts=()=>{const e=[];Office.context.document.mode!==Office.DocumentMode.ReadOnly&&e.push((()=>{const e=[];return e.push({nodeType:"ActionSet",text:c.Pqm.generateFormulaColumnSuggestion(),data:{shouldSubmitQueryOnClick:!0}}),e.push({nodeType:"ActionSet",text:c.Pqm.addAColumnThatCombines()}),e.push({nodeType:"ActionSet",text:c.Pqm.addAColumnToExtract()}),e.push({nodeType:"ActionSet",text:c.Pqm.addAColumnThatCalculates()}),{nodeType:"Category",text:c.hn.menuSectionCreate(),promptCategory:"Create",iconRegular:Mo.vfO,iconHover:Mo.Dal,children:e}})());const t=(()=>{const e=[];return e.push({nodeType:"ActionSet",text:c.BaM.showDataInsights(),data:{shouldSubmitQueryOnClick:!0}}),e.push({nodeType:"ActionSet",text:c.BaM.percentageCalculation()}),e.push({nodeType:"ActionSet",text:c.BaM.howManyDifferent()}),e.push({nodeType:"ActionSet",text:c.BaM.whichItems()}),{nodeType:"Category",text:c.hn.menuSectionUnderstand(),promptCategory:"Understand",iconRegular:Mr.uJg,iconHover:Mr._38,children:e}})();t&&e.push(t);const n=(()=>{const e=[];return e.push({nodeType:"ActionSet",text:c.ZB_.highlight()}),e.push({nodeType:"ActionSet",text:c.ZB_.sort()}),e.push({nodeType:"ActionSet",text:c.ZB_.filter()}),e.push({nodeType:"ActionSet",text:c.ZB_.applyRYG()}),{nodeType:"Category",text:c.hn.menuSectionEdit(),promptCategory:"Edit",iconRegular:Mo.RIf,iconHover:Mo.FBb,children:e}})();n&&Office.context.document.mode!==Office.DocumentMode.ReadOnly&&e.push(n),e.push((()=>{const e=[];return e.push({nodeType:"ActionSet",text:c.epH.help(),data:{shouldSubmitQueryOnClick:!0}}),{nodeType:"Category",text:c.hn.menuSectionAsk(),promptCategory:"Ask",iconRegular:Yo.I11,iconHover:Yo.kNP,children:e}})());return{promptGuideMenuData:{nodeType:"Root",text:c.hn.menuTitle(),children:e}}};var ns=n(721794),as=n(851295),os=n(860730),rs=n(630530);const is=e=>{if(l.$.getInstance().getInputText().length>0)return{message:"",restShyMessage:""};const t=(0,o.ZAR)()?void 0:(e=>{if(e&&e?.tableLikeRangeFeatures!==Qe.ye.Unrecognized)return(0,Ot.r)(e.address)})(e),n=(0,o.vIj)()&&((0,Kl.gc)()||(0,Kl.pX)());if(dt.CP.pythonContextManager.isPythonMode)return{message:(0,c.ahY)(),restShyMessage:(0,c.Hn3)()};if(t){let e=n?(0,c.IZs)():(0,c.tl8)();e=e.replace("{0}",t);return{message:e,restShyMessage:(0,c.LA5)().replace("{0}",t)}}return n?{message:(0,c.ir6)(),restShyMessage:(0,c.Hn3)()}:{message:(0,c.NIQ)(),restShyMessage:(0,c.Hn3)()}};function ls(e,t){return{settings:{hostAppId:Xl(),hostAppName:c.fn_,hostAppPlatform:Zl(),hostAppScenario:c.Z1M,hostDefaultLocale:(0,o.yw9)("OfficeVSO_9463384_EditorConfigUseUserLang")?(0,as.gl)():(0,xe.Yd)(),isDogfoodEnvironment:(0,G.I_)(),enableAutomaticScoping:!0,enableVisualRefresh:(0,o.g92)()},telemLogger:{logError:e=>{(0,jt.cY)("Shared Copilot CIQ Error Log: ",e)}},telemSink:x.M.getInstance().getTelemetrySink(),entitiesSupported:[Za.ck.File,Za.ck.People,Za.ck.Event,Za.ck.Message],isExpandedECCEnabled:!0,getSensitivityInfo:Ma.qH,featureFlags:{enableAppGptsInCiq:(0,o.v2n)(),enableAppPluginsInCiq:(0,o.DU1)(),enableTopicECC:(0,o.K7T)(),enableAppMessageExtensionsInCiq:(0,o.vNc)(),enableAppPPInCiq:(0,o.$Xf)(),enableAppTypeBInCiq:(0,o.DDL)(),disableClientConfigQueryCharacterForEditorService:!t&&(0,o.WIm)(),disablePluginsAsDAInFlyout:!(0,o.Pz_)(),enableLocalCUAAgent:(0,o.PrP)()},onOpenGptStorefront:()=>{(0,K.iB)((0,o.dA9)(),!1,J.Xt.AtMention)},onAttachCloudFiles:e,inlineSuggestionsStyles:(0,o.g92)()?Yl:Jl,moreCopilotsStringOverride:(0,o.tmD)()?(0,me.Cs)()?OfficeaicopilotStrings.GetAgents:"Get agents":void 0}}const ss=()=>{const e={promptSuggestionHintCardMap:{[(0,c.Yhj)()]:{headerText:(0,c.o3Z)(),descriptionTextList:[(0,c.hAn)(),(0,c.aS7)(),(0,c.VdU)(),(0,c.aDZ)()]},[(0,c.ekx)()]:{headerText:(0,c.YKk)(),descriptionTextList:[(0,c.vqw)(),(0,c.oOi)()]},[(0,c.byP)()]:{headerText:(0,c.YKk)(),descriptionTextList:[(0,c.v7j)(),(0,c.vks)()]},[(0,c.z15)()]:{headerText:(0,c.cRY)(),descriptionTextList:[(0,c.zr)(),(0,c.sJU)(),(0,c.l7G)(),(0,c.s46)(),(0,c.lqT)()]}}};return(0,o.H2A)()&&(0,Gt.Gd)()&&(e.promptSuggestionHintCardMap[(0,c.n00)()]={headerText:"Use Python to analyze data",descriptionTextList:["Forecast the sales for the next 10 periods","Reduce Features via PCA with 3 components, plot 3d for k means clustering","Summarize each cluster with 75 percentiles in a column in descending order by row sum"]}),e},cs=(e,t)=>({trySydneyToggleChecked:!1,trySydneyToggleEnabled:!1,tryEnterpriseSearchToggleChecked:!1,tryEnterpriseSearchToggleEnabled:!1,tryReviewerAgentToggleOnChange:e,tryReviewerAgentToggleChecked:t,tryReviewerAgentToggleEnabled:(0,o.wBl)()}),ds=(e,t,a,r,i,l,s,d,u,m,g,h,p,b,f,C,y,v)=>{const T={zeroQueryMessageV2Props:(0,os.uC)(b,(()=>{r((0,lt.it)())})),hintCardProps:ss(),tipCardProps:a,suggestionPillsUiProps:(0,ns.n)(t,!dt.CP.pythonContextManager.isPythonMode&&t.length>0,(()=>{r((0,lt.yG)())}),l,i),toggleUiProps:cs(u,m),chatContainerUiProps:{showFeedbackButtons:(0,rs.tV)(),useFluentAIGeneratedIndicator:(0,o.yw9)("OfficeVSO_9066056_useFluentAIGeneratedIndicator"),shouldSupportCitationsInAvalon:(0,o.aJZ)()},customMessageRenderers:cl,documentSensitivityProps:s,changeTopicUiProps:{hideChangeTopicButton:(0,o.T$f)()},clientInfoProps:{clientInfo:g,taskModuleLauncher:C.launchTaskModule,extensibilityDialogLauncher:y.launchExtensibilityDialog},singleModeProps:"off"===p.feature?{isInSingleMode:!1}:{isInSingleMode:!0,exitButtonProps:us(r,p)}};return T.chatInputV2Props=((e,t,a,r,i,l=!1)=>{const s=!dt.CP.pythonContextManager.isPythonMode,d=(0,o.vIj)()&&s,u=(0,o.lDp)()&&s,m=is(e);return{chatPlaceholderMessage:(0,o.de5)()?(0,c.bj$)():(0,o.XLK)()?void 0:m.message,chatRestShyPlaceholderMessage:m.restShyMessage,voiceInputProps:(0,o.CGU)()?{voiceInputLocale:(0,xe.Yd)(),microphonePermissionErrorMessage:xe.iJ.isWebPlatform()?(0,c.XWM)():(0,c.Sak)(),microphonePermissionErrorTitle:xe.iJ.isWebPlatform()?(0,c._C5)():(0,c.ReY)(),microphonePermissionImagePath:xe.iJ.isWebPlatform()?n(450501):void 0,showMicrophonePermissionHelpLink:xe.iJ.isWebPlatform(),handleInChatInput:!0}:void 0,menuProps:s?ts():void 0,editorConfig:(0,o.Dl1)()?ls(r,(0,o.H_b)()&&t):void 0,buttonProps:{groundingButtonEnabled:d,atMentionButtonEnabled:u},pluginsInfo:a(),shouldInitializeEditorInChatInput:d,characterLimitErrorMessage:(0,o.yw9)("OfficeVSO_8986671_UseLocalizedStringForCharacterLimitExceed")?(0,c.OKS)():void 0,imageInputEnabled:(0,o.ljm)()&&s,insertImageFlags:{isImageFromPhoneButtonEnabled:(0,o.O8_)(),isPasteFromClipboardButtonEnabled:(0,o.NBG)(),imageFromPhoneEndpoint:(0,o.Oo4)()},chatInputButtons:i,addMenuOptionsProps:{addButtonDirection:(0,o.DBC)()?"left":"right"},isDisabled:l,shouldRunMCPAgent:async()=>{if(0===(0,o.eHf)().length&&!(0,o.NbV)()||0===(0,o.CyP)().length)return;const e={"Non-Business":0,Public:1,General:2,Confidential:3,"Highly Confidential":4},t=await fe.n.getInstance().getInDocSensitiveLabelUsingOfcJs();if(!t.displayName)return!1;const n=t.displayName.split("\\");return 0!==n.length&&""!==n[0]&&n[0]in e&&e[n[0]]<e.Confidential},orbisProps:{getOfficeComJSClientProps:void 0,getOfficeJSClientProps:(0,o.NbV)()?es.z:void 0}}})(i,e,d,h,f,v),T.chatHistoryUiProps={enableChatHistoryV2:(0,o.K$3)(),isGptsEnabled:(0,o.Pz_)()},T.creditsUIProps={creditUpsellHandler:Wl.N,upsellFwdLinkId:(0,c.tMN)(),clientParam:(0,c.DPI)()},(0,o.aC$)()||(T.hideAgentSwitcherMenuPane=!0),T};function us(e,t){return{buttonText:t.caption,...t.exitMenuOptions&&t.exitMenuOptions?.length>0?{menuProps:t.exitMenuOptions,onClick:t=>{e((0,lt.eB)(t))}}:{onClick:()=>{e((0,lt.eB)(void 0))}}}}var ms=n(694592);var gs=n(215939),hs=n(264830);const ps=(0,p.A)(b.wrX,b.UhZ),bs=(0,p.A)(Yo.BKZ,Yo.XQT),fs=(0,p.A)(b.Qko,b.gu9),Cs=(0,p.A)(hs.XZm,hs.pnR),ys=(0,d.n)({actionButton:{backgroundColor:f.k1.colorBrandBackground,color:f.k1.colorNeutralForegroundOnBrand},root:{border:`1px solid ${f.k1.colorBrandBackground}`},tipCardIcon:{color:f.k1.colorBrandBackground}}),vs=(0,d.n)({root:{border:`1px solid ${f.k1.colorBrandBackground}`},tipCardIcon:{color:f.k1.colorBrandBackground}});const Ts=(e,t,n,a,r,i,d,g,h,p,b)=>{const[f,C]=I.useState(!1);if(I.useEffect((()=>{void 0!==b&&(b!==s.$.Enabled?(l.$.getInstance().clearLoadingPaneTimeout(),(0,E.oO)((new Date).getTime().toString()),C(!0)):f&&(l.$.getInstance().startLoadingPaneTimeout(!0),(0,E.Gr)((new Date).getTime().toString())))}),[b]),(0,o.R$m)()&&void 0!==b){if(b&s.$.DisabledThirdPartyHost)return{descriptionTextList:[(0,c.gk_)()],headerText:(0,c.DyN)(),icon:ps,isError:!0,overrideStyles:vs()};if((b&(s.$.DisabledNewWorkbook|s.$.DisabledAutoSaveOff|s.$.DisabledLocalFile))!==s.$.Enabled)return{descriptionTextList:[(0,c.USL)()],headerText:(0,c.tDq)(),buttonTitle:(0,c.mT9)(),onClick:()=>{w("EnableAutoSave")},icon:ps,isError:!0,overrideStyles:ys()};if((0,o.yw9)("OfficeVSO_9854459_UpdateErrorMessageForUnsupportedFileState")&&b&s.$.DisabledSharedLock)return{descriptionTextList:[I.createElement(u.E,{block:!0,key:"unsupported-file-state-message"},c.olU.FileStateUnsupportedMessage,I.createElement("div",{style:{marginTop:"16px"}},I.createElement(m.N,{href:c.Fxc,target:"_blank",style:{textDecoration:"underline"}},c.olU.FileStateUnsupportedLearnMoreLinkText)))],headerText:c.olU.FileStateUnsupportedTitle,icon:ps,isError:!0,overrideStyles:vs()};if((0,o.yw9)("OfficeVSO_9185107_DisabledDialogSheetError")&&b&s.$.DisabledDialogSheetExists)return{descriptionTextList:[(0,c.UEB)()],headerText:(0,c.v01)(),icon:ps,isError:!0,overrideStyles:vs()};if(!(0,o.yw9)("OfficeVSO_9854459_UpdateErrorMessageForUnsupportedFileState")&&b&s.$.DisabledSharedLock||b&s.$.DisabledAugLoopPermanentError)return{descriptionTextList:[(0,c.HTR)()],headerText:(0,c.Vx2)(),icon:ps,isError:!0,overrideStyles:vs()}}if(h){return{descriptionTextList:[Office.context.platform===Office.PlatformType.OfficeOnline?(0,c.PEH)():(0,c.HTR)()],headerText:(0,c.Vx2)(),icon:ps,isError:!0}}if((0,o.geU)()&&!i&&d&&g){const e=function(e,t,n,a){let o="",r=ps;if(t?(o=t.title,r=bs):a?(o=a.address,r=fs):n?(o=n.name,r=Cs):e&&!1!==e.tableIntersected&&(e.tableLikeRange?(o=e.address,r=Cs):o=e.name),o){const[e,t]=(0,c.DwD)().split("{0}");return{headerText:[e,o,t].join(""),icon:r,isError:!1,isWarning:!0}}}(t,n,a,r);if(e)return e}if(e||i||!d||!g)return g?d||p?i?{descriptionTextList:[(0,c.MED)()],headerText:(0,c.TSg)(),icon:ps,isError:!0}:{isError:!1}:{descriptionTextList:[(0,c.L0p)()],headerText:(0,c.QOn)(),icon:ps,isError:!0}:{descriptionTextList:[(0,c.USL)()],headerText:(0,c.tDq)(),icon:ps,isError:!0}};var xs=n(429257);const Ss=({theme:e=g.Gm.defaultWhite,isHighContrast:t=!1,accountInfo:n,initTelemetryHandler:i})=>{const[s]=(0,gs.usePreloadCopilot)(),[d]=(0,gs.useHasPreloadedCopilotBeenShown)(),[u,m]=(0,gs.useUnifiedPromptPrivateApiMessage)(),p=(0,ge.j)(),b=(0,xa.Pj)(),[C,y]=(0,I.useState)({citationTitle:"",isFluxFlowEnabled:!0,isCitationsEnabled:(0,o.vIj)()}),T=(0,I.useMemo)((()=>(0,as.gl)()),[]);(0,W.f)((async()=>{const e=document.getElementsByClassName(c.fw9);e?.length&&e[0].focus(),l.$.getInstance().setInputFocus(),l.$.getInstance().scrollToBottom()})),I.useEffect((()=>{i&&i(nt.B.getInstance())}),[i]);const S=(0,o.K5)()&&void 0!==s&&(0,o.wQA)();(0,W.U)((async()=>{S&&!d&&l.$.getInstance().activateAugloopAnnotations()}));const[w,E]=I.useState(!1),[R,A]=I.useState(!1),[L,k]=(0,I.useState)((0,o._bw)()?fe.n.getInstance(void 0,void 0,l.$.getInstance().getCopilotRef(),void 0,jt.Y6).getSensitivity():void 0),F=(0,o.geU)();let _=(0,xa.d4)((e=>e.chat.suggestionList));const P=(0,xa.d4)((e=>e.chat.zqmSuggestionList)),N=(0,xa.d4)((e=>e.chat.loadingStrings)),M=(0,xa.d4)((e=>e.selection.selectionError)),O=(0,xa.d4)((e=>e.chat.executingCommand)),D=(0,xa.d4)((e=>e.chat.isPythonMode)),B=(0,xa.d4)((e=>e.chat.isPythonThinkDeeperMode)),$=(0,xa.d4)(Nt.OA),H=(0,xa.d4)((e=>e.selection.activeTable),((e,t)=>{let n=!0;return F&&(n=e?.tableIntersected===t?.tableIntersected),e?.name===t?.name&&e?.tableLikeRangeFeatures===t?.tableLikeRangeFeatures&&n})),U=(0,xa.d4)((e=>F?e.selection.activeChart:void 0)),q=(0,xa.d4)((e=>F?e.selection.activePivotTable:void 0)),V=(0,xa.d4)((e=>F?e.selection.activeRange:void 0)),we=(0,xa.d4)((e=>e.selection.isWorksheetProtected)),Ee=(0,xa.d4)((e=>e.selection.isPermanentError)),Ie=(0,xa.d4)((e=>e.selection.isWorkbookAutoSaveOn)),Re=(0,xa.d4)((e=>e.selection.isWorksheet)),Ae=(0,xa.d4)((e=>e.chat.dataShapingState.started)),Le=(0,xa.d4)((e=>e.app.userType)),ke=(0,xa.d4)((e=>e.chat.singleModeState)),[Fe,_e]=I.useState({objectId:"",tenantId:""}),Pe=I.useRef(null);(0,I.useEffect)((()=>{l.$.getInstance().setCopilotRef(Pe)}),[Pe]);const[Ne,Me]=(0,I.useState)(void 0);(0,I.useEffect)((()=>{ve.Y.getInstance().setBizChatHandoffPropertiesHandler(Me)}),[Me]);const Oe=(0,o._SP)(),[De,Be]=(0,I.useState)(!1),$e=I.useCallback((()=>{const e=[];return(0,o.oJj)()&&!(0,o.ULj)()&&e.push({id:he.$.Work,onToggle:e=>{(0,a.cY)("ExcelCopilotChat: Microsoft M365 toggle is "+(e?"enabled":"turned off")),(0,Kl.LA)(e),E(e)},state:w?he.p.Enabled:he.p.Disabled}),e.push({id:he.$.Web,onToggle:e=>{(0,a.cY)("ExcelCopilotChat: Web Content toggle is "+(e?"enabled":"turned off")),(0,Kl.u$)(e),A(e)},state:R?he.p.Enabled:he.p.Disabled}),e}),[w,R]);(0,I.useEffect)((()=>{(0,o.vIj)()&&((0,a.cY)("ExcelCopilotChat: Reinitializing AL session due to user type change to "+Le),(0,o._bw)()&&Ue())}),[Le]),(0,I.useEffect)((()=>{const e=O===v.OP.ActionAI||O===v.OP.AnalyzeData||O===v.OP.CalculatedColumns||O===v.OP.CalculatedCells||O===v.OP.ElseSkillExecuting||O===v.OP.FluxReasoning||O===v.OP.FluxGenerateResponse||O===v.OP.Search||O===v.OP.Python||O===v.OP.ImportDataGenerateSuggestion||O===v.OP.ImportDataRelevancyCheck||O===v.OP.PythonStartAnalysis;l.$.getInstance().updateLoadingComponentProps({loadingUiStringList:N,showStopGeneratingButton:e&&!(0,zi.dD)(),showInlineStopGeneratingButton:e&&(0,zi.dD)()})}),[O,N]),(0,wr.H5)((()=>{p(Et.m.setShouldShowFormulaDevButton({shouldShowFormulaDevButton:(0,o.yw9)("OfficeVSO_9205837_formulasDevButton")&&((0,G.I_)()||(0,o.iPS)("Microsoft.Office.Excel.FA000000124.EnableTestUi",!1))}))}));const He=async()=>{const e=await async function(){try{return await Excel.run((async e=>{const t=(0,ql.dI)(e);return await e.sync(),t()}))}catch(e){const t=x.M.getInstance();return t.logErrorCode(on.O.LocaleFetchFailed,e),void((e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.inactiveWorkbook||e instanceof on.u)&&t.logErrorCode(on.O.InactiveWorkbook,e))}}();e&&p(it.m.setLocaleInfo({localeInfo:e}))};async function Ue(){fe.n.getInstance().getInDocSensitiveLabelInfo(),fe.n.getInstance().setLabelChangeEventListener(Ve),We()}async function Ve(e,t){(0,a.cY)(`ExcelCopilotChat: Sensitivity Label Change Event: ${JSON.stringify(e)} to ${JSON.stringify(t)}`),(0,o.vIj)()?await fe.n.getInstance().setSensitivityLabelToHighestSensitivity([fe.n.getInstance().getInDocSensitiveLabelInfo(),t]):(fe.n.getInstance().setInDocSensitivityLabelInfo(t),We())}function We(){(0,a.cY)("ExcelCopilotChat: Setting sensitivity in basic chat props");const e=(0,Ma.yu)();y((t=>({...t,sensitivityIndicatorData:(0,Ma.Q9)(e)}))),k(fe.n.getInstance().getSensitivity())}(0,I.useEffect)((()=>{(0,jt.sZ)();let e=!1;(0,o._bw)()&&(L&&""!==L.id||(async()=>{await fe.n.getInstance().setInDocSensitiveLabelInfoUsingOfcJs(),k(fe.n.getInstance().getSensitivity())})()),(async()=>{if((0,o.TyP)()&&(0,Q.g)((e=>{p(it.m.setUserType(e))})),x.M.userQueryOrder=0,nt.B.getInstance().logSeenEvent(v.q.CopilotChat),(0,o.Qyj)()||(0,Zt.mN)(),await(async()=>{await Excel.run({delayForCellEdit:!0},(async e=>{e.application.onUndoChanged.add((async e=>{z.xP.checkAndSetIsUndoableActionPresent(),"UndoGroupAdded"===e.changeType&&dt.CP.isContextLocked()||(await p((0,lt.q9)())!==v.OP.FluxGenerateResponse?(0,Se.s_)(Se.H0.DisableUndo):ye.Z.getInstance().setDisableUndoButton(!0))}))}))})(),!e&&!(e||(0,o.LrR)()&&(await He(),e))){if((0,o._bw)()&&Ue(),!(0,o.yw9)("OfficeVSO_9113126_copilotchatrefnulltimeoutfix")&&(0,as.C6)()){const{message:e,telemetry:t}=Ct.n.getLanguageUnavailableResponse();l.$.getInstance().displayResponse(e,t)}}})(),async function(){const e=await(0,jt.m4)();wt.current=e,(0,a.cY)("SDX ClientInfo : ",e),p(it.m.setClientInfo(e))}()}),[]),(0,I.useEffect)((()=>{p(rt.m.initializeSuggestionList())}),[]),(0,I.useEffect)((()=>{(0,Kl.LA)(w),(0,o.vIj)()||(p(rt.m.clearSuggestionList()),x.M.getInstance()?.logEvent((0,v.SV)(w?v.he.GroundPickerSelected_EnterpriseMode:v.he.GroundPickerSelected_DocMode,v.q.CopilotChat)),w||p((0,lt.Nl)()))}),[w]),(0,I.useEffect)((()=>{p((0,lt.it)())}),[]);const Ge=I.useCallback((()=>{Be(!0),setTimeout((()=>{Be(!1)}),2e3)}),[]),ze={enableClientSelectionContext:(0,o.OUH)()||(0,o.KV_)(),enableFetchImplicitQueryAnnotations:(0,o.KV_)()||(0,o.LUs)(),enableImplicitCIQForLocalFiles:(0,o.KV_)(),isChatHistorySignalDeferred:(0,o.KV_)(),enableImplicitCIQForCloudFiles:(0,o.uPG)()&&!(0,o.KV_)(),isBundledPackageEnabled:!0,isZQMEarlyLoadAndSessionStorageForChatHistoryEnabled:(0,o.qJy)(),enableProactiveZQMWith3SAPISuggestions:(0,o.Cpg)(),enableProactiveZQMWithSuggestedQnA:(0,o.wOV)(),isCreditsUIEnabled:!0,isAttachmentListEnabled:(0,o.N6k)(),isCloudFileUploadEnabled:(0,o.Shf)(),isLocalFileUploadEnabled:!1,isAppChatRebrandingEnabled:(0,o.de5)(),enablePluginSearchInFlyout:(0,o.fnY)()&&(0,Kl.pX)(),enableMorePluginHyperLinkInFlyout:(0,o.mdc)()&&(0,Kl.pX)(),defaultEnableEnterpriseGrounding:(0,o.HSC)(),defaultEnableWebGrounding:(0,o.gr8)(),enableQueryEndOnGptSwitch:(0,o.FFf)(),showNewChatOnGPTItem:(0,o.CUx)(),enableNewChatOnlyOnCopilot:(0,o.Lzg)(),isCustomGPTsEnabled:(0,o.Pz_)(),isSavePromptEnabled:(0,o.pBW)(),isSharePromptEnabled:(0,o.H45)(),isSccReadAloudAugloopEnabled:(0,o.vzv)(),isSccReadAloudEnabled:(0,o.gPg)(),isViewMorePromptsIconV2Enabled:(0,o.s2L)(),isViewMorePromptsOneClickEnabled:(0,o.zd8)(),promptInputLength:(0,o.Z8j)("Microsoft.Office.Excel.FA000000124.AugLoop.PromptInputLength",J.Rk),isAppChatGlowUXEnabled:(0,o.L4b)(),isNewAttachmentListUiEnabled:(0,o.F3m)(),isSimplifiedChatInputEnabled:(0,o.XLK)(),isAddMenuUxRefreshEnabled:(0,o.XLK)(),isSimplifiedChatInputFlairEnabled:(0,o.XLK)(),isHideSendButtonEnabled:(0,o.XLK)(),showWelcomeExperience:(0,o.MHS)(),disableALAnnotationsOnPreload:S,isApiPluginsCardsEnabled:(0,o.l6e)(),isInterstitialConfirmationEnabled:(0,o.dw_)(),isInterstitialAuthEnabled:(0,o.I3H)(),isDAOutputV2Enabled:(0,o.MNq)(),isDABrandingEnabled:(0,o.CLb)(),isOutputV2Enabled:!0,isFluentV9TaskPaneEnabled:(0,o.dl3)(),isAddScrollingFreezeEnabled:(0,o.LhK)(),isHandoffButtonEnabled:(0,o.oaD)(),isHandoffRTLEnabled:(0,o.gQ_)(),openInWordMinimumForHeuristic:(0,o.rY0)(),isHandoffBookendingEnabled:(0,o.Skv)(),isHandoffGetAnnotationsEnabled:(0,o.KWs)(),isHandoffInteractiveSummaryAndContentCallbackEnabled:(0,o.dOo)(),clearLoadingMessagesOnHandleSubmit:(0,o.UiV)(),shouldUseHybridAppService:(0,o.Pz_)(),shouldUseMsalSsoSilentLogin:(0,o.Pz_)(),shouldUseMsalLocalSilentFlag:(0,o.Pz_)(),showAgentMenuNudgeAndTooltip:(0,o.B0c)(),showAgentMenuExploreBadge:(0,o.Q11)(),showPluginsAsAgents:(0,o.Pz_)(),shouldRenderAllHyperLinks:(0,o.Pz_)(),enableCustomWidthPropOnAC:(0,o.Pz_)(),disableACHorizontalScroll:(0,o.Pz_)(),isALRequestResponseEnabled:(0,o.NT7)(),useExternalAuthService:(0,o.Pz_)(),areAddinLocalPluginActionsEnabled:(0,o.UxI)(),isTextDirectionEnabled:(0,o.cz7)(),enableSystemMessageActions:(0,o.LNg)(),enableSwitcherMenuV2:(0,o.o25)(),enableSydneyEndpointOverride:!1,enableAgentsBasedOnSkill:(0,o.VDk)(),isSccFeedbackPluginEnabled:!0,invokeTenantFeedbackServiceFromFeedbackSDK:!0,useSharedFeedbackDataUpdate:!0,isCodePreviewEnabled:(0,o.jxV)(),isEnabledLocalCUAAgent:(0,o.PrP)(),renderChatHistoryInHandoffDestination:(0,o.yqt)(),isHandoffLoadingPageEnabled:(0,o.HHv)(),enableAppAgentsInCiqOverride:(0,o.pv3)(),isDABrandingRefactorEnabled:(0,o.Om4)(),showPromptSuggestionsWithOutput:(0,o.Slc)(),isAcquirePluginsFromMosEnabled:(0,o.dA9)(),isCiqEnabledInDAs:(0,o.osS)(),isClickButtonStyleHamburgerEnabled:(0,o.cts)(),isMultipleConfirmationDialogFlowEnabled:(0,o.dw_)(),enableOpenUrlDialogAction:(0,o.Pz_)(),isALHookEnabled:(0,o.UTV)(),enableStopGeneratingButtonInChatInput:(0,o.$bq)(),useResponsiveSystemMessage:(0,o.Wo)(),isResponseDoubleBrandingHidden:(0,o.Wuj)(),applyDynamicHostWidthToAC:(0,o.Pz_)(),enableImBackActions:(0,o.Pz_)(),isAgentsLoggingEnabledInShared:(0,o.Fz9)(),mosAgentInstallTimeout:(0,o.tCt)(),newChatInHeaderControl:!0,isLatencyArrowEnabled:(0,o.Pol)(),enableBizChat:(0,o.vPK)(),enableBizChatInAppChat:(0,o.TS5)(),enableBizChatAgentsInAppChat:(0,o.jjh)(),enableBizChatOtelLogger:(0,o.ddP)(),enableBizChatIdsInOtelLog:(0,o.uEU)(),enableBizChatPerfOtelLog:(0,o.Ak0)(),enableCloseChatPaneButton:xe.iJ.isWebPlatform()||xe.iJ.isWin32Platform(),m365ChatCdnVersion:(0,o.Jqb)(),m365ChatDeploymentRing:(0,o.b13)(),m365ChatDeploymentEnvironment:(0,o.UjX)(),enableM365EcsProvidedProps:(0,o.lJI)(),useAppVersionECSProject:(0,o.C6)(),isSafeLinksEnabled:(0,o.SBS)(),enableBizChatInAppAuthDialog:(0,o.$Cf)(),enableM365ChatLogger:(0,o.tO4)(),enableBizchatInAppPerfMonitor:(0,o.KOx)(),enableCatalystConsumerToPacman:(0,o.eUQ)(),enableM365ChatAuthTreatFallbackAsFatalError:(0,o.PiX)(),enableM365ChatAuthHandleNonInteractiveFatalErrors:(0,o.f7I)(),enableM365ChatFatalErrorCallback:(0,o.QI_)(),enableBizchatNestedAppAuthSupport:(0,o.AJD)(),isEligibilityCheckEnabled:(0,o.i3k)(),isEligibilityCacheEnabled:(0,o.Kuk)(),enableBizChatFeedbackCompliancePolicyFetching:(0,o.$ii)(),enableBizChatDefaultFeedbackAppId:(0,o.DnQ)(),enableOcpsPolicyFetching:(0,o.O74)(),enableBizChatInAppSettings:(0,o.IfU)(),enableLocalFileMessageBanner:!xe.iJ.isWebPlatform()&&(0,o._k_)(),enableFileAccessMessageBanner:(0,o.DI8)(),enableIsEuCheck:(0,o.U4g)(),hrdServiceProviderId:(0,o.AmF)(),enableBizChatInAppAuthDialogV2:(0,o.ThR)(),waitForEcsSettingsTimeout:(0,o.l9B)(),enableWaitForEcsSettings:(0,o.sx$)(),enableKeepAliveForALSessionV2:(0,o.e7E)(),keepAliveForALSessionIntervalInSecond:(0,o.zf$)(),enableSPOFileIdForCloudFiles:(0,o.Oc9)(),enableOcpsLogging:(0,o.eh5)(),isEligibilityTelemetryEnabled:(0,o.mXJ)(),forceDfSydney:(0,o.vcx)(),isInsertImageEnabledForDesigner:(0,o.eOl)(),enableBizChatAuthTelemetry:(0,o.cMx)(),enableBizChatInfiniteAuthShimmerFix:(0,o.zn0)(),enableProvideDynamicScreenshot:(0,o.At2)(),enablePuidCompliantCheck:(0,o.IQJ)(),enableWaitForEcsOnExpiredCache:(0,o.cpQ)(),isRingSwitcherEnabled:(0,o.FYS)(),enableBizChatInactiveLog:(0,o.KxH)(),enableM365ChatRehydration:(0,o._Ij)(),enableMsaInCatalyst:(0,o.rFv)(),enableM365ChatAuthWaitForRaf:(0,o.Sdn)(),enableM365ChatUseBackupResourceScopes:(0,o.LaH)(),enableBizChatPairwiseBrokerSupport:(0,o.XPY)(),bizchatPairwiseBrokerHandshakeTimeout:(0,o.n7$)(),bizchatPairwiseBrokerConnectionTimeout:(0,o.OSh)(),enableM365ChatTokenPrefetch:(0,o.fFf)(),enableM365ChatWaitForBroker:(0,o.SAS)(),enableBizchatEcsSettingsTelemetry:(0,o.OWE)(),enableIsDevLog:(0,o.Ton)(),enableOcpsTokenProviderLogFix:(0,o.iYf)(),enableM365ChatHandleAuthBackgroundVisibility:(0,o.dru)(),enableM365ChatHandleBackgroundVisibilityForRequests:(0,o.YAc)(),enableUsePlumbedHostAccountInfo:(0,o.jI5)(),enablePerfMarks:(0,o.qcw)(),eligibilityCacheDurationMs:(0,o.wOI)(),fallbackToastEnabled:(0,o.jEg)(),bizChatFallbackToastDisabled:(0,o.Xfp)(),enableAgentSwitchInCatalyst:(0,o.TGR)(),enableUseM365ChatDevMode:(0,o.etf)(),disableHostCommunicationNovaEventsHandling:(0,o.uPA)(),commandingFlags:{chatLogLevel:(0,o.Wp2)(),openAIApiKey:(0,o.sK$)(),anthropicApiKey:r.getInstance().getAnthropicKey(),awsAnthropicAuth:r.getInstance().getAwsAnthropicKeys(),anthropicClaudeModel:(0,o.cjy)(),localMCPServerURL:(0,o.eHf)(),enableOfficeJSTool:(0,o.NbV)()}},Qe=I.useCallback(((e,t)=>{const n=t?.checked;(0,a.cY)("Toggling Reviewer Agent to "+(n?"on":"off"))}),[Ge]),je=e=>{const t=e.actionType;t===g.At.ActivateCopilotAgent||t===g.At.Activated?((0,a.cY)("handleActivateCopilotAgentFromHost in client ",e.titleId),ht({appId:e.titleId})):t!==g.At.RemoveCopilotAgent&&t!==g.At.Removed||((0,a.cY)("handleRemoveCopilotAgentFromHost in client ",e.titleId),bt({appId:e.titleId}))},Je=wn.getInstance(p),Ye=(0,I.useMemo)((()=>(Ce.p.init(b,Je,je),Ce.p.getInstance())),[]),[Xe,Ze]=I.useState(!1);Ye.setCopilotChatLoadedSetter(Ze);const Ke=I.useMemo((()=>{const e=Y.D.getInstance();return Pe.current&&e.setProxyOperator(Pe.current?.executePluginOperation),e}),[Pe.current]),et=I.useMemo((()=>X.g.getInstance()),[]);Ye.setSuggestionList(_),Ye.setZeroQueryMessageTitles((0,os.dW)()),Ye.setZqmSuggestionList(P);const tt=(0,o.yw9)("OfficeVSO_8427023_HandleTabKey")?e=>{"Tab"===e.key&&e.stopPropagation()}:void 0,at=jl(),[st,ct]=I.useState((()=>{const e=[];return(0,o.aC$)()||e.push({id:c.erl.CopilotChat,name:c.rBP[c.erl.CopilotChat],isSelected:!0,isDefaultCopilot:!0,menuIcon:I.createElement(Z.e,null)}),e.push(...function(e,t){const n=[];return Ul()&&(n.push({id:c.erl.DirectSkill,name:c.rBP[c.erl.DirectSkill],isSelected:!1,isDefaultCopilot:!1,copilotType:(0,o.aC$)()?Zn.NV.ClientProvided:void 0,copilotComponent:I.createElement(Na,{setCannedOption:t=>e.cannedOption=t,getCannedOption:()=>e.cannedOption}),menuIcon:I.createElement(Fn.SFT,null)}),n.push({id:c.erl.DevTools,name:c.rBP[c.erl.DevTools],isSelected:!1,copilotType:(0,o.aC$)()?Zn.NV.ClientProvided:void 0,isDefaultCopilot:!1,copilotComponent:I.createElement(ka,{setShouldShowFormulaDevButton:e=>t(Et.m.setShouldShowFormulaDevButton({shouldShowFormulaDevButton:e}))}),menuIcon:I.createElement(Fn.SFT,null)}),(0,o.yw9)("OfficeVSO_9503894_AugloopDiagnosticsPane")&&(n.push({id:c.erl.AugloopDiagnostics,name:c.rBP[c.erl.AugloopDiagnostics],isSelected:!1,copilotType:(0,o.aC$)()?Zn.NV.ClientProvided:void 0,isDefaultCopilot:!1,copilotComponent:I.createElement(Un,null),menuIcon:I.createElement(Fn.HpN,null)}),n.push({id:c.erl.AugloopModelVisualizer,name:c.rBP[c.erl.AugloopModelVisualizer],isSelected:!1,copilotType:(0,o.aC$)()?Zn.NV.ClientProvided:void 0,isDefaultCopilot:!1,copilotComponent:I.createElement(Jn,null),menuIcon:I.createElement(Fn.HpN,null)}))),n}(Ye,p)),e})),[ut,mt]=I.useState(c.erl.CopilotChat),[gt,ht]=I.useState(void 0),[pt,bt]=I.useState(void 0);I.useEffect((()=>{(0,o.dA9)()&&(0,K.GZ)(je,(0,o.LKL)())}),[]);const ft=e=>{if((0,a.cY)("handleCopilotChatChange in client",e),e===h.mosCopilotExtensionMenuItemID)return void(0,K.iB)((0,o.dA9)(),!1,J.Xt.SwitcherMenu);const t=st.map((t=>({...t,isSelected:t.id===e})));ct(t),mt(e),(0,ee.P7)((0,K.TR)(void 0,e,h.defaultCopilotChatMenuItemId))};I.useEffect((()=>{ft(ut)}),[ut]);const[yt,vt]=I.useState((()=>{if((0,o.UW0)())return(0,te.dL)()}));I.useEffect((()=>{(0,o.UW0)()&&(yt&&Ye.setBizChatHostContext(yt),Ye.setBizChatHostContextSetter(vt))}),[yt,vt,Ye]),I.useEffect((()=>{if(!(0,o.UW0)())return;(0,o.jWB)()||Office.addin.onVisibilityModeChanged((({visibilityMode:e})=>{if(e!==c.DwS)return;const t=(0,te.dL)(),n=!(0,o.rpM)()||t;(0,a.cY)("BizchatHostContext re-initialized: ",t),n&&vt(t)}));const e=e=>{(0,a.cY)("BizchatHostContext updated:",e);const t=(0,te.op)(e.eventData);(0,a.cY)("BizchatHostContext eventData:",t),vt(t)};Te.V.IsSettingTrue(Te.z.ExcelSdxPrivateApiEnabled)&&(void 0===s||s&&(d||!(0,o.K5)()))&&(Ye.attachPrivateApiHandlers(),u&&Xe&&(m(void 0),Ye.unifiedPromptHandler(u))),(0,o.jWB)()||xs.s.getInstance().attachPrivateEventHandler(g.Th.BizchatHostContextUpdate,e)}),[s,d,u,Xe]),I.useEffect((()=>{(0,o.UW0)()&&(nt.B.getInstance().sendChatEventTelemetry([{key:pe.h3.ChatEventType,value:v.a5.BizchatHostContext},{key:pe.h3.ChatEventParameters,value:{doesUpnExist:!!yt?.PrimaryUserAccountInfo?.Upn,aggregatedLicensedFeatures:yt?.PrimaryUserAccountInfo?.AggregatedLicensedFeatures,licensedFeatures:yt?.PrimaryUserAccountInfo?.LicensedFeatures,copilotExperience:yt?.PrimaryUserAccountInfo?.CopilotExperience}}]),(0,te.pH)(yt))}),[yt]),I.useEffect((()=>{Ye.handleHandoffMessageHostAppSettingsIfNeeded()}),[]);const Tt={closeButton:(0,ms.JA)(),headerMenuButtonProps:(0,ms.qP)(),showCreditButton:!0,enableChatHistory:(0,o.XXz)(),enableSettingsPanel:(0,o.s9k)()},{excelAgentFilterConstants:xt}={excelAgentFilterConstants:I.useMemo((()=>({supportedCapabilities:[{value:"GraphicArt",disabled:!0},{value:"CodeInterpreter",disabled:!(0,o.LSW)()}],supportedAgentType:[{value:"AgentWithBizChatProfile",disabled:!(0,o.hrE)()},{value:"FluxV3",disabled:!(0,o.Wmj)()}]})),[])},St={showCopilotSwitcherMenu:!0,copilotList:st,handleCopilotChatChange:ft,showNewChatButtonOnTop:!1,enableMorePlugins:!0,paneSilhouetteHeaderProps:(0,o.aC$)()?Tt:void 0,agentFilterConfig:xt,copilotSwitcherRequest:{copilotSwitcherOpenRequest:gt,setCopilotSwitcherOpenRequest:ht,copilotSwitcherRemoveRequest:pt,setCopilotSwitcherRemoveRequest:bt}};const wt=I.useRef((0,h.getDefaultClientInfo)()),{onAttachCloudFiles:It}=(0,ne.l)({clientInfoRef:wt,theme:e,locale:T,clientId:ae.ky,redirectUri:(0,Vl.x3)(),isWebPlatform:xe.iJ.isWebPlatform()}),Rt=I.useMemo((()=>{const{userPrincipalName:e}=wt.current;return new oe.j({userPrincipalName:e,redirectUri:(0,Vl.x3)()})}),[wt.current]),At=I.useMemo((()=>({mosTokenProvider:async()=>Rt.getToken(ae.Ss).then((e=>e?.accessToken))})),[Rt]),Lt=I.useCallback((async()=>{const e=(0,o.BCo)();return await(0,re.R)(Rt,e)}),[Rt]),kt=(0,o.gnD)()&&D,Ft={text:(0,c.GRh)(),tooltipText:(0,c.dI9)(),handleClick:()=>{dt.CP.pythonContextManager.setIsPythonThinkDeeperMode(!B)},isDisabled:!!O,isToggleOn:B},_t={...Ft,isIconOnly:!0},Pt=(0,o.XLK)()?{button:I.createElement(qe,_t),multilineButton:I.createElement(qe,Ft),buttonType:be.N.InputArea}:{button:I.createElement(qe,Ft)},Mt=[...kt?[Pt]:[]];(0,o.IdM)()&&(_=Pe.current?.getLastMessage()?_:[]);const Ot=ds(w,_,Ts((0,Kl.pX)()?void 0:M,H,U,q,V,we,Re,Ie,Ee,Ae,$),p,H,M,L,$e,Qe,!1,wt.current,It,ke,P,Mt,Ke,et,we),Dt=Oe||(0,o.aC$)()||(0,o.yw9)("OfficeVSO_9469778_ShowDebugOptionsIfReviewAgentDisabled")&&Ul()?St:void 0,Bt=I.useCallback((async e=>{const t=Rt;return await(0,ie.v)(t,e)}),[Rt]),$t=I.useCallback((async e=>await(0,le.W)(Rt,e)),[Rt]),Ht=I.useCallback((async e=>await(0,se.u)(Rt,e)),[Rt]),Ut=I.useCallback((async e=>{const t=(0,ce.Q)(e??ae.w8.sharepoint),n=Rt;return await(0,de.O)(n,t)}),[Rt]),qt=I.useCallback((()=>(0,o.Shf)()?{graphTokenProvider:Bt,sharepointTokenProvider:Ut}:{}),[Bt,Ut]),[Vt,Wt]=(0,I.useState)(qt()),[Gt,zt]=(0,I.useState)(ze);I.useEffect((()=>{Qt()}),[$t]);const Qt=async()=>{(0,o.A9c)()&&""!==wt.current.userPrincipalName&&(Wt((e=>({...e,lokiTokenProvider:$t}))),zt({...Gt,isLocalFileUploadEnabled:!0}))};I.useEffect((()=>{(0,o.LSW)()&&Wt((e=>({...e,ic3TokenProvider:Ht})))}),[Ht]),(0,I.useEffect)((()=>{const e=qt();Wt((t=>({...t,...e})))}),[qt]),I.useEffect((()=>{(0,o.SBS)()&&Wt((e=>({...e,safeLinksTokenProvider:Lt})))}),[Lt]);const Jt=(0,o.$Cf)()&&(0,te.gt)();(0,I.useEffect)((()=>{Jt&&async function(){try{Office.context.auth.getAuthContextAsync((function(e){const t=e.value;if(t){const e=t.userObjectId||Fe.objectId,n=t.tenantId||Fe.tenantId,a=t.authorityType||Fe.authorityType;_e({objectId:e,tenantId:n,authorityType:a})}else(0,a.cY)("Authcontext is undefined"),x.M.getInstance().logError({eventType:ot.S2.Error,errorMessage:"getAuthContextAsync returned undefined",logLevel:j.$b.Warning})}))}catch(e){(0,a.cY)(`Error calling getAuthContextAsync: ${e}`),x.M.getInstance().logError({eventType:ot.S2.Error,errorMessage:"Error calling getAuthContextAsync",logLevel:j.$b.Warning})}}()}),[]);const Yt=I.useMemo((()=>{if(Jt){if(!(0,o.jI5)()){const e=Jt&&Fe.objectId?{objectId:Fe.objectId,tenantId:Fe.tenantId,accountType:Fe.authorityType?.toUpperCase()??""}:void 0;return!e?.accountType&&e?.objectId&&(0,a.cY)("Failed to fetch authorityType from OfficeJS"),e}return n}}),[(0,o.jI5)()?void 0:n]),Xt=I.useMemo((()=>(0,o.rFv)()||"AAD"===n.accountType||void 0===yt?yt:{...yt,PrimaryUserAccountInfo:yt.PrimaryUserAccountInfo?{...yt.PrimaryUserAccountInfo,CopilotExperience:"AppChat"}:void 0}),[yt]),Kt=(0,ue.W)("FA000000124"),en={copilotCommunicationHandler:Ye,style:zl(),platformType:(0,zi.mw)(),theme:(0,f.eS)(e,t),useALRuntime:!1,ref:Pe,chatUiProps:Ot,basicChatProps:C,copilotTelemetryHandler:nt.B.getInstance(),copilotPluginProps:Dt,copilotFeatureFlags:Gt,hostAppAuthTokens:Vt,wasChatPaneAutoOpened:Te.V.IsSettingTrue(Te.z.AutoOpenChatPane),themeV2:(0,me.Id)(f.v1,e,t,(0,as.xt)()?"rtl":"ltr",(0,o._7P)()?c.GHt:void 0),hostTokenProviders:At,hostAccountInfo:Yt,customM365ChatProps:{...(0,o.yjA)()&&{scenarioName:c.M8Q,sourceName:c.tFi},allowSydneyConfigOverrideInUrl:!1,...void 0!==Kt&&{serviceEndpointUrl:Kt}},getTenantId:jt.EO,bizChatHostContext:Xt,handoffProperties:Ne,getDocSensitivityLabel:(0,o.DI8)()?fe.n.getInstance().getInDocSensitiveLabelUsingOfcJs:void 0};return Oe?I.createElement("div",{onKeyDown:tt},I.createElement(h.StackV9,null,De?I.createElement("div",null,"Loading Chat..."):I.createElement(h.LocalizedCopilotChatCore,{...en,locale:T}),(0,o.w9F)()?I.createElement("div",{className:at.root},I.createElement(ga.T,{resize:"both",onChange:(e,t)=>{dt.CP.setPythonAdaStaticPromptOverride(t.value)}})):null),I.createElement(Hl,{communicationHandler:Ye,setCannedOption:e=>Ye.cannedOption=e})):I.createElement("div",{onKeyDown:tt},I.createElement(h.StackV9,null,I.createElement(h.LocalizedCopilotChatCore,{...en,locale:T}),(0,o.w9F)()?I.createElement("div",{className:at.root},I.createElement(ga.T,{resize:"both",onChange:(e,t)=>{dt.CP.setPythonAdaStaticPromptOverride(t.value)}})):null),I.createElement(Hl,{communicationHandler:Ye,setCannedOption:e=>Ye.cannedOption=e}))};var ws=n(215751),Es=n(704725),Is=n(195800),Rs=n(575136),As=n(64368),Ls=n(660606),ks=n(911443),Fs=n(261237);let _s;async function Ps(e,t,n,r,i,l){try{if((0,o.yw9)("OfficeVSO_9410553_copilotInfiniteLoadOnCellEdit")&&await Excel.run({delayForCellEdit:!1},(async e=>{e.workbook.load("name"),await e.sync()})),(0,o.yw9)("OfficeVSO_8455363_MoveInitializationCodeToInitializeTasks")){if((0,Rs.v)(),Office.context.platform===Office.PlatformType.PC?(r(Office.context.officeTheme.bodyBackgroundColor,!0),t().catch((e=>{(0,jt.cY)("Register Theme Callback() error: "+e),x.M.getInstance().logError({eventType:ot.S2.Error,errorMessage:e,logLevel:j.$b.Error})}))):(0,zi.OK)()&&Office.context?.themeManager?.getOfficeThemeAsync((e=>{if("succeeded"===e.status){const n=e.value;r(n.bodyBackgroundColor,!0),t()}})),(0,o.yw9)("OfficeVSO_8565845_GateForConsumer")){const e=await OfficeFirstPartyAuth.getPrimaryIdentityInfo(),t=e.identityType===OfficeCore.IdentityType.organizationAccount?g.ut.Enterprise:e.identityType===OfficeCore.IdentityType.microsoftAccount?g.ut.Consumer:g.ut.Unknown;l(it.m.setUserType(t)),(0,o.Awf)(t)}window.matchMedia("(forced-colors: active)").matches&&n(!0)}if((0,Ls.YP)(c.fn_,jt.cY,nt.B.getInstance(),{IsClpEnabledInEnterpriseForSydney:()=>(0,o._bw)(),IsApplyLabelUsingTryUpgradeLabelEnabled:()=>(0,o._bw)(),IsUserTypeEnterprise:()=>(0,o.Dl1)(),getOfficeJSDocumentURL:()=>(0,xe.H5)(),shouldCLPExceptionDisableEnterpriseSearch:()=>(0,o.vIj)(),setEnableEnterpriseSearchOverride:Kl.LA}),!Fs.copilotStringsLoaded){const e=(new Date).getTime();await(0,as.XX)(),_s=((new Date).getTime()-e)/1e3,T.E.getInstance().logLatency(_s,v.OP.LoadLocalizedStrings)}(0,me.Bp)((0,o.kh6)().toString()),Te.V.IsSettingTrue(Te.z.ExcelSdxPrivateApiEnabled)&&xs.s.getInstance().initializePrivateApi(),Te.V.IsSettingTrue(Te.z.ButtonEnabledForLocalFiles)&&async function(e){if((0,o.yw9)("OfficeVSO_9410553_copilotInfiniteLoadOnCellEdit"))try{await S(!1,e)}catch(t){(0,a.cY)("initializePrivateHostMessaging failed due to invalid operation in cell edit mode. Retrying with delay."),x.M.getInstance().logStandardizedAshaErrorEvent(y.W.Copilot_Chat_Pane_Failed_To_Load,C.c.Pane_Taking_Too_Long_To_Load_Due_To_CellEditMode_PrivateHost,v.BJ.CopilotChat),await S(!0,e)}else await S(!1,e)}(((e,t)=>{t&&(0,Jt.V1)(t),i(e)}))}catch(e){(0,o.H_5)()||e instanceof ks.DY&&(0,jt.cY)(e.message),(0,o.yw9)("OfficeVSO_9410553_copilotInfiniteLoadOnCellEdit")&&e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.invalidOperationInCellEditMode&&x.M.getInstance().logStandardizedAshaErrorEvent(y.W.Copilot_Chat_Pane_Failed_To_Load,C.c.Pane_Taking_Too_Long_To_Load_Due_To_CellEditMode_InitializeTasks,v.BJ.CopilotChat)}e(!0)}const Ns={},Ms=(0,I.createContext)(Ns),Os=e=>{const[t,n]=I.useState(g.Gm.defaultWhite),[a,d]=I.useState(f.QJ.disabled),[u,m]=I.useState(!1),[p,b]=I.useState(void 0),[C,y]=I.useState(void 0),v=(0,ge.j)(),T=(0,f.eS)(t,a!==f.QJ.disabled),S=e=>{const t=window.matchMedia("(prefers-color-scheme: light)").matches;(0,h.setIsHighContrastEnabled)(e),e?d(t?f.QJ.light:f.QJ.dark):(d(f.QJ.disabled),R(Office.context.officeTheme.bodyBackgroundColor,!1))};I.useEffect((()=>{const e=e=>{S(e.matches)};return window.matchMedia("(forced-colors: active)").addEventListener("change",e),()=>{window.matchMedia("(forced-colors: active)").removeEventListener("change",e)}}),[]),I.useEffect((()=>{Y.D.setTheme(T),X.g.setTheme(T)}),[t]);const w=e=>{R(e.officeTheme.bodyBackgroundColor,!0)},E=async()=>{Office.context?.themeManager&&await Office.context.themeManager.addHandlerAsync(Office.EventType.OfficeThemeChanged,w)},R=(e,t)=>{const a=(0,f.mR)(e,t),o=(0,f.j2)(a);v(rt.m.setIsDarkModeEnabled(o)),n(a)};I.useEffect((()=>{const e=e=>{window.matchMedia("(forced-colors: active)").matches&&d(e.matches?f.QJ.light:f.QJ.dark)};return window.matchMedia("(prefers-color-scheme: light)").addEventListener("change",e),()=>{window.matchMedia("(prefers-color-scheme: light)").removeEventListener("change",e)}}),[]),I.useEffect((()=>{(0,o.v5R)()&&y(Te.V.getSettingAsString(Te.z.CopilotLicenseStatus)),(0,o.yw9)("OfficeVSO_8455363_MoveInitializationCodeToInitializeTasks")||((0,Rs.v)(),Office.context.platform===Office.PlatformType.PC?(R(Office.context.officeTheme.bodyBackgroundColor,!0),E().catch((e=>{(0,jt.cY)("Register Theme Callback() error: "+e),x.M.getInstance().logError({eventType:ot.S2.Error,errorMessage:e,logLevel:j.$b.Error})}))):(0,zi.OK)()&&Office.context?.themeManager?.getOfficeThemeAsync((e=>{if("succeeded"===e.status){const t=e.value;R(t.bodyBackgroundColor,!0),E()}})),window.matchMedia("(forced-colors: active)").matches&&S(!0)),(async()=>{try{(0,o.CyP)().length>0&&await r.getInstance().init()}catch(e){(0,jt.cY)(`Unable to initialize Anthropic keys: ${e}`)}})();const e=e=>{(0,o.R$m)()&&v(it.m.setCopilotState(e)),b((t=>t===s.$.Enabled?((0,jt.cY)("Leaving copilotState as Enabled instead of changing to "+e),t):(e!==s.$.Enabled?(0,jt.sZ)():((0,o.R$m)()||window.document.getElementById(c.OsU)?.style.removeProperty("display"),(0,o.R$m)()&&void 0!==t&&(l.$.getInstance().startReinitializeALSession(),l.$.getInstance().activateAugloopAnnotations())),(0,jt.cY)("Updating copilotState to "+e),e)))};l.$.getInstance().startLoadingPaneTimeout(!1),(async()=>{await Ps(m,E,S,R,e,v)})(),window.addEventListener("beforeunload",(()=>{Y.D.getInstance().closeActiveDialog(),X.g.getInstance().closeActiveDialog()}))}),[]),I.useEffect((()=>{switch(a){case f.QJ.light:(0,h.setClientThemeType)(g.Gm.defaultWhite),n(g.Gm.defaultWhite);break;case f.QJ.dark:(0,h.setClientThemeType)(g.Gm.defaultBlack),n(g.Gm.defaultBlack)}}),[a]);const A=(0,ws.Q)((0,as.gl)(),void 0),k=(0,h.useStringLoader)((0,as.gl)(),void 0);if(I.useEffect((()=>{(0,ue.N)("FA000000124")}),[]),u){if((0,o.v5R)()&&C===i.MultiAccessDisabledByAdmin){(0,jt.sZ)();const e=t!==g.Gm.defaultWhite?"./assets/error-boundary-dark.webp":"./assets/error-boundary-light.webp",n=I.createElement(h.ThemeProvider,{theme:T},I.createElement(h.LicenseErrorScreen,{licenseErrorImagePath:e,handleRefreshButtonOnClick:()=>{Office?.ExtensionLifeCycle?.taskpane?.close().catch((e=>{(0,jt.cY)(`Error closing taskpane: ${e}`)}))}})),a=I.createElement(h.Localization,{lookupString:k},n);return I.createElement(Is.q,{dir:(0,as.xt)()?"rtl":"ltr"},a)}if(Te.V.IsSettingTrue(Te.z.ButtonEnabledForLocalFiles)&&((0,o.R$m)()?void 0===p:p!==s.$.Enabled))return void 0===p?I.createElement("div",null):(0,o.vCb)()?I.createElement(Is.q,{dir:(0,as.xt)()?"rtl":"ltr"},I.createElement(L,{copilotState:p,theme:t,isHighContrast:a!==f.QJ.disabled})):I.createElement(L,{copilotState:p,theme:t,isHighContrast:a!==f.QJ.disabled});{const n=I.createElement(Es.G,{lookupString:A},I.createElement(Ss,{theme:t,isHighContrast:a!==f.QJ.disabled,accountInfo:e.accountInfo,initTelemetryHandler:e.initTelemetryHandler}));return I.createElement(Ms.Provider,{value:{sdxTheme:t,highContrastClientMode:a}},I.createElement("div",{className:"ms-welcome"},(0,o.vCb)()?I.createElement(Is.q,{dir:(0,as.xt)()?"rtl":"ltr"},n):n))}}return I.createElement(Nn.B,{styles:Ql},I.createElement(As.y,null))}},622998:(e,t,n)=>{"use strict";n.d(t,{K:()=>Zt});var a=n(502535),o=n(615397),r=n(13161),i=n(279395),l=n(83437),s=n(857677),c=n(75496),d=n(316904),u=n(531093),m=n(22992),g=n(109174);function h(e){const t=g.CP.getActiveTable();if(!t)throw new o.tF("Failed to resolve selected tables!",e);return t}function p(e,t){const n=h(t).sheetRange,a=n.range.topLeft,r=a.row,i=a.column,l=n.range.bottomRight,s=l.row,c=l.column,d=e.range.range.topLeft,u=d.row,m=d.column,g=e.range.range.bottomRight,p=g.row,b=g.column;if(null===r||null===i||null===s||null===c)throw new o.tF("Table range is null",t,o.tJ.ColumnRowOutOfBoundary);if(null===u||null===m||null===p||null===b)throw new o.tF("Range is null",t,o.tJ.ColumnRowOutOfBoundary);if(r>u||s<p)throw new o.tF("Row is out of bounds of the table",t,o.tJ.ColumnRowOutOfBoundary);if(i>m||c<b)throw new o.tF("Column is out of bounds of the table",t,o.tJ.ColumnRowOutOfBoundary);return e}const b=(e,t)=>{e=e.toLowerCase();for(const n of t)if(n.test(e))return!0;return!1};var f=n(347145);const C=[/\(/,/\)/,/\{/,/\}/,/\\\\/,/\/\//,/=/,/#/,/!/,/div\/0/,/.*\|.*/],y=[/^(0?[1-9]|1\d|2\d|3[01])[/-](0?[1-9]|1[0-2])[/-](\d{4}|\d{2})$/,/^(0?[1-9]|1[0-2])[/-](0?[1-9]|1\d|2\d|3[01])[/-](\d{4}|\d{2})$/,/^(?:jan(?:uary)?|feb(?:ruary)?|mar(?:ch)?|apr(?:il)?|may|jun(?:e)?|jul(?:y)?|aug(?:ust)?|sep(?:tember)?|oct(?:ober)?|nov(?:ember)?|dec(?:ember)?)\s(?:0?[1-9]|[12]\d|3[01]),?(?:\s\d{2}(?:\d{2})?)?$/,/^(0[1-9]|1[0-2])\/(0[1-9]|[12]\d|3[01])$|^(0[1-9]|1[0-2])\/(0[1-9]|[12]\d|3[01])\/$|^(0[1-9]|1[0-2])\/(0?[1-9]|[12]\d|3[01])$|^(0[1-9]|1[0-2])\/(0?[1-9]|[12]\d|3[01])\/(0?[1-9]|[12]\d|3[01])$|^(0?[1-9]|1[0-2])\/(0[1-9]|[12]\d|3[01])$/],v=[/^-?[\d,. ']+%?$/],T=[/\b(odd|even)\s*(rows?|row)\b/i,/every\s+\b\w+\b\s*(rows?|row)/i],x=(0,f.yw9)("OfficeVSO_9193005_NegativeRowIndexEnglishFix")?[/\b(first|last|top|bottom|beginning|ending)([\w\d\s]*)(rows?)\b/i,/\b(rows?)([\w\d\s]*)(top|bottom|beginning|end)\b/i,/\b(rows?)([\w\d\s]*)(above|below|under)$/i,/\b(headers?)\b/i]:[/\b(first|last|top|bottom|beginning|ending)\s*([\w\d]*)\s*(rows?)\b/i,/\b(row?|rows?)\s*([\w\d]*)\s*(top|bottom|beginning|end)\b/i,/\b(row?|rows?)\s*(above|below|under)$/,/\b(headers?)\b/],S=[/\b(last|bottom|ending)\s*([\w\d]*)\s*(rows?)\b/i,/\b(row?|rows?)\s*([\w\d]*)\s*(bottom|end)\b/i,/\b(row?|rows?)\s*(below|under)\b/i],w=[/\b(this|these|selected)\s+(row|rows)\b/gi,/\b(row|rows)\s+(selected)\b/gi],E=[/\b(clear|remove|delete|erase)\s+sort/gi],I=[/^(?!.*format)\b(clear|delete|eliminate|empty|erase|remove).*?(cell|cells|content|contents|data|text|value|values)\b/i,/\b(clear|delete|eliminate|empty|erase|remove)\s+(|all\s|all\s+of\s+the\s|all\s+the\s|cell\s|the\s)+(format|formats|formatting)\s+and\s+(|all\s|all\s+of\s+the\s|all\s+the\s|cell\s|the\s)+(cell|cells|content|contents|data|text|value|values)\b/i,/\b(clear|delete|eliminate|empty|erase|remove)\s+(|all\s|all\s+of\s+the\s|all\s+the\s|cell\s|the\s)+(cell|cells|content|contents|data|text|value|values)\s+and\s+(|all\s|all\s+of\s+the\s|all\s+the\s|cell\s|the\s)+(format|formats|formatting)\b/i],R=[/^(clear|delete|eliminate|empty|erase|remove) all(?!.*format)/i],A=[/^(remove|delete)/i];function L(e,t){if(t<0)throw new Error("Row index can bot be smaller than 0!");return{sheet:e,range:{topLeft:{row:t,column:null},bottomRight:{row:t,column:null}}}}function k(e,t){if(t<0)throw new Error("Column index can bot be smaller than 0!");return{sheet:e,range:{topLeft:{row:null,column:t},bottomRight:{row:null,column:t}}}}async function F(){try{return await Excel.run((async e=>{const t=e.workbook.worksheets.getActiveWorksheet();return t.load("name"),await e.sync(),t.name}))}catch{throw new o.tF("Failed to get active worksheet name","getActiveWorkSheetName")}}function _(e,t){const n=[];for(let a=e;a<=t;a++)n.push(a);return n}function P(e,t,n,a,r){if(null===e.range.topLeft.column||null===e.range.topLeft.row)throw new o.tF("Bad Column from TableContext","getFullTableEntityColumnRangeByIndex");const i=e.range.topLeft.column+t,l={row:e.range.topLeft.row,column:i},s={row:e.range.topLeft.row+1,column:i},c={row:e.range.bottomRight.row,column:i},d={sheet:e.sheet,range:{topLeft:s,bottomRight:c}},m={sheet:e.sheet,range:{topLeft:l,bottomRight:c}};return(0,f.avT)()&&a?{columnRange:{rangeType:u.RangeType.TableRange,range:{subRange:u.TableRangeOperationSubRange.ColumnsBody,tableName:n,gridRange:d,subRangeValues:r?{columnNames:[r]}:{firstIndex:t,count:1}}},fullColumnRange:{rangeType:u.RangeType.TableRange,range:{subRange:u.TableRangeOperationSubRange.Columns,tableName:n,gridRange:m,subRangeValues:r?{columnNames:[r]}:{firstIndex:t,count:1}}}}:{columnRange:{rangeType:u.RangeType.ExcelSheetRange,range:d},fullColumnRange:{rangeType:u.RangeType.ExcelSheetRange,range:m}}}var N=n(796102);function M(e,t){let n=[];const a=(0,N.dc)(e,"worksheetRowNumbers");return a&&a.length>0?a.map((e=>{if(e<=t)throw new o.tF("worksheetRowNumber specified out of boundary.","getRowNumber",o.tJ.ColumnRowOutOfBoundary);n.push(e-t-1)})):n=(0,N.dc)(e,"rowNumbers"),n}async function O(){if((0,f.yw9)("OfficeVSO_9194315_Selection")){const e=g.CP.getActiveRangeAddresses();if(0===e.length)return[];try{return e.map((e=>u.ExcelCalc.sheetAddressToGeneralExcelSheetRange(e))).map((e=>e.range))}catch{throw new o.tF("Failed to get selected ranges.","getSelectedRanges",o.tJ.ColumnRowBySelection)}}try{return await Excel.run((async e=>{const t=e.workbook.getSelectedRanges(),n=t.areas;n.load("items/address"),t.load("address"),await e.sync();return n.items.map((e=>e.address)).map((e=>u.ExcelCalc.sheetAddressToGeneralExcelSheetRange(e))).map((e=>e.range))}))}catch{throw new o.tF("Failed to get selected ranges.","getSelectedRanges")}}var D=n(467407);function B(e,t,n,a,r,i){let l=[];if(t.length>0)l=U(e,t,i);else if(n.length>0||a.length>0)l=$(e,n.length>0?n:a,i);else if(r.length>0)l=function(e,t,n){const a=e.sheetRange,r=a.range.topLeft.column;if(null===r)throw new o.tF("Left column index of the table is null.",n);const i=t.map((t=>{if(t<0)return $(e,[t],n)[0];const a=t-1;if((0,f.yw9)("OfficeVSO_8385154_ColumnByWorksheetNumberBugFix")){if(a>r+e.numColumns-1||a<r)throw new o.tF("Worksheet index received is outside of the table.",n,o.tJ.ColumnRowOutOfBoundary);return a-r}if(t>r+e.numColumns-1||t<r)throw new o.tF("Worksheet index received is outside of the table.",n,o.tJ.ColumnRowOutOfBoundary);return t-r}));return i}(e,r,i);else{if("filterTables"===i||"sortTables"===i)throw new o.tF("No column argument specified.",i);if("insertColumns"===i)return[];if("clearFilters"===i)throw new o.tF("No column argument specified.",i,o.tJ.NoColumnArgument);l=Array.from({length:e.numColumns},((e,t)=>t))}const c=[];if(l.map((t=>{-1===e.visibleColumns.indexOf(t)&&c.push(t)})),c.length>0){m.g.instance().setHiddenColumnSuffixMessage(e,c);const t=[{key:s.xL.NumOfColumnHidden,value:c.length}];(0,D.R)(new o.tF("User selected a column that is hidden.",i,o.tJ.General,t))}return l}function $(e,t,n){return t.map((t=>{let a;if(a=t<0?e.numColumns+t:t-1,a>=e.numColumns||a<0)throw new o.tF("Column index specified out of boundary.",n,o.tJ.ColumnRowOutOfBoundary);return a}))}function H(e){return String.raw`${e}`.replace(/\\n/g," ").replace(/\\r/g," ").replace(/\\t/g," ").replace(/\\v/g," ").replace(/\\(.)/g,"$1").replace(/\s+/g," ").trim().toLowerCase()}function U(e,t,n){const a=JSON.parse(e.headers);return t.map((e=>{let t=a.indexOf(e);if(-1===t){if((0,f.yw9)("OfficeVSO_8432116_CleaningColumnName")){const n=H(e);t=a.findIndex((e=>H(e)===n))}if(-1===t)throw new o.tF("Column name specified not found.",n,o.tJ.ColumnRowOutOfBoundary)}return t}))}function q(e,t,n=!1){const a=[];let r=t.sheetRange;if(g.CP.isTableHeaderShown()){if(null===r.range.topLeft.row)throw new o.tF("Row range has incorrect format","getTableRowIndicesFromRanges");r={sheet:r.sheet,range:{topLeft:{row:r.range.topLeft.row+1,column:r.range.topLeft.column},bottomRight:r.range.bottomRight}}}for(const t of e){if(t.range.topLeft.row!==t.range.bottomRight.row)throw new o.tF("Row range has incorrect format","getTableRowIndicesFromRanges");if(null===t.range.topLeft.row||null===r.range.topLeft.row||null===r.range.bottomRight.row)throw new o.tF("Row not available (e.g. range address might refer to a full column)","getTableRowIndicesFromRanges",o.tJ.ColumnRowOutOfBoundary);if(t.range.topLeft.row<r.range.topLeft.row||t.range.topLeft.row>r.range.bottomRight.row+(n?1:0))throw new o.tF("Row out of boundary","getTableRowIndicesFromRanges",o.tJ.ColumnRowOutOfBoundary);const e=t.range.topLeft.row-r.range.topLeft.row;a.push(e)}if(0===a.length)throw new o.tF("No matched row index found","getTableRowIndicesFromRanges");return a}async function V(e){return await Excel.run({delayForCellEdit:!0},(async t=>{const n=t.workbook.worksheets.getActiveWorksheet().load("name"),a=n.getRange(u.ExcelCalc.IExcelRangeToAddress(e.sheetRange.range)).getVisibleView();a.load("cellAddresses"),await t.sync();return a.cellAddresses.map((e=>{if((0,f.yw9)("OfficeVSO_9322539_InsertAtTableEnd")&&0===e.length)throw new o.tF("No visible table row.","getVisibleRowRanges",o.tJ.NoVisibleRange);const t=n.name+"!"+e[0]+":"+e[e.length-1];return u.ExcelCalc.sheetAddressToExcelSheetRange(t)}))}))}var W=n(158058),G=n(118565),z=n.n(G);class Q{static async getSelectedWorksheets(e){let t=[];if(t=(0,N.Lb)(e,"worksheetNames"),0===t.length){const n=(0,N.dc)(e,"worksheetNumbers");if(n&&n.length>0){const e=await async function(){return Excel.run({delayForCellEdit:!0},(async e=>{const t=e.workbook.worksheets.load("items");return await e.sync(),t.items.map((e=>e.name))}))}();t=n.map((t=>{if(t<1||t>e.length)throw new o.tF("Worksheet number can not be 0 or greater than number of worksheets!","getSelectedWorksheets");return e[t-1]}))}else t=[await F()]}if(0===t.length)throw new o.tF("No worksheet has been selected!","getSelectedWorksheets");return t}static async getSelectedRanges(e,t){let n=await Q.getWorksheetScopeVariable(e,t);void 0===n&&(n=await F());let a=[];const r=(0,N.Lb)(e,"addresses");if(a=r&&r.length>0?r.map((t=>p({rangeType:u.RangeType.ExcelSheetRange,range:{sheet:n,range:u.ExcelCalc.addressToExcelRange(t)}},e.name))):(await O()).map((t=>{if((0,f.yw9)("OfficeVSO_8973949_CheckSelectionOutsideOfTable")){return p({rangeType:u.RangeType.ExcelSheetRange,range:{sheet:n,range:t.range}},e.name)}return{rangeType:u.RangeType.ExcelSheetRange,range:t}})),(0,f.avT)()){let e={};await Excel.run((async t=>{e=await z().getTablesNameToRangeMapOnSheet(t,n)})),a=a.map((t=>{for(const n of Object.keys(e)){const a=u.ExcelEventConverter.makeTableRangeOperation(n,e[n],t.range);if(a){return{rangeType:u.RangeType.TableRange,range:a}}}return t}))}if(0===a.length)throw new o.tF("No ranges has been selected!","getSelectedRanges");return a}static async getSelectedTables(e,t){let n=await Q.getWorksheetScopeVariable(e,t);void 0===n&&(n=await F());const a=(0,N.Lb)(e,"tableNames"),r=Q.tryGetSelectedTableContext(e.name);if(0===a.length){if(!r)throw new o.tF("Failed to resolve selected tables!","getSelectedTables",o.tJ.NoActiveTable);return[r]}const i=[];for(let e=0;e<a.length;e++){const t=a[e];if(r&&(0,W.P9)(r.name,t))i.push(r);else{await g.CP.fetchAndSetActiveTableLikeEntity(t);const e=g.CP.getActiveTable();e&&i.push(e)}}if(0===i.length)throw new o.tF("No table has been selected!","getSelectedTables",o.tJ.NoActiveTable);return i}static async getSelectedColumns(e,t){const n=t.tryGetScopeChainedVariableArgument(e),a=t.tryGetScopeVariableArgumentName(e);if(!n||!a)return await Q.getTableScopeSelectedColumns(e);if("Table"===n.entityType){const t=n.values[0];return await Q.getTableColumnRanges(t,e,a)}throw"Worksheet"===n.entityType?new o.tF("Worksheet column is not currently supported.","getSelectedColumns",o.tJ.ColumnRowOutOfBoundary):new o.tF(`Scope ${n.entityType} is not supported`,"getSelectedColumns")}static async getTableColumnRanges(e,t,n){let a=(0,N.Lb)(t,"columnNames");const o=B(e,a,(0,N.dc)(t,"columnNumbers"),(0,N.dc)(t,"tableColumnNumbers"),(0,N.dc)(t,"worksheetColumnNumbers"),t.name);if(0===a.length&&(0,f.avT)()){const t=JSON.parse(e.headers);a=o.map((e=>t[e]))}return await Q.getTableColumnRangesBase(o,e,a,n)}static async getTableColumnRangesBase(e,t,n,a){if((0,f.xyg)("AutofitSelectedRowsColumns")){const r=await Promise.all(e.map((async(e,a)=>{const o=0===n.length?void 0:n[a];return P(t.sheetRange,e,t.name,(0,g.En)(t),o)})));if(0===r.length)throw new o.tF("No column is selected!","getTableColumnRangesBase");return{ranges:r.map((e=>e.columnRange)),fullRanges:r.map((e=>e.fullColumnRange)),indices:e,tableKey:a}}{const r=await Promise.all(e.map((async(e,a)=>{const o=0===n.length?void 0:n[a],{columnRange:r}=P(t.sheetRange,e,t.name,(0,g.En)(t),o);return r})));if(0===r.length)throw new o.tF("No column is selected!","getTableColumnRangesBase");return{ranges:r,indices:e,tableKey:a}}}static getTableColumnNames(e,t){const n=(0,N.Lb)(t,"columnNames"),a=(0,N.dc)(t,"columnNumbers"),o=(0,N.dc)(t,"tableColumnNumbers"),r=(0,N.dc)(t,"worksheetColumnNumbers"),i=JSON.parse(e.headers);return B(e,n,a,o,r,t.name).map((e=>i[e]))}static getTableColumnName(e,t){const n=(0,N.Ru)(t,"columnName"),a=(0,N.lI)(t,"columnNumber"),o=(0,N.lI)(t,"tableColumnNumber"),r=(0,N.lI)(t,"worksheetColumnNumber");return JSON.parse(e.headers)[B(e,n?[n]:[],a?[a]:[],o?[o]:[],r?[r]:[],t.name)[0]]}static getTableColumnNumber(e,t){const n=(0,N.Ru)(e,"columnName"),a=(0,N.lI)(e,"columnNumber"),o=(0,N.lI)(e,"tableColumnNumber"),r=(0,N.lI)(e,"worksheetColumnNumber");return B(t,n?[n]:[],a?[a]:[],o?[o]:[],r?[r]:[],e.name)[0]}static getTableColumnNumbers(e,t){const n=(0,N.dc)(e,"tableColumnNumbers");return B(t,[],(0,N.dc)(e,"columnNumbers"),n,(0,N.dc)(e,"worksheetColumnNumbers"),e.name)}static async getTableScopeSelectedColumns(e){const t=e.name,n=h(t),a=(await O())[0],r=a.range.topLeft.column,i=a.range.bottomRight.column;if(null===r||null===i)throw new o.tF("selected range is invalid","getTableScopeSecelectedColumns");const l=_(r,i),s=l.map((e=>e+1)),c=B(n,[],[],[],(0,f.yw9)("OfficeVSO_8385154_ColumnByWorksheetNumberBugFix")?s:l,t);let d=[];if((0,f.avT)()){const e=JSON.parse(n.headers);d=c.map((t=>e[t]))}const u=(0,N.iA)(e);u&&(u.type="var",u.name="tables",e.arguments.tableColumnNumbers={type:"numberList",numberList:c});const m=u?.name??"Selection";return await Q.getTableColumnRangesBase(c,n,d,m)}static async getSelectedColumnsDeprecated(e,t,n){const a=(0,N.NW)(e,"scope");if(!a)return this.getTableScopeSelectedColumns(e);const r=a.name,i=t.tryGetChainedVariableArgument(r);if(!i)return this.getTableScopeSelectedColumns(e);let l=(0,N.dc)(e,"columnNumbers"),s=(0,N.Lb)(e,"columnNames");if("Table"===i.entityType){const t=i.values[0],a=JSON.parse(t.headers),c=t.visibleColumns;if(l=0===l.length?l.concat(s.map((e=>{const t=a.indexOf(e);if(-1===t)throw new o.tF("Column name specified not found.","getSelectedColumnsDeprecated",o.tJ.ColumnRowOutOfBoundary);return t}))):l.map((t=>function(e,t,n){let a;if(a=e<0?t.length+e:e-1,a>=t.length||a<0)throw new o.tF("Column index specified out of boundary.",n,o.tJ.ColumnRowOutOfBoundary);return t[a]}(t,c,e.name))),0===s.length&&(0,f.avT)()){const e=JSON.parse(t.headers);s=l.map((t=>e[t]))}if((0,f.xyg)("AutofitSelectedRowsColumns")){0===l.length&&0===s.length&&(l=[...c]);const e=await Promise.all(l.map((async(e,n)=>{const a=s.length>0?s[n]:void 0;return P(t.sheetRange,e,t.name,!t.tableLikeRange,a)})));if(0===e.length)throw new o.tF("No column is selected!","getSelectedColumnsDeprecated");return m.g.instance().setIsFirstColumnEntityResolved(t.headers,n),{ranges:e.map((e=>e.columnRange)),fullRanges:e.map((e=>e.fullColumnRange)),indices:l,tableKey:r}}{const e=await Promise.all(l.map((async(e,n)=>{const a=await async function(e,t){return Excel.run({delayForCellEdit:!0},(async n=>{const a=n.workbook.tables.getItem(e).columns.getItemAt(t).getDataBodyRange().load("address");return await n.sync(),a}))}(t.name,e);if((0,f.avT)()&&(0,g.En)(t)){const o=s.length>0?s[n]:void 0;return{rangeType:u.RangeType.TableRange,range:{subRange:u.TableRangeOperationSubRange.ColumnsBody,gridRange:u.ExcelCalc.sheetAddressToExcelSheetRange(a.address),tableName:t.name,subRangeValues:o?{columnNames:[o]}:{firstIndex:e,count:1}}}}return{rangeType:u.RangeType.ExcelSheetRange,range:u.ExcelCalc.sheetAddressToExcelSheetRange(a.address)}})));if(0===e.length)throw new o.tF("No column is selected!","getSelectedColumnsDeprecated");return m.g.instance().setIsFirstColumnEntityResolved(t.headers,n),{ranges:e,indices:l,tableKey:r}}}if("Worksheet"===i.entityType){const t=i.values[0];let n=[];if(0===l.length){n=(0,N.Lb)(e,"columnNames").map((e=>{const n=e+":"+e;return{rangeType:u.RangeType.ExcelSheetRange,range:{sheet:t,range:u.ExcelCalc.addressToExcelRange(n)}}}))}else n=l.map((e=>({rangeType:u.RangeType.ExcelSheetRange,range:k(t,e-1)})));if(0===n.length)throw new o.tF("No column is selected!","getSelectedColumnsDeprecated");return{ranges:n,worksheetKey:r,indices:l}}throw new o.tF("invalid entity type","getSelectedColumnsDeprecated")}static async getSelectedRows(e,t,n){if(void 0===n)throw new o.tF("No query string",e.name);const a=(0,N.NW)(e,"scope");if(!a||"Selection"===a.name)return Q.getTableSelectedRows(e);const r=a.name,i=t.tryGetChainedVariableArgument(r);if(!i)throw new o.tF("No cached upper variable","getSelectedRows");let l=[];const s=(0,f.yw9)("OfficeVSO_9436607_WorksheetRowNumber");if(s||(l=(0,N.dc)(e,"rowNumbers")),"Table"===i.entityType){const t=i.values[0];if(!s&&null==t.sheetRange.range.topLeft.row)throw new o.tF("Table row range has incorrect format","getSelectedRows");const a=t.sheetRange.range.topLeft.row??0;if(s&&(l=M(e,a)),(0,f.yw9)("OfficeVSO_8375706_SelectAllRows")&&0===l.length)return this.getAllRows(t,r);const c=[...l],d=[],u=[],m=t.numRows;for(let e=0;e<l.length;e++)if(l[e]<0)if((0,f.yw9)("OfficeVSO_9279053_SelectRowRegExpRemoval")||b(n,x))d.push(l[e]+a+m+1),u.push(c[e]+m);else{if((0,f.yw9)("OfficeVSO_8532526_DeleteEmptyRows")&&-1===l[e]&&b(n,A))throw new o.tF("Deleting unexpected negative rows is a blocked scenario","deleteRows",o.tJ.DeleteUnexpectedTableRows);if(!t.totalRow)throw new o.tF("invalid negative row number expected","getSelectedRows");d.push(a+m+1),u.push(m)}else if(0===l[e])d.push(a),u.push(-1);else{if(l[e]>m+(t.totalRow?1:0))throw new o.tF("row numbers is greater than expected","getSelectedRows");d.push(l[e]+a),u.push(c[e]-1)}return{ranges:await Q.getTableRowRangesCommon(t,d,!0),tableKey:r,indices:u}}if("Worksheet"===i.entityType){s&&(l=(0,N.dc)(e,"worksheetRowNumbers"));return{ranges:Q.getWorksheetRowRangeCommon(i,l,n),worksheetKey:r,indices:l}}throw new o.tF("invalid entity type","getSelectedRows")}static async getTableSelectedRows(e){const t=h(e.name),n=(await O())[0],a=n.range.topLeft.row,r=n.range.bottomRight.row;if(null===a||null===r)throw new o.tF("selected range is invalid","getTableScopeSelectedColumns");const i=_(a,r),l=await Q.getTableRowRangesCommon(t,i,!0);let s=[];if(s=q(l.map((e=>u.ExcelCalc.getIGeneralRangeOperationRange(e))),t),(0,f.avT)()){const t=(0,N.iA)(e);t&&(t.type="var",t.name="tables",e.arguments.rowNumbers={type:"numberList",numberList:s})}return{ranges:l,tableKey:"Selection",indices:s}}static async getAllRows(e,t){const n=(await V(e)).map((t=>{let n;return n=(0,f.avT)()&&(0,g.En)(e)?{rangeType:u.RangeType.TableRange,range:{subRange:u.TableRangeOperationSubRange.Rows,gridRange:t,tableName:e.name,subRangeValues:{firstIndex:e.sheetRange.range.topLeft.row-t.range.topLeft.row-1,count:1}}}:{rangeType:u.RangeType.ExcelSheetRange,range:t},n})),a=(e.sheetRange.range.topLeft.row??0)+1,o=n.map((e=>(u.ExcelCalc.getIGeneralRangeOperationRange(e).range.topLeft.row??0)-a));return g.CP.isTableHeaderShown()&&(o.shift(),n.shift()),{ranges:n,tableKey:t,indices:o,allRows:!0}}static getWorksheetRowRangeCommon(e,t,n){(0,f.yw9)("OfficeVSO_9279066_RemoveRegExForRowBySelection")||function(e){if(b(e,w))throw new o.tF("Blocked phrase for referencing rows by selection","getSelectedRows",o.tJ.ColumnRowBySelection)}(n);const a=e.values[0],r=t.map((e=>({rangeType:u.RangeType.ExcelSheetRange,range:L(a,e-1)})));if(0===r.length)throw new o.tF("No row is selected!","getSelectedRows");return r}static async getTableRowRangesCommon(e,t,n=!1){const a=await V(e);let r=[];if(r=n?Q.getTableRowsByWorksheetIndices(a,t,e):await Q.getTableRowsByTableIndices(e,a,t),0===r.length)throw new o.tF("No row is selected!","getSelectedRows");return r}static getTableRowsByWorksheetIndices(e,t,n){const a=[];Q.throwIfRowsOutOfBoundary(t,n);for(const o of t){const t=e.find((e=>e.range.topLeft.row===o));if(t)if((0,f.avT)()&&(0,g.En)(n)){const e={rangeType:u.RangeType.TableRange,range:{subRange:u.TableRangeOperationSubRange.Rows,tableName:n.name,gridRange:t,subRangeValues:{firstIndex:t.range.topLeft.row-n.sheetRange.range.topLeft.row-1,count:1}}};a.push(e)}else{const e={rangeType:u.RangeType.ExcelSheetRange,range:t};a.push(e)}}return a}static async getTableRowsByTableIndices(e,t,n){e.totalRow&&t.pop();const a=(0,f.yw9)("OfficeVSO_9322539_InsertAtTableEnd");if(a){if(0===t.length)throw new o.tF("No visible table row.","getTableRowsByTableIndices",o.tJ.NoVisibleRange);t.push({sheet:t[t.length-1].sheet,range:{topLeft:{row:t[t.length-1].range.topLeft.row+1,column:t[t.length-1].range.topLeft.column},bottomRight:{row:t[t.length-1].range.bottomRight.row+1,column:t[t.length-1].range.bottomRight.column}}})}return(n=n.map((e=>{let n=e;if(e<0?n=a?-1===e?t.length-1:t.length+e-1:t.length+e:g.CP.isTableHeaderShown()||(n=e-1),n>=t.length||n<0)throw new o.tF("Row index specified out of boundary.","getSelectedRows",o.tJ.ColumnRowOutOfBoundary);return n}))).map((n=>{if((0,f.avT)()&&(0,g.En)(e)){let a;return a=0===n?{rangeType:u.RangeType.TableRange,range:{subRange:u.TableRangeOperationSubRange.HeaderRow,tableName:e.name,gridRange:t[n]}}:{rangeType:u.RangeType.TableRange,range:{subRange:u.TableRangeOperationSubRange.Rows,tableName:e.name,gridRange:t[n],subRangeValues:{firstIndex:t[n].range.topLeft.row-e.sheetRange.range.topLeft.row-1,count:1}}},a}return{rangeType:u.RangeType.ExcelSheetRange,range:t[n]}}))}static async getWorksheetScopeVariable(e,t){const n=t.tryGetVariableArgumentValue(e,"scope");if(n&&"Worksheet"===n.entityType){const e=n.values;if(1===e.length)return e[0]}}static tryGetSelectedTableContext(e){try{return h(e)}catch{return}}static throwIfRowsOutOfBoundary(e,t){const n=t.sheetRange.range.topLeft.row,a=t.sheetRange.range.bottomRight.row;if(n&&e[0]<n||a&&e[e.length-1]>a)throw new o.tF("Row index specified out of boundary.","getSelectedRows",o.tJ.ColumnRowOutOfBoundary)}}class j{async cacheVariable(e,t){const n=this._variableCacheMap[e.name];await n(e,t)}isSelectStatement(e){return!!this._variableCacheMap[e.name]}isRowColumnSelectStatementWithSelectionScope(e){return!!(0,N.iA)(e)&&("selectColumns"===e.name||"selectRows"===e.name)}isDeleteColumnsStatement(e){return"deleteColumns"===e.name}isInsertColumnsStatement(e){return"insertColumns"===e.name}isSelectColumnsStatement(e){return"selectColumns"===e.name}isDeleteRowsStatement(e){return"deleteRows"===e.name}isInsertRowsStatement(e){return"insertRows"===e.name}isSelectRowsStatement(e){return"selectRows"===e.name}tryGetVariableArgumentValue(e,t){try{return this.getVariableArgumentValue(e,t)}catch{return}}getVariableArgumentValue(e,t){const n=(0,N.YL)(e,t),a=this.returnVariableCache[n];if(void 0===a)throw new o.tF("Cannot find variable in the cache dictionary!",t);return a}getChainedVariableArgument(e){const t=this.returnVariableCache[e];if(void 0===t)throw new o.tF("Chained variable cache is not found.","getChainedVariableArgument");return t}tryGetChainedVariableArgument(e){try{return this.getChainedVariableArgument(e)}catch{return}}getScopeChainedVariableArgument(e){const t=(0,N.l$)(e).name;return this.getChainedVariableArgument(t)}tryGetScopeChainedVariableArgument(e){try{return this.getScopeChainedVariableArgument(e)}catch{return}}getScopeVariableArgumentName(e){const t=(0,N.l$)(e);if(void 0===t.name)throw new o.tF("Scope name is undefined.","getScopeVariableArgumentName");return t.name}tryGetScopeVariableArgumentName(e){try{return this.getScopeVariableArgumentName(e)}catch{return}}getTableContext(e,t,n){const a=t.getVariableArgumentValue(e,n).values;if(!a.tableKey)throw new o.tF("Table key not found!",n);const r=t.getChainedVariableArgument(a.tableKey);if("Table"!==r.entityType)throw new o.tF("Variable cache entity type mismatched!","getTableContext: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);return r.values[0]}UpdateVariableCache(e,t,n){void 0!==e&&(this.returnVariableCache[e]={entityType:t,values:n})}fillVariableCacheMap(){this._variableCacheMap.selectWorksheets=async(e,t)=>{const n=await Q.getSelectedWorksheets(e);this.returnVariableCache[(0,N.nZ)(e)]={entityType:"Worksheet",values:n}},this._variableCacheMap.selectRanges=async(e,t)=>{const n=await Q.getSelectedRanges(e,this);this.returnVariableCache[(0,N.nZ)(e)]={entityType:"Range",values:n}},this._variableCacheMap.selectTables=async(e,t)=>{const n=await Q.getSelectedTables(e,this);this.returnVariableCache[(0,N.nZ)(e)]={entityType:"Table",values:n}},this._variableCacheMap.selectColumns=async(e,t)=>{const n=await Q.getSelectedColumns(e,this);this.returnVariableCache[(0,N.nZ)(e)]={entityType:"Column",values:n}},this._variableCacheMap.selectRows=async(e,t)=>{const n=await Q.getSelectedRows(e,this,t);this.returnVariableCache[(0,N.nZ)(e)]={entityType:"Row",values:n}}}constructor(){this.returnVariableCache={},this._variableCacheMap={},this.fillVariableCacheMap()}}function J(e){return e.replace(/\\n/g,"\n").replace(/\\'/g,"'")}function Y(e,t){return J((0,N.C3)(e,t))}function X(e,t){const n=(0,N.Ru)(e,t);return n?J(n):n}function Z(e,t=[]){for(let n=0;n<e.length;n++)Array.isArray(e[n])?Z(e[n],t):t.push(e[n]);return t}function K(e){if(null===e.range.topLeft.row)throw new o.tF("no sheet range associated with table");return{rangeType:u.RangeType.ExcelSheetRange,range:{sheet:e.sheet,range:{topLeft:{row:e.range.topLeft.row+1,column:e.range.topLeft.column},bottomRight:e.range.bottomRight}}}}async function ee(e,t){if(!e.arguments.tables)throw new o.tF("No table specified.","conditionalFormatTables");const n=t.getVariableArgumentValue(e,"tables");if("Table"!==n.entityType)throw new o.tF("Variable cache entity type mismatched!","getResolvedTableRanges: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);const a=n.values,r=[];for(const e of a){let t;t=K(e.sheetRange),((0,f.avT)()||(0,f.yw9)("OfficeVSO_9266813_CommandingConvertTableRangeToName"))&&(0,g.En)(e)&&(t={rangeType:u.RangeType.TableRange,range:{subRange:u.TableRangeOperationSubRange.Body,tableName:e.name,gridRange:u.ExcelCalc.getIGeneralRangeOperationRange(t)}}),r.push(t)}return r}function te(e,t){if(void 0===e.arguments.columns)throw new o.tF("No columns specified.",e.name);const n=t.getVariableArgumentValue(e,"columns");if("Column"!==n.entityType)throw new o.tF("Variable cache entity type mismatched!","getResolvedColumnRanges: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);return n.values.ranges}function ne(e,t){if(void 0===e.arguments.rows)throw new o.tF("No rows specified.",e.name);const n=t.getVariableArgumentValue(e,"rows");if("Row"!==n.entityType)throw new o.tF("Variable cache entity type mismatched!","getResolvedRowRanges: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);return n.values.ranges}function ae(e,t){if(void 0===e.arguments.ranges)throw new o.tF("No range specified.",e.name);const n=t.getVariableArgumentValue(e,"ranges");if("Range"!==n.entityType)throw new o.tF("Variable cache entity type mismatched!","getResolvedRanges: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);return n.values}function oe(e,t){const n=t.getVariableArgumentValue(e,"columns").values;if(!n?.tableKey)throw new o.tF("No table specified","columns");const a=t.tryGetChainedVariableArgument(n.tableKey);if(!a||!Array.isArray(a.values)||0===a.values.length)throw new o.tF("Table not found","columns");const r=a.values[0];if(!r?.headers)throw new o.tF("Invalid table data");const i=JSON.parse(r.headers);if(!Array.isArray(i)||0===i.length)throw new o.tF("Invalid table headers");const l=n.indices.map((e=>`'${i[e]}'`)).join(", ");if(!l)throw new o.tF("Invalid column name(s)");return l}function re(e){const t={...e,bottomRight:{...e.bottomRight,row:e.bottomRight.row?e.bottomRight.row-1:e.bottomRight.row}};return u.ExcelCalc.IExcelRangeToAddress(t)}var ie=n(958571),le=n(335952);function se(e,t){const n={rangeType:u.RangeType.ExcelSheetRange,range:t,values:e};return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.Range.Edited,t.sheet,n)}function ce(e,t){const n={rangeType:u.RangeType.ExcelSheetRange,range:t,value:e};return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.Range.SingleValueEdited,t.sheet,n)}function de(e,t,n,a){const o={rangeType:n.rangeType,range:n.range,value:t,columnName:a},r=u.ExcelCalc.getIGeneralRangeOperationRange(n).sheet;return ie.ExcelEventConverter.makeGenericEvent(e,r,o)}function ue(e,t,n){return ie.ExcelEventConverter.makeGenericEvent(e,n,t)}function me(e,t,n){const a={direction:n,rangeType:t.rangeType,range:t.range},o=u.ExcelCalc.getIGeneralRangeOperationRange(t).sheet;return ie.ExcelEventConverter.makeGenericEvent(e,o,a)}function ge(e,t,n,a){const o={name:t,index:n,count:a};return ie.ExcelEventConverter.makeGenericEvent(e,t,o)}function he(e,t,n,a){const o={name:e,index:t,count:n,columnNames:a};return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.Table.ColumnInserted,e,o)}function pe(e,t){const n={rangeType:t.rangeType,range:t.range},a=u.ExcelCalc.getIGeneralRangeOperationRange(t).sheet;return ie.ExcelEventConverter.makeGenericEvent(e,a,n)}function be(e,t){const n={rangeType:t.rangeType,range:t.range},a=u.ExcelCalc.getIGeneralRangeOperationRange(t).sheet;return ie.ExcelEventConverter.makeGenericEvent(e,a,n)}function fe(e,t,n,a,o){const r={searchString:e,replaceWith:t,completeMatch:n,matchCase:a,rangeType:o.rangeType,range:o.range},i=u.ExcelCalc.getIGeneralRangeOperationRange(o).sheet;return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.Range.ReplacedAll,i,r)}function Ce(e,t){const n={command:e,rangeType:t.rangeType,range:t.range},a=u.ExcelCalc.getIGeneralRangeOperationRange(t).sheet;return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.Range.Cleared,a,n)}function ye(e,t,n,a,o){const r={tableName:e,columnName:t,top:n,type:a,count:o};return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.Table.Top10FilterApplied,e,r)}function ve(e,t,n,a){const o={tableName:t,columnName:n,color:a};return ie.ExcelEventConverter.makeGenericEvent(e,t,o)}function Te(e,t,n,a,o){const r={range:t.range,columnName:a,rangeType:t.rangeType,formatType:le.default.Custom,rule:n,customFormat:o},i=u.ExcelCalc.getIGeneralRangeOperationRange(t).sheet;return ie.ExcelEventConverter.makeGenericEvent(e,i,r)}function xe(e){const t={wholeSheet:!0,rangeType:e.rangeType,range:e.range},n=u.ExcelCalc.getIGeneralRangeOperationRange(e).sheet;return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.ConditionalFormatting.Deleted,n,t)}async function Se(e,t){let n=[],a=(0,N.BO)(e,"validationType");["date","decimal","textLength","time","wholeNumber"].includes(a)&&(a="basic");const o=we[a];n=await o(t,e);const i=[];if(n.length>0){const e={agent:r.w2.OfficeScripts,items:n};i.push(e)}return i}const we={list:async(e,t)=>{let n;const a=(0,N.Ru)(t,"source");if(void 0===a)throw new o.tF("Source is empty",t.name);void 0===(0,N.Ak)(t,"inCellDropDown")&&(n=!0);const r=Z(await Promise.all(e.map((async e=>{const t=function(e,t,n){const a={range:e.range,rangeType:e.rangeType,source:t,inCellDropDown:n},o=u.EventMethods.Range.DataValidationRuleListChanged,r=u.ExcelCalc.getIGeneralRangeOperationRange(e).sheet;return ie.ExcelEventConverter.makeGenericEvent(o,r,a)}(e,a,n);return[t]}))));return r},custom:async(e,t)=>{const n=(0,N.Ru)(t,"customFormula");if(void 0===n)throw new o.tF("Formula is empty",t.name);const a=Z(await Promise.all(e.map((async e=>{const t=function(e,t){const n={range:e.range,rangeType:e.rangeType,formula:t},a=u.EventMethods.Range.DataValidationRuleCustomChanged,o=u.ExcelCalc.getIGeneralRangeOperationRange(e).sheet;return ie.ExcelEventConverter.makeGenericEvent(a,o,n)}(e,n);return[t]}))));return a},basic:async(e,t)=>{let n;switch((0,N.BO)(t,"validationType")){case"date":n=u.EventMethods.Range.DataValidationRuleDateChanged;break;case"decimal":n=u.EventMethods.Range.DataValidationRuleDecimalChanged;break;case"textLength":n=u.EventMethods.Range.DataValidationRuleTextLengthChanged;break;case"time":n=u.EventMethods.Range.DataValidationRuleTimeChanged;break;case"wholeNumber":n=u.EventMethods.Range.DataValidationRuleWholeNumberChanged}const a=(0,N.Ru)(t,"formula1"),r=(0,N.Ru)(t,"formula2")??"",i=(0,N.BO)(t,"operator");if(void 0===a||void 0===i)throw new o.tF("Formula1 or Operator is empty",t.name);if(("Between"===i||"NotBetween"===i)&&""===r)throw new o.tF("Operator is ternary but formula2 is empty",t.name);const l=Z(await Promise.all(e.map((async e=>{const t=function(e,t,n,a,o){const r={range:t.range,rangeType:t.rangeType,formula1:n,formula2:a,operator:o},i=u.ExcelCalc.getIGeneralRangeOperationRange(t).sheet;return ie.ExcelEventConverter.makeGenericEvent(e,i,r)}(n,e,a,r,i);return[t]}))));return l}};var Ee=n(526524);function Ie(e,t,n){const a=(0,N.Ak)(t,"content")??!1,i=(0,N.Ak)(t,"format")??!1,l={agent:r.w2.OfficeScripts,items:[]};if((0,f.yw9)("OfficeVSO_9448487_fixClearContentFormatAndHyperlink")){for(const n of e)Re(l,t,n);return 0===l.items.length&&(0,o.VD)(t,e.length,[]),[l]}for(const t of e)a&&n&&(b(n,I)||b(n,R))&&l.items.push(Ce(Ee.default.ClearCells,t)),i&&l.items.push(Ce(Ee.default.ClearCellsFormat,t));return 0===l.items.length&&(0,o.VD)(t,e.length,[]),[l]}function Re(e,t,n){const a=(0,N.Ak)(t,"content")??!1,o=(0,N.Ak)(t,"format")??!1,r=(0,N.Ak)(t,"hyperlink")??!1,i=(0,N.Ak)(t,"all")??!1;a&&e.items.push(Ce(Ee.default.ClearCells,n)),o&&e.items.push(Ce(Ee.default.ClearCellsFormat,n)),r&&e.items.push(function(e,t){const n={command:e,rangeType:t.rangeType,range:t.range},a=u.ExcelCalc.getIGeneralRangeOperationRange(t).sheet;return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.Range.HyperlinkRemoved,a,n)}(Ee.default.ConvertLinkedEntitiesToText,n)),i&&e.items.push(Ce(Ee.default.ClearCellsAll,n))}async function Ae(e){return await Excel.run({delayForCellEdit:!0},(async t=>{t.workbook.tables.getItem(e.tableName).showHeaders=e.value,await t.sync()})),`I ${e.value?"set":"unset"} the header row on the table`}async function Le(e){return await Excel.run({delayForCellEdit:!0},(async t=>{t.workbook.tables.getItem(e.tableName).showTotals=e.value,await t.sync()})),`I ${e.value?"added":"removed"} a total row from the table`}async function ke(e){return await Excel.run({delayForCellEdit:!0},(async t=>{t.workbook.tables.getItem(e.tableName).showBandedRows=e.value,await t.sync()})),`I ${e.value?"added":"removed"} banded rows`}async function Fe(e){return await Excel.run({delayForCellEdit:!0},(async t=>{t.workbook.tables.getItem(e.tableName).showBandedColumns=e.value,await t.sync()})),`I ${e.value?"added":"removed"} banded columns`}async function _e(e){return await Excel.run({delayForCellEdit:!0},(async t=>{t.workbook.tables.getItem(e.tableName).showFilterButton=e.value,await t.sync()})),`I ${e.value?"added":"removed"} the filter button`}async function Pe(e){const{tableName:t,columnName:n,color:a}=e;return await Excel.run({delayForCellEdit:!0},(async e=>{const o=e.workbook.tables.getItem(t),r=o.getHeaderRowRange();r.load("values"),await e.sync();const i=r.values[0].indexOf(n);o.autoFilter.apply(o.getRange(),i,{filterOn:"CellColor",color:a}),await e.sync()})),`I applied a cell color filter on ${n} to show only rows that are highlighted ${a}`}async function Ne(e){const{tableName:t,columnName:n,color:a}=e;return await Excel.run({delayForCellEdit:!0},(async e=>{const o=e.workbook.tables.getItem(t),r=o.getHeaderRowRange();r.load("values"),await e.sync();const i=r.values[0].indexOf(n);o.autoFilter.apply(o.getRange(),i,{filterOn:"FontColor",color:a}),await e.sync()})),`I applied a font color filter on ${n} to show only rows that contain ${a} text `}async function Me(e){const t=e;let n=[];await Excel.run({delayForCellEdit:!0},(async e=>{const a=e.workbook.tables.getItem(t.tableName);a.sort.apply(t.fields,t.caseMatch,t.method);const o=a.getHeaderRowRange();o.load("values"),await e.sync(),n=o.values[0]}));const a=[];return t.fields.forEach((e=>((e,t)=>{if(e.key<n.length){let a=`${n[e.key]} column in `;"FontColor"===e.sortOn?a+="font color":"CellColor"===e.sortOn?a+="cell color":e.ascending?a+="ascending":a+="descending",a+=" order",t.push(a)}})(e,a))),0===a.length?"I sorted the table":`I sorted the table by ${a.join(", ")}`}async function Oe(e){const t=e;return await Excel.run({delayForCellEdit:!0},(async e=>{const n=e.workbook.tables.getItem(t.tableName),a=t.tableStyle;n.style="None"===a?null:t.tableStyle,await e.sync()})),`I applied the ${t.tableStyle} style to the table`}var De=n(39206),Be=n(892221);function $e(e,t){if(void 0===e)throw new o.tF("Limit1 is undefined!","filterTables");if(b(e,C))throw new o.tF("Invalid characters for custom filter in limit1","limit1");if(void 0!==t&&b(t,C))throw new o.tF("Invalid characters for custom filter in limit2","limit2")}function He(e,t){let n="";switch(e){case Be.default.Equals:n=`=${t}`;break;case Be.default.DoesNotEqual:n=`<>${t}`;break;case Be.default.BeginsWith:n=`=${t}*`;break;case Be.default.DoesNotBeginWith:n=`<>${t}*`;break;case Be.default.EndsWith:n=`=*${t}`;break;case Be.default.DoesNotEndWith:n=`<>*${t}`;break;case Be.default.Contains:n=`=*${t}*`;break;case Be.default.DoesNotContain:n=`<>*${t}*`;break;case Be.default.IsGreaterThan:n=`>${t}`;break;case Be.default.IsGreaterThenOrEqualTo:n=`>=${t}`;break;case Be.default.IsLessThen:n=`<${t}`;break;case Be.default.IsLessThanOrEqualTo:n=`<=${t}`;break;default:throw new Error(`CustomFilterCompareType '${e}' not implemented.`)}return n}function Ue(e,t,n){const a=""!==n;switch(e){case"equalTo":return{compareType:"N/A",value1:{valueCompareType:Be.default.Equals,value:t}};case"notEqualTo":return{compareType:"N/A",value1:{valueCompareType:Be.default.DoesNotEqual,value:t}};case"beginsWith":return{compareType:a?"Or":"N/A",value1:{valueCompareType:Be.default.BeginsWith,value:t},value2:a?{valueCompareType:Be.default.BeginsWith,value:n}:void 0};case"notBeginsWith":return{compareType:a?"And":"N/A",value1:{valueCompareType:Be.default.DoesNotBeginWith,value:t},value2:a?{valueCompareType:Be.default.DoesNotBeginWith,value:n}:void 0};case"endsWith":return{compareType:a?"Or":"N/A",value1:{valueCompareType:Be.default.EndsWith,value:t},value2:a?{valueCompareType:Be.default.EndsWith,value:n}:void 0};case"notEndsWith":return{compareType:a?"And":"N/A",value1:{valueCompareType:Be.default.DoesNotEndWith,value:t},value2:a?{valueCompareType:Be.default.DoesNotEndWith,value:n}:void 0};case"contains":return{compareType:a?"Or":"N/A",value1:{valueCompareType:Be.default.Contains,value:t},value2:a?{valueCompareType:Be.default.Contains,value:n}:void 0};case"notContains":return{compareType:a?"And":"N/A",value1:{valueCompareType:Be.default.DoesNotContain,value:t},value2:a?{valueCompareType:Be.default.DoesNotContain,value:n}:void 0};case"greaterThan":return{compareType:"N/A",value1:{valueCompareType:Be.default.IsGreaterThan,value:t}};case"greaterThanOrEqual":return{compareType:"N/A",value1:{valueCompareType:Be.default.IsGreaterThenOrEqualTo,value:t}};case"lessThan":return{compareType:"N/A",value1:{valueCompareType:Be.default.IsLessThen,value:t}};case"lessThanOrEqual":return{compareType:"N/A",value1:{valueCompareType:Be.default.IsLessThanOrEqualTo,value:t}};case"between":if(!n)throw new o.tF("Limit2 is undefined!","filterTables");return{compareType:"And",value1:{valueCompareType:Be.default.IsGreaterThenOrEqualTo,value:t},value2:{valueCompareType:Be.default.IsLessThanOrEqualTo,value:n}};case"notBetween":if(!n)throw new o.tF("Limit2 is undefined!","filterTables");return{compareType:"Or",value1:{valueCompareType:Be.default.IsLessThen,value:t},value2:{valueCompareType:Be.default.IsGreaterThan,value:n}};default:throw new Error(`Operator '${e}' not implemented.`)}}function qe(e){switch(e){case"Or":return Excel.FilterOperator.or;case"And":return Excel.FilterOperator.and;case"N/A":return}}var Ve=n(107357);const We={allDatesInPeriodJanuary:Ve.default.M1,allDatesInPeriodFebruary:Ve.default.M2,allDatesInPeriodMarch:Ve.default.M3,allDatesInPeriodApril:Ve.default.M4,allDatesInPeriodMay:Ve.default.M5,allDatesInPeriodJune:Ve.default.M6,allDatesInPeriodJuly:Ve.default.M7,allDatesInPeriodAugust:Ve.default.M8,allDatesInPeriodSeptember:Ve.default.M9,allDatesInPeriodOctober:Ve.default.M10,allDatesInPeriodNovember:Ve.default.M11,allDatesInPeriodDecember:Ve.default.M12,allDatesInPeriodQuarter1:Ve.default.Q1,allDatesInPeriodQuarter2:Ve.default.Q2,allDatesInPeriodQuarter3:Ve.default.Q3,allDatesInPeriodQuarter4:Ve.default.Q4,aboveAverage:Ve.default.AboveAverage,belowAverage:Ve.default.BelowAverage,lastMonth:Ve.default.LastMonth,lastQuarter:Ve.default.LastQuarter,lastWeek:Ve.default.LastWeek,lastYear:Ve.default.LastYear,nextMonth:Ve.default.NextMonth,nextQuarter:Ve.default.NextQuarter,nextWeek:Ve.default.NextWeek,nextYear:Ve.default.NextYear,thisMonth:Ve.default.ThisMonth,thisQuarter:Ve.default.ThisQuarter,thisWeek:Ve.default.ThisWeek,thisYear:Ve.default.ThisYear,today:Ve.default.Today,tomorrow:Ve.default.Tomorrow,yesterday:Ve.default.Yesterday,yearToDate:Ve.default.YearToDate,unknown:Ve.default.Nil};var Ge=n(670447),ze=n(92520);var Qe=n(141858);async function je(e,t,n,a){let r=!1,i=e;const l=await async function(e,t){try{return await Excel.run({delayForCellEdit:!0},(async n=>{const a=n.workbook.tables.getItem(e).columns.getItemAt(t).getDataBodyRange();return a.conditionalFormats.load("items"),await n.sync(),a.conditionalFormats.items.length>0}))}catch(e){throw(0,ze.cY)(ze.SA.Error,e),new o.tF("Failed to read if there is any conditional formatting applied to a range","hasConditionalFormattingApplied")}}(t,n);if(!l){const o=await(0,Qe.B)(t,n,a);try{i=(0,Ge.xq)(o,e),r=!0}catch{}}const c=[{key:s.Dh.EventType,value:s.Mv.GetFilterOrSortColor},{key:s.Dh.ColumnCFRApplied,value:l},{key:s.Dh.SortFilterColorFound,value:r}];return(0,D.j)(c),i}async function Je(e,t,n,a,r,i){let l=!1,c=a;const d=await async function(e,t,n){try{return await Excel.run({delayForCellEdit:!0},(async a=>{const o=a.workbook.worksheets.getItem(e).getRange(t).getColumn(n);return o.conditionalFormats.load("items"),await a.sync(),o.conditionalFormats.items.length>0}))}catch(e){throw(0,ze.cY)(ze.SA.Error,e),new o.tF("Failed to read if there is any conditional formatting applied to a range","getHasConditionalFormattingApplied")}}(e,t,n);if(!d){let s=await async function(e,t,n,a){const r="font"===a?"#000000":"#FFFFFF";try{return await Excel.run({delayForCellEdit:!0},(async o=>{const i=o.workbook.worksheets.getItem(e).getRange(t).getColumn(n),l={format:{[a]:{color:!0}}},s=i.getCellProperties(l);return await o.sync(),s.value.map((e=>e[0].format?.[a]?.color??r))}))}catch{throw new o.tF(`Failed to read the ${a} colors from table column.`,"getRangeColors")}}(e,t,n,r);try{s=i?s.slice(1):s,c=(0,Ge.xq)(s,a),l=!0}catch{}}const u=[{key:s.Dh.EventType,value:s.Mv.GetFilterOrSortColor},{key:s.Dh.ColumnCFRApplied,value:d},{key:s.Dh.SortFilterColorFound,value:l}];return(0,D.j)(u),c}var Ye=n(276329);const Xe=(0,f.k64)()&&(0,f.yw9)("OfficeVSO_9122912_HiTLTLRFilterOfficeJS");function Ze(e,t){if(!e.arguments.tables)throw new o.tF("No table specified.","filterTables");const n=t.getVariableArgumentValue(e,"tables");if("Table"!==n.entityType)throw new o.tF("Variable cache entity type mismatched!","clearFilters: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);const a=n.values[0],i=a.name,l=a.sheetRange.sheet,s=u.ExcelCalc.IExcelRangeToAddress(a.sheetRange.range),c=JSON.parse(a.headers),d=[];if(a.tableLikeRange){let t=[],n=[];try{t=Q.getTableColumnNames(a,e),n=U(a,t,e.name)}catch(e){const t=e;if(!t.isConverterError||t.failureType!==o.tJ.NoColumnArgument)throw e;d.push(function({sheetName:e,rangeAddress:t}){const n={entityName:e,entityType:"worksheets",changedDataDisplayName:t};return{method:r.wv.Worksheet.ClearFilter,args:n,func:De.We}}({sheetName:l,rangeAddress:s}))}return n.map((e=>{const t=Xe?u.ExcelCalc.IExcelRangeToAddress(u.ExcelCalc.columnFromIExcelAddress(a.sheetRange.range,e)):"";d.push(function({sheetName:e,rangeAddress:t,columnAddress:n,columnName:a,columnNumber:o}){const i={entityName:e,entityType:"worksheets",changedDataDisplayName:Xe?n:`column ${a||o+1} of ${t}`,columnIndex:o};return{method:r.wv.Worksheet.ClearColumnFilter,args:i,func:De.hf}}({sheetName:l,rangeAddress:s,columnAddress:t,columnNumber:e,columnName:c[e]}))})),0===d.length&&(0,o.VD)(e,n.length,[]),[{agent:r.w2.OfficeJS,items:d}]}let m=[];try{m=Q.getTableColumnNames(a,e)}catch(e){const t=e;if(!t.isConverterError||t.failureType!==o.tJ.NoColumnArgument)throw e;d.push(function(e){return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.Table.AutoFilterCleared,e,{})}(i))}return m.map((e=>d.push(function(e,t){const n={tableName:e,columnName:t};return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.Table.FilterCleared,e,n)}(i,e)))),0===d.length&&(0,o.VD)(e,m.length,[]),[{agent:r.w2.OfficeScripts,items:d}]}const Ke={CellColor:async(e,t,n,a)=>{const o=await je((0,N.wM)(a,"color"),e,n,"cell");return(0,f.avT)()||(0,f.k64)()?ve(u.EventMethods.Table.CellColorFilterApplied,e,t,o):{method:r.wv.Table.FilterColor,args:{tableName:e,columnName:t,color:o},func:Pe}},FontColor:async(e,t,n,a)=>{const o=await je((0,N.wM)(a,"color"),e,n,"font");return(0,f.avT)()||(0,f.k64)()?ve(u.EventMethods.Table.FontColorFilterApplied,e,t,o):{method:r.wv.Table.FilterColor,args:{tableName:e,columnName:t,color:await je((0,N.wM)(a,"color"),e,n,"font")},func:Ne}}};const et={Icon:()=>{throw new o.tF("Icon Not Implemented","FilterType")},BottomItems:(e,t,n)=>{const a=(0,N.mT)(n,"count");return Promise.resolve(ye(e,t,!1,Ye.default.Items,String(a)))},BottomPercent:(e,t,n)=>{const a=(0,N.mT)(n,"count");return Promise.resolve(ye(e,t,!1,Ye.default.Percent,String(a)))},TopItems:(e,t,n)=>{const a=(0,N.mT)(n,"count");return Promise.resolve(ye(e,t,!0,Ye.default.Items,String(a)))},TopPercent:(e,t,n)=>{const a=(0,N.mT)(n,"count");return Promise.resolve(ye(e,t,!0,Ye.default.Percent,String(a)))},Values:(e,t,n)=>{const a=(0,N.W7)(n,"values");return Promise.resolve(function(e,t,n){const a={tableName:e,columnName:t,values:n};return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.Table.ValuesFilterApplied,e,a)}(e,t,a))},Custom:async(e,t,n)=>{const a=ot(n,"limit1"),r=ot(n,"limit2")??"",i=(0,N.Am)(n,"operator");$e(a,r);const{compareType:l,value1:s,value2:c}=Ue(i,String(a),String(r)),d=await async function(e,t){return Excel.run((async n=>{try{let a=n.workbook.tables.getItem(e).columns.getItem(t).getDataBodyRange().load("rowCount");await n.sync();const o=100;a.rowCount>o&&(a=a.getResizedRange(o-a.rowCount,0)),a.load("values"),await n.sync();const r=a.values;let i=0,l=0,s=0;for(let e=0;e<r.length;++e){const t=r[e][0];i+="number"==typeof t?1:0,l+="string"==typeof t&&t.length>0?1:0,s+="boolean"==typeof t?1:0}const c=i+l+s;if(c<=0)return Promise.resolve("none");const d=.9;let u="none";return i/c>=d?u="number":l/c>=d?u="string":s/c>=d&&(u="bool"),Promise.resolve(u)}catch(e){return Promise.reject(new o.tF("Unable to determine if the column is string/numeric/bool","columnName"))}}))}(e,t);return"none"!==d&&function(e,t){switch(e){case"equalTo":case"notEqualTo":break;case"beginsWith":case"notBeginsWith":case"endsWith":case"notEndsWith":case"contains":case"notContains":if("string"!==t)throw new o.tF(`Applying a textual filter ${e} to a column that's not textual.`,"operandType",o.tJ.TextualFilterOnNonTextError);break;case"greaterThan":case"greaterThanOrEqual":case"lessThan":case"lessThanOrEqual":case"between":case"notBetween":if("number"!==t)throw new o.tF(`Applying a numeric filter ${e} to a column that's not numeric.`,"operandType",o.tJ.NumericFilterOnNonNumberError);break;default:throw new Error(`Operator '${e}' not implemented.`)}}(i,d),Promise.resolve(function(e,t,n,a,o){const r={tableName:e,columnName:t,compareType:n,value1:a,value2:o};return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.Table.CustomFilterApplied,e,r)}(e,t,l,s,c))},Dynamic:(e,t,n)=>{const a=function(e){if(void 0!==We[e])return We[e];throw new Error(`Criteria type '${e}' not supported`)}((0,N.Am)(n,"dynamicCriteria"));return Promise.resolve(function(e,t,n){const a={tableName:e,columnName:t,criteriaType:n};return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.Table.DynamicFilterApplied,e,a)}(e,t,a))}};function tt({filterType:e,sheetName:t,rangeAddress:n,columnAddress:a,columnIndex:o,columnName:i,filterCriteria:l}){const s={sheetName:t,rangeAddress:n,columnIndex:o,entityName:t,entityType:"worksheets",filteredDataDisplayName:Xe?a:`column ${i||o+1} of ${n}`,filterCriteria:{filterOn:e,...l}};return{method:r.wv.Worksheet.Filter[e],args:s,func:De.$h}}const nt={CellColor:e=>({color:(0,N.wM)(e,"color")}),FontColor:e=>({color:(0,N.wM)(e,"color")}),Icon:()=>{throw new o.tF("Icon Not Implemented","FilterType")},BottomItems:e=>{const t=(0,N.mT)(e,"count");return{criterion1:String(t)}},BottomPercent:e=>{const t=(0,N.mT)(e,"count");return{criterion1:String(t)}},TopItems:e=>{const t=(0,N.mT)(e,"count");return{criterion1:String(t)}},TopPercent:e=>{const t=(0,N.mT)(e,"count");return{criterion1:String(t)}},Custom:e=>{const t=ot(e,"limit1"),n=ot(e,"limit2")??"",a=(0,N.Am)(e,"operator");$e(t,n);const{compareType:o,value1:r,value2:i}=Ue(a,String(t),String(n));return{criterion1:He(r.valueCompareType,r.value),criterion2:i?He(i.valueCompareType,i.value):void 0,operator:qe(o)}},Dynamic:e=>{const t=function(e){let t=Excel.DynamicFilterCriteria[e];if(void 0!==t)return t;if("allDatesInPeriodFebruary"===e){const e="allDatesInPeriodFebruray";t=Excel.DynamicFilterCriteria[e]}return t}((0,N.Am)(e,"dynamicCriteria"));return{dynamicCriteria:t}},Values:e=>({values:(0,N.W7)(e,"values")})},at={Icon:()=>{throw new o.tF("Icon Not Implemented","FilterType")},BottomItems:()=>{throw new o.tF("BottomItems Not Implemented","FilterType")},BottomPercent:()=>{throw new o.tF("BottomPercent Not Implemented","FilterType")},TopItems:()=>{throw new o.tF("TopItems Not Implemented","FilterType")},TopPercent:()=>{throw new o.tF("TopPercent Not Implemented","FilterType")},Values:()=>{throw new o.tF("Values Not Implemented","FilterType")},Dynamic:()=>{throw new o.tF("Dynamic Not Implemented","FilterType")},CellColor:()=>{throw new o.tF("CellColor Not Implemented","FilterType")},FontColor:()=>{throw new o.tF("FontColor Not Implemented","FilterType")},Custom:async(e,t,n,a)=>{const o=ot(a,"limit1"),r=ot(a,"limit2")??"",i=(0,N.Am)(a,"operator");$e(o,r);const{compareType:l,value1:s,value2:c}=Ue(i,String(o),String(r));return Promise.resolve(function(e,t,n,a,o,r){const i={column:t,compareType:a,value1:o,value2:r,range:n};return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.Worksheet.CustomFilterApplied,e,i)}(e,t,n,l,s,c))}};function ot(e,t){let n;try{const a=(0,N.Q4)(e,t);if("string"===a)n=(0,N.Ru)(e,t);else if("number"===a){const a=(0,N.lI)(e,t);n=a?.toString()}}catch{}return n}var rt=n(936243),it=n(41490),lt=n(504786);async function st(e){const t=e,n=u.ExcelCalc.IExcelRangeToAddress(t.range.range);return Excel.run({delayForCellEdit:!0},(async e=>{const a=t.range;e.workbook.worksheets.getItem(a.sheet).getRange(n).load("format").format.adjustIndent(t.indentChange),await e.sync()})),`I adjusted in the indent on ${n} by ${t.indentChange} `}async function ct(e){const t=e,n=t.range,a=t.iconStyle,r=u.ExcelCalc.IExcelRangeToAddress(n.range);Excel.run({delayForCellEdit:!0},(async e=>{const t=e.workbook.worksheets.getItem(n.sheet).getRange(r).conditionalFormats.add(Excel.ConditionalFormatType.iconSet),i=function(e){switch(e){case Excel.IconSet.threeArrows:case Excel.IconSet.threeArrowsGray:case Excel.IconSet.threeFlags:case Excel.IconSet.threeTrafficLights1:case Excel.IconSet.threeTrafficLights2:case Excel.IconSet.threeSigns:case Excel.IconSet.threeSymbols:case Excel.IconSet.threeSymbols2:case Excel.IconSet.threeStars:case Excel.IconSet.threeTriangles:return[{formula:"=0",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent},{formula:"=33",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent},{formula:"=67",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent}];case Excel.IconSet.fourArrowsGray:case Excel.IconSet.fourArrows:case Excel.IconSet.fourTrafficLights:case Excel.IconSet.fourRedToBlack:case Excel.IconSet.fourRating:return[{formula:"=0",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent},{formula:"=25",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent},{formula:"=50",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent},{formula:"=75",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent}];case Excel.IconSet.fiveArrowsGray:case Excel.IconSet.fiveArrows:case Excel.IconSet.fiveQuarters:case Excel.IconSet.fiveRating:case Excel.IconSet.fiveBoxes:return[{formula:"=0",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent},{formula:"=20",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent},{formula:"=40",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent},{formula:"=60",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent},{formula:"=80",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent}];default:return[]}}(a);if(0===i.length)throw new o.tF("No icon set match to generate criteria","applyIconSetConditionalFormatting");t.iconSet.style=a,t.iconSet.criteria=i,t.iconSet.reverseIconOrder=!1,t.iconSet.showIconOnly=!1,await e.sync()}));return`I created an icon set conditional formatting rule using ${lt.IJ[a]} on ${r}.`}async function dt(e){const t=e;await Excel.run({delayForCellEdit:!0},(async e=>{e.workbook.worksheets.getItem(t.sheetName).getRange(t.rangeAddress).sort.apply(t.fields,t.caseMatch,t.hasHeaders,t.orientationString,t.method)}));const n=[],a=[];if(t.fields.forEach((e=>((e,n,a)=>{if((0,f.yw9)("OfficeVSO_9173844_AddSortRangeTelemetry")?e.key>=0:e.key){let o=`${t.headers?.[e.key]} column in `;"FontColor"===e.sortOn?o+="font color":"CellColor"===e.sortOn?o+="cell color":e.ascending?o+="ascending":o+="descending",o+=" order",n.push(o),(0,f.yw9)("OfficeVSO_9173844_AddSortRangeTelemetry")&&a.push(e.key)}})(e,n,a))),(0,f.yw9)("OfficeVSO_9173844_AddSortRangeTelemetry")){const e=[{key:s.Dh.EventType,value:s.Mv.LogSortRangeAddress},{key:s.Dh.SortRangeAddress,value:t.rangeAddress},{key:s.Dh.SortColumnIndex,value:a.join(", ")}];(0,D.j)(e)}return 0===n.length?"I sorted the table":`I sorted the table by ${n.join(", ")}`}async function ut(e,t,n,a){if(a&&b(a,E))throw new o.tF("Clear sort is not supported",e.name,o.tJ.ClearSortUnsupported);if(!e.arguments.tables)throw new o.tF("No table specified.","tables");const i=t.getVariableArgumentValue(e,"tables").values[0];let l=u.ExcelCalc.IExcelRangeToAddress(i.sheetRange.range);const s=i.sheetRange.sheet,c=n.length>0?n[n.length-1]:void 0,d=c&&c.items.length>0?c.items[c.items.length-1]:void 0;let m=!1;if(d)if(d.method===r.wv.Range.Sort){const e=d.args;m=e.rangeAddress===l&&e.sheetName===i.sheetRange.sheet}else if((0,f.avT)()&&d.method===u.EventMethods.Table.CustomSorted)m=d.entityId===i.name;else if(d.method===r.wv.Table.Sort){m=d.args.tableName===i.name}const g=(0,N.Ak)(e,"ascending")??(0,it.VL)("isAscending"),h=(0,N.Ak)(e,"caseMatch")??(0,it.VL)("caseMatch"),p=(0,N.Jh)(e,"fontColor"),C=(0,N.Jh)(e,"cellColor"),y=Q.getTableColumnNumber(e,i),v={key:y,ascending:g},T=(0,N.Ru)(e,"columnName"),x={columnIndex:y,columnName:T||"",isAscending:g};if(p&&C)throw new o.tF("Cannot sort by both font and cell color for a column!","color");if(p){let e;e=i.tableLikeRange?await Je(s,l,y,p,"font",!0):await je(p,i.name,y,"font"),v.color=e,v.sortOn="FontColor",x.sortOnColor={sortOn:rt.SortOn.fontColor,color:e}}else if(C){let e;e=i.tableLikeRange?await Je(s,l,y,C,"fill",!0):await je(C,i.name,y,"cell"),v.color=e,v.sortOn="CellColor",x.sortOnColor={sortOn:rt.SortOn.cellColor,color:e}}if(m){if((0,f.avT)()&&!i.tableLikeRange){d.parameters.sharedSortConditions.push(x)}else{const e=d.args;if(h!==e.caseMatch)throw new o.tF("Cannot have different caseMatch settings while sorting by multiple columns!","caseMatch");e.fields.push(v)}return[]}{let t;if(i.tableLikeRange){const e=JSON.parse(i.headers);if(!(0,f.yw9)("OfficeVSO_9136744_HiTLTLRSortOfficeJS")&&(0,f.yw9)("OfficeVSO_9080495_FixTLRWithHiTL")&&(0,f.k64)()){const n=i.sheetRange.range.topLeft.row,a=i.sheetRange.range.bottomRight.row,o={sheet:s,range:{topLeft:{row:e.length>0&&null!==n?n+1:n,column:i.sheetRange.range.topLeft.column},bottomRight:{row:i.totalRow&&null!==a?a-1:a,column:i.sheetRange.range.bottomRight.column}}},l=i.sheetRange.range.topLeft.column?i.sheetRange.range.topLeft.column+y:y,c=e.length>0&&null!==n?n+1:n,d={hasHeader:!1,caseSensitive:h,ascending:g,activeCell:{sheet:s,range:{topLeft:{row:c,column:l},bottomRight:{row:c,column:l}}},rangeType:u.RangeType.ExcelSheetRange,range:o};t={agent:r.w2.OfficeScripts,items:[u.ExcelEventConverter.makeGenericEvent(u.EventMethods.Range.Sorted,s,d)]}}else l=(0,f.tgf)()&&i.totalRow?re(i.sheetRange.range):l,t={agent:r.w2.OfficeJS,items:[{method:r.wv.Range.Sort,args:{sheetName:s,rangeAddress:l,fields:[v],caseMatch:h,hasHeaders:e.length>0,orientationString:Excel.SortOrientation.rows,headers:e},func:dt}]}}else if((0,f.avT)()||(0,f.k64)()){const e={tableName:i.name,isCaseSensitive:h,sharedSortConditions:[x]};t={agent:r.w2.OfficeScripts,items:[u.ExcelEventConverter.makeGenericEvent(u.EventMethods.Table.CustomSorted,i.name,e)]}}else t={agent:r.w2.OfficeJS,items:[{method:r.wv.Table.Sort,args:{tableName:i.name,fields:[v],caseMatch:h},func:Me}]};return 0===t.items.length&&(0,o.VD)(e,1,[]),[t]}}function mt(e,t){const n=t.getVariableArgumentValue(e,"tables");if("Table"!==n.entityType)throw new o.tF("Variable cache entity type mismatched!","clearingSort: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);const a=n.values[0],i=a.name,l=[];if(a.tableLikeRange)throw new o.tF("Clear sort is not supported for Table like Ranges",e.name,o.tJ.ClearSortUnsupported);return((0,f.avT)()||(0,f.k64)())&&l.push(function(e){return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.Table.SortCleared,e,{})}(i)),0===l.length&&(0,o.VD)(e,1,[]),[{agent:r.w2.OfficeScripts,items:l}]}function gt(e){const t=function(e){const t=function(e){let t;try{const n=(0,N.Q4)(e,"underline");"boolean"===n?t=(0,N.Ak)(e,"underline"):"string"===n&&(t=(0,N.BO)(e,"underline"))}catch{}return t}(e);let n=(0,it.sR)("defaultCustomFormat").IsTextUnderlined,a=(0,it.sR)("defaultCustomFormat").IsTextDoubleUnderlined;switch(t){case!0:case"Single":n=!0,a=!1;break;case"Double":n=!1,a=!0;break;case!1:n=!1,a=!1}const o={isTextUnderlined:n,isTextDoubleUnderlined:a};return o}(e),n=function(e){const t=(0,N.Lb)(e,"borderEdges"),n=(0,N.BO)(e,"borderStyle"),a=n?u.BorderLineStyle[n]:(0,it.sR)("BorderStyle"),o=(0,N.Jh)(e,"borderColor"),r=o?(0,Ge.yc)(o):(0,it.sR)("defaultCustomFormat").borderColor,i=(0,Ge.EQ)(r);let l=[u.BorderLineStyle.None,u.BorderLineStyle.None,u.BorderLineStyle.None,u.BorderLineStyle.None],s=[0,0,0,0];for(let e=0;e<t.length;e++){switch(t[e]){case"Top":l[0]=a,s[0]=i;break;case"Bottom":l[1]=a,s[1]=i;break;case"Left":l[2]=a,s[2]=i;break;case"Right":l[3]=a,s[3]=i;break;case"Horizontal":l[0]=a,s[0]=i,l[1]=a,s[1]=i;break;case"Vertical":l[2]=a,s[2]=i,l[3]=a,s[3]=i;break;case"Inside":case"Outside":case"All":s=[i,i,i,i],l=[a,a,a,a]}}const c={Position:(0,it.sR)("defaultCustomFormat").BorderFormat.Position,LineStyle:l,Color:s,ThemeBorderColor:(0,it.sR)("defaultCustomFormat").BorderFormat.ThemeBorderColor,ColorTypeOption:(0,it.sR)("defaultCustomFormat").BorderFormat.ColorTypeOption,Thickness:(0,it.sR)("defaultCustomFormat").BorderFormat.Thickness};return c}(e),a=(0,N.Jh)(e,"fillColor"),o=(0,N.Jh)(e,"fontColor"),r=(0,N.Ak)(e,"bold"),i=(0,N.Ak)(e,"italic"),l=(0,N.Ak)(e,"strikethrough"),s=t.isTextUnderlined,c=t.isTextDoubleUnderlined,d={BackgroundColor:a??null,TextColor:o??(0,it.sR)("defaultCustomFormat").TextColor,IsTextBold:r??(0,it.sR)("defaultCustomFormat").IsTextBold,IsTextItalic:i??(0,it.sR)("defaultCustomFormat").IsTextItalic,IsTextStrikethrough:l??(0,it.sR)("defaultCustomFormat").IsTextStrikethrough,IsTextUnderlined:s,IsTextDoubleUnderlined:c,BorderFormat:n,PreserveBackgroundColor:(0,it.sR)("defaultCustomFormat").PreserveBackgroundColor,PreserveTextColor:(0,it.sR)("defaultCustomFormat").PreserveTextColor};let m=!0;const g=n.LineStyle,h=n.Color;for(let e=0;e<g.length;e++)g[e]===u.BorderLineStyle.None&&0===h[e]||(m=!1);return void 0!==a||void 0!==o||r||i||l||s||c||!m||(d.BackgroundColor=(0,it.sR)("defaultBackgroundColor")),d}function ht(e,t){let n;try{const a=(0,N.Q4)(e,t);"string"===a?n=(0,N.Ru)(e,t):"number"===a&&(n=(0,N.lI)(e,t))}catch{}return n}function pt(e){return"number"==typeof e?[`=${e}`,lt.c$.Number]:b(e,y)?[`=DATEVALUE("${e}")`,lt.c$.Date]:b(e,v)?[`=${e}`,lt.c$.Number]:[`="${e}"`,lt.c$.Text]}function bt(e){const t=(0,N.BO)(e,"icon");if(void 0===t)throw new o.tF("Icon style is undefined!");const n=lt.Yl[t];if(!n)throw new o.tF(`Could not find matching ConditionalFormattingCommand for icon style: ${t}!`);return n}function ft(e){return{unique:e,shouldGenerateGetRule:(0,it.sR)("shouldGenerateGetRule")}}function Ct(e){const t=lt.FN[e];if(!t)throw new o.tF(`Cannot find ConditionalFormattingTimePeriodType for preset criterion: ${e}`);return{timePeriodType:t,shouldGenerateGetRule:(0,it.sR)("shouldGenerateGetRule")}}function yt(e){const t=lt.t0[e];if(!t)throw new o.tF(`Cannot find ConditionalFormattingCommand for preset criterion: ${e}`);return{criterion:t,shouldGenerateGetRule:(0,it.sR)("shouldGenerateGetRule")}}async function vt(e,t){return function(e,t,n){let a;if(t){const t=e.map((e=>xe(e)));a={agent:r.w2.OfficeScripts,items:t},0===t.length&&(0,o.VD)(n,e.length,[])}else a={agent:r.w2.UnsupportedEvent,items:[r.DH.Formatting]};return[a]}(ae(e,t),(0,N.Ak)(e,"clearConditionalFormat")??!1,e)}async function Tt(e,t,n){let a=(0,N.BO)(e,"conditionalFormatType");!a&&(0,N.BO)(e,"formulaString")&&(a="Formula");const i=(0,N.Ak)(e,"clearConditionalFormat")??!1,l=[];let c=[],d=[];!function(e,t){return!xt[e]&&!St[e]&&!t}(a,i)?i?c=t.map((e=>xe(e))):(Object.keys(xt).includes(a)&&(c=Z(await Promise.all(t.map((async t=>{const o=xt[a](t,e,n),r=await async function(e){const t=await async function(e,t){return Excel.run({delayForCellEdit:!0},(async n=>{const a=u.ExcelCalc.IExcelRangeToAddress(u.ExcelCalc.getIGeneralRangeOperationRange(e).range),o=u.ExcelCalc.getIGeneralRangeOperationRange(e).sheet,r=n.workbook.worksheets.getItem(o).getRange(a).load("conditionalFormats");await n.sync();const i=r.conditionalFormats;return t?i.items.filter((e=>e.type===t)).map((e=>e.priority)):i.items.map((e=>e.priority))}))}(e);let n=0;t&&0!==t.length&&(n=t[t.length-1]+1);return function(e,t){const n=u.ExcelCalc.getIGeneralRangeOperationRange(e).sheet,a={oldIndex:t,newIndex:0,isCurrentFilterWorksheet:!1,filterRange:[e]};return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.ConditionalFormatting.PriorityEdited,n,a)}(e,n)}(t);return[o,r]}))))),!(0,f.avT)()&&(0,f.k64)()||!Object.keys(St).includes(a)||(d=Z(t.map((t=>St[a](t,e,n)))))):(l.push(a),function(e){const t=[{key:s.Dh.EventType,value:s.Mv.LogUnsupportConditionalFormatType},{key:s.Dh.UnsupportedConditionalFormatType,value:e}];(0,D.j)(t)}(a));const m=[];if(c.length>0){const e={agent:r.w2.OfficeScripts,items:c};m.push(e)}if(d.length>0){const e={agent:r.w2.OfficeJS,items:d};m.push(e)}!function(e,t,n,a,r){const i=e.every((e=>0===e.items.length));i&&(0,o.VD)(t,n.length,a?[]:r)}(m,e,t,!1,l);const g=[{key:s.Dh.EventType,value:s.Mv.ConditionalFormatEvent},{key:s.Dh.CFRuleType,value:a}];return(0,D.j)(g),m}const xt={CellValue:(e,t,n)=>{const a=function(e){const t=ht(e,"cellValue1"),n=ht(e,"cellValue2"),a=void 0===t?ht(e,"limit1"):t,r=void 0===n?ht(e,"limit2"):n,i=(0,N.BO)(e,"cellValueOperator");if(void 0===a)throw new o.tF("Limit 1 is undefined!");if(void 0===i)throw new o.tF("Cell value operator is undefined!");const l=lt.RR[i];if(!l)throw new o.tF(`Cannot find matching ConditionalFormatCommand for operator: ${i}!`);if(b(String(a),C))throw new o.tF("Invalid characters for cell value conditional formatting in limit1","limit1");if(void 0!==r&&b(String(r),C))throw new o.tF("Invalid characters for cell value conditional formatting in limit2","limit2");const s=pt(a),c=s[0],d=void 0!==r?pt(r):void 0;return{cellValueRule:{formula1:c,formula2:d?d[0]:void 0,operator:l,shouldGenerateGetRule:(0,it.sR)("shouldGenerateGetRule")},formulaCategory:s[1]}}(t).cellValueRule,r=gt(t);return Te(u.EventMethods.ConditionalFormatting.CellValueCreated,e,a,n,r)},ContainsText:(e,t,n)=>{const a=function(e){const t=(0,N.BO)(e,"textOperator"),n=(0,N.Ru)(e,"text");if(void 0===t)throw new o.tF("composeTextComparisonRule: operator is undefined!");if(void 0===n)throw new o.tF("composeTextComparisonRule: text is undefined!");const a=lt.$J[t];if(!a)throw new o.tF(`Cannot find matching ConditionalFormatCommand for text operator: ${t}!`);if(b(n,C))throw new o.tF("Invalid characters for text comparison conditional formatting!",e.name);return{operator:a,text:n,shouldGenerateGetRule:(0,it.sR)("shouldGenerateGetRule")}}(t),r=gt(t);return Te(u.EventMethods.ConditionalFormatting.TextComparisonCreated,e,a,n,r)},Preset:(e,t,n)=>{const a=function(e){const t=(0,N.BO)(e,"presetCriterion");if(!t)throw new o.tF("No presetCriterion on statement!");let n,a={};switch(t){case"uniqueValues":a={method:u.EventMethods.ConditionalFormatting.UniqueCreated,rule:ft(!0)},n=lt.fP.UniqueDuplicate;break;case"duplicateValues":a={method:u.EventMethods.ConditionalFormatting.UniqueCreated,rule:ft(!1)},n=lt.fP.UniqueDuplicate;break;case"lastMonth":case"lastSevenDays":case"lastWeek":case"nextMonth":case"nextWeek":case"thisMonth":case"thisWeek":case"today":case"tomorrow":a={method:u.EventMethods.ConditionalFormatting.DatesCreated,rule:Ct(t)},n=lt.fP.TimePeriod;break;case"aboveAverage":case"belowAverage":case"equalOrAboveAverage":case"equalOrBelowAverage":a={method:u.EventMethods.ConditionalFormatting.PresetCreated,rule:yt(t)},n=lt.fP.OtherPresetsNumber;break;case"blanks":case"nonBlanks":case"errors":case"nonErrors":case"invalid":a={method:u.EventMethods.ConditionalFormatting.PresetCreated,rule:yt(t)},n=lt.fP.OtherPresetsGeneral;break;default:throw new o.tF(`Cannot find matching rule composer for criteria: ${t}!`)}return[a,n]}(t),r=gt(t),i=a[0];return Te(i.method,e,i.rule,n,r)},TopBottom:(e,t,n)=>{const a=function(e){const t=(0,N.BO)(e,"topBottomType")??(0,it.sR)("topBottomType"),n=(0,N.lI)(e,"topBottomRank")??(0,it.sR)("topBottomRank"),a=lt.ZA[t];if(!a)throw new o.tF(`Cannot find matching ConditionalFormatCommand for top/bottom type: ${t}!`);return{rank:n,type:a,shouldGenerateGetRule:(0,it.sR)("shouldGenerateGetRule")}}(t),r=gt(t);return Te(u.EventMethods.ConditionalFormatting.TopBottomCreated,e,a,n,r)},ColorScale:(e,t,n)=>{const a=function(e){const t=(0,N.Jh)(e,"minimumColor"),n=(0,N.Jh)(e,"midpointColor"),a=(0,N.Jh)(e,"maximumColor");if((0,f.yw9)("DefaultColorScales"))return{minimumColor:t?(0,it.L7)(t):(0,it.sR)("minimumColor"),midpointColor:n?(0,it.L7)(n):(0,it.sR)("midpointColor"),maximumColor:a?(0,it.L7)(a):(0,it.sR)("maximumColor"),maximumCFObjectValues:(0,it.sR)("maximumCFObjectValues"),midpointCFObjectValues:n?(0,it.sR)("midpointCFObjectValues"):null,minimumCFObjectValues:(0,it.sR)("minimumCFObjectValues")};return{minimumColor:t??(0,it.sR)("minimumColorDeprecated"),midpointColor:n??(0,it.sR)("midpointColor"),maximumColor:a??(0,it.sR)("maximumColorDeprecated"),maximumCFObjectValues:(0,it.sR)("maximumCFObjectValues"),midpointCFObjectValues:n?(0,it.sR)("midpointCFObjectValuesDeprecated"):null,minimumCFObjectValues:(0,it.sR)("minimumCFObjectValues")}}(t);return function(e,t,n){const a={range:e.range,columnName:n,rangeType:e.rangeType,colorScaleFormat:t},o=u.ExcelCalc.getIGeneralRangeOperationRange(e).sheet;return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.ConditionalFormatting.ColorScaleCustomCreated,o,a)}(e,a,n)},DataBar:(e,t,n)=>{const a=function(e){const t=(0,N.Jh)(e,"dataBarColor");return{isGradientFill:(0,N.Ak)(e,"dataBarGradient")??(0,it.sR)("isGradientFill"),borderColor:(0,it.sR)("borderColor"),fillColor:t??(0,it.sR)("fillColor"),isLTRDirection:(0,it.sR)("isLTRDirection"),isNegativeValuesFillColorCustom:(0,it.sR)("isNegativeValuesFillColorCustom"),negativeValuesFillColor:t??(0,it.sR)("negativeValuesFillColor"),isNegativeValuesBorderColorCustom:(0,it.sR)("isNegativeValuesBorderColorCustom"),negativeValuesBorderColor:(0,it.sR)("negativeValuesBorderColor"),isShowValueEnabled:(0,it.sR)("isShowValueEnabled"),axisColor:(0,it.sR)("axisColor"),axisPositionType:(0,it.sR)("axisPositionType"),minBoundCFObjectValues:(0,it.sR)("minBoundCFObjectValues"),maxBoundCFObjectValues:(0,it.sR)("maxBoundCFObjectValues")}}(t);return function(e,t,n){const a={range:e.range,columnName:n,rangeType:e.rangeType,dataBarFormat:t},o=u.ExcelCalc.getIGeneralRangeOperationRange(e).sheet;return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.ConditionalFormatting.DataBarCustomCreated,o,a)}(e,a,n)},IconSet:(e,t,n)=>{const a=function(e){const t=(0,N.BO)(e,"icon");if(void 0===t)throw new o.tF("Icon style is undefined!");const n=lt.nr[t];if(!n)throw new o.tF(`Could not find matching ConditionalFormattingCommand for icon style: ${t}!`);return n}(t);return function(e,t){const n={range:e.range,rangeType:e.rangeType,style:t},a=u.ExcelCalc.getIGeneralRangeOperationRange(e).sheet;return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.ConditionalFormatting.IconSetCreated,a,n)}(e,a)},Formula:(e,t,n)=>{const a=function(e){const t=(0,N.BO)(e,"formulaString"),n=(0,N.BO)(e,"formulaExplanation");if(!t||""===t)throw new o.tF("Cannot compose custom rule with undefined or empty formula",e.name,o.tJ.ConditionalFormatFormulaInvalid);if((0,f._NB)()&&(!n||""===n))throw new o.tF("Cannot compose custom rule with formula explanation",e.name,o.tJ.ConditionalFormatFormulaExplanationInvalid);return{formula:t,localFormula:!0,formulaExplanation:n,shouldGenerateGetRule:(0,it.sR)("shouldGenerateGetRule")}}(t),r=gt(t);return Te(u.EventMethods.ConditionalFormatting.CustomCreated,e,a,n,r)}},St={IconSet:(e,t,n)=>({method:r.wv.ConditionalFormatting.ApplyIconSetConditionalFormatting,args:{range:u.ExcelCalc.getIGeneralRangeOperationRange(e),iconStyle:bt(t)},func:ct})};async function wt(e,t,n){if(void 0===e.arguments.tables)throw new o.tF("No table specified.","tables");const a={func:"conditionalFormatSuggestion",args:[t.getVariableArgumentValue(e,"tables").values[0].name,n]};return[{agent:r.w2.ConditionalFormatSuggestion,items:[a]}]}var Et=n(983138),It=n(99415);function Rt(e,t){return e.map((e=>e.map((e=>""===e?t:e))))}function At(e,t){const n=e.range.topLeft,a=e.range.bottomRight;if(null===n.column||null===a.column)return null;if((t=t>=0?t:a.column-n.column+t+1)<0||n.column+t>a.column)return null;return{rangeType:u.RangeType.ExcelSheetRange,range:{sheet:e.sheet,range:{topLeft:{row:n.row,column:n.column+t},bottomRight:{row:a.row,column:n.column+t}}}}}async function Lt(e){return Excel.run({delayForCellEdit:!0},(async t=>{const n=u.ExcelCalc.IExcelRangeToAddress(e.range),a=t.workbook.worksheets.getItem(e.sheet).getRange(n);return a.load("values"),await t.sync(),a.values}))}function kt(e,t){const n=e.range.topLeft,a=e.range.bottomRight;if(null===n.row||null===a.row)return null;if((t=t>=0?t:a.row-n.row+t+1)<0||n.row+t>a.row)return null;return{rangeType:u.RangeType.ExcelSheetRange,range:{sheet:e.sheet,range:{topLeft:{row:n.row+t,column:n.column},bottomRight:{row:n.row+t,column:a.column}}}}}async function Ft(e,t){const n=function(e){try{const t=(0,N.Q4)(e,"searchString");if("string"===t)return(0,N.C3)(e,"searchString");if("number"===t){return(0,N.mT)(e,"searchString").toString()}throw new o.Dd(`Argument "searchString" type ${t} should be string or number on ${e.name}`,o.vb.ArgumentTypeMismatch,t,"string | number")}catch(e){if(e.isStatementArgumentError&&e.reason===o.vb.ArgumentUndefined)return;throw e}}(e)??"",a=function(e){const t=(0,N.dQ)(e,"replaceWith");if(void 0===t)return"";if("string"===t)return(0,N.C3)(e,"replaceWith");if("number"===t){return(0,N.mT)(e,"replaceWith").toString()}throw new o.Dd(`Argument "replaceWith" type ${t} should be string or number on ${e.name}`,o.vb.ArgumentTypeMismatch,t,"string | number")}(e),i=(0,N.Ak)(e,"completeMatch")??!1,l=(0,N.Ak)(e,"matchCase")??!1,s={agent:r.w2.OfficeScripts,items:[]};for(const e of t)try{if((0,f.yw9)("OfficeVSO_9033826_SearchReplaceEmptyCellStrings")||(0,f.avT)()||""!==n)s.items.push(fe(n,a,i,l,e));else{const t=Rt(await Lt(u.ExcelCalc.getIGeneralRangeOperationRange(e)),a);s.items.push(se(t,u.ExcelCalc.getIGeneralRangeOperationRange(e)))}}catch{(0,D.R)(new o.tF("Failed to compose replace all event for range.","replaceRangesCommon"))}return 0===s.items.length&&(0,o.VD)(e,t.length,[]),[s]}function _t(e,t){let n=0;const a=e[t];for(let o=0;o<t;o++)e[o]===a&&n++;return n}var Pt=n(543435);async function Nt(e){const t=e,n=u.ExcelCalc.IExcelRangeToAddress(t.range.range);return Excel.run({delayForCellEdit:!0},(async e=>{const a=t.range;e.workbook.worksheets.getItem(a.sheet).getRange(n).load("format/useStandardHeight").format.useStandardHeight=!0,await e.sync()})),`I removed the autofit on rows(s) in ${n}.`}async function Mt(e){const t=e,n=u.ExcelCalc.IExcelRangeToAddress(t.range.range);return Excel.run({delayForCellEdit:!0},(async e=>{const a=t.range;e.workbook.worksheets.getItem(a.sheet).getRange(n).load("format/useStandardWidth").format.useStandardWidth=!0,await e.sync()})),`I removed the autofit on column(s) in ${n}.`}async function Ot(e,t){return Excel.run({delayForCellEdit:!0},(async n=>{const a=n.workbook.worksheets.getItem(t.sheet).getRange(u.ExcelCalc.IExcelRangeToAddress(t.range)).getCell(0,0).load("format/font");await n.sync();const r=a.format.font.size,i=function(e,t){const n=(0,N.Q4)(e,t);if("string"===n)return(0,N.Am)(e,t);if("number"===n)return(0,N.mT)(e,t);throw new o.Dd(`Argument ${t} type ${n} should be enum or number on ${e.name}`,o.vb.ArgumentTypeMismatch,n,"enum | number")}(e,"size");return function(e,t){return"Increase"===t?e+(0,it.Si)("fontSizeChange"):"Decrease"===t?e-(0,it.Si)("fontSizeChange"):t}(r,i)}))}const Dt={true:"single",false:"none",None:"none",Single:"single",Double:"double",SingleAccountant:"singleAccountant",DoubleAccountant:"doubleAccountant"};var Bt=n(528003),$t=n(584384),Ht=n(191038),Ut=n(54947);async function qt(e,t,n){if(!e.arguments.tables)throw new o.tF("No table specified.","tables");const a=t.getVariableArgumentValue(e,"tables");if("Table"!==a.entityType)throw new o.tF("Variable cache entity type mismatched!","formatTables: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);const i=a.values[0];let l;l=K(i.sheetRange);const s=i.tableLikeRange?Pt.lp.TableLikeRange:Pt.lp.StandardTable;if(((0,f.avT)()||(0,f.yw9)("OfficeVSO_9404079_FixFormattingIntentStringTableWithTotalRow"))&&(0,g.En)(i)&&(l={rangeType:Et.RangeType.TableRange,range:{subRange:u.TableRangeOperationSubRange.Body,tableName:i.name,gridRange:l.range}}),!i?.headers)throw new o.tF("Invalid table data");const c=JSON.parse(i.headers);if(!Array.isArray(c)||0===c.length)throw new o.tF("Invalid table headers");const{topLeft:d,bottomRight:m}=u.ExcelCalc.getIGeneralRangeOperationRange(l).range,{column:h,row:p}=d,{column:b,row:C}=m,y=i.numColumns,v=i.numRows;let T="";if(null===h||null===b||null===p||null===C)throw null!==h&&(T+=c[h]),new o.tF("Range having incomplete row and/or column data.");if(y===b-h+1&&v===C-p+1)T=(0,f.yw9)("OfficeVSO_9125590_bugFixTLRWholeTableLabel")&&(0,f.k64)()&&i.tableLikeRange?"":Ut.G.O;else{const e=[];for(let t=h;t<=b;t++)e.push(`'${c[t]}'`);T+=e.join(", ")}const x=await jt(e,[l],!1,T);return x.push(...function(e,t,n,a){const o=[];if((0,f.avT)()||(0,f.k64)()){if(n===Pt.lp.TableLikeRange&&void 0!==(0,N.Ak)(e,"totalRow")){const t={agent:r.w2.UnsupportedEvent,items:[r.DH.Formatting]};o.push(t),delete e.arguments.totalRow}const i=Object.keys(Qt).filter((t=>void 0!==e.arguments[t])).map((n=>Qt[n](t,e,a))),l={agent:r.w2.OfficeScripts,items:Z(i)};l.items.length>0&&o.push(l)}else{const n=Object.keys(zt).filter((t=>void 0!==e.arguments[t])).map((n=>(0,zt[n])(t,e,n,a))),i={agent:r.w2.OfficeJS,items:n};i.items.length>0&&o.push(i)}return o}(e,i.name,s,n)),Jt(x,e,[l]),x}async function Vt(e,t){const n=function(e,t){if(void 0===e.arguments.columns)throw new o.tF("No columns specified.",e.name);const n=t.getVariableArgumentValue(e,"columns");if("Column"!==n.entityType)throw new o.tF("Variable cache entity type mismatched!","getFullResolvedColumnRanges: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);return{columnRanges:n.values.ranges,fullColumnRanges:n.values.fullRanges}}(e,t),a=n.columnRanges,r=n.fullColumnRanges,i=function(e,t){try{return oe(e,t)}catch{return}}(e,t),l=await jt(e,a,!0,i,r);return Jt(l,e,a),l}const Wt={autofit:(e,t,n)=>{void 0!==t&&(t="autofit_defaultValue");return(0,N.zI)(n,"autofit")?function(e,t){switch(t.name){case"formatColumns":return[pe(u.EventMethods.Range.ColumnsAutoFit,e)];case"formatRows":return[pe(u.EventMethods.Range.RowsAutoFit,e)];default:{const t=[];return t.push(pe(u.EventMethods.Range.ColumnsAutoFit,e)),t.push(pe(u.EventMethods.Range.RowsAutoFit,e)),t}}}(e,n):(0,f.avT)()||(0,f.k64)()?function(e,t){switch(t.name){case"formatColumns":return[be(u.EventMethods.Range.UseStandardWidth,e)];case"formatRows":return[be(u.EventMethods.Range.UseStandardHeight,e)];default:{const t=[];return t.push(be(u.EventMethods.Range.UseStandardWidth,e)),t.push(be(u.EventMethods.Range.UseStandardHeight,e)),t}}}(e,n):[]},bold:(e,t,n)=>{const a=(0,N.zI)(n,"bold");return de(u.EventMethods.Font.Bolded,a,e,t)},borderEdges:(e,t,n)=>{const a=(0,N.Lb)(n,"borderEdges"),o=[];if(0!==a.length){const r=function(e,t,n){const a=[],o=t||(0,it.Si)("borderColor"),r=(0,Ge.EQ)((0,Ge.yc)(o));let i=u.BorderLineStyle[n];void 0===i&&(i=(0,it.Si)("borderStyle"));for(const t of e){const e={border:u.BorderTypes[t],color:r,lineStyle:i};a.push(e)}return a}(a,(0,N.Jh)(n,"borderColor"),(0,N.BO)(n,"borderStyle"));r.map((n=>o.push(de(u.EventMethods.Border.BorderChanged,n,e,t))))}return o},cellStyle:(e,t,n)=>{const a=(0,N.Am)(n,"cellStyle");return de(u.EventMethods.Range.CellStyleApplied,a,e,t)},columnWidth:async(e,t,n)=>{const a=await(0,Bt.CE)(n,u.ExcelCalc.getIGeneralRangeOperationRange(e));return de(u.EventMethods.CellDimensions.ColumnWidthSet,a,e,t)},orientation:(e,t,n)=>{const a=(0,N.mT)(n,"orientation");return de(u.EventMethods.CellText.OrientationChanged,a,e,t)},fillColor:(e,t,n)=>{const a=(0,N.wM)(n,"fillColor");return de("None"===a?u.EventMethods.Fill.ColorCleared:u.EventMethods.Fill.Colored,a,e,t)},fontColor:(e,t,n)=>{const a=(0,N.wM)(n,"fontColor");return de(u.EventMethods.Font.Colored,"None"===a?(0,it.Si)("fontColor"):a,e,t)},fontName:(e,t,n)=>{const a=(0,N.Am)(n,"fontName");return de(u.EventMethods.Font.Named,a,e,t)},size:async(e,t,n)=>{const a=await Ot(n,u.ExcelCalc.getIGeneralRangeOperationRange(e));return de(u.EventMethods.Font.Sized,a,e,t)},hide:(e,t,n)=>{const a=(0,N.zI)(n,"hide");if("formatColumns"===n.name)return de(u.EventMethods.CellDimensions.ColumnsHidden,a,e,t);if("formatRows"===n.name)return de(u.EventMethods.CellDimensions.RowsHidden,a,e,t);{const n=[];return n.push(de(u.EventMethods.CellDimensions.ColumnsHidden,a,e,t)),n.push(de(u.EventMethods.CellDimensions.RowsHidden,a,e,t)),n}},horizontalAlignment:(e,t,n)=>{const a=(0,N.Am)(n,"horizontalAlignment");return de(u.EventMethods.Alignment.HorizontalAlignmentSet,$t.default[a],e,t)},indentChange:(e,t,n)=>{const a=(0,N.mT)(n,"indentChange");return de(u.EventMethods.Indent.Incremented,a,e,t)},italic:(e,t,n)=>{const a=(0,N.zI)(n,"italic");return de(u.EventMethods.Font.Italicized,a,e,t)},numberFormat:(e,t,n)=>{const a=(0,N.C3)(n,"numberFormat"),o=(0,N.lI)(n,"decimalPlaces");return[de(u.EventMethods.Range.NumberFormatChanged,(0,f.yw9)("OfficeVSO_9374683_RemoveDecimalPlacesHandling")?a:(0,It.j)(a,o),e,t),pe(u.EventMethods.Range.ColumnsAutoFit,e)]},rowHeight:async(e,t,n)=>{const a=await(0,Bt.fL)(n,u.ExcelCalc.getIGeneralRangeOperationRange(e));return de(u.EventMethods.CellDimensions.RowHeightSet,a,e,t)},strikethrough:(e,t,n)=>{const a=(0,N.zI)(n,"strikethrough");return de(u.EventMethods.Font.StrikeThrough,a,e,t)},underline:(e,t,n)=>{const a=function(e){const t=(0,N.Q4)(e,"underline");if("string"===t)return(0,N.Am)(e,"underline");if("boolean"===t)return(0,N.zI)(e,"underline");throw new o.Dd(`Argument "underline" type ${t} should be enum or number on ${e.name}`,o.vb.ArgumentTypeMismatch,t,"enum | boolean")}(n);return de(u.EventMethods.Font.UnderlineStyle,Dt[a],e,t)},verticalAlignment:(e,t,n)=>{const a=(0,N.Am)(n,"verticalAlignment");return de(u.EventMethods.Alignment.VerticalAlignmentSet,Ht.default[a],e,t)},wrapText:(e,t,n)=>{const a=(0,N.zI)(n,"wrapText");return de(u.EventMethods.CellText.WrapChanged,a,e,t)}},Gt={autofit:(e,t,n)=>(0,N.zI)(e,t)?[]:function(e,t){const n={method:r.wv.Format.RemoveAutofitColumns,args:{range:e},func:Mt},a={method:r.wv.Format.RemoveAutofitRows,args:{range:e},func:Nt};switch(t.name){case"formatColumns":return[n];case"formatRows":return[a];default:return[n,a]}}(n,e),indentChange:(e,t,n)=>({method:r.wv.Format.IndentChange,args:{range:n,indentChange:(0,N.mT)(e,t)},func:st})},zt={totalRow:(e,t,n,a)=>({method:r.wv.Table.TotalRow,args:{tableName:e,value:(0,N.zI)(t,n)},func:Le}),headerRow:(e,t,n,a)=>({method:r.wv.Table.HeaderRow,args:{tableName:e,value:(0,N.zI)(t,n)},func:Ae}),bandedRows:(e,t,n,a)=>{if(!(0,f.yw9)("OfficeVSO_9279636_RemoveBandedRowRegex")&&a&&b(a,T))throw new o.tF("Detected unsupported banded rows query!",t.name);return{method:r.wv.Table.BandedRows,args:{tableName:e,value:(0,N.zI)(t,n)},func:ke}},bandedColumns:(e,t,n,a)=>({method:r.wv.Table.BandedColumns,args:{tableName:e,value:(0,N.zI)(t,n)},func:Fe}),filterButton:(e,t,n,a)=>({method:r.wv.Table.FilterButton,args:{tableName:e,value:(0,N.zI)(t,n)},func:_e}),tableStyle:(e,t,n,a)=>({method:r.wv.Table.ApplyStyle,args:{tableName:e,tableStyle:(0,N.C3)(t,n)},func:Oe})},Qt={totalRow:(e,t,n)=>{const a=(0,N.zI)(t,"totalRow");return ue(u.EventMethods.Table.TotalRowToggled,a,e)},headerRow:(e,t,n)=>{const a=(0,N.zI)(t,"headerRow");return ue(u.EventMethods.Table.HeaderRowToggled,a,e)},bandedRows:(e,t,n)=>{if(n&&b(n,T))throw new o.tF("Detected unsupported banded rows query!",t.name);const a=(0,N.zI)(t,"bandedRows");return ue(u.EventMethods.Table.BandedRowsVisibilityChanged,a,e)},bandedColumns:(e,t,n)=>{const a=(0,N.zI)(t,"bandedColumns");return ue(u.EventMethods.Table.BandedColumnsVisibilityChanged,a,e)},filterButton:(e,t,n)=>{const a=(0,N.zI)(t,"filterButton");return ue(u.EventMethods.Table.FilterButtonVisibilityChanged,a,e)},tableStyle:(e,t,n)=>{let a=(0,N.C3)(t,"tableStyle");return"None"===a&&(a=null),ue(u.EventMethods.Table.StyleApplied,a,e)}};async function jt(e,t,n,a,o){const i=[];void 0===a&&(a="");const l=await async function(e,t,n,a,o){const i=await Promise.all(e.map((async(e,r)=>{const i=Object.keys(Wt).filter((e=>!(!(0,f.avT)()&&!(0,f.k64)()&&"indentChange"===e)&&void 0!==n.arguments[e]));return function(e){const t=[{key:s.Dh.EventType,value:s.Mv.LogStatmentInformation},{key:s.Dh.FormattingTypes,value:e.toString()}];(0,D.j)(t)}(i),await Promise.all(i.map((i=>{let l=e;a&&"autofit"===i&&o&&(l=o[r]);const s=!(0,f.yw9)("OfficeVSO_9277386_FixEmptyColumnName")||""!==t,c=(0,f.k64)()&&s?function(e,t){let n=e.split(",")[t].trim();"'"===n[0]&&(n=n.slice(1));"'"===n[n.length-1]&&(n=n.slice(0,n.length-1));return n}(t,r):t;return Wt[i](l,c,n)})))}))),l={agent:r.w2.OfficeScripts,items:Z(i)};return l}(t,a,e,n,o);if(l.items.length>0&&i.push(l),!(0,f.avT)()&&!(0,f.k64)()){const n=await async function(e,t){const n=await Promise.all(e.map((async e=>Z(Object.keys(Gt).filter((e=>void 0!==t.arguments[e])).map((n=>(0,Gt[n])(t,n,e))))))),a={agent:r.w2.OfficeJS,items:Z(n)};return a}(t.map((e=>u.ExcelCalc.getIGeneralRangeOperationRange(e))),e);n.items.length>0&&i.push(n)}return i}function Jt(e,t,n){e.every((e=>0===e.items.length))&&(0,o.VD)(t,n.length,[],n.length>0)}async function Yt(e,t){if(!e.arguments.tables)throw new o.tF("No table specified.","tables");const n=t.getVariableArgumentValue(e,"tables").values[0],a=(0,N.Ru)(e,"instruction"),i=[n.name];void 0!==a&&i.push(a);const l={func:e.name,args:i};return[{agent:r.w2.FormulaGeneration,items:[l]}]}var Xt=n(672270);class Zt{async convert(e,t){const n=(new Date).getTime(),a=(0,f.yw9)("OfficeVSO_9408716_BlockInsertDeleteScenarios");let o=!1,r=!1,i=!1,l=!1,s=!1,c=!1;for(let t=0;t<e.length;t++){const n=e[t];o=o||this.variableCache.isDeleteColumnsStatement(n),r=r||this.variableCache.isInsertColumnsStatement(n),a&&(i=i||this.variableCache.isDeleteRowsStatement(n),l=l||this.variableCache.isInsertRowsStatement(n),s=s||this.variableCache.isSelectColumnsStatement(n)&&(o||r),c=c||this.variableCache.isSelectRowsStatement(n)&&(i||l))}a?(o&&r||i&&l||s||c)&&this.logUnsupportedTableStructureChangesStatementsAndThrow(e):o&&r&&this.logUnsupportedStatementsAndThrow(e),e=this.checkSelectRowsShouldBeSelectTables(e),this.insertOfSelectTablesIfNeeded(e);for(let n=0;n<e.length;n++){const a=e[n];this.variableCache.isSelectStatement(a)?await this.processSelectStatement(a,e,t):await this.handleNonSelectStatement(a,e,t)}return this.logConverterSucceeded(e,n),this.executableItems}insertOfSelectTablesIfNeeded(e){for(let t=0;t<e.length;t++)if(this.variableCache.isRowColumnSelectStatementWithSelectionScope(e[t])){const n=g.CP.getActiveTable().name;e.splice(t,0,{name:"selectTables",returns:"tables",arguments:{tableNames:{type:"stringList",stringList:[n]}}}),t++}}async processSelectStatement(e,t,n){const a=(new Date).getTime();try{await this.variableCache.cacheVariable(e,n)}catch(n){this.logVariableCacheFailureAndRethrow(n,t,e,a)}}async handleNonSelectStatement(e,t,n){let a=!1;if(!this.variableCache.isSelectStatement(e)){const o=(new Date).getTime(),r=this.eventConverterMap[e.name];if(r){a=!0;try{this.executableItems=this.executableItems.concat(await r(e,n))}catch(n){this.logConverterFailureAndRethrow(n,t,e,o)}}}a||this.logUnsupportedStatement(e)}checkFreezePanes(e,t){if(e.dismissedArguments?.freezePane||t&&(0,Xt.WS)(t,(0,i.u1Q)())){const t={agent:r.w2.UnsupportedEvent,items:[r.DH.FreezePanes]};return this.logUnsupportedStatement(e),[t]}}checkSelectRowsShouldBeSelectTables(e){if(!e.some((e=>"conditional_format_rows"===e.name||"conditionalFormatRows"===e.name)))return e;let t=!1;for(let n=0;n<e.length;n++)switch(e[n].name){case"select_rows":case"selectRows":if(0===e[n].arguments?.rowNumbers?.numberList?.length){t=!0;const a=e.slice(0,n),o=e.slice(n+1);e=a.concat(o),n--}break;case"conditional_format_rows":case"conditionalFormatRows":t&&(e[n].name="conditionalFormatTables",e[n].arguments.rows&&delete e[n].arguments.rows,e[n].arguments.tables={type:"var",name:"tables"})}return e}logConverterSucceeded(e,t){const n=(0,s.b6)();n[s.Dh.EventState]=s.DD.ConvertSucceeded,n[s.Dh.StatementNames]=JSON.stringify(e.map((e=>e.name))),n[s.Dh.TimeDurationInMs]=(0,s.xJ)(t),this.telemetryLogger.logEvent((0,s.gY)(n))}logUnsupportedStatement(e){const t=(0,s.b6)();t[s.Dh.EventState]=s.DD.UnsupportedStatement,t[s.Dh.CurrentStatement]=e.name,this.telemetryLogger.logEvent((0,s.gY)(t))}logUnsupportedStatementsAndThrow(e){const t=(0,s.b6)();throw t[s.Dh.EventState]=s.DD.UnsupportedStatement,t[s.Dh.StatementNames]=JSON.stringify(e.map((e=>e.name))),this.telemetryLogger.logEvent((0,s.gY)(t)),new o.tF("Delete + Insert columns (could be move columns) is a blocked scenario","DeleteColumns and InsertColumns",o.tJ.DeleteWithInsertColumns)}logUnsupportedTableStructureChangesStatementsAndThrow(e){const t=(0,s.b6)();throw t[s.Dh.EventState]=s.DD.UnsupportedStatement,t[s.Dh.StatementNames]=JSON.stringify(e.map((e=>e.name))),this.telemetryLogger.logEvent((0,s.gY)(t)),new o.tF("Multiple steps with potential table structure changes","Inserts and Deletes",o.tJ.MultipleTableStructureChanges)}logVariableCacheFailureAndRethrow(e,t,n,a){e.isStatementArgumentError&&this.logStatementArgumentError(e),e.isConverterError&&(0,D.R)(e);const o=(0,s.b6)();throw o[s.Dh.EventState]=s.DD.VariableCacheFailed,o[s.Dh.CurrentStatement]=n.name,o[s.Dh.StatementNames]=JSON.stringify(t.map((e=>e.name))),o[s.Dh.TimeDurationInMs]=(0,s.xJ)(a),this.telemetryLogger.logEvent((0,s.gY)(o)),e}logConverterFailureAndRethrow(e,t,n,a){if(e.isNoEventGeneratedError)return void this.logNoEventGeneratedError(e);e.isStatementArgumentError&&this.logStatementArgumentError(e),e.isConverterError&&(0,D.R)(e);const o=(0,s.b6)();throw o[s.Dh.EventState]=s.DD.ConverterFailed,o[s.Dh.CurrentStatement]=n.name,o[s.Dh.StatementNames]=JSON.stringify(t.map((e=>e.name))),o[s.Dh.TimeDurationInMs]=(0,s.xJ)(a),this.telemetryLogger.logEvent((0,s.gY)(o)),e}logNoEventGeneratedError(e){const t={eventType:c.S2.NoEventGenerated,errorMessage:e.message,logLevel:l.$b.ASHA},n=[{key:s.iq.Reason,value:e.reason},{key:s.iq.CurrentStatement,value:e.statementName},{key:s.iq.ArgumentNames,value:JSON.stringify(e.argumentNames)},{key:s.iq.UnsupportedArgumentTypes,value:JSON.stringify(e.unsupportedArgumentTypes)},{key:s.xL.ErrorMessage,value:e.message}];this.telemetryLogger.logError(t,void 0,n)}logStatementArgumentError(e){const t={eventType:c.S2.StatementArgumentError,errorMessage:e.message,logLevel:l.$b.Warning},n=[{key:s._4.Reason,value:e.reason},{key:s._4.ArgumentType,value:e.argumentType},{key:s._4.ExpectedType,value:e.expectedType},{key:s.xL.ErrorMessage,value:e.message}];this.telemetryLogger.logError(t,void 0,n)}fillEventConverterMap(){this.eventConverterMap.formatRanges=async(e,t)=>{const n=this.checkFreezePanes(e,t);return n||async function(e,t){const n=ae(e,t),a=await jt(e,n,!1);return Jt(a,e,n),a}(e,this.variableCache)},this.eventConverterMap.insertTables=async(e,t)=>{this.logUnsupportedStatement(e);return[{agent:r.w2.UnsupportedEvent,items:[r.DH.InsertTables]}]},this.eventConverterMap.formatColumns=async(e,t)=>{const n=this.checkFreezePanes(e,t);return n||Vt(e,this.variableCache)},this.eventConverterMap.formatRows=async(e,t)=>{const n=this.checkFreezePanes(e,t);return n||async function(e,t){const n=ne(e,t),a=await jt(e,n,!1);return Jt(a,e,n),a}(e,this.variableCache)},this.eventConverterMap.formatTables=async(e,t)=>{const n=this.checkFreezePanes(e,t);return n||qt(e,this.variableCache)},(0,f.yw9)("OfficeVSO_9577939_CleanUpReplaceCodes")||(this.eventConverterMap.replaceTables=async(e,t)=>async function(e,t){if(!e.arguments.tables)throw new o.tF("No table specified.","tables");const n=t.getVariableArgumentValue(e,"tables").values,a=[];for(const e of n)try{const t=e.sheetRange;if((0,f.avT)()&&(0,g.En)(e)){const n={rangeType:Et.RangeType.TableRange,range:{subRange:u.TableRangeOperationSubRange.WholeTable,tableName:e.name,gridRange:t}};a.push(n)}else a.push({rangeType:Et.RangeType.ExcelSheetRange,range:t})}catch{}return await Ft(e,a)}(e,this.variableCache),this.eventConverterMap.replaceColumns=async(e,t)=>async function(e,t){const n=te(e,t);return await Ft(e,n)}(e,this.variableCache),this.eventConverterMap.replaceRows=async(e,t)=>async function(e,t){const n=ne(e,t);return await Ft(e,n)}(e,this.variableCache),this.eventConverterMap.replaceRanges=async(e,t)=>async function(e,t){const n=ae(e,t);return await Ft(e,n)}(e,this.variableCache)),this.eventConverterMap.clearRanges=async(e,t)=>function(e,t,n){return Ie(ae(e,t),e,n)}(e,this.variableCache,t),this.eventConverterMap.clearTables=async(e,t)=>async function(e,t,n){if(!e.arguments.tables)throw new o.tF("No table specified.","tables");const a=t.getVariableArgumentValue(e,"tables").values,i=(0,N.Ak)(e,"content")??!1,l=(0,N.Ak)(e,"format")??!1,s={agent:r.w2.OfficeScripts,items:[]};if((0,f.yw9)("OfficeVSO_9448487_fixClearContentFormatAndHyperlink")){for(const t of a){let n;n=K(t.sheetRange),(0,f.avT)()&&(0,g.En)(t)&&(n={rangeType:u.RangeType.TableRange,range:{subRange:u.TableRangeOperationSubRange.Body,tableName:t.name,gridRange:u.ExcelCalc.getIGeneralRangeOperationRange(n)}}),Re(s,e,n)}return 0===s.items.length&&(0,o.VD)(e,a.length,[]),[s]}for(const t of a){let a;if(a=K(t.sheetRange),(0,f.avT)()&&(0,g.En)(t)&&(a={rangeType:u.RangeType.TableRange,range:{subRange:u.TableRangeOperationSubRange.Body,tableName:t.name,gridRange:u.ExcelCalc.getIGeneralRangeOperationRange(a)}}),(0,f.yw9)("OfficeVSO_9285634_RemoveClearContentRegex")){const t=(0,N.Ak)(e,"hyperlink")??!1,n=(0,N.Ak)(e,"all")??!1;i&&s.items.push(Ce(Ee.default.ClearCells,a)),t&&s.items.push(Ce(Ee.default.ConvertLinkedEntitiesToText,a)),n&&s.items.push(Ce(Ee.default.ClearCellsAll,a))}else i&&n&&(b(n,I)||b(n,R))&&s.items.push(Ce(Ee.default.ClearCells,a));l&&s.items.push(Ce(Ee.default.ClearCellsFormat,a))}return 0===s.items.length&&(0,o.VD)(e,a.length,[]),[s]}(e,this.variableCache,t),this.eventConverterMap.clearColumns=async(e,t)=>function(e,t,n){return Ie(te(e,t),e,n)}(e,this.variableCache,t),this.eventConverterMap.clearRows=async(e,t)=>function(e,t,n){return Ie(ne(e,t),e,n)}(e,this.variableCache,t),this.eventConverterMap.filterTables=async(e,t)=>async function(e,t){if(!e.arguments.tables)throw new o.tF("No table specified.","filterTables");const n=t.getVariableArgumentValue(e,"tables");if("Table"!==n.entityType)throw new o.tF("Variable cache entity type mismatched!","filterTables: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);const a=n.values[0],i=JSON.parse(a.headers),l=Q.getTableColumnName(a,e),s=(0,N.BO)(e,"filterType");if(void 0===s)throw new o.tF("No filter type specified",e.name);const c=[];let d=!1;const m=[];if(a.tableLikeRange){const t=nt[s],n=Q.getTableColumnNumber(e,a);let o=u.ExcelCalc.IExcelRangeToAddress(a.sheetRange.range),l=Xe?u.ExcelCalc.IExcelRangeToAddress(u.ExcelCalc.columnFromIExcelAddress(a.sheetRange.range,n)):"";if(t){d=!0;const u=t(e);if(u.color&&(u.color=await Je(a.sheetRange.sheet,o,n,u.color,"CellColor"===s?"fill":"font",!0)),!(0,f.yw9)("OfficeVSO_9122912_HiTLTLRFilterOfficeJS")&&(0,f.yw9)("OfficeVSO_9115888_TLRFiltering")&&(0,f.k64)()){const t=at[s],o={sheet:a.sheetRange.sheet,range:{topLeft:a.sheetRange.range.topLeft,bottomRight:{column:a.sheetRange.range.bottomRight.column,row:a.totalRow&&a.sheetRange.range.bottomRight.row?a.sheetRange.range.bottomRight.row-1:a.sheetRange.range.bottomRight.row}}};c.push({agent:r.w2.OfficeScripts,items:[await t(a.sheetRange.sheet,n+1,o,e)]})}else(0,f.tgf)()&&a.totalRow&&(o=re(a.sheetRange.range),l=o),c.push({agent:r.w2.OfficeJS,items:[tt({filterType:s,sheetName:a.sheetRange.sheet,rangeAddress:o,columnAddress:l,columnIndex:n,columnName:i[n],filterCriteria:u})]})}else m.push(s)}else{const t=et[s],n=Ke[s];d=!1;const o=[];t||n?(d=!0,t&&c.push({agent:r.w2.OfficeScripts,items:[await t(a.name,l,e)]}),n&&c.push({agent:r.w2.OfficeJS,items:[await n(a.name,l,i.indexOf(l),e)]})):o.push(s)}return 0===c.length&&(0,o.VD)(e,1,d?[]:m),c}(e,this.variableCache),this.eventConverterMap.clearFilters=async(e,t)=>Ze(e,this.variableCache),this.eventConverterMap.insertRows=async(e,t)=>async function(e,t,n){const a=t.getVariableArgumentValue(e,"scope");if("Table"!==a.entityType)throw new o.tF("Variable cache entity type mismatched!","insertTableRows: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);const i=a.values[0];let l=[];l=(0,f.yw9)("OfficeVSO_9436607_WorksheetRowNumber")?M(e,i.sheetRange.range.topLeft.row??0):(0,N.dc)(e,"rowNumbers");const s={agent:r.w2.OfficeScripts,items:[]};let c=!1;const d=t.tryGetChainedVariableArgument("rows");if(d){const e=d.values.indices[0];if(e&&(l.fill(e),c=!0),c)for(let e=0;e<l.length;e++)l[e]++}const m=await Q.getTableRowRangesCommon(i,l,!1);if(i.tableLikeRange){const n=[];if((0,f.yw9)("OfficeVSO_9408399_InsertBelowFixes")){const t=(0,N.Ak)(e,"insertBelow")??!1;l.sort(((e,t)=>e-t));for(let e=0;e<m.length;e++){const a=u.ExcelCalc.getIGeneralRangeOperationRange(m[e]);c&&t&&a.range.topLeft.row<i.sheetRange.range.bottomRight.row+(i.totalRow?0:1)&&(a.range.topLeft.row++,a.range.bottomRight.row++,m[e]={rangeType:Et.RangeType.ExcelSheetRange,range:a});const o=e>0?_t(l,e):0,r={rangeType:Et.RangeType.ExcelSheetRange,range:{sheet:a.sheet,range:{topLeft:{row:a.range.topLeft.row+o,column:a.range.topLeft.column},bottomRight:{row:a.range.topLeft.row+o,column:a.range.bottomRight.column}}}};n.push(r)}}m.map((e=>{s.items.push(me(u.EventMethods.Range.Inserted,e,u.IDirection.Down))})),(0,f.yw9)("OfficeVSO_9377931_InsertRowReturnVariable")&&t.UpdateVariableCache(e.returns,"Row",{ranges:(0,f.yw9)("OfficeVSO_9408399_InsertBelowFixes")?n:m})}else{const a=q(m.map((e=>u.ExcelCalc.getIGeneralRangeOperationRange(e))),i,(0,f.yw9)("OfficeVSO_9322539_InsertAtTableEnd"));if(!(0,f.yw9)("OfficeVSO_9279072_RowBelowQueryRegExp_IncrementFix")||c)if((0,f.yw9)("OfficeVSO_9279072_RowBelowQueryRegExpRemoval")){if((0,N.Ak)(e,"insertBelow"))for(let e=0;e<a.length;e++)a[e]<i.numRows&&a[e]++}else if(n&&b(n,S))for(let e=0;e<a.length;e++)a[e]<i.numRows&&a[e]++;const o=[];if(a.sort(((e,t)=>e-t)),s.items=s.items.concat(a.map((e=>ge(u.EventMethods.Table.RowInserted,i.name,e,1)))),(0,f.yw9)("OfficeVSO_9377931_InsertRowReturnVariable")){const n=i.sheetRange;for(let e=0;e<a.length;e++){const t=e>0?_t(a,e):0,r={rangeType:Et.RangeType.ExcelSheetRange,range:{sheet:n.sheet,range:{topLeft:{row:n.range.topLeft.row+a[e]+1+t,column:n.range.topLeft.column},bottomRight:{row:n.range.topLeft.row+a[e]+1+t,column:n.range.bottomRight.column}}}};o.push(r)}t.UpdateVariableCache(e.returns,"Row",{ranges:o})}}return[s]}(e,this.variableCache,t),this.eventConverterMap.deleteRows=async(e,t)=>async function(e,t){const n=t.getVariableArgumentValue(e,"rows").values;if((0,f.yw9)("OfficeVSO_8460617_BlockDeleteAllRows")&&n.allRows)throw new o.tF("Deleting all rows is a blocked scenario",e.name,o.tJ.DeleteUnexpectedTableRows);const a=h(e.name),i=n.indices??[],l=a.numRows,s={agent:r.w2.OfficeScripts,items:[]};if(0===i.length){if((0,D.R)(new o.tF("Executing delete row on table with no row number")),(0,f.avT)()&&(0,g.En)(a))s.items.push(ge(u.EventMethods.Table.RowsDeleted,a.name,l-1,1));else{const e=kt(a.sheetRange,l-1);if(null===e)throw new o.tF("Failed to resolve selected tables!");s.items.push(me(u.EventMethods.Range.Deleted,e,u.IDirection.Up))}return[s]}if((0,f.avT)()&&(0,g.En)(a)){const e=[],t=[];i.sort(((e,t)=>e-t)).forEach((t=>{e.push(t)}));for(let t=e.length-1;t>=0;t--){const n=e[t];n>=-1&&n<a.numRows&&s.items.push(ge(u.EventMethods.Table.RowsDeleted,a.name,n,1))}for(let e=t.length-1;e>=0;e--){const n=a.numRows+t[e];n>=0&&n<a.numRows&&s.items.push(ge(u.EventMethods.Table.RowsDeleted,a.name,n,1))}}else i.sort(((e,t)=>t-e)).forEach((e=>{const t=kt(a.sheetRange,e+1);if(null===t)throw new o.tF("Failed to resolve selected tables!");s.items.push(me(u.EventMethods.Range.Deleted,t,u.IDirection.Up))}));return 0===s.items.length&&(0,o.VD)(e,1,[]),[s]}(e,this.variableCache),this.eventConverterMap.insertColumns=async(e,t)=>function(e,t){const n=t.getVariableArgumentValue(e,"scope");if("Table"!==n.entityType)throw new o.tF("Variable cache entity type mismatched!","insertColumns: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);const a=n.values[0];let i=[];i=Q.getTableColumnNumbers(e,a),i=i.map((e=>e+1));const l=(0,N.Lb)(e,"columnNames"),s=(0,N.Lb)(e,"numberFormats"),c={agent:r.w2.OfficeScripts,items:[]},d=a.sheetRange,m=a.numColumns;if(l.length!==s.length&&0!==l.length&&0!==s.length)throw new o.tF("mismatch between columnNames and numberFormat dimensions","scope");if(0===i.length||-1===i[0]&&1===i.length){const e=0===l.length?0===s.length?1:s.length:l.length;i=Array(e).fill(m+1)}if(1===i.length&&i[0]>-1&&l.length>1){const e=l.length;i=Array(e).fill(i[0])}if(i.length!==l.length&&0!==l.length)throw new o.tF("mismatch between columnNames, columnNumbers, numberFormat, and columnValues","columns");const h=(p=m,i.map((e=>e<0?p+1+e:e-1)).sort(((e,t)=>e-t)));var p;for(let e=h.length-1;e>=0;e--){const t=h[e];if(t>=0&&t<=m){if(a.tableLikeRange){const e=At(a.sheetRange,t);if(null===e)throw new o.tF("Failed to resolve selected tables!");c.items.push(me(u.EventMethods.Range.Inserted,e,u.IDirection.Right))}else(0,f.avT)()?c.items.push(he(a.name,t,1,l.length>e?[l[e]]:void 0)):c.items.push(ge(u.EventMethods.Table.ColumnInserted,a.name,t,1));const n=d.range.topLeft.row??0,r=(d.range.bottomRight.row??0)+1,i=(d.range.topLeft.column??0)+t;if(0!==s.length){const o={range:{topLeft:{row:n,column:i},bottomRight:{row:r,column:i}},sheet:d.sheet},l="";(0,f.avT)()&&(0,g.En)(a)?c.items.push(de(u.EventMethods.Range.NumberFormatChanged,(0,It.j)(s[e],void 0),{rangeType:Et.RangeType.TableRange,range:{subRange:u.TableRangeOperationSubRange.Columns,tableName:a.name,gridRange:o,subRangeValues:{firstIndex:t,count:1}}},l)):c.items.push(de(u.EventMethods.Range.NumberFormatChanged,(0,It.j)(s[e],void 0),{rangeType:Et.RangeType.ExcelSheetRange,range:o},l))}if(!(0,f.avT)()&&0!==l.length){const t={range:{topLeft:{row:n,column:i},bottomRight:{row:n,column:i}},sheet:d.sheet};c.items.push((0,f.yw9)("OfficeVSO_9056836_useRangeSingleValueEdited")?ce(l[e],t):se([[l[e]]],t))}}}return 0===c.items.length&&(0,o.VD)(e,1,[]),[c]}(e,this.variableCache),this.eventConverterMap.deleteColumns=async(e,t)=>async function(e,t){const n=t.getVariableArgumentValue(e,"columns").values,a=h(e.name),i=n.indices??[],l=a.numColumns,s={agent:r.w2.OfficeScripts,items:[]};if(0===i.length){if((0,D.R)(new o.tF("Executing delete column on table with no column number")),(0,f.avT)()&&(0,g.En)(a))s.items.push(ge(u.EventMethods.Table.ColumnsDeleted,a.name,l-1,1));else{const e=At(a.sheetRange,l-1);if(null===e)throw new o.tF("Failed to resolve selected tables!");s.items.push(me(u.EventMethods.Range.Deleted,e,u.IDirection.Left))}return[s]}if((0,f.avT)()&&(0,g.En)(a)){const e=[],t=[];i.sort(((e,t)=>e-t)).forEach((n=>{n<0?t.push(n):e.push(n)}));for(let t=e.length-1;t>=0;t--){const n=e[t];n>=0&&n<l&&s.items.push(ge(u.EventMethods.Table.ColumnsDeleted,a.name,n,1))}for(let e=t.length-1;e>=0;e--){const n=l+t[e];n>=0&&n<l&&s.items.push(ge(u.EventMethods.Table.ColumnsDeleted,a.name,n,1))}}else i.sort(((e,t)=>t-e)).forEach((e=>{const t=At(a.sheetRange,e);if(null===t)throw new o.tF("Failed to resolve selected tables!");s.items.push(me(u.EventMethods.Range.Deleted,t,u.IDirection.Left))}));return 0===s.items.length&&(0,o.VD)(e,1,[]),[s]}(e,this.variableCache),this.eventConverterMap.addCalculatedColumns=async(e,t)=>Yt(e,this.variableCache),this.eventConverterMap.aggregateColumns=async(e,t)=>Yt(e,this.variableCache),this.eventConverterMap.getInsights=async(e,t)=>async function(e,t){if(!e.arguments.tables)throw new o.tF("No table specified.","tables");const n=t.getVariableArgumentValue(e,"tables").values[0],a=(0,N.Ru)(e,"instruction")??"get insights",i={func:"getTableInsights",args:[n.name,a]};return[{agent:r.w2.Insights,items:[i]}]}(e,this.variableCache),(0,f.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.ImportDataAsSkill",!1)&&(this.eventConverterMap.insertDatasource=async(e,t)=>async function(e){if(!e.arguments.preview)throw new o.tF("no preview context","preview");const t={func:"insertDatasource",args:[(0,N.Ru)(e,"preview")]};return[{agent:r.w2.ImportData,items:[t]}]}(e,this.variableCache)),(0,f.eFk)()&&(this.eventConverterMap.addDataShapingTransformationSteps=async(e,t)=>async function(e){const t={kind:"addDataShapingTransformationSteps",args:{sessionId:(0,N.C3)(e,"sessionId"),transformationStepsJson:Y(e,"transformationSteps"),transformationStepsExplanation:Y(e,"transformationStepsExplanation"),requestJson:X(e,"requestJson")}};return[{agent:r.w2.DataShaping,items:[t]}]}(e,this.variableCache),this.eventConverterMap.editDataShapingQuery=async(e,t)=>async function(e){const t={kind:"editDataShapingQuery",args:{sessionId:(0,N.C3)(e,"sessionId"),instruction:Y(e,"instruction"),queryScript:Y(e,"queryScript"),explanation:Y(e,"explanation"),requestJson:X(e,"requestJson")}};return[{agent:r.w2.DataShaping,items:[t]}]}(e,this.variableCache),this.eventConverterMap.dataShapingFailure=async(e,t)=>async function(e){const t=(0,N.C3)(e,"sessionId"),n=(0,N.BO)(e,"errorSource"),a=(0,N.BO)(e,"errorCode"),o=X(e,"requestJson");if(!n||!["EnterMode","AddStep","CreatePlan"].includes(n))throw new Error(`Invalid errorSource: ${n}`);if(!a||!["BaseQueryFailure","ExplanationFailure","NoRange","PowerQueryApiFailure","QueryTable","StepFromNLFailure","TableNotFound","UnexpectedError"].includes(a))throw new Error(`Invalid errorCode: ${a}`);const i={kind:"dataShapingFailure",args:{sessionId:t,errorSource:n,errorCode:a,requestJson:o}};return[{agent:r.w2.DataShaping,items:[i]}]}(e,this.variableCache),this.eventConverterMap.enterDataShapingMode=async(e,t)=>async function(e){const t={kind:"enterDataShapingMode",args:{tableName:(0,N.C3)(e,"tableName"),sessionId:(0,N.C3)(e,"sessionId"),mashupDocument:Y(e,"mashupDocument"),queryName:(0,N.C3)(e,"queryName"),queryScript:Y(e,"queryScript"),requestJson:X(e,"requestJson")}};return[{agent:r.w2.DataShaping,items:[t]}]}(e,this.variableCache)),this.eventConverterMap.sortTables=async(e,t)=>ut(e,this.variableCache,this.executableItems,t),this.eventConverterMap.clearSort=async(e,t)=>(0,f.yw9)("OfficeVSO_9217762_SupportClearSorting")?mt(e,this.variableCache):ut(e,this.variableCache,this.executableItems,t),this.eventConverterMap.conditionalFormatRanges=async(e,t)=>vt(e,this.variableCache),this.eventConverterMap.conditionalFormatTables=async(e,t)=>async function(e,t){return Tt(e,await ee(e,t))}(e,this.variableCache),this.eventConverterMap.conditionalFormatColumns=async(e,t)=>async function(e,t){return Tt(e,te(e,t),oe(e,t))}(e,this.variableCache),this.eventConverterMap.conditionalFormatRows=async(e,t)=>async function(e,t){return Tt(e,ne(e,t))}(e,this.variableCache),this.eventConverterMap.conditionalFormatSuggestionPill=async(e,t)=>wt(e,this.variableCache,a.i.SuggestionPill),this.eventConverterMap.conditionalFormatSuggestion=async(e,t)=>wt(e,this.variableCache,a.i.Chat),this.eventConverterMap.insertWorksheets=async(e,t)=>{this.logUnsupportedStatement(e);return[{agent:r.w2.UnsupportedEvent,items:[r.DH.InsertWorksheets]}]},this.eventConverterMap.deleteWorksheets=async(e,t)=>{this.logUnsupportedStatement(e);return[{agent:r.w2.UnsupportedEvent,items:[r.DH.DeleteWorksheets]}]},(0,f.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.EnableDataValidation",!1)&&(this.eventConverterMap.addDataValidationColumns=async(e,t)=>async function(e,t){const n=te(e,t);return await Se(e,n)}(e,this.variableCache),this.eventConverterMap.addDataValidationRows=async(e,t)=>async function(e,t){const n=ne(e,t);return await Se(e,n)}(e,this.variableCache),this.eventConverterMap.addDataValidationTables=async(e,t)=>async function(e,t){return Se(e,await ee(e,t))}(e,this.variableCache),this.eventConverterMap.addDataValidationRanges=async(e,t)=>async function(e,t){const n=ae(e,t);return await Se(e,n)}(e,this.variableCache))}constructor(){this.variableCache=new j,this.telemetryLogger=d.M.getInstance(),this.executableItems=[],this.eventConverterMap={},this.fillEventConverterMap()}}},624654:(e,t,n)=>{"use strict";n.d(t,{FZ:()=>r,dI:()=>i,xs:()=>c});var a=n(819415),o=n(347145);function r(){return{isLoaded:!1,localeInfo:{},calcLocaleInfo:{}}}function i(e){e.application.cultureInfo.load("name");const t=e.application.cultureInfo.numberFormat,n=e.application.cultureInfo.datetimeFormat;let r;return t.load("numberGroupSeparator"),t.load("numberDecimalSeparator"),(0,a.r1)()&&(r=e.application.cultureInfo.formulaCulture,r?.load(),n.load(),t.load()),e.application.cultureInfo.numberFormat.load("currencySymbol"),()=>{const i={isLoaded:!1,localeInfo:{},calcLocaleInfo:{}},c=e.application.cultureInfo.name.toLowerCase();i.dataLocale=c,"."!==e.application.cultureInfo.numberFormat.numberDecimalSeparator&&(i.localeInfo.decimalPoint=e.application.cultureInfo.numberFormat.numberDecimalSeparator),","!==e.application.cultureInfo.numberFormat.numberGroupSeparator&&(i.localeInfo.digitGrouping=e.application.cultureInfo.numberFormat.numberGroupSeparator),"$"!==e.application.cultureInfo.numberFormat.currencySymbol&&(i.localeInfo.currencySymbol=e.application.cultureInfo.numberFormat.currencySymbol);const d=(0,o.yw9)("OfficeVSO_9573790_crashOnLocaleNotBCPFormatted");if(d||"en-us"===c||(i.localeInfo.longDay=s(c,"long"),i.localeInfo.shortDay=s(c,"short"),i.localeInfo.longMonth=l(c,"long"),i.localeInfo.medMonth=l(c,"short"),i.localeInfo.shortMonth=l(c,"narrow")),(0,a.r1)()){i.calcLocaleInfo.falseName=r?.falseName,i.calcLocaleInfo.trueName=r?.trueName,i.calcLocaleInfo.errorTypeNames=r?.errorTypeNames,i.calcLocaleInfo.leftBrace=r?.leftBrace,i.calcLocaleInfo.leftBracket=r?.leftBracket,i.calcLocaleInfo.listSeparator=r?.listSeparator,i.calcLocaleInfo.rightBracket=r?.rightBracket,i.calcLocaleInfo.rightBrace=r?.rightBrace,i.calcLocaleInfo.specialRefNames=r?.specialRefNames,i.calcLocaleInfo.uppercaseColumnLetter=r?.uppercaseColumnLetter,i.calcLocaleInfo.uppercaseRowLetter=r?.uppercaseRowLetter,i.calcLocaleInfo.worksheetFunctionNames=r?.worksheetFunctionNames;try{i.calcLocaleInfo.rowSeparator=r?.rowSeparator,i.calcLocaleInfo.columnSeparator=r?.columnSeparator}catch(e){}i.calcLocaleInfo.dateSeparator=n.dateSeparator,i.calcLocaleInfo.longDatePattern=n.longDatePattern,i.calcLocaleInfo.shortDatePattern=n.shortDatePattern,i.calcLocaleInfo.timeSeparator=n.timeSeparator,i.calcLocaleInfo.longTimePattern=n.longTimePattern,i.calcLocaleInfo.amSymbol=n.amSymbol,i.calcLocaleInfo.dateOrder=n.dateOrder,i.calcLocaleInfo.dateSeparatorAlternative=n.dateSeparatorAlternative,i.calcLocaleInfo.dayNameLong=n.dayNameLong,i.calcLocaleInfo.dayNameShort=n.dayNameShort,i.calcLocaleInfo.isAmPmSeparatedBySpace=n.isAmPmSeparatedBySpace,i.calcLocaleInfo.isClock24Hour=n.isClock24Hour,i.calcLocaleInfo.isDayTwoDigits=n.isDayTwoDigits,i.calcLocaleInfo.isHourTwoDigits=n.isHourTwoDigits,i.calcLocaleInfo.isLongDateFormat=n.isLongDateFormat,i.calcLocaleInfo.isMonthTwoDigits=n.isMonthTwoDigits,i.calcLocaleInfo.isYearFourDigits=n.isYearFourDigits,i.calcLocaleInfo.isYearFourDigits=n.isYearFourDigits,i.calcLocaleInfo.monthNameLong=n.monthNameLong,i.calcLocaleInfo.monthNameShort=n.monthNameShort,i.calcLocaleInfo.pmSymbol=n.pmSymbol,i.calcLocaleInfo.timeSeparatorAlternative=n.timeSeparatorAlternative,i.calcLocaleInfo.numberDecimalSeparator=t.numberDecimalSeparator,i.calcLocaleInfo.numberGroupSeparator=t.numberGroupSeparator,i.calcLocaleInfo.currencySymbol=t.currencySymbol,i.calcLocaleInfo.currencyDecimals=t.currencyDecimals,i.calcLocaleInfo.currencyNegative=t.currencyNegative,i.calcLocaleInfo.fractionSeparator=t.fractionSeparator,i.calcLocaleInfo.isCurrencySeparatedBySpace=t.isCurrencySeparatedBySpace,i.calcLocaleInfo.isCurrencySymbolLeading=t.isCurrencySymbolLeading,i.calcLocaleInfo.nonCurrencyNumberDecimals=t.nonCurrencyNumberDecimals,i.calcLocaleInfo.numberGrouping=t.numberGrouping,i.calcLocaleInfo.spaceBeforePercentage=t.spaceBeforePercentage,i.calcLocaleInfo.spaceInScientificNotation=t.spaceInScientificNotation,d&&(i.localeInfo.longDay=n.dayNameLong,i.localeInfo.shortDay=n.dayNameShort,i.localeInfo.longMonth=n.monthNameLong,i.localeInfo.medMonth=n.monthNameShort,i.localeInfo.shortMonth=n.monthNameShort)}else if(d&&"en-us"!==c){const t=e.application.cultureInfo.name.toLowerCase().split("_")[0];i.localeInfo.longDay=s(t,"long"),i.localeInfo.shortDay=s(t,"short"),i.localeInfo.longMonth=l(t,"long"),i.localeInfo.medMonth=l(t,"short"),i.localeInfo.shortMonth=l(t,"narrow")}return i.isLoaded=!0,i}}function l(e,t){const n=new Intl.DateTimeFormat(e,{month:t}),a=[];for(let e=1;e<13;e++){const t=new Date(Date.UTC(2e3,e,1,0,0,0));a.push(n.format(t))}return a}function s(e,t){const n=new Intl.DateTimeFormat(e,{weekday:t}),a=[];for(let e=0;e<7;e++){const t=new Date(Date.UTC(2e3,1,e,0,0,0));a.push(n.format(t))}return a}function c(e){const t=e.toLowerCase();return!!(t.includes("dd")||t.includes("mm")||t.includes("yy")||t.includes("aa")||t.includes("jj")||t.includes("rr")||t.includes("vv")||t.includes("дд")||t.includes("гг"))}},630530:(e,t,n)=>{"use strict";n.d(t,{So:()=>m,Ul:()=>h,tV:()=>g});var a=n(616166),o=n(83437),r=n(380473),i=n(75496),l=n(316904),s=n(92520),c=n(995619);const d={isLoaded:!1,isFeedbackEnabled:!0,feedbackInitializationData:""};async function u(){d.isLoaded||(d.isFeedbackEnabled=await async function(){let e=!1;try{e=await OfficeFirstParty.UserFeedback.CheckFeedbackEligibility("CanShowSingleClickCopilotFeedbackButton"),(0,s.cY)("OfficeFirstParty CheckFeedbackEligibility : "+e)}catch(t){l.M.getInstance().logErrorCode(a.O.FeedbackApiError,t,i.S2.Error,o.$b.Warning),(0,s.cY)("Error in UserFeedback CheckFeedbackEligibility : ",t),e=await async function(){let e=!1;try{e=await OfficeFirstParty.UserFeedback.CanCollectCopilotFeedback(),(0,s.cY)("OfficeFirstParty CanCollectCopilotFeedback : "+e)}catch(t){try{l.M.getInstance().logErrorCode(a.O.FeedbackApiError,t,i.S2.Error,o.$b.Warning),(0,s.cY)("Error in UserFeedback CanCollectCopilotFeedback : ",t),e=await OfficeFirstParty.UserFeedback.CanCollectUserFeedback(),(0,s.cY)("OfficeFirstParty CanCollectUserFeedback : ",e)}catch(e){l.M.getInstance().logErrorCode(a.O.FeedbackApiError,e,i.S2.Error,o.$b.Warning),(0,s.cY)("Error in UserFeedback CanCollectUserFeedback : ",e)}}return e}()}return e}(),d.isLoaded=!0)}const m=new r.d((async()=>{await u(),d.feedbackInitializationData=await(0,c.y)()}));const g=()=>d.isFeedbackEnabled,h=()=>d.feedbackInitializationData},632197:(e,t,n)=>{"use strict";n.d(t,{Q:()=>o,t:()=>a});var a=function(e){var t,n;return{accessToken:e.accessToken,expirationTime:null!==(n=null===(t=null==e?void 0:e.expiresOn)||void 0===t?void 0:t.getTime())&&void 0!==n?n:0}},o=function(e){return e.substring(0,e.lastIndexOf("/"))}},634883:(e,t,n)=>{"use strict";n.d(t,{E:()=>a});const a={ClientProgramResponseError:"ClientProgramResponseError",DisengagedError:"DisengagedError",InferenceAPIError:"InferenceAPIError",InputQueryError:"InputQueryError",LicensingError:"LicensingError",ODSLParseError:"ODSLParseError",ODSLSyntaxError:"ODSLSyntaxError",OffensiveContent:"OffensiveContent",SkillFailedError:"SkillFailedError",SydneyCancelledError:"SydneyCancelledError",IgnorableError:"IgnorableError",SydneyError:"SydneyError",TokenCountError:"TokenCountError",UnsupportedLanguageError:"UnsupportedLanguageError",UnrecognizedTabularRange:"UnrecognizedTabularRange",ExcelTabularSkillFailedError:"ExcelTabularSkillFailedError",PythonSkillFailedError:"PythonSkillFailedError",OfficeJsSkillFailedError:"OfficeJsSkillFailedError"}},638753:(e,t,n)=>{"use strict";n.d(t,{An:()=>T,Bp:()=>h,Cs:()=>p,Id:()=>g,Ne:()=>b,QH:()=>y,_H:()=>C,gZ:()=>v,hX:()=>u,if:()=>f,nh:()=>m});var a=n(423905),o=n(241273),r=n(300664),i=n(977116),l=n(965465),s=n(660606),c=n(83437),d=function(){return d=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},d.apply(this,arguments)};function u(e){return null==e}function m(e){switch(e){case o.ut.Enterprise:return"Enterprise";case o.ut.Consumer:return"Consumer";default:return"Unknown"}}var g=function(e,t,n,a,l){var s=t!==o.Gm.defaultWhite&&t!==o.Gm.themeColorful?d({isDarkModeEnabled:!0,isHighContrastModeEnabled:n},(0,r.W)(e)):d({isDarkModeEnabled:!1,isHighContrastModeEnabled:n},(0,i.a)(e));return s.dir=a,l&&s.isDarkModeEnabled&&Object.entries(l).forEach((function(e){var t=e[0],n=e[1];s[t]=n})),s};function h(e){(0,s.cY)("launchThisVersionOfSDX():"+e);var t=window.location.href;""===e?(0,s.cY)("launchThisVersionOfSDX() is empty"):t.split("/").length>9?e!==t.split("/")[7]&&((0,s.cY)("launchThisVersionOfSDX difference detected"),window.location.href=t.replace(t.split("/")[7],e)):t.split("/").length>6&&t.split("/").length<10&&e!==t.split("/")[4]&&((0,s.cY)("launchThisVersionOfSDX difference detected"),window.location.href=t.replace(t.split("/")[4],e))}var p=function(){return"undefined"!=typeof OfficeaicopilotStrings},b=function(e){var t,n,o,r;if(!u(e))return(0,s.cY)("Chat Message header received in response chatMessageHeaderType: ",e.chatMessageHeaderType),e.chatMessageHeaderType===l.Hu.Personalization_Indicator&&((0,s.cY)("Personalization header received in response"),s.EG.sendChatEventTelemetry((0,a.pN)(((t={})[c.h3.ChatEventType]=c.a5.PersonalizationIndicatorShown,t[c.h3.IsPersonalizedResponse]=!0,t))),s.EG.sendLatencyTelemetry((0,a.pN)(((n={})[c.CT.IsPersonalizedResponse]=!0,n)))),{titleText:null!==(o=null==e?void 0:e.title)&&void 0!==o?o:"",popoverText:null!==(r=null==e?void 0:e.expandedTitle)&&void 0!==r?r:void 0}};function f(e){var t=Array.from(e,(function(e){return String.fromCodePoint(e)})).join("");return btoa(t)}var C=function(e){return"bot"===e.author&&"GeneratedCode"===e.messageType},y=function(e,t){return{shouldShowViewCodeButton:t,code:null==e?void 0:e.text,stdout:""}};function v(e){return"string"==typeof e&&e.length>=2&&e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1)),e}var T=function(e,t){var n;(null===(n=null==e?void 0:e.current)||void 0===n?void 0:n.updateExecutionStatusForAddInActions)&&e.current.updateExecutionStatusForAddInActions(t)}},639599:(e,t,n)=>{"use strict";var a;n.d(t,{C$:()=>m,UQ:()=>a,lf:()=>d,t7:()=>u}),function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(a||(a={}));const o=[{dimension:"categories",excelAxisType:"Category",ivyDimension:"categoryValues",isValue:!1,orientation:0,isHundredPercent:!1,axisGroup:"primary"},{dimension:"values",excelAxisType:"Value",ivyDimension:"values",isValue:!0,orientation:1,isHundredPercent:!1,axisGroup:"primary"}],r=[{dimension:"categories",excelAxisType:"Category",ivyDimension:"categoryValues",isValue:!1,orientation:1,isHundredPercent:!1,axisGroup:"primary"},{dimension:"values",excelAxisType:"Value",ivyDimension:"values",isValue:!0,orientation:0,isHundredPercent:!1,axisGroup:"primary"}],i=[{dimension:"xValues",excelAxisType:"Category",ivyDimension:"xValues",isValue:!0,orientation:0,isHundredPercent:!1,axisGroup:"primary"},{dimension:"yValues",excelAxisType:"Value",ivyDimension:"yValues",isValue:!0,orientation:1,isHundredPercent:!1,axisGroup:"primary"}],l=[{dimension:"categories",excelAxisType:"Category",ivyDimension:"categoryValues",isValue:!1,orientation:0,isHundredPercent:!1,axisGroup:"primary"},{dimension:"values",excelAxisType:"Value",ivyDimension:"values",isValue:!0,orientation:1,isHundredPercent:!0,axisGroup:"primary"}],s=[],c={area:o,areaStacked:o,areaStacked100:l,barClustered:r,barStacked:r,barStacked100:[{dimension:"categories",excelAxisType:"Category",ivyDimension:"categoryValues",isValue:!1,orientation:1,isHundredPercent:!1,axisGroup:"primary"},{dimension:"values",excelAxisType:"Value",ivyDimension:"values",isValue:!0,orientation:0,isHundredPercent:!0,axisGroup:"primary"}],columnClustered:o,columnStacked:o,columnStacked100:l,line:o,lineStacked:o,lineStacked100:l,bubble:i,doughnut:s,pie:s,radar:o,scatter:i,histogram:o};function d(e){return e in c?c[e]:[]}function u(e){const t=m(e,"values");if(void 0===t)throw new Error("unsupported secondary axis type");return[{...t,axisGroup:"secondary"}]}function m(e,t){return c[e].find((e=>e.dimension===t))}},639765:(e,t,n)=>{"use strict";var a;n.d(t,{c:()=>a}),function(e){e.AE_Execution_Unsupported="AE execution unsupported",e.Analyze_Data_AugLoop_Timeout="Analyze Data AugLoop timeout",e.Analyze_Data_Insights_Services_Error="Analyze Data Insights Services error",e.Analyze_Data_Insights_Services_Timeout="Analyze Data Insights Services timeout",e.Analyze_Data_Network_Error="Analyze Data network error",e.Analyze_Data_Other_Error="Analyze Data other error",e.Analyze_Data_Get_Insights_Client_Error="Analyze Data get insights client error",e.Analyze_Data_Evaluate_Query_Client_Error="Analyze Data evaluate query client error",e.Analyze_Data_Text_Analysis_Unsupported_Language="Analyze Data text analysis unsupported language",e.Analyze_Data_LLM_Timeout="Analyze Data LLM timeout",e.Analyze_Data_Undo_Failed="Analyze Data undo failed",e.Answers_Undo_Failed="Answers Undo Failed",e.Answers_User_Thumbs_Down="Answers User Thumbs Down",e.Answers_PostView_Failed="Answers Postview Failed",e.Answers_Bad_Response="Answers Bad Response",e.Answers_Processing_Failed="Answers Processing Failed",e.Apply_Table_Creation_Failed_Due_To_Issue_With_Location="Apply table creation failed due to issue with location",e.Augloop_Error="Unclassified AugLoop error",e.Augloop_Error_Occurred_No_Chat_Response="Augloop Error Occurred with No Chat Response",e.Augloop_Failed_Entitlement_Validation="AugLoop failed to validate the user's Copilot entitlement",e.Augloop_Failed_Input_Error="AugLoop failed due to AugLoop input error",e.Augloop_Failed_License_Check_Due_To_Missing_Service_Plan_BYOA="AugLoop failed Copilot license check due to missing service plan BYOA",e.Augloop_Failed_License_Check_Due_To_Uncategorized_Error_Code="AugLoop failed Copilot license check due to uncategorized error code",e.Augloop_Failed_License_Check_Due_To_Uncategorized_Error_Reason="AugLoop failed Copilot license check due to uncategorized error reason",e.Augloop_Failed_Token_Validation="AugLoop failed to validate the Copilot user token",e.Augloop_Response_Timed_Out="Augloop Response Timed Out",e.Calculate_Preview_Timeout="Calculate preview timeout",e.Calculate_Suggestion_Timeout="Calculate suggestion timeout",e.Calculated_Column_Out_Of_Scope_Scenarios="Calculated column out of scope scenarios",e.ChartDesignRecommendationsEmptySceneGraph="Chart Recommendation Signal Returned Empty Scenegraph",e.ChartDesignRecommendationsWorkflowFailed="Chart Design Recommendations Workflow Failures",e.Chat_Error_Message_Shown="Chat error message shown (catch-all, may overlap with other errors)",e.Chat_History_Response_Timed_Out="Chat history response timed out",e.Chat_User_Thumbs_Down="Chat user thumbs down",e.Client_Program_Response_Error="Client program response error",e.Command_Execution_Blocked_By_Capacity="Command execution blocked by capacity",e.Command_Execution_Happened_With_No_Confirmation_Of_Action="Command execution happened with no confirmation of action",e.Command_Execution_Took_Too_Long="Command execution took too long",e.Command_Execution_Undo_Failed="Command execution undo failed",e.Command_Scratchpad_Start_New_Session_Failed="Command Scratchpad start new session failed",e.Command_Scratchpad_Office_Js_Execution_Failed_In_Runtime="Command Scratchpad office js execution failed in runtime",e.Command_Scratchpad_Office_Js_Internal_Error="Command Scratchpad office js internal error",e.Command_Scratchpad_Non_Copilot_Safe_Apis_Generated="Command Scratchpad non-copilot safe APIs generated",e.Conditional_Formatting_Execution_Took_Too_Long="Conditional Formatting execution took too long",e.Conditional_Formatting_Failed_Due_To_Out_Of_Scope_Prompt="Conditional Formatting failed due to out of scope prompt",e.Conditional_Formatting_Failed_Due_To_Invalid_Formula="Conditional Formatting failed due to invalid formula",e.Conditional_Formatting_Failed_Due_To_Invalid_Formula_Explanation="Conditional Formatting failed due to invalid formula explanation",e.Conditional_Formatting_Failed_Due_To_Invalid_Targets="Conditional Formatting failed due to invalid targets",e.Conditional_Formatting_No_Suggestions_Error="Conditional Formatting no suggestions error",e.Conditional_Formatting_Suggestions_Error="Conditional Formatting suggestions error",e.Conditional_Formatting_Suggestions_Error_Due_To_No_Table_Selected="Conditional Formatting suggestions error due to no table selected",e.Conditional_Formatting_Undo_Failed="Conditional Formatting execution undo failed",e.Context_Extraction_Error="Context extraction error",e.Disengaged_Error="AugLoop failed due to Sydney disengage",e.Else_Response_Blocked_Bad_Formula="Response blocked due to invalid formula",e.Else_Response_Blocked_Security_Restricted_Formula="Response blocked due to security restricted formula",e.Else_Response_Blocked_External_Workbook_Reference_Formula="Response blocked due to external workbook reference formula",e.Else_Response_Blocked_Unsupported_Chaining="Response blocked due to unsupported chaining",e.Else_Service_Timed_Out="Service timed out",e.Else_Service_Error="Service error",e.Else_User_Thumbs_Down="User dissatisfied with the suggestion",e.Failed_Column_Insertion="Failed column insertion",e.Failed_Column_Insertion_Due_To_Conflict_In_The_Target_Range="Failed column insertion due to conflict in the target range",e.Failed_Column_Insertion_Due_To_Protection_Settings="Failed column insertion due to protection settings",e.Failed_Column_Insertion_Due_To_Target_Table_Error="Failed column insertion due to target table error",e.Failed_Column_Suggestion_Generation_For_Suggestion_Pill="Failed column suggestion generation for suggestion pill",e.Failed_Column_Suggestion_Generation_For_User_Prompt="Failed column suggestion generation for user prompt",e.Failed_Command_Execution_Due_To_Other_Error="Failed command execution due to other error",e.Failed_Command_Execution_Due_To_Protection_Settings="Failed command execution due to protection settings",e.Failed_Conditional_Formatting_Execution_Due_To_Other_Error="Failed onditional formatting execution due to other error",e.Failed_Conditional_Formatting_Execution_Due_To_Protection_Settings="Failed conditional formatting execution due to protection settings",e.Failed_Due_To_Skill_Failure="Failed due to Service Error (Skill failure)",e.Failed_During_Prompt_Construction_Or_Postprocessing="Failed during prompt construction or postprocessing",e.Failed_Parse_ODSL="Failed to parse generated ODSL",e.Failed_Parse_ODSL_Zero="Failed to parse generated ODSL (no ODSL present)",e.Failed_Parse_ODSL_Date_Logic="Failed to parse generated ODSL (unsupported date logic)",e.Failed_Parse_ODSL_No_Op="Failed to parse generated ODSL (no program effect)",e.Failed_Insight_Generation_Due_To_No_Patterns_In_Data="Failed insight generation due to no patterns in data",e.Failed_Insight_Generation_Due_To_No_Requested_Data_In_The_Source_Data="Failed insight generation due to no requested data in the source data",e.Failed_Insight_Generation_Due_To_Not_Enough_Info="Failed insight generation due to not enough info",e.Failed_Insight_Generation_Due_To_Other_Error="Failed insight generation due to other error",e.Failed_Insight_Generation_Due_To_Out_Of_Scope_Error="Failed insight generation due to out of scope error",e.Failed_Insight_Generation_Due_To_Too_Large_Data="Failed insight generation due to too large data",e.Failed_Insight_Insertion="Failed insight insertion",e.Failed_Insight_Insertion_Due_To_Protection_Settings="Failed insight insertion due to protection settings",e.Failed_Insight_Insertion_Due_To_User_Edits="Failed insight insertion due to user edits",e.Failed_To_Copy_Code="Failed to copy code",e.Failed_To_Copy_Response="Failed to copy chat response",e.Failed_To_Insert_Table="Failed to insert table from chat response",e.Features_In_Development="Features in development or under flight",e.Formula_Description_Failed_To_Display="Formula description failed to display",e.Formula_Explanation_Failed_To_Display="Formula explanation failed to display",e.Formula_Generation_Columns_Letters_Mismatch_Between_Title_And_Preview="Columns letters mismatch between title and preview",e.Formula_Generation_Failed_To_Send_Signal="Failed to send formula generation signal",e.Formula_Generation_Unsupported_Multiple_Columns="Unsupported multiple columns generation",e.Formula_Generation_Unsupported_Multiple_Rows="Unsupported multiple rows generation",e.Generated_Output_Error="Offensive content detected in generated output",e.InferenceAPI="Inference API",e.InferenceAPI_Not_Available="Inference API not available",e.InferenceAPI_Timeout="Inference API timeout",e.Input_Blocked_Guardlist="Input blocked by dynamic guard list so no response",e.Input_Blocked_Prompt_Injection="Input blocked due to prompt injection so no response",e.Input_Failed_Due_To_Augloop_Session_Close="Input failed due to Augloop session close",e.Input_Failed_Due_To_Memory="Input failed due to memory",e.Input_Language_Unsupported="Input language unsupported",e.Insights_Visual_Converter_Unsupported="Insights visual converter unsupported",e.Invalid_AE_Generated="Invalid AE response was generated by LLM",e.Invalid_Column_Name="Invalid column name was generated by LLM",e.Invalid_Json_Format="Invalid Json format was generated by LLM",e.Invalid_ODSL_Generated="Invalid ODSL was generated",e.Invalid_Response_Type="Invalid response type was generated by LLM",e.Invalid_Text_Analysis_Response="Invalid text analysis response was generated by LLM",e.Input_Resulted_In_Unsupported_Command="Input resulted in unsupported command",e.Input_Was_Offensive_So_No_Response="Input was offensive so no response",e.Inserting_Column_Took_Too_Long_Time="Inserting column took too long time",e.Input_Exceeded_Max_Length="Input exceeded max length",e.Input_Too_Long="Input Query is too long, or has too many tokens",e.Input_Too_Short="Input too short",e.Input_Query_Error="Error occurred because input query is offensive",e.Input_Query_Error_Invalid="The program/app name cannot be determined because the input is invalid",e.Input_Query_Error_Out_Of_Scope="The intent for the input cannot be determined because the input is out of scope",e.Import_Data_Card_Rendering_Error="Error occurred while trying to render the import card",e.Import_Data_File_Fetching_Error="Error occurred while trying to fetch file metadata",e.Import_Data_File_Fetching_Timeout="Timeout occurred while trying to fetch file metadata",e.Import_Data_Relevancy_Error="Error occurred while trying to run relevancy signal",e.Import_Data_Relevancy_Timeout="Timeout occurred while trying to run relevancy signal",e.Import_Data_Load_Query_Error="Error occurred while trying load query from import data",e.Import_Data_RAI_Error="RAI error during import data",e.Import_Data_General_Error="General error on import data",e.import_Data_Thumbs_Down="Thumbs down for import data card",e.LLM_HTTP_Request_Error="LLM HTTP request error",e.LLM_Identifies_UnanswerableQuery="LLM identifies the query is unanswerable",e.LLM_Thinks_Ambiguous="LLM thinks the query is too ambiguous",e.LLM_Throttled="LLM throttled",e.LLM_Service_Error="LLM service error",e.Mismatch_Between_Preview_And_Grid_Values="Mismatch between preview and grid values",e.Missing_HITL_Intent_String="Missing human in the loop intent string",e.Multiple_Intents_Detected="Orchestration failed due to multiple intents",e.ODSL_Execution_Failed_Due_To_Converter_Error="ODSL execution failed due to a converter error",e.ODSL_Execution_Failed_Due_To_Invalid_Targets="ODSL execution failed due to invalid targets",e.ODSL_Execution_Failed_Due_To_Out_Of_Scope_Prompt="ODSL execution failed due to out of scope prompt",e.ODSL_Execution_Failed_Due_To_Out_Of_Scope_Targets="ODSL execution failed due to out of scope targets",e.ODSL_Execution_Failed_Due_To_Payload_Too_Large="ODSL execution failed due to payload too large",e.ODSL_Execution_Failed_Due_To_Entity_Type_Mismatch="ODSL execution failed due to entity type mismatch",e.ODSL_Execution_Failed_Due_To_Unsupported_Commands="ODSL execution failed due to unsupported commands",e.ODSL_Execution_Failed_General_Error="ODSL execution failed general error",e.ODSL_Execution_Failed_With_Multiple_Events="ODSL execution failed with multiple events",e.Orchestration_Failed_Sydney="Orchestration failed due to Service Error (Sydney)",e.Orchestration_Failed_When_Calling_OfficeJS_Sensitivity_API="Orchestration failed when calling OfficeJS sensitivity API",e.Orchestration_Failed_When_Could_Not_Fetch_Sensitivity_Label="Orchestration failed when could not fetch sensitivity label",e.Organization_Policy_Does_Not_Allow_This_Type_Of_Content="Organization policy does not allow this type of content",e.Other_Input_Attack_Detected="Other input attack detected",e.Out_Of_Credits="Customer has no remaining Copilot credits",e.Output_Blocked_By_Guard_List="Output blocked by guard list",e.Output_Deemed_Offensive="Output deemed offensive",e.Pane_Crashed="Pane crashed",e.Pane_Failed_To_Hydrate_Previous_Chat_History="Pane failed to hydrate previous chat history",e.Pane_Taking_Too_Long_To_Load="Pane taking too long to load",e.Pane_Taking_Too_Long_To_Load_After_Disabled_Screen="Pane taking too long to load after disabled screen",e.Pane_Taking_Too_Long_To_Load_Due_To_CellEditMode_PrivateHost="Pane taking too long to load due to cell edit mode in private host",e.Pane_Taking_Too_Long_To_Load_Due_To_CellEditMode_InitializeTasks="Pane taking too long to load due to cell edit mode in initialize tasks",e.Preview_On_Card_Failed_To_Display="Preview on card failed to display",e.Preview_On_Grid_Failed_To_Display="Preview on grid failed to display",e.Prompt_Injection_Detected="Prompt injection detected",e.Pre_Python_Mode_Error="Pre Python mode error",e.Python_Add_Results_To_New_Sheet="Adding results to new sheet failed",e.Python_Analysis_Sheet_Deleted="Python analysis sheet deleted",e.Python_Analysis_Sheet_Metadata_Error="Python analysis sheet metadata error",e.Python_AugLoop_Calls_Per_Query_Maximum_Hit="Python AugLoop calls per query maximum hit",e.Python_Bad_Object_Reference="Python Bad Object Reference",e.Python_Cell_Edit_Mode="Python Cell Edit Mode",e.Python_Load_Cells_Start_Analysis_Error="Python load cells start analysis error",e.Python_Code_Retry_Maximum_Hit="Python code retry maximum hit",e.Python_Code_And_PostView_Props_Not_Serializable="Python code and PostView card props not serializable.",e.Python_Exit_Analysis="Python failed to exit analysis",e.Python_Failed_To_Insert_Code="Python failed to insert code",e.Python_Failed_To_Get_Diagnostics="Python failed to get diagnostics object",e.Python_Failed_To_Print_Formatted_Number="Python failed to print formatted number",e.Python_General_Grid_Error="Python general grid error",e.Python_Access_Error="Python access error",e.Python_Calc_Error="Python calc error",e.Python_Missing_Or_Invalid_Response="Python missing or invalid response",e.Python_Payload_Empty="Python payload empty",e.Python_PostView_Failed="Python inserting PostView failed",e.Python_Runtime_Busy="Python runtime busy",e.Python_Runtime_In_Bad_State="Python runtime in bad state",e.Python_Teaching_Callout_Not_Shown="Python teaching callout not shown",e.Python_TLR_Unsupported_Features="Python TLR unsupported features",e.Python_Unknown_Error="Python unknown error",e.Python_User_Thumbs_Down="Python user thumbs down",e.Python_Multiple_Open_Workbooks="Python multiple open workbooks",e.Python_Undo_Failed="Python undo failed",e.RAI_Validation_Failed="RAI Validation failed",e.Requested_Visual_Type_Unsupported="Requested visual type unsupported",e.Scenario_Throttled="Scenario has issued too many requests",e.Search_Sensitivity_API_Error="Search sensitivity API error",e.Search_User_Thumbs_Down="Search user thumbs down",e.Service_Error_Augloop="Service error (AugLoop)",e.Service_Error_Unknown_Error="Service Error (unknown error)",e.Service_Timeout="Service timed out waiting on the client",e.Suggestion_Blocked_Due_To_Code_Generated_Being_Protected_By_Copyright_Licensing="Suggestion blocked due to code generated being protected by copyright/licensing",e.Suggestion_Blocked_Due_To_RAI="Suggestion blocked due to RAI",e.Sydney_Bad_Converstaion_Id="Sydney failed due to bad conversation id",e.Sydney_Cancelled_Error="Connection to Sydney is cancelled",e.Sydney_Error="Sydney error",e.Sydney_Timeout="Sydney timeout",e.Sydney_Unknown_Error="Sydney unknown error",e.Sydney_Websocket_Failed="Sydney failed to connect",e.Tabular_Range_Unsupported="Tabular Range Unsupported",e.Throttled="Server too busy",e.Undo_Calculated_Columns_Error="Undo calculated column error (Undo button error)",e.Unsupported_Platform_For_Python_In_Excel="Unsupported platform for Python in Excel",e.User_Dissatisfied_With_Suggestion_Calculated_Columns="User dissatisfied with the suggestion",e.User_Input_Deemed_Offensive="User input deemed offensive",e.User_Stopped_Execution="User stopped execution",e.User_Stopped_Execution_Short="User stopped execution (short duration)",e.User_Throttled="User has issued too many requests",e.Users_Python_License_Could_Not_Be_Validated="User's Python license could not be validated",e.Table_Like_Entity_Not_Found="Table-like entity not found",e.Unsupported_Object_Selected="Unsupported object selected",e.Payload_Too_Large="Table Data Too Large",e.TLR_Auto_Fix_Undo_Failed="Tabular range auto fix undo failed",e.Python_Failed_Due_To_Protected_Sheet="Python failed due to protected sheet",e.Python_Skill_Failed="Python skill failed",e.Python_Image_Unavailable_Due_To_Analysis_Sheet_Deleted="PythonImageUnavailableAnalysisSheetDeletedError",e.Answers_Insert_Failed="Answers insert failed",e.Answers_Collapsable_Code_On_Click_Failed="Answers collapsable code on click failed",e.Answers_Component_Props_Not_Serializable="Answers_Component_Props_Not_Serializable",e.Python_Execution_Blocked_By_Admin="Python execution blocked by admin",e.Answers_Interactive_Chart_Failed="Answers interactive charts failed",e.Python_Start_Analysis_Failed="Python start analysis failed",e.RichAPI_General_Exception="RichAPI general exception"}(a||(a={}))},639969:(e,t,n)=>{"use strict";n.d(t,{$U:()=>re,DD:()=>de,HE:()=>te,HO:()=>he,K5:()=>ue,L4:()=>$,Nl:()=>z,PQ:()=>K,Q4:()=>me,RX:()=>ce,SW:()=>se,Vf:()=>J,Y4:()=>ne,YS:()=>H,Yx:()=>G,_Z:()=>M,dT:()=>Y,eB:()=>ge,eM:()=>B,gp:()=>le,it:()=>j,jc:()=>ae,nv:()=>oe,oh:()=>O,q9:()=>ie,qc:()=>ee,x4:()=>Z,yG:()=>Q,zA:()=>D});var a=n(279395),o=n(881707),r=n(178365),i=n(379422),l=n(737649),s=n(517582),c=n(446751),d=n(294426),u=n(8403),m=n(857677),g=n(318969),h=n(764080),p=n(1329),b=n(291436),f=n(70239),C=n(76872),y=n(316904),v=n(664007),T=n(281161),x=n(982306),S=n(650444),w=n(109174),E=n(92520),I=n(126521),R=n(347145),A=n(140235),L=n(469486),k=n(672270),F=n(795786),_=n(110686);const P=y.M.getInstance(),N=C.E.getInstance(),M=e=>async()=>{if((0,R._bw)()){const t=(0,R.yw9)("OfficeVSO_9629324_ValidateLabel");(0,E.cY)("ODSL scenario success, updating document sensitivity");const n=o.n.getInstance().getInDocSensitiveLabelInfo(),a=await o.n.getInstance().upgradeSensitivityLabelUsingOfcJs(n,t);N?.updateTelemetryChatEventData({[m.h3.ChatEventType]:m.a5.DocumentClpUpgrade,[m.h3.ChatEventParameters]:`CallerData: ${JSON.stringify(e)}, result: ${JSON.stringify(a)}`},P)}},O=(e,t)=>async(n,o)=>{const{currentNLResult:i,currentNLResultVisualIndex:l}=o().chat,{activeRequestId:s}=o().selection;if(!i)return;const c=!1===i.fullyUnderstoodRewrittenQuery?(0,a.bUh)():(0,a.YTh)(),d=i.visualAnswer[l+1];if(!d)return;const u=(0,k.Yd)(d.visual.visualType)??"visual",m=c.replace("{0}",u),{message:g,telemetry:h}=F.n.getAnalyzeDataRecommendationResponse({visual:d,requestId:s[e],responseText:m,tableName:e,tableContext:t});r.$.getInstance().displayResponse(g,h);const p=(0,A.t)(d,m,i.textAnswer?.tokens.map((e=>e.text)).join(""));n(oe(p,b.Aw.success,h)),n(v.m.incrementCurrentNLResultVisualIndex())},D=(e,t)=>async(n,a)=>{const{currentRecos:o,currentRecoIndex:i,suggestionList:l}=a().chat,{activeRequestId:s}=a().selection;if(!o)return;const c=i+1,d=o[c],{message:u,telemetry:m}=F.n.getAnalyzeDataRecommendationResponse({visual:d,requestId:s[e],responseText:"",tableName:e,tableContext:t});r.$.getInstance().displayResponse(u,m),c===o.length-1&&(l.length<=1?n(z()):n(v.m.removeFirstSuggestionPill())),n(v.m.incrementRecoIndex())},B=(e,t)=>async n=>{w.CP.lockContextRefresh(e),n(v.m.startExecutingCommand({command:e,id:t}))},$=(e,t)=>async n=>{(0,d.z)()&&await d.g.getInstance().removeGridFoil(),void 0!==w.CP.getQueryIdShouldNotShowFluxResponse()&&w.CP.setQueryIdShouldNotShowFluxResponse(void 0),await w.CP.releaseContextLock(),t||n(v.m.hideLoadingUI()),n(v.m.stopExecuting({isSuccess:e,keepShowingLoadingUIIfAlreadyActive:t}))},H=()=>async(e,t)=>{e(v.m.setCurrentNLResultInvalid());const{currentNLResult:n}=t().chat;e(X(n))},U=()=>(e,t)=>{const n=w.CP.getActiveTable(),{nextSuggestionTypePriorities:a,recentlyShownPrompts:o}=t().chat,r=V(t,n?.name);let i={suggestionList:[]};if(a.length>0){const e=r.filter((e=>a.includes(e.suggestionType)));i=(0,g.g4)(n,e,o)}return 0===i.suggestionList.length&&(i=(0,g.g4)(n,r,o)),i},q=()=>async(e,t)=>{const n=e(U());n.shouldResetRecentPrompts&&e(v.m.setRecentlyShownPrompts([])),e(v.m.setSuggestionListDetails({...n,nextSuggestionTypePriorities:[]}))},V=(e,t="")=>{const n=(e().selection.suggestions[t]??[]).map((e=>({suggestionText:e,suggestionType:"AnalyzeData_SpecificSuggestion"}))),o=W(e);n.push(...o);const r=e().chat.latestRequestId,i=r&&e().dataAI.recommendations[r]||[],l=[],s=new Set;i.forEach((e=>{(0,c.iM)(e)&&e.calculatedFormulas.forEach((e=>{s.has(e.columnName.toLocaleLowerCase())||(s.add(e.columnName.toLocaleLowerCase()),l.push({suggestionText:(0,I.L)((0,a.ZKU)(),e.columnName),suggestionType:"CalculatedColumns_SpecificSuggestion"}))}))}));const{fillablePromptList:d}=e().chat,u=(0,R.H2A)()&&((0,L.gx)()||(0,R.ggM)()&&(0,R.yw9)("OfficeVSO_10277196_AnswersSkipLicenseCheckFixed")&&(0,L.XT)()),m=t&&u?[{suggestionText:(0,a.Bzb)(),suggestionType:"Python_Suggestion_FromRefreshList"}]:[],g=[...d??[],...n,...l,...m];return(0,k.R3)(g)},W=e=>{const t=e().chat.currentNLResult?.relatedQuestions;if(t){return t.map((t=>({suggestionText:t.query.tokens.map((e=>e.token.text)).join(""),suggestionType:"AnalyzeData_RelatedQuestions",suggestionLanguage:e().chat.currentNLResult?.outputLanguage})))}return[]},G=(e=[])=>async t=>{t(v.m.setNextSuggestionTypePriorities(e)),t(q())},z=()=>async e=>{e(v.m.setRecentlyShownPrompts([])),e(v.m.setSuggestionListDetails({suggestionList:(0,g.XX)(),nextSuggestionTypePriorities:[]}))},Q=()=>async(e,t)=>{N?.updateTelemetryChatEventData({[m.h3.ChatEventType]:m.a5.SuggestionPaneSuggestionClicked,[m.h3.ChatEventParameters]:"MorePrompts"},P),(0,x.K)(t().chat.suggestionList,"AnalyzeData_RelatedQuestions")?e(G(["AnalyzeData_RelatedQuestions"])):e(q())},j=()=>async e=>{e(v.m.setZqmSuggestionList())},J=(e,t,n,o=1)=>async r=>{const i=[{suggestionText:n===c.VS.Column?t?(0,a.wzr)():(0,a._1n)():(0,a.jcG)(),suggestionType:"CalculatedColumns_ShowMore",calculatedFormulaSuggestionMessage:{requestId:e,requestIndex:o}}];r(v.m.setSuggestionListDetails({suggestionList:i,nextSuggestionTypePriorities:["CalculatedColumns_SpecificSuggestion"]}))},Y=e=>async t=>{const n=e.slice(0,2).map((e=>({suggestionText:e,suggestionType:"Python_Suggestion"})));t(v.m.setSuggestionListDetails({suggestionList:n,nextSuggestionTypePriorities:["Python_Suggestion"],isPythonSuggestion:!0}))},X=e=>async(t,n)=>{const o=n().chat.isCurrentNLResultValid;let r={suggestionList:[],nextSuggestionTypePriorities:["AnalyzeData_SpecificSuggestion"]},i=!1;if(e){if(e.visualAnswer?.length>1&&o){const e=`${(0,a.G5z)()[1]}`;r.suggestionList=[{suggestionText:(0,a.G5z)()[0],suggestionType:"AnalyzeData_ShowMore"},{suggestionText:e,suggestionType:"AnalyzeData_InsertAll"}]}else if(e.visualAnswer?.length>1)i=!0,r.suggestionList=[{suggestionText:(0,a.Tr2)(),suggestionType:"AnalyzeData_Suggestion"}];else if(e.relatedQuestions&&e.relatedQuestions.length>0){const t=e.relatedQuestions.map((e=>e.query.tokens.map((e=>e.token.text)).join(""))).slice(0,g.xP).map((e=>({suggestionText:e,suggestionType:"AnalyzeData_RelatedQuestions"})));r.suggestionList=t,r.nextSuggestionTypePriorities=["AnalyzeData_RelatedQuestions"]}else e.responseType!==h.WZ.Answered?r.suggestionList=[{suggestionText:(0,a.Dvy)(),suggestionType:"AnalyzeData_Suggestion"}]:(t(v.m.setNextSuggestionTypePriorities(["AnalyzeData_SpecificSuggestion"])),r=t(U()),r.shouldResetRecentPrompts&&t(v.m.setRecentlyShownPrompts([])));var l;i||(l=r.suggestionList,(0,R.H2A)()&&((0,L.gx)()||(0,R.ggM)()&&(0,R.yw9)("OfficeVSO_10277196_AnswersSkipLicenseCheckFixed")&&(0,L.XT)())&&(l.unshift({suggestionText:(0,R.yw9)("OfficeVSO_10297193_changeAASuggestionPillFromAD")&&!(0,L.$)()?(0,a.fkZ)():(0,a.Bzb)(),suggestionType:"Python_Suggestion_FromAnalyzeData"}),l.splice(g.jc))),r.suggestionList.forEach((t=>{t.suggestionLanguage=e.outputLanguage})),t(v.m.setSuggestionListDetails(r))}else t(z())},Z=e=>async(t,n)=>{let a=(0,g.$c)(e);a&&0!==a.length&&(a=a.concat(n().chat.suggestionList),t(v.m.setSuggestionListDetails({suggestionList:a})))},K=(e,t,n)=>async a=>{e.discoverInsights?.length>0&&(e.visualAnswer=e.discoverInsights,e.responseType=h.WZ.Answered,e.answerForDiscoverInsights&&(e.textAnswer=e.answerForDiscoverInsights)),e.visualAnswer?.length>6&&(e.visualAnswer=e.visualAnswer.slice(0,6)),a(v.m.updateCurrentNLResult({isCurrentNLResultValid:!0,currentNLResult:e,currentNLResultVisualIndex:0,tableName:t,tableContext:n})),a(X(e))},ee=(e,t)=>async n=>{const o=e.length>6?e.slice(0,6):e;n(v.m.updateCurrentRecos(o)),n(((e,t)=>async n=>{if(e.length<=1)n(z());else if("ChartReco"===t){const e=`${(0,a.G5z)()[1]}`;n(v.m.setSuggestionListDetails({suggestionList:[{suggestionText:(0,a.YXQ)(),suggestionType:"AnalyzeData_ShowMoreCharts"},{suggestionText:e,suggestionType:"AnalyzeData_InsertAllCharts"}]}))}else n(v.m.setSuggestionListDetails({suggestionList:[{suggestionText:(0,a.Q40)(),suggestionType:"AnalyzeData_ShowMorePivotTables"}]}))})(o,t))},te=(0,u.YQ)(((e,t,n)=>t().chat.queryOriginByQueryId[n])),ne=(0,u.YQ)(((e,t,n)=>t().chat.onGridQueryCellAddressByQueryId[n])),ae=(0,u.YQ)(((e,t,n)=>t().chat.onGridQueryElseCategoryOverrideByQueryId[n])),oe=(e,t,n,o=!0,i=!0,l)=>async c=>{if(!r.$.getInstance().getIsSkillResponseRequired())return;s.Q.getInstance().recordFluxCopilotStep({operation:m.OP.FluxSkillEnd,featureName:n.featureName}),e||(e=t===b.Aw.success?(0,a.Twc)():(0,a._h7)()),await c(re(t,e,l));const d=t===b.Aw.success;d||await c((0,_.f1)()),i&&(c(v.m.stopExecuting({isSuccess:d,keepShowingLoadingUIIfAlreadyActive:o})),o&&c(v.m.startExecutingCommand({command:m.OP.FluxGenerateResponse,id:y.M.userQueryGuid})))},re=(e,t,n)=>async()=>{r.$.getInstance().setIsSkillResponseRequired(!1);const a=e===b.Aw.success||e===b.Aw.cancelled,o=new i.DE({queryId:y.M.userQueryGuid,status:e,message:a?t:void 0,error:a?void 0:t,isTextAnalysis:n}),s=new f.g0({parentPath:["Signal",i.DE.getTypeName()],items:[{id:p.r.generateId(),body:o}]});(0,E.cY)("Sending ExcelCopilotProgramResponseSignal to AL"),r.$.getInstance().submitOperation({operation:s,workflowAnnotationType:l.Yn.getTypeName()})},ie=()=>async(e,t)=>t().chat.executingCommand,le=()=>async(e,t)=>t().chat.isInsertingFormulaSuggestion,se=()=>(e,t)=>t().chat.dataShapingState,ce=e=>async t=>{await(0,T.UD)(t,e)},de=e=>async t=>{await(0,T.bs)(t,e)},ue=e=>async t=>{await(0,T.Kz)(t,e)},me=e=>async t=>{await(0,T.fo)(t,e)},ge=e=>async(t,n)=>{const{feature:a}=n().chat.singleModeState;switch(a){case"off":throw new Error("Single mode is not enabled");case"python":throw new Error("Python single mode is not supported yet");case"dataShaping":t((o=e,async e=>{await(0,T.Nl)(e,o)}));break;default:(0,S.x)(a)}var o;t(v.m.exitSingleMode())},he=()=>(e,t)=>t().chat.lastPythonQueryId},648982:(e,t,n)=>{"use strict";n.d(t,{s:()=>Se});var a=n(279395),o=n(432874),r=n(956933),i=n(83437),l=n(702864),s=n(638753),c=n(660606),d=n(423905);function u(e,t){var n,a;void 0===t&&(t=!1);var o=(e||[]).filter((function(e){return!(!e.cardJson||e.sourceType&&"CITATION"!==e.sourceType)})),r=null!==(n=null==o?void 0:o.length)&&void 0!==n?n:0;return r>0?((0,c.cY)("Getting msgExtProp for MsgExtCard here.."),a={attributions:o},t&&(0,d.d_)(r)):(0,c.cY)("No data(cardJson) found for MsgExtCard."),a}function m(e,t){var n,a;void 0===t&&(t=!1);var o=(e||[]).filter((function(e){return!(!e.adaptiveCardJson||e.sourceType&&"CITATION"!==e.sourceType)})),r=null!==(n=null==o?void 0:o.length)&&void 0!==n?n:0;return r>0?((0,c.cY)("Getting apiPluginProp for ApiPluginCard here.."),a={attributions:o},t&&(0,d.ys)(r)):(0,c.cY)("No data(adaptiveCardJson) found for ApiPluginCard."),a}var g=n(480591),h=n(639765),p=n(548366),b=n(101960),f=n(293879),C=n(86940),y=n(708353),v=n(355908),T=n(47717),x=n(92520);class S{static getInstance(){return S.instance||(S.instance=new S),S.instance}getUrlForCitation(e){return(0,x.hX)(e.path)?e.seeMoreUrl:void 0}getReferenceSourceType(e){return e.sourceType===a.YgX?v.GH.Annotation:v.GH.Citation}constructor(){this.CitationFileTypeMap=new Map([[T.YA.PowerPoint,v._R.PowerPoint],[T.YA.Excel,v._R.Excel],[T.YA.Word,v._R.Word],[T.YA.OneNote,v._R.OneNote],[T.YA.Outlook,v._R.Outlook],[T.YA.Teams,v._R.Teams],[T.YA.Event,v._R.Event],[T.YA.Meeting,v._R.Meeting],[T.YA.TeamsMeeting,v._R.Meeting],[T.YA.SharePoint,v._R.SharePoint],[T.YA.PDF,v._R.Pdf],[T.YA.Zip,v._R.Pdf],[T.YA.Visio,v._R.Visio],[T.YA.Fluid,v._R.Loop],[T.YA.Txt,v._R.Txt]]),this.lastBuilderCitationsTypes=[],this.getLastBuildCitationsTypes=()=>this.lastBuilderCitationsTypes,this.getSnippetFromCitationContent=e=>e?'"'+(e.length>a.T1Y?e.slice(0,a.T1Y)+"...":e)+'"':null,this.getChatReferenceType=(e,t,n)=>e===T.YA.Web||void 0===e?v._2.External:void 0!==e&&Object.values(v._R).includes(e)?v._2.CrossApp:void 0===t?v._2.External:n?.path?((0,x.cY)("CitationBuilder: internal citation is not supported in excel: ",n.path),v._2.Internal):this.CitationFileTypeMap.has(t)?v._2.CrossApp:v._2.External,this.getCrossAppCitationFileType=e=>{if(void 0!==e)return this.CitationFileTypeMap.has(e)?this.CitationFileTypeMap.get(e):void 0},this.getSupportedIconType=e=>{if(void 0!==e)return Object.values(v._R).includes(e)?e:void 0},this.getTitleFromSnippet=e=>e?('"'===e[0]&&(e=e.substring(1,e.length-1)),'"'+(e.length>a.cGI?e.slice(0,a.cGI).trim()+"...":e)+'"'):null,this.getFileExtensionFromName=e=>e?.includes(".")?e.split(".").pop():"",this.getChatReferenceFromSourceAttributions=(e,t,n)=>(n&&(this.lastBuilderCitationsTypes=[]),e.filter((e=>t?e.sourceType===a.YgX:e.sourceType!==a.YgX)).map(((e,t)=>{let n;e.referenceMetadata&&(n=JSON.parse(e.referenceMetadata));const o=this.getChatReferenceType(n?.type,n?.referenceType,e);this.lastBuilderCitationsTypes.push(`${o}:${n?.type}:${n?.referenceType}:${this.getFileExtensionFromName(n?.fileName)}`);const r=this.getTitleFromSnippet(e.providerDisplayName)??o,i=n?.typeDescription??a.u1i,l=n?.iconUrl?.replace(/\/$/,""),s=this.getReferenceSourceType(e);return{referenceIndex:t+1,referenceProps:{title:r??a.u1i,primarySubtitle:i,secondarySubtitle:n?.context??this.getUrlForCitation(e),snippet:this.getSnippetFromCitationContent(n?.snippet)??a.u1i,referenceType:o,iconAppName:o===v._2.CrossApp?this.getSupportedIconType(n?.type):this.getCrossAppCitationFileType(n?.referenceType),url:this.getUrlForCitation(e),path:[e.path],sensitivityLabel:n?.sensitivityLabel?.displayName,iconUrl:l,linkType:s},isFlux:!0}})))}}var w=n(881707),E=n(59653),I=n(217160),R=n(301735),A=n(178365),L=n(75496),k=n(737649),F=n(517582),_=n(197665),P=n(306148),N=n(857677),M=n(16796),O=n(838446),D=n(393035),B=n(421649),$=n(639969),H=n(823860),U=n(255507),q=n(330123),V=n(76872),W=n(316904),G=n(379490),z=n(729851),Q=n(831253),j=n(831922),J=n(694592),Y=n(347145);const X=V.E.getInstance(),Z=W.M.getInstance();function K(e){return!!Y.v1l&&("bot"===e.author&&(void 0===e.messageType||"Chat"===e.messageType)&&e.contentOrigin===R.w.SelfHelpSkillName)}function ee(e,t){const n=e.adaptiveCards&&e.adaptiveCards.length>0,o=[];let r="";if(n&&e.hiddenText===R.x.QuickAnswer){r=R.x.QuickAnswer;const t=(0,a.sj0)(),n=e.adaptiveCards?e.adaptiveCards[0]:{},i=te(n,t,e.messageId);o.push(i)}else if(n&&e.hiddenText===R.x.HelpArticle)if(r=R.x.HelpArticle,1===e.adaptiveCards?.length){const t=(0,a.Vgn)(),n=e.adaptiveCards[0],r=te(n,t,e.messageId);o.push(r)}else{const t={chatCardType:C._.Default,chatMessageData:{defaultMessageProps:{user:"chat",messageHeader:{text:(0,a.sj0)()}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:y.O.None,isFailure:!1,messageId:e.messageId},addCardToChatHistory:!0},n=e.adaptiveCards.map((t=>te(t,e.messageId)));o.push(t,...n)}else{r="N/A";const t={chatCardType:C._.Default,chatMessageData:{defaultMessageProps:{user:"chat",messageHeader:{text:(0,a.ZAw)()}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:y.O.None,isFailure:!0,messageId:e.messageId},addCardToChatHistory:!0};o.push(t)}ie(r);for(const e of o)t.displayResponse(e)}const te=(e,t,n)=>({chatCardType:C._.SelfHelpAdaptiveCard,chatMessageData:{selfHelpAdaptiveCardProps:{user:"chat",headerText:t,sourceLabel:{iconName:"unknown",text:(0,a.Ovt)()},cardData:e,customActions:{[ne.JsonTypeName]:ne,[oe.JsonTypeName]:oe,[re.JsonTypeName]:re,[ae.JsonTypeName]:ae}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:y.O.Footer,feedbackData:(0,J.M5)("Copilot\\SelfHelpSearch"),isFailure:!1,messageId:n},addCardToChatHistory:!0});class ne extends j.TelemetryEnabledActionBase{getJsonTypeName(){return ne.JsonTypeName}executeWithTelemetry(e){le("ExecuteTCID",e),this.tcid&&Office.context.ui.executeFeature(this.tcid)}}ne.JsonTypeName="SelfHelpAction.ExecuteTCID",ne.tcidProperty=new Q.Uy(Q.uq.v1_0,"tcid"),(0,G.__decorate)([(0,Q.MZ)(ne.tcidProperty)],ne.prototype,"tcid",void 0);class ae extends j.TelemetryEnabledActionBase{getJsonTypeName(){return ae.JsonTypeName}executeWithTelemetry(e){le("ShowTeachingCallout",e),this.tabId&&this.anchorId&&this.calloutTitle&&this.calloutText&&OfficeFirstParty.Notification.addNotification(OfficeFirstParty.Notification.callout({target:this.tabId,title:this.calloutTitle,content:this.calloutText,useTeachingStyles:!0}),{navigationalOptions:{controlToFind:this.anchorId}})}}ae.JsonTypeName="SelfHelpAction.ShowTeachingCallout",ae.tabIdProperty=new Q.Uy(Q.uq.v1_0,"tabId"),ae.anchorIdProperty=new Q.Uy(Q.uq.v1_0,"anchorId"),ae.calloutTitleProperty=new Q.XB(Q.uq.v1_0,"calloutTitle"),ae.calloutTextProperty=new Q.XB(Q.uq.v1_0,"calloutText"),ae.delayProperty=new Q.Uy(Q.uq.v1_0,"delay"),(0,G.__decorate)([(0,Q.MZ)(ae.tabIdProperty)],ae.prototype,"tabId",void 0),(0,G.__decorate)([(0,Q.MZ)(ae.anchorIdProperty)],ae.prototype,"anchorId",void 0),(0,G.__decorate)([(0,Q.MZ)(ae.calloutTitleProperty)],ae.prototype,"calloutTitle",void 0),(0,G.__decorate)([(0,Q.MZ)(ae.calloutTextProperty)],ae.prototype,"calloutText",void 0),(0,G.__decorate)([(0,Q.MZ)(ae.delayProperty)],ae.prototype,"delay",void 0);class oe extends j.TelemetryEnabledActionBase{getJsonTypeName(){return oe.JsonTypeName}executeWithTelemetry(e){le("OpenUrl",e),this.url&&window?.open(this.url)}}oe.JsonTypeName="SelfHelpAction.OpenUrl",oe.urlProperty=new Q.XB(Q.uq.v1_0,"url"),(0,G.__decorate)([(0,Q.MZ)(oe.urlProperty)],oe.prototype,"url",void 0);class re extends j.TelemetryEnabledActionBase{getJsonTypeName(){return re.JsonTypeName}executeWithTelemetry(e){le("ShowHelpPane",e),this.articleId&&OfficeFirstParty.Copilot.launchHelpPaneByArticleIdString(this.articleId)}}re.JsonTypeName="SelfHelpAction.ShowHelpPane",re.articleIdProperty=new Q.XB(Q.uq.v1_0,"articleId"),(0,G.__decorate)([(0,Q.MZ)(re.articleIdProperty)],re.prototype,"articleId",void 0);const ie=e=>{X.updateTelemetryChatEventData({[N.h3.ChatEventType]:N.a5.SelfHelpContentShown,[N.h3.ChatEventParameters]:JSON.stringify({ContentType:e})},Z),Z.endTriedActivitySuccess(N.q.SelfHelp)},le=(e,t)=>{const n=W.M.userQueryGuid;if(t){const{correlationId:e}=(0,N.zq)(t);void 0!==e&&(W.M.userQueryGuid=e,U.B.userQueryGuid=e)}X.updateTelemetryChatEventData({[N.h3.ChatEventType]:N.a5.SelfHelpActionClicked,[N.h3.ChatEventParameters]:JSON.stringify({ActionType:e})},Z),U.B.getInstance().logKeptEvent(N.BJ.ChatQnA,N.q.SelfHelp,z.RX.Ask),t&&(W.M.userQueryGuid=n,U.B.userQueryGuid=n)};var se=n(805020),ce=n(664007),de=n(109174),ue=n(994481),me=n(808943),ge=n(83478),he=n(110686),pe=n(311538),be=n(672270),fe=n(962614),Ce=n.n(fe);function ye(e){if(!e)return"None";const t=(new(Ce())).parse(e,{});if(t.some((e=>"table_close"===e.type)))return A.$.getInstance().doesLastResponseHaveTable=!0,"Table";return t.some((e=>"ordered_list_close"===e.type||"bullet_list_close"===e.type))?"List":"None"}var ve=n(8403),Te=n(795786);const xe=()=>(0,Y.yw9)("OfficeVSO_9262753_InternalLoadingMessageSupportEnabled")||(0,Y.vIj)();class Se{static getInstance(){return Se._instance||(Se._instance=new Se),Se._instance}getCustomMarkdownComponents(e,t){const n=this.getMarkdownCardOptionsByMessageOrigin(e,t);return(0,D.X)(n)}cleanupStreamHandler(){this.messageId="",this.contentOrigin=void 0,this.showUndoButton=!1,this.disableUndoButton=!1,this.isStreaming=!1,this.isFirstStreamChunk=!0,this.paragraphChunks="",this.chunksCount=0,this.lastFormulaRequestDebugInfo=void 0,this.isDisengagedError=!1,this.codePreviewProps=void 0}resetStartQueryState(e){this.isMessageRendered=!1,this.augloopSignalSentTime=e}isWaitingForStreamEnd(){return this.isStreaming}endUserPerceivedLatency(e,t,n){!this.isMessageRendered&&this.augloopSignalSentTime&&(t&&n&&W.M.getInstance().assertFeatureIsActive(t,"displayResponse: Feature from telemetry.featureName does not match active feature."),this.telemetryEventHandler.logUserPerceivedLatencyTelemetry(!0,e,!1,this.augloopSignalSentTime,this.telemetryLogger,t),this.isMessageRendered=!0,this.augloopSignalSentTime=void 0)}getBasinObject(){return this.basin}setShowUndoButton(e){this.showUndoButton=e}setDisableUndoButton(e){this.disableUndoButton=e}getConversationId(){return this.conversationId}getSydneyEndpoint(){return this.sydneyEndpoint}getResponseLocale(){return this.locale}isHandledResponseMessage(e){return(0,Y.yw9)("OfficeVSO_9318370_DontIgnoreInternalLoaderMessage")&&this.isInternalLoadingMessage(e)?xe():!!this.isDisengagedMessage(e)||this.isValidMessageForRendering(e)}setLastFormulaRequestDebugInfo(e){this.lastFormulaRequestDebugInfo=e}setShouldShowFormulaDevButton(e){this.shouldShowFormulaDevButton=e}shouldStopLoadingUi(e){if(!e.messages)return!0;let t=!0;for(const n of e.messages)try{const e=JSON.parse(n.text);if(void 0!==e?.stopLoadingUi){t=e.stopLoadingUi;break}}catch(e){(0,x.cY)(`parse stop loading ui error: ${e}`)}return t}isInternalLoadingMessage(e){return e.messageType===B.n3.InternalSearchQuery||e.messageType===B.n3.InternalLoaderMessage}isDisengagedMessage(e){return e.messageType===B.n3.Disengaged}hasSeenDisengagedError(){return this.isDisengagedError}getFullAdaptiveCardText(e){const t=e.adaptiveCards?e.adaptiveCards[0]:null;let n="";if(t){const e=t.body;for(const t of e)"TextBlock"===t.type&&(n+=t.text)}return n}handleStreamEndInternal(e){(0,x.cY)("ExcelAppSharedStreamHandler: Excel App Copilot streaming ended."),this.logDiagnostics();const t=e.messages?.find((e=>this.isValidMessageForRendering(e)));return t}async handleStreamEndForSharedCopilot(e,t,n,c,d,u,m){!this.conversationId?.length&&n&&(this.conversationId=n,W.M.conversationId=n,U.B.conversationId=n),this.sydneyEndpoint?.length||(this.sydneyEndpoint=d);const g=this.handleStreamEndInternal(e);if(g&&(0,q.JK)(g)&&(this.streamingCitationHandler?.processCitations(g,m),this.streamingCitationHandler?.setMessageMetadata(g,e)),(0,Y.iPS)("Microsoft.Office.Excel.FA000000124.EnableExcelAnalysisWorkflow",!1)&&g&&g.adaptiveCards&&this.shouldRenderAdaptiveCard(g)){const e=g.adaptiveCards[0],t=Te.n.getChartAdaptiveCardResponse({requestId:g.requestId,adaptiveCardDefinition:e});A.$.getInstance().displayResponse(t.message,t.telemetry)}let b={};if(this.telemetryEventHandler.updateTelemetryLatencyData({[N.CT.ContentOrigin]:g?.contentOrigin??R.w.Unknown},this.telemetryLogger),this.messageId){if(g&&g.messageId===this.messageId&&!K(g)){(0,x.cY)("ExcelAppSharedStreamHandler: Message id was set. Updating final message rendered");const n=(0,o.D)({chatResponse:e},(0,Y.LSW)(),(0,Y.DtK)()),a={allowImages:n,enableLinkDataDownload:n,disableLinksProcessing:!1},l=(0,me.pX)()?e.conversationSensitivityLabel:void 0;if(l){(0,x.cY)("ExcelAppSharedStreamHandler: Enterprise search"),(0,r.Yw)();const e=(0,ue.oR)(l);try{const t=await w.n.getInstance().getInDocSensitiveLabelUsingOfcJs(),n=await w.n.getInstance().getHighestDocumentSensitivityInfo([t,e]);n.isDke=t.isDke,n.hasExtractForUser=t.hasExtractForUser,(0,x.cY)("Highest label: "+JSON.stringify(n)),w.n.getInstance().setInDocSensitivityLabelInfo(n)}catch(e){(0,x.cY)("Enterprise search: Office JS sensitivity api failed: "+e.message),this.telemetryLogger.logError({eventType:L.S2.OfficeJsOperations,errorMessage:"Exception while calling Office JS sensitivity api in Flux Copilot Workflow: "+e.message,logLevel:i.$b.Error},void 0,[{key:L.Wg.UserQueryGuid_,value:W.M.userQueryGuid}]),W.M.getInstance().logStandardizedAshaErrorEvent(p.W.LLM_Service_Side_Issue_Prevents_Output,h.c.Orchestration_Failed_When_Calling_OfficeJS_Sensitivity_API,N.BJ.CopilotChat)}}const s=(0,Y._bw)()?(0,ue.yu)():void 0,c=this.shouldStopLoadingUi(e);b=await this.updateLastRenderedMessage(g,t,s,c,a)}}else{const t=A.$.getInstance().getLastMessage(!1);if(t&&t.body.user===f.Q9.Chat){const n=t?.messageType??C._.MarkdownCard;(0,x.cY)("ExcelAppSharedStreamHandler: Message id was not set. Stopping loading ui for last message"),(0,Y.yw9)("OfficeVSO_8923945_UpdateLastMessage")?A.$.getInstance().updateMessage({chatCardType:n,stopLoadingUi:this.shouldStopLoadingUi(e),addCardToChatHistory:!1,chatMessageBodyData:{messageId:t?.messageId}}):A.$.getInstance().updateLastMessage({chatCardType:n,stopLoadingUi:this.shouldStopLoadingUi(e),addCardToChatHistory:!1})}}const y=A.$.getInstance().getLastMessage(!1),v=await t((0,$.gp)());if(y&&y.body.user===f.Q9.Human&&!v||de.CP.pythonContextManager.isPythonMode&&g){if(!(de.CP.pythonContextManager.isPythonMode&&(!g||"bot"===e?.messages?.slice(-1)[0]?.author)&&y?.body?.user===f.Q9.Human)){g||W.M.getInstance().logError({eventType:L.S2.StreamHandler,errorMessage:"ExcelAppSharedStreamHandler: finalMessage is undefined",logLevel:i.$b.Warning});const t=g?.text??(0,a.BFD)();if((0,x.cY)("ExcelAppSharedStreamHandler: No chat message has been rendered. If we need to display, we will use either the finalMessage.text or the Whoops! string: ",t),(0,Y.yw9)("OfficeVSO_9939503_AnalyzeDataStreamingAdaptiveCard")&&g&&g.adaptiveCards&&this.shouldRenderAdaptiveCard(g)){const e=g.adaptiveCards[0],t=Te.n.getChartAdaptiveCardResponse({requestId:g.requestId,adaptiveCardDefinition:e});A.$.getInstance().displayResponse(t.message,t.telemetry)}else{const n=this.shouldStopLoadingUi(e);this.addResponseMarkdownMessageCard(t,g?.messageId,n,g?.contentOrigin)}}}if(b.conversationId=this.conversationId,b.messageId=g?.messageId,b.userQueryGuid=W.M.userQueryGuid,b.chunkCount=this.chunksCount,b.groundingMode=(0,N.Q6)(),this.telemetryEventHandler.updateTelemetryChatEventData({[N.h3.ChatEventType]:N.a5.ResponseStreamFinished,[N.h3.ChatEventParameters]:JSON.stringify({lastMessageMetadata:b})},this.telemetryLogger),t(se.m.resetDoesFluxTurnRequireUndo()),this.cleanupStreamHandler(),F.Q.getInstance().stopRecordingFluxWorkflow(!0),(0,Y.yw9)("OfficeVSO_10021705_SendTelemetryForMultipleCardsOnError")&&A.$.getInstance().handleEndOfQuery(e.messages?.[0]?.requestId??""),this.shouldStopLoadingUi(e)&&(await t((0,$.L4)(!0)),(0,Y.vIj)()&&t(ce.m.setLoadingStrings([]))),!(0,Y.k64)()||(0,Y.IU1)()&&(0,Y.geU)()||(0,P.s_)(P.H0.EnableApply),c){if(!this.isMessageRendered){let e=(0,N.eQ)(g?.contentOrigin);this.telemetryLogger.getActiveFeature()!==N.BJ.CopilotChat&&(e=this.telemetryLogger.getActiveFeature()),this.telemetryLogger.assertFeatureIsActive(e,"handleStreamEndForSharedCopilot: Feature from finalMessage?.contentOrigin does not match active feature."),this.telemetryEventHandler.logUserPerceivedLatencyTelemetry(!1,!0,u??!1,c,this.telemetryLogger,e),this.isMessageRendered=!0,this.augloopSignalSentTime=void 0}const e=(0,N.xJ)(c);this.telemetryEventHandler.logLatency(e,N.OP.ChatResponseLastChunk)}(0,Y.UxI)()&&l.xP.setIsAddinFlow(!1,(()=>{(0,s.An)(A.$.getInstance().getCopilotRef(),!1)}))}async getExcelActionButtons(e,t,n,o,r,s){const c=[];A.$.getInstance().doesLastResponseHaveTable=!1;const d=(0,Y.UxI)()&&l.xP.getCurrentAddinState()===l.aB.HasAction;if(d&&(l.xP.transitionAddinState(l.aB.ShowButton),U.B.getInstance().sendChatEventTelemetry((0,N.pN)({[N.h3.ChatEventType]:i.a5.UndoButtonShownAfterAddinSuccess}))),this.showUndoButton&&(0,Y.BAK)()||d){const e=()=>{U.B.getInstance().sendChatEventTelemetry((0,N.pN)({[N.h3.ChatEventType]:i.a5.UndoButtonClickedAfterAddinSuccess})),A.$.getInstance().displayResponse({chatCardType:C._.Default,chatMessageData:{defaultMessageProps:{user:f.Q9.Chat,messageHeader:{text:(0,a.W1n)()}}},chatMessageBodyData:{messageAttributionProps:(0,J.qN)()}}),(0,P.s_)(P.H0.RemoveUndo)};c.push((0,P.FW)(N.q.CopilotChat,void 0,e))}this.disableUndoButton&&(0,P.s_)(P.H0.DisableUndo);const u=n===R.w.ElseSkillName;if(u){const e=(0,ge.J)(this.shouldShowFormulaDevButton,this.lastFormulaRequestDebugInfo);e&&c.push(e)}const m=this.streamingCitationHandler?.doMessageContainsExcelCitation(e),g=!_.iJ.isIOSPlatform()&&(0,Y.iPS)("Microsoft.Office.Excel.FA000000124.ImportDataShowImportButton",!0)&&s&&m;if(g){let t=w.n.getInstance().getInDocSensitiveLabelInfo();""===t.labelId&&(await w.n.getInstance().setInDocSensitiveLabelInfoUsingOfcJs(),t=w.n.getInstance().getInDocSensitiveLabelInfo()),c.push((0,P.E_)(e,W.M.userQueryGuid,t,o))}const h=!g&&(0,Y.vIj)();if(u&&(0,Y.yw9)("OfficeVSO_9211113_InsertTablesFromElseCard")||h){const e=ye(t),a=h&&(0,Y.iPS)("Microsoft.Office.Excel.FA000000124.AllowInsertListFromSearch",!0)&&!u&&n!==R.w.GetInsightsName&&n!==R.w.ChartsAndPivotTablesName&&n!==R.w.TextAnalysisName;"Table"===e?c.push((0,P.AU)(o,s)):a&&"List"===e&&c.push((0,P.A6)(o,s))}if(r){const e=0===c.length;c.push((0,P.z3)(e))}return(0,Y.jHv)()&&c.push((0,P.yo)(e)),c}getSuggestionItems(e){const t=e.filter((e=>e.messageType===B.n3.Suggestion)).map((e=>({suggestionText:e.text,suggestionType:"SydneySuggestion"})));if((0,Y.yw9)("OfficeVSO_9922143_ShowPythonSuggestionPill")){const e=E.p.getInstance();if(!1===e.getPythonMode()&&!0===e.shouldShowPythonAASuggestions()){return[{suggestionText:(0,a.Bzb)(),suggestionType:"Python_Suggestion_FromSkittle"},...t]}}return t}async updateLastRenderedMessage(e,t,n,a=!0,o){const r=!(e.contentOrigin===R.w.ElseSkillName||(0,me.pX)()&&function(e){if(!e)return!1;const t=/=\S+\(.*\)/,n=/[+\-@]\S+\(.*\)/,a=/[=+\-@]\S*[!|]/,o=new RegExp(`${t.source}|${n.source}|${a.source}`).test(e);if(o){(0,be.cY)("NOTICE!: Potential formula found: "+e);const o=t.test(e),r=n.test(e),l=a.test(e);W.M.getInstance().logError({eventType:L.S2.StreamHandler,errorMessage:`messageCouldHaveFormulas: Potential formula found. First pattern hit: ${o}, Second pattern hit: ${r}, Third pattern hit: ${l}`,logLevel:i.$b.Warning},void 0,[{key:L.Wg.UserQueryGuid_,value:W.M.userQueryGuid}]),(0,Y.yw9)("OfficeVSO_9707150_demoteMessageCouldHaveFormulas")||W.M.getInstance().logStandardizedAshaErrorEvent(p.W.Missing_Copilot_Functionality,h.c.Input_Resulted_In_Unsupported_Command,N.BJ.CopilotChat)}return o}(e.text));let l=[],s=[];if((0,Y.vIj)()&&((e.sourceAttributions||[]).length>0?((0,x.cY)("ExcelAppSharedStreamHandler: Getting external citations here.."),l=S.getInstance().getChatReferenceFromSourceAttributions(e.sourceAttributions,!1,!0),s=S.getInstance().getChatReferenceFromSourceAttributions(e.sourceAttributions,!0)):(e.citations||[]).length>0&&(0,x.cY)("ExcelAppSharedStreamHandler: Getting in-doc citations which is not supported in Excel"),(0,me.pX)()||(0,me.gc)())){const{suggestedResponses:n}=e;if((0,x.cY)("ExcelAppSharedStreamHandler: suggestedResponses ",n),n&&n.length>0&&e.contentOrigin!==R.w.GetInsightsName&&e.contentOrigin!==R.w.ChartsAndPivotTablesName&&e.contentOrigin!==R.w.TextAnalysisName){const e=this.getSuggestionItems(n);t(ce.m.setSuggestionListDetails({suggestionList:e}))}}const c=e;if((c.gptIdentifiers||[]).length>0){const e=c.gptIdentifiers[0].id;e&&((0,x.cY)(`Rendering branding header for response received with GPT ID: ${e}`),U.B.getInstance().sendChatEventTelemetry((0,N.pN)({[N.h3.ChatEventType]:N.a5.GptIdForBranding,[N.h3.ChatEventParameters]:e})))}const d=l.length>0;d&&(this.telemetryLogger.startTriedActivity(N.q.Search),this.telemetryLogger.endTriedActivitySuccess(N.q.Search));const g=await this.getExcelActionButtons(e.messageId,e.text,e.contentOrigin,t,r,d),b=(0,Y.kkU)()&&e.sourceAttributions?u(e.sourceAttributions??[],!0):void 0,f=(0,Y.l6e)()&&e.sourceAttributions?m(e.sourceAttributions,!0):void 0,v=this.codePreviewProps;if(e.adaptiveCards&&this.shouldRenderAdaptiveCard(e)){const t=e.adaptiveCards[0],n=Te.n.getChartAdaptiveCardResponse({requestId:e.requestId,adaptiveCardDefinition:t});(0,Y.yw9)("OfficeVSO_8923945_UpdateLastMessage")?A.$.getInstance().updateMessage(n.message):A.$.getInstance().updateLastMessage(n.message)}else{const t=this.getMarkdownCardOptionsByMessageOrigin(e.contentOrigin,e.messageId).feedbackData?.feedbackArea,i=A.$.getInstance().getLastMessage(),c={chatCardType:C._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:e.text,horizontalTableScroll:!0,componentsOverride:this.getCustomMarkdownComponents(e.contentOrigin,e.messageId),allowImages:o?.allowImages,enableLinkDataDownload:o?.enableLinkDataDownload,disableLinksProcessing:o?.disableLinksProcessing}},chatMessageBodyData:{...(0,J.Cn)({showAIGenerated:!0,showAnimation:!0,footerPosition:y.O.Footer,actionButtonList:g,isFailure:!1,references:l&&l.length>0?l:void 0,annotationReferences:s&&s.length>0?s:void 0,clpLabel:n?(0,ue.Q9)(n):void 0,msgExtCardProps:1===b?.attributions.length?void 0:b,apiPluginCardProps:f,feedbackArea:t,shouldShowCopyButton:r,shouldShowHandoffButton:!0,shouldShowReadAloudButton:!0,codePreviewProps:v}),messageId:(0,Y.yw9)("OfficeVSO_8923945_UpdateLastMessage")?i?.messageId:void 0},stopLoadingUi:a,addCardToChatHistory:!0};(0,Y.yw9)("OfficeVSO_8923945_UpdateLastMessage")?A.$.getInstance().updateMessage(c):A.$.getInstance().updateLastMessage(c)}return{suggestionsCount:e.suggestedResponses?.length,referencesCount:l?.length,annotationReferencesCount:s?.length,isSearchResponse:d,citationsTypes:S.getInstance().getLastBuildCitationsTypes(),actionButtonsCount:g.length,responseHasTable:A.$.getInstance().doesLastResponseHaveTable}}handleChatResponseForSharedCopilot(e,t,n,a,o,r,i,l,s){const c=this.telemetryLogger.getActiveFeature();(0,Y.thH)()&&l&&(0,M.y)(l,c),a?.length&&(this.conversationId=a,W.M.conversationId=a,U.B.conversationId=a),o?.length&&(this.sydneyEndpoint=o);const d=t.basinCursor,g=t.basinWrite,h=t.messagesToAddOrReplace,p=t.messagesToDelete,b=t.messagesToUpdate;if(!(0,x.hX)(p))for(const e of p)(0,x.cY)("ExcelAppSharedStreamHandler: Deleting message id: ",e),A.$.getInstance().deleteMessage({chatCardType:C._.MarkdownCard,messageIdToDelete:e}),delete this.basin.items[e];if(!(0,x.hX)(d)){const e=JSON.parse(d);this.basin.setCursor(e),(0,x.cY)("ExcelAppSharedStreamHandler: Setting basin cursor: ",e)}if((0,x.cY)("ExcelAppSharedStreamHandler: Initial/previous annotation message id is "+this.messageId),!(0,x.hX)(h)&&h.length>0)for(const t of h){if(this.isDisengagedError)break;if(this.isDisengagedMessage(t)){this.isDisengagedError=!0;const{message:e,telemetry:t}=Te.n.getDisengagedErrorResponse(c);A.$.getInstance().displayResponse(e,t),(0,O.I)(void 0,c);break}if(t.isTextAnalysis){(0,x.cY)("Returning early due to isTextAnalysis.");break}if(this.shouldNotShowFluxResponseForInsights(s)){(0,x.cY)("ExcelAppSharedStreamHandler: Returning early to skip the flux response since it should not be shown.");break}if((0,q.JK)(t)&&this.streamingCitationHandler?.processCitations(t,i),this.isValidMessageForRendering(t)){if((0,x.cY)("ExcelAppSharedStreamHandler: MessageId for this annotation is : "+t.messageId),t.messageId!==this.messageId){if(this.messageId=t.messageId,this.isFirstStreamChunk){if(n){if(!this.isMessageRendered){let e=(0,N.eQ)(t?.contentOrigin);this.telemetryLogger.getActiveFeature()!==N.BJ.CopilotChat&&(e=this.telemetryLogger.getActiveFeature()),this.telemetryLogger.assertFeatureIsActive(e,"handleChatResponseForSharedCopilot: Feature from message?.contentOrigin does not match active feature."),this.telemetryEventHandler.logUserPerceivedLatencyTelemetry(!0,!0,r??!1,n,this.telemetryLogger,e),this.augloopSignalSentTime=void 0}const e=(0,N.xJ)(n);this.telemetryEventHandler.logLatency(e,N.OP.ChatResponseFirstChunk)}this.isFirstStreamChunk=!1}if((0,J.D9)(t.offense),(0,x.cY)("ExcelAppSharedStreamHandler: Adding Response Card for messagesToAddOrReplace 1:",t),K(t))ee(t,A.$.getInstance());else if(t.adaptiveCards&&this.shouldRenderAdaptiveCard(t)){e(ce.m.setLatestRequestId(W.M.userQueryGuid));const n=t.adaptiveCards[0],a=Te.n.getChartAdaptiveCardResponse({requestId:t.requestId,adaptiveCardDefinition:n});A.$.getInstance().displayResponse(a.message,a.telemetry)}else{this.basin.items[this.messageId]={adaptiveCards:[{body:[{text:t.text,type:"TextBlock",wrap:!0}]}]};const e=this.getFullAdaptiveCardText(t);(0,x.cY)("ExcelAppSharedStreamHandler: Full text from Adaptive Card: ",e);((0,Y.yw9)("OfficeVSO_10429342_AddResponseMarkdownMessageConditionsRefactor")?!((0,Y.IU1)()&&(0,Y.geU)()):!(0,Y.IU1)())&&this.addResponseMarkdownMessageCard(e||t.text,t.messageId,void 0,t.contentOrigin)}}else if(!K(t)){(0,x.cY)("ExcelAppSharedStreamHandler: Adding Response Card for messagesToAddOrReplace 2:",t);const e=this.getFullAdaptiveCardText(t);(0,x.cY)("ExcelAppSharedStreamHandler: Full text from Adaptive Card: ",e);const n=t.sourceAttributions,a=n?S.getInstance().getChatReferenceFromSourceAttributions(n):[],o=n?S.getInstance().getChatReferenceFromSourceAttributions(n,!0):[],r=(0,Y.kkU)()&&n?u(n):void 0,i=(0,Y.l6e)()&&n?m(n):void 0;this.updateResponseMarkdownMessageCard(e||t.text,!0,a,o,r,i)}}else xe()&&this.isInternalLoadingMessage(t)&&e(ce.m.setLoadingStrings([t.text]))}else{if(!(0,x.hX)(b)&&b.length>0)for(const e of b)if((0,x.cY)("ExcelAppSharedStreamHandler: MessageId for this annotation is : "+e.messageId),e.messageId===this.messageId){(0,x.cY)("ExcelAppSharedStreamHandler: Updating Response Card to messagesToUpdate:",e);const t=e.sourceAttributions,n=t?S.getInstance().getChatReferenceFromSourceAttributions(t):[],a=t?S.getInstance().getChatReferenceFromSourceAttributions(t,!0):[],o=(0,Y.kkU)()&&t?u(t):void 0,r=(0,Y.l6e)()&&t?m(t):void 0;this.updateResponseMarkdownMessageCard(e.appendText,void 0,n,a,o,r),(0,q.JK)(e)&&this.streamingCitationHandler?.processCitations(e,i)}if(!(0,x.hX)(g)){const e=JSON.parse(g);(0,x.cY)("ExcelAppSharedStreamHandler: Basin write received: ",e),this.basin.write(e);const t=this.getFullAdaptiveCardText(this.basin.items[this.messageId]);(0,x.cY)("ExcelAppSharedStreamHandler: Full text from Adaptive Card: ",t),this.updateResponseMarkdownMessageCard(t||e,!0)}}}async handleChatResponse(e,t,n,a,r,i,l,c){(0,x.cY)("ExcelAppSharedStreamHandler: Excel Copilot chatResponse received for Shared Copilot");const d=t((0,he.Z)())?.dataLocale;if(!((0,Y.yw9)("OfficeVSO_9176144_DontProcessInternalLoaderMessages")&&this.chatResponseIsInternalLoaderMessage(e))){if(e.status===I.lC.Success){if((0,o.D)({chatResponse:e},(0,Y.LSW)(),(0,Y.DtK)())&&(0,Y.jxV)()){const t=e.messages?.find((e=>(0,s._H)(e))),n=(t?.text?.length||0)>0;t&&!(0,x.hX)(t)&&(this.codePreviewProps=(0,s.QH)(t,n))}return await(0,g.BI)(e,A.$.getInstance().getCopilotRef(),{enableAddinLocalPluginActions:(0,Y.UxI)(),passAllMessages:!0})?void this.cleanupStreamHandler():(await this.handleStreamEndForSharedCopilot(e,t,n,a,r,i,d),void(this.codePreviewProps=void 0))}this.isStreaming||""===this.messageId||this.handleStreamBegin(t),this.chunksCount++}this.handleChatResponseForSharedCopilot(t,e,a,n,r,i,d,l,c)}chatResponseIsInternalLoaderMessage(e){const t=e.messagesToAddOrReplace?.[0];return!!t&&this.isInternalLoadingMessage(t)}logDiagnostics(){this.conversationId&&(0,x.cY)("ExcelAppSharedStreamHandler: conversation id from Excel App Copilot: "+this.conversationId)}shouldRenderAdaptiveCard(e){return((0,Y.yw9)("OfficeVSO_9118479_AnalyzeDataAdaptiveCard")&&e.adaptiveCards&&e.adaptiveCards?.length>0&&(e.contentOrigin===R.w.GetInsightsName||e.contentOrigin===R.w.ExcelAnalysis||e.contentOrigin===R.w.ChartsAndPivotTablesName||e.contentOrigin===R.w.TextAnalysisName))??!1}shouldNotShowFluxResponseForInsights(e){const t=de.CP.getQueryIdShouldNotShowFluxResponse();return!(!t||!e||t!==e)}constructor(e=()=>q.qx.getInstance()){this.basin=new b.Basin,this.messageId="",this.showUndoButton=!1,this.disableUndoButton=!1,this.isStreaming=!1,this.isFirstStreamChunk=!0,this.isMessageRendered=!1,this.augloopSignalSentTime=void 0,this.paragraphChunks="",this.contentOrigin=void 0,this.chunksCount=0,this.isDisengagedError=!1,this.conversationId=void 0,this.sydneyEndpoint=void 0,this.locale=void 0,this.telemetryLogger=W.M.getInstance(),this.telemetryEventHandler=V.E.getInstance(),this.lastFormulaRequestDebugInfo=void 0,this.shouldShowFormulaDevButton=!1,this.getMarkdownCardOptionsByMessageOrigin=(e,t)=>{const n=t??this.messageId,a=this.streamingCitationHandler?.doMessageContainsCitation(n)??!1;return(0,D.u)(e,a)},this.isValidMessageForRendering=e=>{if(e.locale&&(this.locale=e.locale),e.text)try{if(JSON.parse(e.text).publishPreference===H.f.Never)return!1}catch(e){}return!(e.author!==B.nC.Bot||!this.getFullAdaptiveCardText(e)&&!e.text||void 0!==e.messageType&&e.messageType!==B.n3.Chat||!e.messageId)},this.addResponseMarkdownMessageCard=(e,t,n,a)=>{if((0,x.hX)(e))return void(0,x.cY)("ExcelAppSharedStreamHandler: Returning as message is undefined");(0,x.cY)("ExcelAppSharedStreamHandler: Adding Response Card:",e),this.paragraphChunks=e,this.contentOrigin=a,this.messageId=t??"";const o=this.codePreviewProps,r=this.getMarkdownCardOptionsByMessageOrigin(a,t),i={featureName:r.telemetryFeatureName,eventType:N.a5.ConversationMessage},l=r.shouldShowDevDiagnosticsButton&&(0,Y.jHv)()&&t?[(0,P.yo)(t)]:[];if((0,Y.iPS)("Microsoft.Office.Excel.FA000000124.EnableExcelAnalysisWorkflow",!1)&&a===R.w.ExcelAnalysis){const t=ye(e);"Table"===t?l.push((0,P.AU)((0,ve.KA)().dispatch,!1)):"List"===t?l.push((0,P.A6)((0,ve.KA)().dispatch,!1)):l.push((0,P.z3)(!0))}A.$.getInstance().displayResponse({chatCardType:C._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:this.paragraphChunks,horizontalTableScroll:!0,componentsOverride:r.useExcelMDComponents?(0,pe.i)(i.featureName):void 0,disableLinksProcessing:a?.toLowerCase()===R.w.CannedResponse}},chatMessageBodyData:{...(0,J.Cn)({showAIGenerated:r.showAiGenerated,showAnimation:!1,footerPosition:r.feedbackPosition,actionButtonList:l,shouldShowReadAloudButton:r.shouldShowReadAloudButton,codePreviewProps:o}),messageId:t,feedbackData:r.feedbackData},stopLoadingUi:!!n,startAugloopTimerForStreaming:!n,workflowAnnotationTypeForAugloopTimer:k.Yn.getTypeName(),addCardToChatHistory:r.addCardToChatHistory},i)},this.updateResponseMarkdownMessageCard=(e,t,n,a,o,r)=>{if((0,x.hX)(e))return(0,x.cY)("ExcelAppSharedStreamHandler: Returning as message is undefined"),void U.B.getInstance().sendChatEventTelemetry((0,N.pN)({[N.h3.ChatEventType]:N.a5.EmptyMessageReceivedFromSydney,[N.h3.ChatEventParameters]:"Empty Markdown message card"}));(0,x.cY)("ExcelAppSharedStreamHandler: Updating Response Card:",e);let i=e;i=i.replace("\\n","\n"),this.paragraphChunks=t?i:this.paragraphChunks+i;const l=A.$.getInstance().getLastMessage(),s=l?.actionBarButtons?.slice()??void 0,c=this.codePreviewProps,d=this.getCustomMarkdownComponents(this.contentOrigin,this.messageId),u=A.$.getInstance().getLastMessage(),m={chatCardType:C._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:this.paragraphChunks,horizontalTableScroll:!0,componentsOverride:d}},chatMessageBodyData:{...(0,J.Cn)({showAIGenerated:!1,showAnimation:!1,footerPosition:y.O.None,references:n&&n.length>0?n:void 0,annotationReferences:a&&a.length>0?a:void 0,actionButtonList:s,msgExtCardProps:o,apiPluginCardProps:r,codePreviewProps:c}),messageId:(0,Y.yw9)("OfficeVSO_8923945_UpdateLastMessage")?u?.messageId:void 0},stopLoadingUi:!1,startAugloopTimerForStreaming:!0,workflowAnnotationTypeForAugloopTimer:k.Yn.getTypeName(),addCardToChatHistory:!1};(0,Y.yw9)("OfficeVSO_8923945_UpdateLastMessage")?A.$.getInstance().updateMessage(m):A.$.getInstance().updateLastMessage(m)},this.handleStreamBegin=e=>{(0,x.cY)("ExcelAppSharedStreamHandler: handleStreamBegin"),F.Q.getInstance().recordFluxCopilotStep({operation:N.OP.FluxFirstStreamedToken}),((0,me.pX)()||(0,me.gc)())&&this.contentOrigin!==R.w.GetInsightsName&&this.contentOrigin!==R.w.ChartsAndPivotTablesName&&this.contentOrigin!==R.w.TextAnalysisName&&e(ce.m.clearSuggestionList())},this.streamingCitationHandler=(0,Y.UDM)()?e():void 0}}},649405:(e,t,n)=>{"use strict";n.d(t,{f:()=>o});var a=n(618175);class o{hasMore(){return this.providers.length>0}removeCurrent(){this.providers.shift()}getCurrent(){if(!this.hasMore())throw new Error("No AuthProviders available");return this.providers[0]}reset(e){this.providers=e||[new a.f]}constructor(e){this.providers=[],this.reset(e)}}},650444:(e,t,n)=>{"use strict";function a(e){return e}function o(e,t){throw new Error(t)}n.d(t,{c:()=>o,x:()=>a})},652382:(e,t,n)=>{"use strict";n.d(t,{OK:()=>l,Ok:()=>r,dD:()=>s,mw:()=>i});var a=n(943229),o=n(831922);function r(){switch(Office.context.platform){case Office.PlatformType.PC:(0,o.setClientPlatformType)(a.Y.win32);break;case Office.PlatformType.iOS:(0,o.setClientPlatformType)(a.Y.IOS);break;case Office.PlatformType.Mac:(0,o.setClientPlatformType)(a.Y.MACOS);break;default:(0,o.setClientPlatformType)(a.Y.web)}}function i(){return{[Office.PlatformType.iOS]:a.Y.IOS,[Office.PlatformType.Mac]:a.Y.MACOS,[Office.PlatformType.PC]:a.Y.win32}[Office.context.platform]??a.Y.web}const l=()=>Office.context.platform===Office.PlatformType.iOS||Office.context.platform===Office.PlatformType.Mac,s=()=>Office.context.platform===Office.PlatformType.iOS},656931:(e,t,n)=>{"use strict";n.d(t,{Z:()=>v});var a=n(101960),o=n(86940),r=n(217160),i=n(178365),l=n(648982),s=n(517582),c=n(306148),d=n(857677),u=n(823860),m=n(664007),g=n(805020),h=n(92520),p=n(347145),b=n(795786),f=n(639969),C=n(874873),y=n.n(C);class v{cleanupStreamHandler(){this.accessPath="",this.uniqueId="",this.showUndoButton=!1,this.disableUndoButton=!1,this.isStreaming=!1}resetStartQueryState(e){}isWaitingForStreamEnd(){return this.isStreaming}endUserPerceivedLatency(e,t,n){}getBasinObject(){return this.basin}setShowUndoButton(e){this.showUndoButton=e}setDisableUndoButton(e){this.disableUndoButton=e}getConversationId(){return this.conversationId}static getInstance(){return v._instance||(v._instance=l.s.getInstance()),v._instance}constructor(){this.basin=new a.Basin,this.accessPath="",this.uniqueId="",this.showUndoButton=!1,this.disableUndoButton=!1,this.isStreaming=!1,this.conversationId=void 0,this.getAdaptiveCardAccessPath=(e,t)=>e?e.slice(0,e.indexOf("]")+1):"adaptiveCards["+t+"]",this.isValidMessageForRendering=e=>{if(e.text)try{if(JSON.parse(e.text).publishPreference===u.f.Never)return!1}catch(e){}return!("bot"!==e.author||!e.adaptiveCards&&!e.text||void 0!==e.messageType&&"Chat"!==e.messageType||!e.messageId)},this.promiseFromStatus=(e,t,n)=>e===r.lC.Success?this.handleStreamEnd(t,n):this.isStreaming||""===this.uniqueId?Promise.resolve():this.handleStreamBegin(t),this.handleStreamBegin=e=>(this.isStreaming=!0,s.Q.getInstance().recordFluxCopilotStep({operation:d.OP.FluxFirstStreamedToken}),e(m.m.hideLoadingUI())),this.handleStreamEnd=async(e,t)=>{this.conversationId=t,await e(g.m.resetDoesFluxTurnRequireUndo()),this.cleanupStreamHandler(),s.Q.getInstance().stopRecordingFluxWorkflow(!0),await e((0,f.L4)(!0)),i.$.getInstance().handleEndOfQuery(void 0)},this.handleMessages=e=>{e.messages?.forEach((e=>{if(this.isValidMessageForRendering(e)){const t=e.text,n=[];if(this.showUndoButton&&(0,p.BAK)()&&n.push((0,c.FW)(d.q.CopilotChat)),(0,h.cY)("ExcelAppStreamHandler - handleMessages",t),i.$.getInstance().getHasMessageBeenShown(e.messageId))(0,p.yw9)("OfficeVSO_8923945_UpdateLastMessage")?i.$.getInstance().updateMessage({chatCardType:o._.Default,chatMessageBodyData:{actionButtonList:n,messageId:e.messageId},addCardToChatHistory:!1}):i.$.getInstance().updateLastMessage({chatCardType:o._.Default,chatMessageBodyData:{actionButtonList:n},addCardToChatHistory:!1});else{if((0,h.cY)("ExcelAppStreamHandler - handleMessages - displaying for the first time",t),!this.basin.items[e.messageId]){this.uniqueId=e.messageId;const n=this.getAdaptiveCardAccessPath(this.accessPath,0);this.accessPath||(this.accessPath=n),this.basin.items[this.uniqueId]={adaptiveCards:[{body:[{text:t,type:"TextBlock",wrap:!0}]}]}}if(!y()(this.basin.items[this.uniqueId],this.accessPath,null))return void(0,h.cY)("ExcelAppStreamHandler - handleMessages - no card data to show",t);const{message:a,telemetry:o}=b.n.getStreamingResponse({basin:this.basin,uniqueId:this.uniqueId,accessPath:this.accessPath,actionButtonList:n});i.$.getInstance().addMessageIfNeeded(this.uniqueId,a,o)}this.disableUndoButton&&(0,c.s_)(c.H0.DisableUndo)}}))},this.handleMessagesToDelete=e=>{e.messagesToDelete?.forEach((e=>{delete this.basin.items[e]}))},this.handleBasinCursor=e=>{const t=e.basinCursor;if(!(0,h.hX)(t)){const e=JSON.parse(t),n=e?.j||e?.jsonPath;this.uniqueId=n.slice(n.indexOf("[")+2,n.indexOf("]")-1),this.accessPath=this.getAdaptiveCardAccessPath(n.slice(n.indexOf("]")+2),0),this.basin.setCursor(e)}},this.handleMessagesToAddOrReplace=e=>{e.messagesToAddOrReplace?.forEach((e=>{if(this.isValidMessageForRendering(e)){if(!this.basin.items[e.messageId]){this.uniqueId=e.messageId;const t=this.getAdaptiveCardAccessPath(this.accessPath,0);this.accessPath||(this.accessPath=t),this.basin.items[this.uniqueId]={adaptiveCards:[{body:[{text:e.text,type:"TextBlock",wrap:!0}]}]}}if(!y()(this.basin.items[this.uniqueId],this.accessPath,null))return void(0,h.cY)("ExcelAppStreamHandler - handleMessagesToAddOrReplace - no card data to show");(0,h.cY)("ExcelAppStreamHandler - handleMessagesToAddOrReplace",e.text);const{message:t,telemetry:n}=b.n.getStreamingResponse({basin:this.basin,uniqueId:this.uniqueId,accessPath:this.accessPath});i.$.getInstance().addMessageIfNeeded(this.uniqueId,t,n)}}))},this.handleMessagesToUpdate=e=>{e.messagesToUpdate?.forEach((e=>{this.uniqueId=e.messageId;const t=e.acLoc;t?this.basin.items[this.uniqueId].adaptiveCards[t.cIdx].body[t.bIdx].text+=e.appendText:this.basin.items[this.uniqueId].text+=e.appendText;if(!y()(this.basin.items[this.uniqueId],this.accessPath,null))return void(0,h.cY)("ExcelAppStreamHandler - handleMessagesToUpdate - no card data to show");(0,h.cY)("ExcelAppStreamHandler - handleMessagesToUpdate",e.appendText);const{message:n,telemetry:a}=b.n.getStreamingResponse({basin:this.basin,uniqueId:this.uniqueId,accessPath:this.accessPath});i.$.getInstance().addMessageIfNeeded(this.uniqueId,n,a)}))},this.handleBasinWrite=e=>{const t=e.basinWrite;(0,h.hX)(t)||this.basin.write(JSON.parse(t))},this.handleChatResponse=async(e,t,n)=>(this.handleMessages(e),this.handleBasinCursor(e),this.handleMessagesToDelete(e),this.handleMessagesToAddOrReplace(e),this.handleMessagesToUpdate(e),this.handleBasinWrite(e),this.promiseFromStatus(e.status,t,n))}}},659126:(e,t,n)=>{"use strict";n.d(t,{By:()=>W,D$:()=>S,Fr:()=>G,H:()=>x,Jx:()=>$,K3:()=>I,O9:()=>F,Qy:()=>R,RV:()=>A,So:()=>v,Tq:()=>E,XR:()=>b,XZ:()=>q,Xw:()=>y,Z:()=>U,Z$:()=>z,a$:()=>Q,cc:()=>w,dn:()=>T,gx:()=>h,hU:()=>H,me:()=>C,mg:()=>k,oc:()=>L,sq:()=>B,th:()=>V,uT:()=>f});var a=n(616166),o=n(596760),r=n(279395),i=n(83437),l=n(75496),s=n(316904),c=n(342935),d=n(347145),u=n(540084),m=n(359730),g=n(586428);function h(e){const t=e.lastIndexOf("!");if(-1===t)return e;const n=e.slice(t+1);return n.length>1e3?void 0:n}function p(e,t){const n=e.lastIndexOf("!");let a=null;return-1!==n&&(a=e.substr(0,n),!t&&a.startsWith("'")&&(a=a.substr(1,a.length-2))),a}function b(e,t,n,a){if(0===e.length||void 0===t)return[];let o=a?a.slice(t[0],t[t.length-1]+1):new Array(t[t.length-1]-t[0]+1).fill("");if(t.forEach(((n,a)=>{const r=n-t[0];r>=0&&r<o.length&&(o[r]=e[0][a])})),n){const e=a?a.slice(0,t[0]):new Array(t[0]).fill("");e[0]=r.olU.CalculatedRowsFormulaTotalHeader,o=e.concat(o)}return o}function f(e,t,n,a){if(e<0||t<0||n<0||a<0)throw new Error("Invalid indices");const o=e+1,r=t+1,i=e+n,l=t+a;return`${(0,c.LM)(o,r)}:${(0,c.LM)(i,l)}`}function C(e){const t=e.workbook.worksheets.getActiveWorksheet().getUsedRangeOrNullObject(!0);return()=>t.isNullObject}function y(e){const t=e.replace(/^\[\$-([a-z]+-[A-Za-z0-9]+(-[A-Z]+)?)?(,[0-9]{1,3})?\]/,"");return g.gv.some((e=>e===t))}function v(e){return"string"==typeof e&&(0===e.length||0===e.replace(/\s/g,"").length)}function T(e,t){const n=p(t);return null==n?e.workbook.worksheets.getActiveWorksheet():e.workbook.worksheets.getItem(n)}async function x(e,t){let n;for(;!n?.done;)n=t.next(),await e.sync();return n.value}function S(e){const t=e.indexOf(":");return-1===t?e:e.substring(0,t)}function w(e){const t=p(e,!0),n=h(e);if(n){const e=(0,u.AW)(n);return t?`${t}!${(0,u.z)(e.right+1)}${e.top}`:`${(0,u.z)(e.right+1)}${e.top}`}}function E(e,t,n,o){if(!(o>=n))return(0,c.LM)(t,e+o);s.M.getInstance().logErrorCode(a.O.CalculatedColumnPreviewColumnOffsetOutOfTable,new Error("getFirstCellAddressOfColumnInTable: columnOffset is out of table"),l.S2.FormulaGeneration,i.$b.Warning)}function I(e,t){const n=p(e,!0),a=h(e);if(a){const e=(0,u.AW)(a);return n?`${n}!${(0,u.z)(e.left+t)}${e.bottom+1}`:`${(0,u.z)(e.left+t)}${e.bottom+1}`}}const R=async e=>Excel.run((async t=>{const n=t.workbook.worksheets.getActiveWorksheet().getRange(e);return n.load("valueTypes"),await t.sync(),A(n)}));function A(e){return e.valueTypes.every((e=>e.every((e=>e===Excel.RangeValueType.empty))))}async function L(e,t){const n=(0,m.d)(e);await e.sync();const a=await n()(e);return t.push(a.undo),a.result}function k(e){return 0===e.length?e:e[0].map(((t,n)=>e.map((e=>e[n]))))}function F(e){return void 0!==e}const _="d",P="w",N=new RegExp("[0-9]","gm"),M=new RegExp(_,"gm"),O=new RegExp(`[^=\\[\\]\\.\\\\/%#\\-\\+,;\\(\\):?"&<>'!{}~\\^\\*$¢£¤¥₠₡₢₣₤₥₦₧₨₩₪₫€₭₮₯₰₱₲₳₴₵₶₷₸₹\\s\\ua0c2${_}]`,"gm");function D(e){return(e=(e=e.toLowerCase().replace(M,P)).replace(N,_)).replace(O,P)}function B(e){return e.flatMap((e=>e.map(D)))}function $(e){const t=e.match(/^(?:[^!]+!)?\$?([A-Z]{1,3})\$?\d+(?::\$?[A-Z]{1,3}\$?\d+)?$/);return t?.[1]?function(e){e=e.toUpperCase();let t=0;for(let n=0;n<e.length;n++)t*=26,t+=e.charCodeAt(n)-"A".charCodeAt(0)+1;return t}(t[1]):-1}function H(e){return e.calculatedFormulas.length<=1}function U(e){return!e.insertRowTitle&&q(e)}function q(e){if(!H(e))return!1;const t=e.calculatedFormulas[0].insertionIndexes;return void 0===t||t.length<=1}function V(e){return Boolean(e.isSingleFormula&&e.calculatedFormulas[0]?.insertionMode===o.PH.OverrideSelection)}function W(e){return Boolean((0,d.yw9)("OfficeVSO_9753947_insertCellToFixedRange")&&H(e)&&e.calculatedFormulas[0]?.insertionMode===o.PH.OverrideFixedRange&&e.calculatedFormulas[0]?.fixedInsertionRange)}async function G(){return Excel.run((async e=>{const t=e.workbook.worksheets.getActiveWorksheet();return t.load("name"),await e.sync(),t.name}))}async function z(){return Excel.run((async e=>{const t=e.workbook.getActiveCell();return t.load("address"),await e.sync(),t.address}))}async function Q(){return h(await z())??""}},660606:(e,t,n)=>{"use strict";n.d(t,{EG:()=>a,JB:()=>r,YP:()=>l,cY:()=>i,t6:()=>o});var a,o,r=void 0,i=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n]},l=function(e,t,n,l){r=e,i=t,a=n,o=l}},661588:(e,t,n)=>{"use strict";n.d(t,{M:()=>b,m:()=>C});n(554094);var a=n(544861),o=n(75496),r=n(518377),i=n(486092),l=n(236423),s=n(905666),c=n(347145),d=n(468967),u=n(469486),m=n(799765),g=n(450818),h=n(208520);const p=(0,h.lazy)((()=>Promise.all([n.e("monaco-editor"),n.e("vendors-npm_store_sdx_officecopilot_monaco-editor_0_46_0-51dbdf7e44e9cf33acc3_node_modules_mo-e5e20f"),n.e("monacoreadonly")]).then(n.bind(n,166600)))),b=1,f=()=>Office.context.platform===Office.PlatformType.Mac&&!(0,c.yw9)("OfficeVSO_9770243_MacCopyButtonFix");function C(e){const{requestId:t,codeExplanation:n,code:c}=e,C=(0,g.E)();return h.createElement(a.lJ,{contentBody:h.createElement(s.B,{tokens:{childrenGap:8},className:(0,i.z)(C.pythonRecommendation,"python-recommendation")},h.createElement(h.Suspense,{fallback:h.createElement(l.y,null)},h.createElement(r.$,{title:"Python",content:h.createElement(p,{code:c}),getClipboardItem:f()?void 0:()=>async function(e){let t=new ClipboardItem({"text/plain":""});try{const n=(0,u.ZK)(e,!1,b);t=new ClipboardItem({"text/plain":new Blob([n],{type:"text/plain"})}),(0,m.PB)(o.L3.CopyButtonClicked,[])}catch(e){const t=(0,d.LH)(e);(0,d.QX)(null,t,!1)}return t}(c),explanation:n?{explanation:n}:void 0}))),requestId:t})}},664007:(e,t,n)=>{"use strict";n.d(t,{F:()=>w,m:()=>S});var a=n(279395),o=n(178365),r=n(318969),i=n(857677),l=n(83437),s=n(644476),c=n(76872),d=n(75496),u=n(316904),m=n(859981),g=n(109174),h=n(347145),p=n(972424),b=n(860730),f=n(469486),C=n(672270),y=n(507628);const v={isExecuting:!1,showLoadingUI:!1,loadingStrings:(0,h.yw9)("OfficeVSO_9592556_InitialLoadingStringsEmpty")?[]:(0,a.ZYo)(!0),currentNLResult:void 0,currentNLResultVisualIndex:0,currentNLResultTableName:void 0,currentNLResultTableContext:void 0,isCurrentNLResultValid:!1,currentRecos:void 0,currentRecoIndex:0,suggestionList:[],executionStartTime:void 0,executingCommand:void 0,executingId:void 0,latestRequestId:void 0,lastUserPrompt:void 0,fillablePromptList:void 0,recentlyShownPrompts:[],nextSuggestionTypePriorities:[],isSkillResponseRequired:!1,zeroQueryTimeout:void 0,fluxExecutionStartTime:void 0,isDarkModeEnabled:!1,queryOriginByQueryId:{},onGridQueryCellAddressByQueryId:{},onGridQueryElseCategoryOverrideByQueryId:{},isInsertingFormulaSuggestion:!1,isPythonStartAnalysisButtonDisabled:!1,dataShapingState:{enableDebugging:!1,started:!1},singleModeState:{feature:"off"},zqmSuggestionList:[],lastPythonQueryId:void 0,isPythonMode:!1,isPythonThinkDeeperMode:!1},T=(e,t,n,a)=>{c.E.getInstance().logLatency((0,i.xJ)(t),e,n,a)},x=(0,s.Z0)({name:"chat",initialState:v,reducers:{startExecutingCommand:(e,t)=>{let n,r;e.executionStartTime&&e.executingCommand&&(e.executingCommand===i.OP.FluxReasoning&&t.payload.command!==i.OP.FluxReasoning&&t.payload.command!==i.OP.Search||u.M.getInstance().logError({eventType:d.S2.Latency,errorMessage:`Command ${e.executingCommand} was not stopped before starting ${t.payload.command}`,logLevel:l.$b.Warning}),T(e.executingCommand,e.executionStartTime)),e.executingCommand=t.payload.command,e.executionStartTime=(new Date).getTime(),e.executingId=t.payload.id;const s=g.CP.getActiveTable();s&&(n=(0,p.r)(s.address),(0,h.yw9)("OfficeVSO_9851580_AddSheetNameToLatencyString")&&(r=s.sheetRange.sheet));const c=(0,h.yw9)("OfficeVSO_9851580_AddSheetNameToLatencyString")&&(0,h.ZAR)()&&void 0!==r;switch(t.payload.command){case i.OP.AnalyzeData:e.loadingStrings=n?c?(0,a.x4R)().map((e=>e.replace("{range}",n).replace("{sheet}",r))):(0,a.uo4)().map((e=>e.replace("{0}",n))):(0,a.zZj)();break;case i.OP.InsertAnalyzeData:e.loadingStrings=(0,a.SUe)();break;case i.OP.CalculatedColumns:e.loadingStrings=n?c?(0,a.CP3)().map((e=>e.replace("{range}",n).replace("{sheet}",r))):(0,a.BaS)().map((e=>e.replace("{0}",n))):(0,a.wvg)();break;case i.OP.CalculatedCells:e.loadingStrings=n?c?(0,a.aaC)().map((e=>e.replace("{range}",n).replace("{sheet}",r))):(0,a.tJt)().map((e=>e.replace("{0}",n))):(0,a._lL)();break;case i.OP.InsertCalculatedColumn:e.loadingStrings=(0,a.M_1)();break;case i.OP.InsertCalculatedColumns:e.loadingStrings=(0,a.tZV)();break;case i.OP.InsertFormulaSuggestion:e.loadingStrings=(0,a.j9u)();break;case i.OP.InsertCalculatedCell:{const t=g.CP.calculatedFormulaInsertLocation??"",n=a.olU.CalculatedRowsCellHeader;e.loadingStrings=c?[a.olU.LoadingUIAddingCellWithAddressStepWithSheet.replace("{range}",n).replace("{cellAddress}",t).replace("{sheet}",r)]:[a.olU.LoadingUIAddingCellWithAddressStep.replace("{0}",n).replace("{cellAddress}",t)];break}case i.OP.InsertCalculatedCells:{const t=g.CP.calculatedFormulaInsertLocation??"",n=a.olU.CalculatedRowsRowHeader;e.loadingStrings=c?[a.olU.LoadingUIAddingCellsWithAddressStepWithSheet.replace("{range}",n).replace("{rowNumber}",t).replace("{sheet}",r)]:[a.olU.LoadingUIAddingCellsWithAddressStep.replace("{0}",n).replace("{rowNumber}",t)];break}case i.OP.UpdateCalculatedCell:{const t=g.CP.calculatedFormulaInsertLocation??"",n=a.olU.CalculatedRowsCellHeader;e.loadingStrings=c?[a.olU.LoadingUIAddingCellUpdateWithAddressStepWithSheet.replace("{range}",n).replace("{cellAddress}",t).replace("{sheet}",r)]:[a.olU.LoadingUIAddingCellUpdateWithAddressStep.replace("{0}",n).replace("{cellAddress}",t)];break}case i.OP.UpdateCalculatedCells:{const t=g.CP.calculatedFormulaInsertLocation??"",n=a.olU.CalculatedRowsRowHeader;e.loadingStrings=c?[a.olU.LoadingUIAddingCellsUpdateWithAddressStepWithSheet.replace("{range}",n).replace("{rowNumber}",t).replace("{sheet}",r)]:[a.olU.LoadingUIAddingCellsUpdateWithAddressStep.replace("{0}",n).replace("{rowNumber}",t)];break}case i.OP.ApplyDataShaping:e.loadingStrings=(0,a.znb)();break;case i.OP.ChartDesignRecommendations:e.loadingStrings=(0,a.$LK)();break;case i.OP.ApplyTLRAutoFix:case i.OP.Commanding:case i.OP.ConditionalFormatting:{const t=g.CP.getHumanInTheLoopRange();(0,h.k64)()&&t?e.loadingStrings=c?(0,a.YB4)().map((e=>e.replace("{range}",n).replace("{sheet}",r))):(0,a.xJ7)().map((e=>e.replace("{range}",t))):e.loadingStrings=n&&s?.tableLikeRange?c?(0,a.Bpz)().map((e=>e.replace("{range}",n).replace("{sheet}",r))):(0,a._9M)().map((e=>e.replace("{0}",n))):(0,h.geU)()?(0,a._73)():(0,a.XQw)();break}case i.OP.FluxGenerateResponse:e.loadingStrings=(0,a.De1)();break;case i.OP.SaveOfficeScripts:e.loadingStrings=a.UOv;break;case i.OP.CreateOfficeScripts:e.loadingStrings=a.XFR;break;case i.OP.PythonStartAnalysis:e.loadingStrings=(0,a.EwU)();break;case i.OP.PythonCellsCalculating:e.loadingStrings=(0,a.aDI)();break;case i.OP.EnterDataShapingMode:e.loadingStrings=(0,a.CcC)();break;case i.OP.ExitDataShapingMode:e.loadingStrings=(0,a.aRL)();break;case i.OP.ImportDataLoadQuery:e.loadingStrings=(0,a.w$T)();break;case i.OP.ImportDataRelevancyCheck:e.loadingStrings=(0,a.NLG)();break;case i.OP.ImportDataGenerateSuggestion:e.loadingStrings=(0,a.zDx)();break;case i.OP.PythonInsertingResultInNewSheet:e.loadingStrings=(0,a.Huq)();break;case i.OP.FluxReasoning:case i.OP.ActionAI:case i.OP.Search:default:g.CP.pythonContextManager.isPythonMode?e.loadingStrings=(0,a.T8g)():!(0,h.ZAR)()&&n?e.loadingStrings=c?(0,a.ZU3)().map((e=>e.replace("{range}",n).replace("{sheet}",r))):(0,a.w7p)().map((e=>e.replace("{0}",n))):e.loadingStrings=(0,a.ZYo)()}e.isExecuting=!0,e.showLoadingUI=!0,o.$.getInstance().startLoadingUi()},stopExecuting:(e,t)=>{e.executionStartTime&&T(e.executingCommand??i.OP.NoCurrentlyExecutingCommandSet,e.executionStartTime,t.payload?.isSuccess),e.isExecuting=!1,e.showLoadingUI&&!t.payload?.keepShowingLoadingUIIfAlreadyActive&&(e.showLoadingUI=!1),e.executingCommand=void 0,e.executionStartTime=void 0,e.executingId=void 0,e.zeroQueryTimeout&&(window.clearTimeout(e.zeroQueryTimeout),e.zeroQueryTimeout=void 0)},startInsertingFormulaSuggestion:e=>{e.isInsertingFormulaSuggestion=!0},stopInsertingFormulaSuggestion:e=>{e.isInsertingFormulaSuggestion=!1},hideLoadingUI:e=>{!0===e.showLoadingUI&&o.$.getInstance().stopLoadingUi(),e.showLoadingUI=!1},setSuggestionListDetails:(e,t)=>{g.CP.pythonContextManager.isPythonMode&&!t.payload.isPythonSuggestion||e.dataShapingState.started||(e.suggestionList=t.payload.suggestionList,e.nextSuggestionTypePriorities=t.payload.nextSuggestionTypePriorities??[],e.recentlyShownPrompts=[...e.recentlyShownPrompts,...t.payload.suggestionList.map((e=>e.suggestionText))])},setZqmSuggestionList:e=>{const t=(0,h.Z8j)("Microsoft.Office.Excel.FA000000124.GuaranteePythonSuggestion",0),n=0!==t&&(0,h.H2A)()&&((0,f.gx)()||(0,h.ggM)()&&(0,h.yw9)("OfficeVSO_10277196_AnswersSkipLicenseCheckFixed")&&(0,f.XT)()),a=2===t,o=(0,h.Z8j)("Microsoft.Office.Excel.FA000000124.PromptSuggestionsToShow",3);n?(e.zqmSuggestionList=[...(0,C.R3)(Object.keys(m.Oc).filter((t=>!e.zqmSuggestionList.includes(t)&&(0,b._2)(t)))).slice(0,1),...(0,C.R3)(Object.keys(m.jH).filter((t=>!e.zqmSuggestionList.includes(t)&&(0,b._2)(t)))).slice(0,o-1)],a||(e.zqmSuggestionList=(0,C.R3)(e.zqmSuggestionList))):e.zqmSuggestionList=(0,C.R3)(Object.keys(m.w_).filter((t=>!e.zqmSuggestionList.includes(t)&&(0,b._2)(t)))).slice(0,o)},setNextSuggestionTypePriorities:(e,t)=>{e.nextSuggestionTypePriorities=t.payload},setRecentlyShownPrompts:(e,t)=>{e.recentlyShownPrompts=t.payload},clearSuggestionList:e=>{e.suggestionList=[]},setCurrentNLResultInvalid:e=>{e.isCurrentNLResultValid=!1},setLoadingStrings:(e,t)=>{e.loadingStrings=t.payload},incrementCurrentNLResultVisualIndex:e=>{e.currentNLResultVisualIndex++,e.currentNLResult?.visualAnswer&&e.currentNLResultVisualIndex+1>=e.currentNLResult.visualAnswer.length&&(e.suggestionList=e.suggestionList.filter((e=>"AnalyzeData_ShowMore"!==e.suggestionType)))},updateCurrentNLResult:(e,t)=>{e.isCurrentNLResultValid=t.payload.isCurrentNLResultValid,e.currentNLResult=t.payload.currentNLResult,e.currentNLResultVisualIndex=t.payload.currentNLResultVisualIndex,e.currentNLResultTableName=t.payload.tableName,e.currentNLResultTableContext=t.payload.tableContext},updateCurrentRecos:(e,t)=>{e.currentRecos=t.payload,e.currentRecoIndex=0},incrementRecoIndex:e=>{e.currentRecoIndex++},removeFirstSuggestionPill:e=>{e.suggestionList.length>0&&(e.suggestionList=e.suggestionList.slice(1))},setLatestRequestId:(e,t)=>{e.latestRequestId=t.payload},setZeroQueryTimeout:(e,t)=>{e.zeroQueryTimeout=t.payload},initializeSuggestionList:e=>{e.fillablePromptList=(0,r.zH)()},setIsDarkModeEnabled:(e,t)=>{e.isDarkModeEnabled=t.payload},setPythonStartAnalysisButtonDisabled:(e,t)=>{e.isPythonStartAnalysisButtonDisabled=t.payload},setQueryOriginByQueryId:(e,t)=>{const{queryId:n,queryOrigin:a}=t.payload;e.queryOriginByQueryId[n]=a},setOnGridQueryCellAddressByQueryId:(e,t)=>{const{queryId:n,onGridQueryCellAddress:a}=t.payload;e.onGridQueryCellAddressByQueryId[n]=a},setOnGridQueryElseCategoryOverrideByQueryId:(e,t)=>{const{queryId:n,elseCategoryOverride:a}=t.payload;e.onGridQueryElseCategoryOverrideByQueryId[n]=a},addDataShapingChatEntry:(e,t)=>{if(!e.dataShapingState.started)throw new Error("Data shaping mode is not started");e.dataShapingState.chatHistory.push(t.payload)},enterDataShapingMode:(e,t)=>{e.dataShapingState={enableDebugging:e.dataShapingState.enableDebugging,started:!0,disableQueryScriptUpdates:!1,baseScript:t.payload.queryScript,chatHistory:[],...t.payload}},exitDataShapingMode:e=>{e.dataShapingState={enableDebugging:e.dataShapingState.enableDebugging,started:!1}},enterSingleMode:(e,t)=>{e.singleModeState=t.payload},exitSingleMode:e=>{e.singleModeState={feature:"off"}},setDataShapingDebugging:(e,t)=>{e.dataShapingState.enableDebugging=t.payload},updateDataShapingQueryScript:(e,t)=>{if(!e.dataShapingState.started)throw new Error("Data shaping mode is not started");e.dataShapingState.queryScript=t.payload},setDisableQueryScriptUpdates:(e,t)=>{if(!e.dataShapingState.started)throw new Error("Data shaping mode is not started");e.dataShapingState.disableQueryScriptUpdates=t.payload},startNewPythonQuery:e=>{e.lastPythonQueryId=(0,y.A)()},setIsPythonMode:(e,t)=>{e.isPythonMode=t.payload},setIsPythonThinkDeeperMode:(e,t)=>{e.isPythonThinkDeeperMode=t.payload}}}),{actions:S,reducer:w}=x},667977:(e,t,n)=>{"use strict";n.d(t,{BG:()=>s,LS:()=>c,do:()=>l});var a=n(616166),o=n(83437),r=n(75496),i=n(316904);const l=5;function s(e,t,n,s,c,u){if(c=function(e,t,n,s){if(s&&s.length>0||!n)return s;const c=t+1,d=c+e.length-1,u=n.filter((e=>e>=c&&e<=d)).map((t=>e[t-c].map((e=>({value:e,row:t})))));if(n.length===u.length||u.length>=l-1)return u;return i.M.getInstance().logErrorCode(a.O.CalculatedColumnVisibleRowsOutOfRange,new Error(`Not enough visible rows to generate visibleRowsPreviewValues, generated ${u.length} rows out of ${n.length} visible rows`),r.S2.FormulaGeneration,o.$b.Warning),function(e,t){const n=e.slice(0,l).map(((e,n)=>e.map((e=>({value:e,row:t+n})))));return n}(e,c)}(s,e,u,c),c&&c.length>0)return function(e,t,n,a){const o={headerRow:e,columnLetters:t,columnHeaders:n,rows:[]},r=a[0].length,i=d(a,l);o.rows=i.map((e=>({row:e[0].row,values:d(e,r).map((e=>e.value))}))),a.length>i.length&&o.rows.splice(-1,1,{row:"...",values:Array(r).fill("...")});return o}(e,t,n,c);const m={headerRow:e,columnLetters:t,columnHeaders:n,rows:[]},g=s[0].length,h=d(s,l);return m.rows=h.map(((t,n)=>({row:e+1+n,values:d(t,g)}))),s.length>h.length&&m.rows.splice(-2,2,{row:"...",values:Array(g).fill("...")},{row:e+s.length,values:s[s.length-1]}),m}function c(e,t,[n],a,o){const r={headerRow:e,columnLetters:t,columnHeaders:a[0],rows:[],headerPreviewValue:n.at(-1)},i=a.slice(1),s=n.length,c=d(i,l-1);return r.rows=c.map(((t,n)=>({row:e+1+n,values:d(t,s)}))),i.length>c.length&&r.rows.splice(-1,1,{row:"...",values:Array(s).fill("...")}),r.rows.push({row:e+(o??i.length+1),values:n}),r}function d(e,t){return e.slice(0,t)}},670447:(e,t,n)=>{"use strict";n.d(t,{Cn:()=>s,EQ:()=>l,S:()=>i,xq:()=>u,yc:()=>r});var a=n(615397);function o(e){e=e.replace("#","");for(;e.length<6;)e="0"+e;return e}function r(e){e=o(e);const t=parseInt(e,16);if(isNaN(t))throw new Error("NaN");return t}function i(e){let t=e.toString(16);for(;t.length<6;)t="0"+t;return"#"+t.toUpperCase()}function l(e){return(255&e)<<16|65280&e|(16711680&e)>>16}function s(e){return l(e)}function c(e){let t="",n="",r="";if(6!==(e=o(e)).length)throw new a.tF("Hex color value length is not 7.","convertHexToTuple");t=`0x${e[0]}${e[1]}`,n=`0x${e[2]}${e[3]}`,r=`0x${e[4]}${e[5]}`;const i={r:parseInt(t),g:parseInt(n),b:parseInt(r)};if(Number.isNaN(i.r)||Number.isNaN(i.g)||Number.isNaN(i.b))throw new a.tF("Failed to parse hex value into numbers.","convertHexToTuple");return i}function d(e){let t,n,a,o=e.r/255,r=e.g/255,i=e.b/255;return o=o>.04045?Math.pow((o+.055)/1.055,2.4):o/12.92,r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92,i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92,t=(.4124*o+.3576*r+.1805*i)/.95047,n=(.2126*o+.7152*r+.0722*i)/1,a=(.0193*o+.1192*r+.9505*i)/1.08883,t=t>.008856?Math.pow(t,1/3):7.787*t+16/116,n=n>.008856?Math.pow(n,1/3):7.787*n+16/116,a=a>.008856?Math.pow(a,1/3):7.787*a+16/116,{l:116*n-16,a:500*(t-n),b:200*(n-a)}}function u(e,t){if(-1!==e.findIndex((e=>e===t)))return t;{let n=0;const o=d(c(t)),r=e.reduce(((e,t)=>{const a=d(c(e)),r=d(c(t)),i=new m(a,o).getDeltaE(),l=new m(r,o).getDeltaE();return n=Math.min(l,i),l<i?t:e}));if(n<35)return r;throw new a.tF("No close color matched.","getClosestColor",a.tJ.ColorDistanceExceededThreshold)}}class m{getDeltaE(){try{this.hPrime1=this.gethPrime1(),this.hPrime2=this.gethPrime2(),this.deltahPrime=this.getDeltahPrime(),this.deltaHPrime=2*Math.sqrt(this.CPrime1*this.CPrime2)*Math.sin(this.degreesToRadians(this.deltahPrime)/2),this.HBarPrime=this.getHBarPrime(),this.T=this.getT(),this.SsubH=1+.015*this.CBarPrime*this.T,this.RsubT=this.getRsubT();const e=this.deltaLPrime/(this.ksubL*this.SsubL),t=this.deltaCPrime/(this.ksubC*this.SsubC),n=this.deltaHPrime/(this.ksubH*this.SsubH);return Math.sqrt(Math.pow(e,2)+Math.pow(t,2)+Math.pow(n,2)+this.RsubT*t*n)}catch{throw new a.tF("Error happened during calculating the color distance.","getDeltaE")}}getT(){return 1-.17*Math.cos(this.degreesToRadians(this.HBarPrime-30))+.24*Math.cos(this.degreesToRadians(2*this.HBarPrime))+.32*Math.cos(this.degreesToRadians(3*this.HBarPrime+6))-.2*Math.cos(this.degreesToRadians(4*this.HBarPrime-63))}getHBarPrime(){return Math.abs(this.hPrime1-this.hPrime2)>180?(this.hPrime1+this.hPrime2+360)/2:(this.hPrime1+this.hPrime2)/2}getDeltahPrime(){return 0===this.C1||0===this.C2?0:Math.abs(this.hPrime1-this.hPrime2)<=180?this.hPrime2-this.hPrime1:this.hPrime2<=this.hPrime1?this.hPrime2-this.hPrime1+360:this.hPrime2-this.hPrime1-360}gethPrime1(){return this.gethPrimeFn(this.x1.b,this.aPrime1)}gethPrime2(){return this.gethPrimeFn(this.x2.b,this.aPrime2)}gethPrimeFn(e,t){if(0===e&&0===t)return 0;const n=this.radiansToDegrees(Math.atan2(e,t));return n>=0?n:n+360}radiansToDegrees(e){return e*(180/Math.PI)}degreesToRadians(e){return e*(Math.PI/180)}constructor(e,t,n){this.hPrime1=0,this.hPrime2=0,this.deltahPrime=0,this.deltaHPrime=0,this.HBarPrime=0,this.T=0,this.SsubH=0,this.RsubT=0,this.getRsubT=()=>-2*Math.sqrt(Math.pow(this.CBarPrime,7)/(Math.pow(this.CBarPrime,7)+Math.pow(25,7)))*Math.sin(this.degreesToRadians(60*Math.exp(-Math.pow((this.HBarPrime-275)/25,2)))),this.x1=e,this.x2=t,this.weights=n??{lightness:1,chroma:1,hue:1},this.ksubL=this.weights.lightness,this.ksubC=this.weights.chroma,this.ksubH=this.weights.hue,this.deltaLPrime=t.l-e.l,this.LBar=(e.l+t.l)/2,this.C1=Math.sqrt(Math.pow(e.a,2)+Math.pow(e.b,2)),this.C2=Math.sqrt(Math.pow(t.a,2)+Math.pow(t.b,2)),this.CBar=(this.C1+this.C2)/2,this.aPrime1=e.a+e.a/2*(1-Math.sqrt(Math.pow(this.CBar,7)/(Math.pow(this.CBar,7)+Math.pow(25,7)))),this.aPrime2=t.a+t.a/2*(1-Math.sqrt(Math.pow(this.CBar,7)/(Math.pow(this.CBar,7)+Math.pow(25,7)))),this.CPrime1=Math.sqrt(Math.pow(this.aPrime1,2)+Math.pow(e.b,2)),this.CPrime2=Math.sqrt(Math.pow(this.aPrime2,2)+Math.pow(t.b,2)),this.CBarPrime=(this.CPrime1+this.CPrime2)/2,this.deltaCPrime=this.CPrime2-this.CPrime1,this.SsubL=1+.015*Math.pow(this.LBar-50,2)/Math.sqrt(20+Math.pow(this.LBar-50,2)),this.SsubC=1+.045*this.CBarPrime,this.hPrime1=0,this.hPrime2=0,this.deltahPrime=0,this.deltaHPrime=0,this.HBarPrime=0,this.T=0,this.SsubH=0,this.RsubT=0}}},671100:()=>{},672270:(e,t,n)=>{"use strict";n.d(t,{EO:()=>X,Kv:()=>V,R3:()=>P,RE:()=>Z,VY:()=>W,WS:()=>B,Y6:()=>J,Yd:()=>H,Yp:()=>Y,cY:()=>N,jZ:()=>O,m4:()=>j,mm:()=>q,qW:()=>$,sZ:()=>G,uN:()=>M});var a=n(279395),o=n(639765),r=n(548366),i=n(308849),l=n(207545),s=n(83437),c=n(993821),d=n(822606),u=n(379422),m=n(109174),g=n(648982),h=n(656931),p=n(197665),b=n(749832),f=n(28987),C=n(75496),y=n(316904),v=n(857677),T=n(13161),x=n(650444),S=n(92520),w=n(831922),E=n(347145),I=n(9361),R=n(882329),A=n(808943),L=n(994481),k=n(851295),F=n(469486),_=n(758651);const P=e=>{let t,n=e.length;for(;0!==n;)t=Math.floor(Math.random()*n),n--,[e[n],e[t]]=[e[t],e[n]];return e},N=(e,...t)=>{(0,S.K_)()&&_.log("Excel Copilot Chat Log:",e,...t)},M=e=>{if(e.json){const t=JSON.parse(e.json);switch(t.code){case"unsupported-multi-agent":return(0,a.CDl)();case"document-processing-denied":if((0,E.yw9)("OfficeVSO_10156381_ExcelCopilotChatDlpMessage"))return(0,a.UTd)();break;case"unknown":if("guardlist"===t.callReason&&m.CP.pythonContextManager.isStartAnalysisCard())return(0,F.Tk)(!1),(0,a.Dpi)()}}const t=(0,a.UuN)();let n=t;return(0,a.Ogc)().some((a=>((e.message===a.error||e.message.startsWith(a.error))&&(n=a.errorMessageUser),n!==t))),n},O=e=>D(e,(0,a.QEp)()),D=(e,t)=>(e=(e=e.replace(/[.,?!']/g,"")).toLowerCase(),t.some((t=>t===e))),B=(e,t)=>(e=(e=e.replace(/[.,?!']/g,"")).toLowerCase(),t.some((t=>e.includes(t)))),$=e=>{const t=[];return B(e,(0,a.J_P)())&&t.push(T.DH.Undo),B(e,(0,a.hAW)())&&t.push(T.DH.TableAltText),B(e,(0,a.inn)())&&t.push(T.DH.AddComment),B(e,(0,a.fOb)())&&t.push(T.DH.DataValidation),B(e,(0,a.fOb)())&&t.push(T.DH.CreatePivotTable),B(e,(0,a.VAP)())&&t.push(T.DH.DeleteWorksheets),t},H=e=>{switch(e){case"ChartVisual":case"QueryChartVisual":return(0,a.zQo)()[0];case"PivotChartVisual":return(0,a.zQo)()[1];case"PivotTableVisual":return(0,a.zQo)()[2];case"QueryResultVisual":return(0,a.zQo)()[3];case"ForecastVisual":case"TextAnalysisVisual":return null;default:(0,x.x)(e)}},U=async e=>{const t=()=>{const t=e?.some((e=>e.id===a.AF5),!1);return{webGroundingEnabled:!t&&(0,E.vIj)()&&(0,A.gc)(),enterpriseGroundingEnabled:(0,A.pX)(),docGroundingDisabled:!1,requireExplicitPlugins:(0,E.vIj)(),searchOnlyMode:!1,pluginInfo:e??[],...(0,E.gnD)()&&{isPythonThinkDeeperMode:m.CP.pythonContextManager.isPythonThinkDeeperMode}}};return(0,E._bw)()?await(0,L.Eb)(t):{copilotConfig:t()}},q=async(e,t,n,a,o,r,s,c,d,m,g,p,b,f)=>{const C=a??h.Z.getInstance().getConversationId();N(`createInputSignalOperationBody: ${r}, ${JSON.stringify(s)}`);const y=(0,i.Hr)(m),v=await e.getContextString(n),T=d===w.defaultCopilotChatMenuItemId?void 0:d||m?.appId;return new u.qO({query:t,queryId:n,gptId:(0,E.Pz_)()?T:void 0,context:v,raw:(0,l.I_)(),fluxSkillOverride:o,config:{...await U(s),isToolboxEnabled:!!T||(0,E.KV_)(),isInterstitialConfirmationEnabled:(0,E.dw_)(),isInterstitialAuthenticationEnabled:(0,E.I3H)()},queryAnnotations:r,conversationId:C,images:c,mentionedPlugins:y,isWarmUp:g,requestContinuation:p,clientUILanguageAndLocale:(0,k.gl)(),userQueryLanguage:(0,E.yw9)("OfficeVSO_9526211_SendUserQueryLanguageInInputSignal")?b:void 0,clientCapabilities:f})},V=async(e,t,n)=>{(0,S.cY)("Copy button clicked");try{e&&(await navigator.clipboard.write([e]),n&&y.M.getInstance().logEvent((0,v.Qf)(n)))}catch(e){(0,S.cY)("Error copying html to clipboard",e.message),y.M.getInstance().logError({eventType:t,errorMessage:"Error copying html to clipboard "+e.message,logLevel:s.$b.ASHA}),y.M.getInstance().logStandardizedAshaErrorEvent(r.W.Unable_To_Complete_Task,o.c.Failed_To_Copy_Response,v.BJ.CopilotChat)}};function W(e,t){return e.replaceAll(/\{(\w+)\}/g,((e,n)=>n in t?String(t[n]):`${n}`))}function G(){window.document.getElementById(a.OsU)?.style.setProperty("display","none")}const z="brk-multihub://fa000000124.resources.office.net";const Q=async e=>{let t=!1;if((0,E.AJD)()&&(0,E.am)()&&p.iJ.isWebPlatform())try{t=await OfficeFirstPartyAuth.NestedAppAuth.isBridgeAvailableAsync()}catch(e){t=!1}return(0,E.AJD)()&&(p.iJ.isIOSPlatform()||p.iJ.isWin32Platform()||p.iJ.isMacPlatform()||t)?"NestedAppAuth":(0,E.XPY)()&&p.iJ.isWebPlatform()&&e?"PairwiseBroker":"Default"};async function j(){if(!(0,E.kkU)()&&!(0,E.l6e)())return(0,I.z)();let e;if((0,E.FsT)()){const t=(0,c.dL)();e=(0,c.FF)(t)}const t=!!e,n=await Q(t),a={locale:(0,p.Yd)(),sessionId:b.V.getSettingAsString(b.z.AugloopSharedSessionID),physicalRing:(0,l.I_)()?"Dogfood":"Prod",clientType:p.iJ.isWebPlatform()?f.WK.web:f.WK.desktop,hubName:f.UH.office,redirectUri:(0,R.x3)(),nestedAppAuthRedirectUri:(0,E.sDe)()?(0,R.x3)():z,preferredAuthenticationStrategy:n,trustedBrokerDomain:e,clientId:d.qA,aadUserId:"",userName:"",userPrincipalName:""};let o="",r="",i="";try{const e=new Promise((e=>Office.context.auth.getAuthContextAsync(e))),t=await e,n=await OfficeFirstPartyAuth.getPrimaryIdentityInfo();if("succeeded"===t.status){const e=t.value;o=(0,E.MHS)()?n.displayName:e.userObjectId,i=e.userPrincipalName,r=(0,E.i9S)()?n?.email:i}else N("Failed to fetch user id from OfficeJS")}catch(e){return N("Error getting user info: "+e),a}return{...a,aadUserId:r,bizChatAadUserId:i,userName:o,bizChatUserName:o,userPrincipalName:r,bizChatUserPrincipalName:i}}function J(){return!g.s.getInstance().isWaitingForStreamEnd()}function Y(e,t=35){const n="...";return e?.length>t-3?e.substring(0,t-3)+n:e}async function X(){let e="";try{const t=new Promise((e=>Office.context.auth.getAuthContextAsync(e))),n=await t;if("succeeded"===n.status){const t=n.value;t?(e=t.tenantId,N("Fetched tenant id for Safelinks successfully")):(N("AuthContext is undefined"),y.M.getInstance().logError({eventType:C.S2.Safelinks,errorMessage:"AuthContext is undefined",logLevel:s.$b.ASHA}))}else N(`Failed to fetch tenant ID. Status: ${n.status}`),y.M.getInstance().logError({eventType:C.S2.Safelinks,errorMessage:`Failed to fetch tenant ID. Status: ${n.status}`,logLevel:s.$b.ASHA})}catch(e){N(`Error getting tenant ID: ${e}`),y.M.getInstance().logError({eventType:C.S2.Safelinks,errorMessage:`Error getting tenant ID: ${e}`,logLevel:s.$b.ASHA})}return e}function Z(e,t){return`chart_${function(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return Math.abs(t).toString(36)}(`${e}::${t}`)}`}},673911:(e,t,n)=>{"use strict";n.d(t,{k:()=>o});const a=[];for(let e=0;e<256;++e)a.push((e+256).toString(16).slice(1));function o(e,t=0){return(a[e[t+0]]+a[e[t+1]]+a[e[t+2]]+a[e[t+3]]+"-"+a[e[t+4]]+a[e[t+5]]+"-"+a[e[t+6]]+a[e[t+7]]+"-"+a[e[t+8]]+a[e[t+9]]+"-"+a[e[t+10]]+a[e[t+11]]+a[e[t+12]]+a[e[t+13]]+a[e[t+14]]+a[e[t+15]]).toLowerCase()}},678685:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(904967);t.default=function(e){if(!(0,a.default)(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)}},687295:(e,t,n)=>{"use strict";n.d(t,{s:()=>s});var a=n(660606),o=n(217425),r=n(632197),i=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{s(a.next(e))}catch(e){r(e)}}function l(e){try{s(a.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((a=a.apply(e,t||[])).next())}))},l=function(e,t){var n,a,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(n=1,a&&(o=2&l[0]?a.return:l[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,l[1])).done)return o;switch(a=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,a=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],a=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},s=function(e,t){return i(void 0,void 0,void 0,(function(){var n,i;return l(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),[4,e.getToken(null!=t?t:o.w8.substrate)];case 1:return n=l.sent(),[2,(0,r.t)(n)];case 2:throw i=l.sent(),(0,a.cY)("Error fetching Substrate token:",i),i;case 3:return[2]}}))}))}},690114:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.URL=t.DNS=void 0;const a=n(754577),o=n(463323);var r=n(463323);function i(e,t,n,r){return(0,o.default)(48,a.default,e,t,n,r)}Object.defineProperty(t,"DNS",{enumerable:!0,get:function(){return r.DNS}}),Object.defineProperty(t,"URL",{enumerable:!0,get:function(){return r.URL}}),i.DNS=o.DNS,i.URL=o.URL,t.default=i},693257:(e,t,n)=>{"use strict";n.d(t,{q:()=>o,w:()=>r});var a=n(109174);function o(e,t,n){return`${e},${t},${n}`}function r(e){const t=e.row,n=e.column,r=e.worksheetId,i={stdErr:e.stderr,stdOut:e.stdout};return function(e,t){a.CP.pythonContextManager.diagnosticsEntriesMap.set(e,t)}(o(t,n,r),i),Promise.resolve()}},694592:(e,t,n)=>{"use strict";n.d(t,{Cn:()=>T,D9:()=>E,JA:()=>k,M5:()=>w,f2:()=>x,hC:()=>L,qN:()=>_,qP:()=>F,vo:()=>R});var a=n(639765),o=n(548366),r=n(178365),i=n(197665),l=n(331343),s=n(47717),c=n(857677),d=n(76872),u=n(316904),m=n(650444),g=n(109174),h=n(638753),p=n(951903),b=n(92520),f=n(347145),C=n(8403);let y,v;function T({showAIGenerated:e,showAnimation:t,footerPosition:n,actionButtonList:a,isFailure:o,references:r,annotationReferences:i,clpLabel:l,msgExtCardProps:s,apiPluginCardProps:c,confirmationCardProps:d,pluginAuthError:u,feedbackArea:m,telemetryData:g,chatMessageHeader:p,gptId:f,shouldShowCopyButton:C,shouldShowHandoffButton:y,shouldShowReadAloudButton:v,codePreviewProps:T}){let x;(0,b.cY)(`Showing footer with showAnimation as ${t} and AIGenerated as ${e}`);try{x=g?JSON.stringify(g):void 0}catch(e){(0,b.cY)("Error in stringifying telemetry data",e)}const S={shouldShowAIGeneratedIndicator:e,feedbackSectionPosition:n,feedbackData:w(m),isFailure:o||!1,showAnimation:t,actionButtonList:a,references:r,annotationReferences:i,clpSensitivityIndicatorData:l,msgExtCardProps:s,apiPluginCardProps:c,confirmationCardProps:d,pluginAuthError:u,telemetryData:x,messageAttributionProps:_(f),shouldShowCopyButton:C,shouldShowHandoffButton:y,shouldShowReadAloudButton:v,codePreviewProps:T};return p?{...S,chatMessageHeaderData:(0,h.Ne)(p)}:S}function x(){let e="XLWeb";switch((0,i.vI)()){case Office.PlatformType.PC:e="XLWin32";break;case Office.PlatformType.Mac:e="XLMac";break;case Office.PlatformType.iOS:e="XLiOS"}return`${e}CopilotOCV`}function S(e){const t=r.$.getInstance();let n=JSON.stringify({prompt:t.getLastUserUtterance(),promptId:u.M.userQueryGuid});try{const a=JSON.parse(n??"{}");let o,r;(0,f.yw9)("OfficeVSO_8854181_SimplifyChatHistoryForOCV")&&"Copilot\\Python"===e&&(o=g.CP.pythonContextManager.getPythonAdaContext(),r=g.CP.pythonContextManager.pythonContextBuilder.getPythonPrompt());let i,l={};"Copilot\\Python"===e&&(l=g.CP.pythonContextManager.ocvErrorDetails),(0,f.yw9)("OfficeVSO_9544730_CommunicationHandlerSingleton")&&"Copilot\\Analyze Data"===e&&(i=function(e){const t=Object.entries((0,C.KA)().getState().selection.recommendations).map((([e,t])=>t.map((t=>({...t,tableName:e}))))).flat().filter((t=>t.queryId===e)),n=t.map((e=>{const{visual:t,interpretationId:n}=e;let a;switch(t.visualType){case"ChartVisual":{const{chart:e,visualType:o}=t;a={visualType:o,interpretationId:n,axes:e.axes.length>0?e.axes.map((e=>{const t=e.title?.runs.map((e=>e.text)).join("");return t})):void 0};break}case"PivotChartVisual":case"PivotTableVisual":{const{pivotTable:e,visualType:o}=t;a={visualType:o,interpretationId:n,columnFields:0===e.columnFields.length?void 0:e.columnFields.map((e=>e.name)),rowFields:0===e.rowFields.length?void 0:e.rowFields.map((e=>e.name)),dataFields:0===e.dataFields.length?void 0:e.dataFields.map((e=>e.name)),dateFilters:0===e.dateFilters.length?void 0:e.dateFilters.map((e=>({fieldIndex:e.fieldIndex,fieldType:e.fieldType}))),filterFields:0===e.filterFields.length?void 0:e.filterFields.map((e=>e.name)),valueFilters:0===e.valueFilters.length?void 0:e.valueFilters.map((e=>({labelFieldIndex:e.labelFieldIndex,labelFieldType:e.labelFieldType,dataFieldIndex:e.dataFieldIndex}))),labelFilters:0===e.labelFilters.length?void 0:e.labelFilters.map((e=>({labelFieldIndex:e.labelFieldIndex,labelFieldType:e.labelFieldType}))),axes:"PivotChartVisual"===t.visualType&&t.chart.axes.length>0?t.chart.axes.map((e=>{const t=e.title?.runs.map((e=>e.text)).join("");return t})):void 0};break}case"ForecastVisual":a={visualType:t.visualType,interpretationId:n,data:t.chart.data,series:t.chart.series.map((e=>({title:e.title?.runs.map((e=>e.text)).join(""),dataBindings:e.dataBindings}))),previewFieldHeaders:t.previewTable.fieldHeaders,formulasFieldHeaders:t.formulasTable.fieldHeaders};break;case"QueryResultVisual":a={visualType:t.visualType,interpretationId:n,fieldHeaders:t.result.fieldHeaders.map((e=>e.runs.map((e=>e.text)).join("")))};break;case"QueryChartVisual":{const{result:e,chart:o}=t;a={visualType:t.visualType,interpretationId:n,fieldHeaders:e.fieldHeaders.map((e=>e.runs.map((e=>e.text)).join(""))),axes:o.axes.length>0?o.axes.map((e=>{const t=e.title?.runs.map((e=>e.text)).join("");return t})):void 0};break}case"TextAnalysisVisual":a={visualType:t.visualType,interpretationId:n,columnName:t.textAnalysisResult.columnName};break;default:(0,m.x)(t)}return a})),a=Object.values((0,C.KA)().getState().selection.interpretations).flat(),o=a.filter((e=>t.some((t=>t.interpretationId===e.id)))).map((e=>({id:e.id,headerRowCount:e.table.headerRowCount,headerColumnCount:e.table.headerColumnCount,orientation:e.table.orientation,fields:e.fields?.map((e=>({headerValue:e.headerValue,classification:e.classification})))??"Fields not logged for non-CMF table"})));return n.length>0?{recommendations:n,interpretation:o}:void 0}(a.promptId)),n=JSON.stringify({...a,chatHistory:(0,f.yw9)("OfficeVSO_8854181_SimplifyChatHistoryForOCV")?t.getChatHistory():t.getChatLog(),pythonContext:o,pythonPrompt:r,pythonOCVErrorDetails:l,recommendationsData:i})}catch(e){n="Error while creating CardMetaData"}return n}function w(e="Copilot"){const t=r.$.getInstance();return{feedbackArea:e,contextData:{cardMetaData:S(e),feedbackClientAppName:x(),featureName:(0,c.rI)(e),contextScreenshots:(0,f.yw9)("OfficeVSO_9902661_EnableInputImageInOCV")?(0,p.LQ)(t.getLastUserImage()):void 0}}}const E=e=>{y&&v||(y=d.E.getInstance(),v=u.M.getInstance()),e!==s.h2.None&&e!==s.h2.Unknown&&y&&(u.M.getInstance().logStandardizedAshaErrorEvent(o.W.Responsible_AI_Filter_Blocked_Response,a.c.RAI_Validation_Failed,c.BJ.CopilotChat),y.updateTelemetryChatEventData({[c.h3.ChatEventType]:"RAIOffense",[c.h3.ChatEventParameters]:JSON.stringify({offense:e,groundingMode:(0,c.Q6)()})},v))},I=()=>Office&&"ExtensionLifeCycle"in Office&&"taskpane"in Office.ExtensionLifeCycle;async function R(){(0,b.cY)("Closing Shared Header"),I()&&await Office.ExtensionLifeCycle.taskpane.close()}async function A(){(0,b.cY)("Moving Shared Header"),I()&&await Office.ExtensionLifeCycle.taskpane.move()}async function L(){(0,b.cY)("Shared Header Loaded"),I()&&await Office.ExtensionLifeCycle.taskpane.notifyHeaderLoaded()}function k(){if(!i.iJ.isMacPlatform()&&!i.iJ.isIOSPlatform())return{type:l.y.Close,clickHandler:R}}function F(){if(i.iJ.isWin32Platform()){return{buttons:[{type:l.y.Move,clickHandler:A},{type:l.y.Close,clickHandler:R}]}}}const _=e=>{let t=u.M?.userQueryGuid?{promptId:u.M.userQueryGuid}:void 0;return e&&(t={...t,id:e,name:""}),t}},698013:(e,t,n)=>{"use strict";n.d(t,{p:()=>C});var a=n(11856),o=n(705147),r=n(248967),i=n(790900),l=n(857677),s=n(83437),c=n(1329),d=n(75542),u=n(70239),m=n(75496),g=n(316904),h=n(92520),p=n(347145),b=n(414542),f=n(507628);class C{makeBatchHandler(){return async(e,t)=>{e[7]="FA000000124",this.richApiBatches.push(e);try{this.processor.processRequest(e,a.to.Original)}catch(e){throw(0,h.cY)(String(e)),e}const n=(0,f.A)(),d=(0,p.yw9)("OfficeVSO_10374536_useNewApiBatchSignal")&&"excelAgent"===this.caller,y=(0,p.yw9)("OfficeVSO_10396995_UseVisibleObserverForCharting"),v=d?r.MZ:r.Ix,T=d?i.hM:i.j5;if((0,p.t9T)()&&"excelAgent"===this.caller){const t=new r.MZ({caller:this.caller,requestId:n,dataLocale:this.dataLocale,batch:e,...y&&{useVisibleObserver:!0}});C.sendResponseCallback&&await C.sendResponseCallback(t,!0)}let x,S;try{if((0,p.t9T)()&&"excelAgent"===this.caller){C.currentDeferredPromise=(0,o.p)();const e=setTimeout((()=>{if(C.currentDeferredPromise){const e="Timeout waiting for ExcelScratchpadExecuteRichApiBatchAnnotation response";C.currentDeferredPromise.reject(new Error(e)),g.M.getInstance().logError({eventType:m.S2.ChatEvents,errorMessage:e,logLevel:s.$b.Error}),C.currentDeferredPromise=void 0}}),12e4);let t;({annotation:S,sendResponse:t}=await C.currentDeferredPromise.promise),clearTimeout(e),C.sendResponseCallback=t}else{const t=new u.g0({parentPath:["Signal",v.getTypeName()],items:[{id:c.r.generateId(),body:new v({caller:this.caller,requestId:n,dataLocale:this.dataLocale,batch:e,...y&&{useVisibleObserver:!0}})}]});S=await(0,b.T)(t,n,m.S2.CommandingScratchpad,l.OP.Commanding,T.getTypeName())}const t=JSON.parse(S.result);null!==t.ErrorMessage||200!==t.HttpStatusCode||null===t.Body?((0,h.cY)(t.ErrorMessage),t.ErrorCode&&(0,h.cY)(t.ErrorCode),x={status:Office.AsyncResultStatus.Failed,value:null,error:t.ErrorMessage,asyncContext:null}):(t.Body.Error&&g.M.getInstance().logError({eventType:m.S2.CommandingScratchpad,errorMessage:"Caller: "+this.caller+". Error in response body: "+JSON.stringify(t.Body.Error),logLevel:s.$b.ASHA}),x={status:Office.AsyncResultStatus.Succeeded,value:{data:[t.HttpStatusCode,t.Headers,JSON.stringify(t.Body)]},error:null,asyncContext:null},this.processor.processResponse(x,a.to.Original))}catch(e){x={status:Office.AsyncResultStatus.Failed,value:null,error:e,asyncContext:null},(0,h.cY)(String(e))}t(x)}}getApiCalls(){return this.processor.getApiCallRecords()}async applySingleBatch(e){e[6]&=~d.hl.OnlyAllowMakerSafeApi,await new Promise(((t,n)=>{this.processor.processRequest(e,a.to.Replay),OSF.DDA.RichApi.executeRichApiRequestAsync(e,(e=>{if((0,h.cY)(`Api result:\n${JSON.stringify(e)}`),"failed"===e.status)return this.logApplySingleBatchError("Status failed: ",e),void n(e);try{const o=JSON.parse(e.value.data[2]);if(void 0===o.Results){const e=o.Error||"Unknown error";return this.logApplySingleBatchError("ResponseMessage.Results undefined: ",e),void n(e)}this.processor.processResponse(e,a.to.Replay),t(e)}catch(e){(0,h.cY)(`Couldn't process response: ${e}`),this.logApplySingleBatchError("Couldn't process response: ",e),n(e)}}))}))}logApplySingleBatchError(e,t){g.M.getInstance().logError({eventType:m.S2.CommandingScratchpad,errorMessage:"Apply Single Batch - "+e+JSON.stringify(t),logLevel:s.$b.ASHA})}async applyBatches(){for(const e of this.richApiBatches)await this.applySingleBatch(e)}static resolveAnnotationPromise(e,t){if(!C.currentDeferredPromise){const e="RichApiBatchProcessor.currentDeferredPromise was not created in makeBatchHandler.";throw g.M.getInstance().logError({eventType:m.S2.ChatEvents,errorMessage:e,logLevel:s.$b.Error}),new Error(e)}C.currentDeferredPromise.resolve({annotation:e,sendResponse:t}),C.currentDeferredPromise=void 0}constructor(e,t){this.richApiBatches=[],this.dataLocale=e,this.caller=t;this.processor=a.Ai.create({Chart:{Properties:["Name"]},NamedItem:{Properties:["Name"]},PivotTable:{Properties:["Name","Worksheet/Name"]},Range:{Properties:["Address"]},RangeView:{Properties:["CellAddresses"]},Shape:{Properties:["Name"]},Table:{Properties:["Name","Worksheet/Name"]},TableColumn:{Properties:["Index","Name"]},TableRow:{Properties:["Index"]},Worksheet:{Properties:["Name"]},RangeFont:{Properties:["Name"]}})}}},702864:(e,t,n)=>{"use strict";var a;n.d(t,{aB:()=>a,xP:()=>o}),function(e){e[e.Idle=0]="Idle",e[e.ScopeStarted=1]="ScopeStarted",e[e.HasAction=2]="HasAction",e[e.ShowButton=3]="ShowButton"}(a||(a={}));var o=function(){function e(){this.addinUndoState=a.Idle,this.isAddinFlowActive=!1}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.getCurrentAddinState=function(){return this.addinUndoState},e.prototype.isAddinFlow=function(){return this.isAddinFlowActive},e.prototype.setIsAddinFlow=function(e,t){this.isAddinFlowActive=e,null==t||t()},e.prototype.transitionAddinState=function(e,t){this.addinUndoState!==e&&(this.addinUndoState=e,null==t||t())},e.prototype.checkAndSetIsUndoableActionPresent=function(){this.getCurrentAddinState()===a.ScopeStarted&&this.transitionAddinState(a.HasAction)},e}().getInstance()},705147:(e,t,n)=>{"use strict";n.d(t,{U:()=>o,p:()=>r});class a{constructor(e,t){this.finished=!1,this.reject=e=>{this.finished||(this.rejectFn(e),this.finished=!0)},this.resolve=e=>{this.finished||(this.resolveFn(e),this.finished=!0)},this.resolveFn=e,this.rejectFn=t}}class o{constructor(e){this.getPromise=()=>this.outerPromise,this.getOriginalPromise=()=>this.originalPromise,this.reject=e=>{this.pHolder&&this.pHolder.reject(e)},this.resolve=e=>{this.pHolder&&this.pHolder.resolve(e)},this.outerPromise=new Promise(((e,t)=>{this.pHolder=new a(e,t)})),this.originalPromise=e(),this.originalPromise.then((e=>{this.pHolder&&this.pHolder.resolve(e)})).catch((e=>{this.pHolder&&this.pHolder.reject(e)}))}}function r(){let e=null,t=null;return{promise:new Promise(((n,a)=>{e=n,t=a})),resolve:e,reject:t}}},708817:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(997434),o=n(154836);t.default=function(e){const t=function(e){return Uint8Array.of((15&e[3])<<4|e[4]>>4&15,(15&e[4])<<4|(240&e[5])>>4,(15&e[5])<<4|15&e[6],e[7],(15&e[1])<<4|(240&e[2])>>4,(15&e[2])<<4|(240&e[3])>>4,16|(240&e[0])>>4,(15&e[0])<<4|(240&e[1])>>4,e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}("string"==typeof e?(0,a.default)(e):e);return"string"==typeof e?(0,o.unsafeStringify)(t):t}},710729:(e,t,n)=>{"use strict";n.d(t,{g:()=>g});var a=n(639599),o=n(875100),r=n(279395),i=n(126521),l=n(519272),s=n(575934),c=n(321231),d=n(764080),u=n(342698),m=n(371120);function g(e,t){const n=function(e,t){if(!e||!(0,d.J2)(e.visual))return;const n=e.visual.chart,g=(0,l.ip)(n),h=(e,t)=>("primary"===t?(0,a.lf)(e):(0,a.t7)(e)).filter((e=>(0,m.$)(e.dimension))),p=h(g.primary.insightsType,"primary");g.secondary&&p.push(...h(g.secondary.insightsType,"secondary"));switch(p.length){case 0:default:return;case 1:{const a=(0,o.q)(n,p[0].dimension,"primary");if("PivotChartVisual"!==e.visual.visualType||!t&&1!==e.visual.pivotTable.dataFields.length)return a&&a.languageUnitsValue!==o.YO.None?(0,i.L)((0,r.xKU)(),a.localizedUnitsValue):void 0;{const t=e.visual.pivotTable.dataFields,n=t.length;return t.map(((e,t)=>{const{name:l,dataCalculation:s}=e,d=(0,c.i)(s),u=(0,i.L)((0,r.Gn5)(),d,l),m=a&&a.languageUnitsValue!==o.YO.None?(0,i.L)((0,r.ZQs)(),u,a.localizedUnitsValue):u;return t===n-1?m:(0,i.L)((0,r.cFM)(),m)})).join("")}}case 2:{const e=p.map((e=>{const t=(0,o.q)(n,e.dimension,e.axisGroup);if(!t)return null;const i=function(e,t){const n=(e.axes||[]).find((e=>e.dimensionType===t.dimension&&e.axisGroup===t.axisGroup));if(n){const e=n.title?(0,s.HW)(n.title):null;if(e)return e}const o=(0,u.tJ)(e.series);switch(t.orientation){case a.UQ.Horizontal:return o?"primary"===t.axisGroup?(0,r.KdV)():(0,r.W9h)():(0,r.tdb)();case a.UQ.Vertical:return o?"primary"===t.axisGroup?(0,r.$98)():(0,r.JuZ)():(0,r.kfS)();default:throw new Error("Invalid orientation")}}(n,e);return{units:t.localizedUnitsValue,name:i}})).filter((e=>!!e));if(0===e.length)return;if(1===e.length)return(0,i.L)((0,r.ZQs)(),e[0].name,e[0].units);if(2===e.length&&e[0].units===e[1].units)return(0,i.L)((0,r.xKU)(),e[0].units);if(2===e.length)return(0,i.L)((0,r.iMG)(),e[0].name,e[0].units,e[1].name,e[1].units);throw new Error("Invalid number of descriptors.")}}}(e,t);return n?(0,r.kK2)(n):n}},713441:(e,t,n)=>{"use strict";n.d(t,{$:()=>a});const a={Enabled:0,DisabledNewWorkbook:1,DisabledAutoSaveOff:2,DisabledSharedLock:4,DisabledLocalFile:8,DisabledPrerequisitesPending:16,DisabledAugLoopPending:32,DisabledUnsupportedLocale:64,DisabledUserChanged:128,DisabledVisibility:256,DisabledUnknownPrerequisite:512,DisabledAugLoopPermanentError:1024,DisabledUploadNotAllowedForClp:2048,DisabledDialogSheetExists:4096,DisabledThirdPartyHost:8192,Deprecated_DisabledUserContentServicesDisabled:16384,DisabledNoLicensingForTenant:32768}},715227:(e,t,n)=>{"use strict";n.d(t,{lA:()=>a,zJ:()=>l});var a,o=n(650444);function r(e,t){return{x:e.x+t.x,y:e.y+t.y}}function i(e,{maxWidthBeforeOverflow:t=Number.POSITIVE_INFINITY,padding:n={x:0,y:0},startVector:a={x:0,y:0}}={}){const o=function(e,t,n={x:0,y:0},a={x:0,y:0}){const o=[],i={x:0,y:0},l=t;let s=0,c=0,d=0;const u=(e,t)=>{o.push({...e,position:r({x:s,y:c},a)}),d=Math.max(d,t.y),i.x=Math.max(i.x,s+t.x),i.y=Math.max(i.y,c+t.y),s+=t.x},m=()=>{c+=d,d=0,s=0};for(let a=0;a<e.length;++a){const o=e[a],i=r(o.dim,n);i.x>t?(0!==s&&m(),u(o,i)):i.x>l-s?(m(),--a):i.x===l-s?(u(o,i),m()):u(o,i)}return{placements:o,bbox:i}}(e,t,n,a),i={};return o.placements.forEach((e=>{i[e.id]=e})),{result:i,bbox:o.bbox}}function l(e,t){const n={x:1,y:1},a={x:0,y:0},l=e=>{if(e.pivotTableData&&e.pivotTableData.length>0){const t=(e.subTotalRowIndices?.length??0)>0?1:0,n=(e.filterFields.length>0?e.filterFields.length+1:0)+(e.grandTotalRowIndex?0:1)+(e.subTotalRowIndices?.length??0);return{x:e.pivotTableData.length+t,y:e.pivotTableData[0].length+n}}return{x:4,y:10}},s=[],c=[];e.forEach((e=>{switch(e.visual.visualType){case"ChartVisual":{const t={x:5,y:14};s.push({position:a,dim:t,id:e.id});break}case"PivotTableVisual":{const t=l(e.visual.pivotTable);c.push({position:a,dim:t,id:e.id});break}case"PivotChartVisual":{const t=l(e.visual.pivotTable),n={x:5,y:14};s.push({position:a,dim:n,id:e.id}),c.push({position:a,dim:t,id:e.id});break}case"QueryResultVisual":case"QueryChartVisual":case"ForecastVisual":case"TextAnalysisVisual":throw new Error(`insertAllRecommendations: Unsupported visualType=${e.visual.visualType}`);default:(0,o.x)(e.visual)}}));const d={x:2,y:2},u=i(s,{maxWidthBeforeOverflow:t,padding:n,startVector:d}),m=r(d,{y:u.bbox.y+5,x:0}),g=i(c,{padding:n,startVector:m}),h={};return e.forEach((e=>{const t=u.result[e.id],n=g.result[e.id];h[e.id]={chart:t,pivotTable:n}})),{layoutPlacementsById:h,mainDataLocation:{startRow:d.y,startColumn:d.x,rowCount:u.bbox.y,columnCount:u.bbox.x},supportingDataLocation:{startRow:m.y,startColumn:m.x,rowCount:g.bbox.y,columnCount:g.bbox.x}}}!function(e){e[e.none=0]="none",e[e.unknown=1]="unknown",e[e.findInterpretation=2]="findInterpretation",e[e.preFormatDashboardSheet=3]="preFormatDashboardSheet",e[e.insertRecommendations=4]="insertRecommendations",e[e.convertingDashboardArgs=5]="convertingDashboardArgs",e[e.insertPivotTables=6]="insertPivotTables",e[e.insertCharts=7]="insertCharts",e[e.insertPivotCharts=8]="insertPivotCharts",e[e.postFormatDashboardSheet=9]="postFormatDashboardSheet"}(a||(a={}))},715834:(e,t,n)=>{"use strict";n.d(t,{or:()=>c,U:()=>l,Y:()=>s});var a=n(543435),o=n(324482),r=n(775568);function i(e){return new Promise((t=>setTimeout(t,e)))}async function l(e,t,n,o=3,l,s=!1,c=0,d){let u,m;do{o--;try{if(d?.signal.aborted){const e=new Error;throw e.name=a.UW.AbortError,e}const n=await e(l);if(m=n,t(n,l))return n}catch(e){if(u=e,n(e,l))throw e;if(e instanceof r.H)throw e}if(c>0){if(d?.signal.aborted){const e=new Error;throw e.name=a.UW.AbortError,e}await i(c)}}while(o>0);if(s&&m)return m;throw u}async function s(e,t){let n;const a=new Promise(((e,t)=>{n=new o.c(e,t)}));return e().then(n.resolve).catch(n.reject),i(t).catch(n.reject),a}function c(...e){return function(e,...t){return t.reduce(((t,n)=>e(t,n)))}(((e,t)=>n=>e(n)||t(n)),...e)}},719733:(e,t,n)=>{"use strict";n.d(t,{MH:()=>a,Ml:()=>o,Tq:()=>c,uS:()=>d});const a="synchronous";function o(e){if(e){const t=e.storageScript.apiInfo;if(t){return JSON.parse(t)}}}const r=1,i=1,l=2;function s(e){if(e){const{variantVersion:n}=e;if(void 0!==n&&"number"==typeof(t=n)&&Number.isInteger(t)&&t>=0)return n}var t;return 0}async function c(e){const t=s(e);return{enableNoImplicitAny:t>=r,enableNoIdentifiersPassedToArrayMethodCallbacks:t>=i,enableNoImplicitAnyAssignment:t>=l}}async function d(e){return c(o(e))}},721794:(e,t,n)=>{"use strict";n.d(t,{e:()=>m,n:()=>u});var a=n(12855),o=n(857677),r=n(650444),i=n(109174),l=n(347145),s=n(808943),c=n(910480);const d=["Commanding_TellMe","MorePrompts","GiveMeMorePrompts","SydneySuggestion","ImportDataFromFile","Tlr_ExplainHeaders","Tlr_ExplainTables","Tlr_ExplainUnmergingCells","Python_Suggestion_FromSkittle"];function u(e,t=!1,n=()=>{},o,r){const u=r?.tableLikeRangeFeatures&&r.tableLikeRangeFeatures&a.ye.All,m=(0,l.tgf)()&&u;if(o||m){if(!i.CP.pythonContextManager.isPythonMode)if("CHART_SELECTED"===o||"PIVOT_TABLE_SELECTED"===o)e=[],t=!1;else{if("BLANK_WORKSHEET"===o&&(0,l.vIj)()){e.every((e=>"SydneySuggestion"===e.suggestionType))&&(t=!1)}e=e.filter((e=>d.includes(e.suggestionType)))}}else if(!u&&(0,l.yw9)("OfficeVSO_9413795_updateUnsupportedTLRSuggestionPills")){const t=["Tlr_ExplainHeaders","Tlr_ExplainTables","Tlr_ExplainUnmergingCells"];e=e.filter((e=>!t.includes(e.suggestionType)))}const g={onRefreshButtonClicked:n,suggestionList:e.map((e=>e.suggestionText)),showRefreshButton:t};return(0,c.isEqual)(g.suggestionList,(0,s.jc)().suggestionList)&&g.showRefreshButton===(0,s.jc)().showRefreshButton?(0,s.jc)():((0,s.j0)(g),g)}function m(e){switch(e){case"AnalyzeData_InsertAll":case"AnalyzeData_InsertAllCharts":case"AnalyzeData_ShowMore":case"AnalyzeData_SpecificSuggestion":case"AnalyzeData_Suggestion":case"AnalyzeData_ShowCharts":case"AnalyzeData_ShowMoreCharts":case"AnalyzeData_ShowPivotTables":case"AnalyzeData_ShowMorePivotTables":case"AnalyzeData_RelatedQuestions":return o.q.AnalyzeData;case"CalculatedColumns_GeneralSuggestion":case"CalculatedColumns_ShowMore":case"CalculatedColumns_SpecificSuggestion":return o.q.CalculatedColumns;case"CalculatedCell_Suggestion":return o.q.CalculatedRows;case"Commanding_Suggestion":case"Commanding_TellMe":return o.q.Commanding;case"ConditionalFormat_Suggestion":return(0,l.yw9)("OfficeVSO_9564930_SplitCommandingTelemetry")?o.q.ConditionalFormatting:o.q.Commanding;case"Python_Suggestion":case"Python_Suggestion_FromAnalyzeData":case"Python_Suggestion_FromRefreshList":case"Python_Suggestion_FromSkittle":return o.q.Python;case"Tlr_ExplainTables":case"Tlr_ExplainHeaders":case"Tlr_ExplainUnmergingCells":return o.q.ContextInference;case"GiveMeMorePrompts":case"ImportDataFromFile":case"MorePrompts":case"SydneySuggestion":case"TryAgain":return;default:(0,r.x)(e)}}},731137:e=>{"use strict";e.exports=JSON.parse('{"Intents":{"AllowEditRangeAddedLabel":"Add unlocked range ${range}","_AllowEditRangeAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot. The $ and range variable/placeholder is replaced by the name of the range","AllowEditRangeDeletedLabel":"I deleted the unlocked range ${range}","_AllowEditRangeDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot. The $ and range variable/placeholder is replaced by the name of the range","AllowEditRangeEditedLabel":"I edited the unlocked range ${range}","_AllowEditRangeEditedLabel.comment":"User-facing string describing the Excel event executed by Copilot. The $ and range variable/placeholder is replaced by the name of the range","ArtPasteSameWorkbookLabel":"Paste art on sheet ${sheet}","_ArtPasteSameWorkbookLabel.comment":"Text to show in a list when a paste art on same workbook user action was taken during script recording","CellFindContainingLabel":"Find cell containing \'${search}\'","_CellFindContainingLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.","ChartFormatSetGetPropertiesLabel":"${count} format changes were applied to ${chartName}.","_ChartFormatSetGetPropertiesLabel.comment":"The intent shown when two or more chart formats were changed in a batch request.","ChartSeriesDeleteLabel":"I deleted the series ${seriesIndex} from chart ${chartName} on sheet ${sheet}","_ChartSeriesDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ChartSeriesDataChangedLabel":"I changed the data of series ${seriesIndex} of chart ${chartName}","ChartSeriesDataChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","CommentDeleteLabel":"I deleted the comment","_CommentDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.","CommentDeleteReplyLabel":"I deleted the reply","_CommentDeleteReplyLabel.comment":"User-facing string describing the Excel event executed by Copilot.","CommentEditLabel":"I edited the comment","_CommentEditLabel.comment":"User-facing string describing the Excel event executed by Copilot.","CommentEditReplyLabel":"I edited the reply","_CommentEditReplyLabel.comment":"User-facing string describing the Excel event executed by Copilot.","CommentInsertLabel":"I inserted a comment","_CommentInsertLabel.comment":"User-facing string describing the Excel event executed by Copilot.","CommentInsertReplyLabel":"I inserted a reply","_CommentInsertReplyLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} ${range} where ${cellValueCriteria}.","_ConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} ${tableName} where ${cellValueCriteria}.","_TableRangeConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} ${tableName} body where ${cellValueCriteria}.","_TableBodyRangeConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} ${tableName} header row where ${cellValueCriteria}.","_TableHeaderRowRangeConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} ${tableName} total row where ${cellValueCriteria}.","_TableTotalRowRangeConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} sub-range of table ${tableName} where ${cellValueCriteria}.","_TableGeneralRangeConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} ${count} row(s) in table ${tableName} where ${cellValueCriteria}.","_TableRowsRangeConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} row at index ${rowIndex} in table ${tableName} where ${cellValueCriteria}.","TableRowByIndexRangeConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} ${count} column(s) in table ${tableName} where ${cellValueCriteria}.","_TableColumnsRangeConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} column \'${columnName}\' in table ${tableName} where ${cellValueCriteria}.","_TableColumnByNameRangeConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} the column at index ${columnIndex} in table ${tableName} where ${cellValueCriteria}.","_TableColumnByIndexRangeConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} the column(s) \'${columnName}\' where ${cellValueCriteria}.","_ColumnNameConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} ${range} with formula ${customFormula}.","_ConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} ${tableName} with formula ${customFormula}.","_TableRangeConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} ${tableName} body with formula ${customFormula}.","_TableBodyRangeConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} ${tableName} header row with formula ${customFormula}.","_TableHeaderRowRangeConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} ${tableName} total row with formula ${customFormula}.","_TableTotalRowRangeConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} sub-range of table ${tableName} with formula ${customFormula}.","_TableGeneralRangeConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} ${count} row(s) in table ${tableName} with formula ${customFormula}.","_TableRowsRangeConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} row at index ${rowIndex} in table ${tableName} with formula ${customFormula}.","TableRowByIndexRangeConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} ${count} column(s) in table ${tableName} with formula ${customFormula}.","_TableColumnsRangeConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} column \'${columnName}\' in table ${tableName} with formula ${customFormula}.","_TableColumnByNameRangeConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} the column at index ${columnIndex} in table ${tableName} with formula ${customFormula}.","_TableColumnByIndexRangeConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} the column(s) \'${columnName}\' with formula ${customFormula}.","_ColumnNameConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in ${range} that ${textComparisonCriteria}.","_ConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in ${tableName} that ${textComparisonCriteria}.","_TableRangeConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in ${tableName} body that ${textComparisonCriteria}.","_TableBodyRangeConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in ${tableName} header row that ${textComparisonCriteria}.","_TableHeaderRowRangeConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in ${tableName} total row that ${textComparisonCriteria}.","_TableTotalRowRangeConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in sub-range of table ${tableName} that ${textComparisonCriteria}.","_TableGeneralRangeConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in ${count} row(s) in table ${tableName} that ${textComparisonCriteria}.","_TableRowsRangeConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in row at index ${rowIndex} in table ${tableName} that ${textComparisonCriteria}.","TableRowByIndexRangeConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in ${count} column(s) in table ${tableName} that ${textComparisonCriteria}.","_TableColumnsRangeConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in column \'${columnName}\' in table ${tableName} that ${textComparisonCriteria}.","_TableColumnByNameRangeConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in the column at index ${columnIndex} in table ${tableName} that ${textComparisonCriteria}.","_TableColumnByIndexRangeConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in the column(s) \'${columnName}\' that ${textComparisonCriteria}.","_ColumnConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ConditionalFormattingColorScaleCustomCreatedLabel":"I created a ${colorScaleFormat} color scale conditional formatting rule on ${range}.","_ConditionalFormattingColorScaleCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingColorScaleCustomCreatedLabel":"I created a ${colorScaleFormat} color scale conditional formatting rule on ${tableName}.","_TableRangeConditionalFormattingColorScaleCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingColorScaleCustomCreatedLabel":"I created a ${colorScaleFormat} color scale conditional formatting rule on ${tableName} body.","_TableBodyRangeConditionalFormattingColorScaleCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingColorScaleCustomCreatedLabel":"I created a ${colorScaleFormat} color scale conditional formatting rule on ${tableName} header row.","_TableHeaderRowRangeConditionalFormattingColorScaleCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingColorScaleCustomCreatedLabel":"I created a ${colorScaleFormat} color scale conditional formatting rule on ${tableName} total row.","_TableTotalRowRangeConditionalFormattingColorScaleCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingColorScaleCustomCreatedLabel":"I created a ${colorScaleFormat} color scale conditional formatting rule on sub-range of table ${tableName}.","_TableGeneralRangeConditionalFormattingColorScaleCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingColorScaleCustomCreatedLabel":"I created a ${colorScaleFormat} color scale conditional formatting rule on ${count} row(s) in table ${tableName}.","_TableRowsRangeConditionalFormattingColorScaleCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingColorScaleCustomCreatedLabel":"I created a ${colorScaleFormat} color scale conditional formatting rule on row at index ${rowIndex} in table ${tableName}.","TableRowByIndexRangeConditionalFormattingColorScaleCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingColorScaleCustomCreatedLabel":"I created a ${colorScaleFormat} color scale conditional formatting rule on ${count} column(s) in table ${tableName}.","_TableColumnsRangeConditionalFormattingColorScaleCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingColorScaleCustomCreatedLabel":"I created a ${colorScaleFormat} color scale conditional formatting rule on column \'${columnName}\' in table ${tableName}.","_TableColumnByNameRangeConditionalFormattingColorScaleCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingColorScaleCustomCreatedLabel":"I created a ${colorScaleFormat} color scale conditional formatting rule on the column at index ${columnIndex} in table ${tableName}.","_TableColumnByIndexRangeConditionalFormattingColorScaleCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ConditionalFormattingDataBarCustomCreatedLabel":"I created a data bar conditional formatting rule with ${dataBarFormat} on ${range}.","_ConditionalFormattingDataBarCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingDataBarCustomCreatedLabel":"I created a data bar conditional formatting rule with ${dataBarFormat} on ${tableName}.","_TableRangeConditionalFormattingDataBarCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingDataBarCustomCreatedLabel":"I created a data bar conditional formatting rule with ${dataBarFormat} on ${tableName} body.","_TableBodyRangeConditionalFormattingDataBarCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingDataBarCustomCreatedLabel":"I created a data bar conditional formatting rule with ${dataBarFormat} on ${tableName} header row.","_TableHeaderRowRangeConditionalFormattingDataBarCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingDataBarCustomCreatedLabel":"I created a data bar conditional formatting rule with ${dataBarFormat} on ${tableName} total row.","_TableTotalRowRangeConditionalFormattingDataBarCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingDataBarCustomCreatedLabel":"I created a data bar conditional formatting rule with ${dataBarFormat} on sub-range of table ${tableName}.","_TableGeneralRangeConditionalFormattingDataBarCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingDataBarCustomCreatedLabel":"I created a data bar conditional formatting rule with ${dataBarFormat} on ${count} row(s) in table ${tableName}.","_TableRowsRangeConditionalFormattingDataBarCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingDataBarCustomCreatedLabel":"I created a data bar conditional formatting rule with ${dataBarFormat} on row at index ${rowIndex} in table ${tableName}.","TableRowByIndexRangeConditionalFormattingDataBarCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingDataBarCustomCreatedLabel":"I created a data bar conditional formatting rule with ${dataBarFormat} on ${count} column(s) in table ${tableName}.","_TableColumnsRangeConditionalFormattingDataBarCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingDataBarCustomCreatedLabel":"I created a data bar conditional formatting rule with ${dataBarFormat} on column \'${columnName}\' in table ${tableName}.","_TableColumnByNameRangeConditionalFormattingDataBarCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingDataBarCustomCreatedLabel":"I created a data bar conditional formatting rule with ${dataBarFormat} on the column at index ${columnIndex} in table ${tableName}.","_TableColumnByIndexRangeConditionalFormattingDataBarCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ConditionalFormattingIconSetCreatedLabel":"I created an icon set conditional formatting rule using ${iconSet} on ${range}.","_ConditionalFormattingIconSetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingIconSetCreatedLabel":"I created an icon set conditional formatting rule using ${iconSet} on ${tableName}.","_TableRangeConditionalFormattingIconSetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingIconSetCreatedLabel":"I created an icon set conditional formatting rule using ${iconSet} on ${tableName} body.","_TableBodyRangeConditionalFormattingIconSetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingIconSetCreatedLabel":"I created an icon set conditional formatting rule using ${iconSet} on ${tableName} header row.","_TableHeaderRowRangeConditionalFormattingIconSetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingIconSetCreatedLabel":"I created an icon set conditional formatting rule using ${iconSet} on ${tableName} total row.","_TableTotalRowRangeConditionalFormattingIconSetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingIconSetCreatedLabel":"I created an icon set conditional formatting rule using ${iconSet} on sub-range of table ${tableName}.","_TableGeneralRangeConditionalFormattingIconSetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingIconSetCreatedLabel":"I created an icon set conditional formatting rule using ${iconSet} on ${count} row(s) in table ${tableName}.","_TableRowsRangeConditionalFormattingIconSetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingIconSetCreatedLabel":"I created an icon set conditional formatting rule using ${iconSet} on row at index ${rowIndex} in table ${tableName}.","TableRowByIndexRangeConditionalFormattingIconSetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingIconSetCreatedLabel":"I created an icon set conditional formatting rule using ${iconSet} on ${count} column(s) in table ${tableName}.","_TableColumnsRangeConditionalFormattingIconSetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingIconSetCreatedLabel":"I created an icon set conditional formatting rule using ${iconSet} on column \'${columnName}\' in table ${tableName}.","_TableColumnByNameRangeConditionalFormattingIconSetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingIconSetCreatedLabel":"I created an icon set conditional formatting rule using ${iconSet} on the column at index ${columnIndex} in table ${tableName}.","_TableColumnByIndexRangeConditionalFormattingIconSetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in ${range}.","_ConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in ${tableName}.","_TableRangeConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in ${tableName} body.","_TableBodyRangeConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in ${tableName} header row.","_TableHeaderRowRangeConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in ${tableName} total row.","_TableTotalRowRangeConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in sub-range of table ${tableName}.","_TableGeneralRangeConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in ${count} row(s) in table ${tableName}.","_TableRowsRangeConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in row at index ${rowIndex} in table ${tableName}.","TableRowByIndexRangeConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in ${count} column(s) in table ${tableName}.","_TableColumnsRangeConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in column \'${columnName}\' in table ${tableName}.","_TableColumnByNameRangeConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in the column at index ${columnIndex} in table ${tableName}.","_TableColumnByIndexRangeConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in the column(s) \'${columnName}\'.","_ColumnNameConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in ${range}.","_ConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in ${tableName}.","_TableRangeConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in ${tableName} body.","_TableBodyRangeConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in ${tableName} header row.","_TableHeaderRowRangeConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in ${tableName} total row.","_TableTotalRowRangeConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in sub-range of table ${tableName}.","_TableGeneralRangeConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in ${count} row(s) in table ${tableName}.","_TableRowsRangeConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in row at index ${rowIndex} in table ${tableName}.","TableRowByIndexRangeConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in ${count} column(s) in table ${tableName}.","_TableColumnsRangeConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in column \'${columnName}\' in table ${tableName}.","_TableColumnByNameRangeConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in the column at index ${columnIndex} in table ${tableName}.","_TableColumnByIndexRangeConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in the column(s) \'${columnName}\'.","_ColumnNameConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in ${range}.","_ConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in ${tableName}.","_TableRangeConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in ${tableName} body.","_TableBodyRangeConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in ${tableName} header row.","_TableHeaderRowRangeConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in ${tableName} total row.","_TableTotalRowRangeConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in sub-range of table ${tableName}.","_TableGeneralRangeConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in ${count} row(s) in table ${tableName}.","_TableRowsRangeConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in row at index ${rowIndex} in table ${tableName}.","TableRowByIndexRangeConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in ${count} column(s) in table ${tableName}.","_TableColumnsRangeConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in column \'${columnName}\' in table ${tableName}.","_TableColumnByNameRangeConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in the column at index ${columnIndex} in table ${tableName}.","_TableColumnByIndexRangeConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in the column(s) \'${columnName}\'.","_ColumnNameConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} ${range} for values that are ${presetCriterion}.","_ConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} ${tableName} for values that are ${presetCriterion}.","_TableRangeConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} ${tableName} body for values that are ${presetCriterion}.","_TableBodyRangeConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} ${tableName} header row for values that are ${presetCriterion}.","_TableHeaderRowRangeConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} ${tableName} total row for values that are ${presetCriterion}.","_TableTotalRowRangeConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} sub-range of table ${tableName} for values that are ${presetCriterion}.","_TableGeneralRangeConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} ${count} row(s) in table ${tableName} for values that are ${presetCriterion}.","_TableRowsRangeConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} row at index ${rowIndex} in table ${tableName} for values that are ${presetCriterion}.","TableRowByIndexRangeConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} ${count} column(s) in table ${tableName}. for values that are ${presetCriterion}","_TableColumnsRangeConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} column \'${columnName}\' in table ${tableName} for values that are ${presetCriterion}.","_TableColumnByNameRangeConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} the column at index ${columnIndex} in table ${tableName} for values that are ${presetCriterion}.","_TableColumnByIndexRangeConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} the column(s) \'${columnName}\' for values that are ${presetCriterion}.","_ColumnNameConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ConditionalFormattingCreatedGroupEventLabel":"I created a conditional formatting rule on ${range}","_ConditionalFormattingCreatedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingCreatedGroupEventLabel":"I created a conditional formatting rule on ${tableName}","_TableRangeConditionalFormattingCreatedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingCreatedGroupEventLabel":"I created a conditional formatting rule on ${tableName} body","_TableBodyRangeConditionalFormattingCreatedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingCreatedGroupEventLabel":"I created a conditional formatting rule on ${tableName} header row","_TableHeaderRowRangeConditionalFormattingCreatedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingCreatedGroupEventLabel":"I created a conditional formatting rule on ${tableName} total row","_TableTotalRowRangeConditionalFormattingCreatedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingCreatedGroupEventLabel":"I created a conditional formatting rule on sub-range of table ${tableName}","_TableGeneralRangeConditionalFormattingCreatedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingCreatedGroupEventLabel":"I created a conditional formatting rule on ${count} row(s) in table ${tableName}","_TableRowsRangeConditionalFormattingCreatedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingCreatedGroupEventLabel":"I created a conditional formatting rule on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeConditionalFormattingCreatedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingCreatedGroupEventLabel":"I created a conditional formatting rule on ${count} column(s) in table ${tableName}","_TableColumnsRangeConditionalFormattingCreatedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingCreatedGroupEventLabel":"I created a conditional formatting rule on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeConditionalFormattingCreatedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingCreatedGroupEventLabel":"I created a conditional formatting rule on the column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeConditionalFormattingCreatedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ConditionalFormattingCreatedGroupTypeEventLabel":"I created a ${type} conditional formatting rule on ${range}","_ConditionalFormattingCreatedGroupTypeEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ConditionalFormattingEditedGroupEventLabel":"I edited the conditional formatting on sheet ${sheet}","_ConditionalFormattingEditedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ConditionalFormattingRuleDeletedLabel":"I cleared the conditional formatting rule on ${range}","_ConditionalFormattingRuleDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ConditionalFormattingDeletedLabel":"I cleared all conditional formatting rules on ${range}","_ConditionalFormattingDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingDeletedLabel":"I cleared all conditional formatting rules on ${tableName}.","_TableRangeConditionalFormattingDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingDeletedLabel":"I cleared all conditional formatting rules on ${tableName} body.","_TableBodyRangeConditionalFormattingDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingDeletedLabel":"I cleared all conditional formatting rules on ${tableName} header row.","_TableHeaderRowRangeConditionalFormattingDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingDeletedLabel":"I cleared all conditional formatting rules on ${tableName} total row.","_TableTotalRowRangeConditionalFormattingDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingDeletedLabel":"I cleared all conditional formatting rules on sub-range of table ${tableName}.","_TableGeneralRangeConditionalFormattingDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingDeletedLabel":"I cleared all conditional formatting rules on ${count} row(s) in table ${tableName}.","_TableRowsRangeConditionalFormattingDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingDeletedLabel":"I cleared all conditional formatting rules on row at index ${rowIndex} in table ${tableName}.","TableRowByIndexRangeConditionalFormattingDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingDeletedLabel":"I cleared all conditional formatting rules on ${count} column(s) in table ${tableName}.","_TableColumnsRangeConditionalFormattingDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingDeletedLabel":"I cleared all conditional formatting rules on column \'${columnName}\' in table ${tableName}.","_TableColumnByNameRangeConditionalFormattingDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingDeletedLabel":"I cleared all conditional formatting rules on the column at index ${columnIndex} in table ${tableName}.","_TableColumnByIndexRangeConditionalFormattingDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","CreateNamedItem":"I created a named item","_CreateNamedItem.comment":"User-facing string describing the Excel event executed by Copilot.","SetNamedItem":"I set the named item","_SetNamedItem.comment":"User-facing string describing the Excel event executed by Copilot.","DeleteNamedItem":"I deleted the named item","_DeleteNamedItem.comment":"User-facing string describing the Excel event executed by Copilot.","ErrorAliasInfo":"This object\'s actions cannot be recorded right now. Try restarting the recorder and execute the action again.","_ErrorAliasInfo.comment":"User-facing string describing an error that occurs when a user creates an object during a recording session that we don\'t understand.","ErrorUnknown":"Oops! An unexpected error occurred while recording this action. Try restarting the recorder and execute the action again.","_ErrorUnknown.comment":"User-facing string describing an error case we don\'t know about.","ExternalLinksRefreshedLabel":"Refresh a linked Workbook","_ExternalLinksRefreshedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ExternalLinksRefreshedAllLabel":"Refresh all linked workbooks","_ExternalLinksRefreshedAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ExternalLinksBrokeLinkLabel":"Break a linked workbook","_ExternalLinksBrokeLinkLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ExternalLinksBrokeAllLinksLabel":"Break all linked workbooks","_ExternalLinksBrokeAllLinksLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ExternalLinksSetAutoRefreshLabel":"I set the auto refresh for workbook links","_ExternalLinksSetAutoRefreshLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ExternalLinksChangedSourceLabel":"I changed the source for a linked workbook","_ExternalLinksChangedSourceLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PageLayoutAddedToPrintAreaLabel":"Added to print area label in page setup","_PageLayoutAddedToPrintAreaLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PageLayoutOrientationChangedLabel":"I changed the page setup orientation","_PageLayoutOrientationChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PageLayoutPageBreakInsertedLabel":"I inserted a page break in page setup","_PageLayoutPageBreakInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PageLayoutPageBreakRemovedLabel":"I removed the page break in page setup","_PageLayoutPageBreakRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PageLayoutPageBreaksAllResetLabel":"Reset all page breaks in page setup","_PageLayoutPageBreaksAllResetLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PageLayoutPaperSizeChangedLabel":"I changed the page setup paper size","_PageLayoutPaperSizeChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PageLayoutPrintAreaClearedLabel":"I cleared the page setup print area","_PageLayoutPrintAreaClearedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PageLayoutPrintAreaSetLabel":"I set the page setup print area","_PageLayoutPrintAreaSetLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PageLayoutPrintSettingsChangedLabel":"I changed the page setup print setting","_PageLayoutPrintSettingsChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PageLayoutScalingChangedLabel":"I changed the page setup scaling","_PageLayoutScalingChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","InProgressEventLabel":"This action is coming soon","_InProgressEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PictureInsertedEventLabel":"I inserted a picture on sheet ${sheet}","_PictureInsertedEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PivotChartCreateLabel":"I created a pivot chart","_PivotChartCreateLabel.comment":"Text to show in a list when a create pivot chart user action was taken during script recording","PivotTableCreateLabel":"I created a pivot table","_PivotTableCreateLabel.comment":"Text to show in a list when a create pivot table user action was taken during script recording","PivotTableSortLabel":"I sorted the  pivot table","_PivotTableSortLabel.comment":"Text to show in a list when a create pivot table user action was taken during script recording","PivotTableChangePositionLabel":"I changed the pivot table position","_PivotTableChangePositionLabel.comment":"Text to show in a list when a create pivot table user action was taken during script recording","PivotTableRefreshLabel":"Refresh pivot table ${pivotName}","_PivotTableRefreshLabel.comment":"Text to show in a list when a refresh pivot table user action was taken during script recording","PivotDrillExpandedLabel":"Expanded pivot item ${pivotItem} for pivot table ${pivotName}","_PivotDrillExpandedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and pivotItem variable/placeholder is replaced by the name of the item being expanded.  The $ and pivotName variable/placeholder is replaced by the name of the pivot table.","PivotDrillCollapsedLabel":"Collapse pivot item ${pivotItem} for pivot table ${pivotName}","_PivotDrillCollapsedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and pivotItem variable/placeholder is replaced by the name of the item being collapsed.  The $ and pivotName variable/placeholder is replaced by the name of the pivot table.","PivotTableRenamedLabel":"Rename pivot table to ${newName}","_PivotTableRenamedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and newName variable/placeholder is replaced by the new name of the pivot table.","PivotTableRowGrandTotalShownLabel":"Show row grand totals for pivot table ${pivotName}","_PivotTableRowGrandTotalShownLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and pivotName variable/placeholder is replaced by the name of the pivot table.","PivotTableRowGrandTotalHiddenLabel":"I hid the row grand totals for pivot table ${pivotName}","_PivotTableRowGrandTotalHiddenLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and pivotName variable/placeholder is replaced by the name of the pivot table.","PivotTableColumnGrandTotalShownLabel":"Show column grand totals for pivot table ${pivotName}","_PivotTableColumnGrandTotalShownLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and pivotName variable/placeholder is replaced by the name of the pivot table.","PivotTableColumnGrandTotalHiddenLabel":"I hid the column(s) grand totals for pivot table ${pivotName}","_PivotTableColumnGrandTotalHiddenLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and pivotName variable/placeholder is replaced by the name of the pivot table.","PivotTableAutoFitColumnWidthsOnRefreshToggledLabel":"I set the auto-fit of column widths for pivot table ${pivotName} to ${value}","_PivotTableAutoFitColumnWidthsOnRefreshToggledLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and pivotName variable/placeholder is replaced by the name of the pivot table.  The $ and value variable/placeholder is replaced by true or false","PivotTableSubTotalsVisibilitySettingSetLabel":"Visibility of subtotals changed for pivot table ${pivotName}","_PivotTableSubTotalsVisibilitySettingSetLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and pivotName variable/placeholder is replaced by the name of the pivot table.","PivotTableLayoutTypeSetLabel":"Layout type of pivot table ${pivotName} changed","_PivotTableLayoutTypeSetLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and pivotName variable/placeholder is replaced by the name of the pivot table.","PivotTableChangeLabel":"I changed the fields for pivot table ${pivotName}","_PivotTableChangeLabel.comment":"Text to show in a list when a change pivot table user action was taken during script recording","PivotTableAddPivot":"Added pivot for pivot table ${pivotName}","_PivotTableAddPivot.comment":"Text to show in a list when a add pivot to pivot table user action was taken during script recording. The $ and pivotName variable/placeholder is replaced by the name of the pivot table.","PivotTableRemovePivot":"I removed the pivot for pivot table ${pivotName}","_PivotTableRemovePivot.comment":"Text to show in a list when a add pivot to pivot table user action was taken during script recording. The $ and pivotName variable/placeholder is replaced by the name of the pivot table.","RangeAutoSumLabel":"I applied autosum to ${range}","_RangeAutoSumLabel.comment":"Text to show in a list when a range autosum user action was taken during script recording","RangeApplyBorderLabel":"I changed the border on ${range}","_RangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameApplyBorderLabel":"I changed the border on the column(s) \'${columnName}\'","_ColumnNameApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","SheetProtectionProtectedLabel":"Protect sheet ${sheet}","_SheetProtectionProtected.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet.","SheetProtectionUnprotectedLabel":"Unprotect sheet ${sheet}","_SheetProtectionUnprotected.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet.","SheetProtectionPasswordUpdatedLabel":"Update sheet password on sheet ${sheet}","_SheetProtectionPasswordUpdated.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet.","SheetProtectionOptionsUpdatedLabel":"Update sheet protection option on sheet ${sheet}","_SheetProtectionOptionsUpdated.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet.","SheetProtectionPausedLabel":"Pause protection on sheet ${sheet}","_SheetProtectionPaused.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet.","SheetProtectionResumedLabel":"Resume protection on sheet ${sheet}","_SheetProtectionResumed.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet.","TableAltTextEditedLabel":"I edited the Alt Text of Table ${tableName}","_TableAltTextEditedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableAltTextTitleEditedLabel":"I edited the title part of Alt Text of Table ${tableName}","_TableAltTextTitleEditedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableAltTextDescriptionEditedLabel":"I edited the description part Alt Text of Table ${tableName}","_TableAltTextDescriptionEditedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRangeApplyBorderLabel":"I changed the border on table ${tableName}","_TableRangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeApplyBorderLabel":"I changed the border on table ${tableName} body","_TableBodyRangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeApplyBorderLabel":"I changed the border on table ${tableName} header row","_TableHeaderRowRangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeApplyBorderLabel":"I changed the border on table ${tableName} total row","_TableTotalRowRangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeApplyBorderLabel":"I changed the border on sub-range of table ${tableName}","_TableGeneralRangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeApplyBorderLabel":"I changed the border on ${count} row(s) in table ${tableName}","_TableRowsRangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeApplyBorderLabel":"I changed the border on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeApplyBorderLabel":"I changed the border on ${count} column(s) in table ${tableName}","_TableColumnsRangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeApplyBorderLabel":"I changed the border on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeApplyBorderLabel":"I changed the border on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","MultiRangeApplyBorderLabel":"I changed the border on range areas","_MultiRangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeClearBackgroundColorLabel":"I cleared the background color on ${range}","_RangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameClearBackgroundColorLabel":"I cleared the background color on the column(s) \'${columnName}\'","_ColumnNameClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeClearBackgroundColorLabel":"I cleared the background color on range areas","_MultiRangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeClearBackgroundColorLabel":"I cleared the background color on table ${tableName}","_TableRangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by a the name of the table.","TableBodyRangeClearBackgroundColorLabel":"I cleared the background color on table ${tableName} body","_TableBodyRangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeClearBackgroundColorLabel":"I cleared the background color on table ${tableName} header row","_TableHeaderRowRangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeClearBackgroundColorLabel":"I cleared the background color on table ${tableName} total row","_TableTotalRowRangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeClearBackgroundColorLabel":"I cleared the background color on sub-range of table ${tableName}","_TableGeneralRangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeClearBackgroundColorLabel":"I cleared the background color on ${count} row(s) in table ${tableName}","_TableRowsRangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeClearBackgroundColorLabel":"I cleared the background color on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeClearBackgroundColorLabel":"I cleared the background color on ${count} column(s) in table ${tableName}","_TableColumnsRangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeClearBackgroundColorLabel":"I cleared the background color on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeClearBackgroundColorLabel":"I cleared the background color on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeFillPatternAppliedLabel":"Patterned fill applied","_RangeFillPatternAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeCellStyleAppliedLabel":"I applied a cell style to ${range}","_RangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameCellStyleAppliedLabel":"I applied a cell style to the column(s) \'${columnName}\'","_ColumnNameCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeCellStyleAppliedLabel":"I applied a cell style to range areas","_MultiRangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeCellStyleAppliedLabel":"I applied a cell style to table ${tableName}","_TableRangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by a range of cells.","TableBodyRangeCellStyleAppliedLabel":"I applied a cell style to table ${tableName} body","_TableBodyRangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeCellStyleAppliedLabel":"I applied a cell style to table ${tableName} header row","_TableHeaderRowRangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeCellStyleAppliedLabel":"I applied a cell style to table ${tableName} total row","_TableTotalRowRangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeCellStyleAppliedLabel":"I applied a cell style to sub-range of table ${tableName}","_TableGeneralRangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeCellStyleAppliedLabel":"I applied a cell style to ${count} row(s) in table ${tableName}","_TableRowsRangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeCellStyleAppliedLabel":"I applied a cell style to row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeCellStyleAppliedLabel":"I applied a cell style to ${count} column(s) in table ${tableName}","_TableColumnsRangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeCellStyleAppliedLabel":"I applied a cell style to column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeCellStyleAppliedLabel":"I applied a cell style to column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeClearLabel":"I cleared the contents of ${range}","_RangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeClearLabel":"I cleared the contents of table ${tableName}","_TableRangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeClearLabel":"I cleared the contents of table ${tableName} body","_TableBodyRangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeClearLabel":"I cleared the contents of table ${tableName} header row","_TableHeaderRowRangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeClearLabel":"I cleared the contents of table ${tableName} total row","_TableTotalRowRangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeClearLabel":"I cleared the contents of sub-range of table ${tableName}","_TableGeneralRangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeClearLabel":"I cleared the contents of ${count} row(s) in table ${tableName}","_TableRowsRangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeClearLabel":"I cleared the contents of row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeClearLabel":"I cleared the contents of ${count} column(s) in table ${tableName}","_TableColumnsRangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeClearLabel":"I cleared the contents of column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeClearLabel":"I cleared the contents of column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeClearFormatLabel":"I cleared the formatting on ${range}","_RangeClearFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeClearFormatLabel":"I cleared the formatting on table ${tableName}","_TableRangeClearFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeClearFormatLabel":"I cleared the formatting on table ${tableName} body","_TableBodyRangeClearFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeClearFormatLabel":"I cleared the formatting on table ${tableName} header row","_TableHeaderRowRangeClearFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeClearFormatLabel":"I cleared the formatting on table ${tableName} total row","_TableTotalRowRangeClearFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeClearFormatLabel":"I cleared the formatting on sub-range of table ${tableName}","_TableGeneralRangeClearFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeClearFormatLabel":"I cleared the formatting on ${count} row(s) in table ${tableName}","_TableRowsRangeClearFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeClearFormatLabel":"I cleared the formatting on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeClearFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeClearFormatLabel":"I cleared the formatting on ${count} column(s) in table ${tableName}","_TableColumnsRangeClearFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeClearFormatLabel":"I cleared the formatting on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeClearFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeClearFormatLabel":"I cleared the formatting on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeClearFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","MultiRangeClearLabel":"I cleared the range areas","_MultiRangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeColumnsAutofitLabel":"I autofitted column(s) in ${range}.","_RangeColumnsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeColumnsAutofitLabel":"I autofitted column(s) in table ${tableName}","_TableRangeColumnsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeColumnsAutofitLabel":"I autofitted column(s) in table ${tableName} body","_TableBodyRangeColumnsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeColumnsAutofitLabel":"I autofitted column(s) in table ${tableName} header row","_TableHeaderRowRangeColumnsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeColumnsAutofitLabel":"I autofitted column(s) in table ${tableName} total row","_TableTotalRowRangeColumnsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeColumnsAutofitLabel":"I autofitted column(s) in sub-range of table ${tableName}","_TableGeneralRangeColumnsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeColumnsAutofitLabel":"I autofitted column(s) in ${count} row(s) in table ${tableName}","_TableRowsRangeColumnsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeColumnsAutofitLabel":"I autofitted column(s) in row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeColumnsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeColumnsAutofitLabel":"I autofitted column(s) in ${count} column(s) in table ${tableName}","_TableColumnsRangeColumnsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeColumnsAutofitLabel":"I autofitted column(s) in column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeColumnsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeColumnsAutofitLabel":"I autofitted column(s) in column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeColumnsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeUseStandardWidthLabel":"I removed autofit from column(s) in ${range}.","_RangeUseStandardWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeUseStandardWidthLabel":"I removed autofit from column(s) in table ${tableName}","_TableRangeUseStandardWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeUseStandardWidthLabel":"I removed autofit from column(s) in table ${tableName} body","_TableBodyRangeUseStandardWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeUseStandardWidthLabel":"I removed autofit from column(s) in table ${tableName} header row","_TableHeaderRowRangeUseStandardWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeUseStandardWidthLabel":"I removed autofit from column(s) in table ${tableName} total row","_TableTotalRowRangeUseStandardWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeUseStandardWidthLabel":"I removed autofit from column(s) in sub-range of table ${tableName}","_TableGeneralRangeUseStandardWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeUseStandardWidthLabel":"I removed autofit from column(s) in ${count} row(s) in table ${tableName}","_TableRowsRangeUseStandardWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeUseStandardWidthLabel":"I removed autofit from column(s) in row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeUseStandardWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeUseStandardWidthLabel":"I removed autofit from column(s) in ${count} column(s) in table ${tableName}","_TableColumnsRangeUseStandardWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeUseStandardWidthLabel":"I removed autofit from column(s) in column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeUseStandardWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeUseStandardWidthLabel":"I removed autofit from column(s) in column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeUseStandardWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeUseStandardHeightLabel":"I removed autofit from row(s) in ${range}.","_RangeUseStandardHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeUseStandardHeightLabel":"I removed autofit from row(s) in table ${tableName}","_TableRangeUseStandardHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeUseStandardHeightLabel":"I removed autofit from row(s) in table ${tableName} body","_TableBodyRangeUseStandardHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeUseStandardHeightLabel":"I removed autofit from row(s) in table ${tableName} header row","_TableHeaderRowRangeUseStandardHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeUseStandardHeightLabel":"I removed autofit from row(s) in table ${tableName} total row","_TableTotalRowRangeUseStandardHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeUseStandardHeightLabel":"I removed autofit from row(s) in sub-range of table ${tableName}","_TableGeneralRangeUseStandardHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeUseStandardHeightLabel":"I removed autofit from row(s) in ${count} row(s) in table ${tableName}","_TableRowsRangeUseStandardHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeUseStandardHeightLabel":"I removed autofit from row(s) in row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeUseStandardHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeUseStandardHeightLabel":"I removed autofit from row(s) in ${count} column(s) in table ${tableName}","_TableColumnsRangeUseStandardHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeUseStandardHeightLabel":"I removed autofit from row(s) in column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeUseStandardHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeUseStandardHeightLabel":"I removed autofit from row(s) in column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeUseStandardHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeCustomSortLabel":"I applied a custom sort on ${range}","_RangeCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by a name of a sheet.","TableRangeCustomSortLabel":"I applied a custom sort on ${tableName}.","_TableRangeCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeCustomSortLabel":"I applied a custom sort on ${tableName} body.","_TableBodyRangeCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeCustomSortLabel":"I applied a custom sort on ${tableName} header row.","_TableHeaderRowRangeCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeCustomSortLabel":"I applied a custom sort on ${tableName} total row.","_TableTotalRowRangeCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeCustomSortLabel":"I applied a custom sort on sub-range of table ${tableName}.","_TableGeneralRangeCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeCustomSortLabel":"I applied a custom sort on ${count} row(s) in table ${tableName}.","_TableRowsRangeCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeCustomSortLabel":"I applied a custom sort on row at index ${rowIndex} in table ${tableName}.","TableRowByIndexRangeCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeCustomSortLabel":"I applied a custom sort on ${count} column(s) in table ${tableName}.","_TableColumnsRangeCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameCustomSortLabel":"I applied a custom sort on column \'${columnName}\' in table ${tableName}.","_TableColumnByNameCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexCustomSortLabel":"I applied a custom sort on the column at index ${columnIndex} in table ${tableName}.","_TableColumnByIndexCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","AutoFilterCustomSortLabel":"I applied a custom sort to range spanned by auto filter on sheet ${sheet}","_AutoFilterCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TextToColumnsLabel":"Transform text to columns on ${range}","_TextToColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is the range where the operation happens.","RangeDeleteLabel":"I deleted ${range}","_RangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeDeleteLabel":"I deleted table ${tableName}","_TableRangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeDeleteLabel":"I deleted table ${tableName} body","_TableBodyRangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeDeleteLabel":"I deleted table ${tableName} header row","_TableHeaderRowRangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeDeleteLabel":"I deleted table ${tableName} total row","_TableTotalRowRangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeDeleteLabel":"I deleted sub-range of table ${tableName}","_TableGeneralRangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeDeleteLabel":"I deleted ${count} row(s) in table ${tableName}","_TableRowsRangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeDeleteLabel":"I deleted row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeDeleteLabel":"I deleted ${count} column(s) in table ${tableName}","_TableColumnsRangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeDeleteLabel":"I deleted column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeDeleteLabel":"I deleted column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeEditLabel":"I edited ${range}","_RangeEditLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","RangeEditValueNumberLabel":"Write ${value} into ${range}","_RangeEditValueNumberLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells. The value represents a specific string cell value we\'re writing into that cell range, e.g. \'1.5\'","RangeEditValueStringLabel":"I wrote \'${value}\' into ${range}","_RangeEditValueStringLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells. The value represents a specific cell value we\'re writing into that cell range, e.g. \'1.5\'","MultiRangeEditLabel":"I edited the range areas","_MultiRangeEditLabel.comment":"User-facing string describing the Excel event executed by Copilot.","MultiRangeDeleteLabel":"I deleted the range areas","_MultiRangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeFillLabel":"Fill range ${range}","_RangeFillLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","RangeFlashFillLabel":"Flash fill on ${range}","_RangeFlashFillLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","RangeFormatBoldLabel":"I bolded ${range}","_RangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatBoldLabel":"I bolded the column(s) \'${columnName}\'","_ColumnFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","RangeFormatSuperscriptLabel":"Superscript ${range}","_RangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatSuperscriptLabel":"Superscript the column(s) \'${columnName}\'","_ColumnFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","RangeFormatSubscriptLabel":"subscript ${range}","_RangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatSubscriptLabel":"subscript the column(s) \'${columnName}\'","_ColumnFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeFormatBoldLabel":"I bolded the range areas","_MultiRangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.","MultiRangeFormatSuperscriptLabel":"Superscript range areas","_MultiRangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.","MultiRangeFormatSubscriptLabel":"Subscript range areas","_MultiRangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeFormatBoldLabel":"I bolded the table ${tableName}","_TableRangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRangeFormatSuperscriptLabel":"Superscript table ${tableName}","_TableRangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRangeFormatSubscriptLabel":"Subscript table ${tableName}","_TableRangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatBoldLabel":"I bolded the table ${tableName} body","_TableBodyRangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatSuperscriptLabel":"Superscript table ${tableName} body","_TableBodyRangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatSubscriptLabel":"Subscript table ${tableName} body","_TableBodyRangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatBoldLabel":"I bolded the table ${tableName} header row","_TableHeaderRowRangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatSuperscriptLabel":"Superscript table ${tableName} header row","_TableHeaderRowRangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatSubscriptLabel":"Subscript table ${tableName} header row","_TableHeaderRowRangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatBoldLabel":"I bolded the table ${tableName} total row","_TableTotalRowRangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatSuperscriptLabel":"Superscript table ${tableName} total row","_TableTotalRowRangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatSubscriptLabel":"Subscript table ${tableName} total row","_TableTotalRowRangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatBoldLabel":"I bolded the sub-range of table ${tableName}","_TableGeneralRangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatSuperscriptLabel":"Superscript sub-range of table ${tableName}","_TableGeneralRangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatSubscriptLabel":"Subscript sub-range of table ${tableName}","_TableGeneralRangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatBoldLabel":"I bolded ${count} row(s) in table ${tableName}","_TableRowsRangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatBoldLabel":"I bolded row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableRowsRangeFormatSuperscriptLabel":"Superscript ${count} row(s) in table ${tableName}","_TableRowsRangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatSuperscriptLabel":"Superscript row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableRowsRangeFormatSubscriptLabel":"Subscript ${count} row(s) in table ${tableName}","_TableRowsRangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatSubscriptLabel":"Subscript row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatBoldLabel":"I bolded ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatBoldLabel":"I bolded column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatBoldLabel":"I bolded column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","TableColumnsRangeFormatSuperscriptLabel":"Superscript ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatSuperscriptLabel":"Superscript column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatSuperscriptLabel":"Superscript column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","TableColumnsRangeFormatSubscriptLabel":"Subscript ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatSubscriptLabel":"Subscript column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatSubscriptLabel":"Subscript column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","MultiRangeFormatUnboldLabel":"I unbolded the range areas","_MultiRangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.","MultiRangeFormatRemoveSuperscriptLabel":"I removed the superscript from range areas","_MultiRangeFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.","MultiRangeFormatRemoveSubscriptLabel":"I removed the subscript from range areas","_MultiRangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeFormatDoubleUnderlineLabel":"I applied a double underline to ${range}","_RangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatDoubleUnderlineLabel":"I applied a double underline to the column(s) \'${columnName}\'","_ColumnFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeFormatDoubleUnderlineLabel":"I applied a double underline to range areas","_MultiRangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeFormatDoubleUnderlineLabel":"I applied a double underline to table ${tableName}","_TableRangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatDoubleUnderlineLabel":"I applied a double underline to table ${tableName} body","_TableBodyRangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatDoubleUnderlineLabel":"I applied a double underline to table ${tableName} header row","_TableHeaderRowRangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatDoubleUnderlineLabel":"I applied a double underline to table ${tableName} total row","_TableTotalRowRangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatDoubleUnderlineLabel":"I applied a double underline to sub-range of table ${tableName}","_TableGeneralRangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatDoubleUnderlineLabel":"I applied a double underline to ${count} row(s) in table ${tableName}","_TableRowsRangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatDoubleUnderlineLabel":"I applied a double underline to row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatDoubleUnderlineLabel":"I applied a double underline to ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatDoubleUnderlineLabel":"I applied a double underline to column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatDoubleUnderlineLabel":"I applied a double underline to column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeFormatItalicLabel":"I italicized ${range}","_RangeFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatItalicLabel":"I italicized the column(s) \'${columnName}\'","_ColumnFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeFormatItalicizeLabel":"I italicized the range areas","_MultiRangeFormatItalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeFormatItalicLabel":"I italicized the table ${tableName}","_TableRangeFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatItalicLabel":"I italicized the table ${tableName} body","_TableBodyRangeFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatItalicLabel":"I italicized the table ${tableName} header row","_TableHeaderRowRangeFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatItalicLabel":"I italicized the table ${tableName} total row","_TableTotalRowRangeFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatItalicLabel":"I italicized the sub-range of table ${tableName}","_TableGeneralRangeFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatItalicLabel":"I italicized ${count} row(s) in table ${tableName}","_TableRowsRangeFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatItalicLabel":"I italicized row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatItalicLabel":"I italicized ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatItalicLabel":"I italicized column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatItalicLabel":"I italicized column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","MultiRangeFormatUnItalicizeLabel":"I removed italics from the range areas","_MultiRangeFormatUnItalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from ${range}","_RangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatRemoveDoubleUnderlineLabel":"I removed the double underline from the column(s) \'${columnName}\'","_ColumnFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","TableRangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from table ${tableName}","_TableRangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from table ${tableName} body","_TableBodyRangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from table ${tableName} header row","_TableHeaderRowRangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from table ${tableName} total row","_TableTotalRowRangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from sub-range of table ${tableName}","_TableGeneralRangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from ${count} row(s) in table ${tableName}","_TableRowsRangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","MultiRangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from range areas","_MultiRangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from ${range}","_RangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatRemoveStrikethroughLabel":"I removed the strikethrough from the column(s) \'${columnName}\'","_ColumnFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from range areas","_MultiRangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from table ${tableName}","_TableRangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from table ${tableName} body","_TableBodyRangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from table ${tableName} header row","_TableHeaderRowRangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from table ${tableName} total row","_TableTotalRowRangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from sub-range of table ${tableName}","_TableGeneralRangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from ${count} row(s) in table ${tableName}","_TableRowsRangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeFormatRemoveUnderlineLabel":"I removed underlining from ${range}","_RangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatRemoveUnderlineLabel":"I removed underlining from column(s) ${racolumnNamenge}","_ColumnFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeFormatRemoveUnderlineLabel":"I removed underlining from range areas","_MultiRangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeFormatRemoveUnderlineLabel":"I removed underlining from table ${tableName}","_TableRangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatRemoveUnderlineLabel":"I removed underlining from table ${tableName} body","_TableBodyRangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatRemoveUnderlineLabel":"I removed underlining from table ${tableName} header row","_TableHeaderRowRangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatRemoveUnderlineLabel":"I removed underlining from table ${tableName} total row","_TableTotalRowRangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatRemoveUnderlineLabel":"I removed underlining from sub-range of table ${tableName}","_TableGeneralRangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatRemoveUnderlineLabel":"I removed underlining from ${count} row(s) in table ${tableName}","_TableRowsRangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatRemoveUnderlineLabel":"I removed underlining from row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatRemoveUnderlineLabel":"I removed underlining from ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatRemoveUnderlineLabel":"I removed underlining from column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatRemoveUnderlineLabel":"I removed underlining from column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeFormatSetFontColorLabel":"I set the font color to ${color} on ${range}","_RangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameFormatSetFontColorLabel":"I set the font color to ${color} on ${columnName}","_ColumnNameFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and columnName variable/placeholder is replaced by the column name.","ColumnFormatSetFontColorLabel":"I set the font color to ${color} on ${range}","_ColumnFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and range variable/placeholder is replaced by a range of cells.","MultiRangeFormatSetFontColorLabel":"I set the font color to ${color} on range areas","_MultiRangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.","TableRangeFormatSetFontColorLabel":"I set the font color to ${color} on table ${tableName}","_TableRangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatSetFontColorLabel":"I set the font color to ${color} on table ${tableName} body","_TableBodyRangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatSetFontColorLabel":"I set the font color to ${color} on table ${tableName} header row","_TableHeaderRowRangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatSetFontColorLabel":"I set the font color to ${color} on table ${tableName} total row","_TableTotalRowRangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatSetFontColorLabel":"I set the font color to ${color} on sub-range of table ${tableName}","_TableGeneralRangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatSetFontColorLabel":"I set the font color to ${color} on ${count} row(s) in table ${tableName}","_TableRowsRangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatSetFontColorLabel":"I set the font color to ${color} on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatSetFontColorLabel":"I set the font color to ${color} on ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatSetFontColorLabel":"I set the font color to ${color} on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatSetFontColorLabel":"I set the font color to ${color} on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeFormatSetFontLabel":"I set the font to ${fontName} on ${range}","_RangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameFormatSetFontLabel":"I set the font to ${fontName} on the column(s) \'${columnName}\'","_ColumnNameFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeFormatSetFontLabel":"I set the font to ${fontName} on range areas","_MultiRangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.","TableRangeFormatSetFontLabel":"I set the font to ${fontName} on table ${tableName}","_TableRangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatSetFontLabel":"I set the font to ${fontName} on table ${tableName} body","_TableBodyRangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatSetFontLabel":"I set the font to ${fontName} on table ${tableName} header row","_TableHeaderRowRangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatSetFontLabel":"I set the font to ${fontName} on table ${tableName} total row","_TableTotalRowRangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatSetFontLabel":"I set the font to ${fontName} on sub-range of table ${tableName}","_TableGeneralRangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatSetFontLabel":"I set the font to ${fontName} on ${count} row(s) in table ${tableName}","_TableRowsRangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatSetFontLabel":"I set the font to ${fontName} on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatSetFontLabel":"I set the font to ${fontName} on ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatSetFontLabel":"I set the font to ${fontName} on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatSetFontLabel":"I set the font to ${fontName} on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeFormatStrikethroughLabel":"I applied a strikethrough on ${range}","_RangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatStrikethroughLabel":"I applied a strikethrough on the column(s) \'${columnName}\'","_ColumnFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeFormatStrikethroughLabel":"I applied a strikethrough on range areas","_MultiRangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeFormatStrikethroughLabel":"I applied a strikethrough on table ${tableName}","_TableRangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableRange variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatStrikethroughLabel":"I applied a strikethrough on table ${tableName} body","_TableBodyRangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatStrikethroughLabel":"I applied a strikethrough on table ${tableName} header row","_TableHeaderRowRangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatStrikethroughLabel":"I applied a strikethrough on table ${tableName} total row","_TableTotalRowRangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatStrikethroughLabel":"I applied a strikethrough on sub-range of table ${tableName}","_TableGeneralRangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatStrikethroughLabel":"I applied a strikethrough on ${count} row(s) in table ${tableName}","_TableRowsRangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatStrikethroughLabel":"I applied a strikethrough on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatStrikethroughLabel":"I applied a strikethrough on ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatStrikethroughLabel":"I applied a strikethrough on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatStrikethroughLabel":"I applied a strikethrough on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeFormatUnboldLabel":"I unbolded ${range}","_RangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatUnboldLabel":"I unbolded the column(s) \'${columnName}\'","_ColumnFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","RangeFormatRemoveSuperscriptLabel":"I removed the superscript from ${range}","_RangeFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatRemoveSuperscriptLabel":"I removed the superscript from the column(s) \'${columnName}\'","_ColumnFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","RangeFormatRemoveSubscriptLabel":"I removed the subscript from ${range}","_RangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatRemoveSubscriptLabel":"I removed the subscript from the column(s) \'${columnName}\'","_ColumnFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","TableRangeFormatUnboldLabel":"I unbolded the table ${tableName}","_TableRangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRangeFormatUnSuperscriptLabel":"I removed the superscript from table ${tableName}","_TableRangeFormatUnSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRangeFormatRemoveSubscriptLabel":"I removed the subscript from table ${tableName}","_TableRangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatUnboldLabel":"I unbolded the table ${tableName} body","_TableBodyRangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatRemoveSuperscriptLabel":"I removed the superscript from table ${tableName} body","_TableBodyRangeFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatRemoveSubscriptLabel":"I removed the subscript from table ${tableName} body","_TableBodyRangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatUnboldLabel":"I unbolded the table ${tableName} header row","_TableHeaderRowRangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatRemoveSuperscriptLabel":"I removed the superscript from table ${tableName} header row","_TableHeaderRowRangeFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatRemoveSubscriptLabel":"I removed the subscript from table ${tableName} header row","_TableHeaderRowRangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatUnboldLabel":"I unbolded the table ${tableName} total row","_TableTotalRowRangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatRemoveSuperscriptLabel":"I removed the superscript from table ${tableName} total row","_TableTotalRowRangeFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatRemoveSubscriptLabel":"I removed the subscript from table ${tableName} total row","_TableTotalRowRangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatUnboldLabel":"I unbolded the sub-range of table ${tableName}","_TableGeneralRangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatRemoveSuperscriptLabel":"I removed the superscript from sub-range of table ${tableName}","_TableGeneralRangeFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatRemoveSubscriptLabel":"I removed the subscript from sub-range of table ${tableName}","_TableGeneralRangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatUnboldLabel":"I unbolded ${count} row(s) in table ${tableName}","_TableRowsRangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatUnboldLabel":"I unbolded row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableRowsRangeFormatRemoveSuperscriptLabel":"I removed the superscript from ${count} row(s) in table ${tableName}","_TableRowsRangeFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatRemoveSuperscriptLabel":"I removed the superscript from row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableRowsRangeFormatRemoveSubscriptLabel":"I removed the subscript from ${count} row(s) in table ${tableName}","_TableRowsRangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatRemoveSubscriptLabel":"I removed the subscript from row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatUnboldLabel":"I unbolded ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatUnboldLabel":"I unbolded column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatUnboldLabel":"I unbolded column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","TableColumnsRangeFormatRemoveSuperscriptLabel":"I removed the superscript from ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatRemoveSuperscriptLabel":"I removed the superscript from column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatRemoveSuperscriptLabel":"I removed the superscript from column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","TableColumnsRangeFormatRemoveSubscriptLabel":"I removed the subscript from ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatRemoveSubscriptLabel":"I removed the subscript from column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatRemoveSubscriptLabel":"I removed the subscript from column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeFormatUnderlineLabel":"I underlined ${range}","_RangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatUnderlineLabel":"I underlined the column(s) \'${columnName}\'","_ColumnFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeFormatUnderlineLabel":"I underlined the range areas","_MultiRangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeFormatUnderlineLabel":"I underlined the table ${tableName}","_TableRangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatUnderlineLabel":"I underlined the table ${tableName} body","_TableBodyRangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatUnderlineLabel":"I underlined the table ${tableName} header row","_TableHeaderRowRangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatUnderlineLabel":"I underlined the table ${tableName} total row","_TableTotalRowRangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatUnderlineLabel":"I underlined the sub-range of table ${tableName}","_TableGeneralRangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatUnderlineLabel":"I underlined ${count} row(s) in table ${tableName}","_TableRowsRangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatUnderlineLabel":"I underlined row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatUnderlineLabel":"I underlined ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatUnderlineLabel":"I underlined column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatUnderlineLabel":"I underlined column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeFormatUnitalicizeLabel":"I removed italics from ${range}","_RangeFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatUnitalicizeLabel":"I removed italics from the column(s) \'${columnName}\'","_ColumnFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","TableRangeFormatUnitalicizeLabel":"I removed italics from table ${tableName}","_TableRangeFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatUnitalicizeLabel":"I removed italics from table ${tableName} body","_TableBodyRangeFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatUnitalicizeLabel":"I removed italics from table ${tableName} header row","_TableHeaderRowRangeFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatUnitalicizeLabel":"I removed italics from table ${tableName} total row","_TableTotalRowRangeFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatUnitalicizeLabel":"I removed italics from sub-range of table ${tableName}","_TableGeneralRangeFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatUnitalicizeLabel":"I removed italics from ${count} row(s) in table ${tableName}","_TableRowsRangeFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatUnitalicizeLabel":"I removed italics from row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatUnitalicizeLabel":"I removed italics from ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatUnitalicizeLabel":"I removed italics from column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatUnitalicizeLabel":"I removed italics from column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeGroupDetailsHideLabel":"I hid the group details on sheet ${sheet}","_RangeGroupDetailsHideLabel.comment":"Text to show in a list when a group details hide user action was taken during script recording","RangeGroupDetailsShowLabel":"Show group details on sheet ${sheet}","_RangeGroupDetailsShowLabel.comment":"Text to show in a list when a group details show user action was taken during script recording","RangeGroupLabel":"Group range on sheet ${sheet}","_RangeGroupLabel.comment":"Text to show in a list when a range group user action was taken during script recording","RangeDataValidationChangedGroupLabel":"I set the data validation on sheet ${sheet}","_RangeDataValidationChangedGroupLabel.comment":"Text to show in a list when the data validation group was changed for a selected range","RangeHideRowsLabel":"I hid the row(s) on ${range}","_RangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeHideRowsLabel":"I hid the row(s) in table ${tableName}","_TableRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeHideRowsLabel":"I hid the row(s) in table ${tableName} body","_TableBodyRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeHideRowsLabel":"I hid the table ${tableName} header row","_TableHeaderRowRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeHideRowsLabel":"I hid the table ${tableName} total row","_TableTotalRowRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeHideRowsLabel":"I hid the row(s) in sub-range of table ${tableName}","_TableGeneralRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeHideRowsLabel":"I hid ${count} row(s) in table ${tableName}","_TableRowsRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeHideRowsLabel":"I hid row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeHideRowsLabel":"I hid the row(s) in ${count} column(s) in table ${tableName}","_TableColumnsRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeHideRowsLabel":"I hid the row(s) in column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeHideRowsLabel":"I hid the row(s) in column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameHideRowsLabel":"I hid the row(s) on the column(s) \'${columnName}\'","_ColumnNameRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","RangeUnhideRowsLabel":"I unhid the row(s) on ${range}","_RangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeUnhideRowsLabel":"I unhid the row(s) in table ${tableName}","_TableRangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeUnhideRowsLabel":"I unhid the row(s) in table ${tableName} body","_TableBodyRangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeUnhideRowsLabel":"I unhid the table ${tableName} header row","_TableHeaderRowRangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeUnhideRowsLabel":"I unhid the table ${tableName} total row","_TableTotalRowRangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeUnhideRowsLabel":"I unhid the row(s) in sub-range of table ${tableName}","_TableGeneralRangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeUnhideRowsLabel":"I unhid ${count} row(s) in table ${tableName}","_TableRowsRangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeUnhideRowsLabel":"I unhid row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeUnhideRowsLabel":"I unhid the row(s) in ${count} column(s) in table ${tableName}","_TableColumnsRangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeUnhideRowsLabel":"I unhid the row(s) in column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeUnhideRowsLabel":"I unhid the row(s) in column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameUnhideRowsLabel":"I unhid the row(s) on the column(s) \'${columnName}\'","_ColumnNameUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","RangeHideColumnsLabel":"I hid the column(s) on ${range}","_RangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeHideColumnsLabel":"I hid the column(s) in table ${tableName}","_TableRangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeHideColumnsLabel":"I hid the column(s) in table ${tableName} body","_TableBodyRangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeHideColumnsLabel":"I hid the column(s) in table ${tableName} header row","_TableHeaderRowRangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeHideColumnsLabel":"I hid the column(s) in table ${tableName} total row","_TableTotalRowRangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeHideColumnsLabel":"I hid the column(s) in sub-range of table ${tableName}","_TableGeneralRangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeHideColumnsLabel":"I hid the column(s) in ${count} row(s) in table ${tableName}","_TableRowsRangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeHideColumnsLabel":"I hid the column(s) in row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeHideColumnsLabel":"I hid ${count} column(s) in table ${tableName}","_TableColumnsRangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeHideColumnsLabel":"I hid column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeHideColumnsLabel":"I hid the column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameHideColumnsLabel":"I hid the column(s) \'${columnName}\'","_ColumnNameHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","RangeUnhideColumnsLabel":"I unhid the column(s) on ${range}","_RangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeUnhideColumnsLabel":"I unhid the column(s) in table ${tableName}","_TableRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeUnhideColumnsLabel":"I unhid the column(s) in table ${tableName} body","_TableBodyRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeUnhideColumnsLabel":"I unhid the column(s) in table ${tableName} header row","_TableHeaderRowRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeUnhideColumnsLabel":"I unhid the column(s) in table ${tableName} total row","_TableTotalRowRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeUnhideColumnsLabel":"I unhid the column(s) in sub-range of table ${tableName}","_TableGeneralRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeUnhideColumnsLabel":"I unhid the column(s) in ${count} row(s) in table ${tableName}","_TableRowsRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeUnhideColumnsLabel":"I unhid the column(s) in row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeUnhideColumnsLabel":"I unhid ${count} column(s) in table ${tableName}","_TableColumnsRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeUnhideColumnsLabel":"I unhid column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeUnhideColumnsLabel":"I unhid the column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameUnhideColumnsLabel":"I unhid the column(s) \'${columnName}\'","_ColumnNameRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeHideRowsLabel":"I hid the row(s) on range areas","_MultiRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","MultiRangeUnhideRowsLabel":"I unhid the row(s) on range areas","_MultiRangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","MultiRangeHideColumnsLabel":"I hid the column(s) on range areas","_MultiRangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","MultiRangeUnhideColumnsLabel":"I unhid the column(s) on range areas","_MultiRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","RangeHyperlinkLabel":"I applied a hyperlink on ${range}","_RangeHyperlinkLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","RangeRemoveHyperlinkLabel":"I removed the hyperlink from ${range}","_RangeRemoveHyperlinkLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ChangeRangeIndent":"I changed the indent","_ChangeRangeIndent.comment":"User-facing string describing the Excel event executed by Copilot.","RangeChangeIndentLabel":"I changed the indent on ${range}","_RangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameChangeIndentLabel":"I changed the indent on the column(s) \'${columnName}\'","_ColumnNameChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","TableRangeChangeIndentLabel":"I changed the indent on table ${tableName}","_TableRangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeChangeIndentLabel":"I changed the indent on table ${tableName} body","_TableBodyRangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeChangeIndentLabel":"I changed the indent on table ${tableName} header row","_TableHeaderRowRangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeChangeIndentLabel":"I changed the indent on table ${tableName} total row","_TableTotalRowRangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeChangeIndentLabel":"I changed the indent on sub-range of table ${tableName}","_TableGeneralRangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeChangeIndentLabel":"I changed the indent on ${count} row(s) in table ${tableName}","_TableRowsRangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeChangeIndentLabel":"I changed the indent on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeChangeIndentLabel":"I changed the indent on ${count} column(s) in table ${tableName}","_TableColumnsRangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeChangeIndentLabel":"I changed the indent on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeChangeIndentLabel":"I changed the indent on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","MultiRangeRemoveHyperlinkLabel":"I removed the hyperlink from range areas","_MultiRangeRemoveHyperlinkLabel.comment":"User-facing string describing the Excel event executed by Copilot.","MultiRangeChangeIndentLabel":"I changed the indent on range areas","_MultiRangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeInsertLabel":"I inserted ${range}","_RangeInsertLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeInsertedLabel":"I inserted cells at table ${tableName}","_TableRangeInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeInsertedLabel":"I inserted cells at table ${tableName} body","_TableBodyRangeInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeInsertedLabel":"I inserted cells at table ${tableName} header row","_TableHeaderRowRangeInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeInsertedLabel":"I inserted cells at table ${tableName} total row","_TableTotalRowRangeInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeInsertedLabel":"I inserted cells at sub-range of table ${tableName}","_TableGeneralRangeInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeInsertedLabel":"I inserted cells at ${count} row(s) in table ${tableName}","_TableRowsRangeInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeInsertedLabel":"I inserted cells at row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeInsertedLabel":"I inserted cells at ${count} column(s) in table ${tableName}","_TableColumnsRangeInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeInsertedLabel":"I inserted cells at column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeInsertedLabel":"I inserted cells at column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","MultipleRangeInsertLabel":"I inserted multiple ranges","_MultipleRangeInsertLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeMergeLabel":"I merged ${range}","_RangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeMergeLabel":"I merged cells on table ${tableName}","_TableRangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeMergeLabel":"I merged cells on table ${tableName} body","_TableBodyRangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeMergeLabel":"I merged cells on table ${tableName} header row","_TableHeaderRowRangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeMergeLabel":"I merged cells on table ${tableName} total row","_TableTotalRowRangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeMergeLabel":"I merged cells on sub-range of table ${tableName}","_TableGeneralRangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeMergeLabel":"I merged cells on ${count} row(s) in table ${tableName}","_TableRowsRangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeMergeLabel":"I merged cells on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeMergeLabel":"I merged cells on ${count} column(s) in table ${tableName}","_TableColumnsRangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeMergeLabel":"I merged cells on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeMergeLabel":"I merged cells on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","MultiRangeMergeLabel":"I merged the range areas","_MultiRangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeNumberFormatLabel":"I applied ${numberFormat} on ${range}","_RangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameNumberFormatLabel":"I applied ${numberFormat} on the column(s) \'${columnName}\'","_ColumnNameNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeNumberFormatLabel":"I applied the number format on range areas","_MultiRangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeNumberFormatLabel":"I applied the number format on table ${tableName}","_TableRangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeNumberFormatLabel":"I applied the number format on table ${tableName} body","_TableBodyRangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeNumberFormatLabel":"I applied the number format on table ${tableName} header row","_TableHeaderRowRangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeNumberFormatLabel":"I applied the number format on table ${tableName} total row","_TableTotalRowRangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeNumberFormatLabel":"I applied the number format on sub-range of table ${tableName}","_TableGeneralRangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeNumberFormatLabel":"I applied the number format on ${count} row(s) in table ${tableName}","_TableRowsRangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeNumberFormatLabel":"I applied the number format on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeNumberFormatLabel":"I applied the number format on ${count} column(s) in table ${tableName}","_TableColumnsRangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeNumberFormatLabel":"I applied the number format on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeNumberFormatLabel":"I applied the number format on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangePasteCopyLabel":"Paste copied cells into ${range}","_RangePasteCopyLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","RangePasteCopyInTableLabel":"Paste copied cells into row ${rowIndex} of table ${tableName}","_RangePasteCopyInTableLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and rowIndex variable/placeholder is replaced by the index where the copied cells are pasted.  The $ and tableName variable/placeholder is replaced by the name of the table.","RangePasteCutLabel":"Paste cut cells into ${range}","_RangePasteCutLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","RangePasteCutInTableLabel":"Paste cut cells into row ${rowIndex} of table ${tableName}","_RangePasteCutInTableLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and rowIndex variable/placeholder is replaced by the index where the cut cells are pasted.  The $ and tableName variable/placeholder is replaced by the name of the table.","NamedSheetViewCreateLabel":"I created a new temporary sheet view","_NamedSheetViewCreateLabel.comment":"User-facing string describing the Excel event executed by Copilot.","NamedSheetViewDeleteLabel":"I deleted ${deletedNum} named sheet view(s)","_NamedSheetViewDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and deletedNum variables/placeholders is replaced by the number of named sheet views deleted.","NamedSheetViewDuplicateLabel":"Duplicate named sheet view ${sheetViewName}","_NamedSheetViewDuplicateLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheetViewName variables/placeholders is replaced by the name of the named sheet view.","NamedSheetViewExitLabel":"Exit named sheet view","_NamedSheetViewExitLabel.comment":"User-facing string describing the Excel event executed by Copilot.","NamedSheetViewExitAndKeepLabel":"Exit named sheet view and keep as ${sheetViewName}","_NamedSheetViewExitAndKeepLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheetViewName variables/placeholders is replaced by the name of the named sheet view.","NamedSheetViewKeepLabel":"Keep named sheet view as ${sheetViewName}","_NamedSheetViewKeepLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheetViewName variables/placeholders is replaced by the name of the named sheet view.","NamedSheetViewRenameLabel":"Rename named sheet view to ${newSheetViewName}","_NamedSheetViewRenameLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and newSheetViewName variables/placeholders is replaced by the new name of the named sheet view.","NamedSheetViewSwitchLabel":"Switch to named sheet view ${sheetViewName}","_NamedSheetViewSwitchLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheetViewName variables/placeholders is replaced by the name of the named sheet view.","NamedSheetViewSwitchAndKeepLabel":"Switch to named sheet view ${sheetViewName} and keep temporary named sheet view as ${sheetViewKeepName}","_NamedSheetViewSwitchAndKeepLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheetViewName variables/placeholders is replaced by the name of the named sheet view.  The $ and namedSheetViewKeepName variables/placeholders is replaced by the name of the temporary named sheet view to keep.","RangePasteLabel":"Paste from ${sourceRange} to ${destinationRange}","_RangePasteLabel.comment":"User-facing string describing the Excel event executed by Copilot. The $ and sourceRange and destinationRange variables/placeholders are replaced by ranges of cells.","RangePasteInTableRangeLabel":"Paste from ${sourceRange} to table ${tableName}","_RangePasteInTableRangeLabel.comment":"User-facing string describing the Excel event executed by Copilot. The $ and sourceRange variable/placeholder is replaced a range of cells.","RangePasteInTableBodyRangeLabel":"Paste from ${sourceRange} to table ${tableName} body","_RangePasteInTableBodyRangeLabel.comment":"User-facing string describing the Excel event executed by Copilot.   The $ and sourceRange variable/placeholder is replaced a range of cells.  The $ and tableName variable/placeholder is replaced by the name of the table.","RangePasteInTableHeaderRowRangeLabel":"Paste from ${sourceRange} to table ${tableName} header row","_RangePasteInTableHeaderRowRangeLabel.comment":"User-facing string describing the Excel event executed by Copilot.   The $ and sourceRange variable/placeholder is replaced a range of cells.  The $ and tableName variable/placeholder is replaced by the name of the table.","RangePasteInTableTotalRowRangeLabel":"Paste from ${sourceRange} to table ${tableName} total row","_RangePasteInTableTotalRowRangeLabel.comment":"User-facing string describing the Excel event executed by Copilot.   The $ and sourceRange variable/placeholder is replaced a range of cells.  The $ and tableName variable/placeholder is replaced by the name of the table.","RangePasteInTableGeneralRangeLabel":"Paste from ${sourceRange} to sub-range of table ${tableName}","_RangePasteInTableGeneralRangeLabel.comment":"User-facing string describing the Excel event executed by Copilot.   The $ and sourceRange variable/placeholder is replaced a range of cells.  The $ and tableName variable/placeholder is replaced by the name of the table.","MultiRangePasteLabel":"Paste from ${sourceRange} to range areas","_MultiRangePasteLabel.comment":"User-facing string describing the Excel event executed by Copilot. The $ and sourceRange variable/placeholder is replaced by ranges of cells.","RangePasteTextLabel":"Paste text to ${range}","_RangePasteTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","RangeRemoveDuplicatesLabel":"I removed duplicates on ${range}","_RangeRemoveDuplicatesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeRemoveDuplicatesLabel":"I removed duplicates in table ${tableName}","_TableRangeRemoveDuplicatesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeRemoveDuplicatesLabel":"I removed duplicates in table ${tableName} body","_TableBodyRangeRemoveDuplicatesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeRemoveDuplicatesLabel":"I removed duplicates in table ${tableName} header row","_TableHeaderRowRangeRemoveDuplicatesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeRemoveDuplicatesLabel":"I removed duplicates in table ${tableName} total row","_TableTotalRowRangeRemoveDuplicatesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeRemoveDuplicatesLabel":"I removed duplicates in sub-range of table ${tableName}","_TableGeneralRangeRemoveDuplicatesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeRemoveDuplicatesLabel":"I removed duplicates in ${count} row(s) in table ${tableName}","_TableRowsRangeRemoveDuplicatesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeRemoveDuplicatesLabel":"I removed duplicates in row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeRemoveDuplicatesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeRemoveDuplicatesLabel":"I removed duplicates in ${count} column(s) in table ${tableName}","_TableColumnsRangeRemoveDuplicatesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeRemoveDuplicatesLabel":"I removed duplicates in column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeRemoveDuplicatesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeRemoveDuplicatesLabel":"I removed duplicates in column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeRemoveDuplicatesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeRowsAutofitLabel":"I autofitted row(s) in ${range}.","_RangeRowsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeRowsAutofitLabel":"I autofitted row(s) in table ${tableName}","_TableRangeRowsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeRowsAutofitLabel":"I autofitted row(s) in table ${tableName} body","_TableBodyRangeRowsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeRowsAutofitLabel":"I autofitted row(s) in table ${tableName} header row","_TableHeaderRowRangeRowsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeRowsAutofitLabel":"I autofitted row(s) in table ${tableName} total row","_TableTotalRowRangeRowsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeRowsAutofitLabel":"I autofitted row(s) in sub-range of table ${tableName}","_TableGeneralRangeRowsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeRowsAutofitLabel":"I autofitted row(s) in ${count} row(s) in table ${tableName}","_TableRowsRangeRowsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeRowsAutofitLabel":"I autofitted row(s) in row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeRowsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeRowsAutofitLabel":"I autofitted row(s) in ${count} column(s) in table ${tableName}","_TableColumnsRangeRowsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeRowsAutofitLabel":"I autofitted row(s) in column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeRowsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeRowsAutofitLabel":"I autofitted row(s) in column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeRowsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeSetBackgroundColorLabel":"I set the background color to ${color} on ${range}","_RangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameSetBackgroundColorLabel":"I set the background color to ${color} on the column(s) \'${columnName}\'","_ColumnNameSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and columnName variable/placeholder is replaced by columnName of cells.","TableRangeSetBackgroundColorLabel":"I set the background color to ${color} on table ${tableName}","_TableRangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeSetBackgroundColorLabel":"I set the background color to ${color} on table ${tableName} body","_TableBodyRangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeSetBackgroundColorLabel":"I set the background color to ${color} on table ${tableName} header row","_TableHeaderRowRangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeSetBackgroundColorLabel":"I set the background color to ${color} on table ${tableName} total row","_TableTotalRowRangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeSetBackgroundColorLabel":"I set the background color to ${color} on sub-range of table ${tableName}","_TableGeneralRangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeSetBackgroundColorLabel":"I set the background color to ${color} on ${count} row(s) in table ${tableName}","_TableRowsRangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeSetBackgroundColorLabel":"I set the background color to ${color} on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeSetBackgroundColorLabel":"I set the background color to ${color} on ${count} column(s) in table ${tableName}","_TableColumnsRangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeSetBackgroundColorLabel":"I set the background color to ${color} on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeSetBackgroundColorLabel":"I set the background color to ${color} on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","MultiRangeSetBackgroundColorLabel":"I set the background color to ${color} on range areas","_MultiRangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.","RangeSetCellHeightLabel":"I set the height to ${size} on ${range}","_RangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeSetCellHeightLabel":"I set the height to ${size} on table ${tableName}","_TableRangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeSetCellHeightLabel":"I set the height to ${size} on table ${tableName} body","_TableBodyRangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeSetCellHeightLabel":"I set the height to ${size} on table ${tableName} header row","_TableHeaderRowRangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeSetCellHeightLabel":"I set the height to ${size} on table ${tableName} total row","_TableTotalRowRangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeSetCellHeightLabel":"I set the height to ${size} on sub-range of table ${tableName}","_TableGeneralRangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeSetCellHeightLabel":"I set the height to ${size} on ${count} row(s) in table ${tableName}","_TableRowsRangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeSetCellHeightLabel":"I set the height to ${size} on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeSetCellHeightLabel":"I set the height to ${size} on ${count} column(s) in table ${tableName}","_TableColumnsRangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeSetCellHeightLabel":"I set the height to ${size} on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeSetCellHeightLabel":"I set the height to ${size} on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameSetCellHeightLabel":"I set the height to ${size} on the column(s) \'${columnName}\'","_ColumnNameSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeSetCellHeightLabel":"I set the height to ${size} on range areas","_MultiRangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeSetCellWidthLabel":"I set the width to ${size} on ${range}","_RangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeSetCellWidthLabel":"I set the width to ${size} on table ${tableName}","_TableRangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeSetCellWidthLabel":"I set the width to ${size} on table ${tableName} body","_TableBodyRangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeSetCellWidthLabel":"I set the width to ${size} on table ${tableName} header row","_TableHeaderRowRangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeSetCellWidthLabel":"I set the width to ${size} on table ${tableName} total row","_TableTotalRowRangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeSetCellWidthLabel":"I set the width to ${size} on sub-range of table ${tableName}","_TableGeneralRangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeSetCellWidthLabel":"I set the width to ${size} on ${count} row(s) in table ${tableName}","_TableRowsRangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeSetCellWidthLabel":"I set the width to ${size} on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeSetCellWidthLabel":"I set the width to ${size} on ${count} column(s) in table ${tableName}","_TableColumnsRangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeSetCellWidthLabel":"I set the width to ${size} on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeSetCellWidthLabel":"I set the width to ${size} on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameSetCellWidthLabel":"I set the width to ${size} on the column(s) \'${columnName}\'","_ColumnNameSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeSetCellWidthLabel":"I set the width to ${size} on range areas","_MultiRangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.","RangeSetFontSizeLabel":"I set the font size to ${fontSize} on ${range}","_RangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameSetFontSizeLabel":"I set the font size to ${fontSize} on the column(s) \'${columnName}\'","_ColumnNameSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeSetFontSizeLabel":"I set the font size to ${fontSize} on range areas","_MultiRangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.","FontUnderlineStyleLabel":"I applied the ${style} underline on ${range}","_FontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot. The $ and style variable/placeholder is replaced by the style of underline. The $ and range variable/placeholder is replaced by a range of cells","TableRangeFontUnderlineStyleLabel":"I applied the ${style} underline on table ${tableName}","_TableRangeFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and style variable/placeholder is replaced by the style of underline.   The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFontUnderlineStyleLabel":"I applied the ${style} underline on table ${tableName} body","_TableBodyRangeFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and style variable/placeholder is replaced by the style of underline.   The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFontUnderlineStyleLabel":"I applied the ${style} underline on table ${tableName} header row","_TableHeaderRowRangeFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and style variable/placeholder is replaced by the style of underline.   The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFontUnderlineStyleLabel":"I applied the ${style} underline on table ${tableName} total row","_TableTotalRowRangeFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and style variable/placeholder is replaced by the style of underline.   The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFontUnderlineStyleLabel":"I applied the ${style} underline on sub-range of table ${tableName}","_TableGeneralRangeFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and style variable/placeholder is replaced by the style of underline.   The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFontUnderlineStyleLabel":"I applied the ${style} underline on ${count} row(s) in table ${tableName}","_TableRowsRangeFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and style variable/placeholder is replaced by the style of underline.   The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFontUnderlineStyleLabel":"I applied the ${style} underline on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and style variable/placeholder is replaced by the style of underline.   The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFontUnderlineStyleLabel":"I applied the ${style} underline on ${count} column(s) in table ${tableName}","_TableColumnsRangeFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and style variable/placeholder is replaced by the style of underline.   The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFontUnderlineStyleLabel":"I applied the ${style} underline on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and style variable/placeholder is replaced by the style of underline.   The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFontUnderlineStyleLabel":"I applied the ${style} underline on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and style variable/placeholder is replaced by the style of underline.   The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameFontUnderlineStyleLabel":"I applied the ${style} underline on the column(s) \'${columnName}\'","_ColumnNameFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and style variable/placeholder is replaced by the style of underline.  The $ and style variable/placeholder is replaced by the style of underline. The $ and columnName variable/placeholder is replaced by columnName of cells","RemoveFontUnderlineStyleLabel":"I removed underlining from ${range}","_RemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot. The $ and range variable/placeholder is replaced by a range of cells","TableRangeRemoveFontUnderlineStyleLabel":"I removed underlining from table ${tableName}","_TableRangeRemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeRemoveFontUnderlineStyleLabel":"I removed underlining from table ${tableName} body","_TableBodyRangeRemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeRemoveFontUnderlineStyleLabel":"I removed underlining from table ${tableName} header row","_TableHeaderRowRangeRemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeRemoveFontUnderlineStyleLabel":"I removed underlining from table ${tableName} total row","_TableTotalRowRangeRemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeRemoveFontUnderlineStyleLabel":"I removed underlining from sub-range of table ${tableName}","_TableGeneralRangeRemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeRemoveFontUnderlineStyleLabel":"I removed underlining from ${count} row(s) in table ${tableName}","_TableRowsRangeRemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeRemoveFontUnderlineStyleLabel":"I removed underlining from row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeRemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeRemoveFontUnderlineStyleLabel":"I removed underlining from ${count} column(s) in table ${tableName}","_TableColumnsRangeRemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeRemoveFontUnderlineStyleLabel":"I removed underlining from column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeRemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeRemoveFontUnderlineStyleLabel":"I removed underlining from column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeRemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameRemoveFontUnderlineStyleLabel":"I removed underlining from the column(s) \'${columnName}\'","_ColumnNameRemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot. The $ and columnName variable/placeholder is replaced by columnName of cells","TableRangeSetFontSizeLabel":"I set the font size to ${fontSize} on table ${tableName}","_TableRangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeSetFontSizeLabel":"I set the font size to ${fontSize} on table ${tableName} body","_TableBodyRangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeSetFontSizeLabel":"I set the font size to ${fontSize} on table ${tableName} header row","_TableHeaderRowRangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeSetFontSizeLabel":"I set the font size to ${fontSize} on table ${tableName} total row","_TableTotalRowRangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeSetFontSizeLabel":"I set the font size to ${fontSize} on sub-range of table ${tableName}","_TableGeneralRangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeSetFontSizeLabel":"I set the font size to ${fontSize} on ${count} row(s) in table ${tableName}","_TableRowsRangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeSetFontSizeLabel":"I set the font size to ${fontSize} on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeSetFontSizeLabel":"I set the font size to ${fontSize} on ${count} column(s) in table ${tableName}","_TableColumnsRangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeSetFontSizeLabel":"I set the font size to ${fontSize} on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeSetFontSizeLabel":"I set the font size to ${fontSize} on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on ${range}","_RangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameSetHorizontalAlignmentLabel":"I set the horizontal alignment on the column(s) \'${columnName}\'","_ColumnNameSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on range areas","_MultiRangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on table ${tableName}","_TableRangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableRange variable/placeholder is replaced by the name of the table.","TableBodyRangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on table ${tableName} body","_TableBodyRangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on table ${tableName} header row","_TableHeaderRowRangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on table ${tableName} total row","_TableTotalRowRangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on sub-range of table ${tableName}","_TableGeneralRangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on ${count} row(s) in table ${tableName}","_TableRowsRangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on ${count} column(s) in table ${tableName}","_TableColumnsRangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeSetVerticalAlignmentLabel":"I set the vertical alignment on ${range}","_RangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameSetVerticalAlignmentLabel":"I set the vertical alignment on the column(s) \'${columnName}\'","_ColumnNameSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeSetVerticalAlignmentLabel":"I set the vertical alignment on range areas","_MultiRangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeSetVerticalAlignmentLabel":"I set the vertical alignment on table ${tableName}","_TableRangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by the name of the table.","TableBodyRangeSetVerticalAlignmentLabel":"I set the vertical alignment on table ${tableName} body","_TableBodyRangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeSetVerticalAlignmentLabel":"I set the vertical alignment on table ${tableName} header row","_TableHeaderRowRangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeSetVerticalAlignmentLabel":"I set the vertical alignment on table ${tableName} total row","_TableTotalRowRangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeSetVerticalAlignmentLabel":"I set the vertical alignment on sub-range of table ${tableName}","_TableGeneralRangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeSetVerticalAlignmentLabel":"I set the vertical alignment on ${count} row(s) in table ${tableName}","_TableRowsRangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeSetVerticalAlignmentLabel":"I set the vertical alignment on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeSetVerticalAlignmentLabel":"I set the vertical alignment on ${count} column(s) in table ${tableName}","_TableColumnsRangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeSetVerticalAlignmentLabel":"I set the vertical alignment on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeSetVerticalAlignmentLabel":"I set the vertical alignment on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeSortLabel":"I sorted the range  ${range}","_RangeSortLabel.comment":"Text to show in a list when a sort range user action was taken during script recording","RangeUnGroupLabel":"Ungroup range on sheet ${sheet}","_RangeUnGroupLabel.comment":"Text to show in a list when a range ungroup user action was taken during script recording","RangeUnmergeLabel":"Unmerge ${range}","_RangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeUnmergeLabel":"I unmerged cells on table ${tableName}","_TableRangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeUnmergeLabel":"I unmerged cells on table ${tableName} body","_TableBodyRangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeUnmergeLabel":"I unmerged cells on table ${tableName} header row","_TableHeaderRowRangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeUnmergeLabel":"I unmerged cells on table ${tableName} total row","_TableTotalRowRangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeUnmergeLabel":"I unmerged cells on sub-range of table ${tableName}","_TableGeneralRangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeUnmergeLabel":"I unmerged cells on ${count} row(s) in table ${tableName}","_TableRowsRangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeUnmergeLabel":"I unmerged cells on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeUnmergeLabel":"I unmerged cells on ${count} column(s) in table ${tableName}","_TableColumnsRangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeUnmergeLabel":"I unmerged cells on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeUnmergeLabel":"I unmerged cells on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","MultiRangeUnmergeLabel":"Unmerge range areas","_MultiRangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeUnwrapTextLabel":"Unwrap text on ${range}","_RangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameUnwrapTextLabel":"Unwrap text on the column(s) \'${columnName}\'","_ColumnNameUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeUnwrapTextLabel":"Unwrap text on range areas","_MultiRangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeUnwrapTextLabel":"Unwrap text on table ${tableName}","_TableRangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeUnwrapTextLabel":"Unwrap text on table ${tableName} body","_TableBodyRangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeUnwrapTextLabel":"Unwrap text on table ${tableName} header row","_TableHeaderRowRangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeUnwrapTextLabel":"Unwrap text on table ${tableName} total row","_TableTotalRowRangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeUnwrapTextLabel":"Unwrap text on sub-range of table ${tableName}","_TableGeneralRangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeUnwrapTextLabel":"Unwrap text on ${count} row(s) in table ${tableName}","_TableRowsRangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeUnwrapTextLabel":"Unwrap text on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeUnwrapTextLabel":"Unwrap text on ${count} column(s) in table ${tableName}","_TableColumnsRangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeUnwrapTextLabel":"Unwrap text on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeUnwrapTextLabel":"Unwrap text on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeWrapTextLabel":"I wrapped text on ${range}","_RangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameWrapTextLabel":"I wrapped text on the column(s) \'${columnName}\'","_ColumnNameWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeWrapTextLabel":"I wrapped text on range areas","_MultiRangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeWrapTextLabel":"I wrapped text on table ${tableName}","_TableRangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeWrapTextLabel":"I wrapped text on table ${tableName} body","_TableBodyRangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeWrapTextLabel":"I wrapped text on table ${tableName} header row","_TableHeaderRowRangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeWrapTextLabel":"I wrapped text on table ${tableName} total row","_TableTotalRowRangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeWrapTextLabel":"I wrapped text on sub-range of table ${tableName}","_TableGeneralRangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeWrapTextLabel":"I wrapped text on ${count} row(s) in table ${tableName}","_TableRowsRangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeWrapTextLabel":"I wrapped text on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeWrapTextLabel":"I wrapped text on ${count} column(s) in table ${tableName}","_TableColumnsRangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeWrapTextLabel":"I wrapped text on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeWrapTextLabel":"I wrapped text on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RedoLabel":"Redo","_RedoLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ReplaceAllLabel":"Replace all \'${search}\' with \'${replace}\' over the range ${range}","_ReplaceAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term. \'range\' represents the cell range we\'re operating over, e.g. A1:C6","TableRangeReplaceAllLabel":"Replace all \'${search}\' with \'${replace}\' in table ${tableName}","_TableRangeReplaceAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeReplaceAllLabel":"Replace all \'${search}\' with \'${replace}\' in table ${tableName} body","_TableBodyRangeReplaceAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeReplaceAllLabel":"Replace all \'${search}\' with \'${replace}\' in table ${tableName} header row","_TableHeaderRowRangeReplaceAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeReplaceAllLabel":"Replace all \'${search}\' with \'${replace}\' in table ${tableName} total row","_TableTotalRowRangeReplaceAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeReplaceAllLabel":"Replace all \'${search}\' with \'${replace}\' in sub-range of table ${tableName}","_TableGeneralRangeReplaceAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeReplaceAllLabel":"Replace all \'${search}\' with \'${replace}\' in ${count} row(s) in table ${tableName}","_TableRowsRangeReplaceAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeReplaceAllLabel":"Replace all \'${search}\' with \'${replace}\' in row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeReplaceAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeReplaceAllLabel":"Replace all \'${search}\' with \'${replace}\' in ${count} column(s) in table ${tableName}","_TableColumnsRangeReplaceAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeReplaceAllLabel":"Replace all \'${search}\' with \'${replace}\' in column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeReplaceAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeReplaceAllLabel":"Replace all \'${search}\' with \'${replace}\' in column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeReplaceAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ReplaceAllLabelGeneric":"Replace all \'${search}\' with \'${replace}\'","_ReplaceAllLabelGeneric.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term.","TableApplyStyleLabel":"I applied a style on table ${tableName}","_TableApplyStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableChangeBandedColumnsVisibilityLabel":"Change the visibility of banded columns on table ${tableName}","_TableChangeBandedColumnsVisibilityLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableAddBandedColumnsLabel":"I added banded columns on table ${tableName}","_TableAddBandedColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRemoveBandedColumnsLabel":"I removed banded columns on table ${tableName}","_TableRemoveBandedColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableChangeBandedRowsVisibilityLabel":"I changed the visibility of banded rows on table ${tableName}","_TableChangeBandedRowsVisibilityLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableAddBandedRowsLabel":"I added banded rows on table ${tableName}","_TableAddBandedRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRemoveBandedRowsLabel":"I removed banded rows on table ${tableName}","_TableRemoveBandedRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableChangeFilterButtonVisibilityLabel":"I changed the visibility of filter button on table ${tableName}","_TableChangeFilterButtonVisibilityLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableAddFilterButtonLabel":"I added filter button on table ${tableName}","_TableAddFilterButtonLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRemoveFilterButtonLabel":"I removed filter button on table ${tableName}","_TableRemoveFilterButtonLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableClearFiltersLabel":"I removed all filters on table ${tableName}","_TableClearFiltersLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableColumnClearFilterLabel":"I removed a filter on \'${columnName}\' of table ${tableName}","_TableColumnClearFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was un-filtered.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableColumnCustomFilterLabel":"I applied a custom filter on \'${columnName}\' of table ${tableName}","_TableColumnCustomFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableColumnEqualsFilterLabel":"I applied a filter on \'${columnName}\' to show only rows where the value is equal to ${value1}","_TableColumnEqualsFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnDoesNotEqualFilterLabel":"I applied a filter on \'${columnName}\' to show only rows where the value does not equal to ${value1}","_TableColumnDoesNotEqualFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnBeginsWithFilterLabel1":"I applied a filter on \'${columnName}\' to show only rows where the value begins with ${value1}","_TableColumnBeginsWithFilterLabel1.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnBeginsWithFilterLabel2":"I applied a filter on \'${columnName}\' to show only rows where the value begins with ${value1} or ${value2}","_TableColumnBeginsWithFilterLabel2.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter. The ${value2} is replaced by the second value used to filter.","TableColumnDoesNotBeginWithFilterLabel1":"I applied a filter on \'${columnName}\' to show only rows where the value does not begin with ${value1}","_TableColumnDoesNotBeginWithFilterLabel1.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnDoesNotBeginWithFilterLabel2":"I applied a filter on \'${columnName}\' to show only rows where the value does not begin with ${value1} and ${value2}","_TableColumnDoesNotBeginWithFilterLabel2.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter. The ${value2} is replaced by the second value used to filter.","TableColumnEndsWithFilterLabel1":"I applied a filter on \'${columnName}\' to show only rows where the value ends with ${value1}","_TableColumnEndsWithFilterLabel1.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnEndsWithFilterLabel2":"I applied a filter on \'${columnName}\' to show only rows where the value ends with ${value1} or ${value2}","_TableColumnEndsWithFilterLabel2.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter. The ${value2} is replaced by the second value used to filter.","TableColumnDoesNotEndWithFilterLabel1":"I applied a filter on \'${columnName}\' to show only rows where the value does not end with ${value1}","_TableColumnDoesNotEndWithFilterLabel1.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnDoesNotEndWithFilterLabel2":"I applied a filter on \'${columnName}\' to show only rows where the value does not end with ${value1} and ${value2}","_TableColumnDoesNotEndWithFilterLabel2.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter. The ${value2} is replaced by the second value used to filter.","TableColumnContainsFilterLabel1":"I applied a filter on \'${columnName}\' to show only rows where the value contains ${value1}","_TableColumnContainsFilterLabel1.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnContainsFilterLabel2":"I applied a filter on \'${columnName}\' to show only rows where the value contains ${value1} or ${value2}","_TableColumnContainsFilterLabel2.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter. The ${value2} is replaced by the second value used to filter.","TableColumnDoesNotContainFilterLabel1":"I applied a filter on \'${columnName}\' to show only rows where the value does not contain ${value1}","_TableColumnDoesNotContainFilterLabel1.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnDoesNotContainFilterLabel2":"I applied a filter on \'${columnName}\' to show only rows where the value does not contain ${value1} and ${value2}","_TableColumnDoesNotContainFilterLabel2.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter. The ${value2} is replaced by the second value used to filter.","TableColumnIsGreaterThanFilterLabel":"I applied a filter on \'${columnName}\' to show only rows where the value is greater than ${value1}","_TableColumnIsGreaterThanFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnIsGreaterThanOrEqualToFilterLabel":"I applied a filter on \'${columnName}\' to show only rows where the value is greater than or equal to ${value1}","_TableColumnIsGreaterThanOrEqualToFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnIsLessThanFilterLabel":"I applied a filter on \'${columnName}\' to show only rows where the value is less than ${value1}","_TableColumnIsLessThanFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnIsLessThanOrEqualToFilterLabel":"I applied a filter on \'${columnName}\' to show only rows where the value is less than or equal to ${value1}","_TableColumnIsLessThanOrEqualToFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnBetweenFilterLabel":"I applied a filter on \'${columnName}\' to show only rows where the value is between ${value1} and ${value2}","_TableColumnBetweenFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the smaller value used to filter. The ${value2} is replaced by the greater value used to filter.","TableColumnNotBetweenFilterLabel":"I applied a filter on \'${columnName}\' to show only rows where the value is not between ${value1} and ${value2}","_TableColumnNotBetweenFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the smaller value used to filter. The ${value2} is replaced by the greater value used to filter.","TableColumnDynamicFilterLabel":"I applied a filter on \'${columnName}\' of table ${tableName}","_TableColumnDynamicFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableColumnTopFilterLabel":"I applied a ${direction} ${count} filter on \'${columnName}\' of table ${tableName}","_TableColumnTopFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and count variable/placeholder is replaced by a number.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableConvertToRangeLabel":"Convert table ${tableName} to range","_TableConvertToRangeLabel.comment":"Text to show in a list when a convert to range action was taken during script recording.","TableCreateAndFormatLabel":"I created and formatted a table ${tableName} on the range ${range}","_TableCreateAndFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableCreateLabel":"I created a table ${tableName} on the range ${range}","_TableCreateLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableCustomSortLabel":"I applied a custom sort to table ${tableName}","_TableCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableClearSortLabel":"I removed sorting on table ${tableName}","_TableClearSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableFilterColumnLabel":"I applied a filter on the column \'${columnName}\' of table ${tableName} to include the following values: ${values}","_TableFilterColumnLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered.  The $ and tableName variable/placeholder is replaced by the name of the table. The $ and values variable/placeholder is replaced by a comma-separated list of unique values in the column. For example, I applied a filter on column Column1 of table Table1 to include the following values: A, B, C","TableFormatLabel":"I applied a new format on table ${tableName}","_TableFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHighlightFirstColumnFilterLabel":"I changed the highlighting on first column on table ${tableName}","_TableHighlightFirstColumnFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHighlightLastColumnLabel":"I changed the highlighting on last column on table ${tableName}","_TableHighlightLastColumnLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableInsertColumnsLabel":"I inserted ${count} column(s) at column number ${columnNumber} of table ${tableName}","_TableInsertColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and count variable/placeholder is replaced by the number of columns inserted.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableInsertRowsLabel":"I inserted ${count} row(s) at row number ${rowNumber} of table ${tableName}","_TableInsertRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and count variable/placeholder is replaced by the number of rows inserted.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableReapplyFilterLabel":"Reapply filter on table ${tableName}","_TableReapplyFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRemoveColumnsLabel":"I removed ${count} column(s) at column number ${columnNumber} of table ${tableName}","_TableRemoveColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and count variable/placeholder is replaced by the number of columns removed.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRemoveRowsLabel":"I removed ${count} row(s) at row number ${rowNumber} of table ${tableName}","_TableRemoveRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and count variable/placeholder is replaced by the number of rows removed.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRenameLabel":"Rename table to ${tableName}","_TableRenameLabel.comment":"Text to show in a list when a rename table user action was taken during script recording","TableResizeLabel":"Resize table ${tableName}","_TableResizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRearrangeLabel":"Rearrange table row(s)","_TableRowsRearrangeLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableColumnsRearrangeLabel":"Rearrange table column(s)","_TableColumnsRearrangeLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableSortColumnLabel":"I sorted column ${columnNumber} of table ${tableName}","_TableSortColumnLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was sorted.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableToggleAutoFilterLabel":"I changed the AutoFilter on table ${tableName}","_TableToggleAutoFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableToggleHeaderRowLabel":"I changed the visibility of header row on table ${tableName}","_TableToggleHeaderRowLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableAddHeaderRowLabel":"I added header row on table ${tableName}","_TableAddHeaderRowLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRemoveHeaderRowLabel":"I removed header row on table ${tableName}","_TableRemoveHeaderRowLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableToggleTotalRowLabel":"I changed the visibility of total row on table ${tableName}","_TableToggleTotalRowLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableAddTotalRowLabel":"I added total row on table ${tableName}","_TableAddTotalRowLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRemoveTotalRowLabel":"I removed total row on table ${tableName}","_TableRemoveTotalRowLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","CellTextOrientationChanged":"I changed the text orientation of ${range} to ${orientation} degrees","_CellTextOrientationChanged.comment":"User-facing string describing the Excel event executed by Copilot. \'orientation\' is a number representing degrees out of 360, e.g. 45 or 90.","ColumnNameCellTextOrientationChanged":"I changed the text orientation of the column(s) \'${columnName}\' to ${orientation} degrees","_ColumnNameCellTextOrientationChanged.comment":"User-facing string describing the Excel event executed by Copilot. \'orientation\' is a number representing degrees out of 360, e.g. 45 or 90.","CellTextOrientationChangedGeneric":"Cell text orientation changed","_CellTextOrientationChangedGeneric.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeCellTextOrientationChangedLabel":"I changed the text orientation of table ${tableName} to ${orientation} degrees","_TableRangeCellTextOrientationChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table. The $ and orientation variable/placeholder is replaced by the orientation of the text in degrees.","TableBodyRangeCellTextOrientationChangedLabel":"I changed the text orientation of table ${tableName} body to ${orientation} degrees","_TableBodyRangeCellTextOrientationChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table. The $ and orientation variable/placeholder is replaced by the orientation of the text in degrees.","TableHeaderRowRangeCellTextOrientationChangedLabel":"I changed the text orientation of table ${tableName} header row to ${orientation} degrees","_TableHeaderRowRangeCellTextOrientationChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table. The $ and orientation variable/placeholder is replaced by the orientation of the text in degrees.","TableTotalRowRangeCellTextOrientationChangedLabel":"I changed the text orientation of table ${tableName} total row to ${orientation} degrees","_TableTotalRowRangeCellTextOrientationChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table. The $ and orientation variable/placeholder is replaced by the orientation of the text in degrees.","TableGeneralRangeCellTextOrientationChangedLabel":"I changed the text orientation of sub-range of table ${tableName} to ${orientation} degrees","_TableGeneralRangeCellTextOrientationChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table. The $ and orientation variable/placeholder is replaced by the orientation of the text in degrees.","TableRowsRangeCellTextOrientationChangedLabel":"I changed the text orientation of ${count} row(s) in table ${tableName} to ${orientation} degrees","_TableRowsRangeCellTextOrientationChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows. The $ and orientation variable/placeholder is replaced by the orientation of the text in degrees.","TableRowByIndexRangeCellTextOrientationChangedLabel":"I changed the text orientation of row at index ${rowIndex} in table ${tableName} to ${orientation} degrees","TableRowByIndexRangeCellTextOrientationChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row. The $ and orientation variable/placeholder is replaced by the orientation of the text in degrees.","TableColumnsRangeCellTextOrientationChangedLabel":"I changed the text orientation of ${count} column(s) in table ${tableName} to ${orientation} degrees","_TableColumnsRangeCellTextOrientationChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns. The $ and orientation variable/placeholder is replaced by the orientation of the text in degrees.","TableColumnByNameRangeCellTextOrientationChangedLabel":"I changed the text orientation of column \'${columnName}\' in table ${tableName} to ${orientation} degrees","_TableColumnByNameRangeCellTextOrientationChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column. The $ and orientation variable/placeholder is replaced by the orientation of the text in degrees.","TableColumnByIndexRangeCellTextOrientationChangedLabel":"I changed the text orientation of column at index ${columnIndex} in table ${tableName} to ${orientation} degrees","_TableColumnByIndexRangeCellTextOrientationChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column. The $ and orientation variable/placeholder is replaced by the orientation of the text in degrees.","ChartRenamed":"Rename chart","_ChartRenamed.comment":"User-facing string describing the Excel event executed by Copilot.","CommentResolved":"Resolve comment","_CommentResolved.comment":"User-facing string describing the Excel event executed by Copilot.","TableDeleted":"I deleted the table","_TableDeleted.comment":"User-facing string describing the Excel event executed by Copilot.","WorksheetCalculated":"Calculate worksheet","_WorksheetCalculated.comment":"User-facing string describing the Excel event executed by Copilot.","IntentChangeRangeBorder":"I changed the range border","_IntentChangeRangeBorder.comment":"User-facing string describing the Excel event executed by Copilot.","IntentCreateConditionalFormatColorScale":"I created a conditional format color scale","_IntentCreateConditionalFormatColorScale.comment":"User-facing string describing the Excel event executed by Copilot.","IntentCreateConditionalFormatDataBar":"I created a Conditional Format data bar","_IntentCreateConditionalFormatDataBar.comment":"User-facing string describing the Excel event executed by Copilot.","IntentCreateConditionalFormatCellValue":"I created a Conditional Format cell rules","_IntentCreateConditionalFormatCellValue.comment":"User-facing string describing the Excel event executed by Copilot.","IntentCreateConditionalFormatPreset":"I created a Conditional Format preset criteria","_IntentCreateConditionalFormatPreset.comment":"User-facing string describing the Excel event executed by Copilot.","IntentCreateConditionalFormatContainsText":"I created a Conditional Format containing text","_IntentCreateConditionalFormatContainsText.comment":"User-facing string describing the Excel event executed by Copilot.","IntentCreateConditionalFormatTopBottom":"I created a Conditional Format with Top/Bottom rules","_IntentCreateConditionalFormatTopBottom.comment":"User-facing string describing the Excel event executed by Copilot.","IntentCreateConditionalFormatCustom":"I created a Conditional Format with custom rules","_IntentCreateConditionalFormatCustom.comment":"User-facing string describing the Excel event executed by Copilot.","IntentCreateConditionalFormatIconSet":"I created a Conditional Format with icon sets","_IntentCreateConditionalFormatIconSet.comment":"User-facing string describing the Excel event executed by Copilot.","IntentSetDataValidation":"I created a data validation rule","_IntentSetDataValidation.comment":"User-facing string describing the Excel event executed by Copilot.","FixedWidthTextToColumns":"Convert fixed width text to columns","_FixedWidthTextToColumns.comment":"User-facing string describing the Excel event executed by Copilot.","IntentRangeCopyFrom":"Copy range","_IntentRangeCopyFrom.comment":"User-facing string describing the Excel event executed by Copilot.","UndoLabel":"Undo","_UndoLabel.comment":"User-facing string describing the Excel event executed by Copilot.","UnknownEventLabel":"This action is not yet recordable","_UnknownEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.","UnsupportedEventLabel":"This action cannot be recorded","_UnsupportedEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ChartAxisTitleHorizontal":"I set the axis title orientation to horizontal","_ChartAxisTitleHorizontal.comment":"Text to show in a list when axis title orientation is changed during script recording","ChartAxisTitleVertical":"I set the axis title orientation to vertical","_ChartAxisTitleVertical.comment":"Text to show in a list when axis title orientation is changed during script recording","ChartAxisDisplayUnit":"I changed the axis display unit","_ChartAxisDisplayUnit.comment":"Text to show in a list when axis display unit is changed during script recording","ChartAxisMajorGridilinesVisible":"I changed the axis major gridline visibility","_ChartAxisMajorGridilinesVisible.comment":"Text to show in a list when major gridline visibility is changed during script recording","ChartAxisMajorTickMark":"I changed the axis major tick mark","_ChartAxisMajorTickMark.comment":"Text to show in a list when major tick mark is changed during script recording","ChartAxisMinorTickMark":"I changed the axis minor tick mark","_ChartAxisMinorTickMark.comment":"Text to show in a list when minor tick mark is changed during script recording","ChartAxisMinorGridilinesVisible":"I changed the axis minor gridline visibility","_ChartAxisMinorGridilinesVisible.comment":"Text to show in a list when major gridline visibility is changed during script recording","ChartAxisTitleText":"I changed the axis title text","_ChartAxisTitleText.comment":"Text to show in a list when axis title text is changed during script recording","VisualChartAxisAxisTitleFillColoredLabel":"I set the fill color on ${axis} title to \'${newValue}\' for chart ${chartName}","_VisualChartAxisAxisTitleFillColoredLabel.comment":"Text to show in a list when the fill color for the specified axis title was changed by the ChartFormat add-in during script recording","VisualChartAxisAxisTitleFontBoldedLabel":"I set the font bold on ${axis} title to \'${newValue}\' for chart ${chartName}","_VisualChartAxisAxisTitleFontBoldedLabel.comment":"Text to show in a list when the font bold style for the specified axis title was changed by the ChartFormat add-in during script recording","VisualChartAxisAxisTitleFontColoredLabel":"I set the font color on ${axis} title to \'${newValue}\' for chart ${chartName}","_VisualChartAxisAxisTitleFontColoredLabel.comment":"Text to show in a list when a visual.SetProperty(\'PlotArea0_Axis_PrimaryValue0_AxisTitle0_FontFormat_Color\') was changed by the ChartFormat add-in during script recording","VisualChartAxisAxisTitleFontItalicizedLabel":"I set the font italic on ${axis} title to \'${newValue}\' for chart ${chartName}","_VisualChartAxisAxisTitleFontItalicizedLabel.comment":"Text to show in a list when the font italic style for the specified axis title was changed by the ChartFormat add-in during script recording","VisualChartAxisAxisTitleFontNamedLabel":"I set the font name on ${axis} title to \'${newValue}\' for chart ${chartName}","_VisualChartAxisAxisTitleFontNamedLabel.comment":"Text to show in a list when the font name for the specified axis title was changed by the ChartFormat add-in during script recording","VisualChartAxisAxisTitleFontSizedLabel":"I set the font size on ${axis} title to \'${newValue}\' for chart ${chartName}","_VisualChartAxisAxisTitleFontSizedLabel.comment":"Text to show in a list when the font size for the specified axis title was changed by the ChartFormat add-in during script recording","VisualChartAxisAxisTitleFontUnderlinedLabel":"I set the font underline on ${axis} title to \'${newValue}\' for chart ${chartName}","_VisualChartAxisAxisTitleFontUnderlinedLabel.comment":"Text to show in a list when the font underline style for the specified axis title was changed by the ChartFormat add-in during script recording","VisualChartAxisAxisTitleLineColoredLabel":"I set the line color on ${axis} title to \'${newValue}\' for chart ${chartName}","_VisualChartAxisAxisTitleLineColoredLabel.comment":"Text to show in a list when the line color for the specified axis title was changed by the ChartFormat add-in during script recording","VisualChartAxisAxisTitleTextChangedLabel":"I set the text on ${axis} title to \'${newValue}\' for chart ${chartName}","_VisualChartAxisAxisTitleTextChangedLabel.comment":"Text to show in a list when the text for the specified axis title was changed by the ChartFormat add-in during script recording","VisualChartAxisBoundsMaxChangedLabel":"I set the bounds max on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisBoundsMaxChangedLabel.comment":"Text to show in a list when the maximum value for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisBoundsMinChangedLabel":"I set the bounds min on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisBoundsMinChangedLabel.comment":"Text to show in a list when the minimum value for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisCrossesAtChangedLabel":"I set the crossesAt on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisCrossesAtChangedLabel.comment":"Text to show in a list when the specified axis position where the other axis crosses at for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisCrossesChangedLabel":"I set the crosses on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisCrossesChangedLabel.comment":"Text to show in a list when the specified axis position where the other axis crosses was changed by the ChartFormat add-in during script recording","VisualChartAxisFillColoredLabel":"I set the fill color on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisFillColoredLabel.comment":"Text to show in a list when the fill color for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisFontBoldedLabel":"I set the font bold on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisFontBoldedLabel.comment":"Text to show in a list when the font bold style for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisFontColoredLabel":"I set the font color on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisFontColoredLabel.comment":"Text to show in a list when the font color for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisFontItalicizedLabel":"I set the font italic on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisFontItalicizedLabel.comment":"Text to show in a list when the font italic style for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisFontNamedLabel":"I set the font name on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisFontNamedLabel.comment":"Text to show in a list when the font name for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisFontSizedLabel":"I set the font size on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisFontSizedLabel.comment":"Text to show in a list when the font size for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisFontUnderlinedLabel":"I set the font underline on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisFontUnderlinedLabel.comment":"Text to show in a list when the font underline style for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisLineColoredLabel":"I set the line color on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisLineColoredLabel.comment":"Text to show in a list when the line color for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisMajorGridlinesLineColoredLabel":"I set the major grid line\'s line color on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisMajorGridlinesLineColoredLabel.comment":"Text to show in a list when the line color for the specified axis major gridlines was changed by the ChartFormat add-in during script recording","VisualChartAxisMinorGridlinesLineColoredLabel":"I set the minor grid line\'s line color on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisMinorGridlinesLineColoredLabel.comment":"Text to show in a list when the line color for the specified axis minor gridlines was changed by the ChartFormat add-in during script recording","VisualChartAxisNumberFormatCodeChangedLabel":"I set the numberFormat on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisNumberFormatCodeChangedLabel.comment":"Text to show in a list when the numberFormat for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisReversePlotOrderChangedLabel":"I set the reverse plot order on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisReversePlotOrderChangedLabel.comment":"Text to show in a list when the reverse plot order for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisTickMarksMajorTypeChangedLabel":"I set the major tick mark on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisTickMarksMajorTypeChangedLabel.comment":"Text to show in a list when the type of major tick mark for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisTickMarksMinorTypeChangedLabel":"I set the minor tick mark on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisTickMarksMinorTypeChangedLabel.comment":"Text to show in a list when the type of minor tick mark for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisUnitsMajorUnitChangedLabel":"I set the units major unit on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisUnitsMajorUnitChangedLabel.comment":"Text to show in a list when the interval between two major tick marks for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisUnitsMinorUnitChangedLabel":"I set the units minor unit on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisUnitsMinorUnitChangedLabel.comment":"Text to show in a list when the interval between two minor tick marks for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartTitleFillColoredLabel":"I set the fill color on title to \'${newValue}\' for chart ${chartName}","_VisualChartTitleFillColoredLabel.comment":"Text to show in a list when the fill color of a chart title was changed by the ChartFormat add-in during script recording","VisualChartTitleFontBoldedLabel":"I set the font bold on title to \'${newValue}\' for chart ${chartName}","_VisualChartTitleFontBoldedLabel.comment":"Text to show in a list when the font bold style of a chart title was changed by the ChartFormat add-in during script recording","VisualChartTitleFontColoredLabel":"I set the font color on title to \'${newValue}\' for chart ${chartName}","_VisualChartTitleFontColoredLabel.comment":"Text to show in a list when the font color of a chart title was changed by the ChartFormat add-in during script recording","VisualChartTitleFontItalicizedLabel":"I set the font italic on title to \'${newValue}\' for chart ${chartName}","_VisualChartTitleFontItalicizedLabel.comment":"Text to show in a list when the font italic style of a chart title was changed by the ChartFormat add-in during script recording","VisualChartTitleFontNamedLabel":"I set the font name on title to \'${newValue}\' for chart ${chartName}","_VisualChartTitleFontNamedLabel.comment":"Text to show in a list when the font name of a chart title was changed by the ChartFormat add-in during script recording","VisualChartTitleFontSizedLabel":"I set the font size on title to \'${newValue}\' for chart ${chartName}","_VisualChartTitleFontSizedLabel.comment":"Text to show in a list when the font size of a chart title was changed by the ChartFormat add-in during script recording","VisualChartTitleFontUnderlinedLabel":"I set the font underline on title to \'${newValue}\' for chart ${chartName}","_VisualChartTitleFontUnderlinedLabel.comment":"Text to show in a list when the font underline style of a chart title was changed by the ChartFormat add-in during script recording","VisualChartTitleLineColoredLabel":"I set the line color on title to \'${newValue}\' for chart ${chartName}","_VisualChartTitleLineColoredLabel.comment":"Text to show in a list when the line color of a chart title was changed by the ChartFormat add-in during script recording","VisualChartTitleOverlayChangedLabel":"I set the position on title to \'${newValue}\' for chart ${chartName}","_VisualChartTitleOverlayChangedLabel.comment":"Text to show in a list when the overlay of a chart title was changed by the ChartFormat add-in during script recording","VisualChartTitleTextChangedLabel":"I set the text on title to \'${newValue}\' for chart ${chartName}","_VisualChartTitleTextChangedLabel.comment":"Text to show in a list when the text of a chart title was changed by the ChartFormat add-in during script recording","VisualLegendFillClearedLabel":"I cleared the legend fill color","_VisualLegendFillClearedLabel.comment":"Text to show in a list when the fill color of a chart legend was cleared by the ChartFormat add-in during script recording","VisualLegendFillColoredLabel":"I set the fill color on legend to \'${newValue}\' for chart ${chartName}","_VisualLegendFillColoredLabel.comment":"Text to show in a list when the fill color of a chart legend was changed by the ChartFormat add-in during script recording","VisualLegendFontBoldedLabel":"I set the font bold on legend to \'${newValue}\' for chart ${chartName}","_VisualLegendFontBoldedLabel.comment":"Text to show in a list when the font bold style of a chart legend was changed by the ChartFormat add-in during script recording","VisualLegendFontColoredLabel":"I set the font color on legend to \'${newValue}\' for chart ${chartName}","_VisualLegendFontColoredLabel.comment":"Text to show in a list when the font color of a chart legend was changed by the ChartFormat add-in during script recording","VisualLegendFontItalicizedLabel":"I set the font italic on legend to \'${newValue}\' for chart ${chartName}","_VisualLegendFontItalicizedLabel.comment":"Text to show in a list when the font italic style of a chart legend was changed by the ChartFormat add-in during script recording","VisualLegendFontNamedLabel":"I set the font name on legend to \'${newValue}\' for chart ${chartName}","_VisualLegendFontNamedLabel.comment":"Text to show in a list when font name of a chart legend was changed by the ChartFormat add-in during script recording","VisualLegendFontSizedLabel":"I set the font size on legend to \'${newValue}\' for chart ${chartName}","_VisualLegendFontSizedLabel.comment":"Text to show in a list when font size of a chart legend was changed by the ChartFormat add-in during script recording","VisualLegendFontUnderlinedLabel":"I set the font underline on legend to \'${newValue}\' for chart ${chartName}","_VisualLegendFontUnderlinedLabel.comment":"Text to show in a list when font underline style of a chart legend was changed by the ChartFormat add-in during script recording","VisualLegendLineClearedLabel":"I cleared the legend line color","_VisualLegendLineClearedLabel.comment":"Text to show in a list when the line color of a chart legend was cleared by the ChartFormat add-in during script recording","VisualLegendLineStyleChangedLabel":"I changed the legend line style","_VisualLegendLineStyleChangedLabel.comment":"Text to show in a list when the line style of a chart legend was changed by the ChartFormat add-in during script recording","VisualLegendLineWeightChangedLabel":"I cleared the legend line weight","_VisualLegendLineWeightChangedLabel.comment":"Text to show in a list when the line weight of a chart legend was changed by the ChartFormat add-in during script recording","VisualLegendLineColoredLabel":"I set the line color on legend to \'${newValue}\' for chart ${chartName}","_VisualLegendLineColoredLabel.comment":"Text to show in a list when the line color of a chart legend was changed by the ChartFormat add-in during script recording","VisualLegendOverlayChangedLabel":"I set the overlay on legend to \'${newValue}\' for chart ${chartName}","_VisualLegendOverlayChangedLabel.comment":"Text to show in a list when the overlay of a chart legend was changed by the ChartFormat add-in during script recording","VisualSeriesBinningOptionsBinCountLabel":"I set the binOptions\' count on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBinningOptionsBinCountLabel.comment":"Text to show in a list when the binOptions\' count property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBinningOptionsBinWidthLabel":"I set the binOption\'s width on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBinningOptionsBinWidthLabel.comment":"Text to show in a list when the binOptions\' width property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBinningOptionsBinningTypeLabel":"I set the binOption\'s type on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBinningOptionsBinningTypeLabel.comment":"Text to show in a list when the binOptions\' type property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBinningOptionsOverflowEnabledLabel":"I set the binOption\'s allowOverflow on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBinningOptionsOverflowEnabledLabel.comment":"Text to show in a list when the binOptions\' allowOverflow property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBinningOptionsOverflowValueLabel":"I set the binOption\'s overflowValue on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBinningOptionsOverflowValueLabel.comment":"Text to show in a list when the binOptions\' overflowValue property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBinningOptionsUnderflowEnabledLabel":"I set the binOption\'s allowUnderflow on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBinningOptionsUnderflowEnabledLabel.comment":"Text to show in a list when the binOptions\' allowUnderflow property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBinningOptionsUnderflowValueLabel":"I set the binOption\'s underflowValue on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBinningOptionsUnderflowValueLabel.comment":"Text to show in a list when the binOptions\' underflowValue property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBoxWhiskerQuartileCalculationLabel":"I set the boxwhiskerOptions\'s quartileCalculation on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBoxWhiskerQuartileCalculationLabel.comment":"Text to show in a list when the boxwhiskerOptions\' quartileCalculation property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBoxWhiskerShowInnerPointsLabel":"I set the boxwhiskerOptions\'s showInnerPoints on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBoxWhiskerShowInnerPointsLabel.comment":"Text to show in a list when the boxwhiskerOptions\' showInnerPoints property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBoxWhiskerShowMeanLineLabel":"I set the boxwhiskerOptions\'s showMeanLine on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBoxWhiskerShowMeanLineLabel.comment":"Text to show in a list when the boxwhiskerOptions\' showMeanLine property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBoxWhiskerShowMeanMarkerLabel":"I set the boxwhiskerOptions\'s showMeanMarker on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBoxWhiskerShowMeanMarkerLabel.comment":"Text to show in a list when the boxwhiskerOptions\' showMeanMarker property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBoxWhiskerShowOutliersLabel":"I set the boxwhiskerOptions\'s showOutlierPoints on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBoxWhiskerShowOutliersLabel.comment":"Text to show in a list when the boxwhiskerOptions\' showOutlierPoints property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBubbleScaleSizedLabel":"I set the bubbleScale on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBubbleScaleSizedLabel.comment":"Text to show in a list when the bubbleScale property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesDataLabelsContainsCategoryNameToggledLabel":"I set the visibility of the data label category name on the series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsContainsCategoryNameToggledLabel.comment":"Text to show in a list when the visibility of the data label category name on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsContainsCustomSeparatorChangedLabel":"I set the separator used for the data label on the series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsContainsCustomSeparatorChangedLabel.comment":"Text to show in a list when the separator used for the data label on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsContainsLegendKeyToggledLabel":"I set the visibility of the data label legend key on the series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsContainsLegendKeyToggledLabel.comment":"Text to show in a list when the visibility of the data label legend key on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsContainsSeparatorChangedLabel":"I set the predefined separator of the data label on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsContainsSeparatorChangedLabel.comment":"Text to show in a list when the predefined separator of the data label on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsContainsSeriesNameToggledLabel":"I set the visibility of the data label series name on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsContainsSeriesNameToggledLabel.comment":"Text to show in a list when the data label series name on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsContainsValueToggledLabel":"I set the visibility of the data label value on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsContainsValueToggledLabel.comment":"Text to show in a list when the data label value on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsFillFormatColoredLabel":"I set the data label\'s fill color on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsFillFormatColoredLabel.comment":"Text to show in a list when the data label\'s fill color on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsFontFormatBoldedLabel":"I set the data label\'s font bold style on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsFontFormatBoldedLabel.comment":"Text to show in a list when the data label\'s font bold style on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsFontFormatColoredLabel":"I set the data label\'s font color on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsFontFormatColoredLabel.comment":"Text to show in a list when the data label\'s font color on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsFontFormatItaliizedcLabel":"I set the data label\'s font italic style on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsFontFormatItaliizedcLabel.comment":"Text to show in a list when the data label\'s font italic style on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsFontFormatNamedLabel":"I set the data label\'s font name on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsFontFormatNamedLabel.comment":"Text to show in a list when the data label\'s font name on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsFontFormatSizedLabel":"I set the data label\'s font size for chart ${chartName}","_VisualSeriesDataLabelsFontFormatSizedLabel.comment":"Text to show in a list when the data label\'s font size on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsFontFormatUnderlinedLabel":"I set the data label\'s font underline style on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsFontFormatUnderlinedLabel.comment":"Text to show in a list when the data label\'s font underline style on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsLineFormatColoredLabel":"I set the data label\'s line color on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsLineFormatColoredLabel.comment":"Text to show in a list when the data label\'s line color on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsNumberFormatCodeChangedLabel":"I set the data label\'s number format on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsNumberFormatCodeChangedLabel.comment":"Text to show in a list when the data label\'s number format on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsPositionedLabel":"I set the data label\'s position on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsPositionedLabel.comment":"Text to show in a list when the data label\'s position on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDoughnutHoleSizedLabel":"I set the dough nut hole size on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDoughnutHoleSizedLabel.comment":"Text to show in a list when the doughnut hole size of a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesFillColoredLabel":"I set the fill color on series ${seriesIndex} for chart ${chartName}","_VisualSeriesFillColoredLabel.comment":"Text to show in a list when the fill color of a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesGapWidthChangedLabel":"I set the gap width on series for chart ${chartName}","_VisualSeriesGapWidthChangedLabel.comment":"Text to show in a list when the gap width of a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesLineColoredLabel":"I set the line color on series ${seriesIndex} for chart ${chartName}","_VisualSeriesLineColoredLabel.comment":"Text to show in a list when the line color of a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesMakersFillColoredLabel":"I set the markers fill color on series ${seriesIndex} for chart ${chartName}","_VisualSeriesMakersFillColoredLabel.comment":"Text to show in a list when the markers background color of a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesMakersLineColoredLabel":"I set the markers line color on series ${seriesIndex} for chart ${chartName}","_VisualSeriesMakersLineColoredLabel.comment":"Text to show in a list when the markers foreground color of a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesMakersMarkerSizedLabel":"I set the maker size on series ${seriesIndex} for chart ${chartName}","_VisualSeriesMakersMarkerSizedLabel.comment":"Text to show in a list when the marker size of a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesMakersMarkerStyleChangedLabel":"I set the maker style on series ${seriesIndex} for chart ${chartName}","_VisualSeriesMakersMarkerStyleChangedLabel.comment":"Text to show in a list when the marker style of a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesNamedLabel":"I set the name on series ${seriesIndex} for chart ${chartName}","_VisualSeriesNamedLabel.comment":"Text to show in a list when the name property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesTreemapParentLabelStrategyLabel":"I set the parentLabelStrategy on series ${seriesIndex} for chart ${chartName}","_VisualSeriesTreemapParentLabelStrategyLabel.comment":"Text to show in a list when the parentLabelStrategy property for a treemap chart series was changed by the ChartFormat add-in during script recording","VisualSeriesVaryColorsBySliceChangedLabel":"I set the vary color by slice on series ${seriesIndex} for chart ${chartName}","_VisualSeriesVaryColorsBySliceChangedLabel.comment":"Text to show in a list when the varyByCategories property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesWaterfallShowConnectorLinesLabel":"I set the showConnectorLines on series ${seriesIndex} for chart ${chartName}","_VisualSeriesWaterfallShowConnectorLinesLabel.comment":"Text to show in a list when the showConnectorLines property for a waterfall chart series was changed by the ChartFormat add-in during script recording","VisualSeriesTrendlineTypeSetLabel":"I set the trendline type on series ${seriesIndex} for chart ${chartName}","_VisualSeriesTrendlineTypeSetLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and seriesIndex variable/placeholder is replaced by the index of the series which was operated on.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualSeriesTrendlineNameChangedLabel":"I set the trendline name on series ${seriesIndex} for chart ${chartName}","_VisualSeriesTrendlineNameChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and seriesIndex variable/placeholder is replaced by the index of the series which was operated on.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualSeriesTrendlineEquationDisplayedLabel":"I set the trendline equation visibility on series ${seriesIndex} for chart ${chartName}","_VisualSeriesTrendlineEquationDisplayedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and seriesIndex variable/placeholder is replaced by the index of the series which was operated on.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualSeriesTrendlineRSquaredDisplayedLabel":"I set the trendline R squared visibility on series ${seriesIndex} for chart ${chartName}","_VisualSeriesTrendlineRSquaredDisplayedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and seriesIndex variable/placeholder is replaced by the index of the series which was operated on.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualSeriesTrendlineInterceptSetLabel":"I set the trendline intercept on series ${seriesIndex} for chart ${chartName}","_VisualSeriesTrendlineInterceptSetLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and seriesIndex variable/placeholder is replaced by the index of the series which was operated on.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualSeriesTrendlineManualSetLabel":"I set the trendline intercept manually on series ${seriesIndex} for chart ${chartName}","_VisualSeriesTrendlineManualSetLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and seriesIndex variable/placeholder is replaced by the index of the series which was operated on.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualSeriesTrendlineAutomaticSetLabel":"I set the trendline intercept automatically on series ${seriesIndex} for chart ${chartName}","_VisualSeriesTrendlineAutomaticSetLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and seriesIndex variable/placeholder is replaced by the index of the series which was operated on.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualSeriesTrendlineLineFormatColoredLabel":"I set the trendline\'s line color on series ${seriesIndex} for chart ${chartName}","_VisualSeriesTrendlineLineFormatColoredLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and seriesIndex variable/placeholder is replaced by the index of the series which was operated on.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualSeriesTrendlineForecastForwardSetLabel":"I set the trendline forward forecast on series ${seriesIndex} for chart ${chartName}","_VisualSeriesTrendlineForecastForwardSetLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and seriesIndex variable/placeholder is replaced by the index of the series which was operated on.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualSeriesTrendlineForecastBackwardSetLabel":"I set the trendline backward forecast on series ${seriesIndex} for chart ${chartName}","_VisualSeriesTrendlineForecastBackwardSetLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and seriesIndex variable/placeholder is replaced by the index of the series which was operated on.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualChartTitleAddedRemovedLabel":"I changed the visibility of title for chart ${chartName}","_VisualChartTitleAddedRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualChartTitleAddedLabel":"I added title for chart ${chartName}","_VisualChartTitleAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualChartTitleRemovedLabel":"I removed title for chart ${chartName}","_VisualChartTitleRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualLegendAddedRemovedLabel":"I changed the visibility of legend for chart ${chartName}","_VisualLegendAddedRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualLegendAddedLabel":"I added legend for chart ${chartName}","_VisualLegendAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualLegendRemovedLabel":"I removed legend for chart ${chartName}","_VisualLegendRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualChartAxisAxisTitleAddedRemovedLabel":"I changed the visibility of ${axis} title for chart ${chartName}","_VisualChartAxisAxisTitleAddedRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and axis variable/placeholder is replaced by the type of axis.","VisualChartAxisAxisTitleAddedLabel":"I added ${axis} title for chart ${chartName}","_VisualChartAxisAxisTitleAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and axis variable/placeholder is replaced by the type of axis.","VisualChartAxisAxisTitleRemovedLabel":"I removed ${axis} title for chart ${chartName}","_VisualChartAxisAxisTitleRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and axis variable/placeholder is replaced by the type of axis.","VisualChartAxisGridlinesMajorGridlinesAddedRemovedLabel":"I changed the visibility of ${axis} major grid lines for chart ${chartName}","_VisualChartAxisGridlinesMajorGridlinesAddedRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and axis variable/placeholder is replaced by the type of axis.","VisualChartAxisGridlinesMajorGridlinesAddedLabel":"I added ${axis} major grid lines for chart ${chartName}","_VisualChartAxisGridlinesMajorGridlinesAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and axis variable/placeholder is replaced by the type of axis.","VisualChartAxisGridlinesMajorGridlinesRemovedLabel":"I removed ${axis} major grid lines for chart ${chartName}","_VisualChartAxisGridlinesMajorGridlinesRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and axis variable/placeholder is replaced by the type of axis.","VisualChartAxisGridlinesMinorGridlinesAddedRemovedLabel":"I changed the visibility of ${axis} minor grid lines for chart ${chartName}","_VisualChartAxisGridlinesMinorGridlinesAddedRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and axis variable/placeholder is replaced by the type of axis.","VisualChartAxisGridlinesMinorGridlinesAddedLabel":"I added ${axis} minor grid lines for chart ${chartName}","_VisualChartAxisGridlinesMinorGridlinesAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and axis variable/placeholder is replaced by the type of axis.","VisualChartAxisGridlinesMinorGridlinesRemovedLabel":"I removed ${axis} minor grid lines for chart ${chartName}","_VisualChartAxisGridlinesMinorGridlinesRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and axis variable/placeholder is replaced by the type of axis.","VisualSerriesErrorBarXAddedRemovedLabel":"I changed the visibility of horizontal error bars on series ${seriesIndex} for chart ${chartName}","_VisualSerriesErrorBarXAddedRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index.","VisualSeriesErrorBarXAddedLabel":"I added horizontal error bars on series ${seriesIndex} for chart ${chartName}","_VisualSeriesErrorBarXAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index.","VisualSeriesErrorBarXRemovedLabel":"I removed horizontal error bars on series ${seriesIndex} for chart ${chartName}","_VisualSeriesErrorBarXRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index.","VisualSerriesErrorBarYAddedRemovedLabel":"I changed the visibility of vertical error bars on series ${seriesIndex} for chart ${chartName}","_VisualSerriesErrorBarYAddedRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index.","VisualSeriesErrorBarYAddedLabel":"I added vertical error bars on series ${seriesIndex} for chart ${chartName}","_VisualSeriesErrorBarYAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index.","VisualSeriesErrorBarYRemovedLabel":"I removed vertical error bars on series ${seriesIndex} for chart ${chartName}","_VisualSeriesErrorBarYRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index.","VisualSerriesTrendlineAddedLabel":"Add trendline to series ${seriesIndex} of chart ${chartName}","_VisualSerriesTrendlineAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index.","VisualSerriesTrendlineRemovedLabel":"I removed the trendline ${trendlineIndex} from series ${seriesIndex} of chart ${chartName}","_VisualSerriesTrendlineRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index.  The $ and trendlineIndex variable/placeholder is replaced by the trendline index.","VisualSeriesTrendlineTitleAddedLabel":"Add a equation to trendline ${trendlineIndex} of series ${seriesIndex} of chart ${chartName}","_VisualSeriesTrendlineTitleAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index. The $ and trendlineIndex variable/placeholder is replaced by the trendline index.","VisualSeriesTrendlineTitleRemovedLabel":"I removed the equation and/or R Squared value from trendline ${trendlineIndex} of series ${seriesIndex} of chart ${chartName}","_VisualSeriesTrendlineTitleRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index. The $ and trendlineIndex variable/placeholder is replaced by the trendline index.","VisualSeriesDataLabelsAddedRemovedLabel":"I changed the visibility of data labels on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsAddedRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index.","VisualSeriesDataLabelsAddedLabel":"I added data labels on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index.","VisualSeriesDataLabelsRemovedLabel":"I removed data labels on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index.","ChartTitleFillClearedLabel":"Chart title fill cleared","_ChartTitleFillClearedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ChartTitleLineClearedLabel":"Chart title line cleared","_ChartTitleLineClearedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ChartTitleLineStyleChangedLabel":"Chart title line style changed","_ChartTitleLineStyleChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ChartTitleWeightChangedLabel":"Chart title line weight changed","_ChartTitleWeightChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","WorkbookRecalculateLabel":"Recalculate workbook","_WorkbookRecalculateLabel.comment":"User-facing string describing the Excel event executed by Copilot.","WorkbookRefreshAllLabel":"Refresh all data connections in workbook","_WorkbookRefreshAllLabel.comment":"Text to show in a list when a refresh all user action was taken during script recording.","WorkbookSetCalculationModeLabel":"I set the calculation mode","_WorkbookSetCalculationModeLabel.comment":"User-facing string describing the Excel event executed by Copilot.","WorksheetAddLabel":"Add worksheet","_WorksheetAddLabel.comment":"User-facing string describing the Excel event executed by Copilot.","WorksheetAddedWithNameLabel":"Add worksheet with name ${worksheetName}","_WorksheetAddedWithNameLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and worksheetName variable/placeholder is replaced by the new name of the worksheet.","WorksheetChartAxisTitleChangeTextLabel":"I changed the title of axis for chart ${chartName} on sheet ${sheet}","_WorksheetChartAxisTitleChangeTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetCharTitleChangeTextLabel":"I changed the title of chart ${chartName} on sheet ${sheet}","_WorksheetCharTitleChangeTextLabel.comment":"User-facing string describing the Excel event executed by Copilot. The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on. The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetChartChangeAxisLabel":"I changed the axis for chart ${chartName} on sheet ${sheet}","_WorksheetChartChangeAxisLabel.comment":"Text to show in a list when a change Chart axis user action was taken during script recording","WorksheetChartChangeAxisTitleLabel":"I changed the title of axis for chart ${chartName} on sheet ${sheet}","_WorksheetChartChangeAxisTitleLabel.comment":"Text to show in a list when a change Chart axis title user action was taken during script recording","WorksheetChartChangeAxisVisibilityLabel":"I changed the visibility of axis for chart ${chartName} on sheet ${sheet}","_WorksheetChartChangeAxisVisibilityLabel.comment":"Text to show in a list when a change Chart axis visibility user action was taken during script recording","WorksheetChartAddAxisLabel":"I added axis for chart ${chartName} on sheet ${sheet}","_WorksheetChartAddAxisLabel.comment":"Text to show in a list when a change Chart axis visibility user action was taken during script recording","WorksheetChartRemoveAxisLabel":"I removed axis for chart ${chartName} on sheet ${sheet}","_WorksheetChartRemoveAxisLabel.comment":"Text to show in a list when a change Chart axis visibility user action was taken during script recording","WorksheetChartChangeGridlineVisiblityLabel":"I changed the visibility of gridlines for chart ${chartName} on sheet ${sheet}","_WorksheetChartChangeGridlineVisiblityLabel.comment":"Text to show in a list when a change Chart gridlines visibility user action was taken during script recording","WorksheetChartAddGridlineLabel":"I added gridlines for chart ${chartName} on sheet ${sheet}","_WorksheetChartAddGridlineLabel.comment":"Text to show in a list when a change Chart gridlines visibility user action was taken during script recording","WorksheetChartRemoveGridlineLabel":"I removed gridlines for chart ${chartName} on sheet ${sheet}","_WorksheetChartRemoveGridlineLabel.comment":"Text to show in a list when a change Chart gridlines visibility user action was taken during script recording","WorksheetChartChangeLegendLabel":"I changed the legend for chart ${chartName} on sheet ${sheet}","_WorksheetChartChangeLegendLabel.comment":"Text to show in a list when a change Chart legend user action was taken during script recording","WorksheetChartChangeTitleLabel":"I changed the title for chart ${chartName} on sheet ${sheet}","_WorksheetChartChangeTitleLabel.comment":"Text to show in a list when a Change Chart Title user action was taken during script recording","WorksheetChartChangeTypeLabel":"I changed the chart type for ${chartName} on sheet ${sheet}","_WorksheetChartChangeTypeLabel.comment":"Text to show in a list when a Change Chart Type user action was taken during script recording","WorksheetChartDataLabelChangePositionLabel":"I changed the position of data label for chart ${chartName} on sheet ${sheet}","_WorksheetChartDataLabelChangePositionLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetChartDataLabelChangeVisibilityLabel":"I changed the visibility of data label for chart ${chartName} on sheet ${sheet}","_WorksheetChartDataLabelChangeVisibilityLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetChartDataLabelAddedLabel":"I added data label for chart ${chartName} on sheet ${sheet}","_WorksheetChartDataLabelAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetChartDataLabelRemovedLabel":"I removed data label for chart ${chartName} on sheet ${sheet}","_WorksheetChartDataLabelRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetChartDeleteLabel":"I deleted the chart ${chartName} on sheet ${sheet}","_WorksheetChartDeleteLabel.comment":"Text to show in a list when a chart delete user action was taken during script recording","WorksheetChartHideAxisTitleLabel":"I hid the title of axis for chart ${chartName} on sheet ${sheet}","_WorksheetChartHideAxisTitleLabel.comment":"Text to show in a list when a hide Chart axis title user action was taken during script recording","WorksheetChartHideLegendLabel":"I hid the legend for chart ${chartName} on sheet ${sheet}","_WorksheetChartHideLegendLabel.comment":"Text to show in a list when a change Chart legend user action was taken during script recording","WorksheetChartHideTitleLabel":"I hid the title for chart ${chartName} on sheet ${sheet}","_WorksheetChartHideTitleLabel.comment":"Text to show in a list when a Hide Chart Title user action was taken during script recording","WorksheetChartMoveAndResizeLabel":"Move or resize chart ${chartName} on sheet ${sheet}","_WorksheetChartMoveAndResizeLabel.comment":"Text to show in a list when a chart move or resize user action was taken during script recording","WorksheetChartSelectDataLabel":"Select data for chart ${chartName} on sheet ${sheet}","_WorksheetChartSelectDataLabel.comment":"Text to show in a list when a Select Chart Data user action was taken during script recording","WorksheetChartSwitchRowColumnLabel":"Switch row/column for chart ${chartName} on sheet ${sheet}","_WorksheetChartSwitchRowColumnLabel.comment":"Text to show in a list when a Switch Chart Row and Column user action was taken during script recording","WorksheetClearFiltersLabel":"I cleared the filters on worksheet ${sheet}","_WorksheetClearFiltersLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetClearTabColorLabel":"I cleared the worksheet tab color on worksheet ${sheet}","_WorksheetClearTabColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetCreateChartLabel":"I created a chart on worksheet ${sheet}","_WorksheetCreateChartLabel.comment":"Text to show in a list when a Create Chart user action was taken during script recording","SlicerInsertedLabel":"I created a slicer with pivot ${pivotName} from pivot table ${pivotTable}","_SlicerInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and pivotName variable/placeholder is replaced by the name of the pivot the slicer is associated with.  The $ and pivotTable variable/placeholder is replaced by the name of the source pivot table","WorksheetTableRangeCreateChartLabel":"I created a chart on worksheet ${sheet} with source data from table ${table}","_WorksheetTableRangeCreateChartLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet the chart was inserted on.  The $ and table variable/placeholder is replaced by the name of the source data table","WorksheetCustomFilterAppliedLabel":"I applied a custom filter to ${range}","_WorksheetCustomFilterAppliedLabel.comment":"Text to show in a list when a worksheet custom filter user action was taken during script recording","WorksheetDeleteLabel":"I deleted the worksheet","_WorksheetDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.","WorksheetDeleteMultipleLabel":"I deleted ${count} worksheets","_WorksheetDeleteMultipleLabel.comment":"User-facing string describing the Excel event executed by Copilot. The $ and count variable/placeholder is replaced by the number of sheets deleted","WorksheetDuplicateLabel":"Duplicate worksheet ${sheet}","_WorksheetDuplicateLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the duplicated sheet.","WorksheetDynamicFilterAppliedLabel":"I applied a dynamic filter to ${range}","_WorksheetDynamicFilterAppliedLabel.comment":"Text to show in a list when a worksheet dynamic filter user action was taken during script recording","WorksheetFloatingObjectDeleteLabel":"I deleted the object on sheet ${sheet}","_WorksheetFloatingObjectDeleteLabel.comment":"Text to show in a list when an object delete user action was taken during script recording","WorksheetFloatingObjectMoveAndResizeLabel":"Move or resize object on sheet ${sheet}","_WorksheetFloatingObjectMoveAndResizeLabel.comment":"Text to show in a list when an object move or resize user action was taken during script recording","WorksheetFloatingObjectZOrderChangedLabel":"I changed the z-order of object on sheet ${sheet}","_WorksheetFloatingObjectZOrderChangedLabel.comment":"Text to show in a list when an object change z-order type user action was taken during script recording","WorksheetFreezePaneLabel":"Freeze worksheet panes","_WorksheetFreezePaneLabel.comment":"Text to show in a list when a worksheet pane freeze user action was taken during script recording","WorksheetFreezeRowsLabel":"Freeze worksheet rows","_WorksheetFreezeRowsLabel.comment":"Text to show in a list when a worksheet row freeze user action was taken during script recording","WorksheetFreezeColumnsLabel":"Freeze worksheet columns","_WorksheetFreezeColumnsLabel.comment":"Text to show in a list when a worksheet column freeze user action was taken during script recording","WorksheetHideGridlinesLabel":"I hid the gridlines on worksheet ${sheet}","_WorksheetHideGridlinesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetHideHeadingsLabel":"I hid the headings on worksheet ${sheet}","_WorksheetHideHeadingsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetOutlineLevelsSetLabel":"I set the outline level on sheet ${sheet}","_WorksheetOutlineLevelsSetLabel.comment":"Text to show in a list when an outline set user action was taken during script recording","WorksheetReapplyFiltersLabel":"Reapply filters on worksheet ${sheet}","_WorksheetReapplyFiltersLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetRenameLabel":"Rename worksheet to ${worksheetName}","_WorksheetRenameLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and worksheetName variable/placeholder is replaced by the new name of the worksheet.","WorksheetReorderLabel":"Reorder worksheet ${sheet}","_WorksheetReorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetSetTabColorLabel":"I set the worksheet tab color to ${color} on worksheet ${sheet}","_WorksheetSetTabColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new tab color.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetShapeAltTextApplyLabel":"I applied an alt text to shape on sheet ${sheet}","_WorksheetShapeAltTextApplyLabel.comment":"Text to show in a list when an shape alt text apply user action was taken during script recording","WorksheetShapeInsertedLabel":"I created a shape on sheet ${sheet}","_WorksheetShapeInsertedLabel.comment":"Text to show in a list when a create shape user action was taken during script recording","WorksheetShapeRotateLabel":"Rotate shape on sheet ${sheet}","_WorksheetShapeRotateLabel.comment":"Text to show in a list when an shape rotate user action was taken during script recording","WorksheetShapeSetStyleLabel":"I set the style on shape on sheet ${sheet}","_WorksheetShapeSetStyleLabel.comment":"Text to show in a list when a shape set style user action was taken during script recording","WorksheetShapeTextChangedLabel":"I set the text on shape on sheet ${sheet}","_WorksheetShapeTextChangedLabel.comment":"Text to show in a list when a shape text changed user action was taken during script recording","WorksheetShapeTextBoldedLabel":"I bolded the text of shape on sheet ${sheet}","_WorksheetShapeTextBoldedLabel.comment":"Text to show in a list when bold style for text of a shape was changed during script recording","WorksheetShapeTextUnboldedLabel":"I unbolded the text of shape on sheet ${sheet}","_WorksheetShapeTextUnboldedLabel.comment":"Text to show in a list when bold style for text of a shape was changed during script recording","WorksheetShapeTextItalicizedLabel":"I italicized the text of shape on sheet ${sheet}","_WorksheetShapeTextItalicizedLabel.comment":"Text to show in a list when italic style for text of a shape was changed during script recording","WorksheetShapeTextUnitalicizedLabel":"I removed italics from text of shape on sheet ${sheet}","_WorksheetShapeTextUnitalicizedLabel.comment":"Text to show in a list when italic style for text of a shape was changed during script recording","WorksheetShapeTextUnderlinedLabel":"I underlined the text of shape on sheet ${sheet}","_WorksheetShapeTextUnderlinedLabel.comment":"Text to show in a list when underline style for text of a shape was changed during script recording","WorksheetShapeTextUnderlineRemovedLabel":"I removed underlining from text of shape on sheet ${sheet}","_WorksheetShapeTextUnderlineRemovedLabel.comment":"Text to show in a list when underline style for text of a shape was changed during script recording","WorksheetShapeTextFontNameChangedLabel":"I set the font name to ${fontName} for shape on sheet ${sheet}","_WorksheetShapeTextFontNameChangedLabel.comment":"Text to show in a list when font name for text of a shape was changed during script recording","WorksheetShapeTextFontSizeChangedLabel":"I set the font size to ${fontSize} for shape on sheet ${sheet}","_WorksheetShapeTextFontSizeChangedLabel.comment":"Text to show in a list when font size for text of a shape was changed during script recording","WorksheetShapeTextFontColorChangedLabel":"I set the font color to ${fontColor} for shape on sheet ${sheet}","_WorksheetShapeTextFontColorChangedLabel.comment":"Text to show in a list when font color for text of a shape was changed during script recording","WorksheetShapeTextHorizontallyAlignedLabel":"I set the horizontal alignment on shape on sheet ${sheet}","_WorksheetShapeTextHorizontallyAlignedLabel.comment":"Text to show in a list when horiontal alignment for text of a shape was changed during script recording","WorksheetShapeTextVerticallyAlignedLabel":"I set the vertical alignment on shape on sheet ${sheet}","_WorksheetShapeTextVerticallyAlignedLabel.comment":"Text to show in a list when vertical alignment for text of a shape was changed during script recording","WorksheetShowGridlinesLabel":"Show gridlines on worksheet ${sheet}","_WorksheetShowGridlinesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetShowHeadingsLabel":"Show headings on worksheet ${sheet}","_WorksheetShowHeadingsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetToggleAutoFilterLabel":"I changed the AutoFilter on worksheet ${sheet}","_WorksheetToggleAutoFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetUnFreezePaneLabel":"Unfreeze worksheet panes","_WorksheetUnFreezePaneLabel.comment":"Text to show in a list when a worksheet pane unfreeze user action was taken during script recording","WorksheetValuesFilterAppliedLabel":"I applied a values filter to ${range}","_WorksheetValuesFilterAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","WorksheetVisibilityChangedLabel":"I changed the worksheet visibility","_WorksheetVisibilityChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","MoveToEdgeLabel":"Select data region","_MoveToEdgeLabel.comment":"User-facing string describing the Excel event executed by Copilot.","WorksheetCellColorFilterLabel":"I applied a cell color filter on ${range} to show only rows that are highlighted ${color}","_WorksheetCellColorFilterLabel.comment":"String which will be sent to Flex to describe the outcome of the filter event","WorksheetFontColorFilterLabel":"I applied a font color filter on ${range} to show only rows that contain ${color} text","_WorksheetFontColorFilterLabel.comment":"String which will be sent to Flex to describe the outcome of the filter event","WorksheetTopItemsFilterLabel":"I applied a top ${criterion} filter on ${range}","_WorksheetTopItemsFilterLabel.comment":"String which will be sent to Flex to describe the outcome of the filter event","WorksheetTopPercentFilterLabel":"I applied a top ${criterion}% filter on ${range}","_WorksheetTopPercentFilterLabel.comment":"String which will be sent to Flex to describe the outcome of the filter event","WorksheetBottomItemsFilterLabel":"I applied a bottom ${criterion} filter on ${range}","_WorksheetBottomItemsFilterLabel.comment":"String which will be sent to Flex to describe the outcome of the filter event","WorksheetBottomPercentFilterLabel":"I applied a bottom ${criterion}% filter on ${range}","_WorksheetBottomPercentFilterLabel.comment":"String which will be sent to Flex to describe the outcome of the filter event","WorksheetDefaultFilterLabel":"I applied a top ${criterion} filter on ${range}","_WorksheetDefaultFilterLabel.comment":"String which will be sent to Flex to describe the outcome of the filter event","WorksheetRangeClearFiltersLabel":"I removed all filters on ${range}","_WorksheetRangeClearFiltersLabel.comment":"String which will be sent to Flex to describe the outcome of the filter event","WorksheetColumnClearFilterLabel":"I removed a filter on ${range}","_WorksheetColumnClearFilterLabel.comment":"String which will be sent to Flex to describe the outcome of the filter event"}}')},731531:e=>{"use strict";if("undefined"==typeof perf_hooks){var t=new Error("Cannot find module 'perf_hooks'");throw t.code="MODULE_NOT_FOUND",t}e.exports=perf_hooks},738648:(e,t,n)=>{"use strict";n.d(t,{sA:()=>i});var a=n(208520);function o(e,t,n){return e.split(t).map(((e,t)=>t%2==0?e:n(e,t))).filter((e=>null!==e&&""!==e))}function r(e,t){return function(e,t){const n=/\{(\d+)\}/,a=/\{(\w+)\}/;if(Array.isArray(t))return o(e,n,(e=>{const n=parseInt(e,10);return n>=0&&n<t.length?t[n]:`{${e}}`}));return o(e,a,(e=>e in t?t[e]:`{${e}}`))}(e,t)}const i=({message:e,values:t})=>a.createElement(a.Fragment,null,a.Children.toArray(r(e,t)))},749832:(e,t,n)=>{"use strict";n.d(t,{V:()=>r,z:()=>o});var a=n(207545);const o={...a.zj,CopilotStartPromptCellRow:"CopilotStartPromptCellRow",CopilotStartPromptCellCol:"CopilotStartPromptCellCol",InsightsEndpoint:"InsightsEndpoint",HasActivePythonLicense:"HasActivePythonLicense",CopilotAgentToLoadAfterLaunch:"agentId",CopilotAgentToLoadAfterLaunchLegacy:"AgentId",IsPythonExecutionBlockedByAdmin:"IsPythonExecutionBlockedByAdmin",AutoOpenChatPane:"AutoOpenChatPane",ButtonEnabledForLocalFiles:"ButtonEnabledForLocalFiles",ShouldUseEnvSpecificALUrl:"ShouldUseEnvSpecificALUrl",ExcelSdxPrivateApiEnabled:"ExcelSdxPrivateApiEnabled",CopilotLicenseStatus:"CopilotLicenseStatus"};class r extends a.kH{}},754577:(e,t)=>{"use strict";function n(e){return 14+(e+64>>>9<<4)+1}function a(e,t){const n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function o(e,t,n,o,r,i){return a((l=a(a(t,e),a(o,i)))<<(s=r)|l>>>32-s,n);var l,s}function r(e,t,n,a,r,i,l){return o(t&n|~t&a,e,t,r,i,l)}function i(e,t,n,a,r,i,l){return o(t&a|n&~a,e,t,r,i,l)}function l(e,t,n,a,r,i,l){return o(t^n^a,e,t,r,i,l)}function s(e,t,n,a,r,i,l){return o(n^(t|~a),e,t,r,i,l)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return function(e){const t=new Uint8Array(4*e.length);for(let n=0;n<4*e.length;n++)t[n]=e[n>>2]>>>n%4*8&255;return t}(function(e,t){const o=new Uint32Array(n(t)).fill(0);o.set(e),o[t>>5]|=128<<t%32,o[o.length-1]=t,e=o;let c=1732584193,d=-271733879,u=-1732584194,m=271733878;for(let t=0;t<e.length;t+=16){const n=c,o=d,g=u,h=m;c=r(c,d,u,m,e[t],7,-680876936),m=r(m,c,d,u,e[t+1],12,-389564586),u=r(u,m,c,d,e[t+2],17,606105819),d=r(d,u,m,c,e[t+3],22,-1044525330),c=r(c,d,u,m,e[t+4],7,-176418897),m=r(m,c,d,u,e[t+5],12,1200080426),u=r(u,m,c,d,e[t+6],17,-1473231341),d=r(d,u,m,c,e[t+7],22,-45705983),c=r(c,d,u,m,e[t+8],7,1770035416),m=r(m,c,d,u,e[t+9],12,-1958414417),u=r(u,m,c,d,e[t+10],17,-42063),d=r(d,u,m,c,e[t+11],22,-1990404162),c=r(c,d,u,m,e[t+12],7,1804603682),m=r(m,c,d,u,e[t+13],12,-40341101),u=r(u,m,c,d,e[t+14],17,-1502002290),d=r(d,u,m,c,e[t+15],22,1236535329),c=i(c,d,u,m,e[t+1],5,-165796510),m=i(m,c,d,u,e[t+6],9,-1069501632),u=i(u,m,c,d,e[t+11],14,643717713),d=i(d,u,m,c,e[t],20,-373897302),c=i(c,d,u,m,e[t+5],5,-701558691),m=i(m,c,d,u,e[t+10],9,38016083),u=i(u,m,c,d,e[t+15],14,-660478335),d=i(d,u,m,c,e[t+4],20,-405537848),c=i(c,d,u,m,e[t+9],5,568446438),m=i(m,c,d,u,e[t+14],9,-1019803690),u=i(u,m,c,d,e[t+3],14,-187363961),d=i(d,u,m,c,e[t+8],20,1163531501),c=i(c,d,u,m,e[t+13],5,-1444681467),m=i(m,c,d,u,e[t+2],9,-51403784),u=i(u,m,c,d,e[t+7],14,1735328473),d=i(d,u,m,c,e[t+12],20,-1926607734),c=l(c,d,u,m,e[t+5],4,-378558),m=l(m,c,d,u,e[t+8],11,-2022574463),u=l(u,m,c,d,e[t+11],16,1839030562),d=l(d,u,m,c,e[t+14],23,-35309556),c=l(c,d,u,m,e[t+1],4,-1530992060),m=l(m,c,d,u,e[t+4],11,1272893353),u=l(u,m,c,d,e[t+7],16,-155497632),d=l(d,u,m,c,e[t+10],23,-1094730640),c=l(c,d,u,m,e[t+13],4,681279174),m=l(m,c,d,u,e[t],11,-358537222),u=l(u,m,c,d,e[t+3],16,-722521979),d=l(d,u,m,c,e[t+6],23,76029189),c=l(c,d,u,m,e[t+9],4,-640364487),m=l(m,c,d,u,e[t+12],11,-421815835),u=l(u,m,c,d,e[t+15],16,530742520),d=l(d,u,m,c,e[t+2],23,-995338651),c=s(c,d,u,m,e[t],6,-198630844),m=s(m,c,d,u,e[t+7],10,1126891415),u=s(u,m,c,d,e[t+14],15,-1416354905),d=s(d,u,m,c,e[t+5],21,-57434055),c=s(c,d,u,m,e[t+12],6,1700485571),m=s(m,c,d,u,e[t+3],10,-1894986606),u=s(u,m,c,d,e[t+10],15,-1051523),d=s(d,u,m,c,e[t+1],21,-2054922799),c=s(c,d,u,m,e[t+8],6,1873313359),m=s(m,c,d,u,e[t+15],10,-30611744),u=s(u,m,c,d,e[t+6],15,-1560198380),d=s(d,u,m,c,e[t+13],21,1309151649),c=s(c,d,u,m,e[t+4],6,-145523070),m=s(m,c,d,u,e[t+11],10,-1120210379),u=s(u,m,c,d,e[t+2],15,718787259),d=s(d,u,m,c,e[t+9],21,-343485551),c=a(c,n),d=a(d,o),u=a(u,g),m=a(m,h)}return Uint32Array.of(c,d,u,m)}(function(e){if(0===e.length)return new Uint32Array;const t=new Uint32Array(n(8*e.length)).fill(0);for(let n=0;n<e.length;n++)t[n>>2]|=(255&e[n])<<n%4*8;return t}(e),8*e.length))}},755657:(e,t,n)=>{"use strict";n.d(t,{Uk:()=>v,aW:()=>C});var a=n(822606),o=n(881707),r=n(708353),i=n(86940),l=n(293879),s=n(83437),c=n(660606),d=n(423905),u=n(241273),m=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{s(a.next(e))}catch(e){r(e)}}function l(e){try{s(a.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((a=a.apply(e,t||[])).next())}))},g=function(e,t){var n,a,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(n=1,a&&(o=2&l[0]?a.return:l[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,l[1])).done)return o;switch(a=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,a=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],a=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},h=!1,p=function(){return h},b=function(e){(0,c.cY)("setting ClpOfficeJSApiError to ".concat(e)),h=e},f=!1;function C(){return m(this,void 0,void 0,(function(){var e,t;return g(this,(function(n){switch(n.label){case 0:return!c.t6.IsClpEnabledInEnterpriseForSydney()||(null===(t=c.t6.IsCopilotInBackstageMode)||void 0===t?void 0:t.call(c.t6))?[3,3]:(f=!0,[4,o.n.getInstance().getInDocSensitiveLabelUsingOfcJs()]);case 1:return e=n.sent(),[4,o.n.getInstance().getHighestDocumentSensitivityInfo([o.n.getInstance().getInDocSensitiveLabelInfo(),e])];case 2:if(n.sent(),p())return b(!1),f=!1,[2,!1];n.label=3;case 3:return f=!1,[2,!0]}}))}))}function y(e,t){var n,a={chatEventType:s.a5.OfficeJsApiCallForCLPError,chatEventParam:"OfficeJsApiCallForCLP",chatErrorType:s.T_.Client,ashaErrorDetails:{vetoName:(0,d.CI)(s.kD.UnclearIntent,s.G8.UserInputIssue),errorString:s.av.SensitivityExecutionFailed,featureName:s.CC.CopilotChat}};null===(n=null==e?void 0:e.current)||void 0===n||n.addResponseMessage(function(e,t,n,a,s){void 0===s&&(s=!0);var u={shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:r.O.Footer,showAnimation:!1,isFailure:!0,telemetryData:a?(0,d.YI)(a):void 0},m=!0,g=o.n.getInstance();(null==g?void 0:g.getShouldStopLoadingUi)&&(m=g.getShouldStopLoadingUi());var h={chatCardType:i._.Default,chatMessageData:{defaultMessageProps:{user:l.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:u,stopLoadingUi:m,startAugloopTimerForStreaming:!1,addCardToChatHistory:s};return(0,d.IT)(t,n,!0),(0,c.cY)("CLP error response message: ".concat(h)),h}(t,!0,a))}function v(e,t,n,r){var i,l,m;if(null===(m=null==e?void 0:e.current)||void 0===m?void 0:m.getIsExecuting()){var g=function(e,t){switch(e){case u.YY.ApplyLabelUnsupportedCrossTenantErrorCode:return t===u.OZ.CLP_Get?a.u1:(0,a.Sh)();case u.YY.ApplyLabelDocumentReadOnlyErrorCode:return t===u.OZ.CLP_Get?a.u1:(0,a.w3)();case u.YY.ApplyLabelInsufficientPermissionErrorCode:return t===u.OZ.CLP_Get?a.u1:(0,a.bX)();case u.YY.ApplyLabelLabelDisabledErrorCode:return t===u.OZ.CLP_Get?a.u1:(0,a.pS)();case u.YY.ApplyLabelUnsupportedUdpErrorCode:return t===u.OZ.CLP_Get?a.u1:(0,a.hf)();case u.YY.ApplyLabelLabelingDisabledErrorCode:return t===u.OZ.CLP_Get?a.u1:(0,a.f4)();case u.YY.ApplyLabelUnsupportedContentTypeErrorCode:return t===u.OZ.CLP_Get?a.u1:(0,a.TZ)();case u.YY.ApplyLabelUnsupportedDkeErrorCode:return t===u.OZ.CLP_Get?a.u1:(0,a.O1)();case u.YY.ApplyLabelLabelNotFoundErrorCode:case u.YY.ErrorCode2147647531:return t===u.OZ.CLP_Get?a.u1:(0,a.aE)();case u.YY.OsfControlContainerErrorCode:case u.YY.OfficeSolutionFrameworkHostErrorCode:case u.YY.DocCookieErrorCode:case u.YY.HostIntegrationManagerErrorCode:case u.YY.MsoOLDocumentErrorCode:case u.YY.ClpSessionErrorCode:return(0,a.VQ)();case u.YY.OMWorkflowUserNotFoundErrorCode:return(0,a.W2)();case u.YY.OMOfficePerpetualNotSupportedErrorCode:return(0,a.MH)();case u.YY.LabelingDisabledProtectedViewErrorCode:return(0,a.s_)();case u.YY.LabelingDisabledAppguardErrorCode:return(0,a.Ng)();case u.YY.LabelingDisabledPrivacySettingsErrorCode:return t===u.OZ.CLP_Get?a.u1:(0,a.KA)();case u.YY.LabelingDisabledUnsupportedLabelClientErrorCode:return t===u.OZ.CLP_Get?a.u1:(0,a.H9)();case u.YY.LabelingDisabledNoSignedInClpCompatibleUsersErrorCode:return t===u.OZ.CLP_Get?a.u1:(0,a.oM)();case u.YY.OMOfficeClientNotLicensedForLabelingErrorCode:return t===u.OZ.CLP_Get?a.u1:(0,a.kB)();case u.YY.PolicyManagerUnavailableErrorCode:return t===u.OZ.CLP_Get?a.u1:(0,a.VQ)();case u.YY.ApplyLabelNewLabelSensitivityOrderErrorCode:return a.u1;case u.YY.ErrorCode2147500033:default:return t===u.OZ.CLP_Get?a.u1:(0,a.VQ)()}}(t,n);if(g){f&&b(!0),(0,c.cY)("clp error: ".concat(g)),y(e,g);var h=!0,p=o.n.getInstance();(null==p?void 0:p.getShouldStopLoadingUi)&&(h=p.getShouldStopLoadingUi()),r&&h&&r(),c.EG.sendChatEventTelemetry((0,d.pN)(((i={})[s.h3.ChatEventType]=s.a5.CLPErrorShown,i[s.h3.ChatEventParameters]=n+"_"+t,i)))}else(0,c.cY)("clp error string is empty"),c.EG.sendChatEventTelemetry((0,d.pN)(((l={})[s.h3.ChatEventType]=s.a5.CLPErrorIgnored,l[s.h3.ChatEventParameters]=n+"_"+t,l)));return g}return a.u1}},762030:(e,t,n)=>{"use strict";n.d(t,{H:()=>r});var a=n(551896),o=n(507628);class r{constructor(){this.scripts=[],this.scriptListPopulated=!1,this.getScriptExists=e=>this.scripts.findIndex((t=>t.name===e))>-1,this.getScripts=()=>this.scripts,this.pushScript=e=>{this.scripts.push(e)},this.popScript=()=>{this.scripts.pop()},this.populateScriptsList=async()=>{if(!this.scriptListPopulated)try{const e=new a.L;this.scripts=await e.getCopilotScripts((0,o.A)()),this.scriptListPopulated=!0}catch{return}}}}r._instance=void 0,r.getInstance=()=>(void 0===r._instance&&(r._instance=new r),r._instance)},764080:(e,t,n)=>{"use strict";var a,o,r,i,l,s,c,d;function u(e){return"ChartVisual"===e||"PivotChartVisual"===e||"QueryChartVisual"===e||"ForecastVisual"===e}function m(e){return e&&u(e.visualType)}function g(e){return"inDynamicPeriod"===e.filterType}function h(e){return["equal","notEqual","after","afterOrEqual","before","beforeOrEqual"].some((t=>t===e.filterType))}function p(e){return["between","notBetween"].some((t=>t===e.filterType))}function b(e,t){return t.every((t=>void 0!==e[t]))}n.d(t,{J2:()=>m,M$:()=>l,S$:()=>h,T6:()=>a,Uh:()=>o,VZ:()=>u,WZ:()=>r,kp:()=>p,o_:()=>b,rb:()=>d,uK:()=>c,vr:()=>g}),function(e){e.ChartTypeNotSupported="chartTypeNotSupported",e.ChartTypeNotAppropriate="chartTypeNotAppropriate"}(a||(a={})),function(e){e.NotStarted="notStarted",e.Running="running",e.Succeeded="succeeded",e.Failed="failed",e.Cancelling="cancelling",e.Cancelled="cancelled"}(o||(o={})),function(e){e.NotUnderstood="notUnderstood",e.Error="error",e.Answered="answered",e.Conversation="conversation"}(r||(r={})),function(e){e.None="none",e.Entities="entities",e.PotentialBias="potentialBias"}(i||(i={})),function(e){e.UnanswerableQuery="UnanswerableQuery",e.AskForClarification="AskForClarification",e.InvalidJsonFormat="InvalidJsonFormat",e.InvalidResponseType="InvalidResponseType",e.InvalidAE="InvalidAE",e.MismatchedColumnName="MismatchedColumnName",e.UnsupportedExecution="UnsupportedExecution",e.LLMThrottledError="LLMThrottledError",e.LLMHttpRequestError="LLMHttpRequestError",e.LLMTimeout="LLMTimeout",e.LLMGenericError="LLMGenericError",e.SymbolicLogicException="SymbolicLogicException",e.VisualConversionError="VisualConversionError",e.MissingFunctionality="MissingFunctionality",e.ContentTooLarge="ContentTooLarge",e.UnsupportedLanguage="UnsupportedLanguage",e.UnsupportedTextAnalysisType="UnsupportedTextAnalysisType",e.TextAnalysisUnexpectedLLMResult="TextAnalysisUnexpectedLLMResult",e.BlockedByRAI="BlockedByRAI"}(l||(l={})),function(e){e.OLAP="olap",e.Insights="insights",e.TextAnalysis="textAnalysis",e.Forecasting="forecasting",e.Visualization="visualization"}(s||(s={})),function(e){e.Summary="summary",e.Clustering="clustering",e.Topic="topic",e.KeyPhrase="keyPhrase",e.Sentiment="sentiment",e.General="general",e.Tagging="tagging"}(c||(c={})),function(e){e.QuickSummary="quickSummary",e.FullThemeSummary="fullThemeSummary",e.Others="others"}(d||(d={}))},764081:(e,t,n)=>{"use strict";n.d(t,{$H:()=>u,Nz:()=>l,OY:()=>i,Qt:()=>o,ag:()=>s,fH:()=>m,oY:()=>a,pL:()=>g,qj:()=>d,t9:()=>r,yT:()=>c});var a="TaskViewMode",o=80,r=55,i=50,l=70,s=50,c=35,d=70,u=50,m=35,g="c0ab8ce9-e9a0-42e7-b064-33d422df41f1"},766596:(e,t,n)=>{"use strict";n.d(t,{n:()=>y});var a=n(279395),o=n(86940),r=n(293879),i=n(874003),l=n(708353),s=n(178365),c=n(306148),d=n(857677),u=n(261720),m=n(164976),g=n(99558),h=n(347145);const p=d.q.OfficeJsCommanding,b=d.q.ChartDesignRecommendations,f="Copilot\\Chart Design Recommendations";function C(e){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:r.Q9.Human,messageHeader:{text:e}}}},telemetry:{featureName:p,eventType:d.a5.ActionConfirmationMessage}}}const y={getOfficeJsGenericSuccess:function(e,t,n,s,u=d.q.OfficeJsCommanding){const m=[];return e&&(0,h.BAK)()&&m.push((0,c.FW)(u)),n&&s?.length&&m.push({type:i.jA.Default,title:(0,a.f7s)(),text:(0,a.f7s)(),handleButtonOnClick:async()=>{(0,c.s_)(c.H0.RemoveExplain),t(s)}}),{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:r.Q9.Chat,messageHeader:{text:n??(0,a.CLD)()}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,actionButtonList:m,feedbackSectionPosition:l.O.Footer}},telemetry:{featureName:u,eventType:d.a5.ActionConfirmationMessage}}},getOfficeJsChangeWarning:function(e,t,n,l,m,g,h){const b=(0,a.hJV)(),f=(0,a.yPQ)(),y=()=>{(0,c.s_)(c.H0.RemoveAll);const{message:a,telemetry:o}=C(b);s.$.getInstance().displayResponse(a,o),m.onChangeAccepted(e,t,n,l,g,h)};u.MK.acceptUpcomingChange(e,y);const v={user:r.Q9.Chat,embeddedLists:[{listHeader:(0,a.zSd)(),listItems:n.map((e=>({text:e}))),listFooter:{text:(0,a.AbP)()}}]};return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:v},chatMessageBodyData:{messageId:e,actionButtonList:[{type:i.jA.Default,title:b,text:b,handleButtonOnClick:y},{type:i.jA.Default,title:f,text:f,handleButtonOnClick:async()=>{const{message:e,telemetry:t}=C(f);s.$.getInstance().displayResponse(e,t),(0,c.s_)(c.H0.RemoveAll)}}]}},telemetry:{featureName:p,eventType:d.a5.ActionConfirmationMessage}}},getOfficeJsCodeExplanation:function(e,t,n){const a={user:r.Q9.Chat,embeddedLists:[{listHeader:t,listItems:e.map((e=>({text:e})))}]};return{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:a},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,actionButtonList:n&&(0,h.BAK)()?[(0,c.FW)(p)]:[],feedbackSectionPosition:l.O.Footer}}},getOfficeJsInitialCodeExplanation:function(e,t,n,g,h,b,f,y){const v=(0,a.yZI)(),T=()=>{(0,c.s_)(c.H0.RemoveAll);const{message:a,telemetry:o}=C(v);s.$.getInstance().displayResponse(a,o),b.onChangeAccepted(e,t,n,h,f,y)};return u.MK.acceptUpcomingChange(e,T),{message:{chatCardType:o._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:r.Q9.Chat,renderData:(0,m.IM)("ScratchpadCommandingCard",g)}},chatMessageBodyData:{messageId:e,actionButtonList:[{type:i.jA.Default,title:v,text:v,isDisabled:!0,handleButtonOnClick:T}],feedbackSectionPosition:l.O.Footer}},telemetry:{featureName:p,eventType:d.a5.ActionConfirmationMessage}}},getChartDesignRecommendationsResponseMessage:function(e,t){return{message:{chatCardType:o._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:r.Q9.Chat,renderData:(0,m.IM)("ChartDesignRecommendationsCard_V1",{...t})}},chatMessageBodyData:{messageId:e,shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:l.O.Footer,feedbackData:{feedbackArea:f}},addCardToChatHistory:!1},telemetry:{featureName:b,eventType:d.a5.ChartDesignRecommendationsCardShown}}},getChartDesignRecommendationsSnowballChartResponseMessage:function(e,t){return{message:{chatCardType:o._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:r.Q9.Chat,renderData:(0,m.IM)("ChartDesignRecommendationsSnowballChartCard_V1",{queryId:e,isTriggeredViaOOUI:t})}},chatMessageBodyData:{messageId:e,shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:l.O.Footer,feedbackData:{feedbackArea:f}},addCardToChatHistory:!1},telemetry:{featureName:b,eventType:d.a5.ChartDesignRecommendationsCardShown}}},getChartDesignRecommendationsFailedResponse:function(e,t){return(0,g.v)(e,{featureName:b,errorType:t},{},{feedbackData:{feedbackArea:f}})},getOfficeJsApplicationFailure:function(e){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:r.Q9.Chat,embeddedLists:[{listHeader:(0,a.v3A)(),listItems:[{text:e[0]}]}]}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:l.O.Footer}},telemetry:{featureName:p,eventType:d.a5.ActionConfirmationMessage}}}}},767176:(e,t,n)=>{"use strict";e.exports=n.p+"assets/send-button-icon.svg"},769506:(e,t,n)=>{"use strict";n.d(t,{qv:()=>_,$v:()=>W,qK:()=>G});var a=n(870180),o=n(639765),r=n(548366),i=n(279395),l=n(178365),s=n(248967),c=n(790900),d=n(891693),u=n(306148),m=n(857677),g=n(83437),h=n(1329),p=n(291436),b=n(698013),f=n(468827),C=n(550781),y=n(255507),v=n(729851),T=n(70239),x=n(76872),S=n(75496),w=n(316904),E=n(664007),I=n(261720),R=n(428349);async function A(){const e=await F.create();let t;return{endCollectWorkbookChanges:async()=>(void 0===t&&(await Excel.run((async e=>{await e.sync(),await new Promise((e=>setTimeout(e,250)))})),await e.finalize(),t=e.getChanges()),t)}}class L{addEventRegistration(e){this.registeredEvents.push(e)}async unregisterEvents(){for(;this.registeredEvents.length>0;){const e=this.registeredEvents,t=e[0].context,n=[],a=[];e.forEach((e=>{e.context===t?n.push(e):a.push(e)})),this.registeredEvents=a,await Excel.run(t,(async()=>{n.forEach((e=>e.remove()))}))}}constructor(){this.registeredEvents=[]}}function k(e){const t=e=>e.referenceType===R.ss.Table;return e.reduce((({base:e,prevRangeEdit:n},a)=>(n&&t(a)&&e[e.length-1]?.operation===a.operation?(e.pop(),n=!1):n=a.referenceType===R.ss.Range,e.push(a),{base:e,prevRangeEdit:n})),{base:[],prevRangeEdit:!1}).base.reduce(((e,n)=>{const a=e[e.length-1];return a&&t(a)&&t(n)&&a.name===n.name&&a.operation===n.operation||e.push(n),e}),[])}class F{static async create(){const e=new F;return await e.initialize(),await e.registerEvents(),{getChanges:()=>e.changes,finalize:()=>e.finalize()}}async initialize(){return Excel.run({delayForCellEdit:!0},(async e=>{e.workbook.worksheets.load({id:!0,name:!0}),e.workbook.tables.load({id:!0,name:!0}),e.workbook.pivotTables.load({id:!0,name:!0,worksheet:{id:!0}}),await e.sync();for(const t of e.workbook.worksheets.items)this.worksheetInfo.set(t.id,{worksheetName:t.name});for(const t of e.workbook.tables.items)this.tableInfo.set(t.id,{name:t.name});for(const t of e.workbook.pivotTables.items)this.pivotTableInfo.set(t.id,{name:t.name,worksheetId:t.worksheet.id})}))}async finalize(){this.changes=k(this.changes),this.evtRegistrations.unregisterEvents()}updateSheetEntry(e){return Excel.run((async t=>{const n=t.workbook.worksheets.getItemOrNullObject(e).load("name");if(await t.sync(),n.isNullObject)return void this.worksheetInfo.delete(e);const a={worksheetName:n.name};return this.worksheetInfo.set(e,a),a}))}updateTableEntry(e){return Excel.run((async t=>{const n=t.workbook.tables.getItemOrNullObject(e).load("name");if(await t.sync(),n.isNullObject)return void this.tableInfo.delete(e);const a={name:n.name};return this.tableInfo.set(e,a),a}))}updatePivotTableEntry(e){return Excel.run((async t=>{const n=t.workbook.pivotTables.getItemOrNullObject(e).load({name:!0,worksheet:{id:!0}});if(await t.sync(),n.isNullObject)return void this.tableInfo.delete(e);const a={name:n.name,worksheetId:n.worksheet.id};return this.pivotTableInfo.set(e,a),a}))}getWorksheetName(e){return this.worksheetInfo.get(e)?.worksheetName??"{unknown}"}getTableName(e){return this.tableInfo.get(e)?.name??"{unknown}"}async registerEvents(){await Excel.run((async e=>{const t=e.workbook.worksheets;this.evtRegistrations.addEventRegistration(t.onAdded.add(this.handleWorksheetAdded.bind(this))),this.evtRegistrations.addEventRegistration(t.onDeleted.add((async e=>this.handleWorksheetDeleted(e)))),this.evtRegistrations.addEventRegistration(t.onNameChanged.add((async e=>this.handleWorksheetRenamed(e)))),this.evtRegistrations.addEventRegistration(t.onChanged.add((async e=>this.handleWorksheetChanged(e)))),this.evtRegistrations.addEventRegistration(e.workbook.tables.onAdded.add(this.handleTableAdded.bind(this))),this.evtRegistrations.addEventRegistration(e.workbook.tables.onDeleted.add((async e=>this.handleTableDeleted(e)))),this.evtRegistrations.addEventRegistration(e.workbook.tables.onChanged.add((async e=>this.handleTableChanged(e)))),this.evtRegistrations.addEventRegistration(e.workbook.pivotTables.onAdded.add(this.handlePivotTableAdded.bind(this))),this.evtRegistrations.addEventRegistration(e.workbook.pivotTables.onDeleted.add((async e=>this.handlePivotTableDeleted(e))))}))}async handleWorksheetAdded(e){const t=await this.updateSheetEntry(e.worksheetId);if(void 0!==t){const e={referenceType:R.ss.Sheet,operation:R.S5.Add,name:t.worksheetName};this.changes.push(e)}}handleWorksheetDeleted(e){const t=this.getWorksheetName(e.worksheetId);this.worksheetInfo.delete(e.worksheetId);const n={referenceType:R.ss.Sheet,operation:R.S5.Delete,name:t};this.changes.push(n);for(const[t,n]of this.pivotTableInfo)n.worksheetId===e.worksheetId&&this.handlePivotTableDeleted({pivotTableId:t})}handleWorksheetRenamed(e){this.worksheetInfo.set(e.worksheetId,{worksheetName:e.nameAfter});const t={referenceType:R.ss.Sheet,operation:R.S5.Rename,nameBefore:e.nameBefore,nameAfter:e.nameAfter};this.changes.push(t)}handleWorksheetChanged(e){const t={referenceType:R.ss.Range,operation:R.S5.Change,sheet:this.getWorksheetName(e.worksheetId),address:e.address,changeType:e.changeType};this.changes.push(t)}async handleTableAdded(e){const t=await this.updateTableEntry(e.tableId);if(void 0!==t){const e={referenceType:R.ss.Table,operation:R.S5.Add,name:t.name};this.changes.push(e)}}handleTableDeleted(e){const t=this.getTableName(e.tableId);this.tableInfo.delete(e.tableId);const n={referenceType:R.ss.Table,operation:R.S5.Delete,name:t};this.changes.push(n)}handleTableChanged(e){const t={referenceType:R.ss.Table,operation:R.S5.Change,name:this.getTableName(e.tableId)};this.changes.push(t)}async handlePivotTableAdded(e){const t=await this.updatePivotTableEntry(e.pivotTableId);if(void 0!==t){const e={referenceType:R.ss.PivotTable,operation:R.S5.Add,sheet:this.getWorksheetName(t.worksheetId),name:t.name};this.changes.push(e)}}handlePivotTableDeleted(e){const t=e.pivotTableId,n=this.pivotTableInfo.get(t);if(void 0!==n){this.pivotTableInfo.delete(t);const e={referenceType:R.ss.PivotTable,operation:R.S5.Delete,sheet:this.getWorksheetName(n.worksheetId),name:n.name};this.changes.push(e)}}constructor(){this.evtRegistrations=new L,this.worksheetInfo=new Map,this.tableInfo=new Map,this.pivotTableInfo=new Map,this.changes=[]}}var _,P=n(312422),N=n(109174),M=n(92520),O=n(347145),D=n(382736),B=n(110686),$=n(766596),H=n(639969),U=n(252120),q=n(414542),V=n(507628);!function(e){e[e.Success=0]="Success",e[e.PreviewUnavailable=1]="PreviewUnavailable",e[e.FailedValidation=2]="FailedValidation",e[e.InternalError=3]="InternalError",e[e.NoSuggestion=4]="NoSuggestion"}(_||(_={}));class W{async getOfficeScriptLibrary(){return(await n.e("ojsc-os-library").then(n.t.bind(n,887343,19))).code}async getWrapCode(e,t,a){const o=await n.e("ojsc-wrap-code").then(n.t.bind(n,219186,19));return this.codePrefix+o.code.replace(W.FUNCTION_TO_FIND_RETURN_VALUE,e?W.RETURN_OUTPUT_PROCESSED:W.RETURN_OUTPUT_IGNORED).replace(W.FUNCTION_TO_FIND_CODE,t).replace(W.FUNCTION_TO_FIND_PRELOADED_DATA,a)}async getWrapCodeForRawOfficeJsExecution(e){const t=await n.e("ojsc-wrap-code").then(n.t.bind(n,219186,19));return this.codePrefix+t.code.replace(W.FUNCTION_TO_FIND_RETURN_VALUE,W.RETURN_OUTPUT_STRINGIFIED).replace(W.FUNCTION_TO_FIND_CODE,e).replace(W.FUNCTION_TO_FIND_PRELOADED_DATA,"{}")}addCodeExplanationChatMessage(e,t,n,a,o){const r=$.n.getOfficeJsCodeExplanation(e,n,a);l.$.getInstance().displayResponse(r,o,{shouldShowWhenFluxSkillResponseRequired:!1});const i=(0,D.N)(r),s=(0,O.yw9)("OfficeVSO_9798167_SendFailureResponse");this.dispatch((0,H.nv)(i,!s||t?p.Aw.success:p.Aw.failed,o))}handleOfficeJsExecutionError(e){this.addCodeExplanationChatMessage(e,!1,(0,i.v3A)(),!1,{featureName:m.q.OfficeJsCommanding,eventType:m.a5.ErrorMessage,errorType:m.q0.OfficeJsExecutionFailed})}async onChangeAccepted(e,t,n,a,o,r,i=m.q.OfficeJsCommanding){this.dispatch(E.m.startExecutingCommand({command:m.OP.FluxReasoning,id:w.M.userQueryGuid}));let s=!1;if((0,O.IU1)())if(s=await this.applyBatches(n,r,i),s)this.dispatch(U.m.setCommandingResponseCompletion({queryId:e??"",codeCompletedSuccessfully:s,returnedMessage:void 0}));else{w.M.getInstance().logError({eventType:S.S2.OfficeJsOperations,errorMessage:"Apply on original workbook failed after Scratchpad validation succeeded",logLevel:g.$b.ASHA});const e=$.n.getOfficeJsApplicationFailure(n);l.$.getInstance().displayResponse(e.message,e.telemetry)}else s=await this.executeOfficeJs(e,t,n,!0,a,o);return await this.dispatch((0,H.L4)()),s}async applyBatches(e,t,n=m.q.OfficeJsCommanding){let a=!0;this.dispatch(E.m.startExecutingCommand({command:(0,O.yw9)("OfficeVSO_9687963_ShowChartChangesResponse")&&n===m.q.ChartDesignRecommendations?m.OP.ChartDesignRecommendations:m.OP.Commanding})),await(0,P.$r)((0,i.Eyh)()),N.CP.lockContextRefresh();try{if(!t)throw new Error("Missing processor: applyBatches requires a RichApiBatchProcessor.");await t.applyBatches()}catch(e){a=!1,(0,M.cY)(String(e))}if(N.CP.releaseContextLock(),await(0,P.TA)(),a){const{message:e,telemetry:t}=$.n.getOfficeJsGenericSuccess(!0,this.explainOfficeJsResult,void 0,void 0,n);l.$.getInstance().displayResponse(e,t);const a=(0,D.N)(e);this.dispatch((0,H.nv)(a,p.Aw.success,t))}else await(0,P.tN)(),this.handleOfficeJsExecutionError(e);return a}async validateOfficeJs(e,t,n,o,r,i){x.E.getInstance().updateTelemetryChatEventData({[v.h3.ChatEventType]:m.a5.CommandScratchpadValidateOfficeJsCalled},w.M.getInstance()),this.dataLocale=this.dataLocale||this.dispatch((0,B.Z)()).dataLocale;try{const t=await i??{},d=await this.getWrapCode(o,e,JSON.stringify(t));await this.runtimeHelper.prepareCustomParams(d,await this.getOfficeScriptLibrary(),r.makeBatchHandler()),await new Promise(((e,t)=>{const n=setTimeout((()=>{a(),t(new Error(W.ERROR_STRING_TIMEOUT))}),W.MAX_RUN_TIME),a=()=>{this.runtimeHelper.terminateCurrentRun(),clearTimeout(n);const e=new T.g0({parentPath:["Signal",s.dx.getTypeName()],items:[{id:h.r.generateId(),body:new s.dx({caller:"OfficeJsCommanding",requestId:(0,V.A)(),dataLocale:this.dataLocale})}]});try{l.$.getInstance().submitOperation({operation:e,workflowAnnotationType:c.Wh.getTypeName()})}catch(e){w.M.getInstance().logError({eventType:S.S2.CommandingScratchpad,errorMessage:"New Session Error: "+JSON.stringify(e),logLevel:g.$b.ASHA}),this.logOfficeJsAshaError(new Error(W.ERROR_STRING_START_NEW_SESSION_FAILURE))}};this.runtimeHelper.executeScript().then((n=>{a(),"string"==typeof n||void 0===n?e(null):(w.M.getInstance().logError({eventType:S.S2.CommandingScratchpad,errorMessage:"Error in response: "+JSON.stringify(this.stripFullStatementsFromRuntimeErrors(n)),logLevel:g.$b.ASHA}),t(n))})).catch((e=>{a(),w.M.getInstance().logError({eventType:S.S2.CommandingScratchpad,errorMessage:"OfficeJs Internal Error: "+JSON.stringify(e),logLevel:g.$b.ASHA}),t(new Error(W.ERROR_STRING_SCRATCHPAD_OFFICE_JS_INTERNAL_ERROR))}))}));const u=r.getApiCalls();if((0,M.cY)("[1mAPI Call Summary:[0m",JSON.stringify(u)),u){const e=a.i.generateDescription(u);if(e.header){n.summary=e.header;const t=[];let a=0;for(const n of e.descriptions)t.push({title:n.scope,content:n.change}),n.change.length>a&&(a=n.change.length);n.expandableListItems=t,x.E.getInstance().updateTelemetryChatEventData({[v.h3.ChatEventType]:m.a5.CommandScratchpadHitlDescriptionTelemetry,[v.h3.ChatEventParameters]:JSON.stringify({changeListLength:t.length,longestDescriptionLength:a})},w.M.getInstance())}return!0}(0,M.cY)("[1mAPI Call failed[0m")}catch(e){this.logOfficeJsAshaError(e)}return this.handleOfficeJsExecutionError(t),!1}async executeOfficeJsRaw(e){await this.loadRawOfficeJsScriptIntoRuntime(e);const{returnResult:t,documentChanges:n}=await N.CP.runWithNoContextRefresh((()=>async function(e){try{return await t(e)}catch(e){throw await(0,P.tN)(m.q.Unset),e}async function t(e){await(0,P.$r)((0,i.Eyh)());try{return await e()}finally{await(0,P.TA)()}}}((()=>async function(e,t){const n=await A();try{const a=await e();return t(a,await n.endCollectWorkbookChanges())}finally{await n.endCollectWorkbookChanges()}}((()=>async function(e){let[t,n]=function(){let e=()=>{};const t=new Promise(((t,n)=>{const a=setTimeout((()=>{n(new d.f(W.ERROR_STRING_TIMEOUT))}),W.MAX_RUN_TIME);e=()=>clearTimeout(a)}));return[t,e]}();return t=t.catch((t=>{throw e.terminateCurrentRun(),t})),Promise.race([t,e.executeScript()]).finally(n)}(this.runtimeHelper)),((e,t)=>({returnResult:a(e),documentChanges:t})))))));return{returnResult:t,documentChanges:n,excelDocumentContext:await N.CP.getContextString(w.M.userQueryGuid)};function a(e){if("string"==typeof e||void 0===e)return e;throw function(e){let t="";t="object"==typeof e&&!Array.isArray(e)&&null!==e&&"error"in e?JSON.stringify(e.error):"createFromScriptResponse: Unknown error";return w.M.getInstance().logError({eventType:S.S2.ChatEvents,errorMessage:t,logLevel:g.$b.Error}),new d.f(t)}(e)}}async validateOfficeJsChartRecommendation(e,t,n,i,l,s,c,d,u,h){(0,M.cY)(`Api result Code is: ${t}`),x.E.getInstance().updateTelemetryChatEventData({[v.h3.ChatEventType]:m.a5.ChartDesignRecommendationsValidateOfficeJSResultCalled,[v.h3.ChatEventParameters]:JSON.stringify({chartId:s,index:e})},w.M.getInstance()),this.dataLocale=this.dataLocale||this.dispatch((0,B.Z)()).dataLocale;try{const n=await u??{},p=await this.getWrapCode(i,t,JSON.stringify(n));await this.runtimeHelper.prepareCustomParams(p,await this.getOfficeScriptLibrary(),l.makeBatchHandler());let b="",f=[];await new Promise(((t,n)=>{const a=setTimeout((()=>{i(),n(new Error(W.ERROR_STRING_TIMEOUT))}),W.MAX_RUN_TIME),i=()=>{this.runtimeHelper.terminateCurrentRun(),clearTimeout(a)};this.runtimeHelper.executeScript().then((a=>{if("string"==typeof a||void 0===a)this.triggerChartRecommendationSignal(((e,n)=>{i();let a=0;if(""===e){a=1;const e="[ChartDesignRecommendations]: Chart scene graph is empty.";(0,M.cY)(n?`${e} Error code: ${n}`:e),w.M.getInstance().logError({eventType:S.S2.ChartDesignRecommendations,errorMessage:n?`${e} Error code: ${n}`:e,logLevel:g.$b.ASHA}),w.M.getInstance().logStandardizedAshaErrorEvent(r.W.Unable_To_Complete_Task,o.c.ChartDesignRecommendationsEmptySceneGraph,m.BJ.ChartDesignRecommendations)}h?.(a,e,b,f),t(null)}),e,s,c,d),t(null);else{w.M.getInstance().logError({eventType:S.S2.CommandingScratchpad,errorMessage:"[ChartDesignRecommendations]: Error in response: "+JSON.stringify(this.stripFullStatementsFromRuntimeErrors(a)),logLevel:g.$b.ASHA});const e="object"==typeof a&&null!==a&&"error"in a&&500!==a.error?.httpStatusCode?2:3;h?.(e,"",b,f),(0,M.cY)("[ChartDesignRecommendations]: validateOfficeJsChartRecommendation: "+JSON.stringify(this.stripFullStatementsFromRuntimeErrors(a))),n(a),i()}})).catch((e=>{i(),w.M.getInstance().logError({eventType:S.S2.CommandingScratchpad,errorMessage:"[ChartDesignRecommendations]: OfficeJs Internal Error: "+JSON.stringify(e),logLevel:g.$b.ASHA});h?.(3,"",b,f),(0,M.cY)("[ChartDesignRecommendations]: validateOfficeJsChartRecommendation: "+JSON.stringify(this.stripFullStatementsFromRuntimeErrors(e))),n(new Error(W.ERROR_STRING_SCRATCHPAD_OFFICE_JS_INTERNAL_ERROR))}))}));const C=l.getApiCalls();if((0,M.cY)("[1mAPI Call Summary:[0m",JSON.stringify(C)),C){const t=a.i.generateDescription(C);if(t.header){b=t.header;const n=[];for(const e of t.descriptions)n.push({title:e.scope,content:e.change});x.E.getInstance().updateTelemetryChatEventData({[v.h3.ChatEventType]:m.a5.ChartDesignRecommendationsScratchpadHitlDescriptionTelemetry,[v.h3.ChatEventParameters]:JSON.stringify({chartId:s,index:e,changeListLength:n.length})},w.M.getInstance()),f=n}}return!0}catch(e){(0,M.cY)(JSON.stringify(e)),w.M.getInstance().logError({eventType:S.S2.ChartDesignRecommendations,errorMessage:"[ChartDesignRecommendations]: OfficeJs Internal Error: "+JSON.stringify(e),logLevel:g.$b.ASHA}),this.logOfficeJsAshaError(e,!0)}return this.handleOfficeJsExecutionError(n),!1}async executeOfficeJs(e,t,n,a,o,r){this.dispatch(E.m.startExecutingCommand({command:m.OP.Commanding})),I.MK.editStarted(e);let s=!1;try{await(0,P.$r)((0,i.Eyh)());const c=await r??{},d=await this.getWrapCode(o,t,JSON.stringify(c));await this.runtimeHelper.prepareCustomParams(d,await this.getOfficeScriptLibrary()),await new Promise(((t,o)=>{const r=setTimeout((()=>{c(),o(new Error(W.ERROR_STRING_TIMEOUT))}),W.MAX_RUN_TIME),c=()=>{N.CP.releaseContextLock(),this.runtimeHelper.terminateCurrentRun(),clearTimeout(r)};N.CP.lockContextRefresh(),this.runtimeHelper.executeScript().then((async r=>{if(c(),"string"==typeof r){s=!0;const{message:e,telemetry:t}=$.n.getOfficeJsGenericSuccess(a,this.explainOfficeJsResult,r,n);l.$.getInstance().displayResponse(e,t);const o=(0,D.N)(e);this.dispatch((0,H.nv)(o,p.Aw.success,t))}else if(void 0!==r)o(r);else if(!a&&n.length)s=!0,this.addCodeExplanationChatMessage(n,s,(0,i.DSt)(),a,{featureName:m.q.OfficeJsCommanding,eventType:m.a5.ActionConfirmationMessage});else{s=!0;const{message:e,telemetry:t}=$.n.getOfficeJsGenericSuccess(a,this.explainOfficeJsResult);l.$.getInstance().displayResponse(e,t);const n=(0,D.N)(e);this.dispatch((0,H.nv)(n,p.Aw.success,t))}s&&await(0,P.TA)(),this.dispatch(U.m.setCommandingResponseCompletion({queryId:e??"",codeCompletedSuccessfully:s,returnedMessage:"string"==typeof r?r:void 0})),I.MK.editFinished(e,m.q.OfficeJsCommanding,s,r),t(null)})).catch(o)}))}catch(t){this.handleOfficeJsExecutionError(n),this.logOfficeJsAshaError(t),I.MK.editFinished(e,m.q.OfficeJsCommanding,!1,t)}return s}async logOfficeJsAshaError(e,t=!1){if((0,O.yw9)("OfficeVSO_8814792_LogAshaCommandingTelemetry")){let n,a;const i=e;i.errorCode===W.ERROR_STRING_ACCESS_DENIED?(n=r.W.Unable_To_Complete_Task,a=o.c.Failed_Command_Execution_Due_To_Protection_Settings):i.message===W.ERROR_STRING_TIMEOUT?(n=r.W.Response_Delayed_Or_Timed_Out,a=o.c.Command_Execution_Took_Too_Long):i.message===W.ERROR_STRING_START_NEW_SESSION_FAILURE?(n=r.W.Unable_To_Complete_Task,a=o.c.Command_Scratchpad_Start_New_Session_Failed):i.message===W.ERROR_STRING_SCRATCHPAD_OFFICE_JS_INTERNAL_ERROR?(n=r.W.Unable_To_Complete_Task,a=o.c.Command_Scratchpad_Office_Js_Internal_Error):(0,O.IU1)()&&i.error?.name===W.ERROR_STRING_RICH_API_FAILURE_NAME?(n=r.W.Unable_To_Complete_Task,a=i.error?.code===W.ERROR_STRING_RICH_API_BATCH_SAFETY_FAILURE_CODE&&i.error?.message===W.ERROR_STRING_RICH_API_BATCH_SAFETY_FAILURE_Message?o.c.Command_Scratchpad_Non_Copilot_Safe_Apis_Generated:o.c.Command_Scratchpad_Office_Js_Execution_Failed_In_Runtime):(n=r.W.Unclassified_Chat_Failure,a=o.c.Failed_Command_Execution_Due_To_Other_Error),w.M.getInstance().logStandardizedAshaErrorEvent(n,a,t?m.BJ.ChartDesignRecommendations:m.BJ.Commanding)}}async handleOfficeJsResult(e,t){this.dispatch(U.m.setCommandingResponse({queryId:e,response:t})),I.MK.reachedSkillExecutor(e,m.q.OfficeJsCommanding,t);const{code:n,canMakeChanges:a,returnsValue:o,apiUsageMetadata:r}=t;let i;i=(0,O.IU1)()&&0===t.codeExplanation.trim().length?[]:t.codeExplanation.split("\n").map((e=>e.replace("-  ","")));let s=!1;if(a){const t=Excel.run((async e=>{let t=!1;const n=e.workbook,{setsTableName:a,setsWorksheetName:o,setsPivotTableName:i,setsTableStyleName:l,setsPivotTableStyleName:s,setsSlicerStyleName:c,setsTimelineStyleName:d}=r,u=[{name:"tableNames",needed:a,collection:n.tables},{name:"worksheetNames",needed:o,collection:n.worksheets},{name:"pivotTableNames",needed:i,collection:n.pivotTables},{name:"tableStyleNames",needed:l,collection:n.tableStyles},{name:"pivotTableStyleNames",needed:s,collection:n.pivotTableStyles},{name:"slicerStyleNames",needed:c,collection:n.slicerStyles},{name:"timelineStyleNames",needed:d,collection:n.timelineStyles}];for(const{needed:e,collection:n}of u)e&&(t=!0,n.load("items/name"));t&&await e.sync();const m={};for(const{name:e,needed:t,collection:n}of u)t&&(m[e]=n.items.map((e=>e.name)));return m}));if((0,O.IU1)()){const a=(0,C.L)(i);0===i.length&&(a.isNotAvailable=!0,w.M.getInstance().logError({eventType:S.S2.CommandingError,errorMessage:"Unable to generate code explanation",logLevel:g.$b.ASHA}));const r=new b.p(this.dataLocale||"en-us","OfficeJsCommanding"),{message:s,telemetry:c}=$.n.getOfficeJsInitialCodeExplanation(e,n,i,a,o,this,t,r);l.$.getInstance().displayResponse(s,c);const d=performance.now(),h=await this.validateOfficeJs(n,i,a,o,r,t);x.E.getInstance().logLatency(performance.now()-d,m.OP.CommandScratchpadValidateOfficeJsCompleted,h,m.q.OfficeJsCommanding),h?(a.isLoading=!1,(0,u.s_)(u.H0.EnableApply)):a.isNotAvailable=!0}else{const{message:a,telemetry:r}=$.n.getOfficeJsChangeWarning(e,n,i,o,this,t);l.$.getInstance().displayResponse(a,r);const s=(0,D.N)(a);this.dispatch((0,H.nv)(s,p.Aw.success,r))}}else s=await this.executeOfficeJs(e,n,i,a,o);return await this.dispatch((0,H.L4)()),s}async loadRawOfficeJsScriptIntoRuntime(e){const t=e.match(/await\s+Excel\.run\s*\(((?:.|\n)*?)\);?(?:\s|\n)*$/);if(!t){const e="OfficeJS code not in expected format";throw w.M.getInstance().logError({eventType:S.S2.ChatEvents,errorMessage:e,logLevel:g.$b.Error}),new d.f(e)}const n=t[1],a=await this.getWrapCodeForRawOfficeJsExecution(`async function main(__workbook) { return (${n})(__workbook.engine.context);}`);await this.runtimeHelper.prepareCustomParams(a,await this.getOfficeScriptLibrary())}async handleChartDesignNoRecommendationResult(){let e=!1;if((0,O.IU1)()){const t=[];for(let e=1;e<=4;e++)t.push({id:e,resultType:4,scenegraphJSON:"",code:"",codeExplanation:[],summary:"",expandableListItems:[]});l.$.getInstance().onChartNewRecommendationAvailable(t,!0),e=!0}return await this.dispatch((0,H.L4)()),e}async handleChartDesignRecommendationResult(e,t,n,a,o){const r=performance.now();let i=!1;if((0,O.IU1)()){const s=Promise.resolve({}),c=[];let d=0;const u=async(t,a,o,r,i,l,c,d,u,g)=>{y.B.getInstance().logKeptEvent(m.BJ.ChartDesignRecommendations,m.q.ChartDesignRecommendations,v.RX.Create);const h=await this.onChangeAccepted(e,o,r,!1,s,i,m.q.ChartDesignRecommendations);x.E.getInstance().updateTelemetryChatEventData({[v.h3.ChatEventType]:m.a5.ChartDesignRecommendationsSuggestionApplied,[v.h3.ChatEventParameters]:JSON.stringify({chartId:n,previewClickCount:a,chartIndex:t,success:h,isChartTypeChanged:l,isDarkMode:c,colorPaletteId:d,isTitleLeftAligned:u,isDataSourceRangeChanged:g})},w.M.getInstance())},g=async()=>{const e=t[d];e.officeJSCode=e.officeJSCode.replaceAll("(await seriesCollection.getItems())","seriesCollection");const h=new b.p(this.dataLocale||"en-us","OfficeJsChartDesignRecommendations");l.$.getInstance().onChartRecommendationPreprocessing(d,t.length);const p=performance.now();i=await this.validateOfficeJsChartRecommendation(d,e.officeJSCode,e.description.split("\n"),!1,h,n,a,o,s,(async(n,a,o,i)=>{if(c.push({id:d+1,resultType:n,scenegraphJSON:a,code:e.officeJSCode,codeExplanation:e.description.split("\n"),isChartTypeChanged:e.isChartTypeChanged,isDarkMode:e.isDarkMode,colorPaletteId:e.colorPaletteId,isTitleLeftAligned:e.isTitleLeftAligned,isDataSourceRangeChanged:e.isDataSourceRangeChanged,summary:o,expandableListItems:i,batchProcessor:h}),0===d?l.$.getInstance().onChartNewRecommendationAvailable(c,!1,u):l.$.getInstance().onChartNewRecommendationAvailable(c,3===d),++d<t.length)await g();else{for(let e=d;e<4;e++)c.push({id:e+1,resultType:4,scenegraphJSON:"",code:"",codeExplanation:["No recommendation available"],summary:"",expandableListItems:[]}),l.$.getInstance().onChartNewRecommendationAvailable(c,3===e);y.B.getInstance().logSeenEvent(m.BJ.ChartDesignRecommendations,m.q.ChartDesignRecommendations,v.RX.Create),x.E.getInstance().logLatency(performance.now()-r,m.OP.ChartDesignRecommendationsResponseCardShown,!0,m.q.ChartDesignRecommendations),G("OfficeJsChartDesignRecommendations",this.dataLocale||"en-us")}})),x.E.getInstance().logLatency(performance.now()-p,m.OP.ChartDesignRecommendationsScratchpadValidateOfficeJsCompleted,i,m.q.ChartDesignRecommendations)};await g()}return await this.dispatch((0,H.L4)()),i}stripFullStatementsFromRuntimeErrors(e){return e?.error?.debugInfo?.fullStatements&&delete e.error.debugInfo.fullStatements,e}constructor(e){this.dispatch=e,this.codePrefix="",this.explainOfficeJsResult=e=>{this.addCodeExplanationChatMessage(e,!0,(0,i.KVc)(),!1,{featureName:m.q.OfficeJsCommanding,eventType:m.a5.ActionConfirmationMessage})},this.triggerChartRecommendationSignal=async(e,t,n,a,o)=>{x.E.getInstance().updateTelemetryChatEventData({[v.h3.ChatEventType]:m.a5.ChartDesignRecommendationsChartRecommendationSignalTriggered,[v.h3.ChatEventParameters]:JSON.stringify({chartId:n,index:t})},w.M.getInstance());const r=(0,V.A)(),i=(0,O.yw9)("OfficeVSO_10396995_UseVisibleObserverForCharting"),l=new T.g0({parentPath:["Signal",s.uv.getTypeName()],items:[{id:h.r.generateId(),body:new s.uv({caller:"OfficeJsCommanding",requestId:r,chartId:n,chartName:a,worksheetId:o,...i&&{useVisibleObserver:!0}})}]});try{const a=performance.now();e((await(0,q.T)(l,r,S.S2.CommandingScratchpad,m.OP.Commanding,c.fm.getTypeName())).chartSceneGraph,""),x.E.getInstance().updateTelemetryChatEventData({[v.h3.ChatEventType]:m.a5.ChartDesignRecommendationsChartRecommendationSignalCompleted,[v.h3.ChatEventParameters]:JSON.stringify({chartId:n,index:t})},w.M.getInstance()),x.E.getInstance().logLatency(performance.now()-a,m.OP.ChartDesignRecommendationsChartScenegraphGenerationCompleted,!0,m.q.ChartDesignRecommendations)}catch(t){const n=t.error?.errorCode;throw e("",n),(0,M.cY)(String(t)),w.M.getInstance().logError({eventType:S.S2.ChartDesignRecommendations,errorMessage:"[ChartDesignRecommendations]: ChartRecommendationSignal Error: "+JSON.stringify(t),logLevel:g.$b.ASHA}),this.logOfficeJsAshaError(t,!0),new Error("[ChartDesignRecommendations]: triggerChartRecommendationSignal Error: "+JSON.stringify(t))}},this.runtimeHelper=f.b.instance(),(0,O.usH)()&&(this.codePrefix="OfficeExtension.config.extendedErrorLogging = true;\n")}}function G(e,t,n=!1){const a=new T.g0({parentPath:["Signal",s.dx.getTypeName()],items:[{id:h.r.generateId(),body:new s.dx({caller:e,requestId:(0,V.A)(),dataLocale:t,useVisibleObserver:n})}]});try{l.$.getInstance().submitOperation({operation:a,workflowAnnotationType:c.Wh.getTypeName()})}catch(e){w.M.getInstance().logError({eventType:S.S2.CommandingScratchpad,errorMessage:"New Session Error: "+JSON.stringify(e),logLevel:g.$b.ASHA})}}W.MAX_RUN_TIME=6e4,W.FUNCTION_TO_FIND_RETURN_VALUE="function toFindReturnValue(){}",W.FUNCTION_TO_FIND_CODE="async function run(){}",W.FUNCTION_TO_FIND_PRELOADED_DATA="function toFindPreloadedData(){}",W.RETURN_OUTPUT_PROCESSED=["(r) => {","if(r===undefined||r===null)return undefined;","if(Array.isArray(r)){","let lines='';","for(const l of r){","if(typeof l==='object')return;","lines+=l.toString()+'\\n';","}","return lines.trim();","}","if(typeof r==='object')return;","return r.toString();","}"].join(""),W.RETURN_OUTPUT_STRINGIFIED="(r) => (r == null) ? undefined : JSON.stringify(r)",W.RETURN_OUTPUT_IGNORED="r=>undefined",W.ERROR_STRING_TIMEOUT="Timeout",W.ERROR_STRING_START_NEW_SESSION_FAILURE="ExcelScratchpadStartNewSession Failure",W.ERROR_STRING_SCRATCHPAD_OFFICE_JS_INTERNAL_ERROR="Scratchpad OfficeJS Internal Failure",W.ERROR_STRING_ACCESS_DENIED="AccessDenied",W.ERROR_STRING_RICH_API_BATCH_SAFETY_FAILURE_CODE="AccessDenied",W.ERROR_STRING_RICH_API_FAILURE_NAME="RichApi.Error",W.ERROR_STRING_RICH_API_BATCH_SAFETY_FAILURE_Message="You cannot perform the requested operation."},772777:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var a="";n.supports&&(a+="@supports (".concat(n.supports,") {")),n.media&&(a+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(a+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),a+=n.css,o&&(a+="}"),n.media&&(a+="}"),n.supports&&(a+="}");var r=n.sourceMap;r&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),t.styleTagTransform(a,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},775568:(e,t,n)=>{"use strict";n.d(t,{H:()=>p});var a=n(639765),o=n(548366),r=n(616166),i=n(279395),l=n(75496),s=n(857677),c=n(126521),d=n(347145),u=n(821845);const m=new Set([r.O.PythonTuiNotShownError,r.O.PythonGenericEditModeError,r.O.PythonStartAnalysisEditModeError,r.O.PythonProtectedSheetError,r.O.PythonProtectedSheetObjectInsertionError,r.O.PythonUnsupportedLanguage,r.O.PythonUnsupportedPlatform,r.O.PayloadSizeError,r.O.PythonCalcError,r.O.PythonNoActiveLicense,r.O.PythonAccessError,r.O.PythonDeletedSheetBeforeResponseGeneration,r.O.PythonDeletedSheetDuringResponseGeneration,r.O.PythonImageUnavailableAnalysisSheetDeletedError,r.O.PythonAugLoopCallsPerQueryMaximumHit,r.O.AnswersUnsupportedLanguageError,r.O.AnswersUnsupportedPlatformError]),g=new Set([r.O.PythonTuiNotShownError,r.O.PythonDeletedSheetBeforeResponseGeneration,r.O.PythonDeletedSheetDuringResponseGeneration,r.O.PythonImageUnavailableAnalysisSheetDeletedError,r.O.PythonAnalysisSheetMetadataError,r.O.PythonExitAnalysisError,r.O.PythonStartAnalysisFailed,r.O.PythonExecutionBlockedByAdmin,r.O.PythonAccessError,r.O.PythonCalcError,r.O.PythonStaleRuntimeError,r.O.PythonBusyStateError,r.O.PythonGeneralError,r.O.PrePythonModeError,r.O.GetPythonCellContextTimeoutRecoverable,r.O.GetAllPythonCellsUpToAnalysisSheetTimeout,r.O.GetAllPythonCellsOfAASessionAnalysisSheetTimeout,r.O.GetPythonCellContextTimeout,r.O.PythonContextExtractionAborted,r.O.PythonContextUndefinedParameter,r.O.GetPythonContextObjectFailed,r.O.PythonPayloadEmptyError,r.O.GetOfficePyServiceRuntimeUrlFailed,r.O.GetOfficePyServiceAccessTokenFailed,r.O.ConnectOfficePyServiceExecuteCodeTimeout,r.O.ConnectToOfficePySvcToExecutePythonCodeUnexpectedError,r.O.ExecutePythonCodeApiCallTimeout,r.O.PythonInvalidSelectedContext,r.O.PythonUnexpectedMissingSheetInContextExtraction,r.O.PythonObjectReferenceError,r.O.PayloadSizeError,r.O.PythonGeneralContextError,r.O.PythonInsertFailed,r.O.PythonDataFrameInsertFailed,r.O.PythonAutofitFailed,r.O.PythonStartAnalysisEditModeError,r.O.PythonProtectedSheetError,r.O.PythonProtectedSheetObjectInsertionError,r.O.PythonCodeRetryMaximumHit,r.O.PythonAddResultsToNewSheetError,r.O.PythonPostViewError,r.O.PythonCopyFailed,r.O.PythonGetDiagnosticsError,r.O.PythonPrintFormattedNumberError,r.O.PythonCodeAndPostViewPropsNotSerializable,r.O.PythonAugLoopCallsPerQueryMaximumHit,r.O.PythonNoActiveLicense]),h=new Set([r.O.AnswersPostViewError,r.O.AnswersInvalidImageResponse,r.O.AnswersMissingChunkProperty,r.O.AnswersParsingMetadataFailed,r.O.AnswersInsertImageError,r.O.AnswersInsertTableError,r.O.AnswersCollapsableCodeOnClickError,r.O.AnswersComponentPropsNotSerializable,r.O.AnswersInvalidChartImageResponse,r.O.AnswersInteractiveChartRenderingFailed,r.O.AnswersInteractiveChartRefFailed,r.O.AnswersInteractiveChartImageGenerationFailed,r.O.AnswersUnsupportedLanguageError,r.O.AnswersUnsupportedPlatformError]);class p extends Error{toString(){const e={eventType:this.eventType,errorCode:this.errorCode,ashaVeto:this.ashaVeto,ashaError:this.ashaError,isAceImpacting:this.isAceImpacting,telemetryStandardizedFeature:this.telemetryStandardizedFeature,errorDetails:this.errorDetailsNoPII};return JSON.stringify(e)}getErrorDisplayMessage(){let e;switch(this.errorCode){case r.O.PrePythonModeError:e=(0,i.y$1)();break;case r.O.GetPythonCellContextTimeoutRecoverable:case r.O.GetAllPythonCellsUpToAnalysisSheetTimeout:case r.O.GetAllPythonCellsOfAASessionAnalysisSheetTimeout:e=(0,i.kvH)();break;case r.O.PythonUnsupportedLanguage:case r.O.AnswersUnsupportedLanguageError:e=(0,i.V9X)();break;case r.O.PythonNoActiveLicense:{const t=`[${(0,i.g1k)()}](${i.jv5})`;e=(0,c.L)((0,i.GLO)(),t);break}case r.O.PythonUnsupportedPlatform:case r.O.AnswersUnsupportedPlatformError:{const t=`[${(0,i.g1k)()}](${i.jv5})`;e=(0,c.L)((0,i.S3X)(),t);break}case r.O.PythonStaleRuntimeError:e=(0,i.$L3)();break;case r.O.PythonBusyStateError:e=(0,i.Sk4)();break;case r.O.PythonGeneralError:case r.O.PythonCalcError:case r.O.PythonAccessError:{const t=`[${(0,i.A1r)()}](${i.O4H})`;e=(0,c.L)((0,i.jYw)(),t);break}case r.O.PythonProtectedSheetError:e=(0,i.FCw)();break;case r.O.PythonProtectedSheetObjectInsertionError:e=(0,i.lgi)();break;case r.O.PythonDeletedSheetBeforeResponseGeneration:e=(0,i.Rpx)();break;case r.O.PythonDeletedSheetDuringResponseGeneration:e=(0,i.Sl)();break;case r.O.PythonCodeRetryMaximumHit:e=(0,i.mq0)();break;case r.O.PythonAugLoopCallsPerQueryMaximumHit:e=(0,i.Gyx)();break;case r.O.PythonStartAnalysisEditModeError:e=(0,i.dvg)();break;case r.O.PythonGenericEditModeError:e=(0,i.xUh)();break;case r.O.PayloadSizeError:e=(0,i.OX0)();break;case r.O.PythonAddResultsToNewSheetError:e=(0,i.J9g)();break;case r.O.PythonMultipleOpenWorkbooks:e=(0,i.UvY)();break;case r.O.PythonExecutionBlockedByAdmin:e=(0,i.ABr)();break;default:e=(0,i.zOC)()}return e}getAshaVetoAndError(){let e,t=o.W.Unable_To_Complete_Task;switch(this.errorCode){case r.O.PythonStaleRuntimeError:e=a.c.Python_Runtime_In_Bad_State;break;case r.O.PythonObjectReferenceError:e=a.c.Python_Bad_Object_Reference;break;case r.O.PythonBusyStateError:e=a.c.Python_Runtime_Busy;break;case r.O.PythonUnknownError:e=a.c.Python_Unknown_Error;break;case r.O.PythonStartAnalysisFailed:e=a.c.Python_Start_Analysis_Failed;break;case r.O.PrePythonModeError:e=a.c.Pre_Python_Mode_Error;break;case r.O.PythonPostViewError:e=a.c.Python_PostView_Failed;break;case r.O.PythonMissingResponseValue:case r.O.PythonInvalidResponseOrder:case r.O.PythonUnsupportedResponseType:case r.O.PythonResponseAllDebugChunks:case r.O.PythonDisplayResponseError:e=a.c.Python_Missing_Or_Invalid_Response;break;case r.O.PythonCopyFailed:e=a.c.Failed_To_Copy_Code;break;case r.O.PythonInsertFailed:case r.O.PythonDataFrameInsertFailed:case r.O.PythonAutofitFailed:e=a.c.Python_Failed_To_Insert_Code;break;case r.O.PythonGeneralError:e=a.c.Python_General_Grid_Error;break;case r.O.PythonCodeRetryMaximumHit:e=a.c.Python_Code_Retry_Maximum_Hit;break;case r.O.PythonAugLoopCallsPerQueryMaximumHit:e=a.c.Python_AugLoop_Calls_Per_Query_Maximum_Hit;break;case r.O.PythonExitAnalysisError:e=a.c.Python_Exit_Analysis;break;case r.O.PythonGeneralContextError:case r.O.GetPythonCellContextTimeout:case r.O.GetPythonCellContextTimeoutRecoverable:case r.O.GetAllPythonCellsUpToAnalysisSheetTimeout:case r.O.GetAllPythonCellsOfAASessionAnalysisSheetTimeout:case r.O.PythonContextExtractionAborted:case r.O.PythonContextUndefinedParameter:case r.O.GetPythonContextObjectFailed:case r.O.GetOfficePyServiceRuntimeUrlFailed:case r.O.GetOfficePyServiceAccessTokenFailed:case r.O.ConnectOfficePyServiceExecuteCodeTimeout:case r.O.ConnectToOfficePySvcToExecutePythonCodeUnexpectedError:case r.O.ExecutePythonCodeApiCallTimeout:case r.O.PythonInvalidSelectedContext:case r.O.PythonUnexpectedMissingSheetInContextExtraction:e=a.c.Context_Extraction_Error;break;case r.O.PythonGetDiagnosticsError:e=a.c.Python_Failed_To_Get_Diagnostics;break;case r.O.PythonPrintFormattedNumberError:e=a.c.Python_Failed_To_Print_Formatted_Number;break;case r.O.PythonAddResultsToNewSheetError:e=a.c.Python_Add_Results_To_New_Sheet;break;case r.O.PythonPayloadEmptyError:e=a.c.Python_Payload_Empty;break;case r.O.PythonCodeAndPostViewPropsNotSerializable:e=a.c.Python_Code_And_PostView_Props_Not_Serializable;break;case r.O.AnswersComponentPropsNotSerializable:e=a.c.Answers_Component_Props_Not_Serializable;break;case r.O.PythonMultipleOpenWorkbooks:e=a.c.Python_Multiple_Open_Workbooks;break;case r.O.RichAPIGeneralException:e=a.c.RichAPI_General_Exception;break;case r.O.PythonTuiNotShownError:e=a.c.Python_Teaching_Callout_Not_Shown;break;case r.O.PythonStartAnalysisEditModeError:case r.O.PythonGenericEditModeError:e=a.c.Python_Cell_Edit_Mode;break;case r.O.PythonProtectedSheetError:case r.O.PythonProtectedSheetObjectInsertionError:e=a.c.Python_Failed_Due_To_Protected_Sheet;break;case r.O.AnswersPostViewError:e=a.c.Answers_PostView_Failed;break;case r.O.AnswersInvalidImageResponse:case r.O.AnswersMissingChunkProperty:e=a.c.Answers_Bad_Response;break;case r.O.AnswersParsingMetadataFailed:e=a.c.Answers_Processing_Failed;break;case r.O.AnswersInsertImageError:case r.O.AnswersInsertTableError:e=a.c.Answers_Insert_Failed;break;case r.O.AnswersCollapsableCodeOnClickError:e=a.c.Answers_Collapsable_Code_On_Click_Failed;break;case r.O.AnswersInvalidChartImageResponse:case r.O.AnswersInteractiveChartRenderingFailed:case r.O.AnswersInteractiveChartRefFailed:case r.O.AnswersInteractiveChartImageGenerationFailed:e=a.c.Answers_Interactive_Chart_Failed;break;case r.O.PythonAnalysisSheetMetadataError:e=a.c.Python_Analysis_Sheet_Metadata_Error;break;case r.O.PythonUnsupportedLanguage:case r.O.AnswersUnsupportedLanguageError:t=o.W.Missing_Copilot_Functionality,e=a.c.Input_Language_Unsupported;break;case r.O.PythonUnsupportedPlatform:case r.O.AnswersUnsupportedPlatformError:t=o.W.Missing_Copilot_Functionality,e=a.c.Unsupported_Platform_For_Python_In_Excel;break;case r.O.PayloadSizeError:t=o.W.Missing_Copilot_Functionality,e=a.c.Payload_Too_Large;break;case r.O.PythonCalcError:t=o.W.Missing_Copilot_Functionality,e=a.c.Python_Calc_Error;break;case r.O.PythonNoActiveLicense:t=o.W.User_Access_Issue_For_Copilot,e=a.c.Users_Python_License_Could_Not_Be_Validated;break;case r.O.PythonAccessError:t=o.W.User_Access_Issue_For_Copilot,e=a.c.Python_Access_Error;break;case r.O.PythonExecutionBlockedByAdmin:t=o.W.User_Access_Issue_For_Copilot,e=a.c.Python_Execution_Blocked_By_Admin;break;case r.O.PythonDeletedSheetBeforeResponseGeneration:case r.O.PythonDeletedSheetDuringResponseGeneration:t=o.W.User_Rejected_Or_Cancelled_Response,e=a.c.Python_Analysis_Sheet_Deleted;break;case r.O.PythonImageUnavailableAnalysisSheetDeletedError:t=o.W.UI_Failed_To_Update_Or_Load,e=a.c.Python_Image_Unavailable_Due_To_Analysis_Sheet_Deleted;break;default:e=a.c.Python_Unknown_Error}return{ashaVeto:t,ashaError:e}}getACEImpact(){return!m.has(this.errorCode)}getUpdatedPythonErrorCode(e,t){if(!(e instanceof OfficeExtension.Error))return t;switch(e.code){case Excel.ErrorCodes.inactiveWorkbook:return r.O.PythonMultipleOpenWorkbooks;case Excel.ErrorCodes.responsePayloadSizeLimitExceeded:return r.O.PayloadSizeError;case Excel.ErrorCodes.invalidOperationInCellEditMode:return r.O.PythonGenericEditModeError;case Excel.ErrorCodes.generalException:return r.O.RichAPIGeneralException;default:return t}}getTelemetryStandardizedFeatureForASHA(){return g.has(this.errorCode)?s.BJ.Python:h.has(this.errorCode)||(0,u.i)()?s.BJ.Answers:s.BJ.Python}getContextSyncErrorDebugInfo(e){return`context.sync() failed. errorLocation: ${e.debugInfo?.errorLocation}, statement: ${e.debugInfo?.statement}, innerErrorCode: ${e.debugInfo?.code}`}getDetailedErrorMessageWithInnerErrorDetails(e,t){if(!(t&&t instanceof Error))return e;const n=t;return`${e}\ninnerError: ${n instanceof OfficeExtension.Error?`${n.name}\n${this.getContextSyncErrorDebugInfo(n)}`:n.name}`}constructor({errorCode:e,innerError:t,errorDetailsNoPII:n,errorDetailsOCVOnly:a,customDisplayMessage:o}){super(e),this.eventType=l.S2.PythonError,(0,d.yw9)("OfficeVSO_10264922_AdditionalErrorHandlingMAA")?this.errorCode=this.getUpdatedPythonErrorCode(t,e):this.errorCode=e;const r=this.getAshaVetoAndError();this.ashaVeto=r.ashaVeto,this.ashaError=r.ashaError,this.isAceImpacting=this.getACEImpact(),this.telemetryStandardizedFeature=this.getTelemetryStandardizedFeatureForASHA(),this.errorDisplayMessage=o??this.getErrorDisplayMessage(),this.errorDetailsNoPII=this.getDetailedErrorMessageWithInnerErrorDetails(n,t),this.errorDetailsOCVOnly=a}}},778689:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Assert=void 0;t.Assert=class{static Equals(e,t){if(e!==t)throw new Error(`${JSON.stringify(e)} does not match expected ${JSON.stringify(t)}`)}static True(e,t){if(!e)throw new Error(`Bad program state. ${t||""}`)}static NotNull(e,t){if(null===e)throw new Error(`Bad program state. ${t||""}`)}}},779939:(e,t,n)=>{"use strict";n.d(t,{Pp:()=>p,hk:()=>b,YS:()=>L,EM:()=>T,iN:()=>x,NP:()=>v,KI:()=>y,N2:()=>R,Fp:()=>C,qM:()=>A,VF:()=>w,if:()=>S,F:()=>E,eo:()=>I,oG:()=>f});var a=n(279395),o=n(92520),r=n(347145),i=n(972424),l=n(710729),s=n(881608),c=n(83437),d=n(75496),u=n(316904),m=n(208520),g=n(794329);function h(e){const t=document.createElement("div");try{return g.render(m.createElement(s.A,e),t),t.innerText}catch(e){return u.M.getInstance().logError({eventType:d.S2.ChatEvents,errorMessage:`FormulaSuggestionTextForChatHistory: Failed to render header: ${e?.message}`,logLevel:c.$b.Critical}),""}finally{g.unmountComponentAtNode(t)}}function p(e,t){let n="";if(!e)return n;if("TextAnalysisVisual"===e.visual.visualType)return f(e.title,e.visual);if((0,r.ZAR)()){const e=(0,a.PDm)();e.includes("{range}")&&e.includes("{sheet}")?n=e.replace("{range}",(0,i.r)(t)).replace("{sheet}",(0,i.w)(t)):((0,o.cY)("Template placeholders for range or sheet are missing in ANALYZE_DATA_CONTEXT_HEADER_WITH_SHEET"),n=e)}else n=(0,a.I5y)().replace("{0}",(0,i.r)(t));return e.title?.runs&&(e.title.runs.forEach((e=>{e?.text&&(n+=e.text)})),n+="\n"),n+=(0,l.g)(e,!1)+"\n",n}function b(e){return e.body?.length>0?e.body.map((e=>e.text?e.text:"Carousel"===e.type?e.pages?.flatMap((e=>e.items?.map((e=>e.text??""))??[])).filter((e=>""!==e.trim())).join(" "):"")).filter((e=>""!==e.trim())).join(" "):""}function f(e,t){let n="";return e?.runs&&(e.runs.forEach((e=>{e?.text&&(n+=e.text)})),n+="\n"),t.textAnalysisResult.generalResponse&&(n+=t.textAnalysisResult.generalResponse,n+="\n"),t.textAnalysisResult.bulletList&&t.textAnalysisResult.bulletList.forEach((e=>{n+=`${e.title}: ${e.description}\n`})),n}function C(e,t,n,a,r,i){return t?function(e,t,n,a,r,i){return t?((0,o.cY)("FormulaSuggestionTextForChatHistory",{isMainRecommendation:e,model:t,targetAddress:n,columnLetters:r,rowNumber:i}),[h({isMainRecommendation:e,recommendation:t,targetAddress:n,targetSheet:a,columnLetters:r,rowNumber:i}),...t.calculatedFormulas.flatMap((e=>Array.from(function*(e){const{title:t,formula:n,description:a,formulaExplanation:o}=e;t&&(yield t),a&&(yield a),yield n,o&&(yield o)}(e))))].join("\n")):((0,o.cY)("FormulaSuggestionTextForChatHistory: No model passed"),"")}(e,t,n,a,r,i):((0,o.cY)("FormulaSuggestionTextForChatHistory: No model passed"),"")}function y(e){let t="";if(e?.header&&(t+=e.header+"\n"),e?.listItems)for(const n of e.listItems)n.title&&(t+=n.title+"\n"),n.text&&(t+=n.text+"\n");return e?.footer&&(t+=e?.footer),t}function v(e){let t="";if(e?.header&&(t+=e.header+"\n"),e?.events)for(const n of e.events)t+=n+"\n";return t}function T(e){let t="";if(e?.header&&(t+=e.header+"\n"),e?.eventIntents)for(const n of e.eventIntents)t+=n+"\n";if(e?.cfHitlItems)for(const n of e.cfHitlItems){if(t+=n.title+n.explanation+"\n",n.subExplanations)for(const e of n.subExplanations)t+=e+"\n";(0,r.ID5)()&&(0,r.yw9)("OfficeVSO_9197813_AddCFFormulaToChatHistory")&&n.conditionalFormatResponseCardData.customFormula&&(t+=n.conditionalFormatResponseCardData.customFormula+"\n")}return t}function x(e){let t="";if(e?.header&&(t+=e.header+"\n"),e?.suggestions)for(const n of e.suggestions)t+=n.Description+"\n",t+=n.Key+"\n";return t}function S(e,t){let n=`Code: ${e}`;return t&&(n+=`\nCode Explanation: ${t}`),n}function w(e){return e.filter((e=>e.value.text||e.value.code||e.value.finalText)).map((e=>{switch(e.type){case"text":return e.value.text;case"code":return S(e.value.code,e.value.codeExplanation);case"finalText":return e.value.finalText;default:return}})).filter((e=>void 0!==e)).join("\n")}function E(){return`${(0,a.XXH)()}\n${(0,a.zqN)()}\n${(0,a.lQ6)()}\n${(0,a.WQT)()}\n${(0,a.LMV)()}`}function I(){return`${(0,a.Y9M)()}\n${(0,a.O8z)()}\n${(0,a.vK1)()}\n${(0,a.m$v)()}\n${(0,a.AS_)()}`}function R(){return`${(0,a.i3R)()}\n${(0,a.pF5)()}`}function A(){return`${(0,a.BZb)()}\n${(0,a.h8D)()}`}function L(e){return`data:${function(e){switch(e.charAt(0)){case"/":return"image/jpeg";case"i":return"image/png";default:return"image"}}(e)};base64,${e}`}},780033:(e,t,n)=>{"use strict";n.d(t,{Q:()=>R});var a=n(795167),o=n(1789),r=n(632769),i=n(207545),l=n(507628),s=n(70239),c=n(265167),d=n(260197),u=n(795917),m=function(){return m=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},m.apply(this,arguments)};function g(e,t){return void 0===t&&(t=!1),!!e&&(!(!t&&e.toLowerCase()===r.Ww.NONE)&&Object.values(r.Ww).some((function(t){return t===e.toLowerCase()})))}function h(e){var t;return m(m({scenarioName:r.Cu.NONE},e),null!==(t=e.properties)&&void 0!==t?t:{})}function p(e,t,n,a){var o,r,i,l,s;if(!e.isBizChatinSDXEnabled||e.fallbackHandoffsToAppChat||!n)return t&&t("[Handoff] Switching to AppChat - BizChat is not enabled"),u.$.AppChat;var c=null!==(l=null!==(r=null===(o=null==a?void 0:a.PrimaryUserAccountInfo)||void 0===o?void 0:o.AggregatedLicensedFeatures)&&void 0!==r?r:null===(i=null==a?void 0:a.PrimaryUserAccountInfo)||void 0===i?void 0:i.LicensedFeatures)&&void 0!==l?l:void 0;return e.shouldCheckUserLicense&&!(null==c?void 0:c.includes("Copilot"))&&!(null==c?void 0:c.includes("CopilotStarter"))?(t&&t("[Handoff] User is not licensed to use BizChat"),u.$.AppChat):e.isHandoffsToAppChatDisabled?u.$.M365CopilotChat:e.shouldDefaultToBizChat?(t&&t("[Handoff] Defaulting to BizChat unless specified"),n.featureName===d.ur.SkittleContextMenuUserClickAction&&n.contextMenuSelection&&"TriggerAnalyzeImage"===n.contextMenuSelection||d.q7.includes(n.featureName)?u.$.AppChat:u.$.M365CopilotChat):null!==(s=d.i$.get(n.featureName))&&void 0!==s?s:u.$.AppChat}var b=n(423905),f=n(83437),C=n(693226),y=n(951323),v=n(328215),T=function(e,t,n,a){var o,r;return n?!!a||(e("Conversation ID handoff unsucessful - no submitOperation function defined"),null==t||t.sendChatEventTelemetry((0,b.pN)(((r={})[f.h3.ChatEventType]=f.a5.SubmitOperationUndefined,r))),!1):(e("Unable to update chat session ID, updateChatSessionId is undefined"),null==t||t.sendChatEventTelemetry((0,b.pN)(((o={})[f.h3.ChatEventType]=f.a5.CannotUpdateChatSessionId,o))),!1)},x=function(e,t){var n,a,o={pageSize:w,syncState:void 0},r={type:C.S5.GetMessagesOperation,chatSessionId:e,paging:o,setSessionAsCurrent:!0,gptId:(0,v.Z)()};return new y.T({operation:r,documentURLOrLocalPath:null===(n=t.properties)||void 0===n?void 0:n.destinationDocUrl,timestamp:Date.now(),documentSensitivity:null===(a=t.properties)||void 0===a?void 0:a.sensitivityLabel,orchestratorGroundingMode:void 0,isFluxChatHistoryAnnotationActivated:!1,caller:E})},S=function(e,t){return{operation:new s.g0({parentPath:["Signal",y.T.getTypeName()],items:[{id:c.r.generateId(),body:x(e,t)}]}),workflowAnnotationType:y.T.getTypeName()}},w=10,E="handoff",I=function(){return I=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},I.apply(this,arguments)},R=function(){function e(e,t){this.HandoffOperations=e,this.executingHandoffMessageIds=new Map,this.pendingHandoffMessageIds=new Set,this.flights={};var n=this.getDocumentHandoffMessageId();n&&this.pendingHandoffMessageIds.add(n),this.flights=e.getFlights(),this.telemetryHandler=t}return e.prototype.getDocumentHandoffMessageId=function(){var e=i.kH.getSettingAsString(i.zj.HandoffMessageId);if(e)return e;this.HandoffOperations.logDebug("HandoffMessageId was not found in host app settings")},e.prototype.sendHandoffMessageId=function(e,t){try{if(!t||!this.shouldExecuteHandoffMessageId(t))return;var n=(0,l.A)(),r=this.getHandoffMessageIdSignal(n,t,e),i=new s.g0({parentPath:["Signal",a.uC.getTypeName()],items:[{id:c.r.generateId(),body:r}]});e===o.Q.GET&&this.trackHandoffMessageIdSignal(n,t),this.handoffMessageIdRequestSubmitTime=(new Date).getTime(),this.HandoffOperations.submitSignal(r.H_.T_,{operation:i,workflowAnnotationType:a.uC.getTypeName()}),this.HandoffOperations.onHandoffMessageIdSubmitted(r)}catch(e){throw this.HandoffOperations.logDebug("[Handoff] Failed to send HandoffMessageId signal. "+e.message),e}},e.prototype.getBizChatProperties=function(e){return e},e.prototype.switchChatExperienceIfNeeded=function(e,t,n){this.flights.isBizChatinSDXEnabled&&this.flights.enableBizchatHostContext&&(this.HandoffOperations.logDebug("[Handoff] Switching chat pane experience"),function(e,t,n,a){var o,r=n.useHandoffMessagePropertiesValue?h(e):e,i=void 0;try{i=r.context?JSON.parse(r.context):void 0}catch(e){return void(a&&a("Handoff context could not be parsed - unable to switch chat experience"))}t.setBizChatHostContext&&t.setBizChatHostContext({PrimaryUserAccountInfo:m(m({},null===(o=t.bizChatHostContext)||void 0===o?void 0:o.PrimaryUserAccountInfo),{CopilotExperience:p(n,a,i,t.bizChatHostContext)})})}(e,{setBizChatHostContext:t,bizChatHostContext:n},this.flights,this.HandoffOperations.logDebug))},e.prototype.receiveHandoffAnnotation=function(e,t){this.HandoffOperations.logDebug("[Handoff] Receiving handoff annotation"),this.HandoffOperations.onAnnotationReceived(a.uC.getTypeName(),e,this.handoffMessageIdRequestSubmitTime,t)},e.prototype.handleBizChatHandoffIfEnabled=function(e,t,n){var a;if(this.flights.handoffToBizChatEnabled&&this.flights.isBizChatinSDXEnabled&&n&&e){var o=void 0;if(this.flights.useHandoffMessagePropertiesValue)this.HandoffOperations.logDebug("[Handoff] converting handoff response to BizChat handoff properties"),o=this.getBizChatProperties(h(e));else{var i=I({scenarioName:r.Cu.NONE},e);if(e.properties)for(var l=0,s=Object.keys(e.properties);l<s.length;l++){var c=s[l];void 0===i[c]&&(i[c]=e.properties[c])}o=this.getBizChatProperties(i)}try{var d=JSON.parse(null!==(a=null==o?void 0:o.context)&&void 0!==a?a:"");if(function(e,t,n,a){return p(e,t,n,a)===u.$.M365CopilotChat}(this.flights,this.HandoffOperations.logDebug,d,t))return this.HandoffOperations.logDebug("[Handoff] Setting BizChat handoff properties"),n(o),!0}catch(e){return this.HandoffOperations.logDebug("[Handoff] BizChat handoff failed: "+e),!0}}return this.HandoffOperations.logDebug("[Handoff] BizChat handoff not enabled"),!1},e.prototype.handleHandoffMessage=function(e,t,n,o,i,l,s){void 0===n&&(n=!1);try{if(!(null==e?void 0:e.body)||!a.uC.typeGuard(e.body))throw new Error("Service response not of type HandoffMessage");var c=e.body;if(this.switchChatExperienceIfNeeded(c,i,l),this.receiveHandoffAnnotation(c,t),this.handleBizChatHandoffIfEnabled(c,l,s))return void this.HandoffOperations.logDebug("[Handoff] Completed BizChat handoff");var u=function(e,t){var n;return void 0===t&&(t=!1),e.scenarioName===r.Cu.INAPP||(null===(n=e.properties)||void 0===n?void 0:n.scenarioName)===r.Cu.INAPP?d.Wr.InAppHandoff:t?d.Wr.CrossAppCanvasHandoff:d.Wr.CrossAppHandoff}(c,n);switch(u){case d.Wr.InAppHandoff:return void this.processHandoffMessage(c);case d.Wr.CrossAppCanvasHandoff:return this.renderChatHistory(c,o),this.renderClosingBookending(c),void this.processHandoffMessage(c);case d.Wr.CrossAppHandoff:default:return void(this.isHandoffMessageIdSignalTracked(c.queryId)&&this.validateResponse(c)&&(this.renderChatHistory(c,o),this.renderClosingBookending(c),this.processHandoffMessage(c),this.cleanupHandoff(c)))}}catch(e){throw this.HandoffOperations.logDebug("[Handoff] Failed to handle HandoffMessage. "+e.message),e}},e.prototype.validateResponse=function(e){return!e.error||(this.HandoffOperations.logDebug("[Handoff] Failed to retrieve handoff message. "+e.error),e.error.includes("Unable to download content. The specified blob does not exist")||e.error.includes("Unable to download content. Request failed with status code 500")||this.HandoffOperations.onError(d.Fc.HandoffMessageResponse,d.I5),!1)},e.prototype.renderClosingBookending=function(e){var t,n,a;if((null===(t=e.properties)||void 0===t?void 0:t.sourceApp)&&(null===(n=e.properties)||void 0===n?void 0:n.destinationApp)&&(null===(a=e.properties)||void 0===a?void 0:a.scenarioName)&&(!this.flights.appValueChecksForBookendingEnabled||g(e.properties.sourceApp)&&g(e.properties.destinationApp)))switch(e.properties.scenarioName){case r.Cu.OPEN:this.HandoffOperations.renderBookending(e.properties.sourceApp,e.properties.destinationApp,"Closing","Opened");break;case r.Cu.NEW:case r.Cu.GENERATE:this.HandoffOperations.renderBookending(e.properties.sourceApp,e.properties.destinationApp,"Closing","Created")}},e.prototype.cleanupHandoff=function(e){var t=this.getHandoffMessageIdFromSignal(e.queryId);this.sendHandoffMessageId(o.Q.PROCESSED,t),this.completeTrackedHandoffMessageIdSignal(e.queryId)},e.prototype.renderChatHistory=function(e,t){var n,a,o;if(this.flights.renderChatHistoryInHandoffDestination){var r=null===(a=e.properties)||void 0===a?void 0:a.conversationId;r?function(e,t,n,a,o){var r,i,l,s,c,d;T(n,a,null===(l=null==o?void 0:o.current)||void 0===l?void 0:l.updateChatSessionId,null===(s=null==o?void 0:o.current)||void 0===s?void 0:s.submitOperation)&&(n("Updating chat session ID with conversationId from source"),null==a||a.sendChatEventTelemetry((0,b.pN)(((r={})[f.h3.ChatEventType]=f.a5.UpdateChatSessionId,r))),null===(c=null==o?void 0:o.current)||void 0===c||c.updateChatSessionId(e),n("Conversation ID handoff successful - submitting chat history signal"),null==a||a.sendChatEventTelemetry((0,b.pN)(((i={})[f.h3.ChatEventType]=f.a5.ChatHistorySignalSubmitted,i))),null===(d=null==o?void 0:o.current)||void 0===d||d.submitOperation(S(e,t)))}(r,e,this.HandoffOperations.logDebug,this.telemetryHandler,t):(this.HandoffOperations.logDebug("Cannot render chat history - conversation ID is undefined"),null===(o=this.telemetryHandler)||void 0===o||o.sendChatEventTelemetry((0,b.pN)(((n={})[f.h3.ChatEventType]=f.a5.ConversationIdUndefined,n))))}},e.prototype.autoExecuteQuery=function(e){if(!this.isHandoffAutoSubmitPromptsEnabled())throw this.HandoffOperations.logDebug("[Handoff] Query auto execution was not allowed, change gate of isHandoffAutoSubmitPromptsEnabled has been disabled."),new Error("query auto execution was not allowed");this.HandoffOperations.submitQuery(e)},e.prototype.trackHandoffMessageIdSignal=function(e,t){this.executingHandoffMessageIds.set(e,t)},e.prototype.isHandoffMessageIdSignalTracked=function(e){return this.executingHandoffMessageIds.has(e)},e.prototype.shouldExecuteHandoffMessageId=function(e){return this.pendingHandoffMessageIds.has(e)},e.prototype.getHandoffMessageIdFromSignal=function(e){return this.executingHandoffMessageIds.get(e)},e.prototype.completeTrackedHandoffMessageIdSignal=function(e){var t=this.getHandoffMessageIdFromSignal(e);this.pendingHandoffMessageIds.delete(t),this.executingHandoffMessageIds.delete(e)},e}()},789065:(e,t,n)=>{"use strict";function a(e){var t;try{t=JSON.parse(e)}catch(e){throw new Error("Failed to parse payload into a IPluginRequest object. \n"+e)}return{id:t.id,method:o(t.method),params:t.params,jsonrpc:t.jsonrpc}}function o(e){if(!e)throw new Error("Method name is missing in the invocation");var t=e.indexOf("_");if(-1===t)throw new Error("Namespace is missing in the invocation method name");return e.substring(t+1)}n.d(t,{w:()=>a})},792312:(e,t,n)=>{"use strict";n.d(t,{JK:()=>se,hJ:()=>le,iT:()=>ce,ph:()=>$e,uX:()=>me,GZ:()=>ge,QI:()=>Ie,Sf:()=>Re,iM:()=>Fe,Kr:()=>ke,UN:()=>ue,y1:()=>he,P_:()=>de,jv:()=>Ee,aP:()=>Be,wK:()=>we});var a=n(279395),o=n(639765),r=n(548366),i=n(384169),l=n(596760),s=n(446751),c=n(92520);class d{addCleanupFunctions(e,...t){this.cleanupFunctionsByKey.has(e)?this.cleanupFunctionsByKey.get(e).push(...t):this.cleanupFunctionsByKey.set(e,t)}isTracking(e){return this.cleanupFunctionsByKey.has(e)}stopTracking(e){(0,c.cY)("BaseEventsTracker: stopTracking",e),this.cleanupFunctionsByKey.get(e)?.forEach((e=>e.remove())),this.cleanupFunctionsByKey.delete(e)}constructor(){this.cleanupFunctionsByKey=new Map}}var u=n(178365),m=n(616166),g=n(648982),h=n(857677),p=n(75496),b=n(291436),f=n(12855),C=n(596498),y=n(255507),v=n(76872),T=n(316904),x=n(639969),S=n(996211),w=n(664007),E=n(109174),I=n(778685),R=n(855539),A=n(910480),L=n(347145),k=n(447773),F=n(158058),_=n(8403),P=n(903173),N=n(83437);function M(e,t){return e.filter((e=>!t.includes(e)))}async function O(e){return e.context.load(e.columns,"items/name"),await e.context.sync(),e.columns.items.map((e=>e.name))}async function D(e,t,n){if(0===t.length)return!1;const{referencedColumns:a}=await(0,k.s_)(n,e.map((e=>e.nonLocalizedFormula??e.formula)),new Map);for(const e of t)if(a.includes(e))return!0;return!1}var B=n(729851),$=n(314793),H=n(803716),U=n(126521),q=n(659126),V=n(342935),W=n(540084),G=n(823860),z=n(20847),Q=n(672270);const j="en-US",J=(e,t,n)=>e?(0,s.iM)(e)?X(e,t,n):(0,s.cY)(e)?Y(e,t,n):"":JSON.stringify({publishPreference:G.f.Never}),Y=(e,t,n)=>{let o;const r=t().dataAI.tableName[n];r&&t().selection.selectionContexts[r]&&(o=(0,V.s6)(e,t().selection.selectionContexts[r]));const i=e.calculatedFormulas.map((e=>e.title??"")),l=e.calculatedFormulas.map((e=>e.formula));let s;return s=(0,q.hU)(e)?o?.[0]?(0,Q.VY)(a.qbK.Rows.SingleFormulaRecommendation,{title:i[0],formula:l[0],location:o[0]}):(0,Q.VY)(a.qbK.Rows.SingleFormulaRecommendationWithNoLocation,{title:i[0],formula:l[0]}):o?(0,Q.VY)(a.qbK.Rows.MultipleFormulaRecommendation,{titles:(0,z.q)(i,j),formulas:(0,z.q)(l,j),columnLocations:(0,z.q)(o,j)}):(0,Q.VY)(a.qbK.Rows.MultipleFormulaRecommendationWithNoLocation,{titles:(0,z.q)(i,j),formulas:(0,z.q)(l,j)}),JSON.stringify({text:s,formulas:l,titles:i,location:o,publishPreference:G.f.Never})},X=(e,t,n)=>{let o;const r=t().dataAI.tableName[n];r&&t().selection.selectionContexts[r]&&(o=(0,V.GC)(e,t().selection.selectionContexts[r]));const i=e.calculatedFormulas.map((e=>e.columnName)),l=e.calculatedFormulas.map((e=>e.formula));let s;return s=(0,q.hU)(e)?o?.[0]?(0,Q.VY)(a.qbK.Columns.SingleColumnRecommendation,{columnName:i[0]??"",formula:l[0]??"",columnLocation:o[0]}):(0,Q.VY)(a.qbK.Columns.SingleColumnRecommendationWithNoLocation,{columnName:i[0]??"",formula:l[0]??""}):o?(0,Q.VY)(a.qbK.Columns.MultipleColumnsRecommendation,{columnNames:(0,z.q)(i,j),formulas:(0,z.q)(l,j),columnLocations:(0,z.q)(o,j)}):(0,Q.VY)(a.qbK.Columns.MultipleColumnsRecommendationWithNoLocation,{columnNames:(0,z.q)(i,j),formulas:(0,z.q)(l,j)}),JSON.stringify({text:s,formula:l,columnName:i,locations:o,publishPreference:G.f.Never})};var Z=n(382736),K=n(110686);var ee=n(464077),te=n(147091),ne=n(795786),ae=n(420988),oe=n(252120);const re="success",ie=(e,t,a,i,l)=>async(c,d)=>{let u=re;try{if("inProgress"===d().dataAI.fetchRecommendationsState[e])return u="inProgress",Promise.resolve();const o=d().dataAI.tableName[e];if(!o)return u="noTableName",void Be(e,c);if(!l)return u="noQuery",void Be(e,c);c(R.m.startFetching(e)),c(w.m.startExecutingCommand({command:t,id:e}));const r=d().app.augloopModelWorkflowUnsupported,{localeCacheDeprecated:g}=d().selection;let b,C;try{b=d().selection.selectionContexts,C=await c((0,H.CQ)(o,e)),(0,L.yw9)("OfficeVSO_9610128_fixFailureToSendFormulaGenerationSignal")&&(b=d().selection.selectionContexts);const t=!r&&(0,L.rbw)();if(!b[o]||!C&&!t){if((0,L.yw9)("OfficeVSO_9693418_sendNoSelectionSignalV2"))throw new Error("send no selection signal");return u="noTableData",void Be(e,c)}}catch(e){if(!(0,L.yw9)("OfficeVSO_9693418_sendNoSelectionSignalV2"))throw e;T.M.getInstance().logErrorCode(m.O.FormulaGenerationGetSelectionContextsFailed,e,p.S2.FormulaGeneration,N.$b.Warning)}const y=$.R.getFormulaAITimeout();window.setTimeout((()=>{if("inProgress"===d().dataAI.fetchRecommendationsState[e]){const t=`Timeout on SDX after waiting ${y} seconds for calculated column suggestions from AL`;(0,te.CT)(e,c,t)}}),y),Promise.all([n.e("chunk1jsfluent"),n.e("vendors-npm_store_sdx_officecopilot_1js-excel-copilot-calc_8_3_43-1adabd76bb06679768ec_node_m-dd2f81"),n.e("calc")]).then(n.bind(n,478565));let x=[];return(0,L._mi)()&&(x=function(e,t){if(!(0,L.yw9)("OfficeVSO_9506002_DedupeTablesInExcelIntelligenceContext"))return e;const n=new Set,a=[...e].reverse().filter((e=>{const t=function(e){return e.tableName?e.tableName:[e.sheetName||e.range.worksheetId,e.range.top,e.range.left,e.range.bottom,e.range.right].join("|")}(e);return!n.has(t)&&(n.add(t),!0)}));return a.length===e.length?e:(v.E.getInstance().updateTelemetryChatEventData({[h.h3.ChatEventType]:h.a5.FormulaSuggestionDedupedContextTables,[h.h3.ChatEventParameters]:JSON.stringify({requestId:t,before:e.length,after:a.length})},T.M.getInstance()),a.reverse())}(d().selection.excelRecognizedTablesAnnotationsCache,e)),await(0,s.uq)(b?b[o]:void 0,(0,L.LrR)()?c((0,K.Z)()):g,C,e,a,r,[f.Rk.ChatPill,f.Rk.ChatZQM].includes(d().chat.queryOriginByQueryId[e]),l,d().chat.queryOriginByQueryId[e],o,i,x,d().chat.onGridQueryCellAddressByQueryId[e])}catch(t){u=t,Be(e,c)}finally{u!==re&&(T.M.getInstance().logErrorCode(m.O.FormulaGenerationCreateFetchOperationFailed,(0,h.Jr)(u),p.S2.FormulaGeneration,N.$b.Error,{key:p.nn.Operation,value:t}),T.M.getInstance().logStandardizedAshaErrorEvent(r.W.Unable_To_Complete_Task,o.c.Formula_Generation_Failed_To_Send_Signal,h.BJ.FormulaGeneration))}},le=(e,t,n)=>ie(e,h.OP.CalculatedColumns,I.az.ColumnSuggestion,t,n),se=(e,t,n)=>ie(e,h.OP.CalculatedCells,I.az.CellSuggestion,t,n),ce=(0,_.YQ)(((e,t,n)=>t().dataAI.fetchRecommendationsState[n])),de=(0,_.YQ)(((e,t,n)=>{const{activeRequestId:a,fetchRecommendationsState:o}=t().dataAI;return n===a&&"failed"!==o[n]})),ue=(e,t=s.VS.Column)=>async(n,o)=>{const r=o(),l=r.dataAI.activeRequestId;if(!(l&&"failed"===r.dataAI.fetchRecommendationsState[l]||l!==e.requestId)){if((0,L.cTR)()){const t=e.telemetry;t?.metrics&&t.metrics.length>0&&n(oe.m.addQueryMetrics({queryId:e.requestId,metrics:t.metrics}))}if(l){if(n(he(l)),i.lL.typeGuard(e)||i.Dv.typeGuard(e)||i.sG.typeGuard(e)){const t=(0,s.aG)(e.requestId,e.suggestionId);i.lL.typeGuard(e)&&e.previewValues&&e.previewValuesForVisibleRows?n(R.m.setPreviewForSuggestionID({suggestionId:t,preview:(0,q.mg)(e.previewValues),visibleRowsPreview:(0,q.mg)(e.previewValuesForVisibleRows)})):i.Dv.typeGuard(e)&&e.previewValues?fe(n,o,t,e.previewValues,l):r.app.augloopModelWorkflowUnsupported&&void 0===r.dataAI.rawPreview[t]&&R.m.setPreviewForSuggestionID({suggestionId:t,preview:[],visibleRowsPreview:[]})}const a=(0,s.mZ)(e,l,t);await Ce(o,a,l),await ye(n,o,a,l)}else{const{message:t,telemetry:o}=ne.n.getFormulaSuggestionErrorResponse((0,a.HGr)(),{shouldShowFormulaDevButton:r.dataAI.shouldShowFormulaDevButton,debugInfo:e.debugInfo});u.$.getInstance().displayResponse(t,o);const i=JSON.stringify({text:(0,Z.N)(t),publishPreference:"Never"});n((0,x.nv)(i,b.Aw.failed,o))}}},me=(0,_.YQ)(((e,t,n)=>{const a=(0,s.aG)(n.requestId,n.suggestionId);if(i.lL.typeGuard(n)&&n.previewValues&&n.previewValuesForVisibleRows)e(R.m.setPreviewForSuggestionID({suggestionId:a,preview:(0,q.mg)(n.previewValues),visibleRowsPreview:(0,q.mg)(n.previewValuesForVisibleRows)}));else if(i.Dv.typeGuard(n)&&n.previewValues)fe(e,t,a,n.previewValues,n.requestId);else{const{app:e,dataAI:n}=t();e.augloopModelWorkflowUnsupported&&void 0===n.rawPreview[a]&&R.m.setPreviewForSuggestionID({suggestionId:a,preview:[],visibleRowsPreview:[]})}})),ge=(0,_.YQ)((async(e,t,n,a)=>{const o={[i.lL.getTypeName()]:s.VS.Column,[i.Dv.getTypeName()]:s.VS.Cell,[i.sG.getTypeName()]:s.VS.Formula}[C.h.getTypeNameFor(n)],r=(0,s.mZ)(n,n.requestId,o);await Ce(t,r,n.requestId),await ye(e,t,r,n.requestId,a)})),he=(0,_.YQ)((async(e,t,n)=>{const{dataAI:a}=t();if(0===a.recommendations[n].length){const t=a.tableName[n];if(t)try{await e((0,H.VW)(t,n))}catch(e){T.M.getInstance().logErrorCode(m.O.ResolveTableLikeEntityFailed,e,p.S2.FormulaGeneration,N.$b.Warning)}}}));var pe;!function(e){e[e.Never=0]="Never",e[e.Force=1]="Force",e[e.IfNeeded=2]="IfNeeded"}(pe||(pe={}));const be=(0,_.YQ)((async(e,t,n,a,o,r)=>{1===n&&await e((0,H.VW)(o,r));const i=2===n?await e((0,H.aM)(o,r)):e((0,H.cQ)(o)),l=await e((0,H.CQ)(o,r));if(!i||!a&&!l)throw new Error("getLatestContextForInsertion: latest context not found for table name");return{selectionContext:i,tableColumnHeaders:!a&&i.hasTableHeaders?l.values[0].map((e=>String(e))):void 0}})),fe=async(e,t,n,a,o)=>{const r=(0,S.cQ)(o,t());if(r){const{showTotals:n}=r,a=n?t().dataAI.currentTotalRowValues[o]??await T.M.getInstance().runTimedAsyncFunction("GetCurrentRowValues",(()=>(0,s.jI)(r)),o):void 0;e(R.m.setCurrentRowValuesForRequestId({requestId:o,currentTotalRowValues:a}))}e(R.m.setPreviewForSuggestionID({suggestionId:n,preview:[a],visibleRowsPreview:[]}))},Ce=async(e,t,n)=>{if(t?.success&&t?.result&&(0,s.$k)(t.result)){const a=e().dataAI.recommendations[n];if(-1===a.findIndex((e=>t.result.some((t=>t.id===e.id))))){t.result.forEach((e=>{e.isSingleFormula=(0,q.XZ)(e)}));const a=await Ae(e,t.result,n);t.result.forEach(((e,t)=>{e.allowReplacementOfExistingValue=a[t]}));const o=await Le(e,t.result,n);t.result.forEach(((e,t)=>{e.insertRowTitle=o[t]})),v.E.getInstance().updateTelemetryChatEventData({[h.h3.ChatEventType]:h.a5.CalculatedRowsSuggestionsReceived,[h.h3.ChatEventParameters]:JSON.stringify({isUpdateSuggestion:a})},T.M.getInstance())}else t.result.forEach((e=>{const t=a.find((t=>t.id===e.id));t&&(e.insertRowTitle=t.insertRowTitle)}))}},ye=async(e,t,n,i,l=!1)=>{if(n.success){if(n.result){if(!(0,s.L$)(n.result)&&!(0,s.$k)(n.result)&&!(0,s.s9)(n.result))return;if(e(R.m.fetchRecommendationsSucceeded({requestId:i,recommendation:n.result})),(0,s.s9)(n.result))return void ve(e,t,n.result,i,l);const[a]=n.result,o=t().dataAI.recommendations[i].find((e=>e.id===a.id));if(o&&void 0===o.preview&&e(De(i,a)),!t().dataAI.isVisible[i]){e(R.m.markVisible(i));const[a]=n.result;(0,L.Jhm)()&&T.M.getInstance().runTimedAsyncFunction("FormulaSuggestionInvalidatorTrack",(()=>Se.track(i,(0,S.cQ)(i,t()),a,((t,n)=>{e(R.m.markRecommendationAsInvalidated({reason:t,suggestionId:n}))}))),i,a.id),ve(e,t,n.result,i,l)}(0,L.yw9)("OfficeVSO_10041717_fixPillNotShow")&&Te(e,t,i)}}else{e(R.m.fetchRecommendationsFailed(i));const c=t().dataAI.recommendations[i].length;if(!c){const c=[f.Rk.ChatPill,f.Rk.ChatZQM].includes(t().chat.queryOriginByQueryId[i]);let d=c?a.olU.ServerErrorWithNoRetrySuggestionPill:a.olU.ServerErrorWithNoRetry,m=h.q0.ServiceError,p=r.W.Unable_To_Complete_Task,C=o.c.Service_Error_Unknown_Error;const y=n.suggestionMetadata.shouldFallbackToElse;switch(y&&g.s.getInstance().setLastFormulaRequestDebugInfo(n.debugInfo),n.suggestionMetadata.result){case I.sR.NoSuggestion:m=h.q0.NoSuggestions,c?(p=r.W.Unable_To_Complete_Task,C=o.c.Failed_Column_Suggestion_Generation_For_Suggestion_Pill):(d=a.olU.CalculatedColumnsNLNoResults,p=r.W.User_Input_Could_Not_Be_Processed,C=o.c.Failed_Column_Suggestion_Generation_For_User_Prompt);break;case I.sR.UserThrottled:p=r.W.Unable_To_Generate_Response_Due_To_Capacity_Issue,C=o.c.LLM_Throttled,d=(0,a.UDz)(),m=h.q0.UserThrottled;break;case I.sR.MultipleFormulas:p=r.W.Missing_Copilot_Functionality,C=n.suggestionType===s.VS.Cell?o.c.Formula_Generation_Unsupported_Multiple_Rows:o.c.Formula_Generation_Unsupported_Multiple_Columns,c||(d=a.olU.CalculatedRowsNLMultipleRows),m=h.q0.NotSingleColumn;break;case I.sR.HarmfulContent:p=r.W.Responsible_AI_Filter_Blocked_Response,C=o.c.Suggestion_Blocked_Due_To_RAI,m=h.q0.RaiError;break;case I.sR.IrrelevantQuery:p=r.W.Missing_Copilot_Functionality,C=o.c.Calculated_Column_Out_Of_Scope_Scenarios,m=h.q0.IrrelevantQuery;break;case I.sR.LlmGeneralErrorFailure:p=r.W.LLM_Service_Side_Issue_Prevents_Output,C=o.c.Service_Error_Augloop,m=h.q0.LLMServiceError}y||T.M.getInstance().logStandardizedAshaErrorEvent(p,C,h.BJ.FormulaGeneration);const v=void 0,S=t().app.augloopModelWorkflowUnsupported;let E;switch(n.suggestionMetadata.result){case I.sR.MultipleFormulas:E=void 0;break;case I.sR.UserThrottled:E=(0,a.yUb)(S).map((e=>({text:e})));break;default:E=c?void 0:(0,a.yUb)(S).map((e=>({text:e})))}const{message:R,telemetry:A}=ne.n.getFormulaSuggestionErrorResponse(d,{shouldShowFormulaDevButton:t().dataAI.shouldShowFormulaDevButton,debugInfo:n.debugInfo},m,E);if(y||u.$.getInstance().displayResponse(R,A,v),l)y||e(w.m.stopExecuting({isSuccess:!1}));else{const t=JSON.stringify({text:(0,Z.N)(R),publishPreference:"Never",fallbackToElse:y}),n=!y,a=!y;e((0,x.nv)(t,b.Aw.failed,A,n,a))}}T.M.getInstance().logErrorCode(c?m.O.ExcelIntelligenceSignalFailedWithSuggestions:m.O.ExcelIntelligenceSignalFailed,(0,h.Jr)(n.suggestionMetadata.result),p.S2.FormulaGeneration,N.$b.Error)}},ve=async(e,t,n,a,o=!1)=>{const[r]=n;let i;i=(0,L.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.FormulaGenerationNewNlToFormulaSkill",!1)&&(0,s.s9)(n)?ne.n.getFormulaSuggestionMarkdownResponse(n[0],t().dataAI.shouldShowFormulaDevButton,e,a):ne.n.getFormulaSuggestionResponse(a,0,n);const{message:c,telemetry:d}=i;if(u.$.getInstance().displayResponse(c,d),o)e(w.m.stopExecuting({isSuccess:!0}));else{const n=J(r,t,a);e((0,x.nv)(n,b.Aw.success,d))}const m=r.calculatedFormulas[0]?.insertionMode;T.M.getInstance().logEvent((0,h.SV)(h.he.SuggestionShown,He(r),h.KZ.NLChatRequest,r.id,a,void 0!==m?l.PH[m]:void 0)),(0,L.yw9)("OfficeVSO_10041717_fixPillNotShow")||Te(e,t,a)},Te=(e,t,n)=>{if(!t().dataAI.hasShownSuggestionPrompt[n])if(t().dataAI.activeRequestId===n&&0===t().dataAI.currentShownSuggestionIndex[n]&&t().dataAI.recommendations[n].length>1){const a=t().dataAI.recommendations[n][1];e(R.m.setHasShownSuggestionPrompt(n)),e((0,x.Vf)(n,!a.isAlternativeSuggestion,a.suggestionType))}else{if(t().dataAI.activeRequestId===n&&0===t().dataAI.currentShownSuggestionIndex[n]&&(0,s.cY)(t().dataAI.recommendations[n][0]))return;e((0,x.Yx)(["CalculatedColumns_SpecificSuggestion"]))}},xe=new class extends d{track(e,t,n){if(this.isTracking(e))return void(0,c.cY)("ColumnPreviewInvalidator: already tracking",e);const{sheetId:a,sheetName:o,tableName:r}=t;if(!a||!o||!r)return void(0,c.cY)("ColumnPreviewInvalidator: invalid selection context");(0,c.cY)("ColumnPreviewInvalidator: tracking",e);const i=(t,a)=>{(0,c.cY)("ColumnPreviewInvalidator: invalidating",t,e,a),this.stopTracking(e),n()};Excel.run((async t=>{const n=t.workbook.worksheets.getItem(a),o=[n.onChanged.add((async e=>{i("sheetChanged",e)})),n.onDeactivated.add((async e=>{i("sheetDeactivated",e)}))];this.addCleanupFunctions(e,...o),await t.sync()}))}},Se=new class extends d{async track(e,t,n,a){if(this.isTracking(n.id))T.M.getInstance().logError({eventType:p.S2.ChatEvents,errorMessage:`FormulaSuggestionInvalidator: already tracking suggestion ${n.id}`,logLevel:N.$b.Warning});else if((0,S.k8)(t)){this.saveRequestId(n.id,e),this.addCleanupFunctions(n.id,{remove:()=>this.removeRequestId(n.id,e)}),this.invalidationCallbacks.set(n.id,a),this.addCleanupFunctions(n.id,{remove:()=>this.invalidationCallbacks.delete(n.id)});try{await this.startTracking(n,t)}catch(e){T.M.getInstance().logError({eventType:p.S2.ChatEvents,errorMessage:`FormulaSuggestionInvalidator: failed to start tracking suggestion ${n.id} with error ${e}`,logLevel:N.$b.Warning})}}else T.M.getInstance().logError({eventType:p.S2.ChatEvents,errorMessage:"FormulaSuggestionInvalidator: track called with invalid selection context",logLevel:N.$b.Warning})}async startTracking(e,t){const{sheetId:n,tableName:a}=t;return Excel.run((async o=>{const r=o.workbook.worksheets.getItem(n).tables.getItemOrNullObject(a);r.load("isNullObject"),await o.sync(),v.E.getInstance().updateTelemetryChatEventData({[h.h3.ChatEventType]:h.a5.FormulaSuggestionTrackedForInvalidation,[h.h3.ChatEventParameters]:JSON.stringify({suggestionId:e.id})},T.M.getInstance()),this.addCleanupFunctions(e.id,{remove:_.F_.startListening({actionCreator:w.m.setLatestRequestId,effect:(t,n)=>{const{latestRequestId:a}=n.getOriginalState().chat;t.payload!==a&&this.stopTracking(e.id)}})}),r.isNullObject?await this.registerTLREvents(e,t):await this.registerTableEvents(e,r),await o.sync()}))}invalidate(e,t,n=void 0){(0,c.cY)("FormulaSuggestionInvalidator: invalidating",e,t,n);const a=this.invalidationCallbacks.get(e);a&&a(t,e),this.stopTracking(e)}async registerTLREvents(e,t){this.addCleanupFunctions(e.id,{remove:_.F_.startListening({actionCreator:R.m.markRecommendationInserted,effect:(t,n)=>{const{requestId:a,suggestionId:o}=t.payload;if(o===e.id)return void(0,c.cY)("FormulaSuggestionInvalidator: markRecommendationInserted: suggestionId is the tracked suggestionId");const r=this.trackedSuggestionsByRequestId.get(a);(0,c.cY)("FormulaSuggestionInvalidator: markRecommendationInserted",{suggestionId:o,requestId:a,siblings:r}),r?.has(e.id)&&this.invalidate(e.id,"SiblingRecommendationInserted")}})});const{sheetId:n,address:a}=t;if(n&&a){const t=(0,F.py)(a),o=(0,A.debounce)((n=>{const a=n[t];(0,c.cY)("FormulaSuggestionInvalidator: TabularRangeChanged",{currentTable:t,sheetTables:n}),a||this.invalidate(e.id,"TabularRangeChanged",`Table ${t} not found in ${Object.keys(n)}`)}),2e3);this.addCleanupFunctions(e.id,{remove:_.F_.startListening({actionCreator:P.m.updateTableInterpretationsForSheet,effect:({payload:a},{getState:r})=>{if(a.sheetId!==n)return void(0,c.cY)("FormulaSuggestionInvalidator: updateTableInterpretationsForSheet: sheetId is different, skipping");const i=r().selection.tabularRanges;i?.[n]?(!function(e){v.E.getInstance().updateTelemetryChatEventData({[h.h3.ChatEventType]:h.a5.FormulaSuggestionInvalidationTrackingData,[h.h3.ChatEventParameters]:JSON.stringify(e)},T.M.getInstance())}({sheetId:n,currentTable:t,suggestionId:e.id,type:"tabularRangesChanged",tablesInSheet:Object.keys(i[n]),tablesInPayload:Object.keys(a.newInterpretations)}),o(i[n])):T.M.getInstance().logError({eventType:p.S2.ChatEvents,errorMessage:"FormulaSuggestionInvalidator: updateTableInterpretationsForSheet: tablesBySheet?.[sheetId] is undefined",logLevel:N.$b.Warning})}})})}else T.M.getInstance().logError({eventType:p.S2.ChatEvents,errorMessage:"FormulaSuggestionInvalidator: registerTLREvents: selectionContext is invalid",logLevel:N.$b.Warning})}async registerTableEvents(e,t){let n=await O(t);const a=t.id,o=[t.worksheet.tables.onDeleted.add((async t=>{(0,c.cY)("FormulaSuggestionInvalidator: tableDeleted",t),t.tableId===a&&this.invalidate(e.id,"TableDeleted",t)})),t.onChanged.add((async t=>{(0,c.cY)("FormulaSuggestionInvalidator: tableChanged",t),await Excel.run((async a=>{try{const o=a.workbook.tables.getItem(t.tableId);switch(t.changeType){case Excel.DataChangeType.rangeEdited:{const r=(0,L.yw9)("OfficeVSO_9663933_FixFormulaSuggestionInsertionInvalidArgErrors")?t.getRangeOrNullObject(a):t.getRange(a),i=o.getHeaderRowRange(),l=r.getIntersectionOrNullObject(i);r.load("isNullObject"),l.load("isNullObject"),await a.sync();const s=await O(o),d=r.isNullObject;(d||!l.isNullObject)&&await async function(e,t,n,a){if(!a){const a=await D(e.calculatedFormulas,M(t,n),t);return(0,c.cY)(`shouldInvalidateOnHeaderEdit: ${a}, change is undefined (multiple cells were edited at once) tested by the removed columns`),a}if(a.valueTypeBefore===Excel.RangeValueType.empty)return(0,c.cY)("shouldInvalidateOnHeaderEdit: false because the header was empty before the change (the user is adding a new column)"),!1;if(await D(e.calculatedFormulas,[a.valueBefore],t))return(0,c.cY)("shouldInvalidateOnHeaderEdit: true because header was found in the formula"),!0;return!1}(e,n,s,d?void 0:t.details)&&this.invalidate(e.id,"ColumnHeaderEdited",t),n=s;break}case Excel.DataChangeType.columnInserted:n=await O(o);break;case Excel.DataChangeType.columnDeleted:{const a=await O(o),r=M(n,a);n=a,await D(e.calculatedFormulas,r,n)&&this.invalidate(e.id,"ColumnDeleted",t)}}}catch(e){T.M.getInstance().logError({eventType:p.S2.ChatEvents,errorMessage:`FormulaSuggestionInvalidator: tableChanged: ${e}`,logLevel:N.$b.Warning})}}))}))];(0,L.yw9)("OfficeVSO_9663933_FixFormulaSuggestionInsertionInvalidArgErrors")?this.addCleanupFunctions(e.id,{remove:()=>{o.forEach((e=>{Excel.run(e.context,(async()=>{e.remove()})).catch((()=>{}))}))}}):this.addCleanupFunctions(e.id,...o)}saveRequestId(e,t){this.trackedSuggestionsByRequestId.has(t)||this.trackedSuggestionsByRequestId.set(t,new Set),this.trackedSuggestionsByRequestId.get(t).add(e)}removeRequestId(e,t){const n=this.trackedSuggestionsByRequestId.get(t);n&&(n.delete(e),0===n.size&&this.trackedSuggestionsByRequestId.delete(t))}constructor(...e){super(...e),this.invalidationCallbacks=new Map,this.trackedSuggestionsByRequestId=new Map}},we=(e,t,n)=>async(a,o)=>{const{previewId:r}=o().dataAI;r===t.id?a(Ie(e,r)):a(Ee(e,t,n))},Ee=(e,t,n={hidePreviewOnChange:!1,moveViewportToPreview:!1})=>async(a,i)=>{if(i().dataAI.previewId!==t.id&&(0,S.c5)(e,t,i()))try{const o=(0,S.cQ)(e,i());if(!o||!(0,S.k8)(o))return;null!=i().dataAI.previewId&&await(0,s.hK)(o.sheetName),a(R.m.startPreviewing(t.id));const r=async r=>{if(!(0,s.iM)(t))throw Error("showPreviewColumn called with non-column recommendation");i().dataAI.previewId===t.id&&(await T.M.getInstance().runTimedAsyncFunction("ShowPreviewColumn",(()=>(0,s.gA)(t.calculatedFormulas.map((e=>e.columnName)),o,r,(async()=>{(0,c.cY)("showPreviewColumn.previewDismissed"),xe.stopTracking(t.id),a(R.m.stopPreviewing())}),n.moveViewportToPreview,(0,S.py)(t,o))),e,t.id),n.hidePreviewOnChange&&xe.track(t.id,o,(()=>{a(Ie(e,t.id))})),null===i().dataAI.previewId&&o.sheetName&&await(0,s.hK)(o.sheetName))},l=async r=>{if(!(0,s.cY)(t))throw Error("showPreviewRow called with non-cell recommendation");if(i().dataAI.previewId===t.id){const l=(0,s.JM)(t),d=t.insertRowTitle?0:l?.[0],u=await(0,S.Fw)(t,o,d);await T.M.getInstance().runTimedAsyncFunction("showPreviewRow",(()=>(0,s.wr)(o,(0,q.XR)(r,l,t.insertRowTitle,i().dataAI.currentTotalRowValues[e]),d,(async()=>{(0,c.cY)("showPreviewRow.previewDismissed"),xe.stopTracking(t.id),a(R.m.stopPreviewing())}),n.moveViewportToPreview,u)),e,t.id),n.hidePreviewOnChange&&xe.track(t.id,o,(()=>{a(Ie(e,t.id))})),null===i().dataAI.previewId&&o.sheetName&&await(0,s.hK)(o.sheetName)}},d=async r=>{if(!(0,s.be)(t))throw Error("showPreviewFormula called with non-formula recommendation");if(t.calculatedFormulas.length>1)throw Error("showPreviewFormula currently only supported for single formula recommendations");if(i().dataAI.previewId===t.id){const{previewValues:r,anchorCellAddress:l}=await(0,S.gE)(t,o);if(!l)throw Error("Could not determine anchor cell for formula preview");await T.M.getInstance().runTimedAsyncFunction("showPreviewFormula",(()=>(0,s.fS)(l,r,(async()=>{(0,c.cY)("showPreviewFormula.previewDismissed"),xe.stopTracking(t.id),a(R.m.stopPreviewing())}))),e,t.id),n.hidePreviewOnChange&&xe.track(t.id,o,(()=>{a(Ie(e,t.id))})),null===i().dataAI.previewId&&await(0,s.hK)()}};let u;u=(0,s.be)(t)?d:(0,s.cY)(t)?l:r;const m=i().dataAI.rawPreview[t.id];m||(0,s.be)(t)?u(m):_.F_.startListening({actionCreator:R.m.setPreviewForSuggestionID,effect:(e,n)=>{n.unsubscribe();const a=n.getState().dataAI.rawPreview[t.id];a&&u(a)}})}catch(e){T.M.getInstance().logErrorCode(m.O.ShowPreviewColumnFailed,e,p.S2.FormulaGeneration,N.$b.ASHA,{key:h.un.SuggestionID,value:t.id}),T.M.getInstance().logStandardizedAshaErrorEvent(r.W.UI_Failed_To_Update_Or_Load,o.c.Preview_On_Grid_Failed_To_Display,h.BJ.FormulaGeneration),a(R.m.stopPreviewing())}},Ie=(e,t)=>async(n,a)=>{if(xe.stopTracking(t),null==a().dataAI.previewId)return;let o;if((0,L.yw9)("OfficeVSO_10207489_hidePreviewOnActiveSheet")&&(0,s.be)(a().dataAI.recommendations[e][0]))o=void 0;else{const t=(0,S.cQ)(e,a());if(!t||!(0,S.k8)(t))return;o=t.sheetName}try{n(R.m.stopPreviewing()),await T.M.getInstance().runTimedAsyncFunction("HidePreviewColumn",(()=>(0,s.hK)(o)),e,t)}catch(e){T.M.getInstance().logErrorCode(m.O.HidePreviewColumnFailed,e,p.S2.FormulaGeneration,N.$b.ASHA,{key:h.un.SuggestionID,value:t})}},Re=(e,t)=>async(n,o)=>{const r=t.calculatedFormulas[0]?.insertionMode;T.M.getInstance().logEvent((0,h.SV)(h.he.SuggestionApplied,h.q.CalculatedRows,h.KZ.AddButton,t.id,e,void 0!==r?l.PH[r]:void 0));const i=(0,q.Z)(t)?t.allowReplacementOfExistingValue?(0,a.KeO)():(0,a.E$x)():t.allowReplacementOfExistingValue?(0,a.ooE)():(0,a.EWN)();_e(n,o,e,t,i,s.fJ,s.jL,Me)},Ae=async(e,t,n)=>{const a=performance.now();(0,c.cY)("getShouldAllowReplacementOfExistingValueInTotalRow start",n,t,a);let o=t.map((()=>!1));const r=e().dataAI.tableName[n];if(r){const a=e().selection.selectionContexts[r];if(a?.showTotals){const e=t.map((e=>e.calculatedFormulas.flatMap((e=>e.insertionIndexes??[]))));let r=await(0,ae.U)(e,a,n)??e.map((()=>!0));(0,L.yw9)("OfficeVSO_9753947_insertCellToFixedRange")&&(r=await Promise.all(r.map((async(e,n)=>{const a=t[n];if((0,q.By)(a)){return await(0,q.Qy)(a.calculatedFormulas[0].fixedInsertionRange)}return e})))),o=r.map((e=>!e))}}return(0,c.cY)("getShouldAllowReplacementOfExistingValueInTotalRow end",n,t,performance.now()-a,o),o},Le=async(e,t,n)=>{const a=e().dataAI.tableName[n];if(!a)return t.map((()=>!1));const o=e().selection.selectionContexts[a];if(!o)return t.map((()=>!1));const r=o.showTotals;let i;return await Promise.all(t.map((async e=>{if((0,q.By)(e))return!1;if((0,q.th)(e))return!1;return!e.calculatedFormulas.some((e=>e.insertionIndexes.includes(0)))&&(!r||await(async()=>(void 0===i&&(i=(await(0,ae.U)([[0]],o,n))?.[0]??!1),i))())})))},ke=(e,t)=>async n=>{const i=e.calculatedFormulas[0]?.insertionMode;T.M.getInstance().logEvent((0,h.SV)(h.he.SuggestionApplied,He(e),h.KZ.AddButton,e.id,t,void 0!==i?l.PH[i]:void 0)),n(w.m.startInsertingFormulaSuggestion());const{message:c,telemetry:d}=ne.n.getInsertSuggestionUserChat((0,a.oOI)());u.$.getInstance().displayResponse(c,d),n((0,x.eM)(h.OP.InsertFormulaSuggestion)),n(Ie(t,e.id));try{await T.M.getInstance().runTimedAsyncFunction("InsertFormulaSuggestion",(()=>(0,s.g0)(e)),t,e.id),n((0,x.Nl)()),await n((0,x.L4)()),n((0,x._Z)({caller:"insertFormulaSuggestion"}));const{message:o,telemetry:r}=ne.n.getFormulaSuggestionInsertSuccessResponse((0,a.ZDb)(),e.id,(()=>n(P.m.restoreTableInterpretationsForUndo())));u.$.getInstance().displayResponse(o,r),n(w.m.stopInsertingFormulaSuggestion()),u.$.getInstance().setInputFocus(),y.B.getInstance().logKeptEvent(h.BJ.FormulaGeneration,He(e),B.RX.Create)}catch(t){const i=(0,a.ySS)();T.M.getInstance().logStandardizedAshaErrorEvent(r.W.Unable_To_Complete_Task,o.c.Failed_Column_Insertion,h.BJ.FormulaGeneration);const{message:l,telemetry:s}=ne.n.getFormulaSuggestionErrorResponse(i,{shouldShowFormulaDevButton:!0,debugInfo:e.debugInfo});u.$.getInstance().displayResponse(l,s),n(w.m.stopInsertingFormulaSuggestion()),T.M.getInstance().logErrorCode(m.O.InsertFormulaSuggestionFailed,t,p.S2.FormulaGeneration,N.$b.Warning,{key:h.un.SuggestionID,value:e.id}),await n((0,x.L4)())}},Fe=(e,t)=>async(n,o)=>{const r=t.calculatedFormulas[0]?.insertionMode;T.M.getInstance().logEvent((0,h.SV)(h.he.SuggestionApplied,h.q.CalculatedColumns,h.KZ.AddButton,t.id,e,void 0!==r?l.PH[r]:void 0));const i=(0,q.hU)(t)?(0,a.aVz)():(0,a.BqH)();_e(n,o,e,t,i,s.xw,s.Fw,Ne)},_e=async(e,t,n,a,o,r,i,l)=>{const c=(0,s.iM)(a);(0,L.Jhm)()&&Se.stopTracking(a.id),e(w.m.startInsertingFormulaSuggestion());const{message:d,telemetry:g}=ne.n.getInsertSuggestionUserChat(o);if(u.$.getInstance().displayResponse(d,g),!(0,V.CU)(a))return void Oe(e,a.debugInfo);const f=t().dataAI.tableName[n];if(!f)return void Oe(e,a.debugInfo);const C=(0,L.yw9)("OfficeVSO_9663933_FixFormulaSuggestionInsertionInvalidArgErrors");let{selectionContext:v,tableColumnHeaders:S}=await e(be(C?2:0,c,f,n));const I=(0,L.LrR)()?e((0,K.Z)()):t().selection.localeCacheDeprecated;if(!c)if((0,q.th)(a))try{E.CP.calculatedFormulaInsertLocation=await(0,q.a$)()}catch(t){Oe(e,a.debugInfo)}else(0,q.By)(a)?E.CP.calculatedFormulaInsertLocation=a.calculatedFormulas[0].fixedInsertionRange:E.CP.calculatedFormulaInsertLocation=function(e,t){const n=t.rowIndex+t.rowCount+1,a=(0,V.s6)(e,t);return`${1===a?.length?a[0]:""}${n}`}(a,v);const A=function(e){if((0,s.iM)(e))return(0,q.hU)(e)?h.OP.InsertCalculatedColumn:h.OP.InsertCalculatedColumns;return e.allowReplacementOfExistingValue?(0,q.Z)(e)?h.OP.UpdateCalculatedCell:h.OP.UpdateCalculatedCells:(0,q.Z)(e)?h.OP.InsertCalculatedCell:h.OP.InsertCalculatedCells}(a);e((0,x.eM)(A)),e(Ie(n,a.id));try{let{insertionAddresses:o,insertionError:d}=await r(a,f,v,n,I,S);if((0,L.yw9)("OfficeVSO_9663933_FixFormulaSuggestionInsertionInvalidArgErrors")&&d&&"InvalidArgument"===d.code){const t=v.address;({selectionContext:v,tableColumnHeaders:S}=await e(be(1,c,f,n))),t!==v.address&&(T.M.getInstance().logErrorCode(m.O.InsertCalculatedColumnFailedWithInvalidArgTableRangeChanged,d,p.S2.FormulaGeneration,N.$b.Warning,{key:h.un.SuggestionID,value:a.id}),({insertionAddresses:o,insertionError:d}=await r(a,f,v,n,I,S)))}if(d){const t=!(0,q.hU)(a);if(Pe(e,d,a.id,c,t,(0,s.cY)(a)&&(0,q.th)(a),a.debugInfo),0===o.length)return void await e((0,x.L4)());t||T.M.getInstance().logErrorCode(m.O.CalculatedColumnInsertColumnError,(0,h.Jr)("Got insertion error but still have insertion addresses (but not for multi columns)"),p.S2.FormulaGeneration,N.$b.Warning,{key:h.un.SuggestionID,value:a.id})}else try{const{dataAI:e}=t();i(e.rawPreview[a.id],o,v,n)}catch(e){T.M.getInstance().logErrorCode(m.O.CalculatedColumnInsertColumnFailedVerifyPreview,e,p.S2.FormulaGeneration,N.$b.Warning,{key:h.un.SuggestionID,value:a.id})}v.sheetId?(e(P.m.cacheTableInterpretationsForUndo()),e((0,H.XT)(v.sheetId,f,o))):e(P.m.hideSelectionErrorOnRange((0,ee.G2)(f))),e((0,x.Nl)()),e(R.m.markRecommendationInserted({requestId:n,suggestionId:a.id}));try{e(P.m.clearTable(f)),await e((0,H.VW)(f,n))}catch(e){T.M.getInstance().logErrorCode(m.O.CalculatedColumnsInsertColumnFailedResolveTableLikeEntity,e,p.S2.FormulaGeneration,N.$b.Warning,{key:h.un.SuggestionID,value:a.id})}await e((0,x.L4)()),e((0,x._Z)({caller:"insertColumnsRecommendation"}));const g=l(a,o,f),{message:C,telemetry:E}=ne.n.getFormulaSuggestionInsertSuccessResponse(g,a.id,(()=>e(P.m.restoreTableInterpretationsForUndo())));u.$.getInstance().displayResponse(C,E);const A=(0,Z.N)(C);(0,L.yw9)("OfficeVSO_9598840_SkipRedundantSkillResponse")||e((0,x.nv)(A,b.Aw.success,E)),e(w.m.stopInsertingFormulaSuggestion()),u.$.getInstance().setInputFocus(),y.B.getInstance().logKeptEvent(h.BJ.FormulaGeneration,He(a),B.RX.Create)}catch(t){await Pe(e,t,a.id,c,!(0,q.hU)(a),(0,s.cY)(a)&&(0,q.th)(a),a.debugInfo),await e((0,x.L4)())}},Pe=async(e,t,n,i,l,s,c)=>{const d=t instanceof OfficeExtension.Error?t.code:null;let g="";s&&"PivotTableRangeConflict"===d?(g=a.olU.CalculatedRowsSelectedCellPivotTableSelected,T.M.getInstance().logStandardizedAshaErrorEvent(r.W.Unable_To_Complete_Task,o.c.Failed_Column_Insertion_Due_To_Conflict_In_The_Target_Range,h.BJ.FormulaGeneration)):"InsertDeleteConflict"===d||"PivotTableRangeConflict"===d||d===m.O.CalculatedColumnExpandFailedNotEmptyColumn?(g=i?l?(0,a.J0g)():(0,a.Goo)():(0,a.SXB)(),T.M.getInstance().logStandardizedAshaErrorEvent(r.W.Unable_To_Complete_Task,o.c.Failed_Column_Insertion_Due_To_Conflict_In_The_Target_Range,h.BJ.FormulaGeneration)):"AccessDenied"===d?(g=i?(0,a.YbA)():(0,a.wQR)(),T.M.getInstance().logStandardizedAshaErrorEvent(r.W.Unable_To_Complete_Task,o.c.Failed_Column_Insertion_Due_To_Protection_Settings,h.BJ.FormulaGeneration)):"ItemNotFound"===d?(g=i?(0,a.ZX_)():(0,a.Rc5)(),T.M.getInstance().logStandardizedAshaErrorEvent(r.W.Unable_To_Complete_Task,o.c.Failed_Column_Insertion_Due_To_Target_Table_Error,h.BJ.FormulaGeneration)):(g=i?(0,a.u3x)():(0,a.mYV)(),T.M.getInstance().logStandardizedAshaErrorEvent(r.W.Unable_To_Complete_Task,o.c.Failed_Column_Insertion,h.BJ.FormulaGeneration));const{message:f,telemetry:C}=ne.n.getFormulaSuggestionErrorResponse(g,{shouldShowFormulaDevButton:!0,debugInfo:c});if(u.$.getInstance().displayResponse(f,C),!(0,L.yw9)("OfficeVSO_9598840_SkipRedundantSkillResponse")){const t=JSON.stringify({text:(0,Z.N)(f),publishPreference:"Never"});e((0,x.nv)(t,b.Aw.failed,C))}e(w.m.stopInsertingFormulaSuggestion()),T.M.getInstance().logErrorCode(m.O.InsertCalculatedColumnFailed,t,p.S2.FormulaGeneration,N.$b.Warning,{key:h.un.SuggestionID,value:n})},Ne=(e,t,n)=>{const o=t.map((e=>/:([A-Z]+)/.exec(e)?.[1])),r=o.every((e=>e));if(r||T.M.getInstance().logErrorCode(m.O.CalculatedColumnsInsertColumnFailedGetRange,(0,h.Jr)("Failed to get column letter"),p.S2.FormulaGeneration,N.$b.Warning,{key:h.un.SuggestionID,value:e.id}),1===o.length){const t=e.calculatedFormulas[0].columnName;return r?(0,U.L)((0,a.OfU)(),t,o[0]):(0,U.L)((0,a.q_f)(),t,n)}if(o.length>3)return(0,Q.VY)((0,a.xau)(),{columnLength:o.length.toString()});{const t=o.map(((t,n)=>e.calculatedFormulas[n].columnName)),i=(0,z.q)(t?.map((e=>`'${e}'`))??[]);if(r){const e=(0,z.q)(o.filter((e=>"string"==typeof e)));return(0,Q.VY)((0,a.L8i)(),{columnNames:i,columnHeaders:e})}return(0,Q.VY)((0,a.AKP)(),{columnNames:i,tableName:n})}},Me=(e,t,n)=>{const o=(0,q.th)(e)&&t.length>0?(0,q.gx)(t[0])??"":E.CP.calculatedFormulaInsertLocation??"",r="CalculatedRowsConfirmationTextForCellWithAddress",i="CalculatedRowsConfirmationTextForUpdateCellWithAddress",l="CalculatedRowsConfirmationTextForRowWithAddress",s="CalculatedRowsConfirmationTextForUpdateRowWithAddress",c="CalculatedRowsCellHeader",d="CalculatedRowsRowHeader";let u;u=(0,q.XZ)(e)?e.allowReplacementOfExistingValue?i:r:e.allowReplacementOfExistingValue?s:l;return((e,t)=>{const n=a.olU[e],r=`**${a.olU[t]}**`,i=t===c?"cellAddress":"rowNumber";return n.replace("{0}",r).replace(`{${i}}`,o)})(u,(0,q.XZ)(e)?c:d)},Oe=(e,t)=>{const{message:n,telemetry:o}=ne.n.getFormulaSuggestionErrorResponse((0,a.u3x)(),{shouldShowFormulaDevButton:!0,debugInfo:t});if(u.$.getInstance().displayResponse(n,o),!(0,L.yw9)("OfficeVSO_9598840_SkipRedundantSkillResponse")){const t=JSON.stringify({text:(0,Z.N)(n),publishPreference:"Never"});e((0,x.nv)(t,b.Aw.failed,o))}e(w.m.stopInsertingFormulaSuggestion()),e(w.m.stopExecuting())},De=(e,t)=>async(n,o)=>{const r=(0,s.iM)(t);if(!t||!(0,V.CU)(t))return;const i=o().dataAI.tableName[e];if(!i)return;if(!o().selection.selectionContexts[i])return;const l=o().selection.selectionContexts[i],c=await n((0,H.CQ)(i,e));c&&(0,S.k8)(l)&&void 0!==o().dataAI.rawPreview[t.id]&&setTimeout((async()=>{try{const i=o().dataAI.rawPreview[t.id],d=o().dataAI.visibleRowPreviewValues[t.id],u=0===i.length||0===i[0].length;if(u&&(!d||0===d.length)||!r&&u)throw new Error("No preview values");const m=l.rowIndex+1;let g=(0,V._c)(t,l);const h=(0,s.cY)(t)?(0,S.YE)(t,c.texts):[];let p=i;t.insertRowTitle&&i.some((e=>e.length>0))&&(p=[[a.olU.CalculatedRowsFormulaTotalHeader,...i[0]],...i.slice(1)],g=[(0,W.z)(l.columnIndex+1),...g]);const b=(0,L.BOx)()?await T.M.getInstance().runTimedAsyncFunction("GetVisibleRows",(()=>(0,s.e1)(l)),e):void 0;n(R.m.updateFormulaRecommendationPreview({formulaSuggestionType:t.suggestionType,requestId:e,suggestionId:t.id,visibleRowsPreviewValues:d,preview:{previewValues:p,rowNumber:m,letters:g},tableValues:h,rowCount:(0,L.yw9)("OfficeVSO_9622925_fixRowPreviewMaxRow")?l.rowCount:void 0,visibleRows:b}))}catch(a){n(R.m.updateFormulaRecommendationPreview({formulaSuggestionType:t.suggestionType,requestId:e,suggestionId:t.id,preview:"Failed",visibleRowsPreviewValues:[],tableValues:[]})),T.M.getInstance().logErrorCode(m.O.SetFormulaPreviewFailed,a,p.S2.FormulaGeneration,N.$b.ASHA,{key:h.un.SuggestionID,value:t.id})}}),0)},Be=async(e,t,n,o,r=!1)=>{t(R.m.fetchRecommendationsFailed(e)),await t((0,x.L4)(!1));const{message:i,telemetry:l}=ne.n.getFormulaSuggestionErrorResponse(n??(0,a.HGr)(),{shouldShowFormulaDevButton:!1},o);if(u.$.getInstance().displayResponse(i,l),!r){const e=JSON.stringify({text:(0,Z.N)(i),publishPreference:"Never"});t((0,x.nv)(e,b.Aw.failed,l))}t((0,x.Nl)())},$e=(e,t)=>async(n,a)=>{const{recommendations:o}=a().dataAI,r=o[e],i=r[t];(0,L.Jhm)()&&T.M.getInstance().runTimedAsyncFunction("FormulaSuggestionInvalidatorTrack",(()=>Se.track(e,(0,S.cQ)(e,a()),i,((e,t)=>{n(R.m.markRecommendationAsInvalidated({reason:e,suggestionId:t}))}))),e,i.id);const{message:s,telemetry:c}=ne.n.getFormulaSuggestionResponse(e,t,r);u.$.getInstance().displayResponse(s,c);const d=J(i,a,e);(0,L.yw9)("OfficeVSO_9598840_SkipRedundantSkillResponse")||n((0,x.nv)(d,b.Aw.success,c));const m=o[e][t];n(De(e,m));const g=m.calculatedFormulas[0]?.insertionMode;if(T.M.getInstance().logEvent((0,h.SV)(h.he.SuggestionShown,He(i),h.KZ.FormulaGenerationSuggestionPill,m.id,e,void 0!==g?l.PH[g]:void 0)),n(R.m.setCurrentShownSuggestionIndex({requestId:e,suggestionIndex:t})),t+1<o[e].length){const a=o[e][t+1];n((0,x.Vf)(e,!a.isAlternativeSuggestion,a.suggestionType,t+1))}else n((0,x.Yx)(["CalculatedColumns_SpecificSuggestion"]))};const He=e=>(0,s.be)(e)?h.q.NLToFormula:(0,s.cY)(e)?h.q.CalculatedRows:h.q.CalculatedColumns},794329:(e,t,n)=>{"use strict";var a=n(758651);!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){a.error(e)}}(),e.exports=n(177551)},795786:(e,t,n)=>{"use strict";n.d(t,{n:()=>ue});var a=n(493284),o=n(86940),r=n(708353),i=n(293879),l=n(446751),s=n(857677),c=n(109174),d=n(164976),u=n(92520),m=n(83478),g=n(342935),h=n(779939),p=n(99558),b=n(972160),f=n(311538),C=n(306148),y=n(694592),v=n(996211),T=n(347145);const x=s.q.CalculatedColumns,S="Copilot\\Formula Generation";const w={getFormulaSuggestionErrorResponse:function(e,t,n,a){const o=(0,m.J)(t.shouldShowFormulaDevButton,t.debugInfo),{message:r,telemetry:i}=(0,p.v)(e,{errorType:n??s.q0.ClientError,featureName:x},{embeddedLists:[{listItems:a}]},{feedbackData:{feedbackArea:S},...o?{actionButtonList:[o]}:{}});return{message:r,telemetry:i}},getFormulaSuggestionInsertSuccessResponse:function(e,t,n){return{message:{chatCardType:o._.MarkdownCard,chatMessageData:{markDownCardProps:{user:i.Q9.Chat,message:e}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:S},actionButtonList:(0,T.BAK)()?[(0,C.FW)(x,t,n)]:[]}},telemetry:{featureName:x,eventType:s.a5.ActionConfirmationMessage}}},getFormulaSuggestionResponse:function(e,t,n){const a=n[t],i=0===t,m=c.CP.getActiveTable(),p=m?.address,b=m?.sheetRange.sheet,f="number"==typeof m?.sheetRange.range.topLeft.column?(0,g._c)(a,{columnCount:m.numColumns,columnIndex:m.sheetRange.range.topLeft.column}):void 0,C=(0,l.cY)(a)&&null!=m?.sheetRange.range.bottomRight.row?m.totalRow?m.sheetRange.range.bottomRight.row+1:m.sheetRange.range.bottomRight.row+2:void 0,T=(0,h.Fp)(i,a,p,b,f,C),x=(0,v.kJ)(a);return(0,u.cY)("getFormulaSuggestionResponse",{requestId:e,requestIndex:t,recommendation:a,recommendationModels:n,textForChatHistory:T}),a||(0,u.cY)("formulaSuggestionModels: no recommendation"),{message:{chatCardType:o._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{renderData:(0,d.IM)("FormulaSuggestion_V2",{requestId:e,isMainRecommendation:i,recommendation:a,targetAddress:p,targetSheet:b,columnLetters:f,rowNumber:C,showPreview:x}),textContent:T}},chatMessageBodyData:{messageId:a.id,shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:S,contextData:{cardMetaData:JSON.stringify({suggestionId:n[0]?.id}),feedbackClientAppName:(0,y.f2)()}}}},telemetry:{featureName:(0,l.cY)(a)?s.q.CalculatedRows:s.q.CalculatedColumns,eventType:s.a5.SuggestionMessage}}},getFormulaSuggestionMarkdownResponse:function(e,t,n,a){return{message:{chatCardType:o._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:e.response,horizontalTableScroll:!0,componentsOverride:(0,f.i)(s.q.CalculatedColumns),disableLinksProcessing:!1}},chatMessageBodyData:{messageId:e.id,shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:S,contextData:{cardMetaData:JSON.stringify({suggestionId:e.id}),feedbackClientAppName:(0,y.f2)()}},actionButtonList:(0,b.v)(t,e,n,a)},addCardToChatHistory:!0},telemetry:{featureName:s.q.CalculatedColumns,eventType:s.a5.SuggestionMessage}}},getInsertSuggestionUserChat:function(e){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Human,messageHeader:{text:e}}}},telemetry:{featureName:x,eventType:s.a5.HumanInput}}}};var E=n(76913),I=n(178365),R=n(279395),A=n(693226);const L=s.q.DataShaping,k="Copilot\\Data Shaping";function F(e,t,n){const a="StartDataShaping_V1"===e?(0,h.eo)():(0,h.N2)(),l={chatCardType:o._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:i.Q9.Chat,renderData:(0,d.IM)(e,n),textContent:a}},chatMessageBodyData:{aiResponseMetadata:{metadata:t,type:A.Rq.ContentCreation},shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:k}},stopLoadingUi:!0},c={featureName:L,eventType:s.a5.SuggestionMessage};return I.$.getInstance().displayResponse(l,c),{message:l,telemetry:c}}const _={getDataShapingSuccessResponse:function(e,t,n){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:{aiResponseMetadata:{metadata:t,type:A.Rq.ContentCreation},shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:k},actionButtonList:n&&(0,T.BAK)()?[(0,C.yq)(n,L)]:[]}},telemetry:{featureName:L,eventType:s.a5.ActionConfirmationMessage}}},getDataShapingErrorResponse:function(e,t){const n=e||(0,R.$oZ)(),a=JSON.stringify({requestJson:t});return(0,p.v)(n,{featureName:L,errorType:s.q0.ClientError},{},{aiResponseMetadata:{metadata:a,type:A.Rq.ContentCreation},feedbackData:{feedbackArea:k}})},getExitModeResponse:function(e,t){const n="replace"===e?(0,R.K1Z)():"newSheet"===e?(0,R.gXw)():(0,R.lp5)();return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:n}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,aiResponseMetadata:{metadata:t,type:A.Rq.ContentCreation},feedbackData:{feedbackArea:k},actionButtonList:[]}},telemetry:{featureName:L,eventType:s.a5.ActionConfirmationMessage}}},displayStartDataShapingResponse:function(e,t,n,a,o,r,i){return F("StartDataShaping_V1",JSON.stringify({queryScript:r,requestJson:i}),{requestId:e,sessionId:n,tableName:t,mashupDocument:a,queryName:o,queryScript:r})},displayDataShapingIntroResponse:function(e,t){return F("DataShapingIntro_V1",e,{requestId:t})}};var P=n(355908),N=n(956933),M=n(393035);const O={getExternalMessageResponse:function(e){return e.isHuman?function(e){const t={chatCardType:e.isMarkdownText?o._.MarkdownCard:o._.Default,chatMessageData:e.isMarkdownText?{markDownCardProps:{user:P.Q9.Human,message:e.text}}:{defaultMessageProps:{user:P.Q9.Human,messageHeader:{text:e.text}}},chatMessageBodyData:{messageId:e.messageId},stopLoadingUi:!1,addCardToChatHistory:e.addToChatHistory},n={featureName:s.q.ExternalTriggeredQuery,eventType:s.a5.DisplayExternalMessages};return{message:t,telemetry:n}}(e):function(e){const t=(0,M.u)(e.contentOrigin,!1),n=t.feedbackData?.feedbackArea,a={chatCardType:e.isMarkdownText?o._.MarkdownCard:o._.Default,chatMessageData:e.isMarkdownText?{markDownCardProps:{user:P.Q9.Chat,message:e.text,horizontalTableScroll:!0,componentsOverride:(0,M.X)(t)}}:{defaultMessageProps:{user:P.Q9.Chat,messageHeader:{text:e.text}}},chatMessageBodyData:{messageId:e.messageId,shouldShowAIGeneratedIndicator:e.aiGenerated,showAnimation:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:n??"Copilot",contextData:{feedbackClientAppName:(0,y.f2)()}},clpSensitivityIndicatorData:e.clpData?(0,N.Q9)(e.clpData):void 0,shouldShowCopyButton:!0,shouldShowHandoffButton:!0,shouldShowReadAloudButton:!0},stopLoadingUi:!1,addCardToChatHistory:e.addToChatHistory},i={featureName:t.telemetryFeatureName,eventType:s.a5.DisplayExternalMessages};return{message:a,telemetry:i}}(e)}};var D=n(16796),B=n(634883),$=n(301735),H=n(316904),U=n(158058),q=n(2928),V=n(672270),W=n(20847),G=n(507628);var z=n(394201);const Q=async e=>{e&&window.open(e,"_blank")};function j(e,t){return{linkText:{text:e,linkOnClick:Q,linkUrl:t}}}function J(){return{messageHeader:{text:(0,R.eII)(),linkText:{text:R.Klw,linkOnClick:Q,linkUrl:R.COL}}}}const Y={getJunkQueryResponse:function(){const e=(0,R.AWW)();return(0,p.v)(e,{errorType:s.q0.DetectedJunkQuery})},getHelpQueryResponse:function(){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:(0,R.svm)()},embeddedLists:[{listItems:[{text:(0,R.L1E)()},{text:(0,R.UVk)()},{text:(0,R.$cm)()},{text:(0,R.UGc)()}]}],messageFooter:{text:(0,R.aXL)()}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1}},telemetry:{featureName:s.q.CopilotChat,eventType:s.a5.HelpMessage}}},getLearnMoreResponse:function(){const e=[];for(const t of(0,R.BU1)())e.push({text:t});return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:(0,R.bcx)()},embeddedLists:[{listItems:e}],messageFooter:j((0,R.VHx)(),R.wZB)}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:r.O.Footer}},telemetry:{featureName:s.q.CopilotChat,eventType:s.a5.HowCanCopilotHelpSuggestionClicked}}},getAugloopTimeoutResponse:function(e){const t=H.M.getInstance(),n=c.CP.pythonContextManager.isPythonMode?(0,R.ZgC)():(0,R.CY_)();return(0,p.v)(n,{errorType:s.q0.AugloopTimeout,featureName:(0,T.yw9)("OfficeVSO_9771900_ErrorFeatureAttribution")?t.getUsageFeatureForStandardizedFeature(e):s.q.CopilotChat})},getStopGeneratingResponse:function(e){const t=c.CP.pythonContextManager.isPythonMode?(0,R.lJi)():e===s.OP.ImportDataGenerateSuggestion||e===s.OP.ImportDataRelevancyCheck?(0,R.Vd6)():(0,R.s_X)(),n={chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:t}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:r.O.Footer,messageAttributionProps:(0,y.qN)()}};let a=s.q.CopilotChat;return e===s.OP.AnalyzeData?a=s.q.AnalyzeData:e===s.OP.CalculatedColumns?a=s.q.CalculatedColumns:e===s.OP.CalculatedCells&&(a=s.q.CalculatedRows),{message:n,telemetry:{featureName:a,eventType:s.a5.StopButtonClicked}}},getChangeTopicResponse:function(){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:(0,R.pH2)()}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:r.O.Footer}},telemetry:{featureName:s.q.CopilotChat,eventType:s.a5.ChangeTopicButtonClicked}}},getAugloopErrorResponse:async function(e,t,n){const a=(0,V.uN)(e);let l=a,d=s.q0.ServiceError,u=!0,m={};const g=e.category;let h,b=!0;const{errorCode:f,tlrSkillSupport:y,contextFailures:v,inferredTableName:x}=(0,z.D)(e),S=v?(0,U.AG)(v):void 0;switch(g){case B.E.LicensingError:l=(0,R.iUs)(),d=s.q0.LicensingError,u=!1,m=J();break;case B.E.OffensiveContent:l=R.olU.ServerErrorWithNoRetry,d=s.q0.DetectedOffensiveContent;break;case B.E.TokenCountError:l=a,d=s.q0.TokenCount;break;case B.E.UnsupportedLanguageError:if(d=s.q0.DetectedUnsupportedLanguage,(0,T.yw9)("OfficeVSO_9477289_UpdateUnsupportedLanguageMessage")){const e=t?.outputAnswerLanguage,n=(0,W.w)(e);m={messageHeader:{text:n?R.olU.CopilotUnsupportedLanguageError.replace("%s",n):R.olU.CopilotUnsupportedlanguageMessage,linkText:{text:R.olU.CopilotSupportedLanguagesLearnMoreLink,linkUrl:R.JF4,linkSuffix:"\n\n"+R.olU.FeedbackPrompt}}}}else m={messageHeader:{text:(0,R.MCi)()},messageFooter:j((0,R.Amo)(),R.JF4)};break;case B.E.InputQueryError:e.json?"unsupported-multi-agent"===f?(l=a,d=s.q0.DetectedMultipleIntents):"out-of-scope"===f?(l=(0,R.AWW)(),d=s.q0.DetectedOutOfScope):"bad-token"===f?(l=(0,R.iUs)(),d=s.q0.BadToken,u=!1,m=J()):"too-short"===f?(l=(0,R.l_I)(),d=s.q0.DetectedTooShort):(l=a,d=s.q0.ServiceError):(l=a,d=s.q0.ServiceError);break;case B.E.ExcelTabularSkillFailedError:x&&await c.CP.fetchAndSetActiveTableLikeEntity(x),S?h=(0,q.rE)(S):y?h=await(0,q.X$)(y):(l=a,d=s.q0.ServiceError);break;case B.E.InferenceAPIError:(0,T.yw9)("OfficeVSO_9076919_ShowThrottlingErrorMessage")&&"user-throttled"===f?(l=(0,R.UDz)(),d=s.q0.UserThrottled):(l=a,d=s.q0.ServiceError);break;case B.E.IgnorableError:case B.E.SydneyError:"out-of-credits"===f&&(l=(0,R.R_I)());break;case B.E.OfficeJsSkillFailedError:l=a,d=s.q0.ServiceError;break;case B.E.PythonSkillFailedError:{l=a,d=s.q0.ServiceError;const t=e.json?JSON.parse(e.json):void 0,n=(0,T.yw9)("OfficeVSO_10393641_UpdateAASkillName")&&(0,T.EJJ)()?$.w.NewPythonSkillName:$.w.PythonSkillName,c=t?.code===$.w.AnswersName?$.w.AnswersName:n;H.M.getInstance().setActiveFeatureWithContentOrigin(c),h=function(e,t={},n={},a={},l={}){const c=(0,G.A)(),d=H.M.getInstance().getActiveFeature(),u=H.M.getInstance().getUsageFeatureForStandardizedFeature(d),m=H.M.getInstance().featureNameToFeedbackArea(u);return{message:{...l,chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:e},...n}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:m},isFailure:!0,messageId:c,actionButtonList:(0,T.jHv)()?[(0,C.yo)(c)]:void 0,...a}},telemetry:{featureName:u,eventType:s.a5.ErrorMessage,...t}}}(l,{errorType:d},m);break}default:l=a,d=s.q0.ServiceError,b=!1}return h||(h=(0,p.v)(l,{errorType:d,featureName:(0,T.yw9)("OfficeVSO_10350403_AddErrorParamToGenericErrorResponse")&&n?H.M.getInstance().getUsageFeatureForStandardizedFeature(n):s.q.CopilotChat},m)),!b&&(0,T.thH)()||(0,D.y)(e,H.M.getInstance().getActiveFeature()),h.telemetry.useClientSideErrorMessage=b,h.message.addCardToChatHistory=u,(0,T.jHv)()&&(h.telemetry.devInfo={category:e.category,message:e.message,json:JSON.parse(e.json??"{}")}),h},getZeroQueryResponse:function(e){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer}},telemetry:{featureName:s.q.CopilotChat,eventType:s.a5.ZeroQueryMessageSuggestionClicked}}},getStreamingResponse:function({basin:e,uniqueId:t,accessPath:n,value:a,actionButtonList:l}){return{message:{chatCardType:o._.StreamingAdaptiveCard,chatMessageData:{streamingAdaptiveCardProps:{user:i.Q9.Chat,basin:e,uniqueId:t,accessPath:n,value:a}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,actionButtonList:l}},telemetry:{featureName:s.q.CopilotChat,eventType:s.a5.ConversationMessage}}},getLanguageUnavailableResponse:function(){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:(0,R.rZm)()},messageFooter:j((0,R.Amo)(),R.JF4)}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1},addCardToChatHistory:!1},telemetry:{featureName:s.q.CopilotChat,eventType:s.a5.LanguageNotAvailableMessage}}},getExternalTriggeredQueryResponse:function(e,t){return{message:!0===t?{chatCardType:o._.MarkdownCard,chatMessageData:{markDownCardProps:{user:i.Q9.Human,message:e}}}:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Human,messageHeader:{text:e}}}},telemetry:{featureName:s.q.ExternalTriggeredQuery,eventType:s.a5.SuggestionMessage}}},getChatHistoryHydrationFailed:function(){return(0,p.v)((0,R.Bjy)(),{errorType:s.q0.ChatHistoryHydrationFailed},void 0,{messageId:"chatHistoryHydrationFailed"},{addCardToChatHistory:!1})},getDisengagedErrorResponse:function(e){const t=H.M.getInstance();return(0,p.v)((0,R.KC)(),{errorType:s.q0.OrchestratorDisengaged,featureName:(0,T.yw9)("OfficeVSO_9771900_ErrorFeatureAttribution")?t.getUsageFeatureForStandardizedFeature(e):s.q.CopilotChat},void 0,void 0,{addCardToChatHistory:!0})},getTableLikeRangesLoadingResponse:function(){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:(0,R.C3N)()}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer}},telemetry:{featureName:s.q.ContextInference,eventType:s.a5.LoadingTableLikeRangesWarning}}},getChartRecommendationsInProgressResponse:function(){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:(0,R.tOz)()}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1}},telemetry:{featureName:s.q.ChartDesignRecommendations,eventType:s.a5.ChartDesignRecommendationsInProgress}}}},X="Copilot\\Import Data";function Z(e){return e.length>0?(0,R.h9u)().replace("{0}",e.length.toString()):(0,R.u1U)()}const K={getImportDataResponse:function({importType:e,requestId:t,dataSources:n,messageId:a,userQueryGuid:l,clpData:c,performedFallbackToAllTables:u}){return{message:{chatCardType:o._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:i.Q9.Chat,renderData:(0,d.IM)("ImportData_V1",{requestId:t,dataSources:n,messageId:a,userQueryGuid:l,performedFallbackToAllTables:u}),textContent:Z(n)}},chatMessageBodyData:{messageId:t,shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:X},clpSensitivityIndicatorData:c&&""!==c.labelId?c:void 0}},telemetry:{featureName:e,eventType:s.a5.ImportDataCard}}},getImportDataSimpleMessage:function(e,t){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:{actionButtonList:[],shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:X}}},telemetry:{featureName:t,eventType:s.a5.ActionConfirmationMessage}}}},ee=s.q.InsertTable,te="Copilot\\Insert Table";const ne={getInsertTableErrorResponse:function(e,t,n){const{message:a,telemetry:o}=(0,p.v)(e,{errorType:t??s.q0.ClientError,featureName:ee},{embeddedLists:[{listItems:n}]},{feedbackData:{feedbackArea:te}});return{message:a,telemetry:o}},getInsertTableSuccessResponse:function(e,t){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:te},actionButtonList:(0,T.BAK)()?[(0,C.FW)(ee)]:[]}},telemetry:{featureName:ee,eventType:s.a5.ActionConfirmationMessage}}}};var ae=n(766596),oe=n(504280);const re=s.q.PythonCalculatedColumns,ie="Copilot\\Python Calculated Columns";const le={getPythonCalculatedColumnSuggestionResponse:function(e,t,n,a,i,l){return{message:{chatCardType:o._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{renderData:(0,d.IM)("PythonCalculatedColumn_V1",{requestId:e,recommendation:t,targetAddress:n,columnLetters:a,sheetId:i,insertCallback:l})}},chatMessageBodyData:{messageId:t?.id,shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:ie,contextData:{cardMetaData:JSON.stringify({suggestionId:t.id}),feedbackClientAppName:(0,y.f2)()}}}},telemetry:{featureName:s.q.PythonCalculatedColumns,eventType:s.a5.SuggestionMessage}}},getPythonColumnInsertResponse:function(e,t){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:ie},actionButtonList:(0,T.BAK)()?[(0,C.FW)(re,t)]:[]}},telemetry:{featureName:s.q.PythonCalculatedColumns,eventType:s.a5.ActionConfirmationMessage}}},getPythonColumnSuggestionErrorResponse:function(e,t,n){const{message:a,telemetry:o}=(0,p.v)(e,{errorType:t??s.q0.ClientError,featureName:re},{embeddedLists:[{listItems:n}]},{feedbackData:{feedbackArea:ie}});return{message:a,telemetry:o}},getPythonColumnInsertErrorResponse:function(e,t){const n={featureName:s.q.PythonCalculatedColumns,eventType:s.a5.ErrorMessage,errorType:s.q0.PythonCalculatedColumnsError,devInfo:void 0},{message:a,telemetry:o}=(0,p.v)(t,n);return{message:a,telemetry:o}}};var se=n(212605);const ce="Copilot\\Commanding";const de={getRangeConvertToTableSuccessResponse:function(e){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:(0,R.H6b)().replace("{0}",e??"")}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,actionButtonList:(0,T.BAK)()?[(0,C.FW)(s.q.ConvertToTable)]:[],feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:ce}}},telemetry:{featureName:s.q.ConvertToTable,eventType:s.a5.ActionConfirmationMessage}}},getShowHeaderButtonResponse:function(){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Human,messageHeader:{text:(0,R.QCY)()}}}},telemetry:{featureName:s.q.ShowHeaders,eventType:s.a5.HumanSuggestionApplied}}},getShowHeaderButtonSuccessResponse:function(){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:(0,R.ZOE)()}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:ce}}},telemetry:{featureName:s.q.ConvertToTable,eventType:s.a5.ActionConfirmationMessage}}},getSampleTableDataResponse:function(){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Human,messageHeader:{text:(0,R.px2)()}}}},telemetry:{featureName:s.q.SampleData,eventType:s.a5.HumanInput}}},getSampleTableDataSuccessResponse:function(){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:(0,R._J3)()}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,actionButtonList:(0,T.BAK)()?[(0,C.FW)(s.q.ConvertToTable)]:[],feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:ce}}},telemetry:{featureName:s.q.SampleData,eventType:s.a5.ActionConfirmationMessage}}}},ue={...Y,...se.n,...le,...E.n,...w,...a.n,...de,...oe.n,...ne,..._,...K,...O,...ae.n}},795917:(e,t,n)=>{"use strict";n.d(t,{$:()=>o,d:()=>s});var a,o,r=function(e){return"object"==typeof e&&!Array.isArray(e)&&null!==e};function i(e){return Array.isArray(e)&&e.every((function(e){return"string"==typeof e}))}function l(e){if(!r(e))return!1;var t=function(e){return!e||e===o.M365CopilotChat||e===o.Researcher||e===o.Analyst||e===o.AppChat||e===o.Disabled||e===o.DataShaping}("CopilotExperience"in e?e.CopilotExperience:void 0),n=!("Upn"in e)||!e.Upn||"string"==typeof e.Upn,a=!("LicensedFeatures"in e)||!e.LicensedFeatures||i(e.LicensedFeatures),l=!("AggregatedLicensedFeatures"in e)||!e.AggregatedLicensedFeatures||i(e.AggregatedLicensedFeatures);return t&&n&&a&&l}function s(e){if(!e||!r(e))return!1;var t,n=!("PrimaryUserAccountInfo"in e&&e.PrimaryUserAccountInfo)||l(e.PrimaryUserAccountInfo),o=!("DocumentContext"in e&&e.DocumentContext)||function(e){if(!r(e))return!1;var t="FileHost"in e?e.FileHost:void 0;return!t||t===a.Local||t===a.NewDocument||t===a.ODSP||t===a.NotSet||t===a.ThirdParty}(e.DocumentContext),i=!("TrustedBrokerDomain"in e)||(!(t=e.TrustedBrokerDomain)||"string"==typeof t);return n&&o&&i}!function(e){e.NotSet="NotSet",e.Local="Local",e.NewDocument="NewDocument",e.ODSP="ODSP",e.ThirdParty="ThirdParty"}(a||(a={})),function(e){e.M365CopilotChat="M365CopilotChat",e.AppChat="AppChat",e.Researcher="Researcher",e.Analyst="Analyst",e.DataShaping="DataShaping",e.Disabled="Disabled"}(o||(o={}))},796102:(e,t,n)=>{"use strict";n.d(t,{Ak:()=>y,Am:()=>r,BO:()=>b,C3:()=>o,Jh:()=>f,Lb:()=>v,NW:()=>x,Q4:()=>g,Ru:()=>p,W7:()=>c,YL:()=>m,dQ:()=>h,dc:()=>T,iA:()=>u,l$:()=>d,lI:()=>C,mT:()=>s,nZ:()=>S,wM:()=>i,zI:()=>l});var a=n(615397);function o(e,t){const n=e.arguments[t];if(void 0===n)throw new a.Dd(`Argument ${t} not found on ${e.name}`,a.vb.ArgumentUndefined);const o=n,r="string"!==o.type;if(r||void 0===o.string)throw new a.Dd(r?`Argument ${t} type ${o.type} should be string on ${e.name}`:`Argument ${t} has no value on ${e.name}`,r?a.vb.ArgumentTypeMismatch:a.vb.ArgumentValueUndefined,o.type,"string");return o.string}function r(e,t){const n=e.arguments[t];if(void 0===n)throw new a.Dd(`Argument ${t} not found on ${e.name}`,a.vb.ArgumentUndefined);const o=n,r="string"!==o.type;if(r||void 0===o.string)throw new a.Dd(r?`Argument ${t} type ${o.type} should be enum on ${e.name}`:`Argument ${t} has no value on ${e.name}`,r?a.vb.ArgumentTypeMismatch:a.vb.ArgumentValueUndefined,o.type,"enum");return o.string}function i(e,t){const n=e.arguments[t];if(void 0===n)throw new a.Dd(`Argument ${t} not found on ${e.name}`,a.vb.ArgumentUndefined);const o=n,r="color"!==o.type;if(r||void 0===o.string)throw new a.Dd(r?`Argument ${t} type ${o.type} should be color on ${e.name}`:`Argument ${t} has no value on ${e.name}`,r?a.vb.ArgumentTypeMismatch:a.vb.ArgumentValueUndefined,o.type,"color");return o.string}function l(e,t){const n=e.arguments[t];if(void 0===n)throw new a.Dd(`Argument ${t} not found on ${e.name}`,a.vb.ArgumentUndefined);const o=n,r="boolean"!==o.type;if(r||void 0===o.boolean)throw new a.Dd(r?`Argument ${t} type ${o.type} should be boolean on ${e.name}`:`Argument ${t} has no value on ${e.name}`,r?a.vb.ArgumentTypeMismatch:a.vb.ArgumentValueUndefined,o.type,"boolean");return o.boolean}function s(e,t){const n=e.arguments[t];if(void 0===n)throw new a.Dd(`Argument ${t} not found on ${e.name}`,a.vb.ArgumentUndefined);const o=n,r="number"!==o.type;if(r||void 0===o.number)throw new a.Dd(r?`Argument ${t} type ${o.type} should be number on ${e.name}`:`Argument ${t} has no value on ${e.name}`,r?a.vb.ArgumentTypeMismatch:a.vb.ArgumentValueUndefined,o.type,"number");return o.number}function c(e,t){const n=e.arguments[t];if(void 0===n)throw new a.Dd(`Argument ${t} not found on ${e.name}`,a.vb.ArgumentUndefined);const o=n,r="stringList"!==o.type;if(r||void 0===o.stringList)throw new a.Dd(r?`Argument ${t} type ${o.type} should be stringList on ${e.name}`:`Argument ${t} has no value on ${e.name}`,r?a.vb.ArgumentTypeMismatch:a.vb.ArgumentValueUndefined,o.type,"stringList");return o.stringList}function d(e){const t=x(e,"scope");if(!t)throw new a.Dd(`Argument scope not found on ${e.name}`,a.vb.ArgumentUndefined);return t}function u(e){try{return function(e){const t=e.arguments.scope;if(!t)throw new a.Dd(`Argument scope not found on ${e.name}`,a.vb.ArgumentUndefined);if("scope"!==t.type||"Selection"!==t.name)throw new a.Dd(`Argument scope not Selection type on ${e.name}`,a.vb.ArgumentTypeMismatch);return t}(e)}catch{return}}function m(e,t){const n=e.arguments[t];if(void 0===n)throw new a.Dd(`Argument ${t} not found on ${e.name}`,a.vb.ArgumentUndefined);const o=n,r="var"!==o.type;if(r||void 0===o.name)throw new a.Dd(r?`Argument ${t} type ${o.type} should be var on ${e.name}`:`Argument ${t} has no value on ${e.name}`,r?a.vb.ArgumentTypeMismatch:a.vb.ArgumentValueUndefined,o.type,"var");return o.name}function g(e,t){const n=e.arguments[t];if(void 0===n)throw new a.Dd(`Argument ${t} not found on ${e.name}`,a.vb.ArgumentUndefined);const o=n;if(!o.type)throw new a.Dd(`Argument ${t} type is undefined on ${e.name}`,a.vb.ArgumentTypeUndefined);return o.type}function h(e,t){try{return g(e,t)}catch{return}}function p(e,t){try{return o(e,t)}catch{return}}function b(e,t){try{return r(e,t)}catch{return}}function f(e,t){try{return i(e,t)}catch{return}}function C(e,t){try{return s(e,t)}catch{return}}function y(e,t){try{return l(e,t)}catch{return}}function v(e,t){try{return c(e,t)}catch{return[]}}function T(e,t){try{return function(e,t){const n=e.arguments[t];if(void 0===n)throw new a.Dd(`Argument ${t} not found on ${e.name}`,a.vb.ArgumentUndefined);const o=n,r="numberList"!==o.type;if(r||void 0===o.numberList)throw new a.Dd(r?`Argument ${t} type ${o.type} should be numberList on ${e.name}`:`Argument ${t} has no value on ${e.name}`,r?a.vb.ArgumentTypeMismatch:a.vb.ArgumentValueUndefined,o.type,"numberList");return o.numberList}(e,t)}catch{return[]}}function x(e,t){try{return function(e,t){const n=e.arguments[t];if(void 0===n)throw new a.Dd(`Argument ${t} not found on ${e.name}`,a.vb.ArgumentUndefined);const o=n,r="var"!==o.type;if(r||void 0===o.name)throw new a.Dd(r?`Argument ${t} type ${o.type} should be var on ${e.name}`:`Argument ${t} has no value on ${e.name}`,r?a.vb.ArgumentTypeMismatch:a.vb.ArgumentValueUndefined,o.type,"var");return o}(e,t)}catch{return}}function S(e){const t=e.returns;if(void 0===t)throw new a.tF(`Return variable not found on ${e.name}`,"getReturnVariable");return t}},798110:(e,t,n)=>{"use strict";n.d(t,{J:()=>o});var a=n(92520);function o(e,t=void 0){try{let n="";if(!document?.referrer)return void(0,a.cY)("SendMessageToHost failed. document object is null!");n=document.referrer;const o={Origin:"OfficeCopilotExcelTaskPane",Event:e,Payload:t};window.parent.postMessage(o,n)}catch(t){(0,a.cY)("SendMessageToHost failed with exception: ",t," for event: ",e)}}},799765:(e,t,n)=>{"use strict";n.d(t,{$J:()=>L,$y:()=>F,Am:()=>a,BA:()=>w,DC:()=>S,Jr:()=>E,Lv:()=>M,M5:()=>f,PB:()=>y,Qc:()=>v,Rj:()=>C,S$:()=>T,SG:()=>h,XB:()=>x,_8:()=>p,_T:()=>_,eA:()=>P,fL:()=>b,fU:()=>I,hp:()=>A,nQ:()=>R,oA:()=>N,p1:()=>D,xX:()=>k,yQ:()=>O});var a,o=n(543435),r=n(75496),i=n(83437),l=n(255507),s=n(316904),c=n(729851),d=n(857677),u=n(109174),m=n(347145),g=n(469486);function h(){return u.CP.pythonContextManager.isPythonMode?d.q.Python:d.q.Answers}function p(e){s.M.getInstance().logEvent((0,d.SV)(d.he.SuggestionShown,d.q.Python,e)),s.M.getInstance().endTriedActivitySuccess(d.q.Python)}function b(e){s.M.getInstance().logEvent((0,d.SV)(d.he.SuggestionShown,d.q.Answers,e)),s.M.getInstance().endTriedActivitySuccess(d.q.Answers)}function f(){s.M.getInstance().logEvent((0,d.SV)(d.he.SuggestionApplied,d.q.Python,d.KZ.PythonAdaCodeInserted)),l.B.getInstance().logKeptEvent(d.BJ.Python,d.q.Python,c.RX.Analyze)}function C(e){const t=(0,d.SV)(d.he.TeachingCalloutShown,d.q.Python,d.KZ.PythonAdaCodeInserted);t.eventData?.push({key:r.$.CalloutScenario,value:e}),s.M.getInstance().logEvent(t)}function y(e,t){t.push({key:r.L3.Key,value:e}),t=t.concat(D());const n={eventType:r.S2.PythonEvents,eventData:t};s.M.getInstance().logEvent(n)}function v(e,t,n){const a=[];a.push({key:r.$.CardInsertionButtonType,value:t}),a.push({key:r.$.CardInsertionContentType,value:n}),y(e,a)}function T(e,t){const n=[];let a=!0;if(t.outputType===o.qf.Error){const{errorName:t,errorType:o,errorSubType:i,errorMessage:l}=(0,g.$e)(e);a=!1,n.push({key:r.$.ErrorName,value:t}),n.push({key:r.$.ErrorType,value:o}),n.push({key:r.$.ErrorSubType,value:i}),"ModuleNotFoundError"===t&&n.push({key:r.$.ErrorMessage,value:l}),n.push({key:r.$.RetryAttempts,value:u.CP.pythonContextManager.codeRetryAttempts})}n.push({key:r.$.IsSuccess,value:a}),n.push({key:r.$.OutputType,value:t.outputType}),y(r.L3.ExecutionResult,n)}function x(e,t,n,a){const o=[];o.push({key:r.d.LabelRowHidden,value:e}),o.push({key:r.d.LabelColumnHidden,value:t}),o.push({key:r.d.ContentRowHidden,value:n}),o.push({key:r.d.ContentColumnHidden,value:a}),y(r.L3.InsertInHiddenCell,o)}function S(e,t){const n=[];n.push({key:r.$.CardType,value:e}),t&&n.push({key:r.$.CalculationMode,value:t}),y(r.L3.ResponseShown,n)}function w(e){const t=[];t.push({key:r.$.RequestId,value:e}),y(r.L3.ListenerAttached,t)}function E(e,t){const n=[];n.push({key:r.$.AugLoopCalls,value:e}),n.push({key:r.$.RetryAttempts,value:t}),y(r.L3.AugLoopCallsCompleted,n)}function I(e,t,n,a,o){const i=[{key:r.IX.OperationSize,value:e},{key:r.IX.ContextMemoSize,value:t},{key:r.IX.MessageTextSize,value:n},{key:r.IX.QueryAnnotationSize,value:a},{key:r.IX.ImageTileSize,value:o}];y(r.L3.MessageToAugLoopIsTooLarge,i)}function R(e,t){const n=[];n.push({key:r.$.ExecutePythonCodeCorrelationId,value:e}),t&&n.push({key:r.$.ApiFailure,value:t}),y(r.L3.ExecutePythonCodeApi,n)}function A(e,t){const n=[{key:r.$.OldPythonCellSelected,value:e},{key:r.$.CurrentIsPythonCellSelected,value:t}];y(r.L3.UpdateIsPythonCellSelected,n)}function L(e){const t=[];t.push({key:r.f8.IsPythonFormula,value:e}),y(r.L3.ForcedCalculation,t)}function k(e,t,n){const a=[{key:r.j9.Operation,value:e},{key:r.j9.IsQueryNull,value:t},{key:r.j9.Stack,value:n??"No stack available."}];y(r.L3.TrimmedContextModified,a)}function F(e){const t=[];t.push({key:r.$.PythonComplexType,value:e}),y(r.L3.PythonComplexTypeEncountered,t)}function _(e){const t=[];t.push({key:r.$.ChartType,value:e}),y(r.L3.InteractiveChartRendered,t)}function P(){y(r.L3.ModelessUnsupportedType,[])}function N(e){const t=[];t.push({key:r.$.ChunkType,value:e}),y(r.L3.ModelessMissingProperty,t)}function M(e,t){const n={eventType:e.eventType,errorMessage:e.errorCode,logLevel:i.$b.ASHA};let a=[{key:r.HR.DetailedErrorMessage,value:e.errorDetailsNoPII??e.message},{key:r.HR.Stack,value:e.stack??""}];a.push({key:r.HR.IsAceImpacting,value:e.isAceImpacting}),a.push({key:r.HR.FeatureName,value:e.telemetryStandardizedFeature}),t&&a.push(...t),a=a.concat(D()),s.M.getInstance().logError(n,void 0,a)}function O(e){const t=e.telemetryStandardizedFeature;s.M.getInstance().logStandardizedAshaErrorEvent(e.ashaVeto,e.ashaError,t)}function D(){const e=[];return e.push({key:r.jo.PythonAnalysisSessionId,value:u.CP.pythonContextManager.analysisSessionId??""}),e.push({key:r.jo.IsPythonThinkDeeperMode,value:u.CP.pythonContextManager.isPythonThinkDeeperMode}),(0,m.yw9)("OfficeVSO_9979155_PythonFlightsAsJSONString")||e.push(...function(){const e=[];return e.push({key:r.xm.IsPythonAdaInCopilotEnabled,value:(0,m.H2A)()}),e.push({key:r.xm.IsPythonManualPromptEnabled,value:(0,m.w9F)()}),e.push({key:r.xm.IsPythonPlannerEnabled,value:(0,m.gnD)()}),e.push({key:r.xm.IsModelessPythonAAEnabled,value:(0,m.EJJ)()}),e.push({key:r.xm.IsPythonAAStartAnalysisButtonGreenExperimentEnabled,value:(0,m.iq2)()}),e}()),e}!function(e){e.Update="Update",e.Clear="Clear"}(a||(a={}))},803716:(e,t,n)=>{"use strict";n.d(t,{D0:()=>ne,fx:()=>st,XT:()=>Fe,H7:()=>ze,xQ:()=>De,CQ:()=>Ve,ge:()=>Ae,MN:()=>Be,oR:()=>Oe,QF:()=>Ge,Dz:()=>Ee,cQ:()=>Qe,aM:()=>We,m:()=>Ue,Vy:()=>Me,o4:()=>Ce,vW:()=>rt,at:()=>nt,AR:()=>je,eS:()=>Je,z$:()=>pt,f0:()=>ht,A4:()=>ke,gG:()=>ft,Nn:()=>Pe,tP:()=>_e,VW:()=>He,v:()=>$e,Om:()=>ot,b9:()=>bt,GL:()=>be,Wc:()=>fe,mI:()=>gt});var a=n(279395),o=n(616166),r=n(639765),i=n(548366),l=n(178365),s=n(379510),c=n(88568),d=n(531093),u=n(12855),m=n(737649),g=n(307053),h=n(715227),p=n(903173),b=n(857677),f=n(83437),C=n(764080),y=n(963002),v=n(1329),T=n(374315),x=n(291436),S=n(255507),w=n(188053),E=n(729851),I=n(70239),R=n(543435),A=n(76872),L=n(75496),k=n(316904),F=n(314793),_=n(650444),P=n(313853),N=n(158058),M=n(565095),O=n(126521);const D=e=>{switch(e){case"Map":return(0,a.WpK)();case"ScatterChart":return(0,a.mnG)();case"ClusteredComboChart":return(0,a.Muj)();case"StackedComboChart":return(0,a.yMF)();case"HundredPercentComboChart":return(0,a.$Eq)();case"FunnelChart":return(0,a.YWO)();case"Treemap":return(0,a.OJx)();case"SunburstChart":return(0,a.etO)();case"ColorFilledMap":return(0,a.XsD)();case"CircularTreemap":return(0,a.q7F)();case"HeatMap":return(0,a.jdI)();case"WaterfallChart":return(0,a.iVS)();case"RoseChart":return(0,a.r9E)();case"NetworkMap":return(0,a.Tg4)();case"SmoothLineChart":return(0,a.FIy)();case"ComboChart":return(0,a.ICT)();case"LineChart":return(0,a.Kc4)();case"PieChart":return(0,a.gGJ)();case"DonutChart":return(0,a.K2I)();case"AreaChart":return(0,a.nuZ)();case"StackedArea":return(0,a.brP)();case"HundredPercentStackedArea":return(0,a.M_y)();case"ClusteredBarChart":return(0,a.vdP)();case"StackedBarChart":return(0,a.t3j)();case"HundredPercentStackedBarChart":return(0,a.koJ)();case"ClusteredColumnChart":return(0,a.KCq)();case"StackedColumnChart":return(0,a.Kve)();case"HundredPercentStackedColumnChart":return(0,a.hIB)();default:return(0,a.HRg)()}};var B=n(664007),$=n(342935),H=n(1541),U=n(109174),q=n(530499),V=n(8403),W=n(464077),G=n(573367),z=n(92520),Q=n(347145);function j(e){return{table:{orientation:"columnMajor",headerRowCount:1,headerColumnCount:0},useOnlyFields:e.visibleColumns}}function J(e){return{topLeft:{row:e.top-1,column:e.left-1},bottomRight:{row:e.bottom-1,column:e.right-1}}}var Y=n(575934),X=n(382736),Z=n(140235),K=n(586428);var ee=n(972424);function te(e){return-1===e.indexOf("!")?d.ExcelCalc.addressToExcelRange(e):d.ExcelCalc.addressToExcelRange(d.ExcelCalc.localAddressesFromSheetAddresses(e))}var ne,ae=n(135829),oe=n(519272),re=n(110686),ie=n(851295),le=n(359730),se=n(639969),ce=n(615397),de=n(672270),ue=n(795786),me=n(312422),ge=n(507628);!function(e){e.Chart="Chart",e.Table="Table",e.Sheet="Sheet"}(ne||(ne={}));const he="I don't find any suggestions",pe=2e6,be=e=>async(t,n)=>{const{activeTable:a,lastActiveTable:o}=n().selection;!(0,Q.geU)()&&e&&(a&&a.name!==e.name||!a&&o?.name!==e.name)&&((0,Q.ZAR)()&&U.CP.getHasTFCDeliveredQueryResult()||t((0,se.Nl)())),t(p.m.setActiveTable(e))},fe=e=>async t=>{const{type:n,table:a}=e;if(n!==R.lp.Range)if((0,Q.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.AnalyzeDataSkill",!1))await t(Ve(a.name));else try{await t(Se(a.name))}catch(e){e instanceof Error&&e.message===o.O.GetInterpretationsFailed?k.M.getInstance().logErrorCode(o.O.GetInterpretationsFailed,e,L.S2.AnalyzeDataError,f.$b.ASHA):k.M.getInstance().logErrorCode(o.O.GetNLContextFailed,e,L.S2.AnalyzeDataError,f.$b.ASHA)}},Ce=e=>async(t,n)=>{const{activeTable:a,lastActiveTable:o}=n().selection;a&&a.name===e?(t(p.m.setSelectionError("NOTHING_SELECTED")),t(p.m.clearTable(a.name)),t(p.m.setActiveTable(void 0))):(o&&o.name===e&&t(p.m.removeLastActiveTable()),t(p.m.clearTable(e)),t((0,se.YS)()))};function ye(e){return{data:{valueRows:e.values,formatRows:(0,H.vc)(e.formats),formatLocalRows:(0,H.vc)(e.formatLocals),textRows:e.text,mergedCells:e.mergedCells,formulas:e.formulas},contentLanguageHint:(0,ie.gl)()}}function ve(e,t,n){const a=(0,oe.z6)();if(!t)throw new Error("No active table");if(t.name!==e)throw new Error("The query is not aimed at the active table");if(0===t.visibleColumns.length)throw new Error("All columns in selected table are hidden");return{recommendationOptions:"NL"===n?void 0:{capabilities:{chart:{layouts:"ChartReco"===n?a:[]},pivotTable:"PivotTableReco"===n,pivotChart:{layouts:"ChartReco"===n?a:[]}},thresholdOfUsingBaseMiningLevel:15e3,maxNumOfSummaryPerClass:1,disableInterleaveExperiment:!1},dataFieldOptions:j(t)}}function Te(e,t,n,a){return{...e,generateResults:ve(t,n,a)}}const xe=(e,t=()=>!1,n,a="NL",r=!1)=>async(i,l)=>{const{interpretations:s}=l().selection;if(s[e]&&s[e].length>0&&!r&&l().selection.postRangesRequestTypes[e]&&l().selection.postRangesRequestTypes[e].includes(a))return;n&&k.M.getInstance().addAnalyzeDataStep(n,"getInterpretationsIfNeeded");const c=performance.now();try{if((r||!l().selection.postRangesResults[e]||!l().selection.postRangesRequestTypes[e]||!l().selection.postRangesRequestTypes[e].includes(a))&&(await i(((e,t,n="NL",a=!1)=>async(o,r)=>{const{postRangesResults:i,postRangesRequestTypes:l}=r().selection;if(i[e]){if(!a&&l[e]&&l[e].includes(n))return;{const a=ve(e,r().selection.activeTable,n),l=await(0,T.GU)(i[e].location,a,(0,T.oO)(void 0,i[e].authToken,t));return void o(p.m.generateResultsSuccess({tableName:e,requestType:n,generateResultsResult:l}))}}t&&k.M.getInstance().addAnalyzeDataStep(t,"postRangesIfNeeded");const s=performance.now();try{const a=await o(We(e,t)),i=await o(He(e,t));if(i&&a.rowCount*a.columnCount<=(0,Q.Z8j)("Microsoft.Office.Excel.FA000000124.AnalyzeDataCellCountLimit",pe)){y.P.getNumberFormatCache().addNumberFormatPropertiesToCache([G.tN]);const l=await i.next();if(l.done)throw Error("Selection data generator returned nothing");const s=l.value,c=(0,T.oO)(void 0,void 0,t),d=(0,Q.iPS)("Microsoft.Office.Excel.FA000000124.UseLLMFormula",!1),u=d?a.sheetName:void 0,m=d&&a.isTable&&a.tableName?a.tableName:void 0,g=await(0,T.gp)(ye(s),a,u,m,c);let{isComplete:h,authToken:b}=g,f=l.value.values.length;const C=(0,T.oO)(void 0,b,t);for await(const t of i){if(h)throw Error('Insights range returned with "Complete" status before all data was sent');const a=Te(ye(t),e,r().selection.activeTable,n);h=(await(0,T.yt)(g.location,a,f,C)).isComplete,f+=t.values.length}if(!h)throw Error('Insights range returned with "Incomplete" status after all data was sent');const v=ve(e,r().selection.activeTable,n),x=await(0,T.GU)(g.location,v,C);o(p.m.postRangesSuccess({tableName:e,postRangesResult:{...x,...g},requestType:n}))}}finally{t&&k.M.getInstance().removeAnalyzeDataStep(t,"postRangesIfNeeded"),k.M.getInstance().logDuration("PostRangesIfNeeded",performance.now()-s,t)}})(e,n,a,r)),t()))return;if(!at(l().selection,e))return i(p.m.clearExpiredRanges(e)),void k.M.getInstance().logInvalidInsightsSession("getInterpretationsIfNeeded");const{postRangesResults:s}=l().selection;if(t())return;const c=s[e],d=(0,T.oO)(void 0,c.authToken,n);if(!c.operationLocation)throw new Error(o.O.MissingOperationLocation);await(0,T.mo)(c.operationLocation,{interpretations:async t=>{const r=await i(We(e,n)),l=await(0,T.ke)(t,r,d);if(0===l.interpretations.length)throw new Error(o.O.GetInterpretationsFailed);i(p.m.getInterpretationsSuccess({tableName:e,result:l,requestType:a}))},recommendations:"NL"===a?void 0:async t=>{const a=await i(We(e,n)),o=await(0,T.Dz)(t,a,d);o.recommendations.length>0&&i(p.m.getRecommendationsSuccess({tableName:e,recommendations:o.recommendations}))}},d)}finally{k.M.getInstance().logDuration("GetInterpretationsIfNeeded",performance.now()-c,n),n&&k.M.getInstance().removeAnalyzeDataStep(n,"getInterpretationsIfNeeded")}},Se=(e,t,n=()=>!1,a=!1)=>async(r,i)=>{t&&k.M.getInstance().addAnalyzeDataStep(t,"getNLContextIfNeeded");const l=performance.now(),{evaluateQueryLocations:s,generateResultForNLEvaluationLocations:c}=i().selection,d=(0,Q.iPS)("Microsoft.Office.Excel.FA000000124.UseShortPollNLEvaluating",!1)||(0,Q.iPS)("Microsoft.Office.Excel.FA000000124.EnableDynamicPlanner",!1);if((!d||!c[e])&&(d||!s[e])){if(i().selection.pendingNLContextFetches.includes(e))return t&&k.M.getInstance().addAnalyzeDataStep(t,"pendingNLContextFetches"),await new Promise((t=>{V.F_.startListening({predicate:(t,n)=>t.type===p.m.getNLContextFinished.type&&!n.selection.pendingNLContextFetches.includes(e),effect:(e,n)=>{n.unsubscribe(),t()}})})),k.M.getInstance().logDuration("GetNLContextIfNeeded",performance.now()-l,t),void(t&&(k.M.getInstance().removeAnalyzeDataStep(t,"pendingNLContextFetches"),k.M.getInstance().removeAnalyzeDataStep(t,"getNLContextIfNeeded")));r(p.m.getNLContextRequest(e));try{if((!i().selection.interpretations[e]||0===i().selection.interpretations[e].length)&&(await r(xe(e,n,t)),n()))return;if(!at(i().selection,e))return r(p.m.clearExpiredRanges(e)),void k.M.getInstance().logInvalidInsightsSession("getNLContextIfNeeded");if(!i().selection.interpretations[e]||0===i().selection.interpretations[e].length)throw new Error(o.O.GetInterpretationsFailed);const{interpretations:a,postRangesResults:l}=i().selection,s=a[e][0];if(n())return;const c=(0,T.oO)(void 0,l[e].authToken,t),d=await(0,T.bl)(s.generateNLContextLocation,{headerNames:[],preferColumnsIndexes:[]},c);r(p.m.getNLContextSuccess({tableName:e,contextResponse:d}))}catch(i){if(!(i instanceof o.u)||i.errorCode!==o.O.Gone&&i.errorCode!==o.O.NotFound||a)throw i;r(p.m.clearExpiredRanges(e)),r(p.m.getNLContextFinished(e)),await r(Se(e,t,n,!0))}finally{r(p.m.getNLContextFinished(e)),k.M.getInstance().logDuration("GetNLContextIfNeeded",performance.now()-l,t),t&&k.M.getInstance().removeAnalyzeDataStep(t,"getNLContextIfNeeded")}}},we=(e,t,n,s,c,d)=>async(u,m)=>{const g=performance.now();try{if(k.M.getInstance().clearAnalyzeDataSteps(n),k.M.getInstance().addAnalyzeDataStep(n,"getInsights"),u(B.m.startExecutingCommand({command:b.OP.AnalyzeData,id:n})),u(p.m.setActiveRequestId({tableName:e,activeRequestId:n})),t.numColumns*t.numRows>(0,Q.Z8j)("Microsoft.Office.Excel.FA000000124.AnalyzeDataCellCountLimit",pe))throw new o.u(o.O.LargeData);const a=async(e=()=>()=>{})=>{await d(e),"failed"!==m().selection.requestState[n]&&u(p.m.evaluateQuerySuccess(n))};let r=()=>{};const i=new Promise(((e,t)=>{r=()=>t(new Error("timeout"))}));let l=setTimeout(r,F.R.getAnalyzeDataTimeout(U.CP.getActiveTableRowNumber()));const s=()=>(clearTimeout(l),()=>{l=setTimeout(r,F.R.getAnalyzeDataTimeout(U.CP.getActiveTableRowNumber()))}),c=(async()=>{try{await a(s)}finally{clearTimeout(l)}})();await Promise.race([c,i])}catch(e){e instanceof Error&&"timeout"===e.message&&k.M.getInstance().logErrorCode(o.O.AnalyzeDataTimeout,void 0,L.S2.AnalyzeDataDuration,f.$b.ASHA,{key:b.un.ErrorLocation,value:k.M.getInstance().getLastAnalyzeDataStep(n)??""},{key:b.un.EvaluateQueryCorrelationId,value:n}),u(p.m.evaluateQueryFailed(n)),k.M.getInstance().logEvent((0,b.SV)(b.he.NoResult,b.q.AnalyzeData,b.KZ.InsightsApi,void 0,void 0,void 0,...(0,b.r)(t)));let d=(0,a.Hum)(),m=s,g=b.q0.ClientError,h=i.W.Unable_To_Complete_Task,C=r.c.Analyze_Data_Get_Insights_Client_Error;e instanceof Error&&e.message===o.O.GetInterpretationsFailed?(d=(0,a.S5F)(),m=o.O.GetInterpretationsFailed,g=b.q0.NoSuggestions,h=i.W.User_Input_Could_Not_Be_Processed,C=r.c.Failed_Insight_Generation_Due_To_Not_Enough_Info):e instanceof o.u&&e.errorCode===o.O.LargeData?(d=4e6===(0,Q.Z8j)("Microsoft.Office.Excel.FA000000124.AnalyzeDataCellCountLimit",pe)?(0,a.ynC)():(0,a.SqW)(),m=o.O.LargeData,g=b.q0.LargeData,h=i.W.User_Input_Could_Not_Be_Processed,C=r.c.Failed_Insight_Generation_Due_To_Too_Large_Data):e instanceof o.u&&e.errorCode===o.O.NetworkError?(d=(0,a.a0$)(),m=o.O.NetworkError,g=b.q0.NetworkError,h=i.W.Unable_To_Complete_Task,C=r.c.Analyze_Data_Network_Error):e instanceof Error&&"timeout"===e.message?(m=o.O.AnalyzeDataTimeout,g=b.q0.AgentTimeout,h=i.W.Response_Delayed_Or_Timed_Out,C=r.c.Analyze_Data_Insights_Services_Timeout):(0,ce.ip)(e)&&(d=(0,a.OX0)(),m=o.O.PayloadSizeError,g=b.q0.LargeData,h=i.W.User_Input_Could_Not_Be_Processed,C=r.c.Failed_Insight_Generation_Due_To_Too_Large_Data),k.M.getInstance().logErrorCode(m,e,L.S2.AnalyzeDataError,e instanceof Error&&"timeout"===e.message?f.$b.Error:f.$b.ASHA,...(0,b.r)(t)),k.M.getInstance().logStandardizedAshaErrorEvent(h,C,b.BJ.AnalyzeData);const{message:y,telemetry:v}=ue.n.getAnalyzeDataErrorResponse(d,g);if(l.$.getInstance().displayResponse(y,v,{shouldShowWhenFluxSkillResponseRequired:!1}),c){const e=(0,X.N)(y);u((0,se.nv)(e,x.Aw.failed,v))}}finally{c||await u((0,se.L4)()),u(p.m.resetIsAllowRewrite()),k.M.getInstance().logDuration("GetInsights",performance.now()-g,n),k.M.getInstance().clearAnalyzeDataSteps(n)}},Ee=(e,t,n,r)=>async(i,s)=>{await i(we(e,t,n,"ChartReco"===r?o.O.GetChartRecoFailed:o.O.GetPivotTableRecoFailed,!1,(async()=>{await i(xe(e,(()=>"failed"===s().selection.requestState[n]),n,r,!0))})));const c=s().selection.recommendations[e];if(c&&c.length>0){i((0,se.qc)(c,r));const a=c[0],{message:o,telemetry:s}=ue.n.getAnalyzeDataRecommendationResponse({visual:a,requestId:n,responseText:"",tableName:e,tableContext:t});l.$.getInstance().displayResponse(o,s)}else{const{message:e,telemetry:t}=ue.n.getAnalyzeDataErrorResponse((0,a.S5F)(),b.q0.NoSuggestions);l.$.getInstance().displayResponse(e,t,{shouldShowWhenFluxSkillResponseRequired:!1})}},Ie=(e,t,n,s,c=()=>()=>{},d=()=>!1,u=!1,m)=>async(g,h)=>{k.M.getInstance().addAnalyzeDataStep(s,"evaluateQuery");const y=performance.now();try{const y=(0,Q.iPS)("Microsoft.Office.Excel.FA000000124.UseShortPollNLEvaluating",!1)||(0,Q.iPS)("Microsoft.Office.Excel.FA000000124.EnableDynamicPlanner",!1),v=y&&!h().selection.generateResultForNLEvaluationLocations[e],S=!y&&!h().selection.evaluateQueryLocations[e];(v||S)&&await g(Se(e,s));const{postRangesResults:w,interpretations:E,evaluateQueryLocations:I,generateResultForNLEvaluationLocations:R,isAllowRewrite:A}=h().selection,F=function(e){if(""!==e)return{tokens:[{tokenType:"none",text:e}]}}(n);if(!F)throw new Error("No query tokens found");const _=(0,Q.iPS)("Microsoft.Office.Excel.FA000000124.EnableDynamicPlanner",!1)&&(0,Q.yw9)("OfficeVSO_10375249_PassRawQueryToInsights")?h().selection.rawQueries[s]:void 0,P={visualPreviewOptions:{maxTableDataSize:function(){const e=K.U$+20,t=K.Pl+20;return{width:Math.max(G.y3,e),height:Math.max(G.m6,t)}}()},allowReorder:!1,allowRewrite:A,outputAnswerLanguage:m,rawQuery:_,...F},N=await g((0,re.gf)(c));if(!N)throw new Error("Failed to get token for evaluateQuery request");if(!at(h().selection,e))return g(p.m.clearExpiredRanges(e)),void k.M.getInstance().logInvalidInsightsSession("evaluateQuery");const M=(0,T.oO)(N,w[e].authToken,s);try{let o;const r=await g(We(e,s));if(o=y?await Re(R[e],P,E[e][0],r,s,g,h,e,t,M,n,d):await(0,T.xX)(I[e],P,E[e][0],r,M),m&&(o.outputLanguage=m),d())return;g((0,se.PQ)(o,e,t));const i=h().selection.nlEvaluationStates[s]?.intermediateResults??[],c=(0,Q.iPS)("Microsoft.Office.Excel.FA000000124.EnableDynamicPlanner",!1)&&i&&i.length>0;if(c?i.forEach((e=>{k.M.getInstance().logEvaluateQuery(e,r)})):k.M.getInstance().logEvaluateQuery(o,r),o.responseType===C.WZ.Answered){g(p.m.getRecommendationsSuccess({tableName:e,recommendations:o.visualAnswer}));const r=!1===o.fullyUnderstoodRewrittenQuery;if(c){k.M.getInstance().logEvent((0,b.SV)(b.he.SuggestionShown,b.q.AnalyzeData,b.KZ.InsightsApi));const{telemetry:e}=ue.n.getAnalyzeDataInfoResponse(""),t=(0,Z.q)(i);U.CP.setQueryIdShouldNotShowFluxResponse(k.M.userQueryGuid),g((0,se.nv)(t,x.Aw.success,e))}else if(o.visualAnswer.every((e=>("QueryResultVisual"===e.visual.visualType||"QueryChartVisual"===e.visual.visualType)&&0===e.visual.result.fields.length))){k.M.getInstance().logEvent((0,b.SV)((0,Q.nmB)()?b.he.PythonFallback:b.he.ElseFallback,b.q.AnalyzeData,b.KZ.InsightsApi));const{message:e,telemetry:t}=ue.n.getAnalyzeDataInfoResponse("");l.$.getInstance().displayResponse(e,t,{shouldShowWhenFluxSkillResponseRequired:!1});const n={text:(0,a.S5F)(),visual:he,mustExplain:o.explainToLLM,fallbackToElse:!0,fallbackToPython:(0,Q.nmB)()},r=JSON.stringify(n);g((0,se.nv)(r,x.Aw.failed,t))}else if(o.caveats&&o.caveats.length>0)if(o.visualAnswer.some((e=>!(0,$.ch)(e.visual)))&&!(0,Q.nmB)()){k.M.getInstance().logEvent((0,b.SV)(b.he.SuggestionShown,b.q.AnalyzeData,b.KZ.InsightsApi));const a=tt(o),r=o.visualAnswer[0],{message:i,telemetry:c}=ue.n.getAnalyzeDataRecommendationResponse({visual:r,requestId:s,responseText:"",caveats:o.caveats,tableName:e,tableContext:t,query:n});l.$.getInstance().displayResponse(i,c);const d=(0,Z.t)(r,"",o.textAnswer?.tokens.map((e=>e.text)).join(""),a);g((0,se.nv)(d,x.Aw.success,c))}else{k.M.getInstance().logEvent((0,b.SV)((0,Q.nmB)()?b.he.PythonFallback:b.he.ElseFallback,b.q.AnalyzeData,b.KZ.InsightsApi));const{message:e,telemetry:t}=ue.n.getAnalyzeDataInfoResponse("");l.$.getInstance().displayResponse(e,t,{shouldShowWhenFluxSkillResponseRequired:!1});const n={text:(0,a.$Sd)(),visual:he,mustExplain:o.explainToLLM,fallbackToElse:!0,fallbackToPython:(0,Q.nmB)()},r=JSON.stringify(n);g((0,se.nv)(r,x.Aw.failed,t))}else if(o.visualAnswer.every((e=>(0,$.ch)(e.visual)))){k.M.getInstance().logEvent((0,b.SV)(b.he.SuggestionShown,b.q.AnalyzeData,b.KZ.InsightsApi));const e=r?(0,a.aI5)():(0,a.hiC)(),t=(o.textAnswerSummary?.tokens??[]).map((e=>e.text)).join(""),n=t.length>0?e.replace("{0}",t[0].toLocaleLowerCase()+t.slice(1)):(0,a.V0i)(),{message:i,telemetry:s}=ue.n.getAnalyzeDataInfoResponse(n);l.$.getInstance().displayResponse(i,s,{shouldShowWhenFluxSkillResponseRequired:!1});const c=JSON.stringify({text:n,visual:he,mustExplain:o.explainToLLM});g((0,se.nv)(c,x.Aw.failed,s))}else{k.M.getInstance().logEvent((0,b.SV)(b.he.SuggestionShown,b.q.AnalyzeData,b.KZ.InsightsApi));const i=(r?(0,a.bUh)():1===o.visualAnswer.length?(0,a.wT9)():(0,a.YTh)()).replace("{0}",(0,de.Yd)(o.visualAnswer[0].visual.visualType)??"visual");let c=o.textAnswer?.tokens.map((e=>e.text)).join("");c=r?o.textAnswer?.tokens.map((e=>e.text)).join("")+" "+i:o.visualAnswer.length>1&&o.visualAnswer[0].title?o.visualAnswer[0].title.runs.map((e=>e.text)).join(""):o.textAnswer?.tokens.map((e=>e.text)).join("");const d=tt(o),u=o.visualAnswer[0],m="TextAnalysisVisual"===o.visualAnswer[0].visual.visualType,h=(0,ge.A)(),p={visual:m?{...u,id:h}:u,requestId:s,responseText:i,tableName:e,tableContext:t,query:n},{message:f,telemetry:C}=ue.n.getAnalyzeDataRecommendationResponse(p),y=(0,Z.t)(m?{...u,id:h}:u,i,c,d),v=()=>g((0,se.nv)(y,x.Aw.success,C,!0,!0,m));l.$.getInstance().displayResponse(f,C),m&&U.CP.setQueryIdShouldNotShowFluxResponse(k.M.userQueryGuid),m&&it(u.visual)&&lt(k.M.userQueryGuid,u.visual),v()}}else if((0,Q.yw9)("OfficeVSO_10449020_LoopFallBack")&&!0===h().selection.shouldFallBack[s]){k.M.getInstance().logEvent((0,b.SV)((0,Q.nmB)()?b.he.PythonFallback:b.he.ElseFallback,b.q.AnalyzeData,b.KZ.InsightsApi));const{message:e,telemetry:t}=ue.n.getAnalyzeDataInfoResponse("");l.$.getInstance().displayResponse(e,t,{shouldShowWhenFluxSkillResponseRequired:!1});const n={text:(0,a.$Sd)(),visual:he,mustExplain:o.explainToLLM,fallbackToElse:!0,fallbackToPython:(0,Q.nmB)()},r=JSON.stringify(n);g((0,se.nv)(r,x.Aw.failed,t))}else{const e=(o.explainToLLM?.length??0)>0;let t,n;o.reasonForError===C.M$.AskForClarification&&e?t=b.he.SuggestionShown:mt(o.reasonForError)?t=b.he.PythonFallback:ut(o.reasonForError)?t=b.he.ElseFallback:(dt(o.reasonForError,e),t=b.he.NoResult),k.M.getInstance().logEvent((0,b.SV)(t,b.q.AnalyzeData,b.KZ.InsightsApi));let r,i=o.explainToLLM;if(o.reasonForError){const e=ct(o.reasonForError);n=e.errorMessage,e.explainToLLM&&(i&&i.length>0?(i+=". ",i+=e.explainToLLM):i=e.explainToLLM)}else n=(0,a.Rzj)();r=o.reasonForError===C.M$.AskForClarification&&e?ue.n.getAnalyzeDataInfoResponse(n):ut(o.reasonForError)||mt(o.reasonForError)?ue.n.getAnalyzeDataInfoResponse(""):ue.n.getAnalyzeDataErrorResponse(n,b.q0.NoSuggestions);const{message:s,telemetry:c}=r;l.$.getInstance().displayResponse(s,c,{shouldShowWhenFluxSkillResponseRequired:!1});const d={text:n,visual:he,mustExplain:i,fallbackToElse:ut(o.reasonForError),fallbackToPython:mt(o.reasonForError)},u=JSON.stringify(d);g((0,se.nv)(u,x.Aw.failed,c))}}catch(h){let C=b.q0.ClientError,y=i.W.Unable_To_Complete_Task,v=r.c.Analyze_Data_Evaluate_Query_Client_Error,T=!1,S=(0,a.Hum)();if(h instanceof o.u)switch(h.errorCode){case o.O.Gone:case o.O.NotFound:if(!u)return g(p.m.clearExpiredRanges(e)),void await g(Ie(e,t,n,s,c,d,!0,m));break;case o.O.InternalServerError:C=b.q0.ServiceError,y=i.W.Unable_To_Complete_Task,v=r.c.Analyze_Data_Insights_Services_Error,T=(0,Q.yw9)("OfficeVSO_10237986_FallbackPython500");break;case o.O.NetworkError:S=(0,a.a0$)(),C=b.q0.NetworkError,y=i.W.Unable_To_Complete_Task,v=r.c.Analyze_Data_Network_Error;break;case o.O.Unauthorized:(0,Q.yw9)("OfficeVSO_9974407_RemoveAuthFallback")&&(S=(0,a.P6V)(),C=b.q0.Unauthorized,y=i.W.User_Access_Issue_For_Copilot)}if(k.M.getInstance().logErrorCode(o.O.EvaluateQueryFailed,h,L.S2.AnalyzeDataError,f.$b.ASHA),T){k.M.getInstance().logEvent((0,b.SV)(b.he.PythonFallback,b.q.AnalyzeData,b.KZ.InsightsApi));const e=JSON.stringify({text:S,visual:he,fallbackToPython:!0});g((0,se.nv)(e,x.Aw.failed,{featureName:b.q.AnalyzeData,eventType:b.a5.ErrorMessage,errorType:C}))}else{k.M.getInstance().logStandardizedAshaErrorEvent(y,v,b.BJ.AnalyzeData);const{message:e,telemetry:t}=ue.n.getAnalyzeDataErrorResponse(S,C);l.$.getInstance().displayResponse(e,t,{shouldShowWhenFluxSkillResponseRequired:!1});const n=(0,X.N)(e);g((0,se.nv)(n,x.Aw.failed,t))}}}finally{k.M.getInstance().removeAnalyzeDataStep(s,"evaluateQuery"),k.M.getInstance().logDuration("EvaluateQuery",performance.now()-y,s)}},Re=async(e,t,n,a,o,r,i,s,c,d,u,m)=>{const g=await(0,T.JU)(e,t,d);let h={};if(m())return h;return await(0,T.mo)(g.operationLocation,{nlEvaluationResult:async e=>{m()||(h=await(0,T.LS)(e,n,a,t.forceStaticAnswer,d))}},{nlEvaluationState:async e=>{if(!e)return{shouldDeleteOperation:!1};if(m())return{shouldDeleteOperation:!1};if((0,Q.iPS)("Microsoft.Office.Excel.FA000000124.EnableDynamicPlanner",!1)){const t=i().selection.nlEvaluationStates[o]?.intermediateResults??[],n=e?.intermediateResults??[];for(let e=t.length;e<n.length;e++){const t=n[e];if(t.visualAnswer&&t.visualAnswer.length>0){if(t.caveats&&t.caveats.length>0)return r(p.m.setShouldFallBack({requestId:o,shouldFallBack:!0})),{shouldDeleteOperation:!0};const{message:e,telemetry:n}=ue.n.getAnalyzeDataRecommendationResponse({visual:t.visualAnswer[0],requestId:o,responseText:"",tableName:s,tableContext:c,query:u});l.$.getInstance().displayResponse(e,n);const a=t.visualAnswer[0].visual;"TextAnalysisVisual"===a.visualType&&it(a)&&lt(k.M.userQueryGuid,a)}else if(t.responseType===C.WZ.Answered&&t.textAnswer?.tokens&&t.textAnswer?.tokens.length>0){const{message:e,telemetry:n}=ue.n.getAnalyzeDataMarkdownResponse(t.textAnswer.tokens[0].text);l.$.getInstance().displayResponse(e,n)}else;}}return r(p.m.setNLEvaluationState({requestId:o,nlEvaluationState:e})),{shouldDeleteOperation:!1}}},d,n,a,m),h},Ae=(e,t,n,a,r)=>async(i,l)=>i(we(e,t,a,o.O.GetInsightsFailed,!0,(async o=>{const s=()=>"failed"===l().selection.requestState[a];await i(Se(e,a,s)),s()||await i(Ie(e,t,n,a,o,s,!1,r))}))),Le=e=>{switch(e){case"ChartVisual":case"ForecastVisual":case"PivotChartVisual":case"PivotTableVisual":case"QueryChartVisual":return(0,Q.yw9)("OfficeVSO_9364126_UpdateAnalyzeDataInsertResponse")?(0,a.zGM)():(0,a.FxF)();case"QueryResultVisual":case"TextAnalysisVisual":return;default:(0,_.x)(e)}},ke=(e,t,n,s,c)=>async(d,u)=>{try{S.B.getInstance().logKeptEvent(b.BJ.AnalyzeData,b.q.AnalyzeData,E.RX.Analyze),k.M.getInstance().logEvent((0,b.SV)(b.he.SuggestionApplied,b.q.AnalyzeData,b.KZ.AddButton,t.id));const o="TextAnalysisVisual"===t.visual.visualType,r="ChartVisual"===t.visual.visualType||o?(0,a.zVb)():(0,a.W4k)(),{message:i,telemetry:m}=ue.n.getAnalyzeDataUserChat(r);l.$.getInstance().displayResponse(i,m),d((0,se.eM)(b.OP.InsertAnalyzeData));const g=c??await d(We(e)),h=null!=s?s:(0,$.gD)(t,u().selection.interpretations[e]);if(!g.sheetId)throw new Error("SheetId is not available in selection context");if(!g.sheetName)throw new Error("SheetName is not available in selection context");if(!g.address)throw new Error("Address is not available in selection context");const f=new w.N(g.sheetId,g.sheetName,g.address,g.isTable?g.tableName:null),C=await(0,P.h7)(t,f,h);if((0,P.Ns)(C,[],((e,n)=>(("Sheet"===n&&e===C.sheetId||e===C.objectId)&&(k.M.getInstance().logRejectedEvent(b.q.AnalyzeData,t.id),k.M.getInstance().logEvent((0,b.SV)(b.he.Deleted,b.q.AnalyzeData,b.KZ.GridAction,t.id))),Promise.resolve()))),await d((0,se.L4)()),o&&!C.range)throw new Error("No inserted range returned for text analysis insertion");const y=o?C.range.values[0][0]:t.title?.runs.map((e=>e.text)).join(""),v=o?(0,O.L)((0,a.OfU)(),y,(0,$.c3)(C.range.columnIndex+1)):(0,O.L)((0,a.mjl)(),y,C.sheetName),{message:T,telemetry:I}=ue.n.getAnalyzeDataInsertSuccessResponse({messageText:v,tableContext:n,confirmationMessage:(0,Q.tgf)()?Le(t.visual.visualType):void 0,suggestionId:t.id,shouldShowGoBackToTableButton:null!=n&&"TextAnalysisVisual"!==t.visual.visualType,originalDataSheetId:g.sheetId});l.$.getInstance().displayResponse(T,I),o&&(d(p.m.clearTable(e)),await d(He(e)));const R=(0,X.N)(i);d((0,se.nv)(R,x.Aw.success,m))}catch(e){if(await d((0,se.L4)()),k.M.getInstance().logErrorCode(o.O.InsertionFailed,e,L.S2.AnalyzeDataError,f.$b.ASHA),e instanceof OfficeExtension.Error&&e.code===OfficeExtension.ErrorCodes.accessDenied){k.M.getInstance().logStandardizedAshaErrorEvent(i.W.User_Access_Issue_For_Copilot,r.c.Failed_Insight_Insertion_Due_To_Protection_Settings,b.BJ.AnalyzeData);const{message:e,telemetry:t}=ue.n.getAnalyzeDataErrorResponse((0,a.V7x)());l.$.getInstance().displayResponse(e,t,{shouldShowWhenFluxSkillResponseRequired:!1});const n=(0,X.N)(e);d((0,se.nv)(n,x.Aw.failed,t))}else if(e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.invalidOperationInCellEditMode){k.M.getInstance().logStandardizedAshaErrorEvent(i.W.User_Access_Issue_For_Copilot,r.c.Failed_Insight_Insertion_Due_To_User_Edits,b.BJ.AnalyzeData);const{message:e,telemetry:t}=ue.n.getAnalyzeDataErrorResponse((0,a.WJg)());l.$.getInstance().displayResponse(e,t,{shouldShowWhenFluxSkillResponseRequired:!1});const n=(0,X.N)(e);d((0,se.nv)(n,x.Aw.failed,t))}else{k.M.getInstance().logStandardizedAshaErrorEvent(i.W.Unable_To_Complete_Task,r.c.Failed_Insight_Insertion,b.BJ.AnalyzeData);const{message:e,telemetry:t}=ue.n.getAnalyzeDataErrorResponse((0,a.OSb)());l.$.getInstance().displayResponse(e,t,{shouldShowWhenFluxSkillResponseRequired:!1});const n=(0,X.N)(e);d((0,se.nv)(n,x.Aw.failed,t))}}},Fe=(e,t,n)=>async(a,o)=>{const r=n.map((e=>d.ExcelCalc.addressToExcelRange((0,ee.r)(e))));if(r.some((e=>!(0,N.M$)(e))))return;const i=o().selection.tabularRanges[e]??{},l=(0,N.py)(t),s=i[l];if(!s)return;const c=s.range,u=r.map((e=>(0,M._)(c,e)));if(1!==Math.min(...u))return;const m=(0,N.GT)([c,...r]),g=(0,N.OK)(m,o().selection.tabularRanges[e]??{},l,e);a(p.m.updateTableInterpretationsForSheet({sheetId:e,newInterpretations:g}))},_e=(e,t)=>async(n,a)=>{let r,i,l,s,c={},m="";if(t?({coauthVersionDocId:i,coauthVersionXluid:l,coauthVersionXrevId:s}=JSON.parse(t)):k.M.getInstance().logErrorCode(o.O.TLRRevisionError,(0,b.Jr)("parentRevId is undefined"),L.S2.TabularRange,f.$b.Warning),i||l||s){m=`${i}.${l}.${s}`}else k.M.getInstance().logErrorCode(o.O.TLRRevisionError,(0,b.Jr)("revisionWaterline is undefined"),L.S2.TabularRange,f.$b.Warning);((0,Q._mi)()||(0,Q.JMu)())&&n(p.m.updateExcelRecognizedTableCache({revisionId:m,recognizedTable:e}));const g=e.range.worksheetId;if(A.E.getInstance().logTableRecognized(),(0,Q.tgf)())({newInterpretations:c,range:r}=await(async(e,t)=>{const n={};let a;if(!e.tableName){if(e.interpretations.length>2){const a=e.interpretations[0],o=a.location;let{unsupportedFeatures:r,hasTotalRow:i}=(0,N.bp)(a,e);r|=u.ye.LowInterpretationConfidence;const{locationKey:l,range:s,sheetName:c}=await Ne(o,e);return n[l]={name:(0,W.Jm)(c,o),interpretation:a,hasMergedCells:e.hasMergedcells??!1,range:s,revisionWaterline:t,unsupportedFeatures:r,hasTotalRow:i},{newInterpretations:n,range:s}}for(const o of e.interpretations)if(o.confidence>=.75||.5===o.confidence&&"columnMajor"===o.orientation){const{unsupportedFeatures:r,hasTotalRow:i}=(0,N.bp)(o,e),l=o.location;let s,c;({sheetName:c,range:a,locationKey:s}=await Ne(l,e)),n[s]={name:(0,W.Jm)(c,l),interpretation:o,hasMergedCells:e.hasMergedcells??!1,range:a,revisionWaterline:t,unsupportedFeatures:r,hasTotalRow:i};break}}return{newInterpretations:n,range:a}})(e,m));else if(!e.hasMergedcells&&!e.tableName)for(const t of e.interpretations){let n=t.location,a=0===(t.aggregationLines?.length??0);const o=1===t.aggregationLines?.length,i=e.primaryTable?.hasTotalRow??!1;o&&i&&(n={...t.location,bottom:t.location.bottom-1},a=!0);const l=(0,Q.iPS)("Microsoft.Office.Excel.FA000000124.CalculatedColumnsHeaderLessTLR",!1);if(t.confidence>=.75&&"columnMajor"===t.orientation&&(1===t.headerRowCount||l&&0===t.headerRowCount)&&0===t.headerColumnCount&&a){if(t.headerNames){if(new Set(t.headerNames.map((e=>e.toLowerCase()))).size!==n.right-n.left+1)continue}r=J(n);const a=(0,N.MQ)(r),o=await U.CP.ensureSheetName(e.sheetName,n.worksheetId);c[a]={name:(0,W.Jm)(o,n),interpretation:{...t,location:n},hasMergedCells:e.hasMergedcells??!1,range:r,revisionWaterline:m,unsupportedFeatures:u.ye.None,hasTotalRow:!1};break}}const h=a().selection.tabularRanges[g]??{};for(const[e,t]of Object.entries(h))r&&t.range&&d.ExcelCalc.IExcelRangeIntersect(r,t.range)&&n(p.m.clearTable(t.name)),t.revisionWaterline===m&&(c[e]=t);n(p.m.updateTableInterpretationsForSheet({sheetId:g,newInterpretations:c})),e.tableName||g!==U.CP.getActiveWorksheetId()||await U.CP.refreshSelectionContext()},Pe=(e,t)=>async(n,a)=>{let r,i,l,s="";if(t?({coauthVersionDocId:r,coauthVersionXluid:i,coauthVersionXrevId:l}=JSON.parse(t)):k.M.getInstance().logErrorCode(o.O.BlobRangeRevisionError,(0,b.Jr)("parentRevId is undefined"),L.S2.WorkbookContext,f.$b.Warning),r||i||l){s=`${r}.${i}.${l}`}else k.M.getInstance().logErrorCode(o.O.BlobRangeRevisionError,(0,b.Jr)("revisionWaterline is undefined"),L.S2.WorkbookContext,f.$b.Warning);n(p.m.updateExcelBlobRangeCache({revisionId:s,blobRange:e}))};async function Ne(e,t){const n=J(e);return{locationKey:(0,N.MQ)(n),range:n,sheetName:await U.CP.ensureSheetName(t.sheetName,e.worksheetId)}}const Me=(e,t)=>(n,a)=>{const o=a().selection.tabularRanges[e];if(!o)return;const r=te(t);let i;for(const e of Object.values(o)){const t=e.name,n=J(e.interpretation.location);if(d.ExcelCalc.IExcelRangeContainedIn(r,n))return{name:t,tabularRange:e,distance:0};if(d.ExcelCalc.IExcelRangeIntersect(r,n))return{name:t,tabularRange:e,distance:0};{const a=(0,M._)(r,n);(!i||a<i.distance)&&(i={name:t,tabularRange:e,distance:a})}}return i},Oe=(e,t)=>(n,a)=>{const o=a().selection.tabularRanges[e];if(!o)return[];const r=te(t);return Object.values(o).filter((e=>{const t=J(e.interpretation.location);return d.ExcelCalc.IExcelRangeIntersect(r,t)}))},De=e=>(t,n)=>{if(n().selection.selectionContexts[e])return{localeCacheDeprecated:n().selection.localeCacheDeprecated,theme:n().selection.themeColors}},Be=()=>(e,t)=>t().app.augloopModelWorkflowUnsupported,$e=(e,t)=>async(n,a)=>{if(!a().chat.isCurrentNLResultValid&&e?.tableLikeRangeFeatures!==u.ye.Unrecognized)return n(He(e.name,t))},He=(e,t)=>async(n,a)=>{if((0,Q.tgf)()&&U.CP.activeChart)return;t&&k.M.getInstance().addAnalyzeDataStep(t,"resolveTableLikeEntity");const r=performance.now();try{const a=n(Ue(e));if(a)return await n(qe(a,t));if(e.includes("!"))throw new Error(o.O.TLRNotFound);return await n(((e,t)=>async n=>{t&&k.M.getInstance().addAnalyzeDataStep(t,"resolveTable");const a=performance.now();try{const a=await(0,ae.px)({type:R.lp.StandardTable,name:e},t),{context:o,dataGenerator:r,localeDeprecated:i,theme:l}=a;return n(p.m.setSelectionContext({context:o,tableName:e,localeCacheDeprecated:i,theme:l})),n(Ve(e,t)),r}finally{t&&k.M.getInstance().removeAnalyzeDataStep(t,"resolveTable"),k.M.getInstance().logDuration("ResolveTable",performance.now()-a,t)}})(e,t))}finally{k.M.getInstance().logDuration("ResolveTableLikeEntity",performance.now()-r,t),t&&k.M.getInstance().removeAnalyzeDataStep(t,"resolveTableLikeEntity")}},Ue=e=>(t,n)=>Object.values(n().selection.tabularRanges).flatMap(Object.values).find((t=>(0,N.$j)(e,t))),qe=(e,t)=>async n=>{t&&k.M.getInstance().addAnalyzeDataStep(t,"resolveTabularRange");const a=performance.now();try{const a={type:R.lp.TableLikeRange,name:e.name,sheetId:e.interpretation.location.worksheetId,showTotals:e.hasTotalRow,hasTableHeaders:e.interpretation.headerRowCount>0},o=await(0,ae.px)(a,t),{context:r,dataGenerator:i,localeDeprecated:l,theme:s}=o;return n(p.m.setSelectionContext({tableName:e.name,context:r,localeCacheDeprecated:l,theme:s})),n(Ve(e.name,t)),i}finally{k.M.getInstance().logDuration("ResolveTabularRange",performance.now()-a,t),t&&k.M.getInstance().removeAnalyzeDataStep(t,"resolveTabularRange")}},Ve=(e,t)=>async(n,a)=>{const{dataSourceApis:o}=a().selection;if(o[e])return a().selection.dataSourceApis[e];const r=await n(We(e,t)),{sheetId:i,rowIndex:l,rowCount:c,columnIndex:d,columnCount:u}=r,{text:m,values:g,formats:h,formulas:b}=await(0,ae.VQ)(Math.min(c,(0,Q.xyg)("CalculatedColumnsMaxRows"),Math.floor((0,Q.xyg)("CalculatedColumnsMaxCells")/u)),l,u,d,i,t),f=(0,s.O)({textRows:m,valueRows:g,formatRows:h,formulas:b});return n(p.m.setDataSourceApi({tableName:e,dataSourceApi:f})),f},We=(e,t)=>async(n,a)=>{let{selectionContexts:o}=a().selection;if(o[e])return a().selection.selectionContexts[e];if(await n(He(e,t)),o=a().selection.selectionContexts,o[e])return a().selection.selectionContexts[e];throw new Error("getSelectionContextIfNeeded: SelectionContext not found for table name")},Ge=(0,V.YQ)(((e,t)=>t().selection.excelRecognizedTablesAnnotationsCache)),ze=(0,V.YQ)(((e,t)=>t().selection.excelBlobRangeCache)),Qe=(0,V.YQ)(((e,t,n)=>t().selection.selectionContexts[n])),je=()=>(e,t)=>{let n,a;if((0,Q.ZAR)()){const e=t().chat;n=e.currentNLResultTableContext,a=e.currentNLResultTableName}else n=U.CP.getActiveTable(),a=n?.name;if(!n||!a)return;const o=t().chat.currentRecos||[];e(Ye(a,o,n))},Je=()=>(e,t)=>{let n,a;if((0,Q.ZAR)()){const e=t().chat;n=e.currentNLResultTableContext,a=e.currentNLResultTableName}else n=U.CP.getActiveTable(),a=n?.name;if(!n||!a)return;const o=t().chat.currentNLResult?.visualAnswer||[];e(Ye(a,o,n))},Ye=(e,t,n,r)=>async(i,s)=>{if(s().selection.isInserting)return Promise.resolve();i(p.m.startInsertRecommendations());const c=performance.now(),d={recommendationData:[],isSuccessful:!1,failureLocation:h.lA.unknown,failureReason:""};i((0,se.eM)(b.OP.InsertAnalyzeData));let u="",m="",g="";try{const o=await Xe();u=o.previousActiveSheetId,m=o.dashboardSheetName,g=o.dashboardSheetId;const s=function(e){const t=new Set,n=["ChartVisual","PivotTableVisual","PivotChartVisual"],a=e.filter((e=>{if(!e.visual)return!1;const a=e.visual.visualType;if(!n.includes(a))return!1;if("ChartVisual"===a){const n=e.title;if(n){const e=(0,Y.HW)(n);if(t.has(e))return!1;t.add(e)}}return!0}));return a}(t);await i(Ke(s,m,g,e,d,r)),await i((0,se.L4)());const c=(0,O.L)((0,a.ax8)(),e),p=(0,Q.tgf)()?s.map((e=>Le(e.visual.visualType))).reduce(((e,t)=>e||t),void 0):void 0,b=await i(We(e));if(!b.sheetId)throw new Error("SheetId is not available in selection context");const{message:f,telemetry:C}=ue.n.getAnalyzeDataInsertSuccessResponse({messageText:c,tableContext:n,confirmationMessage:p,shouldShowGoBackToTableButton:null!=n,originalDataSheetId:b.sheetId});l.$.getInstance().displayResponse(f,C);const y=(0,X.N)(f);i((0,se.nv)(y,x.Aw.success,C)),d.isSuccessful=!0,d.failureLocation=h.lA.none}catch(e){await i((0,se.L4)());let t=(0,a.OSb)();e instanceof OfficeExtension.Error&&e.code===OfficeExtension.ErrorCodes.accessDenied?t=(0,a.V7x)():e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.invalidOperationInCellEditMode&&(t=(0,a.WJg)());const{message:n,telemetry:r}=ue.n.getAnalyzeDataErrorResponse(t,b.q0.DashboardInsertFailed);l.$.getInstance().displayResponse(n,r,{shouldShowWhenFluxSkillResponseRequired:!1});const s=(0,X.N)(n);i((0,se.nv)(s,x.Aw.failed,r)),d.failureReason=e.message+(e.debugInfo?.errorLocation?` Location: ${e.debugInfo?.errorLocation}`:""),await Excel.run((async e=>Ze(e,g,u))),k.M.getInstance().logErrorCode(o.O.InsertionCleanupFailed,e,L.S2.AnalyzeDataError,f.$b.ASHA)}finally{i(p.m.endInsertRecommendations()),S.B.getInstance().logKeptEvent(b.BJ.AnalyzeData,b.q.AnalyzeData,E.RX.Analyze),k.M.getInstance().logEvent((0,b.SV)(b.he.SuggestionApplied,b.q.AnalyzeData,b.KZ.DashboardSuggestionPill,g)),k.M.getInstance().logDuration("InsertRecommendationsDashboard",performance.now()-c),k.M.getInstance().logInsertRecommendationDashboard(d)}},Xe=async()=>{let e="",t="",n="";return await Excel.run((async a=>{const o=a.workbook.worksheets.getActiveWorksheet();a.workbook.worksheets.load("items"),await a.sync(),e=o.id;const r=(await(0,le.d)(a)()(a)).result;n=r.id,t=r.name})),{previousActiveSheetId:e,dashboardSheetName:t,dashboardSheetId:n}},Ze=async(e,t,n)=>{if(t){n&&e.workbook.worksheets.getItemOrNullObject(n).activate();const a=e.workbook.worksheets.getItemOrNullObject(t);await e.sync(),a.isNullObject||a.delete()}},Ke=(e,t,n,o,r,i)=>async function(l,s){const c=null!=i?i:s().selection.interpretations[o],d=await l(We(o));if(!d.sheetId)throw new Error("SheetId is not available in selection context");if(!d.sheetName)throw new Error("SheetName is not available in selection context");if(!d.address)throw new Error("Address is not available in selection context");const u=new w.N(d.sheetId,d.sheetName,d.address,d.isTable?d.tableName:null),{layoutPlacementsById:m,mainDataLocation:g,supportingDataLocation:p}=(0,h.zJ)(e,15);r.failureLocation=h.lA.findInterpretation,r.recommendationData=e.map((e=>{const{id:t}=e;return{id:t,type:e.visual.visualType,location:{chart:m[t].chart,pivotTable:m[t].pivotTable},pivotTableSizeData:et(e.visual)}}));const b=e.map((e=>{const t=(0,$.gD)(e,c);if(!t)throw l((0,se.YS)()),new Error(`insertAllRecommendationsCore: No interpretation for recommendation ${e.id}`);return{recommendation:e,interpretation:t,layoutPlacement:m[e.id]}}));r.failureLocation=h.lA.preFormatDashboardSheet,await async function(e,t,n){return Excel.run((async o=>{const r=o.workbook.worksheets.getItemOrNullObject(e);r.showGridlines=!1,r.getRange("A1").format.columnWidth=10,r.getRange("A1").format.rowHeight=10;const i=r.getRangeByIndexes(t.startRow-1,t.startColumn-1,t.rowCount+1,t.columnCount+1);if(i.format.fill.color=a.Ib6,i.format.columnWidth=a.NKv,n.rowCount&&n.columnCount){const e=n.startRow-2;r.getRangeByIndexes(e,n.startColumn,1,1).values=[[(0,a.PUb)()]];const o=r.getRangeByIndexes(e,1,1,Math.max(n.columnCount,t.columnCount+1));o.format.fill.color=a.Ib6,o.format.font.color=a.OXO,o.format.rowHeight=a.xqS,o.format.verticalAlignment="Center"}r.activate()}))}(n,g,p),r.failureLocation=h.lA.insertRecommendations,await(0,me.F5)((async e=>{await(0,P.q)(e,b,t,u,r),r.failureLocation=h.lA.postFormatDashboardSheet,await async function(e,t,n,o){const r=e.workbook.worksheets.getItemOrNullObject(t),i=r.getRangeByIndexes(n.startRow-1,n.startColumn-1,n.rowCount+1,n.columnCount+1);if(i.format.columnWidth=a.NKv,o.rowCount&&o.columnCount){const e=r.getRangeByIndexes(o.startRow,o.startColumn,o.rowCount,o.columnCount);e.format.wrapText=!0,e.format.rowHeight=15,e.format.verticalAlignment="Top"}}(e,n,g,p)})),r.failureLocation=h.lA.none};function et(e){if("PivotTableVisual"!==e.visualType&&"PivotChartVisual"!==e.visualType)return;const t=e?.pivotTable,n={};for(const[e,a]of Object.entries(t))n[e]="number"==typeof a||void 0===a?a:"object"==typeof a?a.length:typeof a;return n}function tt(e){let t=e.explainToLLM;if(e.caveats&&e.caveats.length>0){const n=(e.caveats||[]).map((e=>e.code===C.T6.ChartTypeNotSupported||e.code===C.T6.ChartTypeNotAppropriate?(0,O.L)((0,a._)(),D(e.detail)):null)).find((e=>null!==e&&e.length>0))||(0,O.L)((0,a._)(),(0,a.HRg)());t=t?t+" "+n:n}return t}function nt(e,t){const{columnCount:n,columnIndex:a,rowCount:o,rowIndex:r}=e;return new g.pW({worksheetId:t,left:a+1,top:r+1,right:a+n,bottom:r+o})}function at(e,t){return t in e.postRangesResults}const ot=(e,t,n)=>async(a,o)=>{try{const a=n.sheetRange.sheet,o=n.sheetRange.range.topLeft.row,r=n.sheetRange.range.bottomRight.column+1;await Excel.run((async n=>{const i=n.workbook.worksheets.getItem(a);i.activate();const l=i.rangeValuesPreview,s=d.ExcelCalc.IExcelRangeToAddress({topLeft:{row:o,column:r},bottomRight:{row:o,column:r}});l.show(s,[t,...e],{autoexpandTable:!0,autofitColumns:!1}),await n.sync()}))}catch(e){k.M.getInstance().logStandardizedAshaErrorEvent(i.W.UI_Failed_To_Update_Or_Load,r.c.Preview_On_Grid_Failed_To_Display,b.BJ.AnalyzeData)}},rt=e=>async(t,n)=>{try{const t=e.sheetRange.sheet;await Excel.run((async e=>{e.workbook.worksheets.getItem(t).rangeValuesPreview.dismiss(),await e.sync()}))}catch(e){k.M.getInstance().logStandardizedAshaErrorEvent(i.W.UI_Failed_To_Update_Or_Load,r.c.Preview_On_Grid_Failed_To_Display,b.BJ.AnalyzeData)}},it=e=>(0,Q.iPS)("Microsoft.Office.Excel.FA000000124.EnableFullTheming",!1)&&"TextAnalysisVisual"===e.visualType&&e.textAnalysisResult.resultType===C.rb.QuickSummary,lt=(e,t)=>{const{message:n,telemetry:a}=ue.n.getFullThemingSuggestionResponse(e,t.textAnalysisResult.columnName);l.$.getInstance().displayResponse(n,a)},st=e=>async(t,n)=>{const a=n().selection.selectionContexts;for(const n in a)a[n].sheetId===e&&t(p.m.clearTable(n))},ct=e=>{let t,n;switch(e){case C.M$.LLMThrottledError:t=(0,a.mRA)(),n=(0,a.fDp)();break;case C.M$.LLMHttpRequestError:case C.M$.LLMTimeout:case C.M$.LLMGenericError:t=(0,a.mRA)(),n=(0,a._Q4)();break;case C.M$.MissingFunctionality:case C.M$.VisualConversionError:case C.M$.UnsupportedTextAnalysisType:t=(0,a.$Sd)();break;case C.M$.ContentTooLarge:t=(0,a.NUW)();break;case C.M$.InvalidJsonFormat:case C.M$.InvalidAE:case C.M$.InvalidResponseType:case C.M$.MismatchedColumnName:case C.M$.TextAnalysisUnexpectedLLMResult:case C.M$.BlockedByRAI:case C.M$.UnsupportedExecution:case C.M$.SymbolicLogicException:case C.M$.AskForClarification:case C.M$.UnanswerableQuery:case C.M$.UnsupportedLanguage:t=(0,a.P6V)();break;default:t=(0,a.Rzj)()}return{errorMessage:t,explainToLLM:n}},dt=(e,t)=>{let n,a;switch(e){case C.M$.LLMThrottledError:n=i.W.Unable_To_Generate_Response_Due_To_Capacity_Issue,a=r.c.LLM_Throttled;break;case C.M$.LLMHttpRequestError:n=i.W.LLM_Service_Side_Issue_Prevents_Output,a=r.c.LLM_HTTP_Request_Error;break;case C.M$.LLMTimeout:n=i.W.LLM_Service_Side_Issue_Prevents_Output,a=r.c.Analyze_Data_LLM_Timeout;break;case C.M$.LLMGenericError:n=i.W.LLM_Service_Side_Issue_Prevents_Output,a=r.c.LLM_Service_Error;break;case C.M$.InvalidJsonFormat:n=i.W.Unable_To_Complete_Task,a=r.c.Invalid_Json_Format;break;case C.M$.InvalidAE:n=i.W.Unable_To_Complete_Task,a=r.c.Invalid_AE_Generated;break;case C.M$.InvalidResponseType:n=i.W.Unable_To_Complete_Task,a=r.c.Invalid_Response_Type;break;case C.M$.MismatchedColumnName:n=i.W.Unable_To_Complete_Task,a=r.c.Invalid_Column_Name;break;case C.M$.TextAnalysisUnexpectedLLMResult:n=i.W.Unable_To_Complete_Task,a=r.c.Invalid_Text_Analysis_Response;break;case C.M$.BlockedByRAI:n=i.W.Responsible_AI_Filter_Blocked_Response,a=r.c.RAI_Validation_Failed;break;case C.M$.SymbolicLogicException:n=i.W.Unable_To_Complete_Task,a=r.c.Failed_During_Prompt_Construction_Or_Postprocessing;break;case C.M$.AskForClarification:n=i.W.User_Input_Could_Not_Be_Processed,a=r.c.LLM_Thinks_Ambiguous;break;case C.M$.UnsupportedLanguage:n=i.W.Missing_Copilot_Functionality,a=r.c.Analyze_Data_Text_Analysis_Unsupported_Language;break;case C.M$.ContentTooLarge:case C.M$.UnsupportedTextAnalysisType:case C.M$.MissingFunctionality:n=i.W.Missing_Copilot_Functionality,a=r.c.Features_In_Development;break;case C.M$.VisualConversionError:n=i.W.Missing_Copilot_Functionality,a=r.c.Insights_Visual_Converter_Unsupported;break;case C.M$.UnsupportedExecution:n=i.W.Missing_Copilot_Functionality,a=r.c.AE_Execution_Unsupported;break;case C.M$.UnanswerableQuery:n=i.W.Missing_Copilot_Functionality,a=r.c.LLM_Identifies_UnanswerableQuery;break;default:n=t?i.W.Missing_Copilot_Functionality:i.W.Unable_To_Complete_Task,a=t?r.c.Failed_Insight_Generation_Due_To_Out_Of_Scope_Error:r.c.Failed_Insight_Generation_Due_To_Other_Error}k.M.getInstance().logStandardizedAshaErrorEvent(n,a,b.BJ.AnalyzeData)},ut=e=>{if(!e)return!1;switch(e){case C.M$.ContentTooLarge:case C.M$.MissingFunctionality:case C.M$.VisualConversionError:case C.M$.UnsupportedLanguage:case C.M$.UnanswerableQuery:case C.M$.UnsupportedExecution:case C.M$.UnsupportedTextAnalysisType:return!0;case C.M$.AskForClarification:case C.M$.LLMThrottledError:case C.M$.LLMHttpRequestError:case C.M$.LLMTimeout:case C.M$.LLMGenericError:case C.M$.InvalidJsonFormat:case C.M$.InvalidAE:case C.M$.InvalidResponseType:case C.M$.MismatchedColumnName:case C.M$.SymbolicLogicException:case C.M$.TextAnalysisUnexpectedLLMResult:case C.M$.BlockedByRAI:return!1;default:(0,_.x)(e)}},mt=e=>{if(!(0,Q.nmB)())return!1;if(!e)return!1;switch(e){case C.M$.MissingFunctionality:case C.M$.VisualConversionError:case C.M$.UnanswerableQuery:case C.M$.UnsupportedExecution:case C.M$.InvalidJsonFormat:case C.M$.InvalidAE:case C.M$.InvalidResponseType:case C.M$.MismatchedColumnName:case C.M$.SymbolicLogicException:case C.M$.TextAnalysisUnexpectedLLMResult:return!0;case C.M$.ContentTooLarge:case C.M$.UnsupportedLanguage:case C.M$.UnsupportedTextAnalysisType:case C.M$.AskForClarification:case C.M$.LLMThrottledError:case C.M$.LLMHttpRequestError:case C.M$.LLMTimeout:case C.M$.LLMGenericError:case C.M$.BlockedByRAI:return!1;default:(0,_.x)(e)}},gt=(e,t,n)=>(a,o)=>{const r=o().selection.tabularRanges[e]??{},i=(0,N.f_)(t,r,n);a(p.m.updateTableInterpretationsForSheet({sheetId:e,newInterpretations:i}))},ht=(e,t,n)=>async a=>{const o=await a(We(n)),r=new c.y(o.sheetId),i=r.getTranslations(o.rowIndex,o.columnIndex),l=(0,q.gT)(i,e,t,!0,!1);await r.resolveJobs();const s=await l;return a(ke(n,s,void 0,t))},pt=(e,t,n)=>async a=>{const o=await a(We(n)),r=new c.y(o.sheetId),i=r.getTranslations(o.rowIndex,o.columnIndex),l=e.map((e=>(0,q.gT)(i,e,t,!0,!1)));await r.resolveJobs();const s=await Promise.all(l);return a(Ye(n,s,void 0,[t]))},bt=(e,t,n,a)=>async o=>{try{const{message:r,telemetry:i}=ue.n.getAnalyzeDataUserChat("Reanalyze");l.$.getInstance().displayResponse(r,i);const s=a??(0,ge.A)();k.M.userQueryGuid=s,S.B.userQueryGuid=s,o(B.m.setLatestRequestId(s)),o((0,se.eM)(b.OP.AnalyzeData));const c=await o(He(e)),d={data:{valueRows:[],formatRows:[],formatLocalRows:[],textRows:[]},contentLanguageHint:"en"};if(c)for await(const e of c){const t=ye(e);d.data.valueRows.push(...t.data.valueRows),d.data.formatRows.push(...t.data.formatRows),d.data.formatLocalRows.push(...t.data.formatLocalRows),d.data.textRows.push(...t.data.textRows)}const u=new I.g0({parentPath:["Signal","AugLoop_ExcelAnalysis_ExcelAnalysisSignal"],items:[{id:v.r.generateId(),body:{H_:{T_:"AugLoop_ExcelAnalysis_ExcelAnalysisSignal",B_:["AugLoop_Signals_Signal"]},query:t,queryId:s,context:JSON.stringify(d),config:{model:n}}}]});l.$.getInstance().submitOperation({operation:u,workflowAnnotationType:m.Yn.getTypeName()})}catch(e){(0,z.cY)("Error in submitOperation",e),await o((0,se.L4)())}},ft=e=>async t=>{try{const n=(0,a.W4k)(),{message:o,telemetry:r}=ue.n.getAnalyzeDataUserChat(n);l.$.getInstance().displayResponse(o,r),t((0,se.eM)(b.OP.InsertAnalyzeData)),await(0,P.Ms)(e),await t((0,se.L4)())}catch(e){if(await t((0,se.L4)()),k.M.getInstance().logErrorCode(o.O.InsertionFailed,e,L.S2.AnalyzeDataError,f.$b.ASHA),e instanceof OfficeExtension.Error&&e.code===OfficeExtension.ErrorCodes.accessDenied){k.M.getInstance().logStandardizedAshaErrorEvent(i.W.User_Access_Issue_For_Copilot,r.c.Failed_Insight_Insertion_Due_To_Protection_Settings,b.BJ.AnalyzeData);const{message:e,telemetry:t}=ue.n.getAnalyzeDataErrorResponse((0,a.V7x)());l.$.getInstance().displayResponse(e,t)}else if(e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.invalidOperationInCellEditMode){k.M.getInstance().logStandardizedAshaErrorEvent(i.W.User_Access_Issue_For_Copilot,r.c.Failed_Insight_Insertion_Due_To_User_Edits,b.BJ.AnalyzeData);const{message:e,telemetry:t}=ue.n.getAnalyzeDataErrorResponse((0,a.WJg)());l.$.getInstance().displayResponse(e,t)}else{k.M.getInstance().logStandardizedAshaErrorEvent(i.W.Unable_To_Complete_Task,r.c.Failed_Insight_Insertion,b.BJ.AnalyzeData);const{message:e,telemetry:t}=ue.n.getAnalyzeDataErrorResponse((0,a.OSb)());l.$.getInstance().displayResponse(e,t)}}}},805020:(e,t,n)=>{"use strict";n.d(t,{F:()=>u,m:()=>d});var a=n(713441),o=n(624654),r=n(644476),i=n(241273),l=n(9361);const s={tokenState:"NotStarted",doesFluxTurnRequireUndo:!1,augloopModelWorkflowUnsupported:!1,userType:i.ut.Unknown,clientInfo:(0,l.z)(),localeInfo:(0,o.FZ)(),copilotState:void 0},c=(0,r.Z0)({name:"app",initialState:s,reducers:{loadAuth(e){e.tokenState="Loaded"},fetchTokenSuccess(e){e.tokenState="Cached"},fetchTokenFailed(e){e.tokenState="Error"},setDoesFluxTurnRequireUndo:e=>{e.doesFluxTurnRequireUndo=!0},resetDoesFluxTurnRequireUndo:e=>{e.doesFluxTurnRequireUndo=!1},setLocaleInfo:(e,t)=>{e.localeInfo=t.payload.localeInfo},setUserType:(e,t)=>{e.userType=t.payload},setAugloopModelWorkflowUnsupported:e=>{e.augloopModelWorkflowUnsupported=!0},setClientInfo:(e,t)=>{e.clientInfo={...t.payload,hostWindowObject:void 0}},setCopilotState:(e,t)=>{e.copilotState!==a.$.Enabled&&(e.copilotState=t.payload)}}}),{actions:d,reducer:u}=c},808943:(e,t,n)=>{"use strict";n.d(t,{LA:()=>r,gc:()=>l,j0:()=>m,j3:()=>c,jc:()=>u,pX:()=>o,u$:()=>s});let a=!1;function o(){return a}function r(e){a=e}let i=!1;function l(){return i}function s(e){i=e}function c(e){e&&(i=e.webGroundingEnabled,a=e.enterpriseGroundingEnabled)}let d={onRefreshButtonClicked:()=>{},suggestionList:[],showRefreshButton:!1};function u(){return d}function m(e){d=e}},810980:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.URL=t.DNS=void 0;const a=n(886492),o=n(463323);var r=n(463323);function i(e,t,n,r){return(0,o.default)(80,a.default,e,t,n,r)}Object.defineProperty(t,"DNS",{enumerable:!0,get:function(){return r.DNS}}),Object.defineProperty(t,"URL",{enumerable:!0,get:function(){return r.URL}}),i.DNS=o.DNS,i.URL=o.URL,t.default=i},813392:(e,t,n)=>{"use strict";n.d(t,{l:()=>c});var a=n(241273),o=n(660606),r=n(208520),i=n(382316),l=n(423905),s=n(83437),c=function(e){var t,n=e.clientInfoRef,c=e.theme,d=e.locale,u=e.clientId,m=e.redirectUri,g=e.isWebPlatform,h=r.useRef(void 0),p=function(){t&&t.close(),t=void 0},b=r.useCallback((function(e){h.current=e;var r=window.location.href.replace("taskpane.html","CloudFilePickerDialog.html"),b=c===i.G.defaultBlack,f=function(e){var r,i,c,f,C,y,v=JSON.parse(e);switch(v.type){case a.zg.Ack:var T={userPrincipalName:null!==(c=null===(i=n.current)||void 0===i?void 0:i.userPrincipalName)&&void 0!==c?c:"",clientId:u,redirectUri:m,locale:d,isDarkMode:b};o.EG.sendChatEventTelemetry((0,l.pN)(((r={})[s.h3.ChatEventType]=s.a5.CloudFilesDialogOpened,r))),t&&t.messageChild(JSON.stringify(T),{targetOrigin:"*"});break;case a.zg.CloseEvent:p(),g?setTimeout((function(){var e;null===(e=h.current)||void 0===e||e.closeCiqCallback()}),700):null===(f=h.current)||void 0===f||f.closeCiqCallback();break;case a.zg.OnItemSelected:p();var x=v.files;g?setTimeout((function(){var e;null===(e=h.current)||void 0===e||e.onItemSelected(x)}),700):null===(C=h.current)||void 0===C||C.onItemSelected(x);break;case a.zg.OnErrorInLoading:p(),g?setTimeout((function(){var e;null===(e=h.current)||void 0===e||e.onErrorInLoading()}),700):null===(y=h.current)||void 0===y||y.onErrorInLoading()}};g?Office.context.ui.displayDialogAsync(r,{displayInIframe:!0,hideTitle:!0,height:65,width:60},(function(e){null==(t=e.value)||t.addEventHandler(Office.EventType.DialogMessageReceived,(function(e){var t;f(null!==(t=null==e?void 0:e.message)&&void 0!==t?t:"")}))})):OfficeFirstPartyDialog.displayWebDialog(r,{displayInIframe:!0,dialogTitle:"",hideTitle:!0,height:65,width:60,onMessage:f,onClose:function(){var e;null===(e=h.current)||void 0===e||e.closeCiqCallback()}}).then((function(e){t=e}))}),[n,c,h]);return{onAttachCloudFiles:b}}},817990:(e,t,n)=>{"use strict";n.d(t,{f:()=>p});var a=n(660606),o=n(423905),r=n(83437),i=n(883),l=n(426689),s=n(480591),c=n(789065),d=n(425903),u=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{s(a.next(e))}catch(e){r(e)}}function l(e){try{s(a.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((a=a.apply(e,t||[])).next())}))},m=function(e,t){var n,a,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(n=1,a&&(o=2&l[0]?a.return:l[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,l[1])).done)return o;switch(a=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,a=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],a=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},g=function(e){return u(void 0,void 0,void 0,(function(){var t,n,a,o;return m(this,(function(r){return!(t=null===(o=e.localEndpoint)||void 0===o?void 0:o.split("/"))||t.length<3?(n="Invalid localEndpoint format received during local addin execution",(0,d.Xh)(n),[2,{result:n,isSuccess:!1}]):(a=t[2],[2,h(e.payload,a)])}))}))},h=function(e,t){return u(void 0,void 0,void 0,(function(){var n,l,s,u,g,h,p,b,f,C;return m(this,(function(m){switch(m.label){case 0:try{s=(0,c.w)(e),n=s.method,l=s.params}catch(e){return p=e.message,(0,d.Xh)(p),[2,{result:p,isSuccess:!1}]}(null==l?void 0:l["x-metadata"])&&delete l["x-metadata"],u=JSON.stringify(l),a.EG.sendChatEventTelemetry((0,o.pN)(((b={})[r.h3.ChatEventType]=r.a5.LocalAddinExecutionStarted,b[r.h3.ChatEventParameters]=JSON.stringify({titleId:t,methodName:n,stringifiedParams:u}),b))),m.label=1;case 1:return m.trys.push([1,3,,4]),[4,OfficeFirstParty.AddinSkillAction.InvokeAction(t,n,u)];case 2:return g=m.sent(),a.EG.sendChatEventTelemetry((0,o.pN)(((f={})[r.h3.ChatEventType]=r.a5.LocalAddinExecutionCompletedFromHost,f[r.h3.ChatEventParameters]=g,f))),(0,a.cY)("Successfully invoked local add-in plugin action",g),[2,{result:null!=g?g:"",isSuccess:!0}];case 3:return h=m.sent(),p="Failed to invoke local add-in plugin action. Error code is: \n"+(null==h?void 0:h.code)+"\nwith error message: \n"+(null==h?void 0:h.message),(0,i.debuglog)(p),a.EG.sendChatEventTelemetry((0,o.pN)(((C={})[r.h3.ChatEventType]=r.a5.LocalAddinExecutionFailedFromHost,C[r.h3.ChatEventParameters]=p,C))),(0,d.Xh)(p),[2,{result:p,isSuccess:!1}];case 4:return[2]}}))}))},p=function(e,t,n,c){return u(void 0,void 0,void 0,(function(){var u,h,p,b,f,C,y,v,T,x,S,w,E,I,R,A,L,k;return m(this,(function(m){switch(m.label){case 0:return[4,null==t?void 0:t()];case 1:m.sent(),u=[],h=!0,p=null!==s.jX&&void 0!==s.jX?s.jX:0,m.label=2;case 2:return m.trys.push([2,16,,19]),e.skillRequest?((0,o.pN)(((R={})[r.h3.ChatEventType]=r.a5.LocalAddinExecutionReceivedSingleRequest,R)),[4,g(e.skillRequest)]):[3,4];case 3:return b=m.sent(),T=b.result,x=b.isSuccess,u=[(0,d.SL)(T)],h=x,[3,12];case 4:if(!(e.skillRequests&&e.skillRequests.length>0))return[3,9];(0,o.pN)(((A={})[r.h3.ChatEventType]=r.a5.LocalAddinExecutionReceivedMultipleRequests,A)),f=0,C=e.skillRequests,m.label=5;case 5:return f<C.length?(y=C[f],[4,g(y)]):[3,8];case 6:if(v=m.sent(),T=v.result,x=v.isSuccess,u.push((0,d.SL)(T)),!x)return h=!1,[3,8];m.label=7;case 7:return f++,[3,5];case 8:return[3,12];case 9:return E="No skillRequest or skillRequests provided for local addin execution",(0,d.Xh)(E),[4,null==n?void 0:n()];case 10:return m.sent(),[4,(0,d.q1)(c)];case 11:return m.sent(),S={result:[(0,d.SL)(E)]},e.callback(S),[2];case 12:return[4,null==n?void 0:n()];case 13:return m.sent(),h?[3,15]:[4,(0,d.q1)(c)];case 14:m.sent(),m.label=15;case 15:return(0,a.cY)("Results from TriggerPlugin messages:",u),I={result:u},e.callback(I),a.EG.sendLatencyTelemetry((0,o.pN)(((L={})[r.CT.FeatureName]=r.CC.Extensibility,L[r.CT.SubFeatureName]=r.Ff.AddInActionsForAgents,L[r.CT.UserPerceivedLatency]=(0,l.x)(p),L[r.CT.IsQuerySuccess]=h,L)),!0),[3,19];case 16:return w=m.sent(),E="Unexpected error during local addin execution: ".concat(null==w?void 0:w.message),(0,i.debuglog)(E),[4,null==n?void 0:n()];case 17:return m.sent(),[4,(0,d.q1)(c)];case 18:return m.sent(),(0,d.Xh)(E),a.EG.sendLatencyTelemetry((0,o.pN)(((k={})[r.CT.FeatureName]=r.CC.Extensibility,k[r.CT.SubFeatureName]=r.Ff.AddInActionsForAgents,k[r.CT.UserPerceivedLatency]=(0,l.x)(p),k[r.CT.IsQuerySuccess]=!1,k[r.CT.ErrorChatEventType]=r.S2.LocalAddinActionExecution,k[r.CT.ErrorChatEventParameter]=E,k)),!0),I={result:[(0,d.SL)(E)]},e.callback(I),[3,19];case 19:return[2]}}))}))}},818067:(e,t,n)=>{"use strict";n.d(t,{B:()=>l});var a=n(241273),o=n(660606),r=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{s(a.next(e))}catch(e){r(e)}}function l(e){try{s(a.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((a=a.apply(e,t||[])).next())}))},i=function(e,t){var n,a,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(n=1,a&&(o=2&l[0]?a.return:l[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,l[1])).done)return o;switch(a=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,a=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],a=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},l=function(){function e(){this.apiHandlers=new Map}return e.getInstance=function(){return e.PrivateApi||(e.PrivateApi=new e),e.PrivateApi},e.prototype.initializePrivateApi=function(){return r(this,arguments,void 0,(function(e){var t,n=this;return void 0===e&&(e=0),i(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,OfficeFirstParty.PrivateApi.onPrivateEvent((function(t){return r(n,void 0,void 0,(function(){var n,a,r;return i(this,(function(i){switch(i.label){case 0:return(0,o.cY)("PrivateApi event: "+t),e>0?[4,new Promise((function(t){return setTimeout(t,e)}))]:[3,2];case 1:i.sent(),i.label=2;case 2:n=!1;try{a=JSON.parse(t)}catch(e){a=null}return(null==a?void 0:a.eventName)&&(r=this.apiHandlers.get(a.eventName))&&r instanceof Function&&(r(a),n=!0),n||(0,o.cY)("Could not dispatch PrivateApi event"),[2]}}))}))}))];case 1:return a.sent(),[3,3];case 2:return t=a.sent(),(0,o.cY)("Error initializing PrivateApi: "+t),[3,3];case 3:return[2]}}))}))},e.prototype.openMOSDialog=function(){return r(this,void 0,void 0,(function(){var e;return i(this,(function(t){switch(t.label){case 0:return e={dispidMethod:a.T7.LaunchMos},[4,this.execute(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.getFullDocumentHtml=function(){return r(this,void 0,void 0,(function(){var e;return i(this,(function(t){return e={dispidMethod:a.T7.GetFullDocumentHtml},[2,this.execute(e)]}))}))},e.prototype.execute=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){return[2,OfficeFirstParty.PrivateApi.execute(JSON.stringify(e))]}))}))},e.prototype.triggerReadAloud=function(){return r(this,void 0,void 0,(function(){var e;return i(this,(function(t){return e={dispidMethod:a.T7.ReadAloud},[2,this.execute(e)]}))}))},e.prototype.attachPrivateEventHandler=function(e,t){this.apiHandlers.has(e)&&(0,o.cY)("Overwriting PrivateApi event handler for "+e),this.apiHandlers.set(e,t)},e}()},819415:(e,t,n)=>{"use strict";n.d(t,{RJ:()=>c,r1:()=>h,u$:()=>m,u0:()=>d,w0:()=>g});var a=n(616166),o=n(83437),r=n(380473),i=n(75496),l=n(316904);const s={isLoaded:!1,deferredFlights:null,sessionId:null,buildNumber:[0,0]};function c(){if(!s.isLoaded){const e=new Error("Attempted to access deferred flights before they were set");throw l.M.getInstance().logErrorCode(a.O.FetchUnsetFlight,e,i.S2.Error,o.$b.Warning),e}return s.deferredFlights}function d(){if(!s.isLoaded){const e=new Error("Attempted to access flighting session id before they were set");throw l.M.getInstance().logErrorCode(a.O.FetchUnsetFlight,e,i.S2.Error,o.$b.Warning),e}return s.sessionId}let u=!1;const m=new r.d((async()=>{await async function(){if(!u)try{Office.context.platform===Office.PlatformType.OfficeOnline?u=!0:await Excel.run((async e=>{const t=e.flighting.getDeferredFlights(),n=e.flighting.getClientSessionId();await e.sync(),s.deferredFlights=t.value,s.sessionId=n.value;try{const e=Office.context.diagnostics.version.split(".").map((e=>parseInt(e,10))),t=Office.context.platform===Office.PlatformType.Mac?-1:0;e.length>=2-t&&(s.buildNumber=e.slice(-2+t,e.length+t)),u=!0}catch(e){l.M.getInstance().logErrorCode(a.O.FailedToParseClientVersion,e,i.S2.Error,o.$b.Warning),s.buildNumber=[0,0]}})),l.M.getInstance().logFlightingSuccess(),s.isLoaded=!0}catch(e){l.M.getInstance().logErrorCode(a.O.FlightingFailure,e,i.S2.Error,o.$b.Warning),s.isLoaded=!0}}()}));function g(e,t=!1){const n=e.map((e=>{const[t,n]=e.split(":"),[a,o]=n.split(".");return{platform:Office.PlatformType[t],majorOrDefaultValue:a,minorOrUndefined:o}})).find((e=>e.platform===Office.context.platform));if(!n)return t;try{if("true"===n.majorOrDefaultValue||"false"===n.majorOrDefaultValue)return"true"===n.majorOrDefaultValue;const e=Number.parseInt(n.majorOrDefaultValue,10),t=n.minorOrUndefined?Number.parseInt(n.minorOrUndefined,10):0,[r,c]=function(){if(!s.isLoaded){const e=new Error("Attempted to access build number before it was set");throw l.M.getInstance().logErrorCode(a.O.FetchUnsetFlight,e,i.S2.Error,o.$b.Warning),e}return s.buildNumber}();return r>e||e===r&&c>=t}catch(e){return!1}}const h=()=>g(["PC:17231","Mac:81.114","iOS:81.24010823","OfficeOnline:true"])},821845:(e,t,n)=>{"use strict";n.d(t,{i:()=>i,z:()=>r});var a=n(347145);const o={isPythonMode:!1};function r(e){o.isPythonMode=e}function i(){return(0,a.yw9)("OfficeVSO_10340818_Add_ModelessAAFeatureGateCheck")?!o.isPythonMode&&(0,a.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.ModelessPythonAAFallback",!1):!o.isPythonMode}},822606:(e,t,n)=>{"use strict";n.d(t,{$9:()=>d,Bx:()=>l,D0:()=>F,H9:()=>R,IQ:()=>s,KA:()=>I,MH:()=>S,Ng:()=>E,O1:()=>y,Rk:()=>i,Sh:()=>m,TZ:()=>C,VQ:()=>T,W2:()=>x,Xt:()=>a,aE:()=>v,bX:()=>h,f4:()=>f,hf:()=>b,kB:()=>L,oM:()=>A,pS:()=>p,ps:()=>k,qA:()=>u,qO:()=>c,s_:()=>w,u1:()=>r,w3:()=>g});var a,o=n(638753),r="",i=2e3,l="CopilotAgentsPage",s=function(){return"I wasn't able to apply a sensitivity label to this file. Please choose another file or try again."};!function(e){e.AtMention="AtMention",e.SwitcherMenu="SwitcherMenu",e.FooterButton="FooterButton"}(a||(a={}));var c=3e4,d="Copilot Extensions Dialog",u="3068386c-7a16-4f6a-a664-043b6b232816",m=function(){return(0,o.Cs)()?OfficeaicopilotStrings.ApplyLabelUnsupportedCrossTenantError:"I can't complete this request because this content requires a sensitivity label that can only be applied within the organization where the file is stored."},g=function(){return(0,o.Cs)()?OfficeaicopilotStrings.ApplyLabelDocumentReadOnlyError:"I can't complete this request because this content requires a sensitivity label that can’t be applied when a file is read-only."},h=function(){return(0,o.Cs)()?OfficeaicopilotStrings.ApplyLabelInsufficientPermissionError:"I can't complete this request because this content requires a sensitivity label that can only be applied by users who have permission to change the label on this file."},p=function(){return(0,o.Cs)()?OfficeaicopilotStrings.ApplyLabelLabelDisabledError:"I can't complete this request because this content requires a sensitivity label that is not available for your account."},b=function(){return(0,o.Cs)()?OfficeaicopilotStrings.ApplyLabelUnsupportedUdpError:"I can't complete this request because this content requires a sensitivity label with user-defined permissions."},f=function(){return(0,o.Cs)()?OfficeaicopilotStrings.ApplyLabelLabelingDisabledError:"I can't complete this request because this content requires a sensitivity label that is not available for your account."},C=function(){return(0,o.Cs)()?OfficeaicopilotStrings.ApplyLabelUnsupportedContentTypeError:"I can't complete this request because this content requires a sensitivity label, and this type of file doesn't support sensitivity labels."},y=function(){return(0,o.Cs)()?OfficeaicopilotStrings.ApplyLabelUnsupportedDkeError:"I can't complete this request because this content is protected with Double Key Encryption."},v=function(){return(0,o.Cs)()?OfficeaicopilotStrings.ApplyLabelLabelNotFoundError:"I can't complete this request because this content requires a sensitivity label that cannot be applied to this file."},T=function(){return(0,o.Cs)()?OfficeaicopilotStrings.OsfControlContainerError:"I can't complete this request because there was a problem applying a sensitivity label."},x=function(){return(0,o.Cs)()?OfficeaicopilotStrings.OMWorkflowUserNotFoundError:"I can't complete this request because there was a problem applying a sensitivity label."},S=function(){return(0,o.Cs)()?OfficeaicopilotStrings.OMOfficePerpetualNotSupportedError:"I can't complete this request because this content requires a sensitivity label, and this version of Microsoft 365 doesn't support sensitivity labels."},w=function(){return(0,o.Cs)()?OfficeaicopilotStrings.LabelingDisabledProtectedViewError:"I can't complete this request because this file is in Protected View."},E=function(){return(0,o.Cs)()?OfficeaicopilotStrings.LabelingDisabledAppguardError:"I can't complete this request because this file is open in Application Guard."},I=function(){return(0,o.Cs)()?OfficeaicopilotStrings.LabelingDisabledPrivacySettingsError:"I can't complete this request because your privacy settings prevent access to content that has a sensitivity label."},R=function(){return(0,o.Cs)()?OfficeaicopilotStrings.LabelingDisabledUnsupportedLabelClientError:"I can't complete this request because this content requires a sensitivity label, and this version of Microsoft 365 doesn't support sensitivity labels."},A=function(){return(0,o.Cs)()?OfficeaicopilotStrings.LabelingDisabledNoSignedInClpCompatibleUsersError:"I can't complete this request because this content requires a sensitivity label, but sensitivity labeling is not turned on for your account."},L=function(){return(0,o.Cs)()?OfficeaicopilotStrings.OMOfficeClientNotLicensedForLabelingError:"I can't complete this request because this content requires a sensitivity label, but sensitivity labeling is not turned on for your account."},k="https://go.microsoft.com/fwlink/?linkid=2271054",F="div[data-testid='MsgExtCardPreview']"},823465:(e,t,n)=>{"use strict";n.d(t,{O9:()=>m,OP:()=>h,Or:()=>d,mN:()=>c,xY:()=>u});var a=n(639765),o=n(548366),r=n(605424),i=n(255507),l=n(316904),s=n(857677);function c(){i.B.getInstance().logSeenEvent(s.q.Else)}function d(e){e.endTriedActivityFailure(s.q.Else)}function u(e,t){g(e)&&(e.chatResponseCode===r.Ay.OK?t.endTriedActivitySuccess(s.q.Else):d(t))}function m(e){return g(e)&&e.elseSkillStarted}function g(e){return e?.type===r.VF.ElseResponseMeta}function h(e){if(!g(e))return;const t=e.chatResponseCode;if(void 0!==t&&t!==r.Ay.OK)switch(t){case r.Ay.ServiceTimeout:return void n(o.W.Response_Delayed_Or_Timed_Out,a.c.Else_Service_Timed_Out);case r.Ay.RAICheckFailed:return void n(o.W.Responsible_AI_Filter_Blocked_Response,a.c.RAI_Validation_Failed);case r.Ay.FormulaError:return void n(o.W.Unable_To_Complete_Task,a.c.Else_Response_Blocked_Bad_Formula);case r.Ay.SearchAndActionNotAllowed:return void n(o.W.Unable_To_Complete_Task,a.c.Else_Response_Blocked_Unsupported_Chaining);case r.Ay.SecurityBlockedFormulaError:return void n(o.W.Unable_To_Complete_Task,a.c.Else_Response_Blocked_Security_Restricted_Formula);case r.Ay.ExternalWorkbookFormulaError:return void n(o.W.Unable_To_Complete_Task,a.c.Else_Response_Blocked_External_Workbook_Reference_Formula);case r.Ay.ServiceError:default:return void n(o.W.LLM_Service_Side_Issue_Prevents_Output,a.c.Else_Service_Error)}function n(e,t){l.M.getInstance().logStandardizedAshaErrorEvent(e,t,s.BJ.ExcelChatHelper)}}},823860:(e,t,n)=>{"use strict";var a,o;n.d(t,{O:()=>a,f:()=>o}),function(e){e.MissingIntent="MissingIntent",e.NoIntentNeeded="NoIntentNeeded",e.UnhandledIntent="Missing intent string"}(a||(a={})),function(e){e.Never="Never"}(o||(o={}))},824815:(e,t,n)=>{"use strict";e.exports=n.p+"assets/information-icon.svg"},838446:(e,t,n)=>{"use strict";n.d(t,{I:()=>i});var a=n(639765),o=n(548366),r=n(316904);function i(e,t){const n=o.W.LLM_Service_Side_Issue_Prevents_Output,i=a.c.Disengaged_Error;r.M.getInstance().logStandardizedAshaErrorEvent(n,i,t)}},851295:(e,t,n)=>{"use strict";n.d(t,{C6:()=>f,XX:()=>y,gl:()=>p,xt:()=>C});var a=n(197665),o=n(83437),r=n(911443),i=n(352628),l=n(75496),s=n(316904),c=n(92520),d=n(347145),u=n(279395);const m="en-US";function g(e,t){const n=document.createElement("script");n.type="text/javascript",n.src=e,(0,c.cY)("Loading Localized strings for Language: "+e);const i=new Promise(((i,d)=>{n.onload=()=>{(0,c.cY)("Loaded Localized strings for Language: "+e),i()},n.onerror=n.onabort=()=>{const n=(0,a.Yd)();s.M.getInstance().logError({eventType:l.S2.Localization,errorMessage:"Failed to load script url = "+e.split("/")?.pop()+" with mapped language = "+t+" and display language = "+n,logLevel:o.$b.Warning}),d(new r.DY(r._s.FailedToLoadStrings,"Failed to load strings with mapped language = "+t+" and display language = "+n))}}));return document.head.appendChild(n),i}let h="";function p(){return h}let b="";function f(){return h!==b}function C(){return i.b_.includes(h)}async function y(){const e=(0,a.Yd)();(0,c.cY)("Display Language Detected: "+e);const t=new r.dD;t.IsTier2LanguageSupportEnabled=(0,d.vK$)(),t.IsTier2RTLLanguageEnabled=(0,d.vCb)(),t.IsTier2Point5LanguagesEnabled=(0,d.GpD)(),t.IsTier3LanguagesEnabled=(0,d.oVT)(),t.IsTier4LanguagesEnabled=(0,d.J_)(),h=t.getUserLanguage(e),b=function(e,t){return-1===t.indexOf(e)?m:e}(e,i.$9),(0,u.N1d)(i.$n.includes(h),i.$n.includes(b));const n="office-online-strings/"+h.toLowerCase()+"/officeaicopilot-strings.min.js",o="excel-copilot-strings",l=o+"/"+h.toLowerCase()+"/excel-copilot-strings.js",s=o+"/"+b.toLowerCase()+"/excel-copilot-strings-n-tier.js",p=o+"/"+h.toLowerCase()+"/excel-copilot-commanding-hitl-strings.js";try{return(0,d.k64)()?Promise.all([g(l,h),g(n,h),g(s,b),g(p,h)]):Promise.all([g(l,h),g(n,h),g(s,b)])}catch(e){const t=(0,a.Yd)();throw new r.DY(r._s.FailedToLoadStrings,"Failed to load strings with mapped language = "+h+", unclassified Tier Language = "+b+" and display language = "+t)}}},851452:(e,t,n)=>{"use strict";n.d(t,{b7:()=>S,ge:()=>w,iT:()=>I});var a=n(124445),o=n(86940),r=n(708353),i=n(293879),l=n(178365),s=n(75496),c=n(531093),d=n(279395),u=n(857677),m=n(83437),g=n(316904),h=n(109174),p=n(306148),b=n(158058),f=n(972424),C=n(464077),y=n(347145),v=n(507628),T=n(92520);const x=1e3;function S(){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Human,messageHeader:{text:(0,d.FA0)()}}}},telemetry:{featureName:u.q.ContextInference,eventType:u.a5.HumanInput}}}async function w(e,t){const n=(0,b.kw)(t),a=(await Promise.all(n.map((async e=>await(0,b.xl)(e))))).filter((e=>!!e.header&&!!e.description));0===a.length&&g.M.getInstance().logError({eventType:s.S2.AutoFixTLR,errorMessage:"Missing data for AutoFixMarkdownResponse",logLevel:m.$b.Warning},void 0,[{key:s.Wg.Source,value:JSON.stringify(n)}]);return function(e,t,n,a,l){const s=(0,v.A)(),d=e.map((e=>`- **${e.header}**: ${e.description}`)).join("\n");let u=l;return u&&c.ExcelCalc.isSheetAddress(l)||(u=h.CP.getActiveTable()?.address||u),h.CP.setHumanInTheLoopRange((0,f.r)(u)),{chatCardType:o._.MarkdownCard,chatMessageData:{markDownCardProps:{message:`${t}\n\n${d}\n\n${n}`,user:i.Q9.Chat}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:"Copilot\\Context Inference"},shouldShowFeedbackSection:!0,messageId:s,actionButtonList:(0,p.Oy)([(0,p.J3)(a,u)],s)},addCardToChatHistory:!0}}(a,(1===a.length?(0,d.$TB)():(0,d.S7l)()).replace("{range}",(0,C.G2)(e)),(0,d.VH3)(),t,e)}function E(e,t){const n=(0,b.kw)(e);switch(t){case a.Xs.Success:return function(e){const t=(0,v.A)();return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:"Copilot\\Context Inference"},shouldShowFeedbackSection:!0,messageId:t,actionButtonList:(0,p.Oy)([(0,p.FW)(u.q.ContextInference)],t)},addCardToChatHistory:!0},telemetry:{featureName:u.q.ContextInference,eventType:u.a5.ActionConfirmationMessage}}}((0,b.TF)(n));case a.Xs.Unsuccessful:return function(e){const t=(0,v.A)();return{message:{chatCardType:o._.MarkdownCard,chatMessageData:{markDownCardProps:{user:i.Q9.Chat,message:e}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:"Copilot\\Context Inference"},shouldShowFeedbackSection:!0,messageId:t,actionButtonList:(0,y.jHv)()?[(0,p.yo)(t)]:void 0},addCardToChatHistory:!0},telemetry:{featureName:u.q.ContextInference,eventType:u.a5.TabularRangeAutoFixFailed,errorType:u.q0.TlrAutofixError}}}((0,b.ie)(n));case a.Xs.NoChangeMade:default:return function(){const e=(0,v.A)();return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:(0,d.GRk)()}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:"Copilot\\Context Inference"},shouldShowFeedbackSection:!0,messageId:e,actionButtonList:(0,y.jHv)()?[(0,p.yo)(e)]:void 0},addCardToChatHistory:!0},telemetry:{featureName:u.q.ContextInference,eventType:u.a5.TabularRangeNoAutoFixApplied}}}()}}async function I(e,t){await h.CP.runWithContextRefreshAndLoader((async()=>{const n=performance.now(),o=await(0,a.Be)(t),r=performance.now()-n,i=x-r;i>0&&await(0,T.uk)(i);const{message:s,telemetry:c}=E(e,o);l.$.getInstance().displayResponse(s,c),h.CP.setHumanInTheLoopRange(void 0)}),u.OP.ApplyTLRAutoFix)}},855539:(e,t,n)=>{"use strict";n.d(t,{F:()=>C,m:()=>f});var a=n(178365),o=n(648982),r=n(446751),i=n(644476),l=n(298925),s=n(857677),c=n(76872),d=n(316904),u=n(667977),m=n(92520),g=n(347145),h=n(795786);const p={recommendations:{},fetchRecommendationsState:{},tableName:{},isVisible:{},previewId:null,activeRequestId:null,currentShownSuggestionIndex:{},hasShownSuggestionPrompt:{},rawPreview:{},visibleRowPreviewValues:{},currentTotalRowValues:{},invalidatedSuggestions:[],shouldShowFormulaDevButton:!1},b=(0,i.Z0)({name:"dataAI",initialState:p,reducers:{startFetching:(e,t)=>{e.recommendations[t.payload]=[],e.fetchRecommendationsState[t.payload]="inProgress",e.isVisible[t.payload]=!1,e.activeRequestId=t.payload,e.currentShownSuggestionIndex[t.payload]=0},fetchRecommendationsSucceeded:(e,t)=>{const{requestId:n,recommendation:o}=t.payload;o.forEach((t=>{const o=e.recommendations[n],i=o.findIndex((e=>e.id===t.id)),u=t.calculatedFormulas.length,m=t.id;function g(e,t){c.E.getInstance().updateTelemetryChatEventData({[s.h3.ChatEventType]:e,[s.h3.ChatEventParameters]:JSON.stringify({time:performance.now(),requestId:n,suggestionId:m,calculatedFormulaLength:u,formulaIndex:t})},d.M.getInstance())}function p(e,t,n){return n[e]&&n[e]!==t[e]}if(-1===i)o.push(t),g(s.a5.CalculatedFormulaGetFormula);else{let c=!1,d=!1;if(t.calculatedFormulas.forEach((e=>{const t=o[i];if(t.preview&&(d=!0),t.calculatedFormulas){const n=t.calculatedFormulas.findIndex((t=>t.id===e.id));-1!==n&&((void 0===t.calculatedFormulas[n].description&&void 0!==e.description||void 0===t.calculatedFormulas[n].formulaExplanation&&void 0!==e.formulaExplanation)&&(p("description",t.calculatedFormulas[n],e)&&g(s.a5.CalculatedFormulaGetDescription,n),p("formulaExplanation",t.calculatedFormulas[n],e)&&g(s.a5.CalculatedFormulaGetExplanation,n),t.calculatedFormulas[n]=e),c=Boolean(e.description))}})),e.currentShownSuggestionIndex[n]>=i&&(c||d||(0,r.be)(t))){const{message:e,telemetry:t}=h.n.getFormulaSuggestionResponse(n,i,(0,l.ss)(o));setTimeout((()=>{a.$.getInstance().displayResponse(e,t,{replaceExistingMessage:!0})}))}}})),e.fetchRecommendationsState[n]="succeeded"},fetchRecommendationsFailed:(e,t)=>{e.fetchRecommendationsState[t.payload]="failed"},startPreviewing:(e,t)=>{e.previewId=t.payload},stopPreviewing:e=>{e.previewId=null},updateTableName:(e,t)=>{e.tableName[t.payload.requestId]=t.payload.table},updateFormulaRecommendationPreview:(e,t)=>{const{requestId:n,suggestionId:o,preview:i,visibleRowsPreviewValues:s,tableValues:c,rowCount:d,visibleRows:p}=t.payload,b=e.recommendations[n],f=b.find((e=>e.id===o));if(f){if("Failed"===i||"previewDisabled"===i)f.preview=i;else{const{previewValues:e,rowNumber:t,letters:n}=i;(0,r.iM)(f)?f.preview=(0,u.BG)(t,n,f.calculatedFormulas.map((e=>e.columnName)),e,s,p):(0,r.cY)(f)&&(f.preview=(0,u.LS)(t,n,e,c,d))}(0,m.cY)("updateFormulaRecommendationPreview",f.preview,f.calculatedFormulas.map((e=>e.description)));const t=b.findIndex((e=>e===f)),o=e.currentShownSuggestionIndex[n]===t;if((0,g.pRQ)()&&o){const{message:e,telemetry:o}=h.n.getFormulaSuggestionResponse(n,t,(0,l.ss)(b));setTimeout((()=>{(0,m.cY)("updateFormulaRecommendationPreview","displayResponse",e),a.$.getInstance().displayResponse(e,o,{replaceExistingMessage:!0})}))}}},markRecommendationInserted:(e,t)=>{const{suggestionId:n,requestId:a}=t.payload,o=e.recommendations[a].findIndex((e=>e.id===n));-1!==o&&(e.recommendations[a][o].isInserted=!0)},markRecommendationAsInvalidated:(e,t)=>{const{suggestionId:n,reason:a}=t.payload;e.invalidatedSuggestions.push(n),c.E.getInstance().updateTelemetryChatEventData({[s.h3.ChatEventType]:s.a5.FormulaSuggestionInvalidated,[s.h3.ChatEventParameters]:JSON.stringify({reason:a,suggestionId:n})},d.M.getInstance())},reset:()=>p,markVisible:(e,t)=>{e.isVisible[t.payload]=!0},setCurrentShownSuggestionIndex:(e,t)=>{e.currentShownSuggestionIndex[t.payload.requestId]=t.payload.suggestionIndex},setHasShownSuggestionPrompt:(e,t)=>{e.hasShownSuggestionPrompt[t.payload]=!0},setPreviewForSuggestionID:(e,t)=>{const{preview:n,suggestionId:a,visibleRowsPreview:o}=t.payload;e.rawPreview[a]=n,e.visibleRowPreviewValues[a]=o},setCurrentRowValuesForRequestId:(e,t)=>{const{requestId:n,currentTotalRowValues:a}=t.payload;e.currentTotalRowValues[n]=a},setShouldShowFormulaDevButton:(e,t)=>{const{shouldShowFormulaDevButton:n}=t.payload;e.shouldShowFormulaDevButton=n,o.s.getInstance().setShouldShowFormulaDevButton(n)}}}),{actions:f,reducer:C}=b},856135:(e,t,n)=>{"use strict";n.d(t,{N:()=>c});var a=n(83437),o=n(324482),r=n(314793),i=n(715834),l=n(50863);function s(){return{msalDefined:void 0!==window.msal,browserAuthDefined:void 0!==window.BrowserAuth}}class c{handleError(e){"string"==typeof e&&e.indexOf("BrowserAuth")>=0&&this.loadPromise&&this.loadPromise.reject(new Error(e))}async ensureAuthLibraryLoaded(e){const t=this.providers.getCurrent();if(t.isLoaded())return;const n=new l.A("LoadAuthLibrary",[{level:a.$b.ASHA,timeout:r.R.getLoadAuthLibraryAshaTimeout()},{level:a.$b.Error,timeout:r.R.getLoadAuthLibraryAceTimeout()}]);n.sendStart({parentCallId:e});const o={numFailures:0},c=()=>(0,i.U)((()=>this.loadAuthLibraryFn(t)),(()=>!0),(()=>(o.numFailures++,!1)),5,o);try{await(0,i.Y)(c,r.R.getLoadAuthLibraryTimeout()),n.succeed({...o,parentCallId:e,debugData:s(),provider:t.getName(),...t.getLoadProps()})}catch(r){throw n.fail(a.$b.Warning,{...o,parentCallId:e,debugData:s(),provider:t.getName(),...t.getLoadProps()},r),new Error("Authorization Error")}}constructor(e){this.loadAuthLibraryFn=async e=>new Promise(((t,n)=>{const a=new o.c(t,n);e.load().then((()=>a.resolve())).catch(a.reject),this.loadPromise=a})),this.providers=e}}},857677:(e,t,n)=>{"use strict";n.d(t,{BC:()=>I,BJ:()=>L,CD:()=>ee,CT:()=>a,DD:()=>i,Dh:()=>r,EB:()=>v,IC:()=>c,Jr:()=>ne,KZ:()=>E,LP:()=>p,Mv:()=>l,OP:()=>o,P1:()=>$,Q6:()=>z,Qf:()=>q,RE:()=>Y,SV:()=>V,Sn:()=>C,W0:()=>y,Y9:()=>R,_4:()=>f,_R:()=>K,a5:()=>d,b6:()=>U,cc:()=>B,dA:()=>g,eQ:()=>Z,gY:()=>H,h3:()=>s,he:()=>S,ib:()=>m,iq:()=>b,j:()=>j,nE:()=>W,pN:()=>X,q:()=>w,q0:()=>u,qJ:()=>te,r:()=>J,rI:()=>ae,tj:()=>x,uF:()=>A,un:()=>T,xJ:()=>D,xL:()=>h,zq:()=>Q});var a,o,r,i,l,s,c,d,u,m,g,h,p,b,f,C,y,v,T,x,S,w,E,I,R,A,L,k=n(301735),F=n(83437),_=n(75496),P=n(316904),N=n(92520),M=n(347145),O=n(808943);!function(e){e.AugloopSessionGuid="AugloopSessionGuid",e.CheckPoints="CheckPoints",e.UserQueryGuid="UserQueryGuid",e.IsSuccessful="IsSuccessful",e.IsQuerySuccess="IsQuerySuccess",e.OperationName="OperationName",e.Duration="Duration",e.IsFluxEnabled="IsFluxEnabled",e.FeatureName="FeatureName",e.AugloopInitializationTime="AugloopInitializationTime",e.AnnotationActivationTime="AnnotationActivationTime",e.RequestSignalType="RequestSignalType",e.AnnotationType="AnnotationType",e.ChatHistoryLoadTime="ChatHistoryLoadTime",e.ChatPaneLoadTime="ChatPaneLoadTime",e.CopilotChatHistoryInfoJson="CopilotChatHistoryInfoJson",e.ContentOrigin="ContentOrigin",e.SDXResourcesLoadTime="SDXResourcesLoadTime",e.FirstServiceResponse="FirstServiceResponse",e.UserPerceivedLatency="UserPerceivedLatency",e.IsFromCache="IsFromCache",e.StopGeneratingTime="StopGeneratingTime",e.HandoffMessageResponseTime="HandoffMessageResponseTime",e.ContextTreeBuildTime="ContextTreeBuildTime",e.UserCopilotPaneLoadTime="UserCopilotPaneLoadTime",e.UserCopilotPaneLoadTime_PreloadTime="UserCopilotPaneLoadTime_PreloadTime",e.ExcelUserCopilotPaneLoadTime="ExcelUserCopilotPaneLoadTime",e.ExtensibilityInfo="ExtensibilityInfo"}(a||(a={})),function(e){e.AugloopInitialization="AugloopInitialization",e.AnnotationActivation="AnnotationActivation",e.ContextTreeBuild="ContextTreeBuild",e.AugloopResponse="AugloopResponse",e.QueryExecution="QueryExecution",e.ImageResponse="ImageResponse",e.AnalyzeData="AnalyzeData",e.InsertAnalyzeData="InsertAnalyzeData",e.Commanding="Commanding",e.ConditionalFormatting="ConditionalFormatting",e.CalculatedColumns="CalculatedColumns",e.CalculatedCells="CalculatedCells",e.ChatHistoryHydrateMessages="ChatHistoryHydrateMessages",e.DocumentContextCollection="DocumentContextCollection",e.ApplyDataShaping="ApplyDataShaping",e.DataShaping="DataShaping",e.EnterDataShapingMode="EnterDataShapingMode",e.ExitDataShapingMode="ExitDataShapingMode",e.InsertCalculatedColumn="InsertCalculatedColumn",e.InsertCalculatedColumns="InsertCalculatedColumns",e.InsertCalculatedCell="InsertCalculatedCell",e.InsertCalculatedCells="InsertCalculatedCells",e.UpdateCalculatedCell="UpdateCalculatedCell",e.UpdateCalculatedCells="UpdateCalculatedCells",e.InsertFormulaSuggestion="InsertFormulaSuggestion",e.InsertSampleData="InsertSampleData",e.InsertTable="InsertTable",e.InsertList="InsertList",e.ActionAI="ActionAI",e.Navigation="Navigation",e.FetchResource="FetchResource",e.OpenSdx="OpenSdx",e.ZeroQueryMessage="ZeroQueryMessage",e.FluxReasoning="FluxReasoning",e.FluxOverall="FluxOverall",e.FluxSkillCardShown="FluxSkillCardShown",e.FluxFirstStreamedToken="FluxFirstStreamedToken",e.FluxGenerateResponse="FluxGenerateResponse",e.FluxSkillStart="FluxSkillStart",e.FluxSkillEnd="FluxSkillEnd",e.LoadLocalizedStrings="LoadLocalizedStrings",e.ScheduleOfficeScriptsHiTLShown="ScheduleOfficeScriptsHiTLShown",e.SaveOfficeScripts="SaveOfficeScripts",e.CreateOfficeScripts="CreateOfficeScripts",e.Python="Python",e.PythonStartAnalysis="PythonStartAnalysis",e.PythonCellsCalculating="PythonCellsCalculating",e.PythonInsertingResultInNewSheet="PythonInsertingResultInNewSheet",e.PythonCalculatedColumn="PythonCalculatedColumn",e.InsertPythonCalculatedColumn="InsertPythonCalculatedColumn",e.ChatResponseFirstChunk="ChatResponseFirstChunk",e.ChatResponseLastChunk="ChatResponseLastChunk",e.FetchCitationFileMetadata="FetchCitationFileMetadata",e.RecognizeTable="RecognizeTable",e.Search="Search",e.UserContextAnnotationActivationTime="UserContextAnnotationActivationTime",e.ElseSkillExecuting="ElseSkillExecuting",e.ImportDataGenerateSuggestion="ImportDataGenerateSuggestion",e.ImportDataRelevancyCheck="ImportDataRelevancyCheck",e.ImportDataLoadQuery="ImportDataLoadQuery",e.NoCurrentlyExecutingCommandSet="NoCurrentlyExecutingCommandSet",e.FormulaDescriptionAvailable="FormulaDescriptionAvailable",e.FormulaExplanationAvailable="FormulaExplanationAvailable",e.FormulaPreviewAvailable="FormulaPreviewAvailable",e.FirstChunkFinalResponse="FirstChunkFinalResponse",e.LastChunkFinalResponse="LastChunkFinalResponse",e.ApplyTLRAutoFix="ApplyTLRAutoFix",e.FetchTablesRelevancy="FetchTablesRelevancy",e.XLIMWorkflowDuration="XLIMWorkflowDuration",e.SubmitToXLIMWorkflowComplete="SubmitToXLIMWorkflowComplete",e.XLIMWorkflowCompleteToAnnotationsReceived="XLIMWorkflowCompleteToAnnotationsReceived",e.CommandScratchpadValidateOfficeJsCompleted="CommandScratchpadValidateOfficeJsCompleted",e.ChartDesignRecommendationsScratchpadValidateOfficeJsCompleted="ChartDesignRecommendationsScratchpadValidateOfficeJsCompleted",e.ChartDesignRecommendationsChartScenegraphGenerationCompleted="ChartDesignRecommendationsChartScenegraphGenerationCompleted",e.ChartDesignRecommendationsResponseCardShown="ChartDesignRecommendationsResponseCardShown",e.ExpandableListExpansion="ExpandableListExpansion",e.ChartDesignRecommendations="ChartDesignRecommendations"}(o||(o={})),function(e){e.UserQueryGuid="UserQueryGuid",e.EventState="EventState",e.OperationOrder="OperationOrder",e.OperationType="OperationType",e.TimeDurationInMs="TimeDurationInMs",e.OperationParameters="OperationParameters",e.UserQueryOrder="UserQueryOrder",e.StatementNames="StatementNames",e.CurrentStatement="CurrentStatement",e.ExecutableNames="ExecutableNames",e.ExecutableAgent="ExecutableAgent",e.CFRuleType="CFRuleType",e.ColumnCFRApplied="ColumnCFRApplied",e.SortFilterColorFound="SortFilterColorFound",e.SuccessMessageNumParameters="SuccessMessageNumParameters",e.SuccessMessageFormattingParameters="SuccessMessageFormattingParameters",e.UnsupportedConditionalFormatType="UnsupportedConditionalFormatType",e.ConditionalFormatType="ConditionalFormatType",e.FormattingTypes="FormattingTypes",e.EventType="EventType",e.IsFluxEnabled="IsFluxEnabled",e.SortRangeAddress="SortRangeAddress",e.SortColumnIndex="SortColumnIndex",e.ErrorMessage="ErrorMessage"}(r||(r={})),function(e){e.ConvertSucceeded="ConvertSucceeded",e.UnsupportedStatement="UnsupportedStatement",e.VariableCacheFailed="VariableCacheFailed",e.ConverterFailed="ConverterFailed",e.ExecutorSucceeded="ExecutorSucceeded",e.ExecutorFailed="ExecutorFailed",e.ExecutorNoneExecuted="ExecutorNoneExecuted"}(i||(i={})),function(e){e.ConditionalFormatEvent="ConditionalFormatEvent",e.GetFilterOrSortColor="GetFilterOrSortColor",e.LogSuccessMessageFormattingParameters="LogSuccessMessageFormattingParameters",e.LogMissingIntentString="LogMissingIntentString",e.LogUnsupportConditionalFormatType="LogUnsupportedConditionalFormatType",e.LogStatmentInformation="LogStatementInformation",e.LogSortRangeAddress="LogSortRangeAddress"}(l||(l={})),function(e){e.UserQueryGuid="UserQueryGuid",e.ChatEventType="ChatEventType",e.ChatEventParameters="ChatEventParameters",e.UserQueryOrder="UserQueryOrder",e.IsFluxEnabled="IsFluxEnabled",e.IsTLR="IsTLR",e.IsTableContained="IsTableContained",e.isTableIntersected="IsTableIntersected",e.ChatErrorType="ChatErrorType",e.ChatErrorParameters="ChatErrorParameters",e.Cv="Cv",e.IsTable="IsTable",e.IsValidTLR="IsValidTLR",e.UnrecognizedTabularRangeError="UnsupportedTabularRangeError",e.IsChart="IsChart",e.IsPivotTable="IsPivotTable",e.TLRFeatures="TLRFeatures",e.TableLikeEntityDimensions="TableLikeEntityDimensions",e.SelectionError="SelectionError",e.DocumentContext="DocumentContext",e.Submitted="Submitted",e.ExtensibilityInfo="ExtensibilityInfo",e.IsTFCEnabled="IsTFCEnabled"}(s||(s={})),function(e){e.ErrorCategory="ErrorCategory",e.ErrorMessage="ErrorMessage",e.ExtensibilityInfo="ExtensibilityInfo"}(c||(c={})),function(e){e.ActionConfirmationMessage="Action_Confirmation_Message",e.ConversationMessage="Conversation_Message",e.EnterKeyPressed="Enter_Key_Pressed",e.ErrorMessage="Error_Message",e.HelpMessage="Help_Message",e.HumanInput="Human_Input",e.HumanSuggestionApplied="Human_Suggestion_Applied",e.StopButtonClicked="Stop_Button_Clicked",e.SubmitButtonClicked="Submit_Button_Clicked",e.UserUtteranceSubmitted="User_Utterance_Submitted",e.SuggestionPaneSuggestionClicked="SuggestionPane_Suggestion_Clicked",e.SuggestionPaneSuggestionShown="SuggestionPane_Suggestion_Shown",e.ZeroQueryMessageSuggestionClicked="ZeroQueryMessage_Suggestion_Clicked",e.SuggestionMessage="Suggestion_Message",e.QuerySubmittedToAL="Query_Submitted_To_Augloop",e.ResponseReceivedFromAL="Response_Received_From_Augloop",e.ThumbsUpButtonClicked="Thumbs_Up_Button_Clicked",e.ThumbsDownButtonClicked="Thumbs_Down_Button_Clicked",e.AugLoopSessionClosed="AugLoop_Session_Closed",e.AugLoopSessionModelWorkflowUnsupported="AugLoop_Session_Model_Workflow_Unsupported",e.HowCanCopilotHelpSuggestionClicked="How_Can_Copilot_Help_Suggestion_Clicked",e.AddAllInsightsToGridClicked="Add_All_Insights_To_Grid_Clicked",e.AnnotationActivated="Annotation_Activated",e.ChatHistorySignal="Chat_History_Signal",e.ChatHistoryResponse="Chat_History_Response",e.ShowMeAnotherInsightClicked="Show_Me_Another_Insight_Clicked",e.CalculatedColumnsSignalSent="Calculated_Columns_Signal_Sent",e.LanguageNotAvailableMessage="Language_Not_Available_Message",e.BasicChatSuggestionClicked="BasicChat_Suggestion_Clicked",e.ChatHistoryLoaded="Chat_History_Loaded",e.ChatPaneLoaded="Chat_Pane_Loaded",e.SharedCopilotChatLogEvent="Shared_Copilot_Chat_Log_Event",e.CopyButtonClicked="Copy_Button_Clicked",e.CalculatedColumnsExplainButtonClicked="Calculated_Columns_Explain_Button_Clicked",e.PythonCalculatedColumnsExplainButtonClicked="Python_Calculated_Columns_Explain_Button_Clicked",e.LargeDataErrorMessage="Large_Data_Error_Message",e.ChangeTopicButtonClicked="Change_Topic_Button_Clicked",e.SaveScriptClicked="Save_Script_Clicked",e.DeleteScriptClicked="Delete_Script_Clicked",e.OfficeScriptsLinkClicked="Office_Scripts_Link_Clicked",e.DocumentClpUpgrade="DocumentClpUpgrade",e.ClpLabelUpdateFromChatHistory="ClpLabelUpdateFromChatHistory",e.ResponseStreamFinished="Response_Stream_Finished",e.InsertingTablesFromResponse="Inserting_Tables_From_Response",e.InsertingListsFromResponse="Inserting_Lists_From_Response",e.FormulaPreviewButtonAllowed="Formula_Preview_Button_Allowed",e.FormulaPreviewButtonDisabled="Formula_Preview_Button_Disabled",e.FormulaPreviewButtonVisible="Formula_Preview_Button_Visible",e.FormulaPreviewButtonClickShow="Formula_Preview_Button_Click_Show",e.FormulaPreviewButtonClickHide="Formula_Preview_Button_Click_Hide",e.PromptAuthPopup="Prompt_Auth_Popup",e.ChatHistoryImageResendEvent="Chat_History_Image_Resend_Event",e.SelfHelpContentShown="SelfHelp_Content_Shown",e.SelfHelpActionClicked="SelfHelp_Action_Clicked",e.CalculatedFormulaGetFormula="Calculated_Formula_Get_Formula",e.CalculatedFormulaGetDescription="Calculated_Formula_Get_Description",e.CalculatedFormulaGetExplanation="Calculated_Formula_Get_Explanation",e.CalculatedRowsSuggestionsReceived="Calculated_Rows_Suggestions_Received",e.DataShapingAddSteps="Data_Shaping_Add_Steps",e.DataShapingEndMode="Data_Shaping_End_Mode",e.DataShapingPreviewClosed="Data_Shaping_Preview_Closed",e.DataShapingQueryScriptChanged="Data_Shaping_Query_Script_Changed",e.DataShapingShowErrorCard="Data_Shaping_Show_Error_Card",e.DataShapingShowStartCard="Data_Shaping_Show_Start_Card",e.DataShapingStartMode="Data_Shaping_Start_Mode",e.DataShapingUndoSteps="Data_Shaping_Undo_Steps",e.DataShapingEditQuery="Data_Shaping_Edit_Query",e.DataShapingHydration="Data_Shaping_Hydration",e.DataShapingAgentChange="Data_Shaping_Agent_Change",e.DataShapingAgentStartMode="Data_Shaping_Agent_Start_Mode",e.DataShapingAgentEndMode="Data_Shaping_Agent_End_Mode",e.FormulaSuggestionDedupedContextTables="Formula_Suggestion_Deduped_Context_Tables",e.FormulaSuggestionInvalidated="Formula_Suggestion_Invalidated",e.FormulaSuggestionTrackedForInvalidation="Formula_Suggestion_Tracked_For_Invalidation",e.FormulaSuggestionInsertColumnTimings="Formula_Suggestion_Insert_Column_Timings",e.FormulaSuggestionInsertRowTimings="Formula_Suggestion_Insert_Row_Timings",e.FormulaSuggestionInvalidationTrackingData="Formula_Suggestion_Invalidation_Tracking_Data",e.FormulaSuggestionSkillData="Formula_Suggestion_Skill_Data",e.FormulaSnippetData="Formula_Snippet_Data",e.ScheduleScriptClicked="Schedule_Script_Clicked",e.FlowCreatedConfirmation="Flow_Created_Confirmation",e.UserContextSignalSubmitted="User_Context_Signal_Submitted",e.ALUserType="AL_User_Type",e.GroundingSourceUpdated="Grounding_Source_Updated",e.HumanInTheLoopMessage="Human_In_The_Loop_Message",e.EmptyMessageReceivedFromSydney="Empty_Message_Received_From_Sydney",e.SelectTableCard="Select_Table_Card",e.ImportDataCard="Import_Data_Card",e.ImportDataShowCard="Import_Data_Show_Card",e.ImportDataLoadQuery="Import_Data_Load_Query",e.ImportDataExplainButtonClicked="Import_Data_Explain_Button_Clicked",e.TaskPaneStart="Task_Pane_Start",e.AppLoadStart="App_Load_Start",e.OfficeJSReady="OfficeJS_Ready",e.CopilotEnabledAfterAutoSave="Copilot_Enabled_After_AutoSave",e.ShowDisabledScreen="Show_Disabled_Screen",e.SignalWithSkillOverride="Signal_With_Skill_Override",e.SkillOverride="Skill_Override",e.HandoffMessageFromHostAppSettingsError="HandoffMessageFromHostAppSettingsError",e.HandoffMessageIdResponseError="Handoff_MessageIdResponse_Error",e.HandoffMessageIdGetOperationSubmitted="Handoff_Message_Id_Get_Operation_Submitted",e.HandoffMessageIdProcessedOperationSubmitted="Handoff_Message_Id_Processed_Operation_Submitted",e.HandoffQueryPerceivedByUser="Handoff_Query_Perceived_By_User",e.HandoffQueryAutoSubmitted="Handoff_Query_Auto_Submitted",e.HandoffQuerySubmittedByUser="Handoff_Query_Submitted_By_User",e.HandoffComplete="Handoff_Complete",e.AnalyzeDataEmptyAnswer="Analyze_Data_Empty_Answer",e.AnalyzeDataMarkdownMessage="Analyze_Data_Markdown_Message",e.CSHScenarioRun="CSH_Scenario_Run",e.ContextManagerInitialized="Context_Manager_Initialized",e.DefaultInsertCalculatedColumnFailed="DefaultInsertCalculatedColumnFailed",e.CalculatedColumnExpandFailedNotEmptyColumn="CalculatedColumnExpandFailedNotEmptyColumn",e.CalculatedColumnExpandFailed="CalculatedColumnExpandFailed",e.CalculatedCellExpandFailedNotEmptyCell="CalculatedCellExpandFailedNotEmptyCell",e.CalculatedCellExpandFailed="CalculatedCellExpandFailed",e.CalculatedColumnPartialInsertFailed="CalculatedColumnPartialInsertFailed",e.DocumentGroundingShown="DocumentGroundingShown",e.TabularRangeAutoFixFailed="TabularRangeAutoFixFailed",e.TabularRangeNoAutoFixApplied="TabularRangeNoAutoFixApplied",e.PythonCodeAndPostViewCardShown="PythonCodeAndPostViewCardShown",e.PythonMergedCardShown="PythonMergedCardShown",e.PythonCodeAndPostViewCardUpdatedWithResult="PythonCodeAndPostViewCardUpdatedWithResult",e.PythonCodeAndPostViewCardUpdatedWithError="PythonCodeAndPostViewCardUpdatedWithError",e.PythonResultsAddedToNewSheetSuccess="PythonResultsAddedToNewSheetSuccess",e.PythonResultsAddedToNewSheetError="PythonResultsAddedToNewSheetError",e.TriggerImageChatOperation="Trigger_Image_Chat_Operation",e.ExternalQuery="External_Query",e.LoadingTableLikeRangesWarning="Loading_TableLikeRanges_Warning",e.InitializePrivateHostMessagingDuration="InitializePrivateHostMessagingDuration",e.DisplayExternalMessages="Display_External_Messages",e.CommandScratchpadExpandHitlListClicked="CommandScratchpadExpandHitlListClicked",e.CommandScratchpadHitlDescriptionTelemetry="CommandScratchpadHitlDescriptionTelemetry",e.CommandScratchpadValidateOfficeJsCalled="CommandScratchpadValidateOfficeJsCalled",e.CommandScratchpadFallbackDescriptionUsed="CommandScratchpadFallbackDescriptionUsed",e.CommandScratchpadPassiveTesting="CommandScratchpadPassiveTesting",e.ChartDesignRecommendationsAnnotionReceived="ChartDesignRecommendationsAnnotionReceived",e.ChartDesignRecommendationsCardShown="ChartDesignRecommendationsCardShown",e.ChartDesignRecommendationsValidateOfficeJSResultCalled="ChartDesignRecommendationsValidateOfficeJSResultCalled",e.ChartDesignRecommendationsScratchpadHitlDescriptionTelemetry="ChartDesignRecommendationsScratchpadHitlDescriptionTelemetry",e.ChartDesignRecommendationsChartRecommendationSignalTriggered="ChartDesignRecommendationsChartRecommendationSignalTriggered",e.ChartDesignRecommendationsChartRecommendationSignalCompleted="ChartDesignRecommendationsChartRecommendationSignalCompleted",e.ChartDesignRecommendationsSuggestionApplied="ChartDesignRecommendationsSuggestionApplied",e.ChartDesignRecommendationsActivated="ChartDesignRecommendationsActivated",e.ChartDesignRecommendationsOptOut="ChartDesignRecommendationsOptOut",e.ChartDesignRecommendationsPreviewButtonClicked="ChartDesignRecommendationsPreviewButtonClicked",e.ChartDesignRecommendationsAllPreviewsLoaded="ChartDesignRecommendationsAllPreviewsLoaded",e.ChartDesignRecommendationsInProgress="ChartDesignRecommendationsInProgress",e.DocumentContextFlags="DocumentContextFlags",e.ShowPreloadedCopilot="ShowPreloadedCopilot",e.TaskPaneVisibilityModeChanged="TaskPaneVisibilityModeChanged",e.PreloadCopilot="PreloadCopilot",e.GptIdForBranding="Gpt_Id_For_Branding",e.ExtensibilityConfig="Extensibility_Config",e.InterstitialMessageShown="Interstitial_Message_Shown",e.BizchatHostContext="BizChat_Host_Context"}(d||(d={})),function(e){e.AgentTimeout="Agent_Timeout",e.AugloopTimeout="Augloop_Timeout",e.BadToken="Bad_Token",e.ClientError="Client_Error",e.DashboardInsertFailed="Dashboard_Insert_Failed",e.DetectedJunkQuery="Junk_Query",e.DetectedMultipleIntents="Multiple_Intents_Detected",e.DetectedOffensiveContent="Offensive_Content",e.DetectedOutOfScope="Out_Of_Scope",e.DetectedOutOfScopeShort="Out_Of_Scope_Short",e.DetectedTooShort="Too_Short",e.DetectedUnsupportedLanguage="Unsupported_Language",e.NoTableLikeEntityFound="No_TableLikeEntity_Found",e.UnsupportedTabularRange="Unsupported_Tabular_Range",e.LicensingError="Licensing_Error",e.NetworkError="Network_Error",e.NoSuggestions="No_Suggestions",e.NotSingleColumn="Not_Single_Column",e.UserThrottled="User_Throttled",e.RaiError="RAI_Error",e.LLMServiceError="LLM_Service_Error",e.IrrelevantQuery="Irrelevant_Query",e.OdslExecutionFailed="Odsl_Execution_Failed",e.OfficeJsExecutionFailed="OfficeJs_Execution_Failed",e.OrchestratorDisengaged="OrchestratorDisengaged",e.ServiceError="Service_Error",e.TokenCount="Token_Count",e.UnsupportedCommand="UnsupportedCommand",e.LargeData="Large_Data",e.ChatHistoryHydrationFailed="Chat_History_Hydration_Failed",e.ChatHistoryImageResendFailed="Chat_History_Image_Resend_Failed",e.PythonCalculatedColumnsError="Python_Calculated_Columns_Error",e.PythonError="Python_Error",e.UnsupportedObjectDetected="Unsupported_Object_Detected",e.TlrAutofixError="Tlr_Autofix_Error",e.OutOfCreditsError="Out_Of_Credits_Error",e.TLRAutofixSuggestion="Tlr_Autofix_Suggestion",e.Unauthorized="Unauthorized"}(u||(u={})),function(e){e.ErrorMessage="ErrorMessage",e.OperationType="OperationType",e.RequestId="RequestId",e.ErrorType="ErrorType",e.LogLevel="LogLevel"}(m||(m={})),function(e){e.ErrorMessage="ErrorMesasge",e.LogLevel="LogLevel",e.TimeOut="TimeOut",e.Id="Id"}(g||(g={})),function(e){e.LogLevel="LogLevel",e.ErrorMessage="ErrorMessage",e.NumOfColumnHidden="NumOfColumnHidden"}(h||(h={})),function(e){e.FailedEventMethods="Executor_FailedMethods",e.Agent="Executor_ExecutableAgent"}(p||(p={})),function(e){e.Reason="Reason",e.CurrentStatement="CurrentStatement",e.ArgumentNames="ArgumentNames",e.UnsupportedArgumentTypes="UnsupportedArgumentTypes"}(b||(b={})),function(e){e.Reason="Reason",e.ArgumentType="ArgumentType",e.ExpectedType="ExpectedType"}(f||(f={})),function(e){e.ODSLProperty="ODSLProperty"}(C||(C={})),function(e){e.CorrelationId="CorrelationId",e.EventType="EventType",e.ExcelCorrelationId="ExcelCorrelationId",e.FetchRecommendationsCorrelationId="FetchRecommendationsCorrelationId",e.NumRows="NumRows",e.NumColumns="NumColumns",e.NumRowsSelected="NumRowsSelected",e.NumRowsReferenced="NumRowsReferenced",e.SelectionExpanded="SelectionExpanded",e.IsSmallSelection="IsSmallSelection",e.IsTable="IsTable",e.HasTableHeaders="HasTableHeaders",e.AreaCount="AreaCount",e.HasInvalidValues="HasInvalidValues",e.IsSuccessful="IsSuccessful",e.Method="Method",e.Api="Api",e.ResponseCode="ResponseCode",e.RetryCount="RetryCount",e.ResponseType="ResponseType",e.ServiceTime="ServiceTime",e.RangeId="RangeId",e.OperationId="OperationId",e.CompressionMethod="CompressionMethod",e.CompressionTime="CompressionTime",e.SerializationTime="SerializationTime",e.OperationStatus="OperationStatus",e.RequestSize="RequestSize",e.FailureReason="FailureReason",e.FailureLocation="FailureLocation",e.RecommendationData="RecommendationData",e.Duration="Duration",e.NumChunks="NumChunks",e.NumSyncs="NumSyncs",e.MinRowsInChunk="MinRowsInChunk",e.Type="Type",e.NLContextId="NLContextId",e.AllowRewrite="AllowRewrite",e.IsAnnaParserFallback="IsAnnaParserFallback",e.TraceId="TraceId",e.SpanId="SpanId",e.VisualType="VisualType",e.ReasonForError="ReasonForError",e.IsInvalidInsightsSession="IsInvalidInsightsSession",e.InvalidInsightsSessionSource="invalidInsightsSessionSource",e.QueryType="QueryType",e.RowOffset="RowOffset",e.Height="Height",e.Width="Width",e.Caveats="Caveats",e.TextAnalysisResultType="TextAnalysisResultType"}(y||(y={})),function(e){e.CorrelationId="CorrelationId",e.Duration="Duration",e.ExcelCorrelationId="ExcelCorrelationId",e.FetchRecommendationsCorrelationId="FetchRecommendationsCorrelationId",e.RequestId="RequestId",e.SuggestionId="SuggestionId",e.Type="Type"}(v||(v={})),function(e){e.CorrelationId="CorrelationId",e.ErrorCode="ErrorCode",e.ErrorLocation="ErrorLocation",e.EvaluateQueryCorrelationId="EvaluateQueryCorrelationId",e.ErrorType="EventType",e.ExcelCorrelationId="ExcelCorrelationId",e.FetchRecommendationsCorrelationId="FetchRecommendationsCorrelationId",e.Message="Message",e.Name="Name",e.OfficeErrorCode="OfficeErrorCode",e.Reason="Reason",e.RecommendationId="RecommendationId",e.Source="Source",e.Stack="Stack",e.InnerError="InnerError",e.SuggestionID="SuggestionID"}(T||(T={})),function(e){e.TimeoutAfter="TimeoutAfter",e.Source="Source",e.Message="Message",e.UserQueryGuid="UserQueryGuid"}(x||(x={})),function(e){e.NoResult="NoResult",e.SuggestionApplied="SuggestionApplied",e.SuggestionShown="SuggestionShown",e.Undo="Undo",e.Deleted="Deleted",e.GroundPickerSelected_DocMode="GroundPickerSelected_DocMode",e.GroundPickerSelected_EnterpriseMode="GroundPickerSelected_EnterpriseMode",e.InsertTableShowed="InsertTableShowed",e.InsertTableClicked="InsertTableClicked",e.InsertTableSuccess="InsertTableSuccess",e.InsertListShowed="InsertListShowed",e.InsertListClicked="InsertListClicked",e.InsertListSuccess="InsertListSuccess",e.CopyMessageClicked="CopyMessageClicked",e.ImportDataButtonShowed="ImportDataButtonShowed",e.ImportDataButtonClicked="ImportDataButtonClicked",e.ViewScript="ViewScriptClicked",e.SaveScript="SaveScriptClicked",e.DeleteScript="DeleteScriptClicked",e.FormulaCopyClicked="FormulaCopyClicked",e.OfficeScriptsFolderClicked="OfficeScriptsFolderClicked",e.ScheduleScriptClicked="ScheduleScriptClicked",e.Apply="Apply",e.ConditionalFormattingSuggestionPillClicked="ConditionalFormattingSuggestionPillClicked",e.ElseFallback="ElseFallback",e.TeachingCalloutShown="TeachingCalloutShown",e.PythonFallback="PythonFallback"}(S||(S={})),function(e){e.AnalyzeData="AnalyzeData",e.Answers="Answers",e.CalculatedColumns="CalculatedColumns",e.PythonCalculatedColumns="PythonCalculatedColumns",e.ChatPaneLoad="ChatPaneLoad",e.Commanding="Commanding",e.ConditionalFormatting="ConditionalFormatting",e.ConditionalFormattingSuggestion="ConditionalFormattingSuggestion",e.ConvertToTable="ConvertToTable",e.CopilotChat="CopilotChat",e.CopyMessage="CopyMessage",e.DataShaping="DataShaping",e.Else="Else",e.ExternalTriggeredQuery="ExternalTriggeredQuery",e.ImportDataFromSearch="ImportDataFromSearch",e.ImportDataSkill="ImportDataSkill",e.InsertTable="InsertTable",e.InsertList="InsertList",e.ImageChat="Image Chat",e.NLToFormula="NLToFormula",e.OfficeJsCommanding="OfficeJsCommanding",e.OfficeScripts="OfficeScripts",e.Python="Python",e.SampleData="SampleData",e.Search="Search",e.SelfHelp="Self-Help Search",e.ShowHeaders="ShowHeaders",e.SmartHelp="SmartHelp",e.UndoMessage="UndoMessage",e.HandOff="Hand-Off",e.ContextInference="ContextInference",e.CalculatedRows="CalculatedRows",e.PythonForms="PythonForms",e.ChartDesignRecommendations="ChartDesignRecommendations",e.Unset="",e.ExcelAgent="ExcelAgent"}(w||(w={})),function(e){e.AddButton="AddButton",e.DashboardSuggestionPill="DashboardSuggestionPill",e.GridAction="GridAction",e.InsightsApi="InsightsApi",e.UndoButton="UndoButton",e.NLChatRequest="NLChatRequest",e.FormulaGenerationSuggestionPill="FormulaGenerationSuggestionPill",e.SubmitPythonStartAnalysisQuery="SubmitPythonStartAnalysisQuery",e.SubmitPythonAdaQuery="SubmitPythonAdaQuery",e.InsertPythonCodeButton="InsertPythonCodeButton",e.PythonAdaCodeInserted="PythonAdaCodeInserted",e.CopyPythonCodeButton="CopyPythonCodeButton",e.ViewScriptButton="ViewScriptButon",e.SaveScriptButton="SaveScriptButton",e.DeleteScriptButton="DeleteScriptButton",e.CopyFormulaButton="CopyFormulaButton",e.ScheduleScriptButton="ScheduleScriptButton",e.ApplyButton="ApplyButton",e.ConditionalFormattingSuggestionPill="ConditionalFormattingSuggestionPill",e.SearchResponse="SearchResponse",e.ChatResponse="ChatResponse",e.Answers="Answers"}(E||(E={})),function(e){e.Default="Default",e.SuggestionPill="SuggestionPill",e.ZQM="ZQM",e.ExternalQuery="ExternalQuery",e.MenuItem="MenuItem",e.InternalTool="InternalTool",e.MsFormsSDX="MsFormsSDX",e.AAChartingRibbon="AAChartingRibbon"}(I||(I={})),function(e){e.Chat="Chat",e.Canvas="Canvas"}(R||(R={})),function(e){e.Analyze="Analyze",e.Ask="Ask",e.Command="Command",e.Create="Create",e.Share="Share",e.Summarize="Summarize",e.UnknownIntent="UnknownIntent"}(A||(A={})),function(e){e.AnalyzeData="AnalyzeData",e.Answers="Answers",e.FormulaGeneration="FormulaGeneration",e.ChatPaneLoad="ChatPaneLoad",e.Preload_ChatPaneLoad="Preload_ChatPaneLoad",e.ChatQnA="Chat QnA",e.Commanding="Commanding",e.ConditionalFormatting="ConditionalFormatting",e.ImportData="ImportData",e.CopilotChat="CopilotChat",e.OfficeScripts="OfficeScripts",e.ExcelChatHelper="ExcelChatHelper",e.Python="Python",e.Search="Search",e.Handoff="Handoff",e.ShowPreloadedCopilot="ShowPreloadedCopilot",e.PrepareData="Prepare Data",e.ChartDesignRecommendations="ChartDesignRecommendations",e.Unset=""}(L||(L={}));const D=e=>(new Date).getTime()-e,B=e=>performance.now()-e,$=(e,t)=>({eventType:e,eventData:Object.keys(t).map((e=>({key:e,value:t[e]})))}),H=e=>(e.UserQueryGuid=P.M.userQueryGuid,e.UserQueryOrder=P.M.userQueryOrder,{eventType:_.S2.OfficeJsOperations,eventData:Object.keys(e).map((t=>({key:t,value:e[t]})))}),U=()=>{const e={};return Object.keys(r).forEach((t=>{e[t]=""})),e};function q({actionType:e,featureName:t,source:n,suggestionId:a,userQueryGuid:o}){return V(e,t,n,a,o)}const V=(e,t,n,a,o,r,...i)=>{const l=[{key:_.tE.ActionType,value:e},{key:_.tE.FeatureName,value:t??"Commanding"},...i];return n&&l.push({key:_.tE.Source,value:n}),a&&l.push({key:_.tE.SuggestionId,value:a}),o&&l.push({key:_.tE.UserQueryGuid,value:o}),r&&l.push({key:_.tE.ActionVariant,value:r}),{eventType:_.S2.Usage,eventData:l}},W=e=>({eventType:_.S2.ZeroQueryMessageClicks,eventData:[{key:_.Qs.PromptDescription,value:e}]});var G;!function(e){e.CreatePresentation="Create Presentation",e.AddContent="Add Content",e.Organize="Organize",e.BasicCommand="Basic Command",e.Summarize="Summarize",e.DocumentQnA="Document QnA",e.ChatQnA="Chat QnA",e.Unset="",e.CopilotChat="Copilot Chat"}(G||(G={}));const z=()=>{if((0,M.vIj)()){let e="Workbook";return(0,O.pX)()&&(e+="+Work"),(0,O.gc)()&&(e+="+Web"),e}return(0,O.pX)()?"Enterprise":"Workbook"},Q=e=>{let t={};try{t=JSON.parse(e)}catch(e){(0,N.cY)("Error parsing telemetry data ",e.message)}return t},j=e=>{const t=e.getActiveTable(),n=t?.tableLikeRange?"true":"false",a=t?.tableLikeRange&&!t?.tableLikeRangeFeatures?"true":"false",o=t&&!t.tableLikeRange?"true":"false",r=t?.tableContained?"true":"false",i=t?.tableIntersected?"true":"false",l=e?.activeChart?"true":"false",s=e?.activePivotTable?"true":"false",c=`${t?.tableLikeRangeFeatures??0}`,d=(0,M.ZAR)()?"true":"false",u=(e=>{if(!e)return"";const t=e.sheetRange.range;return null===t.bottomRight.row||null===t.topLeft.row||null===t.bottomRight.column||null===t.topLeft.column?"":`${t.bottomRight.row-t.topLeft.row+1}x${t.bottomRight.column-t.topLeft.column+1}`})(t);return{IsTLR:n,IsValidTLR:a,IsTable:o,IsTableContained:r,IsTableIntersected:i,IsChart:l,IsPivotTable:s,TLRFeatures:c,TableLikeEntityDimensions:u,SelectionError:e.selectionError?e.selectionError:"",IsTFCEnabled:d}};function J(e){const t=[{key:"TableType",value:"TableContext"},{key:"HasTotalRow",value:e.totalRow},{key:"RowCount",value:e.numRows},{key:"ColumnCount",value:e.numColumns},{key:"HasHiddenColumns",value:e.visibleColumns.length<e.numColumns}];return null!=e.hasHiddenRows&&t.push({key:"HasHiddenRows",value:e.hasHiddenRows}),null!=e.tableLikeRangeFeatures&&t.push({key:"UnsupportedFeatures",value:e.tableLikeRangeFeatures}),null!=e.tableContained&&t.push({key:"TableContained",value:e.tableContained}),null!=e.tableIntersected&&t.push({key:"TableIntersected",value:e.tableIntersected}),null!=e.tableLikeRange&&t.push({key:"TableLikeRange",value:e.tableLikeRange}),t}const Y=e=>{try{const t=j(e);return{key:"DocumentContext",value:JSON.stringify(t)}}catch(e){}return{key:"DocumentContext",value:""}},X=e=>Object.keys(e).map((t=>({key:t,value:e[t]}))),Z=e=>{let t;if(!e)return t;switch(e){case k.w.ElseSkillName:t="ExcelChatHelper";break;case k.w.GetInsightsName:case k.w.ExcelAnalysis:case k.w.ChartsAndPivotTablesName:case k.w.TextAnalysisName:t="AnalyzeData";break;case k.w.SelfHelpSkillName:t="Search";break;case k.w.FormulasName:case k.w.CalculatedColumnsName:case k.w.CreateCalculatedColumnsName:t="FormulaGeneration";break;case k.w.FormatDocumentName:case k.w.EditDocumentName:t="Commanding";break;case k.w.SearchEnterpriseName:case k.w.SearchToolsRequestInterstitialsPublisher:case k.w.SearchToolsResponseInterstitials:t="Search";break;case k.w.OfficeScriptsName:t="OfficeScripts";break;case k.w.PythonSkillName:case k.w.NewPythonSkillName:case k.w.PythonCalculatedColumnsName:t="Python";break;case k.w.GenerateResponseName:case k.w.ImageChatName:t="CopilotChat";break;case k.w.DataShapingName:t="Prepare Data";break;case k.w.AnswersName:t="Answers";break;case k.w.AugLoopEvalName:case k.w.AugLoopName:case k.w.GetContextName:case k.w.DeepLeo:case k.w.Workflow:break;default:P.M.getInstance().logError({eventType:_.S2.AssertionFailed,errorMessage:`AugLoop returned an unexpected skill: ${e}`,logLevel:F.$b.Error})}return t};var K,ee,te;function ne(e){if((0,M.yw9)("OfficeVSO_9389407_fixErrorLoggingV2"))return"string"==typeof e?new Error(e):e}function ae(e){switch(e){case"Copilot\\Commanding":return"Commanding";case"Copilot\\Commanding CF Suggestions":case"Copilot\\Commanding Conditional Formatting":return(0,M.yw9)("OfficeVSO_9564930_SplitCommandingTelemetry")?"ConditionalFormatting":"Commanding";case"Copilot\\Analyze Data":return"AnalyzeData";case"Copilot\\Formula Generation":return"CalculatedColumns";case"Copilot\\Search":return"Search";case"Copilot\\Import Data":return"ImportDataFromSearch";case"Copilot\\Python":return"Python";case"Copilot\\PythonForms":return"PythonForms";case"Copilot\\Else":return"Else";case"Copilot\\Image Chat":return(0,M.yw9)("OfficeVSO_9565005_InsertImageOCV")?"Image Chat":"CopilotChat";case"Copilot\\Chart Design Recommendations":return"ChartDesignRecommendations";case"Copilot\\Answers":return"Answers";default:return"CopilotChat"}}!function(e){e.HandoffStart="Handoff_Start",e.AppStart="App_Start",e.CopilotPaneStart="Copilot_Pane_Start",e.TaskPaneStart="Task_Pane_Start",e.AppLoadStart="App_Load_Start",e.OfficeJSReady="OfficeJS_Ready",e.ChatPaneLoaded="Chat_Pane_Loaded",e.HandoffMessageIdSent="Handoff_Message_Id_Sent",e.HandoffMessageIdProcessed="Handoff_Message_Id_Processed",e.HandoffMessageReceived="Handoff_Message_Received",e.HandoffQueryPerceivedByUser="Handoff_Query_Perceived_By_User",e.HandoffQueryAutoSubmitted="Handoff_Query_Auto_Submitted",e.HandoffComplete="Handoff_Complete"}(K||(K={})),function(e){e.PromptType="promptType",e.SourceApp="sourceApp",e.IsModified="isModified",e.ScenarioName="scenarioName",e.FeatureName="featureName"}(ee||(ee={})),function(e){e.FeatureName="FeatureName",e.HasUndoScopeOpened="HasUndoScopeOpened"}(te||(te={}))},857786:(e,t,n)=>{"use strict";n.d(t,{$k:()=>k,BW:()=>L,Cc:()=>w,F5:()=>N,Fr:()=>F,Li:()=>q,MO:()=>O,Mg:()=>A,P_:()=>B,QO:()=>P,_F:()=>M,ek:()=>R,hb:()=>V,i5:()=>_,l5:()=>E,lu:()=>U,oO:()=>D,tW:()=>H,xk:()=>y});var a=n(75496),o=n(279395),r=n(316904),i=n(664007),l=n(109174),s=n(857677),c=n(799765),d=n(469486),u=n(507628);let m,g,h,p,b,f="",C=0;var y;function v(e,t){t.push({key:a.tM.PythonDurationEvent,value:e}),(t=t.concat((0,c.p1)())).push({key:a.tM.UserScenarioId,value:f});const n={eventType:a.S2.PythonDuration,eventData:t};r.M.getInstance().logEvent(n)}function T(e){const t=[];t.push({key:a.tM.TimerName,value:e}),v("TimerAlreadyRunning",t)}function x(e){const t=[];t.push({key:a.tM.TimerName,value:e}),v("TimerUndefined",t)}function S(e,t){const n=performance.measure(e,{start:t});return Math.round(n.duration)}function w(e,t,n,o){const r=(0,s.xJ)(t),i=l.CP.pythonContextManager.pythonContextBuilder.getPythonConversationHistory().length,c=l.CP.pythonContextManager.pythonContextBuilder.getOtherPythonCells().length,d=[];d.push({key:a.tM.Duration,value:r}),d.push({key:a.tM.IsPythonCellSelected,value:l.CP.isPythonCellSelected}),d.push({key:a.tM.ConversationHistoryCount,value:i}),d.push({key:a.tM.OtherPythonCellsCount,value:c}),d.push({key:a.tM.IsErrorCaught,value:n}),d.push({key:a.tM.WorksheetsProcessed,value:l.CP.pythonContextManager.pythonContextBuilder.getWorksheetsProcessed()}),d.push({key:a.tM.FormulasProcessed,value:l.CP.pythonContextManager.pythonContextBuilder.getFormulasProcessed()}),d.push({key:a.tM.FormulasProcessedPerWorksheet,value:l.CP.pythonContextManager.pythonContextBuilder.getFormulasProcessedPerWorksheet()}),o&&d.push({key:a.tM.OptionalDetails,value:o}),v(e,d)}function E(e,t,n,o=!1){const r=(0,s.xJ)(t),i=[];i.push({key:a.tM.Duration,value:r}),i.push({key:a.tM.IsErrorCaught,value:o}),n&&i.push({key:a.tM.RetryCount,value:n}),v(e,i)}function I(e,t,n){const o=(0,s.cc)(t),r=[];r.push({key:a.tM.Duration,value:o}),r.push({key:a.tM.IsErrorCaught,value:n||!1}),v(e,r)}async function R(e,t,n=!1){const a=performance.now();let o=!1;try{return await e()}catch(e){if(o=!0,!n)throw e}finally{I(t,a,o)}}async function A(e,t){const n=performance.now();let o=!1;try{return await e()}catch(e){throw o=!0,e}finally{if("GetPythonCellsFromSpecialCellsAreas"===t)!function(e,t,n){const o=(0,s.cc)(t),r=[];r.push({key:a.tM.Duration,value:o}),r.push({key:a.tM.IsErrorCaught,value:n||!1}),r.push({key:a.tM.FormulasProcessedPerWorksheet,value:l.CP.pythonContextManager.pythonContextBuilder.getFormulasProcessedPerWorksheet()}),v(e,r)}(t,n,o);else I(t,n,o)}}function L(e){e(i.m.setLoadingStrings((0,o.NCh)()))}function k(e){e(i.m.setLoadingStrings((0,o.ZYo)()))}function F(e){(m||g)&&T("codeExecutionTimer"),m=performance.now(),g=e}function _(e){const t=l.CP.pythonContextManager.isFirstCodeExecution;if(l.CP.pythonContextManager.isFirstCodeExecution=!1,!m||!g)return void x("codeExecutionTimer");const n=S(g,m),o=[];o.push({key:a.tM.Duration,value:n}),o.push({key:a.tM.DidInsert,value:e}),o.push({key:a.tM.IsFirstCodeExecution,value:t}),v(g,o),m=void 0,g=void 0}function P(e,t,n){const o=(0,s.xJ)(t),r=[];r.push({key:a.tM.Duration,value:o}),n&&r.push({key:a.tM.OptionalDetails,value:n}),v(e,r)}function N(){h&&T("PythonUserScenario"),h=performance.now(),""!==f&&l.CP.pythonContextManager.isPythonMode&&0===p||(f=(0,u.A)()),p=0}function M(){C++}function O(){$("UserScenarioQueryToCalculationComplete",!1)}function D(){$("UserScenarioQueryToFinalText",!0)}function B(e=!1,t=!1){$("UserScenarioQueryToError",!0,e,t)}function $(e,t,n=!1,o=!1){if(!h)return void x("PythonUserScenario."+e);const r=S(e,h),i=[];i.push({key:a.tM.ResponseNumber,value:p}),i.push({key:a.tM.Duration,value:r}),i.push({key:a.tM.DidAugloopCallFail,value:n}),i.push({key:a.tM.IsStopGenerating,value:o}),i.push({key:a.tM.CodeErrorCount,value:C});const s=l.CP.pythonContextManager.pythonContextBuilder.getOtherPythonCells().length;i.push({key:a.tM.OtherPythonCellsCount,value:s});const c=l.CP.pythonContextManager.pythonContextBuilder.getPythonConversationHistory().length;i.push({key:a.tM.ConversationHistoryCount,value:c}),v(e,i),t&&(0===p&&"UserScenarioQueryToError"!==e||(f=""),h=void 0,p=0,C=0)}function H(e,t,n){0===e&&(t||(0,d.i_)())&&$("UserScenarioQueryToFirstResponse",!1),n&&D()}function U(){b&&T("PythonAugloopCall"),b=performance.now()}function q(){(l.CP.pythonContextManager.isPythonMode||(0,d.i_)())&&p++,W("AugloopCallToSuccess")}function V(){(l.CP.pythonContextManager.isPythonMode||(0,d.i_)())&&p++,W("AugloopCallToError",!0)}function W(e,t=!1){if(!b)return void x("AugloopCall");const n=S(e,b),o=[];o.push({key:a.tM.ResponseNumber,value:p}),o.push({key:a.tM.Duration,value:n});const r=l.CP.pythonContextManager.pythonContextBuilder.getOtherPythonCells().length;o.push({key:a.tM.OtherPythonCellsCount,value:r});const i=l.CP.pythonContextManager.pythonContextBuilder.getPythonConversationHistory().length;o.push({key:a.tM.ConversationHistoryCount,value:i}),o.push({key:a.tM.DidAugloopCallFail,value:t}),v(e,o),b=void 0}!function(e){e.AdaContextExtraction="AdaContextExtraction",e.AugloopCallToSuccess="AugloopCallToSuccess",e.AugloopCallToError="AugloopCallToError",e.CallGetSpecialCellsOrNullObjectApi="CallGetSpecialCellsOrNullObjectApi",e.CodeExecution="CodeExecuted",e.ConnectOfficePySvcToExecutePythonCode="ConnectOfficePySvcToExecutePythonCode",e.DataFrameInsert="DataFrameInsert",e.ExecutePythonCodeApiCall="ExecutePythonCodeApiCall",e.FindDataFrameAddress="FindDataFrameAddress",e.GetActiveTableContext="GetActiveTableContext",e.GetAllPythonCellsUptoAnalysisSheet="GetAllPythonCellsUptoAnalysisSheet",e.GetAllPythonCellsOfAASessionAnalysisSheet="GetAllPythonCellsOfAASessionAnalysisSheet",e.GetExcelValueSingleCellOutput="GetExcelValueSingleCellOutput",e.GetLastPythonCellOnSheet="GetLastPythonCellOnSheet",e.GetOfficePyServiceAccessToken="GetOfficePyServiceAccessToken",e.GetPythonCellContext="GetPythonCellContext",e.GetPythonCellRange="GetPythonCellRange",e.GetPythonCellsFromSpecialCellsAreas="GetPythonCellsFromSpecialCellsAreas",e.GetPythonCellsFromWorksheet="GetPythonCellsFromWorksheet",e.GetPythonContextObjectApiCall="GetPythonContextObjectApiCall",e.GetPythonObjectOutput="GetPythonObjectOutput",e.GetPythonObjectReferenceIdWithRetry="GetPythonObjectReferenceIdWithRetry",e.GetUpdatedPythonTableContext="GetUpdatedPythonTableContext",e.GetUpdatedPythonTableContextForTableLikeRange="GetUpdatedPythonTableContextForTableLikeRange",e.HandlePythonAdaCellExecution="HandlePythonAdaCellExecution",e.InsertDataFrameAndGetPythonContext="InsertDataFrameAndGetPythonContext",e.InsertDataFrameIfNecessaryForStartAnalysis="InsertDataFrameIfNecessaryForStartAnalysis",e.InsertContentToGrid="InsertContentToGrid",e.InsertPostView="InsertPostView",e.InsertPreview="InsertPreview",e.IsPythonCell="IsPythonCell",e.PreloadOfficePyServiceAccessToken="PreloadOfficePyServiceAccessToken",e.RecalcSheet="RecalcSheet",e.StartAnalysisContextExtraction="StartAnalysisContextExtraction",e.TimerAlreadyRunning="TimerAlreadyRunning",e.TimerUndefined="TimerUndefined",e.UpdateConversationHistory="UpdateConversationHistory",e.UserScenarioQueryToError="UserScenarioQueryToError",e.UserScenarioQueryToFirstResponse="UserScenarioQueryToFirstResponse",e.UserScenarioQueryToCalculationComplete="UserScenarioQueryToCalculationComplete",e.UserScenarioQueryToFinalText="UserScenarioQueryToFinalText"}(y||(y={}))},859981:(e,t,n)=>{"use strict";var a,o,r,i,l,s;n.d(t,{Ki:()=>o,Oc:()=>r,Tz:()=>i,X6:()=>u,YA:()=>s,fM:()=>a,iT:()=>l,jH:()=>d,w_:()=>c}),function(e){e.Insights="Insights",e.FormulaAction="FormulaAction",e.HighlightAction="HighlightAction",e.Search="Search",e.Python="Python",e.HowToSum="HowToSum",e.DataPreparation="DataPreparation"}(a||(a={})),function(e){e.SuggestColumn="SuggestColumn",e.WriteFormula="WriteFormula",e.AddFormulaColumn="AddFormulaColumn",e.ExplainFormula="ExplainFormula",e.InvestigateError="InvestigateError",e.SplitColumns="SplitColumns",e.TotalRow="TotalRow",e.LookupFormula="LookupFormula"}(o||(o={})),function(e){e.GetDataInsights="GetDataInsights",e.AdvancedAnalysis="AdvancedAnalysis",e.PerformForecasting="PerformForecasting",e.CreateBoxplot="CreateBoxplot",e.SetOfCharts="SetOfCharts",e.GenerateWordCloud="GenerateWordCloud",e.EditPythonCode="EditPythonCode"}(r||(r={})),function(e){e.CreateTable="CreateTable",e.KeyboardShortcuts="KeyboardShortcuts",e.TipsAndTricks="TipsAndTricks",e.FreezeColumn="FreezeColumn",e.HowToCreateDropdown="HowToCreateDropdown",e.DataPreparation="DataPreparation"}(i||(i={})),function(e){e.SummarizeColumn="SummarizeColumn",e.ShowDataInsights="ShowDataInsights",e.CreatePivotTable="CreatePivotTable",e.CreatePieChart="CreatePieChart",e.GenerateGraph="GenerateGraph",e.HighlightCells="HighlightCells",e.ApplyColorCoding="ApplyColorCoding"}(l||(l={})),function(e){e.WebSearchCreateTable="WebSearchCreateTable",e.WebSearchLearn="WebSearchLearn",e.ImportTable="ImportTable",e.PrepareForMeetings="PrepareForMeetings",e.RecapEmails="RecapEmails"}(s||(s={}));const c={...o,...r,...i,...l,...s},d={...o,...i,...l,...s},u={...a,...c}},860730:(e,t,n)=>{"use strict";n.d(t,{eD:()=>I,dW:()=>E,uC:()=>N,_2:()=>_});var a=n(279395),o=n(316904),r=n(859981),i=n(979011),l=n(437489),s=n(898701),c=n(192207),d=n(174116),u=n(668315),m=n(147487),g=n(347969),h=n(823548),p=n(57848),b=n(940690),f=n(264830),C=n(720372),y=n(832221);const v={[r.fM.Insights]:i.uJg,[r.fM.FormulaAction]:l.vfO,[r.fM.HighlightAction]:l.RIf,[r.fM.Search]:s.CDg,[r.fM.Python]:c.Yuv,[r.fM.HowToSum]:s.CDg,[r.fM.DataPreparation]:l.RIf,[r.Ki.SuggestColumn]:c.pZh,[r.Ki.WriteFormula]:l.RIf,[r.Ki.AddFormulaColumn]:d.Y8t,[r.Ki.ExplainFormula]:u.rof,[r.Ki.InvestigateError]:m.TRI,[r.Ki.SplitColumns]:c.hX8,[r.Ki.TotalRow]:g.Kdk,[r.Ki.LookupFormula]:g.Vz1,[r.Oc.GetDataInsights]:c.zJX,[r.Oc.AdvancedAnalysis]:c.Yuv,[r.Oc.EditPythonCode]:l.RIf,[r.Oc.PerformForecasting]:c.vS8,[r.Oc.CreateBoxplot]:c.O11,[r.Oc.SetOfCharts]:h.NOv,[r.Oc.GenerateWordCloud]:p.VJB,[r.Tz.CreateTable]:g.X_q,[r.Tz.KeyboardShortcuts]:i.YWy,[r.Tz.TipsAndTricks]:s.lHS,[r.Tz.FreezeColumn]:g.NFJ,[r.Tz.HowToCreateDropdown]:s.CDg,[r.iT.SummarizeColumn]:b.QXr,[r.iT.ShowDataInsights]:c.SZA,[r.iT.CreatePivotTable]:f.pnR,[r.iT.CreatePieChart]:c.BGz,[r.iT.GenerateGraph]:s.XQT,[r.iT.HighlightCells]:i.jEr,[r.iT.ApplyColorCoding]:C.fFI,[r.YA.WebSearchCreateTable]:g.Vz1,[r.YA.WebSearchLearn]:g.ITY,[r.YA.ImportTable]:c.kMD,[r.YA.PrepareForMeetings]:y.vmL,[r.YA.RecapEmails]:u.GOF};var T=n(347145),x=n(808943),S=n(857677),w=n(469486);const E=()=>{const e=(0,T.wpe)(),t=(0,T.B8x)()&&!(0,w.$)();return{[r.fM.FormulaAction]:(0,a.$dh)(),[r.fM.Insights]:(0,a.zp5)(),[r.fM.Python]:e?(0,a.H5o)():t?(0,a.fkZ)():(0,a.ONP)(),[r.fM.HighlightAction]:(0,a.jI0)(),[r.fM.Search]:(0,a.IZv)(),[r.fM.HowToSum]:(0,a.Ghz)(),[r.fM.DataPreparation]:(0,a.On3)()}},I=()=>({...E(),[r.X6.SuggestColumn]:(0,a.VG_)(),[r.X6.WriteFormula]:(0,a.K0f)(),[r.X6.AddFormulaColumn]:(0,a.ztP)(),[r.X6.ExplainFormula]:(0,a.qAx)(),[r.X6.InvestigateError]:(0,a.C_C)(),[r.X6.SplitColumns]:(0,a._zy)(),[r.X6.TotalRow]:(0,a.KtU)(),[r.X6.LookupFormula]:(0,a.f00)(),[r.X6.GetDataInsights]:(0,a.N_T)(),[r.X6.AdvancedAnalysis]:(0,a.Bzb)(),[r.X6.EditPythonCode]:(0,a.d0n)(),[r.X6.PerformForecasting]:(0,a.xf7)(),[r.X6.CreateBoxplot]:(0,a.pKA)(),[r.X6.SetOfCharts]:(0,a.YYh)(),[r.X6.GenerateWordCloud]:(0,a.Coj)(),[r.X6.CreateTable]:(0,a.BhF)(),[r.X6.KeyboardShortcuts]:(0,a.hCI)(),[r.X6.TipsAndTricks]:(0,a.DqS)(),[r.X6.FreezeColumn]:(0,a.U7J)(),[r.X6.HowToCreateDropdown]:(0,a._ok)(),[r.X6.SummarizeColumn]:(0,a.kvY)(),[r.X6.ShowDataInsights]:(0,a.WNU)(),[r.X6.CreatePivotTable]:(0,a.QHr)(),[r.X6.CreatePieChart]:(0,a.wwj)(),[r.X6.GenerateGraph]:(0,a.esl)(),[r.X6.HighlightCells]:(0,a.aW0)(),[r.X6.ApplyColorCoding]:(0,a.bgS)(),[r.X6.WebSearchCreateTable]:(0,a.rnM)(),[r.X6.WebSearchLearn]:(0,a._xk)(),[r.X6.ImportTable]:(0,a._BM)(),[r.X6.PrepareForMeetings]:(0,a.ST4)(),[r.X6.RecapEmails]:(0,a.tMQ)()});function R(){return{[r.fM.Insights]:a.hn.menuSectionUnderstand(),[r.fM.FormulaAction]:a.hn.menuSectionCreate(),[r.fM.HighlightAction]:a.hn.menuSectionEdit(),[r.fM.Search]:(0,a._JR)(),[r.fM.Python]:(0,a.vNK)(),[r.fM.HowToSum]:(0,a._JR)(),[r.fM.DataPreparation]:(0,a.lun)(),[r.X6.SuggestColumn]:(0,a.UXx)(),[r.X6.WriteFormula]:(0,a.ptM)(),[r.X6.AddFormulaColumn]:(0,a.KsV)(),[r.X6.ExplainFormula]:(0,a.no)(),[r.X6.InvestigateError]:(0,a.$OL)(),[r.X6.SplitColumns]:(0,a.xOV)(),[r.X6.TotalRow]:(0,a.nHd)(),[r.X6.LookupFormula]:(0,a.itS)(),[r.X6.GetDataInsights]:(0,a.I1u)(),[r.X6.AdvancedAnalysis]:(0,a.Oz3)(),[r.X6.EditPythonCode]:(0,a.qag)(),[r.X6.PerformForecasting]:(0,a.sqX)(),[r.X6.CreateBoxplot]:(0,a.E9A)(),[r.X6.SetOfCharts]:(0,a.xMZ)(),[r.X6.GenerateWordCloud]:(0,a.D8x)(),[r.X6.CreateTable]:(0,a.ixU)(),[r.X6.KeyboardShortcuts]:(0,a.wvv)(),[r.X6.TipsAndTricks]:(0,a.qhm)(),[r.X6.FreezeColumn]:(0,a.Z2X)(),[r.X6.HowToCreateDropdown]:(0,a.Z2X)(),[r.X6.SummarizeColumn]:(0,a.XAy)(),[r.X6.ShowDataInsights]:(0,a.NyX)(),[r.X6.CreatePivotTable]:(0,a.D02)(),[r.X6.CreatePieChart]:(0,a.BIf)(),[r.X6.GenerateGraph]:(0,a.roM)(),[r.X6.HighlightCells]:(0,a.lFW)(),[r.X6.ApplyColorCoding]:(0,a.gsW)(),[r.X6.WebSearchCreateTable]:(0,a.Qhk)(),[r.X6.WebSearchLearn]:(0,a.r3R)(),[r.X6.ImportTable]:(0,a.nby)(),[r.X6.PrepareForMeetings]:(0,a.vJt)(),[r.X6.RecapEmails]:(0,a._0P)()}}function A(){return{[r.fM.Insights]:!0,[r.fM.FormulaAction]:!0,[r.fM.HighlightAction]:!1,[r.fM.Search]:!1,[r.fM.Python]:!0,[r.fM.HowToSum]:!1,[r.fM.DataPreparation]:!0,[r.X6.SuggestColumn]:!0,[r.X6.WriteFormula]:!1,[r.X6.AddFormulaColumn]:!1,[r.X6.ExplainFormula]:!1,[r.X6.InvestigateError]:!1,[r.X6.SplitColumns]:!1,[r.X6.TotalRow]:!1,[r.X6.LookupFormula]:!1,[r.X6.GetDataInsights]:!0,[r.X6.AdvancedAnalysis]:!0,[r.X6.EditPythonCode]:!1,[r.X6.PerformForecasting]:!1,[r.X6.CreateBoxplot]:!0,[r.X6.SetOfCharts]:!0,[r.X6.GenerateWordCloud]:!0,[r.X6.CreateTable]:!0,[r.X6.KeyboardShortcuts]:!0,[r.X6.TipsAndTricks]:!0,[r.X6.FreezeColumn]:!0,[r.X6.HowToCreateDropdown]:!0,[r.X6.SummarizeColumn]:!1,[r.X6.ShowDataInsights]:!0,[r.X6.CreatePivotTable]:!1,[r.X6.CreatePieChart]:!0,[r.X6.GenerateGraph]:!1,[r.X6.HighlightCells]:!1,[r.X6.ApplyColorCoding]:!1,[r.X6.WebSearchCreateTable]:!0,[r.X6.WebSearchLearn]:!0,[r.X6.ImportTable]:!1,[r.X6.PrepareForMeetings]:!0,[r.X6.RecapEmails]:!0}}const L=(0,T.yw9)("OfficeVSO_10277196_AnswersSkipLicenseCheckFixed")?(0,w.XT)():(0,w.gx)(),k=(0,T.ggM)()&&(0,T.yw9)("OfficeVSO_10277196_AnswersSkipLicenseCheckFixed")?(0,w.XT)():(0,w.gx)(),F={[r.fM.Search]:()=>(0,x.pX)(),[r.fM.Python]:()=>(0,T.H2A)()&&(0,w.gx)(),[r.fM.DataPreparation]:()=>(0,T.eFk)()&&!(0,T.iPS)("Microsoft.Office.Excel.FA000000124.DisableDataPreparationZQM",!1),[r.fM.HowToSum]:()=>(0,T.Qyj)(),[r.X6.GetDataInsights]:()=>(0,T.H2A)()&&L&&!(0,T.iPS)("Microsoft.Office.Excel.FA000000124.DisableGetDataInsightsRotatingZQM",!1),[r.X6.AdvancedAnalysis]:()=>(0,T.H2A)()&&k&&!(0,T.iPS)("Microsoft.Office.Excel.FA000000124.DisableAdvancedAnalysisRotatingZQM",!1),[r.X6.EditPythonCode]:()=>(0,T.H2A)()&&(0,w.gx)()&&(0,T.GqX)()&&!(0,T.iPS)("Microsoft.Office.Excel.FA000000124.DisableEditPythonCodeRotatingZQM",!1),[r.X6.PerformForecasting]:()=>(0,T.H2A)()&&L&&!(0,T.iPS)("Microsoft.Office.Excel.FA000000124.DisablePerformForecastingRotatingZQM",!1),[r.X6.CreateBoxplot]:()=>(0,T.H2A)()&&L&&!(0,T.iPS)("Microsoft.Office.Excel.FA000000124.DisableCreateBoxplotRotatingZQM",!1),[r.X6.SetOfCharts]:()=>(0,T.H2A)()&&L&&!(0,T.iPS)("Microsoft.Office.Excel.FA000000124.DisableSetOfChartsRotatingZQM",!1),[r.X6.GenerateWordCloud]:()=>(0,T.H2A)()&&L&&!(0,T.iPS)("Microsoft.Office.Excel.FA000000124.DisableGenerateWordCloudRotatingZQM",!1),[r.X6.CreateTable]:()=>!(0,T.iPS)("Microsoft.Office.Excel.FA000000124.DisableCreateTableRotatingZQM",!1),[r.X6.KeyboardShortcuts]:()=>!(0,T.iPS)("Microsoft.Office.Excel.FA000000124.DisableKeyboardShortcutsRotatingZQM",!1),[r.X6.TipsAndTricks]:()=>!(0,T.iPS)("Microsoft.Office.Excel.FA000000124.DisableTipsAndTricksRotatingZQM",!1),[r.X6.FreezeColumn]:()=>!(0,T.iPS)("Microsoft.Office.Excel.FA000000124.DisableFreezeColumnRotatingZQM",!1),[r.X6.HowToCreateDropdown]:()=>!(0,T.iPS)("Microsoft.Office.Excel.FA000000124.DisableHowToCreateDropdownRotatingZQM",!1),[r.X6.WriteFormula]:()=>!(0,T.iPS)("Microsoft.Office.Excel.FA000000124.DisableWriteFormulaRotatingZQM",!1),[r.X6.SummarizeColumn]:()=>!(0,T.iPS)("Microsoft.Office.Excel.FA000000124.DisableSummarizeColumnRotatingZQM",!1),[r.X6.ShowDataInsights]:()=>!(0,T.iPS)("Microsoft.Office.Excel.FA000000124.DisableShowDataInsightsRotatingZQM",!1),[r.X6.CreatePivotTable]:()=>!(0,T.iPS)("Microsoft.Office.Excel.FA000000124.DisableCreatePivotTableRotatingZQM",!1),[r.X6.CreatePieChart]:()=>!(0,T.iPS)("Microsoft.Office.Excel.FA000000124.DisableCreatePieChartRotatingZQM",!1),[r.X6.GenerateGraph]:()=>!(0,T.iPS)("Microsoft.Office.Excel.FA000000124.DisableGenerateGraphRotatingZQM",!1),[r.X6.HighlightCells]:()=>!(0,T.iPS)("Microsoft.Office.Excel.FA000000124.DisableHighlightCellsRotatingZQM",!1),[r.X6.ApplyColorCoding]:()=>!(0,T.iPS)("Microsoft.Office.Excel.FA000000124.DisableApplyColorCodingRotatingZQM",!1),[r.X6.SuggestColumn]:()=>!(0,T.iPS)("Microsoft.Office.Excel.FA000000124.DisableSuggestColumnRotatingZQM",!1),[r.X6.AddFormulaColumn]:()=>!(0,T.iPS)("Microsoft.Office.Excel.FA000000124.DisableAddFormulaColumnRotatingZQM",!1),[r.X6.ExplainFormula]:()=>!(0,T.iPS)("Microsoft.Office.Excel.FA000000124.DisableExplainFormulaRotatingZQM",!1),[r.X6.InvestigateError]:()=>!(0,T.iPS)("Microsoft.Office.Excel.FA000000124.DisableInvestigateErrorRotatingZQM",!1),[r.X6.SplitColumns]:()=>!(0,T.iPS)("Microsoft.Office.Excel.FA000000124.DisableSplitColumnsRotatingZQM",!1),[r.X6.TotalRow]:()=>!(0,T.iPS)("Microsoft.Office.Excel.FA000000124.DisableTotalRowRotatingZQM",!1),[r.X6.LookupFormula]:()=>!(0,T.iPS)("Microsoft.Office.Excel.FA000000124.DisableLookupFormulaRotatingZQM",!1),[r.X6.WebSearchCreateTable]:()=>(0,x.gc)()&&!(0,T.iPS)("Microsoft.Office.Excel.FA000000124.DisableWebSearchCreateTableRotatingZQM",!1),[r.X6.WebSearchLearn]:()=>(0,x.gc)()&&!(0,T.iPS)("Microsoft.Office.Excel.FA000000124.DisableWebSearchLearnRotatingZQM",!1),[r.X6.ImportTable]:()=>(0,x.pX)()&&(0,T.iPS)("Microsoft.Office.Excel.FA000000124.EnableImportTableRotatingZQM",!1),[r.X6.PrepareForMeetings]:()=>(0,x.pX)()&&!(0,T.iPS)("Microsoft.Office.Excel.FA000000124.DisablePrepareForMeetingsRotatingZQM",!1),[r.X6.RecapEmails]:()=>(0,x.pX)()&&!(0,T.iPS)("Microsoft.Office.Excel.FA000000124.DisableRecapEmailsRotatingZQM",!1)};function _(e){return(F[e]??(()=>!0))()}function P(e){const t={[(0,a.VG_)()]:"SuggestColumn",[(0,a.K0f)()]:"WriteFormula",[(0,a.ztP)()]:"AddFormulaColumn",[(0,a.qAx)()]:"ExplainFormula",[(0,a.C_C)()]:"InvestigateError",[(0,a._zy)()]:"SplitColumns",[(0,a.KtU)()]:"CreateTotalRow",[(0,a.f00)()]:"WriteLookupFormula",[(0,a.N_T)()]:"GetDataInsights",[(0,a.Bzb)()]:"AdvancedAnalysis",[(0,a.d0n)()]:"EditPythonCode",[(0,a.xf7)()]:"PerformForecasting",[(0,a.pKA)()]:"CreateBoxplot",[(0,a.YYh)()]:"SetOfCharts",[(0,a.Coj)()]:"GenerateWordCloud",[(0,a.BhF)()]:"CreateTable",[(0,a.hCI)()]:"KeyboardShortcuts",[(0,a.DqS)()]:"TipsAndTricks",[(0,a.U7J)()]:"FreezeColumn",[(0,a._ok)()]:"HowToCreateDropdown",[(0,a.kvY)()]:"SummarizeColumn",[(0,a.WNU)()]:"ShowDataInsights",[(0,a.QHr)()]:"CreatePivotTable",[(0,a.wwj)()]:"CreatePieChart",[(0,a.esl)()]:"GenerateGraph",[(0,a.aW0)()]:"HighlightCells",[(0,a.bgS)()]:"ApplyColorCoding",[(0,a.rnM)()]:"WebSearchCreateTable",[(0,a._xk)()]:"WebSearchLearn",[(0,a._BM)()]:"ImportTable",[(0,a.ST4)()]:"PrepareForMeetings",[(0,a.zp5)()]:"Insights",[(0,a.$dh)()]:"FormulaAction",[(0,a.jI0)()]:"HighlightAction",[(0,a.IZv)()]:"Search",[(0,a.ONP)()]:"Python",[(0,a.Ghz)()]:"HowToSum",[(0,a.On3)()]:"DataPreparation",[(0,a.tMQ)()]:"RecapEmails"}[e];t&&o.M.getInstance().logEvent((0,S.nE)(t))}function N(e=[],t=()=>{}){const n=e=>{P(e.suggestionText)},a=(0,T.GKX)(),o=(0,T.iPS)("Microsoft.Office.Excel.FA000000124.ShowBrandingInZQM",!1);if(e.length>0&&a){return{promptSuggestionList:e.filter((e=>_(e))).map((e=>({suggestionText:I()[e],suggestionCategory:R()[e],iconRegular:v[e],shouldSubmitQueryOnClick:A()[e],notifyClientOnZQMClicked:n}))),showRefreshButton:a,handleRefreshButtonClick:t,showBranding:o}}return{promptSuggestionList:Object.entries(E()).filter((([e,t])=>_(e))).map((([e,t])=>({suggestionText:t,suggestionCategory:R()[e],iconRegular:v[e],shouldSubmitQueryOnClick:A()[e],notifyClientOnZQMClicked:n}))),showRefreshButton:!1,handleRefreshButtonClick:t,showBranding:o}}},863165:(e,t,n)=>{"use strict";n.d(t,{u:()=>s});var a=n(217425),o=n(632197),r=n(660606),i=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{s(a.next(e))}catch(e){r(e)}}function l(e){try{s(a.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((a=a.apply(e,t||[])).next())}))},l=function(e,t){var n,a,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(n=1,a&&(o=2&l[0]?a.return:l[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,l[1])).done)return o;switch(a=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,a=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],a=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},s=function(e,t){return i(void 0,void 0,void 0,(function(){var n,i,s;return l(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),n=null!=t?t:a.w8.ic3,[4,e.getToken(n,void 0,["".concat(n,"/Media.ReadWrite.All")])];case 1:return i=l.sent(),[2,(0,o.t)(i)];case 2:throw s=l.sent(),(0,r.cY)("Error fetching IC3 token:",s),s;case 3:return[2]}}))}))}},870180:(e,t,n)=>{"use strict";n.d(t,{i:()=>me});var a=n(857677),o=n(76872),r=n(316904);const i=0,l=1,s=2,c=3,d=4,u=5,m=6,g=7,h=8,p=9,b=10,f=11,C=12,y=13,v=14,T=15,x=16,S=17,w=18,E=19,I=20,R=21,A=22,L=23,k=24,F=25,_=26,P=27,N=28,M=29,O=30,D=31,B=32,$=33,H=34,U=35,q=36,V=37,W=38,G=39,z=40,Q=41,j=42,J=43,Y=44,X=45,Z=46,K=47,ee=48,te=49,ne=50,ae=51,oe=52,re=53,ie=54,le=55,se=56,ce=57,de=58,ue=59;class me{static get CHANGE_CATEGORIES(){return this._changeCategories||(this._changeCategories=[{name:ExcelCopilotCommandingHitlStrings.ChangeLeveragingText,match:["AllowEditRange.Title","DataPivotHierarchy.Name","FilterPivotHierarchy.Name","PivotField.Name","PivotHierarchy.Name","PivotItem.Name","PivotTable.Name","PivotTableStyle.Name","Range.ReplaceAll","RowColumnPivotHierarchy.Name","Shape.Name","ShapeFont.Name","SlicerStyle.Name","TableStyle.Name","TextRange.Text","TimelineStyle.Name"],isTextValueChange:!0,type:se},{name:ExcelCopilotCommandingHitlStrings.CellValueEdits,match:["Range.Values","Range.Hyperlink","RangeView.Values"],isTextValueChange:!0,type:i},{name:ExcelCopilotCommandingHitlStrings.CellFormulaEdits,match:["Range.Formulas","Range.FormulasLocal","Range.FormulasR1C1","RangeView.Formulas","RangeView.FormulasLocal","RangeView.FormulasR1C1"],isTextValueChange:!0,type:l},{name:ExcelCopilotCommandingHitlStrings.ChangeNumberFormatting,match:["Range.NumberFormat","Range.NumberFormatLocal","RangeView.NumberFormat","Style.NumberFormat","Style.NumberFormatLocal"],isTextValueChange:!0,type:c},{name:ExcelCopilotCommandingHitlStrings.Autofit,match:["RangeFormat.AutofitColumns","RangeFormat.AutofitRows"],isTextValueChange:!1,type:ce},{name:ExcelCopilotCommandingHitlStrings.ResizeRows,match:["RangeFormat.RowHeight"],isTextValueChange:!1,type:w},{name:ExcelCopilotCommandingHitlStrings.ResizeColumns,match:["RangeFormat.ColumnWidth"],isTextValueChange:!1,type:E},{name:ExcelCopilotCommandingHitlStrings.SetCellFormatting,match:["FormatProtection","Range.Style","RangeAreas.Style","RangeBorder","RangeBorderCollection","RangeFill","RangeFont","RangeFormat","Style.","StyleCollection.Add","Worksheet.StandardWidth"],isTextValueChange:!1,type:s},{name:ExcelCopilotCommandingHitlStrings.ModifyComments,match:["CommentCollection.Add","CommentReplyCollection.Add"],isTextValueChange:!0,type:u},{name:ExcelCopilotCommandingHitlStrings.ModifyComments,match:["Comment.Delete","CommentReply.Delete"],isTextValueChange:!1,type:m},{name:ExcelCopilotCommandingHitlStrings.ModifyComments,match:["Comment.Content","CommentReply.Content"],isTextValueChange:!0,type:d},{name:ExcelCopilotCommandingHitlStrings.SetConditionalFormatting,match:["ConditionalFormatCollection.Add"],isTextValueChange:!1,type:h},{name:ExcelCopilotCommandingHitlStrings.SetConditionalFormatting,match:["ConditionalFormat.Priority","ConditionalFormat.StopIfTrue","ConditionalFormat.SetRanges","ConditionalFormat.ChangeRuleToCellValue","ConditionalFormat.ChangeRuleToColorScale","ConditionalFormat.ChangeRuleToContainsText","ConditionalFormat.ChangeRuleToCustom","ConditionalFormat.ChangeRuleToDataBar","ConditionalFormat.ChangeRuleToIconSet","ConditionalFormat.ChangeRuleToPresetCriteria","ConditionalFormat.ChangeRuleToTopBottom","CellValueConditionalFormat","ConditionalRangeFill","ConditionalFormatRule","PresetCriteriaConditionalFormat","ColorScaleConditionalFormat","CustomConditionalFormat","DataBarConditionalFormat","ConditionalDataBarPositiveFormat","ConditionalDataBarNegativeFormat","IconSetConditionalFormat","TextConditionalFormat","TopBottomConditionalFormat","ConditionalRangeBorder","ConditionalRangeFill","ConditionalRangeFont"],isTextValueChange:!0,type:g},{name:ExcelCopilotCommandingHitlStrings.DeleteConditionalFormatting,match:["ConditionalFormat.Delete","ConditionalFormatCollection.ClearAll"],isTextValueChange:!1,type:p},{name:ExcelCopilotCommandingHitlStrings.MergeCells,match:["Range.Merge"],isTextValueChange:!1,type:b},{name:ExcelCopilotCommandingHitlStrings.UnmergeCells,match:["Range.Unmerge"],isTextValueChange:!1,type:f},{name:ExcelCopilotCommandingHitlStrings.ClearContent,match:["Range.Clear","RangeAreas.Clear"],isTextValueChange:!1,type:C},{name:ExcelCopilotCommandingHitlStrings.RangeMoveCopy,match:["Range.MoveTo","Range.CopyFrom","Range.CopyTo","RangeAreas.CopyFrom"],isTextValueChange:!1,type:y},{name:ExcelCopilotCommandingHitlStrings.InsertRows,match:["Range.Insert"],isTextValueChange:!1,type:v,fnMatch:e=>!e.Arguments?.length||Boolean(e.Arguments[0]===Excel.InsertShiftDirection.down)},{name:ExcelCopilotCommandingHitlStrings.InsertColumns,match:["Range.Insert"],isTextValueChange:!1,type:T,fnMatch:e=>Boolean(e.Arguments?.length&&e.Arguments[0]===Excel.InsertShiftDirection.right)},{name:ExcelCopilotCommandingHitlStrings.ModifyTableCategory,match:["Table.AddRow","Table.AddRows","TableRowCollection.Add"],isTextValueChange:!1,type:O},{name:ExcelCopilotCommandingHitlStrings.ModifyTableCategory,match:["Table.AddColumn","TableColumnCollection.Add"],isTextValueChange:!1,type:D},{name:ExcelCopilotCommandingHitlStrings.DeleteRows,match:["Range.Delete"],isTextValueChange:!1,type:x,fnMatch:e=>!e.Arguments?.length||Boolean(e.Arguments[0]===Excel.DeleteShiftDirection.up)},{name:ExcelCopilotCommandingHitlStrings.DeleteColumns,match:["Range.Delete"],isTextValueChange:!1,type:S,fnMatch:e=>Boolean(e.Arguments?.length&&e.Arguments[0]===Excel.DeleteShiftDirection.left)},{name:ExcelCopilotCommandingHitlStrings.ModifyTableCategory,match:["Table.DeleteRowsAt","TableRowCollection.DeleteRows","TableRowCollection.DeleteRowsAt","TableRow.Delete"],isTextValueChange:!1,type:B},{name:ExcelCopilotCommandingHitlStrings.ModifyTableCategory,match:["TableColumn.Delete"],isTextValueChange:!1,type:$},{name:ExcelCopilotCommandingHitlStrings.HideRows,match:["Range.RowHidden"],isTextValueChange:!1,type:I,fnMatch:e=>Boolean(e.Arguments?.length&&!0===e.Arguments[0])},{name:ExcelCopilotCommandingHitlStrings.UnhideRows,match:["Range.RowHidden"],isTextValueChange:!1,type:R,fnMatch:e=>Boolean(e.Arguments?.length&&!1===e.Arguments[0])},{name:ExcelCopilotCommandingHitlStrings.HideColumns,match:["Range.ColumnHidden"],isTextValueChange:!1,type:A,fnMatch:e=>Boolean(e.Arguments?.length&&!0===e.Arguments[0])},{name:ExcelCopilotCommandingHitlStrings.UnhideColumns,match:["Range.ColumnHidden"],isTextValueChange:!1,type:L,fnMatch:e=>Boolean(e.Arguments?.length&&!1===e.Arguments[0])},{name:ExcelCopilotCommandingHitlStrings.CreateTableCategory,match:["TableCollection.Add"],isTextValueChange:!1,type:N},{name:ExcelCopilotCommandingHitlStrings.DeleteTableCategory,match:["Table.Delete"],isTextValueChange:!1,type:M},{name:ExcelCopilotCommandingHitlStrings.ModifyTableCategory,match:["Table.Resize"],isTextValueChange:!1,type:H},{name:ExcelCopilotCommandingHitlStrings.NameTableCategory,match:["Table.Name"],isTextValueChange:!0,type:q},{name:ExcelCopilotCommandingHitlStrings.ModifyTableCategory,match:["Table.Style","TableStyleCollection.Add","TableStyleCollection.SetDefault","TableStyle"],isTextValueChange:!1,type:U},{name:ExcelCopilotCommandingHitlStrings.SortFilterTable,match:["RangeSort.Apply"],isTextValueChange:!1,type:V},{name:ExcelCopilotCommandingHitlStrings.SortFilterTable,match:["TableSort.Apply","TableSort.Reapply"],isTextValueChange:!1,type:W},{name:ExcelCopilotCommandingHitlStrings.SortFilterTable,match:["Filter","AutoFilter"],isTextValueChange:!1,type:G},{name:ExcelCopilotCommandingHitlStrings.EditAltTextCategory,match:["Shape.AltTextTitle","Shape.AltTextDescription"],isTextValueChange:!0,type:_},{name:ExcelCopilotCommandingHitlStrings.ModifyShapePositioning,match:["Shape.Height","Shape.Width","Shape.Top","Shape.Left","Shape.LockAspectRatio","Shape.Placement","Shape.Rotation","Shape.Visible","Shape.IncrementLeft","Shape.IncrementRotation","Shape.IncrementTop","Shape.ScaleHeight","Shape.ScaleWidth","Shape.SetZOrder","ShapeGroup.Ungroup","ShapeCollection.AddGroup","TextFrame.AutoSizeSetting","TextFrame.BottomMargin","TextFrame.LeftMargin","TextFrame.Orientation","TextFrame.RightMargin","TextFrame.TopMargin"],isTextValueChange:!0,type:P},{name:ExcelCopilotCommandingHitlStrings.CreateChartCategory,match:["ChartCollection.Add"],isTextValueChange:!1,type:z},{name:ExcelCopilotCommandingHitlStrings.DeleteChartCategory,match:["Chart.Delete"],isTextValueChange:!1,type:Q},{name:ExcelCopilotCommandingHitlStrings.MoveChartCategory,match:["Chart.SetPosition","Chart.Top","Chart.Left","Chart.Height","Chart.Width"],isTextValueChange:!1,type:j},{name:ExcelCopilotCommandingHitlStrings.ChangeChartTypeCategory,match:["Chart.ChartType","ChartSeries.ChartType"],isTextValueChange:!1,type:J},{name:ExcelCopilotCommandingHitlStrings.ChangeChartDataSourceCategory,match:["Chart.SetData","ChartAxis.SetCategoryNames","ChartSeriesCollection.Add","ChartSeries.Delete","ChartSeries.SetValues","ChartSeries.SetXAxisValues","ChartSeries.SetBubbleSizes"],isTextValueChange:!1,type:Y},{name:ExcelCopilotCommandingHitlStrings.ChangeChartText,match:["Chart.Name","ChartTitle.Text","ChartAxisTitle.Text","ChartDataLabel.Text","ChartSeries.Name","ChartTrendline.Name","ChartTrendlineLabel.Text","ChartAxisTitle.SetFormula","ChartDataLabel.Formula","ChartTitle.SetFormula","ChartTrendlineLabel.Formula","ChartAxis.NumberFormat","ChartDataLabel.NumberFormat","ChartDataLabel.Separator","ChartDataLabels.NumberFormat","ChartDataLabels.Separator","ChartFont.Name","ChartTrendlineLabel.NumberFormat"],isTextValueChange:!0,type:Z},{name:ExcelCopilotCommandingHitlStrings.ChangeChartFormatting,match:["Chart.","ChartAreaFormat","ChartAxes","ChartAxis","ChartAxis.Visible","ChartAxisFormat","ChartAxisTitle","ChartAxisTitle.Visible","ChartAxisTitleFormat","ChartBinOptions","ChartBorder","ChartBoxwhiskerOptions","ChartDataLabels","ChartDataLabel","ChartDataLabelFormat","ChartDataTable","ChartDataTable.Visible","ChartDataTableFormat","ChartErrorBars","ChartErrorBars.Visible","ChartErrorBarsFormat","ChartFill","ChartFont","ChartFormatString","ChartGridlines","ChartGridlines.Visible","ChartGridlinesFormat","ChartLegend","ChartLegend.Visible","ChartLegendEntry","ChartLegendEntry.Visible","ChartLegendFormat","ChartLineFormat","ChartMapOptions","ChartPivotOptions","ChartPlotArea","ChartPlotAreaFormat","ChartPoint","ChartPointFormat","ChartSeries","ChartSeriesFormat","ChartTitle","ChartTitle.Visible","ChartTitleFormat","ChartTrendlineCollection.Add","ChartTrendline","ChartTrendline.Delete","ChartTrendlineFormat","ChartTrendlineLabel","ChartTrendlineLabelFormat"],isTextValueChange:!1,type:X},{name:ExcelCopilotCommandingHitlStrings.CreateSheet,match:["WorksheetCollection.Add"],isTextValueChange:!1,type:K},{name:ExcelCopilotCommandingHitlStrings.DeleteSheet,match:["Worksheet.Delete"],isTextValueChange:!1,type:ee},{name:ExcelCopilotCommandingHitlStrings.RenameSheet,match:["Worksheet.Name"],isTextValueChange:!0,type:te},{name:ExcelCopilotCommandingHitlStrings.MoveSheetCategory,match:["Worksheet.Position"],isTextValueChange:!1,type:ne},{name:ExcelCopilotCommandingHitlStrings.SheetProtectionCategory,match:["WorksheetProtection.Protect","WorksheetProtection.Unprotect"],isTextValueChange:!1,type:ae},{name:ExcelCopilotCommandingHitlStrings.ChangeNamedItems,match:["NamedItemCollection.Add","NamedItemCollection.AddFormulaLocal"],isTextValueChange:!0,type:F},{name:ExcelCopilotCommandingHitlStrings.ChangeNamedItems,match:["NamedItem"],isTextValueChange:!0,type:k},{name:ExcelCopilotCommandingHitlStrings.CreatePivotTableCategory,match:["PivotTableCollection.Add"],isTextValueChange:!1,type:oe},{name:ExcelCopilotCommandingHitlStrings.DeletePivotTableCategory,match:["PivotTable.Delete"],isTextValueChange:!1,type:re},{name:ExcelCopilotCommandingHitlStrings.ModifyPivotTableFormatting,match:["DataPivotHierarchy.NumberFormat","DataPivotHierarchy.ShowAs","PivotLayout.AutoFormat","PivotLayout.PreserveFormatting","PivotTableStyle","PivotTableStyleCollection.Add","PivotTableStyleCollection.SetDefault"],isTextValueChange:!1,type:le},{name:ExcelCopilotCommandingHitlStrings.ModifyPivotTable,match:["DataPivotHierarchy.Position","DataPivotHierarchy.SetToDefault","DataPivotHierarchy.SummarizeBy","DataPivotHierarchyCollection.Add","DataPivotHierarchyCollection.Remove","FilterPivotHierarchy.EnableMultipleFilterItems","FilterPivotHierarchy.Position","FilterPivotHierarchy.SetToDefault","FilterPivotHierarchyCollection.Add","FilterPivotHierarchyCollection.Remove","PivotField.ApplyFilter","PivotField.ClearAllFilters","PivotField.ClearFilter","PivotField.ShowAllItems","PivotField.SortByLabels","PivotField.SortByValues","PivotField.Subtotals","PivotItem.IsExpanded","PivotItem.Visible","PivotLayout.","PivotTable.AllowMultipleFiltersPerField","PivotTable.EnableDataValueEditing","PivotTable.Refresh","PivotTableCollection.RefreshAll","RowColumnPivotHierarchy.Position","RowColumnPivotHierarchy.SetToDefault","RowColumnPivotHierarchyCollection.Add","RowColumnPivotHierarchyCollection.Remove"],isTextValueChange:!1,type:ie},{name:ExcelCopilotCommandingHitlStrings.GenericChange,match:["Range.AutoFill","Range.Group","Range.HideGroupDetails","Range.RemoveDuplicates","Range.ShowGroupDetails","Range.Ungroup"],isTextValueChange:!1,type:ue}]),this._changeCategories}static generateDocumentChanges(e){const t=[];e.forEach((e=>{t.push(e.Scope);const n=e.Arguments,a=this.getCategory(e).type;a===te&&e.Scope.Worksheet&&n&&n.length>0&&t.push({Worksheet:{Name:this.extractArgumentValues(n)}}),a===q&&e.Scope.Table&&n&&n.length>0&&t.push({Table:{Name:this.extractArgumentValues(n)},...e.Scope.Worksheet&&{Worksheet:{Name:e.Scope.Worksheet.Name}}})}));const n=new Map,a={};t.forEach((e=>{const t=e.Worksheet?.Name,o=t?n.get(t)||n.set(t,{Name:t}).get(t):a;Object.entries(e).forEach((([e,t])=>{if("Worksheet"===e||!t||"object"!=typeof t)return;const n=["Name","Address"].map((e=>t[e])).filter((e=>"string"==typeof e));n.length&&(o[e]=o[e]||[],n.forEach((t=>{o[e].includes(t)||o[e].push(t)})))}))}));return{Worksheets:Array.from(n.values()),...a}}static generateDescription(e){e=e.filter((e=>!this.READONLY_API_NAMES.includes(e.Name)&&!e.Name.includes(".Get")));const t=[],n=[],a=new Map,o=new Map;for(const t of e){const e=this.getCategory(t),n=this.getScopeString(t,e.type);a.set(e.name,e),o.has(n)||o.set(n,[]),o.get(n).push({call:t,category:e})}const r=new Set;for(const[e,a]of o.entries())for(const{call:o,category:i}of a){const a=this.getChangeDescription(o,i.type),l=`${e}:${a}`;if(!r.has(l)){const o={scope:e,change:a};i.isTextValueChange?t.push(o):n.push(o),r.add(l)}}let i=Array.from(o.keys());return i.length>3&&(i=this.generalizeScopes(e)),{header:this.generateHeader(Array.from(a.values()),i),descriptions:[...t,...n]}}static conjoinStrings(e){if(0===e.length)return"";if(1===e.length)return e[0];const t=ExcelCopilotCommandingHitlStrings.MultipleItemsTemplate;let n=e[0];for(let a=1;a<e.length;a++)n=t.replace("{0}",n).replace("{1}",e[a]);return n}static getScopeString(e,t){const n=Object.keys(e.Scope),a="string"==typeof e.Scope.Table?.Name;for(const o of n)switch(o){case"Table":if("string"==typeof e.Scope.Table?.Name&&t!==N)return e.Scope.Table.Name;break;case"Chart":if("string"==typeof e.Scope.Chart?.Name&&t!==z)return e.Scope.Chart.Name;break;case"PivotTable":if("string"==typeof e.Scope.PivotTable?.Name&&t!==oe)return e.Scope.PivotTable.Name;break;case"Shape":if("string"==typeof e.Scope.Shape?.Name)return e.Scope.Shape.Name;break;case"Range":if("string"==typeof e.Scope.Range?.Address&&!a)return e.Scope.Range.Address;break;case"Worksheet":if("string"==typeof e.Scope.Worksheet?.Name&&t!==K)return e.Scope.Worksheet.Name}return ExcelCopilotCommandingHitlStrings.WorkbookScope}static generalizeScopes(e){const t=new Set,n=new Set;for(const a of e)"string"==typeof a.Scope.Table?.Name?n.add(a.Scope.Table.Name):"string"==typeof a.Scope.Worksheet?.Name&&t.add(a.Scope.Worksheet.Name);if(t.size+n.size<=3)return[...t,...n];for(const n of e)n.Scope.Table?.Name&&"string"==typeof n.Scope.Worksheet?.Name&&t.add(n.Scope.Worksheet.Name);return t.size<=3?[...t]:[ExcelCopilotCommandingHitlStrings.WorkbookScope]}static getCategory(e){for(const t of this.CHANGE_CATEGORIES)if(t.match.some((t=>e.Name.startsWith(t)))&&(!t.fnMatch||t.fnMatch(e)))return t;return{name:ExcelCopilotCommandingHitlStrings.GenericChange,match:[],isTextValueChange:!1,type:de}}static getChangeDescription(e,t){const n=e.Arguments;switch(t){case i:return n&&n.length>0?ExcelCopilotCommandingHitlStrings.UpdateToTemplate.replace("{0}",this.extractArgumentValues(n)):ExcelCopilotCommandingHitlStrings.UpdateValues;case l:return n&&n.length>0?ExcelCopilotCommandingHitlStrings.UpdateFormulaTemplate.replace("{0}",this.extractArgumentValues(n)):ExcelCopilotCommandingHitlStrings.UpdateValues;case s:return e.Name.includes("RangeFont.Name")?this.getFallbackDescription(n,e.Name,ExcelCopilotCommandingHitlStrings.SetCellFormatting):ExcelCopilotCommandingHitlStrings.SetCellFormatting;case c:return ExcelCopilotCommandingHitlStrings.ChangeNumberFormatting;case u:if(n&&n.length>0){const e=this.extractArgumentValues(n);return ExcelCopilotCommandingHitlStrings.AddCommentTemplate.replace("{0}",e)}return ExcelCopilotCommandingHitlStrings.AddComment;case d:if(n&&n.length>0){const e=this.extractArgumentValues(n);return ExcelCopilotCommandingHitlStrings.ChangeCommentTemplate.replace("{0}",e)}return ExcelCopilotCommandingHitlStrings.ChangeComment;case m:return ExcelCopilotCommandingHitlStrings.DeleteComment;case h:if(n&&n.length>0){const e=n[0];if(e===Excel.ConditionalFormatType.colorScale)return ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatColorScale;if(e===Excel.ConditionalFormatType.dataBar)return ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatDataBar;if(e===Excel.ConditionalFormatType.cellValue)return ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatCellValue;if(e===Excel.ConditionalFormatType.presetCriteria)return ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatPreset;if(e===Excel.ConditionalFormatType.containsText)return ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatContainsText;if(e===Excel.ConditionalFormatType.topBottom)return ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatTopBottom;if(e===Excel.ConditionalFormatType.custom)return ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatCustom;if(e===Excel.ConditionalFormatType.iconSet)return ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatIconSet}return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting;case g:return this.getConditionalFormattingDescription(e,n);case p:return ExcelCopilotCommandingHitlStrings.DeleteConditionalFormatting;case b:return ExcelCopilotCommandingHitlStrings.MergeCells;case f:return ExcelCopilotCommandingHitlStrings.UnmergeCells;case C:return ExcelCopilotCommandingHitlStrings.ClearContent;case y:return e.Name.includes("Copy")?ExcelCopilotCommandingHitlStrings.Copy:ExcelCopilotCommandingHitlStrings.Move;case v:return ExcelCopilotCommandingHitlStrings.InsertRows;case T:return ExcelCopilotCommandingHitlStrings.InsertColumns;case x:return ExcelCopilotCommandingHitlStrings.DeleteRows;case S:return ExcelCopilotCommandingHitlStrings.DeleteColumns;case w:return ExcelCopilotCommandingHitlStrings.ResizeRows;case E:return ExcelCopilotCommandingHitlStrings.ResizeColumns;case I:return ExcelCopilotCommandingHitlStrings.HideRows;case R:return ExcelCopilotCommandingHitlStrings.UnhideRows;case A:return ExcelCopilotCommandingHitlStrings.HideColumns;case L:return ExcelCopilotCommandingHitlStrings.UnhideColumns;case N:return ExcelCopilotCommandingHitlStrings.CreateTable;case M:return ExcelCopilotCommandingHitlStrings.DeleteTable;case O:return ExcelCopilotCommandingHitlStrings.InsertTableRows;case D:return ExcelCopilotCommandingHitlStrings.InsertTableColumns;case B:return ExcelCopilotCommandingHitlStrings.DeleteTableRows;case $:return ExcelCopilotCommandingHitlStrings.DeleteTableColumns;case H:return ExcelCopilotCommandingHitlStrings.ModifyTable;case U:return ExcelCopilotCommandingHitlStrings.ModifyTableStyle;case ce:return ExcelCopilotCommandingHitlStrings.Autofit;case q:return ExcelCopilotCommandingHitlStrings.NameTableTemplate.replace("{0}",n&&n.length>0?this.extractArgumentValues(n):"");case V:return ExcelCopilotCommandingHitlStrings.SortRange;case W:return ExcelCopilotCommandingHitlStrings.SortTable;case G:return n&&n.length>0?ExcelCopilotCommandingHitlStrings.FilterTableTemplate.replace("{0}",this.extractArgumentValues(n)):this.getFallbackDescription(n,e.Name,ExcelCopilotCommandingHitlStrings.GenericChange);case z:return ExcelCopilotCommandingHitlStrings.CreateChart;case Q:return ExcelCopilotCommandingHitlStrings.DeleteChart;case j:return ExcelCopilotCommandingHitlStrings.MoveChart;case J:return ExcelCopilotCommandingHitlStrings.ChangeChartType;case Y:return n&&n.length>0&&"string"==typeof n[0]?ExcelCopilotCommandingHitlStrings.ChangeChartDataSourceTemplate.replace("{0}",this.extractArgumentValues(n)):ExcelCopilotCommandingHitlStrings.ChangeChartDataSource;case X:return ExcelCopilotCommandingHitlStrings.ChangeChartFormatting;case Z:if(n&&n.length>0){const t=this.extractArgumentValues(n);return e.Name.includes("ChartTitle")?ExcelCopilotCommandingHitlStrings.ChangeChartTitleTemplate.replace("{0}",t):ExcelCopilotCommandingHitlStrings.ChangeChartTextTemplate.replace("{0}",t)}return ExcelCopilotCommandingHitlStrings.ChangeChartText;case K:return n&&n.length>0?ExcelCopilotCommandingHitlStrings.CreateSheetTemplate.replace("{0}",this.extractArgumentValues(n)):ExcelCopilotCommandingHitlStrings.CreateSheet;case ee:return ExcelCopilotCommandingHitlStrings.DeleteSheet;case te:return ExcelCopilotCommandingHitlStrings.RenameSheetTemplate.replace("{0}",n&&n.length>0?this.extractArgumentValues(n):"");case ne:return ExcelCopilotCommandingHitlStrings.MoveSheet;case ae:return e.Name.includes("Unprotect")?ExcelCopilotCommandingHitlStrings.UnprotectSheet:ExcelCopilotCommandingHitlStrings.ProtectSheet;case oe:return ExcelCopilotCommandingHitlStrings.CreatePivotTable;case re:return ExcelCopilotCommandingHitlStrings.DeletePivotTable;case ie:return ExcelCopilotCommandingHitlStrings.ModifyPivotTable;case le:return ExcelCopilotCommandingHitlStrings.ModifyPivotTableFormatting;case F:return n&&n.length>=2&&"string"==typeof n[0]?this.getNamedItemDescription(n[0],n[1]):this.getFallbackDescription(n,e.Name,ExcelCopilotCommandingHitlStrings.ChangeNamedItems);case k:return e.Name.includes("NamedItem.Formula")&&n&&n.length>0&&"string"==typeof e.Scope.NamedItem?.Name?this.getNamedItemDescription(e.Scope.NamedItem.Name,n[0]):this.getFallbackDescription(n,e.Name,ExcelCopilotCommandingHitlStrings.ChangeNamedItems);case _:return n&&n.length>0&&"string"==typeof n[0]?ExcelCopilotCommandingHitlStrings.EditAltTextTemplate.replace("{0}",n[0]):this.getFallbackDescription(n,e.Name,ExcelCopilotCommandingHitlStrings.EditAltTextCategory);case P:return ExcelCopilotCommandingHitlStrings.ModifyShapePositioning;case ue:return ExcelCopilotCommandingHitlStrings.GenericChange;default:return this.getFallbackDescription(n,e.Name,ExcelCopilotCommandingHitlStrings.GenericChange)}}static getConditionalFormattingDescription(e,t){if(e.Name.includes("ColorScaleConditionalFormat")||e.Name.includes("ConditionalFormat.ChangeRuleToColorScale"))return this.getColorScaleDescription(e,t);if(e.Name.includes("DataBarConditionalFormat")||e.Name.includes("ConditionalFormat.ChangeRuleToDataBar"))return this.getDataBarDescription(e,t);if(e.Name.includes("ConditionalDataBarPositiveFormat"))return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting;if(e.Name.includes("ConditionalDataBarNegativeFormat"))return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting;if(e.Name.includes("IconSetConditionalFormat")||e.Name.includes("ConditionalFormat.ChangeRuleToIconSet"))return this.getIconSetDescription(e,t);if(e.Name.includes("TopBottomConditionalFormat")||e.Name.includes("ConditionalFormat.ChangeRuleToTopBottom"))return this.getTopBottomDescription(e,t);if(e.Name.includes("ConditionalRangeFormat")){if(e.Name.includes("NumberFormat")&&t?.length&&null!==t[0]){const e=this.extractArgumentValues(t);return ExcelCopilotCommandingHitlStrings.SetConditionalFormattingTemplate.replace("{0}",e)}return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting}if(e.Name.includes("ConditionalRangeFont"))return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting;if(e.Name.includes("ConditionalRangeFill"))return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting;if(e.Name.includes("ConditionalRangeBorder"))return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting;if(e.Name.includes("TextConditionalFormat")||e.Name.includes("ConditionalFormat.ChangeRuleToContainsText"))return this.getTextComparisonDescription(e,t);if(e.Name.includes("CellValueConditionalFormat")){if(e.Name.includes("Rule")&&t&&t.length>0){const e=this.extractArgumentValues(t);return ExcelCopilotCommandingHitlStrings.SetConditionalFormattingTemplate.replace("{0}",e)}return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting}if(e.Name.includes("CustomConditionalFormat"))return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting;if(e.Name.includes("PresetCriteriaConditionalFormat")){if(e.Name.includes("Rule")&&t&&t.length>0){const e=this.extractArgumentValues(t);return ExcelCopilotCommandingHitlStrings.SetConditionalFormattingTemplate.replace("{0}",e)}return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting}if(e.Name.includes("ConditionalFormatRule")){if((e.Name.includes("Formula")||e.Name.includes("FormulaLocal"))&&t&&t.length>0){const e=this.extractArgumentValues(t);return ExcelCopilotCommandingHitlStrings.SetConditionalFormattingFormulaTemplate.replace("{0}",e)}return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting}if(e.Name.includes("ConditionalFormat.SetRanges")){if(t&&t.length>0){const e=this.extractArgumentValues(t);return ExcelCopilotCommandingHitlStrings.SetConditionalFormattingTemplate.replace("{0}",e)}return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting}if(e.Name.includes("ConditionalFormat.Priority"))return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting;if(e.Name.includes("ConditionalFormat.StopIfTrue"))return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting;if(t&&t.length>0){const e=this.extractArgumentValues(t);return ExcelCopilotCommandingHitlStrings.SetConditionalFormattingTemplate.replace("{0}",e)}return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting}static generateCFDescriptionWithFormulasAndValues(e,t){if(e.length>0&&0===t.length)return ExcelCopilotCommandingHitlStrings.SetConditionalFormattingFormulaTemplate.replace("{0}",me.conjoinStrings(e));if(t.length>0||e.length>0){const n=[...t.map((e=>JSON.stringify(e))),...e];return ExcelCopilotCommandingHitlStrings.SetConditionalFormattingTemplate.replace("{0}",me.conjoinStrings(n))}return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting}static getColorScaleDescription(e,t){if(e.Name.includes("Criteria")&&t&&t.length>0){const e=t[0],n=[],a=[];return["minimum","midpoint","maximum"].forEach((t=>{const o=e?.[t];"string"==typeof o?.formula?n.push(o.formula):null!=o?.formula&&a.push(o.formula)})),this.generateCFDescriptionWithFormulasAndValues(n,a)}return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting}static getDataBarDescription(e,t){if((e.Name.includes("LowerBoundRule")||e.Name.includes("UpperBoundRule"))&&t&&t.length>0){const e=t[0],n=[],a=[];return"string"==typeof e?.formula?n.push(e.formula):null!=e?.formula&&a.push(e.formula),this.generateCFDescriptionWithFormulasAndValues(n,a)}return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting}static getIconSetDescription(e,t){if(e.Name.includes("Criteria")&&t&&t.length>0){const n=t[0];if(Array.isArray(n)){const e=[],t=[];for(const a of n)"string"==typeof a.formula?e.push(a.formula):null!=a.formula&&t.push(a.formula);return this.generateCFDescriptionWithFormulasAndValues(e,t)}return this.getFallbackDescription(t,e.Name,ExcelCopilotCommandingHitlStrings.SetConditionalFormatting)}return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting}static getTopBottomDescription(e,t){if((e.Name.includes("Rule")||e.Name.includes("ConditionalFormat.ChangeRuleToTopBottom"))&&t&&t.length>0){const n=t[0],a={[Excel.ConditionalTopBottomCriterionType.bottomItems]:ExcelCopilotCommandingHitlStrings.ConditionalFormattingTopBottomBottomItemsTemplate,[Excel.ConditionalTopBottomCriterionType.bottomPercent]:ExcelCopilotCommandingHitlStrings.ConditionalFormattingTopBottomBottomPercentTemplate,[Excel.ConditionalTopBottomCriterionType.topItems]:ExcelCopilotCommandingHitlStrings.ConditionalFormattingTopBottomTopItemsTemplate,[Excel.ConditionalTopBottomCriterionType.topPercent]:ExcelCopilotCommandingHitlStrings.ConditionalFormattingTopBottomTopPercentTemplate}[n?.type];return a?ExcelCopilotCommandingHitlStrings.SetConditionalFormattingCriteriaTemplate.replace("{0}",a.replace("{0}",n.rank?.toString())):this.getFallbackDescription(t,e.Name,ExcelCopilotCommandingHitlStrings.SetConditionalFormatting)}return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting}static getTextComparisonDescription(e,t){if((e.Name.includes("Rule")||e.Name.includes("ConditionalFormat.ChangeRuleToContainsText"))&&t?.length){const n=t[0],a={[Excel.ConditionalTextOperator.beginsWith]:ExcelCopilotCommandingHitlStrings.ConditionalFormattingTextComparisonBeginsWithTemplate,[Excel.ConditionalTextOperator.contains]:ExcelCopilotCommandingHitlStrings.ConditionalFormattingTextComparisonContainsTemplate,[Excel.ConditionalTextOperator.endsWith]:ExcelCopilotCommandingHitlStrings.ConditionalFormattingTextComparisonEndsWithTemplate,[Excel.ConditionalTextOperator.notContains]:ExcelCopilotCommandingHitlStrings.ConditionalFormattingTextComparisonDoesNotContainTemplate}[n?.operator];return a?ExcelCopilotCommandingHitlStrings.SetConditionalFormattingCriteriaTemplate.replace("{0}",a.replace("{0}",n.text??"")):this.getFallbackDescription(t,e.Name,ExcelCopilotCommandingHitlStrings.SetConditionalFormatting)}return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting}static getFallbackDescription(e,t,n){return o.E.getInstance().updateTelemetryChatEventData({[a.h3.ChatEventType]:a.a5.CommandScratchpadFallbackDescriptionUsed,[a.h3.ChatEventParameters]:t},r.M.getInstance()),e&&e.length>0?"string"==typeof e[0]?ExcelCopilotCommandingHitlStrings.ChangeLeveragingTextTemplate.replace("{0}",this.extractArgumentValues(e)):ExcelCopilotCommandingHitlStrings.ChangeLeveragingValueTemplate.replace("{0}",this.extractArgumentValues(e)):n}static generateHeader(e,t){if(0===e.length)return"";const n=[...e.filter((e=>e.isTextValueChange)).map((e=>e.name)),...e.filter((e=>!e.isTextValueChange)).map((e=>e.name))];let a;if(a=n.length>5?ExcelCopilotCommandingHitlStrings.MultipleCategoriesTemplate.replace("{0}",me.conjoinStrings(n.slice(0,5))):me.conjoinStrings(n),0===t.length)return a;const o=me.conjoinStrings(t);return ExcelCopilotCommandingHitlStrings.HeaderTemplate.replace("{0}",a).replace("{1}",o)}static extractArgumentValues(e){const t=e=>{if(Array.isArray(e)){const n=e.map(t);return`${me.conjoinStrings(n)}`}return"string"==typeof e?`"${e}"`:JSON.stringify(e)},n=e.map(t);return me.conjoinStrings(n)}static getNamedItemDescription(e,t){return"string"==typeof t?ExcelCopilotCommandingHitlStrings.ChangeNamedItemWithFormulaTemplate.replace("{0}",e).replace("{1}",t):ExcelCopilotCommandingHitlStrings.ChangeNamedItemTemplate.replace("{0}",e)}}me.READONLY_API_NAMES=["Range.Select","WorksheetProtection.CheckPassword","Worksheet.Activate","Chart.Activate","Worksheet.FindAllOrNullObject","Worksheet.FindAll","Range.FindOrNullObject","Range.Find","Range._ValidateArraySize","Shape.Activate"]},871038:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",a=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),a&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),a&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,a,o,r){"string"==typeof e&&(e=[[null,e,void 0]]);var i={};if(a)for(var l=0;l<this.length;l++){var s=this[l][0];null!=s&&(i[s]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);a&&i[d[0]]||(void 0!==r&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=r),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),o&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=o):d[4]="".concat(o)),t.push(d))}},t}},875100:(e,t,n)=>{"use strict";n.d(t,{YO:()=>a,q:()=>s,wM:()=>c});var a,o=n(279395),r=n(581389);!function(e){e.None="None",e.Trillions="Trillions",e.Billions="Billions",e.Millions="Millions",e.Thousands="Thousands"}(a||(a={}));const i=10,l=[];function s(e,t,n){if("histogram"===e.series[0].layout)return null;const a=(0,r.r)(e,t,n);return a?c(a.min,a.max):null}function c(e,t){l.length>0||l.push({numericalUnitsValue:1e15,languageUnitsValue:"None",localizedUnitsValue:""},{numericalUnitsValue:1e12,languageUnitsValue:"Trillions",localizedUnitsValue:(0,o.chZ)()},{numericalUnitsValue:1e9,languageUnitsValue:"Billions",localizedUnitsValue:(0,o.omg)()},{numericalUnitsValue:1e6,languageUnitsValue:"Millions",localizedUnitsValue:(0,o.Pjp)()},{numericalUnitsValue:1e3,languageUnitsValue:"Thousands",localizedUnitsValue:(0,o.vLX)()});const n=Math.abs(t)>Math.abs(e)?Math.abs(t):Math.abs(e);for(let e=0;e<l.length;e++)if(n>=l[e].numericalUnitsValue*i)return l[e];return null}},879162:(e,t,n)=>{"use strict";n.d(t,{e:()=>y,z:()=>C});var a=n(57848),o=n(593316),r=n(279395),i=n(75496),l=n(79105),s=n(468967),c=n(347145),d=n(672270),u=n(249443),m=n(851295),g=n(799765),h=n(245965),p=n(508491),b=n(901868),f=n(208520);const C={None:"None",Image:"image",Boolean:"boolean",String:"string",Number:"number",Json:"json",Table:"table",TableWithObjects:"tableWithObjects",Object:"object"};function y(e){const{output:t,outputType:n,tableHasHeader:y}=e,v=(0,p.j)(),[T,x]=(0,f.useState)(!1),[S,w]=(0,f.useState)(!1),E=(0,f.useRef)(null),I=38,R=55,A="vh";(0,f.useEffect)((()=>{const e=()=>{if(E.current){const e=E.current.scrollHeight,t=window.innerHeight;w(e>I/100*t)}},t=setTimeout(e,0);return window.addEventListener("resize",e),()=>{clearTimeout(t),window.removeEventListener("resize",e)}}),[t,n]);const L=(0,f.useMemo)((()=>{const e=(0,u.wP)(),t=(0,u.Xj)(e).palette;return(0,h.l8)({image:{maxWidth:"100%"},jsonPre:{color:t.neutralSecondary,border:`1px solid  ${t.neutralSecondaryAlt}`,borderRadius:"4px",padding:"8px",overflowX:"auto",fontFamily:"monospace",maxHeight:"300px",overflowY:"auto",whiteSpace:"pre-wrap",fontSize:"14px"},tableContainer:{overflowX:"auto",overflowY:"auto",border:`1px solid ${t.neutralSecondaryAlt}`,borderRadius:"8px",width:"100%",maxWidth:"100%",maxHeight:`${R}${A}`,scrollbarWidth:"thin",scrollbarColor:`${t.neutralTertiaryAlt} transparent`,"&::-webkit-scrollbar":{width:"8px",height:"8px"},"&::-webkit-scrollbar-track":{backgroundColor:"transparent"},"&::-webkit-scrollbar-thumb":{backgroundColor:t.neutralTertiaryAlt,borderRadius:"4px",border:"2px solid transparent",backgroundClip:"content-box"},"&::-webkit-scrollbar-thumb:hover":{backgroundColor:t.neutralSecondary},"&::-webkit-scrollbar-corner":{backgroundColor:"transparent"}},table:{borderCollapse:"separate",borderSpacing:"0",width:"auto",minWidth:"100%",position:"relative"},headerCell:{padding:"2px 4px",textAlign:"left",background:"#f8f9fa",borderBottom:`3px solid ${t.neutralSecondaryAlt}`,borderRight:`1px solid ${t.neutralSecondaryAlt}`,whiteSpace:"nowrap",minWidth:"80px",position:"sticky",top:0,zIndex:100,"&::after":{content:'""',position:"absolute",bottom:"-2px",left:0,right:0,height:"4px",backgroundColor:"#f8f9fa",zIndex:99},"&:last-child":{borderRight:"none"}},headerCellRightAligned:{padding:"2px 4px",textAlign:"right",background:"#f8f9fa",borderBottom:`3px solid ${t.neutralSecondaryAlt}`,borderRight:`1px solid ${t.neutralSecondaryAlt}`,whiteSpace:"nowrap",minWidth:"80px",position:"sticky",top:0,zIndex:100,"&::after":{content:'""',position:"absolute",bottom:"-2px",left:0,right:0,height:"4px",backgroundColor:"#f8f9fa",zIndex:99},"&:last-child":{borderRight:"none"}},headerText:{fontWeight:600,color:t.neutralPrimary},tableCell:{padding:"2px 4px",textAlign:"left",color:t.neutralSecondary,borderBottom:`1px solid ${t.neutralSecondaryAlt}`,borderRight:`1px solid ${t.neutralSecondaryAlt}`,minWidth:"80px",maxWidth:"160px","&:last-child":{borderRight:"none"}},tableCellRightAligned:{padding:"2px 4px",textAlign:"right",color:t.neutralSecondary,borderBottom:`1px solid ${t.neutralSecondaryAlt}`,borderRight:`1px solid ${t.neutralSecondaryAlt}`,minWidth:"80px",maxWidth:"160px","&:last-child":{borderRight:"none"}},outputLabel:{fontWeight:600},stringOutput:{color:t.themeSecondary,whiteSpace:"pre-wrap",overflow:"visible",textOverflow:"clip",display:"block",wordBreak:"break-word",maxWidth:"100%"},expandButtonContainer:{textAlign:"left",margin:"3px 0"},tableToggleButtonStyle:{color:t.neutralSecondary,paddingLeft:"2px !important",marginLeft:"4px !important","&:hover":{color:t.neutralSecondary,paddingLeft:"2px",marginLeft:"4px"},"&:hover:active":{color:t.neutralPrimary,paddingLeft:"2px",marginLeft:"4px"},"@media (forced-colors: active)":{"> span":{color:"inherit","> svg":{color:"inherit"}}}},lastRowCell:{padding:"2px 4px",textAlign:"left",color:t.neutralSecondary,borderRight:`1px solid ${t.neutralSecondaryAlt}`,minWidth:"80px","&:first-child":{borderBottomLeftRadius:"7px"},"&:last-child":{borderRight:"none",borderBottomRightRadius:"7px"}},lastRowCellRightAligned:{padding:"2px 4px",textAlign:"right",color:t.neutralSecondary,borderRight:`1px solid ${t.neutralSecondaryAlt}`,minWidth:"80px","&:first-child":{borderBottomLeftRadius:"7px"},"&:last-child":{borderRight:"none",borderBottomRightRadius:"7px"}}})}),[u.wP,u.Xj]);let k=f.createElement("div",null,t);const F=(0,m.xt)();switch(n){case C.Image:{let e,a;try{e=JSON.parse("string"==typeof t?t:"{}").base64_data}catch(e){const t=(0,s.Wx)((0,s.MQ)(e,"RenderModelessOutput"),e);(0,s.QX)(v,t,!1);break}if((0,c.g6K)()&&(a=JSON.parse("string"==typeof t?t:"{}").chart_json),a){const e=JSON.parse("string"==typeof t?t:"{}"),n={chartId:(0,d.RE)(e.title,e.summary),inputChartSchema:a};k=f.createElement(o.e,n)}else{const t=n||"png";k=f.createElement("img",{src:`data:image/${t};base64,${e}`,alt:"Data visualization",className:L.image}),(0,c.g6K)()&&(0,g.PB)(i.L3.StaticChartRendered,[])}break}case C.Boolean:case C.Number:case C.String:k=f.createElement("div",{className:L.stringOutput},String(t).replace(/^"|"$|\\"/g,""));break;case C.Json:try{const e=JSON.parse("string"==typeof t?t:"{}"),n=JSON.stringify(e,null,2),a=e=>e.replace(/"([^"\\]*(\\.[^"\\]*)*)"/g,((e,t)=>e.match(/"[^"]*":/g)?e:t.replace(/\\"/g,'"').replace(/\\\\/g,"\\"))),o=a(n);k=f.createElement("pre",{className:L.jsonPre},o)}catch(e){const t=(0,s.Qi)((0,s.MQ)(e,"RenderModelessOutput"),e);(0,s.QX)(v,t,!1)}break;case C.Table:case C.TableWithObjects:try{const e=(0,c.yw9)("OfficeVSO_10196331_Handle_Table_With_Objects_Edge_Case")?t:JSON.parse("string"==typeof t?t:"[]"),n=(e,t,n)=>(0,c.yw9)("OfficeVSO_10325780_NumbersRightAligned")&&(0,b.C)(e)||F?t===n-1?L.lastRowCellRightAligned:L.tableCellRightAligned:t===n-1?L.lastRowCell:L.tableCell;if(Array.isArray(e)&&e.length>0&&Array.isArray(e[0])){const t=y??!0;let o=[],i=[];t?(o=e[0],i=e.slice(1)):i=e,k=f.createElement("div",null,f.createElement("div",{ref:E,className:L.tableContainer,style:{maxHeight:T?`${R}${A}`:`${I}${A}`}},f.createElement("table",{className:L.table},t&&f.createElement("thead",null,f.createElement("tr",null,o.map(((e,t)=>f.createElement("th",{key:t,className:F?L.headerCellRightAligned:L.headerCell},f.createElement("span",{className:L.headerText},e)))))),f.createElement("tbody",null,i.map(((e,t)=>f.createElement("tr",{key:t},e.map(((e,a)=>f.createElement("td",{key:a,className:n(e,t,i.length)},String(e)))))))))),S&&f.createElement("div",{className:L.expandButtonContainer},f.createElement(l.f,{checked:T,size:"small",appearance:"transparent",iconPosition:"after",onClick:()=>x(!T),className:L.tableToggleButtonStyle,icon:T?f.createElement(a.g4$,{className:L.tableToggleButtonStyle}):f.createElement(a.rLf,{className:L.tableToggleButtonStyle})},f.createElement("span",{className:L.tableToggleButtonStyle},T?(0,r.EB5)():(0,r.PHI)()))))}}catch(e){const t=(0,s.pz)((0,s.MQ)(e,"RenderModelessOutput"),e);(0,s.QX)(v,t,!1)}break;case C.None:k=f.createElement("div",null)}try{return f.createElement("div",null,k)}catch{return f.createElement("div",null)}}},881608:(e,t,n)=>{"use strict";n.d(t,{A:()=>h});var a=n(72331),o=n(454592),r=n(279395),i=n(738648),l=n(972424),s=n(446751),c=n(659126),d=n(347145),u=n(20847),m=n(208520);function g(e,t,n){const a=(0,s.iM)(e)?t?(0,c.hU)(e)?n?(0,d.ZAR)()?"RecommendationSuggestionHeaderGroundedWithSheet":"RecommendationSuggestionHeaderGrounded":"RecommendationAnotherSuggestionHeader":(0,d.ZAR)()?"RecommendationSuggestionMultipleColumnsHeaderGroundedWithSheet":"RecommendationSuggestionMultipleColumnsHeaderGrounded":(0,c.hU)(e)?n?"RecommendationSuggestionHeader":"RecommendationAnotherSuggestionHeader":"RecommendationSuggestionMultipleColumnsHeader":t?(0,d.ZAR)()?"RecommendationFormulaSuggestionHeaderGroundedWithSheet":"RecommendationFormulaSuggestionHeaderGrounded":null;return null===a?(0,r.SHb)():r.olU[a]}const h=({recommendation:e,targetAddress:t,targetSheet:n,isMainRecommendation:o,columnLetters:r,rowNumber:c})=>(0,s.iM)(e)&&r&&t&&n?m.createElement(b,{recommendation:e,targetAddress:t,columnLetters:r,sheetName:n}):(0,s.cY)(e)&&r&&c&&t&&n?m.createElement(p,{recommendation:e,targetAddress:t,columnLetters:r,rowNumber:c,sheetName:n}):m.createElement(a.c,null,m.createElement(i.sA,{message:g(e,t,o),values:{range:t?(0,l.r)(t):"",columnLength:e.calculatedFormulas.length,sheet:n||(t?(0,l.w)(t):"")}})),p=({recommendation:e,targetAddress:t,columnLetters:n,rowNumber:s,sheetName:u})=>{const g=(0,c.Z)(e),h=(0,c.XZ)(e),p=(0,c.th)(e),b=(0,l.r)(t),f=e.calculatedFormulas.reduce(((e,t)=>e+(t.insertionIndexes?.length??0)),0),C=e.allowReplacementOfExistingValue;let y,v;(0,c.By)(e)?(v={cellAddress:e.calculatedFormulas[0].fixedInsertionRange},y="CalculatedRowsCellHeader"):(y=g?"CalculatedRowsCellHeader":"CalculatedRowsRowHeader",v=g?{cellAddress:n[0]+s.toString()}:{rowNumber:s.toString()});const T=h?C?(0,d.ZAR)()?"CalculatedRowsFormulaSuggestionHeaderUpdateSingularWithSheet":"CalculatedRowsFormulaSuggestionHeaderUpdateSingular":(0,d.ZAR)()?"CalculatedRowsFormulaSuggestionHeaderSingularWithSheet":"CalculatedRowsFormulaSuggestionHeaderSingular":C?(0,d.ZAR)()?"CalculatedRowsFormulaSuggestionHeaderUpdatePluralWithSheet":"CalculatedRowsFormulaSuggestionHeaderUpdatePlural":(0,d.ZAR)()?"CalculatedRowsFormulaSuggestionHeaderPluralWithSheet":"CalculatedRowsFormulaSuggestionHeaderPlural";return m.createElement(a.c,null,m.createElement(i.sA,{message:r.olU[T],values:{tableRange:m.createElement(o.V,null,b),sheet:u,location:p?r.olU.CalculatedRowsSelectedCellHeader:m.createElement(o.V,null,m.createElement(i.sA,{message:r.olU[y],values:v})),formulasLength:f}}))},b=({recommendation:e,targetAddress:t,columnLetters:n,sheetName:s})=>{const g=(0,c.hU)(e),h=(0,l.r)(t),p=g?m.createElement(i.sA,{message:r.olU.FormulaSuggestion_Header_Singular_Location,values:{columnLetter:n[0]}}):m.createElement(i.sA,{message:r.olU.FormulaSuggestion_Header_Plural_Location,values:{columnLetters:(0,u.q)(n)}});let b="";return b=(0,d.ZAR)()?g?r.olU.FormulaSuggestion_Header_SingularWithSheet:r.olU.FormulaSuggestion_Header_PluralWithSheet:g?r.olU.FormulaSuggestion_Header_Singular:r.olU.FormulaSuggestion_Header_Plural,m.createElement(a.c,null,g?m.createElement(i.sA,{message:b,values:{tableRange:m.createElement(o.V,null,h),location:m.createElement(o.V,null,p),sheet:s}}):m.createElement(i.sA,{message:b,values:{tableRange:m.createElement(o.V,null,h),location:m.createElement(o.V,null,p),columnLength:e.calculatedFormulas.length,sheet:s}}))}},881707:(e,t,n)=>{"use strict";n.d(t,{n:()=>f});var a=n(822606),o=n(116510),r=n(355908),i=n(660606),l=n(638753),s=n(423905),c=n(507628),d=n(755657),u=n(241273),m=function(){return m=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},m.apply(this,arguments)},g=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{s(a.next(e))}catch(e){r(e)}}function l(e){try{s(a.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((a=a.apply(e,t||[])).next())}))},h=function(e,t){var n,a,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(n=1,a&&(o=2&l[0]?a.return:l[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,l[1])).done)return o;switch(a=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,a=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],a=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},p=null,b=(0,c.A)(),f=function(){function e(){this.labelChangedFromChatHistory=!1,this.inDocLabelInfo={labelId:a.u1,tenantId:a.u1},this.externalDocLabelInfo={labelId:a.u1,tenantId:a.u1},this.inDocLabelInfo.labelId=a.u1,this.inDocLabelInfo.tenantId=a.u1,this.externalDocLabelInfo.labelId=a.u1,this.externalDocLabelInfo.tenantId=a.u1}return e.getInstance=function(t,n,a,o,r){return(0,l.hX)(e.clpSensitivityHandler)&&(e.clpSensitivityHandler=new e),(0,l.hX)(t)||(e.clpSensitivityHandler.setBasicChatProps=t),(0,l.hX)(n)||(e.clpSensitivityHandler.setChatUiProps=n),(0,l.hX)(a)||(e.clpSensitivityHandler.copilotChatRef=a),(0,l.hX)(o)||(e.clpSensitivityHandler.removeCurrentContextId=o),(0,l.hX)(r)||(e.clpSensitivityHandler.getShouldStopLoadingUi=r),e.clpSensitivityHandler},e.prototype.setInDocSensitiveLabelInfoUsingOfcJs=function(){return g(this,void 0,void 0,(function(){var e,t,n;return h(this,(function(a){switch(a.label){case 0:if(null===(n=i.t6.IsCopilotInBackstageMode)||void 0===n?void 0:n.call(i.t6))return[2];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getLabel()];case 2:return e=a.sent(),this.setInDocSensitivityLabelInfo(e),(0,s.Zy)("setInDocSensitiveLabelInfoUsingOfcJs"),[3,4];case 3:return t=a.sent(),(0,s.mQ)("error in getLabel Api: ".concat(t.message),t.code,t.stack),(0,d.Uk)(this.copilotChatRef,t.code,u.OZ.CLP_Get,this.removeCurrentContextId),(0,i.cY)("Error while fetching and setting In Doc sensitivity label: ".concat(t.message,", error code: ").concat(t.code)),[3,4];case 4:return[2]}}))}))},e.prototype.getInDocSensitiveLabelUsingOfcJs=function(){return g(this,void 0,void 0,(function(){var e,t,n;return h(this,(function(o){switch(o.label){case 0:if((0,i.cY)("Getting label"),e={labelId:a.u1,tenantId:a.u1},null===(n=i.t6.IsCopilotInBackstageMode)||void 0===n?void 0:n.call(i.t6))return[2,e];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getLabel()];case 2:return e=o.sent(),(0,s.Zy)("getLabel"),[3,4];case 3:return t=o.sent(),(0,s.mQ)("error in getLabel Api : ".concat(t.message),t.code,t.stack),(0,d.Uk)(this.copilotChatRef,t.code,u.OZ.CLP_Get,this.removeCurrentContextId),(0,i.cY)("Error while fetching In Doc sensitivity label: ".concat(t.message,", error code: ").concat(t.code)),[3,4];case 4:return(0,i.cY)("Label is : ",e),[2,e]}}))}))},e.prototype.setInDocSensitivityLabelInfo=function(e){var t=this;(0,i.cY)("setting InDoc Sensitivity Label Info: ".concat(JSON.stringify(e))),this.inDocLabelInfo.version=e.version,this.inDocLabelInfo.labelId=e.labelId,this.inDocLabelInfo.tenantId=e.tenantId,this.inDocLabelInfo.isEnabled=e.isEnabled,this.inDocLabelInfo.encryptionType=e.encryptionType,this.inDocLabelInfo.isDke=e.isDke,this.inDocLabelInfo.hasExtractForUser=e.hasExtractForUser,this.inDocLabelInfo.order=e.order,this.inDocLabelInfo.displayName=e.displayName,this.inDocLabelInfo.description=e.description,this.inDocLabelInfo.parentName=e.parentName,this.inDocLabelInfo.color=e.color,this.setBasicChatProps&&this.setBasicChatProps((function(n){var a,i;return m(m({},n),{sensitivityIndicatorData:t.shouldShowInDocSensitivityLabel()?{tooltipText:null!==(a=e.description)&&void 0!==a?a:"",badgeText:null!==(i=e.displayName)&&void 0!==i?i:"",iconType:e.encryptionType!==o.T.None?r.JF.Encryption:r.JF.NonEncryption}:void 0})})),this.setChatUiProps&&this.shouldShowInDocSensitivityLabel()&&this.setChatUiProps((function(e){return m(m({},e),{documentSensitivityProps:t.getSensitivity()})}))},e.prototype.updateSdxSensitiveLabelFromChatHistory=function(e){return g(this,void 0,void 0,(function(){var t;return h(this,(function(n){switch(n.label){case 0:return e&&0!==e.length?(t=e.map((function(e){return{labelId:e,tenantId:a.u1}})),this.labelChangedFromChatHistory?[4,this.setInDocSensitiveLabelInfoUsingOfcJs()]:[3,2]):((0,i.cY)("ClpSensitivityHandler: No labelIds passed to updateSdxSensitiveLabelFromChatHistory"),[2,"No labelIds passed to updateSdxSensitiveLabelFromChatHistory"]);case 1:n.sent(),this.labelChangedFromChatHistory=!1,n.label=2;case 2:return 1===t.length&&this.inDocLabelInfo.labelId===t[0].labelId?((0,i.cY)("ClpSensitivityHandler: No update required as labelId is same as current labelId"),[2,"No update required as labelId is same as current labelId. label:"+this.inDocLabelInfo.displayName]):(t.push(this.inDocLabelInfo),[4,this.setSensitivityLabelToHighestSensitivity(t)]);case 3:return n.sent(),this.labelChangedFromChatHistory=!0,[2,"Updated label to ".concat(this.inDocLabelInfo.displayName)]}}))}))},e.prototype.upgradeSensitivityLabelUsingOfcJs=function(e){return g(this,arguments,void 0,(function(e,t){var n,r,l,c,m,f,C,y,v=this;return void 0===t&&(t=!1),h(this,(function(T){switch(T.label){case 0:if((0,s.Zy)("tryUpgradeLabel"),!(null==e?void 0:e.labelId)||t&&!function(e){var t,n=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/;return null!=(null===(t=e.labelId)||void 0===t?void 0:t.match(n))}(e))return(0,i.cY)("Invalid label",e),(0,s.mQ)("Invalid label format id: ".concat(e.labelId),o.q[o.q.E_APPLYLABEL_FAIL],""),[2,{status:o.q[o.q.E_APPLYLABEL_FAIL],errorMessage:"Invalid label format"}];if(null===(C=i.t6.IsCopilotInBackstageMode)||void 0===C?void 0:C.call(i.t6))return(0,i.cY)("Upgrading sensitivity label disabled in backstage mode"),[2,{status:o.q[o.q.E_APPLYLABEL_FAIL],errorMessage:"disabled in backstage mode"}];(0,i.cY)("Upgrading sensitivity label: ".concat(JSON.stringify(e))),n=o.q[o.q.S_APPLYLABEL_OK],r=a.u1,T.label=1;case 1:return T.trys.push([1,6,,7]),this.inDocLabelInfo.tenantId!==e.tenantId||this.inDocLabelInfo.labelId!==e.labelId?[3,3]:[4,OfficeFirstParty.Sensitivity.tryUpgradeLabel(e,b)];case 2:return T.sent(),[2,{status:o.q[o.q.S_APPLYLABEL_OK]}];case 3:return l=function(){return g(v,void 0,void 0,(function(){return h(this,(function(t){try{return[2,OfficeFirstParty.Sensitivity.tryUpgradeLabel(e,b)]}catch(e){(0,s.mQ)("error while calling tryUpgradeLabel() Api : ".concat(e.message),e.code,e.stack),r=(0,d.Uk)(this.copilotChatRef,e.code,u.OZ.CLP_Upgrade,this.removeCurrentContextId),(0,i.cY)("Error while upgrading sensitivity label: ".concat(e.message,", error code: ").concat(e.code)),n=e.message}return[2]}))}))},c=new Promise((function(e){p=e})),m=new Promise((function(e,t){var n=a.qO;setTimeout((function(){return t(new Error("CallbackTimeout"))}),n)})),[4,Promise.race([Promise.all([c,l()]),m])];case 4:T.sent(),T.label=5;case 5:return[3,7];case 6:return f=T.sent(),(0,s.mQ)("Exception while waiting for tryUpgradeLabel() and Callback completion: ".concat(f.message),f.code,f.stack),(0,d.Uk)(this.copilotChatRef,f.code,u.OZ.CLP_Upgrade,this.removeCurrentContextId),"CallbackTimeout"===f.message?(0,i.cY)("Callback Timeout"):(0,i.cY)("Exception while upgrading sensitivity label: ".concat(f.message,", error code: ").concat(f.code)),n=null!==(y=o.q[f.message])&&void 0!==y?y:f.message,[3,7];case 7:return p=null,[2,{status:n,errorMessage:r}]}}))}))},e.prototype.setLabelChangeEventListener=function(e){var t;if(null===(t=i.t6.IsCopilotInBackstageMode)||void 0===t?void 0:t.call(i.t6))(0,i.cY)("setting label change EventListener disabled in backstage mode");else try{OfficeFirstParty.Sensitivity.onLabelChangedEvent(null!=e?e:C),(0,s.Zy)("Label Change Event Listener"),(0,i.cY)("Sensitivity Label Change Event Listener Set")}catch(e){(0,s.mQ)("error in setting listener for CLP : ".concat(e.message),e.code,e.stack),(0,d.Uk)(this.copilotChatRef,e.code,u.OZ.CLP_Upgrade,this.removeCurrentContextId),(0,i.cY)("Error while setting sensitivity label change event listener: ".concat(e.message,", error code: ").concat(e.code))}},e.prototype.updateExternalDocSensitivityLabelUsingOfsJs=function(e){return g(this,void 0,void 0,(function(){var t,n,a;return h(this,(function(o){switch(o.label){case 0:if(null===(a=i.t6.IsCopilotInBackstageMode)||void 0===a?void 0:a.call(i.t6))return(0,i.cY)("update external doc sensitivity label disabled in backstage mode"),[2];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getHighestSensitivityLabel(e)];case 2:return t=o.sent(),(0,i.cY)("External Doc Sensitivity Label Fetched: ".concat(JSON.stringify(t))),this.setExternalDocSensitivityLabelInfo(t),(0,s.Zy)("External Doc HighestSensitivityLabel"),[3,4];case 3:return n=o.sent(),(0,s.mQ)("error in HighestSensitivityLabel Api : ".concat(n.message),n.code,n.stack),(0,d.Uk)(this.copilotChatRef,n.code,u.OZ.CLP_Get,this.removeCurrentContextId),(0,i.cY)("Error while updating external doc sensitivity label: ".concat(n.message,", error code: ").concat(n.code)),[3,4];case 4:return[2]}}))}))},e.prototype.isSensitivityHigherThanDoc=function(e){return g(this,void 0,void 0,(function(){return h(this,(function(t){switch(t.label){case 0:return(null==e?void 0:e.labelId)?e.labelId===this.inDocLabelInfo.labelId?[2,Promise.resolve(!1)]:[4,this.getHighestDocumentSensitivityInfo([e,this.inDocLabelInfo])]:[2,Promise.resolve(!1)];case 1:return[2,t.sent().labelId!==this.inDocLabelInfo.labelId]}}))}))},e.prototype.getHighestDocumentSensitivityInfo=function(e){return g(this,void 0,void 0,(function(){var t,n,o;return h(this,(function(r){switch(r.label){case 0:if(t={labelId:a.u1,tenantId:a.u1},null===(o=i.t6.IsCopilotInBackstageMode)||void 0===o?void 0:o.call(i.t6))return(0,i.cY)("getHighestDocumentSensitivityInfo disabled in backstage mode"),[2,t];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getHighestSensitivityLabel(e)];case 2:return t=r.sent(),(0,i.cY)("Sensitivity info fetched for label ".concat(JSON.stringify(e),": ").concat(JSON.stringify(t))),(0,s.Zy)("HighestSensitivityLabel"),[3,4];case 3:return n=r.sent(),(0,s.mQ)("error in HighestSensitivityLabel Api : ".concat(n.message),n.code,n.stack),(0,d.Uk)(this.copilotChatRef,n.code,u.OZ.CLP_Get,this.removeCurrentContextId),(0,i.cY)("Error while fetching highest sensitivity label: ".concat(n.message,", error code: ").concat(n.code)),[3,4];case 4:return[2,t]}}))}))},e.prototype.setSensitivityLabelToHighestSensitivity=function(e){return g(this,void 0,void 0,(function(){var t;return h(this,(function(n){switch(n.label){case 0:return[4,this.getHighestDocumentSensitivityInfo(e)];case 1:return t=n.sent(),this.setInDocSensitivityLabelInfo(t),[2]}}))}))},e.prototype.getSensitivity=function(){var e,t;return{id:this.inDocLabelInfo.labelId,displayName:null!==(e=this.inDocLabelInfo.displayName)&&void 0!==e?e:"",tooltip:this.inDocLabelInfo.description,color:this.inDocLabelInfo.color,isEncrypted:this.inDocLabelInfo.encryptionType!==o.T.None,priority:null!==(t=this.inDocLabelInfo.order)&&void 0!==t?t:0}},e.prototype.setExternalDocSensitivityLabelInfo=function(e){(0,i.cY)("setting External Doc Sensitivity Label Info: ".concat(JSON.stringify(e))),this.externalDocLabelInfo.version=e.version,this.externalDocLabelInfo.labelId=e.labelId,this.externalDocLabelInfo.tenantId=e.tenantId,this.externalDocLabelInfo.isEnabled=e.isEnabled,this.externalDocLabelInfo.encryptionType=e.encryptionType,this.externalDocLabelInfo.isDke=e.isDke,this.externalDocLabelInfo.hasExtractForUser=e.hasExtractForUser,this.externalDocLabelInfo.order=e.order,this.externalDocLabelInfo.displayName=e.displayName,this.externalDocLabelInfo.description=e.description,this.externalDocLabelInfo.parentName=e.parentName,this.externalDocLabelInfo.color=e.color},e.prototype.getInDocSensitiveLabelInfo=function(){return this.inDocLabelInfo},e.prototype.getExternalDocSensitivityLabelInfo=function(){return this.externalDocLabelInfo},e.prototype.shouldShowExternalDocSensitivityLabel=function(){return(0,s.Zy)("Empty External Doc Label : ".concat(this.inDocLabelInfo.labelId===a.u1)),this.externalDocLabelInfo.labelId!==a.u1&&i.t6.IsUserTypeEnterprise()},e.prototype.shouldShowInDocSensitivityLabel=function(){return(0,s.Zy)("Empty In Doc Label : ".concat(this.inDocLabelInfo.labelId===a.u1)),this.inDocLabelInfo.labelId!==a.u1&&i.t6.IsUserTypeEnterprise()},e.prototype.isInDocSensitivityLabelEncrypted=function(){return this.inDocLabelInfo.encryptionType!==o.T.None},e.prototype.isExternalDocSensitivityLabelEncrypted=function(){return this.externalDocLabelInfo.encryptionType!==o.T.None},e}();function C(e,t,n,a){return g(this,void 0,void 0,(function(){return h(this,(function(r){switch(r.label){case 0:return(0,i.cY)("Sensitivity Label Change Event: ".concat(JSON.stringify(e)," to ").concat(JSON.stringify(t),", context:  ").concat(n,", error: ").concat(a)),(0,s.Zy)("Label change callback received, context:  ".concat(n)),p&&n===b&&(p("ignore"),p=null),a!==o.q.S_APPLYLABEL_OK?((0,s.mQ)("error in upgrading label : ".concat(a),a.code,a.stack),[2]):i.t6.IsClpEnabledInEnterpriseForSydney()&&(f.getInstance().getInDocSensitiveLabelInfo().labelId||t.labelId)?[4,f.getInstance().setSensitivityLabelToHighestSensitivity([f.getInstance().getInDocSensitiveLabelInfo(),t])]:[3,2];case 1:return r.sent(),[2];case 2:return i.t6.IsApplyLabelUsingTryUpgradeLabelEnabled(),f.getInstance().setInDocSensitivityLabelInfo(t),[2]}}))}))}},882329:(e,t,n)=>{"use strict";n.d(t,{EH:()=>v,IN:()=>x,Nd:()=>p,dS:()=>d,js:()=>T,x3:()=>h});var a=n(75496),o=n(616166),r=n(83437),i=n(316904),l=n(982306),s=n(347145);const c=9,d="https://fa000000124.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.2.2305.23018/en-us_web/login.html",u=1e4;let m;async function g(){const e=Office.context.document.settings.get("LicensedIdentities");if(e){const t=await OfficeFirstPartyAuth.getIdentities();if(m=t.find((({uniqueId:t})=>e.some((e=>e===t)))),!m)throw new Error(`No logged in licensed identities found. Licensed identities found: ${e?.length}. Logged in identities: ${t.length}`)}else m=await OfficeFirstPartyAuth.getPrimaryIdentityInfo()}Office.onReady((()=>{OfficeFirstPartyAuth.supportsOauthManager=!0}));const h=()=>{let e=d;return(0,s.Hvn)()&&window.location.hostname.toLowerCase().includes("officeapps.live.com")&&(e="https://fa000000124.officeapps.live.com/mro1cdnstorage/f7024bdc-7caf-4ca8-807d-2908f09640d6/sdx/fa000000124/1.2.2507.9016/en-us_web/login.html"),new URL(e).pathname};async function p(){try{await(0,l.j)(Promise.all([OfficeFirstPartyAuth.load(d),g()]),(0,s.Z8j)("Microsoft.Office.Excel.FA000000124.AuthTimeout",u))}catch(e){throw i.M.getInstance().logErrorCode(o.O.LoadAuthError,e,a.S2.AuthError,r.$b.Error),e}}const b="79d1f229-c1e5-4bd5-b2fd-4764b025b103",f=`${b}/.default`,C="DELEGATED";async function y(e){let t,n;if(!m)throw i.M.getInstance().logError({eventType:a.S2.AuthError,errorMessage:"Attempted to authenticate with no logged in licensed identity",logLevel:r.$b.Error}),new Error("Attempted to authenticate with no logged in licensed identity");const l=m.identityType;if("Unsupported"===l)throw i.M.getInstance().logError({eventType:a.S2.AuthError,errorMessage:"Unsupported identity type",logLevel:r.$b.Error},void 0,[{key:a.Wg.FetchType,value:e}]),new Error("Unsupported identity type");for(let s=0;s<=c;s++)try{return(await OfficeFirstPartyAuth.getAccessToken({resource:b,scope:"MicrosoftAccount"===l?f:void 0,policy:"MicrosoftAccount"===l?C:void 0,identityUniqueId:m.uniqueId,appName:"OAuthManager"===e?"OfficeInsightsServices":void 0},{popup:"Popup"===e})).accessToken}catch(l){const s=l instanceof OfficeExtension.Error?l.code:void 0,c="login_required"===s?r.$b.ASHA:"invalid_resource"===s?r.$b.Error:r.$b.Warning;if(i.M.getInstance().logErrorCode(o.O.AuthError,l,a.S2.AuthError,c,{key:a.Wg.FetchType,value:e}),"invalid_resource"!==s)throw l;t=l,n=s}throw i.M.getInstance().logError({eventType:a.S2.AuthError,errorMessage:`Ran out of retries while authenticating. Last error encountered: ${n??"Unknown"}`,logLevel:r.$b.Error},void 0,[{key:a.Wg.FetchType,value:e}]),t}async function v(){try{return await y("OAuthManager")}catch{return!1}}async function T(){try{return await y("Silent")}catch(e){if("login_required"===e.code)return!1;throw e}}async function x(){try{return await y("Popup")}catch{return!1}}},886492:(e,t)=>{"use strict";function n(e,t,n,a){switch(e){case 0:return t&n^~t&a;case 1:case 3:return t^n^a;case 2:return t&n^t&a^n&a}}function a(e,t){return e<<t|e>>>32-t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=[1518500249,1859775393,2400959708,3395469782],o=[1732584193,4023233417,2562383102,271733878,3285377520],r=new Uint8Array(e.length+1);r.set(e),r[e.length]=128;const i=(e=r).length/4+2,l=Math.ceil(i/16),s=new Array(l);for(let t=0;t<l;++t){const n=new Uint32Array(16);for(let a=0;a<16;++a)n[a]=e[64*t+4*a]<<24|e[64*t+4*a+1]<<16|e[64*t+4*a+2]<<8|e[64*t+4*a+3];s[t]=n}s[l-1][14]=8*(e.length-1)/Math.pow(2,32),s[l-1][14]=Math.floor(s[l-1][14]),s[l-1][15]=8*(e.length-1)&4294967295;for(let e=0;e<l;++e){const r=new Uint32Array(80);for(let t=0;t<16;++t)r[t]=s[e][t];for(let e=16;e<80;++e)r[e]=a(r[e-3]^r[e-8]^r[e-14]^r[e-16],1);let i=o[0],l=o[1],c=o[2],d=o[3],u=o[4];for(let e=0;e<80;++e){const o=Math.floor(e/20),s=a(i,5)+n(o,l,c,d)+u+t[o]+r[e]>>>0;u=d,d=c,c=a(l,30)>>>0,l=i,i=s}o[0]=o[0]+i>>>0,o[1]=o[1]+l>>>0,o[2]=o[2]+c>>>0,o[3]=o[3]+d>>>0,o[4]=o[4]+u>>>0}return Uint8Array.of(o[0]>>24,o[0]>>16,o[0]>>8,o[0],o[1]>>24,o[1]>>16,o[1]>>8,o[1],o[2]>>24,o[2]>>16,o[2]>>8,o[2],o[3]>>24,o[3]>>16,o[3]>>8,o[3],o[4]>>24,o[4]>>16,o[4]>>8,o[4])}},891693:(e,t,n)=>{"use strict";n.d(t,{f:()=>f,O:()=>C});var a=n(870180),o=n(279395),r=n(312422),i=n(92520);class l{reset(){this.batchProcessors=[],this.apiCalls=[]}tryCollectBatchesAndHitlDescription(e){return!!this.appendApiCalls(e)&&(this.batchProcessors.push(e),!0)}async applyLastBatches(){if(0===this.batchProcessors.length)return{success:!1,errorMessage:"No batch processors available to apply"};try{await(0,r.$r)((0,o.Eyh)())}catch(e){return{success:!1,errorMessage:"Error opening undoscope: "+JSON.stringify(e)}}try{const e=this.batchProcessors[this.batchProcessors.length-1];await e.applyBatches(),await(0,r.TA)()}catch(e){try{await(0,r.TA)({rollback:!0})}catch(e){return{success:!1,errorMessage:"Error closing undo scope and undoing changes: "+JSON.stringify(e)}}return{success:!1,errorMessage:"Error applying changes: "+JSON.stringify(e)}}return{success:!0}}async applyAllBatches(){try{await(0,r.$r)((0,o.Eyh)())}catch(e){return{success:!1,errorMessage:`Error opening undoscope: ${e}`}}try{for(const e of this.batchProcessors)await e.applyBatches();await(0,r.TA)()}catch(e){try{await(0,r.TA)({rollback:!0})}catch(e){return{success:!1,errorMessage:"Error closing undo scope and undoing changes: "+JSON.stringify(e)}}return{success:!1,errorMessage:"Error applying changes: "+JSON.stringify(e)}}return{success:!0}}getHitlDescription(){return a.i.generateDescription(this.apiCalls)}appendApiCalls(e){const t=e.getApiCalls();return(0,i.cY)("[1mAPI Call Summary:[0m",JSON.stringify(t)),0!==t.length&&(this.apiCalls.push(...t),!0)}constructor(){this.batchProcessors=[],this.apiCalls=[]}}var s=n(83437),c=n(698013),d=n(468827),u=n(75496),m=n(316904),g=n(314793),h=n(883),p=n(347145),b=n(110686);class f extends Error{constructor(e){super(e),this.name="ExecuteOfficeJsRawError"}}class C{createSystemErrorExecutionResult(e){return m.M.getInstance().logError({eventType:u.S2.ChatEvents,errorMessage:e??"createSystemErrorExecutionResult: Unknown error",logLevel:s.$b.Error}),{success:!1,result:e?{error:e}:{},documentChanges:"",apiDescriptionHeader:"",apiDescriptions:[]}}clearChangeCollectors(){this.changeCollectors.clear()}clearChangeCollectorForCaller(e){this.changeCollectors.delete(e)}addOrResetChangeCollector(e){this.changeCollectors.has(e)?this.changeCollectors.get(e)?.reset():this.changeCollectors.set(e,new l)}async executeScript(e,t){this.changeCollectors.has(t)||this.changeCollectors.set(t,new l);const n=this.changeCollectors.get(t);if(!n)return(0,h.debuglog)(`Cannot start change collector for: ${t}`),this.createSystemErrorExecutionResult(`Cannot start change collector for: ${t}`);let o;const r=new c.p(this.dataLocale,t);try{const i=await this.wrapRawOfficeJsScript(e);await this.runtimeHelper.prepareCustomParams(i,void 0,r?.makeBatchHandler());const l=await this.runScriptWithTimeoutAsync(this.runtimeHelper);o=this.decodeScriptResponse(l);if((n.tryCollectBatchesAndHitlDescription(r)||!(0,p.yw9)("OfficeVSO_10497180_directApplyAfterCollection"))&&(0,p.iPS)("Microsoft.Office.Excel.FA000000124.DirectApplyExcelAgentChanges",!1)&&"excelAgent"===t){const e=await n.applyLastBatches();if(!e.success)return(0,h.debuglog)(`Error applying last batch: ${e.errorMessage}`),this.createSystemErrorExecutionResult(`Error applying last batch: ${e.errorMessage}`)}const s=n.getHitlDescription();return{success:!0,result:{response:o},documentChanges:JSON.stringify(a.i.generateDocumentChanges(r.getApiCalls())),apiDescriptionHeader:s.header,apiDescriptions:s.descriptions}}catch(e){return(0,h.debuglog)(`Error executing script: ${e}`),e instanceof f?{success:!0,result:{error:e.message},documentChanges:"",apiDescriptionHeader:"",apiDescriptions:[]}:this.createSystemErrorExecutionResult("Unexpected catastrophic error during script execution")}}async applyAllBatches(e){const t=this.changeCollectors.get(e);return t?await t.applyAllBatches():{success:!1,errorMessage:`No change collector found for: ${e}`}}decodeScriptResponse(e){if("string"==typeof e||void 0===e)return e;if("object"==typeof e&&!Array.isArray(e)&&null!==e&&"error"in e){const t=JSON.stringify(e.error);throw m.M.getInstance().logError({eventType:u.S2.ChatEvents,errorMessage:JSON.stringify(e.error),logLevel:s.$b.Error}),new f(t)}return JSON.stringify(e,((e,t)=>void 0===t?null:t))}async runScriptWithTimeoutAsync(e){let[t,n]=this.makeCancelableTimer();return t=t.catch((t=>{throw e.terminateCurrentRun(),t})),Promise.race([t,e.executeScript()]).finally(n)}makeCancelableTimer(){let e=()=>{};return[new Promise(((t,n)=>{const a=setTimeout((()=>{n(new f(C.ERROR_STRING_TIMEOUT))}),g.R.getScratchpadScriptExecutionTimeout());e=()=>clearTimeout(a)})),e]}async wrapRawOfficeJsScript(e){const t=e.match(/await\s+Excel\.run\s*\(((?:.|\n)*?)\);?(?:\s|\n)*$/);if(!t)throw new f("OfficeJS code not in expected format");return`async function main(context) {\n        let firstError = null;\n        const extractError = (value) => {\n            if (typeof value === "object") {\n                if (Array.isArray(value)) {\n                    return value.map((v) => extractError(v));\n                }\n                if (value === null) {\n                    return value;\n                }\n                const properObject = {};\n                const properties = new Set(Object.getOwnPropertyNames(value));\n                for (const property of properties) {\n                    properObject[property] = value[property];\n                }\n                return properObject;\n            }\n            return value;\n        };\n        const returnValue = await (${t[1]})(context).catch(error => {\n            firstError = extractError(error);\n        });\n        await context.sync().catch(error => {\n            firstError ??= extractError(error);\n        });\n        return firstError ? { error: firstError } : returnValue;\n    }`}hasChangeCollector(e){return this.changeCollectors.has(e)}constructor(e){this.changeCollectors=new Map,this.runtimeHelper=d.b.instance(),this.dataLocale=e((0,b.Z)()).dataLocale}}C.ERROR_STRING_TIMEOUT="Timeout"},894597:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.version=t.validate=t.v7=t.v6ToV1=t.v6=t.v5=t.v4=t.v3=t.v1ToV6=t.v1=t.stringify=t.parse=t.NIL=t.MAX=void 0;var a=n(281695);Object.defineProperty(t,"MAX",{enumerable:!0,get:function(){return a.default}});var o=n(579870);Object.defineProperty(t,"NIL",{enumerable:!0,get:function(){return o.default}});var r=n(997434);Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return r.default}});var i=n(154836);Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return i.default}});var l=n(178360);Object.defineProperty(t,"v1",{enumerable:!0,get:function(){return l.default}});var s=n(241821);Object.defineProperty(t,"v1ToV6",{enumerable:!0,get:function(){return s.default}});var c=n(690114);Object.defineProperty(t,"v3",{enumerable:!0,get:function(){return c.default}});var d=n(376075);Object.defineProperty(t,"v4",{enumerable:!0,get:function(){return d.default}});var u=n(810980);Object.defineProperty(t,"v5",{enumerable:!0,get:function(){return u.default}});var m=n(19213);Object.defineProperty(t,"v6",{enumerable:!0,get:function(){return m.default}});var g=n(708817);Object.defineProperty(t,"v6ToV1",{enumerable:!0,get:function(){return g.default}});var h=n(474862);Object.defineProperty(t,"v7",{enumerable:!0,get:function(){return h.default}});var p=n(904967);Object.defineProperty(t,"validate",{enumerable:!0,get:function(){return p.default}});var b=n(678685);Object.defineProperty(t,"version",{enumerable:!0,get:function(){return b.default}})},895486:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});const a=/([\s\S]*)\$\{(.*)\}([\s\S]*)/;const o=function e(t,n,o){const r=a.exec(t);if(!r)return t;const[i,l,s,c]=r,d=n[s];if(void 0===d)throw new Error(`Could not find a substitution for the placeholder "${s}" within "${t}" with substitutions \`${JSON.stringify(n)}\``);return e(l,n,o)+(o?"<b>":"")+d+(o?"</b>":"")+e(c,n,o)}},897729:(e,t,n)=>{"use strict";n.d(t,{Q:()=>i});var a=n(603222),o=n(384453),r=n(208520);function i(){const e=r.createElement(a.E,{animation:"wave",appearance:"translucent",style:{marginTop:4,width:"100%",height:12}},r.createElement(o.H,{size:12}));return r.createElement("div",null,e,e)}},901868:(e,t,n)=>{"use strict";n.d(t,{C:()=>l,_:()=>s});var a=n(879162),o=n(799765);const r=e=>e.every((e=>e.every((e=>!e.includes("[object Object]")))))?a.z.Table:a.z.TableWithObjects,i=e=>{if(null===e)return"None";if(Array.isArray(e)){if(e.some((e=>Array.isArray(e)||"object"==typeof e&&null!==e))){return`[${e.map((e=>Array.isArray(e)||"object"==typeof e&&null!==e?"[object Object]":null===e?"null":String(e))).join(",")}]`}return JSON.stringify(e)}if("object"==typeof e&&null!==e&&"type"in e){if("datetime"===e.type&&"value"in e)return String(e.value);if(!("value"in e))return e.type}return String(e)};function l(e){return"string"==typeof e?isFinite(Number(e.trim())):"number"==typeof e}function s(e,t){if(!e)return{output:e,outputType:a.z.None};if(t===a.z.Image)return{output:e,outputType:a.z.Image};if(!isNaN(Number(e))&&""!==e.trim()||l(e))return{output:e,outputType:a.z.Number};if("true"===e.toLowerCase()||"false"===e.toLowerCase())return{output:e,outputType:a.z.Boolean};try{const t=JSON.parse(e);if(Array.isArray(t)&&t.length>0){if(t.every((e=>Array.isArray(e)&&e.length===t[0].length&&t[0].length>0))){const e=t.map((e=>e.map((e=>i(e)))));return{output:e,outputType:r(e)}}return{output:e,outputType:a.z.Json}}if(typeof t===a.z.Object)return{output:e,outputType:a.z.Json}}catch(t){return(0,o.eA)(),{output:e,outputType:a.z.String}}return{output:e,outputType:a.z.String}}},902296:(e,t,n)=>{"use strict";n.d(t,{N:()=>l});var a=n(472096),o=n(660606),r=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{s(a.next(e))}catch(e){r(e)}}function l(e){try{s(a.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((a=a.apply(e,t||[])).next())}))},i=function(e,t){var n,a,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(n=1,a&&(o=2&l[0]?a.return:l[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,l[1])).done)return o;switch(a=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,a=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],a=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},l=function(){return r(void 0,void 0,void 0,(function(){var e,t;return i(this,(function(n){switch(n.label){case 0:if(!(0,a.$$)()&&!(0,a.fU)())return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,OfficeFirstParty.PrivateApi.execute("SHOW_COPILOT_PRODIGY_UPSELL_FLOW")];case 2:return e=n.sent(),(0,o.cY)(e),[3,4];case 3:return t=n.sent(),(0,o.cY)("Error Executing SHOW_COPILOT_PRODIGY_UPSELL_FLOW"+t),[3,4];case 4:return[3,7];case 5:return[4,Office.license.launchUpsellExperience("copilotsidepanel_creditlimit")];case 6:n.sent(),n.label=7;case 7:return[2]}}))}))}},903173:(e,t,n)=>{"use strict";n.d(t,{F:()=>g,m:()=>m});var a=n(624654),o=n(644476),r=n(316904),i=n(910480),l=n(347145);const s=!0,c={activeTable:void 0,activeChart:void 0,activePivotTable:void 0,activeRange:void 0,lastActiveTable:void 0,dataSourceApis:{},selectionContexts:{},evaluateQueryLocations:{},generateResultForNLEvaluationLocations:{},postRangesResults:{},postRangesRequestTypes:{},interpretations:{},recommendations:{},suggestions:{},selectionError:void 0,isInserting:!1,hideSelectionErrorOnRange:void 0,activeRequestId:{},isAllowRewrite:s,requestState:{},isPermanentError:!1,isWorksheetProtected:!1,isWorksheet:!0,isWorkbookAutoSaveOn:!0,pendingNLContextFetches:[],tabularRanges:{},localeCacheDeprecated:(0,a.FZ)(),themeColors:{accentColors:[]},textAnalysisCardProps:void 0,excelRecognizedTablesAnnotationsCache:[],excelRecognizedTablesAnnotationsCacheRevisionId:"",excelBlobRangeCache:[],excelBlobRangeCacheRevisionId:"",nlEvaluationStates:{},rawQueries:{},shouldFallBack:{}};function d(e,t){delete e.evaluateQueryLocations[t],delete e.postRangesResults[t],delete e.postRangesRequestTypes[t],delete e.interpretations[t],delete e.suggestions[t],delete e.recommendations[t],delete e.generateResultForNLEvaluationLocations[t]}const u=(0,o.Z0)({name:"selection",initialState:c,reducers:{clearExpiredRanges:(e,t)=>{d(e,t.payload)},clearTable:(e,t)=>{delete e.dataSourceApis[t.payload],delete e.selectionContexts[t.payload],d(e,t.payload),delete e.activeRequestId[t.payload]},setActiveTable:(e,t)=>{t.payload?(e.activeTable&&(e.lastActiveTable=e.activeTable),e.activeTable=t.payload):(e.lastActiveTable===e.activeTable&&(e.lastActiveTable=void 0),e.activeTable=void 0)},setActiveChart:(e,t)=>{e.activeChart=t.payload},setActivePivotTable:(e,t)=>{e.activePivotTable=t.payload},setActiveRange:(e,t)=>{e.activeRange=t.payload},removeLastActiveTable:e=>{e.lastActiveTable=void 0},setDataSourceApi:(e,t)=>{e.dataSourceApis[t.payload.tableName]=t.payload.dataSourceApi},setSelectionContext:(e,t)=>{e.selectionContexts[t.payload.tableName]=t.payload.context,e.localeCacheDeprecated=t.payload.localeCacheDeprecated,e.themeColors=t.payload.theme},setEvaluateQueryLocation:(e,t)=>{e.evaluateQueryLocations[t.payload.tableName]=t.payload.evaluateQueryLocation},postRangesSuccess:(e,t)=>{e.postRangesResults[t.payload.tableName]=t.payload.postRangesResult,e.postRangesRequestTypes[t.payload.tableName]||(e.postRangesRequestTypes[t.payload.tableName]=[]),e.postRangesRequestTypes[t.payload.tableName].includes(t.payload.requestType)||e.postRangesRequestTypes[t.payload.tableName].push(t.payload.requestType)},generateResultsSuccess:(e,t)=>{e.postRangesRequestTypes[t.payload.tableName].includes(t.payload.requestType)||e.postRangesRequestTypes[t.payload.tableName].push(t.payload.requestType),e.postRangesResults[t.payload.tableName].operationId=t.payload.generateResultsResult.operationId,e.postRangesResults[t.payload.tableName].operationLocation=t.payload.generateResultsResult.operationLocation},getInterpretationsSuccess:(e,t)=>{e.interpretations[t.payload.tableName]?e.interpretations[t.payload.tableName].push(...t.payload.result.interpretations):e.interpretations[t.payload.tableName]=t.payload.result.interpretations},getRecommendationsSuccess:(e,t)=>{const n=t.payload.recommendations.map((e=>({...e,queryId:r.M.userQueryGuid})));e.recommendations[t.payload.tableName]||(e.recommendations[t.payload.tableName]=[]),e.recommendations[t.payload.tableName].push(...n)},getNLContextSuccess:(e,t)=>{e.evaluateQueryLocations[t.payload.tableName]=t.payload.contextResponse.evaluateQueryLocation;((0,l.iPS)("Microsoft.Office.Excel.FA000000124.UseShortPollNLEvaluating",!1)||(0,l.iPS)("Microsoft.Office.Excel.FA000000124.EnableDynamicPlanner",!1))&&(e.generateResultForNLEvaluationLocations[t.payload.tableName]=t.payload.contextResponse.generateResultForNLEvaluationLocation),e.suggestions[t.payload.tableName]=t.payload.contextResponse.suggestedQueries?.suggestions??[]},setSelectionError:(e,t)=>{e.selectionError=t.payload,void 0===t.payload&&(e.hideSelectionErrorOnRange=void 0)},hideSelectionErrorOnRange:(e,t)=>{e.hideSelectionErrorOnRange=t.payload},startInsertRecommendations(e){e.isInserting=!0},endInsertRecommendations(e){e.isInserting=!1},setIsAllowRewrite(e,t){e.isAllowRewrite=t.payload},resetIsAllowRewrite(e){e.isAllowRewrite=s},setActiveRequestId:(e,t)=>{e.activeRequestId[t.payload.tableName]=t.payload.activeRequestId,e.requestState[t.payload.activeRequestId]="pending"},evaluateQuerySuccess:(e,t)=>{e.requestState[t.payload]="success"},evaluateQueryFailed:(e,t)=>{e.requestState[t.payload]="failed"},setIsPermanentError:(e,t)=>{e.isPermanentError=t.payload},setIsWorksheetProtected:(e,t)=>{e.isWorksheetProtected=t.payload},setIsWorksheet:(e,t)=>{e.isWorksheet=t.payload},setIsWorkbookAutoSaved:(e,t)=>{e.isWorkbookAutoSaveOn=t.payload},getNLContextRequest:(e,t)=>{e.pendingNLContextFetches.push(t.payload)},getNLContextFinished:(e,t)=>{e.pendingNLContextFetches=e.pendingNLContextFetches.filter((e=>e!==t.payload))},cacheTableInterpretationsForUndo:e=>{e.cachedTabularRangesForUndo=(0,i.cloneDeep)(e.tabularRanges)},restoreTableInterpretationsForUndo:e=>{e.cachedTabularRangesForUndo&&(e.tabularRanges=e.cachedTabularRangesForUndo),e.cachedTabularRangesForUndo=void 0},clearCachedTableInterpretationsForUndo:e=>{e.cachedTabularRangesForUndo=void 0},updateTableInterpretationsForSheet:(e,t)=>{e.tabularRanges[t.payload.sheetId]=t.payload.newInterpretations},updateExcelRecognizedTableCache:(e,t)=>{""!==e.excelRecognizedTablesAnnotationsCacheRevisionId&&e.excelRecognizedTablesAnnotationsCacheRevisionId===t.payload.revisionId||(e.excelRecognizedTablesAnnotationsCache=[],e.excelRecognizedTablesAnnotationsCacheRevisionId=t.payload.revisionId),e.excelRecognizedTablesAnnotationsCache.push(t.payload.recognizedTable)},updateExcelBlobRangeCache:(e,t)=>{""!==e.excelBlobRangeCacheRevisionId&&e.excelBlobRangeCacheRevisionId===t.payload.revisionId||(e.excelBlobRangeCache=[],e.excelBlobRangeCacheRevisionId=t.payload.revisionId),e.excelBlobRangeCache.push(t.payload.blobRange)},setTextAnalysisCardProps:(e,t)=>{e.textAnalysisCardProps=t.payload.props},setNLEvaluationState:(e,t)=>{e.nlEvaluationStates[t.payload.requestId]=t.payload.nlEvaluationState},setRawQuery:(e,t)=>{e.rawQueries[t.payload.userQueryGuid]=t.payload.messageText},setShouldFallBack:(e,t)=>{e.shouldFallBack[t.payload.requestId]=t.payload.shouldFallBack}}}),{actions:m,reducer:g}=u},904967:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(389618);t.default=function(e){return"string"==typeof e&&a.default.test(e)}},911443:(e,t,n)=>{"use strict";n.d(t,{DY:()=>l,_s:()=>o,dD:()=>s});var a,o,r=n(352628),i=(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t}(function(e){function t(t,n){var a=e.call(this,n)||this;return a.name=t,a}return i(t,e),t}(Error));!function(e){e.FailedToLoadStrings="FailedToLoadStrings",e.InvalidInput="InvalidInput"}(o||(o={}));var s=function(){function e(){this.DEFAULT_LOCALE="en-US",this.isTier2LanguageSupportEnabled=!1,this.isTier2RTLLanguageEnabled=!1,this.isTier3LanguagesEnabled=!1,this.isTier2Point5LanguagesEnabled=!1,this.isTier4LanguagesEnabled=!1,this.supportedLanguages=[]}return Object.defineProperty(e.prototype,"IsTier2LanguageSupportEnabled",{set:function(e){this.isTier2LanguageSupportEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsTier2RTLLanguageEnabled",{set:function(e){this.isTier2RTLLanguageEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsTier3LanguagesEnabled",{set:function(e){this.isTier3LanguagesEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsTier2Point5LanguagesEnabled",{set:function(e){this.isTier2Point5LanguagesEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsTier4LanguagesEnabled",{set:function(e){this.isTier4LanguagesEnabled=e},enumerable:!1,configurable:!0}),e.prototype.GetSupportedLanguageCode=function(e){switch(e){case"es-US":case"es-419":case"es-PE":return"es-MX";case"en":case"en-CA":return"en-US";case"sv":return"sv-SE";case"it":return"it-IT";case"th":return"th-TH";case"de":return"de-DE";default:return e}},e.prototype.FormatLanguageCode=function(e){var t=e.split("-");if(1===t.length)return t[0].toLowerCase();if(t.length>1&&(t[0]=t[0].toLowerCase(),t[t.length-1]=t[t.length-1].toUpperCase()),t.length>2)for(var n=1;n<t.length-1;n++)t[n]=t[n].charAt(0).toUpperCase()+t[n].slice(1).toLowerCase();return t.join("-")},e.prototype.GetDefaultLanguageCode=function(e){for(var t=e.split("-"),n=0;n<this.supportedLanguages.length;n++){var a=this.supportedLanguages[n];if(t[0]===a.split("-")[0])return a}return e},e.prototype.getUserLanguage=function(e){var t="";if(null==e)throw new l(o.InvalidInput," Display Language is undefined or null");var n=this.FormatLanguageCode(e);return t=this.GetSupportedLanguageCode(n),this.SetSupportedLanguagesList(),-1===this.supportedLanguages.indexOf(t)&&(t=this.GetDefaultLanguageCode(t)),-1===this.supportedLanguages.indexOf(t)&&(t=this.DEFAULT_LOCALE),t},e.prototype.SetSupportedLanguagesList=function(){this.supportedLanguages=r.h7,this.isTier2LanguageSupportEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(r.k$),this.isTier2RTLLanguageEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(r.b_))),this.isTier3LanguagesEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(r.LJ)),this.isTier2Point5LanguagesEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(r.zi)),this.isTier4LanguagesEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(r.GN))},e}()},936191:(e,t,n)=>{"use strict";let a;n.d(t,{A:()=>r});const o=new Uint8Array(16);function r(){if(!a){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");a=crypto.getRandomValues.bind(crypto)}return a(o)}},937729:(e,t,n)=>{"use strict";n.d(t,{D:()=>p});var a=n(37072),o=n(28987),r=n(660606),i=n(822606),l=n(764081),s=n(481797),c=function(e){var t={appId:"",botId:"",cardId:""};if(!(null==e?void 0:e.cardData))return(0,r.cY)("msgExtension Utils: cardData is not present in taskModuleProps"),t;try{var n=JSON.parse(e.cardData);t={appId:n.appId,botId:n.botId,cardId:n.cardId}}catch(e){(0,r.cY)("msgExtension Utils: Failed to extract cardId from cardData")}return t},d=n(423905),u=n(83437),m=function(){return m=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},m.apply(this,arguments)},g=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{s(a.next(e))}catch(e){r(e)}}function l(e){try{s(a.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((a=a.apply(e,t||[])).next())}))},h=function(e,t){var n,a,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(n=1,a&&(o=2&l[0]?a.return:l[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,l[1])).done)return o;switch(a=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,a=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],a=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},p=function(){function e(){var t=this;if(this.openedDialog={dialog:null,cardId:"",triggeringActionTitle:""},this.taskModuleProps=void 0,this.shouldDisplayDismissIcon=!0,this.startTime=0,this.setProxyOperator=function(e){t.executePluginOperation=e},this.closeActiveDialog=function(){t.openedDialog.dialog&&t.openedDialog.dialog.close(),t.openedDialog={dialog:null,cardId:"",triggeringActionTitle:""},(0,r.cY)("MsgExtDialogLauncher : Task Module dialog closed")},this.logDialogTelemetry=function(e,n){var a=Date.now();(0,d.js)(a-t.startTime,e,null!=n?n:""),e||(0,d.jC)(null!=n?n:"")},this.onMessageCallback=function(n){return g(t,void 0,void 0,(function(){var t,o,i,l,s,g,p,b,f,C,y,v,T,x;return h(this,(function(h){switch(h.label){case 0:return this.openedDialog.dialog?(t=JSON.parse(n)).type!==a.o.Ack?[3,1]:(o=c(this.taskModuleProps),l={dialogContent:null===(C=this.taskModuleProps)||void 0===C?void 0:C.dialogContent,appDefinition:null===(y=this.taskModuleProps)||void 0===y?void 0:y.appDefinition,clientInfo:null===(v=this.taskModuleProps)||void 0===v?void 0:v.clientInfo,shouldDisplayDismissIcon:this.shouldDisplayDismissIcon,cardInfo:o,hostConfigFlags:null===(T=this.taskModuleProps)||void 0===T?void 0:T.hostConfigFlags,copilotChatThemev2:e.theme,source:"AppChat"},this.openedDialog.dialog.messageChild(JSON.stringify(l),{targetOrigin:window.location.origin}),this.logDialogTelemetry(!0),[3,6]):(this.logDialogTelemetry(!1,"MsgExtDialogLauncher.onMessageCallback : No active dialog found"),[2]);case 1:return t.type!==a.o.CloseEvent?[3,2]:(this.closeActiveDialog(),[3,6]);case 2:if(t.type!==a.o.onServiceRequest)return[3,6];null===(x=r.EG.setQueryGuid)||void 0===x||x.call(r.EG,t.requestId),(0,r.cY)("MsgExtDialogLauncher : Received service request from dialog",t),i={requestId:t.requestId,serviceName:t.serviceName,apiName:t.apiName},r.EG.sendChatEventTelemetry((0,d.pN)(((p={})[u.h3.ChatEventType]=u.a5.TaskModuleServiceRequest,p[u.h3.ChatEventParameters]=JSON.stringify(i),p))),l={requestId:t.requestId,messageType:a.o.onServiceResponse,serviceName:t.serviceName,apiName:t.apiName,result:void 0},h.label=3;case 3:return h.trys.push([3,5,,6]),[4,this.executePluginOperation(t.serviceName,t.apiName,t.requestData)];case 4:return(s=h.sent())&&(l.result=s),(0,r.cY)("MsgExtDialogLauncher: Received response from ".concat(t.serviceName,"-").concat(t.apiName," for requestId ").concat(t.requestId)),r.EG.sendChatEventTelemetry((0,d.pN)(((b={})[u.h3.ChatEventType]=u.a5.TaskModuleServiceResponse,b[u.h3.ChatEventParameters]=JSON.stringify(i),b))),this.openedDialog.dialog.messageChild(JSON.stringify(l),{targetOrigin:window.location.origin}),[3,6];case 5:return g=h.sent(),(0,r.cY)("MsgExtDialogLauncher : Error executing plugin operation",g),r.EG.sendErrorTelemetry((0,d.pN)(((f={})[u.IC.ErrorMessage]=JSON.stringify(m(m({},i),{error:g})),f[u.IC.ErrorCategory]=u.S2.ExtensibilityDialog,f[u.IC.ErrorCode]="".concat(t.serviceName,"-").concat(t.apiName),f))),[3,6];case 6:return[2]}}))}))},this.onCloseCallback=function(){t.closeActiveDialog()},this.isDialogActive=function(){return null!==t.openedDialog.dialog},this.shouldCloseActiveDialog=function(e){var n;return!(t.openedDialog.cardId&&t.openedDialog.cardId===e&&(!(null===(n=t.taskModuleProps)||void 0===n?void 0:n.triggeringActionTitle)||t.openedDialog.triggeringActionTitle===t.taskModuleProps.triggeringActionTitle))},this.onDialogError=function(e){var n="Error opening dialog";if(e)try{n=JSON.stringify(e)}catch(e){(0,r.cY)("MsgExtDialogLauncher.onDialogError : Error parsing error object",e)}t.logDialogTelemetry(!1,"MsgExtDialogLauncher : ".concat(n))},this.openDialogForWebPlatformAsNewWindow=function(e,n){return g(t,void 0,void 0,(function(){var t,a,o=this;return h(this,(function(r){switch(r.label){case 0:if(this.shouldDisplayDismissIcon=!1,t=c(this.taskModuleProps).cardId,this.isDialogActive()){if(!this.shouldCloseActiveDialog(t))return[2];this.closeActiveDialog()}return a=(0,s.zC)(),[4,Office.context.ui.displayDialogAsync(a,{displayInIframe:!1,hideTitle:!0,height:e,width:n,promptBeforeOpen:!1},(function(e){return g(o,void 0,void 0,(function(){var n,a,o=this;return h(this,(function(r){return e.error||!e.value?(this.onDialogError(e.error),[2]):(this.openedDialog={dialog:e.value,cardId:t,triggeringActionTitle:null!==(a=null===(n=this.taskModuleProps)||void 0===n?void 0:n.triggeringActionTitle)&&void 0!==a?a:""},this.openedDialog.dialog.addEventHandler(Office.EventType.DialogMessageReceived,(function(e){return g(o,void 0,void 0,(function(){return h(this,(function(t){switch(t.label){case 0:return[4,this.onMessageCallback(e.message)];case 1:return t.sent(),[2]}}))}))})),this.openedDialog.dialog.addEventHandler(Office.EventType.DialogEventReceived,(function(e){return g(o,void 0,void 0,(function(){return h(this,(function(t){return e.error===s.Y7&&this.closeActiveDialog(),[2]}))}))})),[2])}))}))}))];case 1:return r.sent(),[2]}}))}))},this.openDialogForNativePlatform=function(e,n){return g(t,void 0,void 0,(function(){var t,a,o,l=this;return h(this,(function(c){return this.shouldDisplayDismissIcon=!1,t=(0,s.zC)(),OfficeFirstPartyDialog.displayWebDialog(t,{displayInIframe:!0,dialogTitle:null!==(o=null===(a=this.taskModuleProps)||void 0===a?void 0:a.dialogTitle)&&void 0!==o?o:i.$9,hideTitle:!0,height:e,width:n,onMessage:this.onMessageCallback,onClose:this.onCloseCallback}).then((function(e){l.openedDialog.dialog=e})).catch((function(e){l.onDialogError(e),(0,r.cY)("MsgExtDialogLauncher : Error displaying  Task Module dialog",e)})),[2]}))}))},this.launchTaskModule=function(e){return g(t,void 0,void 0,(function(){var t,n,a,r;return h(this,(function(i){return this.startTime=Date.now(),this.taskModuleProps=e,0,0,a=function(e){var t,n;if(e.viewMode!==l.oY)return{dialogHeight:l.Qt,dialogWidth:l.Qt};var a=(0,s.Cd)(null===(t=e.dialogContent)||void 0===t?void 0:t.height),o=(0,s.Cd)(null===(n=e.dialogContent)||void 0===n?void 0:n.width),r=!0,i=!0,c=l.t9,d=l.OY;a<=0&&(i=!1,c=(0,s.wc)(a)),o<=0&&(r=!1,d=(0,s.tP)(o));var u=screen.width,m=screen.height;return i&&(c=(0,s.Xz)(a,m)),r&&(d=(0,s.Xz)(o,u)),{dialogHeight:c,dialogWidth:d}}(e),t=a.dialogHeight,n=a.dialogWidth,(null===(r=e.clientInfo)||void 0===r?void 0:r.clientType)===o.WK.web?this.openDialogForWebPlatformAsNewWindow(t,n):this.openDialogForNativePlatform(t,n),[2,Promise.resolve({status:"Success"})]}))}))},e.instance)return e.instance;e.instance=this}return e.getInstance=function(){return e.instance||new e},e.setTheme=function(t){e.theme=t},e}()},938674:function(e,t,n){"use strict";var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{s(a.next(e))}catch(e){r(e)}}function l(e){try{s(a.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((a=a.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.WebRuntime=void 0;const o=n(778689),r=n(290235),i=n(119893),l=n(894597),s=n(480870),c=n(161581),d=n(243583),u=[s.SafetyOptions.NoSafety,s.SafetyOptions.OnlyAllowMakerSafeApi,s.SafetyOptions.OnlyAllowCopilotSafeApi];function m(e,t,n){n("No External Handler")}class g{static createRuntimeInstance(e){return a(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{const a=new g((0,l.v4)(),e);a.callbackList.create(++a.sequenceId,{resolve:t,reject:n}),document.body.appendChild(a.iframe)}))}))}constructor(e,t){this.metrics=(0,c.getZeroedWebRuntimeMetrics)(),this.externalHandlerFunction=m,this.runtimeConfiguration=t,this.getBatchSafetyFlag(),this.metrics=(0,c.getZeroedWebRuntimeMetrics)(),this.metrics.runtimeCreatedTime=Date.now(),this.state=i.RuntimeState.Loading,this.messageHandler=this.handleMessage.bind(this),window.addEventListener("message",this.messageHandler,!1),this.callbackList=new r.ObjectStore,this.id=e,this.sequenceId=0,this.telemetryChannel=(null==t?void 0:t.telemetryChannel)||(()=>{}),this.runtimeConsole=null==t?void 0:t.runtimeConsole,this.nonce=function(){const e=new Uint8Array(16);return window.crypto.getRandomValues(e),Array.from(e).map((e=>e.toString(16).padStart(2,"0"))).join("")}(),this.iframe=document.createElement("iframe"),this.iframe.setAttribute("id",e);const n=t.allowExternalCalls?"*":"'none'";let a="";t.allowExternalCalls||t.loadCodeDomainList.forEach((e=>{a=a.concat(e,", ")})),a=a.replace(/,\s*$/,"");const o=function(e,t){let n=e;return t.forEach((([e,t])=>{if(-1===n.indexOf(e))throw new Error(`Key ${e} not found in template.`);n=n.replace(e,t)})),n}(d.runtimeIframeHtml,[["PLACEHOLDER_PARENT_ORIGIN",window.location.origin],["PLACEHOLDER_NONCE",this.nonce],["PLACEHOLDER_ALLOWED_SOURCES",n],["PLACEHOLDER_LOAD_CODE_DOMAIN_LIST",a]]);this.iframe.style.display="none",this.iframe.srcdoc=o,this.iframe.sandbox.add("allow-scripts"),this.origin=new URL("about:srcdoc")}getId(){return this.id}getState(){return this.state}getStats(){const e=this.state===i.RuntimeState.Done,{iframeLoadedTime:t,runtimeCreatedTime:n,loadCodeTotalMilliseconds:a,syncsPerformed:o,totalSyncMilliseconds:r,executeEndTime:l,executeStartTime:s,nonundoableWritesSeen:c}=this.metrics;return{runCompleted:e,iframeLoadMilliseconds:t-n,codeLoadMilliseconds:a,syncsPerformed:o,syncMilliseconds:r,executeMilliseconds:l-s,nonundoableWriteSyncsPerformed:c}}loadLibraries(e){return a(this,void 0,void 0,(function*(){return this.setState(i.RuntimeState.Loading),new Promise(((t,n)=>{this.callbackList.create(++this.sequenceId,{resolve:t,reject:n}),this.metrics.loadCodeStartTime=Date.now();const a={scriptId:this.id,runtimeId:this.id,sequenceId:this.sequenceId,eventType:"loadCode",libraries:e};o.Assert.NotNull(this.iframe.contentWindow,"invalid iframe, no content window found"),this.iframe.contentWindow.postMessage(a,this.getPostMessageOrigin())}))}))}getPostMessageOrigin(){return"*"}loadUrl(e,t){return a(this,void 0,void 0,(function*(){return this.loadLibraries([{name:t||"library url",load:"url",value:e}])}))}loadCode(e,t){return a(this,void 0,void 0,(function*(){return this.loadLibraries([{name:t||"library code",load:"code",value:e}])}))}executeFunction(e,t,n,r){return a(this,void 0,void 0,(function*(){return this.setState(i.RuntimeState.Executing),new Promise(((a,i)=>{this.metrics.executeStartTime=Date.now(),this.metrics.syncsPerformed=0,this.metrics.totalSyncMilliseconds=0,this.metrics.syncsOutstanding=0,o.Assert.NotNull(this.iframe.parentNode,"invalid iframe, no parent node found"),o.Assert.NotNull(this.iframe.contentWindow,"invalid iframe, no content window found"),this.externalHandlerFunction=r;this.callbackList.create(++this.sequenceId,{resolve:e=>{this.externalHandlerFunction=m,a(e)},reject:e=>{this.externalHandlerFunction=m,i(e)}});const l={scriptId:this.id,runtimeId:this.id,sequenceId:this.sequenceId,eventType:"execute",functionName:e,functionArgs:t,host:n};this.iframe.contentWindow.postMessage(l,this.getPostMessageOrigin())}))}))}checkMessageOriginAndNonce(e){return e.data.nonce===this.nonce}handleMessage(e){if(this.checkMessageOriginAndNonce(e)&&e.data&&e.source===this.iframe.contentWindow){const t=e.data.eventType;"onWorkerLoaded"===t&&this.handleMessageOnWorkerCreated(),e.data.scriptId===this.id&&("loadCodeComplete"===t&&this.handleMessageLoadCodeComplete(e),"executeComplete"===t&&this.handleMessageExecuteComplete(e),"externalMessage"===t&&this.handleMessageExternalMessage(e),"officeJsMessage"===t&&this.handleMessageOfficeJsMessage(e),"consoleLog"===t&&this.handleMessageConsoleLog(e),"telemetry"===t&&this.handleMessageTelemetry(e))}}handleMessageOnWorkerCreated(){this.metrics.iframeLoadedTime=Date.now();const e=[],t=this.runtimeConfiguration.officeJsUrl;if(void 0!==t){const n={name:"office.js",load:"url",value:t};e.push(n)}this.metrics.loadCodeStartTime=Date.now();const n={scriptId:this.id,runtimeId:this.id,sequenceId:this.sequenceId,eventType:"loadCode",libraries:e};o.Assert.NotNull(this.iframe.contentWindow,"invalid iframe, no content window found"),this.iframe.contentWindow.postMessage(n,this.getPostMessageOrigin())}handleMessageLoadCodeComplete(e){this.metrics.loadCodeTotalMilliseconds=Date.now()-this.metrics.loadCodeStartTime,this.metrics.loadCodeStartTime=0,this.setState(i.RuntimeState.Ready),this.handlePromiseResolving(e,this)}handleMessageExecuteComplete(e){this.metrics.executeEndTime=Date.now(),this.setState(i.RuntimeState.Done),this.handlePromiseResolving(e,e.data.message.result)}getBatchSafetyFlag(){const e=this.runtimeConfiguration?this.runtimeConfiguration.batchSafetyFlag:s.SafetyOptions.OnlyAllowMakerSafeApi;return o.Assert.True(u.indexOf(e)>=0,`Invalid batchSafetyFlag ${e} encountered. Fix your RuntimeConfiguration to select from ${u}.`),e}handleMessageExternalMessage(e){const t=e.data,n=(e,n)=>{if(!this.iframe.parentNode||!this.iframe.contentWindow)return void this.completeAllPromises();const a={scriptId:t.scriptId,runtimeId:t.runtimeId,eventType:"externalMessageResponse",sequenceId:t.sequenceId,type:n,result:e};this.iframe.contentWindow.postMessage(a,this.getPostMessageOrigin())};this.externalHandlerFunction(t.message,(e=>{n(e,"resolve")}),(e=>{n(e,"reject")}))}handleMessageOfficeJsMessage(e){0===this.metrics.syncsOutstanding&&(this.metrics.syncStarted=Date.now()),this.metrics.syncsOutstanding++;const t=e.data;t.message[6]|=this.getBatchSafetyFlag();const n=16&t.message[6],a=1&t.message[6];this.metrics.nonundoableWritesSeen+=!n&&a?1:0,this.runtimeConfiguration&&this.runtimeConfiguration.disableUndoable&&(t.message[6]&=-17);(this.runtimeConfiguration.batchHandlerFunction||OSF.DDA.RichApi.executeRichApiRequestAsync)(t.message,(e=>{if(this.metrics.syncsPerformed++,this.metrics.syncsOutstanding--,0===this.metrics.syncsOutstanding&&(this.metrics.totalSyncMilliseconds+=Date.now()-this.metrics.syncStarted),!this.iframe.parentNode||!this.iframe.contentWindow)return void this.completeAllPromises();const n={scriptId:t.scriptId,runtimeId:t.runtimeId,eventType:"officeJsMessageResponse",sequenceId:t.sequenceId,result:e};this.iframe.contentWindow.postMessage(n,this.getPostMessageOrigin())}))}handleMessageConsoleLog(e){const t=e.data;this.runtimeConsole&&this.runtimeConsole[t.logType](t.scriptId,t.consoleArgs)}handleMessageTelemetry(e){const t=e.data,n={runtimeId:this.id,success:t.success,eventName:t.eventName,data:t.data};this.telemetryChannel(n)}handlePromiseResolving(e,t){const n=e.data,a=this.callbackList.read(n.sequenceId);this.callbackList.delete(n.sequenceId),"Success"===n.message.status?a.resolve(t):(this.setState(i.RuntimeState.Error),a.reject(e))}terminate(){return a(this,void 0,void 0,(function*(){this.completeAllPromises(),this.metrics.executeEndTime=Date.now(),window.removeEventListener("message",this.messageHandler),this.iframe.parentNode&&this.iframe.parentNode.removeChild(this.iframe)}))}completeAllPromises(){this.callbackList.keys().forEach((e=>{const t=this.callbackList.read(e);this.callbackList.delete(e),t.resolve(!1)}))}setState(e){const t=new Map([[i.RuntimeState.Ready,[i.RuntimeState.Loading,i.RuntimeState.Executing,i.RuntimeState.Error]],[i.RuntimeState.Executing,[i.RuntimeState.Done,i.RuntimeState.Error]],[i.RuntimeState.Loading,[i.RuntimeState.Ready,i.RuntimeState.Error]],[i.RuntimeState.Done,[i.RuntimeState.Error]],[i.RuntimeState.Error,[i.RuntimeState.Error]]]).get(this.state)||[];o.Assert.True(t.includes(e),`Runtime state [${this.state}] may not transition to state [${e}]`),this.state=e}}t.WebRuntime=g},946562:(e,t,n)=>{"use strict";n.d(t,{U:()=>s,f:()=>l});var a=n(208520),o=n(420748),r=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{s(a.next(e))}catch(e){r(e)}}function l(e){try{s(a.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((a=a.apply(e,t||[])).next())}))},i=function(e,t){var n,a,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(n=1,a&&(o=2&l[0]?a.return:l[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,l[1])).done)return o;switch(a=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,a=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],a=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},l=function(e){a.useEffect((function(){var t=o.U.subscribe(e);return function(){t()}}),[])},s=function(e){var t,n=!1;a.useEffect((function(){return t=o.U.subscribe((function(){return r(void 0,void 0,void 0,(function(){return i(this,(function(a){switch(a.label){case 0:return n?[3,2]:(n=!0,[4,e()]);case 1:a.sent(),t(),a.label=2;case 2:return[2]}}))}))})),function(){t()}}),[])}},951903:(e,t,n)=>{"use strict";n.d(t,{LQ:()=>s,pi:()=>l});var a=n(355232),o=n(507628),r=n(51684),i=function(e){return/^data:image\/[a-zA-Z]+;base64,/.test(e)},l=function(e){if(i(e)){for(var t=e.split(",")[1],n=atob(t),r=new Uint8Array(new ArrayBuffer(n.length)),l=0;l<n.length;l++)r[l]=n.charCodeAt(l);var s=function(e){return e.startsWith("data:image/png")?{format:a.f.Png}:e.startsWith("data:image/jpg")||e.startsWith("data:image/jpeg")?{format:a.f.Jpg}:e.startsWith("data:image/bmp")?{format:a.f.Bmp}:{format:a.f.Other,otherFormat:e.split(";")[0].split(":")[1]}}(e),c=s.format,d=s.otherFormat;return{contents:[{id:(0,o.A)(),size:a.h.Unspecified,format:c,otherFormat:d,data:Array.from(r),sizeBytes:r.length}],widthPx:0,heightPx:0}}},s=function(e){if(i(e)){var t=e.split(",")[1],n=function(e){return e.startsWith("data:image/png")?r.kd.PNG:e.startsWith("data:image/jpg")||e.startsWith("data:image/jpeg")?r.kd.JPEG:void 0}(e);return t&&n?{screenshotBase64:[t],screenshotImageFormat:n}:void 0}}},952978:(e,t,n)=>{"use strict";e.exports=n.p+"assets/dislike-icon.svg"},956933:(e,t,n)=>{"use strict";n.d(t,{Eb:()=>f,Q9:()=>g,Yw:()=>m,oR:()=>b,qH:()=>p,yu:()=>h});var a=n(822606),o=n(881707),r=n(116510),i=n(355908),l=n(83437),s=n(660606),c=n(423905),d=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{s(a.next(e))}catch(e){r(e)}}function l(e){try{s(a.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((a=a.apply(e,t||[])).next())}))},u=function(e,t){var n,a,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(n=1,a&&(o=2&l[0]?a.return:l[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,l[1])).done)return o;switch(a=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,a=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],a=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}};function m(){0}var g=function(e){var t,n;if(e){(0,s.cY)("ClpUtils: Fetching clpSensitivityIndicatorData");var a,o={labelId:e.labelId,iconType:(a=e.encryptionType,a!==r.T.None?i.JF.Encryption:i.JF.NonEncryption),tooltipText:null!==(t=e.description)&&void 0!==t?t:"",badgeText:null!==(n=e.displayName)&&void 0!==n?n:""};return(0,s.cY)("ClpUtils: Returning clpSensitivityIndicatorData as ",o),o}(0,s.cY)("ClpUtils: Label is undefined")},h=function(){(0,s.cY)("ClpUtils: Fetching CLP label info..");var e=o.n.getInstance().getInDocSensitiveLabelInfo();if((0,s.cY)("ClpUtils: Label is : ".concat(JSON.stringify(e))),e.labelId)return(0,s.cY)("ClpUtils: Doc is labelled",e),e;(0,s.cY)("ClpUtils: Doc is not labelled")},p=function(e){return d(void 0,void 0,void 0,(function(){var t,n;return u(this,(function(r){switch(r.label){case 0:return e?(t={labelId:e.id,tenantId:e.tenantId},[4,o.n.getInstance().getHighestDocumentSensitivityInfo([t])]):[3,2];case 1:if(n=r.sent())return[2,g(n)];r.label=2;case 2:return[2,{tooltipText:(0,a.IQ)(),iconType:i.JF.Warning}]}}))}))},b=function(e){return e?{labelId:e.id,tenantId:"",displayName:e.displayName,description:e.tooltip,color:e.color,encryptionType:e.isEncrypted?r.T.IRMTemplate:r.T.None,order:e.priority}:{labelId:a.u1,tenantId:a.u1}},f=function(e,t){return d(void 0,void 0,void 0,(function(){var n,i,m,g,h,p,b,f,C,y,v,T;return u(this,(function(x){switch(x.label){case 0:return(null===(y=s.t6.IsCopilotInBackstageMode)||void 0===y?void 0:y.call(s.t6))?((0,s.cY)("getSensitivityConfig - skipping documentConfig in backstage mode"),[2,{copilotConfig:e()}]):[4,d(void 0,void 0,void 0,(function(){var e,t;return u(this,(function(n){switch(n.label){case 0:return e=o.n.getInstance().getInDocSensitiveLabelInfo(),s.t6.IsClpEnabledInEnterpriseForSydney()?[4,o.n.getInstance().getInDocSensitiveLabelUsingOfcJs()]:[3,3];case 1:return t=n.sent(),[4,o.n.getInstance().getHighestDocumentSensitivityInfo([e,t])];case 2:(e=n.sent()).isDke=t.isDke,e.hasExtractForUser=t.hasExtractForUser,n.label=3;case 3:return[2,e]}}))}))];case 1:return n=x.sent(),i={id:n.labelId,displayName:null!==(v=n.displayName)&&void 0!==v?v:"",tooltip:n.description,color:n.color,isEncrypted:n.encryptionType!==r.T.None,priority:null!==(T=n.order)&&void 0!==T?T:0},b={documentSensitivity:i},null==t?[3,2]:(g=t,[3,4]);case 2:return[4,s.t6.getOfficeJSDocumentURL()];case 3:g=x.sent(),x.label=4;case 4:return b.documentURL=g,b.hasExtract=n.labelId===a.u1||n.hasExtractForUser,b.isDKE=n.labelId!==a.u1&&n.isDke,m=b,(h={copilotConfig:e(),documentConfig:m}).copilotConfig&&s.EG.sendChatEventTelemetry((0,c.pN)(((f={})[l.h3.ChatEventType]=l.a5.CopilotConfig,f[l.h3.ChatEventParameters]=JSON.stringify(h.copilotConfig),f))),p=void 0===m.hasExtract&&void 0===m.isDKE,s.EG.sendChatEventTelemetry((0,c.pN)(((C={})[l.h3.ChatEventType]=l.a5.IsDocumentProtected,C[l.h3.ChatEventParameters]=!!p||!(!m.hasExtract||m.isDKE),C))),[2,h]}}))}))}},958252:(e,t,n)=>{"use strict";n.d(t,{N:()=>a});const a=!1},963002:(e,t,n)=>{"use strict";n.d(t,{P:()=>r});var a=n(75496),o=n(316904);class r{static getNumberFormatCache(){return this.numberFormatCache}addFormat(e){this._data[e]||(this._data[e]=r.createInvalidCacheEntry())}static async getFormatMetadata(e){const t=performance.now(),n=await Excel.run((async t=>{const n=Excel.NumberFormattingService.newObject(t),a=e.map((e=>n.getFormatter(e).load("*")));return await t.sync(),a.map((e=>e.toJSON()))}));return o.M.getInstance().logDuration("GetNumberFormatMetadata",performance.now()-t),n}async ensureFormats(){const e=Object.keys(this._data).filter((e=>!this._data[e].isValid));if(0===e.length)return;const t=await r.getFormatMetadata(e);if(e.length!==t.length)throw new Error("getFormatMetadata returned unexpected results.");e.forEach(((e,n)=>{this._data[e]=r.createValidCacheEntryFromFormatterData(t[n])}))}isDateTime(e){if(this._data[e]){if(this._data[e].isValid)return this._data[e].metadata.isDateTime;throw new Error("Format not valid. Ensure formats before accessing metadata.")}throw new Error("Format not added.")}addNumberFormatPropertiesToCache(e){e.forEach((e=>{this._data[e.key]=r.createValidCacheEntryFromFormatProperty(e)}))}get data(){return JSON.parse(JSON.stringify(this._data))}async addFormatPropertiesAsync(e){const t=e.filter((e=>!this._data[e]));t.length>0&&(o.M.getInstance().logEvent({eventType:a.S2.FormatMetadataFallback,eventData:[]}),t.forEach(this.addFormat.bind(this)),await this.ensureFormats())}static createInvalidCacheEntry(){return{isValid:!1,metadata:{hasDayOfWeek:!1,hasMonth:!1,hasYear:!1,isCurrency:!1,isDateTime:!1,isNumeric:!1,isPercent:!1,isText:!1}}}static createValidCacheEntryFromFormatterData(e){return{isValid:!0,metadata:{hasDayOfWeek:e.hasDayOfWeek,hasMonth:e.hasMonth,hasYear:e.hasYear,isCurrency:e.isCurrency,isDateTime:e.isDateTime,isNumeric:e.isNumeric,isPercent:e.isPercent,isText:e.isText}}}static createValidCacheEntryFromFormatProperty(e){return{isValid:!0,metadata:{hasDayOfWeek:e.dateTimeHasDayOfWeek,hasMonth:e.dateTimeHasMonth,hasYear:e.dateTimeHasYear,isCurrency:e.currency,isDateTime:e.dateTime,isNumeric:e.numeric,isPercent:e.percent,isText:e.text}}}constructor(e={}){this._data=JSON.parse(JSON.stringify(e))}}r.numberFormatCache=new r},963491:(e,t,n)=>{"use strict";n.d(t,{NU:()=>kl,yC:()=>Sl,C2:()=>Ll});var a=n(13161),o=n(639765),r=n(548366),i=n(531093),l=n(615397),s=n(823860),c=n(316904),d=n(857677),u=n(109174),m=n(347145),g=n(39206),h=n(670447),p=n(45698),b=n(5532),f=n(279395),C=n(528003),y=n(504786),v=n(99415),T=n(467407),x=n(731057),S=n(892221),w=n(526524),E=n(895486);const I=(0,m.yw9)("OfficeVSO_8999367_UseSeparateStringsForNumberValuesHiTL"),R=(0,m.yw9)("OfficeVSO_8884962_useColorNameForHumanInTheLoop"),A={substitute:E.A};function L(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeCellTextOrientationChangedLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeCellTextOrientationChangedLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeCellTextOrientationChangedLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeCellTextOrientationChangedLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeCellTextOrientationChangedLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeCellTextOrientationChangedLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeCellTextOrientationChangedLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeCellTextOrientationChangedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeCellTextOrientationChangedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeCellTextOrientationChangedLabel,{orientation:e.parameters.value}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameCellTextOrientationChanged,{columnName:e.parameters.columnName,orientation:e.parameters.value}):A.substitute(ExcelCopilotCommandingHitlStrings.CellTextOrientationChanged,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),orientation:e.parameters.value})}function k(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetAddedWithNameLabel,{worksheetName:e.parameters})}function F(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetRenameLabel,{worksheetName:e.parameters})}function _(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetDeleteMultipleLabel,{count:e.parameters.events.length})}function P(e){const t=e.parameters.values;if(1===t.length&&1===t[0].length){const n=I&&!isNaN(t[0][0])?ExcelCopilotCommandingHitlStrings.RangeEditValueNumberLabel:ExcelCopilotCommandingHitlStrings.RangeEditValueStringLabel;return A.substitute(n,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),value:`${t[0][0]}`})}return A.substitute(ExcelCopilotCommandingHitlStrings.RangeEditLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function N(e){const t=I&&!isNaN(e.parameters.value)?ExcelCopilotCommandingHitlStrings.RangeEditValueNumberLabel:ExcelCopilotCommandingHitlStrings.RangeEditValueStringLabel;return A.substitute(t,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),value:`${e.parameters.value}`})}function M(e){return e.parameters.command===w.default.ClearCellsFormat?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeClearFormatLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeClearFormatLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeClearFormatLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeClearFormatLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeClearFormatLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeClearFormatLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeClearFormatLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeClearFormatLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeClearFormatLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeClearFormatLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeClearFormatLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeClearLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeClearLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeClearLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeClearLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeClearLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeClearLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeClearLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeClearLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeClearLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeClearLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeClearLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function O(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeDeleteLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeDeleteLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeDeleteLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeDeleteLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeDeleteLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeDeleteLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeDeleteLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeDeleteLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeDeleteLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeDeleteLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeDeleteLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function D(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeInsertedLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeInsertedLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeInsertedLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeInsertedLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeInsertedLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeInsertedLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeInsertedLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeInsertedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeInsertedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeInsertedLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeInsertLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function B(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeMergeLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeMergeLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeMergeLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeMergeLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeMergeLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeMergeLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeMergeLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeMergeLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeMergeLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeMergeLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeMergeLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function $(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeUnmergeLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeUnmergeLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeUnmergeLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeUnmergeLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeUnmergeLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeUnmergeLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeUnmergeLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeUnmergeLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeUnmergeLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeUnmergeLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeUnmergeLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function H(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeColumnsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeColumnsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeColumnsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeColumnsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeColumnsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeColumnsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeColumnsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeColumnsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeColumnsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeColumnsAutofitLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeColumnsAutofitLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function U(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeRowsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeRowsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeRowsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeRowsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeRowsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeRowsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeRowsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeRowsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeRowsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeRowsAutofitLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeRowsAutofitLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function q(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeUseStandardHeightLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeUseStandardHeightLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeUseStandardHeightLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeUseStandardHeightLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeUseStandardHeightLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeUseStandardHeightLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeUseStandardHeightLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeUseStandardHeightLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeUseStandardHeightLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeUseStandardHeightLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeUseStandardHeightLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function V(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeUseStandardWidthLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeUseStandardWidthLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeUseStandardWidthLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeUseStandardWidthLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeUseStandardWidthLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeUseStandardWidthLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeUseStandardWidthLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeUseStandardWidthLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeUseStandardWidthLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeUseStandardWidthLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeUseStandardWidthLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function W(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangeHyperlinkLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function G(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangeRemoveHyperlinkLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.range.range)})}function z(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeNumberFormatLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeNumberFormatLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeNumberFormatLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeNumberFormatLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeNumberFormatLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeNumberFormatLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeNumberFormatLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeNumberFormatLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeNumberFormatLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeNumberFormatLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameNumberFormatLabel,{numberFormat:(0,v.X)(e.parameters.value,!0),columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeNumberFormatLabel,{numberFormat:(0,v.X)(e.parameters.value,!0),range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Q(e){return 0===e.parameters.copyCutOperation?A.substitute(ExcelCopilotCommandingHitlStrings.RangePasteCopyLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.destinationRange.range)}):A.substitute(ExcelCopilotCommandingHitlStrings.RangePasteCutLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.destinationRange.range)})}function j(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangeFillLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.target)})}function J(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableCreateLabel,{tableName:e.parameters.tableName,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Y(e){return(0,m.yw9)("OfficeVSO_8900971_HumanInTheLoopAddColumnNameToInsertColumn")&&void 0!==e.parameters.columnNames?1===e.parameters.count?A.substitute(ExcelCopilotCommandingHitlStrings.TableInsertColumnsLabelWithColumnName,{columnNumber:e.parameters.index+1,columnName:e.parameters.columnNames,tableName:e.parameters.name}):s.O.MissingIntent:A.substitute(ExcelCopilotCommandingHitlStrings.TableInsertColumnsLabel,{columnNumber:e.parameters.index+1,count:e.parameters.count,tableName:e.parameters.name})}function X(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableRemoveColumnsLabel,{columnNumber:e.parameters.index+1,count:e.parameters.count,tableName:e.parameters.name})}function Z(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableInsertRowsLabel,{rowNumber:e.parameters.index+1,count:e.parameters.count,tableName:e.parameters.name})}function K(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableRemoveRowsLabel,{rowNumber:e.parameters.index+1,count:e.parameters.count,tableName:e.parameters.name})}function ee(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableSortColumnLabel,{columnNumber:e.parameters.columnIndex,tableName:e.parameters.tableName})}function te(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableClearFiltersLabel,{tableName:e.entityId})}function ne(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnClearFilterLabel,{columnName:e.parameters.columnName,tableName:e.parameters.tableName})}function ae(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableReapplyFilterLabel,{tableName:e.parameters.tableName})}function oe(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableFilterColumnLabel,{columnName:e.parameters.columnName,tableName:e.parameters.tableName,values:e.parameters.values.join(", ")})}function re(e){switch(e.parameters.value1.valueCompareType){case S.default.Equals:{const t=I&&!isNaN(e.parameters.value1.value)?ExcelCopilotCommandingHitlStrings.TableColumnEqualsNumberFilterLabel:ExcelCopilotCommandingHitlStrings.TableColumnEqualsFilterLabel;return A.substitute(t,{columnName:e.parameters.columnName,value1:e.parameters.value1.value})}case S.default.DoesNotEqual:{const t=I&&!isNaN(e.parameters.value1.value)?ExcelCopilotCommandingHitlStrings.TableColumnDoesNotEqualNumberFilterLabel:ExcelCopilotCommandingHitlStrings.TableColumnDoesNotEqualFilterLabel;return A.substitute(t,{columnName:e.parameters.columnName,value1:e.parameters.value1.value})}case S.default.BeginsWith:return e.parameters.value2?A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnBeginsWithFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnBeginsWithFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.DoesNotBeginWith:return e.parameters.value2?A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnDoesNotBeginWithFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnDoesNotBeginWithFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.EndsWith:return e.parameters.value2?A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnEndsWithFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnEndsWithFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.DoesNotEndWith:return e.parameters.value2?A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnDoesNotEndWithFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnDoesNotEndWithFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.Contains:return e.parameters.value2?A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnContainsFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnContainsFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.DoesNotContain:return e.parameters.value2?A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnDoesNotContainFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnDoesNotContainFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.IsGreaterThan:return A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnIsGreaterThanFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.IsGreaterThenOrEqualTo:return e.parameters.value2&&e.parameters.value2.valueCompareType===S.default.IsLessThanOrEqualTo?A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnBetweenFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnIsGreaterThanOrEqualToFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.IsLessThen:return e.parameters.value2&&e.parameters.value2.valueCompareType===S.default.IsGreaterThan?A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnNotBetweenFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnIsLessThanFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.IsLessThanOrEqualTo:return A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnIsLessThanOrEqualToFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});default:return A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnCustomFilterLabel,{columnName:e.parameters.columnName,tableName:e.parameters.tableName})}}function ie(e){if(e.parameters.sharedSortConditions[0].columnName)return A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnByNameCustomSortLabel,{tableName:e.parameters.tableName,columnName:e.parameters.sharedSortConditions[0].columnName});if(e.parameters.sharedSortConditions[0].columnIndex>=0)return A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnByIndexCustomSortLabel,{tableName:e.parameters.tableName,columnIndex:e.parameters.sharedSortConditions[0].columnIndex});throw new l.sF("Unhandled intent case in Table.CustomSorted",l.UP.MissingIntent)}function le(e){return A.substitute((0,f.S0l)(),{tableName:e.entityId})}function se(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnTopFilterLabel,{direction:e.parameters.top?"top":"bottom",count:e.parameters.count,columnName:e.parameters.columnName,tableName:e.parameters.tableName})}function ce(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnDynamicFilterLabel,{columnName:e.parameters.columnName,tableName:e.parameters.tableName})}function de(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatBoldLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatBoldLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatBoldLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatBoldLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatBoldLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatBoldLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatBoldLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatBoldLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatBoldLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatBoldLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatBoldLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatBoldLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatUnboldLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatUnboldLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatUnboldLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatUnboldLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatUnboldLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatUnboldLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatUnboldLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatUnboldLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatUnboldLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatUnboldLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatUnboldLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatUnboldLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function ue(e){return e.parameters.events[0].parameters.value?ExcelCopilotCommandingHitlStrings.MultiRangeFormatBoldLabel:ExcelCopilotCommandingHitlStrings.MultiRangeFormatUnboldLabel}function me(e){return e.parameters.events[0].parameters.value?ExcelCopilotCommandingHitlStrings.MultiRangeFormatSuperscriptLabel:ExcelCopilotCommandingHitlStrings.MultiRangeFormatRemoveSuperscriptLabel}function ge(e){return e.parameters.events[0].parameters.value?ExcelCopilotCommandingHitlStrings.MultiRangeFormatSubscriptLabel:ExcelCopilotCommandingHitlStrings.MultiRangeFormatRemoveSubscriptLabel}function he(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatItalicLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatItalicLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatItalicLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatItalicLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatItalicLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatItalicLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatItalicLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatItalicLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatItalicLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatItalicLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatItalicLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatItalicLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatUnitalicizeLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatUnitalicizeLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatUnitalicizeLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatUnitalicizeLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatUnitalicizeLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatUnitalicizeLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatUnitalicizeLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatUnitalicizeLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatUnitalicizeLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatUnitalicizeLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatUnitalicizeLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatUnitalicizeLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function pe(e){if(e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General)return Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatSetFontColorLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatSetFontColorLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatSetFontColorLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatSetFontColorLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatSetFontColorLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatSetFontColorLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatSetFontColorLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatSetFontColorLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatSetFontColorLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatSetFontColorLabel,{color:R?p.g.colorNameFromHEX(e.parameters.value):e.parameters.value});if((0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName){const t=(0,m.yw9)("OfficeVSO_9425205_FixSetColumnFontColor")?ExcelCopilotCommandingHitlStrings.ColumnNameFormatSetFontColorLabel:ExcelCopilotCommandingHitlStrings.ColumnFormatSetFontColorLabel;return A.substitute(t,{columnName:e.parameters.columnName,color:R?p.g.colorNameFromHEX(e.parameters.value):e.parameters.value})}return A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatSetFontColorLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),color:R?p.g.colorNameFromHEX(e.parameters.value):e.parameters.value})}function be(e){return A.substitute(ExcelCopilotCommandingHitlStrings.MultiRangeFormatSetFontColorLabel,{color:R?p.g.colorNameFromHEX(e.parameters.events[0].parameters.value):e.parameters.events[0].parameters.value})}function fe(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatSetFontLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatSetFontLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatSetFontLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatSetFontLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatSetFontLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatSetFontLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatSetFontLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatSetFontLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatSetFontLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatSetFontLabel,{fontName:e.parameters.value}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameFormatSetFontLabel,{columnName:e.parameters.columnName,fontName:e.parameters.value}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatSetFontLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),fontName:e.parameters.value})}function Ce(e){return A.substitute(ExcelCopilotCommandingHitlStrings.MultiRangeFormatSetFontLabel,{fontName:e.parameters.events[0].parameters.value})}function ye(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatUnderlineLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatUnderlineLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatUnderlineLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatRemoveUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatRemoveUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatRemoveUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatRemoveUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatRemoveUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatRemoveUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatRemoveUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatRemoveUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatRemoveUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatRemoveUnderlineLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatRemoveUnderlineLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatRemoveUnderlineLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function ve(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatDoubleUnderlineLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatDoubleUnderlineLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatDoubleUnderlineLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatRemoveDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatRemoveDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatRemoveDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatRemoveDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatRemoveDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatRemoveDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatRemoveDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatRemoveDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatRemoveDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatRemoveDoubleUnderlineLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatRemoveDoubleUnderlineLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatRemoveDoubleUnderlineLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Te(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatStrikethroughLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatStrikethroughLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatStrikethroughLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatRemoveStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatRemoveStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatRemoveStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatRemoveStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatRemoveStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatRemoveStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatRemoveStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatRemoveStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatRemoveStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatRemoveStrikethroughLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatRemoveStrikethroughLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatRemoveStrikethroughLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function xe(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatSuperscriptLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatSuperscriptLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatSuperscriptLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatUnSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatRemoveSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatRemoveSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatRemoveSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatRemoveSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatRemoveSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatRemoveSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatRemoveSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatRemoveSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatRemoveSuperscriptLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatRemoveSuperscriptLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatRemoveSuperscriptLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Se(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatSubscriptLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatSubscriptLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatSubscriptLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatRemoveSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatRemoveSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatRemoveSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatRemoveSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatRemoveSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatRemoveSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatRemoveSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatRemoveSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatRemoveSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatRemoveSubscriptLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatRemoveSubscriptLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatRemoveSubscriptLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function we(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeSetFontSizeLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeSetFontSizeLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeSetFontSizeLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeSetFontSizeLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeSetFontSizeLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeSetFontSizeLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeSetFontSizeLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeSetFontSizeLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeSetFontSizeLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeSetFontSizeLabel,{fontSize:e.parameters.value}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameSetFontSizeLabel,{columnName:e.parameters.columnName,fontSize:e.parameters.value}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeSetFontSizeLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),fontSize:e.parameters.value})}function Ee(e){return A.substitute(ExcelCopilotCommandingHitlStrings.MultiRangeSetFontSizeLabel,{fontSize:e.parameters.events[0].parameters.value})}function Ie(e){if("none"===e.parameters.value)return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeRemoveFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeRemoveFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeRemoveFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeRemoveFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeRemoveFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeRemoveFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeRemoveFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeRemoveFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeRemoveFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeRemoveFontUnderlineStyleLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameRemoveFontUnderlineStyleLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RemoveFontUnderlineStyleLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)});let t="";const n=(0,m.yw9)("OfficeVSO_9413070_FixHiTLUnderlineStringLocalization");if(n)switch(e.parameters.value){case"single":t=ExcelCopilotCommandingHitlStrings.FontUnderlineStyleSingleLabel;break;case"double":t=ExcelCopilotCommandingHitlStrings.FontUnderlineStyleDoubleLabel;break;case"singleAccountant":t=ExcelCopilotCommandingHitlStrings.FontUnderlineStyleSingleAccountantLabel;break;case"doubleAccountant":t=ExcelCopilotCommandingHitlStrings.FontUnderlineStyleDoubleAccountantLabel;break;default:throw new l.sF("Unhandled underline style in Font.UnderlineStyle",l.UP.MissingIntent)}return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?n?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeApplyFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeApplyFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeApplyFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeApplyFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeApplyFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeApplyFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeApplyFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeApplyFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeApplyFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeApplyFontUnderlineStyleLabel,{style:t}):Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFontUnderlineStyleLabel,{style:e.parameters.value.replace(/([A-Z])/g," $1").toLocaleLowerCase()}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?n?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameApplyFontUnderlineStyleLabel,{style:t,columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameFontUnderlineStyleLabel,{style:e.parameters.value.replace(/([A-Z])/g," $1").toLocaleLowerCase(),columnName:e.parameters.columnName}):n?A.substitute(ExcelCopilotCommandingHitlStrings.ApplyFontUnderlineStyleLabel,{style:t,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):A.substitute(ExcelCopilotCommandingHitlStrings.FontUnderlineStyleLabel,{style:e.parameters.value.replace(/([A-Z])/g," $1").toLocaleLowerCase(),range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Re(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeSetBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeSetBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeSetBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeSetBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeSetBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeSetBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeSetBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeSetBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeSetBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeSetBackgroundColorLabel,{color:R?p.g.colorNameFromHEX(e.parameters.value):e.parameters.value}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameSetBackgroundColorLabel,{columnName:e.parameters.columnName,color:R?p.g.colorNameFromHEX(e.parameters.value):e.parameters.value}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeSetBackgroundColorLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),color:R?p.g.colorNameFromHEX(e.parameters.value):e.parameters.value})}function Ae(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeClearBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeClearBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeClearBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeClearBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeClearBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeClearBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeClearBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeClearBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeClearBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeClearBackgroundColorLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?(0,m.yw9)("OfficeVSO_9374824_FixClearFormatIntentString")?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameClearBackgroundColorLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatBoldLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeClearBackgroundColorLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Le(e){return A.substitute(ExcelCopilotCommandingHitlStrings.MultiRangeSetBackgroundColorLabel,{color:R?p.g.colorNameFromHEX(e.parameters.events[0].parameters.value):e.parameters.events[0].parameters.value})}function ke(e){const t=(e.parameters.value/C.bN).toFixed(2);return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeSetCellWidthLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeSetCellWidthLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeSetCellWidthLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeSetCellWidthLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeSetCellWidthLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeSetCellWidthLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeSetCellWidthLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeSetCellWidthLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeSetCellWidthLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeSetCellWidthLabel,{size:t}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameSetCellWidthLabel,{size:t,columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeSetCellWidthLabel,{size:t,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Fe(e){return A.substitute(ExcelCopilotCommandingHitlStrings.MultiRangeSetCellWidthLabel,{size:e.parameters.events[0].parameters.value})}function _e(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeSetCellHeightLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeSetCellHeightLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeSetCellHeightLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeSetCellHeightLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeSetCellHeightLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeSetCellHeightLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeSetCellHeightLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeSetCellHeightLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeSetCellHeightLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeSetCellHeightLabel,{size:e.parameters.value}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameSetCellHeightLabel,{columnName:e.parameters.columnName,size:e.parameters.value}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeSetCellHeightLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),size:e.parameters.value})}function Pe(e){return A.substitute(ExcelCopilotCommandingHitlStrings.MultiRangeSetCellHeightLabel,{size:e.parameters.events[0].parameters.value})}function Ne(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeApplyBorderLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeApplyBorderLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeApplyBorderLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeApplyBorderLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeApplyBorderLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeApplyBorderLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeApplyBorderLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeApplyBorderLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeApplyBorderLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeApplyBorderLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameApplyBorderLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeApplyBorderLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Me(e){return A.substitute(ExcelCopilotCommandingHitlStrings.NamedSheetViewDeleteLabel,{deletedNum:e.parameters.namedSheetViewNames.length})}function Oe(e){return A.substitute(ExcelCopilotCommandingHitlStrings.NamedSheetViewDuplicateLabel,{sheetViewName:e.parameters.namedSheetViewName})}function De(e){return void 0!==e.parameters.namedSheetViewKeepName&&e.parameters.namedSheetViewKeepName.length>0?A.substitute(ExcelCopilotCommandingHitlStrings.NamedSheetViewExitAndKeepLabel,{sheetViewName:e.parameters.namedSheetViewKeepName}):ExcelCopilotCommandingHitlStrings.NamedSheetViewExitLabel}function Be(e){return A.substitute(ExcelCopilotCommandingHitlStrings.NamedSheetViewKeepLabel,{sheetViewName:e.parameters.namedSheetViewName})}function $e(e){return A.substitute(ExcelCopilotCommandingHitlStrings.NamedSheetViewRenameLabel,{newSheetViewName:e.parameters.newNamedSheetViewName})}function He(e){return void 0!==e.parameters.namedSheetViewKeepName&&e.parameters.namedSheetViewKeepName.length>0?A.substitute(ExcelCopilotCommandingHitlStrings.NamedSheetViewSwitchAndKeepLabel,{sheetViewName:e.parameters.namedSheetViewName,sheetViewKeepName:e.parameters.namedSheetViewKeepName}):A.substitute(ExcelCopilotCommandingHitlStrings.NamedSheetViewSwitchLabel,{sheetViewName:e.parameters.namedSheetViewName})}function Ue(e){if(e.parameters.destinationRange.rangeType===i.RangeType.TableRange){let t;switch(e.parameters.destinationRange.range.subRange){case i.TableRangeOperationSubRange.WholeTable:t=ExcelCopilotCommandingHitlStrings.RangePasteInTableRangeLabel;break;case i.TableRangeOperationSubRange.Body:t=ExcelCopilotCommandingHitlStrings.RangePasteInTableBodyRangeLabel;break;case i.TableRangeOperationSubRange.HeaderRow:t=ExcelCopilotCommandingHitlStrings.RangePasteInTableHeaderRowRangeLabel;break;case i.TableRangeOperationSubRange.TotalRow:t=ExcelCopilotCommandingHitlStrings.RangePasteInTableTotalRowRangeLabel;break;case i.TableRangeOperationSubRange.General:if((0,m.yw9)("OfficeVSO_8900963_HumanInTheLoopRemoveSubRange"))return s.O.MissingIntent;t=ExcelCopilotCommandingHitlStrings.RangePasteInTableGeneralRangeLabel;break;case i.TableRangeOperationSubRange.Rows:case i.TableRangeOperationSubRange.Columns:case i.TableRangeOperationSubRange.ColumnsBody:t=ExcelCopilotCommandingHitlStrings.RangePasteInTableRangeLabel}return A.substitute(t,{sourceRange:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.sourceRange).range),tableName:e.entityId})}return A.substitute(ExcelCopilotCommandingHitlStrings.RangePasteLabel,{sourceRange:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.sourceRange).range),destinationRange:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.destinationRange).range)})}function qe(e){return A.substitute(ExcelCopilotCommandingHitlStrings.MultiRangePasteLabel,{sourceRange:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.events[0].parameters.sourceRange).range)})}function Ve(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangePasteTextLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function We(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetDuplicateLabel,{sheet:e.entityId})}function Ge(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetReapplyFiltersLabel,{sheet:e.entityId})}function ze(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetClearFiltersLabel,{sheet:e.entityId})}function Qe(e){return A.substitute(ExcelCopilotCommandingHitlStrings.CellFindContainingLabel,{search:e.parameters.searchString})}function je(e){const t=i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range,n=i.ExcelCalc.IExcelRangeToAddress(t);if((0,m.yw9)("OfficeVSO_9033826_SearchReplaceEmptyCellStrings")&&""===e.parameters.searchString){const a=t.topLeft.row===t.bottomRight.row&&t.topLeft.column===t.bottomRight.column?ExcelCopilotCommandingHitlStrings.ReplaceEmptyCellLabel:ExcelCopilotCommandingHitlStrings.ReplaceAllEmptyCellsLabel;return A.substitute(a,{replace:e.parameters.replaceWith,range:n})}return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeReplaceAllLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeReplaceAllLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeReplaceAllLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeReplaceAllLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeReplaceAllLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeReplaceAllLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeReplaceAllLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeReplaceAllLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeReplaceAllLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeReplaceAllLabel,{search:e.parameters.searchString,replace:e.parameters.replaceWith}):A.substitute(ExcelCopilotCommandingHitlStrings.ReplaceAllLabel,{search:e.parameters.searchString,replace:e.parameters.replaceWith,range:n})}function Je(e){return A.substitute(ExcelCopilotCommandingHitlStrings.ReplaceAllLabelGeneric,{search:e.parameters.events[0].parameters.searchString,replace:e.parameters.events[0].parameters.replaceWith})}function Ye(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeSetHorizontalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeSetHorizontalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeSetHorizontalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeSetHorizontalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeSetHorizontalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeSetHorizontalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeSetHorizontalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeSetHorizontalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeSetHorizontalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeSetHorizontalAlignmentLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameSetHorizontalAlignmentLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeSetHorizontalAlignmentLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Xe(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeSetVerticalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeSetVerticalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeSetVerticalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeSetVerticalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeSetVerticalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeSetVerticalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeSetVerticalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeSetVerticalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeSetVerticalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeSetVerticalAlignmentLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameSetVerticalAlignmentLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeSetVerticalAlignmentLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Ze(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeWrapTextLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeWrapTextLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeWrapTextLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeWrapTextLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeWrapTextLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeWrapTextLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeWrapTextLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeWrapTextLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeWrapTextLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeWrapTextLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameWrapTextLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeWrapTextLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeUnwrapTextLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeUnwrapTextLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeUnwrapTextLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeUnwrapTextLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeUnwrapTextLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeUnwrapTextLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeUnwrapTextLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeUnwrapTextLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeUnwrapTextLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeUnwrapTextLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameUnwrapTextLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeUnwrapTextLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Ke(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeChangeIndentLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeChangeIndentLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeChangeIndentLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeChangeIndentLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeChangeIndentLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeChangeIndentLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeChangeIndentLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeChangeIndentLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeChangeIndentLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeChangeIndentLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameChangeIndentLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeChangeIndentLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function et(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetReorderLabel,{sheet:e.entityId})}function tt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableToggleAutoFilterLabel,{tableName:e.entityId})}function nt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetToggleAutoFilterLabel,{sheet:e.entityId})}function at(e){return A.substitute(ExcelCopilotCommandingHitlStrings.SlicerInsertedLabel,{pivotTable:e.parameters.pivotTable,pivotName:e.parameters.pivotFieldName})}function ot(e){if(e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General){const t=e.parameters.range;if(t.subRange===i.TableRangeOperationSubRange.WholeTable)return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetTableRangeCreateChartLabel,{sheet:e.entityId,table:t.tableName})}return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetCreateChartLabel,{sheet:e.entityId})}function rt(e){return`#${i.ExcelCalc.toHexColor(e)}`}function it(e,t,n){const a=n?n(e.parameters.newValue):`${e.parameters.newValue}`;return e.parameters.category===i.ChartObjectCategory.ChartAxis?A.substitute(t,{newValue:a,axis:`${i.ChartAxisGroup[e.parameters.axisGroup].toLocaleLowerCase()} ${i.ChartAxisType[e.parameters.axisType].toLocaleLowerCase()} axis`,chartName:e.parameters.chartName}):e.parameters.category===i.ChartObjectCategory.Series?A.substitute(t,{newValue:a,seriesIndex:e.parameters.index,chartName:e.parameters.chartName}):A.substitute(t,{newValue:a,chartName:e.parameters.chartName})}function lt(e,t){return e.parameters.category===i.ChartObjectCategory.ChartAxis?A.substitute(t,{axis:`${i.ChartAxisGroup[e.parameters.axisGroup].toLocaleLowerCase()} ${i.ChartAxisType[e.parameters.axisType].toLocaleLowerCase()} axis`,chartName:e.parameters.chartName}):e.parameters.category===i.ChartObjectCategory.Series?A.substitute(t,{seriesIndex:e.parameters.index,chartName:e.parameters.chartName}):A.substitute(t,{chartName:e.parameters.chartName})}function st(e){return e.parameters.added?A.substitute(ExcelCopilotCommandingHitlStrings.VisualSerriesTrendlineAddedLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index}):A.substitute(ExcelCopilotCommandingHitlStrings.VisualSerriesTrendlineRemovedLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index,trendlineIndex:e.parameters.secondaryIndex})}function ct(e){return e.parameters.added?A.substitute(ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineTitleAddedLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index,trendlineIndex:e.parameters.secondaryIndex}):A.substitute(ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineTitleRemovedLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index,trendlineIndex:e.parameters.secondaryIndex})}function dt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetCreateChartLabel,{sheet:e.entityId})}function ut(e){return e.parameters?A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShowHeadingsLabel,{sheet:e.entityId}):A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetHideHeadingsLabel,{sheet:e.entityId})}function mt(e){return e.parameters?A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShowGridlinesLabel,{sheet:e.entityId}):A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetHideGridlinesLabel,{sheet:e.entityId})}function gt(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeRemoveDuplicatesLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeRemoveDuplicatesLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeRemoveDuplicatesLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeRemoveDuplicatesLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeRemoveDuplicatesLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeRemoveDuplicatesLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeRemoveDuplicatesLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeRemoveDuplicatesLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeRemoveDuplicatesLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeRemoveDuplicatesLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeRemoveDuplicatesLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function ht(e){const t=e.parameters?ExcelCopilotCommandingHitlStrings.TableAddTotalRowLabel:ExcelCopilotCommandingHitlStrings.TableRemoveTotalRowLabel;return A.substitute(t,{tableName:e.entityId})}function pt(e){const t=e.parameters?ExcelCopilotCommandingHitlStrings.TableAddHeaderRowLabel:ExcelCopilotCommandingHitlStrings.TableRemoveHeaderRowLabel;return A.substitute(t,{tableName:e.entityId})}function bt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableResizeLabel,{tableName:e.entityId})}function ft(e){return e.parameters.isCreation?A.substitute(ExcelCopilotCommandingHitlStrings.TableCreateAndFormatLabel,{tableName:e.parameters.tableName,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):A.substitute(ExcelCopilotCommandingHitlStrings.TableFormatLabel,{tableName:e.entityId})}function Ct(e){return""===e.parameters?A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetClearTabColorLabel,{sheet:e.entityId}):A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetSetTabColorLabel,{color:R?p.g.colorNameFromHEX(e.parameters):e.parameters,sheet:e.entityId})}function yt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartSwitchRowColumnLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function vt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartSelectDataLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Tt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartChangeTypeLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function xt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangeFlashFillLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.range.range)})}function St(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartChangeTitleLabel,{chartName:e.parameters.events[0].parameters.chartName,sheet:e.entityId})}function wt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartHideTitleLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Et(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartChangeAxisTitleLabel,{chartName:e.parameters.events[0].parameters.chartName,sheet:e.entityId})}function It(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartHideAxisTitleLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Rt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartChangeLegendLabel,{chartName:e.parameters.events[0].parameters.chartName,sheet:e.entityId})}function At(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartAxisTitleChangeTextLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Lt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetCharTitleChangeTextLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function kt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartHideLegendLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Ft(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartDataLabelChangePositionLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function _t(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartDataLabelChangeVisibilityLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Pt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartChangeAxisLabel,{chartName:e.parameters.events[0].parameters.chartName,sheet:e.entityId})}function Nt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartChangeAxisVisibilityLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Mt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableApplyStyleLabel,{tableName:e.entityId})}function Ot(e){const t=e.parameters?ExcelCopilotCommandingHitlStrings.TableAddBandedRowsLabel:ExcelCopilotCommandingHitlStrings.TableRemoveBandedRowsLabel;return A.substitute(t,{tableName:e.entityId})}function Dt(e){const t=e.parameters?ExcelCopilotCommandingHitlStrings.TableAddBandedColumnsLabel:ExcelCopilotCommandingHitlStrings.TableRemoveBandedColumnsLabel;return A.substitute(t,{tableName:e.entityId})}function Bt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableHighlightFirstColumnFilterLabel,{tableName:e.entityId})}function $t(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableHighlightLastColumnLabel,{tableName:e.entityId})}function Ht(e){const t=e.parameters?ExcelCopilotCommandingHitlStrings.TableAddFilterButtonLabel:ExcelCopilotCommandingHitlStrings.TableRemoveFilterButtonLabel;return A.substitute(t,{tableName:e.entityId})}function Ut(e){return e.parameters.rangeToFreeze?ExcelCopilotCommandingHitlStrings.WorksheetFreezePaneLabel:ExcelCopilotCommandingHitlStrings.WorksheetUnFreezePaneLabel}function qt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeInsertedLabel,{sheet:e.entityId})}function Vt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeSetStyleLabel,{sheet:e.entityId})}function Wt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartDeleteLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Gt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.ChartSeriesDeleteLabel,{chartName:e.parameters.chartName,sheet:e.entityId,seriesIndex:e.parameters.seriesIndex})}function zt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.ChartSeriesDataChangedLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.seriesIndex})}function Qt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetFloatingObjectDeleteLabel,{sheet:e.entityId})}function jt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartMoveAndResizeLabel,{chartName:e.parameters.name,sheet:e.entityId})}function Jt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetFloatingObjectMoveAndResizeLabel,{sheet:e.entityId})}function Yt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetFloatingObjectZOrderChangedLabel,{sheet:e.entityId})}function Xt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeRotateLabel,{sheet:e.entityId})}function Zt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeAltTextApplyLabel,{sheet:e.entityId})}function Kt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextChangedLabel,{sheet:e.entityId})}function en(e){return e.parameters.value?A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextBoldedLabel,{sheet:e.entityId}):A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextUnboldedLabel,{sheet:e.entityId})}function tn(e){return e.parameters.value?A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextItalicizedLabel,{sheet:e.entityId}):A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextUnitalicizedLabel,{sheet:e.entityId})}function nn(e){return e.parameters.value?A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextUnderlinedLabel,{sheet:e.entityId}):A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextUnderlineRemovedLabel,{sheet:e.entityId})}function an(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextFontNameChangedLabel,{sheet:e.entityId,fontName:e.parameters.value})}function on(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextFontSizeChangedLabel,{sheet:e.entityId,fontSize:e.parameters.value})}function rn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextFontColorChangedLabel,{sheet:e.entityId,fontColor:R?p.g.colorNameFromHEX(e.parameters.value):e.parameters.value})}function ln(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextHorizontallyAlignedLabel,{sheet:e.entityId})}function sn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextVerticallyAlignedLabel,{sheet:e.entityId})}function cn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangeGroupLabel,{sheet:e.entityId})}function dn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangeUnGroupLabel,{sheet:e.entityId})}function un(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetOutlineLevelsSetLabel,{sheet:e.entityId})}function mn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangeGroupDetailsShowLabel,{sheet:e.entityId})}function gn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangeGroupDetailsHideLabel,{sheet:e.entityId})}function hn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangeDataValidationChangedGroupLabel,{sheet:e.entityId})}function pn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableRenameLabel,{tableName:e.parameters})}function bn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableConvertToRangeLabel,{tableName:e.entityId})}function fn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableAltTextEditedLabel,{tableName:e.entityId})}function Cn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableAltTextTitleEditedLabel,{tableName:e.entityId})}function yn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableAltTextDescriptionEditedLabel,{tableName:e.entityId})}function vn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableChangeLabel,{pivotName:e.parameters.events[0].parameters.pivotName})}function Tn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableAddPivot,{pivotName:e.parameters.pivotName})}function xn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableRemovePivot,{pivotName:e.parameters.pivotName})}function Sn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableRefreshLabel,{pivotName:e.parameters})}function wn(e){return e.parameters.value?A.substitute(ExcelCopilotCommandingHitlStrings.PivotDrillExpandedLabel,{pivotName:e.parameters.pivotName,pivotItem:e.parameters.pivotItemName}):A.substitute(ExcelCopilotCommandingHitlStrings.PivotDrillCollapsedLabel,{pivotName:e.parameters.pivotName,pivotItem:e.parameters.pivotItemName})}function En(e){return A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableRenamedLabel,{newName:e.parameters.value})}function In(e){return e.parameters.value?A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableRowGrandTotalShownLabel,{pivotName:e.parameters.pivotName}):A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableRowGrandTotalHiddenLabel,{pivotName:e.parameters.pivotName})}function Rn(e){return e.parameters.value?A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableColumnGrandTotalShownLabel,{pivotName:e.parameters.pivotName}):A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableColumnGrandTotalHiddenLabel,{pivotName:e.parameters.pivotName})}function An(e){return A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableLayoutTypeSetLabel,{pivotName:e.parameters.pivotName})}function Ln(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetValuesFilterAppliedLabel,{range:i.ExcelCalc.columnFromIExcelAddress(e.parameters.range.range,e.parameters.column)})}function kn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetCustomFilterAppliedLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.range.range)})}function Fn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetDynamicFilterAppliedLabel,{range:i.ExcelCalc.ICellColumnSheetRangeToAddress({range:{topLeft:{column:e.parameters.column,row:null},bottomRight:{column:e.parameters.column,row:null}},sheet:""})})}function _n(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangeSortLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Pn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.ArtPasteSameWorkbookLabel,{sheet:i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.destinationRange).sheet})}function Nn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangeAutoSumLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.range.range)})}function Mn(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeHideRowsLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeHideRowsLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeHideRowsLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeHideRowsLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeHideRowsLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeHideRowsLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeHideRowsLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeHideRowsLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeHideRowsLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeHideRowsLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameHideRowsLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeHideRowsLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeUnhideRowsLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeUnhideRowsLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeUnhideRowsLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeUnhideRowsLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeUnhideRowsLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeUnhideRowsLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeUnhideRowsLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeUnhideRowsLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeUnhideRowsLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeUnhideRowsLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameUnhideRowsLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeUnhideRowsLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function On(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeHideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeHideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeHideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeHideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeHideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeHideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeHideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeHideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeHideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeHideColumnsLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameHideColumnsLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeHideColumnsLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeUnhideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeUnhideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeUnhideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeUnhideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeUnhideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeUnhideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeUnhideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeUnhideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeUnhideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeUnhideColumnsLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameUnhideColumnsLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeUnhideColumnsLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Dn(e){return e.parameters.events[0].parameters.value?ExcelCopilotCommandingHitlStrings.MultiRangeHideRowsLabel:ExcelCopilotCommandingHitlStrings.MultiRangeUnhideRowsLabel}function Bn(e){return e.parameters.events[0].parameters.value?ExcelCopilotCommandingHitlStrings.MultiRangeHideColumnsLabel:ExcelCopilotCommandingHitlStrings.MultiRangeUnhideColumnsLabel}function $n(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeConditionalFormattingCreatedGroupEventLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeConditionalFormattingCreatedGroupEventLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeConditionalFormattingCreatedGroupEventLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeConditionalFormattingCreatedGroupEventLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeConditionalFormattingCreatedGroupEventLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeConditionalFormattingCreatedGroupEventLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeConditionalFormattingCreatedGroupEventLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeConditionalFormattingCreatedGroupEventLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeConditionalFormattingCreatedGroupEventLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeConditionalFormattingCreatedGroupEventLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.ConditionalFormattingCreatedGroupEventLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Hn(e){const t=e.parameters.customFormat,n=[];t.IsTextBold&&n.push(ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatBoldLabel),t.IsTextItalic&&n.push(ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatItalicizeLabel),t.IsTextUnderlined&&n.push(ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatUnderlineLabel),t.IsTextDoubleUnderlined&&n.push(ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatDoubleUnderlineLabel);const a=R?p.g.colorNameFromHEX(t.BackgroundColor):t.BackgroundColor,o=R?p.g.colorNameFromHEX(t.TextColor):t.TextColor,r=t.IsTextStrikethrough,l=t.BorderFormat.LineStyle,s=t.BorderFormat.Color;if(null!=a){const e=A.substitute(ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatFillColorLabel,{color:a});n.push(e)}if(null!=o){const e=A.substitute(ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatFontColorLabel,{color:o});n.push(e)}if(r&&n.push(ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatStrikethroughLabel),l[0]!==i.BorderLineStyle.None){const e=(0,h.Cn)(s[0]),t=R?p.g.colorNameFromHEX((0,h.S)(e)):(0,h.S)(e),a=A.substitute(y.$8[l[0]](),{color:t});n.push(a)}const c=[{key:d.Dh.EventType,value:d.Mv.LogSuccessMessageFormattingParameters},{key:d.Dh.SuccessMessageNumParameters,value:n.length},{key:d.Dh.SuccessMessageFormattingParameters,value:n.join(", ")}];return(0,T.j)(c),n}function Un(e){return Ea(e,ExcelCopilotCommandingHitlStrings.TableRangeConditionalFormattingApplyFormattingCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeConditionalFormattingApplyFormattingCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeConditionalFormattingApplyFormattingCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeConditionalFormattingApplyFormattingCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeConditionalFormattingApplyFormattingCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeConditionalFormattingApplyFormattingCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeConditionalFormattingApplyFormattingCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeConditionalFormattingApplyFormattingCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeConditionalFormattingApplyFormattingCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeConditionalFormattingApplyFormattingCustomCreatedLabel,{})}function qn(e,t){return(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameConditionalFormattingApplyFormattingCustomCreatedLabel,{columnName:e}):A.substitute(ExcelCopilotCommandingHitlStrings.ConditionalFormattingApplyFormattingCustomCreatedLabel,{range:t})}function Vn(e){const t=/"|=|DATEVALUE|\(|\)/g,n=e.parameters.rule,a=n.operator,o=n.formula1.replace(t,"");let r=y.X7[a](I&&!isNaN(o));const l=(0,m.yw9)("OfficeVSO_9352581_CFCustomFormulaValue2BugFix");if(l||(r=A.substitute(r,{value1:o})),!n.formula2||a!==x.default.Between&&a!==x.default.NotBetween)l&&(r=A.substitute(r,{value1:o}));else{const e=n.formula2.replace(t,"");r=l?A.substitute(r,{value1:o,value2:e}):A.substitute(r,{value2:n.formula2})}const s=new b.J(b.D.CellValue),c=e.parameters.customFormat;c&&(s.customFormat=c);const d={title:r,explanation:"",conditionalFormatResponseCardData:s,subExplanations:Hn(e)};return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?(d.explanation=Un(e.parameters.range),d):(d.explanation=qn(e.parameters.columnName,i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)),d)}function Wn(e){const t=e.parameters.rule,n=t.formula,a=t.formulaExplanation,o=new b.J(b.D.CustomCreated);o.customFormula=n,o.formulaExplanation=a;const r=e.parameters.customFormat;r&&(o.customFormat=r);const l={title:ExcelCopilotCommandingHitlStrings.ConditionalFormattingCustomFormulaPrefixLabel,explanation:"",subExplanations:Hn(e),conditionalFormatResponseCardData:o};return e.parameters.rangeType===i.RangeType.TableRange?(l.explanation=Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeConditionalFormattingCustomFormulaCreatedLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeConditionalFormattingCustomFormulaCreatedLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeConditionalFormattingCustomFormulaCreatedLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeConditionalFormattingCustomFormulaCreatedLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeConditionalFormattingCustomFormulaCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeConditionalFormattingCustomFormulaCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeConditionalFormattingCustomFormulaCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeConditionalFormattingCustomFormulaCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeConditionalFormattingCustomFormulaCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeConditionalFormattingCustomFormulaCreatedLabel,{}),l):((0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?l.explanation=A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameConditionalFormattingCustomFormulaCreatedLabel,{columnName:e.parameters.columnName}):l.explanation=A.substitute(ExcelCopilotCommandingHitlStrings.ConditionalFormattingCustomFormulaCreatedLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}),l)}function Gn(e){const t=e.parameters.rule,n=A.substitute(y.mY[t.operator](),{text:t.text}),a=new b.J(b.D.TextComparison),o=e.parameters.customFormat;o&&(a.customFormat=o);const r={title:n,explanation:"",conditionalFormatResponseCardData:a,subExplanations:Hn(e)};return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?(r.explanation=Un(e.parameters.range),r):(r.explanation=qn(e.parameters.columnName,i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)),r)}function zn(e){const t=new b.J(b.D.ColorScale),n=e.parameters.colorScaleFormat;n&&(t.originalHexColors=n);const a={title:ExcelCopilotCommandingHitlStrings.ConditionalFormattingColorScalePrefixLabel,explanation:"",conditionalFormatResponseCardData:t};let o="",r="",l="";return n&&(o=R?p.g.colorNameFromHEX(n.minimumColor):n.minimumColor,r=R?p.g.colorNameFromHEX(n.midpointColor):n.midpointColor,l=R?p.g.colorNameFromHEX(n.maximumColor):n.maximumColor),e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?(a.explanation=r?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,{color1:o,color2:r,color3:l}):Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeConditionalFormattingColorScaleTwoColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeConditionalFormattingColorScaleTwoColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeConditionalFormattingColorScaleTwoColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeConditionalFormattingColorScaleTwoColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeConditionalFormattingColorScaleTwoColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeConditionalFormattingColorScaleTwoColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeConditionalFormattingColorScaleTwoColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeConditionalFormattingColorScaleTwoColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeConditionalFormattingColorScaleTwoColorsCustomCreatedLabel,{color1:o,color2:l}),a):(a.explanation=r?A.substitute(ExcelCopilotCommandingHitlStrings.ConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,{color1:o,color2:r,color3:l,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):A.substitute(ExcelCopilotCommandingHitlStrings.ConditionalFormattingColorScaleTwoColorsCustomCreatedLabel,{color1:o,color2:l,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}),a)}function Qn(e){const t=e.parameters.dataBarFormat;let n=!1,a="";t&&(n=t.isGradientFill,a=R?p.g.colorNameFromHEX(t.fillColor):t.fillColor);const o=new b.J(b.D.DataBar);t&&(o.dataBarFormat=t);const r={title:ExcelCopilotCommandingHitlStrings.ConditionalFormattingDataBarPrefixLabel,explanation:"",conditionalFormatResponseCardData:o};if(e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General)return n?(r.explanation=Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeConditionalFormattingGradientDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeConditionalFormattingGradientDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeConditionalFormattingGradientDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeConditionalFormattingGradientDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeConditionalFormattingGradientDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeConditionalFormattingGradientDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeConditionalFormattingGradientDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeConditionalFormattingGradientDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeConditionalFormattingGradientDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeConditionalFormattingGradientDataBarCustomCreatedLabel,{color:a}),r):(r.explanation=Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeConditionalFormattingSolidDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeConditionalFormattingSolidDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeConditionalFormattingSolidDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeConditionalFormattingSolidDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeConditionalFormattingSolidDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeConditionalFormattingSolidDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeConditionalFormattingSolidDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeConditionalFormattingSolidDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeConditionalFormattingSolidDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeConditionalFormattingSolidDataBarCustomCreatedLabel,{color:a}),r);const l=n?ExcelCopilotCommandingHitlStrings.ConditionalFormattingGradientDataBarCustomCreatedLabel:ExcelCopilotCommandingHitlStrings.ConditionalFormattingSolidDataBarCustomCreatedLabel;return r.explanation=A.substitute(l,{color:a,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}),r}function jn(e){let t;t=e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeConditionalFormattingIconSetCreatedLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeConditionalFormattingIconSetCreatedLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeConditionalFormattingIconSetCreatedLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeConditionalFormattingIconSetCreatedLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeConditionalFormattingIconSetCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeConditionalFormattingIconSetCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeConditionalFormattingIconSetCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeConditionalFormattingIconSetCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeConditionalFormattingIconSetCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeConditionalFormattingIconSetCreatedLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSetCreatedLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)});const n=e.parameters.style,a=new b.J(b.D.IconSet);return a.iconSetNumber=n,{title:ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSetPrefixLabel,explanation:t,conditionalFormatResponseCardData:a,subExplanations:[y.Is[n]()]}}function Jn(e){const t=e.parameters.rule,n=new b.J(b.D.Preset),a=e.parameters.customFormat;a&&(n.customFormat=a);const o={title:y.y6[t.criterion](),explanation:"",conditionalFormatResponseCardData:n,subExplanations:Hn(e)};return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?(o.explanation=Un(e.parameters.range),o):(o.explanation=qn(e.parameters.columnName,i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)),o)}function Yn(e){const t=e.parameters.rule,n=new b.J(b.D.Dates),a=e.parameters.customFormat;a&&(n.customFormat=a);const o={title:y.sh[t.timePeriodType](),explanation:"",conditionalFormatResponseCardData:n,subExplanations:Hn(e)};return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?(o.explanation=Un(e.parameters.range),o):(o.explanation=qn(e.parameters.columnName,i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)),o)}function Xn(e){const t=e.parameters.rule,n=new b.J(b.D.UniqueValue),a=e.parameters.customFormat;a&&(n.customFormat=a);const o={title:t.unique?ExcelCopilotCommandingHitlStrings.ConditionalFormattingUniquePrefixLabel:ExcelCopilotCommandingHitlStrings.ConditionalFormattingDuplicatePrefixLabel,explanation:"",conditionalFormatResponseCardData:n,subExplanations:Hn(e)};return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?(o.explanation=Un(e.parameters.range),o):(o.explanation=qn(e.parameters.columnName,i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)),o)}function Zn(e){const t=e.parameters.rule,n=t.rank,a=y.qq[t.type](),o=A.substitute(a,{number:n}),r=new b.J(b.D.TopBottom),l=e.parameters.customFormat;l&&(r.customFormat=l);const s={title:o,explanation:"",conditionalFormatResponseCardData:r,subExplanations:Hn(e)};return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?(s.explanation=Un(e.parameters.range),s):(s.explanation=qn(e.parameters.columnName,i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)),s)}function Kn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.ConditionalFormattingEditedGroupEventLabel,{sheet:e.entityId})}function ea(e){return A.substitute(ExcelCopilotCommandingHitlStrings.ConditionalFormattingRuleDeletedLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.ranges[0]).range)})}function ta(e){return s.O.NoIntentNeeded}function na(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeConditionalFormattingDeletedLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeConditionalFormattingDeletedLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeConditionalFormattingDeletedLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeConditionalFormattingDeletedLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeConditionalFormattingDeletedLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeConditionalFormattingDeletedLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeConditionalFormattingDeletedLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeConditionalFormattingDeletedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeConditionalFormattingDeletedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeConditionalFormattingDeletedLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.ConditionalFormattingDeletedLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function aa(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeCellStyleAppliedLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeCellStyleAppliedLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeCellStyleAppliedLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeCellStyleAppliedLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeCellStyleAppliedLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeCellStyleAppliedLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeCellStyleAppliedLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeCellStyleAppliedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeCellStyleAppliedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeCellStyleAppliedLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameCellStyleAppliedLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeCellStyleAppliedLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function oa(e){return A.substitute(ExcelCopilotCommandingHitlStrings.PictureInsertedEventLabel,{sheet:e.entityId})}function ra(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?Ea(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeCustomSortLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeCustomSortLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeCustomSortLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeCustomSortLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeCustomSortLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeCustomSortLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeCustomSortLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeCustomSortLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameCustomSortLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexCustomSortLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeCustomSortLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function ia(e){return A.substitute(ExcelCopilotCommandingHitlStrings.AutoFilterCustomSortLabel,{sheet:i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).sheet})}function la(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TextToColumnsLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.sourceRange).range)})}function sa(e){return A.substitute(ExcelCopilotCommandingHitlStrings.AllowEditRangeAddedLabel,{range:void 0!==e.parameters.events?e.parameters.events[1].parameters.title:e.parameters.title})}function ca(e){return A.substitute(ExcelCopilotCommandingHitlStrings.AllowEditRangeDeletedLabel,{range:void 0!==e.parameters.events?e.parameters.events[1].parameters.title:e.parameters.title})}function da(e){return A.substitute(ExcelCopilotCommandingHitlStrings.AllowEditRangeEditedLabel,{range:void 0!==e.parameters.events?e.parameters.events[1].parameters.title:e.parameters.title})}function ua(e){return A.substitute(ExcelCopilotCommandingHitlStrings.SheetProtectionOptionsUpdatedLabel,{sheet:e.entityId})}function ma(e){return A.substitute(ExcelCopilotCommandingHitlStrings.SheetProtectionPasswordUpdatedLabel,{sheet:e.entityId})}function ga(e){return A.substitute(ExcelCopilotCommandingHitlStrings.SheetProtectionPausedLabel,{sheet:e.entityId})}function ha(e){return A.substitute(ExcelCopilotCommandingHitlStrings.SheetProtectionProtectedLabel,{sheet:e.entityId})}function pa(e){return A.substitute(ExcelCopilotCommandingHitlStrings.SheetProtectionResumedLabel,{sheet:e.entityId})}function ba(e){return A.substitute(ExcelCopilotCommandingHitlStrings.SheetProtectionUnprotectedLabel,{sheet:e.entityId})}function fa(e){return A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationListRangeLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),source:e.parameters.source})}function Ca(e){return A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationCustomRangeLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),formula:e.parameters.formula})}function ya(e){return""!==e.parameters.formula2?A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationTernaryBasicRangeLabel,{validationType:"date",range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),operator:e.parameters.operator,formula1:e.parameters.formula1,formula2:e.parameters.formula2}):A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationBinaryBasicRangeLabel,{validationType:"date",range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),operator:e.parameters.operator,formula1:e.parameters.formula1})}function va(e){return""!==e.parameters.formula2?A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationTernaryBasicRangeLabel,{validationType:"decimal",range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),operator:e.parameters.operator,formula1:e.parameters.formula1,formula2:e.parameters.formula2}):A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationBinaryBasicRangeLabel,{validationType:"decimal",range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),operator:e.parameters.operator,formula1:e.parameters.formula1})}function Ta(e){return""!==e.parameters.formula2?A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationTernaryBasicRangeLabel,{validationType:"text length",range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),operator:e.parameters.operator,formula1:e.parameters.formula1,formula2:e.parameters.formula2}):A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationBinaryBasicRangeLabel,{validationType:"text length",range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),operator:e.parameters.operator,formula1:e.parameters.formula1})}function xa(e){return""!==e.parameters.formula2?A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationTernaryBasicRangeLabel,{validationType:"time",range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),operator:e.parameters.operator,formula1:e.parameters.formula1,formula2:e.parameters.formula2}):A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationBinaryBasicRangeLabel,{validationType:"time",range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),operator:e.parameters.operator,formula1:e.parameters.formula1})}function Sa(e){return""!==e.parameters.formula2?A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationTernaryBasicRangeLabel,{validationType:"whole number",range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),operator:e.parameters.operator,formula1:e.parameters.formula1,formula2:e.parameters.formula2}):A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationBinaryBasicRangeLabel,{validationType:"whole number",range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),operator:e.parameters.operator,formula1:e.parameters.formula1})}function wa(e){return A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationClearRangeLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Ea(e,t,n,a,o,r,l,c,d,u,g,h){let p;switch(h.tableName=e.tableName,e.subRange){case i.TableRangeOperationSubRange.WholeTable:p=t;break;case i.TableRangeOperationSubRange.Body:p=n;break;case i.TableRangeOperationSubRange.HeaderRow:p=a;break;case i.TableRangeOperationSubRange.TotalRow:p=o;break;case i.TableRangeOperationSubRange.General:if((0,m.yw9)("OfficeVSO_8900963_HumanInTheLoopRemoveSubRange"))return s.O.MissingIntent;p=r;break;case i.TableRangeOperationSubRange.Columns:case i.TableRangeOperationSubRange.ColumnsBody:{p=d;const t=e.subRangeValues;if(t.columnNames)1===t.columnNames.length?(p=u,h.columnName=t.columnNames[0]):h.count=t.columnNames.length;else{const t=e.subRangeValues;1===t.count?(p=g,h.columnIndex=t.firstIndex):h.count=t.count}break}case i.TableRangeOperationSubRange.Rows:{const t=e.subRangeValues;1===t.count?(p=c,h.rowIndex=t.firstIndex):(p=l,h.count=t.count);break}}return A.substitute(p,h)}var Ia=n(731137);const Ra=(0,m.yw9)("OfficeVSO_8999367_UseSeparateStringsForNumberValuesHiTL"),Aa={...Ia,substitute:E.A};function La(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeCellTextOrientationChangedLabel,Aa.Intents.TableBodyRangeCellTextOrientationChangedLabel,Aa.Intents.TableHeaderRowRangeCellTextOrientationChangedLabel,Aa.Intents.TableTotalRowRangeCellTextOrientationChangedLabel,Aa.Intents.TableGeneralRangeCellTextOrientationChangedLabel,Aa.Intents.TableRowsRangeCellTextOrientationChangedLabel,Aa.Intents.TableRowByIndexRangeCellTextOrientationChangedLabel,Aa.Intents.TableColumnsRangeCellTextOrientationChangedLabel,Aa.Intents.TableColumnByNameRangeCellTextOrientationChangedLabel,Aa.Intents.TableColumnByIndexRangeCellTextOrientationChangedLabel,{orientation:e.parameters.value}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnNameCellTextOrientationChanged,{columnName:e.parameters.columnName,orientation:e.parameters.value}):Aa.substitute(Aa.Intents.CellTextOrientationChanged,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),orientation:e.parameters.value})}function ka(e){return Aa.substitute(Aa.Intents.WorksheetAddedWithNameLabel,{worksheetName:e.parameters})}function Fa(e){return Aa.substitute(Aa.Intents.WorksheetRenameLabel,{worksheetName:e.parameters})}function _a(e){return Aa.substitute(Aa.Intents.WorksheetDeleteMultipleLabel,{count:e.parameters.events.length})}function Pa(e){const t=e.parameters.values;return 1===t.length&&1===t[0].length?Aa.substitute(Aa.Intents.RangeEditValueStringLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),value:`${t[0][0]}`}):Aa.substitute(Aa.Intents.RangeEditLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Na(e){const t=Ra&&!isNaN(e.parameters.value)?Aa.Intents.RangeEditValueNumberLabel:Aa.Intents.RangeEditValueStringLabel;return Aa.substitute(t,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),value:`${e.parameters.value}`})}function Ma(e){return e.parameters.command===w.default.ClearCellsFormat?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeClearFormatLabel,Aa.Intents.TableBodyRangeClearFormatLabel,Aa.Intents.TableHeaderRowRangeClearFormatLabel,Aa.Intents.TableTotalRowRangeClearFormatLabel,Aa.Intents.TableGeneralRangeClearFormatLabel,Aa.Intents.TableRowsRangeClearFormatLabel,Aa.Intents.TableRowByIndexRangeClearFormatLabel,Aa.Intents.TableColumnsRangeClearFormatLabel,Aa.Intents.TableColumnByNameRangeClearFormatLabel,Aa.Intents.TableColumnByIndexRangeClearFormatLabel,{}):Aa.substitute(Aa.Intents.RangeClearFormatLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeClearLabel,Aa.Intents.TableBodyRangeClearLabel,Aa.Intents.TableHeaderRowRangeClearLabel,Aa.Intents.TableTotalRowRangeClearLabel,Aa.Intents.TableGeneralRangeClearLabel,Aa.Intents.TableRowsRangeClearLabel,Aa.Intents.TableRowByIndexRangeClearLabel,Aa.Intents.TableColumnsRangeClearLabel,Aa.Intents.TableColumnByNameRangeClearLabel,Aa.Intents.TableColumnByIndexRangeClearLabel,{}):Aa.substitute(Aa.Intents.RangeClearLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Oa(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeDeleteLabel,Aa.Intents.TableBodyRangeDeleteLabel,Aa.Intents.TableHeaderRowRangeDeleteLabel,Aa.Intents.TableTotalRowRangeDeleteLabel,Aa.Intents.TableGeneralRangeDeleteLabel,Aa.Intents.TableRowsRangeDeleteLabel,Aa.Intents.TableRowByIndexRangeDeleteLabel,Aa.Intents.TableColumnsRangeDeleteLabel,Aa.Intents.TableColumnByNameRangeDeleteLabel,Aa.Intents.TableColumnByIndexRangeDeleteLabel,{}):Aa.substitute(Aa.Intents.RangeDeleteLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Da(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeInsertedLabel,Aa.Intents.TableBodyRangeInsertedLabel,Aa.Intents.TableHeaderRowRangeInsertedLabel,Aa.Intents.TableTotalRowRangeInsertedLabel,Aa.Intents.TableGeneralRangeInsertedLabel,Aa.Intents.TableRowsRangeInsertedLabel,Aa.Intents.TableRowByIndexRangeInsertedLabel,Aa.Intents.TableColumnsRangeInsertedLabel,Aa.Intents.TableColumnByNameRangeInsertedLabel,Aa.Intents.TableColumnByIndexRangeInsertedLabel,{}):Aa.substitute(Aa.Intents.RangeInsertLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Ba(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeMergeLabel,Aa.Intents.TableBodyRangeMergeLabel,Aa.Intents.TableHeaderRowRangeMergeLabel,Aa.Intents.TableTotalRowRangeMergeLabel,Aa.Intents.TableGeneralRangeMergeLabel,Aa.Intents.TableRowsRangeMergeLabel,Aa.Intents.TableRowByIndexRangeMergeLabel,Aa.Intents.TableColumnsRangeMergeLabel,Aa.Intents.TableColumnByNameRangeMergeLabel,Aa.Intents.TableColumnByIndexRangeMergeLabel,{}):Aa.substitute(Aa.Intents.RangeMergeLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function $a(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeUnmergeLabel,Aa.Intents.TableBodyRangeUnmergeLabel,Aa.Intents.TableHeaderRowRangeUnmergeLabel,Aa.Intents.TableTotalRowRangeUnmergeLabel,Aa.Intents.TableGeneralRangeUnmergeLabel,Aa.Intents.TableRowsRangeUnmergeLabel,Aa.Intents.TableRowByIndexRangeUnmergeLabel,Aa.Intents.TableColumnsRangeUnmergeLabel,Aa.Intents.TableColumnByNameRangeUnmergeLabel,Aa.Intents.TableColumnByIndexRangeUnmergeLabel,{}):Aa.substitute(Aa.Intents.RangeUnmergeLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Ha(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeColumnsAutofitLabel,Aa.Intents.TableBodyRangeColumnsAutofitLabel,Aa.Intents.TableHeaderRowRangeColumnsAutofitLabel,Aa.Intents.TableTotalRowRangeColumnsAutofitLabel,Aa.Intents.TableGeneralRangeColumnsAutofitLabel,Aa.Intents.TableRowsRangeColumnsAutofitLabel,Aa.Intents.TableRowByIndexRangeColumnsAutofitLabel,Aa.Intents.TableColumnsRangeColumnsAutofitLabel,Aa.Intents.TableColumnByNameRangeColumnsAutofitLabel,Aa.Intents.TableColumnByIndexRangeColumnsAutofitLabel,{}):Aa.substitute(Aa.Intents.RangeColumnsAutofitLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Ua(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeRowsAutofitLabel,Aa.Intents.TableBodyRangeRowsAutofitLabel,Aa.Intents.TableHeaderRowRangeRowsAutofitLabel,Aa.Intents.TableTotalRowRangeRowsAutofitLabel,Aa.Intents.TableGeneralRangeRowsAutofitLabel,Aa.Intents.TableRowsRangeRowsAutofitLabel,Aa.Intents.TableRowByIndexRangeRowsAutofitLabel,Aa.Intents.TableColumnsRangeRowsAutofitLabel,Aa.Intents.TableColumnByNameRangeRowsAutofitLabel,Aa.Intents.TableColumnByIndexRangeRowsAutofitLabel,{}):Aa.substitute(Aa.Intents.RangeRowsAutofitLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function qa(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeUseStandardHeightLabel,Aa.Intents.TableBodyRangeUseStandardHeightLabel,Aa.Intents.TableHeaderRowRangeUseStandardHeightLabel,Aa.Intents.TableTotalRowRangeUseStandardHeightLabel,Aa.Intents.TableGeneralRangeUseStandardHeightLabel,Aa.Intents.TableRowsRangeUseStandardHeightLabel,Aa.Intents.TableRowByIndexRangeUseStandardHeightLabel,Aa.Intents.TableColumnsRangeUseStandardHeightLabel,Aa.Intents.TableColumnByNameRangeUseStandardHeightLabel,Aa.Intents.TableColumnByIndexRangeUseStandardHeightLabel,{}):Aa.substitute(Aa.Intents.RangeUseStandardHeightLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Va(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeUseStandardWidthLabel,Aa.Intents.TableBodyRangeUseStandardWidthLabel,Aa.Intents.TableHeaderRowRangeUseStandardWidthLabel,Aa.Intents.TableTotalRowRangeUseStandardWidthLabel,Aa.Intents.TableGeneralRangeUseStandardWidthLabel,Aa.Intents.TableRowsRangeUseStandardWidthLabel,Aa.Intents.TableRowByIndexRangeUseStandardWidthLabel,Aa.Intents.TableColumnsRangeUseStandardWidthLabel,Aa.Intents.TableColumnByNameRangeUseStandardWidthLabel,Aa.Intents.TableColumnByIndexRangeUseStandardWidthLabel,{}):Aa.substitute(Aa.Intents.RangeUseStandardWidthLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Wa(e){return Aa.substitute(Aa.Intents.RangeHyperlinkLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Ga(e){return Aa.substitute(Aa.Intents.RangeRemoveHyperlinkLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.range.range)})}function za(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeNumberFormatLabel,Aa.Intents.TableBodyRangeNumberFormatLabel,Aa.Intents.TableHeaderRowRangeNumberFormatLabel,Aa.Intents.TableTotalRowRangeNumberFormatLabel,Aa.Intents.TableGeneralRangeNumberFormatLabel,Aa.Intents.TableRowsRangeNumberFormatLabel,Aa.Intents.TableRowByIndexRangeNumberFormatLabel,Aa.Intents.TableColumnsRangeNumberFormatLabel,Aa.Intents.TableColumnByNameRangeNumberFormatLabel,Aa.Intents.TableColumnByIndexRangeNumberFormatLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnNameNumberFormatLabel,{numberFormat:(0,v.X)(e.parameters.value,!1),columnName:e.parameters.columnName}):Aa.substitute(Aa.Intents.RangeNumberFormatLabel,{numberFormat:(0,v.X)(e.parameters.value,!1),range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Qa(e){return 0===e.parameters.copyCutOperation?Aa.substitute(Aa.Intents.RangePasteCopyLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.destinationRange.range)}):Aa.substitute(Aa.Intents.RangePasteCutLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.destinationRange.range)})}function ja(e){return Aa.substitute(Aa.Intents.RangeFillLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.target)})}function Ja(e){return Aa.substitute(Aa.Intents.TableCreateLabel,{tableName:e.parameters.tableName,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Ya(e){return Aa.substitute(Aa.Intents.TableInsertColumnsLabel,{columnNumber:e.parameters.index+1,count:e.parameters.count,tableName:e.parameters.name})}function Xa(e){return Aa.substitute(Aa.Intents.TableRemoveColumnsLabel,{columnNumber:e.parameters.index+1,count:e.parameters.count,tableName:e.parameters.name})}function Za(e){return Aa.substitute(Aa.Intents.TableInsertRowsLabel,{rowNumber:e.parameters.index+1,count:e.parameters.count,tableName:e.parameters.name})}function Ka(e){return Aa.substitute(Aa.Intents.TableRemoveRowsLabel,{rowNumber:e.parameters.index+1,count:e.parameters.count,tableName:e.parameters.name})}function eo(e){return Aa.substitute(Aa.Intents.TableSortColumnLabel,{columnNumber:e.parameters.columnIndex,tableName:e.parameters.tableName})}function to(e){return Aa.substitute(Aa.Intents.TableClearFiltersLabel,{tableName:e.entityId})}function no(e){return Aa.substitute(Aa.Intents.TableColumnClearFilterLabel,{columnName:e.parameters.columnName,tableName:e.parameters.tableName})}function ao(e){return Aa.substitute(Aa.Intents.TableReapplyFilterLabel,{tableName:e.parameters.tableName})}function oo(e){return Aa.substitute(Aa.Intents.TableFilterColumnLabel,{columnName:e.parameters.columnName,tableName:e.parameters.tableName,values:e.parameters.values.join(", ")})}function ro(e){switch(e.parameters.value1.valueCompareType){case S.default.Equals:return Aa.substitute(Aa.Intents.TableColumnEqualsFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.DoesNotEqual:return Aa.substitute(Aa.Intents.TableColumnDoesNotEqualFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.BeginsWith:return e.parameters.value2?Aa.substitute(Aa.Intents.TableColumnBeginsWithFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):Aa.substitute(Aa.Intents.TableColumnBeginsWithFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.DoesNotBeginWith:return e.parameters.value2?Aa.substitute(Aa.Intents.TableColumnDoesNotBeginWithFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):Aa.substitute(Aa.Intents.TableColumnDoesNotBeginWithFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.EndsWith:return e.parameters.value2?Aa.substitute(Aa.Intents.TableColumnEndsWithFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):Aa.substitute(Aa.Intents.TableColumnEndsWithFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.DoesNotEndWith:return e.parameters.value2?Aa.substitute(Aa.Intents.TableColumnDoesNotEndWithFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):Aa.substitute(Aa.Intents.TableColumnDoesNotEndWithFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.Contains:return e.parameters.value2?Aa.substitute(Aa.Intents.TableColumnContainsFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):Aa.substitute(Aa.Intents.TableColumnContainsFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.DoesNotContain:return e.parameters.value2?Aa.substitute(Aa.Intents.TableColumnDoesNotContainFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):Aa.substitute(Aa.Intents.TableColumnDoesNotContainFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.IsGreaterThan:return Aa.substitute(Aa.Intents.TableColumnIsGreaterThanFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.IsGreaterThenOrEqualTo:return e.parameters.value2&&e.parameters.value2.valueCompareType===S.default.IsLessThanOrEqualTo?Aa.substitute(Aa.Intents.TableColumnBetweenFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):Aa.substitute(Aa.Intents.TableColumnIsGreaterThanOrEqualToFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.IsLessThen:return e.parameters.value2&&e.parameters.value2.valueCompareType===S.default.IsGreaterThan?Aa.substitute(Aa.Intents.TableColumnNotBetweenFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):Aa.substitute(Aa.Intents.TableColumnIsLessThanFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.IsLessThanOrEqualTo:return Aa.substitute(Aa.Intents.TableColumnIsLessThanOrEqualToFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});default:return Aa.substitute(Aa.Intents.TableColumnCustomFilterLabel,{columnName:e.parameters.columnName,tableName:e.parameters.tableName})}}function io(e){return e.parameters.sharedSortConditions[0].columnName?Aa.substitute(Aa.Intents.TableColumnByNameCustomSortLabel,{tableName:e.parameters.tableName,columnName:e.parameters.sharedSortConditions[0].columnName}):e.parameters.sharedSortConditions[0].columnIndex?Aa.substitute(Aa.Intents.TableColumnByIndexCustomSortLabel,{tableName:e.parameters.tableName,columnIndex:e.parameters.sharedSortConditions[0].columnIndex}):Aa.substitute(Aa.Intents.TableCustomSortLabel,{tableName:e.parameters.tableName})}function lo(e){return Aa.substitute(Aa.Intents.TableClearSortLabel,{tableName:e.entityId})}function so(e){return Aa.substitute(Aa.Intents.TableColumnTopFilterLabel,{direction:e.parameters.top?"top":"bottom",count:e.parameters.count,columnName:e.parameters.columnName,tableName:e.parameters.tableName})}function co(e){return Aa.substitute(Aa.Intents.TableColumnDynamicFilterLabel,{columnName:e.parameters.columnName,tableName:e.parameters.tableName})}function uo(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeFormatBoldLabel,Aa.Intents.TableBodyRangeFormatBoldLabel,Aa.Intents.TableHeaderRowRangeFormatBoldLabel,Aa.Intents.TableTotalRowRangeFormatBoldLabel,Aa.Intents.TableGeneralRangeFormatBoldLabel,Aa.Intents.TableRowsRangeFormatBoldLabel,Aa.Intents.TableRowByIndexRangeFormatBoldLabel,Aa.Intents.TableColumnsRangeFormatBoldLabel,Aa.Intents.TableColumnByNameRangeFormatBoldLabel,Aa.Intents.TableColumnByIndexRangeFormatBoldLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnFormatBoldLabel,{columnName:e.parameters.columnName}):Aa.substitute(Aa.Intents.RangeFormatBoldLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeFormatUnboldLabel,Aa.Intents.TableBodyRangeFormatUnboldLabel,Aa.Intents.TableHeaderRowRangeFormatUnboldLabel,Aa.Intents.TableTotalRowRangeFormatUnboldLabel,Aa.Intents.TableGeneralRangeFormatUnboldLabel,Aa.Intents.TableRowsRangeFormatUnboldLabel,Aa.Intents.TableRowByIndexRangeFormatUnboldLabel,Aa.Intents.TableColumnsRangeFormatUnboldLabel,Aa.Intents.TableColumnByNameRangeFormatUnboldLabel,Aa.Intents.TableColumnByIndexRangeFormatUnboldLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnFormatUnboldLabel,{columnName:e.parameters.columnName}):Aa.substitute(Aa.Intents.RangeFormatUnboldLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function mo(e){return e.parameters.events[0].parameters.value?Aa.Intents.MultiRangeFormatBoldLabel:Aa.Intents.MultiRangeFormatUnboldLabel}function go(e){return e.parameters.events[0].parameters.value?Aa.Intents.MultiRangeFormatSuperscriptLabel:Aa.Intents.MultiRangeFormatRemoveSuperscriptLabel}function ho(e){return e.parameters.events[0].parameters.value?Aa.Intents.MultiRangeFormatSubscriptLabel:Aa.Intents.MultiRangeFormatRemoveSubscriptLabel}function po(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeFormatItalicLabel,Aa.Intents.TableBodyRangeFormatItalicLabel,Aa.Intents.TableHeaderRowRangeFormatItalicLabel,Aa.Intents.TableTotalRowRangeFormatItalicLabel,Aa.Intents.TableGeneralRangeFormatItalicLabel,Aa.Intents.TableRowsRangeFormatItalicLabel,Aa.Intents.TableRowByIndexRangeFormatItalicLabel,Aa.Intents.TableColumnsRangeFormatItalicLabel,Aa.Intents.TableColumnByNameRangeFormatItalicLabel,Aa.Intents.TableColumnByIndexRangeFormatItalicLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnFormatItalicLabel,{columnName:e.parameters.columnName}):Aa.substitute(Aa.Intents.RangeFormatItalicLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeFormatUnitalicizeLabel,Aa.Intents.TableBodyRangeFormatUnitalicizeLabel,Aa.Intents.TableHeaderRowRangeFormatUnitalicizeLabel,Aa.Intents.TableTotalRowRangeFormatUnitalicizeLabel,Aa.Intents.TableGeneralRangeFormatUnitalicizeLabel,Aa.Intents.TableRowsRangeFormatUnitalicizeLabel,Aa.Intents.TableRowByIndexRangeFormatUnitalicizeLabel,Aa.Intents.TableColumnsRangeFormatUnitalicizeLabel,Aa.Intents.TableColumnByNameRangeFormatUnitalicizeLabel,Aa.Intents.TableColumnByIndexRangeFormatUnitalicizeLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnFormatUnitalicizeLabel,{columnName:e.parameters.columnName}):Aa.substitute(Aa.Intents.RangeFormatUnitalicizeLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function bo(e){if(e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General)return pl(e.parameters.range,Aa.Intents.TableRangeFormatSetFontColorLabel,Aa.Intents.TableBodyRangeFormatSetFontColorLabel,Aa.Intents.TableHeaderRowRangeFormatSetFontColorLabel,Aa.Intents.TableTotalRowRangeFormatSetFontColorLabel,Aa.Intents.TableGeneralRangeFormatSetFontColorLabel,Aa.Intents.TableRowsRangeFormatSetFontColorLabel,Aa.Intents.TableRowByIndexRangeFormatSetFontColorLabel,Aa.Intents.TableColumnsRangeFormatSetFontColorLabel,Aa.Intents.TableColumnByNameRangeFormatSetFontColorLabel,Aa.Intents.TableColumnByIndexRangeFormatSetFontColorLabel,{color:e.parameters.value});if((0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName){const t=(0,m.yw9)("OfficeVSO_9425205_FixSetColumnFontColor")?Aa.Intents.ColumnNameFormatSetFontColorLabel:Aa.Intents.ColumnFormatSetFontColorLabel;return Aa.substitute(t,{columnName:e.parameters.columnName,color:e.parameters.value})}return Aa.substitute(Aa.Intents.RangeFormatSetFontColorLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),color:e.parameters.value})}function fo(e){return Aa.substitute(Aa.Intents.MultiRangeFormatSetFontColorLabel,{color:e.parameters.events[0].parameters.value})}function Co(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeFormatSetFontLabel,Aa.Intents.TableBodyRangeFormatSetFontLabel,Aa.Intents.TableHeaderRowRangeFormatSetFontLabel,Aa.Intents.TableTotalRowRangeFormatSetFontLabel,Aa.Intents.TableGeneralRangeFormatSetFontLabel,Aa.Intents.TableRowsRangeFormatSetFontLabel,Aa.Intents.TableRowByIndexRangeFormatSetFontLabel,Aa.Intents.TableColumnsRangeFormatSetFontLabel,Aa.Intents.TableColumnByNameRangeFormatSetFontLabel,Aa.Intents.TableColumnByIndexRangeFormatSetFontLabel,{fontName:e.parameters.value}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnNameFormatSetFontLabel,{columnName:e.parameters.columnName,fontName:e.parameters.value}):Aa.substitute(Aa.Intents.RangeFormatSetFontLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),fontName:e.parameters.value})}function yo(e){return Aa.substitute(Aa.Intents.MultiRangeFormatSetFontLabel,{fontName:e.parameters.events[0].parameters.value})}function vo(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeFormatUnderlineLabel,Aa.Intents.TableBodyRangeFormatUnderlineLabel,Aa.Intents.TableHeaderRowRangeFormatUnderlineLabel,Aa.Intents.TableTotalRowRangeFormatUnderlineLabel,Aa.Intents.TableGeneralRangeFormatUnderlineLabel,Aa.Intents.TableRowsRangeFormatUnderlineLabel,Aa.Intents.TableRowByIndexRangeFormatUnderlineLabel,Aa.Intents.TableColumnsRangeFormatUnderlineLabel,Aa.Intents.TableColumnByNameRangeFormatUnderlineLabel,Aa.Intents.TableColumnByIndexRangeFormatUnderlineLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnFormatUnderlineLabel,{columnName:e.parameters.columnName}):Aa.substitute(Aa.Intents.RangeFormatUnderlineLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeFormatRemoveUnderlineLabel,Aa.Intents.TableBodyRangeFormatRemoveUnderlineLabel,Aa.Intents.TableHeaderRowRangeFormatRemoveUnderlineLabel,Aa.Intents.TableTotalRowRangeFormatRemoveUnderlineLabel,Aa.Intents.TableGeneralRangeFormatRemoveUnderlineLabel,Aa.Intents.TableRowsRangeFormatRemoveUnderlineLabel,Aa.Intents.TableRowByIndexRangeFormatRemoveUnderlineLabel,Aa.Intents.TableColumnsRangeFormatRemoveUnderlineLabel,Aa.Intents.TableColumnByNameRangeFormatRemoveUnderlineLabel,Aa.Intents.TableColumnByIndexRangeFormatRemoveUnderlineLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnFormatRemoveUnderlineLabel,{columnName:e.parameters.columnName}):Aa.substitute(Aa.Intents.RangeFormatRemoveUnderlineLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function To(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeFormatDoubleUnderlineLabel,Aa.Intents.TableBodyRangeFormatDoubleUnderlineLabel,Aa.Intents.TableHeaderRowRangeFormatDoubleUnderlineLabel,Aa.Intents.TableTotalRowRangeFormatDoubleUnderlineLabel,Aa.Intents.TableGeneralRangeFormatDoubleUnderlineLabel,Aa.Intents.TableRowsRangeFormatDoubleUnderlineLabel,Aa.Intents.TableRowByIndexRangeFormatDoubleUnderlineLabel,Aa.Intents.TableColumnsRangeFormatDoubleUnderlineLabel,Aa.Intents.TableColumnByNameRangeFormatDoubleUnderlineLabel,Aa.Intents.TableColumnByIndexRangeFormatDoubleUnderlineLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnFormatDoubleUnderlineLabel,{columnName:e.parameters.columnName}):Aa.substitute(Aa.Intents.RangeFormatDoubleUnderlineLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeFormatRemoveDoubleUnderlineLabel,Aa.Intents.TableBodyRangeFormatRemoveDoubleUnderlineLabel,Aa.Intents.TableHeaderRowRangeFormatRemoveDoubleUnderlineLabel,Aa.Intents.TableTotalRowRangeFormatRemoveDoubleUnderlineLabel,Aa.Intents.TableGeneralRangeFormatRemoveDoubleUnderlineLabel,Aa.Intents.TableRowsRangeFormatRemoveDoubleUnderlineLabel,Aa.Intents.TableRowByIndexRangeFormatRemoveDoubleUnderlineLabel,Aa.Intents.TableColumnsRangeFormatRemoveDoubleUnderlineLabel,Aa.Intents.TableColumnByNameRangeFormatRemoveDoubleUnderlineLabel,Aa.Intents.TableColumnByIndexRangeFormatRemoveDoubleUnderlineLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnFormatRemoveDoubleUnderlineLabel,{columnName:e.parameters.columnName}):Aa.substitute(Aa.Intents.RangeFormatRemoveDoubleUnderlineLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function xo(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeFormatStrikethroughLabel,Aa.Intents.TableBodyRangeFormatStrikethroughLabel,Aa.Intents.TableHeaderRowRangeFormatStrikethroughLabel,Aa.Intents.TableTotalRowRangeFormatStrikethroughLabel,Aa.Intents.TableGeneralRangeFormatStrikethroughLabel,Aa.Intents.TableRowsRangeFormatStrikethroughLabel,Aa.Intents.TableRowByIndexRangeFormatStrikethroughLabel,Aa.Intents.TableColumnsRangeFormatStrikethroughLabel,Aa.Intents.TableColumnByNameRangeFormatStrikethroughLabel,Aa.Intents.TableColumnByIndexRangeFormatStrikethroughLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnFormatStrikethroughLabel,{columnName:e.parameters.columnName}):Aa.substitute(Aa.Intents.RangeFormatStrikethroughLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeFormatRemoveStrikethroughLabel,Aa.Intents.TableBodyRangeFormatRemoveStrikethroughLabel,Aa.Intents.TableHeaderRowRangeFormatRemoveStrikethroughLabel,Aa.Intents.TableTotalRowRangeFormatRemoveStrikethroughLabel,Aa.Intents.TableGeneralRangeFormatRemoveStrikethroughLabel,Aa.Intents.TableRowsRangeFormatRemoveStrikethroughLabel,Aa.Intents.TableRowByIndexRangeFormatRemoveStrikethroughLabel,Aa.Intents.TableColumnsRangeFormatRemoveStrikethroughLabel,Aa.Intents.TableColumnByNameRangeFormatRemoveStrikethroughLabel,Aa.Intents.TableColumnByIndexRangeFormatRemoveStrikethroughLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnFormatRemoveStrikethroughLabel,{columnName:e.parameters.columnName}):Aa.substitute(Aa.Intents.RangeFormatRemoveStrikethroughLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function So(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeFormatSuperscriptLabel,Aa.Intents.TableBodyRangeFormatSuperscriptLabel,Aa.Intents.TableHeaderRowRangeFormatSuperscriptLabel,Aa.Intents.TableTotalRowRangeFormatSuperscriptLabel,Aa.Intents.TableGeneralRangeFormatSuperscriptLabel,Aa.Intents.TableRowsRangeFormatSuperscriptLabel,Aa.Intents.TableRowByIndexRangeFormatSuperscriptLabel,Aa.Intents.TableColumnsRangeFormatSuperscriptLabel,Aa.Intents.TableColumnByNameRangeFormatSuperscriptLabel,Aa.Intents.TableColumnByIndexRangeFormatSuperscriptLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnFormatSuperscriptLabel,{columnName:e.parameters.columnName}):Aa.substitute(Aa.Intents.RangeFormatSuperscriptLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeFormatUnSuperscriptLabel,Aa.Intents.TableBodyRangeFormatRemoveSuperscriptLabel,Aa.Intents.TableHeaderRowRangeFormatRemoveSuperscriptLabel,Aa.Intents.TableTotalRowRangeFormatRemoveSuperscriptLabel,Aa.Intents.TableGeneralRangeFormatRemoveSuperscriptLabel,Aa.Intents.TableRowsRangeFormatRemoveSuperscriptLabel,Aa.Intents.TableRowByIndexRangeFormatRemoveSuperscriptLabel,Aa.Intents.TableColumnsRangeFormatRemoveSuperscriptLabel,Aa.Intents.TableColumnByNameRangeFormatRemoveSuperscriptLabel,Aa.Intents.TableColumnByIndexRangeFormatRemoveSuperscriptLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnFormatRemoveSuperscriptLabel,{columnName:e.parameters.columnName}):Aa.substitute(Aa.Intents.RangeFormatRemoveSuperscriptLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function wo(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeFormatSubscriptLabel,Aa.Intents.TableBodyRangeFormatSubscriptLabel,Aa.Intents.TableHeaderRowRangeFormatSubscriptLabel,Aa.Intents.TableTotalRowRangeFormatSubscriptLabel,Aa.Intents.TableGeneralRangeFormatSubscriptLabel,Aa.Intents.TableRowsRangeFormatSubscriptLabel,Aa.Intents.TableRowByIndexRangeFormatSubscriptLabel,Aa.Intents.TableColumnsRangeFormatSubscriptLabel,Aa.Intents.TableColumnByNameRangeFormatSubscriptLabel,Aa.Intents.TableColumnByIndexRangeFormatSubscriptLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnFormatSubscriptLabel,{columnName:e.parameters.columnName}):Aa.substitute(Aa.Intents.RangeFormatSubscriptLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeFormatRemoveSubscriptLabel,Aa.Intents.TableBodyRangeFormatRemoveSubscriptLabel,Aa.Intents.TableHeaderRowRangeFormatRemoveSubscriptLabel,Aa.Intents.TableTotalRowRangeFormatRemoveSubscriptLabel,Aa.Intents.TableGeneralRangeFormatRemoveSubscriptLabel,Aa.Intents.TableRowsRangeFormatRemoveSubscriptLabel,Aa.Intents.TableRowByIndexRangeFormatRemoveSubscriptLabel,Aa.Intents.TableColumnsRangeFormatRemoveSubscriptLabel,Aa.Intents.TableColumnByNameRangeFormatRemoveSubscriptLabel,Aa.Intents.TableColumnByIndexRangeFormatRemoveSubscriptLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnFormatRemoveSubscriptLabel,{columnName:e.parameters.columnName}):Aa.substitute(Aa.Intents.RangeFormatRemoveSubscriptLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Eo(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeSetFontSizeLabel,Aa.Intents.TableBodyRangeSetFontSizeLabel,Aa.Intents.TableHeaderRowRangeSetFontSizeLabel,Aa.Intents.TableTotalRowRangeSetFontSizeLabel,Aa.Intents.TableGeneralRangeSetFontSizeLabel,Aa.Intents.TableRowsRangeSetFontSizeLabel,Aa.Intents.TableRowByIndexRangeSetFontSizeLabel,Aa.Intents.TableColumnsRangeSetFontSizeLabel,Aa.Intents.TableColumnByNameRangeSetFontSizeLabel,Aa.Intents.TableColumnByIndexRangeSetFontSizeLabel,{fontSize:e.parameters.value}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnNameSetFontSizeLabel,{columnName:e.parameters.columnName,fontSize:e.parameters.value}):Aa.substitute(Aa.Intents.RangeSetFontSizeLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),fontSize:e.parameters.value})}function Io(e){return Aa.substitute(Aa.Intents.MultiRangeSetFontSizeLabel,{fontSize:e.parameters.events[0].parameters.value})}function Ro(e){return"none"===e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeRemoveFontUnderlineStyleLabel,Aa.Intents.TableBodyRangeRemoveFontUnderlineStyleLabel,Aa.Intents.TableHeaderRowRangeRemoveFontUnderlineStyleLabel,Aa.Intents.TableTotalRowRangeRemoveFontUnderlineStyleLabel,Aa.Intents.TableGeneralRangeRemoveFontUnderlineStyleLabel,Aa.Intents.TableRowsRangeRemoveFontUnderlineStyleLabel,Aa.Intents.TableRowByIndexRangeRemoveFontUnderlineStyleLabel,Aa.Intents.TableColumnsRangeRemoveFontUnderlineStyleLabel,Aa.Intents.TableColumnByNameRangeRemoveFontUnderlineStyleLabel,Aa.Intents.TableColumnByIndexRangeRemoveFontUnderlineStyleLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnNameRemoveFontUnderlineStyleLabel,{columnName:e.parameters.columnName}):Aa.substitute(Aa.Intents.RemoveFontUnderlineStyleLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeFontUnderlineStyleLabel,Aa.Intents.TableBodyRangeFontUnderlineStyleLabel,Aa.Intents.TableHeaderRowRangeFontUnderlineStyleLabel,Aa.Intents.TableTotalRowRangeFontUnderlineStyleLabel,Aa.Intents.TableGeneralRangeFontUnderlineStyleLabel,Aa.Intents.TableRowsRangeFontUnderlineStyleLabel,Aa.Intents.TableRowByIndexRangeFontUnderlineStyleLabel,Aa.Intents.TableColumnsRangeFontUnderlineStyleLabel,Aa.Intents.TableColumnByNameRangeFontUnderlineStyleLabel,Aa.Intents.TableColumnByIndexRangeFontUnderlineStyleLabel,{style:e.parameters.value.replace(/([A-Z])/g," $1").toLocaleLowerCase()}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnNameFontUnderlineStyleLabel,{style:e.parameters.value.replace(/([A-Z])/g," $1").toLocaleLowerCase(),columnName:e.parameters.columnName}):Aa.substitute(Aa.Intents.FontUnderlineStyleLabel,{style:e.parameters.value.replace(/([A-Z])/g," $1").toLocaleLowerCase(),range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Ao(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeSetBackgroundColorLabel,Aa.Intents.TableBodyRangeSetBackgroundColorLabel,Aa.Intents.TableHeaderRowRangeSetBackgroundColorLabel,Aa.Intents.TableTotalRowRangeSetBackgroundColorLabel,Aa.Intents.TableGeneralRangeSetBackgroundColorLabel,Aa.Intents.TableRowsRangeSetBackgroundColorLabel,Aa.Intents.TableRowByIndexRangeSetBackgroundColorLabel,Aa.Intents.TableColumnsRangeSetBackgroundColorLabel,Aa.Intents.TableColumnByNameRangeSetBackgroundColorLabel,Aa.Intents.TableColumnByIndexRangeSetBackgroundColorLabel,{color:e.parameters.value}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnNameSetBackgroundColorLabel,{columnName:e.parameters.columnName,color:e.parameters.value}):Aa.substitute(Aa.Intents.RangeSetBackgroundColorLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),color:e.parameters.value})}function Lo(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeClearBackgroundColorLabel,Aa.Intents.TableBodyRangeClearBackgroundColorLabel,Aa.Intents.TableHeaderRowRangeClearBackgroundColorLabel,Aa.Intents.TableTotalRowRangeClearBackgroundColorLabel,Aa.Intents.TableGeneralRangeClearBackgroundColorLabel,Aa.Intents.TableRowsRangeClearBackgroundColorLabel,Aa.Intents.TableRowByIndexRangeClearBackgroundColorLabel,Aa.Intents.TableColumnsRangeClearBackgroundColorLabel,Aa.Intents.TableColumnByNameRangeClearBackgroundColorLabel,Aa.Intents.TableColumnByIndexRangeClearBackgroundColorLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnFormatBoldLabel,{columnName:e.parameters.columnName}):Aa.substitute(Aa.Intents.RangeClearBackgroundColorLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function ko(e){return Aa.substitute(Aa.Intents.MultiRangeSetBackgroundColorLabel,{color:e.parameters.events[0].parameters.value})}function Fo(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeSetCellWidthLabel,Aa.Intents.TableBodyRangeSetCellWidthLabel,Aa.Intents.TableHeaderRowRangeSetCellWidthLabel,Aa.Intents.TableTotalRowRangeSetCellWidthLabel,Aa.Intents.TableGeneralRangeSetCellWidthLabel,Aa.Intents.TableRowsRangeSetCellWidthLabel,Aa.Intents.TableRowByIndexRangeSetCellWidthLabel,Aa.Intents.TableColumnsRangeSetCellWidthLabel,Aa.Intents.TableColumnByNameRangeSetCellWidthLabel,Aa.Intents.TableColumnByIndexRangeSetCellWidthLabel,{size:e.parameters.value/C.bN}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnNameSetCellWidthLabel,{size:e.parameters.value/C.bN,columnName:e.parameters.columnName}):Aa.substitute(Aa.Intents.RangeSetCellWidthLabel,{size:e.parameters.value/C.bN,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function _o(e){return Aa.substitute(Aa.Intents.MultiRangeSetCellWidthLabel,{size:e.parameters.events[0].parameters.value})}function Po(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeSetCellHeightLabel,Aa.Intents.TableBodyRangeSetCellHeightLabel,Aa.Intents.TableHeaderRowRangeSetCellHeightLabel,Aa.Intents.TableTotalRowRangeSetCellHeightLabel,Aa.Intents.TableGeneralRangeSetCellHeightLabel,Aa.Intents.TableRowsRangeSetCellHeightLabel,Aa.Intents.TableRowByIndexRangeSetCellHeightLabel,Aa.Intents.TableColumnsRangeSetCellHeightLabel,Aa.Intents.TableColumnByNameRangeSetCellHeightLabel,Aa.Intents.TableColumnByIndexRangeSetCellHeightLabel,{size:e.parameters.value}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnNameSetCellHeightLabel,{columnName:e.parameters.columnName,size:e.parameters.value}):Aa.substitute(Aa.Intents.RangeSetCellHeightLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),size:e.parameters.value})}function No(e){return Aa.substitute(Aa.Intents.MultiRangeSetCellHeightLabel,{size:e.parameters.events[0].parameters.value})}function Mo(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeApplyBorderLabel,Aa.Intents.TableBodyRangeApplyBorderLabel,Aa.Intents.TableHeaderRowRangeApplyBorderLabel,Aa.Intents.TableTotalRowRangeApplyBorderLabel,Aa.Intents.TableGeneralRangeApplyBorderLabel,Aa.Intents.TableRowsRangeApplyBorderLabel,Aa.Intents.TableRowByIndexRangeApplyBorderLabel,Aa.Intents.TableColumnsRangeApplyBorderLabel,Aa.Intents.TableColumnByNameRangeApplyBorderLabel,Aa.Intents.TableColumnByIndexRangeApplyBorderLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnNameApplyBorderLabel,{columnName:e.parameters.columnName}):Aa.substitute(Aa.Intents.RangeApplyBorderLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Oo(e){return Aa.substitute(Aa.Intents.NamedSheetViewDeleteLabel,{deletedNum:e.parameters.namedSheetViewNames.length})}function Do(e){return Aa.substitute(Aa.Intents.NamedSheetViewDuplicateLabel,{sheetViewName:e.parameters.namedSheetViewName})}function Bo(e){return void 0!==e.parameters.namedSheetViewKeepName&&e.parameters.namedSheetViewKeepName.length>0?Aa.substitute(Aa.Intents.NamedSheetViewExitAndKeepLabel,{sheetViewName:e.parameters.namedSheetViewKeepName}):Aa.Intents.NamedSheetViewExitLabel}function $o(e){return Aa.substitute(Aa.Intents.NamedSheetViewKeepLabel,{sheetViewName:e.parameters.namedSheetViewName})}function Ho(e){return Aa.substitute(Aa.Intents.NamedSheetViewRenameLabel,{newSheetViewName:e.parameters.newNamedSheetViewName})}function Uo(e){return void 0!==e.parameters.namedSheetViewKeepName&&e.parameters.namedSheetViewKeepName.length>0?Aa.substitute(Aa.Intents.NamedSheetViewSwitchAndKeepLabel,{sheetViewName:e.parameters.namedSheetViewName,sheetViewKeepName:e.parameters.namedSheetViewKeepName}):Aa.substitute(Aa.Intents.NamedSheetViewSwitchLabel,{sheetViewName:e.parameters.namedSheetViewName})}function qo(e){if(e.parameters.destinationRange.rangeType===i.RangeType.TableRange){let t;switch(e.parameters.destinationRange.range.subRange){case i.TableRangeOperationSubRange.WholeTable:t=Aa.Intents.RangePasteInTableRangeLabel;break;case i.TableRangeOperationSubRange.Body:t=Aa.Intents.RangePasteInTableBodyRangeLabel;break;case i.TableRangeOperationSubRange.HeaderRow:t=Aa.Intents.RangePasteInTableHeaderRowRangeLabel;break;case i.TableRangeOperationSubRange.TotalRow:t=Aa.Intents.RangePasteInTableTotalRowRangeLabel;break;case i.TableRangeOperationSubRange.General:t=Aa.Intents.RangePasteInTableGeneralRangeLabel;break;case i.TableRangeOperationSubRange.Rows:case i.TableRangeOperationSubRange.Columns:case i.TableRangeOperationSubRange.ColumnsBody:t=Aa.Intents.RangePasteInTableRangeLabel}return Aa.substitute(t,{sourceRange:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.sourceRange).range),tableName:e.entityId})}return Aa.substitute(Aa.Intents.RangePasteLabel,{sourceRange:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.sourceRange).range),destinationRange:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.destinationRange).range)})}function Vo(e){return Aa.substitute(Aa.Intents.MultiRangePasteLabel,{sourceRange:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.events[0].parameters.sourceRange).range)})}function Wo(e){return Aa.substitute(Aa.Intents.RangePasteTextLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Go(e){return Aa.substitute(Aa.Intents.WorksheetDuplicateLabel,{sheet:e.entityId})}function zo(e){return Aa.substitute(Aa.Intents.WorksheetReapplyFiltersLabel,{sheet:e.entityId})}function Qo(e){return Aa.substitute(Aa.Intents.WorksheetClearFiltersLabel,{sheet:e.entityId})}function jo(e){return Aa.substitute(Aa.Intents.CellFindContainingLabel,{search:e.parameters.searchString})}function Jo(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeReplaceAllLabel,Aa.Intents.TableBodyRangeReplaceAllLabel,Aa.Intents.TableHeaderRowRangeReplaceAllLabel,Aa.Intents.TableTotalRowRangeReplaceAllLabel,Aa.Intents.TableGeneralRangeReplaceAllLabel,Aa.Intents.TableRowsRangeReplaceAllLabel,Aa.Intents.TableRowByIndexRangeReplaceAllLabel,Aa.Intents.TableColumnsRangeReplaceAllLabel,Aa.Intents.TableColumnByNameRangeReplaceAllLabel,Aa.Intents.TableColumnByIndexRangeReplaceAllLabel,{search:e.parameters.searchString,replace:e.parameters.replaceWith}):Aa.substitute(Aa.Intents.ReplaceAllLabel,{search:e.parameters.searchString,replace:e.parameters.replaceWith,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Yo(e){return Aa.substitute(Aa.Intents.ReplaceAllLabelGeneric,{search:e.parameters.events[0].parameters.searchString,replace:e.parameters.events[0].parameters.replaceWith})}function Xo(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeSetHorizontalAlignmentLabel,Aa.Intents.TableBodyRangeSetHorizontalAlignmentLabel,Aa.Intents.TableHeaderRowRangeSetHorizontalAlignmentLabel,Aa.Intents.TableTotalRowRangeSetHorizontalAlignmentLabel,Aa.Intents.TableGeneralRangeSetHorizontalAlignmentLabel,Aa.Intents.TableRowsRangeSetHorizontalAlignmentLabel,Aa.Intents.TableRowByIndexRangeSetHorizontalAlignmentLabel,Aa.Intents.TableColumnsRangeSetHorizontalAlignmentLabel,Aa.Intents.TableColumnByNameRangeSetHorizontalAlignmentLabel,Aa.Intents.TableColumnByIndexRangeSetHorizontalAlignmentLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnNameSetHorizontalAlignmentLabel,{columnName:e.parameters.columnName}):Aa.substitute(Aa.Intents.RangeSetHorizontalAlignmentLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Zo(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeSetVerticalAlignmentLabel,Aa.Intents.TableBodyRangeSetVerticalAlignmentLabel,Aa.Intents.TableHeaderRowRangeSetVerticalAlignmentLabel,Aa.Intents.TableTotalRowRangeSetVerticalAlignmentLabel,Aa.Intents.TableGeneralRangeSetVerticalAlignmentLabel,Aa.Intents.TableRowsRangeSetVerticalAlignmentLabel,Aa.Intents.TableRowByIndexRangeSetVerticalAlignmentLabel,Aa.Intents.TableColumnsRangeSetVerticalAlignmentLabel,Aa.Intents.TableColumnByNameRangeSetVerticalAlignmentLabel,Aa.Intents.TableColumnByIndexRangeSetVerticalAlignmentLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnNameSetVerticalAlignmentLabel,{columnName:e.parameters.columnName}):Aa.substitute(Aa.Intents.RangeSetVerticalAlignmentLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Ko(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeWrapTextLabel,Aa.Intents.TableBodyRangeWrapTextLabel,Aa.Intents.TableHeaderRowRangeWrapTextLabel,Aa.Intents.TableTotalRowRangeWrapTextLabel,Aa.Intents.TableGeneralRangeWrapTextLabel,Aa.Intents.TableRowsRangeWrapTextLabel,Aa.Intents.TableRowByIndexRangeWrapTextLabel,Aa.Intents.TableColumnsRangeWrapTextLabel,Aa.Intents.TableColumnByNameRangeWrapTextLabel,Aa.Intents.TableColumnByIndexRangeWrapTextLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnNameWrapTextLabel,{columnName:e.parameters.columnName}):Aa.substitute(Aa.Intents.RangeWrapTextLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeUnwrapTextLabel,Aa.Intents.TableBodyRangeUnwrapTextLabel,Aa.Intents.TableHeaderRowRangeUnwrapTextLabel,Aa.Intents.TableTotalRowRangeUnwrapTextLabel,Aa.Intents.TableGeneralRangeUnwrapTextLabel,Aa.Intents.TableRowsRangeUnwrapTextLabel,Aa.Intents.TableRowByIndexRangeUnwrapTextLabel,Aa.Intents.TableColumnsRangeUnwrapTextLabel,Aa.Intents.TableColumnByNameRangeUnwrapTextLabel,Aa.Intents.TableColumnByIndexRangeUnwrapTextLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnNameUnwrapTextLabel,{columnName:e.parameters.columnName}):Aa.substitute(Aa.Intents.RangeUnwrapTextLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function er(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeChangeIndentLabel,Aa.Intents.TableBodyRangeChangeIndentLabel,Aa.Intents.TableHeaderRowRangeChangeIndentLabel,Aa.Intents.TableTotalRowRangeChangeIndentLabel,Aa.Intents.TableGeneralRangeChangeIndentLabel,Aa.Intents.TableRowsRangeChangeIndentLabel,Aa.Intents.TableRowByIndexRangeChangeIndentLabel,Aa.Intents.TableColumnsRangeChangeIndentLabel,Aa.Intents.TableColumnByNameRangeChangeIndentLabel,Aa.Intents.TableColumnByIndexRangeChangeIndentLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnNameChangeIndentLabel,{columnName:e.parameters.columnName}):Aa.substitute(Aa.Intents.RangeChangeIndentLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function tr(e){return Aa.substitute(Aa.Intents.WorksheetReorderLabel,{sheet:e.entityId})}function nr(e){return Aa.substitute(Aa.Intents.TableToggleAutoFilterLabel,{tableName:e.entityId})}function ar(e){return Aa.substitute(Aa.Intents.WorksheetToggleAutoFilterLabel,{sheet:e.entityId})}function or(e){return Aa.substitute(Aa.Intents.SlicerInsertedLabel,{pivotTable:e.parameters.pivotTable,pivotName:e.parameters.pivotFieldName})}function rr(e){if(e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General){const t=e.parameters.range;if(t.subRange===i.TableRangeOperationSubRange.WholeTable)return Aa.substitute(Aa.Intents.WorksheetTableRangeCreateChartLabel,{sheet:e.entityId,table:t.tableName})}return Aa.substitute(Aa.Intents.WorksheetCreateChartLabel,{sheet:e.entityId})}function ir(e){return`#${i.ExcelCalc.toHexColor(e)}`}function lr(e,t,n){const a=n?n(e.parameters.newValue):`${e.parameters.newValue}`;return e.parameters.category===i.ChartObjectCategory.ChartAxis?Aa.substitute(t,{newValue:a,axis:`${i.ChartAxisGroup[e.parameters.axisGroup].toLocaleLowerCase()} ${i.ChartAxisType[e.parameters.axisType].toLocaleLowerCase()} axis`,chartName:e.parameters.chartName}):e.parameters.category===i.ChartObjectCategory.Series?Aa.substitute(t,{newValue:a,seriesIndex:e.parameters.index,chartName:e.parameters.chartName}):Aa.substitute(t,{newValue:a,chartName:e.parameters.chartName})}function sr(e,t){return e.parameters.category===i.ChartObjectCategory.ChartAxis?Aa.substitute(t,{axis:`${i.ChartAxisGroup[e.parameters.axisGroup].toLocaleLowerCase()} ${i.ChartAxisType[e.parameters.axisType].toLocaleLowerCase()} axis`,chartName:e.parameters.chartName}):e.parameters.category===i.ChartObjectCategory.Series?Aa.substitute(t,{seriesIndex:e.parameters.index,chartName:e.parameters.chartName}):Aa.substitute(t,{chartName:e.parameters.chartName})}function cr(e){return e.parameters.added?Aa.substitute(Aa.Intents.VisualSerriesTrendlineAddedLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index}):Aa.substitute(Aa.Intents.VisualSerriesTrendlineRemovedLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index,trendlineIndex:e.parameters.secondaryIndex})}function dr(e){return e.parameters.added?Aa.substitute(Aa.Intents.VisualSeriesTrendlineTitleAddedLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index,trendlineIndex:e.parameters.secondaryIndex}):Aa.substitute(Aa.Intents.VisualSeriesTrendlineTitleRemovedLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index,trendlineIndex:e.parameters.secondaryIndex})}function ur(e){return Aa.substitute(Aa.Intents.WorksheetCreateChartLabel,{sheet:e.entityId})}function mr(e){return e.parameters?Aa.substitute(Aa.Intents.WorksheetShowHeadingsLabel,{sheet:e.entityId}):Aa.substitute(Aa.Intents.WorksheetHideHeadingsLabel,{sheet:e.entityId})}function gr(e){return e.parameters?Aa.substitute(Aa.Intents.WorksheetShowGridlinesLabel,{sheet:e.entityId}):Aa.substitute(Aa.Intents.WorksheetHideGridlinesLabel,{sheet:e.entityId})}function hr(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeRemoveDuplicatesLabel,Aa.Intents.TableBodyRangeRemoveDuplicatesLabel,Aa.Intents.TableHeaderRowRangeRemoveDuplicatesLabel,Aa.Intents.TableTotalRowRangeRemoveDuplicatesLabel,Aa.Intents.TableGeneralRangeRemoveDuplicatesLabel,Aa.Intents.TableRowsRangeRemoveDuplicatesLabel,Aa.Intents.TableRowByIndexRangeRemoveDuplicatesLabel,Aa.Intents.TableColumnsRangeRemoveDuplicatesLabel,Aa.Intents.TableColumnByNameRangeRemoveDuplicatesLabel,Aa.Intents.TableColumnByIndexRangeRemoveDuplicatesLabel,{}):Aa.substitute(Aa.Intents.RangeRemoveDuplicatesLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function pr(e){const t=e.parameters?Aa.Intents.TableAddTotalRowLabel:Aa.Intents.TableRemoveTotalRowLabel;return Aa.substitute(t,{tableName:e.entityId})}function br(e){const t=e.parameters?Aa.Intents.TableAddHeaderRowLabel:Aa.Intents.TableRemoveHeaderRowLabel;return Aa.substitute(t,{tableName:e.entityId})}function fr(e){return Aa.substitute(Aa.Intents.TableResizeLabel,{tableName:e.entityId})}function Cr(e){return e.parameters.isCreation?Aa.substitute(Aa.Intents.TableCreateAndFormatLabel,{tableName:e.parameters.tableName,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):Aa.substitute(Aa.Intents.TableFormatLabel,{tableName:e.entityId})}function yr(e){return""===e.parameters?Aa.substitute(Aa.Intents.WorksheetClearTabColorLabel,{sheet:e.entityId}):Aa.substitute(Aa.Intents.WorksheetSetTabColorLabel,{color:e.parameters,sheet:e.entityId})}function vr(e){return Aa.substitute(Aa.Intents.WorksheetChartSwitchRowColumnLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Tr(e){return Aa.substitute(Aa.Intents.WorksheetChartSelectDataLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function xr(e){return Aa.substitute(Aa.Intents.WorksheetChartChangeTypeLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Sr(e){return Aa.substitute(Aa.Intents.RangeFlashFillLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.range.range)})}function wr(e){return Aa.substitute(Aa.Intents.WorksheetChartChangeTitleLabel,{chartName:e.parameters.events[0].parameters.chartName,sheet:e.entityId})}function Er(e){return Aa.substitute(Aa.Intents.WorksheetChartHideTitleLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Ir(e){return Aa.substitute(Aa.Intents.WorksheetChartChangeAxisTitleLabel,{chartName:e.parameters.events[0].parameters.chartName,sheet:e.entityId})}function Rr(e){return Aa.substitute(Aa.Intents.WorksheetChartHideAxisTitleLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Ar(e){return Aa.substitute(Aa.Intents.WorksheetChartChangeLegendLabel,{chartName:e.parameters.events[0].parameters.chartName,sheet:e.entityId})}function Lr(e){return Aa.substitute(Aa.Intents.WorksheetChartAxisTitleChangeTextLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function kr(e){return Aa.substitute(Aa.Intents.WorksheetCharTitleChangeTextLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Fr(e){return Aa.substitute(Aa.Intents.WorksheetChartHideLegendLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function _r(e){return Aa.substitute(Aa.Intents.WorksheetChartDataLabelChangePositionLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Pr(e){return Aa.substitute(Aa.Intents.WorksheetChartDataLabelChangeVisibilityLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Nr(e){return Aa.substitute(Aa.Intents.WorksheetChartChangeAxisLabel,{chartName:e.parameters.events[0].parameters.chartName,sheet:e.entityId})}function Mr(e){return Aa.substitute(Aa.Intents.WorksheetChartChangeAxisVisibilityLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Or(e){return Aa.substitute(Aa.Intents.TableApplyStyleLabel,{tableName:e.entityId})}function Dr(e){const t=e.parameters?Aa.Intents.TableAddBandedRowsLabel:Aa.Intents.TableRemoveBandedRowsLabel;return Aa.substitute(t,{tableName:e.entityId})}function Br(e){const t=e.parameters?Aa.Intents.TableAddBandedColumnsLabel:Aa.Intents.TableRemoveBandedColumnsLabel;return Aa.substitute(t,{tableName:e.entityId})}function $r(e){return Aa.substitute(Aa.Intents.TableHighlightFirstColumnFilterLabel,{tableName:e.entityId})}function Hr(e){return Aa.substitute(Aa.Intents.TableHighlightLastColumnLabel,{tableName:e.entityId})}function Ur(e){const t=e.parameters?Aa.Intents.TableAddFilterButtonLabel:Aa.Intents.TableRemoveFilterButtonLabel;return Aa.substitute(t,{tableName:e.entityId})}function qr(e){return e.parameters.rangeToFreeze?Aa.Intents.WorksheetFreezePaneLabel:Aa.Intents.WorksheetUnFreezePaneLabel}function Vr(e){return Aa.substitute(Aa.Intents.WorksheetShapeInsertedLabel,{sheet:e.entityId})}function Wr(e){return Aa.substitute(Aa.Intents.WorksheetShapeSetStyleLabel,{sheet:e.entityId})}function Gr(e){return Aa.substitute(Aa.Intents.WorksheetChartDeleteLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function zr(e){return Aa.substitute(Aa.Intents.ChartSeriesDeleteLabel,{chartName:e.parameters.chartName,sheet:e.entityId,seriesIndex:e.parameters.seriesIndex})}function Qr(e){return Aa.substitute(Aa.Intents.ChartSeriesDataChangedLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.seriesIndex})}function jr(e){return Aa.substitute(Aa.Intents.WorksheetFloatingObjectDeleteLabel,{sheet:e.entityId})}function Jr(e){return Aa.substitute(Aa.Intents.WorksheetChartMoveAndResizeLabel,{chartName:e.parameters.name,sheet:e.entityId})}function Yr(e){return Aa.substitute(Aa.Intents.WorksheetFloatingObjectMoveAndResizeLabel,{sheet:e.entityId})}function Xr(e){return Aa.substitute(Aa.Intents.WorksheetFloatingObjectZOrderChangedLabel,{sheet:e.entityId})}function Zr(e){return Aa.substitute(Aa.Intents.WorksheetShapeRotateLabel,{sheet:e.entityId})}function Kr(e){return Aa.substitute(Aa.Intents.WorksheetShapeAltTextApplyLabel,{sheet:e.entityId})}function ei(e){return Aa.substitute(Aa.Intents.WorksheetShapeTextChangedLabel,{sheet:e.entityId})}function ti(e){return e.parameters.value?Aa.substitute(Aa.Intents.WorksheetShapeTextBoldedLabel,{sheet:e.entityId}):Aa.substitute(Aa.Intents.WorksheetShapeTextUnboldedLabel,{sheet:e.entityId})}function ni(e){return e.parameters.value?Aa.substitute(Aa.Intents.WorksheetShapeTextItalicizedLabel,{sheet:e.entityId}):Aa.substitute(Aa.Intents.WorksheetShapeTextUnitalicizedLabel,{sheet:e.entityId})}function ai(e){return e.parameters.value?Aa.substitute(Aa.Intents.WorksheetShapeTextUnderlinedLabel,{sheet:e.entityId}):Aa.substitute(Aa.Intents.WorksheetShapeTextUnderlineRemovedLabel,{sheet:e.entityId})}function oi(e){return Aa.substitute(Aa.Intents.WorksheetShapeTextFontNameChangedLabel,{sheet:e.entityId,fontName:e.parameters.value})}function ri(e){return Aa.substitute(Aa.Intents.WorksheetShapeTextFontSizeChangedLabel,{sheet:e.entityId,fontSize:e.parameters.value})}function ii(e){return Aa.substitute(Aa.Intents.WorksheetShapeTextFontColorChangedLabel,{sheet:e.entityId,fontColor:e.parameters.value})}function li(e){return Aa.substitute(Aa.Intents.WorksheetShapeTextHorizontallyAlignedLabel,{sheet:e.entityId,fontColor:e.parameters.value})}function si(e){return Aa.substitute(Aa.Intents.WorksheetShapeTextVerticallyAlignedLabel,{sheet:e.entityId,fontColor:e.parameters.value})}function ci(e){return Aa.substitute(Aa.Intents.RangeGroupLabel,{sheet:e.entityId})}function di(e){return Aa.substitute(Aa.Intents.RangeUnGroupLabel,{sheet:e.entityId})}function ui(e){return Aa.substitute(Aa.Intents.WorksheetOutlineLevelsSetLabel,{sheet:e.entityId})}function mi(e){return Aa.substitute(Aa.Intents.RangeGroupDetailsShowLabel,{sheet:e.entityId})}function gi(e){return Aa.substitute(Aa.Intents.RangeGroupDetailsHideLabel,{sheet:e.entityId})}function hi(e){return Aa.substitute(Aa.Intents.RangeDataValidationChangedGroupLabel,{sheet:e.entityId})}function pi(e){return Aa.substitute(Aa.Intents.TableRenameLabel,{tableName:e.parameters})}function bi(e){return Aa.substitute(Aa.Intents.TableConvertToRangeLabel,{tableName:e.entityId})}function fi(e){return Aa.substitute(Aa.Intents.TableAltTextEditedLabel,{tableName:e.entityId})}function Ci(e){return Aa.substitute(Aa.Intents.TableAltTextTitleEditedLabel,{tableName:e.entityId})}function yi(e){return Aa.substitute(Aa.Intents.TableAltTextDescriptionEditedLabel,{tableName:e.entityId})}function vi(e){return Aa.substitute(Aa.Intents.PivotTableChangeLabel,{pivotName:e.parameters.events[0].parameters.pivotName})}function Ti(e){return Aa.substitute(Aa.Intents.PivotTableAddPivot,{pivotName:e.parameters.pivotName})}function xi(e){return Aa.substitute(Aa.Intents.PivotTableRemovePivot,{pivotName:e.parameters.pivotName})}function Si(e){return Aa.substitute(Aa.Intents.PivotTableRefreshLabel,{pivotName:e.parameters})}function wi(e){return e.parameters.value?Aa.substitute(Aa.Intents.PivotDrillExpandedLabel,{pivotName:e.parameters.pivotName,pivotItem:e.parameters.pivotItemName}):Aa.substitute(Aa.Intents.PivotDrillCollapsedLabel,{pivotName:e.parameters.pivotName,pivotItem:e.parameters.pivotItemName})}function Ei(e){return Aa.substitute(Aa.Intents.PivotTableRenamedLabel,{newName:e.parameters.value})}function Ii(e){return e.parameters.value?Aa.substitute(Aa.Intents.PivotTableRowGrandTotalShownLabel,{pivotName:e.parameters.pivotName}):Aa.substitute(Aa.Intents.PivotTableRowGrandTotalHiddenLabel,{pivotName:e.parameters.pivotName})}function Ri(e){return e.parameters.value?Aa.substitute(Aa.Intents.PivotTableColumnGrandTotalShownLabel,{pivotName:e.parameters.pivotName}):Aa.substitute(Aa.Intents.PivotTableColumnGrandTotalHiddenLabel,{pivotName:e.parameters.pivotName})}function Ai(e){return Aa.substitute(Aa.Intents.PivotTableLayoutTypeSetLabel,{pivotName:e.parameters.pivotName})}function Li(e){return Aa.substitute(Aa.Intents.WorksheetValuesFilterAppliedLabel,{range:i.ExcelCalc.columnFromIExcelAddress(e.parameters.range.range,e.parameters.column)})}function ki(e){return Aa.substitute(Aa.Intents.WorksheetCustomFilterAppliedLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.range.range)})}function Fi(e){return Aa.substitute(Aa.Intents.WorksheetDynamicFilterAppliedLabel,{range:i.ExcelCalc.ICellColumnSheetRangeToAddress({range:{topLeft:{column:e.parameters.column,row:null},bottomRight:{column:e.parameters.column,row:null}},sheet:""})})}function _i(e){return Aa.substitute(Aa.Intents.RangeSortLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Pi(e){return Aa.substitute(Aa.Intents.ArtPasteSameWorkbookLabel,{sheet:i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.destinationRange).sheet})}function Ni(e){return Aa.substitute(Aa.Intents.RangeAutoSumLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.range.range)})}function Mi(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeHideRowsLabel,Aa.Intents.TableBodyRangeHideRowsLabel,Aa.Intents.TableHeaderRowRangeHideRowsLabel,Aa.Intents.TableTotalRowRangeHideRowsLabel,Aa.Intents.TableGeneralRangeHideRowsLabel,Aa.Intents.TableRowsRangeHideRowsLabel,Aa.Intents.TableRowByIndexRangeHideRowsLabel,Aa.Intents.TableColumnsRangeHideRowsLabel,Aa.Intents.TableColumnByNameRangeHideRowsLabel,Aa.Intents.TableColumnByIndexRangeHideRowsLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnNameHideRowsLabel,{columnName:e.parameters.columnName}):Aa.substitute(Aa.Intents.RangeHideRowsLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeUnhideRowsLabel,Aa.Intents.TableBodyRangeUnhideRowsLabel,Aa.Intents.TableHeaderRowRangeUnhideRowsLabel,Aa.Intents.TableTotalRowRangeUnhideRowsLabel,Aa.Intents.TableGeneralRangeUnhideRowsLabel,Aa.Intents.TableRowsRangeUnhideRowsLabel,Aa.Intents.TableRowByIndexRangeUnhideRowsLabel,Aa.Intents.TableColumnsRangeUnhideRowsLabel,Aa.Intents.TableColumnByNameRangeUnhideRowsLabel,Aa.Intents.TableColumnByIndexRangeUnhideRowsLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnNameUnhideRowsLabel,{columnName:e.parameters.columnName}):Aa.substitute(Aa.Intents.RangeUnhideRowsLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Oi(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeHideColumnsLabel,Aa.Intents.TableBodyRangeHideColumnsLabel,Aa.Intents.TableHeaderRowRangeHideColumnsLabel,Aa.Intents.TableTotalRowRangeHideColumnsLabel,Aa.Intents.TableGeneralRangeHideColumnsLabel,Aa.Intents.TableRowsRangeHideColumnsLabel,Aa.Intents.TableRowByIndexRangeHideColumnsLabel,Aa.Intents.TableColumnsRangeHideColumnsLabel,Aa.Intents.TableColumnByNameRangeHideColumnsLabel,Aa.Intents.TableColumnByIndexRangeHideColumnsLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnNameHideColumnsLabel,{columnName:e.parameters.columnName}):Aa.substitute(Aa.Intents.RangeHideColumnsLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeUnhideColumnsLabel,Aa.Intents.TableBodyRangeUnhideColumnsLabel,Aa.Intents.TableHeaderRowRangeUnhideColumnsLabel,Aa.Intents.TableTotalRowRangeUnhideColumnsLabel,Aa.Intents.TableGeneralRangeUnhideColumnsLabel,Aa.Intents.TableRowsRangeUnhideColumnsLabel,Aa.Intents.TableRowByIndexRangeUnhideColumnsLabel,Aa.Intents.TableColumnsRangeUnhideColumnsLabel,Aa.Intents.TableColumnByNameRangeUnhideColumnsLabel,Aa.Intents.TableColumnByIndexRangeUnhideColumnsLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnNameUnhideColumnsLabel,{columnName:e.parameters.columnName}):Aa.substitute(Aa.Intents.RangeUnhideColumnsLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Di(e){return e.parameters.events[0].parameters.value?Aa.Intents.MultiRangeHideRowsLabel:Aa.Intents.MultiRangeUnhideRowsLabel}function Bi(e){return e.parameters.events[0].parameters.value?Aa.Intents.MultiRangeHideColumnsLabel:Aa.Intents.MultiRangeUnhideColumnsLabel}function $i(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeConditionalFormattingCreatedGroupEventLabel,Aa.Intents.TableBodyRangeConditionalFormattingCreatedGroupEventLabel,Aa.Intents.TableHeaderRowRangeConditionalFormattingCreatedGroupEventLabel,Aa.Intents.TableTotalRowRangeConditionalFormattingCreatedGroupEventLabel,Aa.Intents.TableGeneralRangeConditionalFormattingCreatedGroupEventLabel,Aa.Intents.TableRowsRangeConditionalFormattingCreatedGroupEventLabel,Aa.Intents.TableRowByIndexRangeConditionalFormattingCreatedGroupEventLabel,Aa.Intents.TableColumnsRangeConditionalFormattingCreatedGroupEventLabel,Aa.Intents.TableColumnByNameRangeConditionalFormattingCreatedGroupEventLabel,Aa.Intents.TableColumnByIndexRangeConditionalFormattingCreatedGroupEventLabel,{}):Aa.substitute(Aa.Intents.ConditionalFormattingCreatedGroupEventLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Hi(e){const t=e.parameters.customFormat,n=[];t.IsTextBold&&n.push("bolded"),t.IsTextItalic&&n.push("italicized"),t.IsTextUnderlined&&n.push("underlined"),t.IsTextDoubleUnderlined&&n.push("double underlined");const a=[],o=t.BackgroundColor,r=t.TextColor,l=t.IsTextStrikethrough,s=t.BorderFormat.LineStyle,c=t.BorderFormat.Color;if(null!=o&&a.push(`${o} fill color`),null!=r&&a.push(`${r} font color`),l&&a.push("strikethrough"),s[0]!==i.BorderLineStyle.None){const e=(0,h.S)(c[0]);a.push(`${y.US[s[0]]} ${e} border`)}let u="";if(1===n.length&&0===a.length)u+=n[0];else if(0===n.length&&1===a.length)u+="applied a "+a[0]+" to";else if(1===n.length&&1===a.length)u+=n[0]+" and applied a "+a[0]+" to";else if(2===n.length&&0===a.length)u+=n[0]+" and "+n[1];else if(0===n.length&&2===a.length)u+="applied a "+a[0]+" and a "+a[1]+" to";else{if(n.length>0){for(let e=0;e<n.length-1;e++)u+=n[e]+", ";0===a.length?u+="and "+n[n.length-1]:u+=n[n.length-1]+", "}if(a.length>0)if(1===a.length)u+="and applied a "+a[0];else{u+="applied a ";for(let e=0;e<a.length-1;e++)u+=a[e]+", ";u+="and "+a[a.length-1]+" to"}}const m=[{key:d.Dh.EventType,value:d.Mv.LogSuccessMessageFormattingParameters},{key:d.Dh.SuccessMessageNumParameters,value:n.length+a.length},{key:d.Dh.SuccessMessageFormattingParameters,value:n.concat(a).join(", ")}];return(0,T.j)(m),u}function Ui(e){const t=/"|=|DATEVALUE|\(|\)/g;let n="cell value is ";const a=e.parameters.rule,o=a.operator;if(n+=y.Mb[o]+" "+a.formula1.replace(t,""),a.formula2&&(o===x.default.Between||o===x.default.NotBetween)){n+=" and "+a.formula2.replace(t,"")}return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeConditionalFormattingCellValueCreatedLabel,Aa.Intents.TableBodyRangeConditionalFormattingCellValueCreatedLabel,Aa.Intents.TableHeaderRowRangeConditionalFormattingCellValueCreatedLabel,Aa.Intents.TableTotalRowRangeConditionalFormattingCellValueCreatedLabel,Aa.Intents.TableGeneralRangeConditionalFormattingCellValueCreatedLabel,Aa.Intents.TableRowsRangeConditionalFormattingCellValueCreatedLabel,Aa.Intents.TableRowByIndexRangeConditionalFormattingCellValueCreatedLabel,Aa.Intents.TableColumnsRangeConditionalFormattingCellValueCreatedLabel,Aa.Intents.TableColumnByNameRangeConditionalFormattingCellValueCreatedLabel,Aa.Intents.TableColumnByIndexRangeConditionalFormattingCellValueCreatedLabel,{cellFormat:Hi(e),cellValueCriteria:n}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnNameConditionalFormattingCellValueCreatedLabel,{cellFormat:Hi(e),columnName:e.parameters.columnName,cellValueCriteria:n}):Aa.substitute(Aa.Intents.ConditionalFormattingCellValueCreatedLabel,{cellFormat:Hi(e),range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),cellValueCriteria:n})}function qi(e){const t=e.parameters.rule.formula;return e.parameters.rangeType===i.RangeType.TableRange?pl(e.parameters.range,Aa.Intents.TableRangeConditionalFormattingCustomFormulaCreatedLabel,Aa.Intents.TableBodyRangeConditionalFormattingCustomFormulaCreatedLabel,Aa.Intents.TableHeaderRowRangeConditionalFormattingCustomFormulaCreatedLabel,Aa.Intents.TableTotalRowRangeConditionalFormattingCustomFormulaCreatedLabel,Aa.Intents.TableGeneralRangeConditionalFormattingCustomFormulaCreatedLabel,Aa.Intents.TableRowsRangeConditionalFormattingCustomFormulaCreatedLabel,Aa.Intents.TableRowByIndexRangeConditionalFormattingCustomFormulaCreatedLabel,Aa.Intents.TableColumnsRangeConditionalFormattingCustomFormulaCreatedLabel,Aa.Intents.TableColumnByNameRangeConditionalFormattingCustomFormulaCreatedLabel,Aa.Intents.TableColumnByIndexRangeConditionalFormattingCustomFormulaCreatedLabel,{cellFormat:Hi(e),customFormula:t}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnNameConditionalFormattingCustomFormulaCreatedLabel,{cellFormat:Hi(e),columnName:e.parameters.columnName,customFormula:t}):Aa.substitute(Aa.Intents.ConditionalFormattingCustomFormulaCreatedLabel,{cellFormat:Hi(e),range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),customFormula:t})}function Vi(e){const t=e.parameters.rule,n=y.tQ[t.operator]+" "+t.text;return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeConditionalFormattingTextComparisonCreatedLabel,Aa.Intents.TableBodyRangeConditionalFormattingTextComparisonCreatedLabel,Aa.Intents.TableHeaderRowRangeConditionalFormattingTextComparisonCreatedLabel,Aa.Intents.TableTotalRowRangeConditionalFormattingTextComparisonCreatedLabel,Aa.Intents.TableGeneralRangeConditionalFormattingTextComparisonCreatedLabel,Aa.Intents.TableRowsRangeConditionalFormattingTextComparisonCreatedLabel,Aa.Intents.TableRowByIndexRangeConditionalFormattingTextComparisonCreatedLabel,Aa.Intents.TableColumnsRangeConditionalFormattingTextComparisonCreatedLabel,Aa.Intents.TableColumnByNameRangeConditionalFormattingTextComparisonCreatedLabel,Aa.Intents.TableColumnByIndexRangeConditionalFormattingTextComparisonCreatedLabel,{cellFormat:Hi(e),textComparisonCriteria:n}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnConditionalFormattingTextComparisonCreatedLabel,{cellFormat:Hi(e),columnName:e.parameters.columnName,textComparisonCriteria:n}):Aa.substitute(Aa.Intents.ConditionalFormattingTextComparisonCreatedLabel,{cellFormat:Hi(e),range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),textComparisonCriteria:n})}function Wi(e){const t=e.parameters.colorScaleFormat;let n="";if(t){const e=t.minimumColor,a=t.midpointColor,o=t.maximumColor;n=a?e+", "+a+", "+o:e+", "+o}return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeConditionalFormattingColorScaleCustomCreatedLabel,Aa.Intents.TableBodyRangeConditionalFormattingColorScaleCustomCreatedLabel,Aa.Intents.TableHeaderRowRangeConditionalFormattingColorScaleCustomCreatedLabel,Aa.Intents.TableTotalRowRangeConditionalFormattingColorScaleCustomCreatedLabel,Aa.Intents.TableGeneralRangeConditionalFormattingColorScaleCustomCreatedLabel,Aa.Intents.TableRowsRangeConditionalFormattingColorScaleCustomCreatedLabel,Aa.Intents.TableRowByIndexRangeConditionalFormattingColorScaleCustomCreatedLabel,Aa.Intents.TableColumnsRangeConditionalFormattingColorScaleCustomCreatedLabel,Aa.Intents.TableColumnByNameRangeConditionalFormattingColorScaleCustomCreatedLabel,Aa.Intents.TableColumnByIndexRangeConditionalFormattingColorScaleCustomCreatedLabel,{colorScaleFormat:n}):Aa.substitute(Aa.Intents.ConditionalFormattingColorScaleCustomCreatedLabel,{colorScaleFormat:n,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Gi(e){const t=e.parameters.dataBarFormat;let n="";if(t){const e=t.isGradientFill,a=t.fillColor;n=e?"gradient "+a:"solid "+a}return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeConditionalFormattingDataBarCustomCreatedLabel,Aa.Intents.TableBodyRangeConditionalFormattingDataBarCustomCreatedLabel,Aa.Intents.TableHeaderRowRangeConditionalFormattingDataBarCustomCreatedLabel,Aa.Intents.TableTotalRowRangeConditionalFormattingDataBarCustomCreatedLabel,Aa.Intents.TableGeneralRangeConditionalFormattingDataBarCustomCreatedLabel,Aa.Intents.TableRowsRangeConditionalFormattingDataBarCustomCreatedLabel,Aa.Intents.TableRowByIndexRangeConditionalFormattingDataBarCustomCreatedLabel,Aa.Intents.TableColumnsRangeConditionalFormattingDataBarCustomCreatedLabel,Aa.Intents.TableColumnByNameRangeConditionalFormattingDataBarCustomCreatedLabel,Aa.Intents.TableColumnByIndexRangeConditionalFormattingDataBarCustomCreatedLabel,{dataBarFormat:n}):Aa.substitute(Aa.Intents.ConditionalFormattingDataBarCustomCreatedLabel,{dataBarFormat:n,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function zi(e){const t=e.parameters.style,n=y.B8[t];return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeConditionalFormattingIconSetCreatedLabel,Aa.Intents.TableBodyRangeConditionalFormattingIconSetCreatedLabel,Aa.Intents.TableHeaderRowRangeConditionalFormattingIconSetCreatedLabel,Aa.Intents.TableTotalRowRangeConditionalFormattingIconSetCreatedLabel,Aa.Intents.TableGeneralRangeConditionalFormattingIconSetCreatedLabel,Aa.Intents.TableRowsRangeConditionalFormattingIconSetCreatedLabel,Aa.Intents.TableRowByIndexRangeConditionalFormattingIconSetCreatedLabel,Aa.Intents.TableColumnsRangeConditionalFormattingIconSetCreatedLabel,Aa.Intents.TableColumnByNameRangeConditionalFormattingIconSetCreatedLabel,Aa.Intents.TableColumnByIndexRangeConditionalFormattingIconSetCreatedLabel,{iconSet:n}):Aa.substitute(Aa.Intents.ConditionalFormattingIconSetCreatedLabel,{iconSet:n,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Qi(e){const t=e.parameters.rule,n=y.b3[t.criterion];return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeConditionalFormattingPresetCreatedLabel,Aa.Intents.TableBodyRangeConditionalFormattingPresetCreatedLabel,Aa.Intents.TableHeaderRowRangeConditionalFormattingPresetCreatedLabel,Aa.Intents.TableTotalRowRangeConditionalFormattingPresetCreatedLabel,Aa.Intents.TableGeneralRangeConditionalFormattingPresetCreatedLabel,Aa.Intents.TableRowsRangeConditionalFormattingPresetCreatedLabel,Aa.Intents.TableRowByIndexRangeConditionalFormattingPresetCreatedLabel,Aa.Intents.TableColumnsRangeConditionalFormattingPresetCreatedLabel,Aa.Intents.TableColumnByNameRangeConditionalFormattingPresetCreatedLabel,Aa.Intents.TableColumnByIndexRangeConditionalFormattingPresetCreatedLabel,{cellFormatting:Hi(e),presetCriterion:n}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnNameConditionalFormattingPresetCreatedLabel,{cellFormatting:Hi(e),presetCriterion:n,columnName:e.parameters.columnName}):Aa.substitute(Aa.Intents.ConditionalFormattingPresetCreatedLabel,{cellFormatting:Hi(e),presetCriterion:n,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function ji(e){const t=e.parameters.rule,n=y.GO[t.timePeriodType];return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeConditionalFormattingPresetDatesCreatedLabel,Aa.Intents.TableBodyRangeConditionalFormattingPresetDatesCreatedLabel,Aa.Intents.TableHeaderRowRangeConditionalFormattingPresetDatesCreatedLabel,Aa.Intents.TableTotalRowRangeConditionalFormattingPresetDatesCreatedLabel,Aa.Intents.TableGeneralRangeConditionalFormattingPresetDatesCreatedLabel,Aa.Intents.TableRowsRangeConditionalFormattingPresetDatesCreatedLabel,Aa.Intents.TableRowByIndexRangeConditionalFormattingPresetDatesCreatedLabel,Aa.Intents.TableColumnsRangeConditionalFormattingPresetDatesCreatedLabel,Aa.Intents.TableColumnByNameRangeConditionalFormattingPresetDatesCreatedLabel,Aa.Intents.TableColumnByIndexRangeConditionalFormattingPresetDatesCreatedLabel,{cellFormatting:Hi(e),dateString:n}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnNameConditionalFormattingPresetDatesCreatedLabel,{cellFormatting:Hi(e),dateString:n,columnName:e.parameters.columnName}):Aa.substitute(Aa.Intents.ConditionalFormattingPresetDatesCreatedLabel,{cellFormatting:Hi(e),dateString:n,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Ji(e){const t=e.parameters.rule.unique;return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeConditionalFormattingUniqueDuplicateCreatedLabel,Aa.Intents.TableBodyRangeConditionalFormattingUniqueDuplicateCreatedLabel,Aa.Intents.TableHeaderRowRangeConditionalFormattingUniqueDuplicateCreatedLabel,Aa.Intents.TableTotalRowRangeConditionalFormattingUniqueDuplicateCreatedLabel,Aa.Intents.TableGeneralRangeConditionalFormattingUniqueDuplicateCreatedLabel,Aa.Intents.TableRowsRangeConditionalFormattingUniqueDuplicateCreatedLabel,Aa.Intents.TableRowByIndexRangeConditionalFormattingUniqueDuplicateCreatedLabel,Aa.Intents.TableColumnsRangeConditionalFormattingUniqueDuplicateCreatedLabel,Aa.Intents.TableColumnByNameRangeConditionalFormattingUniqueDuplicateCreatedLabel,Aa.Intents.TableColumnByIndexRangeConditionalFormattingUniqueDuplicateCreatedLabel,{cellFormatting:Hi(e),unique:t?"unique":"duplicate"}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnNameConditionalFormattingUniqueDuplicateCreatedLabel,{cellFormatting:Hi(e),unique:t?"unique":"duplicate",columnName:e.parameters.columnName}):Aa.substitute(Aa.Intents.ConditionalFormattingUniqueDuplicateCreatedLabel,{cellFormatting:Hi(e),unique:t?"unique":"duplicate",range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Yi(e){const t=e.parameters.rule,n=t.rank,a=y.tg[t.type],o=Aa.substitute(a,{number:n});return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeConditionalFormattingTopBottomCreatedLabel,Aa.Intents.TableBodyRangeConditionalFormattingTopBottomCreatedLabel,Aa.Intents.TableHeaderRowRangeConditionalFormattingTopBottomCreatedLabel,Aa.Intents.TableTotalRowRangeConditionalFormattingTopBottomCreatedLabel,Aa.Intents.TableGeneralRangeConditionalFormattingTopBottomCreatedLabel,Aa.Intents.TableRowsRangeConditionalFormattingTopBottomCreatedLabel,Aa.Intents.TableRowByIndexRangeConditionalFormattingTopBottomCreatedLabel,Aa.Intents.TableColumnsRangeConditionalFormattingTopBottomCreatedLabel,Aa.Intents.TableColumnByNameRangeConditionalFormattingTopBottomCreatedLabel,Aa.Intents.TableColumnByIndexRangeConditionalFormattingTopBottomCreatedLabel,{cellFormatting:Hi(e),topBottomRule:o}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnNameConditionalFormattingTopBottomCreatedLabel,{cellFormatting:Hi(e),topBottomRule:o,columnName:e.parameters.columnName}):Aa.substitute(Aa.Intents.ConditionalFormattingTopBottomCreatedLabel,{cellFormatting:Hi(e),topBottomRule:o,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Xi(e){return Aa.substitute(Aa.Intents.ConditionalFormattingEditedGroupEventLabel,{sheet:e.entityId})}function Zi(e){return Aa.substitute(Aa.Intents.ConditionalFormattingRuleDeletedLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.ranges[0]).range)})}function Ki(e){return s.O.MissingIntent}function el(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeConditionalFormattingDeletedLabel,Aa.Intents.TableBodyRangeConditionalFormattingDeletedLabel,Aa.Intents.TableHeaderRowRangeConditionalFormattingDeletedLabel,Aa.Intents.TableTotalRowRangeConditionalFormattingDeletedLabel,Aa.Intents.TableGeneralRangeConditionalFormattingDeletedLabel,Aa.Intents.TableRowsRangeConditionalFormattingDeletedLabel,Aa.Intents.TableRowByIndexRangeConditionalFormattingDeletedLabel,Aa.Intents.TableColumnsRangeConditionalFormattingDeletedLabel,Aa.Intents.TableColumnByNameRangeConditionalFormattingDeletedLabel,Aa.Intents.TableColumnByIndexRangeConditionalFormattingDeletedLabel,{}):Aa.substitute(Aa.Intents.ConditionalFormattingDeletedLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function tl(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeCellStyleAppliedLabel,Aa.Intents.TableBodyRangeCellStyleAppliedLabel,Aa.Intents.TableHeaderRowRangeCellStyleAppliedLabel,Aa.Intents.TableTotalRowRangeCellStyleAppliedLabel,Aa.Intents.TableGeneralRangeCellStyleAppliedLabel,Aa.Intents.TableRowsRangeCellStyleAppliedLabel,Aa.Intents.TableRowByIndexRangeCellStyleAppliedLabel,Aa.Intents.TableColumnsRangeCellStyleAppliedLabel,Aa.Intents.TableColumnByNameRangeCellStyleAppliedLabel,Aa.Intents.TableColumnByIndexRangeCellStyleAppliedLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?Aa.substitute(Aa.Intents.ColumnNameCellStyleAppliedLabel,{columnName:e.parameters.columnName}):Aa.substitute(Aa.Intents.RangeCellStyleAppliedLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function nl(e){return Aa.substitute(Aa.Intents.PictureInsertedEventLabel,{sheet:e.entityId})}function al(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,Aa.Intents.TableRangeCustomSortLabel,Aa.Intents.TableBodyRangeCustomSortLabel,Aa.Intents.TableHeaderRowRangeCustomSortLabel,Aa.Intents.TableTotalRowRangeCustomSortLabel,Aa.Intents.TableGeneralRangeCustomSortLabel,Aa.Intents.TableRowsRangeCustomSortLabel,Aa.Intents.TableRowByIndexRangeCustomSortLabel,Aa.Intents.TableColumnsRangeCustomSortLabel,Aa.Intents.TableColumnByNameCustomSortLabel,Aa.Intents.TableColumnByIndexCustomSortLabel,{}):Aa.substitute(Aa.Intents.RangeCustomSortLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function ol(e){return Aa.substitute(Aa.Intents.AutoFilterCustomSortLabel,{sheet:i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).sheet})}function rl(e){return Aa.substitute(Aa.Intents.TextToColumnsLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.sourceRange).range)})}function il(e){return Aa.substitute(Aa.Intents.AllowEditRangeAddedLabel,{range:void 0!==e.parameters.events?e.parameters.events[1].parameters.title:e.parameters.title})}function ll(e){return Aa.substitute(Aa.Intents.AllowEditRangeDeletedLabel,{range:void 0!==e.parameters.events?e.parameters.events[1].parameters.title:e.parameters.title})}function sl(e){return Aa.substitute(Aa.Intents.AllowEditRangeEditedLabel,{range:void 0!==e.parameters.events?e.parameters.events[1].parameters.title:e.parameters.title})}function cl(e){return Aa.substitute(Aa.Intents.SheetProtectionOptionsUpdatedLabel,{sheet:e.entityId})}function dl(e){return Aa.substitute(Aa.Intents.SheetProtectionPasswordUpdatedLabel,{sheet:e.entityId})}function ul(e){return Aa.substitute(Aa.Intents.SheetProtectionPausedLabel,{sheet:e.entityId})}function ml(e){return Aa.substitute(Aa.Intents.SheetProtectionProtectedLabel,{sheet:e.entityId})}function gl(e){return Aa.substitute(Aa.Intents.SheetProtectionResumedLabel,{sheet:e.entityId})}function hl(e){return Aa.substitute(Aa.Intents.SheetProtectionUnprotectedLabel,{sheet:e.entityId})}function pl(e,t,n,a,o,r,l,s,c,d,u,m){let g;switch(m.tableName=e.tableName,e.subRange){case i.TableRangeOperationSubRange.WholeTable:g=t;break;case i.TableRangeOperationSubRange.Body:g=n;break;case i.TableRangeOperationSubRange.HeaderRow:g=a;break;case i.TableRangeOperationSubRange.TotalRow:g=o;break;case i.TableRangeOperationSubRange.General:g=r;break;case i.TableRangeOperationSubRange.Columns:case i.TableRangeOperationSubRange.ColumnsBody:{g=c;const t=e.subRangeValues;if(t.columnNames)1===t.columnNames.length?(g=d,m.columnName=t.columnNames[0]):m.count=t.columnNames.length;else{const t=e.subRangeValues;1===t.count?(g=u,m.columnIndex=t.firstIndex):m.count=t.count}break}case i.TableRangeOperationSubRange.Rows:{const t=e.subRangeValues;1===t.count?(g=s,m.rowIndex=t.firstIndex):(g=l,m.count=t.count);break}}return Aa.substitute(g,m)}var bl=n(54947);function fl(e){let t=e.method;return t===i.EventMethods.System.Batched&&(t=e.parameters.method),t}const Cl=new Map([[i.EventMethods.Worksheet.Added,()=>Aa.Intents.WorksheetAddLabel],[i.EventMethods.Worksheet.AddedWithName,ka],[i.EventMethods.Worksheet.Deleted,()=>Aa.Intents.WorksheetDeleteLabel],[i.EventMethods.Worksheet.MultiSheetDeleted,_a],[i.EventMethods.Worksheet.Renamed,Fa],[i.EventMethods.Worksheet.Duplicated,Go],[i.EventMethods.Worksheet.FilterReapplied,zo],[i.EventMethods.Worksheet.AutoFilterCleared,Qo],[i.EventMethods.Worksheet.Reordered,tr],[i.EventMethods.Worksheet.AutoFilterToggled,ar],[i.EventMethods.Worksheet.GridlinesToggled,gr],[i.EventMethods.Worksheet.HeadingsToggled,mr],[i.EventMethods.Worksheet.TabColored,yr],[i.EventMethods.Worksheet.PaneFrozen,qr],[i.EventMethods.Worksheet.ColumnsFrozen,()=>Aa.Intents.WorksheetFreezeColumnsLabel],[i.EventMethods.Worksheet.RowsFrozen,()=>Aa.Intents.WorksheetFreezeRowsLabel],[i.EventMethods.Worksheet.OutlineLevelsShown,ui],[i.EventMethods.Worksheet.ValuesFilterApplied,Li],[i.EventMethods.Worksheet.CustomFilterApplied,ki],[i.EventMethods.Worksheet.DynamicFilterApplied,Fi],[i.EventMethods.Worksheet.VisibilityChanged,()=>Aa.Intents.WorksheetVisibilityChangedLabel],[i.EventMethods.Worksheet.MoveToEdge,()=>Aa.Intents.MoveToEdgeLabel],[i.EventMethods.Intent.CreateNamedItemOnWorkbook,()=>Aa.Intents.CreateNamedItem],[i.EventMethods.Intent.CreateNamedItemOnWorksheet,()=>Aa.Intents.CreateNamedItem],[i.EventMethods.Intent.SetNamedItemOnWorkbook,()=>Aa.Intents.SetNamedItem],[i.EventMethods.Intent.SetNamedItemOnWorksheet,()=>Aa.Intents.SetNamedItem],[i.EventMethods.Intent.DeleteNamedItemOnWorkbook,()=>Aa.Intents.DeleteNamedItem],[i.EventMethods.Intent.RangeSetIndent,()=>Aa.Intents.ChangeRangeIndent],[i.EventMethods.Intent.RangeAdjustIndent,()=>Aa.Intents.ChangeRangeIndent],[i.EventMethods.Range.Edited,Pa],[i.EventMethods.Range.SingleValueEdited,Na],[i.EventMethods.Range.MultiRangeEdited,()=>Aa.Intents.MultiRangeEditLabel],[i.EventMethods.Range.MultiRangeDeleted,()=>Aa.Intents.MultiRangeDeleteLabel],[i.EventMethods.Range.MultiRangeDeleted,()=>Aa.Intents.MultiRangeDeleteLabel],[i.EventMethods.Range.Cleared,Ma],[i.EventMethods.Range.MultiRangeCleared,()=>Aa.Intents.MultiRangeClearLabel],[i.EventMethods.Range.Deleted,Oa],[i.EventMethods.Range.Inserted,Da],[i.EventMethods.Range.Merged,Ba],[i.EventMethods.Range.MultiRangeMerged,()=>Aa.Intents.MultiRangeMergeLabel],[i.EventMethods.Range.MultiRangeInserted,()=>Aa.Intents.MultipleRangeInsertLabel],[i.EventMethods.Range.Unmerged,$a],[i.EventMethods.Range.MultiRangeUnmerged,()=>Aa.Intents.MultiRangeUnmergeLabel],[i.EventMethods.Range.ColumnsAutoFit,Ha],[i.EventMethods.Range.MultiRangeColumnsAutoFit,Ha],[i.EventMethods.Range.RowsAutoFit,Ua],[i.EventMethods.Range.UseStandardHeight,qa],[i.EventMethods.Range.UseStandardWidth,Va],[i.EventMethods.Range.MultiRangeRowsAutoFit,Ua],[i.EventMethods.Range.HyperlinkApplied,Wa],[i.EventMethods.Range.HyperlinkRemoved,Ga],[i.EventMethods.Range.MultiRangeHyperlinkRemoved,()=>Aa.Intents.MultiRangeRemoveHyperlinkLabel],[i.EventMethods.Range.NumberFormatChanged,za],[i.EventMethods.Range.MultiRangeNumberFormatChanged,()=>Aa.Intents.MultiRangeNumberFormatLabel],[i.EventMethods.Range.InsertCopiedCutCells,Qa],[i.EventMethods.Range.InsertCopiedCutCellsInTable,e=>function(e){const t=e.parameters.destinationTableRange.subRangeValues;return 0===e.parameters.copyCutOperation?Aa.substitute(Aa.Intents.RangePasteCopyInTableLabel,{tableName:e.entityId,rowIndex:t.firstIndex}):Aa.substitute(Aa.Intents.RangePasteCutInTableLabel,{tableName:e.entityId,rowIndex:t.firstIndex})}(e)],[i.EventMethods.Range.Filled,ja],[i.EventMethods.Range.DuplicatesRemoved,hr],[i.EventMethods.Range.FlashFilled,Sr],[i.EventMethods.Range.Grouped,ci],[i.EventMethods.Range.Ungrouped,di],[i.EventMethods.Range.GroupDetailsShown,mi],[i.EventMethods.Range.GroupDetailsHidden,gi],[i.EventMethods.Range.Sorted,_i],[i.EventMethods.Range.DataValidationChangedGroup,hi],[i.EventMethods.Range.AutoSum,Ni],[i.EventMethods.Range.CellStyleApplied,tl],[i.EventMethods.Range.MultiRangeCellStyleApplied,()=>Aa.Intents.MultiRangeCellStyleAppliedLabel],[i.EventMethods.Range.CustomSorted,al],[i.EventMethods.Range.AutoFilterCustomSorted,ol],[i.EventMethods.Range.TextToColumns,rl],[i.EventMethods.Range.FixedWidthTextToColumns,()=>Aa.Intents.FixedWidthTextToColumns],[i.EventMethods.Intent.SetDataValidation,()=>Aa.Intents.IntentSetDataValidation],[i.EventMethods.Shape.Inserted,Vr],[i.EventMethods.Shape.StyleSet,Wr],[i.EventMethods.Shape.Deleted,jr],[i.EventMethods.Shape.MovedAndResized,Yr],[i.EventMethods.Shape.ZOrderChanged,Xr],[i.EventMethods.Shape.Rotated,Zr],[i.EventMethods.Shape.AltTextApplied,Kr],[i.EventMethods.Shape.PictureInserted,nl],[i.EventMethods.Shape.TextChanged,ei],[i.EventMethods.Shape.TextBolded,ti],[i.EventMethods.Shape.TextItalicized,ni],[i.EventMethods.Shape.TextUnderlined,ai],[i.EventMethods.Shape.TextFontNameChanged,oi],[i.EventMethods.Shape.TextFontSizeChanged,ri],[i.EventMethods.Shape.TextFontColorChanged,ii],[i.EventMethods.Shape.TextHorizontallyAligned,li],[i.EventMethods.Shape.TextVerticallyAligned,si],[i.EventMethods.PivotTable.Created,()=>Aa.Intents.PivotTableCreateLabel],[i.EventMethods.PivotTable.SortApplied,()=>Aa.Intents.PivotTableSortLabel],[i.EventMethods.PivotTable.PivotPositionChanged,()=>Aa.Intents.PivotTableChangePositionLabel],[i.EventMethods.PivotTable.CreatedOnNewSheet,()=>Aa.Intents.PivotTableCreateLabel],[i.EventMethods.PivotTable.PivotRemoved,xi],[i.EventMethods.PivotTable.PivotAdded,Ti],[i.EventMethods.PivotTable.PivotAdded,Ti],[i.EventMethods.PivotTable.Pivoted,vi],[i.EventMethods.PivotTable.Refreshed,Si],[i.EventMethods.PivotTable.PivotDrillToggled,wi],[i.EventMethods.PivotTable.Renamed,Ei],[i.EventMethods.PivotTable.RowGrandTotalShown,Ii],[i.EventMethods.PivotTable.ColumnGrandTotalShown,Ri],[i.EventMethods.PivotTable.AutoFitColumnWidthsOnRefreshToggled,e=>function(e){return Aa.substitute(Aa.Intents.PivotTableAutoFitColumnWidthsOnRefreshToggledLabel,{pivotName:e.parameters.pivotName,value:e.parameters.value})}(e)],[i.EventMethods.PivotTable.SubTotalsVisibilitySettingSet,e=>function(e){return Aa.substitute(Aa.Intents.PivotTableSubTotalsVisibilitySettingSetLabel,{pivotName:e.parameters.pivotName})}(e)],[i.EventMethods.PivotTable.LayoutTypeSet,Ai],[i.EventMethods.Slicer.Inserted,or],[i.EventMethods.Chart.Created,rr],[i.EventMethods.Chart.MultiRangeCreated,ur],[i.EventMethods.Chart.RowColumnSwitched,vr],[i.EventMethods.Chart.DataSelected,Tr],[i.EventMethods.Chart.TypeChanged,xr],[i.EventMethods.Chart.TitleChanged,wr],[i.EventMethods.Chart.TitleTextChanged,kr],[i.EventMethods.Chart.TitleHidden,Er],[i.EventMethods.Chart.AxisTitleChanged,Ir],[i.EventMethods.Chart.AxisTitleHidden,Rr],[i.EventMethods.Chart.AxisTitleTextChanged,Lr],[i.EventMethods.Chart.AxisTitleHorizontal,()=>Aa.Intents.ChartAxisTitleHorizontal],[i.EventMethods.Chart.AxisTitleVertical,()=>Aa.Intents.ChartAxisTitleVertical],[i.EventMethods.Chart.LegendChanged,Ar],[i.EventMethods.Chart.LegendHidden,Fr],[i.EventMethods.Chart.DataLabelPositionChanged,_r],[i.EventMethods.Chart.DataLabelVisibilityChanged,Pr],[i.EventMethods.Chart.GridlinesVisibilityChanged,e=>function(e){return Aa.substitute(Aa.Intents.WorksheetChartChangeGridlineVisiblityLabel,{chartName:e.parameters.events[0].parameters.chartName,sheet:e.entityId})}(e)],[i.EventMethods.Chart.AxisChanged,Nr],[i.EventMethods.Chart.AxisVisiblityChanged,Mr],[i.EventMethods.Chart.Deleted,Gr],[i.EventMethods.Chart.MovedAndResized,Jr],[i.EventMethods.Chart.SeriesDeleted,zr],[i.EventMethods.Chart.SeriesDataChanged,Qr],[i.EventMethods.ChartFormat.SetGetProperties,e=>function(e){return Aa.substitute(Aa.Intents.ChartFormatSetGetPropertiesLabel,{count:e.parameters.events.length,chartName:e.parameters.events[0].parameters.chartName})}(e)],[i.EventMethods.Visual.ChartAxisAxisTitleFillColored,e=>lr(e,Aa.Intents.VisualChartAxisAxisTitleFillColoredLabel,ir)],[i.EventMethods.Visual.ChartAxisAxisTitleFontBolded,e=>lr(e,Aa.Intents.VisualChartAxisAxisTitleFontBoldedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleFontColored,e=>lr(e,Aa.Intents.VisualChartAxisAxisTitleFontColoredLabel,ir)],[i.EventMethods.Visual.ChartAxisAxisTitleFontItalicized,e=>lr(e,Aa.Intents.VisualChartAxisAxisTitleFontItalicizedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleFontNamed,e=>lr(e,Aa.Intents.VisualChartAxisAxisTitleFontNamedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleFontSized,e=>lr(e,Aa.Intents.VisualChartAxisAxisTitleFontSizedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleFontUnderlined,e=>lr(e,Aa.Intents.VisualChartAxisAxisTitleFontUnderlinedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleLineColored,e=>lr(e,Aa.Intents.VisualChartAxisAxisTitleLineColoredLabel,ir)],[i.EventMethods.Visual.ChartAxisAxisTitleTextChanged,e=>lr(e,Aa.Intents.VisualChartAxisAxisTitleTextChangedLabel)],[i.EventMethods.Visual.ChartAxisBoundsMaxChanged,e=>lr(e,Aa.Intents.VisualChartAxisBoundsMaxChangedLabel)],[i.EventMethods.Visual.ChartAxisBoundsMinChanged,e=>lr(e,Aa.Intents.VisualChartAxisBoundsMinChangedLabel)],[i.EventMethods.Visual.ChartAxisCrossesAtChanged,e=>lr(e,Aa.Intents.VisualChartAxisCrossesAtChangedLabel)],[i.EventMethods.Visual.ChartAxisCrossesChanged,e=>lr(e,Aa.Intents.VisualChartAxisCrossesChangedLabel)],[i.EventMethods.Visual.ChartAxisFillColored,e=>lr(e,Aa.Intents.VisualChartAxisFillColoredLabel,ir)],[i.EventMethods.Visual.ChartAxisFontBolded,e=>lr(e,Aa.Intents.VisualChartAxisFontBoldedLabel)],[i.EventMethods.Visual.ChartAxisFontColored,e=>lr(e,Aa.Intents.VisualChartAxisFontColoredLabel,ir)],[i.EventMethods.Visual.ChartAxisFontItalicized,e=>lr(e,Aa.Intents.VisualChartAxisFontItalicizedLabel)],[i.EventMethods.Visual.ChartAxisFontNamed,e=>lr(e,Aa.Intents.VisualChartAxisFontNamedLabel)],[i.EventMethods.Visual.ChartAxisFontSized,e=>lr(e,Aa.Intents.VisualChartAxisFontSizedLabel)],[i.EventMethods.Visual.ChartAxisFontUnderlined,e=>lr(e,Aa.Intents.VisualChartAxisFontUnderlinedLabel)],[i.EventMethods.Visual.ChartAxisGridlinesMajorGridlinesLineColored,e=>lr(e,Aa.Intents.VisualChartAxisMajorGridlinesLineColoredLabel,ir)],[i.EventMethods.Visual.ChartAxisGridlinesMinorGridlinesLineColored,e=>lr(e,Aa.Intents.VisualChartAxisMinorGridlinesLineColoredLabel,ir)],[i.EventMethods.Visual.ChartAxisLineColored,e=>lr(e,Aa.Intents.VisualChartAxisLineColoredLabel,ir)],[i.EventMethods.Visual.ChartAxisNumberFormatCodeChanged,e=>lr(e,Aa.Intents.VisualChartAxisNumberFormatCodeChangedLabel)],[i.EventMethods.Visual.ChartAxisReversePlotOrderChanged,e=>lr(e,Aa.Intents.VisualChartAxisReversePlotOrderChangedLabel)],[i.EventMethods.Visual.ChartAxisTickMarksMajorTypeChanged,e=>lr(e,Aa.Intents.VisualChartAxisTickMarksMajorTypeChangedLabel)],[i.EventMethods.Visual.ChartAxisTickMarksMinorTypeChanged,e=>lr(e,Aa.Intents.VisualChartAxisTickMarksMinorTypeChangedLabel)],[i.EventMethods.Visual.ChartAxisUnitsMajorUnitChanged,e=>lr(e,Aa.Intents.VisualChartAxisUnitsMajorUnitChangedLabel)],[i.EventMethods.Visual.ChartAxisUnitsMinorUnitChanged,e=>lr(e,Aa.Intents.VisualChartAxisUnitsMinorUnitChangedLabel)],[i.EventMethods.Visual.ChartTitleFillColored,e=>lr(e,Aa.Intents.VisualChartTitleFillColoredLabel,ir)],[i.EventMethods.Visual.ChartTitleFontBolded,e=>lr(e,Aa.Intents.VisualChartTitleFontBoldedLabel)],[i.EventMethods.Visual.ChartTitleFontColored,e=>lr(e,Aa.Intents.VisualChartTitleFontColoredLabel,ir)],[i.EventMethods.Visual.ChartTitleFontItalicized,e=>lr(e,Aa.Intents.VisualChartTitleFontItalicizedLabel)],[i.EventMethods.Visual.ChartTitleFontNamed,e=>lr(e,Aa.Intents.VisualChartTitleFontNamedLabel)],[i.EventMethods.Visual.ChartTitleFontSized,e=>lr(e,Aa.Intents.VisualChartTitleFontSizedLabel)],[i.EventMethods.Visual.ChartTitleFontUnderlined,e=>lr(e,Aa.Intents.VisualChartTitleFontUnderlinedLabel)],[i.EventMethods.Visual.ChartTitleLineColored,e=>lr(e,Aa.Intents.VisualChartTitleLineColoredLabel,ir)],[i.EventMethods.Visual.ChartTitleOverlayChanged,e=>lr(e,Aa.Intents.VisualChartTitleOverlayChangedLabel)],[i.EventMethods.Visual.ChartTitleTextChanged,e=>lr(e,Aa.Intents.VisualChartTitleTextChangedLabel)],[i.EventMethods.Visual.LegendFillCleared,()=>Aa.Intents.VisualLegendFillClearedLabel],[i.EventMethods.Visual.LegendFillColored,e=>lr(e,Aa.Intents.VisualLegendFillColoredLabel,ir)],[i.EventMethods.Visual.LegendFontBolded,e=>lr(e,Aa.Intents.VisualLegendFontBoldedLabel)],[i.EventMethods.Visual.LegendFontColored,e=>lr(e,Aa.Intents.VisualLegendFontColoredLabel,ir)],[i.EventMethods.Visual.LegendFontItalicized,e=>lr(e,Aa.Intents.VisualLegendFontItalicizedLabel)],[i.EventMethods.Visual.LegendFontNamed,e=>lr(e,Aa.Intents.VisualLegendFontNamedLabel)],[i.EventMethods.Visual.LegendFontSized,e=>lr(e,Aa.Intents.VisualLegendFontSizedLabel)],[i.EventMethods.Visual.LegendFontUnderlined,e=>lr(e,Aa.Intents.VisualLegendFontUnderlinedLabel)],[i.EventMethods.Visual.LegendLineCleared,()=>Aa.Intents.VisualLegendLineClearedLabel],[i.EventMethods.Visual.LegendLineStyleChanged,()=>Aa.Intents.VisualLegendLineStyleChangedLabel],[i.EventMethods.Visual.LegendLineWeightChanged,()=>Aa.Intents.VisualLegendLineWeightChangedLabel],[i.EventMethods.Visual.LegendLineColored,e=>lr(e,Aa.Intents.VisualLegendLineColoredLabel,ir)],[i.EventMethods.Visual.LegendOverlayChanged,e=>lr(e,Aa.Intents.VisualLegendOverlayChangedLabel)],[i.EventMethods.Visual.LegendPositionChanged,e=>lr(e,Aa.Intents.VisualLegendOverlayChangedLabel)],[i.EventMethods.Visual.SeriesBinningOptionsBinCount,e=>lr(e,Aa.Intents.VisualSeriesBinningOptionsBinCountLabel)],[i.EventMethods.Visual.SeriesBinningOptionsBinWidth,e=>lr(e,Aa.Intents.VisualSeriesBinningOptionsBinWidthLabel)],[i.EventMethods.Visual.SeriesBinningOptionsBinningType,e=>lr(e,Aa.Intents.VisualSeriesBinningOptionsBinningTypeLabel)],[i.EventMethods.Visual.SeriesBinningOptionsOverflowEnabled,e=>lr(e,Aa.Intents.VisualSeriesBinningOptionsOverflowEnabledLabel)],[i.EventMethods.Visual.SeriesBinningOptionsOverflowValue,e=>lr(e,Aa.Intents.VisualSeriesBinningOptionsOverflowValueLabel)],[i.EventMethods.Visual.SeriesBinningOptionsUnderflowEnabled,e=>lr(e,Aa.Intents.VisualSeriesBinningOptionsUnderflowEnabledLabel)],[i.EventMethods.Visual.SeriesBinningOptionsUnderflowValue,e=>lr(e,Aa.Intents.VisualSeriesBinningOptionsUnderflowValueLabel)],[i.EventMethods.Visual.SeriesBoxWhiskerQuartileCalculation,e=>lr(e,Aa.Intents.VisualSeriesBoxWhiskerQuartileCalculationLabel)],[i.EventMethods.Visual.SeriesBoxWhiskerShowInnerPoints,e=>lr(e,Aa.Intents.VisualSeriesBoxWhiskerShowInnerPointsLabel)],[i.EventMethods.Visual.SeriesBoxWhiskerShowMeanLine,e=>lr(e,Aa.Intents.VisualSeriesBoxWhiskerShowMeanLineLabel)],[i.EventMethods.Visual.SeriesBoxWhiskerShowMeanMarker,e=>lr(e,Aa.Intents.VisualSeriesBoxWhiskerShowMeanMarkerLabel)],[i.EventMethods.Visual.SeriesBoxWhiskerShowOutliers,e=>lr(e,Aa.Intents.VisualSeriesBoxWhiskerShowOutliersLabel)],[i.EventMethods.Visual.SeriesBubbleScaleSized,e=>lr(e,Aa.Intents.VisualSeriesBubbleScaleSizedLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsCategoryNameToggled,e=>lr(e,Aa.Intents.VisualSeriesDataLabelsContainsCategoryNameToggledLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsCustomSeparatorChanged,e=>lr(e,Aa.Intents.VisualSeriesDataLabelsContainsCustomSeparatorChangedLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsLegendKeyToggled,e=>lr(e,Aa.Intents.VisualSeriesDataLabelsContainsLegendKeyToggledLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsSeparatorChanged,e=>lr(e,Aa.Intents.VisualSeriesDataLabelsContainsSeparatorChangedLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsSeriesNameToggled,e=>lr(e,Aa.Intents.VisualSeriesDataLabelsContainsSeriesNameToggledLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsValueToggled,e=>lr(e,Aa.Intents.VisualSeriesDataLabelsContainsValueToggledLabel)],[i.EventMethods.Visual.SeriesDataLabelsFillFormatColored,e=>lr(e,Aa.Intents.VisualSeriesDataLabelsFillFormatColoredLabel)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatBolded,e=>lr(e,Aa.Intents.VisualSeriesDataLabelsFontFormatBoldedLabel)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatColored,e=>lr(e,Aa.Intents.VisualSeriesDataLabelsFontFormatColoredLabel,ir)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatItalicized,e=>lr(e,Aa.Intents.VisualSeriesDataLabelsFontFormatItaliizedcLabel)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatNamed,e=>lr(e,Aa.Intents.VisualSeriesDataLabelsFontFormatNamedLabel)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatSized,e=>lr(e,Aa.Intents.VisualSeriesDataLabelsFontFormatSizedLabel)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatUnderlined,e=>lr(e,Aa.Intents.VisualSeriesDataLabelsFontFormatUnderlinedLabel)],[i.EventMethods.Visual.SeriesDataLabelsLineFormatColored,e=>lr(e,Aa.Intents.VisualSeriesDataLabelsLineFormatColoredLabel,ir)],[i.EventMethods.Visual.SeriesDataLabelsNumberFormatCodeChanged,e=>lr(e,Aa.Intents.VisualSeriesDataLabelsNumberFormatCodeChangedLabel)],[i.EventMethods.Visual.SeriesDataLabelsPositioned,e=>lr(e,Aa.Intents.VisualSeriesDataLabelsPositionedLabel)],[i.EventMethods.Visual.SeriesDoughnutHoleSized,e=>lr(e,Aa.Intents.VisualSeriesDoughnutHoleSizedLabel)],[i.EventMethods.Visual.SeriesFillColored,e=>lr(e,Aa.Intents.VisualSeriesFillColoredLabel,ir)],[i.EventMethods.Visual.SeriesGapWidthChanged,e=>lr(e,Aa.Intents.VisualSeriesGapWidthChangedLabel)],[i.EventMethods.Visual.SeriesLineColored,e=>lr(e,Aa.Intents.VisualSeriesLineColoredLabel,ir)],[i.EventMethods.Visual.SeriesMarkersFillColored,e=>lr(e,Aa.Intents.VisualSeriesMakersFillColoredLabel,ir)],[i.EventMethods.Visual.SeriesMarkersLineColored,e=>lr(e,Aa.Intents.VisualSeriesMakersLineColoredLabel,ir)],[i.EventMethods.Visual.SeriesMarkersMarkerSized,e=>lr(e,Aa.Intents.VisualSeriesMakersMarkerSizedLabel)],[i.EventMethods.Visual.SeriesMarkersMarkerStyleChanged,e=>lr(e,Aa.Intents.VisualSeriesMakersMarkerStyleChangedLabel)],[i.EventMethods.Visual.SeriesNamed,e=>lr(e,Aa.Intents.VisualSeriesNamedLabel)],[i.EventMethods.Visual.SeriesTreemapParentLabelStrategy,e=>lr(e,Aa.Intents.VisualSeriesTreemapParentLabelStrategyLabel)],[i.EventMethods.Visual.SeriesVaryColorsBySliceChanged,e=>lr(e,Aa.Intents.VisualSeriesVaryColorsBySliceChangedLabel)],[i.EventMethods.Visual.SeriesVaryColorsBySliceChanged,e=>lr(e,Aa.Intents.VisualSeriesVaryColorsBySliceChangedLabel)],[i.EventMethods.Visual.SeriesWaterfallShowConnectorLines,e=>lr(e,Aa.Intents.VisualSeriesWaterfallShowConnectorLinesLabel)],[i.EventMethods.Visual.SeriesTrendlineTypeSet,e=>lr(e,Aa.Intents.VisualSeriesTrendlineTypeSetLabel)],[i.EventMethods.Visual.SeriesTrendlineNameSet,e=>lr(e,Aa.Intents.VisualSeriesTrendlineNameChangedLabel)],[i.EventMethods.Visual.SeriesTrendlineEquationDisplayed,e=>lr(e,Aa.Intents.VisualSeriesTrendlineEquationDisplayedLabel)],[i.EventMethods.Visual.SeriesTrendlineRSquaredDisplayed,e=>lr(e,Aa.Intents.VisualSeriesTrendlineRSquaredDisplayedLabel)],[i.EventMethods.Visual.SeriesTrendlineInterceptSet,e=>lr(e,Aa.Intents.VisualSeriesTrendlineInterceptSetLabel)],[i.EventMethods.Visual.SeriesTrendlineIsCustomInterceptSet,e=>function(e){return e.parameters.newValue?Aa.substitute(Aa.Intents.VisualSeriesTrendlineManualSetLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index}):Aa.substitute(Aa.Intents.VisualSeriesTrendlineAutomaticSetLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index})}(e)],[i.EventMethods.Visual.SeriesTrendlineLineFormatColored,e=>lr(e,Aa.Intents.VisualSeriesTrendlineLineFormatColoredLabel)],[i.EventMethods.Visual.SeriesTrendlineForecastForwardSet,e=>lr(e,Aa.Intents.VisualSeriesTrendlineForecastForwardSetLabel)],[i.EventMethods.Visual.SeriesTrendlineForecastBackwardSet,e=>lr(e,Aa.Intents.VisualSeriesTrendlineForecastBackwardSetLabel)],[i.EventMethods.Visual.ChartTitleAddedRemoved,e=>sr(e,e.parameters.added?Aa.Intents.VisualChartTitleAddedLabel:Aa.Intents.VisualChartTitleRemovedLabel)],[i.EventMethods.Visual.LegendAddedRemoved,e=>sr(e,e.parameters.added?Aa.Intents.VisualLegendAddedLabel:Aa.Intents.VisualLegendRemovedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleAddedRemoved,e=>sr(e,e.parameters.added?Aa.Intents.VisualChartAxisAxisTitleAddedLabel:Aa.Intents.VisualChartAxisAxisTitleRemovedLabel)],[i.EventMethods.Visual.ChartAxisGridlinesMajorGridlinesAddedRemoved,e=>sr(e,e.parameters.added?Aa.Intents.VisualChartAxisGridlinesMajorGridlinesAddedLabel:Aa.Intents.VisualChartAxisGridlinesMajorGridlinesRemovedLabel)],[i.EventMethods.Visual.ChartAxisGridlinesMinorGridlinesAddedRemoved,e=>sr(e,e.parameters.added?Aa.Intents.VisualChartAxisGridlinesMinorGridlinesAddedLabel:Aa.Intents.VisualChartAxisGridlinesMinorGridlinesRemovedLabel)],[i.EventMethods.Visual.SeriesErrorBarXAddedRemoved,e=>sr(e,e.parameters.added?Aa.Intents.VisualSeriesErrorBarXAddedLabel:Aa.Intents.VisualSeriesErrorBarXRemovedLabel)],[i.EventMethods.Visual.SeriesErrorBarYAddedRemoved,e=>sr(e,e.parameters.added?Aa.Intents.VisualSeriesErrorBarYAddedLabel:Aa.Intents.VisualSeriesErrorBarYRemovedLabel)],[i.EventMethods.Visual.SeriesTrendlineAddedRemoved,cr],[i.EventMethods.Visual.SeriesTrendlineTitleAddedRemoved,dr],[i.EventMethods.Visual.SeriesDataLabelsAddedRemoved,e=>sr(e,e.parameters.added?Aa.Intents.VisualSeriesDataLabelsAddedLabel:Aa.Intents.VisualSeriesDataLabelsRemovedLabel)],[i.EventMethods.Visual.ChartTitleFillCleared,()=>Aa.Intents.ChartTitleFillClearedLabel],[i.EventMethods.Visual.ChartTitleLineCleared,()=>Aa.Intents.ChartTitleLineClearedLabel],[i.EventMethods.Visual.ChartTitleLineStyleChanged,()=>Aa.Intents.ChartTitleLineStyleChangedLabel],[i.EventMethods.Visual.ChartTitleWeightChanged,()=>Aa.Intents.ChartTitleWeightChangedLabel],[i.EventMethods.Table.Created,Ja],[i.EventMethods.Table.ColumnInserted,Ya],[i.EventMethods.Table.ColumnsDeleted,Xa],[i.EventMethods.Table.ColumnRearranged,()=>Aa.Intents.TableColumnsRearrangeLabel],[i.EventMethods.Table.RowInserted,Za],[i.EventMethods.Table.RowsDeleted,Ka],[i.EventMethods.Table.FilterCleared,no],[i.EventMethods.Table.FilterReapplied,ao],[i.EventMethods.Table.ValuesFilterApplied,oo],[i.EventMethods.Table.CustomFilterApplied,ro],[i.EventMethods.Table.CustomSorted,io],[i.EventMethods.Table.SortCleared,lo],[i.EventMethods.Table.Top10FilterApplied,so],[i.EventMethods.Table.DynamicFilterApplied,co],[i.EventMethods.Table.ColumnSorted,eo],[i.EventMethods.Table.RowRearranged,()=>Aa.Intents.TableRowsRearrangeLabel],[i.EventMethods.Table.AutoFilterCleared,to],[i.EventMethods.Table.AutoFilterToggled,nr],[i.EventMethods.Table.TotalRowToggled,pr],[i.EventMethods.Table.HeaderRowToggled,br],[i.EventMethods.Table.Resized,fr],[i.EventMethods.Table.CreatedWithFormat,Cr],[i.EventMethods.Table.StyleApplied,Or],[i.EventMethods.Table.BandedColumnsVisibilityChanged,Br],[i.EventMethods.Table.BandedRowsVisibilityChanged,Dr],[i.EventMethods.Table.FirstColumnHighlighted,$r],[i.EventMethods.Table.LastColumnHighlighted,Hr],[i.EventMethods.Table.FilterButtonVisibilityChanged,Ur],[i.EventMethods.Table.Renamed,pi],[i.EventMethods.Table.Converted,bi],[i.EventMethods.Table.AltTextEdited,fi],[i.EventMethods.Table.AltTextTitleEdited,Ci],[i.EventMethods.Table.AltTextDescriptionEdited,yi],[i.EventMethods.PivotChart.Created,()=>Aa.Intents.PivotChartCreateLabel],[i.EventMethods.PivotChart.OnNewSheetCreated,()=>Aa.Intents.PivotChartCreateLabel],[i.EventMethods.Font.Bolded,uo],[i.EventMethods.Font.MultiRangeBolded,mo],[i.EventMethods.Font.Italicized,po],[i.EventMethods.Font.MultiRangeItalicized,e=>function(e){return e.parameters.events[0].parameters.value?Aa.Intents.MultiRangeFormatItalicizeLabel:Aa.Intents.MultiRangeFormatUnItalicizeLabel}(e)],[i.EventMethods.Font.Colored,bo],[i.EventMethods.Font.MultiRangeColored,fo],[i.EventMethods.Font.Named,Co],[i.EventMethods.Font.MultiRangeNamed,yo],[i.EventMethods.Font.Underlined,vo],[i.EventMethods.Font.MultiRangeUnderlined,e=>function(e){return e.parameters.events[0].parameters.value?Aa.Intents.MultiRangeFormatUnderlineLabel:Aa.Intents.MultiRangeFormatRemoveUnderlineLabel}(e)],[i.EventMethods.Font.DoubleUnderlined,To],[i.EventMethods.Font.MultiRangeDoubleUnderlined,e=>function(e){return e.parameters.events[0].parameters.value?Aa.Intents.MultiRangeFormatDoubleUnderlineLabel:Aa.Intents.MultiRangeFormatRemoveDoubleUnderlineLabel}(e)],[i.EventMethods.Font.Superscript,So],[i.EventMethods.Font.Subscript,wo],[i.EventMethods.Font.MultiRangeSuperscript,go],[i.EventMethods.Font.MultiRangeSubscript,ho],[i.EventMethods.Font.Superscript,So],[i.EventMethods.Font.MultiRangeSuperscript,go],[i.EventMethods.Font.StrikeThrough,xo],[i.EventMethods.Font.MultiRangeStrikeThrough,e=>function(e){return e.parameters.events[0].parameters.value?Aa.Intents.MultiRangeFormatStrikethroughLabel:Aa.Intents.MultiRangeFormatRemoveStrikethroughLabel}(e)],[i.EventMethods.Font.UnderlineStyle,Ro],[i.EventMethods.Font.Sized,Eo],[i.EventMethods.Font.MultiRangeSized,Io],[i.EventMethods.Fill.Colored,Ao],[i.EventMethods.Fill.MultiRangeColored,ko],[i.EventMethods.Fill.ColorCleared,Lo],[i.EventMethods.Fill.MultiRangeColorCleared,()=>Aa.Intents.MultiRangeClearBackgroundColorLabel],[i.EventMethods.Fill.Patterned,()=>Aa.Intents.RangeFillPatternAppliedLabel],[i.EventMethods.CellDimensions.ColumnWidthSet,Fo],[i.EventMethods.CellDimensions.MultiRangeColumnWidthSet,_o],[i.EventMethods.CellDimensions.RowHeightSet,Po],[i.EventMethods.CellDimensions.MultiRangeRowHeightSet,No],[i.EventMethods.CellDimensions.RowsHidden,Mi],[i.EventMethods.CellDimensions.MultiRangeRowsHidden,Di],[i.EventMethods.CellDimensions.ColumnsHidden,Oi],[i.EventMethods.CellDimensions.MultiRangeColumnsHidden,Bi],[i.EventMethods.Border.BorderChanged,Mo],[i.EventMethods.Border.MultiRangeBorderChanged,()=>Aa.Intents.MultiRangeApplyBorderLabel],[i.EventMethods.NamedSheetView.Created,()=>Aa.Intents.NamedSheetViewCreateLabel],[i.EventMethods.NamedSheetView.Deleted,Oo],[i.EventMethods.NamedSheetView.Duplicated,Do],[i.EventMethods.NamedSheetView.Exited,Bo],[i.EventMethods.NamedSheetView.Kept,$o],[i.EventMethods.NamedSheetView.Renamed,Ho],[i.EventMethods.NamedSheetView.Switched,Uo],[i.EventMethods.Paste.Range,qo],[i.EventMethods.Paste.MultiRange,Vo],[i.EventMethods.Paste.String,Wo],[i.EventMethods.Paste.ArtSameWorkbook,Pi],[i.EventMethods.Comment.Inserted,()=>Aa.Intents.CommentInsertLabel],[i.EventMethods.Comment.MultiRangeInserted,()=>Aa.Intents.CommentInsertLabel],[i.EventMethods.Comment.Edited,()=>Aa.Intents.CommentEditLabel],[i.EventMethods.Comment.MultiRangeEdited,()=>Aa.Intents.CommentEditLabel],[i.EventMethods.Comment.Deleted,()=>Aa.Intents.CommentDeleteLabel],[i.EventMethods.Comment.MultiRangeDeleted,()=>Aa.Intents.CommentDeleteLabel],[i.EventMethods.Reply.Inserted,()=>Aa.Intents.CommentInsertReplyLabel],[i.EventMethods.Reply.MultiRangeInserted,()=>Aa.Intents.CommentInsertReplyLabel],[i.EventMethods.Reply.Edited,()=>Aa.Intents.CommentEditReplyLabel],[i.EventMethods.Reply.MultiRangeEdited,()=>Aa.Intents.CommentEditReplyLabel],[i.EventMethods.Reply.Deleted,()=>Aa.Intents.CommentDeleteReplyLabel],[i.EventMethods.Reply.MultiRangeDeleted,()=>Aa.Intents.CommentDeleteReplyLabel],[i.EventMethods.Range.ReplacedAll,Jo],[i.EventMethods.Workbook.ReplacedAll,Jo],[i.EventMethods.Worksheet.ReplacedAll,Jo],[i.EventMethods.Range.MultiRangeReplacedAll,Yo],[i.EventMethods.Worksheet.MultiRangeReplacedAll,Yo],[i.EventMethods.Workbook.MultiRangeReplacedAll,Yo],[i.EventMethods.Range.FoundNext,jo],[i.EventMethods.Workbook.FoundNext,jo],[i.EventMethods.Workbook.CalculationModeSet,()=>Aa.Intents.WorkbookSetCalculationModeLabel],[i.EventMethods.Workbook.Recalculated,()=>Aa.Intents.WorkbookRecalculateLabel],[i.EventMethods.Alignment.HorizontalAlignmentSet,Xo],[i.EventMethods.Alignment.MultiRangeHorizontalAlignmentSet,()=>Aa.Intents.MultiRangeSetHorizontalAlignmentLabel],[i.EventMethods.Alignment.VerticalAlignmentSet,Zo],[i.EventMethods.Alignment.MultiRangeVerticalAlignmentSet,()=>Aa.Intents.MultiRangeSetVerticalAlignmentLabel],[i.EventMethods.CellText.WrapChanged,Ko],[i.EventMethods.CellText.MultiRangeWrapChanged,e=>function(e){return e.parameters.events[0].parameters.value?Aa.Intents.MultiRangeWrapTextLabel:Aa.Intents.MultiRangeUnwrapTextLabel}(e)],[i.EventMethods.Indent.Set,er],[i.EventMethods.Indent.Incremented,er],[i.EventMethods.Indent.MultiRangeSet,()=>Aa.Intents.MultiRangeChangeIndentLabel],[i.EventMethods.ConditionalFormatting.CreatedGroup,$i],[i.EventMethods.ConditionalFormatting.CellValueCreated,Ui],[i.EventMethods.ConditionalFormatting.CustomCreated,qi],[i.EventMethods.ConditionalFormatting.ColorScaleCustomCreated,Wi],[i.EventMethods.ConditionalFormatting.DataBarCustomCreated,Gi],[i.EventMethods.ConditionalFormatting.DatesCreated,ji],[i.EventMethods.ConditionalFormatting.IconSetCreated,zi],[i.EventMethods.ConditionalFormatting.PresetCreated,Qi],[i.EventMethods.ConditionalFormatting.TextComparisonCreated,Vi],[i.EventMethods.ConditionalFormatting.TopBottomCreated,Yi],[i.EventMethods.ConditionalFormatting.UniqueCreated,Ji],[i.EventMethods.ConditionalFormatting.EditedGroup,Xi],[i.EventMethods.ConditionalFormatting.Deleted,el],[i.EventMethods.ConditionalFormatting.RuleDeleted,Zi],[i.EventMethods.ConditionalFormatting.PriorityEdited,Ki],[i.EventMethods.Workbook.RefreshedAll,()=>Aa.Intents.WorkbookRefreshAllLabel],[i.EventMethods.Workbook.ExternalLinksRefreshed,()=>Aa.Intents.ExternalLinksRefreshedLabel],[i.EventMethods.Workbook.ExternalLinksRefreshedAll,()=>Aa.Intents.ExternalLinksRefreshedAllLabel],[i.EventMethods.Workbook.ExternalLinksBrokeLink,()=>Aa.Intents.ExternalLinksBrokeLinkLabel],[i.EventMethods.Workbook.ExternalLinksBrokeAllLinks,()=>Aa.Intents.ExternalLinksBrokeAllLinksLabel],[i.EventMethods.Workbook.ExternalLinksSetAutoRefresh,()=>Aa.Intents.ExternalLinksSetAutoRefreshLabel],[i.EventMethods.Workbook.ExternalLinksChangedSource,()=>Aa.Intents.ExternalLinksChangedSourceLabel],[i.EventMethods.PageLayout.AddedToPrintArea,()=>Aa.Intents.PageLayoutAddedToPrintAreaLabel],[i.EventMethods.PageLayout.OrientationChanged,()=>Aa.Intents.PageLayoutOrientationChangedLabel],[i.EventMethods.PageLayout.PageBreakInserted,()=>Aa.Intents.PageLayoutPageBreakInsertedLabel],[i.EventMethods.PageLayout.PageBreakRemoved,()=>Aa.Intents.PageLayoutPageBreakRemovedLabel],[i.EventMethods.PageLayout.PageBreaksAllReset,()=>Aa.Intents.PageLayoutPageBreaksAllResetLabel],[i.EventMethods.PageLayout.PaperSizeChanged,()=>Aa.Intents.PageLayoutPaperSizeChangedLabel],[i.EventMethods.PageLayout.PrintAreaCleared,()=>Aa.Intents.PageLayoutPrintAreaClearedLabel],[i.EventMethods.PageLayout.PrintAreaSet,()=>Aa.Intents.PageLayoutPrintAreaSetLabel],[i.EventMethods.PageLayout.PrintSettingsChanged,()=>Aa.Intents.PageLayoutPrintSettingsChangedLabel],[i.EventMethods.PageLayout.ScalingChanged,()=>Aa.Intents.PageLayoutScalingChangedLabel],[i.EventMethods.AllowEditRange.Added,il],[i.EventMethods.AllowEditRange.Deleted,ll],[i.EventMethods.AllowEditRange.Edited,sl],[i.EventMethods.SheetProtection.OptionsUpdated,cl],[i.EventMethods.SheetProtection.PasswordUpdated,dl],[i.EventMethods.SheetProtection.Paused,ul],[i.EventMethods.SheetProtection.Resumed,gl],[i.EventMethods.SheetProtection.Protected,ml],[i.EventMethods.SheetProtection.Unprotected,hl],[i.EventMethods.CellText.OrientationChanged,La],[i.EventMethods.CellText.MultiRangeOrientationChanged,()=>Aa.Intents.CellTextOrientationChangedGeneric],[i.EventMethods.Chart.Renamed,()=>Aa.Intents.ChartRenamed],[i.EventMethods.Comment.Resolved,()=>Aa.Intents.CommentResolved],[i.EventMethods.Table.Deleted,()=>Aa.Intents.TableDeleted],[i.EventMethods.Worksheet.Calculated,()=>Aa.Intents.WorksheetCalculated],[i.EventMethods.Intent.ChangeRangeBorder,()=>Aa.Intents.IntentChangeRangeBorder],[i.EventMethods.Intent.CreateConditionalFormatColorScale,()=>Aa.Intents.IntentCreateConditionalFormatColorScale],[i.EventMethods.Intent.CreateConditionalFormatDataBar,()=>Aa.Intents.IntentCreateConditionalFormatDataBar],[i.EventMethods.Intent.RangeCopyFrom,()=>Aa.Intents.IntentRangeCopyFrom],[i.EventMethods.Intent.CreateConditionalFormatCellValue,()=>Aa.Intents.IntentCreateConditionalFormatCellValue],[i.EventMethods.Intent.CreateConditionalFormatPreset,()=>Aa.Intents.IntentCreateConditionalFormatPreset],[i.EventMethods.Intent.CreateConditionalFormatContainsText,()=>Aa.Intents.IntentCreateConditionalFormatContainsText],[i.EventMethods.Intent.CreateConditionalFormatTopBottom,()=>Aa.Intents.IntentCreateConditionalFormatTopBottom],[i.EventMethods.Intent.CreateConditionalFormatCustom,()=>Aa.Intents.IntentCreateConditionalFormatCustom],[i.EventMethods.Intent.CreateConditionalFormatIconSet,()=>Aa.Intents.IntentCreateConditionalFormatIconSet],[i.EventMethods.System.Undo,()=>Aa.Intents.UndoLabel],[i.EventMethods.System.Redo,()=>Aa.Intents.RedoLabel],[i.EventMethods.System.Unknown,()=>Aa.Intents.UnknownEventLabel],[i.EventMethods.System.Unsupported,()=>Aa.Intents.UnsupportedEventLabel],[i.EventMethods.System.InProgress,()=>Aa.Intents.InProgressEventLabel],[i.EventMethods.System.Undefined,()=>Aa.Intents.UnknownEventLabel],[i.EventMethods.Error.Alias,()=>Aa.Intents.ErrorAliasInfo],[i.EventMethods.Error.Unknown,()=>Aa.Intents.ErrorUnknown],[i.EventMethods.Error.UpstreamExceptionOccured,()=>Aa.Intents.ErrorUnknown]]),yl=new Map([[i.EventMethods.Worksheet.Added,()=>ExcelCopilotCommandingHitlStrings.WorksheetAddLabel],[i.EventMethods.Worksheet.AddedWithName,k],[i.EventMethods.Worksheet.Deleted,()=>ExcelCopilotCommandingHitlStrings.WorksheetDeleteLabel],[i.EventMethods.Worksheet.MultiSheetDeleted,_],[i.EventMethods.Worksheet.Renamed,F],[i.EventMethods.Worksheet.Duplicated,We],[i.EventMethods.Worksheet.FilterReapplied,Ge],[i.EventMethods.Worksheet.AutoFilterCleared,ze],[i.EventMethods.Worksheet.Reordered,et],[i.EventMethods.Worksheet.AutoFilterToggled,nt],[i.EventMethods.Worksheet.GridlinesToggled,mt],[i.EventMethods.Worksheet.HeadingsToggled,ut],[i.EventMethods.Worksheet.TabColored,Ct],[i.EventMethods.Worksheet.PaneFrozen,Ut],[i.EventMethods.Worksheet.ColumnsFrozen,()=>ExcelCopilotCommandingHitlStrings.WorksheetFreezeColumnsLabel],[i.EventMethods.Worksheet.RowsFrozen,()=>ExcelCopilotCommandingHitlStrings.WorksheetFreezeRowsLabel],[i.EventMethods.Worksheet.OutlineLevelsShown,un],[i.EventMethods.Worksheet.ValuesFilterApplied,Ln],[i.EventMethods.Worksheet.CustomFilterApplied,kn],[i.EventMethods.Worksheet.DynamicFilterApplied,Fn],[i.EventMethods.Worksheet.VisibilityChanged,()=>ExcelCopilotCommandingHitlStrings.WorksheetVisibilityChangedLabel],[i.EventMethods.Worksheet.MoveToEdge,()=>ExcelCopilotCommandingHitlStrings.MoveToEdgeLabel],[i.EventMethods.Intent.CreateNamedItemOnWorkbook,()=>ExcelCopilotCommandingHitlStrings.CreateNamedItem],[i.EventMethods.Intent.CreateNamedItemOnWorksheet,()=>ExcelCopilotCommandingHitlStrings.CreateNamedItem],[i.EventMethods.Intent.SetNamedItemOnWorkbook,()=>ExcelCopilotCommandingHitlStrings.SetNamedItem],[i.EventMethods.Intent.SetNamedItemOnWorksheet,()=>ExcelCopilotCommandingHitlStrings.SetNamedItem],[i.EventMethods.Intent.DeleteNamedItemOnWorkbook,()=>ExcelCopilotCommandingHitlStrings.DeleteNamedItem],[i.EventMethods.Intent.RangeSetIndent,()=>ExcelCopilotCommandingHitlStrings.ChangeRangeIndent],[i.EventMethods.Intent.RangeAdjustIndent,()=>ExcelCopilotCommandingHitlStrings.ChangeRangeIndent],[i.EventMethods.Range.Edited,P],[i.EventMethods.Range.SingleValueEdited,N],[i.EventMethods.Range.MultiRangeEdited,()=>ExcelCopilotCommandingHitlStrings.MultiRangeEditLabel],[i.EventMethods.Range.MultiRangeDeleted,()=>ExcelCopilotCommandingHitlStrings.MultiRangeDeleteLabel],[i.EventMethods.Range.MultiRangeDeleted,()=>ExcelCopilotCommandingHitlStrings.MultiRangeDeleteLabel],[i.EventMethods.Range.Cleared,M],[i.EventMethods.Range.MultiRangeCleared,()=>ExcelCopilotCommandingHitlStrings.MultiRangeClearLabel],[i.EventMethods.Range.Deleted,O],[i.EventMethods.Range.Inserted,D],[i.EventMethods.Range.Merged,B],[i.EventMethods.Range.MultiRangeMerged,()=>ExcelCopilotCommandingHitlStrings.MultiRangeMergeLabel],[i.EventMethods.Range.MultiRangeInserted,()=>ExcelCopilotCommandingHitlStrings.MultipleRangeInsertLabel],[i.EventMethods.Range.Unmerged,$],[i.EventMethods.Range.MultiRangeUnmerged,()=>ExcelCopilotCommandingHitlStrings.MultiRangeUnmergeLabel],[i.EventMethods.Range.ColumnsAutoFit,H],[i.EventMethods.Range.MultiRangeColumnsAutoFit,H],[i.EventMethods.Range.RowsAutoFit,U],[i.EventMethods.Range.UseStandardHeight,q],[i.EventMethods.Range.UseStandardWidth,V],[i.EventMethods.Range.MultiRangeRowsAutoFit,U],[i.EventMethods.Range.HyperlinkApplied,W],[i.EventMethods.Range.HyperlinkRemoved,G],[i.EventMethods.Range.MultiRangeHyperlinkRemoved,()=>ExcelCopilotCommandingHitlStrings.MultiRangeRemoveHyperlinkLabel],[i.EventMethods.Range.NumberFormatChanged,z],[i.EventMethods.Range.MultiRangeNumberFormatChanged,()=>ExcelCopilotCommandingHitlStrings.MultiRangeNumberFormatLabel],[i.EventMethods.Range.InsertCopiedCutCells,Q],[i.EventMethods.Range.InsertCopiedCutCellsInTable,e=>function(e){const t=e.parameters.destinationTableRange.subRangeValues;return 0===e.parameters.copyCutOperation?A.substitute(ExcelCopilotCommandingHitlStrings.RangePasteCopyInTableLabel,{tableName:e.entityId,rowIndex:t.firstIndex}):A.substitute(ExcelCopilotCommandingHitlStrings.RangePasteCutInTableLabel,{tableName:e.entityId,rowIndex:t.firstIndex})}(e)],[i.EventMethods.Range.Filled,j],[i.EventMethods.Range.DuplicatesRemoved,gt],[i.EventMethods.Range.FlashFilled,xt],[i.EventMethods.Range.Grouped,cn],[i.EventMethods.Range.Ungrouped,dn],[i.EventMethods.Range.GroupDetailsShown,mn],[i.EventMethods.Range.GroupDetailsHidden,gn],[i.EventMethods.Range.Sorted,_n],[i.EventMethods.Range.DataValidationChangedGroup,hn],[i.EventMethods.Range.AutoSum,Nn],[i.EventMethods.Range.CellStyleApplied,aa],[i.EventMethods.Range.MultiRangeCellStyleApplied,()=>ExcelCopilotCommandingHitlStrings.MultiRangeCellStyleAppliedLabel],[i.EventMethods.Range.CustomSorted,ra],[i.EventMethods.Range.AutoFilterCustomSorted,ia],[i.EventMethods.Range.TextToColumns,la],[i.EventMethods.Range.FixedWidthTextToColumns,()=>ExcelCopilotCommandingHitlStrings.FixedWidthTextToColumns],[i.EventMethods.Intent.SetDataValidation,()=>ExcelCopilotCommandingHitlStrings.IntentSetDataValidation],[i.EventMethods.Shape.Inserted,qt],[i.EventMethods.Shape.StyleSet,Vt],[i.EventMethods.Shape.Deleted,Qt],[i.EventMethods.Shape.MovedAndResized,Jt],[i.EventMethods.Shape.ZOrderChanged,Yt],[i.EventMethods.Shape.Rotated,Xt],[i.EventMethods.Shape.AltTextApplied,Zt],[i.EventMethods.Shape.PictureInserted,oa],[i.EventMethods.Shape.TextChanged,Kt],[i.EventMethods.Shape.TextBolded,en],[i.EventMethods.Shape.TextItalicized,tn],[i.EventMethods.Shape.TextUnderlined,nn],[i.EventMethods.Shape.TextFontNameChanged,an],[i.EventMethods.Shape.TextFontSizeChanged,on],[i.EventMethods.Shape.TextFontColorChanged,rn],[i.EventMethods.Shape.TextHorizontallyAligned,ln],[i.EventMethods.Shape.TextVerticallyAligned,sn],[i.EventMethods.PivotTable.Created,()=>ExcelCopilotCommandingHitlStrings.PivotTableCreateLabel],[i.EventMethods.PivotTable.SortApplied,()=>ExcelCopilotCommandingHitlStrings.PivotTableSortLabel],[i.EventMethods.PivotTable.PivotPositionChanged,()=>ExcelCopilotCommandingHitlStrings.PivotTableChangePositionLabel],[i.EventMethods.PivotTable.CreatedOnNewSheet,()=>ExcelCopilotCommandingHitlStrings.PivotTableCreateLabel],[i.EventMethods.PivotTable.PivotRemoved,xn],[i.EventMethods.PivotTable.PivotAdded,Tn],[i.EventMethods.PivotTable.PivotAdded,Tn],[i.EventMethods.PivotTable.Pivoted,vn],[i.EventMethods.PivotTable.Refreshed,Sn],[i.EventMethods.PivotTable.PivotDrillToggled,wn],[i.EventMethods.PivotTable.Renamed,En],[i.EventMethods.PivotTable.RowGrandTotalShown,In],[i.EventMethods.PivotTable.ColumnGrandTotalShown,Rn],[i.EventMethods.PivotTable.AutoFitColumnWidthsOnRefreshToggled,e=>function(e){return A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableAutoFitColumnWidthsOnRefreshToggledLabel,{pivotName:e.parameters.pivotName,value:e.parameters.value})}(e)],[i.EventMethods.PivotTable.SubTotalsVisibilitySettingSet,e=>function(e){return A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableSubTotalsVisibilitySettingSetLabel,{pivotName:e.parameters.pivotName})}(e)],[i.EventMethods.PivotTable.LayoutTypeSet,An],[i.EventMethods.Slicer.Inserted,at],[i.EventMethods.Chart.Created,ot],[i.EventMethods.Chart.MultiRangeCreated,dt],[i.EventMethods.Chart.RowColumnSwitched,yt],[i.EventMethods.Chart.DataSelected,vt],[i.EventMethods.Chart.TypeChanged,Tt],[i.EventMethods.Chart.TitleChanged,St],[i.EventMethods.Chart.TitleTextChanged,Lt],[i.EventMethods.Chart.TitleHidden,wt],[i.EventMethods.Chart.AxisTitleChanged,Et],[i.EventMethods.Chart.AxisTitleHidden,It],[i.EventMethods.Chart.AxisTitleTextChanged,At],[i.EventMethods.Chart.AxisTitleHorizontal,()=>ExcelCopilotCommandingHitlStrings.ChartAxisTitleHorizontal],[i.EventMethods.Chart.AxisTitleVertical,()=>ExcelCopilotCommandingHitlStrings.ChartAxisTitleVertical],[i.EventMethods.Chart.LegendChanged,Rt],[i.EventMethods.Chart.LegendHidden,kt],[i.EventMethods.Chart.DataLabelPositionChanged,Ft],[i.EventMethods.Chart.DataLabelVisibilityChanged,_t],[i.EventMethods.Chart.GridlinesVisibilityChanged,e=>function(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartChangeGridlineVisiblityLabel,{chartName:e.parameters.events[0].parameters.chartName,sheet:e.entityId})}(e)],[i.EventMethods.Chart.AxisChanged,Pt],[i.EventMethods.Chart.AxisVisiblityChanged,Nt],[i.EventMethods.Chart.Deleted,Wt],[i.EventMethods.Chart.MovedAndResized,jt],[i.EventMethods.Chart.SeriesDeleted,Gt],[i.EventMethods.Chart.SeriesDataChanged,zt],[i.EventMethods.ChartFormat.SetGetProperties,e=>function(e){return A.substitute(ExcelCopilotCommandingHitlStrings.ChartFormatSetGetPropertiesLabel,{count:e.parameters.events.length,chartName:e.parameters.events[0].parameters.chartName})}(e)],[i.EventMethods.Visual.ChartAxisAxisTitleFillColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisAxisTitleFillColoredLabel,rt)],[i.EventMethods.Visual.ChartAxisAxisTitleFontBolded,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisAxisTitleFontBoldedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleFontColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisAxisTitleFontColoredLabel,rt)],[i.EventMethods.Visual.ChartAxisAxisTitleFontItalicized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisAxisTitleFontItalicizedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleFontNamed,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisAxisTitleFontNamedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleFontSized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisAxisTitleFontSizedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleFontUnderlined,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisAxisTitleFontUnderlinedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleLineColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisAxisTitleLineColoredLabel,rt)],[i.EventMethods.Visual.ChartAxisAxisTitleTextChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisAxisTitleTextChangedLabel)],[i.EventMethods.Visual.ChartAxisBoundsMaxChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisBoundsMaxChangedLabel)],[i.EventMethods.Visual.ChartAxisBoundsMinChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisBoundsMinChangedLabel)],[i.EventMethods.Visual.ChartAxisCrossesAtChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisCrossesAtChangedLabel)],[i.EventMethods.Visual.ChartAxisCrossesChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisCrossesChangedLabel)],[i.EventMethods.Visual.ChartAxisFillColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisFillColoredLabel,rt)],[i.EventMethods.Visual.ChartAxisFontBolded,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisFontBoldedLabel)],[i.EventMethods.Visual.ChartAxisFontColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisFontColoredLabel,rt)],[i.EventMethods.Visual.ChartAxisFontItalicized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisFontItalicizedLabel)],[i.EventMethods.Visual.ChartAxisFontNamed,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisFontNamedLabel)],[i.EventMethods.Visual.ChartAxisFontSized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisFontSizedLabel)],[i.EventMethods.Visual.ChartAxisFontUnderlined,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisFontUnderlinedLabel)],[i.EventMethods.Visual.ChartAxisGridlinesMajorGridlinesLineColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisMajorGridlinesLineColoredLabel,rt)],[i.EventMethods.Visual.ChartAxisGridlinesMinorGridlinesLineColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisMinorGridlinesLineColoredLabel,rt)],[i.EventMethods.Visual.ChartAxisLineColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisLineColoredLabel,rt)],[i.EventMethods.Visual.ChartAxisNumberFormatCodeChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisNumberFormatCodeChangedLabel)],[i.EventMethods.Visual.ChartAxisReversePlotOrderChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisReversePlotOrderChangedLabel)],[i.EventMethods.Visual.ChartAxisTickMarksMajorTypeChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisTickMarksMajorTypeChangedLabel)],[i.EventMethods.Visual.ChartAxisTickMarksMinorTypeChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisTickMarksMinorTypeChangedLabel)],[i.EventMethods.Visual.ChartAxisUnitsMajorUnitChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisUnitsMajorUnitChangedLabel)],[i.EventMethods.Visual.ChartAxisUnitsMinorUnitChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisUnitsMinorUnitChangedLabel)],[i.EventMethods.Visual.ChartTitleFillColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartTitleFillColoredLabel,rt)],[i.EventMethods.Visual.ChartTitleFontBolded,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartTitleFontBoldedLabel)],[i.EventMethods.Visual.ChartTitleFontColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartTitleFontColoredLabel,rt)],[i.EventMethods.Visual.ChartTitleFontItalicized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartTitleFontItalicizedLabel)],[i.EventMethods.Visual.ChartTitleFontNamed,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartTitleFontNamedLabel)],[i.EventMethods.Visual.ChartTitleFontSized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartTitleFontSizedLabel)],[i.EventMethods.Visual.ChartTitleFontUnderlined,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartTitleFontUnderlinedLabel)],[i.EventMethods.Visual.ChartTitleLineColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartTitleLineColoredLabel,rt)],[i.EventMethods.Visual.ChartTitleOverlayChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartTitleOverlayChangedLabel)],[i.EventMethods.Visual.ChartTitleTextChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartTitleTextChangedLabel)],[i.EventMethods.Visual.LegendFillCleared,()=>ExcelCopilotCommandingHitlStrings.VisualLegendFillClearedLabel],[i.EventMethods.Visual.LegendFillColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualLegendFillColoredLabel,rt)],[i.EventMethods.Visual.LegendFontBolded,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualLegendFontBoldedLabel)],[i.EventMethods.Visual.LegendFontColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualLegendFontColoredLabel,rt)],[i.EventMethods.Visual.LegendFontItalicized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualLegendFontItalicizedLabel)],[i.EventMethods.Visual.LegendFontNamed,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualLegendFontNamedLabel)],[i.EventMethods.Visual.LegendFontSized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualLegendFontSizedLabel)],[i.EventMethods.Visual.LegendFontUnderlined,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualLegendFontUnderlinedLabel)],[i.EventMethods.Visual.LegendLineCleared,()=>ExcelCopilotCommandingHitlStrings.VisualLegendLineClearedLabel],[i.EventMethods.Visual.LegendLineStyleChanged,()=>ExcelCopilotCommandingHitlStrings.VisualLegendLineStyleChangedLabel],[i.EventMethods.Visual.LegendLineWeightChanged,()=>ExcelCopilotCommandingHitlStrings.VisualLegendLineWeightChangedLabel],[i.EventMethods.Visual.LegendLineColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualLegendLineColoredLabel,rt)],[i.EventMethods.Visual.LegendOverlayChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualLegendOverlayChangedLabel)],[i.EventMethods.Visual.LegendPositionChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualLegendOverlayChangedLabel)],[i.EventMethods.Visual.SeriesBinningOptionsBinCount,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBinningOptionsBinCountLabel)],[i.EventMethods.Visual.SeriesBinningOptionsBinWidth,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBinningOptionsBinWidthLabel)],[i.EventMethods.Visual.SeriesBinningOptionsBinningType,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBinningOptionsBinningTypeLabel)],[i.EventMethods.Visual.SeriesBinningOptionsOverflowEnabled,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBinningOptionsOverflowEnabledLabel)],[i.EventMethods.Visual.SeriesBinningOptionsOverflowValue,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBinningOptionsOverflowValueLabel)],[i.EventMethods.Visual.SeriesBinningOptionsUnderflowEnabled,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBinningOptionsUnderflowEnabledLabel)],[i.EventMethods.Visual.SeriesBinningOptionsUnderflowValue,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBinningOptionsUnderflowValueLabel)],[i.EventMethods.Visual.SeriesBoxWhiskerQuartileCalculation,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBoxWhiskerQuartileCalculationLabel)],[i.EventMethods.Visual.SeriesBoxWhiskerShowInnerPoints,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBoxWhiskerShowInnerPointsLabel)],[i.EventMethods.Visual.SeriesBoxWhiskerShowMeanLine,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBoxWhiskerShowMeanLineLabel)],[i.EventMethods.Visual.SeriesBoxWhiskerShowMeanMarker,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBoxWhiskerShowMeanMarkerLabel)],[i.EventMethods.Visual.SeriesBoxWhiskerShowOutliers,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBoxWhiskerShowOutliersLabel)],[i.EventMethods.Visual.SeriesBubbleScaleSized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBubbleScaleSizedLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsCategoryNameToggled,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsContainsCategoryNameToggledLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsCustomSeparatorChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsContainsCustomSeparatorChangedLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsLegendKeyToggled,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsContainsLegendKeyToggledLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsSeparatorChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsContainsSeparatorChangedLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsSeriesNameToggled,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsContainsSeriesNameToggledLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsValueToggled,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsContainsValueToggledLabel)],[i.EventMethods.Visual.SeriesDataLabelsFillFormatColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsFillFormatColoredLabel)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatBolded,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsFontFormatBoldedLabel)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsFontFormatColoredLabel,rt)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatItalicized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsFontFormatItaliizedcLabel)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatNamed,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsFontFormatNamedLabel)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatSized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsFontFormatSizedLabel)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatUnderlined,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsFontFormatUnderlinedLabel)],[i.EventMethods.Visual.SeriesDataLabelsLineFormatColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsLineFormatColoredLabel,rt)],[i.EventMethods.Visual.SeriesDataLabelsNumberFormatCodeChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsNumberFormatCodeChangedLabel)],[i.EventMethods.Visual.SeriesDataLabelsPositioned,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsPositionedLabel)],[i.EventMethods.Visual.SeriesDoughnutHoleSized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDoughnutHoleSizedLabel)],[i.EventMethods.Visual.SeriesFillColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesFillColoredLabel,rt)],[i.EventMethods.Visual.SeriesGapWidthChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesGapWidthChangedLabel)],[i.EventMethods.Visual.SeriesLineColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesLineColoredLabel,rt)],[i.EventMethods.Visual.SeriesMarkersFillColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesMakersFillColoredLabel,rt)],[i.EventMethods.Visual.SeriesMarkersLineColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesMakersLineColoredLabel,rt)],[i.EventMethods.Visual.SeriesMarkersMarkerSized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesMakersMarkerSizedLabel)],[i.EventMethods.Visual.SeriesMarkersMarkerStyleChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesMakersMarkerStyleChangedLabel)],[i.EventMethods.Visual.SeriesNamed,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesNamedLabel)],[i.EventMethods.Visual.SeriesTreemapParentLabelStrategy,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesTreemapParentLabelStrategyLabel)],[i.EventMethods.Visual.SeriesVaryColorsBySliceChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesVaryColorsBySliceChangedLabel)],[i.EventMethods.Visual.SeriesVaryColorsBySliceChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesVaryColorsBySliceChangedLabel)],[i.EventMethods.Visual.SeriesWaterfallShowConnectorLines,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesWaterfallShowConnectorLinesLabel)],[i.EventMethods.Visual.SeriesTrendlineTypeSet,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineTypeSetLabel)],[i.EventMethods.Visual.SeriesTrendlineNameSet,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineNameChangedLabel)],[i.EventMethods.Visual.SeriesTrendlineEquationDisplayed,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineEquationDisplayedLabel)],[i.EventMethods.Visual.SeriesTrendlineRSquaredDisplayed,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineRSquaredDisplayedLabel)],[i.EventMethods.Visual.SeriesTrendlineInterceptSet,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineInterceptSetLabel)],[i.EventMethods.Visual.SeriesTrendlineIsCustomInterceptSet,e=>function(e){return e.parameters.newValue?A.substitute(ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineManualSetLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index}):A.substitute(ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineAutomaticSetLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index})}(e)],[i.EventMethods.Visual.SeriesTrendlineLineFormatColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineLineFormatColoredLabel)],[i.EventMethods.Visual.SeriesTrendlineForecastForwardSet,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineForecastForwardSetLabel)],[i.EventMethods.Visual.SeriesTrendlineForecastBackwardSet,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineForecastBackwardSetLabel)],[i.EventMethods.Visual.ChartTitleAddedRemoved,e=>lt(e,e.parameters.added?ExcelCopilotCommandingHitlStrings.VisualChartTitleAddedLabel:ExcelCopilotCommandingHitlStrings.VisualChartTitleRemovedLabel)],[i.EventMethods.Visual.LegendAddedRemoved,e=>lt(e,e.parameters.added?ExcelCopilotCommandingHitlStrings.VisualLegendAddedLabel:ExcelCopilotCommandingHitlStrings.VisualLegendRemovedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleAddedRemoved,e=>lt(e,e.parameters.added?ExcelCopilotCommandingHitlStrings.VisualChartAxisAxisTitleAddedLabel:ExcelCopilotCommandingHitlStrings.VisualChartAxisAxisTitleRemovedLabel)],[i.EventMethods.Visual.ChartAxisGridlinesMajorGridlinesAddedRemoved,e=>lt(e,e.parameters.added?ExcelCopilotCommandingHitlStrings.VisualChartAxisGridlinesMajorGridlinesAddedLabel:ExcelCopilotCommandingHitlStrings.VisualChartAxisGridlinesMajorGridlinesRemovedLabel)],[i.EventMethods.Visual.ChartAxisGridlinesMinorGridlinesAddedRemoved,e=>lt(e,e.parameters.added?ExcelCopilotCommandingHitlStrings.VisualChartAxisGridlinesMinorGridlinesAddedLabel:ExcelCopilotCommandingHitlStrings.VisualChartAxisGridlinesMinorGridlinesRemovedLabel)],[i.EventMethods.Visual.SeriesErrorBarXAddedRemoved,e=>lt(e,e.parameters.added?ExcelCopilotCommandingHitlStrings.VisualSeriesErrorBarXAddedLabel:ExcelCopilotCommandingHitlStrings.VisualSeriesErrorBarXRemovedLabel)],[i.EventMethods.Visual.SeriesErrorBarYAddedRemoved,e=>lt(e,e.parameters.added?ExcelCopilotCommandingHitlStrings.VisualSeriesErrorBarYAddedLabel:ExcelCopilotCommandingHitlStrings.VisualSeriesErrorBarYRemovedLabel)],[i.EventMethods.Visual.SeriesTrendlineAddedRemoved,st],[i.EventMethods.Visual.SeriesTrendlineTitleAddedRemoved,ct],[i.EventMethods.Visual.SeriesDataLabelsAddedRemoved,e=>lt(e,e.parameters.added?ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsAddedLabel:ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsRemovedLabel)],[i.EventMethods.Visual.ChartTitleFillCleared,()=>ExcelCopilotCommandingHitlStrings.ChartTitleFillClearedLabel],[i.EventMethods.Visual.ChartTitleLineCleared,()=>ExcelCopilotCommandingHitlStrings.ChartTitleLineClearedLabel],[i.EventMethods.Visual.ChartTitleLineStyleChanged,()=>ExcelCopilotCommandingHitlStrings.ChartTitleLineStyleChangedLabel],[i.EventMethods.Visual.ChartTitleWeightChanged,()=>ExcelCopilotCommandingHitlStrings.ChartTitleWeightChangedLabel],[i.EventMethods.Table.Created,J],[i.EventMethods.Table.ColumnInserted,Y],[i.EventMethods.Table.ColumnsDeleted,X],[i.EventMethods.Table.ColumnRearranged,()=>ExcelCopilotCommandingHitlStrings.TableColumnsRearrangeLabel],[i.EventMethods.Table.RowInserted,Z],[i.EventMethods.Table.RowsDeleted,K],[i.EventMethods.Table.FilterCleared,ne],[i.EventMethods.Table.FilterReapplied,ae],[i.EventMethods.Table.ValuesFilterApplied,oe],[i.EventMethods.Table.CustomFilterApplied,re],[i.EventMethods.Table.CustomSorted,ie],[i.EventMethods.Table.SortCleared,le],[i.EventMethods.Table.Top10FilterApplied,se],[i.EventMethods.Table.DynamicFilterApplied,ce],[i.EventMethods.Table.ColumnSorted,ee],[i.EventMethods.Table.RowRearranged,()=>ExcelCopilotCommandingHitlStrings.TableRowsRearrangeLabel],[i.EventMethods.Table.AutoFilterCleared,te],[i.EventMethods.Table.AutoFilterToggled,tt],[i.EventMethods.Table.TotalRowToggled,ht],[i.EventMethods.Table.HeaderRowToggled,pt],[i.EventMethods.Table.Resized,bt],[i.EventMethods.Table.CreatedWithFormat,ft],[i.EventMethods.Table.StyleApplied,Mt],[i.EventMethods.Table.BandedColumnsVisibilityChanged,Dt],[i.EventMethods.Table.BandedRowsVisibilityChanged,Ot],[i.EventMethods.Table.FirstColumnHighlighted,Bt],[i.EventMethods.Table.LastColumnHighlighted,$t],[i.EventMethods.Table.FilterButtonVisibilityChanged,Ht],[i.EventMethods.Table.Renamed,pn],[i.EventMethods.Table.Converted,bn],[i.EventMethods.Table.AltTextEdited,fn],[i.EventMethods.Table.AltTextTitleEdited,Cn],[i.EventMethods.Table.AltTextDescriptionEdited,yn],[i.EventMethods.PivotChart.Created,()=>ExcelCopilotCommandingHitlStrings.PivotChartCreateLabel],[i.EventMethods.PivotChart.OnNewSheetCreated,()=>ExcelCopilotCommandingHitlStrings.PivotChartCreateLabel],[i.EventMethods.Font.Bolded,de],[i.EventMethods.Font.MultiRangeBolded,ue],[i.EventMethods.Font.Italicized,he],[i.EventMethods.Font.MultiRangeItalicized,e=>function(e){return e.parameters.events[0].parameters.value?ExcelCopilotCommandingHitlStrings.MultiRangeFormatItalicizeLabel:ExcelCopilotCommandingHitlStrings.MultiRangeFormatUnItalicizeLabel}(e)],[i.EventMethods.Font.Colored,pe],[i.EventMethods.Font.MultiRangeColored,be],[i.EventMethods.Font.Named,fe],[i.EventMethods.Font.MultiRangeNamed,Ce],[i.EventMethods.Font.Underlined,ye],[i.EventMethods.Font.MultiRangeUnderlined,e=>function(e){return e.parameters.events[0].parameters.value?ExcelCopilotCommandingHitlStrings.MultiRangeFormatUnderlineLabel:ExcelCopilotCommandingHitlStrings.MultiRangeFormatRemoveUnderlineLabel}(e)],[i.EventMethods.Font.DoubleUnderlined,ve],[i.EventMethods.Font.MultiRangeDoubleUnderlined,e=>function(e){return e.parameters.events[0].parameters.value?ExcelCopilotCommandingHitlStrings.MultiRangeFormatDoubleUnderlineLabel:ExcelCopilotCommandingHitlStrings.MultiRangeFormatRemoveDoubleUnderlineLabel}(e)],[i.EventMethods.Font.Superscript,xe],[i.EventMethods.Font.Subscript,Se],[i.EventMethods.Font.MultiRangeSuperscript,me],[i.EventMethods.Font.MultiRangeSubscript,ge],[i.EventMethods.Font.Superscript,xe],[i.EventMethods.Font.MultiRangeSuperscript,me],[i.EventMethods.Font.StrikeThrough,Te],[i.EventMethods.Font.MultiRangeStrikeThrough,e=>function(e){return e.parameters.events[0].parameters.value?ExcelCopilotCommandingHitlStrings.MultiRangeFormatStrikethroughLabel:ExcelCopilotCommandingHitlStrings.MultiRangeFormatRemoveStrikethroughLabel}(e)],[i.EventMethods.Font.UnderlineStyle,Ie],[i.EventMethods.Font.Sized,we],[i.EventMethods.Font.MultiRangeSized,Ee],[i.EventMethods.Fill.Colored,Re],[i.EventMethods.Fill.MultiRangeColored,Le],[i.EventMethods.Fill.ColorCleared,Ae],[i.EventMethods.Fill.MultiRangeColorCleared,()=>ExcelCopilotCommandingHitlStrings.MultiRangeClearBackgroundColorLabel],[i.EventMethods.Fill.Patterned,()=>ExcelCopilotCommandingHitlStrings.RangeFillPatternAppliedLabel],[i.EventMethods.CellDimensions.ColumnWidthSet,ke],[i.EventMethods.CellDimensions.MultiRangeColumnWidthSet,Fe],[i.EventMethods.CellDimensions.RowHeightSet,_e],[i.EventMethods.CellDimensions.MultiRangeRowHeightSet,Pe],[i.EventMethods.CellDimensions.RowsHidden,Mn],[i.EventMethods.CellDimensions.MultiRangeRowsHidden,Dn],[i.EventMethods.CellDimensions.ColumnsHidden,On],[i.EventMethods.CellDimensions.MultiRangeColumnsHidden,Bn],[i.EventMethods.Border.BorderChanged,Ne],[i.EventMethods.Border.MultiRangeBorderChanged,()=>ExcelCopilotCommandingHitlStrings.MultiRangeApplyBorderLabel],[i.EventMethods.NamedSheetView.Created,()=>ExcelCopilotCommandingHitlStrings.NamedSheetViewCreateLabel],[i.EventMethods.NamedSheetView.Deleted,Me],[i.EventMethods.NamedSheetView.Duplicated,Oe],[i.EventMethods.NamedSheetView.Exited,De],[i.EventMethods.NamedSheetView.Kept,Be],[i.EventMethods.NamedSheetView.Renamed,$e],[i.EventMethods.NamedSheetView.Switched,He],[i.EventMethods.Paste.Range,Ue],[i.EventMethods.Paste.MultiRange,qe],[i.EventMethods.Paste.String,Ve],[i.EventMethods.Paste.ArtSameWorkbook,Pn],[i.EventMethods.Comment.Inserted,()=>ExcelCopilotCommandingHitlStrings.CommentInsertLabel],[i.EventMethods.Comment.MultiRangeInserted,()=>ExcelCopilotCommandingHitlStrings.CommentInsertLabel],[i.EventMethods.Comment.Edited,()=>ExcelCopilotCommandingHitlStrings.CommentEditLabel],[i.EventMethods.Comment.MultiRangeEdited,()=>ExcelCopilotCommandingHitlStrings.CommentEditLabel],[i.EventMethods.Comment.Deleted,()=>ExcelCopilotCommandingHitlStrings.CommentDeleteLabel],[i.EventMethods.Comment.MultiRangeDeleted,()=>ExcelCopilotCommandingHitlStrings.CommentDeleteLabel],[i.EventMethods.Reply.Inserted,()=>ExcelCopilotCommandingHitlStrings.CommentInsertReplyLabel],[i.EventMethods.Reply.MultiRangeInserted,()=>ExcelCopilotCommandingHitlStrings.CommentInsertReplyLabel],[i.EventMethods.Reply.Edited,()=>ExcelCopilotCommandingHitlStrings.CommentEditReplyLabel],[i.EventMethods.Reply.MultiRangeEdited,()=>ExcelCopilotCommandingHitlStrings.CommentEditReplyLabel],[i.EventMethods.Reply.Deleted,()=>ExcelCopilotCommandingHitlStrings.CommentDeleteReplyLabel],[i.EventMethods.Reply.MultiRangeDeleted,()=>ExcelCopilotCommandingHitlStrings.CommentDeleteReplyLabel],[i.EventMethods.Range.ReplacedAll,je],[i.EventMethods.Workbook.ReplacedAll,je],[i.EventMethods.Worksheet.ReplacedAll,je],[i.EventMethods.Range.MultiRangeReplacedAll,Je],[i.EventMethods.Worksheet.MultiRangeReplacedAll,Je],[i.EventMethods.Workbook.MultiRangeReplacedAll,Je],[i.EventMethods.Range.FoundNext,Qe],[i.EventMethods.Workbook.FoundNext,Qe],[i.EventMethods.Workbook.CalculationModeSet,()=>ExcelCopilotCommandingHitlStrings.WorkbookSetCalculationModeLabel],[i.EventMethods.Workbook.Recalculated,()=>ExcelCopilotCommandingHitlStrings.WorkbookRecalculateLabel],[i.EventMethods.Alignment.HorizontalAlignmentSet,Ye],[i.EventMethods.Alignment.MultiRangeHorizontalAlignmentSet,()=>ExcelCopilotCommandingHitlStrings.MultiRangeSetHorizontalAlignmentLabel],[i.EventMethods.Alignment.VerticalAlignmentSet,Xe],[i.EventMethods.Alignment.MultiRangeVerticalAlignmentSet,()=>ExcelCopilotCommandingHitlStrings.MultiRangeSetVerticalAlignmentLabel],[i.EventMethods.CellText.WrapChanged,Ze],[i.EventMethods.CellText.MultiRangeWrapChanged,e=>function(e){return e.parameters.events[0].parameters.value?ExcelCopilotCommandingHitlStrings.MultiRangeWrapTextLabel:ExcelCopilotCommandingHitlStrings.MultiRangeUnwrapTextLabel}(e)],[i.EventMethods.Indent.Set,Ke],[i.EventMethods.Indent.Incremented,Ke],[i.EventMethods.Indent.MultiRangeSet,()=>ExcelCopilotCommandingHitlStrings.MultiRangeChangeIndentLabel],[i.EventMethods.ConditionalFormatting.CreatedGroup,$n],[i.EventMethods.ConditionalFormatting.EditedGroup,Kn],[i.EventMethods.ConditionalFormatting.Deleted,na],[i.EventMethods.ConditionalFormatting.RuleDeleted,ea],[i.EventMethods.Workbook.RefreshedAll,()=>ExcelCopilotCommandingHitlStrings.WorkbookRefreshAllLabel],[i.EventMethods.Workbook.ExternalLinksRefreshed,()=>ExcelCopilotCommandingHitlStrings.ExternalLinksRefreshedLabel],[i.EventMethods.Workbook.ExternalLinksRefreshedAll,()=>ExcelCopilotCommandingHitlStrings.ExternalLinksRefreshedAllLabel],[i.EventMethods.Workbook.ExternalLinksBrokeLink,()=>ExcelCopilotCommandingHitlStrings.ExternalLinksBrokeLinkLabel],[i.EventMethods.Workbook.ExternalLinksBrokeAllLinks,()=>ExcelCopilotCommandingHitlStrings.ExternalLinksBrokeAllLinksLabel],[i.EventMethods.Workbook.ExternalLinksSetAutoRefresh,()=>ExcelCopilotCommandingHitlStrings.ExternalLinksSetAutoRefreshLabel],[i.EventMethods.Workbook.ExternalLinksChangedSource,()=>ExcelCopilotCommandingHitlStrings.ExternalLinksChangedSourceLabel],[i.EventMethods.PageLayout.AddedToPrintArea,()=>ExcelCopilotCommandingHitlStrings.PageLayoutAddedToPrintAreaLabel],[i.EventMethods.PageLayout.OrientationChanged,()=>ExcelCopilotCommandingHitlStrings.PageLayoutOrientationChangedLabel],[i.EventMethods.PageLayout.PageBreakInserted,()=>ExcelCopilotCommandingHitlStrings.PageLayoutPageBreakInsertedLabel],[i.EventMethods.PageLayout.PageBreakRemoved,()=>ExcelCopilotCommandingHitlStrings.PageLayoutPageBreakRemovedLabel],[i.EventMethods.PageLayout.PageBreaksAllReset,()=>ExcelCopilotCommandingHitlStrings.PageLayoutPageBreaksAllResetLabel],[i.EventMethods.PageLayout.PaperSizeChanged,()=>ExcelCopilotCommandingHitlStrings.PageLayoutPaperSizeChangedLabel],[i.EventMethods.PageLayout.PrintAreaCleared,()=>ExcelCopilotCommandingHitlStrings.PageLayoutPrintAreaClearedLabel],[i.EventMethods.PageLayout.PrintAreaSet,()=>ExcelCopilotCommandingHitlStrings.PageLayoutPrintAreaSetLabel],[i.EventMethods.PageLayout.PrintSettingsChanged,()=>ExcelCopilotCommandingHitlStrings.PageLayoutPrintSettingsChangedLabel],[i.EventMethods.PageLayout.ScalingChanged,()=>ExcelCopilotCommandingHitlStrings.PageLayoutScalingChangedLabel],[i.EventMethods.AllowEditRange.Added,sa],[i.EventMethods.AllowEditRange.Deleted,ca],[i.EventMethods.AllowEditRange.Edited,da],[i.EventMethods.SheetProtection.OptionsUpdated,ua],[i.EventMethods.SheetProtection.PasswordUpdated,ma],[i.EventMethods.SheetProtection.Paused,ga],[i.EventMethods.SheetProtection.Resumed,pa],[i.EventMethods.SheetProtection.Protected,ha],[i.EventMethods.SheetProtection.Unprotected,ba],[i.EventMethods.CellText.OrientationChanged,L],[i.EventMethods.CellText.MultiRangeOrientationChanged,()=>ExcelCopilotCommandingHitlStrings.CellTextOrientationChangedGeneric],[i.EventMethods.Chart.Renamed,()=>ExcelCopilotCommandingHitlStrings.ChartRenamed],[i.EventMethods.Comment.Resolved,()=>ExcelCopilotCommandingHitlStrings.CommentResolved],[i.EventMethods.Table.Deleted,()=>ExcelCopilotCommandingHitlStrings.TableDeleted],[i.EventMethods.Worksheet.Calculated,()=>ExcelCopilotCommandingHitlStrings.WorksheetCalculated],[i.EventMethods.Intent.ChangeRangeBorder,()=>ExcelCopilotCommandingHitlStrings.IntentChangeRangeBorder],[i.EventMethods.Intent.CreateConditionalFormatColorScale,()=>ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatColorScale],[i.EventMethods.Intent.CreateConditionalFormatDataBar,()=>ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatDataBar],[i.EventMethods.Intent.RangeCopyFrom,()=>ExcelCopilotCommandingHitlStrings.IntentRangeCopyFrom],[i.EventMethods.Intent.CreateConditionalFormatCellValue,()=>ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatCellValue],[i.EventMethods.Intent.CreateConditionalFormatPreset,()=>ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatPreset],[i.EventMethods.Intent.CreateConditionalFormatContainsText,()=>ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatContainsText],[i.EventMethods.Intent.CreateConditionalFormatTopBottom,()=>ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatTopBottom],[i.EventMethods.Intent.CreateConditionalFormatCustom,()=>ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatCustom],[i.EventMethods.Intent.CreateConditionalFormatIconSet,()=>ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatIconSet],[i.EventMethods.System.Undo,()=>ExcelCopilotCommandingHitlStrings.UndoLabel],[i.EventMethods.System.Redo,()=>ExcelCopilotCommandingHitlStrings.RedoLabel],[i.EventMethods.System.Unknown,()=>ExcelCopilotCommandingHitlStrings.UnknownEventLabel],[i.EventMethods.System.Unsupported,()=>ExcelCopilotCommandingHitlStrings.UnsupportedEventLabel],[i.EventMethods.System.InProgress,()=>ExcelCopilotCommandingHitlStrings.InProgressEventLabel],[i.EventMethods.System.Undefined,()=>ExcelCopilotCommandingHitlStrings.UnknownEventLabel],[i.EventMethods.Error.Alias,()=>ExcelCopilotCommandingHitlStrings.ErrorAliasInfo],[i.EventMethods.Error.Unknown,()=>ExcelCopilotCommandingHitlStrings.ErrorUnknown],[i.EventMethods.Error.UpstreamExceptionOccured,()=>ExcelCopilotCommandingHitlStrings.ErrorUnknown],[i.EventMethods.Range.DataValidationRuleListChanged,fa],[i.EventMethods.Range.DataValidationRuleCustomChanged,Ca],[i.EventMethods.Range.DataValidationRuleDateChanged,ya],[i.EventMethods.Range.DataValidationRuleDecimalChanged,va],[i.EventMethods.Range.DataValidationRuleWholeNumberChanged,Sa],[i.EventMethods.Range.DataValidationRuleTextLengthChanged,Ta],[i.EventMethods.Range.DataValidationRuleTimeChanged,xa],[i.EventMethods.Range.DataValidationRuleCleared,wa]]),vl=new Map([[i.EventMethods.ConditionalFormatting.CellValueCreated,Vn],[i.EventMethods.ConditionalFormatting.CustomCreated,Wn],[i.EventMethods.ConditionalFormatting.ColorScaleCustomCreated,zn],[i.EventMethods.ConditionalFormatting.DataBarCustomCreated,Qn],[i.EventMethods.ConditionalFormatting.DatesCreated,Yn],[i.EventMethods.ConditionalFormatting.IconSetCreated,jn],[i.EventMethods.ConditionalFormatting.PresetCreated,Jn],[i.EventMethods.ConditionalFormatting.TextComparisonCreated,Gn],[i.EventMethods.ConditionalFormatting.TopBottomCreated,Zn],[i.EventMethods.ConditionalFormatting.UniqueCreated,Xn],[i.EventMethods.ConditionalFormatting.PriorityEdited,ta]]);function Tl(e,t){const n=fl(e),a=(0,m.k64)()&&t?yl.get(n):Cl.get(n);if(void 0===a)return(0,m.yw9)("OfficeVSO_8958983_HiTLMissingIntentError")?s.O.UnhandledIntent:"Missing intent string";return a(e)}function xl(e,t){const n=vl.get(t);if(void 0===n)return s.O.UnhandledIntent;return n(e)}function Sl(e,t){return e.map((e=>Tl(e,t)))}function wl(e){return e!==i.EventMethods.ConditionalFormatting.Deleted&&e?.includes("ConditionalFormatting")}function El(e){const t=e;t.parameters.rangeType=i.RangeType.TableRange,t.parameters.range.subRange=i.TableRangeOperationSubRange.WholeTable;const n=u.CP.getActiveTable();return t.parameters.range.tableName=n.name,t}function Il(e){switch(e){case a.wv.Worksheet.Filter.Icon:case a.wv.Worksheet.Filter.BottomItems:case a.wv.Worksheet.Filter.BottomPercent:case a.wv.Worksheet.Filter.TopItems:case a.wv.Worksheet.Filter.TopPercent:case a.wv.Worksheet.Filter.Values:case a.wv.Worksheet.Filter.Custom:case a.wv.Worksheet.Filter.FontColor:case a.wv.Worksheet.Filter.CellColor:case a.wv.Worksheet.Filter.Dynamic:return!0;default:return!1}}function Rl(e){switch(e.method){case a.wv.Worksheet.ClearFilter:case a.wv.Worksheet.ClearColumnFilter:return!0;default:return!1}}function Al(e){return e.method===a.wv.Range.Sort}function Ll(e){const t=[];for(const n of e){let e=!1;const a=n.method;let o=s.O.UnhandledIntent;if(Il(a)){const{filteredDataDisplayName:e,filterCriteria:t}=n.args;o=(0,g.lx)(e,t)}else if(Rl(n)){const{changedDataDisplayName:e}=n.args;o=(0,E.A)(ExcelCopilotCommandingHitlStrings.WorksheetRangeClearFiltersLabel,{range:e})}else if((0,m.yw9)("OfficeVSO_9136744_HiTLTLRSortOfficeJS")&&Al(n)){const a=n.args;a.fields.forEach((n=>{n.key>=0&&(o=(0,E.A)(ExcelCopilotCommandingHitlStrings.TableColumnByIndexCustomSortLabel,{columnIndex:n.key,tableName:a.rangeAddress}),t.push(o),e=!0)}))}if(o===s.O.UnhandledIntent)throw new l.sF("Intent string missing or no conversion method exists.",l.UP.MissingIntent);(0,m.yw9)("OfficeVSO_9136744_HiTLTLRSortOfficeJS")&&e||t.push(o)}return t}function kl(e){const t=[],n=[];for(let a of e){const e=fl(a),i=wl(e);a.parameters?.columnName===bl.G.O&&(a=El(a));const u=i?xl(a,e):Tl(a,!0),g=(0,m.yw9)("OfficeVSO_9564930_SplitCommandingTelemetry")&&i?d.BJ.ConditionalFormatting:d.BJ.Commanding;if("string"==typeof u)switch(u){case s.O.NoIntentNeeded:continue;case s.O.MissingIntent:case s.O.UnhandledIntent:if((0,m.yw9)("OfficeVSO_9631333_FixHiTLErrorToElse")||c.M.getInstance().logStandardizedAshaErrorEvent(r.W.Missing_Copilot_Functionality,o.c.Missing_HITL_Intent_String,g),(0,m.yw9)("OfficeVSO_8958983_HiTLMissingIntentError"))throw new l.sF("Intent string missing or no conversion method exists.",l.UP.MissingIntent);return{cfIntents:[],nonCfIntents:[]}}i?t.push(u):n.push(u)}return{cfIntents:t,nonCfIntents:n}}},972160:(e,t,n)=>{"use strict";n.d(t,{i:()=>w,v:()=>E});n(554094);var a=n(874003),o=n(437489),r=n(174116),i=n(446751),l=n(279395),s=n(306148),c=n(857677),d=n(544861),u=n(996211),m=n(672270),g=n(347145),h=n(83478),p=n(792312),b=n(659126),f=n(652382),C=n(297591),y=n(508491),v=n(123963),T=n(887648),x=n(208520);function S(e){if((0,i.iM)(e))return(0,b.hU)(e)?(0,l.aVz)():(0,l.BqH)();if((0,i.cY)(e))return(0,b.Z)(e)?e.allowReplacementOfExistingValue?(0,l.KeO)():(0,l.E$x)():e.allowReplacementOfExistingValue?(0,l.ooE)():(0,l.EWN)();if((0,i.be)(e))return(0,l.E$x)();throw new Error("getInsertText: Invalid recommendation type")}function w(e,t){const n=(0,T.d4)((e=>e.dataAI.invalidatedSuggestions.includes(t.id)))&&(0,g.Jhm)(),[a,r]=(0,x.useState)((()=>!t||!t.isInserted)),s=(0,g.iPS)("Microsoft.Office.Excel.FA000000124.FormulaSuggestionsPreviewButton",!1),f=a&&!n,w=function(e,t,n,a){(0,v.H5)((()=>{(0,C.u)(t.id,n?c.a5.FormulaPreviewButtonAllowed:c.a5.FormulaPreviewButtonDisabled)}));const r=(0,y.j)(),i=(0,T.Pj)(),s=(0,T.d4)((e=>e.dataAI.previewId)),d=(0,T.d4)((e=>e.chat.latestRequestId)),g=x.useMemo((()=>{const a=i.getState();return Boolean(t&&n&&(0,u.c5)(e,t,a)&&a.dataAI.rawPreview[t.id]?.length)}),[e,t,i]),h=t?.id,b=d===e,f=s===h;(0,x.useEffect)((()=>{g&&h&&f&&!b&&((0,m.cY)("FormulaSuggestion: not in latest request, hiding preview"),r((0,p.QI)(e,h)))}),[f,b,h,g]),(0,v.iK)((()=>{g&&h&&f&&((0,m.cY)("FormulaSuggestion: unmounting, hiding preview"),r((0,p.QI)(e,h)))}));const S=Boolean(a&&g&&h);if((0,v.IC)(S,(()=>{(0,C.u)(h,c.a5.FormulaPreviewButtonVisible)})),!S)return;const w=f?l.XBr.PreviewOnGridButton_HidePreview():l.XBr.PreviewOnGridButton_ShowPreview(),E={buttonText:w,buttonTitle:w,icon:f?x.createElement(o.sTx,null):x.createElement(o.tRH,null),handleButtonOnClick:async()=>{if(t)return(0,C.u)(t.id,f?c.a5.FormulaPreviewButtonClickHide:c.a5.FormulaPreviewButtonClickShow),r((0,p.wK)(e,t,{hidePreviewOnChange:!0,moveViewportToPreview:!0}))}};return E}(e,t,s,f),E=function(e,t,n,a,o){const r=(0,y.j)();function l(t){if(o(),r((0,p.QI)(e,t.id)),(0,i.iM)(t))r((0,p.iM)(e,t));else{if(!(0,i.cY)(t))throw new Error("handleInsert: Invalid recommendation type");r((0,p.Sf)(e,t))}}return!t.isInserted&&a?{...(0,i.cY)(t)&&t.allowReplacementOfExistingValue?(0,d.x8)(S(t)):(0,d.r1)(S(t)),handleButtonOnClick:async()=>l(t),...n&&{handleOnMouseEnter:async()=>r((0,p.jv)(e,t)),handleOnMouseLeave:async()=>r((0,p.QI)(e,t.id))}}:void 0}(e,t,!s,f,(()=>r(!1))),I=(0,h.D)(t.debugInfo);return(0,m.cY)("useSuggestionsButtons",{requestId:e,recommendation:t,canInsert:a,canInsertSuggestion:f,canShowPreviewButton:s,previewButton:w,insertButton:E}),[E,w,I].filter(b.O9)}function E(e,t,n,o){const i=(0,h.J)(e,t.debugInfo),c=[{type:a.jA.Default,title:(0,l.oOI)(),text:(0,f.dD)()?void 0:(0,l.oOI)(),iconRegular:r.rz9,handleButtonOnClick:async(e,a,r)=>{(0,s.s_)(s.H0.InsertFormulaSuggestion),n((0,p.Kr)(t,o))},handleOnMouseEnter:async()=>n((0,p.jv)(o,t)),handleOnMouseLeave:async()=>n((0,p.QI)(o,t.id))}];return i&&c.push(i),c}},972424:(e,t,n)=>{"use strict";n.d(t,{r:()=>o,w:()=>r});var a=n(531093);function o(e){return-1===e.lastIndexOf("!")?e:a.ExcelCalc.stripSheetFromRange(e)}function r(e){return-1===e.lastIndexOf("!")?"":a.ExcelCalc.sheetNameFromSheetAddresses(e)}},976026:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var a=n(535718),o=n.n(a),r=n(871038),i=n.n(r)()(o());i.push([e.id,"/* Common properties */\nbutton.chat-conditional-formatting-suggestion-pill {\n  margin-bottom: 10px;\n  display: inline-block;\n  padding: 4px 8px; /* Shorthand for padding-top, padding-bottom, padding-left, and padding-right */\n  text-align: start;\n  background-color: var(--colorNeutralBackground1);\n  border-color: var(--colorNeutralStroke1);\n  color: var(--colorNeutralForeground1);\n}\n","",{version:3,sources:["webpack://./src/frontend/styles/CommandingChatCard.css"],names:[],mappings:"AAAA,sBAAsB;AACtB;EACE,mBAAmB;EACnB,qBAAqB;EACrB,gBAAgB,EAAE,+EAA+E;EACjG,iBAAiB;EACjB,gDAAgD;EAChD,wCAAwC;EACxC,qCAAqC;AACvC",sourcesContent:["/* Common properties */\nbutton.chat-conditional-formatting-suggestion-pill {\n  margin-bottom: 10px;\n  display: inline-block;\n  padding: 4px 8px; /* Shorthand for padding-top, padding-bottom, padding-left, and padding-right */\n  text-align: start;\n  background-color: var(--colorNeutralBackground1);\n  border-color: var(--colorNeutralStroke1);\n  color: var(--colorNeutralForeground1);\n}\n"],sourceRoot:""}]);const l=i},982017:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},982306:(e,t,n)=>{"use strict";function a(e,t){let n;const a=new Promise(((e,a)=>{n=window.setTimeout((()=>{a(new Error("timeout"))}),t)}));return Promise.race([(async()=>{try{return await e}finally{clearTimeout(n)}})(),a])}function o(e,t){return e.every((e=>e.suggestionType===t))}n.d(t,{K:()=>o,j:()=>a})},989881:(e,t,n)=>{"use strict";n.d(t,{O:()=>s});var a=n(660606),o=n(217425),r=n(632197),i=function(e,t,n,a){return new(n||(n=Promise))((function(o,r){function i(e){try{s(a.next(e))}catch(e){r(e)}}function l(e){try{s(a.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((a=a.apply(e,t||[])).next())}))},l=function(e,t){var n,a,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(n=1,a&&(o=2&l[0]?a.return:l[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,l[1])).done)return o;switch(a=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,a=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],a=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},s=function(e,t){return i(void 0,void 0,void 0,(function(){var n,i;return l(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),[4,e.getToken(null!=t?t:o.w8.sharepoint)];case 1:return n=l.sent(),[2,(0,r.t)(n)];case 2:throw i=l.sent(),(0,a.cY)("Error fetching SharePoint token:",i),i;case 3:return[2]}}))}))}},993821:(e,t,n)=>{"use strict";n.d(t,{FF:()=>l,dL:()=>s,gt:()=>d,op:()=>c,pH:()=>u});var a,o=n(207545),r=n(795917),i=n(758651);function l(e){return null==e?void 0:e.TrustedBrokerDomain}function s(e){return c(o.kH.getSetting(o.zj.BizChatHostContext,e))}function c(e){if((0,r.d)(e))return e;if("string"==typeof e)try{var t=JSON.parse(e);return(0,r.d)(t)?t:void 0}catch(e){return void i.error("Failed to parse BizChatHostContext:",e)}}function d(e,t){void 0===a&&u(s(),e,t);return a}function u(e,t,n){var o,i,l,s,c,d=null===(o=null==e?void 0:e.PrimaryUserAccountInfo)||void 0===o?void 0:o.CopilotExperience,u=null!==(c=null!==(l=null===(i=null==e?void 0:e.PrimaryUserAccountInfo)||void 0===i?void 0:i.AggregatedLicensedFeatures)&&void 0!==l?l:null===(s=null==e?void 0:e.PrimaryUserAccountInfo)||void 0===s?void 0:s.LicensedFeatures)&&void 0!==c?c:void 0,m=!n||(!!(null==u?void 0:u.includes("Copilot"))||!!(null==u?void 0:u.includes("CopilotStarter"))),g=t&&m;a=d===r.$.M365CopilotChat||d===r.$.Researcher||d===r.$.Analyst||d===r.$.DataShaping||!!g&&!d}},994481:(e,t,n)=>{"use strict";n.d(t,{Eb:()=>l,Q9:()=>o,oR:()=>s,qH:()=>i,yu:()=>r});var a=n(956933);const o=e=>(0,a.Q9)(e),r=()=>(0,a.yu)(),i=async e=>(0,a.qH)(e),l=async(e,t)=>(0,a.Eb)(e,t),s=e=>(0,a.oR)(e)},995619:(e,t,n)=>{"use strict";n.d(t,{f:()=>v,y:()=>b});var a=n(83437),o=n(329739),r=n(687295),i=n(279395),l=n(616166),s=n(51684),c=n(882329),d=n(75496),u=n(316904),m=n(92520),g=n(347145),h=n(630530),p=n(652382);async function b(){let e=i.u1i;try{e=await OfficeFirstParty.UserFeedback.GetInitializationData()}catch(e){u.M.getInstance().logErrorCode(l.O.FeedbackApiError,e,d.S2.Error,a.$b.Warning),(0,m.cY)("Error in OfficeFirstParty UserFeedback GetInitializationData ",e)}return e}async function f(){let e={};try{e=await OfficeFirstParty.UserFeedback.GetHostScreenshot()}catch(e){u.M.getInstance().logErrorCode(l.O.FeedbackApiError,e,d.S2.Error,a.$b.Warning),(0,m.cY)("Error in OfficeFirstParty UserFeedback GetHostScreenshot ",e)}return e}async function C(e,t){if(e===s.$G.TenantFeedback)try{const e=new o.j({userPrincipalName:t,redirectUri:new URL(c.dS).pathname}),n=await(0,r.s)(e,"https://substrate.office.com/tenantfeedback");return{token:`Bearer ${n.accessToken}`}}catch(e){throw u.M.getInstance().logErrorCode(l.O.FeedbackGetUserAccessTokenError,e,d.S2.Error,a.$b.Warning),(0,m.cY)("Error in OfficeFirstParty UserFeedback GetUserAccessToken ",e),e}(0,m.cY)(`Invalid audience to fetch user access token: ${e}`)}const y=(e,t)=>{try{OfficeFirstParty.UserFeedback.InvokeDiagnosticsLogsUpload(e)}catch(e){u.M.getInstance().logErrorCode(l.O.FeedbackApiError,e,d.S2.Error,a.$b.Warning),(0,m.cY)("Error in OfficeFirstParty UserFeedback InvokeDiagnosticsLogsUpload ",e)}},v=()=>{const e=(0,h.Ul)();if(e)try{let t,n=JSON.parse(e);return n&&(n={...n,callbackFunctions:{...n.callbackFunctions,provideDynamicScreenshot:f,getUserAccessToken:C},feedbackConfig:{...n.feedbackConfig,diagnosticsConfig:{...n.feedbackConfig.diagnosticsConfig,attachDiagnostics:y},isScreenshotEnabled:!0,isEmailCollectionEnabled:!0},telemetry:{...n.telemetry,uiHost:"Excel",platform:(0,p.mw)()}}),t=(0,g.yw9)("OfficeVSO_9249582_IsFeedbackAppChatThemingEnabled")?{feedbackInitOptions:n,lightTheme:{baseTheme:"ExcelLightTheme"},darkTheme:{baseTheme:"ExcelDarkTheme"}}:{feedbackInitOptions:n},t}catch(e){return u.M.getInstance().logErrorCode(l.O.FeedbackApiError,e,d.S2.Error,a.$b.Warning),void(0,m.cY)("Error in parsing feedbackInitializationData to JSON ",e)}}},996211:(e,t,n)=>{"use strict";n.d(t,{Fw:()=>S,Ne:()=>y,UN:()=>C,YE:()=>v,c5:()=>f,cQ:()=>b,gE:()=>w,k8:()=>p,kJ:()=>T,py:()=>x});var a=n(616166),o=n(596760),r=n(83437),i=n(75496),l=n(316904),s=n(659126),c=n(446751),d=n(347145),u=n(540084),m=n(420988),g=n(342935),h=n(819415);function p(e){return Boolean(e?.tableName&&e.sheetName&&e.address&&e.sheetId)}function b(e,t){const{dataAI:{tableName:n},selection:a}=t,o=n[e];return o?a.selectionContexts[o]:void 0}function f(e,t,n){if(!function(){if((0,d.yw9)("OfficeVSO_9625689_allowMacPreviewByClientVersion"))return(0,h.w0)(["Mac:89.823"],!0);return!(0,d.Te4)("Microsoft.Office.Excel.FA000000124.disableGridPreview",["Mac"]).includes(Office.PlatformType[Office.context.platform])}())return!1;if(!(0,g.CU)(t))return!1;if((0,c.be)(t)&&(1!==t.calculatedFormulas.length||!t.calculatedFormulas[0].insertionMode||[o.PH.ShiftDown,o.PH.ShiftRight].includes(t.calculatedFormulas[0].insertionMode)))return!1;if((0,c.iM)(t)&&C(t)){if(!(0,d.yw9)("OfficeVSO_9658083_enableInsertOverride"))return!1;if(!function(e){if(!C(e))return l.M.getInstance().logErrorCode(a.O.CalculatedColumnPreviewColumnInTheMiddleExpected,new Error("shouldShowGridPreviewForColumnInTheMiddle: don't have column in the middle"),i.S2.FormulaGeneration,r.$b.Warning),!0;const t=e.calculatedFormulas.every((e=>e.insertionMode===o.PH.ToTableWithOverride));if(!t)return!1;let{calculatedFormulas:n}=e;n=[...n],n.sort(((e,t)=>(e.insertionIndex??Number.MAX_SAFE_INTEGER)-(t.insertionIndex??Number.MAX_SAFE_INTEGER)));return n.every(((e,t,n)=>0===t||e.insertionIndex===(n[t-1].insertionIndex??Number.MAX_SAFE_INTEGER)+1))}(t))return!1}const s=b(e,n);if(!s||!p(s))return!1;return!!n.dataAI.tableName[e]&&!!n.selection.selectionContexts}function C(e){return e.calculatedFormulas.some((e=>void 0!==e.insertionIndex))}function y(e){if(0===e.length)return[];const t=[];let n=[];return e.forEach(((a,o)=>{0===o||a-e[o-1]===1?n.push(a):(t.push(n),n=[a])})),t.push(n),t}function v(e,t){let n=(0,c.JM)(e);e.insertRowTitle&&(n=[0,...n]);const a=n.map((e=>t.map((t=>t[e]??""))));return(0,s.mg)(a)}function T(e){return!(0,c.cY)(e)||!(0,s.th)(e)&&!(0,s.By)(e)}function x(e,t){const{columnIndex:n,rowIndex:a,columnCount:r,address:i}=t;if(!i)return;if(e.calculatedFormulas.every((e=>e.insertionMode===o.PH.ToTableWithOverride))){let{calculatedFormulas:t}=e;return t=[...t],t.sort(((e,t)=>(e.insertionIndex??Number.MAX_SAFE_INTEGER)-(t.insertionIndex??Number.MAX_SAFE_INTEGER))),(0,s.Tq)(n+1,a+1,r,t[0].insertionIndex??r)}return(0,s.cc)(i)??i}async function S(e,t,n){if((0,s.By)(e))return e.calculatedFormulas[0].fixedInsertionRange;if((0,s.th)(e))return await(0,s.a$)();const{address:a}=t;if(!a||void 0===n)return;return(0,s.K3)(a,n)??a}async function w(e,t){if(1!==e.calculatedFormulas.length)throw new Error("prepSingleFormulaPreviewValues expects exactly one calculatedFormula");const n=e.calculatedFormulas[0],{previewValues:o,fixedInsertionRange:c,titleTargetRange:d}=n;if(!o||!c)return{previewValues:[],anchorCellAddress:void 0};try{const e=(0,u.AW)((0,s.gx)(c)||c),g=e.top,h=e.left,p=o.length,b=p>0?o[0].length:0;if(0===p||0===b)return{previewValues:[],anchorCellAddress:void 0};let f,C=-1,y=-1;if(d?.address&&n.title)try{f=(0,u.AW)((0,s.gx)(d.address)||d.address),C=f.top,y=f.left}catch(e){f=void 0}let v=g,T=g+p-1,x=h,S=h+b-1;f&&(v=Math.min(v,C),T=Math.max(T,C),x=Math.min(x,y),S=Math.max(S,y));const w=T-v+1,E=S-x+1,I=Array(w).fill(null).map((()=>Array(E).fill("")));for(let e=0;e<p;e++)for(let t=0;t<b;t++){const n=g+e-v,a=h+t-x;if(n>=0&&n<w&&a>=0&&a<E){const r=o[e][t];I[n][a]=r}}if(f&&n.title){const e=C-v,t=y-x;e>=0&&e<w&&t>=0&&t<E&&(I[e][t]=n.title)}const R=await async function(e,t,n,o,s,c,d,g,h,p){if(!p)return!0;const b=[],f=(e,t,a,r)=>{if(!(e>a||t>r))for(let i=e;i<=a;i++)for(let e=t;e<=r;e++){const t=`${(0,u.z)(o+e)}${n+i}`;b.push(t)}},C=s-n,y=c-o,v=s+d-1-n,T=c+g-1-o,x=h?h.top-n:-1,S=h?h.left-o:-1,w=e=>{e.top<=e.bottom&&e.left<=e.right&&f(e.top,e.left,e.bottom,e.right)},E=(e,t,n)=>{if(t<e.top||t>e.bottom||n<e.left||n>e.right)return[e];const a=[];return a.push({top:e.top,left:e.left,bottom:t-1,right:e.right}),a.push({top:t+1,left:e.left,bottom:e.bottom,right:e.right}),a.push({top:t,left:e.left,bottom:t,right:n-1}),a.push({top:t,left:n+1,bottom:t,right:e.right}),a},I=((e,t,n)=>{const a=[];return n.top>0&&a.push({top:0,left:0,bottom:n.top-1,right:t-1}),n.bottom<e-1&&a.push({top:n.bottom+1,left:0,bottom:e-1,right:t-1}),n.left>0&&a.push({top:n.top,left:0,bottom:n.bottom,right:n.left-1}),n.right<t-1&&a.push({top:n.top,left:n.right+1,bottom:n.bottom,right:t-1}),a})(e,t,{top:C,left:y,bottom:v,right:T});for(const e of I)h?E(e,x,S).forEach(w):w(e);if(b.length>0)try{return!(await(0,m._)(p,b)).some((e=>!e))}catch(e){return l.M.getInstance().logErrorCode(a.O.CalculatedCellsGetIsTotalRowCellsEmptyFailed,e,i.S2.FormulaGeneration,r.$b.Warning),!0}return!0}(w,E,v,x,g,h,p,b,f,t?.sheetName);if(!R)return{previewValues:[],anchorCellAddress:void 0};return{previewValues:I,anchorCellAddress:`${(0,u.z)(x)}${v}`}}catch(e){try{const e=(0,u.AW)((0,s.gx)(c)||c);return{previewValues:o,anchorCellAddress:`${(0,u.z)(e.left)}${e.top}`}}catch(e){return{previewValues:[],anchorCellAddress:void 0}}}}},997434:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(904967);t.default=function(e){if(!(0,a.default)(e))throw TypeError("Invalid UUID");let t;return Uint8Array.of((t=parseInt(e.slice(0,8),16))>>>24,t>>>16&255,t>>>8&255,255&t,(t=parseInt(e.slice(9,13),16))>>>8,255&t,(t=parseInt(e.slice(14,18),16))>>>8,255&t,(t=parseInt(e.slice(19,23),16))>>>8,255&t,(t=parseInt(e.slice(24,36),16))/1099511627776&255,t/4294967296&255,t>>>24&255,t>>>16&255,t>>>8&255,255&t)}}},__webpack_module_cache__={},deferred,leafPrototypes,getProto,inProgress,dataWebpackPrefix;function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.loaded=!0,n.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.amdO={},deferred=[],__webpack_require__.O=(e,t,n,a)=>{if(!t){var o=1/0;for(s=0;s<deferred.length;s++){for(var[t,n,a]=deferred[s],r=!0,i=0;i<t.length;i++)(!1&a||o>=a)&&Object.keys(__webpack_require__.O).every((e=>__webpack_require__.O[e](t[i])))?t.splice(i--,1):(r=!1,a<o&&(o=a));if(r){deferred.splice(s--,1);var l=n();void 0!==l&&(e=l)}}return e}a=a||0;for(var s=deferred.length;s>0&&deferred[s-1][2]>a;s--)deferred[s]=deferred[s-1];deferred[s]=[t,n,a]},__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},getProto=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,__webpack_require__.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var n=Object.create(null);__webpack_require__.r(n);var a={};leafPrototypes=leafPrototypes||[null,getProto({}),getProto([]),getProto(getProto)];for(var o=2&t&&e;"object"==typeof o&&!~leafPrototypes.indexOf(o);o=getProto(o))Object.getOwnPropertyNames(o).forEach((t=>a[t]=()=>e[t]));return a.default=()=>e,__webpack_require__.d(n,a),n},__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.f={},__webpack_require__.e=e=>Promise.all(Object.keys(__webpack_require__.f).reduce(((t,n)=>(__webpack_require__.f[n](e,t),t)),[])),__webpack_require__.u=e=>(({0:"vendors~3","vendors-npm_store_sdx_officecopilot_character-entities-legacy_3_0_0-9d0f86663a05531bbde7_node-1bb3e3":"vendors~13","vendors-npm_store_sdx_officecopilot_1js-scc-react-markdown-renderer_9_19_2-e5e2c50bbd5a973c19-845c0b":"vendors~18","vendors-npm_store_sdx_officecopilot_1js-scc-react-source-control-manager_1_7_34-309469cccadb3-0700b9":"vendors~32","vendors-npm_store_sdx_officecopilot_1js-m365card-people-picker-persona_1_9_32-7f466ce066aa74b-cec8c9":"vendors~33","vendors-npm_store_sdx_officecopilot_showdown_2_1_0-c9b3b1d37b0ef403be6c_node_modules_showdown-2e0888":"vendors~124","vendors-npm_store_sdx_officecopilot_1js-pluralization_5_2_3-7689309529473eb58eaa_node_modules-1fb5bc":"vendors~14","vendors-npm_store_sdx_officecopilot_1js-copilot-entity-data_24_3_453-95c3e8c522354cf16703_nod-288467":"vendors~21","vendors-npm_store_sdx_officecopilot_1js-copilot-plugins-file_23_9_300-e52514f61090f2b010df_no-d5c2cf":"vendors~30","vendors-npm_store_sdx_officecopilot_1js-copilot-plugins-event_30_2_46-2085f5ad46fe943ca3db_no-23aaa9":"vendors~128","vendors-npm_store_sdx_officecopilot_1js-officeaicopilot-voice-realtime_7_27_3-070b5114bdd4e29-036934":"vendors~27","vendors-npm_store_sdx_officecopilot_1js-officeaicopilot-assistant_4_8_3-4536f3b7f66a8eb3dd00_-3e3e55":"vendors~127","vendors-npm_store_sdx_officecopilot_1js-scc-service-voice-augloop_4_0_489-613515d2b8aec6220b0-221b18":"vendors~34","vendors-npm_store_sdx_officecopilot_1js-scc-service-ciq_5_1_225-6693faaf83b961103b26_node_mod-aa21c3":"vendors~25","vendors-npm_store_sdx_officecopilot_1js-scc-react-api-card-extensions_1_11_89-cb270aa3d14c7f2-de7f14":"vendors~131","vendors-npm_store_sdx_officecopilot_azure-msal-common_15_8_0-5ddec09c577d7d05edc7_node_module-52eaa3":"vendors~19","vendors-npm_store_sdx_officecopilot_azure-msal-common_14_16_0-73649867aca99b9381a4_node_modul-293e7c":"vendors~29","vendors-npm_store_sdx_officecopilot_1js-excel-copilot-calc_8_3_43-1adabd76bb06679768ec_node_m-dd2f81":"vendors~125","vendors-npm_store_sdx_officecopilot_typescript_5_0_4-007004e2f84938dc12ca_node_modules_typesc-351a83":"vendors~16","vendors-npm_store_sdx_officecopilot_office-script-synchronous_0_0_97-8bbd4c10a11390e6ba99_nod-a80310":"vendors~24","vendors-npm_store_sdx_officecopilot_monaco-editor_0_46_0-51dbdf7e44e9cf33acc3_node_modules_mo-e5e20f":"vendors~126","vendors-npm_store_sdx_officecopilot_1js-scc-react-markdown-renderer_9_19_2-e5e2c50bbd5a973c19-5e363c":"vendors~132","vendors-npm_store_sdx_officecopilot_1js-officeaicopilot-inlinecreationhvc_5_1_377-1a618e02159-5a46c0":"vendors~26","vendors-npm_store_sdx_officecopilot_1js-officeaicopilot-podcast-ui_3_6_80-e1a26a6da5adb170aec-3e2431":"vendors~130","vendors-npm_store_sdx_officecopilot_1js-scc-react-markdown-dialog_2_5_2-808eacf42b7095e5dfc8_-c0bc1a":"vendors~31","vendors-npm_store_sdx_officecopilot_mobx-react_7_6_0-b3d1e376fc41f8f7207f_node_modules_mobx-r-81b505":"vendors~22","npm_store_sdx_officecopilot_1js-m365-chat-editor-client_3_2_1-c262d203cda436663859_node_modul-c1eba1":"vendors~1","vendors-npm_store_sdx_officecopilot_1js-m365-chat-editor-client_3_2_1-c262d203cda436663859_no-596af4":"vendors~129","npm_store_sdx_officecopilot_1js-m365-chat-editor-client_3_2_1-c262d203cda436663859_node_modul-b70fee":"vendors~2","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-8298ff":"vendors~122","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-447dd5":"vendors~121","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-51e825":"vendors~120","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-03f382":"vendors~119","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-f98056":"vendors~118","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-b2be32":"vendors~117","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-f0ec39":"vendors~116","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-0db073":"vendors~115","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-3abfb1":"vendors~114","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-56f275":"vendors~113","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-21c776":"vendors~112","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-6a4b46":"vendors~111","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-71f76d":"vendors~110","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-d3a21c":"vendors~109","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-9264ca":"vendors~108","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-ebc11e":"vendors~107","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-68be69":"vendors~106","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-dc8dd5":"vendors~105","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-f51a6b":"vendors~104","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-30b494":"vendors~103","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-f15476":"vendors~102","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-cd3132":"vendors~101","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-043ae4":"vendors~100","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-c762e4":"vendors~99","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-262966":"vendors~98","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-4de17b":"vendors~97","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-32fd6e":"vendors~96","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-612390":"vendors~95","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-a7920a":"vendors~94","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-177f27":"vendors~93","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-52e27b":"vendors~92","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-8f5bbf":"vendors~91","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-4a2780":"vendors~90","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-9a4a4b":"vendors~89","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-6403f1":"vendors~88","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-eaf7e6":"vendors~87","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-aade10":"vendors~86","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-7f603c":"vendors~85","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-48b57c":"vendors~84","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-81ca4a":"vendors~83","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-09f87b":"vendors~82","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-e2a065":"vendors~81","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-1003c5":"vendors~80","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-0a2101":"vendors~79","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-be288c":"vendors~78","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-e2a75f":"vendors~77","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-14a395":"vendors~76","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-53474f":"vendors~75","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-caa913":"vendors~74","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-9e24e7":"vendors~73","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-b68d97":"vendors~72","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-f4aead":"vendors~71","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-a15b4f":"vendors~70","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-938d62":"vendors~69","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-dba2cc":"vendors~68","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-3a3bc9":"vendors~67","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-07d7cf":"vendors~66","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-a21506":"vendors~65","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-0f0ee0":"vendors~64","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-29fc7c":"vendors~63","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-49e63a":"vendors~62","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-6b2cca":"vendors~61","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-ed62dd":"vendors~60","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-5c91d7":"vendors~59","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-9891de":"vendors~58","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-5b08c2":"vendors~57","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-4b064a":"vendors~56","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-0e02d7":"vendors~55","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-e22fc8":"vendors~54","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-4d4c55":"vendors~53","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-c56e9f":"vendors~52","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-cfc5b2":"vendors~51","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-b9db1f":"vendors~50","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-8b6139":"vendors~49","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-7e6146":"vendors~48","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-22081e":"vendors~47","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-7236bc":"vendors~46","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-3f415b":"vendors~45","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-1e5b61":"vendors~44","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-8a988f":"vendors~43","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-463e15":"vendors~42","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-28ce92":"vendors~41","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-4053bc":"vendors~40","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-aea9f3":"vendors~39","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-d5e874":"vendors~38","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-76726d8502f026f7ef64_node_mod-5abda5":"vendors~37","vendors-npm_store_sdx_officecopilot_microsoft-1ds-analytics-js_4_3_9-98ea4b02ef82e4b4db1a_nod-7909ab":"vendors~28"}[e]||e)+".js"),__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),inProgress={},dataWebpackPrefix="TypeScriptModule:",__webpack_require__.l=(e,t,n,a)=>{if(inProgress[e])inProgress[e].push(t);else{var o,r;if(void 0!==n)for(var i=document.getElementsByTagName("script"),l=0;l<i.length;l++){var s=i[l];if(s.getAttribute("src")==e||s.getAttribute("data-webpack")==dataWebpackPrefix+n){o=s;break}}o||(r=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,__webpack_require__.nc&&o.setAttribute("nonce",__webpack_require__.nc),o.setAttribute("data-webpack",dataWebpackPrefix+n),o.src=e),inProgress[e]=[t];var c=(t,n)=>{o.onerror=o.onload=null,clearTimeout(d);var a=inProgress[e];if(delete inProgress[e],o.parentNode&&o.parentNode.removeChild(o),a&&a.forEach((e=>e(n))),t)return t(n)},d=setTimeout(c.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=c.bind(null,o.onerror),o.onload=c.bind(null,o.onload),r&&document.head.appendChild(o)}},__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),__webpack_require__.j="appchat",(()=>{var e;__webpack_require__.g.importScripts&&(e=__webpack_require__.g.location+"");var t=__webpack_require__.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var a=n.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=n[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),__webpack_require__.p=e})(),(()=>{__webpack_require__.b=document.baseURI||self.location.href;var e={appchat:0,"appchat-lazy":0,"default~appchat-lazy":0,taskpane:0,"vendors-npm_store_sdx_officecopilot_react-dom_17_0_2-4995b43301c5c55b1aab_node_modules_react--454ad2":0,"vendors~appchat-lazy~excelagentexperimental-lazy":0};__webpack_require__.f.j=(t,n)=>{var a=__webpack_require__.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var o=new Promise(((n,o)=>a=e[t]=[n,o]));n.push(a[2]=o);var r=__webpack_require__.p+__webpack_require__.u(t),i=new Error;__webpack_require__.l(r,(n=>{if(__webpack_require__.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var o=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;i.message="Loading chunk "+t+" failed.\n("+o+": "+r+")",i.name="ChunkLoadError",i.type=o,i.request=r,a[1](i)}}),"chunk-"+t,t)}},__webpack_require__.O.j=t=>0===e[t];var t=(t,n)=>{var a,o,[r,i,l]=n,s=0;if(r.some((t=>0!==e[t]))){for(a in i)__webpack_require__.o(i,a)&&(__webpack_require__.m[a]=i[a]);if(l)var c=l(__webpack_require__)}for(t&&t(n);s<r.length;s++)o=r[s],__webpack_require__.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return __webpack_require__.O(c)},n=self.webpackChunkTypeScriptModule=self.webpackChunkTypeScriptModule||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),__webpack_require__.nc=void 0,__webpack_require__.O(void 0,["chunk1jsfluent","chatcore","augloop-chunk","office-iss","vendors-npm_store_sdx_officecopilot_parse5_6_0_1-6346061a9d49819048e1_node_modules_parse5_lib-b0e687","vendors-npm_store_sdx_officecopilot_griffel-core_1_19_2-a53c0f7bf03872bf6af3_node_modules_gri-ab40e9","vendors-npm_store_sdx_officecopilot_buffer_6_0_3-1a644f28c27d2b46696c_node_modules_buffer_index_js","vendors-npm_store_sdx_officecopilot_1js-clipboard-utils_12_2_19-7b1edb59856b7f7e8ab5_node_mod-a7c812","vendors-npm_store_sdx_officecopilot_1js-localization-components_6_0_0-0c0b7e15b5ac32c3a95c_no-6b9913","vendors-npm_store_sdx_officecopilot_inherits_2_0_4-811c5d3b9f8b99c1e7a4_node_modules_inherits-d46e62","vendors-npm_store_sdx_officecopilot_1js-scc-service-cloud-files_4_1_67-1045017c5d52d60593cb_n-fe1d3a","vendors-npm_store_sdx_officecopilot_1js-officeaicopilot-chat_51_8_1-596d1bcb82941be50f70_node-4055ed","vendors-npm_store_sdx_officecopilot_1js-officeaicopilot-utils_5_5_3-8d180d3d597b338833b1_node-15faf2","vendors-npm_store_sdx_officecopilot_hoist-non-react-statics_3_3_2-2c5f76ff0fb3eca13720_node_m-889939","vendors-npm_store_sdx_officecopilot_1js-localization-components_6_0_0-0c0b7e15b5ac32c3a95c_no-f552c9","vendors-npm_store_sdx_officecopilot_1js-officeaicopilot-ui-types_11_29_15-42b62830e7662704ad3-ab605d"],(()=>__webpack_require__(653012)));var __webpack_exports__=__webpack_require__.O(void 0,["chunk1jsfluent","chatcore","augloop-chunk","office-iss","vendors-npm_store_sdx_officecopilot_parse5_6_0_1-6346061a9d49819048e1_node_modules_parse5_lib-b0e687","vendors-npm_store_sdx_officecopilot_griffel-core_1_19_2-a53c0f7bf03872bf6af3_node_modules_gri-ab40e9","vendors-npm_store_sdx_officecopilot_buffer_6_0_3-1a644f28c27d2b46696c_node_modules_buffer_index_js","vendors-npm_store_sdx_officecopilot_1js-clipboard-utils_12_2_19-7b1edb59856b7f7e8ab5_node_mod-a7c812","vendors-npm_store_sdx_officecopilot_1js-localization-components_6_0_0-0c0b7e15b5ac32c3a95c_no-6b9913","vendors-npm_store_sdx_officecopilot_inherits_2_0_4-811c5d3b9f8b99c1e7a4_node_modules_inherits-d46e62","vendors-npm_store_sdx_officecopilot_1js-scc-service-cloud-files_4_1_67-1045017c5d52d60593cb_n-fe1d3a","vendors-npm_store_sdx_officecopilot_1js-officeaicopilot-chat_51_8_1-596d1bcb82941be50f70_node-4055ed","vendors-npm_store_sdx_officecopilot_1js-officeaicopilot-utils_5_5_3-8d180d3d597b338833b1_node-15faf2","vendors-npm_store_sdx_officecopilot_hoist-non-react-statics_3_3_2-2c5f76ff0fb3eca13720_node_m-889939","vendors-npm_store_sdx_officecopilot_1js-localization-components_6_0_0-0c0b7e15b5ac32c3a95c_no-f552c9","vendors-npm_store_sdx_officecopilot_1js-officeaicopilot-ui-types_11_29_15-42b62830e7662704ad3-ab605d"],(()=>__webpack_require__(261237)));__webpack_exports__=__webpack_require__.O(__webpack_exports__),TypeScriptModule=__webpack_exports__})();
//# sourceMappingURL=appchat.js.map