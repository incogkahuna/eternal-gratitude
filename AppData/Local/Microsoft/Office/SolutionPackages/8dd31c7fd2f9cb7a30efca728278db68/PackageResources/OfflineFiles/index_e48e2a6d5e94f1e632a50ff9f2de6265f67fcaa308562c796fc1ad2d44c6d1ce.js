/*! For license information please see index.js.LICENSE.txt */
var TypeScriptModule;(()=>{var e,t,n,r,o={1801:(e,t,n)=>{"use strict";n.d(t,{Qq:()=>i,Tp:()=>o,hB:()=>r});var r=function(e){return e.Generic="Generic",e.Error="Error",e.UserAction="UserAction",e.Activity="Activity",e.DNM="DNM",e}({}),o=function(e){return e.Success="Success",e.Failure="Failure",e.Cancelled="Cancelled",e}({});const i={Bool:"Bool",Int64:"Int64",Double:"Double"}},7394:(e,t,n)=>{"use strict";n.d(t,{Ed:()=>i,FT:()=>o,pb:()=>s});var r=n(577);function o(e){return()=>e}function i(e){return t=>Math.pow(2,t)*e}function s(e,t,n){return a(e,[],new AbortController,t,n)}function a(e,t,n,o,i){let s;const c=[e(t.length).then((e=>(s=e,!1)))];return i&&i.timeoutMs>0&&c.push((0,r.c)(i.timeoutMs,n.signal).then((()=>!0))),Promise.race(c).then((c=>(c&&(s=i.onTimeout()),!o?.filter(s)||t.length>=o.maxRetries?(n.abort(),{result:s,tries:t}):(0,r.c)(o.backoffFn(t.length,s),n.signal).then((()=>(t.push(s),a(e,t,n,o,i)))))))}},577:(e,t,n)=>{"use strict";function r(e,t){return new Promise((n=>{const r=setTimeout((()=>n()),e);t?.addEventListener("abort",(()=>{clearTimeout(r),n()}))}))}function o(e,t){const n=r(e).then((e=>!0)),o=t.map((e=>e.then((e=>!1)).catch((e=>!1))));return Promise.race([n,...o])}n.d(t,{c:()=>r,t:()=>o})},4506:(e,t,n)=>{"use strict";n.d(t,{J5:()=>d,sC:()=>u});var r=n(7394);const o=709,i=710,s=707,a=711;function c(){return"undefined"==typeof navigator||!1!==navigator.onLine}const l={durationMs:-1,body:null,bodyUsed:!1,headers:new Headers,ok:!1,redirected:!1,status:c()?i:o,statusText:"",type:"error",url:"",bytes:()=>Promise.resolve(new Uint8Array(0)),arrayBuffer:()=>Promise.resolve(new ArrayBuffer(0)),blob:()=>Promise.resolve(new Blob(void 0)),formData:()=>Promise.resolve(new FormData(void 0)),json:()=>Promise.resolve(void 0),text:()=>Promise.resolve(""),clone:()=>new Response};function u(e){return t=>e.includes(t.status)}function d(e,t,n,u=18e4){let d=n;n?.respectRetryAfterHeader&&(d={...n},d.backoffFn=(e,t)=>{if(429===t.status||503===t.status){const e=t.headers.get("Retry-After");if(e){const t=parseInt(e,10);if(!isNaN(t))return 1e3*t}}return n.backoffFn(e,t)});const p=new AbortController;t?.signal?.aborted?p.abort(t.signal.reason):t?.signal?.addEventListener("abort",(function(){p.abort(this.reason)}));const h={...t,signal:p.signal};let f,g=!1;return"undefined"!=typeof window&&window.self!==window.top&&(f=e=>{e.persisted||(g=!0)},window.addEventListener("pagehide",f)),(0,r.pb)((()=>{const t="undefined"!=typeof performance?performance.now():Date.now();return fetch(e,h).then((e=>{const n=e;return n.durationMs=Math.round(performance.now()-t),n})).catch((e=>{if(function(e,t){return e===t?.reason||"object"==typeof e&&null!==e&&("AbortError"===e.name||20===e.code)}(e,h.signal))throw e;let n="Error does not provide a message";e.name&&e.message?n=`Error type: ${e.name}, ${e.message}`:e.name?n=`Error type: ${e.name}`:e.message&&(n=`Error message: ${e.message}`);const r=c()?g?a:i:o;return{...l,status:r,ok:!1,durationMs:Math.round(performance.now()-t),statusText:n}}))}),d,{timeoutMs:u,onTimeout:()=>(p.abort(),{...l,status:s,ok:!1,durationMs:u})}).finally((()=>{"undefined"!=typeof window&&window.self!==window.top&&f&&window.removeEventListener("pagehide",f)}))}},751:(e,t,n)=>{"use strict";n.d(t,{F:()=>b});const r="https://hubblecontent.osi.office.net/contentsvc/",o="https://cdn.hubblecontent.osi.office.net/",i={aadAuthority:"https://login.microsoftonline.us",loki:"https://dod.loki.office365.us",graph:"https://dod-graph.microsoft.us",substrate:"https://substrate-dod.office365.us",outlook:"https://outlook-dod.office365.us",augloop:"https://augloop.dod.online.office365.us",augloopOld:"https://augloop.dod.online.office365.us",ocps:"https://clients.config.dod.office365.us",fs:"https://fs.microsoft.com",editor:"nleditor.osi.apps.mil",editorSynonyms:"editor-pathfinder-thesaurus.usgovtrafficmanager.net:9443",mru:"https://ocws.osi.apps.mil/ocs",ecs:"https://config.ecs.dod.teams.microsoft.us",project:"https://project.apps.mil/",teamsTasks:"",plannerOld:"https://tasks.osi.apps.mil",plannerNew:"",centro:"",iris:"",teams:"https://dod.teams.microsoft.us",teamsWebTasks:"",hubbleService:r,hubbleStorage:o,toDo:"",roaming:"https://roaming.osi.apps.mil",roamingToken:"https://api.osi.apps.mil",mruToken:"https://api.osi.apps.mil",webPreviewer:""},s={aadAuthority:"https://login.microsoftonline.us",loki:"https://gcchigh.loki.office365.us",graph:"https://graph.microsoft.us",substrate:"https://substrate.office365.us",outlook:"https://outlook.office365.us",augloop:"https://augloop.gov.online.office365.us",augloopOld:"https://augloop.gov.online.office365.us",ocps:"https://clients.config.high.office365.us",fs:"https://fs.microsoft.com",editor:"nleditor.osi.office365.us",editorSynonyms:"editor-trailblazer-thesaurus.usgovtrafficmanager.net:9443",mru:"https://ocws.osi.office365.us/ocs",ecs:"https://config.ecs.gov.teams.microsoft.us",project:"https://project.office365.us",plannerOld:"https://tasks.office365.us",plannerNew:"",teamsTasks:"",centro:"",iris:"",teams:"https://gov.teams.microsoft.us",teamsWebTasks:"",hubbleService:r,hubbleStorage:o,toDo:"",roaming:"https://roaming.osi.office365.us",roamingToken:"https://api.osi.office365.us",mruToken:"https://api.osi.office365.us",webPreviewer:""},a={aadAuthority:"https://login.microsoftonline.com",loki:"https://loki.delve.office.com",graph:"https://graph.microsoft.com",substrate:"https://substrate.office.com",outlook:"https://outlook.office.com",augloop:"https://gcc.augloop.svc.cloud.microsoft",augloopOld:"https://augloop-gcc.office.com",ocps:"https://clients.config.gcc.office.net",fs:"https://fs.microsoft.com",editor:"nleditor.gcc.osi.office365.us",editorSynonyms:"editor-gccm-thesaurus.usgovtrafficmanager.net:9443",mru:"https://ocws.officeapps.live.com/ocs",ecs:"https://ecs.office.com",project:"https://gcc.project.microsoft.com",teamsTasks:"https://tasks.gcc.teams.microsoft.com",plannerOld:"https://tasks.office.com",plannerNew:"",centro:"",iris:"",teams:"https://teams.microsoft.com",teamsWebTasks:"",hubbleService:r,hubbleStorage:o,toDo:"https://to-do.office.com",roaming:"https://roaming.officeapps.live.com",roamingToken:"https://api.office.net",mruToken:"https://api.office.net",webPreviewer:""},c={aadAuthority:"https://login.microsoftonline.us",loki:"",graph:"",substrate:"",outlook:"",augloop:"",augloopOld:"",ocps:"",fs:"",editor:"",editorSynonyms:"",mru:"",ecs:"https://config.ecs.teams.eaglex.ic.gov",project:"",teamsTasks:"",plannerOld:"",plannerNew:"",centro:"",iris:"",hubbleService:"",hubbleStorage:"",teams:"",teamsWebTasks:"",toDo:"",roaming:"https://roaming.osi.eaglex.ic.gov",roamingToken:"https://officeapps.live.com",mruToken:"https://officeapps.live.com",webPreviewer:""},l={aadAuthority:"https://login.microsoftonline.us",loki:"",graph:"",substrate:"",outlook:"",augloop:"",augloopOld:"",ocps:"",fs:"",editor:"",editorSynonyms:"",mru:"",ecs:"https://config.ecs.teams.microsoft.scloud",project:"",teamsTasks:"",plannerOld:"",plannerNew:"",centro:"",iris:"",hubbleService:"",hubbleStorage:"",teams:"",teamsWebTasks:"",toDo:"",roaming:"https://roaming.osi.microsoft.scloud",roamingToken:"https://officeapps.live.com",mruToken:"https://officeapps.live.com",webPreviewer:""},u={aadAuthority:"https://login.microsoftonline.com",augloop:"https://dogfood.augloop.svc.cloud.microsoft",augloopOld:"https://augloop-dogfood.officeppe.com",centro:"https://admin-ignite.microsoft.com",ecs:"https://ecs.office.com",editor:"nleditor.osi.office.net",editorSynonyms:"editor-prod-thesaurus.trafficmanager.net:9443",fs:"https://fs.microsoft.com",graph:"https://graph.microsoft.com",iris:"https://arc.msn.com",loki:"https://loki.delve.office.com",mru:"https://ocws-df.officeapps.live.com/ocs",ocps:"https://sip.clients.config.office.net",outlook:"https://outlook.office.com",plannerNew:"https://planner.cloud.microsoft",plannerOld:"https://tasks.office.com",project:"https://project.microsoft.com",substrate:"https://substrate.office.com",teamsTasks:"https://retailservices.teams.microsoft.com",teams:"https://teams.microsoft.com",teamsWebTasks:"https://tasks.teams.microsoft.com",hubbleService:r,hubbleStorage:o,toDo:"https://to-do.office.com",roaming:"https://roaming.officeapps.live.com",roamingToken:"https://api.office.net",mruToken:"https://api.office.net",webPreviewer:"https://loop.usercontent.dev.microsoft"},d={aadAuthority:"https://login.microsoftonline.com",augloop:"https://dogfood.augloop.svc.cloud.microsoft",augloopOld:"https://augloop-dogfood.officeppe.com",centro:"https://admin-ignite.microsoft.com",ecs:"https://ecs.office.com",editor:"nleditor.osi.officeppe.net",editorSynonyms:"editor-edog-thesaurus.trafficmanager.net:9443",fs:"https://fs.microsoft.com",graph:"https://graph.microsoft.com",iris:"https://arc.msn.com",loki:"https://loki.delve.office.com",mru:"https://ocws-df.officeapps.live.com/ocs",ocps:"https://clients.config.office.net",outlook:"https://outlook.office.com",plannerNew:"https://planner.cloud.microsoft",plannerOld:"https://tasks.office.com",project:"https://project.microsoft.com",substrate:"https://substrate.office.com",teamsTasks:"https://retailservices.teams.microsoft.com",teams:"https://teams.microsoft.com",teamsWebTasks:"",hubbleService:r,hubbleStorage:o,toDo:"https://to-do.office.com",roaming:"https://roaming.officeapps.live.com",roamingToken:"https://api.office.net",mruToken:"https://api.office.net",webPreviewer:"https://loop.usercontent.dev.microsoft"},p={aadAuthority:"https://login.microsoftonline.com",augloop:"https://dogfood.augloop.svc.cloud.microsoft",augloopOld:"https://augloop-dogfood.officeppe.com",centro:"https://admin-ignite.microsoft.com",ecs:"https://ecs.office.com",editor:"nleditor.osi.officeppe.net",editorSynonyms:"editor-edog-thesaurus.trafficmanager.net:9443",fs:"https://fs.microsoft.com",graph:"https://graph.microsoft.com",iris:"https://arc.msn.com",loki:"https://loki.delve.office.com",mru:"https://ocws-df.officeapps.live.com/ocs",ocps:"https://clients.config.office.net",outlook:"https://outlook.office.com",plannerNew:"https://planner.cloud.microsoft",plannerOld:"https://tasks.office.com",project:"https://project.microsoft.com",substrate:"https://substrate.office.com",teamsTasks:"https://retailservices.teams.microsoft.com",teams:"https://teams.microsoft.com",teamsWebTasks:"https://tasks.teams.microsoft.com",hubbleService:r,hubbleStorage:o,toDo:"https://to-do.office.com",roaming:"https://roaming.officeapps.live.com",roamingToken:"https://api.office.net",mruToken:"https://api.office.net",webPreviewer:"https://loop.usercontent.dev.microsoft"},h={aadAuthority:"https://login.microsoftonline.com",augloop:"https://dogfood.augloop.svc.cloud.microsoft",augloopOld:"https://augloop-dogfood.officeppe.com",centro:"https://admin-ignite.microsoft.com",ecs:"https://ecs.office.com",editor:"nleditor.osi.officeppe.net",editorSynonyms:"editor-edog-thesaurus.trafficmanager.net:9443",fs:"https://fs.microsoft.com",graph:"https://graph.microsoft.com",iris:"https://arc.msn.com",loki:"https://loki.delve.office.com",mru:"https://ocws-df.officeapps.live.com/ocs",ocps:"https://clients.config.office.net",outlook:"https://outlook.office.com",plannerNew:"https://planner.cloud.microsoft",plannerOld:"https://tasks.office.com",project:"https://project.microsoft.com",substrate:"https://substrate.office.com",teamsTasks:"https://retailservices.teams.microsoft.com",teams:"https://teams.microsoft.com",teamsWebTasks:"https://tasks.teams.microsoft.com",hubbleService:r,hubbleStorage:o,toDo:"https://to-do.office.com",roaming:"https://roaming.officeapps.live.com",roamingToken:"https://api.office.net",mruToken:"https://api.office.net",webPreviewer:"https://loop.usercontent.dev.microsoft"},f={aadAuthority:"https://login.microsoftonline.com",augloop:"https://dogfood.augloop.svc.cloud.microsoft",augloopOld:"https://augloop-dogfood.officeppe.com",centro:"https://admin-ignite.microsoft.com",ecs:"https://ecs.office.com",editor:"nleditor.osi.officeppe.net",editorSynonyms:"editor-edog-thesaurus.trafficmanager.net:9443",fs:"https://fs.microsoft.com",graph:"https://graph.microsoft.com",iris:"https://arc.msn.com",loki:"https://loki.delve.office.com",mru:"https://ocws-df.officeapps.live.com/ocs",ocps:"https://clients.config.office.net",outlook:"https://outlook.office.com",plannerNew:"https://planner.cloud.microsoft",plannerOld:"https://tasks.office.com",project:"https://project.microsoft.com",substrate:"https://substrate.office.com",teamsTasks:"https://retailservices.teams.microsoft.com",teams:"https://teams.microsoft.com",teamsWebTasks:"https://tasks.teams.microsoft.com",hubbleService:r,hubbleStorage:o,toDo:"https://to-do.office.com",roaming:"https://roaming-df.officeapps.live.com",roamingToken:"https://api.office.net",mruToken:"https://api.office.net",webPreviewer:"https://loop.usercontent.dev.microsoft"},g={aadAuthority:"https://login.microsoftonline.com",augloop:"https://augloop.svc.cloud.microsoft",augloopOld:"https://augloop.office.com",centro:"https://admin-ignite.microsoft.com",ecs:"https://ecs.office.com",editor:"nleditor.osi.office.net",editorSynonyms:"editor-prod-thesaurus.trafficmanager.net:9443",fs:"https://fs.microsoft.com",graph:"https://graph.microsoft.com",iris:"https://arc.msn.com",loki:"https://loki.delve.office.com",mru:"https://ocws.officeapps.live.com/ocs",ocps:"https://clients.config.office.net",outlook:"https://outlook.office.com",plannerNew:"https://planner.cloud.microsoft",plannerOld:"https://tasks.office.com",project:"https://project.microsoft.com",substrate:"https://substrate.office.com",teamsTasks:"https://retailservices.teams.microsoft.com",teams:"https://teams.microsoft.com",teamsWebTasks:"https://tasks.teams.microsoft.com",hubbleService:r,hubbleStorage:o,toDo:"https://to-do.office.com",roaming:"https://roaming.officeapps.live.com",roamingToken:"https://api.office.net",mruToken:"https://api.office.net",webPreviewer:"https://loop.usercontent.microsoft"},m={aadAuthority:"https://login.microsoftonline.com",augloop:"https://augloop.svc.cloud.microsoft",augloopOld:"https://augloop.office.com",centro:"https://admin-ignite.microsoft.com",ecs:"https://ecs.office.com",editor:"nleditor.osi.office.net",editorSynonyms:"editor-prod-thesaurus.trafficmanager.net:9443",fs:"https://fs.microsoft.com",graph:"https://graph.microsoft.com",iris:"https://arc.msn.com",loki:"https://loki.delve.office.com",mru:"https://ocws.officeapps.live.com/ocs",ocps:"https://clients.config.office.net",outlook:"https://outlook.office.com",plannerNew:"https://planner.cloud.microsoft",plannerOld:"https://tasks.office.com",project:"https://project.microsoft.com",substrate:"https://substrate.office.com",teamsTasks:"https://retailservices.teams.microsoft.com",teams:"https://teams.microsoft.com",teamsWebTasks:"https://tasks.teams.microsoft.com",hubbleService:r,hubbleStorage:o,toDo:"https://to-do.office.com",roaming:"https://roaming.officeapps.live.com",roamingToken:"https://api.office.net",mruToken:"https://api.office.net",webPreviewer:"https://loop.usercontent.microsoft"},v={aadAuthority:"https://login.chinacloudapi.cn",loki:"https://loki.office365.cn",graph:"https://microsoftgraph.chinacloudapi.cn",substrate:"https://substrate.partner.outlook.cn",outlook:"https://outlook.partner.outlook.cn",augloop:"https://augloop.microsoftonline.cn",augloopOld:"https://augloop.microsoftonline.cn",ocps:"",fs:"https://fs.microsoft.com",editor:"",editorSynonyms:"",mru:"https://ocws.officeapps.partner.office365.cn/ocs",ecs:"https://mooncake.ecs.office.com",project:"",teamsTasks:"",plannerOld:"",plannerNew:"",centro:"",iris:"",hubbleService:"",hubbleStorage:"",teams:"",teamsWebTasks:"",toDo:"",roaming:"https://roaming.officeapps.partner.office365.cn",roamingToken:"https://api.partner.office365.cn",mruToken:"https://api.partner.office365.cn",webPreviewer:""},y={aadAuthority:"https://login.sovcloud-identity.fr",loki:"https://fxgateway.svc.sovcloud.fr",graph:"https://graph.svc.sovcloud.fr",substrate:"https://substrate.svc.sovcloud.fr",outlook:"https://outlook.sovcloud.fr",augloop:"https://augloop.svc.sovcloud.fr",augloopOld:"https://augloop.svc.sovcloud.fr",ocps:"",fs:"https://fs.microsoft.com",editor:"nleditor.svc.sovcloud.fr",editorSynonyms:"",mru:"recent.svc.sovcloud.fr",ecs:"https://c2s.config.ecs.svc.sovcloud.fr",project:"",teamsTasks:"",plannerOld:"https://api.planner.svc.sovcloud.fr",plannerNew:"https://api.planner.svc.sovcloud.fr",centro:"",iris:"",teams:"https://teams.sovcloud.fr",teamsWebTasks:"",hubbleService:r,hubbleStorage:o,toDo:"",roaming:"",roamingToken:"",mruToken:"",webPreviewer:""};function b(e,t){switch(t){case"Local":return u[e];case"Automation":return d[e];case"Development":return p[e];case"Staging":return h[e];case"SyntheticTraffic":case"Dogfood":return f[e];case"Microsoft":return m[e];case"Preview":case"Production":return g[e];case"GCC":return a[e];case"GCC-High":return s[e];case"DoD":return i[e];case"USNat":return c[e];case"USSec":return l[e];case"Gallatin":return v[e];case"Bleu":return y[e];case"Delos":throw new Error(`Unsupported audience: ${t}`)}}},6797:(e,t,n)=>{"use strict";n.d(t,{m:()=>s});var r=n(1801),o=n(9361);const i=new Set;class s{constructor(e,t,n){this.activityName=e,this.logger=t,this.isAPerformanceMetric=!1,this.additionalPropsToLog=n?.additionalPropsToLog,this.addUserTiming=n?.addUserTiming,this.isAPerformanceMetric=n?.isAPerformanceMetric||!1,this.logSubactivityStartTimes=n?.logSubactivityStartTimes??!0,this.subActivities={},this.identifier=crypto.randomUUID(),this.activityStartName=`${this.activityName}-start-${this.identifier}`,this.activityEndName=`${this.activityName}-end-${this.identifier}`,this.addUserTiming&&performance.mark(this.activityStartName),this.startTime=performance.now(),this.startTimeSinceEpoch=Date.now()}static start(e,t,n){const r=new s(e,t,n);return i.add(r),r}markSubActivityStart(e){this.subActivities[e]={startTime:performance.now(),startTimeSinceEpoch:Date.now()},this.addUserTiming&&performance.mark(this.getSubActivityName(e,"start"))}markSubActivityEnd(e,t){const n=this.subActivities[e];if(!n)return;if(this.addUserTiming){const t=this.getSubActivityName(e,"end");performance.mark(t),performance.measure(e,this.getSubActivityName(e,"start"),t)}const r={[`durationMs_${e}`]:Math.round(performance.now()-n.startTime)};this.logSubactivityStartTimes&&(r[`startTime_${e}`]=n.startTimeSinceEpoch),this.additionalPropsToLog={...r,...this.additionalPropsToLog,...t}}setResult(e,t,n,r){this.logActivityResult(e,t,n,r?.skipLogging,void 0,r?.sampleEvent)}cancel(e,t,n){this.logActivityResult(e,t,n,!1,!0)}addAdditionalProps(e){this.additionalPropsToLog={...this.additionalPropsToLog,...e}}dispose(){this.cancel();const e=e=>performance.clearMarks(e),t=e=>performance.clearMeasures(e);if(this.addUserTiming){e(this.activityStartName),e(this.activityEndName),this.cachedMeasureName&&t(this.cachedMeasureName);for(const n in this.subActivities)e(this.getSubActivityName(n,"start")),e(this.getSubActivityName(n,"end")),t(n)}}logActivityResult(e,t,n,s,a,c){if(this.hasAlreadyResolved)return;this.hasAlreadyResolved=!0,this.addUserTiming&&performance.mark(this.activityEndName);const l=performance.now(),u=Math.round(l-this.startTime);if(this.isAPerformanceMetric){(window._pageTimings||(window._pageTimings={}))[this.activityName]=t?.durationMs?Number(t.durationMs):u}if(this.logger&&!s){const i={eventName:this.activityName,startTime:this.startTimeSinceEpoch,durationMs:u,succeeded:e,sampleEvent:c,resultType:a?r.Tp.Cancelled:e?r.Tp.Success:r.Tp.Failure,...this.additionalPropsToLog,...t};(0,o.IA)(this.logger,i,n)}this.logger=void 0,i.delete(this),this.addUserTiming&&performance.measure(this.generateMeasureName(e),this.activityStartName,this.activityEndName)}generateMeasureName(e){return this.cachedMeasureName=`${this.activityName}${!1===e?"-FAILED":""}-${this.identifier}`,this.cachedMeasureName}getSubActivityName(e,t){return`${e}-${t}-${this.identifier}`}}},9361:(e,t,n)=>{"use strict";n.d(t,{LJ:()=>F,IA:()=>N,hO:()=>P,Ot:()=>k,A$:()=>E});var r=n(488),o={contractName:"Ms.ProductUsage.Action",instanceName:"BaseType",getFields:function(e){var t=this.instanceName,n=[];return n.push((0,r.m9)("zC.".concat(t),this.contractName)),e.ver&&n.push((0,r.m9)("".concat(t,".Ver"),e.ver)),n.push((0,r.m9)("".concat(t,".Name"),e.name)),e.featureName&&n.push((0,r.m9)("".concat(t,".FeatureName"),e.featureName)),e.featureCategory&&n.push((0,r.m9)("".concat(t,".FeatureCategory"),e.featureCategory)),e.inputMethod&&n.push((0,r.m9)("".concat(t,".InputMethod"),e.inputMethod)),n.push((0,r.LK)("".concat(t,".IsExportable"),e.isExportable)),n.push((0,r.LK)("".concat(t,".IsIntentional"),e.isIntentional)),e.subWorkload&&n.push((0,r.m9)("".concat(t,".SubWorkload"),e.subWorkload)),e.target&&n.push((0,r.m9)("".concat(t,".Target"),e.target)),n}},i=n(1801),s=n(4457),a=n(9860);const c=["local.loop.microsoft.com","res.cdn.office.net","res-sdf.cdn.office.net","res.public.onecdn.static.microsoft","res.df.onecdn.static.microsoft"],l=/([A-Z0-9_]|\.|%2E){1,50}(@|_AT_|%40)([A-Z0-9_]{1,50}(\.|_|%2E))+((COM|ORG|GOV|EDU))/gi,u=/((^|[^A-Z])[A-Z]:|\\)(\\{0,1}\w+)+/gi,d=/(https?|ftp):\/\/[^\s]+/gi,p=/MICROSOFT|LINKEDIN/,h="InternalEmailAddress",f="ExternalEmailAddress",g=/WSACCESSKEYID|CCESS_TOKEN/,m=/SIGNATURE/,v=/<HTML>|{\RTF|MIME-VERSION|<ASP:/i;function y(e){const t=e.toUpperCase(),n=t.match(l);if(n)for(const e of n){return"Scrubbed_"+(p.test(e.toUpperCase())?h:f)}if(t.match(u))return"Scrubbed_Directory";if(g.test(t))return"Scrubbed_AccessToken";if(m.test(t))return"Scrubbed_Signature";if(v.test(t))return"Scrubbed_Content";let r=e;return r=r.replace(d,(e=>{try{const t=new URL(e);return c.some((e=>t.hostname.endsWith(e)))?t.origin+t.pathname:"Scrubbed_Url"}catch{return"Scrubbed_Url"}})),r}const b=/message|error|stack/i;function S(e){return-1!==e.search(b)||a.m7.includes(e)}function w(e,t){return function(e){if(void 0!==C)return C;const t=e.PersistedProperties;if("object"==typeof t&&"audience"in t&&"string"==typeof t.audience){const e=t.audience;return C="Local"===e||"Staging"===e||"Dogfood"===e,C}return C=!1,!1}(e)?function(e){for(const t in e){const n=e[t];S(t)&&"string"==typeof n&&(e[t]=y(n))}return e}(t):function(e){for(const t in e)if(S(t)){const n=e[t];if("string"==typeof n){const r=/\b([A-Z0-9.!#$%&'*+-/=?^_`{|}~]+@[A-Z0-9.-]+\.[A-Z]{2,4})\b|\b((?:https?|ftp):\/\/([^\/\s]+)[^\s]*)\b/gi;e[t]=n.replace(r,((e,t,n,r)=>t?"(scrubbed_email)":n&&!c.includes(r)?"(scrubbed_URL)":e))}}return e}(t)}let C;function E(e,t,n,r){if(t)switch(e){case i.hB.Generic:return k(t,n);case i.hB.Error:return P(t,n,r);case i.hB.Activity:return N(t,n,r);case i.hB.UserAction:return function(e,t,n){const r=t;if(n){const t=o.getFields(n);e.send({...r,dataFields:t,category:i.hB.UserAction})}else e.send({...r,category:i.hB.UserAction})}(t,n);default:return}}function k(e,t){const n=w(e,t);e.send({...n,category:i.hB.Generic})}function P(e,t,n){n&&D(t,n);const r=w(e,t);e.send({...r,category:i.hB.Error}),t.isUserImpacting&&A(e,r)}new Set,new Set,new Map([["Automation",1],["SyntheticTraffic",1],["Local",1],["Staging",1],["Dogfood",.1],["Preview",.1],["Microsoft",.01],["Production",.001],["GCC",0],["GCC-High",0],["DoD",0],["Gallatin",0]]);const T={Automation:!0,SyntheticTraffic:!0,Local:!0,Development:!0,Staging:!0,Dogfood:!0,Preview:!0,Microsoft:!0,Production:!1,GCC:!1,"GCC-High":!1,DoD:!1,USNat:!1,USSec:!1,Gallatin:!1,Bleu:!1,Delos:!1};function N(e,t,n){n&&D(t,n),t.resultType||void 0===t.succeeded||(t.resultType=t.succeeded?i.Tp.Success:i.Tp.Failure);const r=w(e,t);e.send({...r,category:i.hB.Activity}),t.resultType===i.Tp.Failure&&t.isUserImpacting&&A(e,r)}function A(e,t){let n=e;const r=n.getNamespace?.(),o=`${r}_${t.eventName}`;n=new s.p("ContainerSession",e),n.send({...t,errorAction:o,category:i.hB.Error})}const I=e=>"object"==typeof e&&null!==e;function O(e,t){if(!I(t))return;const n=t[e];return"string"==typeof n?n:void 0}function L(e){const t="string"==typeof e?e:void 0,n=O("errorType",e);return{message:t??O("message",e),errorMessage:t??O("errorMessage",e),errorName:O("name",e),stack:O("stack",e),errorType:n,errorInstanceId:O("errorInstanceId",e)}}function D(e,t){!function(e,t){const n=L(e);if(t.message=n.message??t.message,t.errorMessage=n.errorMessage??t.message,t.errorName=n.errorName,t.stack=n.stack??("string"==typeof t.stack?t.stack:void 0),t.errorType=n.errorType||t.errorType,t.errorInstanceId=n.errorInstanceId,a.m7.forEach((n=>{if(I(e)){const r=e[n];"boolean"!=typeof r&&"number"!=typeof r&&"string"!=typeof r&&void 0!==r||(t[n]=r),"object"==typeof r&&(t[n]=JSON.stringify(r))}})),"object"==typeof e&&e&&"cause"in e){const n=L(e.cause);t.causeMessage=n.message,t.causeStack=n.stack}}(t,e),e.message||(e.message=e.errorMessage),void 0===e.stack&&(e.stack=R())}function R(e){const t=Error.stackTraceLimit;void 0!==e&&(Error.stackTraceLimit=e);let n=(new Error).stack;if(!n)try{throw new Error}catch(e){n=e.stack}return Error.stackTraceLimit=t,n}function F(e){return T[e]}},4457:(e,t,n)=>{"use strict";n.d(t,{p:()=>r});class r{get NamespaceLogger(){return this}get PersistedProperties(){return this}get Disposable(){return this}dispose(){this.logger=null}constructor(e,t,n){if(this.namespace=e,t instanceof r){const e={...t.getPersistedProperties(),...n};this.logger=t.logger,this.persistedProperties=e}else this.logger=t,this.persistedProperties=n;this.baseLogger=t}addPersistedProperties(e){this.persistedProperties={...this.getPersistedProperties(),...e}}getPersistedProperties(){return{...this.baseLogger.PersistedProperties?.getPersistedProperties?.(),...this.persistedProperties}}send(e){this.sendWithNamespace(e,this.namespace)}sendWithNamespace(e,t){this.logger?.sendWithNamespace({...this.persistedProperties,...e},t)}getNamespace(){return this.namespace}}},7096:(e,t,n)=>{"use strict";n.d(t,{R:()=>o});var r=n(488);const o=(e,t)=>{const n=function(e){const{value:t,tag:n}=null!==e&&"object"==typeof e?e:{value:e,tag:void 0};switch(n){case void 0:case"PackageData":case"CodeArtifact":return t;case"UserData":return"REDACTED (tag: UserData)";default:return`REDACTED (tag: ${n})`}}(e);if(void 0!==n)return"string"==typeof n?(0,r.m9)(t,n):"number"==typeof n?(0,r.ip)(t,n):(0,r.LK)(t,n)}},9860:(e,t,n)=>{"use strict";n.d(t,{bT:()=>o,m7:()=>r});const r=["facetCodes","statusCode","innerMostErrorCode","sprequestguid"],o="containerCodeDetailsName"},9011:(e,t,n)=>{"use strict";n.d(t,{Fr:()=>l});const r=()=>"undefined"==typeof window;let o,i,s;const a=function(){return void 0===o&&(o=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document),o},c=function(){if(void 0===i){const e=navigator.userAgentData;i=e?.platform?"Android"===e.platform:navigator.userAgent.indexOf("Android")>=0}return i},l=function(){if(r())return!1;if(void 0===s){const e=navigator.userAgentData;if(e?.mobile)return!0;s=/Android|BlackBerry|Windows Phone|IEMobile|Opera Mini|iPhone|iPad|iPod/i.test(navigator.userAgent)||a()||c()}return s}},5439:(e,t,n)=>{"use strict";function r(e,t,n){e.headers instanceof Headers?e.headers.set(t,n):e.headers={...e.headers,[t]:n}}n.d(t,{y:()=>p,g:()=>h});const o="Bearer";var i=n(4506),s=n(9176),a=n(1432);var c=n(9361),l=n(8994);function u(){return"undefined"!=typeof performance?performance.now():Date.now()}function d(e){return{tenantId:e.tenantId,request:{url:e.url,method:e.requestInit?.method?e.requestInit.method:"GET"}}}function p(e){return g(e,d(e))}function h(e){return g(e,d(e))}const f=3;async function g(e,t,n=1){const c=e.retryPolicy?.maxAuthRetries??f,d=u(),{token:p,authorizationHeader:h}=await e.getToken(t),v=u(),{url:y,requestInit:b,retryPolicy:S,timeoutMs:w,tokenPolicy:C,additionalRequestHeaders:E}=e,{url:k,request:P}=function(e,t,n,i,s){const a=new URL(e),c=i.startsWith(o);let l=!1;c&&s.queryParam&&(a.searchParams.set(s.queryParam,n),l=!s.doNotExceedQueryParamsLength||a.search.length<=s.doNotExceedQueryParamsLength,l||a.searchParams.delete(s.queryParam));let u=t;if(!l){u={...t};let e=!1;if(c){const n=t?.method?t.method.toUpperCase():"GET";if(s.preferAuthorizationInMultipartFormBody&&["GET","POST"].includes(n)){u.method="POST";const o=crypto.randomUUID(),c=[];c.push(`--${o}`),c.push(`Authorization: ${i}`),c.push(`X-HTTP-Method-Override: ${n}`),c.push("_post: 1"),t?.body&&c.push(`\r\n${t.body}\r\n`),c.push(`\r\n--${o}--`);const l=c.join("\r\n");e=!s.doNotExceedMultipartFormBodyLength||l.length<=s.doNotExceedMultipartFormBodyLength,e&&(u.body=l,r(u,"Content-Type",`multipart/form-data;boundary=${o}`),a.searchParams.set("ump","1"))}}e||r(u,"Authorization",i)}return{url:a.href,request:u}}(y,b,p,h||`${o} ${p}`,C||{});E&&P&&E.forEach(((e,t)=>{(0,l._)(P,t,e)}));const T=e=>401===e.status&&function(e){const t=e.get("www-authenticate");if(!t)return;let n,r=!1;return t.split(",").map((e=>{const t=e.split("=");if(t.length>=2)if(r||"error"!==t[0].trim().toLowerCase()){if(!n&&"claims"===t[0].trim().toLowerCase()){const t=(0,a.X)(e.substring(e.indexOf("=")+1).trim());t&&(n=atob(t))}}else r="insufficient_claims"===(0,a.X)(t[1].trim().toLowerCase())})),r?n:void 0}(e.headers)||void 0,N=e=>401===e.status&&void 0!==function(e){const t=e.get("www-authenticate");if(!t)return;let n,r=!1;for(const e of t.split(",")){const t=e.split("=");t.length>=2&&(r||"error"!==t[0].trim().toLowerCase()?void 0===n&&"error_description"===t[0].trim().toLowerCase()&&(n=(0,a.X)(t[1].trim())):r="invalid_token"===(0,a.X)(t[1].trim().toLowerCase()))}return r?{errorDescription:n}:void 0}(e.headers)||void 0,A=e=>{if(401===e.status){const n=function(e){const t=e.get("www-authenticate");if(!t)return;const n=t.indexOf(o);if(n<0)return;let r;return t.substring(n+o.length).split(",").map((e=>{if(!r){const t=e.split("=");t.length>=2&&"realm"===t[0].trim().toLowerCase()&&(r=JSON.parse(t[1].trim()))}})),r}(e.headers);if(n&&n!==t.tenantId)return n}};let I,O;if(S&&(I={...S,filter:e=>!T(e)&&!N(e)&&!A(e)&&S.filter(e)}),"logger"in e&&"nameForLogging"in e){const t=async(t,n)=>{const r=await(e.getAdditionalProps?.(t,n));return{tokenFetchDurationMs:Math.round(v-d),...r}};O=await(0,s.R)(k,P,e.nameForLogging,e.logger,e.doNotLogOnSuccess,I,w,t)}else O=await(0,i.J5)(k,P,I,w);if(n<=c){const r=n===c,o=T(O.result);if(o)return m(e,"InsufficientClaims",n,r),g(e,{...t,claims:o,forceRefresh:!0},n+1);if(N(O.result))return m(e,"InvalidToken",n,r),g(e,{...t,forceRefresh:!0},n+1);const i=A(O.result);if(i)return m(e,"SpecificTenant",n,r),g(e,{...t,tenantId:i},n+1)}return O}function m(e,t,n,r){"logger"in e&&"nameForLogging"in e&&(0,c.Ot)(e.logger,{eventName:`Retry${e.nameForLogging}OnAuthError`,subCategory:t,attempt:n,isFinalAttempt:r})}},401:(e,t,n)=>{"use strict";n.d(t,{u:()=>o});const r=[{headerName:"sprequestguid",logName:"spRequestGuid"},{headerName:"request-id",logName:"requestId"},{headerName:"client-request-id",logName:"clientRequestId"},{headerName:"x-msedge-ref",logName:"xMsedgeRef"}];function o(e){const t={};return e?.headers&&r.forEach((n=>{const r=e.headers.get(n.headerName);r&&(t[n.logName]=r)})),t}},2150:(e,t,n)=>{"use strict";function r(e){return new URL(e).origin}n.d(t,{$:()=>r})},8994:(e,t,n)=>{"use strict";function r(e,t,n){if(void 0===e.headers){const r=new Headers;r.set(t,n),e.headers=r}else if(e.headers instanceof Headers)e.headers.has(t)||e.headers.set(t,n);else if(Array.isArray(e.headers)){for(let n=0;n<e.headers.length;n+=1)if(e.headers[n][0]===t)return;e.headers=[...e.headers,[t,n]]}else e.hasOwnProperty("headers")&&(e.headers={[t]:n,...e.headers})}function o(e,t){if(e.headers instanceof Headers)return e.headers.get(t)??void 0;if(Array.isArray(e.headers)){const n=e.headers.find((e=>e[0]===t));return n?n[1]:void 0}return e.hasOwnProperty("headers")&&"object"==typeof e.headers?e.headers[t]:void 0}n.d(t,{Y:()=>o,_:()=>r})},9176:(e,t,n)=>{"use strict";n.d(t,{R:()=>i});var r=n(4506),o=n(9361);function i(e,t,n,o,i,a,c=0,l){return(0,r.J5)(e,t,a,c).then((async e=>o&&n?((!i&&e.result.ok||!e.result.ok)&&await s(n,!0,e.result,e.tries.length+1,o,l),await Promise.all(e.tries.map((async(e,t)=>await s(n,!1,e,t+1,o,l)))),e):e))}async function s(e,t,n,r,i,s){const a=s&&await s(n,t).catch((()=>({getAdditionalPropsError:!0})));(0,o.Ot)(i,{subCategory:"Request",eventName:e,isFinalAttempt:t,status:n.status,durationMs:n.durationMs,size:n.headers?.get("Content-Length")||-1,attempt:r,...a})}},8831:(e,t,n)=>{"use strict";n.d(t,{OF:()=>c,g2:()=>u});var r=n(2150),o=n(5439),i=n(401),s=n(108),a=n(9361);new Map;async function c(e,t,n,r,o,i,s){return l(e,t,n,r,void 0,o,i,s)}async function l(e,t,n,c,l,u,d,p){const h=(0,r.$)(t),f=void 0!==l?`:/${encodeURIComponent(l)}:/`:"",g={getToken:r=>{if(r){const o={...r,siteUrl:t,driveId:n,itemId:c};return e.getToken([`${h}/files.readwrite.all`],o)}throw Error("Options must be specified")},url:`${h}/_api/v2.0/drives/${n}/items/${c}${f}/?select=webUrl,webDavUrl,name,sharepointIds,parentReference,title`,tenantId:d,requestInit:{method:"GET",signal:p},retryPolicy:s._9,tokenPolicy:(0,s.N$)(e)},m=u?(0,o.g)({...g,logger:u,nameForLogging:"GetFileItemLite",doNotLogOnSuccess:!0,getAdditionalProps:async(e,t)=>(0,i.u)(e)}):(0,o.y)(g);let v;try{v=(await m).result}catch{}if(v?.ok)try{return await v.json()}catch(e){u&&(0,a.hO)(u,{eventName:"GetFileItemLiteResponseParseError"},e)}}const u=e=>"driveId"in e&&"siteUrl"in e&&"itemId"in e},108:(e,t,n)=>{"use strict";n.d(t,{N$:()=>c,_9:()=>i});var r=n(7394),o=n(4506);const i={maxRetries:2,backoffFn:(0,r.FT)(500),filter:(0,o.sC)([408,409,503]),respectRetryAfterHeader:!0},s={queryParam:"access_token",doNotExceedQueryParamsLength:2048,preferAuthorizationInMultipartFormBody:!0,doNotExceedMultipartFormBodyLength:81920},a={preferAuthorizationInMultipartFormBody:!0,doNotExceedMultipartFormBodyLength:81920};function c(e,t=!0){return{..."Consumer"===e.identityType?a:s,preferAuthorizationInMultipartFormBody:t}}},1432:(e,t,n)=>{"use strict";n.d(t,{X:()=>o});var r=n(9361);function o(e,t,n){try{return JSON.parse(e,t)}catch(e){return void(n&&(0,r.hO)(n.logger,n.event,e))}}},9628:(e,t,n)=>{"use strict";n.d(t,{AU:()=>u});var r=n(1432),o=n(2477),i=n(5531);const s=new Map;function a(e,t){const n=function(e,t){const n=s.get(e);if(void 0!==n)return n;let r,a,l,u;u=void 0!==(r=function(e){const t=i.f.get(e);return c(t)}(e))?r:void 0!==(a=function(e){const t=(0,o.A)()?.getItem(e);return c(t)}(e))?a:void 0!==(l=function(e){const t=(0,o.R)()?.getItem(e);return c(t)}(e))?l:t;return s.set(e,u),u}(e,t);return n}function c(e){if(null!=e){const t=(0,r.X)(e),n=void 0!==t?t:e;return"on"===n||"off"===n?"on"===n:n}}function l(e,t,n,r){return n?n.getSetting(e,t,r):a(e,t)}const u=(e,t,n)=>l(e,t,n,"FluidExperiences")},2477:(e,t,n)=>{"use strict";let r,o;n.d(t,{A:()=>i,R:()=>s});try{localStorage.getItem("__storage_test__"),r=localStorage}catch{r=void 0}try{sessionStorage.getItem("__storage_test__"),o=sessionStorage}catch{o=void 0}function i(){return r}function s(){return o}},5531:(e,t,n)=>{"use strict";n.d(t,{f:()=>r});const r=new URLSearchParams("undefined"!=typeof location?location.search:"")},5927:(e,t,n)=>{"use strict";n.d(t,{EW:()=>f,Il:()=>u,KJ:()=>d,Kz:()=>b,Nn:()=>m,OD:()=>c,ay:()=>h,qw:()=>g,rh:()=>p});var r=n(488);function o(e,t){return e?e+"."+t:t}function i(e,t,n,i,s){void 0===s&&(s=4),i&&e.push((0,r.m9)("".concat(o(t,n)),i,s))}function s(e,t,n,i){"boolean"==typeof i&&e.push((0,r.LK)("".concat(o(t,n)),i))}function a(e,t,n,i){"number"==typeof i&&e.push((0,r.Ug)("".concat(o(t,n)),i))}var c,l=function(e){var t="Activity.Result",n=[];return a(n,t,"Code",e.code),i(n,t,"Type",e.type),a(n,t,"Tag",e.tag),s(n,t,"IsExpected",e.isExpected),n.push((0,r.m9)("zC.Activity.Result","Office.System.Result")),n},u={contractName:"Office.System.Activity",getFields:function(e){var t="Activity",n=[];return i(n,t,"CV",e.cV),a(n,t,"Duration",e.duration),a(n,t,"Count",e.count),a(n,t,"AggMode",e.aggMode),s(n,t,"Success",e.success),e.result&&n.push.apply(n,l(e.result)),n.push((0,r.m9)("zC.Activity",this.contractName)),n}},d={getFields:function(e){var t="User",n=[];return i(n,t,"PrimaryIdentityHash",e.primaryIdentityHash),i(n,t,"PrimaryIdentitySpace",e.primaryIdentitySpace),i(n,t,"TenantId",e.tenantId,1),i(n,t,"TenantGroup",e.tenantGroup,1),s(n,t,"IsAnonymous",e.isAnonymous),s(n,t,"IsSignedIn",e.isSignedIn),n}},p={getFields:function(e,t){var n=[];return i(n,e,"Name",t.name),i(n,e,"State",t.state),n}},h={getFields:function(e){var t="UserAction",n=[];return a(n,t,"Id",e.id),i(n,t,"Name",e.name),i(n,t,"CommandSurface",e.commandSurface),i(n,t,"ParentName",e.parentName),i(n,t,"TriggerMethod",e.triggerMethod),a(n,t,"TimeOffsetMs",e.timeOffsetMs),n}};!function(e){e.Web="Web",e.Desktop="Desktop",e.Universal="Universal",e.Mobile="Mobile",e.Win32="Win32",e.iOS="iOS",e.Android="Android"}(c||(c={}));var f,g={getFields:function(e){var t="App",n=[];return i(n,t,"Name",e.name,1),i(n,t,"Platform",e.platform,1),i(n,t,"Version",e.version,1),n}},m={getFields:function(e){var t="Session",n=[];return i(n,t,"Id",e.id,1),i(n,t,"EcsETag",e.ecsETag,1),n}};!function(e){e.Automation="Automation",e.Dogfood="Dogfood",e.Microsoft="Microsoft",e.Insiders="Insiders",e.Production="Production"}(f||(f={}));var v,y,b={getFields:function(e){var t=[];return i(t,"Release","AudienceGroup",e.audienceGroup,1),t}};!function(e){var t="Copilot";!function(e){e.IsEnabled="IsEnabled",e.IsSeen="IsSeen",e.IsTried="IsTried",e.IsKept="IsKept",e.IsRejected="IsRejected"}(e.FeatureActionType||(e.FeatureActionType={})),function(e){e.ContentGeneration="Content Generation",e.Commanding="Commanding",e.QAandSummaries="QA and Summaries",e.Collaboration="Collaboration",e.Suggestions="Suggestions"}(e.Capability||(e.Capability={})),function(e){e.Chat="Chat",e.Canvas="Canvas"}(e.EntryPoint||(e.EntryPoint={})),function(e){e.Create="Create",e.Command="Command",e.Ask="Ask",e.Summarize="Summarize",e.Share="Share",e.Analyze="Analyze"}(e.Verb||(e.Verb={})),e.getFields=function(e){var n=[];return i(n,t,"FeatureActionType",e.featureActionType),s(n,t,"IsUserInitiated",e.isUserInitiated),i(n,t,"FeatureName",e.featureName),i(n,t,"SubFeatureName",e.subFeatureName),i(n,t,"Capability",e.capability),s(n,t,"IsThumbsUp",e.isThumbsUp),i(n,t,"EntryPoint",e.entryPoint),i(n,t,"Verb",e.verb),i(n,t,"InteractionId",e.interactionId),i(n,t,"ConversationId",e.conversationId),n.push((0,r.m9)("zC.".concat(t),"Office.System.Copilot")),n}}(v||(v={})),function(e){var t="Asha";!function(e){e.Pillar="Pillar",e.Error="Error"}(e.EventType||(e.EventType={})),e.getFields=function(e){var n=[];return i(n,t,"EventType",e.eventType),i(n,t,"Pillar",e.pillar),i(n,t,"Scenario",e.scenario),i(n,t,"Veto",e.veto),i(n,t,"Error",e.error),s(n,t,"InStaging",e.inStaging),s(n,t,"IsSessionEndingError",e.isSessionEndingError),s(n,t,"IsIntentional",e.isIntentional),s(n,t,"IsInternal",e.isInternal),n.push((0,r.m9)("zC.".concat(t),"Office.System.Asha")),n}}(y||(y={}))},488:(e,t,n)=>{"use strict";function r(e,t,n){return a(e,1,t,n)}function o(e,t,n){return a(e,2,t,n)}function i(e,t,n){return a(e,3,t,n)}function s(e,t,n){return a(e,0,t,n)}function a(e,t,n,r){return{name:e,dataType:t,value:n,classification:r||4}}n.d(t,{LK:()=>r,Ug:()=>o,ip:()=>i,m9:()=>s})},8170:(e,t,n)=>{"use strict";n.d(t,{d$:()=>i,vV:()=>a,wC:()=>s});var r,o=(r=[],{fireEvent:function(e){r.forEach((function(t){return t(e)}))},addListener:function(e){e&&r.push(e)}});function i(){return o}function s(e,t,n){o.fireEvent({level:e,category:t,message:n})}function a(e,t,n){s(0,e,(function(){var e=n instanceof Error?n.message:"";return"".concat(t,": ").concat(e)}))}},5738:(e,t,n)=>{"use strict";n.d(t,{GV:()=>b,di:()=>v,EY:()=>y});var r=n(2065),o=n(8170),i={};function s(e,t){"Office."===e.substring(0,7)&&"."!==e[e.length-1]?i[e]?(t.ariaTenantToken&&(i[e].ariaTenantToken=t.ariaTenantToken),t.dnmToken&&(i[e].dnmToken=t.dnmToken)):i[e]=t:(0,o.wC)(0,0,(function(){return"Namespace: ".concat(e)}))}function a(e,t){for(var n=e.length;n>0;){var r=e.substr(0,n);if(i[r]){var o=i[r];return t.ariaTenantToken=o.ariaTenantToken,t.dnmToken=o.dnmToken,!0}n=e.lastIndexOf(".",n-1)}return!1}var c=9007199254740991,l=-c,u=98,d=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,p=/^[a-zA-Z0-9_\.]{1,95}$/;function h(e){if(!function(e){if(!e||e.length>u)return!1;return d.test(e)}(e.eventName))throw new Error("Invalid eventName");var t=e.eventContract;if(t){if(t.name&&!f(t.name))throw new Error("Invalid eventContract");g(t.dataFields)}g(e.dataFields)}function f(e){return p.test(e)}function g(e){e&&e.forEach((function(e){if("string"!=typeof e.name||!f(e.name))throw new Error("Invalid dataField name");2===e.dataType&&function(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<l||e>c)throw new Error("Invalid integer ".concat(JSON.stringify(e)))}(e.value)}))}var m=n(488),v=-1;function y(e){var t={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?(0,r.Cl)({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp||(new Date).getTime()};return e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t}var b=function(){function e(e,t,n){var o,i,s;this.telemetrySinks=[],this.persistentDataFields=[],this.partAFields=[],this.eventQueue=[],this.config=n||{},e&&(this.telemetrySinks=e.telemetrySinks,(o=this.persistentDataFields).push.apply(o,e.persistentDataFields),this.config=(0,r.Cl)((0,r.Cl)({},e.getConfig()),this.config),(i=this.partAFields).push.apply(i,e.partAFields)),t&&(s=this.persistentDataFields).push.apply(s,t)}return e.prototype.addEventContentType=function(e,t){e.push((0,m.Ug)("EventContent.Type",t))},e.prototype.sendTelemetryEvent=function(e){var t=y(e),n=t.telemetryProperties;n.nexusTenantToken=v;var r=n.ariaTenantToken;if(!r&&(!a(t.eventName,n)&&!r))return void(0,o.wC)(0,0,(function(){return"No tenant token: "+e.eventName}));this.sendTelemetryEventInternal(t,1)},e.prototype.sendNonStandardEvent=function(e,t){var n=y(e);this.sendTelemetryEventInternal(n,t)},e.prototype.sendCustomerContent=function(e){var t=y(e),n=t.telemetryProperties,r=n.customerContentVersion;return(!r||r>2)&&(n.customerContentVersion=2),n.ariaTenantToken=void 0,n.nexusTenantToken=void 0,n.dnmToken=void 0,this.addEventContentType(t.dataFields,2),this.sendTelemetryEventInternal(t,2)},e.prototype.sendDirectNumericEvent=function(e){var t=y(e),n=t.telemetryProperties;if(!n.dnmToken&&(!a(t.eventName,n)&&!n.dnmToken))return void(0,o.wC)(0,0,(function(){return"No dnm token: "+t.eventName}));this.addEventContentType(t.dataFields,1),this.sendTelemetryEventInternal(t,3)},e.prototype.sendTelemetryEventInternal=function(e,t){if(2===t||!e.telemetryProperties.customerContentVersion&&!e.telemetryProperties.customerContentType){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push([e,t]):(0,o.wC)(1,0,(function(){return"No telemetry sinks are attached."})));this.processTelemetryEvent(e,t)}catch(e){return void(0,o.vV)(0,"SendTelemetryEvent",e)}this.telemetrySinks.forEach((function(n){try{3===t||2===t?n.sendNonStandardEvent&&n.sendNonStandardEvent(e,t):n.sendTelemetryEvent(e)}catch(e){}}))}else(0,o.wC)(0,0,(function(){return"Customer content"}))},e.prototype.processTelemetryEvent=function(e,t){var n,r,o;if(e.dataFields&&(null===(o=e.dataFields)||void 0===o||o.unshift((0,m.m9)("OTelJS.Version","4.20.30")),3!==t&&this.persistentDataFields&&(n=e.dataFields).unshift.apply(n,this.persistentDataFields)),this.partAFields.length>0){var i=e.eventContract||{name:"",dataFields:[]};(r=i.dataFields).push.apply(r,this.partAFields),e.eventContract=i}this.config.disableValidation||h(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e),this.flushQueue()},e.prototype.flushQueue=function(){var e=this.eventQueue;if(this.eventQueue=[],this.telemetrySinks.length>0)for(var t=0,n=e;t<n.length;t++){var r=n[t],o=r[0],i=r[1];this.sendTelemetryEventInternal(o,i)}},e.prototype.setTenantToken=function(e,t,n){s(e,{ariaTenantToken:t,nexusTenantToken:n})},e.prototype.setDNMToken=function(e,t){s(e,{dnmToken:t})},e.prototype.cloneEvent=function(e){return y(e)},e.prototype.getConfig=function(){return this.config},e}()},1575:(e,t,n)=>{"use strict";var r=n(7131),o=n(9307);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,s=void 0,s=function(e,t){if("object"!==i(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===i(s)?s:String(s)),r)}var o,s}function a(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var c,l,u=n(9748).codes,d=u.ERR_AMBIGUOUS_ARGUMENT,p=u.ERR_INVALID_ARG_TYPE,h=u.ERR_INVALID_ARG_VALUE,f=u.ERR_INVALID_RETURN_VALUE,g=u.ERR_MISSING_ARGS,m=n(3155),v=n(1747).inspect,y=n(1747).types,b=y.isPromise,S=y.isRegExp,w=n(7072)(),C=n(1140)(),E=n(715)("RegExp.prototype.test");new Map;function k(){var e=n(4818);c=e.isDeepEqual,l=e.isDeepStrictEqual}var P=!1,T=e.exports=O,N={};function A(e){if(e.message instanceof Error)throw e.message;throw new m(e)}function I(e,t,n,r){if(!n){var o=!1;if(0===t)o=!0,r="No value argument passed to `assert.ok()`";else if(r instanceof Error)throw r;var i=new m({actual:n,expected:!0,message:r,operator:"==",stackStartFn:e});throw i.generatedMessage=o,i}}function O(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];I.apply(void 0,[O,t.length].concat(t))}T.fail=function e(t,n,i,s,a){var c,l=arguments.length;if(0===l)c="Failed";else if(1===l)i=t,t=void 0;else{if(!1===P)P=!0,(r.emitWarning?r.emitWarning:o.warn.bind(o))("assert.fail() with more than one argument is deprecated. Please use assert.strictEqual() instead or only pass a message.","DeprecationWarning","DEP0094");2===l&&(s="!=")}if(i instanceof Error)throw i;var u={actual:t,expected:n,operator:void 0===s?"fail":s,stackStartFn:a||e};void 0!==i&&(u.message=i);var d=new m(u);throw c&&(d.message=c,d.generatedMessage=!0),d},T.AssertionError=m,T.ok=O,T.equal=function e(t,n,r){if(arguments.length<2)throw new g("actual","expected");t!=n&&A({actual:t,expected:n,message:r,operator:"==",stackStartFn:e})},T.notEqual=function e(t,n,r){if(arguments.length<2)throw new g("actual","expected");t==n&&A({actual:t,expected:n,message:r,operator:"!=",stackStartFn:e})},T.deepEqual=function e(t,n,r){if(arguments.length<2)throw new g("actual","expected");void 0===c&&k(),c(t,n)||A({actual:t,expected:n,message:r,operator:"deepEqual",stackStartFn:e})},T.notDeepEqual=function e(t,n,r){if(arguments.length<2)throw new g("actual","expected");void 0===c&&k(),c(t,n)&&A({actual:t,expected:n,message:r,operator:"notDeepEqual",stackStartFn:e})},T.deepStrictEqual=function e(t,n,r){if(arguments.length<2)throw new g("actual","expected");void 0===c&&k(),l(t,n)||A({actual:t,expected:n,message:r,operator:"deepStrictEqual",stackStartFn:e})},T.notDeepStrictEqual=function e(t,n,r){if(arguments.length<2)throw new g("actual","expected");void 0===c&&k();l(t,n)&&A({actual:t,expected:n,message:r,operator:"notDeepStrictEqual",stackStartFn:e})},T.strictEqual=function e(t,n,r){if(arguments.length<2)throw new g("actual","expected");C(t,n)||A({actual:t,expected:n,message:r,operator:"strictEqual",stackStartFn:e})},T.notStrictEqual=function e(t,n,r){if(arguments.length<2)throw new g("actual","expected");C(t,n)&&A({actual:t,expected:n,message:r,operator:"notStrictEqual",stackStartFn:e})};var L=a((function e(t,n,r){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n.forEach((function(e){e in t&&(void 0!==r&&"string"==typeof r[e]&&S(t[e])&&E(t[e],r[e])?o[e]=r[e]:o[e]=t[e])}))}));function D(e,t,n,r){if("function"!=typeof t){if(S(t))return E(t,e);if(2===arguments.length)throw new p("expected",["Function","RegExp"],t);if("object"!==i(e)||null===e){var o=new m({actual:e,expected:t,message:n,operator:"deepStrictEqual",stackStartFn:r});throw o.operator=r.name,o}var s=Object.keys(t);if(t instanceof Error)s.push("name","message");else if(0===s.length)throw new h("error",t,"may not be an empty object");return void 0===c&&k(),s.forEach((function(o){"string"==typeof e[o]&&S(t[o])&&E(t[o],e[o])||function(e,t,n,r,o,i){if(!(n in e)||!l(e[n],t[n])){if(!r){var s=new L(e,o),a=new L(t,o,e),c=new m({actual:s,expected:a,operator:"deepStrictEqual",stackStartFn:i});throw c.actual=e,c.expected=t,c.operator=i.name,c}A({actual:e,expected:t,message:r,operator:i.name,stackStartFn:i})}}(e,t,o,n,s,r)})),!0}return void 0!==t.prototype&&e instanceof t||!Error.isPrototypeOf(t)&&!0===t.call({},e)}function R(e){if("function"!=typeof e)throw new p("fn","Function",e);try{e()}catch(e){return e}return N}function F(e){return b(e)||null!==e&&"object"===i(e)&&"function"==typeof e.then&&"function"==typeof e.catch}function M(e){return Promise.resolve().then((function(){var t;if("function"==typeof e){if(!F(t=e()))throw new f("instance of Promise","promiseFn",t)}else{if(!F(e))throw new p("promiseFn",["Function","Promise"],e);t=e}return Promise.resolve().then((function(){return t})).then((function(){return N})).catch((function(e){return e}))}))}function x(e,t,n,r){if("string"==typeof n){if(4===arguments.length)throw new p("error",["Object","Error","Function","RegExp"],n);if("object"===i(t)&&null!==t){if(t.message===n)throw new d("error/message",'The error message "'.concat(t.message,'" is identical to the message.'))}else if(t===n)throw new d("error/message",'The error "'.concat(t,'" is identical to the message.'));r=n,n=void 0}else if(null!=n&&"object"!==i(n)&&"function"!=typeof n)throw new p("error",["Object","Error","Function","RegExp"],n);if(t===N){var o="";n&&n.name&&(o+=" (".concat(n.name,")")),o+=r?": ".concat(r):".";var s="rejects"===e.name?"rejection":"exception";A({actual:void 0,expected:n,operator:e.name,message:"Missing expected ".concat(s).concat(o),stackStartFn:e})}if(n&&!D(t,n,r,e))throw t}function _(e,t,n,r){if(t!==N){if("string"==typeof n&&(r=n,n=void 0),!n||D(t,n)){var o=r?": ".concat(r):".",i="doesNotReject"===e.name?"rejection":"exception";A({actual:t,expected:n,operator:e.name,message:"Got unwanted ".concat(i).concat(o,"\n")+'Actual message: "'.concat(t&&t.message,'"'),stackStartFn:e})}throw t}}function U(e,t,n,r,o){if(!S(t))throw new p("regexp","RegExp",t);var s="match"===o;if("string"!=typeof e||E(t,e)!==s){if(n instanceof Error)throw n;var a=!n;n=n||("string"!=typeof e?'The "string" argument must be of type string. Received type '+"".concat(i(e)," (").concat(v(e),")"):(s?"The input did not match the regular expression ":"The input was expected to not match the regular expression ")+"".concat(v(t),". Input:\n\n").concat(v(e),"\n"));var c=new m({actual:e,expected:t,message:n,operator:o,stackStartFn:r});throw c.generatedMessage=a,c}}function j(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];I.apply(void 0,[j,t.length].concat(t))}T.throws=function e(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];x.apply(void 0,[e,R(t)].concat(r))},T.rejects=function e(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return M(t).then((function(t){return x.apply(void 0,[e,t].concat(r))}))},T.doesNotThrow=function e(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];_.apply(void 0,[e,R(t)].concat(r))},T.doesNotReject=function e(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return M(t).then((function(t){return _.apply(void 0,[e,t].concat(r))}))},T.ifError=function e(t){if(null!=t){var n="ifError got unwanted exception: ";"object"===i(t)&&"string"==typeof t.message?0===t.message.length&&t.constructor?n+=t.constructor.name:n+=t.message:n+=v(t);var r=new m({actual:t,expected:null,operator:"ifError",message:n,stackStartFn:e}),o=t.stack;if("string"==typeof o){var s=o.split("\n");s.shift();for(var a=r.stack.split("\n"),c=0;c<s.length;c++){var l=a.indexOf(s[c]);if(-1!==l){a=a.slice(0,l);break}}r.stack="".concat(a.join("\n"),"\n").concat(s.join("\n"))}throw r}},T.match=function e(t,n,r){U(t,n,r,e,"match")},T.doesNotMatch=function e(t,n,r){U(t,n,r,e,"doesNotMatch")},T.strict=w(j,T,{equal:T.strictEqual,deepEqual:T.deepStrictEqual,notEqual:T.notStrictEqual,notDeepEqual:T.notDeepStrictEqual}),T.strict.strict=T.strict},3155:(e,t,n)=>{"use strict";var r=n(7131);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return(t=c(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!==m(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==m(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===m(t)?t:String(t)}function l(e,t){if(t&&("object"===m(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return u(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e){var t="function"==typeof Map?new Map:void 0;return d=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return p(e,arguments,g(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),f(r,e)},d(e)}function p(e,t,n){return p=h()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&f(o,n.prototype),o},p.apply(null,arguments)}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}function g(e){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},g(e)}function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}var v=n(1747).inspect,y=n(9748).codes.ERR_INVALID_ARG_TYPE;function b(e,t,n){return(void 0===n||n>e.length)&&(n=e.length),e.substring(n-t.length,n)===t}var S="",w="",C="",E="",k={deepStrictEqual:"Expected values to be strictly deep-equal:",strictEqual:"Expected values to be strictly equal:",strictEqualObject:'Expected "actual" to be reference-equal to "expected":',deepEqual:"Expected values to be loosely deep-equal:",equal:"Expected values to be loosely equal:",notDeepStrictEqual:'Expected "actual" not to be strictly deep-equal to:',notStrictEqual:'Expected "actual" to be strictly unequal to:',notStrictEqualObject:'Expected "actual" not to be reference-equal to "expected":',notDeepEqual:'Expected "actual" not to be loosely deep-equal to:',notEqual:'Expected "actual" to be loosely unequal to:',notIdentical:"Values identical but not reference-equal:"};function P(e){var t=Object.keys(e),n=Object.create(Object.getPrototypeOf(e));return t.forEach((function(t){n[t]=e[t]})),Object.defineProperty(n,"message",{value:e.message}),n}function T(e){return v(e,{compact:!1,customInspect:!1,depth:1e3,maxArrayLength:1/0,showHidden:!1,breakLength:1/0,showProxy:!1,sorted:!0,getters:!0})}function N(e,t,n){var o="",i="",s=0,a="",c=!1,l=T(e),u=l.split("\n"),d=T(t).split("\n"),p=0,h="";if("strictEqual"===n&&"object"===m(e)&&"object"===m(t)&&null!==e&&null!==t&&(n="strictEqualObject"),1===u.length&&1===d.length&&u[0]!==d[0]){var f=u[0].length+d[0].length;if(f<=10){if(!("object"===m(e)&&null!==e||"object"===m(t)&&null!==t||0===e&&0===t))return"".concat(k[n],"\n\n")+"".concat(u[0]," !== ").concat(d[0],"\n")}else if("strictEqualObject"!==n){if(f<(r.stderr&&r.stderr.isTTY?r.stderr.columns:80)){for(;u[0][p]===d[0][p];)p++;p>2&&(h="\n  ".concat(function(e,t){if(t=Math.floor(t),0==e.length||0==t)return"";var n=e.length*t;for(t=Math.floor(Math.log(t)/Math.log(2));t;)e+=e,t--;return e+e.substring(0,n-e.length)}(" ",p),"^"),p=0)}}}for(var g=u[u.length-1],v=d[d.length-1];g===v&&(p++<2?a="\n  ".concat(g).concat(a):o=g,u.pop(),d.pop(),0!==u.length&&0!==d.length);)g=u[u.length-1],v=d[d.length-1];var y=Math.max(u.length,d.length);if(0===y){var P=l.split("\n");if(P.length>30)for(P[26]="".concat(S,"...").concat(E);P.length>27;)P.pop();return"".concat(k.notIdentical,"\n\n").concat(P.join("\n"),"\n")}p>3&&(a="\n".concat(S,"...").concat(E).concat(a),c=!0),""!==o&&(a="\n  ".concat(o).concat(a),o="");var N=0,A=k[n]+"\n".concat(w,"+ actual").concat(E," ").concat(C,"- expected").concat(E),I=" ".concat(S,"...").concat(E," Lines skipped");for(p=0;p<y;p++){var O=p-s;if(u.length<p+1)O>1&&p>2&&(O>4?(i+="\n".concat(S,"...").concat(E),c=!0):O>3&&(i+="\n  ".concat(d[p-2]),N++),i+="\n  ".concat(d[p-1]),N++),s=p,o+="\n".concat(C,"-").concat(E," ").concat(d[p]),N++;else if(d.length<p+1)O>1&&p>2&&(O>4?(i+="\n".concat(S,"...").concat(E),c=!0):O>3&&(i+="\n  ".concat(u[p-2]),N++),i+="\n  ".concat(u[p-1]),N++),s=p,i+="\n".concat(w,"+").concat(E," ").concat(u[p]),N++;else{var L=d[p],D=u[p],R=D!==L&&(!b(D,",")||D.slice(0,-1)!==L);R&&b(L,",")&&L.slice(0,-1)===D&&(R=!1,D+=","),R?(O>1&&p>2&&(O>4?(i+="\n".concat(S,"...").concat(E),c=!0):O>3&&(i+="\n  ".concat(u[p-2]),N++),i+="\n  ".concat(u[p-1]),N++),s=p,i+="\n".concat(w,"+").concat(E," ").concat(D),o+="\n".concat(C,"-").concat(E," ").concat(L),N+=2):(i+=o,o="",1!==O&&0!==p||(i+="\n  ".concat(D),N++))}if(N>20&&p<y-2)return"".concat(A).concat(I,"\n").concat(i,"\n").concat(S,"...").concat(E).concat(o,"\n")+"".concat(S,"...").concat(E)}return"".concat(A).concat(c?I:"","\n").concat(i).concat(o).concat(a).concat(h)}var A=function(e,t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(b,e);var n,o,s,c,d,p=(n=b,o=h(),function(){var e,t=g(n);if(o){var r=g(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return l(this,e)});function b(e){var t;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,b),"object"!==m(e)||null===e)throw new y("options","Object",e);var n=e.message,o=e.operator,i=e.stackStartFn,s=e.actual,a=e.expected,c=Error.stackTraceLimit;if(Error.stackTraceLimit=0,null!=n)t=p.call(this,String(n));else if(r.stderr&&r.stderr.isTTY&&(r.stderr&&r.stderr.getColorDepth&&1!==r.stderr.getColorDepth()?(S="[34m",w="[32m",E="[39m",C="[31m"):(S="",w="",E="",C="")),"object"===m(s)&&null!==s&&"object"===m(a)&&null!==a&&"stack"in s&&s instanceof Error&&"stack"in a&&a instanceof Error&&(s=P(s),a=P(a)),"deepStrictEqual"===o||"strictEqual"===o)t=p.call(this,N(s,a,o));else if("notDeepStrictEqual"===o||"notStrictEqual"===o){var d=k[o],h=T(s).split("\n");if("notStrictEqual"===o&&"object"===m(s)&&null!==s&&(d=k.notStrictEqualObject),h.length>30)for(h[26]="".concat(S,"...").concat(E);h.length>27;)h.pop();t=1===h.length?p.call(this,"".concat(d," ").concat(h[0])):p.call(this,"".concat(d,"\n\n").concat(h.join("\n"),"\n"))}else{var f=T(s),g="",v=k[o];"notDeepEqual"===o||"notEqual"===o?(f="".concat(k[o],"\n\n").concat(f)).length>1024&&(f="".concat(f.slice(0,1021),"...")):(g="".concat(T(a)),f.length>512&&(f="".concat(f.slice(0,509),"...")),g.length>512&&(g="".concat(g.slice(0,509),"...")),"deepEqual"===o||"equal"===o?f="".concat(v,"\n\n").concat(f,"\n\nshould equal\n\n"):g=" ".concat(o," ").concat(g)),t=p.call(this,"".concat(f).concat(g))}return Error.stackTraceLimit=c,t.generatedMessage=!n,Object.defineProperty(u(t),"name",{value:"AssertionError [ERR_ASSERTION]",enumerable:!1,writable:!0,configurable:!0}),t.code="ERR_ASSERTION",t.actual=s,t.expected=a,t.operator=o,Error.captureStackTrace&&Error.captureStackTrace(u(t),i),t.stack,t.name="AssertionError",l(t)}return s=b,(c=[{key:"toString",value:function(){return"".concat(this.name," [").concat(this.code,"]: ").concat(this.message)}},{key:t,value:function(e,t){return v(this,i(i({},t),{},{customInspect:!1,depth:0}))}}])&&a(s.prototype,c),d&&a(s,d),Object.defineProperty(s,"prototype",{writable:!1}),b}(d(Error),v.custom);e.exports=A},9748:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(i=o.key,s=void 0,s=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===r(s)?s:String(s)),o)}var i,s}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=a(e);if(t){var i=a(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function a(e){return a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},a(e)}var c,l,u={};function d(e,t,n){n||(n=Error);var r=function(n){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(u,n);var r,a,c,l=s(u);function u(n,r,o){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),i=l.call(this,function(e,n,r){return"string"==typeof t?t:t(e,n,r)}(n,r,o)),i.code=e,i}return r=u,a&&o(r.prototype,a),c&&o(r,c),Object.defineProperty(r,"prototype",{writable:!1}),r}(n);u[e]=r}function p(e,t){if(Array.isArray(e)){var n=e.length;return e=e.map((function(e){return String(e)})),n>2?"one of ".concat(t," ").concat(e.slice(0,n-1).join(", "),", or ")+e[n-1]:2===n?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}d("ERR_AMBIGUOUS_ARGUMENT",'The "%s" argument is ambiguous. %s',TypeError),d("ERR_INVALID_ARG_TYPE",(function(e,t,o){var i,s,a,l;if(void 0===c&&(c=n(1575)),c("string"==typeof e,"'name' must be a string"),"string"==typeof t&&(s="not ",t.substr(!a||a<0?0:+a,s.length)===s)?(i="must not be",t=t.replace(/^not /,"")):i="must be",function(e,t,n){return(void 0===n||n>e.length)&&(n=e.length),e.substring(n-t.length,n)===t}(e," argument"))l="The ".concat(e," ").concat(i," ").concat(p(t,"type"));else{var u=function(e,t,n){return"number"!=typeof n&&(n=0),!(n+t.length>e.length)&&-1!==e.indexOf(t,n)}(e,".")?"property":"argument";l='The "'.concat(e,'" ').concat(u," ").concat(i," ").concat(p(t,"type"))}return l+=". Received type ".concat(r(o))}),TypeError),d("ERR_INVALID_ARG_VALUE",(function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"is invalid";void 0===l&&(l=n(1747));var o=l.inspect(t);return o.length>128&&(o="".concat(o.slice(0,128),"...")),"The argument '".concat(e,"' ").concat(r,". Received ").concat(o)}),TypeError,RangeError),d("ERR_INVALID_RETURN_VALUE",(function(e,t,n){var o;return o=n&&n.constructor&&n.constructor.name?"instance of ".concat(n.constructor.name):"type ".concat(r(n)),"Expected ".concat(e,' to be returned from the "').concat(t,'"')+" function but got ".concat(o,".")}),TypeError),d("ERR_MISSING_ARGS",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];void 0===c&&(c=n(1575)),c(t.length>0,"At least one arg needs to be specified");var o="The ",i=t.length;switch(t=t.map((function(e){return'"'.concat(e,'"')})),i){case 1:o+="".concat(t[0]," argument");break;case 2:o+="".concat(t[0]," and ").concat(t[1]," arguments");break;default:o+=t.slice(0,i-1).join(", "),o+=", and ".concat(t[i-1]," arguments")}return"".concat(o," must be specified")}),TypeError),e.exports.codes=u},4818:(e,t,n)=>{"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,s,a=[],c=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(a.push(r.value),a.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw o}}return a}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}var s=void 0!==/a/g.flags,a=function(e){var t=[];return e.forEach((function(e){return t.push(e)})),t},c=function(e){var t=[];return e.forEach((function(e,n){return t.push([n,e])})),t},l=Object.is?Object.is:n(6991),u=Object.getOwnPropertySymbols?Object.getOwnPropertySymbols:function(){return[]},d=Number.isNaN?Number.isNaN:n(4307);function p(e){return e.call.bind(e)}var h=p(Object.prototype.hasOwnProperty),f=p(Object.prototype.propertyIsEnumerable),g=p(Object.prototype.toString),m=n(1747).types,v=m.isAnyArrayBuffer,y=m.isArrayBufferView,b=m.isDate,S=m.isMap,w=m.isRegExp,C=m.isSet,E=m.isNativeError,k=m.isBoxedPrimitive,P=m.isNumberObject,T=m.isStringObject,N=m.isBooleanObject,A=m.isBigIntObject,I=m.isSymbolObject,O=m.isFloat32Array,L=m.isFloat64Array;function D(e){if(0===e.length||e.length>10)return!0;for(var t=0;t<e.length;t++){var n=e.charCodeAt(t);if(n<48||n>57)return!0}return 10===e.length&&e>=Math.pow(2,32)}function R(e){return Object.keys(e).filter(D).concat(u(e).filter(Object.prototype.propertyIsEnumerable.bind(e)))}function F(e,t){if(e===t)return 0;for(var n=e.length,r=t.length,o=0,i=Math.min(n,r);o<i;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0}var M=0,x=1,_=2,U=3;function j(e,t,n,r){if(e===t)return 0!==e||(!n||l(e,t));if(n){if("object"!==i(e))return"number"==typeof e&&d(e)&&d(t);if("object"!==i(t)||null===e||null===t)return!1;if(Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1}else{if(null===e||"object"!==i(e))return(null===t||"object"!==i(t))&&e==t;if(null===t||"object"!==i(t))return!1}var o,a,c,u,p=g(e);if(p!==g(t))return!1;if(Array.isArray(e)){if(e.length!==t.length)return!1;var h=R(e),f=R(t);return h.length===f.length&&q(e,t,n,r,x,h)}if("[object Object]"===p&&(!S(e)&&S(t)||!C(e)&&C(t)))return!1;if(b(e)){if(!b(t)||Date.prototype.getTime.call(e)!==Date.prototype.getTime.call(t))return!1}else if(w(e)){if(!w(t)||(c=e,u=t,!(s?c.source===u.source&&c.flags===u.flags:RegExp.prototype.toString.call(c)===RegExp.prototype.toString.call(u))))return!1}else if(E(e)||e instanceof Error){if(e.message!==t.message||e.name!==t.name)return!1}else{if(y(e)){if(n||!O(e)&&!L(e)){if(!function(e,t){return e.byteLength===t.byteLength&&0===F(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),new Uint8Array(t.buffer,t.byteOffset,t.byteLength))}(e,t))return!1}else if(!function(e,t){if(e.byteLength!==t.byteLength)return!1;for(var n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0}(e,t))return!1;var m=R(e),D=R(t);return m.length===D.length&&q(e,t,n,r,M,m)}if(C(e))return!(!C(t)||e.size!==t.size)&&q(e,t,n,r,_);if(S(e))return!(!S(t)||e.size!==t.size)&&q(e,t,n,r,U);if(v(e)){if(a=t,(o=e).byteLength!==a.byteLength||0!==F(new Uint8Array(o),new Uint8Array(a)))return!1}else if(k(e)&&!function(e,t){return P(e)?P(t)&&l(Number.prototype.valueOf.call(e),Number.prototype.valueOf.call(t)):T(e)?T(t)&&String.prototype.valueOf.call(e)===String.prototype.valueOf.call(t):N(e)?N(t)&&Boolean.prototype.valueOf.call(e)===Boolean.prototype.valueOf.call(t):A(e)?A(t)&&BigInt.prototype.valueOf.call(e)===BigInt.prototype.valueOf.call(t):I(t)&&Symbol.prototype.valueOf.call(e)===Symbol.prototype.valueOf.call(t)}(e,t))return!1}return q(e,t,n,r,M)}function z(e,t){return t.filter((function(t){return f(e,t)}))}function q(e,t,n,o,s,l){if(5===arguments.length){l=Object.keys(e);var d=Object.keys(t);if(l.length!==d.length)return!1}for(var p=0;p<l.length;p++)if(!h(t,l[p]))return!1;if(n&&5===arguments.length){var g=u(e);if(0!==g.length){var m=0;for(p=0;p<g.length;p++){var v=g[p];if(f(e,v)){if(!f(t,v))return!1;l.push(v),m++}else if(f(t,v))return!1}var y=u(t);if(g.length!==y.length&&z(t,y).length!==m)return!1}else{var b=u(t);if(0!==b.length&&0!==z(t,b).length)return!1}}if(0===l.length&&(s===M||s===x&&0===e.length||0===e.size))return!0;if(void 0===o)o={val1:new Map,val2:new Map,position:0};else{var S=o.val1.get(e);if(void 0!==S){var w=o.val2.get(t);if(void 0!==w)return S===w}o.position++}o.val1.set(e,o.position),o.val2.set(t,o.position);var C=function(e,t,n,o,s,l){var u=0;if(l===_){if(!function(e,t,n,r){for(var o=null,s=a(e),c=0;c<s.length;c++){var l=s[c];if("object"===i(l)&&null!==l)null===o&&(o=new Set),o.add(l);else if(!t.has(l)){if(n)return!1;if(!H(e,t,l))return!1;null===o&&(o=new Set),o.add(l)}}if(null!==o){for(var u=a(t),d=0;d<u.length;d++){var p=u[d];if("object"===i(p)&&null!==p){if(!B(o,p,n,r))return!1}else if(!n&&!e.has(p)&&!B(o,p,n,r))return!1}return 0===o.size}return!0}(e,t,n,s))return!1}else if(l===U){if(!function(e,t,n,o){for(var s=null,a=c(e),l=0;l<a.length;l++){var u=r(a[l],2),d=u[0],p=u[1];if("object"===i(d)&&null!==d)null===s&&(s=new Set),s.add(d);else{var h=t.get(d);if(void 0===h&&!t.has(d)||!j(p,h,n,o)){if(n)return!1;if(!W(e,t,d,p,o))return!1;null===s&&(s=new Set),s.add(d)}}}if(null!==s){for(var f=c(t),g=0;g<f.length;g++){var m=r(f[g],2),v=m[0],y=m[1];if("object"===i(v)&&null!==v){if(!G(s,e,v,y,n,o))return!1}else if(!(n||e.has(v)&&j(e.get(v),y,!1,o)||G(s,e,v,y,!1,o)))return!1}return 0===s.size}return!0}(e,t,n,s))return!1}else if(l===x)for(;u<e.length;u++){if(!h(e,u)){if(h(t,u))return!1;for(var d=Object.keys(e);u<d.length;u++){var p=d[u];if(!h(t,p)||!j(e[p],t[p],n,s))return!1}return d.length===Object.keys(t).length}if(!h(t,u)||!j(e[u],t[u],n,s))return!1}for(u=0;u<o.length;u++){var f=o[u];if(!j(e[f],t[f],n,s))return!1}return!0}(e,t,n,l,o,s);return o.val1.delete(e),o.val2.delete(t),C}function B(e,t,n,r){for(var o=a(e),i=0;i<o.length;i++){var s=o[i];if(j(t,s,n,r))return e.delete(s),!0}return!1}function $(e){switch(i(e)){case"undefined":return null;case"object":return;case"symbol":return!1;case"string":e=+e;case"number":if(d(e))return!1}return!0}function H(e,t,n){var r=$(n);return null!=r?r:t.has(r)&&!e.has(r)}function W(e,t,n,r,o){var i=$(n);if(null!=i)return i;var s=t.get(i);return!(void 0===s&&!t.has(i)||!j(r,s,!1,o))&&(!e.has(i)&&j(r,s,!1,o))}function G(e,t,n,r,o,i){for(var s=a(e),c=0;c<s.length;c++){var l=s[c];if(j(n,l,o,i)&&j(r,t.get(l),o,i))return e.delete(l),!0}return!1}e.exports={isDeepEqual:function(e,t){return j(e,t,false)},isDeepStrictEqual:function(e,t){return j(e,t,true)}}},3499:(e,t)=>{"use strict";t.byteLength=function(e){var t=a(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,i=a(e),s=i[0],c=i[1],l=new o(function(e,t,n){return 3*(t+n)/4-n}(0,s,c)),u=0,d=c>0?s-4:s;for(n=0;n<d;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],l[u++]=t>>16&255,l[u++]=t>>8&255,l[u++]=255&t;2===c&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,l[u++]=255&t);1===c&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,l[u++]=t>>8&255,l[u++]=255&t);return l},t.fromByteArray=function(e){for(var t,r=e.length,o=r%3,i=[],s=16383,a=0,l=r-o;a<l;a+=s)i.push(c(e,a,a+s>l?l:a+s));1===o?(t=e[r-1],i.push(n[t>>2]+n[t<<4&63]+"==")):2===o&&(t=(e[r-2]<<8)+e[r-1],i.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return i.join("")};for(var n=[],r=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0;s<64;++s)n[s]=i[s],r[i.charCodeAt(s)]=s;function a(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function c(e,t,r){for(var o,i,s=[],a=t;a<r;a+=3)o=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(n[(i=o)>>18&63]+n[i>>12&63]+n[i>>6&63]+n[63&i]);return s.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},715:(e,t,n)=>{"use strict";var r=n(7216),o=n(9527),i=o(r("String.prototype.indexOf"));e.exports=function(e,t){var n=r(e,!!t);return"function"==typeof n&&i(e,".prototype.")>-1?o(n):n}},9527:(e,t,n)=>{"use strict";var r=n(2790),o=n(7216),i=n(6650),s=n(9230),a=o("%Function.prototype.apply%"),c=o("%Function.prototype.call%"),l=o("%Reflect.apply%",!0)||r.call(c,a),u=n(7779),d=o("%Math.max%");e.exports=function(e){if("function"!=typeof e)throw new s("a function is required");var t=l(r,c,arguments);return i(t,1+d(0,e.length-(arguments.length-1)),!0)};var p=function(){return l(r,a,arguments)};u?u(e.exports,"apply",{value:p}):e.exports.apply=p},9307:(e,t,n)=>{var r=n(1747),o=n(1575);function i(){return(new Date).getTime()}var s,a=Array.prototype.slice,c={};s=void 0!==n.g&&n.g.console?n.g.console:"undefined"!=typeof window&&window.console?window.console:{};for(var l=[[function(){},"log"],[function(){s.log.apply(s,arguments)},"info"],[function(){s.log.apply(s,arguments)},"warn"],[function(){s.warn.apply(s,arguments)},"error"],[function(e){c[e]=i()},"time"],[function(e){var t=c[e];if(!t)throw new Error("No such label: "+e);delete c[e];var n=i()-t;s.log(e+": "+n+"ms")},"timeEnd"],[function(){var e=new Error;e.name="Trace",e.message=r.format.apply(null,arguments),s.error(e.stack)},"trace"],[function(e){s.log(r.inspect(e)+"\n")},"dir"],[function(e){if(!e){var t=a.call(arguments,1);o.ok(!1,r.format.apply(null,t))}},"assert"]],u=0;u<l.length;u++){var d=l[u],p=d[0],h=d[1];s[h]||(s[h]=p)}e.exports=s},6102:(e,t,n)=>{var r=n(9307),o=n(7131);t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(o=r))})),t.splice(o,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&void 0!==o&&"env"in o&&(e=o.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let e;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&(e=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(e[1],10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,r.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=r.debug||r.log||(()=>{}),e.exports=n(553)(t);const{formatters:i}=e.exports;i.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},553:(e,t,n)=>{var r=n(9307);e.exports=function(e){function t(e){let n,r,i,s=null;function a(...e){if(!a.enabled)return;const r=a,o=Number(new Date),i=o-(n||o);r.diff=i,r.prev=n,r.curr=o,n=o,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((n,o)=>{if("%%"===n)return"%";s++;const i=t.formatters[o];if("function"==typeof i){const t=e[s];n=i.call(r,t),e.splice(s,1),s--}return n})),t.formatArgs.call(r,e);(r.log||t.log).apply(r,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=o,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(r!==t.namespaces&&(r=t.namespaces,i=t.enabled(e)),i),set:e=>{s=e}}),"function"==typeof t.init&&t.init(a),a}function o(e,n){const r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(i),...t.skips.map(i).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(2434),t.destroy=function(){r.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},3457:(e,t,n)=>{"use strict";var r=n(7779),o=n(325),i=n(9230),s=n(600);e.exports=function(e,t,n){if(!e||"object"!=typeof e&&"function"!=typeof e)throw new i("`obj` must be an object or a function`");if("string"!=typeof t&&"symbol"!=typeof t)throw new i("`property` must be a string or a symbol`");if(arguments.length>3&&"boolean"!=typeof arguments[3]&&null!==arguments[3])throw new i("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&"boolean"!=typeof arguments[4]&&null!==arguments[4])throw new i("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&"boolean"!=typeof arguments[5]&&null!==arguments[5])throw new i("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&"boolean"!=typeof arguments[6])throw new i("`loose`, if provided, must be a boolean");var a=arguments.length>3?arguments[3]:null,c=arguments.length>4?arguments[4]:null,l=arguments.length>5?arguments[5]:null,u=arguments.length>6&&arguments[6],d=!!s&&s(e,t);if(r)r(e,t,{configurable:null===l&&d?d.configurable:!l,enumerable:null===a&&d?d.enumerable:!a,value:n,writable:null===c&&d?d.writable:!c});else{if(!u&&(a||c||l))throw new o("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.");e[t]=n}}},1392:(e,t,n)=>{"use strict";var r=n(5453),o="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),i=Object.prototype.toString,s=Array.prototype.concat,a=n(3457),c=n(3867)(),l=function(e,t,n,r){if(t in e)if(!0===r){if(e[t]===n)return}else if("function"!=typeof(o=r)||"[object Function]"!==i.call(o)||!r())return;var o;c?a(e,t,n,!0):a(e,t,n)},u=function(e,t){var n=arguments.length>2?arguments[2]:{},i=r(t);o&&(i=s.call(i,Object.getOwnPropertySymbols(t)));for(var a=0;a<i.length;a+=1)l(e,i[a],t[i[a]],n[i[a]])};u.supportsDescriptors=!!c,e.exports=u},8784:e=>{"use strict";function t(e){if(this._capacity=r(e),this._length=0,this._front=0,n(e)){for(var t=e.length,o=0;o<t;++o)this[o]=e[o];this._length=t}}t.prototype.toArray=function(){for(var e=this._length,t=new Array(e),n=this._front,r=this._capacity,o=0;o<e;++o)t[o]=this[n+o&r-1];return t},t.prototype.push=function(e){var t=arguments.length,n=this._length;if(t>1){var r=this._capacity;if(n+t>r){for(var o=0;o<t;++o){this._checkCapacity(n+1),this[i=this._front+n&this._capacity-1]=arguments[o],n++,this._length=n}return n}for(var i=this._front,o=0;o<t;++o)this[i+n&r-1]=arguments[o],i++;return this._length=n+t,n+t}return 0===t?n:(this._checkCapacity(n+1),this[o=this._front+n&this._capacity-1]=e,this._length=n+1,n+1)},t.prototype.pop=function(){var e=this._length;if(0!==e){var t=this._front+e-1&this._capacity-1,n=this[t];return this[t]=void 0,this._length=e-1,n}},t.prototype.shift=function(){var e=this._length;if(0!==e){var t=this._front,n=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length=e-1,n}},t.prototype.unshift=function(e){var t=this._length,n=arguments.length;if(n>1){if(t+n>(o=this._capacity)){for(var r=n-1;r>=0;r--){this._checkCapacity(t+1);var o=this._capacity;this[s=(this._front-1&o-1^o)-o]=arguments[r],t++,this._length=t,this._front=s}return t}var i=this._front;for(r=n-1;r>=0;r--){var s;this[s=(i-1&o-1^o)-o]=arguments[r],i=s}return this._front=i,this._length=t+n,t+n}if(0===n)return t;this._checkCapacity(t+1);o=this._capacity;return this[r=(this._front-1&o-1^o)-o]=e,this._length=t+1,this._front=r,t+1},t.prototype.peekBack=function(){var e=this._length;if(0!==e)return this[this._front+e-1&this._capacity-1]},t.prototype.peekFront=function(){if(0!==this._length)return this[this._front]},t.prototype.get=function(e){var t=e;if(t===(0|t)){var n=this._length;if(t<0&&(t+=n),!(t<0||t>=n))return this[this._front+t&this._capacity-1]}},t.prototype.isEmpty=function(){return 0===this._length},t.prototype.clear=function(){for(var e=this._length,t=this._front,n=this._capacity,r=0;r<e;++r)this[t+r&n-1]=void 0;this._length=0,this._front=0},t.prototype.toString=function(){return this.toArray().toString()},t.prototype.valueOf=t.prototype.toString,t.prototype.removeFront=t.prototype.shift,t.prototype.removeBack=t.prototype.pop,t.prototype.insertFront=t.prototype.unshift,t.prototype.insertBack=t.prototype.push,t.prototype.enqueue=t.prototype.push,t.prototype.dequeue=t.prototype.shift,t.prototype.toJSON=t.prototype.toArray,Object.defineProperty(t.prototype,"length",{get:function(){return this._length},set:function(){throw new RangeError("")}}),t.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(r(1.5*this._capacity+16))},t.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e;var n=this._front,r=this._length;n+r>t&&function(e,t,n,r,o){for(var i=0;i<o;++i)n[i+r]=e[i+t],e[i+t]=void 0}(this,0,this,t,n+r&t-1)};var n=Array.isArray;function r(e){if("number"!=typeof e){if(!n(e))return 16;e=e.length}return t=Math.min(Math.max(16,e),1073741824),t>>>=0,t-=1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,1+(t|=t>>16);var t}e.exports=t},7779:(e,t,n)=>{"use strict";var r=n(7216)("%Object.defineProperty%",!0)||!1;if(r)try{r({},"a",{value:1})}catch(e){r=!1}e.exports=r},2932:e=>{"use strict";e.exports=EvalError},6448:e=>{"use strict";e.exports=Error},8869:e=>{"use strict";e.exports=RangeError},221:e=>{"use strict";e.exports=ReferenceError},325:e=>{"use strict";e.exports=SyntaxError},9230:e=>{"use strict";e.exports=TypeError},8462:e=>{"use strict";e.exports=URIError},309:(e,t,n)=>{"use strict";var r,o=n(9307),i="object"==typeof Reflect?Reflect:null,s=i&&"function"==typeof i.apply?i.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};r=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var a=Number.isNaN||function(e){return e!=e};function c(){c.init.call(this)}e.exports=c,e.exports.once=function(e,t){return new Promise((function(n,r){function o(n){e.removeListener(t,i),r(n)}function i(){"function"==typeof e.removeListener&&e.removeListener("error",o),n([].slice.call(arguments))}y(e,t,i,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&y(e,"error",t,n)}(e,o,{once:!0})}))},c.EventEmitter=c,c.prototype._events=void 0,c.prototype._eventsCount=0,c.prototype._maxListeners=void 0;var l=10;function u(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function d(e){return void 0===e._maxListeners?c.defaultMaxListeners:e._maxListeners}function p(e,t,n,r){var i,s,a,c;if(u(n),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),a=s[t]),void 0===a)a=s[t]=n,++e._eventsCount;else if("function"==typeof a?a=s[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(i=d(e))>0&&a.length>i&&!a.warned){a.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=a.length,c=l,o&&o.warn&&o.warn(c)}return e}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},o=h.bind(r);return o.listener=n,r.wrapFn=o,o}function g(e,t,n){var r=e._events;if(void 0===r)return[];var o=r[t];return void 0===o?[]:"function"==typeof o?n?[o.listener||o]:[o]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(o):v(o,o.length)}function m(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function v(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function y(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function o(i){r.once&&e.removeEventListener(t,o),n(i)}))}}Object.defineProperty(c,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");l=e}}),c.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},c.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},c.prototype.getMaxListeners=function(){return d(this)},c.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var i;if(t.length>0&&(i=t[0]),i instanceof Error)throw i;var a=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw a.context=i,a}var c=o[e];if(void 0===c)return!1;if("function"==typeof c)s(c,this,t);else{var l=c.length,u=v(c,l);for(n=0;n<l;++n)s(u[n],this,t)}return!0},c.prototype.addListener=function(e,t){return p(this,e,t,!1)},c.prototype.on=c.prototype.addListener,c.prototype.prependListener=function(e,t){return p(this,e,t,!0)},c.prototype.once=function(e,t){return u(t),this.on(e,f(this,e,t)),this},c.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,f(this,e,t)),this},c.prototype.removeListener=function(e,t){var n,r,o,i,s;if(u(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(o=-1,i=n.length-1;i>=0;i--)if(n[i]===t||n[i].listener===t){s=n[i].listener,o=i;break}if(o<0)return this;0===o?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,o),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},c.prototype.off=c.prototype.removeListener,c.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var o,i=Object.keys(n);for(r=0;r<i.length;++r)"removeListener"!==(o=i[r])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},c.prototype.listeners=function(e){return g(this,e,!0)},c.prototype.rawListeners=function(e){return g(this,e,!1)},c.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):m.call(e,t)},c.prototype.listenerCount=m,c.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},6580:(e,t,n)=>{"use strict";var r,o=n(9307),i="object"==typeof Reflect?Reflect:null,s=i&&"function"==typeof i.apply?i.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};r=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var a=Number.isNaN||function(e){return e!=e};function c(){c.init.call(this)}e.exports=c,e.exports.once=function(e,t){return new Promise((function(n,r){function o(n){e.removeListener(t,i),r(n)}function i(){"function"==typeof e.removeListener&&e.removeListener("error",o),n([].slice.call(arguments))}y(e,t,i,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&y(e,"error",t,n)}(e,o,{once:!0})}))},c.EventEmitter=c,c.prototype._events=void 0,c.prototype._eventsCount=0,c.prototype._maxListeners=void 0;var l=10;function u(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function d(e){return void 0===e._maxListeners?c.defaultMaxListeners:e._maxListeners}function p(e,t,n,r){var i,s,a,c;if(u(n),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),a=s[t]),void 0===a)a=s[t]=n,++e._eventsCount;else if("function"==typeof a?a=s[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(i=d(e))>0&&a.length>i&&!a.warned){a.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=a.length,c=l,o&&o.warn&&o.warn(c)}return e}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},o=h.bind(r);return o.listener=n,r.wrapFn=o,o}function g(e,t,n){var r=e._events;if(void 0===r)return[];var o=r[t];return void 0===o?[]:"function"==typeof o?n?[o.listener||o]:[o]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(o):v(o,o.length)}function m(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function v(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function y(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function o(i){r.once&&e.removeEventListener(t,o),n(i)}))}}Object.defineProperty(c,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");l=e}}),c.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},c.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},c.prototype.getMaxListeners=function(){return d(this)},c.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var i;if(t.length>0&&(i=t[0]),i instanceof Error)throw i;var a=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw a.context=i,a}var c=o[e];if(void 0===c)return!1;if("function"==typeof c)s(c,this,t);else{var l=c.length,u=v(c,l);for(n=0;n<l;++n)s(u[n],this,t)}return!0},c.prototype.addListener=function(e,t){return p(this,e,t,!1)},c.prototype.on=c.prototype.addListener,c.prototype.prependListener=function(e,t){return p(this,e,t,!0)},c.prototype.once=function(e,t){return u(t),this.on(e,f(this,e,t)),this},c.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,f(this,e,t)),this},c.prototype.removeListener=function(e,t){var n,r,o,i,s;if(u(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(o=-1,i=n.length-1;i>=0;i--)if(n[i]===t||n[i].listener===t){s=n[i].listener,o=i;break}if(o<0)return this;0===o?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,o),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},c.prototype.off=c.prototype.removeListener,c.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var o,i=Object.keys(n);for(r=0;r<i.length;++r)"removeListener"!==(o=i[r])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},c.prototype.listeners=function(e){return g(this,e,!0)},c.prototype.rawListeners=function(e){return g(this,e,!1)},c.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):m.call(e,t)},c.prototype.listenerCount=m,c.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},6034:(e,t,n)=>{"use strict";var r=n(2377),o=Object.prototype.toString,i=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){if(!r(t))throw new TypeError("iterator must be a function");var s;arguments.length>=3&&(s=n),"[object Array]"===o.call(e)?function(e,t,n){for(var r=0,o=e.length;r<o;r++)i.call(e,r)&&(null==n?t(e[r],r,e):t.call(n,e[r],r,e))}(e,t,s):"string"==typeof e?function(e,t,n){for(var r=0,o=e.length;r<o;r++)null==n?t(e.charAt(r),r,e):t.call(n,e.charAt(r),r,e)}(e,t,s):function(e,t,n){for(var r in e)i.call(e,r)&&(null==n?t(e[r],r,e):t.call(n,e[r],r,e))}(e,t,s)}},4334:e=>{"use strict";var t=Object.prototype.toString,n=Math.max,r=function(e,t){for(var n=[],r=0;r<e.length;r+=1)n[r]=e[r];for(var o=0;o<t.length;o+=1)n[o+e.length]=t[o];return n};e.exports=function(e){var o=this;if("function"!=typeof o||"[object Function]"!==t.apply(o))throw new TypeError("Function.prototype.bind called on incompatible "+o);for(var i,s=function(e,t){for(var n=[],r=t||0,o=0;r<e.length;r+=1,o+=1)n[o]=e[r];return n}(arguments,1),a=n(0,o.length-s.length),c=[],l=0;l<a;l++)c[l]="$"+l;if(i=Function("binder","return function ("+function(e,t){for(var n="",r=0;r<e.length;r+=1)n+=e[r],r+1<e.length&&(n+=t);return n}(c,",")+"){ return binder.apply(this,arguments); }")((function(){if(this instanceof i){var t=o.apply(this,r(s,arguments));return Object(t)===t?t:this}return o.apply(e,r(s,arguments))})),o.prototype){var u=function(){};u.prototype=o.prototype,i.prototype=new u,u.prototype=null}return i}},2790:(e,t,n)=>{"use strict";var r=n(4334);e.exports=Function.prototype.bind||r},7216:(e,t,n)=>{"use strict";var r,o=n(6448),i=n(2932),s=n(8869),a=n(221),c=n(325),l=n(9230),u=n(8462),d=Function,p=function(e){try{return d('"use strict"; return ('+e+").constructor;")()}catch(e){}},h=Object.getOwnPropertyDescriptor;if(h)try{h({},"")}catch(e){h=null}var f=function(){throw new l},g=h?function(){try{return f}catch(e){try{return h(arguments,"callee").get}catch(e){return f}}}():f,m=n(5834)(),v=n(9638)(),y=Object.getPrototypeOf||(v?function(e){return e.__proto__}:null),b={},S="undefined"!=typeof Uint8Array&&y?y(Uint8Array):r,w={__proto__:null,"%AggregateError%":"undefined"==typeof AggregateError?r:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?r:ArrayBuffer,"%ArrayIteratorPrototype%":m&&y?y([][Symbol.iterator]()):r,"%AsyncFromSyncIteratorPrototype%":r,"%AsyncFunction%":b,"%AsyncGenerator%":b,"%AsyncGeneratorFunction%":b,"%AsyncIteratorPrototype%":b,"%Atomics%":"undefined"==typeof Atomics?r:Atomics,"%BigInt%":"undefined"==typeof BigInt?r:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?r:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?r:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?r:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":o,"%eval%":eval,"%EvalError%":i,"%Float32Array%":"undefined"==typeof Float32Array?r:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?r:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?r:FinalizationRegistry,"%Function%":d,"%GeneratorFunction%":b,"%Int8Array%":"undefined"==typeof Int8Array?r:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?r:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?r:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":m&&y?y(y([][Symbol.iterator]())):r,"%JSON%":"object"==typeof JSON?JSON:r,"%Map%":"undefined"==typeof Map?r:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&m&&y?y((new Map)[Symbol.iterator]()):r,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?r:Promise,"%Proxy%":"undefined"==typeof Proxy?r:Proxy,"%RangeError%":s,"%ReferenceError%":a,"%Reflect%":"undefined"==typeof Reflect?r:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?r:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&m&&y?y((new Set)[Symbol.iterator]()):r,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?r:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":m&&y?y(""[Symbol.iterator]()):r,"%Symbol%":m?Symbol:r,"%SyntaxError%":c,"%ThrowTypeError%":g,"%TypedArray%":S,"%TypeError%":l,"%Uint8Array%":"undefined"==typeof Uint8Array?r:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?r:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?r:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?r:Uint32Array,"%URIError%":u,"%WeakMap%":"undefined"==typeof WeakMap?r:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?r:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?r:WeakSet};if(y)try{null.error}catch(e){var C=y(y(e));w["%Error.prototype%"]=C}var E=function e(t){var n;if("%AsyncFunction%"===t)n=p("async function () {}");else if("%GeneratorFunction%"===t)n=p("function* () {}");else if("%AsyncGeneratorFunction%"===t)n=p("async function* () {}");else if("%AsyncGenerator%"===t){var r=e("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if("%AsyncIteratorPrototype%"===t){var o=e("%AsyncGenerator%");o&&y&&(n=y(o.prototype))}return w[t]=n,n},k={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},P=n(2790),T=n(9668),N=P.call(Function.call,Array.prototype.concat),A=P.call(Function.apply,Array.prototype.splice),I=P.call(Function.call,String.prototype.replace),O=P.call(Function.call,String.prototype.slice),L=P.call(Function.call,RegExp.prototype.exec),D=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,R=/\\(\\)?/g,F=function(e,t){var n,r=e;if(T(k,r)&&(r="%"+(n=k[r])[0]+"%"),T(w,r)){var o=w[r];if(o===b&&(o=E(r)),void 0===o&&!t)throw new l("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:n,name:r,value:o}}throw new c("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new l("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new l('"allowMissing" argument must be a boolean');if(null===L(/^%?[^%]*%?$/,e))throw new c("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=function(e){var t=O(e,0,1),n=O(e,-1);if("%"===t&&"%"!==n)throw new c("invalid intrinsic syntax, expected closing `%`");if("%"===n&&"%"!==t)throw new c("invalid intrinsic syntax, expected opening `%`");var r=[];return I(e,D,(function(e,t,n,o){r[r.length]=n?I(o,R,"$1"):t||e})),r}(e),r=n.length>0?n[0]:"",o=F("%"+r+"%",t),i=o.name,s=o.value,a=!1,u=o.alias;u&&(r=u[0],A(n,N([0,1],u)));for(var d=1,p=!0;d<n.length;d+=1){var f=n[d],g=O(f,0,1),m=O(f,-1);if(('"'===g||"'"===g||"`"===g||'"'===m||"'"===m||"`"===m)&&g!==m)throw new c("property names with quotes must have matching quotes");if("constructor"!==f&&p||(a=!0),T(w,i="%"+(r+="."+f)+"%"))s=w[i];else if(null!=s){if(!(f in s)){if(!t)throw new l("base intrinsic for "+e+" exists, but the property is not available.");return}if(h&&d+1>=n.length){var v=h(s,f);s=(p=!!v)&&"get"in v&&!("originalValue"in v.get)?v.get:s[f]}else p=T(s,f),s=s[f];p&&!a&&(w[i]=s)}}return s}},600:(e,t,n)=>{"use strict";var r=n(7216)("%Object.getOwnPropertyDescriptor%",!0);if(r)try{r([],"length")}catch(e){r=null}e.exports=r},3867:(e,t,n)=>{"use strict";var r=n(7779),o=function(){return!!r};o.hasArrayLengthDefineBug=function(){if(!r)return null;try{return 1!==r([],"length",{value:1}).length}catch(e){return!0}},e.exports=o},9638:e=>{"use strict";var t={__proto__:null,foo:{}},n=Object;e.exports=function(){return{__proto__:t}.foo===t.foo&&!(t instanceof n)}},5834:(e,t,n)=>{"use strict";var r="undefined"!=typeof Symbol&&Symbol,o=n(2624);e.exports=function(){return"function"==typeof r&&("function"==typeof Symbol&&("symbol"==typeof r("foo")&&("symbol"==typeof Symbol("bar")&&o())))}},2624:e=>{"use strict";e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),n=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(n))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var r=Object.getOwnPropertySymbols(e);if(1!==r.length||r[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(e,t);if(42!==o.value||!0!==o.enumerable)return!1}return!0}},9e3:(e,t,n)=>{"use strict";var r=n(2624);e.exports=function(){return r()&&!!Symbol.toStringTag}},9668:(e,t,n)=>{"use strict";var r=Function.prototype.call,o=Object.prototype.hasOwnProperty,i=n(2790);e.exports=i.call(r,o)},5515:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},4689:(e,t,n)=>{"use strict";var r=n(9e3)(),o=n(715)("Object.prototype.toString"),i=function(e){return!(r&&e&&"object"==typeof e&&Symbol.toStringTag in e)&&"[object Arguments]"===o(e)},s=function(e){return!!i(e)||null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Array]"!==o(e)&&"[object Function]"===o(e.callee)},a=function(){return i(arguments)}();i.isLegacyArguments=s,e.exports=a?i:s},2377:e=>{"use strict";var t,n,r=Function.prototype.toString,o="object"==typeof Reflect&&null!==Reflect&&Reflect.apply;if("function"==typeof o&&"function"==typeof Object.defineProperty)try{t=Object.defineProperty({},"length",{get:function(){throw n}}),n={},o((function(){throw 42}),null,t)}catch(e){e!==n&&(o=null)}else o=null;var i=/^\s*class\b/,s=function(e){try{var t=r.call(e);return i.test(t)}catch(e){return!1}},a=function(e){try{return!s(e)&&(r.call(e),!0)}catch(e){return!1}},c=Object.prototype.toString,l="function"==typeof Symbol&&!!Symbol.toStringTag,u=!(0 in[,]),d=function(){return!1};if("object"==typeof document){var p=document.all;c.call(p)===c.call(document.all)&&(d=function(e){if((u||!e)&&(void 0===e||"object"==typeof e))try{var t=c.call(e);return("[object HTMLAllCollection]"===t||"[object HTML document.all class]"===t||"[object HTMLCollection]"===t||"[object Object]"===t)&&null==e("")}catch(e){}return!1})}e.exports=o?function(e){if(d(e))return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;try{o(e,null,t)}catch(e){if(e!==n)return!1}return!s(e)&&a(e)}:function(e){if(d(e))return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if(l)return a(e);if(s(e))return!1;var t=c.call(e);return!("[object Function]"!==t&&"[object GeneratorFunction]"!==t&&!/^\[object HTML/.test(t))&&a(e)}},6534:(e,t,n)=>{"use strict";var r,o=Object.prototype.toString,i=Function.prototype.toString,s=/^\s*(?:function)?\*/,a=n(9e3)(),c=Object.getPrototypeOf;e.exports=function(e){if("function"!=typeof e)return!1;if(s.test(i.call(e)))return!0;if(!a)return"[object GeneratorFunction]"===o.call(e);if(!c)return!1;if(void 0===r){var t=function(){if(!a)return!1;try{return Function("return function*() {}")()}catch(e){}}();r=!!t&&c(t)}return c(e)===r}},2357:e=>{"use strict";e.exports=function(e){return e!=e}},4307:(e,t,n)=>{"use strict";var r=n(9527),o=n(1392),i=n(2357),s=n(7104),a=n(4874),c=r(s(),Number);o(c,{getPolyfill:s,implementation:i,shim:a}),e.exports=c},7104:(e,t,n)=>{"use strict";var r=n(2357);e.exports=function(){return Number.isNaN&&Number.isNaN(NaN)&&!Number.isNaN("a")?Number.isNaN:r}},4874:(e,t,n)=>{"use strict";var r=n(1392),o=n(7104);e.exports=function(){var e=o();return r(Number,{isNaN:e},{isNaN:function(){return Number.isNaN!==e}}),e}},4460:(e,t,n)=>{"use strict";var r=n(731);e.exports=function(e){return!!r(e)}},2434:e=>{var t=1e3,n=60*t,r=60*n,o=24*r,i=7*o,s=365.25*o;function a(e,t,n,r){var o=t>=1.5*n;return Math.round(e/n)+" "+r+(o?"s":"")}e.exports=function(e,c){c=c||{};var l=typeof e;if("string"===l&&e.length>0)return function(e){if((e=String(e)).length>100)return;var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!a)return;var c=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*s;case"weeks":case"week":case"w":return c*i;case"days":case"day":case"d":return c*o;case"hours":case"hour":case"hrs":case"hr":case"h":return c*r;case"minutes":case"minute":case"mins":case"min":case"m":return c*n;case"seconds":case"second":case"secs":case"sec":case"s":return c*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(e);if("number"===l&&isFinite(e))return c.long?function(e){var i=Math.abs(e);if(i>=o)return a(e,i,o,"day");if(i>=r)return a(e,i,r,"hour");if(i>=n)return a(e,i,n,"minute");if(i>=t)return a(e,i,t,"second");return e+" ms"}(e):function(e){var i=Math.abs(e);if(i>=o)return Math.round(e/o)+"d";if(i>=r)return Math.round(e/r)+"h";if(i>=n)return Math.round(e/n)+"m";if(i>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},8513:e=>{"use strict";var t=function(e){return e!=e};e.exports=function(e,n){return 0===e&&0===n?1/e==1/n:e===n||!(!t(e)||!t(n))}},6991:(e,t,n)=>{"use strict";var r=n(1392),o=n(9527),i=n(8513),s=n(1140),a=n(1230),c=o(s(),Object);r(c,{getPolyfill:s,implementation:i,shim:a}),e.exports=c},1140:(e,t,n)=>{"use strict";var r=n(8513);e.exports=function(){return"function"==typeof Object.is?Object.is:r}},1230:(e,t,n)=>{"use strict";var r=n(1140),o=n(1392);e.exports=function(){var e=r();return o(Object,{is:e},{is:function(){return Object.is!==e}}),e}},2371:(e,t,n)=>{"use strict";var r;if(!Object.keys){var o=Object.prototype.hasOwnProperty,i=Object.prototype.toString,s=n(3549),a=Object.prototype.propertyIsEnumerable,c=!a.call({toString:null},"toString"),l=a.call((function(){}),"prototype"),u=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=function(e){var t=e.constructor;return t&&t.prototype===e},p={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},h=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!p["$"+e]&&o.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{d(window[e])}catch(e){return!0}}catch(e){return!0}return!1}();r=function(e){var t=null!==e&&"object"==typeof e,n="[object Function]"===i.call(e),r=s(e),a=t&&"[object String]"===i.call(e),p=[];if(!t&&!n&&!r)throw new TypeError("Object.keys called on a non-object");var f=l&&n;if(a&&e.length>0&&!o.call(e,0))for(var g=0;g<e.length;++g)p.push(String(g));if(r&&e.length>0)for(var m=0;m<e.length;++m)p.push(String(m));else for(var v in e)f&&"prototype"===v||!o.call(e,v)||p.push(String(v));if(c)for(var y=function(e){if("undefined"==typeof window||!h)return d(e);try{return d(e)}catch(e){return!1}}(e),b=0;b<u.length;++b)y&&"constructor"===u[b]||!o.call(e,u[b])||p.push(u[b]);return p}}e.exports=r},5453:(e,t,n)=>{"use strict";var r=Array.prototype.slice,o=n(3549),i=Object.keys,s=i?function(e){return i(e)}:n(2371),a=Object.keys;s.shim=function(){if(Object.keys){var e=function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2);e||(Object.keys=function(e){return o(e)?a(r.call(e)):a(e)})}else Object.keys=s;return Object.keys||s},e.exports=s},3549:e=>{"use strict";var t=Object.prototype.toString;e.exports=function(e){var n=t.call(e),r="[object Arguments]"===n;return r||(r="[object Array]"!==n&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Function]"===t.call(e.callee)),r}},5781:(e,t,n)=>{"use strict";var r=n(5453),o=n(2624)(),i=n(715),s=Object,a=i("Array.prototype.push"),c=i("Object.prototype.propertyIsEnumerable"),l=o?Object.getOwnPropertySymbols:null;e.exports=function(e,t){if(null==e)throw new TypeError("target must be an object");var n=s(e);if(1===arguments.length)return n;for(var i=1;i<arguments.length;++i){var u=s(arguments[i]),d=r(u),p=o&&(Object.getOwnPropertySymbols||l);if(p)for(var h=p(u),f=0;f<h.length;++f){var g=h[f];c(u,g)&&a(d,g)}for(var m=0;m<d.length;++m){var v=d[m];if(c(u,v)){var y=u[v];n[v]=y}}}return n}},7072:(e,t,n)=>{"use strict";var r=n(5781);e.exports=function(){return Object.assign?function(){if(!Object.assign)return!1;for(var e="abcdefghijklmnopqrst",t=e.split(""),n={},r=0;r<t.length;++r)n[t[r]]=t[r];var o=Object.assign({},n),i="";for(var s in o)i+=s;return e!==i}()||function(){if(!Object.assign||!Object.preventExtensions)return!1;var e=Object.preventExtensions({1:2});try{Object.assign(e,"xy")}catch(t){return"y"===e[1]}return!1}()?r:Object.assign:r}},4808:e=>{"use strict";e.exports=["Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]},7131:e=>{var t,n,r=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function s(e){if(t===setTimeout)return setTimeout(e,0);if((t===o||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:o}catch(e){t=o}try{n="function"==typeof clearTimeout?clearTimeout:i}catch(e){n=i}}();var a,c=[],l=!1,u=-1;function d(){l&&a&&(l=!1,a.length?c=a.concat(c):u=-1,c.length&&p())}function p(){if(!l){var e=s(d);l=!0;for(var t=c.length;t;){for(a=c,c=[];++u<t;)a&&a[u].run();u=-1,t=c.length}a=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===i||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{return n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function f(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new h(e,t)),1!==c.length||l||s(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=f,r.addListener=f,r.once=f,r.off=f,r.removeListener=f,r.removeAllListeners=f,r.emit=f,r.prependListener=f,r.prependOnceListener=f,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},9584:(e,t,n)=>{"use strict";var r=n(9307),o=n(7011),i=n(9593);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,c={};function l(e,t){u(e,t),u(e+"Capture",t)}function u(e,t){for(c[e]=t,e=0;e<t.length;e++)a.add(t[e])}var d=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),p=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},g={};function m(e,t,n,r,o,i,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=s}var v={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){v[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];v[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){v[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){v[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){v[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){v[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){v[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){v[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){v[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function b(e){return e[1].toUpperCase()}function S(e,t,n,r){var o=v.hasOwnProperty(t)?v[t]:null;(null!==o?0!==o.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null==t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,o,r)&&(n=null),r||null===o?function(e){return!!p.call(g,e)||!p.call(f,e)&&(h.test(e)?g[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=null===n?3!==o.type&&"":n:(t=o.attributeName,r=o.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(o=o.type)||4===o&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(y,b);v[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(y,b);v[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(y,b);v[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){v[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),v.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){v[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var w=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,C=Symbol.for("react.element"),E=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),P=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),N=Symbol.for("react.provider"),A=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),R=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var F=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var M=Symbol.iterator;function x(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=M&&e[M]||e["@@iterator"])?e:null}var _,U=Object.assign;function j(e){if(void 0===_)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);_=t&&t[1]||""}return"\n"+_+e}var z=!1;function q(e,t){if(!e||z)return"";z=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var r=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){r=e}e.call(t.prototype)}else{try{throw Error()}catch(e){r=e}e()}}catch(t){if(t&&r&&"string"==typeof t.stack){for(var o=t.stack.split("\n"),i=r.stack.split("\n"),s=o.length-1,a=i.length-1;1<=s&&0<=a&&o[s]!==i[a];)a--;for(;1<=s&&0<=a;s--,a--)if(o[s]!==i[a]){if(1!==s||1!==a)do{if(s--,0>--a||o[s]!==i[a]){var c="\n"+o[s].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}}while(1<=s&&0<=a);break}}}finally{z=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?j(e):""}function B(e){switch(e.tag){case 5:return j(e.type);case 16:return j("Lazy");case 13:return j("Suspense");case 19:return j("SuspenseList");case 0:case 2:case 15:return e=q(e.type,!1);case 11:return e=q(e.type.render,!1);case 1:return e=q(e.type,!0);default:return""}}function $(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case k:return"Fragment";case E:return"Portal";case T:return"Profiler";case P:return"StrictMode";case O:return"Suspense";case L:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case A:return(e.displayName||"Context")+".Consumer";case N:return(e._context.displayName||"Context")+".Provider";case I:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case D:return null!==(t=e.displayName||null)?t:$(e.type)||"Memo";case R:t=e._payload,e=e._init;try{return $(e(t))}catch(e){}}return null}function H(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return $(t);case 8:return t===P?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function G(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function V(e){e._valueTracker||(e._valueTracker=function(e){var t=G(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var o=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Q(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=G(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function J(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function K(e,t){var n=t.checked;return U({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Y(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=W(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function X(e,t){null!=(t=t.checked)&&S(e,"checked",t,!1)}function Z(e,t){X(e,t);var n=W(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?te(e,t.type,n):t.hasOwnProperty("defaultValue")&&te(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function ee(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function te(e,t,n){"number"===t&&J(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var ne=Array.isArray;function re(e,t,n,r){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&r&&(e[n].defaultSelected=!0)}else{for(n=""+W(n),t=null,o=0;o<e.length;o++){if(e[o].value===n)return e[o].selected=!0,void(r&&(e[o].defaultSelected=!0));null!==t||e[o].disabled||(t=e[o])}null!==t&&(t.selected=!0)}}function oe(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return U({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(ne(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:W(n)}}function se(e,t){var n=W(t.value),r=W(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ce(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ce(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ue,de,pe=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ue=ue||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ue.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return de(e,t)}))}:de);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ge=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ve(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),o=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,o):e[n]=o}}Object.keys(fe).forEach((function(e){ge.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var ye=U({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function be(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(s(62))}}function Se(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function Ce(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ee=null,ke=null,Pe=null;function Te(e){if(e=wo(e)){if("function"!=typeof Ee)throw Error(s(280));var t=e.stateNode;t&&(t=Eo(t),Ee(e.stateNode,e.type,t))}}function Ne(e){ke?Pe?Pe.push(e):Pe=[e]:ke=e}function Ae(){if(ke){var e=ke,t=Pe;if(Pe=ke=null,Te(e),t)for(e=0;e<t.length;e++)Te(t[e])}}function Ie(e,t){return e(t)}function Oe(){}var Le=!1;function De(e,t,n){if(Le)return e(t,n);Le=!0;try{return Ie(e,t,n)}finally{Le=!1,(null!==ke||null!==Pe)&&(Oe(),Ae())}}function Re(e,t){var n=e.stateNode;if(null===n)return null;var r=Eo(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(s(231,t,typeof n));return n}var Fe=!1;if(d)try{var Me={};Object.defineProperty(Me,"passive",{get:function(){Fe=!0}}),window.addEventListener("test",Me,Me),window.removeEventListener("test",Me,Me)}catch(de){Fe=!1}function xe(e,t,n,r,o,i,s,a,c){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(e){this.onError(e)}}var _e=!1,Ue=null,je=!1,ze=null,qe={onError:function(e){_e=!0,Ue=e}};function Be(e,t,n,r,o,i,s,a,c){_e=!1,Ue=null,xe.apply(qe,arguments)}function $e(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function He(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if($e(e)!==e)throw Error(s(188))}function Ge(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=$e(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var o=n.return;if(null===o)break;var i=o.alternate;if(null===i){if(null!==(r=o.return)){n=r;continue}break}if(o.child===i.child){for(i=o.child;i;){if(i===n)return We(o),e;if(i===r)return We(o),t;i=i.sibling}throw Error(s(188))}if(n.return!==r.return)n=o,r=i;else{for(var a=!1,c=o.child;c;){if(c===n){a=!0,n=o,r=i;break}if(c===r){a=!0,r=o,n=i;break}c=c.sibling}if(!a){for(c=i.child;c;){if(c===n){a=!0,n=i,r=o;break}if(c===r){a=!0,r=i,n=o;break}c=c.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e))?Ve(e):null}function Ve(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ve(e);if(null!==t)return t;e=e.sibling}return null}var Qe=i.unstable_scheduleCallback,Je=i.unstable_cancelCallback,Ke=i.unstable_shouldYield,Ye=i.unstable_requestPaint,Xe=i.unstable_now,Ze=i.unstable_getCurrentPriorityLevel,et=i.unstable_ImmediatePriority,tt=i.unstable_UserBlockingPriority,nt=i.unstable_NormalPriority,rt=i.unstable_LowPriority,ot=i.unstable_IdlePriority,it=null,st=null;var at=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ct(e)/lt|0)|0},ct=Math.log,lt=Math.LN2;var ut=64,dt=4194304;function pt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,o=e.suspendedLanes,i=e.pingedLanes,s=268435455&n;if(0!==s){var a=s&~o;0!==a?r=pt(a):0!==(i&=s)&&(r=pt(i))}else 0!==(s=n&~o)?r=pt(s):0!==i&&(r=pt(i));if(0===r)return 0;if(0!==t&&t!==r&&!(t&o)&&((o=r&-r)>=(i=t&-t)||16===o&&4194240&i))return t;if(4&r&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)o=1<<(n=31-at(t)),r|=e[n],t&=~o;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function gt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ut;return!(4194240&(ut<<=1))&&(ut=64),e}function vt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=n}function bt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-at(n),o=1<<r;o&t|e[r]&t&&(e[r]|=t),n&=~o}}var St=0;function wt(e){return 1<(e&=-e)?4<e?268435455&e?16:536870912:4:1}var Ct,Et,kt,Pt,Tt,Nt=!1,At=[],It=null,Ot=null,Lt=null,Dt=new Map,Rt=new Map,Ft=[],Mt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function xt(e,t){switch(e){case"focusin":case"focusout":It=null;break;case"dragenter":case"dragleave":Ot=null;break;case"mouseover":case"mouseout":Lt=null;break;case"pointerover":case"pointerout":Dt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rt.delete(t.pointerId)}}function _t(e,t,n,r,o,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[o]},null!==t&&(null!==(t=wo(t))&&Et(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==o&&-1===t.indexOf(o)&&t.push(o),e)}function Ut(e){var t=So(e.target);if(null!==t){var n=$e(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=He(n)))return e.blockedOn=t,void Tt(e.priority,(function(){kt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function jt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Kt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=wo(n))&&Et(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);we=r,n.target.dispatchEvent(r),we=null,t.shift()}return!0}function zt(e,t,n){jt(e)&&n.delete(t)}function qt(){Nt=!1,null!==It&&jt(It)&&(It=null),null!==Ot&&jt(Ot)&&(Ot=null),null!==Lt&&jt(Lt)&&(Lt=null),Dt.forEach(zt),Rt.forEach(zt)}function Bt(e,t){e.blockedOn===t&&(e.blockedOn=null,Nt||(Nt=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,qt)))}function $t(e){function t(t){return Bt(t,e)}if(0<At.length){Bt(At[0],e);for(var n=1;n<At.length;n++){var r=At[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==It&&Bt(It,e),null!==Ot&&Bt(Ot,e),null!==Lt&&Bt(Lt,e),Dt.forEach(t),Rt.forEach(t),n=0;n<Ft.length;n++)(r=Ft[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Ft.length&&null===(n=Ft[0]).blockedOn;)Ut(n),null===n.blockedOn&&Ft.shift()}var Ht=w.ReactCurrentBatchConfig,Wt=!0;function Gt(e,t,n,r){var o=St,i=Ht.transition;Ht.transition=null;try{St=1,Qt(e,t,n,r)}finally{St=o,Ht.transition=i}}function Vt(e,t,n,r){var o=St,i=Ht.transition;Ht.transition=null;try{St=4,Qt(e,t,n,r)}finally{St=o,Ht.transition=i}}function Qt(e,t,n,r){if(Wt){var o=Kt(e,t,n,r);if(null===o)Wr(e,t,r,Jt,n),xt(e,r);else if(function(e,t,n,r,o){switch(t){case"focusin":return It=_t(It,e,t,n,r,o),!0;case"dragenter":return Ot=_t(Ot,e,t,n,r,o),!0;case"mouseover":return Lt=_t(Lt,e,t,n,r,o),!0;case"pointerover":var i=o.pointerId;return Dt.set(i,_t(Dt.get(i)||null,e,t,n,r,o)),!0;case"gotpointercapture":return i=o.pointerId,Rt.set(i,_t(Rt.get(i)||null,e,t,n,r,o)),!0}return!1}(o,e,t,n,r))r.stopPropagation();else if(xt(e,r),4&t&&-1<Mt.indexOf(e)){for(;null!==o;){var i=wo(o);if(null!==i&&Ct(i),null===(i=Kt(e,t,n,r))&&Wr(e,t,r,Jt,n),i===o)break;o=i}null!==o&&r.stopPropagation()}else Wr(e,t,r,null,n)}}var Jt=null;function Kt(e,t,n,r){if(Jt=null,null!==(e=So(e=Ce(r))))if(null===(t=$e(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=He(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Jt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ze()){case et:return 1;case tt:return 4;case nt:case rt:return 16;case ot:return 536870912;default:return 16}default:return 16}}var Xt=null,Zt=null,en=null;function tn(){if(en)return en;var e,t,n=Zt,r=n.length,o="value"in Xt?Xt.value:Xt.textContent,i=o.length;for(e=0;e<r&&n[e]===o[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===o[i-t];t++);return en=o.slice(e,1<t?1-t:void 0)}function nn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function rn(){return!0}function on(){return!1}function sn(e){function t(t,n,r,o,i){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=o,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(o):o[s]);return this.isDefaultPrevented=(null!=o.defaultPrevented?o.defaultPrevented:!1===o.returnValue)?rn:on,this.isPropagationStopped=on,this}return U(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=rn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=rn)},persist:function(){},isPersistent:rn}),t}var an,cn,ln,un={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dn=sn(un),pn=U({},un,{view:0,detail:0}),hn=sn(pn),fn=U({},pn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(an=e.screenX-ln.screenX,cn=e.screenY-ln.screenY):cn=an=0,ln=e),an)},movementY:function(e){return"movementY"in e?e.movementY:cn}}),gn=sn(fn),mn=sn(U({},fn,{dataTransfer:0})),vn=sn(U({},pn,{relatedTarget:0})),yn=sn(U({},un,{animationName:0,elapsedTime:0,pseudoElement:0})),bn=U({},un,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Sn=sn(bn),wn=sn(U({},un,{data:0})),Cn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},En={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=kn[e])&&!!t[e]}function Tn(){return Pn}var Nn=U({},pn,{key:function(e){if(e.key){var t=Cn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=nn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?En[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tn,charCode:function(e){return"keypress"===e.type?nn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?nn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),An=sn(Nn),In=sn(U({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),On=sn(U({},pn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tn})),Ln=sn(U({},un,{propertyName:0,elapsedTime:0,pseudoElement:0})),Dn=U({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Rn=sn(Dn),Fn=[9,13,27,32],Mn=d&&"CompositionEvent"in window,xn=null;d&&"documentMode"in document&&(xn=document.documentMode);var _n=d&&"TextEvent"in window&&!xn,Un=d&&(!Mn||xn&&8<xn&&11>=xn),jn=String.fromCharCode(32),zn=!1;function qn(e,t){switch(e){case"keyup":return-1!==Fn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bn(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var $n=!1;var Hn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Hn[e.type]:"textarea"===t}function Gn(e,t,n,r){Ne(r),0<(t=Vr(t,"onChange")).length&&(n=new dn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Vn=null,Qn=null;function Jn(e){jr(e,0)}function Kn(e){if(Q(Co(e)))return e}function Yn(e,t){if("change"===e)return t}var Xn=!1;if(d){var Zn;if(d){var er="oninput"in document;if(!er){var tr=document.createElement("div");tr.setAttribute("oninput","return;"),er="function"==typeof tr.oninput}Zn=er}else Zn=!1;Xn=Zn&&(!document.documentMode||9<document.documentMode)}function nr(){Vn&&(Vn.detachEvent("onpropertychange",rr),Qn=Vn=null)}function rr(e){if("value"===e.propertyName&&Kn(Qn)){var t=[];Gn(t,Qn,e,Ce(e)),De(Jn,t)}}function or(e,t,n){"focusin"===e?(nr(),Qn=n,(Vn=t).attachEvent("onpropertychange",rr)):"focusout"===e&&nr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Kn(Qn)}function sr(e,t){if("click"===e)return Kn(t)}function ar(e,t){if("input"===e||"change"===e)return Kn(t)}var cr="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function lr(e,t){if(cr(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!p.call(t,o)||!cr(e[o],t[o]))return!1}return!0}function ur(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dr(e,t){var n,r=ur(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=ur(r)}}function pr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?pr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=J();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(e){n=!1}if(!n)break;t=J((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function gr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&pr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var o=n.textContent.length,i=Math.min(r.start,o);r=void 0===r.end?i:Math.min(r.end,o),!e.extend&&i>r&&(o=r,r=i,i=o),o=dr(n,i);var s=dr(n,r);o&&s&&(1!==e.rangeCount||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(o.node,o.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"==typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=d&&"documentMode"in document&&11>=document.documentMode,vr=null,yr=null,br=null,Sr=!1;function wr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;Sr||null==vr||vr!==J(r)||("selectionStart"in(r=vr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},br&&lr(br,r)||(br=r,0<(r=Vr(yr,"onSelect")).length&&(t=new dn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=vr)))}function Cr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Er={animationend:Cr("Animation","AnimationEnd"),animationiteration:Cr("Animation","AnimationIteration"),animationstart:Cr("Animation","AnimationStart"),transitionend:Cr("Transition","TransitionEnd")},kr={},Pr={};function Tr(e){if(kr[e])return kr[e];if(!Er[e])return e;var t,n=Er[e];for(t in n)if(n.hasOwnProperty(t)&&t in Pr)return kr[e]=n[t];return e}d&&(Pr=document.createElement("div").style,"AnimationEvent"in window||(delete Er.animationend.animation,delete Er.animationiteration.animation,delete Er.animationstart.animation),"TransitionEvent"in window||delete Er.transitionend.transition);var Nr=Tr("animationend"),Ar=Tr("animationiteration"),Ir=Tr("animationstart"),Or=Tr("transitionend"),Lr=new Map,Dr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rr(e,t){Lr.set(e,t),l(t,[e])}for(var Fr=0;Fr<Dr.length;Fr++){var Mr=Dr[Fr];Rr(Mr.toLowerCase(),"on"+(Mr[0].toUpperCase()+Mr.slice(1)))}Rr(Nr,"onAnimationEnd"),Rr(Ar,"onAnimationIteration"),Rr(Ir,"onAnimationStart"),Rr("dblclick","onDoubleClick"),Rr("focusin","onFocus"),Rr("focusout","onBlur"),Rr(Or,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),_r=new Set("cancel close invalid load scroll toggle".split(" ").concat(xr));function Ur(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,o,i,a,c,l){if(Be.apply(this,arguments),_e){if(!_e)throw Error(s(198));var u=Ue;_e=!1,Ue=null,je||(je=!0,ze=u)}}(r,t,void 0,e),e.currentTarget=null}function jr(e,t){t=!!(4&t);for(var n=0;n<e.length;n++){var r=e[n],o=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var s=r.length-1;0<=s;s--){var a=r[s],c=a.instance,l=a.currentTarget;if(a=a.listener,c!==i&&o.isPropagationStopped())break e;Ur(o,a,l),i=c}else for(s=0;s<r.length;s++){if(c=(a=r[s]).instance,l=a.currentTarget,a=a.listener,c!==i&&o.isPropagationStopped())break e;Ur(o,a,l),i=c}}}if(je)throw e=ze,je=!1,ze=null,e}function zr(e,t){var n=t[vo];void 0===n&&(n=t[vo]=new Set);var r=e+"__bubble";n.has(r)||(Hr(t,e,2,!1),n.add(r))}function qr(e,t,n){var r=0;t&&(r|=4),Hr(n,e,r,t)}var Br="_reactListening"+Math.random().toString(36).slice(2);function $r(e){if(!e[Br]){e[Br]=!0,a.forEach((function(t){"selectionchange"!==t&&(_r.has(t)||qr(t,!1,e),qr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Br]||(t[Br]=!0,qr("selectionchange",!1,t))}}function Hr(e,t,n,r){switch(Yt(t)){case 1:var o=Gt;break;case 4:o=Vt;break;default:o=Qt}n=o.bind(null,t,n,e),o=void 0,!Fe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(o=!0),r?void 0!==o?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):void 0!==o?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function Wr(e,t,n,r,o){var i=r;if(!(1&t||2&t||null===r))e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var a=r.stateNode.containerInfo;if(a===o||8===a.nodeType&&a.parentNode===o)break;if(4===s)for(s=r.return;null!==s;){var c=s.tag;if((3===c||4===c)&&((c=s.stateNode.containerInfo)===o||8===c.nodeType&&c.parentNode===o))return;s=s.return}for(;null!==a;){if(null===(s=So(a)))return;if(5===(c=s.tag)||6===c){r=i=s;continue e}a=a.parentNode}}r=r.return}De((function(){var r=i,o=Ce(n),s=[];e:{var a=Lr.get(e);if(void 0!==a){var c=dn,l=e;switch(e){case"keypress":if(0===nn(n))break e;case"keydown":case"keyup":c=An;break;case"focusin":l="focus",c=vn;break;case"focusout":l="blur",c=vn;break;case"beforeblur":case"afterblur":c=vn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=gn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=On;break;case Nr:case Ar:case Ir:c=yn;break;case Or:c=Ln;break;case"scroll":c=hn;break;case"wheel":c=Rn;break;case"copy":case"cut":case"paste":c=Sn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=In}var u=!!(4&t),d=!u&&"scroll"===e,p=u?null!==a?a+"Capture":null:a;u=[];for(var h,f=r;null!==f;){var g=(h=f).stateNode;if(5===h.tag&&null!==g&&(h=g,null!==p&&(null!=(g=Re(f,p))&&u.push(Gr(f,g,h)))),d)break;f=f.return}0<u.length&&(a=new c(a,l,null,n,o),s.push({event:a,listeners:u}))}}if(!(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===we||!(l=n.relatedTarget||n.fromElement)||!So(l)&&!l[mo])&&(c||a)&&(a=o.window===o?o:(a=o.ownerDocument)?a.defaultView||a.parentWindow:window,c?(c=r,null!==(l=(l=n.relatedTarget||n.toElement)?So(l):null)&&(l!==(d=$e(l))||5!==l.tag&&6!==l.tag)&&(l=null)):(c=null,l=r),c!==l)){if(u=gn,g="onMouseLeave",p="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=In,g="onPointerLeave",p="onPointerEnter",f="pointer"),d=null==c?a:Co(c),h=null==l?a:Co(l),(a=new u(g,f+"leave",c,n,o)).target=d,a.relatedTarget=h,g=null,So(o)===r&&((u=new u(p,f+"enter",l,n,o)).target=h,u.relatedTarget=d,g=u),d=g,c&&l)e:{for(p=l,f=0,h=u=c;h;h=Qr(h))f++;for(h=0,g=p;g;g=Qr(g))h++;for(;0<f-h;)u=Qr(u),f--;for(;0<h-f;)p=Qr(p),h--;for(;f--;){if(u===p||null!==p&&u===p.alternate)break e;u=Qr(u),p=Qr(p)}u=null}else u=null;null!==c&&Jr(s,a,c,u,!1),null!==l&&null!==d&&Jr(s,d,l,u,!0)}if("select"===(c=(a=r?Co(r):window).nodeName&&a.nodeName.toLowerCase())||"input"===c&&"file"===a.type)var m=Yn;else if(Wn(a))if(Xn)m=ar;else{m=ir;var v=or}else(c=a.nodeName)&&"input"===c.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(m=sr);switch(m&&(m=m(e,r))?Gn(s,m,n,o):(v&&v(e,a,r),"focusout"===e&&(v=a._wrapperState)&&v.controlled&&"number"===a.type&&te(a,"number",a.value)),v=r?Co(r):window,e){case"focusin":(Wn(v)||"true"===v.contentEditable)&&(vr=v,yr=r,br=null);break;case"focusout":br=yr=vr=null;break;case"mousedown":Sr=!0;break;case"contextmenu":case"mouseup":case"dragend":Sr=!1,wr(s,n,o);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":wr(s,n,o)}var y;if(Mn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else $n?qn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Un&&"ko"!==n.locale&&($n||"onCompositionStart"!==b?"onCompositionEnd"===b&&$n&&(y=tn()):(Zt="value"in(Xt=o)?Xt.value:Xt.textContent,$n=!0)),0<(v=Vr(r,b)).length&&(b=new wn(b,e,null,n,o),s.push({event:b,listeners:v}),y?b.data=y:null!==(y=Bn(n))&&(b.data=y))),(y=_n?function(e,t){switch(e){case"compositionend":return Bn(t);case"keypress":return 32!==t.which?null:(zn=!0,jn);case"textInput":return(e=t.data)===jn&&zn?null:e;default:return null}}(e,n):function(e,t){if($n)return"compositionend"===e||!Mn&&qn(e,t)?(e=tn(),en=Zt=Xt=null,$n=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Un&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Vr(r,"onBeforeInput")).length&&(o=new wn("onBeforeInput","beforeinput",null,n,o),s.push({event:o,listeners:r}),o.data=y))}jr(s,t)}))}function Gr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Vr(e,t){for(var n=t+"Capture",r=[];null!==e;){var o=e,i=o.stateNode;5===o.tag&&null!==i&&(o=i,null!=(i=Re(e,n))&&r.unshift(Gr(e,i,o)),null!=(i=Re(e,t))&&r.push(Gr(e,i,o))),e=e.return}return r}function Qr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Jr(e,t,n,r,o){for(var i=t._reactName,s=[];null!==n&&n!==r;){var a=n,c=a.alternate,l=a.stateNode;if(null!==c&&c===r)break;5===a.tag&&null!==l&&(a=l,o?null!=(c=Re(n,i))&&s.unshift(Gr(n,c,a)):o||null!=(c=Re(n,i))&&s.push(Gr(n,c,a))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Kr=/\r\n?/g,Yr=/\u0000|\uFFFD/g;function Xr(e){return("string"==typeof e?e:""+e).replace(Kr,"\n").replace(Yr,"")}function Zr(e,t,n){if(t=Xr(t),Xr(e)!==t&&n)throw Error(s(425))}function eo(){}var to=null,no=null;function ro(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var oo="function"==typeof setTimeout?setTimeout:void 0,io="function"==typeof clearTimeout?clearTimeout:void 0,so="function"==typeof Promise?Promise:void 0,ao="function"==typeof queueMicrotask?queueMicrotask:void 0!==so?function(e){return so.resolve(null).then(e).catch(co)}:oo;function co(e){setTimeout((function(){throw e}))}function lo(e,t){var n=t,r=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&8===o.nodeType)if("/$"===(n=o.data)){if(0===r)return e.removeChild(o),void $t(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=o}while(n);$t(t)}function uo(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function po(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ho=Math.random().toString(36).slice(2),fo="__reactFiber$"+ho,go="__reactProps$"+ho,mo="__reactContainer$"+ho,vo="__reactEvents$"+ho,yo="__reactListeners$"+ho,bo="__reactHandles$"+ho;function So(e){var t=e[fo];if(t)return t;for(var n=e.parentNode;n;){if(t=n[mo]||n[fo]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=po(e);null!==e;){if(n=e[fo])return n;e=po(e)}return t}n=(e=n).parentNode}return null}function wo(e){return!(e=e[fo]||e[mo])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Co(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function Eo(e){return e[go]||null}var ko=[],Po=-1;function To(e){return{current:e}}function No(e){0>Po||(e.current=ko[Po],ko[Po]=null,Po--)}function Ao(e,t){Po++,ko[Po]=e.current,e.current=t}var Io={},Oo=To(Io),Lo=To(!1),Do=Io;function Ro(e,t){var n=e.type.contextTypes;if(!n)return Io;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var o,i={};for(o in n)i[o]=t[o];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Fo(e){return null!=(e=e.childContextTypes)}function Mo(){No(Lo),No(Oo)}function xo(e,t,n){if(Oo.current!==Io)throw Error(s(168));Ao(Oo,t),Ao(Lo,n)}function _o(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!=typeof r.getChildContext)return n;for(var o in r=r.getChildContext())if(!(o in t))throw Error(s(108,H(e)||"Unknown",o));return U({},n,r)}function Uo(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Io,Do=Oo.current,Ao(Oo,e),Ao(Lo,Lo.current),!0}function jo(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=_o(e,t,Do),r.__reactInternalMemoizedMergedChildContext=e,No(Lo),No(Oo),Ao(Oo,e)):No(Lo),Ao(Lo,n)}var zo=null,qo=!1,Bo=!1;function $o(e){null===zo?zo=[e]:zo.push(e)}function Ho(){if(!Bo&&null!==zo){Bo=!0;var e=0,t=St;try{var n=zo;for(St=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}zo=null,qo=!1}catch(t){throw null!==zo&&(zo=zo.slice(e+1)),Qe(et,Ho),t}finally{St=t,Bo=!1}}return null}var Wo=[],Go=0,Vo=null,Qo=0,Jo=[],Ko=0,Yo=null,Xo=1,Zo="";function ei(e,t){Wo[Go++]=Qo,Wo[Go++]=Vo,Vo=e,Qo=t}function ti(e,t,n){Jo[Ko++]=Xo,Jo[Ko++]=Zo,Jo[Ko++]=Yo,Yo=e;var r=Xo;e=Zo;var o=32-at(r)-1;r&=~(1<<o),n+=1;var i=32-at(t)+o;if(30<i){var s=o-o%5;i=(r&(1<<s)-1).toString(32),r>>=s,o-=s,Xo=1<<32-at(t)+o|n<<o|r,Zo=i+e}else Xo=1<<i|n<<o|r,Zo=e}function ni(e){null!==e.return&&(ei(e,1),ti(e,1,0))}function ri(e){for(;e===Vo;)Vo=Wo[--Go],Wo[Go]=null,Qo=Wo[--Go],Wo[Go]=null;for(;e===Yo;)Yo=Jo[--Ko],Jo[Ko]=null,Zo=Jo[--Ko],Jo[Ko]=null,Xo=Jo[--Ko],Jo[Ko]=null}var oi=null,ii=null,si=!1,ai=null;function ci(e,t){var n=Dl(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function li(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,oi=e,ii=uo(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,oi=e,ii=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Yo?{id:Xo,overflow:Zo}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Dl(18,null,null,0)).stateNode=t,n.return=e,e.child=n,oi=e,ii=null,!0);default:return!1}}function ui(e){return!(!(1&e.mode)||128&e.flags)}function di(e){if(si){var t=ii;if(t){var n=t;if(!li(e,t)){if(ui(e))throw Error(s(418));t=uo(n.nextSibling);var r=oi;t&&li(e,t)?ci(r,n):(e.flags=-4097&e.flags|2,si=!1,oi=e)}}else{if(ui(e))throw Error(s(418));e.flags=-4097&e.flags|2,si=!1,oi=e}}}function pi(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;oi=e}function hi(e){if(e!==oi)return!1;if(!si)return pi(e),si=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ro(e.type,e.memoizedProps)),t&&(t=ii)){if(ui(e))throw fi(),Error(s(418));for(;t;)ci(e,t),t=uo(t.nextSibling)}if(pi(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ii=uo(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ii=null}}else ii=oi?uo(e.stateNode.nextSibling):null;return!0}function fi(){for(var e=ii;e;)e=uo(e.nextSibling)}function gi(){ii=oi=null,si=!1}function mi(e){null===ai?ai=[e]:ai.push(e)}var vi=w.ReactCurrentBatchConfig;function yi(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var o=r,i=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=o.refs;null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!=typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function bi(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Si(e){return(0,e._init)(e._payload)}function wi(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function o(e,t){return(e=Fl(e,t)).index=0,e.sibling=null,e}function i(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function c(e,t,n,r){return null===t||6!==t.tag?((t=Ul(n,e.mode,r)).return=e,t):((t=o(t,n)).return=e,t)}function l(e,t,n,r){var i=n.type;return i===k?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"==typeof i&&null!==i&&i.$$typeof===R&&Si(i)===t.type)?((r=o(t,n.props)).ref=yi(e,t,n),r.return=e,r):((r=Ml(n.type,n.key,n.props,null,e.mode,r)).ref=yi(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=jl(n,e.mode,r)).return=e,t):((t=o(t,n.children||[])).return=e,t)}function d(e,t,n,r,i){return null===t||7!==t.tag?((t=xl(n,e.mode,r,i)).return=e,t):((t=o(t,n)).return=e,t)}function p(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=Ul(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case C:return(n=Ml(t.type,t.key,t.props,null,e.mode,n)).ref=yi(e,null,t),n.return=e,n;case E:return(t=jl(t,e.mode,n)).return=e,t;case R:return p(e,(0,t._init)(t._payload),n)}if(ne(t)||x(t))return(t=xl(t,e.mode,n,null)).return=e,t;bi(e,t)}return null}function h(e,t,n,r){var o=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n)return null!==o?null:c(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case C:return n.key===o?l(e,t,n,r):null;case E:return n.key===o?u(e,t,n,r):null;case R:return h(e,t,(o=n._init)(n._payload),r)}if(ne(n)||x(n))return null!==o?null:d(e,t,n,r,null);bi(e,n)}return null}function f(e,t,n,r,o){if("string"==typeof r&&""!==r||"number"==typeof r)return c(t,e=e.get(n)||null,""+r,o);if("object"==typeof r&&null!==r){switch(r.$$typeof){case C:return l(t,e=e.get(null===r.key?n:r.key)||null,r,o);case E:return u(t,e=e.get(null===r.key?n:r.key)||null,r,o);case R:return f(e,t,n,(0,r._init)(r._payload),o)}if(ne(r)||x(r))return d(t,e=e.get(n)||null,r,o,null);bi(t,r)}return null}function g(o,s,a,c){for(var l=null,u=null,d=s,g=s=0,m=null;null!==d&&g<a.length;g++){d.index>g?(m=d,d=null):m=d.sibling;var v=h(o,d,a[g],c);if(null===v){null===d&&(d=m);break}e&&d&&null===v.alternate&&t(o,d),s=i(v,s,g),null===u?l=v:u.sibling=v,u=v,d=m}if(g===a.length)return n(o,d),si&&ei(o,g),l;if(null===d){for(;g<a.length;g++)null!==(d=p(o,a[g],c))&&(s=i(d,s,g),null===u?l=d:u.sibling=d,u=d);return si&&ei(o,g),l}for(d=r(o,d);g<a.length;g++)null!==(m=f(d,o,g,a[g],c))&&(e&&null!==m.alternate&&d.delete(null===m.key?g:m.key),s=i(m,s,g),null===u?l=m:u.sibling=m,u=m);return e&&d.forEach((function(e){return t(o,e)})),si&&ei(o,g),l}function m(o,a,c,l){var u=x(c);if("function"!=typeof u)throw Error(s(150));if(null==(c=u.call(c)))throw Error(s(151));for(var d=u=null,g=a,m=a=0,v=null,y=c.next();null!==g&&!y.done;m++,y=c.next()){g.index>m?(v=g,g=null):v=g.sibling;var b=h(o,g,y.value,l);if(null===b){null===g&&(g=v);break}e&&g&&null===b.alternate&&t(o,g),a=i(b,a,m),null===d?u=b:d.sibling=b,d=b,g=v}if(y.done)return n(o,g),si&&ei(o,m),u;if(null===g){for(;!y.done;m++,y=c.next())null!==(y=p(o,y.value,l))&&(a=i(y,a,m),null===d?u=y:d.sibling=y,d=y);return si&&ei(o,m),u}for(g=r(o,g);!y.done;m++,y=c.next())null!==(y=f(g,o,m,y.value,l))&&(e&&null!==y.alternate&&g.delete(null===y.key?m:y.key),a=i(y,a,m),null===d?u=y:d.sibling=y,d=y);return e&&g.forEach((function(e){return t(o,e)})),si&&ei(o,m),u}return function e(r,i,s,c){if("object"==typeof s&&null!==s&&s.type===k&&null===s.key&&(s=s.props.children),"object"==typeof s&&null!==s){switch(s.$$typeof){case C:e:{for(var l=s.key,u=i;null!==u;){if(u.key===l){if((l=s.type)===k){if(7===u.tag){n(r,u.sibling),(i=o(u,s.props.children)).return=r,r=i;break e}}else if(u.elementType===l||"object"==typeof l&&null!==l&&l.$$typeof===R&&Si(l)===u.type){n(r,u.sibling),(i=o(u,s.props)).ref=yi(r,u,s),i.return=r,r=i;break e}n(r,u);break}t(r,u),u=u.sibling}s.type===k?((i=xl(s.props.children,r.mode,c,s.key)).return=r,r=i):((c=Ml(s.type,s.key,s.props,null,r.mode,c)).ref=yi(r,i,s),c.return=r,r=c)}return a(r);case E:e:{for(u=s.key;null!==i;){if(i.key===u){if(4===i.tag&&i.stateNode.containerInfo===s.containerInfo&&i.stateNode.implementation===s.implementation){n(r,i.sibling),(i=o(i,s.children||[])).return=r,r=i;break e}n(r,i);break}t(r,i),i=i.sibling}(i=jl(s,r.mode,c)).return=r,r=i}return a(r);case R:return e(r,i,(u=s._init)(s._payload),c)}if(ne(s))return g(r,i,s,c);if(x(s))return m(r,i,s,c);bi(r,s)}return"string"==typeof s&&""!==s||"number"==typeof s?(s=""+s,null!==i&&6===i.tag?(n(r,i.sibling),(i=o(i,s)).return=r,r=i):(n(r,i),(i=Ul(s,r.mode,c)).return=r,r=i),a(r)):n(r,i)}}var Ci=wi(!0),Ei=wi(!1),ki=To(null),Pi=null,Ti=null,Ni=null;function Ai(){Ni=Ti=Pi=null}function Ii(e){var t=ki.current;No(ki),e._currentValue=t}function Oi(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Li(e,t){Pi=e,Ni=Ti=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(!!(e.lanes&t)&&(Sa=!0),e.firstContext=null)}function Di(e){var t=e._currentValue;if(Ni!==e)if(e={context:e,memoizedValue:t,next:null},null===Ti){if(null===Pi)throw Error(s(308));Ti=e,Pi.dependencies={lanes:0,firstContext:e}}else Ti=Ti.next=e;return t}var Ri=null;function Fi(e){null===Ri?Ri=[e]:Ri.push(e)}function Mi(e,t,n,r){var o=t.interleaved;return null===o?(n.next=n,Fi(t)):(n.next=o.next,o.next=n),t.interleaved=n,xi(e,r)}function xi(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var _i=!1;function Ui(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ji(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function zi(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function qi(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,2&Ic){var o=r.pending;return null===o?t.next=t:(t.next=o.next,o.next=t),r.pending=t,xi(e,n)}return null===(o=r.interleaved)?(t.next=t,Fi(r)):(t.next=o.next,o.next=t),r.interleaved=t,xi(e,n)}function Bi(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,bt(e,n)}}function $i(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var o=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?o=i=s:i=i.next=s,n=n.next}while(null!==n);null===i?o=i=t:i=i.next=t}else o=i=t;return n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Hi(e,t,n,r){var o=e.updateQueue;_i=!1;var i=o.firstBaseUpdate,s=o.lastBaseUpdate,a=o.shared.pending;if(null!==a){o.shared.pending=null;var c=a,l=c.next;c.next=null,null===s?i=l:s.next=l,s=c;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===a?u.firstBaseUpdate=l:a.next=l,u.lastBaseUpdate=c))}if(null!==i){var d=o.baseState;for(s=0,u=l=c=null,a=i;;){var p=a.lane,h=a.eventTime;if((r&p)===p){null!==u&&(u=u.next={eventTime:h,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var f=e,g=a;switch(p=t,h=n,g.tag){case 1:if("function"==typeof(f=g.payload)){d=f.call(h,d,p);break e}d=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null==(p="function"==typeof(f=g.payload)?f.call(h,d,p):f))break e;d=U({},d,p);break e;case 2:_i=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(p=o.effects)?o.effects=[a]:p.push(a))}else h={eventTime:h,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(l=u=h,c=d):u=u.next=h,s|=p;if(null===(a=a.next)){if(null===(a=o.shared.pending))break;a=(p=a).next,p.next=null,o.lastBaseUpdate=p,o.shared.pending=null}}if(null===u&&(c=d),o.baseState=c,o.firstBaseUpdate=l,o.lastBaseUpdate=u,null!==(t=o.shared.interleaved)){o=t;do{s|=o.lane,o=o.next}while(o!==t)}else null===i&&(o.shared.lanes=0);_c|=s,e.lanes=s,e.memoizedState=d}}function Wi(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],o=r.callback;if(null!==o){if(r.callback=null,r=n,"function"!=typeof o)throw Error(s(191,o));o.call(r)}}}var Gi={},Vi=To(Gi),Qi=To(Gi),Ji=To(Gi);function Ki(e){if(e===Gi)throw Error(s(174));return e}function Yi(e,t){switch(Ao(Ji,t),Ao(Qi,e),Ao(Vi,Gi),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}No(Vi),Ao(Vi,t)}function Xi(){No(Vi),No(Qi),No(Ji)}function Zi(e){Ki(Ji.current);var t=Ki(Vi.current),n=le(t,e.type);t!==n&&(Ao(Qi,e),Ao(Vi,n))}function es(e){Qi.current===e&&(No(Vi),No(Qi))}var ts=To(0);function ns(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(128&t.flags)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var rs=[];function os(){for(var e=0;e<rs.length;e++)rs[e]._workInProgressVersionPrimary=null;rs.length=0}var is=w.ReactCurrentDispatcher,ss=w.ReactCurrentBatchConfig,as=0,cs=null,ls=null,us=null,ds=!1,ps=!1,hs=0,fs=0;function gs(){throw Error(s(321))}function ms(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!cr(e[n],t[n]))return!1;return!0}function vs(e,t,n,r,o,i){if(as=i,cs=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,is.current=null===e||null===e.memoizedState?ea:ta,e=n(r,o),ps){i=0;do{if(ps=!1,hs=0,25<=i)throw Error(s(301));i+=1,us=ls=null,t.updateQueue=null,is.current=na,e=n(r,o)}while(ps)}if(is.current=Zs,t=null!==ls&&null!==ls.next,as=0,us=ls=cs=null,ds=!1,t)throw Error(s(300));return e}function ys(){var e=0!==hs;return hs=0,e}function bs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===us?cs.memoizedState=us=e:us=us.next=e,us}function Ss(){if(null===ls){var e=cs.alternate;e=null!==e?e.memoizedState:null}else e=ls.next;var t=null===us?cs.memoizedState:us.next;if(null!==t)us=t,ls=e;else{if(null===e)throw Error(s(310));e={memoizedState:(ls=e).memoizedState,baseState:ls.baseState,baseQueue:ls.baseQueue,queue:ls.queue,next:null},null===us?cs.memoizedState=us=e:us=us.next=e}return us}function ws(e,t){return"function"==typeof t?t(e):t}function Cs(e){var t=Ss(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=ls,o=r.baseQueue,i=n.pending;if(null!==i){if(null!==o){var a=o.next;o.next=i.next,i.next=a}r.baseQueue=o=i,n.pending=null}if(null!==o){i=o.next,r=r.baseState;var c=a=null,l=null,u=i;do{var d=u.lane;if((as&d)===d)null!==l&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var p={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===l?(c=l=p,a=r):l=l.next=p,cs.lanes|=d,_c|=d}u=u.next}while(null!==u&&u!==i);null===l?a=r:l.next=c,cr(r,t.memoizedState)||(Sa=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=l,n.lastRenderedState=r}if(null!==(e=n.interleaved)){o=e;do{i=o.lane,cs.lanes|=i,_c|=i,o=o.next}while(o!==e)}else null===o&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Es(e){var t=Ss(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,o=n.pending,i=t.memoizedState;if(null!==o){n.pending=null;var a=o=o.next;do{i=e(i,a.action),a=a.next}while(a!==o);cr(i,t.memoizedState)||(Sa=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function ks(){}function Ps(e,t){var n=cs,r=Ss(),o=t(),i=!cr(r.memoizedState,o);if(i&&(r.memoizedState=o,Sa=!0),r=r.queue,_s(As.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||null!==us&&1&us.memoizedState.tag){if(n.flags|=2048,Ds(9,Ns.bind(null,n,r,o,t),void 0,null),null===Oc)throw Error(s(349));30&as||Ts(n,t,o)}return o}function Ts(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=cs.updateQueue)?(t={lastEffect:null,stores:null},cs.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ns(e,t,n,r){t.value=n,t.getSnapshot=r,Is(t)&&Os(e)}function As(e,t,n){return n((function(){Is(t)&&Os(e)}))}function Is(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!cr(e,n)}catch(e){return!0}}function Os(e){var t=xi(e,1);null!==t&&rl(t,e,1,-1)}function Ls(e){var t=bs();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ws,lastRenderedState:e},t.queue=e,e=e.dispatch=Js.bind(null,cs,e),[t.memoizedState,e]}function Ds(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=cs.updateQueue)?(t={lastEffect:null,stores:null},cs.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Rs(){return Ss().memoizedState}function Fs(e,t,n,r){var o=bs();cs.flags|=e,o.memoizedState=Ds(1|t,n,void 0,void 0===r?null:r)}function Ms(e,t,n,r){var o=Ss();r=void 0===r?null:r;var i=void 0;if(null!==ls){var s=ls.memoizedState;if(i=s.destroy,null!==r&&ms(r,s.deps))return void(o.memoizedState=Ds(t,n,i,r))}cs.flags|=e,o.memoizedState=Ds(1|t,n,i,r)}function xs(e,t){return Fs(8390656,8,e,t)}function _s(e,t){return Ms(2048,8,e,t)}function Us(e,t){return Ms(4,2,e,t)}function js(e,t){return Ms(4,4,e,t)}function zs(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function qs(e,t,n){return n=null!=n?n.concat([e]):null,Ms(4,4,zs.bind(null,t,e),n)}function Bs(){}function $s(e,t){var n=Ss();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ms(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Hs(e,t){var n=Ss();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ms(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Ws(e,t,n){return 21&as?(cr(n,t)||(n=mt(),cs.lanes|=n,_c|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Sa=!0),e.memoizedState=n)}function Gs(e,t){var n=St;St=0!==n&&4>n?n:4,e(!0);var r=ss.transition;ss.transition={};try{e(!1),t()}finally{St=n,ss.transition=r}}function Vs(){return Ss().memoizedState}function Qs(e,t,n){var r=nl(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Ks(e))Ys(t,n);else if(null!==(n=Mi(e,t,n,r))){rl(n,e,r,tl()),Xs(n,t,r)}}function Js(e,t,n){var r=nl(e),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ks(e))Ys(t,o);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var s=t.lastRenderedState,a=i(s,n);if(o.hasEagerState=!0,o.eagerState=a,cr(a,s)){var c=t.interleaved;return null===c?(o.next=o,Fi(t)):(o.next=c.next,c.next=o),void(t.interleaved=o)}}catch(e){}null!==(n=Mi(e,t,o,r))&&(rl(n,e,r,o=tl()),Xs(n,t,r))}}function Ks(e){var t=e.alternate;return e===cs||null!==t&&t===cs}function Ys(e,t){ps=ds=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Xs(e,t,n){if(4194240&n){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,bt(e,n)}}var Zs={readContext:Di,useCallback:gs,useContext:gs,useEffect:gs,useImperativeHandle:gs,useInsertionEffect:gs,useLayoutEffect:gs,useMemo:gs,useReducer:gs,useRef:gs,useState:gs,useDebugValue:gs,useDeferredValue:gs,useTransition:gs,useMutableSource:gs,useSyncExternalStore:gs,useId:gs,unstable_isNewReconciler:!1},ea={readContext:Di,useCallback:function(e,t){return bs().memoizedState=[e,void 0===t?null:t],e},useContext:Di,useEffect:xs,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,Fs(4194308,4,zs.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Fs(4194308,4,e,t)},useInsertionEffect:function(e,t){return Fs(4,2,e,t)},useMemo:function(e,t){var n=bs();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=bs();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Qs.bind(null,cs,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},bs().memoizedState=e},useState:Ls,useDebugValue:Bs,useDeferredValue:function(e){return bs().memoizedState=e},useTransition:function(){var e=Ls(!1),t=e[0];return e=Gs.bind(null,e[1]),bs().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=cs,o=bs();if(si){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Oc)throw Error(s(349));30&as||Ts(r,t,n)}o.memoizedState=n;var i={value:n,getSnapshot:t};return o.queue=i,xs(As.bind(null,r,i,e),[e]),r.flags|=2048,Ds(9,Ns.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=bs(),t=Oc.identifierPrefix;if(si){var n=Zo;t=":"+t+"R"+(n=(Xo&~(1<<32-at(Xo)-1)).toString(32)+n),0<(n=hs++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=fs++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ta={readContext:Di,useCallback:$s,useContext:Di,useEffect:_s,useImperativeHandle:qs,useInsertionEffect:Us,useLayoutEffect:js,useMemo:Hs,useReducer:Cs,useRef:Rs,useState:function(){return Cs(ws)},useDebugValue:Bs,useDeferredValue:function(e){return Ws(Ss(),ls.memoizedState,e)},useTransition:function(){return[Cs(ws)[0],Ss().memoizedState]},useMutableSource:ks,useSyncExternalStore:Ps,useId:Vs,unstable_isNewReconciler:!1},na={readContext:Di,useCallback:$s,useContext:Di,useEffect:_s,useImperativeHandle:qs,useInsertionEffect:Us,useLayoutEffect:js,useMemo:Hs,useReducer:Es,useRef:Rs,useState:function(){return Es(ws)},useDebugValue:Bs,useDeferredValue:function(e){var t=Ss();return null===ls?t.memoizedState=e:Ws(t,ls.memoizedState,e)},useTransition:function(){return[Es(ws)[0],Ss().memoizedState]},useMutableSource:ks,useSyncExternalStore:Ps,useId:Vs,unstable_isNewReconciler:!1};function ra(e,t){if(e&&e.defaultProps){for(var n in t=U({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function oa(e,t,n,r){n=null==(n=n(r,t=e.memoizedState))?t:U({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ia={isMounted:function(e){return!!(e=e._reactInternals)&&$e(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=tl(),o=nl(e),i=zi(r,o);i.payload=t,null!=n&&(i.callback=n),null!==(t=qi(e,i,o))&&(rl(t,e,o,r),Bi(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=tl(),o=nl(e),i=zi(r,o);i.tag=1,i.payload=t,null!=n&&(i.callback=n),null!==(t=qi(e,i,o))&&(rl(t,e,o,r),Bi(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tl(),r=nl(e),o=zi(n,r);o.tag=2,null!=t&&(o.callback=t),null!==(t=qi(e,o,r))&&(rl(t,e,r,n),Bi(t,e,r))}};function sa(e,t,n,r,o,i,s){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,s):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(o,i))}function aa(e,t,n){var r=!1,o=Io,i=t.contextType;return"object"==typeof i&&null!==i?i=Di(i):(o=Fo(t)?Do:Oo.current,i=(r=null!=(r=t.contextTypes))?Ro(e,o):Io),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ia,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=i),t}function ca(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ia.enqueueReplaceState(t,t.state,null)}function la(e,t,n,r){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs={},Ui(e);var i=t.contextType;"object"==typeof i&&null!==i?o.context=Di(i):(i=Fo(t)?Do:Oo.current,o.context=Ro(e,i)),o.state=e.memoizedState,"function"==typeof(i=t.getDerivedStateFromProps)&&(oa(e,t,i,n),o.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof o.getSnapshotBeforeUpdate||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||(t=o.state,"function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),t!==o.state&&ia.enqueueReplaceState(o,o.state,null),Hi(e,n,o,r),o.state=e.memoizedState),"function"==typeof o.componentDidMount&&(e.flags|=4194308)}function ua(e,t){try{var n="",r=t;do{n+=B(r),r=r.return}while(r);var o=n}catch(e){o="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:o,digest:null}}function da(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function pa(e,t){try{r.error(t.value)}catch(e){setTimeout((function(){throw e}))}}var ha="function"==typeof WeakMap?WeakMap:Map;function fa(e,t,n){(n=zi(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Wc||(Wc=!0,Gc=r),pa(0,t)},n}function ga(e,t,n){(n=zi(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"==typeof r){var o=t.value;n.payload=function(){return r(o)},n.callback=function(){pa(0,t)}}var i=e.stateNode;return null!==i&&"function"==typeof i.componentDidCatch&&(n.callback=function(){pa(0,t),"function"!=typeof r&&(null===Vc?Vc=new Set([this]):Vc.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ma(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ha;var o=new Set;r.set(t,o)}else void 0===(o=r.get(t))&&(o=new Set,r.set(t,o));o.has(n)||(o.add(n),e=Tl.bind(null,e,t,n),t.then(e,e))}function va(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ya(e,t,n,r,o){return 1&e.mode?(e.flags|=65536,e.lanes=o,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=zi(-1,1)).tag=2,qi(n,t,1))),n.lanes|=1),e)}var ba=w.ReactCurrentOwner,Sa=!1;function wa(e,t,n,r){t.child=null===e?Ei(t,null,n,r):Ci(t,e.child,n,r)}function Ca(e,t,n,r,o){n=n.render;var i=t.ref;return Li(t,o),r=vs(e,t,n,r,i,o),n=ys(),null===e||Sa?(si&&n&&ni(t),t.flags|=1,wa(e,t,r,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Wa(e,t,o))}function Ea(e,t,n,r,o){if(null===e){var i=n.type;return"function"!=typeof i||Rl(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Ml(n.type,null,r,t,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,ka(e,t,i,r,o))}if(i=e.child,!(e.lanes&o)){var s=i.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(s,r)&&e.ref===t.ref)return Wa(e,t,o)}return t.flags|=1,(e=Fl(i,r)).ref=t.ref,e.return=t,t.child=e}function ka(e,t,n,r,o){if(null!==e){var i=e.memoizedProps;if(lr(i,r)&&e.ref===t.ref){if(Sa=!1,t.pendingProps=r=i,!(e.lanes&o))return t.lanes=e.lanes,Wa(e,t,o);131072&e.flags&&(Sa=!0)}}return Na(e,t,n,r,o)}function Pa(e,t,n){var r=t.pendingProps,o=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(1&t.mode){if(!(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ao(Fc,Rc),Rc|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==i?i.baseLanes:n,Ao(Fc,Rc),Rc|=r}else t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ao(Fc,Rc),Rc|=n;else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,Ao(Fc,Rc),Rc|=r;return wa(e,t,o,n),t.child}function Ta(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Na(e,t,n,r,o){var i=Fo(n)?Do:Oo.current;return i=Ro(t,i),Li(t,o),n=vs(e,t,n,r,i,o),r=ys(),null===e||Sa?(si&&r&&ni(t),t.flags|=1,wa(e,t,n,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Wa(e,t,o))}function Aa(e,t,n,r,o){if(Fo(n)){var i=!0;Uo(t)}else i=!1;if(Li(t,o),null===t.stateNode)Ha(e,t),aa(t,n,r),la(t,n,r,o),r=!0;else if(null===e){var s=t.stateNode,a=t.memoizedProps;s.props=a;var c=s.context,l=n.contextType;"object"==typeof l&&null!==l?l=Di(l):l=Ro(t,l=Fo(n)?Do:Oo.current);var u=n.getDerivedStateFromProps,d="function"==typeof u||"function"==typeof s.getSnapshotBeforeUpdate;d||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(a!==r||c!==l)&&ca(t,s,r,l),_i=!1;var p=t.memoizedState;s.state=p,Hi(t,r,s,o),c=t.memoizedState,a!==r||p!==c||Lo.current||_i?("function"==typeof u&&(oa(t,n,u,r),c=t.memoizedState),(a=_i||sa(t,n,a,r,p,c,l))?(d||"function"!=typeof s.UNSAFE_componentWillMount&&"function"!=typeof s.componentWillMount||("function"==typeof s.componentWillMount&&s.componentWillMount(),"function"==typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"==typeof s.componentDidMount&&(t.flags|=4194308)):("function"==typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),s.props=r,s.state=c,s.context=l,r=a):("function"==typeof s.componentDidMount&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,ji(e,t),a=t.memoizedProps,l=t.type===t.elementType?a:ra(t.type,a),s.props=l,d=t.pendingProps,p=s.context,"object"==typeof(c=n.contextType)&&null!==c?c=Di(c):c=Ro(t,c=Fo(n)?Do:Oo.current);var h=n.getDerivedStateFromProps;(u="function"==typeof h||"function"==typeof s.getSnapshotBeforeUpdate)||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(a!==d||p!==c)&&ca(t,s,r,c),_i=!1,p=t.memoizedState,s.state=p,Hi(t,r,s,o);var f=t.memoizedState;a!==d||p!==f||Lo.current||_i?("function"==typeof h&&(oa(t,n,h,r),f=t.memoizedState),(l=_i||sa(t,n,l,r,p,f,c)||!1)?(u||"function"!=typeof s.UNSAFE_componentWillUpdate&&"function"!=typeof s.componentWillUpdate||("function"==typeof s.componentWillUpdate&&s.componentWillUpdate(r,f,c),"function"==typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,f,c)),"function"==typeof s.componentDidUpdate&&(t.flags|=4),"function"==typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof s.componentDidUpdate||a===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),s.props=r,s.state=f,s.context=c,r=l):("function"!=typeof s.componentDidUpdate||a===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),r=!1)}return Ia(e,t,n,r,i,o)}function Ia(e,t,n,r,o,i){Ta(e,t);var s=!!(128&t.flags);if(!r&&!s)return o&&jo(t,n,!1),Wa(e,t,i);r=t.stateNode,ba.current=t;var a=s&&"function"!=typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&s?(t.child=Ci(t,e.child,null,i),t.child=Ci(t,null,a,i)):wa(e,t,a,i),t.memoizedState=r.state,o&&jo(t,n,!0),t.child}function Oa(e){var t=e.stateNode;t.pendingContext?xo(0,t.pendingContext,t.pendingContext!==t.context):t.context&&xo(0,t.context,!1),Yi(e,t.containerInfo)}function La(e,t,n,r,o){return gi(),mi(o),t.flags|=256,wa(e,t,n,r),t.child}var Da,Ra,Fa,Ma,xa={dehydrated:null,treeContext:null,retryLane:0};function _a(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ua(e,t,n){var r,o=t.pendingProps,i=ts.current,a=!1,c=!!(128&t.flags);if((r=c)||(r=(null===e||null!==e.memoizedState)&&!!(2&i)),r?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(i|=1),Ao(ts,1&i),null===e)return di(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(1&t.mode?"$!"===e.data?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(c=o.children,e=o.fallback,a?(o=t.mode,a=t.child,c={mode:"hidden",children:c},1&o||null===a?a=_l(c,o,0,null):(a.childLanes=0,a.pendingProps=c),e=xl(e,o,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=_a(n),t.memoizedState=xa,e):ja(t,c));if(null!==(i=e.memoizedState)&&null!==(r=i.dehydrated))return function(e,t,n,r,o,i,a){if(n)return 256&t.flags?(t.flags&=-257,za(e,t,a,r=da(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(i=r.fallback,o=t.mode,r=_l({mode:"visible",children:r.children},o,0,null),(i=xl(i,o,a,null)).flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,1&t.mode&&Ci(t,e.child,null,a),t.child.memoizedState=_a(a),t.memoizedState=xa,i);if(!(1&t.mode))return za(e,t,a,null);if("$!"===o.data){if(r=o.nextSibling&&o.nextSibling.dataset)var c=r.dgst;return r=c,za(e,t,a,r=da(i=Error(s(419)),r,void 0))}if(c=!!(a&e.childLanes),Sa||c){if(null!==(r=Oc)){switch(a&-a){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}0!==(o=o&(r.suspendedLanes|a)?0:o)&&o!==i.retryLane&&(i.retryLane=o,xi(e,o),rl(r,e,o,-1))}return ml(),za(e,t,a,r=da(Error(s(421))))}return"$?"===o.data?(t.flags|=128,t.child=e.child,t=Al.bind(null,e),o._reactRetry=t,null):(e=i.treeContext,ii=uo(o.nextSibling),oi=t,si=!0,ai=null,null!==e&&(Jo[Ko++]=Xo,Jo[Ko++]=Zo,Jo[Ko++]=Yo,Xo=e.id,Zo=e.overflow,Yo=t),t=ja(t,r.children),t.flags|=4096,t)}(e,t,c,o,r,i,n);if(a){a=o.fallback,c=t.mode,r=(i=e.child).sibling;var l={mode:"hidden",children:o.children};return 1&c||t.child===i?(o=Fl(i,l)).subtreeFlags=14680064&i.subtreeFlags:((o=t.child).childLanes=0,o.pendingProps=l,t.deletions=null),null!==r?a=Fl(r,a):(a=xl(a,c,n,null)).flags|=2,a.return=t,o.return=t,o.sibling=a,t.child=o,o=a,a=t.child,c=null===(c=e.child.memoizedState)?_a(n):{baseLanes:c.baseLanes|n,cachePool:null,transitions:c.transitions},a.memoizedState=c,a.childLanes=e.childLanes&~n,t.memoizedState=xa,o}return e=(a=e.child).sibling,o=Fl(a,{mode:"visible",children:o.children}),!(1&t.mode)&&(o.lanes=n),o.return=t,o.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=o,t.memoizedState=null,o}function ja(e,t){return(t=_l({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function za(e,t,n,r){return null!==r&&mi(r),Ci(t,e.child,null,n),(e=ja(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function qa(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Oi(e.return,t,n)}function Ba(e,t,n,r,o){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=o)}function $a(e,t,n){var r=t.pendingProps,o=r.revealOrder,i=r.tail;if(wa(e,t,r.children,n),2&(r=ts.current))r=1&r|2,t.flags|=128;else{if(null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&qa(e,n,t);else if(19===e.tag)qa(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ao(ts,r),1&t.mode)switch(o){case"forwards":for(n=t.child,o=null;null!==n;)null!==(e=n.alternate)&&null===ns(e)&&(o=n),n=n.sibling;null===(n=o)?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),Ba(t,!1,o,n,i);break;case"backwards":for(n=null,o=t.child,t.child=null;null!==o;){if(null!==(e=o.alternate)&&null===ns(e)){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}Ba(t,!0,n,null,i);break;case"together":Ba(t,!1,null,null,void 0);break;default:t.memoizedState=null}else t.memoizedState=null;return t.child}function Ha(e,t){!(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Wa(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),_c|=t.lanes,!(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Fl(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Fl(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ga(e,t){if(!si)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Va(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var o=e.child;null!==o;)n|=o.lanes|o.childLanes,r|=14680064&o.subtreeFlags,r|=14680064&o.flags,o.return=e,o=o.sibling;else for(o=e.child;null!==o;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Qa(e,t,n){var r=t.pendingProps;switch(ri(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Va(t),null;case 1:case 17:return Fo(t.type)&&Mo(),Va(t),null;case 3:return r=t.stateNode,Xi(),No(Lo),No(Oo),os(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(hi(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,null!==ai&&(al(ai),ai=null))),Ra(e,t),Va(t),null;case 5:es(t);var o=Ki(Ji.current);if(n=t.type,null!==e&&null!=t.stateNode)Fa(e,t,n,r,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(s(166));return Va(t),null}if(e=Ki(Vi.current),hi(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[fo]=t,r[go]=i,e=!!(1&t.mode),n){case"dialog":zr("cancel",r),zr("close",r);break;case"iframe":case"object":case"embed":zr("load",r);break;case"video":case"audio":for(o=0;o<xr.length;o++)zr(xr[o],r);break;case"source":zr("error",r);break;case"img":case"image":case"link":zr("error",r),zr("load",r);break;case"details":zr("toggle",r);break;case"input":Y(r,i),zr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},zr("invalid",r);break;case"textarea":ie(r,i),zr("invalid",r)}for(var a in be(n,i),o=null,i)if(i.hasOwnProperty(a)){var l=i[a];"children"===a?"string"==typeof l?r.textContent!==l&&(!0!==i.suppressHydrationWarning&&Zr(r.textContent,l,e),o=["children",l]):"number"==typeof l&&r.textContent!==""+l&&(!0!==i.suppressHydrationWarning&&Zr(r.textContent,l,e),o=["children",""+l]):c.hasOwnProperty(a)&&null!=l&&"onScroll"===a&&zr("scroll",r)}switch(n){case"input":V(r),ee(r,i,!0);break;case"textarea":V(r),ae(r);break;case"select":case"option":break;default:"function"==typeof i.onClick&&(r.onclick=eo)}r=o,t.updateQueue=r,null!==r&&(t.flags|=4)}else{a=9===o.nodeType?o:o.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ce(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=a.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof r.is?e=a.createElement(n,{is:r.is}):(e=a.createElement(n),"select"===n&&(a=e,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):e=a.createElementNS(e,n),e[fo]=t,e[go]=r,Da(e,t,!1,!1),t.stateNode=e;e:{switch(a=Se(n,r),n){case"dialog":zr("cancel",e),zr("close",e),o=r;break;case"iframe":case"object":case"embed":zr("load",e),o=r;break;case"video":case"audio":for(o=0;o<xr.length;o++)zr(xr[o],e);o=r;break;case"source":zr("error",e),o=r;break;case"img":case"image":case"link":zr("error",e),zr("load",e),o=r;break;case"details":zr("toggle",e),o=r;break;case"input":Y(e,r),o=K(e,r),zr("invalid",e);break;case"option":default:o=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},o=U({},r,{value:void 0}),zr("invalid",e);break;case"textarea":ie(e,r),o=oe(e,r),zr("invalid",e)}for(i in be(n,o),l=o)if(l.hasOwnProperty(i)){var u=l[i];"style"===i?ve(e,u):"dangerouslySetInnerHTML"===i?null!=(u=u?u.__html:void 0)&&pe(e,u):"children"===i?"string"==typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"==typeof u&&he(e,""+u):"suppressContentEditableWarning"!==i&&"suppressHydrationWarning"!==i&&"autoFocus"!==i&&(c.hasOwnProperty(i)?null!=u&&"onScroll"===i&&zr("scroll",e):null!=u&&S(e,i,u,a))}switch(n){case"input":V(e),ee(e,r,!1);break;case"textarea":V(e),ae(e);break;case"option":null!=r.value&&e.setAttribute("value",""+W(r.value));break;case"select":e.multiple=!!r.multiple,null!=(i=r.value)?re(e,!!r.multiple,i,!1):null!=r.defaultValue&&re(e,!!r.multiple,r.defaultValue,!0);break;default:"function"==typeof o.onClick&&(e.onclick=eo)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Va(t),null;case 6:if(e&&null!=t.stateNode)Ma(e,t,e.memoizedProps,r);else{if("string"!=typeof r&&null===t.stateNode)throw Error(s(166));if(n=Ki(Ji.current),Ki(Vi.current),hi(t)){if(r=t.stateNode,n=t.memoizedProps,r[fo]=t,(i=r.nodeValue!==n)&&null!==(e=oi))switch(e.tag){case 3:Zr(r.nodeValue,n,!!(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Zr(r.nodeValue,n,!!(1&e.mode))}i&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[fo]=t,t.stateNode=r}return Va(t),null;case 13:if(No(ts),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(si&&null!==ii&&1&t.mode&&!(128&t.flags))fi(),gi(),t.flags|=98560,i=!1;else if(i=hi(t),null!==r&&null!==r.dehydrated){if(null===e){if(!i)throw Error(s(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(s(317));i[fo]=t}else gi(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Va(t),i=!1}else null!==ai&&(al(ai),ai=null),i=!0;if(!i)return 65536&t.flags?t:null}return 128&t.flags?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,1&t.mode&&(null===e||1&ts.current?0===Mc&&(Mc=3):ml())),null!==t.updateQueue&&(t.flags|=4),Va(t),null);case 4:return Xi(),Ra(e,t),null===e&&$r(t.stateNode.containerInfo),Va(t),null;case 10:return Ii(t.type._context),Va(t),null;case 19:if(No(ts),null===(i=t.memoizedState))return Va(t),null;if(r=!!(128&t.flags),null===(a=i.rendering))if(r)Ga(i,!1);else{if(0!==Mc||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(a=ns(e))){for(t.flags|=128,Ga(i,!1),null!==(r=a.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(i=n).flags&=14680066,null===(a=i.alternate)?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,e=a.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ao(ts,1&ts.current|2),t.child}e=e.sibling}null!==i.tail&&Xe()>$c&&(t.flags|=128,r=!0,Ga(i,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ns(a))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ga(i,!0),null===i.tail&&"hidden"===i.tailMode&&!a.alternate&&!si)return Va(t),null}else 2*Xe()-i.renderingStartTime>$c&&1073741824!==n&&(t.flags|=128,r=!0,Ga(i,!1),t.lanes=4194304);i.isBackwards?(a.sibling=t.child,t.child=a):(null!==(n=i.last)?n.sibling=a:t.child=a,i.last=a)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Xe(),t.sibling=null,n=ts.current,Ao(ts,r?1&n|2:1&n),t):(Va(t),null);case 22:case 23:return pl(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&1&t.mode?!!(1073741824&Rc)&&(Va(t),6&t.subtreeFlags&&(t.flags|=8192)):Va(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Ja(e,t){switch(ri(t),t.tag){case 1:return Fo(t.type)&&Mo(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Xi(),No(Lo),No(Oo),os(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 5:return es(t),null;case 13:if(No(ts),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));gi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return No(ts),null;case 4:return Xi(),null;case 10:return Ii(t.type._context),null;case 22:case 23:return pl(),null;default:return null}}Da=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ra=function(){},Fa=function(e,t,n,r){var o=e.memoizedProps;if(o!==r){e=t.stateNode,Ki(Vi.current);var i,s=null;switch(n){case"input":o=K(e,o),r=K(e,r),s=[];break;case"select":o=U({},o,{value:void 0}),r=U({},r,{value:void 0}),s=[];break;case"textarea":o=oe(e,o),r=oe(e,r),s=[];break;default:"function"!=typeof o.onClick&&"function"==typeof r.onClick&&(e.onclick=eo)}for(u in be(n,r),n=null,o)if(!r.hasOwnProperty(u)&&o.hasOwnProperty(u)&&null!=o[u])if("style"===u){var a=o[u];for(i in a)a.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(c.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(a=null!=o?o[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(null!=l||null!=a))if("style"===u)if(a){for(i in a)!a.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in l)l.hasOwnProperty(i)&&a[i]!==l[i]&&(n||(n={}),n[i]=l[i])}else n||(s||(s=[]),s.push(u,n)),n=l;else"dangerouslySetInnerHTML"===u?(l=l?l.__html:void 0,a=a?a.__html:void 0,null!=l&&a!==l&&(s=s||[]).push(u,l)):"children"===u?"string"!=typeof l&&"number"!=typeof l||(s=s||[]).push(u,""+l):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(c.hasOwnProperty(u)?(null!=l&&"onScroll"===u&&zr("scroll",e),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(t.updateQueue=u)&&(t.flags|=4)}},Ma=function(e,t,n,r){n!==r&&(t.flags|=4)};var Ka=!1,Ya=!1,Xa="function"==typeof WeakSet?WeakSet:Set,Za=null;function ec(e,t){var n=e.ref;if(null!==n)if("function"==typeof n)try{n(null)}catch(n){Pl(e,t,n)}else n.current=null}function tc(e,t,n){try{n()}catch(n){Pl(e,t,n)}}var nc=!1;function rc(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var o=r=r.next;do{if((o.tag&e)===e){var i=o.destroy;o.destroy=void 0,void 0!==i&&tc(t,n,i)}o=o.next}while(o!==r)}}function oc(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function ic(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"==typeof t?t(e):t.current=e}}function sc(e){var t=e.alternate;null!==t&&(e.alternate=null,sc(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[fo],delete t[go],delete t[vo],delete t[yo],delete t[bo])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ac(e){return 5===e.tag||3===e.tag||4===e.tag}function cc(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ac(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function lc(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=eo));else if(4!==r&&null!==(e=e.child))for(lc(e,t,n),e=e.sibling;null!==e;)lc(e,t,n),e=e.sibling}function uc(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(uc(e,t,n),e=e.sibling;null!==e;)uc(e,t,n),e=e.sibling}var dc=null,pc=!1;function hc(e,t,n){for(n=n.child;null!==n;)fc(e,t,n),n=n.sibling}function fc(e,t,n){if(st&&"function"==typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(it,n)}catch(e){}switch(n.tag){case 5:Ya||ec(n,t);case 6:var r=dc,o=pc;dc=null,hc(e,t,n),pc=o,null!==(dc=r)&&(pc?(e=dc,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):dc.removeChild(n.stateNode));break;case 18:null!==dc&&(pc?(e=dc,n=n.stateNode,8===e.nodeType?lo(e.parentNode,n):1===e.nodeType&&lo(e,n),$t(e)):lo(dc,n.stateNode));break;case 4:r=dc,o=pc,dc=n.stateNode.containerInfo,pc=!0,hc(e,t,n),dc=r,pc=o;break;case 0:case 11:case 14:case 15:if(!Ya&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){o=r=r.next;do{var i=o,s=i.destroy;i=i.tag,void 0!==s&&(2&i||4&i)&&tc(n,t,s),o=o.next}while(o!==r)}hc(e,t,n);break;case 1:if(!Ya&&(ec(n,t),"function"==typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(e){Pl(n,t,e)}hc(e,t,n);break;case 21:hc(e,t,n);break;case 22:1&n.mode?(Ya=(r=Ya)||null!==n.memoizedState,hc(e,t,n),Ya=r):hc(e,t,n);break;default:hc(e,t,n)}}function gc(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Xa),t.forEach((function(t){var r=Il.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function mc(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var o=n[r];try{var i=e,a=t,c=a;e:for(;null!==c;){switch(c.tag){case 5:dc=c.stateNode,pc=!1;break e;case 3:case 4:dc=c.stateNode.containerInfo,pc=!0;break e}c=c.return}if(null===dc)throw Error(s(160));fc(i,a,o),dc=null,pc=!1;var l=o.alternate;null!==l&&(l.return=null),o.return=null}catch(e){Pl(o,t,e)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)vc(t,e),t=t.sibling}function vc(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(mc(t,e),yc(e),4&r){try{rc(3,e,e.return),oc(3,e)}catch(t){Pl(e,e.return,t)}try{rc(5,e,e.return)}catch(t){Pl(e,e.return,t)}}break;case 1:mc(t,e),yc(e),512&r&&null!==n&&ec(n,n.return);break;case 5:if(mc(t,e),yc(e),512&r&&null!==n&&ec(n,n.return),32&e.flags){var o=e.stateNode;try{he(o,"")}catch(t){Pl(e,e.return,t)}}if(4&r&&null!=(o=e.stateNode)){var i=e.memoizedProps,a=null!==n?n.memoizedProps:i,c=e.type,l=e.updateQueue;if(e.updateQueue=null,null!==l)try{"input"===c&&"radio"===i.type&&null!=i.name&&X(o,i),Se(c,a);var u=Se(c,i);for(a=0;a<l.length;a+=2){var d=l[a],p=l[a+1];"style"===d?ve(o,p):"dangerouslySetInnerHTML"===d?pe(o,p):"children"===d?he(o,p):S(o,d,p,u)}switch(c){case"input":Z(o,i);break;case"textarea":se(o,i);break;case"select":var h=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!i.multiple;var f=i.value;null!=f?re(o,!!i.multiple,f,!1):h!==!!i.multiple&&(null!=i.defaultValue?re(o,!!i.multiple,i.defaultValue,!0):re(o,!!i.multiple,i.multiple?[]:"",!1))}o[go]=i}catch(t){Pl(e,e.return,t)}}break;case 6:if(mc(t,e),yc(e),4&r){if(null===e.stateNode)throw Error(s(162));o=e.stateNode,i=e.memoizedProps;try{o.nodeValue=i}catch(t){Pl(e,e.return,t)}}break;case 3:if(mc(t,e),yc(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{$t(t.containerInfo)}catch(t){Pl(e,e.return,t)}break;case 4:default:mc(t,e),yc(e);break;case 13:mc(t,e),yc(e),8192&(o=e.child).flags&&(i=null!==o.memoizedState,o.stateNode.isHidden=i,!i||null!==o.alternate&&null!==o.alternate.memoizedState||(Bc=Xe())),4&r&&gc(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Ya=(u=Ya)||d,mc(t,e),Ya=u):mc(t,e),yc(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&1&e.mode)for(Za=e,d=e.child;null!==d;){for(p=Za=d;null!==Za;){switch(f=(h=Za).child,h.tag){case 0:case 11:case 14:case 15:rc(4,h,h.return);break;case 1:ec(h,h.return);var g=h.stateNode;if("function"==typeof g.componentWillUnmount){r=h,n=h.return;try{t=r,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(e){Pl(r,n,e)}}break;case 5:ec(h,h.return);break;case 22:if(null!==h.memoizedState){Cc(p);continue}}null!==f?(f.return=h,Za=f):Cc(p)}d=d.sibling}e:for(d=null,p=e;;){if(5===p.tag){if(null===d){d=p;try{o=p.stateNode,u?"function"==typeof(i=o.style).setProperty?i.setProperty("display","none","important"):i.display="none":(c=p.stateNode,a=null!=(l=p.memoizedProps.style)&&l.hasOwnProperty("display")?l.display:null,c.style.display=me("display",a))}catch(t){Pl(e,e.return,t)}}}else if(6===p.tag){if(null===d)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(t){Pl(e,e.return,t)}}else if((22!==p.tag&&23!==p.tag||null===p.memoizedState||p===e)&&null!==p.child){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;null===p.sibling;){if(null===p.return||p.return===e)break e;d===p&&(d=null),p=p.return}d===p&&(d=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:mc(t,e),yc(e),4&r&&gc(e);case 21:}}function yc(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ac(n)){var r=n;break e}n=n.return}throw Error(s(160))}switch(r.tag){case 5:var o=r.stateNode;32&r.flags&&(he(o,""),r.flags&=-33),uc(e,cc(e),o);break;case 3:case 4:var i=r.stateNode.containerInfo;lc(e,cc(e),i);break;default:throw Error(s(161))}}catch(t){Pl(e,e.return,t)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bc(e,t,n){Za=e,Sc(e,t,n)}function Sc(e,t,n){for(var r=!!(1&e.mode);null!==Za;){var o=Za,i=o.child;if(22===o.tag&&r){var s=null!==o.memoizedState||Ka;if(!s){var a=o.alternate,c=null!==a&&null!==a.memoizedState||Ya;a=Ka;var l=Ya;if(Ka=s,(Ya=c)&&!l)for(Za=o;null!==Za;)c=(s=Za).child,22===s.tag&&null!==s.memoizedState?Ec(o):null!==c?(c.return=s,Za=c):Ec(o);for(;null!==i;)Za=i,Sc(i,t,n),i=i.sibling;Za=o,Ka=a,Ya=l}wc(e)}else 8772&o.subtreeFlags&&null!==i?(i.return=o,Za=i):wc(e)}}function wc(e){for(;null!==Za;){var t=Za;if(8772&t.flags){var n=t.alternate;try{if(8772&t.flags)switch(t.tag){case 0:case 11:case 15:Ya||oc(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Ya)if(null===n)r.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:ra(t.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;null!==i&&Wi(t,i,r);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Wi(t,a,n)}break;case 5:var c=t.stateNode;if(null===n&&4&t.flags){n=c;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var p=d.dehydrated;null!==p&&$t(p)}}}break;default:throw Error(s(163))}Ya||512&t.flags&&ic(t)}catch(e){Pl(t,t.return,e)}}if(t===e){Za=null;break}if(null!==(n=t.sibling)){n.return=t.return,Za=n;break}Za=t.return}}function Cc(e){for(;null!==Za;){var t=Za;if(t===e){Za=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Za=n;break}Za=t.return}}function Ec(e){for(;null!==Za;){var t=Za;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{oc(4,t)}catch(e){Pl(t,n,e)}break;case 1:var r=t.stateNode;if("function"==typeof r.componentDidMount){var o=t.return;try{r.componentDidMount()}catch(e){Pl(t,o,e)}}var i=t.return;try{ic(t)}catch(e){Pl(t,i,e)}break;case 5:var s=t.return;try{ic(t)}catch(e){Pl(t,s,e)}}}catch(e){Pl(t,t.return,e)}if(t===e){Za=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Za=a;break}Za=t.return}}var kc,Pc=Math.ceil,Tc=w.ReactCurrentDispatcher,Nc=w.ReactCurrentOwner,Ac=w.ReactCurrentBatchConfig,Ic=0,Oc=null,Lc=null,Dc=0,Rc=0,Fc=To(0),Mc=0,xc=null,_c=0,Uc=0,jc=0,zc=null,qc=null,Bc=0,$c=1/0,Hc=null,Wc=!1,Gc=null,Vc=null,Qc=!1,Jc=null,Kc=0,Yc=0,Xc=null,Zc=-1,el=0;function tl(){return 6&Ic?Xe():-1!==Zc?Zc:Zc=Xe()}function nl(e){return 1&e.mode?2&Ic&&0!==Dc?Dc&-Dc:null!==vi.transition?(0===el&&(el=mt()),el):0!==(e=St)?e:e=void 0===(e=window.event)?16:Yt(e.type):1}function rl(e,t,n,r){if(50<Yc)throw Yc=0,Xc=null,Error(s(185));yt(e,n,r),2&Ic&&e===Oc||(e===Oc&&(!(2&Ic)&&(Uc|=n),4===Mc&&cl(e,Dc)),ol(e,r),1===n&&0===Ic&&!(1&t.mode)&&($c=Xe()+500,qo&&Ho()))}function ol(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,o=e.expirationTimes,i=e.pendingLanes;0<i;){var s=31-at(i),a=1<<s,c=o[s];-1===c?a&n&&!(a&r)||(o[s]=ft(a,t)):c<=t&&(e.expiredLanes|=a),i&=~a}}(e,t);var r=ht(e,e===Oc?Dc:0);if(0===r)null!==n&&Je(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Je(n),1===t)0===e.tag?function(e){qo=!0,$o(e)}(ll.bind(null,e)):$o(ll.bind(null,e)),ao((function(){!(6&Ic)&&Ho()})),n=null;else{switch(wt(r)){case 1:n=et;break;case 4:n=tt;break;case 16:default:n=nt;break;case 536870912:n=ot}n=Ol(n,il.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function il(e,t){if(Zc=-1,el=0,6&Ic)throw Error(s(327));var n=e.callbackNode;if(El()&&e.callbackNode!==n)return null;var r=ht(e,e===Oc?Dc:0);if(0===r)return null;if(30&r||r&e.expiredLanes||t)t=vl(e,r);else{t=r;var o=Ic;Ic|=2;var i=gl();for(Oc===e&&Dc===t||(Hc=null,$c=Xe()+500,hl(e,t));;)try{bl();break}catch(t){fl(e,t)}Ai(),Tc.current=i,Ic=o,null!==Lc?t=0:(Oc=null,Dc=0,t=Mc)}if(0!==t){if(2===t&&(0!==(o=gt(e))&&(r=o,t=sl(e,o))),1===t)throw n=xc,hl(e,0),cl(e,r),ol(e,Xe()),n;if(6===t)cl(e,r);else{if(o=e.current.alternate,!(30&r||function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var o=n[r],i=o.getSnapshot;o=o.value;try{if(!cr(i(),o))return!1}catch(e){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(o)||(t=vl(e,r),2===t&&(i=gt(e),0!==i&&(r=i,t=sl(e,i))),1!==t)))throw n=xc,hl(e,0),cl(e,r),ol(e,Xe()),n;switch(e.finishedWork=o,e.finishedLanes=r,t){case 0:case 1:throw Error(s(345));case 2:case 5:Cl(e,qc,Hc);break;case 3:if(cl(e,r),(130023424&r)===r&&10<(t=Bc+500-Xe())){if(0!==ht(e,0))break;if(((o=e.suspendedLanes)&r)!==r){tl(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=oo(Cl.bind(null,e,qc,Hc),t);break}Cl(e,qc,Hc);break;case 4:if(cl(e,r),(4194240&r)===r)break;for(t=e.eventTimes,o=-1;0<r;){var a=31-at(r);i=1<<a,(a=t[a])>o&&(o=a),r&=~i}if(r=o,10<(r=(120>(r=Xe()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Pc(r/1960))-r)){e.timeoutHandle=oo(Cl.bind(null,e,qc,Hc),r);break}Cl(e,qc,Hc);break;default:throw Error(s(329))}}}return ol(e,Xe()),e.callbackNode===n?il.bind(null,e):null}function sl(e,t){var n=zc;return e.current.memoizedState.isDehydrated&&(hl(e,t).flags|=256),2!==(e=vl(e,t))&&(t=qc,qc=n,null!==t&&al(t)),e}function al(e){null===qc?qc=e:qc.push.apply(qc,e)}function cl(e,t){for(t&=~jc,t&=~Uc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-at(t),r=1<<n;e[n]=-1,t&=~r}}function ll(e){if(6&Ic)throw Error(s(327));El();var t=ht(e,0);if(!(1&t))return ol(e,Xe()),null;var n=vl(e,t);if(0!==e.tag&&2===n){var r=gt(e);0!==r&&(t=r,n=sl(e,r))}if(1===n)throw n=xc,hl(e,0),cl(e,t),ol(e,Xe()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Cl(e,qc,Hc),ol(e,Xe()),null}function ul(e,t){var n=Ic;Ic|=1;try{return e(t)}finally{0===(Ic=n)&&($c=Xe()+500,qo&&Ho())}}function dl(e){null!==Jc&&0===Jc.tag&&!(6&Ic)&&El();var t=Ic;Ic|=1;var n=Ac.transition,r=St;try{if(Ac.transition=null,St=1,e)return e()}finally{St=r,Ac.transition=n,!(6&(Ic=t))&&Ho()}}function pl(){Rc=Fc.current,No(Fc)}function hl(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,io(n)),null!==Lc)for(n=Lc.return;null!==n;){var r=n;switch(ri(r),r.tag){case 1:null!=(r=r.type.childContextTypes)&&Mo();break;case 3:Xi(),No(Lo),No(Oo),os();break;case 5:es(r);break;case 4:Xi();break;case 13:case 19:No(ts);break;case 10:Ii(r.type._context);break;case 22:case 23:pl()}n=n.return}if(Oc=e,Lc=e=Fl(e.current,null),Dc=Rc=t,Mc=0,xc=null,jc=Uc=_c=0,qc=zc=null,null!==Ri){for(t=0;t<Ri.length;t++)if(null!==(r=(n=Ri[t]).interleaved)){n.interleaved=null;var o=r.next,i=n.pending;if(null!==i){var s=i.next;i.next=o,r.next=s}n.pending=r}Ri=null}return e}function fl(e,t){for(;;){var n=Lc;try{if(Ai(),is.current=Zs,ds){for(var r=cs.memoizedState;null!==r;){var o=r.queue;null!==o&&(o.pending=null),r=r.next}ds=!1}if(as=0,us=ls=cs=null,ps=!1,hs=0,Nc.current=null,null===n||null===n.return){Mc=1,xc=t,Lc=null;break}e:{var i=e,a=n.return,c=n,l=t;if(t=Dc,c.flags|=32768,null!==l&&"object"==typeof l&&"function"==typeof l.then){var u=l,d=c,p=d.tag;if(!(1&d.mode||0!==p&&11!==p&&15!==p)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=va(a);if(null!==f){f.flags&=-257,ya(f,a,c,0,t),1&f.mode&&ma(i,u,t),l=u;var g=(t=f).updateQueue;if(null===g){var m=new Set;m.add(l),t.updateQueue=m}else g.add(l);break e}if(!(1&t)){ma(i,u,t),ml();break e}l=Error(s(426))}else if(si&&1&c.mode){var v=va(a);if(null!==v){!(65536&v.flags)&&(v.flags|=256),ya(v,a,c,0,t),mi(ua(l,c));break e}}i=l=ua(l,c),4!==Mc&&(Mc=2),null===zc?zc=[i]:zc.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t,$i(i,fa(0,l,t));break e;case 1:c=l;var y=i.type,b=i.stateNode;if(!(128&i.flags||"function"!=typeof y.getDerivedStateFromError&&(null===b||"function"!=typeof b.componentDidCatch||null!==Vc&&Vc.has(b)))){i.flags|=65536,t&=-t,i.lanes|=t,$i(i,ga(i,c,t));break e}}i=i.return}while(null!==i)}wl(n)}catch(e){t=e,Lc===n&&null!==n&&(Lc=n=n.return);continue}break}}function gl(){var e=Tc.current;return Tc.current=Zs,null===e?Zs:e}function ml(){0!==Mc&&3!==Mc&&2!==Mc||(Mc=4),null===Oc||!(268435455&_c)&&!(268435455&Uc)||cl(Oc,Dc)}function vl(e,t){var n=Ic;Ic|=2;var r=gl();for(Oc===e&&Dc===t||(Hc=null,hl(e,t));;)try{yl();break}catch(t){fl(e,t)}if(Ai(),Ic=n,Tc.current=r,null!==Lc)throw Error(s(261));return Oc=null,Dc=0,Mc}function yl(){for(;null!==Lc;)Sl(Lc)}function bl(){for(;null!==Lc&&!Ke();)Sl(Lc)}function Sl(e){var t=kc(e.alternate,e,Rc);e.memoizedProps=e.pendingProps,null===t?wl(e):Lc=t,Nc.current=null}function wl(e){var t=e;do{var n=t.alternate;if(e=t.return,32768&t.flags){if(null!==(n=Ja(n,t)))return n.flags&=32767,void(Lc=n);if(null===e)return Mc=6,void(Lc=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}else if(null!==(n=Qa(n,t,Rc)))return void(Lc=n);if(null!==(t=t.sibling))return void(Lc=t);Lc=t=e}while(null!==t);0===Mc&&(Mc=5)}function Cl(e,t,n){var r=St,o=Ac.transition;try{Ac.transition=null,St=1,function(e,t,n,r){do{El()}while(null!==Jc);if(6&Ic)throw Error(s(327));n=e.finishedWork;var o=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-at(n),i=1<<o;t[o]=0,r[o]=-1,e[o]=-1,n&=~i}}(e,i),e===Oc&&(Lc=Oc=null,Dc=0),!(2064&n.subtreeFlags)&&!(2064&n.flags)||Qc||(Qc=!0,Ol(nt,(function(){return El(),null}))),i=!!(15990&n.flags),!!(15990&n.subtreeFlags)||i){i=Ac.transition,Ac.transition=null;var a=St;St=1;var c=Ic;Ic|=4,Nc.current=null,function(e,t){if(to=Wt,fr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var o=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch(e){n=null;break e}var a=0,c=-1,l=-1,u=0,d=0,p=e,h=null;t:for(;;){for(var f;p!==n||0!==o&&3!==p.nodeType||(c=a+o),p!==i||0!==r&&3!==p.nodeType||(l=a+r),3===p.nodeType&&(a+=p.nodeValue.length),null!==(f=p.firstChild);)h=p,p=f;for(;;){if(p===e)break t;if(h===n&&++u===o&&(c=a),h===i&&++d===r&&(l=a),null!==(f=p.nextSibling))break;h=(p=h).parentNode}p=f}n=-1===c||-1===l?null:{start:c,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(no={focusedElem:e,selectionRange:n},Wt=!1,Za=t;null!==Za;)if(e=(t=Za).child,1028&t.subtreeFlags&&null!==e)e.return=t,Za=e;else for(;null!==Za;){t=Za;try{var g=t.alternate;if(1024&t.flags)switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var m=g.memoizedProps,v=g.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:ra(t.type,m),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var S=t.stateNode.containerInfo;1===S.nodeType?S.textContent="":9===S.nodeType&&S.documentElement&&S.removeChild(S.documentElement);break;default:throw Error(s(163))}}catch(e){Pl(t,t.return,e)}if(null!==(e=t.sibling)){e.return=t.return,Za=e;break}Za=t.return}g=nc,nc=!1}(e,n),vc(n,e),gr(no),Wt=!!to,no=to=null,e.current=n,bc(n,e,o),Ye(),Ic=c,St=a,Ac.transition=i}else e.current=n;if(Qc&&(Qc=!1,Jc=e,Kc=o),i=e.pendingLanes,0===i&&(Vc=null),function(e){if(st&&"function"==typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(it,e,void 0,!(128&~e.current.flags))}catch(e){}}(n.stateNode),ol(e,Xe()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)o=t[n],r(o.value,{componentStack:o.stack,digest:o.digest});if(Wc)throw Wc=!1,e=Gc,Gc=null,e;!!(1&Kc)&&0!==e.tag&&El(),i=e.pendingLanes,1&i?e===Xc?Yc++:(Yc=0,Xc=e):Yc=0,Ho()}(e,t,n,r)}finally{Ac.transition=o,St=r}return null}function El(){if(null!==Jc){var e=wt(Kc),t=Ac.transition,n=St;try{if(Ac.transition=null,St=16>e?16:e,null===Jc)var r=!1;else{if(e=Jc,Jc=null,Kc=0,6&Ic)throw Error(s(331));var o=Ic;for(Ic|=4,Za=e.current;null!==Za;){var i=Za,a=i.child;if(16&Za.flags){var c=i.deletions;if(null!==c){for(var l=0;l<c.length;l++){var u=c[l];for(Za=u;null!==Za;){var d=Za;switch(d.tag){case 0:case 11:case 15:rc(8,d,i)}var p=d.child;if(null!==p)p.return=d,Za=p;else for(;null!==Za;){var h=(d=Za).sibling,f=d.return;if(sc(d),d===u){Za=null;break}if(null!==h){h.return=f,Za=h;break}Za=f}}}var g=i.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(null!==m)}}Za=i}}if(2064&i.subtreeFlags&&null!==a)a.return=i,Za=a;else e:for(;null!==Za;){if(2048&(i=Za).flags)switch(i.tag){case 0:case 11:case 15:rc(9,i,i.return)}var y=i.sibling;if(null!==y){y.return=i.return,Za=y;break e}Za=i.return}}var b=e.current;for(Za=b;null!==Za;){var S=(a=Za).child;if(2064&a.subtreeFlags&&null!==S)S.return=a,Za=S;else e:for(a=b;null!==Za;){if(2048&(c=Za).flags)try{switch(c.tag){case 0:case 11:case 15:oc(9,c)}}catch(e){Pl(c,c.return,e)}if(c===a){Za=null;break e}var w=c.sibling;if(null!==w){w.return=c.return,Za=w;break e}Za=c.return}}if(Ic=o,Ho(),st&&"function"==typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(it,e)}catch(e){}r=!0}return r}finally{St=n,Ac.transition=t}}return!1}function kl(e,t,n){e=qi(e,t=fa(0,t=ua(n,t),1),1),t=tl(),null!==e&&(yt(e,1,t),ol(e,t))}function Pl(e,t,n){if(3===e.tag)kl(e,e,n);else for(;null!==t;){if(3===t.tag){kl(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===Vc||!Vc.has(r))){t=qi(t,e=ga(t,e=ua(n,e),1),1),e=tl(),null!==t&&(yt(t,1,e),ol(t,e));break}}t=t.return}}function Tl(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=tl(),e.pingedLanes|=e.suspendedLanes&n,Oc===e&&(Dc&n)===n&&(4===Mc||3===Mc&&(130023424&Dc)===Dc&&500>Xe()-Bc?hl(e,0):jc|=n),ol(e,t)}function Nl(e,t){0===t&&(1&e.mode?(t=dt,!(130023424&(dt<<=1))&&(dt=4194304)):t=1);var n=tl();null!==(e=xi(e,t))&&(yt(e,t,n),ol(e,n))}function Al(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Nl(e,n)}function Il(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,o=e.memoizedState;null!==o&&(n=o.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(s(314))}null!==r&&r.delete(t),Nl(e,n)}function Ol(e,t){return Qe(e,t)}function Ll(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dl(e,t,n,r){return new Ll(e,t,n,r)}function Rl(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Fl(e,t){var n=e.alternate;return null===n?((n=Dl(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Ml(e,t,n,r,o,i){var a=2;if(r=e,"function"==typeof e)Rl(e)&&(a=1);else if("string"==typeof e)a=5;else e:switch(e){case k:return xl(n.children,o,i,t);case P:a=8,o|=8;break;case T:return(e=Dl(12,n,t,2|o)).elementType=T,e.lanes=i,e;case O:return(e=Dl(13,n,t,o)).elementType=O,e.lanes=i,e;case L:return(e=Dl(19,n,t,o)).elementType=L,e.lanes=i,e;case F:return _l(n,o,i,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case N:a=10;break e;case A:a=9;break e;case I:a=11;break e;case D:a=14;break e;case R:a=16,r=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Dl(a,n,t,o)).elementType=e,t.type=r,t.lanes=i,t}function xl(e,t,n,r){return(e=Dl(7,e,r,t)).lanes=n,e}function _l(e,t,n,r){return(e=Dl(22,e,r,t)).elementType=F,e.lanes=n,e.stateNode={isHidden:!1},e}function Ul(e,t,n){return(e=Dl(6,e,null,t)).lanes=n,e}function jl(e,t,n){return(t=Dl(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zl(e,t,n,r,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vt(0),this.expirationTimes=vt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vt(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function ql(e,t,n,r,o,i,s,a,c){return e=new zl(e,t,n,a,c),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Dl(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ui(i),e}function Bl(e){if(!e)return Io;e:{if($e(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Fo(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Fo(n))return _o(e,n,t)}return t}function $l(e,t,n,r,o,i,s,a,c){return(e=ql(n,r,!0,e,0,i,0,a,c)).context=Bl(null),n=e.current,(i=zi(r=tl(),o=nl(n))).callback=null!=t?t:null,qi(n,i,o),e.current.lanes=o,yt(e,o,r),ol(e,r),e}function Hl(e,t,n,r){var o=t.current,i=tl(),s=nl(o);return n=Bl(n),null===t.context?t.context=n:t.pendingContext=n,(t=zi(i,s)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=qi(o,t,s))&&(rl(e,o,s,i),Bi(e,o,s)),s}function Wl(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gl(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Vl(e,t){Gl(e,t),(e=e.alternate)&&Gl(e,t)}kc=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Lo.current)Sa=!0;else{if(!(e.lanes&n||128&t.flags))return Sa=!1,function(e,t,n){switch(t.tag){case 3:Oa(t),gi();break;case 5:Zi(t);break;case 1:Fo(t.type)&&Uo(t);break;case 4:Yi(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,o=t.memoizedProps.value;Ao(ki,r._currentValue),r._currentValue=o;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ao(ts,1&ts.current),t.flags|=128,null):n&t.child.childLanes?Ua(e,t,n):(Ao(ts,1&ts.current),null!==(e=Wa(e,t,n))?e.sibling:null);Ao(ts,1&ts.current);break;case 19:if(r=!!(n&t.childLanes),128&e.flags){if(r)return $a(e,t,n);t.flags|=128}if(null!==(o=t.memoizedState)&&(o.rendering=null,o.tail=null,o.lastEffect=null),Ao(ts,ts.current),r)break;return null;case 22:case 23:return t.lanes=0,Pa(e,t,n)}return Wa(e,t,n)}(e,t,n);Sa=!!(131072&e.flags)}else Sa=!1,si&&1048576&t.flags&&ti(t,Qo,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ha(e,t),e=t.pendingProps;var o=Ro(t,Oo.current);Li(t,n),o=vs(null,t,r,e,o,n);var i=ys();return t.flags|=1,"object"==typeof o&&null!==o&&"function"==typeof o.render&&void 0===o.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Fo(r)?(i=!0,Uo(t)):i=!1,t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,Ui(t),o.updater=ia,t.stateNode=o,o._reactInternals=t,la(t,r,e,n),t=Ia(null,t,r,!0,i,n)):(t.tag=0,si&&i&&ni(t),wa(null,t,o,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ha(e,t),e=t.pendingProps,r=(o=r._init)(r._payload),t.type=r,o=t.tag=function(e){if("function"==typeof e)return Rl(e)?1:0;if(null!=e){if((e=e.$$typeof)===I)return 11;if(e===D)return 14}return 2}(r),e=ra(r,e),o){case 0:t=Na(null,t,r,e,n);break e;case 1:t=Aa(null,t,r,e,n);break e;case 11:t=Ca(null,t,r,e,n);break e;case 14:t=Ea(null,t,r,ra(r.type,e),n);break e}throw Error(s(306,r,""))}return t;case 0:return r=t.type,o=t.pendingProps,Na(e,t,r,o=t.elementType===r?o:ra(r,o),n);case 1:return r=t.type,o=t.pendingProps,Aa(e,t,r,o=t.elementType===r?o:ra(r,o),n);case 3:e:{if(Oa(t),null===e)throw Error(s(387));r=t.pendingProps,o=(i=t.memoizedState).element,ji(e,t),Hi(t,r,null,n);var a=t.memoizedState;if(r=a.element,i.isDehydrated){if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=La(e,t,r,n,o=ua(Error(s(423)),t));break e}if(r!==o){t=La(e,t,r,n,o=ua(Error(s(424)),t));break e}for(ii=uo(t.stateNode.containerInfo.firstChild),oi=t,si=!0,ai=null,n=Ei(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(gi(),r===o){t=Wa(e,t,n);break e}wa(e,t,r,n)}t=t.child}return t;case 5:return Zi(t),null===e&&di(t),r=t.type,o=t.pendingProps,i=null!==e?e.memoizedProps:null,a=o.children,ro(r,o)?a=null:null!==i&&ro(r,i)&&(t.flags|=32),Ta(e,t),wa(e,t,a,n),t.child;case 6:return null===e&&di(t),null;case 13:return Ua(e,t,n);case 4:return Yi(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Ci(t,null,r,n):wa(e,t,r,n),t.child;case 11:return r=t.type,o=t.pendingProps,Ca(e,t,r,o=t.elementType===r?o:ra(r,o),n);case 7:return wa(e,t,t.pendingProps,n),t.child;case 8:case 12:return wa(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,o=t.pendingProps,i=t.memoizedProps,a=o.value,Ao(ki,r._currentValue),r._currentValue=a,null!==i)if(cr(i.value,a)){if(i.children===o.children&&!Lo.current){t=Wa(e,t,n);break e}}else for(null!==(i=t.child)&&(i.return=t);null!==i;){var c=i.dependencies;if(null!==c){a=i.child;for(var l=c.firstContext;null!==l;){if(l.context===r){if(1===i.tag){(l=zi(-1,n&-n)).tag=2;var u=i.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}i.lanes|=n,null!==(l=i.alternate)&&(l.lanes|=n),Oi(i.return,n,t),c.lanes|=n;break}l=l.next}}else if(10===i.tag)a=i.type===t.type?null:i.child;else if(18===i.tag){if(null===(a=i.return))throw Error(s(341));a.lanes|=n,null!==(c=a.alternate)&&(c.lanes|=n),Oi(a,n,t),a=i.sibling}else a=i.child;if(null!==a)a.return=i;else for(a=i;null!==a;){if(a===t){a=null;break}if(null!==(i=a.sibling)){i.return=a.return,a=i;break}a=a.return}i=a}wa(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,r=t.pendingProps.children,Li(t,n),r=r(o=Di(o)),t.flags|=1,wa(e,t,r,n),t.child;case 14:return o=ra(r=t.type,t.pendingProps),Ea(e,t,r,o=ra(r.type,o),n);case 15:return ka(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:ra(r,o),Ha(e,t),t.tag=1,Fo(r)?(e=!0,Uo(t)):e=!1,Li(t,n),aa(t,r,o),la(t,r,o,n),Ia(null,t,r,!0,e,n);case 19:return $a(e,t,n);case 22:return Pa(e,t,n)}throw Error(s(156,t.tag))};var Ql="function"==typeof reportError?reportError:function(e){r.error(e)};function Jl(e){this._internalRoot=e}function Kl(e){this._internalRoot=e}function Yl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Xl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zl(){}function eu(e,t,n,r,o){var i=n._reactRootContainer;if(i){var s=i;if("function"==typeof o){var a=o;o=function(){var e=Wl(s);a.call(e)}}Hl(t,s,e,o)}else s=function(e,t,n,r,o){if(o){if("function"==typeof r){var i=r;r=function(){var e=Wl(s);i.call(e)}}var s=$l(t,r,e,0,null,!1,0,"",Zl);return e._reactRootContainer=s,e[mo]=s.current,$r(8===e.nodeType?e.parentNode:e),dl(),s}for(;o=e.lastChild;)e.removeChild(o);if("function"==typeof r){var a=r;r=function(){var e=Wl(c);a.call(e)}}var c=ql(e,0,!1,null,0,!1,0,"",Zl);return e._reactRootContainer=c,e[mo]=c.current,$r(8===e.nodeType?e.parentNode:e),dl((function(){Hl(t,c,n,r)})),c}(n,t,e,o,r);return Wl(s)}Kl.prototype.render=Jl.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Hl(e,t,null,null)},Kl.prototype.unmount=Jl.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dl((function(){Hl(null,e,null,null)})),t[mo]=null}},Kl.prototype.unstable_scheduleHydration=function(e){if(e){var t=Pt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ft.length&&0!==t&&t<Ft[n].priority;n++);Ft.splice(n,0,e),0===n&&Ut(e)}},Ct=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=pt(t.pendingLanes);0!==n&&(bt(t,1|n),ol(t,Xe()),!(6&Ic)&&($c=Xe()+500,Ho()))}break;case 13:dl((function(){var t=xi(e,1);if(null!==t){var n=tl();rl(t,e,1,n)}})),Vl(e,1)}},Et=function(e){if(13===e.tag){var t=xi(e,134217728);if(null!==t)rl(t,e,134217728,tl());Vl(e,134217728)}},kt=function(e){if(13===e.tag){var t=nl(e),n=xi(e,t);if(null!==n)rl(n,e,t,tl());Vl(e,t)}},Pt=function(){return St},Tt=function(e,t){var n=St;try{return St=e,t()}finally{St=n}},Ee=function(e,t,n){switch(t){case"input":if(Z(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var o=Eo(r);if(!o)throw Error(s(90));Q(r),Z(r,o)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&re(e,!!n.multiple,t,!1)}},Ie=ul,Oe=dl;var tu={usingClientEntryPoint:!1,Events:[wo,Co,Eo,Ne,Ae,ul]},nu={findFiberByHostInstance:So,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ru={bundleType:nu.bundleType,version:nu.version,rendererPackageName:nu.rendererPackageName,rendererConfig:nu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ge(e))?null:e.stateNode},findFiberByHostInstance:nu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ou=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ou.isDisabled&&ou.supportsFiber)try{it=ou.inject(ru),st=ou}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yl(t))throw Error(s(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:E,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Yl(e))throw Error(s(299));var n=!1,r="",o=Ql;return null!=t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(o=t.onRecoverableError)),t=ql(e,1,!1,null,0,n,0,r,o),e[mo]=t.current,$r(8===e.nodeType?e.parentNode:e),new Jl(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=Ge(t))?null:e.stateNode},t.flushSync=function(e){return dl(e)},t.hydrate=function(e,t,n){if(!Xl(t))throw Error(s(200));return eu(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Yl(e))throw Error(s(405));var r=null!=n&&n.hydratedSources||null,o=!1,i="",a=Ql;if(null!=n&&(!0===n.unstable_strictMode&&(o=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=$l(t,null,e,1,null!=n?n:null,o,0,i,a),e[mo]=t.current,$r(e),r)for(e=0;e<r.length;e++)o=(o=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new Kl(t)},t.render=function(e,t,n){if(!Xl(t))throw Error(s(200));return eu(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Xl(e))throw Error(s(40));return!!e._reactRootContainer&&(dl((function(){eu(null,null,e,!1,(function(){e._reactRootContainer=null,e[mo]=null}))})),!0)},t.unstable_batchedUpdates=ul,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Xl(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return eu(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},5561:(e,t,n)=>{"use strict";var r=n(544);t.H=r.createRoot,r.hydrateRoot},544:(e,t,n)=>{"use strict";var r=n(9307);!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){r.error(e)}}(),e.exports=n(9584)},9306:(e,t)=>{"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),c=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),h=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function v(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||f}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||f}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var S=b.prototype=new y;S.constructor=b,g(S,v.prototype),S.isPureReactComponent=!0;var w=Array.isArray,C=Object.prototype.hasOwnProperty,E={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function P(e,t,r){var o,i={},s=null,a=null;if(null!=t)for(o in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(s=""+t.key),t)C.call(t,o)&&!k.hasOwnProperty(o)&&(i[o]=t[o]);var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){for(var l=Array(c),u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}if(e&&e.defaultProps)for(o in c=e.defaultProps)void 0===i[o]&&(i[o]=c[o]);return{$$typeof:n,type:e,key:s,ref:a,props:i,_owner:E.current}}function T(e){return"object"==typeof e&&null!==e&&e.$$typeof===n}var N=/\/+/g;function A(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function I(e,t,o,i,s){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var c=!1;if(null===e)c=!0;else switch(a){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case n:case r:c=!0}}if(c)return s=s(c=e),e=""===i?"."+A(c,0):i,w(s)?(o="",null!=e&&(o=e.replace(N,"$&/")+"/"),I(s,t,o,"",(function(e){return e}))):null!=s&&(T(s)&&(s=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,o+(!s.key||c&&c.key===s.key?"":(""+s.key).replace(N,"$&/")+"/")+e)),t.push(s)),1;if(c=0,i=""===i?".":i+":",w(e))for(var l=0;l<e.length;l++){var u=i+A(a=e[l],l);c+=I(a,t,o,u,s)}else if(u=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=h&&e[h]||e["@@iterator"])?e:null}(e),"function"==typeof u)for(e=u.call(e),l=0;!(a=e.next()).done;)c+=I(a=a.value,t,o,u=i+A(a,l++),s);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return c}function O(e,t,n){if(null==e)return e;var r=[],o=0;return I(e,r,"","",(function(e){return t.call(n,e,o++)})),r}function L(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var D={current:null},R={transition:null},F={ReactCurrentDispatcher:D,ReactCurrentBatchConfig:R,ReactCurrentOwner:E};function M(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:O,forEach:function(e,t,n){O(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return O(e,(function(){t++})),t},toArray:function(e){return O(e,(function(e){return e}))||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=o,t.Profiler=s,t.PureComponent=b,t.StrictMode=i,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=F,t.act=M,t.cloneElement=function(e,t,r){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var o=g({},e.props),i=e.key,s=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,a=E.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(l in t)C.call(t,l)&&!k.hasOwnProperty(l)&&(o[l]=void 0===t[l]&&void 0!==c?c[l]:t[l])}var l=arguments.length-2;if(1===l)o.children=r;else if(1<l){c=Array(l);for(var u=0;u<l;u++)c[u]=arguments[u+2];o.children=c}return{$$typeof:n,type:e.type,key:i,ref:s,props:o,_owner:a}},t.createContext=function(e){return(e={$$typeof:c,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=P,t.createFactory=function(e){var t=P.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=T,t.lazy=function(e){return{$$typeof:p,_payload:{_status:-1,_result:e},_init:L}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=R.transition;R.transition={};try{e()}finally{R.transition=t}},t.unstable_act=M,t.useCallback=function(e,t){return D.current.useCallback(e,t)},t.useContext=function(e){return D.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return D.current.useDeferredValue(e)},t.useEffect=function(e,t){return D.current.useEffect(e,t)},t.useId=function(){return D.current.useId()},t.useImperativeHandle=function(e,t,n){return D.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return D.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return D.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return D.current.useMemo(e,t)},t.useReducer=function(e,t,n){return D.current.useReducer(e,t,n)},t.useRef=function(e){return D.current.useRef(e)},t.useState=function(e){return D.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return D.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return D.current.useTransition()},t.version="18.3.1"},7011:(e,t,n)=>{"use strict";e.exports=n(9306)},358:(e,t,n)=>{"use strict";var r=n(9307);function o(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,o=e[r];if(!(0<a(o,t)))break e;e[r]=t,e[n]=o,n=r}}function i(e){return 0===e.length?null:e[0]}function s(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,o=e.length,i=o>>>1;r<i;){var s=2*(r+1)-1,c=e[s],l=s+1,u=e[l];if(0>a(c,n))l<o&&0>a(u,c)?(e[r]=u,e[l]=n,r=l):(e[r]=c,e[s]=n,r=s);else{if(!(l<o&&0>a(u,n)))break e;e[r]=u,e[l]=n,r=l}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var c=performance;t.unstable_now=function(){return c.now()}}else{var l=Date,u=l.now();t.unstable_now=function(){return l.now()-u}}var d=[],p=[],h=1,f=null,g=3,m=!1,v=!1,y=!1,b="function"==typeof setTimeout?setTimeout:null,S="function"==typeof clearTimeout?clearTimeout:null,w="undefined"!=typeof setImmediate?setImmediate:null;function C(e){for(var t=i(p);null!==t;){if(null===t.callback)s(p);else{if(!(t.startTime<=e))break;s(p),t.sortIndex=t.expirationTime,o(d,t)}t=i(p)}}function E(e){if(y=!1,C(e),!v)if(null!==i(d))v=!0,M(k);else{var t=i(p);null!==t&&x(E,t.startTime-e)}}function k(e,n){v=!1,y&&(y=!1,S(A),A=-1),m=!0;var r=g;try{for(C(n),f=i(d);null!==f&&(!(f.expirationTime>n)||e&&!L());){var o=f.callback;if("function"==typeof o){f.callback=null,g=f.priorityLevel;var a=o(f.expirationTime<=n);n=t.unstable_now(),"function"==typeof a?f.callback=a:f===i(d)&&s(d),C(n)}else s(d);f=i(d)}if(null!==f)var c=!0;else{var l=i(p);null!==l&&x(E,l.startTime-n),c=!1}return c}finally{f=null,g=r,m=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var P,T=!1,N=null,A=-1,I=5,O=-1;function L(){return!(t.unstable_now()-O<I)}function D(){if(null!==N){var e=t.unstable_now();O=e;var n=!0;try{n=N(!0,e)}finally{n?P():(T=!1,N=null)}}else T=!1}if("function"==typeof w)P=function(){w(D)};else if("undefined"!=typeof MessageChannel){var R=new MessageChannel,F=R.port2;R.port1.onmessage=D,P=function(){F.postMessage(null)}}else P=function(){b(D,0)};function M(e){N=e,T||(T=!0,P())}function x(e,n){A=b((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){v||m||(v=!0,M(k))},t.unstable_forceFrameRate=function(e){0>e||125<e?r.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return i(d)},t.unstable_next=function(e){switch(g){case 1:case 2:case 3:var t=3;break;default:t=g}var n=g;g=t;try{return e()}finally{g=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=g;g=e;try{return t()}finally{g=n}},t.unstable_scheduleCallback=function(e,n,r){var s=t.unstable_now();switch("object"==typeof r&&null!==r?r="number"==typeof(r=r.delay)&&0<r?s+r:s:r=s,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:h++,callback:n,priorityLevel:e,startTime:r,expirationTime:a=r+a,sortIndex:-1},r>s?(e.sortIndex=r,o(p,e),null===i(d)&&e===i(p)&&(y?(S(A),A=-1):y=!0,x(E,r-s))):(e.sortIndex=a,o(d,e),v||m||(v=!0,M(k))),e},t.unstable_shouldYield=L,t.unstable_wrapCallback=function(e){var t=g;return function(){var n=g;g=t;try{return e.apply(this,arguments)}finally{g=n}}}},9593:(e,t,n)=>{"use strict";e.exports=n(358)},6650:(e,t,n)=>{"use strict";var r=n(7216),o=n(3457),i=n(3867)(),s=n(600),a=n(9230),c=r("%Math.floor%");e.exports=function(e,t){if("function"!=typeof e)throw new a("`fn` is not a function");if("number"!=typeof t||t<0||t>4294967295||c(t)!==t)throw new a("`length` must be a positive 32-bit integer");var n=arguments.length>2&&!!arguments[2],r=!0,l=!0;if("length"in e&&s){var u=s(e,"length");u&&!u.configurable&&(r=!1),u&&!u.writable&&(l=!1)}return(r||l||!n)&&(i?o(e,"length",t,!0,!0):o(e,"length",t)),e}},3489:e=>{e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},994:(e,t,n)=>{"use strict";var r=n(4689),o=n(6534),i=n(731),s=n(4460);function a(e){return e.call.bind(e)}var c="undefined"!=typeof BigInt,l="undefined"!=typeof Symbol,u=a(Object.prototype.toString),d=a(Number.prototype.valueOf),p=a(String.prototype.valueOf),h=a(Boolean.prototype.valueOf);if(c)var f=a(BigInt.prototype.valueOf);if(l)var g=a(Symbol.prototype.valueOf);function m(e,t){if("object"!=typeof e)return!1;try{return t(e),!0}catch(e){return!1}}function v(e){return"[object Map]"===u(e)}function y(e){return"[object Set]"===u(e)}function b(e){return"[object WeakMap]"===u(e)}function S(e){return"[object WeakSet]"===u(e)}function w(e){return"[object ArrayBuffer]"===u(e)}function C(e){return"undefined"!=typeof ArrayBuffer&&(w.working?w(e):e instanceof ArrayBuffer)}function E(e){return"[object DataView]"===u(e)}function k(e){return"undefined"!=typeof DataView&&(E.working?E(e):e instanceof DataView)}t.isArgumentsObject=r,t.isGeneratorFunction=o,t.isTypedArray=s,t.isPromise=function(e){return"undefined"!=typeof Promise&&e instanceof Promise||null!==e&&"object"==typeof e&&"function"==typeof e.then&&"function"==typeof e.catch},t.isArrayBufferView=function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):s(e)||k(e)},t.isUint8Array=function(e){return"Uint8Array"===i(e)},t.isUint8ClampedArray=function(e){return"Uint8ClampedArray"===i(e)},t.isUint16Array=function(e){return"Uint16Array"===i(e)},t.isUint32Array=function(e){return"Uint32Array"===i(e)},t.isInt8Array=function(e){return"Int8Array"===i(e)},t.isInt16Array=function(e){return"Int16Array"===i(e)},t.isInt32Array=function(e){return"Int32Array"===i(e)},t.isFloat32Array=function(e){return"Float32Array"===i(e)},t.isFloat64Array=function(e){return"Float64Array"===i(e)},t.isBigInt64Array=function(e){return"BigInt64Array"===i(e)},t.isBigUint64Array=function(e){return"BigUint64Array"===i(e)},v.working="undefined"!=typeof Map&&v(new Map),t.isMap=function(e){return"undefined"!=typeof Map&&(v.working?v(e):e instanceof Map)},y.working="undefined"!=typeof Set&&y(new Set),t.isSet=function(e){return"undefined"!=typeof Set&&(y.working?y(e):e instanceof Set)},b.working="undefined"!=typeof WeakMap&&b(new WeakMap),t.isWeakMap=function(e){return"undefined"!=typeof WeakMap&&(b.working?b(e):e instanceof WeakMap)},S.working="undefined"!=typeof WeakSet&&S(new WeakSet),t.isWeakSet=function(e){return S(e)},w.working="undefined"!=typeof ArrayBuffer&&w(new ArrayBuffer),t.isArrayBuffer=C,E.working="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView&&E(new DataView(new ArrayBuffer(1),0,1)),t.isDataView=k;var P="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:void 0;function T(e){return"[object SharedArrayBuffer]"===u(e)}function N(e){return void 0!==P&&(void 0===T.working&&(T.working=T(new P)),T.working?T(e):e instanceof P)}function A(e){return m(e,d)}function I(e){return m(e,p)}function O(e){return m(e,h)}function L(e){return c&&m(e,f)}function D(e){return l&&m(e,g)}t.isSharedArrayBuffer=N,t.isAsyncFunction=function(e){return"[object AsyncFunction]"===u(e)},t.isMapIterator=function(e){return"[object Map Iterator]"===u(e)},t.isSetIterator=function(e){return"[object Set Iterator]"===u(e)},t.isGeneratorObject=function(e){return"[object Generator]"===u(e)},t.isWebAssemblyCompiledModule=function(e){return"[object WebAssembly.Module]"===u(e)},t.isNumberObject=A,t.isStringObject=I,t.isBooleanObject=O,t.isBigIntObject=L,t.isSymbolObject=D,t.isBoxedPrimitive=function(e){return A(e)||I(e)||O(e)||L(e)||D(e)},t.isAnyArrayBuffer=function(e){return"undefined"!=typeof Uint8Array&&(C(e)||N(e))},["isProxy","isExternal","isModuleNamespaceObject"].forEach((function(e){Object.defineProperty(t,e,{enumerable:!1,value:function(){throw new Error(e+" is not supported in userland")}})}))},1747:(e,t,n)=>{var r=n(7131),o=n(9307),i=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++)n[t[r]]=Object.getOwnPropertyDescriptor(e,t[r]);return n},s=/%[sdj%]/g;t.format=function(e){if(!S(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(u(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,o=r.length,i=String(e).replace(s,(function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}})),a=r[n];n<o;a=r[++n])y(a)||!E(a)?i+=" "+a:i+=" "+u(a);return i},t.deprecate=function(e,n){if(void 0!==r&&!0===r.noDeprecation)return e;if(void 0===r)return function(){return t.deprecate(e,n).apply(this,arguments)};var i=!1;return function(){if(!i){if(r.throwDeprecation)throw new Error(n);r.traceDeprecation?o.trace(n):o.error(n),i=!0}return e.apply(this,arguments)}};var a={},c=/^$/;if(r.env.NODE_DEBUG){var l=r.env.NODE_DEBUG;l=l.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),c=new RegExp("^"+l+"$","i")}function u(e,n){var r={seen:[],stylize:p};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),v(n)?r.showHidden=n:n&&t._extend(r,n),w(r.showHidden)&&(r.showHidden=!1),w(r.depth)&&(r.depth=2),w(r.colors)&&(r.colors=!1),w(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=d),h(r,e,r.depth)}function d(e,t){var n=u.styles[t];return n?"["+u.colors[n][0]+"m"+e+"["+u.colors[n][1]+"m":e}function p(e,t){return e}function h(e,n,r){if(e.customInspect&&n&&T(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var o=n.inspect(r,e);return S(o)||(o=h(e,o,r)),o}var i=function(e,t){if(w(t))return e.stylize("undefined","undefined");if(S(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}if(b(t))return e.stylize(""+t,"number");if(v(t))return e.stylize(""+t,"boolean");if(y(t))return e.stylize("null","null")}(e,n);if(i)return i;var s=Object.keys(n),a=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(n)),P(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return f(n);if(0===s.length){if(T(n)){var c=n.name?": "+n.name:"";return e.stylize("[Function"+c+"]","special")}if(C(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(k(n))return e.stylize(Date.prototype.toString.call(n),"date");if(P(n))return f(n)}var l,u="",d=!1,p=["{","}"];(m(n)&&(d=!0,p=["[","]"]),T(n))&&(u=" [Function"+(n.name?": "+n.name:"")+"]");return C(n)&&(u=" "+RegExp.prototype.toString.call(n)),k(n)&&(u=" "+Date.prototype.toUTCString.call(n)),P(n)&&(u=" "+f(n)),0!==s.length||d&&0!=n.length?r<0?C(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),l=d?function(e,t,n,r,o){for(var i=[],s=0,a=t.length;s<a;++s)O(t,String(s))?i.push(g(e,t,n,r,String(s),!0)):i.push("");return o.forEach((function(o){o.match(/^\d+$/)||i.push(g(e,t,n,r,o,!0))})),i}(e,n,r,a,s):s.map((function(t){return g(e,n,r,a,t,d)})),e.seen.pop(),function(e,t,n){var r=e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0);if(r>60)return n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1];return n[0]+t+" "+e.join(", ")+" "+n[1]}(l,u,p)):p[0]+u+p[1]}function f(e){return"["+Error.prototype.toString.call(e)+"]"}function g(e,t,n,r,o,i){var s,a,c;if((c=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?a=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(a=e.stylize("[Setter]","special")),O(r,o)||(s="["+o+"]"),a||(e.seen.indexOf(c.value)<0?(a=y(n)?h(e,c.value,null):h(e,c.value,n-1)).indexOf("\n")>-1&&(a=i?a.split("\n").map((function(e){return"  "+e})).join("\n").slice(2):"\n"+a.split("\n").map((function(e){return"   "+e})).join("\n")):a=e.stylize("[Circular]","special")),w(s)){if(i&&o.match(/^\d+$/))return a;(s=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.slice(1,-1),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function m(e){return Array.isArray(e)}function v(e){return"boolean"==typeof e}function y(e){return null===e}function b(e){return"number"==typeof e}function S(e){return"string"==typeof e}function w(e){return void 0===e}function C(e){return E(e)&&"[object RegExp]"===N(e)}function E(e){return"object"==typeof e&&null!==e}function k(e){return E(e)&&"[object Date]"===N(e)}function P(e){return E(e)&&("[object Error]"===N(e)||e instanceof Error)}function T(e){return"function"==typeof e}function N(e){return Object.prototype.toString.call(e)}function A(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(e=e.toUpperCase(),!a[e])if(c.test(e)){var n=r.pid;a[e]=function(){var r=t.format.apply(t,arguments);o.error("%s %d: %s",e,n,r)}}else a[e]=function(){};return a[e]},t.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.types=n(994),t.isArray=m,t.isBoolean=v,t.isNull=y,t.isNullOrUndefined=function(e){return null==e},t.isNumber=b,t.isString=S,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=w,t.isRegExp=C,t.types.isRegExp=C,t.isObject=E,t.isDate=k,t.types.isDate=k,t.isError=P,t.types.isNativeError=P,t.isFunction=T,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=n(3489);var I=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function O(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){var e,n;o.log("%s - %s",(e=new Date,n=[A(e.getHours()),A(e.getMinutes()),A(e.getSeconds())].join(":"),[e.getDate(),I[e.getMonth()],n].join(" ")),t.format.apply(t,arguments))},t.inherits=n(5515),t._extend=function(e,t){if(!t||!E(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e};var L="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function D(e,t){if(!e){var n=new Error("Promise was rejected with a falsy value");n.reason=e,e=n}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(L&&e[L]){var t;if("function"!=typeof(t=e[L]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,L,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,n,r=new Promise((function(e,r){t=e,n=r})),o=[],i=0;i<arguments.length;i++)o.push(arguments[i]);o.push((function(e,r){e?n(e):t(r)}));try{e.apply(this,o)}catch(e){n(e)}return r}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),L&&Object.defineProperty(t,L,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,i(e))},t.promisify.custom=L,t.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function t(){for(var t=[],n=0;n<arguments.length;n++)t.push(arguments[n]);var o=t.pop();if("function"!=typeof o)throw new TypeError("The last argument must be of type Function");var i=this,s=function(){return o.apply(i,arguments)};e.apply(this,t).then((function(e){r.nextTick(s.bind(null,null,e))}),(function(e){r.nextTick(D.bind(null,e,s))}))}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),Object.defineProperties(t,i(e)),t}},731:(e,t,n)=>{"use strict";var r=n(6034),o=n(276),i=n(9527),s=n(715),a=n(600),c=s("Object.prototype.toString"),l=n(9e3)(),u="undefined"==typeof globalThis?n.g:globalThis,d=o(),p=s("String.prototype.slice"),h=Object.getPrototypeOf,f=s("Array.prototype.indexOf",!0)||function(e,t){for(var n=0;n<e.length;n+=1)if(e[n]===t)return n;return-1},g={__proto__:null};r(d,l&&a&&h?function(e){var t=new u[e];if(Symbol.toStringTag in t){var n=h(t),r=a(n,Symbol.toStringTag);if(!r){var o=h(n);r=a(o,Symbol.toStringTag)}g["$"+e]=i(r.get)}}:function(e){var t=new u[e],n=t.slice||t.set;n&&(g["$"+e]=i(n))});e.exports=function(e){if(!e||"object"!=typeof e)return!1;if(!l){var t=p(c(e),8,-1);return f(d,t)>-1?t:"Object"===t&&function(e){var t=!1;return r(g,(function(n,r){if(!t)try{n(e),t=p(r,1)}catch(e){}})),t}(e)}return a?function(e){var t=!1;return r(g,(function(n,r){if(!t)try{"$"+n(e)===r&&(t=p(r,1))}catch(e){}})),t}(e):null}},1141:(e,t,n)=>{"use strict";t.b=void 0;var r=n(6580);Object.defineProperty(t,"b",{enumerable:!0,get:function(){return r.EventEmitter}})},276:(e,t,n)=>{"use strict";var r=n(4808),o="undefined"==typeof globalThis?n.g:globalThis;e.exports=function(){for(var e=[],t=0;t<r.length;t++)"function"==typeof o[r[t]]&&(e[e.length]=r[t]);return e}},5944:(e,t,n)=>{"use strict";n.d(t,{AH:()=>o,O0:()=>i});var r=n(2427);const o=e=>r.Ss.from(e,"base64").toString("utf8"),i=e=>r.Ss.from(e,"utf8").toString("base64")},2427:(e,t,n)=>{"use strict";n.d(t,{JR:()=>s,Km:()=>o,Ss:()=>c,Xg:()=>i});var r=n(3499);function o(e,t){switch(t){case"base64":return r.fromByteArray(e);case"utf8":case"utf-8":case void 0:return(new TextDecoder).decode(e);default:throw new Error("invalid/unsupported encoding")}}const i=(e,t)=>c.from(e,t).buffer,s=(e,t)=>c.from(e).toString(t);function a(e){const t=e;return e instanceof ArrayBuffer||"object"==typeof t&&null!==t&&"number"==typeof t.byteLength&&"function"==typeof t.slice&&void 0===t.byteOffset&&void 0===t.buffer}class c extends Uint8Array{toString(e){return o(this,e)}static from(e,t,n){if("string"==typeof e)return c.fromString(e,t);if(null!==e&&"object"==typeof e&&a(e.buffer))return c.fromArrayBuffer(e.buffer,e.byteOffset,e.byteLength);if(a(e))return c.fromArrayBuffer(e,t,n);throw new TypeError("Input value was neither a string nor an ArrayBuffer.")}static fromArrayBuffer(e,t,n){const r=t??0,o=n??e.byteLength-r;if(r<0||r>e.byteLength||o<0||o+r>e.byteLength)throw new RangeError("Invalid range specified.");return new c(e,r,o)}static fromString(e,t){switch(t){case"base64":{const t=this.sanitizeBase64(e),n=r.toByteArray(t);return new c(n.buffer)}case"utf8":case"utf-8":case void 0:{const t=(new TextEncoder).encode(e);return new c(t.buffer)}default:throw new Error("invalid/unsupported encoding")}}static isBuffer(e){throw new Error("unimplemented")}static sanitizeBase64(e){let t=e;if(t=t.split("=")[0],t=t.replace(/[^\w+-/]/g,""),t.length%4!=0){t+=["","===","==","="][t.length%4]}return t}}},7025:(e,t,n)=>{"use strict";n.d(t,{yi:()=>o});const r={supportedFeatures:new Set,generation:0,pkgVersion:"unknown"};function o(e,t){const n=t??r;let o=!0;const i=[];n.generation<e.minSupportedGeneration&&(o=!1);for(const t of e.requiredFeatures)n.supportedFeatures.has(t)||i.push(t);return o&&0===i.length?{isCompatible:!0}:{isCompatible:!1,isGenerationCompatible:o,unsupportedFeatures:i.length>0?i:void 0}}},9873:(e,t,n)=>{"use strict";n.d(t,{l:()=>r});const r=()=>globalThis.performance.now()},836:(e,t,n)=>{"use strict";n.d(t,{X:()=>o});var r=n(1141);class o extends r.b{constructor(){super(),this.addListener=super.addListener.bind(this),this.on=super.on.bind(this),this.once=super.once.bind(this),this.prependListener=super.prependListener.bind(this),this.prependOnceListener=super.prependOnceListener.bind(this),this.removeListener=super.removeListener.bind(this),this.off=super.off.bind(this)}}},709:(e,t,n)=>{"use strict";var r,o;n.d(t,{d:()=>o}),function(e){e.Disconnected=0,e.EstablishingConnection=3,e.CatchingUp=1,e.Connected=2}(r||(r={})),function(e){e.cache="fluid-cache",e.clientDetails="fluid-client-details",e.loadMode="loadMode",e.reconnect="fluid-reconnect",e.sequenceNumber="fluid-sequence-number",e.version="version"}(o||(o={}))},7696:(e,t,n)=>{"use strict";var r;n.d(t,{d:()=>r}),function(e){e.Detached="Detached",e.Attaching="Attaching",e.Attached="Attached"}(r||(r={}))},3275:(e,t,n)=>{"use strict";n.d(t,{k:()=>r});const r={genericError:"genericError",throttlingError:"throttlingError",dataCorruptionError:"dataCorruptionError",dataProcessingError:"dataProcessingError",usageError:"usageError"}},6265:(e,t,n)=>{"use strict";n.d(t,{$:()=>r});const r={verbose:10,default:20,error:30}},8172:(e,t,n)=>{"use strict";function r(e,t){e||function(e){const t=new Error("number"==typeof e?`0x${e.toString(16).padStart(3,"0")}`:e);throw o(t),t}(t)}function o(e){for(const t of i)t(e)}n.d(t,{aT:()=>s,vA:()=>r});const i=new Set;function s(e){c((()=>{if(a){const t=e();if(!0!==t){const e=new Error(`Debug assert failed: ${t.toString()}`);throw o(e),e}}}))}let a=!1;function c(e){}},6952:(e,t,n)=>{"use strict";n.d(t,{I:()=>o,d:()=>r});class r{constructor(e){this.valueGenerator=e,this._evaluated=!1}get evaluated(){return this._evaluated}get value(){return this._evaluated||(this._evaluated=!0,this._value=this.valueGenerator()),this._value}}class o{get[Symbol.toStringTag](){return"[object LazyPromise]"}constructor(e){this.execute=e}async then(e,t){return this.getPromise().then(...arguments)}async catch(e){return this.getPromise().catch(...arguments)}async finally(e){return this.getPromise().finally(...arguments)}async getPromise(){return void 0===this.result&&(this.result=this.execute()),this.result}}},8980:(e,t,n)=>{"use strict";n.d(t,{c:()=>r});class r{constructor(){this.completed=!1,this.p=new Promise(((e,t)=>{this.res=e,this.rej=t}))}get isCompleted(){return this.completed}get promise(){return this.p}resolve(e){void 0!==this.res&&(this.completed=!0,this.res(e))}reject(e){void 0!==this.rej&&(this.completed=!0,this.rej(e))}}},27:(e,t,n)=>{"use strict";n.d(t,{$:()=>r});const r=e=>(e=>"object"==typeof e&&null!==e)(e)&&"then"in e&&"function"==typeof e.then},790:(e,t,n)=>{"use strict";function r(e,t="Unreachable Case"){throw new Error(t)}n.d(t,{$:()=>r})},999:(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var r=n(3275);const{dataCorruptionError:o,dataProcessingError:i,...s}=r.k,a={...s,genericNetworkError:"genericNetworkError",authorizationError:"authorizationError",fileNotFoundOrAccessDeniedError:"fileNotFoundOrAccessDeniedError",offlineError:"offlineError",unsupportedClientProtocolVersion:"unsupportedClientProtocolVersion",writeError:"writeError",fetchFailure:"fetchFailure",fetchTokenError:"fetchTokenError",incorrectServerResponse:"incorrectServerResponse",fileOverwrittenInStorage:"fileOverwrittenInStorage",deltaStreamConnectionForbidden:"deltaStreamConnectionForbidden",locationRedirection:"locationRedirection",fluidInvalidSchema:"fluidInvalidSchema",fileIsLocked:"fileIsLocked",outOfStorageError:"outOfStorageError"}},6290:(e,t,n)=>{"use strict";var r,o,i;n.d(t,{Go:()=>r}),function(e){e.NoOp="noop",e.ClientJoin="join",e.ClientLeave="leave",e.Propose="propose",e.Reject="reject",e.Accept="accept",e.Summarize="summarize",e.SummaryAck="summaryAck",e.SummaryNack="summaryNack",e.Operation="op",e.NoClient="noClient",e.RoundTrip="tripComplete",e.Control="control"}(r||(r={})),function(e){e.ClientJoin="join",e.ClientLeave="leave"}(o||(o={})),function(e){e.ThrottlingError="ThrottlingError",e.InvalidScopeError="InvalidScopeError",e.BadRequestError="BadRequestError",e.LimitExceededError="LimitExceededError"}(i||(i={}))},2180:(e,t,n)=>{"use strict";var r;n.d(t,{Z:()=>r}),function(e){e.Tree=1,e.Blob=2,e.Handle=3,e.Attachment=4}(r||(r={}))},1716:(e,t,n)=>{"use strict";var r;n.d(t,{U:()=>r}),function(e){e.summarizingClient="fluid-client-summarizer",e.createNew="createNew"}(r||(r={}))},2807:(e,t,n)=>{"use strict";n.d(t,{E9:()=>b,Gi:()=>g,OI:()=>h,Of:()=>m,Tj:()=>p,WA:()=>r,YU:()=>y,c_:()=>d,d8:()=>c,dw:()=>f,ix:()=>v,sc:()=>s,yi:()=>u});var r,o=n(999),i=n(2632);function s(){return"object"==typeof navigator&&null!==navigator&&"boolean"==typeof navigator.onLine?navigator.onLine?r.Online:r.Offline:r.Unknown}!function(e){e[e.Offline=0]="Offline",e[e.Online=1]="Online",e[e.Unknown=2]="Unknown"}(r||(r={}));class a extends i.iq{constructor(e,t,n){super(e,n),this.canRetry=t,this.errorType=o.a.genericNetworkError}}class c extends i.iq{constructor(e,t){super(e,t),this.errorType=o.a.fluidInvalidSchema,this.canRetry=!1}}class l extends i.iq{constructor(e,t,n){super(e,{...t,statusCode:400}),this.errorType=l.errorType,this.canRetry=!1,this.storageOnlyReason=n}}l.errorType=o.a.deltaStreamConnectionForbidden;class u extends i.iq{constructor(e,t,n,r){void 0!==t&&(r.claims=t),void 0!==n&&(r.tenantId=n),super(e,r,new Set(["claims","tenantId"])),this.errorType=o.a.authorizationError,this.canRetry=!1}}class d extends i.iq{constructor(e,t,n){super(e,n,new Set(["redirectUrl"])),this.redirectUrl=t,this.errorType=o.a.locationRedirection,this.canRetry=!1}}class p extends i.iq{constructor(e,t,n,r){super(e,r),this.errorType=t,this.canRetry=n}}class h extends p{constructor(e,t,n){super(e,t,!1,n),this.errorType=t}}class f extends p{constructor(e,t,n){super(e,t,!0,n),this.errorType=t}}class g extends i.iq{constructor(e,t,n){super(e,n),this.retryAfterSeconds=t,this.errorType=o.a.throttlingError,this.canRetry=!0}}const m=(e,t)=>new h(e,o.a.writeError,t);function v(e,t,n){return void 0!==t.retryAfterMs&&t.canRetry?new g(e,t.retryAfterMs/1e3,n):new a(e,t.canRetry,n)}const y=e=>!0===e?.canRetry,b=e=>void 0!==e?.retryAfterSeconds?1e3*e.retryAfterSeconds:void 0},7497:(e,t,n)=>{"use strict";n.d(t,{P:()=>o});var r=n(2427);async function o(e,t){const n=await e.readBlob(t),o=(0,r.JR)(n,"utf8");return JSON.parse(o)}},915:(e,t,n)=>{"use strict";n.d(t,{E:()=>r});const r={...n(999).a,invalidFileNameError:"invalidFileNameError",snapshotTooBig:"snapshotTooBig",fetchTimeout:"fetchTimeout",fluidNotEnabled:"fluidNotEnabled",cannotCatchUp:"cannotCatchUp",serviceReadOnly:"serviceReadOnly",blockedIPAddress:"blockedIPAddress"}},4312:(e,t,n)=>{"use strict";n.d(t,{Mh:()=>y,jC:()=>m,Cu:()=>v});var r=n(5944);const o="https://my.microsoftpersonalcontent.com",i="https://1drv.ms",s="1",a="fluid",c="s",l="d",u="f",d="c",p="a",h="p",f="v",g="x";const m="nav";function v(e,t){const n=function(e){const t=new URL(e.siteUrl),n=encodeURIComponent(t.pathname),o=encodeURIComponent(e.driveId),i=encodeURIComponent(e.itemId),m=encodeURIComponent(e.dataStorePath);let v=`${c}=${n}&${l}=${o}&${u}=${i}&${d}=${m}&${a}=${s}`;return e.appName&&(v+=`&${p}=${encodeURIComponent(e.appName)}`),e.containerPackageName&&(v+=`&${h}=${encodeURIComponent(e.containerPackageName)}`),e.fileVersion&&(v+=`&${f}=${encodeURIComponent(e.fileVersion)}`),e.context&&(v+=`&${g}=${encodeURIComponent(e.context)}`),(0,r.O0)(v)}(t);e.searchParams.set(m,n)}function y(e,t=!0){const n=e.searchParams.get(m);if(!n)return;return function(e,t,n=!0){const o=new URLSearchParams((0,r.AH)(e)),i=o.get(a);if(n&&"1"!==i)return;const s=o.get(c),m=o.get(l),v=o.get(u),y=o.get(d),b=o.get(p)??void 0,S=o.get(h)??void 0,w=o.get(f)??void 0,C=o.get(g)??void 0;if(!s||!m||!v||null===y)return;let E;try{E=new URL(s,t)}catch{}return E?{siteUrl:E.href,driveId:m,itemId:v,dataStorePath:y,appName:b,containerPackageName:S,fileVersion:w,context:C}:void 0}(n,e.origin.toLowerCase()===i?o:e.origin,t)}},7127:(e,t,n)=>{"use strict";n.d(t,{z6:()=>F,wF:()=>D,bP:()=>O,bf:()=>A,cr:()=>N,ZR:()=>T,nb:()=>M,Yn:()=>I,gO:()=>P,bJ:()=>L});var r=n(9873),o=n(8172),i=n(2807),s=n(999),a=n(915),c=n(5799),l=n(2632);const u="2.62.0";var d=n(5944);const p="Bearer";const h=712,f="serviceReadOnly";function g(e){const t=[{headerName:"sprequestguid",logName:"sprequestguid"},{headerName:"request-id",logName:"requestId"},{headerName:"client-request-id",logName:"clientRequestId"},{headerName:"x-msedge-ref",logName:"xMsedgeRef"},{headerName:"X-Fluid-Retries",logName:"serverRetries"},{headerName:"content-encoding",logName:"contentEncoding"},{headerName:"content-type",logName:"contentType"}],n={sprequestduration:(0,c.ZK)(e.get("sprequestduration")),contentsize:(0,c.ZK)(e.get("content-length"))};for(const r of t){const t=e.get(r.headerName);null!=t&&(n[r.logName]=t)}const r=e.get("x-fluid-telemetry");if(null!=r){n.xFluidTelemetry=r;const e=r.split(",").map((e=>e.split("=")));for(const[t,r]of e)if("Origin"===t.trim()){let e;switch(r?.trim()){case"c":e="cache";break;case"g":e="graph";break;default:e=r?.trim()}n["responseOrigin"]=e;break}}return n}class m extends l.iq{constructor(e,t,n){super(e,n,new Set(["redirectLocation"])),this.redirectLocation=t,this.errorType=s.a.fileNotFoundOrAccessDeniedError,this.canRetry=!1}}function v(e,t,n,r,o,c={}){let l;const v=function(e){try{if(void 0!==e){const t=JSON.parse(e);if(function(e){const t=e?.error;return"string"==typeof t?.message&&(void 0===t?.code||"string"==typeof t?.code)}(t))return{success:!0,errorResponse:t}}}catch{}return{success:!1}}(o);let y,b,S;if(v.success){const e=v.errorResponse;c.responseMessage=e.error.message,y=function(e){const t=[];let n=e.error;for(;"object"==typeof n&&null!==n;)void 0!==n.code&&t.unshift(n.code),n=n.innerError;return t}(e),void 0!==y&&(b=y[0],c.innerMostErrorCode=b)}const w={driverVersion:u,statusCode:t,...c};switch(t){case 301:case 302:case 303:case 307:case 308:if(S=r?.headers.get("Location")??void 0,void 0!==S){l=new m(e,S,w);break}case 400:if("fluidInvalidSchema"===b){l=new i.d8(e,w);break}l=new i.OI(e,s.a.genericNetworkError,w);break;case 401:case 403:if(b===f)l=new i.dw(e,a.E.serviceReadOnly,w);else if("blockedIPAddress"===b||"conditionalAccessPolicyEnforced"===b)l=new i.OI("IP Address is blocked",a.E.blockedIPAddress,w);else{const t=r?.headers?function(e){const t=e.get("www-authenticate");if(!t)return;let n,r=!1;return t.split(",").map((e=>{const t=e.split("=");t.length>=2&&(r||"error"!==t[0].trim().toLowerCase()?n||"claims"!==t[0].trim().toLowerCase()||(n=(0,d.AH)(JSON.parse(e.slice(Math.max(0,e.indexOf("=")+1)).trim()))):r="insufficient_claims"===JSON.parse(t[1].trim().toLowerCase()))})),r?n:void 0}(r.headers):void 0,n=r?.headers?function(e){const t=e.get("www-authenticate");if(!t)return;const n=t.indexOf(p);if(n<0)return;let r;return t.slice(Math.max(0,n+p.length)).split(",").map((e=>{if(!r){const t=e.split("=");t.length>=2&&"realm"===t[0].trim().toLowerCase()&&(r=JSON.parse(t[1].trim()))}})),r}(r.headers):void 0;l=new i.yi(e,t,n,w)}break;case 404:if(v.success){const t=v?.errorResponse?.error;if(S=t?.["@error.redirectLocation"],void 0!==S){l=new m(e,S,w);break}}l=new i.OI(e,s.a.fileNotFoundOrAccessDeniedError,w);break;case 406:l=new i.OI(e,s.a.unsupportedClientProtocolVersion,w);break;case 410:l=new i.OI(e,a.E.cannotCatchUp,w);break;case 409:l=new i.OI(e,s.a.fileOverwrittenInStorage,w);break;case 412:l=new i.OI(e,s.a.genericNetworkError,w);break;case 413:l=new i.OI(e,a.E.snapshotTooBig,w);break;case 414:l=new i.OI(e,a.E.invalidFileNameError,w);break;case 423:if("resourceLocked"===b||"resourceCheckedOut"===b){l=new i.OI(e,s.a.fileIsLocked,w);break}case 500:l=new i.dw(e,s.a.genericNetworkError,w);break;case 501:l=new i.OI(e,a.E.fluidNotEnabled,w);break;case 507:l=new i.OI(e,s.a.outOfStorageError,w);break;case h:l=new i.OI(e,s.a.incorrectServerResponse,w);break;default:{const t=void 0===n?void 0:1e3*n;l=(0,i.ix)(e,{canRetry:!0,retryAfterMs:t},w);break}}return l.addTelemetryProperties({endpointReached:!0}),function(e,t,n,r={}){e.online=i.WA[(0,i.sc)()],void 0!==n&&(e.facetCodes=n);if(t&&(r.responseType=t.type,t.headers)){const n=g(t.headers);for(const e of Object.keys(n))r[e]=n[e];e.serverEpoch=t.headers.get("x-fluid-epoch")??void 0}e.addTelemetryProperties(r)}(l,r,y,void 0),l}function y(e,t,n,r,o){const i=v(e,t,function(e){if(null===e)return;const t=Number(e);if(Number.isNaN(t))return;return t}(n.headers.get("retry-after")),n,r,o);throw i.addTelemetryProperties({odspError:!0,storageServiceError:!0}),i}const b=e=>null===e||"string"==typeof e?e:void 0===e?null:e.token,S=e=>{if("object"==typeof e&&void 0!==e?.authorizationHeader)return e.authorizationHeader;const t=b(e);return null!==t?`Bearer ${t}`:null},w=e=>null===e||"string"==typeof e?void 0:e.fromCache;var C=n(4312),E=n(7117);const k="getWithRetryForTokenRefreshRepeat";async function P(e){return e({refresh:!1}).catch((async t=>{const n={refresh:!0,previousError:t};switch(t.errorType){case a.E.authorizationError:{const r=t;return e({...n,claims:r.claims,tenantId:r.tenantId})}case a.E.incorrectServerResponse:case a.E.fetchTokenError:return e(n);default:if(!0===t[k])return e(n);throw t}}))}async function T(e,t){const n=(0,r.l)();return fetch(e,t).then((async e=>{const t=e;if(!t)throw new i.OI("No response from ODSP fetch call",a.E.incorrectServerResponse,{driverVersion:E.z});(!t.ok||t.status<200||t.status>=300)&&y(`ODSP fetch error [${t.status}]`,t.status,t,await t.text());const o=function(e){const t=new Map;for(const[n,r]of e.entries())t.set(n,r);return t}(t.headers);return{content:t,headers:o,propsToLog:g(o),duration:(0,r.l)()-n}}),(e=>{const t=(0,i.sc)(),n={value:`${e}`,tag:c.mc.UserData},r=n.value.replace(/((http|https):\/\/(\S*))/i,"REDACTED_URL");if("AbortError"===e.name)throw new i.dw("Fetch Timeout (AbortError)",a.E.fetchTimeout,{driverVersion:E.z});if(r.includes("ETIMEDOUT"))throw new i.dw("Fetch Timeout (ETIMEDOUT)",a.E.fetchTimeout,{driverVersion:E.z});throw t===i.WA.Offline?new i.dw(`ODSP fetch failure (Offline): ${r}`,a.E.offlineError,{driverVersion:E.z,rawErrorMessage:n}):new i.dw(`ODSP fetch failure: ${r}`,a.E.fetchFailure,{driverVersion:E.z,rawErrorMessage:n})}))}async function N(e,t){const{content:n,headers:r,propsToLog:o,duration:i}=await T(e,t);let s;try{s=await n.arrayBuffer()}catch{y("Error while parsing fetch response",h,n,void 0,o)}return o.bodySize=s.byteLength,{headers:r,content:s,propsToLog:o,duration:i}}async function A(e,t){const{content:n,headers:r,propsToLog:o,duration:i}=await T(e,t);let s;try{s=await n.text()}catch{y("Error while parsing fetch response",h,n,s,o)}o.bodySize=s.length;return{headers:r,content:JSON.parse(s),propsToLog:o,duration:i}}function I(e){return(0,o.vA)(!0===e.odspResolvedUrl,478),e}T.fetch=fetch;const O=e=>(0,c.pW)({logger:e,namespace:"OdspDriver",properties:{all:{driverVersion:E.z}}});function L(e,t,n){const r=function(e,t,n,r,o){return async(s,u,d=!1)=>c.Bt.timedExecAsync(e,{eventName:`${u}_GetToken`,attempts:s.refresh?2:1,hasClaims:!!s.claims,hasTenantId:!!s.tenantId},(async e=>n({...s,...t}).then((t=>{const n=o?b(t):S(t);if((d||e.duration>=32)&&e.end({fromCache:w(t),isNull:null===n}),null===n&&r)throw new i.OI("The Host-provided token fetcher returned null",a.E.fetchTokenError,{method:u,driverVersion:E.z});return n}),(e=>{const t=e?.canRetry;throw(0,l.J4)(e,(e=>new i.Tj("The Host-provided token fetcher threw an error",a.E.fetchTokenError,"boolean"==typeof t&&t,{method:u,errorMessage:e,driverVersion:E.z})))}))),{cancel:"generic"})}(e,t,n,!0,!1);return r}function D(e){if(!e)return;let t=`createLinkScope=${e.scope}`;const n=e.role;return t=n?`${t}&createLinkRole=${n}`:t,t}const R=e=>"object"==typeof e&&"string"==typeof e?.name&&"object"==typeof e?.fluid;function F(e,t,n,r){const o=new URL(e),i=n||(t.dataStorePath??"");return(0,C.Cu)(o,{siteUrl:t.siteUrl,driveId:t.driveId,itemId:t.itemId,dataStorePath:i,appName:t.appName,containerPackageName:r,fileVersion:t.fileVersion,context:t.context}),o.href}function M(e){let t;return t=e&&"name"in e?e.name:R(e?.package)?e?.package.name:e?.package,t}},7117:(e,t,n)=>{"use strict";n.d(t,{z:()=>r});const r="2.62.0"},620:(e,t,n)=>{"use strict";n.d(t,{SA:()=>d,oh:()=>a,jP:()=>l,zF:()=>i,Fz:()=>u});const r="IFluidHandle",o=Symbol.for("FluidHandle-3978c7cf-4675-49ba-a20c-bf35efbf43da"),i=e=>"__fluid_handle__"===e?.type,s=e=>"payloadPending"in e&&!0===e.payloadPending;function a(e){return s(e)?{type:"__fluid_handle__",url:e.absolutePath,payloadPending:!0}:{type:"__fluid_handle__",url:e.absolutePath}}const c=!0;function l(e){if("object"!=typeof e||null===e)return!1;if(o in e)return!0;if(c&&r in e){const t=e[r];return"object"==typeof t&&null!==t&&r in t}return!1}function u(e){if(!(o in e)||!(o in e[o])){if(c&&r in e)return e[r];throw new TypeError("Invalid IFluidHandle")}return e[o]}class d{get IFluidHandle(){return this}get[o](){return this}}},8880:(e,t,n)=>{"use strict";n.d(t,{X:()=>r});class r{static getPathParts(e){const t=e.indexOf("?"),n=[],r=e.slice(0,t<0?e.length:t);for(const e of r.split("/"))void 0!==e&&e.length>0&&n.push(decodeURIComponent(e));return n}static create(e){return e instanceof r?e:new r(e)}constructor(e){this.request=e;const t=this.request.url.indexOf("?");this.query=t>=0?this.request.url.slice(t):"",void 0!==e.headers&&(this.headers=e.headers)}get url(){return this.request.url}get pathParts(){return void 0===this.requestPathParts&&(this.requestPathParts=r.getPathParts(this.url)),this.requestPathParts}isLeaf(e){return""===this.query&&this.pathParts.length===e}createSubRequest(e){const t=this.pathParts.length;if(e<0||e>t)throw new Error("incorrect sub-request");if(e===t&&this.url.includes("?"))return{url:`/${this.query}`,headers:this.headers};const n=`/${this.pathParts.slice(e).join("/")}`;return{url:""===this.query?n:`${n}/${this.query}`,headers:this.headers}}}},9461:(e,t,n)=>{"use strict";n.d(t,{CL:()=>m,G0:()=>d,Ln:()=>h,fG:()=>f,lh:()=>i,uz:()=>p});var r=n(6952),o=n(5799);const i=new r.d((()=>a(u()))),s={getRawConfig:()=>{}},a=e=>null!=e?new d(void 0,{getRawConfig:t=>{try{return l(e.getItem(t)??void 0)?.raw}catch{return}}}):s;function c(e){switch(e){case"boolean":case"number":case"string":return!0;default:return!1}}function l(e){let t,n=e;if("string"==typeof e)try{n=JSON.parse(e),t={raw:e,string:e}}catch{}if(void 0===n)return t;const r=typeof n;if(c(r))return{...t,raw:e,[r]:n};if(Array.isArray(n)){const r=typeof n[0];if(!c(r))return t;for(const e of n)if(typeof e!==r)return t;return{...t,raw:e,[`${r}[]`]:n}}return t}const u=()=>{try{return globalThis.sessionStorage??void 0}catch{return}};class d{constructor(e,...t){this.logger=e,this.configCache=new Map,this.orderedBaseProviders=[];const n=new Set,r=[...t];for(;r.length>0;){const e=r.shift();void 0!==e&&g(e)&&!n.has(e)&&(n.add(e),e instanceof d?r.push(...e.orderedBaseProviders):this.orderedBaseProviders.push(e))}}getBoolean(e){return this.getCacheEntry(e)?.boolean}getNumber(e){return this.getCacheEntry(e)?.number}getString(e){return this.getCacheEntry(e)?.string}getBooleanArray(e){return this.getCacheEntry(e)?.["boolean[]"]}getNumberArray(e){return this.getCacheEntry(e)?.["number[]"]}getStringArray(e){return this.getCacheEntry(e)?.["string[]"]}getRawConfig(e){return this.getCacheEntry(e)?.raw}getCacheEntry(e){if(!this.configCache.has(e)){for(const t of this.orderedBaseProviders){const n=l(t?.getRawConfig(e));if(void 0!==n)return this.configCache.set(e,n),this.logger?.send({category:"generic",eventName:"ConfigRead",...(0,o.Df)({configName:e,configValue:JSON.stringify(n)})}),n}this.configCache.set(e,{raw:void 0})}return this.configCache.get(e)}}function p(e){const t=e;return g(t?.config)&&void 0!==t?.logger}function h(e){return p(e)?e:f(e,i.value)}function f(e,...t){if(p(e))throw new Error("Logger is already a monitoring context");const n=e;return n.config=new d(e,...t),n.logger=e,n}function g(e){const t=e;return"function"==typeof t?.getRawConfig}function m(e){return h((0,o.pW)(e))}},4173:(e,t,n)=>{"use strict";n.d(t,{EW:()=>a,I9:()=>c,ds:()=>l,eb:()=>s,gn:()=>i});var r=n(3275),o=n(2632);class i extends o.iq{constructor(e,t,n){super(e,n,new Set(["error"])),this.error=t,this.errorType=r.k.genericError}}class s extends o.iq{constructor(e,t){super(e,{...t,usageError:!0}),this.errorType=r.k.usageError}}class a extends o.iq{constructor(e,t){super(e,{...t,dataProcessingError:1}),this.errorType=r.k.dataCorruptionError,this.canRetry=!1}}class c extends o.iq{constructor(e,t){super(e,t),this.errorType=r.k.dataProcessingError,this.canRetry=!1}static create(e,t,n,r={},o){const i=Error,s=i.stackTraceLimit;try{void 0!==o&&(i.stackTraceLimit=o);const s=c.wrapIfUnrecognized(e,t,n);return s.addTelemetryProperties(r),s}finally{void 0!==o&&(i.stackTraceLimit=s)}}static wrapIfUnrecognized(e,t,n){const r={dataProcessingError:1,dataProcessingCodepath:t,...void 0===n?void 0:l(n)},i=(0,o.cQ)(e,{props:r});if((0,o.vt)(i)||i.errorType===o.i5){const e=(0,o.J4)(i,(e=>new c(e)));return e.addTelemetryProperties(i.getTelemetryProperties()),e}return i}}const l=e=>({messageClientId:null===e.clientId?"null":e.clientId,messageSequenceNumber:e.sequenceNumber,messageClientSequenceNumber:e.clientSequenceNumber,messageReferenceSequenceNumber:e.referenceSequenceNumber,messageMinimumSequenceNumber:e.minimumSequenceNumber,messageTimestamp:e.timestamp})},2632:(e,t,n)=>{"use strict";n.d(t,{AV:()=>a,G:()=>f,J4:()=>h,aX:()=>p,cQ:()=>l,dy:()=>c,i5:()=>b,iq:()=>y,oD:()=>d,qp:()=>v,vt:()=>m});var r=n(7783),o=n(8036),i=n(5799);const s=e=>null!==e&&!Array.isArray(e)&&"object"==typeof e;function a(e,t){const n={message:"string"==typeof e?.message?e.message:String(e)};if(s(e)){const{errorType:r,stack:o,name:i}=e;if("string"==typeof r&&(n.errorType=r),"string"==typeof o){const e="string"==typeof i?i:void 0;n.stack=((e,n)=>{if(!t)return e;const r=e.split("\n");return r.shift(),void 0!==n&&r.unshift(n),r.join("\n")})(o,e)}}return n}const c=e=>"function"==typeof e?.getTelemetryProperties;function l(e,t={}){if((0,o.X)(e))return e.addTelemetryProperties(t.props??{}),e;const{message:n,stack:r}=a(e,!1),i=new S({message:n,stack:r});if("object"==typeof e&&null!==e){const t=e;let n;"canRetry"in e&&(n??={},n.canRetry=t.canRetry),"retryAfterSeconds"in e&&(n??={},n.retryAfterSeconds=t.retryAfterSeconds),void 0!==n&&Object.assign(i,n)}"object"!=typeof e&&i.addTelemetryProperties({typeofError:typeof e});const s=y.typeCheck(e)?e.getTelemetryProperties():{untrustedOrigin:1};return i.addTelemetryProperties({...s,...t.props}),i}let u;function d(e){const t=Error,n=t.stackTraceLimit;void 0!==e&&(t.stackTraceLimit=e);const r=new Error("<<generated stack>>");if(void 0===u&&(u=void 0!==r.stack),u)return t.stackTraceLimit=n,r;try{throw r}catch(e){return t.stackTraceLimit=n,e}}function p(e){return d(e).stack}function h(e,t){const{message:n,stack:r}=a(e,!1),i=t(n);return i.cause=e,void 0!==r&&g(i,r),m(e)&&i.addTelemetryProperties({untrustedOrigin:1}),(0,o.f)(e)&&(i.overwriteErrorInstanceId(e.errorInstanceId),i.addTelemetryProperties({innerErrorInstanceId:e.errorInstanceId})),c(e)&&i.addTelemetryProperties(e.getTelemetryProperties()),i}function f(e,t,n){const r=h(e,t),o=r.errorInstanceId,i=o;return n.sendTelemetryEvent({eventName:"WrapError",errorInstanceId:o,wrappedByErrorInstanceId:i},e),r}function g(e,t){try{Object.assign(e,{stack:t})}catch{e.addTelemetryProperties({stack2:t})}}function m(e){if(y.typeCheck(e)){if(e.errorType===b){const t=e.getTelemetryProperties();return 1===t.untrustedOrigin||Boolean(t.errorRunningExternalCode)}return!1}return!0}function v(e){return"string"==typeof e?.tag}class y extends Error{get errorInstanceId(){return this._errorInstanceId}overwriteErrorInstanceId(e){this._errorInstanceId=e}constructor(e,t,n=new Set){super(e),this.omitPropsFromLogging=n,this._errorInstanceId=(0,r.A)(),n.add("omitPropsFromLogging"),n.add("_errorInstanceId"),n.add("cause"),t&&this.addTelemetryProperties(t)}static typeCheck(e){return"object"==typeof e&&null!==e&&("function"==typeof e.addTelemetryProperties&&"function"==typeof e.getTelemetryProperties&&"string"==typeof e.errorInstanceId)}addTelemetryProperties(e){!function(e,t){for(const[n,r]of Object.entries(t))void 0===e[n]&&(e[n]=r)}(this,e)}getTelemetryProperties(){const e={};for(const t of Object.keys(this)){if(this.omitPropsFromLogging.has(t))continue;const n=this[t];e[t]=(0,i.fV)(n)}return{...e,stack:this.stack,message:this.message,errorInstanceId:this._errorInstanceId}}}const b="genericError";class S extends y{constructor(e){super(e.message),this.errorType=b,void 0!==e.stack&&g(this,e.stack)}}},1914:(e,t,n)=>{"use strict";n.d(t,{o:()=>o});var r=n(836);class o extends r.X{constructor(e){super(),this.errorHandler=e}emit(e,...t){try{return super.emit(e,...t)}catch(t){return this.errorHandler(e,t),!0}}}},409:(e,t,n)=>{"use strict";n.d(t,{Tg:()=>r,aX:()=>s,uk:()=>i});const r="connected",o="disconnected";function i(e,t,n,...r){try{e.emit(n,...r)}catch(e){t.sendErrorEvent({eventName:"RaiseEventError",event:n},e)}}function s(e,t,n,i,s){try{n?t.emit(r,i):t.emit(o,s)}catch(t){e.sendErrorEvent({eventName:"RaiseConnectedEventError"},t)}}},8036:(e,t,n)=>{"use strict";n.d(t,{X:()=>i,f:()=>o});const r=e=>"function"==typeof e?.getTelemetryProperties&&"function"==typeof e?.addTelemetryProperties,o=e=>"string"==typeof e?.errorInstanceId;function i(e){return"string"==typeof e?.errorType&&"string"==typeof e?.message&&o(e)&&r(e)}},5799:(e,t,n)=>{"use strict";n.d(t,{Bt:()=>v,Df:()=>S,Hf:()=>d,T0:()=>u,Z:()=>g,ZK:()=>l,fV:()=>y,mc:()=>r,pW:()=>h});var r,o=n(9873),i=n(6265),s=n(9461),a=n(2632),c=n(9307);function l(e){if(null==e)return;const t=Number(e);return Number.isNaN(t)?e:t}function u(e){return Math.floor(e)}!function(e){e.CodeArtifact="CodeArtifact",e.UserData="UserData"}(r||(r={}));const d=":";class p{static sanitizePkgName(e){return e.replace("@","").replace("/","-")}static prepareErrorObject(e,t,n){const{message:r,errorType:o,stack:i}=(0,a.AV)(t,!0);if(e.stack=i,e.error=r,e.errorType=o,(0,a.dy)(t)){const n=t.getTelemetryProperties();for(const t of Object.keys(n))void 0===e[t]&&(e[t]=n[t])}void 0===e.stack&&n&&(e.stack=(0,a.aX)())}constructor(e,t){this.namespace=e,this.properties=t}sendTelemetryEvent(e,t,n=i.$.default){this.sendTelemetryEventCore({...e,category:e.category??"generic"},t,"error"===e.category?i.$.error:n)}sendTelemetryEventCore(e,t,n){const r=function({category:e,eventName:t,...n}){const r={category:e,eventName:t};for(const e of Object.keys(n))r[e]=y(n[e]);return r}(e);void 0!==t&&p.prepareErrorObject(r,t,!1),"number"==typeof r.duration&&(r.duration=u(r.duration)),this.send(r,n)}sendErrorEvent(e,t){this.sendTelemetryEventCore({error:e.eventName,...e,category:"error"},t,i.$.error)}sendPerformanceEvent(e,t,n=i.$.default){const r={...e,category:e.category??"performance"};this.sendTelemetryEventCore(r,t,"error"===r.category?i.$.error:n)}prepareEvent(e){const t="error"===e.category||void 0!==e.error,n={...e};return void 0!==this.namespace&&(n.eventName=`${this.namespace}${p.eventNamespaceSeparator}${n.eventName}`),this.extendProperties(n,t)}extendProperties(e,t){const n=e;if(this.properties){const e=[];e.push(this.properties.all),t&&e.push(this.properties.error);for(const t of e)if(void 0!==t)for(const[e,r]of Object.entries(t)){if(void 0!==n[e])continue;const t="function"==typeof r?r():r;void 0!==t&&(n[e]=t)}}return e}}p.eventNamespaceSeparator=d;function h(e){return f.create(e?.logger,e?.namespace,e?.properties)}class f extends p{static create(e,t,n){if(e instanceof f){const r={};for(const t of[e.properties,n])void 0!==t&&(void 0!==t.all&&(r.all={...r.all,...t.all}),void 0!==t.error&&(r.error={...r.error,...t.error}));const o=void 0===e.namespace?t:void 0===t?e.namespace:`${e.namespace}${p.eventNamespaceSeparator}${t}`,i=new f(e.baseLogger,o,r);return!(0,s.uz)(i)&&(0,s.uz)(e)&&(0,s.fG)(i,e.config),i}return new f(e??{send(){}},t,n)}constructor(e,t,n){super(t,n),this.baseLogger=e,(0,s.uz)(e)&&(0,s.fG)(this,new s.G0(this,e.config))}get minLogLevel(){return this.baseLogger.minLogLevel}shouldFilterOutEvent(e,t){return(t??i.$.default)<(this.baseLogger.minLogLevel??i.$.default)}send(e,t){this.shouldFilterOutEvent(e,t)||this.baseLogger.send(this.prepareEvent(e),t)}}function g(e){return new m(e.namespace,e.properties,e.loggers?.filter((e=>void 0!==e)),e.tryInheritProperties)}class m extends p{constructor(e,t,n=[],r){let o=void 0===t?void 0:{...t};if(!0===r){const e=o??={};n.filter((e=>e instanceof p)).map((e=>e.properties??{})).forEach((t=>{Object.keys(t).forEach((n=>{e[n]={...t[n],...e?.[n]}}))}))}super(e,o),this.loggers=n,this._minLogLevelOfAllLoggers=i.$.default,this.calculateMinLogLevel()}get minLogLevel(){return this._minLogLevelOfAllLoggers}calculateMinLogLevel(){if(this.loggers.length>0){const e=[];for(const t of this.loggers)e.push(t.minLogLevel??i.$.default);this._minLogLevelOfAllLoggers=Math.min(...e)}}addLogger(e){null!=e&&(this.loggers.push(e),this.calculateMinLogLevel())}send(e){const t=this.prepareEvent(e);for(const e of this.loggers)e.send(t)}}class v{static start(e,t,n,r=!0){return new v(e,t,n,r)}static timedExec(e,t,n,r,o=1){const i=v.start(e,t,r,v.shouldReport(t,o));try{const e=n(i);return i.autoEnd(),e}catch(e){throw i.cancel(void 0,e),e}}static async timedExecAsync(e,t,n,r,o=1){const i=v.start(e,t,r,v.shouldReport(t,o));try{const e=await n(i);return i.autoEnd(),e}catch(e){throw i.cancel(void 0,e),e}}get duration(){return(0,o.l)()-this.startTime}constructor(e,t,n={end:!0,cancel:"generic"},r=!0){this.logger=e,this.markers=n,this.emitLogs=r,this.startTime=(0,o.l)(),this.event={...t},this.markers.start&&this.reportEvent("start"),"object"==typeof window&&void 0!==window?.performance?.mark&&null!==window?.performance?.mark&&(this.startMark=`${t.eventName}-start`,window.performance.mark(this.startMark))}reportProgress(e,t="update"){this.reportEvent(t,e)}autoEnd(){this.event&&this.markers.end&&this.reportEvent("end"),this.performanceEndMark(),this.event=void 0}end(e){this.reportEvent("end",e),this.performanceEndMark(),this.event=void 0}performanceEndMark(){if(void 0!==this.startMark&&this.event){const e=`${this.event.eventName}-end`;window.performance.mark(e),window.performance.measure(`${this.event.eventName}`,this.startMark,e),this.startMark=void 0}}cancel(e,t){void 0!==this.markers.cancel&&this.reportEvent("cancel",{category:this.markers.cancel,...e},t),this.event=void 0}reportEvent(e,t,n){if(!this.event)return;if(!this.emitLogs)return;const r={...this.event,...t};r.eventName=`${r.eventName}_${e}`,"start"!==e&&(r.duration=this.duration),this.logger.sendPerformanceEvent(r,n)}static shouldReport(e,t){const n=`.${e.category}.${e.eventName}`,r=v.eventHits.get(n)??0;return v.eventHits.set(n,r>=t?1:r+1),r%t==0}}function y(e){return(0,a.qp)(e)?{value:b(e.value),tag:e.tag}:b(e)}function b(e){switch(typeof e){case"string":case"number":case"boolean":case"undefined":return e;case"object":return JSON.stringify(e);default:return c.error(`convertToBasePropertyTypeUntagged: INVALID PROPERTY (typed as ${typeof e})`),`INVALID PROPERTY (typed as ${typeof e})`}}v.eventHits=new Map;const S=e=>((e,t)=>Object.entries(t).filter((e=>void 0!==e[1])).reduce(((t,n)=>{const[r,o]=n;return t[r]="function"==typeof o?()=>({tag:e,value:o()}):{tag:e,value:o},t}),{}))(r.CodeArtifact,e)},2065:(e,t,n)=>{"use strict";n.d(t,{C6:()=>o,Cl:()=>i});var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)};Object.create;Object.create;"function"==typeof SuppressedError&&SuppressedError},7783:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});const r={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let o;const i=new Uint8Array(16);const s=[];for(let e=0;e<256;++e)s.push((e+256).toString(16).slice(1));function a(e,t=0){return(s[e[t+0]]+s[e[t+1]]+s[e[t+2]]+s[e[t+3]]+"-"+s[e[t+4]]+s[e[t+5]]+"-"+s[e[t+6]]+s[e[t+7]]+"-"+s[e[t+8]]+s[e[t+9]]+"-"+s[e[t+10]]+s[e[t+11]]+s[e[t+12]]+s[e[t+13]]+s[e[t+14]]+s[e[t+15]]).toLowerCase()}const c=function(e,t,n){if(r.randomUUID&&!t&&!e)return r.randomUUID();const s=(e=e||{}).random??e.rng?.()??function(){if(!o){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");o=crypto.getRandomValues.bind(crypto)}return o(i)}();if(s.length<16)throw new Error("Random bytes length must be >= 16");if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){if((n=n||0)<0||n+16>t.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[n+e]=s[e];return t}return a(s)}}},i={};function s(e){var t=i[e];if(void 0!==t)return t.exports;var n=i[e]={exports:{}};return o[e](n,n.exports,s),n.exports}s.m=o,s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,s.t=function(n,r){if(1&r&&(n=this(n)),8&r)return n;if("object"==typeof n&&n){if(4&r&&n.__esModule)return n;if(16&r&&"function"==typeof n.then)return n}var o=Object.create(null);s.r(o);var i={};e=e||[null,t({}),t([]),t(t)];for(var a=2&r&&n;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((e=>i[e]=()=>n[e]));return i.default=()=>n,s.d(o,i),o},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,n)=>(s.f[n](e,t),t)),[])),s.u=e=>({160:"FluidDocumentServiceFactoryContainer",482:"FluidFramework-HashFallback",634:"MockComponent",873:"officeFluidOneDsSink",941:"AshaUtils"}[e]+".js"),s.miniCssF=e=>{},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n={},r="TypeScriptModule:",s.l=(e,t,o,i)=>{if(n[e])n[e].push(t);else{var a,c;if(void 0!==o)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var d=l[u];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==r+o){a=d;break}}a||(c=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.setAttribute("data-webpack",r+o),a.src=e),n[e]=[t];var p=(t,r)=>{a.onerror=a.onload=null,clearTimeout(h);var o=n[e];if(delete n[e],a.parentNode&&a.parentNode.removeChild(a),o&&o.forEach((e=>e(r))),t)return t(r)},h=setTimeout(p.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=p.bind(null,a.onerror),a.onload=p.bind(null,a.onload),c&&document.head.appendChild(a)}},s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=n[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),(()=>{var e={57:0};s.f.j=(t,n)=>{var r=s.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var o=new Promise(((n,o)=>r=e[t]=[n,o]));n.push(r[2]=o);var i=s.p+s.u(t),a=new Error;s.l(i,(n=>{if(s.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var o=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+o+": "+i+")",a.name="ChunkLoadError",a.type=o,a.request=i,r[1](a)}}),"chunk-"+t,t)}};var t=(t,n)=>{var r,o,[i,a,c]=n,l=0;if(i.some((t=>0!==e[t]))){for(r in a)s.o(a,r)&&(s.m[r]=a[r]);if(c)c(s)}for(t&&t(n);l<i.length;l++)o=i[l],s.o(e,o)&&e[o]&&e[o][0](),e[o]=0},n=self.webpackChunkTypeScriptModule=self.webpackChunkTypeScriptModule||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var a={};(()=>{"use strict";s.r(a),s.d(a,{CLOUD_TYPE_TO_ONENOTEJS:()=>Xd});var e=s(7011),t=s.t(e,2),n=s(5561);const r={afZa:"af-za",amEt:"am-et",arSa:"ar-sa",asIn:"as-in",azLatnAz:"az-latn-az",bgBg:"bg-bg",bnIn:"bn-in",bsLatnBa:"bs-latn-ba",caEs:"ca-es",caEsValencia:"ca-es-valencia",csCz:"cs-cz",cyGb:"cy-gb",daDk:"da-dk",deDe:"de-de",elGr:"el-gr",enGb:"en-gb",enUs:"en-us",esEs:"es-es",esMx:"es-mx",etEe:"et-ee",euEs:"eu-es",faIr:"fa-ir",fiFi:"fi-fi",filPh:"fil-ph",frCa:"fr-ca",frFr:"fr-fr",gaIe:"ga-ie",gdGb:"gd-gb",glEs:"gl-es",guIn:"gu-in",heIl:"he-il",hiIn:"hi-in",hrHr:"hr-hr",huHu:"hu-hu",hyAm:"hy-am",idId:"id-id",isIs:"is-is",itIt:"it-it",jaJp:"ja-jp",kaGe:"ka-ge",kkKz:"kk-kz",kmKh:"km-kh",knIn:"kn-in",kokIn:"kok-in",koKr:"ko-kr",lbLu:"lb-lu",loLa:"lo-la",ltLt:"lt-lt",lvLv:"lv-lv",miNz:"mi-nz",mkMk:"mk-mk",mlIn:"ml-in",mrIn:"mr-in",msMy:"ms-my",mtMt:"mt-mt",nbNo:"nb-no",neNp:"ne-np",nlNl:"nl-nl",nnNo:"nn-no",orIn:"or-in",paIn:"pa-in",plPl:"pl-pl",ptBr:"pt-br",ptPt:"pt-pt",quzPe:"quz-pe",roRo:"ro-ro",ruRu:"ru-ru",skSk:"sk-sk",slSi:"sl-si",sqAl:"sq-al",srCyrlBa:"sr-cyrl-ba",srCyrlRs:"sr-cyrl-rs",srLatnRs:"sr-latn-rs",svSe:"sv-se",taIn:"ta-in",teIn:"te-in",thTh:"th-th",trTr:"tr-tr",ttRu:"tt-ru",ugCn:"ug-cn",ukUa:"uk-ua",urPk:"ur-pk",viVn:"vi-vn",zhCn:"zh-cn",zhTw:"zh-tw"},o={af:r.afZa,am:r.amEt,ar:r.arSa,as:r.asIn,az:r.azLatnAz,bg:r.bgBg,bn:r.enGb,bs:r.bsLatnBa,"bs-cyrl-ba":r.enGb,ca:r.caEs,cs:r.csCz,cy:r.cyGb,da:r.daDk,de:r.deDe,el:r.elGr,"el-cy":r.enGb,en:r.enUs,es:r.esEs,et:r.etEe,eu:r.euEs,fa:r.faIr,fi:r.fiFi,fil:r.filPh,fr:r.frFr,ga:r.gaIe,gd:r.gdGb,gl:r.glEs,gu:r.guIn,he:r.heIl,hi:r.hiIn,hr:r.hrHr,hu:r.huHu,hy:r.hyAm,id:r.idId,is:r.isIs,it:r.itIt,iw:r.heIl,"iw-il":r.heIl,ja:r.jaJp,ka:r.kaGe,kk:r.kkKz,km:r.kmKh,kn:r.knIn,ko:r.koKr,kok:r.kokIn,lb:r.lbLu,lo:r.loLa,lt:r.ltLt,lv:r.lvLv,mi:r.miNz,mk:r.mkMk,ml:r.mlIn,mr:r.mrIn,ms:r.msMy,mt:r.mtMt,nb:r.nbNo,ne:r.neNp,nl:r.nlNl,nn:r.nnNo,or:r.orIn,pa:r.paIn,pl:r.plPl,pt:r.ptBr,quz:r.quzPe,ro:r.roRo,ru:r.ruRu,sk:r.skSk,sl:r.slSi,sq:r.sqAl,sv:r.svSe,ta:r.taIn,te:r.teIn,th:r.thTh,tr:r.trTr,"tr-cy":r.enGb,tt:r.ttRu,ug:r.ugCn,uk:r.ukUa,ur:r.urPk,uz:r.enUs,vi:r.viVn,zh:r.enUs,"zh-hans-tw":r.zhTw},i=r.enUs,c=/^([^-]+)-.+/;function l(e){if(null==e)return i;const t=e.toLowerCase();if(Object.values(r).includes(t))return t;const n=o[t];if(void 0!==n)return n;const s=function(e){const t=c.exec(e.trim().toLowerCase());if(null!==t&&t.length>1)return t[1];return}(t);if(void 0!==s){const e=o[s];if(void 0!==e)return e}return i}class u extends Error{constructor(e,t){super(t),this.hresult=e,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype)}get errorCode(){return this.hresult}}u.E_FAIL=2147500037;class d extends u{constructor(e){super(d.E_NOTIMPL,e)}}d.E_NOTIMPL=2147500033;class p extends u{constructor(e){super(p.E_INVALIDARG,e)}}p.E_INVALIDARG=2147942487;var h=s(2065),f=s(5738),g=s(5927),m=s(8170),v=function(){return 1e3*Date.now()};"object"==typeof window&&"object"==typeof window.performance&&"now"in window.performance&&(v=function(){return 1e3*Math.floor(window.performance.now())});var y,b=function(e){var t,n=v(),r=(0,f.EY)(e.telemetryEvent);return(0,h.Cl)((0,h.Cl)({cv:e.parentCv.getNext()},r),{createChildActivity:function(t){return b({telemetryEvent:t,sendTelemetryEvent:e.sendTelemetryEvent,parentCv:this.cv})},setResult:function(e,t,n){this.result={code:e,type:t,tag:n}},endNow:function(){var r,o,i=this;if(!t){void 0===this.success&&void 0===this.result&&(0,m.wC)(1,0,(function(){return"Activity does not have success or result set"}));var s=v();t=!0;var a={duration:s-n,count:1,aggMode:0,cV:this.cv.value,success:this.success,result:this.result},c=null!==(o=null===(r=this.eventContract)||void 0===r?void 0:r.dataFields)&&void 0!==o?o:[];return c.push.apply(c,g.Il.getFields(a)),this.eventContract={name:g.Il.contractName,dataFields:c},e.sendTelemetryEvent(this)}(0,m.wC)(0,0,(function(){return"'".concat(i.eventName,"' already ended")}))}})},S=s(488),w=function(e){var t="Error",n=[];return n.push((0,S.m9)("".concat(t,".ErrorGroup"),e.errorGroup)),n.push((0,S.Ug)("".concat(t,".Tag"),e.tag)),void 0!==e.code&&n.push((0,S.Ug)("".concat(t,".Code"),e.code)),void 0!==e.id&&n.push((0,S.Ug)("".concat(t,".Id"),e.id)),void 0!==e.count&&n.push((0,S.Ug)("".concat(t,".Count"),e.count)),n},C=function(){function e(e){this.value=e,this.nextChild=0}return e.prototype.getNext=function(){return new e("".concat(this.value,".").concat(++this.nextChild))},e}();var E,k=function(e){function t(t,n,r){var o=e.call(this,t,n,r)||this;return o.baseCv=function(){if(!y){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=[],n=0;n<22;n++)t.push(e.charAt(Math.floor(64*Math.random())));y=new C(t.join(""))}return y}(),o}return(0,h.C6)(t,e),t.prototype.createActivity=function(e){return b({sendTelemetryEvent:this.sendTelemetryEvent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t.prototype.sendActivity=function(e,t,n,r){return this.sendTelemetryEvent({eventName:e,eventContract:{name:g.Il.contractName,dataFields:g.Il.getFields(t)},dataFields:n,eventFlags:r})},t.prototype.sendError=function(e){var t=w(e.error);return null!=e.dataFields&&t.push.apply(t,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:t,eventFlags:e.eventFlags})},t.prototype.createCustomerContentActivity=function(e){return b({sendTelemetryEvent:this.sendCustomerContent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t}(f.GV);!function(e){e.DataClassification={EssentialServiceMetadata:1,AccountData:2,SystemMetadata:4,OrganizationIdentifiableInformation:8,EndUserIdentifiableInformation:16,CustomerContent:32,AccessControl:64,PublicNonPersonalData:128,EndUserPseudonymousInformation:256,PublicPersonalData:512,SupportData:1024,DirectMeasurementData:2048,Everything:65535},e.DataFieldType={String:0,Boolean:1,Int64:2,Double:3,Guid:4},e.SamplingPolicy={NotSet:0,Measure:1,Diagnostics:2,CriticalBusinessImpact:191,CriticalCensus:192,CriticalExperimentation:193,CriticalUsage:194},e.PersistencePriority={NotSet:0,Normal:1,High:2},e.CostPriority={NotSet:0,Normal:1,High:2},e.DataCategories={NotSet:0,SoftwareSetup:1,ProductServiceUsage:2,ProductServicePerformance:4,DeviceConfiguration:8,InkingTypingSpeech:16},e.DiagnosticLevel={ReservedDoNotUse:0,Required:10,BasicEvent:10,Optional:100,FullEvent:100,RequiredServiceData:110,NecessaryServiceDataEvent:110,RequiredServiceDataForEssentialServices:120,AlwaysOnNecessaryServiceDataEvent:120},e.DnmInterval={Hourly:1,Daily:2},e.AllowedPartA={ReleaseAudienceGroup:1,WacRing:2,AppName:3,AppPlatform:4,AppVersion:5},e.CustomerContentType={None:0,MocaAddIn:1},e.LogLevel={Error:0,Warning:1,Info:2,Verbose:3},e.Category={Core:0,Sink:1,Transport:2},e.PrimaryIdentitySpace={UserObjectId:"UserObjectId",MSACID:"MSACID",OrgIdPuid:"OrgIdPuid",OrgIdPUID:"OrgIdPUID",OrgIdCID:"OrgIdCID",MsaPuid:"MsaPuid",MSAPUID:"MSAPUID",WopiAuth:"WopiAuth",ThirdParty:"ThirdParty",Other:"Other"},e.AudienceGroup={Automation:"Automation",Dogfood:"Dogfood",Microsoft:"Microsoft",Insiders:"Insiders",Production:"Production"}}(E||(E={}));const{DataCategories:P,DiagnosticLevel:T}=E,N={dataCategories:P.ProductServiceUsage,diagnosticLevel:T.Optional},A={...{GetBizChatToken:N,InitialBizChatTokenAcquired:N,InitialTokenAcquired:N},...{ApiBridgeError:N,AuthError:N,AppInitError:N,BizChatAuthError:N,CdnCodeLoaderPreCacheError:N,ComponentDataWorkspaceListChangedEventError:N,ComponentNavigationEventError:N,DataActionError:N,M365ChatSettingsProviderError:N,FeatureGatesError:N,NativeEventHandlerError:N,NavigateToLinkError:N,NavigateToSearchResultError:N,NotifyClientError:N,UnhandledConfigError:N,UserEligibilityServiceError:N,WorkspaceManagerError:N},...{GetLoopView:N,LoadLoopComponent:N,LoadLoopWorkspaceComponent:N,LoadLoopWorkspaceEndToEnd:N,PreCacheCodeLoader:N,RenderLoopComponent:N},...{GetAllCachedEcsResponses:N,M365ECSChatVersion:N,PopulateUserEligibilityInformation:N,UserEligibilityServiceAPICall:N},...{NavigateTo:N,NavigateToLink:N,NavigateToSearchResult:N},...{GetRecentPages:N,GetWorkspaceForPage:N,GetWorkspaces:N}};var I;!function(e){e.Error="Error",e.Latency="Latency",e.Warning="Warning",e.Info="Info"}(I||(I={}));var O=s(9307);const L={example:"Microsoft.Office.OneNote.fa000000174.example",useShadowCopilotNotebookOption:"Microsoft.Office.OneNote.fa000000174.ShadowCopilotNotebookOption",useL2NavRefresh:"Microsoft.Office.OneNote.fa000000174.useL2NavRefresh",useUserAppEligibilities:"Microsoft.Office.OneNote.fa000000174.UseUserAppEligibilities",useOneNoteUrlHandlerProvider:"Microsoft.Office.OneNote.fa000000174.UseOneNoteUrlHandlerProvider",useOneNoteBrandColorTheming:"Microsoft.Office.OneNote.fa000000174.UseOneNoteBrandColorTheming"},D={skipLoadDataModelsOnInit:"Microsoft.Office.OneNote.fa000000174.SkipLoadDataModelsOnInit",useM365ChatSettingsProvider:"Microsoft.Office.OneNote.fa000000174.UseM365ChatSettingsProvider",useOfficeTelemetrySinkBatching:"Microsoft.Office.OneNote.fa000000174.UseOfficeTelemetrySinkBatching",useBypassNavigation:"Microsoft.Office.OneNote.fa000000174.UseBypassNavigation"},R=(e,t)=>{try{const n=L[e];return OfficeRuntime.experimentation.getBooleanFeatureGate(n,t)}catch(e){return x.Instance.logError("FeatureGatesError",e,{ErrorMethod:"getBooleanFeatureGate"}),O.error("Error getting feature gate",e),t}},F=e=>{try{return OfficeRuntime.experimentation.getBooleanFeatureGate(D[e],!0)}catch(e){return x.Instance.logError("FeatureGatesError",e,{ErrorMethod:"getBooleanChangeGate"}),O.error("Error getting change gate",e),!0}};class M{constructor(){this._telemetryQueue=[],this._processingQueue=!1}static get Instance(){return M._instance||(M._instance=new M),M._instance}sendTelemetryEvent(e,t){F("useOfficeTelemetrySinkBatching")?(this._telemetryQueue.push({FilledTelemetryEvent:e,timestamp:t}),this._processingQueue||this._startProcessingQueueTimer||(this._startProcessingQueueTimer=setTimeout((()=>{this._processingQueue=!0,this._startProcessingQueueTimer=void 0,this.processQueue()}),M.PROCESSING_QUEUE_INTERVAL))):Office.telemetrySink.sendTelemetryEvent(e,t)}sendCustomerContent(e){Office.telemetrySink.sendCustomerContent(e)}sendNonStandardEvent(e,t){Office.telemetrySink.sendNonStandardEvent(e,t)}async processQueue(){for(;this._telemetryQueue.length>0;){for(let e=0;e<M.MAX_EVENTS_PER_INTERVAL;e++){const e=this._telemetryQueue.shift();e&&Office.telemetrySink.sendTelemetryEvent(e.FilledTelemetryEvent,e.timestamp)}this._telemetryQueue.length>0&&await new Promise((e=>setTimeout(e,M.PROCESSING_QUEUE_INTERVAL)))}this._processingQueue=!1}}M.PROCESSING_QUEUE_INTERVAL=1e3,M.MAX_EVENTS_PER_INTERVAL=5;class x{constructor(){const e=x.AriaTenantToken,t=x.NexusTenantToken,n=x.Namespace;this.oTelLogger=new k,this.namespace=n,this.oTelLogger.setTenantToken(`${n}`,e,t),this.oTelLogger.addSink(M.Instance)}static get Instance(){return x.telemetryLogger||(x.telemetryLogger=new x),x.telemetryLogger}logEvent(e,t){const n=A[e],r={eventName:`${this.namespace}.${e}`,eventFlags:n,dataFields:x.getDataFields(t)};this.oTelLogger.sendTelemetryEvent(r)}logError(e,t,n){const r=A[e],o=[...x.getErrorDataFields(t),...x.getDataFields(n)],i={eventName:`${this.namespace}.${e}`,error:{errorGroup:I.Error,tag:0},eventFlags:r,dataFields:o};this.oTelLogger.sendError(i)}static getDataFields(e){return e?Object.keys(null!=e?e:{}).map((t=>{const n=e[t];switch(typeof n){case"number":return S.ip(t,n);case"string":default:return S.m9(t,n);case"boolean":return S.LK(t,n)}})):[]}static getErrorDataFields(e){if("object"!=typeof e||!e)return[];const t=[];return!("code"in e)||"string"!=typeof e.code&&"number"!=typeof e.code||t.push(S.m9("ErrorCode",`${e.code}`)),"message"in e&&"string"==typeof e.message&&t.push(S.m9("ErrorMessage",e.message)),t}}x.AriaTenantToken="3de38b41008a4da5a5381ef307f91597-636c040a-3c10-4912-9e28-de026a94600f-6848",x.NexusTenantToken=1718,x.Namespace="Office.OneNote.SDX.Integrations.HostedWorkspaces";class _{static withResolvers(){const e=Promise;if("function"==typeof e.withResolvers)return e.withResolvers();{let e=()=>{},t=()=>{};return{promise:new Promise(((n,r)=>{e=n,t=r})),resolve:e,reject:t}}}}class U{constructor(){this.defers={},this.results={},this.eventHandlers=[],this.initialized=!1}async initialize(){var e;if(!this.initialized&&(this.initialized=!0,window.OfficeFirstParty&&(null===(e=OfficeFirstParty.PrivateApi)||void 0===e?void 0:e.onPrivateEvent))){const e=this.onNativeEvent.bind(this);try{const t=await OfficeFirstParty.PrivateApi.onPrivateEvent(e);this.eventRevoker=t}catch(e){this.eventRevoker=void 0}}}cleanup(){this.eventRevoker&&this.eventRevoker(),this.eventRevoker=void 0}registerEvent(e){this.eventHandlers.push(e)}unregisterEvent(e){const t=this.eventHandlers.indexOf(e);t>=0&&this.eventHandlers.splice(t,1)}onNativeEvent(e){const t=JSON.parse(e);if("AsyncApiResult"===t.__type){const{__type:e,__apiId:n,__error:r,...o}=t;if(n in this.defers){const e=this.defers[n];if(delete this.defers[n],0!==r){const t=U.createErrorObject(e.api,r);e.reject(t)}else e.resolve(o)}else this.results[n]=t}else if("Event"===t.__type){const{__type:e,__eventName:n,...r}=t;for(const e of this.eventHandlers)e(n,r)}}execute(e,t){var n;if(!window.OfficeFirstParty||!(null===(n=OfficeFirstParty.PrivateApi)||void 0===n?void 0:n.execute))return Promise.reject(new u(u.E_FAIL,"PrivateApi is not available"));const r=Object.assign({__api:e},t),o=JSON.stringify(r);return OfficeFirstParty.PrivateApi.execute(o).then((t=>{const n=JSON.parse(t),{__error:r,__async:o,...i}=n;if(0!==r){const t=U.createErrorObject(e,r);throw x.Instance.logError("ApiBridgeError",r,{ErrorMethod:e,ErrorDetails:t.message,ErrorCode:t.errorCode,ErrorName:t.name}),t}if("string"!=typeof o)return i;if(o in this.results){const{__type:t,__apiId:n,__error:r,...i}=this.results[o];if(delete this.results[o],0!==r){throw U.createErrorObject(e,r)}return i}{const{promise:t,resolve:n,reject:r}=_.withResolvers();return this.defers[o]={api:e,resolve:n,reject:r},t}}))}static createErrorObject(e,t){const n=t>>>0;switch(n){case d.E_NOTIMPL:return new d(`The private API '${e}' is not implemented`);case p.E_INVALIDARG:return new p(`Invalid arguments are passed to the private API '${e}'`);default:return new u(t,`Calling private API '${e}' gives error code: ${t} | ${n} (converted error code)`)}}}var j=s(9307);const z=new U;class q{static failedToNavigateToSearchResult(e){return j.log("ApiBridge: SendToNative: Navigate Search Result Failed:",e),z.execute("notifyNavigateToSearchResultFailed",e)}static failedToNavigateToLink(e){return j.log("ApiBridge: SendToNative: Navigate Link Failed:",e),z.execute("notifyNavigateToLinkFailed",e)}static navigateToLinkStatus(e){return j.log("ApiBridge: SendToNative: Navigate Link Status:",e),z.execute("notifyNavigateToLinkStatus",e)}static navigateToHomeEvent(){return j.log("ApiBridge: SendToNative: Home Navigate"),z.execute("navigateToHome")}static navigateToNotebookEvent(e){return j.log("ApiBridge: SendToNative: Notebook Navigate:",e),z.execute("navigateToNotebook",e)}static navigateToCreateNotebookEvent(e){return j.log("ApiBridge: SendToNative: Notebook Create:",e),z.execute("navigateToCreateNotebook",e)}static navigateToPageEvent(e){return j.log("ApiBridge: SendToNative: Page Navigate:",e),z.execute("navigateToPage",e)}static navigateToResourceLinkInClientEvent(e){return j.log("ApiBridge: SendToNative: Resource Link Navigate:",e),z.execute("notifyNavigateToResourceLinkInClient",e)}static navigateToSearchResultStatus(e){return j.log("ApiBridge: SendToNative: Navigate Search Result Status:",e),z.execute("notifyNavigateToSearchResultStatus",e)}static renderCompleteEvent(){return j.log("ApiBridge: SendToNative: Render Complete"),z.execute("renderComplete")}static reloadSDX(){return j.log("ApiBridge: SendToNative: Reload SDX"),z.execute("reloadSDX")}static addReferenceToNotebookResultStatus(e){return j.log("ApiBridge: SendToNative: Add Reference to Notebook Result Status:",e),z.execute("notifyAddReferenceToNotebookResultStatus",e)}}class B{static removeWorkspace(e){return j.log("ApiBridge: SendToNative: Remove Workspace:",e),z.execute("removeWorkspace",e)}static renameWorkspace(e){return j.log("ApiBridge: SendToNative: Rename Workspace:",e),z.execute("renameWorkspace",e)}static setWorkspaces(e){return j.log("ApiBridge: SendToNative: Setting Workspaces:",e),z.execute("setWorkspaces",e)}static updateWorkspace(e){return j.log("ApiBridge: SendToNative: Update Workspace:",e),z.execute("updateWorkspace",e)}static failedToProcessWorkspaces(){return j.log("ApiBridge: SendToNative: Process Workspaces Failed"),z.execute("notifyProcessWorkspacesFailed")}static getActiveUserIdentity(){return j.log("ApiBridge: SendToNative: Get Active User Identity"),z.execute("getActiveIdentity")}}var $=s(9307);const H={"https://fa000000174.resources.office.net":"Public","https://fa000000174.mro1cdnstorage.public.onecdn.static.microsoft":"Public1CDN","https://fa000000174.mro1cdnstorage.gcc.cdn.office.net":"GCCM","https://fa000000174.mro1cdnstorage.gcch.cdn.office.net":"GCCH","https://fa000000174.mro1cdnstorage.dod.cdn.office.net":"DoD","https://fa000000174.mro1cdnstorage.1cdn.eaglex.ic.gov":"UsNat","https://fa000000174.mro1cdnstorage.1cdn.microsoft.scloud":"UsSec","https://fa000000174.mro1cdnstorage.cdn.partner.office365.cn":"Gallatin","https://fa000000174.mro1cdnstorage.fr.cdn.office.net":"Bleu"};let W;function G(){return W||(W=function(){try{const e=new URL(window.location.href).origin.toLowerCase(),t=H[e];if(!t)throw $.error("Failed to map cloud type for origin:",e),new Error("Failed to map origin URL to cloud type");return $.log("Detected mapped cloud type:",t,e),t}catch(e){return x.Instance.logError("UnhandledConfigError",e,{ErrorMethod:"detectCloudType",ConfigDataValue:"",ConfigDataExpectedType:"OriginURL"}),$.error("Error detecting cloud type from origin URL - defaulting to UNKNOWN cloud:",e),"UNKNOWN"}}()),W}const V={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let Q;const J=new Uint8Array(16);function K(){if(!Q){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Q=crypto.getRandomValues.bind(crypto)}return Q(J)}const Y=[];for(let e=0;e<256;++e)Y.push((e+256).toString(16).slice(1));function X(e,t=0){return(Y[e[t+0]]+Y[e[t+1]]+Y[e[t+2]]+Y[e[t+3]]+"-"+Y[e[t+4]]+Y[e[t+5]]+"-"+Y[e[t+6]]+Y[e[t+7]]+"-"+Y[e[t+8]]+Y[e[t+9]]+"-"+Y[e[t+10]]+Y[e[t+11]]+Y[e[t+12]]+Y[e[t+13]]+Y[e[t+14]]+Y[e[t+15]]).toLowerCase()}const Z=function(e,t,n){if(V.randomUUID&&!t&&!e)return V.randomUUID();const r=(e=e||{}).random||(e.rng||K)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return X(r)},ee=e=>"object"==typeof e&&null!==e&&"message"in e&&"string"==typeof e.message,te=Object.freeze({AUGLOOP:"https://augloop.svc.sovcloud.fr/v2",ECS:"https://c2s.config.ecs.svc.sovcloud.fr",GRAPH:"https://graph.svc.sovcloud.fr",LOKI:"https://fxgateway.svc.sovcloud.fr",MRU:"https://recent.svc.sovcloud.fr",OUTLOOK:"https://outlook.svc.sovcloud.fr",SUBSTRATE:"https://substrate.svc.sovcloud.fr",SUBSTRATESEARCH:"https://substrate.svc.sovcloud.fr/search",SYDNEY:"https://substrate.svc.sovcloud.fr/sydney",TEAMS:"https://teams.sovcloud.fr",TENANTFEEDBACK:"https://substrate.svc.sovcloud.fr/tenantfeedback"}),ne=Object.freeze({}),re=Object.freeze({AEA:"https://outlook-dod.office365.us/connectors",APIHUB:"https://power-apis-usdod-001.azure-apihub.us",AUGLOOP:"https://augloop.dod.online.office365.us/v2",BAP:"https://api.bap.appsplatform.us",DESIGNERAPPSERVICE:"https://designerapp.osi.apps.mil",GRAPH:"https://dod-graph.microsoft.us",LOKI:"https://dod.loki.office365.us",M365PROD:"https://www.ohome.apps.mil",METAOS:"https://titles.dod.mos.svc.usgovcloud.microsoft",MRU:"https://ocws.osi.apps.mil",MRUPLUSPLUS:"https://api.osi.apps.mil",OCPS:"https://clients.config.dod.office365.us",OUTLOOK:"https://outlook-dod.office365.us",SAFELINKS:"https://usg01.safelinks.protection.office365.us",SAFELINKSLEGACY:"https://dataservice.protection.office365.us",SUBSTRATE:"https://substrate-dod.office365.us",SUBSTRATESEARCH:"https://substrate-dod.office365.us/search",SYDNEY:"https://substrate-dod.office365.us/sydney",TEAMS:"https://dod.teams.microsoft.us",TENANTFEEDBACK:"https://substrate-dod.office365.us/tenantfeedback"}),oe=Object.freeze({AEA:"https://outlook.office365.us/connectors",APIHUB:"https://power-apis-usgov001-sovereign.azure-apihub.us",AUGLOOP:"https://augloop.gov.online.office365.us/v2",BAP:"https://high.api.bap.microsoft.us",DESIGNERAPPSERVICE:"https://designerapp.gcc.osi.office365.us",GRAPH:"https://graph.microsoft.us",LOKI:"https://gcchigh.loki.office365.us",M365PROD:"https://www.office365.us",MRU:"https://ocws.osi.office365.us",MRUPLUSPLUS:"https://api.osi.office365.us",OCPS:"https://clients.config.high.office365.us",OUTLOOK:"https://outlook.office365.us",PPAPIPROD:"https://api.gov.powerplatform.microsoft.us",SAFELINKS:"https://usg02.safelinks.protection.office365.us",SAFELINKSLEGACY:"https://dataservice.protection.office365.us",SUBSTRATE:"https://substrate.office365.us",SUBSTRATESEARCH:"https://substrate.office365.us/search",SYDNEY:"https://substrate.office365.us/sydney",TEAMS:"https://gov.teams.microsoft.us",TENANTFEEDBACK:"https://substrate.office365.us/tenantfeedback"}),ie=Object.freeze({APIHUB:"https://power-apis-usgov001-public.azure-apihub.us",AUGLOOP:"https://augloop-gcc.office.com/v2",BAP:"https://gov.api.bap.microsoft.us",COPILOTSTUDIOPROD:"9315aedd-209b-43b3-b149-2abff6a95d59",DESIGNERAPPSERVICE:"https://designerapp.gcc.osi.office365.us",LOKI:"https://gcc.loki.delve.office.com",MRU:"https://ocws.officeapps.live.com",METAOS:"https://titles.gccm.mos.microsoft.com",OCPS:"https://clients.config.gcc.office.net",PPAPIPROD:"https://api.gov.powerplatform.microsoft.us",SAFELINKS:"https://gcc02.safelinks.protection.outlook.com"}),se=Object.freeze({AEA:"https://partner.outlook.cn/connectors",APIHUB:"https://china.azure-apihub.cn",GRAPH:"https://microsoftgraph.chinacloudapi.cn",LOKI:"https://loki.office365.cn",MRU:"https://ocws.officeapps.partner.office365.cn",MRUPLUSPLUS:"https://api.partner.office365.cn",OUTLOOK:"https://partner.outlook.cn",TEAMS:"https://teams.microsoftonline.cn",SUBSTRATE:"https://partner.outlook.cn",SUBSTRATESEARCH:"https://partner.outlook.cn/search",SYDNEY:"https://partner.outlook.cn/sydney",TENANTFEEDBACK:"https://partner.outlook.cn/tenantfeedback"}),ae=Object.freeze({AMS:"https://ic3-consumers.teams.office.com",MYODSP:"https://my.microsoftpersonalcontent.com",ODC:"OneDrive.ReadWrite",ODSP:"https://home.microsoftpersonalcontent.com",SYDNEY:"https://substrate.office.com/sydney/v2",SUBSTRATESEARCH:"https://substrate.office.com"}),ce=Object.freeze({AEA:"https://outlook.office365.com/connectors",AMS:"https://ic3.teams.office.com",APIHUB:"https://apihub.azure.com",AUGLOOP:"https://augloop.office.com/v2",BAP:"https://api.bap.microsoft.com",BINGANSWERS:"https://www.bing.com",DESIGNERAPPSERVICE:"https://designerapp.officeapps.live.com",COPILOTSTUDIOPROD:"96ff4394-9197-43aa-b393-6a41652e21f8",COPILOTSTUDIOTEST:"a522f059-bb65-47c0-8934-7db6e5286414",FLUIDPUSH:"https://pushchannel.1drv.ms",GCS:"https://gcs.office.com",GRAPH:"https://graph.microsoft.com",IRIS:"https://arc.msn.com/v4",LOKI:"https://loki.delve.office.com",M365PROD:"https://m365.cloud.microsoft",METAOS:"https://titles.prod.mos.microsoft.com",MRU:"https://ocws.officeapps.live.com",MRUDF:"https://ocws-df.officeapps.live.com",MRUPLUSPLUS:"https://api.office.net",ODSP:"https://home.microsoftpersonalcontent.com",OCPS:"https://clients.config.office.net",ONENOTE:"https://learningtools.onenote.com",OUTLOOK:"https://outlook.office365.com",PACMAN:"083b36c3-2702-4850-972a-42894c3c6437",POWERBI:"https://analysis.windows.net/powerbi/api",PPAPIPROD:"https://api.powerplatform.com",PPAPITEST:"https://api.test.powerplatform.com",PPAPIPREPROD:"https://api.preprod.powerplatform.com",POWERAUTOMATE:"https://service.flow.microsoft.com",SAFELINKS:"https://safelinks.protection.office365.com",SAFELINKSLEGACY:"https://dataservice.o365filtering.com",SHAREPOINT:"https://microsoft.sharepoint.com",SKYPE:"https://api.spaces.skype.com",SPAC:"00000003-0000-0ff1-ce00-000000000000",SUBSTRATE:"https://substrate.office.com",SUBSTRATESEARCH:"https://substrate.office.com/search",SYDNEY:"https://substrate.office.com/sydney",TEAMS:"https://teams.microsoft.com",TENANTFEEDBACK:"https://substrate.office.com/tenantfeedback",TROUTER:"a75e09c5-9ed5-4004-82d5-4a44c9fd7052",URLP:"https://urlp-v2.asm.skype.com",YAMMER:"https://www.yammer.com"}),le=Object.freeze({AEA:"https://outlook.exo.eaglex.ic.gov/connectors",AUGLOOP:"https://svc.augloop.eaglex.ic.gov/v2",GRAPH:"https://graph.eaglex.ic.gov",LOKI:"https://loki.officenet.eaglex.ic.gov",MRU:"https://ocws.osi.eaglex.ic.gov",OUTLOOK:"https://outlook.exo.eaglex.ic.gov",SUBSTRATE:"https://substrate.exo.eaglex.ic.gov",SUBSTRATESEARCH:"https://substrate.exo.eaglex.ic.gov/search",SYDNEY:"https://substrate.exo.eaglex.ic.gov/sydney",TENANTFEEDBACK:"https://substrate.exo.eaglex.ic.gov/tenantfeedback"}),ue=Object.freeze({AEA:"https://outlook.exo.microsoft.scloud/connectors",AUGLOOP:"https://svc.augloop.microsoft.scloud/v2",GRAPH:"https://graph.microsoft.scloud",LOKI:"https://loki.officenet.microsoft.scloud",MRU:"https://ocws.osi.microsoft.scloud",OUTLOOK:"https://outlook.exo.microsoft.scloud",SUBSTRATE:"https://substrate.exo.microsoft.scloud",SUBSTRATESEARCH:"https://substrate.exo.microsoft.scloud/search",SYDNEY:"https://substrate.exo.microsoft.scloud/sydney",TENANTFEEDBACK:"https://substrate.exo.microsoft.scloud/tenantfeedback"}),de={Public:ce,Public1CDN:ce,UNKNOWN:ce,GCCM:ie,GCCH:oe,DoD:re,UsSec:ue,UsNat:le,Bleu:te,Delos:ne,Gallatin:se},pe="c0ab8ce9-e9a0-42e7-b064-33d422df41f1";var he,fe=s(9307);!function(e){e[e.Unknown=0]="Unknown",e[e.LiveId=1]="LiveId",e[e.OrgId=2]="OrgId",e[e.ActiveDirectory=3]="ActiveDirectory",e[e.ADAL=4]="ADAL",e[e.SSPI=5]="SSPI"}(he||(he={}));const ge=new Map,me=new Map,ve=e=>void 0!==e&&e===he.LiveId,ye={Public:"brk-multihub://fa000000174.resources.office.net",Public1CDN:"brk-multihub://fa000000174.mro1cdnstorage.public.onecdn.static.microsoft",GCCM:"brk-multihub://fa000000174.mro1cdnstorage.gcc.cdn.office.net",GCCH:"brk-multihub://fa000000174.mro1cdnstorage.gcch.cdn.office.net",DoD:"brk-multihub://fa000000174.mro1cdnstorage.dod.cdn.office.net",UNKNOWN:"brk-multihub://fa000000174.mro1cdnstorage.public.onecdn.static.microsoft",UsNat:"https://fa000000174.mro1cdnstorage.1cdn.eaglex.ic.gov",UsSec:"https://fa000000174.mro1cdnstorage.1cdn.microsoft.scloud",Gallatin:"https://fa000000174.mro1cdnstorage.cdn.partner.office365.cn",Delos:"",Bleu:"https://fa000000174.mro1cdnstorage.fr.cdn.office.net"},be=e=>{let t=!1;const{error:n,tokenType:r}=e;if((e=>"object"==typeof e&&null!==e&&"code"in e)(n)&&13012===n.code)t=!0;else{const n=(e=>"string"==typeof e?e:"object"==typeof e&&e&&"message"in e&&"string"==typeof e.message?e.message:"")(e.error);n.toLowerCase().includes("resourcenotsupported")&&("GRAPH"!==r&&"SUBSTRATE"!==r&&"SHAREPOINT"!==r||(t=!0))}t&&q.reloadSDX()};var Se=s(9307);const we=(e,t,n)=>{if("MSA"===t&&"Public"!==n&&"Public1CDN"!==n)return;if("MSA"===t&&e in ae)return ae[e];const r=de[n]||ce;return e in r?r[e]:e in ce?ce[e]:void 0},Ce=e=>e===ae.ODSP||e===ae.MYODSP?`${e}/v2`:e,Ee=(e,t,n)=>{if("MSA"===t&&"Public"!==n&&"Public1CDN"!==n)return;const r=e.map((e=>e.toLowerCase()));if("MSA"===t)for(const[e,t]of Object.entries(ae))if("string"==typeof t&&r.includes(t.toLowerCase())){return{resource:Ce(t),tokenType:e}}const o=de[n]||ce;for(const[e,t]of Object.entries(o))if("string"==typeof t&&r.includes(t.toLowerCase()))return{resource:t,tokenType:e};for(const[e,t]of Object.entries(ce))if("string"==typeof t&&r.includes(t.toLowerCase()))return{resource:t,tokenType:e}},ke=e=>ve(null==e?void 0:e.identityType)?"MSA":"AAD";var Pe=s(9307);class Te{constructor(){this.bizChatTokenPromiseCache=new Map,this.hasLoggedUnknownOboRequest=!1,this.redirectUri=ye[G()],this.augloop=()=>this.getBizChatTokenForTokenType("AUGLOOP"),this.substrate=()=>this.getBizChatTokenForTokenType("SUBSTRATESEARCH"),this.sydney=()=>this.getBizChatTokenForTokenType("SYDNEY"),this.tenantFeedback=()=>this.getBizChatTokenForTokenType("TENANTFEEDBACK"),this.loki=async()=>({accessToken:await this.getBizChatTokenForTokenType("LOKI"),expirationTime:0}),this.feed=()=>this.getBizChatTokenForTokenType("SUBSTRATE"),this.yammer=()=>this.getBizChatTokenForTokenType("YAMMER"),this.spo=async(e,t)=>{var n,r;let o=null!==(n=null==e?void 0:e.toLowerCase())&&void 0!==n?n:"";if(((e,t)=>{if(!e)return!1;const n=["api.onedrive.com","onedrive.live.com","0d9adc9a-fdcf-465b-b30f-969a08bfef07"];return ve(e.identityType)&&n.some((e=>t.includes(e)))})(this.identity,o))return this.odc();var i;o.includes(".sharepoint")||((i=o).toLowerCase().includes(ae.ODSP)||i.toLowerCase().includes(ae.MYODSP))||(o=null!==(r=we("SHAREPOINT",ke(this.identity),G()))&&void 0!==r?r:ce.SHAREPOINT);return{AuthToken:await this.getBizChatTokenForResource(o,"SHAREPOINT",[o+"/.default"]),AuthTokenTtl:void 0}},this.mos=()=>this.getBizChatTokenForTokenType("METAOS"),this.oboToken=e=>{var t,n,r;const o=e.toLowerCase();let i;try{i=new URL(o)}catch(e){Pe.warn("Unsupported BizChat obo token request: Maybe invalid request URL: ",o)}const s=Ee([o,null!==(t=null==i?void 0:i.origin.toLowerCase())&&void 0!==t?t:""],ke(this.identity),G()),a=null!==(n=null==s?void 0:s.resource)&&void 0!==n?n:o,c=null!==(r=null==s?void 0:s.tokenType)&&void 0!==r?r:"UNKNOWN";this.hasLoggedUnknownOboRequest||"UNKNOWN"!==c||(this.hasLoggedUnknownOboRequest=!0,x.Instance.logEvent("GetBizChatToken",{TokenType:"OboToken",Message:"Unknown endpoint requested"}));return this.getBizChatTokenForResource(a,c,[a+"/.default"])},this.aeaToken=()=>this.getBizChatTokenForTokenType("AEA"),this.amsToken=()=>this.getBizChatTokenForTokenType("AMS"),this.graph=()=>this.getBizChatTokenForTokenType("GRAPH"),this.powerAutomate=()=>this.getBizChatTokenForTokenType("POWERAUTOMATE"),this.powerPlatform=e=>{let t;switch(e){case"prod":t="PPAPIPROD";break;case"preprod":t="PPAPIPREPROD";break;case"test":t="PPAPITEST";break;default:return Promise.reject(new Error("Unknown clusterCategory"))}return this.getBizChatTokenForTokenType(t)},this.apiHub=()=>this.getBizChatTokenForTokenType("APIHUB"),this.apiSkype=()=>this.getBizChatTokenForTokenType("SKYPE"),this.teams=()=>this.getBizChatTokenForTokenType("TEAMS"),this.outlook=()=>this.getBizChatTokenForTokenType("OUTLOOK"),this.designer=()=>this.getBizChatTokenForTokenType("DESIGNERAPPSERVICE"),this.apiUrlp=()=>this.getBizChatTokenForTokenType("URLP"),this.odc=async()=>({AuthToken:await this.getBizChatTokenForResource(ae.ODC,"ODC",[ae.ODC]),AuthTokenTtl:void 0}),this.ocps=()=>this.getBizChatTokenForTokenType("OCPS"),this.powerbi=()=>this.getBizChatTokenForTokenType("POWERBI"),this.pushChannel=()=>this.getBizChatTokenForTokenType("FLUIDPUSH"),this.mss=()=>this.getBizChatTokenForTokenType("BINGANSWERS"),this.copilotStudio=e=>this.getBizChatTokenForTokenType("prod"===e?"COPILOTSTUDIOPROD":"COPILOTSTUDIOTEST"),this.bap=()=>this.getBizChatTokenForTokenType("BAP"),this.gcs=()=>this.getBizChatTokenForTokenType("GCS"),this.mruPlusPlus=()=>this.getBizChatTokenForTokenType("MRUPLUSPLUS"),this.trouter=()=>this.getBizChatTokenForTokenType("TROUTER"),this.onenote=()=>this.getBizChatTokenForTokenType("ONENOTE"),this.safeLinks=e=>this.getBizChatTokenForTokenType(null!=e&&e?"SAFELINKSLEGACY":"SAFELINKS"),this.pacman=()=>this.getBizChatTokenForTokenType("PACMAN")}setIdentity(e){this.identity=e}async getBizChatTokenForTokenType(e,t){const n=this.bizChatTokenPromiseCache.get(e);if(n)return Pe.log(`acquire BizChat token of type: ${e} is already in progress`),n;const r=we(e,ke(this.identity),G());if(!r){const n=new Error("Unsupported token type");return Pe.error(`Unsupported BizChat token type: ${e}:`,t),x.Instance.logError("BizChatAuthError",n,{ErrorMethod:"getBizChatTokenForResource",TokenType:e}),Promise.reject(`Unsupported BizChat token type: ${e}`)}return this.getBizChatTokenForResource(r,e,[r+"/.default"])}async getBizChatTokenForResource(e,t,n){const r=this.bizChatTokenPromiseCache.get(e);if(r)return Pe.log(`acquire BizChat token of type: ${t} is already in progress`),r;const o=Z(),i=Date.now(),s=OfficeFirstPartyAuth.NestedAppAuth.load(pe,this.redirectUri).catch((e=>{throw x.Instance.logError("BizChatAuthError",e,{ErrorMethod:"load",ErrorCode:e.code,ErrorAppId:pe,ErrorRedirectUri:this.redirectUri,TokenType:t}),Pe.error("Nested App Auth load failed:",e.code),be({error:e,tokenType:t}),new Error(`Office FirstParty Nested App Auth load failed with error ${e.code}`)}));await s;const a=OfficeFirstPartyAuth.NestedAppAuth.getAccessToken({clientId:pe,scopes:n,popup:OfficeFirstPartyAuth.NestedAppAuth.PopupOptions.None,correlationId:o,redirectUri:this.redirectUri}).then((e=>{const n=Date.now()-i;return((e,t)=>{me.get(e)||(fe.log(`Acquired initial BizChat token ${e} in ${t}ms`),x.Instance.logEvent("InitialBizChatTokenAcquired",{TokenType:e,Duration:t}),me.set(e,!0))})(t,n),e.accessToken})).catch((n=>{throw x.Instance.logError("BizChatAuthError",n,{ErrorMethod:"getAccessToken",TokenType:t}),Pe.error(`acquire BizChat token of type: ${t} failed for resource ${e}:`,n),n})).finally((()=>{this.bizChatTokenPromiseCache.delete(e)}));return this.bizChatTokenPromiseCache.set(e,a),a}get BizChatTokenProvider(){return this}clearCache(){this.bizChatTokenPromiseCache.clear()}get Disposable(){return this}dispose(){this.clearCache()}}var Ne=s(9307);class Ae{constructor(){this.tokenPromiseCache=new Map,this.identity=void 0,this.isDisposed=!1,this.tokenFetchInProgress=!1,this.bizChatAuthService=new Te}async initializePreAuthz(){if(!this.tokenFetchInProgress){this.tokenFetchInProgress=!0;try{this.identity||await this.populateIdentity(),Ne.log("Acquiring required auth tokens");(async()=>{var e;const t=[this.bizChatAuthService.sydney(),this.getPreAuthToken("SUBSTRATE")];ve(null===(e=this.identity)||void 0===e?void 0:e.identityType)||t.push(this.getPreAuthToken("OCPS")),await Promise.all(t)})().catch((e=>{x.Instance.logError("AuthError",e,{ErrorMethod:"fetchTokens"}),Ne.error("Failed to acquire pre-auth tokens:",e)})).finally((()=>{this.tokenFetchInProgress=!1}))}catch(e){throw x.Instance.logError("AuthError",e,{ErrorMethod:"initializePreAuthz"}),this.tokenFetchInProgress=!1,e}}}get Disposable(){return this}dispose(){this.isDisposed=!0}get TokenProvider(){return this}getIdentity(){if(!this.isDisposed)return this.identity}get identityType(){return this.isDisposed||!this.identity?"UnauthenticatedGuest":ve(this.identity.identityType)?"Consumer":void 0===(e=this.identity.identityType)||e!==he.OrgId&&e!==he.ADAL?void 0:"Enterprise";var e}async getOfficeFirstPartyAuthResultByTokenType(e){if(this.isDisposed)return Promise.reject("Provider has been disposed");const t=we(e,ke(this.identity),G());return t?this.getOfficeFirstPartyAuthResultByResource(t,e):Promise.reject(`Unsupported token type: ${e}`)}async getOfficeFirstPartyAuthResultByResource(e,t,n){var r,o;if(this.isDisposed)return Promise.reject("Provider has been disposed");const i=this.tokenPromiseCache.get(e);if(i)return Ne.log(`acquire token for resource: ${e} is already in progress`),i;const s=Date.now(),a=ve(null===(r=this.identity)||void 0===r?void 0:r.identityType)?"DELEGATED":void 0,c=ve(null===(o=this.identity)||void 0===o?void 0:o.identityType)?((e,t)=>"MRUDF"===t||"MRU"===t?"service::officeapps.live.com::MBI_SSL_SHORT":e.endsWith("/")?`${e}.default`:`${e}/.default`)(e,t):void 0,l=(async()=>{var t;return await OfficeFirstPartyAuth.load(),OfficeFirstPartyAuth.getAccessToken({resource:e,policy:a,scope:c,identityId:null===(t=this.identity)||void 0===t?void 0:t.id,authChallenge:null==n?void 0:n.claims},{forceRefresh:null==n?void 0:n.forceRefresh})})().then((e=>{const r=Date.now()-s;return((e,t,n)=>{var r;ge.get(e)||(fe.log(`Acquired initial token ${e} in ${t}ms`),x.Instance.logEvent("InitialTokenAcquired",{TokenType:e,Duration:t,TokenHasClaims:void 0!==(null==n?void 0:n.claims),TokenForceRefresh:null!==(r=null==n?void 0:n.forceRefresh)&&void 0!==r&&r}),ge.set(e,!0))})(t,r,n),e})).catch((r=>{var o;throw x.Instance.logError("AuthError",r,{ErrorMethod:"getOfficeFirstPartyAuthResultByResource",TokenHasClaims:void 0!==(null==n?void 0:n.claims),TokenForceRefresh:null!==(o=null==n?void 0:n.forceRefresh)&&void 0!==o&&o,TokenType:t}),Ne.error(`acquire token for resource: ${e} failed:`,r),be({error:r,tokenType:t}),r})).finally((()=>{this.tokenPromiseCache.delete(e)}));return this.tokenPromiseCache.set(e,l),l}getOfficeFirstPartyParsedToken(e){const t=e.accessToken.split(".")[1].replace("-","+").replace("_","/");return JSON.parse(window.atob(t))}async getToken(e,t){var n,r,o,i,s;if(this.isDisposed)return Promise.reject("Provider has been disposed");let a,c=this.getResourceForScopes(e),l=c.toLowerCase();if(""===l)try{const e=null!==(r=null===(n=t.request)||void 0===n?void 0:n.url)&&void 0!==r?r:"",o=new URL(e);c=o.origin,l=o.origin.toLowerCase()}catch(e){const t=new Error("Unsupported token request: invalid request URL");throw x.Instance.logError("AuthError",t,{ErrorMethod:"getToken"}),new Error("Unsupported token request: invalid request URL")}try{a=new URL(l)}catch(e){Ne.warn("Unsupported token request: Maybe invalid request URL: ",l)}const u=Ee([l,null!==(o=null==a?void 0:a.origin.toLowerCase())&&void 0!==o?o:""],ke(this.identity),G()),d=null!==(i=null==u?void 0:u.resource)&&void 0!==i?i:l;let p=null!==(s=null==u?void 0:u.tokenType)&&void 0!==s?s:"UNKNOWN";return"UNKNOWN"===p&&(l.includes(".sharepoint")?p="SHAREPOINT":Ne.warn("Unknown token resource:",l,e,t)),new Promise(((e,n)=>{this.getOfficeFirstPartyAuthResultByResource(d,p,t).then((t=>{e({token:t.accessToken})})).catch((e=>{Ne.error("Failed to acquire token for resource:",l,e),x.Instance.logError("AuthError",e,{ErrorMethod:"getToken",TokenType:p}),n(e)}))}))}getUserContext(){let e=this.getIdentity();return e||(e={id:"",name:"",tenantId:"",identityType:0}),{get UserContext(){return this},user:{id:e.id,tenantId:e.tenantId,userIdSpace:"UserObjectId",oid:e.oid,upn:e.upn},signInState:["kmsi"],get Disposable(){return this},dispose(){}}}async getPreAuthToken(e,t){try{const n=Date.now(),r=await this.getOfficeFirstPartyAuthResultByTokenType(e),o=Date.now();if(Ne.log(`${e} token acquired in ${o-n}ms`),t){const e=this.getOfficeFirstPartyParsedToken(r);await t(e)}return r}catch(t){x.Instance.logError("AuthError",t,{ErrorMethod:"getPreAuthToken",TokenType:e}),Ne.error(`getPreAuthToken: Error fetching auth token for ${e}:`,t)}}getResourceForScopes(e){let t;return e.forEach((e=>{const n=e.lastIndexOf("/"),r=n>0?e.substring(0,n).toLowerCase():"";if(void 0===t)t=r;else if(t!==r){const e=new Error("All scopes must have the same resource");throw x.Instance.logError("AuthError",e,{ErrorMethod:"resourceForScopes"}),e}})),null!=t?t:""}async populateIdentity(){var e,t,n;const r=B.getActiveUserIdentity().catch((e=>(x.Instance.logError("AuthError",e,{ErrorMethod:"populateIdentity"}),Ne.error("Failed to get primary identity info:",e),Promise.reject("Failed to get primary identity info from client")))),o=await r;if(ve(o.accountType)){const t=await(async()=>{var e,t;const n=new Promise(((e,t)=>{const n=setTimeout((()=>{t(new Error("getAuthContextAsync timed out"))}),2e3);Office.context.auth.getAuthContextAsync((t=>{clearTimeout(n),e(t)}))}));try{const r=await n;if(r.status!==Office.AsyncResultStatus.Succeeded)throw new Error(null!==(t=null===(e=r.error)||void 0===e?void 0:e.message)&&void 0!==t?t:"Failed to get office auth context");return r}catch(e){return Se.error("Failed to get office auth context"+(ee(e)?`: ${e.message}`:"")),void x.Instance.logError("AuthError",ee(e)?e.message:"Failed to get office auth context",{ErrorMethod:"getOfficeAuthContext"})}})();if(t){o.tenantId=t.value.tenantId;const n=null!==(e=t.value.userObjectId)&&void 0!==e?e:o.userId;o.userId=n}}const i={id:o.userId,name:o.userName,tenantId:o.tenantId,identityType:o.accountType,upn:o.email};(i.tenantId!==(null===(t=this.identity)||void 0===t?void 0:t.tenantId)||i.id!==(null===(n=this.identity)||void 0===n?void 0:n.id))&&(this.tokenPromiseCache.clear(),this.bizChatAuthService.clearCache(),this.identity=i,this.bizChatAuthService.setIdentity(i),Ne.log("Identity changed:",this.identity))}}var Ie=s(9307);var Oe=s(751),Le=s(4457),De=s(9361),Re=s(6797),Fe=s(2477),Me=s(4506),xe=s(5531),_e=s(7394);const Ue={maxRetries:3,filter:(0,Me.sC)([429,500,503]),backoffFn:(0,_e.Ed)(500)},je=/.+\S\([^\(\)]+\)$/;function ze(e){const t=xe.f.get(e);if(null!=t)return $e(t)}function qe(e){const t=(0,Fe.A)()?.getItem(e);if(null!=t)return $e(t)}function Be(e){return 2===(e.cacheVersion||0)&&void 0!==e.expires&&e.expires.valueOf()>Date.now()}function $e(e){if(null!=e){let t;try{t=JSON.parse(e)}catch(e){}const n=void 0!==t?t:e;return"on"===n||"off"===n?"on"===n:n}}class He{static{this.previouslyLoggedSettingMetadata=new Set}static{this.settingMetadataToBeLogged=[]}static{this.settingsMetadataLoggingInterval=1e4}constructor(e,t){this.ecsClientConfiguration=e,this.previouslyAccessedEcsSettings=new Map,this._settingsFetchedFromEcs=!1,this._loadedEcsReponseEventSent=!1,this.logger=t&&new Le.p("EcsClient",t),this.loadAndClearCache(),this.ecsClientConfiguration.enableLogSettingsWithSource&&setInterval((()=>{this.logSettingsMetadata()}),He.settingsMetadataLoggingInterval)}get settingsFetchedFromEcs(){return this._settingsFetchedFromEcs}async fetch(e=!1){if(e||this.ecsClientConfiguration.alwaysFetchNewSettings||void 0===this.ecsResponseFromCache||!Be(this.ecsResponseFromCache)||this.ecsResponseFromCache.sessionId!==this.ecsClientConfiguration.sessionId){const e=function(e){const t=new URLSearchParams;if(t.append("agents",e.teamNames.join(",")),e.guestAgents){const n={};for(let t=0;t<e.guestAgents.length;t+=1){const r=e.guestAgents[t].substring(e.guestAgents[t].indexOf("(")+1,e.guestAgents[t].indexOf(")")),o=e.guestAgents[t].substring(0,e.guestAgents[t].indexOf("("));n[r]=n[r]?`${n[r]},${o}`:o}Object.entries(n).forEach((([e,n])=>{t.append("guestAgents",`${n}(${e})`)}))}Object.entries(e.filters).forEach((([e,n])=>{void 0!==n&&t.append(e,n)}));const n=t.toString();return`${e.host}/config/v1/${e.clientName}/${e.clientVersion}${""!==n?`?${n}`:""}`}(this.ecsClientConfiguration);return this.ecsResponsePromise||(this.ecsResponsePromise=this.fetchAndParse(e),this.ecsResponsePromise.then((e=>{e&&this.cacheEcsResponse(e),this._settingsFetchedFromEcs=!0})).catch((()=>{})).finally((()=>{this.ecsResponsePromise=void 0}))),this.ecsResponsePromise}}getSettingKey(e,t){return`${e}_${t}`}getSetting(e,t,n){return this.maybeLogLoadedEcsResponseFromCache(),this.getSettingInternal(e,t,n)}maybeLogLoadedEcsResponseFromCache(){!this._loadedEcsReponseEventSent&&this.ecsResponseFromCache&&(this.logger&&(0,De.Ot)(this.logger,{eventName:"loadedEcsResponseFromCache",settings:JSON.stringify(this.ecsResponseFromCache.ecsTeamsSettings),eTag:this.ecsResponseFromCache.eTag,configIds:JSON.stringify(this.ecsResponseFromCache.configIDs)}),this._loadedEcsReponseEventSent=!0)}logSettingsMetadata(){0!==He.settingMetadataToBeLogged.length&&(this.logger&&(0,De.Ot)(this.logger,{eventName:"ECSSettingMetadatas",settings:JSON.stringify(He.settingMetadataToBeLogged)}),He.settingMetadataToBeLogged=[])}async getLiveSetting(e,t,n){return this.maybeLogLoadedEcsResponseFromCache(),this.getLiveSettingInternal(e,t,n)}getSettingInternal(e,t,n){let r;const o=this.getSettingKey(e,n);if(void 0!==(r=this.previouslyAccessedEcsSettings.get(o)))return r;let i="";return void 0!==(r=ze(e))?i="QueryParam":void 0!==(r=qe(e))?i="LocalStorage":void 0!==(r=this.getSettingFromCachedEcsResponse(e,n))?i="CachedEcsResponse":(i="DefaultValue",r=t),this.previouslyAccessedEcsSettings.set(o,r),this.ecsClientConfiguration.enableLogSettingsWithSource&&!He.previouslyLoggedSettingMetadata.has(e)&&(He.previouslyLoggedSettingMetadata.add(e),He.settingMetadataToBeLogged.push({settingName:e,settingValue:r?.toString()??"",settingSource:i})),r}async getLiveSettingInternal(e,t,n){let r;const o=this.getSettingKey(e,n);if(void 0!==(r=this.previouslyAccessedEcsSettings.get(o)))return r;let i="";if(void 0!==(r=ze(e))?i="QueryParam":void 0!==(r=qe(e))&&(i="LocalStorage"),void 0!==r)return this.previouslyAccessedEcsSettings.set(o,r),this.ecsClientConfiguration.enableLogSettingsWithSource&&!He.previouslyLoggedSettingMetadata.has(e)&&(He.previouslyLoggedSettingMetadata.add(e),He.settingMetadataToBeLogged.push({settingName:e,settingValue:r?.toString()??"",settingSource:i})),r;const s=this._settingsFetchedFromEcs?this.getAllCachedEcsResponses()?.[this.ecsClientConfiguration.cacheKey]:await this.fetch(!0);return void 0!==(r=s?.ecsTeamsSettings[n]?.[e])?i="CachedEcsResponse":(r=t,i="DefaultValue"),this.previouslyAccessedEcsSettings.set(o,r),this.ecsClientConfiguration.enableLogSettingsWithSource&&!He.previouslyLoggedSettingMetadata.has(e)&&(He.previouslyLoggedSettingMetadata.add(e),He.settingMetadataToBeLogged.push({settingName:e,settingValue:r?.toString()??"",settingSource:i})),r}getSettingFromCachedEcsResponse(e,t){return this.ecsResponseFromCache?.ecsTeamsSettings[t]?.[e]}async fetchAndParse(e){const t=Re.m.start("EcsFetch",this.logger,{addUserTiming:!0});let n;try{n=await(0,Me.J5)(e,void 0,Ue)}catch(e){return void t.setResult(!1,void 0,e)}if(200!==n.result.status){const e=new Error("Failed to Fetch from ECS. Response is not 200");return void t.setResult(!1,{status:n.result.status,statusText:n.result.statusText},e)}const r=this.parseResponseToEcsResponse(n);return r.then((n=>{let r;performance.getEntriesByName(e).map((e=>{e.name.includes(this.ecsClientConfiguration.host)&&(r=e.duration)})),t.setResult(!0,{eTag:n.eTag,networkDurationMs:r,configIds:JSON.stringify(n.configIDs)})})).catch((e=>{t.setResult(!1,void 0,e)})),r}async parseResponseToEcsResponse(e){const t=await e.result.json(),n=[...this.ecsClientConfiguration.teamNames],r={};this.ecsClientConfiguration.guestAgents?.forEach((e=>{if(je.test(e)){const t=e.substring(0,e.indexOf("("));n.push(t)}else this.logger&&(0,De.hO)(this.logger,{eventName:"ecsTeamFormat"},new Error(`${e} doesn't match the format <EcsTeam>(<EcsClient>)`))}));for(let e=0;e<n.length;e+=1)t[n[e]]&&(r[n[e]]=t[n[e]]);const o=e.result.headers.get("ETag")||"",i=t.ConfigIDs||{};let s;if(this.ecsClientConfiguration.cacheExpiresDurationOverrideInMin)s=new Date(Date.now()+6e4*this.ecsClientConfiguration.cacheExpiresDurationOverrideInMin);else{const t=e.result.headers.get("Expires");s=t?new Date(t):void 0}return{ecsTeamsSettings:r,eTag:o,configIDs:i,expires:s,cacheVersion:2,sessionId:this.ecsClientConfiguration.sessionId}}cacheEcsResponse(e){const t=(0,Fe.A)();if(t)try{const n=this.getAllCachedEcsResponses()||{};n[this.ecsClientConfiguration.cacheKey]=e,t.setItem(this.ecsClientConfiguration.responsesCacheKey,JSON.stringify(n))}catch(e){this.logger&&(0,De.hO)(this.logger,{eventName:"cacheEcsResponse"},e)}}getAllCachedEcsResponses(){try{const e=(0,Fe.A)(),t=e?.getItem(this.ecsClientConfiguration.responsesCacheKey),n=t&&JSON.parse(t);if(!n||0===Object.keys(n).length)return;return Object.entries(n).forEach((([e,t])=>{"string"==typeof t.expires&&(t.expires=new Date(t.expires))})),n}catch(e){this.logger&&(0,De.hO)(this.logger,{eventName:"getAllCachedEcsResponses"},e)}}loadAndClearCache(){const e=this.getAllCachedEcsResponses();if(e){const t=e[this.ecsClientConfiguration.cacheKey];t&&(this.ecsResponseFromCache=t),this.clearExpiredEcsResponsesFromCache(e)}}clearExpiredEcsResponsesFromCache(e){try{const t=(0,Fe.A)();if(!t)return;const n={};Object.entries(e).forEach((([e,t])=>{(Be(t)||e===this.ecsClientConfiguration.cacheKey)&&(n[e]=t)})),t.setItem(this.ecsClientConfiguration.responsesCacheKey,JSON.stringify(n))}catch(e){this.logger&&(0,De.hO)(this.logger,{eventName:"clearExpiredEcsResponsesFromCache"},e)}}}function We(e){return(0,Oe.F)("ecs",e)}function Ge(e){return"teamNames"in e}class Ve{get SettingsProvider(){return this}get settingsFetchedFromEcs(){return this.ecsClient.settingsFetchedFromEcs}constructor(e,t){this.ecsClient=Ge(e)?new He(e,t):new He(function(e){const{ecsFilters:t,hostName:n,sessionId:r,responsesCacheKeyOverride:o,cacheExpiresDurationOverrideInMin:i,fetchFluidExperiencesSettings:s=!0,fetchSegmentationSettings:a=!0,alwaysFetchNewSettings:c,enableLogSettingsWithSource:l=!1}=e,{userContext:u}=t,d=function(e){return"Development"===e?"Staging":e}(t.audience),p=u.user?.id,h=u.user?.tenantId,f={audience:d,userId:p,tenantId:h,hostName:n},g=`${p}${n}${d}`,m=o||"FluidEcsClientResponses",v=[];return s&&v.push("FluidExperiences"),a&&v.push("Segmentation"),{host:We(d),clientName:"Fluid",clientVersion:"0.0.0.1",teamNames:v,filters:f,cacheKey:g,responsesCacheKey:m,cacheExpiresDurationOverrideInMin:i,sessionId:r,alwaysFetchNewSettings:c,enableLogSettingsWithSource:l}}(e),t),this.audience=Ge(e)?e.filters.audience:e.ecsFilters.audience,this.fetchSettings().catch((()=>{}))}get Disposable(){return this}dispose(){}async fetchSettings(){await this.ecsClient.fetch()}getSetting(e,t,n){return this.ecsClient.getSetting(e,t,n)}async getLiveSetting(e,t,n){return this.ecsClient.getLiveSetting(e,t,n)}}class Qe{constructor(e){this.telemetryData={},this.activityName=e}finishWithFailure(e){x.Instance.logError(this.activityName,e,this.telemetryData)}finishWithSuccess(){x.Instance.logEvent(this.activityName,this.telemetryData)}addData(e,t){this.telemetryData[e]=t}static async runActivity(e,t){const n=new Qe(e);try{const e=Date.now(),r=await t(n),o=Date.now();return n.addData("Duration",o-e),n.finishWithSuccess(),r}catch(e){throw n.finishWithFailure(e),e}}}var Je=s(9307);const Ke=e=>{switch(e){case"Automation":case"Development":case"Dogfood":case"Staging":case"Local":case"SyntheticTraffic":return"SDFV2";case"Preview":return"MSIT";case"GCC":default:return"WW";case"GCC-High":case"DoD":return"ITAR"}},Ye=e=>{switch(e){case"Automation":case"Development":case"Dogfood":case"Staging":case"Local":case"SyntheticTraffic":return"SDF";case"Preview":return"MSIT";case"GCC":return"GCCModerate";case"GCC-High":return"GCCHigh";case"DoD":return"DoD";default:return"Prod"}};var Xe=s(9307);const Ze="OneNote",et="M365ChatClient",tt=[et,"AppVersion"];class nt extends Ve{constructor(e,t,n){var r,o,i,s;const a=`${null===(r=t.getIdentity())||void 0===r?void 0:r.id}${Ze}${e.audience}`;super({host:(0,Oe.F)("ecs",e.audience),clientName:"M365ChatClient",clientVersion:"1.0.0.0",teamNames:tt,cacheKey:a,responsesCacheKey:"M365ChatEcsResponseCache",alwaysFetchNewSettings:!0,enableLogSettingsWithSource:!0,filters:{audience:e.audience,HostName:Ze,AccountType:ve(null===(o=t.getIdentity())||void 0===o?void 0:o.identityType)?"MSA":"AAD",TenantId:null===(i=t.getIdentity())||void 0===i?void 0:i.tenantId,UserID:null===(s=t.getIdentity())||void 0===s?void 0:s.id,Locale:n,Environment:Ye(e.audience),DeploymentRing:Ke(e.audience)}}),this.cacheKey=a}async getAllCachedEcsResponses(){return Qe.runActivity("GetAllCachedEcsResponses",(async()=>{var e,t,n;try{if(!this.settingsFetchedFromEcs){const t=null===(e=this.ecsClient)||void 0===e?void 0:e.ecsResponsePromise;if(!t)throw Xe.error("ecsResponsePromise not initialized"),new Error("ecsResponsePromise not initialized");await Promise.race([t,new Promise(((e,t)=>setTimeout((()=>t(new Error("Timeout while fetching ECS settings"))),1e4)))])}return null===(n=null===(t=this.ecsClient)||void 0===t?void 0:t.getAllCachedEcsResponses)||void 0===n?void 0:n.call(t)}catch(e){return Xe.error("Error while fetching ECS settings",e),void x.Instance.logError("M365ChatSettingsProviderError",e,{ErrorMethod:"getAllCachedEcsResponses"})}}))}async getAllM365ChatFeatureSettings(){var e,t;const n=await this.getAllCachedEcsResponses();Xe.log("Cached ECS responses",n);return(e=>{if(!e)return;const t={};for(const[n,r]of Object.entries(e))if("boolean"==typeof r)t[n]=r;else if("string"==typeof r)t[n]=r;else if("number"==typeof r)t[n]=r.toString();else{if(null==r)continue;try{t[n]=JSON.stringify(r)}catch(e){Je.error(`Error transforming ECS team setting ${n} to string`,e)}}return t})(null===(t=null===(e=null==n?void 0:n[this.cacheKey])||void 0===e?void 0:e.ecsTeamsSettings)||void 0===t?void 0:t[et])}}var rt=s(6952),ot=s(1801);const it="function"==typeof FinalizationRegistry;class st{constructor(e,t,n,r){this.loggingDelay=e,this.subcategory=n,this.trackedObjectsGcTime=new Map,this.trackedObjects=new Set,it?(this.logger=new Le.p("MemoryLeakTracker",t,r),this.finalizationRegistry=new FinalizationRegistry((e=>{this.trackedObjectsGcTime.set(e,globalThis.performance.now()),this.trackedObjectsGcTime.size===this.trackedObjects.size&&this.closeAndSendTelemetry()}))):this.isDisposed=!0}get Disposable(){return this}dispose(){this.isDisposed=!0,this.loggingTimeout&&clearTimeout(this.loggingTimeout),this.logger?.Disposable.dispose(),this.logger=void 0}trackObject(e,t){this.isDisposed||(this.trackedObjects.add(e),this.finalizationRegistry?.register(t,e))}markParentAsClosed(){this.isDisposed||(this.parentClosedTime=globalThis.performance.now(),this.loggingTimeout=setTimeout((()=>this.closeAndSendTelemetry()),this.loggingDelay))}closeAndSendTelemetry(){const e={};for(const t of this.trackedObjects){const n=this.trackedObjectsGcTime.get(t);e[t]="number"==typeof n&&(!this.parentClosedTime||n-this.parentClosedTime)}const t=this.trackedObjects.size>0?this.trackedObjectsGcTime.size>0&&(!this.parentClosedTime||Math.max(...this.trackedObjectsGcTime.values())-this.parentClosedTime):void 0;this.logger?.send({category:ot.hB.Generic,subCategory:this.subcategory,eventName:"MemoryCleanup",gcTimes:JSON.stringify(e),finalObjectGcTime:t,loggingDelay:this.loggingDelay}),this.Disposable.dispose()}}function at(e){return e?Object.keys(e).sort().join(","):""}class ct{constructor(...e){this.providers=new Map,this.memo=new Map,this.resolveLocalProvider=e=>{const t=this.providers.get(e);if(t)return"function"==typeof t?{get:()=>{if("function"==typeof t)return Promise.resolve(this.IFluidDependencySynthesizer).then((async e=>t(e))).then((t=>t?.[e]))}}:{get:()=>new rt.I((async()=>Promise.resolve(t).then((t=>{if(t)return t[e]}))))}},this.parents=e.filter((e=>void 0!==e))}get IFluidDependencySynthesizer(){return this}register(e,t){if(this.providers.has(e))throw new Error(`Attempting to register a provider of type ${String(e)} that already exists`);this.clearMemo(),this.providers.set(e,t)}unregister(e){this.providers.has(e)&&(this.providers.delete(e),this.clearMemo())}clearMemo(){this.memo.clear()}synthesize(e,t){const n=`required:${at(t)},optional:${at(e)}`;if(this.memo.has(n))return this.memo.get(n);const r={};return this.generateRequired(r,t),this.generateOptional(r,e),Object.defineProperty(r,"IFluidDependencySynthesizer",{get:()=>this}),this.memo.set(n,r),r}has(e,t){return!!this.providers.has(e)||!0!==t&&this.parents.some((t=>t.has(e)))}generateRequired(e,t){if(void 0===t)return;const n=this.generate(e,t);if(0!==n.size){const e=Array.from(n).join(", ");throw new Error(`Object attempted to be created without registered required providers ${e}`)}}generateOptional(e,t){if(void 0===t)return;const n=this.generate(e,t);for(const t of n){const n={get:async()=>{}};Object.defineProperty(e,t,n)}}generate(e,t){const n=new Set(Object.keys(t));for(const t of n){const r=this.resolveLocalProvider(t);r&&(n.delete(t),Object.defineProperty(e,t,r))}for(const t of this.parents){const r={};for(const e of n)r[e]=e;const o=t.synthesize(r,void 0);for(const t of n){const r=Object.getOwnPropertyDescriptor(o,t);r&&(n.delete(t),Object.defineProperty(e,t,r))}}return n}}class lt{constructor(e,t){this.synthDependencies=new Map,this.dependencySynthesizer=new ct(e);const n=e?.synthesize({NamespaceLogger:"NamespaceLogger"},void 0);n?.NamespaceLogger?.then((e=>{e&&(this.memoryLeakTracker=new st(t?.memoryLeakDetectionWaitTime??3e5,e,"LoopDependencyContainer"))})).catch((()=>{}))}get IFluidDependencySynthesizer(){return this}register(e,t){let n;this.dependencySynthesizer.has("DataConnector")&&(n=this.dependencySynthesizer.synthesize({DataConnector:"DataConnector"},void 0)),this.dependencySynthesizer.register(e,new rt.I((async()=>{const r=await Promise.resolve(t);if("DataConnector"!==e){const e=await(n?.DataConnector);e?.addComponentTracking(r)}return this.synthDependencies.set(e,r),this.memoryLeakTracker?.trackObject(e,r),r})))}registerIfNotAlreadyExists(e,t){this.dependencySynthesizer.has(e)||this.register(e,t)}synthesize(e,t={}){return this.dependencySynthesizer.synthesize(e,t)}has(e){return this.dependencySynthesizer.has(e)}unregister(e){return this.dependencySynthesizer.unregister(e)}dispose(){for(const[e,t]of this.synthDependencies)t.Disposable.dispose(),this.unregister(e);this.synthDependencies.clear(),this.memoryLeakTracker?.markParentAsClosed()}}const ut={productionOrigin:"https://loop.microsoft.com",previewOrigin:"https://preview.loop.microsoft.com",dogfoodOrigin:"https://df.loop.microsoft.com",stagingOrigin:"https://dev.loop.microsoft.com",localOrigins:["https://local.loop.microsoft.com","https://local.loop.microsoft.com:8080","https://local.loop.microsoft.com:8081","http://localhost:8094","http://localhost"]},dt={delosOrigin:"https://loop.sovcloud.de",bleuOrigin:"https://loop.sovcloud.fr",gallatinOrigin:"https://loop.microsoftonline.cn",dodOrigin:"https://loop.apps.mil",gcchOrigin:"https://loop.office365.us",publicOrigin:"https://loop.cloud.microsoft",developerOrigin:"https://loop.cloud-dev.microsoft"};function pt(e){return encodeURIComponent(btoa(JSON.stringify(e)))}function ht(e){return t=>{if("object"!=typeof t||!t)return!1;const n=t;for(const[t,r]of Object.entries(e)){const e=n[t];if(typeof e!==r||!e)return!1}return!0}}const ft="/p";ht({p:"object"}),ht({w:"object"}),ht({u:"string"});var gt=s(4312);const mt="fo";function vt(e){const t=function(e){const t=atob(e);if(!t.startsWith("ODSP"))throw new Error("Cannot parse id value when provided ID is not for ODSP pod");const n=t.split("|");return n.length>4?{siteDomain:n[1],driveId:n[2],itemId:n[3],podFileFolderPath:n[4]}:{siteDomain:n[1],driveId:n[2],itemId:n[3]}}(e),n=`https://${t.siteDomain}`,r=new URL(n);return(0,gt.Cu)(r,{siteUrl:n,driveId:t.driveId,itemId:t.itemId,dataStorePath:""}),t.podFileFolderPath&&r.searchParams.set(mt,btoa(t.podFileFolderPath)),r.toString()}const yt=dt.publicOrigin,bt=new URL("/notebooks",yt);function St(e){const{docUrl:t,requiresRedeem:n,mfsPodId:r}=e,o={u:t,r:!!n},i=r?wt(r):void 0,s=`${ft}/${pt({w:i,p:o,ch:{c:void 0}})}`;return new URL(s,yt)}function wt(e){return{u:vt(e),r:!1}}const Ct="@fluidx/loop-workspace-component",Et=(e,t)=>t.some((t=>e instanceof t));let kt,Pt;const Tt=new WeakMap,Nt=new WeakMap,At=new WeakMap,It=new WeakMap,Ot=new WeakMap;let Lt={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Nt.get(e);if("objectStoreNames"===t)return e.objectStoreNames||At.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ft(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Dt(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Pt||(Pt=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(Mt(this),t),Ft(Tt.get(this))}:function(...t){return Ft(e.apply(Mt(this),t))}:function(t,...n){const r=e.call(Mt(this),t,...n);return At.set(r,t.sort?t.sort():[t]),Ft(r)}}function Rt(e){return"function"==typeof e?Dt(e):(e instanceof IDBTransaction&&function(e){if(Nt.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",o),e.removeEventListener("error",i),e.removeEventListener("abort",i)},o=()=>{t(),r()},i=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",o),e.addEventListener("error",i),e.addEventListener("abort",i)}));Nt.set(e,t)}(e),Et(e,kt||(kt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,Lt):e)}function Ft(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",o),e.removeEventListener("error",i)},o=()=>{t(Ft(e.result)),r()},i=()=>{n(e.error),r()};e.addEventListener("success",o),e.addEventListener("error",i)}));return t.then((t=>{t instanceof IDBCursor&&Tt.set(t,e)})).catch((()=>{})),Ot.set(t,e),t}(e);if(It.has(e))return It.get(e);const t=Rt(e);return t!==e&&(It.set(e,t),Ot.set(t,e)),t}const Mt=e=>Ot.get(e);const xt=["get","getKey","getAll","getAllKeys","count"],_t=["put","add","delete","clear"],Ut=new Map;function jt(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(Ut.get(t))return Ut.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,o=_t.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!o&&!xt.includes(n))return;const i=async function(e,...t){const i=this.transaction(e,o?"readwrite":"readonly");let s=i.store;return r&&(s=s.index(t.shift())),(await Promise.all([s[n](...t),o&&i.done]))[0]};return Ut.set(t,i),i}Lt=(e=>({...e,get:(t,n,r)=>jt(t,n)||e.get(t,n,r),has:(t,n)=>!!jt(t,n)||e.has(t,n)}))(Lt);const zt="fluidCodeLoaderCache",qt="codeLoaderStorage";function Bt(){return function(e,t,{blocked:n,upgrade:r,blocking:o,terminated:i}={}){const s=indexedDB.open(e,t),a=Ft(s);return r&&s.addEventListener("upgradeneeded",(e=>{r(Ft(s.result),e.oldVersion,e.newVersion,Ft(s.transaction))})),n&&s.addEventListener("blocked",(()=>n())),a.then((e=>{i&&e.addEventListener("close",(()=>i())),o&&e.addEventListener("versionchange",(()=>o()))})).catch((()=>{})),a}(zt,1,{async upgrade(e,t){e.createObjectStore(qt).createIndex("lastUpdatedTime","lastUpdatedTime")},blocked:()=>{throw new Error("Could not open code loader cache DB since it is blocked by an older client that has the DB open")}})}function $t(e){return`${e.packageName}_${e.ring}`}function Ht(e,t,n,r,o,i,s,a,c){const l=r(n),u=l.then((async r=>{const s=await Bt(),c=$t({packageName:t,ring:n}),l=await s.get(qt,c);l&&l.codeDetailsPackage.version===i(r).version||o(e,r,a),await s.put(qt,{codeDetailsPackage:i(r),lastUpdatedTime:Date.now()},c),s.close()})).catch((e=>{c&&(0,De.hO)(c,{eventName:"CodeDetailsFromNetworkAndUpdateCacheFailed",message:`Failed to update cache and return code details for ${t}`},e)}));return{codePackagePromise:l.then((e=>{const t=s?s(e):void 0;return{...i(e),maxUnsupportedVersion:t}})),cacheUpdatePromise:u}}function Wt(e){const t=e;return t.perWindowLoopModuleCache??=new Map}function Gt(e,t){if(t.length>0&&"string"==typeof t[0]){const n=e.find((e=>!function(e,t){const n=new URL(e);return t.includes(n.origin)}(e,t)));return void 0===n}return Vt(e,t)}function Vt(e,t){const n=function(e){const t=new Map;for(const n of e)for(const e of n.origin)if(void 0===n.paths)t.set(e,"ALL");else{const r=t.get(e);"ALL"===r||(void 0===r?t.set(e,n.paths.map(Qt)):t.set(e,r.concat(n.paths.map(Qt))))}return t}(t);return e.every((e=>{const t=new URL(e);if(t.pathname!==decodeURIComponent(t.pathname))return!1;const r=n.get(t.origin);if("ALL"===r)return!0;if(void 0===r)return!1;{const e=Qt(t.pathname);return r.some((t=>t.every(((t,n)=>t===e[n]))))}}))}function Qt(e){return e.split("/").filter((e=>""!==e))}async function Jt(e,t,n){try{const n=await Bt();await n.delete(qt,$t({packageName:e,ring:t})),n.close()}catch(e){n&&(0,De.hO)(n,{eventName:"DeleteContainerDetailsFromCacheFailed",message:"DeleteContainerDetailsFromCache failed to delete container details from cache"},e)}}let Kt=24192e5;async function Yt(e,t,n,r,o){try{const i=await Bt(),s=await i.get(qt,$t({packageName:e,ring:t}));if(i.close(),s){const i=Date.now()-s.lastUpdatedTime;return i>Kt?{metadata:{cacheStatus:"expired",cacheAge:i},codeDetailsPackage:void 0}:Gt(r(s.codeDetailsPackage),n)?{metadata:{cacheStatus:"hit",cacheAge:i},codeDetailsPackage:s.codeDetailsPackage}:(Jt(e,t,o).catch((()=>{})),{metadata:{cacheStatus:"unsafe"},codeDetailsPackage:void 0})}}catch(e){o&&(0,De.hO)(o,{eventName:"GetCodeDetailsPackageFromCacheFailed",message:"GetCodeDetailsPackageFromCacheFailed failed return response"},e)}return{metadata:{cacheStatus:"miss"},codeDetailsPackage:void 0}}const Xt=new Map;let Zt=!1,en=0;function tn(){if(document.hidden){const e=Date.now();Xt.forEach(((t,n)=>{-1===t&&Xt.set(n,e)})),nn()}}function nn(){Zt=!1,document.removeEventListener("visibilitychange",tn)}function rn(e){document.hidden?Xt.set(e,0):(Zt||(Zt=!0,document.addEventListener("visibilitychange",tn)),Xt.set(e,-1))}function on(){return en+=1,rn(en),en}function sn(e,t){const n=Xt.get(e);return t&&an(e),n}function an(e){Xt.delete(e),0===Xt.size&&Zt&&nn()}async function cn(e,t,n,r,o,i){const s=on(),a=Re.m.start("GetCodeDetailsPackage",i,{addUserTiming:!0}),c=Yt(e,t,n,o,i).then((e=>({method:"cache",cacheDetails:e}))),l=r(t,n).then((e=>({method:"network",codeDetails:e}))),u=await Promise.race([c,l]);let d={documentEverHidden:sn(s,!0)>-1,deploymentRing:t};if("cache"===u.method){const{cacheDetails:e}=u;if(d={...d,...e.metadata},e.codeDetailsPackage)return a.setResult(!0,{method:"cache",...d,packageVersion:e.codeDetailsPackage.version}),e.codeDetailsPackage}return l.then((e=>(a.setResult(!0,{method:"network",...d,packageVersion:e.codeDetails.version}),e.codeDetails)))}const ln=(e,t,n,r="low")=>{let o=3;return function i(){return un(e,t,n,r).catch((()=>(o-=1,0===o?un(e,t,n,r):i())))}()};async function un(e,t,n,r){return new Promise(((o,i)=>{const s=e.document,a=s.createElement("script");a.setAttribute("fetchpriority",r);const c=n?.trustedTypesPolicy?.createScriptURL(t,{allowedScriptOrigins:n.allowedOrigins})??t;a.src=c,a.async=!1,a.charset="utf-8",a.crossOrigin="anonymous",a.onload=o,a.onerror=()=>i(new Error(`Failed to download the script at url: ${t}, isUserDefinitelyOffline: ${!e.navigator.onLine}`)),s.head.appendChild(a)}))}function dn(e){switch(e){case"Development":return"Development";case"Staging":return"Staging";case"Dogfood":return"Dogfood";case"Preview":case"Microsoft":case"Production":return"Prod";case"GCC":return"Gcc";case"GCC-High":return"GccHigh";case"DoD":return"DoD";case"USNat":return"USNat";case"USSec":return"USSec";case"Gallatin":return"Gallatin";case"Bleu":return"Bleu";case"Delos":return"Delos";default:return}}function pn(e){switch(e){case"Development":return{audience:"Development"};case"Staging":return{audience:"Staging"};case"Dogfood":return{audience:"Dogfood"};case"Gcc":return{audience:"GCC"};case"GccHigh":return{audience:"GCC-High"};case"DoD":return{audience:"DoD"};case"USNat":return{audience:"USNat"};case"USSec":return{audience:"USSec"};case"Gallatin":return{audience:"Gallatin"};case"Bleu":return{audience:"Bleu"};case"Delos":return{audience:"Delos"};default:return{audience:"Production"}}}function hn(e,t){return e?function(e){const t=dn(e?.audience);return t||(e?.ring?e.ring:"Prod")}(e):dn(t)??"Prod"}const fn=["https://cdn.dev.fluidpreview.office.net","https://cdn.fluidpreview.office.net","https://res-sdf.cdn.office.net","https://res.cdn.office.net","https://res-dev.cdn.officeppe.net","https://res.df.onecdn.static.microsoft","https://res.public.onecdn.static.microsoft","https://dev.loop.microsoft.com","https://df.loop.microsoft.com","https://preview.loop.microsoft.com","https://loop.microsoft.com","https://dev.ch5.fluidpreview.office.net","https://ch5.fluidpreview.office.net","https://dev.whiteboard.microsoft.com","https://app.int.whiteboard.microsoft.com","https://app.whiteboard.microsoft.com","https://whiteboard.cloud.microsoft","https://whiteboard.cloud.dev.microsoft","https://whiteboard.microsoft.com","https://whiteboard.office.com","https://loop.cloud.microsoft","https://loop.cloud-dev.microsoft","https://hosted.loop.cloud.dev.microsoft","https://hosted.loop.cloud.microsoft"],gn=["https://res-gcch.cdn.office.net","https://res-gcch.onecdn.usgovcloud-static.microsoft","https://whiteboard.office365.us"],mn=["https://res-dod.cdn.office.net","https://res-dod.onecdn.usgovcloud-static.microsoft","https://whiteboard.apps.mil"],vn=["https://res-cn.cdn.partner.office365.cn"],yn=["https://whiteboard.eaglex.ic.gov"],bn=["https://whiteboard.microsoft.scloud"],Sn=["https://res.onecdn.sovcloud-static.fr","https://whiteboard.sovcloud.fr"],wn=[...fn,...gn,...mn,...yn,...bn,...vn,...Sn],Cn=[{origin:["https://cdn.dev.fluidpreview.office.net","https://cdn.fluidpreview.office.net","https://res-sdf.cdn.office.net","https://res.cdn.office.net","https://res-dev.cdn.officeppe.net","https://res.df.onecdn.static.microsoft","https://res.public.onecdn.static.microsoft","https://dev.loop.microsoft.com","https://df.loop.microsoft.com","https://preview.loop.microsoft.com","https://loop.microsoft.com","https://dev.ch5.fluidpreview.office.net","https://ch5.fluidpreview.office.net","https://loop.cloud.microsoft","https://loop.cloud-dev.microsoft","https://hosted.loop.cloud.dev.microsoft","https://hosted.loop.cloud.microsoft"],paths:["fluid/dev","fluid/df","fluid/stg","fluid/prod","fluid/pr","fluid/gcc","fluid/gcch","fluid/dod","fluid/local-redirect-container"]},{origin:["https://dev.whiteboard.microsoft.com","https://app.int.whiteboard.microsoft.com","https://app.whiteboard.microsoft.com","https://whiteboard.cloud.microsoft","https://whiteboard.cloud.dev.microsoft","https://whiteboard.microsoft.com","https://whiteboard.office.com"],paths:void 0}],En=[{origin:["https://res-gcch.cdn.office.net","https://res-gcch.onecdn.usgovcloud-static.microsoft"],paths:["fluid/gcch"]},{origin:["https://whiteboard.office365.us"],paths:void 0}],kn=[{origin:["https://res-dod.cdn.office.net","https://res-dod.onecdn.usgovcloud-static.microsoft"],paths:["fluid/dod"]},{origin:["https://whiteboard.apps.mil"],paths:void 0}],Pn=[{origin:["https://res-cn.cdn.partner.office365.cn"],paths:["fluid/gallatin"]}],Tn=[{origin:["https://whiteboard.eaglex.ic.gov"],paths:void 0}],Nn=[{origin:["https://whiteboard.microsoft.scloud"],paths:void 0}],An=[{origin:["https://res.onecdn.sovcloud-static.fr"],paths:["fluid/bleu"]},{origin:["https://whiteboard.sovcloud.fr"],paths:void 0}],In=[...Cn,...En,...kn,...Tn,...Nn,...Pn,...An],On=(e,t)=>{if(!(t?.getSetting("bohemiaCodeLoader.environmentSpecificCDNs",!0)??1))return In;switch(e){case"GccHigh":return En;case"DoD":return kn;case"USNat":return Tn;case"USSec":return Nn;case"Gallatin":return Pn;case"Bleu":return An;default:return Cn}},Ln={Automation:"https://res.cdn.office.net/fluid/prod",Development:"https://res-dev.cdn.officeppe.net/fluid/pr",DoD:"https://res-dod.cdn.office.net/fluid/dod",Dogfood:"https://res.cdn.office.net/fluid/df",GCC:"https://res.cdn.office.net/fluid/gcc","GCC-High":"https://res-gcch.cdn.office.net/fluid/gcch",Local:"https://res.cdn.office.net/fluid/prod",Microsoft:"https://res.cdn.office.net/fluid/prod",Preview:"https://res.cdn.office.net/fluid/prod",Production:"https://res.cdn.office.net/fluid/prod",Staging:"https://res-sdf.cdn.office.net/fluid/stg",SyntheticTraffic:"https://res.cdn.office.net/fluid/prod",USNat:"",USSec:"",Bleu:"https://res.onecdn.sovcloud-static.fr/fluid/bleu",Delos:"",Gallatin:"https://res-cn.cdn.partner.office365.cn/fluid/gallatin"};function Dn(e){return Ln[e]}var Rn=s(9176);const Fn={maxRetries:3,filter:(0,Me.sC)([429,503,709,710]),backoffFn:(0,_e.Ed)(500)};function Mn(e,t){return t?(0,Rn.R)(e,{method:"GET"},t.eventName,t.logger,t.doNotLogOnSuccess,Fn,t.timeoutMs??0,t.getAdditionalProps):(0,Me.J5)(e,{method:"GET"},Fn)}const xn="workspaceComponentManifest.json",_n=ut.localOrigins;async function Un(e,t){let n,r;if("Local"===e){try{n=await Promise.any(_n.map((e=>async function(e){const t=await fetch(`${e}/${xn}`);if(!t.ok)throw new Error(`Failed to fetch local manifest from ${e}.`);return t}(e))))}catch(e){throw new Error(`Failed to fetch local ${xn} at any of the attempted ports. Did you remember to start the loop app locally?`)}r=new URL("./",n.url).href}else{const o=Dn(e);if(!o)throw new Error(`No CDN endpoint found for the audience: ${e}.`);r=function(e,t,n){if(t)return`${e}/loop-app/versionless/deployment/${t}`;if("Staging"===n)return`${e}/loop-app/versionless/5mttl`;return`${e}/loop-app/versionless`}(o,t,e),n=(await Mn(`${r}/${xn}`)).result}if(!n.ok)throw new Error(`Failed to fetch manifest from ${r}.`);return{...await n.json(),baseUrl:r}}function jn(e){return{bootResources:e.bootResources,globals:e.globals,importMap:e.importMap,version:e.version??e.globals?.__app_environment_script_version__??"",baseUrl:e.baseUrl}}function zn(e){return e.bootResources}function qn(e,t,n){const r=e.document,o=r.createDocumentFragment();t.forEach((e=>{const t=r.createElement("link");t.rel="prefetch",t.href=e,e.endsWith(".js")?(t.as="script",t.crossOrigin="anonymous",o.appendChild(t)):e.endsWith(".css")?(t.as="style",o.appendChild(t)):n&&(0,De.hO)(n,{eventName:"FluidXPrefetchAssetFailed",message:`Unsupported asset type for prefetching: ${e}`})})),r.head.appendChild(o)}function Bn(e,t,n,r){const o=t.preload?.manifest?.assets;if(o){const i=t.preload?.jsBaseUrl,s=l(n),a=t.preload?.manifest?.localizedAssets?.[s]??[];qn(e,[...o,...a].map((e=>new URL(e,i).href)),r)}}function $n(e){const t=function(e){let t,n;try{n=e.localStorage.getItem("lwcRing")}catch{return}switch(n?.toLowerCase()){case"local":t="Local";break;case"stg":case"staging":t="Staging";break;case"df":case"dogfood":t="Dogfood";break;case"prod":case"production":t="Production"}return t}(e),n=function(e){let t=null;try{t=e.localStorage.getItem("lwcScriptVersion")}catch{return null}if(t){const e=/^(pr:)?([\d\.]+)$/.exec(t);if(e)return{isPrBuild:"pr:"===e[1],buildVersion:e[2]}}return null}(e);return{audienceOverride:t,scriptVersionOverride:n}}class Hn{constructor(e){const{localeHint:t,audience:n,windowContext:r,dependencySynthesizer:o}=e;this.windowContext=r,this.hostRequestedAudience=n;const{audienceOverride:i,scriptVersionOverride:s}=$n(r);this.audienceToUse=function(e,t,n){if(t?.isPrBuild)return"Development";if(t)return"Staging";if(e)return e;return"Development"===n?"Staging":n}(i,s,n),this.scriptVersionOverride=s,this.localeHint=t,this.providers=o?.synthesize({LoopTrustedTypesPolicy:"LoopTrustedTypesPolicy",NamespaceLogger:"NamespaceLogger"},void 0)??{}}canLoad(e){return e.packageName===Ct}getCodeDetailsFromNetworkAndUpdateCache(e,t){return Ht(this.windowContext,Ct,dn(e),(()=>Un(e,this.scriptVersionOverride?.buildVersion)),Bn,jn,void 0,this.localeHint,t)}loadStylesheet(e){return new Promise(((t,n)=>{const r=this.windowContext.document,o=r.createElement("link");return o.rel="stylesheet",o.type="text/css",o.href=e,o.onload=()=>{t()},o.onerror=()=>n(new Error(`Failed to download the style sheet at url: ${e}.`)),r.head.appendChild(o),o}))}async loadImportMap(e){const t=this.windowContext.document.createElement("script");t.type="importmap",t.textContent=e,this.windowContext.document.head.appendChild(t)}async loadScript(e,t){const n=await this.providers.LoopTrustedTypesPolicy;t?await new Promise(((t,r)=>{const o=this.windowContext.document.createElement("script"),i=n?.createScriptURL(e,{allowedScriptOrigins:[window.origin]})??e;o.src=i,o.async=!1,o.type="module",o.onload=t,o.onerror=()=>r(new Error(`Failed to download the script at url: ${e}`)),this.windowContext.document.head.appendChild(o)})):await ln(this.windowContext,e,{trustedTypesPolicy:n,allowedOrigins:[window.origin]})}async load(e){if(!this.canLoad(e))throw new Error("Incompatible loop code details.");const t=Wt(this.windowContext),n=t.get(Ct);if(n)return n.then((t=>{const{version:n,audience:r}=t,o=function(e){const t=parseFloat(e);if(!Number.isNaN(t)&&Number.isFinite(t))return t}(n);return o&&o<20250618005&&"Local"!==r?this.#e(e).then((e=>this.#t(e))):this.#t(t)}));const r=this.#e(e);t.set(Ct,r);try{const{moduleWithDetails:e}=await r;return e}catch(e){throw t.delete(Ct),e}}async#t(e){if(e.audience!==this.audienceToUse&&"Local"!==this.audienceToUse){const t=await this.providers.NamespaceLogger;t&&(0,De.hO)(t,{eventName:"LwcCodeLoaderAudienceMismatch",audienceToUse:this.audienceToUse,isPrBuild:this.scriptVersionOverride?.isPrBuild,cacheEntryAudience:e.audience})}return e.moduleWithDetails}async#e(e){try{return await this.loadInternal(this.audienceToUse,e)}catch(t){if("Local"===this.audienceToUse&&this.audienceToUse!==this.hostRequestedAudience)return this.audienceToUse=this.hostRequestedAudience,await this.loadInternal(this.hostRequestedAudience,e);throw t}}async loadInternal(e,t){if("Automation"===e){const n=await s.e(634).then(s.bind(s,4326));return this.windowContext[Ct]={loopExport:n.loopExport},{audience:e,moduleWithDetails:{module:n,details:t},version:Number.MAX_SAFE_INTEGER.toString()}}const n=dn(e),r=((e,t,n)=>{if(t?.getSetting("bohemiaCodeLoader.environmentSpecificCDNs",!0)??1){let t;switch(e){case"DoD":t=mn;break;case"GccHigh":t=gn;break;case"USNat":t=yn;break;case"USSec":t=bn;break;case"Gallatin":t=vn;break;case"Bleu":t=Sn;break;default:t=fn}return n&&((0,De.Ot)(n,{eventName:"DefaultAllowedCodeOrigins",environment:e}),0===t.length&&(0,De.hO)(n,{eventName:"DefaultAllowedCodeOriginsEmptyEnvironment"},"{message: ${deploymentRing} environment does not have any default code origins}")),t}return wn})(n),o=await this.providers.NamespaceLogger;let i;const a="Local"===e?[...r,..._n]:r;if(this.scriptVersionOverride){const t=(await Yt(Ct,n,a,zn,o)).codeDetailsPackage;i=t&&t.version===this.scriptVersionOverride.buildVersion?t:await this.getCodeDetailsFromNetworkAndUpdateCache(e,o).codePackagePromise}else i=await cn(Ct,n,a,(async()=>this.getCodeDetailsFromNetworkAndUpdateCache(e,o).codePackagePromise),zn,o);const{baseUrl:c,...l}=i;if(l.importMap&&await this.loadImportMap(JSON.stringify(l.importMap)),!Array.isArray(l.bootResources)||0===l.bootResources.length)throw new Error("No boot resources found in manifest.");"object"==typeof l.globals&&null!==l.globals&&(Object.entries(l.globals).forEach((([e,t])=>{this.windowContext[e]=t})),"Development"===this.hostRequestedAudience&&"Staging"===e?this.windowContext.__loop_audience_override__="Development":this.windowContext.__loop_audience_override__=void 0),"Local"!==e&&"Development"!==e||this.windowContext===window||(this.windowContext.__REACT_DEVTOOLS_GLOBAL_HOOK__=window.__REACT_DEVTOOLS_GLOBAL_HOOK__),await Promise.all(l.bootResources.map((async e=>{const t=new URL(e,c);if(t.pathname.endsWith(".css"))await this.loadStylesheet(t.href);else if(t.pathname.endsWith(".js"))await this.loadScript(t.href,!!l.importMap);else{const e=await this.providers.NamespaceLogger;e?.send({eventName:"UnsupportedFilesinManifest",category:"error"})}})));const u=this.windowContext[Ct];if(!u)throw new Error("Could not fetch loop module from the window object.");return{audience:e,moduleWithDetails:{module:u,details:t},version:i.version}}async preCache(e){if(e!==Ct)return;const t=await this.providers.NamespaceLogger;return await this.getCodeDetailsFromNetworkAndUpdateCache(this.audienceToUse,t).cacheUpdatePromise}}const Wn={instantiateLoopCodeLoader:e=>Promise.resolve(new Hn(e))};class Gn{constructor(e){this.config=e,this.codeLoadersCache=new Map}canLoad(e){return this.config.codeLoaders.has(e.packageName)}async load(e){const t=e.packageName,n=this.codeLoadersCache.get(t);if(n)return n.load(e);if(!this.canLoad(e))throw new Error("Codeloader does not know how to load from this source");return(await this.createLoader({packageName:t})).load(e)}async createLoader(e){const t=e.packageName,{codeLoaders:n,...r}=this.config,o=n.get(t);if(!o)throw new Error(`Could not get code loader factory for registrationId: ${t}`);const i=await o.then(),s=await i.instantiateLoopCodeLoader(r);if(!s.canLoad(e))throw new Error("Could not create loader Codeloader");return this.codeLoadersCache.set(t,s),s}async preCache(e){const t=this.codeLoadersCache.get(e);if(t)return void await(t.preCache?.(e));const n=await this.createLoader({packageName:e});await(n.preCache?.(e))}}class Vn{constructor(e){this.getLoopCodeLoaderFactory=async()=>{if(!this.factory)throw new Error("Loop Code Loader Bundle is already disposed");return this.factory},this.factory=new rt.I((async()=>({instantiateLoopCodeLoader:async t=>new Gn({...t,codeLoaders:e})})))}async dispose(){delete this.factory}get Disposable(){return this}get LoopCodeLoaderFactoryProvider(){return this}}const Qn=(e,t,n)=>{const r=R("useUserAppEligibilities",!1);return{get CopilotConfigurationContext(){return this},get Disposable(){return this},dispose(){},scenarioName:e,sourceName:"OneNoteCopilotNotebook",bizChatFeedbackClientName:"NotebooksOneNoteWin32",m365ChatFeatureSettings:n,eligibilityInformation:r?t.getUserEligibilityInformation():void 0}};function Jn(e){switch(e){case"ar-sa":case"fa-ir":case"he-il":case"ug-cn":case"ur-pk":return"rtl";default:return"ltr"}}function Kn(e){const t=function(e){return Jn(e)}(e);return{get InternationalizationContext(){return this},uiLocale:e,defaultContentDirection:t,get Disposable(){return this},dispose(){}}}var Yn=s(9307);class Xn extends Ve{constructor(){super(...arguments),this.injectedSettings=new Map}getSetting(e,t,n){return this.injectedSettings.has(e)?this.injectedSettings.get(e):super.getSetting(e,t,n)}setSetting(e,t){this.injectedSettings.set(e,t)}}var Zn,er=s(9307);!function(e){e.HostAudienceGroup="HostAudienceGroup",e.LaunchDocUrl="LaunchDocUrl",e.LaunchDocUrlRequiresRedeem="LaunchDocUrlRequiresRedeem",e.LaunchPodId="LaunchPodId",e.LaunchSpoId="LaunchSpoId",e.LoopAudienceOverride="LoopAudienceOverride",e.IsUILessLoad="IsUILessLoad",e.IsCopilotPremiumIdentity="IsCopilotPremiumIdentity"}(Zn||(Zn={}));const tr=Z(),nr=Z();class rr{static getSetting(e,t){var n;return null!==(n=Office.context.document.settings.get(e))&&void 0!==n?n:t}static getLocale(e){var t;return null!==(t=Office.context.displayLanguage)&&void 0!==t?t:e}static getPlatform(){switch(Office.context.platform){case Office.PlatformType.PC:return"Win32";case Office.PlatformType.OfficeOnline:return"Web";case Office.PlatformType.Mac:return"Mac";case Office.PlatformType.iOS:return"iOS";case Office.PlatformType.Android:return"Android";default:return"Win32"}}static getCorrelationId(){var e;return null!==(e=Office.context.document.settings.get("HostCorrelationId"))&&void 0!==e?e:nr}static getSessionId(){var e;return null!==(e=Office.context.document.settings.get("HostSessionId"))&&void 0!==e?e:tr}static isUILessLoad(){return er.log(`Force Render: ${rr.forceRender}`),!rr.forceRender&&rr.getSetting(Zn.IsUILessLoad,!1)}static clearOnRenderSettings(){Office.context.document.settings.remove(Zn.IsUILessLoad),Office.context.document.settings.remove(Zn.LaunchDocUrl),Office.context.document.settings.remove(Zn.LaunchDocUrlRequiresRedeem),Office.context.document.settings.remove(Zn.LaunchPodId),Office.context.document.settings.remove(Zn.LaunchSpoId)}}rr.forceRender=!1;class or{constructor(){this.Disposable=this}dispose(){}get TelemetryConfig(){return this}get disallowServiceTelemetry(){return!1}get hostCorrelationId(){return rr.getCorrelationId()}get hostSessionId(){return rr.getSessionId()}}var ir=s(309),sr=s.n(ir),ar=s(9307);class cr extends(sr()){constructor(){super(),this.themeChangeHandler=e=>{ar.log("Theme changed: ",e),this.setThemeName(e),this.emit("themeNameChanged")},this.registerThemeChangeHandler=async()=>{const e=Office.context;(null==e?void 0:e.themeManager)&&await e.themeManager.addHandlerAsync(Office.EventType.OfficeThemeChanged,this.themeChangeHandler)},this.unRegisterThemeChangeHandler=async()=>{const e=Office.context;(null==e?void 0:e.themeManager)&&await e.themeManager.removeHandlerAsync(Office.EventType.OfficeThemeChanged,this.themeChangeHandler)},this.setThemeName(),this.registerThemeChangeHandler()}get Theming(){return this}get Disposable(){return this}setThemeName(e){const t=window.matchMedia("(forced-colors: active)").matches;if(ar.log("Theme changed: isHighContrast",t),t)return void(this.themeName="high-contrast");const n=(e?e.officeTheme:Office.context.officeTheme).isDarkTheme;this.themeName=n?"dark":"default"}dispose(){this.unRegisterThemeChangeHandler()}}var lr=s(9307);class ur{constructor(e){this.appWorkspaceManager=e,this.UrlHandlerProvider=this}onClick(e,t,n){return lr.log("OneNoteHandler clicked "+e),this.appWorkspaceManager.appNavigateToResourceLinkInClient({linkUrl:e.toString()}).then((()=>Promise.resolve(!0))).catch((e=>(lr.log("appNavigateToResourceLinkInClient threw an error: ",e),Promise.resolve(!1))))}get Disposable(){return this}dispose(){lr.log("dispose")}}var dr=s(9307);class pr extends M{get LoopTelemetrySink(){return this}get Disposable(){return this}dispose(){dr.log("Disposing Telemetry Sink")}}var hr=s(9307);class fr{getDependencySynthesizer(){return this.dependencySynthesizer||(this.dependencySynthesizer=new lt),this.dependencySynthesizer}async registerProviders(e,t,n,r,o,i,s){var a;const c=this.getDependencySynthesizer();c.register("InternationalizationContext",Kn(o)),c.register("LoopCodeLoaderFactoryProvider",new Vn(new Map([[Ct,Promise.resolve(Wn)]]))),c.register("LoopTelemetrySink",new pr),c.register("NamespaceLogger",r),c.register("SettingsProvider",function(e,t){const n=new Xn({ecsFilters:{audience:e.audience,userContext:t},hostName:"Office"});n.setSetting("loopApp.isNotebooksExperienceEnabled",!0),n.setSetting("loopApp.isOneNoteNavbarEnabled",!0),n.setSetting("loopApp.isResetOnNavigationEnabled",!0),n.setSetting("loopApp.isNotebooksPodcastEnabled",!0),n.setSetting("loopApp.shouldCheckBizPolicyForNotebookCreation",!0),n.setSetting("loopApp.isOneNoteSuggestionPrioritizationEnabled",!0);const r=R("useL2NavRefresh",!1);n.setSetting("loopApp.isL2NavRefreshEnabled",r);const o=R("useShadowCopilotNotebookOption",!1);n.setSetting("loopApp.isSuggestedPagesToolbarEnabled",o),n.setSetting("loopApp.isNotebookWeeklyReportGenerationEnabled",o),n.setSetting("loopApp.isCPNBCreateWeeklyReportAutomaticGenerationEnabled",o),n.setSetting("loopApp.isCPNBCreateAutoSummaryGenerationEnabled",o);const i=R("useOneNoteBrandColorTheming",!1);return n.setSetting("loopApp.isOneNoteBrandColorThemingEnabled",i),Yn.log("Loop settings injected:",n),n}(n,t.getUserContext())),c.register("Theming",new cr),c.register("TokenProvider",t),c.register("UserContext",t.getUserContext()),c.register("BizChatTokenProvider",t.bizChatAuthService),c.register("TelemetryConfig",new or);let l;if(R("useOneNoteUrlHandlerProvider",!1)&&c.register("UrlHandlerProvider",new ur(e)),F("useM365ChatSettingsProvider")){l=await i.getAllM365ChatFeatureSettings();const e=null!==(a=null==l?void 0:l.appVersion)&&void 0!==a?a:"Unknown";x.Instance.logEvent("M365ECSChatVersion",{ChatVersion:e}),hr.log("ECS Chat Version",e)}const u="Consumer"===t.identityType,d=rr.getSetting(Zn.IsCopilotPremiumIdentity,!1);return c.register("CopilotConfigurationContext",Qn(((e,t=!1)=>e?t?"OneNoteCopilotNotebookPremiumConsumer":"OneNoteCopilotNotebookPaidConsumer":"OneNoteCopilotNotebook")(u,d),s,l)),c}unregisterProviders(){this.dependencySynthesizer&&(this.dependencySynthesizer.unregister("CopilotConfigurationContext"),this.dependencySynthesizer.unregister("InternationalizationContext"),this.dependencySynthesizer.unregister("LoopCodeLoaderFactoryProvider"),this.dependencySynthesizer.unregister("LoopTelemetrySink"),this.dependencySynthesizer.unregister("NamespaceLogger"),this.dependencySynthesizer.unregister("SettingsProvider"),this.dependencySynthesizer.unregister("Theming"),this.dependencySynthesizer.unregister("TokenProvider"),this.dependencySynthesizer.unregister("UserContext"),this.dependencySynthesizer.unregister("BizChatTokenProvider"),this.dependencySynthesizer.unregister("TelemetryConfig"),this.dependencySynthesizer.unregister("UrlHandlerProvider"),this.dependencySynthesizer=void 0)}}const gr="P_9fecbd01-40ef-80ac-c59c-2560f77a60f1",mr="P_4dde49eb-738b-c12a-b9b5-e3814603a51a";function vr(e){return e.length>0&&void 0!==e[0].eligibility}var yr=s(9307);class br{constructor(e){this.hostAuthService=e}getBaseUrl(){const e=G(),t=ke(this.hostAuthService.getIdentity());let n=we("METAOS",t,e);return n||(n="https://titles.prod.mos.microsoft.com"),`${n}/catalog/v1`}async makeAuthenticatedRequest(e,t={}){return Qe.runActivity("UserEligibilityServiceAPICall",(async()=>{const n=await this.hostAuthService.getOfficeFirstPartyAuthResultByTokenType("METAOS");if(!(null==n?void 0:n.accessToken))throw new Error("Failed to obtain MetaOS access token");const r=`${this.getBaseUrl()}${e.startsWith("/")?e:`/${e}`}`,o={Authorization:`Bearer ${n.accessToken}`,...t.headers},i=await fetch(r,{...t,headers:o});if(!i.ok)throw new Error(`API request failed: ${i.status} ${i.statusText}`);const s=await i.json();if(!function(e){return!(!e||"object"!=typeof e||"string"!=typeof e.idType||!Array.isArray(e.eligibilities)||"number"!=typeof e.nextInterval)}(s))throw new Error("Invalid MetaOS eligibility response");return s}))}async makeEligibilityRequest(){var e;const t={IdType:"TitleId",Identifiers:[ve(null===(e=this.hostAuthService.getIdentity())||void 0===e?void 0:e.identityType)?gr:mr]},n={method:"POST",headers:{"X-Office-Application":"172"},body:JSON.stringify(t)};return this.makeAuthenticatedRequest("/users/titles/eligibilities",n)}async getUserEligibilityInformation(){if(this.userEligibilities&&!this.userEligibilities.isError)return this.userEligibilities;if(this.userEligibilitiesPromise||this.populateUserEligibilityInformation(),await this.userEligibilitiesPromise,this.userEligibilities)return this.userEligibilities;throw new Error("User eligibility information not available")}populateUserEligibilityInformation(){if(this.userEligibilitiesPromise)return;this.userEligibilitiesPromise=(async()=>{try{await Qe.runActivity("PopulateUserEligibilityInformation",(async e=>{let t=await this.makeEligibilityRequest();if(e.addData("hasEligibilities",t.eligibilities.length>0),e.addData("nextInterval",t.nextInterval),!vr(t.eligibilities)){const e=Math.min(t.nextInterval,20);if(await new Promise((t=>setTimeout(t,1e3*e))),t=await this.makeEligibilityRequest(),!vr(t.eligibilities))throw new Error(`No eligibility information found after retry for ${e} seconds`)}this.userEligibilities=function(e){var t,n,r,o,i,s,a,c,l,u;if(void 0===e.eligibility)throw new Error("Invalid MetaOSEligibility: eligibility is undefined");const d=null!==(n=null===(t=e.eligibility.cohort)||void 0===t?void 0:t.toLowerCase())&&void 0!==n?n:"none",p=null!==(i=null===(o=null===(r=e.eligibility.userClassification)||void 0===r?void 0:r.persona)||void 0===o?void 0:o.toLowerCase())&&void 0!==i?i:"none",h=null!==(a=null===(s=e.eligibility.ageGroup)||void 0===s?void 0:s.toLowerCase())&&void 0!==a?a:"none",f=null!==(u=null===(l=null===(c=e.eligibility.userClassification)||void 0===c?void 0:c.eduType)||void 0===l?void 0:l.toLowerCase())&&void 0!==u?u:"none";return{cohort:d,persona:p,ageGroup:h,isCopilotEnabledRegion:e.eligibility.isCopilotEnabledRegion,isCopilotEligible:e.eligibility.isCopilotEligible,isOptedOutByAdmin:e.eligibility.isOptedOutByAdmin,eduType:f,isError:!1,featureSet:e.eligibility.featureSet}}(t.eligibilities[0]),this.userEligibilitiesPromise=void 0}))}catch(e){yr.error("Error populating user eligibility information:",e),this.userEligibilitiesPromise=void 0,this.userEligibilities={cohort:"none",persona:"none",ageGroup:"none",isCopilotEnabledRegion:!1,isCopilotEligible:!1,isOptedOutByAdmin:!1,eduType:"none",isError:!0,featureSet:{}},x.Instance.logError("UserEligibilityServiceError",e,{ErrorMethod:"getUserEligibilitiesWithRetryPromise"})}})()}}const Sr="0",wr="";function Cr(e,t){var n,r;return{title:e.title,podId:e.mfsPodId,spoId:e.spoId,isFavorite:e.isFavorite,lastOpened:"string"==typeof e.lastOpened?Date.parse(e.lastOpened)||0:null!==(r=null===(n=e.lastOpened)||void 0===n?void 0:n.getTime())&&void 0!==r?r:0,forceSetAsSelected:t}}var Er=s(9307);const kr="navigateTo";class Pr extends ir.EventEmitter{constructor(){super(...arguments),this.workspaceMap=new Map,this.forceSelectNextAdd=!1}clearActivePageParams(){this.activePageParams=void 0}canNavigate(e){if(!F("useBypassNavigation"))return!0;if("page"!==e.route)return!0;const t=this.getActivePageParams();return!t||(e.docUrl!==t.docUrl||e.mfsPodId!==t.podId)}setActivePageParams(e,t){this.activePageParams={docUrl:e,podId:t}}getActivePageParams(){return this.activePageParams}async Reset(){return this.workspaceMap.clear(),Promise.resolve()}async DeleteNotebook(e){const t=Date.now();try{if(!this.workspaceAndPageManager)throw new Error("Workspace Manager instance of component manager not set");await this.workspaceAndPageManager.deleteWorkspace(e);const n=Date.now()-t;Er.log(`DeleteNotebook returned in ${n}ms:`,e)}catch(e){const n=Date.now()-t;return Er.error(e),x.Instance.logError("WorkspaceManagerError",e,{ErrorMethod:"DeleteNotebook",ErrorDetails:"Error Deleting Notebook",Duration:n}),Promise.reject("Error Deleting Notebook")}}async RenameNotebook(e,t){const n=Date.now();try{if(!this.workspaceAndPageManager)throw new Error("Workspace Manager instance of component manager not set");await this.workspaceAndPageManager.renameWorkspace(e,t);const r=Date.now()-n;Er.log(`RenameNotebook returned in ${r}ms:`,e,t)}catch(e){const t=Date.now()-n;return Er.error(e),x.Instance.logError("WorkspaceManagerError",e,{ErrorMethod:"RenameNotebook",ErrorDetails:"Error Renaming Notebook",Duration:t}),Promise.reject("Error Renaming Notebook")}}async ToggleFavoriteNotebook(e){const t=Date.now();try{if(!this.workspaceAndPageManager)throw new Error("Workspace Manager instance of component manager not set");await this.workspaceAndPageManager.toggleFavoriteWorkspace(e);const n=Date.now()-t;Er.log(`ToggleFavoriteNotebook returned in ${n}ms:`,e)}catch(e){const n=Date.now()-t;return Er.error(e),x.Instance.logError("WorkspaceManagerError",e,{ErrorMethod:"ToggleFavoriteNotebook",ErrorDetails:"Error toggling favorite on Notebook",Duration:n}),Promise.reject("Error toggling favorite on Notebook")}}async NavigateTo(e){var t;if(!this.canNavigate(e))return void Er.log("Skipping navigation due to active page params match:",e);this.emit(kr),this.clearActivePageParams(),Er.log("Requesting component navigation:",e);const n=Date.now();await(null===(t=this.workspaceNavigationHandler)||void 0===t?void 0:t.navigateTo(e).then((()=>{const t=Date.now()-n;x.Instance.logEvent("NavigateTo",{NavRoute:e.route,Duration:t}),"page"===e.route&&e.mfsPodId&&this.setActivePageParams(e.docUrl,e.mfsPodId)})).catch((e=>{const t=Date.now()-n;throw Er.error("navigateTo API failed:",e),x.Instance.logError("WorkspaceManagerError",e,{ErrorMethod:"NavigateTo",ErrorDetails:"navigateTo API failed",Duration:t}),e})))}async AddReferenceTo(e,t,n){try{if(!this.workspaceAndPageManager)throw new Error("Workspace Manager instance of component manager not set");if(t.length!==n.length)throw new Error("Reference URLs and titles arrays must have the same length");const r=[];for(let o=0;o<t.length;o++)r.push(this.workspaceAndPageManager.addPageToWorkspace(t[o],n[o],e));await Promise.all(r),q.addReferenceToNotebookResultStatus({success:!0})}catch(e){const n=new Error("Failed to add a reference to notebook");return x.Instance.logError("WorkspaceManagerError",n,{ErrorMethod:"AddReferenceTo",ErrorDetails:"Error while adding "+t.length+" references to notebook"}),Er.error(n),q.addReferenceToNotebookResultStatus({success:!1}),Promise.reject("Error adding reference to workspace")}}async ProcessWorkspaces(){try{if(!this.workspaceAndPageManager)throw new Error("Workspace Manager instance of component manager not set");const e=Date.now(),t=await this.workspaceAndPageManager.getWorkspaces(),n=[];this.workspaceMap.clear(),t.forEach((e=>{void 0!==e.mfsPodId&&void 0!==e.spoId&&(n.push(e),this.workspaceMap.set(e.mfsPodId,e))}));const r=Date.now()-e;Er.log(`GetWorkspaces returned ${n.length} viable workspaces out of ${t.length} total workspaces in ${r}ms.`),x.Instance.logEvent("GetWorkspaces",{TotalWorkspaceCount:t.length,ViableWorkspaceCount:n.length,Duration:r});const o={workspaces:n.map((e=>Cr(e,!1)))};B.setWorkspaces(o).catch((e=>{throw Er.error(e),x.Instance.logError("DataActionError",e,{ErrorMethod:"ProcessWorkspaces",ErrorDetails:"Failed to notify client of data action event",ErrorEvent:"setWorkspaces"}),e}))}catch(e){return x.Instance.logError("WorkspaceManagerError",e,{ErrorMethod:"ProcessWorkspaces",ErrorDetails:"Error processing workspaces"}),Er.error(e),B.failedToProcessWorkspaces().catch((e=>{Er.error(e),x.Instance.logError("DataActionError",e,{ErrorMethod:"failedToProcessWorkspaces",ErrorDetails:"Failed to notify client of data action failure"})})),Promise.reject("Error processing workspaces")}}async GetWorkspaceForPage(e){const t=Date.now();try{if(!this.workspaceAndPageManager)throw new Error("Workspace Manager instance of component manager not set");const n=await this.workspaceAndPageManager.getWorkspaceForPage(e),r=Date.now()-t;return Er.log(`GetWorkspaceForPage returned in ${r}ms:`,n),x.Instance.logEvent("GetWorkspaceForPage",{FoundWorkspace:void 0!==n,Duration:r}),n}catch(e){const n=Date.now()-t;return Er.error(e),x.Instance.logError("WorkspaceManagerError",e,{ErrorMethod:"GetWorkspaceForPage",ErrorDetails:"Error getting workspace for page",Duration:n}),Promise.reject("Error getting workspace for page")}}SetWorkspaceAndPageManager(e){this.workspaceAndPageManager=e}SetWorkspaceNavigationHandler(e){this.workspaceNavigationHandler=e}async onWorkspaceListChangedEvent(e){Er.log("Workspace List Changed event:",e);try{let t;Er.log("Workspace List Changed event type:",e.type);const n=e.type,r=this.forceSelectNextAdd;switch(n){case"add":if(t=e.workspace,void 0===t)throw new Error(`Undefined workspace for workspaceListChanged event type: ${e.type}`);if(void 0===t.mfsPodId)throw new Error(`Malformed workspace podId for event type: ${e.type}`);if(void 0===t.spoId)throw new Error(`Malformed workspace spoId for event type: ${e.type}`);this.forceSelectNextAdd=!1,this.workspaceMap.set(t.mfsPodId,t),B.updateWorkspace(Cr(t,r)).catch((t=>{throw Er.error(t),x.Instance.logError("DataActionError",t,{ErrorMethod:"onWorkspaceListChangedEvent",ErrorDetails:"Failed to notify client of data action event",ErrorEvent:e.type}),t}));break;case"update":if(t=e.workspace,void 0===t)throw new Error(`Undefined workspace for workspaceListChanged event type: ${e.type}`);if(void 0===t.mfsPodId)throw new Error(`Malformed workspace podId for event type: ${e.type}`);if(void 0===t.spoId)throw new Error(`Malformed workspace spoId for event type: ${e.type}`);this.workspaceMap.set(t.mfsPodId,t),B.updateWorkspace(Cr(t,!1)).catch((t=>{throw Er.error(t),x.Instance.logError("DataActionError",t,{ErrorMethod:"onWorkspaceListChangedEvent",ErrorDetails:"Failed to notify client of data action event",ErrorEvent:e.type}),t})),B.renameWorkspace(Cr(t,!1)).catch((e=>{throw Er.error(e),x.Instance.logError("DataActionError",e,{ErrorMethod:"onWorkspaceListChangedEvent",ErrorDetails:"Failed to notify client of data action event",ErrorEvent:"rename"}),e}));break;case"remove":if(void 0===e.mfsPodId)throw new Error(`Malformed workspace podId for event type: ${e.type}`);this.workspaceMap.delete(e.mfsPodId),B.removeWorkspace(Cr(e,!1)).catch((t=>{throw Er.error(t),x.Instance.logError("DataActionError",t,{ErrorMethod:"onWorkspaceListChangedEvent",ErrorDetails:"Failed to notify client of data action event",ErrorEvent:e.type}),t}));break;default:throw new Error(`Unhandled workspaceListChanged event type: ${n}`)}}catch(t){return x.Instance.logError("ComponentDataWorkspaceListChangedEventError",t,{ErrorMethod:"onWorkspaceListChangedEvent",ErrorDetails:`Error handling workspaceListChanged event type: ${e.type}`}),Er.error(t,e),Promise.reject("Error handling workspaceListChanged event")}}async onComponentNavigationEvent(e){this.clearActivePageParams(),Er.log("Component navigation event:",e),this.forceSelectNextAdd&&(Er.log("Canceling next add notification for client UI selection due to navigation event"),this.forceSelectNextAdd=!1);try{if("notebooks"===e.route)q.navigateToHomeEvent().catch((t=>{Er.error(t,e),x.Instance.logError("NotifyClientError",t,{ErrorMethod:"onComponentNavigationEvent",ErrorDetails:"Failed to notify client of navigation event",NavigationRoute:e.route})}));else if("notebook"===e.route){if("createId"in e)return Er.log("Marking next add notification for client UI selection"),void(this.forceSelectNextAdd=!0);q.navigateToNotebookEvent(function(e){var t;return{podId:e.mfsPodId,spoId:null!==(t=e.spoId)&&void 0!==t?t:wr}}(e)).catch((t=>{Er.error(t,e),x.Instance.logError("NotifyClientError",t,{ErrorMethod:"onComponentNavigationEvent",ErrorDetails:"Failed to notify client of navigation event",NavigationRoute:e.route})}))}else if("createNotebook"===e.route)q.navigateToCreateNotebookEvent(function(e){const t={linkedChats:[],linkedPages:[]};if(void 0!==e.linkedChats&&Array.isArray(e.linkedChats)){const n=e.linkedChats.map((e=>function(e){return{conversationId:e.conversationId}}(e)));t.linkedChats=n}if(void 0!==e.linkedPages&&Array.isArray(e.linkedPages)){const n=e.linkedPages.map((e=>function(e){return{docUrl:e.docUrl}}(e)));t.linkedPages=n}return t}(e)).catch((t=>{Er.error(t,e),x.Instance.logError("NotifyClientError",t,{ErrorMethod:"onComponentNavigationEvent",ErrorDetails:"Failed to notify client of navigation event",NavigationRoute:e.route})}));else{if("page"!==e.route)throw new Error(`Unhandled component navigation event: ${e.route}`);void 0!==e.mfsPodId&&this.setActivePageParams(e.docUrl,e.mfsPodId),q.navigateToPageEvent(function(e,t){var n,r;return{title:null!=t?t:"",docUrl:e.docUrl,podId:null!==(n=e.mfsPodId)&&void 0!==n?n:wr,requiresRedeem:null!==(r=e.requiresRedeem)&&void 0!==r&&r}}(e)).catch((t=>{Er.error(t,e),x.Instance.logError("NotifyClientError",t,{ErrorMethod:"onComponentNavigationEvent",ErrorDetails:"Failed to notify client of navigation event",NavigationRoute:e.route})}))}}catch(t){return x.Instance.logError("ComponentNavigationEventError",t,{ErrorMethod:"onComponentNavigationEvent",ErrorDetails:`Error handling navigation event for route: ${e.route}`}),Er.error(t,e),Promise.reject("Error handling navigation event")}}}var Tr=s(9307);class Nr{constructor(e,t){this.authService=e,this.dependencySynthesizerService=t,this.workspaceManager=new Pr,this.workspaceManager.on(kr,(()=>{var e;null===(e=this.onNavigationEvent)||void 0===e||e.call(this)}))}getWorkspaceManager(){return this.workspaceManager}setWorkspaceAndPageManager(e){this.workspaceManager.SetWorkspaceAndPageManager(e)}setWorkspaceNavigationHandler(e){this.workspaceManager.SetWorkspaceNavigationHandler(e)}setOnNavigationEvent(e){this.onNavigationEvent=e}async appInitialize(){await this.authService.initializePreAuthz()}async appLoadDataModels(){await this.workspaceManager.ProcessWorkspaces()}async appOnIdentityChange(){await this.appInitialize()}async appNavigateToHome(){await this.workspaceManager.NavigateTo({route:"notebooks"})}async appAddReferenceToNotebook(e){await this.workspaceManager.AddReferenceTo(e.podId,e.refUrls,e.refTitles)}async appNavigateToCreateNotebook(e){const t={route:"createNotebook",linkedChats:[],linkedPages:[]};e.chatConversationIds&&(t.linkedChats=e.chatConversationIds.map((e=>({conversationId:e})))),e.pageDocUrls&&(t.linkedPages=e.pageDocUrls.map((e=>({docUrl:e})))),await this.workspaceManager.NavigateTo(t)}async appRequestDeleteNotebook(e){const t=e.podId;await this.workspaceManager.DeleteNotebook(t)}async appNavigateToNotebook(e){const t=e.podId,n=e.spoId;if(t===wr||t===Sr)return void await this.appNavigateToHome();const r={route:"notebook",mfsPodId:t,spoId:n!==wr&&n!==Sr?n:void 0};await this.workspaceManager.NavigateTo(r)}async appNavigateToPage(e){var t;const n=null!==(t=e.podId)&&void 0!==t?t:wr;if(n===wr||n===Sr)return void await this.appNavigateToHome();const r=e.docUrl,o=e.requiresRedeem;if(""===r||"0"===r)return void await this.appNavigateToNotebook({podId:n});const i={route:"page",mfsPodId:n,requiresRedeem:o,docUrl:r};await this.workspaceManager.NavigateTo(i)}async appNavigateToSearchResult(e){var t,n,r,o;let i="",s="";try{const{siteUrl:a}=e,c=/\/drives\/(?<Drive>[^/]+)\/items\/(?<Item>[^/]+)/.exec(a);if(null!==c&&(i=null!==(n=null===(t=c.groups)||void 0===t?void 0:t.Drive)&&void 0!==n?n:"",s=null!==(o=null===(r=c.groups)||void 0===r?void 0:r.Item)&&void 0!==o?o:""),""===i||""===s)throw new Error("Search result missing required ODSP locator parameters");const l={siteUrl:a,driveId:i,fileId:s};x.Instance.logEvent("NavigateToSearchResult",{HasDrive:""!==i,HasItem:""!==s});const u={siteUrl:a,driveId:i,itemId:s,dataStorePath:"/"},d=new URL(a);(0,gt.Cu)(d,u),await this.navigateToPageOdspLink(d,u,l),q.navigateToSearchResultStatus({...e,navSuccess:!0}).catch((t=>{Tr.error(t,e),x.Instance.logError("NotifyClientError",t,{ErrorMethod:"navigateToSearchResultStatus",ErrorDetails:"Failed to notify client of status",HasDrive:""!==i,HasItem:""!==s,NavigationSuccess:!0})}))}catch(t){return Tr.error(t,e),x.Instance.logError("NavigateToSearchResultError",t,{ErrorMethod:"appNavigateToSearchResult",ErrorDetails:"Failed to navigate to search result",HasDrive:""!==i,HasItem:""!==s}),q.navigateToSearchResultStatus({...e,navSuccess:!1}).catch((t=>{Tr.error(t,e),x.Instance.logError("NotifyClientError",t,{ErrorMethod:"navigateToSearchResultStatus",ErrorDetails:"Failed to notify client of status",HasDrive:""!==i,HasItem:""!==s,NavigationSuccess:!1}),q.failedToNavigateToSearchResult({...e,navSuccess:!1}).catch((t=>{Tr.error(t,e),x.Instance.logError("NotifyClientError",t,{ErrorMethod:"failedToNavigateToSearchResult",ErrorDetails:"Failed to notify client of status",HasDrive:""!==i,HasItem:""!==s,NavigationSuccess:!1})}))})),Promise.reject("Failed to navigate to search result")}}async appNavigateToLink(e){var t,n;const{linkUrl:r}=e;let o=!1,i=!1,s="";try{const a=new URL(r);o=!0,i=null!==a.searchParams.get(gt.jC);const c=/(?<FluidHint>\/:fl:\/[a-z]{1,2}\/)/.exec(r);null!==c&&(s=null!==(n=null===(t=c.groups)||void 0===t?void 0:t.FluidHint)&&void 0!==n?n:""),x.Instance.logEvent("NavigateToLink",{IsValidUrlFormat:o,LinkType:s,HasOdspLocator:i}),Tr.log("Attempting to extract ODSP file locator from link url:",a);const l=(0,gt.Mh)(a,!1);if(!l)throw new Error("Failed to extract ODSP file locator from link url");Tr.log("Extracted ODSP file locator:",l);const u={siteUrl:r,driveId:l.driveId,fileId:l.itemId};await this.navigateToPageOdspLink(a,l,u),q.navigateToLinkStatus({originalUrl:r,navSuccess:!0}).catch((t=>{Tr.error(t,e),x.Instance.logError("NotifyClientError",t,{ErrorMethod:"navigateToLinkStatus",ErrorDetails:"Failed to notify client of status",IsValidUrlFormat:o,LinkType:s,HasOdspLocator:i,NavigationSuccess:!0})}))}catch(t){return Tr.error(t,e),x.Instance.logError("NavigateToLinkError",t,{ErrorMethod:"appNavigateToLink",ErrorDetails:"Failed to navigate to link",IsValidUrlFormat:o,LinkType:s,HasOdspLocator:i}),q.navigateToLinkStatus({originalUrl:r,navSuccess:!1}).catch((t=>{Tr.error(t,e),x.Instance.logError("NotifyClientError",t,{ErrorMethod:"navigateToLinkStatus",ErrorDetails:"Failed to notify client of status",IsValidUrlFormat:o,LinkType:s,HasOdspLocator:i,NavigationSuccess:!1}),q.failedToNavigateToLink({originalUrl:r,navSuccess:!1}).catch((t=>{Tr.error(t,e),x.Instance.logError("NotifyClientError",t,{ErrorMethod:"failedToNavigateToLink",ErrorDetails:"Failed to notify client of status",IsValidUrlFormat:o,LinkType:s,HasOdspLocator:i,NavigationSuccess:!1})}))})),Promise.reject("Failed to navigate to link")}}async appNavigateToResourceLinkInClient(e){const{linkUrl:t}=e;if(!t){const e=new Error("linkUrl not provided");return x.Instance.logError("NotifyClientError",e,{ErrorMethod:"navigateToResourceLinkInClientEvent",NavigationSuccess:!1}),Promise.reject("linkUrl not provided")}q.navigateToResourceLinkInClientEvent({originalUrl:t}).catch((t=>(Tr.error(t,e),x.Instance.logError("NotifyClientError",t,{ErrorMethod:"navigateToResourceLinkInClientEvent",ErrorDetails:"Failed to navigate to resource in client",NavigationSuccess:!1}),Promise.reject("Failed to navigate to link in client"))))}getDependencySynthesizerService(){return this.dependencySynthesizerService}async navigateToPageOdspLink(e,t,n){Tr.log("Calling GetWorkspaceForPage with:",n);const r=await this.workspaceManager.GetWorkspaceForPage(n);if(Tr.log("GetWorkspaceForPage returned:",r),!r)throw new Error("GetWorkspaceForPage returned undefined");(0,gt.Cu)(e,t),await this.appNavigateToPage({docUrl:e.href,podId:r.mfsPodId})}async renameNotebook(e){const t=e.podId,n=e.name;await this.workspaceManager.RenameNotebook(t,n)}async toggleFavoriteNotebook(e){const t=e.podId;await this.workspaceManager.ToggleFavoriteNotebook(t)}}var Ar=s(9307);let Ir;function Or(){return Ir||(Ir=function(){const e=rr.getSetting(Zn.LoopAudienceOverride,"");if(e){const t=function(e){const t=e.toLowerCase(),n=Mr[t];if(!n){const e=new Error("Unhandled Loop audience value");return x.Instance.logError("UnhandledConfigError",e,{ErrorMethod:"getAudienceFromSetting",ConfigDataValue:t,ConfigDataExpectedType:"LoopAudience"}),Ar.error(`Unhandled Loop audience value ${t} - defaulting to Production:`),"Production"}return n}(e);return Ar.log(`Mapped Loop audience: ${t} from setting override value: ${e}`),t}if(function(){const e=G();return"Public"!==e&&"Public1CDN"!==e&&"UNKNOWN"!==e}()){const e=Dr[G()]||"Production";return Ar.log(`Mapped Loop audience: ${e} from sovereign cloud type: ${G()}`),e}const t="Production",n=function(e){const t=e.toLowerCase(),n=xr[t];if(!n){const e=new Error("Unhandled Office audience group value");return x.Instance.logError("UnhandledConfigError",e,{ErrorMethod:"getAudienceGroupFromSetting",ConfigDataValue:t,ConfigDataExpectedType:"OfficeAudienceGroup"}),Ar.error(`Unhandled Office audience group value ${t} - defaulting to Production:`),g.EW.Production}return n}(rr.getSetting(Zn.HostAudienceGroup,t)),r=Lr[n];if(!r){const e=new Error("Unhandled Office audience group to Loop audience mapping");return x.Instance.logError("UnhandledConfigError",e,{ErrorMethod:"getAudienceInternal",ConfigDataValue:n,ConfigDataExpectedType:"OfficeAudienceGroup"}),Ar.error(`Unhandled Office audience group value ${n} for mapping to Loop audience - defaulting to Production:`),"Production"}return Ar.log(`Mapped Loop audience: ${r} from Office audience group: ${n}`),r}(),Ar.log("Using Loop Audience:",Ir)),Ir}const Lr={Automation:"Development",Insiders:"Production",Dogfood:"Dogfood",Microsoft:"Microsoft",Production:"Production"},Dr={GCCM:"GCC",GCCH:"GCC-High",DoD:"DoD",UsSec:"USSec",UsNat:"USNat",Gallatin:"Gallatin",Delos:"Delos",Bleu:"Bleu"};let Rr;function Fr(){return Rr||(Rr=function(){const e=Or();if("Local"===e)return{audience:"Local",ring:"Staging"};return{audience:e}}(),Ar.log("Using Loop Environment:",Rr)),Rr}const Mr={automation:"Automation",bleu:"Bleu",delos:"Delos",development:"Development",dod:"DoD",dogfood:"Dogfood",gallatin:"Gallatin",gcc:"GCC","gcc-high":"GCC-High",local:"Local",microsoft:"Microsoft",preview:"Preview",production:"Production",staging:"Staging",usnat:"USNat",ussec:"USSec"};const xr={automation:g.EW.Automation,dogfood:g.EW.Dogfood,insiders:g.EW.Insiders,microsoft:g.EW.Microsoft,production:g.EW.Production};function _r(e){let t;switch(e.route){case"notebook":t=function(e){const t=wt(e.mfsPodId);return new URL(`/w/home/${pt({w:t})}`,yt)}(e);break;case"notebooks":t=bt;break;case"page":t=St(e);break;case"pages":t=new URL("/pages",yt);break;case"createPage":return function(e){const{body:t,pageTitle:n,notebookMfsPodId:r}=e;return{type:"Data",registrationId:Ct,dataType:"Json",data:{route:"createPage",body:t,pageTitle:n,notebookMfsPodId:r}}}(e);case"createPageFromTemplate":return function(e){const{templateId:t,contentDisplayFlag:n}=e;return{type:"Data",registrationId:Ct,dataType:"Json",data:{route:"createPageFromTemplate",templateId:t,contentDisplayFlag:n}}}(e);case"createNotebook":return function(e){const{linkedChats:t,linkedPages:n,correlationId:r}=e;return{type:"Data",registrationId:Ct,dataType:"Json",data:{route:"createNotebook",linkedChats:t,linkedPages:n,correlationId:r}}}(e)}return{type:"Data",registrationId:Ct,dataType:"URL",data:{url:t}}}const Ur="RenderComponent",jr="PostRender",zr={RenderComponent:"RenderComponentByHost"};class qr{constructor(e,t,n,r,o){this.activityType=e,this.additionalCleanup=r,this.getExtraPropsToLog=o,n?.(),this.logger=new Le.p("HostTracker",t),this.activityTracker=Re.m.start(e,this.logger,{addUserTiming:!0,isAPerformanceMetric:!0}),(0,De.Ot)(this.logger,{eventName:e,subCategory:"HostActivityTrackerCreated"})}static startScenario(e,t,n,r){if(n){const o=qr.startScenario(e,t);return(async()=>{try{const e=await n(o);return o.setSuccess(r?.()),e}catch(e){throw o.setFailure(e,r?.()),e}})()}let o;return new qr(t+"EndToEnd",e,(()=>{o=on();try{const t=e.PersistedProperties?.getPersistedProperties?.().hostScenarioStartTime;if(t&&"number"==typeof t){const e=performance.now()-(Date.now()-t);e>=0&&performance.measure("PreScenarioOverhead",{start:e})}}catch{}}),(()=>{o&&(an(o),o=void 0)}),(()=>({documentHidden:o?sn(o,!0)>-1:""})))}static startActivity(e,t,n,r){if(n){const o=qr.startActivity(e,t);return(async()=>{try{const e=await n();return o.setSuccess(r?.()),e}catch(e){throw o.setFailure(e,r?.()),e}})()}return new qr(zr[t]||t,e)}getLogger(){return this.logger}scenarioEndsAfterRender(){return"LoadEndToEnd"===this.activityType||"PasteEndToEnd"===this.activityType}setSuccess(e){this.activityTracker&&(this.activityTracker.setResult(!0,{...e,...this.getExtraPropsToLog?.()}),this.dispose())}setFailure(e,t){this.activityTracker&&(this.activityTracker.setResult(!1,{...t,...this.getExtraPropsToLog?.(),errorType:e?e.errorType:void 0},e),this.dispose())}cancel(){this.dispose()}dispose(){this.additionalCleanup?.(),this.logger&&(0,De.Ot)(this.logger,{eventName:this.activityType,subCategory:"HostActivityTrackerDisposed"}),this.activityTracker?.dispose(),this.activityTracker=void 0,this.logger=void 0}}const Br="17.1.7",$r="LoadComponentInDiv",Hr="GetDriver",Wr="LoadContainer",Gr="LoadComponentFromContainer",Vr="RequestComponent",Qr="GetTemplateContent",Jr="RehydrateFromTemplateContent",Kr="LoadCodeFromHint",Yr="GetLoopComponentCore",Xr="ContainerPostBootError",Zr="ContainerPackagePreCacheError",eo="GetTemplateContentError",to="UndefinedTemplateContentError",no="ComponentNotSerializableError",ro="ComponentSerializationError",oo="LoadComponentCancelledByHost",io="CodeHintExists",so="OfficeWebHost",ao="LoopExperiences";function co(e){const t=Date.now(),n=on(),{logger:r,...o}=e;return{logger:r&&new Le.p(so,r,{owhVersion:Br}),newConfig:o,perfMetadata:{fluidBootstrapperStartTime:t},documentHiddenTrackerId:n}}const lo="fluid";function uo(e){return e===lo||"fluid-odsp"===e||"fluid-odsp-extended"===e||"fluid-odsp-expansive"===e}var po=s(999),ho=s(5799);function fo(e){return"object"==typeof e&&null!==e&&e.errorType===po.a.locationRedirection}class go extends Error{constructor(e,t,n,r){if(super(e),this.internalError=n,this.name=t,r)try{this.stack=r}catch{}}}class mo extends go{constructor(e,t,n,r){super(e,"ComponentNotFound",t,r),this.code=n}}function vo(e){if("object"!=typeof(t=e)||null===t)return!1;var t;const n=e.errorType,r=e.statusCode;return"fileNotFoundOrAccessDeniedError"===n&&404===r}class yo{constructor(){this[Symbol.toStringTag]="Deferred",this.isPending=!0,this.p=new Promise(((e,t)=>{this.res=e,this.rej=t}))}then(e,t){return this.p.then(e,t)}catch(e){return this.p.catch(e)}resolve(e){this.isPending=!1,this.res(e)}reject(e){this.isPending=!1,this.rej(e)}pending(){return this.isPending}finally(e){return this.p.finally(e)}}var bo=s(9011);const So=(e,t)=>{if(void 0!==e&&void 0!==t)return e-t};var wo=s(7696),Co=s(577);const Eo="Open",ko="PostBoot",Po="FileOpenFailed",To="ComponentLoadError",No="ContainerConnectedTimeout",Ao="ContainerLoadError";var Io=s(915);const Oo="Loading chunk\\s[a-zA-Z0-9_-]+\\sfailed";function Lo(e,t,n,r,o,i,s){const a=new Le.p("QoS",e);(0,De.hO)(a,{eventName:t,pillar:n,veto:r,errorType:o,isAce:!Do(s),...i},s)}function Do(e){if(!e)return!1;const t=e;return!(!t.errorType||![po.a.offlineError,po.a.fileNotFoundOrAccessDeniedError,po.a.authorizationError,Io.E.snapshotTooBig,Io.E.invalidFileNameError,po.a.fileOverwrittenInStorage,No].some((e=>e===t.errorType)))||!(!t.message||!new RegExp(Oo).test(t.message))}const Ro=(e,t,n)=>{(0,Co.t)(6e4,[n]).then((n=>{if(n&&!e.closed){const e=No;Lo(t,Xr,ko,"ContainerConnectFailed",e,{},{message:"Timed out while connecting the container",errorType:e}),(0,De.hO)(t,{eventName:Xr,errorType:e,isUserImpacting:!0},{message:"Timed out while connecting the container",errorType:e})}})).catch((()=>{}))},Fo=(e,t)=>{const n={},r=e.resolvedUrl;r&&"id"in r&&(n.docId=r.id),t.PersistedProperties?.addPersistedProperties(n)},Mo=(e,t)=>{const n=new yo;e.attachState!==wo.d.Attached?e.once("attached",(()=>{Fo(e,t),Ro(e,t,n)})):(Fo(e,t),Ro(e,t,n)),e.once("closed",(n=>{n&&(Lo(t,Xr,ko,"PostBootContainerClosed",n.errorType,{},n),(0,De.hO)(t,{eventName:Xr,errorType:n.errorType||Xr,isUserImpacting:!0,isExpected:vo(n),isDirty:e.isDirty},n))})),e.once("connected",(()=>{n.resolve()}))};function xo(e){return e.replace(/(https:\/\/)(\w)+(.sharepoint.com|-my.sharepoint.com|.sharepoint-df.com|.sharepoint-mil.us|-my.sharepoint-mil.us|.sharepoint.us|-my.sharepoint.us)/,"(redacted)").replace(/(https:\/\/)(dev.loop.microsoft.com|df.loop.microsoft.com|loop.microsoft.com|preview.loop.microsoft.com|loop.cloud.microsoft|loop.cloud-dev.microsoft)(\/p\/)([a-zA-Z0-9%]+)/,"(redacted)")}class _o{constructor(e,t,n,r){this.perfMetadata=t,this.documentHiddenTrackerId=n,this.runtimeLogger=new Le.p("FluidRuntime",e,r)}get Disposable(){return this}get NamespaceLogger(){return this}sendWithNamespace(e,t){this.runtimeLogger.sendWithNamespace(e,t)}send(e){let t=e;if("performance"===e.category){const n=e.duration,r=Date.now(),o="number"==typeof n?r-n:void 0;t={...this.perfMetadata,startTime:o,documentEverHidden:this.documentHiddenTrackerId&&sn(this.documentHiddenTrackerId)>-1,...t}}void 0===t.opMessageAgeMs&&"number"==typeof t.messageTimestamp&&(t={opMessageAgeMs:Date.now()-t.messageTimestamp,...t}),t.message&&(t.message=xo(t.message.toString())),t.stack&&(t.stack=xo(t.stack.toString())),t.error&&(t.error=xo(t.error.toString())),t.errorMessage&&(t.errorMessage=xo(t.errorMessage.toString())),t.responseMessage&&(t.responseMessage=xo(t.responseMessage.toString())),this.runtimeLogger.send(t)}dispose(){this.runtimeLogger.Disposable.dispose()}}function Uo(e){e.closed||e.attachState!==wo.d.Attached&&void 0!==e.attachState||e.connect()}var jo;!function(e){e[e.Disconnected=0]="Disconnected",e[e.EstablishingConnection=3]="EstablishingConnection",e[e.CatchingUp=1]="CatchingUp",e[e.Connected=2]="Connected"}(jo||(jo={}));var zo=s(9873),qo=s(836);const Bo=e=>"object"==typeof e&&"string"==typeof e?.name&&"object"==typeof e?.fluid,$o=e=>{const t=e;return"object"==typeof t&&("string"==typeof t?.package||Bo(t?.package))&&(void 0===t?.config||"object"==typeof t?.config)};var Ho=s(6265),Wo=s(8172),Go=s(27),Vo=s(790),Qo=s(2180),Jo=s(6290);function Ko(e,...t){if(void 0===e?.tree||e.tree?.[".app"]?.type!==Qo.Z.Tree||e.tree?.[".protocol"]?.type!==Qo.Z.Tree)return!1;return 2===Object.keys(e.tree).filter((e=>!t.includes(e))).length}const Yo=async e=>new Promise((t=>setTimeout((()=>t()),e)));var Xo=s(8036),Zo=s(2807);async function ei(e,t,n,r){let o,i=!1,s=500,a=0;const c=(0,zo.l)();let l;do{try{o=await e(r.cancel),i=!0}catch(e){if(!(0,Zo.YU)(e))throw n.sendTelemetryEvent({eventName:`${t}_cancel`,retry:a,duration:(0,zo.l)()-c,fetchCallName:t},e),e;if(!0===r.cancel?.aborted)throw n.sendTelemetryEvent({eventName:`${t}_runWithRetryAborted`,retry:a,duration:(0,zo.l)()-c,fetchCallName:t,reason:r.cancel.reason},e),new Zo.OI("runWithRetry was Aborted",po.a.genericError,{driverVersion:"2.62.0",fetchCallName:t,reason:r.cancel.reason});0===a&&n.sendTelemetryEvent({eventName:`${t}_firstFailed`,duration:(0,zo.l)()-c,fetchCallName:t},e),a++,l=e,s=ri(s,e),r.onRetry&&r.onRetry(s,e),await Yo(s)}}while(!i);return a>0&&n.sendTelemetryEvent({eventName:`${t}_lastError`,retry:a,duration:(0,zo.l)()-c,fetchCallName:t},l),o}const ti=6e4,ni=8e3;function ri(e,t){const n=(0,Zo.E9)(t);let r=Math.max(n??0,2*e);return r=Math.min(r,(0,Xo.X)(t)&&!0===t.getTelemetryProperties().endpointReached?ti:ni),r}function oi(e){return void 0!==e&&"snapshotFormatV"in e&&1===e.snapshotFormatV}function ii(e){return oi(e)?e.snapshotTree:e}var si=s(7497),ai=s(4173),ci=s(2632),li=s(409),ui=s(1914),di=s(9461);const pi="object"==typeof self?self:globalThis,hi=e=>((e,t)=>{const n=(t,n)=>(e.set(n,t),t),r=o=>{if(e.has(o))return e.get(o);const[i,s]=t[o];switch(i){case 0:case-1:return n(s,o);case 1:{const e=n([],o);for(const t of s)e.push(r(t));return e}case 2:{const e=n({},o);for(const[t,n]of s)e[r(t)]=r(n);return e}case 3:return n(new Date(s),o);case 4:{const{source:e,flags:t}=s;return n(new RegExp(e,t),o)}case 5:{const e=n(new Map,o);for(const[t,n]of s)e.set(r(t),r(n));return e}case 6:{const e=n(new Set,o);for(const t of s)e.add(r(t));return e}case 7:{const{name:e,message:t}=s;return n(new pi[e](t),o)}case 8:return n(BigInt(s),o);case"BigInt":return n(Object(BigInt(s)),o)}return n(new pi[i](s),o)};return r})(new Map,e)(0),fi="",{toString:gi}={},{keys:mi}=Object,vi=e=>{const t=typeof e;if("object"!==t||!e)return[0,t];const n=gi.call(e).slice(8,-1);switch(n){case"Array":return[1,fi];case"Object":return[2,fi];case"Date":return[3,fi];case"RegExp":return[4,fi];case"Map":return[5,fi];case"Set":return[6,fi]}return n.includes("Array")?[1,n]:n.includes("Error")?[7,n]:[2,n]},yi=([e,t])=>0===e&&("function"===t||"symbol"===t),bi=(e,{json:t,lossy:n}={})=>{const r=[];return((e,t,n,r)=>{const o=(e,t)=>{const o=r.push(e)-1;return n.set(t,o),o},i=r=>{if(n.has(r))return n.get(r);let[s,a]=vi(r);switch(s){case 0:{let t=r;switch(a){case"bigint":s=8,t=r.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+a);t=null;break;case"undefined":return o([-1],r)}return o([s,t],r)}case 1:{if(a)return o([a,[...r]],r);const e=[],t=o([s,e],r);for(const t of r)e.push(i(t));return t}case 2:{if(a)switch(a){case"BigInt":return o([a,r.toString()],r);case"Boolean":case"Number":case"String":return o([a,r.valueOf()],r)}if(t&&"toJSON"in r)return i(r.toJSON());const n=[],c=o([s,n],r);for(const t of mi(r))!e&&yi(vi(r[t]))||n.push([i(t),i(r[t])]);return c}case 3:return o([s,r.toISOString()],r);case 4:{const{source:e,flags:t}=r;return o([s,{source:e,flags:t}],r)}case 5:{const t=[],n=o([s,t],r);for(const[n,o]of r)(e||!yi(vi(n))&&!yi(vi(o)))&&t.push([i(n),i(o)]);return n}case 6:{const t=[],n=o([s,t],r);for(const n of r)!e&&yi(vi(n))||t.push(i(n));return n}}const{message:c}=r;return o([s,{name:a,message:c}],r)};return i})(!(t||n),!!t,new Map,r)(e),r},Si="function"==typeof structuredClone?(e,t)=>t&&("json"in t||"lossy"in t)?hi(bi(e,t)):structuredClone(e):(e,t)=>hi(bi(e,t));var wi=s(7783),Ci=s(2427);function Ei(e){const t=new URL(e);if("string"!=typeof t.pathname)throw new ci.iq("Failed to parse pathname");const n=t.search??"",r=/^\/([^/]*\/[^/]*)(\/?.*)$/.exec(t.pathname);return 3===r?.length?{id:r[1],path:r[2],query:n,version:t.searchParams.get("version")??void 0}:void 0}function ki(e,t){(0,Wo.vA)(!Ko(e),1448),(0,Wo.vA)(!Ko(t),1449);return{type:Qo.Z.Tree,tree:{".protocol":t,".app":e}}}function Pi(e){let t={};const n={blobs:{},trees:{},id:(0,wi.A)(),unreferenced:e.unreferenced,groupId:e.groupId};for(const[r,o]of Object.entries(e.tree))switch(o.type){case Qo.Z.Tree:{const e=Pi(o);n.trees[r]=e.baseSnapshot,t={...t,...e.snapshotBlobs};break}case Qo.Z.Attachment:n.blobs[r]=o.id;break;case Qo.Z.Blob:{const e=(0,wi.A)();n.blobs[r]=e;const i=o.content instanceof Uint8Array?(0,Ci.Km)(o.content):o.content;t[e]=i;break}case Qo.Z.Handle:throw new ci.iq("No handles should be there in summary in detached container!!");default:(0,Vo.$)(o,`Unknown tree type ${o.type}`)}return{baseSnapshot:n,snapshotBlobs:t}}function Ti(e){(0,Wo.vA)(void 0!==e.sequenceNumber,2362);const t={};for(const[n,r]of e.blobContents.entries())t[n]=(0,Ci.JR)(r,"utf8");return{baseSnapshot:e.snapshotTree,snapshotBlobs:t,snapshotSequenceNumber:e.sequenceNumber}}function Ni(e,t){const n={type:Qo.Z.Tree,tree:{...t.tree}};n.tree[".protocol"]=e;return Pi(n)}const Ai=e=>{(0,Wo.vA)(Ko(e),2278);return Ni(e.tree[".protocol"],e.tree[".app"])};function Ii(e){return".protocol"in e.trees?e.trees[".protocol"]:e}const Oi=(e,t)=>{const n={};for(const[,r]of Object.entries(e.blobs))void 0!==t[r]&&(n[r]=(0,Ci.Xg)(t[r],"utf8"));const r={};for(const[n,o]of Object.entries(e.trees))r[n]=Oi(o,t);return{...e,blobsContents:n,trees:r}};function Li(e){return"object"==typeof e&&null!==e&&e?.errorType===po.a.deltaStreamConnectionForbidden}const Di=e=>{let t;return(...n)=>void 0!==t?((e,t,n=(e,t)=>Object.is(e,t))=>e===t||e.length===t.length&&e.every(((e,r)=>n(e,t[r],r))))(t.args,n)?t.result:Promise.reject(new ai.eb("Subsequent calls cannot use different arguments.")):(t={args:n,result:e(...n).finally((()=>t=void 0))},t.result)};async function Ri(e,t){if(void 0===t)return{minimumSequenceNumber:0,sequenceNumber:0};const n=".protocol"in t.trees?t.trees[".protocol"].blobs.attributes:t.blobs[".attributes"];return await(0,si.P)(e,n)}class Fi extends qo.X{constructor(){super(),this.members=new Map,super.setMaxListeners(0)}getSelf(){return void 0===this._currentClientId?void 0:{clientId:this._currentClientId,client:this.getMember(this._currentClientId)}}setCurrentClientId(e){if(this._currentClientId!==e){const t=this._currentClientId;this._currentClientId=e,this.emit("selfChanged",void 0===t?void 0:{clientId:t},{clientId:e,client:this.getMember(e)})}}addMember(e,t){if(this.members.has(e)){const n=this.members.get(e);(0,Wo.vA)(JSON.stringify(n)===JSON.stringify(t),1202)}else this.members.set(e,t),this.emit("addMember",e,t)}removeMember(e){const t=this.members.get(e);return void 0!==t&&(this.members.delete(e),this.emit("removeMember",e,t),!0)}getMembers(){return new Map(this.members)}getMember(e){return this.members.get(e)}}var Mi,xi;function _i(e,t,n){const r={...t},o=n?.online;if(r.online="string"==typeof o?o:Zo.WA[(0,Zo.sc)()],"object"==typeof navigator&&null!==navigator){const e=navigator,t=e.connection??e.mozConnection??e.webkitConnection;null!==t&&"object"==typeof t&&(r.connectionType=t.type)}r.category=(0,Zo.YU)(n)?"generic":"error",e.sendTelemetryEvent(r,n)}function Ui(e){return e.type===Jo.Go.Operation}!function(e){e.DocRead="doc:read",e.DocWrite="doc:write",e.SummaryWrite="summary:write"}(Mi||(Mi={})),function(e){e.Never="Never",e.Disabled="Disabled",e.Enabled="Enabled"}(xi||(xi={}));var ji=s(8784);class zi extends qo.X{get disposed(){return this.isDisposed}get paused(){return 0!==this.pauseCount}get length(){return this.q.length}get idle(){return void 0===this.processingPromise&&0===this.q.length}async waitTillProcessingDone(){return this.processingPromise??{count:0,duration:0}}constructor(e){super(),this.worker=e,this.isDisposed=!1,this.q=new ji,this.pauseCount=1}dispose(){throw new Error("Not implemented.")}clear(){this.q.clear()}peek(){return this.q.peekFront()}toArray(){return this.q.toArray()}push(e){try{this.q.push(e),this.emit("push",e),this.ensureProcessing()}catch(e){this.emit("error",e)}}async pause(){this.pauseCount++,await this.waitTillProcessingDone()}resume(){(0,Wo.vA)(this.pauseCount>0,244),this.pauseCount--,this.ensureProcessing()}ensureProcessing(){this.anythingToProcess()&&void 0===this.processingPromise&&(this.processingPromise=Promise.resolve().then((()=>{(0,Wo.vA)(void 0!==this.processingPromise,895);const e=this.processDeltas();return(0,Wo.vA)(void 0!==this.processingPromise,896),this.processingPromise=void 0,e})).catch((e=>(this.error=e,this.processingPromise=void 0,this.emit("error",e),{count:0,duration:0}))),(0,Wo.vA)(void 0!==this.processingPromise,897))}anythingToProcess(){return this.q.length>0&&!this.paused&&void 0===this.error}processDeltas(){const e=(0,zo.l)();let t=0;for(;this.anythingToProcess();){const e=this.q.shift();t++,this.worker(e),this.emit("op",e)}const n=(0,zo.l)()-e;return 0===this.q.length&&this.emit("idle",t,n),{count:t,duration:n}}}qo.X;const qi={mode:"read",details:{capabilities:{interactive:!0}},permission:[],user:{id:"storage-only client"},scopes:[]},Bi="storage-only client";class $i extends qo.X{constructor(e,t){super(),this.storageOnlyReason=e,this.readonlyConnectionReason=t,this.clientId=Bi,this.claims={scopes:[Mi.DocRead]},this.mode="read",this.existing=!0,this.maxMessageSize=0,this.version="",this.initialMessages=[],this.initialSignals=[],this.initialClients=[{client:qi,clientId:Bi}],this.serviceConfiguration={maxMessageSize:0,blockSize:0},this.checkpointSequenceNumber=void 0,this._disposed=!1}submit(e){this.emit("nack",this.clientId,e.map((e=>({operation:e,content:{message:"Cannot submit with storage-only connection",code:403}}))))}submitSignal(e){this.emit("nack",this.clientId,{operation:e,content:{message:"Cannot submit signal with storage-only connection",code:403}})}get disposed(){return this._disposed}dispose(){this._disposed=!0}}function Hi(e){return e instanceof $i}var Wi=s(6580);const{EventEmitter:Gi}=Wi;class Vi{constructor(e,t,n,r){this.sequenceNumber=e,this.key=t,this.value=n,this.local=r}}class Qi extends qo.X{get disposed(){return this.isDisposed}constructor(e){super(),this.isDisposed=!1,this.members=new Map(e),this.snapshotCache=e}snapshot(){return this.snapshotCache??=[...this.members],this.snapshotCache}addMember(e,t){(0,Wo.vA)(!!e,2464),(0,Wo.vA)(!this.members.has(e),2465),this.members.set(e,t),this.emit("addMember",e,t),this.snapshotCache=void 0}removeMember(e){(0,Wo.vA)(!!e,2466),(0,Wo.vA)(this.members.has(e),2467),this.members.delete(e),this.emit("removeMember",e),this.snapshotCache=void 0}getMembers(){return new Map(this.members)}getMember(e){return this.members.get(e)}dispose(){this.isDisposed=!0}}class Ji extends qo.X{get disposed(){return this.isDisposed}constructor(e,t){super(),this.sendProposal=t,this.isDisposed=!1,this.stateEvents=new Gi,this.proposals=new Map(e.proposals.map((([,e])=>[e.sequenceNumber,new Vi(e.sequenceNumber,e.key,e.value,!1)]))),this.values=new Map(e.values),this.proposalsSnapshotCache=e.proposals,this.valuesSnapshotCache=e.values}snapshot(){return this.proposalsSnapshotCache??=[...this.proposals].map((([e,t])=>[e,{sequenceNumber:e,key:t.key,value:t.value},[]])),this.valuesSnapshotCache??=[...this.values],{proposals:this.proposalsSnapshotCache,values:this.valuesSnapshotCache}}has(e){return this.values.has(e)}get(e){return this.values.get(e)?.value}async propose(e,t){const n=this.sendProposal(e,t);if(n<0)throw this.emit("error",{eventName:"ProposalInDisconnectedState",key:e}),new Error("Can't propose in disconnected state");return new Promise(((e,t)=>{let r;const o=(e,t)=>{e===n&&(r=t,this.stateEvents.off("localProposalSequenced",o),this.stateEvents.off("disconnected",s),this.stateEvents.on("localProposalApproved",i))},i=t=>{t===r&&(e(),c())},s=()=>{void 0===r&&this.stateEvents.once("connected",(()=>{void 0===r&&(t(new Error("Client disconnected without successfully sending proposal")),c())}))},a=()=>{t(new Error("QuorumProposals was disposed")),c()},c=()=>{this.stateEvents.off("localProposalSequenced",o),this.stateEvents.off("localProposalApproved",i),this.stateEvents.off("disconnected",s),this.stateEvents.off("disposed",a)};this.stateEvents.on("localProposalSequenced",o),this.stateEvents.on("disconnected",s),this.stateEvents.on("disposed",a)}))}addProposal(e,t,n,r,o){(0,Wo.vA)(!this.proposals.has(n),2468);const i=new Vi(n,e,t,r);this.proposals.set(n,i),this.emit("addProposal",i),r&&this.stateEvents.emit("localProposalSequenced",o,n),this.proposalsSnapshotCache=void 0}updateMinimumSequenceNumber(e){const t=e.minimumSequenceNumber,n=[];for(const[e,r]of this.proposals)e<=t&&n.push(r);n.sort(((e,t)=>e.sequenceNumber-t.sequenceNumber));for(const t of n){const n={approvalSequenceNumber:e.sequenceNumber,commitSequenceNumber:-1,key:t.key,sequenceNumber:t.sequenceNumber,value:t.value};this.values.set(n.key,n),this.valuesSnapshotCache=void 0;let r=!1,o=!1;for(const[,e]of this.proposals)if(e.key===n.key){if(o){r=!1;break}r=!0,o=!0}this.emit("approveProposal",n.sequenceNumber,n.key,n.value,n.approvalSequenceNumber),r&&this.emit("approveProposalComplete",n.sequenceNumber,n.key,n.value,n.approvalSequenceNumber),this.proposals.delete(t.sequenceNumber),this.proposalsSnapshotCache=void 0,t.local&&this.stateEvents.emit("localProposalApproved",t.sequenceNumber)}}setConnectionState(e){e?this.stateEvents.emit("connected"):this.stateEvents.emit("disconnected")}dispose(){this.isDisposed=!0,this.stateEvents.emit("disposed")}}class Ki extends qo.X{get disposed(){return this.isDisposed}constructor(e,t,n,r){super(),this.isDisposed=!1,this.quorumClients=new Qi(e),this.quorumClients.on("addMember",((e,t)=>{this.emit("addMember",e,t)})),this.quorumClients.on("removeMember",(e=>{this.emit("removeMember",e)})),this.quorumProposals=new Ji({proposals:t,values:n},r),this.quorumProposals.on("addProposal",(e=>{this.emit("addProposal",e)})),this.quorumProposals.on("approveProposal",((e,t,n,r)=>{this.emit("approveProposal",e,t,n,r)}))}close(){this.removeAllListeners()}snapshot(){const e=this.quorumClients.snapshot(),{proposals:t,values:n}=this.quorumProposals.snapshot();return{members:e,proposals:t,values:n}}has(e){return this.quorumProposals.has(e)}get(e){return this.quorumProposals.get(e)}addMember(e,t){this.quorumClients.addMember(e,t)}removeMember(e){this.quorumClients.removeMember(e)}getMembers(){return this.quorumClients.getMembers()}getMember(e){return this.quorumClients.getMember(e)}async propose(e,t){return this.quorumProposals.propose(e,t)}addProposal(e,t,n,r,o){return this.quorumProposals.addProposal(e,t,n,r,o)}updateMinimumSequenceNumber(e){this.quorumProposals.updateMinimumSequenceNumber(e)}setConnectionState(e,t){this.quorumProposals.setConnectionState(e)}dispose(){throw new Error("Not implemented.")}}class Yi{get quorum(){return this._quorum}constructor(e,t,n,r,o,i){this.minimumSequenceNumber=e,this.sequenceNumber=t,this._quorum=new Ki(n,r,o,i)}get attributes(){return{minimumSequenceNumber:this.minimumSequenceNumber,sequenceNumber:this.sequenceNumber}}setConnectionState(e,t){this._quorum.setConnectionState(e,t)}snapshot(){return this._quorum.snapshot()}close(){this._quorum.close()}processMessage(e,t){if(e.sequenceNumber!==this.sequenceNumber+1)throw new Error(`Protocol state is not moving sequentially. Current is ${this.sequenceNumber}. Next is ${e.sequenceNumber}`);this.sequenceNumber=e.sequenceNumber,this.minimumSequenceNumber=e.minimumSequenceNumber;let n=!1;switch(e.type){case Jo.Go.ClientJoin:{const t=e,n=JSON.parse(t.data),r={client:n.detail,sequenceNumber:t.sequenceNumber};this._quorum.addMember(n.clientId,r);break}case Jo.Go.ClientLeave:{const t=e,n=JSON.parse(t.data);this._quorum.removeMember(n);break}case Jo.Go.Propose:{"string"==typeof e.contents&&(e.contents=JSON.parse(e.contents));const r=e.contents;this._quorum.addProposal(r.key,r.value,e.sequenceNumber,t,e.clientSequenceNumber),n=!0;break}}return this._quorum.updateMinimumSequenceNumber(e),{immediateNoOp:n}}getProtocolState(e=!1){const t=this._quorum.snapshot();return e&&(t.members=t.members.map((([e,t])=>[e,{...t,client:{...t.client,user:{id:""}}}]))),{sequenceNumber:this.sequenceNumber,minimumSequenceNumber:this.minimumSequenceNumber,...t}}}var Xi;!function(e){e.ClientJoin="join",e.ClientLeave="leave",e.Clear="clear"}(Xi||(Xi={}));class Zi extends Yi{constructor(e,t,n,r,o){super(e.minimumSequenceNumber,e.sequenceNumber,t.members,t.proposals,t.values,n),this.audience=r,this.shouldClientHaveLeft=o;for(const[e,t]of this.quorum.getMembers())r.addMember(e,t.client);this.quorum.on("addMember",((e,t)=>r.addMember(e,t.client))),this.quorum.on("removeMember",(e=>r.removeMember(e)))}processMessage(e,t){if(null!=e.clientId){if(void 0===this.quorum.getMember(e.clientId)&&e.type!==Jo.Go.ClientJoin)throw new Error("Remote message's clientId is missing from the quorum");if(this.shouldClientHaveLeft(e.clientId)&&!function(e){return e.type===Jo.Go.NoOp||e.type===Jo.Go.Accept}(e))throw new Error("Remote message's clientId already should have left")}return super.processMessage(e,t)}processSignal(e){const t=e.content;switch(t.type){case Xi.Clear:{const e=this.audience.getMembers();for(const[t,n]of e)"read"===n.mode&&this.audience.removeMember(t);break}case Xi.ClientJoin:{const e=t.content;"read"===e.client.mode&&this.audience.addMember(e.clientId,e.client);break}case Xi.ClientLeave:{const e=t.content;"read"===this.audience.getMember(e)?.mode&&this.audience.removeMember(e);break}}}}const es={fatalConnectError:!0};const ts=async()=>{if(!1===globalThis.navigator?.onLine&&void 0!==globalThis.addEventListener)return new Promise((e=>{const t=()=>{e(),globalThis.removeEventListener("online",t)};globalThis.addEventListener("online",t)}))};class ns{get connectionVerboseProps(){return this._connectionVerboseProps}get connectionMode(){return this.connection?.mode??"read"}get connected(){return void 0!==this.connection}get clientId(){return this.connection?.clientId}get connectionDetails(){return this._connectionDetails}get reconnectMode(){return this._reconnectMode}get maxMessageSize(){return this.connection?.serviceConfiguration?.maxMessageSize??16384}get version(){if(void 0===this.connection)throw new Error("Cannot check version without a connection");return this.connection.version}get serviceConfiguration(){return this.connection?.serviceConfiguration}get scopes(){return this.connection?.claims.scopes}get outbound(){return this._outbound}get connectionProps(){return void 0===this.connection?{...this._connectionProps,sentOps:this.clientSequenceNumber}:this._connectionProps}shouldJoinWrite(){const e=this.clientSequenceNumberObserved<this.clientSequenceNumber-this.localOpsToIgnore,t=this.containerDirty();return e!==t&&this.logger.sendTelemetryEvent({eventName:"DesiredConnectionModeMismatch",details:JSON.stringify({outstandingOps:e,isDirty:t})}),e||t}get readonly(){return this.readOnlyInfo.readonly}get readOnlyInfo(){let e,t=!1;return Hi(this.connection)&&(t=!0,e=this.connection.storageOnlyReason),t||this._forceReadonly||!0===this._readonlyPermissions?{readonly:!0,forced:this._forceReadonly,permissions:this._readonlyPermissions,storageOnly:t,storageOnlyReason:e}:{readonly:this._readonlyPermissions}}static detailsFromConnection(e,t){return{claims:e.claims,clientId:e.clientId,checkpointSequenceNumber:e.checkpointSequenceNumber,get initialClients(){return e.initialClients},mode:e.mode,serviceConfiguration:e.serviceConfiguration,version:e.version,reason:t}}constructor(e,t,n,r,o,i,s){this.serviceProvider=e,this.containerDirty=t,this.client=n,this.logger=o,this.props=i,this.retryConnectionTimeoutMs=s,this._forceReadonly=!1,this.pendingReconnect=!1,this.clientSequenceNumber=0,this.clientSequenceNumberObserved=0,this.localOpsToIgnore=0,this.connectFirstConnection=!0,this._connectionVerboseProps={},this._connectionProps={},this._disposed=!1,this.opHandler=(e,t)=>{const n=Array.isArray(t)?t:[t];this.props.incomingOpHandler(n,"opHandler")},this.signalHandler=e=>{const t=Array.isArray(e)?e:[e];this.props.signalHandler(t)},this.nackHandler=(e,t)=>{const n=t[0];if(!0===this._readonlyPermissions)return void this.props.closeHandler((0,Zo.Of)("writeOnReadOnlyDocument",{driverVersion:void 0}));const r=function(e){const t=`Nack (${e.type}): ${e.message}`,n=403!==e.code,r=void 0===e.retryAfter?void 0:1e3*e.retryAfter;return(0,Zo.ix)(t,{canRetry:n,retryAfterMs:r},{statusCode:e.code,driverVersion:void 0})}(n.content);r.canRetry?this.reconnectOnError("write",r):this.props.closeHandler(r)},this.disconnectHandlerInternal=e=>{this.reconnectOnError(this.defaultReconnectionMode,e)},this.errorHandler=e=>{this.reconnectOnError(this.defaultReconnectionMode,e)},this.clientDetails=this.client.details,this.defaultReconnectionMode=this.client.mode,this._reconnectMode=r?xi.Enabled:xi.Never,this._outbound=new zi((e=>{if(void 0===this.connection)throw new Error("Attempted to submit an outbound message without connection");this.connection.submit(e)})),this._outbound.on("error",(e=>{this.props.closeHandler((0,ci.cQ)(e))}))}dispose(e,t=!0){if(this._disposed)return;this._disposed=!0,this._reconnectMode=xi.Never,this._outbound.clear();const n={text:"Closing DeltaManager",error:e},r=this.readonly;this.disconnectFromDeltaStream(n),t&&this.set_readonlyPermissions(!0,r,n)}setAutoReconnect(e,t){(0,Wo.vA)(e!==xi.Never&&this._reconnectMode!==xi.Never,632),this._reconnectMode=e,e!==xi.Enabled&&this.disconnectFromDeltaStream(t)}forceReadonly(e){e!==this._forceReadonly&&this.logger.sendTelemetryEvent({eventName:"ForceReadOnly",value:e});const t=this.readonly;if(this._forceReadonly=e,t!==this.readonly){if(this._reconnectMode===xi.Never)throw new ai.eb("API is not supported for non-connecting or closed container");let e=!1;!0===this.readonly&&(this.shouldJoinWrite()&&this.logger.sendErrorEvent({eventName:"ForceReadonlyPendingChanged"}),e=this.disconnectFromDeltaStream({text:"Force readonly"})),this.props.readonlyChangeHandler(this.readonly),e&&this.triggerConnect({text:"Force Readonly"},"read")}}set_readonlyPermissions(e,t,n){this._readonlyPermissions=e,t!==this.readonly&&this.props.readonlyChangeHandler(this.readonly,n)}connect(e,t){this.connectCore(e,t).catch((e=>{const t=(0,ci.cQ)(e,{props:es});this.props.closeHandler(t)}))}async connectCore(e,t){(0,Wo.vA)(!this._disposed,618);let n=t??this.defaultReconnectionMode;if(this.shouldJoinWrite()&&(n="write"),void 0!==this.connection||void 0!==this.pendingConnection){const e=this.connection?.mode??this.pendingConnection?.connectionMode;return void(e!==n&&this.logger.sendTelemetryEvent({eventName:"ConnectionModeMismatch",connected:void 0!==this.connection,mode:e,requestedMode:n,stack:(0,ci.aX)()}))}const r=this.serviceProvider();let o;if((0,Wo.vA)(void 0!==r,679),this.props.establishConnectionHandler(e),!0===r.policies?.storageOnly)return o=new $i,this.setupNewSuccessfulConnection(o,"read",e),void(0,Wo.vA)(void 0===this.pendingConnection,691);let i=500,s=0;const a=(0,zo.l)();let c;void 0===this.initialConnectionStartTime&&(this.initialConnectionStartTime=a);const l=new AbortController,u=l.signal;for(this.pendingConnection={abort:()=>{l.abort()},connectionMode:n};void 0===o;){if(this._disposed)throw new Error("Attempting to connect a closed DeltaManager");if(!0===u.aborted)return void this.logger.sendTelemetryEvent({eventName:"ConnectionAttemptCancelled",attempts:s,duration:(0,ho.T0)((0,zo.l)()-a),connectionEstablished:!1});s++;try{this.client.mode=n,o=await r.connectToDeltaStream({...this.client,mode:n}),o.disposed&&(this.logger.sendTelemetryEvent({eventName:"ReceivedClosedConnection"}),o=void 0),this.logger.sendTelemetryEvent({eventName:"ConnectionReceived",connected:void 0!==o&&!1===o.disposed},void 0,Ho.$.verbose)}catch(e){if(this.logger.sendTelemetryEvent({eventName:"ConnectToDeltaStreamException",connected:void 0!==o&&!1===o.disposed},void 0,Ho.$.verbose),Li(e)){o=new $i(e.storageOnlyReason,{text:e.message,error:e}),n="read";break}if((0,Xo.X)(e)&&e.errorType===po.a.outOfStorageError){o=new $i(void 0,{text:e.message,error:e}),n="read";break}if(!(0,Zo.YU)(e)){const t=(0,ci.cQ)(e,{props:es});throw this.props.closeHandler(t),t}if(_i(this.logger,{attempts:s,delay:i,eventName:"DeltaConnectionFailureToConnect",duration:(0,ho.T0)((0,zo.l)()-a)},e),c=e,this.reconnectMode!==xi.Enabled)return;const t=(0,zo.l)(),r=(0,Zo.E9)(e);if(void 0===r&&!1===globalThis.navigator?.onLine||(i=ri(i,e)),void 0!==r&&this.props.reconnectionDelayHandler(i,e),void 0!==this.retryConnectionTimeoutMs){const t=(0,zo.l)()-this.initialConnectionStartTime,n=this.retryConnectionTimeoutMs-t,r=(0,zo.l)()-a;if(i+r>=.75*n)throw this.logger.sendTelemetryEvent({eventName:"RetryDelayExceedsConnectionTimeout",attempts:s,duration:(0,ho.T0)(t),calculatedDelayMs:i,remainingTimeMs:n,timeoutMs:this.retryConnectionTimeoutMs}),(0,ci.cQ)(e,{props:es})}await new Promise((e=>{setTimeout(e,i)})),await ts(),this.logger.sendPerformanceEvent({eventName:"WaitBetweenConnectionAttempts",duration:(0,zo.l)()-t,details:JSON.stringify({retryDelayFromError:r,delayMs:i})})}}if(s>1&&_i(this.logger,{eventName:"MultipleDeltaConnectionFailures",attempts:s,duration:(0,ho.T0)((0,zo.l)()-a)},c),!0===u.aborted||this._disposed)return o.dispose(),void this.logger.sendTelemetryEvent({eventName:"ConnectionAttemptCancelled",attempts:s,duration:(0,ho.T0)((0,zo.l)()-a),connectionEstablished:!0});this.setupNewSuccessfulConnection(o,n,e)}triggerConnect(e,t){this.reconnectMode===xi.Enabled&&this.connect(e,t)}disconnectFromDeltaStream(e){if(this.pendingReconnect=!1,void 0===this.connection)return void 0!==this.pendingConnection&&(this.cancelConnection(e),!0);(0,Wo.vA)(void 0===this.pendingConnection,635);const t=this.connection;return this.connection=void 0,this._connectionDetails=void 0,t.off("op",this.opHandler),t.off("signal",this.signalHandler),t.off("nack",this.nackHandler),t.off("disconnect",this.disconnectHandlerInternal),t.off("error",this.errorHandler),t.off("pong",this.props.pongHandler),this._outbound.pause(),this._outbound.clear(),t.dispose(),this.props.disconnectHandler(e),this._connectionVerboseProps={},!0}cancelConnection(e){(0,Wo.vA)(void 0!==this.pendingConnection,837),this.pendingConnection.abort(),this.pendingConnection=void 0,this.logger.sendTelemetryEvent({eventName:"ConnectionCancelReceived",reason:e.text}),this.props.cancelConnectionHandler({text:`Cancel Pending Connection due to ${e.text}`,error:e.error})}setupNewSuccessfulConnection(e,t,n){(0,Wo.vA)(void 0===this.connection,230),(0,Wo.vA)(!e.disposed,650),this.pendingConnection=void 0;const r=this.readonly;this.connection=e;const o=!e.claims.scopes.includes(Mi.DocWrite);if(e.mode!==t&&this.logger.sendTelemetryEvent({eventName:"ConnectionModeMismatch",requestedMode:t,mode:e.mode}),(0,Wo.vA)(!o||"read"===this.connectionMode,232),this.set_readonlyPermissions(o,r,Hi(e)?e.readonlyConnectionReason:void 0),this._disposed)return void this.disconnectFromDeltaStream({text:"ConnectionManager already closed"});this._outbound.resume(),e.on("op",this.opHandler),e.on("signal",this.signalHandler),e.on("nack",this.nackHandler),e.on("disconnect",this.disconnectHandlerInternal),e.on("error",this.errorHandler),e.on("pong",this.props.pongHandler);const i=e.initialMessages.sort(((e,t)=>e.sequenceNumber-t.sequenceNumber));let s=e.checkpointSequenceNumber;this._connectionVerboseProps={clientId:e.clientId,mode:e.mode},this._connectionProps={},void 0!==e.relayServiceAgent&&(this._connectionVerboseProps.relayServiceAgent=e.relayServiceAgent,this._connectionProps.relayServiceAgent=e.relayServiceAgent),this._connectionProps.socketDocumentId=e.claims.documentId,this._connectionProps.connectionMode=e.mode;let a=-1;i.length>0&&(this._connectionVerboseProps.connectionInitialOpsFrom=i[0].sequenceNumber,a=i[i.length-1].sequenceNumber,this._connectionVerboseProps.connectionInitialOpsTo=a+1,(void 0===s||s<a)&&(s=a)),this.props.incomingOpHandler(i,this.connectFirstConnection?"InitialOps":"ReconnectOps"),this._connectionDetails=ns.detailsFromConnection(e,n),this._connectionDetails.checkpointSequenceNumber=s,this.props.connectHandler(this._connectionDetails),this.connectFirstConnection=!1;let c=[{clientId:null,content:JSON.stringify({type:Xi.Clear})}];const l=(e.initialClients??[]).map((e=>({clientId:null,content:JSON.stringify({type:Xi.ClientJoin,content:e})})));l.length>0&&(c=[...c,...l]),void 0!==e.initialSignals&&e.initialSignals.length>0&&(c=[...c,...e.initialSignals]),this.props.signalHandler(c)}reconnectOnError(e,t){this.reconnect(e,{text:t.message,error:t}).catch(this.props.closeHandler)}async reconnect(e,t){if((0,Wo.vA)(void 0!==this.connection,235),this.disconnectFromDeltaStream(t),!1===t.error?.canRetry&&this.logger.sendTelemetryEvent({eventName:"reconnectingDespiteFatalError",reconnectMode:this.reconnectMode},t.error),this.reconnectMode===xi.Never&&this.props.closeHandler(),this._disposed||this.reconnectMode!==xi.Enabled)return;const n=(0,Zo.E9)(t.error);void 0!==t.error&&void 0!==n&&(this.props.reconnectionDelayHandler(n,t.error),await new Promise((e=>{setTimeout(e,n)}))),await ts(),this.triggerConnect({text:void 0===t.error?`Reconnecting due to: ${t.text}`:"Reconnecting due to Error",error:t.error},e)}prepareMessageToSend(e){if(!0!==this.readonly)return(0,Wo.vA)(!!this.connection,228),this.lastSubmittedClientId!==this.connection?.clientId&&(this.lastSubmittedClientId=this.connection?.clientId,this.clientSequenceNumber=0,this.clientSequenceNumberObserved=0),Ui(e)?this.localOpsToIgnore=0:this.localOpsToIgnore++,{...e,clientSequenceNumber:++this.clientSequenceNumber};{(0,Wo.vA)(!0===this.readOnlyInfo.readonly,496);const e=new ai.gn("deltaManagerReadonlySubmit",void 0,{readonly:this.readOnlyInfo.readonly,forcedReadonly:this.readOnlyInfo.forced,readonlyPermissions:this.readOnlyInfo.permissions,storageOnly:this.readOnlyInfo.storageOnly,storageOnlyReason:this.readOnlyInfo.storageOnlyReason});this.props.closeHandler(e)}}submitSignal(e,t){void 0===this.connection?this.logger.sendErrorEvent({eventName:"submitSignalDisconnected"}):this.connection.submitSignal(e,t)}sendMessages(e){(0,Wo.vA)(this.connected,692),"read"!==this.connectionMode?((0,Wo.vA)(!this.pendingReconnect,693),this._outbound.push(e)):this.pendingReconnect||(this.pendingReconnect=!0,Promise.resolve().then((async()=>{this.pendingReconnect&&await this.reconnect("write",{text:"Switch to write"})})).catch((()=>{})))}beforeProcessingIncomingOp(e){if((0,Wo.vA)(this.clientId!==e.clientId||this.lastSubmittedClientId===e.clientId,238),void 0!==this.lastSubmittedClientId&&this.lastSubmittedClientId===e.clientId){const t=e.clientSequenceNumber;(0,Wo.vA)(this.clientSequenceNumberObserved<t,239),(0,Wo.vA)(t<=this.clientSequenceNumber,240),this.clientSequenceNumberObserved=t}if(e.type===Jo.Go.ClientLeave){const t=e;JSON.parse(t.data)===this.clientId&&(this.logger.sendPerformanceEvent({eventName:"ReadConnectionTransition"}),this.reconnect("read",{text:"Switch to read"}).catch((e=>{this.logger.sendErrorEvent({eventName:"SwitchToReadConnection"},e)})))}}}const rs=2147483647;function os(e,t,n){let r;if(t>rs){const o=t-rs;r=setTimeout((()=>os(e,o,n)),rs)}else r=setTimeout((()=>e()),Math.max(t,0));return n?.(r),r}class is{get hasTimer(){return!!this.runningState}constructor(e,t,n){this.defaultTimeout=e,this.defaultHandler=t,this.exceptionHandler=n,this.getCurrentTick=()=>Date.now()}start(e=this.defaultTimeout,t=this.defaultHandler){this.startCore(e,t,e)}clear(){this.runningState&&(clearTimeout(this.runningState.timeout),this.runningState=void 0)}restart(e,t){if(this.runningState){const n=e??this.runningState.intendedDuration,r=t??this.runningState.restart?.handler??this.runningState.handler,o=this.calculateRemainingTime(this.runningState);n<o?this.start(n,r):n===o?(this.runningState.handler=r,this.runningState.restart=void 0,this.runningState.intendedDuration=n):this.runningState.restart={startTick:this.getCurrentTick(),duration:n,handler:r}}else this.start(e,t)}startCore(e,t,n){this.clear(),this.runningState={startTick:this.getCurrentTick(),duration:e,intendedDuration:n,handler:t,timeout:os((()=>this.handler()),e,(e=>{void 0!==this.runningState&&(this.runningState.timeout=e)}))}}handler(){(0,Wo.vA)(!!this.runningState,1892);const e=this.runningState.restart;if(void 0===e){const e=this.runningState.handler;this.clear();try{e()}catch(e){if(!this.exceptionHandler)throw e;this.exceptionHandler(e)}}else{const t=this.calculateRemainingTime(e);this.startCore(t,(()=>e.handler()),e.duration)}}calculateRemainingTime(e){const t=this.getCurrentTick()-e.startTick;return e.duration-t}}class ss{constructor(e,t){this.deltaManager=e,this.listener=t,this.caughtUp=!1,this.opHandler=e=>{!this.caughtUp&&e.sequenceNumber>=this.targetSeqNumber&&(this.caughtUp=!0,this.listener())},this._disposed=!1,this.targetSeqNumber=this.deltaManager.lastKnownSeqNumber,(0,Wo.vA)(this.targetSeqNumber>=this.deltaManager.lastSequenceNumber,892),this.deltaManager.on("op",this.opHandler),this.opHandler({sequenceNumber:this.deltaManager.lastSequenceNumber})}get disposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this.deltaManager.off("op",this.opHandler))}}function as(e,t,n){const r=e.mc.config;return function(e,t,n,r,o){const i=e=>new us(e,t,o);return e?new ls(n,i,r):i(n)}(!0!==r.getBoolean("Fluid.Container.DisableCatchUpBeforeDeclaringConnected"),!0!==r.getBoolean("Fluid.Container.DisableJoinSignalWait"),e,t,n)}class cs{constructor(e,t){this.inputs=e,this.pimpl=t(this)}get connectionState(){return this.pimpl.connectionState}get pendingClientId(){return this.pimpl.pendingClientId}get clientId(){return this.pimpl.clientId}containerSaved(){return this.pimpl.containerSaved()}dispose(){return this.pimpl.dispose()}initProtocol(e){return this.pimpl.initProtocol(e)}receivedDisconnectEvent(e){return this.pimpl.receivedDisconnectEvent(e)}establishingConnection(e){return this.pimpl.establishingConnection(e)}cancelEstablishingConnection(e){return this.pimpl.cancelEstablishingConnection(e)}receivedConnectEvent(e){return this.pimpl.receivedConnectEvent(e)}get logger(){return this.inputs.logger}get mc(){return this.inputs.mc}connectionStateChanged(e,t,n){return this.inputs.connectionStateChanged(e,t,n)}shouldClientJoinWrite(){return this.inputs.shouldClientJoinWrite()}get maxClientLeaveWaitTime(){return this.inputs.maxClientLeaveWaitTime}logConnectionIssue(e,t,n){return this.inputs.logConnectionIssue(e,t,n)}clientShouldHaveLeft(e){return this.inputs.clientShouldHaveLeft(e)}onCriticalError(e){return this.inputs.onCriticalError(e)}}class ls extends cs{constructor(e,t,n){super(e,t),this.deltaManager=n,this.transitionToConnectedState=()=>{const e=this.pimpl.connectionState;(0,Wo.vA)(e===jo.Connected,997),(0,Wo.vA)(this._connectionState===jo.CatchingUp,998),this._connectionState=jo.Connected,this.inputs.connectionStateChanged(jo.Connected,jo.CatchingUp,{text:"caught up"})},this._connectionState=this.pimpl.connectionState}get connectionState(){return this._connectionState}connectionStateChanged(e,t,n){switch(e){case jo.Connected:return(0,Wo.vA)(this._connectionState===jo.CatchingUp,993),(0,Wo.vA)(void 0===this.catchUpMonitor,1003),void(this.catchUpMonitor=new ss(this.deltaManager,this.transitionToConnectedState));case jo.Disconnected:this.catchUpMonitor?.dispose(),this.catchUpMonitor=void 0;break;case jo.EstablishingConnection:(0,Wo.vA)(this._connectionState===jo.Disconnected,1746);break;case jo.CatchingUp:(0,Wo.vA)(this._connectionState===jo.EstablishingConnection,995)}this._connectionState=e,this.inputs.connectionStateChanged(e,t,n)}}class us{get connectionState(){return this._connectionState}get clientId(){return this._clientId}get pendingClientId(){return this._pendingClientId}constructor(e,t,n){this.handler=e,this.readClientsWaitForJoinSignal=t,this._connectionState=jo.Disconnected,this._clientId=n;const r=e=>this.handler.onCriticalError(e);this.prevClientLeftTimer=new is(this.handler.maxClientLeaveWaitTime??3e5,(()=>{(0,Wo.vA)(this.connectionState!==jo.Connected,684),this.applyForConnectedState("timeout")}),r),this.joinTimer=new is(0,(()=>{if(this.connectionState!==jo.CatchingUp)return;const e={protocolInitialized:void 0!==this.protocol,pendingClientId:this.pendingClientId,clientJoined:this.hasMember(this.pendingClientId),waitingForLeaveOp:this.waitingForLeaveOp};this.handler.logConnectionIssue("read"===this.connection?.mode?"NoJoinSignal":"NoJoinOp","error",e)}),r)}startjoinTimer(){(0,Wo.vA)(!this.joinTimer.hasTimer,564),(0,Wo.vA)(void 0!==this.connection,1203),this.joinTimer.start("write"===this.connection.mode?45e3:1e4)}stopjoinTimer(){(0,Wo.vA)(this.joinTimer.hasTimer,565),this.joinTimer.clear()}get waitingForLeaveOp(){return this.prevClientLeftTimer.hasTimer}dispose(){(0,Wo.vA)(!this.joinTimer.hasTimer,677),this.prevClientLeftTimer.clear()}containerSaved(){this.waitingForLeaveOp&&(this.prevClientLeftTimer.clear(),this.applyForConnectedState("containerSaved"))}receivedAddMemberEvent(e){e===this.pendingClientId&&(this.joinTimer.hasTimer?this.stopjoinTimer():this.shouldWaitForSelf()&&this.handler.logConnectionIssue("read"===this.connection?.mode?"ReceivedJoinSignal":"ReceivedJoinOp","generic"),this.waitingForLeaveOp&&(this.waitEvent=ho.Bt.start(this.handler.logger,{eventName:"WaitBeforeClientLeave",details:JSON.stringify({waitOnClientId:this._clientId,hadOutstandingOps:this.handler.shouldClientJoinWrite()})})),this.applyForConnectedState("addMemberEvent"))}applyForConnectedState(e){if((0,Wo.vA)(void 0!==this.protocol,566),(0,Wo.vA)(!this.waitingForLeaveOp||this.hasMember(this.clientId),738),this.pendingClientId!==this.clientId&&this.hasMember(this.pendingClientId)&&!this.waitingForLeaveOp)this.waitEvent?.end({source:e}),this.setConnectionState(jo.Connected);else{const t="timeout"===e&&this.connectionState!==jo.Disconnected;this.handler.logger.sendTelemetryEvent({eventName:"connectedStateRejected",category:t?"error":"generic",details:JSON.stringify({source:e,pendingClientId:this.pendingClientId,clientId:this.clientId,waitingForLeaveOp:this.waitingForLeaveOp,clientJoined:this.hasMember(this.pendingClientId)})})}}receivedRemoveMemberEvent(e){this.clientId===e&&this.waitingForLeaveOp&&(this.prevClientLeftTimer.clear(),this.applyForConnectedState("removeMemberEvent"))}receivedDisconnectEvent(e){this.connection=void 0,this.setConnectionState(jo.Disconnected,e)}cancelEstablishingConnection(e){(0,Wo.vA)(this._connectionState===jo.EstablishingConnection,1747),(0,Wo.vA)(void 0===this.connection,1748);const t=this._connectionState;this._connectionState=jo.Disconnected,this.handler.connectionStateChanged(jo.Disconnected,t,e)}establishingConnection(e){const t=this._connectionState;this._connectionState=jo.EstablishingConnection,this.handler.connectionStateChanged(jo.EstablishingConnection,t,{text:`Establishing Connection due to ${e.text}`,error:e.error})}shouldWaitForSelf(){return(0,Wo.vA)(void 0!==this.connection,1204),"write"===this.connection.mode||this.readClientsWaitForJoinSignal}receivedConnectEvent(e){this.connection=e;const t=this._connectionState;this._connectionState=jo.CatchingUp,this._pendingClientId=e.clientId,this.handler.connectionStateChanged(jo.CatchingUp,t,e.reason),!this.hasMember(this._pendingClientId)&&this.shouldWaitForSelf()?this.startjoinTimer():this.waitingForLeaveOp||this.setConnectionState(jo.Connected)}setConnectionState(e,t){if(this.connectionState===e)return void this.handler.logger.sendErrorEvent({eventName:"setConnectionStateSame",value:e});const n=this._connectionState;this._connectionState=e;const r=void 0!==this._clientId&&void 0!==this.protocol?.quorum?.getMember(this._clientId);e===jo.Connected?((0,Wo.vA)(n===jo.CatchingUp,472),r&&this.handler.clientShouldHaveLeft(this._clientId),this._clientId=this.pendingClientId):e===jo.Disconnected&&(this.joinTimer.hasTimer&&this.stopjoinTimer(),r&&this.handler.shouldClientJoinWrite()&&!this.waitingForLeaveOp?this.prevClientLeftTimer.restart():this.handler.logger.sendTelemetryEvent({eventName:"noWaitOnDisconnected",details:JSON.stringify({clientId:this._clientId,inQuorum:r,waitingForLeaveOp:this.waitingForLeaveOp,hadOutstandingOps:this.handler.shouldClientJoinWrite()})})),this.handler.connectionStateChanged(this._connectionState,n,t),e===jo.Disconnected&&(this._pendingClientId=void 0)}get membership(){return this.readClientsWaitForJoinSignal?this.protocol?.audience:this.protocol?.quorum}initProtocol(e){this.protocol=e,this.membership?.on("addMember",((t,n)=>{(0,Wo.vA)("read"===n.mode||void 0!==e.quorum.getMember(t),1205),this.receivedAddMemberEvent(t)})),this.membership?.on("removeMember",(t=>{(0,Wo.vA)(void 0===e.quorum.getMember(t),1206),this.receivedRemoveMemberEvent(t)})),this.hasMember(this.pendingClientId)&&this.receivedAddMemberEvent(this.pendingClientId),(0,Wo.vA)(!this.waitingForLeaveOp,2461),void 0!==this._clientId&&void 0!==e.quorum?.getMember(this._clientId)&&this.prevClientLeftTimer.restart()}hasMember(e){return void 0!==this.membership?.getMember(e??"")}}var ds=s(7025);const ps="2.62.0",hs={pkgVersion:ps,generation:1},fs={...hs,supportedFeatures:new Set},gs={minSupportedGeneration:0,requiredFeatures:[]},ms={minSupportedGeneration:0,requiredFeatures:[]};class vs{get clientId(){return this._getClientId()}get id(){return this._getContainerDiagnosticId()??""}get connected(){return this._getConnected()}get ILayerCompatDetails(){return fs}constructor(e){this.supportedFeatures=new Map([["referenceSequenceNumbers",!0]]),this.options=e.options,this.scope=e.scope,this.baseSnapshot=e.baseSnapshot,this.deltaManager=e.deltaManager,this.storage=e.storage,this.quorum=e.quorum,this.audience=e.audience,this.loader=e.loader,this.submitFn=e.submitFn,this.submitSummaryFn=e.submitSummaryFn,this.submitBatchFn=e.submitBatchFn,this.submitSignalFn=e.submitSignalFn,this.disposeFn=e.disposeFn,this.closeFn=e.closeFn,this.updateDirtyContainerState=e.updateDirtyContainerState,this.getAbsoluteUrl=e.getAbsoluteUrl,this.clientDetails=e.clientDetails,this.existing=e.existing,this.taggedLogger=e.taggedLogger,this.pendingLocalState=e.pendingLocalState,this.snapshotWithContents=e.snapshotWithContents,this.getConnectionState=e.getConnectionState,this._getClientId=e.getClientId,this._getContainerDiagnosticId=e.getContainerDiagnosticId,this._getConnected=e.getConnected,this._getAttachState=e.getAttachState,this.version=e.version}getLoadedFromVersion(){return this.version}get attachState(){return this._getAttachState()}}class ys extends ci.iq{constructor(e){super(e,{usageError:!0}),this.errorType=po.a.usageError,this.canRetry=!1}}class bs{constructor(e,t,n){this.internalStorageService=e,this.addProtocolSummaryIfMissing=t,this.shouldSummarizeProtocolTree=n,this.getSnapshotTree=e.getSnapshotTree.bind(e),this.getSnapshot=e.getSnapshot?.bind(e),this.getVersions=e.getVersions.bind(e),this.createBlob=e.createBlob.bind(e),this.readBlob=e.readBlob.bind(e),this.downloadSummary=e.downloadSummary.bind(e),this.dispose=e.dispose.bind(e)}get policies(){return this.internalStorageService.policies}get disposed(){return this.internalStorageService.disposed}async uploadSummaryWithContext(e,t){return this.shouldSummarizeProtocolTree()?this.internalStorageService.uploadSummaryWithContext(this.addProtocolSummaryIfMissing(e),t):this.internalStorageService.uploadSummaryWithContext(e,t)}}class Ss{constructor(e,t){this.internalStorageServiceP=e,this.logger=t,this._disposed=!1,this.internalStorageServiceP.then((e=>this.internalStorageService=e)).catch((()=>{}))}get policies(){if(this.internalStorageService)return this.internalStorageService.policies;throw new Error("storage service not yet instantiated")}get disposed(){return this._disposed}dispose(){this._disposed=!0}async getSnapshotTree(e,t){return this.runWithRetry((async()=>this.internalStorageServiceP.then((async n=>n.getSnapshotTree(e,t)))),"storage_getSnapshotTree")}async getSnapshot(e){return this.runWithRetry((async()=>this.internalStorageServiceP.then((async t=>{if(void 0!==t.getSnapshot)return t.getSnapshot(e);throw new ai.eb("getSnapshot api should exist on internal storage in RetriableDocStorageService class")}))),"storage_getSnapshot")}async readBlob(e){return this.runWithRetry((async()=>this.internalStorageServiceP.then((async t=>t.readBlob(e)))),"storage_readBlob")}async getVersions(e,t,n,r){return this.runWithRetry((async()=>this.internalStorageServiceP.then((async o=>o.getVersions(e,t,n,r)))),"storage_getVersions")}async uploadSummaryWithContext(e,t){return(0,Wo.vA)(0===t.referenceSequenceNumber==(void 0===t.ackHandle),593),0!==t.referenceSequenceNumber?this.internalStorageServiceP.then((async n=>n.uploadSummaryWithContext(e,t))):this.runWithRetry((async()=>this.internalStorageServiceP.then((async n=>n.uploadSummaryWithContext(e,t)))),"storage_uploadSummaryWithContext")}async downloadSummary(e){return this.runWithRetry((async()=>this.internalStorageServiceP.then((async t=>t.downloadSummary(e)))),"storage_downloadSummary")}async createBlob(e){return this.runWithRetry((async()=>this.internalStorageServiceP.then((async t=>t.createBlob(e)))),"storage_createBlob")}checkStorageDisposed(e,t){if(this._disposed)throw this.logger.sendTelemetryEvent({eventName:`${e}_abortedStorageDisposed`,fetchCallName:e},t),new ai.gn("Storage Service is disposed. Cannot retry",{canRetry:!1})}async runWithRetry(e,t){return ei(e,t,this.logger,{onRetry:(e,n)=>this.checkStorageDisposed(t,n)})}}class ws{get summarizeProtocolTree(){return!0===this._summarizeProtocolTree}get loadedGroupIdSnapshots(){return this._loadedGroupIdSnapshots}constructor(e,t,n={},r,o,i){this.logger=t,this.blobContents=n,this.loadingGroupIdSnapshotsFromPendingState=r,this.addProtocolSummaryIfMissing=o,this.enableSummarizeProtocolTree=i,this._loadedGroupIdSnapshots={},this.disposed=!1,this._storageService=new Cs(e,t)}dispose(e){this._storageService?.dispose?.(e),this.disposed=!0}connectToService(e){if(!(this._storageService instanceof Cs))return;const t=e.connectToStorage(),n=this._storageService=new Ss(t,this.logger);this._storageService=new bs(n,((...e)=>(this.logger.sendTelemetryEvent({eventName:"summarizeProtocolTreeEnabled"}),this.addProtocolSummaryIfMissing(...e))),(()=>{const t=e.policies?.summarizeProtocolTree??this.enableSummarizeProtocolTree??!1;return this._summarizeProtocolTree!==t&&this.logger.sendTelemetryEvent({eventName:"isSummarizeProtocolTreeEnabled",details:{value:t}}),this._summarizeProtocolTree=t,this._summarizeProtocolTree}))}loadSnapshotFromSnapshotBlobs(e){for(const[t,n]of Object.entries(e))this.blobContents[t]=n}clearPendingState(){this.loadingGroupIdSnapshotsFromPendingState=void 0}get policies(){try{return this._storageService.policies}catch{}}get maximumCacheDurationMs(){return this.policies?.maximumCacheDurationMs}async getSnapshotTree(e,t){return this._storageService.getSnapshotTree(e,t)}async getSnapshot(e){let t;if(void 0!==this.loadingGroupIdSnapshotsFromPendingState&&void 0!==e?.loadingGroupIds){const n=this.loadingGroupIdSnapshotsFromPendingState[e.loadingGroupIds[0]];(0,Wo.vA)(void 0!==n,2416),t=function(e,t){const n=new Map;for(const[t,r]of Object.entries(e.snapshotBlobs))n.set(t,(0,Ci.Xg)(r,"utf8"));return{snapshotTree:e.baseSnapshot,blobContents:n,ops:[],sequenceNumber:t,latestSequenceNumber:void 0,snapshotFormatV:1}}(n,n.snapshotSequenceNumber)}else{if(void 0===this._storageService.getSnapshot)throw new ys("getSnapshot api should exist in internal storage in ContainerStorageAdapter");t=await this._storageService.getSnapshot(e)}const n=e?.loadingGroupIds;if((0,Wo.vA)(void 0!==t.sequenceNumber,2417),void 0!==n)for(const e of n){(this._loadedGroupIdSnapshots[e]?.sequenceNumber??-1)<t.sequenceNumber&&(this._loadedGroupIdSnapshots[e]=t)}return t}async readBlob(e){const t=this.blobContents[e];if(void 0!==t){if("string"==typeof t){return(0,Ci.Xg)(t,"utf8")}return t}return this._storageService.readBlob(e)}async getVersions(e,t,n,r){return this._storageService.getVersions(e,t,n,r)}async uploadSummaryWithContext(e,t){return this._storageService.uploadSummaryWithContext(e,t)}async createBlob(e){return this._storageService.createBlob(e)}async downloadSummary(e){return this._storageService.downloadSummary(e)}}class Cs{constructor(e,t){this.detachedStorage=e,this.logger=t,this.getSnapshotTree=this.notCalled,this.getSnapshot=this.notCalled,this.getVersions=this.notCalled,this.write=this.notCalled,this.uploadSummaryWithContext=this.notCalled,this.downloadSummary=this.notCalled}async createBlob(e){return this.verifyStorage().createBlob(e)}async readBlob(e){return this.verifyStorage().readBlob(e)}verifyStorage(){if(void 0===this.detachedStorage)throw new ys("Real storage calls not allowed in Unattached container");return this.detachedStorage}get policies(){return this.notCalled()}notCalled(){this.verifyStorage();try{throw new Error("BlobOnlyStorage not implemented method used")}catch(e){throw this.logger.sendTelemetryEvent({eventName:"BlobOnlyStorageWrongCall"},e),e}}}const Es=".blobs",ks=".redirectTable";async function Ps(e,t){const n={};if(oi(e)){const t=e.blobContents;for(const[e,r]of t.entries())n[e]=(0,Ci.JR)(r,"utf8")}else await Ts(e,n,t);return n}async function Ts(e,t,n,r=!0){const o=[];for(const[i,s]of Object.entries(e.trees))r&&i===Es?o.push(Ns(s,t,n)):o.push(Ts(s,t,n,!1));for(const r of Object.values(e.blobs)){const e=await n.readBlob(r);t[r]=(0,Ci.JR)(e,"utf8")}return Promise.all(o)}async function Ns(e,t,n){const r=e.blobs[ks];(0,Wo.vA)(void 0!==r,2510);const o=await n.readBlob(r);t[r]=(0,Ci.JR)(o,"utf8")}const As={...s(3275).k,clientSessionExpiredError:"clientSessionExpiredError"};class Is extends ci.iq{constructor(e,t,n){super(e,n),this.retryAfterSeconds=t,this.errorType=As.throttlingError}static wrap(e,t,n){return(0,ci.G)(e,(e=>new Is(e,t)),n)}}function Os(e){if(Ui(e))return!0;switch(e.type){case Jo.Go.Propose:case Jo.Go.Reject:case Jo.Go.NoOp:case Jo.Go.Accept:case Jo.Go.Summarize:return!0;default:return!1}}class Ls extends ui.o{get active(){return this._active()}get disposed(){return this._closed}get IDeltaSender(){return this}get inbound(){return this._inbound}get inboundSignal(){return this._inboundSignal}get initialSequenceNumber(){return this.initSequenceNumber}get lastSequenceNumber(){return this.lastProcessedSequenceNumber}get lastMessage(){return this.lastProcessedMessage}get lastKnownSeqNumber(){return this.lastObservedSeqNumber}get minimumSequenceNumber(){return this.minSequenceNumber}get hasCheckpointSequenceNumber(){return(0,Wo.vA)(this.connectionManager.connected,223),void 0!==this._checkpointSequenceNumber}get maxMessageSize(){return this.connectionManager.maxMessageSize}get version(){return this.connectionManager.version}get serviceConfiguration(){return this.connectionManager.serviceConfiguration}get outbound(){return this.connectionManager.outbound}get readOnlyInfo(){return this.connectionManager.readOnlyInfo}get clientDetails(){return this.connectionManager.clientDetails}submit(e,t,n=!1,r,o,i){const s={contents:t,metadata:r,referenceSequenceNumber:i??this.lastProcessedSequenceNumber,type:e,compression:o};n||this.flush();const a=this.connectionManager.prepareMessageToSend(s);return void 0===a?-1:((0,Wo.vA)(Os(a),1049),void 0!==t&&(this.opsSize+=t.length),this.messageBuffer.push(a),a.type===Jo.Go.NoOp&&this.noOpCount++,this.emit("submitOp",a),n||this.flush(),a.clientSequenceNumber)}submitSignal(e,t){return this.connectionManager.submitSignal(e,t)}flush(){const e=this.messageBuffer;0!==e.length&&(this.messageBuffer=[],this.emit("prepareSend",e),1===e.length?(0,Wo.vA)(void 0===e[0].metadata?.batch,969):((0,Wo.vA)(!0===e[0].metadata?.batch,970),(0,Wo.vA)(!1===e[e.length-1].metadata?.batch,971)),this.connectionManager.sendMessages(e),(0,Wo.vA)(0===this.messageBuffer.length,972))}get connectionProps(){return{sequenceNumber:this.lastSequenceNumber,opsSize:this.opsSize>0?this.opsSize:void 0,deltaManagerState:this._disposed?"disposed":this._closed?"closed":"open",...this.connectionManager.connectionProps}}logConnectionIssue(e){(0,Wo.vA)(this.connectionManager.connected,568);const t=this.pending.sort(((e,t)=>e.sequenceNumber-t.sequenceNumber));this.logger.sendTelemetryEvent({...e,fetchReason:this.fetchReason,lastQueuedSequenceNumber:this.lastQueuedSequenceNumber,lastProcessedSequenceNumber:this.lastProcessedSequenceNumber,lastObserved:this.lastObservedSeqNumber,...this.connectionManager.connectionVerboseProps,pendingOps:this.pending.length,pendingFirst:t[0]?.sequenceNumber,haveHandler:void 0!==this.handler,inboundLength:this.inbound.length,inboundPaused:this.inbound.paused})}constructor(e,t,n,r){super(((e,t)=>{this.logger.sendErrorEvent({eventName:"DeltaManagerEventHandlerException",name:"string"==typeof e?e:void 0},t),this.close((0,ci.cQ)(t))})),this.serviceProvider=e,this.logger=t,this._active=n,this.pending=[],this.currentlyProcessingOps=!1,this.minSequenceNumber=0,this.lastQueuedSequenceNumber=0,this.lastObservedSeqNumber=0,this.lastProcessedSequenceNumber=0,this.noOpCount=0,this.lastClientSequenceNumber=0,this.opsSize=0,this.initSequenceNumber=0,this._closed=!1,this._disposed=!1,this.throttlingIdSet=new Set,this.timeTillThrottling=0,this.closeAbortController=new AbortController,this.deltaStorageDelayId=(0,wi.A)(),this.deltaStreamDelayId=(0,wi.A)(),this.messageBuffer=[];const o={incomingOpHandler:(e,t)=>{try{this.enqueueMessages(e,t)}catch(e){this.logger.sendErrorEvent({eventName:"EnqueueMessages_Exception"},e),this.close((0,ci.cQ)(e))}},signalHandler:e=>{for(const t of e)this._inboundSignal.push(t)},reconnectionDelayHandler:(e,t)=>this.emitDelayInfo(this.deltaStreamDelayId,e,t),closeHandler:e=>this.close(e),disconnectHandler:e=>this.disconnectHandler(e),connectHandler:e=>this.connectHandler(e),pongHandler:e=>this.emit("pong",e),readonlyChangeHandler:(e,t)=>{(0,li.uk)(this,this.logger,"readonly",e,t)},establishConnectionHandler:e=>this.establishingConnection(e),cancelConnectionHandler:e=>this.cancelEstablishingConnection(e)};this.connectionManager=r(o),this._inbound=new zi((e=>{this.processInboundMessage(e)})),this._inbound.on("error",(e=>{this.close(ai.I9.wrapIfUnrecognized(e,"deltaManagerInboundErrorHandler",this.lastMessage))})),this._inboundSignal=new zi((e=>{if(void 0===this.handler)throw new Error("Attempted to process an inbound signal without a handler attached");this.handler.processSignal({...e,content:JSON.parse(e.content)})})),this._inboundSignal.on("error",(e=>{this.close((0,ci.cQ)(e))}))}cancelEstablishingConnection(e){this.emit("cancelEstablishingConnection",e)}establishingConnection(e){this.emit("establishingConnection",e)}connectHandler(e){this.refreshDelayInfo(this.deltaStreamDelayId);const t=this.connectionManager.connectionVerboseProps;t.connectionLastQueuedSequenceNumber=this.lastQueuedSequenceNumber,t.connectionLastObservedSeqNumber=this.lastObservedSeqNumber;const n=e.checkpointSequenceNumber;this._checkpointSequenceNumber=n,void 0!==n&&this.updateLatestKnownOpSeqNumber(n),(0,Wo.vA)(0===this.messageBuffer.length,233),this.opsSize=0,this.noOpCount=0,this.emit("connect",e,void 0===n?void 0:this.lastObservedSeqNumber-this.lastSequenceNumber),void 0!==n?n>this.lastQueuedSequenceNumber&&this.fetchMissingDeltas("AfterConnection"):"read"===e.mode&&this.fetchMissingDeltas("AfterReadConnection")}async attachOpHandler(e,t,n,r="none",o=t){if(this.initSequenceNumber=t,this.lastProcessedSequenceNumber=o,this.minSequenceNumber=e,this.lastQueuedSequenceNumber=o,this.lastObservedSeqNumber=o,(0,Wo.vA)(void 0===this.handler,226),this.handler=n,(0,Wo.vA)(!!this.handler,227),(0,Wo.vA)(void 0===this.fetchReason,616),!this._closed){if(this._inbound.resume(),this._inboundSignal.resume(),"none"!==r){const e="cached"===r;await this.fetchMissingDeltasCore(`DocumentOpen_${r}`,e),e&&this.fetchMissingDeltas("PostDocumentOpen")}(0,Wo.vA)(void 0!==this.fetchReason||0===this.pending.length,617)}}connect(e){const t=e.fetchOpsFromStorage??!0;!function(e,t,n){if(e)return!0;const r="string"==typeof n?{eventName:n,category:"error"}:{category:"error",...n};t.send(r)}(void 0!==this.handler||!t,this.logger,"CantFetchWithoutBaseline"),t&&this.fetchMissingDeltas(e.reason.text),this.connectionManager.connect(e.reason,e.mode)}async getDeltas(e,t,n,r,o){const i=this.serviceProvider();if(void 0===i)throw new Error("Delta manager is not attached");let s;if(void 0===this.deltaStorage&&(this.deltaStorage=await i.connectToDeltaStorage()),void 0===t)s=e=>e.sequenceNumber>=this.lastObservedSeqNumber;else{const r=t-1;if(this.lastQueuedSequenceNumber>=r)return void this.logger.sendPerformanceEvent({reason:n,eventName:"ExtraStorageCall",early:!0,from:e,to:t,...this.connectionManager.connectionVerboseProps});s=e=>e.sequenceNumber>=r}const a=new AbortController;let c=!1;const l=e=>{(0,Wo.vA)(e.sequenceNumber===this.lastQueuedSequenceNumber,570),!c&&s(e)&&(a.abort("DeltaManager getDeltas fetch cancelled"),this._inbound.off("push",l))};try{this._inbound.on("push",l),(0,Wo.vA)(null===this.closeAbortController.signal.onabort,488),this.closeAbortController.signal.addEventListener("abort",(()=>a.abort(this.closeAbortController.signal.reason)));const i=this.deltaStorage.fetchMessages(e,t,a.signal,o,n);for(;;){const e=await i.read();if(e.done)break;try{c=!0,r(e.value)}finally{c=!1}}}finally{a.signal.aborted&&this.logger.sendTelemetryEvent({eventName:"DeltaManager_GetDeltasAborted",fetchReason:n,reason:a.signal.reason}),this.closeAbortController.signal.onabort=null,this._inbound.off("push",l),(0,Wo.vA)(!c,649)}}close(e){this._closed||(this._closed=!0,this.connectionManager.dispose(e,!0),this.clearQueues(),this.emit("closed",e))}dispose(e){if(!this._disposed){if(void 0!==e&&!(0,Xo.X)(e))throw new ai.eb("Error must be a Fluid error");this._disposed=!0,this._closed=!0,this.connectionManager.dispose(e,!1),this.clearQueues(),this.emit("disposed",e),this.removeAllListeners()}}clearQueues(){this.closeAbortController.abort("DeltaManager is closed"),this._inbound.clear(),this._inboundSignal.clear(),this._inbound.pause(),this._inboundSignal.pause(),this.pending=[]}refreshDelayInfo(e){this.throttlingIdSet.delete(e),0===this.throttlingIdSet.size&&(this.timeTillThrottling=0)}disconnectHandler(e){this.messageBuffer.length=0,this.emit("disconnect",e.text,e.error)}emitDelayInfo(e,t,n){const r=Date.now();if(this.throttlingIdSet.add(e),t>0&&r+t>this.timeTillThrottling){this.timeTillThrottling=r+t;const e=Is.wrap(n,t/1e3,this.logger);this.emit("throttled",e)}}comparableMessagePayload(e){return`${e.clientId}-${e.type}-${e.minimumSequenceNumber}-${e.referenceSequenceNumber}-${e.timestamp}`}enqueueMessages(e,t,n=!1){if(void 0===this.handler)return void(this.pending=[...this.pending,...e]);if((0,Wo.vA)(0===this.pending.length||void 0!==this.fetchReason,489),0===e.length)return;const r=e[0].sequenceNumber,o=e[e.length-1].sequenceNumber;if(o>this.lastQueuedSequenceNumber){let i=r-1;const s=i-this.lastQueuedSequenceNumber;let a,c,l=0,u=0;for(const t of e)t.sequenceNumber===i?l++:t.sequenceNumber!==i+1&&(u++,void 0===a&&(a=i+1)),i=t.sequenceNumber;0!==l||0!==u&&!n||s>0&&void 0===this.fetchReason?c="enqueueMessages":void 0!==this.fetchReason&&this.fetchReason!==t&&r<=this.lastQueuedSequenceNumber+1&&o>this.lastQueuedSequenceNumber&&(c="enqueueMessagesExtraFetch"),void 0!==c&&this.logger.sendPerformanceEvent({eventName:c,reason:t,previousReason:this.prevEnqueueMessagesReason,from:r,to:o+1,length:e.length,fetchReason:this.fetchReason,duplicate:l>0?l:void 0,initialGap:0===s?void 0:s,gap:u>0?u:void 0,firstMissing:a,dmInitialSeqNumber:this.initialSequenceNumber,...this.connectionManager.connectionVerboseProps})}this.updateLatestKnownOpSeqNumber(e[e.length-1].sequenceNumber);const i=this.previouslyProcessedMessage?.sequenceNumber;(0,Wo.vA)(void 0===i||i===this.lastQueuedSequenceNumber,236);for(const n of e)if(n.sequenceNumber<=this.lastQueuedSequenceNumber){if(this.previouslyProcessedMessage?.sequenceNumber===n.sequenceNumber){const e=this.comparableMessagePayload(this.previouslyProcessedMessage),t=this.comparableMessagePayload(n);if(e!==t){const r=new Zo.OI("Found two messages with the same sequenceNumber but different payloads. Likely to be a service issue",po.a.fileOverwrittenInStorage,{clientId:this.connectionManager.clientId,sequenceNumber:n.sequenceNumber,message1:e,message2:t,driverVersion:void 0});this.close(r)}}}else n.sequenceNumber===this.lastQueuedSequenceNumber+1?(this.lastQueuedSequenceNumber=n.sequenceNumber,this.previouslyProcessedMessage=n,this._inbound.push(n)):(this.pending.push(n),this.fetchMissingDeltas(t,n.sequenceNumber));this.prevEnqueueMessagesReason=this.pending.length>0?"unknown":t}processInboundMessage(e){const t=Date.now();(0,Wo.vA)(!this.currentlyProcessingOps,943),this.currentlyProcessingOps=!0,this.lastProcessedMessage=e;const n="string"==typeof e.clientId;if((0,Wo.vA)(null===e.clientId||n,1050),!n&&Os(e)&&e.type!==Jo.Go.NoOp)throw new ai.EW("Mismatch in clientId",{...(0,ai.ds)(e),messageType:e.type});if(void 0!==this.connectionManager.clientId&&this.connectionManager.clientId===e.clientId){e.type===Jo.Go.NoOp&&this.noOpCount--;const t=e.clientSequenceNumber-this.lastClientSequenceNumber-1;if(this.noOpCount-=t,this.noOpCount<0)throw new Error(`gap in client sequence number: ${t}`);this.lastClientSequenceNumber=e.clientSequenceNumber}if(this.connectionManager.beforeProcessingIncomingOp(e),this.minSequenceNumber>e.minimumSequenceNumber)throw ai.I9.create("Invalid MinimumSequenceNumber from service - document may have been restored to previous state","DeltaManager.processInboundMessage",e,{clientId:this.connectionManager.clientId});const r=e.sequenceNumber-e.minimumSequenceNumber;if(r<0||0===r&&null!==e.clientId)throw new ai.EW("MSN has to be lower than sequence #",(0,ai.ds)(e));if(this.minSequenceNumber=e.minimumSequenceNumber,e.sequenceNumber!==this.lastProcessedSequenceNumber+1)throw new ai.EW("Found a non-Sequential sequenceNumber",{...(0,ai.ds)(e),clientId:this.connectionManager.clientId});if(this.lastProcessedSequenceNumber=e.sequenceNumber,(0,Wo.vA)(this.lastProcessedSequenceNumber<=this.lastObservedSeqNumber,615),void 0===this.handler)throw new Error("Attempted to process an inbound message without a handler attached");this.handler.process(e),this.currentlyProcessingOps=!1;const o=Date.now();this.emit("op",e,o-t)}fetchMissingDeltas(e,t){this.fetchMissingDeltasCore(e,!1,t).catch((e=>{this.logger.sendErrorEvent({eventName:"fetchMissingDeltasException"},e)}))}async fetchMissingDeltasCore(e,t,n){if(void 0===this.fetchReason)if(this._closed)this.logger.sendTelemetryEvent({eventName:"fetchMissingDeltasClosedConnection",reason:e});else if(void 0!==this.handler)try{let r=this.lastQueuedSequenceNumber+1;const o=this.previouslyProcessedMessage?.sequenceNumber;void 0!==o&&((0,Wo.vA)(o===this.lastQueuedSequenceNumber,242),(0,Wo.vA)(r>1,243),r--);const i=`${e}_fetch`;this.fetchReason=i,await this.getDeltas(r,n,i,(e=>{this.refreshDelayInfo(this.deltaStorageDelayId),this.enqueueMessages(e,i)}),t)}catch(e){this.logger.sendErrorEvent({eventName:"GetDeltas_Exception"},e),this.close((0,ci.cQ)(e))}finally{this.refreshDelayInfo(this.deltaStorageDelayId),this.fetchReason=void 0,this.processPendingOps(e)}else(0,Wo.vA)(0===this.lastQueuedSequenceNumber,619)}processPendingOps(e){if(this._closed)return;(0,Wo.vA)(void 0!==this.handler,620);const t=this.pending.sort(((e,t)=>e.sequenceNumber-t.sequenceNumber));this.pending=[],this.enqueueMessages(t,`${e}_pending`,!0),void 0===this.fetchReason&&this.lastQueuedSequenceNumber<this.lastObservedSeqNumber&&this.fetchMissingDeltas("OpsBehind")}updateLatestKnownOpSeqNumber(e){this.lastObservedSeqNumber<e&&(this.lastObservedSeqNumber=e)}}var Ds=s(709),Rs=s(6102),Fs=s(9307);const{debug:Ms}=Rs;class xs{static mixinDebugLogger(e,t,n){const r=Ms(e),o=Ms(e);return o.log=function(...e){!0===r.enabled?Ms.log(...e):Fs.error(...e)},o.enabled=!0,(0,ho.Z)({namespace:e,loggers:[t,new xs(r,o)],properties:n,tryInheritProperties:!0})}constructor(e,t){this.debug=e,this.debugErr=t}send(e){const t={...e},n="error"===t.category;let r=n?this.debugErr:this.debug;const o=e.eventName.lastIndexOf(ho.Hf),i=e.eventName.slice(Math.max(0,o+1));o>0&&(r=r.extend(e.eventName.slice(0,o))),t.eventName=void 0;let s="";s=`tick=${(0,ho.T0)((0,zo.l)())}`;const a=t.stack??"";let c;t.stack=void 0;try{c=JSON.stringify(t)}catch{t.error=void 0,c=JSON.stringify(t)}"{}"===c&&(c=""),n&&(r.enabled=!0),r(`${i} ${c} ${s} ${a}`)}}function _s(e){if(void 0===e)throw new Error("Object is not a IResolveUrl.")}class Us{constructor(e,t){this.container=e,this.loader=t}async resolve(e){if(e.url.startsWith("/")){_s(this.container.resolvedUrl);return await this.container.clone({resolvedUrl:{...this.container.resolvedUrl},version:e.headers?.[Ds.d.version]??void 0,loadMode:e.headers?.[Ds.d.loadMode]},{canReconnect:e.headers?.[Ds.d.reconnect],clientDetailsOverride:e.headers?.[Ds.d.clientDetails]})}if(void 0===this.loader)throw new Error("Cannot resolve external containers");return this.loader.resolve(e)}}class js{constructor(e){const{urlResolver:t,documentServiceFactory:n,codeLoader:r,options:o,scope:i,logger:s,configProvider:a,protocolHandlerBuilder:c}=e,l={loaderId:(0,wi.A)(),loaderVersion:ps},u=(0,di.fG)(xs.mixinDebugLogger("fluid:telemetry",s,{all:l}),di.lh.value,a);this.services={urlResolver:t,documentServiceFactory:n,codeLoader:r,options:o??{},scope:!1===o?.provideScopeLoader?{...i}:{...i,ILoader:this},protocolHandlerBuilder:c,subLogger:u.logger},this.mc=(0,di.CL)({logger:this.services.subLogger,namespace:"Loader"})}async createDetachedContainer(e,t){return Qs.createDetached({...t,...this.services},e)}async rehydrateDetachedContainerFromSnapshot(e,t){return Qs.rehydrateDetachedFromSnapshot({...t,...this.services},e)}async resolve(e,t){const n=void 0===t?"Resolve":"ResolveWithPendingState";return ho.Bt.timedExecAsync(this.mc.logger,{eventName:n},(async()=>{return this.resolveCore(e,void 0===(n=t)?void 0:JSON.parse(n));var n}))}async resolveCore(e,t){const n=await this.services.urlResolver.resolve(e);_s(n);const r=Ei(n.url);if(void 0===r)throw new Error(`Invalid URL ${n.url}`);if(void 0!==t){const e=Ei(t.url);if(e?.id!==r.id||e?.path.replace(/\/$/,"")!==r.path.replace(/\/$/,"")){const e=`URL ${n.url} does not match pending state URL ${t.url}`;throw new Error(e)}}return e.headers??={},e.headers[Ds.d.version]=r.version??e.headers[Ds.d.version],this.loadContainer(e,n,t)}async loadContainer(e,t,n){return Qs.load({resolvedUrl:t,version:e.headers?.[Ds.d.version]??void 0,loadMode:e.headers?.[Ds.d.loadMode],pendingLocalState:n},{canReconnect:e.headers?.[Ds.d.reconnect],clientDetailsOverride:e.headers?.[Ds.d.clientDetails],...this.services})}}class zs extends qo.X{constructor(e=2e3,t=50){super(),this.NoopCountFrequency=t,this.opsProcessedSinceOpSent=0,e!==Number.POSITIVE_INFINITY&&(this.timer=new is(e,(()=>{0!==this.opsProcessedSinceOpSent&&this.emit("wantsNoop")})))}notifyMessageProcessed(e){Ui(e)&&(this.opsProcessedSinceOpSent++,this.opsProcessedSinceOpSent===this.NoopCountFrequency&&queueMicrotask((()=>{this.opsProcessedSinceOpSent>=this.NoopCountFrequency&&(this.emit("wantsNoop"),(0,Wo.vA)(0===this.opsProcessedSinceOpSent,579))})),void 0!==this.timer&&(1===this.opsProcessedSinceOpSent&&this.timer.restart(),(0,Wo.vA)(this.timer.hasTimer,578)))}notifyDisconnect(){this.opsProcessedSinceOpSent=0}notifyMessageSent(){this.opsProcessedSinceOpSent=0}}var qs,Bs;!function(e){e[e.NoCaching=0]="NoCaching",e[e.Prefetch=1]="Prefetch"}(qs||(qs={})),function(e){e.default="default",e.noCache="noCache"}(Bs||(Bs={}));class $s{constructor(e,t,n,r,o,i,s,a){if(this.pendingLocalState=e,this.storageAdapter=n,this._offlineLoadEnabled=r,this.containerDirty=i,this.supportGetSnapshotApi=s,this.processedOps=[],this.lastSavedOpSequenceNumber=0,this.snapshotRefreshTimeoutMs=864e5,this.mc=(0,di.CL)({logger:t,namespace:"serializedStateManager"}),this.snapshotRefreshTimeoutMs=a??this.snapshotRefreshTimeoutMs,this.refreshTimer=new is(this.snapshotRefreshTimeoutMs,(()=>this.tryRefreshSnapshot())),e&&e.savedOps.length>0){const t=e.savedOps.length;this.lastSavedOpSequenceNumber=e.savedOps[t-1].sequenceNumber}o.on("saved",(()=>this.updateSnapshotAndProcessedOpsMaybe()))}get offlineLoadEnabled(){return this._offlineLoadEnabled}get refreshSnapshotP(){return this._refreshSnapshotP}addProcessedOp(e){this.offlineLoadEnabled&&(this.processedOps.push(e),this.updateSnapshotAndProcessedOpsMaybe())}async fetchSnapshot(e){if(void 0===this.pendingLocalState){const{baseSnapshot:t,version:n}=await Hs(this.mc,this.storageAdapter,this.supportGetSnapshotApi(),e),r=ii(t);if(this.offlineLoadEnabled){const e=await Ps(t,this.storageAdapter),n=await Ri(this.storageAdapter,r);this.snapshot={baseSnapshot:r,snapshotBlobs:e,snapshotSequenceNumber:n.sequenceNumber},this.refreshTimer.start()}return{baseSnapshot:t,version:n}}{const{baseSnapshot:e,snapshotBlobs:t}=this.pendingLocalState,n=await Ri(this.storageAdapter,e);this.snapshot={baseSnapshot:e,snapshotBlobs:t,snapshotSequenceNumber:n.sequenceNumber},this.tryRefreshSnapshot();const r=new Map;for(const[e,n]of Object.entries(t))r.set(e,(0,Ci.Xg)(n,"utf8"));return{baseSnapshot:{sequenceNumber:this.snapshot.snapshotSequenceNumber,snapshotTree:e,blobContents:r,latestSequenceNumber:void 0,ops:[],snapshotFormatV:1},version:void 0}}}tryRefreshSnapshot(){!0===this.mc.config.getBoolean("Fluid.Container.enableOfflineSnapshotRefresh")&&void 0===this._refreshSnapshotP&&void 0===this.latestSnapshot&&(this._refreshSnapshotP=this.refreshLatestSnapshot(this.supportGetSnapshotApi()),this._refreshSnapshotP.catch((e=>{this.mc.logger.sendTelemetryEvent({eventName:"RefreshLatestSnapshotFailed",error:e})})).finally((()=>{this._refreshSnapshotP=void 0})))}async refreshLatestSnapshot(e){this.latestSnapshot=await async function(e,t,n){return ho.Bt.timedExecAsync(e.logger,{eventName:"GetLatestSnapshotInfo"},(async()=>{const r=await t.getVersions(null,1,"getLatestSnapshotInfo",Bs.noCache),{baseSnapshot:o}=await Hs(e,t,n,r[0]?.id),i=ii(o),s=Date.now();return{baseSnapshot:i,snapshotBlobs:await Ps(o,t),snapshotSequenceNumber:(await Ri(t,i)).sequenceNumber,snapshotFetchedTime:s}})).catch((()=>{}))}(this.mc,this.storageAdapter,e);const t=Object.keys(this.storageAdapter.loadedGroupIdSnapshots);if(e&&t.length>0){(0,Wo.vA)(void 0!==this.storageAdapter.getSnapshot,2418);const e=await this.storageAdapter.getSnapshot({versionId:void 0,scenarioName:"getLatestSnapshotInfo",cacheSnapshot:!1,loadingGroupIds:t,fetchSource:Bs.noCache});(0,Wo.vA)(void 0!==e,2419)}return this.updateSnapshotAndProcessedOpsMaybe()}updateSnapshotAndProcessedOpsMaybe(){const e=this.latestSnapshot?.snapshotSequenceNumber;if(void 0===e||0===this.processedOps.length||this.processedOps[this.processedOps.length-1].sequenceNumber<this.lastSavedOpSequenceNumber||this.containerDirty())return-1;const t=this.processedOps[0].sequenceNumber,n=this.processedOps[this.processedOps.length-1].sequenceNumber;return e<t?(this.mc.logger.sendTelemetryEvent({eventName:"OldSnapshotFetchWhileRefreshing",snapshotSequenceNumber:e,firstProcessedOpSequenceNumber:t,lastProcessedOpSequenceNumber:n,stashedSnapshotSequenceNumber:this.snapshot?.snapshotSequenceNumber}),this.latestSnapshot=void 0,this.refreshTimer.restart()):e<=n&&(this.processedOps.splice(0,e-t+1),this.snapshot=this.latestSnapshot,this.latestSnapshot=void 0,this.refreshTimer.restart(),this.mc.logger.sendTelemetryEvent({eventName:"SnapshotRefreshed",snapshotSequenceNumber:e,firstProcessedOpSequenceNumber:t,newFirstProcessedOpSequenceNumber:0===this.processedOps.length?void 0:this.processedOps[0].sequenceNumber})),e}setInitialSnapshot(e){if(this.offlineLoadEnabled){(0,Wo.vA)(void 0===this.snapshot,2359),(0,Wo.vA)(void 0!==e,2360);const{baseSnapshot:t,snapshotBlobs:n}=e,r=".protocol"in t.trees?t.trees[".protocol"].blobs.attributes:t.blobs[".attributes"],o=JSON.parse(n[r]);(0,Wo.vA)(0===o.sequenceNumber,2361),this.snapshot={...e,snapshotSequenceNumber:o.sequenceNumber},this.refreshTimer.start()}}async getPendingLocalState(e,t,n){return ho.Bt.timedExecAsync(this.mc.logger,{eventName:"getPendingLocalState",details:{notifyImminentClosure:!1,sessionExpiryTimerStarted:void 0,snapshotSequenceNumber:void 0,processedOpsSize:this.processedOps.length},clientId:e},(async()=>{if(!this.offlineLoadEnabled)throw new ai.eb("Can't get pending local state unless offline load is enabled");(0,Wo.vA)(void 0!==this.snapshot,2277);const r=await t.getPendingLocalState({notifyImminentClosure:!1,snapshotSequenceNumber:this.snapshot.snapshotSequenceNumber,sessionExpiryTimerStarted:this.snapshot.snapshotFetchedTime}),o={};let i=!1;const s=Object.entries(this.storageAdapter.loadedGroupIdSnapshots);if(s.length>0)for(const[e,t]of s)i=!0,o[e]=Ti(t);const a={attached:!0,pendingRuntimeState:r,baseSnapshot:this.snapshot.baseSnapshot,snapshotBlobs:this.snapshot.snapshotBlobs,loadedGroupIdSnapshots:i?o:void 0,savedOps:this.processedOps,url:n.url,clientId:e};return JSON.stringify(a)}))}}async function Hs(e,t,n,r){const{snapshot:o,version:i}=n?await async function(e,t,n){const r=await(t.getSnapshot?.({versionId:n})),o=void 0===r?.snapshotTree.id?void 0:{id:r.snapshotTree.id,treeId:r.snapshotTree.id};void 0===r&&void 0!==n?e.logger.sendErrorEvent({eventName:"getSnapshotTreeFailed",id:n}):void 0!==r&&void 0===o?.id&&e.logger.sendErrorEvent({eventName:"getSnapshotFetchedTreeWithoutVersionId",hasVersion:void 0!==o});return{snapshot:r,version:o}}(e,t,r):await async function(e,t,n){const r=await t.getVersions(n??null,1),o=r[0];void 0===o&&void 0!==n&&e.logger.sendErrorEvent({eventName:"NoVersionFoundWhenSpecified",id:n});const i=await t.getSnapshotTree(o)??void 0;void 0===i&&void 0!==o?e.logger.sendErrorEvent({eventName:"getSnapshotTreeFailed",id:o.id}):void 0!==i&&void 0===o?.id&&e.logger.sendErrorEvent({eventName:"getSnapshotFetchedTreeWithoutVersionId",hasVersion:void 0!==o});return{snapshot:i,version:o}}(e,t,r);return(0,Wo.vA)(void 0!==o,2276),{baseSnapshot:o,version:i}}const Ws="saved";async function Gs(e){if(e.closed)throw new ai.eb("waitContainerToCatchUp: Container closed");return new Promise(((t,n)=>{const r=e.deltaManager,o=t=>{e.off("closed",o);const r="Container closed while waiting to catch up";n(void 0===t?new ai.gn(r):(0,ci.J4)(t,(e=>new ai.gn(`${r}: ${e}`))))};e.on("closed",o);const i=()=>{(0,Wo.vA)(e.connectionState===jo.CatchingUp||e.connectionState===jo.Connected,205);const n=r.hasCheckpointSequenceNumber,i=r.lastKnownSeqNumber;if((0,Wo.vA)(r.lastSequenceNumber<=i,614),r.lastSequenceNumber===i)return e.off("closed",o),void t(n);const s=a=>{i<=a.sequenceNumber&&(e.off("closed",o),t(n),r.off("op",s))};r.on("op",s)};if(e.connectionState===jo.Connected)return void i();const s=()=>{e.off(li.Tg,s),i()};e.on(li.Tg,s),e.connectionState===jo.Disconnected&&e.connect()}))}const Vs="summarizer";class Qs extends ui.o{static async load(e,t){const{version:n,pendingLocalState:r,loadMode:o,resolvedUrl:i}=e,s=new Qs(t,e);return ho.Bt.timedExecAsync(s.mc.logger,{eventName:"Load",...o},(async e=>new Promise(((t,a)=>{const c={opsBeforeReturn:"cached"},l=r?{...o??c,opsBeforeReturn:void 0}:o??c,u=e=>{a(e??new ai.gn("Container closed without error during load"))};s.on("closed",u),s.load(n,l,i,r).finally((()=>{s.removeListener("closed",u)})).then((n=>{e.end({...n}),t(s)}),(e=>{const t=(0,ci.cQ)(e);s.close(t),s.dispose(t),u(t)}))}))),{start:!0,end:!0,cancel:"generic"})}static async createDetached(e,t){const n=new Qs(e);return ho.Bt.timedExecAsync(n.mc.logger,{eventName:"CreateDetached"},(async e=>(await n.createDetached(t),n)),{start:!0,end:!0,cancel:"generic"})}static async rehydrateDetachedFromSnapshot(e,t){const n=new Qs(e);return ho.Bt.timedExecAsync(n.mc.logger,{eventName:"RehydrateDetachedFromSnapshot"},(async e=>{const r=function(e){const t=JSON.parse(e);if(n=t,void 0!==n?.attached&&void 0!==n?.baseSnapshot&&void 0!==n?.snapshotBlobs&&void 0!==n?.hasAttachmentBlobs)return t;if(Ko(t)){const{baseSnapshot:e,snapshotBlobs:n}=Ai(t);return{attached:!1,baseSnapshot:e,snapshotBlobs:n,hasAttachmentBlobs:void 0!==t.tree[".hasAttachmentBlobs"]}}throw new ai.eb("Cannot rehydrate detached container. Incorrect format");var n}(t);return await n.rehydrateDetachedFromSnapshot(r),n}),{start:!0,end:!0,cancel:"generic"})}setLoaded(){if("loading"===this._lifecycleState){this._lifecycleState="loaded",(0,Wo.vA)(this.connectionState!==jo.Connected,2409),this.connectionStateHandler.initProtocol(this.protocolHandler);const e=this.readOnlyInfo.readonly??!1;this.setContextConnectedState(!1,e);const t=this._deltaManager.connectionManager;if(t.connected){const e=t.connectionDetails;(0,Wo.vA)(void 0!==e,2410),this.connectionStateHandler.receivedConnectEvent(e)}}}get closed(){return"closing"===this._lifecycleState||"closed"===this._lifecycleState||this.disposed}get loaded(){return"loaded"===this._lifecycleState}get disposed(){return"disposing"===this._lifecycleState||"disposed"===this._lifecycleState}get runtime(){if(void 0===this._runtime)throw new Error("Attempted to access runtime before it was defined");return this._runtime}get protocolHandler(){if(void 0===this._protocolHandler)throw new Error("Attempted to access protocolHandler before it was defined");return this._protocolHandler}get connectionMode(){return this._deltaManager.connectionManager.connectionMode}get resolvedUrl(){return this.service?.resolvedUrl}get readOnlyInfo(){return this._deltaManager.readOnlyInfo}get containerMetadata(){return this._containerMetadata}forceReadonly(e){this._deltaManager.connectionManager.forceReadonly(e)}get deltaManager(){return this._deltaManager}get connectionState(){return this.connectionStateHandler.connectionState}get connected(){return this.connectionStateHandler.connectionState===jo.Connected}get clientId(){return this.protocolHandler.audience.getSelf()?.clientId}get isInteractiveClient(){return this.deltaManager.clientDetails.capabilities.interactive}supportGetSnapshotApi(){return!0===this.mc.config.getBoolean("Fluid.Container.UseLoadingGroupIdForSnapshotFetch2")&&!0===this.service?.policies?.supportGetSnapshotApi}getSpecifiedCodeDetails(){return this.getCodeDetailsFromQuorum()}getLoadedCodeDetails(){return this._loadedCodeDetails}get audience(){return this.protocolHandler.audience}get isDirty(){return this._dirtyContainer}async getEntryPoint(){if(this._disposed)throw new ai.eb("The context is already disposed");return void 0!==this._runtime?this._runtime.getEntryPoint?.():new Promise(((e,t)=>{const n=()=>{(0,Wo.vA)(void 0!==this._runtime,1443),e(this._runtime.getEntryPoint?.()),this._lifecycleEvents.off("disposed",r)},r=()=>{t(new Error("ContainerContext was disposed")),this._lifecycleEvents.off("runtimeInstantiated",n)};this._lifecycleEvents.once("runtimeInstantiated",n),this._lifecycleEvents.once("disposed",r)}))}constructor(e,t){super(((e,t)=>{this.mc.logger.sendErrorEvent({eventName:"ContainerEventHandlerException",name:"string"==typeof e?e:void 0},t),this.close((0,ci.cQ)(t))})),this._lifecycleState="loading",this.inboundQueuePausedFromInit=!0,this.connectionCount=0,this.connectionTransitionTimes=[],this._dirtyContainer=!1,this.attachmentData={state:wo.d.Detached},this.clientsWhoShouldHaveLeft=new Set,this._containerMetadata={},this.setAutoReconnectTime=(0,zo.l)(),this._lifecycleEvents=new qo.X,this.verifyClosedAfterCalls=0,this._disposed=!1,this.attach=Di((async(e,t)=>{await ho.Bt.timedExecAsync(this.mc.logger,{eventName:"Attach"},(async()=>{if("loaded"!==this._lifecycleState||this.attachmentData.state===wo.d.Attached)throw new ai.eb(`The Container is not in a valid state for attach [${this._lifecycleState}] and [${this.attachState}]`);const n=e=>{const t=(0,ci.cQ)(e);return this.close(t),t.addTelemetryProperties({resolvedUrl:this.service?.resolvedUrl?.url}),t};let r=(async({detachedBlobStorage:e,createOrGetStorageService:t,setAttachmentData:n,createAttachmentSummary:r,offlineLoadEnabled:o,initialAttachmentData:i})=>{let s=i;void 0===s.blobs&&(s=void 0!==e&&e.size>0?{state:wo.d.Detached,blobs:"outstanding",redirectTable:new Map}:{state:wo.d.Attaching,summary:r(),blobs:"none"},n(s));const a=await t(s.summary);if("outstanding"===s.blobs){const{redirectTable:t}=s;for((0,Wo.vA)(!!e,590);t.size<e.size;){const n=e.getBlobIds().filter((e=>!t.has(e)));for(const r of n){const n=await e.readBlob(r),o=await a.createBlob(n);t.set(r,o.id)}}n(s={state:wo.d.Attaching,summary:r(t),blobs:"done"})}(0,Wo.vA)(s.state===wo.d.Attaching,2274),"done"===s.blobs&&await a.uploadSummaryWithContext(s.summary,{referenceSequenceNumber:0,ackHandle:void 0,proposalHandle:void 0});const c=o?Ai(s.summary):void 0;return n(s={state:wo.d.Attached}),c})({initialAttachmentData:this.attachmentData,offlineLoadEnabled:this.serializedStateManager.offlineLoadEnabled,detachedBlobStorage:this.detachedBlobStorage,setAttachmentData:e=>{const t=this.attachmentData.state;this.attachmentData=e;const r=this.attachmentData.state;if(r!==t&&r!==wo.d.Detached)try{this.runtime.setAttachState(r),this.emit(r.toLocaleLowerCase())}catch(e){throw n(e)}},createAttachmentSummary:e=>{try{return(0,Wo.vA)(0===this._deltaManager.inbound.length,214),ki(this.runtime.createSummary(e),this.captureProtocolSummary())}catch(e){throw n(e)}},createOrGetStorageService:async t=>{if(void 0===this.service){const n=await this.urlResolver.resolve(e);(0,Wo.vA)(this.client.details.type!==Vs&&void 0!==n,708),this.service=await this.createDocumentService(n,{mode:"attach",summary:t})}return this.storageAdapter.connectToService(this.service),this.storageAdapter}});!0!==this.mc.config.getBoolean("Fluid.Container.RetryOnAttachFailure")&&(r=r.catch((e=>{throw n(e)})));const o=await r;this.serializedStateManager.setInitialSnapshot(o),this.closed||(this.detachedBlobStorage?.dispose?.(),this.handleDeltaConnectionArg(t?.deltaConnection,{fetchOpsFromStorage:!1,reason:{text:"createDetached"}}))}),{start:!0,end:!0,cancel:"generic"})})),this.getAbsoluteUrl=async e=>{var t;if(void 0!==this.resolvedUrl)return this.urlResolver.getAbsoluteUrl(this.resolvedUrl,e,(t=this._loadedCodeDetails,{name:Bo(t?.package)?t?.package.name:t?.package}))},this.metadataUpdateHandler=e=>{this._containerMetadata={...this._containerMetadata,...e},this.emit("metadataUpdate",e)},this.updateDirtyContainerState=e=>{this._dirtyContainer!==e&&(this._dirtyContainer=e,this.emit(e?"dirty":Ws))};const{canReconnect:n,clientDetailsOverride:r,urlResolver:o,documentServiceFactory:i,codeLoader:s,options:a,scope:c,subLogger:l,protocolHandlerBuilder:u,retryConnectionTimeoutMs:d}=e;!function(e,t){const n=(0,ds.yi)(ms,e);if(!n.isCompatible){const r=new ai.eb("Loader is not compatible with Driver",{errorDetails:JSON.stringify({loaderVersion:hs.pkgVersion,driverVersion:e?.pkgVersion,loaderGeneration:hs.generation,driverGeneration:e?.generation,minSupportedGeneration:ms.minSupportedGeneration,isGenerationCompatible:n.isGenerationCompatible,unsupportedFeatures:n.unsupportedFeatures})});throw t(r),r}}(i.ILayerCompatDetails,(e=>{})),this.connectionTransitionTimes[jo.Disconnected]=(0,zo.l)();const p=t?.pendingLocalState;this._canReconnect=n??!0,this._retryConnectionTimeoutMs=d,this.clientDetailsOverride=r,this.urlResolver=o,this.serviceFactory=i,this.codeLoader=s,this.options={...a},this.scope=c,this.protocolHandlerBuilder=u??((e,t,n)=>new Zi(e,t,n,new Fi,(e=>this.clientsWhoShouldHaveLeft.has(e)))),this.clone=async(t,n)=>Qs.load(t,{...e,...n}),this._containerId=(0,wi.A)(),this.client=Qs.setupClient(this._containerId,a.client,this.clientDetailsOverride);const h=this.client.details.type,f=this.client.details.capabilities.interactive,g=`${f?"interactive":"noninteractive"}${void 0!==h&&""!==h?`/${h}`:""}`;this.subLogger=(0,ho.pW)({logger:l,properties:{all:{clientType:g,containerId:this._containerId,docId:()=>this.resolvedUrl?.id,containerAttachState:()=>this.attachState,containerLifecycleState:()=>this._lifecycleState,containerConnectionState:()=>jo[this.connectionState],serializedContainer:void 0!==p},error:{dmInitialSeqNumber:()=>this._deltaManager?.initialSequenceNumber,dmLastProcessedSeqNumber:()=>this._deltaManager?.lastSequenceNumber,dmLastKnownSeqNumber:()=>this._deltaManager?.lastKnownSeqNumber,containerLoadedFromVersionId:()=>this._loadedFromVersion?.id,containerLoadedFromVersionDate:()=>this._loadedFromVersion?.date,dmLastMsqSeqNumber:()=>this.deltaManager?.lastMessage?.sequenceNumber,dmLastMsqSeqTimestamp:()=>this.deltaManager?.lastMessage?.timestamp,dmLastMsqSeqClientId:()=>null===this.deltaManager?.lastMessage?.clientId?"null":this.deltaManager?.lastMessage?.clientId,dmLastMsgClientSeq:()=>this.deltaManager?.lastMessage?.clientSequenceNumber,connectionStateDuration:()=>(0,zo.l)()-this.connectionTransitionTimes[this.connectionState]}}}),this.mc=(0,di.CL)({logger:this.subLogger,namespace:"Container"}),this._deltaManager=this.createDeltaManager(),this.connectionStateHandler=as({logger:this.mc.logger,mc:(0,di.Ln)(l),connectionStateChanged:(e,t,n)=>{this.logConnectionStateChangeTelemetry(e,t,n),this.loaded&&this.propagateConnectionState(e===jo.Disconnected?n:void 0)},shouldClientJoinWrite:()=>this._deltaManager.connectionManager.shouldJoinWrite(),maxClientLeaveWaitTime:a.maxClientLeaveWaitTime,logConnectionIssue:(e,t,n)=>{const r=this.connectionMode;if(this._deltaManager.logConnectionIssue({eventName:e,mode:r,category:"loading"===this._lifecycleState?"generic":t,duration:(0,zo.l)()-this.connectionTransitionTimes[jo.CatchingUp],...void 0===n?{}:{details:JSON.stringify(n)}}),(0,Wo.vA)(this.loaded,2411),"read"===r&&"error"===t){const e={text:"NoJoinSignal"};this.disconnectInternal(e),this.connectInternal({reason:e,fetchOpsFromStorage:!1})}},clientShouldHaveLeft:e=>{this.clientsWhoShouldHaveLeft.add(e)},onCriticalError:e=>{this.close((0,ci.cQ)(e))}},this.deltaManager,p?.clientId),this.on(Ws,(()=>{this.connectionStateHandler.containerSaved()}));const m=this.mc.config.getBoolean("Fluid.Container.summarizeProtocolTree2");this.detachedBlobStorage=this.attachState===wo.d.Attached?void 0:function(){const e=[];return{createBlob:async t=>({id:""+(e.push(t)-1)}),readBlob:async t=>e[Number(t)]??Promise.reject(new Error(`Blob not found: ${t}`)),get size(){return e.length},getBlobIds:()=>e.map(((e,t)=>`${t}`)),dispose:()=>e.splice(0),serialize:()=>e.length>0?JSON.stringify(e.map((e=>(0,Ci.JR)(e,"utf8")))):void 0,initialize:t=>e.push(...t.map((e=>(0,Ci.Xg)(e,"utf8"))))}}(),this.storageAdapter=new ws(this.detachedBlobStorage,this.mc.logger,p?.snapshotBlobs,p?.loadedGroupIdSnapshots,(e=>!0===Ko(e)?e:ki(e,this.captureProtocolSummary())),m);const v=(this.isInteractiveClient&&this.mc.config.getBoolean("Fluid.Container.enableOfflineLoad"))??!0===a.enableOfflineLoad;this.serializedStateManager=new $s(p,this.subLogger,this.storageAdapter,v,this,(()=>this._deltaManager.connectionManager.shouldJoinWrite()),(()=>this.supportGetSnapshotApi()),this.mc.config.getNumber("Fluid.Container.snapshotRefreshTimeoutMs"));"object"==typeof document&&null!==document&&"function"==typeof document.addEventListener&&null!==document.addEventListener&&f&&(this.lastVisible=document.hidden?(0,zo.l)():void 0,this.visibilityEventHandler=()=>{document.hidden?this.lastVisible=(0,zo.l)():setTimeout((()=>{this.lastVisible=void 0}),0)},document.addEventListener("visibilitychange",this.visibilityEventHandler))}getQuorum(){return this.protocolHandler.quorum}dispose(e){this.verifyClosedAfter((()=>this._deltaManager.dispose(e)))}close(e){this.verifyClosedAfter((()=>this._deltaManager.close(e)))}verifyClosedAfter(e){this.verifyClosedAfterCalls++;try{e()}finally{this.verifyClosedAfterCalls--}0===this.verifyClosedAfterCalls&&((0,Wo.vA)(this.connectionState===jo.Disconnected,207),(0,Wo.vA)("closed"===this._lifecycleState||"disposed"===this._lifecycleState,788))}closeCore(e){(0,Wo.vA)(!this.closed,789);try{try{this.mc.logger.sendTelemetryEvent({eventName:"ContainerClose",category:"loading"!==this._lifecycleState&&void 0!==e?"error":"generic"},e),this._lifecycleState="closing",void 0!==this.service?.off&&this.service?.off("metadataUpdate",this.metadataUpdateHandler),this._protocolHandler?.close(),this.connectionStateHandler.dispose()}catch(e){this.mc.logger.sendErrorEvent({eventName:"ContainerCloseException"},e)}this.emit("closed",e),void 0!==this.visibilityEventHandler&&document.removeEventListener("visibilitychange",this.visibilityEventHandler)}finally{this._lifecycleState="closed",this.client.details.type===Vs&&this.dispose(e)}}disposeCore(e){(0,Wo.vA)(!this._disposed,1356),this._disposed=!0;try{try{this.mc.logger.sendTelemetryEvent({eventName:"ContainerDispose",category:this.closed||void 0===e?"generic":"error"},e),"closed"!==this._lifecycleState&&(this._lifecycleState="disposing"),this._protocolHandler?.close(),this.connectionStateHandler.dispose();const t=void 0===e?void 0:new Error(e.message);this._runtime?.dispose(t),this.storageAdapter.dispose(),this.service?.dispose(e)}catch(e){this.mc.logger.sendErrorEvent({eventName:"ContainerDisposeException"},e)}this.emit("disposed",e),this.removeAllListeners(),void 0!==this.visibilityEventHandler&&document.removeEventListener("visibilitychange",this.visibilityEventHandler)}finally{this._lifecycleState="disposed",this._lifecycleEvents.emit("disposed")}}async getPendingLocalState(){if(this.closed||this._disposed)throw new ai.eb("Pending state cannot be retried if the container is closed or disposed");(0,Wo.vA)(this.attachmentData.state===wo.d.Attached,209),(0,Wo.vA)(void 0!==this.resolvedUrl&&"fluid"===this.resolvedUrl.type,210);return await this.serializedStateManager.getPendingLocalState(this.clientId,this.runtime,this.resolvedUrl)}get attachState(){return this.attachmentData.state}serialize(){if(this.attachmentData.state===wo.d.Attached||this.closed)throw new ai.eb("Container must not be attached or closed.");const e=this.attachmentData.state===wo.d.Attaching?this.attachmentData:void 0,t=e?.summary??ki(this.runtime.createSummary(),this.captureProtocolSummary()),{baseSnapshot:n,snapshotBlobs:r}=Ai(t),o=void 0===e?void 0:this.runtime.getPendingLocalState();(0,Wo.vA)(!(0,Go.$)(o),2275);const i={attached:!1,baseSnapshot:n,snapshotBlobs:r,pendingRuntimeState:o,hasAttachmentBlobs:void 0!==this.detachedBlobStorage&&this.detachedBlobStorage.size>0,attachmentBlobs:this.detachedBlobStorage?.serialize()};return JSON.stringify(i)}setAutoReconnectInternal(e,t){if(this._deltaManager.connectionManager.reconnectMode===e)return;const n=(0,zo.l)(),r=n-this.setAutoReconnectTime;this.setAutoReconnectTime=n,this.mc.logger.sendTelemetryEvent({eventName:e===xi.Enabled?"AutoReconnectEnabled":"AutoReconnectDisabled",connectionMode:this.connectionMode,connectionState:jo[this.connectionState],duration:r}),this._deltaManager.connectionManager.setAutoReconnect(e,t)}connect(){if(this.closed)throw new ai.eb("The Container is closed and cannot be connected");if(this.attachState!==wo.d.Attached)throw new ai.eb("The Container is not attached and cannot be connected");this.connected||this.connectInternal({reason:{text:"DocumentConnect"},fetchOpsFromStorage:!1})}connectInternal(e){(0,Wo.vA)(!this.closed,709),(0,Wo.vA)(this.attachState===wo.d.Attached,710);const t=xi.Enabled;this.setAutoReconnectInternal(t,e.reason),this.resumeInternal(e)}disconnect(){if(this.closed)throw new ai.eb("The Container is closed and cannot be disconnected");this.disconnectInternal({text:"DocumentDisconnect"})}disconnectInternal(e){(0,Wo.vA)(!this.closed,711);const t=xi.Disabled;this.setAutoReconnectInternal(t,e)}resumeInternal(e){(0,Wo.vA)(!this.closed,217),this.inboundQueuePausedFromInit&&((0,Wo.vA)(this.loaded,2412),this.inboundQueuePausedFromInit=!1,this._deltaManager.inbound.resume(),this._deltaManager.inboundSignal.resume()),this.connectToDeltaStream(e)}async proposeCodeDetails(e){if(!$o(e))throw new Error("Provided codeDetails are not IFluidCodeDetails");if(this.codeLoader.IFluidCodeDetailsComparer){const t=await this.codeLoader.IFluidCodeDetailsComparer.compare(e,this.getCodeDetailsFromQuorum());if(void 0!==t&&t<=0)throw new Error("Proposed code details should be greater than the current")}return this.protocolHandler.quorum.propose("code",e).then((()=>!0)).catch((()=>!1))}async processCodeProposal(){const e=this.getCodeDetailsFromQuorum();if(await Promise.all([this._deltaManager.inbound.pause(),this._deltaManager.inboundSignal.pause()]),!0===await this.satisfies(e))return this._deltaManager.inbound.resume(),void this._deltaManager.inboundSignal.resume();const t=new ai.gn("Existing context does not satisfy incoming proposal");this.close(t)}async satisfies(e){if(void 0===this._loadedModule)return!1;const t=[],n=this.codeLoader;void 0!==n.IFluidCodeDetailsComparer&&t.push(n.IFluidCodeDetailsComparer);const r=this._loadedModule?.module.fluidExport;if(void 0!==r?.IFluidCodeDetailsComparer&&t.push(r.IFluidCodeDetailsComparer),0===t.length)return!1;for(const n of t){if(!1===await n.satisfies(this._loadedModule?.details,e))return!1}return!0}connectToDeltaStream(e){this._canReconnect&&this.client.details.capabilities.interactive||(e.mode="write"),this._deltaManager.connect(e)}async createDocumentService(e,t){let n;return"load"===t.mode?(n=await this.serviceFactory.createDocumentService(e,this.subLogger,this.client.details.type===Vs),void 0!==n.on&&n.on("metadataUpdate",this.metadataUpdateHandler)):n=await ei((async()=>this.serviceFactory.createContainer(t.summary,e,this.subLogger,!1)),"containerAttach",this.mc.logger,{cancel:this._deltaManager.closeAbortController.signal}),n}async load(e,t,n,r){const o={phase1:(0,zo.l)()};this.service=await this.createDocumentService(n,{mode:"load"});const i={reason:{text:"DocumentOpen"},mode:!0===this.mc.config.getBoolean("Fluid.Container.ForceWriteConnection")||(r?.savedOps.length??0)>0?"write":"read",fetchOpsFromStorage:!1};void 0===t.deltaConnection&&this.connectToDeltaStream(i),this.storageAdapter.connectToService(this.service),this.attachmentData={state:wo.d.Attached},o.phase2=(0,zo.l)();const{baseSnapshot:s,version:a}=await this.serializedStateManager.fetchSnapshot(e),c=ii(s);this._loadedFromVersion=a;const l=await Ri(this.storageAdapter,c),u=r?.savedOps[r.savedOps.length-1]?.sequenceNumber??l.sequenceNumber;let d;switch(t.opsBeforeReturn){case void 0:this.attachDeltaManagerOpHandler(l,"none"===t.deltaConnection?"none":"all",u);break;case"cached":case"all":d=this.attachDeltaManagerOpHandler(l,t.opsBeforeReturn,u);break;default:(0,Vo.$)(t.opsBeforeReturn)}await this.initializeProtocolStateFromSnapshot(l,this.storageAdapter,c),(0,Wo.vA)(void 0===this.clientId,2413),void 0!==r?.clientId&&this.protocolHandler.audience.setCurrentClientId(r?.clientId),o.phase3=(0,zo.l)();const p=this.getCodeDetailsFromQuorum();if(await this.instantiateRuntime(p,c,r?r?.pendingRuntimeState??{}:void 0,oi(s)?s:void 0),r){for(const e of r.savedOps)this.processRemoteMessage({...e,metadata:{...e.metadata,savedOp:!0}}),await(this.runtime.notifyOpReplay?.(e));r.savedOps=[],this.storageAdapter.clearPendingState()}if(this.closed||(void 0!==d&&(this._deltaManager.inbound.resume(),await ho.Bt.timedExecAsync(this.mc.logger,{eventName:"WaitOps"},(async()=>d)),await ho.Bt.timedExecAsync(this.mc.logger,{eventName:"WaitOpProcessing"},(async()=>this._deltaManager.inbound.waitTillProcessingDone())),this._deltaManager.inbound.pause()),this.setLoaded(),this.handleDeltaConnectionArg(t.deltaConnection)),this.closed)throw new Error("Container was closed while load()");return o.end=(0,zo.l)(),this.subLogger.sendTelemetryEvent({eventName:"LoadStagesTimings",details:JSON.stringify(o)},void 0,Ho.$.verbose),{sequenceNumber:l.sequenceNumber,version:a?.id,dmLastProcessedSeqNumber:this._deltaManager.lastSequenceNumber,dmLastKnownSeqNumber:this._deltaManager.lastKnownSeqNumber}}async createDetached(e){const t={sequenceNumber:0,minimumSequenceNumber:0};await this.attachDeltaManagerOpHandler(t);const n=[["code",{key:"code",value:e,approvalSequenceNumber:0,commitSequenceNumber:0,sequenceNumber:0}]];this.initializeProtocolState(t,{members:[],proposals:[],values:n}),await this.instantiateRuntime(e,void 0),this.setLoaded()}async rehydrateDetachedFromSnapshot({baseSnapshot:e,snapshotBlobs:t,hasAttachmentBlobs:n,attachmentBlobs:r,pendingRuntimeState:o}){n&&(void 0!==r&&((0,Wo.vA)(void 0!==this.detachedBlobStorage,2958),function(e,t){(0,Wo.vA)(0===e.size,2462);const n=JSON.parse(t);(0,Wo.vA)(Array.isArray(n),2463),e.initialize(n)}(this.detachedBlobStorage,r)),(0,Wo.vA)(void 0!==this.detachedBlobStorage&&this.detachedBlobStorage.size>0,592));const i=Oi(e,t);this.storageAdapter.loadSnapshotFromSnapshotBlobs(t);const s=await Ri(this.storageAdapter,i);await this.attachDeltaManagerOpHandler(s);const a=Ii(i),c=await(0,si.P)(this.storageAdapter,a.blobs.quorumValues);this.initializeProtocolState(s,{members:[],proposals:[],values:c});const l=this.getCodeDetailsFromQuorum();await this.instantiateRuntime(l,i,o),this.setLoaded()}async initializeProtocolStateFromSnapshot(e,t,n){const r={members:[],proposals:[],values:[]};if(void 0!==n){const e=Ii(n);[r.members,r.proposals,r.values]=await Promise.all([(0,si.P)(t,e.blobs.quorumMembers),(0,si.P)(t,e.blobs.quorumProposals),(0,si.P)(t,e.blobs.quorumValues)])}this.initializeProtocolState(e,r)}initializeProtocolState(e,t){const n=this.protocolHandlerBuilder(e,t,((e,t)=>this.submitMessage(Jo.Go.Propose,JSON.stringify({key:e,value:t})))),r=(0,ho.pW)({logger:this.subLogger,namespace:"ProtocolHandler"});n.quorum.on("error",(e=>{r.sendErrorEvent(e)})),n.quorum.on("addProposal",(e=>{"code"!==e.key&&"code2"!==e.key||this.emit("codeDetailsProposed",e.value,e)})),n.quorum.on("approveProposal",((e,t,n)=>{"code"!==t&&"code2"!==t||($o(n)||this.mc.logger.sendErrorEvent({eventName:"CodeProposalNotIFluidCodeDetails"}),this.processCodeProposal().catch((e=>{const t=(0,ci.cQ)(e);throw this.close(t),e})))})),this._protocolHandler=n}captureProtocolSummary(){const e=this.protocolHandler.snapshot();return{tree:{attributes:{content:JSON.stringify(this.protocolHandler.attributes),type:Qo.Z.Blob},quorumMembers:{content:JSON.stringify(e.members),type:Qo.Z.Blob},quorumProposals:{content:JSON.stringify(e.proposals),type:Qo.Z.Blob},quorumValues:{content:JSON.stringify(e.values),type:Qo.Z.Blob}},type:Qo.Z.Tree}}getCodeDetailsFromQuorum(){const e=(e=>e.get("code")??e.get("code2"))(this.protocolHandler.quorum);return e}static setupClient(e,t,n){const r=void 0===t?{details:{capabilities:{interactive:!0}},mode:"read",permission:[],scopes:[],user:{id:""}}:Si(t);return void 0!==n&&(r.details={...r.details,...n,capabilities:{...r.details.capabilities,...n?.capabilities}}),r.details.environment=[r.details.environment,` loaderVersion:${ps}`,` containerId:${e}`].join(";"),r}activeConnection(){return this.connectionState===jo.Connected&&"write"===this.connectionMode}createDeltaManager(){const e=()=>this.service,t=new Ls(e,(0,ho.pW)({logger:this.subLogger,namespace:"DeltaManager"}),(()=>this.activeConnection()),(t=>new ns(e,(()=>this.isDirty),this.client,this._canReconnect,(0,ho.pW)({logger:this.subLogger,namespace:"ConnectionManager"}),t,this._retryConnectionTimeoutMs)));return t.inbound.pause(),t.inboundSignal.pause(),t.on("connect",((e,t)=>{(0,Wo.vA)(this.connectionMode===e.mode,1207),this.loaded&&this.connectionStateHandler.receivedConnectEvent(e)})),t.on("establishingConnection",(e=>{this.connectionStateHandler.establishingConnection(e)})),t.on("cancelEstablishingConnection",(e=>{this.connectionStateHandler.cancelEstablishingConnection(e)})),t.on("disconnect",((e,t)=>{this.noopHeuristic?.notifyDisconnect();const n={text:e,error:t};this.loaded?this.connectionStateHandler.receivedDisconnectEvent(n):this.closed||this.connectionStateHandler.cancelEstablishingConnection(n)})),t.on("throttled",(e=>{const t=e;!0!==t.logged&&this.mc.logger.sendTelemetryEvent({eventName:"ContainerWarning"},t),this.emit("warning",t)})),t.on("readonly",(e=>{this.loaded&&this.setContextConnectedState(this.connectionState===jo.Connected,e),this.emit("readonly",e)})),t.on("closed",(e=>{this.closeCore(e)})),t.on("disposed",(e=>{this.disposeCore(e)})),t}async attachDeltaManagerOpHandler(e,t,n){return this._deltaManager.attachOpHandler(e.minimumSequenceNumber,e.sequenceNumber,{process:e=>this.processRemoteMessage(e),processSignal:e=>{this.processSignal(e)}},t,n)}logConnectionStateChangeTelemetry(e,t,n){const r=(0,zo.l)();this.connectionTransitionTimes[e]=r;const o=r-this.connectionTransitionTimes[t];let i,s,a,c;e===jo.Disconnected?s=this._deltaManager.connectionManager.reconnectMode:e===jo.Connected?(i=r-this.connectionTransitionTimes[jo.Disconnected],i=(0,ho.T0)(i)):e===jo.CatchingUp&&(a=this.deltaManager.lastKnownSeqNumber,this.deltaManager.hasCheckpointSequenceNumber&&this.loaded&&(c=a-this.deltaManager.lastSequenceNumber)),this.mc.logger.sendPerformanceEvent({eventName:`ConnectionStateChange_${jo[e]}`,from:jo[t],duration:o,durationFromDisconnected:i,reason:n?.text,connectionCount:this.connectionCount,pendingClientId:this.connectionStateHandler.pendingClientId,clientId:this.connectionStateHandler.clientId,autoReconnect:s,opsBehind:c,online:Zo.WA[(0,Zo.sc)()],lastVisible:void 0===this.lastVisible?void 0:(0,zo.l)()-this.lastVisible,checkpointSequenceNumber:a,quorumSize:this._protocolHandler?.quorum.getMembers().size,audienceSize:this._protocolHandler?.audience.getMembers().size,isDirty:this.isDirty,...this._deltaManager.connectionProps},n?.error),e===jo.Connected&&this.connectionCount++}propagateConnectionState(e){const t=this.connectionState===jo.Connected;if(t){const e=this.connectionStateHandler.clientId;(0,Wo.vA)(void 0!==e,2414),this.protocolHandler.audience.setCurrentClientId(e)}this.connectionState!==jo.Connected&&this.connectionState!==jo.Disconnected||(this.setContextConnectedState(t,this.readOnlyInfo.readonly??!1),this.protocolHandler.setConnectionState(t,this.clientId),(0,li.aX)(this.mc.logger,this,t,this.clientId,e?.text))}submitContainerMessage(e,t,n,r){switch(e){case Jo.Go.Operation:return this.submitMessage(e,JSON.stringify(t),n,r);case Jo.Go.Summarize:return this.submitSummaryMessage(t);default:{const t=new ai.gn("invalidContainerSubmitOpType",void 0,{messageType:e});return this.close(t),-1}}}submitBatch(e,t){let n=-1;for(const r of e)n=this.submitMessage(Jo.Go.Operation,r.contents,!0,r.metadata,r.compression,t);return this._deltaManager.flush(),n}submitSummaryMessage(e,t){return void 0===e.details&&(e.details={}),e.details.includesProtocolTree=this.storageAdapter.summarizeProtocolTree,this.submitMessage(Jo.Go.Summarize,JSON.stringify(e),!1,void 0,void 0,t)}submitMessage(e,t,n,r,o,i){return this.connectionState!==jo.Connected?(this.mc.logger.sendErrorEvent({eventName:"SubmitMessageWithNoConnection",type:e}),-1):(this.noopHeuristic?.notifyMessageSent(),this._deltaManager.submit(e,t,n,r,o,i))}processRemoteMessage(e){const t=this.clientId===e.clientId,n=this.protocolHandler.processMessage(e,t);if(this.runtime.process(e,t),this.serializedStateManager.addProcessedOp(e),this.activeConnection()){if(void 0===this.noopHeuristic){const e=this.deltaManager.serviceConfiguration;(0,Wo.vA)(void 0!==e,740),this.noopHeuristic=new zs(e.noopTimeFrequency,e.noopCountFrequency),this.noopHeuristic.on("wantsNoop",(()=>{(0,Wo.vA)(this.activeConnection(),577),this.submitMessage(Jo.Go.NoOp)}))}this.noopHeuristic.notifyMessageProcessed(e),!0===n.immediateNoOp&&this.submitMessage(Jo.Go.Accept)}this.emit("op",e)}submitSignal(e,t){this._deltaManager.submitSignal(JSON.stringify(e),t)}processSignal(e){if(function(e){if(null===e.clientId){const t=e.content;return t.type===Xi.Clear||t.type===Xi.ClientJoin||t.type===Xi.ClientLeave}return!1}(e))this.protocolHandler.processSignal(e);else{const t=this.clientId===e.clientId;this.runtime.processSignal(e,t)}}async instantiateRuntime(e,t,n,r){(0,Wo.vA)(!1!==this._runtime?.disposed,221);try{const o=this.scope,i=new Us(this,o.ILoader),s=await ho.Bt.timedExecAsync(this.subLogger,{eventName:"CodeLoad"},(async()=>this.codeLoader.load(e)));this._loadedModule={module:s.module,details:s.details??e};const a=this._loadedModule.module.fluidExport,c=a?.IRuntimeFactory;if(void 0===c)throw new Error("Code package does not implement IRuntimeFactory");const l=void 0!==t,u=new vs({options:this.options,scope:this.scope,baseSnapshot:t,version:this._loadedFromVersion,deltaManager:this._deltaManager,storage:this.storageAdapter,quorum:this.protocolHandler.quorum,audience:this.protocolHandler.audience,loader:i,submitFn:(e,t,n,r)=>this.submitContainerMessage(e,t,n,r),submitSummaryFn:(e,t)=>this.submitSummaryMessage(e,t),submitBatchFn:(e,t)=>this.submitBatch(e,t),submitSignalFn:(e,t)=>this.submitSignal(e,t),disposeFn:e=>this.dispose(e),closeFn:e=>this.close(e),updateDirtyContainerState:this.updateDirtyContainerState,getAbsoluteUrl:this.getAbsoluteUrl,getContainerDiagnosticId:()=>this.resolvedUrl?.id,getClientId:()=>this.clientId,getAttachState:()=>this.attachState,getConnected:()=>this.connected,getConnectionState:()=>this.connectionState,clientDetails:this._deltaManager.clientDetails,existing:l,taggedLogger:this.subLogger,pendingLocalState:n,snapshotWithContents:r}),d=await ho.Bt.timedExecAsync(this.subLogger,{eventName:"InstantiateRuntime"},(async()=>c.instantiateRuntime(u,l)));!function(e){const t=(0,ds.yi)(gs,e);if(!t.isCompatible)throw new ai.eb("Loader is not compatible with Runtime",{errorDetails:JSON.stringify({loaderVersion:fs.pkgVersion,runtimeVersion:e?.pkgVersion,loaderGeneration:fs.generation,runtimeGeneration:e?.generation,minSupportedGeneration:gs.minSupportedGeneration,isGenerationCompatible:t.isGenerationCompatible,unsupportedFeatures:t.unsupportedFeatures})})}(d.ILayerCompatDetails),this._runtime=d,this._lifecycleEvents.emit("runtimeInstantiated"),this._loadedCodeDetails=e}catch(e){throw this.dispose((0,ci.cQ)(e)),e}}setContextConnectedState(e,t){!1===this._runtime?.disposed&&this.loaded&&this.runtime.setConnectionState(e&&!t,this.clientId)}handleDeltaConnectionArg(e,t){switch((0,Wo.vA)(this.loaded,2415),e){case void 0:t&&this.connectToDeltaStream(t);case"delayed":(0,Wo.vA)(this.inboundQueuePausedFromInit,838),this.inboundQueuePausedFromInit=!1,this._deltaManager.inbound.resume(),this._deltaManager.inboundSignal.resume();break;case"none":break;default:(0,Vo.$)(e)}}}var Js=s(8831);class Ks extends ir.EventEmitter{constructor(e,t,n,r,o){super(),this.container=e,this.documentUrl=t,this.documentServiceFactoryProviderPromise=n,this.component=r,this.logger=o,this.addMemberEventHandler=()=>{this.emit("membersChanged",!0)},this.removeMemberEventHandler=()=>{this.emit("membersChanged",!1)},this.connectedEventHandler=()=>{this.emit("connected")},this.disconnectedEventHandler=e=>{this.emit("disconnected",e),this.lastDisconnectReason=e},this.dirtyEventHandler=()=>{this._isDirty=!0,this.emit("dirty"),this.lastEditedTimestamp=Date.now()},this.savedEventHandler=()=>{this._isDirty=!1,this.emit("saved")},this.readonlyEventHandler=()=>{this.emit("readonlyChanged",this.getReadonly().isReadOnly)},this.closedEventHandler=e=>{this.emit("error",e),this.componentCriticalError=e},this.disposedEventHandler=()=>{this.removeContainerListeners(),this.removeComponentListeners(),this.removeAllListeners(),this.dispose(),this.emit("disposed")},this.waringEventHandler=e=>{this.emit("warning",e)},this.trackContainerEvents(),this.trackComponentEvents(),this.container.forceReadonly&&(this.setReadonly=(e,t)=>{t?this.component.Lifecycle?.setReadonly?.(e,!0):this.container.forceReadonly?.(e)}),this._disposed=!1,this._isDirty=void 0!==this.component.Lifecycle?.isDirty?this.container.isDirty||this.component.Lifecycle.isDirty:this.container.isDirty}emit(e,...t){return super.emit(e,...t)}trackContainerEvents(){this.container.audience.on("addMember",this.addMemberEventHandler),this.container.audience.on("removeMember",this.removeMemberEventHandler),this.container.on("connected",this.connectedEventHandler),this.container.on("disconnected",this.disconnectedEventHandler),this.container.on("dirty",this.dirtyEventHandler),this.container.on("saved",this.savedEventHandler),this.container.on("readonly",this.readonlyEventHandler),this.container.on("closed",this.closedEventHandler),this.container.on("disposed",this.disposedEventHandler),this.container.on("warning",this.waringEventHandler)}trackComponentEvents(){this.component.Lifecycle?.on("dirty",this.dirtyEventHandler),this.component.Lifecycle?.on("readonlyChanged",this.readonlyEventHandler)}removeContainerListeners(){this.container.audience.off("addMember",this.addMemberEventHandler),this.container.audience.off("removeMember",this.removeMemberEventHandler),this.container.off("connected",this.connectedEventHandler),this.container.off("disconnected",this.disconnectedEventHandler),this.container.off("dirty",this.dirtyEventHandler),this.container.off("saved",this.savedEventHandler),this.container.off("readonly",this.readonlyEventHandler),this.container.off("closed",this.closedEventHandler),this.container.off("disposed",this.disposedEventHandler),this.container.off("warning",this.waringEventHandler)}removeComponentListeners(){this.component.Lifecycle?.off("dirty",this.dirtyEventHandler),this.component.Lifecycle?.off("readonlyChanged",this.readonlyEventHandler)}get disposed(){return this.container.disposed||this._disposed}get isDirty(){return this._isDirty}get isReadOnly(){return(this.container.readOnlyInfo.readonly||this.component.Lifecycle?.isReadOnly)??!1}getReadonly(){return this.component.Lifecycle?.getReadonly?.()??{isReadOnly:this.isReadOnly}}get Lifecycle(){return this}async waitForAllData(){await Gs(this.container)}updateLastCachedTimestamp(){this._isDirty=!1,this.lastCachedTimestamp=Date.now()}get Disposable(){return this}dispose(){this._disposed||(this._disposed=!0,this.component.Disposable?.dispose(),this.logger&&(0,De.Ot)(this.logger,{eventName:"ComponentDisposed",isDirty:this.isDirty,attachState:this.container.attachState,componentCriticalError:this.componentCriticalError?.errorType,componentCriticalErrorMessage:this.componentCriticalError?.message,connectionState:this.container.connectionState,lastDisconnectReason:this.lastDisconnectReason,lastCachedTimestamp:this.lastCachedTimestamp,lastEditedTimestamp:this.lastEditedTimestamp,isOnline:navigator.onLine}),this.container.dispose())}get ConnectionManager(){return this}get isConnected(){return this.container.connectionState===jo.Connected}connect(){this.container.connect()}disconnect(){this.container.disconnect()}get CollaboratorInfo(){return this}get clientId(){return this.container.clientId}getMembers(){const e=new Map;return this.container.audience.getMembers().forEach(((t,n)=>{const r=t.user;e.set(n,{id:r.id,name:r.name,email:r.email,joinTime:t.timestamp,isGuest:r.isGuest,mode:t.mode})})),e}get FluidMetadataProvider(){return this}getCodeDetails(){return this.container.getLoadedCodeDetails()}getSnapshot(){return this.container.serialize()}get LoopComponentUrl(){return this}async initializeLoopComponentUrl(e){if(!e)throw new Error("File name is required to initialize component url.");const t=await this.documentServiceFactoryProviderPromise;if(!t?.getCreateDocumentRequest)throw new Error("FluidDocumentServiceFactoryProvider.getCreateDocumentRequest is required to initialize component url");const n=await t.getCreateDocumentRequest(e);await this.container.attach(n)}async getLoopComponentUrl(){const e=this.documentUrl?this.documentUrl:await this.container.getAbsoluteUrl("/");if(e)return new URL(e)}get FluidShareLinkInfo(){return this}getShareLink(){const e=this.container.resolvedUrl;if(e&&(0,Js.g2)(e))return e.shareLinkInfo}}function Ys(e,t,n,r,o,i){const s={};let a;const c={Disposable:"Disposable",...n};t&&(a=new Ks(t,o,r,e,i));for(const t of Object.keys(c)){const n=a&&t in a?{value:a[t]}:{value:e[t]};Object.defineProperty(s,t,n)}return s}var Xs=s(8880);async function Zs(e,t,n,r){let o="/";if(r){const e=await t.resolve({url:r.url});if(!e)throw new Error(`Get undefined for resolvedUrl with ${r.url}`);const n=Ei(function(e){try{const t=new URL(e);if("fluid-odsp:"===t.protocol)return t.protocol="https",t.href}catch{}return e}(e.url));void 0!==n&&(o=`${n.path}${n.query}`)}const i={url:o,headers:n},s=await(e.getEntryPoint?.());if(s){const e={status:200,mimeType:"fluid/object",value:s};if("/"===i.url||""===i.url)return e;const t=await(s.UrlRouterFetcher?.getUrlRouter());return await(t?.request(Xs.X.create(i)))??e}const a=e.runtime?.request;if(a&&"function"==typeof a)return a(i);throw new Error("Could not invoke the request via the legacy back-compat path: `container.runtime.request` not found.")}var ea=s(620);async function ta(e,t,n,r,o,i,s,a,c){const l=Re.m.start(Gr,r,{addUserTiming:!0,isAPerformanceMetric:!0}),u=on();let d;try{d=await async function(e,t,n,r,o,i,s){const a=Re.m.start(Vr,r,{addUserTiming:!0});let c;if(o){const r={...n?.headers,wait:!1,externalRequest:!1};if(c=await Zs(e,t,r,n),404===c.status){Uo(e);const r={...n?.headers,externalRequest:!1};c=await Zs(e,t,r,n)}}else{const r={...n?.headers,externalRequest:!1};c=await Zs(e,t,r,n)}if(200!==c.status||"fluid/component"!==c.mimeType&&"fluid/object"!==c.mimeType||!c.value){const e=new mo(`Component not found: status=${c.status}, value=${c.value}`,void 0,c.status,c.stack),t={externalRequest:!1,mimeType:c.mimeType};throw a.setResult(!1,t,e),e}const l=c.value;if(a.setResult(!0),s){const t=i?.synthesize({FluidDocumentServiceFactoryProvider:"FluidDocumentServiceFactoryProvider"},void 0);return Ys(l,e,s,t?.FluidDocumentServiceFactoryProvider,n?.url,r)}return l}(e,t,n,r,s,a,void 0)}catch(e){return function(e){an(u),l.setResult(!1,void 0,e)}(e),Promise.reject(e)}const p=d.ComponentTelemetryMetadata,h=p?.entityName,f=void 0===d.IFluidLoadable?.handle?void 0:(0,ea.Fz)(d.IFluidLoadable.handle).absolutePath,g=sn(u,!0),m=sn(i);if(l.setResult(!0,{...o,componentType:h,componentUrl:f,documentEverHidden:m>-1,documentHidden:g>-1}),s&&function(e,t,n){void 0===n||n<=0?Uo(e):Promise.race([(0,Co.c)(n),t]).then((()=>{setTimeout((()=>{Uo(e)}),50)})).catch((()=>{}))}(e,void 0,0),c){const t=a?.synthesize({FluidDocumentServiceFactoryProvider:"FluidDocumentServiceFactoryProvider"},void 0);return Ys(d,e,c,t?.FluidDocumentServiceFactoryProvider,n?.url,r)}return d}const na="@ms/office-fluid-container",ra="@ms/onenote-meetings",oa="@ms/whiteboard-container",ia="@fluidx/loop-page-container",sa="@fluidx/copilot-board-container";function aa(e){return Dn(pn(e??"Prod").audience)}function ca(e,t,n,r){const o=t.preload.manifest,i=[...o.assets];if(o.localizedAssets){const e=l(n),t=o.localizedAssets[e];t&&i.push(...t)}qn(e,i.map((e=>`${t.preload.jsBaseUrl}/${e}`)),r)}async function la(e,t){const n=t?{logger:t,eventName:"GetCodeLoadDetailsFromNetwork",doNotLogOnSuccess:!0}:void 0,r=await Mn(e,n);if(r.result.ok)return r.result.json();throw new Error(`getCodeLoadDetailsFromNetwork: Failed to fetch: ${e}; StatusCode: ${r.result.status}`)}function ua(e){return!isNaN(e)&&isFinite(e)}function da(e,t,n){const r=parseFloat(e);if(!ua(r))return!1;const o=parseFloat(t);return!!ua(o)&&(r<=o||function(e){try{return JSON.parse(e)}catch(e){return[]}}(n).includes(r))}const pa=(e,t,n,r,o)=>function(e,t,n,r,o){const{getLatestContainerCodeDetails:i,upgradeNeeded:s,preCacheContainerCode:a}=n,c=n=>Ht(e,t,n,i,a,(e=>e.fluidCodeDetailsOverride.package),(e=>e.maxUnsupportedContainerScriptVersion),o,r);return{getCodeDetailsPackage:(e,n)=>cn(t,e,n,(e=>c(e).codePackagePromise),(e=>e.fluid.browser.umd.files),r),upgradeNeeded:async(e,n)=>{if(!s)return!1;const o=await s(e,n);return o&&(await Jt(t,e,r),c(e)),o},preCacheLatestContainerCode:async e=>await c(e).cacheUpdatePromise}}(e,t,{getLatestContainerCodeDetails:n,preCacheContainerCode:ca,upgradeNeeded:async(e,t)=>{try{const r=await n(e);return da(t,r.maxUnsupportedContainerScriptVersion,r.unsupportedContainerScriptVersions)}catch{return!1}}},r,o),ha={Automation:"https://whiteboard.office.com",Development:"https://dev.whiteboard.microsoft.com",Dogfood:"https://whiteboard.office.com",DoD:"https://whiteboard.apps.mil",GCC:"https://whiteboard.office.com","GCC-High":"https://whiteboard.office365.us",Local:"https://whiteboard.office.com",Microsoft:"https://whiteboard.office.com",Preview:"https://whiteboard.office.com",Production:"https://whiteboard.office.com",Staging:"https://app.int.whiteboard.microsoft.com",SyntheticTraffic:"https://whiteboard.office.com",USNat:"https://whiteboard.eaglex.ic.gov",USSec:"https://whiteboard.microsoft.scloud",Gallatin:"",Bleu:"https://whiteboard.sovcloud.fr",Delos:""};const fa=(e,t,n)=>pa(e,na,(e=>async function(e,t){return la(`${aa(e)}/container/versionless/officeContainerCodeLoadDetails.json`,t)}(e,t)),t,n);const ga=(e,t,n)=>pa(e,ia,(e=>async function(e,t){return la(`${aa(e)}/loop-page-container/versionless/loopPageContainerCodeLoadDetails.json`,t)}(e,t)),t,n),ma=(e,t,n)=>pa(e,sa,(e=>async function(e,t){const n=function(e){switch(e){case"Staging":case"Development":return"Staging";case"Gcc":case"GccHigh":case"DoD":case"Gallatin":case"Bleu":case"Delos":case"USNat":case"USSec":return e;default:return"Prod"}}(e);return la(`${aa(n)}/copilot-board-container/versionless/copilotBoardContainerCodeLoadDetails.json`,t)}(e,t)),t,n),va=e=>{const t=pn(e??"Prod");return n=t.audience,ha[n];var n},ya=e=>Bo(e)&&"string"==typeof e?.fluid?.browser?.umd?.library&&Array.isArray(e?.fluid?.browser?.umd?.files),ba=e=>{switch(e){case ra:case na:case"@msstream/experiences-fluid-embed":case"@office-start/space-container":case oa:case ia:case sa:return e;default:return"(redacted)"}},Sa="NPM",wa="CDN";function Ca(e,t){return new Promise(((n,r)=>{const o=e.document,i=o.createElement("link");return i.rel="stylesheet",i.type="text/css",i.href=t,i.onload=()=>{n()},i.onerror=()=>r(new Error(`Failed to download the style sheet at url: ${t}, isUserDefinitelyOffline: ${!e.navigator.onLine}`)),o.head.appendChild(i),i}))}const Ea=Wt,ka=e=>"string"==typeof e.package?e.package:e.package.name;function Pa(e){const t=e.fluidExport;return t.CodeVersionDetailsProvider?.codeVersionDetails?.version}const Ta="0.0.1",Na=e=>!Number.isNaN(e)&&Number.isFinite(e),Aa=e=>{return"string"!=typeof e.package&&(t=e.package,ya(t)&&(t.version===Ta||Na(Number(t.version))))?{name:e.package.name,version:e.package.version===Ta?Ta:Number(e.package.version)}:void 0;var t};class Ia{get IRuntimeFactory(){return this}constructor(e,t){this.wrappedFactory=e,this.config=t}instantiateRuntime(e,t){return this.wrappedFactory.configure(this.config),this.wrappedFactory.instantiateRuntime(e,t)}}class Oa{get IFluidCodeDetailsComparer(){return this}tryFormActualCodeDetailsMapKey(e){const t=Aa(e);if(void 0!==t)return`${t.version}|${t.name}`}getActualCodeDetails(e){const t=this.tryFormActualCodeDetailsMapKey(e);return void 0===t?void 0:this.actualCodeDetailsMap.get(t)}constructor(e){this.config=e,this.actualCodeDetailsMap=new Map,this.logger=e.logger}async load(e){const t=ka(e),n=e.config,r=Re.m.start("SimpleCodeLoaderLoad",this.logger,{addUserTiming:!0});try{const{windowContext:o,getBundledPackageFactoryOverride:i,disableCdnCodeLoadingFallback:s}=this.config,a=Ea(o),c=a.get(t);if(void 0!==c){const t=(await c).moduleWithDetails,o=t.fluidExport.ConfigurableRuntimeFactory,i=void 0!==o?{module:{fluidExport:new Ia(o,n)},details:e}:{module:t,details:e};return r.setResult(!0,{source:"InMemoryCache"}),i}let l=i?.(t);const u=l?"Bundled":"CDN";if(l)l.then((e=>{const n=Pa(e);La(this.logger,{packageName:t,deliveryType:Sa,codeVersion:n})})).catch((()=>{this.logger&&(0,De.hO)(this.logger,{eventName:"NpmCodeLoaderOverrideFailed",packageName:ba(t)})}));else{if(s)throw new Error(`CDN code loading fallback set to false but no factory provided by host for container named ${ba(t)}`);this.logger&&(0,De.Ot)(this.logger,{eventName:"CodeLoaderFallbackToCDN",containerType:ba(t)}),l=this.loadInternal(e,this.logger)}if(!s){const e=l.then((e=>{const t=Pa(e)??"";return{audience:this.config.audience??"Production",version:t,moduleWithDetails:e}}));a.set(t,e),e.catch((()=>a.delete(t)))}const d=await l,p=d.fluidExport.ConfigurableRuntimeFactory,h=void 0!==p?{module:{fluidExport:new Ia(p,n)},details:e}:{module:d,details:e};return r.setResult(!0,{source:u}),h}catch(e){throw r.setResult(!1,void 0,e),e}}async loadInternal(e,t){const{windowContext:n,trustedTypesPolicy:r,getFluidCodeVersionDetails:o}=this.config;let i;i="allowedCodeOrigins"in this.config?this.config.allowedCodeOrigins:this.config.allowedCodeSources.flatMap((e=>e.origin));const s=await this.getEffectiveFluidCodeDetailsPackage(e);if(La(t,{packageName:ka(e),deliveryType:wa,codeVersion:s.version}),void 0===s)throw new Error(`Failed to get Fluid Package. Trying to load ContainerType: ${ba(e.package.name)}`);const a=s.fluid.browser.umd;if(!this.shouldLoad(a.files))throw new Error("Unsupported container files, check that CDN is on allow list");const c=this.tryFormActualCodeDetailsMapKey(e);if(void 0!==c&&"string"!=typeof e.package){const t={...e,package:{...e.package,...s}};this.actualCodeDetailsMap.set(c,t)}const l=r&&{trustedTypesPolicy:await r,allowedOrigins:i};await Promise.all(a.files.map((e=>{const t=e.toLowerCase();if(t.endsWith(".js"))return ln(n,e,l,"high");if(t.endsWith(".css"))return((e,t)=>{let n=3;return function r(){return Ca(e,t).catch((()=>(n-=1,0===n?Ca(e,t):r())))}()})(n,e);throw new Error(`Codeloader does not know how to load: ${e}`)})));const u=n[a.library];if(void 0===u)throw new Error(`Entry point of loaded package not a Fluid module. Trying to load ContainerType: ${ba(e.package.name)}`);const{CodeVersionDetailsProvider:d}=u.fluidExport;if(d){const e=o?.(s);e&&d.setCodeVersionDetails(e)}return u}async preCache(e){const{getFluidCodeDetailsPackageOverride:t,windowContext:n}=this.config;if(t){const r=await t(e);if(r){const e=r.fluid.browser.umd;if(!this.shouldLoad(e.files))throw new Error("Unsupported container files, check that CDN is on allow list");qn(n,e.files,this.logger)}}}async getEffectiveFluidCodeDetailsPackage(e){const t="string"==typeof e.package?e.package:e.package.name,n=await(this.config.getFluidCodeDetailsPackageOverride?.(t))||e.package;if("string"==typeof n)throw new Error("Codeloader does not know how to load from this source");return function(e){if(!ya(e)||void 0===e.version)throw new Error("Codeloader does not know how to load from this source")}(n),n}shouldLoad(e){return"allowedCodeOrigins"in this.config?Gt(e,this.config.allowedCodeOrigins):Vt(e,this.config.allowedCodeSources)}async satisfies(e,t){const n=this.getActualCodeDetails(e);if(void 0===n)return!0;if("string"==typeof t.package||"string"==typeof n.package)return!0;const r=(e=>{const t=Number(e.maxUnsupportedVersion);return Na(t)?t:void 0})(t.package);if(void 0!==r){const e=Aa(n)?.version;if(void 0!==e)return e===Ta||e>r}return!0}async compare(e,t){const n=Aa(e);if(void 0===n)return;const r=Aa(t);return void 0!==r&&n.name===r.name?n.version===r.version?0:n.version===Ta?-1:r.version===Ta?1:n.version-r.version:void 0}}function La(e,{packageName:t,deliveryType:n,codeVersion:r}){if(!e)return;const o={eventName:"FluidCodeDetails",subCategory:"FluidCodeDetails",containerType:ba(t),deliveryType:n};r&&(o.codeVersion=r),(0,De.Ot)(e,o)}function Da(e){const t=(0,Fe.A)()?.AllowListOverride;return t?(e&&(0,De.Ot)(e,{eventName:"CodeLoaderAllowListOverwritten",subCategory:"LocalStorageOverride"}),JSON.parse(t)):[]}class Ra{get IFluidCodeDetailsComparer(){return this.simpleCodeLoader}getActualCodeDetails(e){return this.simpleCodeLoader.getActualCodeDetails(e)}constructor(e){this.config=e;const t=e.additionalAllowedCodeOrigins??[],{windowContext:n,logger:r,localeHint:o}=this.config,i=r?.NamespaceLogger?new Le.p("OfficeWebHost",r.NamespaceLogger):r;this.settingsProvider=e.settingsProvider;const s=fa(n,i,o),a=ga(n,i,o),c=ma(n,i,o),l={getCodeDetailsPackage:e=>{const t=va(e),n={name:oa,version:"0.0.1",fluid:{browser:{umd:{files:[`${t}/root/index.fluid.js`],library:"microsoftWhiteboard"}}}};return Promise.resolve(n)}};this.containerCodeDetailsProviderMap=new Map([[na,s],[ra,s],[ia,a],[sa,c],[oa,l]]),e.additionalCodeDetailsProviders?.forEach((([e,t])=>this.containerCodeDetailsProviderMap.set(e,t)));const u=[...Da(i),...t],d=[...On(this.config.containerEnvironment,this.settingsProvider),{origin:u,paths:void 0}],p={windowContext:e.windowContext,trustedTypesPolicy:e.trustedTypesPolicy,logger:i,getBundledPackageFactoryOverride:t=>{const n=e.locallyBundledPackageFactories?.get(t);return n?Promise.resolve(n):void 0},disableCdnCodeLoadingFallback:e.disableCdnCodeLoadingFallback,getFluidCodeDetailsPackageOverride:async t=>{const n=this.containerCodeDetailsProviderMap.get(t);if(n)return n.getCodeDetailsPackage(e.containerEnvironment,d)},getFluidCodeVersionDetails:t=>{const{containerEnvironment:n}=e,r=t.version,o=this.containerCodeDetailsProviderMap.get(t.name)?.upgradeNeeded;return{version:r,containerEnvironment:n||"Local",needUpgrade:o?()=>o(n,r):async()=>!1}},audience:pn(this.config.containerEnvironment).audience};this.simpleCodeLoader=new Oa({...p,allowedCodeSources:d})}async preCache(e){if(this.config.locallyBundledPackageFactories?.has(e))return;const t=this.containerCodeDetailsProviderMap.get(e);return t?.preCacheLatestContainerCode?t.preCacheLatestContainerCode(this.config.containerEnvironment):this.simpleCodeLoader.preCache(e)}async load(e){return this.simpleCodeLoader.load(e)}}class Fa{constructor(e){this.bohemiaConfig=e,this.instantiateFluidCodeLoader=async e=>{const t=e.dependencySynthesizer.synthesize({LoopTrustedTypesPolicy:"LoopTrustedTypesPolicy",NamespaceLogger:"NamespaceLogger",SettingsProvider:"SettingsProvider"},void 0),[n,r,o]=await Promise.all([t.LoopTrustedTypesPolicy,t.SettingsProvider,t.NamespaceLogger]);return new Ra({...this.bohemiaConfig,windowContext:e.windowContext,trustedTypesPolicy:n,settingsProvider:r,logger:o})}}get FluidCodeLoaderFactory(){return this}get Disposable(){return this}dispose(){}}var Ma=s(9628);class xa{constructor(e){this.settingsProvider=e}getRawConfig(e){const t=(0,Ma.AU)(e,null,this.settingsProvider);return null===t?void 0:t}}function _a(e){return Bo(e.package)?e.package.name:e.package}var Ua=s(9860);function ja(e,t){if(!t)return;const n=e?ba(e):"Unknown",r={};r[Ua.bT]=n,t.PersistedProperties?.addPersistedProperties(r)}const za="FluidCodeLoaderFactory";function qa(e,t){(async()=>{const n=function(e){if(void 0!==e.getSpecifiedCodeDetails)return e.getSpecifiedCodeDetails();const t=e.getQuorum();return t.getMember("code")??t.getMember("code2")}(e);if(n){const r=t.getActualCodeDetails?.(n);if(r&&t.IFluidCodeDetailsComparer){const o=await t.IFluidCodeDetailsComparer.compare(n,r);void 0!==o&&o<0&&await e.proposeCodeDetails(r)}}})().catch((()=>{}))}function Ba(){const e=(0,Fe.A)()?.FluidCodeDetailsOverride;if(void 0!==e)return JSON.parse(e)}async function $a(e,t,n,r,o,s,a,c){const l=new lt(o);a&&!l.has("NamespaceLogger")&&l.register("NamespaceLogger",new Le.p(ao,a));const u={SettingsProvider:"SettingsProvider",FluidCodeLoaderFactory:za},d=l.synthesize(u,void 0);let[p,h]=await Promise.all([d.SettingsProvider,d.FluidCodeLoaderFactory]);if(!h){const e=await async function({hostConfig:e,dependencySynthesizer:t}){const n=t.synthesize({SettingsProvider:"SettingsProvider",InternationalizationContext:"InternationalizationContext"},void 0),[r,o]=await Promise.all([n.SettingsProvider,n.InternationalizationContext]),s=hn(e.environment,r?.audience);return new Fa({containerEnvironment:s,localeHint:o?.uiLocale||i})}({hostConfig:n,dependencySynthesizer:l});l.registerIfNotAlreadyExists(za,e),h=e}const f=await h.instantiateFluidCodeLoader({windowContext:e,dependencySynthesizer:l});let g,m;if("Existing"===t.type&&(g=t.containerCodeHint),g){if(a&&(0,De.Ot)(a,{eventName:io}),void 0===n.loadCodeFromHint||n.loadCodeFromHint){const e=Re.m.start(Kr,a,{addUserTiming:!0});f.load({package:g}).then((()=>{e.setResult(!0)})).catch((t=>{e.setResult(!1,void 0,t)}))}(function(e){return"preCache"in e&&!!e.preCache})(f)&&(c?.addAdditionalProps({precachedContainerPackageName:ba(g)}),f.preCache(g).catch((e=>{a&&(0,De.hO)(a,{eventName:Zr},e)})))}p&&(m=new xa(p));const v={urlResolver:await r.urlResolver,documentServiceFactory:await r.documentServiceFactory,options:n.loaderOptions,scope:{IFluidDependencySynthesizer:l},codeLoader:f,logger:s,configProvider:m};return new js(v)}async function Ha(e,t,n,r,o){const i={[Ds.d.loadMode]:{opsBeforeReturn:"cached",deltaConnection:n.startContainerInPausedState?"none":"delayed"}};let s,a;const c=e.services.codeLoader;switch(t.type){case"Existing":{const r=t.containerRequest,o={url:r.url,headers:{...i,...r.headers}};a=t.containerCodeHint,s=e.resolve(o,n.pendingLocalState);break}case"DetachedFromCode":{const n=Ba()||t.codeDetails;a=_a(n),s=e.createDetachedContainer(n);break}case"DetachedFromSnapshot":a=void 0,s=e.rehydrateDetachedContainerFromSnapshot(t.snapshot);break;default:throw new Error("loadContainerProps type is invalid")}return ja(a,o),s.then((async e=>{n.startContainerInPausedState||Uo(e);const t=e.getSpecifiedCodeDetails(),i=t&&_a(t);if(void 0===a&&ja(i,o),r?.addAdditionalProps({containerPackageMatchedCodeHint:a===i}),e.deltaManager.active)qa(e,c);else{const t=()=>{e.deltaManager.active&&(qa(e,c),e.off("connected",t))};e.on("connected",t)}})).catch((()=>{})),s}const Wa="ContainerLoadFailed",Ga="ComponentLoadFailedOnContainerBoot";class Va extends Error{constructor(){super("The container could not be loaded because its hosting window has already been unloaded."),this.name=oo,this.errorType=oo}}function Qa(e){switch(e){case"Automation":return 0;case"Local":return 1;case"Staging":return 2;case"Dogfood":return 3;case"Preview":return 4;case"Microsoft":case"SyntheticTraffic":return 5;case"Production":return 6;case"GCC":return 7;case"GCC-High":case"DoD":return 8;default:return}}const Ja=e=>(0,Ma.AU)("owh.handleLocationRedirection",!0,e),Ka=e=>{const t=function(e,t){const n=Qa(e),r=Qa(t??"Production");return void 0!==n&&void 0!==r&&r<=n}("Automation",e?.audience);return(0,Ma.AU)("useNestedDependencyContainer",t,e)};function Ya(e,t,n,r,o,s,a,c,l,u){!function(e){if(!function(e){const t="DriverImplementation",n=["FluidUrlResolverProvider","FluidDocumentServiceFactoryProvider"];return e.has(t)||n.every((t=>e.has(t)))}(e))throw Xa}(r);const d=new yo,p=new yo;return async function(){const e=Re.m.start(Hr,s,{addUserTiming:!0}),t={...a,documentEverHidden:sn(c)>-1},{DriverImplementation:n,FluidDocumentServiceFactoryProvider:o,FluidUrlResolverProvider:i}=r.synthesize({DriverImplementation:"DriverImplementation",FluidUrlResolverProvider:"FluidUrlResolverProvider",FluidDocumentServiceFactoryProvider:"FluidDocumentServiceFactoryProvider"},void 0),[l,u,d]=await Promise.all([n,i?.then((e=>e?.urlResolver)),o?.then((e=>e?.documentServiceFactory))]);if(l)return e.setResult(!0,{...t,driverType:"SynthesizedLegacy"}),l;if(u&&d)return e.setResult(!0,{...t,driverType:"Synthesized"}),{documentServiceFactory:d,urlResolver:u};const p=new Error("Driver unavailable");throw e.setResult(!1,t,p),p}().then((async h=>{const f=function(d){const p=a.fluidBootstrapperStartTime,h="Existing"!==t.type&&{createNew:"DetachedFromCode"===t.type?"DetachedContainer":t.type};let f=n;const g=h&&{additionalPropsToLog:h}||void 0,m={InternationalizationContext:"InternationalizationContext",SettingsProvider:"SettingsProvider"},v=r.synthesize(m,void 0);Promise.resolve(v.InternationalizationContext).then((e=>{s&&(0,De.Ot)(s,{eventName:"HostLocaleContext",subCategory:"HostLocaleContext",uiLanguage:e?.uiLocale||i})})).catch((()=>{}));const y=Re.m.start($r,s,{addUserTiming:!0,...g});s&&function(e){const t=navigator?.connection;(0,De.Ot)(e,{eventName:"Metadata",subCategory:"browserMetadata",doNotTrack:navigator.doNotTrack?navigator.doNotTrack:"false",documentHidden:document.hidden,networkType:t?.effectiveType,networkRoundTripTime:t?.rtt,cpuCoreCount:navigator.hardwareConcurrency,isMobile:(0,bo.Fr)(),timeStamp:Date.now()})}(s);const b=s&&new _o(s,a,c),S=Re.m.start(Wr,s,{addUserTiming:!0,additionalPropsToLog:{LoadContainerType:t.type},isAPerformanceMetric:!0}),w=$a(e,t,o,d,r,b,s,S),C=Promise.all([w,v.SettingsProvider]).then((([e,n])=>{if(Ja(n)&&"Existing"===t.type){let n=0;return async function(e,t,n,r){let o=t;const i=(0,ho.pW)({logger:r,namespace:"LocationRedirection"});for(;;)try{return await e(o)}catch(e){if(!fo(e))throw e;i.sendTelemetryEvent({eventName:"LocationRedirectionError"});const t=e.redirectUrl;o={url:await n.getAbsoluteUrl(t,"",void 0),headers:o.headers}}}((async r=>(n+=1,n>1&&s&&(0,De.Ot)(s,{eventName:"LocationRedirectionCallbackCalled",loadContainerAPICounter:n,loadContainerType:t.type}),t.containerRequest=r,f=r,Ha(e,t,o,S,s))),t.containerRequest,e.services.urlResolver,b)}return"Existing"===t.type&&s&&(0,De.hO)(s,{eventName:"LocationRedirectionHandlingError",errorType:"LocationRedirectionHandlingDisabled",loadContainerType:t.type},new Error("Location redirection handling is disabled in the settings provider. And is not using resolveWithLocationRedirectionHandling")),Ha(e,t,o,S,s)})).then((t=>{if(e.closed)throw t.dispose(),new Va;return t}));C.then((e=>{s&&Mo(e,s);const t=sn(c),n=S.startTimeSinceEpoch;S.setResult(!0,{...a,offsetFromFluidBootstrapperStartTime:So(n,p),documentEverHidden:t>-1})})).catch((e=>{S.setResult(!1,{errorType:e.errorType},e),y.setResult(!1,{errorType:e.errorType||Wa,isUserImpacting:!0},e),s&&Lo(s,$r,Eo,Po,e.errorType||To,{},e)}));const E=C.then((e=>{if(!e)throw y.setResult(!1),s&&Lo(s,$r,Eo,Po,Ao),new Error("Failed to Load Container");const t=w.then((t=>ta(e,t.services.urlResolver,f,s,a,c,o.startContainerInPausedState,r,void 0)));let n=t;if(u?.fromExistingTemplateUrl){const e=async function(e,t,n,r,o,i){const s=Re.m.start(Qr,r,{addUserTiming:!0});return t.then((async t=>{s.markSubActivityStart("TemplateLoadContainer");const a=await Ha(t,{type:"Existing",containerRequest:{url:e.fromExistingTemplateUrl,headers:e.loadTemplateRequestHeaders}},n,void 0,r);return s.markSubActivityEnd("TemplateLoadContainer"),await Gs(a),s.markSubActivityStart("TemplateLoadComponent"),ta(a,t.services.urlResolver,{url:e.fromExistingTemplateUrl},r,o,i,n.startContainerInPausedState,void 0,void 0).then((async e=>{if(s.markSubActivityEnd("TemplateLoadComponent"),!e?.ComponentSerializable)throw new go("Component doesn't implement ComponentSerializable",no);try{const t=await e.ComponentSerializable.serialize();return s.setResult(!0),t}catch(e){throw new go("Component serialization failed",ro,e)}})).finally((()=>{a.dispose()}))})).catch((e=>{throw s.setResult(!1,void 0,e),e.name=e.name||eo,e}))}(u,w,o,s,a,c);n=t.then((t=>{const n=t.ComponentSerializable;if(!n)throw new go("Component doesn't implement ComponentSerializable",no);let r;return e.then((async e=>{if(r=Re.m.start(Jr,s,{addUserTiming:!0}),void 0===e)throw new Error(to);return await n.rehydrate(e),r.setResult(!0),t})).catch((e=>{throw r?.setResult(!1,void 0,e),e}))}))}return n=n.then((t=>{if(l){const n=r.synthesize({FluidDocumentServiceFactoryProvider:"FluidDocumentServiceFactoryProvider"},void 0);return Ys(t,e,l,n.FluidDocumentServiceFactoryProvider,f?.url,s)}return t})),n.then((()=>{y.setResult(!0)})).catch((t=>{let n;t&&"errorType"in t&&"message"in t&&(n=t),e.dispose(n),y.setResult(!1,{errorType:t.errorType||"Error"!==t.name?t.name:Ga,isUserImpacting:!0,isExpected:vo(t)},t),s&&Lo(s,$r,Eo,Po,t.errorType||t.name||To,{},t)})),n}));return{containerPromise:C,componentPromise:E}}(h);d.resolve(f.containerPromise),p.resolve(f.componentPromise)})).catch((e=>{d.reject(e),p.reject(e)})),{containerPromise:d,componentPromise:p}}const Xa=new Error("No driver is provided on the dependency synthesizer");var Za,ec,tc,nc=s(1716);function rc(e){let t=`${e.siteUrl}?driveId=${encodeURIComponent(e.driveId)}&itemId=${encodeURIComponent(e.itemId)}&path=${encodeURIComponent(e.dataStorePath)}`;return e.containerPackageName&&(t+=`&containerPackageName=${encodeURIComponent(e.containerPackageName)}`),e.fileVersion&&(t+=`&fileVersion=${encodeURIComponent(e.fileVersion)}`),t}!function(e){e.isSharingLinkToRedeem="isSharingLinkToRedeem",e.isRedemptionNonDurable="isRedemptionNonDurable"}(Za||(Za={})),function(e){e.isClpCompliantApp="X-CLP-Compliant-App"}(ec||(ec={})),function(e){e.eTag="eTag"}(tc||(tc={}));var oc=s(3499);async function ic(e,t="SHA-1",n="hex"){if(void 0===crypto.subtle)return s.e(482).then(s.bind(s,7358)).then((async r=>r.hashFile(e,t,n)));const r=await async function(e,t){const n=await crypto.subtle.digest(t,e);return new Uint8Array(n)}(e,t);return function(e,t){switch(t){case"hex":return Array.prototype.map.call(e,(e=>e.toString(16).padStart(2,"0"))).join("");case"base64":return oc.fromByteArray(e)}}(r,n)}function sc(e){return e.origin.endsWith("onedrive.com")||e.origin.endsWith("storage.live.com")||e.origin.endsWith("storage.live-int.com")||e.origin.endsWith("onedrive-tst.com")}var ac=s(7127),cc=s(7117);function lc(e,t,n,r){const o=r?`versions/${r}/`:"";return`${function(e){let t="_api/";return sc(e)&&(t=""),`${e.origin}/${t}v2.1`}(new URL(e))}/drives/${t}/items/${n}/${o}`}function uc(e,t,n,r){return`${lc(e,t,n,r)}opStream/snapshots`}function dc(e,t,n,r){return`${lc(e,t,n,r)}opStream/attachment`}function pc(e,t,n,r){return`${lc(e,t,n,r)}opStream/attachments`}function hc(e,t,n,r){return`${lc(e,t,n,r)}opStream`}class fc{constructor(){}async resolve(e){if(e.headers?.[nc.U.createNew]){const[t,n]=e.url.split("?"),r=new URLSearchParams(n),o=e.headers[nc.U.createNew].fileName,i=r.get("driveId"),s=r.get("path"),a=r.get("containerPackageName");if(!(o&&t&&i&&null!=s))throw new Zo.OI("Proper new file params should be there",Io.E.genericError,{driverVersion:cc.z});return{endpoints:{snapshotStorageUrl:"",attachmentGETStorageUrl:"",attachmentPOSTStorageUrl:"",deltaStorageUrl:""},tokens:{},type:"fluid",odspResolvedUrl:!0,id:"odspCreateNew",url:`https://${t}?${n}&version=null`,siteUrl:t,hashedDocumentId:"",driveId:i,itemId:"",fileName:o,summarizer:!1,codeHint:{containerPackageName:a??void 0},fileVersion:void 0,shareLinkInfo:void 0,isClpCompliantApp:e.headers?.[ec.isClpCompliantApp]}}const{siteUrl:t,driveId:n,itemId:r,path:o,containerPackageName:i,fileVersion:s}=function(e){const[t,n]=e.split("?"),r=new URLSearchParams(n),o=r.get("driveId"),i=r.get("itemId"),s=r.get("path"),a=r.get("containerPackageName"),c=r.get("fileVersion");if(null===o)throw new Error("ODSP URL did not contain a drive id");if(null===i)throw new Error("ODSP Url did not contain an item id");if(null===s)throw new Error("ODSP Url did not contain a path");return{siteUrl:t,driveId:decodeURIComponent(o),itemId:decodeURIComponent(i),path:decodeURIComponent(s),containerPackageName:a?decodeURIComponent(a):void 0,fileVersion:c?decodeURIComponent(c):void 0}}(e.url),a=await async function(e,t){const n=Ci.Ss.from(`${e}_${t}`);return encodeURIComponent(await ic(n,"SHA-256","base64"))}(n,r);(0,Wo.vA)(!a.includes("/"),168);const c=`https://placeholder/placeholder/${a}/${l=o,l.startsWith("/")?l.slice(1):l}`;var l;const u=!!e.headers?.[nc.U.summarizingClient];return{type:"fluid",odspResolvedUrl:!0,endpoints:{snapshotStorageUrl:uc(t,n,r,s),attachmentPOSTStorageUrl:dc(t,n,r,s),attachmentGETStorageUrl:pc(t,n,r,s),deltaStorageUrl:hc(t,n,r,s)},id:a,tokens:{},url:c,hashedDocumentId:a,siteUrl:t,driveId:n,itemId:r,dataStorePath:o,fileName:"",summarizer:u,codeHint:{containerPackageName:i},fileVersion:s,isClpCompliantApp:e.headers?.[ec.isClpCompliantApp],fileMetadata:{eTag:e.headers?.[tc.eTag]}}}async getAbsoluteUrl(e,t,n){const r=(0,ac.Yn)(e);let o,i=t;var s;return""===t&&void 0!==r.dataStorePath&&(i=r.dataStorePath),i.startsWith("/")&&(i=i.slice(1)),n&&"name"in n?o=n.name:(s=n?.package,o="object"==typeof s&&"string"==typeof s?.name&&"object"==typeof s?.fluid?n?.package.name:n?.package),o=o??r.codeHint?.containerPackageName,rc({...r,containerPackageName:o,dataStorePath:i})}}class gc{constructor(e,t){this.expiry=e,this.cleanup=t,this.gcTimeouts=new Map}schedule(e){"indefinite"!==this.expiry.policy&&this.gcTimeouts.set(e,setTimeout((()=>{this.cleanup(e),this.cancel(e)}),this.expiry.durationMs))}cancel(e){const t=this.gcTimeouts.get(e);void 0!==t&&(clearTimeout(t),this.gcTimeouts.delete(e))}update(e){"sliding"===this.expiry.policy&&(this.cancel(e),this.schedule(e))}}class mc{constructor({expiry:e={policy:"indefinite"},removeOnError:t=()=>!0}={}){this.cache=new Map,this.removeOnError=t,this.gc=new gc(e,(e=>this.remove(e)))}has(e){return this.cache.has(e)}get(e){return this.has(e)&&this.gc.update(e),this.cache.get(e)}remove(e){return this.gc.cancel(e),this.cache.delete(e)}async addOrGet(e,t){let n=this.get(e);if(void 0===n){n=(async()=>t())(),this.cache.set(e,n),n.catch((t=>{this.removeOnError(t)&&this.remove(e)})),this.gc.schedule(e)}return n}add(e,t){const n=this.has(e);return this.addOrGet(e,t).catch((()=>{})),!n}async addValueOrGet(e,t){return this.addOrGet(e,(async()=>t))}addValue(e,t){return this.add(e,(async()=>t))}}function vc(e){return(0,Wo.vA)(!!e,2358),{Authorization:e}}const yc=Symbol("`mockify` mock function key");function bc(e){const t=(...e)=>t[yc](...e);return t[yc]=e,t}bc.key=yc;s(8980);const Sc="Odsp409Error";const wc=new Map,Cc=bc((async(e,t,n)=>{const r=`${t.siteUrl}_${t.driveId}_${t.itemId}`,o=wc.get(r);if(void 0!==o)return o;const i=async function(){let o;try{let r=0;o=await ei((async()=>async function(e,t,n,r){let o=1e3;const i=(0,zo.l)();let s;for(let a=1;;a++){void 0!==r&&r();try{const r=await e();return a>1&&n.sendTelemetryEvent({eventName:"MultipleRetries",callName:t,attempts:a,duration:(0,zo.l)()-i},s),r}catch(e){const r=(0,Zo.YU)(e),c=!0===e?.[Sc],l=e?.errorType===Io.E.serviceReadOnly;if(1===a&&n.sendTelemetryEvent({eventName:`${t}_firstFailed`,callName:t,attempts:a,duration:(0,zo.l)()-i},e),!c&&!l||!r)throw e;if(5===a)throw n.sendErrorEvent({eventName:c?"CoherencyErrorTooManyRetries":"ServiceReadonlyErrorTooManyRetries",callName:t,attempts:a,duration:(0,zo.l)()-i},e),e.canRetry=!1,e;o=(0,Zo.E9)(e)??o,await Yo(Math.floor(o)),o+=o/4*(1+Math.random()),s=e}}}((async()=>async function(e,t,n){let r,o=!1;for(let i=1;i<=5;i++)try{const r=await Pc(e,t,n),s=new URL(t.siteUrl).origin,a=new URL(r.sharepointIds.siteUrl).origin;return s!==a&&(o=!0,n.sendTelemetryEvent({eventName:"LocationRedirectionErrorForGetOdspFileLink",retryCount:i}),Tc(t,a)),await Ec(e,t,n,r)}catch(e){if(r=e,(0,Xo.X)(e)&&o&&(e.errorType===Io.E.fileNotFoundOrAccessDeniedError||e.errorType===Io.E.authorizationError))continue;throw e}throw r}(e,t,n)),"getFileLinkCore",n)),"getShareLink",n,{onRetry(e,t){if(r++,5===r){if(void 0!==t&&"object"==typeof t)throw t.canRetry=!1,t;throw t}}})}catch(e){throw wc.delete(r),e}return(0,Wo.vA)(void 0!==o,658),o}();return wc.set(r,i),i}));async function Ec(e,t,n,r){return ho.Bt.timedExecAsync(n,{eventName:"odspFileLink",requestName:"getSharingInformation"},(async o=>{let i,s=0;const a=await(0,ac.gO)((async o=>{s++;const a=(0,ac.bJ)(n,t,e),c=`${t.siteUrl}/_api/web/GetFileById(@a1)/ListItemAllFields/GetSharingInformation?@a1=guid${encodeURIComponent(`'${r.sharepointIds.listItemUniqueId}'`)}`,l="POST",u={method:l,headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose",...vc(await a({...o,request:{url:c,method:l}},"GetFileLinkCore"))}},d=await(0,ac.ZR)(c,u);i=d.propsToLog;const p=await d.content.json(),h=p?.d?.directUrl;if("string"!=typeof h)throw new Zo.OI("Malformed GetSharingInformation response",Io.E.incorrectServerResponse,{driverVersion:cc.z});return h}));return o.end({...i,attempts:s}),a}))}const kc=e=>"string"==typeof e.webUrl&&"string"==typeof e.webDavUrl&&"object"==typeof e.sharepointIds;async function Pc(e,t,n){return ho.Bt.timedExecAsync(n,{eventName:"odspFileLink",requestName:"getFileItemLite"},(async r=>{let o,i=0;const s=await(0,ac.gO)((async r=>{i++;const{siteUrl:s,driveId:a,itemId:c}=t,l=(0,ac.bJ)(n,t,e),u=`${s}/_api/v2.0/drives/${a}/items/${c}?select=webUrl,webDavUrl,sharepointIds`,d=await l({...r,request:{url:u,method:"GET"}},"GetFileItemLite");(0,Wo.vA)(null!==d,700);const p={method:"GET",headers:vc(d)},h=await(0,ac.ZR)(u,p);o=h.propsToLog;const f=await h.content.json();if(!kc(f))throw new Zo.OI("Malformed getFileItemLite response",Io.E.incorrectServerResponse,{driverVersion:cc.z});return f}));return r.end({...o,attempts:i}),s}))}function Tc(e,t){const n=`${t}${new URL(e.siteUrl).pathname}`;e.siteUrl=n,e.endpoints.attachmentGETStorageUrl&&(e.endpoints.attachmentGETStorageUrl=`${t}${new URL(e.endpoints.attachmentGETStorageUrl).pathname}`),e.endpoints.attachmentPOSTStorageUrl&&(e.endpoints.attachmentPOSTStorageUrl=`${t}${new URL(e.endpoints.attachmentPOSTStorageUrl).pathname}`),e.endpoints.deltaStorageUrl&&(e.endpoints.deltaStorageUrl=`${t}${new URL(e.endpoints.deltaStorageUrl).pathname}`),e.endpoints.snapshotStorageUrl&&(e.endpoints.snapshotStorageUrl=`${t}${new URL(e.endpoints.snapshotStorageUrl).pathname}`)}class Nc{constructor(e,t,n,r,o){this.appName=n,this.getContext=r,this.containerPackageInfo=o,this.sharingLinkCache=new mc,this.logger=(0,ac.bP)(t),e&&(this.shareLinkFetcherProps={...e,tokenFetcher:e.tokenFetcher})}appendDataStorePath(e,t){const n=(0,gt.Mh)(e);if(!n)return;const r=new URL(n.dataStorePath,`${e.protocol}//${e.hostname}`);if(t.startsWith("/?")||t.startsWith("?")){const e=new URLSearchParams(t);for(const[t,n]of e.entries())r.searchParams.append(t,n);n.dataStorePath=`${r.pathname}${r.search}`}else n.dataStorePath=`${r.pathname}${r.pathname.endsWith("/")||t.startsWith("/")?"":"/"}${t}/${r.search}`;return(0,gt.Cu)(e,n),e.href}getKey(e){return`${e.siteUrl},${e.driveId},${e.itemId}`}async resolve(e){const t={headers:e.headers,url:e.url},n=t.headers?.[Za.isSharingLinkToRedeem],r=t.headers?.[Za.isRedemptionNonDurable];try{const n=new URL(e.url),r=(0,gt.Mh)(n);r&&(t.url=rc(r))}catch{}const o=await(new fc).resolve(t);return o.context=await(this.getContext?.(o,o.dataStorePath??"")),o.appName=this.appName,o.codeHint=o.codeHint?.containerPackageName?o.codeHint:{containerPackageName:(0,ac.nb)(this.containerPackageInfo)},n&&(o.shareLinkInfo=Object.assign(o.shareLinkInfo??{},{sharingLinkToRedeem:this.removeNavParam(e.url),isRedemptionNonDurable:r??!1})),o.itemId&&this.getShareLinkPromise(o).catch((()=>{})),o}removeNavParam(e){const t=new URL(e),n=new URLSearchParams(t.search);return n.delete(gt.jC),t.search=n.toString(),t.href}async getShareLinkPromise(e){if(void 0===this.shareLinkFetcherProps)throw new Error("Failed to get share link because share link fetcher props are missing");if(!(e.siteUrl&&e.driveId&&e.itemId))throw new Error("Failed to get share link because necessary information is missing (e.g. siteUrl, driveId or itemId)");const t=this.getKey(e),n=this.sharingLinkCache.get(t);if(n)return n;const r=Cc(this.shareLinkFetcherProps.tokenFetcher,e,this.logger).catch((e=>{throw this.logger.sendErrorEvent({eventName:"FluidFileUrlError"},e),this.sharingLinkCache.remove(t),e}));return this.sharingLinkCache.add(t,(async()=>r)),r}async getAbsoluteUrl(e,t,n){const r=(0,ac.Yn)(e),o=await this.getShareLinkPromise(r);return this.appendLocatorParams(o,e,t,n)}async appendLocatorParams(e,t,n,r){const o=(0,ac.Yn)(t),i=n||(o.dataStorePath??"");o.context=await(this.getContext?.(o,i));const s=(0,ac.nb)(r)??o.codeHint?.containerPackageName??(0,ac.nb)(this.containerPackageInfo);return o.appName=this.appName,(0,ac.z6)(e,o,i,s)}static createDocumentUrl(e,t){const n=new URL(e);return(0,gt.Cu)(n,t),n.href}}async function Ac(e,t){if("Data"!==e.type||"URL"!==e.dataType)return;const n=e.data.url,r=await t;if(!r||r instanceof fc||r instanceof Nc)return function(e){const t=(0,gt.Mh)(e);if(!t)return;let n;try{t?.siteUrl&&(n=new URL(t?.siteUrl).origin)}catch{}return{codeDetailsHint:t?.containerPackageName,criticalBootDomains:n?[n]:void 0}}(n);try{const e=await r.resolve({url:n.href});if("fluid"===e?.type)return{}}catch{}}class Ic{constructor(e){this.props=e,e.logger&&(this.logger=new Le.p("LoopLoader",e.logger))}async instantiateLoopComponent(e){const{loopCodeLoader:t,dependencySynthesizer:n}=this.props,{registrationId:r}=e;if(!r)throw new Error("registrationId is required.");const o=await t.load({packageName:r}),i=new lt(n);this.logger&&i.register("NamespaceLogger",this.logger);const s="Data"===e.type?{creationData:e,manifestData:e.manifestData,componentPersistentInputData:e.componentPersistentInputData,storagePartitionKey:e.storagePartitionKey}:"Creation"===e.type?{creationData:{},manifestData:e.manifestData,componentPersistentInputData:e.componentPersistentInputData,storagePartitionKey:e.storagePartitionKey}:e;return o.module.loopExport.instantiateLoopComponent(s,i)}}async function Oc(e){const{loopComponentRouterInput:t,windowContextForLoader:n,dependencySynthesizer:r,config:o,logger:s,loopCodeLoaderFactory:a,requiredProviderTypes:c}=e,l=await async function(e,t,n,r,o){const{environment:s}=e,a=n.synthesize({InternationalizationContext:"InternationalizationContext",SettingsProvider:"SettingsProvider",TokenProvider:"TokenProvider",LoopTrustedTypesPolicy:"LoopTrustedTypesPolicy"},void 0),[c,l,u,d]=await Promise.all([a.InternationalizationContext,a.SettingsProvider,a.TokenProvider,a.LoopTrustedTypesPolicy]),p=c?.uiLocale,h={audience:s?.audience||"Production",localeHint:p||i,settingsProvider:l,windowContext:t,trustedTypesPolicy:d,tokenProvider:u,dependencySynthesizer:n,logger:r},f=await o.instantiateLoopCodeLoader(h);return new Ic({loopCodeLoader:f,dependencySynthesizer:n,logger:r})}(o,n,r,s,a),u=await l.instantiateLoopComponent(t);if(c){return Ys(u,void 0,c,r.synthesize({FluidDocumentServiceFactoryProvider:"FluidDocumentServiceFactoryProvider"},void 0).FluidDocumentServiceFactoryProvider,void 0,s)}return u}async function Lc(e){const{windowContextForLoader:t,loopComponentRouterInput:n,dependencySynthesizer:r,config:o={},logger:i,perfMetadata:s,documentHiddenTrackerId:a,fluidRequestHeaders:c}=e,{registrationId:l,manifestData:u}=n;if(l&&!uo(l)){const e={LoopCodeLoaderFactoryProvider:"LoopCodeLoaderFactoryProvider"},{LoopCodeLoaderFactoryProvider:s}=r.synthesize(e,void 0),a=await s,c=await(a?.getLoopCodeLoaderFactory());if(!c)throw new Error("loopCodeLoaderFactory is required for non-fluid components.");return{component:Oc({loopComponentRouterInput:n,windowContextForLoader:t,dependencySynthesizer:r,config:o,logger:i,loopCodeLoaderFactory:c}),container:Promise.resolve(void 0)}}if("Data"===n.type&&"URL"===n.dataType){let e;if(l&&uo(l)&&(e=u&&"object"==typeof u?u:void 0),e||(e=await Ac(n,async function(e){const{dependencySynthesizer:t}=e,n={DriverImplementation:"DriverImplementation",FluidUrlResolverProvider:"FluidUrlResolverProvider"},{DriverImplementation:r,FluidUrlResolverProvider:o}=t.synthesize(n,void 0),[i,s]=await Promise.all([r,o]);return i?.urlResolver??s?.urlResolver}({dependencySynthesizer:r}))),!e)throw new Error("Failed to create Fluid component from the provided url.");ja(e.codeDetailsHint,i);const d=function({windowContextForLoader:e,dependencySynthesizer:t,hostConfig:n,logger:r,perfMetadata:o,documentEverHiddenTrackerID:i,containerRequest:s,preCheckInfo:a,requiredProviderTypes:c}){const l={type:"Existing",containerRequest:s,containerCodeHint:a?.codeDetailsHint},{containerPromise:u,componentPromise:d}=Ya(e,l,s,t,n,r,o,i,c,void 0);return{container:u,component:d}}({windowContextForLoader:t,dependencySynthesizer:r,hostConfig:o,logger:i,perfMetadata:s,documentEverHiddenTrackerID:a,containerRequest:{url:n.data.url.href,headers:c},preCheckInfo:e});return d}throw new Error("Failed to create component.")}function Dc(e){const{windowContextForLoader:t,loopComponentRouterInput:n,dependencySynthesizer:r,config:o,logger:i,perfMetadata:s,documentHiddenTrackerId:a,requiredProviderTypes:c}=e,l={...o},u=Re.m.start(Yr,i,{addUserTiming:!0});if("Fluid"===n.type){if(i?.PersistedProperties){const e={isFluid:!0};i.PersistedProperties.addPersistedProperties(e)}const e=_a(n.codeDetails);ja(e,i);try{if(n.pendingLocalState){const o=function(e,t,n,r,o,i){const{componentPromise:s,containerPromise:a}=Ya(e,{type:"DetachedFromSnapshot",snapshot:t.snapshot},void 0,t.dependencySynthesizer,n,r,o,i,t.requiredProviderTypes,void 0);return{component:s,container:a}}(t,{dependencySynthesizer:r,snapshot:n.pendingLocalState,requiredProviderTypes:c},l,i,s,a);return u.setResult(!0,{packageName:e}),o}const o=function(e,t,n,r,o,i){const{componentPromise:s,containerPromise:a}=Ya(e,{type:"DetachedFromCode",codeDetails:t.codeDetails},void 0,t.dependencySynthesizer,n,r,o,i,t.requiredProviderTypes,t.loadTemplateProps);return{component:s,container:a}}(t,{dependencySynthesizer:r,codeDetails:n.codeDetails,loadTemplateProps:n.templateProps,requiredProviderTypes:c},l,i,s,a);return u.setResult(!0,{packageName:e}),o}catch(t){throw u.setResult(!1,{packageName:e},t),t}}const d=Lc({...e,loopComponentRouterInput:n});if(i?.PersistedProperties){const{registrationId:e}=n,t=!e||uo(e),r=sn(a),o=t?{isFluid:!0,documentEverHidden:r}:{isFluid:!1,loopRegistrationId:e,documentEverHidden:r};i.PersistedProperties.addPersistedProperties(o)}return{component:d.then((async e=>{const[t,o]=await Promise.all([e.container,e.component]);await async function(e,t){e.ComponentInitializer&&(t.markSubActivityStart("ComponentInitialize"),await e.ComponentInitializer.initialize(),t.markSubActivityEnd("ComponentInitialize"))}(o,u);const s=Fc(o);i?.PersistedProperties&&s&&i.PersistedProperties.addPersistedProperties({identityName:s}),u.setResult(!0),i&&function(e,t,n){const r=Fc(e);r&&!Rc.has(r)&&((0,De.Ot)(n,{eventName:"LoadComponentMetadata",identityName:r,source:t}),Rc.add(r))}(o,"owh-getLoopComponentInternal",i);const a=t&&"Data"===n.type&&"URL"===n.dataType?n.data.url.href:void 0;if(c){const e=r.synthesize({FluidDocumentServiceFactoryProvider:"FluidDocumentServiceFactoryProvider"},void 0);return Ys(o,t,c,e.FluidDocumentServiceFactoryProvider,a,i)}return o})).catch((e=>{throw u.setResult(!1,void 0,e),e})),container:d.then((e=>e.container)).catch((e=>{throw u.setResult(!1,void 0,e),e}))}}const Rc=new Set;function Fc(e){return e.ComponentTelemetryMetadata?.entityName}const Mc=new Map;function xc(e,t){t.then((async t=>{t?(t.attachState!==wo.d.Attached&&await new Promise((e=>{t.once("attached",e)})),e.resolve(t.resolvedUrl)):e.resolve(void 0)})).catch((()=>{e.resolve(void 0)}))}function _c(e,t){const n="LoopComponentLoader";if(e.has(n)&&window===t.windowContextForLoader)return e;const r=new lt(e);var o;return r.register(n,(o=t.windowContextForLoader,new jc(o))),r}function Uc(e,t,n){const r=new lt(e);return r.register("NestedLoopComponentHosting",async function(e,t,n){const r="NestedLoopComponentHosting",o="NestedLoopComponentLoader",i=e.synthesize({SettingsProvider:"SettingsProvider",NestedLoopComponentHosting:r,NestedLoopComponentLoader:o},void 0),a=await i.NestedLoopComponentHosting,c=await i.NestedLoopComponentLoader,l=a?.getNestedDependencyContainer?.bind(a)??c?.getNestedDependencyContainer?.bind(c),u=Ka(await i.SettingsProvider)?function(e,t,n){return r=>{if(!r.has("FluidDocumentServiceFactoryProvider"))return n&&(0,De.Ot)(n,{eventName:"NoFluidDocumentServiceFactoryForNestedDependencyContainer"}),t?.(r)??r;const o={SettingsProvider:"SettingsProvider",TokenProvider:"TokenProvider",UserContext:"UserContext"},i=r.synthesize(o,{FluidDocumentServiceFactoryProvider:"FluidDocumentServiceFactoryProvider"}),a=new lt(r),c=e.then((e=>{if(e&&(0,Js.g2)(e))return function(e,t,n){return new rt.I((async()=>{const[r,o,i,a]=await Promise.all([e.FluidDocumentServiceFactoryProvider,e.SettingsProvider,e.TokenProvider,e.UserContext]);return s.e(160).then(s.bind(s,7539)).then((e=>new e.OdspFluidDocumentServiceFactory({hostDocumentServiceFactory:r,settingsProvider:o,tokenProvider:i,userContext:a},t,Mc,n)))}))}({FluidDocumentServiceFactoryProvider:i.FluidDocumentServiceFactoryProvider,SettingsProvider:i.SettingsProvider,TokenProvider:i.TokenProvider,UserContext:i.UserContext},e,n);{const t=e?"ResolvedUrlNotOdsp":"ResolvedUrlUndefined";return(0,De.A$)(ot.hB.Generic,n,{eventName:t}),i.FluidDocumentServiceFactoryProvider.then((e=>function({documentServiceFactory:e,createDocumentRequest:t}){return{get FluidDocumentServiceFactoryProvider(){return this},documentServiceFactory:e,getCreateDocumentRequest:t,get Disposable(){return this},dispose:()=>{}}}({documentServiceFactory:e.documentServiceFactory,createDocumentRequest:e.getCreateDocumentRequest})))}}));return a.register("FluidDocumentServiceFactoryProvider",c),t?.(a)??a}}(t,l,n):l;return new zc(u)}(e,t,n)),r}class jc{constructor(e){this.windowContextForLoader=e}dispose(){}get LoopComponentLoader(){return this}get Disposable(){return this}async getLoopComponent({loopComponentRouterInput:e,dependencySynthesizer:t,fluidRequestHeaders:n,requiredProviderTypes:r}){const{logger:o,perfMetadata:i,documentHiddenTrackerId:s}=co({logger:await t.synthesize({NamespaceLogger:"NamespaceLogger"},void 0).NamespaceLogger}),a=new yo,c=Dc({windowContextForLoader:this.windowContextForLoader,loopComponentRouterInput:e,dependencySynthesizer:Uc(t,a,o),logger:o,perfMetadata:i,documentHiddenTrackerId:s,fluidRequestHeaders:n,requiredProviderTypes:r});return xc(a,c.container),Promise.all([c.container,c.component]).then((([e,t])=>t))}}class zc{constructor(e){this.getNestedDependencyContainerImpl=e}get NestedLoopComponentHosting(){return this}getNestedDependencyContainer(e){return this.getNestedDependencyContainerImpl?this.getNestedDependencyContainerImpl(e):e}dispose(){}get Disposable(){return this}}const qc=1e4;class Bc{get NamespaceLogger(){return this}get PersistedProperties(){return this}constructor(e,t){this.namespace=t,this.persistentProps=e||{},this.namespace=t}send(e){this.sendWithNamespace(e,this.namespace)}sendWithNamespace(e,t){const n=t||this.namespace;let{category:r,...o}={...this.persistentProps,...e},i=!1;o.sampleEvent&&(i=Boolean(o.sampleEvent),delete o.sampleEvent);const s=Object.keys(o).length>100;"error"!==r&&"Error"!==r||(o=(e=>{let t;return"string"==typeof e.message&&e.message.length>qc&&(t="message",e.message=e.message.substr(0,qc)),"string"==typeof e.stack&&e.stack.length>qc&&(t=t?t.concat(", stack"):"stack",e.stack=e.stack.substr(0,qc)),t?{...e,cappedFields:t}:e})(o)),this.logEvent({category:r,props:{...o,exceedsMaxAllowedFields:s},sampleEvent:i,namespace:n})}addPersistedProperties(e){this.persistentProps={...this.persistentProps,...e}}getPersistedProperties(){return{...this.persistentProps}}}var $c=s(9307);const Hc=new class{logEvent(e){if(e.category===ot.hB.Error)$c.error("%cPurple: %cSession_Id:%s %s","color: purple; font-style: italic","",this.sessionId,JSON.stringify(e));else $c.log("%cPurple: %cSession_Id:%s %s","color: purple; font-style: italic","",this.sessionId,JSON.stringify(e))}setSessionId(e){this.sessionId=e}setUserContext(e){}shutdown(){}loadFull(){return Promise.resolve()}loadAsha(){}constructor(){this.sessionId=""}};var Wc=s(7096);const Gc={Open:"Open",Interruptions:"Interruptions",VetoMissingClassification:"VetoMissingClassification"},Vc="LoadFailed",Qc="UnhandledError",Jc="UnhandledRejection",Kc=[{pillar:Gc.Open,vetos:[Vc]},{pillar:Gc.Interruptions,vetos:[Qc,Jc]}];function Yc(e){for(const t of Kc)if(t.vetos.includes(e))return t.pillar;return Gc.VetoMissingClassification}const Xc={token:"6a8929bcfc6d44e9b13fee392ada9cf0-4dea6a88-32c5-404b-8af1-4a43b94ef559-7393",directNumericMeasurementToken:"970a2f2bd232416db9f00ce2dc4e0490-505d1603-e4f2-4da4-9ba3-13325ddc1915-7112",namespacePrefix:"Office.Fluid"},Zc={token:"742fa5a288b045e5beab1a2b8e445a71-66618038-43f3-4a1f-a680-59d90da7d572-7251",directNumericMeasurementToken:"970a2f2bd232416db9f00ce2dc4e0490-505d1603-e4f2-4da4-9ba3-13325ddc1915-7112",namespacePrefix:"Office.Fluid"},el={token:"954f09bf2c8a4321823cdeae34562b5c-d0886c33-e264-4c84-8ae5-a767e01b42cb-7479",namespacePrefix:"Office.Fluid.Workspaces"};function tl(e){return function(){let e=!1;try{e=!!localStorage.getItem("FluidCodeDetailsOverride")}catch{}return e}()||function(e){return"Local"===e||"Automation"===e||"SyntheticTraffic"===e||"Development"===e}(e)?Zc:Xc}var nl=s(9307);class rl{constructor(e,t,n){this.initialPersistentProps=t,this.ashaLoadStarted=!1,this.telemetryLogger=new f.GV(void 0,void 0,this.getTelemetryConfig(e)),this.telemetryLogger.partAFields.push((0,S.m9)("Loop.Audience",e)),this.ariaInfo=n?.useFluidWorkspacesAriaInfo?el:tl(e),this.telemetryLogger.setTenantToken(this.ariaInfo.namespacePrefix,this.ariaInfo.token,f.di),this.isNonProductionAudience(e)&&this.registerOtelErrorsListener()}async logEvent(e){let{namespace:t,category:n,props:r,sampleEvent:o}=e;if(n===ot.hB.UserAction)this.logUserActionEventToOtel(e);else if(n===ot.hB.Activity)this.logActivityEventToOtel(e);else if(n===ot.hB.DNM)this.ariaInfo.directNumericMeasurementToken&&this.logDNMEventToOTel(e);else{if(["AshaPillarAdd","AshaPillarRemove","AshaError"].includes(r.eventName))return this.loadAsha(),void this.ashaUtils?.then((({handleAshaEvent:t})=>t(e))).catch((()=>{this.logDefaultEventToOtel({category:ot.hB.Error,namespace:t,props:{eventName:`${r.eventName}Failure`},sampleEvent:o})}));n===ot.hB.Error&&function(e){return"eventName"in e&&"veto"in e}(r)&&(r=function(e){return{...e,pillar:e.pillar??Yc(e.veto),isIntentional:e.isIntentional??!1,isInternal:e.isInternal??!0,alertOnPillar:e.alertOnPillar??!0,isSessionEndingError:e.isSessionEndingError??!1}}(r)),this.logDefaultEventToOtel({namespace:t,category:n,props:r,sampleEvent:o})}}shutdown(){this.ashaUtils?.then((({shutdownAshaForFluid:e})=>e())).catch((()=>{this.logDefaultEventToOtel({category:ot.hB.Error,props:{eventName:"AshaShutdownFailure"}})}))}logDefaultEventToOtel(e){this.logEventToOtelInternal(e,(t=>{this.prepareDefaultOtelEvent(t,e)}))}logActivityEventToOtel(e){this.logEventToOtelInternal(e,(t=>{this.prepareActivityOtelEvent(t,{...e.props})}))}logUserActionEventToOtel(e){this.logEventToOtelInternal(e,(t=>{this.prepareUserActionOtelEvent(t,{...e.props},e.namespace)}))}logDNMEventToOTel(e){const t=e.props.eventName,n=e.props.dataName,r=e.props.dataMeasurement;if("string"!=typeof t||"string"!=typeof n||"number"!=typeof r&&"boolean"!=typeof r)return;const o={eventName:t,dataName:n,dataMeasurement:r,dataType:e.props.dataType,interval:e.props.interval};this.logDirectNumericMeasurementEvent(o)}logDirectNumericMeasurementEvent(e){const t=[];switch(e.dataType){case ot.Qq.Bool:t.push((0,S.LK)(e.dataName,e.dataMeasurement));break;case ot.Qq.Double:t.push((0,S.ip)(e.dataName,e.dataMeasurement));break;case ot.Qq.Int64:t.push((0,S.Ug)(e.dataName,e.dataMeasurement))}if(!e.eventName||0===e.eventName.length)return;const n=e.eventName[0].toUpperCase()+e.eventName.slice(1),r={telemetryProperties:{dnmToken:this.ariaInfo.directNumericMeasurementToken,dnmInterval:e.interval,dnmAllowedPartA:[3,4,5,1]},eventName:"Office.DNM.Loop."+n,eventFlags:{dataCategories:E.DataCategories.ProductServicePerformance,diagnosticLevel:E.DiagnosticLevel.RequiredServiceData},dataFields:t};this.telemetryLogger.sendDirectNumericEvent(r)}getTelemetryConfig(e){const t={enableQueue:!0};return this.isNonProductionAudience(e)?t:{...t,disableValidation:!0}}isNonProductionAudience(e){return"Automation"===e||"Local"===e||"Staging"===e}registerOtelErrorsListener(){(0,m.d$)().addListener((e=>{0===e.category&&0===e.level&&nl.error(e.message())}))}getDataFieldsFromProps(e){const t=[];if(Object.keys(e).forEach((n=>{const r=(0,Wc.R)(e[n],n);r&&t.push(r)})),e.dataFields){const n=e.dataFields;t.push(...n)}return t}logEventToOtelInternal(e,t){const n=this.getBasicOtelEvent(e);t(n),this.telemetryLogger.sendTelemetryEvent(n)}getBasicOtelEvent(e){let t=e.category&&`${e.category.charAt(0).toUpperCase()}${e.category.substring(1)}`;e.props.subCategory&&e.category===ot.hB.Generic&&(t+=`.${e.props.subCategory.charAt(0).toUpperCase()}${e.props.subCategory.substring(1)}`);let n=!1;return e.sampleEvent&&(n=e.sampleEvent),{eventName:`${this.ariaInfo.namespacePrefix}${e.namespace?"."+e.namespace:""}.${t}`,eventFlags:{diagnosticLevel:E.DiagnosticLevel.RequiredServiceData,samplingPolicy:n?E.SamplingPolicy.Measure:void 0}}}prepareDefaultOtelEvent(e,t){e.eventFlags.dataCategories=E.DataCategories.ProductServicePerformance,e.dataFields=this.getDataFieldsFromProps({...t.props})}mapActivityResultTypeToCode(e){switch(e){case ot.Tp.Failure:return 0;case ot.Tp.Success:return 1;case ot.Tp.Cancelled:return 2}}prepareBaseActivityOtelEvent(e,t,n){t.durationMs||(t.durationMs=0);const r=Math.floor(1e3*t.durationMs),{durationMs:o,succeeded:i,resultType:s,...a}=t;return e.eventContract={name:g.Il.contractName,dataFields:g.Il.getFields({duration:r,count:1,aggMode:0,success:i,result:!n&&s?{code:this.mapActivityResultTypeToCode(s),type:s}:void 0})},a}prepareActivityOtelEvent(e,t){const n=t.eventName;e.eventName+=`.${n.charAt(0).toUpperCase()}${n.substring(1)}`,e.eventFlags.dataCategories=E.DataCategories.ProductServicePerformance;const r=this.prepareBaseActivityOtelEvent(e,t,!1);e.dataFields=this.getDataFieldsFromProps(r||{})}prepareUserActionOtelEvent(e,t,n){const r=t.eventName;e.eventName+=`.${r.charAt(0).toUpperCase()}${r.substring(1)}`,e.eventFlags.dataCategories=E.DataCategories.ProductServiceUsage;const o=g.rh.getFields("Funnel",{name:n,state:"Successful"}),i=t,s=g.ay.getFields({id:i.actionId,name:r,commandSurface:i.commandSurface,parentName:i.parentName,triggerMethod:i.triggerMethod,timeOffsetMs:i.timeOffsetMs}),a=this.prepareBaseActivityOtelEvent(e,t,!0),{eventName:c,actionId:l,commandSurface:u,parentName:d,triggerMethod:p,timeOffsetMs:h,...f}=a;e.dataFields=[...o,...s,...this.getDataFieldsFromProps(f||{})]}loadAsha(){this.ashaLoadStarted||(this.ashaLoadStarted=!0,this.ashaUtils=s.e(941).then(s.bind(s,2471)),this.ashaUtils.then((({initializeAshaForFluid:e})=>e(this.ariaInfo.namespacePrefix,this.initialPersistentProps,(e=>{delete e.eventContract,this.telemetryLogger.sendTelemetryEvent(e)})))).catch((()=>{this.ashaLoadStarted=!1,this.logDefaultEventToOtel({category:ot.hB.Error,props:{eventName:"AshaLoadFailure"}})})))}}class ol extends rl{constructor(e,t,n,r){super(t,n,r),this.hostTelemetrySink=e,this.loadFullCalled=!1}setUserContext(e){}replaceTelemetrySink(e){this.hostTelemetrySink=e,this.telemetryLogger.telemetrySinks.pop(),this.telemetryLogger.addSink(e),this.telemetryLogger.flushQueue()}async loadFull(){if(!this.loadFullCalled){this.loadFullCalled=!0;try{const e=await this.hostTelemetrySink;this.telemetryLogger.addSink(e),this.telemetryLogger.flushQueue()}catch(e){this.logDefaultEventToOtel({category:ot.hB.Error,props:{eventName:"FailedToLoadTelemetrySink",message:`${e}`}})}}}}class il{constructor(e){this.telemetrySink=e}get Disposable(){return this}dispose(){}get LoopTelemetrySink(){return this}sendTelemetryEvent(e,t){this.telemetrySink.sendTelemetryEvent(e,t)}sendCustomerContent(e){this.telemetrySink.sendCustomerContent?.(e)}sendNonStandardEvent(e,t){this.telemetrySink.sendNonStandardEvent?.(e,t)}}class sl extends rl{constructor(e,t){const n=(0,De.LJ)(e.audience),r=n?t:{...t,hostCorrelationId:""};super(e.audience,r),this.context=e,this.loadFullCalled=!1,this.allowedToLogEupi=!1,this.loopTelemetrySinkPromise=new Promise((e=>this.loopTelemetrySinkPromiseResolve=e)),this.allowedToLogEupi=n,this.scrubContextIfNecessary()}getLoopTelemetrySinkPromise(){return this.loopTelemetrySinkPromise.then()}async logEvent(e){return this.allowedToLogEupi||(e.props={...e.props,hostCorrelationId:""}),e.category===ot.hB.Error&&(this.loadFullCalled||this.loadFull().catch((()=>{}))),super.logEvent(e)}scrubContextIfNecessary(){this.allowedToLogEupi||(this.context.sessionId="",this.context.user=void 0)}setUserContext(e){this.context={...this.context,...e},this.scrubContextIfNecessary(),this.telemetrySink?.setPartADataFields(this.context)}shutdown(){super.shutdown(),this.loadFull().then((()=>this.telemetrySink?.shutdown())).catch((()=>{}))}async loadFull(){this.loadFullCalled||(this.loadFullCalled=!0,s.e(873).then(s.bind(s,8127)).then((e=>{this.telemetrySink=new e.OfficeFluidOneDsSink(this.context);const t=this.telemetrySink.createOneDsSink();this.telemetryLogger.addSink(t),this.telemetryLogger.flushQueue(),this.loopTelemetrySinkPromiseResolve?.(new il(t))})).catch((e=>{this.logDefaultEventToOtel({category:ot.hB.Error,props:{eventName:"LoggerLoadFailure",message:e.message,stack:e.stack}})})))}}var al=s(9307);class cl extends Bc{get Disposable(){return this}get PersistedProperties(){return this}getTelemetrySinkPromise(){return this.telemetrySinkPromise.then()}constructor(e){const t=e.hostTelemetryContext,n={...e.persistentProps,hostCorrelationId:t.hostCorrelationId,hostScenarioName:[t.hostScenarioLifecycle,t.hostScenarioName,t.hostScenarioEntryPoint].filter((e=>e)).join("_"),hostName:t.hostName,hostScenarioStartTime:t.hostScenarioStartTime,loopAudience:e.audience,hostSessionId:t.hostSessionId,hostAppVersion:t.hostAppVersion,hostAppPlatform:t.hostAppPlatform};super(n,e.namespace),this.forceTelemetryToConsole=!1,this.dispose=()=>{this.logProcessors.forEach((e=>e.shutdown()))},this.shutdown=()=>{this.Disposable.dispose()};const{delayLoadLogger:r,hostTelemetrySink:o}=e;this.audience=e.audience,this.logProcessors=[...e.additionalLogProcessors||[]];try{this.forceTelemetryToConsole="1"===localStorage.getItem("debugPurple"),this.forceTelemetryToConsole&&(Hc.setSessionId(e.hostTelemetryContext.hostSessionId),this.logProcessors.push(Hc))}catch{}if(o)this.telemetrySinkPromise=Promise.resolve(o).then((e=>new il(e))),this.logProcessors.push(new ol(o,this.audience,n,{useFluidWorkspacesAriaInfo:e.useFluidWorkspacesAriaInfo}));else{this.sendWithNamespace({eventName:"HostPassedTelemetrySinkNotPassed",sinkPassed:!1,category:"Error",sampleEvent:!0},"HostPassedTelemetrySink");const r=new sl({appPlatform:t.hostAppPlatform,appName:t.hostAppName,appVersion:t.hostAppVersion,user:t.userContext?.user,sessionId:t.hostSessionId,audience:this.audience,uiLanguage:e.hostTelemetryContext.uiLanguage},n);this.telemetrySinkPromise=r.getLoopTelemetrySinkPromise(),this.logProcessors.push(r)}if(r||this.loadFull().catch((()=>{})),e.hostMetadata&&!e.skipInitializationLogs){const{hostMetadata:t}=e,n=t.hostFlights,r=t.hostFlightsMetadata;this.sendWithNamespace({eventName:"HostMetadata",hostRing:t.hostRing,hostFlights:n&&JSON.stringify(n),hostFlightsMetadata:r&&JSON.stringify(r),category:"Generic"},"HostMetadata")}}async loadFull(){try{await Promise.allSettled([this.logProcessors.map((e=>e.loadFull()))])}catch{}}setUserContext(e){this.logProcessors.forEach((t=>t.setUserContext(e)))}logEvent(e){this.logProcessors.forEach((t=>t.logEvent(e)));if("Local"===this.audience){const t="UnhandledError"!==e.props.eventName&&"UnhandledRejection"!==e.props.eventName,n=e.category===ot.hB.Error||e.category===ot.hB.Activity&&!1===e.props.succeeded;t&&n&&!this.forceTelemetryToConsole&&al.error("OfficeFluidLogger %s %s event:",e.props.eventName,e.category,e.props,e.props.stack)}}addPersistedProperties(e){super.addPersistedProperties(e),s.e(941).then(s.bind(s,2471)).then((({updateAshaAdditionalPartCEventDataFromTelemetryProperties:t})=>t(e))).catch((()=>{this.send({category:"Error",eventName:"AshaUpdatePartCEventDataFailure"})}))}}var ll=s(9307);var ul=s(9307);const dl={HTMLViewable:"HTMLViewable",Disposable:"Disposable",WorkspaceAndPageManager:"WorkspaceAndPageManager",WorkspaceNavigationHandler:"WorkspaceNavigationHandler"},pl=async(e,t,n,r,o,i,s,a,c,l)=>Qe.runActivity("LoadLoopWorkspaceEndToEnd",(async u=>{var d;u.addData("InViewPort",s);const p=Date.now(),h=((e,t,n,r,o)=>{const i=rr.getCorrelationId(),s=rr.getSessionId(),a=Date.now();return ll.log("Host Correlation Id: ",i),ll.log("Host Session Id: ",s),new cl({hostTelemetryContext:{hostName:"OneNote",hostAppPlatform:rr.getPlatform(),hostAppName:"OneNote",hostCorrelationId:i,hostScenarioLifecycle:null!=t?t:"Load",hostScenarioName:null!=r?r:"Notebook",hostScenarioEntryPoint:null!=n?n:"NotebooksModuleHome",hostScenarioStartTime:null!=o?o:a,hostSessionId:s,hostAppVersion:Office.context.diagnostics.version,userContext:e},hostTelemetrySink:M.Instance,audience:Or()})})(t.getUserContext());u.addData("HostScenarioStartTime",p);const f=await n.registerProviders(e,t,r,h,o,a,c);fl(r,o);const g={dependencySynthesizer:f,loopComponentRouterInput:_r(i),config:{environment:r,logger:h},requiredProviderTypes:dl},m=Date.now();u.addData("PreloadDuration",m-p);const v=qr.startScenario(h,"Load");try{ul.log("HostedWorkspaceUI loadAndRender: awaiting component");const e=await gl(g),t=null===(d=await ml(e,h))||void 0===d?void 0:d.HTMLView;return s&&l?await hl(t,l,h,v):v.setSuccess({inViewport:!1}),{loopComponent:e,fluidLogger:h,view:t}}catch(e){throw v.setFailure(e,{inViewport:s}),x.Instance.logError("LoadLoopWorkspaceComponent",e,{ErrorMethod:"loadLoopWorkspaceComponent"}),ul.error("HostedWorkspaceUI loadAndRender: error loading component",e),e}})),hl=async(e,t,n,r)=>{const o=qr.startActivity(n,Ur);try{ul.log("HostedWorkspaceUI loadAndRender: rendering view"),await vl(e,t);const i=qr.startActivity(n,jr);requestAnimationFrame((()=>{null==r||r.setSuccess({inViewport:!0}),i.setSuccess(),o.setSuccess(),q.renderCompleteEvent()})),ul.log("HostedWorkspaceUI loadAndRender: view rendered")}catch(e){throw o.setFailure(e),e}},fl=async(e,t)=>Qe.runActivity("PreCacheCodeLoader",(async()=>{var n;try{const r=await Wn.instantiateLoopCodeLoader({windowContext:window,trustedTypesPolicy:void 0,audience:e.audience,localeHint:t});await(null===(n=r.preCache)||void 0===n?void 0:n.call(r,Ct)),ul.log("HostedWorkspaceUI loadAndRender: pre-caching complete")}catch(e){x.Instance.logError("CdnCodeLoaderPreCacheError",e,{ErrorMethod:"LoadLoopWorkspaceComponent"}),ul.error("HostedWorkspaceUI loadAndRender: pre-caching failed",e)}})),gl=async e=>Qe.runActivity("LoadLoopComponent",(async()=>await function({loopComponentRouterInput:e,dependencySynthesizer:t,config:n,fluidRequestHeaders:r,requiredProviderTypes:o}){const{logger:i,newConfig:s,perfMetadata:a,documentHiddenTrackerId:c}=co(n||{}),l=window;let u=_c(t,{windowContextForLoader:l});const d=new yo;u=Uc(u,d,i);const p=Dc({windowContextForLoader:l,loopComponentRouterInput:e,dependencySynthesizer:u,config:s,logger:i,perfMetadata:a,documentHiddenTrackerId:c,fluidRequestHeaders:r,requiredProviderTypes:o});return xc(d,p.container),Promise.all([p.container,p.component]).then((([e,t])=>t))}(e))),ml=async(e,t)=>Qe.runActivity("GetLoopView",(async()=>qr.startActivity(t,"GetView",(async()=>{var t;return null===(t=e.HTMLViewable)||void 0===t?void 0:t.getView()})))),vl=async(e,t)=>Qe.runActivity("RenderLoopComponent",(async()=>await(null==e?void 0:e.render(t)))),yl=()=>{const e={};return function(t,n){void 0===e[t.id]&&(t.insertCSSRules(n),e[t.id]=!0)}};function bl(e){for(var t,n=0,r=0,o=e.length;o>=4;++r,o-=4)t=1540483477*(65535&(t=255&e.charCodeAt(r)|(255&e.charCodeAt(++r))<<8|(255&e.charCodeAt(++r))<<16|(255&e.charCodeAt(++r))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(o){case 3:n^=(255&e.charCodeAt(r+2))<<16;case 2:n^=(255&e.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(r)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}function Sl(e){return e.reduce((function(e,t){var n=t[0],r=t[1];return e[n]=r,e[r]=n,e}),{})}function wl(e){return"number"==typeof e}function Cl(e,t){return-1!==e.indexOf(t)}function El(e,t,n,r){return t+(o=n,0===parseFloat(o)?o:"-"===o[0]?o.slice(1):"-"+o)+r;var o}function kl(e){return e.replace(/ +/g," ").split(" ").map((function(e){return e.trim()})).filter(Boolean).reduce((function(e,t){var n=e.list,r=e.state,o=(t.match(/\(/g)||[]).length,i=(t.match(/\)/g)||[]).length;return r.parensDepth>0?n[n.length-1]=n[n.length-1]+" "+t:n.push(t),r.parensDepth+=o-i,{list:n,state:r}}),{list:[],state:{parensDepth:0}}).list}function Pl(e){var t=kl(e);if(t.length<=3||t.length>4)return e;var n=t[0],r=t[1],o=t[2];return[n,t[3],o,r].join(" ")}var Tl={padding:function(e){var t=e.value;return wl(t)?t:Pl(t)},textShadow:function(e){var t=function(e){for(var t=[],n=0,r=0,o=!1;r<e.length;)o||","!==e[r]?"("===e[r]?(o=!0,r++):")"===e[r]?(o=!1,r++):r++:(t.push(e.substring(n,r).trim()),n=++r);return n!=r&&t.push(e.substring(n,r+1)),t}(e.value).map((function(e){return e.replace(/(^|\s)(-*)([.|\d]+)/,(function(e,t,n,r){return"0"===r?e:""+t+(""===n?"-":"")+r}))}));return t.join(",")},borderColor:function(e){return Pl(e.value)},borderRadius:function(e){var t=e.value;if(wl(t))return t;if(Cl(t,"/")){var n=t.split("/"),r=n[0],o=n[1];return Tl.borderRadius({value:r.trim()})+" / "+Tl.borderRadius({value:o.trim()})}var i=kl(t);switch(i.length){case 2:return i.reverse().join(" ");case 4:var s=i[0],a=i[1],c=i[2];return[a,s,i[3],c].join(" ");default:return t}},background:function(e){var t=e.value,n=e.valuesToConvert,r=e.isRtl,o=e.bgImgDirectionRegex,i=e.bgPosDirectionRegex;if(wl(t))return t;var s=t.replace(/(url\(.*?\))|(rgba?\(.*?\))|(hsl\(.*?\))|(#[a-fA-F0-9]+)|((^| )(\D)+( |$))/g,"").trim();return t=t.replace(s,Tl.backgroundPosition({value:s,valuesToConvert:n,isRtl:r,bgPosDirectionRegex:i})),Tl.backgroundImage({value:t,valuesToConvert:n,bgImgDirectionRegex:o})},backgroundImage:function(e){var t=e.value,n=e.valuesToConvert,r=e.bgImgDirectionRegex;return Cl(t,"url(")||Cl(t,"linear-gradient(")?t.replace(r,(function(e,t,r){return e.replace(r,n[r])})):t},backgroundPosition:function(e){var t=e.value,n=e.valuesToConvert,r=e.isRtl,o=e.bgPosDirectionRegex;return t.replace(r?/^((-|\d|\.)+%)/:null,(function(e,t){return function(e){var t=e.indexOf(".");if(-1===t)e=100-parseFloat(e)+"%";else{var n=e.length-t-2;e=(e=100-parseFloat(e)).toFixed(n)+"%"}return e}(t)})).replace(o,(function(e){return n[e]}))},backgroundPositionX:function(e){var t=e.value,n=e.valuesToConvert,r=e.isRtl,o=e.bgPosDirectionRegex;return wl(t)?t:Tl.backgroundPosition({value:t,valuesToConvert:n,isRtl:r,bgPosDirectionRegex:o})},transition:function(e){var t=e.value,n=e.propertiesToConvert;return t.split(/,\s*/g).map((function(e){var t=e.split(" ");return t[0]=n[t[0]]||t[0],t.join(" ")})).join(", ")},transitionProperty:function(e){var t=e.value,n=e.propertiesToConvert;return t.split(/,\s*/g).map((function(e){return n[e]||e})).join(", ")},transform:function(e){var t=e.value,n="[^\\u0020-\\u007e]",r="(?:(?:(?:\\[0-9a-f]{1,6})(?:\\r\\n|\\s)?)|\\\\[^\\r\\n\\f0-9a-f])",o="((?:-?(?:[0-9]*\\.[0-9]+|[0-9]+)(?:\\s*(?:em|ex|px|cm|mm|in|pt|pc|deg|rad|grad|ms|s|hz|khz|%)|-?(?:[_a-z]|"+n+"|"+r+")(?:[_a-z0-9-]|"+n+"|"+r+")*)?)|(?:inherit|auto))",i=new RegExp("(translateX\\s*\\(\\s*)"+o+"(\\s*\\))","gi"),s=new RegExp("(translate\\s*\\(\\s*)"+o+"((?:\\s*,\\s*"+o+"){0,1}\\s*\\))","gi"),a=new RegExp("(translate3d\\s*\\(\\s*)"+o+"((?:\\s*,\\s*"+o+"){0,2}\\s*\\))","gi"),c=new RegExp("(rotate[ZY]?\\s*\\(\\s*)"+o+"(\\s*\\))","gi");return t.replace(i,El).replace(s,El).replace(a,El).replace(c,El)}};Tl.objectPosition=Tl.backgroundPosition,Tl.margin=Tl.padding,Tl.borderWidth=Tl.padding,Tl.boxShadow=Tl.textShadow,Tl.webkitBoxShadow=Tl.boxShadow,Tl.mozBoxShadow=Tl.boxShadow,Tl.WebkitBoxShadow=Tl.boxShadow,Tl.MozBoxShadow=Tl.boxShadow,Tl.borderStyle=Tl.borderColor,Tl.webkitTransform=Tl.transform,Tl.mozTransform=Tl.transform,Tl.WebkitTransform=Tl.transform,Tl.MozTransform=Tl.transform,Tl.transformOrigin=Tl.backgroundPosition,Tl.webkitTransformOrigin=Tl.transformOrigin,Tl.mozTransformOrigin=Tl.transformOrigin,Tl.WebkitTransformOrigin=Tl.transformOrigin,Tl.MozTransformOrigin=Tl.transformOrigin,Tl.webkitTransition=Tl.transition,Tl.mozTransition=Tl.transition,Tl.WebkitTransition=Tl.transition,Tl.MozTransition=Tl.transition,Tl.webkitTransitionProperty=Tl.transitionProperty,Tl.mozTransitionProperty=Tl.transitionProperty,Tl.WebkitTransitionProperty=Tl.transitionProperty,Tl.MozTransitionProperty=Tl.transitionProperty,Tl["text-shadow"]=Tl.textShadow,Tl["border-color"]=Tl.borderColor,Tl["border-radius"]=Tl.borderRadius,Tl["background-image"]=Tl.backgroundImage,Tl["background-position"]=Tl.backgroundPosition,Tl["background-position-x"]=Tl.backgroundPositionX,Tl["object-position"]=Tl.objectPosition,Tl["border-width"]=Tl.padding,Tl["box-shadow"]=Tl.textShadow,Tl["-webkit-box-shadow"]=Tl.textShadow,Tl["-moz-box-shadow"]=Tl.textShadow,Tl["border-style"]=Tl.borderColor,Tl["-webkit-transform"]=Tl.transform,Tl["-moz-transform"]=Tl.transform,Tl["transform-origin"]=Tl.transformOrigin,Tl["-webkit-transform-origin"]=Tl.transformOrigin,Tl["-moz-transform-origin"]=Tl.transformOrigin,Tl["-webkit-transition"]=Tl.transition,Tl["-moz-transition"]=Tl.transition,Tl["transition-property"]=Tl.transitionProperty,Tl["-webkit-transition-property"]=Tl.transitionProperty,Tl["-moz-transition-property"]=Tl.transitionProperty;var Nl=Sl([["paddingLeft","paddingRight"],["marginLeft","marginRight"],["left","right"],["borderLeft","borderRight"],["borderLeftColor","borderRightColor"],["borderLeftStyle","borderRightStyle"],["borderLeftWidth","borderRightWidth"],["borderTopLeftRadius","borderTopRightRadius"],["borderBottomLeftRadius","borderBottomRightRadius"],["padding-left","padding-right"],["margin-left","margin-right"],["border-left","border-right"],["border-left-color","border-right-color"],["border-left-style","border-right-style"],["border-left-width","border-right-width"],["border-top-left-radius","border-top-right-radius"],["border-bottom-left-radius","border-bottom-right-radius"]]),Al=["content"],Il=Sl([["ltr","rtl"],["left","right"],["w-resize","e-resize"],["sw-resize","se-resize"],["nw-resize","ne-resize"]]),Ol=new RegExp("(^|\\W|_)((ltr)|(rtl)|(left)|(right))(\\W|_|$)","g"),Ll=new RegExp("(left)|(right)");function Dl(e){return Object.keys(e).reduce((function(t,n){var r=e[n];if("string"==typeof r&&(r=r.trim()),Cl(Al,n))return t[n]=r,t;var o=Rl(n,r),i=o.key,s=o.value;return t[i]=s,t}),Array.isArray(e)?[]:{})}function Rl(e,t){var n,r=/\/\*\s?@noflip\s?\*\//.test(t),o=r?e:Nl[n=e]||n,i=r?t:function(e,t){if(!function(e){return t=e,!("boolean"==typeof t||function(e){return null==e}(e));var t}(t))return t;if(n=t,n&&"object"==typeof n)return Dl(t);var n;var r,o=wl(t),i=function(e){return"function"==typeof e}(t),s=o||i?t:t.replace(/ !important.*?$/,""),a=!o&&s.length!==t.length,c=Tl[e];r=c?c({value:s,valuesToConvert:Il,propertiesToConvert:Nl,isRtl:!0,bgImgDirectionRegex:Ol,bgPosDirectionRegex:Ll}):Il[s]||s;if(a)return r+" !important";return r}(o,t);return{key:o,value:i}}const Fl="undefined"==typeof window?s.g:window,Ml="@griffel/";function xl(e,t){return Fl[Symbol.for(Ml+e)]||(Fl[Symbol.for(Ml+e)]=t),Fl[Symbol.for(Ml+e)]}const _l=xl("DEFINITION_LOOKUP_TABLE",{}),Ul="data-make-styles-bucket",jl="data-priority",zl="f",ql=7,Bl="___",$l=(Bl.length,{all:1,borderColor:1,borderStyle:1,borderWidth:1,borderBlock:1,borderBlockEnd:1,borderBlockStart:1,borderInline:1,borderInlineEnd:1,borderInlineStart:1}),Hl="DO_NOT_USE_DIRECTLY: @griffel/reset-value",Wl=/[A-Z]/g,Gl=/^ms-/,Vl={};function Ql(e){return"-"+e.toLowerCase()}function Jl(e){if(Object.prototype.hasOwnProperty.call(Vl,e))return Vl[e];if("--"===e.substr(0,2))return e;const t=e.replace(Wl,Ql);return Vl[e]=Gl.test(t)?"-"+t:t}function Kl(e){return"&"===e.charAt(0)?e.slice(1):e}var Yl="-moz-",Xl="-webkit-",Zl="comm",eu="rule",tu="decl",nu="@import",ru="@keyframes",ou="@layer",iu=Math.abs,su=String.fromCharCode,au=Object.assign;function cu(e){return e.trim()}function lu(e,t){return(e=t.exec(e))?e[0]:e}function uu(e,t,n){return e.replace(t,n)}function du(e,t,n){return e.indexOf(t,n)}function pu(e,t){return 0|e.charCodeAt(t)}function hu(e,t,n){return e.slice(t,n)}function fu(e){return e.length}function gu(e){return e.length}function mu(e,t){return t.push(e),e}function vu(e,t){for(var n="",r=0;r<e.length;r++)n+=t(e[r],r,e,t)||"";return n}function yu(e,t,n,r){switch(e.type){case ou:if(e.children.length)break;case nu:case tu:return e.return=e.return||e.value;case Zl:return"";case ru:return e.return=e.value+"{"+vu(e.children,r)+"}";case eu:if(!fu(e.value=e.props.join(",")))return""}return fu(n=vu(e.children,r))?e.return=e.value+"{"+n+"}":""}var bu=1,Su=1,wu=0,Cu=0,Eu=0,ku="";function Pu(e,t,n,r,o,i,s,a){return{value:e,root:t,parent:n,type:r,props:o,children:i,line:bu,column:Su,length:s,return:"",siblings:a}}function Tu(e,t){return au(Pu("",null,null,"",null,null,0,e.siblings),e,{length:-e.length},t)}function Nu(){return Eu=Cu>0?pu(ku,--Cu):0,Su--,10===Eu&&(Su=1,bu--),Eu}function Au(){return Eu=Cu<wu?pu(ku,Cu++):0,Su++,10===Eu&&(Su=1,bu++),Eu}function Iu(){return pu(ku,Cu)}function Ou(){return Cu}function Lu(e,t){return hu(ku,e,t)}function Du(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Ru(e){return bu=Su=1,wu=fu(ku=e),Cu=0,[]}function Fu(e){return ku="",e}function Mu(e){return cu(Lu(Cu-1,ju(91===e?e+2:40===e?e+1:e)))}function xu(e){return Fu(function(e){for(;Au();)switch(Du(Eu)){case 0:mu(qu(Cu-1),e);break;case 2:mu(Mu(Eu),e);break;default:mu(su(Eu),e)}return e}(Ru(e)))}function _u(e){for(;(Eu=Iu())&&Eu<33;)Au();return Du(e)>2||Du(Eu)>3?"":" "}function Uu(e,t){for(;--t&&Au()&&!(Eu<48||Eu>102||Eu>57&&Eu<65||Eu>70&&Eu<97););return Lu(e,Ou()+(t<6&&32==Iu()&&32==Au()))}function ju(e){for(;Au();)switch(Eu){case e:return Cu;case 34:case 39:34!==e&&39!==e&&ju(Eu);break;case 40:41===e&&ju(e);break;case 92:Au()}return Cu}function zu(e,t){for(;Au()&&e+Eu!==57&&(e+Eu!==84||47!==Iu()););return"/*"+Lu(t,Cu-1)+"*"+su(47===e?e:Au())}function qu(e){for(;!Du(Iu());)Au();return Lu(e,Cu)}function Bu(e){return Fu($u("",null,null,null,[""],e=Ru(e),0,[0],e))}function $u(e,t,n,r,o,i,s,a,c){for(var l=0,u=0,d=s,p=0,h=0,f=0,g=1,m=1,v=1,y=0,b="",S=o,w=i,C=r,E=b;m;)switch(f=y,y=Au()){case 40:if(108!=f&&58==pu(E,d-1)){-1!=du(E+=uu(Mu(y),"&","&\f"),"&\f",iu(l?a[l-1]:0))&&(v=-1);break}case 34:case 39:case 91:E+=Mu(y);break;case 9:case 10:case 13:case 32:E+=_u(f);break;case 92:E+=Uu(Ou()-1,7);continue;case 47:switch(Iu()){case 42:case 47:mu(Wu(zu(Au(),Ou()),t,n,c),c);break;default:E+="/"}break;case 123*g:a[l++]=fu(E)*v;case 125*g:case 59:case 0:switch(y){case 0:case 125:m=0;case 59+u:-1==v&&(E=uu(E,/\f/g,"")),h>0&&fu(E)-d&&mu(h>32?Gu(E+";",r,n,d-1,c):Gu(uu(E," ","")+";",r,n,d-2,c),c);break;case 59:E+=";";default:if(mu(C=Hu(E,t,n,l,u,o,a,b,S=[],w=[],d,i),i),123===y)if(0===u)$u(E,t,C,C,S,i,d,a,w);else switch(99===p&&110===pu(E,3)?100:p){case 100:case 108:case 109:case 115:$u(e,C,C,r&&mu(Hu(e,C,C,0,0,o,a,b,o,S=[],d,w),w),o,w,d,a,r?S:w);break;default:$u(E,C,C,C,[""],w,0,a,w)}}l=u=h=0,g=v=1,b=E="",d=s;break;case 58:d=1+fu(E),h=f;default:if(g<1)if(123==y)--g;else if(125==y&&0==g++&&125==Nu())continue;switch(E+=su(y),y*g){case 38:v=u>0?1:(E+="\f",-1);break;case 44:a[l++]=(fu(E)-1)*v,v=1;break;case 64:45===Iu()&&(E+=Mu(Au())),p=Iu(),u=d=fu(b=E+=qu(Ou())),y++;break;case 45:45===f&&2==fu(E)&&(g=0)}}return i}function Hu(e,t,n,r,o,i,s,a,c,l,u,d){for(var p=o-1,h=0===o?i:[""],f=gu(h),g=0,m=0,v=0;g<r;++g)for(var y=0,b=hu(e,p+1,p=iu(m=s[g])),S=e;y<f;++y)(S=cu(m>0?h[y]+" "+b:uu(b,/&\f/g,h[y])))&&(c[v++]=S);return Pu(e,t,n,0===o?eu:a,c,l,u,d)}function Wu(e,t,n,r){return Pu(e,t,n,Zl,su(Eu),hu(e,2,-2),0,r)}function Gu(e,t,n,r,o){return Pu(e,t,n,tu,hu(e,0,r),hu(e,r+1,-1),r,o)}function Vu(e){var t=gu(e);return function(n,r,o,i){for(var s="",a=0;a<t;a++)s+=e[a](n,r,o,i)||"";return s}}function Qu(e){return function(t){t.root||(t=t.return)&&e(t)}}const Ju=e=>{if(e.type===eu){if("string"==typeof e.props)return void 0;e.props=e.props.map((e=>-1===e.indexOf(":global(")?e:xu(e).reduce(((e,t,n,r)=>{if(""===t)return e;if(":"===t&&"global"===r[n+1]){const t=r[n+2].slice(1,-1)+" ";return e.unshift(t),r[n+1]="",r[n+2]="",e}return e.push(t),e}),[]).join("")))}};function Ku(e,t,n){switch(function(e,t){return 45^pu(e,0)?(((t<<2^pu(e,0))<<2^pu(e,1))<<2^pu(e,2))<<2^pu(e,3):0}(e,t)){case 5103:return Xl+"print-"+e+e;case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:return Xl+e+e;case 4215:if(102===pu(e,9))return Xl+e+e;if(116===pu(e,t+1))return Xl+e+e;break;case 4789:return Yl+e+e;case 5349:case 4246:case 6968:return Xl+e+Yl+e+e;case 6187:if(!lu(e,/grab/))return uu(uu(uu(e,/(zoom-|grab)/,Xl+"$1"),/(image-set)/,Xl+"$1"),e,"")+e;case 5495:case 3959:return uu(e,/(image-set\([^]*)/,Xl+"$1$`$1");case 4095:case 3583:case 4068:case 2532:return uu(e,/(.+)-inline(.+)/,Xl+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(fu(e)-1-t>6)switch(pu(e,t+1)){case 102:if(108===pu(e,t+3))return uu(e,/(.+:)(.+)-([^]+)/,"$1"+Xl+"$2-$3$1"+Yl+(108==pu(e,t+3)?"$3":"$2-$3"))+e;case 115:return~du(e,"stretch")?Ku(uu(e,"stretch","fill-available"),t)+e:e}}return e}function Yu(e,t,n,r){if(e.length>-1&&!e.return)switch(e.type){case tu:return void(e.return=Ku(e.value,e.length));case eu:if(e.length)return function(e,t){return e.map(t).join("")}(e.props,(function(t){switch(lu(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return vu([Tu(e,{props:[uu(t,/:(read-\w+)/,":"+Yl+"$1")]})],r);case"::placeholder":return vu([Tu(e,{props:[uu(t,/:(plac\w+)/,":"+Xl+"input-$1")]}),Tu(e,{props:[uu(t,/:(plac\w+)/,":"+Yl+"$1")]})],r)}return""}))}}const Xu=e=>{(function(e){switch(e.type){case"@container":case"@media":case"@supports":case ou:return!0}return!1})(e)&&Array.isArray(e.children)&&e.children.sort(((e,t)=>e.props[0]>t.props[0]?1:-1))};function Zu(){}const ed=/,( *[^ &])/g;function td(e,t,n){let r=t;return n.length>0&&(r=n.reduceRight(((e,t)=>{return`${n=t,"&"+Kl(n.replace(ed,",&$1"))} { ${e} }`;var n}),t)),`${e}{${r}}`}function nd(e,t){const{className:n,selectors:r,property:o,rtlClassName:i,rtlProperty:s,rtlValue:a,value:c}=e,{container:l,layer:u,media:d,supports:p}=t;let h=td(`.${n}`,Array.isArray(c)?`${c.map((e=>`${Jl(o)}: ${e}`)).join(";")};`:`${Jl(o)}: ${c};`,r);if(s&&i){h+=td(`.${i}`,Array.isArray(a)?`${a.map((e=>`${Jl(s)}: ${e}`)).join(";")};`:`${Jl(s)}: ${a};`,r)}return d&&(h=`@media ${d} { ${h} }`),u&&(h=`@layer ${u} { ${h} }`),p&&(h=`@supports ${p} { ${h} }`),l&&(h=`@container ${l} { ${h} }`),function(e,t){const n=[];return vu(Bu(e),Vu([Ju,t?Xu:Zu,Yu,yu,Qu((e=>n.push(e)))])),n}(h,!0)}function rd(e){let t="";for(const n in e){const r=e[n];if("string"!=typeof r&&"number"!=typeof r){if(Array.isArray(r))for(const e of r)t+=Jl(n)+":"+e+";"}else t+=Jl(n)+":"+r+";"}return t}function od(e){let t="";for(const n in e)t+=`${n}{${rd(e[n])}}`;return t}function id(e,t){const n=[];return vu(Bu(`@keyframes ${e} {${t}}`),Vu([yu,Yu,Qu((e=>n.push(e)))])),n}const sd={animation:[-1,["animationDelay","animationDirection","animationDuration","animationFillMode","animationIterationCount","animationName","animationPlayState","animationTimeline","animationTimingFunction"]],animationRange:[-1,["animationRangeEnd","animationRangeStart"]],background:[-2,["backgroundAttachment","backgroundClip","backgroundColor","backgroundImage","backgroundOrigin","backgroundPosition","backgroundPositionX","backgroundPositionY","backgroundRepeat","backgroundSize"]],backgroundPosition:[-1,["backgroundPositionX","backgroundPositionY"]],border:[-2,["borderBottom","borderBottomColor","borderBottomStyle","borderBottomWidth","borderLeft","borderLeftColor","borderLeftStyle","borderLeftWidth","borderRight","borderRightColor","borderRightStyle","borderRightWidth","borderTop","borderTopColor","borderTopStyle","borderTopWidth"]],borderBottom:[-1,["borderBottomColor","borderBottomStyle","borderBottomWidth"]],borderImage:[-1,["borderImageOutset","borderImageRepeat","borderImageSlice","borderImageSource","borderImageWidth"]],borderLeft:[-1,["borderLeftColor","borderLeftStyle","borderLeftWidth"]],borderRadius:[-1,["borderBottomLeftRadius","borderBottomRightRadius","borderTopLeftRadius","borderTopRightRadius"]],borderRight:[-1,["borderRightColor","borderRightStyle","borderRightWidth"]],borderTop:[-1,["borderTopColor","borderTopStyle","borderTopWidth"]],caret:[-1,["caretColor","caretShape"]],columnRule:[-1,["columnRuleColor","columnRuleStyle","columnRuleWidth"]],columns:[-1,["columnCount","columnWidth"]],containIntrinsicSize:[-1,["containIntrinsicHeight","containIntrinsicWidth"]],container:[-1,["containerName","containerType"]],flex:[-1,["flexBasis","flexGrow","flexShrink"]],flexFlow:[-1,["flexDirection","flexWrap"]],font:[-1,["fontFamily","fontSize","fontStretch","fontStyle","fontVariant","fontWeight","lineHeight"]],gap:[-1,["columnGap","rowGap"]],grid:[-1,["columnGap","gridAutoColumns","gridAutoFlow","gridAutoRows","gridColumnGap","gridRowGap","gridTemplateAreas","gridTemplateColumns","gridTemplateRows","rowGap"]],gridArea:[-1,["gridColumnEnd","gridColumnStart","gridRowEnd","gridRowStart"]],gridColumn:[-1,["gridColumnEnd","gridColumnStart"]],gridRow:[-1,["gridRowEnd","gridRowStart"]],gridTemplate:[-1,["gridTemplateAreas","gridTemplateColumns","gridTemplateRows"]],inset:[-1,["bottom","left","right","top"]],insetBlock:[-1,["insetBlockEnd","insetBlockStart"]],insetInline:[-1,["insetInlineEnd","insetInlineStart"]],listStyle:[-1,["listStyleImage","listStylePosition","listStyleType"]],margin:[-1,["marginBottom","marginLeft","marginRight","marginTop"]],marginBlock:[-1,["marginBlockEnd","marginBlockStart"]],marginInline:[-1,["marginInlineEnd","marginInlineStart"]],mask:[-1,["maskClip","maskComposite","maskImage","maskMode","maskOrigin","maskPosition","maskRepeat","maskSize"]],maskBorder:[-1,["maskBorderMode","maskBorderOutset","maskBorderRepeat","maskBorderSlice","maskBorderSource","maskBorderWidth"]],offset:[-1,["offsetAnchor","offsetDistance","offsetPath","offsetPosition","offsetRotate"]],outline:[-1,["outlineColor","outlineStyle","outlineWidth"]],overflow:[-1,["overflowX","overflowY"]],overscrollBehavior:[-1,["overscrollBehaviorX","overscrollBehaviorY"]],padding:[-1,["paddingBottom","paddingLeft","paddingRight","paddingTop"]],paddingBlock:[-1,["paddingBlockEnd","paddingBlockStart"]],paddingInline:[-1,["paddingInlineEnd","paddingInlineStart"]],placeContent:[-1,["alignContent","justifyContent"]],placeItems:[-1,["alignItems","justifyItems"]],placeSelf:[-1,["alignSelf","justifySelf"]],scrollMargin:[-1,["scrollMarginBottom","scrollMarginLeft","scrollMarginRight","scrollMarginTop"]],scrollMarginBlock:[-1,["scrollMarginBlockEnd","scrollMarginBlockStart"]],scrollMarginInline:[-1,["scrollMarginInlineEnd","scrollMarginInlineStart"]],scrollPadding:[-1,["scrollPaddingBottom","scrollPaddingLeft","scrollPaddingRight","scrollPaddingTop"]],scrollPaddingBlock:[-1,["scrollPaddingBlockEnd","scrollPaddingBlockStart"]],scrollPaddingInline:[-1,["scrollPaddingInlineEnd","scrollPaddingInlineStart"]],scrollTimeline:[-1,["scrollTimelineAxis","scrollTimelineName"]],textDecoration:[-1,["textDecorationColor","textDecorationLine","textDecorationStyle","textDecorationThickness"]],textEmphasis:[-1,["textEmphasisColor","textEmphasisStyle"]],transition:[-1,["transitionBehavior","transitionDelay","transitionDuration","transitionProperty","transitionTimingFunction"]],viewTimeline:[-1,["viewTimelineAxis","viewTimelineName"]]};function ad(e,t){return 0===e.length?t:`${e} and ${t}`}function cd(e){return"@media"===e.substr(0,6)}function ld(e){return"@layer"===e.substr(0,6)}const ud=/^(:|\[|>|&)/;function dd(e){return ud.test(e)}function pd(e){return"@supports"===e.substr(0,9)}function hd(e){return"@container"===e.substring(0,10)}const fd={"us-w":"w","us-v":"i",nk:"l",si:"v",cu:"f",ve:"h",ti:"a"};function gd(e,t){if(t.media)return"m";if(t.layer||t.supports)return"t";if(t.container)return"c";if(e.length>0){const t=e[0].trim();if(58===t.charCodeAt(0))return fd[t.slice(4,8)]||fd[t.slice(3,5)]||"d"}return"d"}function md(e,t){return e?t+e:e}function vd(e){return md(e.container,"c")+md(e.media,"m")+md(e.layer,"l")+md(e.supports,"s")}function yd(e,t,n){const r=bl(e+vd(n)+t),o=r.charCodeAt(0);return o>=48&&o<=57?String.fromCharCode(o+17)+r.slice(1):r}function bd({property:e,selector:t,salt:n,value:r},o){return zl+bl(n+t+vd(o)+e+r.trim())}function Sd(e){return e===Hl}function wd(e){return e.replace(/>\s+/g,">")}function Cd(...e){0}function Ed(e){return sd[e]}function kd(e){var t;return null!==(t=null==e?void 0:e[0])&&void 0!==t?t:0}function Pd(e,t,n,r){e[t]=r?[n,r]:n}function Td(e,t){return t.length>0?[e,Object.fromEntries(t)]:e}function Nd(e,t,n,r,o,i){var s;const a=[];0!==i&&a.push(["p",i]),"m"===t&&o&&a.push(["m",o]),null!==(s=e[t])&&void 0!==s||(e[t]=[]),n&&e[t].push(Td(n,a)),r&&e[t].push(Td(r,a))}function Ad(e,t="",n=[],r={container:"",layer:"",media:"",supports:""},o={},i={},s){for(const c in e){if($l.hasOwnProperty(c)){e[c],Cd();continue}const l=e[c];if(null!=l)if(Sd(l)){Pd(o,yd(wd(n.join("")),c,r),0,void 0)}else if("string"==typeof l||"number"==typeof l){const e=wd(n.join("")),a=Ed(c);if(a){const e=a[1],s=Object.fromEntries(e.map((e=>[e,Hl])));Ad(s,t,n,r,o,i)}const u=yd(e,c,r),d=bd({value:l.toString(),salt:t,selector:e,property:c},r),p=s&&{key:c,value:s}||Rl(c,l),h=p.key!==c||p.value!==l,f=h?bd({value:p.value.toString(),property:p.key,salt:t,selector:e},r):void 0,g=h?{rtlClassName:f,rtlProperty:p.key,rtlValue:p.value}:void 0,m=gd(n,r),[v,y]=nd(Object.assign({className:d,selectors:n,property:c,value:l},g),r);Pd(o,u,d,f),Nd(i,m,v,y,r.media,kd(a))}else if("animationName"===c){const e=Array.isArray(l)?l:[l],s=[],a=[];for(const t of e){const e=od(t),n=od(Dl(t)),o=zl+bl(e);let c;const l=id(o,e);let u=[];e===n?c=o:(c=zl+bl(n),u=id(c,n));for(let e=0;e<l.length;e++)Nd(i,"k",l[e],u[e],r.media,0);s.push(o),a.push(c)}Ad({animationName:s.join(", ")},t,n,r,o,i,a.join(", "))}else if(Array.isArray(l)){if(0===l.length){0;continue}const e=wd(n.join("")),s=Ed(c);if(s){const e=s[1],a=Object.fromEntries(e.map((e=>[e,Hl])));Ad(a,t,n,r,o,i)}const a=yd(e,c,r),u=bd({value:l.map((e=>(null!=e?e:"").toString())).join(";"),salt:t,selector:e,property:c},r),d=l.map((e=>Rl(c,e)));if(!!d.some((e=>e.key!==d[0].key))){0;continue}const p=d[0].key!==c||d.some(((e,t)=>e.value!==l[t])),h=p?bd({value:d.map((e=>{var t;return(null!==(t=null==e?void 0:e.value)&&void 0!==t?t:"").toString()})).join(";"),salt:t,property:d[0].key,selector:e},r):void 0,f=p?{rtlClassName:h,rtlProperty:d[0].key,rtlValue:d.map((e=>e.value))}:void 0,g=gd(n,r),[m,v]=nd(Object.assign({className:u,selectors:n,property:c,value:l},f),r);Pd(o,a,u,h),Nd(i,g,m,v,r.media,kd(s))}else if(null!=(a=l)&&"object"==typeof a&&!1===Array.isArray(a))if(dd(c))Ad(l,t,n.concat(Kl(c)),r,o,i);else if(cd(c)){const e=ad(r.media,c.slice(6).trim());Ad(l,t,n,Object.assign({},r,{media:e}),o,i)}else if(ld(c)){const e=(r.layer?`${r.layer}.`:"")+c.slice(6).trim();Ad(l,t,n,Object.assign({},r,{layer:e}),o,i)}else if(pd(c)){const e=ad(r.supports,c.slice(9).trim());Ad(l,t,n,Object.assign({},r,{supports:e}),o,i)}else if(hd(c)){const e=c.slice(10).trim();Ad(l,t,n,Object.assign({},r,{container:e}),o,i)}else Cd()}var a;return[o,i]}function Id(e){const t=e.length;if(t===ql)return e;for(let n=t;n<ql;n++)e+="0";return e}function Od(e,t,n=[]){return Bl+Id(bl(e+t))}function Ld(e,t){let n="",r="";for(const o in e){const i=e[o];if(0===i){r+=o+" ";continue}const s=Array.isArray(i),a="rtl"===t?(s?i[1]:i)+" ":(s?i[0]:i)+" ";n+=a,r+=a}return[n.slice(0,-1),r.slice(0,-1)]}function Dd(e,t){const n={};for(const r in e){const[o,i]=Ld(e[r],t);if(""===i){n[r]="";continue}const s=Od(i,t),a=s+(""===o?"":" "+o);_l[s]=[e[r],t],n[r]=a}return n}function Rd(e,t=yl){const n=t();let r=null,o=null,i=null,s=null;return function(t){const{dir:a,renderer:c}=t;null===r&&([r,o]=function(e,t=""){const n={},r={};for(const o in e){const i=e[o],[s,a]=Ad(i,t);n[o]=s,Object.keys(a).forEach((e=>{r[e]=(r[e]||[]).concat(a[e])}))}return[n,r]}(e,c.classNameHashSalt));const l="ltr"===a;return l?null===i&&(i=Dd(r,a)):null===s&&(s=Dd(r,a)),n(c,o),l?i:s}}const Fd=t.useInsertionEffect?t.useInsertionEffect:void 0,Md=()=>{const e={};return function(t,n){Fd&&"undefined"!=typeof window&&window.document&&window.document.createElement?Fd((()=>{t.insertCSSRules(n)}),[t,n]):void 0===e[t.id]&&(t.insertCSSRules(n),e[t.id]=!0)}};function xd(e,t,n,r){const o=[];if(r[Ul]=t,r[jl]=String(n),e)for(const t in r)e.setAttribute(t,r[t]);return{elementAttributes:r,insertRule:function(t){return(null==e?void 0:e.sheet)?e.sheet.insertRule(t,e.sheet.cssRules.length):o.push(t)},element:e,bucketName:t,cssRules:()=>(null==e?void 0:e.sheet)?Array.from(e.sheet.cssRules).map((e=>e.cssText)):o}}const _d=["r","d","l","v","w","f","i","h","a","s","k","t","m","c"].reduce(((e,t,n)=>(e[t]=n,e)),{});function Ud(e,t,n){return("m"===e?e+t:e)+n}function jd(e,t,n,r,o={}){var i,s;const a="m"===e,c=null!==(i=o.m)&&void 0!==i?i:"0",l=null!==(s=o.p)&&void 0!==s?s:0,u=Ud(e,c,l);if(!r.stylesheets[u]){const i=t&&t.createElement("style"),s=xd(i,e,l,Object.assign({},r.styleElementAttributes,a&&{media:c}));r.stylesheets[u]=s,t&&i&&t.head.insertBefore(i,function(e,t,n,r,o={}){var i,s;const a=_d[n],c=null!==(i=o.m)&&void 0!==i?i:"",l=null!==(s=o.p)&&void 0!==s?s:0;let u=e=>a-_d[e.getAttribute(Ul)],d=e.head.querySelectorAll(`[${Ul}]`);if("m"===n){const t=e.head.querySelectorAll(`[${Ul}="${n}"]`);t.length&&(d=t,u=e=>r.compareMediaQueries(c,e.media))}const p=e=>function(e,t,n){var r,o;const i=t+(null!==(r=n.m)&&void 0!==r?r:""),s=e.getAttribute(Ul)+(null!==(o=e.media)&&void 0!==o?o:"");return i===s}(e,n,o)?l-Number(e.getAttribute("data-priority")):u(e),h=d.length;let f=h-1;for(;f>=0;){const e=d.item(f);if(p(e)>0)return e.nextSibling;f--}if(h>0)return d.item(0);return t?t.nextSibling:null}(t,n,e,r,o))}return r.stylesheets[u]}function zd(e,t){try{e.insertRule(t)}catch(e){0}}let qd=0;const Bd=(e,t)=>e<t?-1:e>t?1:0;function $d(e=("undefined"==typeof document?void 0:document),t={}){const{classNameHashSalt:n,unstable_filterCSSRule:r,insertionPoint:o,styleElementAttributes:i,compareMediaQueries:s=Bd}=t,a={classNameHashSalt:n,insertionCache:{},stylesheets:{},styleElementAttributes:Object.freeze(i),compareMediaQueries:s,id:"d"+qd++,insertCSSRules(t){for(const i in t){const s=t[i];for(let t=0,c=s.length;t<c;t++){const[c,l]=(n=s[t],Array.isArray(n)?n:[n]),u=jd(i,e,o||null,a,l);a.insertionCache[c]||(a.insertionCache[c]=i,r?r(c)&&zd(u,c):zd(u,c))}}var n}};return a}const Hd=e.createContext($d());const Wd=e.createContext("ltr");const Gd=function(t){const n=Rd(t,Md);return function(){const t=e.useContext(Wd),r=e.useContext(Hd);return n({dir:t,renderer:r})}}({contentContainer:{height:"100%",width:"100%",display:"flex",flexDirection:"column",alignItems:"stretch"}});var Vd=s(9307);const Qd=t=>{Vd.log("HostedWorkspaceUI invoked");const{appWorkspaceManager:n,authService:r,dependencySynthesizerService:o,environment:i,locale:s,loadNavParams:a,m365ChatSettingsProvider:c,userEligibilityService:l}=t,u=Gd(),d=e.useRef(null),p=e.useRef(),h=e.useRef(),f=e.useRef(),g=e.useRef(!1),m=e.useCallback((async()=>{g.current||p.current&&d.current&&h.current&&(await hl(f.current,d.current,h.current),g.current=!0,rr.clearOnRenderSettings())}),[]),v=e.useCallback((async e=>{if(!e)return rr.clearOnRenderSettings(),void(g.current=!0);rr.forceRender?await m():n.setOnNavigationEvent(m)}),[n,m]),y=e.useCallback((e=>{n.getWorkspaceManager().onWorkspaceListChangedEvent(e)}),[n]),b=e.useCallback((async()=>{var e,t;if(d.current)try{const u=rr.isUILessLoad(),{loopComponent:g,fluidLogger:m,view:b}=await pl(n,r,o,i,s,a,!u,c,l,d.current);await v(u),p.current=g,h.current=m,f.current=b,n.setWorkspaceAndPageManager(g.WorkspaceAndPageManager),n.setWorkspaceNavigationHandler(g.WorkspaceNavigationHandler),await n.appLoadDataModels(),null===(e=p.current.WorkspaceAndPageManager)||void 0===e||e.on("workspaceListChanged",y),n.setWorkspaceNavigationHandler(g.WorkspaceNavigationHandler),null===(t=p.current.WorkspaceNavigationHandler)||void 0===t||t.on("navigation",(e=>{n.getWorkspaceManager().onComponentNavigationEvent(e)}))}catch(e){x.Instance.logError("LoadLoopWorkspaceComponent",e,{ErrorMethod:"HostedWorkspaceUI.renderLoopComponent"}),Vd.error("Error rendering loop component",e)}}),[n,r,o,i,s,a,c,l,v,y]),S=e.useCallback((async()=>{var e,t,n;null===(t=null===(e=p.current)||void 0===e?void 0:e.WorkspaceAndPageManager)||void 0===t||t.off("workspaceListChanged",y),o.unregisterProviders(),f.current&&(await f.current.dispose(),f.current=void 0),p.current&&(null===(n=p.current.Disposable)||void 0===n||n.dispose(),p.current=void 0),h.current&&(h.current.dispose(),h.current=void 0)}),[o,y]);return e.useEffect((()=>{d.current&&b()}),[b]),e.useEffect((()=>{OneNote.run((async e=>{OfficeCore.AuthenticationService.newObject(e).onIdentityChanged.add((async()=>{Vd.log("Identity changed, cleaning up loop component"),await S()}))}))}),[S]),e.createElement("div",{className:u.contentContainer,ref:d})};var Jd=s(9307);const Kd=()=>{const t=e.useRef(!1),n=e.useCallback((()=>{t.current||(Jd.log("Window focused before app init"),rr.forceRender=!0),t.current=!0}),[t]);window.addEventListener("focus",n);const[o,i]=(0,e.useState)(void 0),s=e.useCallback((async()=>{try{const e=new Ae,t=new fr,o=new Nr(e,t),s=new br(e),a=Fr(),c=rr.getLocale(r.enUs);await e.populateIdentity();const l=new nt(a,e,c);R("useUserAppEligibilities",!1)&&s.populateUserEligibilityInformation(),await o.appInitialize(),z.initialize().then((()=>{z.registerEvent((e=>(t,n)=>{Ie.log(`ApiBridge: NativeEvent: ${t}:`,n);try{if("appRequestDeleteNotebook"===t)e.appRequestDeleteNotebook(n);else if("addReferenceToNotebook"===t)e.appAddReferenceToNotebook(n);else if("identityChange"===t)e.appOnIdentityChange();else if("navigateToModuleHome"===t)e.appNavigateToHome();else if("navigateToCreateNotebook"===t)e.appNavigateToCreateNotebook(n);else if("navigateToNotebookHome"===t)e.appNavigateToNotebook(n);else if("navigateToNotebookPage"===t)e.appNavigateToPage(n);else if("renameNotebook"===t)e.renameNotebook(n);else if("toggleFavoriteNotebook"===t)e.toggleFavoriteNotebook(n);else if("tryNavigateToLink"===t)e.appNavigateToLink(n);else{if("tryNavigateToSearchResult"!==t)throw new Error("Unsupported native event");e.appNavigateToSearchResult(n)}}catch(e){Ie.error(`ApiBridge: Error executing event '${t}':`,e),x.Instance.logError("NativeEventHandlerError",e,{ErrorMethod:"GetNativeEventHandler",ErrorEvent:t})}})(o)),window.removeEventListener("focus",n)})).catch((e=>{x.Instance.logError("AppInitError",e,{ErrorMethod:"appInitialize",ErrorDetails:"Error initializing API bridge"}),Jd.error("Error initializing API bridge",e)}));let u={route:"notebooks"};const d=rr.getSetting(Zn.LaunchDocUrl,""),p=rr.getSetting(Zn.LaunchDocUrlRequiresRedeem,false),h=rr.getSetting(Zn.LaunchPodId,wr),f=rr.getSetting(Zn.LaunchSpoId,wr);h!==wr&&h!==Sr&&(u=""!==d&&"0"!==d?{route:"page",mfsPodId:h,docUrl:d,requiresRedeem:p}:{route:"notebook",mfsPodId:h,spoId:f!==wr&&f!==Sr?f:void 0});i({appWorkspaceManager:o,authService:e,dependencySynthesizerService:t,environment:a,locale:c,loadNavParams:u,m365ChatSettingsProvider:l,userEligibilityService:s})}catch(e){x.Instance.logError("AppInitError",e,{ErrorMethod:"appInitialize",ErrorDetails:"Error initializing app"}),Jd.error(e)}window.onbeforeunload=()=>{z.cleanup()}}),[n]);return e.useEffect((()=>{Office.onReady(s)}),[s]),o?e.createElement(Qd,{...o}):e.createElement(e.Fragment,null)};var Yd=s(9307);document.onkeydown=e=>{switch(e.key){case"F5":e.preventDefault();break;case"r":e.ctrlKey&&e.preventDefault()}};const Xd={Public:"https://appsforoffice.microsoft.com/lib/beta/hosted/onenote.js",Public1CDN:"https://appsforoffice.public.cdn.office.net/lib/beta/hosted/onenote.js",GCCM:"https://appsforoffice.gcc.cdn.office.net/appsforoffice/lib/beta/hosted/onenote.js",GCCH:"https://appsforoffice.gcch.cdn.office.net/appsforoffice/lib/beta/hosted/onenote.js",DoD:"https://appsforoffice.dod.cdn.office.net/appsforoffice/lib/beta/hosted/onenote.js",UsNat:"https://appsforoffice.1cdn.eaglex.ic.gov/appsforoffice/lib/beta/hosted/onenote.js",UsSec:"https://appsforoffice.1cdn.microsoft.scloud/appsforoffice/lib/beta/hosted/onenote.js",Gallatin:"https://appsforoffice.cdn.partner.office365.cn/appsforoffice/lib/beta/hosted/onenote.js",UNKNOWN:"https://appsforoffice.public.cdn.office.net/lib/beta/hosted/onenote.js",Delos:"https://appsforoffice.public.cdn.office.net/lib/beta/hosted/onenote.js",Bleu:"https://appsforoffice.public.cdn.office.net/lib/beta/hosted/onenote.js"};Yd.log("Initializing Copilot Notebook SDX");const Zd=document.getElementById("index-react-root");if(!Zd)throw new Error("Index root container not found");Yd.log("Building onenote.js loader script");const ep=document.createElement("script");ep.id="onenote-js-script",ep.onload=function(){Yd.log("onenote.js script loaded successfully - rendering app");(0,n.H)(Zd).render(e.createElement(Kd,null))};const tp=G();ep.src=Xd[tp],Yd.log("Loading onenote.js from:",ep.src);const np=document.getElementsByTagName("head");if(!np||0===np.length)throw new Error("Cannot load OneNote JS script: head element not found");np[0].appendChild(ep)})(),TypeScriptModule=a})();
//# sourceMappingURL=index.js.map