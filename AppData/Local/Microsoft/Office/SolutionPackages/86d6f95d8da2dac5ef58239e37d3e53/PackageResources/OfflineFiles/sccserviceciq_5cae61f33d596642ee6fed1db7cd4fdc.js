/*! For license information please see sccserviceciq.js.LICENSE.txt */
(self.webpackChunksdx_pptnarrativeview=self.webpackChunksdx_pptnarrativeview||[]).push([[1034],{47272:(e,t,n)=>{"use strict";n.r(t),n.d(t,{CiqAnchorElementId:()=>Qf,EditorServiceImplementation:()=>Vf,initCiq:()=>Zf,mapSuggestions:()=>Gf});var r={};n.r(r),n.d(r,{Rc:()=>Qp});var i=n(30206),o=n(39386),a=n(97719);const s=[{id:"818bcdbe-64ce-46e8-a3d7-75a1ea8365a8",name:"Frequentlyconfusedwords",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"4ee98de6-ea40-48db-ae36-ca82fc8473f7",name:"AcademicDegrees",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"5cb7fc16-cd78-449c-86d9-5d047be21ac4",name:"AdjectiveUsedinsteadofAdverb",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"8778ba37-ca99-4ab9-a964-55abd18f7eba",name:"AdverbinsteadofAdjective",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"f57c12d6-03e4-4f48-9b7b-f95802a6c669",name:"AgreementwithinNounPhrases",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"a127d2c9-2faf-491b-8d6a-e9b027fec098",name:"AnAnd Confusion",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"63e72d3d-62d7-4e73-8d66-c137d8841121",name:"Capitalization",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"79d4a5c7-11c0-4be1-8d3c-c322f9941323",name:"Capitalizationof March and May",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"822bb35e-0608-466e-a771-a315fcf95821",name:"CapitalizationofPersonalTitles",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"7b3c279b-14c8-4e5f-83da-1cc446ed7f6a",name:"CommaafterGreetings",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"9d62fd01-8804-4485-a5f0-257131e4f6aa",name:"CommabeforeQuotations",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"fd8f4ff7-fa09-492c-9c74-1a6b9f71e488",name:"CommaMissingafterIntroductoryPhrase",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"72e604b0-a185-413b-bd45-ad555288c746",name:"CommaSplice",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"e3994139-ff36-44da-ae72-500b70d9b80f",name:"CommawithConjunctiveAdverbs",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"e805847a-9050-45de-b767-f48ed68ad848",name:"CommawithConjunction",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"0c576af1-54af-4acb-8065-4616bb73820d",name:"CommasaroundDescriptiveClause",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"413425d5-5a64-4ea6-84df-aae06c596439",name:"CommonlyConfusedPhrases",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"aea1e72a-abf4-4cc8-8b7a-43d15be8fc55",name:"CommonlyConfusedWords",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"02c15397-df70-4f00-aa4d-7269e6d4e712",name:"ComparativeUse",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"25714ab1-190b-4ef3-8d3d-e45bfd591c45",name:"CorrelativeConjunctionMismatch",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"8cf6f68e-f693-4e6f-b253-5092cd19b9e2",name:"DateFormatting",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"03522a58-4044-4bab-b796-0630ae2ad00a",name:"EmbarrassingWords",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"84275a90-df79-4b9e-a208-9ec8b5e59622",name:"Hyphenation",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"708198dd-ecbf-44fb-a428-ff2bc10e4d17",name:"IncorrectAuxiliary",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"6c49e04e-c556-43f3-94dc-2fe5dc18d8e5",name:"IncorrectNegation",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"7d9778b3-89e4-4974-b38f-086d39b32c21",name:"IncorrectNumberEnding",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"ca649e0f-48de-4f54-b687-2bda07e40728",name:"IncorrectPronounCase",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"631a3185-4bb6-4d1a-b275-f16c7f5dcc3a",name:"IncorrectReflexivePronounUse",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"296f8f65-02fb-45a7-b4ab-5dc137edc563",name:"IncorrectUseof That",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:1,CritiqueTag:0},{id:"0941dabb-e993-4a10-8a92-70a95ca5389d",name:"IncorrectVerbForm",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"7c2ff4d7-41a9-4310-949b-863a0dfa4257",name:"IncorrectVerbFormafterAuxiliary",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"6dbfae4c-9818-4dec-a769-2595168927f2",name:"IndefiniteArticle",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"e006985e-33eb-42e1-9196-1333c4ecad9c",name:"IndirectQuestions",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"4b1218e3-a124-4d36-b993-eb9ad6e80ddd",name:"MisheardPhrases",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"2700d569-bd6f-4806-9bf1-49abd64d9fd3",name:"MissingComma",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"b3613809-76ab-4b7b-91e6-ee9b6b9b60b2",name:"ModalConfusion",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"875c19b3-5769-4e9b-8d32-9c9dd4d74c13",name:"MultipleModals",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"f1a2ad0b-0b26-4bb5-aede-e88c9fe47492",name:"PossessiveandPluralForms",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"3f2eda01-e8a5-4ed9-9494-6de566bc5333",name:"Punctuation",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"76e3d0aa-bb80-461e-89c3-9fa640190616",name:"QuestionMarkMissing",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"12d7f72e-e53e-4b27-b1ed-4ee115f54994",name:"RedundantColon",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"b956d579-6d99-4278-8b7d-e281ab8c576b",name:"RedundantCommabeforeComplementClause",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"2d08dbe8-c11b-4190-a428-9a2c0a37bd68",name:"RedundantCommabeforeObject",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"aa78ec66-2078-42bf-84f5-c241eb53a531",name:"RedundantCommafollowingSubject",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"1346c3e5-5bf2-4176-ad29-9e25d88da4c6",name:"RedundantQuestionMark",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"e8c121e0-1ecd-4e88-8694-2fb17acb519d",name:"RepeatedAuxiliary",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"39d0acfc-05aa-4d25-ae88-32ebcee3bbeb",name:"SemicolonUse",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"6d1d8c3d-62d5-45d1-b850-d8a98a24964b",name:"Spacing",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"d7746119-e7e5-4e97-9979-bcd2114f9fe9",name:"Subject-VerbAgreement",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"27783a58-c44f-4778-9856-36d9eab63693",name:"TooManyDeterminers",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"a7927082-e6bb-4061-a134-3051e5969222",name:"UnnecessaryHyphen",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"26bdc172-02a8-4f0a-8ec0-6049906f1f7c",name:"UseofPlainVerbForm",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"39e466f1-6ebd-4ada-a7db-e0cc74048f1e",name:"UseoftheWord Lack",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"a9ca4ef4-12a5-4ad2-b8d5-b1310cc0d2af",name:"UseofWillandWould",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"352579fc-6ae6-4eb1-8d3b-895ab239714e",name:"VerbUse",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"ff12bbbd-0795-409a-8ed0-c8d7b2793e3a",name:"WhoWhomConfusion",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"6a0e1c97-430e-4d83-889d-8c4fea315a83",name:"WordSplit",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"c4301606-9bc2-4389-bb1a-c08370627172",name:"AdverbPlacement",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"0da5de95-d496-4d23-8f93-693ef6592ae6",name:"DoubleNegation",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"3be567ea-4951-4e59-bdab-6b99c790f28d",name:"Jargon",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"ab60d6cb-98df-4b9d-9a69-f6c12d8099fe",name:"PassiveVoice",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"8aa31cca-af48-4d21-8fb5-a0f314fab6ce",name:"PassiveVoicewithUnknownActor",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"28c70cb7-e358-4b32-8756-725aa7af1d69",name:"SentenceStructure",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"7f6d979b-d0de-4367-aa9d-589b5134b7a6",name:"SimplerWording",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"79dd443b-0b94-45a1-90ad-02807565324d",name:"SplitInfinitives",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"007c6707-7280-4c94-b469-8caee77d8313",name:"UseofEuphemisms",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"e24fd819-cc17-4be9-afec-dd103055198e",name:"ConjunctionOveruse",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"71384165-a4b9-45a7-9a73-7d0830c8c426",name:"Nominalizations",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"cfc8ef49-66b1-4ea0-8930-43d2ccd842e0",name:"Wordiness",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"6bdf8d88-1ed5-4506-9b5f-a17e7f8c2a48",name:"WordsExpressingUncertainty",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"67718619-a6b1-43ec-af18-1c48bbc27acd",name:"ColloquialVerbPhrase",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"f4aa4a0a-f81a-41ac-b710-de4a60b99282",name:"Contractions",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"6d60d9da-9e38-4d1e-bfc5-05a04120eef9",name:"InformalLanguage",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"d124712e-74ac-43eb-9bb6-373b2398f448",name:"OpinionMarkers",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"aa4e5a53-9b76-49fe-8bf1-2f35fd0d091d",name:"Slang",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"c68edc3b-9340-4b68-9d18-268bb82e2d94",name:"SubjunctiveMood",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"932288af-0af4-43f8-94af-206e06e43fce",name:"AgeBias",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"dd116cd6-2adb-4be9-809f-7b8de7cace91",name:"EthnicSlurs",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"6cd66cca-c2c2-48cf-8353-9791327aaea1",name:"GenderBias",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"e77bbc2a-f896-4012-a711-6041ea1e8964",name:"Gender-SpecificLanguage",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"36869146-3cc3-40fd-ae3c-bb30f6988335",name:"RacialBias",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"cbac7e3d-9058-442c-9f24-78fe164069b4",name:"SexualOrientationBias",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"3f2e6b47-fc23-4f99-ad25-1758e7f179b6",name:"CommawithAdverbials",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"55aa25a5-e28a-4f22-8410-34a4df965e30",name:"OxfordComma",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"3fd9c226-3925-4855-ba1e-49eb9ee46d24",name:"UnnecessaryComma",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"5b75d94a-856d-461b-9bb4-879f4502b4c3",name:"PunctuationRequiredWithQuotes",IsBinaryCritiqueType:!1,CritiqueTypeValues:["don'tcheck","inside","outside"],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"a44ac718-8213-42ff-87a5-1e5d6592c352",name:"SpaceBetweenSentences",IsBinaryCritiqueType:!1,CritiqueTypeValues:["don'tcheck","onespace","twospaces"],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"487d4873-3793-45a7-b881-7f18cac3f16c",name:"AvoidFirstPersonReferences",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"ac135410-a38a-4398-a759-ac6e2e5f779c",name:"SuperfluousExpressions",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"2b188727-cb05-4a4b-86a2-b35073e34c0b",name:"UnsuitableExpressions",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"348f4088-d907-41dc-9007-3cecf9837b61",name:"VagueQuantifiers",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"d07b8e0e-37e7-476e-99e6-477fd9f1b394",name:"VagueVerbs",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"923cc720-1624-4973-946a-30a0c6ec4163",name:"Clichés",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"3ae3b3e9-6e99-4113-9962-b52b7fe539f3",name:"Region-SpecificWords",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"9725ea09-959d-48b9-9678-1844896547b3",name:"VagueAdjectives",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"64213f24-0943-4585-8dd4-ee4f26b47a37",name:"VagueorUnnecessaryAdverbs",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"2e33dc1f-0106-4182-b52a-ad94e479fb9a",name:"WeakVerbs",defaultCritiqueValue:0}];n(69207);var l=n(63837);const d=(0,l.f)("ITerminalNodeBuilder");var u=n(98045),c=n(12323),g=n(65893),h=n(62070),p=n(85230),f=n(58964),v=n(79421),m=n(52996),y=n(49520),_=n(23132),b=n(55025),C=n(14262),S=n(90077),T=n(98872),I=n(87835),w=n(38663),E=n(7971),x=n(44957),A=n(94453);const D=(0,l.f)("ICritiqueValueStore");var k=n(47255),F=n(43900),P=n(47436),N=n(97397),B=n(6908),O=n(46079),R=n(49086),L=n(82256),M=n(41260),q=n(68081),W=n(16488),U=n(79548),z=n(48640),j=n(52669),H=n(94563),V=n(23627),G=n(46600),Q=n(24941),K=n(93398),$=n(75943);class Z{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){$.h.assign(Z,this,e)}static getTypeName(){return"AugLoop_Text_RangeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return $.h.matchesTypesFor(e,[Z.getTypeName()])}}Z.H_={T_:Z.getTypeName(),B_:Z.getBaseTypes()};class J{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){$.h.assign(J,this,e)}static getTypeName(){return"AugLoop_Text_MultiTileRangeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return $.h.matchesTypesFor(e,[J.getTypeName()])}}J.H_={T_:J.getTypeName(),B_:J.getBaseTypes()};class X{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){$.h.assign(X,this,e)}static getTypeName(){return"AugLoop_Text_LanguageDetectionSummaryAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return $.h.matchesTypesFor(e,[X.getTypeName()])}}X.H_={T_:X.getTypeName(),B_:X.getBaseTypes()};class Y{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){$.h.assign(Y,this,e)}static getTypeName(){return"AugLoop_Text_LanguageCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return $.h.matchesTypesFor(e,[Y.getTypeName()])}}Y.H_={T_:Y.getTypeName(),B_:Y.getBaseTypes()};class ee{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){$.h.assign(ee,this,e)}static getTypeName(){return"AugLoop_Text_LanguageCountAnnotationLocalized"}static getBaseTypes(){return["AugLoop_Text_LanguageCountAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return $.h.matchesTypesFor(e,[ee.getTypeName()])}}ee.H_={T_:ee.getTypeName(),B_:ee.getBaseTypes()};class te{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){$.h.assign(te,this,e)}static getTypeName(){return"AugLoop_Text_Definition"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return $.h.matchesTypesFor(e,[te.getTypeName()])}}te.H_={T_:te.getTypeName(),B_:te.getBaseTypes()};class ne{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){$.h.assign(ne,this,e)}static getTypeName(){return"AugLoop_Text_SuggestionsAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return $.h.matchesTypesFor(e,[ne.getTypeName()])}}ne.H_={T_:ne.getTypeName(),B_:ne.getBaseTypes()};class re{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){$.h.assign(re,this,e)}static getTypeName(){return"AugLoop_Text_Critique"}static getBaseTypes(){return["AugLoop_Text_SuggestionsAnnotation","AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return $.h.matchesTypesFor(e,[re.getTypeName()])}}re.H_={T_:re.getTypeName(),B_:re.getBaseTypes()};class ie{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){$.h.assign(ie,this,e)}static getTypeName(){return"AugLoop_Text_NeuralRewriteCritique"}static getBaseTypes(){return["AugLoop_Text_Critique","AugLoop_Text_SuggestionsAnnotation","AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return $.h.matchesTypesFor(e,[ie.getTypeName()])}}ie.H_={T_:ie.getTypeName(),B_:ie.getBaseTypes()};class oe{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){$.h.assign(oe,this,e)}static getTypeName(){return"AugLoop_Text_CritiqueCategoryCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return $.h.matchesTypesFor(e,[oe.getTypeName()])}}oe.H_={T_:oe.getTypeName(),B_:oe.getBaseTypes()};class ae{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){$.h.assign(ae,this,e)}static getTypeName(){return"AugLoop_Text_UniqueWordsCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return $.h.matchesTypesFor(e,[ae.getTypeName()])}}ae.H_={T_:ae.getTypeName(),B_:ae.getBaseTypes()};class se{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){$.h.assign(se,this,e)}static getTypeName(){return"AugLoop_Text_EmptyDocumentAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return $.h.matchesTypesFor(e,[se.getTypeName()])}}se.H_={T_:se.getTypeName(),B_:se.getBaseTypes()};class le{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){$.h.assign(le,this,e)}static getTypeName(){return"AugLoop_Text_IdeasPersonalizationSettingsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return $.h.matchesTypesFor(e,[le.getTypeName()])}}le.H_={T_:le.getTypeName(),B_:le.getBaseTypes()};class de{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){$.h.assign(de,this,e)}static getTypeName(){return"AugLoop_Text_TextToSpeechAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return $.h.matchesTypesFor(e,[de.getTypeName()])}}de.H_={T_:de.getTypeName(),B_:de.getBaseTypes()};class ue{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){$.h.assign(ue,this,e)}static getTypeName(){return"AugLoop_Text_AutoreplaceAnnotation"}static getBaseTypes(){return["AugLoop_Text_Critique","AugLoop_Text_SuggestionsAnnotation","AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return $.h.matchesTypesFor(e,[ue.getTypeName()])}}ue.H_={T_:ue.getTypeName(),B_:ue.getBaseTypes()};class ce{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){$.h.assign(ce,this,e)}static getTypeName(){return"AugLoop_Text_TextStreamAnnotation"}static getBaseTypes(){return["AugLoop_Core_StreamAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return $.h.matchesTypesFor(e,[ce.getTypeName()])}}ce.H_={T_:ce.getTypeName(),B_:ce.getBaseTypes()};var ge=n(14193),he=n(32133),pe=n(75181);const fe=(0,l.f)("ILanguageDetectionSubscriber");var ve=n(68165),me=n(22525),ye=n(46546);const _e=(0,l.f)("IReactComponentInitializer");var be=n(13111),Ce=n(93948),Se=n(71115);const Te=(0,l.f)("IEditorClient");var Ie=n(88670),we=n(34241);const Ee=(0,l.f)("ReactComponentModules");var xe=n(29594);class Ae{constructor(e,t,n,r=void 0,i,o,a=new Date){this.hostSettings=e,this.isEditorClientShutdown=!1,this.isInitialized=!1,this.isUXInitialized=!1,this._proofingDisabled=!1,this.onWindowUnloaded=()=>{this.shutDown()},this.rootInjector=((e,t,n,r,i,o,a)=>{const s=new be.J(t.generateModuleKey),l=s.container;l.bind(Se.p).toValue(l),l.bind(Se.k).toValue(l.resolveNew),l.bind(be.J).toValue(s),l.bind(Te).toValue(e),l.bind(Ie.n).toValue(t),l.bind(Ee).toValue(o),n&&l.bind(Ce.P).toValue(n),null==a||a(l),"configureRootServices"in r?s.addModule(r):l.bind(we.qy).toValue(r);for(const e of i)s.addModule(e);return s})(this,e,r,i,t,n,o),this.diContainer=this.rootInjector.container,this.roamingDictionaryFeatureObj=this.diContainer.get(O.Zp),this.externalSettingsFeatureObj=this.diContainer.get(R.In),this.userInfoUpdater=this.diContainer.get(L.M),this.hostEmitter=this.diContainer.get(M.M5),this.logger=this.diContainer.get(m.g),this.proofingDom=this.diContainer.get(ge.w),this.proofingPersistedStore=this.diContainer.get(v.K),this.featureFlagReader=this.diContainer.get(q.c),e.enableOrchestration&&(this.orchestrator=this.diContainer.get(pe.J)),window.frameElement&&(this.windowEventListener=new W.J(window),this.windowEventListener.addListener("pagehide",this.onWindowUnloaded)),this._editorInitializationStartTime=a}registerTextTileEventListener(e){try{return this.hostEmitter.on(M.pD.hostModelTextTile,e),!0}catch(e){return this.logger.error(520983245,"Failed to register hostModelTextTile listener",e),!1}}registerDeltaEventListener(e){try{return this.hostEmitter.on(M.pD.hostModelDelta,e),!0}catch(e){return this.logger.error(520983244,"Failed to register hostModelDelta listener",e),!1}}registerTextTileEmittedToAugloopEventListener(e){try{return this.hostEmitter.on(M.pD.hostModelTextTileEmittedToAugloop,e),!0}catch(e){return this.logger.error(507257550,"Failed to register hostModelTextTileEmittedToAugloop listener",e),!1}}unregisterTextTileEventListener(e){try{return this.hostEmitter.off(M.pD.hostModelTextTile,e),!0}catch(e){return this.logger.error(520983243,"Unable to unregister hostModelTextTile listener - no listener registered",e),!1}}unregisterDeltaEventListener(e){try{return this.hostEmitter.off(M.pD.hostModelDelta,e),!0}catch(e){return this.logger.error(520983242,"Unable to unregister hostModelDelta listener - no listener registered",e),!1}}unregisterTextTileEmittedToAugloopEventListener(e){try{return this.hostEmitter.off(M.pD.hostModelTextTileEmittedToAugloop,e),!0}catch(e){return this.logger.error(507257549,"Unable to unregister hostModelTextTileEmittedToAugloop listener - no listener registered",e),!1}}async setLocale(e){let t="string"==typeof e?[e]:e;0===t.length&&(t=[this.hostSettings.defaultLocale]);const n=await this.proofingPersistedStore.read(f.l.ProofingLanguages),r=t.toString()!==n.toString();await this.proofingPersistedStore.write(f.l.ProofingLanguages,t);const i=this.diContainer.getOptional(U.o);return null==i||i.emit("proofingLanguageChanged",{data:new z.I(t),messageType:h.G.ChangeData,proofingLanguagesChanged:r}),!!i}async setMultiLingualProofingLocales(e){await this.setLocale(e)}async enableSpelling(){await this._enableDisableSpelling(!0)}async disableSpelling(){await this._enableDisableSpelling(!1)}async enableGrammar(){await this._enableDisableGrammar(!0)}async enableRefinements(){await this._enableDisableRefinements(!0)}async setOverriddenCritiqueTypeOptions(e){await this.proofingPersistedStore.write(f.l.OverriddenCritiqueTypeOptions,e),this.diContainer.get(T.D).setOverriddenCritiqueTypes(e),this._emitEnabledCritiqueTypesChanged()}async disableGrammar(){await this._enableDisableGrammar(!1)}async disableRefinements(){await this._enableDisableRefinements(!1)}async isSpellingEnabled(){return this.proofingPersistedStore.read(f.l.EnableSpelling)}async isGrammarEnabled(){return this.proofingPersistedStore.read(f.l.EnableGrammar)}async areRefinementsEnabled(){return this.proofingPersistedStore.read(f.l.EnableRefinements)}async _enableDisableSpelling(e){await this.proofingPersistedStore.read(f.l.EnableSpelling)!==e&&(await this.proofingPersistedStore.write(f.l.EnableSpelling,e),this._emitEnabledCritiqueTypesChanged())}async _enableDisableGrammar(e){await this.proofingPersistedStore.read(f.l.EnableGrammar)!==e&&(await this.proofingPersistedStore.write(f.l.EnableGrammar,e),this._emitEnabledCritiqueTypesChanged())}async _enableDisableRefinements(e){await this.proofingPersistedStore.read(f.l.EnableRefinements)!==e&&(await this.proofingPersistedStore.write(f.l.EnableRefinements,e),this._emitEnabledCritiqueTypesChanged())}_refreshTileNodes(){this.diContainer.get(S.G).pollNodes(h.G.ChangeData,this.proofingDom.tileNodes,p.Q0.Code,void 0,!0)}clearResources(){const e=this.diContainer.getOptional(he.s);null==e||e.clearIgnoredWords()}shutDown(){var e,t,n,r;if(!this.isEditorClientShutdown)try{this.isEditorClientShutdown=!0,null===(e=this.diContainer.getOptional(me.H))||void 0===e||e.logTelemetry(),this.diContainer.unbind(j.jh),this.diContainer.unbind(j.sh),this.diContainer.unbind(j.q4),this.diContainer.unbind(j.Ze),this.diContainer.unbind(j.cg),this.diContainer.unbind(j.oA),this.clearResources(),this.diContainer.get(_e).shutDown(),null===(t=this.windowEventListener)||void 0===t||t.removeAllListeners(),this.windowEventListener=void 0,null===(n=this.orchestrator)||void 0===n||n.shutDown(),this.diContainer.get(H.V).shutDown(),this.diContainer.get(be.J).clear()}catch(e){this.logger.error(520983241,"error while shutting down the editor client.",e),null===(r=this.onError)||void 0===r||r.call(this,"Error while shutting down the editor client.",e)}}logout(){this.hostEmitter.emit(M.pD.logout,{address:void 0,message:void 0})}get roamingDictionaryFeature(){return this.roamingDictionaryFeatureObj}get externalSettingsFeature(){return this.externalSettingsFeatureObj}updateUserInfo(e){this.userInfoUpdater.update(e)}async initialize(e){this.isEditorClientShutdown||(await this.initializeSDK(),await this.initializeUX(e))}async initializeSDK(){var e;if(this.isEditorClientShutdown)return;if(this.isInitialized)return;this.isInitialized=!0,(0,ye.configure)({enforceActions:"observed"});const t=(0,xe.$)();if(await(null==t?void 0:t.loadLocale(this.hostSettings.defaultLocale)),await(null===(e=this.orchestrator)||void 0===e?void 0:e.initialize()),!this.isEditorClientShutdown){await this.diContainer.get(V.H).initializeComponent();try{await this.diContainer.get(G.e).executeAsync(!0)}catch(e){}}}async initializeUX(e){var t,n,r;if(!this.isEditorClientShutdown&&!this.isUXInitialized){this.isUXInitialized=!0;try{this.diContainer.bind(j.jh).toValue(new Q.O(null!=e?e:document)),this.diContainer.bind(j.sh).toValue(new Q.O(null!==(t=(null!=e?e:document).defaultView)&&void 0!==t?t:window)),await this.diContainer.get(_e).initializeComponent()}catch(e){this.logger.error(509634378,"Failed to initialize ux",e),null===(n=this.onError)||void 0===n||n.call(this,"Failed to initialize ux.",e)}null===(r=this.diContainer.getOptional(ve.$))||void 0===r||r.schedule(1e3,3e5),await this.initLocale(this.hostSettings.defaultLocale),this.languageDetectionSubscriber=this.diContainer.getOptional(fe),this.logEditorInitializationComplete()}}logEditorInitializationComplete(){const e=new Date,t=(0,K.W)(["initializationEndTime",e.toISOString()],["initializationStartTime",this._editorInitializationStartTime.toISOString()],["initializationTime",e.getTime()-this._editorInitializationStartTime.getTime()],["isCIQEnabled",(this.hostSettings.flightsToTrack||[]).includes("mc-editor-oa")]);if(this.featureFlagReader.flags.enableLoggingModulesAndBindings){const e=this.diContainer.getBindings().map((e=>{const t="function"!=typeof e.token?e.token.toString():e.token.name,n=e.boundServices.map((e=>{var t;return null===(t=e.cache)||void 0===t?void 0:t.constructor.name}));return`${t}: [${n}]`})).toString();t.push(...(0,K.W)(["addedModuleClassNamesSize",this.rootInjector.addedModuleClassNames.size],["addedModuleClassNames",[...this.rootInjector.addedModuleClassNames].join(", ")],["modulesSharingSameModuleKeyButDifferentClassname",[...this.rootInjector.modulesSharingSameModuleKeyButDifferentClassname].join(", ")],["bindings",e]))}this.logger.logActivity("EditorInitializationComplete",void 0,t)}async initLocale(e){await this.setLocale(e)}setAvailableCritiqueTypes(e,t){const n=this.diContainer.getOptional(T.D);n&&(n.setAvailableCritiqueTypes(e,t),this._emitEnabledCritiqueTypesChanged())}async setPaneOnlyOverriddenCritiqueTypeOptions(e){const t=this.diContainer.getOptional(I.M);t&&(await this.proofingPersistedStore.write(f.l.PaneOverriddenCritiqueTypeOptions,e),t.setOverriddenCritiqueTypes(e),this._emitEnabledCritiqueTypesChanged())}setAvailablePaneOnlyCritiqueTypes(e){const t=this.diContainer.getOptional(I.M);t&&(t.setAvailableCritiqueTypes(e),this._emitEnabledCritiqueTypesChanged())}_emitEnabledCritiqueTypesChanged(){this.diContainer.get(U.o).emit("enabledCritiqueTypesChanged",{messageType:h.G.ChangeData})}async disableProofing(){var e;if(this._proofingDisabled)return!0;if(!this.orchestrator)return!1;const t=await this.orchestrator.deactivateAnnotations([re.getTypeName()]);for(const t of this.proofingDom.tileNodes)this.hostEmitter.emit(M.pD.clearCritiquesForNode,{message:{nodeId:t.id,seqId:(null!==(e=t.eventSeqId)&&void 0!==e?e:0).toString()},address:void 0});return this._proofingDisabled=!0,t}async enableProofing(){var e,t;if(this._proofingDisabled&&(null===(e=this.orchestrator)||void 0===e?void 0:e.activateAnnotations([re.getTypeName()]))){for(const e of this.proofingDom.tileNodes)this.hostEmitter.emit(M.pD.restoreNodeForCritiqueStore,{message:{nodeId:e.id,seqId:(null!==(t=e.eventSeqId)&&void 0!==t?t:0).toString()},address:void 0});this._refreshTileNodes(),this._emitEnabledCritiqueTypesChanged(),this._proofingDisabled=!1}}addWordsToIgnoreList(e){const t=this.diContainer.getOptional(he.s);null==t||t.addWordsToIgnoreList(e)}setLanguageDetectedCallback(e){var t;null===(t=this.languageDetectionSubscriber)||void 0===t||t.setLanguageDetectedOnSignalCallback(e)}}var De=n(83240),ke=n(28363);class Fe extends Ae{constructor(e,t,n,r=void 0,i,o,a=new Date){super(e,t,n,r,i,o,a),this.critiqueSuggestionClearanceCallbacks=[],this.updateDarkMode=e=>{var t;null===(t=this.themeStore)||void 0===t||t.updateDarkMode(e)},this.getComponentsSupportedForTheming=()=>{var e,t;return null!==(t=null===(e=this.themeStore)||void 0===e?void 0:e.components)&&void 0!==t?t:[]},this.updateDefaultTheme=e=>{var t;null===(t=this.themeStore)||void 0===t||t.updateDefaultTheme(e)},this.updateCurrentTheme=e=>{var t;null===(t=this.themeStore)||void 0===t||t.updateCurrentTheme(e)},this.getComponentsSupportedForStyling=()=>{var e,t;return null!==(t=null===(e=this.styleStore)||void 0===e?void 0:e.components)&&void 0!==t?t:[]},this.isPremiumUser=this.diContainer.get(g.r),this.themeStore=this.diContainer.getOptional(N.YQ),this.styleStore=this.diContainer.getOptional(N.UC),this.themeStore&&N.Cx.forEach(((e,t)=>{var n;null===(n=this.themeStore)||void 0===n||n.updateComponentThemes(t,e)})),this.styleStore&&N.w.forEach(((e,t)=>{var n;null===(n=this.styleStore)||void 0===n||n.updateComponentStyle(t,e)}))}async initLocale(e){var t,n;const r=null!==(n=this.hostSettings.isMultilingualProofingEnabled&&(null===(t=this.hostSettings.proofingLocales)||void 0===t?void 0:t.length)?this.hostSettings.proofingLocales:void 0)&&void 0!==n?n:[e];await this.setLocale(r),await this.setUiLocale(e)}async setLocale(e){const t="string"==typeof e?[e]:e;return super.setLocale(t)}async setUiLocale(e){var t;const n=(0,xe.$)().loadLocale(e);await n;const r=this.diContainer.getOptional(De.C);if(r)try{await r.setUiLocale(e)}catch(n){this.logger.error(507885057,"Failed to initialize categories locale for: "+e,n),null===(t=this.onError)||void 0===t||t.call(this,"Failed to initialize categories locale for: "+e,n)}}setLocaleForTile(e,t){const n=this.proofingDom.findTileNode(e);return!!n&&(n.specifiedLocale=t,n.resetState(),this.diContainer.get(b.$).resetNode(n.id),this.diContainer.get(S.G).pollNodes(h.G.NewData,[n],p.Q0.Code,void 0,!0),!0)}registerCustomIconSet(e){for(const t of Object.keys(e))(0,B.Z)(t,e[t])}async setBothOverrideAndPaneOnlyOverriddenCritiqueTypeOptions(e,t){await this.proofingPersistedStore.write(f.l.OverriddenCritiqueTypeOptions,e),this.diContainer.get(T.D).setOverriddenCritiqueTypes(e);const n=this.diContainer.getOptional(I.M);n&&(await this.diContainer.get(v.K).write(f.l.PaneOverriddenCritiqueTypeOptions,t),n.setOverriddenCritiqueTypes(t)),this._emitEnabledCritiqueTypesChanged(),this._refreshTileNodes()}enablePremiumUntil(e){this.isPremiumUser.setGracePeriodUntil(e)}setPremiumCritiqueTypes(e){this.diContainer.get(w.g).setPremiumCritiqueTypes(e),this._emitEnabledCritiqueTypesChanged()}setPreviewCritiquesCount(e,t){const n=this.diContainer.get(E.Ey);n.setPreviewModeActive(!0),n.setPreviewCount(e,!0),n.setPreviewUnit(t)}setPremiumPreviewActive(e){this.diContainer.get(E.Ey).setPreviewModeActive(e)}setLightUpPremiumSquiggles(e){this.diContainer.get(E.Ey).setLightUpPremiumSquiggles(e)}onPremiumCountChange(e){this.diContainer.get(E.Ey).setOnPremiumCountChange(e)}onPreviewCritiquesCountChange(e){this.diContainer.get(E.Ey).setOnPreviewCritiquesCountChange(e)}onDisableCritique(e){this.diContainer.get(x.W).setOnDisableCritique(e)}onFeedbackIconClicked(e){this.diContainer.get(A.M).setOnFeedbackIconClicked(e)}async setLanguageValueFromConfigResponses(e,t,n){const r=this.diContainer.get(D);await r.setLanguageValueFromConfigResponses(e,t,n)}onApplyCritiqueSuggestion(e,t){const n=this.diContainer.get(C.a).handleApplyCritiqueSuggestion(e,t);this.critiqueSuggestionClearanceCallbacks.push(n)}exp_getActivityLogger(){return this.diContainer.get(m.g)}exp_getOaLogger(){return this.diContainer.get(y.m)}exp_getQueryDetection(){return this.diContainer.get(_.J)}onTryPremiumPreview(e){this.diContainer.get(E.Ey).setOnTryPremiumPreview(e)}onPremiumPreviewExpired(e){this.diContainer.get(E.Ey).setOnPremiumPreviewExpired(e)}getComponentThemes(e){var t;return null===(t=this.themeStore)||void 0===t?void 0:t.getComponentThemes(e)}getDefaultTheme(){var e;return null===(e=this.themeStore)||void 0===e?void 0:e.defaultTheme}getCurrentTheme(){var e;return null===(e=this.themeStore)||void 0===e?void 0:e.currentTheme}updateComponentThemes(e,t){var n;null===(n=this.themeStore)||void 0===n||n.updateComponentThemes(e,t)}getComponentStyle(e){var t;return null===(t=this.styleStore)||void 0===t?void 0:t.getComponentStyle(e)}updateComponentStyle(e,t){var n;null===(n=this.styleStore)||void 0===n||n.updateComponentStyle(e,t)}updateFluentThemes(e){var t;null===(t=this.themeStore)||void 0===t||t.updateFluentThemes(e)}setOnCritiqueAdded(e){this.diContainer.get(k.y).setOnCritiqueAdded(e)}enableInlineSuggestionsMenu(e,t,n,r,i,o,a,s,l,d,u,c,g,h,p,f,v,m,y,_,b,C,S,T){if(!t)throw Error("You must specify a query character.");this.enableMenu(Object.assign({queryChar:t,onItemSelected:n,styles:a,onOpen:s,onClose:l,onAction:d,shouldRemoveTextOnItemSelection:u,specifiedItemsToDisplay:r,onSuggestionsUpdated:c,onRestoreFocus:g,onPreventDismissCalloutOnEvent:h,onGroupSelected:p,brandingMode:f,getLocalItems:m,isDividerShown:y,noSuggestionsHeaderInfo:_,newEntityTypes:b,newItemsById:S},C?{enableExpandedECC:!0,enableExpandedMenuSearchBar:T,supportedEntityTypes:null!=e?e:[]}:{enableExpandedECC:!1,supportedEntityTypes:e,enableScopedHeader:v}))}enableMenu(e){var t;(null===(t=this.hostSettings.oaSettings)||void 0===t?void 0:t.isContextualCardEnabled)&&(this.diContainer.get(ke.V).enableMenu(e),this.logger.logActivity("ECCMenuEnabled"))}disableInlineSuggestionsMenu(e){var t;(null===(t=this.hostSettings.oaSettings)||void 0===t?void 0:t.isContextualCardEnabled)&&this.diContainer.get(ke.V).disableInlineSuggestionsMenu(e)}showInlineSuggestionsMenuWithItems(e,t,n,r,i,o,a,s){var l;return(null===(l=this.hostSettings.oaSettings)||void 0===l?void 0:l.isContextualCardEnabled)?this.diContainer.get(ke.V).renderMenuWithItems(e,t,n,r,i,o,a,s):Promise.resolve(!1)}async showExistingMenu(e,t,n,r,i,o,a,s,l,d){var u;if(null===(u=this.hostSettings.oaSettings)||void 0===u?void 0:u.isContextualCardEnabled){const u=this.diContainer.get(ke.V);await u.showExistingMenu(e,t,n,r,i,o,a,s,l,d)}}async showExistingMenuAtCursor(e,t,n){var r;if(!(null===(r=this.hostSettings.oaSettings)||void 0===r?void 0:r.isContextualCardEnabled))return;const i=this.diContainer.get(F.d),o=await i.getTextSelection();(null==o?void 0:o.endParagraphNode)&&void 0!==o.endPositionInParagraphNode&&await this.showExistingMenu(o.endParagraphNode.id,o.endPositionInParagraphNode-e,e,t,!1,n)}async insertAndDisplayInlineSuggestionsMenu(e,t,n){var r;if(!e)return!1;if(null===(r=this.hostSettings.oaSettings)||void 0===r?void 0:r.isContextualCardEnabled){const r=this.diContainer.get(F.d);let i,o;if(t&&n){const e=this.proofingDom.findParagraphNode(t);if(!(0,P.l)(e))return!1;i=e.parent,o=await r.getNodeInsertionPosition(i,e.element.offset+n,!0)}else{const e=await r.getTextSelection();if(!e||e.startParentElement.id!==e.endParentElement.id)return!1;i=e.startParentElement,o=e.startPosition===e.endPosition?await r.getNodeInsertionPosition(i,e.startPosition,!0):await r.getRangeOfNode(i,void 0,e.startPosition,e.endPosition-e.startPosition)}return!!o&&(await r.insert(i,void 0,0,e,!0,o,!0),!0)}return!1}shutDown(){try{super.shutDown();for(const e of this.critiqueSuggestionClearanceCallbacks)e();this.critiqueSuggestionClearanceCallbacks=[]}catch(e){this.logger.error(509690076,"error while shutting down the editor client.",e)}}notifyMenuTriggeringMethod(e){this.diContainer.get(ke.V).notifyMenuTriggeringMethod(e)}}var Pe=n(92037),Ne=n(90935),Be=n(86388),Oe=n(20399),Re=n(59834),Le=n(48828),Me=n(90424);let qe=class{constructor(e,t){this.logger=e,this.proofingEmitter=t,this.loggerEventName="AggregateEventCount",this.dataToLog={eventCountMap:{},metadata:{locales:[]}}}async initialize(){this.proofingEmitter.on("proofingLanguageChanged",(e=>{this.updateMetadata({locales:e.data.codesList.slice()})}))}incrementEventCount(e,t,n=1){var r,i,o;const a=null!==(r=(o=this.dataToLog.eventCountMap)[e])&&void 0!==r?r:o[e]={};null!==(i=a[t])&&void 0!==i||(a[t]=0),a[t]+=n}shutDown(){this.logger.logEvent(512304030,this.loggerEventName,Oe.q.Info,void 0,Re.o.SamplingPolicy.Measure,this.dataToLog,void 0)}updateMetadata(e){this.dataToLog.metadata=Object.assign(Object.assign({},this.dataToLog.metadata),e)}};qe=(0,i.__decorate)([(0,Le._)(),(0,i.__param)(0,(0,Me.W)(m.g)),(0,i.__param)(1,(0,Me.W)(U.o))],qe);var We=n(84002),Ue=n(77148),ze=n(33878),je=n(24839),He=n(2320),Ve=n(73675),Ge=n(34681);let Qe=class{getUILanguage(){return navigator.language}async getBrowserLanguages(){return Promise.resolve([navigator.language])}};Qe=(0,i.__decorate)([(0,Le._)()],Qe);let Ke=class{getUrl(e){return e}};Ke=(0,i.__decorate)([(0,Le._)()],Ke);var $e=n(18951),Ze=n(46544),Je=n(6526);class Xe{constructor(){this.imports=[$e.u]}get uniqueId(){return(0,Je.z)(507918421)}configureRootServices(e){e.bind(ze.n).to(Ke),e.bind(Ve.v).to(Qe),e.bind(je.j).to(je.c),e.bind(Ue.S).toExisting(je.j),e.bind(j.oA).toDynamicValue((e=>()=>e.getOptional(j.q4))),e.bind(j.Ze).toDynamicValue((e=>()=>e.getOptional(j.jh))),e.bind(j.cg).toDynamicValue((e=>()=>e.getOptional(j.sh))),e.bind(We.m).to(We.r),e.bind(Ge.H).toSelf(),e.bind(Ze.W).toSelf(),e.bind(He.DS).to(He.KW)}}var Ye=n(37989);class et{constructor(){this.imports=[Xe]}get uniqueId(){return(0,Je.z)(507918427)}configureRootServices(e){e.bind(Ue.S).toExisting(Ye.v),e.bind(Ye.v).to(qe)}}const tt=(0,l.f)("IChildElementFinderFactory"),nt=(0,l.f)("IGrammarTerminalSymbol"),rt=(0,l.f)("IGrammarNonTerminalSymbolExpanded"),it=((0,l.f)("IGrammarRules"),(0,l.f)("IGraphNodeFactory")),ot=(0,l.f)("IParagraphNodeFactory");var at=n(48717),st=n(79928);const lt=(0,l.f)("INodeObserverFactory"),dt=(0,l.f)("IMutationObserverFactory");var ut=n(98937);const ct=(0,l.f)("IParagraphNodesBuilderFactory"),gt=(0,l.f)("IParagraphNodesBuilder");var ht,pt=n(32323),ft=n(98418),vt=n(72040),mt=n(48416);!function(e){e.DefaultOutlineNodeObserver="DefaultOutlineNodeObserver",e.TerminalNodeObserver="TerminalNodeObserver",e.InputNodeObserver="InputNodeObserver",e.AttributeObserver="AttributeObserver"}(ht||(ht={}));var yt=n(15863);class _t{constructor(e,t,n,r,i,o){this._observer=t,this.nodeType=e,this.id=null!=o?o:(0,yt.h)(),this._children=n,this.element=r,this.parent=i}get children(){return this._children}set children(e){this._children=e}retire(){if(this._observer.disconnect(this.element),this.children)for(const e of this.children)e.retire();this.children=void 0}move(e,t){return this._observer.disconnect(this.element),this.id=(0,yt.h)(),e&&(this.element=e),t&&(this.parent=t),this}resetState(){}}let bt=class extends _t{constructor(e,t,n,r,i,o,a,s,l,d){super(n,r,void 0,i,o,a),this._proofingDom=e,this._tileContent=t,this.nodeType=n,this._observer=r,this.element=i,this.parent=o,this._logger=s,this._nodeTraverser=l,this._hostSettings=d,this._children=[],this.id=(0,yt.h)(),this._proofingDom.registerNode(this)}get children(){var e,t;return(null===(e=this._hostSettings)||void 0===e?void 0:e.sdkV2Enabled)?null!==(t=this._proofingDom.getTileNodeV2Paragraphs(this))&&void 0!==t?t:[]:this._children}set children(e){this._children=e}retire(){var e;this.parent=void 0,null===(e=this._logger)||void 0===e||e.debug(0,"Retire node",this.id),this._proofingDom.unregisterNode(this),super.retire()}move(e,t){return this._proofingDom.unregisterNode(this),super.move(e,t),this._proofingDom.registerNode(this),this}resetState(e){}pullText(){var e;return null!==(e=this._tileContent.getText(this))&&void 0!==e?e:{content:""}}reconcile(e,t,n,r,i,o){}get plainText(){return this.pullText().content}getPreviousTileId(){var e;const t=null===(e=this._nodeTraverser)||void 0===e?void 0:e.findPreviousTileNode(this);return"#head#"===t?t:null==t?void 0:t.id}getNextTileId(){var e;const t=null===(e=this._nodeTraverser)||void 0===e?void 0:e.findNextTileNode(this);return"#tail#"===t?t:null==t?void 0:t.id}};bt=(0,i.__decorate)([(0,Le._)()],bt);let Ct=class extends _t{constructor(e,t,n,r){super(mt.Z.TerminalNode,e,void 0,t,n,r),this._observer=e,this.retiredCallbacks=[],this.visualizationRemovedCallbacks=[],this.element&&this._observer.observe(this.element)}retire(){for(const e of this.retiredCallbacks)e();this.retiredCallbacks=[],this.visualizationWasRemoved(),super.retire()}move(e,t){if(super.move(e,t),this.children)for(const t of this.children)t.move(e);return this.element&&this._observer.observe(this.element),this}resetState(){}registerRetireCallback(e){this.retiredCallbacks.push(e)}registerVisualizationRemovedCallback(e){this.visualizationRemovedCallbacks.push(e)}visualizationWasRemoved(){for(const e of this.visualizationRemovedCallbacks)e();this.visualizationRemovedCallbacks=[]}};function St(e,t,n){if(e.spellcheck){const n=e.closest("[contenteditable=true]"),r=null==n?void 0:n.getAttribute("spellcheck"),i=e.getAttribute("spellcheck");return n?n.setAttribute("spellcheck","false"):(e.setAttribute("spellcheck","false"),e.spellcheck=!1),(n||e).setAttribute(t.editorSpellcheckAttribute,"true"),n=>{const o=n.closest("[contenteditable=true]");o?r?o.setAttribute("spellcheck",r):o.removeAttribute("spellcheck"):i?(e.setAttribute("spellcheck",i),e.spellcheck=!1):(e.setAttribute("spellcheck","false"),e.spellcheck=!1),(o||n).removeAttribute(t.editorSpellcheckAttribute)}}return(null==n?void 0:n.some((t=>t(e))))?((e.closest("[contenteditable=true]")||e).setAttribute(t.editorSpellcheckAttribute,"true"),e=>{(e.closest("[contenteditable=true]")||e).removeAttribute(t.editorSpellcheckAttribute)}):()=>{}}Ct=(0,i.__decorate)([(0,Le._)()],Ct);var Tt=n(30225);let It=class{constructor(e,t,n,r,i,o,a,s,l,d,u,c,g,f,v){this._observerFactory=e,this._tileContent=t,this._proofingDom=n,this._nodePoller=r,this._tileNodeReader=i,this._settings=o,this._hostSettings=a,this._childElementsFinderFactory=s,this._hostEmitter=d,this._graphNodeFactory=u,this.shadowElementsStore=g,this.textEventPublisher=f,this.nodeTraverser=v,this.buildNode=(e,t,n,r)=>{var i,o;const a=this._observerFactory(this._graphNodeBuilderTerminalRule.observerType,this._graphNodeBuilderTerminalRule),s=new Ct(a,e,t,r),l=this._childElementsFinderFactory(this._graphNodeBuilderTerminalRule.elementsFinder),d=this._getNewTopology(s,l,s).map((e=>this.createTileNode(e,s)));s.children=d,s.documentModel=n;const u=St(e,this._settings,this._graphNodeBuilderTerminalRule.spellcheckOverrides);return s.registerVisualizationRemovedCallback((()=>{const e=this._tileContent.getContainingElement(s);e&&u(e)})),((0,at.C)(e,"HTMLInputElement")||(0,at.C)(e,"HTMLTextAreaElement"))&&(null===(i=this.shadowElementsStore)||void 0===i||i.setCanvasElement(d[0].id,e)),a.onElementAdded=(e,t)=>{var n;s.element&&!s.element.contains(e)||this._nodePoller.pollNodes(h.G.NewData,null!==(n=s.children)&&void 0!==n?n:[],t,void 0,void 0,void 0,!this._hostSettings.enableOrchestration)},a.onElementChanged=(e,t,n,r)=>{this._nodePoller.pollNodes(h.G.ChangeData,this._getChildrenToReconcile(s,e),t,void 0,void 0,void 0,void 0,r)},a.onElementRemoved=(e,t)=>{var n;this._nodePoller.pollNodes(h.G.ChangeData,null!==(n=s.children)&&void 0!==n?n:[],t)},a.onVisualStateChanged=(e,t)=>{var n,r,i,o,a;if("StyleChange"!==t){if("Created"===t){const e=this._tileContent.getContainingElement(s);if(e){const t=St(e,this._settings,this._graphNodeBuilderTerminalRule.spellcheckOverrides);s.registerRetireCallback((()=>{const e=this._tileContent.getContainingElement(s);e&&t(e)}))}}else s.visualizationWasRemoved();this._nodePoller.pollNodes(h.G.ChangeData,null!==(r=s.children)&&void 0!==r?r:[],p.Q0.Code,void 0,!0,void 0,void 0);for(const e of null!==(i=s.children)&&void 0!==i?i:[])null===(o=this._hostEmitter)||void 0===o||o.emit(M.pD.hostModelVisualStateChange,{address:void 0,message:{tileId:e.id,tileVersion:null!==(a=e.eventSeqId)&&void 0!==a?a:0,created:"Created"===t}})}else null===(n=this.textEventPublisher)||void 0===n||n.publishTextStyleEvent()},this._nodePoller.pollNodes(h.G.NewData,s.children,null!==(o=this._graphNodeBuilderTerminalRule.initialContentChangeType)&&void 0!==o?o:p.Q0.Code),s},this._getNewTopology=(e,t,n)=>e.element?t.find(e.element,this._graphNodeBuilderTerminalRule.filterSelector).filter((e=>this._graphNodeBuilderTerminalRule.filters.every((t=>t(e,n,this._graphNodeBuilderTerminalRule))))):[],this._graphNodeBuilderTerminalRule=l.nodeMetaType,this._paragraphNodesBuilder=null==c?void 0:c(this._graphNodeBuilderTerminalRule.completeTileTextUnit,this._graphNodeBuilderTerminalRule.partialTileTextUnit)}_getChildrenToReconcile(e,t){return[...(e.children||[]).filter((e=>{var n,r;return null!==(r=null===(n=e.element)||void 0===n?void 0:n.contains(t))&&void 0!==r?r:!this._settings.narrowOnChangeReconciliation&&this._tileNodeReader.critiques(e).length}))]}createTileNode(e,t){const n=this._observerFactory(ht.AttributeObserver),r=this._paragraphNodesBuilder&&this._graphNodeFactory?this._graphNodeFactory(mt.Z.TileNode,n,e,t,void 0,this._paragraphNodesBuilder):new bt(this._proofingDom,this._tileContent,mt.Z.TileNode,n,e,t,void 0,void 0,this.nodeTraverser,this._hostSettings);return this._hostSettings.disableTileNodeObserver||(n.onElementChanged=(e,t)=>{this._nodePoller.pollNodes(h.G.NewData,[r],t)},n.observe(document.body)),r}};It=(0,i.__decorate)([(0,Le._)(),(0,i.__param)(0,(0,Me.W)(lt)),(0,i.__param)(1,(0,Me.W)(F.d)),(0,i.__param)(2,(0,Me.W)(ge.w)),(0,i.__param)(3,(0,Me.W)(S.G)),(0,i.__param)(4,(0,Me.W)(vt.j)),(0,i.__param)(5,(0,Me.W)(st.k)),(0,i.__param)(6,(0,Me.W)(Ie.n)),(0,i.__param)(7,(0,Me.W)(tt)),(0,i.__param)(8,(0,Me.W)(rt)),(0,i.__param)(9,(0,Tt.l)()),(0,i.__param)(9,(0,Me.W)(M.M5)),(0,i.__param)(10,(0,Tt.l)()),(0,i.__param)(10,(0,Me.W)(it)),(0,i.__param)(11,(0,Tt.l)()),(0,i.__param)(11,(0,Me.W)(ct)),(0,i.__param)(12,(0,Tt.l)()),(0,i.__param)(12,(0,Me.W)(pt.S)),(0,i.__param)(13,(0,Tt.l)()),(0,i.__param)(13,(0,Me.W)(ft.n)),(0,i.__param)(14,(0,Tt.l)()),(0,i.__param)(14,(0,Me.W)(ut.M))],It);var wt=n(20688);let Et=class{constructor(e,t,n){this._mutationObserverFactory=e,this.elementTransformers=t,this._logger=n,this.connectMutationObserver=(e,t,n,r)=>{this._mutationObserver=this._mutationObserverFactory((e=>{e.forEach(((e,i,o)=>{const a=null==r?void 0:r.filterSelector;let s=!1;t.ignoredMutationElementsSelectors&&(0,at.C)(e.target,"Element")&&(s=e.target.matches(t.ignoredMutationElementsSelectors)),a&&a!==e.target.nodeName&&s||this.handleMutation(e,p.Q0.Local,null==n?void 0:n(e,i,o))}))})),this._mutationObserver.observe(e,t)},this.flushMutationObserver=e=>{this._mutationObserver&&this._mutationObserver.takeRecords().forEach(((t,n,r)=>this.handleMutation(t,p.Q0.Local,e?e(t,n,r):void 0)))},this.handleMutation=(e,t,n)=>{var r;try{const r=this.onElementRemoved,i=this.onElementAdded,o=this.onElementChanged;switch(e.type){case"childList":r&&Array.from(e.removedNodes).forEach((e=>{r(e,t,n)})),i&&Array.from(e.addedNodes).forEach((e=>{i(e,t,n)}));break;case"characterData":o&&o(e.target,t);break;case"attributes":this.handleAttributeChange(e,t,i,o,r)}}catch(e){null===(r=this._logger)||void 0===r||r.logEvent(508146690,wt.s.MutationError,Oe.q.Error,"Error while processing a mutation.",Re.o.SamplingPolicy.CriticalBusinessImpact,e)}}}handleAttributeChange(e,t,n,r,i){const o=e.attributeName,a=e.target;this.elementTransformers&&o&&this.elementTransformers.forEach((e=>{e.attributeList.includes(o)&&e.transform(a)})),null==r||r(a,t,void 0)}disconnect(e){this._mutationObserver&&(this._mutationObserver.takeRecords(),this._mutationObserver.disconnect())}};Et=(0,i.__decorate)([(0,Le._)()],Et);let xt=class extends Et{constructor(e,t,n){super(e,void 0,n),this.mutationObserverFactory=e,this.hostSettings=t,this.logger=n}observe(e){this.connectMutationObserver(e,{attributes:!0,attributeFilter:["style"],characterData:!1,childList:!1,subtree:!0,attributeOldValue:!1,characterDataOldValue:!1,ignoredMutationElementsSelectors:this.hostSettings.ignoredMutationElementsSelectors})}};xt=(0,i.__decorate)([(0,Le._)(),(0,i.__param)(0,(0,Me.W)(dt)),(0,i.__param)(1,(0,Me.W)(Ie.n)),(0,i.__param)(2,(0,Tt.l)()),(0,i.__param)(2,(0,Me.W)(m.g))],xt);let At=class extends Et{constructor(e,t,n){super(e,null==n?void 0:n.elementTransformers,t),this.mutationObserverFactory=e,this._logger=t,this._lastCharacterModificationReplacedCharacters=!1,this.connectMutationObserver=(e,t,n)=>{this._mutationObserver=this._mutationObserverFactory((e=>{var t;let r=!1,i=!1;for(let o=0;o<e.length;o++){const a=e[o],s=e;try{const e=this.onElementRemoved,t=this.onElementAdded,l=this.onElementChanged;switch(a.type){case"childList":if(e){const t=Array.from(a.removedNodes);t.length&&!i&&(e(t.pop(),p.Q0.Local,void 0),i=!0)}if(t){const e=Array.from(a.addedNodes);e.length&&!r&&(t(e.pop(),p.Q0.Local,null==n?void 0:n(a,o,s)),r=!0)}break;case"characterData":l&&l(a.target,p.Q0.Local,void 0,this._lastCharacterModificationReplacedCharacters);break;case"attributes":this.handleAttributeChange(a,p.Q0.Local,t,l,e)}}catch(e){null===(t=this._logger)||void 0===t||t.logEvent(508146694,wt.s.MutationError,Oe.q.Error,"Error while processing a mutation.",Re.o.SamplingPolicy.CriticalBusinessImpact,e)}finally{this._lastCharacterModificationReplacedCharacters=!1}}})),this._mutationObserver.observe(e,t),this.eventListener=new W.J(e),this.eventListener.addListener("keypress",this.onKeyPress,{passive:!0,capture:!0})},this.onKeyPress=e=>{const t=e.currentTarget.ownerDocument.getSelection();(null==t?void 0:t.toString().startsWith(e.key))?this._lastCharacterModificationReplacedCharacters=!0:this._lastCharacterModificationReplacedCharacters=!1},this._mutationContextBuilder=null==n?void 0:n.mutationContextBuilder,this.elementTransformers=null==n?void 0:n.elementTransformers}observe(e){const t={attributes:!1,characterData:!0,childList:!0,subtree:!0,attributeOldValue:!1,characterDataOldValue:!1};if(this.elementTransformers){const e=new Set;for(const t of this.elementTransformers)for(const n of t.attributeList)e.add(n);e.size&&(t.attributes=!0,t.attributeFilter=Array.from(e.values()))}this.connectMutationObserver(e,t,this._mutationContextBuilder),this._styleChangeObserver=this.mutationObserverFactory((e=>{this.onVisualStateChanged&&e.length>0&&this.onVisualStateChanged(e[0].target,"StyleChange")})),this._styleChangeObserver.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["style"]})}disconnect(e){var t,n,r;super.disconnect(e),null===(t=this.eventListener)||void 0===t||t.removeAllListeners(),this.eventListener=void 0,null===(n=this._styleChangeObserver)||void 0===n||n.takeRecords(),null===(r=this._styleChangeObserver)||void 0===r||r.disconnect()}};At=(0,i.__decorate)([(0,Le._)(),(0,i.__param)(0,(0,Me.W)(dt)),(0,i.__param)(1,(0,Tt.l)()),(0,i.__param)(1,(0,Me.W)(m.g)),(0,i.__param)(2,(0,Tt.l)()),(0,i.__param)(2,(0,Me.W)(nt))],At);let Dt=class extends Et{constructor(e,t){super(e,void 0,t),this.mutationObserverFactory=e,this.logger=t,this._onElementChangedEvent=e=>{const t=this.onElementChanged;t&&this._element&&t(this._element,p.Q0.Local,void 0)}}observe(e){var t;((0,at.C)(e,"HTMLInputElement")||(0,at.C)(e,"HTMLTextAreaElement")||(0,at.C)(e,"HTMLDivElement"))&&(this._element=e,null===(t=this.eventListener)||void 0===t||t.removeAllListeners(),this.eventListener=new W.J(e),this.eventListener.addListener("input",this._onElementChangedEvent,{passive:!0}),this.eventListener.addListener("BX-ForceReflow",this._onElementChangedEvent,{passive:!0}),this.connectMutationObserver(this._element,{attributes:!1,characterData:!1,childList:!0,subtree:!0,attributeOldValue:!1,characterDataOldValue:!1}))}disconnect(e){var t;null===(t=this.eventListener)||void 0===t||t.removeAllListeners(),this.eventListener=void 0,super.disconnect(e),this._element=void 0}};Dt=(0,i.__decorate)([(0,Le._)(),(0,i.__param)(0,(0,Me.W)(dt)),(0,i.__param)(1,(0,Tt.l)()),(0,i.__param)(1,(0,Me.W)(m.g))],Dt);let kt=class{constructor(e,t,n,r,i,o,a,s,l,d,u,c,g){this.hostSettings=e,this.proofingDom=t,this._settings=n,this._tileContent=r,this._tileNodeReader=i,this._nodePoller=o,this._textEventPublisher=a,this.logger=s,this.targetDocumentFactory=l,this._hostEmitter=d,this._graphNodeFactory=u,this._paragraphNodesBuilderFactory=c,this.shadowElementsStore=g}createGraphNode(e){const{element:t,filterSelector:n,parent:r,initialContentChangeType:i,documentModel:o,terminalNodeId:a}=e;if(this._validateElementWithProofingDom(t))return this.getGraphNodeBuilderFactory(t,n,i).buildNode(t,r,o,a)}getGraphNodeBuilderFactory(e,t,n){const r=this.getObserverTypeBasedOnElement(e),i={ruleName:"",nodeMetaType:{nodeType:mt.Z.TerminalNode,observerType:r,filters:[],filterSelector:t,initialContentChangeType:n},childMetaType:null};return new It(((e,t)=>function(e,t,n,r){const i=e=>new MutationObserver(e);switch(e){case ht.InputNodeObserver:return new Dt(i,n);case ht.TerminalNodeObserver:return new At(i,n);default:return new xt(i,{ignoredMutationElementsSelectors:r},n)}}(e,0,this.logger,this.hostSettings.ignoredMutationElementsSelectors)),this._tileContent,this.proofingDom,this._nodePoller,this._tileNodeReader,this._settings,this.hostSettings,(()=>({find:e=>[e]})),i,this._hostEmitter,this._graphNodeFactory,this._paragraphNodesBuilderFactory,this.shadowElementsStore,this._textEventPublisher)}getObserverTypeBasedOnElement(e){return(0,at.C)(e,"HTMLInputElement")||(0,at.C)(e,"HTMLTextAreaElement")?ht.InputNodeObserver:ht.TerminalNodeObserver}_validateElementWithProofingDom(e){var t,n,r,i;if(!(0,at.C)(e,"HTMLElement"))return!0;for(const n of this.proofingDom.tileNodes.values())if((0,at.C)(n.element,"HTMLElement")&&(n.element.contains(e)||e.contains(n.element)))return null===(t=this.logger)||void 0===t||t.error(508146704,"The element is already contained within another attached element."),!1;if(!this.hostSettings.doNotLimitToTargetDocument&&this.targetDocumentFactory){const t=null===(n=this.targetDocumentFactory())||void 0===n?void 0:n.deref();if(t&&e.ownerDocument!==t)return null===(r=this.logger)||void 0===r||r.error(508146703,"The element must be within the target document."),!1}return!!((0,at.C)(e,"HTMLInputElement")&&["text","search"].includes(e.type)||(0,at.C)(e,"HTMLTextAreaElement")||e.isContentEditable)||(null===(i=this.logger)||void 0===i||i.error(508146702,"Unsupported element - only input (of type search and text only), textarea, and content editable elements are supported."),!1)}};var Ft,Pt,Nt,Bt,Ot,Rt,Lt,Mt,qt,Wt,Ut,zt;kt=(0,i.__decorate)([(0,Le._)(),(0,i.__param)(0,(0,Me.W)(Ie.n)),(0,i.__param)(1,(0,Me.W)(ge.w)),(0,i.__param)(2,(0,Me.W)(st.k)),(0,i.__param)(3,(0,Me.W)(F.d)),(0,i.__param)(4,(0,Me.W)(vt.j)),(0,i.__param)(5,(0,Me.W)(S.G)),(0,i.__param)(6,(0,Tt.l)()),(0,i.__param)(6,(0,Me.W)(ft.n)),(0,i.__param)(7,(0,Tt.l)()),(0,i.__param)(7,(0,Me.W)(m.g)),(0,i.__param)(8,(0,Tt.l)()),(0,i.__param)(8,(0,Me.W)(j.Ze)),(0,i.__param)(9,(0,Tt.l)()),(0,i.__param)(9,(0,Me.W)(M.M5)),(0,i.__param)(10,(0,Tt.l)()),(0,i.__param)(10,(0,Me.W)(it)),(0,i.__param)(11,(0,Tt.l)()),(0,i.__param)(11,(0,Me.W)(ct)),(0,i.__param)(12,(0,Tt.l)()),(0,i.__param)(12,(0,Me.W)(pt.S))],kt),function(e){e[e.Start=0]="Start",e[e.End=1]="End"}(Ft||(Ft={}));class jt{constructor(e,t){this._textRetrieverFactory=e,this._indexReadjuster=t,this.findOffsetPositions=async(e,t,n=!1,r)=>{const i=new Map;let o=0;t.sort(((e,t)=>e.index-t.index));const a=this.getTargetDocument(e).createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:()=>NodeFilter.FILTER_ACCEPT});let s,l=0;if(s=void 0!==r?r:this._textRetrieverFactory(e).retrieve().content,t[0]&&t[0].index<0||t[t.length-1]&&t[t.length-1].index>s.length)return i;const d=await this._indexReadjuster.getReadjustedIndices(e,t,s);let u;for(;a.nextNode();){const e=a.currentNode,r=o,s=e.textContent?e.textContent.length:0,c=r+s;for(let o=l;o<t.length;o+=1){const a=d[o];if(a.indexType===Ft.Start&&a.index>=r&&(n?a.index<=c:a.index<c))l+=1,i.set(t[o].startIndex,{startNode:e,startOffset:a.index-r});else{if(!(a.indexType===Ft.End&&a.index>=r&&a.index<=c))break;{l+=1;const n=i.get(t[o].startIndex);if(!n)throw new Error("The critique's end index has no conforming start index.");n.endNode=e,n.endOffset=a.index-r,i.set(t[o].startIndex,n)}}}if(o+=s,s>0&&(u=e),l===t.length)break}if(l!==t.length)if(u){const e=o-(u.textContent?u.textContent.length:0);for(let n=l;n<t.length;n+=1){const r=d[n];if(r.indexType===Ft.Start&&r.index===o)l+=1,i.set(t[n].startIndex,{startNode:u,startOffset:r.index-e});else{if(r.indexType!==Ft.End||r.index!==o)break;{l+=1;const o=i.get(t[n].startIndex);if(!o)throw new Error("The critique's end index has no conforming start index.");o.endNode=u,o.endOffset=r.index-e,i.set(t[n].startIndex,o)}}}}else for(let n=l;n<t.length;n+=1){const r=d[n];if(r.indexType===Ft.Start&&0===r.index)i.set(t[n].startIndex,{startNode:e,startOffset:0});else{if(r.indexType!==Ft.End||0!==r.index)break;{const r=i.get(t[n].startIndex);if(!r)throw new Error("The critique's end index has no conforming start index.");r.endNode=e,r.endOffset=0,i.set(t[n].startIndex,r)}}}return i},this.createRange=(e,t)=>{if(!(null==t?void 0:t.endNode)||void 0===t.endOffset)return;const n=e.createRange();return n.setStart(t.startNode,t.startOffset),n.setEnd(t.endNode,t.endOffset),n},this.getTargetDocument=e=>{var t;return null!==(t=e.ownerDocument)&&void 0!==t?t:document}}async getCritiqueRanges(e,t){const n=[];for(const e of t)n.push({index:e.start,indexType:Ft.Start,startIndex:e.start}),n.push({index:e.start+e.length,indexType:Ft.End,startIndex:e.start});const r=await this.findOffsetPositions(e,n),i=this.getTargetDocument(e);return t.map((e=>{const t=r.get(e.start);return{critique:e,range:this.createRange(i,t)}}))}async getRangeOfNode(e,t,n,r){const i=[];i.push({index:t,indexType:Ft.Start,startIndex:t}),i.push({index:t+n,indexType:Ft.End,startIndex:t});const o=await this.findOffsetPositions(e,i,!1,r),a=this.getTargetDocument(e);return this.createRange(a,o.get(t))}async getNodeInsertionPosition(e,t,n){const r=[];r.push({index:t,indexType:Ft.Start,startIndex:t}),r.push({index:t,indexType:Ft.End,startIndex:t});const i=await this.findOffsetPositions(e,r,n),o=this.getTargetDocument(e);return this.createRange(o,i.get(t))}includePrecedingSpace(e,t){let n;if(t.startOffset>=0&&t.startContainer.textContent&&" "===t.startContainer.textContent.charAt(t.startOffset-1))n={startNode:t.startContainer,startOffset:t.startOffset-1};else if(0===t.startOffset){const r=this.getTargetDocument(e).createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:()=>NodeFilter.FILTER_ACCEPT});for(r.currentNode=t.startContainer;r.previousNode();){const e=r.currentNode;if(e.nodeType===e.TEXT_NODE&&e.textContent&&e.textContent.length>0){e.textContent.endsWith(" ")&&(n={startNode:e,startOffset:e.textContent.length-1});break}}}return n&&t.setStart(n.startNode,n.startOffset),t}}class Ht{constructor(e){this.element=e}retrieve(){return{content:this.element.value}}}class Vt{constructor(e){this.element=e}retrieve(){return{content:this.element?Gt(this.element.innerText):""}}}function Gt(e){if(!e.includes("​‌"))return e;const t=e.split("​‌");let n="";return t.forEach(((e,t)=>{t%2==0&&(n+=e)})),n}!function(e){e[e.Unspecified=0]="Unspecified",e[e.Inline=1]="Inline",e[e.Floating=2]="Floating"}(Pt||(Pt={})),function(e){e[e.ThumbsUp=0]="ThumbsUp"}(Nt||(Nt={})),function(e){e[e.Active=0]="Active",e[e.Resolved=1]="Resolved",e[e.Closed=2]="Closed"}(Bt||(Bt={})),function(e){e[e.Undefined=0]="Undefined",e[e.Bullet=1]="Bullet",e[e.Numbered=2]="Numbered",e[e.Lim=3]="Lim",e[e.Nil=4]="Nil",e[e.Any=5]="Any",e[e.NoList=6]="NoList",e[e.Invalid=7]="Invalid"}(Ot||(Ot={})),function(e){e[e.DontCare=1]="DontCare",e[e.Thin=2]="Thin",e[e.ExtraLight=3]="ExtraLight",e[e.Light=4]="Light",e[e.Normal=5]="Normal",e[e.Medium=6]="Medium",e[e.SemiBold=7]="SemiBold",e[e.Bold=8]="Bold",e[e.ExtraBold=9]="ExtraBold",e[e.Heavy=10]="Heavy"}(Rt||(Rt={})),function(e){e[e.NoCaps=0]="NoCaps",e[e.SmallCaps=1]="SmallCaps",e[e.AllCaps=2]="AllCaps",e[e.AllPetiteCaps=3]="AllPetiteCaps",e[e.PetiteCaps=4]="PetiteCaps",e[e.Unicase=5]="Unicase",e[e.Titling=6]="Titling",e[e.Other=7]="Other"}(Lt||(Lt={})),function(e){e[e.None=0]="None",e[e.Words=1]="Words",e[e.SingleLine=2]="SingleLine",e[e.DoubleLine=3]="DoubleLine",e[e.HeavyLine=4]="HeavyLine",e[e.DottedLine=5]="DottedLine",e[e.DottedHeavyLine=6]="DottedHeavyLine",e[e.DashLine=7]="DashLine",e[e.DashHeavyLine=8]="DashHeavyLine",e[e.DashLongLine=9]="DashLongLine",e[e.DashLongHeavyLine=10]="DashLongHeavyLine",e[e.DotDashLine=11]="DotDashLine",e[e.DotDashHeavyLine=12]="DotDashHeavyLine",e[e.DotDotDashLine=13]="DotDotDashLine",e[e.DotDotDashHeavyLine=14]="DotDotDashHeavyLine",e[e.WavyLine=15]="WavyLine",e[e.WavyHeavyLine=16]="WavyHeavyLine",e[e.WavyDoubleLine=17]="WavyDoubleLine"}(Mt||(Mt={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Center=2]="Center",e[e.Justified=3]="Justified",e[e.Other=4]="Other",e[e.None=5]="None",e[e.JustifyLow=6]="JustifyLow",e[e.Distributed=7]="Distributed",e[e.ThaiDistributed=8]="ThaiDistributed"}(qt||(qt={})),function(e){e[e.Image=0]="Image",e[e.TextBox=1]="TextBox",e[e.Chart=2]="Chart",e[e.SmartArt=3]="SmartArt",e[e.Drawing=4]="Drawing",e[e.EquationObject=5]="EquationObject",e[e.Ink=6]="Ink",e[e.InkSpace=7]="InkSpace",e[e.InkEndOfLine=8]="InkEndOfLine",e[e.LineBreak=9]="LineBreak",e[e.PageBreak=10]="PageBreak",e[e.PageNumbers=11]="PageNumbers",e[e.FootnoteEndnote=12]="FootnoteEndnote",e[e.FootnoteEndnoteReferenceMark=13]="FootnoteEndnoteReferenceMark",e[e.Tab=14]="Tab",e[e.UnsupportedObject=15]="UnsupportedObject",e[e.Other=16]="Other",e[e.Person=17]="Person",e[e.Date=18]="Date"}(Wt||(Wt={})),function(e){e[e.Initial=0]="Initial",e[e.FirstLine=1]="FirstLine",e[e.Hanging=2]="Hanging"}(Ut||(Ut={})),function(e){e[e.LeftToRight=0]="LeftToRight",e[e.RightToLeft=1]="RightToLeft"}(zt||(zt={}));var Qt=n(78175);class Kt extends Vt{constructor(e){super(e),this.parentContentEditable=(0,Qt.m)(e)}retrieve(){const e=super.retrieve();return Object.assign(Object.assign(Object.assign({},e),{isInsideTable:this.getIsInsideTable()}),this.getListTypeAndIndentation())}getIsInsideTable(){if(!this.parentContentEditable)return;let e=this.element;for(;e&&e!==this.parentContentEditable;){if("TABLE"===e.nodeName)return!0;e=e.parentElement}return!1}getListTypeAndIndentation(){if(!this.parentContentEditable)return;let e,t,n=this.element;for(;n&&n!==this.parentContentEditable;)"OL"===n.nodeName&&(e||(e=Ot.Numbered),t=(null!=t?t:-1)+1),"UL"===n.nodeName&&(e||(e=Ot.Bullet),t=(null!=t?t:-1)+1),n=n.parentElement;return{listType:null!=e?e:Ot.NoList,indentation:t}}}class $t{setHtmlElement(e){this.element!==e&&(this.element=e,this.ownerDocument=e.ownerDocument||void 0)}dispatchInputEvent(){if(this.element){const e=new Event("input",{bubbles:!0});this.element.dispatchEvent(e)}}}const Zt="createUndoCheckpoint",Jt=(e,t)=>new Promise((n=>t.requestAnimationFrame(n,e)));class Xt extends $t{constructor(e,t,n){super(),this.textNodeRangeBuilder=e,this._safeWindow=t,this._logger=n,this._textInterceptionMaxTimeoutMs=2e3,this._keysCache="",this._disposed=!1,this.documentKeyboardEventHandler=e=>("keydown"!==e.type||1!==e.key.length||e.altKey||e.ctrlKey||e.metaKey||(this._keysCache+=e.key),e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation(),!1),this.inputInterceptionTimeoutHandler=e=>{this._logger&&this._logger.warn(507248854,`Input interception is shutting down on timeout after ${this._textInterceptionMaxTimeoutMs}ms`),this.stopInputInterception(e)},this.getRange=async(e,t)=>{if(this.element&&this.ownerDocument)return this.textNodeRangeBuilder.getRangeOfNode(this.element,e,t)},this.selectRange=(e,t)=>{const n=e.getSelection();if(!n)return;const r=[];for(let e=0;e<n.rangeCount;e++)r.push(n.getRangeAt(e));return n.removeAllRanges(),n.addRange(t),n.setBaseAndExtent(t.startContainer,t.startOffset,t.endContainer,t.endOffset),r},this.selectRanges=(e,t)=>{const n=e.getSelection();if(!n)return!1;if(n.removeAllRanges(),t)for(const e of t)n.addRange(e);return!0},this.focusElementAndPrepareRange=async(e,t,n,r)=>(n.focus(),this.prepareRange(e,t,r)),this.prepareRange=async(e,t,n)=>(await Jt(this.targetWindow,this._safeWindow),!n||n.collapsed?this.getRange(e,t):n)}get targetWindow(){return this.element?(0,at.e)(this.element):window}get disposed(){return this._disposed}async dispose(){var e;this.stopInputInterception(null!==(e=this.ownerDocument)&&void 0!==e?e:this.targetWindow.document),this._disposed=!0}async insert(e,t,n,r,i,o=!0){if(!this.element||!this.ownerDocument)return;const a=this.ownerDocument;o&&await Jt(this.targetWindow,this._safeWindow);let s=r;if(s||(s=await this.textNodeRangeBuilder.getNodeInsertionPosition(this.element,e,n)),s){const e=this.selectRange(a,s);await this.doReplacement(a,t),i&&this.selectRanges(a,e)}}async replace(e,t,n,r){if(!this.element||!this.ownerDocument)return;const{ownerDocument:i,element:o}=this,a=await this.focusElementAndPrepareRange(e,t,o,r);a&&(this.selectRange(i,a),await this.doReplacement(i,n))}async remove(e,t,n,r,i=!0,o){if(!this.element||!this.ownerDocument)return;const{ownerDocument:a}=this;i&&await Jt(this.targetWindow,this._safeWindow);let s=n;if(s&&!s.collapsed||(s=await this.textNodeRangeBuilder.getRangeOfNode(this.element,e,t)),s){o&&this.textNodeRangeBuilder.includePrecedingSpace(this.element,s);const n=this.selectRange(a,s);await this.doRemoval(a,(async()=>this.textNodeRangeBuilder.getRangeOfNode(this.element,e,t))),r&&this.selectRanges(a,n)}return s}async autoCorrect(e,t,n,r,i){if(!this.element||!this.ownerDocument)return;let o,a=null;a=this.ownerDocument.getSelection(),a&&a.rangeCount>0&&(o={node:a.focusNode,offset:a.focusOffset}),i&&(this.startInputInterception(this.ownerDocument),this._interceptStartTime=Date.now(),this._logger&&this._logger.debug(507248859,`Starting text input interception ${this._interceptStartTime}`));let s=0;const l=this.ownerDocument;try{const i=await this.prepareRange(e,t,r);if(i){const e=i.toString();return this.selectRange(l,i),await this.doReplacement(l,n),s=n.length-t,e}}catch(e){throw i&&this._logger&&this._logger.error(507248858,"An error occurred during the auto correction text replacement while text interception is ON",e),e}finally{await this.restoreTextAndPosition(l,s,a,o,i)}}async restoreTextAndPosition(e,t,n,r,i){try{n&&r&&this.restorePosition(n,t,r)}catch(e){throw i&&this._logger&&this._logger.error(507248857,"An error occurred while trying to restore the cursor position after the auto correction and text interception is ON",e),e}finally{i&&await this.restoreText(e)}}restorePosition(e,t,n){var r,i,o;const a=n.offset+t,s=null!==(o=null===(i=null===(r=n.node)||void 0===r?void 0:r.textContent)||void 0===i?void 0:i.length)&&void 0!==o?o:a,l=Math.min(s,a);e.removeAllRanges(),e.setPosition(n.node,l)}async restoreText(e){try{await this.doReplacement(e,this._keysCache)}catch(e){throw this._logger&&this._logger.error(507248856,"An error occurred while trying to restore the cached text after the auto correction.",e),e}finally{if(this.stopInputInterception(e),this._interceptStartTime){const e=Date.now()-this._interceptStartTime;this._logger&&this._logger.debug(507248855,`Stop text input interception. Time take ${e} ms.`),this._interceptStartTime=void 0}}}startInputInterception(e){var t;this._keysCache="",this._textInterceptionTimeout=this.targetWindow.setTimeout((()=>this.inputInterceptionTimeoutHandler(e)),this._textInterceptionMaxTimeoutMs),null===(t=this._textInterceptionEventListener)||void 0===t||t.removeAllListeners(),this._textInterceptionEventListener=new W.J(e),this._textInterceptionEventListener.addListener("keyup",this.documentKeyboardEventHandler,{capture:!0}),this._textInterceptionEventListener.addListener("keydown",this.documentKeyboardEventHandler,{capture:!0}),this._textInterceptionEventListener.addListener("keypress",this.documentKeyboardEventHandler,{capture:!0})}stopInputInterception(e){var t;this._textInterceptionTimeout&&(this.targetWindow.clearTimeout(this._textInterceptionTimeout),this._textInterceptionTimeout=void 0),null===(t=this._textInterceptionEventListener)||void 0===t||t.removeAllListeners(),this._textInterceptionEventListener=void 0,this._keysCache=""}doReplacement(e,t){const n=new Event(Zt);return e.dispatchEvent(n),this.innerDoReplacement(e,t),e.dispatchEvent(n),Promise.resolve()}async doRemoval(e,t){const n=new Event(Zt);e.dispatchEvent(n),await this.innerDoRemoval(e,t),e.dispatchEvent(n)}innerDoReplacement(e,t){e.execCommand("insertText",!1,t),this.dispatchInputEvent()}async innerDoRemoval(e,t){var n,r,i,o;const a=e.getSelection();if(a&&a.anchorNode===a.focusNode&&(null===(n=a.anchorNode)||void 0===n?void 0:n.textContent)){const n=a.anchorNode,s=null===(r=n.textContent)||void 0===r?void 0:r.length;e.execCommand("delete",!1),n.isConnected&&(null===(i=n.textContent)||void 0===i?void 0:i.length)===s&&(null===(o=await t())||void 0===o||o.deleteContents())}else e.execCommand("delete",!1);this.dispatchInputEvent()}}class Yt extends $t{constructor(){super(...arguments),this.doReplacement=(e,t,n,r,i)=>{e.setRangeText(t,n,r,i),this.dispatchInputEvent()},this.calculateBoundaries=(e,t,n)=>{const r=e.value.length,i=Math.min(t,r);return{start:i,end:Math.min(i+n,r)}}}async insert(e,t){if(!this.element)return;const n=this.calculateBoundaries(this.element,e,0);this.doReplacement(this.element,t,n.start,n.end,"end")}async replace(e,t,n){if(!this.element)return;const r=this.calculateBoundaries(this.element,e,t);this.doReplacement(this.element,n,r.start,r.end,"end")}async autoCorrect(e,t,n){if(!this.element)return;const r=this.calculateBoundaries(this.element,e,t),i=this.element.value.substring(r.start,r.end);return this.doReplacement(this.element,n,r.start,r.end,"preserve"),i}async remove(e,t,n,r,i,o){if(!this.element)return;const a=this.calculateBoundaries(this.element,o?e-1:e,o?t+1:t);this.doReplacement(this.element,"",a.start,a.end)}}class en extends $t{constructor(e){super(),this.textRetrieverFactory=e}async insert(e,t){if(!this.element)return;const n=this.getReplacedText(e,e,t);this.element.innerText=n.text}async replace(e,t,n){if(!this.element)return;const r=this.getReplacedText(e,e+t,n);this.element.innerText=r.text}async autoCorrect(e,t,n){if(!this.element)return;const r=this.getReplacedText(e,e+t,n);return this.element.innerText=r.text,r.replacedPart}async remove(e,t,n,r,i,o=!1){if(!this.element)return;const a=this.getReplacedText(e,e+t,void 0,!o);this.element.innerText=a.text}getReplacedText(e,t,n,r){const i=this.getText(),o=i.length;let a=Math.min(e,o);const s=Math.min(t,o);return r||n||" "!==i[a-1]||(a-=1),{text:`${i.substring(0,a)}${null!=n?n:""}${i.substring(s)}`,replacedPart:i.substring(a,s)}}getText(){return this.element?this.textRetrieverFactory(this.element).retrieve().content:""}}const tn=(0,l.f)("IIndexReadjuster");class nn{constructor(e,t,n,r){this._proofingDom=e,this._tileContent=t,this._indexReadjuster=n,this.targetWindow=r,this.getTextSelection=()=>{var e,t;const n=(null!==(t=null===(e=this.targetWindow)||void 0===e?void 0:e.deref())&&void 0!==t?t:window).getSelection();if(n){const e=this.getParentTileElement(n.anchorNode),t=this.getParentTileElement(n.focusNode);if(e&&t)return this.attemptToFindSelectionRange(e,t,n)}return Promise.resolve(void 0)},this.attemptToFindOffsetsIntoParentElement=(e,t)=>{const n=[],r=e.element&&this._tileContent.getContainingElement(e.element);if(!r)return n;const i=document.createTreeWalker(r,NodeFilter.SHOW_ALL,{acceptNode:()=>NodeFilter.FILTER_ACCEPT});let o=0;for(;i.nextNode();){const e=i.currentNode,r=e.textContent&&e.nodeType===e.TEXT_NODE?e.textContent.length:0;for(let r=0;r<t.length;r++)e===t[r]&&(n[r]=o);if(o+=r,n.length===t.length)break}if(0===o)for(let e=0;e<t.length;e++)r===t[e]&&(n[e]=o);return n},this.attemptToFindSelectionRange=async(e,t,n)=>{var r,i,o,a,s,l,d,u,c,g,h,p,f,v;let m,y;if(e.id===t.id){const t=this.attemptToFindOffsetsIntoParentElement(e,[n.anchorNode,n.focusNode]);m=t[0],y=t[1]}else m=this.attemptToFindOffsetsIntoParentElement(e,[n.anchorNode])[0],y=this.attemptToFindOffsetsIntoParentElement(t,[n.focusNode])[0];if(void 0!==m&&void 0!==y&&e.element&&t.element){let _,b,C,S,T,I,w=0,E=0;if(m>y?(w=y+n.focusOffset,E=m+n.anchorOffset,T=t,I=e):(w=m+n.anchorOffset,E=y+n.focusOffset,T=e,I=t),e.id===t.id){const t=this._tileContent.getContainingElement(e.element);if(!t)return;T=I=e;const h=null!==(i=null===(r=this._tileContent.getText(e))||void 0===r?void 0:r.content)&&void 0!==i?i:"";if(this._indexReadjuster)if(w===E){const e=0!==w&&"\n"===h.charAt(w),n=await this._indexReadjuster.getReadjustedIndices(t,[e?w-1:w],h,!0);e?(w=n[0]+1,E=n[0]+1):(w=n[0],E=n[0])}else{const e=await this._indexReadjuster.getReadjustedIndices(t,[w,E],h,!0);w=e[0],E=e[1]}if(!e.children)return{startParentElement:T,endParentElement:I,isCollapsed:n.isCollapsed,selectedText:n.toString(),startPosition:w,endPosition:E,startParagraphNode:_,endParagraphNode:b,startPositionInParagraphNode:C,endPositionInParagraphNode:S};for(const t of e.children){const e=t.element;w===E&&0!==w?w-1>=e.offset&&w-1<e.offset+e.span&&(_=t,C=w-e.offset,b=t,S=w-e.offset):(w>=e.offset&&(w<e.offset+e.span||0===w&&e.offset+e.span===0)&&(_=t,C=w-e.offset),E>=e.offset&&(E<e.offset+e.span||0===E&&e.offset+e.span===0)&&(b=t,S=E-e.offset))}if(!b){let t;for(const n of e.children)(!t||(null!==(a=null===(o=n.element)||void 0===o?void 0:o.offset)&&void 0!==a?a:0)>(null!==(l=null===(s=t.element)||void 0===s?void 0:s.offset)&&void 0!==l?l:0))&&(t=n);(null==t?void 0:t.element)&&E===t.element.offset+t.element.span&&(b=t,S=E-t.element.offset)}if(w===E&&!_&&!b){let t;for(const n of e.children)(!t||(null!==(u=null===(d=n.element)||void 0===d?void 0:d.offset)&&void 0!==u?u:0)>(null!==(g=null===(c=t.element)||void 0===c?void 0:c.offset)&&void 0!==g?g:0))&&(t=n);(null==t?void 0:t.element)&&w===t.element.offset+t.element.span+1&&(_=t,C=w-t.element.offset,b=t,S=w-t.element.offset)}}else{if(w=y+n.focusOffset,E=m+n.anchorOffset,T=t,I=e,!T.element||!I.element)return;const r=this._tileContent.getContainingElement(T.element),i=this._tileContent.getContainingElement(I.element);if(this._indexReadjuster&&r&&i){const e=null!==(p=null===(h=this._tileContent.getText(T))||void 0===h?void 0:h.content)&&void 0!==p?p:"";w=(await this._indexReadjuster.getReadjustedIndices(r,[w],e,!0))[0];const t=null!==(v=null===(f=this._tileContent.getText(I))||void 0===f?void 0:f.content)&&void 0!==v?v:"";E=(await this._indexReadjuster.getReadjustedIndices(i,[E],t,!0))[0]}if(T.children)for(const e of T.children)w>=e.element.offset&&w<e.element.offset+e.element.span&&(_=e,C=w-e.element.offset);if(I.children)for(const e of I.children)E>=e.element.offset&&E<e.element.offset+e.element.span&&(b=e,S=E-e.element.offset)}return{startParentElement:T,endParentElement:I,isCollapsed:n.isCollapsed,selectedText:n.toString(),startPosition:w,endPosition:E,startParagraphNode:_,endParagraphNode:b,startPositionInParagraphNode:C,endPositionInParagraphNode:S}}},this.getParentTileElement=e=>{let t;for(const n of this._proofingDom.tileNodes)this._tileContent.getContainingElement(n)===e&&(t=n);return t||((null==e?void 0:e.parentNode)?this.getParentTileElement(e.parentNode):void 0)}}}var rn=n(13713);let on=class{constructor(e,t,n,r,i){this._proofingDom=e,this.indexReadjuster=t,this.safeWindow=n,this.logger=r,this.targetWindowRef=i,this.attachedToParagraphLevelDivs=!1}getText(e){const t=this.getTextRetriever(e,void 0);if(t)return t.retrieve()}getTextSelection(){return new nn(this._proofingDom,this,this.indexReadjuster,this.targetWindowRef).getTextSelection()}getContainingElement(e){return(0,at.C)(e,"HTMLElement")?e:(t=e)&&"id"in t&&"nodeType"in t&&(0,P.l)(e)?an(e.parent):an(e);var t}async insert(e,t,n,r,i,o,a,s){const l=this.getTextWriter(e,t);if(l)return l.insert(n,r,i,o,a,s)}async replace(e,t,n,r,i,o){const a=this.getTextWriter(e,t);if(a)return a.replace(n,r,i,o)}async remove(e,t,n,r,i,o,a,s){const l=this.getTextWriter(e,t);if(l)return l.remove(n,r,o,a,s,i)}async autoCorrect(e,t,n,r,i,o,a){const s=this.getTextWriter(e,t);if(s)return s.autoCorrect(n,r,i,o,a)}async getCritiqueRanges(e,t,n){const r=null!=t?t:an(e);if(!r)return n.map((e=>({critique:e,range:void 0})));const i=this.getTextNodeRangeBuilder(e,t);return i?i.getCritiqueRanges(r,n):n.map((e=>({critique:e,range:void 0})))}async getRangeOfNode(e,t,n,r){const i=null!=t?t:an(e);if(!i)return;const o=this.getTextNodeRangeBuilder(e,t);return o?o.getRangeOfNode(i,n,r,(0,rn.$)(e)?e.plainText:void 0):void 0}async getNodeInsertionPosition(e,t,n){const r=an(e);if(!r)return;const i=this.getTextNodeRangeBuilder(e,void 0);return i?i.getNodeInsertionPosition(r,t,n):void 0}getTextNodeRangeBuilder(e,t){const n=this.getTextRetriever(e,t);if(n)return new jt((()=>n),this.indexReadjuster)}getTextRetriever(e,t){const n=null!=t?t:an(e);if(!n)return;let r;return r=(0,at.C)(n,"HTMLInputElement")||(0,at.C)(n,"HTMLTextAreaElement")?new Ht(n):this.attachedToParagraphLevelDivs?new Kt(n):new Vt(n),r}getTextWriter(e,t){var n;const r=null!==(n=an(e))&&void 0!==n?n:t,i=this.getTextNodeRangeBuilder(e,t),o=this.getTextRetriever(e,t);if(!r||!i||!o)return;let a;var s,l,d;return l="contenteditable",d="true",a=(s=r).hasAttribute(l)&&s.getAttribute(l)===d||null!==s.closest(`[${l}=${d}]`)?new Xt(i,this.safeWindow,this.logger):(0,at.C)(r,"HTMLInputElement")||(0,at.C)(r,"HTMLTextAreaElement")?new Yt:new en((()=>o)),a.setHtmlElement(r),a}};function an(e){return(0,P.l)(e)?e.parent.element:e.element}on=(0,i.__decorate)([(0,Le._)(),(0,i.__param)(0,(0,Me.W)(ge.w)),(0,i.__param)(1,(0,Me.W)(tn)),(0,i.__param)(2,(0,Me.W)(je.j)),(0,i.__param)(3,(0,Me.W)(m.g)),(0,i.__param)(3,(0,Tt.l)()),(0,i.__param)(4,(0,Me.W)(j.sh)),(0,i.__param)(4,(0,Tt.l)())],on);let sn=class extends on{constructor(e,t,n,r,i){super(e,t,r,n,i),this.attachedToParagraphLevelDivs=!0}};sn=(0,i.__decorate)([(0,Le._)(),(0,i.__param)(0,(0,Me.W)(ge.w)),(0,i.__param)(1,(0,Me.W)(tn)),(0,i.__param)(2,(0,Me.W)(m.g)),(0,i.__param)(3,(0,Me.W)(je.j)),(0,i.__param)(4,(0,Me.W)(j.sh)),(0,i.__param)(4,(0,Tt.l)())],sn);class ln{constructor(e){this.attachedToParagraphLevelDivs=e,this.imports=[]}get uniqueId(){return(0,Je.z)(507918412)}configureRootServices(e){e.bind(F.d).to(this.attachedToParagraphLevelDivs?sn:on),e.bind(d).to(kt)}}let dn=class{retrieveElements(e,t){if(!e.querySelectorAll)return[];const n=t.join(",");return e.querySelector(n)?Array.from(e.querySelectorAll(n)):[]}};dn=(0,i.__decorate)([(0,Le._)()],dn);var un=n(25503),cn=n(90630),gn=n(3327),hn=n(6510),pn=n(95988);function fn(e){switch(e){case pn.fT.Word:return gn.OD.Word;case pn.fT.Sentence:return gn.OD.Sentence;case pn.fT.Paragraph:return gn.OD.Paragraph;default:return gn.OD.Sentence}}function vn(e){return e&&(e.formattedRanges||e.attributionRanges)}function mn(e,t){const n=e.start<t.start?e:t,r=n===e?t:e;if(!(n.end<r.start))return{start:r.start,end:n.end<r.end?n.end:r.end}}function yn(e,t,n){if(!e)return;const r=e.content.substring(t,n);let i;if(e.formattedRanges){i=[];for(const r of e.formattedRanges){const e=mn({start:r.start,end:r.start+r.length},{start:t,end:n});e&&i.push(Object.assign(Object.assign({},r),{start:e.start,length:e.end-e.start}))}}return Object.assign(Object.assign({},e),{content:r,formattedRanges:i})}function _n(e,t,n){const r=[];for(const i of e){const e=i.start+i.length,o=Math.max(t,i.start),a=Math.min(n,e);a<=o||r.push(Object.assign(Object.assign({},i),{start:o,length:a-o}))}return r}function bn(e,t,n){return e.formattedRanges?_n(e.formattedRanges,t,n):[]}function Cn(e,t,n){return{formattedRanges:e.formattedRanges?_n(e.formattedRanges,t,n):[],attributionRanges:e.attributionRanges?_n(e.attributionRanges,t,n):[]}}const Sn=["queryRange","ipPosition","isColdIp","content","formattedRanges","attributionRanges","objectReferences"];function Tn(e,t){if(!e!=!t)return!1;if(!e||!t)return!0;const n=In(e);return!!wn(n,In(e))&&n.every((n=>e[n]===t[n]))}function In(e){return Object.keys(e).filter((e=>!Sn.includes(e)))}function wn(e,t){return!e==!t&&(!e||!t||e.length===t.length&&e.every(((n,r)=>function(e,t){if("string"==typeof e&&"string"==typeof t)return e===t;const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const r of n)if(Array.isArray(e[r])&&Array.isArray(t[r])){if(!wn(e[r],t[r]))return!1}else if(e[r]!==t[r])return!1;return!0}(e[r],t[r]))))}function En(e,t,n,r,i,o,a,s,l,d,u,c,g){var h;let p,f,v=0;const m=null!==(h=null==r?void 0:r.content)&&void 0!==h?h:"",y=i.content,_=o.firstDiffLeft,b=m.length-o.firstDiffRight,C=y.length-o.firstDiffRight,S=function(e,t,n,r,i){return e===t?gn.WI.Update:n===i?gn.WI.Add:r===i?gn.WI.Delete:gn.WI.Update}(m.length,y.length,b,C,_);let T;const I=()=>function(e,t,n,r){if(!r||void 0===t)return;if(void 0===e)return t;if(t.length<e.length||t.length-e.length>2)return t;let i;for(i=0;i<e.length;i++){const n=e[i],r=t[i];if(n.start!==r.start||n.length<r.length||!(0,un.G)(n.attribution,r.attribution))break}return t[i]?t[i].start!==n?t:t.slice(i):[]}(null==r?void 0:r.attributionRanges,i.attributionRanges,_,u);switch(S){case gn.WI.Update:v=b-_,p=y.substring(_,C),T=I(),f=m.substring(_,b);break;case gn.WI.Add:v=0,p=y.substring(_,C),T=I();break;case gn.WI.Delete:v=b-_,f=m.substring(_,b),T=I()}return{message:{tileId:e,tileVersion:t,documentModel:n,delta:new hn.s({deltaType:S,unit:s,position:_,length:v,content:p,wordCount:a,invalidationRanges:c,userInfo:{userType:Dn(d)},attributionRanges:T}),sourceType:l,changeType:d,deletedOrReplacedCharacters:f,tileText:y,wordBoundaries:g},attributionData:u?kn(T,T===i.attributionRanges):void 0}}function xn(e,t,n,r,i){return{tileId:e,tileVersion:t,documentModel:n,delta:vn(i)?new hn.s({deltaType:gn.WI.FormattingUpdate,formattedRanges:i.formattedRanges,attributionRanges:i.attributionRanges}):Array.isArray(i)?new hn.s({deltaType:gn.WI.FormattingUpdate,formattedRanges:i}):new hn.s({deltaType:gn.WI.OtherNonContentUpdate,otherNonContentData:i}),sourceType:r}}function An(e,t){var n;return{tileId:e.id,tileVersion:e.eventSeqId,documentModel:e.documentModel,changeType:e.mutationChangeType,isTextNode:!0,tile:e.content?new cn.Cg(Object.assign(Object.assign({},e.content),{formattedRanges:[...null!==(n=e.content.formattedRanges)&&void 0!==n?n:[],{start:0,length:e.content.content.length,languageId:t}]})):void 0,prevId:e.prevTileId,nextId:e.nextTileId}}function Dn(e){switch(e){case p.Q0.Local:return gn.HS.SessionUser;case p.Q0.Remote:return gn.HS.Collaborator;default:return gn.HS.Programmatic}}function kn(e,t){if(!e||0===e.length)return;const n={deltaType:gn.WI.AttributionUpdate,attributionData:{ranges:e,isFullUpdate:t}},r=new hn.s(n);return(0,p.Bb)(r)?r:n}var Fn=n(85278),Pn=n(30122);let Nn=class{constructor(e,t,n,r,i,o,a){this._hostEmitters=e,this._proofingStore=t,this._featureFlagReader=n,this._logger=r,this._proofingDom=i,this._queryDetection=o,this._nodeTraverser=a,this.tileTracked=new Set}emitTileEvent(e,t,n,r,i,o,a,s,l,d){var u,c;i===h.G.NewData?this.tileTracked.add(t):i===h.G.RemoveData&&(this.tileTracked.delete(t),null===(u=this._queryDetection)||void 0===u||u.handleTileRemoved(t));const g=(0,Fn.F)(e);for(const e of this._hostEmitters)e.emit(M.pD.hostModelTextTile,{address:void 0,message:{messageType:i,data:{tileId:t,tileVersion:r,documentModel:null==g?void 0:g.documentModel,changeType:o,isTextNode:a===mt.Z.ParagraphNode,tile:n?new cn.Cg(Object.assign(Object.assign({},n),{formattedRanges:[...null!==(c=n.formattedRanges)&&void 0!==c?c:[],{start:0,length:n.content.length,languageId:null!=s?s:this.getProofingLanguage()}]})):void 0,prevId:l,nextId:d}}})}emitParagraphDiffEvent(e){this.tileTracked.has(e.paragraphNode.id)||this._featureFlagReader.flags.enableParagraphDeltasVerboseLogging&&this._logger.error(540915291,"Delta event sent when no parent tile node was created."),this.emitDiffEvent(e.paragraphNode,e.oldTextInfo,e.newTextInfo,e.minDiffBounds,e.wordCount,e.deltaUnit,p.pf.ParagraphNode,e.mutationChangeType,e.invalidationRanges)}emitTileDiffEvent(e,t,n,r,i,o,a,s,l){const d=a.unreconciledContent.some((e=>e.textUnit===pn.fT.Paragraph))?gn.OD.Paragraph:a.unreconciledContent.some((e=>e.textUnit===pn.fT.Sentence))?gn.OD.Sentence:i?gn.OD.Word:gn.OD.Chars,u=this.getProofingLanguage(),c=a.unreconciledContent.map((e=>({position:e.header.elementId.offset,length:e.header.elementId.span,unit:fn(e.textUnit),languageId:null!=l?l:u})));this.emitDiffEvent(e,t,n,r,o,d,p.pf.TileNode,s,c)}emitMoveTileEvent(e,t,n,r,i,o,a,s,l){var d;for(const u of this._hostEmitters)u.emit(M.pD.hostModelMoveTextTile,{address:void 0,message:{oldTileId:e,newTileId:t,tileVersion:r,oldDocumentModel:s,newDocumentModel:l,tile:new cn.Cg(Object.assign(Object.assign({},n),{formattedRanges:[...null!==(d=n.formattedRanges)&&void 0!==d?d:[],{start:0,length:n.content.length,languageId:null!=i?i:this.getProofingLanguage()}]})),prevId:o,nextId:a}})}emitParagraphNodeTileEvents(e,t,n,r){const i=(0,Fn.F)(e),o=t.removedNodes.map((t=>{var r;return{messageType:h.G.RemoveData,data:{tileId:t,tileVersion:null!==(r=e.eventSeqId)&&void 0!==r?r:0,documentModel:null==i?void 0:i.documentModel,changeType:n,isTextNode:!0,tile:void 0}}}));o.push(...t.unreconciledContent.map((o=>{var a,s,l;const d=this._proofingDom.findParagraphNode(o.header.elementId.id),u=d?null===(a=this._nodeTraverser)||void 0===a?void 0:a.findPreviousParagraphNode(d):void 0,c=d?null===(s=this._nodeTraverser)||void 0===s?void 0:s.findNextParagraphNode(d):void 0;return{messageType:this._featureFlagReader.flags.enableParagraphUpdates&&!t.addedNodes.includes(o.header.elementId.id)?h.G.ChangeData:h.G.NewData,data:{tileId:o.header.elementId.id,tileVersion:null!==(l=e.eventSeqId)&&void 0!==l?l:0,documentModel:null==i?void 0:i.documentModel,changeType:n,isTextNode:!0,tile:new cn.Cg(Object.assign(Object.assign({},r),{content:o.data,formattedRanges:[{start:0,length:o.data.length,languageId:this.getProofingLanguage(o.proofingLanguages)}]})),prevId:"#head#"===u?u:null==u?void 0:u.id,nextId:"#tail#"===c?c:null==c?void 0:c.id}}})));for(const e of this._hostEmitters)e.emit(M.pD.hostModelParagraphTextTiles,{address:void 0,message:o})}getProofingLanguage(e){return z.I.getDefaultLanguageCode(null!=e?e:this._proofingStore.getCachedEntry(f.l.ProofingLanguages).storeEntryValue)}findAttributionRangesForDelta(e,t,n){if(!this._featureFlagReader.flags.enableAttributionRangeInAddDelta||void 0===t)return;if(void 0===e)return t;if(t.length<e.length||t.length-e.length>2)return t;let r;for(r=0;r<e.length;r++){const n=e[r],i=t[r];if(n.start!==i.start||n.length<i.length||!(0,un.G)(n.attribution,i.attribution))break}return t[r]?t[r].start!==n?t:t.slice(r):[]}createAttributionDelta(e,t){const n={deltaType:gn.WI.AttributionUpdate,attributionData:{ranges:e,isFullUpdate:t}},r=new hn.s(n);return(0,p.Bb)(r)?r:(this._logger.error(506204486,"Delta is not a formatted text tile delta with attribution ranges even though it should be"),n)}emitDiffEvent(e,t,n,r,i,o,a,s,l){var d,u,c,g;const h=null!==(d=null==t?void 0:t.content)&&void 0!==d?d:"",f=n.content,v=r.firstDiffLeft,m=h.length-r.firstDiffRight,y=f.length-r.firstDiffRight,_=h.length===f.length?gn.WI.Update:m===v?gn.WI.Add:y===v?gn.WI.Delete:gn.WI.Update;let b,C,S,T;const I=()=>this.findAttributionRangesForDelta(null==t?void 0:t.attributionRanges,n.attributionRanges,v);switch(_){case gn.WI.Update:b=m-v,C=f.substring(v,y),T=I(),S=h.substring(v,m);break;case gn.WI.Add:b=0,C=f.substring(v,y),T=I();break;case gn.WI.Delete:b=m-v,S=h.substring(v,m),T=I()}let w=new hn.s({deltaType:_,unit:o,position:v,length:b,content:C,wordCount:i,invalidationRanges:l,userInfo:{userType:s===p.Q0.Local?gn.HS.SessionUser:s===p.Q0.Remote?gn.HS.Collaborator:gn.HS.Programmatic}});console.debug("emitDiffEvent sourceType",a,!!this._queryDetection);const E=a===p.pf.ParagraphNode?null===(u=this._queryDetection)||void 0===u?void 0:u.handleTileDelta(e.id,w,f,s,S):void 0;w=Object.assign(Object.assign({},w),E),console.debug("emitDiffEvent delta",w);const x=(0,Fn.F)(e);for(const t of this._hostEmitters)t.emit(M.pD.hostModelDelta,{address:void 0,message:{tileId:e.id,tileVersion:null!==(c=e.eventSeqId)&&void 0!==c?c:0,documentModel:null==x?void 0:x.documentModel,delta:w,sourceType:a,changeType:s,deletedOrReplacedCharacters:S}}),this._featureFlagReader.flags.enableAttributionRangeInAddDelta&&T&&T.length>0&&e.id&&void 0!==e.eventSeqId&&t.emit(M.pD.hostModelAttributionDelta,{address:void 0,message:{tileId:e.id,tileVersion:null!==(g=e.eventSeqId)&&void 0!==g?g:0,documentModel:null==x?void 0:x.documentModel,sourceType:a,delta:this.createAttributionDelta(T,T===n.attributionRanges)}})}emitFormattingDiffEventDeprecated(e,t,n){var r;const i=(0,Fn.F)(e),o=Array.isArray(n)?new hn.s({deltaType:gn.WI.FormattingUpdate,formattedRanges:n}):new hn.s({deltaType:gn.WI.OtherNonContentUpdate,otherNonContentData:n});for(const n of this._hostEmitters)n.emit(M.pD.hostModelFormattingDelta,{address:void 0,message:{tileId:e.id,tileVersion:null!==(r=e.eventSeqId)&&void 0!==r?r:0,documentModel:null==i?void 0:i.documentModel,delta:o,sourceType:t}})}emitFormattingDiffEvent(e,t,n){var r;if(!this._featureFlagReader.flags.enableAttributionRangeExceptionInFormattedTextDeltas)return vn(n)?void this._logger.error(506331489,"Unexpected formatted text range props in deprecated formatted text deltas"):this.emitFormattingDiffEventDeprecated(e,t,n);const i=(0,Fn.F)(e);for(const o of this._hostEmitters)o.emit(M.pD.hostModelFormattingDelta,{address:void 0,message:xn(e.id,null!==(r=e.eventSeqId)&&void 0!==r?r:0,null==i?void 0:i.documentModel,t,n)})}};Nn=(0,i.__decorate)([(0,Le._)(),(0,i.__param)(0,(0,Pn.t)(M.zJ)),(0,i.__param)(1,(0,Me.W)(v.K)),(0,i.__param)(2,(0,Me.W)(q.c)),(0,i.__param)(3,(0,Me.W)(m.g)),(0,i.__param)(4,(0,Me.W)(ge.w)),(0,i.__param)(5,(0,Tt.l)()),(0,i.__param)(5,(0,Me.W)(_.J)),(0,i.__param)(6,(0,Tt.l)()),(0,i.__param)(6,(0,Me.W)(ut.M))],Nn);const Bn=(0,l.f)("ISentenceTextUnitSeparator"),On=(0,l.f)("IParagraphTextUnitSeparator"),Rn=(0,l.f)("IDefaultTextUnitSeparator"),Ln=(0,l.f)("IDocumentTextUnitSeparator"),Mn="[\0-\b\n--\u2028-\u2029  ]",qn="[!-#%-*,-/:-;?-@_{}¡«¬·»¿;·՚-՟։-֊־׀׃׆׳-״؉-؊،-؍؛؞-؟٪-٭۔।-॥॰෴๏๚-๛༄-༒༺-༽྅࿐-࿔၊-၏჻፡-፨᙭-᙮។-៖៘-៚᠀-᠊‐-‧‰-⁃⁅-⁑⁓-⁞、-〃〈-】〔-〟〰〽゠・！-＃％-＊，-／：-；？-＠［-］＿｛｝｟-･]",Wn="[؀-؃۝᠎​-‍⁠-⁤⁪-⁯]",Un="[?!.։۔܁܂।॥።᙮᠃᠉⳹⳾。꓿꘎꛳︒﹒．｡]",zn="[。｡]",jn="[   -   　\t]",Hn="[»’”›\"']",Vn="[)]}༻༽⁆〉》」』】〕〗〙〛〞〟）］｝｠｣]|[☹☺☻]|[​‌]",Gn="[\u2028\u2029\n\r]",Qn=`[.。﹒．｡]{2,6}|[.]([ ][.]){1,5}|([Ａ-Ｚａ-ｚ])[.﹒．]|(${jn}|${Mn}|${qn}|${Wn})((((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]|((([Ｌ]?[Ｘ]{1,3}|[Ｘ][ＬＣ]|[Ｌ])?([Ｖ]?[Ｉ]{1,3}|[Ｉ][ＶＸ]|[Ｖ]))|([Ｌ]?[Ｘ]{1,3}|[Ｘ][ＬＣ]|[Ｌ])|(([ｌ]?[ｘ]{1,3}|[ｘ][ｌｃ]|[ｌ])?([ｖ]?[ｉ]{1,3}|[ｉ][ｖｘ]|[ｖ]))|([ｌ]?[ｘ]{1,3}|[ｘ][ｌｃ]|[ｌ]))[.﹒．]|([0-9]{1,4}[.]|[０-９]{1,4}[.﹒．])|([0-9]+(([aoªºᵃᵒ])|((er)[ao]?)|(([ᵉ][ʳ])[ᵃᵒ]?)|([mdtvn][ao])|([ᵐᵈᵗᵛⁿ][ᵃʳ]))[.]|[A-Za-zÀÄÈÉÔÖÜßàäèéôöü]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-zÀÄÈÉÔÖÜßàäèéôöü]+((STR)|(str))[.]))|(${jn}|${Mn}|${qn}|[$+<=>^\`|~¢£¤¥-©¬®¯°±´¶¸×÷˂-˅˒-˟˥-˫˭˯-˿͵΄΅϶҂؆؇؈؋؎؏۞۩۽۾৲৳৺૱୰௳-௺౿൹฿༁༂༃༓༕༖༗༚-༟༴༶༸྾-࿅࿇-࿌࿎࿏႞႟᎐-᎙៛⁄⁒〄〒〓〠〶〷〾〿゛゜＄＋＜＝＞＾｀｜～￠-￦￨-￮]|${Wn}|[0-9٠-٩۰-۹०-९০-৯੦-੯૦-૯୦-୯௦-௯౦-౯೦-೯൦-൯๐-๙໐-໙༠-༩၀-၉႐-႙០-៩᠐-᠙０-９]|[²³¹¼½¾৴-৹௰௱௲౸-౾൰-൵༪-༳፩-፼៰-៹〇〡-〩〸〹〺])((([A-Za-zªµºÀ-ÐÑ-ÖØ-öø-ƺƼ-ƿǄ-ʓʕ-ͳͶͷͻͼͽΆΈΉΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԣԱ-Ֆա-ևႠ-Ⴥ]|[ƻǀ-ǃʔא-תװױײء-ؿف-يٮٯ-ۓٱەۮۯۺۻۼۿऄ-हऽॐक़-ॡॲॻ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়ৠৡৰৱਅ-ਊਏਐਓ-ਙਚ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-നപ-ഹഽൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜໝༀཀ-ཇཉ-ཬྈ-ྋក-ឳៗៜက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎა-ჺᄀ-ᅙᅟᅠ-ᆢᆨ-ᇹሀ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙶᠠ-ᡷᢀ-ᢨᢪ〆〼가-힣ﾠ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]|[ก-ะาำเ-ๅ])[.])+|(([ぁ-ゖゟァ-ヺヿ豈-鶴侮-頻並-龎ｦ-ﾝ])[.﹒．])+)`,Kn=new RegExp(`${Un}|${zn}`,"ig"),$n=new RegExp(`${Un}|${zn}|${Gn}`,"ig"),Zn=new RegExp(Qn,"g");function Jn(e,t,n=0){const r=[];let i=t.exec(e);for(;null!==i;){if(i[n]){const e=i.index;r.push({begin:e,end:e+i[n].length})}i=t.exec(e)}return r}const Xn=`(${Un}(${Vn}|${Hn}|${jn})*${Gn})`,Yn=`(${Un}(${Vn})*(${jn})+)`,er=`(${zn}(${Vn})*)`,tr=`((${Gn})+)`,nr=`(${Un}(${Vn}|${Hn}|${jn})*(${Gn})+)`,rr=[new RegExp(Xn,"ig"),new RegExp(Yn,"ig"),new RegExp(er,"ig")],ir=[new RegExp(Yn,"ig"),new RegExp(er,"ig"),new RegExp(tr,"ig"),new RegExp(nr,"ig")],or=new RegExp(`${Xn}|${Yn}|${er}`,"ig"),ar=new RegExp(`${Yn}|${er}\n    |${tr}|${nr}`,"ig");let sr=class{constructor(e){this._hostSettings=e}expandEndRange(e){const t=this._hostSettings.newLineSentenceSeparatorEnabled?ir:rr;for(const n of t){const t=Jn(e,n);if(t.length>0&&0===t[0].begin)return t[0].end-1}return this._hostSettings.newLineSentenceSeparatorEnabled?-1:0}isEndPuncSpecialCase(e){const t=Jn(e,Zn),n=this._hostSettings.newLineSentenceSeparatorEnabled?e.length-1:e.length;return t.some((e=>e.end===n))}findBeginBoundary(e,t,n){const r=this._hostSettings.newLineSentenceSeparatorEnabled?$n:Kn,i=e.substring(n,t),o=Jn(i,r);for(let e=o.length-1;e>=0;e-=1){const t=i.substring(0,o[e].end);if(!this.isEndPuncSpecialCase(t)){const t=i.substring(o[e].begin,i.length),r=this.expandEndRange(t);if(this._hostSettings.newLineSentenceSeparatorEnabled?-1===r:!r)continue;return n+o[e].end+r}}return n}findEndBoundary(e,t,n){const r=e.substring(t,n),i=Jn(r,this._hostSettings.newLineSentenceSeparatorEnabled?$n:Kn);for(const e of i){const n=r.substring(0,e.end);if(!this.isEndPuncSpecialCase(n)){const n=r.substring(e.begin,r.length),i=this.expandEndRange(n);if(this._hostSettings.newLineSentenceSeparatorEnabled?-1===i:!i)continue;return t+e.end+i}}return-1}splitInUnits(e){const t=this._hostSettings.newLineSentenceSeparatorEnabled?ar:or;return Jn(e.replace(Zn,(e=>"#".repeat(e.length))),t).map((e=>e.end))}};sr=(0,i.__decorate)([(0,Le._)(),(0,i.__param)(0,(0,Me.W)(Ie.n))],sr);let lr=class{findBeginBoundary(e,t,n){const r=e.lastIndexOf("\n",t-1);return-1===r||r<=n?n:r+1}findEndBoundary(e,t,n){const r=e.indexOf("\n",t+1);return-1===r||r>n?-1:r+1}splitInUnits(e){const t=[];let n=-1;do{n=e.indexOf("\n",n+1),-1!==n&&t.push(n+1)}while(-1!==n);return t}};lr=(0,i.__decorate)([(0,Le._)()],lr);let dr=class{findBeginBoundary(e,t,n){return Math.min(t,n)}findEndBoundary(e,t,n){return e.length<n?-1:Math.max(t,n)}splitInUnits(e){return[e.length]}};dr=(0,i.__decorate)([(0,Le._)()],dr);const ur=(0,l.f)("ITextUnitChunker");let cr=class{constructor(e,t,n){this._sentenceSeparator=e,this._paragraphSeparator=t,this._unitySeparator=n}splitInUnitsFromExtendedBoundaries(e,t,n,r){return gr(e,t,this.getUnitSeparator(n),r)}extendBoundariesFromDiffBounds(e,t,n){return hr(e,t,this.getUnitSeparator(n))}getUnitSeparator(e){switch(e){case pn.fT.Sentence:return this._sentenceSeparator;case pn.fT.Paragraph:return this._paragraphSeparator;default:return this._unitySeparator}}};function gr(e,t,n,r){const i=function(e,t,n,r){if(!n.firstDiffLeft&&!n.firstDiffRight&&!r.offset&&r.span===t.length)return function(e,t){const n=[],r=e.splitInUnits(t);let i=0;for(const e of r)n.push({offset:i,span:e-i,validEndBoundary:-1!==e}),i=e;return(!r.length||r.length&&r[r.length-1]!==t.length)&&n.push({offset:i,span:t.length-i,validEndBoundary:!1}),n}(e,t);const i=t.slice(r.offset,r.offset+r.span),o=n.firstDiffLeft-r.offset,a=n.firstDiffRight-(t.length-r.offset-r.span);let s=0,l=0;const d=[],u=Math.min(i.length,i.length-a+2);do{const t=s;s=e.findEndBoundary(i,Math.max(s,o-2),u),l=-1!==s&&s<u?s:i.length,l-t&&d.push({offset:t+r.offset,span:l-t,validEndBoundary:-1!==s,enforcedCompleteTileTextUnit:r.enforcedCompleteTileTextUnit})}while(l<i.length);return d}(n,e,t,r||hr(e,t,n));return!i.length||i[i.length-1].validEndBoundary&&!1!==i[i.length-1].validEndBoundary||(i[i.length-1]=function(e,t,n){if(!1===t.validEndBoundary&&t.span>=2){let r,i=t.span;do{r=e.slice(t.offset+i-2,t.offset+i),i-=1}while(!/\S/.test(r)&&i>=2);t.validEndBoundary=-1!==n.findEndBoundary(r,0,r.length)}return t}(e,i[i.length-1],n)),i}function hr(e,t,n){let r,i=0,o=e.length,a=t.firstDiffLeft+1;if(e.length)do{if(a-=1,i=n.findBeginBoundary(e,a,0),o=n.findEndBoundary(e,e.length-t.firstDiffRight,e.length),r=-1!==o,o=-1!==o?o:e.length,a<e.length&&i===n.findBeginBoundary(e,a+1,0))continue;let s=i,l=0;for(;s&&a===s+l;){l+=1;const t=s;if(s=n.findBeginBoundary(e,s-1,0),s<t-1){i=s;break}}}while(!(o-i));return{offset:i,span:o-i,validEndBoundary:r}}cr=(0,i.__decorate)([(0,Le._)(),(0,i.__param)(0,(0,Me.W)(Bn)),(0,i.__param)(1,(0,Me.W)(On)),(0,i.__param)(2,(0,Me.W)(Rn))],cr);const pr=(0,l.f)("IWordCount");var fr=n(32942);const vr=(0,l.f)("IWordCountDetector");let mr=class{constructor(e,t){this._wordCount=e,this._hostSettings=t}hasWordCountChanged(e,t,n,r=!1){let i,o=0;r?({wordCount:o,wordBoundaries:i}=this.computeValidWordCountAndBoundariesForRange(n,0,n.length)):o=this.computeValidWordCountForRange(n,0,n.length);const a={isWordCountChanged:!1,wordCount:o,wordBoundaries:i};if(o>0&&0===e.firstDiffLeft&&0===e.firstDiffRight)return a.isWordCountChanged=!0,a;if(e.firstDiffLeft+e.firstDiffRight<=n.length&&this._wordCount.getWordCountInRange(n,e.firstDiffLeft,n.length-e.firstDiffRight)>1)return a.isWordCountChanged=!0,a;if(t>o)return a.isWordCountChanged=!0,a;const s=this.computeValidWordCountForRange(n,0,n.length-e.firstDiffRight);if(0===s)return a.isWordCountChanged=!1,a;const l=this.computeValidWordCountForRange(n,0,e.firstDiffLeft);return a.isWordCountChanged=s>l,a}getWordCount(e){return this.computeValidWordCountForRange(e,0,e.length)}computeValidWordCountForRange(e,t,n){if(t>=n||t<0||n>e.length)return 0;const{wordCount:r,wordBreaks:i}=this._wordCount.getWordCountAndBreaksInRange(e,t,n);return this.correctWordCountForIncompleteWord(i,e.length,r)}computeValidWordCountAndBoundariesForRange(e,t,n){if(t>=n||t<0||n>e.length)return{wordCount:0,wordBoundaries:[]};const{wordCount:r,wordBreaks:i,wordBoundaries:o}=this._wordCount.getWordCountWithBoundariesAndBreaksInRange(e,t,n);return{wordCount:this.correctWordCountForIncompleteWord(i,e.length,r),wordBoundaries:o}}correctWordCountForIncompleteWord(e,t,n){if(n<=0||0===e.length)return 0;const r=e.length-1;return"WhiteSpace"!==e[r].wordBreakType&&(this._hostSettings.newLineSentenceSeparatorEnabled||this._hostSettings.useParagraphAsTileSeparator||"Punctuation"!==e[r].wordBreakType)&&e[r].cp+1<=t?n-1:n}};mr=(0,i.__decorate)([(0,Le._)(),(0,i.__param)(0,(0,Me.W)(pr)),(0,i.__param)(1,(0,Me.W)(Ie.n))],mr);const yr=(0,l.f)("IElementsRetriever"),_r=(0,l.f)("IHostTilingEmitter"),br=(0,l.f)("IParagraphFormattingExtractor"),Cr=(0,l.f)("IParagraphNodeDictionary");let Sr=class{};Sr=(0,i.__decorate)([(0,Le._)()],Sr);const Tr=(0,l.f)("IParagraphNodesEventEmitter");var Ir=n(11966);const wr=(0,l.f)("IPreOrderTraverser"),Er=(0,l.f)("ITerminalNodeDictionary");let xr=class{};xr=(0,i.__decorate)([(0,Le._)()],xr);const Ar=(0,l.f)("ITileNodeDictionary");let Dr=class{};Dr=(0,i.__decorate)([(0,Le._)()],Dr);let kr=class{constructor(e){this._proofingDom=e}getFormattingAt(e,t=0,n=-1){let r=null;if(r="string"==typeof e?this._proofingDom.findParagraphNode(e):e,(0,P.l)(r)){const e=r.parent.textFormattingInfo;if(e){const i=r.element.offset+t;return bn(e,i,n<0?i+r.element.span:i+n)}}}};kr=(0,i.__decorate)([(0,Le._)(),(0,i.__param)(0,(0,Me.W)(ge.w))],kr);const Fr=(0,l.f)("CompleteTileTextUnitToken"),Pr=(0,l.f)("PartialTileTextUnit");let Nr=class{constructor(e,t,n,r,i,o,a,s,l,d,u,c,g){this._proofingPersistedStore=e,this._graphNodeFactory=t,this._textUnitChunker=n,this.settings=r,this._hostSettings=i,this._featureFlagReader=o,this._hostTilingEmitter=a,this._paragraphNodesEventEmitter=s,this._paragraphDeltasEnabled=l,this._logger=d,this.nodeTraverser=u,this._completeTileTextUnit=null!=c?c:r.completeTileTextUnit,this._partialTileTextUnit=null!=g?g:r.partialTileTextUnit}updateParagraphNodes(e,t,n,r,i,o,a){if(!this._hostSettings.enableOrchestration||!this._featureFlagReader.flags.enableParagraphUpdates)return this._updateParagraphNodesDeprecated(e,t,n,r,i);const s={oldTextInfo:t,newTextInfo:n,tileNode:e,sequenceId:i,minDiffBounds:r,graphTransaction:{unreconciledContent:[],addedNodes:[],removedNodes:[],updatedNodes:[]},nodesToAdd:[],nodesToInsert:[],nodesToUpdate:[],nodesToRetire:[],unitRange:void 0};return this._updateExistingChildren(s),this._addNewChildren(s),this._buildGraphTransaction(s,o,a),s.graphTransaction}_updateExistingChildren(e){var t,n,r;if(!(null===(t=e.tileNode.children)||void 0===t?void 0:t.length))return;const i=null!==(r=null===(n=e.oldTextInfo)||void 0===n?void 0:n.content)&&void 0!==r?r:"",o=e.newTextInfo.content,a=i!==o,s={firstDiffLeft:e.minDiffBounds.firstDiffLeft,firstDiffRight:e.minDiffBounds.firstDiffRight};let l=e.tileNode.children.length-1;for(;l>=0;){const t=e.tileNode.children[l].element;if(t){if(i.length-t.offset<e.minDiffBounds.firstDiffRight)t.offset=o.length-i.length+t.offset;else if(t.offset+t.span>=e.minDiffBounds.firstDiffLeft&&(t.offset+t.span!==e.minDiffBounds.firstDiffLeft||!t.validEndBoundary||!a)){t.offset<e.minDiffBounds.firstDiffLeft&&(s.firstDiffLeft=Math.min(t.offset,s.firstDiffLeft));const n=i.length-t.offset-t.span;n<e.minDiffBounds.firstDiffRight&&(s.firstDiffRight=Math.min(n,s.firstDiffRight));const r=e.tileNode.children.splice(l,1);e.nodesToRetire.length&&s.firstDiffRight!==n?s.firstDiffLeft===t.offset?e.nodesToRetire.splice(0,0,...r):e.nodesToRetire.splice(e.nodesToRetire.length-2,0,...r):e.nodesToRetire.push(...r)}l-=1}else l-=1}e.unitRange={offset:s.firstDiffLeft,span:o.length-s.firstDiffRight-s.firstDiffLeft,enforcedCompleteTileTextUnit:!a&&this._hostSettings.enableOptimizedCallingPattern}}_addNewChildren(e){const t=this._textUnitChunker.splitInUnitsFromExtendedBoundaries(e.newTextInfo.content,e.minDiffBounds,this._completeTileTextUnit,e.unitRange);for(const n of t){const t=this._graphNodeFactory(n,e.tileNode);this._attachTextUnit(t),e.nodesToAdd.push(t),e.graphTransaction.unreconciledContent.push(this._buildTile(e.tileNode,t,e.newTextInfo.content,e.sequenceId))}}_attachTextUnit(e){e.element&&(e.element.textUnit=!1===e.element.validEndBoundary&&this._hostSettings.enableOptimizedCallingPattern&&!0!==e.element.enforcedCompleteTileTextUnit?this._partialTileTextUnit:this._completeTileTextUnit)}_buildTile(e,t,n,r){var i,o,a,s,l;const d=null!==(o=null===(i=t.element)||void 0===i?void 0:i.offset)&&void 0!==o?o:0,u=null!==(s=null===(a=t.element)||void 0===a?void 0:a.span)&&void 0!==s?s:n.length;return{header:{nodeId:e.id,seqId:r.toString(),elementId:{id:t.id,offset:d,span:u},length:n.length},data:n.slice(d,d+u),proofingLanguages:this._proofingPersistedStore.getCachedEntry(f.l.ProofingLanguages).storeEntryValue,textUnit:null===(l=t.element)||void 0===l?void 0:l.textUnit}}_convertToUpdate(e,t,n,r,i,o){var a,s;if(!(null==e?void 0:e.element)||!(null==t?void 0:t.element))return;const l=null!==(s=null===(a=n.oldTextInfo)||void 0===a?void 0:a.content)&&void 0!==s?s:"",d=n.newTextInfo.content,u=l.length-e.element.offset-e.element.span,c=d.length-t.element.offset-t.element.span;if(!r&&e.element.offset!==t.element.offset||r&&u!==c)return;const g=this._emitParagraphDeltaUpdate(e,t,n,i,o);return e.element.offset=t.element.offset,e.element.span=t.element.span,e.element.validEndBoundary=t.element.validEndBoundary,e.element.enforcedCompleteTileTextUnit=t.element.enforcedCompleteTileTextUnit,e.element.textUnit=t.element.textUnit,t.retire(),n.nodesToAdd.splice(r?n.nodesToAdd.length-1:0,1),n.nodesToInsert.splice(r?n.nodesToInsert.length-1:0,1,e),n.nodesToRetire.splice(r?n.nodesToRetire.length-1:0,1),n.nodesToUpdate.push(e),n.graphTransaction.unreconciledContent.find((n=>{const r=n.header.elementId.id===t.id;return r&&(n.header.elementId.id=e.id),r})),g}_buildGraphTransaction(e,t,n){e.nodesToInsert=[...e.nodesToAdd];const r=this._convertToUpdate(e.nodesToRetire[0],e.nodesToAdd[0],e,!1,t,n),i=this._convertToUpdate(e.nodesToRetire[e.nodesToRetire.length-1],e.nodesToAdd[e.nodesToAdd.length-1],e,!0,t,n);Br(e.tileNode,e.nodesToInsert),this._emitParagraphDeltaAdd(e,t),this._emitParagraphDeltaRetire(e,t);for(const t of e.nodesToRetire)t.retire();r&&this._hostTilingEmitter.emitParagraphDiffEvent(r),i&&this._hostTilingEmitter.emitParagraphDiffEvent(i),e.graphTransaction.addedNodes=e.nodesToAdd.map((e=>e.id)),e.graphTransaction.removedNodes=e.nodesToRetire.map((e=>e.id)),e.graphTransaction.updatedNodes=e.nodesToUpdate.map((e=>e.id))}_updateParagraphNodesDeprecated(e,t,n,r,i){var o;const a={unreconciledContent:[],addedNodes:[],removedNodes:[],updatedNodes:[]},s=this._updateExistingChildrenDeprecated(e,null!==(o=null==t?void 0:t.content)&&void 0!==o?o:"",n.content,r,a);return this._addNewChildrenDeprecated(e,n,r,i,s,a)}_updateExistingChildrenDeprecated(e,t,n,r,i){var o;if(null===(o=e.children)||void 0===o?void 0:o.length){const o=Object.assign({},r),a=t!==n;let s=e.children.length-1;for(;s>=0;){const l=e.children[s].element;if(l)if(l.offset<r.firstDiffLeft&&l.offset+l.span<r.firstDiffLeft||l.offset+l.span===r.firstDiffLeft&&l.validEndBoundary&&a);else if(t.length-l.offset<r.firstDiffRight)l.offset=n.length-t.length+l.offset,i.updatedNodes.push(e.children[s].id);else{l.offset<r.firstDiffLeft&&(o.firstDiffLeft=Math.min(l.offset,o.firstDiffLeft));const n=t.length-l.offset-l.span;n<r.firstDiffRight&&(o.firstDiffRight=Math.min(n,o.firstDiffRight));const a=e.children.splice(s,1);for(const e of a)i.removedNodes.push(e.id),e.retire()}s-=1}return{offset:o.firstDiffLeft,span:n.length-o.firstDiffRight-o.firstDiffLeft,enforcedCompleteTileTextUnit:!a&&this._hostSettings.enableOptimizedCallingPattern}}}_addNewChildrenDeprecated(e,t,n,r,i,o){const a=this._textUnitChunker.splitInUnitsFromExtendedBoundaries(t.content,n,this._completeTileTextUnit,i),s=[];for(const n of a){const i=this._graphNodeFactory(n,e);this._attachTextUnit(i),s.push(i),o.unreconciledContent.push(this._buildTile(e,i,t.content,r)),o.addedNodes.push(i.id)}return Br(e,s),o}_emitParagraphDeltaUpdate(e,t,n,r,i){if(this._paragraphDeltasEnabled.check()){if(!e.element||!t.element)return;const o=yn(n.oldTextInfo,e.element.offset,e.element.offset+e.element.span),a=yn(n.newTextInfo,t.element.offset,t.element.offset+t.element.span);if(e.registered||this._emitParagraphAdd(n,e,r),void 0!==e.eventSeqId){e.eventSeqId+=1;const n=this._paragraphNodesEventEmitter.generateDeltaEventInformation(e,o,a,!!t.element.validEndBoundary,!!t.element.enforcedCompleteTileTextUnit,r,i,e.cachedWordCount);return e.cachedWordCount=n.wordCount,n}}}_emitParagraphDeltaAdd(e,t){if(this._paragraphDeltasEnabled.check())for(const n of e.nodesToAdd)this._emitParagraphAdd(e,n,t)}_emitParagraphAdd(e,t,n){var r,i;if(t.registered)return void(this._featureFlagReader.flags.enableParagraphDeltasVerboseLogging&&this._logger.info(539002012,"The node has been registered, skipping"));const o=this._featureFlagReader.flags.enableParagraphDeltasEmptyInitialTile&&n===p.Q0.Local;if(t.element){const a=yn(e.newTextInfo,t.element.offset,t.element.offset+t.element.span);t.eventSeqId=0;const s=null===(r=this.nodeTraverser)||void 0===r?void 0:r.findPreviousParagraphNode(t),l=null===(i=this.nodeTraverser)||void 0===i?void 0:i.findNextParagraphNode(t);this._hostTilingEmitter.emitTileEvent(e.tileNode,t.id,Object.assign(Object.assign({},a),{content:o?"":a.content,attributionRanges:o?[]:a.attributionRanges}),t.eventSeqId,h.G.NewData,n,mt.Z.ParagraphNode,this.getSpecifiedLocaleForNode(t),"#head#"===s?s:null==s?void 0:s.id,"#tail#"===l?l:null==l?void 0:l.id),o&&(t.eventSeqId+=1,this._hostTilingEmitter.emitParagraphDiffEvent(this._paragraphNodesEventEmitter.generateDeltaEventInformation(t,void 0,a,!!t.element.validEndBoundary,!0,n,!1,0))),t.registered=!0}else this._featureFlagReader.flags.enableParagraphDeltasVerboseLogging&&this._logger.error(539002013,"Anchor element is undefined for the node to add")}_emitParagraphDeltaRetire(e,t){var n;if(this._paragraphDeltasEnabled.check())for(const r of e.nodesToRetire)r.registered=!1,this._hostTilingEmitter.emitTileEvent(e.tileNode,r.id,{content:""},null!==(n=r.eventSeqId)&&void 0!==n?n:0,h.G.RemoveData,t,mt.Z.ParagraphNode,this.getSpecifiedLocaleForNode(r))}getSpecifiedLocaleForNode(e){var t,n;return null!==(t=e.specifiedLocale)&&void 0!==t?t:null===(n=e.parent)||void 0===n?void 0:n.specifiedLocale}};function Br(e,t){if(t.length&&e.children&&t[0].element){const n=t[0].element.offset;if(e.children.length){let r=e.children.length-1,i=t;for(;r>=0;){const t=e.children[r].element;if(t&&n>t.offset){e.children.splice(r,0,...i),i=[];break}r-=1}i.length&&e.children.splice(0,0,...i)}else e.children=t}}Nr=(0,i.__decorate)([(0,Le._)(),(0,i.__param)(0,(0,Me.W)(v.K)),(0,i.__param)(1,(0,Me.W)(ot)),(0,i.__param)(2,(0,Me.W)(ur)),(0,i.__param)(3,(0,Me.W)(st.k)),(0,i.__param)(4,(0,Me.W)(Ie.n)),(0,i.__param)(5,(0,Me.W)(q.c)),(0,i.__param)(6,(0,Me.W)(_r)),(0,i.__param)(7,(0,Me.W)(Tr)),(0,i.__param)(8,(0,Me.W)(Ge.H)),(0,i.__param)(9,(0,Me.W)(m.g)),(0,i.__param)(10,(0,Me.W)(ut.M)),(0,i.__param)(10,(0,Tt.l)()),(0,i.__param)(11,(0,Tt.l)()),(0,i.__param)(11,(0,Me.W)(Fr)),(0,i.__param)(12,(0,Tt.l)()),(0,i.__param)(12,(0,Me.W)(Pr))],Nr);var Or=n(24546);let Rr=class{constructor(e,t,n){this._wordCountDetector=e,this._hostModelSettings=t,this._textUnitChunker=n}generateDeltaEventInformation(e,t,n,r,i,o,a,s){var l;const d=null!==(l=null==t?void 0:t.content)&&void 0!==l?l:"",u=n.content,c=Or.CC(d,u);a&&(c.firstDiffLeft-=1);let g=!1;if(!r&&this._hostModelSettings.partialTileTextUnit!==pn.fT.Phrase&&this._hostModelSettings.partialTileTextUnit!==this._hostModelSettings.completeTileTextUnit){const e=c.firstDiffLeft,t=u.length-c.firstDiffRight;g=-1!==this._textUnitChunker.getUnitSeparator(this._hostModelSettings.partialTileTextUnit).findEndBoundary(u,e-1,t)}const h=null!=s?s:this._wordCountDetector.getWordCount(d),p=this._wordCountDetector.hasWordCountChanged(c,h,u),f=i?fn(this._hostModelSettings.completeTileTextUnit):g?fn(this._hostModelSettings.partialTileTextUnit):p.isWordCountChanged?r?fn(this._hostModelSettings.completeTileTextUnit):gn.OD.Word:gn.OD.Chars;let v;if(this._hostModelSettings.completeTileTextUnit===pn.fT.Paragraph&&this._hostModelSettings.partialTileTextUnit===pn.fT.Sentence&&f!==gn.OD.Paragraph){const e=c.firstDiffLeft,t=this._textUnitChunker.getUnitSeparator(this._hostModelSettings.partialTileTextUnit),n=t.findBeginBoundary(u,e,0),r=t.findEndBoundary(u,e-1,u.length);v=[{position:n,length:(-1===r?u.length:r)-n,unit:gn.OD.Sentence}]}return{paragraphNode:e,oldTextInfo:t,newTextInfo:n,minDiffBounds:c,wordCount:p.wordCount,deltaUnit:f,mutationChangeType:o,invalidationRanges:v}}};Rr=(0,i.__decorate)([(0,Le._)(),(0,i.__param)(0,(0,Me.W)(vr)),(0,i.__param)(1,(0,Me.W)(st.k)),(0,i.__param)(2,(0,Me.W)(ur))],Rr);var Lr=n(38383);let Mr=class{constructor(){this._rootNodes=[]}rootAtNodes(e){this._rootNodes=e}*getIterator(){var e;if(this._rootNodes.length){const t=[];for(t.push(...this._rootNodes);t.length;){const n=t.pop();yield n,(null===(e=null==n?void 0:n.children)||void 0===e?void 0:e.length)&&t.push(...n.children)}}yield}};Mr=(0,i.__decorate)([(0,Le._)()],Mr);let qr=class{constructor(){this._contexts=[]}get rootNodes(){return this._contexts}addRootNode(e){this._contexts.push(e)}clear(){this._contexts=[]}};function Wr(e,t){if(!t)return;const n={nodeType:mt.Z.TileNode,id:e.id,parent:t.parent,element:t.element,children:void 0,critiques:[],textFormattingInfo:e.cachedText,plainText:e.cachedText.content,pullText:()=>e.cachedText,retire:()=>e.retire,resetState:()=>e.resetState,reconcile:(t,n,r,i,o,a)=>e.reconcile({text:e.cachedText,mutationChangeType:t,rehydrateCritiques:i,forceTileDiffEmission:o,mutationWasTextReplacement:a,brokerOptions:{critiques:n,forceReflow:r}}),move:(t,r)=>(e.move(),n),getPreviousTileId:()=>e.previousNodeId,getNextTileId:()=>e.nextNodeId};return e.children.length>0&&(n.children=e.children.map((e=>Ur(e,n)))),n}function Ur(e,t){const n={nodeType:mt.Z.ParagraphNode,id:e.id,element:e.range,parent:t,children:void 0,eventSeqId:e.eventSeqId,retire:()=>e.retire,move:()=>(e.move(),n),resetState:()=>{}};return n}qr=(0,i.__decorate)([(0,Le._)()],qr);let zr=class{constructor(e){this._hostEmitter=e,this._tileNodeDictionary={},this._terminalNodeDictionary={},this._paragraphNodeDictionary={},this._preOrderTraverser=new Mr}get shadowGraph(){return this._shadowGraph}registerNode(e){const t=this._selectDictionary(e.nodeType);t&&(t[e.id]=e)}unregisterNode(e){const t=this._selectDictionary(e.nodeType);t&&delete t[e.id]}findNode(e){var t,n;return(null!==(n=null!==(t=this.findParagraphNode(e))&&void 0!==t?t:this.findTileNode(e))&&void 0!==n?n:this.findTerminalNode(e))||(this.ensureCanFindNode()?this._iterateGraph(e):null)}findTileNode(e){var t;return null!==(t=this.findTileRootNode(e))&&void 0!==t?t:this._tileNodeDictionary[e]}get tileNodes(){const e=Object.values(this._tileNodeDictionary);if(!this._paragraphFinder)return e;const t=[];for(const n of e){const e=this.findTileRootNode(n.id);e?t.push(e):t.push(n)}return t}findParagraphNode(e){var t;return null!==(t=this.findTextTileNode(e))&&void 0!==t?t:this._paragraphNodeDictionary[e]}findTerminalNode(e){return this._terminalNodeDictionary[e]}getTileNodeV2Paragraphs(e){var t;const n=null===(t=this._paragraphFinder)||void 0===t?void 0:t.getTileNodeParagraphs(e.id);return n?n.map((t=>Ur(t,e))):null}addNode(e){var t;if(e.parent){const t=this.findNode(e.parent.id);t&&(t.children||(t.children=[]),t.children.push(e))}else{this._shadowGraph||(this._shadowGraph=new qr),this._shadowGraph.rootNodes.push(e);const n=this._selectDictionary(e.nodeType);n&&(n[e.id]=e),null===(t=this._hostEmitter)||void 0===t||t.emit(M.pD.hostModelAddedRootNode,{address:void 0,message:e.id})}}removeNode(e){var t;if(!this.findNode(e.id))return;let n,r=!1;if(e.parent?n=e.parent.children:this._shadowGraph&&(n=this._shadowGraph.rootNodes,r=!0),r){const n=this._selectDictionary(e.nodeType);n&&delete n[e.id],null===(t=this._hostEmitter)||void 0===t||t.emit(M.pD.hostModelRemovedRootNode,{address:void 0,message:e.id})}!function(e,t){if(t){const n=t.indexOf(e);if(-1!==n)t.splice(n,1)}}(e,n),e.retire()}async initialize(){}shutDown(){var e;this.retireAllShadowGraphRootNodes(),null===(e=this._shadowGraph)||void 0===e||e.clear()}_selectDictionary(e){switch(e){case mt.Z.TileNode:return this._tileNodeDictionary;case mt.Z.ParagraphNode:return this._paragraphNodeDictionary;case mt.Z.TerminalNode:return this._terminalNodeDictionary;default:return}}ensureCanFindNode(){return!!this._shadowGraph&&(this._preOrderTraverser.rootAtNodes(this._shadowGraph.rootNodes),!0)}retireAllShadowGraphRootNodes(){if(this._shadowGraph)for(const e of this._shadowGraph.rootNodes)e.retire()}_iterateGraph(e){const t=this._preOrderTraverser.getIterator();let n=t.next();for(;!n.done;){if(n.value&&n.value.id===e)return n.value;n=t.next()}return null}setTextProcessingParagraphFinder(e){this._paragraphFinder=e}findTileRootNode(e){var t;if(!this._paragraphFinder)return null;const n=this._paragraphFinder.getTileRootNodeById(e);return n&&null!==(t=Wr(n,this._tileNodeDictionary[e]))&&void 0!==t?t:null}findTextTileNode(e){if(!this._paragraphFinder)return null;const t=this._paragraphFinder.findParagraph(e);if(!t)return null;let n;if(t.parent){const e=this._tileNodeDictionary[t.parent.id];n=Wr(t.parent,e)}return Ur(t,n)}};zr=(0,i.__decorate)([(0,Le._)(),(0,i.__param)(0,(0,Tt.l)()),(0,i.__param)(0,(0,Me.W)(M.M5))],zr);let jr=class{isTileNode(e){return e.nodeType===mt.Z.TileNode}reconcile(e,t,n,r,i,o,a){return e.reconcile(t,n,!!r,!!i,!!o,!!a)}critiques(e){return e.critiques}getPreviousTileId(e){return e.getPreviousTileId()}getNextTileId(e){return e.getNextTileId()}};jr=(0,i.__decorate)([(0,Le._)()],jr);let Hr=class{constructor(e,t,n,r){this._hostEmitters=e,this._nodePoller=t,this._proofingDom=n,this._queryDetection=r,this.rehydrateTiles=e=>{const t=e.message;if(t.length>0)for(const e of t){const t=this._proofingDom.findTileNode(e);null==t||t.resetState()}else for(const e of this._proofingDom.tileNodes)e.resetState();this._nodePoller.pollNodes(h.G.NewData,this._proofingDom.tileNodes,p.Q0.Code,void 0,!0)}}async initialize(){for(const e of this._hostEmitters)e.on(M.pD.hostModelRehydrateTiles,this._handleRehydrate.bind(this))}shutDown(){}_handleRehydrate(e){this._queryDetection?this._queryDetection.handleAugloopReconnection((()=>{this.rehydrateTiles(e)})):this.rehydrateTiles(e)}};Hr=(0,i.__decorate)([(0,Le._)(),(0,i.__param)(0,(0,Pn.t)(M.zJ)),(0,i.__param)(1,(0,Me.W)(S.G)),(0,i.__param)(2,(0,Me.W)(ge.w)),(0,i.__param)(3,(0,Tt.l)()),(0,i.__param)(3,(0,Me.W)(_.J))],Hr);var Vr=n(40245);const Gr=(0,l.f)("IConditionalAttributeFilterFactory");class Qr{constructor(e){this.filters=e,this.attributeList=Array.from(e.keys())}shouldProofElement(e){let t=!1;return this.filters.forEach((n=>{t=t||n(e)})),!t}}const Kr=(0,l.f)("IShadowGraphFactory");var $r=n(96865),Zr=n(36857),Jr=n(77789);const Xr=(0,l.f)("ITextProcessingControllerFactory"),Yr=(0,l.f)("ITextAugmentationProcessingControllerFactory");(0,l.f)("ITextProcessingControllerLegacyWrapper");let ei=class{constructor(e,t,n,r,i,o,a,s,l,d,u,c){this.proofingEmitter=e,this.proofingDom=t,this._textProcessorCoreFactory=n,this._textAugmentationCoreFactory=r,this._hostModelSettings=i,this._textEventPublisher=o,this._hostEmitters=a,this._featureFlagsReader=s,this._hostSettings=l,this._paragraphDeltasEnabled=d,this._queryDetection=u,this._wordDictionary=c,this.handleTextChangeEvent=e=>{this.textProcessingController.pushText(e.data,e.messageType)},this.handleTextStyleChangeEvent=()=>{this.proofingEmitter.emit("recomputeSquiggles")},this.initializeTextProcessingController=()=>{const e=this._textProcessorCoreFactory();return e.subscribe("critiquesAvailable",this._critiquesAvailableHandler),e.subscribe("clearTiles",this._clearTilesHandler),e.subscribe("tilesAvailable",this._tilesAvailableHandler),e.subscribe("stateReset",this._tileStateResetHandler),e.subscribe("tilingEvent",this._tilingEventHandler),e.subscribe("handleRemovedNodes",this._handleRemovedNodesHandler),this.proofingDom.setTextProcessingParagraphFinder(e.getParagraphFinder()),e},this.initializeTextAugmentationCore=()=>{const e=this.textProcessingController.getParagraphFinder(),t=this._textAugmentationCoreFactory(e);return t.subscribe("critiquesReceived",this._onCritiquesReceived),t.subscribe("clearTiles",this._handleOnRemoveTiles),t.subscribe("userRevertedAutoCorrection",this._handleUserRevertedAutoCorrection),t},this._tilingEventHandler=async e=>this.textAugmentationController.processTilingMessage(e),this._tileStateResetHandler=e=>{for(const t of this._hostEmitters)t.emit(M.pD.hostModelTileStateReset,{address:void 0,message:e.tileNodeId})},this._handleOnRemoveTiles=e=>{const t=e.tiles.map((e=>({tileId:e.header,supportedActions:0,suggestions:[],start:0,length:0,priority:0,languageId:""})));this.proofingEmitter.emit("critiqueEvent",{data:t,messageType:h.G.RemoveData})},this._onCritiquesReceived=e=>{if(e.tileId)return void this.textProcessingController.processTileCritiques({tileNodeId:e.tileId,critiques:e.critiques,messageType:0===e.critiques.length?h.G.RemoveData:h.G.ChangeData});const t=(0,$r.PD)(e.critiques);for(const e of t.keys()){const n=t.get(e);this.textProcessingController.processTileCritiques({tileNodeId:e,critiques:null!=n?n:[],messageType:0===(null==n?void 0:n.length)?h.G.RemoveData:h.G.ChangeData})}},this._critiquesAvailableHandler=e=>{const t=this.proofingDom.findNode(e.tileNodeId);t&&this.proofingEmitter.emit("squiggleDataEvent",{messageType:e.messageType,data:{critiquesToElementsMap:[{elementId:e.tileNodeId,element:t.element,critiques:e.critiques.map(Zr.OE)}]}})},this._clearTilesHandler=e=>{this._handleOnRemoveTiles({tiles:e})},this._handleUserRevertedAutoCorrection=e=>{(0,Jr.yf)(e.critique,this._wordDictionary)},this._tilesAvailableHandler=async e=>{const{schedulerDefaultWaitingTime:t,schedulerDefaultWaitingTimeIncrement:n,schedulerDefaultMaxTime:r}=this._hostModelSettings;this._proofingTimeout&&(window.clearTimeout(this._proofingTimeout),this._proofingTimeout=void 0,this._timeoutLength||(this._timeoutLength=t),this._timeoutLength=Math.min(this._timeoutLength+n,r)),this._proofingTimeout=window.setTimeout((async()=>{this._timeoutLength=t,await this.textAugmentationController.processTilingMessage(Object.assign({messageName:"textTilesMessage"},e)),this._proofingTimeout=void 0}),this._timeoutLength)},this._onFeatureFlagsChanged=e=>{const t=Object.assign(Object.assign(Object.assign(Object.assign({},e),this._hostModelSettings),this._hostSettings),{paragraphDeltasEnabled:this._paragraphDeltasEnabled.check()});this.textProcessingController.updateSettings(t)},this._handleRemovedNodesHandler=e=>{if(this._queryDetection)for(const t of e.nodesToRetire)this._queryDetection.handleTileRemoved(t)}}async initialize(){this._textEventPublisher.subscribe("textChange",this.handleTextChangeEvent),this._textEventPublisher.subscribe("styleChange",this.handleTextStyleChangeEvent),this._featureFlagsReader.subscribe("flagsChanged",this._onFeatureFlagsChanged)}shutDown(){var e,t,n,r,i,o,a,s,l;this._textEventPublisher.unsubscribe("textChange",this.handleTextChangeEvent),this._textEventPublisher.unsubscribe("styleChange",this.handleTextStyleChangeEvent),this._featureFlagsReader.unsubscribe("flagsChanged",this._onFeatureFlagsChanged),null===(e=this._textAugmentationController)||void 0===e||e.unsubscribe("critiquesReceived",this._onCritiquesReceived),null===(t=this._textAugmentationController)||void 0===t||t.unsubscribe("clearTiles",this._handleOnRemoveTiles),null===(n=this._textAugmentationController)||void 0===n||n.unsubscribe("userRevertedAutoCorrection",this._handleUserRevertedAutoCorrection),null===(r=this._textProcessingController)||void 0===r||r.unsubscribe("critiquesAvailable",this._critiquesAvailableHandler),null===(i=this._textProcessingController)||void 0===i||i.unsubscribe("clearTiles",this._clearTilesHandler),null===(o=this._textProcessingController)||void 0===o||o.unsubscribe("tilesAvailable",this._tilesAvailableHandler),null===(a=this._textProcessingController)||void 0===a||a.unsubscribe("stateReset",this._tileStateResetHandler),null===(s=this._textProcessingController)||void 0===s||s.unsubscribe("tilingEvent",this._tilingEventHandler),null===(l=this._textProcessingController)||void 0===l||l.unsubscribe("handleRemovedNodes",this._handleRemovedNodesHandler)}setProofingLanguages(e){this.textProcessingController.setProofingLanguages(e)}async pushText(e,t){return this.textProcessingController.pushText(e,t)}get textProcessingController(){return this._textProcessingController||(this._textProcessingController=this.initializeTextProcessingController()),this._textProcessingController}get textAugmentationController(){return this._textAugmentationController||(this._textAugmentationController=this.initializeTextAugmentationCore()),this._textAugmentationController}};ei=(0,i.__decorate)([(0,Le._)(),(0,i.__param)(0,(0,Me.W)(U.o)),(0,i.__param)(1,(0,Me.W)(ge.w)),(0,i.__param)(2,(0,Me.W)(Xr)),(0,i.__param)(3,(0,Me.W)(Yr)),(0,i.__param)(4,(0,Me.W)(st.k)),(0,i.__param)(5,(0,Me.W)(ft.n)),(0,i.__param)(6,(0,Pn.t)(M.zJ)),(0,i.__param)(7,(0,Me.W)(q.c)),(0,i.__param)(8,(0,Me.W)(Ie.n)),(0,i.__param)(9,(0,Me.W)(Ge.H)),(0,i.__param)(10,(0,Tt.l)()),(0,i.__param)(10,(0,Me.W)(_.J)),(0,i.__param)(11,(0,Tt.l)()),(0,i.__param)(11,(0,Me.W)(he.s))],ei);let ti=class extends _t{constructor(e,t,n,r,i){super(mt.Z.OutlineNode,e,t,n,r,i),this._observer=e,this.element&&this._observer.observe(this.element)}move(e,t){return super.move(e,t),this.element&&this._observer.observe(this.element),this}};ti=(0,i.__decorate)([(0,Le._)()],ti);var ni=n(19718),ri=n(67005);class ii{constructor(e,t){this.id=(0,yt.h)(),this.range=e,this.parent=t,t.registerChild(this)}retire(){var e;null===(e=this.parent)||void 0===e||e.unregisterChild(this),this.parent=void 0}move(e,t){return e&&(this.range=e),t&&(this.parent=t),this.id=(0,yt.h)(),this}}function oi(e,t=!1){switch(e){case pn.fT.Sentence:return new sr({newLineSentenceSeparatorEnabled:t});case pn.fT.Paragraph:return new lr;default:return new dr}}class ai extends ni.z{constructor(e,t){super(),this._settings=e,this._logger=t}updateSettings(e){this._settings=e}updateParagraphNodes(e,t,n,r,i,o,a){if(!this._settings.enableOrchestration||!this._settings.enableParagraphUpdates)return this._updateParagraphNodesDeprecated(e,t,n,r,i);const s={oldTextInfo:t,newTextInfo:n,tileNode:e,sequenceId:i,minDiffBounds:r,graphTransaction:{unreconciledContent:[],addedNodes:[],removedNodes:[],updatedNodes:[]},nodesToAdd:[],nodesToInsert:[],nodesToUpdate:[],nodesToRetire:[],unitRange:void 0};return this._updateExistingChildren(s),this._addNewChildren(s),this._buildGraphTransaction(s,o,a),s.graphTransaction}_updateExistingChildren(e){var t,n;if(!e.tileNode.children.length)return;const r=null!==(n=null===(t=e.oldTextInfo)||void 0===t?void 0:t.content)&&void 0!==n?n:"",i=e.newTextInfo.content,o=r!==i,a={firstDiffLeft:e.minDiffBounds.firstDiffLeft,firstDiffRight:e.minDiffBounds.firstDiffRight};let s=e.tileNode.children.length-1;for(;s>=0;){const t=e.tileNode.children[s].range;if(r.length-t.offset<e.minDiffBounds.firstDiffRight)t.offset=i.length-r.length+t.offset;else if(t.offset+t.span>=e.minDiffBounds.firstDiffLeft&&(t.offset+t.span!==e.minDiffBounds.firstDiffLeft||!t.validEndBoundary||!o)){t.offset<e.minDiffBounds.firstDiffLeft&&(a.firstDiffLeft=Math.min(t.offset,a.firstDiffLeft));const n=r.length-t.offset-t.span;n<e.minDiffBounds.firstDiffRight&&(a.firstDiffRight=Math.min(n,a.firstDiffRight));const i=e.tileNode.children.splice(s,1);e.nodesToRetire.length&&a.firstDiffRight!==n?a.firstDiffLeft===t.offset?e.nodesToRetire.splice(0,0,...i):e.nodesToRetire.splice(e.nodesToRetire.length-2,0,...i):e.nodesToRetire.push(...i)}s-=1}e.unitRange={offset:a.firstDiffLeft,span:i.length-a.firstDiffRight-a.firstDiffLeft,enforcedCompleteTileTextUnit:!o&&this._settings.enableOptimizedCallingPattern}}_addNewChildren(e){const t=gr(e.newTextInfo.content,e.minDiffBounds,oi(this._settings.completeTileTextUnit,this._settings.newLineSentenceSeparatorEnabled),e.unitRange);for(const n of t){const t=new ii(n,e.tileNode);this._attachTextUnit(t),e.nodesToAdd.push(t),e.graphTransaction.unreconciledContent.push(this._buildTile(e.tileNode,t,e.newTextInfo.content,e.sequenceId))}}_attachTextUnit(e){e.range.textUnit=(!1===e.range.validEndBoundary&&this._settings.enableOptimizedCallingPattern&&e.range.enforcedCompleteTileTextUnit,this._settings.completeTileTextUnit)}_buildTile(e,t,n,r){const i=t.range.offset,o=t.range.span;return{header:{nodeId:e.id,seqId:r.toString(),elementId:{id:t.id,offset:i,span:o},length:n.length},data:n.slice(i,i+o),proofingLanguages:this._settings.proofingLanguages,textUnit:t.range.textUnit}}_convertToUpdate(e,t,n,r,i,o){var a,s;if(!(null==e?void 0:e.range)||!(null==t?void 0:t.range))return;const l=null!==(s=null===(a=n.oldTextInfo)||void 0===a?void 0:a.content)&&void 0!==s?s:"",d=n.newTextInfo.content,u=l.length-e.range.offset-e.range.span,c=d.length-t.range.offset-t.range.span;if(!r&&e.range.offset!==t.range.offset||r&&u!==c)return;const g=this._emitParagraphDeltaUpdate(e,t,n,i,o);return e.range.offset=t.range.offset,e.range.span=t.range.span,e.range.validEndBoundary=t.range.validEndBoundary,e.range.enforcedCompleteTileTextUnit=t.range.enforcedCompleteTileTextUnit,e.range.textUnit=t.range.textUnit,t.retire(),n.nodesToAdd.splice(r?n.nodesToAdd.length-1:0,1),n.nodesToInsert.splice(r?n.nodesToInsert.length-1:0,1,e),n.nodesToRetire.splice(r?n.nodesToRetire.length-1:0,1),n.nodesToUpdate.push(e),n.graphTransaction.unreconciledContent.find((n=>{const r=n.header.elementId.id===t.id;return r&&(n.header.elementId.id=e.id),r})),g}_buildGraphTransaction(e,t,n){e.nodesToInsert=[...e.nodesToAdd];const r=this._convertToUpdate(e.nodesToRetire[0],e.nodesToAdd[0],e,!1,t,n),i=this._convertToUpdate(e.nodesToRetire[e.nodesToRetire.length-1],e.nodesToAdd[e.nodesToAdd.length-1],e,!0,t,n);si(e.tileNode,e.nodesToInsert),this._emitParagraphDeltaAdd(e,t),this._emitParagraphDeltaRetire(e,t);for(const t of e.nodesToRetire)t.retire();r&&this.publishEvent("deltaEvent",r),i&&this.publishEvent("deltaEvent",i),e.graphTransaction.addedNodes=e.nodesToAdd.map((e=>e.id)),e.graphTransaction.removedNodes=e.nodesToRetire.map((e=>e.id)),e.graphTransaction.updatedNodes=e.nodesToUpdate.map((e=>e.id))}_updateParagraphNodesDeprecated(e,t,n,r,i){var o;const a={unreconciledContent:[],addedNodes:[],removedNodes:[],updatedNodes:[]},s=this._updateExistingChildrenDeprecated(e,null!==(o=null==t?void 0:t.content)&&void 0!==o?o:"",n.content,r,a);return this._addNewChildrenDeprecated(e,n,r,i,s,a)}_updateExistingChildrenDeprecated(e,t,n,r,i){if(e.children.length){const o=Object.assign({},r),a=t!==n;let s=e.children.length-1;for(;s>=0;){const l=e.children[s].range;if(l.offset<r.firstDiffLeft&&l.offset+l.span<r.firstDiffLeft||l.offset+l.span===r.firstDiffLeft&&l.validEndBoundary&&a);else if(t.length-l.offset<r.firstDiffRight)l.offset=n.length-t.length+l.offset,i.updatedNodes.push(e.children[s].id);else{l.offset<r.firstDiffLeft&&(o.firstDiffLeft=Math.min(l.offset,o.firstDiffLeft));const n=t.length-l.offset-l.span;n<r.firstDiffRight&&(o.firstDiffRight=Math.min(n,o.firstDiffRight));const a=e.children.splice(s,1);for(const e of a)i.removedNodes.push(e.id),e.retire()}s-=1}return{offset:o.firstDiffLeft,span:n.length-o.firstDiffRight-o.firstDiffLeft,enforcedCompleteTileTextUnit:!a&&this._settings.enableOptimizedCallingPattern}}}_addNewChildrenDeprecated(e,t,n,r,i,o){const a=gr(t.content,n,oi(this._settings.completeTileTextUnit,this._settings.newLineSentenceSeparatorEnabled),i),s=[];for(const n of a){const i=new ii(n,e);this._attachTextUnit(i),s.push(i),o.unreconciledContent.push(this._buildTile(e,i,t.content,r)),o.addedNodes.push(i.id)}return si(e,s),o}_emitParagraphDeltaUpdate(e,t,n,r,i){if(this._settings.paragraphDeltasEnabled){const o=yn(n.oldTextInfo,e.range.offset,e.range.offset+e.range.span),a=yn(n.newTextInfo,t.range.offset,t.range.offset+t.range.span);if(e.registered||this._emitParagraphAdd(n,e,r),void 0!==e.eventSeqId){e.eventSeqId+=1;const n=li(e,o,a,!!t.range.validEndBoundary,!!t.range.enforcedCompleteTileTextUnit,r,i,this._settings.completeTileTextUnit,this._settings.completeTileTextUnit,this._settings,e.cachedWordCount);return e.cachedWordCount=n.wordCount,n}}}_emitParagraphDeltaAdd(e,t){if(this._settings.paragraphDeltasEnabled)if(e.nodesToAdd.length<=2||!this._settings.batchTileProcessingEnabled)for(const n of e.nodesToAdd)this._emitParagraphAdd(e,n,t);else this._emitParagraphBatchAdd(e,t)}_emitParagraphAdd(e,t,n){var r;if(t.registered)return void(this._settings.enableParagraphDeltasVerboseLogging&&(null===(r=this._logger)||void 0===r||r.info(539002012,"The node has been registered, skipping")));const i=this._settings.enableParagraphDeltasEmptyInitialTile&&n===p.Q0.Local,o=yn(e.newTextInfo,t.range.offset,t.range.offset+t.range.span);t.eventSeqId=0;const a=i?Object.assign(Object.assign({},o),{content:""}):o,s=this._getNodeAddEventData(e.tileNode,t,a,n);if(this.publishEvent("nodeEvent",s),i){t.eventSeqId+=1;const e=this._getDeltaEventData(t,o,n);this.publishEvent("deltaEvent",e)}t.registered=!0}_emitParagraphBatchAdd(e,t){const n=[];for(const r of e.nodesToAdd){if(r.registered)continue;const i=yn(e.newTextInfo,r.range.offset,r.range.offset+r.range.span);r.eventSeqId=0;const o=this._getNodeAddEventData(e.tileNode,r,i,t);n.push(o),r.registered=!0}this.publishEvent("nodeBatchEvent",n)}_getNodeAddEventData(e,t,n,r){var i;const o=e.findPreviousChildNode(t),a=e.findNextChildNode(t);return{tileNodeId:e.id,id:t.id,content:n,eventSeqId:null!==(i=t.eventSeqId)&&void 0!==i?i:0,mutationChangeType:r,messageType:h.G.NewData,documentModel:e.documentModel,specifiedLocale:this.getSpecifiedLocaleForNode(t),prevTileId:"#head#"===o?o:null==o?void 0:o.id,nextTileId:"#tail#"===a?a:null==a?void 0:a.id}}_getDeltaEventData(e,t,n){return li(e,void 0,t,!!e.range.validEndBoundary,!0,n,!1,this._settings.completeTileTextUnit,this._settings.completeTileTextUnit,this._settings,0)}_emitParagraphDeltaRetire(e,t){if(this._settings.paragraphDeltasEnabled&&0!==e.nodesToRetire.length)if(this._settings.batchTileProcessingEnabled&&e.nodesToRetire.length>1)this._emitParagraphBatchRetire(e,t);else for(const n of e.nodesToRetire)n.registered=!1,this.publishEvent("nodeEvent",this._getNodeRetireEventData(e,n,t))}_emitParagraphBatchRetire(e,t){const n=[];for(const r of e.nodesToRetire)r.registered=!1,n.push(this._getNodeRetireEventData(e,r,t));n.length>0&&this.publishEvent("nodeBatchEvent",n)}_getNodeRetireEventData(e,t,n){var r;return{tileNodeId:e.tileNode.id,id:t.id,content:{content:""},eventSeqId:null!==(r=t.eventSeqId)&&void 0!==r?r:0,mutationChangeType:n,messageType:h.G.RemoveData,documentModel:e.tileNode.documentModel,specifiedLocale:this.getSpecifiedLocaleForNode(t)}}getSpecifiedLocaleForNode(e){var t,n;return null!==(t=e.specifiedLocale)&&void 0!==t?t:null===(n=e.parent)||void 0===n?void 0:n.specifiedLocale}}function si(e,t){if(t.length){const n=t[0].range.offset;if(e.children.length){let r=e.children.length-1,i=t;for(;r>=0;){if(n>e.children[r].range.offset){e.children.splice(r,0,...i),i=[];break}r-=1}i.length&&e.children.splice(0,0,...i)}else e.children=t}}function li(e,t,n,r,i,o,a,s,l,d,u){var c,g;const h=null!==(c=null==t?void 0:t.content)&&void 0!==c?c:"",p=n.content,f=Or.CC(h,p);a&&(f.firstDiffLeft-=1);let v=!1;if(!r&&l!==pn.fT.Phrase&&l!==s){const e=f.firstDiffLeft,t=p.length-f.firstDiffRight;v=-1!==oi(l).findEndBoundary(p,e-1,t)}const m=new mr(new fr.a,d),y=null!=u?u:m.getWordCount(h),_=m.hasWordCountChanged(f,y,p,!0);let b,C=gn.OD.Word;if(i?C=fn(s):v?C=fn(l):_.isWordCountChanged?r&&(C=fn(s)):C=gn.OD.Chars,s===pn.fT.Paragraph&&l===pn.fT.Sentence&&C!==gn.OD.Paragraph){const e=f.firstDiffLeft,t=oi(l),n=t.findBeginBoundary(p,e,0),r=t.findEndBoundary(p,e-1,p.length);b=[{position:n,length:(-1===r?p.length:r)-n,unit:gn.OD.Sentence}]}return{textTileNode:e,oldTextInfo:t,newTextInfo:n,minDiffBounds:f,wordCount:_.wordCount,deltaUnit:C,mutationChangeType:o,invalidationRanges:b,wordBoundaries:null!==(g=_.wordBoundaries)&&void 0!==g?g:[]}}class di extends ni.z{constructor(e,t,n){super(),this.id=e,this._settings=t,this._logger=n,this._cachedWordCount=0,this._cachedTiles=new Map,this._dirtyParagraphIds=new Set,this.seqId=0,this._eventSeqId=0,this.children=[],this.childrenIdMap=new Map,this._disposed=!1,this._publishDirtyParagraphsDiff=(e,t)=>{for(const n of this._dirtyParagraphIds){const r=this.childrenIdMap.get(n);if(!r)continue;const i=yn(e,r.range.offset,r.range.offset+r.range.span);this.publishEvent("paragraphDiff",{paragraph:r,textInfo:i,mutationChangeType:t})}this._dirtyParagraphIds.clear()},this._publishLastParagraphDiff=(e,t)=>{if(0===this.children.length)return;let n=this.children[0];for(const e of this.children)e.range.offset>n.range.offset&&(n=e);const r=yn(e,n.range.offset,n.range.offset+n.range.span);this.publishEvent("paragraphDiff",{paragraph:n,textInfo:r,mutationChangeType:t})},this.isForceRehydrationExpected=!1,this._republishTextTileDeltaEvent=e=>{this._detectDirtyTextTile(e),this.publishEvent("textTileDeltaEvent",e)},this._republishTextTileNodeEvent=e=>{this.publishEvent("textTileNodeEvent",e)},this._republishTextTileNodeBatchEvent=e=>{this.publishEvent("textTileNodeBatchEvent",e)},this._detectDirtyTextTile=e=>{e.deltaUnit===gn.OD.Sentence||e.deltaUnit===gn.OD.Paragraph?this._dirtyParagraphIds.delete(e.textTileNode.id):this._dirtyParagraphIds.add(e.textTileNode.id)},this._wordCount=new fr.a,this._wordCountDetector=new mr(this._wordCount,this._settings),this._textTileNodeManager=new ai(this._settings,this._logger),this._textTileNodeManager.subscribe("deltaEvent",this._republishTextTileDeltaEvent),this._textTileNodeManager.subscribe("nodeEvent",this._republishTextTileNodeEvent),this._textTileNodeManager.subscribe("nodeBatchEvent",this._republishTextTileNodeBatchEvent),this._cachedChildNodeOps={nodesToDelete:new Set,activeNodes:new Set},this.resetInternal()}get eventSeqId(){return this._eventSeqId}get cachedText(){var e;return null!==(e=this._cachedTextInfo)&&void 0!==e?e:{content:""}}get disposed(){return this._disposed}get previousNodeId(){return void 0===this.previousNode||"#head#"===this.previousNode?this.previousNode:this.previousNode.id}get nextNodeId(){return void 0===this.nextNode||"#tail#"===this.nextNode?this.nextNode:this.nextNode.id}resetInternal(){this._cachedTextInfo=void 0,this._cachedWordCount=0,this.documentModel=void 0,this._cachedTiles.clear(),this._cachedChildNodeOps.nodesToDelete.clear(),this._cachedChildNodeOps.activeNodes.clear();for(const e of this.children)e.retire();this.children=[],this.childrenIdMap.clear(),this._invalidationDiffBounds=void 0}updateSettings(e){this._settings=e,this._wordCountDetector=new mr(this._wordCount,this._settings),this._textTileNodeManager.updateSettings(e)}resetState(){if(this.removeAllParagraphNodesFromAugloop(),this.resetInternal(),!this._settings.enableOrchestration){const e={firstDiffLeft:0,firstDiffRight:0};this.publishEvent("brokerReconcile",{tileNodeId:this.id,critiques:void 0,oldText:"",newText:"",minDiffBounds:e,maxDiffBounds:e,seqId:this.seqId,forceReflow:!0})}this.publishEvent("stateReset",{tileNodeId:this.id})}async dispose(){this.resetInternal(),this._textTileNodeManager.unsubscribe("deltaEvent",this._republishTextTileDeltaEvent),this._textTileNodeManager.unsubscribe("nodeEvent",this._republishTextTileNodeEvent),this._textTileNodeManager.unsubscribe("nodeBatchEvent",this._republishTextTileNodeBatchEvent),this._disposed=!0}reconcile(e){var t,n,r,i,o,a,s,l,d;if(e.rehydrateCritiques&&e.idleReconcileTrigger&&!this.isForceRehydrationExpected)return;const u=null!==(n=null===(t=this._cachedTextInfo)||void 0===t?void 0:t.content)&&void 0!==n?n:"",c=e.text.content,g=Or.CC(u,c);return this.documentModel=e.documentModel,e.mutationWasTextReplacement&&(g.firstDiffLeft-=1),c!==u&&(this._invalidationDiffBounds||(this._invalidationDiffBounds=Object.assign({},g)),this._invalidationDiffBounds.firstDiffLeft=Math.min(this._invalidationDiffBounds.firstDiffLeft,g.firstDiffLeft),this._invalidationDiffBounds.firstDiffRight=Math.min(this._invalidationDiffBounds.firstDiffRight,g.firstDiffRight)),this.publishEvent("brokerReconcile",{tileNodeId:this.id,critiques:null===(r=e.brokerOptions)||void 0===r?void 0:r.critiques,oldText:u,newText:c,minDiffBounds:g,maxDiffBounds:null!==(i=this._invalidationDiffBounds)&&void 0!==i?i:{firstDiffLeft:u.length,firstDiffRight:0},seqId:this.seqId,forceReflow:null!==(a=null===(o=e.brokerOptions)||void 0===o?void 0:o.forceReflow)&&void 0!==a?a:void 0!==(null===(s=e.brokerOptions)||void 0===s?void 0:s.critiques)}),c===u&&this.children.length>0&&(!e.rehydrateCritiques||e.optimizedRehydrationEnabled)?(e.rehydrateCritiques&&(e.useDirtyParagraphReconciliation?this._publishDirtyParagraphsDiff(e.text,e.mutationChangeType):this._publishLastParagraphDiff(e.text,e.mutationChangeType)),this._settings.enableOrchestration&&(e.forceTileDiffEmission||e.rehydrateCritiques)&&(this._eventSeqId+=1,this.publishEvent("tileDiff",{tileNodeId:this.id,cachedTextInfo:this._cachedTextInfo,newTextInfo:e.text,minDiffBounds:g,hasWordChanges:!1,cachedWordCount:this._cachedWordCount,cachedTiles:Array.from(this._cachedTiles.values()),mutationChangeType:e.mutationChangeType,specifiedLocale:this.specifiedLocale})),this._reconcileFormatting(e.text),void(this._cachedTextInfo=e.text)):this._reconcileState(e.text,g,null!==(l=e.rehydrateCritiques)&&void 0!==l&&l,e.mutationChangeType,null!==(d=e.mutationWasTextReplacement)&&void 0!==d&&d)}findPreviousChildNode(e){var t;const n=e.range.offset;for(const t of this.children)if(t!==e&&t.range.offset+t.range.span===n)return t;return"#head#"===this.previousNode?this.previousNode:null===(t=this.previousNode)||void 0===t?void 0:t.findLastChildNode()}findNextChildNode(e){var t;const n=e.range.offset+e.range.span;for(const t of this.children)if(t!==e&&t.range.offset===n)return t;return"#tail#"===this.nextNode?this.nextNode:null===(t=this.nextNode)||void 0===t?void 0:t.findFirstChildNode()}findLastChildNode(){let e;for(const t of this.children)(!e||t.range.offset>e.range.offset)&&(e=t);return e}findFirstChildNode(){let e;for(const t of this.children)(!e||t.range.offset<e.range.offset)&&(e=t);return e}_reconcileFormatting(e){var t,n;if(this._cachedTextInfo){if(this._settings.enableAttributionRangeExceptionInFormattedTextDeltas){const n=this._settings.enableAttributionRangeInAddDelta&&!wn(this._cachedTextInfo.attributionRanges,e.attributionRanges);if(!wn(this._cachedTextInfo.formattedRanges,e.formattedRanges)||n){for(const t of this.children){const r=t.range.offset+t.range.span,i=Cn(this._cachedTextInfo,t.range.offset,r),o=Cn(e,t.range.offset,r);wn(i.formattedRanges,o.formattedRanges)&&!n||this.publishEvent("formattingDiff",{paragraph:t,sourceType:p.pf.ParagraphNode,data:{formattedRanges:o.formattedRanges,attributionRanges:n?o.attributionRanges:void 0}})}this.publishEvent("formattingDiff",{tileNodeId:this.id,sourceType:p.pf.TileNode,data:null!==(t=e.formattedRanges)&&void 0!==t?t:[]})}}else if(!wn(this._cachedTextInfo.formattedRanges,e.formattedRanges)){for(const t of this.children){const n=Cn(this._cachedTextInfo,t.range.offset,t.range.offset+t.range.span),r=Cn(e,t.range.offset,t.range.offset+t.range.span);wn(n.formattedRanges,r.formattedRanges)&&wn(n.attributionRanges,r.attributionRanges)||this.publishEvent("formattingDiff",{paragraph:t,sourceType:p.pf.ParagraphNode,data:r})}this.publishEvent("formattingDiff",{tileNodeId:this.id,sourceType:p.pf.TileNode,data:null!==(n=e.formattedRanges)&&void 0!==n?n:[]})}if(!wn(this._cachedTextInfo.objectReferences,e.objectReferences)||!Tn(this._cachedTextInfo,e)){const t=Object.assign({},e);for(const e of Sn)"objectReferences"!==e&&delete t[e];for(const e of this.children)this.publishEvent("formattingDiff",{paragraph:e,sourceType:p.pf.ParagraphNode,data:t});this.publishEvent("formattingDiff",{tileNodeId:this.id,sourceType:p.pf.TileNode,data:t})}}}retire(){var e,t,n;this._invalidationDiffBounds={firstDiffLeft:0,firstDiffRight:0},this.publishEvent("brokerReconcile",{tileNodeId:this.id,critiques:void 0,oldText:null!==(t=null===(e=this._cachedTextInfo)||void 0===e?void 0:e.content)&&void 0!==t?t:"",newText:"",minDiffBounds:this._invalidationDiffBounds,maxDiffBounds:this._invalidationDiffBounds,seqId:this.seqId,forceReflow:!0}),this._settings.enableOrchestration&&(this.publishEvent("removeTileNode",{tileNodeId:this.id}),this.removeAllParagraphNodesFromAugloop()),this._cachedTextInfo=void 0,this._cachedWordCount=0,this._cachedChildNodeOps.activeNodes.clear(),this._cachedChildNodeOps.nodesToDelete.clear(),null===(n=this._logger)||void 0===n||n.debug(562057756,"Retire node",this.id)}removeAllParagraphNodesFromAugloop(){if(!this._settings.enableOrchestration)return;const e=[...Array.from(this._cachedChildNodeOps.nodesToDelete),...Array.from(this._cachedChildNodeOps.activeNodes)];if(this._settings.paragraphDeltasEnabled)for(const t of e)this.publishEvent("textTileNodeEvent",{tileNodeId:this.id,id:t,eventSeqId:this.seqId,mutationChangeType:p.Q0.Code,messageType:h.G.RemoveData,specifiedLocale:this.specifiedLocale,documentModel:this.documentModel});else this.publishEvent("paragraphNodeChange",{tileNodeId:this.id,graphTransaction:{addedNodes:[],unreconciledContent:[],removedNodes:e,updatedNodes:[]},mutationChangeType:p.Q0.Code})}move(e){const t=this.id;return this.id=(0,yt.h)(),this.publishEvent("brokerNodeChange",{oldNodeId:t,newNodeId:this.id}),this.documentModel=e,this.id}_reconcileState(e,t,n,r,i){const o=this.seqId+1,a=e.content;let s;if(this._settings.paragraphDeltasEnabled)s=!1,this._cachedWordCount=0;else if(this._settings.wordCountDetectorEnabled){const e=this._wordCountDetector.hasWordCountChanged(t,this._cachedWordCount,a);s=e.isWordCountChanged,this._cachedWordCount=e.wordCount}else s=this._reconcileWordCount(t,a);const l=this._textTileNodeManager.updateParagraphNodes(this,this._cachedTextInfo,e,t,o,r,i);if(this._reconcileParagraphs(l,o),this._settings.enableOrchestration&&(this._eventSeqId+=1,this.publishEvent("tileDiff",{tileNodeId:this.id,newTextInfo:e,minDiffBounds:t,cachedWordCount:this._cachedWordCount,mutationChangeType:r,hasWordChanges:s,graphTransaction:l,cachedTextInfo:this._cachedTextInfo,specifiedLocale:this.specifiedLocale})),this._reconcileFormatting(e),this._cachedTextInfo=e,n||s||this._settings.enableOrchestration&&0===this._cachedChildNodeOps.activeNodes.size){if(this._cachedTiles.clear(),this.children.length>0&&this._settings.enableOptimizedCallingPattern&&r!==p.Q0.Code&&this.setIsForceRehydrationExpected(),this._settings.enableOrchestration){for(const e of l.addedNodes)this._cachedChildNodeOps.activeNodes.add(e);l.removedNodes=Array.from(this._cachedChildNodeOps.nodesToDelete),this._cachedChildNodeOps.nodesToDelete.clear(),this._settings.paragraphDeltasEnabled?l.removedNodes.length>0&&this.publishEvent("handleRemovedNodes",{tileNodeId:this.id,nodesToRetire:l.removedNodes}):this.publishEvent("paragraphNodeChange",{tileNodeId:this.id,graphTransaction:l,mutationChangeType:r,newTextInfo:e})}return this._resetInvalidationStateAndReturnTiles(l.unreconciledContent,o)}this.setIsForceRehydrationExpected()}setIsForceRehydrationExpected(){this._invalidationDiffBounds&&(this.isForceRehydrationExpected=!0)}clearIsForceRehydrationExpected(){this.isForceRehydrationExpected=!1}critiqueAction(e,t){return!this._settings.enableOrchestration&&(this.publishEvent("brokerProcessCritiqueAction",{tileNodeId:this.id,actionType:e,offset:t}),e===ri.$w.ApplySuggestion&&this.reconcile({text:this.cachedText,mutationChangeType:p.Q0.Local}),!0)}_reconcileWordCount(e,t){const n=this._wordCountDetector.getWordCount(t);let r=0;e.firstDiffLeft<=t.length&&(r=this._wordCount.getWordCountInRange(t,e.firstDiffLeft,t.length-e.firstDiffRight));const i=n>0&&(n!==this._cachedWordCount||r>1);return this._cachedWordCount=n,i}_reconcileParagraphs(e,t){for(const t of e.unreconciledContent)this._cachedTiles.set(t.header.elementId.id,t);for(const[e,n]of this._cachedTiles)-1===this.children.findIndex((t=>t.id===e))?this._cachedTiles.delete(e):n.header.seqId=t.toString();e.unreconciledContent=Array.from(this._cachedTiles.values());for(const t of e.removedNodes)this._cachedChildNodeOps.activeNodes.delete(t)&&this._cachedChildNodeOps.nodesToDelete.add(t)}_resetInvalidationStateAndReturnTiles(e,t){return this._settings.enableOptimizedCallingPattern||this.clearIsForceRehydrationExpected(),this._invalidationDiffBounds=void 0,this.seqId=t,e}registerChild(e){this.childrenIdMap.set(e.id,e),this.publishEvent("registerChildNode",{tileNodeId:this.id,childNodeId:e.id})}unregisterChild(e){this.childrenIdMap.delete(e.id),this.publishEvent("unregisterChildNode",{childNodeId:e.id})}getChildById(e){return this.childrenIdMap.get(e)}}class ui extends ni.z{constructor(e,t,n){super(),this._settings=e,this._proofingLanguages=t,this._logger=n,this._textTileNodes=new Map,this._textTileNodeToRootNode=new Map,this._disposed=!1,this._brokerMoveEventHandler=e=>{this.publishEvent("tilingEvent",Object.assign({messageName:"brokerMove"},e))},this._brokerCritiqueActionEventHandler=e=>{this.publishEvent("tilingEvent",Object.assign({messageName:"brokerCritiqueAction"},e))},this._brokerReconcileEventHandler=e=>{this.publishEvent("tilingEvent",Object.assign({messageName:"brokerReconcile"},e))},this._removeTileNodeEventHandler=e=>{const t=this.getTileRootNodeById(e.tileNodeId);if(!t)return;const n={tileId:e.tileNodeId,tileVersion:t.eventSeqId,documentModel:t.documentModel,changeType:p.Q0.Code,isTextNode:!1,tile:void 0};this.publishEvent("tilingEvent",{messageName:"hostModelTextTile",data:n,messageType:h.G.RemoveData})},this._tileDiffEventHandler=e=>{const t=this.getTileRootNodeById(e.tileNodeId);if(!t)return;const n=function(e,t,n,r,i){var o,a;const s=null!==(o=e.graphTransaction)&&void 0!==o?o:{addedNodes:[],unreconciledContent:null!==(a=e.cachedTiles)&&void 0!==a?a:[],removedNodes:[],updatedNodes:[]};let l=gn.OD.Chars;s.unreconciledContent.some((e=>e.textUnit===pn.fT.Paragraph))?l=gn.OD.Paragraph:s.unreconciledContent.some((e=>e.textUnit===pn.fT.Sentence))?l=gn.OD.Sentence:e.hasWordChanges&&(l=gn.OD.Word);const d=s.unreconciledContent.map((e=>{var r;return{position:e.header.elementId.offset,length:e.header.elementId.span,unit:fn(e.textUnit),languageId:null!==(r=t.specifiedLocale)&&void 0!==r?r:n}}));return En(e.tileNodeId,t.eventSeqId,r,e.cachedTextInfo,e.newTextInfo,e.minDiffBounds,e.cachedWordCount,l,p.pf.TileNode,e.mutationChangeType,i,d)}(e,t,this._proofingLanguages.defaultLanguageCode,t.documentModel,this._settings.enableAttributionRangeInAddDelta);this.publishEvent("tilingEvent",Object.assign({messageName:"hostModelDelta"},n.message)),this._handleAttributionDelta(n.message,n.attributionData)},this._paragraphDiffEventHandler=e=>{var t,n,r;const i=En(e.paragraph.id,null!==(t=e.paragraph.eventSeqId)&&void 0!==t?t:0,null===(n=e.paragraph.parent)||void 0===n?void 0:n.documentModel,e.textInfo,e.textInfo,{firstDiffLeft:e.paragraph.range.span,firstDiffRight:0},null!==(r=e.paragraph.cachedWordCount)&&void 0!==r?r:0,gn.OD.Sentence,p.pf.ParagraphNode,e.mutationChangeType,this._settings.enableAttributionRangeInAddDelta);this.publishEvent("tilingEvent",Object.assign({messageName:"hostModelDelta"},i.message)),this._handleAttributionDelta(i.message,i.attributionData)},this._paragraphNodeChangeEventHandler=e=>{const t=this.getTileRootNodeById(e.tileNodeId);if(!t)return;const n=function(e,t,n,r,i){var o,a,s;const l=null!==(o=e.graphTransaction)&&void 0!==o?o:{addedNodes:[],unreconciledContent:[],removedNodes:null!==(a=e.nodesToRetire)&&void 0!==a?a:[],updatedNodes:[]},d=null!==(s=e.mutationChangeType)&&void 0!==s?s:p.Q0.Code,u=l.removedNodes.map((e=>({messageType:h.G.RemoveData,data:{tileId:e,tileVersion:t.eventSeqId,documentModel:r,changeType:d,isTextNode:!0,tile:void 0}})));return u.push(...l.unreconciledContent.map((o=>{const{prev:a,next:s}=function(e,t){const n=e.getChildById(t);if(!n)return{prev:void 0,next:void 0};const r=e.findPreviousChildNode(n),i=e.findNextChildNode(n);return{prev:"#head#"===r?r:null==r?void 0:r.id,next:"#tail#"===i?i:null==i?void 0:i.id}}(t,o.header.elementId.id);return{messageType:i&&!l.addedNodes.includes(o.header.elementId.id)?h.G.ChangeData:h.G.NewData,data:{tileId:o.header.elementId.id,tileVersion:t.eventSeqId,documentModel:r,changeType:d,isTextNode:!0,tile:new cn.Cg(Object.assign(Object.assign({},e.newTextInfo),{content:o.data,formattedRanges:[{start:0,length:o.data.length,languageId:n}]})),prevId:a,nextId:s}}}))),u}(e,t,this._proofingLanguages.defaultLanguageCode,t.documentModel,this._settings.enableParagraphUpdates);this.publishEvent("tilingEvent",{messageName:"hostModelParagraphTextTiles",data:n})},this._formattingDiffEventHandler=e=>{var t,n,r;let i,o,a=0;if(e.tileNodeId){const n=this.getTileRootNodeById(e.tileNodeId);i=null==n?void 0:n.id,a=null!==(t=null==n?void 0:n.eventSeqId)&&void 0!==t?t:0,o=null==n?void 0:n.documentModel}if(!i&&e.paragraph&&(i=e.paragraph.id,a=null!==(n=e.paragraph.eventSeqId)&&void 0!==n?n:0,o=null===(r=e.paragraph.parent)||void 0===r?void 0:r.documentModel),!i)return;const s=xn(i,a,o,e.sourceType,e.data);this.publishEvent("tilingEvent",Object.assign({messageName:"hostModelFormattingDelta"},s))},this._textTileNodeEventHandler=e=>{const t=An(e,this._proofingLanguages.defaultLanguageCode);this.publishEvent("tilingEvent",{messageName:"hostModelTextTile",data:t,messageType:e.messageType})},this._textTileNodeBatchEventHandler=e=>{const t=e.map((e=>({messageType:e.messageType,data:An(e,this._proofingLanguages.defaultLanguageCode)})));this.publishEvent("tilingEvent",{messageName:"hostModelBatchTextTile",data:t})},this._textTileDeltaEventHandler=e=>{var t,n;const r=En(e.textTileNode.id,null!==(t=e.textTileNode.eventSeqId)&&void 0!==t?t:0,null===(n=e.textTileNode.parent)||void 0===n?void 0:n.documentModel,e.oldTextInfo,e.newTextInfo,e.minDiffBounds,e.wordCount,e.deltaUnit,p.pf.ParagraphNode,e.mutationChangeType,this._settings.enableAttributionRangeInAddDelta,e.invalidationRanges,e.wordBoundaries);this.publishEvent("tilingEvent",Object.assign({messageName:"hostModelDelta"},r.message)),this._handleAttributionDelta(r.message,r.attributionData)},this._handleAttributionDelta=(e,t)=>{(null==t?void 0:t.length)&&this._settings.enableAttributionRangeInAddDelta&&this.publishEvent("tilingEvent",{messageName:"hostModelAttributionDelta",tileId:e.tileId,tileVersion:e.tileVersion,documentModel:e.documentModel,sourceType:e.sourceType,delta:t})},this._stateChangeEventHandler=e=>{const t=this.getTileRootNodeById(e.tileNodeId);t&&this._sendNewTextTileEvent(t),this.publishEvent("stateReset",e)},this._handleRemovedNodesEventHandler=e=>{this.publishEvent("handleRemovedNodes",e)},this._registerChildNodeEventHandler=e=>{this._textTileNodeToRootNode.set(e.childNodeId,e.tileNodeId)},this._unregisterChildNodeEventHandler=e=>{this._textTileNodeToRootNode.delete(e.childNodeId)},this._sendNewTextTileEvent=e=>{const t={tileId:e.id,tileVersion:e.eventSeqId,documentModel:e.documentModel,changeType:p.Q0.Code,isTextNode:!1,tile:void 0,prevId:e.previousNodeId,nextId:e.nextNodeId};this.publishEvent("tilingEvent",{messageName:"hostModelTextTile",data:t,messageType:h.G.NewData})},this._findTextTileNodeById=e=>{var t;const n=this._textTileNodeToRootNode.get(e);if(n)return null===(t=this._textTileNodes.get(n))||void 0===t?void 0:t.getChildById(e)}}get disposed(){return this._disposed}async dispose(){if(!this._disposed){for(const e of this._textTileNodes.values())e.unsubscribe("stateReset",this._stateChangeEventHandler),e.unsubscribe("removeTileNode",this._removeTileNodeEventHandler),e.unsubscribe("tileDiff",this._tileDiffEventHandler),e.unsubscribe("paragraphDiff",this._paragraphDiffEventHandler),e.unsubscribe("paragraphNodeChange",this._paragraphNodeChangeEventHandler),e.unsubscribe("formattingDiff",this._formattingDiffEventHandler),e.unsubscribe("registerChildNode",this._registerChildNodeEventHandler),e.unsubscribe("unregisterChildNode",this._unregisterChildNodeEventHandler),e.unsubscribe("handleRemovedNodes",this._handleRemovedNodesEventHandler),e.unsubscribe("textTileNodeEvent",this._textTileNodeEventHandler),e.unsubscribe("textTileNodeBatchEvent",this._textTileNodeBatchEventHandler),e.unsubscribe("textTileDeltaEvent",this._textTileDeltaEventHandler),e.unsubscribe("brokerNodeChange",this._brokerMoveEventHandler),e.unsubscribe("brokerProcessCritiqueAction",this._brokerCritiqueActionEventHandler),e.unsubscribe("brokerReconcile",this._brokerReconcileEventHandler),await e.dispose();this._textTileNodes.clear(),this._disposed=!0}}resetState(){for(const e of this._textTileNodes.values())e.resetState()}setProofingLanguages(e){this._proofingLanguages=e;for(const e of this._textTileNodes.values())e.reconcile({text:e.cachedText,mutationChangeType:p.Q0.Code})}updateSettings(e){this._settings=e;for(const e of this._textTileNodes.values())e.updateSettings(this._getTileRootNodeSettings())}async pushText(e,t){const n=[];for(const t of e){const e=this._getTileRootNodeForExternalId(t.tileNodeId);e.previousNode=this.getPreviousTileRootNode(t.previousNodeId),e.nextNode=this.getNextTileRootNode(t.nextNodeId);const r=e.reconcile(t);r&&n.push(...r)}if(0===n.length)return;const r=this._buildTilesToSend(n,this._proofingLanguages),i={messageType:t,data:{tiles:r,uxLanguage:this._proofingLanguages.defaultLanguageCode}};t!==h.G.RemoveData?this.publishEvent("tilesAvailable",i):this.publishEvent("clearTiles",r)}retireTileNode(e){const t=this._textTileNodes.get(e);t&&(t.retire(),this._textTileNodes.delete(e))}moveTileNode(e,t,n){const r=this._textTileNodes.get(e);if(!r)return;const i=r.documentModel,o=null!=n?n:i,a=r.id,s=r.move(o);this._textTileNodes.delete(e),this._textTileNodes.set(t,r);const l=function(e,t,n,r,i,o,a,s,l){var d;return{oldTileId:e,newTileId:t,tileVersion:n,oldDocumentModel:s,newDocumentModel:l,tile:new cn.Cg(Object.assign(Object.assign({},r),{formattedRanges:[...null!==(d=r.formattedRanges)&&void 0!==d?d:[],{start:0,length:r.content.length,languageId:i}]})),prevId:o,nextId:a}}(a,s,r.eventSeqId,r.cachedText,this._proofingLanguages.defaultLanguageCode,r.previousNodeId,r.nextNodeId,i,o);this.publishEvent("tilingEvent",Object.assign({messageName:"hostModelMoveTextTile"},l))}_buildTilesToSend(e,t){const n=[];for(const r of e)for(const e of t.codesList)n.push(Object.assign(Object.assign({},r),{proofingLanguages:[e]}));return n}_getTileRootNodeForExternalId(e){let t=this._textTileNodes.get(e);return t||(t=this._textTileNodes.get(e)),t||(t=new di(e,this._getTileRootNodeSettings(),this._logger),this._textTileNodes.set(e,t),t.subscribe("stateReset",this._stateChangeEventHandler),t.subscribe("removeTileNode",this._removeTileNodeEventHandler),t.subscribe("tileDiff",this._tileDiffEventHandler),t.subscribe("paragraphDiff",this._paragraphDiffEventHandler),t.subscribe("paragraphNodeChange",this._paragraphNodeChangeEventHandler),t.subscribe("formattingDiff",this._formattingDiffEventHandler),t.subscribe("textTileNodeEvent",this._textTileNodeEventHandler),t.subscribe("textTileNodeBatchEvent",this._textTileNodeBatchEventHandler),t.subscribe("textTileDeltaEvent",this._textTileDeltaEventHandler),t.subscribe("registerChildNode",this._registerChildNodeEventHandler),t.subscribe("unregisterChildNode",this._unregisterChildNodeEventHandler),t.subscribe("handleRemovedNodes",this._handleRemovedNodesEventHandler),t.subscribe("brokerNodeChange",this._brokerMoveEventHandler),t.subscribe("brokerProcessCritiqueAction",this._brokerCritiqueActionEventHandler),t.subscribe("brokerReconcile",this._brokerReconcileEventHandler),this._sendNewTextTileEvent(t)),t}getTileRootNodeById(e){return this._textTileNodes.get(e)}_getTileRootNodeSettings(){return Object.assign(Object.assign({},this._settings),{proofingLanguages:this._proofingLanguages.codesList})}getParagraphFinder(){return{findParagraph:e=>this._findTextTileNodeById(e),getParagraphText:e=>{const t=e.parent;if(t)return t.cachedText.content.slice(e.range.offset,e.range.offset+e.range.span)},getParagraphTextForCritique:(e,t)=>{const n=e.parent;if(!n)return;const r=t.endNode?this._findTextTileNodeById(t.endNode.nodeId):e;if(!r)return;const i=t.endNode?r.range.offset+t.endNode.end:t.start+t.length,o=n.cachedText.content;if(r.parent===n)return o.substring(t.start,i).replace(/\u00A0/g," ");let a,s=o.substring(t.start)+"\n",l=n;do{if(a=l.nextNode,!a||"#tail#"===a)return;l=a;const e=l===r.parent,t=e?i:void 0,n=e?"":"\n";s+=l.cachedText.content.substring(0,t)+n}while(l!==r.parent);return s},isCritiqueInNode:(e,t)=>t.nodeId!==e.id&&!(t.start>=e.range.offset+e.range.span||e.range.offset>=t.start+t.length),getTileRootNodeById:e=>this.getTileRootNodeById(e),getTileNodeParagraphs:e=>{var t;return null===(t=this._textTileNodes.get(e))||void 0===t?void 0:t.children}}}async processTileCritiques(e){const t=e.tileNodeId;for(const n of e.critiques)n.tileId&&(n.tileId.nodeId=t);this.publishEvent("critiquesAvailable",{tileNodeId:t,critiques:e.critiques,messageType:e.messageType})}getPreviousTileRootNode(e){return void 0===e||"#head#"===e?e:this._getTileRootNodeForExternalId(e)}getNextTileRootNode(e){return void 0===e||"#tail#"===e?e:this._getTileRootNodeForExternalId(e)}}let ci=class extends _t{constructor(e,t,n,r,i,o,a,s,l,d,u,c,g,f,v,m,y,_,b,C,S,T){super(f,v,void 0,y,C,S),this._guidGenerator=e,this._logger=t,this._wordCount=n,this._wordCountDetector=r,this._settings=i,this._nodePoller=o,this._proofingDom=a,this._tileContent=s,this._hostSettings=l,this.featureFlagsReader=d,this._paragraphDeltasEnabled=u,this._optimizedRehydrationEnabled=c,this._hostTilingEmitter=g,this.nodeType=f,this._observer=v,this._paragraphNodesBuilder=m,this.element=y,this._hostEmitters=_,this.nodeTraverser=b,this.parent=C,this.queryDetection=T,this._children=[],this._cachedWordCount=0,this._cachedTiles=new Map,this._seqId=0,this._eventSeqId=0,this.id=this._guidGenerator.generate(),this._cachedChildNodeOps={nodesToDelete:new Set,activeNodes:new Set},this.resetState(!0),this._proofingDom.registerNode(this),this._hostSettings.enableOrchestration&&this._hostTilingEmitter.emitTileEvent(this,this.id,this._cachedTextInfo,this._eventSeqId,h.G.NewData,p.Q0.Code,mt.Z.TileNode,this.specifiedLocale,this.getPreviousTileId(),this.getNextTileId())}get children(){var e;return this._hostSettings.sdkV2Enabled?null!==(e=this._proofingDom.getTileNodeV2Paragraphs(this))&&void 0!==e?e:[]:this._children}set children(e){this._children=e}getPreviousTileId(){var e;const t=null===(e=this.nodeTraverser)||void 0===e?void 0:e.findPreviousTileNode(this);return"#head#"===t?t:null==t?void 0:t.id}getNextTileId(){var e;const t=null===(e=this.nodeTraverser)||void 0===e?void 0:e.findNextTileNode(this);return"#tail#"===t?t:null==t?void 0:t.id}retire(){this._nodePoller.removeQueuedTiles(this.id),this._clearReconcileTimer(),this._invalidationDiffBounds={firstDiffLeft:0,firstDiffRight:0},this._hostSettings.enableOrchestration&&(this._hostTilingEmitter.emitTileEvent(this,this.id,void 0,this._eventSeqId,h.G.RemoveData,p.Q0.Code,mt.Z.TileNode,this.specifiedLocale),this.removeAllParagraphNodesFromAugloop()),this.parent=void 0,this._cachedTextInfo=void 0,this._currentText=void 0,this._cachedWordCount=0,this._cachedChildNodeOps.activeNodes.clear(),this._cachedChildNodeOps.nodesToDelete.clear(),this._logger.debug(562057756,"Retire node",this.id),this._proofingDom.unregisterNode(this),super.retire()}removeAllParagraphNodesFromAugloop(){if(!this._hostSettings.enableOrchestration)return;const e=[...Array.from(this._cachedChildNodeOps.nodesToDelete),...Array.from(this._cachedChildNodeOps.activeNodes)];if(this._paragraphDeltasEnabled.check())for(const t of e)this._hostTilingEmitter.emitTileEvent(this,t,void 0,this._eventSeqId,h.G.RemoveData,p.Q0.Code,mt.Z.ParagraphNode,this.specifiedLocale);else this._hostTilingEmitter.emitParagraphNodeTileEvents(this,{addedNodes:[],unreconciledContent:[],removedNodes:e,updatedNodes:[]},p.Q0.Code,void 0)}move(e,t){var n;const r=(0,Fn.F)(this),i=(0,Fn.F)(null!=t?t:this);this._nodePoller.removeQueuedTiles(this.id),this._proofingDom.unregisterNode(this);const o=this.id;return super.move(e,t),this._hostSettings.enableOrchestration&&this._hostTilingEmitter.emitMoveTileEvent(o,this.id,null!==(n=this._cachedTextInfo)&&void 0!==n?n:{content:""},this._eventSeqId,this.specifiedLocale,this.getPreviousTileId(),this.getNextTileId(),null==r?void 0:r.documentModel,null==i?void 0:i.documentModel),this._proofingDom.registerNode(this),this}resetState(e){e||this.removeAllParagraphNodesFromAugloop(),this._cachedTextInfo=void 0,this._cachedWordCount=0,this._cachedTiles.clear(),this._cachedChildNodeOps.nodesToDelete.clear(),this._cachedChildNodeOps.activeNodes.clear();for(const e of this.children)e.retire();if(this.children=[],this._invalidationDiffBounds=void 0,!e){for(const e of this._hostEmitters)e.emit(M.pD.hostModelTileStateReset,{address:void 0,message:this.id});this._hostSettings.enableOrchestration&&this._hostTilingEmitter.emitTileEvent(this,this.id,this._cachedTextInfo,this._eventSeqId,h.G.NewData,p.Q0.Code,mt.Z.TileNode,this.specifiedLocale,this.getPreviousTileId(),this.getNextTileId())}}pullText(){var e;return null!==(e=this._tileContent.getText(this))&&void 0!==e?e:{content:""}}reconcile(e,t,n,r,i,o){var a,s,l,d,u,c;if(this.parent){const t=null!==(a=this._tileContent.getText(this))&&void 0!==a?a:{content:""},n=null!==(l=null===(s=this._cachedTextInfo)||void 0===s?void 0:s.content)&&void 0!==l?l:"",g=t.content;this._currentText=t;const h=Or.CC(n,g);if(o&&(h.firstDiffLeft-=1),g!==n&&(this._invalidationDiffBounds||(this._invalidationDiffBounds=Object.assign({},h)),this._invalidationDiffBounds.firstDiffLeft=Math.min(this._invalidationDiffBounds.firstDiffLeft,h.firstDiffLeft),this._invalidationDiffBounds.firstDiffRight=Math.min(this._invalidationDiffBounds.firstDiffRight,h.firstDiffRight)),g===n&&this.children.length>0&&(!r||this._optimizedRehydrationEnabled.check())){if(r){let n=this.children[0];for(const e of this.children)e.element&&e.element.offset>(null!==(u=null===(d=n.element)||void 0===d?void 0:d.offset)&&void 0!==u?u:0)&&(n=e);if(n.element){const r=yn(t,n.element.offset,n.element.offset+n.element.span);this._hostTilingEmitter.emitParagraphDiffEvent({paragraphNode:n,oldTextInfo:r,newTextInfo:r,minDiffBounds:{firstDiffLeft:n.element.span,firstDiffRight:0},wordCount:null!==(c=n.cachedWordCount)&&void 0!==c?c:0,deltaUnit:gn.OD.Sentence,mutationChangeType:e,invalidationRanges:void 0})}}return this._hostSettings.enableOrchestration&&(i||r)&&(this._eventSeqId+=1,this._hostTilingEmitter.emitTileDiffEvent(this,this._cachedTextInfo,t,h,!1,this._cachedWordCount,{addedNodes:[],removedNodes:[],updatedNodes:[],unreconciledContent:Array.from(this._cachedTiles.values())},e,this.specifiedLocale)),this._reconcileFormatting(t,!this.featureFlagsReader.flags.enableAttributionRangeInAddDelta),void(this._cachedTextInfo=t)}return this._reconcileState(t,h,null!=r&&r,e,null!=o&&o)}return this._resetInvalidationStateAndReturnTiles(Array.from(this._cachedTiles.values()),this._seqId)}get critiques(){return[]}get textFormattingInfo(){return this._currentText}_reconcileState(e,t,n,r,i){var o;const a=this._seqId+1,s=e.content;let l;if(this._paragraphDeltasEnabled.check())l=!1,this._cachedWordCount=0;else if(this._hostSettings.wordCountDetectorEnabled){const e=this._wordCountDetector.hasWordCountChanged(t,this._cachedWordCount,s);l=e.isWordCountChanged,this._cachedWordCount=e.wordCount}else l=this._reconcileWordCount(t,s);const d=this._paragraphNodesBuilder.updateParagraphNodes(this,this._cachedTextInfo,e,t,a,r,i);if(this._reconcileParagraphs(d,a),this._hostSettings.enableOrchestration&&(this._eventSeqId+=1,this._hostTilingEmitter.emitTileDiffEvent(this,this._cachedTextInfo,e,t,l,this._cachedWordCount,d,r,this.specifiedLocale)),this._reconcileFormatting(e,!this.featureFlagsReader.flags.enableAttributionRangeInAddDelta),this._cachedTextInfo=e,n||l||this._hostSettings.enableOrchestration&&0===this._cachedChildNodeOps.activeNodes.size){if(this._cachedTiles.clear(),this.children.length>0&&this._hostSettings.enableOptimizedCallingPattern&&r!==p.Q0.Code&&this._tryScheduleReconcileTimer(),this._hostSettings.enableOrchestration){for(const e of d.addedNodes)this._cachedChildNodeOps.activeNodes.add(e);if(d.removedNodes=Array.from(this._cachedChildNodeOps.nodesToDelete),this._cachedChildNodeOps.nodesToDelete.clear(),this._paragraphDeltasEnabled.check())for(const e of d.removedNodes)null===(o=this.queryDetection)||void 0===o||o.handleTileRemoved(e);else this._hostTilingEmitter.emitParagraphNodeTileEvents(this,d,r,e)}return this._resetInvalidationStateAndReturnTiles(d.unreconciledContent,a)}this._tryScheduleReconcileTimer()}_reconcileFormatting(e,t){var n,r;if(this._cachedTextInfo){if(this.featureFlagsReader.flags.enableAttributionRangeExceptionInFormattedTextDeltas){const r=t&&!wn(this._cachedTextInfo.attributionRanges,e.attributionRanges);if(!wn(this._cachedTextInfo.formattedRanges,e.formattedRanges)||r){for(const t of this.children){if(!t.element)continue;const n=t.element.offset+t.element.span,i=Cn(this._cachedTextInfo,t.element.offset,n),o=Cn(e,t.element.offset,n);wn(i.formattedRanges,o.formattedRanges)&&!r||(r?this._hostTilingEmitter.emitFormattingDiffEvent(t,p.pf.ParagraphNode,{formattedRanges:o.formattedRanges,attributionRanges:o.attributionRanges}):this._hostTilingEmitter.emitFormattingDiffEvent(t,p.pf.ParagraphNode,{formattedRanges:o.formattedRanges}))}this._hostTilingEmitter.emitFormattingDiffEvent(this,p.pf.TileNode,null!==(n=e.formattedRanges)&&void 0!==n?n:[])}}else if(!wn(this._cachedTextInfo.formattedRanges,e.formattedRanges)){for(const t of this.children){if(!t.element)continue;const n=bn(this._cachedTextInfo,t.element.offset,t.element.offset+t.element.span),r=bn(e,t.element.offset,t.element.offset+t.element.span);wn(n,r)||this._hostTilingEmitter.emitFormattingDiffEvent(t,p.pf.ParagraphNode,r)}this._hostTilingEmitter.emitFormattingDiffEvent(this,p.pf.TileNode,null!==(r=e.formattedRanges)&&void 0!==r?r:[])}if(!wn(this._cachedTextInfo.objectReferences,e.objectReferences)||!Tn(this._cachedTextInfo,e)){const t=Object.assign({},e);for(const e of Sn)"objectReferences"!==e&&delete t[e];for(const e of this.children)e.element&&this._hostTilingEmitter.emitFormattingDiffEvent(e,p.pf.ParagraphNode,t);this._hostTilingEmitter.emitFormattingDiffEvent(this,p.pf.TileNode,t)}}}_reconcileWordCount(e,t){const n=this._wordCountDetector.getWordCount(t);let r=0;e.firstDiffLeft<=t.length&&(r=this._wordCount.getWordCountInRange(t,e.firstDiffLeft,t.length-e.firstDiffRight));const i=n>0&&(n!==this._cachedWordCount||r>1);return this._cachedWordCount=n,i}_reconcileParagraphs(e,t){for(const t of e.unreconciledContent)this._cachedTiles.set(t.header.elementId.id,t);for(const[e,n]of this._cachedTiles)this._proofingDom.findParagraphNode(e)?n.header.seqId=t.toString():this._cachedTiles.delete(e);e.unreconciledContent=Array.from(this._cachedTiles.values());for(const t of e.removedNodes)this._cachedChildNodeOps.activeNodes.delete(t)&&this._cachedChildNodeOps.nodesToDelete.add(t)}_resetInvalidationStateAndReturnTiles(e,t){return this._hostSettings.enableOptimizedCallingPattern||this._clearReconcileTimer(),this._invalidationDiffBounds=void 0,this._seqId=t,e}_tryScheduleReconcileTimer(){return!(!this._settings.enableTileNodeAutoReconciliation||!this._invalidationDiffBounds||(this._clearReconcileTimer(),this._reconcileCritiqueTimer=window.setTimeout((()=>{this._logger.debug(562057757,"Dirty range timer has fired."),this._nodePoller.pollNodes(h.G.NewData,[this],p.Q0.Code,void 0,!0),this._clearReconcileTimer()}),this._settings.reconcileTileNodeTime),0))}_clearReconcileTimer(){this._reconcileCritiqueTimer&&(clearTimeout(this._reconcileCritiqueTimer),this._reconcileCritiqueTimer=void 0,this._logger.debug(562057758,"Dirty range timer has been cleared."))}get eventSeqId(){return this._eventSeqId}get plainText(){var e,t;return null!==(t=null===(e=this._currentText)||void 0===e?void 0:e.content)&&void 0!==t?t:""}};ci=(0,i.__decorate)([(0,Le._)()],ci);class gi{constructor(){this.imports=[Xe]}get uniqueId(){return(0,Je.z)(507918410)}configureRootServices(e){e.bind(gt).to(Nr),(e=>{e.bind(Kr).toDynamicValue((()=>()=>new qr))})(e),(e=>{e.bind(it).toDynamicValue((e=>{const t=e.get(Vr.G),n=e.get(m.g),r=e.get(pr),i=e.get(vr),o=e.get(st.k),a=e.get(S.G),s=e.get(ge.w),l=e.get(F.d),d=e.get(Ie.n),u=e.get(Ge.H),c=e.get(Ze.W),g=e.get(_r),h=e.get(gt),p=e.getAll(M.zJ),f=e.getOptional(_.J),v=e.getOptional(ut.M),y=e.get(q.c);return(e,m,_,b,C,S,T)=>{switch(e){case mt.Z.OutlineNode:return new ti(m,C,_,b,T);case mt.Z.TerminalNode:return new Ct(m,_,b,T);case mt.Z.TileNode:return new ci(t,n,r,i,o,a,s,l,d,y,u,c,g,e,m,null!=S?S:h,_,p,v,b,T,f);default:throw Error(`This factory cannot build ${mt.Z[e]}.`)}}}))})(e),(e=>{e.bind(ot).toDynamicValue((e=>{const t=e.get(Vr.G),n=e.get(ge.w);return(e,r)=>new P.f(t,n,e,r)}))})(e),(e=>{e.bind(ct).toDynamicValue((e=>{const t=e.get(v.K),n=e.get(ot),r=e.get(ur),i=e.get(st.k),o=e.get(Ie.n),a=e.get(q.c),s=e.get(_r),l=e.get(Tr),d=e.get(Ge.H),u=e.get(m.g),c=e.getOptional(ut.M);return(e,g)=>new Nr(t,n,r,i,o,a,s,l,d,u,c,e,g)}))})(e),(e=>{e.bind(Gr).toDynamicValue((()=>e=>new Qr(e)))})(e),(e=>{e.bind(Xr).toDynamicValue((()=>()=>{const t=e.get(Ie.n),n=e.get(st.k),r=e.get(q.c),i=e.get(Ge.H),o=e.get(v.K),a=e.get(m.g),s=new z.I(o.getCachedEntry(f.l.ProofingLanguages).storeEntryValue),l=Object.assign(Object.assign(Object.assign(Object.assign({},r.flags),n),t),{paragraphDeltasEnabled:i.check()});return new ui(l,s,a)}))})(e),e.bind(yr).to(dn),e.bind(vt.j).to(jr),e.bind(wr).to(Mr),e.bind(Ar).to(Dr),e.bind(Er).toTransient(xr),e.bind(Cr).to(Sr),e.bind(_r).to(Nn),e.bind(Tr).to(Rr),e.bind(ge.w).to(zr),e.bind(Ue.S).toExisting(ge.w),e.bind(Ue.S).to(Hr),e.bind(Ir.b).to(Lr.o),e.bind(br).to(kr),e.bind(Bn).to(sr),e.bind(On).to(lr),e.bind(Ln).to(dr),e.bind(Rn).to(dr),e.bind(ur).to(cr),e.bind(pr).to(fr.a),e.bind(vr).to(mr)}}var hi=n(94084),pi=n(23039);let fi=class{constructor(e,t,n,r){var i,o;this._featureFlagReader=e,this.hostSettings=t,this._logger=n,this._oaMetric=r,this._isNextDeltaProgrammaticallyInserted=!1,this._augloopReconnectionOccurring=!1,this._unsupportedEntities=[],this.registeredQueryDetectionStartChars=[],this.FORBIDDEN_CHARS=['"',"<",">","/","\\","|"],this.PUNCTUATION_CHARS=[",",".",":","!","?","'",";","&"],this.ALLOWED_PREVIOUS_CHARS=["(","/","+","מ"],this.registerQueryDetectionStartCharacter=e=>{console.debug(`Registering query detection start character: ${e}`),this.registeredQueryDetectionStartChars.includes(e)||this.registeredQueryDetectionStartChars.push(e)},this.getRegisteredTriggers=()=>this.registeredQueryDetectionStartChars,this.unregisterQueryDetectionStartCharacter=e=>{const t=this.registeredQueryDetectionStartChars.indexOf(e);t>-1&&this.registeredQueryDetectionStartChars.splice(t,1)},this.handleAugloopReconnection=e=>{this._augloopReconnectionOccurring=!0;try{e()}finally{this._augloopReconnectionOccurring=!1}},this.handleTileRemoved=e=>{var t,n;return(null===(t=this._currentQuery)||void 0===t?void 0:t.tileId)===e&&(this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,this._currentScope=void 0),null===(n=this._currentQuery)||void 0===n?void 0:n.queryRange},this.getCurrentQuery=()=>this._currentQuery,this.getIsSameWordQueriesDismissed=()=>{var e;return null!==(e=this._isCurrentQueryDismissed)&&void 0!==e&&e},this.updateCurrentQuery=e=>{var t,n,r,i,o,a,s;if(this._currentQuery=e,this._isCurrentQueryDismissed&&(this._isCurrentQueryDismissed=!1),!(null===(t=this.hostSettings.oaSettings)||void 0===t?void 0:t.e2eMetric))return;const l=this._currentQuery.queryRange.length===(null!==(r=null===(n=this._currentQuery.queryRange.prefix)||void 0===n?void 0:n.length)&&void 0!==r?r:1),d={logicalId:this._currentQuery.additionalData.logicalId||"",conversationId:this._currentQuery.additionalData.conversationId||"",clientCorrelationId:this._clientCorrelationId||"",triggerCharacter:null!==(i=this._currentQuery.queryRange.prefix)&&void 0!==i?i:"@",isEmptyQuery:l,queryLength:this._currentQuery.queryRange.length-(null!==(a=null===(o=this._currentQuery.queryRange.prefix)||void 0===o?void 0:o.length)&&void 0!==a?a:1)};null===(s=this._oaMetric)||void 0===s||s.startEntry(this._currentQuery.additionalData.logicalId,d)},this.getCurrentQueryTileId=()=>{var e;return null===(e=this._currentQuery)||void 0===e?void 0:e.tileId},this.getCurrentQueryLogicalId=()=>{var e;return null===(e=this._currentQuery)||void 0===e?void 0:e.additionalData.logicalId},this.getCurrentQueryConversationId=()=>{var e;return null===(e=this._currentQuery)||void 0===e?void 0:e.additionalData.conversationId},this.getCurrentQueryCorrelationKeys=()=>{var e;return null===(e=this._currentQuery)||void 0===e?void 0:e.additionalData},this.getPreviousQueryCorrelationKeys=()=>this._previousData,this.removeDetectedQuery=()=>{var e;this._previousData=null===(e=this._currentQuery)||void 0===e?void 0:e.additionalData,this._currentQuery=void 0,this._currentScope=void 0,this._unsupportedEntities=[]},this.setCurrentQueryRange=(e,t,n,r,i)=>{var o,a;return this.updateCurrentQuery({tileId:e,queryRange:t,additionalData:{triggerCharacter:i,scopeInfo:r,logicalId:this.registerNewLogicalId(),conversationId:n?(null===(o=this._currentQuery)||void 0===o?void 0:o.additionalData.conversationId)||"":(new hi.L).generate(),clientCorrelationId:this._clientCorrelationId||""}}),null===(a=this._currentQuery)||void 0===a?void 0:a.additionalData},this.getCurrentScope=()=>this._currentScope,this.setCurrentScope=(e,t=!0)=>{this._currentScope=e,this._currentQuery&&t&&this.updateCurrentQuery(Object.assign(Object.assign({},this._currentQuery),{additionalData:Object.assign(Object.assign({},this._currentQuery.additionalData),{logicalId:this.registerNewLogicalId(),scopeInfo:this._currentScope})}))},this.getUnsupportedEntities=()=>this._unsupportedEntities,this.setUnsupportedEntities=e=>{this._unsupportedEntities=e,this._currentQuery&&this.updateCurrentQuery(Object.assign(Object.assign({},this._currentQuery),{additionalData:Object.assign(Object.assign({},this._currentQuery.additionalData),{unsupportedEntities:this._unsupportedEntities})}))},this.setClientCorrelationId=e=>{this._clientCorrelationId=e},this.setNextDeltaProgramaticallyInserted=e=>{this._isNextDeltaProgrammaticallyInserted=!0,this._programmaticallyInsertedSource=e},this.resetNextDeltaProgramaticallyInserted=()=>{this._isNextDeltaProgrammaticallyInserted=!1,this._programmaticallyInsertedSource=void 0},this.dismissCurrentQuery=(e,t,n,r)=>{var i,o,a;this._currentQuery&&(e&&(null===(i=this._logger)||void 0===i||i.logActivity(null!=n?n:"OACurrentQueryDismiss",void 0,[...null!=r?r:[],...(0,K.W)(["interaction",null!=t?t:"escape"],["conversationId",null!==(o=this.getCurrentQueryConversationId())&&void 0!==o?o:""],["logicalId",null!==(a=this.getCurrentQueryLogicalId())&&void 0!==a?a:""])])),this._isCurrentQueryDismissed=!0)},this.handleTileDelta=(e,t,n,r,i)=>{var o,a,s,l,d,u,c,g,h,p,f;const{deltaType:v,unit:m,length:y,content:_,position:b}=t;return v!==gn.WI.Update||0!==y||_?void 0===y||void 0===b?this.getIfLocal(r)?{queryRange:null===(s=this._currentQuery)||void 0===s?void 0:s.queryRange,additionalData:null===(l=this._currentQuery)||void 0===l?void 0:l.additionalData}:{queryRange:void 0,additionalData:void 0}:m!==gn.OD.Sentence&&m!==gn.OD.Paragraph||v!==gn.WI.Add&&v!==gn.WI.Update||!((null!==(u=null===(d=null==_?void 0:_.trim())||void 0===d?void 0:d.length)&&void 0!==u?u:0)>1||0===(null===(c=null==_?void 0:_.trim())||void 0===c?void 0:c.length))||1===(null==_?void 0:_.length)&&Or.xC(_.charCodeAt(0))?this.getIfLocal(r)?(this.handleLocalTileDelta(e,b,y,v,_,n,i),{queryRange:null===(p=this._currentQuery)||void 0===p?void 0:p.queryRange,additionalData:null===(f=this._currentQuery)||void 0===f?void 0:f.additionalData}):(this.handleRemoteTileDelta(e,b,y,v,_),{queryRange:void 0,additionalData:void 0}):(this._currentQuery&&this._currentQuery.tileId===e&&v===gn.WI.Update&&_&&i&&_.length!==i.length&&(this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,this._currentScope=void 0),this.getIfLocal(r)?{queryRange:null===(g=this._currentQuery)||void 0===g?void 0:g.queryRange,additionalData:null===(h=this._currentQuery)||void 0===h?void 0:h.additionalData}:{queryRange:void 0,additionalData:void 0}):this.getIfLocal(r)?{queryRange:null===(o=this._currentQuery)||void 0===o?void 0:o.queryRange,additionalData:null===(a=this._currentQuery)||void 0===a?void 0:a.additionalData}:{queryRange:void 0,additionalData:void 0}},this.getIfLocal=e=>this._featureFlagReader.flags.enableQueryOnlyOnLocalChange?e===p.Q0.Local:e===p.Q0.Local||e===p.Q0.Code,this.logQueryDetected=()=>{var e,t,n;null===(e=this._logger)||void 0===e||e.logActivity("OAQueryDetected",void 0,(0,K.W)(["conversationId",null!==(t=this.getCurrentQueryConversationId())&&void 0!==t?t:""],["logicalId",null!==(n=this.getCurrentQueryLogicalId())&&void 0!==n?n:""]))},this.handleLocalTileDelta=(e,t,n,r,i,o,a)=>{var s,l,d;const u=this._isNextDeltaProgrammaticallyInserted,c=this._programmaticallyInsertedSource;if(!this._augloopReconnectionOccurring)if(this._currentQuery){if(this._currentQuery.tileId!==e)return this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,void(this._currentScope=void 0);const{isWithinSearchQuery:g,updatedEditedPosition:h}=this.isWithinSearchQuery(r,t,n,i,null!==(s=null==i?void 0:i.length)&&void 0!==s?s:0,o,a);if(!g)return this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,void(this._currentScope=void 0);if(i&&void 0!==this.FORBIDDEN_CHARS.find((e=>i.includes(e))))return this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,void(this._currentScope=void 0);if(t=h,r===gn.WI.Add&&void 0!==i){const e=o.substring(this._currentQuery.queryRange.start,this._currentQuery.queryRange.start+this._currentQuery.queryRange.length);if(1===i.length&&this.isWhitespace(i.charCodeAt(0))&&this._currentQuery.queryRange.prefix){let t=!0;for(let n=0;n<e.length;n++)if(e.charAt(n)!==this._currentQuery.queryRange.prefix){t=!1;break}if(t)return this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,void(this._currentScope=void 0)}this._currentQuery.queryRange.length+=i.length}else if(r===gn.WI.Update&&void 0!==i&&n){const e=t-this._currentQuery.queryRange.start,r=this._currentQuery.queryRange.length-e,o=Math.min(n,r);if(this._currentQuery.queryRange.length+=i.length,this._currentQuery.queryRange.length-=o,0===this._currentQuery.queryRange.length)return this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,void(this._currentScope=void 0)}else if(r===gn.WI.Delete){const e=t-this._currentQuery.queryRange.start,r=Math.min(this._currentQuery.queryRange.length-e,n);this._currentQuery.queryRange.length-=r}if((this._currentQuery.queryRange.length<(null!==(d=null===(l=this._currentQuery.queryRange.prefix)||void 0===l?void 0:l.length)&&void 0!==d?d:1)||o.substring(this._currentQuery.queryRange.start+1,this._currentQuery.queryRange.start+this._currentQuery.queryRange.length).trim().split(" ").length>4)&&(this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,this._currentScope=void 0),this._currentQuery&&this._currentQuery.queryRange.length>this.maxQueryLength)return this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,void(this._currentScope=void 0);this._currentQuery&&this.updateCurrentQuery(Object.assign(Object.assign({},this._currentQuery),{additionalData:Object.assign(Object.assign({},this._currentQuery.additionalData),{logicalId:this.registerNewLogicalId(),scopeInfo:this._currentScope,clientCorrelationId:this._clientCorrelationId||"",isUserInsertion:!u,source:c})}))}else if((r===gn.WI.Add||r===gn.WI.Update)&&i){const n=i,r=i.trim();if(this.registeredQueryDetectionStartChars.includes(r)){const i=n.indexOf(r),a=o[t+i-1];if(a&&!(this.isWhitespace(a.charCodeAt(0),!1)||this.ALLOWED_PREVIOUS_CHARS.includes(a)&&!this.registeredQueryDetectionStartChars.includes(a)))return;this.updateCurrentQuery({tileId:e,queryRange:{start:t+i,length:1,prefix:r},additionalData:{triggerCharacter:r,logicalId:this.registerNewLogicalId(),conversationId:(new hi.L).generate(),clientCorrelationId:this._clientCorrelationId||"",scopeInfo:this._currentScope,isUserInsertion:!u,source:c}}),this.logQueryDetected()}else if(i.length>0){for(let e=0;e<i.length;e++)Or.Yv(i.charCodeAt(e))&&this._isCurrentQueryDismissed&&(this._isCurrentQueryDismissed=!1);for(let e=0;e<i.length;e++)if(Or.Yv(i.charCodeAt(e))||this.FORBIDDEN_CHARS.includes(i.charAt(e)))return;if(this.PUNCTUATION_CHARS.includes(i))return;const n=this.getWordBeforeChange(o,t+i.length-1);if(this.registeredQueryDetectionStartChars.includes(n[0])){if(n.indexOf(n[0],1)>0)return;if(this._isCurrentQueryDismissed)return;if(n.length>this.maxQueryLength)return;this.updateCurrentQuery({tileId:e,queryRange:{start:t-n.length+i.length,length:n.length,prefix:n[0]},additionalData:{triggerCharacter:n[0],logicalId:this.registerNewLogicalId(),conversationId:(new hi.L).generate(),clientCorrelationId:this._clientCorrelationId||"",scopeInfo:this._currentScope,isUserInsertion:!u,source:c}}),this.logQueryDetected()}}}},this.handleRemoteTileDelta=(e,t,n,r,i)=>{var o,a;if(!this._currentQuery)return;if(e!==this._currentQuery.tileId)return;if(t>=this._currentQuery.queryRange.start+this._currentQuery.queryRange.length)return;if(t>this._currentQuery.queryRange.start)return this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,void(this._currentScope=void 0);const s=r===gn.WI.Add?null!==(o=null==i?void 0:i.length)&&void 0!==o?o:0:r===gn.WI.Delete?-1*n:r===gn.WI.Update?(null!==(a=null==i?void 0:i.length)&&void 0!==a?a:0)-n:0;this._currentQuery.queryRange.start+=s},this.isWithinSearchQuery=(e,t,n,r,i,o,a)=>{let s=t;if(!this._currentQuery)return{isWithinSearchQuery:!1,updatedEditedPosition:s};if(""===this._currentQuery.queryRange.prefix)return{isWithinSearchQuery:!0,updatedEditedPosition:s};if(s<this._currentQuery.queryRange.start)return{isWithinSearchQuery:!1,updatedEditedPosition:s};if(s===this._currentQuery.queryRange.start&&(e!==gn.WI.Update||r!==this._currentQuery.queryRange.prefix))return{isWithinSearchQuery:!1,updatedEditedPosition:s};if(e===gn.WI.Add&&void 0!==r&&1===i&&s>0){const e=o.charAt(s-1);(e===r||this.isWhitespace(e.charCodeAt(0))&&this.isWhitespace(r.charCodeAt(0)))&&(s-=1)}if(e===gn.WI.Delete&&1===n&&a){const e=o.charAt(s-1),t=a;(e===t||this.isWhitespace(e.charCodeAt(0))&&this.isWhitespace(t.charCodeAt(0)))&&(s-=1)}return s>this._currentQuery.queryRange.start+this._currentQuery.queryRange.length+(e!==gn.WI.Delete?0:-1)?{isWithinSearchQuery:!1,updatedEditedPosition:s}:{isWithinSearchQuery:!0,updatedEditedPosition:s}},this.isWhitespace=(e,t)=>8203===e||Or.Yv(e,t),this.getWordBeforeChange=(e,t)=>{let n;for(n=t;n>=0&&!this.isWhitespace(e.charCodeAt(n));n--);return e.substring(n+1,t+1)},this.registerNewLogicalId=()=>(new hi.L).generate(),this.maxQueryLength=null!==(o=null===(i=this.hostSettings.oaSettings)||void 0===i?void 0:i.maxQueryLength)&&void 0!==o?o:300}};fi=(0,i.__decorate)([(0,Le._)(),(0,i.__param)(0,(0,Me.W)(q.c)),(0,i.__param)(1,(0,Me.W)(Ie.n)),(0,i.__param)(2,(0,Me.W)(m.g)),(0,i.__param)(2,(0,Tt.l)()),(0,i.__param)(3,(0,Me.W)(pi.u)),(0,i.__param)(3,(0,Tt.l)())],fi);class vi{get uniqueId(){return(0,Je.z)(507917961)}configureRootServices(e){e.bind(_.J).to(fi)}}var mi=n(8730);let yi=class extends ni.z{constructor(){super(...arguments),this.stores=new Map}setCanvasElement(e,t){this.stores.set(e,new _i(t)),this.publishEvent("stateUpdated",{stores:this.stores})}getShadowElementStore(e){return this.stores.get(e)}removeShadowElementStore(e){this.stores.delete(e),this.publishEvent("stateUpdated",{stores:this.stores})}};yi=(0,i.__decorate)([(0,Le._)()],yi);class _i extends ni.z{constructor(e){super(),this.anchor=e,this.container=void 0,this.overlay=void 0,this._updateOverlay=()=>new Promise((()=>{})),this.updateOverlay=async()=>{await this._updateOverlay()},this.setUpdateOverlay=e=>{this._updateOverlay=e,this.publishStateChange()},this.setShadowElement=(e,t)=>{this.container=e,this.overlay=t,this.publishStateChange()}}publishStateChange(){this.publishEvent("stateUpdated",{anchor:this.anchor,container:this.container,overlay:this.overlay})}}var bi=n(37842),Ci=n(8676),Si=n(95734),Ti=n(73232);const Ii=(0,bi.F5)({safeWindow:Ci.A.on(je.j)}),wi=e=>{const{safeWindow:t}=(0,bi.KN)(Ii),{store:n}=e,r=n.anchor,i=Si.useRef(!1),o=Si.useRef(null),a=Si.useRef(null),s=Si.useRef({top:0,left:0}),l=Si.useRef([]),[d,u]=Si.useState({container:{display:"none"},overlay:{display:"none"},anchorStyle:{position:"static"}}),c=(0,Ti.uE)(r,d.overlay.paddingBottom),g=Object.assign({},d.overlay),h=()=>{const e=(0,Ti.dB)(r,a.current,s),t=(0,Ti.Cf)(r);s.current={top:e.top,left:e.left},u((()=>((()=>{const e=r.scrollLeft,t=r.scrollTop;o.current&&(o.current.scrollLeft=e,o.current.scrollTop=t)})(),{container:e,overlay:t.overlay,anchorStyle:t.anchor}))),n.setShadowElement(a.current,o.current)},p=()=>{var e;e=h,t.requestAnimationFrame((()=>{i.current||e()}))},f=()=>new Promise((e=>{p(),l.current.push(e)}));return Si.useEffect((()=>(p(),n.setUpdateOverlay(f),()=>{i.current=!0})),[]),Si.useEffect((()=>{for(const e of l.current)e();l.current=[]}),[d]),r.isConnected?Si.createElement("div",{ref:a,style:d.container},Si.createElement("div",{style:g,className:"hc-noadjust"},Si.createElement("div",{style:c,ref:o},Si.createElement("span",{"aria-hidden":"true"},r.value)))):null};var Ei=n(38883),xi=n(13956);const Ai=(0,bi.F5)({store:Ci.A.on(pt.S)}),Di=()=>{const{store:e}=(0,bi.KN)(Ai),[t,n]=Si.useState(e.stores);return Si.useEffect((()=>{const t=e=>{n(e.stores)};return e.subscribe("stateUpdated",t),()=>{e.unsubscribe("stateUpdated",t)}}),[e]),Si.createElement(Si.Fragment,null,Array.from(t.values()).map((e=>{var t;return Ei.createPortal(Si.createElement("editor-shadow",{style:{overflow:"auto"}},Si.createElement(Si.Fragment,null,Si.createElement("style",null,"\n  @media print {\n    .ms-editor-shadow-container {\n      display:none !important;\n    }\n  }\n  .ms-editor-shadow-container {\n    all: initial;\n  }"),Si.createElement(xi.Ay.div,{className:"ms-editor-shadow-container"},Si.createElement(wi,{store:e})))),null!==(t=e.anchor.parentElement)&&void 0!==t?t:window.document.body)})))};class ki{get uniqueId(){return(0,Je.z)(507918362)}configureRootServices(e){e.bind(pt.S).to(yi),e.bind(mi.i).toValue(Di)}}var Fi=n(19422),Pi=n(7044),Ni=n(46965),Bi=n(6722),Oi=n(12609),Ri=n(72195),Li=n(83745),Mi=function(e){var t=e.className,n=Si.useState((function(){return(0,Oi.O)()}))[0],r=e.id,o=void 0===r?n:r,a=Si.useRef({hostId:o,rootRef:Si.useRef(null),notifyLayersChanged:function(){}});return Si.useImperativeHandle(e.componentRef,(function(){return a.current})),Si.useEffect((function(){(0,Li.$K)(o,a.current),(0,Li.K3)(o)}),[]),(0,Bi.i)((function(){(0,Li.a$)(o,a.current),(0,Li.K3)(o)})),Si.createElement("div",(0,i.__assign)({},e,{className:(0,Ri.A)("ms-LayerHost",t),ref:a.current.rootRef}))};n(29308);var qi=n(75901),Wi=Si.createContext(void 0).Provider;function Ui(e,t){var n;const r=e;var i;return Boolean((null==r||null===(n=r.ownerDocument)||void 0===n?void 0:n.defaultView)&&r instanceof r.ownerDocument.defaultView[null!==(i=null==t?void 0:t.constructorName)&&void 0!==i?i:"HTMLElement"])}var zi=n(96406);const ji="data-fui-focus-visible";function Hi(e,t){if(Vi(e))return()=>{};const n={current:void 0},r=(0,zi.SQ)(t);function i(e){r.isNavigatingWithKeyboard()&&Ui(e)&&(n.current=e,e.setAttribute(ji,""))}function o(){n.current&&(n.current.removeAttribute(ji),n.current=void 0)}r.subscribe((e=>{e||o()}));const a=e=>{o(),i(e.composedPath()[0])},s=t=>{(!t.relatedTarget||Ui(t.relatedTarget)&&!e.contains(t.relatedTarget))&&o()};return e.addEventListener(zi.Oy,a),e.addEventListener("focusout",s),e.focusVisible=!0,e.contains(t.document.activeElement)&&i(t.document.activeElement),()=>{o(),e.removeEventListener(zi.Oy,a),e.removeEventListener("focusout",s),delete e.focusVisible,(0,zi.bd)(r)}}function Vi(e){return!!e&&(!!e.focusVisible||Vi(null==e?void 0:e.parentElement))}const Gi=new RegExp("([^\\s]*fui-FluentProvider\\w+)","g"),Qi=e=>{const{children:t}=e,n=function(){const e=(0,qi.q)();return Si.useMemo((()=>{var t;return null!==(t=e.match(Gi))&&void 0!==t?t:[]}),[e])}(),r=Si.useCallback((e=>{let t=()=>{};return e.classList.add(...n),e.ownerDocument.defaultView&&(t=Hi(e,e.ownerDocument.defaultView)),()=>{e.classList.remove(...n),t()}}),[n]);return Si.createElement(Wi,{value:r},t)};var Ki=n(63503);const $i=(0,bi.F5)({editorCanvasInjectableComponents:Ci.A.onAll(mi.i).optional(),guidGenerator:Ci.A.on(Vr.G),languageScriptDirectionDetector:Ci.A.on(Ni.iw).optional(),targetWindowRef:Ci.A.on(j.sh),hostSettings:Ci.A.on(Ie.n),themeStore:Ci.A.on(N.YQ)}),Zi=()=>{const{editorCanvasInjectableComponents:e,guidGenerator:t,hostSettings:n,languageScriptDirectionDetector:r,targetWindowRef:i,themeStore:o}=(0,bi.KN)($i),a=Si.useRef(t.generate()),[s,l]=Si.useState(null==r?void 0:r.uxLanguageDir),[d,u]=Si.useState(o.getFluentActiveTheme());Si.useEffect((()=>{if(r){const e=e=>{l(e.uxLanguageDir)};return r.subscribe("stateUpdated",e),()=>{r.unsubscribe("stateUpdated",e)}}return()=>{}}),[r]),Si.useEffect((()=>{const e=()=>{u(o.getFluentActiveTheme())};return o.subscribe("currentThemeUpdated",e),o.subscribe("defaultThemeUpdated",e),o.subscribe("fluentThemesUpdated",e),()=>{o.unsubscribe("currentThemeUpdated",e),o.unsubscribe("defaultThemeUpdated",e),o.unsubscribe("fluentThemesUpdated",e)}}),[o]);const c=()=>{const t=null==e?void 0:e.map(((e,t)=>Si.createElement(e,{key:"injectableComponent"+t})));return Si.createElement(Pi.q,{theme:d},Si.createElement(N.O1.Provider,{value:!!n.useFluentV9},Si.createElement(Qi,null,t)))},g=i.deref();return Si.createElement("div",{dir:s,style:{all:"initial"}},Si.createElement(Ki.IF,{window:null!=g?g:window},n.renderWithinShadowDOM||!n.useFluentV9&&n.renderWithinSeparateLayer?(()=>{var e;return Si.createElement(Si.Fragment,null,Si.createElement(Mi,{id:a.current,style:{position:"fixed",zIndex:null!==(e=n.editorCardZIndex)&&void 0!==e?e:1e6,inset:0,visibility:"hidden"}}),Si.createElement(Fi.d.Provider,{value:a.current},c()))})():c()))};var Ji=n(61358);class Xi extends Si.Component{constructor(e){super(e),this.retryTimer=0,this.labelErrorStyle={display:"none"},this.tryRecover=()=>{var e;this.props.maxRecoveryRetry>(this.state.retryNumber||0)&&(window.clearTimeout(this.retryTimer),this.retryTimer=window.setTimeout((()=>{var e;const t=(null!==(e=this.state.retryNumber)&&void 0!==e?e:0)+1;this.setState({hasError:!1,retryNumber:t})}),1e3*(null!==(e=this.state.retryNumber)&&void 0!==e?e:1)))},this.state={hasError:!1,retryNumber:0}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){var n;const{logger:r,errorEventName:i,errorMessage:o}=this.props;Ji.R.logUnhandledError(r,{error:e,errorInfo:t,retryCount:null!==(n=this.state.retryNumber)&&void 0!==n?n:0},i,o)}componentWillUnmount(){window.clearTimeout(this.retryTimer)}componentDidUpdate(){this.state.hasError&&this.tryRecover()}render(){return this.state.hasError?Si.createElement("div",{"aria-hidden":"true",style:this.labelErrorStyle,className:"ms-editor-rendering-error"},`${this.state.retryNumber}/${this.props.maxRecoveryRetry}`):this.props.children}}var Yi=n(2070);class eo extends Q.O{constructor(e,t,n){super(e),this.logger=t,this.derefFailedLogMessage=n}deref(){const e=super.deref();return e||this.logger.error(508143266,this.derefFailedLogMessage,new Error(this.derefFailedLogMessage)),e}}const to="__reactEvents";class no{constructor(e){this.element=new Q.O(e),this.replacedElements=[],this.ownerDocument=new Q.O(e.ownerDocument)}replaceListener(e){var t;if(!e)return;const n=new Q.O(e),r=e.addEventListener,i=new Q.O(r),o={},a=[];for(const t in e)t.startsWith(to)&&a.push(t);e.addEventListener=(e,t,r)=>{const a=i.deref(),s=n.deref();a&&s&&(e in o||(o[e]=[]),o[e].push({listener:t,options:r}),a.apply(s,[e,t,r]))},null===(t=this.replacedElements)||void 0===t||t.push({element:n,eventHandlers:o,restoreOriginalAddEventListener:()=>{e.addEventListener=r},existingReactEvents:a})}render(e){var t,n;const r=null===(t=this.element)||void 0===t?void 0:t.deref(),i=null===(n=this.ownerDocument)||void 0===n?void 0:n.deref();if(i&&r){this.replaceListener(r),this.replaceListener(r.firstElementChild),this.replaceListener(r.host),this.replaceListener(i),this.replaceListener(i.defaultView);try{return e()}finally{if(this.replacedElements)for(let e=this.replacedElements.length-1;e>=0;e--){const t=this.replacedElements[e],n=t.element.deref(),r=t.restoreOriginalAddEventListener;if(null==r||r(),t.restoreOriginalAddEventListener=void 0,n&&t.existingReactEvents){t.reactEventsToClear=[];for(const e in n)e.startsWith(to)&&!t.existingReactEvents.includes(e)&&t.reactEventsToClear.push(e)}t.existingReactEvents=void 0}}}}cleanup(){var e;if(!this.replacedElements||!this.ownerDocument)return;const t=this.ownerDocument.deref();for(const n of this.replacedElements){for(const r in n.eventHandlers){const i=n.element.deref();for(const o of n.eventHandlers[r])null==i||i.removeEventListener(r,o.listener,o.options),null===(e=null==t?void 0:t.defaultView)||void 0===e||e.removeEventListener(r,o.listener,o.options);if(i&&n.reactEventsToClear)for(const e of n.reactEventsToClear)i[e]=void 0}n.eventHandlers={}}this.replacedElements=void 0,this.ownerDocument=void 0,this.element=void 0}}var ro=n(53756),io=n(42727),oo=n(19635);const ao=e=>{const t=(0,oo.G)();return Si.createElement(so,Object.assign({},e,{parentContainer:t}))};class so extends Si.Component{constructor(e){super(e),this.state={injector:void 0}}get rootInjector(){if(!this.context)throw new Error("Component must be within RootInjector context");return this.context}componentDidMount(){const e=io.z.createContainer(this.props.parentContainer),t=new ro.E(e,this.rootInjector.generateModuleKey);this.props.onConfigureInjector(t),this.setState({injector:t})}render(){const{injector:e}=this.state;return e?Si.createElement(ro.r.Provider,{value:e},this.props.children):null}}so.contextType=be.S;class lo extends Si.Component{constructor(e){super(e),this.onConfigureInjector=e=>{e.addModule(this.props.value)},this.state={rootInjectorConfigured:!1}}get rootInjector(){if(!this.context)throw new Error("Component must be within RootInjector context");return this.context}componentDidMount(){this.onConfigureInjector(this.rootInjector),this.setState({rootInjectorConfigured:!0})}render(){return this.state.rootInjectorConfigured?Si.createElement(ao,{onConfigureInjector:this.onConfigureInjector},this.props.children):null}}lo.contextType=be.S;class uo extends Si.PureComponent{constructor(e){var t;super(e),this.injector=null!==(t=e.injector)&&void 0!==t?t:new be.J,this.entryModule=e.entryModule}render(){return this.entryModule?Si.createElement(be.S.Provider,{value:this.injector},Si.createElement(lo,{value:this.entryModule},this.props.children)):Si.createElement(be.S.Provider,{value:this.injector},this.props.children)}}var co=n(39454);function go(e,t,n){var r,i;for(const o of e)if((!o.dataset.bindId||!t.head.querySelector(`style[data-bind-id='${o.dataset.bindId}']`))&&(null===(r=o.sheet)||void 0===r?void 0:r.cssRules.length)){const e=t.createElement("style");Array.from(o.attributes).forEach((t=>{t.nodeValue&&e.setAttribute(t.nodeName,t.nodeValue)}));const r=o.dataset.bindId||n.generate();o.dataset.bindId=r,e.dataset.bindId=r,t.head.appendChild(e);for(let t=0;t<o.sheet.cssRules.length;t++){const n=o.sheet.cssRules.item(t);n&&(null===(i=e.sheet)||void 0===i||i.insertRule(n.cssText,t))}}}function ho(e,t,n,r){var i,o,a,s;const l=null!=r?r:Array.from(e.querySelectorAll(t)),d=Array.from(n.querySelectorAll(t));for(const e of d)(null===(i=e.originalElement)||void 0===i?void 0:i.isConnected)||(e.originalElement=void 0,e.remove());for(const e of l)if(null===(o=e.sheet)||void 0===o?void 0:o.cssRules.length){const t=d.find((t=>t.originalElement===e));if(null===(a=null==t?void 0:t.sheet)||void 0===a?void 0:a.cssRules.length)for(let n=t.sheet.cssRules.length;n<e.sheet.cssRules.length;n++){const r=e.sheet.cssRules.item(n);r&&t.sheet.insertRule(r.cssText,n)}else{t&&(t.originalElement=void 0,t.remove());const r=n.ownerDocument.createElement("style");r.originalElement=e;for(const t of Array.from(e.attributes))t.nodeValue&&r.setAttribute(t.nodeName,t.nodeValue);n.appendChild(r);for(let t=0;t<e.sheet.cssRules.length;t++){const n=e.sheet.cssRules.item(t);n&&(null===(s=r.sheet)||void 0===s||s.insertRule(n.cssText,t))}}}}var po=n(16715);class fo{constructor(e){var t,n,r;this.injector=e,this.render=()=>{var e,t;const n=this.injector.container.get(m.g),r=Si.createElement(Xi,{errorEventName:Yi.s.UnhandledContentError,logger:n,maxRecoveryRetry:10,errorMessage:"Unhandled render content script error"},Si.createElement(uo,{injector:this.injector},Si.createElement(Zi,null))),i=null!==(t=null===(e=this.editorCardShadowRoot)||void 0===e?void 0:e.firstElementChild)&&void 0!==t?t:this.editorCard;(0,po.d)(i,r)},this.onWindowUnload=()=>{try{this.shutDown()}catch(e){}};const i=this.injector.container.get(Ie.n);this.targetDocument=null!==(t=this.injector.container.getOptional(j.jh))&&void 0!==t?t:new Q.O(document);const o=this.injector.container.getOptional(Ni.iw),a=this.targetDocument.deref();a&&(this.editorCard=a.createElement("editor-card"),this.editorCard.setAttribute("style",`position:absolute;top:0px;left:0px;z-index:${null!==(n=i.editorCardZIndex)&&void 0!==n?n:"auto"};display: block !important`),o&&this.editorCard.setAttribute("dir",o.dir()),a.body.appendChild(this.editorCard),this.editorCardShadowRoot=i.renderWithinShadowDOM&&a!==document?this.editorCard.attachShadow({mode:"open"}):void 0,this.editorCardShadowRoot&&(this.editorCardShadowRoot.appendChild(document.createElement("div")),(null===(r=i.disposalSettings)||void 0===r?void 0:r.enableReactEventCleanup)&&(this.reactEventCleanup=new no(this.editorCardShadowRoot))))}async initialize(){var e;if(!this.targetDocument||!this.editorCard)return;const t=this.targetDocument.deref();if(!t)return;const n=this.injector.container.get(m.g);n.debug(520984577,"[ReactApp] Render main app view");const r=this.injector.container.get(Ie.n);if(this.editorCardShadowRoot||!r.disableStyleCopying&&t!==document){const n=this.injector.container.get(Vr.G);this.disposal=r.enablePersistentStyleCopying?function(e,t,n='style[data-merge-styles="true"], style[data-load-themed-styles="true"], style#ms-prediction-style',r=document){go(Array.from(r.querySelectorAll(n)),e,t);const i=new MutationObserver((i=>{const o=[],a=Array.from(r.querySelectorAll(n));for(const e of i){const t=Array.from(e.addedNodes).filter((e=>(0,at.C)(e,"HTMLStyleElement")));for(const e of t){const t=a.find((t=>t.isSameNode(e)));t&&o.push(t)}}o.length&&go(o,e,t)}));i.observe(r.head,{childList:!0,subtree:!0});const o=co.nr.getInstance().onInsertRule((()=>{!function(e,t){var n,r;if(e.length)for(const i of e){const e=t.head.querySelector(`style[data-bind-id="${i.dataset.bindId}"]`);if((null===(n=i.sheet)||void 0===n?void 0:n.cssRules.length)&&(null===(r=null==e?void 0:e.sheet)||void 0===r?void 0:r.cssRules.length))for(let t=e.sheet.cssRules.length;t<i.sheet.cssRules.length;t++){const n=i.sheet.cssRules.item(t);n&&e.sheet.insertRule(n.cssText,t)}}}(Array.from(r.querySelectorAll("style[data-bind-id]")),e)}));return()=>{i.disconnect(),o()}}(t,n):function(e,t='style[data-merge-styles="true"], style[data-make-styles-bucket], style[data-load-themed-styles="true"], style#ms-prediction-style',n=document){ho(n,t,e);const r=new MutationObserver((r=>{const i=[];for(const e of r)i.push(...Array.from(e.addedNodes).concat(Array.from(e.removedNodes)).concat(Array.from([e.target])).map((e=>{var t;return"STYLE"===e.nodeName?e:"STYLE"===(null===(t=e.parentElement)||void 0===t?void 0:t.nodeName)?e.parentElement:void 0})).filter((e=>!!e)));i.length&&ho(n,t,e,i)})),i=co.nr.getInstance().onInsertRule((()=>{ho(n,t,e)}));return r.observe(n.head,{childList:!0,subtree:!0,attributes:!0}),()=>{i(),r.disconnect();const n=Array.from(e.querySelectorAll(t));for(const e of n)e.originalElement&&(e.originalElement=void 0,e.remove());for(const t of Array.from(e.childNodes))t.originalElement&&(t.originalElement=void 0,t.remove())}}(null!==(e=this.editorCardShadowRoot)&&void 0!==e?e:t.head)}window.frameElement&&(this.windowEventListener=new W.J(window),this.windowEventListener.addListener("pagehide",this.onWindowUnload,{once:!0})),this.injector.container.bind(j.q4).toValue(new eo(this.editorCard,n,"Target render element ref is unavailable")),this.reactEventCleanup?this.reactEventCleanup.render(this.render):this.render()}shutDown(){var e,t,n,r,i,o;try{null===(e=this.disposal)||void 0===e||e.call(this)}catch(e){}if(this.editorCard)try{Ei.unmountComponentAtNode(null!==(n=null===(t=this.editorCardShadowRoot)||void 0===t?void 0:t.firstElementChild)&&void 0!==n?n:this.editorCard)}catch(e){}null===(r=this.reactEventCleanup)||void 0===r||r.cleanup(),this.reactEventCleanup=void 0,null===(i=this.windowEventListener)||void 0===i||i.removeAllListeners(),this.windowEventListener=void 0,this.disposal=void 0,null===(o=this.editorCard)||void 0===o||o.remove(),this.editorCard=void 0,this.editorCardShadowRoot=void 0,this.targetDocument=void 0}}let vo=class{constructor(e){this._injector=e,this._initialized=!1,this._shutDown=!1}async initializeComponent(){if(this._initialized)return;this._initialized=!0;const e=this._injector.container.getOptional(Ee);if(e){const t=e.map((e=>e())),n=await Promise.all(t);for(const e of n)if(Array.isArray(e))for(const t of e)this._injector.addModule(t);else this._injector.addModule(e);await this._injector.container.get(H.V).recheckRegistrables(this._injector.container)}this._shutDown||(this.reactApp=await this.loadReactApp(),this._shutDown?this.reactApp.shutDown():await this.reactApp.initialize())}shutDown(){var e;this._shutDown=!0,null===(e=this.reactApp)||void 0===e||e.shutDown(),this.reactApp=void 0}};vo=(0,i.__decorate)([(0,Le._)(),(0,i.__param)(0,(0,Me.W)(be.J))],vo);let mo=class extends vo{async loadReactApp(){return new fo(this._injector)}};mo=(0,i.__decorate)([(0,Le._)()],mo);class yo{constructor(){this.imports=[]}get uniqueId(){return(0,Je.z)(507918243)}configureRootServices(e){e.bind(_e).to(mo)}}var _o=n(49208),bo=n(81108);class Co{constructor(){this.imports=[bo.N,_o.J]}get uniqueId(){return(0,Je.z)(50786e4)}configureRootServices(e){}}let So=class{constructor(){this._applyHandlerMap=new Map,this._ignoreHandlerMap=new Map,this._ignoreAllHandlerMap=new Map,this._disableHandlerMap=new Map}handleApplyFlag(e,t){return this._applyHandlerMap.set(e,t),()=>this._applyHandlerMap.delete(e)}onApplyFlag(e,t,n,r){const i=this._applyHandlerMap.get(t.typeId);return!!i&&i(e,t,n,r)}handleIgnoreFlag(e,t){return this._ignoreHandlerMap.set(e,t),()=>this._ignoreHandlerMap.delete(e)}onIgnoreFlag(e,t){const n=this._ignoreHandlerMap.get(t.typeId);return!!n&&n(e,t)}handleIgnoreAllOfFlag(e,t){return this._ignoreAllHandlerMap.set(e,t),()=>this._ignoreAllHandlerMap.delete(e)}onIgnoreAllOfFlag(e,t){const n=this._ignoreAllHandlerMap.get(t.typeId);return!!n&&n(e,t)}handleDisableFlag(e,t){return this._disableHandlerMap.set(e,t),()=>this._disableHandlerMap.delete(e)}onDisableFlag(e,t){const n=this._disableHandlerMap.get(t.typeId);return!!n&&n(e,t)}};So=(0,i.__decorate)([(0,Le._)()],So);var To=n(84457);(0,l.f)("IEditorCritiqueGroups");const Io=(0,l.f)("ICIQFlagEditorCategories");function wo(e,t){return t?t.OnCanvasCalloutStrings[e]:(0,xe.$)().getString("OnCanvasCalloutStrings",e)}const Eo=Si.createContext(void 0),xo={};Eo.Provider;var Ao=n(30513),Do=n(29944);const ko=(0,Ao.X)({root:{mc9l5x:"f1w7gpdv",Bg96gwp:"fez10in",ycbfsm:"fg4l7m0"},rtl:{Bz10aip:"f13rod7r"}},{d:[".f1w7gpdv{display:inline;}",".fez10in{line-height:0;}",".f13rod7r{-webkit-transform:scaleX(-1);-moz-transform:scaleX(-1);-ms-transform:scaleX(-1);transform:scaleX(-1);}"],t:["@media (forced-colors: active){.fg4l7m0{forced-color-adjust:auto;}}"]}),Fo=(e,t)=>{const{title:n,primaryFill:r="currentColor",...i}=e,o={...i,title:void 0,fill:r},a=ko(),s=Si.useContext(Eo)?Si.useContext(Eo):xo;return o.className=(0,Do.z)(a.root,(null==t?void 0:t.flipInRtl)&&"rtl"===(null==s?void 0:s.textDirection)&&a.rtl,o.className),n&&(o["aria-label"]=n),o["aria-label"]||o["aria-labelledby"]?o.role="img":o["aria-hidden"]=!0,o},Po=(e,t,n,r)=>{const i="1em"===t?"20":t,o=Si.forwardRef(((e,o)=>{const a={...Fo(e,{flipInRtl:null==r?void 0:r.flipInRtl}),ref:o,width:t,height:t,viewBox:`0 0 ${i} ${i}`,xmlns:"http://www.w3.org/2000/svg"};return Si.createElement("svg",a,...n.map((e=>Si.createElement("path",{d:e,fill:a.fill}))))}));return o.displayName=e,o},No=Po("CalendarDate20Filled","20",["M17 7v7.5a2.5 2.5 0 0 1-2.34 2.5H5.5A2.5 2.5 0 0 1 3 14.66V7h14Zm-5.48 1.23c-.53 0-.96.15-1.27.43-.31.28-.47.67-.47 1.15 0 .28.07.53.21.75.15.21.34.39.58.51-.29.13-.51.32-.67.56-.17.24-.25.51-.25.82 0 .5.17.9.51 1.19a2 2 0 0 0 1.36.44 2 2 0 0 0 1.35-.44c.34-.3.51-.7.51-1.2 0-.3-.08-.56-.24-.8a1.62 1.62 0 0 0-.69-.57c.25-.12.45-.3.59-.51.14-.22.21-.47.21-.75 0-.48-.15-.87-.46-1.15a1.82 1.82 0 0 0-1.27-.43ZM8.5 8.3h-.13l-2.21.82v.8l1.4-.48V14h.94V8.3Zm3.01 3.17c.28 0 .5.09.67.26.17.17.25.4.25.68 0 .3-.08.52-.24.68a.9.9 0 0 1-.67.24.9.9 0 0 1-.67-.25.91.91 0 0 1-.25-.67c0-.28.09-.5.25-.68a.88.88 0 0 1 .66-.26Zm0-2.46c.25 0 .44.08.58.24.15.16.22.36.22.6 0 .27-.07.48-.21.63a.75.75 0 0 1-.58.23.75.75 0 0 1-.58-.23.88.88 0 0 1-.2-.62c0-.27.06-.47.2-.63a.74.74 0 0 1 .58-.22Zm2.99-6A2.5 2.5 0 0 1 17 5.34V6H3v-.5A2.5 2.5 0 0 1 5.34 3h9.16Z"]),Bo=Po("CalendarDate20Regular","20",["M14.5 3A2.5 2.5 0 0 1 17 5.34v9.16a2.5 2.5 0 0 1-2.34 2.5H5.5A2.5 2.5 0 0 1 3 14.66V5.5A2.5 2.5 0 0 1 5.34 3h9.16ZM16 7H4v7.5c0 .78.6 1.42 1.36 1.5h9.14c.78 0 1.42-.6 1.5-1.36V7Zm-4.48 1.23c.53 0 .95.15 1.27.43.3.28.46.67.46 1.15 0 .28-.07.53-.21.75-.14.21-.34.39-.59.51.3.14.53.33.69.57.16.24.24.5.24.8 0 .5-.17.9-.5 1.2a2 2 0 0 1-1.36.44 2 2 0 0 1-1.36-.44 1.5 1.5 0 0 1-.5-1.2c0-.3.07-.57.24-.81.16-.24.38-.43.67-.56-.24-.12-.43-.3-.58-.51a1.33 1.33 0 0 1-.2-.75c0-.48.15-.87.46-1.15.31-.28.74-.43 1.27-.43ZM8.5 8.3V14h-.95V9.43l-1.4.48v-.8l2.22-.82h.13Zm3.01 3.17c-.27 0-.5.09-.66.26a.94.94 0 0 0-.25.68c0 .28.08.5.25.67a.9.9 0 0 0 .67.25.9.9 0 0 0 .67-.24.92.92 0 0 0 .24-.68c0-.28-.08-.5-.25-.68a.89.89 0 0 0-.67-.26Zm0-2.46a.74.74 0 0 0-.57.22.88.88 0 0 0-.2.63c0 .26.06.47.2.62.15.15.34.23.58.23.24 0 .43-.08.58-.23a.88.88 0 0 0 .2-.62.88.88 0 0 0-.2-.61.74.74 0 0 0-.58-.24Zm2.99-5h-9c-.78 0-1.42.6-1.5 1.36V6h12v-.5c0-.78-.6-1.42-1.36-1.5h-.14Z"]);var Oo=n(91752),Ro=n(71234),Lo=n(97847),Mo=n(85899),qo=n(48574),Wo=n(26017),Uo=n(71108);let zo=class{constructor(e,t,n,r,i,o,a,s){this._hostEmitters=e,this._hostSettings=t,this._proofingDom=n,this._logger=r,this._critiqueStore=i,this._disableCritiqueHandler=o,this._instrumentationProcessor=a,this._applyFlagHandler=s,this._annotationMap=new Map,this._isDisabled=!1,this.shutDownCallbacks=[],this.ignoredStrings=[],this.shutDown=()=>{for(const e of this.shutDownCallbacks)e();this.flagHandlerShutdown()},this.getFlagData=e=>this._annotationMap.get(e),this.onIgnoreAllOfFlag=(e,t)=>{},this.removeFlag=(e,t)=>{const n=this._annotationMap.get(t);if(!n)return;const r=this.getCommonCritiqueById(n.critique.annotationId);r&&r.isIgnored||(this.emitEvent(h.G.RemoveData,[n.critique],n.critique.nodeId,e),this._annotationMap.delete(t))},this.onHostModelCritiques=e=>{for(const t of e.message.data.critiqueIdsRemoved)this._annotationMap.delete(t)},this.getCommonCritiqueById=e=>{let t;for(const n of this._critiqueStore.getAllCritiques())for(const r of n.critiques)r.annotationId===e&&(t=r);return t},this.onApplyFlag_Internal=(e,t,n,r)=>{if(!t.annotationId)return!0;const i=this._annotationMap.get(t.annotationId);if(i){const e=t.nodeId?this._proofingDom.findParagraphNode(t.nodeId):void 0;if(!(0,P.l)(e))return this._logger.error(508146688,"Unable to find paragraph node while applying flag"),!1;this.onApplyFlag(e,t,n,r),this._annotationMap.delete(t.annotationId),this.emitEvent(h.G.RemoveData,[i.critique],i.critique.nodeId),this._instrumentationProcessor.process({critique:(0,ye.toJS)(t),eventId:pn.xp.ChangeAllSuggOther})}else this._logger.error(508146659,"Unable to find flag data while applying flag");return!1},this.onIgnoreFlag_Internal=(e,t)=>{if(!t.annotationId)return!1;const n=this._annotationMap.get(t.annotationId);if(n){const e=t.nodeId?this._proofingDom.findParagraphNode(t.nodeId):void 0;if(!(0,P.l)(e))return this._logger.error(508146658,"Unable to find paragraph node while ignoring flag"),!1;n.critique.isIgnored=!0,this.onIgnoreFlag(e,t),this._annotationMap.delete(t.annotationId),this._instrumentationProcessor.process({critique:(0,ye.toJS)(t),eventId:pn.xp.Ignore})}else this._logger.error(508146657,"Unable to find flag data while ignoring flag");return!1},this.onIgnoreAllOfFlag_Internal=(e,t)=>{if(!t.annotationId)return!1;const n=this._annotationMap.get(t.annotationId);if(n){const e=t.nodeId?this._proofingDom.findParagraphNode(t.nodeId):void 0;if(!(0,P.l)(e))return this._logger.error(507574145,"Unable to find paragraph node while ignoring all of flag"),!1;if(!t.textInContext)return this._logger.error(507574097,"Unable to find flag textInContext while ignoring all of flag"),!1;this.ignoredStrings.push(t.textInContext),n.critique.isIgnored=!0,this.onIgnoreAllOfFlag(e,t),this._instrumentationProcessor.process({critique:(0,ye.toJS)(t),eventId:pn.xp.IgnoreAll})}else this._logger.error(507574096,"Unable to find flag data while ignoring all of flag");return!1},this.onDisableFlag_Internal=(e,t)=>{var n;if(!t.annotationId)return!1;this._isDisabled=!0,this.onDisableFlag();for(const e of this._annotationMap.values())this.removeFlag(void 0,e.critique.annotationId);return null===(n=this._disableCritiqueHandler)||void 0===n||n.disableCritique(t),this._instrumentationProcessor.process({critique:(0,ye.toJS)(t),eventId:pn.xp.DoNotCheckThisIssue}),!1}}async initialize(){if(this._hostSettings.enableOrchestration){for(const e of this._hostEmitters)e.on(M.pD.hostModelCritiques,this.onHostModelCritiques);this._applyFlagHandler&&(this.shutDownCallbacks.push(this._applyFlagHandler.handleApplyFlag(this.getCritiqueType(),this.onApplyFlag_Internal)),this.shutDownCallbacks.push(this._applyFlagHandler.handleIgnoreFlag(this.getCritiqueType(),this.onIgnoreFlag_Internal)),this.shutDownCallbacks.push(this._applyFlagHandler.handleIgnoreAllOfFlag(this.getCritiqueType(),this.onIgnoreAllOfFlag_Internal)),this.shutDownCallbacks.push(this._applyFlagHandler.handleDisableFlag(this.getCritiqueType(),this.onDisableFlag_Internal))),this.flagHandlerInitialize()}}addFlags(e,t){const n=new Map;for(const e of t){const t=n.get(e.nodeId);t?t.push(e):n.set(e.nodeId,[e])}for(const[t,r]of n)this.addFlagsInSameTile(e,t,r[0].nodeVersion,r)}addFlagsInSameTile(e,t,n,r){if(this._isDisabled)return;const i=r.map((e=>Object.assign(Object.assign({isFlagCritique:!0},e),{nodeId:t,nodeVersion:n,priority:Oo.bx.Informational,suggestions:[],typeId:this.getCritiqueType(),isIgnored:!1}))).filter((e=>{var t,n,r,i,o;if(e.annotationId&&this._annotationMap.get(e.annotationId))return!1;if(e.textInContext&&this.ignoredStrings.includes(e.textInContext))return!1;const a=this._proofingDom.findParagraphNode(e.nodeId);return!!(null===(t=null==a?void 0:a.parent)||void 0===t?void 0:t.element)&&(null===(o=null===(i=null===(r=null===(n=this._hostSettings.serviceSettings)||void 0===n?void 0:n.flagAnnotationSettings)||void 0===r?void 0:r.shouldRenderFlag)||void 0===i?void 0:i.call(r,(0,Zr.OE)(e),a.parent.element,e.nodeId,e.start,length))||void 0===o||o)}));this.emitEvent(h.G.NewData,i,t,e,n);for(const e of i)this._annotationMap.set(e.annotationId,{tileId:t,critique:e,additionalData:e.additionalData})}addFlag(e,t,n,r,i,o,a,s,l,d,u,c,g,h,p,f,v){this.addFlagsInSameTile(e,i,o,[{annotationId:t,textInContext:a,length:l,start:s,languageId:r,traceId:n,supportedActions:d,supportedEntityTypes:u,suggestionItems:c,groupTitle:h,groupSubtitle:p,tooltipTitle:f,categoryTitle:v,additionalData:g}])}emitEvent(e,t,n,r=void 0,i=0){for(const o of this._hostEmitters)o.emit(M.pD.hostModelFlags,{address:r,message:{messageType:h.G.ChangeData,data:{critiquesAdded:e===h.G.NewData?t:[],critiqueIdsRemoved:e===h.G.RemoveData?t.map((e=>e.annotationId)):[],tileId:n,tileVersion:i,source:"Local"}}})}};zo=(0,i.__decorate)([(0,Le._)()],zo);let jo=class extends zo{constructor(e,t,n,r,i,o,a,s,l){super(e,t,n,r,o,a,s,l),this._localizer=i,this.onFlagAnnotationUpdate=e=>{var t,n;const r=e.message.messageType,i=e.message.data;if(r===h.G.NewData&&i.results.length>0){const n=[];for(const e of i.results){if(!qo.uH.typeGuard(e))continue;if(1!==e.results.length||e.results[0].entityType!==Wo.c.DateTime||!Ho(this._hostSettings))continue;const r=e.results[0].subType,o=e.results[0].text;let a,s;try{const e=JSON.parse(o);e.start&&e.end&&("DateRange"===r?(a=Vo(e.start).getTime(),s=Vo(e.end).getTime()):(a=Date.parse(e.start),s=Date.parse(e.end)))}catch(e){}a||s||!Date.parse(o)||(a="Date"===r?Vo(o).getTime():Date.parse(o),s=a);const l=[{entities:[{entityType:Wo.c.DateTime,text:this.getTextForEntity(r),icon:{iconName:Go()},confidence:e.modelMetadata.score,startDateTime:null==a?void 0:a.toString(),endDateTime:null==s?void 0:s.toString(),subType:r}],entityType:Wo.c.DateTime,groupTitle:this._localizer.getMessage("ebx_CIQFlagInsertTitle"),groupSubtitle:this._localizer.getMessage("ebx_CIQFlagInsertSubtitle")}];let d;switch(r){case"Date":d=this._localizer.getMessage("ebx_EntityRecognitionInsertDateTooltipTitle");break;case"Datetime":case"DateTime":d=this._localizer.getMessage("ebx_EntityRecognitionInsertDateTimeTooltipTitle");break;case"DateRange":d=this._localizer.getMessage("ebx_EntityRecognitionInsertDateRangeTooltipTitle");break;case"Time":d=this._localizer.getMessage("ebx_EntityRecognitionInsertTimeTooltipTitle");break;case"TimeRange":d=this._localizer.getMessage("ebx_EntityRecognitionInsertTimeRangeTooltipTitle")}const u=i.tileId+e.id;n.push({annotationId:u,traceId:u,languageId:this._hostSettings.defaultLocale,nodeId:i.tileId,nodeVersion:i.tileVersion,textInContext:null!==(t=e.context)&&void 0!==t?t:"",start:e.range.start,length:e.range.length,supportedActions:Oo.lb.Ignore,supportedEntityTypes:[Wo.c.DateTime],suggestionItems:l,additionalData:e,groupTitle:this._localizer.getMessage("ebx_CIQFlagInsertTitle"),groupSubtitle:this._localizer.getMessage("ebx_CIQFlagInsertSubtitle"),tooltipTitle:d,categoryTitle:this._localizer.getMessage("ebx_DateEntityRecognitionCategoryTitle")})}this.addFlags(e.address,n)}else if(r===h.G.RemoveData){const t=null===(n=this._annotationIdMap)||void 0===n?void 0:n.get(i.annotationId);if(t){const n=[...t];for(const t of n)this.removeFlag(e.address,t)}else this.removeFlag(e.address,i.annotationId)}},this.getTextForEntity=e=>{switch(e){case"Date":return this._localizer.getMessage("ebx_EntityRecognitionInsertDateLabel");case"Datetime":case"DateTime":return this._localizer.getMessage("ebx_EntityRecognitionInsertDateTimeLabel");case"DateRange":return this._localizer.getMessage("ebx_EntityRecognitionInsertDateRangeLabel");case"Time":return this._localizer.getMessage("ebx_EntityRecognitionInsertTimeLabel");case"TimeRange":return this._localizer.getMessage("ebx_EntityRecognitionInsertTimeRangeLabel");default:return""}},this.onApplyFlag=(e,t,n,r)=>{var i,o;t.annotationId&&this._annotationMap.get(t.annotationId)&&(this._annotationMap.delete(t.annotationId),(null===(o=null===(i=this._hostSettings.serviceSettings)||void 0===i?void 0:i.flagAnnotationSettings)||void 0===o?void 0:o.flagInsertionCallback)&&this._hostSettings.serviceSettings.flagAnnotationSettings.flagInsertionCallback(n,r,e.parent.element,n,t))},this.onIgnoreFlag=(e,t)=>{},this.onDisableFlag=()=>{},this._annotationIdMap=new Map}flagHandlerInitialize(){var e,t;if(null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.flagAnnotationSettings)||void 0===t?void 0:t.enabled)for(const e of this._hostEmitters)e.on(M.pD.oaFlagAnnotationsTriggered,this.onFlagAnnotationUpdate)}flagHandlerShutdown(){}getCritiqueType(){return ri.L9.CIQFlag_DateEntityRecognition}};function Ho(e){var t,n;return(0,Mo.i$)(null===(n=null===(t=e.serviceSettings)||void 0===t?void 0:t.flagAnnotationSettings)||void 0===n?void 0:n.entityConfigs,Wo.c.DateTime)}function Vo(e){const t=e.split(/\D+/).map((e=>parseInt(e,10)));return t[1]=t[1]-1,new Date(t[0],t[1],t[2])}function Go(){const e="DateFlag";return(0,B.Z)(e,{regular:Bo,filled:No}),e}jo=(0,i.__decorate)([(0,Le._)(),(0,i.__param)(0,(0,Pn.t)(M.zJ)),(0,i.__param)(1,(0,Me.W)(Ie.n)),(0,i.__param)(2,(0,Me.W)(ge.w)),(0,i.__param)(3,(0,Me.W)(m.g)),(0,i.__param)(4,(0,Me.W)(Ro.H)),(0,i.__param)(5,(0,Me.W)(b.$)),(0,i.__param)(6,(0,Me.W)(x.W)),(0,i.__param)(6,(0,Tt.l)()),(0,i.__param)(7,(0,Me.W)(Lo.f)),(0,i.__param)(8,(0,Tt.l)()),(0,i.__param)(8,(0,Me.W)(Uo.K))],jo);let Qo=class extends zo{constructor(e,t,n,r,i,o,a,s,l,d){super(e,t,n,r,o,a,s,d),this._localizer=i,this._paragraphTextExtractor=l,this.onFlagAnnotationUpdate=e=>{var t,n,r;const i=e.message.messageType,o=e.message.data;if(i===h.G.NewData&&o.results.length>0){const r=o.results.filter((e=>"GraphSearch"===e.ownerId));if(Ko(this._hostSettings)){const i=r.filter((e=>e.results[0].entityType===Wo.c.File)),a=[];for(const e of i){const r={entities:e.results,entityType:Wo.c.File,groupTitle:this._localizer.getMessage("fileEntityLabel")},i=this._paragraphTextExtractor.getParagraphText(o.tileId),s=null!==(t=e.context)&&void 0!==t?t:null==i?void 0:i.substring(e.range.start,e.range.start+e.range.length),l=o.annotationId+(null===(n=e.M_)||void 0===n?void 0:n.seq);if(this._annotationIdMap){let e=this._annotationIdMap.get(o.annotationId);e||(e=new Set),e.add(l)}s&&a.push({annotationId:l,traceId:l,languageId:e.language,nodeId:o.tileId,nodeVersion:o.tileVersion,textInContext:s,start:e.range.start,length:e.range.length,supportedActions:Oo.lb.Ignore,supportedEntityTypes:[Wo.c.File],suggestionItems:[r],additionalData:e,tooltipTitle:this._localizer.getMessage("ebx_CIQFlagFileTooltipTitle"),categoryTitle:this._localizer.getMessage("ebx_CIQFlagFileTooltipTitle")})}this.addFlags(e.address,a)}}else if(i===h.G.RemoveData){const t=null===(r=this._annotationIdMap)||void 0===r?void 0:r.get(o.annotationId);if(t){const n=[...t];for(const t of n)this.removeFlag(e.address,t)}else this.removeFlag(e.address,o.annotationId)}},this.onApplyFlag=(e,t,n,r)=>{var i,o;t.annotationId&&this._annotationMap.get(t.annotationId)&&(this._annotationMap.delete(t.annotationId),(null===(o=null===(i=this._hostSettings.serviceSettings)||void 0===i?void 0:i.flagAnnotationSettings)||void 0===o?void 0:o.flagInsertionCallback)&&this._hostSettings.serviceSettings.flagAnnotationSettings.flagInsertionCallback(n,r,e.parent.element,n,t))},this.onIgnoreFlag=(e,t)=>{},this.onDisableFlag=()=>{},this._annotationIdMap=new Map}flagHandlerInitialize(){var e,t;if(null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.flagAnnotationSettings)||void 0===t?void 0:t.enabled)for(const e of this._hostEmitters)e.on(M.pD.oaFlagAnnotationsTriggered,this.onFlagAnnotationUpdate)}flagHandlerShutdown(){}getCritiqueType(){return ri.L9.CIQFlag_File}};function Ko(e){var t,n;return(0,Mo.f1)(e.flightsToTrack,null===(n=null===(t=e.serviceSettings)||void 0===t?void 0:t.flagAnnotationSettings)||void 0===n?void 0:n.entityConfigs,Wo.c.File,"mc-editor-oa-files-flag")}Qo=(0,i.__decorate)([(0,Le._)(),(0,i.__param)(0,(0,Pn.t)(M.zJ)),(0,i.__param)(1,(0,Me.W)(Ie.n)),(0,i.__param)(2,(0,Me.W)(ge.w)),(0,i.__param)(3,(0,Me.W)(m.g)),(0,i.__param)(4,(0,Me.W)(Ro.H)),(0,i.__param)(5,(0,Me.W)(b.$)),(0,i.__param)(6,(0,Me.W)(x.W)),(0,i.__param)(6,(0,Tt.l)()),(0,i.__param)(7,(0,Me.W)(Lo.f)),(0,i.__param)(8,(0,Me.W)(Ir.b)),(0,i.__param)(9,(0,Tt.l)()),(0,i.__param)(9,(0,Me.W)(Uo.K))],Qo);let $o=class extends zo{constructor(e,t,n,r,i,o,a,s,l,d,u){super(e,t,n,r,o,a,s,u),this._localizer=i,this._paragraphTextExtractor=l,this._tileContent=d,this.onFlagAnnotationUpdate=e=>{var t,n,r;const i=e.message.messageType,o=e.message.data;if(Zo(this._hostSettings))if(i===h.G.NewData&&o.results.length>0){const r=o.results.filter((e=>e.results.length>0&&e.results[0].entityType===Wo.c.People)),i=[];for(const e of r){const r=[];for(const t of e.results){if(!t.DisplayName)continue;const e=["JobTitle","Company","Department","OfficeLocation"],n=t;n.PropertyHits&&e.includes(n.PropertyHits[0])?r.push(Object.assign(Object.assign({},t),{subtitlePropertyOverride:n.PropertyHits[0]})):r.push(t)}const a={entities:r,entityType:Wo.c.People,groupTitle:this._localizer.getMessage("peopleEntityLabel")},s=this._paragraphTextExtractor.getParagraphText(o.tileId),l=null!==(t=e.context)&&void 0!==t?t:null==s?void 0:s.substring(e.range.start,e.range.start+e.range.length),d=o.annotationId+(null===(n=e.M_)||void 0===n?void 0:n.seq);if(this._annotationIdMap){let e=this._annotationIdMap.get(o.annotationId);e||(e=new Set),e.add(d)}l&&i.push({annotationId:d,traceId:d,languageId:e.language,nodeId:o.tileId,nodeVersion:o.tileVersion,textInContext:l,start:e.range.start,length:e.range.length,supportedActions:Oo.lb.Ignore,supportedEntityTypes:[Wo.c.People],suggestionItems:0===r.length?void 0:[a],additionalData:e,groupTitle:this._localizer.getMessage("ebx_CIQFlagInsertTitle"),groupSubtitle:this._localizer.getMessage("ebx_CIQFlagInsertSubtitle"),tooltipTitle:this._localizer.getMessage("ebx_CIQFlagPeopleTooltipTitle"),categoryTitle:this._localizer.getMessage("ebx_PersonEntityRecognitionCategoryTitle")})}this.addFlags(e.address,i)}else if(i===h.G.RemoveData){const t=null===(r=this._annotationIdMap)||void 0===r?void 0:r.get(o.annotationId);if(t){const n=[...t];for(const t of n)this.removeFlag(e.address,t)}else this.removeFlag(e.address,o.annotationId)}},this.onApplyFlag=(e,t,n,r)=>{var i,o;if(!t.annotationId)return;const a=this._annotationMap.get(t.annotationId);if(a&&(this._annotationMap.delete(t.annotationId),null===(o=null===(i=this._hostSettings.serviceSettings)||void 0===i?void 0:i.flagAnnotationSettings)||void 0===o?void 0:o.flagInsertionCallback)){const i=a.additionalData.replacementRange;if(i){const r=i.start-a.additionalData.range.start,o=t.start+r;this._tileContent.getRangeOfNode(e.parent,void 0,e.element.offset+o,i.length).then((r=>{if(!r)return void this._logger.logDiagnostics("Unable to find replacement flag range",void 0,(0,K.W)(["FlagTypeId",a.critique.typeId],["Start",a.additionalData.range.start],["Length",a.additionalData.range.length],["ReplacementStart",i.start],["ReplacementLength",i.length],["InTextReplacementStart",o]));const s=Object.assign(Object.assign({},t),{start:o,length:i.length});this._hostSettings.serviceSettings.flagAnnotationSettings.flagInsertionCallback(n,r,e.parent.element,n,s)})).catch((e=>{this._logger.logDiagnostics("Unable to find replacement flag range",void 0,(0,K.W)(["Exception",e],["FlagTypeID",a.critique.typeId],["Start",a.additionalData.range.start],["Length",a.additionalData.range.length],["ReplacementStart",i.start],["ReplacementLength",i.length],["InTextReplacementStart",o]))}))}else this._hostSettings.serviceSettings.flagAnnotationSettings.flagInsertionCallback(n,r,e.parent.element,n,t)}},this.onIgnoreFlag=(e,t)=>{},this.onDisableFlag=()=>{},this._annotationIdMap=new Map}flagHandlerInitialize(){var e,t;if(null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.flagAnnotationSettings)||void 0===t?void 0:t.enabled)for(const e of this._hostEmitters)e.on(M.pD.oaFlagAnnotationsTriggered,this.onFlagAnnotationUpdate)}flagHandlerShutdown(){}getCritiqueType(){return ri.L9.CIQFlag_PersonEntityRecognition}};function Zo(e){var t,n;return(0,Mo.i$)(null===(n=null===(t=e.serviceSettings)||void 0===t?void 0:t.flagAnnotationSettings)||void 0===n?void 0:n.entityConfigs,Wo.c.People)}$o=(0,i.__decorate)([(0,Le._)(),(0,i.__param)(0,(0,Pn.t)(M.zJ)),(0,i.__param)(1,(0,Me.W)(Ie.n)),(0,i.__param)(2,(0,Me.W)(ge.w)),(0,i.__param)(3,(0,Me.W)(m.g)),(0,i.__param)(4,(0,Me.W)(Ro.H)),(0,i.__param)(5,(0,Me.W)(b.$)),(0,i.__param)(6,(0,Me.W)(x.W)),(0,i.__param)(6,(0,Tt.l)()),(0,i.__param)(7,(0,Me.W)(Lo.f)),(0,i.__param)(8,(0,Me.W)(Ir.b)),(0,i.__param)(9,(0,Me.W)(F.d)),(0,i.__param)(10,(0,Tt.l)()),(0,i.__param)(10,(0,Me.W)(Uo.K))],$o);var Jo=n(41567),Xo=function(){function e(t){Jo.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_TimeResult"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ResultInfo"]},e.typeGuard=function(t){return Jo.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();const Yo=Po("GlobeFilled","1em",["M7.99 4.18c-.28.66-.5 1.45-.67 2.32h5.36c-.17-.87-.4-1.66-.67-2.32-.3-.73-.65-1.3-1-1.66C10.64 2.15 10.3 2 10 2c-.3 0-.65.15-1 .52-.36.37-.71.93-1.01 1.66Zm-.1-1.9c-.31.43-.59.94-.83 1.52-.32.78-.58 1.7-.76 2.7H2.8c1-2.05 2.85-3.6 5.1-4.22Zm4.22 0c.31.43.59.94.83 1.52.32.78.58 1.7.76 2.7h3.5a8.02 8.02 0 0 0-5.09-4.22Zm5.5 5.22h-3.76a20.52 20.52 0 0 1 0 5h3.75a8 8 0 0 0 0-5Zm-.41 6h-3.5c-.18 1-.44 1.92-.76 2.7-.24.58-.52 1.1-.83 1.52a8.02 8.02 0 0 0 5.09-4.22ZM10 18c.3 0 .65-.15 1-.52.36-.37.71-.93 1.01-1.66.28-.66.5-1.45.67-2.32H7.32c.17.87.4 1.66.67 2.32.3.73.65 1.3 1 1.66.36.37.7.52 1.01.52Zm-2.1-.28a8.02 8.02 0 0 1-5.1-4.22h3.5c.18 1 .44 1.92.76 2.7.24.58.52 1.1.83 1.52ZM2.4 12.5h3.75a20.52 20.52 0 0 1 0-5H2.4a8 8 0 0 0 0 5ZM7 10c0-.87.06-1.71.16-2.5h5.68a19.44 19.44 0 0 1 0 5H7.16C7.06 11.71 7 10.87 7 10Z"]),ea=Po("GlobeRegular","1em",["M10 18a8 8 0 1 0 0-16 8 8 0 0 0 0 16Zm0-15c.66 0 1.4.59 2.02 1.9.22.47.4 1.01.56 1.6H7.42c.15-.59.34-1.13.56-1.6C8.59 3.6 9.34 3 10 3ZM7.07 4.49c-.27.59-.5 1.27-.68 2.01H3.94A7.02 7.02 0 0 1 7.7 3.38c-.24.33-.45.7-.64 1.1ZM6.2 7.5a15.97 15.97 0 0 0 0 5H3.46a6.98 6.98 0 0 1 0-5h2.73Zm.2 6c.17.74.4 1.42.68 2.01.19.4.4.78.64 1.1a7.02 7.02 0 0 1-3.77-3.11h2.45Zm1.03 0h5.16a9.25 9.25 0 0 1-.56 1.6C11.41 16.4 10.66 17 10 17c-.66 0-1.4-.59-2.02-1.9-.22-.47-.4-1.01-.56-1.6Zm5.37-1H7.21a14.87 14.87 0 0 1 0-5h5.58a14.86 14.86 0 0 1 0 5Zm.82 1h2.45a7.02 7.02 0 0 1-3.77 3.12c.24-.33.45-.7.64-1.1.27-.6.5-1.28.68-2.02Zm2.93-1h-2.73a15.97 15.97 0 0 0 0-5h2.73a6.98 6.98 0 0 1 0 5Zm-4.25-9.12a7.02 7.02 0 0 1 3.77 3.12h-2.45a10.5 10.5 0 0 0-.68-2.01c-.19-.4-.4-.78-.64-1.1Z"]);let ta=class extends zo{constructor(e,t,n,r,i,o,a,s,l,d){super(e,t,n,r,a,s,l,d),this._tileContent=i,this._localizer=o,this.onFlagAnnotationUpdate=e=>{const t=e.message.messageType,n=e.message.data;if(t===h.G.NewData&&n.results.length>0){const t=[];for(const e of n.results){if(!qo.uH.typeGuard(e))continue;if(0===e.results.length)continue;const r=e.results[0];if(!Xo.typeGuard(r))continue;const i=[{entities:[{entityType:Wo.c.Text,text:r.context+r.hint,subtitle:void 0,icon:{iconName:ra()},confidence:1}],entityType:Wo.c.Text,groupTitle:this._localizer.getMessage("ebx_CIQFlagTimeTitle"),groupSubtitle:this._localizer.getMessage("ebx_CIQFlagTimeSubtitle")}];t.push({annotationId:n.annotationId,traceId:n.annotationId,languageId:e.language,nodeId:n.tileId,nodeVersion:n.tileVersion,textInContext:r.context,start:e.range.start,length:e.range.length,supportedActions:Oo.lb.Ignore,supportedEntityTypes:[Wo.c.Text],suggestionItems:i,additionalData:r,tooltipTitle:this._localizer.getMessage("ebx_CIQFlagTimeTooltipTitle"),categoryTitle:this._localizer.getMessage("ebx_CIQFlagTimeCategoryTitle")})}this.addFlags(e.address,t)}else t===h.G.RemoveData&&this.removeFlag(e.address,n.annotationId)},this.onApplyFlag=(e,t,n,r)=>{t.annotationId&&this._annotationMap.get(t.annotationId)&&(this._annotationMap.delete(t.annotationId),this._tileContent.replace(e.parent,void 0,t.start,t.length,n.text.trim(),r))},this.onIgnoreFlag=(e,t)=>{},this.onDisableFlag=()=>{}}flagHandlerInitialize(){var e,t;if(null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.flagAnnotationSettings)||void 0===t?void 0:t.enabled)for(const e of this._hostEmitters)e.on(M.pD.oaFlagAnnotationsTriggered,this.onFlagAnnotationUpdate)}flagHandlerShutdown(){}getCritiqueType(){return ri.L9.CIQFlag_Time}};function na(e){var t,n;return(0,Mo.f1)(e.flightsToTrack,null===(n=null===(t=e.serviceSettings)||void 0===t?void 0:t.flagAnnotationSettings)||void 0===n?void 0:n.entityConfigs,Wo.c.Time,"mc-unified-text-prediction-timezone-perspectives")}function ra(){const e="TimeFlag";return(0,B.Z)(e,{regular:ea,filled:Yo}),e}ta=(0,i.__decorate)([(0,Le._)(),(0,i.__param)(0,(0,Pn.t)(M.zJ)),(0,i.__param)(1,(0,Me.W)(Ie.n)),(0,i.__param)(2,(0,Me.W)(ge.w)),(0,i.__param)(3,(0,Me.W)(m.g)),(0,i.__param)(4,(0,Me.W)(F.d)),(0,i.__param)(5,(0,Me.W)(Ro.H)),(0,i.__param)(6,(0,Me.W)(b.$)),(0,i.__param)(7,(0,Me.W)(x.W)),(0,i.__param)(7,(0,Tt.l)()),(0,i.__param)(8,(0,Me.W)(Lo.f)),(0,i.__param)(9,(0,Tt.l)()),(0,i.__param)(9,(0,Me.W)(Uo.K))],ta);let ia=class extends zo{constructor(e,t,n,r,i,o,a,s,l,d){super(e,t,n,r,o,a,s,d),this._localizer=i,this._paragraphTextExtractor=l,this.onFlagAnnotationUpdate=e=>{var t,n,r;const i=e.message.messageType,o=e.message.data;if(i===h.G.NewData&&o.results.length>0){const r=o.results.filter((e=>"GraphSearch"===e.ownerId));if(oa(this._hostSettings)){const i=r.filter((e=>e.results[0].entityType===Wo.c.Topic)),a=[];for(const e of i){const r={entities:e.results.map((e=>Object.assign(Object.assign({},e),{icon:{iconName:"Hashtag"}}))),entityType:Wo.c.Topic,groupTitle:this._localizer.getMessage("ebx_CIQFlagTopicTitle"),groupSubtitle:this._localizer.getMessage("ebx_CIQFlagTopicSubtitle")},i=this._paragraphTextExtractor.getParagraphText(o.tileId),s=null!==(t=e.context)&&void 0!==t?t:null==i?void 0:i.substring(e.range.start,e.range.start+e.range.length);if(!s)continue;const l=o.annotationId+(null===(n=e.M_)||void 0===n?void 0:n.seq);if(this._annotationIdMap){let e=this._annotationIdMap.get(o.annotationId);e||(e=new Set),e.add(l)}a.push({annotationId:l,traceId:l,languageId:e.language,nodeId:o.tileId,nodeVersion:o.tileVersion,textInContext:s,start:e.range.start,length:e.range.length,supportedActions:Oo.lb.Ignore|Oo.lb.IgnoreAll,supportedEntityTypes:[Wo.c.Topic],suggestionItems:[r],additionalData:e,tooltipTitle:this._localizer.getMessage("ebx_CIQFlagTopicTooltipTitle"),categoryTitle:this._localizer.getMessage("ebx_CIQFlagTopicTooltipTitle")})}this.addFlags(e.address,a)}}else if(i===h.G.RemoveData){const t=null===(r=this._annotationIdMap)||void 0===r?void 0:r.get(o.annotationId);if(t){const n=[...t];for(const t of n)this.removeFlag(e.address,t)}else this.removeFlag(e.address,o.annotationId)}},this.onApplyFlag=(e,t,n,r)=>{var i,o;if(!t.annotationId)return;const a=this._annotationMap.get(t.annotationId);a&&(this._annotationMap.delete(t.annotationId),(null===(o=null===(i=this._hostSettings.serviceSettings)||void 0===i?void 0:i.flagAnnotationSettings)||void 0===o?void 0:o.flagInsertionCallback)&&this._hostSettings.serviceSettings.flagAnnotationSettings.flagInsertionCallback(a.additionalData,r,e.parent.element,n,t))},this.onIgnoreFlag=(e,t)=>{},this.onDisableFlag=()=>{},this._annotationIdMap=new Map}flagHandlerInitialize(){var e,t;if(null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.flagAnnotationSettings)||void 0===t?void 0:t.enabled)for(const e of this._hostEmitters)e.on(M.pD.oaFlagAnnotationsTriggered,this.onFlagAnnotationUpdate)}flagHandlerShutdown(){}getCritiqueType(){return ri.L9.CIQFlag_Topic}};function oa(e){var t,n;return(0,Mo.f1)(e.flightsToTrack,null===(n=null===(t=e.serviceSettings)||void 0===t?void 0:t.flagAnnotationSettings)||void 0===n?void 0:n.entityConfigs,Wo.c.Topic,"mc-editor-oa-topics-flags")}ia=(0,i.__decorate)([(0,Le._)(),(0,i.__param)(0,(0,Pn.t)(M.zJ)),(0,i.__param)(1,(0,Me.W)(Ie.n)),(0,i.__param)(2,(0,Me.W)(ge.w)),(0,i.__param)(3,(0,Me.W)(m.g)),(0,i.__param)(4,(0,Me.W)(Ro.H)),(0,i.__param)(5,(0,Me.W)(b.$)),(0,i.__param)(6,(0,Me.W)(x.W)),(0,i.__param)(6,(0,Tt.l)()),(0,i.__param)(7,(0,Me.W)(Lo.f)),(0,i.__param)(8,(0,Me.W)(Ir.b)),(0,i.__param)(9,(0,Tt.l)()),(0,i.__param)(9,(0,Me.W)(Uo.K))],ia);class aa{get uniqueId(){return(0,Je.z)(507781790)}configureRootServices(e){var t,n;const r=e.get(Ie.n);(null===(n=null===(t=r.serviceSettings)||void 0===t?void 0:t.flagAnnotationSettings)||void 0===n?void 0:n.enabled)&&(Ho(r)&&sa(e,ri.L9.CIQFlag_DateEntityRecognition,"ebx_DateEntityRecognitionCategoryTitle"),Ko(r)&&sa(e,ri.L9.CIQFlag_File,"ebx_CIQFlagFileTooltipTitle"),Zo(r)&&sa(e,ri.L9.CIQFlag_PersonEntityRecognition,"ebx_PersonEntityRecognitionCategoryTitle"),na(r)&&sa(e,ri.L9.CIQFlag_Time,"ebx_CIQFlagTimeCategoryTitle"),oa(r)&&sa(e,ri.L9.CIQFlag_Topic,"ebx_CIQFlagTopicCategoryTitle"))}}function sa(e,t,n){e.bind(Io).toValue((e=>({id:t,name:wo(n,e)})))}var la=n(96589);class da{constructor(){this.imports=[la.v,To.d,aa]}get uniqueId(){return(0,Je.z)(507918358)}configureRootServices(e){var t,n;e.bind(Uo.K).to(So);const r=e.get(Ie.n);(null===(n=null===(t=r.serviceSettings)||void 0===t?void 0:t.flagAnnotationSettings)||void 0===n?void 0:n.enabled)&&(Ho(r)&&e.bind(Ue.S).to(jo),Ko(r)&&e.bind(Ue.S).to(Qo),Zo(r)&&e.bind(Ue.S).to($o),na(r)&&e.bind(Ue.S).to(ta),oa(r)&&e.bind(Ue.S).to(ia))}}var ua=n(43884);class ca{constructor(){this.imports=[da,ua.r,la.v,_o.J]}get uniqueId(){return(0,Je.z)(507918295)}configureRootServices(e){}}var ga=n(82940);let ha=class{constructor(e){this._hostSettings=e,this._getWorkerUrl=()=>new Promise((e=>{var t;const n=new MessageChannel;n.port1.onmessage=({data:t})=>{var r;n.port1.close(),e(null!==(r=null==t?void 0:t.url)&&void 0!==r?r:null)},null===(t=this._dmp)||void 0===t||t.postMessage(["get-url"],[n.port2])})),this._callworker=(e,t,n)=>new Promise(((r,i)=>{var o;const a=new MessageChannel;a.port1.onmessage=({data:e})=>{a.port1.close(),e.error?i(e.error):r(e.result)},null===(o=this._dmp)||void 0===o||o.postMessage([e,t,n],[a.port2])}))}async initialize(){var e;if(null===(e=this._dmp)||void 0===e||e.terminate(),this._hostSettings.disableInlineWorkerLoader)this._dmp=new Worker(new URL(n.p+n.u(2063),n.b));else{const e=n(98288);this._dmp=new e.default}if(this._hostSettings.validateWorkerUrl){const e=await this._getWorkerUrl();await this._hostSettings.validateWorkerUrl(e)||this.shutDown()}}shutDown(){var e;null===(e=this._dmp)||void 0===e||e.terminate(),this._dmp=void 0}async getReadjustedIndices(e,t,n,r){var i;const o=null!==(i=e.textContent)&&void 0!==i?i:"",a=r?n:o,s=r?o:n;return await this._callworker(a,s,t)}};ha=(0,i.__decorate)([(0,Le._)(),(0,i.__param)(0,(0,Me.W)(Ie.n))],ha);class pa{constructor(){this.imports=[]}get uniqueId(){return(0,Je.z)(507918239)}configureRootServices(e){e.bind(tn).to(ha),e.bind(Ue.S).toExisting(tn)}}var fa,va=(fa=[],{fireEvent:function(e){fa.forEach((function(t){return t(e)}))},addListener:function(e){e&&fa.push(e)}});function ma(e,t,n){va.fireEvent({level:e,category:t,message:n})}function ya(e,t,n){ma(0,e,(function(){var e=n instanceof Error?n.message:"";return"".concat(t,": ").concat(e)}))}var _a="function",ba="object",Ca="undefined",Sa="prototype",Ta="hasOwnProperty",Ia=Object,wa=Ia[Sa],Ea=Ia.assign,xa=Ia.create,Aa=Ia.defineProperty,Da=wa[Ta],ka=null;function Fa(e){void 0===e&&(e=!0);var t=!1===e?null:ka;return t||(typeof globalThis!==Ca&&(t=globalThis),t||typeof self===Ca||(t=self),t||typeof window===Ca||(t=window),t||typeof n.g===Ca||(t=n.g),ka=t),t}function Pa(e){throw new TypeError(e)}function Na(e){if(xa)return xa(e);if(null==e)return{};var t=typeof e;function n(){}return t!==ba&&t!==_a&&Pa("Object prototype may only be an Object:"+e),n[Sa]=e,new n}var Ba="initialize",Oa="name",Ra="getNotifyMgr",La="identifier",Ma="push",qa="isInitialized",Wa="config",Ua="instrumentationKey",za="logger",ja="length",Ha="time",Va="processNext",Ga="getProcessTelContext",Qa="addNotificationListener",Ka="removeNotificationListener",$a="stopPollingInternalLogs",Za="onComplete",Ja="getPlugin",Xa="flush",Ya="_extensions",es="splice",ts="teardown",ns="messageId",rs="message",is="isAsync",os="_doTeardown",as="update",ss="getNext",ls="diagLog",ds="setNextPlugin",us="createNew",cs="cookieCfg",gs="indexOf",hs="substring",ps="userAgent",fs="split",vs="setEnabled",ms="substr",ys="nodeType",_s="apply",bs="replace",Cs="enableDebugExceptions",Ss="toLowerCase",Ts="call",Is="type",ws="handler",Es="listeners",xs="isChildEvt",As="getCtx",Ds="setCtx",ks="complete",Fs="traceId",Ps="spanId",Ns="traceFlags",Bs="",Os="channels",Rs="core",Ls="createPerfMgr",Ms="disabled",qs="extensionConfig",Ws="processTelemetry",Us="priority",zs="eventsSent",js="eventsDiscarded",Hs="eventsSendRequest",Vs="perfEvent",Gs="errorToConsole",Qs="warnToConsole",Ks="getPerfMgr",$s="toISOString",Zs="endsWith",Js="startsWith",Xs="indexOf",Ys="trim",el="toString",tl="__proto__",nl="constructor",rl=Aa,il=Ia.freeze,ol=(Ia.seal,Ia.keys),al=String[Sa],sl=al[Ys],ll=al[Zs],dl=al[Js],ul=Date[Sa][$s],cl=Array.isArray,gl=wa[el],hl=Da[el],pl=hl[Ts](Ia),fl=/-([a-z])/g,vl=/([^\w\d_$])/g,ml=/^(\d+[\w\d_$])/,yl=Object.getPrototypeOf;function _l(e){return void 0===e||typeof e===Ca}function bl(e){return null===e||_l(e)}function Cl(e){return!bl(e)}function Sl(e,t){return!(!e||!Da[Ts](e,t))}function Tl(e){return!(!e||typeof e!==ba)}function Il(e){return!(!e||typeof e!==_a)}function wl(e){var t=e;return t&&kl(t)&&(t=(t=(t=t[bs](fl,(function(e,t){return t.toUpperCase()})))[bs](vl,"_"))[bs](ml,(function(e,t){return"_"+t}))),t}function El(e,t){if(e)for(var n in e)Da[Ts](e,n)&&t[Ts](e,n,e[n])}function xl(e,t){var n=!1;return e&&t&&!(n=e===t)&&(n=dl?e[Js](t):function(e,t){var n=!1,r=t?t[ja]:0;if(e&&r&&e[ja]>=r&&!(n=e===t)){for(var i=0;i<r;i++)if(e[i]!==t[i])return!1;n=!0}return n}(e,t)),n}function Al(e,t){return!(!e||!t)&&-1!==e[gs](t)}var Dl=cl||function(e){return!(!e||"[object Array]"!==gl[Ts](e))};function kl(e){return"string"==typeof e}function Fl(e){return"number"==typeof e}function Pl(e){return"boolean"==typeof e}function Nl(e){var t=!1;if(e&&"object"==typeof e){var n=yl?yl(e):function(e){if(e){if(yl)return yl(e);var t=e[tl]||e[Sa]||e[nl];if(t)return t}return null}(e);n?(n[nl]&&Da[Ts](n,nl)&&(n=n[nl]),t=typeof n===_a&&hl[Ts](n)===pl):t=!0}return t}function Bl(e){if(e)return ul?e[$s]():function(e){if(e&&e.getUTCFullYear){var t=function(e){var t=String(e);return 1===t[ja]&&(t="0"+t),t};return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}(e)}function Ol(e,t,n){var r=e[ja];try{for(var i=0;i<r&&(!(i in e)||-1!==t[Ts](n||e,e[i],i,e));i++);}catch(e){}}function Rl(e,t,n){if(e){if(e[Xs])return e[Xs](t,n);var r=e[ja],i=n||0;try{for(var o=Math.max(i>=0?i:r-Math.abs(i),0);o<r;o++)if(o in e&&e[o]===t)return o}catch(e){}}return-1}function Ll(e){return e&&(e=sl&&e[Ys]?e[Ys]():e[bs]?e[bs](/^\s+|(?=\s)\s+$/g,Bs):e),e}var Ml=!{toString:null}.propertyIsEnumerable("toString"),ql=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];function Wl(e){var t=typeof e;if(t===_a||t===ba&&null!==e||Pa("objKeys called on non-object"),!Ml&&ol)return ol(e);var n=[];for(var r in e)e&&Da[Ts](e,r)&&n[Ma](r);if(Ml)for(var i=ql[ja],o=0;o<i;o++)e&&Da[Ts](e,ql[o])&&n[Ma](ql[o]);return n}function Ul(e,t,n,r){if(rl)try{var i={enumerable:!0,configurable:!0};return n&&(i.get=n),r&&(i.set=r),rl(e,t,i),!0}catch(e){}return!1}var zl=il||function(e){return e};function jl(){var e=Date;return e.now?e.now():(new e).getTime()}function Hl(e){return function(e){return!(!e||"[object Error]"!==gl[Ts](e))}(e)?e[Oa]:Bs}function Vl(e,t,n,r,i){var o=n;return e&&((o=e[t])===n||i&&!i(o)||r&&!r(n)||(o=n,e[t]=o)),o}function Gl(e,t,n){var r;return e?!(r=e[t])&&bl(r)&&(r=_l(n)?{}:n,e[t]=r):r=_l(n)?{}:n,r}function Ql(e,t){return bl(e)?t:e}function Kl(e){return!!e}function $l(e){throw new Error(e)}function Zl(e,t,n,r,i){e&&t&&n&&(!1!==i||_l(e[t]))&&(e[t]=function(e,t){var n=null,r=null;return Il(e)?n=e:r=e,function(){var e=arguments;if(n&&(r=n()),r)return r[t][_s](r,e)}}(n,r))}function Jl(e){return e&&Ea&&(e=Ia(Ea({},e))),e}function Xl(e,t,n,r,i,o){var a=arguments,s=a[0]||{},l=a[ja],d=!1,u=1;for(l>0&&Pl(s)&&(d=s,s=a[u]||{},u++),Tl(s)||(s={});u<l;u++){var c=a[u],g=Dl(c),h=Tl(c);for(var p in c)if(g&&p in c||h&&Da[Ts](c,p)){var f=c[p],v=void 0;if(d&&f&&((v=Dl(f))||Nl(f))){var m=s[p];v?Dl(m)||(m=[]):Nl(m)||(m={}),f=Xl(d,m,f)}void 0!==f&&(s[p]=f)}}return s}function Yl(e,t,n){return ed(e,0,t,n)}function ed(e,t,n,r){return{name:e,dataType:t,value:n,classification:r||4}}function td(e,t){return e?e+"."+t:t}function nd(e,t,n,r,i){void 0===i&&(i=4),r&&e.push(Yl("".concat(td(t,n)),r,i))}function rd(e,t,n,r){"boolean"==typeof r&&e.push(function(e,t,n){return ed(e,1,t,n)}("".concat(td(t,n)),r))}var id;!function(e){e.Web="Web",e.Desktop="Desktop",e.Universal="Universal",e.Mobile="Mobile",e.Win32="Win32",e.iOS="iOS",e.Android="Android"}(id||(id={}));var od;!function(e){e.Automation="Automation",e.Dogfood="Dogfood",e.Microsoft="Microsoft",e.Insiders="Insiders",e.Production="Production"}(od||(od={}));var ad,sd;!function(e){var t,n,r,i,o="Copilot";(i=e.FeatureActionType||(e.FeatureActionType={})).IsEnabled="IsEnabled",i.IsSeen="IsSeen",i.IsTried="IsTried",i.IsKept="IsKept",i.IsRejected="IsRejected",(r=e.Capability||(e.Capability={})).ContentGeneration="Content Generation",r.Commanding="Commanding",r.QAandSummaries="QA and Summaries",r.Collaboration="Collaboration",r.Suggestions="Suggestions",(n=e.EntryPoint||(e.EntryPoint={})).Chat="Chat",n.Canvas="Canvas",(t=e.Verb||(e.Verb={})).Create="Create",t.Command="Command",t.Ask="Ask",t.Summarize="Summarize",t.Share="Share",t.Analyze="Analyze",e.getFields=function(e){var t=[];return nd(t,o,"FeatureActionType",e.featureActionType),rd(t,o,"IsUserInitiated",e.isUserInitiated),nd(t,o,"FeatureName",e.featureName),nd(t,o,"SubFeatureName",e.subFeatureName),nd(t,o,"Capability",e.capability),rd(t,o,"IsThumbsUp",e.isThumbsUp),nd(t,o,"EntryPoint",e.entryPoint),nd(t,o,"Verb",e.verb),nd(t,o,"InteractionId",e.interactionId),t.push(Yl("zC.".concat(o),"Office.System.Copilot")),t}}(ad||(ad={})),function(e){var t,n="Asha";(t=e.EventType||(e.EventType={})).Pillar="Pillar",t.Error="Error",e.getFields=function(e){var t=[];return nd(t,n,"EventType",e.eventType),nd(t,n,"Pillar",e.pillar),nd(t,n,"Scenario",e.scenario),nd(t,n,"Veto",e.veto),nd(t,n,"Error",e.error),rd(t,n,"InStaging",e.inStaging),rd(t,n,"IsSessionEndingError",e.isSessionEndingError),rd(t,n,"IsIntentional",e.isIntentional),rd(t,n,"IsInternal",e.isInternal),t.push(Yl("zC.".concat(n),"Office.System.Asha")),t}}(sd||(sd={}));var ld="Data.",dd="User.PrimaryIdentityHash",ud="User.PrimaryIdentitySpace",cd="User.TenantId",gd="User.IsAnonymous",hd="User.IsSignedIn";function pd(e,t,n,r){var i=!0;if(t)for(var o=function(t){var o=t.classification,a=t.dataType,s=t.name;if(o&&!(4===o||1===o||2===r&&32===o||3===r&&2048===o))return i=!1,"break";if(3===r&&n&&3!==a&&1!==a&&2!==a&&"OTelJS.Version"!==s&&"OTelJS.Sink"!==s)return ma(0,1,(function(){return"DNM: Invalid field type "+s})),i=!1,"break";var l;l=n?"zC."===s.substr(0,3)?"zC."+ld+s.substr(3):ld+s:s;var d=void 0;switch(a){case 3:d=6;break;case 2:d=4;break;case 4:d=8;break;case 0:return e[l]="string"==typeof t.value?t.value.substr(0,25e3):t.value,"continue";default:return e[l]=t.value,"continue"}var u={value:t.value,propertyType:d};e[l]=u},a=0,s=t;a<s.length&&"break"!==o(s[a]);a++);return i}function fd(e){ma(0,1,(function(){return"Invalid "+e}))}function vd(e){return kl(e)&&""!==e}function md(e,t){return Object.values(t).includes(e)}function yd(e){return md(e,id)}function _d(e){return md(e,od)}function bd(e){return["MSACID","MSAPUID","OrgIdCID","OrgIdPUID","UserObjectId","Other"].includes(e)}function Cd(e){return!e||"Other"===e}function Sd(e,t){var n=!0;function r(t,r){r(e[t])||(fd(t),n=!1)}function i(e){return new RegExp("^[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}$",t?"":"i").test(e)}return r("App.Name",vd),r("App.Platform",t?yd:vd),r("App.Version",vd),r("Session.Id",i),t?(r("Release.AudienceGroup",_d),r(hd,Pl),e[hd]?(r(dd,vd),r(ud,bd),["OrgIdCID","OrgIdPUID","UserObjectId"].includes(e[ud])?r(cd,i):r(cd,bl)):(r(ud,Cd),r(cd,bl))):e[gd]||!1===e[hd]||(r(dd,vd),r(ud,vd),e[cd]&&r(cd,i)),bl(e[gd])||e[hd]!==e[gd]||(fd(gd),n=!1),n}var Td={};function Id(e,t){"Office."===e.substring(0,7)&&"."!==e[e.length-1]?Td[e]?(t.ariaTenantToken&&(Td[e].ariaTenantToken=t.ariaTenantToken),t.dnmToken&&(Td[e].dnmToken=t.dnmToken)):Td[e]=t:ma(0,0,(function(){return"Namespace: ".concat(e)}))}function wd(e,t){for(var n=e.length;n>0;){var r=e.substr(0,n);if(Td[r]){var i=Td[r];return t.ariaTenantToken=i.ariaTenantToken,t.dnmToken=i.dnmToken,!0}n=e.lastIndexOf(".",n-1)}return!1}var Ed=9007199254740991,xd=-Ed,Ad=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,Dd=/^[a-zA-Z0-9_\.]{1,95}$/;function kd(e){return Dd.test(e)}function Fd(e){e&&e.forEach((function(e){if("string"!=typeof e.name||!kd(e.name))throw new Error("Invalid dataField name");2===e.dataType&&function(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<xd||e>Ed)throw new Error("Invalid integer ".concat(JSON.stringify(e)))}(e.value)}))}function Pd(e){var t={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?(0,i.__assign)({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp||(new Date).getTime()};return e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t}!function(){function e(e,t,n){var r,o,a;this.telemetrySinks=[],this.persistentDataFields=[],this.partAFields=[],this.eventQueue=[],this.config=n||{},e&&(this.telemetrySinks=e.telemetrySinks,(r=this.persistentDataFields).push.apply(r,e.persistentDataFields),this.config=(0,i.__assign)((0,i.__assign)({},e.getConfig()),this.config),(o=this.partAFields).push.apply(o,e.partAFields)),t&&(a=this.persistentDataFields).push.apply(a,t)}e.prototype.addEventContentType=function(e,t){var n;e.push(ed("EventContent.Type",2,t,n))},e.prototype.sendTelemetryEvent=function(e){var t=Pd(e),n=t.telemetryProperties;n.nexusTenantToken=-1;var r=n.ariaTenantToken;r||wd(t.eventName,n)||r?this.sendTelemetryEventInternal(t,1):ma(0,0,(function(){return"No tenant token: "+e.eventName}))},e.prototype.sendNonStandardEvent=function(e,t){var n=Pd(e);this.sendTelemetryEventInternal(n,t)},e.prototype.sendCustomerContent=function(e){var t=Pd(e),n=t.telemetryProperties,r=n.customerContentVersion;return(!r||r>2)&&(n.customerContentVersion=2),n.ariaTenantToken=void 0,n.nexusTenantToken=void 0,n.dnmToken=void 0,this.addEventContentType(t.dataFields,2),this.sendTelemetryEventInternal(t,2)},e.prototype.sendDirectNumericEvent=function(e){var t=Pd(e),n=t.telemetryProperties;n.dnmToken||wd(t.eventName,n)||n.dnmToken?(this.addEventContentType(t.dataFields,1),this.sendTelemetryEventInternal(t,3)):ma(0,0,(function(){return"No dnm token: "+t.eventName}))},e.prototype.sendTelemetryEventInternal=function(e,t){if(2===t||!e.telemetryProperties.customerContentVersion&&!e.telemetryProperties.customerContentType){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push([e,t]):ma(1,0,(function(){return"No telemetry sinks are attached."})));this.processTelemetryEvent(e,t)}catch(e){return void ya(0,"SendTelemetryEvent",e)}this.telemetrySinks.forEach((function(n){try{3===t||2===t?n.sendNonStandardEvent&&n.sendNonStandardEvent(e,t):n.sendTelemetryEvent(e)}catch(e){}}))}else ma(0,0,(function(){return"Customer content"}))},e.prototype.processTelemetryEvent=function(e,t){var n,r,i;if(e.dataFields&&(null===(i=e.dataFields)||void 0===i||i.unshift(Yl("OTelJS.Version","4.20.7")),3!==t&&this.persistentDataFields&&(n=e.dataFields).unshift.apply(n,this.persistentDataFields)),this.partAFields.length>0){var o=e.eventContract||{name:"",dataFields:[]};(r=o.dataFields).push.apply(r,this.partAFields),e.eventContract=o}this.config.disableValidation||function(e){if(!(t=e.eventName)||t.length>98||!Ad.test(t))throw new Error("Invalid eventName");var t,n=e.eventContract;if(n){if(n.name&&!kd(n.name))throw new Error("Invalid eventContract");Fd(n.dataFields)}Fd(e.dataFields)}(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e),this.flushQueue()},e.prototype.flushQueue=function(){var e=this.eventQueue;if(this.eventQueue=[],this.telemetrySinks.length>0)for(var t=0,n=e;t<n.length;t++){var r=n[t],i=r[0],o=r[1];this.sendTelemetryEventInternal(i,o)}},e.prototype.setTenantToken=function(e,t,n){Id(e,{ariaTenantToken:t,nexusTenantToken:n})},e.prototype.setDNMToken=function(e,t){Id(e,{dnmToken:t})},e.prototype.cloneEvent=function(e){return Pd(e)},e.prototype.getConfig=function(){return this.config}}();var Nd,Bd,Od="undefined",Rd="constructor",Ld="prototype",Md="function",qd="_dynInstFuncs",Wd="_isDynProxy",Ud="_dynClass",zd="_dynInstChk",jd=zd,Hd="_dfOpts",Vd="_unknown_",Gd="__proto__",Qd="_dyn"+Gd,Kd="__dynProto$Gbl",$d="_dynInstProto",Zd="useBaseInst",Jd="setInstFuncs",Xd=Object,Yd=Xd.getPrototypeOf,eu=Xd.getOwnPropertyNames,tu=(typeof globalThis!==Od&&(Bd=globalThis),Bd||typeof self===Od||(Bd=self),Bd||typeof window===Od||(Bd=window),Bd||typeof n.g===Od||(Bd=n.g),Bd||{}),nu=tu[Kd]||(tu[Kd]={o:(Nd={},Nd[Jd]=!0,Nd[Zd]=!0,Nd),n:1e3});function ru(e,t){return e&&Xd[Ld].hasOwnProperty.call(e,t)}function iu(e){return e&&(e===Xd[Ld]||e===Array[Ld])}function ou(e){return iu(e)||e===Function[Ld]}function au(e){var t;if(e){if(Yd)return Yd(e);var n=e[Gd]||e[Ld]||(e[Rd]?e[Rd][Ld]:null);t=e[Qd]||n,ru(e,Qd)||(delete e[$d],t=e[Qd]=e[$d]||e[Qd],e[$d]=n)}return t}function su(e,t){var n=[];if(eu)n=eu(e);else for(var r in e)"string"==typeof r&&ru(e,r)&&n.push(r);if(n&&n.length>0)for(var i=0;i<n.length;i++)t(n[i])}function lu(e,t,n){return t!==Rd&&typeof e[t]===Md&&(n||ru(e,t))&&t!==Gd&&t!==Ld}function du(e){throw new TypeError("DynamicProto: "+e)}function uu(){return Object.create?(null,(e=Object.create)?e(null):{}):{};var e}function cu(e,t){for(var n=e.length-1;n>=0;n--)if(e[n]===t)return!0;return!1}function gu(e,t,n,r,i){if(!iu(e)){var o=n[qd]=n[qd]||uu();if(!iu(o)){var a=o[t]=o[t]||uu();!1!==o[jd]&&(o[jd]=!!i),iu(a)||su(n,(function(t){lu(n,t,!1)&&n[t]!==r[t]&&(a[t]=n[t],delete n[t],(!ru(e,t)||e[t]&&!e[t][Wd])&&(e[t]=function(e,t){var n=function(){var r=function(e,t,n,r){var i=null;if(e&&ru(n,Ud)){var o=e[qd]||uu();if((i=(o[n[Ud]]||uu())[t])||du("Missing ["+t+"] "+Md),!i[zd]&&!1!==o[jd]){for(var a=!ru(e,t),s=au(e),l=[];a&&s&&!ou(s)&&!cu(l,s);){var d=s[t];if(d){a=d===r;break}l.push(s),s=au(s)}try{a&&(e[t]=i),i[zd]=1}catch(e){o[jd]=!1}}}return i}(this,t,e,n)||function(e,t,n){var r=t[e];return r===n&&(r=au(t)[e]),typeof r!==Md&&du("["+e+"] is not a "+Md),r}(t,e,n);return r.apply(this,arguments)};return n[Wd]=1,n}(e,t)))}))}}}function hu(e,t){return ru(e,Ld)?e.name||t||Vd:((e||{})[Rd]||{}).name||t||Vd}function pu(e,t,n,r){ru(e,Ld)||du("theClass is an invalid class definition.");var i=e[Ld];(function(e,t){if(Yd){for(var n=[],r=au(t);r&&!ou(r)&&!cu(n,r);){if(r===e)return!0;n.push(r),r=au(r)}return!1}return!0})(i,t)||du("["+hu(e)+"] not in hierarchy of ["+hu(t)+"]");var o=null;ru(i,Ud)?o=i[Ud]:(o="_dynCls$"+hu(e,"_")+"$"+nu.n,nu.n++,i[Ud]=o);var a=pu[Hd],s=!!a[Zd];s&&r&&void 0!==r[Zd]&&(s=!!r[Zd]);var l=function(e){var t=uu();return su(e,(function(n){!t[n]&&lu(e,n,!1)&&(t[n]=e[n])})),t}(t),d=function(e,t,n,r){function i(e,t,n){var i=t[n];if(i[Wd]&&r){var o=e[qd]||{};!1!==o[jd]&&(i=(o[t[Ud]]||{})[n]||i)}return function(){return i.apply(e,arguments)}}var o=uu();su(n,(function(e){o[e]=i(t,n,e)}));for(var a=au(e),s=[];a&&!ou(a)&&!cu(s,a);)su(a,(function(e){!o[e]&&lu(a,e,!Yd)&&(o[e]=i(t,a,e))})),s.push(a),a=au(a);return o}(i,t,l,s);n(t,d);var u=!!Yd&&!!a[Jd];u&&r&&(u=!!r[Jd]),gu(i,o,t,l,!1!==u)}pu[Hd]=nu.o;var fu="window",vu="document",mu="navigator",yu="location",_u="performance",bu="JSON",Cu="crypto",Su="msCrypto",Tu="msie",Iu="trident/",wu="XMLHttpRequest",Eu=null,xu=null,Au=!1,Du=null,ku=null;function Fu(e,t){var n=!1;if(e){try{if(!(n=t in e)){var r=e[Sa];r&&(n=t in r)}}catch(e){}if(!n)try{n=!_l((new e)[t])}catch(e){}}return n}function Pu(e){var t=Fa();return t&&t[e]?t[e]:e===fu&&Nu()?window:null}function Nu(){return Boolean(typeof window===ba&&window)}function Bu(){return Nu()?window:Pu(fu)}function Ou(){return Boolean(typeof document===ba&&document)?document:Pu(vu)}function Ru(){return Boolean(typeof navigator===ba&&navigator)}function Lu(){return Ru()?navigator:Pu(mu)}function Mu(e){if(e&&Au){var t=Pu("__mockLocation");if(t)return t}return typeof location===ba&&location?location:Pu(yu)}function qu(){return Boolean(typeof JSON===ba&&JSON||null!==Pu(bu))}function Wu(){return qu()?JSON||Pu(bu):null}function Uu(){var e=Lu();return!(!e||!e.product)&&"ReactNative"===e.product}function zu(){var e=Lu();if(e&&(e[ps]!==xu||null===Eu)){var t=((xu=e[ps])||Bs)[Ss]();Eu=Al(t,Tu)||Al(t,Iu)}return Eu}function ju(e){var t=Object[Sa].toString[Ts](e),n=Bs;return"[object Error]"===t?n="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e[Oa]+"'":qu()&&(n=Wu().stringify(e)),t+n}function Hu(){return null===ku&&(ku=Ru()&&Boolean(Lu().sendBeacon)),ku}function Vu(e){var t=!1;try{t=!!Pu("fetch");var n=Pu("Request");t&&e&&n&&(t=Fu(n,"keepalive"))}catch(e){}return t}function Gu(){var e=!1;try{e=!!Pu(wu)}catch(e){}return e}var Qu,Ku=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],$u=null;function Zu(e,t){return function(){var n=arguments,r=Ju(t);if(r){var i=r.listener;i&&i[e]&&i[e][_s](i,n)}}}function Ju(e){var t,n=$u;return n||!0===e.disableDbgExt||(n=$u||((t=Pu("Microsoft"))&&($u=t.ApplicationInsights),$u)),n?n.ChromeDbgExt:null}function Xu(e){if(!Qu){Qu={};for(var t=0;t<Ku[ja];t++)Qu[Ku[t]]=Zu(Ku[t],e)}return Qu}function Yu(e){return e?'"'+e[bs](/\"/g,Bs)+'"':Bs}function ec(e,t){var n=typeof console!==Ca?console:Pu("console");if(n){var r="log";n[e]&&(r=e),Il(n[r])&&n[r](t)}}var tc=function(){function e(e,t,n,r){void 0===n&&(n=!1);var i=this;i[ns]=e,i[rs]=(n?"AI: ":"AI (Internal): ")+e;var o=Bs;qu()&&(o=Wu().stringify(r));var a=(t?" message:"+Yu(t):Bs)+(r?" props:"+Yu(o):Bs);i[rs]+=a}return e.dataType="MessageData",e}(),nc=function(){function e(t){this.identifier="DiagnosticLogger",this.queue=[];var n,r,i,o,a=0,s={};pu(e,this,(function(e){function l(t,n){if(!(a>=i)){var o=!0,l="AITR_"+n[ns];if(s[l]?o=!1:s[l]=!0,o&&(t<=r&&(e.queue[Ma](n),a++,d(1===t?"error":"warn",n)),a===i)){var u="Internal events throttle limit per PageView reached for this app.",c=new tc(23,u,!1);e.queue[Ma](c),1===t?e[Gs](u):e[Qs](u)}}}function d(e,n){var r=Ju(t||{});r&&r[ls]&&r[ls](e,n)}!function(e){n=Ql(e.loggingLevelConsole,0),r=Ql(e.loggingLevelTelemetry,1),i=Ql(e.maxMessageLimit,25),o=Ql(e.enableDebug,Ql(e[Cs],!1))}(t||{}),e.consoleLoggingLevel=function(){return n},e.telemetryLoggingLevel=function(){return r},e.maxInternalMessageLimit=function(){return i},e[Cs]=function(){return o},e.throwInternal=function(t,r,i,a,u){void 0===u&&(u=!1);var c=new tc(r,i,u,a);if(o)throw ju(c);var g=1===t?Gs:Qs;if(_l(c[rs]))d("throw"+(1===t?"Critical":"Warning"),c);else{if(u){var h=+c[ns];!s[h]&&n>=t&&(e[g](c[rs]),s[h]=!0)}else n>=t&&e[g](c[rs]);l(t,c)}},e[Qs]=function(e){ec("warn",e),d("warning",e)},e[Gs]=function(e){ec("error",e),d("error",e)},e.resetInternalMessageCount=function(){a=0,s={}},e.logInternalMessage=l}))}return e.__ieDyn=1,e}();function rc(e){return e||new nc}function ic(e,t,n,r,i,o){void 0===o&&(o=!1),rc(e).throwInternal(t,n,r,i,o)}function oc(e,t){rc(e)[Qs](t)}var ac="toGMTString",sc="toUTCString",lc="cookie",dc="expires",uc="enabled",cc="isCookieUseDisabled",gc="disableCookiesUsage",hc="_ckMgr",pc=null,fc=null,vc=null,mc=Ou(),yc={},_c={};function bc(e){return!e||e.isEnabled()}function Cc(e,t){return!!(t&&e&&Dl(e.ignoreCookies))&&-1!==e.ignoreCookies[gs](t)}function Sc(e,t){var n,r=function(e){var t=e[cs]=e[cs]||{};if(Vl(t,"domain",e.cookieDomain,Cl,bl),Vl(t,"path",e.cookiePath||"/",null,bl),bl(t[uc])){var n=void 0;_l(e[cc])||(n=!e[cc]),_l(e[gc])||(n=!e[gc]),t[uc]=n}return t}(e||_c),i=r.path||"/",o=r.domain,a=!1!==r[uc],s=((n={isEnabled:function(){var e=a&&Tc(t),n=_c[hc];return e&&n&&s!==n&&(e=bc(n)),e}})[vs]=function(e){a=!1!==e},n.set=function(e,t,n,a,l){var d,u=!1;if(bc(s)&&!function(e,t){return!!(t&&e&&Dl(e.blockedCookies)&&-1!==e.blockedCookies[gs](t))||Cc(e,t)}(r,e)){var c={},g=Ll(t||Bs),h=g[gs](";");if(-1!==h&&(g=Ll(t[hs](0,h)),c=Ic(t[hs](h+1))),Vl(c,"domain",a||o,Kl,_l),!bl(n)){var p=zu();if(_l(c[dc])){var f=jl()+1e3*n;if(f>0){var v=new Date;v.setTime(f),Vl(c,dc,wc(v,p?ac:sc)||wc(v,p?ac:sc)||Bs,Kl)}}p||Vl(c,"max-age",Bs+n,null,_l)}var m=Mu();m&&"https:"===m.protocol&&(Vl(c,"secure",null,null,_l),null===fc&&(d=(Lu()||{})[ps],fc=!(kl(d)&&(Al(d,"CPU iPhone OS 12")||Al(d,"iPad; CPU OS 12")||Al(d,"Macintosh; Intel Mac OS X 10_14")&&Al(d,"Version/")&&Al(d,"Safari")||Al(d,"Macintosh; Intel Mac OS X 10_14")&&function(e,t){var n=!1;return e&&t&&!(n=e===t)&&(n=ll?e[Zs](t):function(e,t){var n=!1,r=t?t[ja]:0,i=e?e[ja]:0;if(r&&i&&i>=r&&!(n=e===t)){for(var o=i-1,a=r-1;a>=0;a--){if(e[o]!=t[a])return!1;o--}n=!0}return n}(e,t)),n}(d,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||Al(d,"Chrome/5")||Al(d,"Chrome/6")||Al(d,"UnrealEngine")&&!Al(d,"Chrome")||Al(d,"UCBrowser/12")||Al(d,"UCBrowser/11")))),fc&&Vl(c,"SameSite","None",null,_l)),Vl(c,"path",l||i,null,_l),(r.setCookie||Ac)(e,Ec(g,c)),u=!0}return u},n.get=function(e){var t=Bs;return bc(s)&&!Cc(r,e)&&(t=(r.getCookie||xc)(e)),t},n.del=function(e,t){var n=!1;return bc(s)&&(n=s.purge(e,t)),n},n.purge=function(e,n){var i,o=!1;if(Tc(t)){var a=((i={}).path=n||"/",i[dc]="Thu, 01 Jan 1970 00:00:01 GMT",i);zu()||(a["max-age"]="0"),(r.delCookie||Ac)(e,Ec(Bs,a)),o=!0}return o},n);return s[hc]=s,s}function Tc(e){if(null===pc){pc=!1;try{pc=void 0!==(mc||{})[lc]}catch(t){ic(e,2,68,"Cannot access document.cookie - "+Hl(t),{exception:ju(t)})}}return pc}function Ic(e){var t={};return e&&e[ja]&&Ol(Ll(e)[fs](";"),(function(e){if(e=Ll(e||Bs)){var n=e[gs]("=");-1===n?t[e]=null:t[Ll(e[hs](0,n))]=Ll(e[hs](n+1))}})),t}function wc(e,t){return Il(e[t])?e[t]():null}function Ec(e,t){var n=e||Bs;return El(t,(function(e,t){n+="; "+e+(bl(t)?Bs:"="+t)})),n}function xc(e){var t=Bs;if(mc){var n=mc[lc]||Bs;vc!==n&&(yc=Ic(n),vc=n),t=Ll(yc[e]||Bs)}return t}function Ac(e,t){mc&&(mc[lc]=e+"="+t)}var Dc=4294967296,kc=4294967295,Fc=!1,Pc=123456789,Nc=987654321;function Bc(){try{var e=2147483647&jl();(t=(Math.random()*Dc^e)+e)<0&&(t>>>=0),Pc=123456789+t&kc,Nc=987654321-t&kc,Fc=!0}catch(e){}var t}function Oc(e){var t=0,n=Pu(Cu)||Pu(Su);return n&&n.getRandomValues&&(t=n.getRandomValues(new Uint32Array(1))[0]&kc),0===t&&zu()&&(Fc||Bc(),t=function(e){var t=((Nc=36969*(65535&Nc)+(Nc>>16)&kc)<<16)+(65535&(Pc=18e3*(65535&Pc)+(Pc>>16)&kc))>>>0&kc;return e||(t>>>=0),t}()&kc),0===t&&(t=Math.floor(Dc*Math.random()|0)),e||(t>>>=0),t}var Rc=Aa,Lc="2.8.18",Mc="."+function(e){void 0===e&&(e=22);for(var t=Oc()>>>0,n=0,r=Bs;r[ja]<e;)n++,r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&t),t>>>=6,5===n&&(t=(Oc()<<2&4294967295|3&t)>>>0,n=0);return r}(6),qc=0;function Wc(e){return 1===e[ys]||9===e[ys]||!+e[ys]}function Uc(e,t){return void 0===t&&(t=!1),wl(e+qc+++(t?"."+Lc:Bs)+Mc)}function zc(e){var t={id:Uc("_aiData-"+(e||Bs)+"."+Lc),accept:function(e){return Wc(e)},get:function(e,n,r,i){var o=e[t.id];return o?o[wl(n)]:(i&&((o=function(e,t){var n=t[e.id];if(!n){n={};try{Wc(t)&&(function(e,t,n){if(Rc)try{return Rc(e,t,{value:n,enumerable:!1,configurable:!0}),!0}catch(e){}return!1}(t,e.id,n)||(t[e.id]=n))}catch(e){}}return n}(t,e))[wl(n)]=r),r)},kill:function(e,t){if(e&&e[t])try{delete e[t]}catch(e){}}};return t}var jc="on",Hc="attachEvent",Vc="addEventListener",Gc="detachEvent",Qc="removeEventListener",Kc="events",$c="visibilitychange",Zc="pagehide",Jc="pageshow",Xc="unload",Yc="beforeunload",eg=Uc("aiEvtPageHide"),tg=Uc("aiEvtPageShow"),ng=/\.[\.]+/g,rg=/[\.]+$/,ig=1,og=zc("events"),ag=/^([^.]*)(?:\.(.+)|)/;function sg(e){return e&&e[bs]?e[bs](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,Bs):e}function lg(e,t){var n;if(t){var r=Bs;Dl(t)?(r=Bs,Ol(t,(function(e){(e=sg(e))&&("."!==e[0]&&(e="."+e),r+=e)}))):r=sg(t),r&&("."!==r[0]&&(r="."+r),e=(e||Bs)+r)}var i=ag.exec(e||Bs)||[];return(n={})[Is]=i[1],n.ns=(i[2]||Bs).replace(ng,".").replace(rg,Bs)[fs](".").sort().join("."),n}function dg(e,t,n){void 0===n&&(n=!0);var r=og.get(e,Kc,{},n),i=r[t];return i||(i=r[t]=[]),i}function ug(e,t,n,r){e&&t&&t[Is]&&(e[Qc]?e[Qc](t[Is],n,r):e[Gc]&&e[Gc](jc+t[Is],n))}function cg(e,t,n,r){for(var i=t[ja];i--;){var o=t[i];o&&(n.ns&&n.ns!==o.evtName.ns||r&&!r(o)||(ug(e,o.evtName,o[ws],o.capture),t[es](i,1)))}}function gg(e,t){return t?lg("xx",Dl(t)?[e].concat(t):[e,t]).ns[fs]("."):e}function hg(e,t,n,r,i){var o;void 0===i&&(i=!1);var a=!1;if(e)try{var s=lg(t,r);if(a=function(e,t,n,r){var i=!1;return e&&t&&t[Is]&&n&&(e[Vc]?(e[Vc](t[Is],n,r),i=!0):e[Hc]&&(e[Hc](jc+t[Is],n),i=!0)),i}(e,s,n,i),a&&og.accept(e)){var l=((o={guid:ig++,evtName:s})[ws]=n,o.capture=i,o);dg(e,s.type)[Ma](l)}}catch(e){}return a}function pg(e,t,n,r,i){if(void 0===i&&(i=!1),e)try{var o=lg(t,r),a=!1;!function(e,t,n){if(t[Is])cg(e,dg(e,t[Is]),t,n);else{var r=og.get(e,Kc,{});El(r,(function(r,i){cg(e,i,t,n)})),0===Wl(r)[ja]&&og.kill(e,Kc)}}(e,o,(function(e){return!((!o.ns||n)&&e[ws]!==n||(a=!0,0))})),a||ug(e,o,n,i)}catch(e){}}function fg(e,t,n,r){var i=!1;return t&&e&&e[ja]>0&&Ol(e,(function(e){e&&(n&&-1!==Rl(n,e)||(i=function(e,t,n){var r=!1,i=Bu();i&&(r=hg(i,e,t,n),r=hg(i.body,e,t,n)||r);var o=Ou();return o&&(r=hg(o,e,t,n)||r),r}(e,t,r)||i))})),i}function vg(e,t,n){e&&Dl(e)&&Ol(e,(function(e){e&&function(e,t,n){var r=Bu();r&&(pg(r,e,t,n),pg(r.body,e,t,n));var i=Ou();i&&pg(i,e,t,n)}(e,t,n)}))}function mg(e,t,n){var r=gg(eg,n),i=fg([Zc],e,t,r);return t&&-1!==Rl(t,$c)||(i=fg([$c],(function(t){var n=Ou();e&&n&&"hidden"===n.visibilityState&&e(t)}),t,r)||i),!i&&t&&(i=mg(e,null,n)),i}function yg(e,t,n){var r=gg(tg,n),i=fg([Jc],e,t,r);return!(i=fg([$c],(function(t){var n=Ou();e&&n&&"visible"===n.visibilityState&&e(t)}),t,r)||i)&&t&&(i=yg(e,null,n)),i}function _g(){var e=function(){for(var e,t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n=Bs,r=0;r<4;r++)n+=t[15&(e=Oc())]+t[e>>4&15]+t[e>>8&15]+t[e>>12&15]+t[e>>16&15]+t[e>>20&15]+t[e>>24&15]+t[e>>28&15];var i=t[8+(3&Oc())|0];return n[ms](0,8)+n[ms](9,4)+"4"+n[ms](13,3)+i+n[ms](16,3)+n[ms](19,12)}();return e[hs](0,8)+"-"+e[hs](8,12)+"-"+e[hs](12,16)+"-"+e[hs](16,20)+"-"+e[hs](20)}var bg=((Fa()||{}).Symbol,(Fa()||{}).Reflect,function(e,t){return bg=Ia.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t[Ta](n)&&(e[n]=t[n])},bg(e,t)});function Cg(e,t){function n(){this.constructor=e}typeof t!==_a&&null!==t&&Pa("Class extends value "+String(t)+" is not a constructor or null"),bg(e,t),e[Sa]=null===t?Na(t):(n[Sa]=t[Sa],new n)}function Sg(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e}var Tg="ctx",Ig="ParentContextKey",wg="ChildrenContextKey",Eg=function(){function e(t,n,r){var i,o=this,a=!1;o.start=jl(),o[Oa]=t,o[is]=r,o[xs]=function(){return!1},Il(n)&&(a=Ul(o,"payload",(function(){return!i&&Il(n)&&(i=n(),n=null),i}))),o[As]=function(t){return t?t===e[Ig]||t===e[wg]?o[t]:(o[Tg]||{})[t]:null},o[Ds]=function(t,n){t&&(t===e[Ig]?(o[t]||(o[xs]=function(){return!0}),o[t]=n):t===e[wg]?o[t]=n:(o[Tg]=o[Tg]||{})[t]=n)},o[ks]=function(){var t=0,r=o[As](e[wg]);if(Dl(r))for(var i=0;i<r[ja];i++){var s=r[i];s&&(t+=s[Ha])}o[Ha]=jl()-o.start,o.exTime=o[Ha]-t,o[ks]=function(){},!a&&Il(n)&&(o.payload=n())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),xg=function(){function e(t){this.ctx={},pu(e,this,(function(e){e.create=function(e,t,n){return new Eg(e,t,n)},e.fire=function(e){e&&(e[ks](),t&&Il(t[Vs])&&t[Vs](e))},e[Ds]=function(t,n){t&&((e[Tg]=e[Tg]||{})[t]=n)},e[As]=function(t){return(e[Tg]||{})[t]}}))}return e.__ieDyn=1,e}(),Ag="CoreUtils.doPerf";function Dg(e,t,n,r,i){if(e){var o=e;if(o[Ks]&&(o=o[Ks]()),o){var a=void 0,s=o[As](Ag);try{if(a=o.create(t(),r,i)){if(s&&a[Ds]&&(a[Ds](Eg[Ig],s),s[As]&&s[Ds])){var l=s[As](Eg[wg]);l||(l=[],s[Ds](Eg[wg],l)),l[Ma](a)}return o[Ds](Ag,a),n(a)}}catch(e){a&&a[Ds]&&a[Ds]("exception",e)}finally{a&&o.fire(a),o[Ds](Ag,s)}}}return n()}function kg(e,t,n){return!(!e||e[ja]!==t||e===n||!e.match(/^[\da-f]*$/i))}var Fg=zc("plugin");function Pg(e){return Fg.get(e,"state",{},!0)}function Ng(e,t){for(var n,r=[],i=null,o=e[ss]();o;){var a=o[Ja]();a&&(i&&Il(i[ds])&&Il(a[Ws])&&i[ds](a),(Il(a[qa])?a[qa]():(n=Pg(a))[qa])||r[Ma](a),i=a,o=o[ss]())}Ol(r,(function(r){var i=e[Rs]();r[Ba](e.getCfg(),i,t,e[ss]()),n=Pg(r),r[Rs]||n[Rs]||(n[Rs]=i),n[qa]=!0,delete n[ts]}))}function Bg(e){return e.sort((function(e,t){var n=0;if(t){var r=Il(t[Ws]);Il(e[Ws])?n=r?e[Us]-t[Us]:1:r&&(n=-1)}else n=e?1:-1;return n}))}var Og="TelemetryPluginChain",Rg="_hasRun",Lg="_getTelCtx",Mg=0;function qg(e,t,n,r){var i=null,o=[];null!==r&&(i=r?function(e,t,n){for(;e;){if(e[Ja]()===n)return e;e=e[ss]()}return jg([n],t[Wa]||{},t)}(e,n,r):e);var a={_next:function(){var e=i;if(i=e?e[ss]():null,!e){var t=o;t&&t[ja]>0&&(Ol(t,(function(e){try{e.func[Ts](e.self,e.args)}catch(e){ic(n[za],2,73,"Unexpected Exception during onComplete - "+ju(e))}})),o=[])}return e},ctx:{core:function(){return n},diagLog:function(){return function(e,t){return(e||{})[za]||new nc(t)}(n,t)},getCfg:function(){return t},getExtCfg:s,getConfig:function(e,n,r){void 0===r&&(r=!1);var i,o=s(e,null);return o&&!bl(o[n])?i=o[n]:t&&!bl(t[n])&&(i=t[n]),bl(i)?r:i},hasNext:function(){return!!i},getNext:function(){return i},setNext:function(e){i=e},iterate:function(e){for(var t;t=a._next();){var n=t[Ja]();n&&e(n)}},onComplete:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];e&&o[Ma]({func:e,self:_l(t)?a.ctx:t,args:n})}}};function s(e,n,r){var i;if(void 0===n&&(n={}),void 0===r&&(r=0),t){var o=t[qs];o&&e&&(i=o[e])}if(i){if(Tl(n)&&0!==r){var a=Xl(!0,n,i);t&&2===r&&El(n,(function(e){if(bl(a[e])){var n=t[e];bl(n)||(a[e]=n)}})),i=a}}else i=n;return i}return a}function Wg(e,t,n,r){var i=qg(e,t,n,r),o=i.ctx;return o[Va]=function(e){var t=i._next();return t&&t[Ws](e,o),!t},o[us]=function(e,r){return void 0===e&&(e=null),Dl(e)&&(e=jg(e,t,n,r)),Wg(e||o[ss](),t,n,r)},o}function Ug(e,t,n){var r=t[Wa]||{},i=qg(e,r,t,n),o=i.ctx;return o[Va]=function(e){var t=i._next();return t&&t.unload(o,e),!t},o[us]=function(e,n){return void 0===e&&(e=null),Dl(e)&&(e=jg(e,r,t,n)),Ug(e||o[ss](),t,n)},o}function zg(e,t,n){var r=t[Wa]||{},i=qg(e,r,t,n).ctx;return i[Va]=function(e){return i.iterate((function(t){Il(t[as])&&t[as](i,e)}))},i[us]=function(e,n){return void 0===e&&(e=null),Dl(e)&&(e=jg(e,r,t,n)),zg(e||i[ss](),t,n)},i}function jg(e,t,n,r){var i=null,o=!r;if(Dl(e)&&e[ja]>0){var a=null;Ol(e,(function(e){if(o||r!==e||(o=!0),o&&e&&Il(e[Ws])){var s=function(e,t,n){var r,i=null,o=Il(e[Ws]),a=Il(e[ds]),s={getPlugin:function(){return e},getNext:function(){return i},processTelemetry:function(r,d){l(d=d||function(){var r;return e&&Il(e[Lg])&&(r=e[Lg]()),r||(r=Wg(s,t,n)),r}(),(function(t){if(!e||!o)return!1;var n=Pg(e);return!n[ts]&&!n[Ms]&&(a&&e[ds](i),e[Ws](r,t),!0)}),"processTelemetry",(function(){return{item:r}}),!r.sync)||d[Va](r)},unload:function(t,n){l(t,(function(){var r=!1;if(e){var i=Pg(e),o=e[Rs]||i[Rs];!e||o&&o!==t.core()||i[ts]||(i[Rs]=null,i[ts]=!0,i[qa]=!1,e[ts]&&!0===e[ts](t,n)&&(r=!0))}return r}),"unload",(function(){}),n[is])||t[Va](n)},update:function(t,n){l(t,(function(){var r=!1;if(e){var i=Pg(e),o=e[Rs]||i[Rs];!e||o&&o!==t.core()||i[ts]||e[as]&&!0===e[as](t,n)&&(r=!0)}return r}),"update",(function(){}),!1)||t[Va](n)},_id:r=e?e[La]+"-"+e[Us]+"-"+Mg++:"Unknown-0-"+Mg++,_setNext:function(e){i=e}};function l(t,n,o,a,s){var l=!1,d=e?e[La]:Og,u=t[Rg];return u||(u=t[Rg]={}),t.setNext(i),e&&Dg(t[Rs](),(function(){return d+":"+o}),(function(){u[r]=!0;try{var e=i?i._id:Bs;e&&(u[e]=!1),l=n(t)}catch(e){var a=!i||u[i._id];a&&(l=!0),i&&a||ic(t[ls](),1,73,"Plugin ["+d+"] failed during "+o+" - "+ju(e)+", run flags: "+ju(u))}}),a,s),l}return zl(s)}(e,t,n);i||(i=s),a&&a._setNext(s),a=s}}))}return r&&!i?jg([r],t,n):i}var Hg=500;function Vg(e,t,n){t&&Dl(t)&&t[ja]>0&&(Ol(t=t.sort((function(e,t){return e[Us]-t[Us]})),(function(e){e[Us]<Hg&&$l("Channel has invalid priority - "+e[La])})),e[Ma]({queue:zl(t),chain:jg(t,n[Wa],n)}))}function Gg(){var e=[];return{add:function(t){t&&e[Ma](t)},run:function(t,n){Ol(e,(function(e){try{e(t,n)}catch(e){ic(t[ls](),2,73,"Unexpected error calling unload handler - "+ju(e))}})),e=[]}}}var Qg="getPlugin",Kg=function(){function e(){var t,n,r,i,o,a=this;function s(e){void 0===e&&(e=null);var t=e;if(!t){var i=n||Wg(null,{},a[Rs]);t=r&&r[Qg]?i[us](null,r[Qg]):i[us](null,r)}return t}function l(e,t,i){e&&Vl(e,qs,[],null,bl),!i&&t&&(i=t[Ga]()[ss]());var o=r;r&&r[Qg]&&(o=r[Qg]()),a[Rs]=t,n=Wg(i,e,t,o)}function d(){t=!1,a[Rs]=null,n=null,r=null,o=[],i=Gg()}d(),pu(e,a,(function(e){e[Ba]=function(e,n,r,i){l(e,n,i),t=!0},e[ts]=function(t,n){var a,s=e[Rs];if(s&&(!t||s===t[Rs]())){var l,u=!1,c=t||Ug(null,s,r&&r[Qg]?r[Qg]():r),g=n||((a={reason:0})[is]=!1,a);return e[os]&&!0===e[os](c,g,h)?l=!0:h(),l}function h(){if(!u){u=!0,i.run(c,n);var e=o;o=[],Ol(e,(function(e){e.rm()})),!0===l&&c[Va](g),d()}}},e[as]=function(t,n){var i=e[Rs];if(i&&(!t||i===t[Rs]())){var o,a=!1,s=t||zg(null,i,r&&r[Qg]?r[Qg]():r),d=n||{reason:0};return e._doUpdate&&!0===e._doUpdate(s,d,u)?o=!0:u(),o}function u(){a||(a=!0,l(s.getCfg(),s.core(),s[ss]()))}},e._addHook=function(e){e&&(Dl(e)?o=o.concat(e):o[Ma](e))},Zl(e,"_addUnloadCb",(function(){return i}),"add")})),a[ls]=function(e){return s(e)[ls]()},a[qa]=function(){return t},a.setInitialized=function(e){t=e},a[ds]=function(e){r=e},a[Va]=function(e,t){t?t[Va](e):r&&Il(r[Ws])&&r[Ws](e,null)},a._getTelCtx=s}return e.__ieDyn=1,e}(),$g=function(e){function t(){var n,r,i=e.call(this)||this;function o(){n=0,r=[]}return i.identifier="TelemetryInitializerPlugin",i.priority=199,o(),pu(t,i,(function(e,t){e.addTelemetryInitializer=function(e){var t={id:n++,fn:e};return r[Ma](t),{remove:function(){Ol(r,(function(e,n){if(e.id===t.id)return r[es](n,1),-1}))}}},e[Ws]=function(t,n){for(var i=!1,o=r[ja],a=0;a<o;++a){var s=r[a];if(s)try{if(!1===s.fn[_s](null,[t])){i=!0;break}}catch(e){ic(n[ls](),1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+Hl(e),{exception:ju(e)},!0)}}i||e[Va](t,n)},e[os]=function(){o()}})),i}return Cg(t,e),t.__ieDyn=1,t}(Kg),Zg="Plugins must provide initialize method",Jg="_notificationManager",Xg="SDK is still unloading...",Yg={loggingLevelConsole:1};function eh(e,t){return new xg(t)}function th(e,t){var n=!1;return Ol(t,(function(t){if(t===e)return n=!0,-1})),n}var nh=function(){function e(){var t,n,r,i,o,a,s,l,d,u,c,g,h,p,f,v,m,y,_,b,C=0,S=!1;pu(e,this,(function(e){function T(n){if(!C&&!S&&(n||e[za]&&e[za].queue[ja]>0)){var r=Ql(t.diagnosticLogInterval);r&&r>0||(r=1e4),C=setInterval((function(){clearInterval(C),C=0,k()}),r)}return C}function I(){n=!1,t=Xl(!0,{},Yg),e[Wa]=t,e[za]=new nc(t),e[Ya]=[],f=new $g,r=[],i=null,o=null,a=null,s=null,l=null,u=null,d=[],c=null,g=null,h=null,p=!1,v=null,m=Uc("AIBaseCore",!0),y=Gg(),b=null}function w(){var n=Wg(A(),t,e);return n[Za](T),n}function E(n){var r=function(e,t,n){var r,i=[],o={};return Ol(n,(function(t){(bl(t)||bl(t[Ba]))&&$l(Zg);var n=t[Us],r=t[La];t&&n&&(bl(o[n])?o[n]=r:oc(e,"Two extensions have same priority #"+n+" - "+o[n]+", "+r)),(!n||n<500)&&i[Ma](t)})),(r={all:n})[Rs]=i,r}(e[za],0,d);u=r[Rs],l=null;var i=r.all;if(h=zl(function(e,t,n){var r=[];if(e&&Ol(e,(function(e){return Vg(r,e,n)})),t){var i=[];Ol(t,(function(e){e[Us]>Hg&&i[Ma](e)})),Vg(r,i,n)}return r}(g,i,e)),c){var o=Rl(i,c);-1!==o&&i[es](o,1),-1!==(o=Rl(u,c))&&u[es](o,1),c._setQueue(h)}else c=function(e,t){function n(){return Wg(null,t[Wa],t,null)}function r(e,t,n,r){var i=e?e[ja]+1:1;function o(){0==--i&&(r&&r(),r=null)}i>0&&Ol(e,(function(e){if(e&&e.queue[ja]>0){var r=e.chain,a=t[us](r);a[Za](o),n(a)}else i--})),o()}var i=!1,o={identifier:"ChannelControllerPlugin",priority:Hg,initialize:function(t,n,r,o){i=!0,Ol(e,(function(e){e&&e.queue[ja]>0&&Ng(Wg(e.chain,t,n),r)}))},isInitialized:function(){return i},processTelemetry:function(t,i){r(e,i||n(),(function(e){e[Va](t)}),(function(){i[Va](t)}))},update:function(t,n){var i=n||{reason:0};return r(e,t,(function(e){e[Va](i)}),(function(){t[Va](i)})),!0},pause:function(){r(e,n(),(function(e){e.iterate((function(e){e.pause&&e.pause()}))}),null)},resume:function(){r(e,n(),(function(e){e.iterate((function(e){e.resume&&e.resume()}))}),null)},teardown:function(t,n){var o=n||{reason:0,isAsync:!1};return r(e,t,(function(e){e[Va](o)}),(function(){t[Va](o),i=!1})),!0},getChannel:function(t){var n=null;return e&&e[ja]>0&&Ol(e,(function(e){if(e&&e.queue[ja]>0&&(Ol(e.queue,(function(e){if(e[La]===t)return n=e,-1})),n))return-1})),n},flush:function(t,i,o,a){var s=1,l=!1,d=null;function u(){s--,l&&0===s&&(d&&(clearTimeout(d),d=null),i&&i(l),i=null)}return a=a||5e3,r(e,n(),(function(e){e.iterate((function(e){if(e[Xa]){s++;var n=!1;e[Xa](t,(function(){n=!0,u()}),o)||n||(t&&null==d?d=setTimeout((function(){d=null,u()}),a):u())}}))}),(function(){l=!0,u()})),!0},_setQueue:function(t){e=t}};return o}(h,e);i[Ma](c),u[Ma](c),e[Ya]=Bg(i),c[Ba](t,e,i),Ng(w(),i),e[Ya]=zl(Bg(u||[])).slice(),n&&function(t){var n=zg(A(),e);n[Za](T),e._updateHook&&!0===e._updateHook(n,t)||n[Va](t)}(n)}function x(t){var n,r=null,i=null;return Ol(e[Ya],(function(e){if(e[La]===t&&e!==c&&e!==f)return i=e,-1})),!i&&c&&(i=c.getChannel(t)),i&&((n={plugin:i})[vs]=function(e){Pg(i)[Ms]=!e},n.isEnabled=function(){var e=Pg(i);return!e[ts]&&!e[Ms]},n.remove=function(e,t){var n;void 0===e&&(e=!0);var r=[i],o=((n={reason:1})[is]=e,n);D(r,o,(function(e){e&&E({reason:32,removed:r}),t&&t(e)}))},r=n),r}function A(){if(!l){var n=(u||[]).slice();-1===Rl(n,f)&&n[Ma](f),l=jg(Bg(n),t,e)}return l}function D(n,r,i){if(n&&n[ja]>0){var o=Ug(jg(n,t,e),e);o[Za]((function(){var e=!1,t=[];Ol(d,(function(r,i){th(r,n)?e=!0:t[Ma](r)})),d=t;var r=[];g&&(Ol(g,(function(t,i){var o=[];Ol(t,(function(t){th(t,n)?e=!0:o[Ma](t)})),r[Ma](o)})),g=r),i&&i(e),T()})),o[Va](r)}else i(!1)}function k(){if(e[za]&&e[za].queue){var n=e[za].queue.slice(0);e[za].queue[ja]=0,Ol(n,(function(n){var r,i=((r={})[Oa]=v||"InternalMessageId: "+n[ns],r.iKey=Ql(t[Ua]),r.time=Bl(new Date),r.baseType=tc.dataType,r.baseData={message:n[rs]},r);e.track(i)}))}}function F(e,t,n,r){return c?c[Xa](e,t,n||6,r):(t&&t(!1),!0)}function P(t){var n=e[za];n?(ic(n,2,73,t),T()):$l(t)}var N,B,O,R;I(),e[qa]=function(){return n},e[Ba]=function(r,o,s,l){var u,c;p&&$l(Xg),e[qa]()&&$l("Core should not be initialized more than once"),t=r||{},e[Wa]=t,bl(r[Ua])&&$l("Please provide instrumentation key"),i=l,e[Jg]=l,!0===(c=Ql(t.disableDbgExt))&&_&&(i[Ka](_),_=null),i&&!_&&!0!==c&&(_=Xu(t),i[Qa](_)),!(u=Ql(t.enablePerfMgr))&&a&&(a=null),u&&Gl(t,Ls,eh),Gl(t,qs,{}).NotificationManager=i,s&&(e[za]=s);var f=Gl(t,"extensions",[]);(d=[])[Ma].apply(d,Sg(Sg([],o),f)),g=Gl(t,Os,[]),E(null),h&&0!==h[ja]||$l("No "+Os+" available"),n=!0,e.releaseQueue()},e.getTransmissionControls=function(){var e=[];return h&&Ol(h,(function(t){e[Ma](t.queue)})),zl(e)},e.track=function(n){n.iKey=n.iKey||t[Ua],n[Ha]=n[Ha]||Bl(new Date),n.ver=n.ver||"4.0",!p&&e[qa]()?w()[Va](n):r[Ma](n)},e[Ga]=w,e[Ra]=function(){return i||(i=function(){var e;return Na(((e={})[Qa]=function(e){},e[Ka]=function(e){},e[zs]=function(e){},e[js]=function(e,t){},e[Hs]=function(e,t){},e))}(),e[Jg]=i),i},e[Qa]=function(e){i&&i[Qa](e)},e[Ka]=function(e){i&&i[Ka](e)},e.getCookieMgr=function(){return s||(s=Sc(t,e[za])),s},e.setCookieMgr=function(e){s=e},e[Ks]=function(){if(!o&&!a&&Ql(t.enablePerfMgr)){var n=Ql(t[Ls]);Il(n)&&(a=n(e,e[Ra]()))}return o||a||null},e.setPerfMgr=function(e){o=e},e.eventCnt=function(){return r[ja]},e.releaseQueue=function(){if(n&&r[ja]>0){var e=r;r=[],Ol(e,(function(e){w()[Va](e)}))}},e.pollInternalLogs=function(e){return v=e||null,S=!1,C&&(clearInterval(C),C=null),T(!0)},e[$a]=function(){S=!0,C&&(clearInterval(C),C=0,k())},B=function(){return f},O=["addTelemetryInitializer"],(N=e)&&B&&Tl(N)&&Dl(O)&&Ol(O,(function(e){kl(e)&&Zl(N,e,B,e,R)})),e.unload=function(t,r,i){var o;void 0===t&&(t=!0),n||$l("SDK is not initialized"),p&&$l(Xg);var a=((o={reason:50})[is]=t,o.flushComplete=!1,o),s=Ug(A(),e);function l(t){a.flushComplete=t,p=!0,y.run(s,a),e[$a](),s[Va](a)}s[Za]((function(){I(),r&&r(a)}),e),k(),F(t,l,6,i)||l(!1)},e[Ja]=x,e.addPlugin=function(e,t,n,r){if(!e)return r&&r(!1),void P(Zg);var i=x(e[La]);if(i&&!t)return r&&r(!1),void P("Plugin ["+e[La]+"] is already loaded!");var o={reason:16};function a(t){d[Ma](e),o.added=[e],E(o),r&&r(!0)}if(i){var s=[i.plugin];D(s,{reason:2,isAsync:!!n},(function(e){e?(o.removed=s,o.reason|=32,a()):r&&r(!1)}))}else a()},e.evtNamespace=function(){return m},e[Xa]=F,e.getTraceCtx=function(e){var t;return b||(t={},b={getName:function(){return t[Oa]},setName:function(e){t[Oa]=e},getTraceId:function(){return t[Fs]},setTraceId:function(e){kg(e,32,"00000000000000000000000000000000")&&(t[Fs]=e)},getSpanId:function(){return t[Ps]},setSpanId:function(e){kg(e,16,"0000000000000000")&&(t[Ps]=e)},getTraceFlags:function(){return t[Ns]},setTraceFlags:function(e){t[Ns]=e}}),b},e.setTraceCtx=function(e){b=e||null},Zl(e,"addUnloadCb",(function(){return y}),"add")}))}return e.__ieDyn=1,e}();function rh(e,t,n,r){Ol(e,(function(e){if(e&&e[t])if(n)setTimeout((function(){return r(e)}),0);else try{r(e)}catch(e){}}))}var ih,oh=function(){function e(t){this.listeners=[];var n=!!(t||{}).perfEvtsSendAll;pu(e,this,(function(e){e[Qa]=function(t){e.listeners[Ma](t)},e[Ka]=function(t){for(var n=Rl(e[Es],t);n>-1;)e.listeners[es](n,1),n=Rl(e[Es],t)},e[zs]=function(t){rh(e[Es],zs,!0,(function(e){e[zs](t)}))},e[js]=function(t,n){rh(e[Es],js,!0,(function(e){e[js](t,n)}))},e[Hs]=function(t,n){rh(e[Es],Hs,n,(function(e){e[Hs](t,n)}))},e[Vs]=function(t){t&&(!n&&t[xs]()||rh(e[Es],Vs,!1,(function(e){t[is]?setTimeout((function(){return e[Vs](t)}),0):e[Vs](t)})))}}))}return e.__ieDyn=1,e}(),ah=function(e){function t(){var n=e.call(this)||this;return pu(t,n,(function(e,t){function n(t){var n=e[Ra]();n&&n[js]([t],2)}e[Ba]=function(e,n,r,i){t[Ba](e,n,r||new nc(e),i||new oh(e))},e.track=function(r){Dg(e[Ks](),(function(){return"AppInsightsCore:track"}),(function(){null===r&&(n(r),$l("Invalid telemetry item")),function(e){bl(e[Oa])&&(n(e),$l("telemetry name required"))}(r),t.track(r)}),(function(){return{item:r}}),!r.sync)}})),n}return Cg(t,e),t.__ieDyn=1,t}(nh),sh="",lh="version",dh="properties",uh="1DS-Web-JS-3.2.18",ch="withCredentials",gh=((ih={})[0]=0,ih[2]=6,ih[1]=1,ih[3]=7,ih[4098]=6,ih[4097]=1,ih[4099]=7,ih);function hh(e){return!(e===sh||bl(e))}function ph(e,t,n){var r=-1;if(!_l(e))if(t>0&&(32===t?r=8192:t<=13&&(r=t<<5)),function(e){return e>=0&&e<=9}(n))-1===r&&(r=0),r|=n;else{var i=gh[yh(e)]||-1;-1!==r&&-1!==i?r|=i:6===i&&(r=i)}return r}function fh(e,t,n,r,i){var o={},a=!1,s=0,l=arguments.length,d=arguments;for("[object Boolean]"===Object[Sa].toString.call(d[0])&&(a=d[0],s++);s<l;s++)El(d[s],(function(e,t){a&&t&&Tl(t)?Dl(t)?(o[e]=o[e]||[],Ol(t,(function(t,n){t&&Tl(t)?o[e][n]=fh(!0,o[e][n],t):o[e][n]=t}))):o[e]=fh(!0,o[e],t):o[e]=t}));return o}Boolean(Ou()),Boolean(Bu());var vh=function(){var e=Pu(_u);return e&&e.now?e.now():jl()};function mh(e,t){var n=e;n.timings=n.timings||{},n.timings.processTelemetryStart=n.timings.processTelemetryStart||{},n.timings.processTelemetryStart[t]=vh()}function yh(e){var t=0;if(null!=e){var n=typeof e;"string"===n?t=1:"number"===n?t=2:"boolean"===n?t=3:n===ba&&(t=4,Dl(e)?(t=4096,e.length>0&&(t|=yh(e[0]))):Da.call(e,"value")&&(t=8192|yh(e.value)))}return t}var _h=function(e){function t(){var n=e.call(this)||this;return n.pluginVersionStringArr=[],pu(t,n,(function(e,t){e.logger&&e.logger.queue||(e.logger=new nc({loggingLevelConsole:1})),e.initialize=function(n,r,i,o){Dg(e,(function(){return"AppInsightsCore.initialize"}),(function(){var a=e.pluginVersionStringArr;if(n){n.endpointUrl||(n.endpointUrl="https://browser.events.data.microsoft.com/OneCollector/1.0/");var s=n.propertyStorageOverride;!s||s.getProperty&&s.setProperty||$l("Invalid property storage override passed."),n.channels&&Ol(n.channels,(function(e){e&&Ol(e,(function(e){if(e.identifier&&e.version){var t=e.identifier+"="+e.version;a.push(t)}}))}))}e.getWParam=function(){return"undefined"!=typeof document||n.enableWParam?0:-1},r&&Ol(r,(function(e){if(e&&e.identifier&&e.version){var t=e.identifier+"="+e.version;a.push(t)}})),e.pluginVersionString=a.join(";"),e.pluginVersionStringArr=a;try{t.initialize(n,r,i,o),e.pollInternalLogs("InternalLog")}catch(t){var l=e.logger,d=ju(t);-1!==d.indexOf("channels")&&(d+="\n - Channels must be provided through config.channels only!"),ic(l,1,514,"SDK Initialization Failed - no telemetry will be sent: "+d)}}),(function(){return{config:n,extensions:r,logger:i,notificationManager:o}}))},e.track=function(n){Dg(e,(function(){return"AppInsightsCore.track"}),(function(){var r,i=n;if(i){i.timings=i.timings||{},i.timings.trackStart=vh(),(r=i.latency)&&Fl(r)&&r>=1&&r<=4||(i.latency=1);var o=i.ext=i.ext||{};o.sdk=o.sdk||{},o.sdk.ver=uh;var a=i.baseData=i.baseData||{};a[dh]=a[dh]||{};var s=a[dh];s[lh]=s[lh]||e.pluginVersionString||sh}t.track(i)}),(function(){return{item:n}}),!n.sync)}})),n}return Cg(t,e),t.__ieDyn=1,t}(ah);const bh=_h;var Ch,Sh,Th=(Sh={},El({Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5},(function(e,t){Sh[e]=t,Sh[t]=e})),Ch=Sh,il&&El(Ch,(function(e,t){(Dl(t)||Tl(t))&&il(t)})),zl(Ch)),Ih="REAL_TIME",wh="",Eh="POST",xh="drop",Ah="requeue",Dh="application/x-json-stream",kh="cache-control",Fh="content-type",Ph="kill-duration",Nh="time-delta-millis",Bh="client-version",Oh="client-id",Rh="time-delta-to-apply-millis",Lh="upload-time",Mh="apikey",qh="AuthMsaDeviceTicket",Wh="AuthXToken",Uh="msfpc",zh="trace",jh="user";function Hh(e){var t=(e.ext||{}).intweb;return t&&hh(t[Uh])?t[Uh]:null}function Vh(e){for(var t=null,n=0;null===t&&n<e.length;n++)t=Hh(e[n]);return t}var Gh=function(){function e(t,n){var r=n?[].concat(n):[],i=this,o=Vh(r);i.iKey=function(){return t},i.Msfpc=function(){return o||wh},i.count=function(){return r.length},i.events=function(){return r},i.addEvent=function(e){return!!e&&(r.push(e),o||(o=Hh(e)),!0)},i.split=function(n,i){var a;if(n<r.length){var s=r.length-n;bl(i)||(s=i<s?i:s),a=r.splice(n,s),o=Vh(r)}return new e(t,a)}}return e.create=function(t,n){return new e(t,n)},e}();const Qh=function(){function e(){var t=!0,n=!0,r=!0,i="use-collector-delta",o=!1;pu(e,this,(function(e){e.allowRequestSending=function(){return t},e.firstRequestSent=function(){r&&(r=!1,o||(t=!1))},e.shouldAddClockSkewHeaders=function(){return n},e.getClockSkewHeaderValue=function(){return i},e.setClockSkew=function(e){o||(e?(i=e,n=!0,o=!0):n=!1,t=!0)}}))}return e.__ieDyn=1,e}();var Kh=function(){function e(){var t={};pu(e,this,(function(e){e.setKillSwitchTenants=function(e,n){if(e&&n)try{var r=function(e){var t=[];return e&&Ol(e,(function(e){t.push(Ll(e))})),t}(e.split(","));if("this-request-only"===n)return r;for(var i=1e3*parseInt(n,10),o=0;o<r.length;++o)t[r[o]]=jl()+i}catch(e){return[]}return[]},e.isTenantKilled=function(e){var n=t,r=Ll(e);return void 0!==n[r]&&n[r]>jl()||(delete n[r],!1)}}))}return e.__ieDyn=1,e}();const $h=Kh;function Zh(e){var t,n=Math.floor(1200*Math.random())+2400;return t=Math.pow(2,e)*n,Math.min(t,6e5)}var Jh,Xh=2e6,Yh=Math.min(Xh,65e3),ep="metadata",tp="f",np=/\./,rp=function(){function e(t,n,r,i){var o="data",a="baseData",s=!!i,l=!0,d=n,u={};pu(e,this,(function(e){function n(e,t,i,o,a,l,c){El(e,(function(e,g){var h=null;if(g||hh(g)){var p=i,f=e,v=a,m=t;if(s&&!o&&np.test(e)){var y=e.split("."),_=y.length;if(_>1){v&&(v=v.slice());for(var b=0;b<_-1;b++){var C=y[b];m=m[C]=m[C]||{},p+="."+C,v&&v.push(C)}f=y[_-1]}}var S=o&&function(e,t){var n=u[e];return void 0===n&&(e.length>=7&&(n=xl(e,"ext.metadata")||xl(e,"ext.web")),u[e]=n),n}(p);if(h=!S&&d&&d.handleField(p,f)?d.value(p,f,g,r):function(e,t,n){if(!t&&!hh(t)||"string"!=typeof e)return null;var r=typeof t;if("string"===r||"number"===r||"boolean"===r||Dl(t))t={value:t};else if("object"!==r||Da.call(t,"value")){if(bl(t.value)||t.value===sh||!kl(t.value)&&!Fl(t.value)&&!Pl(t.value)&&!Dl(t.value))return null}else t={value:n?JSON.stringify(t):t};if(Dl(t.value)&&!(t.value.length>0))return null;if(!bl(t.kind)){if(Dl(t.value)||!(0===(i=t.kind)||i>0&&i<=13||32===i))return null;t.value=t.value.toString()}var i;return t}(f,g,r)){var T=h.value;if(m[f]=T,l&&l(v,f,h),c&&"object"==typeof T&&!Dl(T)){var I=v;I&&(I=I.slice()).push(f),n(g,T,p+"."+f,o,I,l,c)}}}}))}e.createPayload=function(e,t,n,r,i,o){return{apiKeys:[],payloadBlob:wh,overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:e,isTeardown:t,isSync:n,isBeacon:r,sendType:o,sendReason:i}},e.appendPayload=function(n,r,i){var o=n&&r&&!n.overflow;return o&&Dg(t,(function(){return"Serializer:appendPayload"}),(function(){for(var t=r.events(),o=n.payloadBlob,a=n.numEvents,s=!1,l=[],d=[],u=n.isBeacon,c=u?65e3:3984588,g=u?Yh:Xh,h=0,p=0;h<t.length;){var f=t[h];if(f){if(a>=i){n.overflow=r.split(h);break}var v=e.getEventBlob(f);if(v&&v.length<=g){var m=v.length;if(o.length+m>c){n.overflow=r.split(h);break}o&&(o+="\n"),o+=v,++p>20&&(o.substr(0,1),p=0),s=!0,a++}else v?l.push(f):d.push(f),t.splice(h,1),h--}h++}if(l&&l.length>0&&n.sizeExceed.push(Gh.create(r.iKey(),l)),d&&d.length>0&&n.failedEvts.push(Gh.create(r.iKey(),d)),s){n.batches.push(r),n.payloadBlob=o,n.numEvents=a;var y=r.iKey();-1===Rl(n.apiKeys,y)&&n.apiKeys.push(y)}}),(function(){return{payload:n,theBatch:{iKey:r.iKey(),evts:r.events()},max:i}})),o},e.getEventBlob=function(e){try{return Dg(t,(function(){return"Serializer.getEventBlob"}),(function(){var t={};t.name=e.name,t.time=e.time,t.ver=e.ver,t.iKey="o:"+function(e){if(e){var t=e.indexOf("-");if(t>-1)return e.substring(0,t)}return sh}(e.iKey);var r={},i=e.ext;i&&(t.ext=r,El(i,(function(e,t){n(t,r[e]={},"ext."+e,!0,null,null,!0)})));var s=t[o]={};s.baseType=e.baseType;var d=s[a]={};return n(e.baseData,d,a,!1,[a],(function(e,t,n){ip(r,e,t,n)}),l),n(e.data,s,o,!1,[],(function(e,t,n){ip(r,e,t,n)}),l),JSON.stringify(t)}),(function(){return{item:e}}))}catch(e){return null}}}))}return e.__ieDyn=1,e}();function ip(e,t,n,r){if(r&&e){var i=ph(r.value,r.kind,r.propertyType);if(i>-1){var o=e[ep];o||(o=e[ep]={f:{}});var a=o[tp];if(a||(a=o[tp]={}),t)for(var s=0;s<t.length;s++){var l=t[s];a[l]||(a[l]={f:{}});var d=a[l][tp];d||(d=a[l][tp]={}),a=d}a=a[n]={},Dl(r.value)?a.a={t:i}:a.t=i}}}var op="sendAttempt",ap="&NoResponseBody=true",sp=((Jh={})[1]=Ah,Jh[100]=Ah,Jh[200]="sent",Jh[8004]=xh,Jh[8003]=xh,Jh),lp={},dp={};function up(e,t,n){lp[e]=t,!1!==n&&(dp[t]=e)}function cp(e){try{return e.responseText}catch(e){}return wh}function gp(e,t){var n=!1;if(e&&t){var r=Wl(e);if(r&&r.length>0)for(var i=t.toLowerCase(),o=0;o<r.length;o++){var a=r[o];if(a&&Sl(t,a)&&a.toLowerCase()===i){n=!0;break}}}return n}function hp(e,t,n,r){t&&n&&n.length>0&&(r&&lp[t]?(e.hdrs[lp[t]]=n,e.useHdrs=!0):e.url+="&"+t+"="+n)}function pp(e,t){return t&&(Fl(t)?e=[t].concat(e):Dl(t)&&(e=t.concat(e))),e}up(qh,qh,!1),up(Bh,Bh),up(Oh,"Client-Id"),up(Mh,Mh),up(Rh,Rh),up(Lh,Lh),up(Wh,Wh);var fp=function(){function e(t,n,r,i,o){this._responseHandlers=[];var a,s,l,d,u,c,g,h,p,f,v="?cors=true&"+Fh.toLowerCase()+"="+Dh,m=new $h,y=!1,_=new Qh,b=!1,C=0,S=!0,T=[],I={},w=[],E=null,x=!1,A=!1,D=!1;pu(e,this,(function(e){var k=!0;function F(e,t){for(var n=0,r=null,i=0;null==r&&i<e.length;)1===(n=e[i])?(null===Du&&(Du=typeof XDomainRequest!==Ca)&&Gu()&&(Du=Du&&!Fu(Pu(wu),"withCredentials")),Du?r=P:Gu()&&(r=B)):2===n&&Vu(t)&&(!t||t&&!h)?r=N:b&&3===n&&Hu()&&(r=R),i++;return r?{_transport:n,_isSync:t,sendPOST:r}:null}function P(e,t,n){var r=new XDomainRequest;r.open(Eh,e.urlString),e.timeout&&(r.timeout=e.timeout),r.onload=function(){var e=cp(r);O(t,200,{},e),Q(e)},r.onerror=function(){O(t,400,{})},r.ontimeout=function(){O(t,500,{})},r.onprogress=function(){},n?r.send(e.data):o.set((function(){r.send(e.data)}),0)}function N(e,t,n){var r,i=e.urlString,a=!1,s=!1,l=((r={body:e.data,method:Eh}).Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0,r);n&&(l.keepalive=!0,2===e._sendReason&&(a=!0,f&&(i+=ap))),k&&(l.credentials="include"),e.headers&&Wl(e.headers).length>0&&(l.headers=e.headers),fetch(i,l).then((function(e){var n={},r=wh,i=e.headers;i&&i.forEach((function(e,t){n[t]=e})),e.body&&e.text().then((function(e){r=e})),s||(s=!0,O(t,e.status,n,r),Q(r))})).catch((function(e){s||(s=!0,O(t,0,{}))})),a&&!s&&(s=!0,O(t,200,{})),!s&&e.timeout>0&&o.set((function(){s||(s=!0,O(t,500,{}))}),e.timeout)}function B(e,t,n){var r=e.urlString;function i(e,t,n){if(!e[n]&&t&&t.getResponseHeader){var r=t.getResponseHeader(n);r&&(e[n]=Ll(r))}return e}function o(e,n){O(t,e.status,function(e){var t,n,r={};return e.getAllResponseHeaders?(t=e.getAllResponseHeaders(),n={},kl(t)&&Ol(Ll(t).split(/[\r\n]+/),(function(e){if(e){var t=e.indexOf(": ");if(-1!==t){var r=Ll(e.substring(0,t)).toLowerCase(),i=Ll(e.substring(t+1));n[r]=i}else n[Ll(e)]=1}})),r=n):(r=i(r,e,Nh),r=i(r,e,Ph),r=i(r,e,"kill-duration-seconds")),r}(e),n)}n&&e.disableXhrSync&&(n=!1);var a=function(e,t,n,r,i,o){function a(e,t,n){try{e[t]=n}catch(e){}}void 0===r&&(r=!1),void 0===i&&(i=!1);var s=new XMLHttpRequest;return r&&a(s,"Microsoft_ApplicationInsights_BypassAjaxInstrumentation",r),n&&a(s,ch,n),s.open(e,t,!i),n&&a(s,ch,n),!i&&o&&a(s,"timeout",o),s}(Eh,r,k,!0,n,e.timeout);El(e.headers,(function(e,t){a.setRequestHeader(e,t)})),a.onload=function(){var e=cp(a);o(a,e),Q(e)},a.onerror=function(){o(a)},a.ontimeout=function(){o(a)},a.send(e.data)}function O(e,t,n,r){try{e(t,n,r)}catch(e){ic(s,2,518,ju(e))}}function R(e,t,n){var r=200,i=e._thePayload,o=e.urlString+(f?ap:wh);try{var a=Lu();if(!a.sendBeacon(o,e.data))if(i){var l=[];Ol(i.batches,(function(e){if(l&&e&&e.count()>0){for(var t=e.events(),n=0;n<t.length;n++)if(!a.sendBeacon(o,E.getEventBlob(t[n]))){l.push(e.split(n));break}}else l.push(e.split(0))})),K(l,8003,i.sendType,!0)}else r=0}catch(e){oc(s,"Failed to send telemetry using sendBeacon API. Ex:"+ju(e)),r=0}finally{O(t,r,{},wh)}}function L(e){return 2===e||3===e}function M(e){return A&&L(e)&&(e=2),e}function q(){return!y&&C<n}function W(){var e=w;return w=[],e}function U(e,t,n){var r=!1;return e&&e.length>0&&!y&&l[t]&&E&&(r=0!==t||q()&&(n>0||_.allowRequestSending())),r}function z(e){var t={};return e&&Ol(e,(function(e,n){t[n]={iKey:e.iKey(),evts:e.events()}})),t}function j(e,n,r,i,o){if(e&&0!==e.length)if(y)K(e,1,i);else{i=M(i);try{var a=e,u=0!==i;Dg(d,(function(){return"HttpManager:_sendBatches"}),(function(a){a&&(e=e.slice(0));for(var s=[],d=null,c=vh(),g=l[i]||(u?l[1]:l[0]),h=g&&g._transport,f=p&&(A||L(i)||3===h||g._isSync&&2===h);U(e,i,n);){var v=e.shift();v&&v.count()>0&&(m.isTenantKilled(v.iKey())?s.push(v):(d=d||E.createPayload(n,r,u,f,o,i),E.appendPayload(d,v,t)?null!==d.overflow&&(e=[d.overflow].concat(e),d.overflow=null,V(d,c,vh(),o),c=vh(),d=null):(V(d,c,vh(),o),c=vh(),e=[v].concat(e),d=null)))}d&&V(d,c,vh(),o),e.length>0&&(w=e.concat(w)),K(s,8004,i)}),(function(){return{batches:z(a),retryCount:n,isTeardown:r,isSynchronous:u,sendReason:o,useSendBeacon:L(i),sendType:i}}),!u)}catch(e){ic(s,2,48,"Unexpected Exception sending batch: "+ju(e))}}}function H(e,t,n){e[t]=e[t]||{},e[t][a.identifier]=n}function V(t,n,i,o){if(t&&t.payloadBlob&&t.payloadBlob.length>0){var u=!!e.sendHook,p=l[t.sendType];!L(t.sendType)&&t.isBeacon&&2===t.sendReason&&(p=l[2]||l[3]||p);var f=D;(t.isBeacon||3===p._transport)&&(f=!1);var y=function(e,t){var n={url:v,hdrs:{},useHdrs:!1};t?(n.hdrs=fh(n.hdrs,I),n.useHdrs=Wl(n.hdrs).length>0):El(I,(function(e,t){dp[e]?hp(n,dp[e],t,!1):(n.hdrs[e]=t,n.useHdrs=!0)})),hp(n,Oh,"NO_AUTH",t),hp(n,Bh,uh,t);var r=wh;Ol(e.apiKeys,(function(e){r.length>0&&(r+=","),r+=e})),hp(n,Mh,r,t),hp(n,Lh,jl().toString(),t);var i=function(e){for(var t=0;t<e.batches.length;t++){var n=e.batches[t].Msfpc();if(n)return encodeURIComponent(n)}return wh}(e);if(hh(i)&&(n.url+="&ext.intweb.msfpc="+i),_.shouldAddClockSkewHeaders()&&hp(n,Rh,_.getClockSkewHeaderValue(),t),d.getWParam){var o=d.getWParam();o>=0&&(n.url+="&w="+o)}for(var a=0;a<T.length;a++)n.url+="&"+T[a].name+"="+T[a].value;return n}(t,f);f=f||y.useHdrs;var b=vh();Dg(d,(function(){return"HttpManager:_doPayloadSend"}),(function(){for(var l=0;l<t.batches.length;l++)for(var v=t.batches[l].events(),T=0;T<v.length;T++){var I=v[T];if(x){var w=I.timings=I.timings||{};H(w,"sendEventStart",b),H(w,"serializationStart",n),H(w,"serializationCompleted",i)}I[op]>0?I[op]++:I[op]=1}K(t.batches,1e3+(o||0),t.sendType,!0);var E={data:t.payloadBlob,urlString:y.url,headers:y.hdrs,_thePayload:t,_sendReason:o,timeout:c,disableXhrSync:g,disableFetchKeepAlive:h};f&&(gp(E.headers,kh)||(E.headers[kh]="no-cache, no-store"),gp(E.headers,Fh)||(E.headers[Fh]=Dh));var D=null;p&&(D=function(n){_.firstRequestSent();var i=function(n,i){!function(t,n,i,o){var s,l=9e3,d=null,u=!1,c=!1;try{var g=!0;if(typeof t!==Ca){if(n){_.setClockSkew(n[Nh]);var h=n[Ph]||n["kill-duration-seconds"];Ol(m.setKillSwitchTenants(n["kill-tokens"],h),(function(e){Ol(i.batches,(function(t){if(t.iKey()===e){d=d||[];var n=t.split(0);i.numEvents-=n.count(),d.push(n)}}))}))}if(200==t||204==t)return void(l=200);((s=t)>=300&&s<500&&408!=s&&429!=s||501==s||505==s||i.numEvents<=0)&&(g=!1),l=9e3+t%1e3}if(g){l=100;var p=i.retryCnt;0===i.sendType&&(p<r?(u=!0,G((function(){0===i.sendType&&C--,j(i.batches,p+1,i.isTeardown,A?2:i.sendType,5)}),A,Zh(p))):(c=!0,A&&(l=8001)))}}finally{u||(_.setClockSkew(),function(t,n,r,i){try{i&&a._backOffTransmission(),200===n&&(i||t.isSync||a._clearBackOff(),function(e){if(x){var t=vh();Ol(e,(function(e){e&&e.count()>0&&function(e,t){x&&Ol(e,(function(e){H(e.timings=e.timings||{},"sendEventCompleted",t)}))}(e.events(),t)}))}}(t.batches)),K(t.batches,n,t.sendType,!0)}finally{0===t.sendType&&(C--,5!==r&&e.sendQueuedRequests(t.sendType,r))}}(i,l,o,c)),K(d,8004,i.sendType)}}(n,i,t,o)},l=t.isTeardown||t.isSync;try{p.sendPOST(n,i,l),e.sendListener&&e.sendListener(E,n,l,t.isBeacon)}catch(e){oc(s,"Unexpected exception sending payload. Ex:"+ju(e)),O(i,0,{})}}),Dg(d,(function(){return"HttpManager:_doPayloadSend.sender"}),(function(){if(D)if(0===t.sendType&&C++,u&&!t.isBeacon&&3!==p._transport){var n={data:E.data,urlString:E.urlString,headers:fh({},E.headers),timeout:E.timeout,disableXhrSync:E.disableXhrSync,disableFetchKeepAlive:E.disableFetchKeepAlive},r=!1;Dg(d,(function(){return"HttpManager:_doPayloadSend.sendHook"}),(function(){try{e.sendHook(n,(function(e){r=!0,S||e._thePayload||(e._thePayload=e._thePayload||E._thePayload,e._sendReason=e._sendReason||E._sendReason),D(e)}),t.isSync||t.isTeardown)}catch(e){r||D(E)}}))}else D(E)}))}),(function(){return{thePayload:t,serializationStart:n,serializationCompleted:i,sendReason:o}}),t.isSync)}t.sizeExceed&&t.sizeExceed.length>0&&K(t.sizeExceed,8003,t.sendType),t.failedEvts&&t.failedEvts.length>0&&K(t.failedEvts,8002,t.sendType)}function G(e,t,n){t?e():o.set(e,n)}function Q(t){var n=e._responseHandlers;try{for(var r=0;r<n.length;r++)try{n[r](t)}catch(e){ic(s,1,519,"Response handler failed: "+e)}if(t){var i=JSON.parse(t);hh(i.webResult)&&hh(i.webResult[Uh])&&u.set("MSFPC",i.webResult[Uh],31536e3)}}catch(e){}}function K(e,t,n,r){if(e&&e.length>0&&i){var o=i[(l=t,u=sp[l],hh(u)||(u="oth",l>=9e3&&l<=9999?u="rspFail":l>=8e3&&l<=8999?u=xh:l>=1e3&&l<=1999&&(u="send")),u)];if(o){var a=0!==n;Dg(d,(function(){return"HttpManager:_sendBatchesNotification"}),(function(){G((function(){try{o.call(i,e,t,a,n)}catch(e){ic(s,1,74,"send request notification failed: "+e)}}),r||a,0)}),(function(){return{batches:z(e),reason:t,isSync:a,sendSync:r,sendType:n}}),!a)}}var l,u}e.initialize=function(e,t,n,r,i){var o;i||(i={}),v=e+v,D=!!_l(i.avoidOptions)||!i.avoidOptions,d=t,u=t.getCookieMgr(),x=!d.config.disableEventTimings;var m=!!d.config.enableCompoundKey;s=(a=n).diagLog();var y=i.valueSanitizer,_=i.stringifyObjects;_l(i.enableCompoundKey)||(m=!!i.enableCompoundKey),c=i.xhrTimeout,g=!!i.disableXhrSync,h=!!i.disableFetchKeepAlive,f=!1!==i.addNoResponse,b=!Uu(),E=new rp(d,y,_,m),bl(i.useSendBeacon)||(b=!!i.useSendBeacon);var C=r,T=i.alwaysUseXhrOverride?r:null,I=i.alwaysUseXhrOverride?r:null,w=[3,2];if(!r){S=!1;var A=Mu();A&&A.protocol&&"file:"===A.protocol.toLowerCase()&&(k=!1);var P=[];Uu()?(P=[2,1],w=[2,1,3]):P=[1,2,3],(r=F(P=pp(P,i.transports),!1))||oc(s,"No available transport to send events"),C=F(P,!0)}T||(T=F(w=pp(w,i.unloadTransports),!0)),p=!S&&(b&&Hu()||!h&&Vu(!0)),(o={})[0]=r,o[1]=C||F([1,2,3],!0),o[2]=T||C||F([1],!0),o[3]=I||F([2,3],!0)||C||F([1],!0),l=o},e._getDbgPlgTargets=function(){return[l[0],m,E,l]},e.addQueryStringParameter=function(e,t){for(var n=0;n<T.length;n++)if(T[n].name===e)return void(T[n].value=t);T.push({name:e,value:t})},e.addHeader=function(e,t){I[e]=t},e.canSendRequest=function(){return q()&&_.allowRequestSending()},e.sendQueuedRequests=function(e,t){_l(e)&&(e=0),A&&(e=M(e),t=2),U(w,e,0)&&j(W(),0,!1,e,t||0)},e.isCompletelyIdle=function(){return!y&&0===C&&0===w.length},e.setUnloading=function(e){A=e},e.addBatch=function(e){if(e&&e.count()>0){if(m.isTenantKilled(e.iKey()))return!1;w.push(e)}return!0},e.teardown=function(){w.length>0&&j(W(),0,!0,2,2)},e.pause=function(){y=!0},e.resume=function(){y=!1,e.sendQueuedRequests(0,4)},e.sendSynchronousBatch=function(e,t,n){e&&e.count()>0&&(bl(t)&&(t=1),A&&(t=M(t),n=2),j([e],0,!1,t,n||0))}}))}return e.__ieDyn=1,e}();function vp(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout(e,t,n)}function mp(e){clearTimeout(e)}function yp(e,t){return{set:e||vp,clear:t||mp}}var _p="eventsDiscarded",bp="overrideInstrumentationKey",Cp="maxEventRetryAttempts",Sp="maxUnloadEventRetryAttempts";const Tp=function(e){function t(){var n,r=e.call(this)||this;r.identifier="PostChannel",r.priority=1011,r.version="3.2.18";var i,o,a,s,l,d,u,c=!1,g=[],h=null,p=!1,f=0,v=500,m=0,y=1e4,_={},b=Ih,C=null,S=null,T=0,I=0,w={},E=-1,x=!0,A=!1,D=6,k=2;return pu(t,r,(function(e,t){function r(e){"beforeunload"!==(e||Bu().event).type&&(A=!0,o.setUnloading(A)),q(2,2)}function F(e){A=!1,o.setUnloading(A)}function P(e,t){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=1),e.ext&&e.ext[zh]&&delete e.ext[zh],e.ext&&e.ext[jh]&&e.ext[jh].id&&delete e.ext[jh].id,x&&(e.ext=Jl(e.ext),e.baseData&&(e.baseData=Jl(e.baseData)),e.data&&(e.data=Jl(e.data))),e.sync)if(T||p)e.latency=3,e.sync=!1;else if(o)return x&&(e=Jl(e)),void o.sendSynchronousBatch(Gh.create(e.iKey,[e]),!0===e.sync?1:e.sync,3);var n=e.latency,r=m,i=y;4===n&&(r=f,i=v);var a=!1;if(r<i)a=!z(e,t);else{var s=1,l=20;4===n&&(s=4,l=1),a=!0,function(e,t,n,r){for(;n<=t;){var i=W(e,t,!0);if(i&&i.count()>0){var o=i.split(0,r),a=o.count();if(a>0)return 4===n?f-=a:m-=a,J(_p,[o],Th.QueueFull),!0}n++}return j(),!1}(e.iKey,e.latency,s,l)&&(a=!z(e,t))}a&&Z(_p,[e],Th.QueueFull)}function N(e,t,n){var r=H(e,t,n);return o.sendQueuedRequests(t,n),r}function B(){return m>0}function O(){if(E>=0&&H(E,0,l)&&o.sendQueuedRequests(0,l),f>0&&!S&&!p){var e=_[b][2];e>=0&&(S=L((function(){S=null,N(4,0,1),O()}),e))}var t=_[b][1];!C&&!h&&t>=0&&!p&&(B()?C=L((function(){C=null,N(0===I?3:1,0,1),I++,I%=2,O()}),t):I=0)}function R(){n=null,c=!1,g=[],h=null,p=!1,f=0,v=500,m=0,y=1e4,_={},b=Ih,C=null,S=null,T=0,I=0,i=null,w={},a=void 0,s=0,E=-1,l=null,x=!0,A=!1,D=6,k=2,d=null,u=yp(),o=new fp(500,2,1,{requeue:K,send:X,sent:Y,drop:ee,rspFail:te,oth:ne},u),Q(),w[4]={batches:[],iKeyMap:{}},w[3]={batches:[],iKeyMap:{}},w[2]={batches:[],iKeyMap:{}},w[1]={batches:[],iKeyMap:{}},re()}function L(e,t){0===t&&T&&(t=1);var n=1e3;return T&&(n=Zh(T-1)),u.set(e,t*n)}function M(){return null!==C&&(u.clear(C),C=null,I=0,!0)}function q(e,t){M(),h&&(u.clear(h),h=null),p||N(1,e,t)}function W(e,t,n){var r=w[t];r||(r=w[t=1]);var i=r.iKeyMap[e];return!i&&n&&(i=Gh.create(e),r.batches.push(i),r.iKeyMap[e]=i),i}function U(t,n){o.canSendRequest()&&!T&&(a>0&&m>a&&(n=!0),n&&null==h&&e.flush(t,null,20))}function z(e,t){x&&(e=Jl(e));var n=e.latency,r=W(e.iKey,n,!0);return!!r.addEvent(e)&&(4!==n?(m++,t&&0===e.sendAttempt&&U(!e.sync,s>0&&r.count()>=s)):f++,!0)}function j(){for(var e=0,t=0,n=function(n){var r=w[n];r&&r.batches&&Ol(r.batches,(function(r){4===n?e+=r.count():t+=r.count()}))},r=1;r<=4;r++)n(r);m=t,f=e}function H(t,n,r){var i=!1,a=0===n;return!a||o.canSendRequest()?Dg(e.core,(function(){return"PostChannel._queueBatches"}),(function(){for(var e=[],n=4;n>=t;){var r=w[n];r&&r.batches&&r.batches.length>0&&(Ol(r.batches,(function(t){o.addBatch(t)?i=i||t&&t.count()>0:e=e.concat(t.events()),4===n?f-=t.count():m-=t.count()})),r.batches=[],r.iKeyMap={}),n--}e.length>0&&Z(_p,e,Th.KillSwitch),i&&E>=t&&(E=-1,l=0)}),(function(){return{latency:t,sendType:n,sendReason:r}}),!a):(E=E>=0?Math.min(E,t):t,l=Math.max(l,r)),i}function V(e,t){N(1,0,t),j(),G((function(){e&&e(),g.length>0?h=L((function(){h=null,V(g.shift(),t)}),0):(h=null,O())}))}function G(e){o.isCompletelyIdle()?e():h=L((function(){h=null,G(e)}),.25)}function Q(){(_={})[Ih]=[2,1,0],_.NEAR_REAL_TIME=[6,3,0],_.BEST_EFFORT=[18,9,0]}function K(t,n){var r=[],i=D;A&&(i=k),Ol(t,(function(t){t&&t.count()>0&&Ol(t.events(),(function(t){t&&(t.sync&&(t.latency=4,t.sync=!1),t.sendAttempt<i?(mh(t,e.identifier),P(t,!1)):r.push(t))}))})),r.length>0&&Z(_p,r,Th.NonRetryableStatus),A&&q(2,2)}function $(t,n){var r=e._notificationManager||{},i=r[t];if(i)try{i.apply(r,n)}catch(n){ic(e.diagLog(),1,74,t+" notification failed: "+n)}}function Z(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];t&&t.length>0&&$(e,[t].concat(n))}function J(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];t&&t.length>0&&Ol(t,(function(t){t&&t.count()>0&&$(e,[t.events()].concat(n))}))}function X(e,t,n){e&&e.length>0&&$("eventsSendRequest",[t>=1e3&&t<=1999?t-1e3:0,!0!==n])}function Y(e,t){J("eventsSent",e,t),O()}function ee(e,t){J(_p,e,t>=8e3&&t<=8999?t-8e3:Th.Unknown)}function te(e){J(_p,e,Th.NonRetryableStatus),O()}function ne(e,t){J(_p,e,Th.Unknown),O()}function re(){s=n&&n.disableAutoBatchFlushLimit?0:Math.max(1500,y/6)}R(),e._getDbgPlgTargets=function(){return[o]},e.initialize=function(s,l,c){Dg(l,(function(){return"PostChannel:initialize"}),(function(){var g=l;t.initialize(s,l,c);try{l.addUnloadCb,d=gg(Uc(e.identifier),l.evtNamespace&&l.evtNamespace());var h=e._getTelCtx();s.extensionConfig[e.identifier]=s.extensionConfig[e.identifier]||{},n=h.getExtCfg(e.identifier),u=yp(n.setTimeoutOverride,n.clearTimeoutOverride),x=!n.disableOptimizeObj&&!!Pu("chrome"),function(e){var t=e.getWParam;e.getWParam=function(){var e=0;return n.ignoreMc1Ms0CookieProcessing&&(e|=2),e|t()}}(g),n.eventsLimitInMem>0&&(y=n.eventsLimitInMem),n.immediateEventLimit>0&&(v=n.immediateEventLimit),n.autoFlushEventsLimit>0&&(a=n.autoFlushEventsLimit),Fl(n[Cp])&&(D=n[Cp]),Fl(n[Sp])&&(k=n[Sp]),re(),n.httpXHROverride&&n.httpXHROverride.sendPOST&&(i=n.httpXHROverride),hh(s.anonCookieName)&&o.addQueryStringParameter("anoncknm",s.anonCookieName),o.sendHook=n.payloadPreprocessor,o.sendListener=n.payloadListener;var p=n.overrideEndpointUrl?n.overrideEndpointUrl:s.endpointUrl;e._notificationManager=l.getNotifyMgr(),o.initialize(p,e.core,e,i,n);var f=s.disablePageUnloadEvents||[];(function(e,t,n,r){var i=!1;t&&e&&Dl(e)&&!(i=fg(e,t,n,r))&&n&&n[ja]>0&&(i=fg(e,t,null,r))})([Yc,Xc,Zc],r,f,d),mg(r,f,d),yg(F,s.disablePageShowEvents,d)}catch(t){throw e.setInitialized(!1),t}}),(function(){return{coreConfig:s,core:l,extensions:c}}))},e.processTelemetry=function(t,r){mh(t,e.identifier);var i=(r=e._getTelCtx(r)).getExtCfg(e.identifier),o=!!n.disableTelemetry;i&&(o=o||!!i.disableTelemetry);var a=t;o||c||(n[bp]&&(a.iKey=n[bp]),i&&i[bp]&&(a.iKey=i[bp]),P(a,!0),A?q(2,2):O()),e.processNext(a,r)},e._doTeardown=function(e,t){var n;q(2,2),c=!0,o.teardown(),vg([Yc,Xc,Zc],null,d),n=gg(eg,d),vg([Zc],null,n),vg([$c],null,n),function(e,t){var n=gg(tg,t);vg([Jc],null,n),vg([$c],null,n)}(0,d),R()},e.setEventQueueLimits=function(e,t){y=e>0?e:1e4,a=t>0?t:0,re();var n=m>e;if(!n&&s>0)for(var r=1;!n&&r<=3;r++){var i=w[r];i&&i.batches&&Ol(i.batches,(function(e){e&&e.count()>=s&&(n=!0)}))}U(!0,n)},e.pause=function(){M(),p=!0,o.pause()},e.resume=function(){p=!1,o.resume(),O()},e.addResponseHandler=function(e){o._responseHandlers.push(e)},e._loadTransmitProfiles=function(e){M(),Q(),b=Ih,O(),El(e,(function(e,t){var n=t.length;if(n>=2){var r=n>2?t[2]:0;if(t.splice(0,n-2),t[1]<0&&(t[0]=-1),t[1]>0&&t[0]>0){var i=t[0]/t[1];t[0]=Math.ceil(i)*t[1]}r>=0&&t[1]>=0&&r>t[1]&&(r=t[1]),t.push(r),_[e]=t}}))},e.flush=function(e,t,n){if(void 0===e&&(e=!0),!p)if(n=n||1,e)null==h?(M(),H(1,0,n),h=L((function(){h=null,V(t,n)}),0)):g.push(t);else{var r=M();N(1,1,n),null!=t&&t(),r&&O()}},e.setMsaAuthTicket=function(e){o.addHeader(qh,e)},e.hasEvents=B,e._setTransmitProfile=function(e){b!==e&&void 0!==_[e]&&(M(),b=e,O())},e._backOffTransmission=function(){T<4&&(T++,M(),O())},e._clearBackOff=function(){T&&(T=0,M(),O())},Ul(e,"_setTimeoutOverride",(function(){return u.set}),(function(e){u=yp(e,u.clear)})),Ul(e,"_clearTimeoutOverride",(function(){return u.clear}),(function(e){u=yp(u.set,e)}))})),r}return Cg(t,e),t.__ieDyn=1,t}(Kg);var Ip,wp,Ep="HttpManager:_sendBatches",xp="PrivacyGuard:_processTelemetry",Ap=function(){function e(e,t,n){this.start=Date.now(),this.name=e,this.isAsync=!0===n,this.payload=t}return e.prototype.isChildEvt=function(){return!1},e.prototype.complete=function(){this.time=Date.now()-this.start,this.exTime=this.time},e}(),Dp=function(){function e(e){this._callbacks=e}return e.prototype.create=function(e,t,n){return e===Ep||e===xp?new Ap(e,t,n):null},e.prototype.fire=function(e){if(e&&e.complete(),this._callbacks)switch(e.name){case Ep:this.handleSendBatches(e);break;case xp:this.handlePrivacyGuardNotification(e)}},e.prototype.setCtx=function(e,t){},e.prototype.getCtx=function(e){},e.prototype.handleSendBatches=function(e){if(this._callbacks.requestProcessingStats){var t=0;if(e.payload){var n=e.payload();if(n.batches)for(var r in n.batches)t+=n.batches[r].evts.length}this._callbacks.requestProcessingStats(e.time||0,t)}},e.prototype.handlePrivacyGuardNotification=function(e){this._callbacks.privacyGuardStats&&e.time&&e.time>0&&this._callbacks.privacyGuardStats(e.time)},e}(),kp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.initialize=function(t,n){this._postChannel=new Tp;var r=null!=n?n:[];t.channels=[[this._postChannel]],t.extensionConfig=t.extensionConfig||[],t.extensionConfig[this._postChannel.identifier]=(0,i.__assign)((0,i.__assign)({},t.channelConfiguration),t.extensionConfig[this._postChannel.identifier]);try{e.prototype.initialize.call(this,t,r)}catch(e){this.logger.warnToConsole("Failed to initialize SDK."+e)}},t.prototype.setUploadFrequency=function(e){if(this._postChannel&&e){var t=e/1e3,n=t/2,r={};r.OTelCustomTransmissionProfile=[t,n],this._postChannel._loadTransmitProfiles(r),this._postChannel._setTransmitProfile("OTelCustomTransmissionProfile")}},t.prototype.flush=function(e){this._postChannel&&this._postChannel.flush(e)},t.prototype.shutdown=function(){this._postChannel&&this._postChannel.teardown()},t}(bh),Fp=function(e){function t(t,n){var r,o=e.call(this,t,n)||this;o.sendTelemetryEvent=function(e){return function(t,n){try{return void((i=o.getOneDSTelemetryEvent(e))&&r&&r.track(i))}catch(e){return void ya(1,"1DS Sink",e)}var i}()},o.sendCustomerContent=function(e){},o.sendNonStandardEvent=function(e,t){var n=!1;l.forEach((function(r){r.canHandle(t)&&(r.processEvent(e),n=!0)})),n||ma(0,1,(function(){return"Missing Handler for "+t+"to process"+e.eventName}))},o.flush=function(e){null==r||r.flush(e),l.forEach((function(t){t.flush(e)}))},o.shutdown=function(){try{null==r||r.shutdown(),l.forEach((function(e){e.shutdown()}))}catch(e){ma(0,2,(function(){return"An error occurred on shutdown"}))}};var a,s,l=n.nonStandardEventHandlers||[];if(r=function(e,t){var n=e.httpXHROverride,r={instrumentationKey:"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405",endpointUrl:e.endpointUrl,channelConfiguration:{eventsLimitInMem:e.eventsLimitInMem,httpXHROverride:n,setTimeoutOverride:e.setTimeoutOverride,clearTimeoutOverride:e.clearTimeoutOverride,ignoreMc1Ms0CookieProcessing:!0,disableOptimizeObj:!0},enableWParam:!n,disableCookiesUsage:!0,extensionConfig:(0,i.__assign)({},e.extensionConfig)};e.stats&&e.stats.networkStats&&r.channelConfiguration&&(r.channelConfiguration.payloadListener=function(t,n){var r,i=n||t;i.data&&(null===(r=e.stats)||void 0===r||r.networkStats(i.data.length))});var o=new kp;return o.initialize(r,e.plugins),o.setUploadFrequency(e.uploadFrequency),e.notificationListener&&o.addNotificationListener(e.notificationListener),e.stats&&o.setPerfMgr(new Dp(e.stats)),o}(n),l.forEach((function(e){e.initialize(o,n)})),!n.endpointUrl)throw new Error("Missing Endpoint Url");return n.disableStatsTracking||(a=o,(s=r)&&s.addNotificationListener({eventsSent:function(e){ma(2,2,(function(){return"Successfully sent ".concat(e.length," event(s)")})),ma(3,2,(function(){return"Sent event(s) details : ".concat(JSON.stringify(e,null,2))})),a.eventsSent+=e.length},eventsDiscarded:function(e,t){ma(0,2,(function(){return"Discarded ".concat(e.length," event(s) because ").concat(t)})),ma(3,2,(function(){return"Discarded event(s) details : ".concat(JSON.stringify(e,null,2))})),a.eventsDiscarded+=e.length}})),o}return(0,i.__extends)(t,e),t}((function(e,t){var n=this;this.eventsProcessed=0,this.eventsSent=0,this.eventsDiscarded=0;var r=[],i=!1,o=!0,a={name:"DiagnosticLevel",processEvent:function(e){var t=e.eventFlags.diagnosticLevel;return i||10===t||110===t||120===t}},s={},l=_g();this.init=function(e){return Sd(s,!1)},this.begin=function(){return o=o&&Sd(s,!0)},this.getOneDSTelemetryEvent=function(e){return d(e,{eventType:1})},this.getOneDSCustomerContent=function(e){var t=e.telemetryProperties.customerContentVersion;if(t&&Math.floor(t)<=2&&1===e.telemetryProperties.customerContentType)return d(e,{eventType:2})};var d=function(e,t){if(o){var i=Pd(e);if(function(e,t){for(var n=function(n){var r=t[n];if(!r.processEvent(e))return ma(2,1,(function(){return"".concat(e.eventName," suppressed by ").concat(r.name)})),{value:!1}},r=0;r<t.length;r++){var i=n(r);if("object"==typeof i)return i.value}return!0}(i,r)){var a=(h=i,h.timestamp?new Date(h.timestamp):new Date).toISOString(),d={"Event.Name":i.eventName,"Event.Source":"OTelJS","Event.Time":{value:a,propertyType:9}};for(var u in n.eventsProcessed++,d["Event.Sequence"]={value:n.eventsProcessed,propertyType:4},d["Event.Id"]=l+"."+n.eventsProcessed,s)d[u]=s[u];if(!pd(d,i.dataFields,!0,t.eventType))return void ma(0,1,(function(){return"Dropping Event: "+i.eventName}));var c="custom";i.eventContract&&(i.eventContract.name&&(d["Event.Contract"]=i.eventContract.name,c+="."+i.eventContract.name.toLowerCase().replace(/\./g,"_")),pd(d,i.eventContract.dataFields,!1,t.eventType));var g=function(e,t){return 2===t?"b22a201c3f1d41d28ccc399ba6cc9ca2-1972c77f-1f79-4283-a0f9-b4ddc4646f55-7121":e.telemetryProperties&&(1!==t||e.telemetryProperties.ariaTenantToken)?1===t?e.telemetryProperties.ariaTenantToken:void 0:void ma(0,1,(function(){return"Missing Aria Token"}))}(i,t.eventType);if(!g)return;return{iKey:g,name:i.eventName,data:d,time:a,baseType:c,ext:{sdk:{seq:n.eventsProcessed}}}}}var h};this.addPreprocessor=function(e){r.push(e)},this.getOneDSPersistentDataFields=function(){return s},this.getPreprocessors=function(){return r};var u=function(e){pd(s,e,!1,1)};this.addPersistentDataFields=u,this.setOptionalEventsEnabled=function(e){i=e},this.setFullEventsEnabled=this.setOptionalEventsEnabled,t.enableOptionalEvents&&(i=!0),u(e);var c,g=t.coreFields;if(g){u(function(e){var t="App",n=[];return nd(n,t,"Name",e.name,1),nd(n,t,"Platform",e.platform,1),nd(n,t,"Version",e.version,1),n}(g.app)),u(function(e){var t="User",n=[];return nd(n,t,"PrimaryIdentityHash",e.primaryIdentityHash),nd(n,t,"PrimaryIdentitySpace",e.primaryIdentitySpace),nd(n,t,"TenantId",e.tenantId,1),nd(n,t,"TenantGroup",e.tenantGroup,1),rd(n,t,"IsAnonymous",e.isAnonymous),rd(n,t,"IsSignedIn",e.isSignedIn),n}(g.user)),u(function(e){var t="Session",n=[];return nd(n,t,"Id",e.id,1),nd(n,t,"EcsETag",e.ecsETag,1),n}(g.session));var h=g.release;h&&u((nd(c=[],"Release","AudienceGroup",h.audienceGroup,1),c))}this.addPreprocessor(a)}));(wp=Ip||(Ip={})).USGOV_DOD="https://pf.events.data.microsoft.com/OneCollector/1.0/",wp.USGOV_DOJ="https://tb.events.data.microsoft.com/OneCollector/1.0/",wp.PUBLIC="https://browser.events.data.microsoft.com/OneCollector/1.0/",wp.CUSTOMER_CONTENT="",wp.EUDB="https://eu-office.events.data.microsoft.com/OneCollector/1.0/";var Pp=n(109);class Np{constructor(){this.imports=[]}get uniqueId(){return(0,Je.z)(507918277)}configureRootServices(e){e.getOptional(we.qy)||e.bind(we.qy).toDynamicValue((e=>{var t;const n=e.get(Ie.n),{sessionId:r=e.get(Vr.G).generate(),appPlatform:i="DefaultAppPlatform",appName:o="DefaultAppName",appScenario:a="",releaseAudienceGroup:s="",clientVersion:l=""}=null!==(t=n.hostMetadata)&&void 0!==t?t:{},d=[(0,Pp.m9)("Session.Id",r),(0,Pp.m9)("App.Platform",i),(0,Pp.m9)("App.Name",o),(0,Pp.m9)("App.Scenario",a),(0,Pp.m9)("Release.AudienceGroup",s),(0,Pp.m9)("App.Version",l)],u=new Fp(d,{endpointUrl:Ip.PUBLIC});return u.setFullEventsEnabled(!1),u}))}}var Bp=n(74581),Op=n(20311),Rp=n(37890),Lp=n(69284);class Mp{constructor(){this.imports=[Op.B,_o.J]}get uniqueId(){return(0,Je.z)(507918296)}configureRootServices(e){e.bind(Rp.Tc).to(Lp.l),e.bind(Ue.S).toExisting(Rp.Tc)}}var qp=n(98976),Wp=n(43820);class Up{constructor(){this.imports=[Op.B,_o.J]}get uniqueId(){return(0,Je.z)(507918305)}configureRootServices(e){e.bind(Rp.Tc).to(qp.O),e.bind(Ue.S).toExisting(Rp.Tc),e.bind(mi.i).toValue(Wp.q)}}var zp=n(67760),jp=n(68008),Hp=n.n(jp);let Vp=class{constructor(){this.getIndex=e=>e.index>=0?e.index:e,this.getNewValue=(e,t)=>e.index>=0?(e.index=t,e):t,this._dmp=new(Hp()),this._dmp.Diff_Timeout=0}getReadjustedIndices(e,t,n,r){var i;const o=[],a=null!==(i=e.textContent)&&void 0!==i?i:"",s=r?this._dmp.diff_main(n,a):this._dmp.diff_main(a,n);if(1===s.length&&0===s[0][0])return t;let l=0,d=0,u=0,c=0,g=0,h=0;for(const e of s){const n=e[0],r=e[1].length;switch(n){case 0:g=r,h=r;break;case 1:g=0,h=r;break;case-1:u+=r;continue}d+=u,u=0;for(let e=l;e<t.length;e+=1){const r=this.getIndex(t[e]);if(r<c)throw new Error("Indices are not sorted!");if(!(r>=c&&r<c+h))break;o[e]=0===n?this.getNewValue(t[e],r+d-c):this.getNewValue(t[e],d),l+=1}if(l===t.length)break;d+=g,c+=h}for(let e=l;e<t.length;e+=1)o[e]=this.getNewValue(t[e],d);return o}};Vp=(0,i.__decorate)([(0,Le._)()],Vp);class Gp{constructor(){this.imports=[]}get uniqueId(){return(0,Je.z)(507918221)}configureRootServices(e){e.bind(tn).to(Vp)}}async function Qp(e,t,r,i=new Date){try{await(0,Pe.iJ)();const{modules:o,uxModules:a,telemetrySinkOrModule:s}=await async function(e,t,r){const i=[],o=[];return i.push(ln),i.push(gi),i.push(yo),i.push(ki),i.push(Co),i.push(vi),i.push(Bp.I),i.push(zp.p),i.push((await n.e(1804).then(n.bind(n,80358))).InlineSuggestionsWebUXModule),r||i.push((await n.e(1804).then(n.bind(n,72673))).CreateAugloopSessionModule),e.serviceSettings?.hybridAugloop?.enabled&&e.serviceSettings.hybridAugloop.enableGraphSearchLocal&&i.push((await n.e(1804).then(n.bind(n,11609))).HybridModule),e.serviceSettings?.predictions?.enabled&&(void 0===e.serviceSettings.predictions.domInsertion||e.serviceSettings.predictions.domInsertion?i.push(Mp):i.push(Up)),e.serviceSettings?.flagAnnotationSettings?.enabled&&(i.push(ca),o.push((async()=>(await n.e(1804).then(n.bind(n,91362))).UXModules)),o.push((async()=>(await Promise.all([n.e(1804),n.e(9108)]).then(n.bind(n,53151))).CategoryLocalizationSlimModule))),e.serviceSettings?.nudge?.enabled&&(i.push(ga.Q),o.push((async()=>(await n.e(1804).then(n.bind(n,66957))).NudgeUXModule))),e.isAggregatedLoggingEnabled&&i.push(et),window.Worker?i.push(pa):i.push(Gp),{modules:i,uxModules:o,telemetrySinkOrModule:t??new Np}}(e,t,r);return new Kp(e,o,a,r,s,void 0,i)}catch(e){throw(0,Ne.C)().logEvent(0,"Diagnostics",Be.h.Host,Oe.q.Error,{Text_Message:`Failed to initialize Editor Client: ${e}`}),new Error(`Failed to initialize Editor Client: ${e}`)}}class Kp extends Fe{constructor(e,t,n,r=void 0,i,o,a=new Date){super(e,t,n,r,i,o,a)}readLocales(){throw new Error("Method not implemented.")}writeLocales(e){throw new Error("Method not implemented.")}spellCheck(e,t,n){return this.attach(e,n)}attach(e,t){const n=this.diContainer.get(d).createGraphNode({element:e,initialContentChangeType:t});return n&&this.proofingDom.addNode(n),n}detach(e){this.proofingDom.removeNode(e)}async setLocale(e){const t="string"==typeof e?[e]:e;return await super.setLocale(t)}clearPreloadedSuggestions(){this.diContainer.get(c.W).clearPreloadedSuggestions()}async clearPersistentData(){await this.diContainer.get(u.B).removePersistentKeys(),await this.diContainer.get(ve.$).removePersistentKeys()}}var $p,Zp;!function(e){e.Int="nleditor.osi.office-int.net",e.Staging="nleditor.osi.officeppe.net",e.Lab="wus-001.nleditor.osi.officeppe.net",e.Prod="nleditor.osi.office.net",e.GCC="nleditor.gcc.osi.office365.us",e.GCCHigh="nleditor.osi.office365.us",e.USDoD="nleditor.osi.apps.mil",e.USNat="nleditor.osi.eaglex.ic.gov",e.USSec="nleditor.osi.microsoft.scloud"}($p||($p={})),function(e){e.Int="editor-thesaurus.northeurope.cloudapp.azure.com:9443",e.Staging="editor-edog-thesaurus.trafficmanager.net:9443",e.Lab="editor-edog-thesaurus.trafficmanager.net:9443",e.Prod="editor-prod-thesaurus.trafficmanager.net:9443",e.GCCModerate="editor-gccm-thesaurus.usgovtrafficmanager.net:9443",e.GCCHigh="editor-trailblazer-thesaurus.usgovtrafficmanager.net:9443",e.USDoD="editor-pathfinder-thesaurus.usgovtrafficmanager.net:9443",e.USNat="editor-usnat-thesaurus.trafficmanager.eaglex.ic.gov:9443",e.USSec="editor-ussec-thesaurus.trafficmanager.microsoft.scloud:9443"}(Zp||(Zp={}));var Jp=n(12765),Xp="https://",Yp=Xp+"outlook-1-cdn.azureedge.",ef="midgard/",tf="/agsc-"+ef,nf="versionless/",rf=Xp+"res.cdn.office.net/"+ef;const of={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let af;const sf=new Uint8Array(16),lf=[];for(let e=0;e<256;++e)lf.push((e+256).toString(16).slice(1));const df=function(e,t,n){if(of.randomUUID&&!t&&!e)return of.randomUUID();const r=(e=e||{}).random??e.rng?.()??function(){if(!af){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");af=crypto.getRandomValues.bind(crypto)}return af(sf)}();if(r.length<16)throw new Error("Random bytes length must be >= 16");if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){if((n=n||0)<0||n+16>t.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[n+e]=r[e];return t}return function(e,t=0){return(lf[e[t+0]]+lf[e[t+1]]+lf[e[t+2]]+lf[e[t+3]]+"-"+lf[e[t+4]]+lf[e[t+5]]+"-"+lf[e[t+6]]+lf[e[t+7]]+"-"+lf[e[t+8]]+lf[e[t+9]]+"-"+lf[e[t+10]]+lf[e[t+11]]+lf[e[t+12]]+lf[e[t+13]]+lf[e[t+14]]+lf[e[t+15]]).toLowerCase()}(r)};var uf;!function(e){e.GPT="GPT",e.MessageExtension="MessageExtension",e.PowerPlatform="PowerPlatform",e.OpenAIPlugin="OpenAIPlugin"}(uf||(uf={}));const cf="https://dogfood.augloop.svc.cloud.microsoft",gf=15,hf="@",pf=[{id:"spelling",name:"Spelling"},{id:"grammar",name:"Grammar"}],ff=[{id:"headingDetection",name:"Heading Detection"},{id:"entityDetection",name:"People / Date Recognition"},{id:"taskRecognition",name:"Task Recognition"},{id:"textToTable",name:"Table Suggestions"},{id:"addressDetection",name:"Address Detection"},{id:"satoriEntity",name:"Entity Suggestion"}],vf=[{id:"clarity",name:"Clarity"},{id:"conciseness",name:"Conciseness"},{id:"formality",name:"Formality"},{id:"inclusiveness",name:"Inclusiveness"},{id:"puncConventions",name:"Punctuation Conventions"},{id:"sensitiveGpRef",name:"Sensitive Geopolitical References"},{id:"vocabulary",name:"Vocabulary"}],mf=[uf.MessageExtension,uf.PowerPlatform,uf.OpenAIPlugin];var yf,_f,bf,Cf,Sf,Tf,If,wf,Ef,xf,Af,Df;function kf(e,t,n){return{Type:"Entity",Name:null,ReferenceId:e,EntityType:t,LayoutType:null,Position:n,ResultsView:null}}function Ff(e){switch(null==e?void 0:e.toLowerCase()){case yf.DOGFOOD:case yf.SDFV2:return _f.DOGFOOD;case yf.MSIT:case yf.MICROSOFT:return _f.MICROSOFT;case yf.WW:default:return _f.PRODUCTION}}function Pf(e,t){if(void 0===e)return cf;switch(null==e?void 0:e.toLowerCase()){case yf.DOGFOOD:case yf.SDFV2:return cf;case yf.MSIT:case yf.MICROSOFT:case yf.WW:default:return(null==t?void 0:t.enableLegacyAugLoopEndpoint)?"https://augloop.office.com":"https://augloop.svc.cloud.microsoft"}}!function(e){e.DOGFOOD="dogfood",e.SDFV2="sdfv2",e.MSIT="msit",e.MICROSOFT="microsoft",e.WW="ww"}(yf||(yf={})),function(e){e.DOGFOOD="Dogfood",e.MICROSOFT="Microsoft",e.PRODUCTION="Production"}(_f||(_f={})),function(e){e.Unknown="Unknown",e.File="File",e.Folder="Folder",e.Attachment="Attachment",e.Link="Link"}(bf||(bf={})),function(e){e.Unknown="Unknown",e.SharepointOnline="SharepointOnline",e.ModernAttachment="ModernAttachment",e.ClassicAttachment="ClassicAttachment",e.EmailLink="EmailLink",e.OneDriveForBusiness="OneDriveForBusiness"}(Cf||(Cf={})),function(e){e.Unknown="Unknown",e.DownloadableUrl="DownloadableUrl",e.ReaderUrl="ReaderUrl"}(Sf||(Sf={})),function(e){e.Person="Person",e.Group="Group",e.Other="Other"}(Tf||(Tf={})),function(e){e.OrganizationUser="OrganizationUser",e.OrganizationContact="OrganizationContact",e.PersonalContact="PersonalContact",e.ImplicitContact="ImplicitContact",e.ChatImplicitContact="ChatImplicitContact",e.Room="Room",e.Guest="Guest",e.UnifiedGroup="UnifiedGroup",e.PublicDistributionList="PublicDistributionList",e.PersonalDistributionList="PersonalDistributionList"}(If||(If={})),function(e){e.None="None",e.Organizer="Organizer",e.TentativelyAccepted="TentativelyAccepted",e.Accepted="Accepted",e.Declined="Declined",e.NotResponded="NotResponded"}(wf||(wf={})),function(e){e.Membership="Membership",e.Address="Address",e.Invalid="Invalid"}(Ef||(Ef={})),function(e){e.Message="Message",e.Email="Email",e.Conversation="Conversation",e.Document="Document",e.Keywords="Keywords",e.People="People",e.Bookmark="Bookmark",e.Building="Building",e.EditorialQnA="EditorialQnA",e.Floorplan="Floorplan",e.Flight="Flight",e.Acronym="Acronym",e.TuringQnA="TuringQnA",e.Task="Task",e.External="External",e.Topic="Topic",e.MeetingCatchUp="MeetingCatchUp",e.MeetingProposal="MeetingProposal",e.MeetingRoomProposal="MeetingRoomProposal",e.Report="Report",e.Streams="Streams",e.Group="Group",e.Site="Site",e.Team="Team",e.Chat="Chat",e.Channel="Channel",e.Link="Link",e.EmployeeOffer="EmployeeOffer",e.Fact="Fact",e.Text="Text",e.Event="Event",e.File="File",e.SharePoint="SharePoint",e.Attachment="Attachment",e.PIM="PIM",e.MessageExtensionApp="MessageExtensionApp",e.Scope="Scope",e.TranscriptLlmAnswer="TranscriptLlmAnswer",e.Prompt="Prompt",e.PeopleInGroup="PeopleInGroup",e.App="App"}(xf||(xf={})),function(e){e.Off="Off",e.Forward="Forward",e.Reverse="Reverse"}(Af||(Af={})),function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning"}(Df||(Df={}));const Nf=e=>{const t=[];return(null==e?void 0:e.enableAppGptsInCiq)&&t.push({Term:{AppType:uf.GPT}}),(null==e?void 0:e.enableAppMessageExtensionsInCiq)&&t.push({Term:{AppType:uf.MessageExtension}}),(null==e?void 0:e.enableAppTypeBInCiq)&&t.push({Term:{AppType:uf.OpenAIPlugin}}),(null==e?void 0:e.enableAppPPInCiq)&&t.push({Term:{AppType:uf.PowerPlatform}}),(null==e?void 0:e.enableAppPluginsInCiq)&&mf.forEach((e=>{t.push({Term:{AppType:e}})})),t},Bf=(e,t,n)=>{const r=!!((null==t?void 0:t.enableAppGptsInCiq)||(null==t?void 0:t.enableAppPluginsInCiq)||(null==t?void 0:t.enableAppPPInCiq)||(null==t?void 0:t.enableAppTypeBInCiq)||(null==t?void 0:t.enableAppMessageExtensionsInCiq));let i=[...e,o.c.App,o.c.Topic];i=i.filter((e=>e===o.c.App?r:e!==o.c.Topic||(null==t?void 0:t.enableTopicCIQ)||(null==t?void 0:t.enableTopicECC)));const a=[];return i.forEach((e=>{e===o.c.App&&r?a.push({enabled:!0,entityType:o.c.App,maxResults:gf,customProps:[{name:"Filter",value:JSON.stringify({Or:Nf(t)})}]}):e===o.c.People?a.push({enabled:!0,entityType:o.c.People,maxResults:gf,customProps:[{name:"Filter",value:JSON.stringify({And:[{Or:[{Term:{PeopleType:Tf.Person}},{Term:{PeopleType:Tf.Other}}]},{Or:[{Term:{PeopleSubtype:If.OrganizationUser}},{Term:{PeopleSubtype:If.Guest}},{Term:{PeopleSubtype:If.OrganizationContact}}]}]})}]}):e===o.c.File?a.push({enabled:!0,entityType:e,maxResults:(null==t?void 0:t.enableSingleEntityStyle)?void 0:gf,customProps:null==n?void 0:n.File}):(e===o.c.Topic&&((null==t?void 0:t.enableTopicCIQ)||null==t||t.enableTopicECC),a.push({enabled:!0,entityType:e,maxResults:gf}))})),a.map((e=>(null==t?void 0:t.enableECCNudge)?Object.assign(Object.assign({},e),{queryPrefix:[e.entityType===o.c.App?hf:"/"]}):e)),a},Of=(e,t)=>t||"DogFood"===e?$p.Staging:"GCC"===e?$p.GCC:"GCCH"===e?$p.GCCHigh:"DOD"===e?$p.USDoD:$p.Prod,Rf=["mc-officeEditorTonalEnabled","mc-officeEditorALEnabled","mc-enable-override-critiques:true","mc-editor-oa","maps-editor-locationsuggestions","mc-graphIntentDetection-workflow","mc-graphIntentDetection-model-flight07","mc-graphIntentDetection-model-flight15","mc-graphIntentDetection-allowlist-flight02","mc-editor-oa-mid-tile-predictions","mc-editor-oa-flags","mc-editor-oa-address-detection","mc-editor-oa-local-business-detection","mc-editor-oa-satori-entity-detection","oa-graph-bestmatch","enable-scope-suggestions","scd-suggestions-toplevel","mc-editor-oa-settings","mc-editor-oa-ecc-annotation","mc-editor-oa-event-ecc","mc-editor-oa-scopes","mc-editor-enable-meeting-banner"],Lf=(e,t)=>{const n=[...Rf];return(null==t?void 0:t.enableChatCIQ)&&n.push("mc-editor-oa-groupchat-ecc"),(null==t?void 0:t.enableEmailCIQ)&&n.push("mc-editor-oa-email-ecc"),((null==t?void 0:t.enableTopicECC)||(null==t?void 0:t.enableTopicCIQ))&&n.push("vivatopics"),((null==t?void 0:t.enableAppGptsInCiq)||(null==t?void 0:t.enableAppPluginsInCiq)||(null==t?void 0:t.enableAppPPInCiq)||(null==t?void 0:t.enableAppTypeBInCiq)||(null==t?void 0:t.enableAppMessageExtensionsInCiq))&&n.push("mc-editor-oa-app-ecc"),e&&n.push("mc-editor-oa-client-ecc"),(null==t?void 0:t.enableResponsiveExpandedECC)&&n.push("mc-editor-expanded-ecc-responsive"),(null==t?void 0:t.enableNewFileTidbits)&&n.push("mc-editor-enable-files-new-tidbits"),(null==t?void 0:t.enableSearchBar)&&(n.push("mc-editor-enable-searchbar"),n.push("mc-editor-attachbutton-searchbar-position")),(null==t?void 0:t.enableECCNudge)&&(n.push("mc-editor-oa-nudge"),n.push("mc-editor-oa-nudge-all-entities")),(null==t?void 0:t.enableGradientPlaceholder)&&n.push("immersive-bizchat-enable-gradient-placeholder"),(null==t?void 0:t.enableExperimentalPredictionTimeout)&&n.push("mc-editor-oa-experimental-prediction-timeout"),(null==t?void 0:t.enableAttachmentHint)&&n.push("mc-editor-enable-attachment-hint"),(null==t?void 0:t.enableShowCIQAfterRemoveAttachment)&&n.push("mc-editor-show-menu-after-remove-attachment"),n},Mf=(e,t,n,r,o,a)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return yield Qp((({augLoopAuthTokenCallback:e,getProfilePictureUrl:t,substrateAuthTokenCallback:n,appId:r,appName:i,appPlatform:o,appScenario:a,sessionId:s,isDogfoodEnvironment:l,appEnvironment:d,accountType:u,puid:c,tenantId:g,accountRing:h,locale:p,oaResultsTimeout:f,sourceName:v,browseThisComputerSettings:m,enableZeroQueryHintText:y,customizedEmptyECCSuggestionsString:_,onOpenGptStorefront:b,moreCopilotsStringOverride:C,enableVisualRefresh:S,doNotLimitToTargetDocument:T},I,w,E)=>{const x=`${k={environment:"Prod"},k?k.publicPath?k.publicPath:function(e){switch(e.environment){case"Gallatin":return Xp+"res-1.cdn.partner.office365.cn/"+ef;case"AG08":return Yp+"eaglex.ic.gov"+tf;case"AG09":return Yp+"microsoft.scloud"+tf;case"GccHigh":return Xp+"res-gcch.cdn.office.net/"+ef;case"DoD":return Xp+"res-dod.cdn.office.net/"+ef;default:return rf}}(k)+nf:rf+nf}graph-search-local-0.4.3505-0.14.3`,A=!!(null==w?void 0:w.enableHybridWorkflow),D=!!((null==w?void 0:w.enableAppGptsInCiq)||(null==w?void 0:w.enableAppPluginsInCiq)||(null==w?void 0:w.enableAppPPInCiq)||(null==w?void 0:w.enableAppTypeBInCiq)||(null==w?void 0:w.enableAppMessageExtensionsInCiq));var k;return{appId:r,showSquiggleTooltip:!0,enableStealthSquiggles:!0,showOptionsButton:!0,flightsToTrack:Lf(A,w),tonalFreEnabledForUser:!0,useFluentV9:(null==w?void 0:w.enableECCForMobile)||S,oaSettings:{enableECCForMobileDevice:{enabled:!!(null==w?void 0:w.enableECCForMobile),mainAxisOverride:195},preventAllTabBackfill:null==w?void 0:w.enablePreventAllTabBackfill,isContextualCardEnabled:!0,mockResults:!1,mockNoAugloopResults:!1,mockResultState:"Default",enableZeroQueryHintText:y,bestMatchConfig:{enabled:!0,maxResults:gf},getProfilePictureUrl:t,scopesConfig:{enabled:!0,maxResults:gf,enableAutomaticScoping:!0},enableOaClient:A,entitiesEnabled:Bf(I,w,E),e2eMetric:!0,updateResultsTimeout:f||5e3,customizedEmptyECCSuggestionsString:_,scopeToAppGptInlineSuggestion:D},hostMetadata:{appName:i,appPlatform:o,appScenario:a,releaseAudienceGroup:h?Ff(h):l?_f.DOGFOOD:_f.PRODUCTION,sessionId:null!=s?s:df()},isTextPredictionEnabled:!0,isFeedbackEnabled:!0,serviceSettings:Object.assign({nudge:{enabled:!!(null==w?void 0:w.enableECCNudge),enableInlineNudge:!0,insertionCharacter:"/",automaticallyScope:!0},hybridAugloop:{enabled:A,enableGraphSearchLocal:A,enablePeriodicUpdates:null==w?void 0:w.enableHybridWorkflowPeriodicUpdates,wasmConfig:{binaryPath:x,scriptPath:x,disableModuleCache:"owa"!=(null==v?void 0:v.toLowerCase())&&"owahub"!=(null==v?void 0:v.toLocaleLowerCase())}},predictions:{enabled:!0,domInsertion:!0,allowMiddleOfSentencePredictions:!1},browseThisComputerSettings:m},D?{appGptConfig:{enableAppGpt:!0,onClickExploreMoreCopilots:b,moreCopilotsStringOverride:C}}:{}),defaultLocale:p||"en-US",controlIconSetName:"FabricMDL2Icons",synonymsEndPoint:Zp.Prod,editorEndPoint:Of(d,l),userId:{puid:c||"testUserId",tenantId:g||"testTenantId",userDisplayName:"",identityProvider:"MSA"===u?0:1},licenseType:Jp.G_.Subscription,sessionType:0,upsellLink:"https://upselllink",ignoreAllEnabled:!0,ignoreOnceEnabled:!0,enableOptimizedCallingPattern:!0,maxSuggestionItemsDisplayNumber:3,maxSuggestionDisplayPerLanguageNumber:2,enableOrchestration:!0,newLineSentenceSeparatorEnabled:!0,enableE2eMetric:!0,orchestratorSettings:{enableAugLoop:!0,augLoopEndpoint:Pf(h,w),augLoopAuthTokenCallback:e,substrateAuthTokenCallback:n},manageRtlInEditorUx:!1,manageRtlForProofingLanguage:!1,enhancedUpsellEnabled:!1,premiumPreviewEnabled:!1,wordCountDetectorEnabled:!0,enabledCorrectionCategories:pf,enabledRefinementCategories:vf,enabledEnhancementCategories:ff,enableStopCheckingForThis:!0,useUiCoherence:S,doNotLimitToTargetDocument:!!T}})(e,t,n,a),o,r)})),qf={itemsStyles:{fileItemStyles:{iconStyles:{margin:4}}}},Wf={calloutStyles:{marginTop:4,width:300,borderRadius:2},containerStyles:{maxWidth:300,minWidth:300,borderRadius:2,paddingHorizontal:0,paddingTop:0,paddingBottom:8,maxHeight:400},headerStyles:{paddingHorizontal:12},shimmerStyles:{circleSize:32,gapSize:12,lineSize:160,paddingTop:8,paddingHorizontal:12},itemsStyles:{sharedItemStyles:{height:48,paddingHorizontal:12,borderRadius:0,textHorizontalPadding:12,titleFontSize:14,subtitleFontSize:12},personItemStyles:{personaCoinSize:32},fileItemStyles:{iconStyles:{margin:4}},scopeItemStyles:{height:32,iconFontSize:16,personaCoinSize:16}},footerStyles:{height:44,marginHorizontal:0,marginBottom:-4}};let Uf=!1;const zf=(e,t)=>{Uf&&(null==t?console.log("EditorService:",e):console.log("EditorService:",e,t))},jf=(e,t)=>{null==t?console.error("EditorService:",e):console.error("EditorService:",e,t)},Hf=(e,t)=>{null==t?console.warn("EditorService:",e):console.warn("EditorService:",e,t)};class Vf{constructor(){this.editorProps=null,this.editorClient=null,this.currentQuery=null,this.currentTab=null,this.openCount=0,this.suggestionCount=0}static getInstance(){return Vf.instance||(Vf.instance=new Vf),Vf.instance}updateFlyoutStartTime(e=!1){this.flyoutStartTime=e?void 0:Date.now()}getLatencyForFlyout(){if(!this.flyoutStartTime)return;const e=(Date.now()-this.flyoutStartTime)/1e3;return this.updateFlyoutStartTime(!0),e}getEditorProps(){return this.editorProps?this.editorProps:void 0}getEditorClient(){return this.editorClient}getCurrentQuery(){return this.currentQuery}getCurrentTab(){return this.currentTab}getCurrentInvocationSource(){return this.currentInvocationSource}getScenario(){return this.scenario}bootstrapEditor(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){var t,n,r,o,a,l,d,u,c,g,{eccQueryCharacter:h,targetElement:p,onEntitySelected:f,featureFlags:v,alSession:m,telemetrySink:y,entitiesEnabled:_,telemetryLogger:b,entityCustomProps:C}=e,S=(0,i.__rest)(e,["eccQueryCharacter","targetElement","onEntitySelected","featureFlags","alSession","telemetrySink","entitiesEnabled","telemetryLogger","entityCustomProps"]);g=function(e){var t,n;return null!==(t=null==e?void 0:e.isDogfoodEnvironment)&&void 0!==t?t:(null===(n=null==e?void 0:e.accountRing)||void 0===n?void 0:n.toLowerCase())===yf.DOGFOOD}(S),Uf=g,zf("BootstrapEditor Called"),this.telemetryLogger=b,null==b||b.logEvent({eventId:"EditorBootstrapTriggered"});const T=yield Mf(S,_,v,m,y,C);this.editorClient=T,this.scenario=`${S.appName}.${S.appPlatform}.${null!==(t=S.appScenario)&&void 0!==t?t:""}`,zf("EditorClient Created"),null==b||b.logEvent({eventId:"EditorClientCreated",editorSessionId:null===(n=T.hostSettings.hostMetadata)||void 0===n?void 0:n.sessionId,metaData:JSON.stringify({enabledEntities:null===(o=null===(r=T.hostSettings)||void 0===r?void 0:r.oaSettings)||void 0===o?void 0:o.entitiesEnabled})}),T.onError=(e,t)=>{jf("EditorClient onError called",e),null==b||b.logEvent({eventId:(null==T?void 0:T.isEditorClientShutdown)?"ESDKShutdownError":"ESDKInitializeError",errorMessage:JSON.stringify(e)})},T.setAvailableCritiqueTypes(s);try{localStorage.removeItem("featureFlags");const e={value:'{"enableVisibilityTracker":"True","enableSimplifiedHost":"True","enableParagraphUpdates":"True","enableOrchestratorEmitAll":"True","enablePhraseTextUnitClientSide":"True","enableParagraphDeltas":"True","enableParagraphDeltasVerboseLogging":"True","enableParagraphDeltasEmptyInitialTile":"True","enableRequiredServiceDataOnly":"True","enableExperimentalECCQueryDetectionFixes":"True","enableLoggingModulesAndBindings":"False"}',lastUpdated:(new Date).getTime(),manualOverride:!0};localStorage.setItem("featureFlags",JSON.stringify(e))}catch(e){jf("Error setting localStorage feature flags",e),null==b||b.logEvent({eventId:"EditorClientLocalStorageFFOverrideError",editorSessionId:null===(a=T.hostSettings.hostMetadata)||void 0===a?void 0:a.sessionId,errorMessage:String(e)})}return yield T.initializeSDK(),yield T.initializeUX(document),zf("EditorClient Initialized"),this.updateEditorClientCorrelationID(null===(l=S.getClientCorrelationId)||void 0===l?void 0:l.call(S)),null==b||b.logEvent({eventId:"EditorClientInitialized",editorSessionId:null===(d=T.hostSettings.hostMetadata)||void 0===d?void 0:d.sessionId,metaData:JSON.stringify({enabledEntities:null===(c=null===(u=T.hostSettings)||void 0===u?void 0:u.oaSettings)||void 0===c?void 0:c.entitiesEnabled})}),T}))}enableInlineSuggestionsMenu({targetElement:e,eccQueryCharacter:t,entitiesEnabled:n,enableExpandedECC:r,onEntitySelected:i,onItemSelected:s,onClose:l,onOpen:d,telemetryLogger:u,featureFlags:c,theme:g=a.SV.light,suggestionTitleAndSubTitle:h,inlineSuggestionsStyles:p,getCIQSuggestionsFromClient:f,fluentV9Theme:v}){var m,y,_,b;zf("EnableInlineSuggestionsMenu Called");const C=this.editorClient;if(null==C||C.attach(e),!(null==c?void 0:c.disableClientConfigQueryCharacterForEditorService))try{this.enableInlineSuggestions({entitiesEnabled:n,eccQueryCharacter:t,enableExpandedECC:r,onEntitySelected:i,onItemSelected:s,onClose:l,onOpen:d,telemetryLogger:u,featureFlags:c,suggestionTitleAndSubTitle:h,inlineSuggestionsStyles:p,fluentV9Theme:v})}catch(e){jf("Error in enableInlineSuggestionsMenu",e),null===(m=this.telemetryLogger)||void 0===m||m.logEvent({eventId:"ECCEnableInlineSuggestionMenuFailed",errorMessage:`Error in Enable Menu for ciq char ${t}. Error: `+JSON.stringify(e)})}if((null==c?void 0:c.enableAppGptsInCiq)||(null==c?void 0:c.enableAppPluginsInCiq)||(null==c?void 0:c.enableAppMessageExtensionsInCiq)||(null==c?void 0:c.enableAppPPInCiq)||(null==c?void 0:c.enableAppTypeBInCiq)){const e=[o.c.App],t=hf;try{this.enableInlineSuggestions({entitiesEnabled:e,eccQueryCharacter:t,enableExpandedECC:!1,onEntitySelected:i,onItemSelected:s,onClose:l,onOpen:d,telemetryLogger:u,featureFlags:c,suggestionTitleAndSubTitle:h,inlineSuggestionsStyles:p,getCIQSuggestionsFromClient:f,fluentV9Theme:v})}catch(e){jf("Error in enableInlineSuggestionsMenu",e),null===(y=this.telemetryLogger)||void 0===y||y.logEvent({eventId:"ECCEnableInlineSuggestionMenuFailed",errorMessage:`Error in Enable Menu for ciq char ${t}. Error: `+JSON.stringify(e)})}}if(null==c?void 0:c.enableTopicECC){const e=[o.c.Topic],t="#";try{this.enableInlineSuggestions({entitiesEnabled:e,eccQueryCharacter:t,enableExpandedECC:!0,onEntitySelected:i,onItemSelected:s,onClose:l,onOpen:d,telemetryLogger:u,featureFlags:c,suggestionTitleAndSubTitle:h,inlineSuggestionsStyles:p,fluentV9Theme:v})}catch(e){jf("Error in enableInlineSuggestionsMenu",e),null===(_=this.telemetryLogger)||void 0===_||_.logEvent({eventId:"ECCEnableInlineSuggestionMenuFailed",errorMessage:`Error in Enable Menu for ciq char ${t}. Error: `+JSON.stringify(e)})}}null==C||C.updateCurrentTheme(g),null===(b=this.telemetryLogger)||void 0===b||b.logEvent({eventId:"EditorClientThemeChanged",message:`Theme changed to ${g} in enableInlineSuggestionsMenu`})}disableInlineSuggestionsMenu({eccQueryCharacter:e,featureFlags:t},n){var r,i,o;zf("DisableInlineSuggestionsMenu Called");const a=null!=n?n:this.editorClient;if(!(null==t?void 0:t.disableClientConfigQueryCharacterForEditorService))try{null==a||a.disableInlineSuggestionsMenu(e)}catch(t){jf("Error in disableInlineSuggestionsMenu",t),null===(r=this.telemetryLogger)||void 0===r||r.logEvent({eventId:"ECCDisableInlineSuggestionMenuFailed",errorMessage:`Error in Disable Menu for ciq char ${e}. Error: `+JSON.stringify(t)})}if(null==t?void 0:t.enableTopicECC)try{null==a||a.disableInlineSuggestionsMenu("#")}catch(e){jf("Error in disableInlineSuggestionsMenu",e),null===(i=this.telemetryLogger)||void 0===i||i.logEvent({eventId:"ECCDisableInlineSuggestionMenuFailed",errorMessage:"Error in Disable Menu for ciq char #. Error: "+JSON.stringify(e)})}if((null==t?void 0:t.enableAppGptsInCiq)||(null==t?void 0:t.enableAppPluginsInCiq)||(null==t?void 0:t.enableAppMessageExtensionsInCiq)||(null==t?void 0:t.enableAppPPInCiq)||(null==t?void 0:t.enableAppTypeBInCiq))try{null==a||a.disableInlineSuggestionsMenu(hf)}catch(e){jf("Error in disableInlineSuggestionsMenu",e),null===(o=this.telemetryLogger)||void 0===o||o.logEvent({eventId:"ECCDisableInlineSuggestionMenuFailed",errorMessage:`Error in Disable Menu for ciq char ${hf}. Error: `+JSON.stringify(e)})}}destroyEditor(e){var t,n,r;zf("destroyEditor called");try{const t=null!=e?e:this.editorClient;!1===(null==t?void 0:t.isEditorClientShutdown)&&(null==t||t.shutDown())}catch(e){jf("Error in destroyEditor",e)}null===(t=this.telemetryLogger)||void 0===t||t.logEvent({eventId:"EditorClientDestroyed",editorSessionId:null===(r=null===(n=this.editorClient)||void 0===n?void 0:n.hostSettings.hostMetadata)||void 0===r?void 0:r.sessionId}),this.editorClient=null}setEntityScope(e){if(!this.editorClient)return;const t=((e="")=>{switch(!0){case/file/i.test(e):return o.c.File;case/(people)|(person)/i.test(e):return o.c.People;case/(event)|(meeting)/i.test(e):return o.c.Event;case/chat/i.test(e):return o.c.Chat;case/(message)|(email)/i.test(e):return o.c.Message;case/(topic)/i.test(e):return o.c.Topic;default:return}})(e);if(void 0===t)return void Hf(`Invoked setEntityScope with unsupported entity type ${e}`);const n=this.editorClient.exp_getQueryDetection();null==n||n.setCurrentScope({entityType:t},!1)}eccManuallyInitiated(e){if(!this.editorClient)return;const t=this.editorClient.exp_getQueryDetection();null==t||t.setNextDeltaProgramaticallyInserted(e)}notifyTriggeringType(e){if(!this.editorClient)return;const t=e;this.editorClient.notifyMenuTriggeringMethod(t)}updateCurrentTheme(e){var t,n;if(this.editorClient){try{this.editorClient.updateCurrentTheme(e),zf("Theme updated for CIQ to ",e)}catch(e){return jf("Exception updating theme for CIQ:",e),void(null===(t=this.telemetryLogger)||void 0===t||t.logEvent({eventId:"EditorClientThemeChangedError",errorMessage:e?`${e}`:""}))}null===(n=this.telemetryLogger)||void 0===n||n.logEvent({eventId:"EditorClientThemeChanged",message:`Theme changed to ${e}`})}else Hf("updateCurrentTheme, EditorClient not initialized")}setUnsupportedEntities(e){if(!this.editorClient)return;0===e.length&&Hf("unSupported enities list is empty");const t=this.editorClient.exp_getQueryDetection();null==t||t.setUnsupportedEntities(e)}updateEditorClientCorrelationID(e){if(!this.editorClient)return;const t=this.editorClient.exp_getQueryDetection(),n=null!=e?e:"";null==t||t.setClientCorrelationId(n)}onItemSelected(e,t,n,r,i,s){var l,d,u;if(zf("onItemSelected called Suggestion: ",e),!t)return void Hf("ECC injection failed due to undefined queryRange");const c=e;null==i||i.logEvent({eventId:"ECCEntitySelected",editorSessionId:null===(d=null===(l=this.editorClient)||void 0===l?void 0:l.hostSettings.hostMetadata)||void 0===d?void 0:d.sessionId,entityType:e.type,metaData:JSON.stringify({expansionType:this.currentTab,logicalId:c.logicalId,InvocationSource:this.currentInvocationSource,id:c.ReferenceId})}),(null==i?void 0:i.log3sEvent)&&(null==i||i.log3sEvent({eventType:"SearchEntityActions",localTime:(new Date).toISOString(),logicalId:null!==(u=c.logicalId)&&void 0!==u?u:"",id:c.ReferenceId,scenario:this.scenario,metaData:JSON.stringify({expansionType:this.currentTab,InvocationSource:this.currentInvocationSource})}));const g=((e,t,n)=>{var r,i,s,l,d,u,c,g,h,p,f,v,m;let y,_,b,C,S,T,I,w;switch(e.type){case o.c.People:{const s=e;if(!(null==s?void 0:s.EmailAddresses)||!s.DisplayName)return Hf("People ECC injection failed due to missing EmailAddresses or DisplayName"),void(null==n||n.logEvent({eventId:"ECCEntityInjectionFailed",entityType:o.c.People,message:"People ECC injection failed due to missing EmailAddresses or DisplayName"}));_=s.DisplayName,b=(null==t?void 0:t.enablePeopleQueryAnnotationV2)&&null!==(r=s.Id)&&void 0!==r?r:s.EmailAddresses[0],C="",S="",y={queryAnnotationType:a.in.People,text:_,id:b},I={id:b,referenceId:null!==(i=s.ReferenceId)&&void 0!==i?i:"",displayName:s.DisplayName,emailAddresses:s.EmailAddresses};break}case o.c.File:{const t=e;if(!(null==t?void 0:t.AccessUrl))return Hf("File ECC injection failed due to missing AccessUrl"),void(null==n||n.logEvent({eventId:"ECCEntityInjectionFailed",entityType:o.c.File,message:"File ECC injection failed due to missing AccessUrl"}));_=t.FileName,b=null!==(l=null!==(s=t.SpoId)&&void 0!==s?s:t.SpoUniqueId)&&void 0!==l?l:"",C=t.AccessUrl,S=t.AlternateAccessUrl,T=t.FileExtension,y={queryAnnotationType:a.in.File,text:_,id:b},I={id:b,referenceId:null!==(d=t.ReferenceId)&&void 0!==d?d:"",fileName:t.FileName,accessUrl:t.AccessUrl,spoId:b,dateModified:null!==(u=t.DateModified)&&void 0!==u?u:"",lastModifiedDisplayName:null!==(c=t.ModifiedByDisplayName)&&void 0!==c?c:"",fileSize:t.FileSize,alternateAccessUrl:t.AlternateAccessUrl};break}case o.c.Event:{const t=e;if(!(null==t?void 0:t.OriginalId))return Hf("Event ECC injection failed due to missing OriginalId"),void(null==n||n.logEvent({eventId:"ECCEntityInjectionFailed",entityType:o.c.Event,message:"Event ECC injection failed due to missing OriginalId"}));_=t.Subject,b=t.OriginalId,C=null!==(g=t.WebLink)&&void 0!==g?g:"",S="";const r={id:null!==(p=null===(h=t.EventId)||void 0===h?void 0:h.Id)&&void 0!==p?p:""};y={queryAnnotationType:a.in.Event,text:_,id:b},I={id:b,referenceId:null!==(f=t.ReferenceId)&&void 0!==f?f:"",originalId:t.OriginalId,subject:t.Subject,skypeTeamsMeetingUrl:t.SkypeTeamsMeetingUrl,start:t.Start,end:t.End,organizerName:t.OrganizerName,organizerAddress:t.OrganizerAddress,eventId:r,attendees:null===(v=t.Attendees)||void 0===v?void 0:v.map((e=>{var t,n;return{emailAddress:{name:null!==(t=e.EmailAddress.Name)&&void 0!==t?t:"",address:null!==(n=e.EmailAddress.Address)&&void 0!==n?n:""}}}))};break}case o.c.Chat:{const t=e;if(!(null==t?void 0:t.ThreadId))return Hf("Chat ECC injection failed due to missing ThreadId"),void(null==n||n.logEvent({eventId:"ECCEntityInjectionFailed",entityType:o.c.Chat,message:"Chat ECC injection failed due to missing ThreadId"}));if(t.Name)_=t.Name;else if(t.ChatMembers){const e=2,n=t.ChatMembers.length-e;let r=t.ChatMembers.slice(0,e).map((e=>e.DisplayName)).join(", ");n>0&&(r+=`, +${n}`),_=r}else _="";b=t.ThreadId,C="",S="",y={queryAnnotationType:a.in.Chat,text:_,id:b};break}case o.c.Message:{const t=e;if(!(null==t?void 0:t.ImmutableId))return Hf("Email ECC injection failed due to missing ImmutableId"),void(null==n||n.logEvent({eventId:"ECCEntityInjectionFailed",entityType:o.c.Message,message:"Email ECC injection failed due to missing ImmutableId"}));_=t.Subject,b=null===(m=t.ImmutableId)||void 0===m?void 0:m.Id,C="",S="",y={queryAnnotationType:a.in.Message,text:_,id:b};break}case o.c.Topic:{const t=e;if(!(null==t?void 0:t.TopicId))return Hf("Topic ECC injection failed due to missing TopicId"),void(null==n||n.logEvent({eventId:"ECCEntityInjectionFailed",entityType:o.c.Topic,message:"Topic ECC injection failed due to missing TopicId"}));_=t.DisplayName,b=t.TopicId,C=t.Url,S="",y={queryAnnotationType:a.in.Topic,text:_,id:b};break}case o.c.App:if(!(null==e?void 0:e.AppId))return Hf("App ECC injection failed due to missing AppId"),void(null==n||n.logEvent({eventId:"ECCEntityInjectionFailed",entityType:o.c.App,message:"App ECC injection failed due to missing AppId"}));b=e.AppId,_="",C="",S="",w={appId:e.AppId,collectorId:e.CollectorId,appType:e.AppType,title:e.Title,iconUrl:e.IconAnonymousUrl};break;default:return Hf(`onItemSelected called with unsupported suggestion type ${e.type}`),void(null==n||n.logEvent({eventId:"ECCEntityInjectionFailed",entityType:e.type,message:`onItemSelected called with unsupported suggestion type ${e.type}`}))}return{ciqEntityElement:{entityType:e.type,id:b,text:_,url:C,fileExtension:T,alternateUrl:S},annotation:y,rawEntityData:I,atMentionApp:w}})(e,s,i);g&&(this.currentQuery=null,this.currentTab=null,null==r||r(g.ciqEntityElement,g.annotation,t,n,g.rawEntityData,g.atMentionApp))}onOpen(e,t,n){var r,i;this.currentInvocationSource=e.invocationSource?e.invocationSource:e.triggerCharacter;let o={expansionSource:this.currentInvocationSource};const a=this.getLatencyForFlyout();a&&this.currentInvocationSource===hf&&(o=Object.assign(Object.assign({},o),{suggestionUpdateLatency:a,openCount:this.openCount,suggestionCount:this.suggestionCount})),this.updateFlyoutStartTime(),null==t||t.logEvent({eventId:"ECCOpened",editorSessionId:null===(i=null===(r=this.editorClient)||void 0===r?void 0:r.hostSettings.hostMetadata)||void 0===i?void 0:i.sessionId,metaData:JSON.stringify(o)}),n&&n()}onClose(e,t,n,r){var i,o;zf(`onClose, searchResultAccepted: ${e}, persistTime: `,t),null==n||n.logEvent({eventId:"ECCClosed",editorSessionId:null===(o=null===(i=this.editorClient)||void 0===i?void 0:i.hostSettings.hostMetadata)||void 0===o?void 0:o.sessionId,metaData:JSON.stringify({selectedEntity:e,openedTime:t})}),r&&r(e,t)}onAction(e,t){var n,r;zf("onAction",e),null==t||t.logEvent({eventId:"ECCAction",editorSessionId:null===(r=null===(n=this.editorClient)||void 0===n?void 0:n.hostSettings.hostMetadata)||void 0===r?void 0:r.sessionId,metaData:JSON.stringify({actionId:e})})}onSuggestionsUpdatedFromClient(e,t,n,r,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){var i,s,l,d,u,c;const g=null!==(l=null===(s=null===(i=null==t?void 0:t[0])||void 0===i?void 0:i.entities[0])||void 0===s?void 0:s.logicalId)&&void 0!==l?l:"",h=yield e(null!==(d=this.currentInvocationSource)&&void 0!==d?d:"",null!=n?n:"");t[0]?t[0]=Object.assign(Object.assign({},t[0]),{entities:h}):t.push({entities:h,groupTitle:null==a?void 0:a.title,groupSubtitle:null==a?void 0:a.subtitle,entityType:o.c.App});const p=this.getLatencyForFlyout();return null==r||r.logEvent({eventId:"ECCSuggestionUpdated",editorSessionId:null===(c=null===(u=this.editorClient)||void 0===u?void 0:u.hostSettings.hostMetadata)||void 0===c?void 0:c.sessionId,metaData:JSON.stringify({expansionType:this.currentTab,expansionSource:this.currentInvocationSource,logicalId:g,suggestionCount:t[0].entities.length.toString(),isQueryStringEmpty:""===n?"true":"false",suggestionUpdateLatency:null!=p?p:void 0,openCount:this.openCount,clientOverride:"true"})}),t}))}onSuggestionsUpdated(e,t,n,r,i,a,s){var l,d,u,c,g,h,p;let f,v="";if(0===t&&e[0]&&e[0].entities.length>0&&s&&(null==n?void 0:n.entityType)===o.c.App){const n=e[0].entities.filter((e=>{var t;return!(null===(t=null==e?void 0:e.GptIdentifier)||void 0===t?void 0:t.Id.includes("ProjectedDeclarativeAgent"))}));e[0]=Object.assign(Object.assign({},e[0]),{entities:n}),t=n.length>0?0:1}if(0===t&&e[0]&&e[0].entities.length>0){v=null!==(l=e[0].entities[0].logicalId)&&void 0!==l?l:"",this.currentTab=null!==(d=null==n?void 0:n.entityType)&&void 0!==d?d:"All";const t=((e,t)=>{var n,r,i,o,a;let s=null!==(n=e[0].entities[0].logicalId)&&void 0!==n?n:"",l=1;const d=[];if(t)for(const n of e[0].entities){const e=n;s=""!=s?s:null!==(r=e.logicalId)&&void 0!==r?r:"",d.push(kf(null!==(i=e.ReferenceId)&&void 0!==i?i:"",t.entityType,l)),l++}else for(const t of e)for(const e of t.entities)if(e.isBestMatch){const t=e;s=""!=s?s:null!==(o=t.logicalId)&&void 0!==o?o:"",d.push(kf(null!==(a=t.ReferenceId)&&void 0!==a?a:"",e.entityType,l)),l++}return d})(e,n);if(n)try{f=JSON.stringify({Type:"Group",Name:this.currentTab,ReferenceId:null,EntityType:null,LayoutType:"Vertical",Position:1,ResultsView:t})}catch(e){jf("Error in onSuggestionsUpdated",e)}if(i)for(const t of e)t.groupTitle=i.title,t.groupSubtitle=i.subtitle;const o=this.getLatencyForFlyout();null==r||r.logEvent({eventId:"ECCSuggestionUpdated",editorSessionId:null===(c=null===(u=this.editorClient)||void 0===u?void 0:u.hostSettings.hostMetadata)||void 0===c?void 0:c.sessionId,metaData:JSON.stringify({expansionType:this.currentTab,expansionSource:this.currentInvocationSource,logicalId:v,suggestionCount:e[0].entities.length.toString(),isQueryStringEmpty:""===a?"true":"false",suggestionUpdateLatency:null!=o?o:void 0})}),(null==r?void 0:r.log3sEvent)&&(null==r||r.log3sEvent({localTime:(new Date).toISOString(),eventType:"ClientLayout",logicalId:v,id:v,scenario:this.scenario,resultsView:f?JSON.stringify(f):void 0,metaData:JSON.stringify({expansionType:this.currentTab,expansionSource:this.currentInvocationSource,logicalId:v})}))}else if(1===t||3===t){this.currentTab=null!==(g=null==n?void 0:n.entityType)&&void 0!==g?g:"All";const e=this.getLatencyForFlyout();null==r||r.logEvent({eventId:"ECCEmptySuggestionUpdated",editorSessionId:null===(p=null===(h=this.editorClient)||void 0===h?void 0:h.hostSettings.hostMetadata)||void 0===p?void 0:p.sessionId,metaData:JSON.stringify({expansionType:this.currentTab,expansionSource:this.currentInvocationSource,logicalId:v,isQueryStringEmpty:""===a?"true":"false",suggestionUpdateLatency:null!=e?e:void 0,status:1===t?"NoResults":"Timeout"})})}}enableInlineSuggestions({entitiesEnabled:e,eccQueryCharacter:t,enableExpandedECC:n,onEntitySelected:r,onItemSelected:a,onClose:s,onOpen:l,telemetryLogger:d,featureFlags:u,suggestionTitleAndSubTitle:c,inlineSuggestionsStyles:g,getCIQSuggestionsFromClient:h,fluentV9Theme:p}){var f;const v=this.editorClient;null==v||v.enableInlineSuggestionsMenu(e,t,a||((e,t,n)=>{this.onItemSelected(e,t,n,r,d,u)}),void 0,void 0,{fitToContent:!0},g||((null==u?void 0:u.enableSingleEntityStyle)?Wf:qf),(e=>{this.onOpen(e,d,l)}),((e,t)=>{this.onClose(e,t,d,s)}),(e=>{this.onAction(e,d)}),void 0,((e,t,n,r,a,s)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=h&&(null==s?void 0:s.entityType)===o.c.App;if(a&&!n)return this.openCount=0,void(this.suggestionCount=0);if(n){const n=yield this.onSuggestionsUpdatedFromClient(h,e,t,d,c);return a&&""===t&&(this.openCount++,this.suggestionCount=n[0].entities.length,this.updateFlyoutStartTime()),n}return this.onSuggestionsUpdated(e,r,s,d,c,t,null==u?void 0:u.disablePluginsAsDAInFlyout),e}))),(()=>{}),void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,n,void 0,void 0,p),null==d||d.logEvent({eventId:"EditorClientInlineSuggestionsEnabled",editorSessionId:null===(f=null==v?void 0:v.hostSettings.hostMetadata)||void 0===f?void 0:f.sessionId,metaData:JSON.stringify({eccQueryCharacter:t})})}}const Gf=(e,t,n)=>{var r,i,s,l,d,u,c,g,h,p,f,v,m;let y,_,b,C,S,T,I;switch(e.type){case"People":{const s=e;if(I=o.c.People,!s.details.emailAddresses||!s.name)return Hf("People ECC injection failed due to missing EmailAddresses or DisplayName"),void(null==n||n.logEvent({eventId:"ECCEntityInjectionFailed",entityType:o.c.People,message:"People ECC injection failed due to missing EmailAddresses or DisplayName"}));_=s.name,b=(null==t?void 0:t.enablePeopleQueryAnnotationV2)&&null!==(r=s.id)&&void 0!==r?r:s.details.emailAddresses[0],C="",y={queryAnnotationType:a.in.People,text:_,id:b},T={id:b,referenceId:null!==(i=s.details.referenceId)&&void 0!==i?i:"",displayName:s.name,emailAddresses:s.details.emailAddresses};break}case"File":{const t=e;if(I=o.c.File,!(null==t?void 0:t.details.accessUrl))return Hf("File ECC injection failed due to missing AccessUrl"),void(null==n||n.logEvent({eventId:"ECCEntityInjectionFailed",entityType:o.c.File,message:"File ECC injection failed due to missing AccessUrl"}));_=null!==(s=t.details.fileName)&&void 0!==s?s:t.name,b=null!==(d=null!==(l=t.details.spoId)&&void 0!==l?l:t.details.spoUniqueId)&&void 0!==d?d:"",C=null!==(u=t.details.accessUrl)&&void 0!==u?u:"",S=t.details.fileExtension,y={queryAnnotationType:a.in.File,text:_,id:b},T={id:b,referenceId:null!==(c=t.details.referenceId)&&void 0!==c?c:"",fileName:t.details.fileName,accessUrl:t.details.accessUrl,spoId:b,dateModified:null!==(g=t.details.dateModified)&&void 0!==g?g:"",lastModifiedDisplayName:null!==(h=t.details.modifiedByDisplayName)&&void 0!==h?h:"",fileSize:t.details.fileSize};break}case"Event":{const t=e;if(I=o.c.Event,!(null==t?void 0:t.details.originalId))return Hf("Event ECC injection failed due to missing OriginalId"),void(null==n||n.logEvent({eventId:"ECCEntityInjectionFailed",entityType:I,message:"Event ECC injection failed due to missing OriginalId"}));_=t.details.subject,b=t.details.originalId,C=null!==(p=t.details.webLink)&&void 0!==p?p:"";const r={id:null!==(f=t.details.eventId)&&void 0!==f?f:""};y={queryAnnotationType:a.in.Event,text:_,id:b},T={id:b,referenceId:null!==(v=t.details.referenceId)&&void 0!==v?v:"",originalId:t.details.originalId,subject:t.details.subject,skypeTeamsMeetingUrl:t.details.skypeTeamsMeetingUrl,start:t.details.start,end:t.details.end,organizerName:t.details.organizerName,organizerAddress:t.details.organizerAddress,eventId:r,attendees:null===(m=t.details.attendees)||void 0===m?void 0:m.map((e=>{var t,n;return{emailAddress:{name:null!==(t=e.EmailAddress.Name)&&void 0!==t?t:"",address:null!==(n=e.EmailAddress.Address)&&void 0!==n?n:""}}}))};break}case"Message":{const t=e;if(I=o.c.Message,!(null==t?void 0:t.details.immutableId))return Hf("Email ECC injection failed due to missing ImmutableId"),void(null==n||n.logEvent({eventId:"ECCEntityInjectionFailed",entityType:I,message:"Email ECC injection failed due to missing ImmutableId"}));_=t.details.subject,b=t.details.immutableId,C="",y={queryAnnotationType:a.in.Message,text:_,id:b};break}default:return Hf(`onItemSelected called with unsupported suggestion type ${e.type}`),void(null==n||n.logEvent({eventId:"ECCEntityInjectionFailed",entityType:e.type,message:`onItemSelected called with unsupported suggestion type ${e.type}`}))}return{ciqEntityElement:{entityType:I,id:b,text:_,url:C,fileExtension:S},annotation:y,rawEntityData:T,atMentionApp:void 0}},Qf="ciq-anchor",Kf=({appName:e,appPlatform:t,appScenario:n,sessionId:i,appId:o,appEnvironment:a,appVersion:s,clientId:l,userId:d,tenantId:u})=>({appName:e,appPlatform:t,appScenario:n,isCopilotScenario:"yes",appId:o,sessionId:i,clientId:l,userId:d,userType:r.UserTypeV2.AAD,releaseAudienceGroup:a,clientVersion:s,tenantId:u,identityProvider:r.IdentityProvider.AAD.toString(),licenseType:Jp.G_.Subscription,flightsToTrack:["mc-officeEditorTonalEnabled","mc-officeEditorDNNGrammarEnabled","mc-editor-oa"].join(";")}),$f=()=>new Date(Date.now()).toISOString().replace("T"," ").replace("Z",""),Zf=e=>(0,i.__awaiter)(void 0,[e],void 0,(function*({appName:e,appPlatform:t,sessionId:n,appEnvironment:o,appScenario:a,appVersion:s,locale:l,puid:d,tenantId:u,featureFlags:c,telemetryLogger:g,ciqV2Configuration:h,alSession:p,targetElement:f,onEntitySelected:v}){if(!p)throw new Error("Augloop session is required");if(!h)throw new Error("CIQ v2 configuration is required");const m=null!=l?l:"en-US";yield(e=>(0,i.__awaiter)(void 0,[e],void 0,(function*({appName:e,appPlatform:t,appScenario:n,sessionId:i,appEnvironment:o,appVersion:a,clientId:s,userId:l,tenantId:d}){yield(0,r.initializeCiqLogger)({clientMetadata:Kf({appName:e,appPlatform:t,appScenario:n,sessionId:i,appId:e,appEnvironment:o,appVersion:a,clientId:s,userId:l,tenantId:d}),transportActivityLogger:r.ciqConsoleLogger})})))({appName:e,appPlatform:t,sessionId:null!=n?n:"unknown",appScenario:null!=a?a:"AppChat",appId:e,appEnvironment:null!=o?o:"local",appVersion:null!=s?s:"unknown",clientId:h.clientId,userId:null!=d?d:"unknown",tenantId:null!=u?u:"unknown"});const y=(0,r.getCiqLogger)();y.info(0,"CIQ init started at "+$f());const _=new r.TextProcessorDefinition({settings:{locales:[m]}}),{ciqDefinition:b}=yield function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=(0,r.getCiqLogger)();n.info(0,"CIQ definition: "+$f());const i=yield(0,r.initAugloopSource)({},t,e),o=yield(0,r.createCiqDefinition)({bootstrapConfig:{hostAppCiqConfig:t,rankerSetup:{rankerType:"MergingRanker"}},dataSources:[i]});return n.info(0,"CIQ definition: "+$f()),{ciqDefinition:o}}))}(p,h),C=new r.Editor({definitions:{textProcessor:_,ciq:b}});y.info(0,"CIQ core: Editor init "+$f()),yield C.init(),y.info(0,"Editor CIQ adapter "+$f());const S=new r.DomElementManager({targetDocument:document}),T=new r.DomTextReader({target:f,elementManager:S,editor:C});yield T.init();const I=new r.DomContentEditableTextWriter({elementManager:S,settings:{keepSelectionPosition:!0}}),w=(e=>{const t=document.querySelector(e);if(!t)throw new Error(`Element with selector ${e} not found in the document.`);return t})(`#${Qf}`),{ciqUiAdapter:E}=yield function(e,t,n,o,a,s){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=(0,r.getCiqLogger)();i.info(0,"CIQ UI Adapter: "+$f());const l=new Map(t.triggers.map((({char:e,enabledTabs:t})=>[e,{enabledTabs:t}]))),d=new r.EditorSdkCiqUiAdapter({targetCiqElement:n,targetEditorElement:o,editor:e,locale:s,onItemSelected:a,triggerCharacterConfig:l,fullWidth:!0});return d.init(),i.info(0,"Finished CIQ core: "+$f()),{ciqUiAdapter:d}}))}(C,h,w,f,((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var n;const r=Gf(e,c,g);r&&(yield I.remove({start:t.startOffset,length:t.endOffset-t.startOffset,elementId:null!==(n=T.elementId)&&void 0!==n?n:"",range:t}),null==v||v(r.ciqEntityElement,r.annotation,t,void 0,r.rawEntityData,r.atMentionApp))}))),m);return yield((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const n=new r.EditorSdkQueryAdapter({queryDetectorConfig:{triggers:new Set(t.triggers.map((({char:e})=>e)))}},e);return n.init(),{queryAdapter:n}})))(C,h),y.info(0,"CIQ init finished at "+$f()),{disposeCiq:()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){yield T.dispose(),yield I.dispose(),E.dispose(),yield C.dispose()}))}}))},28356:(e,t,n)=>{"use strict";n.d(t,{Xr:()=>l,fZ:()=>c,g0:()=>b,n4:()=>g,xU:()=>y});var r=n(75943);class i{constructor(e){r.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Core_ItemDelta"}static getBaseTypes(){return[]}static typeGuard(e){return r.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class o{constructor(e){r.h.assign(o,this,e)}static getTypeName(){return"AugLoop_Core_ItemChangesDelta"}static getBaseTypes(){return["AugLoop_Core_ItemDelta"]}static typeGuard(e){return r.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class a{constructor(e){r.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Core_Operation"}static getBaseTypes(){return[]}static typeGuard(e){return r.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class s{constructor(e){r.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Core_OperationWithSiblingContext"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return r.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class l{constructor(e){r.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Core_AddOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}static typeGuard(e){return r.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class d{constructor(e){r.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}static typeGuard(e){return r.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class u{constructor(e){r.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Core_UpdateAnnotationMetaDataOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return r.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class c{constructor(e){r.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Core_UpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return r.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class g{constructor(e){r.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Core_DeleteOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return r.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){r.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Core_PurgeOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return r.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class p{constructor(e){r.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Core_PurgeSubtreeExceptTypesOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return r.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class f{constructor(e){r.h.assign(f,this,e)}static getTypeName(){return"AugLoop_Core_PurgeByTypesOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return r.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class v{constructor(e){r.h.assign(v,this,e)}static getTypeName(){return"AugLoop_Core_FocusOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return r.h.matchesTypesFor(e,[v.getTypeName()])}}v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class m{constructor(e){r.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Core_VisibilityOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return r.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{constructor(e){r.h.assign(y,this,e)}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return r.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class _{constructor(e){r.h.assign(_,this,e)}static getTypeName(){return"AugLoop_Core_MicroSyncOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return r.h.matchesTypesFor(e,[_.getTypeName()])}}_.H_={T_:_.getTypeName(),B_:_.getBaseTypes()};class b{constructor(e){r.h.assign(b,this,e)}static getTypeName(){return"AugLoop_Signals_SignalOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return r.h.matchesTypesFor(e,[b.getTypeName()])}}b.H_={T_:b.getTypeName(),B_:b.getBaseTypes()};class C{constructor(e){r.h.assign(C,this,e)}static getTypeName(){return"AugLoop_Core_CancelSignalTriggeredWorkflowExecutionOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return r.h.matchesTypesFor(e,[C.getTypeName()])}}C.H_={T_:C.getTypeName(),B_:C.getBaseTypes()}},75943:(e,t,n)=>{"use strict";n.d(t,{h:()=>r});class r{constructor(e){r.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_SchemaObject"}static getBaseTypes(){return[]}static getTypeNameFor(e){return e&&e.H_?e.H_.T_:void 0}static getBaseTypesFor(e){return e&&e.H_&&e.H_.B_?e.H_.B_:[]}static getAllTypesFor(e){const t=r.getTypeNameFor(e);return t?[t,...r.getBaseTypesFor(e)]:[]}static matchesTypesFor(e,t){if(!Array.isArray(t)||0===t.length)return!0;const n=r.getTypeNameFor(e),i=r.getBaseTypesFor(e);for(const e of t){if(e===n)return!0;if(i.indexOf(e)>=0)return!0}return!1}static assign(e,t,n){if(n)for(const e of Object.keys(n))t[e]=n[e];return t.H_=e.H_,t}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},41567:(e,t,n)=>{"use strict";n.d(t,{h:()=>r});class r{constructor(e){r.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_SchemaObject"}static getBaseTypes(){return[]}static getTypeNameFor(e){return e&&e.H_?e.H_.T_:void 0}static getBaseTypesFor(e){return e&&e.H_&&e.H_.B_?e.H_.B_:[]}static getAllTypesFor(e){const t=r.getTypeNameFor(e);return t?[t,...r.getBaseTypesFor(e)]:[]}static matchesTypesFor(e,t){if(!Array.isArray(t)||0===t.length)return!0;const n=r.getTypeNameFor(e),i=r.getBaseTypesFor(e);for(const e of t){if(e===n)return!0;if(i.indexOf(e)>=0)return!0}return!1}static assign(e,t,n){if(n)for(const e of Object.keys(n))t[e]=n[e];return t.H_=e.H_,t}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},52484:(e,t,n)=>{"use strict";var r,i;n.d(t,{F:()=>r,b:()=>i}),function(e){e[e.Client=0]="Client",e[e.Server=1]="Server"}(r||(r={})),function(e){e.None="None",e.RecentlyAccessed="RecentlyAccessed",e.Frequent="Frequent",e.Trending="Trending",e.Uploaded="Uploaded"}(i||(i={}))},26017:(e,t,n)=>{"use strict";var r;n.d(t,{c:()=>r}),function(e){e.Acronym="Acronym",e.Address="Address",e.Attachment="Attachment",e.Bookmark="Bookmark",e.Building="Building",e.Channel="Channel",e.Chat="Chat",e.Conversation="Conversation",e.CopilotPlugin="CopilotPlugin",e.DateTime="DateTime",e.Document="Document",e.EditorialQnA="EditorialQnA",e.Email="Email",e.EmployeeOffer="EmployeeOffer",e.Event="Event",e.External="External",e.Fact="Fact",e.File="File",e.Flight="Flight",e.Floorplan="Floorplan",e.Folder="Folder",e.Group="Group",e.Keywords="Keywords",e.Link="Link",e.LocalBusiness="LocalBusiness",e.Loop="Loop",e.MeetingCatchUp="MeetingCatchUp",e.MeetingProposal="MeetingProposal",e.MeetingRoomProposal="MeetingRoomProposal",e.Message="Message",e.MessageExtensionApp="MessageExtensionApp",e.PIM="PIM",e.People="People",e.Report="Report",e.Satori="Satori",e.Scope="Scope",e.SharePoint="SharePoint",e.Site="Site",e.Streams="Streams",e.Task="Task",e.Team="Team",e.Text="Text",e.Time="Time",e.Topic="Topic",e.TranscriptLlmAnswer="TranscriptLlmAnswer",e.TuringQnA="TuringQnA",e.Prompt="Prompt",e.PeopleInGroup="PeopleInGroup",e.App="App"}(r||(r={}))},48574:(e,t,n)=>{"use strict";n.d(t,{KL:()=>o,SM:()=>d,Yd:()=>s,aO:()=>i,k2:()=>l,uH:()=>a});var r=n(41567),i=function(){function e(t){r.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_NudgeAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return r.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),o=(function(){function e(t){r.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_NudgeAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_NudgeAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return r.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){r.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_NudgeAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_NudgeAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return r.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),a=function(){function e(t){r.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_FlagAnnotation"},e.getBaseTypes=function(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return r.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),s=function(){function e(t){r.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_PredictionAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return r.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),l=function(){function e(t){r.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_PredictionAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_PredictionAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return r.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),d=(function(){function e(t){r.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_PredictionAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_PredictionAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return r.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){r.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedAnnotation"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return r.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){r.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return r.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){r.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return r.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){r.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return r.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}());!function(){function e(t){r.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedAnnotation","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return r.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}()},84382:(e,t,n)=>{"use strict";n.d(t,{$g:()=>o,Fe:()=>i,J2:()=>s,Nh:()=>g,Vm:()=>c,Vn:()=>h,Zx:()=>d,c$:()=>l,gh:()=>u,os:()=>a});var r=n(41567),i=function(){function e(t){r.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UxTreatments"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return r.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),o=function(){function e(t){r.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccResultAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return r.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),a=function(){function e(t){r.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccResultAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return r.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),s=function(){function e(t){r.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccResultAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return r.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),l=function(){function e(t){r.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccResultAnnotationHybrid"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return r.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),d=(function(){function e(t){r.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccResultAnnotationODSP"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccResultAnnotation","AugLoop_ObservationalAssistance_EccResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return r.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){r.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return r.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){r.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedResultAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return r.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),u=(function(){function e(t){r.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return r.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){r.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationHybrid"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return r.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){r.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return r.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),c=function(){function e(t){r.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return r.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),g=(function(){function e(t){r.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return r.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){r.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationHybrid"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return r.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),h=function(){function e(t){r.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_FlagResultAnnotation"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return r.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()},48741:(e,t,n)=>{"use strict";var r;n.d(t,{i:()=>r}),function(e){e[e.Success=0]="Success",e[e.NoResults=1]="NoResults",e[e.Cancelled=2]="Cancelled",e[e.Timeout=3]="Timeout",e[e.UnexpectedError=4]="UnexpectedError",e[e.EarlyExit=5]="EarlyExit"}(r||(r={}))},93381:(e,t,n)=>{"use strict";var r,i,o,a,s,l,d,u,c,g;n.d(t,{Nm:()=>d,ck:()=>u}),function(e){e.Unknown="Unknown",e.File="File",e.Folder="Folder",e.Attachment="Attachment",e.Link="Link"}(r||(r={})),function(e){e.Unknown="Unknown",e.SharepointOnline="SharepointOnline",e.ModernAttachment="ModernAttachment",e.ClassicAttachment="ClassicAttachment",e.EmailLink="EmailLink",e.OneDriveForBusiness="OneDriveForBusiness"}(i||(i={})),function(e){e.Unknown="Unknown",e.DownloadableUrl="DownloadableUrl",e.ReaderUrl="ReaderUrl"}(o||(o={})),function(e){e.Person="Person",e.Group="Group",e.Other="Other"}(a||(a={})),function(e){e.OrganizationUser="OrganizationUser",e.OrganizationContact="OrganizationContact",e.PersonalContact="PersonalContact",e.ImplicitContact="ImplicitContact",e.ChatImplicitContact="ChatImplicitContact",e.Room="Room",e.Guest="Guest",e.UnifiedGroup="UnifiedGroup",e.PublicDistributionList="PublicDistributionList",e.PersonalDistributionList="PersonalDistributionList"}(s||(s={})),function(e){e.None="None",e.Organizer="Organizer",e.TentativelyAccepted="TentativelyAccepted",e.Accepted="Accepted",e.Declined="Declined",e.NotResponded="NotResponded"}(l||(l={})),function(e){e.Membership="Membership",e.Address="Address",e.Invalid="Invalid"}(d||(d={})),function(e){e.Message="Message",e.Email="Email",e.Conversation="Conversation",e.Document="Document",e.Keywords="Keywords",e.People="People",e.Bookmark="Bookmark",e.Building="Building",e.EditorialQnA="EditorialQnA",e.Floorplan="Floorplan",e.Flight="Flight",e.Acronym="Acronym",e.TuringQnA="TuringQnA",e.Task="Task",e.External="External",e.Topic="Topic",e.MeetingCatchUp="MeetingCatchUp",e.MeetingProposal="MeetingProposal",e.MeetingRoomProposal="MeetingRoomProposal",e.Report="Report",e.Streams="Streams",e.Group="Group",e.Site="Site",e.Team="Team",e.Chat="Chat",e.Channel="Channel",e.Link="Link",e.EmployeeOffer="EmployeeOffer",e.Fact="Fact",e.Text="Text",e.Event="Event",e.File="File",e.SharePoint="SharePoint",e.Attachment="Attachment",e.PIM="PIM",e.MessageExtensionApp="MessageExtensionApp",e.Scope="Scope",e.TranscriptLlmAnswer="TranscriptLlmAnswer",e.Prompt="Prompt",e.PeopleInGroup="PeopleInGroup",e.App="App"}(u||(u={})),function(e){e.Off="Off",e.Forward="Forward",e.Reverse="Reverse"}(c||(c={})),function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning"}(g||(g={}))},91752:(e,t,n)=>{"use strict";var r,i,o,a;n.d(t,{bx:()=>r,lb:()=>i,xv:()=>o}),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low",e[e.Informational=3]="Informational"}(r||(r={})),function(e){e[e.NotificationOnly=0]="NotificationOnly",e[e.Delete=1]="Delete",e[e.Ignore=2]="Ignore",e[e.IgnoreAll=4]="IgnoreAll",e[e.IgnoreCritiqueType=8]="IgnoreCritiqueType",e[e.AddToDictionary=16]="AddToDictionary",e[e.ShowDetails=32]="ShowDetails"}(i||(i={})),function(e){e[e.None=0]="None",e[e.ChangeOnce=1]="ChangeOnce",e[e.ChangeAll=2]="ChangeAll",e[e.AutoCorrect=4]="AutoCorrect",e[e.ReadAloud=8]="ReadAloud",e[e.PersonalizedAutoCorrect=16]="PersonalizedAutoCorrect"}(o||(o={})),function(e){e[e.None=0]="None",e[e.CAT_Spelling=1]="CAT_Spelling",e[e.CAT_Grammar=2]="CAT_Grammar",e[e.CAT_Clarity=3]="CAT_Clarity",e[e.CAT_Conciseness=4]="CAT_Conciseness",e[e.CAT_Formality=5]="CAT_Formality",e[e.CAT_Inclusiveness=6]="CAT_Inclusiveness",e[e.CAT_PunctuationConventions=7]="CAT_PunctuationConventions",e[e.CAT_Resume=8]="CAT_Resume",e[e.CAT_SensitiveGeopoliticalReferences=9]="CAT_SensitiveGeopoliticalReferences",e[e.CAT_Vocabulary=10]="CAT_Vocabulary",e[e.CAT_ConsistentWrittenForms=11]="CAT_ConsistentWrittenForms",e[e.CAT_ErrorCorrections=12]="CAT_ErrorCorrections",e[e.CAT_WritingConventions=13]="CAT_WritingConventions",e[e.CAT_Acronyms=14]="CAT_Acronyms",e[e.CAT_Perspectives=15]="CAT_Perspectives",e[e.CAT_UncommonWords=16]="CAT_UncommonWords",e[e.CAT_TypingErrors=17]="CAT_TypingErrors",e[e.CAT_Rewrite=18]="CAT_Rewrite"}(a||(a={}))},3327:(e,t,n)=>{"use strict";var r,i,o;n.d(t,{HS:()=>o,OD:()=>i,WI:()=>r}),function(e){e[e.Add=0]="Add",e[e.Delete=1]="Delete",e[e.Update=2]="Update",e[e.CursorUpdate=3]="CursorUpdate",e[e.FormattingUpdate=4]="FormattingUpdate",e[e.OtherNonContentUpdate=5]="OtherNonContentUpdate",e[e.AttributionUpdate=6]="AttributionUpdate"}(r||(r={})),function(e){e[e.Chars=0]="Chars",e[e.Word=1]="Word",e[e.PartialSentence=2]="PartialSentence",e[e.Sentence=3]="Sentence",e[e.Paragraph=4]="Paragraph"}(i||(i={})),function(e){e[e.SessionUser=0]="SessionUser",e[e.Programmatic=1]="Programmatic",e[e.Collaborator=2]="Collaborator"}(o||(o={}))},6510:(e,t,n)=>{"use strict";n.d(t,{s:()=>o});var r=n(75943);class i{constructor(e){r.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Text_TextTileDelta"}static getBaseTypes(){return["AugLoop_Core_ItemDelta"]}static typeGuard(e){return r.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class o{constructor(e){r.h.assign(o,this,e)}static getTypeName(){return"AugLoop_Text_FormattedTextTileDelta"}static getBaseTypes(){return["AugLoop_Text_TextTileDelta","AugLoop_Core_ItemDelta"]}static typeGuard(e){return r.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()}},90630:(e,t,n)=>{"use strict";n.d(t,{Cg:()=>o});var r=n(75943);class i{constructor(e){r.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Text_TextTile"}static getBaseTypes(){return[]}static typeGuard(e){return r.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class o{constructor(e){r.h.assign(o,this,e)}static getTypeName(){return"AugLoop_Text_FormattedTextTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(e){return r.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class a{constructor(e){r.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Text_InlineTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(e){return r.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class s{constructor(e){r.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Text_DynamicTextContext"}static getBaseTypes(){return["AugLoop_Core_DynamicContext"]}static typeGuard(e){return r.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class l{constructor(e){r.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Text_TaskTile"}static getBaseTypes(){return["AugLoop_Text_FormattedTextTile","AugLoop_Text_TextTile"]}static typeGuard(e){return r.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class d{constructor(e){r.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Text_PersonTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return r.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class u{constructor(e){r.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Text_DateTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return r.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class c{constructor(e){r.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Text_LinkTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return r.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class g{constructor(e){r.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Text_CommentTile"}static getBaseTypes(){return[]}static typeGuard(e){return r.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()}},60685:(e,t,n)=>{"use strict";n.d(t,{a:()=>r});const r=(0,n(63837).f)("ISessionContextProvider")},67005:(e,t,n)=>{"use strict";var r,i,o;function a(e){return e?Object.values(i).find((t=>t===e)):void 0}function s(e){const t=new Set([i.CIQFlag_DateEntityRecognition,i.CIQFlag_PersonEntityRecognition,i.CIQFlag_Location,i.CIQFlag_LocalBusiness,i.CIQFlag_TaskRecognition,i.HeadingDetection,i.CIQFlag_Topic,i.CIQFlag_SatoriEntityRecognition,i.CIQFlag_File,i.CIQFlag_Time]);return!!e&&t.has(e)}n.d(t,{$w:()=>o,L9:()=>i,bx:()=>r,e3:()=>a,oe:()=>s}),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low",e[e.Informational=3]="Informational"}(r||(r={})),function(e){e.ContextualSpelling="818bcdbe-64ce-46e8-a3d7-75a1ea8365a8",e.WrongSpelling="363d7011-83dd-4cc0-bdec-ea4af4df4dbb",e.TonalRewrite="965c8b90-32a3-4451-8c09-eba2c163dcec",e.TopicSuggestion="9bf58f9f-4159-40a1-80b8-4fe1f87c010d",e.CIQFlag_Location="1d456e3c-f436-4b8f-a315-1cc430bc2ee1",e.CIQFlag_LocalBusiness="1ECDDA98-C954-9863-87BD-4B0F493558FB",e.CIQFlag_PersonEntityRecognition="ffa21afe-fab3-423c-b579-8de8-128429f1cc8e",e.CIQFlag_DateEntityRecognition="349483fb-b654-4b4c-aefe-9f22bf147cd7",e.CIQFlag_TaskRecognition="c45ba192-bfae-4965-a833-694b55b1bd1d",e.CIQFlag_Topic="21422617-6650-456a-97cd-a7cd3116c39c",e.HeadingDetection="37e3346c-be6a-462c-afd7-282da13f6328",e.CIQFlag_SatoriEntityRecognition="9d9ccfb3-598c-e24c-3cda-11d260ae57d3",e.CIQFlag_File="17f49c82-b9f8-42d0-ab4e-dc076355d77a",e.CIQFlag_Time="9bd06192-906b-4693-99d3-7d58a1cf1770",e.Synonyms="23bd41d4-28ac-4cbc-ba24-2bba684c07da",e.DoubleSpaceGrammar="6d1d8c3d-62d5-45d1-b850-d8a98a24964b"}(i||(i={})),function(e){e.IgnoreOnce="IgnoreOnce",e.IgnoreAll="IgnoreAll",e.ApplySuggestion="ApplySuggestion",e.DisableCritiqueType="DisableCritiqueType",e.ShowFeedback="ShowFeedback"}(o||(o={}))},36857:(e,t,n)=>{"use strict";n.d(t,{r3:()=>c,_K:()=>u,OE:()=>d});var r=n(30206),i=n(59088),o=n(67005),a=n(44502);function s(e){const{text:t,action:n,languages:i,metadataJSON:o,description:s}=e,l=(0,r.__rest)(e,["text","action","languages","metadataJSON","description"]);return Object.assign({text:t,action:(0,a.fO)(n),languages:i,metadataJSON:o,description:s},l)}function l(e){const{text:t,action:n,languages:i,metadataJSON:o,description:s}=e,l=(0,r.__rest)(e,["text","action","languages","metadataJSON","description"]),{confidenceLevel:d,source:u}=l;return Object.assign({text:t,action:(0,a.BJ)(n),languages:i,metadataJSON:o,description:s,confidenceLevel:d||0,source:u||0},l)}function d(e){const{annotationId:t,typeId:n,traceId:a,sourceData:l,priority:d,supportedActions:u,suggestions:c,textInContext:g,start:h,length:p,metadata:f,nodeId:v,tileId:m,categoryTitle:y,isStealth:_,endNode:b,explanationTitle:C,explanationLabel:S,explanation:T,shouldShowMultilingualFre:I,languageId:w,shouldAttemptLanguageDetection:E}=e,x=(0,r.__rest)(e,["annotationId","typeId","traceId","sourceData","priority","supportedActions","suggestions","textInContext","start","length","metadata","nodeId","tileId","categoryTitle","isStealth","endNode","explanationTitle","explanationLabel","explanation","shouldShowMultilingualFre","languageId","shouldAttemptLanguageDetection"]);return Object.assign({annotationId:t,typeId:(0,o.e3)(n),typeIdRaw:n,traceId:a,sourceData:l,priority:d,supportedActions:(0,i.z)(u),suggestions:c.map(s),textInContext:g,start:h,length:p,metadata:f,nodeId:v,tileId:m,categoryTitle:y,isStealth:_,endNode:b,explanationTitle:C,explanationLabel:S,explanation:T,shouldShowMultilingualFre:I,languageId:w,shouldAttemptLanguageDetection:E},x)}function u(e){const{annotationId:t,typeIdRaw:n,traceId:o,sourceData:a,priority:s,supportedActions:d,suggestions:u,textInContext:c,start:g,length:h,metadata:p,nodeId:f,tileId:v,categoryTitle:m,isStealth:y,endNode:_,explanationTitle:b,explanationLabel:C,explanation:S,shouldShowMultilingualFre:T,languageId:I,shouldAttemptLanguageDetection:w}=e,E=(0,r.__rest)(e,["annotationId","typeIdRaw","traceId","sourceData","priority","supportedActions","suggestions","textInContext","start","length","metadata","nodeId","tileId","categoryTitle","isStealth","endNode","explanationTitle","explanationLabel","explanation","shouldShowMultilingualFre","languageId","shouldAttemptLanguageDetection"]);return Object.assign({annotationId:t,typeId:n,traceId:o,sourceData:a,priority:s,supportedActions:(0,i.N)(d),suggestions:u.map(l),textInContext:c,start:g,length:h,metadata:p,nodeId:f,tileId:v,categoryTitle:m,isStealth:y,endNode:_,explanationTitle:b,explanationLabel:C,explanation:S,shouldShowMultilingualFre:T,languageId:I,shouldAttemptLanguageDetection:w},E)}function c(e){return"isFlagCritique"in e}},59088:(e,t,n)=>{"use strict";n.d(t,{N:()=>i,z:()=>o});var r=n(91752);function i(e){let t=0;return e.delete&&(t|=r.lb.Delete),e.ignore&&(t|=r.lb.Ignore),e.ignoreAll&&(t|=r.lb.IgnoreAll),e.ignoreCritiqueType&&(t|=r.lb.IgnoreCritiqueType),e.addToDictionary&&(t|=r.lb.AddToDictionary),e.showDetails&&(t|=r.lb.ShowDetails),t}function o(e){return 0===e?a:{notificationOnly:!1,delete:!!(e&r.lb.Delete),ignore:!!(e&r.lb.Ignore),ignoreAll:!!(e&r.lb.IgnoreAll),ignoreCritiqueType:!!(e&r.lb.IgnoreCritiqueType),addToDictionary:!!(e&r.lb.AddToDictionary),showDetails:!!(e&r.lb.ShowDetails)}}const a={notificationOnly:!0,delete:!1,ignore:!1,ignoreAll:!1,ignoreCritiqueType:!1,addToDictionary:!1,showDetails:!1}},85230:(e,t,n)=>{"use strict";n.d(t,{Bb:()=>a,Q0:()=>i,pf:()=>r});var r,i,o=n(3327);function a(e){return e.deltaType===o.WI.AttributionUpdate&&void 0!==e.attributionData}!function(e){e.TileNode="TileNode",e.ParagraphNode="ParagraphNode"}(r||(r={})),function(e){e[e.Local=0]="Local",e[e.Code=1]="Code",e[e.Remote=2]="Remote"}(i||(i={}))},44502:(e,t,n)=>{"use strict";n.d(t,{BJ:()=>i,fO:()=>o,gA:()=>a});var r=n(91752);function i(e){let t=0;return e.changeOnce&&(t|=r.xv.ChangeOnce),e.changeAll&&(t|=r.xv.ChangeAll),e.autoCorrect&&(t|=r.xv.AutoCorrect),e.readAloud&&(t|=r.xv.ReadAloud),e.personalizedAutoCorrect&&(t|=r.xv.PersonalizedAutoCorrect),t}function o(e){return{changeOnce:(e&r.xv.ChangeOnce)===r.xv.ChangeOnce,changeAll:(e&r.xv.ChangeAll)===r.xv.ChangeAll,autoCorrect:(e&r.xv.AutoCorrect)===r.xv.AutoCorrect,readAloud:(e&r.xv.ReadAloud)===r.xv.ReadAloud,personalizedAutoCorrect:(e&r.xv.PersonalizedAutoCorrect)===r.xv.PersonalizedAutoCorrect}}function a(e){return!(e.changeOnce||e.changeAll||e.autoCorrect||e.readAloud||e.personalizedAutoCorrect)}},6395:(e,t,n)=>{"use strict";n.d(t,{o:()=>r});const r={NumProofingLanguages:"NumProofingLanguages"}},28575:(e,t,n)=>{"use strict";n.d(t,{W:()=>a});var r,i=n(30206),o=n(48828);!function(e){e[e.NoReaction=0]="NoReaction",e[e.EnableFeature=1]="EnableFeature",e[e.DisableFeature=2]="DisableFeature"}(r||(r={}));let a=class{constructor(){this._listenerId=0,this._callbacks=new Map,this.ignoreDisablers=!1,this.disablers=[],this.enablers=[]}triggerListeners(e){const t=this._callbacks.get(e.eventId);if(!t||0===t.length)return;let n=!0;return t.forEach((t=>{const[r,i]=t.callback(e);n=this.processCallBackResult(n,r,i)})),n}processCallBackResult(e,t,n){return t!==r.NoReaction?e&&t===r.EnableFeature:e}nextListenerId(){return this._listenerId+=1,this._listenerId}addListener(e,t){const n={callback:t,id:this.nextListenerId()};let r=this._callbacks.get(e);return r||(r=[],this._callbacks.set(e,r)),r.push(n),n.id}removeListener(e){e&&this._callbacks.forEach(((t,n,r)=>{t&&-1!==t.findIndex((t=>t.id===e))&&r.set(n,t.filter((t=>t.id!==e)))}))}emitAndEvaluate(e){const t=this.triggerListeners(e);if(!this.ignoreDisablers)for(const e of this.disablers){if(!0===e)return!1;if(!1!==e&&e.check())return!1}let n=!1;for(const e of this.enablers)if(!0===e||!1!==e&&e.check()){n=!0;break}return void 0===t?n:n&&t}};a=(0,i.__decorate)([(0,o._)()],a)},68081:(e,t,n)=>{"use strict";n.d(t,{c:()=>r});const r=(0,n(63837).f)("IFeatureFlagsReader")},49086:(e,t,n)=>{"use strict";n.d(t,{In:()=>a,d2:()=>r,kY:()=>i});var r,i,o=n(63837);!function(e){e[e.SettingsClicked=0]="SettingsClicked"}(r||(r={})),function(e){e[e.dropdown=0]="dropdown",e[e.languageDetectionNotificationBar=1]="languageDetectionNotificationBar",e[e.toneRewriteFre=2]="toneRewriteFre",e[e.multilingualFooterFre=3]="multilingualFooterFre",e[e.manageLanguages=4]="manageLanguages"}(i||(i={}));const a=(0,o.f)("IExternalSettingsFeature")},46079:(e,t,n)=>{"use strict";n.d(t,{FS:()=>i,U1:()=>r,Zp:()=>a});var r,i,o=n(63837);!function(e){e[e.ClientInitialized=0]="ClientInitialized"}(r||(r={})),function(e){e[e.WordDictionaryInit=0]="WordDictionaryInit"}(i||(i={}));const a=(0,o.f)("IRoamingDictionaryFeature")},2320:(e,t,n)=>{"use strict";n.d(t,{DS:()=>c,KW:()=>g,OV:()=>r,xr:()=>i});var r,i,o=n(30206),a=n(63837),s=n(48828),l=n(90424),d=n(28575),u=n(65893);!function(e){e[e.ShowPage=0]="ShowPage",e[e.GetMoreCommands=1]="GetMoreCommands"}(r||(r={})),function(e){e[e.SettingsPage=0]="SettingsPage",e[e.CritiqueCallout=1]="CritiqueCallout"}(i||(i={}));const c=(0,a.f)("IShowSynonymsFeature");let g=class extends d.W{constructor(e){super(),this._isPremiumUser=e,this.disablers=[],this.enablers=[!1,this._isPremiumUser]}};g=(0,o.__decorate)([(0,s._)(),(0,o.__param)(0,(0,l.W)(u.r))],g)},33350:(e,t,n)=>{"use strict";n.d(t,{Gv:()=>p,o9:()=>r,tq:()=>h,v$:()=>i});var r,i,o=n(30206),a=n(63837),s=n(48828),l=n(90424),d=n(28575),u=n(68081),c=n(73675),g=n(83119);!function(e){e[e.SettingsShown=0]="SettingsShown",e[e.CalloutShown=1]="CalloutShown",e[e.PageContext=2]="PageContext"}(r||(r={})),function(e){e[e.SettingsPage=0]="SettingsPage",e[e.CritiqueCallout=1]="CritiqueCallout",e[e.PageContext=2]="PageContext"}(i||(i={}));const h=(0,a.f)("IUnsignedInEditorFeature");let p=class extends d.W{constructor(e,t,n){super(),this._featureFlagsReader=t,this._languageDetector=n,this.enablers=[!0],this.disablers.push(this),this.disablers.push(e)}check(){return!this._featureFlagsReader.flags.enableUnsignedInEditor}async emitAndEvaluateAsync(e){return this.emitAndEvaluate(e)&&this.checkForMultipleLanguages()}async checkForMultipleLanguages(){const e=await this.countUniqueLanguages();return!this._featureFlagsReader.flags.enableSuppressUnsignedInEditorForMultiLang||e<=1}async countUniqueLanguages(){return(await this._languageDetector.getBrowserLanguages()).reduce(((e,t)=>{const n=t.split("-");if(n.length>0){const t=n[0];e.add(t)}return e}),new Set).size}};p=(0,o.__decorate)([(0,s._)(),(0,o.__param)(0,(0,l.W)(g.Z)),(0,o.__param)(1,(0,l.W)(u.c)),(0,o.__param)(2,(0,l.W)(c.v))],p)},65893:(e,t,n)=>{"use strict";n.d(t,{r:()=>d});var r=n(30206),i=n(48828),o=n(90424),a=n(46600),s=n(12765),l=n(99951);let d=class extends l.t{constructor(e){super(e)}checkUserInfo(){return this._expiry?Date.now()<=this._expiry:this.licenseType===s.G_.Subscription}setGracePeriodUntil(e){this._expiry=e}};d=(0,r.__decorate)([(0,i._)(),(0,r.__param)(0,(0,o.W)(a.e))],d)},83119:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var r=n(30206),i=n(46600),o=n(48828),a=n(90424),s=n(99951);let l=class extends s.t{constructor(e){super(e)}checkUserInfo(){return!!this.isLoggedIn}};l=(0,r.__decorate)([(0,o._)(),(0,r.__param)(0,(0,a.W)(i.e))],l)},46544:(e,t,n)=>{"use strict";n.d(t,{W:()=>l});var r=n(30206),i=n(48828),o=n(90424),a=n(68081),s=n(34681);let l=class{constructor(e,t){this._featureFlagsReader=e,this._paragraphDeltasEnabled=t}check(){return this._paragraphDeltasEnabled.check()&&this._featureFlagsReader.flags.enableOptimizedRehydration}};l=(0,r.__decorate)([(0,i._)(),(0,r.__param)(0,(0,o.W)(a.c)),(0,r.__param)(1,(0,o.W)(s.H))],l)},34681:(e,t,n)=>{"use strict";n.d(t,{H:()=>l});var r=n(30206),i=n(48828),o=n(90424),a=n(68081),s=n(88670);let l=class{constructor(e,t){this._hostSettings=e,this._featureFlagsReader=t}check(){return!!this._hostSettings.enableOrchestration&&this._featureFlagsReader.flags.enableParagraphUpdates&&this._featureFlagsReader.flags.enableParagraphDeltas}};l=(0,r.__decorate)([(0,i._)(),(0,r.__param)(0,(0,o.W)(s.n)),(0,r.__param)(1,(0,o.W)(a.c))],l)},99951:(e,t,n)=>{"use strict";n.d(t,{t:()=>o});var r=n(30206),i=n(48828);let o=class{constructor(e){this._userInfoStrategy=e}check(){return this._userInfoStrategy.execute(!1,(e=>(this.setUserInfo(e),e))),this.checkUserInfo()}setUserInfo(e){e&&(this.licenseType=e.licenseType,this.identityProvider=e.identityProvider,this.ageGroup=e.ageGroup,this.ctry=e.ctry),this.isLoggedIn=!!e}};o=(0,r.__decorate)([(0,i._)()],o)},12765:(e,t,n)=>{"use strict";var r,i,o,a,s,l;n.d(t,{G_:()=>s,P2:()=>l}),function(e){e.O365="o365UserService",e.MSA="msaUserService",e.NONE="noneUserService"}(r||(r={})),function(e){e[e.MSA=0]="MSA",e[e.AAD=1]="AAD"}(i||(i={})),function(e){e.AAD="aad",e.MSA="msa",e.NONE="none"}(o||(o={})),function(e){e.GCC="GCC",e.Worldwide="WW"}(a||(a={})),function(e){e.NoLicense="NoLicense",e.Perpetual="Perpetual",e.Subscription="Subscription",e.SubscriptionPreview="SubscriptionPreview"}(s||(s={})),function(e){e[e.Unknown=0]="Unknown",e[e.MinorWithoutParentalConsent=1]="MinorWithoutParentalConsent",e[e.MinorWithParentalConsent=2]="MinorWithParentalConsent",e[e.Adult=3]="Adult",e[e.NotAdult=4]="NotAdult",e[e.MinorNoParentalConsentRequired=5]="MinorNoParentalConsentRequired"}(l||(l={}))},46600:(e,t,n)=>{"use strict";n.d(t,{e:()=>o});var r,i=n(63837);!function(e){e.StorageUserInfoV2Strategy="StorageUserInfoV2Strategy",e.None="None"}(r||(r={}));const o=(0,i.f)("IUserInfoStrategy")},82256:(e,t,n)=>{"use strict";n.d(t,{M:()=>r});const r=(0,n(63837).f)("IUserInfoUpdater")},23627:(e,t,n)=>{"use strict";n.d(t,{H:()=>o});var r,i=n(63837);!function(e){e[e.Undefined=0]="Undefined",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"}(r||(r={}));const o=(0,i.f)("IComponentInitializer")},77148:(e,t,n)=>{"use strict";n.d(t,{S:()=>r});const r=(0,n(63837).f)("IRegistrable")},94563:(e,t,n)=>{"use strict";n.d(t,{V:()=>r});const r=(0,n(63837).f)("IRegistrar")},73675:(e,t,n)=>{"use strict";n.d(t,{v:()=>r});const r=(0,n(63837).f)("IUxLanguageDetector")},48640:(e,t,n)=>{"use strict";n.d(t,{I:()=>a});var r=n(30206),i=n(46546),o=n(92037);class a{constructor(e){this.equalsTo=e=>{if(!e||this._codesList.length!==e.length)return!1;for(let t=0;t<this._codesList.length;t+=1)if(this._codesList[t].toLocaleLowerCase()!==e[t].toLocaleLowerCase())return!1;return!0},this.add=e=>!this._codesList.includes(e)&&(this._codesList.push(e),!0),this.remove=e=>{const t=this._codesList.indexOf(e);return!(t<0||(this._codesList.splice(t,1),0))},this.moveUp=e=>{const t=this._codesList.indexOf(e);if(t<=0)return!1;const n=this._codesList[t-1];return this._codesList[t-1]=this._codesList[t],this._codesList[t]=n,!0},this.moveDown=e=>{const t=this._codesList.indexOf(e);if(t<0||t===this._codesList.length-1)return!1;const n=this._codesList[t+1];return this._codesList[t+1]=this._codesList[t],this._codesList[t]=n,!0},this.moveToTop=e=>{const t=this._codesList.indexOf(e);if(t<=0)return!1;const n=this._codesList[t];for(let e=t;e>0;e-=1)this._codesList[e]=this._codesList[e-1];return this._codesList[0]=n,!0},this._codesList=e,(0,o.Gn)(this)}get count(){var e;return null!==(e=this._codesList.length)&&void 0!==e?e:0}get defaultLanguageCode(){return a.getDefaultLanguageCode(this._codesList)}static getDefaultLanguageCode(e){return e&&e.length>0?e[0]:""}get codesList(){return this._codesList||[]}}(0,r.__decorate)([i.observable],a.prototype,"_codesList",void 0),(0,r.__decorate)([i.computed],a.prototype,"count",null),(0,r.__decorate)([i.computed],a.prototype,"defaultLanguageCode",null),(0,r.__decorate)([i.computed],a.prototype,"codesList",null)},46965:(e,t,n)=>{"use strict";n.d(t,{K3:()=>r,aP:()=>a,iw:()=>o});var r,i=n(63837);!function(e){e.auto="auto",e.ltr="ltr",e.rtl="rtl"}(r||(r={}));const o=(0,i.f)("ILanguageScriptDirectionDetector"),a=(0,i.f)("ILanguageScriptDirectionDetectorFactory")},71234:(e,t,n)=>{"use strict";n.d(t,{H:()=>r});const r=(0,n(63837).f)("ILocalizer")},65017:(e,t,n)=>{"use strict";var r,i;n.d(t,{f:()=>i,n:()=>r}),function(e){e.ActionHideSynonymsFromCallout="ActionHideSynonymsFromCallout",e.ActionShowCallout="ActionShowCallout",e.ActionShowSynonymsFromCallout="ActionShowSynonymsFromCallout",e.ActionUpsellButtonClicked="ActionUpsellButtonClicked",e.SignInInitialized="SignInInitialized",e.ActionDisableCritique="ActionDisableCritique",e.OverflowMenuClicked="OverflowMenuClicked",e.UndoCalloutShown="UndoCalloutShown",e.PersonalizedUndoCalloutShown="PersonalizedUndoCalloutShown",e.SquiggleTooltipShown="SquiggleTooltipShown",e.CritiquesShown="CritiquesShown"}(r||(r={})),function(e){e.AriaError="RunTimeErrors.AriaError",e.GetNewActivityError="RunTimeErrors.GetNewActivityError",e.EnvelopeFormatError="RunTimeErrors.EnvelopeFormatError",e.TelemetryError="RunTimeErrors.TelemetryError",e.RoamingDictionarySaveError="RunTimeErrors.RoamingDictionarySaveError",e.RoamingDictionaryInitError="RunTimeErrors.RoamingDictionaryInitError"}(i||(i={}))},37989:(e,t,n)=>{"use strict";n.d(t,{v:()=>r});const r=(0,n(63837).f)("IAggregateLogger")},52996:(e,t,n)=>{"use strict";n.d(t,{g:()=>r});const r=(0,n(63837).f)("ILogger")},49520:(e,t,n)=>{"use strict";n.d(t,{m:()=>r});const r=(0,n(63837).f)("IOaLogger")},41260:(e,t,n)=>{"use strict";n.d(t,{M5:()=>i,pD:()=>a,zJ:()=>o});var r=n(63837);const i=(0,r.f)("IHostEmitter"),o=(0,r.f)("IHostEmitterArray");var a;!function(e){e.tileCheckRequestV1="tileCheckRequestV1",e.configV2RequestEvent="configV2RequestEvent",e.hostModelTileStateReset="hostModelTileStateReset",e.hostModelVisualStateChange="hostModelTileVisualStateChange",e.hostModelDelta="hostModelDelta",e.hostModelFormattingDelta="hostModelFormattingDelta",e.hostModelAttributionDelta="hostModelAttributionDelta",e.hostModelTextTile="hostModelTextTile",e.hostModelParagraphTextTiles="hostModelParagraphTextTiles",e.hostModelMoveTextTile="hostModelMoveTextTile",e.hostModelRehydrateTiles="hostModelRehydrateTiles",e.hostModelRehydrateTilesFinished="hostModelRehydrateTilesFinished",e.hostModelAddedRootNode="hostModelAddedRootNode",e.hostModelRemovedRootNode="hostModelRemovedRootNode",e.hostModelCritiques="hostModelCritiques",e.hostModelCritiqueAction="hostModelCritiqueAction",e.hostModelFlags="hostModelFlags",e.hostModelTextTileEmittedToAugloop="hostModelTextTileEmittedToAugloop",e.oaRankedAnnotations="oaRankedAnnotations",e.oaAnnotationsTriggered="oaAnnotationsTriggered",e.oaFlagAnnotationsTriggered="oaFlagAnnotationsTriggered",e.oaMenuControlSignal="oaMenuControlSignal",e.predictionTriggered="predictionTriggered",e.nudgeTriggered="nudgeTriggered",e.nudgeAccepted="nudgeAccepted",e.headingDetectionRecognized="headingDetectionRecognized",e.instrumentationRequestV1="instrumentationRequestV1",e.tileCheckResponseV1="tileCheckResponseV1",e.configV2ResponseEvent="configV2ResponseEvent",e.clearTileCritiques="clearTileCritiques",e.clearCritiquesForNode="clearCritiquesForNode",e.restoreNodeForCritiqueStore="restoreNodeForCritiqueStore",e.telemetryEvent="telemetryEvent",e.newActivityTelemetryEvent="newActivityTelemetryEvent",e.activitySetSuccessTelemetryEvent="activitySetSuccessTelemetryEvent",e.activitySetResultTelemetryEvent="activitySetResultTelemetryEvent",e.activityAddDataFieldTelemetryEvent="activityAddDataFieldTelemetryEvent",e.activityEndNowTelemetryEvent="activityEndNowTelemetryEvent",e.saveCritiqueSettings="saveCritiqueSettings",e.critiqueSettingsChange="critiqueSettingsChange",e.ciqSettingsChange="ciqSettingsChange",e.critiqueValuePerLanguageChanged="critiqueValuePerLanguageChanged",e.saveInlineEditingSettings="saveInlineEditingSettings",e.autoCorrectLanguagesUpdated="autoCorrectLanguagesUpdated",e.addWordToDictionaryLocally="addWordToDictionaryLocally",e.setRoamingDictionaryState="setRoamingDictionaryState",e.enableRoamingDictionary="enableRoamingDictionary",e.updateCurrentSessionDictionary="updateCurrentSessionDictionary",e.setAugLoopState="setAugLoopState",e.getAugLoopState="getAugLoopState",e.squiggleClick="squiggleClick",e.taskRecognitionSignal="taskRecognitionSignal",e.toneDetection="toneDetection",e.autoCorrectionTriggered="autoCorrectionTriggered",e.writeProofingLanguage="writeProofingLanguage",e.readProofingLanguage="readProofingLanguage",e.readProofingUserDictionary="readProofingUserDictionary",e.readRoamingProofingOverriddenOptions="readRoamingProofingOverriddenOptions",e.copywriterRequestSuggestions="copywriterRequestSuggestions",e.copywriterSuggestionsReady="copywriterSuggestionsReady",e.seenEventTriggered="seenEventTriggered",e.addWordsToRoamingUserDictionary="addWordsToRoamingUserDictionary",e.requestSynonyms="requestSynonyms",e.receivedSynonyms="receivedSynonyms",e.writeProofingSettingsToRoaming="writeProofingSettingsToRoaming",e.readOASettings="readOASettings",e.writeOASettings="writeOASettings",e.conditionalOrchestratorSettingsChanged="conditionalOrchestratorSettingsChanged",e.aiInsertRequestSuggestions="aiInsertRequestSuggestions",e.aiInsertSuggestionsReady="aiInsertSuggestionsReady",e.logout="logout",e.textAugmentationCoreResponse="textAugmentationCoreResponse",e.textAugmentationCoreRemovalResponse="textAugmentationCoreRemovalResponse",e.textAugmentationCoreRequest="textAugmentationCoreRequest"}(a||(a={}))},97847:(e,t,n)=>{"use strict";n.d(t,{f:()=>r});const r=(0,n(63837).f)("IInstrumentationMessageProcessor")},79548:(e,t,n)=>{"use strict";n.d(t,{o:()=>r});const r=(0,n(63837).f)("IProofingEmitter")},62070:(e,t,n)=>{"use strict";var r;n.d(t,{G:()=>r}),function(e){e.NewData="NewData",e.RemoveData="RemoveData",e.ChangeData="ChangeData"}(r||(r={}))},6526:(e,t,n)=>{"use strict";function r(e){return e}n.d(t,{z:()=>r})},55908:(e,t,n)=>{"use strict";n.d(t,{n:()=>r});const r=(0,n(63837).f)("IsMobile")},18951:(e,t,n)=>{"use strict";n.d(t,{u:()=>Xe});var r=n(86432),i=n(6526),o=n(19846),a=n(48828);class s{constructor(){this.imports=[]}get uniqueId(){return(0,i.z)(507918419)}configureRootServices(e){!function(e,t,n){try{(0,o.Yi)(e,t,void 0)}catch(e){}}((0,a._)(),r.bk)}}var l,d=n(76230),u=n(30206),c=(l=[],{fireEvent:function(e){l.forEach((function(t){return t(e)}))},addListener:function(e){e&&l.push(e)}});function g(e,t,n){c.fireEvent({level:e,category:t,message:n})}var h={};function p(e,t){"Office."===e.substring(0,7)&&"."!==e[e.length-1]?h[e]?(t.ariaTenantToken&&(h[e].ariaTenantToken=t.ariaTenantToken),t.dnmToken&&(h[e].dnmToken=t.dnmToken)):h[e]=t:g(0,0,(function(){return"Namespace: ".concat(e)}))}function f(e,t){for(var n=e.length;n>0;){var r=e.substr(0,n);if(h[r]){var i=h[r];return t.ariaTenantToken=i.ariaTenantToken,t.dnmToken=i.dnmToken,!0}n=e.lastIndexOf(".",n-1)}return!1}var v=9007199254740991,m=-v,y=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,_=/^[a-zA-Z0-9_\.]{1,95}$/;function b(e){return _.test(e)}function C(e){e&&e.forEach((function(e){if("string"!=typeof e.name||!b(e.name))throw new Error("Invalid dataField name");2===e.dataType&&function(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<m||e>v)throw new Error("Invalid integer ".concat(JSON.stringify(e)))}(e.value)}))}var S=n(109);function T(e){var t={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?(0,u.__assign)({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp||(new Date).getTime()};return e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t}var I=function(){function e(e,t,n){var r,i,o;this.telemetrySinks=[],this.persistentDataFields=[],this.partAFields=[],this.eventQueue=[],this.config=n||{},e&&(this.telemetrySinks=e.telemetrySinks,(r=this.persistentDataFields).push.apply(r,e.persistentDataFields),this.config=(0,u.__assign)((0,u.__assign)({},e.getConfig()),this.config),(i=this.partAFields).push.apply(i,e.partAFields)),t&&(o=this.persistentDataFields).push.apply(o,t)}return e.prototype.addEventContentType=function(e,t){e.push((0,S.Ug)("EventContent.Type",t))},e.prototype.sendTelemetryEvent=function(e){var t=T(e),n=t.telemetryProperties;n.nexusTenantToken=-1;var r=n.ariaTenantToken;r||f(t.eventName,n)||r?this.sendTelemetryEventInternal(t,1):g(0,0,(function(){return"No tenant token: "+e.eventName}))},e.prototype.sendNonStandardEvent=function(e,t){var n=T(e);this.sendTelemetryEventInternal(n,t)},e.prototype.sendCustomerContent=function(e){var t=T(e),n=t.telemetryProperties,r=n.customerContentVersion;return(!r||r>2)&&(n.customerContentVersion=2),n.ariaTenantToken=void 0,n.nexusTenantToken=void 0,n.dnmToken=void 0,this.addEventContentType(t.dataFields,2),this.sendTelemetryEventInternal(t,2)},e.prototype.sendDirectNumericEvent=function(e){var t=T(e),n=t.telemetryProperties;n.dnmToken||f(t.eventName,n)||n.dnmToken?(this.addEventContentType(t.dataFields,1),this.sendTelemetryEventInternal(t,3)):g(0,0,(function(){return"No dnm token: "+t.eventName}))},e.prototype.sendTelemetryEventInternal=function(e,t){if(2===t||!e.telemetryProperties.customerContentVersion&&!e.telemetryProperties.customerContentType){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push([e,t]):g(1,0,(function(){return"No telemetry sinks are attached."})));this.processTelemetryEvent(e,t)}catch(e){return void function(e,t,n){g(0,0,(function(){var e=n instanceof Error?n.message:"";return"".concat("SendTelemetryEvent",": ").concat(e)}))}(0,0,e)}this.telemetrySinks.forEach((function(n){try{3===t||2===t?n.sendNonStandardEvent&&n.sendNonStandardEvent(e,t):n.sendTelemetryEvent(e)}catch(e){}}))}else g(0,0,(function(){return"Customer content"}))},e.prototype.processTelemetryEvent=function(e,t){var n,r,i;if(e.dataFields&&(null===(i=e.dataFields)||void 0===i||i.unshift((0,S.m9)("OTelJS.Version","4.20.30")),3!==t&&this.persistentDataFields&&(n=e.dataFields).unshift.apply(n,this.persistentDataFields)),this.partAFields.length>0){var o=e.eventContract||{name:"",dataFields:[]};(r=o.dataFields).push.apply(r,this.partAFields),e.eventContract=o}this.config.disableValidation||function(e){if(!(t=e.eventName)||t.length>98||!y.test(t))throw new Error("Invalid eventName");var t,n=e.eventContract;if(n){if(n.name&&!b(n.name))throw new Error("Invalid eventContract");C(n.dataFields)}C(e.dataFields)}(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e),this.flushQueue()},e.prototype.flushQueue=function(){var e=this.eventQueue;if(this.eventQueue=[],this.telemetrySinks.length>0)for(var t=0,n=e;t<n.length;t++){var r=n[t],i=r[0],o=r[1];this.sendTelemetryEventInternal(i,o)}},e.prototype.setTenantToken=function(e,t,n){p(e,{ariaTenantToken:t,nexusTenantToken:n})},e.prototype.setDNMToken=function(e,t){p(e,{dnmToken:t})},e.prototype.cloneEvent=function(e){return T(e)},e.prototype.getConfig=function(){return this.config},e}();function w(e,t){return e?e+"."+t:t}function E(e,t,n,r,i){void 0===i&&(i=4),r&&e.push((0,S.m9)("".concat(w(t,n)),r,i))}function x(e,t,n,r){"boolean"==typeof r&&e.push((0,S.LK)("".concat(w(t,n)),r))}function A(e,t,n,r){"number"==typeof r&&e.push((0,S.Ug)("".concat(w(t,n)),r))}var D,k,F,P,N={contractName:"Office.System.Activity",getFields:function(e){var t="Activity",n=[];return E(n,t,"CV",e.cV),A(n,t,"Duration",e.duration),A(n,t,"Count",e.count),A(n,t,"AggMode",e.aggMode),x(n,t,"Success",e.success),e.result&&n.push.apply(n,function(e){var t="Activity.Result",n=[];return A(n,t,"Code",e.code),E(n,t,"Type",e.type),A(n,t,"Tag",e.tag),x(n,t,"IsExpected",e.isExpected),n.push((0,S.m9)("zC.Activity.Result","Office.System.Result")),n}(e.result)),n.push((0,S.m9)("zC.Activity",this.contractName)),n}};!function(e){e.Web="Web",e.Desktop="Desktop",e.Universal="Universal",e.Mobile="Mobile",e.Win32="Win32",e.iOS="iOS",e.Android="Android"}(D||(D={})),function(e){e.Automation="Automation",e.Dogfood="Dogfood",e.Microsoft="Microsoft",e.Insiders="Insiders",e.Production="Production"}(k||(k={})),function(e){var t,n,r,i,o="Copilot";(i=e.FeatureActionType||(e.FeatureActionType={})).IsEnabled="IsEnabled",i.IsSeen="IsSeen",i.IsTried="IsTried",i.IsKept="IsKept",i.IsRejected="IsRejected",(r=e.Capability||(e.Capability={})).ContentGeneration="Content Generation",r.Commanding="Commanding",r.QAandSummaries="QA and Summaries",r.Collaboration="Collaboration",r.Suggestions="Suggestions",(n=e.EntryPoint||(e.EntryPoint={})).Chat="Chat",n.Canvas="Canvas",(t=e.Verb||(e.Verb={})).Create="Create",t.Command="Command",t.Ask="Ask",t.Summarize="Summarize",t.Share="Share",t.Analyze="Analyze",e.getFields=function(e){var t=[];return E(t,o,"FeatureActionType",e.featureActionType),x(t,o,"IsUserInitiated",e.isUserInitiated),E(t,o,"FeatureName",e.featureName),E(t,o,"SubFeatureName",e.subFeatureName),E(t,o,"Capability",e.capability),x(t,o,"IsThumbsUp",e.isThumbsUp),E(t,o,"EntryPoint",e.entryPoint),E(t,o,"Verb",e.verb),E(t,o,"InteractionId",e.interactionId),E(t,o,"ConversationId",e.conversationId),t.push((0,S.m9)("zC.".concat(o),"Office.System.Copilot")),t}}(F||(F={})),function(e){var t,n="Asha";(t=e.EventType||(e.EventType={})).Pillar="Pillar",t.Error="Error",e.getFields=function(e){var t=[];return E(t,n,"EventType",e.eventType),E(t,n,"Pillar",e.pillar),E(t,n,"Scenario",e.scenario),E(t,n,"Veto",e.veto),E(t,n,"Error",e.error),x(t,n,"InStaging",e.inStaging),x(t,n,"IsSessionEndingError",e.isSessionEndingError),x(t,n,"IsIntentional",e.isIntentional),x(t,n,"IsInternal",e.isInternal),t.push((0,S.m9)("zC.".concat(n),"Office.System.Asha")),t}}(P||(P={}));var B=function(){return 1e3*Date.now()};"object"==typeof window&&"object"==typeof window.performance&&"now"in window.performance&&(B=function(){return 1e3*Math.floor(window.performance.now())});var O,R,L,M,q,W,U,z=function(e){var t,n=B(),r=T(e.telemetryEvent);return(0,u.__assign)((0,u.__assign)({cv:e.parentCv.getNext()},r),{createChildActivity:function(t){return z({telemetryEvent:t,sendTelemetryEvent:e.sendTelemetryEvent,parentCv:this.cv})},setResult:function(e,t,n){this.result={code:e,type:t,tag:n}},endNow:function(){var r,i,o=this;if(!t){void 0===this.success&&void 0===this.result&&g(1,0,(function(){return"Activity does not have success or result set"}));var a=B();t=!0;var s={duration:a-n,count:1,aggMode:0,cV:this.cv.value,success:this.success,result:this.result},l=null!==(i=null===(r=this.eventContract)||void 0===r?void 0:r.dataFields)&&void 0!==i?i:[];return l.push.apply(l,N.getFields(s)),this.eventContract={name:N.contractName,dataFields:l},e.sendTelemetryEvent(this)}g(0,0,(function(){return"'".concat(o.eventName,"' already ended")}))}})},j=n(17570),H=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this;return i.baseCv=(0,j.N)(),i}return(0,u.__extends)(t,e),t.prototype.createActivity=function(e){return z({sendTelemetryEvent:this.sendTelemetryEvent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t.prototype.sendActivity=function(e,t,n,r){return this.sendTelemetryEvent({eventName:e,eventContract:{name:N.contractName,dataFields:N.getFields(t)},dataFields:n,eventFlags:r})},t.prototype.sendError=function(e){var t=function(e){var t="Error",n=[];return n.push((0,S.m9)("".concat(t,".ErrorGroup"),e.errorGroup)),n.push((0,S.Ug)("".concat(t,".Tag"),e.tag)),void 0!==e.code&&n.push((0,S.Ug)("".concat(t,".Code"),e.code)),void 0!==e.id&&n.push((0,S.Ug)("".concat(t,".Id"),e.id)),void 0!==e.count&&n.push((0,S.Ug)("".concat(t,".Count"),e.count)),n}(e.error);return null!=e.dataFields&&t.push.apply(t,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:t,eventFlags:e.eventFlags})},t.prototype.createCustomerContentActivity=function(e){return z({sendTelemetryEvent:this.sendCustomerContent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t}(I),V=n(59834);(O||(O={})).getFields=function(e,t){var n=[];return n.push((0,S.Ug)("".concat(e,".Code"),t.code)),void 0!==t.type&&n.push((0,S.m9)("".concat(e,".Type"),t.type)),void 0!==t.tag&&n.push((0,S.Ug)("".concat(e,".Tag"),t.tag)),void 0!==t.isExpected&&n.push((0,S.LK)("".concat(e,".IsExpected"),t.isExpected)),n.push((0,S.m9)("zC.Activity.Result","Office.System.Result")),n},function(e){e.contractName="Office.System.Activity",e.getFields=function(t){var n="Activity",r=[];return void 0!==t.cV&&r.push((0,S.m9)("".concat(n,".CV"),t.cV)),r.push((0,S.Ug)("".concat(n,".Duration"),t.duration)),r.push((0,S.Ug)("".concat(n,".Count"),t.count)),r.push((0,S.Ug)("".concat(n,".AggMode"),t.aggMode)),void 0!==t.success&&r.push((0,S.LK)("".concat(n,".Success"),t.success)),void 0!==t.result&&r.push.apply(r,O.getFields("".concat(n,".Result"),t.result)),r.push((0,S.m9)("zC.Activity",e.contractName)),r}}(R||(R={})),function(e){e.getFields=function(e,t){var n=[];return void 0!==t.id&&n.push((0,S.m9)("".concat(e,".Id"),t.id)),void 0!==t.version&&n.push((0,S.m9)("".concat(e,".Version"),t.version)),void 0!==t.sessionId&&n.push((0,S.m9)("".concat(e,".SessionId"),t.sessionId)),n}}(L||(L={})),(M||(M={})).getFields=function(e,t){var n=[];return void 0!==t.alias&&n.push((0,S.m9)("".concat(e,".Alias"),t.alias)),void 0!==t.primaryIdentityHash&&n.push((0,S.m9)("".concat(e,".PrimaryIdentityHash"),t.primaryIdentityHash)),void 0!==t.primaryIdentitySpace&&n.push((0,S.m9)("".concat(e,".PrimaryIdentitySpace"),t.primaryIdentitySpace)),void 0!==t.tenantId&&n.push((0,S.m9)("".concat(e,".TenantId"),t.tenantId)),void 0!==t.tenantGroup&&n.push((0,S.m9)("".concat(e,".TenantGroup"),t.tenantGroup)),void 0!==t.isAnonymous&&n.push((0,S.LK)("".concat(e,".IsAnonymous"),t.isAnonymous)),n},(q||(q={})).getFields=function(e,t){var n=[];return void 0!==t.name&&n.push((0,S.m9)("".concat(e,".Name"),t.name)),void 0!==t.state&&n.push((0,S.m9)("".concat(e,".State"),t.state)),n},(W||(W={})).getFields=function(e,t){var n=[];return void 0!==t.id&&n.push((0,S.Ug)("".concat(e,".Id"),t.id)),void 0!==t.name&&n.push((0,S.m9)("".concat(e,".Name"),t.name)),void 0!==t.commandSurface&&n.push((0,S.m9)("".concat(e,".CommandSurface"),t.commandSurface)),void 0!==t.parentName&&n.push((0,S.m9)("".concat(e,".ParentName"),t.parentName)),void 0!==t.triggerMethod&&n.push((0,S.m9)("".concat(e,".TriggerMethod"),t.triggerMethod)),void 0!==t.timeOffsetMs&&n.push((0,S.Ug)("".concat(e,".TimeOffsetMs"),t.timeOffsetMs)),n},function(e){e.getFields=function(e,t){var n=[];return n.push((0,S.m9)("".concat(e,".ErrorGroup"),t.errorGroup)),n.push((0,S.Ug)("".concat(e,".Tag"),t.tag)),void 0!==t.code&&n.push((0,S.Ug)("".concat(e,".Code"),t.code)),void 0!==t.id&&n.push((0,S.Ug)("".concat(e,".Id"),t.id)),void 0!==t.count&&n.push((0,S.Ug)("".concat(e,".Count"),t.count)),n}}(U||(U={}));var G,Q=R,K=O,$=U,Z=q,J=L,X=W,Y=M;!function(e){var t,n;t=e.Office||(e.Office={}),(n=t.System||(t.System={})).Activity=Q,n.Result=K,n.Error=$,n.Funnel=Z,n.Host=J,n.User=Y,n.UserAction=X}(G||(G={}));var ee=n(86388),te=n(20399),ne=n(72896);class re{constructor(e,t,n=!1,r=new H){this.kpisEnabled=n,this._oTelTelemetryLogger=r;const{logGroupName:i,tenant:o}=e,{tenantName:a,ariaTenantToken:s,nexusTenantToken:l}=o;this._logGroupName=i,this._oTelTelemetryLogger.addSink(t),this._oTelTelemetryLogger.setTenantToken(`Office.${a}`,s,l),this._namespace=`Office.${a}.${i}`}logEvent(e,t,n,r,i,o,a,s,l){const d=n===ee.h.Undefined?t:`${n}.${t}`;if(r===te.q.Debug)return;const u=[(0,S.Ug)("Tag",e),(0,S.Ug)("Level",r)];i&&u.push((0,S.m9)(null!=l?l:"Data",(0,ne.v)(i))),u.forEach((e=>e.classification=V.o.DataClassification.SystemMetadata)),this.uploadEvent(d,u,null!=o?o:re.DEFAULT_SAMPLING_POLICY,null!=a?a:re.DEFAULT_DIAGNOSTIC_LEVEL,null!=s?s:re.DEFAULT_DATA_CATEGORIES)}logKpi(e,t,n,r,i){if(!this.kpisEnabled)return;const o=`KPIs.${e}`,a=[(0,S.m9)("Entity_Id",t),(0,S.LK)("IsPremium",r)];i&&a.push((0,S.m9)("Data",JSON.stringify(i))),a.forEach((e=>e.classification=V.o.DataClassification.SystemMetadata));const s=G.Office.System.Funnel.getFields("Funnel",{name:this._logGroupName,state:n});a.push(...s),this.uploadEvent(o,a,V.o.SamplingPolicy.CriticalUsage,V.o.DiagnosticLevel.RequiredServiceData,V.o.DataCategories.ProductServiceUsage)}logStandaloneMetric(e,t,n,r,i=[]){const o=null!=t?t:re.DEFAULT_SAMPLING_POLICY,a=null!=n?n:re.DEFAULT_DIAGNOSTIC_LEVEL,s=null!=r?r:re.DEFAULT_DATA_CATEGORIES;this.uploadEvent(e,i,o,a,s)}createActivity(e,t,n){const r=t?`${t}.${e}`:e;return this._oTelTelemetryLogger.createActivity({eventName:this.getFullEventName(r),eventFlags:null!=n?n:{dataCategories:V.o.DataCategories.ProductServiceUsage}})}uploadEvent(e,t,n,r,i){const o=this.getFullEventName(e);this._oTelTelemetryLogger.sendTelemetryEvent({eventName:o,dataFields:t,eventFlags:{dataCategories:i,diagnosticLevel:r,costPriority:V.o.CostPriority.Normal,persistencePriority:V.o.PersistencePriority.Normal,samplingPolicy:n}})}getFullEventName(e){return this.capitalize(`${this._namespace}.${e}`)}capitalize(e){return e.split(".").map(this.capitalizeWord).join(".")}capitalizeWord(e){return e.charAt(0).toUpperCase()+e.slice(1)}}re.DEFAULT_SAMPLING_POLICY=V.o.SamplingPolicy.Measure,re.DEFAULT_DIAGNOSTIC_LEVEL=V.o.DiagnosticLevel.RequiredServiceData,re.DEFAULT_DATA_CATEGORIES=V.o.DataCategories.ProductServiceUsage;var ie=n(90935),oe=n(28575),ae=n(49086);let se=class extends oe.W{constructor(){super(),this.disablers=[],this.enablers=[!1]}openSettings(e){const t={eventId:ae.d2.SettingsClicked,sender:e};this.emitAndEvaluate(t)}};se=(0,u.__decorate)([(0,a._)()],se);var le=n(94084),de=n(34241),ue=n(40245),ce=n(41260),ge=n(88670),he=n(46965),pe=n(52996),fe=n(79548),ve=n(77148),me=n(94563),ye=n(46079),_e=n(60685),be=n(63837);const Ce=(0,be.f)("ITransportActivity"),Se=(0,be.f)("ITransportLogger");var Te=n(33350),Ie=n(65893),we=n(83119),Ee=n(58964);const xe=(e,t,n,r)=>{const i={eventName:e,tagID:`0x${`00000000${t.toString(16)}`.slice(-8)}`,message:n,data:r};return JSON.stringify(i)};let Ae=class{async initialize(e){}addCorrelationID(e){console.log(`CorrelationID is: ${e}`)}log(e,t,n,r){this.dispatchLog(null,e,t,n,r)}debug(e,t,n){this.dispatchLog(null,e,te.q.Debug,t,n)}error(e,t,n){this.dispatchLog(null,e,te.q.Error,t,n)}warn(e,t,n){this.dispatchLog(null,e,te.q.Warn,t,n)}info(e,t,n){this.dispatchLog(null,e,te.q.Info,t,n)}logEvent(e,t,n,r,i,o){this.dispatchLog(t,e,n,r,o)}dispatchLog(e,t,n,r,i){switch(n){case te.q.Debug:console.log(xe(e,t,r,i));break;case te.q.Error:console.error(xe(e,t,r,i));break;case te.q.Info:console.info(xe(e,t,r,i));break;case te.q.Warn:console.warn(xe(e,t,r,i));break;default:throw new Error("Invalid logging level")}}getNewActivity(e,t,n){console.log(e)}};Ae=(0,u.__decorate)([(0,a._)()],Ae);var De=n(93398),ke=n(30122),Fe=n(90424);let Pe=class{constructor(e,t){this._transports=e,this._activityTransport=t,this._debugMode=!1,this._initialized=!1,this._initializing=!1,this._diagosticEventName="GeneralDiagnostics",this.logDiagnostics=(e,t,n,r)=>{this.logActivityBase(this._diagosticEventName,e,t,n,r)},this.logActivity=(e,t,n,r)=>{this.logActivityBase(e,void 0,t,n,r)},this.logActivityBase=(e,t,n,r,i)=>{const o=this.getNewActivity(e,V.o.SamplingPolicy.CriticalExperimentation);t&&(null==o||o.dataFields.push((0,De.n)("message",t))),n&&(null==o||o.dataFields.push((0,De.n)("data",JSON.stringify(n)))),r&&(null==o||o.dataFields.push(...r)),o&&(o.success=!0,o.endNow())}}async initialize(e,t,n,r,i){var o;if(!this._initialized){if(!this._initializing)try{this._debugMode=null!==(o=await(null==e?void 0:e.read(Ee.l.DebugMode)))&&void 0!==o&&o,this._debugMode&&this._transports.push(new Ae);for(const o of this._transports)await o.initialize(e,n,r,t,i);this._activityTransport&&await this._activityTransport.initialize(e,n,r,t,i)}finally{this._initializing=!1}this._initialized=!0}}config({transports:e,activityTransport:t}){return this._transports=e,this._activityTransport=t,this}addCorrelationID(e){for(const t of this._transports)t.addCorrelationID(e);this._activityTransport&&this._activityTransport.addCorrelationID(e)}log(e,t,n,r){this.logEvent(e,null,t,n,V.o.SamplingPolicy.Measure,r)}info(e,t,n){this.logEvent(e,null,te.q.Info,t,V.o.SamplingPolicy.Measure,n)}warn(e,t,n){this.logEvent(e,null,te.q.Warn,t,V.o.SamplingPolicy.Measure,n)}error(e,t,n){this.logEvent(e,null,te.q.Error,t,V.o.SamplingPolicy.CriticalBusinessImpact,n)}debug(e,t,n){this.logEvent(e,null,te.q.Debug,t,V.o.SamplingPolicy.Diagnostics,n)}logServiceRequest(e,t,n,r,i){for(const o of this._transports)t&&(o.serviceRequestID=t),this.logEvent(e,null,n,r,V.o.SamplingPolicy.Measure,i)}logEvent(e,t,n,r,i,o,a){if(this._initialized&&(this._debugMode||n!==te.q.Debug))for(const s of this._transports)s.logEvent(e,t,n,r,i,o,a)}getNewActivity(e,t,n){return this._initialized&&this._activityTransport?this._activityTransport.getNewActivity(e,t,n):void 0}dispose(){}};var Ne;Pe=(0,u.__decorate)([(0,a._)(),(0,u.__param)(0,(0,ke.t)(Se)),(0,u.__param)(1,(0,Fe.W)(Ce))],Pe),function(e){e.Offered="Offered",e.Seen="Seen",e.Tried="Tried",e.Kept="Kept",e.Rejected="Rejected"}(Ne||(Ne={}));var Be=n(46600);const Oe=["facetCodes","statusCode","innerMostErrorCode","sprequestguid"];function Re(e){return e.map((e=>e[1]?Le(e[0],e[1]):void 0)).filter((e=>!!e))}function Le(e,t,n){return(0,De.n)(e,t,V.o.DataClassification.SystemMetadata,n)}function Me(e){const t={};return function(e,t){var n;const r="object"==typeof e&&null!==e;function i(t){if(!r)return;const n=e[t];return"string"==typeof n?n:void 0}t.errorMessage=null!==(n=i("message"))&&void 0!==n?n:String(e),t.errorName=i("name"),t.stack=i("stack"),t.errorType=i("errorType"),t.errorInstanceId=i("errorInstanceId"),Oe.forEach((n=>{const r=e[n];r&&(t[n]="object"==typeof r?JSON.stringify(r):r)}))}(e,t),t.message?t.message=`${t.message}\n${t.errorMessage}`:t.message=t.errorMessage,void 0===t.stack&&(t.stack=function(){let e=(new Error).stack;if(!e)try{throw new Error}catch(t){e=t.stack}return e}()),t}var qe;let We=qe=class{constructor(e,t,n){this._telemetrySink=e,this._loggerSettings=t,this._userInfoStrategy=n,this._appId="",this._clientId="",this._initialized=!1,this._initializing=!1,this._configurationId=""}async initialize(e,t,n,r,i){if(!this._initialized){if(!this._initializing){this._initializing=!0;try{this._hostSettings=i,this._sessionContext=t,this._configurationId=await e.read(Ee.l.ConfigurationId),this._appId=await e.read(Ee.l.AppId),this._clientId=await e.read(Ee.l.ClientId),this._internalLogger=new re(this._loggerSettings,this._telemetrySink)}finally{this._initializing=!1}}this._initialized=!0}}logEvent(e,t,n,r,i,o,a){if(this._initialized&&this._loggerSettings.defaultEventName){const s=t||this._loggerSettings.defaultEventName;this.sendLog(s,e,n,r,i,o,a)}}getNewActivity(e,t,n){var r,i,o,a;if(!this._initialized)return;const s=this._internalLogger.createActivity(e,void 0,{dataCategories:V.o.DataCategories.ProductServiceUsage,diagnosticLevel:V.o.DiagnosticLevel.RequiredServiceData});if(null===(r=this._userInfoStrategy)||void 0===r||r.execute(!1,(e=>(e&&s.dataFields.push(...Re([["User_Id",e.userId],["Tenant_Id",e.tenantId],["Identity_Provider",JSON.stringify(e.identityProvider)],["License_Type",e.licenseType]])),e))),s.dataFields.push(...this.getSessionContextDataFields()),s.dataFields.push(...Re([["App_Id",this._appId],["Client_Id",this._clientId],["CorrelationID",null!==(i=this._sessionCorrelationId)&&void 0!==i?i:""],["ConfigurationId",this._configurationId],["FlightsToTrack",null===(a=null===(o=this._hostSettings)||void 0===o?void 0:o.flightsToTrack)||void 0===a?void 0:a.join(";")]])),n){const t=qe.createFunnelContract(e,n);s.dataFields.push(...t)}return s}getSessionContextDataFields(){var e,t;return this._sessionContext?Re([["Browser_Type",this._sessionContext.browserType],["Browser_Version",null!==(e=this._sessionContext.browserVersion)&&void 0!==e?e:""],["Store_Runtime_Id",null!==(t=this._sessionContext.extensionStoreId)&&void 0!==t?t:""],["Extension_Version",this._sessionContext.extensionVersion],["Extension_Version_Name",this._sessionContext.extensionVersionName]]):[]}addCorrelationID(e){this._sessionCorrelationId=e}sendLog(e,t,n,r,i,o,a){var s,l,d;if(!this._initialized||n===te.q.Debug)return;const u=[];this.serviceRequestId&&u.push(Le("Service_Request_Id",this.serviceRequestId,V.o.DataFieldType.Guid.valueOf())),this._sessionContext&&u.push(...this.getSessionContextDataFields());let c="",g="",h="";null===(s=this._userInfoStrategy)||void 0===s||s.execute(!1,(e=>{var t;return e&&(c=e.userId,g=null!==(t=e.tenantId)&&void 0!==t?t:"",h=e.identityProvider.toString()),e})),u.push(...Re([["Tag",t.toString()],["Tag_Hex",t.toString(16)],["Level",te.q[n]],["App_Id",this._appId],["Client_Id",this._clientId],["User_Id",c],["Tenant_Id",g],["Identity_Provider",h],["Text_Message",r],["Correlation_Id",this._sessionCorrelationId],["Data",o instanceof Error?JSON.stringify(Me(o)):o?JSON.stringify(o):void 0],["FlightsToTrack",null===(d=null===(l=this._hostSettings)||void 0===l?void 0:l.flightsToTrack)||void 0===d?void 0:d.join(";")]])),a&&qe.createFunnelContract(e,a).forEach((e=>u.push(e))),this._internalLogger.logStandaloneMetric(e,i,V.o.DiagnosticLevel.RequiredServiceData,V.o.DataCategories.NotSet,u)}static createFunnelContract(e,t){const n=Ne[t];return G.Office.System.Funnel.getFields(e,{name:e,state:n})}};We=qe=(0,u.__decorate)([(0,a._)(),(0,u.__param)(0,(0,Fe.W)(de.qy)),(0,u.__param)(1,(0,Fe.W)(de.k_)),(0,u.__param)(2,(0,Fe.W)(Be.e))],We);let Ue=class extends r.bk{constructor(){super(...arguments),this.eventNamesUsed=new Set}async initialize(){}shutDown(){for(const e of this.eventNamesUsed)try{this.off(e)}catch(e){}}on(e,t){super.on(e,t),this.eventNamesUsed.add(e)}off(e,t){try{super.off(e,t)}catch(e){}}};Ue=(0,u.__decorate)([(0,a._)()],Ue);let ze=class{constructor(e){this.registrables=e,this.initializeCalled=!1,this.shutDownCalled=!1}async initialize(){var e;if(!this.initializeCalled){this.initializeCalled=!0;for(const e of this.registrables)await e.initialize();for(const t of this.registrables)await(null===(e=t.servicesInitialized)||void 0===e?void 0:e.call(t));this.shutDownCalled=!1}}shutDown(){if(!this.shutDownCalled){this.shutDownCalled=!0;for(const e of this.registrables)e.shutDown()}}async addRegistrable(e){var t;await e.initialize(),await(null===(t=e.servicesInitialized)||void 0===t?void 0:t.call(e)),this.registrables.push(e)}async recheckRegistrables(e){var t;const n=e.getAll(ve.S),r=[];for(const e of n)this.registrables.includes(e)||(await e.initialize(),this.registrables.push(e),r.push(e));for(const e of r)await(null===(t=e.servicesInitialized)||void 0===t?void 0:t.call(e))}};var je;ze=(0,u.__decorate)([(0,a._)(),(0,u.__param)(0,(0,ke.t)(ve.S))],ze),function(e){e[e.NOT_LOADED=0]="NOT_LOADED",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.LOAD_ERROR=3]="LOAD_ERROR"}(je||(je={}));let He=class extends oe.W{constructor(e){super(),this.hostSettings=e,this.disablers=[],this.enablers=[!0]}check(){return!this.hostSettings.enableRoamingDictionary&&!this.hostSettings.enableV2RoamingDictionary}getRoamingDictionary(){return this._roamingDictionary}setRoamingDictionary(e){this._roamingDictionary=e}isReady(){return!this.check()&&void 0!==this._roamingDictionary&&this._roamingDictionary.getLoadState()===je.LOADED}processCallBackResult(e,t,n){return this._roamingDictionary=n.roamingDictionary,super.processCallBackResult(e,t,n)}};He=(0,u.__decorate)([(0,a._)(),(0,u.__param)(0,(0,Fe.W)(ge.n))],He);class Ve{constructor(e,t){this.name=e,this.version=t}}class Ge{constructor(e){this.version=e,this.name="node"}}class Qe{constructor(){this.bot=!0,this.name="bot",this.version=null}}const Ke=3,$e=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["vivaldi",/Vivaldi\/([0-9\.]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/Edg\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]];function Ze(e){const t=""!==e&&$e.reduce(((t,[n,r])=>{if(t)return t;const i=r.exec(e);return!!i&&[n,i]}),!1);if(!t)return null;const[n,r]=t;if("searchbot"===n)return new Qe;let i=r[1].split(/[._]/).slice(0,3);return i?i.length<Ke&&(i=[...i,...Je(Ke-i.length)]):i=[],new Ve(n,i.join("."))}function Je(e){const t=[];for(let n=0;n<e;n+=1)t.push("0");return t}class Xe{constructor(){this.imports=[s]}get uniqueId(){return(0,i.z)(507918415)}configureRootServices(e){e.bind(me.V).to(ze),e.bind(ce.M5).to(Ue),e.bind(ve.S).toExisting(ce.M5),e.bind(ce.zJ).toExisting(ce.M5),e.bind(fe.o).to(Ue),e.bind(ve.S).toExisting(fe.o),e.bind(ue.G).to(le.L),e.bind(We).toSelf(),e.bind(Se).toExisting(We),e.bind(Ce).toExisting(We),e.bind(pe.g).to(Pe);const t=new d.a,n=e.getOptional(de.qy);if(n){const{logGroupName:r,tenant:i,logToConsole:o,logToKusto:a}=t,s=new re({logGroupName:r,tenant:i,defaultEventName:"",logToConsole:o,logToKusto:a},n,!0);(0,ie.L)(s),e.bind(de.ZL).toValue(s)}e.bind(de.k_).toValue(t),e.bind(he.aP).toValue((()=>e.getOptional(he.iw))),e.bind(Ie.r).toSelf(),e.bind(ae.In).to(se),e.bind(ye.Zp).to(He),e.bind(we.Z).toSelf(),e.bind(Te.tq).to(Te.Gv),e.bind(_e.a).toDynamicValue((e=>{let t;const n=e.get(ge.n);return async()=>t?Promise.resolve(t):new Promise((r=>{var i,o,a,s,l,d;const u=c?Ze(c):navigator?Ze(navigator.userAgent):process.version?new Ge(process.version.slice(1)):null;var c;t={os:void 0,arch:void 0,browserType:null!==(i=null==u?void 0:u.name)&&void 0!==i?i:"",browserVersion:null!==(o=null==u?void 0:u.version)&&void 0!==o?o:null,extensionStoreId:"",languageUxId:"",extensionVersion:"",extensionVersionName:"",sessionId:null!==(s=null===(a=n.hostMetadata)||void 0===a?void 0:a.sessionId)&&void 0!==s?s:e.get(ue.G).generate(),composeSessionId:null!==(d=null===(l=n.hostMetadata)||void 0===l?void 0:l.composeSessionId)&&void 0!==d?d:e.get(ue.G).generate()},r(t)}))}))}}},64949:(e,t,n)=>{"use strict";n.d(t,{k:()=>s});var r=n(77148),i=n(81714),o=n(46249),a=n(6526);class s{get uniqueId(){return(0,a.z)(507347844)}configureRootServices(e){e.bind(i.J).to(o.k),e.bind(r.S).toExisting(i.J)}}},46914:(e,t,n)=>{"use strict";n.d(t,{F:()=>r});const r=(0,n(63837).f)("IPaneOpenState")},58964:(e,t,n)=>{"use strict";var r;n.d(t,{l:()=>r}),function(e){e.AppId="appId",e.EnableCopilotInsert="enableCopilotInsert",e.EnableCopilotRewrite="enableCopilotRewrite",e.EnableSpelling="enableSpelling",e.EnableGrammar="enableGrammar",e.EnableRefinements="enableRefinements",e.EnableSynonymsToggle="enableSynonymsToggle",e.Descriptors="descriptors",e.ProofingLanguages="proofingLanguages",e.DefaultProofingLanguageInitialized="defaultProofingLanguageInitialized",e.ProofingLanguageListInitialized="proofingLanguageListInitialized",e.HashedUserDictionary="hashedUserDictionary",e.EnableEditor="enableEditor",e.OverriddenCritiqueTypeOptions="overriddenCritiqueTypeOptions",e.OverriddenInlineEditingSettings="overriddenInlineEditingSettings",e.PaneOverriddenCritiqueTypeOptions="paneOverriddenCritiqueTypeOptions",e.StealthOverriddenCritiqueTypeOptions="stealthOverriddenCritiqueTypeOptions",e.ShowSynonyms="showSynonyms",e.DefaultLoggingLevel="defaultLoggingLevel",e.DebugMode="debugMode",e.EnableTelemetry="enableTelemetry",e.ConfigurationId="configurationId",e.ClientId="clientId",e.CritiqueValuePerLanguage="critiqueValuePerLanguage",e.EnableTextPrediction="enableTextPrediction",e.EnableCIQFlags="enableCIQFlags",e.EnableCIQMenu="enableCIQMenu",e.IsLanguageAutoDetectEnabled="isLanguageAutoDetectEnabled",e.TonalFREAccepted="tonalFREAccepted"}(r||(r={}))},79421:(e,t,n)=>{"use strict";n.d(t,{K:()=>r});const r=(0,n(63837).f)("IProofingPersistedStore")},77287:(e,t,n)=>{"use strict";n.d(t,{C:()=>r});const r=(0,n(63837).f)("IRoamingDictionaryBroker")},76230:(e,t,n)=>{"use strict";var r;n.d(t,{a:()=>i}),function(e){e.Diagnostics="Diagnostics"}(r||(r={}));class i{constructor(){this.logGroupName="EditorBx",this.tenant={tenantName:"NaturalLanguage",ariaTenantToken:"71cc1046851042108843d90e5d3ef6c1-61e5de5c-238c-4de5-95de-3b40d20ea6e5-6899",nexusTenantToken:1733},this.defaultEventName=r.Diagnostics,this.logToConsole=!1,this.logToKusto=!0}}},85899:(e,t,n)=>{"use strict";function r(e,t){var n;return!!e&&!0===(null===(n=e.find((e=>e.entityType===t)))||void 0===n?void 0:n.enabled)}function i(e,t){var n;if(e)return null===(n=e.find((e=>e.entityType===t)))||void 0===n?void 0:n.maxResults}function o(e,t,n,i){return!!(null!=e?e:[]).includes(i)||r(t,n)}n.d(t,{Z$:()=>i,f1:()=>o,i$:()=>r})},74706:(e,t,n)=>{"use strict";n.d(t,{e:()=>i,rI:()=>o});var r=n(63837);const i=(0,r.f)("ILanguageListStateStore"),o=((0,r.f)("SupportsIndividualCIQFlagDisabling"),(0,r.f)("IEditorSettingsManager"))},88670:(e,t,n)=>{"use strict";n.d(t,{d:()=>r,n:()=>o});var r,i=n(63837);!function(e){e[e.Extension=0]="Extension",e[e.OWA_New_Email=1]="OWA_New_Email",e[e.OWA_Draft_Email=2]="OWA_Draft_Email",e[e.EditorLandingPage=3]="EditorLandingPage"}(r||(r={}));const o=(0,i.f)("IHostSettings")},25503:(e,t,n)=>{"use strict";function r(e,t){return e.dataSource===t.dataSource&&e.userId===t.userId&&e.timestamp===t.timestamp}n.d(t,{G:()=>r})},96865:(e,t,n)=>{"use strict";function r(e,t){return!(!e||!t)&&e.start===t.start&&e.length===t.length&&e.priority===t.priority&&e.textInContext===t.textInContext&&e.nodeId===t.nodeId}function i(e,t){return!(e.start>=t.start+t.length||t.start>=e.start+e.length)}function o(e){const t=new Map;for(const n of e){if(!n.tileId)continue;const e=t.get(n.tileId.nodeId);e?e.push(n):t.set(n.tileId.nodeId,[n])}return t}n.d(t,{PD:()=>o,gS:()=>r,tw:()=>i})},16488:(e,t,n)=>{"use strict";n.d(t,{J:()=>i});var r=n(24941);class i{constructor(e){this.listeners={},this.captureListeners={},this.element=(0,r.E)(e)?e:new r.O(e)}addListener(e,t,n){const r=this.element.deref();if(r){if(null==n?void 0:n.capture){if(e in this.captureListeners)throw new Error(`Event ${e} previously registered.`);this.captureListeners[e]=t}else{if(e in this.listeners)throw new Error(`Event ${e} previously registered.`);this.listeners[e]=t}r.addEventListener(e,t,n)}}removeListener(e,t){const n=this.element.deref();n&&((null==t?void 0:t.capture)?e in this.captureListeners&&(n.removeEventListener(e,this.captureListeners[e],t),delete this.captureListeners[e]):e in this.listeners&&(n.removeEventListener(e,this.listeners[e]),delete this.listeners[e]))}removeAllListeners(){for(const e of Object.keys(this.listeners))this.removeListener(e);this.listeners={};for(const e of Object.keys(this.captureListeners))this.removeListener(e,{capture:!0});this.captureListeners={}}}},19718:(e,t,n)=>{"use strict";n.d(t,{z:()=>r});class r{constructor(){this.listeners={}}subscribe(e,t){var n;const r=null!==(n=this.listeners[e])&&void 0!==n?n:[];r.push(t),this.listeners[e]=r}unsubscribe(e,t){var n;let r=null!==(n=this.listeners[e])&&void 0!==n?n:[];r=r.filter((e=>e!==t)),this.listeners[e]=r}publishEvent(e,t){var n;const r=null!==(n=this.listeners[e])&&void 0!==n?n:[];for(const e of r)try{e(t)}catch(e){}}}},94084:(e,t,n)=>{"use strict";n.d(t,{L:()=>a});var r=n(30206),i=n(48828),o=n(4413);let a=class{generate(){return(0,o.A)()}};a=(0,r.__decorate)([(0,i._)()],a)},52497:(e,t,n)=>{"use strict";n.d(t,{q:()=>r});const r=(0,n(63837).f)("ICompositionEventHandler")},40245:(e,t,n)=>{"use strict";n.d(t,{G:()=>r});const r=(0,n(63837).f)("IGuidGenerator")},23132:(e,t,n)=>{"use strict";n.d(t,{J:()=>r});const r=(0,n(63837).f)("IQueryDetection")},33878:(e,t,n)=>{"use strict";n.d(t,{n:()=>r});const r=(0,n(63837).f)("IResourceUrlFormatter")},81898:(e,t,n)=>{"use strict";n.d(t,{K2:()=>s,KV:()=>l,Pe:()=>a,Sg:()=>u,ug:()=>d});var r=n(72433),i=n(64525),o=n(48717);const a=e=>{const t=e;return void 0!==t.x&&void 0!==t.y},s=e=>{const t=e;return void 0!==t.left&&void 0!==t.top&&void 0!==t.width&&void 0!==t.height};function l(e){return e?(0,o.C)(e,"HTMLElement")?e:s(e)?new i.M(e.left,e.right,e.top,e.bottom):a(e)?e:e.getBoundingClientRect():null}function d(e){if(e)return s(e)?{getBoundingClientRect:()=>{var t,n;return{x:e.left,y:e.top,top:e.top,left:e.left,bottom:null!==(t=e.bottom)&&void 0!==t?t:0,right:null!==(n=e.right)&&void 0!==n?n:0,width:e.width,height:e.height}}}:a(e)?{getBoundingClientRect:()=>({x:e.x,y:e.y,top:e.y,left:e.x,bottom:e.y,right:e.x,width:0,height:0})}:e}function u(e){if(void 0===e)return{position:"below",align:"start"};switch(e){case r.A.topLeftEdge:return{position:"above",align:"start"};case r.A.topCenter:case r.A.topAutoEdge:return{position:"above",align:"center"};case r.A.topRightEdge:return{position:"above",align:"end"};case r.A.bottomLeftEdge:return{position:"below",align:"start"};case r.A.bottomCenter:case r.A.bottomAutoEdge:return{position:"below",align:"center"};case r.A.bottomRightEdge:return{position:"below",align:"end"};case r.A.leftTopEdge:return{position:"before",align:"top"};case r.A.leftCenter:return{position:"before",align:"center"};case r.A.leftBottomEdge:return{position:"before",align:"bottom"};case r.A.rightTopEdge:return{position:"after",align:"top"};case r.A.rightCenter:return{position:"after",align:"center"};case r.A.rightBottomEdge:return{position:"after",align:"bottom"}}}},81714:(e,t,n)=>{"use strict";n.d(t,{J:()=>r});const r=(0,n(63837).f)("ITimer")},48717:(e,t,n)=>{"use strict";function r(e){var t;const n=e&&(e.commonAncestorContainer||e),r=n&&(n.ownerDocument||("[object HTMLDocument]"===Object.prototype.toString.apply(n)?n:null));return r&&(null!==(t=r.defaultView)&&void 0!==t?t:window)}function i(e,t){const n=r(e),i=n&&n[t],o=window,a=o&&o[t];return a&&e instanceof a||i&&e instanceof i}n.d(t,{C:()=>i,e:()=>r})},24839:(e,t,n)=>{"use strict";n.d(t,{c:()=>c,j:()=>d});var r=n(30206),i=n(88670),o=n(24941),a=n(63837),s=n(48828),l=n(90424);const d=(0,a.f)("ISafeWindow"),u=1e4;let c=class{constructor(e){this._hostSettings=e,this._clearanceIntervalId=void 0,this._requestedFrames=[],this._requestedIdleFrames=[]}async initialize(){this._hostSettings.enableClearingOfRequestedAnimationFrames&&this.setIntervals()}shutDown(){var e;this._clearanceIntervalId&&(clearInterval(this._clearanceIntervalId),this._clearanceIntervalId=void 0);for(const{id:t,targetWindowRef:n}of this._requestedFrames)null===(e=n.deref())||void 0===e||e.cancelAnimationFrame(t);this._requestedFrames=[]}requestAnimationFrame(e,t=window){const n=(0,o.E)(t)?t:new o.O(t),r=n.deref();if(!r)return-1;const i=r.requestAnimationFrame(e);return this._hostSettings.enableClearingOfRequestedAnimationFrames&&this._requestedFrames.push({id:i,targetWindowRef:n,time:(new Date).getTime()}),i}cancelAnimationFrame(e,t=window){const n=((0,o.E)(t)?t:new o.O(t)).deref();if(n&&(n.cancelAnimationFrame(e),this._hostSettings.enableClearingOfRequestedAnimationFrames)){const t=this._requestedFrames.findIndex((t=>t.id===e));-1!==t&&this._requestedFrames.splice(t,1)}}requestIdleCallback(e,t,n=window){const r=(0,o.E)(n)?n:new o.O(n),i=r.deref();if(!i)return-1;let a;return a="requestIdleCallback"in i?i.requestIdleCallback(e,{timeout:t}):i.setTimeout(e,t),this._hostSettings.enableClearingOfRequestedAnimationFrames&&this._requestedIdleFrames.push({id:a,targetWindowRef:r,time:(new Date).getTime()}),a}cancelIdleCallback(e,t=window){const n=((0,o.E)(t)?t:new o.O(t)).deref();n&&("requestIdleCallback"in n?n.cancelIdleCallback(e):n.clearTimeout(e))}setIntervals(){this._clearanceIntervalId=setInterval((()=>{var e;const t=(new Date).getTime();let n=this._requestedFrames.findIndex((({time:e})=>t-e<u)),r=-1===n?this._requestedFrames.splice(0,this._requestedFrames.length):this._requestedFrames.splice(0,n);if(r.length)for(const{id:t,targetWindowRef:n}of r)null===(e=n.deref())||void 0===e||e.cancelAnimationFrame(t);if(n=this._requestedIdleFrames.findIndex((({time:e})=>t-e<u)),r=-1===n?this._requestedIdleFrames.splice(0,this._requestedIdleFrames.length):this._requestedIdleFrames.splice(0,n),r.length)for(const{id:e,targetWindowRef:t}of r){const n=t.deref();n&&("requestIdleCallback"in n?n.cancelIdleCallback(e):n.clearTimeout(e))}}),u)}};c=(0,r.__decorate)([(0,s._)(),(0,r.__param)(0,(0,l.W)(i.n))],c)},24546:(e,t,n)=>{"use strict";function r(e,t){let n,r,o={firstDiffLeft:0,firstDiffRight:t.length};return e.length<t.length?(n=e,r=t):(n=t,r=e),n=n.replace(" "," "),r=r.replace(" "," "),r.startsWith(n)?(o.firstDiffLeft=n.length,o.firstDiffRight=0):r.endsWith(n)?(o.firstDiffLeft=0,o.firstDiffRight=n.length):(o=function(e,t){const n={firstDiffLeft:0,firstDiffRight:t.length};return n.firstDiffLeft=i(e,t,!0),n.firstDiffRight=i(e,t,!1),n}(e,t),o.firstDiffLeft+o.firstDiffRight>n.length&&(o.firstDiffRight=n.length-o.firstDiffLeft)),function(e,t,n){if(e.firstDiffLeft>0){const r=e.firstDiffLeft<t.length&&c(t,e.firstDiffLeft),i=e.firstDiffLeft<n.length&&c(n,e.firstDiffLeft);(r||i)&&(e.firstDiffLeft-=1)}if(e.firstDiffRight<=1)return;const r=e.firstDiffRight<t.length&&c(t,t.length-e.firstDiffRight),i=e.firstDiffRight<n.length&&c(n,n.length-e.firstDiffRight);(r||i)&&(e.firstDiffRight-=1)}(o,e,t),o.firstDiffLeft<e.length&&c(e,o.firstDiffLeft)||o.firstDiffLeft<t.length&&c(t,o.firstDiffLeft),o.firstDiffRight>0&&(o.firstDiffRight<e.length&&c(e,e.length-o.firstDiffRight)||o.firstDiffRight<t.length&&c(t,t.length-o.firstDiffRight)),o}function i(e,t,n){let r;for(r=0;r<e.length&&r<t.length;r+=1){const i=e.charCodeAt(n?r:e.length-r-1),o=t.charCodeAt(n?r:t.length-r-1);if(i!==o&&!(l(i,!0)&&l(o,!0)||u(i)&&u(o)))break}return r}let o;function a(e){try{return o||(o=new RegExp("[\\p{Extended_Pictographic}\\u{1F3FB}-\\u{1F3FF}\\u{1F9B0}-\\u{1F9B3}]","u")),o.test(e)}catch(e){return!1}}function s(e){return!!e&&/[\u0E81-\u0EDF\u0f00-\u0FFF\u1000-\u109F\u1780-\u17F9\u1980-\u19DF\u3040-\u30ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff\u0E00-\u0E7F\uff66-\uff9f]/g.test(e)}function l(e,t=!1){if(u(e))return!t;if(d(e))return!0;switch(e){case 11:case 9:return!0}return!1}function d(e){switch(e){case 12288:case 8194:case 8195:case 8197:case 32:case 160:return!0}return!1}function u(e){switch(e){case 13:case 10:case 65532:return!0}return!1}function c(e,t){return e.charCodeAt(t)>=56320&&e.charCodeAt(t)<=57343}n.d(t,{CC:()=>r,Fc:()=>h,Yv:()=>l,_1:()=>a,tF:()=>s,xC:()=>d});const g="0123456789";function h(e){return function(e){const t=e.toString();return t.toLowerCase()!==t.toUpperCase()}(e)||function(e){return g.includes(e)}(e)}},52669:(e,t,n)=>{"use strict";n.d(t,{Ze:()=>l,cg:()=>d,jh:()=>o,oA:()=>s,q4:()=>i,sh:()=>a});var r=n(63837);const i=(0,r.f)("TargetRenderElement"),o=(0,r.f)("TargetDocument"),a=(0,r.f)("TargetWindow"),s=(0,r.f)("TargetRenderElementFactory"),l=(0,r.f)("TargetDocumentFactory"),d=(0,r.f)("TargetWindowFactory")},84002:(e,t,n)=>{"use strict";n.d(t,{m:()=>v,r:()=>m});var r=n(30206),i=n(63837),o=n(48828),a=n(90424),s=n(59834),l=n(88670),d=n(52996),u=n(58964),c=n(79421),g=n(24839),h=n(19374),p=n(6395),f=n(93398);const v=(0,i.f)("IE2eMetric");let m=class{constructor(e,t,n,r){var i;this._logger=e,this._hostSettings=t,this._proofingStore=n,this._eventName="End2EndTelemetry",this._alEventName="IsAL",this._performanceApiGarbageCollectorIntervalInMs=1e4,this._logToTelemetry=e=>{const t=this._logger.getNewActivity(this._eventName,s.o.SamplingPolicy.CriticalExperimentation);if(!t)return;const n=this._proofingStore.getCachedEntry(u.l.ProofingLanguages).storeEntryValue;t.dataFields.push(...e.map((e=>(0,f.n)(e.name,e.duration,void 0,s.o.DataFieldType.Double.valueOf())))),t.dataFields.push(...(0,f.W)([this._alEventName,this._isAlEnabled],[p.o.NumProofingLanguages,n.length])),t.success=!0,t.endNow()},this._isAlEnabled=!0===this._hostSettings.enableOrchestration&&!0===(null===(i=this._hostSettings.orchestratorSettings)||void 0===i?void 0:i.enableAugLoop),this.metric=new h.J(e,r,this._eventName,this._performanceApiGarbageCollectorIntervalInMs,this._logToTelemetry)}startEntry(e){this._hostSettings.enableE2eMetric&&this.metric.startEntry(e)}addMeasure(e,t,n){this._hostSettings.enableE2eMetric&&this.metric.addMeasure(e,t,n)}commitEntry(e,t=this._eventName){this._hostSettings.enableE2eMetric&&this.metric.commitEntry(e,t)}setOnTimeout(e){this.metric.setOnTimeout(e)}};m=(0,r.__decorate)([(0,o._)(),(0,r.__param)(0,(0,a.W)(d.g)),(0,r.__param)(1,(0,a.W)(l.n)),(0,r.__param)(2,(0,a.W)(c.K)),(0,r.__param)(3,(0,a.W)(g.j))],m)},23039:(e,t,n)=>{"use strict";n.d(t,{u:()=>r});const r=(0,n(63837).f)("IOaMetric")},19374:(e,t,n)=>{"use strict";n.d(t,{J:()=>d});var r,i=n(30206),o=n(65017),a=n(20399),s=n(59834),l=n(48828);let d=r=class{constructor(e,t,n,r,i,o){this._logger=e,this._safeWindow=t,this._eventName=n,this._performanceApiGarbageCollectorIntervalInMs=r,this._logToTelemetry=i,this._onTimeout=o,this._performanceMarksInGarbageCollection=[],this._measuresNames=new Map,this._performanceMarksInGCCorrelationKeysHistory=new Map}startEntry(e,t,n){const[r]=this._getPerformanceEntryNames(e);let i=window.performance.mark(r);if(void 0===i){const e=window.performance.getEntriesByName(r);if(1!==e.length)return void this._logger.logEvent(541099735,o.f.TelemetryError,a.q.Error,`Unable to find performance entry by name: ${r}`,s.o.SamplingPolicy.CriticalExperimentation);i=e[0]}this._performanceMarksInGarbageCollection.push(i),t&&this._performanceMarksInGCCorrelationKeysHistory.set(i.name,{correlationKeys:t,customData:n}),this._scheduleGarbageCollection(!1)}_getPerformanceEntryNames(e,t=this._eventName){const n=`${t}-${e}`;return[e,`${n}--${r.END_SUFFIX}`,n]}addMeasure(e,t,n){const[r,i,l]=this._getPerformanceEntryNames(e,t);if(0!==window.performance.getEntriesByName(r).length)try{if(window.performance.mark(i),window.performance.measure(l,r,i),this._measuresNames.set(e,[...this._measuresNames.get(e)||[],{name:t,duration:window.performance.getEntriesByName(l)[0].duration}]),window.performance.clearMarks(i),window.performance.clearMeasures(l),n){const e=this._performanceMarksInGCCorrelationKeysHistory.get(r);if(null==e?void 0:e.correlationKeys){const t=e.correlationKeys,i=e.customData;this._performanceMarksInGCCorrelationKeysHistory.set(r,{correlationKeys:t,customData:Object.assign(Object.assign({},i),n)})}}}catch(e){this._logger.logEvent(523646680,o.f.TelemetryError,a.q.Error,`Error while adding a checkpoint measure to a telemetry entry, error: ${e}`,s.o.SamplingPolicy.CriticalExperimentation)}}commitEntry(e,t=this._eventName,n){const[r,i,l]=this._getPerformanceEntryNames(e,t),d=window.performance.getEntriesByName(r);if(0!==d.length)try{window.performance.mark(i),window.performance.measure(l,r,i),this._measuresNames.set(e,[...this._measuresNames.get(e)||[],{name:t,duration:window.performance.getEntriesByName(l)[0].duration}]);const o=this._performanceMarksInGCCorrelationKeysHistory.get(r);this._logToTelemetry(this._measuresNames.get(e)||[],null==o?void 0:o.correlationKeys,null==o?void 0:o.customData,n),window.performance.clearMarks(r),window.performance.clearMarks(i),window.performance.clearMeasures(l),this._measuresNames.delete(e),this._removeGCTracedPerformanceMark(d[0])}catch(e){this._logger.logEvent(521417349,o.f.TelemetryError,a.q.Error,`Error while commiting a telemetry entry, error: ${e}`,s.o.SamplingPolicy.CriticalExperimentation)}}setOnTimeout(e){this._onTimeout=e}_clearAndReschedule(e){const t=Date.now(),n=[],r=this._performanceMarksInGarbageCollection.filter((r=>{const i=window.performance.timeOrigin+r.startTime;if(e&&!e.didTimeout&&0===e.timeRemaining()||t-i<this._performanceApiGarbageCollectorIntervalInMs)return!0;if(this._onTimeout){const e=this._performanceMarksInGCCorrelationKeysHistory.get(r.name)||{};e.isTimeout=!0,this._onTimeout(e.logicalId,e)}return n.push(r),window.performance.clearMarks(r.name),window.performance.clearMeasures(r.name),this._measuresNames.delete(r.name),!1}));for(const e of n)this._removeGCTracedPerformanceMark(e);this._garbageCollectionScheduler=void 0,r.length>0&&this._scheduleGarbageCollection(!0)}_removeGCTracedPerformanceMark(e){const t=this._performanceMarksInGarbageCollection.indexOf(e);t>=0&&this._performanceMarksInGarbageCollection.splice(t,1),this._performanceMarksInGCCorrelationKeysHistory.has(e.name)&&this._performanceMarksInGCCorrelationKeysHistory.delete(e.name)}_scheduleGarbageCollection(e){this._garbageCollectionScheduler||(!e&&"requestIdleCallback"in window?this._garbageCollectionScheduler=this._safeWindow.requestIdleCallback((e=>this._clearAndReschedule(e)),this._performanceApiGarbageCollectorIntervalInMs):this._garbageCollectionScheduler=window.setTimeout((()=>{this._clearAndReschedule()}),this._performanceApiGarbageCollectorIntervalInMs))}};d.END_SUFFIX="end",d=r=(0,i.__decorate)([(0,l._)()],d)},93398:(e,t,n)=>{"use strict";n.d(t,{W:()=>o,n:()=>i});var r=n(59834);function i(e,t,n,i){return{name:e,value:t,dataType:(null!=i?i:"boolean"==typeof t)?r.o.DataFieldType.Boolean.valueOf():"number"==typeof t?r.o.DataFieldType.Int64.valueOf():r.o.DataFieldType.String.valueOf(),classification:null!=n?n:r.o.DataClassification.EssentialServiceMetadata}}function o(...e){return e.map((([e,t,n,r])=>i(e,t,n,r)))}},7738:(e,t,n)=>{"use strict";function r(e,t,n,r){return i((n=>e.requestAnimationFrame(n,t)),n,r)}function i(e,t,n){let r=!1,o=!1;const a=[];let s=!1;return()=>new Promise((async l=>{if("Immediately"===n){if(!r){r=!0;try{await t()}catch(e){}e((()=>{r=!1,l()}))}}else r?(s&&(o=!0),a.push(l)):(r=!0,e((async()=>{s=!0;try{await t()}catch(e){}s=!1,r=!1,l();for(const e of a)e();o&&(o=!1,i(e,t,n))})))}))}n.d(t,{ek:()=>i,hQ:()=>r})},23:(e,t,n)=>{"use strict";n.d(t,{_:()=>i});var r=n(7738);class i{constructor(e){this.targetWindow=e,this.timeoutIds=[]}throttle(e,t,n){return(0,r.ek)((e=>{var n;const r=null===(n=this.targetWindow.deref())||void 0===n?void 0:n.setTimeout(e,t);r&&this.timeoutIds.push(r)}),e,n)}throttleUntilNextAnimationFrameAndAdditionalTime(e,t,n,i){return(0,r.ek)((t=>e.requestAnimationFrame((()=>{var e;const r=null===(e=this.targetWindow.deref())||void 0===e?void 0:e.setTimeout(t,n);r&&this.timeoutIds.push(r)}),this.targetWindow)),t,i)}dispose(){const e=this.targetWindow.deref();if(void 0!==e)for(const t of this.timeoutIds)e.clearTimeout(t);this.timeoutIds=[]}}},24941:(e,t,n)=>{"use strict";var r,i;n.d(t,{E:()=>s,O:()=>a});class o{constructor(e){this[r]="WeakRef",this.weakMap=new WeakMap,this.weakMap.set(this,e)}deref(){return this.weakMap.get(this)}}r=Symbol.toStringTag;class a{constructor(e){this[i]="WeakRef","object"==typeof n.g&&n.g&&void 0===n.g.WeakRef?this.weakRef=new o(e):this.weakRef=new n.g.WeakRef(e)}deref(){return this.weakRef.deref()}}function s(e){return"WeakRef"===e[Symbol.toStringTag]}i=Symbol.toStringTag},46249:(e,t,n)=>{"use strict";n.d(t,{k:()=>a});var r=n(30206),i=n(48828);class o{constructor(e){this._customWindow=e,this._timeouts=new Map,this._intervals=new Map}get targetWindow(){var e;return null!==(e=this._customWindow)&&void 0!==e?e:window}clearTimer(e){const t=this._timeouts.get(e);t&&(this.targetWindow.clearTimeout(t),this._timeouts.delete(e));const n=this._intervals.get(e);n&&(this.targetWindow.clearInterval(n),this._intervals.delete(e))}setInterval(e,t,n){this.clearTimer(e);const r=this.targetWindow.setInterval(t,n);return this._intervals.set(e,r),e}setIntervalWithDelay(e,t,n,r){this.clearTimer(e);const i=this.targetWindow.setTimeout((()=>{t();const r=this.targetWindow.setInterval(t,n);this._intervals.set(e,r)}),r);return this._timeouts.set(e,i),e}setTimeout(e,t,n){this.clearTimer(e);const r=this.targetWindow.setTimeout(t,n);return this._timeouts.set(e,r),e}async initialize(){}shutDown(){for(const e of this._timeouts.values())this.targetWindow.clearTimeout(e);for(const e of this._intervals.values())this.targetWindow.clearInterval(e);this._intervals.clear(),this._timeouts.clear()}}let a=class{constructor(){this._timer=new o}clearTimer(e){this._timer.clearTimer(e)}setInterval(e,t,n){return this._timer.setInterval(e,t,n)}setIntervalWithDelay(e,t,n,r){return this._timer.setIntervalWithDelay(e,t,n,r)}setTimeout(e,t,n){return this._timer.setTimeout(e,t,n)}async initialize(){}shutDown(){this._timer.shutDown()}};a=(0,r.__decorate)([(0,i._)()],a)},34241:(e,t,n)=>{"use strict";n.d(t,{ZL:()=>o,k_:()=>i,qy:()=>a});var r=n(63837);(0,r.f)("IOnCanvasKpiHelper");const i=(0,r.f)("ILoggerSettings"),o=(0,r.f)("IEditorSdkLogger"),a=((0,r.f)("IKpiTracker"),(0,r.f)("TelemetrySink"))},20688:(e,t,n)=>{"use strict";var r,i;n.d(t,{M:()=>r,s:()=>i}),function(e){e.WebSiteProvedOnce="WebSiteProvedOnce",e.ActionCritiqueSettingsChange="ActionCritiqueSettingsChange",e.TonalFRE="TonalFRE",e.ActionInlineSettingChange="ActionInlineSettingChange"}(r||(r={})),function(e){e.MutationError="MutationError",e.UpdateCritiqueException="RunTimeErrors.UpdateCritiqueException"}(i||(i={}))},98045:(e,t,n)=>{"use strict";n.d(t,{B:()=>r});const r=(0,n(63837).f)("IHostModelPersistedStore")},77789:(e,t,n)=>{"use strict";function r(e,t){e.isApplying||e.suggestions[0].text&&(null==t||t.addWordToIgnoreList(e.suggestions[0].text,!0))}n.d(t,{yf:()=>r})},29747:(e,t,n)=>{"use strict";n.d(t,{D:()=>r});const r=(0,n(63837).f)("ICritiqueFilters")},35715:(e,t,n)=>{"use strict";n.d(t,{A_:()=>y,MG:()=>m,W:()=>u,dP:()=>f,dt:()=>h,ht:()=>c,qB:()=>g,r:()=>d,r6:()=>p});var r=n(30206),i=n(67005),o=n(59088),a=n(44502),s=n(63837),l=n(48828);function d(e){const t=[i.L9.ContextualSpelling,i.L9.WrongSpelling];return!!e&&e.typeId!==i.L9.Synonyms&&(e.priority===i.bx.High||!!e.typeId&&t.includes(e.typeId))}function u(e){return!!e&&e.typeId===i.L9.TopicSuggestion}function c(e){return!0===("number"==typeof e.supportedActions?(0,o.z)(e.supportedActions):e.supportedActions).delete}function g(e){const t="number"==typeof e.action?(0,a.fO)(e.action):e.action;return!0===t.changeAll||!0===t.changeOnce||!0===t.autoCorrect||!0===t.personalizedAutoCorrect}function h(e){return!!e&&c(e)&&!e.suggestions.some((e=>g(e)))}function p(e){return(null==e?void 0:e.typeId)===i.L9.TonalRewrite}function f(e){return!0===("number"==typeof e.action?(0,a.fO)(e.action):e.action).personalizedAutoCorrect}function v(e){for(const t of e.suggestions)if(4===t.action)return t}function m(e){for(const t of e.suggestions)if(!0===t.action.autoCorrect)return t}function y(e){return!!v(e)}(0,s.f)("ICritiqueInterpreter");let _=class{isSpellingCritique(e){return!!e&&d({priority:e.priority,typeId:(0,i.e3)(e.typeId)})}isTopicSuggestionCritique(e){return!!e&&u({typeId:(0,i.e3)(e.typeId)})}isDeleteActionAvailable(e){return c(e)}isChangeActionAvailable(e){return g(e)}isRepeatedWord(e){return h(e)}isRewrite(e){return p({typeId:(0,i.e3)(e.typeId)})}isPersonalized(e){return f(e)}hasAtLeastOneSynonym(e){return function(e){return e.suggestions.some((e=>function(e){return!!e.description&&!e.description.match(/\[(.*)\]/g)}(e)))}(e)}getAutoCorrectionSuggestion(e){return v(e)}};_=(0,r.__decorate)([(0,l._)()],_)},44957:(e,t,n)=>{"use strict";n.d(t,{W:()=>r});const r=(0,n(63837).f)("IDisableCritiqueHandler")},38663:(e,t,n)=>{"use strict";n.d(t,{g:()=>r});const r=(0,n(63837).f)("IEnabledCritiqueTypes")},98872:(e,t,n)=>{"use strict";n.d(t,{D:()=>r});const r=(0,n(63837).f)("IEnabledCritiqueTypesSetter")},94453:(e,t,n)=>{"use strict";n.d(t,{M:()=>i,g:()=>o});var r=n(63837);const i=(0,r.f)("IFeedbackStore"),o=(0,r.f)("IFeedbackStoreFactory")},47255:(e,t,n)=>{"use strict";n.d(t,{y:()=>r});const r=(0,n(63837).f)("IIndicatorStore")},87835:(e,t,n)=>{"use strict";n.d(t,{M:()=>r});const r=(0,n(63837).f)("IPaneOnlyEnabledCritiqueTypes")},32323:(e,t,n)=>{"use strict";n.d(t,{S:()=>r});const r=(0,n(63837).f)("IShadowElementsStore")},7971:(e,t,n)=>{"use strict";n.d(t,{Ey:()=>a,mq:()=>r,nz:()=>i});var r,i,o=n(63837);!function(e){e[e.Days=0]="Days",e[e.Suggestions=1]="Suggestions"}(r||(r={})),function(e){e[e.Visible=0]="Visible",e[e.Hidden=1]="Hidden"}(i||(i={}));const a=(0,o.f)("IUpsellStore")},32133:(e,t,n)=>{"use strict";n.d(t,{s:()=>r});const r=(0,n(63837).f)("IWordDictionary")},90077:(e,t,n)=>{"use strict";n.d(t,{G:()=>r});const r=(0,n(63837).f)("INodePoller")},14193:(e,t,n)=>{"use strict";n.d(t,{w:()=>r});const r=(0,n(63837).f)("IProofingDom")},72040:(e,t,n)=>{"use strict";n.d(t,{j:()=>r});const r=(0,n(63837).f)("ITileNodeReader")},79928:(e,t,n)=>{"use strict";n.d(t,{k:()=>r});const r=(0,n(63837).f)("IHostModelSettings")},98937:(e,t,n)=>{"use strict";n.d(t,{M:()=>r});const r=(0,n(63837).f)("INodeTraverser")},11966:(e,t,n)=>{"use strict";n.d(t,{b:()=>r});const r=(0,n(63837).f)("IParagraphTextExtractor")},13713:(e,t,n)=>{"use strict";n.d(t,{$:()=>i});var r=n(48416);function i(e){return(null==e?void 0:e.nodeType)===r.Z.TileNode&&!!e.element&&!!e.children&&e.children.every((e=>e.nodeType===r.Z.ParagraphNode&&void 0!==e.element&&"offset"in e.element&&"span"in e.element))}},48416:(e,t,n)=>{"use strict";var r;n.d(t,{Z:()=>r}),function(e){e[e.OutlineNode=0]="OutlineNode",e[e.TerminalNode=1]="TerminalNode",e[e.TileNode=2]="TileNode",e[e.ParagraphNode=3]="ParagraphNode"}(r||(r={}))},47436:(e,t,n)=>{"use strict";n.d(t,{f:()=>l,l:()=>d});var r=n(30206),i=n(40245),o=n(90424),a=n(14193),s=n(48416);let l=class{constructor(e,t,n,r){this._guidGenerator=e,this._proofingDom=t,this.eventSeqId=0,this.nodeType=s.Z.ParagraphNode,this.id=this._guidGenerator.generate(),this.children=void 0,this.element=n,this.parent=r,this._proofingDom.registerNode(this)}retire(){this.parent=void 0,this._proofingDom.unregisterNode(this)}move(e,t){return this._proofingDom.unregisterNode(this),e&&(this.element=e),t&&(this.parent=t),this.id=this._guidGenerator.generate(),this._proofingDom.registerNode(this),this}resetState(){}};function d(e){var t;return(null==e?void 0:e.nodeType)===s.Z.ParagraphNode&&void 0!==e.element&&"offset"in e.element&&"span"in e.element&&(null===(t=e.parent)||void 0===t?void 0:t.nodeType)===s.Z.TileNode&&!!e.parent.element&&!!e.parent.children}l=(0,r.__decorate)([(0,r.__param)(0,(0,o.W)(i.G)),(0,r.__param)(1,(0,o.W)(a.w))],l)},38383:(e,t,n)=>{"use strict";n.d(t,{o:()=>u});var r=n(30206),i=n(98937),o=n(14193),a=n(48828),s=n(90424),l=n(30225),d=n(47436);let u=class{constructor(e,t){this._proofingDom=e,this._tileNodeTraverser=t}getParagraphText(e){let t=null;if(t="string"==typeof e?this._proofingDom.findParagraphNode(e):e,(0,d.l)(t)){const e=t.parent.plainText,n=t.element.offset,r=t.element.span,i=t.element.span?n+r:void 0;return e.substring(n,i).replace(/\u00A0/g," ")}}getQueryString(e,t,n){const r=this.getParagraphText(e);return r?r.substring(t.start+(n?0:void 0===t.prefix?1:t.prefix.length),t.start+t.length):0===t.start&&0===t.length&&""===t.prefix?"":void 0}getTextBetween(e,t,n=0,r=-1){var i;let o=null;o="string"==typeof e?this._proofingDom.findParagraphNode(e):e;let a=null;if(a="string"==typeof t?this._proofingDom.findParagraphNode(t):t,(0,d.l)(o)&&(0,d.l)(a)){if(o.parent.element===a.parent.element)return this.getSubsetOfParagraph(o.parent,o.element.offset+n,a.element.offset+(-1===r?a.element.span:r));{let e,t=this.getSubsetOfParagraph(o.parent,o.element.offset+n,void 0)+"\n",s=o.parent;do{if(e=null===(i=this._tileNodeTraverser)||void 0===i?void 0:i.findNextTileNode(s),!e||"#tail#"===e)return;s=e,t+=this.getSubsetOfParagraph(s,0,s.id===a.parent.id?a.element.offset+(-1===r?a.element.span:r):void 0)+(s.id===a.parent.id?"":"\n")}while(s.id!==a.parent.id);return t}}}getSubsetOfParagraph(e,t,n){return e.plainText.substring(t,n).replace(/\u00A0/g," ")}};u=(0,r.__decorate)([(0,a._)(),(0,r.__param)(0,(0,s.W)(o.w)),(0,r.__param)(1,(0,s.W)(i.M)),(0,r.__param)(1,(0,l.l)())],u)},43900:(e,t,n)=>{"use strict";n.d(t,{d:()=>r});const r=(0,n(63837).f)("ITileContent")},98418:(e,t,n)=>{"use strict";n.d(t,{n:()=>h});var r=n(30206),i=n(19718),o=n(46249),a=n(85230),s=n(81714),l=n(79928),d=n(63837),u=n(48828),c=n(90424),g=n(30225);const h=(0,d.f)("ITextEventPublisher");let p=class extends i.z{constructor(e,t){super(),this._settings=e,this._timer=null!=t?t:new o.k}dispose(){return this._timer.shutDown(),Promise.resolve()}publishTextChangeEvent(e,t){this.publishEvent("textChange",{data:e,messageType:t}),this.scheduleSendIdleTextEvent(e,t)}publishTextStyleEvent(){this.publishEvent("styleChange",{})}scheduleSendIdleTextEvent(e,t){if(this._settings.enableTileNodeAutoReconciliation&&0!==e.length)for(const n of e)n.mutationChangeType!==a.Q0.Code&&(this._timer.clearTimer(n.tileNodeId),this._timer.setTimeout(n.tileNodeId,(()=>{this.publishEvent("textChange",{data:[{tileNodeId:n.tileNodeId,text:n.text,mutationChangeType:a.Q0.Code,rehydrateCritiques:!0,idleReconcileTrigger:!0,optimizedRehydrationEnabled:n.optimizedRehydrationEnabled,useDirtyParagraphReconciliation:this._settings.useDirtyParagraphReconciliation}],messageType:t}),this._timer.clearTimer(n.tileNodeId)}),this._settings.reconcileTileNodeTime))}};p=(0,r.__decorate)([(0,u._)(),(0,r.__param)(0,(0,c.W)(l.k)),(0,r.__param)(1,(0,g.l)()),(0,r.__param)(1,(0,c.W)(s.J))],p)},85278:(e,t,n)=>{"use strict";function r(e){let t=e.parent;for(;null==t?void 0:t.parent;)t=t.parent;return t}n.d(t,{F:()=>r})},12500:(e,t,n)=>{"use strict";n.d(t,{q:()=>i});var r=n(78175);function i(e,t){var n;const i=t&&e.getContainingElement(t);if(i)return null!==(n=(0,r.m)(i))&&void 0!==n?n:i}},84309:(e,t,n)=>{"use strict";function r(e){var t,n,r,i,o,a,s;const{oaSettings:l,serviceSettings:d,hostMetadata:u}=e,{flagAnnotationSettings:c,nudge:g,predictions:h}=null!=d?d:{};return{ecc:{enabled:null!==(t=null==l?void 0:l.isContextualCardEnabled)&&void 0!==t&&t,entities:null==l?void 0:l.entitiesEnabled,bestMatch:null==l?void 0:l.bestMatchConfig,scopes:(null==l?void 0:l.scopesConfig)&&{entities:l.scopesConfig.entities,enabled:l.scopesConfig.enabled,maxResults:l.scopesConfig.maxResults}},flag:{enabled:null!==(n=null==c?void 0:c.enabled)&&void 0!==n&&n,entities:null!==(r=null==c?void 0:c.entityConfigs)&&void 0!==r?r:[]},nudge:{enabled:null!==(i=null==g?void 0:g.enabled)&&void 0!==i&&i,entities:null!==(o=null==g?void 0:g.entityConfigs)&&void 0!==o?o:[]},prediction:{enabled:null!==(a=null==h?void 0:h.enabled)&&void 0!==a&&a,entities:null!==(s=null==h?void 0:h.entityConfigs)&&void 0!==s?s:[],enableMiddleOfSentencePredictions:null==h?void 0:h.allowMiddleOfSentencePredictions,enableMultiPredict:null==h?void 0:h.enableMultiPredict},metadata:{appScenario:null==u?void 0:u.appScenario}}}n.d(t,{e:()=>r})},86225:(e,t,n)=>{"use strict";n.d(t,{T:()=>r});const r=(0,n(63837).f)("IClientSubscriber")},75181:(e,t,n)=>{"use strict";n.d(t,{J:()=>o,a:()=>i});var r=n(63837);const i=(0,r.f)("AugloopSessionFactory"),o=(0,r.f)("IOrchestrator")},93948:(e,t,n)=>{"use strict";n.d(t,{P:()=>i});var r=n(63837);const i=(0,r.f)("IALSessionFromHost");(0,r.f)("ProofingSettingsRequestTypes")},49208:(e,t,n)=>{"use strict";n.d(t,{J:()=>O});var r=n(86225),i=n(30206),o=n(41567),a=(function(){function e(t){o.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ControlSignal"},e.getBaseTypes=function(){return["AugLoop_Signals_Signal"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_InteractionModeSignal"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ControlSignal","AugLoop_Signals_Signal"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),s=function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_StartupSignal"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ControlSignal","AugLoop_Signals_Signal"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),l=function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ClientConfigSignal"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ControlSignal","AugLoop_Signals_Signal"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),d=(function(){function e(t){o.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ShutdownSignal"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ControlSignal","AugLoop_Signals_Signal"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),n(48717));const u=e=>{var t,n,r,i;return(null===(t=null==e?void 0:e.oaSettings)||void 0===t?void 0:t.isContextualCardEnabled)||(null===(n=null==e?void 0:e.oaSettings)||void 0===n?void 0:n.enablePredictions)||(null===(i=null===(r=null==e?void 0:e.serviceSettings)||void 0===r?void 0:r.flagAnnotationSettings)||void 0===i?void 0:i.enabled)};var c=n(41260),g=n(16488),h=n(52996),p=n(88670),f=n(23039),v=n(23132),m=n(52669),y=n(14193),_=n(75943),b=n(28356);class C{constructor(e,t){this._hostEmitter=e,this._logger=t,this._activationTokens=[]}async activateAnnotationsBase(e,t,n){if(e)if(this._activationTokens.length)this._logger.logDiagnostics(`Trying to activate ${this.annotationListenerType} annotation which is already initialized.`);else{this._session=e,this._sessionId=t;try{const e=await Promise.all(n());this._activationTokens=e.map((e=>e.token))}catch(e){this._logger.error(508044171,`Trying to activate ${this.annotationListenerType} failed due to an exception.`,e)}}else this._logger.logDiagnostics(`Trying to activate ${this.annotationListenerType} annotation with no session.`)}async deactivateAnnotations(e){if(!e||!this._activationTokens.length)return!1;try{const t=await Promise.all(this._activationTokens.map((t=>e.releaseAnnotation(t))));return this._activationTokens=[],t.every(Boolean)}catch(e){return this._logger.error(508044170,`Trying to deactivate ${this.annotationListenerType} failed due to an exception.`,e),!1}}async updateAnnotationActivationConfig(e){this._session?this._activationTokens.length?e&&this._activationTokens.map((t=>{var n;return null===(n=this._session)||void 0===n?void 0:n.updateAnnotationConfig(t,e)})):this._logger.logDiagnostics(`${this.annotationListenerType}: Trying to update annotation config without a valid token.`):this._logger.logDiagnostics(`${this.annotationListenerType}: Trying to update annotation config without a valid session object.`)}}var S=n(84382),T=n(48574),I=n(26017),w=n(62070),E=n(48741);const x={[E.i.Success]:"200",[E.i.NoResults]:"200",[E.i.Cancelled]:"400",[E.i.Timeout]:"408",[E.i.UnexpectedError]:"500",[E.i.EarlyExit]:"200"};class A extends C{constructor(e,t,n,r,i){super(e,t),this._hostEmitter=e,this._logger=t,this._e2eMetric=n,this._queryDetection=r,this._hostSettings=i,this.annotationListenerType="OAAnnotationListener",this._onAnnotationResult=e=>{var t,n,r,i,o,a,s,l,d,u,g,h,p,f,v,m,y,C,E,A,D,k,F;const P=null===(t=e.items[0])||void 0===t?void 0:t.body;if(!P)return;let N;const B=_.h.getTypeNameFor(e);switch(B){case b.Xr.getTypeName():N=w.G.NewData;break;case b.fZ.getTypeName():N=w.G.ChangeData;break;case b.n4.getTypeName():N=w.G.RemoveData;break;default:return void this._logger.logDiagnostics("[OAAnnotationListener]: Unexpected annotation operation",{opType:B})}const O=null!==(n=e.parentPath[e.parentPath.length-1])&&void 0!==n?n:"",R=Number.parseInt(null!==(r=e.parentRevId)&&void 0!==r?r:"0",10);if(S.gh.typeGuard(P)){if(T.Yd.typeGuard(P.result)){if(null===(a=null===(o=null===(i=this._hostSettings)||void 0===i?void 0:i.serviceSettings)||void 0===o?void 0:o.predictions)||void 0===a?void 0:a.augloopPredictionsDisabled)return;const t=P.result;if(this.isValidSuggestionType(t.entityType)){let n=t.entityType;(n===I.c.People&&!t.entityResults||n===I.c.External)&&(n=I.c.PIM);const r=Object.assign(Object.assign({tileId:O,tileVersion:R,annotationId:e.items[0].id},t),{entityType:n,startIndex:t.startIndex>0?t.startIndex:(null!==(l=null===(s=t.context)||void 0===s?void 0:s.length)&&void 0!==l?l:0)+t.startIndex});this._hostEmitter.emit(c.pD.predictionTriggered,{address:this._sessionId,message:{messageType:N,data:r}})}}else if(T.aO.typeGuard(P.result)){const t=P.result;this.isValidSuggestionType(t.entityType)&&this._hostEmitter.emit(c.pD.nudgeTriggered,{address:this._sessionId,message:{messageType:N,data:Object.assign(Object.assign({},t),{tileId:O,tileVersion:R,annotationId:e.items[0].id,entityType:t.entityType})}})}}else if(S.Zx.typeGuard(P)||S.$g.typeGuard(P)){const t=null===(u=null===(d=this._queryDetection)||void 0===d?void 0:d.getCurrentQuery())||void 0===u?void 0:u.queryRange,n={logicalId:P.logicalId||(null===(g=this._queryDetection)||void 0===g?void 0:g.getCurrentQueryLogicalId())||"",conversationId:P.conversationId||(null===(h=this._queryDetection)||void 0===h?void 0:h.getCurrentQueryConversationId())||"",isEmptyQuery:!t||t.length===(null!==(f=null===(p=t.prefix)||void 0===p?void 0:p.length)&&void 0!==f?f:1),isTimeout:!1,queryLength:(null==t?void 0:t.length)?t.length-(null!==(m=null===(v=t.prefix)||void 0===v?void 0:v.length)&&void 0!==m?m:1):0},r=(e=>{if(S.$g.typeGuard(e)){const t=e;if(t.instrumentation&&t.instrumentation.length>0)return t.instrumentation[0].TraceId}})(P),i=r?Object.assign({TraceId:r||""},"number"==typeof P.status?{status:(L=P.status,x[L])}:{}):void 0;let o,a,s;if(this._e2eMetric.addMeasure(n.logicalId,"OAAnnotationResultsReceived",i),S.$g.typeGuard(P)){s=P.resultSummary;const e=P;for(const t of e.entityResults)if((null===(E=null===(C=null===(y=this._hostSettings)||void 0===y?void 0:y.oaSettings)||void 0===C?void 0:C.bestMatchConfig)||void 0===E?void 0:E.enabled)&&(null===(A=e.treatments)||void 0===A?void 0:A.bestMatchEntries))for(const n of e.treatments.bestMatchEntries)for(const e of t.entities)e.entityId===n.entityId&&(e.isBestMatch=!0);o=e.entityResults,a=e.entityResults.map((e=>e.modelInfo.elapsedTime)).filter(Number.isInteger).reduce(((e,t)=>e>t?e:t),0)}else{let e=[];try{(null===(F=null===(k=null===(D=this._hostSettings)||void 0===D?void 0:D.oaSettings)||void 0===k?void 0:k.bestMatchConfig)||void 0===F?void 0:F.enabled)&&(e=>{const t=e.results.findIndex((e=>e.bestMatchEntries&&e.bestMatchEntries.length>0));if(t>-1){const n=e.results[t],r=n.bestMatchEntries;r&&r.length>0&&n.results.forEach((e=>{e.isBestMatch=r.findIndex((t=>t.entityId===e.ReferenceId))>-1}))}})(P);for(const t of P.results)e=e.concat(t.results)}catch(e){this._logger.logDiagnostics("[OAAnnotationListener] unexpected annotation item format")}const t=new Map;for(const n of e){const e=t.get(n.entityType);e?e.entities.push(n):t.set(n.entityType,{entities:[n],entityType:n.entityType})}o=Array.from(t.values())}this._hostEmitter.emit(c.pD.oaRankedAnnotations,{address:this._sessionId,message:{messageType:N,data:{tileId:O,tileVersion:R,annotationId:e.items[0].id,results:o,resultStatus:P.status,resultSummary:s,queryCorrelationKeys:n,latency:a}}})}else S.Vn.typeGuard(P)&&this._hostEmitter.emit(c.pD.oaFlagAnnotationsTriggered,{address:this._sessionId,message:{messageType:N,data:{tileId:O,tileVersion:R,annotationId:e.items[0].id,results:P.results}}});var L},this.isValidSuggestionType=e=>Object.values(I.c).includes(e)}async activateAnnotations(e,t){await super.activateAnnotationsBase(e,t,(()=>{var t,n,r,i;if(!e)return[];const o=[S.Zx];return(null===(n=null===(t=this._hostSettings)||void 0===t?void 0:t.oaSettings)||void 0===n?void 0:n.enableOaClient)?o.push(S.c$):o.push(S.os),(null===(i=null===(r=this._hostSettings)||void 0===r?void 0:r.oaSettings)||void 0===i?void 0:i.enableOaClientPredictions)?o.push(S.Nh):o.push(S.Vm),o.push(S.Vn),o.map((t=>e.activateAnnotation(t.getTypeName(),{callback:this._onAnnotationResult})))}))}}var D=n(84309),k=n(48828),F=n(90424);let P=class{constructor(e,t,n,r,i,o,s){this._hostEmitter=e,this._logger=t,this._hostSettings=n,this._oaMetric=r,this._queryDetection=i,this._proofingDom=o,this.targetDocumentFactory=s,this._oaStartupSignalSeq=0,this._startSignalIntervalId=null,this._lastStartSignalTime=0,this._elementsToProof=[],this._targetWindow=window,this._oaSendALMenuControlSignal=async e=>{if(!this._sessionsProvider)return;const t=await this._sessionsProvider.getOrCreateSession(e.address);this._oaStartupSignalSeq=this._oaStartupSignalSeq+1,null==t||t.submitSignal(new a(e.message),this._oaStartupSignalSeq.toString(),e.message.documentModel)},this._isSameOrDescendantElement=(e,t)=>e===t||(0,d.C)(e,"HTMLDivElement")&&e.contains(t),this._handleDocumentFocusIn=e=>{const t=e.target;(0,d.C)(t,"HTMLElement")&&this._elementsToProof.some((e=>this._isSameOrDescendantElement(t,e)))&&(this._submitStartupSignal(),this._initStartupSignalTimer())},this._handleDocumentFocusOut=e=>{this._clearStartupSignalTimer()},this._attachFocusEventToProofedElements=async e=>{var t,n;const r=null===(t=this._proofingDom.findNode(e.message))||void 0===t?void 0:t.element;if(!r||!(0,d.C)(r,"HTMLElement"))return;this._elementsToProof.push(r);const i=(null===(n=this.targetDocumentFactory())||void 0===n?void 0:n.deref())||document;(0,d.C)(i.activeElement,"HTMLElement")&&this._isSameOrDescendantElement(i.activeElement,r)&&(this._submitStartupSignal(),this._initStartupSignalTimer())}}register(e,t){var n;if(!u(this._hostSettings))return;this._sessionsProvider=e,this._augloopDocumentSerializer=t,this._hostEmitter.on(c.pD.oaMenuControlSignal,this._oaSendALMenuControlSignal),this._hostEmitter.on(c.pD.hostModelAddedRootNode,this._attachFocusEventToProofedElements);const r=(null===(n=this.targetDocumentFactory())||void 0===n?void 0:n.deref())||document;this._focusInListener=new g.J(r),this._focusInListener.addListener("focusin",this._handleDocumentFocusIn),this._focusOutListener=new g.J(r),this._focusOutListener.addListener("focusout",this._handleDocumentFocusOut),r.defaultView&&(this._targetWindow=r.defaultView)}unregister(){var e,t;this._elementsToProof=[],u(this._hostSettings)&&(this._hostEmitter.off(c.pD.oaMenuControlSignal,this._oaSendALMenuControlSignal),this._hostEmitter.off(c.pD.hostModelAddedRootNode,this._attachFocusEventToProofedElements),null===(e=this._focusInListener)||void 0===e||e.removeListener("focusin"),this._focusInListener=void 0,null===(t=this._focusOutListener)||void 0===t||t.removeListener("focusout"),this._focusOutListener=void 0),this._clearStartupSignalTimer()}createAnnotationListener(){return new A(this._hostEmitter,this._logger,this._oaMetric,this._queryDetection,this._hostSettings)}onInitialize(e){this._initStartupSignal(e)}onSessionReconnected(e){this._initStartupSignal(e)}onDocumentCreated(e,t){var n,r,i;if(!u(this._hostSettings))return;this._oaStartupSignalSeq=this._oaStartupSignalSeq+1;const o=null===(n=this._hostSettings.oaSettings)||void 0===n?void 0:n.tokenOverride,a=this.getClientConfig(),s=null===(r=a.metadata)||void 0===r?void 0:r.appScenario;this._hostSettings.appId.startsWith("PowerPoint")&&"Copilot"!==s&&this._logger.logDiagnostics(`[OAClientSubscriber] client config for PowerPoint doesn't have correct appScenario: ${s}`),e.submitSignal(new l({sessionConfig:{clientConfig:a,debugConfig:{tokenOverride:o}},parentPath:null===(i=this._augloopDocumentSerializer)||void 0===i?void 0:i.getParentPath(e,t).join("\\")}),this._oaStartupSignalSeq.toString(),t)}get isEnabled(){return!0}getClientConfig(){return(0,D.e)(this._hostSettings)}_submitStartupSignal(){var e;if(!u(this._hostSettings)||!this._currentSession)return;if(!(Date.now()-this._lastStartSignalTime>9800))return;this._oaStartupSignalSeq++;const t=null===(e=this._hostSettings.oaSettings)||void 0===e?void 0:e.tokenOverride;this._lastStartSignalTime=Date.now(),this._currentSession.submitSignal(new s({debugOptions:{tokenOverride:t}}),this._oaStartupSignalSeq.toString())}_initStartupSignal(e){this._clearStartupSignalTimer(),this._currentSession=e,this._submitStartupSignal()}_initStartupSignalTimer(){this._startSignalIntervalId||(this._startSignalIntervalId=this._targetWindow.setInterval((()=>{this._submitStartupSignal()}),1e4))}_clearStartupSignalTimer(){this._startSignalIntervalId&&(this._targetWindow.clearInterval(this._startSignalIntervalId),this._startSignalIntervalId=null)}};P=(0,i.__decorate)([(0,k._)(),(0,i.__param)(0,(0,F.W)(c.M5)),(0,i.__param)(1,(0,F.W)(h.g)),(0,i.__param)(2,(0,F.W)(p.n)),(0,i.__param)(3,(0,F.W)(f.u)),(0,i.__param)(4,(0,F.W)(v.J)),(0,i.__param)(5,(0,F.W)(y.w)),(0,i.__param)(6,(0,F.W)(m.Ze))],P);var N=n(24410),B=n(6526);class O{constructor(){this.imports=[N.E]}get uniqueId(){return(0,B.z)(507918404)}configureRootServices(e){e.bind(r.T).to(P)}}},68641:(e,t,n)=>{"use strict";n.d(t,{g:()=>A});var r=n(30206),i=n(58964),o=n(79421),a=n(88670),s=n(48828),l=n(90424);let d=class{constructor(e,t){this._proofingStore=e,this._hostSettings=t}async buildDescriptors(){var e;const t="FlightIds";let n;try{n=JSON.parse(await this._proofingStore.read(i.l.Descriptors))}catch(e){n=JSON.parse(this._proofingStore.getDefaultValue(i.l.Descriptors))}let r="";if(this._hostSettings.flightsToTrack&&this._hostSettings.flightsToTrack.length>0&&(r=`${r}${this._hostSettings.flightsToTrack.join(";")}`),""!==r){const e=n.find((e=>e.name===t));e?e.value=`${e.value};${r}`:n.push({name:t,value:r})}return(null===(e=this._hostSettings.hostMetadata)||void 0===e?void 0:e.releaseAudienceGroup)&&n.push({name:"Audience",value:u(this._hostSettings.hostMetadata.releaseAudienceGroup)}),n}};function u(e){switch(e){case"Local":case"Staging":case"Dogfood":case"DogFood":return"DogFood";case"Microsoft":return"Microsoft";default:return"Production"}}d=(0,r.__decorate)([(0,s._)(),(0,r.__param)(0,(0,l.W)(o.K)),(0,r.__param)(1,(0,l.W)(a.n))],d);var c=n(87084),g=n(6526),h=n(97847),p=n(48640);var f,v,m=n(6395),y=n(67005),_=n(36857),b=n(41260),C=n(93398),S=n(52996),T=n(46914),I=n(59834),w=n(95988),E=n(30225);!function(e){e.InstrumentationCall="InstrumentationCall"}(f||(f={})),function(e){e.TileIdParseException="RunTimeErrors.TileIdParseException",e.InvalidTileFormat="RunTimeErrors.InvalidTileFormat"}(v||(v={}));let x=class{constructor(e,t,n,r,i){this._hostEmitter=e,this._proofingStore=t,this._descriptorManager=n,this._logger=r,this._paneOpenState=i}async process(e){const t=await this.getRequest(e);return!!t&&(this.emitInstrumentationRequest(t,e),this.logActivity(t),!0)}async getRequest(e){if(e.critique.traceId&&e.critique.typeId&&e.critique.textInContext)return{appId:await this._proofingStore.read(i.l.AppId),descriptors:await this._descriptorManager.buildDescriptors(),languageId:p.I.getDefaultLanguageCode(await this._proofingStore.read(i.l.ProofingLanguages)),traceId:e.critique.traceId,critiquePriority:e.critique.priority,critiqueTypeId:e.critique.typeId,eventId:e.eventId,flaggedText:e.critique.textInContext,suggestions:e.critique.suggestions.map((e=>e.text)),suggestionText:this.getSuggestionText(e),metadata:this.getMetadata(e),substrateEventCustomFields:e.customProperties}}getSuggestionText(e){const t=e.critique.suggestions.map((e=>e.text));let n=t[e.eventId-4];return e.eventId!==w.xp.Autoreplace&&e.eventId!==w.xp.AutoreplaceUndo||(n=t[0]),e.eventId>=w.xp.ChangeAllSugg0&&e.eventId<=w.xp.ChangeAllSugg2&&(n=t[e.eventId-8]),n}getMetadata(e){var t,n;const r=null!==(n=null===(t=e.critique.metadata)||void 0===t?void 0:t.slice())&&void 0!==n?n:[];this._paneOpenState&&r.push({name:"IsPaneOpen",value:String(this._paneOpenState.isPaneOpen)},{name:"IsPaneOpenedInSession",value:String(this._paneOpenState.isPaneOpenedInSession)});const o=this._proofingStore.getCachedEntry(i.l.ProofingLanguages).storeEntryValue;return r.push({name:m.o.NumProofingLanguages,value:String(o.length)}),r}emitInstrumentationRequest(e,t){e.critiqueTypeId===y.L9.TopicSuggestion||(0,_.r3)(t.critique)||this._hostEmitter.emit(b.pD.instrumentationRequestV1,{address:void 0,message:e})}logActivity(e){const t=this._logger.getNewActivity(f.InstrumentationCall,I.o.SamplingPolicy.Measure),n=e.substrateEventCustomFields&&"true"===e.substrateEventCustomFields.isPersonalized||!1;t&&(t.dataFields.push(...(0,C.W)(["EventID",e.eventId],["CritiquePriority",e.critiquePriority],["CritiqueTypeId",e.critiqueTypeId],["IsPersonalizedEvent",n])),t.success=!0,t.endNow())}};x=(0,r.__decorate)([(0,s._)(),(0,r.__param)(0,(0,l.W)(b.M5)),(0,r.__param)(1,(0,l.W)(o.K)),(0,r.__param)(2,(0,l.W)(c.o)),(0,r.__param)(3,(0,l.W)(S.g)),(0,r.__param)(4,(0,E.l)()),(0,r.__param)(4,(0,l.W)(T.F))],x);class A{constructor(){this.imports=[]}get uniqueId(){return(0,g.z)(507918406)}configureRootServices(e){e.bind(h.f).to(x),e.bind(c.o).to(d)}}},24410:(e,t,n)=>{"use strict";n.d(t,{E:()=>Y});var r=n(90077),i=n(30206),o=n(88670),a=n(46544),s=n(52996),l=n(98418),d=n(72040),u=n(85278),c=n(48828),g=n(90424),h=n(30225);let p=class{constructor(e,t,n,r,i){this._tileNodeReader=e,this._hostSettings=t,this._optimizedRehydrationEnabled=n,this._logger=r,this._textEventPublisher=i}pollNodes(e,t,n,r,i,o,a,s){var l,d,c,g;if(this._textEventPublisher&&!0===this._hostSettings.sdkV2Enabled){const r=[];for(const e of t)if(this._tileNodeReader.isTileNode(e))try{const t=(0,u.F)(e);r.push({text:e.pullText(),mutationChangeType:n,tileNodeId:e.id,rehydrateCritiques:i,forceTileDiffEmission:a,mutationWasTextReplacement:s,documentModel:null==t?void 0:t.documentModel,previousNodeId:this._tileNodeReader.getPreviousTileId(e),nextNodeId:this._tileNodeReader.getNextTileId(e),optimizedRehydrationEnabled:this._optimizedRehydrationEnabled.check(),brokerOptions:{critiques:null==o?void 0:o.get(e.id),forceReflow:!0}})}catch(e){null===(d=this._logger)||void 0===d||d.error(0,"SimplifiedNodePoller: Exception occurred.",e)}else null===(l=this._logger)||void 0===l||l.error(0,"SimplifiedNodePoller: Found children of unsupported type.",{nodeType:e.nodeType,stack:(new Error).stack});this._textEventPublisher.publishTextChangeEvent(r,e)}else for(const e of t)if(this._tileNodeReader.isTileNode(e))try{this._tileNodeReader.reconcile(e,n,null==o?void 0:o.get(e.id),!0,i,a,s)}catch(e){null===(g=this._logger)||void 0===g||g.error(0,"SimplifiedNodePoller: Exception occurred.",e)}else null===(c=this._logger)||void 0===c||c.error(509727256,"SimplifiedNodePoller: Found children of unsupported type.",{nodeType:e.nodeType,stack:(new Error).stack})}removeQueuedTiles(e){}};p=(0,i.__decorate)([(0,c._)(),(0,i.__param)(0,(0,g.W)(d.j)),(0,i.__param)(1,(0,g.W)(o.n)),(0,i.__param)(2,(0,g.W)(a.W)),(0,i.__param)(3,(0,h.l)()),(0,i.__param)(3,(0,g.W)(s.g)),(0,i.__param)(4,(0,h.l)()),(0,i.__param)(4,(0,g.W)(l.n))],p);var f=n(75181),v=n(68641),m=n(28356);class y{constructor(){this.mutex=Promise.resolve()}lock(){let e=e=>{};return this.mutex=this.mutex.then((()=>new Promise(e))),new Promise((t=>{e=t}))}}var _=n(20399),b=n(41260),C=n(85230),S=n(62070),T=n(84002),I=n(34681),w=n(37989),E=n(52669),x=n(30122),A=n(75943);class D{constructor(e,t,n,r,i,o,a,s){this._sessionId=e,this._logger=t,this._annotationListeners=n,this._session=r,this._aggregateLogger=i,this._augloopDocumentSerializer=o,this._hostEmitter=a,this._clientSubscribers=s,this.sessionWasDisconnected=!1,this.initialize=async()=>{try{this._session.setConnectCallback(this.onSessionConnected),this._session.setDisconnectCallback(this.onSessionDisconnected)}catch(e){this._logger.error(561534362,"Failed to initialize AugLoop session callbacks",e)}try{await this.activateAnnotations(this._annotationListeners.map((e=>e.annotationListenerType)))}catch(e){this._logger.error(508614281,"Failed to initialize AugLoop session annotations",e)}},this.close=()=>{this._session.close()},this.submitDelta=(e,t,n)=>{var r;const i=new m.xU({parentPath:e,items:[{id:e[e.length-1],revId:`${n}`,body:t,sourceTimestamp:Date.now()}]});this._session.submitOperation(i),null===(r=this._aggregateLogger)||void 0===r||r.incrementEventCount(512337430,`submitDelta. unit: ${t.unit}`)},this.getSessionId=()=>this._sessionId,this.getSession=()=>this._session,this.updateAnnotationActivationConfig=async()=>{await Promise.all(this._annotationListeners.map((e=>{var t;return null===(t=this._aggregateLogger)||void 0===t||t.incrementEventCount(512325704,`updateAnnotationActivationConfig called for ${e.annotationListenerType}`),e.updateAnnotationActivationConfig()})))},this.activateAnnotations=async e=>{const t=this._annotationListeners.filter((t=>null==e?void 0:e.some((e=>e===t.annotationListenerType))));await Promise.all(t.map((e=>{var t;return null===(t=this._aggregateLogger)||void 0===t||t.incrementEventCount(512325703,`activateAnnotations called for ${e.annotationListenerType}`),e.activateAnnotations(this._session,this._sessionId)})))},this.releaseAnnotations=async e=>{const t=this._annotationListeners.filter((t=>null==e?void 0:e.some((e=>e===t.annotationListenerType))));return(await Promise.all(t.map((e=>{var t;return null===(t=this._aggregateLogger)||void 0===t||t.incrementEventCount(512325702,`deactivateAnnotations called for ${e.annotationListenerType}`),e.deactivateAnnotations(this._session)})))).every(Boolean)},this.submitSignal=(e,t,n)=>{var r,i,o;const a=new m.g0({parentPath:this._augloopDocumentSerializer.getParentPath(this,n),items:[{id:t,body:e}]});this._session.submitOperation(a),null===(r=this._aggregateLogger)||void 0===r||r.incrementEventCount(512325701,`submitted a signal of type: ${null!==(o=null===(i=e.H_)||void 0===i?void 0:i.T_)&&void 0!==o?o:"unknown"}`)},this.onDocumentCreated=e=>{for(const t of this._clientSubscribers)t.onDocumentCreated(this,e)},this.onSessionDisconnected=()=>{this.sessionWasDisconnected=!0,this._logger.warn(507773218,"Augloop session has disconnected")},this.onSessionConnected=async e=>{if(!e)return;const t=this.sessionWasDisconnected;if(this.sessionWasDisconnected=!1,t){this._logger.warn(508631257,"Augloop session has reconnected"),this._augloopDocumentSerializer.sessionReconnected(this._session),this._augloopDocumentSerializer.submitSeedOperations(this._session);for(const e of this._clientSubscribers)e.onSessionReconnected(this);this._hostEmitter.emit(b.pD.hostModelRehydrateTiles,{address:this._sessionId,message:[]}),this._hostEmitter.emit(b.pD.hostModelRehydrateTilesFinished,{address:this._sessionId,message:[]})}else this._logger.warn(508421253,"Augloop session has initially connected"),this._augloopDocumentSerializer.submitSeedOperations(this._session)}}submitOperation(e){var t,n;this._session.submitOperation(e);const r=A.h.getTypeNameFor(e);null===(t=this._aggregateLogger)||void 0===t||t.incrementEventCount(512325706,`_submitItemsOperation called with ${r}`),null===(n=this._aggregateLogger)||void 0===n||n.incrementEventCount(512325705,`items submitted through ${r}`,e.items.length)}}class k{constructor(e){A.h.assign(k,this,e)}static getTypeName(){return"AugLoop_Core_Blob"}static getBaseTypes(){return[]}static typeGuard(e){return A.h.matchesTypesFor(e,[k.getTypeName()])}}k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()};class F{constructor(e){A.h.assign(F,this,e)}static getTypeName(){return"AugLoop_Core_Binary"}static getBaseTypes(){return[]}static typeGuard(e){return A.h.matchesTypesFor(e,[F.getTypeName()])}}F.H_={T_:F.getTypeName(),B_:F.getBaseTypes()};class P{constructor(e){A.h.assign(P,this,e)}static getTypeName(){return"AugLoop_Core_TileGroup"}static getBaseTypes(){return[]}static typeGuard(e){return A.h.matchesTypesFor(e,[P.getTypeName()])}}P.H_={T_:P.getTypeName(),B_:P.getBaseTypes()};class N{constructor(e){A.h.assign(N,this,e)}static getTypeName(){return"AugLoop_Core_Session"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return A.h.matchesTypesFor(e,[N.getTypeName()])}}N.H_={T_:N.getTypeName(),B_:N.getBaseTypes()};class B{constructor(e){A.h.assign(B,this,e)}static getTypeName(){return"AugLoop_Core_Document"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return A.h.matchesTypesFor(e,[B.getTypeName()])}}B.H_={T_:B.getTypeName(),B_:B.getBaseTypes()};class O{constructor(e){A.h.assign(O,this,e)}static getTypeName(){return"AugLoop_Core_SubDocument"}static getBaseTypes(){return[]}static typeGuard(e){return A.h.matchesTypesFor(e,[O.getTypeName()])}}O.H_={T_:O.getTypeName(),B_:O.getBaseTypes()};class R{constructor(e){A.h.assign(R,this,e)}static getTypeName(){return"AugLoop_Core_GridCell"}static getBaseTypes(){return[]}static typeGuard(e){return A.h.matchesTypesFor(e,[R.getTypeName()])}}R.H_={T_:R.getTypeName(),B_:R.getBaseTypes()};class L{constructor(e){A.h.assign(L,this,e)}static getTypeName(){return"AugLoop_Core_GridNeighborhoodContext"}static getBaseTypes(){return[]}static typeGuard(e){return A.h.matchesTypesFor(e,[L.getTypeName()])}}L.H_={T_:L.getTypeName(),B_:L.getBaseTypes()};class M{constructor(e){A.h.assign(M,this,e)}static getTypeName(){return"AugLoop_Core_ItemFilter"}static getBaseTypes(){return[]}static typeGuard(e){return A.h.matchesTypesFor(e,[M.getTypeName()])}}M.H_={T_:M.getTypeName(),B_:M.getBaseTypes()};class q{constructor(e){A.h.assign(q,this,e)}static getTypeName(){return"AugLoop_Core_DynamicContext"}static getBaseTypes(){return[]}static typeGuard(e){return A.h.matchesTypesFor(e,[q.getTypeName()])}}q.H_={T_:q.getTypeName(),B_:q.getBaseTypes()};class W{constructor(e){A.h.assign(W,this,e)}static getTypeName(){return"AugLoop_Core_ContextHolder"}static getBaseTypes(){return[]}static typeGuard(e){return A.h.matchesTypesFor(e,[W.getTypeName()])}}W.H_={T_:W.getTypeName(),B_:W.getBaseTypes()};class U{constructor(e){A.h.assign(U,this,e)}static getTypeName(){return"AugLoop_Core_UserContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(e){return A.h.matchesTypesFor(e,[U.getTypeName()])}}U.H_={T_:U.getTypeName(),B_:U.getBaseTypes()};class z{constructor(e){A.h.assign(z,this,e)}static getTypeName(){return"AugLoop_Core_TenantContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(e){return A.h.matchesTypesFor(e,[z.getTypeName()])}}z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()};class j{constructor(e){A.h.assign(j,this,e)}static getTypeName(){return"AugLoop_Core_EventsHolder"}static getBaseTypes(){return[]}static typeGuard(e){return A.h.matchesTypesFor(e,[j.getTypeName()])}}j.H_={T_:j.getTypeName(),B_:j.getBaseTypes()};class H{constructor(e){A.h.assign(H,this,e)}static getTypeName(){return"AugLoop_Core_UserCommandsHolder"}static getBaseTypes(){return["AugLoop_Core_EventsHolder"]}static typeGuard(e){return A.h.matchesTypesFor(e,[H.getTypeName()])}}H.H_={T_:H.getTypeName(),B_:H.getBaseTypes()};var V=n(86225);let G=class{constructor(e){this._clientSubscribers=e,this.hasCreatedDocument=!1}sessionReconnected(e){this.hasCreatedDocument=!1}submitSeedOperations(e){const t={id:"doc",body:new B({isReadonly:!1})},n=new m.Xr({parentPath:["session"],items:[t]});try{e.submitSeedOperations([n])}catch(e){}}getParentPath(e,t){if(!this.hasCreatedDocument){this.hasCreatedDocument=!0;for(const n of this._clientSubscribers)n.onDocumentCreated(e,t)}return["session","doc"]}};G=(0,i.__decorate)([(0,c._)(),(0,i.__param)(0,(0,x.t)(V.T)),(0,i.__param)(0,(0,h.l)())],G);var Q=n(93948);const K=(0,n(63837).f)("IAugloopDocumentSerializer");var $=n(25503);class Z{constructor(e,t){this.logger=e,this.getOrCreateSession=t,this.pendingDeltas=new Map,this.pendingDeltaMutex=new y,this.targetWindow=window,this.sendAttributionRangesIfNecessary=async()=>{this.hasPendingDeltas()&&await this.submitPendingDeltas(this.getOrCreateSession)}}getKeyFromParentPath(e){return e.join()}shouldAttemptMergeDeltas(e,t){return e.modelDelta.tileId===t.modelDelta.tileId&&e.modelDelta.delta.deltaType===t.modelDelta.delta.deltaType}clearPendingTimeout(){this.pendingTimeoutId&&(this.targetWindow.clearTimeout(this.pendingTimeoutId),this.pendingTimeoutId=void 0)}getIndexForRangeMerge(e,t){if(0===t.length||t[t.length-1].start<e.start)return t.length;const n=t.findIndex((t=>t.start>e.start));return-1===n?t.length-1:n}addOrMerge(e,t){if(e.start<0||e.length<0)return void this.logger.error(506033676,"Range to merge has a negative start or length value",{start:e.start,length:e.length});0===t.length&&t.push(e);const n=this.getIndexForRangeMerge(e,t);if(t[n]&&t[n].start===e.start)return void(t[n].length!==e.length&&(t[n].length=e.length,t.splice(n+1)));const r=t[n-1];let i=n,o=0;r&&r.start+r.length>=e.start&&((0,$.G)(r.attribution,e.attribution)?(e.length=e.start-r.start+e.length,e.start=r.start,i=n-1,o=1):(r.length=e.start-r.start,i=r.length<=0?n-1:n)),t[i+1]&&t[i+1].start<e.start+e.length&&(o=Math.max(t.length-i,0)),t.splice(i,o,e)}shutdown(){this.clearPendingTimeout()}setTargetDocument(e){const t=(null==e?void 0:e.deref())||document;t.defaultView&&(this.targetWindow=t.defaultView)}hasPendingDeltas(){return this.pendingDeltas.size>0}async add(e){var t;const n=e.modelDelta.delta.attributionData;if(0===n.ranges.length&&!n.isFullUpdate)return;const r=await this.pendingDeltaMutex.lock();let i=this.pendingDeltas.get(e.address);i||(i=new Map,this.pendingDeltas.set(e.address,i));const o=this.getKeyFromParentPath(e.parentPath);i.has(o)||i.set(o,[]);const a=null!==(t=i.get(o))&&void 0!==t?t:[];if(n.isFullUpdate)i.set(o,[e]);else{const t=a.findIndex((t=>this.shouldAttemptMergeDeltas(t,e)));if(-1!==t){const e=a[t].modelDelta.delta.attributionData.ranges,r=n.ranges;for(const t of r)this.addOrMerge(t,e)}else a.push(e)}this.pendingTimeoutId||(this.pendingTimeoutId=this.targetWindow.setTimeout(this.sendAttributionRangesIfNecessary,1e3)),r()}async submitPendingDeltas(e){const t=await this.pendingDeltaMutex.lock(),n=new Map(this.pendingDeltas);this.pendingDeltas.clear(),this.clearPendingTimeout(),t();for(const[t,r]of n){const n=await e(t);if(n)for(const e of r.values())for(const t of e)n.submitDelta(t.parentPath,t.modelDelta.delta,t.modelDelta.tileVersion)}}}let J=class{constructor(e,t,n,r,i,o,a,s,l,d,u){this._hostEmitter=e,this._hostSettings=t,this._logger=n,this._e2eMetric=r,this._paragraphDeltasEnabled=i,this._clientSubscribers=o,this._sessionOrPromise=a,this._aggregateLogger=s,this._augloopSessionFactory=l,this._targetDocumentFactory=u,this._sessions=new Map,this._runtimeInstances=new Set,this._listenersInitialized=!1,this._fetchALSessionMutex=new y,this._pendingAttributionRangeManager=new Z(this._logger,(async e=>this.getOrCreateSession(e))),this.initialize=async()=>{var e,t;this._sessionOrPromise||this._augloopSessionFactory||this._logger.error(509694866,"Failed to initialize AugLoop, there is no runtime available"),this._hostSettings.enableOrchestration&&(this._logger.log(570782413,_.q.Info,"Initializing Orchestrator."),this._hostEmitter.on(b.pD.hostModelParagraphTextTiles,this._handleTiles),this._hostEmitter.on(b.pD.hostModelDelta,this._handleDelta),this._hostEmitter.on(b.pD.hostModelAttributionDelta,this._handleAttributionDelta),this._hostEmitter.on(b.pD.hostModelFormattingDelta,this._handleDelta),this._hostEmitter.on(b.pD.hostModelTextTile,this._handleTile),this._hostEmitter.on(b.pD.hostModelMoveTextTile,this._handleMove));for(const e of this._clientSubscribers)e.register(this,this._augloopDocumentSerializer);this._listenersInitialized=!0,null===(e=this._pendingAttributionRangeManager)||void 0===e||e.setTargetDocument(null===(t=this._targetDocumentFactory)||void 0===t?void 0:t.call(this))},this.shutDown=()=>{var e;this._logger.log(570782414,_.q.Debug,"Shutting down Orchestrator."),this._listenersInitialized||this._logger.log(570782415,_.q.Error,"Trying to delete event listeners in Orchestrator when they have already been deleted.");for(const e of this._clientSubscribers)e.unregister();for(const e of this._sessions.values())e.getSession()!==this._sessionFromHost&&e.close();for(const e of this._runtimeInstances)e.uninitialize();this._sessions.clear(),this._runtimeInstances.clear(),this._listenersInitialized=!1,this._sessionOrPromise=void 0,this._sessionFromHost=void 0,null===(e=this._pendingAttributionRangeManager)||void 0===e||e.shutdown(),this._pendingAttributionRangeManager=void 0},this.deactivateAnnotations=async e=>{const t=(await Promise.all([...this._sessions.keys()].map((t=>{var n;return null===(n=this._sessions.get(t))||void 0===n?void 0:n.releaseAnnotations(e)})))).every(Boolean);return t||this._logger.error(526209822,"Some annotations failed to be deactivated."),t},this.activateAnnotations=async e=>{for(const t of this._sessions.values())await t.activateAnnotations(e)},this.getOrCreateSession=async e=>{var t;const n=await this._fetchALSessionMutex.lock(),r=null!==(t=this._sessions.get(e))&&void 0!==t?t:await this._createSession(e);return n(),r},this.getSessions=async e=>{if(!e)return this._sessions;const t=new Map;for(const n of e)t.set(n,await this.getOrCreateSession(n));return t},this._createSession=async e=>{const t=[];for(const e of this._clientSubscribers)t.push(e.createAnnotationListener());let n="function"==typeof this._sessionOrPromise?await this._sessionOrPromise():this._sessionOrPromise;if(n)this._sessionFromHost=n;else{if(!this._augloopSessionFactory)return;{const{session:t,runtime:r}=await this._augloopSessionFactory(this._augloopDocumentSerializer,e);n=t,r&&this._runtimeInstances.add(r)}}if(!n)return;const r=new D(e,this._logger,t,n,this._aggregateLogger,this._augloopDocumentSerializer,this._hostEmitter,this._clientSubscribers);await r.initialize();for(const e of this._clientSubscribers)e.onInitialize(r);return this._sessions.set(e,r),r},this._handleDelta=async e=>{const t=e.message;if(t.sourceType===C.pf.TileNode)return;const n=await this.getOrCreateSession(e.address);n&&(this._e2eMetric.startEntry(`${t.tileId}--${t.tileVersion}`),n.submitDelta([...this._augloopDocumentSerializer.getParentPath(n,t.documentModel),t.tileId],t.delta,t.tileVersion))},this._handleAttributionDelta=async e=>{var t;const n=e.message;if(n.sourceType===C.pf.TileNode)return;const r=await this.getOrCreateSession(e.address);r&&await(null===(t=this._pendingAttributionRangeManager)||void 0===t?void 0:t.add({address:e.address,parentPath:[...this._augloopDocumentSerializer.getParentPath(r,n.documentModel),n.tileId],modelDelta:n}))},this._handleTiles=async e=>{this._paragraphDeltasEnabled.check()||await this._handleTileMessages(e.address,e.message)},this._handleTile=async e=>{this._paragraphDeltasEnabled.check()&&e.message.data.isTextNode&&await this._handleTileMessages(e.address,[e.message])},this._handleTileMessages=async(e,t)=>{const n=await this.getOrCreateSession(e);if(n)for(const r of t){const t=r.data;let i;switch(r.messageType){case S.G.NewData:this._e2eMetric.startEntry(`${t.tileId}--${t.tileVersion}`),i=new m.Xr({parentPath:this._augloopDocumentSerializer.getParentPath(n,t.documentModel),items:[{id:t.tileId,body:t.tile,revId:`${t.tileVersion}`,sourceTimestamp:Date.now()}],prevId:r.data.prevId,nextId:r.data.nextId});break;case S.G.RemoveData:i=new m.n4({parentPath:this._augloopDocumentSerializer.getParentPath(n,t.documentModel),items:[{id:t.tileId,sourceTimestamp:Date.now()}]});break;case S.G.ChangeData:this._e2eMetric.startEntry(`${t.tileId}--${t.tileVersion}`),i=new m.fZ({parentPath:this._augloopDocumentSerializer.getParentPath(n,t.documentModel),items:[{id:t.tileId,body:t.tile,revId:`${t.tileVersion}`,sourceTimestamp:Date.now()}]})}n.submitOperation(i),this._hostEmitter.emit(b.pD.hostModelTextTileEmittedToAugloop,{address:e,message:r})}},this._handleMove=async e=>{const t=e.message;await this._handleTileMessages(e.address,[{messageType:S.G.RemoveData,data:{tileId:t.oldTileId,tileVersion:t.tileVersion,documentModel:t.oldDocumentModel,tile:void 0,changeType:C.Q0.Code,isTextNode:!1}},{messageType:S.G.NewData,data:{tileId:t.newTileId,tileVersion:t.tileVersion,documentModel:t.newDocumentModel,tile:t.tile,changeType:C.Q0.Code,isTextNode:!1,prevId:t.prevId,nextId:t.nextId}}])},this._augloopDocumentSerializer=null!=d?d:new G(o)}};J=(0,i.__decorate)([(0,c._)(),(0,i.__param)(0,(0,g.W)(b.M5)),(0,i.__param)(1,(0,g.W)(o.n)),(0,i.__param)(2,(0,g.W)(s.g)),(0,i.__param)(3,(0,g.W)(T.m)),(0,i.__param)(4,(0,g.W)(I.H)),(0,i.__param)(5,(0,x.t)(V.T)),(0,i.__param)(5,(0,h.l)()),(0,i.__param)(6,(0,g.W)(Q.P)),(0,i.__param)(6,(0,h.l)()),(0,i.__param)(7,(0,h.l)()),(0,i.__param)(7,(0,g.W)(w.v)),(0,i.__param)(8,(0,h.l)()),(0,i.__param)(8,(0,g.W)(f.a)),(0,i.__param)(9,(0,h.l)()),(0,i.__param)(9,(0,g.W)(K)),(0,i.__param)(10,(0,h.l)()),(0,i.__param)(10,(0,g.W)(E.Ze))],J);var X=n(6526);class Y{constructor(){this.imports=[v.g]}get uniqueId(){return(0,X.z)(507918371)}configureRootServices(e){e.bind(f.J).to(J),e.bind(r.G).to(p)}}},87084:(e,t,n)=>{"use strict";n.d(t,{o:()=>r});const r=(0,n(63837).f)("IDescriptorManager")},92135:(e,t,n)=>{"use strict";n.d(t,{JY:()=>u,Th:()=>c,yi:()=>g});var r=n(30206),i=n(19718),o=n(16488),a=n(68081),s=n(63837),l=n(48828),d=n(90424);const u=(0,s.f)("IAriaStatusStateStore"),c=(0,s.f)("IAriaStatusStateStoreFactory");let g=class extends i.z{constructor(e){super(),this.featureFlagsReader=e,this.purgeDelay=1e4,this.logPurgeTimeout={},this._politeUpdates=[],this._assertiveUpdates=[],this._status=void 0,this._statusSeverity="off",this.postMessageIfIframe=e=>window.self!==window.top&&(this.featureFlagsReader.flags.enableAriaStatusPostMessage?(window.parent.postMessage(e,"*"),!0):!this.featureFlagsReader.flags.enableAriaStatusInNonRootIFrames),this.reset=(e,t,n)=>{this.postMessageIfIframe({messageType:"msAriaResetMessage",resetStatus:e,resetAssertiveLogs:t,resetPoliteLogs:n})||(e&&(this._status=void 0,this._statusSeverity="off"),t&&(this._assertiveUpdates=[]),n&&(this._politeUpdates=[]),this.publishStateChange())},this.scheduleLogCleanup=e=>{this.cancelScheduledCleanup(e),this.logPurgeTimeout[e]=window.setTimeout((()=>{const t="assertive"===e,n="polite"===e;this.reset(!1,t,n)}),this.purgeDelay)},this.cancelScheduledCleanup=e=>{const t=this.logPurgeTimeout[e];t&&(window.clearTimeout(t),this.logPurgeTimeout[e]=void 0)},this.onMessage=e=>{var t;if(null===(t=e.data)||void 0===t?void 0:t.messageType)if("msAriaSetMessage"===e.data.messageType){const t=e.data;void 0===t.status||"assertive"!==t.severity&&"polite"!==t.severity&&"off"!==t.severity||(Array.isArray(t.status)?this.addPreservedStatuses(t.status,t.severity):this.setStatus(t.status,t.severity,!!t.preserve))}else if("msAriaResetMessage"===e.data.messageType){const t=e.data;void 0!==t.resetAssertiveLogs&&void 0!==t.resetPoliteLogs&&void 0!==t.resetStatus&&this.reset(t.resetStatus,t.resetAssertiveLogs,t.resetPoliteLogs)}}}async initialize(){this.featureFlagsReader.flags.enableAriaStatusPostMessage&&window.self===window.top&&(this.eventListener=new o.J(window),this.eventListener.addListener("message",this.onMessage,{passive:!0,capture:!0}))}shutDown(){var e;null===(e=this.eventListener)||void 0===e||e.removeAllListeners(),this.eventListener=void 0}setStatus(e,t,n=!1){if(!this.postMessageIfIframe({messageType:"msAriaSetMessage",status:e,severity:t,preserve:n})){if(n){if("polite"===t||"assertive"===t){const n="polite"===t?this._politeUpdates:this._assertiveUpdates;this.cancelScheduledCleanup(t),n.push(e),this.scheduleLogCleanup(t)}}else this._statusSeverity=t,this._status=e;this.publishStateChange()}}addPreservedStatuses(e,t){if(this.postMessageIfIframe({messageType:"msAriaSetMessage",status:e,severity:t,preserve:!0}))return;if("off"===t)return;const n="polite"===t?this._politeUpdates:this._assertiveUpdates;this.cancelScheduledCleanup(t),n.push(...e),this.scheduleLogCleanup(t),this.publishStateChange()}resetAll(){this.reset(!0,!0,!0)}resetPreserved(){this.reset(!1,!0,!0)}resetStatus(){this.reset(!0,!1,!1)}publishStateChange(){this.publishEvent("stateUpdated",{status:this._status,statusSeverity:this._statusSeverity,politeUpdates:this._politeUpdates,assertiveUpdates:this._assertiveUpdates})}};g=(0,r.__decorate)([(0,l._)(),(0,r.__param)(0,(0,d.W)(a.c))],g)},19422:(e,t,n)=>{"use strict";n.d(t,{U:()=>h,d:()=>c});var r=n(85113),i=n(37842),o=n(8676),a=n(46965),s=n(52669),l=n(88670),d=n(77724),u=n(95734);const c=u.createContext(void 0),g=(0,i.F5)({languageScriptDirectionDetector:o.A.on(a.iw).optional(),targetWindowRef:o.A.on(s.sh).optional(),hostSettings:o.A.on(l.n).optional()}),h=e=>{const{hostSettings:t,languageScriptDirectionDetector:n,targetWindowRef:o}=(0,i.SM)(g),a=u.useContext(c),s=null==o?void 0:o.deref();u.useEffect((()=>{var e;return null===(e=null==t?void 0:t.onCalloutOpened)||void 0===e||e.call(t,null,void 0,a),()=>{var e;null===(e=null==t?void 0:t.onCalloutClosed)||void 0===e||e.call(t,null,void 0,a)}}),[t,a,e.target,s]);const l={hostId:a,eventBubblingEnabled:!0};return u.createElement(r.P,Object.assign({dir:null==n?void 0:n.dir(),layerProps:l},e,{target:e.target,doNotLayer:!a&&e.doNotLayer}),void 0===n?e.children:u.createElement(d.K,{rtl:n.isRtl()},e.children))}},89971:(e,t,n)=>{"use strict";n.d(t,{J:()=>r});const r=(0,n(63837).f)("ICalloutDismissalHandler")},82455:(e,t,n)=>{"use strict";n.d(t,{j:()=>r});const r=(0,n(63837).f)("IInlineSuggestionsCalloutPlacement")},25100:(e,t,n)=>{"use strict";n.d(t,{e:()=>r});const r=(0,n(63837).f)("IInlineSuggestionsCalloutSizeAndDirectionUtils")},28363:(e,t,n)=>{"use strict";n.d(t,{P:()=>r,V:()=>o});var r,i=n(63837);!function(e){e.AttachFile="AttachFile",e.TriggerChar="TriggerChar",e.Fre="Fre"}(r||(r={}));const o=(0,i.f)("IInlineSuggestionsRenderer")},84622:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(63837).f)("IUserProfilePictureCache")},12323:(e,t,n)=>{"use strict";n.d(t,{W:()=>dt});var r,i=n(30206),o=n(69913),a=n(27139),s=n(77145),l=n(26017),d=n(48741);!function(e){e.Disabled="Disabled",e.Predictive="Predictive",e.UserInitiated="UserInitiated"}(r||(r={}));var u=n(41260),c=n(49086),g=n(62070),h=n(85230),p=n(93398),f=n(72777),v=n(16488),m=n(23),y=n(24941),_=n(7738),b=n(85899),C=n(88670),S=n(49520),T=n(52996),I=n(40245),w=n(23039),E=n(23132),x=n(71234),A=n(68081),D=n(79548),k=n(24839),F=n(46965),P=n(52669),N=n(46914),B=n(97847),O=n(55908),R=n(47436),L=n(12500),M=n(85278),q=n(14193),W=n(11966),U=n(43900),z=n(47255),j=n(94453),H=n(84106),V=n(95988),G=n(3327),Q=n(48828),K=n(90424),$=n(30225),Z=n(30122),J=n(80967);const X="keptMetricEnabled",Y="OACurrentQueryDismiss",ee="OAPanelRequestUpdate",te="OAShowMoreEntitiesError",ne="OAShowMoreEntitiesSearchCleared",re="ExpandedEccUploadMenuEvent";var ie=n(92135),oe=n(89971),ae=n(97397),se=n(94763),le=n(40313),de=n(96837),ue=n(75414),ce=n(46546),ge=n(72433);class he{getPluginCalloutMaxHeight(e,t,n){var r;const i=null!==(r=e.y)&&void 0!==r?r:e.top;if(i)return Math.max(t.innerHeight-i,i)-20}getCalloutDirection(e,t,n,r){return e?ge.A.bottomRightEdge:ge.A.bottomLeftEdge}}var pe=n(90630),fe=n(94084),ve=n(28363),me=n(67005);function ye(e){switch(e){case me.L9.CIQFlag_PersonEntityRecognition:return J.z4.Person;case me.L9.CIQFlag_File:return J.z4.File;case me.L9.CIQFlag_LocalBusiness:case me.L9.CIQFlag_Location:case me.L9.CIQFlag_Time:return J.z4.Location;case me.L9.CIQFlag_Topic:return J.z4.Topic;case me.L9.CIQFlag_TaskRecognition:case me.L9.CIQFlag_SatoriEntityRecognition:case me.L9.CIQFlag_DateEntityRecognition:case me.L9.HeadingDetection:return J.z4.Location;default:return}}var _e=n(6510);function be(e,t,n,r,i,o,a){const s=e.queryDetection.setCurrentQueryRange(i.id,r,a,o,t);s&&(s.scopeInfo=o);const l=new _e.s({deltaType:G.WI.Update,unit:G.OD.Chars,position:r.start,length:r.length,content:n,queryRange:r,additionalData:s,userInfo:{userType:G.HS.SessionUser}});Ce(e.hostEmitter,i,l)}function Ce(e,t,n){const r=(0,M.F)(t);e.emit(u.pD.hostModelDelta,{address:void 0,message:{tileId:t.id,tileVersion:t.eventSeqId||0,documentModel:null==r?void 0:r.documentModel,delta:n,sourceType:h.pf.ParagraphNode,changeType:h.Q0.Code,deletedOrReplacedCharacters:void 0}})}function Se(e,t){var n,r,i,o,a,s,l;const d=null!==(i=null!==(r=null===(n=t.queryDetection.getCurrentQuery())||void 0===n?void 0:n.queryRange.prefix)&&void 0!==r?r:e.triggerCharacter)&&void 0!==i?i:"@",u=t.queryDetection.getCurrentScope();return(0,p.W)(["scope",null!==(o=null==u?void 0:u.entityType)&&void 0!==o?o:""],["keyStrokes",e.keyStrokes],["isEmptyQuery",e.queryRange.length===d.length],["wasOpenedViaNudge",e.wasOpenedViaNudge],["triggerCharacter",d],["wasOpenedIsViaNudgeAndHasEntityResults",null!==(s=null===(a=e.wasOpenedViaNudgeInfo)||void 0===a?void 0:a.hasEntityResults)&&void 0!==s&&s],["wasOpenedViaAutomaticAtMention",e.wasOpenedViaAutomaticAtMention],["wasOpenedViaFlag","InlineSuggestionsResultsFlagMenuType"===e.menuType.menuType],["wasOpenedInBlankTile",e.wasOpenedInBlankTile],["parentTileType",null!==(l=e.parentTileType)&&void 0!==l?l:"unknown"],["menuType",e.menuType.menuType.replace("InlineSuggestions","").replace("MenuType","").replace("Results","")],[X,!!t.hostSettings.enableKeptMetric])}class Te{constructor(e,t,n){this._services=e,this._calloutState=t,this.wrapInClearingSearch=n,this._searchBoxQueryUpdated=!1,this._localizer=e.localizer,this._oaLogger=e.oaLogger,this._hostEmitter=e.hostEmitter,this._proofingDom=e.proofingDom,this._oaResultStore=e.oaResultStore,this._queryDetection=e.queryDetection}buildExpandedEccSearchBarConfig(e){return{enableExpandedECCSearchBar:e,onSearchChange:(e="")=>{var t,n;const r=this._calloutState.menuCurrentlyOpen;if(!(null==r?void 0:r.expandedEccSearchBarConfig))return;const i=this._proofingDom.findParagraphNode(r.tileId);if(!(0,R.l)(i))return;const o=r.triggerCharacter,a=o+e,s=e.length+(null!==(t=null==o?void 0:o.length)&&void 0!==t?t:0);null!==(n=this.lastComposingBoxQuery)&&void 0!==n||(this.lastComposingBoxQuery=this._calloutState.queryString),this._calloutState.setSearchBoxQueryString(e),be(this._services,o,a,{start:0,length:s,prefix:o},i,this._queryDetection.getCurrentScope()),this._oaLogger.logActivity("ExpandedEccSearchBarTextChaged",void 0,this.getDefaultLogDataForMenu())},onSearchClear:()=>{this._calloutState.setSearchBoxQueryString(""),this.wrapInClearingSearch((()=>this.removeComposingBoxQuery(!0)))}}}initShowMoreEntitiesParagraph(e,t,n){const r=this._calloutState.menuCurrentlyOpen;if(!r)return;const i=this.createSearchBoxTextTile(r);return t&&(this._previouslySpecifiedItemsToDisplay=r.specifiedItemsToDisplay,r.specifiedItemsToDisplay=void 0),this._oaResultStore.updateLoadingStatus(!0,!0),be(this._services,r.triggerCharacter,n,{start:0,length:n.length,prefix:""},i,e?{entityType:e}:void 0),i}buildShowMoreEntitiesConfig(e,t,n,r){var i,o;if(null===(i=this._services.hostSettings.oaSettings)||void 0===i?void 0:i.disableFlagShowMoreEntities)return;const a=ye(e.typeId);if(a===J.z4.File||a===J.z4.Person){const e=a===J.z4.File?l.c.File:l.c.People,i=a===J.z4.File?this._localizer.getMessage("ebx_ECCSearchFileButtonLabel"):this._localizer.getMessage("ebx_ECCSearchPeopleButtonLabel");return Object.assign(Object.assign({},null===(o=this._services.hostSettings.serviceSettings)||void 0===o?void 0:o.showMoreEntitiesSettings),{isShowMoreEntitiesEnabled:!0,showMoreEntitiesButtonLabel:i,searchBoxPlaceHolder:i,onSearchChange:(t="")=>{this.onSearchBoxQueryChange(t,e)},onClickShowMoreEntities:()=>{const t=this._calloutState.searchBoxQueryString;this.initShowMoreEntitiesParagraph(e,!0,t)?this._oaLogger.logActivity("OAShowMoreEntitiesOpened",void 0,this.getDefaultLogDataForMenu()):this._oaLogger.logActivity(te,{error:"Could not create paragraph node for search bar"},this.getDefaultLogDataForMenu())},onCloseShowMoreEntities:()=>{const e=this._calloutState.menuCurrentlyOpen;e&&(this._previouslySpecifiedItemsToDisplay?(e.specifiedItemsToDisplay=this._previouslySpecifiedItemsToDisplay,this._oaResultStore.updateResults(e.specifiedItemsToDisplay,r.id,0===e.specifiedItemsToDisplay.length?d.i.NoResults:d.i.Success,void 0,void 0,0===e.specifiedItemsToDisplay.length?{NoResults:1}:{Success:1})):(e.specifiedItemsToDisplay=void 0,this._oaResultStore.updateLoadingStatus(!0,!0),be(this._services,e.triggerCharacter,t,n,r,void 0)),this.removeSearchBoxTextTile(e)),this._oaLogger.logActivity("OAShowMoreEntitiesClosed",void 0,this.getDefaultLogDataForMenu())},onSearchClear:()=>{this.initShowMoreEntitiesParagraph(e,!1,"")?this._oaLogger.logActivity(ne,void 0,this.getDefaultLogDataForMenu()):this._oaLogger.logActivity(te,{error:"Could not create paragraph node for search bar"},this.getDefaultLogDataForMenu())},entityType:e})}}getIsSearchBarAvailable(){const e=this._calloutState.menuCurrentlyOpen;return(null==e?void 0:e.enableExpandedECCSearchBar)&&this._calloutState.searchBoxQueryString.length>0||this._searchBoxQueryUpdated}onSearchBoxQueryChange(e,t){var n;this._searchBoxQueryUpdated=!0,this._calloutState.setSearchBoxQueryString(e),null!==(n=this.lastComposingBoxQuery)&&void 0!==n||(this.lastComposingBoxQuery=this._calloutState.queryString);const r=this._calloutState.menuCurrentlyOpen;if(!(null==r?void 0:r.searchBoxGeneratedParagraphId)&&!this.initShowMoreEntitiesParagraph(t,!0,e))return void this._oaLogger.logActivity(te,{error:"Could not create paragraph node for search bar"},this.getDefaultLogDataForMenu());const i=(null==r?void 0:r.searchBoxGeneratedParagraphId)?this._proofingDom.findParagraphNode(r.searchBoxGeneratedParagraphId):void 0;i?(this._oaResultStore.updateLoadingStatus(!0,!0),be(this._services,null==r?void 0:r.triggerCharacter,e,{start:0,length:e.length,prefix:""},i,t?{entityType:t}:void 0,!0),this._oaLogger.logActivity("OAShowMoreEntitiesSearchChanged",void 0,this.getDefaultLogDataForMenu())):this._oaLogger.logActivity(te,{error:"Could not find paragraph node for search bar"},this.getDefaultLogDataForMenu())}menuDismissed(e){this.removeSearchBoxTextTile(e),this._searchBoxQueryUpdated=!1,this.lastComposingBoxQuery=void 0}removeSearchBoxTextTile(e){this._previouslySpecifiedItemsToDisplay=void 0,e.searchBoxGeneratedParagraphId&&(this._hostEmitter.emit(u.pD.hostModelTextTile,{address:void 0,message:{messageType:g.G.RemoveData,data:{tileId:e.searchBoxGeneratedParagraphId,tileVersion:0,changeType:h.Q0.Code,isTextNode:!0,tile:new pe.Cg({content:""})}}}),e.searchBoxGeneratedParagraphId=void 0)}async removeComposingBoxQuery(e){var t,n,r;try{const i=this._calloutState.menuCurrentlyOpen;if(!i)return;const o=this._proofingDom.findParagraphNode(i.tileId);if(!(0,R.l)(o))return;const a=this._calloutState.triggerMethod!==ve.P.AttachFile&&this._calloutState.triggerMethod!==ve.P.Fre,s=a?1:null!==(n=null===(t=i.queryRange.prefix)||void 0===t?void 0:t.length)&&void 0!==n?n:1;if(i.queryRange.length===s&&this._calloutState.triggerMethod!==ve.P.AttachFile)return;const l=o.element.offset+i.initialQueryStartPosition;let d=i.queryRange.length;if(a&&(d=(null!==(r=this.lastComposingBoxQuery)&&void 0!==r?r:this._calloutState.queryString).length+1),a&&d-s==0)return;this._calloutState.triggerMethod===ve.P.AttachFile?(this._queryDetection.setCurrentQueryRange(i.tileId,{start:i.queryRange.start,length:1,prefix:""},!0,this._queryDetection.getCurrentScope()),await this._services.tileContent.replace(o.parent,void 0,l,d," ").then((()=>{var e,t,n,r,i,o,a,s;const l=null===(r=null===(n=null===(t=(e=this._services).targetDocumentFactory)||void 0===t?void 0:t.call(e))||void 0===n?void 0:n.deref())||void 0===r?void 0:r.querySelectorAll(".ms-ecc-callout input[type=search]")[0];l&&(l.setAttribute("placeholder",this._localizer.getMessage("expandedInlineSuggestionsSearchBarPlaceholder")),null===(s=null===(a=null===(o=(i=this._services).targetWindowFactory)||void 0===o?void 0:o.call(i))||void 0===a?void 0:a.deref())||void 0===s||s.requestAnimationFrame((()=>{l.focus()})))}))):await this._services.tileContent.remove(o.parent,void 0,l+s,d-s).then((()=>{var t,n,r,i,o,a,s,l;if(!e)return;this.lastComposingBoxQuery=void 0,this._calloutState.clearQueryString(!0);const d=null===(i=null===(r=null===(n=(t=this._services).targetDocumentFactory)||void 0===n?void 0:n.call(t))||void 0===r?void 0:r.deref())||void 0===i?void 0:i.querySelectorAll(".ms-ecc-callout input[type=search]")[0];d&&(d.setAttribute("placeholder",this._localizer.getMessage("expandedInlineSuggestionsSearchBarPlaceholder")),null===(l=null===(s=null===(a=(o=this._services).targetWindowFactory)||void 0===a?void 0:a.call(o))||void 0===s?void 0:s.deref())||void 0===l||l.requestAnimationFrame((()=>{d.focus()})))})).finally((()=>{var t;if(!e)return;const n=i.triggerCharacter,r=i.tileId;if(!r)return;const o=this._proofingDom.findParagraphNode(r);o&&be(this._services,n,n+"",{start:0,length:null!==(t=null==n?void 0:n.length)&&void 0!==t?t:0,prefix:n},o,this._queryDetection.getCurrentScope())}))}finally{this.lastComposingBoxQuery=void 0}}getDefaultLogDataForMenu(e){const t=null!=e?e:this._calloutState.menuCurrentlyOpen;return t?Se(t,this._services):[]}createSearchBoxTextTile(e){this.removeSearchBoxTextTile(e);const t=this.generateNewParagraphNode();return e.searchBoxGeneratedParagraphId=t.id,t}generateNewParagraphNode(){const e=new R.f(new fe.L,this._proofingDom,{offset:0,span:0});return this._hostEmitter.emit(u.pD.hostModelTextTile,{address:void 0,message:{messageType:g.G.NewData,data:{tileId:e.id,tileVersion:e.eventSeqId,changeType:h.Q0.Local,isTextNode:!0,tile:new pe.Cg({content:""})}}}),e}}const Ie=(0,n(63837).f)("IDefaultInlineSuggestionItems");var we=n(82455),Ee=n(25100),xe=n(84622),Ae=n(19718),De=n(81898);class ke{constructor(){this._onUpdate=void 0}onKeyPressed(e,t,n){return!!this._onUpdate&&this._onUpdate(e,t,n)}setKeyPressHandler(e){this._onUpdate=e}}var Fe=n(3795),Pe=n(29594);function Ne(e,t,n){const r=null==t?void 0:t.getComponentActiveTheme(n?ae.yF.expandedInlineSuggestionComponentName:ae.yF.inlineSuggestionComponentName);let i;return e&&(i=JSON.parse(JSON.stringify(e))),i=Be(i,r),i}function Be(e,t){if(!e)return t;if(t)for(const n in t){const r=n;"object"==typeof t[r]?e[r]?Be(e[r],t[r]):e[r]=t[r]:e[r]||(e[r]=t[r])}return e}class Oe extends Ae.z{constructor(e,t,n,r){super(),this._inlineSuggestionsCalloutPlacement=t,this._inlineSuggestionsCalloutSizeAndDirectionUtils=n,this.callbackMethods=r,this.keyboardHandlerTarget=new ke,this.queryString="",this.searchBoxQueryString="",this.isError=!1,this.isLoading=!0,this.resultReset=!1,this.hasTargetLocationBeenCalculated=!1,this._suggestions=void 0,this._preloadedSuggestions=void 0,this._triggeringMethod=void 0,this.overrideTargetLocation=void 0,this.menuParentElement=void 0,this.setPreloadedSuggestions=e=>{this._preloadedSuggestions=e,this.isLoading=0===e.length,this.publishUpdateEvent()},this.clearPreloadedSuggestions=()=>{var e;(null===(e=this._preloadedSuggestions)||void 0===e?void 0:e.length)&&(this._preloadedSuggestions=[],this.publishUpdateEvent())},this.setSearchBoxQueryString=e=>{this.searchBoxQueryString=e,this.publishUpdateEvent()},this.inlineSuggestionsStrings=(0,Pe.$)().getStringsFor("InlineSuggestionStrings"),this.calloutStrings=(0,Pe.$)().getStringsFor("OnCanvasCalloutStrings"),this.getLocale=()=>this._hostSettings.defaultLocale,this.isFlightEnabled=this.callbackMethods.isFlightEnabled,this.onFeedbackButtonClicked=this.callbackMethods.onFeedbackButtonClicked,this.onFirstRender=this.callbackMethods.onFirstRender,this.onProcessedResults=this.callbackMethods.onProcessedResults,this.onRenderResults=this.callbackMethods.onRenderResults,this.onAction=this.callbackMethods.onAction,this.onFooterAction=this.callbackMethods.onFooterAction,this.onDismissed=this.callbackMethods.onDismissed,this.onPreventDismissOnEvent=this.callbackMethods.onPreventDismissOnEvent,this.onRestoreFocus=this.callbackMethods.onRestoreFocus,this.onSearchBoxQueryChange=this.callbackMethods.onSearchBoxQueryChange,this.onUserInteraction=this.callbackMethods.onUserInteraction,this.onGroupSelected=this.callbackMethods.onGroupSelected,this.onItemSelected=this.callbackMethods.onItemSelected,this.removeComposingBoxQuery=this.callbackMethods.removeComposingBoxQuery,this.handleKeyDown=this.callbackMethods.handleKeyDown,this.getQueryRangeBoundingClientRect=this.callbackMethods.getQueryRangeBoundingClientRect,this.handleEccUploadMenuEvent=this.callbackMethods.handleEccUploadMenuEvent,this.directionalHintCallback=(e,t,n,r)=>this._inlineSuggestionsCalloutSizeAndDirectionUtils.getCalloutDirection(r,e,t,n),this.maxHeightCallback=(e,t,n,r)=>{let i=this._inlineSuggestionsCalloutSizeAndDirectionUtils.getPluginCalloutMaxHeight(e,t,n);return(null==r?void 0:r.maxHeight)&&(i=Math.min(r.maxHeight,null!=i?i:Number.MAX_SAFE_INTEGER)),i},this._queryDetection=e.queryDetection,this._hostSettings=e.hostSettings,this._languageScriptDirectionDetector=e.languageScriptDirectionDetector,this._themeStore=e.themeStore,this._targetWindowFactory=e.targetWindowFactory,this._proofingDom=e.proofingDom,this._oaLogger=e.oaLogger}getCalloutState(){var e,t,n;if(this.menuCurrentlyOpen)return{calloutProps:this,targetLocation:this.hasTargetLocationBeenCalculated?this.menuCurrentlyOpen.targetLocation:void 0,targetWindow:null!==(t=null===(e=this._targetWindowFactory)||void 0===e?void 0:e.call(this))&&void 0!==t?t:new y.O(window),currentThemeType:null===(n=this._themeStore)||void 0===n?void 0:n.currentTheme,directionalHintCallback:(e,t,n)=>this.directionalHintCallback(e,t,n,this.isRtl),maxHeightCallback:(e,t)=>{var n;return this.maxHeightCallback(e,t,this.queryChar,(0,ce.toJS)(null===(n=this.styles)||void 0===n?void 0:n.containerStyles))}}}updateCurrentMenu(e,t,n){const r=this.menuCurrentlyOpen,i=!r&&e,o=r&&!e;this.menuCurrentlyOpen=e,this.overrideTargetLocation=t,this.isLoading=!0,this.isError=!1,this.resultReset=!0,this._suggestions=[],this.queryString=null!=n?n:"",this.searchBoxQueryString="",this.menuParentElement=o?void 0:this.callbackMethods.menuParentElement,i?(this.hasTargetLocationBeenCalculated=!1,this.publishEvent("menuUpdated",{messageType:g.G.NewData,data:{tileId:e.tileId,queryRange:e.queryRange}})):o?(this.hasTargetLocationBeenCalculated=!1,this._triggeringMethod=void 0,this._queryDetection.removeDetectedQuery(),this.publishEvent("menuUpdated",{messageType:g.G.RemoveData,data:{tileId:r.tileId,queryRange:r.queryRange}})):this.publishUpdateEvent()}publishUpdateEvent(){this.menuCurrentlyOpen&&this.publishEvent("menuUpdated",{messageType:g.G.ChangeData,data:{tileId:this.menuCurrentlyOpen.tileId,queryRange:this.menuCurrentlyOpen.queryRange}})}async calculateTargetLocationAndShow(){if(!this.menuCurrentlyOpen)return;this.menuParentElement=this.callbackMethods.menuParentElement;const e=this._queryDetection.getCurrentQueryLogicalId();let t=this.overrideTargetLocation;if(!t){const n=this._proofingDom.findParagraphNode(this.menuCurrentlyOpen.tileId);if(!(0,R.l)(n))return void this._oaLogger.logDiagnostics("Attempted to render ECC, but no valid parent HTML element could be found");const r=await this._inlineSuggestionsCalloutPlacement.getTargetLocationOfECC(n,this);if(!r)return;if(this._queryDetection.getCurrentQueryLogicalId()!==e)return;t=r}"x"in t&&"InlineSuggestionsResultsFlagMenuType"===this.menuCurrentlyOpen.menuType.menuType&&(t.x=t.x-11);const n=!this.hasTargetLocationBeenCalculated||(r=this.menuCurrentlyOpen.targetLocation,i=t,!((0,De.Pe)(r)&&(0,De.Pe)(i)?r.x===i.x&&r.y===i.y:(0,De.K2)(r)&&(0,De.K2)(i)&&r.left===i.left&&r.top===i.top&&r.width===i.width&&r.height===i.height));var r,i;this.menuCurrentlyOpen.targetLocation=t,this.hasTargetLocationBeenCalculated=!0,n&&this.publishUpdateEvent()}setIsLoading(){this.isLoading=!0,this._suggestions=[],this.publishUpdateEvent()}setHadUnexpectedError(){this.isLoading=!1,this.isError=!0,this._suggestions=[],this.publishUpdateEvent()}setHasSuggestions(e,t,n){this.isLoading=!1,this.isError=!1,this.resultReset=t,this._suggestions=e,this.queryString=n,this.publishUpdateEvent()}setQueryString(e){this.queryString!==e&&(this.queryString=e,this.publishUpdateEvent())}setExplicitLoadingState(e,t){var n;const r=this.isLoading!==e||this.resultReset!==t||this.isError||(null===(n=this._suggestions)||void 0===n?void 0:n.length);this.isLoading=e,this.isError=!1,this.resultReset=t,this._suggestions=[],r&&this.publishUpdateEvent()}clearQueryString(e){let t=""!==this.queryString;this.queryString="",e&&(t=t||""!==this.searchBoxQueryString,this.searchBoxQueryString=""),t&&this.publishUpdateEvent()}setTriggerMethod(e){this._triggeringMethod=e}get preloadedSuggestions(){var e;return null!==(e=this._preloadedSuggestions)&&void 0!==e?e:[]}get currentScope(){return this._queryDetection.getCurrentScope()}get menuType(){var e,t;return null!==(t=null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.menuType)&&void 0!==t?t:{menuType:"InlineSuggestionsResultsUserInitiatedMenuType",actions:[]}}get theme(){var e,t,n;return Ne(null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.theme,this._themeStore,null!==(n=null===(t=this.menuCurrentlyOpen)||void 0===t?void 0:t.enableExpandedECC)&&void 0!==n&&n)}get style(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.style}get styles(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.styles}get oaSettings(){return this._hostSettings.oaSettings}get accessibilitySettings(){return this._hostSettings}get enableScopedHeader(){var e,t,n,r;return(void 0===(null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.enableScopedHeader)||this.menuCurrentlyOpen.enableScopedHeader)&&"InlineSuggestionsResultsUserInitiatedMenuType"===(null===(t=this.menuCurrentlyOpen)||void 0===t?void 0:t.menuType.menuType)&&!0===(null===(r=null===(n=this._hostSettings.oaSettings)||void 0===n?void 0:n.scopesConfig)||void 0===r?void 0:r.enabled)}get unsupportedEntities(){return this._queryDetection.getUnsupportedEntities()}get queryChar(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.triggerCharacter}get showMoreEntitiesConfig(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.showMoreEntitiesConfig}get browseThisComputerConfig(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.browseThisComputerConfig}get appGptConfig(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.appGptConfig}get isFeedbackEnabled(){return!0===this._hostSettings.isFeedbackEnabledForEcc}get isFeedbackButtonEnabled(){var e,t;return!0===(null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.ECCFeedbackSettings)||void 0===t?void 0:t.isFeedbackButtonEnabled)}get enableExpandedECC(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.enableExpandedECC}get isDividerShown(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.isDividerShown}get isRtl(){var e,t;return null!==(t=null===(e=this._languageScriptDirectionDetector())||void 0===e?void 0:e.isRtl())&&void 0!==t&&t}get expandedEccSearchBarConfig(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.expandedEccSearchBarConfig}get fluentTheme(){var e;return null===(e=this._themeStore)||void 0===e?void 0:e.getExpandedEccFluentTheme()}get triggerMethod(){return this._triggeringMethod}get suggestions(){var e,t,n;if(!this.resultReset&&(null===(e=this._preloadedSuggestions)||void 0===e?void 0:e.length)&&(void 0===this.currentScope||this._preloadedSuggestions.some((e=>{var t;return e.entityType===(null===(t=this.currentScope)||void 0===t?void 0:t.entityType)})))){const e=this._preloadedSuggestions;return[...e,...(null!==(t=this._suggestions)&&void 0!==t?t:[]).filter((t=>!e.some((e=>e.entityType===t.entityType))))]}return null!==(n=this._suggestions)&&void 0!==n?n:[]}get noSuggestionsHeaderInfo(){var e;if(!this.isLoading&&0===this.suggestions.length){if(this.currentScope)return{title:(0,Fe.X)(this.currentScope.entityType),isScoped:!0,isScopingEnabled:!0,suggestions:[]};if(null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.noSuggestionsHeaderInfo)return Object.assign({},this.menuCurrentlyOpen.noSuggestionsHeaderInfo)}}get expandedECCHeader(){var e;const t=(0,Pe.$)().getStringsFor("InlineSuggestionStrings"),n=null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.supportedEntityTypes;if(!this.enableExpandedECC||!n)return[{type:l.c.Scope,title:t("allEntityTypeLabel"),iconName:"File",scopeInfo:{entityType:""},id:"allItems"}];const r=n.map((e=>({type:l.c.Scope,title:(0,Fe.X)(e),iconName:e,scopeInfo:{entityType:e},isSelected:1===n.length,id:e})));return n.length>1&&r.unshift({type:l.c.Scope,title:t("allEntityTypeLabel"),iconName:"File",scopeInfo:{entityType:""},id:"allItems"}),r}}var Re=n(11747);function Le(e,t,n){var r,i;const o=(null===(i=null===(r=e.hostSettings.serviceSettings)||void 0===r?void 0:r.browseThisComputerSettings)||void 0===i?void 0:i.enableBrowseThisComputerOnFileFlags)&&(!n||n.typeId===me.L9.CIQFlag_File);if(!o)return;const{browseThisComputerSettings:a}=e.hostSettings.serviceSettings||{},s=null==a?void 0:a.fluentMenuConfig,l=null==s?void 0:s.menuItems.map((n=>Object.assign(Object.assign({},n),{onClickHandler:()=>{const r=t(),i=r?Se(r,e):[];e.oaLogger.logActivity(re,void 0,[...i,(0,p.n)("eventType",n.menuItemId||"Unknown")]),n.onClickHandler()}})));return{isBrowseThisComputerEnabled:o,isUploadFileButtonEnabled:!n&&(null==a?void 0:a.isUploadFileButtonEnabled),onClickBrowseThisComputer:()=>{var n;const r=t(),i=r?Se(r,e):[];e.oaLogger.logActivity(re,void 0,[...i,(0,p.n)("eventType","CIQUploadButtonClicked")]),null===(n=null==a?void 0:a.onBrowseThisComputerCallback)||void 0===n||n.call(a)},browseThisComputerButtonLabel:e.localizer.getMessage("ebx_browseThisComputerLabel"),enableCloudPicker:null==a?void 0:a.enableCloudPicker,fluentMenuConfig:s&&Object.assign(Object.assign({},s),{menuItems:l||[]}),eventTarget:null==a?void 0:a.eventTarget}}function Me(e){const t=Math.floor(Math.abs(e));return(t<10?"0":"")+t}const qe=(e,t,n,r,i,o)=>({ConversationId:t,ImpressionType:r,LocalTime:(new Date).toISOString(),ProviderName:i,Results:o,LogicalId:e,TraceId:n,Version:2});function We(e,t){const n="TopHits",r={};r[n]=[],e.forEach((e=>{e.entities.forEach((e=>{if(e.isBestMatch)r[n].push(e);else{const t=e.entityType;r[t]?r[t].push(e):r[t]=[e]}}))})),0===r[n].length&&delete r[n];const i=[];let o=1;for(const e in r){const a=r[e];let s=1;i.push(Object.assign({Type:"Group",Name:e===n?n:a[0].entityType,LayoutType:"Vertical",Position:o,ResultsView:r[e].map((e=>({Type:"Entity",EntityType:`${e.entityType}Suggestion`,ReferenceId:e.ReferenceId,Position:s++,PlacementType:"Visible"})))},t&&{MetaData:t})),o++}return i}var Ue,ze,je;!function(e){e[e.Unknown=0]="Unknown",e[e.Title=1]="Title",e[e.Subtitle=2]="Subtitle",e[e.Heading1=3]="Heading1",e[e.Heading2=4]="Heading2",e[e.Heading3=5]="Heading3"}(Ue||(Ue={})),function(e){e.Installed="Installed",e.NotInstalled="NotInstalled"}(ze||(ze={})),function(e){e.Query="Query",e.Action="Action"}(je||(je={}));var He=n(93381),Ve=n(52484);const Ge=6e4,Qe=60*Ge,Ke=24*Qe,$e=7,Ze=24,Je=1,Xe=2,Ye=.8,et=-10*Ge;function tt(e,t){const n=(0,Pe.$)().getStringsFor("DateTimeStrings"),r=(e,...t)=>{let r=n(e);return t.filter(Boolean).forEach(((e,t)=>{r=r.replace(`{${t}}`,e)})),r},i=t.getTime()-e.getTime();if(i<0)return i<=et?"":r("justNow");const o=Math.round(i/Ke),a=Math.round(i/Qe);if(o>$e)return function(e,t){const n=(0,Pe.$)().getStringsFor("MonthsNames"),r=[n("January"),n("February"),n("March"),n("April"),n("May"),n("June"),n("July"),n("August"),n("September"),n("October"),n("November"),n("December")][e.getMonth()],i=`${r} ${e.getDate().toString()}, ${e.getFullYear().toString()}`,o=`${r} ${e.getDate().toString()}`;return t.getFullYear()===e.getFullYear()?o:i}(e,t);if(a>=Ze)return o>1?r("daysAgo",o.toString()):r("oneDayAgo");if(a>=Xe)return a>1?r("hoursAgo",a.toString()):r("oneHourAgo");if(a>=Ye)return Je>1?r("hoursAgo",Je.toString()):r("oneHourAgo");const s=Math.round(i/Ge);return s<=Xe?r("justNow"):r("minutesAgo",s.toString())}var nt;!function(e){e[e.AuthorName=0]="AuthorName",e[e.EmailSenderName=1]="EmailSenderName",e[e.FallbackValue=2]="FallbackValue",e[e.LastModifiedByUser=3]="LastModifiedByUser",e[e.LastModifiedByContact=4]="LastModifiedByContact",e[e.LastAccessedByUser=5]="LastAccessedByUser",e[e.SentByUser=6]="SentByUser",e[e.DateCreatedByUser=7]="DateCreatedByUser",e[e.UserCreatedBy=8]="UserCreatedBy"}(nt||(nt={}));const rt=e=>{if(!e)return"";const t=e.includes("Z")?e:`${e}Z`;return tt(new Date(t),new Date)};var it=n(59134);function ot(e,t,n,r,i,o,a,s,d){return function(e){return e.entityType===l.c.People}(e)?at(e,t):function(e){return e.entityType===l.c.File}(e)?function(e,t,n,r){var i;if(!(e.AccessUrl&&e.FileName&&e.FileExtension&&e.FileSourceType))return;const{FileExtension:o,FileName:a,FileSourceType:s,AccessUrl:d}=e,u=function(e){if(!e)return"";const t=e.lastIndexOf(".");return t>-1?e.substring(0,t):e}(a),c=((e,t,n,r)=>{var i,o,a,s;const l=(0,Pe.$)().getStringsFor("FileTidbitStrings"),d=(e,...t)=>{let n=l(e);return t.filter(Boolean).forEach(((e,t)=>{n=n.replace(`{${t}}`,e)})),n},u=((e,t,n,r)=>{var i;const{Author:o,From:a,DateAccessed:s,DateCreated:l,DateModified:d,SharedDateTime:u,propertyHits:c,UserRelationshipType:g}=e;if(n&&r&&g!==Ve.b.Uploaded)return nt.LastAccessedByUser;const h=(o||(null===(i=null==a?void 0:a.EmailAddress)||void 0===i?void 0:i.Name)||"").trim(),p=h===t;if(n){const e=(null==c?void 0:c.includes("EmailSenderName"))||(null==c?void 0:c.includes("EmailSenderAddress")),t=(null==c?void 0:c.includes("Author"))||(null==c?void 0:c.includes("AuthorEmail"));if(g===Ve.b.Uploaded)return t?nt.UserCreatedBy:nt.DateCreatedByUser;if(e)return p?nt.SentByUser:nt.EmailSenderName;if(t)return nt.AuthorName;if(g===Ve.b.None&&(null==a?void 0:a.EmailAddress)&&u)return nt.EmailSenderName;if(s){const e=s.includes("Z")?s:`${s}Z`,t=new Date(e),n=new Date;if(Math.floor((n.getTime()-t.getTime())/864e5)<10)return nt.LastAccessedByUser;if((null==a?void 0:a.EmailAddress)&&u){const e=u.includes("Z")?u:`${u}Z`;if(new Date(e)>t)return p?nt.SentByUser:nt.EmailSenderName}return nt.LastAccessedByUser}}return(null==a?void 0:a.EmailAddress)&&u?p?nt.SentByUser:nt.EmailSenderName:d&&h?p?nt.LastModifiedByUser:nt.LastModifiedByContact:p&&s?nt.LastAccessedByUser:h&&l?nt.AuthorName:nt.FallbackValue})(e,t,n,r),c=e.Author||(null===(o=null===(i=e.From)||void 0===i?void 0:i.EmailAddress)||void 0===o?void 0:o.Name)||"",g=(null===(s=null===(a=e.From)||void 0===a?void 0:a.EmailAddress)||void 0===s?void 0:s.Name)||"";switch(u){case nt.AuthorName:return d("userCreatedOnDate",c,rt(e.DateCreated));case nt.DateCreatedByUser:return d("youCreatedOnDate",rt(e.DateCreated));case nt.UserCreatedBy:return d("userCreatedBy",c);case nt.LastAccessedByUser:return d("youOpenedOnDate",rt(e.DateAccessed));case nt.LastModifiedByUser:return d("youModifiedOnDate",rt(e.DateModified));case nt.LastModifiedByContact:return d("userModifiedOnDate",c,rt(e.DateModified));case nt.EmailSenderName:return d("userSentOnDate",g,rt(e.SharedDateTime));case nt.SentByUser:return d("youSentOnDate",rt(e.SharedDateTime));case nt.FallbackValue:return void 0!==e.SecondaryText?e.SecondaryText:d("weFoundThisFile")}})(e,t,r,n);return Object.assign(Object.assign({},e),{type:l.c.File,sourceType:st(s),fileName:a,hitFileName:u,fileExtension:o,url:d,lastAccessDateTime:e.DateAccessed,lastModifiedDateTime:e.DateModified,createdDateTime:e.DateCreated,itemId:e.Id,fileSize:null!==(i=e.FileSize)&&void 0!==i?i:0,subject:c,titleHitHighlightProperty:"hitFileName",subtitleHitHighlightProperty:"subject"})}(e,n,r,s):function(e){return e.entityType===l.c.Topic}(e)?function(e){return Object.assign(Object.assign({},e),{type:e.entityType,id:e.TopicId,title:e.DisplayName,subtitle:e.Description,iconName:"Hashtag",tooltip:e.Description})}(e):function(e){return e.entityType===l.c.MessageExtensionApp}(e)?function(e,t){const n=!!t&&t.get(e.AppId);var r;if(n&&((r=n.State)&&r!==ze.NotInstalled))return Object.assign(Object.assign({},e),{type:e.entityType,id:e.AppId,title:e.DisplayName,subtitle:n.Description,imageUrl:n.IconUrl,tooltip:n.Description})}(e,a):function(e){return e.entityType===l.c.External}(e)?function(e,t,n){var r,i;const o=function(e,t){let n="";return e.SecondaryText?n=e.SecondaryText:e.ContentDomainName?n=e.ContentDomainName:e.Authors.length>0?n=1===e.Authors.length?`${t.getMessage("authorLabel")}: ${e.Authors[0]}`:`${t.getMessage("authorsLabel")}: ${e.Authors.join(", ")}`:e.LastModifiedDateTimeUtc&&(n=`${t.getMessage("lastModifiedDateLabel")} ${tt(new Date(e.LastModifiedDateTimeUtc),new Date)}`),n}(e,t);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},e),{type:n&&null!==(r=e.GroupDisplayName)&&void 0!==r?r:e.entityType,id:e.ItemId,title:e.text,subtitle:o,tooltip:e.text}),!e.IconUrl&&{iconName:null===(i=e.icon)||void 0===i?void 0:i.iconName}),e.IconUrl&&{imageUrl:e.IconUrl}),{subtitleHitHighlightProperty:"ContentDomainName"})}(e,i,d):function(e){return e.entityType===l.c.Event}(e)?function(e){return Object.assign(Object.assign({},e),{type:e.entityType,id:e.text,eventId:e.OriginalId||e.entityId||e.text,eventName:e.text,eventStartDateTime:e.Start,eventEndDateTime:e.End,isAllDay:e.IsAllDay,isSeries:!!e.SeriesMasterId,hasRecording:e.HasRecording})}(e):function(e){return e.entityType===l.c.Message}(e)?function(e){var t,n,r,i,o,a;return Object.assign(Object.assign({},e),{type:l.c.Message,id:e.text,subject:e.Subject,sender:null!==(a=null!==(r=null===(n=null===(t=e.From)||void 0===t?void 0:t.EmailAddress)||void 0===n?void 0:n.Name)&&void 0!==r?r:null===(o=null===(i=e.From)||void 0===i?void 0:i.EmailAddress)||void 0===o?void 0:o.Address)&&void 0!==a?a:"",emailId:e.ItemId.Id})}(e):function(e){return e.entityType===l.c.Chat}(e)?function(e){var t,n,r,i,o,a,s,l,d,u;return Object.assign(Object.assign(Object.assign(Object.assign({},e),{id:e.text}),!e.IconUrl&&{iconName:null!==(n=null===(t=e.icon)||void 0===t?void 0:t.iconName)&&void 0!==n?n:"OfficeChat"}),{type:e.entityType,title:e.Name,name:e.Name,threadId:e.ThreadId,threadType:null!==(i=null===(r=e.ThreadType)||void 0===r?void 0:r.toString())&&void 0!==i?i:"",teamName:e.Name,groupId:e.GroupId,matchingMembers:null!==(a=null===(o=e.MatchingMembers)||void 0===o?void 0:o.map((e=>at(e,void 0))))&&void 0!==a?a:[],chatMembers:null!==(l=null===(s=e.ChatMembers)||void 0===s?void 0:s.map((e=>at(e,void 0))))&&void 0!==l?l:[],totalChatMembersCount:null!==(d=e.TotalChatMembersCount)&&void 0!==d?d:0,lastMessageTime:null!==(u=e.LastMessageTime)&&void 0!==u?u:"",imageUrl:e.IconUrl})}(e):function(e){return e.entityType===l.c.Channel}(e)?function(e,t){var n,r;return Object.assign(Object.assign(Object.assign(Object.assign({},e),{type:e.entityType,id:e.text,title:e.Name,subtitle:t.getMessage("channelOfTeamLabel",e.TeamName),tooltip:e.Name}),!e.IconUrl&&{iconName:null!==(r=null===(n=e.icon)||void 0===n?void 0:n.iconName)&&void 0!==r?r:"OfficeChat"}),e.IconUrl&&{imageUrl:e.IconUrl})}(e,i):function(e){return e.entityType===l.c.Team}(e)?function(e){var t,n;return Object.assign(Object.assign(Object.assign(Object.assign({},e),{type:e.entityType,id:e.text,title:e.Name,tooltip:e.Name}),!e.IconUrl&&{iconName:null!==(n=null===(t=e.icon)||void 0===t?void 0:t.iconName)&&void 0!==n?n:"OfficeChat"}),e.IconUrl&&{imageUrl:e.IconUrl})}(e):function(e){return e.entityType===l.c.App}(e)?function(e){return Object.assign(Object.assign({},e),{id:e.CollectorId,type:l.c.App,title:e.Title,imageUrl:e.IconAnonymousUrl})}(e):function(e){return e.entityType===l.c.PIM}(e)?function(e){const t=function(e){let t="PhoneNumber";return e===He.Nm.Address?t="Location":e===He.Nm.Membership&&(t="Member"),t}(e.IntentId),n=function(e){var t;let n="";return e.entityType===l.c.PIM?n=null!==(t=e.SecondaryText)&&void 0!==t?t:"":"Phones"in e&&e.Phones&&e.Phones.length>0&&e.Phones[0].Type&&(n=e.Phones[0].Type),n}(e);return Object.assign(Object.assign({},e),{type:l.c.PIM,id:e.text,title:e.text,tooltip:e.text,subtitle:n,iconName:t})}(e):function(e){return e.entityType===l.c.Scope}(e)?function(e,t){var n,r;const i=e.entityType,o=e.ScopeDisplayName||"";let a;a="Meetings"===e.ScopeDisplayName?"Event":e.ScopeDisplayName;let s=!1;const l=new Date;if(t)for(const r of t){const t=new Date(r[1]);r[0]===(null===(n=e.scopeInfo)||void 0===n?void 0:n.entityType)&&l<=new Date(t.setDate(t.getDate()+14))&&(s=!0)}return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},e),{type:i,id:null!==(r=e.id)&&void 0!==r?r:e.text,title:o}),!e.IconUrl&&{iconName:a}),e.IconUrl&&{imageUrl:e.IconUrl}),{isNew:s})}(e,o):function(e){var t,n,r;const i=e.entityType,o=e.subtitle,a=null!==(t=e.tooltip)&&void 0!==t?t:"",s=(i===l.c.Scope?e.ScopeDisplayName:e.text)||"";return Object.assign(Object.assign(Object.assign(Object.assign({},e),{type:i,id:null!==(n=e.id)&&void 0!==n?n:e.text,title:s,subtitle:o,tooltip:a}),!e.IconUrl&&{iconName:null===(r=e.icon)||void 0===r?void 0:r.iconName}),e.IconUrl&&{imageUrl:e.IconUrl})}(e)}function at(e,t){var n;const r=(0,it.u)(e);let i=e.imageUrl;i||(i=null==t?void 0:t.fetchCachedProfilePicture(r));const o=e.subtitlePropertyOverride;return Object.assign(Object.assign({},e),{ReferenceId:e.ReferenceId||e.entityId,type:l.c.People,displayName:e.text,primaryEmailAddress:r,subtitleOverride:o?e[o]:void 0,imageUrl:i,titleHitHighlightProperty:"displayName",subtitleHitHighlightProperty:null!==(n=o)&&void 0!==n?n:"primaryEmailAddress"})}function st(e){switch(e){case"ClassicAttachment":return f.x.ClassicAttachment;case"OneDriveForBusiness":return f.x.OneDriveForBusiness;case"SharepointOnline":return f.x.SharepointOnline;default:return f.x.Undefined}}function lt(e,t){const{browseThisComputerConfig:n,getQueryRangeBoundingClientRect:r,handleEccUploadMenuEvent:i,handleKeyDown:o,menuParentElement:a,onDismissed:s,onPreventDismissOnEvent:l}=e.calloutProps,d=async e=>{await async function(e,t){const n=await(null==t?void 0:t());return!!n&&(e.clientX>=n.x&&e.clientX<=n.x+n.width&&e.clientY>=n.y&&e.clientY<=n.y+n.height)}(e,r)||(0,ue.m)(e.target)||(0,ue.Y)(e.target)||s(!1)},u=async e=>{l&&!l(e)&&s(!1)},c=[];if(a){const e=new v.J(a),r=new v.J(a.ownerDocument);let s;e.addListener("keydown",o),r.addListener("mouseup",d,{capture:!0}),t&&r.addListener("scroll",u,{capture:!0}),c.push(e),c.push(r),(null==n?void 0:n.eventTarget)&&i&&(s=new v.J(n.eventTarget),s.addListener("AttachCloudFilesSelected",i),s.addListener("UploadLocalFilesSelected",i)),s&&c.push(s)}return()=>{for(const e of c)e.removeAllListeners()}}let dt=class{constructor(e,t,n,r,i,_,b,C,S,T,I,w,E,x,A,D,k,F,P,N,B,O,M,q,W,U,z,j,H,Q,K,$){var Z;this._hostSettings=e,this._oaLogger=t,this._logger=n,this._guidGenerator=r,this._oaMetric=i,this._hostEmitter=_,this._proofingDom=b,this._paragraphTextExtractor=C,this._tileContent=S,this._oaResultStore=T,this._queryDetection=I,this._localizer=w,this._featureFlagsReader=E,this._proofingEmitter=x,this._safeWindow=A,this.languageScriptDirectionDetector=D,this._targetWindowFactory=F,this._targetDocumentFactory=P,this._paneOpenState=N,this._ariaStatusStateStoreFactory=B,this._indicatorStore=O,this._calloutDismissalHandler=M,this._externalSettingsFeature=q,this._instrumentationProcessor=W,this.feedbackStoreFactory=U,this._messageExtensionAppDataProvider=z,this.defaultInlineSuggestionItems=j,this.themeStore=H,this.userProfilePictureCache=Q,this._isMobile=$,this._menus=new Map,this.resultStatus=void 0,this._isClearingSearch=!1,this._isCIQMentionsEnabled=!0,this._isFirstMenuUpdate=!1,this._fileCount=0,this._queryCorrelationKeys=void 0,this.initialize=async()=>{var e;this._hostSettings.enableOrchestration&&(null===(e=this._hostSettings.oaSettings)||void 0===e?void 0:e.isContextualCardEnabled)&&(this._hostEmitter.on(u.pD.hostModelDelta,this._handleDelta),this._hostEmitter.on(u.pD.hostModelTextTile,this._handleTextTile),this._hostEmitter.on(u.pD.nudgeAccepted,this.handleNudgeAccepted),this._hostEmitter.on(u.pD.ciqSettingsChange,this.ciqSettingsChange),this._hostEmitter.on(u.pD.hostModelRehydrateTilesFinished,this.hostModelRehydrateTilesFinished),this._hostEmitter.on(u.pD.hostModelVisualStateChange,this.hostModelVisualStateChange),this._calloutState.subscribe("menuUpdated",this.onMenuChanged))},this.shutDown=()=>{var e;null===(e=this._menuEventListenersDisposal)||void 0===e||e.call(this),this._menus.clear(),this._calloutState.updateCurrentMenu(void 0,void 0,void 0),this._scrollThrottle=void 0,this._resizeThrottle=void 0,this._calloutState.unsubscribe("menuUpdated",this.onMenuChanged)},this.onMenuChanged=e=>{this._proofingEmitter.emit("eccStateChanged",e)},this.hostModelVisualStateChange=e=>{var t,n;if(this._menuCurrentlyOpen&&e.message.tileId===this._menuCurrentlyOpen.parentTileId)if(e.message.created){this.renderECC(!1),null===(t=this._menuEventListenersDisposal)||void 0===t||t.call(this);const e=this._calloutState.getCalloutState();e&&(this._menuEventListenersDisposal=lt(e,null!==(n=this._hostSettings.useFluentV9)&&void 0!==n&&n))}else this._isMobile||this.dismissECC(!1)},this.renderMenuWithItems=async(e,t,n,r,i,o,a,s,l)=>{const d=this.isFlightEnabled("mc-editor-enable-searchbar");return this.showMenu(e,0,0,void 0,!0,{supportedEntityTypes:void 0,onItemSelected:i,theme:o,style:a,styles:s,shouldRemoveTextOnItemSelection:!1,specifiedItemsToDisplay:r,getLocalItems:l,expandedEccSearchBarConfig:this._searchBox.buildExpandedEccSearchBarConfig(d),browseThisComputerConfig:Le(this.getServices(),(()=>this._menuCurrentlyOpen)),appGptConfig:this.buildAppGptConfig(),enableExpandedECCSearchBar:d},n,!1,t)},this.showExistingMenu=async(e,t,n,r,i,o,a,s,l,d,u)=>{const c=this._menus.get(r);return!!c&&this.showMenu(e,t,n,r,i,Object.assign(Object.assign({},c),{shouldRemoveTextOnItemSelection:o,specifiedItemsToDisplay:l,expandedEccSearchBarConfig:this._searchBox.buildExpandedEccSearchBarConfig(c.enableExpandedECCSearchBar),browseThisComputerConfig:Le(this.getServices(),(()=>this._menuCurrentlyOpen)),appGptConfig:this.buildAppGptConfig(),onItemSelected:null!=s?s:c.onItemSelected,supportedEntityTypes:a||l?a:c.supportedEntityTypes,onSuggestionsUpdated:l?void 0:c.onSuggestionsUpdated}),d,u)},this.showMenu=async(e,t,n,r,i,o,a,s,l)=>{var d,u;if(this._menuCurrentlyOpen)return!1;const c=this._proofingDom.findParagraphNode(e);if((0,R.l)(c)){const e=this._paragraphTextExtractor.getParagraphText(c);if(void 0!==e){const g=e.substring(t,t+n),h=g.charAt(0)===r,p={start:t,length:n,prefix:void 0!==r&&h?r:""};return this.setMenuCurrentlyOpen(r,o,c,p,void 0,null!=a?a:{menuType:"InlineSuggestionsResultsUserInitiatedMenuType",actions:this.buildInlineSuggestionsResultsMenuActions("userInitiated")},i,o.shouldRemoveTextOnItemSelection,s,null===(d=this._queryDetection.getCurrentQueryCorrelationKeys())||void 0===d?void 0:d.source,l,g),(null===(u=this._calloutState.menuCurrentlyOpen)||void 0===u?void 0:u.specifiedItemsToDisplay)||be(this.getServices(),r,g,p,c,void 0),this.prepareAndRenderECC(c,g)}}return!1},this.showEntityPrediction=async(e,t,n,r,i,o)=>{var a,s;const l=null!==(s=null!==(a=this._menus.get(void 0))&&void 0!==a?a:this._menus.get(this._hostSettings.ciqTriggeringChar||"/"))&&void 0!==s?s:this.getDefaultMenuInformation();return this.showMenu(e,t,0,void 0,!0,Object.assign(Object.assign({},l),{supportedEntityTypes:void 0,shouldRemoveTextOnItemSelection:!1,specifiedItemsToDisplay:n,onItemSelected:(e,t)=>{r(e,t)},onOpen:void 0,onClose:()=>{null==i||i()}}),{menuType:"InlineSuggestionsEntityPredictionMenuType"},!1,o)},this.onSearchBoxQueryChange=(e,t)=>{this._searchBox.onSearchBoxQueryChange(e,t)},this.buildAppGptConfig=()=>{var e;const{appGptConfig:t}=null!==(e=this._hostSettings.serviceSettings)&&void 0!==e?e:{};if(null==t?void 0:t.enableAppGpt)return t},this.showFlag=async(e,t,n,r,i,a,s,l,d)=>{var u,g,h,p,f,v,m;if(!e.nodeId)return!1;this._oaResultStore.clearResults(),this._queryDetection.removeDetectedQuery();const y=null!==(g=null!==(u=this._menus.get(void 0))&&void 0!==u?u:this._menus.get(this._hostSettings.ciqTriggeringChar||"/"))&&void 0!==g?g:this.getDefaultMenuInformation(),_=ye(e.typeId);if(void 0===_)return this._oaLogger.logDiagnostics("Unable to determine type of flag for critique type: "+e.typeId),!1;const b=this._proofingDom.findParagraphNode(e.nodeId);if((0,R.l)(b)){const u={start:e.start-b.element.offset,length:e.length,prefix:""},g=null!==(h=this._paragraphTextExtractor.getQueryString(b,u))&&void 0!==h?h:"";if(g){let h=!1;return this.setMenuCurrentlyOpen(void 0,Object.assign(Object.assign({},y),{supportedEntityTypes:e.supportedEntityTypes,specifiedItemsToDisplay:null!==(p=e.suggestionItems)&&void 0!==p?p:y.specifiedItemsToDisplay,shouldRemoveTextOnItemSelection:!1,onOpen:void 0,onClose:t=>{var r;t||null===(r=this._instrumentationProcessor)||void 0===r||r.process({critique:(0,ce.toJS)(e),eventId:V.xp.ClickNoAction}),n(void 0,h)},critiqueRange:u,onItemSelected:(r,i)=>{var o;null===(o=this._instrumentationProcessor)||void 0===o||o.process({critique:(0,ce.toJS)(e),eventId:V.xp.ChangeSuggOther}),t(e,r,i),n(!1,!1)},onFooterAction:async t=>{var l,u,g,p;let f;switch(t){case J._R.IgnoreOnce:f=V.xp.Ignore,null==r||r(e);break;case J._R.IgnoreAll:f=V.xp.IgnoreAll,null==i||i(e);break;case J._R.IgnoreRule:f=V.xp.DoNotCheckThisIssue,null==a||a(e);break;case J._R.OpenEditorPane:null===(u=null===(l=this._indicatorStore)||void 0===l?void 0:l.onOpenEditorPane)||void 0===u||u.call(l,o.k.ContextualCard),n(void 0,!1);break;case J._R.Options:null===(g=this._externalSettingsFeature)||void 0===g||g.openSettings(c.kY.dropdown);break;case J._R.Feedback:null==s||s(e);break;case J._R.Next:return h=!0,this.dismissECC(!1),void this.navigateWithDelay(d,1);case J._R.Previous:return h=!0,this.dismissECC(!1),void this.navigateWithDelay(d,-1)}f&&(null===(p=this._instrumentationProcessor)||void 0===p||p.process({critique:(0,ce.toJS)(e),eventId:f})),this.dismissECC(!1)},onSuggestionsUpdated:async(t,n,r,i,o,a,s,l,d,u,c,g,h)=>{let p=t;if(!e.suggestionItems&&y.onSuggestionsUpdated){if(p=await y.onSuggestionsUpdated(t,n,r,i,o,a,s,l,d,u,c,this.logWithMenuData,h),!p)return;e.supportedEntityTypes&&(p=p.filter((t=>{var n;return null===(n=e.supportedEntityTypes)||void 0===n?void 0:n.includes(t.entityType)})))}for(const t of p){e.groupTitle&&(t.groupTitle=e.groupTitle),e.groupSubtitle&&(t.groupSubtitle=e.groupSubtitle);for(const e of t.entities)e.isBestMatch=!1}return p},showMoreEntitiesConfig:this._searchBox.buildShowMoreEntitiesConfig(e,g,u,b),browseThisComputerConfig:Le(this.getServices(),(()=>this._menuCurrentlyOpen),e),appGptConfig:this.buildAppGptConfig(),expandedEccSearchBarConfig:this._searchBox.buildExpandedEccSearchBarConfig(y.enableExpandedECCSearchBar)}),b,u,{x:0,y:3},{menuType:"InlineSuggestionsResultsFlagMenuType",flag:_,brandingMode:this._hostSettings.brandingMode,actions:this.buildInlineSuggestionsResultsMenuActions("flag",!1,_!==J.z4.Topic,void 0!==d),critiqueSetSize:l?(0,de.v)(l).length:void 0,critiquePosition:null==l?void 0:l.currentIndex},_!==J.z4.File,!0,!1,null===(f=this._queryDetection.getCurrentQueryCorrelationKeys())||void 0===f?void 0:f.source,void 0,g),(null===(v=this._menuCurrentlyOpen)||void 0===v?void 0:v.specifiedItemsToDisplay)||be(this.getServices(),null===(m=this._menuCurrentlyOpen)||void 0===m?void 0:m.triggerCharacter,g,u,b,void 0),this.prepareAndRenderECC(b,g)}}return!1},this.onFooterAction=e=>{var t;(null===(t=this._menuCurrentlyOpen)||void 0===t?void 0:t.onFooterAction)?this._menuCurrentlyOpen.onFooterAction(e):this.runDefaultFooterActionIfAvailable(e)},this.onSuggestionsUpdated=async(e,t,n,r,i,o,a,s,l,d,u,c,g)=>{var h,p,f;if(this._menuCurrentlyOpen)return this._menuCurrentlyOpen.specifiedItemsToDisplay&&(e=await n(this._menuCurrentlyOpen.specifiedItemsToDisplay)),null!==(f=null===(p=(h=this._menuCurrentlyOpen).onSuggestionsUpdated)||void 0===p?void 0:p.call(h,e,t,n,r,i,o,a,s,l,d,u,this.logWithMenuData,g))&&void 0!==f?f:e;this._oaLogger.logDiagnostics("Received suggestions update with no menu open")},this.logWithMenuData=(e,t,n)=>{const r=this.getDefaultLogDataForMenu();r.push(...null!=n?n:[]),this._oaLogger.logActivity(e,t,r)},this.handleNudgeAccepted=e=>{const t=e.message.data.nudge,n={hasEntityResults:void 0!==t.entityResults,entityType:t.entityType};!e.message.data.fromUserAction&&this._menuCurrentlyOpen?(this._menuCurrentlyOpen.wasOpenedViaNudge=!0,this._menuCurrentlyOpen.wasOpenedViaNudgeInfo=n):this._nextMenuOpenIsViaNudge=n},this._handleTextTile=e=>{if(e.message.messageType===g.G.RemoveData){const t=e.message.data.tileId;if(this._menuCurrentlyOpen){const e=t===this._menuCurrentlyOpen.tileId,n=this._proofingDom.findParagraphNode(this._menuCurrentlyOpen.tileId);(e||!n&&!this._isClearingSearch)&&this.dismissECC(!1)}}},this.ciqSettingsChange=e=>{this._isCIQMentionsEnabled=e.message.isCIQMenuEnabled},this.hostModelRehydrateTilesFinished=()=>{var e;if(!(null===(e=this._menuCurrentlyOpen)||void 0===e?void 0:e.parentTileId)||void 0===this._menuCurrentlyOpen.parentTileOffset)return;if(this._featureFlagsReader.flags.disableECCMenuRecreationOnALReconnection)return;const t=this._proofingDom.findTileNode(this._menuCurrentlyOpen.parentTileId);if(!t)return;const n=this._menuCurrentlyOpen.parentTileOffset+this._menuCurrentlyOpen.queryRange.start;let r;if(t.children)for(const e of t.children)if(e.element&&e.element.offset<=n&&e.element.offset+e.element.span>=n){r=e;break}if(!r)return;this._menuCurrentlyOpen.tileId=r.id;const i=this._paragraphTextExtractor.getQueryString(r,this._menuCurrentlyOpen.queryRange,!0);void 0!==i&&(this._oaResultStore.updateLoadingStatus(!0),be(this.getServices(),this._menuCurrentlyOpen.triggerCharacter,i,this._menuCurrentlyOpen.queryRange,r,this._queryDetection.getCurrentScope()))},this.notifyMenuTriggeringMethod=e=>{this._calloutState.setTriggerMethod(e)},this._handleDelta=async e=>{var t,n,r,i,o,a,s,d,u,c,g,p,f,v,m,y,_,b,C,S,T;const I=e.message;if(I.sourceType===h.pf.TileNode)return;const{changeType:w,delta:E,tileId:x}=I,A="InlineSuggestionsResultsUserInitiatedMenuType"!==(null===(t=this._menuCurrentlyOpen)||void 0===t?void 0:t.menuType.menuType);if((E.unit===G.OD.Sentence||E.unit===G.OD.Paragraph)&&(E.deltaType===G.WI.Add||E.deltaType===G.WI.Update)&&((null!==(r=null===(n=E.content)||void 0===n?void 0:n.length)&&void 0!==r?r:0)>1||0===(null===(i=E.content)||void 0===i?void 0:i.length))&&void 0===E.queryRange===(void 0===this._menuCurrentlyOpen||A))return;const D=!this._isClearingSearch;if(w!==h.Q0.Local){if(this._menuCurrentlyOpen){const e=null===(o=this._queryDetection.getCurrentQuery())||void 0===o?void 0:o.queryRange;if(e)this._menuCurrentlyOpen.queryRange=e,this._menuCurrentlyOpen.searchBoxGeneratedParagraphId||(null===(a=E.additionalData)||void 0===a?void 0:a.scopeInfo)||this.tryToUpdatePreloadedItems(E,x,!0);else{if(!D)return void(this._isClearingSearch=!1);this.dismissECC(!1)}}return}(null===(s=this._menuCurrentlyOpen)||void 0===s?void 0:s.shouldDismissOnTyping)&&this.dismissECC(!1);const k=this._proofingDom.findParagraphNode(x),F=null===(d=E.queryRange)||void 0===d?void 0:d.prefix;if(E.queryRange){if(!this._isCIQMentionsEnabled&&!1!==this._hostSettings.isHidingCIQMenuSupported&&(null!==(u=E.queryRange.prefix)&&void 0!==u?u:"@")===(null!==(c=this._hostSettings.ciqTriggeringChar)&&void 0!==c?c:"/"))return;const e=!this._menuCurrentlyOpen,t=!k&&(null===(g=this._menuCurrentlyOpen)||void 0===g?void 0:g.searchBoxGeneratedParagraphId)?E.content:this._paragraphTextExtractor.getQueryString(k,E.queryRange);if(this._menuCurrentlyOpen){if(void 0===t)return void this.dismissECC(!1);this._menuCurrentlyOpen.queryRange=E.queryRange,this._menuCurrentlyOpen.keyStrokes=this._menuCurrentlyOpen.keyStrokes+1,this.updateSpecifiedItemsToDisplay(x,t,!1),null===(f=(p=this._menuCurrentlyOpen).onQueryUpdated)||void 0===f||f.call(p,t),this._oaLogger.logActivity(ee,void 0,[...this.getDefaultLogDataForMenu()])}else if((0,R.l)(k)&&void 0!==t){const e=this._menus.get(F),n=this._hostSettings.eccTargetOffset;if(e){if((e.enableExpandedECC||(null===(m=null===(v=this._hostSettings.oaSettings)||void 0===v?void 0:v.scopesConfig)||void 0===m?void 0:m.enabled))&&E.additionalData){let t;(null===(y=this._nextMenuOpenIsViaNudge)||void 0===y?void 0:y.entityType)===l.c.File&&!this._nextMenuOpenIsViaNudge.hasEntityResults&&(null===(b=null===(_=this._hostSettings.serviceSettings)||void 0===_?void 0:_.nudge)||void 0===b?void 0:b.automaticallyScope)&&(t=l.c.File),e.enableExpandedECC&&(null===(C=this._hostSettings.oaSettings)||void 0===C?void 0:C.scopeToPeopleTabInExpandedECC)&&"@"===F&&(t=l.c.People),!e.enableExpandedECC&&(null===(S=this._hostSettings.oaSettings)||void 0===S?void 0:S.scopeToAppGptInlineSuggestion)&&"@"===F&&(t=l.c.App),t&&(this._queryDetection.setCurrentScope({entityType:t},!1),E.additionalData.scopeInfo={entityType:t})}this.setMenuCurrentlyOpen(F,Object.assign(Object.assign({},e),{expandedEccSearchBarConfig:this._searchBox.buildExpandedEccSearchBarConfig(e.enableExpandedECCSearchBar),browseThisComputerConfig:Le(this.getServices(),(()=>this._menuCurrentlyOpen)),appGptConfig:this.buildAppGptConfig()}),k,E.queryRange,n,{menuType:"InlineSuggestionsResultsUserInitiatedMenuType",brandingMode:e.brandingMode,actions:this.buildInlineSuggestionsResultsMenuActions("userInitiated")},!1,!0,!1,null===(T=this._queryDetection.getCurrentQueryCorrelationKeys())||void 0===T?void 0:T.source,void 0,t),1!==E.queryRange.length&&this._calloutState.menuCurrentlyOpen&&(this._calloutState.menuCurrentlyOpen.keyStrokes=this._calloutState.menuCurrentlyOpen.keyStrokes+1),this.prepareAndRenderECC(k,t),this._oaLogger.logActivity(ee,void 0,[...this.getDefaultLogDataForMenu()])}}this.tryToUpdatePreloadedItems(E,x,e)}else D&&this.dismissECC(!1)},this.updatePreloadedItemsDebounced=(0,le.debounce)(this.updatePreloadedItems,200),this.handleEccUploadMenuEvent=e=>{this._menuCurrentlyOpen&&function(e,t,n){try{const r=n.detail,i=Se(t,e);e.oaLogger.logActivity(re,r,[...i,(0,p.n)("eventType",n.type)])}catch(t){e.logger.error(506557473,`Failed to log uploadMenuEvent ${n.type}`,t)}}(this.getServices(),this._menuCurrentlyOpen,e)},this.handleKeyDown=e=>{(async e=>{var t,n,r,i;if(this._menuCurrentlyOpen){for(const t of[a.m.arrowDown,a.m.arrowUp,a.m.arrowLeft,a.m.arrowRight,a.m.enter,a.m.tab,a.m.end,a.m.home])if((s.x.isKey(e,t)||s.x.isKey(e,t,!1,!1,!1,!0))&&this.handleExternalKeyboardEvents(t,e.altKey,e.shiftKey))return e.stopPropagation(),void e.preventDefault();if(!s.x.isKey(e,a.m.arrowLeft)&&!s.x.isKey(e,a.m.arrowRight)||await this.isKeyCursorOverParagraph(e)||(0,ue.m)(e.target)){if(s.x.isKey(e,a.m.space)&&(null===(t=this._queryDetection.getCurrentQuery())||void 0===t?void 0:t.queryRange.length)===(null===(r=null===(n=this._queryDetection.getCurrentQuery())||void 0===n?void 0:n.queryRange.prefix)||void 0===r?void 0:r.length)&&this._oaLogger.logActivity(Y,void 0,[...this.getDefaultLogDataForMenu(),(0,p.n)("interaction","Space")]),s.x.isKey(e,a.m.delete)){const e=this._menuCurrentlyOpen.queryRange.start+this._menuCurrentlyOpen.queryRange.length,t=await this._tileContent.getTextSelection();(null==t?void 0:t.startPositionInParagraphNode)===e&&this.dismissECC(!1)}s.x.isKey(e,a.m.escape)&&((null===(i=this._hostSettings.oaSettings)||void 0===i?void 0:i.enableCurrentQueryDismissalOnEscape)&&this._queryDetection.dismissCurrentQuery(!0,"Escape",Y,this.getDefaultLogDataForMenu()),this.dismissECC(!1),e.stopPropagation(),e.preventDefault())}else this.dismissECC(!1)}})(e).catch((e=>{this._logger.error(506803665,"handleKeyDown threw an exception",e)}))},this.getQueryRangeBoundingClientRect=async()=>{if(!this._menuCurrentlyOpen)return;const e=this._proofingDom.findParagraphNode(this._menuCurrentlyOpen.tileId);if(!(0,R.l)(e))return;const t=await this._tileContent.getRangeOfNode(e.parent,void 0,e.element.offset+this._menuCurrentlyOpen.queryRange.start,this._menuCurrentlyOpen.queryRange.length);return null==t?void 0:t.getBoundingClientRect()},this.dismissMenu=async()=>{this.dismissECC(!1)},this.onDismissed=async e=>{this.dismissECC(e)},this.dismissECC=e=>{var t,n;if(!this._menuCurrentlyOpen)return;this._queryDetection.resetNextDeltaProgramaticallyInserted(),!e&&this._searchBox.getIsSearchBarAvailable()&&this.removeComposingBoxQuery(),null===(t=this._menuEventListenersDisposal)||void 0===t||t.call(this);const r=this._menuCurrentlyOpen;this._calloutState.updateCurrentMenu(void 0,void 0,void 0);const i=this._queryDetection.getPreviousQueryCorrelationKeys();this._oaLogger.logActivity("OAPanelClosed",void 0,[...(0,p.W)(["keyStrokeToSuccess",r.keyStrokes],["persistTime",r.openTime?Date.now()-r.openTime:0],["accepted",e]),...this.getDefaultLogDataForMenu(r)],i),this._searchBox.menuDismissed(r),null===(n=r.onClose)||void 0===n||n.call(r,e,r.openTime?Date.now()-r.openTime:0),this._queryDetection.removeDetectedQuery();const o=this.isAtTriggeringChar(r);e?this.setAriaStatus(o?"ebx_AtCIQMentionsClosedViaInsertionAriaLabel":"ebx_SlashCIQMentionsClosedViaInsertionAriaLabel"):this.setAriaStatus(o?"ebx_AtCIQMentionsClosedAriaLabel":"ebx_SlashCIQMentionsClosedAriaLabel")},this.renderECC=(e=!1)=>{if(!this._menuCurrentlyOpen)return;const t=()=>{var e;(null===(e=this._menuCurrentlyOpen)||void 0===e?void 0:e.onOpen)&&this._menuCurrentlyOpen.onOpen(this._menuCurrentlyOpen),this._menuCurrentlyOpen&&(this._menuCurrentlyOpen.wasOpenedViaNudge?this.setAriaStatus(this.isAtTriggeringChar(this._menuCurrentlyOpen)?"ebx_AtCIQMentionsOpenedByNudgeAriaLabel":"ebx_SlashCIQMentionsOpenedByNudgeAriaLabel"):"InlineSuggestionsResultsUserInitiatedMenuType"===this._menuCurrentlyOpen.menuType.menuType?this.setAriaStatus(this.isAtTriggeringChar(this._menuCurrentlyOpen)?"ebx_AtCIQMentionsOpenedByUserTypingAriaLabel":"ebx_SlashCIQMentionsOpenedByUserTypingAriaLabel",this._menuCurrentlyOpen.queryRange.prefix):"InlineSuggestionsResultsFlagMenuType"===this._menuCurrentlyOpen.menuType.menuType&&this.setAriaStatus(this.isAtTriggeringChar(this._menuCurrentlyOpen)?"ebx_AtCIQMentionsOpenedByFlagAriaLabel":"ebx_SlashCIQMentionsOpenedByFlagAriaLabel"));const t=this._queryDetection.getCurrentQueryLogicalId();t&&this._oaMetric.addMeasure(t,"InlineSuggestionsCalloutDisplay")};this._calloutState.calculateTargetLocationAndShow().then((()=>{e&&t()})).catch((e=>{this._oaLogger.logDiagnostics(`Unable to display callout: ${e}`)}))},this.onAction=e=>{var t,n,r,i,o,a,s;if(this._menuCurrentlyOpen){if(e===f.L.Retry)this.retryQuery();else{this._oaResultStore.clearResults(),(null===(t=this._calloutState.currentScope)||void 0===t?void 0:t.entityType)&&this.resetStateAndUpdateScope(void 0);const a=this.getTileNode(this._menuCurrentlyOpen.tileId);if(!a)return void this._oaLogger.logDiagnostics("No parent found for clearing search");this._oaLogger.logActivity("OAPanelClearQuery",void 0,this.getDefaultLogDataForMenu());const s=null!==(r=null===(n=this._menuCurrentlyOpen.queryRange.prefix)||void 0===n?void 0:n.length)&&void 0!==r?r:1,l=this._menuCurrentlyOpen.menuType.menuType,d=this._menuCurrentlyOpen.queryRange.length;if("InlineSuggestionsResultsFlagMenuType"===l){if(d===s)return this._oaLogger.logDiagnostics("ECC query cleared with no query"),this.retryQuery(),void(null===(o=(i=this._menuCurrentlyOpen).onAction)||void 0===o||o.call(i,e));this.wrapInClearingSearch((()=>{var e,t;this._searchBox.initShowMoreEntitiesParagraph(null===(t=null===(e=this._menuCurrentlyOpen)||void 0===e?void 0:e.showMoreEntitiesConfig)||void 0===t?void 0:t.entityType,!1,""),this._oaLogger.logActivity(ne,void 0,this.getDefaultLogDataForMenu())}))}else if(d!==s){const e=this.getCurrentPositionInDocument(this._menuCurrentlyOpen.tileId,this._menuCurrentlyOpen.queryRange.start),t=this._menuCurrentlyOpen.queryRange.length-s;this.wrapInClearingSearch((()=>this._tileContent.remove(a,void 0,e+s,t)))}}null===(s=(a=this._menuCurrentlyOpen).onAction)||void 0===s||s.call(a,e)}this._hostEmitter.emit(u.pD.oaAnnotationsTriggered,{address:void 0,message:void 0})},this.onPreventDismissOnEvent=e=>{var t,n,r,i,o;if(!this._menuCurrentlyOpen)return!1;if(this._isClearingSearch)return!0;if("InlineSuggestionsResultsUserInitiatedMenuType"===this._menuCurrentlyOpen.menuType.menuType){if(["click","mouseup"].includes(e.type))return!0;if("resize"===e.type&&(null===(t=this._hostSettings.oaSettings)||void 0===t?void 0:t.enableResizeDismissal))return!1;if("resize"===e.type)return this.getResizeThrottle()(),!0;if("scroll"===e.type||"wheel"===e.type)return this._hostSettings.useFluentV9?!!(null===(r=(n=e.target).closest)||void 0===r?void 0:r.call(n,".ms-ecc-callout")):(this.getScrollThrottle()(),!0)}return!!(null===(o=(i=this._menuCurrentlyOpen).onPreventDismissCalloutOnEvent)||void 0===o?void 0:o.call(i,e,this._menuCurrentlyOpen))||"focus"===e.type&&"InlineSuggestionsResultsUserInitiatedMenuType"===this._menuCurrentlyOpen.menuType.menuType||!(!this._calloutDismissalHandler||this._calloutDismissalHandler.shouldDismissCallout(e,"ECC",this._menuCurrentlyOpen))},this.onRestoreFocus=(e,t)=>{var n;(null===(n=this._menuCurrentlyOpen)||void 0===n?void 0:n.onRestoreFocus)?this._menuCurrentlyOpen.onRestoreFocus(e,t):t()},this.telemetryKeptCallback=(e,t)=>{const n=this._oaLogger;e&&setTimeout((()=>{e()&&this._hostSettings.enableKeptMetric&&n.logActivity("OAValueKept",void 0,[...this.getDefaultLogDataForMenu(),...this.getLogDataForSuggestion(t)])}),3e4)},this.onItemSelected=e=>{var t,n,r,i,o,a,s;if(!this._menuCurrentlyOpen)return;const d=e;if((null===(n=null===(t=this._hostSettings.oaSettings)||void 0===t?void 0:t.scopesConfig)||void 0===n?void 0:n.enabled)&&d.scopeInfo&&d.entityType===l.c.Scope)this.resetStateAndUpdateScope(d.scopeInfo);else if("feedback"!==d.key)if(d.entityType&&d.key){const e=d.entityType;this.resetStateAndUpdateScope(e?{entityType:e}:void 0)}else if(d.type!==l.c.Scope)try{d.wasOpenedViaNudge=this._menuCurrentlyOpen.wasOpenedViaNudge,d.wasOpenedViaNudgeAndHasEntityResults=null===(i=this._menuCurrentlyOpen.wasOpenedViaNudgeInfo)||void 0===i?void 0:i.hasEntityResults,this._oaLogger.logActivity("OAValueInserted",void 0,[...this.getDefaultLogDataForMenu(),...this.getLogDataForSuggestion(d)]);const e=this._searchBox.getIsSearchBarAvailable(),t=null!==(o=this._menuCurrentlyOpen.critiqueRange)&&void 0!==o?o:this._menuCurrentlyOpen.queryRange,n=this.getCurrentPositionInDocument(this._menuCurrentlyOpen.tileId,e?this._menuCurrentlyOpen.initialQueryStartPosition:t.start);e&&this._calloutState.searchBoxQueryString.length>0&&this._oaLogger.logActivity("ExpandedEccSearchBarResultSelected",void 0,[...this.getDefaultLogDataForMenu(),...this.getLogDataForSuggestion(d)]);const r=this._menuCurrentlyOpen.onItemSelected,l=e=>this.telemetryKeptCallback(e,d);if(this._menuCurrentlyOpen.shouldRemoveTextOnItemSelection){const i=this.getTileNode(this._menuCurrentlyOpen.tileId);if(!i)return void this._oaLogger.logDiagnostics("No parent found for selecting ECC item.");let o;o=!e||void 0===this._searchBox.lastComposingBoxQuery&&this._calloutState.triggerMethod!==ve.P.AttachFile&&this._calloutState.triggerMethod!==ve.P.Fre?t.length:(null!==(s=null===(a=this._searchBox.lastComposingBoxQuery)||void 0===a?void 0:a.length)&&void 0!==s?s:0)+(t.prefix?t.prefix.length:1),this._tileContent.remove(i,void 0,n,o).then((e=>{r(d,e,i.element,l)})).catch((e=>{this._oaLogger.logDiagnostics(`Unable to remove text range for ECC application: ${e}`)}))}else if(this._menuCurrentlyOpen.shouldCalculateRemovalRange){const e=this.getTileNode(this._menuCurrentlyOpen.tileId);if(!e)return void this._oaLogger.logDiagnostics("No tile found for selecting ECC item.");this._tileContent.getRangeOfNode(e,void 0,n,t.length).then((t=>{t?r(d,t,e.element,l):this._oaLogger.logDiagnostics("Could not determine Range for the search query after selected ECC item.")})).catch((e=>{this._oaLogger.logDiagnostics(`Unable to determine range for ECC application: ${e}`)}))}else r(d,void 0,void 0,l)}finally{this.dismissECC(!0)}else{const t=null===(r=e.scopeInfo)||void 0===r?void 0:r.entityType;this.resetStateAndUpdateScope(t?{entityType:t}:void 0)}else this.onFooterAction(J._R.Feedback)},this.removeComposingBoxQuery=e=>{this.wrapInClearingSearch((()=>this._searchBox.removeComposingBoxQuery(e)))},this.wrapInClearingSearch=e=>(this._isClearingSearch=!0,Promise.resolve(e()).then((()=>{this._isClearingSearch=!1}))),this.onFeedbackButtonClicked=()=>{var e,t,n,r,i,o;if(!(null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.ECCFeedbackSettings)||void 0===t?void 0:t.onFeedbackButtonClicked))return;const a=[];this._calloutState.suggestions.map((e=>{e.entities.map((e=>{a.push(e)}))}));const s={conversationId:null===(n=this._queryCorrelationKeys)||void 0===n?void 0:n.conversationId,logicalId:null===(r=this._queryCorrelationKeys)||void 0===r?void 0:r.logicalId,sessionId:null===(i=this._hostSettings.hostMetadata)||void 0===i?void 0:i.sessionId,query:this._calloutState.queryString,tab:null===(o=this._calloutState.currentScope)||void 0===o?void 0:o.entityType,entities:a};this._hostSettings.serviceSettings.ECCFeedbackSettings.onFeedbackButtonClicked(s)},this.isFlightEnabled=e=>(this._hostSettings.flightsToTrack||[]).includes(e),this.setPreloadedSuggestions=(e,t)=>{this._calloutState.setPreloadedSuggestions(this.convertNewSuggestions(e,void 0,t,void 0,!0,!0)),this.resultStatus=d.i.Success},this.handleExternalKeyboardEvents=(e,t,n)=>{if(!this._menuCurrentlyOpen)return!1;if(t)return!1;if(n&&!this._menuCurrentlyOpen.enableExpandedECC)return!1;const r=new Map([[a.m.arrowDown,se.h.ArrowDown],[a.m.arrowUp,se.h.ArrowUp],[a.m.arrowLeft,se.h.ArrowLeft],[a.m.arrowRight,se.h.ArrowRight],[a.m.home,se.h.Home],[a.m.end,se.h.End],[a.m.tab,se.h.Tab],[a.m.enter,se.h.Enter]]).get(e);return void 0!==r?(this.onUserInteraction(e),this._calloutState.keyboardHandlerTarget.onKeyPressed(r,t,n)):(this._oaLogger.logDiagnostics("[InlineSuggestionStore] unexpected keyboard event",{key:e}),!1)},this.onGroupSelected=e=>{var t,n,r,i;if(!(null===(n=null===(t=this._hostSettings.oaSettings)||void 0===t?void 0:t.scopesConfig)||void 0===n?void 0:n.enabled))return;const o=e.suggestions[0],a=null==o?void 0:o.entityType,s=e.isScoped;null===(i=null===(r=this._menuCurrentlyOpen)||void 0===r?void 0:r.onGroupSelected)||void 0===i||i.call(r,e);const l=!s&&a?{entityType:a,contentSources:o.GroupContentSources}:void 0;if(this.resetStateAndUpdateScope(l),!this._hostSettings.oaSettings.mockResults){const e={results:[],isLoading:!0,resultStatus:void 0,queryCorrelationKeys:this._queryCorrelationKeys?Object.assign(Object.assign({},this._queryCorrelationKeys),{scopeInfo:l}):void 0,nodeId:void 0,resultReset:!0};this._calloutState.clearQueryString(!0),this.updateState(e)}},this.onUserInteraction=e=>{const t=new Map([[a.m.arrowDown,"DownArrow"],[a.m.arrowUp,"UpArrow"],[a.m.enter,"Enter"],[a.m.tab,"Tab"],[void 0,"MouseEntering"]]).get(e);t&&this._oaLogger.logActivity("OAPanelUserInteraction",void 0,[(0,p.n)("interaction",t)],this._queryCorrelationKeys)},this.getCurrentQueryString=()=>{var e;const t=null===(e=this._queryDetection.getCurrentQuery())||void 0===e?void 0:e.queryRange,n=this._queryDetection.getCurrentQueryTileId(),r=t&&n&&this._paragraphTextExtractor.getQueryString(this._proofingDom.findParagraphNode(n),t)||"";return this._calloutState.searchBoxQueryString||r},this.onFirstRender=()=>{var e,t,n,r,i,o;this._oaLogger.logActivity("OAPanelDisplayed",void 0,(0,p.W)(["numOfSonoraSuggestionsDisplayed",this._calloutState.suggestions.length],["numOfSonoraFileSuggestionsDisplayed",this._fileCount],["triggerCharacter",null!==(t=null===(e=this._queryDetection.getCurrentQuery())||void 0===e?void 0:e.queryRange.prefix)&&void 0!==t?t:"@"],["isUserInsertion",null===(r=null===(n=this._queryDetection.getCurrentQueryCorrelationKeys())||void 0===n?void 0:n.isUserInsertion)||void 0===r||r],["source",null!==(o=null===(i=this._queryDetection.getCurrentQueryCorrelationKeys())||void 0===i?void 0:i.source)&&void 0!==o?o:""],[X,!!this._hostSettings.enableKeptMetric],["wasOpenedViaFlag","InlineSuggestionsResultsFlagMenuType"===this._calloutState.menuType.menuType],["menuType",this._calloutState.menuType.menuType.replace("InlineSuggestions","").replace("MenuType","").replace("Results","")])),this.handleOAMetric("InlineSuggestionRendered","add")},this.onProcessedResults=()=>{this.handleOAMetric("InlineSuggestionProcessedResults","add")},this.onRenderResults=()=>{this.handleOAMetric("InlineSuggestionResultsRendered","commit")},this.updateState=e=>{var t,n;e.results.length<1&&!(null===(t=this._menuCurrentlyOpen)||void 0===t?void 0:t.specifiedItemsToDisplay)&&!(null===(n=this._menuCurrentlyOpen)||void 0===n?void 0:n.onSuggestionsUpdated)?this.updateInternalState(e,[]):(this._messageExtensionAppDataProvider?this._messageExtensionAppDataProvider.getAppDefinitionIdMap():Promise.resolve(void 0)).then((t=>{var n;const r=this.getCurrentQueryString(),i=this.convertNewSuggestions(e.results,e.queryCorrelationKeys,e.nodeId,t,e.isLocalSuggestion);this.onSuggestionsUpdated(i,r,(n=>Promise.resolve(this.convertNewSuggestions(n,e.queryCorrelationKeys,e.nodeId,t,!0))),e.resultStatus,e.isLoading,this._queryDetection.getCurrentScope(),e.resultReset,e.latency,this._calloutState.menuType,null===(n=this._menuCurrentlyOpen)||void 0===n?void 0:n.supportedEntityTypes,void 0,this.logWithMenuData,e.resultSummary).then((t=>{var n;t?((null===(n=this._queryCorrelationKeys)||void 0===n?void 0:n.logicalId)&&this._oaMetric.addMeasure(this._queryCorrelationKeys.logicalId,"InlineSuggestionUpdated"),this.updateInternalState(Object.assign(Object.assign({},e),{isLoading:!(e.isLoading&&t.length>0)&&e.isLoading,resultStatus:t.length>0?d.i.Success:e.results.length>0&&0===t.length?d.i.NoResults:e.resultStatus}),t,r)):this._calloutState.setQueryString(r)})).catch((e=>this._oaLogger.logDiagnostics(`Failed to convert suggestions: ${e}`)))})).catch((e=>this._oaLogger.logDiagnostics(`Failed to get ME app definitions: ${e}`)))},this.resetStateAndUpdateScope=e=>{var t;this.reset({scope:null==e?void 0:e.entityType,isLoading:!0,resultReset:!0,dueToScope:!0}),this._queryDetection.setCurrentScope(e);const n=this._proofingDom.findParagraphNode(this._queryDetection.getCurrentQueryTileId()||""),r=null===(t=this._queryDetection.getCurrentQuery())||void 0===t?void 0:t.queryRange;if(!n||!r)return;this._hostSettings.oaSettings&&!this._hostSettings.oaSettings.mockResults&&this._oaResultStore.updateLoadingStatus(!0),function(e,t,n){const r=new _e.s({deltaType:G.WI.Update,unit:G.OD.Chars,position:t.start,length:0,content:"",queryRange:t,additionalData:e.queryDetection.getCurrentQueryCorrelationKeys(),userInfo:{userType:G.HS.SessionUser}});Ce(e.hostEmitter,n,r)}(this.getServices(),r,n);const i=(0,L.q)(this._tileContent,n);if(!(null==i?void 0:i.ownerDocument.defaultView))return;const o=new v.J(i.ownerDocument.defaultView);o.addListener("focus",(e=>{e.stopPropagation(),o.removeAllListeners()}),{capture:!0,once:!0}),i.focus()},this.convertNewSuggestions=(e,t,n,r,i,o)=>{var a,s,d,u,c,g,h,p;if(e.length<1)return[];const f=[];for(const p of e){const e=[];for(const f of p.entities){const p=(this._hostSettings.flightsToTrack||[]).includes("mc-editor-enable-files-new-tidbits"),m=ot(f,this.userProfilePictureCache,null===(a=this._hostSettings.userId)||void 0===a?void 0:a.userDisplayName,0===this._calloutState.queryString.length,this._localizer,null===(s=this._menuCurrentlyOpen)||void 0===s?void 0:s.newEntityTypes,r,p,null!==(u=null===(d=this._hostSettings.oaSettings)||void 0===d?void 0:d.enableConnectorGroupHeadings)&&void 0!==u&&u);if(!m)continue;m.logicalId=null==t?void 0:t.logicalId,m.nodeId=n;const y=m.type;if(!o&&(v=y,Object.values(l.c).includes(v))&&(null===(c=this._menuCurrentlyOpen)||void 0===c?void 0:c.supportedEntityTypes)&&!this._menuCurrentlyOpen.supportedEntityTypes.includes(y))continue;const _=new Date,b=m.id?null===(h=null===(g=this._menuCurrentlyOpen)||void 0===g?void 0:g.newItemsById)||void 0===h?void 0:h.get(m.id):void 0;b&&_<b&&(m.isNew=!0),(i||e.length<this.getMaxEntityCount(y,this._queryDetection.getCurrentScope()))&&e.push(m)}f.push(Object.assign(Object.assign({},p),{entities:e}))}var v;return(null===(p=this._queryCorrelationKeys)||void 0===p?void 0:p.logicalId)&&this._oaMetric.addMeasure(this._queryCorrelationKeys.logicalId,"InlineSuggestionConvertedSuggestions"),f},this._calloutState=new Oe(this.getServices(),k,null!=K?K:new he,this),this._searchBox=new Te(this.getServices(),this._calloutState,this.wrapInClearingSearch),this._oaResultStore.setOnUpdate(this.updateState),this.reset(),this._throttleManager=new m._(null!==(Z=this._targetWindowFactory())&&void 0!==Z?Z:new y.O(window))}get _menuCurrentlyOpen(){return this._calloutState.menuCurrentlyOpen}getResizeThrottle(){return this._resizeThrottle||(this._resizeThrottle=this._throttleManager.throttleUntilNextAnimationFrameAndAdditionalTime(this._safeWindow,this.renderECC,25,"After")),this._resizeThrottle}getScrollThrottle(){var e;return this._scrollThrottle||(this._scrollThrottle=(0,_.hQ)(this._safeWindow,null!==(e=this._targetWindowFactory())&&void 0!==e?e:window,this.renderECC,"After")),this._scrollThrottle}getServices(){return{hostSettings:this._hostSettings,localizer:this._localizer,logger:this._logger,oaLogger:this._oaLogger,hostEmitter:this._hostEmitter,proofingDom:this._proofingDom,oaResultStore:this._oaResultStore,queryDetection:this._queryDetection,tileContent:this._tileContent,languageScriptDirectionDetector:this.languageScriptDirectionDetector,themeStore:this.themeStore,targetWindowFactory:this._targetWindowFactory,targetDocumentFactory:this._targetDocumentFactory}}getCurrentMenuInfo(){return this._menuCurrentlyOpen}getCalloutStateStore(){return this._calloutState}enableMenu(e){var t,n,r;const i=e.queryChar;if(this._menus.get(i))throw Error("This character is already being used for menu creation.");this._menus.set(i,Object.assign(Object.assign({},e),{shouldRemoveTextOnItemSelection:null===(t=e.shouldRemoveTextOnItemSelection)||void 0===t||t,browseThisComputerConfig:null===(n=this._hostSettings.serviceSettings)||void 0===n?void 0:n.browseThisComputerSettings,appGptConfig:null===(r=this._hostSettings.serviceSettings)||void 0===r?void 0:r.appGptConfig,enableExpandedECCSearchBar:e.enableExpandedECC&&void 0!==e.enableExpandedMenuSearchBar?e.enableExpandedMenuSearchBar:this.isFlightEnabled("mc-editor-enable-searchbar")})),this._queryDetection.registerQueryDetectionStartCharacter(i)}disableInlineSuggestionsMenu(e){if(!e)throw Error("You must specify a query character.");if(!this._menus.get(e))throw Error("This character is not being used for menu creation.");this._menus.delete(e),this._queryDetection.unregisterQueryDetectionStartCharacter(e),this._menuCurrentlyOpen&&this._menuCurrentlyOpen.queryRange.prefix===e&&this.dismissECC(!1)}getMenuInfo(e){return this._menus.get(e)}prepareAndRenderECC(e,t){var n,r;this._isFirstMenuUpdate=!0;const i=this._queryDetection.getCurrentQueryLogicalId();i&&this._oaMetric.addMeasure(i,"InlineSuggestionsRenderer"),this._calloutState.setQueryString(t),null===(n=this._menuEventListenersDisposal)||void 0===n||n.call(this);const o=this._calloutState.getCalloutState();return o&&(this._menuEventListenersDisposal=lt(o,null!==(r=this._hostSettings.useFluentV9)&&void 0!==r&&r)),this.updateSpecifiedItemsToDisplay(e.id,t,!0),this.renderECC(!0),!0}navigateWithDelay(e,t){setTimeout((()=>{e(t)}),50)}getDefaultMenuInformation(){return{supportedEntityTypes:void 0,onItemSelected:()=>{},shouldRemoveTextOnItemSelection:!0,enableExpandedECCSearchBar:this.isFlightEnabled("mc-editor-enable-searchbar")}}async tryToUpdatePreloadedItems(e,t,n=!1){var r;if(!(null===(r=this._menuCurrentlyOpen)||void 0===r?void 0:r.getLocalItems))return void this._calloutState.clearPreloadedSuggestions();const i=this._proofingDom.findParagraphNode(t),o=e.queryRange&&this._paragraphTextExtractor.getQueryString(i,e.queryRange);if(void 0!==o){const r=await this._menuCurrentlyOpen.getLocalItems(o);n?await this.updatePreloadedItems(r,e,t):await this.updatePreloadedItemsDebounced(r,e,t)}}async updatePreloadedItems(e,t,n){var r;const i=null===(r=t.additionalData)||void 0===r?void 0:r.scopeInfo,o=new Set,a=new Set,s=new Set;for(const e of this._calloutState.preloadedSuggestions)for(const t of e.entities)t.entityId&&o.add(t.entityId),t.nodeId&&s.add(t.nodeId);for(const t of e)for(const e of t.entities)e.entityId&&a.add(e.entityId);const l=o.size===a.size&&[...o].every((e=>a.has(e))),d=s.has(n),u=0===e.length&&0!==this._calloutState.preloadedSuggestions.length;l&&d&&!u||i&&!e.some((e=>e.entityType===i.entityType))||this.setPreloadedSuggestions(e,n)}updateSpecifiedItemsToDisplay(e,t,n){var r;if(this._menuCurrentlyOpen){if(n){const e=this._menuCurrentlyOpen.getLocalItems?{isLoading:!1,resultReset:!1}:void 0;this.reset(e)}if(this._menuCurrentlyOpen.specifiedItemsToDisplay){const n=[];for(const e of this._menuCurrentlyOpen.specifiedItemsToDisplay){const r=e.entities.filter((e=>e.text.toLowerCase().includes(t.toLowerCase())));r.length>0&&n.push(Object.assign(Object.assign({},e),{entities:r}))}this._oaResultStore.updateResults(n,e,0===n.length?d.i.NoResults:d.i.Success,void 0,void 0,0===n.length?{NoResults:1}:{Success:1})}else(null===(r=this._hostSettings.oaSettings)||void 0===r?void 0:r.mockResults)||(n?this._oaResultStore.startNewECCMenu():this._oaResultStore.updateLoadingStatus(!0))}}getCurrentPositionInDocument(e,t){var n,r;const i=this._proofingDom.findParagraphNode(e);let o=null!==(r=null===(n=null==i?void 0:i.element)||void 0===n?void 0:n.offset)&&void 0!==r?r:0;return o+=t,o}get menuParentElement(){return this._menuCurrentlyOpen?(0,L.q)(this._tileContent,this._proofingDom.findParagraphNode(this._menuCurrentlyOpen.tileId)):void 0}async isKeyCursorOverParagraph(e){var t;if(!this._menuCurrentlyOpen)return!1;const n=this._menuCurrentlyOpen.queryRange.start,r=this._menuCurrentlyOpen.queryRange.start+this._menuCurrentlyOpen.queryRange.length,i=await this._tileContent.getTextSelection();return void 0!==(null==i?void 0:i.startPositionInParagraphNode)&&(null===(t=i.startParagraphNode)||void 0===t?void 0:t.id)===this._menuCurrentlyOpen.tileId&&n!==r&&(i.startPositionInParagraphNode>n&&i.startPositionInParagraphNode<r||!(i.startPositionInParagraphNode!==n||n===r||!s.x.isKey(e,a.m.arrowRight))||!(i.startPositionInParagraphNode!==r||n===r||!s.x.isKey(e,a.m.arrowLeft)))}isAtTriggeringChar(e){return"@"===e.queryRange.prefix}getTileNode(e){const t=this._proofingDom.findParagraphNode(e);return null==t?void 0:t.parent}clearPreloadedSuggestions(){this._calloutState.clearPreloadedSuggestions()}retryQuery(){if(!this._menuCurrentlyOpen)return;const e=this._proofingDom.findParagraphNode(this._menuCurrentlyOpen.tileId);if(!e)return;const t=(0,M.F)(e);this._oaLogger.logActivity("OAPanelRetry",void 0,this.getDefaultLogDataForMenu()),this._hostEmitter.emit(u.pD.oaMenuControlSignal,{address:void 0,message:{mode:r.UserInitiated,retry:!0,documentModel:null==t?void 0:t.documentModel}})}getDefaultLogDataForMenu(e){const t=null!=e?e:this._menuCurrentlyOpen;return t?Se(t,this.getServices()):[]}setAriaStatus(e,t){var n,r;this._featureFlagsReader.flags.enableAriaStatusElement&&(null===(r=null===(n=this._ariaStatusStateStoreFactory)||void 0===n?void 0:n.call(this))||void 0===r||r.setStatus(this._localizer.getMessage(e,t),"assertive",!1))}getLogDataForSuggestion(e){var t,n;return e.entityType===l.c.File?(0,p.W)(["selectedType",e.entityType],["fileType",null!==(t=e.FileExtension)&&void 0!==t?t:"Unknown"],["fileSource",e.FileSourceType]):e.entityType===l.c.Loop?(0,p.W)(["selectedType",e.entityType],["loopType",null!==(n=e.id)&&void 0!==n?n:"Unknown"]):[(0,p.n)("selectedType",e.entityType)]}setMenuCurrentlyOpen(e,t,n,r,i,o,a=!1,s=!0,l=!1,d,u,c){var g;const h=Object.assign(Object.assign({triggerCharacter:e},t),{onFooterAction:e=>{var n;this.runDefaultFooterActionIfAvailable(e)||null===(n=t.onFooterAction)||void 0===n||n.call(t,e),this.dismissECC(!1)},targetLocation:{x:0,y:0},targetOffset:i,tileId:n.id,parentTileId:n.parent.id,parentTileOffset:n.element.offset,wasOpenedInBlankTile:n.parent.plainText.length<=(null!=e?e:"@").length,parentTileType:null===(g=n.parent.textFormattingInfo)||void 0===g?void 0:g.tileType,shouldDismissOnTyping:a,shouldCalculateRemovalRange:s,menuType:o,openTime:Date.now(),queryRange:r,initialQueryStartPosition:r.start,close:()=>{this.dismissECC(!1)},getQuery:()=>{if(this._menuCurrentlyOpen){const e=this._proofingDom.findParagraphNode(this._menuCurrentlyOpen.tileId);return this._paragraphTextExtractor.getQueryString(e,this._menuCurrentlyOpen.queryRange)}},onQueryUpdated:void 0,wasOpenedViaNudge:!!this._nextMenuOpenIsViaNudge,wasOpenedViaNudgeInfo:this._nextMenuOpenIsViaNudge,keyStrokes:0,wasOpenedViaAutomaticAtMention:l,invocationSource:d});this._nextMenuOpenIsViaNudge=void 0,this._calloutState.updateCurrentMenu(h,u,c)}runDefaultFooterActionIfAvailable(e){var t,n,r,i,a,s,l;if(e===J._R.OpenEditorPane)null===(n=null===(t=this._indicatorStore)||void 0===t?void 0:t.onOpenEditorPane)||void 0===n||n.call(t,o.k.ContextualCard);else if(e===J._R.Options)null===(r=this._externalSettingsFeature)||void 0===r||r.openSettings(c.kY.dropdown);else{if(e!==J._R.Feedback)return!1;null===(a=null===(i=this.feedbackStoreFactory)||void 0===i?void 0:i.call(this))||void 0===a||a.feedbackIconClicked("",null!==(l=null===(s=this._menuCurrentlyOpen)||void 0===s?void 0:s.triggerCharacter)&&void 0!==l?l:"Unknown menu type")}return!0}buildInlineSuggestionsResultsMenuActions(e,t,n,r){var i;const o=[];switch(this._hostSettings.isFeedbackEnabledForEcc&&o.push(J._R.Feedback),this._hostSettings.showOptionsButton&&o.push(J._R.Options),e){case"flag":t&&o.push(J._R.ReadAloud),n&&o.push(J._R.IgnoreRule),this._hostSettings.ignoreAllEnabled&&o.push(J._R.IgnoreAll),this._hostSettings.ignoreOnceEnabled&&o.push(J._R.IgnoreOnce),this._paneOpenState&&(this._paneOpenState.isPaneOpen?r&&(o.push(J._R.Previous),o.push(J._R.Next)):o.push(J._R.OpenEditorPane));break;case"userInitiated":(null===(i=this._paneOpenState)||void 0===i?void 0:i.isPaneOpen)||o.push(J._R.OpenEditorPane)}return o}reset(e){var t,n,r,i;if(null===(t=this._hostSettings.oaSettings)||void 0===t?void 0:t.mockResults)this.resetData(),this.mockAnnotations(null==e?void 0:e.scope);else if((null===(n=this._menuCurrentlyOpen)||void 0===n?void 0:n.specifiedItemsToDisplay)||(null===(r=this._menuCurrentlyOpen)||void 0===r?void 0:r.onSuggestionsUpdated)){this.resetData(e);const t=this.getNewCorrelationKeys(),n={results:[],isLoading:void 0!==(null==e?void 0:e.isLoading)?e.isLoading:this._calloutState.isLoading,resultStatus:this.resultStatus,queryCorrelationKeys:null!==(i=this._queryCorrelationKeys)&&void 0!==i?i:t,nodeId:void 0,resultReset:void 0===(null==e?void 0:e.resultReset)||e.resultReset};this._calloutState.clearQueryString(!(null==e?void 0:e.dueToScope)),this.updateState(n)}else this.resetData(e)}resetData(e){this._fileCount=0,this.resultStatus=void 0,this._calloutState.setExplicitLoadingState(void 0===(null==e?void 0:e.isLoading)||e.isLoading,void 0===(null==e?void 0:e.resultReset)||e.resultReset),this._queryCorrelationKeys=void 0}mockAnnotations(e){var t;switch(null===(t=this._hostSettings.oaSettings)||void 0===t?void 0:t.mockResultState){case"Loading":this._calloutState.setIsLoading();break;case"NoResult":this._calloutState.setHasSuggestions([],!0,"");break;case"Error":this._calloutState.setHadUnexpectedError(),this.resultStatus=d.i.UnexpectedError;break;default:n.e(1804).then(n.bind(n,40697)).then((t=>{this._calloutState.setHasSuggestions(this.convertNewSuggestions(t.mockInlineSuggestions.filter((t=>!e||t.entityType===e)),void 0,void 0,void 0,!0),!0,this.getCurrentQueryString())}))}}handleOAMetric(e,t){const n=this._queryDetection.getCurrentQueryLogicalId();n&&this._queryCorrelationKeys&&("commit"===t?this._oaMetric.commitEntry:this._oaMetric.addMeasure).bind(this._oaMetric)(n,e)}getNewCorrelationKeys(){var e,t,n,r,i;const o=null===(e=this._queryDetection.getCurrentQuery())||void 0===e?void 0:e.queryRange,a=this._queryDetection.getCurrentQueryCorrelationKeys();return o&&a?Object.assign(Object.assign({},a),{isEmptyQuery:o.length===(null!==(n=null===(t=o.prefix)||void 0===t?void 0:t.length)&&void 0!==n?n:1),isTimeout:!1,queryLength:o.length-(null!==(i=null===(r=o.prefix)||void 0===r?void 0:r.length)&&void 0!==i?i:1)}):{logicalId:"",conversationId:"",isEmptyQuery:!0,queryLength:0}}_logResultStatus(e,t,n,r){const i=null!=n?n:this._guidGenerator.generate(),o=new Map([["QueryLength",this._calloutState.queryString.length.toString()]]),a=((e,t,n,r,i)=>Object.assign(Object.assign(Object.assign({Version:2,TraceId:e,LocalTime:(new Date).toISOString(),Status:t},r&&{ProviderName:r}),n&&{Latency:n}),i&&{RequestParams:i}))(i,d.i[e],t,r,o);this._oaLogger.logDiagnostics("OAResponseReceived",a)}updateInternalState(e,t,n){var r,o,a,s,u,c,g,h,f,v,m,y,_,b,C,S,T,I,w,E,x,A,D,k,F,P,N,B,O,R,L,M,q,W,U,z,j,H,V,G,Q,K,$,Z,J,X,Y,ee,te,ne;if(!this._menuCurrentlyOpen)return;let re,ie=t;if(this._isFirstMenuUpdate&&(null===(o=null===(r=this._hostSettings.oaSettings)||void 0===r?void 0:r.scopesConfig)||void 0===o?void 0:o.enabled)&&this._hostSettings.oaSettings.scopesConfig.enableAutomaticScoping){const e=t.filter((e=>e.intent&&e.intent>0)).sort(((e,t)=>{var n,r;return(null!==(n=t.intent)&&void 0!==n?n:0)-(null!==(r=e.intent)&&void 0!==r?r:0)}))[0];e&&(void 0===e.isScopingEnabled||e.isScopingEnabled)&&(null!==(a=e.intent)&&void 0!==a?a:0)>(null!==(s=this._hostSettings.oaSettings.scopesConfig.automaticScopingIntentCutoff)&&void 0!==s?s:.9)&&(this._queryDetection.setCurrentScope({entityType:e.entityType},!1),ie=t.filter((t=>t.entityType===e.entityType)))}if(this._isFirstMenuUpdate=!1,void 0!==n)re=n;else{const e=null===(u=this._queryDetection.getCurrentQuery())||void 0===u?void 0:u.queryRange,t=this._queryDetection.getCurrentQueryTileId();if(e&&t)if(this._searchBox.getIsSearchBarAvailable()&&void 0!==this._searchBox.lastComposingBoxQuery){const n=Object.assign(Object.assign({},e),{prefix:this._menuCurrentlyOpen.triggerCharacter,start:this._menuCurrentlyOpen.initialQueryStartPosition+(null!==(g=null===(c=this._menuCurrentlyOpen.triggerCharacter)||void 0===c?void 0:c.length)&&void 0!==g?g:1),length:this._searchBox.lastComposingBoxQuery.length});re=null!==(h=this._paragraphTextExtractor.getQueryString(this._proofingDom.findParagraphNode(t),n))&&void 0!==h?h:""}else re=null!==(f=this._paragraphTextExtractor.getQueryString(this._proofingDom.findParagraphNode(t),e))&&void 0!==f?f:"";else re=""}if(e.resultStatus===d.i.NoResults||e.resultStatus===d.i.Timeout||e.resultStatus===d.i.UnexpectedError)this._logResultStatus(e.resultStatus,e.latency);else if(e.resultStatus===d.i.Success){const t=this._guidGenerator.generate(),n=ie.reduce(((e,t)=>e.concat(t.entities)),[]).filter((e=>e.providerName)).reduce(((e,t)=>{var n;const r=t.providerName;return e[r]||(e[r]=[]),e[r].push({Type:t.entityType,ReferenceId:null!==(n=t.entityId)&&void 0!==n?n:""}),e}),{});for(const[r,i]of Object.entries(n))if(this._logResultStatus(e.resultStatus,e.latency,t,r),"GraphSearch"!==r){const n=qe((null===(v=e.queryCorrelationKeys)||void 0===v?void 0:v.logicalId)||"",(null===(m=e.queryCorrelationKeys)||void 0===m?void 0:m.conversationId)||"",t,"suggestions",r,i);this._oaLogger.logDiagnostics("OAClientDataSource",Object.assign({logicalId:(null===(y=e.queryCorrelationKeys)||void 0===y?void 0:y.logicalId)||""},n))}}const oe=null===(_=this._queryDetection.getCurrentQuery())||void 0===_?void 0:_.queryRange;if(this._queryCorrelationKeys=Object.assign(Object.assign({},e.queryCorrelationKeys),{logicalId:null!==(C=null===(b=e.queryCorrelationKeys)||void 0===b?void 0:b.logicalId)&&void 0!==C?C:"",conversationId:null!==(T=null===(S=e.queryCorrelationKeys)||void 0===S?void 0:S.conversationId)&&void 0!==T?T:"",triggerCharacter:null!==(I=null==oe?void 0:oe.prefix)&&void 0!==I?I:"@",isEmptyQuery:!oe||oe.length===(null!==(E=null===(w=oe.prefix)||void 0===w?void 0:w.length)&&void 0!==E?E:1),queryLength:oe?oe.length-(null!==(A=null===(x=oe.prefix)||void 0===x?void 0:x.length)&&void 0!==A?A:1):0}),(null===(D=e.queryCorrelationKeys)||void 0===D?void 0:D.logicalId)&&this._oaMetric.addMeasure(e.queryCorrelationKeys.logicalId,"InlineSuggestionInternalStateUpdated"),this.resultStatus=e.resultStatus,!e.isLoading&&e.resultStatus!==d.i.UnexpectedError&&e.resultStatus!==d.i.Cancelled&&this.defaultInlineSuggestionItems)for(const e of this.defaultInlineSuggestionItems)for(const t of e(re,this._calloutState.menuType,this._menuCurrentlyOpen.triggerCharacter,this._menuCurrentlyOpen.supportedEntityTypes,this._queryCorrelationKeys.scopeInfo))ie.push(t),this.resultStatus=d.i.Success;if(this._fileCount=ie.filter((e=>e.entityType===l.c.File)).length||0,0!==ie.length||!e.isLoading){const t=ie.reduce(((e,t)=>(e[t.entityType]=t.entities.length,e.total+=e[t.entityType],e)),{total:0}),{total:n}=t,r=(0,i.__rest)(t,["total"]);this._oaLogger.logActivity("OAPanelUpdated",void 0,(0,p.W)(["numOfSonoraSuggestionsDisplayed",n],["numOfSuggestionsDisplayed",JSON.stringify(r)],["status",null!==(k=e.resultStatus)&&void 0!==k?k:-1],["responseCancelled",null!==(P=null===(F=e.resultSummary)||void 0===F?void 0:F.Cancelled)&&void 0!==P?P:0],["responseEarlyExit",null!==(B=null===(N=e.resultSummary)||void 0===N?void 0:N.EarlyExit)&&void 0!==B?B:0],["responseNoResults",null!==(R=null===(O=e.resultSummary)||void 0===O?void 0:O.NoResults)&&void 0!==R?R:0],["responseSuccess",null!==(M=null===(L=e.resultSummary)||void 0===L?void 0:L.Success)&&void 0!==M?M:0],["responseTimeout",null!==(W=null===(q=e.resultSummary)||void 0===q?void 0:q.Timeout)&&void 0!==W?W:0],["responseUnexpectedError",null!==(z=null===(U=e.resultSummary)||void 0===U?void 0:U.UnexpectedError)&&void 0!==z?z:0],["isError",this._calloutState.isError],["latency",null!==(j=e.latency)&&void 0!==j?j:-1],["triggeringChar",null!==(H=this._queryCorrelationKeys.triggerCharacter)&&void 0!==H?H:"@"],["queryLength",this._calloutState.queryString.length],["scopeType",null!==(G=null===(V=this._queryCorrelationKeys.scopeInfo)||void 0===V?void 0:V.entityType)&&void 0!==G?G:""],["menuType",this._calloutState.menuType.menuType.replace("InlineSuggestions","").replace("MenuType","").replace("Results","")],["hybrid",null!==($=null===(K=null===(Q=this._hostSettings.serviceSettings)||void 0===Q?void 0:Q.hybridAugloop)||void 0===K?void 0:K.enabled)&&void 0!==$&&$]),this._queryCorrelationKeys);const o=(null===(J=null===(Z=this._hostSettings.oaSettings)||void 0===Z?void 0:Z.scopesConfig)||void 0===J?void 0:J.enabled)?{HasClickableScopeHeader:!0}:void 0;this._oaLogger.logDiagnostics("OAClientLayout",((e,t,n)=>{return{LogicalId:e,Version:2,LocalTime:(r=new Date,function(e,t){const n=-e.getTimezoneOffset(),r=n>=0?"+":"-";return e.getFullYear()+"-"+Me(e.getMonth()+1)+"-"+Me(e.getDate())+"T"+Me(e.getHours())+":"+Me(e.getMinutes())+":"+Me(e.getSeconds())+"."+Me(e.getMilliseconds())+r+Me(n/60)+":"+Me(n%60)}(r)),LayoutType:"Vertical",ResultsView:We(t,n),PageNumber:0};var r})(null!==(Y=null===(X=e.queryCorrelationKeys)||void 0===X?void 0:X.logicalId)&&void 0!==Y?Y:"",this._calloutState.suggestions,o)),(null===(ee=e.queryCorrelationKeys)||void 0===ee?void 0:ee.logicalId)&&this._oaMetric.addMeasure(e.queryCorrelationKeys.logicalId,"InlineSuggestionAppendedConvertedSuggestions")}e.resultStatus===d.i.UnexpectedError||e.resultStatus===d.i.Cancelled?this._calloutState.setHadUnexpectedError():e.isLoading?this._calloutState.setExplicitLoadingState(!0,null!==(te=e.resultReset)&&void 0!==te&&te):(this._calloutState.setHasSuggestions(ie,null!==(ne=e.resultReset)&&void 0!==ne&&ne,re),this.fetchAndUpdateProfilePictureAndUpdateSuggestionsList(ie))}getMaxEntityCount(e,t){var n,r,i;const o=!!(null==t?void 0:t.entityType),a=o?null===(r=null===(n=this._hostSettings.oaSettings)||void 0===n?void 0:n.scopesConfig)||void 0===r?void 0:r.maxResults:(0,b.Z$)(null===(i=this._hostSettings.oaSettings)||void 0===i?void 0:i.entitiesEnabled,e);return null!=a?a:o?5:3}async fetchAndUpdateProfilePictureAndUpdateSuggestionsList(e){const t=[];for(const n of e)t.push(...n.entities.filter((e=>e.entityType===l.c.People)));await Promise.all(t.map((async e=>{var t,n,r,i;(null===(t=this._queryCorrelationKeys)||void 0===t?void 0:t.logicalId)&&this._oaMetric.startEntry(this._queryCorrelationKeys.logicalId+e.Id,this._queryCorrelationKeys);const o=(0,it.u)(e),a=await(null===(n=this.userProfilePictureCache)||void 0===n?void 0:n.fetchProfilePicture(o));e.imageUrl=a,a?(null===(i=this._queryCorrelationKeys)||void 0===i?void 0:i.logicalId)&&this._oaMetric.commitEntry(this._queryCorrelationKeys.logicalId+e.Id,"Success","ProfilePictureLoadingTime"):(null===(r=this._queryCorrelationKeys)||void 0===r?void 0:r.logicalId)&&this._oaMetric.commitEntry(this._queryCorrelationKeys.logicalId+e.Id,"Error","ProfilePictureLoadingTime")}))),this._calloutState.setHasSuggestions(this._calloutState.suggestions,!1,this._calloutState.queryString)}};dt=(0,i.__decorate)([(0,Q._)(),(0,i.__param)(0,(0,K.W)(C.n)),(0,i.__param)(1,(0,K.W)(S.m)),(0,i.__param)(2,(0,K.W)(T.g)),(0,i.__param)(3,(0,K.W)(I.G)),(0,i.__param)(4,(0,K.W)(w.u)),(0,i.__param)(5,(0,K.W)(u.M5)),(0,i.__param)(6,(0,K.W)(q.w)),(0,i.__param)(7,(0,K.W)(W.b)),(0,i.__param)(8,(0,K.W)(U.d)),(0,i.__param)(9,(0,K.W)(H.C)),(0,i.__param)(10,(0,K.W)(E.J)),(0,i.__param)(11,(0,K.W)(x.H)),(0,i.__param)(12,(0,K.W)(A.c)),(0,i.__param)(13,(0,K.W)(D.o)),(0,i.__param)(14,(0,K.W)(k.j)),(0,i.__param)(15,(0,K.W)(F.aP)),(0,i.__param)(16,(0,K.W)(we.j)),(0,i.__param)(17,(0,K.W)(P.cg)),(0,i.__param)(18,(0,K.W)(P.Ze)),(0,i.__param)(19,(0,$.l)()),(0,i.__param)(19,(0,K.W)(N.F)),(0,i.__param)(20,(0,$.l)()),(0,i.__param)(20,(0,K.W)(ie.Th)),(0,i.__param)(21,(0,$.l)()),(0,i.__param)(21,(0,K.W)(z.y)),(0,i.__param)(22,(0,$.l)()),(0,i.__param)(22,(0,K.W)(oe.J)),(0,i.__param)(23,(0,$.l)()),(0,i.__param)(23,(0,K.W)(c.In)),(0,i.__param)(24,(0,$.l)()),(0,i.__param)(24,(0,K.W)(B.f)),(0,i.__param)(25,(0,$.l)()),(0,i.__param)(25,(0,K.W)(j.g)),(0,i.__param)(26,(0,$.l)()),(0,i.__param)(26,(0,K.W)(Re.Z)),(0,i.__param)(27,(0,$.l)()),(0,i.__param)(27,(0,Z.t)(Ie)),(0,i.__param)(28,(0,$.l)()),(0,i.__param)(28,(0,K.W)(ae.YQ)),(0,i.__param)(29,(0,$.l)()),(0,i.__param)(29,(0,K.W)(xe.A)),(0,i.__param)(30,(0,$.l)()),(0,i.__param)(30,(0,K.W)(Ee.e)),(0,i.__param)(31,(0,$.l)()),(0,i.__param)(31,(0,K.W)(O.n))],dt)},11747:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var r=n(30206),i=n(88670),o=n(49520),a=n(48828),s=n(90424);function l(e){return null==e}let d=class{constructor(e,t){this._hostSettings=e,this._oaLogger=t,this._appDefinitionIdMapCacheTTLInMilliseconds=6e4,this._appDefinitionIdMapCacheDisabled=!1,this.getAppDefinitionIdMap=async()=>{var e;if(null===(e=this._messageExtensionAppSuggestionSetting)||void 0===e?void 0:e.enabled)return!this._appDefinitionIdMapCacheDisabled&&this._appDefinitionIdMapLastNetwrokCallTime&&this._appDefinitionIdMapLastNetwrokCallTime+this._appDefinitionIdMapCacheTTLInMilliseconds>(new Date).getTime()?this._appDefinitionIdMap:(this.clearTimeout(),Promise.race([this.getAndAddAppDefinitionIdMapToCache(),this.getTimeoutPromise()]))},this.getAndAddAppDefinitionIdMapToCache=()=>new Promise((e=>this._getAppDefinitionIdMapCallback?this._getAppDefinitionIdMapCallback().then((t=>(this.clearTimeout(),this._appDefinitionIdMapCacheDisabled||(this._appDefinitionIdMap=t,this._appDefinitionIdMapLastNetwrokCallTime=(new Date).getTime()),e(t)))).catch((()=>(this.clearTimeout(),this._oaLogger.logDiagnostics("Failed to get appDefinitionIdMap from Host"),e(void 0)))):e(void 0))),this.getTimeoutPromise=(e=3e3)=>new Promise((t=>{this._timeoutId=setTimeout((()=>(this._oaLogger.logDiagnostics("getAppDefinitionIdMap:: request timeout"),t(void 0))),e)})),this.clearTimeout=()=>{this._timeoutId&&clearTimeout(this._timeoutId)},this.initialize()}initialize(){var e,t;this._messageExtensionAppSuggestionSetting=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.messageExtensionAppSuggestion,(null===(t=this._messageExtensionAppSuggestionSetting)||void 0===t?void 0:t.enabled)&&(this._getAppDefinitionIdMapCallback=this._messageExtensionAppSuggestionSetting.getAppDefinitionIdMapCallback,this._appDefinitionIdMapCacheDisabled=!l(this._messageExtensionAppSuggestionSetting.appDefinitionIdMapCacheTTLInMilliSeconds)&&0===this._messageExtensionAppSuggestionSetting.appDefinitionIdMapCacheTTLInMilliSeconds,this._appDefinitionIdMapCacheTTLInMilliseconds=l(this._messageExtensionAppSuggestionSetting.appDefinitionIdMapCacheTTLInMilliSeconds)?this._appDefinitionIdMapCacheTTLInMilliseconds:this._messageExtensionAppSuggestionSetting.appDefinitionIdMapCacheTTLInMilliSeconds)}};d=(0,r.__decorate)([(0,a._)(),(0,r.__param)(0,(0,s.W)(i.n)),(0,r.__param)(1,(0,s.W)(o.m))],d)},44358:(e,t,n)=>{"use strict";n.d(t,{S:()=>o});var r=n(15715),i=n(43514);function o(e){if(e)return function(e){const t=(0,i.S)(e);return r.I.shouldRenderTypeName(t)}(e)?e:"Cloud"}},3795:(e,t,n)=>{"use strict";n.d(t,{X:()=>a});var r=n(26017),i=n(93381),o=n(29594);function a(e,t){const n=(0,o.$)().getStringsFor("InlineSuggestionStrings");switch(e){case r.c.File:return n("fileEntityLabel");case r.c.People:return n("peopleEntityLabel");case r.c.Loop:return n("loopsEntityLabel");case r.c.Topic:return n("topicsEntityLabel");case r.c.External:return n("externalEntityLabel");case r.c.MessageExtensionApp:return n("appEntityLabel");case r.c.Scope:return n("scopeEntityLabel");case r.c.Event:return n("eventEntityLabel");case r.c.Channel:return n("channelEntityLabel");case r.c.Chat:return n("chatEntityLabel");case r.c.Team:return n("teamEntityLabel");case r.c.Message:return n("emailEntityLabel");case r.c.PIM:return t===i.Nm.Address?n("addressEntityLabel"):t===i.Nm.Membership?n("membershipEntityLabel"):n("phoneEntityLabel");default:return e}}},59134:(e,t,n)=>{"use strict";n.d(t,{u:()=>i});var r=n(46546);function i(e){return(0,r.isObservableArray)(e.EmailAddresses)||Array.isArray(e.EmailAddresses)?e.EmailAddresses[0]:e.EmailAddresses}},96691:(e,t,n)=>{"use strict";n.d(t,{V:()=>D,S:()=>k});var r=n(30206),i=n(19718),o=n(41260),a=n(93398),s=n(24941),l=n(62070),d=n(85230),u=n(24546),c=n(71234),g=n(88670),h=n(49520),p=n(23132),f=n(68081),v=n(92135),m=n(28363),y=n(87151),_=n(72131),b=n(47436),C=n(14193),S=n(43900),T=n(11966),I=n(3327),w=n(63837),E=n(48828),x=n(90424),A=n(30225);const D=(0,w.f)("INudgeStateStore");let k=class extends i.z{constructor(e,t,n,r,i,u,c,g,h,p,f,v,m){super(),this.localizer=e,this.hostSettings=t,this.hostEmitter=n,this.oaLogger=r,this.proofingDom=i,this.nudgeStore=u,this.tileContent=c,this._queryDetection=g,this.paragraphTextExtractor=h,this._ariaStatusStateStoreFactory=p,this._featureFlagsReader=f,this.inlineSuggestionsRenderer=v,this.predictionStore=m,this._nudgeDisplayTime=void 0,this._nudge=void 0,this._nudgeDisplayLocation=void 0,this._nudgeTargetDocumentRef=void 0,this.enableInlineNudge=!1,this.initialize=async()=>{var e,t;this.hostEmitter.on(o.pD.hostModelDelta,this.handleDelta),this.hostEmitter.on(o.pD.hostModelTextTile,this.handleTextTile),this.enableInlineNudge=!!(null===(t=null===(e=this.hostSettings.serviceSettings)||void 0===e?void 0:e.nudge)||void 0===t?void 0:t.enableInlineNudge)},this.shutDown=()=>{},this.onNudgeUpdated=async()=>{var e,t,n,r,i,o,s,l,d,u,c,g,h,p,f;const v=this.nudgeStore.getCurrentNudge();if(v){if(this.oaLogger.logActivity("OANudgeReceived",void 0,[(0,a.n)("entityType",v.entityType.toString())],void 0),this.isNudgeDisabledForEntityType(null===(e=this.hostSettings.serviceSettings)||void 0===e?void 0:e.nudge,v.entityType))return void await this.nudgeStore.clearNudge();if((null===(n=null===(t=this.hostSettings.serviceSettings)||void 0===t?void 0:t.nudge)||void 0===n?void 0:n.shouldRenderNudge)&&!this.hostSettings.serviceSettings.nudge.shouldRenderNudge(v))return void await this.nudgeStore.clearNudge();if(v.entityResults&&!(null===(i=null===(r=this.hostSettings.serviceSettings)||void 0===r?void 0:r.nudge)||void 0===i?void 0:i.entityNudgeClicked))return void await this.nudgeStore.clearNudge();if(v.entityResults&&(null===(l=null===(s=null===(o=this.inlineSuggestionsRenderer)||void 0===o?void 0:o.getCurrentMenuInfo())||void 0===s?void 0:s.wasOpenedViaNudgeInfo)||void 0===l?void 0:l.hasEntityResults))return void await this.nudgeStore.clearNudge();if(null===(d=this.predictionStore)||void 0===d?void 0:d.getCurrentPrediction())return void await this.nudgeStore.clearNudge();if(this._nudge&&this._nudge.text===v.text&&this._nudge.tileId===v.tileId&&this._nudge.entityType===v.entityType)return;const m=this.proofingDom.findParagraphNode(v.tileId);if(!(0,b.l)(m))return void await this.nudgeStore.clearNudge();const y=this.paragraphTextExtractor.getTextBetween(m,m,m.element.span-2,m.element.span);if(y&&""!==y){if(" :"===y)return void await this.onNudgeDismiss("space character precedes :");if(y.includes("@"))return void await this.onNudgeDismiss("@ character detected");if(y.includes("/"))return void await this.onNudgeDismiss("/ character detected")}const _=await this.tileContent.getNodeInsertionPosition(m.parent,m.element.offset+v.startIndex,!0);if(!_)return void await this.nudgeStore.clearNudge();if(!await this.isInputPointerAtNudge(v))return void await this.nudgeStore.clearNudge();const C=_.endContainer.parentElement;if(C&&this.containsInvalidNudgeSelector(C,null===(c=null===(u=this.hostSettings.serviceSettings)||void 0===u?void 0:u.nudge)||void 0===c?void 0:c.invalidNudgeSelectors))return void await this.nudgeStore.clearNudge();const S=_.getBoundingClientRect();this.updateNudge(v,null!==(g=null==C?void 0:C.ownerDocument)&&void 0!==g?g:document,S),this.oaLogger.logActivity("OANudgeDisplayed",void 0,[(0,a.n)("entityType",v.entityType.toString())],void 0),null===(f=null===(p=null===(h=this.hostSettings.serviceSettings)||void 0===h?void 0:h.nudge)||void 0===p?void 0:p.onNudgeDisplayed)||void 0===f||f.call(p,v),this.setAriaStatus("ebx_CIQNudgeDisplayed",v.text)}else this.clearNudge()},this.isInputPointerAtNudge=async e=>{var t;const n=await this.tileContent.getTextSelection();return!!n&&n.startPosition===n.endPosition&&(null===(t=n.startParagraphNode)||void 0===t?void 0:t.id)===e.tileId&&n.endPositionInParagraphNode===e.startIndex},this.updateNudge=(e,t,n)=>{this._nudge=e,this._nudgeTargetDocumentRef=new s.O(t),this._nudgeDisplayLocation=n,this._nudgeDisplayTime=Date.now(),this.publishStateChange()},this.clearNudge=()=>{this._nudge=void 0,this._nudgeTargetDocumentRef=void 0,this._nudgeDisplayLocation=void 0,this._nudgeDisplayTime=void 0,this.publishStateChange()},this.handleTextTile=e=>{if(this.nudge&&e.message.messageType===l.G.RemoveData){const t=e.message.data.tileId;this.nudge.tileId!==t&&this.proofingDom.findParagraphNode(this.nudge.tileId)||this.onNudgeDismiss("tile removed")}},this.handleDelta=async e=>{var t;const n=e.message;if(n.sourceType===d.pf.TileNode)return;if(!this.nudge)return;const r=await this.tileContent.getTextSelection();if(!this.nudge)return;let i;if((null==r?void 0:r.isCollapsed)&&r.startParagraphNode&&r.startParagraphNode.id===this.nudge.tileId&&r.startPositionInParagraphNode){if(i=await this.tileContent.getNodeInsertionPosition(r.startParentElement,r.startParagraphNode.element.offset+r.startPositionInParagraphNode,!0),!i)return this.oaLogger.logDiagnostics("Nudge text update: could not determine range for nudge insertion"),void await this.onNudgeDismiss("could not determine position");if(n.delta.deltaType===I.WI.Add&&(null===(t=n.delta.content)||void 0===t?void 0:t.includes(":"))&&" "===this.paragraphTextExtractor.getTextBetween(r.startParagraphNode,r.startParagraphNode,n.delta.position-1,n.delta.position))return void await this.onNudgeDismiss(": was proceeded with a space");const e=i.getBoundingClientRect();this._nudgeDisplayLocation&&(this._nudgeDisplayLocation=e,this.publishStateChange())}else(null==r?void 0:r.startParagraphNode)&&r.startPositionInParagraphNode?(r.isCollapsed||await this.onNudgeDismiss("Text range was selected"),0===r.startPositionInParagraphNode?await this.onNudgeDismiss("A new sentence was started"):await this.onNudgeDismiss("Text selection moved to another sentence")):await this.onNudgeDismiss("Unable to determine text selection")},this.nudgeStore.setOnUpdatedNudge(this.onNudgeUpdated)}get nudge(){return this._nudge}get nudgeDisplayLocation(){return this._nudgeDisplayLocation}get nudgeTargetDocumentRef(){return this._nudgeTargetDocumentRef}get insertionCharacter(){var e,t,n;return null!==(n=null===(t=null===(e=this.hostSettings.serviceSettings)||void 0===e?void 0:e.nudge)||void 0===t?void 0:t.insertionCharacter)&&void 0!==n?n:"@"}async onNudgeDismiss(e,t){var n,r,i;const o=this.nudgeStore.getCurrentNudge();if(!o)return;const s=this.proofingDom.findParagraphNode(o.tileId);if(!(0,b.l)(s))return void await this.nudgeStore.clearNudge();let l="";if(t){const e=this.paragraphTextExtractor.getTextBetween(s,s,s.element.span-2,s.element.span);l=": "===e?'user pasted text after ": "':(null==e?void 0:e.includes(":"))?'user pasted text after ":"':"user pasted text"}const d=Date.now()-this._nudgeDisplayTime;this.oaLogger.logActivity("OANudgeDismissed",void 0,(0,a.W)(["entityType",o.entityType.toString()],["dismissTrigger",t?l:e],["persistTime",d])),await this.nudgeStore.clearNudge(),null===(i=null===(r=null===(n=this.hostSettings.serviceSettings)||void 0===n?void 0:n.nudge)||void 0===r?void 0:r.onNudgeDismissed)||void 0===i||i.call(r,o,d,t?l:e)}async onNudgeAccepted(e,t){var n,r,i,s,d,c,g,h,p,f;const v=this.nudgeStore.getCurrentNudge();if(!v)return void this.oaLogger.logDiagnostics("Nudge click: could not find nudge in store");const m=Date.now()-this._nudgeDisplayTime;if(this.oaLogger.logActivity("OANudgeClicked",void 0,(0,a.W)(["entityType",v.entityType.toString()],["persistTime",m],["userAction",e])),null===(i=null===(r=null===(n=this.hostSettings.serviceSettings)||void 0===n?void 0:n.nudge)||void 0===r?void 0:r.onNudgeAccepted)||void 0===i||i.call(r,v,m,e,t),await this.nudgeStore.clearNudge(),t)if(null===(s=this.hostSettings.oaSettings)||void 0===s?void 0:s.isContextualCardEnabled){const e=this.proofingDom.findParagraphNode(v.tileId);if(!(0,b.l)(e))return void this.oaLogger.logDiagnostics("Nudge click: could not find paragraph node");const n=await this.tileContent.getTextSelection();let r;n||this.oaLogger.logDiagnostics("Nudge click: could not determine text selection");let i=0,a=!1;if((null==n?void 0:n.isCollapsed)&&n.startParagraphNode&&n.startParagraphNode.id===e.id&&n.startPositionInParagraphNode){const t=this.paragraphTextExtractor.getParagraphText(n.startParagraphNode);t&&!u.Yv(t.charCodeAt(n.startPositionInParagraphNode-1))&&(a=!0),i=e.element.offset+n.startPositionInParagraphNode,r=await this.tileContent.getNodeInsertionPosition(n.startParentElement,i,!0)}if(r||(i=e.element.offset+v.startIndex,r=await this.tileContent.getNodeInsertionPosition(e.parent,i,!0)),!r)return void this.oaLogger.logDiagnostics("Nudge click: could not determine range for nudge insertion");if(this.hostEmitter.emit(o.pD.nudgeAccepted,{message:{data:{nudge:v,fromUserAction:t},messageType:l.G.NewData},address:void 0}),v.entityResults){if(!(null===(c=null===(d=this.hostSettings.serviceSettings)||void 0===d?void 0:d.nudge)||void 0===c?void 0:c.entityNudgeClicked))return void this.oaLogger.logDiagnostics("Nudge click: entity nudge was clicked, but no callback was provided");if(v.entityResults.entities.length>1&&this.inlineSuggestionsRenderer){const t=[],n=v.entityResults.entities;t.push({entities:n,intent:v.entityResults.intent,entityType:v.entityResults.entityType});const r=i-e.element.offset,o=t=>{this.hostSettings.serviceSettings.nudge.entityNudgeClicked(t,e.parent.element,e.id,r)};await this.inlineSuggestionsRenderer.showExistingMenu(e.id,r,0,null!==(g=this.hostSettings.serviceSettings.nudge.insertionCharacter)&&void 0!==g?g:"@",!0,!1,void 0,o,t)}else this.hostSettings.serviceSettings.nudge.entityNudgeClicked(v.entityResults.entities[0],e.parent.element,e.id,i-e.element.offset)}else this._queryDetection.setNextDeltaProgramaticallyInserted("Nudge"),await this.tileContent.insert(e.parent,void 0,i,(a?" ":"")+(null!==(f=null===(p=null===(h=this.hostSettings.serviceSettings)||void 0===h?void 0:h.nudge)||void 0===p?void 0:p.insertionCharacter)&&void 0!==f?f:"@"),!0,r,!1)}else this.oaLogger.logDiagnostics("Nudge click: ECC was not enabled");else this.hostEmitter.emit(o.pD.nudgeAccepted,{message:{data:{nudge:v,fromUserAction:t},messageType:l.G.NewData},address:void 0})}isNudgeDisabledForEntityType(e,t){return(null==e?void 0:e.entityConfigs)&&!e.entityConfigs.some((e=>e.enabled&&e.entityType===t))}containsInvalidNudgeSelector(e,t){var n;let r=!1;if(t)for(const i of t)(e.matches(i)||(null===(n=e.nextElementSibling)||void 0===n?void 0:n.matches(i)))&&(r=!0);return r}setAriaStatus(e,t){var n;this._featureFlagsReader.flags.enableAriaStatusElement&&(null===(n=this._ariaStatusStateStoreFactory())||void 0===n||n.setStatus(this.localizer.getMessage(e,t),"assertive",!1))}publishStateChange(){this.publishEvent("stateUpdated",{nudge:this._nudge,nudgeTargetDocumentRef:this._nudgeTargetDocumentRef,nudgeDisplayLocation:this._nudgeDisplayLocation})}};k=(0,r.__decorate)([(0,E._)(),(0,r.__param)(0,(0,x.W)(c.H)),(0,r.__param)(1,(0,x.W)(g.n)),(0,r.__param)(2,(0,x.W)(o.M5)),(0,r.__param)(3,(0,x.W)(h.m)),(0,r.__param)(4,(0,x.W)(C.w)),(0,r.__param)(5,(0,x.W)(y.Y)),(0,r.__param)(6,(0,x.W)(S.d)),(0,r.__param)(7,(0,x.W)(p.J)),(0,r.__param)(8,(0,x.W)(T.b)),(0,r.__param)(9,(0,x.W)(v.Th)),(0,r.__param)(10,(0,x.W)(f.c)),(0,r.__param)(11,(0,A.l)()),(0,r.__param)(11,(0,x.W)(m.V)),(0,r.__param)(12,(0,A.l)()),(0,r.__param)(12,(0,x.W)(_.o))],k)},83129:(e,t,n)=>{"use strict";n.d(t,{PF:()=>d,Qr:()=>l});var r,i=n(30206),o=n(48828),a=n(63837),s=n(18794);!function(e){e[e.None=0]="None",e[e.Processed=1]="Processed",e[e.SquiggleInitialized=2]="SquiggleInitialized"}(r||(r={}));let l=class{constructor(){this._processedCritiques=new Map,this._invalidatedItems=new Map,this._keystrokesCount=0,this.items=new Map,this.setItem=(e,t)=>{this.items.set(e,t)},this.process=e=>!(!e||this._processedCritiques.has(e)||(this._processedCritiques.set(e,{status:r.Processed,progress:0}),0)),this.setInitializationProgress=(e,t)=>{if(!e)return!1;const n=this._processedCritiques.get(e);return!(!n||n.status!==r.Processed&&n.status!==r.SquiggleInitialized||(this._processedCritiques.set(e,{status:r.SquiggleInitialized,progress:t}),0))},this.getSquiggleInitializationProgress=e=>{if(!e)return 0;const t=this._processedCritiques.get(e);return(null==t?void 0:t.status)===r.SquiggleInitialized?t.progress:0},this.forEachCritiqueForItems=(e,t)=>{for(const n of e){const e=this.items.get(n);if(!e)return;for(const r of e){const i=r[0];t({squiggles:r[1],key:i,elementCritiques:e,elementId:n})}}},this.removeForCritique=(e,t,n=!1)=>{const r=this.items.get(e);if(!r)return;const i=r.get(t);return i?(n&&this._invalidatedItems.set(t,{squiggles:i,keystrokes:this._keystrokesCount}),r.delete(t),i):void 0},this.isEmpty=e=>void 0===this.items.get(e)&&0===this._invalidatedItems.size,this.checkInvalidatedAutoCorrections=e=>{if(0===this._invalidatedItems.size)return void(this._keystrokesCount=0);if(this._keystrokesCount+=1,!e)return;const t=[];for(const n of this._invalidatedItems.entries()){const r=n[1];this._keystrokesCount-r.keystrokes>s.tB&&t.push(n[0]),e(r.squiggles)&&t.push(n[0])}for(const e of t)this._invalidatedItems.delete(e)}}};l=(0,i.__decorate)([(0,o._)()],l),(0,a.f)("IContentEditableAutoCorrectionCache");const d=(0,a.f)("IFormElementAutoCorrectionCache")},15422:(e,t,n)=>{"use strict";n.d(t,{n:()=>D});var r=n(30206),i=n(67005),o=n(24546),a=n(36857),s=n(48717),l=n(41260),d=n(24839),u=n(52996),c=n(74706),g=n(55025),h=n(6793),p=n(14262),f=n(71108),v=n(35715),m=n(47436),y=n(43900),_=n(14193),b=n(44957),C=n(32133),S=n(83129),T=n(18794),I=n(51959),w=n(48828),E=n(30122),x=n(90424),A=n(30225);let D=class{constructor(e,t,n,r,d,u,c,h,p,f,y,_,b){this._hostEmitters=e,this.tileContent=t,this.critiqueRangeBuilder=n,this.proofingDom=r,this.safeWindow=d,this._disableCritiqueHandler=u,this.logger=c,this.critiqueStore=h,this.applyCritiqueSuggestionHandler=p,this.applyFlagHandler=f,this.wordDictionary=y,this.editorSettingsManager=_,this._formElementAutoCorrectionCache=b,this.applyCritiqueSuggestion=async(e,t,n,r,a,s,l,d)=>{var u;await this.applySuggestion(e,t,{nodeId:n,offset:r.start,typeId:r.typeId,traceId:r.traceId,textInContext:r.textInContext},(async()=>{var n,l,d,u;(null===(n=r.textInContext)||void 0===n?void 0:n.includes("￼"))&&(r.start+=(r.textInContext.match(new RegExp("^￼+"))||[""])[0].length,r.length-=(r.textInContext.match(/￼/g)||[]).length,r.textInContext=r.textInContext.replace(/￼/g,""),a.text=a.text.replace(/￼/g,""));let c=!1;if(this.applyCritiqueSuggestionHandler&&this.critiqueRangeBuilder){const n=s||(null===(l=(await this.critiqueRangeBuilder.getCritiqueRanges([r],t))[0])||void 0===l?void 0:l.range);c=!!n&&!!this.applyCritiqueSuggestionHandler.onApplyCritiqueSuggestion(e,r,a,n)}const g=r.nodeId?this.proofingDom.findNode(r.nodeId):r.tileId?this.proofingDom.findNode(r.tileId.nodeId):null;if(g){if(!c){if(!(0,v.qB)(a)&&(0,v.ht)(r))this.tileContent.remove(g,t,r.start,r.length,!0,s);else{let{start:e,length:n}=r,l=a.text,d=s;if(r.textInContext&&r.typeId===i.L9.DoubleSpaceGrammar){const t=o.CC(r.textInContext,l),i=l.length-t.firstDiffRight;t.firstDiffLeft===i&&(e+=t.firstDiffLeft,n=1,l="",d=void 0)}this.tileContent.replace(g,t,e,n,l,d)}(0,v.MG)(r)&&(null===(u=this.wordDictionary)||void 0===u||u.addWordToIgnoreList(a.text))}}else null===(d=this.logger)||void 0===d||d.error(508146699,"Unable to find node while applying critique suggestion")})),!d||l!==T.Ah.autocorrection&&l!==T.Ah.personalizedAutocorrection||null===(u=this._formElementAutoCorrectionCache)||void 0===u||u.removeForCritique(d,r.traceId||"")},this.applyFlagSuggestion=(e,t,n,r,i,o)=>this.applySuggestion(e,t,{nodeId:n,offset:r.start,typeId:r.typeId,traceId:r.traceId,textInContext:r.textInContext},(async()=>{var n,a,s;const l=o||!this.critiqueRangeBuilder?o:null===(n=(await this.critiqueRangeBuilder.getCritiqueRanges([r],t))[0])||void 0===n?void 0:n.range;l?this.applyFlagHandler?this.applyFlagHandler.onApplyFlag(e,r,i,l):null===(s=this.logger)||void 0===s||s.error(523633800,"Flag application failed due to no applyFlagHandler"):null===(a=this.logger)||void 0===a||a.error(523633799,"Unable to determine range for flag application")})),this.ignoreCritiqueOnce=(e,t,n,r)=>{var o;(null===(o=this.applyCritiqueSuggestionHandler)||void 0===o?void 0:o.onIgnoreCritiqueSuggestion(e,r))||this.callbackOnProofedElement({nodeId:n,offset:r.start,typeId:r.typeId,traceId:r.traceId,textInContext:r.textInContext},i.$w.IgnoreOnce)},this.ignoreFlagOnce=(e,t,n,r)=>{var o;(null===(o=this.applyFlagHandler)||void 0===o?void 0:o.onIgnoreFlag(e,r))||this.callbackOnProofedElement({nodeId:n,offset:r.start,typeId:r.typeId,traceId:r.traceId,textInContext:r.textInContext},i.$w.IgnoreOnce)},this.ignoreAllOfFlag=(e,t,n)=>{var r,o;const a=this.proofingDom.findParagraphNode(n.nodeId);(0,m.l)(a)?(null===(o=this.applyFlagHandler)||void 0===o?void 0:o.onIgnoreAllOfFlag(e,n))||this.callbackOnProofedElement({nodeId:n.nodeId,offset:n.start,typeId:n.typeId,traceId:n.traceId,textInContext:n.textInContext},i.$w.IgnoreAll):null===(r=this.logger)||void 0===r||r.error(507574144,"Unable to find paragraph node while ignoring all flags")},this.ignoreAllOfCritique=(e,t,n,r)=>{var i,o,s,l;if(!n)return;let d;d=(0,v.MG)(r)?r.suggestions[0].text:r.textInContext,d&&(null===(i=this.wordDictionary)||void 0===i||i.addWordToIgnoreList(d));const u=this.proofingDom.findParagraphNode(null!==(o=r.nodeId)&&void 0!==o?o:n);(0,m.l)(u)&&(null===(s=this.critiqueStore)||void 0===s||s.updateNode([{critique:(0,a._K)(r),critiqueDiffType:g.K.Delete}],u.parent.id,null!==(l=u.eventSeqId)&&void 0!==l?l:0))},this.disableCritiqueType=async(e,t,n,r)=>{var o,a;n&&(r.typeId&&await(null===(o=this.editorSettingsManager)||void 0===o?void 0:o.stopCheckingForCritiqueType(r.typeId)),this.callbackOnProofedElement({nodeId:n,offset:r.start,typeId:r.typeId,traceId:r.traceId,textInContext:r.textInContext},i.$w.DisableCritiqueType),await(null===(a=this._disableCritiqueHandler)||void 0===a?void 0:a.disableCritique(r)))},this.disableFlagType=(e,t,n,r)=>{var o;(null===(o=this.applyFlagHandler)||void 0===o?void 0:o.onDisableFlag(e,r))||this.callbackOnProofedElement({nodeId:n,offset:r.start,typeId:r.typeId,traceId:r.traceId,textInContext:r.textInContext},i.$w.DisableCritiqueType)},this.applySuggestion=async(e,t,n,r)=>{var o,a,l,d;const u=null!==(o=this.tileContent.getContainingElement(e))&&void 0!==o?o:t;if(!u)return void(null===(a=this.logger)||void 0===a||a.error(508146698,"Unable to find containing element"));const c=(0,I.m)(u),g=null!==(l=null==c?void 0:c.scrollTop)&&void 0!==l?l:0,h=null!==(d=null==c?void 0:c.scrollLeft)&&void 0!==d?d:0;await r(),this.callbackOnProofedElement(n,i.$w.ApplySuggestion);const p=(0,s.e)(u);this.safeWindow.requestAnimationFrame((()=>{c&&(c.scrollTop=g,c.scrollLeft=h)}),p)},this.callbackOnProofedElement=(e,t)=>{if(e.nodeId)for(const n of this._hostEmitters)n.emit(l.pD.hostModelCritiqueAction,{address:void 0,message:{critiqueInfo:e,actionType:t}})}}};D=(0,r.__decorate)([(0,w._)(),(0,r.__param)(0,(0,E.t)(l.zJ)),(0,r.__param)(1,(0,x.W)(y.d)),(0,r.__param)(2,(0,x.W)(h.s)),(0,r.__param)(2,(0,A.l)()),(0,r.__param)(3,(0,x.W)(_.w)),(0,r.__param)(4,(0,x.W)(d.j)),(0,r.__param)(5,(0,A.l)()),(0,r.__param)(5,(0,x.W)(b.W)),(0,r.__param)(6,(0,x.W)(u.g)),(0,r.__param)(6,(0,A.l)()),(0,r.__param)(7,(0,x.W)(g.$)),(0,r.__param)(7,(0,A.l)()),(0,r.__param)(8,(0,x.W)(p.a)),(0,r.__param)(8,(0,A.l)()),(0,r.__param)(9,(0,x.W)(f.K)),(0,r.__param)(9,(0,A.l)()),(0,r.__param)(10,(0,x.W)(C.s)),(0,r.__param)(10,(0,A.l)()),(0,r.__param)(11,(0,x.W)(c.rI)),(0,r.__param)(11,(0,A.l)()),(0,r.__param)(12,(0,A.l)()),(0,r.__param)(12,(0,x.W)(S.PF))],D)},71995:(e,t,n)=>{"use strict";n.d(t,{i:()=>r});const r=(0,n(63837).f)("ICritiqueApplicationHandler")},18794:(e,t,n)=>{"use strict";n.d(t,{Ah:()=>i,eO:()=>o,kI:()=>a,tB:()=>r});const r=15;var i;function o(e){return function(e){return void 0!==e.range}(e)?e.range:void 0}function a(e){return e===i.autocorrection||e===i.personalizedAutocorrection}!function(e){e.autocorrection="autocorrection",e.critique="critique",e.personalizedAutocorrection="personalized-autocorrection"}(i||(i={}))},34443:(e,t,n)=>{"use strict";n.d(t,{C:()=>i,Q:()=>o});var r=n(63837);const i=(0,r.f)("ISquigglerCanvasRenderingState"),o=(0,r.f)("ISquigglerCanvasRenderingStateFactory")},51959:(e,t,n)=>{"use strict";function r(e){return null===e?null:e.scrollHeight>e.clientHeight?e:r(e.parentNode)}function i(){return/Macintosh|Mac OS X/i.test(navigator.userAgent)}n.d(t,{i:()=>i,m:()=>r})},73232:(e,t,n)=>{"use strict";n.d(t,{dB:()=>l,Cf:()=>s,uE:()=>d});var r=n(48717);const i=[];let o;const a=e=>{o||(o=(()=>{const e=window.document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.top="-9999px",e.style.overflow="scroll",e.style.position="absolute",window.document.body.appendChild(e);const t=e.offsetWidth-e.clientWidth;return window.document.body.removeChild(e),t})());const t=i.find((e=>{var t;return!!(null===(t=e.search)||void 0===t?void 0:t.test(window.location.href))}));if(!(null==t?void 0:t.getWidth)){const t=!e.isInput&&"hidden"!==e.computedOverflow&&e.anchor.scrollHeight-e.anchor.clientHeight&&"content-box"!==e.boxSizing&&!navigator.platform.startsWith("mac"),n=Number.parseFloat(e.computedWidth);return t?n-o:e.computedWidth}return t.getWidth(e)},s=e=>{const t={},n=window.getComputedStyle(e),i=(0,r.C)(e,"HTMLInputElement");if(t.whiteSpace="pre-wrap",t.wordWrap="break-word",["position","direction","boxSizing","writingMode","width","height","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize","display","visibility"].forEach((e=>{t[e]=n[e]})),t.paddingBottom="0px"===t.paddingBottom?0:t.paddingBottom,i){const r=n.boxSizing&&"content-box"!==n.boxSizing?parseFloat(n.height)-parseFloat(n.paddingTop)-parseFloat(n.paddingBottom)-parseFloat(n.borderTopWidth)-parseFloat(n.borderBottomWidth):n.height;t.lineHeight=Number.isNaN(Number(r))?r:`${r}px`,t.whiteSpace="pre",t.overflow="hidden",t.height=parseFloat(t.height)+3,"search"===e.getAttribute("type")&&(t.direction&&"ltr"!==t.direction?t.paddingLeft=`${parseFloat(n.paddingLeft||0)+15}px`:t.paddingRight=`${parseFloat(n.paddingRight||0)+15}px`)}const o={anchor:e,computedWidth:t.width,computedOverflow:n.overflowY||"",boxSizing:n.boxSizing,isInput:i};let s="auto";if(n.zIndex&&"auto"!==n.zIndex){const e=parseInt(n.zIndex,10);s=isNaN(e)?0:e+1}return{overlay:Object.assign(Object.assign({},t),{left:0,top:0,position:"absolute",pointerEvents:"none",resize:"unset",backgroundColor:"transparent",borderColor:"transparent",WebkitTextFillColor:"none",color:"transparent",willChange:"contents",outline:"none",zIndex:s,lineHeight:Number.isNaN(t.lineHeight)?"unset":t.lineHeight,height:Number.isNaN(t.height)?"unset":t.height,width:Number.isNaN(t.width)?"unset":a(o)}),anchor:t}},l=(e,t,n)=>{var r;if(!t)return{top:0,left:0};const i=null!==(r=n.current)&&void 0!==r?r:{top:0,left:0},o=e.getBoundingClientRect(),a=t.getBoundingClientRect(),s=o.top-a.top,l=o.left-a.left;return{top:Math.abs(s)>0?i.top+s:i.top,left:Math.abs(l)>0?i.left+l:i.left,position:"relative",height:"0px"}},d=(e,t)=>({width:"100%",overflow:"hidden",height:e.scrollHeight-e.clientHeight==0?`calc(100% + ${null!=t?t:"2px"})`:"calc(100% + 2px)"})},51504:(e,t,n)=>{"use strict";n.d(t,{w:()=>o});var r=n(92135),i=n(6526);class o{constructor(){this.imports=[]}get uniqueId(){return(0,i.z)(507918369)}configureRootServices(e){e.bind(r.Th).toDynamicValue((()=>()=>e.getOptional(r.JY)))}}},43884:(e,t,n)=>{"use strict";n.d(t,{r:()=>R});var r=n(96589),i=n(30206),o=n(41260),a=n(20399),s=n(67005),l=n(52996),d=n(55025),u=n(14193),c=n(48828),g=n(30122),h=n(30225),p=n(90424);let f=class{constructor(e,t,n,r){this._hostEmitters=e,this._critiqueStore=t,this._proofingDom=n,this._logger=r,this.initialize=async()=>{for(const e of this._hostEmitters)e.on(o.pD.hostModelCritiqueAction,this.onHostModelCritiqueActionEvent)},this.shutDown=()=>{},this.onHostModelCritiqueActionEvent=e=>{if(!e.message.critiqueInfo.nodeId)return void this._logger.log(523871251,a.q.Error,`IHostModelCritiqueAction message: Received undefined args. ActionType:${e.message.actionType}`);let t=this._proofingDom.findTileNode(e.message.critiqueInfo.nodeId);if(!t){const n=this._proofingDom.findParagraphNode(e.message.critiqueInfo.nodeId);if(!(null==n?void 0:n.parent))return void this._logger.log(523896789,a.q.Error,"CritiqueActionEventHandler: Received event args with unknown node id.");t=n.parent}if(this._critiqueStore)switch(e.message.actionType){case s.$w.IgnoreOnce:case s.$w.ApplySuggestion:this._critiqueStore.removeCritique(e.message.critiqueInfo.traceId,e.message.critiqueInfo.nodeId);break;case s.$w.DisableCritiqueType:break;case s.$w.IgnoreAll:if(!e.message.critiqueInfo.typeId){this._logger.log(507574115,a.q.Error,"critique is missing typeId");break}if(!e.message.critiqueInfo.textInContext){this._logger.log(507574098,a.q.Error,"critique is missing textInContext");break}this._critiqueStore.removeAllCritiquesOfTypeAndText(e.message.critiqueInfo.typeId,e.message.critiqueInfo.textInContext);break;default:this._logger.log(523896792,a.q.Error,"CritiqueActionEventHandler: Received unexpected actionType.")}else this._logger.log(523896791,a.q.Error,"CritiqueActionEventHandler: No critique store is available.")}}};f=(0,i.__decorate)([(0,c._)(),(0,i.__param)(0,(0,g.t)(o.zJ)),(0,i.__param)(1,(0,h.l)()),(0,i.__param)(1,(0,p.W)(d.$)),(0,i.__param)(2,(0,p.W)(u.w)),(0,i.__param)(3,(0,p.W)(l.g))],f);var v=n(14262);let m=class{constructor(){this._applyHandlerMap=new Map,this._ignoreHandlerMap=new Map}handleApplyCritiqueSuggestion(e,t){return this._applyHandlerMap.set(e,t),()=>this._applyHandlerMap.delete(e)}onApplyCritiqueSuggestion(e,t,n,r){const i=this._applyHandlerMap.get(t.typeId);return!!i&&i(e,t,n,r)}handleIgnoreCritiqueSuggestion(e,t){return this._ignoreHandlerMap.set(e,t),()=>this._ignoreHandlerMap.delete(e)}onIgnoreCritiqueSuggestion(e,t){const n=this._ignoreHandlerMap.get(t.typeId);return!!n&&n(e,t)}};m=(0,i.__decorate)([(0,c._)()],m);var y=n(6793),_=n(15422),b=n(94453),C=n(44957),S=n(58964),T=n(62070),I=n(85230),w=n(79421),E=n(88670),x=n(90077);let A=class{constructor(e,t,n,r,i,o){this._logger=e,this._proofingDom=t,this._proofingPersistedStore=n,this._nodePoller=r,this._hostEmitter=i,this._hostSettings=o,this.getLocalesForSameLanguage=async e=>{var t,n,r,i;const o=[],a=await this._proofingPersistedStore.read(S.l.ProofingLanguages),s=e.suggestions.length&&(null===(t=e.suggestions[0].languages)||void 0===t?void 0:t.length)?e.suggestions[0].languages[0]:null!==(i=null!==(n=a[0])&&void 0!==n?n:null===(r=this._hostSettings.proofingLocales)||void 0===r?void 0:r[0])&&void 0!==i?i:this._hostSettings.defaultLocale;if(s){const e=s.split("-")[0];for(const t of a)e===t.split("-")[0]&&o.push(t)}else this._logger.error(557953868,"Expected language in ISuggestion or the list of Proofing Languages");return o}}async disableCritique(e){if(void 0===e.typeId)return;const t=await this._proofingPersistedStore.read(S.l.OverriddenCritiqueTypeOptions);let n=!1;for(const r of t)r.id===e.typeId&&(r.value="0",n=!0);if(!n){const n=await this.getLocalesForSameLanguage(e);for(const r of n)t.push({id:e.typeId,languageId:r,name:"",value:"0"})}await this._proofingPersistedStore.write(S.l.OverriddenCritiqueTypeOptions,t),this._hostEmitter.emit(o.pD.critiqueSettingsChange,{address:void 0,message:t}),this._nodePoller.pollNodes(T.G.ChangeData,this._proofingDom.tileNodes,I.Q0.Code),this._onDisableCritique&&this._onDisableCritique(e.typeId)}setOnDisableCritique(e){this._onDisableCritique=e}};A=(0,i.__decorate)([(0,c._)(),(0,i.__param)(0,(0,p.W)(l.g)),(0,i.__param)(1,(0,p.W)(u.w)),(0,i.__param)(2,(0,p.W)(w.K)),(0,i.__param)(3,(0,p.W)(x.G)),(0,i.__param)(4,(0,p.W)(o.M5)),(0,i.__param)(5,(0,p.W)(E.n))],A);var D=n(71995),k=n(6526),F=n(77148),P=n(71115),N=n(79548),B=n(34443);let O=class{constructor(e,t){this.proofingEventListener=e,this.container=t,this.messages=[],this.uxInitialized=!1,this.onCritiqueForUiEvent=e=>{this.uxInitialized?this.container.get(B.C).onCritiqueForUiEvent(e):this.messages.push(e)},this.onSquiggleUXReadyEvent=async e=>{const t=this.container.get(B.C);let n;for(;n=this.messages.shift();)await t.onCritiqueForUiEvent(n);this.uxInitialized=!0},this.onRecomputeSquigglesEvent=async e=>{this.uxInitialized&&this.container.get(B.C).updateSquiggleRanges()}}async initialize(){this.proofingEventListener.on("squiggleUXReadyEvent",this.onSquiggleUXReadyEvent),this.proofingEventListener.on("recomputeSquiggles",this.onRecomputeSquigglesEvent),this.proofingEventListener.on("squiggleDataEvent",this.onCritiqueForUiEvent)}shutDown(){}};O=(0,i.__decorate)([(0,c._)(),(0,i.__param)(0,(0,p.W)(N.o)),(0,i.__param)(1,(0,p.W)(P.p))],O);class R{constructor(){this.imports=[r.v]}get uniqueId(){return(0,k.z)(507918354)}configureRootServices(e){e.bind(b.g).toDynamicValue((e=>()=>e.getOptional(b.M))),e.bind(F.S).to(f),e.bind(v.a).to(m),e.bind(C.W).to(A),e.bind(D.i).to(_.n),e.bind(y.s).to(y.$),e.bind(F.S).to(O)}}},81108:(e,t,n)=>{"use strict";n.d(t,{N:()=>M});var r=n(51504),i=n(84457),o=n(30206),a=n(41260),s=n(62070),l=n(88670),d=n(23132),u=n(48828),c=n(30122),g=n(90424),h=n(84106);let p=class{constructor(e,t,n,r){this._hostEmitters=e,this._hostSettings=t,this._oaResultsStore=n,this._queryDetection=r,this.onOARankedAnnotationsEvent=e=>{const t=e.message.data,n=Object.assign(Object.assign({},t),{eventType:e.message.messageType,isLoading:!1});this.onEvent(n)},this.oaAnnotationsTriggeredEvent=e=>{this._oaResultsStore.updateLoadingStatus(!0)}}async initialize(){var e;if(this._hostSettings.enableOrchestration&&(null===(e=this._hostSettings.oaSettings)||void 0===e?void 0:e.isContextualCardEnabled))for(const e of this._hostEmitters)e.on(a.pD.oaAnnotationsTriggered,this.oaAnnotationsTriggeredEvent),e.on(a.pD.oaRankedAnnotations,this.onOARankedAnnotationsEvent)}shutDown(){}onEvent(e){const{results:t,tileId:n,latency:r,resultStatus:i,queryCorrelationKeys:o,resultSummary:a}=e;switch(e.eventType){case s.G.NewData:case s.G.ChangeData:this._oaResultsStore.updateResults(t,n,i,o?Object.assign(Object.assign({},o),{scopeInfo:this._queryDetection.getCurrentScope()}):void 0,r,a);break;case s.G.RemoveData:this._oaResultsStore.clearResults()}}};p=(0,o.__decorate)([(0,u._)(),(0,o.__param)(0,(0,c.t)(a.zJ)),(0,o.__param)(1,(0,g.W)(l.n)),(0,o.__param)(2,(0,g.W)(h.C)),(0,o.__param)(3,(0,g.W)(d.J))],p);var f=n(28363),v=n(14193);let m=class{constructor(e,t){this._inlineSuggestionsRenderer=e,this._proofingDom=t}filter(e){const t=this._inlineSuggestionsRenderer.getCurrentMenuInfo();if(!t||"InlineSuggestionsResultsUserInitiatedMenuType"!==t.menuType.menuType)return!0;if(e.nodeId===t.tileId){const n=this._proofingDom.findParagraphNode(t.tileId);if((null==n?void 0:n.element)&&"offset"in n.element)return!this.intersects(e.start,e.start+e.length,n.element.offset+t.queryRange.start,n.element.offset+t.queryRange.start+t.queryRange.length)}return!0}intersects(e,t,n,r){return e<=r&&n<=t}};m=(0,o.__decorate)([(0,u._)(),(0,o.__param)(0,(0,g.W)(f.V)),(0,o.__param)(1,(0,g.W)(v.w))],m);var y=n(48717),_=n(49520),b=n(12500),C=n(43900),S=n(32323),T=n(30225);let I=class{constructor(e,t,n,r){this._hostSettings=e,this._oaLogger=t,this._tileContent=n,this._shadowElementsStore=r}async getTargetLocationOfECC(e,t){var n,r,i,o,a,s,l;if((null===(n=t.menuCurrentlyOpen)||void 0===n?void 0:n.enableExpandedECCSearchBar)&&(this._hostSettings.flightsToTrack||[]).includes("mc-editor-attachbutton-searchbar-position")&&t.triggerMethod===f.P.AttachFile){const t=null===(r=(0,b.q)(this._tileContent,e))||void 0===r?void 0:r.parentNode,n=null!==t?t.getBoundingClientRect():void 0;if(n)return{x:n.left,y:n.top}}if(!t.menuCurrentlyOpen)return null;const{targetOffset:d,queryRange:u}=t.menuCurrentlyOpen,c=e.element.offset+u.start;let g=this._tileContent.getContainingElement(e);if((0,y.C)(g,"HTMLInputElement")||(0,y.C)(g,"HTMLTextAreaElement")){const t=null===(i=this._shadowElementsStore)||void 0===i?void 0:i.getShadowElementStore(e.parent.id);t?(await t.updateOverlay(),g=t.container):this._oaLogger.logDiagnostics("Attempted to render ECC on an input/textarea, but no shadow element store was available, so the ECC will most likely be placed in the wrong place.")}const h=await this._tileContent.getRangeOfNode(e.parent,g,c,null!==(a=null===(o=u.prefix)||void 0===o?void 0:o.length)&&void 0!==a?a:1);if(!g)return this._oaLogger.logDiagnostics("Attempted to render ECC, but the parent html element could not be determined"),null;if(!g.isConnected)return this._oaLogger.logDiagnostics("Attempted to render ECC, but the parent html element was disconnected"),null;if(!h)return this._oaLogger.logDiagnostics("Attempted to render ECC, but no valid range for the menu character could be found"),null;if(!h.startContainer.isConnected)return this._oaLogger.logDiagnostics("Attempted to render ECC, but an invalid range was returned containing a detached HTML node"),null;if((null===(s=this._hostSettings.oaSettings)||void 0===s?void 0:s.atMentionClassName)&&this.hasSomeParentWithAnyClass(h.startContainer,[this._hostSettings.oaSettings.atMentionClassName]))return null;if((null===(l=this._hostSettings.oaSettings)||void 0===l?void 0:l.disabledClassNames)&&this.hasSomeParentWithAnyClass(h.startContainer,this._hostSettings.oaSettings.disabledClassNames))return null;let p=h.getBoundingClientRect();if(0===p.top&&0===p.bottom&&0===p.left&&0===p.right&&0===p.height&&0===p.width){if(h.startContainer!==h.endContainer||!h.startContainer.parentElement)return this._oaLogger.logDiagnostics("Attempted to render ECC, but an invalid range for the menu character was found and the parent containing element wasn't available"),null;if(p=h.startContainer.parentElement.getBoundingClientRect(),0===p.top&&0===p.bottom&&0===p.left&&0===p.right&&0===p.height&&0===p.width)return this._oaLogger.logDiagnostics("Attempted to render ECC, but an invalid range for the menu character was found"),null}const v=d?new DOMRect(p.left-d.x,p.top-d.y,p.width+2*d.x,p.height+2*d.y):p;return function(e,t,n){const r=t.commonAncestorContainer.ownerDocument,i=null==r?void 0:r.defaultView;if(!i)return!1;const o={x:e.left+e.width/2,y:e.top+e.height/2};let a=r.elementFromPoint(o.x,o.y),s=!1;do{if(a===n){s=!0;break}a=null==a?void 0:a.parentNode}while(a);return!!s&&(o.x<0||o.y<0||o.x>(i.innerWidth||r.documentElement.clientWidth)||o.y>(i.innerHeight||r.documentElement.clientHeight))}(v,h,g)?null:v}hasSomeParentWithAnyClass(e,t){return!!t.find((t=>{var n;return null===(n=e.className)||void 0===n?void 0:n.split(" ").includes(t)}))||!!e.parentElement&&this.hasSomeParentWithAnyClass(e.parentElement,t)}};I=(0,o.__decorate)([(0,u._)(),(0,o.__param)(0,(0,g.W)(l.n)),(0,o.__param)(1,(0,g.W)(_.m)),(0,o.__param)(2,(0,g.W)(C.d)),(0,o.__param)(3,(0,T.l)()),(0,o.__param)(3,(0,g.W)(S.S))],I);var w=n(29747),E=n(6526),x=n(77148),A=n(82455),D=n(25100),k=n(84622),F=n(12323),P=n(11747),N=n(52669);let B=class{constructor(e,t,n){this._hostSettings=e,this._oaLogger=t,this.targetDocumentFactory=n}async getTargetLocationOfECC(e,t){var n,r,i,o,a,s,l,d,u,c,g;const h=null===(r=null===(n=this.targetDocumentFactory)||void 0===n?void 0:n.call(this))||void 0===r?void 0:r.deref(),p=null==h?void 0:h.getElementById(null!==(a=null===(o=null===(i=this._hostSettings.oaSettings)||void 0===i?void 0:i.enableECCForMobileDevice)||void 0===o?void 0:o.inputBoxId)&&void 0!==a?a:"m365chat-input-formTextBox"),f=null==p?void 0:p.getBoundingClientRect();if(!p||!f||0===f.top&&0===f.bottom&&0===f.left&&0===f.right&&0===f.height&&0===f.width)return this._oaLogger.logDiagnostics("Attempted to render ECC, but an invalid range for the menu character was found and the parent containing element wasn't available"),null;const v=null!==(d=null===(l=null===(s=this._hostSettings.oaSettings)||void 0===s?void 0:s.enableECCForMobileDevice)||void 0===l?void 0:l.mainAxisOverride)&&void 0!==d?d:0,m=null!==(g=null===(c=null===(u=this._hostSettings.oaSettings)||void 0===u?void 0:u.enableECCForMobileDevice)||void 0===c?void 0:c.crossAxisOverride)&&void 0!==g?g:0,y=new DOMRect(f.left-m,f.top-v,f.width,f.height);return function(e,t,n){const r=null==t?void 0:t.defaultView;if(!r)return!1;const i={x:e.left+e.width/2,y:e.top+e.height/2};let o=t.elementFromPoint(i.x,i.y),a=!1;do{if(o===n){a=!0;break}o=null==o?void 0:o.parentNode}while(o);return!!a&&(i.x<0||i.y<0||i.x>(r.innerWidth||t.documentElement.clientWidth)||i.y>(r.innerHeight||t.documentElement.clientHeight))}(y,h,p)?null:y}};B=(0,o.__decorate)([(0,u._)(),(0,o.__param)(0,(0,g.W)(l.n)),(0,o.__param)(1,(0,g.W)(_.m)),(0,o.__param)(2,(0,T.l)()),(0,o.__param)(2,(0,g.W)(N.Ze))],B);var O=n(72433);let R=class{getPluginCalloutMaxHeight(e,t,n){var r;const i=null!==(r=e.y)&&void 0!==r?r:e.top;if(i)return Math.max(t.innerHeight-i,i)-20}getCalloutDirection(e,t,n,r){return e?O.A.topRightEdge:O.A.topLeftEdge}};R=(0,o.__decorate)([(0,u._)()],R);let L=class{constructor(e){this.hostSettings=e,this._profilePicturesUrlsCache={},this.fetchProfilePicture=async e=>{if(!e)return;if(this._profilePicturesUrlsCache[e])return this._profilePicturesUrlsCache[e];const t=await this.getProfilePictureUrl(e);return this._profilePicturesUrlsCache[e]=t,t},this.fetchCachedProfilePicture=e=>{if(e)return this._profilePicturesUrlsCache[e]},this.getDefaultProfilePictureUrl=e=>`https://microsoft.sharepoint-df.com/_layouts/15/UserPhoto.aspx?size=m&accountName=${e}&default=none`}async getProfilePictureUrl(e){var t;return(null==e?void 0:e.includes("@"))?(null===(t=this.hostSettings.oaSettings)||void 0===t?void 0:t.getProfilePictureUrl)?await this.hostSettings.oaSettings.getProfilePictureUrl(e):this.getDefaultProfilePictureUrl(e):""}};L=(0,o.__decorate)([(0,u._)(),(0,o.__param)(0,(0,g.W)(l.n))],L);class M{constructor(){this.imports=[i.d,r.w]}get uniqueId(){return(0,E.z)(507918360)}configureRootServices(e){var t,n;e.bind(x.S).to(p),e.bind(h.C).to(h.L),e.bind(k.A).to(L),e.bind(f.V).to(F.W),e.bind(x.S).toExisting(f.V),e.bind(P.Z).toSelf(),(null===(n=null===(t=e.get(l.n).oaSettings)||void 0===t?void 0:t.enableECCForMobileDevice)||void 0===n?void 0:n.enabled)?(e.bind(A.j).to(B),e.bind(D.e).to(R)):e.bind(A.j).to(I),e.bind(w.D).to(m)}}},63799:(e,t,n)=>{"use strict";n.d(t,{D:()=>r});const r=(0,n(63837).f)("IPresentationDomSettings")},6300:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(63837).f)("GetIsHighContrastTheme")},75414:(e,t,n)=>{"use strict";n.d(t,{Y:()=>o,m:()=>i});const r=[".ms-ecc-callout",".ms-critique-callout","editor-card","ms-cc-overflow",".ms-cc-overflow"];function i(e,t){return!!(e&&"closest"in e&&e.closest((null!=t?t:r).join(", ")))}function o(e){return!!(e&&"isConnected"in e&&!e.isConnected&&"closest"in e&&e.closest('[role="menuitem"]'))}},96837:(e,t,n)=>{"use strict";function r(e){if(!e)return[];const t=[];for(const n of e.stores){const e=n.getCritiques();e.sort(((e,t)=>e.start-t.start));for(const r of e){const e={critique:r,store:n};t.push(e)}}return t}n.d(t,{v:()=>r})},6793:(e,t,n)=>{"use strict";n.d(t,{$:()=>v,s:()=>f});var r=n(30206),i=n(47436),o=n(38383),a=n(48416),s=n(13713),l=n(43900),d=n(14193),u=n(98937),c=n(63837),g=n(48828),h=n(90424),p=n(30225);const f=(0,c.f)("ICritiqueRangeBuilder");let v=class{constructor(e,t,n){this._tileContent=e,this._proofingDom=t,this._tileNodeTraverser=n,this.getCritiqueRangeAcrossTileNodes=e=>{const t=e.nodeId?this.getParagraphNodeAndOffset(e.nodeId,e.start):void 0;if(!t)return Promise.resolve(void 0);let n;return n=e.endNode?this.getParagraphNodeAndOffset(e.endNode.nodeId,e.endNode.end):this.getParagraphNodeAndOffset(e.nodeId,e.length),n?this.getRangeAcrossTileNodes(t.paragraphNode,n.paragraphNode,t.offset,n.offset):Promise.resolve(void 0)},this.getParagraphNodeAndOffset=(e,t)=>{const n=this._proofingDom.findParagraphNode(e);if(n)return{paragraphNode:n,offset:t};const r=this._proofingDom.findTileNode(e);if(!(null==r?void 0:r.children))return;let o;for(const e of r.children)(0,i.l)(e)&&t>=e.element.offset&&t<e.element.offset+e.element.span&&(o=e);return o?{paragraphNode:o,offset:t-o.element.offset}:void 0},this.getRangeAcrossTileNodes=async(e,t,n=0,r=-1)=>{let o=null;o="string"==typeof e?this._proofingDom.findParagraphNode(e):e;let a=null;if(a="string"==typeof t?this._proofingDom.findParagraphNode(t):t,(0,i.l)(o)&&(0,i.l)(a)){const e=await this._tileContent.getNodeInsertionPosition(o.parent,o.element.offset+n,!0),t=await this._tileContent.getNodeInsertionPosition(a.parent,a.element.offset+(-1===r?a.element.span:r),!1);if(!(null==e?void 0:e.startContainer.ownerDocument)||!(null==t?void 0:t.endContainer.ownerDocument)||e.startContainer.ownerDocument!==t.endContainer.ownerDocument)return;const i=e.startContainer.ownerDocument.createRange();return i.setStart(e.startContainer,e.startOffset),i.setEnd(t.endContainer,t.endOffset),i}},this.ensureNoLeadingOrTrailingWhitespace=e=>{if(e.endNode)return e;const t=e.nodeId?this.getParagraphNodeAndOffset(e.nodeId,e.start):void 0;if(!(null==t?void 0:t.paragraphNode.element)||!e.nodeId)return e;const n=t.offset-t.paragraphNode.element.offset,r=this._paragraphTextExtractor.getTextBetween(e.nodeId,e.nodeId,n,n+e.length);if(!r)return e;let i=e.start,o=e.length;const a=r.trimStart(),s=r.trimEnd();return r.length!==a.length&&(i+=r.length-a.length,o-=r.length-a.length),r.length!==s.length&&(o-=r.length-s.length),Object.assign(Object.assign({},e),{start:i,length:o})},this._paragraphTextExtractor=new o.o(this._proofingDom,this._tileNodeTraverser)}async getCritiqueRanges(e,t){var n,r,i;const o=new Map;for(const t of e){const e=t.nodeId?this._proofingDom.findNode(t.nodeId):t.tileId?this._proofingDom.findNode(t.tileId.nodeId):null,i=(null==e?void 0:e.nodeType)===a.Z.ParagraphNode?e.parent:(null==e?void 0:e.nodeType)===a.Z.TileNode?e:void 0;if((0,s.$)(i)){const e=null!==(r=null===(n=o.get(i.id))||void 0===n?void 0:n[0])&&void 0!==r?r:[];e.push(t),o.set(i.id,[e,i])}}const l=new Map;for(const[e,n]of o.values()){const r=[],o=[];for(const t of e)if(t.endNode){const e=this._proofingDom.findParagraphNode(t.endNode.nodeId);(null===(i=null==e?void 0:e.parent)||void 0===i?void 0:i.id)!==n.id?o.push(t):r.push(t)}else r.push(t);if(r.length>0){const e=await this._tileContent.getCritiqueRanges(n,t,r.map(this.ensureNoLeadingOrTrailingWhitespace));for(const t of e)l.set(r.find((e=>e.traceId===t.critique.traceId)),t.range)}if(o.length>0)for(const e of o)l.set(e,await this.getCritiqueRangeAcrossTileNodes(this.ensureNoLeadingOrTrailingWhitespace(e)))}return e.map((e=>({critique:e,range:l.get(e)})))}};v=(0,r.__decorate)([(0,g._)(),(0,r.__param)(0,(0,h.W)(l.d)),(0,r.__param)(1,(0,h.W)(d.w)),(0,r.__param)(2,(0,h.W)(u.M)),(0,r.__param)(2,(0,p.l)())],v)},14262:(e,t,n)=>{"use strict";n.d(t,{a:()=>r});const r=(0,n(63837).f)("IApplyCritiqueSuggestionHandler")},71108:(e,t,n)=>{"use strict";n.d(t,{K:()=>r});const r=(0,n(63837).f)("IApplyFlagHandler")},13536:(e,t,n)=>{"use strict";n.d(t,{m:()=>r});const r=(0,n(63837).f)("IAutoCorrectionBroker")},55025:(e,t,n)=>{"use strict";n.d(t,{$:()=>o,K:()=>r});var r,i=n(63837);!function(e){e[e.Add=0]="Add",e[e.Move=1]="Move",e[e.Update=2]="Update",e[e.Delete=4]="Delete"}(r||(r={}));const o=(0,i.f)("ICritiqueStore")},84457:(e,t,n)=>{"use strict";n.d(t,{d:()=>y});var r=n(6526),i=n(49520),o=n(30206),a=n(23132),s=n(48828),l=n(90424),d=n(59834),u=n(52996),c=n(93398);let g=class{constructor(e,t){this._queryDetection=e,this._logger=t,this._diagosticEventName="OAPanelDiagnostics",this.logDiagnostics=(e,t,n,r)=>{this.logInternal(this._diagosticEventName,e,t,n,r)},this.logActivity=(e,t,n,r)=>{this.logInternal(e,void 0,t,n,r)},this.logInternal=(e,t,n,r,i)=>{var o,a;const s=this._logger.getNewActivity(e,d.o.SamplingPolicy.CriticalExperimentation);null==s||s.dataFields.push(...(0,c.W)(["conversationId",null!==(o=null==i?void 0:i.conversationId)&&void 0!==o?o:this._queryDetection.getCurrentQueryConversationId()||""],["logicalId",null!==(a=null==i?void 0:i.logicalId)&&void 0!==a?a:this._queryDetection.getCurrentQueryLogicalId()||""])),t&&(null==s||s.dataFields.push((0,c.n)("message",t))),n&&(null==s||s.dataFields.push((0,c.n)("data",JSON.stringify(n)))),r&&(null==s||s.dataFields.push(...r)),s&&(s.success=!0,s.endNow())}}};g=(0,o.__decorate)([(0,s._)(),(0,o.__param)(0,(0,l.W)(a.J)),(0,o.__param)(1,(0,l.W)(u.g))],g);var h=n(23039),p=n(88670),f=n(24839),v=n(19374);let m=class{constructor(e,t,n){this._logger=e,this._hostSettings=t,this._eventName="OASuggestionLoadTime",this._dataEventName="Data",this._performanceApiGarbageCollectorIntervalInMs=12e4,this._logToTelemetry=(e,t,n,r)=>{var i,o,a,s,l;const u=this._logger.getNewActivity(r||this._eventName,d.o.SamplingPolicy.CriticalExperimentation);if(u){for(const t of e)u.dataFields.push((0,c.n)(t.name,t.duration,void 0,d.o.DataFieldType.Double.valueOf()));u.dataFields.push(...(0,c.W)(["conversationId",null!==(i=null==t?void 0:t.conversationId)&&void 0!==i?i:""],["logicalId",null!==(o=null==t?void 0:t.logicalId)&&void 0!==o?o:""],["triggeringChar",null!==(a=null==t?void 0:t.triggerCharacter)&&void 0!==a?a:"@"],[this._dataEventName,JSON.stringify(Object.assign({isEmptyQuery:null===(s=null==t?void 0:t.isEmptyQuery)||void 0===s||s,dataSource:void 0,isAL:!0,workflow:"oa",logicalId:null==t?void 0:t.logicalId},n))],["queryLength",null!==(l=null==t?void 0:t.queryLength)&&void 0!==l?l:0])),u.success=!0,u.endNow()}},this.metric=new v.J(e,n,this._eventName,this._performanceApiGarbageCollectorIntervalInMs,this._logToTelemetry),this.setOnTimeout(((e="",t)=>{t&&this.commitEntry(e,"Timeout")}))}log(e,t,n,r){this._logger.log(e,t,n,r)}info(e,t,n){this._logger.info(e,t,n)}warn(e,t,n){this._logger.warn(e,t,n)}error(e,t,n){this._logger.error(e,t,n)}debug(e,t,n){this._logger.debug(e,t,n)}logEvent(e,t,n,r,i,o,a){this._logger.logEvent(e,t,n,r,i,o,a)}getNewActivity(e,t,n){return this._logger.getNewActivity(e,t,n)}addCorrelationID(e){this._logger.addCorrelationID(e)}async initialize(e,t,n,r,i){return this._logger.initialize(e,t,n,r,i)}logDiagnostics(e,t,n,r){this._logger.logDiagnostics(e,t,n,r)}logActivity(e,t,n,r){this._logger.logActivity(e,t,n,r)}config({transports:e,activityTransport:t}){return this._logger.config({transports:e,activityTransport:t}),this._logger}startEntry(e,t,n){var r;(null===(r=this._hostSettings.oaSettings)||void 0===r?void 0:r.e2eMetric)&&this.metric.startEntry(e,t,n)}setOnTimeout(e){var t;(null===(t=this._hostSettings.oaSettings)||void 0===t?void 0:t.e2eMetric)&&this.metric.setOnTimeout(e)}addMeasure(e,t,n){var r;(null===(r=this._hostSettings.oaSettings)||void 0===r?void 0:r.e2eMetric)&&this.metric.addMeasure(e,t,n)}commitEntry(e,t,n){var r;(null===(r=this._hostSettings.oaSettings)||void 0===r?void 0:r.e2eMetric)&&this.metric.commitEntry(e,t,n)}};m=(0,o.__decorate)([(0,s._)(),(0,o.__param)(0,(0,l.W)(u.g)),(0,o.__param)(1,(0,l.W)(p.n)),(0,o.__param)(2,(0,l.W)(f.j))],m);class y{get uniqueId(){return(0,r.z)(507918355)}configureRootServices(e){e.bind(i.m).to(g),e.bind(h.u).to(m)}}},96589:(e,t,n)=>{"use strict";n.d(t,{v:()=>He});var r=n(30206),i=n(67005),o=n(48828),a=n(90424),s=n(32133);let l=class{constructor(e){this._wordDictionary=e}filter(e){return!!e.textInContext&&(e.typeId===i.L9.CIQFlag_DateEntityRecognition||e.typeId===i.L9.CIQFlag_PersonEntityRecognition||e.typeId===i.L9.CIQFlag_Location||e.typeId===i.L9.CIQFlag_Time||e.typeId===i.L9.CIQFlag_LocalBusiness||e.typeId===i.L9.CIQFlag_TaskRecognition||e.typeId===i.L9.CIQFlag_Topic||e.typeId===i.L9.CIQFlag_SatoriEntityRecognition||e.typeId===i.L9.CIQFlag_File||!this._wordDictionary.isWordIgnored(e.textInContext)&&!e.wasAddedToDictionaryInCurrentSession)}};l=(0,r.__decorate)([(0,o._)(),(0,r.__param)(0,(0,a.W)(s.s))],l);var d=n(88670),u=n(68081),c=n(30122),g=n(30225),h=n(63837);const p=(0,h.f)("ISelectedCritiqueCategory");let f=class{constructor(e){this._selectedCritiqueCategory=e}filter(e){return!!e&&(!this._selectedCritiqueCategory.isAnyCategorySelected()||void 0!==e.categoryTitle&&this._selectedCritiqueCategory.isCritiqueCategorySelected(e.categoryTitle))}};f=(0,r.__decorate)([(0,o._)(),(0,r.__param)(0,(0,a.W)(p))],f);var v=n(29747);(0,h.f)("StealthSquiggleEnabledCritiqueTypesArray");const m=(0,h.f)("IStealthSquiggleEnabledCritiqueTypes");var y=n(36857),_=n(38663),b=n(7971);let C=class{constructor(e,t,n){this._enabledCritiqueTypes=e,this._upsellStore=t,this._hostSettings=n}filter(e){var t,n;let r=!0;if(null===(t=this._upsellStore)||void 0===t?void 0:t.isUpsellUser){const t=null!==(n=e.typeId)&&void 0!==n?n:"";this._enabledCritiqueTypes.isCritiqueTypePremium(t)&&(this._hostSettings.enableOrchestration&&this._upsellStore.addPremiumCritique((0,y.OE)(e)),r=this._upsellStore.previewPremiumSquiggles)}return r}};C=(0,r.__decorate)([(0,o._)(),(0,r.__param)(0,(0,a.W)(_.g)),(0,r.__param)(1,(0,g.l)()),(0,r.__param)(1,(0,a.W)(b.Ey)),(0,r.__param)(2,(0,a.W)(d.n))],C);const S=(0,h.f)("ISpellingSettingsStore");let T=class{constructor(e){this._spellingSettingsStore=e}filter(e){var t;if(!e)return!1;if(e.priority!==i.bx.High||!this._spellingSettingsStore.isSpellingDisabledForAnyLanguage())return!0;const n=[];for(const r of e.suggestions){const e=null!==(t=r.languages)&&void 0!==t?t:[];r.languages=e.filter((e=>this._spellingSettingsStore.isSpellingEnabledForLanguage(e))),r.languages.length&&n.push(r)}return e.suggestions=n,!!n.length}};T=(0,r.__decorate)([(0,o._)(),(0,r.__param)(0,(0,a.W)(S))],T);let I=class{constructor(e,t,n,r,i,o,a,s){this._dictionaryCritiqueFilter=e,this._basicCritiqueFilters=t,this._hostSettings=n,this._featureFlagsReader=r,this._premiumCritiqueFilter=i,this._spellingCritiqueFilter=o,this._categoryCritiqueFilter=a,this._stealthSquiggleEnabledCritiqueTypes=s,this._critiqueFilters=[]}async initialize(){this._critiqueFilters.push(this._dictionaryCritiqueFilter),!this._hostSettings.enableOrchestration&&this._featureFlagsReader.flags.enableCritiqueSettings&&this._spellingCritiqueFilter&&this._critiqueFilters.push(this._spellingCritiqueFilter),this._critiqueFilters.push(...this._basicCritiqueFilters),this._hostSettings.enhancedUpsellEnabled&&this._premiumCritiqueFilter&&this._critiqueFilters.push(this._premiumCritiqueFilter),this._categoryCritiqueFilter&&this._critiqueFilters.push(this._categoryCritiqueFilter)}shutDown(){this._critiqueFilters.splice(0,this._critiqueFilters.length)}applyFilters(e){return e?e.filter((e=>{var t,n,r;const i=e.isVisible,o=e.isStealth;let a=!0;const s=null!==(r=null===(t=this._stealthSquiggleEnabledCritiqueTypes)||void 0===t?void 0:t.isCritiqueTypeEnabled(null!==(n=e.typeId)&&void 0!==n?n:"",e.priority))&&void 0!==r&&r;for(const t of this._critiqueFilters)if(a=t.filter(e),!a)break;return e.isVisible=a,e.isStealth=s,e.isVisible!==i||e.isStealth!==o})):[]}};I=(0,r.__decorate)([(0,o._)(),(0,r.__param)(0,(0,a.W)(l)),(0,r.__param)(1,(0,c.t)(v.D)),(0,r.__param)(1,(0,g.l)()),(0,r.__param)(2,(0,a.W)(d.n)),(0,r.__param)(3,(0,a.W)(u.c)),(0,r.__param)(4,(0,g.l)()),(0,r.__param)(4,(0,a.W)(C)),(0,r.__param)(5,(0,g.l)()),(0,r.__param)(5,(0,a.W)(T)),(0,r.__param)(6,(0,g.l)()),(0,r.__param)(6,(0,a.W)(f)),(0,r.__param)(7,(0,g.l)()),(0,r.__param)(7,(0,a.W)(m))],I);var w=n(20688),E=n(20399),x=n(59834),A=n(62070),D=n(85230),k=n(79548),F=n(79421),P=n(46600),N=n(52996),B=n(84002),O=n(90077),R=n(14193),L=n(58964),M=n(93398);const q=(e,t,n,r)=>{if(!e||!t)return;const i=e.getNewActivity(w.M.WebSiteProvedOnce,x.o.SamplingPolicy.CriticalBusinessImpact),o=t.getCachedEntry(L.l.ProofingLanguages).storeEntryValue;let a;r.execute(!1,(e=>(a=null==e?void 0:e.regionScope,e))),i&&(i.dataFields.push(...(0,M.W)(["Proofing_Languages",o.join(",")],["Region_Scope",null!=a?a:"unknown"],["IsAL",!0===n.enableOrchestration&&n.orchestratorSettings&&!0===n.orchestratorSettings.enableAugLoop||!1])),i.success=!0,i.endNow())};let W=class{constructor(e,t,n,r,i,o,a,s){this._proofingDom=e,this._proofingEmitter=t,this._nodePoller=n,this._proofingPersistedStore=r,this._hostSettings=i,this._userInfoStrategy=o,this._logger=a,this._e2eMetric=s,this._websiteProvedOnce=!1,this.onCritiqueEvent=e=>{try{this._detectWebSiteProved(e),this.updateCritiques(e)}catch(e){this._logger.logEvent(536978384,w.s.UpdateCritiqueException,E.q.Error,"Error while updating critiques on the shadow graph.",x.o.SamplingPolicy.CriticalBusinessImpact,e)}},this.updateCritiques=e=>{const t=e.data,n=new Map,r=[],i=new Set;for(const e of t){if(!e.tileId)continue;const t=e.tileId.elementId.id;i.has(t)||(this._e2eMetric.commitEntry(t),i.add(t));const o=n.get(e.tileId.nodeId);if(o)o.push(e);else{n.set(e.tileId.nodeId,[e]);const t=this._proofingDom.findTileNode(e.tileId.nodeId);t&&r.push(t)}}r.length&&this._nodePoller.pollNodes(A.G.NewData,r,D.Q0.Code,void 0,!1,n)}}async initialize(){this._proofingEmitter.on("critiqueEvent",this.onCritiqueEvent)}shutDown(){}_detectWebSiteProved(e){!this._websiteProvedOnce&&e.messageType===A.G.NewData&&e.data&&e.data.length&&(this._websiteProvedOnce=!0,q(this._logger,this._proofingPersistedStore,this._hostSettings,this._userInfoStrategy))}};W=(0,r.__decorate)([(0,o._)(),(0,r.__param)(0,(0,a.W)(R.w)),(0,r.__param)(1,(0,a.W)(k.o)),(0,r.__param)(2,(0,a.W)(O.G)),(0,r.__param)(3,(0,a.W)(F.K)),(0,r.__param)(4,(0,a.W)(d.n)),(0,r.__param)(5,(0,a.W)(P.e)),(0,r.__param)(6,(0,a.W)(N.g)),(0,r.__param)(7,(0,a.W)(B.m))],W);var U=n(48640);let z=class{constructor(e,t,n,r,i){this._proofingStore=e,this._emitter=t,this.nodePoller=n,this.proofingDom=r,this._logger=i,this._proofingLanguages=new U.I(this._proofingStore.getDefaultValue(L.l.ProofingLanguages))}async initialize(){this._proofingLanguages=new U.I(await this._proofingStore.read(L.l.ProofingLanguages)),this._emitter.on("proofingLanguageChanged",(async e=>{this.switchProofingLanguage(e.data)}))}shutDown(){}switchProofingLanguage(e){this._proofingLanguages.equalsTo(e.codesList)||(this._proofingLanguages=e,this._logger.debug(536978383,`Proofing languages list switched to ${e.codesList}`),this.proofingDom.tileNodes.map((e=>e.resetState())),this.nodePoller.pollNodes(A.G.NewData,this.proofingDom.tileNodes,D.Q0.Code,void 0,!0))}};z=(0,r.__decorate)([(0,o._)(),(0,r.__param)(0,(0,a.W)(F.K)),(0,r.__param)(1,(0,a.W)(k.o)),(0,r.__param)(2,(0,a.W)(O.G)),(0,r.__param)(3,(0,a.W)(R.w)),(0,r.__param)(4,(0,a.W)(N.g))],z);var j=n(41260);const H="19a112ec-21fd-432a-9d1f-195e5e94a00b";let V=class{constructor(e,t,n){this._hostEmitter=e,this._logger=t,this._proofingPersistedStore=n,this._hasSpellingBeenDisabled=!1,this._spellingSettings=new Set,this._readSpellingSettings=async e=>{const t=new Set;for(const n of e)n.id===H&&"0"===n.value&&(n.languageId?t.add(n.languageId):this._logger.error(545067014,"Undefined languageId in Spelling overriddenCritiqueTypeOption"));this._spellingSettings=t},this._updateSpellingSettings=async e=>{const t=e.message;await this._readSpellingSettings(t)}}async initialize(){const e=await this._proofingPersistedStore.read(L.l.OverriddenCritiqueTypeOptions);await this._readSpellingSettings(e),this._hostEmitter.on(j.pD.critiqueSettingsChange,this._updateSpellingSettings)}shutDown(){}isSpellingDisabledForAnyLanguage(){const e=this._spellingSettings.size>0;return e&&(this._hasSpellingBeenDisabled=!0),this._hasSpellingBeenDisabled||e}isSpellingEnabledForLanguage(e){return!this._spellingSettings.has(e)}};V=(0,r.__decorate)([(0,o._)(),(0,r.__param)(0,(0,a.W)(j.M5)),(0,r.__param)(1,(0,a.W)(N.g)),(0,r.__param)(2,(0,a.W)(F.K))],V);var G=n(12765);function Q(e,t,n,r){var o,a,s;e.set(i.L9.ContextualSpelling,1),e.set(i.L9.WrongSpelling,1),(null===(o=null==r?void 0:r.taskRecognition)||void 0===o?void 0:o.enabled)&&e.set(i.L9.CIQFlag_TaskRecognition,1),(null===(a=null==r?void 0:r.headingDetection)||void 0===a?void 0:a.enabled)&&e.set(i.L9.HeadingDetection,1),(null===(s=null==r?void 0:r.flagAnnotationSettings)||void 0===s?void 0:s.enabled)&&(e.set(i.L9.CIQFlag_Location,1),e.set(i.L9.CIQFlag_File,1),e.set(i.L9.CIQFlag_Time,1),e.set(i.L9.CIQFlag_LocalBusiness,1),e.set(i.L9.CIQFlag_Topic,1),e.set(i.L9.CIQFlag_SatoriEntityRecognition,1),e.set(i.L9.CIQFlag_DateEntityRecognition,1),e.set(i.L9.CIQFlag_PersonEntityRecognition,1));for(const r of t){const t=r.toLowerCase();"mc-officeeditortonalenabled"===t&&n===G.G_.Subscription?e.set(i.L9.TonalRewrite,1):"csi-editor-topicsuggestions"===t&&e.set(i.L9.TopicSuggestion,1)}}let K=class{constructor(e,t,n){var r;this._proofingPersistedStore=e,this._hostSettings=t,this._hostEmitter=n,this._availableCritiqueTypes=new Map,this._overriddenCritiqueTypes=new Map,this._premiumCritiqueTypes=new Map,this._ciqFlagsEnabled=!0,this.critiqueSettingsChange=e=>{this.setOverriddenCritiqueTypes(e.message)},this.ciqSettingsChange=e=>{this._ciqFlagsEnabled=e.message.ciqFlagsEnabled};const i=this._proofingPersistedStore.getCachedEntry(L.l.OverriddenCritiqueTypeOptions);Q(this._availableCritiqueTypes,null!==(r=this._hostSettings.flightsToTrack)&&void 0!==r?r:[],this._hostSettings.licenseType,this._hostSettings.serviceSettings),this.setOverriddenCritiqueTypes(i.storeEntryValue),i.isSynced||this.readOverriddenCritiqueTypesFromStorage()}async initialize(){this._hostEmitter.on(j.pD.critiqueSettingsChange,this.critiqueSettingsChange),this._hostEmitter.on(j.pD.ciqSettingsChange,this.ciqSettingsChange)}shutDown(){}async readOverriddenCritiqueTypesFromStorage(){const e=await this._proofingPersistedStore.read(L.l.OverriddenCritiqueTypeOptions);this.setOverriddenCritiqueTypes(e)}isCritiqueTypeEnabled(e,t){if((0,i.oe)(e)&&!this._ciqFlagsEnabled)return!1;const n=this._availableCritiqueTypes.get(e);let r=this._overriddenCritiqueTypes.get(e);if(this._critiqueToCategoryIdMap){const n=t===i.bx.High?H:this._critiqueToCategoryIdMap.get(e);n&&0===this._overriddenCritiqueTypes.get(n)&&(r=0)}return void 0===r?1===n:1===r}isCritiqueTypePremium(e){return e===i.L9.TonalRewrite||(this._hostSettings.enableOrchestration?1===this._premiumCritiqueTypes.get(e):1!==this._availableCritiqueTypes.get(e))}setOverriddenCritiqueTypes(e){if(e){this._overriddenCritiqueTypes.clear();for(const t of e)this._overriddenCritiqueTypes.set(t.id,parseInt(t.value,10))}}setAvailableCritiqueTypes(e,t){var n;if(e){this._availableCritiqueTypes.clear(),Q(this._availableCritiqueTypes,null!==(n=this._hostSettings.flightsToTrack)&&void 0!==n?n:[],this._hostSettings.licenseType,this._hostSettings.serviceSettings),this._critiqueToCategoryIdMap=t;for(const t of e)this._availableCritiqueTypes.set(t.id,t.defaultCritiqueValue)}}setPremiumCritiqueTypes(e){if(e){this._premiumCritiqueTypes.clear();for(const t of e)this._premiumCritiqueTypes.set(t.id,t.defaultCritiqueValue)}}};K=(0,r.__decorate)([(0,o._)(),(0,r.__param)(0,(0,a.W)(F.K)),(0,r.__param)(1,(0,a.W)(d.n)),(0,r.__param)(2,(0,a.W)(j.M5))],K);var $=n(98872);const Z=(0,h.f)("IEnabledPremiumCritiqueTypes");var J=n(6526),X=n(77148);class Y{constructor(){this.imports=[]}get uniqueId(){return(0,J.z)(507360220)}configureRootServices(e){e.bind(_.g).to(K),e.bind(X.S).toExisting(_.g),e.bind($.D).toExisting(_.g),e.bind(Z).toExisting(_.g)}}const ee=(0,h.f)("ICritiqueFilterer");var te;!function(e){e.IgnoreListUpdate="IgnoreListUpdate",e.CustomDictionaryUpdate="CustomDictionaryUpdate"}(te||(te={}));var ne=n(46079),re=n(77287);let ie=class{constructor(e,t,n,r,i,o){this._proofingDom=e,this._proofingEmitter=t,this.hostSettings=r,this._roamingDictionaryFeature=i,this._roamingDictionaryBroker=o,this._ignoredWords=new Set,this.isWordIgnored=e=>{var t;const n=e.trim();return!!this._ignoredWords.has(n)||!!(null===(t=this._roamingDictionaryFeature.getRoamingDictionary())||void 0===t?void 0:t.testWord(n,!0))},this.clearIgnoredWords=()=>{var e;this._ignoredWords.clear(),null===(e=this._nodePoller)||void 0===e||e.pollNodes(A.G.ChangeData,this._proofingDom.tileNodes,D.Q0.Code),this._proofingEmitter.emit("wordDictionaryEvent",{messageType:A.G.RemoveData,data:te.IgnoreListUpdate})},this.addWordToIgnoreList=(e,t=!1)=>{this.addWordsToIgnoreList([e],t)},this.addWordsToIgnoreList=(e,t=!1)=>{var n;let r=!1;for(let t=0;t<e.length;t++){const n=e[t];if(n){const e=n.trim();if(this._ignoredWords.has(e))continue;this._ignoredWords.add(e),r=!0}}r&&!t&&(null===(n=this._nodePoller)||void 0===n||n.pollNodes(A.G.ChangeData,this._proofingDom.tileNodes,D.Q0.Code),this._proofingEmitter.emit("wordDictionaryEvent",{messageType:A.G.NewData,data:te.IgnoreListUpdate}))},this.addWordToCustomDictionary=e=>{var t,n;if(e){if(this.hostSettings.enableV2RoamingDictionary&&(null===(t=this._roamingDictionaryBroker)||void 0===t?void 0:t.isRoamingDictionaryReady))return this._roamingDictionaryBroker.addWordToRoamingDictionary(e),!0;{const t=e.trim();if(this.roamingDictionary&&this._roamingDictionaryFeature.isReady())return!!this.roamingDictionary.addWord(t)&&(null===(n=this._nodePoller)||void 0===n||n.pollNodes(A.G.ChangeData,this._proofingDom.tileNodes,D.Q0.Code),this._proofingEmitter.emit("wordDictionaryEvent",{messageType:A.G.NewData,data:te.CustomDictionaryUpdate}),!0)}}return!1},this._nodePoller=r.enableOrchestration?void 0:n}get roamingDictionary(){if(this.hostSettings.enableRoamingDictionary)return this._roamingDictionaryFeature.getRoamingDictionary()}async initialize(){this.hostSettings.enableRoamingDictionary&&this._roamingDictionaryFeature.emitAndEvaluate({eventId:ne.U1.ClientInitialized,sender:ne.FS.WordDictionaryInit})}shutDown(){}get roamingDictionaryEnabled(){var e;return this.hostSettings.enableV2RoamingDictionary?!!(null===(e=this._roamingDictionaryBroker)||void 0===e?void 0:e.isRoamingDictionaryReady):!!this._roamingDictionaryFeature.isReady()}};ie=(0,r.__decorate)([(0,o._)(),(0,r.__param)(0,(0,a.W)(R.w)),(0,r.__param)(1,(0,a.W)(k.o)),(0,r.__param)(2,(0,a.W)(O.G)),(0,r.__param)(3,(0,a.W)(d.n)),(0,r.__param)(4,(0,a.W)(ne.Zp)),(0,r.__param)(5,(0,g.l)()),(0,r.__param)(5,(0,a.W)(re.C))],ie);class oe{constructor(){this.imports=[Y]}get uniqueId(){return(0,J.z)(507908323)}configureRootServices(e){e.bind(ee).to(I),e.bind(X.S).toExisting(ee),e.bind(l).toSelf(),e.bind(X.S).to(W),e.bind(X.S).to(z),e.bind(X.S).toExisting(s.s),e.bind(s.s).to(ie)}}var ae=n(46914),se=n(47255),le=n(87835);let de=class{constructor(e,t,n,r,i,o){this._enabledCritiqueTypes=e,this._paneEnabledCritiqueTypes=t,this._paneOpenState=n,this._proofingPersistedStore=r,this._upsellStore=i,this._indicatorStore=o}filter(e){return this.addCritiqueToIndicatorMapIfNeeded(e),void 0!==e.typeId&&this.isCritiqueCategoryEnabled(e.priority)&&this.isCritiqueTypeEnabled(e.typeId,e.priority)||e.typeId===i.L9.TopicSuggestion}isCritiqueCategoryEnabled(e){var t;return e===i.bx.High&&!!this._proofingPersistedStore.getCachedEntry(L.l.EnableSpelling).storeEntryValue||e===i.bx.Medium&&!!this._proofingPersistedStore.getCachedEntry(L.l.EnableGrammar).storeEntryValue||e===i.bx.Low&&((null===(t=this._upsellStore)||void 0===t?void 0:t.previewPremiumSquiggles)||!!this._proofingPersistedStore.getCachedEntry(L.l.EnableRefinements).storeEntryValue)||e===i.bx.Informational}isCritiqueTypeEnabled(e,t){var n,r;const i=void 0!==this._paneOpenState,o=i&&(null===(n=this._paneOpenState)||void 0===n?void 0:n.isPaneOpen)&&(null===(r=this._paneEnabledCritiqueTypes)||void 0===r?void 0:r.isCritiqueTypeEnabled(e,t));return this._enabledCritiqueTypes.isCritiqueTypeEnabled(e,t)||o||!!this._upsellStore&&(!i||this._upsellStore.previewPremiumSquiggles)&&this._enabledCritiqueTypes.isCritiqueTypePremium(e)}addCritiqueToIndicatorMapIfNeeded(e){var t,n;if(!(e.typeId&&e.traceId&&this._paneEnabledCritiqueTypes&&this._indicatorStore))return;const r=e.priority===i.bx.Low,o=this.isCritiqueCategoryEnabled(e.priority)||(null===(t=this._upsellStore)||void 0===t?void 0:t.isUpsellUser)&&r,a=this._paneEnabledCritiqueTypes.isCritiqueTypeEnabled(e.typeId,e.priority),s=this._enabledCritiqueTypes.isCritiqueTypeEnabled(e.typeId,e.priority);let l=!0;e.typeId!==i.L9.TopicSuggestion&&e.typeId!==i.L9.CIQFlag_Topic||(l=e.isVisible),o&&(a||s)&&l&&this._indicatorStore.addPaneCritique(e.traceId,r,e.categoryTitle,a&&!s&&!(null===(n=this._paneOpenState)||void 0===n?void 0:n.isPaneOpen))}};de=(0,r.__decorate)([(0,o._)(),(0,r.__param)(0,(0,a.W)(_.g)),(0,r.__param)(1,(0,g.l)()),(0,r.__param)(1,(0,a.W)(le.M)),(0,r.__param)(2,(0,g.l)()),(0,r.__param)(2,(0,a.W)(ae.F)),(0,r.__param)(3,(0,a.W)(F.K)),(0,r.__param)(4,(0,g.l)()),(0,r.__param)(4,(0,a.W)(b.Ey)),(0,r.__param)(5,(0,g.l)()),(0,r.__param)(5,(0,a.W)(se.y))],de);const ue=String.fromCharCode(65532);let ce=class{constructor(){}filter(e){var t;return!(null===(t=e.textInContext)||void 0===t?void 0:t.includes(ue))}};ce=(0,r.__decorate)([(0,o._)()],ce);var ge=n(55025),he=n(19718),pe=n(96865);function fe(e){return e.typeId===i.L9.TopicSuggestion?function(e){let t=0;try{e.suggestions.forEach((e=>{const n=JSON.parse(e.metadataJSON||"{}");t=Math.max(n.annotationScore,t)}))}catch(e){}return t}(e):e.typeId===i.L9.CIQFlag_Topic?function(e){var t;let n=0;return null===(t=e.suggestionItems)||void 0===t||t.forEach((e=>{e.entities.forEach((e=>{n=Math.max(e.confidence,n)}))})),n}(e):0}const ve=[i.L9.TopicSuggestion,i.L9.CIQFlag_Topic];class me extends he.z{constructor(e,t,n){super(),this._settings=e,this._logger=t,this._fre=n,this._critiquesByNode=new Map,this._latestNodeVersion=new Map,this._wordBoundaries=new Map,this.removeCritique=(e,t,n)=>{const r=null==n?void 0:n(t);if(!r)return"removeCritique - Unable to find tileNode";const i=this._critiquesByNode.get(r),o=i?this.findCritiqueInCritiques(i,e):void 0;if(!i||!o)return"removeCritique - Unable to find critique on tile";this.removeKnownCritique(o,i,o),this.dispatchCritiquesForNode(r,"Update")},this.getCritique=(e,t,n)=>{var r;const i=null==n?void 0:n(t);if(!i)return void(null===(r=this._logger)||void 0===r||r.error(507900049,"getCritique - Unable to find tileNode"));const o=this._critiquesByNode.get(i);return o?this.findCritiqueInCritiques(o,e):void 0},this.dispatchCritiquesForNode=(e,t)=>{const n=this._critiquesByNode.get(e),r=n?this.getCritiquesToDispatch(n):[];this.publishEvent("dispatchCritiques",{critiques:r,nodeId:e,messageType:A.G.NewData,reason:t})},this.removeAllCritiquesOfType=e=>{for(const t of this._critiquesByNode.keys())this.removeAllCritiquesOfTypeFromNode(t,e)},this.removeAllCritiquesOfTypeAndText=(e,t)=>{for(const n of this._critiquesByNode.keys())this.removeAllCritiquesOfTypeAndTextFromNode(n,e,t)},this.removeAllCritiquesOfTypeFromNode=(e,t)=>{const n=this.getCritiques(e);if(!n)return;const r=[];for(const e of n.critiques.values())e.typeId===t&&r.push(e);if(r.length>0){for(const e of r)this.removeSpecifiedCritique(e,n.critiques);this.dispatchCritiquesForNode(n.tileId,"Clear")}},this.removeAllCritiquesOfTypeAndTextFromNode=(e,t,n)=>{const r=this.getCritiques(e);if(!r)return;const i=[];for(const e of r.critiques.values())e.typeId===t&&e.textInContext===n&&i.push(e);if(i.length>0){for(const e of i)this.removeSpecifiedCritique(e,r.critiques);this.dispatchCritiquesForNode(r.tileId,"Clear")}},this.removeSpecifiedCritique=(e,t)=>{for(const n of t.values())if(n.traceId===e.traceId)return this.removeKnownCritique(e,t,n),!0;return!1},this.removeKnownCritique=(e,t,n)=>{(function(e){return"isFlagCritique"in e})(e)&&e.isIgnored||t.delete(n),this.publishEvent("removeCritiques",{critiques:new Set([n])})},this.getOverlappingCritiques=(e,t)=>{var n;const r=[];let o=1/0,a=!1,s=!1;for(const l of e)l.traceId!==t.traceId&&(0,pe.tw)(l,t)&&(o=Math.min(o,l.priority),a=a||l.typeId===i.L9.TopicSuggestion,s=s||null!==(n=l.isIgnored)&&void 0!==n&&n,r.push(l));return{shouldOverrideCritiques:!s&&(t.typeId===i.L9.TopicSuggestion||!a&&o>=t.priority),critiques:r}},this.getCritiquesToDispatch=e=>{var t;const n=Array.from(e.values()).filter((e=>e.isVisible&&!e.isIgnored));return null===(t=this._fre)||void 0===t||t.setFor(n),n},this.findCritiqueInCritiques=(e,t)=>{for(const n of e.values())if(n.traceId===t)return n}}clearNode(e){let t=!1;const n=this._critiquesByNode.get(e);n&&(this._critiquesByNode.delete(e),this._wordBoundaries.delete(e),this.publishEvent("removeCritiques",{critiques:n}),this._latestNodeVersion.has(e)&&this._latestNodeVersion.delete(e),t=!0),t&&this.publishEvent("dispatchCritiques",{critiques:[],nodeId:e,messageType:A.G.RemoveData,reason:"Clear"})}resetNode(e){this.clearNode(e),this.updateNode([],e,0)}getAllCritiques(){const e=[];for(const t of this._critiquesByNode.keys()){const n=this.getCritiques(t);n&&e.push(n)}return e}getCritiques(e){var t;const n=this._critiquesByNode.get(e);if(n)return{critiques:n,tileId:e,tileVersion:null!==(t=this._latestNodeVersion.get(e))&&void 0!==t?t:0}}setWordBoundaries(e,t,n,r){var i,o;let a=this._wordBoundaries.get(e);a||(a=new Map,this._wordBoundaries.set(e,a));const s=null!==(o=null===(i=a.get(t.id))||void 0===i?void 0:i.length)&&void 0!==o?o:0,l=t.range.span-s;if(a.set(t.id,{offset:t.range.offset,length:r&&s?s:t.range.span,boundaries:n}),!r)for(const e of a.values())e.offset>t.range.offset&&(e.offset+=l)}removeWordBoundariesByPosition(e,t,n){const r=this._wordBoundaries.get(e);if(!r)return;const i=t+n-1;for(const[e,o]of r)if(o.offset<t){const e=o.offset+o.length-1;e>t&&(o.length-=e-t)}else o.offset>=t&&o.offset+o.length-1<=i?r.delete(e):o.offset>=t&&o.offset<=i?(o.length-=t+n-o.offset,o.offset=t):o.offset-=n}updateNode(e,t,n,r=!1){var i,o;n>=(null!==(i=this._latestNodeVersion.get(t))&&void 0!==i?i:0)&&this._latestNodeVersion.set(t,n);const a=this._critiquesByNode.get(t),s=this._wordBoundaries.get(t);if(a){if(r||(null!==(o=this._settings.enableDispatchCritiquesOnEmptyDiffs)&&void 0!==o?o:e.length>0)){for(const t of e){const e=this.getOverlappingCritiques(a,t.critique);switch(t.critiqueDiffType){case ge.K.Add:case ge.K.Update:if(e.critiques.length){if(e.shouldOverrideCritiques){for(const t of e.critiques)this.removeSpecifiedCritique(t,a);this.isNotPartialCritique(t.critique,s)&&a.add(t.critique)}}else this.isNotPartialCritique(t.critique,s)&&a.add(t.critique);break;case ge.K.Delete:this.removeSpecifiedCritique(t.critique,a);case ge.K.Move:}}const n=[];if(n.push(t),function(e){return e.some((e=>e.critiqueDiffType!==ge.K.Move&&ve.includes(e.critique.typeId)))}(e)){const e=function(e,t){const n=[];return n.concat(function(e,t){const n=[];for(const t of e.values())for(const e of t)ve.includes(e.typeId)&&n.push(e);return function(e,t,n,r){var i;const o=[];let a=0;const s=new Set;for(const{critique:t}of e){let e=!1;const n=(null===(i=t.textInContext)||void 0===i?void 0:i.toLowerCase())||"";e=s.has(n),a<3&&!e?t.isVisible&&(r&&t.isStealth&&(t.isStealth=!1,o.push(t)),s.add(n),a++):e&&t.isVisible?(t.isVisible=!1,o.push(t)):t.isVisible&&(r&&!t.isStealth?(t.isStealth=!0,o.push(t)):r||(t.isVisible=!1,o.push(t)),s.add(n))}return o}(function(e){const t=[];return e.forEach((e=>{t.push({confidenceScore:fe(e),critique:e})})),t.sort(((e,t)=>t.confidenceScore-e.confidenceScore)),t}(n),0,0,t)}(e,t)),n}(this._critiquesByNode,!!this._settings.enableStealthSquiggles);for(const t of e)t.nodeId&&n.push(t.nodeId)}for(const e of n)this.dispatchCritiquesForNode(e,"Update")}}else this._critiquesByNode.set(t,new Set)}isNotPartialCritique(e,t){if(!0===this._settings.disableWordBoundaries||!t||0===t.size)return!0;for(const n of t.values())if(e.start>=n.offset&&e.start<n.offset+n.length){const t=n.offset;for(const r of n.boundaries){const n=r.start+t,i=r.end+t+1,o=i-n;if(e.start>=n&&e.start+e.length<=i&&e.length<o)return!1}return!0}return!0}setAugLoopProcessingHandler(e){}}const ye=(0,h.f)("ICritiquesFre");var _e=n(48416),be=n(22525);let Ce=class{constructor(e,t,n,r,i,o,a,s,l){this._hostSettings=e,this._upsellStore=t,this._proofingEmitter=n,this._hostEmitter=r,this._proofingDom=i,this._logger=o,this._indicatorStore=a,this._fre=s,this._sessionTelemetryTracker=l,this.removeCritique=(e,t)=>{const n=this._critiqueStoreCore.removeCritique(e,t,this.nodeIdFinder);return n&&this._logger.error(505816774,n),n},this.getCritique=(e,t)=>this._critiqueStoreCore.getCritique(e,t,this.nodeIdFinder),this.nodeIdFinder=e=>{var t;if(!e)return;const n=this._proofingDom.findNode(e);return(null==n?void 0:n.nodeType)===_e.Z.TileNode?n.id:(null==n?void 0:n.nodeType)===_e.Z.ParagraphNode?null===(t=n.parent)||void 0===t?void 0:t.id:void 0},this.removeAllCritiquesOfType=e=>{this._critiqueStoreCore.removeAllCritiquesOfType(e)},this.removeAllCritiquesOfTypeAndText=(e,t)=>{this._critiqueStoreCore.removeAllCritiquesOfTypeAndText(e,t)},this.removeAllCritiquesOfTypeFromNode=(e,t)=>{this._critiqueStoreCore.removeAllCritiquesOfTypeFromNode(e,t)},this.removeAllCritiquesOfTypeAndTextFromNode=(e,t,n)=>{this._critiqueStoreCore.removeAllCritiquesOfTypeAndTextFromNode(e,t,n)},this.onDispatchCritiques=({critiques:e,nodeId:t,messageType:n,reason:r})=>{var i;const o=this._proofingDom.findTileNode(t);if(o){if("VisualStateChange"===r&&0===e.length)return;this._proofingEmitter.emit("squiggleDataEvent",{messageType:n,data:{critiquesToElementsMap:[{elementId:t,element:o.element,critiques:e.map(y.OE)}],isVisualStateChange:"VisualStateChange"===r}}),null===(i=this._sessionTelemetryTracker)||void 0===i||i.update(e,t)}},this.onRemoveCritiques=e=>{var t,n;for(const r of e.critiques.values())null===(t=this._upsellStore)||void 0===t||t.removePremiumCritique(r),null===(n=this._indicatorStore)||void 0===n||n.removePaneCritique(r.traceId,r.categoryTitle)},this._critiqueStoreCore=new me(this._hostSettings,this._logger,this._fre),this._critiqueStoreCore.subscribe("dispatchCritiques",this.onDispatchCritiques),this._critiqueStoreCore.subscribe("removeCritiques",this.onRemoveCritiques)}get core(){return this._critiqueStoreCore}async initialize(){this._proofingEmitter.on("proofingLanguageChanged",(e=>{if(e.proofingLanguagesChanged&&!this.augLoopProcessingHandler)for(const e of this._proofingDom.tileNodes)this.resetNode(e.id)})),this._hostEmitter.on(j.pD.hostModelTileStateReset,(e=>{this.augLoopProcessingHandler||this.resetNode(e.message)})),this._hostEmitter.on(j.pD.hostModelVisualStateChange,(e=>{e.message.created&&!this.augLoopProcessingHandler&&this._critiqueStoreCore.dispatchCritiquesForNode(e.message.tileId,"VisualStateChange")}))}shutDown(){this._proofingEmitter.off("proofingLanguageChanged"),this._hostEmitter.off(j.pD.hostModelTileStateReset),this._hostEmitter.off(j.pD.hostModelVisualStateChange),this._critiqueStoreCore.unsubscribe("dispatchCritiques",this.onDispatchCritiques),this._critiqueStoreCore.unsubscribe("removeCritiques",this.onRemoveCritiques)}clearNode(e){this.augLoopProcessingHandler?this.augLoopProcessingHandler.clearNode(e):this._critiqueStoreCore.clearNode(e)}resetNode(e){this.augLoopProcessingHandler||this._critiqueStoreCore.resetNode(e)}getAllCritiques(){return this.augLoopProcessingHandler?this.augLoopProcessingHandler.getAllCritiques():this._critiqueStoreCore.getAllCritiques()}getCritiques(e){return this.augLoopProcessingHandler?this.augLoopProcessingHandler.getCritiques(e):this._critiqueStoreCore.getCritiques(e)}updateNode(e,t,n,r=!1){this.augLoopProcessingHandler?this.augLoopProcessingHandler.updateNode(e,t,n,r):this._critiqueStoreCore.updateNode(e,t,n,r)}setAugLoopProcessingHandler(e){this.augLoopProcessingHandler=e}};Ce=(0,r.__decorate)([(0,o._)(),(0,r.__param)(0,(0,a.W)(d.n)),(0,r.__param)(1,(0,g.l)()),(0,r.__param)(1,(0,a.W)(b.Ey)),(0,r.__param)(2,(0,a.W)(k.o)),(0,r.__param)(3,(0,a.W)(j.M5)),(0,r.__param)(4,(0,a.W)(R.w)),(0,r.__param)(5,(0,a.W)(N.g)),(0,r.__param)(6,(0,g.l)()),(0,r.__param)(6,(0,a.W)(se.y)),(0,r.__param)(7,(0,g.l)()),(0,r.__param)(7,(0,a.W)(ye)),(0,r.__param)(8,(0,g.l)()),(0,r.__param)(8,(0,a.W)(be.H))],Ce);var Se=n(47436),Te=n(11966),Ie=n(95988),we=n(24546),Ee=n(32942);class xe{constructor(e){this.paragraphNode=e}get id(){return this.paragraphNode.id}get range(){var e,t,n,r,i,o,a;return{offset:null!==(t=null===(e=this.paragraphNode.element)||void 0===e?void 0:e.offset)&&void 0!==t?t:0,span:null!==(r=null===(n=this.paragraphNode.element)||void 0===n?void 0:n.span)&&void 0!==r?r:0,textUnit:null===(i=this.paragraphNode.element)||void 0===i?void 0:i.textUnit,validEndBoundary:null===(o=this.paragraphNode.element)||void 0===o?void 0:o.validEndBoundary,enforcedCompleteTileTextUnit:null===(a=this.paragraphNode.element)||void 0===a?void 0:a.enforcedCompleteTileTextUnit}}}class Ae{constructor(e={enablePhraseTextUnitClientSide:!0,ignoreNonLatinZeroSquiggles:!0,enableSquigglesOnlyOnWholeWords:!0}){this.settings=e}isValid(e,t,n,r,o){var a,s,l,d;if(!e.nodeId||!t)return!1;const u=new Ee.a;if(this.settings.enablePhraseTextUnitClientSide&&e.priority!==i.bx.High&&!(0,i.oe)(e.typeId)&&t.range.textUnit!==Ie.fT.Sentence&&t.range.textUnit!==Ie.fT.Paragraph)return!1;if(this.settings.ignoreNonLatinZeroSquiggles&&(!e.suggestions.length||0===e.suggestions[0].action)&&((c=e.textInContext)&&/[^\u0000-\u007f]/.test(c)))return!1;var c;null==o||o(e);let g=e.textInContext;g&&(g=g.replace(/\u00A0/g," "));const h=t.range.offset,p=r(e);if(g!==p)return!1;if((e.priority===i.bx.High||e.priority===i.bx.Informational)&&(void 0===e.endNode||e.endNode.nodeId===t.id)&&this.settings.enableSquigglesOnlyOnWholeWords){const t=n;if(!t)return!1;const r=e.start-h,i=r+e.length,o=i===t.length;let[c,g]=function(e,t,n,r,i){if(!e)return["",0];let o=0;return(t===r||t+1===r&&we.Yv(e.charCodeAt(t+1)))&&(o+=1),n===i&&(o+=1),[e.substring(t,n),o]}(t,null!==(s=null===(a=u.getBackwardBreak(t,r+1))||void 0===a?void 0:a.cp)&&void 0!==s?s:0,null!==(d=null===(l=u.getForwardBreak(t,i-1))||void 0===l?void 0:l.cp)&&void 0!==d?d:i,r,i);return p&&!o&&"￼"===p[p.length-1]&&(g+=1),we._1(c)?!0:!!we.tF(c)||2===g}return!0}}var De=n(13536);function ke(e,t){var n;const r=e?t.findParagraphNode(e):null;return{paragraphNode:r,htmlElement:null===(n=null==r?void 0:r.parent)||void 0===n?void 0:n.element}}let Fe=class{constructor(e,t,n,r,i,o,a,s,l,d,u){this._critiqueStore=e,this._critiqueFilterer=t,this._logger=n,this._hostSettings=r,this._proofingPersistedStore=i,this._userInfoStrategy=o,this._e2eMetric=a,this._featureFlagReader=s,this._proofingDom=l,this._paragraphTextExtractor=d,this._autoCorrectionBroker=u,this._websiteProvedOnce=!1}onEvent(e){var t,n;const{added:r,removedIds:i,source:o,tileId:a,tileVersion:s}=e,{paragraphNode:l}=ke(a,this._proofingDom),d=null!==(n=null===(t=null==l?void 0:l.parent)||void 0===t?void 0:t.id)&&void 0!==n?n:a,u=this.onCommonCritiquesRemoved(i,o),c=r.filter((e=>{const t=u.findIndex((t=>(0,pe.gS)(e,t.critique)));return!(t>=0&&(u.splice(t,1),1))}));u.push(...this.onCommonCritiquesAdded(c,a)),u.length>0&&this._critiqueStore.updateNode(u,d,s),this._e2eMetric.commitEntry(`${a}--${s}`)}logWebsiteProvedOnce(){this._websiteProvedOnce||(this._websiteProvedOnce=!0,q(this._logger,this._proofingPersistedStore,this._hostSettings,this._userInfoStrategy))}onCommonCritiquesAdded(e,t){var n,r;if(0===e.length)return[];const{paragraphNode:i}=ke(t,this._proofingDom),o=null!==(r=null===(n=null==i?void 0:i.parent)||void 0===n?void 0:n.id)&&void 0!==r?r:t,a=new Ae({enablePhraseTextUnitClientSide:this._featureFlagReader.flags.enablePhraseTextUnitClientSide,ignoreNonLatinZeroSquiggles:!!this._hostSettings.ignoreNonLatinZeroSquiggles,enableSquigglesOnlyOnWholeWords:this._featureFlagReader.flags.enableSquigglesOnlyOnWholeWords}),s=this._paragraphTextExtractor.getParagraphText(i),l=function(e,t,n,r,i,o,a,s,l,d,u){if(0===e.length)return[];const c=a.getCritiques(n);if(!c)return[];const g=new Map,h=new Set;for(const e of c.critiques)l(e)&&g.set(e.start,e);const p=[];for(const n of e)if(n&&u.isValid(n,t,r,i,s)){const e=g.get(n.start);if(e&&(0,pe.gS)(e,n)){e.annotationId=n.annotationId,p.push({critique:e,critiqueDiffType:ge.K.Update}),h.add(n.start);continue}if(!o)for(const e of g.values())(0,pe.tw)(e,n)&&p.push({critique:e,critiqueDiffType:ge.K.Delete});d.applyFilters([n]),p.push({critique:n,critiqueDiffType:ge.K.Add})}if(o)for(const e of g.values())h.has(e.start)||p.push({critique:e,critiqueDiffType:ge.K.Delete});return p}(e,null===i?null:new xe(i),o,s,(e=>{var t,n;const r=null!==(n=null===(t=null==i?void 0:i.element)||void 0===t?void 0:t.offset)&&void 0!==n?n:0;let o="";return o=void 0===e.endNode?this._paragraphTextExtractor.getTextBetween(i,i,e.start-r,e.start-r+e.length):this._paragraphTextExtractor.getTextBetween(i,e.endNode.nodeId,e.start-r,e.endNode.end),o}),this._featureFlagReader.flags.enableForceClearCritiques,this._critiqueStore,(e=>{(0,Se.l)(i)&&(e.start=e.start+i.element.offset)}),(e=>((e,t)=>!!(0,Se.l)(t)&&e.nodeId!==t.id&&!(e.start>=t.element.offset+t.element.span||t.element.offset>=e.start+e.length))(e,i)),this._critiqueFilterer,a);return l.length>0&&this.logWebsiteProvedOnce(),l}onCommonCritiquesRemoved(e,t){return function(e,t,n,r){if(0===e.length)return[];const i=n.getAllCritiques().reduce(((e,t)=>{for(const n of t.critiques)e.set(n.annotationId,{critique:n,tileId:t.tileId,tileVersion:t.tileVersion});return e}),new Map),o=[];for(const n of e){const e=i.get(n);if(e){if("Augloop"===t&&(null==r?void 0:r.getHasAutoCorrectionBeenApplied(e.critique)))continue;o.push({critique:e.critique,critiqueDiffType:ge.K.Delete})}}return o}(e,t,this._critiqueStore,this._autoCorrectionBroker)}};Fe=(0,r.__decorate)([(0,o._)(),(0,r.__param)(0,(0,a.W)(ge.$)),(0,r.__param)(1,(0,a.W)(ee)),(0,r.__param)(2,(0,a.W)(N.g)),(0,r.__param)(3,(0,a.W)(d.n)),(0,r.__param)(4,(0,a.W)(F.K)),(0,r.__param)(5,(0,a.W)(P.e)),(0,r.__param)(6,(0,a.W)(B.m)),(0,r.__param)(7,(0,a.W)(u.c)),(0,r.__param)(8,(0,a.W)(R.w)),(0,r.__param)(9,(0,a.W)(Te.b)),(0,r.__param)(10,(0,g.l)()),(0,r.__param)(10,(0,a.W)(De.m))],Fe);var Pe=n(3327);let Ne=class{constructor(e,t,n){this._critiqueStore=e,this._critiqueFilterer=t,this._indicatorStore=n}onEvent(e){var t;const n=this._critiqueStore.getAllCritiques();null===(t=this._indicatorStore)||void 0===t||t.clearPaneCritiques();for(const e of n){const t=this._critiqueFilterer.applyFilters(Array.from(e.critiques.values())).map((e=>({critique:e,critiqueDiffType:ge.K.Update})));t.length>0&&this._critiqueStore.updateNode(t,e.tileId,e.tileVersion)}}};function Be(e,t){return t>=e.tileVersion}Ne=(0,r.__decorate)([(0,o._)(),(0,r.__param)(0,(0,a.W)(ge.$)),(0,r.__param)(1,(0,a.W)(ee)),(0,r.__param)(2,(0,g.l)()),(0,r.__param)(2,(0,a.W)(se.y))],Ne);let Oe=class{constructor(e){this._critiqueStore=e}onEvent(e){const t=this._critiqueStore.getCritiques(e.tileId);t&&Be(t,e.tileVersion)&&this._critiqueStore.updateNode([],e.tileId,e.tileVersion,!0)}};Oe=(0,r.__decorate)([(0,o._)(),(0,r.__param)(0,(0,a.W)(ge.$))],Oe);let Re=class{constructor(e){this._critiqueStore=e}onEvent(e){switch(e.eventType){case A.G.NewData:this._critiqueStore.updateNode([],e.tileId,e.tileVersion);break;case A.G.RemoveData:this._critiqueStore.clearNode(e.tileId)}}};Re=(0,r.__decorate)([(0,o._)(),(0,r.__param)(0,(0,a.W)(ge.$))],Re);var Le=n(35715),Me=n(77789);let qe=class{constructor(e,t,n,r,o){this._critiqueStore=e,this._featureFlagsReader=t,this._logger=n,this._wordDictionary=r,this._autoCorrectionBroker=o,this.calcLengths=e=>function(e,t,n,r=!1){var i;let o=null!=t?t:0,a=0;switch(n){case A.G.NewData:a=null!==(i=null==e?void 0:e.length)&&void 0!==i?i:o,r||(o=a);break;case A.G.RemoveData:a=-o;break;case A.G.ChangeData:a=e?e.length-o:a}return{length:o,lengthDiff:a}}(e.content,e.length,e.eventType,this._featureFlagsReader.flags.disableCalcLengthForAddDeltasInPresentation),this.deletedDiff=(e,t,n,r,o,a,s=!1)=>function(e,t,n,r,o,a,s=!1,l,d,u=!0){if(!t&&0===r&&!o)return;const c={offset:e.start,span:e.length},g={offset:n,span:r},h=(!We(t,u)||n===e.start)&&(n!==e.start+e.length||a!==A.G.RemoveData||void 0===o||!We(o,u))&&(s||n+r===e.start||n===e.start+e.length)&&function(e){return!(0,i.oe)(e.typeId)||e.typeId===i.L9.CIQFlag_DateEntityRecognition||e.typeId===i.L9.CIQFlag_PersonEntityRecognition||e.typeId===i.L9.HeadingDetection||e.typeId===i.L9.CIQFlag_TaskRecognition}(e);if(f=g,!(!(p=c)||!f||p.offset>=f.offset+f.span||f.offset>=p.offset+p.span)||h&&function(e,t){return!(!e||!t||e.offset!==t.offset+t.span&&t.offset!==e.offset+e.span)}(c,g)){if((0,Le.A_)(e)){if(null==d?void 0:d.getAutoCorrectionIsBeingApplied(e))return;(0,Me.yf)(e,l)}return{critique:e,critiqueDiffType:ge.K.Delete}}var p,f}(e,t,n,r,o,a,s,this._wordDictionary,this._autoCorrectionBroker)}onEvent(e){var t,n;const r=this._critiqueStore.getCritiques(e.tileId);if(!r||!Be(r,e.tileVersion))return;const{length:i,lengthDiff:o}=this.calcLengths(e),a=null!==(t=e.position)&&void 0!==t?t:0,s=[];for(const t of r.critiques){const r=this.deletedDiff(t,null!==(n=e.content)&&void 0!==n?n:"",a,i,e.deletedOrReplacedCharacters,e.eventType,e.eventType!==A.G.ChangeData);if(r)s.push(r);else if(t.start>=a&&0!==o){const e=t.start;t.start+=o,s.push({critique:t,critiqueDiffType:ge.K.Move,oldStart:e})}}this._critiqueStore.updateNode(s,e.tileId,e.tileVersion)}};function We(e,t){return 1===e.length&&(we.xC(e.charCodeAt(0))||t&&(0,Ee.B)(e))}qe=(0,r.__decorate)([(0,o._)(),(0,r.__param)(0,(0,a.W)(ge.$)),(0,r.__param)(1,(0,a.W)(u.c)),(0,r.__param)(2,(0,a.W)(N.g)),(0,r.__param)(3,(0,g.l)()),(0,r.__param)(3,(0,a.W)(s.s)),(0,r.__param)(4,(0,g.l)()),(0,r.__param)(4,(0,a.W)(De.m))],qe);let Ue=class{constructor(e,t,n,r,i,o,a,s,l){this._hostEmitters=e,this._proofingEmitter=t,this._critiquesEventHandler=n,this._filteringEventHandler=r,this._nodeEventHandler=i,this._spanEventHandler=o,this._formattingEventHandler=a,this._hostSettings=s,this._logger=l,this.shutDown=()=>{this._logger.log(556372812,E.q.Debug,"Shutting down EventHub.")},this.onFilterChangedEvent=e=>{this._filteringEventHandler.onEvent({eventType:e.messageType})},this.onHostModelCritiquesEvent=e=>{const t={added:e.data.critiquesAdded,removedIds:e.data.critiqueIdsRemoved,eventType:e.messageType,source:e.data.source,tileId:e.data.tileId,tileVersion:e.data.tileVersion};this._critiquesEventHandler.onEvent(t)},this.onHostModelDeltaEvent=e=>{const{delta:t,deletedOrReplacedCharacters:n,sourceType:r,tileId:i,tileVersion:o}=e.message;if(!0===this._hostSettings.sdkV2Enabled||r!==D.pf.TileNode)return;const a={position:t.position,length:t.length,content:t.content,eventType:t.deltaType===Pe.WI.Add?A.G.NewData:t.deltaType===Pe.WI.Delete?A.G.RemoveData:A.G.ChangeData,tileId:i,tileVersion:o,deletedOrReplacedCharacters:n};this._spanEventHandler.onEvent(a)},this.onHostModelFormattingDelta=e=>{const t=e.message.delta,n=e.message.tileId,r=e.message.tileVersion,i={formattedRanges:t.formattedRanges,eventType:t.deltaType===Pe.WI.Add?A.G.NewData:t.deltaType===Pe.WI.Delete?A.G.RemoveData:A.G.ChangeData,tileId:n,tileVersion:r};this._formattingEventHandler.onEvent(i)},this.onHostModelTextTileEvent=e=>{if(!0===this._hostSettings.sdkV2Enabled)return;const t=e.data.tileId,n=e.data.tileVersion,r={eventType:e.messageType,tileId:t,tileVersion:n};this._nodeEventHandler.onEvent(r)},this.onClearCritiquesForNode=e=>{const t={eventType:A.G.RemoveData,tileId:e.message.nodeId,tileVersion:Number.parseInt(e.message.seqId,10)};this._nodeEventHandler.onEvent(t)},this.onRestoreNodeForCritiqueStore=e=>{const t={eventType:A.G.NewData,tileId:e.message.nodeId,tileVersion:Number.parseInt(e.message.seqId,10)};this._nodeEventHandler.onEvent(t)}}async initialize(){if(this._logger.log(556372811,E.q.Debug,"Initializing EventHub."),this._hostSettings.enableOrchestration){this._proofingEmitter.on("enabledCritiqueTypesChanged",(e=>this.filterMessageType("enabledCritiqueTypesChanged",e,this.onFilterChangedEvent,void 0,A.G.ChangeData)));for(const e of["eccStateChanged","wordDictionaryEvent"])this._proofingEmitter.on(e,(t=>this.filterMessageType(e,t,this.onFilterChangedEvent,A.G.ChangeData)));for(const e of this._hostEmitters)e.on(j.pD.hostModelCritiques,(e=>this.filterMessageType("hostModelCritiques",e.message,this.onHostModelCritiquesEvent,void 0,A.G.ChangeData))),e.on(j.pD.hostModelFlags,(e=>this.filterMessageType("hostModelFlags",e.message,this.onHostModelCritiquesEvent,void 0,A.G.ChangeData))),e.on(j.pD.hostModelTextTile,(e=>this.filterMessageType("hostModelTextTile",e.message,this.onHostModelTextTileEvent,A.G.ChangeData))),e.on(j.pD.hostModelDelta,this.onHostModelDeltaEvent),e.on(j.pD.clearCritiquesForNode,this.onClearCritiquesForNode),e.on(j.pD.restoreNodeForCritiqueStore,this.onRestoreNodeForCritiqueStore),e.on(j.pD.hostModelFormattingDelta,this.onHostModelFormattingDelta)}}filterMessageType(e,t,n,r,i){i&&t.messageType!==i||r&&t.messageType===r?this._logger.log(556372815,E.q.Warn,`${e} message: Unexpected MessageType.`):n(t)}};Ue=(0,r.__decorate)([(0,o._)(),(0,r.__param)(0,(0,c.t)(j.zJ)),(0,r.__param)(1,(0,a.W)(k.o)),(0,r.__param)(2,(0,a.W)(Fe)),(0,r.__param)(3,(0,a.W)(Ne)),(0,r.__param)(4,(0,a.W)(Re)),(0,r.__param)(5,(0,a.W)(qe)),(0,r.__param)(6,(0,a.W)(Oe)),(0,r.__param)(7,(0,a.W)(d.n)),(0,r.__param)(8,(0,a.W)(N.g))],Ue);var ze=n(65017);let je=class{constructor(e){this._logger=e,this._renderedCritiques=new Map}update(e,t){const n=this._renderedCritiques.get(t)||new Map;for(const t of e){const e=`${t.textInContext}#${t.typeId}`;n.set(e,t)}this._renderedCritiques.set(t,n)}logTelemetry(){const e=this._logger.getNewActivity(ze.n.CritiquesShown,x.o.SamplingPolicy.CriticalExperimentation);if(!e)return;let t=[];Array.from(this._renderedCritiques.values()).forEach((e=>{t=t.concat(Array.from(e.values()))}));const n={};try{const e=Array.from(t.values()).reduce(((e,t)=>{if(t.typeId){let n=new Set;t.typeId===i.L9.TopicSuggestion&&(n=t.suggestions.reduce(((e,t)=>{const n=t.metadataJSON;if(n){const t=JSON.parse(n).id;t&&e.add(t)}return e}),new Set)),t.typeId in e?(e[t.typeId].count+=1,n.forEach(e[t.typeId].suggestions.add,e[t.typeId].suggestions)):e[t.typeId]={count:1,suggestions:n}}return e}),{});for(const t in e)n[t]={count:e[t].count,suggestions:[...e[t].suggestions]}}catch(e){this._logger.error(524116174,"Data preparation failed for CritiquesShown",e)}e.dataFields.push((0,M.n)("Critiques",JSON.stringify(n))),e.success=!0,e.endNow()}};je=(0,r.__decorate)([(0,o._)(),(0,r.__param)(0,(0,a.W)(N.g))],je);class He{constructor(){this.imports=[oe]}get uniqueId(){return(0,J.z)(507908322)}configureRootServices(e){e.bind(X.S).to(Ue),e.bind(Fe).toSelf(),e.bind(Ne).toSelf(),e.bind(Oe).toSelf(),e.bind(Re).toSelf(),e.bind(qe).toSelf(),e.bind(be.H).to(je),e.bind(ge.$).to(Ce),e.bind(X.S).toExisting(ge.$),e.bind(v.D).to(de),e.bind(v.D).to(ce)}}},87151:(e,t,n)=>{"use strict";n.d(t,{Y:()=>a,h:()=>s});var r=n(30206),i=n(63837),o=n(48828);const a=(0,i.f)("INudgeStore");let s=class{constructor(){this.updateNudge=async e=>{this._currentNudge=e,this._onUpdate&&await this._onUpdate()},this.clearNudge=async()=>{this._currentNudge=void 0,this._onUpdate&&await this._onUpdate()},this.getCurrentNudge=()=>this._currentNudge,this.setOnUpdatedNudge=e=>{this._onUpdate=e}}};s=(0,r.__decorate)([(0,o._)()],s)},84106:(e,t,n)=>{"use strict";n.d(t,{C:()=>h,L:()=>p});var r=n(30206),i=n(49520),o=n(88670),a=n(23132),s=n(23039),l=n(92801),d=n(48741),u=n(63837),c=n(48828),g=n(90424);const h=(0,u.f)("IOAResultStore");let p=class{constructor(e,t,n,r){this._oaLogger=e,this._hostSettings=t,this._queryDetection=n,this._oaMetric=r,this._results=[],this._resultsByNode=new Map,this._isLoading=!0,this._isTimeout=!1,this._resultReset=!1,this.setOnUpdate=e=>{this.onUpdate=e},this.updateResults=(e,t,n,r,i,o)=>{var a,s;if(null===(a=this._hostSettings.oaSettings)||void 0===a?void 0:a.mockNoAugloopResults)return;const l=(null==r?void 0:r.logicalId)&&r.logicalId!==this._queryDetection.getCurrentQueryLogicalId();this.logStoreUpdate(e,!!l,n,r),l?this._oaMetric.commitEntry(r.logicalId,"OAAnnotationResultsDropped"):(r&&this._oaMetric.addMeasure(r.logicalId,"OAResultsReceived"),this.cancelTimeout(),this._isLoading=!1,this._isTimeout=!1,this._resultSummary=o,this._resultStatus=n,this._resultReset=!1,this._results=this._results.concat(e),this._resultsByNode.set(t,e),this.update(n,e,null!==(s=null!=r?r:this._queryDetection.getCurrentQueryCorrelationKeys())&&void 0!==s?s:{conversationId:"",logicalId:""},t,i,o))},this.updateLoadingStatus=(e,t=!1)=>{this._isLoading=e,this._isTimeout=!1,this._resultSummary=void 0,this._resultStatus=void 0,this._resultReset=t,e&&(this.cancelTimeout(),this._timeoutID=setTimeout(this.timeoutFunc,this.getTimeoutThreshold())),this.update()},this.startNewECCMenu=()=>{this.cancelTimeout(),this._timeoutID=setTimeout(this.timeoutFunc,this.getTimeoutThreshold())},this.clearResults=()=>{this._results=[],this._isTimeout=!1,this._isLoading=!0,this._resultReset=!1,this._resultsByNode.clear()},this.getResults=()=>this._results,this.getResultSummary=()=>this._resultSummary,this.getResultStatus=()=>this._resultStatus,this.getLoadingStatus=()=>this._isLoading,this.getTimeoutStatus=()=>this._isTimeout||this._resultStatus===d.i.UnexpectedError,this.timeoutFunc=()=>{var e;this._isTimeout=!0,this._isLoading=!1,this._resultSummary={Timeout:1},this._resultStatus=d.i.Timeout,this._resultReset=!1,this.update(d.i.Timeout,void 0,null!==(e=this._queryDetection.getCurrentQueryCorrelationKeys())&&void 0!==e?e:{conversationId:"",logicalId:""},void 0,this.getTimeoutThreshold(),this._resultSummary)},this.cancelTimeout=()=>{this._timeoutID&&clearTimeout(this._timeoutID)},this.update=(e=void 0,t=[],n=void 0,r,i,o=void 0)=>{this.onUpdate&&this.onUpdate({results:t,isLoading:this._isLoading,queryCorrelationKeys:n,resultSummary:o,resultStatus:e,resultReset:this._resultReset,nodeId:r,latency:i})}}logStoreUpdate(e,t,n,r){const i={};for(const t of e)i[t.entityType]=t.entities.length;this._oaLogger.logActivity(l.y,{actualLogicalId:null==r?void 0:r.logicalId,actualConversationId:null==r?void 0:r.conversationId,annotationCount:e.length,resultStatus:null!=n?n:-1,annotations:i,dropped:t})}getTimeoutThreshold(){var e;return(null===(e=this._hostSettings.oaSettings)||void 0===e?void 0:e.updateResultsTimeout)||3500}};p=(0,r.__decorate)([(0,c._)(),(0,r.__param)(0,(0,g.W)(i.m)),(0,r.__param)(1,(0,g.W)(o.n)),(0,r.__param)(2,(0,g.W)(a.J)),(0,r.__param)(3,(0,g.W)(s.u))],p)},92801:(e,t,n)=>{"use strict";n.d(t,{$:()=>i,y:()=>r});const r="OAResultStoreUpdates",i="OAPredictionReceived"},72131:(e,t,n)=>{"use strict";n.d(t,{X:()=>s,o:()=>a});var r=n(30206),i=n(63837),o=n(48828);const a=(0,i.f)("IPredictionStore");let s=class{constructor(){this.updatePrediction=async e=>{this._currentPrediction=e,this._onUpdate&&await this._onUpdate()},this.clearPrediction=async()=>{this._currentPrediction=void 0,this._onUpdate&&await this._onUpdate()},this.getCurrentPrediction=()=>this._currentPrediction,this.setOnUpdatedPrediction=e=>{this._onUpdate=e}}};s=(0,r.__decorate)([(0,o._)()],s)},6163:(e,t,n)=>{"use strict";n.d(t,{z:()=>r});const r=(0,n(63837).f)("IPresentationSettings")},8730:(e,t,n)=>{"use strict";n.d(t,{i:()=>r});const r=(0,n(63837).f)("EditorCanvasInjectableComponent")},22525:(e,t,n)=>{"use strict";n.d(t,{H:()=>r});const r=(0,n(63837).f)("ISessionTelemetryTracker")},46785:(e,t,n)=>{"use strict";n.d(t,{qq:()=>kn,R9:()=>Fn});var r={};function i(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return btoa(t)}function o(e){const t=atob(e),n=new Uint8Array(t.length);for(let e=0;e<t.length;e++)n[e]=t.charCodeAt(e);return n}n.r(r),n.d(r,{BrowserExtensionRequestV1:()=>on,BrowserExtensionResponseV1:()=>un,CommonAppIdProperty:()=>Rt,CommonAppVersionProperty:()=>en,CommonCritique:()=>$t,CommonDescriptorsProperty:()=>jt,CommonLanguageIdProperty:()=>Wt,CommonLanguageUXIdProperty:()=>Vt,CommonOverriddenCritiqueTypeOptions:()=>Qt,CommonRequestIdProperty:()=>Mt,CommonResponseStatusProperty:()=>Lt,CommonRevisionIdProperty:()=>Xt,CommonRunOnProfileIdProperty:()=>Gt,CommonTextUnitProperty:()=>Ut,CommonTileIdProperty:()=>Jt,ConfigRequestV2:()=>sn,ConfigResponseV2:()=>gn,CritiqueCategoryInfo:()=>tn,CritiqueTypeInfo:()=>nn,CritiqueTypeOption:()=>vn,Descriptor:()=>Ht,EditorServiceConfigV2Headers:()=>bn,EditorServiceInstrumentationHeaders:()=>Sn,EditorServiceLanguageinfoHeaders:()=>Cn,EditorServicePostTileCheckHeaders:()=>_n,InstrumentationRequestV1:()=>dn,LanguageInfoRequestV1:()=>ln,LanguageInfoResponseV1:()=>hn,Metadatum:()=>Zt,Suggestion:()=>Kt,SupportedActions:()=>Yt,SupportedLanguage:()=>mn,TileCheckCritique:()=>yn,TileCheckRequestV1:()=>an,TileCheckResponseV1:()=>cn,TileCheckSpan:()=>pn,TileContent:()=>qt,TileElement:()=>fn,TopologyNode:()=>zt,UserIdentity:()=>rn});const a="$",s="_",l=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,d=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i;function u(e,t){var n,r;const i=e.parsedHeaders;if("HEAD"===e.request.method)return Object.assign(Object.assign({},i),{body:e.parsedBody});const o=t&&t.bodyMapper,a=Boolean(null==o?void 0:o.nullable),s=null==o?void 0:o.type.name;if("Stream"===s)return Object.assign(Object.assign({},i),{blobBody:e.blobBody,readableStreamBody:e.readableStreamBody});const l="Composite"===s&&o.type.modelProperties||{},d=Object.keys(l).some((e=>""===l[e].serializedName));if("Sequence"===s||d){const t=null!==(n=e.parsedBody)&&void 0!==n?n:[];for(const n of Object.keys(l))l[n].serializedName&&(t[n]=null===(r=e.parsedBody)||void 0===r?void 0:r[n]);if(i)for(const e of Object.keys(i))t[e]=i[e];return!a||e.parsedBody||i||0!==Object.getOwnPropertyNames(l).length?t:null}return function(e){const t=Object.assign(Object.assign({},e.headers),e.body);return e.hasNullableType&&0===Object.getOwnPropertyNames(t).length?e.shouldWrapBody?{body:null}:null:e.shouldWrapBody?Object.assign(Object.assign({},e.headers),{body:e.body}):t}({body:e.parsedBody,headers:i,hasNullableType:a,shouldWrapBody:(u=e.parsedBody,c=s,"Composite"!==c&&"Dictionary"!==c&&("string"==typeof u||"number"==typeof u||"boolean"==typeof u||null!==(null==c?void 0:c.match(/^(Date|DateTime|DateTimeRfc1123|UnixTime|ByteArray|Base64Url)$/i))||null==u))});var u,c}class c{constructor(e={},t=!1){this.modelMappers=e,this.isXML=t}validateConstraints(e,t,n){const r=(e,r)=>{throw new Error(`"${n}" with value "${t}" should satisfy the constraint "${e}": ${r}.`)};if(e.constraints&&null!=t){const{ExclusiveMaximum:n,ExclusiveMinimum:i,InclusiveMaximum:o,InclusiveMinimum:a,MaxItems:s,MaxLength:l,MinItems:d,MinLength:u,MultipleOf:c,Pattern:g,UniqueItems:h}=e.constraints;if(void 0!==n&&t>=n&&r("ExclusiveMaximum",n),void 0!==i&&t<=i&&r("ExclusiveMinimum",i),void 0!==o&&t>o&&r("InclusiveMaximum",o),void 0!==a&&t<a&&r("InclusiveMinimum",a),void 0!==s&&t.length>s&&r("MaxItems",s),void 0!==l&&t.length>l&&r("MaxLength",l),void 0!==d&&t.length<d&&r("MinItems",d),void 0!==u&&t.length<u&&r("MinLength",u),void 0!==c&&t%c!=0&&r("MultipleOf",c),g){const e="string"==typeof g?new RegExp(g):g;"string"==typeof t&&null!==t.match(e)||r("Pattern",g)}h&&t.some(((e,t,n)=>n.indexOf(e)!==t))&&r("UniqueItems",h)}}serialize(e,t,n,r={xml:{}}){var o,u,c;const v={xml:{rootName:null!==(o=r.xml.rootName)&&void 0!==o?o:"",includeRoot:null!==(u=r.xml.includeRoot)&&void 0!==u&&u,xmlCharKey:null!==(c=r.xml.xmlCharKey)&&void 0!==c?c:s}};let _={};const b=e.type.name;n||(n=e.serializedName),null!==b.match(/^Sequence$/i)&&(_=[]),e.isConstant&&(t=e.defaultValue);const{required:C,nullable:S}=e;if(C&&S&&void 0===t)throw new Error(`${n} cannot be undefined.`);if(C&&!S&&null==t)throw new Error(`${n} cannot be null or undefined.`);if(!C&&!1===S&&null===t)throw new Error(`${n} cannot be null.`);return null==t||null!==b.match(/^any$/i)?_=t:null!==b.match(/^(Number|String|Boolean|Object|Stream|Uuid)$/i)?_=function(e,t,n){if(null!=n)if(null!==e.match(/^Number$/i)){if("number"!=typeof n)throw new Error(`${t} with value ${n} must be of type number.`)}else if(null!==e.match(/^String$/i)){if("string"!=typeof n.valueOf())throw new Error(`${t} with value "${n}" must be of type string.`)}else if(null!==e.match(/^Uuid$/i)){if("string"!=typeof n.valueOf()||(r=n,!d.test(r)))throw new Error(`${t} with value "${n}" must be of type string and a valid uuid.`)}else if(null!==e.match(/^Boolean$/i)){if("boolean"!=typeof n)throw new Error(`${t} with value ${n} must be of type boolean.`)}else if(null!==e.match(/^Stream$/i)){const e=typeof n;if(!("string"===e||"function"==typeof n.pipe||"function"==typeof n.tee||n instanceof ArrayBuffer||ArrayBuffer.isView(n)||("function"==typeof Blob||"object"==typeof Blob)&&n instanceof Blob||"function"===e))throw new Error(`${t} must be a string, Blob, ArrayBuffer, ArrayBufferView, ReadableStream, or () => ReadableStream.`)}var r;return n}(b,n,t):null!==b.match(/^Enum$/i)?_=function(e,t,n){if(!t)throw new Error(`Please provide a set of allowedValues to validate ${e} as an Enum Type.`);if(!t.some((e=>"string"==typeof e.valueOf()?e.toLowerCase()===n.toLowerCase():e===n)))throw new Error(`${n} is not a valid value for ${e}. The valid values are: ${JSON.stringify(t)}.`);return n}(n,e.type.allowedValues,t):null!==b.match(/^(Date|DateTime|TimeSpan|DateTimeRfc1123|UnixTime)$/i)?_=function(e,t,n){if(null!=t)if(null!==e.match(/^Date$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(`${n} must be an instanceof Date or a string in ISO8601 format.`);t=t instanceof Date?t.toISOString().substring(0,10):new Date(t).toISOString().substring(0,10)}else if(null!==e.match(/^DateTime$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(`${n} must be an instanceof Date or a string in ISO8601 format.`);t=t instanceof Date?t.toISOString():new Date(t).toISOString()}else if(null!==e.match(/^DateTimeRfc1123$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(`${n} must be an instanceof Date or a string in RFC-1123 format.`);t=t instanceof Date?t.toUTCString():new Date(t).toUTCString()}else if(null!==e.match(/^UnixTime$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(`${n} must be an instanceof Date or a string in RFC-1123/ISO8601 format for it to be serialized in UnixTime/Epoch format.`);t=function(e){if(e)return"string"==typeof e.valueOf()&&(e=new Date(e)),Math.floor(e.getTime()/1e3)}(t)}else if(null!==e.match(/^TimeSpan$/i)&&!function(e){return l.test(e)}(t))throw new Error(`${n} must be a string in ISO 8601 format. Instead was "${t}".`);return t}(b,t,n):null!==b.match(/^ByteArray$/i)?_=function(e,t){if(null!=t){if(!(t instanceof Uint8Array))throw new Error(`${e} must be of type Uint8Array.`);t=i(t)}return t}(n,t):null!==b.match(/^Base64Url$/i)?_=function(e,t){if(null!=t){if(!(t instanceof Uint8Array))throw new Error(`${e} must be of type Uint8Array.`);t=function(e){if(e){if(!(e instanceof Uint8Array))throw new Error("Please provide an input of type Uint8Array for converting to Base64Url.");return function(e,t){let n=e.length;for(;n-1>=0&&"="===e[n-1];)--n;return e.substr(0,n)}(i(e)).replace(/\+/g,"-").replace(/\//g,"_")}}(t)}return t}(n,t):null!==b.match(/^Sequence$/i)?_=function(e,t,n,r,i,o){var s;if(!Array.isArray(n))throw new Error(`${r} must be of type Array.`);let l=t.type.element;if(!l||"object"!=typeof l)throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${r}.`);"Composite"===l.type.name&&l.type.className&&(l=null!==(s=e.modelMappers[l.type.className])&&void 0!==s?s:l);const d=[];for(let t=0;t<n.length;t++){const s=e.serialize(l,n[t],r,o);if(i&&l.xmlNamespace){const e=l.xmlNamespacePrefix?`xmlns:${l.xmlNamespacePrefix}`:"xmlns";"Composite"===l.type.name?(d[t]=Object.assign({},s),d[t][a]={[e]:l.xmlNamespace}):(d[t]={},d[t][o.xml.xmlCharKey]=s,d[t][a]={[e]:l.xmlNamespace})}else d[t]=s}return d}(this,e,t,n,Boolean(this.isXML),v):null!==b.match(/^Dictionary$/i)?_=function(e,t,n,r,i,o){if("object"!=typeof n)throw new Error(`${r} must be of type object.`);const s=t.type.value;if(!s||"object"!=typeof s)throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${r}.`);const l={};for(const t of Object.keys(n)){const a=e.serialize(s,n[t],r,o);l[t]=f(s,a,i,o)}if(i&&t.xmlNamespace){const e=t.xmlNamespacePrefix?`xmlns:${t.xmlNamespacePrefix}`:"xmlns",n=l;return n[a]={[e]:t.xmlNamespace},n}return l}(this,e,t,n,Boolean(this.isXML),v):null!==b.match(/^Composite$/i)&&(_=function(e,t,n,r,i,o){if(y(e,t)&&(t=m(e,t,n,"clientName")),null!=n){const s={},l=p(e,t,r);for(const d of Object.keys(l)){const u=l[d];if(u.readOnly)continue;let c,h=s;if(e.isXML)c=u.xmlIsWrapped?u.xmlName:u.xmlElementName||u.xmlName;else{const e=g(u.serializedName);c=e.pop();for(const t of e){null==h[t]&&(void 0!==n[d]&&null!==n[d]||void 0!==u.defaultValue)&&(h[t]={}),h=h[t]}}if(null!=h){if(i&&t.xmlNamespace){const e=t.xmlNamespacePrefix?`xmlns:${t.xmlNamespacePrefix}`:"xmlns";h[a]=Object.assign(Object.assign({},h[a]),{[e]:t.xmlNamespace})}const s=""!==u.serializedName?r+"."+u.serializedName:r;let l=n[d];const g=y(e,t);g&&g.clientName===d&&null==l&&(l=t.serializedName);const p=e.serialize(u,l,s,o);if(void 0!==p&&null!=c){const e=f(u,p,i,o);i&&u.xmlIsAttribute?(h[a]=h[a]||{},h[a][c]=p):i&&u.xmlIsWrapped?h[c]={[u.xmlElementName]:e}:h[c]=e}}}const d=function(e,t,n){const r=t.type.additionalProperties;if(!r&&t.type.className){const r=h(e,t,n);return null==r?void 0:r.type.additionalProperties}return r}(e,t,r);if(d){const t=Object.keys(l);for(const i in n)t.every((e=>e!==i))&&(s[i]=e.serialize(d,n[i],r+'["'+i+'"]',o))}return s}return n}(this,e,t,n,Boolean(this.isXML),v)),_}deserialize(e,t,n,r={xml:{}}){var i,l,d,u;const c={xml:{rootName:null!==(i=r.xml.rootName)&&void 0!==i?i:"",includeRoot:null!==(l=r.xml.includeRoot)&&void 0!==l&&l,xmlCharKey:null!==(d=r.xml.xmlCharKey)&&void 0!==d?d:s},ignoreUnknownProperties:null!==(u=r.ignoreUnknownProperties)&&void 0!==u&&u};if(null==t)return this.isXML&&"Sequence"===e.type.name&&!e.xmlIsWrapped&&(t=[]),void 0!==e.defaultValue&&(t=e.defaultValue),t;let h;const f=e.type.name;if(n||(n=e.serializedName),null!==f.match(/^Composite$/i))h=function(e,t,n,r,i){var o,l;const d=null!==(o=i.xml.xmlCharKey)&&void 0!==o?o:s;y(e,t)&&(t=m(e,t,n,"serializedName"));const u=p(e,t,r);let c={};const h=[];for(const o of Object.keys(u)){const s=u[o],p=g(u[o].serializedName);h.push(p[0]);const{serializedName:f,xmlName:v,xmlElementName:m}=s;let y=r;""!==f&&void 0!==f&&(y=r+"."+f);const _=s.headerCollectionPrefix;if(_){const t={};for(const r of Object.keys(n))r.startsWith(_)&&(t[r.substring(_.length)]=e.deserialize(s.type.value,n[r],y,i)),h.push(r);c[o]=t}else if(e.isXML)if(s.xmlIsAttribute&&n[a])c[o]=e.deserialize(s,n[a][v],y,i);else if(s.xmlIsMsText)void 0!==n[d]?c[o]=n[d]:"string"==typeof n&&(c[o]=n);else{const t=m||v||f;if(s.xmlIsWrapped){const t=n[v],r=null!==(l=null==t?void 0:t[m])&&void 0!==l?l:[];c[o]=e.deserialize(s,r,y,i),h.push(v)}else{const r=n[t];c[o]=e.deserialize(s,r,y,i),h.push(t)}}else{let r,a=n,l=0;for(const e of p){if(!a)break;l++,a=a[e]}null===a&&l<p.length&&(a=void 0),r=a;const d=t.type.polymorphicDiscriminator;let g;if(d&&o===d.clientName&&null==r&&(r=t.serializedName),Array.isArray(n[o])&&""===u[o].serializedName){r=n[o];const t=e.deserialize(s,r,y,i);for(const[e,n]of Object.entries(c))Object.prototype.hasOwnProperty.call(t,e)||(t[e]=n);c=t}else void 0===r&&void 0===s.defaultValue||(g=e.deserialize(s,r,y,i),c[o]=g)}}const f=t.type.additionalProperties;if(f){const t=e=>{for(const t in u)if(g(u[t].serializedName)[0]===e)return!1;return!0};for(const o in n)t(o)&&(c[o]=e.deserialize(f,n[o],r+'["'+o+'"]',i))}else if(n&&!i.ignoreUnknownProperties)for(const e of Object.keys(n))void 0!==c[e]||h.includes(e)||v(e,i)||(c[e]=n[e]);return c}(this,e,t,n,c);else{if(this.isXML){const e=c.xml.xmlCharKey;void 0!==t[a]&&void 0!==t[e]&&(t=t[e])}null!==f.match(/^Number$/i)?(h=parseFloat(t),isNaN(h)&&(h=t)):null!==f.match(/^Boolean$/i)?h="true"===t||"false"!==t&&t:null!==f.match(/^(String|Enum|Object|Stream|Uuid|TimeSpan|any)$/i)?h=t:null!==f.match(/^(Date|DateTime|DateTimeRfc1123)$/i)?h=new Date(t):null!==f.match(/^UnixTime$/i)?h=function(e){if(e)return new Date(1e3*e)}(t):null!==f.match(/^ByteArray$/i)?h=o(t):null!==f.match(/^Base64Url$/i)?h=function(e){if(e){if(e&&"string"!=typeof e.valueOf())throw new Error("Please provide an input of type string for converting to Uint8Array");return o(e=e.replace(/-/g,"+").replace(/_/g,"/"))}}(t):null!==f.match(/^Sequence$/i)?h=function(e,t,n,r,i){var o;let a=t.type.element;if(!a||"object"!=typeof a)throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${r}`);if(n){Array.isArray(n)||(n=[n]),"Composite"===a.type.name&&a.type.className&&(a=null!==(o=e.modelMappers[a.type.className])&&void 0!==o?o:a);const t=[];for(let o=0;o<n.length;o++)t[o]=e.deserialize(a,n[o],`${r}[${o}]`,i);return t}return n}(this,e,t,n,c):null!==f.match(/^Dictionary$/i)&&(h=function(e,t,n,r,i){const o=t.type.value;if(!o||"object"!=typeof o)throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${r}`);if(n){const t={};for(const a of Object.keys(n))t[a]=e.deserialize(o,n[a],r,i);return t}return n}(this,e,t,n,c))}return e.isConstant&&(h=e.defaultValue),h}}function g(e){const t=[];let n="";if(e){const r=e.split(".");for(const e of r)"\\"===e.charAt(e.length-1)?n+=e.substr(0,e.length-1)+".":(n+=e,t.push(n),n="")}return t}function h(e,t,n){const r=t.type.className;if(!r)throw new Error(`Class name for model "${n}" is not provided in the mapper "${JSON.stringify(t,void 0,2)}".`);return e.modelMappers[r]}function p(e,t,n){let r=t.type.modelProperties;if(!r){const i=h(e,t,n);if(!i)throw new Error(`mapper() cannot be null or undefined for model "${t.type.className}".`);if(r=null==i?void 0:i.type.modelProperties,!r)throw new Error(`modelProperties cannot be null or undefined in the mapper "${JSON.stringify(i)}" of type "${t.type.className}" for object "${n}".`)}return r}function f(e,t,n,r){if(!n||!e.xmlNamespace)return t;const i={[e.xmlNamespacePrefix?`xmlns:${e.xmlNamespacePrefix}`:"xmlns"]:e.xmlNamespace};if(["Composite"].includes(e.type.name)){if(t[a])return t;{const e=Object.assign({},t);return e[a]=i,e}}const o={};return o[r.xml.xmlCharKey]=t,o[a]=i,o}function v(e,t){return[a,t.xml.xmlCharKey].includes(e)}function m(e,t,n,r){var i;const o=y(e,t);if(o){let a=o[r];if(a){"serializedName"===r&&(a=a.replace(/\\/gi,""));const o=n[a],s=null!==(i=t.type.uberParent)&&void 0!==i?i:t.type.className;if("string"==typeof o&&s){const n=function(e,t,n){const r=[n];for(;r.length;){const n=r.shift(),i=t===n?t:n+"."+t;if(Object.prototype.hasOwnProperty.call(e,i))return e[i];for(const[t,i]of Object.entries(e))t.startsWith(n+".")&&i.type.uberParent===n&&i.type.className&&r.push(i.type.className)}}(e.modelMappers.discriminators,o,s);n&&(t=n)}}}return t}function y(e,t){return t.type.polymorphicDiscriminator||_(e,t.type.uberParent)||_(e,t.type.className)}function _(e,t){return t&&e.modelMappers[t]&&e.modelMappers[t].type.polymorphicDiscriminator}const b="Sequence",C="String",S="Stream",T=new Set(["Deserialize","Serialize","Retry","Sign"]);class I{constructor(e){var t;this._policies=[],this._policies=null!==(t=null==e?void 0:e.slice(0))&&void 0!==t?t:[],this._orderedPolicies=void 0}addPolicy(e,t={}){if(t.phase&&t.afterPhase)throw new Error("Policies inside a phase cannot specify afterPhase.");if(t.phase&&!T.has(t.phase))throw new Error(`Invalid phase name: ${t.phase}`);if(t.afterPhase&&!T.has(t.afterPhase))throw new Error(`Invalid afterPhase name: ${t.afterPhase}`);this._policies.push({policy:e,options:t}),this._orderedPolicies=void 0}removePolicy(e){const t=[];return this._policies=this._policies.filter((n=>!(e.name&&n.policy.name===e.name||e.phase&&n.options.phase===e.phase)||(t.push(n.policy),!1))),this._orderedPolicies=void 0,t}sendRequest(e,t){return this.getOrderedPolicies().reduceRight(((e,t)=>n=>t.sendRequest(n,e)),(t=>e.sendRequest(t)))(t)}getOrderedPolicies(){return this._orderedPolicies||(this._orderedPolicies=this.orderPolicies()),this._orderedPolicies}clone(){return new I(this._policies)}static create(){return new I}orderPolicies(){const e=[],t=new Map;function n(e){return{name:e,policies:new Set,hasRun:!1,hasAfterPolicies:!1}}const r=n("Serialize"),i=n("None"),o=n("Deserialize"),a=n("Retry"),s=n("Sign"),l=[r,i,o,a,s];function d(e){return"Retry"===e?a:"Serialize"===e?r:"Deserialize"===e?o:"Sign"===e?s:i}for(const e of this._policies){const n=e.policy,r=e.options,i=n.name;if(t.has(i))throw new Error("Duplicate policy names not allowed in pipeline");const o={policy:n,dependsOn:new Set,dependants:new Set};r.afterPhase&&(o.afterPhase=d(r.afterPhase),o.afterPhase.hasAfterPolicies=!0),t.set(i,o),d(r.phase).policies.add(o)}for(const e of this._policies){const{policy:n,options:r}=e,i=n.name,o=t.get(i);if(!o)throw new Error(`Missing node for policy ${i}`);if(r.afterPolicies)for(const e of r.afterPolicies){const n=t.get(e);n&&(o.dependsOn.add(n),n.dependants.add(o))}if(r.beforePolicies)for(const e of r.beforePolicies){const n=t.get(e);n&&(n.dependsOn.add(o),o.dependants.add(n))}}function u(n){n.hasRun=!0;for(const r of n.policies)if((!r.afterPhase||r.afterPhase.hasRun&&!r.afterPhase.policies.size)&&0===r.dependsOn.size){e.push(r.policy);for(const e of r.dependants)e.dependsOn.delete(r);t.delete(r.policy.name),n.policies.delete(r)}}function c(){for(const e of l){if(u(e),e.policies.size>0&&e!==i)return void(i.hasRun||u(i));e.hasAfterPolicies&&u(i)}}let g=0;for(;t.size>0;){g++;const t=e.length;if(c(),e.length<=t&&g>1)throw new Error("Cannot satisfy policy dependencies due to requirements cycle.")}return e}}const w="undefined"!=typeof process&&process.env&&process.env.DEBUG||void 0;let E,x=[],A=[];const D=[];w&&F(w);const k=Object.assign((e=>N(e)),{enable:F,enabled:P,disable:function(){const e=E||"";return F(""),e},log:function(...e){if(e.length>0){const t=String(e[0]);t.includes(":error")?console.error(...e):t.includes(":warning")?console.warn(...e):t.includes(":info")?console.info(...e):(t.includes(":verbose"),console.debug(...e))}}});function F(e){E=e,x=[],A=[];const t=/\*/g,n=e.split(",").map((e=>e.trim().replace(t,".*?")));for(const e of n)e.startsWith("-")?A.push(new RegExp(`^${e.substr(1)}$`)):x.push(new RegExp(`^${e}$`));for(const e of D)e.enabled=P(e.namespace)}function P(e){if(e.endsWith("*"))return!0;for(const t of A)if(t.test(e))return!1;for(const t of x)if(t.test(e))return!0;return!1}function N(e){const t=Object.assign((function(...n){t.enabled&&(n.length>0&&(n[0]=`${e} ${n[0]}`),t.log(...n))}),{enabled:P(e),destroy:B,log:k.log,namespace:e,extend:O});return D.push(t),t}function B(){const e=D.indexOf(this);return e>=0&&(D.splice(e,1),!0)}function O(e){const t=N(`${this.namespace}:${e}`);return t.log=this.log,t}const R=k,L=new Set,M="undefined"!=typeof process&&process.env&&process.env.AZURE_LOG_LEVEL||void 0;let q;const W=R("azure");W.log=(...e)=>{R.log(...e)};const U=["verbose","info","warning","error"];M&&(Q(M)?function(e){if(e&&!Q(e))throw new Error(`Unknown log level '${e}'. Acceptable values: ${U.join(",")}`);q=e;const t=[];for(const e of L)G(e)&&t.push(e.namespace);R.enable(t.join(","))}(M):console.error(`AZURE_LOG_LEVEL set to unknown log level '${M}'; logging is not enabled. Acceptable values: ${U.join(", ")}.`));const z={verbose:400,info:300,warning:200,error:100};function j(e){const t=W.extend(e);return H(W,t),{error:V(t,"error"),warning:V(t,"warning"),info:V(t,"info"),verbose:V(t,"verbose")}}function H(e,t){t.log=(...t)=>{e.log(...t)}}function V(e,t){const n=Object.assign(e.extend(t),{level:t});if(H(e,n),G(n)){const e=R.disable();R.enable(e+","+n.namespace)}return L.add(n),n}function G(e){return Boolean(q&&z[e.level]<=z[q])}function Q(e){return U.includes(e)}const K=j("core-rest-pipeline");class $ extends Error{constructor(e){super(e),this.name="AbortError"}}function Z(e){return!("object"!=typeof e||null===e||Array.isArray(e)||e instanceof RegExp||e instanceof Date)}function J(e){if(Z(e)){const t="string"==typeof e.name,n="string"==typeof e.message;return t&&n}return!1}function X(e){if(J(e))return e.message;{let t;try{t="object"==typeof e&&e?JSON.stringify(e):String(e)}catch(e){t="[unable to stringify input]"}return`Unknown error ${t}`}}function Y(e,t){switch(t){case"utf-8":return function(e){return(new TextEncoder).encode(e)}(e);case"base64":return ee(e);case"base64url":return function(e){return ee(e.replace(/-/g,"+").replace(/_/g,"/"))}(e);case"hex":return function(e){const t=new Uint8Array(e.length/2);for(let n=0;n<e.length/2;++n){const r=e[2*n],i=e[2*n+1];if(!te.has(r)||!te.has(i))return t.slice(0,n);t[n]=parseInt(`${r}${i}`,16)}return t}(e)}}function ee(e){return new Uint8Array([...atob(e)].map((e=>e.charCodeAt(0))))}const te=new Set("0123456789abcdefABCDEF");var ne;const re="function"==typeof(null===(ne=null===globalThis||void 0===globalThis?void 0:globalThis.crypto)||void 0===ne?void 0:ne.randomUUID)?globalThis.crypto.randomUUID.bind(globalThis.crypto):function(){let e="";for(let t=0;t<32;t++){const n=Math.floor(16*Math.random());e+=12===t?"4":16===t?3&n|8:n.toString(16),7!==t&&11!==t&&15!==t&&19!==t||(e+="-")}return e};function ie(){return re()}var oe,ae,se,le;"undefined"!=typeof window&&window.document,"object"==typeof self&&"function"==typeof(null===self||void 0===self?void 0:self.importScripts)&&("DedicatedWorkerGlobalScope"===(null===(oe=self.constructor)||void 0===oe?void 0:oe.name)||"ServiceWorkerGlobalScope"===(null===(ae=self.constructor)||void 0===ae?void 0:ae.name)||null===(se=self.constructor)||void 0===se||se.name),"undefined"!=typeof Deno&&void 0!==Deno.version&&Deno.version.deno,"undefined"!=typeof Bun&&Bun.version;const de=void 0!==globalThis.process&&Boolean(globalThis.process.version)&&Boolean(null===(le=globalThis.process.versions)||void 0===le?void 0:le.node),ue=("undefined"!=typeof navigator&&(null===navigator||void 0===navigator||navigator.product),"REDACTED"),ce=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent","WWW-Authenticate"],ge=["api-version"];class he{constructor({additionalAllowedHeaderNames:e=[],additionalAllowedQueryParameters:t=[]}={}){e=ce.concat(e),t=ge.concat(t),this.allowedHeaderNames=new Set(e.map((e=>e.toLowerCase()))),this.allowedQueryParameters=new Set(t.map((e=>e.toLowerCase())))}sanitize(e){const t=new Set;return JSON.stringify(e,((e,n)=>{if(n instanceof Error)return Object.assign(Object.assign({},n),{name:n.name,message:n.message});if("headers"===e)return this.sanitizeHeaders(n);if("url"===e)return this.sanitizeUrl(n);if("query"===e)return this.sanitizeQuery(n);if("body"!==e&&"response"!==e&&"operationSpec"!==e){if(Array.isArray(n)||Z(n)){if(t.has(n))return"[Circular]";t.add(n)}return n}}),2)}sanitizeUrl(e){if("string"!=typeof e||null===e||""===e)return e;const t=new URL(e);if(!t.search)return e;for(const[e]of t.searchParams)this.allowedQueryParameters.has(e.toLowerCase())||t.searchParams.set(e,ue);return t.toString()}sanitizeHeaders(e){const t={};for(const n of Object.keys(e))this.allowedHeaderNames.has(n.toLowerCase())?t[n]=e[n]:t[n]=ue;return t}sanitizeQuery(e){if("object"!=typeof e||null===e)return e;const t={};for(const n of Object.keys(e))this.allowedQueryParameters.has(n.toLowerCase())?t[n]=e[n]:t[n]=ue;return t}}const pe="redirectPolicy",fe=["GET","HEAD"];function ve(e={}){const{maxRetries:t=20}=e;return{name:pe,async sendRequest(e,n){const r=await n(e);return me(n,r,t)}}}async function me(e,t,n,r=0){const{request:i,status:o,headers:a}=t,s=a.get("location");if(s&&(300===o||301===o&&fe.includes(i.method)||302===o&&fe.includes(i.method)||303===o&&"POST"===i.method||307===o)&&r<n){const t=new URL(s,i.url);i.url=t.toString(),303===o&&(i.method="GET",i.headers.delete("Content-Length"),delete i.body),i.headers.delete("Authorization");const a=await e(i);return me(e,a,n,r+1)}return t}const ye="1.16.3",_e=3;async function be(e){const t=new Map;t.set("core-rest-pipeline",ye),await async function(e){const t=globalThis.navigator;let n="unknown";if(null==t?void 0:t.userAgentData){const r=await t.userAgentData.getHighEntropyValues(["architecture","platformVersion"]);n=`${r.architecture}-${r.platform}-${r.platformVersion}`;const i=function(e){const t=["Google Chrome","Microsoft Edge","Opera","Brave","Chromium"];for(const n of t){const t=e.find((e=>e.brand===n));if(t)return t}}(t.userAgentData.brands);i&&e.set(i.brand,i.version)}else if(null==t?void 0:t.platform){n=t.platform;const r=function(e){const t=[{name:"Firefox",regex:/Firefox\/([\d.]+)/},{name:"Safari",regex:/Version\/([\d.]+).*Safari/}];for(const n of t){const t=e.match(n.regex);if(t)return{brand:n.name,version:t[1]}}}(t.userAgent);r&&e.set(r.brand,r.version)}else"string"==typeof globalThis.EdgeRuntime&&e.set("EdgeRuntime",globalThis.EdgeRuntime);e.set("OS",n)}(t);const n=function(e){const t=[];for(const[n,r]of e){const e=r?`${n}/${r}`:n;t.push(e)}return t.join(" ")}(t);return e?`${e} ${n}`:n}const Ce="x-ms-useragent",Se="userAgentPolicy",Te=Symbol("rawContent");function Ie(e){return"function"==typeof e[Te]?e[Te]():e.stream()}function we(e){return Boolean(e&&"function"==typeof e.pipe)}function Ee(e){return Boolean(e&&"function"==typeof e.getReader&&"function"==typeof e.tee)}async function xe(e){if(e instanceof Blob||e instanceof Uint8Array)return e;if(Ee(e))return new Response(e).blob();const t=Ie(e);if(we(t))throw new Error("Encountered unexpected type. In the browser, `concat` supports Web ReadableStream, Blob, Uint8Array, and files created using `createFile` only.");return xe(t)}function Ae(e){let t="";for(const[n,r]of e)t+=`${n}: ${r}\r\n`;return t}function De(e){return e instanceof Uint8Array?e.byteLength:"function"==typeof e.stream?-1===e.size?void 0:e.size:void 0}const ke="multipartPolicy",Fe=70,Pe=new Set("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'()+,-./:=?");function Ne(){return{name:ke,async sendRequest(e,t){var n;if(!e.multipartBody)return t(e);if(e.body)throw new Error("multipartBody and regular body cannot be set at the same time");let r=e.multipartBody.boundary;const i=null!==(n=e.headers.get("Content-Type"))&&void 0!==n?n:"multipart/mixed",o=i.match(/^(multipart\/[^ ;]+)(?:; *boundary=(.+))?$/);if(!o)throw new Error(`Got multipart request body, but content-type header was not multipart: ${i}`);const[,a,s]=o;if(s&&r&&s!==r)throw new Error(`Multipart boundary was specified as ${s} in the header, but got ${r} in the request body`);return null!=r||(r=s),r?function(e){if(e.length>Fe)throw new Error(`Multipart boundary "${e}" exceeds maximum length of 70 characters`);if(Array.from(e).some((e=>!Pe.has(e))))throw new Error(`Multipart boundary "${e}" contains invalid characters`)}(r):r=`----AzSDKFormBoundary${ie()}`,e.headers.set("Content-Type",`${a}; boundary=${r}`),await async function(e,t,n){const r=[Y(`--${n}`,"utf-8"),...t.flatMap((e=>[Y("\r\n","utf-8"),Y(Ae(e.headers),"utf-8"),Y("\r\n","utf-8"),e.body,Y(`\r\n--${n}`,"utf-8")])),Y("--\r\n\r\n","utf-8")],i=function(e){let t=0;for(const n of e){const e=De(n);if(void 0===e)return;t+=e}return t}(r);i&&e.headers.set("Content-Length",i),e.body=await async function(e){const t=[];for(const n of e)t.push(await xe("function"==typeof n?n():n));return new Blob(t)}(r)}(e,e.multipartBody.parts,r),e.multipartBody=void 0,t(e)}}}const Be="The operation was aborted.";function Oe(e,t,n){return new Promise(((r,i)=>{let o,a;const s=()=>i(new $((null==n?void 0:n.abortErrorMsg)?null==n?void 0:n.abortErrorMsg:Be)),l=()=>{(null==n?void 0:n.abortSignal)&&a&&n.abortSignal.removeEventListener("abort",a)};if(a=()=>(o&&clearTimeout(o),l(),s()),(null==n?void 0:n.abortSignal)&&n.abortSignal.aborted)return s();o=setTimeout((()=>{l(),r(t)}),e),(null==n?void 0:n.abortSignal)&&n.abortSignal.addEventListener("abort",a)}))}function Re(e,t){const n=e.headers.get(t);if(!n)return;const r=Number(n);return Number.isNaN(r)?void 0:r}const Le="Retry-After",Me=["retry-after-ms","x-ms-retry-after-ms",Le];function qe(e){if(e&&[429,503].includes(e.status))try{for(const t of Me){const n=Re(e,t);if(0===n||n)return n*(t===Le?1e3:1)}const t=e.headers.get(Le);if(!t)return;const n=Date.parse(t)-Date.now();return Number.isFinite(n)?Math.max(0,n):void 0}catch(e){return}}const We=1e3,Ue=64e3;function ze(e={}){var t,n;const r=null!==(t=e.retryDelayInMs)&&void 0!==t?t:We,i=null!==(n=e.maxRetryDelayInMs)&&void 0!==n?n:Ue;let o=r;return{name:"exponentialRetryStrategy",retry({retryCount:t,response:n,responseError:r}){const a=!!(c=r)&&("ETIMEDOUT"===c.code||"ESOCKETTIMEDOUT"===c.code||"ECONNREFUSED"===c.code||"ECONNRESET"===c.code||"ENOENT"===c.code||"ENOTFOUND"===c.code),s=a&&e.ignoreSystemErrors,l=function(e){return Boolean(e&&void 0!==e.status&&(e.status>=500||408===e.status)&&501!==e.status&&505!==e.status)}(n),d=l&&e.ignoreHttpStatusCodes,u=n&&(function(e){return Number.isFinite(qe(e))}(n)||!l);var c;if(u||d||s)return{skipStrategy:!0};if(r&&!a&&!l)return{errorToThrow:r};const g=o*Math.pow(2,t),h=Math.min(i,g);var p,f;return o=h/2+(p=0,f=h/2,p=Math.ceil(p),f=Math.floor(f),Math.floor(Math.random()*(f-p+1))+p),{retryAfterInMs:o}}}}const je=j("core-rest-pipeline retryPolicy"),He="retryPolicy";function Ve(e,t={maxRetries:_e}){const n=t.logger||je;return{name:He,async sendRequest(r,i){var o,a;let s,l,d=-1;e:for(;;){d+=1,s=void 0,l=void 0;try{n.info(`Retry ${d}: Attempting to send request`,r.requestId),s=await i(r),n.info(`Retry ${d}: Received a response from request`,r.requestId)}catch(e){if(n.error(`Retry ${d}: Received an error from request`,r.requestId),l=e,!e||"RestError"!==l.name)throw e;s=l.response}if(null===(o=r.abortSignal)||void 0===o?void 0:o.aborted)throw n.error(`Retry ${d}: Request aborted.`),new $;if(d>=(null!==(a=t.maxRetries)&&void 0!==a?a:_e)){if(n.info(`Retry ${d}: Maximum retries reached. Returning the last received response, or throwing the last received error.`),l)throw l;if(s)return s;throw new Error("Maximum retries reached with no response or error to throw")}n.info(`Retry ${d}: Processing ${e.length} retry strategies.`);t:for(const t of e){const e=t.logger||je;e.info(`Retry ${d}: Processing retry strategy ${t.name}.`);const n=t.retry({retryCount:d,response:s,responseError:l});if(n.skipStrategy){e.info(`Retry ${d}: Skipped.`);continue t}const{errorToThrow:i,retryAfterInMs:o,redirectTo:a}=n;if(i)throw e.error(`Retry ${d}: Retry strategy ${t.name} throws error:`,i),i;if(o||0===o){e.info(`Retry ${d}: Retry strategy ${t.name} retries after ${o}`),await Oe(o,void 0,{abortSignal:r.abortSignal});continue e}if(a){e.info(`Retry ${d}: Retry strategy ${t.name} redirects to ${a}`),r.url=a;continue e}}if(l)throw n.info("None of the retry strategies could work with the received error. Throwing it."),l;if(s)return n.info("None of the retry strategies could work with the received response. Returning it."),s}}}}function Ge(e){return e.toLowerCase()}class Qe{constructor(e){if(this._headersMap=new Map,e)for(const t of Object.keys(e))this.set(t,e[t])}set(e,t){this._headersMap.set(Ge(e),{name:e,value:String(t).trim()})}get(e){var t;return null===(t=this._headersMap.get(Ge(e)))||void 0===t?void 0:t.value}has(e){return this._headersMap.has(Ge(e))}delete(e){this._headersMap.delete(Ge(e))}toJSON(e={}){const t={};if(e.preserveCase)for(const e of this._headersMap.values())t[e.name]=e.value;else for(const[e,n]of this._headersMap)t[e]=n.value;return t}toString(){return JSON.stringify(this.toJSON({preserveCase:!0}))}[Symbol.iterator](){return function*(e){for(const t of e.values())yield[t.name,t.value]}(this._headersMap)}}function Ke(e){return new Qe(e)}const $e="formDataPolicy";const Ze="setClientRequestIdPolicy",Je={span:Symbol.for("@azure/core-tracing span"),namespace:Symbol.for("@azure/core-tracing namespace")};function Xe(e={}){let t=new Ye(e.parentContext);return e.span&&(t=t.setValue(Je.span,e.span)),e.namespace&&(t=t.setValue(Je.namespace,e.namespace)),t}class Ye{constructor(e){this._contextMap=e instanceof Ye?new Map(e._contextMap):new Map}setValue(e,t){const n=new Ye(this);return n._contextMap.set(e,t),n}getValue(e){return this._contextMap.get(e)}deleteValue(e){const t=new Ye(this);return t._contextMap.delete(e),t}}const et={instrumenterImplementation:void 0};function tt(){return et.instrumenterImplementation||(et.instrumenterImplementation={createRequestHeaders:()=>({}),parseTraceparentHeader:()=>{},startSpan:(e,t)=>({span:{end:()=>{},isRecording:()=>!1,recordException:()=>{},setAttribute:()=>{},setStatus:()=>{}},tracingContext:Xe({parentContext:t.tracingContext})}),withContext:(e,t,...n)=>t(...n)}),et.instrumenterImplementation}const nt={},rt=new he;class it extends Error{constructor(e,t={}){super(e),this.name="RestError",this.code=t.code,this.statusCode=t.statusCode,Object.defineProperty(this,"request",{value:t.request,enumerable:!1}),Object.defineProperty(this,"response",{value:t.response,enumerable:!1}),Object.setPrototypeOf(this,it.prototype)}[nt](){return`RestError: ${this.message} \n ${rt.sanitize(Object.assign(Object.assign({},this),{request:this.request,response:this.response}))}`}}it.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR",it.PARSE_ERROR="PARSE_ERROR";const ot="tracingPolicy";function at(e){var t;const n=I.create();var r;return de&&(e.tlsOptions&&n.addPolicy((r=e.tlsOptions,{name:"tlsPolicy",sendRequest:async(e,t)=>(e.tlsSettings||(e.tlsSettings=r),t(e))})),n.addPolicy(function(){throw new Error("proxyPolicy is not supported in browser environment")}(e.proxyOptions)),n.addPolicy(function(){throw new Error("decompressResponsePolicy is not supported in browser environment")}())),n.addPolicy({name:$e,async sendRequest(e,t){if(de&&"undefined"!=typeof FormData&&e.body instanceof FormData&&(e.formData=function(e){var t;const n={};for(const[r,i]of e.entries())null!==(t=n[r])&&void 0!==t||(n[r]=[]),n[r].push(i);return n}(e.body),e.body=void 0),e.formData){const t=e.headers.get("Content-Type");t&&-1!==t.indexOf("application/x-www-form-urlencoded")?e.body=function(e){const t=new URLSearchParams;for(const[n,r]of Object.entries(e))if(Array.isArray(r))for(const e of r)t.append(n,e.toString());else t.append(n,r.toString());return t.toString()}(e.formData):await async function(e,t){const n=t.headers.get("Content-Type");if(n&&!n.startsWith("multipart/form-data"))return;t.headers.set("Content-Type",null!=n?n:"multipart/form-data");const r=[];for(const[t,n]of Object.entries(e))for(const e of Array.isArray(n)?n:[n])if("string"==typeof e)r.push({headers:Ke({"Content-Disposition":`form-data; name="${t}"`}),body:Y(e,"utf-8")});else{if(null==e||"object"!=typeof e)throw new Error(`Unexpected value for key ${t}: ${e}. Value should be serialized to string first.`);{const n=e.name||"blob",i=Ke();i.set("Content-Disposition",`form-data; name="${t}"; filename="${n}"`),i.set("Content-Type",e.type||"application/octet-stream"),r.push({headers:i,body:e})}}t.multipartBody={parts:r}}(e.formData,e),e.formData=void 0}return t(e)}},{beforePolicies:[ke]}),n.addPolicy(function(e={}){const t=be(e.userAgentPrefix);return{name:Se,sendRequest:async(e,n)=>(e.headers.has(Ce)||e.headers.set(Ce,await t),n(e))}}(e.userAgentOptions)),n.addPolicy(function(e="x-ms-client-request-id"){return{name:Ze,sendRequest:async(t,n)=>(t.headers.has(e)||t.headers.set(e,t.requestId),n(t))}}(null===(t=e.telemetryOptions)||void 0===t?void 0:t.clientRequestIdHeaderName)),n.addPolicy(Ne(),{afterPhase:"Deserialize"}),n.addPolicy(function(e={}){var t;return{name:"defaultRetryPolicy",sendRequest:Ve([{name:"throttlingRetryStrategy",retry({response:e}){const t=qe(e);return Number.isFinite(t)?{retryAfterInMs:t}:{skipStrategy:!0}}},ze(e)],{maxRetries:null!==(t=e.maxRetries)&&void 0!==t?t:_e}).sendRequest}}(e.retryOptions),{phase:"Retry"}),n.addPolicy(function(e={}){const t=be(e.userAgentPrefix),n=new he({additionalAllowedQueryParameters:e.additionalAllowedQueryParameters}),r=function(){try{return function(e){const{namespace:t,packageName:n,packageVersion:r}=e;function i(e,i,o){var a;const s=tt().startSpan(e,Object.assign(Object.assign({},o),{packageName:n,packageVersion:r,tracingContext:null===(a=null==i?void 0:i.tracingOptions)||void 0===a?void 0:a.tracingContext}));let l=s.tracingContext;const d=s.span;return l.getValue(Je.namespace)||(l=l.setValue(Je.namespace,t)),d.setAttribute("az.namespace",l.getValue(Je.namespace)),{span:d,updatedOptions:Object.assign({},i,{tracingOptions:Object.assign(Object.assign({},null==i?void 0:i.tracingOptions),{tracingContext:l})})}}function o(e,t,...n){return tt().withContext(e,t,...n)}return{startSpan:i,withSpan:async function(e,t,n,r){const{span:a,updatedOptions:s}=i(e,t,r);try{const e=await o(s.tracingOptions.tracingContext,(()=>Promise.resolve(n(s,a))));return a.setStatus({status:"success"}),e}catch(e){throw a.setStatus({status:"error",error:e}),e}finally{a.end()}},withContext:o,parseTraceparentHeader:function(e){return tt().parseTraceparentHeader(e)},createRequestHeaders:function(e){return tt().createRequestHeaders(e)}}}({namespace:"",packageName:"@azure/core-rest-pipeline",packageVersion:ye})}catch(e){return void K.warning(`Error when creating the TracingClient: ${X(e)}`)}}();return{name:ot,async sendRequest(e,i){var o,a;if(!r||!(null===(o=e.tracingOptions)||void 0===o?void 0:o.tracingContext))return i(e);const s=await t,l={"http.url":n.sanitizeUrl(e.url),"http.method":e.method,"http.user_agent":s,requestId:e.requestId};s&&(l["http.user_agent"]=s);const{span:d,tracingContext:u}=null!==(a=function(e,t,n){try{const{span:r,updatedOptions:i}=e.startSpan(`HTTP ${t.method}`,{tracingOptions:t.tracingOptions},{spanKind:"client",spanAttributes:n});if(!r.isRecording())return void r.end();const o=e.createRequestHeaders(i.tracingOptions.tracingContext);for(const[e,n]of Object.entries(o))t.headers.set(e,n);return{span:r,tracingContext:i.tracingOptions.tracingContext}}catch(e){return void K.warning(`Skipping creating a tracing span due to an error: ${X(e)}`)}}(r,e,l))&&void 0!==a?a:{};if(!d||!u)return i(e);try{const t=await r.withContext(u,i,e);return function(e,t){try{e.setAttribute("http.status_code",t.status);const n=t.headers.get("x-ms-request-id");n&&e.setAttribute("serviceRequestId",n),e.setStatus({status:"success"}),e.end()}catch(e){K.warning(`Skipping tracing span processing due to an error: ${X(e)}`)}}(d,t),t}catch(e){throw function(e,t){try{e.setStatus({status:"error",error:J(t)?t:void 0}),((n=t)instanceof it||J(n)&&"RestError"===n.name)&&t.statusCode&&e.setAttribute("http.status_code",t.statusCode),e.end()}catch(n){K.warning(`Skipping tracing span processing due to an error: ${X(n)}`)}var n}(d,e),e}}}}(Object.assign(Object.assign({},e.userAgentOptions),e.loggingOptions)),{afterPhase:"Retry"}),de&&n.addPolicy(ve(e.redirectOptions),{afterPhase:"Retry"}),n.addPolicy(function(e={}){var t;const n=null!==(t=e.logger)&&void 0!==t?t:K.info,r=new he({additionalAllowedHeaderNames:e.additionalAllowedHeaderNames,additionalAllowedQueryParameters:e.additionalAllowedQueryParameters});return{name:"logPolicy",async sendRequest(e,t){if(!n.enabled)return t(e);n(`Request: ${r.sanitize(e)}`);const i=await t(e);return n(`Response status code: ${i.status}`),n(`Headers: ${r.sanitize(i.headers)}`),i}}}(e.loggingOptions),{afterPhase:"Sign"}),n}class st{async sendRequest(e){if("https:"!==new URL(e.url).protocol&&!e.allowInsecureConnection)throw new Error(`Cannot connect to ${e.url} while allowInsecureConnection is false.`);if(e.proxySettings)throw new Error("HTTP proxy is not supported in browser environment");try{return await async function(e){const{abortController:t,abortControllerCleanup:n}=function(e){const t=new AbortController;let n,r;if(e.abortSignal){if(e.abortSignal.aborted)throw new $("The operation was aborted.");r=e=>{"abort"===e.type&&t.abort()},e.abortSignal.addEventListener("abort",r),n=()=>{var t;r&&(null===(t=e.abortSignal)||void 0===t||t.removeEventListener("abort",r))}}return e.timeout>0&&setTimeout((()=>{t.abort()}),e.timeout),{abortController:t,abortControllerCleanup:n}}(e);try{const r=function(e){const t=new Headers;for(const[n,r]of e)t.append(n,r);return t}(e.headers),{streaming:i,body:o}=function(e){const t="function"==typeof e.body?e.body():e.body;if(we(t))throw new Error("Node streams are not supported in browser environment.");return Ee(t)?{streaming:!0,body:lt(t,{onProgress:e.onUploadProgress})}:{streaming:!1,body:t}}(e),a=Object.assign(Object.assign({body:o,method:e.method,headers:r,signal:t.signal},"credentials"in Request.prototype?{credentials:e.withCredentials?"include":"same-origin"}:{}),"cache"in Request.prototype?{cache:"no-store"}:{});i&&(a.duplex="half");const s=await fetch(e.url,a);return function(e){return("function"==typeof Blob||"object"==typeof Blob)&&e instanceof Blob}(e.body)&&e.onUploadProgress&&e.onUploadProgress({loadedBytes:e.body.size}),async function(e,t,n){var r,i;const o=function(e){const t=Ke();for(const[n,r]of e.headers)t.set(n,r);return t}(e),a={request:t,headers:o,status:e.status},s=Ee(e.body)?lt(e.body,{onProgress:t.onDownloadProgress,onEnd:n}):e.body;if((null===(r=t.streamResponseStatusCodes)||void 0===r?void 0:r.has(Number.POSITIVE_INFINITY))||(null===(i=t.streamResponseStatusCodes)||void 0===i?void 0:i.has(a.status)))if(t.enableBrowserStreams)a.browserStreamBody=null!=s?s:void 0;else{const e=new Response(s);a.blobBody=e.blob(),null==n||n()}else{const e=new Response(s);a.bodyAsText=await e.text(),null==n||n()}return a}(s,e,n)}catch(e){throw null==n||n(),e}}(e)}catch(t){throw function(e,t){var n;return e&&"AbortError"===(null==e?void 0:e.name)?e:new it(`Error sending request: ${e.message}`,{code:null!==(n=null==e?void 0:e.code)&&void 0!==n?n:it.REQUEST_SEND_ERROR,request:t})}(t,e)}}}function lt(e,t={}){let n=0;const{onProgress:r,onEnd:i}=t;if(function(e){return void 0!==e.pipeThrough&&void 0!==self.TransformStream}(e))return e.pipeThrough(new TransformStream({transform(e,t){null!==e?(t.enqueue(e),n+=e.length,r&&r({loadedBytes:n})):t.terminate()},flush(){null==i||i()}}));{const t=e.getReader();return new ReadableStream({async pull(e){var o;const{done:a,value:s}=await t.read();if(a||!s)return null==i||i(),e.close(),void t.releaseLock();n+=null!==(o=null==s?void 0:s.length)&&void 0!==o?o:0,e.enqueue(s),r&&r({loadedBytes:n})},cancel:e=>(null==i||i(),t.cancel(e))})}}class dt{constructor(e){var t,n,r,i,o,a,s;this.url=e.url,this.body=e.body,this.headers=null!==(t=e.headers)&&void 0!==t?t:Ke(),this.method=null!==(n=e.method)&&void 0!==n?n:"GET",this.timeout=null!==(r=e.timeout)&&void 0!==r?r:0,this.multipartBody=e.multipartBody,this.formData=e.formData,this.disableKeepAlive=null!==(i=e.disableKeepAlive)&&void 0!==i&&i,this.proxySettings=e.proxySettings,this.streamResponseStatusCodes=e.streamResponseStatusCodes,this.withCredentials=null!==(o=e.withCredentials)&&void 0!==o&&o,this.abortSignal=e.abortSignal,this.tracingOptions=e.tracingOptions,this.onUploadProgress=e.onUploadProgress,this.onDownloadProgress=e.onDownloadProgress,this.requestId=e.requestId||ie(),this.allowInsecureConnection=null!==(a=e.allowInsecureConnection)&&void 0!==a&&a,this.enableBrowserStreams=null!==(s=e.enableBrowserStreams)&&void 0!==s&&s}}const ut={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:12e4};const ct="bearerTokenAuthenticationPolicy";async function gt(e){const{scopes:t,getAccessToken:n,request:r}=e,i={abortSignal:r.abortSignal,tracingOptions:r.tracingOptions},o=await n(t,i);o&&e.request.headers.set("Authorization",`Bearer ${o.token}`)}function ht(e){var t;const{credential:n,scopes:r,challengeCallbacks:i}=e,o=e.logger||K,a=Object.assign({authorizeRequest:null!==(t=null==i?void 0:i.authorizeRequest)&&void 0!==t?t:gt,authorizeRequestOnChallenge:null==i?void 0:i.authorizeRequestOnChallenge},i),s=n?function(e,t){let n,r=null,i=null;const o=Object.assign(Object.assign({},ut),t),a={get isRefreshing(){return null!==r},get shouldRefresh(){var e;return!a.isRefreshing&&(null!==(e=null==i?void 0:i.expiresOnTimestamp)&&void 0!==e?e:0)-o.refreshWindowInMs<Date.now()},get mustRefresh(){return null===i||i.expiresOnTimestamp-o.forcedRefreshWindowInMs<Date.now()}};function s(t,s){var l;return a.isRefreshing||(r=async function(e,t,n){async function r(){if(!(Date.now()<n)){const t=await e();if(null===t)throw new Error("Failed to refresh access token.");return t}try{return await e()}catch(e){return null}}let i=await r();for(;null===i;)await Oe(t),i=await r();return i}((()=>e.getToken(t,s)),o.retryIntervalInMs,null!==(l=null==i?void 0:i.expiresOnTimestamp)&&void 0!==l?l:Date.now()).then((e=>(r=null,i=e,n=s.tenantId,i))).catch((e=>{throw r=null,i=null,n=void 0,e}))),r}return async(e,t)=>{const r=Boolean(t.claims),o=n!==t.tenantId;return r&&(i=null),o||r||a.mustRefresh?s(e,t):(a.shouldRefresh&&s(e,t),i)}}(n):()=>Promise.resolve(null);return{name:ct,async sendRequest(e,t){if(!e.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");let n,i;await a.authorizeRequest({scopes:Array.isArray(r)?r:[r],request:e,getAccessToken:s,logger:o});try{n=await t(e)}catch(e){i=e,n=e.response}if(a.authorizeRequestOnChallenge&&401===(null==n?void 0:n.status)&&function(e){const t=e.headers.get("WWW-Authenticate");if(401===e.status&&t)return t}(n)&&await a.authorizeRequestOnChallenge({scopes:Array.isArray(r)?r:[r],request:e,response:n,getAccessToken:s,logger:o}))return t(e);if(i)throw i;return n}}}const pt={operationRequestMap:new WeakMap};function ft(e,t,n){let r=t.parameterPath;const i=t.mapper;let o;if("string"==typeof r&&(r=[r]),Array.isArray(r)){if(r.length>0)if(i.isConstant)o=i.defaultValue;else{let t=vt(e,r);!t.propertyFound&&n&&(t=vt(n,r));let a=!1;t.propertyFound||(a=i.required||"options"===r[0]&&2===r.length),o=a?i.defaultValue:t.propertyValue}}else{i.required&&(o={});for(const t in r){const a=i.type.modelProperties[t],s=ft(e,{parameterPath:r[t],mapper:a},n);void 0!==s&&(o||(o={}),o[t]=s)}}return o}function vt(e,t){const n={propertyFound:!1};let r=0;for(;r<t.length;++r){const n=t[r];if(!e||!(n in e))break;e=e[n]}return r===t.length&&(n.propertyValue=e,n.propertyFound=!0),n}const mt=Symbol.for("@azure/core-client original request");function yt(e){if(function(e){return mt in e}(e))return yt(e[mt]);let t=pt.operationRequestMap.get(e);return t||(t={},pt.operationRequestMap.set(e,t)),t}const _t=["application/json","text/json"],bt=["application/xml","application/atom+xml"];function Ct(e){const{parameterPath:t,mapper:n}=e;let r;return r="string"==typeof t?t:Array.isArray(t)?t.join("."):n.serializedName,r}let St;const Tt={CSV:",",SSV:" ",Multi:"Multi",TSV:"\t",Pipes:"|"};function It(e,t,n,r){const i=function(e,t,n){var r;const i=new Map;if(null===(r=e.urlParameters)||void 0===r?void 0:r.length)for(const r of e.urlParameters){let o=ft(t,r,n);const a=Ct(r);o=e.serializer.serialize(r.mapper,o,a),r.skipEncoding||(o=encodeURIComponent(o)),i.set(`{${r.mapper.serializedName||a}}`,o)}return i}(t,n,r);let o=!1,a=wt(e,i);if(t.path){let e=wt(t.path,i);"/{nextLink}"===t.path&&e.startsWith("/")&&(e=e.substring(1)),e.includes("://")?(a=e,o=!0):a=function(e,t){if(!t)return e;const n=new URL(e);let r=n.pathname;r.endsWith("/")||(r=`${r}/`),t.startsWith("/")&&(t=t.substring(1));const i=t.indexOf("?");if(-1!==i){const e=t.substring(0,i),o=t.substring(i+1);r+=e,o&&(n.search=n.search?`${n.search}&${o}`:o)}else r+=t;return n.pathname=r,n.toString()}(a,e)}const{queryParams:s,sequenceParams:l}=function(e,t,n){var r;const i=new Map,o=new Set;if(null===(r=e.queryParameters)||void 0===r?void 0:r.length)for(const r of e.queryParameters){"Sequence"===r.mapper.type.name&&r.mapper.serializedName&&o.add(r.mapper.serializedName);let a=ft(t,r,n);if(null!=a||r.mapper.required){a=e.serializer.serialize(r.mapper,a,Ct(r));const t=r.collectionFormat?Tt[r.collectionFormat]:"";if(Array.isArray(a)&&(a=a.map((e=>null==e?"":e))),"Multi"===r.collectionFormat&&0===a.length)continue;!Array.isArray(a)||"SSV"!==r.collectionFormat&&"TSV"!==r.collectionFormat||(a=a.join(t)),r.skipEncoding||(a=Array.isArray(a)?a.map((e=>encodeURIComponent(e))):encodeURIComponent(a)),!Array.isArray(a)||"CSV"!==r.collectionFormat&&"Pipes"!==r.collectionFormat||(a=a.join(t)),i.set(r.mapper.serializedName||Ct(r),a)}}return{queryParams:i,sequenceParams:o}}(t,n,r);return a=function(e,t,n,r=!1){if(0===t.size)return e;const i=new URL(e),o=function(e){const t=new Map;if(!e||"?"!==e[0])return t;const n=(e=e.slice(1)).split("&");for(const e of n){const[n,r]=e.split("=",2),i=t.get(n);i?Array.isArray(i)?i.push(r):t.set(n,[i,r]):t.set(n,r)}return t}(i.search);for(const[e,i]of t){const t=o.get(e);if(Array.isArray(t))if(Array.isArray(i)){t.push(...i);const n=new Set(t);o.set(e,Array.from(n))}else t.push(i);else t?(Array.isArray(i)?i.unshift(t):n.has(e)&&o.set(e,[t,i]),r||o.set(e,i)):o.set(e,i)}const a=[];for(const[e,t]of o)if("string"==typeof t)a.push(`${e}=${t}`);else if(Array.isArray(t))for(const n of t)a.push(`${e}=${n}`);else a.push(`${e}=${t}`);return i.search=a.length?`?${a.join("&")}`:"",i.toString()}(a,s,l,o),a}function wt(e,t){let n=e;for(const[e,r]of t)n=n.split(e).join(r);return n}const Et=j("core-client");class xt{constructor(e={}){var t,n;if(this._requestContentType=e.requestContentType,this._endpoint=null!==(t=e.endpoint)&&void 0!==t?t:e.baseUri,e.baseUri&&Et.warning("The baseUri option for SDK Clients has been deprecated, please use endpoint instead."),this._allowInsecureConnection=e.allowInsecureConnection,this._httpClient=e.httpClient||(St||(St=new st),St),this.pipeline=e.pipeline||function(e){const t=function(e){if(e.credentialScopes)return e.credentialScopes;if(e.endpoint)return`${e.endpoint}/.default`;if(e.baseUri)return`${e.baseUri}/.default`;if(e.credential&&!e.credentialScopes)throw new Error("When using credentials, the ServiceClientOptions must contain either a endpoint or a credentialScopes. Unable to create a bearerTokenAuthenticationPolicy")}(e),n=e.credential&&t?{credentialScopes:t,credential:e.credential}:void 0;return function(e={}){const t=at(null!=e?e:{});return e.credentialOptions&&t.addPolicy(ht({credential:e.credentialOptions.credential,scopes:e.credentialOptions.credentialScopes})),t.addPolicy(function(e={}){const t=e.stringifyXML;return{name:"serializationPolicy",async sendRequest(e,n){const r=yt(e),i=null==r?void 0:r.operationSpec,o=null==r?void 0:r.operationArguments;return i&&o&&(function(e,t,n){var r,i;if(n.headerParameters)for(const r of n.headerParameters){let i=ft(t,r);if(null!=i||r.mapper.required){i=n.serializer.serialize(r.mapper,i,Ct(r));const t=r.mapper.headerCollectionPrefix;if(t)for(const n of Object.keys(i))e.headers.set(t+n,i[n]);else e.headers.set(r.mapper.serializedName||Ct(r),i)}}const o=null===(i=null===(r=t.options)||void 0===r?void 0:r.requestOptions)||void 0===i?void 0:i.customHeaders;if(o)for(const t of Object.keys(o))e.headers.set(t,o[t])}(e,o,i),function(e,t,n,r=function(){throw new Error("XML serialization unsupported!")}){var i,o,l,d,u;const c=null===(i=t.options)||void 0===i?void 0:i.serializerOptions,g={xml:{rootName:null!==(o=null==c?void 0:c.xml.rootName)&&void 0!==o?o:"",includeRoot:null!==(l=null==c?void 0:c.xml.includeRoot)&&void 0!==l&&l,xmlCharKey:null!==(d=null==c?void 0:c.xml.xmlCharKey)&&void 0!==d?d:s}},h=g.xml.xmlCharKey;if(n.requestBody&&n.requestBody.mapper){e.body=ft(t,n.requestBody);const i=n.requestBody.mapper,{required:o,serializedName:s,xmlName:l,xmlElementName:d,xmlNamespace:c,xmlNamespacePrefix:p,nullable:f}=i,v=i.type.name;try{if(void 0!==e.body&&null!==e.body||f&&null===e.body||o){const t=Ct(n.requestBody);e.body=n.serializer.serialize(i,e.body,t,g);const o=v===S;if(n.isXML){const t=p?`xmlns:${p}`:"xmlns",n=function(e,t,n,r,i){if(e&&!["Composite","Sequence","Dictionary"].includes(n)){const n={};return n[i.xml.xmlCharKey]=r,n[a]={[t]:e},n}return r}(c,t,v,e.body,g);v===b?e.body=r(function(e,t,n,r){if(Array.isArray(e)||(e=[e]),!n||!r)return{[t]:e};const i={[t]:e};return i[a]={[n]:r},i}(n,d||l||s,t,c),{rootName:l||s,xmlCharKey:h}):o||(e.body=r(n,{rootName:l||s,xmlCharKey:h}))}else{if(v===C&&((null===(u=n.contentType)||void 0===u?void 0:u.match("text/plain"))||"text"===n.mediaType))return;o||(e.body=JSON.stringify(e.body))}}}catch(e){throw new Error(`Error "${e.message}" occurred in serializing the payload - ${JSON.stringify(s,void 0,"  ")}.`)}}else if(n.formDataParameters&&n.formDataParameters.length>0){e.formData={};for(const r of n.formDataParameters){const i=ft(t,r);if(null!=i){const t=r.mapper.serializedName||Ct(r);e.formData[t]=n.serializer.serialize(r.mapper,i,Ct(r),g)}}}}(e,o,i,t)),n(e)}}}(e.serializationOptions),{phase:"Serialize"}),t.addPolicy(function(e={}){var t,n,r,i,o,a,l;const d=null!==(n=null===(t=e.expectedContentTypes)||void 0===t?void 0:t.json)&&void 0!==n?n:_t,u=null!==(i=null===(r=e.expectedContentTypes)||void 0===r?void 0:r.xml)&&void 0!==i?i:bt,c=e.parseXML,g=e.serializerOptions,h={xml:{rootName:null!==(o=null==g?void 0:g.xml.rootName)&&void 0!==o?o:"",includeRoot:null!==(a=null==g?void 0:g.xml.includeRoot)&&void 0!==a&&a,xmlCharKey:null!==(l=null==g?void 0:g.xml.xmlCharKey)&&void 0!==l?l:s}};return{name:"deserializationPolicy",async sendRequest(e,t){const n=await t(e);return async function(e,t,n,r,i){const o=await async function(e,t,n,r,i){var o;if(!(null===(o=n.request.streamResponseStatusCodes)||void 0===o?void 0:o.has(n.status))&&n.bodyAsText){const o=n.bodyAsText,a=n.headers.get("Content-Type")||"",s=a?a.split(";").map((e=>e.toLowerCase())):[];try{if(0===s.length||s.some((t=>-1!==e.indexOf(t))))return n.parsedBody=JSON.parse(o),n;if(s.some((e=>-1!==t.indexOf(e)))){if(!i)throw new Error("Parsing XML not supported.");const e=await i(o,r.xml);return n.parsedBody=e,n}}catch(e){const t=`Error "${e}" occurred while parsing the response body - ${n.bodyAsText}.`,r=e.code||it.PARSE_ERROR;throw new it(t,{code:r,statusCode:n.status,request:n.request,response:n})}}return n}(e,t,n,r,i);if(!function(e){const t=yt(e.request),n=null==t?void 0:t.shouldDeserialize;let r;return r=void 0===n||("boolean"==typeof n?n:n(e)),r}(o))return o;const a=yt(o.request),s=null==a?void 0:a.operationSpec;if(!s||!s.responses)return o;const l=function(e){let t;const n=yt(e.request),r=null==n?void 0:n.operationSpec;return r&&(t=(null==n?void 0:n.operationResponseGetter)?null==n?void 0:n.operationResponseGetter(r,e):r.responses[e.status]),t}(o),{error:d,shouldReturnResponse:u}=function(e,t,n,r){var i;const o=200<=e.status&&e.status<300,a=function(e){const t=Object.keys(e.responses);return 0===t.length||1===t.length&&"default"===t[0]}(t)?o:!!n;if(a){if(!n)return{error:null,shouldReturnResponse:!1};if(!n.isError)return{error:null,shouldReturnResponse:!1}}const s=null!=n?n:t.responses.default,l=(null===(i=e.request.streamResponseStatusCodes)||void 0===i?void 0:i.has(e.status))?`Unexpected status code: ${e.status}`:e.bodyAsText,d=new it(l,{statusCode:e.status,request:e.request,response:e});if(!s)throw d;const u=s.bodyMapper,c=s.headersMapper;try{if(e.parsedBody){const n=e.parsedBody;let i;if(u){let e=n;if(t.isXML&&u.type.name===b){e=[];const t=u.xmlElementName;"object"==typeof n&&t&&(e=n[t])}i=t.serializer.deserialize(u,e,"error.response.parsedBody",r)}const o=n.error||i||n;d.code=o.code,o.message&&(d.message=o.message),u&&(d.response.parsedBody=i)}e.headers&&c&&(d.response.parsedHeaders=t.serializer.deserialize(c,e.headers.toJSON(),"operationRes.parsedHeaders"))}catch(t){d.message=`Error "${t.message}" occurred in deserializing the responseBody - "${e.bodyAsText}" for the default response.`}return{error:d,shouldReturnResponse:!1}}(o,s,l,r);if(d)throw d;if(u)return o;if(l){if(l.bodyMapper){let e=o.parsedBody;s.isXML&&l.bodyMapper.type.name===b&&(e="object"==typeof e?e[l.bodyMapper.xmlElementName]:[]);try{o.parsedBody=s.serializer.deserialize(l.bodyMapper,e,"operationRes.parsedBody",r)}catch(e){throw new it(`Error ${e} occurred in deserializing the responseBody - ${o.bodyAsText}`,{statusCode:o.status,request:o.request,response:o})}}else"HEAD"===s.httpMethod&&(o.parsedBody=n.status>=200&&n.status<300);l.headersMapper&&(o.parsedHeaders=s.serializer.deserialize(l.headersMapper,o.headers.toJSON(),"operationRes.parsedHeaders",{xml:{},ignoreUnknownProperties:!0}))}return o}(d,u,n,h,c)}}}(e.deserializationOptions),{phase:"Deserialize"}),t}(Object.assign(Object.assign({},e),{credentialOptions:n}))}(e),null===(n=e.additionalPolicies)||void 0===n?void 0:n.length)for(const{policy:t,position:n}of e.additionalPolicies){const e="perRetry"===n?"Sign":void 0;this.pipeline.addPolicy(t,{afterPhase:e})}}async sendRequest(e){return this.pipeline.sendRequest(this._httpClient,e)}async sendOperationRequest(e,t){const n=t.baseUrl||this._endpoint;if(!n)throw new Error("If operationSpec.baseUrl is not specified, then the ServiceClient must have a endpoint string property that contains the base URL to use.");const r=function(e){return new dt(e)}({url:It(n,t,e,this)});r.method=t.httpMethod;const i=yt(r);i.operationSpec=t,i.operationArguments=e;const o=t.contentType||this._requestContentType;o&&t.requestBody&&r.headers.set("Content-Type",o);const a=e.options;if(a){const e=a.requestOptions;e&&(e.timeout&&(r.timeout=e.timeout),e.onUploadProgress&&(r.onUploadProgress=e.onUploadProgress),e.onDownloadProgress&&(r.onDownloadProgress=e.onDownloadProgress),void 0!==e.shouldDeserialize&&(i.shouldDeserialize=e.shouldDeserialize),e.allowInsecureConnection&&(r.allowInsecureConnection=!0)),a.abortSignal&&(r.abortSignal=a.abortSignal),a.tracingOptions&&(r.tracingOptions=a.tracingOptions)}this._allowInsecureConnection&&(r.allowInsecureConnection=!0),void 0===r.streamResponseStatusCodes&&(r.streamResponseStatusCodes=function(e){const t=new Set;for(const n in e.responses){const r=e.responses[n];r.bodyMapper&&r.bodyMapper.type.name===S&&t.add(Number(n))}return t}(t));try{const e=await this.sendRequest(r),n=u(e,t.responses[e.status]);return(null==a?void 0:a.onResponse)&&a.onResponse(e,n),n}catch(e){if("object"==typeof e&&(null==e?void 0:e.response)){const n=e.response,r=u(n,t.responses[e.statusCode]||t.responses.default);e.details=r,(null==a?void 0:a.onResponse)&&a.onResponse(n,r,e)}throw e}}}async function At(e){const{scopes:t,response:n}=e,r=e.logger||Et,i=n.headers.get("WWW-Authenticate");if(!i)return r.info("The WWW-Authenticate header was missing. Failed to perform the Continuous Access Evaluation authentication flow."),!1;const o=function(e){return`, ${e.trim()}`.split(", Bearer ").filter((e=>e)).map((e=>`${e.trim()}, `.split('", ').filter((e=>e)).map((e=>(([e,t])=>({[e]:t}))(e.trim().split('="')))).reduce(((e,t)=>Object.assign(Object.assign({},e),t)),{})))}(i)||[],a=o.find((e=>e.claims));if(!a)return r.info('The WWW-Authenticate header was missing the necessary "claims" to perform the Continuous Access Evaluation authentication flow.'),!1;const s=await e.getAccessToken(a.scope?[a.scope]:t,{claims:(l=a.claims,atob(l))});var l;return!!s&&(e.request.headers.set("Authorization",`Bearer ${s.token}`),!0)}const Dt="Composite",kt="String",Ft="Number",Pt="Sequence",Nt={xCorrelationId:{serializedName:"x-correlationid",type:{name:"Uuid"}}};function Bt(e){const t={};for(const o of e)t[(i=o[0],i.charAt(0).toLowerCase()+i.slice(1))]=(n=o[0],r=o[1],{serializedName:n,required:o[2],defaultValue:o[3],type:{name:r}});var n,r,i;return t}function Ot(e,t){return{type:{name:Dt,className:e,modelProperties:t}}}const Rt=Ot("CommonAppIdProperty",Bt([["AppId",kt]])),Lt=Ot("CommonResponseStatusProperty",Bt([["ResponseStatus",Ft,!1,0]])),Mt=Ot("CommonRequestIdProperty",Bt([["RequestId",kt]])),qt=Ot("TileContent",Object.assign(Object.assign({},Bt([["TileId",kt,!0],["RevisionId",kt,!0]])),{analyzerData:{serializedName:"AnalyzerData",type:{name:"Dictionary",value:{type:{name:"any"}}}},tileElements:{serializedName:"TileElements",type:{name:Pt,element:{type:{name:Dt,className:"TileElement"}}}}})),Wt=Ot("CommonLanguageIdProperty",Bt([["LanguageId",kt]])),Ut=Ot("CommonTextUnitProperty",Bt([["TextUnit",Ft]])),zt=Ot("TopologyNode",Object.assign(Object.assign({},Bt([["Id",kt,!0],["RevisionId",kt,!0],["Type",Ft,!0],["NumberOfChildren",Ft],["AreChildsOrdered","Boolean",void 0,!1]])),{analyzerData:{serializedName:"AnalyzerData",type:{name:"Dictionary",value:{type:{name:"any"}}}},children:{serializedName:"Children",type:{name:Pt,element:{type:{name:Dt,className:"TopologyNode"}}}}})),jt=Ot("CommonDescriptorsProperty",{descriptors:{serializedName:"Descriptors",type:{name:Pt,element:{type:{name:Dt,className:"Descriptor"}}}}}),Ht=Ot("Descriptor",Bt([["Name",kt,!0],["Value",kt,!0]])),Vt=Ot("CommonLanguageUXIdProperty",Bt([["LanguageUXId",kt]])),Gt=Ot("CommonRunOnProfileIdProperty",Bt([["RunOnProfileId","Uuid"]])),Qt=Ot("CommonOverriddenCritiqueTypeOptions",{overriddenCritiqueTypeOptions:{serializedName:"OverriddenCritiqueTypeOptions",type:{name:Pt,element:{type:{name:Dt,className:"CritiqueTypeOption"}}}}}),Kt=Ot("Suggestion",Bt([["Text",kt,!0],["Description",kt],["ConfidenceLevel",Ft],["Source",Ft],["Action",Ft,!0],["BucketId",Ft],["NumberOfInstances",Ft]])),$t=Ot("CommonCritique",Object.assign(Object.assign({},Bt([["TraceId","Uuid"],["TypeId","Uuid"],["CategoryTitle",kt],["Context",kt],["Start",Ft,void 0,0],["StartInContext",Ft,void 0,0],["Length",Ft,void 0,0],["LanguageId",kt],["Priority",Ft]])),{metadata:{serializedName:"Metadata",type:{name:Pt,element:{type:{name:Dt,className:"Metadatum"}}}}})),Zt=Ot("Metadatum",Bt([["Name",kt,!0],["Value",kt,!0]])),Jt=Ot("CommonTileIdProperty",Bt([["TileId",kt]])),Xt=Ot("CommonRevisionIdProperty",Bt([["RevisionId",kt]])),Yt=Ot("SupportedActions",Bt([["SupportedActions",Ft]])),en=Ot("CommonAppVersionProperty",Bt([["AppVersion",kt]])),tn=Ot("CritiqueCategoryInfo",Object.assign(Object.assign({},Bt([["Id","Uuid",!0],["Name",kt,!0],["Priority",Ft]])),{critiqueTypeInfoList:{serializedName:"CritiqueTypeInfoList",type:{name:Pt,element:{type:{name:Dt,className:"CritiqueTypeInfo"}}}}})),nn=Ot("CritiqueTypeInfo",Object.assign(Object.assign({},Bt([["Id","Uuid",!0],["Name",kt,!0],["IsBinaryCritiqueType","Boolean"],["DefaultCritiqueValue",Ft,!0],["CritiquePriority",Ft],["CritiqueTag",kt]])),{critiqueTypeValues:{serializedName:"CritiqueTypeValues",type:{name:Pt,element:{type:{name:kt}}}}})),rn=Ot("UserIdentity",Bt([["IdentityProvider",Ft,!0],["Puid",kt,!0],["TenantId",kt],["Cid",kt]])),on=Ot("BrowserExtensionRequestV1",Object.assign(Object.assign({},Rt.type.modelProperties),Bt([["Browser",kt],["BrowserVersion",kt],["ClientId",kt],["Email",kt],["ExtensionId",kt],["FirstInstallVersion",kt],["LanguageId",kt],["LanguageUxId",kt],["LicenseType",kt],["StoreId",kt],["TenantId",kt]]))),an=Ot("TileCheckRequestV1",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Rt.type.modelProperties),jt.type.modelProperties),Vt.type.modelProperties),Gt.type.modelProperties),Qt.type.modelProperties),Bt([["SessionId",kt,!0],["RequestOrderInSession",Ft]])),{content:{serializedName:"Content",type:{name:Pt,element:{type:{name:Dt,className:"TileContent"}}}},topology:{serializedName:"Topology",type:{name:Dt,className:"TopologyNode"}}})),sn=Ot("ConfigRequestV2",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Rt.type.modelProperties),en.type.modelProperties),jt.type.modelProperties),Wt.type.modelProperties),Vt.type.modelProperties),Gt.type.modelProperties)),ln=Ot("LanguageInfoRequestV1",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Rt.type.modelProperties),jt.type.modelProperties),Wt.type.modelProperties),Vt.type.modelProperties),Gt.type.modelProperties)),dn=Ot("InstrumentationRequestV1",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Rt.type.modelProperties),Wt.type.modelProperties),jt.type.modelProperties),Bt([["TraceId","Uuid",!0],["CritiqueGenerationTime",Ft],["CritiquePriority",Ft,!0],["CritiqueTypeId","Uuid",!0],["EventId",Ft,!0],["OriginalText",kt],["PreContextBegin",Ft],["PostContextEnd",Ft],["SubstrateEventName",kt]])),{flaggedText:{constraints:{MaxLength:2e4,MinLength:1},serializedName:"FlaggedText",required:!0,type:{name:kt}},metadata:{serializedName:"Metadata",type:{name:Pt,element:{type:{name:Dt,className:"Metadatum"}}}},substrateEventCustomFields:{serializedName:"SubstrateEventCustomFields",type:{name:"Dictionary",value:{type:{name:"any"}}}},suggestions:{serializedName:"Suggestions",type:{name:Pt,element:{type:{name:kt}}}},suggestionText:{constraints:{MaxLength:2e4},serializedName:"SuggestionText",type:{name:kt}}})),un=Ot("BrowserExtensionResponseV1",Object.assign(Object.assign(Object.assign(Object.assign({},Lt.type.modelProperties),Mt.type.modelProperties),Bt([["UseTileCheck","Boolean",void 0,!1],["Descriptors",kt],["StyleObserverIntervalTime",Ft,void 0,0],["StyleSampleTime",Ft,void 0,0],["RootContentMaxLengthInChars",Ft,void 0,2e3],["SchedulerDefaultWaitingTime",Ft,void 0,0],["SchedulerDefaultWaitingTimeIncrement",Ft,void 0,0],["SchedulerDefaultMaxTime",Ft,void 0,0],["RefreshCritiqueWaitingTime",Ft,void 0,0],["RequestCritiqueDelay",Ft,void 0,0],["EnableDirtyRangeAutoRehydration","Boolean",void 0,!1],["TelemetryTenant",kt],["LogGroupName",kt],["SendToAria","Boolean",void 0,!1],["IntervalForActivityCleanup",Ft,void 0,0],["MaxAllowedTimeForActivities",Ft,void 0,0],["CalloutHoverTimeout",Ft,void 0,0],["MaxSuggestionItemsDisplayNumber",Ft,void 0,0],["EditorClientState",Ft],["ConfigurationId",kt]])),{disabledWebSites:{serializedName:"DisabledWebSites",type:{name:Pt,element:{type:{name:kt}}}},allowedUrls:{serializedName:"AllowedUrls",type:{name:Pt,element:{type:{name:kt}}}},disabledGrammars:{serializedName:"DisabledGrammars",type:{name:Pt,element:{type:{name:kt}}}},versionEmergencyOverrides:{serializedName:"VersionEmergencyOverrides",type:{name:"Dictionary",value:{type:{name:kt}}}},featureFlags:{serializedName:"FeatureFlags",type:{name:"Dictionary",value:{type:{name:kt}}}},dynamicSettings:{serializedName:"DynamicSettings",type:{name:"Dictionary",value:{type:{name:"any"}}}},spellCheckAttributes:{serializedName:"SpellCheckAttributes",type:{name:Pt,element:{type:{name:kt}}}},conflictingElements:{serializedName:"ConflictingElements",type:{name:Pt,element:{type:{name:kt}}}},editorCanvas:{serializedName:"EditorCanvas",type:{name:"Dictionary",value:{type:{name:"any"}}}}})),cn=Ot("TileCheckResponseV1",Object.assign(Object.assign({},Lt.type.modelProperties),{critiques:{serializedName:"Critiques",type:{name:Pt,element:{type:{name:Dt,className:"TileCheckCritique"}}}}})),gn=Ot("ConfigResponseV2",Object.assign(Object.assign({},Lt.type.modelProperties),{critiqueCategoryInfoList:{serializedName:"CritiqueCategoryInfoList",required:!0,type:{name:Pt,element:{type:{name:Dt,className:"CritiqueCategoryInfo"}}}}})),hn=Ot("LanguageInfoResponseV1",Object.assign(Object.assign({},Lt.type.modelProperties),{supportedLanguages:{serializedName:"SupportedLanguages",required:!0,type:{name:Pt,element:{type:{name:Dt,className:"SupportedLanguage"}}}}})),pn=Ot("TileCheckSpan",Object.assign(Object.assign(Object.assign({},Wt.type.modelProperties),Bt([["Start",Ft,void 0,0],["Length",Ft,void 0,"tileElement.Text.Length - span.Start"],["DoNotCheck","Boolean"]])),{analyzerData:{serializedName:"AnalyzerData",type:{name:"Dictionary",value:{type:{name:"any"}}}}})),fn=Ot("TileElement",Object.assign(Object.assign(Object.assign(Object.assign({},Wt.type.modelProperties),Ut.type.modelProperties),Bt([["Text",kt,!0],["IsClean","Boolean"]])),{enabledLanguages:{serializedName:"EnabledLanguages",type:{name:Pt,element:{type:{name:Pt,element:{type:{name:Dt,className:"CommonLanguageIdProperty"}}}}}},analyzerData:{serializedName:"AnalyzerData",type:{name:"Dictionary",value:{type:{name:"any"}}}},spans:{serializedName:"Spans",type:{name:Pt,element:{type:{name:Dt,className:"TileCheckSpan"}}}}})),vn=Ot("CritiqueTypeOption",Object.assign(Object.assign({},Wt.type.modelProperties),Bt([["Id","Uuid",!0],["Name",kt],["TypeName",kt],["Value",kt,!0]]))),mn=Ot("SupportedLanguage",Object.assign(Object.assign(Object.assign({},Wt.type.modelProperties),Ut.type.modelProperties),Bt([["SupportedCritiqueTag",kt]]))),yn=Ot("TileCheckCritique",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},$t.type.modelProperties),Jt.type.modelProperties),Xt.type.modelProperties),Yt.type.modelProperties),Bt([["BucketId",Ft],["ExplanationTitle",kt],["ExplanationLabel",kt],["Explanation",kt],["Status",Ft],["Tag",Ft]])),{suggestions:{serializedName:"Suggestions",type:{name:Pt,element:{type:{name:Dt,className:"Suggestion"}}}}})),_n=Ot("EditorServicePostTileCheckHeaders",Nt),bn=Ot("EditorServiceConfigV2Headers",Nt),Cn=Ot("EditorServiceLanguageinfoHeaders",Nt),Sn=Ot("EditorServiceInstrumentationHeaders",Nt),Tn={parameterPath:["options","contentType"],mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Content-Type",type:{name:"String"}}},In={parameterPath:"body",mapper:on},wn={parameterPath:"$host",mapper:{serializedName:"$host",required:!0,type:{name:"String"}},skipEncoding:!0},En={parameterPath:"xCorrelationId",mapper:{serializedName:"X-CorrelationId",type:{name:"Uuid"}}},xn={parameterPath:"xUserSessionId",mapper:{serializedName:"X-UserSessionId",type:{name:"Uuid"}}},An={parameterPath:"body",mapper:dn};class Dn extends xt{constructor(e){var t,n;e||(e={});const r="@editor/client-rest-api/2.0.0",i=e.userAgentOptions&&e.userAgentOptions.userAgentPrefix?`${e.userAgentOptions.userAgentPrefix} ${r}`:`${r}`,o=Object.assign(Object.assign(Object.assign({},{requestContentType:"application/json; charset=utf-8"}),e),{userAgentOptions:{userAgentPrefix:i},baseUri:null!==(n=null!==(t=e.endpoint)&&void 0!==t?t:e.baseUri)&&void 0!==n?n:"https://nleditor.osi.officeppe.net/NLEditor"});super(o);let a=!1;(null==e?void 0:e.pipeline)&&e.pipeline.getOrderedPolicies().length>0&&(a=e.pipeline.getOrderedPolicies().some((e=>e.name===ct))),e&&e.pipeline&&0!=e.pipeline.getOrderedPolicies().length&&a||(this.pipeline.removePolicy({name:ct}),this.pipeline.addPolicy(ht({credential:null==e?void 0:e.credential,scopes:`${o.credentialScopes}`,challengeCallbacks:{authorizeRequestOnChallenge:At}}))),this.pipeline.removePolicy({name:Ze}),this.pipeline.removePolicy({name:Se}),this.$host=e.$host||"https://nleditor.osi.officeppe.net/NLEditor"}}class kn extends Dn{browserextension(e,t){return this.sendOperationRequest({body:e,options:t},Nn)}}class Fn extends Dn{instrumentation(e,t){return this.sendOperationRequest({body:e,options:t},Bn)}}const Pn=function(e={},t=!1){return new c(e,t)}(r,!1),Nn={path:"/api/V1/BrowserExtension",httpMethod:"POST",responses:{200:{bodyMapper:un},400:{},500:{}},requestBody:In,urlParameters:[wn],headerParameters:[Tn,{parameterPath:"accept",mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Accept",type:{name:"String"}}},En,xn,{parameterPath:"xUserId",mapper:{serializedName:"X-UserId",type:{name:"String"}}}],mediaType:"json",serializer:Pn},Bn={path:"/api/V1/Instrumentation",httpMethod:"POST",responses:{200:{headersMapper:Sn},400:{},500:{}},requestBody:An,urlParameters:[wn],headerParameters:[Tn,En,xn,{parameterPath:"xUserComposeSessionId",mapper:{serializedName:"X-UserComposeSessionId",type:{name:"Uuid"}}},{parameterPath:"authorization",mapper:{serializedName:"Authorization",type:{name:"String"}}},{parameterPath:"serverToServerId",mapper:{serializedName:"ServerToServerId",type:{name:"String"}}}],mediaType:"json",serializer:Pn}},89928:(e,t,n)=>{"use strict";n.d(t,{Y:()=>r});const r={aa:["aa-ET","Qafar"],af:"af-ZA",agq:["agq-CM","Aghem"],ak:["ak-GH","Akan"],am:"am-ET",ar:"ar-SA",arn:"arn-CL",as:"as-IN",asa:["asa-TZ","Kipare"],ast:["ast-ES","asturianu"],az:["az-Latn-AZ","azərbaycan"],"az-cyrl":["az-Cyrl-AZ","Азәрбајҹан дили (Кирил)"],"az-latn":["az-Latn-AZ","Azərbaycan­ılı (Latın)"],ba:"ba-RU",bas:["bas-CM","Ɓàsàa"],be:"be-BY",bem:["bem-ZM","Ichibemba"],bez:["bez-TZ","Hibena"],bg:"bg-BG",bin:"bin-NG",bm:["bm-Latn-ML","bamanakan"],"bm-latn":["bm-Latn-ML","bamanakan (Latin)"],bn:"bn-BD",bo:"bo-CN",br:"br-FR",brx:["brx-IN","बड़ो"],bs:["bs-Latn-BA","bosanski"],"bs-cyrl":["bs-Cyrl-BA","босански (Ћирилица)"],"bs-latn":["bs-Latn-BA","bosanski (Latinica)"],byn:["byn-ER","ብሊን"],ca:"ca-ES",ccp:["ccp-Cakm-BD","𑄌𑄋𑄴𑄟𑄳𑄦"],"ccp-cakm":["ccp-Cakm-BD","𑄌𑄋𑄴𑄟𑄳𑄦 (𑄌𑄇𑄴𑄟)"],ce:["ce-RU","нохчийн"],ceb:["ceb-Latn-PH","Cebuano"],"ceb-latn":["ceb-Latn-PH","Cebuano (Latin)"],cgg:["cgg-UG","Rukiga"],chr:"chr-Cher-US","chr-cher":"chr-Cher-US",co:"co-FR",cs:"cs-CZ",cu:["cu-RU","церковнослове́нскїй"],cy:"cy-GB",da:"da-DK",dav:["dav-KE","Kitaita"],de:"de-DE",dje:["dje-NE","Zarmaciine"],dsb:"dsb-DE",dua:["dua-CM","duálá"],dv:"dv-MV",dyo:["dyo-SN","joola"],dz:["dz-BT","རྫོང་ཁ"],ebu:["ebu-KE","Kĩembu"],ee:["ee-GH","Eʋegbe"],el:"el-GR",en:"en-US",eo:["eo-001","esperanto"],es:"es-ES",et:"et-EE",eu:"eu-ES",ewo:["ewo-CM","ewondo"],fa:"fa-IR",ff:"ff-Latn-SN","ff-latn":"ff-Latn-SN",fi:"fi-FI",fil:"fil-PH",fo:"fo-FO",fr:"fr-FR",fur:["fur-IT","furlan"],fy:"fy-NL",ga:"ga-IE",gd:"gd-GB",gl:"gl-ES",gn:"gn-PY",gsw:"gsw-CH",gu:"gu-IN",guz:["guz-KE","Ekegusii"],gv:["gv-IM","Gaelg"],ha:["ha-Latn-NG","Hausa"],"ha-latn":["ha-Latn-NG","Hausa (Latin)"],haw:"haw-US",he:"he-IL",hi:"hi-IN",hr:"hr-HR",hsb:"hsb-DE",hu:"hu-HU",hy:"hy-AM",ia:["ia-001","interlingua"],ibb:"ibb-NG",id:"id-ID",ig:"ig-NG",ii:"ii-CN",is:"is-IS",it:"it-IT",iu:["iu-Latn-CA","Inuktitut"],"iu-cans":["iu-Cans-CA","ᐃᓄᒃᑎᑐᑦ (ᖃᓂᐅᔮᖅᐸᐃᑦ)"],"iu-latn":["iu-Latn-CA","Inuktitut (Qaliujaaqpait)"],ja:"ja-JP",jgo:["jgo-CM","Ndaꞌa"],jmc:["jmc-TZ","Kimachame"],jv:"jv-Latn-ID","jv-java":"jv-Java-ID","jv-latn":"jv-Latn-ID",ka:"ka-GE",kab:["kab-DZ","Taqbaylit"],kam:["kam-KE","Kikamba"],kde:["kde-TZ","Chimakonde"],kea:["kea-CV","kabuverdianu"],khq:["khq-ML","Koyra ciini"],ki:["ki-KE","Gikuyu"],kk:"kk-KZ",kkj:["kkj-CM","kakɔ"],kl:"kl-GL",kln:["kln-KE","Kalenjin"],km:"km-KH",kn:"kn-IN",ko:"ko-KR",kok:"kok-IN",kr:"kr-Latn-NG","kr-latn":"kr-Latn-NG",ks:["ks-Arab-IN","کٲشُر"],"ks-arab":["ks-Arab-IN","کٲشُر (اَربی)"],"ks-deva":"ks-Deva-IN",ksb:["ksb-TZ","Kishambaa"],ksf:["ksf-CM","rikpa"],ksh:["ksh-DE","Kölsch"],ku:"ku-Arab-IQ","ku-arab":"ku-Arab-IQ",kw:["kw-GB","kernewek"],ky:"ky-KG",la:"la-001",lag:["lag-TZ","Kɨlaangi"],lb:"lb-LU",lg:["lg-UG","Luganda"],lkt:["lkt-US","Lakȟólʼiyapi"],ln:["ln-CD","lingála"],lo:"lo-LA",lrc:["lrc-IR","لۊری شومالی"],lt:"lt-LT",lu:["lu-CD","Tshiluba"],luo:["luo-KE","Dholuo"],luy:["luy-KE","Luluhia"],lv:"lv-LV",mas:["mas-KE","Maa"],mer:["mer-KE","Kĩmĩrũ"],mfe:["mfe-MU","kreol morisien"],mg:["mg-MG","Malagasy"],mgh:["mgh-MZ","Makua"],mgo:["mgo-CM","metaʼ"],mi:"mi-NZ",mk:"mk-MK",ml:["ml-IN","മലയാളം"],mn:["mn-MN","Монгол хэл"],"mn-cyrl":["mn-MN","Монгол хэл (Кирилл үсэг)"],"mn-mong":["mn-Mong-CN","ᠮᠣᠩᠭᠣᠤᠯ ᠬᠡᠯᠡ (ᠮᠣᠩᠭᠣᠤᠯ ᠬᠡᠯᠡ)"],mni:"mni-IN",moh:"moh-CA",mr:"mr-IN",ms:"ms-MY",mt:"mt-MT",mua:["mua-CM","MUNDAŊ"],my:["my-MM","ဗမာ"],mzn:["mzn-IR","مازرونی"],naq:["naq-NA","Khoekhoegowab"],nb:"nb-NO",nd:["nd-ZW","isiNdebele"],nds:["nds-DE","Neddersass’sch"],ne:"ne-NP",nl:"nl-NL",nmg:["nmg-CM","Kwasio"],nn:"nn-NO",nnh:["nnh-CM","Shwóŋò ngiembɔɔn"],no:["nb-NO","norsk"],nqo:"nqo-GN",nr:["nr-ZA","isiNdebele"],nso:"nso-ZA",nus:["nus-SS","Thok Nath"],nyn:["nyn-UG","Runyankore"],oc:"oc-FR",om:["om-ET","Oromoo"],or:"or-IN",os:["os-GE","ирон"],pa:"pa-IN","pa-arab":"pa-Arab-PK","pa-guru":"pa-IN",pap:"pap-029",pl:"pl-PL",prg:["prg-001","prūsiskan"],prs:"prs-AF",ps:"ps-AF",pt:"pt-BR",quc:"quc-Latn-GT","quc-latn":"quc-Latn-GT",quz:"quz-BO",rm:"rm-CH",rn:["rn-BI","Ikirundi"],ro:"ro-RO",rof:["rof-TZ","Kihorombo"],ru:"ru-RU",rw:"rw-RW",rwk:["rwk-TZ","Kiruwa"],sa:"sa-IN",sah:"sah-RU",saq:["saq-KE","Kisampur"],sbp:["sbp-TZ","Ishisangu"],sd:"sd-Arab-PK","sd-arab":"sd-Arab-PK","sd-deva":"sd-Deva-IN",se:"se-NO",seh:["seh-MZ","sena"],ses:["ses-ML","Koyraboro senni"],sg:["sg-CF","Sängö"],shi:["shi-Tfng-MA","ⵜⴰⵛⵍⵃⵉⵜ"],"shi-latn":["shi-Latn-MA","Tashelḥiyt (Latin)"],"shi-tfng":["shi-Tfng-MA","ⵜⴰⵛⵍⵃⵉⵜ (Tifinagh)"],si:"si-LK",sk:"sk-SK",sl:"sl-SI",sma:"sma-SE",smj:"smj-SE",smn:"smn-FI",sms:"sms-FI",sn:["sn-Latn-ZW","chiShona"],"sn-latn":["sn-Latn-ZW","chiShona (Latin)"],so:["so-SO","Soomaali"],sq:"sq-AL",sr:["sr-Latn-RS","srpski"],"sr-cyrl":["sr-Cyrl-RS","српски (Ћирилица)"],"sr-latn":["sr-Latn-RS","srpski (latinica)"],ss:["ss-ZA","Siswati"],ssy:["ssy-ER","Saho"],st:"st-ZA",sv:"sv-SE",sw:"sw-KE",syr:"syr-SY",ta:"ta-IN",te:"te-IN",teo:["teo-UG","Kiteso"],tg:["tg-Cyrl-TJ","Тоҷикӣ"],"tg-cyrl":["tg-Cyrl-TJ","Тоҷикӣ (Кирилликӣ)"],th:"th-TH",ti:"ti-ER",tig:["tig-ER","ትግረ"],tk:"tk-TM",tn:"tn-ZA",to:["to-TO","lea fakatonga"],tr:"tr-TR",ts:["ts-ZA","Xitsonga"],tt:"tt-RU",twq:["twq-NE","Tasawaq senni"],tzm:["tzm-Latn-DZ","Tamaziɣt n laṭlaṣ"],"tzm-arab":"tzm-Arab-MA","tzm-latn":["tzm-Latn-DZ","Tamaziɣt n laṭlaṣ (Latin)"],"tzm-tfng":["tzm-Tfng-MA","Tamazight (Tifinagh)"],ug:"ug-CN",uk:"uk-UA",ur:"ur-PK",uz:"uz-Latn-UZ","uz-arab":["uz-Arab-AF","اوزبیک (عربی)"],"uz-cyrl":["uz-Cyrl-UZ","Ўзбек (Кирил)"],"uz-latn":"uz-Latn-UZ",vai:["vai-Vaii-LR","ꕙꔤ"],"vai-latn":["vai-Latn-LR","Vai (Latin)"],"vai-vaii":["vai-Vaii-LR","ꕙꔤ (Vai)"],ve:["ve-ZA","Tshivenḓa"],vi:"vi-VN",vo:["vo-001","Volapük"],vun:["vun-TZ","Kyivunjo"],wae:["wae-CH","Walser"],wal:["wal-ET","ወላይታቱ"],wo:"wo-SN",xh:"xh-ZA",xog:["xog-UG","Olusoga"],yav:["yav-CM","nuasue"],yi:["yi-001","ייִדיש"],yo:"yo-NG",zgh:["zgh-Tfng-MA","ⵜⴰⵎⴰⵣⵉⵖⵜ"],"zgh-tfng":["zgh-Tfng-MA","ⵜⴰⵎⴰⵣⵉⵖⵜ (Tifinagh)"],zh:["zh-CN","中文"],"zh-hans":"zh-CN","zh-hant":["zh-HK","中文(繁體)"],zu:"zu-ZA"}},95988:(e,t,n)=>{"use strict";var r,i,o,a,s,l,d,u,c,g,h;n.d(t,{ED:()=>r,fT:()=>i,xp:()=>g}),function(e){e[e.Success=0]="Success",e[e.PartialSuccess=1]="PartialSuccess",e[e.Error=2]="Error",e[e.Disabled=3]="Disabled"}(r||(r={})),function(e){e[e.Default=0]="Default",e[e.Word=1]="Word",e[e.Phrase=2]="Phrase",e[e.Sentence=4]="Sentence",e[e.Paragraph=8]="Paragraph",e[e.Page=16]="Page",e[e.Section=32]="Section",e[e.Chapter=64]="Chapter",e[e.Document=256]="Document",e[e.RawChars=16384]="RawChars"}(i||(i={})),function(e){e[e.Unknown=0]="Unknown",e[e.Paragraph=1]="Paragraph",e[e.Group=2]="Group",e[e.Page=3]="Page",e[e.Document=4]="Document"}(o||(o={})),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low"}(a||(a={})),function(e){e[e.None=0]="None",e[e.OfficeOrthospeller=1]="OfficeOrthospeller",e[e.BingOneSpeller=2]="BingOneSpeller",e[e.ContextSpeller=3]="ContextSpeller",e[e.Grammar=4]="Grammar"}(s||(s={})),function(e){e[e.None=0]="None",e[e.Active=1]="Active",e[e.Provisional=2]="Provisional"}(l||(l={})),function(e){e[e.None=0]="None",e[e.Consistency=1]="Consistency"}(d||(d={})),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low",e[e.Informational=3]="Informational"}(u||(u={})),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low",e[e.Informational=3]="Informational"}(c||(c={})),function(e){e[e.Ignore=0]="Ignore",e[e.IgnoreAll=1]="IgnoreAll",e[e.AddToDictionary=2]="AddToDictionary",e[e.Delete=3]="Delete",e[e.ChangeSugg0=4]="ChangeSugg0",e[e.ChangeSugg1=5]="ChangeSugg1",e[e.ChangeSugg2=6]="ChangeSugg2",e[e.ChangeSuggOther=7]="ChangeSuggOther",e[e.ChangeAllSugg0=8]="ChangeAllSugg0",e[e.ChangeAllSugg1=9]="ChangeAllSugg1",e[e.ChangeAllSugg2=10]="ChangeAllSugg2",e[e.ChangeAllSuggOther=11]="ChangeAllSuggOther",e[e.ClickNoAction=12]="ClickNoAction",e[e.DoNotCheckThisIssue=13]="DoNotCheckThisIssue",e[e.ManualEdit=14]="ManualEdit",e[e.Autoreplace=15]="Autoreplace",e[e.AutoreplaceUndo=16]="AutoreplaceUndo",e[e.IgnoreUndo=17]="IgnoreUndo",e[e.IgnoreAllUndo=18]="IgnoreAllUndo",e[e.ChangeSugg0Undo=19]="ChangeSugg0Undo",e[e.ChangeSugg1Undo=20]="ChangeSugg1Undo",e[e.ChangeSugg2Undo=21]="ChangeSugg2Undo"}(g||(g={})),function(e){e[e.Zero=0]="Zero",e[e.One=1]="One"}(h||(h={}))},74581:(e,t,n)=>{"use strict";n.d(t,{I:()=>Be});var r=n(30206),i=n(2070),o=n(40245),a=n(94563),s=n(79421),l=n(60685),d=n(52996),u=n(68081),c=n(88670),g=n(61358),h=n(48828),p=n(90424),f=n(30225);let v=class{constructor(e,t,n,r,i,o,a){this._guidGenerator=e,this._registrar=t,this._proofingPersistedStore=n,this._sessionContextProvider=r,this._logger=i,this._featureFlagsReader=o,this._hostSettings=a}async initializeComponent(){let e;await this._featureFlagsReader.refreshFlags();try{this._sessionContextProvider&&(e=await this._sessionContextProvider())}catch(e){}await this._logger.initialize(this._proofingPersistedStore,this._featureFlagsReader,e,void 0,this._hostSettings),this._logger.debug(520984581,"Logger initialized"),g.R.addUnhandledExceptionsListeners(this._logger,i.s.UnhandledContentError,"Unhandled async content script error"),this._logger.debug(520984580,"Initializing telemetry");const t=this._guidGenerator.generate();this._logger.addCorrelationID(t),this._logger.debug(520984579,"Registering listeners"),await this._registrar.initialize()}};v=(0,r.__decorate)([(0,h._)(),(0,r.__param)(0,(0,p.W)(o.G)),(0,r.__param)(1,(0,p.W)(a.V)),(0,r.__param)(2,(0,p.W)(s.K)),(0,r.__param)(3,(0,p.W)(l.a)),(0,r.__param)(3,(0,f.l)()),(0,r.__param)(4,(0,p.W)(d.g)),(0,r.__param)(5,(0,p.W)(u.c)),(0,r.__param)(6,(0,p.W)(c.n))],v);var m=n(76230),y=n(95988);let _=class extends m.a{constructor(e){super(),this.hostSettings=e,this.defaultUxLanguage="en-US",this.editorSpellcheckAttribute="data-ms-editor",this.completeTileTextUnit=this.hostSettings.useParagraphAsTileSeparator?y.fT.Paragraph:y.fT.Sentence,this.partialTileTextUnit=this.hostSettings.useParagraphAsTileSeparator?y.fT.Sentence:y.fT.Phrase,this.emitRemoval=!0,this.styleObserverIntervalTime=1,this.styleSampleTime=10,this.reconcileTileNodeTime=3e3,this.enableTileNodeAutoReconciliation=!0,this.maxSuggestionItemsDisplayNumber=3,this.maxSuggestionDisplayPerLanguageNumber=2,this.maxProofingLanguages=3,this.fabricFontsDefinitionPath="fonts/fabric-icons.css",this.enableSplitSuggestionButton=!1,this.narrowOnChangeReconciliation=!1,this.schedulerDefaultWaitingTime=50,this.schedulerDefaultMaxTime=2e3,this.schedulerDefaultWaitingTimeIncrement=400,this.maxServiceContentLengthInChars=350,this.maxContentLengthInChars=2e4}};_=(0,r.__decorate)([(0,h._)(),(0,r.__param)(0,(0,p.W)(c.n))],_);var b=n(6300),C=n(63799),S=n(18951),T=n(6526),I=n(23627),w=n(77148),E=n(46600),x=n(82256),A=n(63837);const D=(0,A.f)("IEditorClientSettings");var k=n(79928),F=n(98045);const P=(0,A.f)("IOrchestratorSettings");var N=n(6163),B=n(97397);let O=class{constructor(e,t){this._storeEntryReader=e,this._storeEntryWriter=t,this._storeEntryMap=this.populateStoreEntryMap()}_fetchStoreEntry(e){const t=this._storeEntryMap.get(e);if(!t)throw Error("Cannot find the entry key.");return t}async read(e){const t=this._fetchStoreEntry(e).storeEntry;return this._storeEntryReader.readOrInitialize(t)}async write(e,t){await this._storeEntryWriter.write(this._fetchStoreEntry(e).storeEntry,t)}async getLastUpdatedTimestamp(e){const t=this._fetchStoreEntry(e).storeEntry;return this._storeEntryReader.readLastUpdatedTimestamp(t)}getCachedEntry(e){const t=this._fetchStoreEntry(e),n=t.storeEntry;return{storeEntryValue:void 0===n.lastValueFromStorage?n.defaultValue:n.lastValueFromStorage,isSynced:!!t.isSynced}}getDefaultValue(e){return this._fetchStoreEntry(e).storeEntry.defaultValue}async removePersistentKeys(){}};O=(0,r.__decorate)([(0,h._)()],O);var R=n(40876),L=n(82757),M=n(15841),q=n(777),W=n(58964),U=n(20399);const z=new Map([[W.l.EnableCopilotInsert,!0],[W.l.EnableCopilotRewrite,!0],[W.l.EnableSpelling,!0],[W.l.EnableGrammar,!0],[W.l.EnableRefinements,!0],[W.l.EnableTelemetry,!0]]),j=new Map([[W.l.AppId,"EditorBX_Online"],[W.l.Descriptors,JSON.stringify([{name:"FlightIds",value:"Wac-WordEditorServiceSuggestionDescriptionsNoReferenceInformation-Treatment;Wac-WordEditorServiceMultipleGrammarCritiquesPerSentence-Treatment"}])],[W.l.ProofingLanguages,[]],[W.l.CritiqueValuePerLanguage,JSON.stringify([])],[W.l.DefaultProofingLanguageInitialized,!1],[W.l.ProofingLanguageListInitialized,!1],[W.l.IsLanguageAutoDetectEnabled,!0],[W.l.TonalFREAccepted,!1],[W.l.EnableEditor,!0],[W.l.EnableTextPrediction,!0],[W.l.EnableCIQFlags,!0],[W.l.EnableCIQMenu,!0],[W.l.OverriddenCritiqueTypeOptions,[]],[W.l.OverriddenInlineEditingSettings,[]],[W.l.PaneOverriddenCritiqueTypeOptions,[]],[W.l.StealthOverriddenCritiqueTypeOptions,[]],[W.l.ShowSynonyms,!1],[W.l.EnableSynonymsToggle,!1],[W.l.ConfigurationId,""],[W.l.ClientId,""],[W.l.HashedUserDictionary,[]]]),H=new Map([[W.l.DefaultLoggingLevel,U.q.Info],[W.l.DebugMode,!1]]);let V=class extends O{constructor(e,t,n,r){super(e,t),this.storeEntryReader=e,this.storeEntryWriter=t,this._emitter=n,this._hostSettings=r,this.write(W.l.AppId,this._hostSettings.appId)}populateStoreEntryMap(){const e=new Map;return z.forEach(((t,n)=>{e.set(n,{storeEntry:(0,R.EM)(n,t),isSynced:!0})})),j.forEach(((t,n)=>{e.set(n,{storeEntry:(0,R.EM)(n,t)})})),H.forEach(((t,n)=>{e.set(n,{storeEntry:(0,R.EM)(n,t,!0)})})),e}async initialize(){for(const e of z.keys())await this.read(e);await this.read(W.l.ConfigurationId);const e=Array.from(z.keys());e.push(...Array.from(j.keys())),e.push(...Array.from(H.keys()));for(const t of e)this._emitter.on(t,(()=>this.read(t)))}shutDown(){}async read(e){return e===W.l.AppId?Promise.resolve(this._hostSettings.appId):super.read(e)}async removePersistentKeys(){const e=Array.from(z.keys());e.push(...Array.from(j.keys())),e.push(...Array.from(H.keys())),e.length&&await this.storeEntryWriter.remove(e)}};V=(0,r.__decorate)([(0,h._)(),(0,r.__param)(0,(0,p.W)(L.A)),(0,r.__param)(1,(0,p.W)(M.a)),(0,r.__param)(2,(0,p.W)(q.E)),(0,r.__param)(3,(0,p.W)(c.n))],V);let G=class{triggerCallback(e,t){t?(this.userInfo=void 0,this.lastError=t):this.lastError=void 0,this.userInfo=e(this.userInfo)}async executeAsync(e=!0){return new Promise(((t,n)=>{this.execute(e,(e=>(this.lastError?n(this.lastError):t(e),e)))}))}};G=(0,r.__decorate)([(0,h._)()],G);let Q=class extends G{constructor(e){super(),this._hostSettings=e}update(e){this._updatedUserInfo=e}execute(e=!0,t){this._updatedUserInfo?this.userInfo=this._updatedUserInfo:this._hostSettings.userId&&(this.userInfo={userId:this._hostSettings.userId.puid,tenantId:this._hostSettings.userId.tenantId,email:void 0,licenseType:this._hostSettings.licenseType,identityProvider:this._hostSettings.userId.identityProvider}),this.triggerCallback(t)}};var K;Q=(0,r.__decorate)([(0,h._)(),(0,r.__param)(0,(0,p.W)(c.n))],Q),function(e){e.CourtesyAttributes="CourtesyAttributes",e.RootContentMaxLengthInChars="RootContentMaxLengthInChars"}(K||(K={}));const $=new Map([[K.CourtesyAttributes,["data-gramm"]],[K.RootContentMaxLengthInChars,500]]);let Z=class extends O{constructor(e,t,n){super(e,t),this.storeEntryReader=e,this.storeEntryWriter=t,this._emitter=n}populateStoreEntryMap(){const e=new Map;return $.forEach(((t,n)=>{e.set(n,{storeEntry:(0,R.Tm)(n,t),isSynced:!1})})),e}async initialize(){for(const e of $.keys())await this.read(e),this._emitter.on(e,(async()=>{await this.read(e)}))}shutDown(){}async removePersistentKeys(){const e=Array.from($.keys());e.length&&await this.storeEntryWriter.remove(e)}};Z=(0,r.__decorate)([(0,h._)(),(0,r.__param)(0,(0,p.W)(L.A)),(0,r.__param)(1,(0,p.W)(M.a)),(0,r.__param)(2,(0,p.W)(q.E))],Z);class J{constructor(){this.imports=[S.u]}get uniqueId(){return(0,T.z)(507918284)}configureRootServices(e){e.bind(I.H).to(v),e.bind(B.UC).to(B.h1),e.bind(B.YQ).to(B.ZP),e.bind(b.A).toDynamicValue((e=>{const t=e.get(B.YQ);return()=>t.currentTheme===B.SV.highContrast})),e.bind(D).to(_),e.bind(k.k).toExisting(D),e.bind(N.z).toExisting(D),e.bind(C.D).toExisting(D),e.bind(P).toExisting(D),e.bind(Z).toSelf(),e.bind(F.B).toExisting(Z),e.bind(s.K).to(V),e.bind(w.S).toExisting(Z),e.bind(w.S).toExisting(s.K),e.bind(E.e).to(Q),e.bind(x.M).toExisting(E.e)}}var X=n(34443),Y=n(29594);class ee{static hash(e){let t=0,n=0;for(;n<e.length;)t=(t<<5)-t+e.charCodeAt(n++)|0;return t>0?t:-1*t}static format(e,...t){const n=t.length;return e.replace(/\{(\d+)\}/g,((e,r)=>r<n?t[r]:e))}static trimLeft(e){return e.replace(/^\s+/,"")}static trimRight(e){return e.replace(/\s+$/,"")}}let te=class{getMessage(e,t){const n=(0,Y.$)(),r=n.getString("OnCanvasCalloutStrings",e)||n.getString("CopywriterStrings",e)||n.getString("EditorBrowserExtensionStrings",e)||n.getString("AiInsertStrings",e)||n.getString("InlineSuggestionStrings",e)||"";if(void 0===t)return r;const i=Array.isArray(t)?t:[t];return ee.format(r,...i)}};te=(0,r.__decorate)([(0,h._)()],te);var ne=n(71234),re=n(90935),ie=n(86388),oe=n(89928);const ae=new Map([["es-419","es-MX"]]);class se{async importStrings(e,t=!1){var r;let i=null!==(r=ae.get(e))&&void 0!==r?r:e;if(i in oe.Y){const e=oe.Y[i];i=Array.isArray(e)?e[0]:e}const o=(0,re.C)();return n(11311)(`./${function(e){try{const t=e.split("-");return 2===t.length?t[0].toLowerCase()+"-"+t[1].toUpperCase():t[0].toLowerCase()+"-"+t[1][0].toUpperCase()+t[1].substring(1).toLowerCase()+"-"+t[2].toUpperCase()}catch(t){throw(0,re.C)().logEvent(0,"Diagnostics",ie.h.Host,U.q.Error,{locale:e,Text_Message:`Unknown locale while loading strings from localization file dynamically: ${t}`}),Error(`Unknown locale : ${e} while loading strings from localization file dynamically: ${t}`)}}(i).toLowerCase()}/ui-strings.json`).then((async e=>e)).catch((n=>{try{if(!t){const t=e.split("-")[0];if(t in oe.Y){const e=oe.Y[t],n=Array.isArray(e)?e[0]:e;return this.importStrings(n,!0)}}o.logEvent(508351959,"Diagnostics",ie.h.Undefined,U.q.Error,`Failed to load strings for locale ${e} from localization file dynamically: ${n}`,void 0,void 0,void 0,"Text_Message")}catch(t){o.logEvent(508351958,"Diagnostics",ie.h.Undefined,U.q.Error,`Failed to load neutral strings for locale ${e} from localization file dynamically: ${n}`,void 0,void 0,void 0,"Text_Message")}}))}}class le{constructor(){this._fallbackLocale="en-US",this._languageCache=new Map,this._localizationFileImporter=new se}get strings(){var e;return null!==(e=this._strings)&&void 0!==e?e:{}}getString(e,t){return this._strings?this._strings[e][t]:""}getStringsFor(e){return this._strings?t=>this._strings[e][t]:()=>""}async getStringsForLocale(e){var t;const n=null!==(t=this._languageCache.get(e))&&void 0!==t?t:await this._localizationFileImporter.importStrings(e);return n&&this._languageCache.set(e,n),n}async getStringForLocale(e,t,n){const r=await this.getStringsForLocale(e);return null==r?void 0:r[t][n]}async getStringForFallbackLocale(e,t){return(await this.getStringsForFallbackLocale())[e][t]}async getStringsForFallbackLocale(){const e=await this.getStringsForLocale(this._fallbackLocale);if(!e)throw new Error("Failed to load strings from localization file dynamically");return e}setFallbackLocale(e){this._fallbackLocale=e}get fallbackLocale(){return this._fallbackLocale}async loadLocale(e){if(!e)throw(0,re.C)().logEvent(0,"Diagnostics",ie.h.Undefined,U.q.Error,"Undefined locale while loading strings from localization file dynamically.",void 0,void 0,void 0,"Text_Message"),Error("Undefined locale language while loading strings dynamically");let t;if(!(t=this._languageCache.get(e))){if(t=await this._localizationFileImporter.importStrings(e),!t)throw Error(`Failed to load strings from localization file dynamically: ${e}`);this._languageCache.set(e,t)}this._strings=t}}new le;class de{constructor(){this.imports=[]}get uniqueId(){return(0,T.z)(507918298)}configureRootServices(e){var t;const n=null!==(t=(0,Y.$)())&&void 0!==t?t:new le;(0,Y.Y)(n),e.bind(ne.H).to(te)}}class ue{constructor(){this.imports=[J,de]}get uniqueId(){return(0,T.z)(507918337)}configureRootServices(e){e.bind(X.Q).toDynamicValue((e=>()=>e.getOptional(X.C)))}}var ce=n(46965);const ge=(0,A.f)("IIconRegistrable");var he=n(30122),pe=n(39454);let fe=class{constructor(e){this.iconGroups=e}async initialize(){const e={};for(const t of this.iconGroups)for(const n of await t.getIcons())e[n.iconName]=n.icon;(0,pe.K1)({icons:e})}shutDown(){}};fe=(0,r.__decorate)([(0,h._)(),(0,r.__param)(0,(0,he.t)(ge)),(0,r.__param)(0,(0,f.l)())],fe);const ve=(0,A.f)("ILanguageInfoProvider");function me(e,t,n){const r={};for(const i in n)r[e+"-"+i]=`${t} (${n[i]})`;return r}const ye=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({"aa-dj":"Qafar (Yabuuti)","aa-er":"Qafar (Eretria)","aa-et":"Qafar (Otobbia)","af-na":"Afrikaans (Namibië)","af-za":"Afrikaans (Suid-Afrika)","agq-cm":"Aghem (Kàmàlûŋ)","ak-gh":"Akan (Gaana)","am-et":"አማርኛ (ኢትዮጵያ)","ar-001":["العربية (العالم)",!0],"ar-ae":["العربية (الإمارات العربية المتحدة)",!0],"ar-bh":["العربية (البحرين)",!0],"ar-dj":["العربية (جيبوتي)",!0],"ar-dz":["العربية (الجزائر)",!0],"ar-eg":["العربية (مصر)",!0],"ar-er":["العربية (إريتريا)",!0],"ar-il":["العربية (إسرائيل)",!0],"ar-iq":["العربية (العراق)",!0],"ar-jo":["العربية (الأردن)",!0],"ar-km":["العربية (جزر القمر)",!0],"ar-kw":["العربية (الكويت)",!0],"ar-lb":["العربية (لبنان)",!0],"ar-ly":["العربية (ليبيا)",!0],"ar-ma":["العربية (المملكة المغربية)",!0],"ar-mr":["العربية (موريتانيا)",!0],"ar-om":["العربية (عمان)",!0],"ar-ps":["العربية (السلطة الفلسطينية)",!0],"ar-qa":["العربية (قطر)",!0],"ar-sa":["العربية (المملكة العربية السعودية)",!0],"ar-sd":["العربية (السودان)",!0],"ar-so":["العربية (الصومال)",!0],"ar-ss":["العربية (جنوب السودان)",!0],"ar-sy":["العربية (سوريا)",!0],"ar-td":["العربية (تشاد)",!0],"ar-tn":["العربية (تونس)",!0],"ar-ye":["العربية (اليمن)",!0],"arn-cl":"Mapudungun (Chile)","as-in":"অসমীয়া (ভাৰত)","asa-tz":"Kipare (Tadhania)","ast-es":"asturianu (España)","az-cyrl-az":"азәрбајҹан (Азәрбајҹан)","az-latn-az":"azərbaycan (Azərbaycan)","ba-ru":"Башҡорт (Рәсәй)","bas-cm":"Ɓàsàa (Kàmɛ̀rûn)","be-by":"Беларуская (Беларусь)","bem-zm":"Ichibemba (Zambia)","bez-tz":"Hibena (Hutanzania)","bg-bg":"български (България)","bin-ng":"Ẹ̀dó (Nigeria)","bm-latn-ml":"bamanakan (Mali)","bn-bd":"বাংলা (বাংলাদেশ)","bn-in":"বাংলা (ভারত)","bo-cn":"བོད་ཡིག (ཀྲུང་ཧྭ་མི་དམངས་སྤྱི་མཐུན་རྒྱལ་ཁབ།)","bo-in":"བོད་སྐད་ (རྒྱ་གར་)","br-fr":"brezhoneg (Frañs)","brx-in":"बड़ो (भारत)","bs-cyrl-ba":"босански (Босна и Херцеговина)","bs-latn-ba":"bosanski (Bosna i Hercegovina)","byn-er":"ብሊን (ኤርትራ)","ca-ad":"català (Andorra)","ca-es":"català (català)","ca-es-valencia":"valencià (Espanya)","ca-fr":"català (França)","ca-it":"català (Itàlia)","ccp-cakm-bd":"𑄌𑄋𑄴𑄟𑄳𑄦 (𑄝𑄁𑄣𑄘𑄬𑄌𑄴)","ccp-cakm-in":"𑄌𑄋𑄴𑄟𑄳𑄦 (𑄞𑄢𑄧𑄖𑄴)","ce-ru":"нохчийн (Росси)","ceb-latn-ph":"Cebuano (Pilipinas)","cgg-ug":"Rukiga (Uganda)","chr-cher-us":"ᏣᎳᎩ (ᏌᏊ ᎢᏳᎾᎵᏍᏔᏅ ᏍᎦᏚᎩ)","co-fr":"Corsu (Francia)","cs-cz":"čeština (Česko)","cu-ru":"церковнослове́нскїй (рѡссі́а)","cy-gb":"Cymraeg (Y Deyrnas Unedig)","da-dk":"dansk (Danmark)","da-gl":"dansk (Grønland)","dav-ke":"Kitaita (Kenya)"},me("de","Deutsch",{at:"Österreich",be:"Belgien",ch:"Schweiz",de:"Deutschland",it:"Italien",li:"Liechtenstein",lu:"Luxemburg"})),{"dje-ne":"Zarmaciine (Nižer)","dsb-de":"dolnoserbšćina (Nimska)","dua-cm":"duálá (Cameroun)","dv-mv":["ދިވެހިބަސް (ދިވެހި ރާއްޖެ)",!0],"dyo-sn":"joola (Senegal)","dz-bt":"རྫོང་ཁ (འབྲུག)","ebu-ke":"Kĩembu (Kenya)","ee-gh":"Eʋegbe (Ghana nutome)","ee-tg":"Eʋegbe (Togo nutome)","el-cy":"Ελληνικά (Κύπρος)","el-gr":"Ελληνικά (Ελλάδα)"}),me("en","English",{"001":"World","029":"Caribbean",150:"Europe",ae:"United Arab Emirates",ag:"Antigua & Barbuda",ai:"Anguilla",as:"American Samoa",at:"Austria",au:"Australia",bb:"Barbados",be:"Belgium",bi:"Burundi",bm:"Bermuda",bs:"Bahamas",bw:"Botswana",bz:"Belize",ca:"Canada",cc:"Cocos (Keeling) Islands",ch:"Switzerland",ck:"Cook Islands",cm:"Cameroon",cx:"Christmas Island",cy:"Cyprus",de:"Germany",dk:"Denmark",dm:"Dominica",er:"Eritrea",fi:"Finland",fj:"Fiji",fk:"Falkland Islands",fm:"Micronesia",gb:"United Kingdom",gd:"Grenada",gg:"Guernsey",gh:"Ghana",gi:"Gibraltar",gm:"Gambia",gu:"Guam",gy:"Guyana",hk:"Hong Kong SAR",id:"Indonesia",ie:"Ireland",il:"Israel",im:"Isle of Man",in:"India",io:"British Indian Ocean Territory",je:"Jersey",jm:"Jamaica",ke:"Kenya",ki:"Kiribati",kn:"St. Kitts & Nevis",ky:"Cayman Islands",lc:"St. Lucia",lr:"Liberia",ls:"Lesotho",mg:"Madagascar",mh:"Marshall Islands",mo:"Macao SAR",mp:"Northern Mariana Islands",ms:"Montserrat",mt:"Malta",mu:"Mauritius",mw:"Malawi",my:"Malaysia",na:"Namibia",nf:"Norfolk Island",ng:"Nigeria",nl:"Netherlands",nr:"Nauru",nu:"Niue",nz:"New Zealand",pg:"Papua New Guinea",ph:"Philippines",pk:"Pakistan",pn:"Pitcairn Islands",pr:"Puerto Rico",pw:"Palau",rw:"Rwanda",sb:"Solomon Islands",sc:"Seychelles",sd:"Sudan",se:"Sweden",sg:"Singapore",sh:"St Helena, Ascension, Tristan da Cunha",si:"Slovenia",sl:"Sierra Leone",ss:"South Sudan",sx:"Sint Maarten",sz:"Eswatini",tc:"Turks & Caicos Islands",tk:"Tokelau",to:"Tonga",tt:"Trinidad & Tobago",tv:"Tuvalu",tz:"Tanzania",ug:"Uganda",um:"U.S. Outlying Islands",us:"United States",vc:"St. Vincent & Grenadines",vg:"British Virgin Islands",vi:"U.S. Virgin Islands",vu:"Vanuatu",ws:"Samoa",za:"South Africa",zm:"Zambia",zw:"Zimbabwe"})),{"eo-001":"esperanto (Mondo)"}),me("es","español",{419:"Latinoamérica",ar:"Argentina",bo:"Bolivia",br:"Brasil",bz:"Belice",cl:"Chile",co:"Colombia",cr:"Costa Rica",cu:"Cuba",do:"República Dominicana",ec:"Ecuador",es:"España, alfabetización internacional",es_tradnl:"España, alfabetización tradicional",gq:"Guinea Ecuatorial",gt:"Guatemala",hn:"Honduras",mx:"México",ni:"Nicaragua",pa:"Panamá",pe:"Perú",ph:"Filipinas",pr:"Puerto Rico",py:"Paraguay",sv:"El Salvador",us:"Estados Unidos",uy:"Uruguay",ve:"Venezuela"})),{"et-ee":"eesti (Eesti)","eu-es":"euskara (euskara)","ewo-cm":"ewondo (Kamərún)","fa-ir":["فارسی (ایران)",!0]}),me("ff-latn","Pulaar",{bf:"Burkibaa Faaso",cm:"Kameruun",gh:"Ganaa",gm:"Gammbi",gn:"Gine",gw:"Gine-Bisaawo",lr:"Liberiyaa",mr:"Muritani",ne:"Nijeer",ng:"Nijeriyaa",sl:"Seraa liyon",sn:"Senegaal"})),{"fi-fi":"suomi (Suomi)","fil-ph":"Filipino (Pilipinas)","fo-dk":"føroyskt (Danmark)","fo-fo":"føroyskt (Føroyar)"}),me("fr","français",{"029":"caraïbes",be:"Belgique",bf:"Burkina Faso",bi:"Burundi",bj:"Bénin",bl:"Saint-Barthélemy",ca:"Canada",cd:"Congo, République démocratique du",cf:"République centrafricaine",cg:"Congo",ch:"Suisse",ci:"Côte d’Ivoire",cm:"Cameroun",dj:"Djibouti",dz:"Algérie",fr:"France",ga:"Gabon",gf:"Guyane française",gn:"Guinée",gp:"Guadeloupe",gq:"Guinée équatoriale",ht:"Haïti",km:"Comores",lu:"Luxembourg",ma:"Maroc",mc:"Monaco",mf:"Saint-Martin",mg:"Madagascar",ml:"Mali",mq:"Martinique",mr:"Mauritanie",mu:"Maurice",nc:"Nouvelle-Calédonie",ne:"Niger",pf:"Polynésie française",pm:"Saint-Pierre-et-Miquelon",re:"La Réunion",rw:"Rwanda",sc:"Seychelles",sn:"Sénégal",sy:"Syrie",td:"Tchad",tg:"Togo",tn:"Tunisie",vu:"Vanuatu",wf:"Wallis-et-Futuna",yt:"Mayotte"})),{"fur-it":"furlan (Italie)","fy-nl":"Frysk (Nederlân)","ga-ie":"Gaeilge (Éire)","gd-gb":"Gàidhlig (An Rìoghachd Aonaichte)","gl-es":"galego (galego)","gn-py":"Avañe’ẽ (Paraguái)","gsw-ch":"Schwiizertüütsch (Schwiiz)","gsw-fr":"Elsässisch (Frànkrisch)","gsw-li":"Schwiizertüütsch (Liächteschtäi)","gu-in":"ગુજરાતી (ભારત)","guz-ke":"Ekegusii (Kenya)","gv-im":"Gaelg (Ellan Vannin)","ha-latn-gh":"Hausa (Gana)","ha-latn-ne":"Hausa (Nijar)","ha-latn-ng":"Hausa (Najeriya)","haw-us":"ʻŌlelo Hawaiʻi (ʻAmelika Hui Pū ʻIa)","he-il":["עברית (ישראל)",!0],"hi-in":"हिन्दी (भारत)","hr-ba":"hrvatski (Bosna i Hercegovina)","hr-hr":"hrvatski (Hrvatska)","hsb-de":"hornjoserbšćina (Němska)","hu-hu":"magyar (Magyarország)","hy-am":"Հայերեն (Հայաստան)","ia-001":"interlingua (Mundo)","ibb-ng":"Ibibio-Efik (Nigeria)","id-id":"Indonesia (Indonesia)","ig-ng":"Asụsụ Igbo (Naịjịrịa)","ii-cn":"ꆈꌠꁱꂷ (ꍏꉸꏓꂱꇭꉼꇩ)","is-is":"íslenska (Ísland)","it-ch":"italiano (Svizzera)","it-it":"italiano (Italia)","it-sm":"italiano (San Marino)","it-va":"italiano (Città del Vaticano)","iu-cans-ca":"ᐃᓄᒃᑎᑐᑦ (ᑲᓇᑕᒥ)","iu-latn-ca":"Inuktitut (Kanatami)","ja-jp":"日本語 (日本)","jgo-cm":"Ndaꞌa (Kamɛlûn)","jmc-tz":"Kimachame (Tanzania)","jv-java-id":"ꦧꦱꦗꦮ (Indonesia)","jv-latn-id":"Basa Jawa (Indonesia)","ka-ge":"ქართული (საქართველო)","kab-dz":"Taqbaylit (Lezzayer)","kam-ke":"Kikamba (Kenya)","kde-tz":"Chimakonde (Tanzania)","kea-cv":"kabuverdianu (Kabu Verdi)","khq-ml":"Koyra ciini (Maali)","ki-ke":"Gikuyu (Kenya)","kk-kz":"қазақ тілі (Қазақстан)","kkj-cm":"kakɔ (Kamɛrun)","kl-gl":"kalaallisut (Kalaallit Nunaat)","kln-ke":"Kalenjin (Emetab Kenya)","km-kh":"ខ្មែរ (កម្ពុជា)","kn-in":"ಕನ್ನಡ (ಭಾರತ)","ko-kp":"한국어 (조선민주주의인민공화국)","ko-kr":"한국어(대한민국)","kok-in":"कोंकणी (भारत)","kr-latn-ng":"Kanuri (Nigeria)","ks-arab-in":"کٲشُر (اَربی)","ks-deva-in":"कॉशुर","ksb-tz":"Kishambaa (Tanzania)","ksf-cm":"rikpa (kamɛrún)","ksh-de":"Kölsch (Doütschland)","ku-arab-iq":["کوردیی ناوەڕاست (عێراق)",!0],"ku-arab-ir":"کوردی (ئێران)","kw-gb":"kernewek (Rywvaneth Unys)","ky-kg":"кыргызча (Кыргызстан)","la-001":"lingua latīna (World)","lag-tz":"Kɨlaangi (Taansanía)","lb-lu":"Lëtzebuergesch (Lëtzebuerg)","lg-ug":"Luganda (Yuganda)","lkt-us":"Lakȟólʼiyapi (Mílahaŋska Tȟamákȟočhe)","ln-ao":"lingála (Angóla)","ln-cd":"lingála (Republíki ya Kongó Demokratíki)","ln-cf":"lingála (Repibiki ya Afríka ya Káti)","ln-cg":"lingála (Kongo)","lo-la":"ລາວ (ລາວ)","lrc-iq":"لۊری شومالی (Iraq)","lrc-ir":"لۊری شومالی (Iran)","lt-lt":"lietuvių (Lietuva)","lu-cd":"Tshiluba (Ditunga wa Kongu)","luo-ke":"Dholuo (Kenya)","luy-ke":"Luluhia (Kenya)","lv-lv":"latviešu (Latvija)","mas-ke":"Maa (Kenya)","mas-tz":"Maa (Tansania)","mer-ke":"Kĩmĩrũ (Kenya)","mfe-mu":"kreol morisien (Moris)","mg-mg":"Malagasy (Madagasikara)","mgh-mz":"Makua (Umozambiki)","mgo-cm":"metaʼ (Kamalun)","mi-nz":"te reo Māori (Aotearoa)","mk-mk":"македонски (Северна Македонија)","ml-in":"മലയാളം (ഇന്ത്യ)","mn-mn":"монгол (Монгол)","mn-mong-cn":"ᠮᠣᠩᠭᠣᠤᠯ ᠬᠡᠯᠡ (ᠪᠦᠭᠦᠳᠡ ᠨᠠᠢᠷᠠᠮᠳᠠᠬᠤ ᠳᠤᠮᠳᠠᠳᠤ ᠠᠷᠠᠳ ᠣᠯᠣᠰ)","mn-mong-mn":"ᠮᠣᠩᠭᠣᠯ ᠬᠡᠯᠡ (ᠮᠣᠩᠭᠣᠯ ᠣᠯᠣᠰ)","mni-in":"মৈতৈলোন্ (India)","moh-ca":"Kanien'kéha","mr-in":"मराठी (भारत)","ms-bn":"Melayu (Brunei)","ms-my":"Melayu (Malaysia)","ms-sg":"Melayu (Singapura)","mt-mt":"Malti (Malta)","mua-cm":"MUNDAŊ (kameruŋ)","my-mm":"မြန်မာ (မြန်မာ)","mzn-ir":"مازرونی (ایران)","naq-na":"Khoekhoegowab (Namibiab)","nb-no":"norsk bokmål (Norge)","nb-sj":"norsk bokmål (Svalbard og Jan Mayen)","nd-zw":"isiNdebele (Zimbabwe)","nds-de":"Neddersass’sch (Düütschland)","nds-nl":"Neddersass’sch (Nedderlannen)","ne-in":"नेपाली (भारत)","ne-np":"नेपाली (नेपाल)"}),me("nl","Nederlands",{aw:"Aruba",be:"België",bq:"Bonaire, Sint Eustatius en Saba",cw:"Curaçao",nl:"Nederland",sr:"Suriname",sx:"Sint-Maarten"})),{"nmg-cm":"Kwasio (Kamerun)","nn-no":"nynorsk (Noreg)","nnh-cm":"Shwóŋò ngiembɔɔn (Kàmalûm)","nqo-gn":["ߒߞߏ (ߖߌ߬ߣߍ߬ ߞߊ߲ߓߍ߲)",!0],"nr-za":"isiNdebele (South Africa)","nso-za":"Sesotho sa Leboa (Afrika Borwa)","nus-ss":"Thok Nath (South Sudan)","nyn-ug":"Runyankore (Uganda)","oc-fr":"Occitan (França)","om-et":"Oromoo (Itoophiyaa)","om-ke":"Oromoo (Keeniyaa)","or-in":"ଓଡ଼ିଆ (ଭାରତ)","os-ge":"ирон (Гуырдзыстон)","os-ru":"ирон (Уӕрӕсе)","pa-arab-pk":["پنجابی (پاکستان)",!0],"pa-in":"ਪੰਜਾਬੀ (ਭਾਰਤ)","pap-029":"Papiamentu (Caribbean)","pl-pl":"polski (Polska)","prg-001":"prūsiskan (swītai)","prs-af":["درى (افغانستان)",!0],"ps-af":["پښتو (افغانستان)",!0],"ps-pk":["پښتو (پاکستان)",!0]}),me("pt","português",{ao:"Angola",br:"Brasil",ch:"Suíça",cv:"Cabo Verde",gq:"Guiné Equatorial",gw:"Guiné-Bissau",lu:"Luxemburgo",mo:"RAE de Macau",mz:"Moçambique",pt:"Portugal",st:"São Tomé e Príncipe",tl:"Timor-Leste"})),{"qps-latn-x-sh":"Pśęüďό Sęłfhóšť","qps-ploc":"[Þšéųδô (Ρŝέũδθ) !!! !!]","qps-ploca":"[Ρšēŭďõ ₤áηğűãĝè (Þ§эūðò Αśĩä) !!! !!! ]","qps-plocm":["[Þ§ėΰðό £äπĝúаğę (Рŝéûďб Μίяřóŗ℮ď) !!! !!! !]",!0],"quc-latn-gt":"K'iche' (Guatemala)","quz-bo":"Runasimi (Bolivia)","quz-ec":"Runasimi (Ecuador)","quz-pe":"Runasimi (Perú)","rm-ch":"rumantsch (Svizra)","rn-bi":"Ikirundi (Uburundi)","ro-md":"română (Republica Moldova)","ro-ro":"română (România)","rof-tz":"Kihorombo (Tanzania)"}),me("ru","русский",{by:"Беларусь",kg:"Киргизия",kz:"Казахстан",md:"Молдова",ru:"Россия",ua:"Украина"})),{"rw-rw":"Kinyarwanda (U Rwanda)","rwk-tz":"Kiruwa (Tanzania)","sa-in":"संस्कृत (भारतम्)","sah-ru":"Саха (Россия)","saq-ke":"Kisampur (Kenya)","sbp-tz":"Ishisangu (Tansaniya)","sd-arab-pk":["سنڌي (پاکستان)",!0],"sd-deva-in":"सिन्धी (India)","se-fi":"davvisámegiella (Suopma)","se-no":"davvisámegiella (Norga)","se-se":"davvisámegiella (Ruoŧŧa)","seh-mz":"sena (Moçambique)","ses-ml":"Koyraboro senni (Maali)","sg-cf":"Sängö (Ködörösêse tî Bêafrîka)","shi-latn-ma":"Tashelḥiyt (lmɣrib)","shi-tfng-ma":"ⵜⴰⵛⵍⵃⵉⵜ (ⵍⵎⵖⵔⵉⴱ)","si-lk":"සිංහල (ශ්‍රී ලංකාව)","sk-sk":"slovenčina (Slovensko)","sl-si":"slovenščina (Slovenija)","sma-no":"åarjelsaemiengïele (Nöörje)","sma-se":"åarjelsaemiengïele (Sveerje)","smj-no":"julevusámegiella (Vuodna)","smj-se":"julevusámegiella (Svierik)","smn-fi":"anarâškielâ (Suomâ)","sms-fi":"sää´mǩiõll (Lää´ddjânnam)","sn-latn-zw":"chiShona (Zimbabwe)"}),me("so","Soomaali",{dj:"Jabuuti",et:"Itoobiya",ke:"Kenya",so:"Soomaaliya"})),{"sq-al":"shqip (Shqipëri)","sq-mk":"shqip (Maqedonia e Veriut)","sq-xk":"shqip (Kosovë)"}),me("sr-cyrl","српски",{ba:"Босна и Херцеговина",cs:"Србија и Црна Гора (Бивша)",me:"Црна Гора",rs:"Србија",xk:"Косово"})),me("sr-latn","srpski",{ba:"Bosna i Hercegovina",cs:"Srbija i Crna Gora (Bivša)",me:"Crna Gora",rs:"Srbija",xk:"Kosovo"})),{"ss-sz":"siSwati (eSwatini)","ss-za":"siSwati (South Africa)","ssy-er":"Saho (Eretria)","st-ls":"Sesotho (Lesotho)","st-za":"Sesotho (South Africa)","sv-ax":"svenska (Åland)","sv-fi":"svenska (Finland)","sv-se":"svenska (Sverige)"}),me("sw","Kiswahili",{cd:"Jamhuri ya Kidemokrasia ya Kongo",ke:"Kenya",tz:"Tanzania",ug:"Uganda"})),{"syr-sy":["ܣܘܪܝܝܐ (ܣܘܪܝܐ)",!0],"ta-in":"தமிழ் (இந்தியா)","ta-lk":"தமிழ் (இலங்கை)","ta-my":"தமிழ் (மலேசியா)","ta-sg":"தமிழ் (சிங்கப்பூர்)","te-in":"తెలుగు (భారతదేశం)","teo-ke":"Kiteso (Kenia)","teo-ug":"Kiteso (Uganda)","tg-cyrl-tj":"тоҷикӣ (Тоҷикистон)","th-th":"ไทย (ไทย)","ti-er":"ትግርኛ (ኤርትራ)","ti-et":"ትግርኛ (ኢትዮጵያ)","tig-er":"ትግረ (ኤርትራ)","tk-tm":"Türkmen dili (Türkmenistan)","tn-bw":"Setswana (Botswana)","tn-za":"Setswana (Aforika Borwa)","to-to":"lea fakatonga (Tonga)","tr-cy":"Türkçe (Kıbrıs)","tr-tr":"Türkçe (Türkiye)","ts-za":"Xitsonga (South Africa)","tt-ru":"Татар (Россия)","twq-ne":"Tasawaq senni (Nižer)","tzm-arab-ma":["أطلس المركزية التامازيتية (Morocco)",!0],"tzm-latn-dz":"Tamaziɣt n laṭlaṣ (Djazaïr)","tzm-latn-ma":"Tamaziɣt n laṭlaṣ (Meṛṛuk)","tzm-tfng-ma":"ⵜⴰⵎⴰⵣⵉⵖⵜ (ⵍⵎⵖⵔⵉⴱ)","ug-cn":["ئۇيغۇرچە (جۇڭخۇا خەلق جۇمھۇرىيىتى)",!0],"uk-ua":"українська (Україна)","ur-in":["اردو (بھارت)",!0],"ur-pk":["اُردو (پاکستان)",!0],"uz-arab-af":"اوزبیک (افغانستان)","uz-cyrl-uz":"ўзбекча (Ўзбекистон)","uz-latn-uz":"o‘zbek (Oʻzbekiston)","vai-latn-lr":"Vai (Laibhiya)","vai-vaii-lr":"ꕙꔤ (ꕞꔤꔫꕩ)","ve-za":"Tshivenḓa (South Africa)","vi-vn":"Tiếng Việt (Việt Nam)","vo-001":"Volapük (World)","vun-tz":"Kyivunjo (Tanzania)","wae-ch":"Walser (Schwiz)","wal-et":"ወላይታቱ (ኢትዮጵያ)","wo-sn":"Wolof (Senegaal)","xh-za":"isiXhosa (eMzantsi Afrika)","xog-ug":"Olusoga (Yuganda)","yav-cm":"nuasue (Kemelún)","yi-001":["ייִדיש (וועלט)",!0],"yo-bj":"Èdè Yorùbá (Orílɛ́ède Bɛ̀nɛ̀)","yo-ng":"Èdè Yorùbá (Orilẹ̀-èdè Nàìjíríà)","zgh-tfng-ma":"ⵜⴰⵎⴰⵣⵉⵖⵜ (ⵍⵎⵖⵔⵉⴱ)","zh-cn":"中文(中国)","zh-hk":"中文(香港特別行政區)","zh-hans-hk":"中文 (香港特别行政区)","zh-hans-mo":"中文 (澳门特别行政区)","zh-mo":"中文(澳門特別行政區)","zh-sg":"中文(新加坡)","zh-tw":"中文(台灣)","zu-za":"isiZulu (iNingizimu Afrika)"}),_e=(e,t=!1,n)=>{let r;const i=e.toLocaleLowerCase(),o=ye[i];if(o&&(r=Array.isArray(o)?{languageId:e,languageName:o[0],isRtl:o[1]}:{languageId:e,languageName:o,isRtl:!1}),!r&&t){const e=oe.Y[i];if(e){const t=Array.isArray(e)?e[0]:e,n=Array.isArray(e)?e[1]:void 0,i=ye[t.toLocaleLowerCase()],o=!!Array.isArray(i)&&i[1],a=Array.isArray(i)?i[0]:i;r={languageId:t,languageName:null!=n?n:a,isRtl:o}}}if(r&&n){const e=r.languageId.toLocaleLowerCase();n.find((t=>t.toLocaleLowerCase()===e))||(r=void 0)}return r},be=e=>{const t=new Map;for(const n of e){if(!n.languageId)continue;const e=_e(n.languageId);e&&!t.has(n.languageId)&&t.set(n.languageId,e)}return Array.from(t.values())},Ce=["af-ZA","ar-AE","ar-BH","ar-DZ","ar-EG","ar-IQ","ar-JO","ar-KW","ar-LB","ar-LY","ar-MA","ar-OM","ar-QA","ar-SA","ar-SY","ar-TN","ar-YE","as-IN","az-Latn-AZ","bg-BG","bn-BD","bn-IN","bs-Latn-BA","ca-ES","ca-ES-valencia","cs-CZ","cy-GB","da-DK","de-AT","de-CH","de-DE","de-LI","de-LU","el-GR","en-029","en-AU","en-BZ","en-CA","en-CB","en-GB","en-HK","en-ID","en-IE","en-IN","en-JM","en-MY","en-NZ","en-PH","en-SG","en-TT","en-US","en-ZA","en-ZW","es-419","es-AR","es-BO","es-CL","es-CO","es-CR","es-DO","es-EC","es-ES","es-ES_tradnl","es-GT","es-HN","es-MX","es-NI","es-PA","es-PE","es-PR","es-PY","es-SV","es-US","es-UY","es-VE","et-EE","eu-ES","fa-IR","fi-FI","fr-BE","fr-CA","fr-CD","fr-CH","fr-CI","fr-CM","fr-FR","fr-HT","fr-LU","fr-MA","fr-MC","fr-ML","fr-RE","fr-SN","ga-IE","gd-GB","gl-ES","gu-IN","ha-Latn-NG","he-IL","hi-IN","hr-BA","hr-HR","hu-HU","hy-AM","id-ID","ig-NG","is-IS","it-CH","it-IT","ja-JP","ka-GE","kk-KZ","kn-IN","kok-IN","ko-KR","ky-KG","lb-LU","lt-LT","lv-LV","mi-NZ","mk-MK","ml-IN","mr-IN","ms-BN","ms-MY","mt-MT","nb-NO","ne-IN","ne-NP","nl-BE","nl-NL","nn-NO","nso-ZA","or-IN","pa-IN","pl-PL","ps-AF","pt-BR","pt-PT","rm-CH","ro-MD","ro-RO","ru-MD","ru-RU","rw-RW","si-LK","sk-SK","sl-SI","sq-AL","sr-Cyrl-BA","sr-Cyrl-CS","sr-Cyrl-ME","sr-Cyrl-RS","sr-Latn-BA","sr-Latn-CS","sr-Latn-ME","sr-Latn-RS","sv-FI","sv-SE","sw-KE","ta-IN","te-IN","th-TH","tn-BW","tn-ZA","tr-TR","tt-RU","uk-UA","ur-IN","ur-PK","uz-Latn-UZ","vi-VN","wo-SN","xh-ZA","yo-NG","zu-ZA"];let Se=class{constructor(){this.bxSupportedLanguages=Ce.map((e=>({languageId:e})))}getLanguageInfo(e){return _e(e,!0,Ce)}mapToLanguageInfo(e){return be(e)}bxDefaultSupportedLanguages(){return be(this.bxSupportedLanguages)}};Se=(0,r.__decorate)([(0,h._)()],Se);var Te=n(74706),Ie=n(48640),we=n(46546),Ee=n(92037);let xe=class{constructor(e,t,n,r,i){this._proofingStore=e,this._logger=t,this._settingsEmitter=n,this._localizer=r,this._languageInfo=i,this._languageAddMode=!1,this._actionStatus="",this._selectedKey=null,this.getLocalized=e=>this._localizer.getMessage(e),this.getLanguageName=e=>{var t;const n=this._languageInfo.getLanguageInfo(e);return null!==(t=null==n?void 0:n.languageName)&&void 0!==t?t:e},this.updateProofingLanguages=async()=>{const e=new Ie.I(await this._proofingStore.read(W.l.ProofingLanguages));(0,we.runInAction)((()=>{this.proofingLanguages=e}))},this.setActionStatus=(e,t)=>{const n=this.getLanguageName(t),r=t===n?t:`${t}. ${n}`,i=this._localizer.getMessage(e,r);this._actionStatus=i},this.proofingLanguages=new Ie.I(this._proofingStore.getDefaultValue(W.l.ProofingLanguages)),(0,Ee.Gn)(this)}get languageAddMode(){return this._languageAddMode}get actionStatus(){return this._actionStatus}get canAddLanguage(){return this.proofingLanguages.count<3}get canRemoveLanguage(){return this.proofingLanguages.count>1}get selectedKey(){return this._selectedKey}addSelected(){const e=this._selectedKey;!e||this.proofingLanguages.count>=3||(this.proofingLanguages.add(e),this.setActionStatus("ebx_languageAdded",e),this.setLanguageAddMode(!1))}remove(e){this.proofingLanguages.count>1&&(this.proofingLanguages.remove(e),this.setActionStatus("ebx_languageRemoved",e))}moveUp(e){this.proofingLanguages.count>1&&(this.proofingLanguages.moveUp(e),this.setActionStatus("ebx_languageMovedUp",e))}moveDown(e){this.proofingLanguages.count>1&&(this.proofingLanguages.moveDown(e),this.setActionStatus("ebx_languageMovedDown",e))}moveToTop(e){this.proofingLanguages.count>1&&(this.proofingLanguages.moveToTop(e),this.setActionStatus("ebx_languageMovedToTop",e))}setLanguageAddMode(e){this._languageAddMode=e}async revertChanges(){const e=new Ie.I(await this._proofingStore.read(W.l.ProofingLanguages));(0,we.runInAction)((()=>{this.proofingLanguages=e}))}async save(){await this._proofingStore.write(W.l.ProofingLanguages,this.proofingLanguages.codesList),this._logger.debug(512242964,`[ProofingLanguageStateStore] Saved proofing languages setting: ${this.proofingLanguages.codesList}`),await this._proofingStore.read(W.l.ProofingLanguageListInitialized)||await this._proofingStore.write(W.l.ProofingLanguageListInitialized,!0)}async initialize(){this._settingsEmitter.on(W.l.ProofingLanguages,this.updateProofingLanguages),this._logger.debug(512242963,"[ProofingLanguageStateStore] Sending load languages request to background script"),this.proofingLanguages=new Ie.I(await this._proofingStore.read(W.l.ProofingLanguages))}shutDown(){}setSelectedKey(e){this._selectedKey=e}};(0,r.__decorate)([we.observable],xe.prototype,"proofingLanguages",void 0),(0,r.__decorate)([we.observable],xe.prototype,"_languageAddMode",void 0),(0,r.__decorate)([we.computed],xe.prototype,"languageAddMode",null),(0,r.__decorate)([we.observable],xe.prototype,"_actionStatus",void 0),(0,r.__decorate)([we.computed],xe.prototype,"actionStatus",null),(0,r.__decorate)([we.computed],xe.prototype,"canAddLanguage",null),(0,r.__decorate)([we.computed],xe.prototype,"canRemoveLanguage",null),(0,r.__decorate)([we.observable],xe.prototype,"_selectedKey",void 0),(0,r.__decorate)([we.computed],xe.prototype,"selectedKey",null),(0,r.__decorate)([we.action],xe.prototype,"addSelected",null),(0,r.__decorate)([we.action],xe.prototype,"remove",null),(0,r.__decorate)([we.action],xe.prototype,"moveUp",null),(0,r.__decorate)([we.action],xe.prototype,"moveDown",null),(0,r.__decorate)([we.action],xe.prototype,"moveToTop",null),(0,r.__decorate)([we.action],xe.prototype,"setLanguageAddMode",null),(0,r.__decorate)([we.action],xe.prototype,"setSelectedKey",null),(0,r.__decorate)([we.action],xe.prototype,"setActionStatus",void 0),xe=(0,r.__decorate)([(0,h._)(),(0,r.__param)(0,(0,p.W)(s.K)),(0,r.__param)(1,(0,p.W)(d.g)),(0,r.__param)(2,(0,p.W)(q.E)),(0,r.__param)(3,(0,p.W)(ne.H)),(0,r.__param)(4,(0,p.W)(ve))],xe);class Ae{constructor(){this.imports=[]}get uniqueId(){return(0,T.z)(507918307)}configureRootServices(e){e.bind(ve).to(Se),e.bind(Te.e).to(xe),e.bind(w.S).toExisting(Te.e)}}var De=n(19718),ke=n(73675),Fe=n(52669),Pe=n(79548);let Ne=class extends De.z{constructor(e,t,n,r,i,o){super(),this.languageInfoProvider=e,this.languageDetector=t,this.proofingStore=n,this.hostSettings=r,this.targetRenderElement=i,this.emitter=o,this._proofingLanguageDirCache={},this._defaultProofingLanguageDir=ce.K3.auto,this._uxLanguageDir=ce.K3.auto,this.updateProofingLanguageDir=e=>{this._defaultProofingLanguageDir=this.getLanguageDir(e)},this.updateUxLanguageDir=()=>{const e=this.languageDetector.getUILanguage();this._uxLanguageDir=this.getLanguageDir(e),this.publishEvent("stateUpdated",{uxLanguageDir:this.uxLanguageDir,optionsUxLanguageDir:this.optionsUxLanguageDir})},this.getLanguageDir=e=>{const t=this.languageInfoProvider.getLanguageInfo(e);return t?t.isRtl?ce.K3.rtl:ce.K3.ltr:ce.K3.auto},(0,Ee.Gn)(this),this.updateUxLanguageDir(),this.proofingStore.read(W.l.ProofingLanguages).then((e=>this.updateProofingLanguageDir(Ie.I.getDefaultLanguageCode(e)))).catch((()=>{})),this.emitter&&this.emitter.on("proofingLanguageChanged",(async e=>{e.proofingLanguagesChanged&&this.updateProofingLanguageDir(e.data.defaultLanguageCode)}))}get uxLanguageDir(){return this.hostSettings.manageRtlInEditorUx?this._uxLanguageDir:ce.K3.auto}get optionsUxLanguageDir(){return this._uxLanguageDir}isRtl(){var e,t;if(this.uxLanguageDir!==ce.K3.auto)return this.uxLanguageDir===ce.K3.rtl;const n=null===(e=this.targetRenderElement())||void 0===e?void 0:e.deref();return void 0!==n&&(null!==(t=n.ownerDocument.defaultView)&&void 0!==t?t:window).getComputedStyle(n).direction===ce.K3.rtl}dir(){return this.isRtl()?"rtl":"ltr"}getProofingLanguageDir(e){if(!this.hostSettings.manageRtlForProofingLanguage)return ce.K3.auto;if(!e)return this._defaultProofingLanguageDir;let t=this._proofingLanguageDirCache[e];return t||(t=this.getLanguageDir(e),this._proofingLanguageDirCache[e]=t),t}};(0,r.__decorate)([we.observable],Ne.prototype,"_uxLanguageDir",void 0),(0,r.__decorate)([we.computed],Ne.prototype,"uxLanguageDir",null),(0,r.__decorate)([we.action],Ne.prototype,"updateProofingLanguageDir",void 0),(0,r.__decorate)([we.action],Ne.prototype,"updateUxLanguageDir",void 0),Ne=(0,r.__decorate)([(0,h._)(),(0,r.__param)(0,(0,p.W)(ve)),(0,r.__param)(1,(0,p.W)(ke.v)),(0,r.__param)(2,(0,p.W)(s.K)),(0,r.__param)(3,(0,p.W)(c.n)),(0,r.__param)(4,(0,p.W)(Fe.oA)),(0,r.__param)(5,(0,f.l)()),(0,r.__param)(5,(0,p.W)(Pe.o))],Ne);class Be{constructor(){this.imports=[ue,Ae]}get uniqueId(){return(0,T.z)(507918214)}configureRootServices(e){e.bind(ce.iw).to(Ne),e.bind(w.S).to(fe)}}},61358:(e,t,n)=>{"use strict";n.d(t,{R:()=>o});var r=n(20399),i=n(59834);class o{static logUnhandledError(e,t,n,o){e.logEvent(508055843,n,r.q.Error,o,i.o.SamplingPolicy.CriticalExperimentation,t)}static addUnhandledExceptionsListeners(e,t,n){}}},2070:(e,t,n)=>{"use strict";var r;n.d(t,{s:()=>r}),function(e){e.UnhandledContentError="RunTimeErrors.UnhandledContentError",e.UnhandledBackgroundError="RunTimeErrors.UnhandledBackgroundError",e.UnhandledOptionsPageError="RunTimeErrors.UnhandledOptionsPageError"}(r||(r={}))},82940:(e,t,n)=>{"use strict";n.d(t,{Q:()=>S});var r=n(51504),i=n(96691),o=n(84457),a=n(30206),s=n(20399),l=n(41260),d=n(62070),u=n(88670),c=n(52996),g=n(71234),h=n(48828),p=n(30122),f=n(90424),v=n(26017),m=n(87151);let y=class{constructor(e,t,n,r,i){this._hostEmitters=e,this._hostSettings=t,this._logger=n,this._nudgeStore=r,this._localizer=i,this.onNudgeEvent=e=>{if(!e.message.data.tileId)return void this._logger.log(510248464,s.q.Error,"INudge message: Received undefined args.");const t=e.message.data;t.text=this.getNudgeMessage(t.entityType);const n=Object.assign(Object.assign({eventType:e.message.messageType},t),{nudge:t});this.onEvent(n)},this.messagePerEntityType={[v.c.File]:"nudgeTextForFile",[v.c.People]:"nudgeTextForPeople",[v.c.Event]:"nudgeTextForMeetings",[v.c.Message]:"nudgeTextForEmails"}}async initialize(){if(this._hostSettings.enableOrchestration)for(const e of this._hostEmitters)e.on(l.pD.nudgeTriggered,this.onNudgeEvent)}shutDown(){}async onEvent(e){e.eventType===d.G.NewData?await this._nudgeStore.updateNudge(e.nudge):await this._nudgeStore.clearNudge()}getNudgeMessage(e){var t,n,r;const i=null!==(r=null===(n=null===(t=this._hostSettings.serviceSettings)||void 0===t?void 0:t.nudge)||void 0===n?void 0:n.insertionCharacter)&&void 0!==r?r:"@";return this._localizer.getMessage(this.messagePerEntityType[e],i)}};y=(0,a.__decorate)([(0,h._)(),(0,a.__param)(0,(0,p.t)(l.zJ)),(0,a.__param)(1,(0,f.W)(u.n)),(0,a.__param)(2,(0,f.W)(c.g)),(0,a.__param)(3,(0,f.W)(m.Y)),(0,a.__param)(4,(0,f.W)(g.H))],y);var _=n(49208),b=n(6526),C=n(77148);class S{constructor(){this.imports=[o.d,_.J,r.w]}get uniqueId(){return(0,b.z)(507918280)}configureRootServices(e){e.bind(y).toSelf(),e.bind(C.S).toExisting(y),e.bind(m.Y).to(m.h),e.bind(i.V).to(i.S),e.bind(C.S).toExisting(i.V)}}},40876:(e,t,n)=>{"use strict";var r,i;n.d(t,{Hs:()=>s,Tm:()=>o,EM:()=>a}),(i=r||(r={}))[i.Remote=0]="Remote",i[i.System=1]="System",i[i.User=2]="User";const o=(e,t)=>({name:e,storeEntryType:r.Remote,defaultValue:t,lastValueFromStorage:void 0}),a=(e,t,n)=>({name:e,storeEntryType:r.User,defaultValue:t,lastValueFromStorage:void 0,shouldNotWriteDefaultValue:n});var s;!function(e){e.FeatureFlags="featureFlags",e.DynamicSettings="dynamicSettings"}(s||(s={}))},82757:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(63837).f)("IStoreEntryReader")},15841:(e,t,n)=>{"use strict";n.d(t,{a:()=>r});const r=(0,n(63837).f)("IStoreEntryWriter")},777:(e,t,n)=>{"use strict";n.d(t,{E:()=>r});const r=(0,n(63837).f)("ISettingsEmitterBase")},67760:(e,t,n)=>{"use strict";n.d(t,{p:()=>X});var r=n(46785),i=n(64949),o=n(6526),a=n(88670),s=n(77148),l=n(68165),d=n(30206),u=n(19718),c=n(20399),g=n(59834),h=n(52996),p=n(48828),f=n(90424),v=n(12765),m=n(46600),y=n(99951);let _=class extends y.t{constructor(e){super(e)}checkUserInfo(){return void 0===this.ageGroup||this.ageGroup===v.P2.Adult||this.ageGroup===v.P2.MinorNoParentalConsentRequired||this.ageGroup===v.P2.Unknown}};_=(0,d.__decorate)([(0,p._)(),(0,d.__param)(0,(0,f.W)(m.e))],_);let b=class extends y.t{constructor(e){super(e)}checkUserInfo(){return this.ageGroup===v.P2.NotAdult}};b=(0,d.__decorate)([(0,p._)(),(0,d.__param)(0,(0,f.W)(m.e))],b);let C=class extends y.t{constructor(e){super(e)}checkUserInfo(){return this.ageGroup===v.P2.MinorWithoutParentalConsent||this.ageGroup===v.P2.MinorWithParentalConsent}};C=(0,d.__decorate)([(0,p._)(),(0,d.__param)(0,(0,f.W)(m.e))],C);var S,T,I=n(30225);!function(e){e.RemoteSettingSync="RemoteSettingSync"}(S||(S={})),function(e){e.SettingsSyncWriteError="RunTimeErrors.SettingSyncWriteError",e.SettingsSyncEditorRequestBuildError="RunTimeErrors.SettingsSyncEditorRequestBuildError",e.SettingsSyncEditorServiceError="RunTimeErrors.SettingSyncEditorServiceError",e.SettingsSyncReadOverrideError="RunTimeErrors.SettingSyncReadOverrideError",e.SettingReadError="RunTimeErrors.SettingReadError",e.SettingInitializeError="RunTimeErrors.SettingInitializeError",e.SettingManualOverrideWarning="RunTimeErrors.SettingManualOverrideWarning",e.SettingWriteError="RunTimeErrors.SettingWriteError",e.FeatureFlagParsingError="RunTimeErrors.FeatureFlagParsingError",e.DynamicSettingsParsingError="RunTimeErrors.DynamicSettingsParsingError"}(T||(T={}));var w=n(777),E=n(82757),x=n(40876);const A={enableConflictDetectionAnnouncement:!1,enableUpsellFeature:!1,enableMultiLanguageAnnouncement:!1,enableNotifications:!1,enableOptimizedCallingPattern:!1,enableOptimizedRehydration:!1,enablePostUpsellAnnouncement:!1,enableInternalMailFeedback:!1,enableOrchestration:!1,enableV2RoamingDictionary:!1,enableSignInAnnouncement:!1,enableSignInAnnouncementAlternativeText:!1,enableRateExtensionPrompt:!1,enableRateExtensionPromptEdge:!1,enableRateExtensionPromptFpsSurvey:!1,enableEnhancedUpsell:!1,enablePremiumPreview:!1,enableUnsignedInEditor:!1,enableSuppressUnsignedInEditorForMultiLang:!1,enableCritiqueSettings:!1,enableOcvIntEndpoint:!1,enableOcvFeedbackUi:!1,enableE2eMetric:!1,enableKeptMetric:!1,enableAriaStatusElement:!1,enableCssHighlightApiAnnouncementsOnly:!1,enableLineNavAriaAnnouncement:!1,enableCSSHighlightApiSquiggleRendering:!1,enableVisibilityTracker:!1,enableSquigglesUpdateThrottling:!1,mutationObserverBasedRelativePosition:!1,visibilityTrackerShouldTrackSquiggles:!0,enableCursorIntersectionObserver:!1,isMsitUser:!1,enableDispatchCritiquesOnEmptyDiffs:!0,enableSignInAnnouncementReshownWeekly:!1,enableSignInAnnouncementReshownBiweekly:!1,enableSignInAnnouncementReshownMonthly:!1,enableTargetedUpsell:!1,inferenceCritiqueCloudIconEnabled:!1,enableAutoCorrect:!1,enablePersonalizedAutoCorrect:!1,enableParagraphUpdates:!1,enableForceClearCritiques:!0,enableConditionalSignInMessage:!1,disableCalcLengthForAddDeltasInPresentation:!0,enableAnnotationActivationConfig:!0,enableAutoCorrectInputCache:!1,enableBetaExperience:!1,enableRoamingService:!1,enableWacCrossPromo:!1,enableAriaStatusPostMessage:!1,enableAriaStatusInNonRootIFrames:!1,enablePhraseTextUnitClientSide:!1,enableAadc:!1,enableBetaExperienceTelemetry:!1,enableUserDictionaryAnnouncement:!1,enableParagraphDeltas:!1,enableOrchestratorOverriddenCritiqueTypeOptions:!1,enableOrchestratorCritiqueDeletion:!1,enableRequiredServiceDataOnly:!1,disableBxOptionalPrivacySetting:!1,enableParagraphDeltasVerboseLogging:!1,enableParagraphDeltasEmptyInitialTile:!1,enableGDocsAnnotatedCanvas:!1,disableTileNodeObserver:!1,enableQueryOnlyOnLocalChange:!1,enableSvgSquiggleUnderline:!1,enableEditorServiceRouting:!1,enableCopywriter:!1,disableCalloutOnDoubleClick:!1,disableAutoBrowserVirtualizationOfSquiggles:!1,enableGDocsSuppressNativeSquiggles:!1,enableUserInfoCountry:!1,enableNonProveableElements:!0,enableSynonyms:!1,enableAiInsert:!1,enableAiInsertForInputTexarea:!1,enableSquigglesOnlyOnWholeWords:!1,disableECCMenuRecreationOnALReconnection:!1,enableLoggingModulesAndBindings:!1,enableResignInPrompt:!1,enableMagicWindow:!1,enableAttributionRangeExceptionInFormattedTextDeltas:!1,enableAttributionRangeInAddDelta:!1};let D=class{constructor(e,t,n,r,i,o){this._emitter=e,this._storeEntryReader=t,this._logger=n,this._isAdult=r,this._isMinor=i,this._isChild=o,this._defaultAdultOnlyFeature={enableUpsellFeature:!0},this._defaultMinorAndAboveFeature={enableBxTelemetry:!0,enableRateExtensionPrompt:!0,enableRateExtensionPromptEdge:!0,enableRateExtensionPromptFpsSurvey:!0,enableOcvIntEndpoint:!0,enableOcvFeedbackUi:!0,enableUninstallSurvey:!0},this._defaultFeatureFlags=Object.assign(Object.assign(Object.assign({},this._defaultMinorAndAboveFeature),this._defaultAdultOnlyFeature),A),this._rolloutFeatureFlags=(0,x.Tm)(x.Hs.FeatureFlags,A),this._localFlags=Object.assign({},this._defaultFeatureFlags),this._flagOverrides={},this.updatedAdultOnlyFeatureFlags=e=>{var t;const n=!this.areAgeGroupPredicatesProvided()||!!(null===(t=this._isAdult)||void 0===t?void 0:t.check()),r=Object.assign({},this._defaultAdultOnlyFeature);for(const t in this._defaultAdultOnlyFeature)r[t]=n&&e[t];return r},this.updateMinorAndAboveFeatureFlags=e=>{var t,n;const r=!this.areAgeGroupPredicatesProvided()||!!(null===(t=this._isMinor)||void 0===t?void 0:t.check())||!!(null===(n=this._isAdult)||void 0===n?void 0:n.check()),i=Object.assign({},this._defaultMinorAndAboveFeature);for(const t in this._defaultMinorAndAboveFeature)i[t]=r&&e[t];return i},this.areAgeGroupPredicatesProvided=()=>!!(this._isAdult&&this._isChild&&this._isMinor),this._eventPublisher=new u.z}get flags(){return this._localFlags}overrideFlags(e){this._flagOverrides=e,this.applyFlagOverrides()}applyFlagOverrides(){this._localFlags=Object.assign(Object.assign({},this._localFlags),this._flagOverrides)}async refreshFlags(){return await this.updateFlags(),this.flags}async initialize(){this._emitter.on(x.Hs.FeatureFlags,(()=>{this.updateFlags()})),await this.updateFlags()}shutDown(){}async updateFlags(){try{const e=await this._storeEntryReader.readOrInitialize(this._rolloutFeatureFlags);let t=Object.assign(Object.assign({},this._defaultFeatureFlags),...Object.entries(e).map((([e,t])=>{return{[e]:(n=t,"string"==typeof n?"true"===n.toLowerCase():!0===n)};var n})));if(t.enableAadc){const e=this.updateMinorAndAboveFeatureFlags(t),n=this.updatedAdultOnlyFeatureFlags(t);t=Object.assign(Object.assign(Object.assign({},t),e),n)}this._localFlags=t,this.applyFlagOverrides(),this.publishEvent("flagsChanged",this.flags)}catch(e){this._logger.logEvent(571318787,T.FeatureFlagParsingError,c.q.Error,void 0,g.o.SamplingPolicy.Diagnostics)}}subscribe(e,t){this._eventPublisher.subscribe(e,t)}unsubscribe(e,t){this._eventPublisher.unsubscribe(e,t)}publishEvent(e,t){this._eventPublisher.publishEvent(e,t)}};D=(0,d.__decorate)([(0,p._)(),(0,d.__param)(0,(0,f.W)(w.E)),(0,d.__param)(1,(0,f.W)(E.A)),(0,d.__param)(2,(0,f.W)(h.g)),(0,d.__param)(3,(0,I.l)()),(0,d.__param)(3,(0,f.W)(_)),(0,d.__param)(4,(0,I.l)()),(0,d.__param)(4,(0,f.W)(b)),(0,d.__param)(5,(0,I.l)()),(0,d.__param)(5,(0,f.W)(C))],D);var k,F=n(63837);!function(e){e.LocalStorageApi="LocalStorageApi"}(k||(k={}));const P=(0,F.f)("IBrowserStorageApi");var N,B=n(68081),O=n(15841),R=n(16488);let L=N=class{constructor(){this.eventListener=new R.J(document)}async initialize(){}shutDown(){this.eventListener.removeAllListeners()}async set(e){const t=Object.keys(e),n={};for(const r of t){const t=e[r];n[r]={oldValue:localStorage.getItem(r),newValue:t};try{localStorage.setItem(r,t)}catch(e){return Promise.reject(e)}}const r=new CustomEvent("storageItemInserted",{detail:n});return document.dispatchEvent(r),Promise.resolve()}async remove(e){if("string"==typeof e)localStorage.removeItem(e);else if(Array.isArray(e))for(const t of e)localStorage.removeItem(t);return Promise.resolve()}async get(e){const t={};if("string"==typeof e)t[e]=N._getItem(e);else if(Array.isArray(e))for(const n of e)t[n]=N._getItem(n);else if(e instanceof Object){const n=Object.keys(e);for(const r of n){const n=N._getItem(r);t[r]=n||e[r]}}return Promise.resolve(t)}addChangeListener(e){this.eventListener.addListener("storageItemInserted",(t=>{t.detail&&e(t.detail,"")}))}removeEventListener(e){this.eventListener.removeAllListeners()}static _getItem(e){const t=localStorage.getItem(e);if(t)try{const e=JSON.parse(t);return void 0!==e.value&&e.lastUpdated&&void 0!==e.manualOverride?t:e}catch(e){return t}return null}};L=N=(0,d.__decorate)([(0,p._)()],L);let M=class{constructor(e){this._browserStorage=e,this.registrations={},this.eventNamesUsed=new Set,this._storageChangeDispatcherCallback=async(e,t)=>this._storageChangeDispatcher(e,t)}safelyGetRegistration(e){return this.registrations[e]||(this.registrations[e]={listeners:[]}),this.registrations[e]}on(e,t){this.safelyGetRegistration(e).listeners.push(t),this.eventNamesUsed.add(e)}async initialize(){this._browserStorage.addChangeListener(this._storageChangeDispatcherCallback)}shutDown(){this._browserStorage.removeEventListener(this._storageChangeDispatcherCallback);for(const e of this.eventNamesUsed)try{this.off(e)}catch(e){}}_storageChangeDispatcher(e,t){for(const t of Object.keys(e)){const n=JSON.parse(e[t].oldValue),r=JSON.parse(e[t].newValue);(null==n?void 0:n.value)!==(null==r?void 0:r.value)&&this.callListeners(t,e[t].newValue)}}callListeners(e,t){const n=e,r=this.safelyGetRegistration(n);for(const e of r.listeners)e(t)}onFirst(e,t){throw Error("onFirst is not implemented for SettingsEmitter")}onAny(e){throw Error("onAny is not implemented for SettingsEmitter")}async waitFor(e){throw Error("waitForFirst is not implemented for SettingsEmitter")}async waitForFirst(e){throw Error("waitForFirst is not implemented for SettingsEmitter")}off(e,t){if(void 0!==e)if(void 0!==t){if(!((e,t)=>{let n=!1;for(let r=0;r<e.length;r+=1)e[r]===t&&(n=!0,e.splice(r,1),r-=1);return n})(this.safelyGetRegistration(e).listeners,t))throw new Error(`Tried to remove a non-existent listener for event name '${e}'.`)}else this.registrations[e]={listeners:[]};else this.registrations={}}emit(e,...t){const n=this.safelyGetRegistration(e);for(const e of n.listeners)e(...t)}};M=(0,d.__decorate)([(0,p._)(),(0,d.__param)(0,(0,f.W)(P))],M);let q=class{constructor(e){this._extensionStorage=e}getLastError(){return this._lastError}setLastError(e){this._lastError=e}async writeSetting(e,t){const n={value:JSON.stringify(t),lastUpdated:Date.now(),manualOverride:!1},r={};r[e]=JSON.stringify(n),await this._extensionStorage.set(r)}};q=(0,d.__decorate)([(0,p._)(),(0,d.__param)(0,(0,f.W)(P))],q);let W=class extends q{constructor(e,t){super(e),this._logger=t}async readOrInitialize(e){try{const t=await this.readStoredSetting(e);if(t){if(t.value){const n=JSON.parse(t.value);return t.manualOverride&&void 0!==n?n:(e.lastValueFromStorage=n,void 0!==n?n:e.defaultValue)}}else try{return e.shouldNotWriteDefaultValue||await this.writeSetting(e.name,e.defaultValue),e.defaultValue}catch(e){this._logger.logEvent(521479644,T.SettingInitializeError,c.q.Error,void 0,g.o.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}}catch(e){this._logger.logEvent(521479643,T.SettingReadError,c.q.Error,void 0,g.o.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}return void 0!==e.lastValueFromStorage?e.lastValueFromStorage:e.defaultValue}async readLastUpdatedTimestamp(e){try{const t=await this.readStoredSetting(e);if(t)return t.lastUpdated}catch(e){this._logger.logEvent(521479642,T.SettingReadError,c.q.Error,void 0,g.o.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}}async readStoredSetting(e){const t=await this._extensionStorage.get(e.name);if(t[e.name])return JSON.parse(t[e.name])}};W=(0,d.__decorate)([(0,p._)(),(0,d.__param)(0,(0,f.W)(P)),(0,d.__param)(1,(0,f.W)(h.g))],W);let U=class extends q{constructor(e,t){super(e),this._logger=t}async write(e,t){try{let n=!1;const r=await this._extensionStorage.get(e.name);r[e.name]&&(n=JSON.parse(r[e.name]).manualOverride),n?this._logger.logEvent(521479641,T.SettingManualOverrideWarning,c.q.Warn,`manual override for store entry ${e.name} - writing skipped`,g.o.SamplingPolicy.Measure):await this.writeSetting(e.name,t)}catch(e){this._logger.logEvent(521479640,T.SettingWriteError,c.q.Error,void 0,g.o.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}}async remove(e){await this._extensionStorage.remove(e)}};U=(0,d.__decorate)([(0,p._)(),(0,d.__param)(0,(0,f.W)(P)),(0,d.__param)(1,(0,f.W)(h.g))],U);class z{constructor(){this.imports=[]}get uniqueId(){return(0,o.z)(507918231)}configureRootServices(e){e.bind(B.c).to(D),e.bind(s.S).toExisting(B.c),e.bind(E.A).to(W),e.bind(O.a).to(U),e.bind(P).to(L),e.bind(s.S).toExisting(P),e.bind(w.E).to(M),e.bind(s.S).toExisting(w.E)}}var j=n(95988),H=n(58964),V=n(79421),G=n(60685),Q=n(40245),K=n(81714);function $(e){const t={value:JSON.stringify(e),lastUpdated:Date.now(),manualOverride:!1};return JSON.stringify(t)}function Z(e){return{descriptors:$(e.descriptors),disabledWebSites:$(e.disabledWebSites),allowedUrls:$(e.allowedUrls),disabledGrammars:$(e.disabledGrammars),editorClientState:$(e.editorClientState),configurationId:$(e.configurationId),featureFlags:$(e.featureFlags),dynamicSettings:$(e.dynamicSettings),intervalForActivityCleanup:$(e.intervalForActivityCleanup),conflictingElements:$(e.conflictingElements)}}let J=class extends q{constructor(e,t,n,r,i,o,a,s){super(e),this._editorService=t,this._proofingStore=n,this._logger=r,this._userInfoStrategy=i,this._sessionContextProvider=o,this._guidGenerator=a,this._timer=s,this._timerName="RemoteSettingsSyncerTimer"}async initialize(){}shutDown(){this._timer.clearTimer(this._timerName)}schedule(e,t){this._timer.setIntervalWithDelay(this._timerName,(async()=>this.sync()),t,e)}async sync(){this._logger.debug(537518984,"Starting remote settings sync");const e=await this.buildRequest();if(e){const t=await this.fetchRemoteSettings(e);if(t&&t.responseStatus===j.ED.Success){this.logTelemetry(e);const n=Z(t),r=await this.removeManualOverrides(n);if(r)return this._logger.debug(537518985,"Writing remote settings to local storage"),this.writeSettings(r)}}return this._logger.debug(537518986,"No remote settings were synced"),!1}async writeSettings(e){try{return await this._extensionStorage.set(e),!0}catch(e){this._logger.logEvent(537518987,T.SettingsSyncWriteError,c.q.Error,void 0,g.o.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}return!1}async fetchClientId(){try{const e=await this._proofingStore.read(H.l.ClientId);if(!e||""===e){const e=this._guidGenerator.generate();return await this._proofingStore.write(H.l.ClientId,e),e}return e}catch(e){return""}}async buildRequest(){var e;try{const t=await this._sessionContextProvider();let n,r;const i=await this.fetchClientId(),o=await this._userInfoStrategy.executeAsync(!1);return(null==o?void 0:o.userId)?(this._editorService.xUserId=o.userId,n=o.tenantId,r=o.email):this._editorService.xUserId=i,{appId:await this._proofingStore.read(H.l.AppId),browser:t.browserType,browserVersion:null!==(e=t.browserVersion)&&void 0!==e?e:"",email:r,extensionId:t.extensionVersion,languageUxId:t.languageUxId,storeId:t.extensionStoreId,tenantId:n,firstInstallVersion:void 0}}catch(e){this._logger.logEvent(537518988,T.SettingsSyncEditorRequestBuildError,c.q.Error,void 0,g.o.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}}logTelemetry(e){if(this._lastConfigRequestUserId&&this._lastConfigRequestUserId===this._editorService.xUserId&&this._lastConfigRequest&&this._lastConfigRequest.browserVersion===e.browserVersion&&this._lastConfigRequest.email===e.email&&this._lastConfigRequest.languageUxId===e.languageUxId&&this._lastConfigRequest.tenantId===e.tenantId)return;this._lastConfigRequest=e,this._lastConfigRequestUserId=this._editorService.xUserId;const t=this._logger.getNewActivity(S.RemoteSettingSync,g.o.SamplingPolicy.CriticalExperimentation);t&&(t.success=!0,t.endNow())}async fetchRemoteSettings(e){var t;try{return await this._editorService.browserextension(e,{requestOptions:{customHeaders:{"X-UserId":null!==(t=this._editorService.xUserId)&&void 0!==t?t:""}}})}catch(e){this._logger.logEvent(537518989,T.SettingsSyncEditorServiceError,c.q.Error,void 0,g.o.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}}async removeManualOverrides(e){const t={};try{const n=await this._extensionStorage.get(e);for(const r of Object.keys(n))JSON.parse(n[r]).manualOverride?this._logger.debug(537518990,"Manual override for remote setting",r):t[r]=e[r]}catch(e){return this._logger.logEvent(537518991,T.SettingsSyncReadOverrideError,c.q.Error,void 0,g.o.SamplingPolicy.CriticalBusinessImpact,e),void this.setLastError(e)}return t}async removePersistentKeys(){const e=Object.keys(Z({}));e.length&&await this._extensionStorage.remove(e)}};J=(0,d.__decorate)([(0,p._)(),(0,d.__param)(0,(0,f.W)(P)),(0,d.__param)(1,(0,f.W)(r.qq)),(0,d.__param)(2,(0,f.W)(V.K)),(0,d.__param)(3,(0,f.W)(h.g)),(0,d.__param)(4,(0,f.W)(m.e)),(0,d.__param)(5,(0,f.W)(G.a)),(0,d.__param)(6,(0,f.W)(Q.G)),(0,d.__param)(7,(0,f.W)(K.J))],J);class X{constructor(){this.imports=[z,i.k]}get uniqueId(){return(0,o.z)(507918238)}configureRootServices(e){e.bind(r.qq).toDynamicValue((e=>{const t=e.get(a.n);return new r.qq({endpoint:`https://${t.editorEndPoint}/NLEditor`})})),e.bind(l.$).to(J),e.bind(s.S).toExisting(l.$)}}},68165:(e,t,n)=>{"use strict";n.d(t,{$:()=>r});const r=(0,n(63837).f)("IRemoteSettingsSyncer")},78175:(e,t,n)=>{"use strict";function r(e){var t;if(e)return"true"===(null===(t=e.contentEditable)||void 0===t?void 0:t.toLowerCase())?e:r(e.parentElement)}n.d(t,{m:()=>r})},32942:(e,t,n)=>{"use strict";n.d(t,{B:()=>h,a:()=>s});var r=n(30206),i=n(48828),o=n(24546);const a=new Set(["¡","¦","§","©","«","¬","®","°","±","»","¿","×","÷","ǃ",";"," ","‰","‹","›","‼","‽","⁈","⁉","⁠","℃","℅","℆","℉","№","™","∑","−","√","∞","∫","≈","≠","≤","≥","□","▪","▫","◊","●","◦","❢","。","\ufeff","！","．","；","？","｡"]);let s=class{constructor(){this.supportsBrowserWordBreaking=!1}getForwardBreakByWord(e,t){let n=this.getForwardBreak(e,t);return"WhiteSpace"===(null==n?void 0:n.wordBreakType)&&(n=this.getForwardBreak(e,n.cp)),n?n.cp:e.length}getBackwardBreakByWord(e,t){let n=this.getBackwardBreak(e,t);return"WhiteSpace"===(null==n?void 0:n.wordBreakType)&&(n=this.getBackwardBreak(e,n.cp)),n?n.cp:0}getForwardBreak(e,t){return this.getForwardBreakInternal(e,t,e.length)}getBackwardBreak(e,t){if(t<=1)return;let n=t;for(;n>0;){const t=d(e,n-1);switch(t){case"Undetermined":break;case"AlphaNumeric":case"Punctuation":case"WhiteSpace":case"PuncuationWithoutBreak":case"FootnoteEndnotePunctuation":{if(n<=1)return;const r=n-1,i=d(e,r-1);if(t!==i&&l(t,i)&&("Undetermined"!==i||!this.supportsBrowserWordBreaking))return{cp:r,wordBreakType:t};break}}n-=1}}getTextStartWordBreak(e){return this.getTextWordBreak(e,0)}getTextWordBreak(e,t){return{cp:t,wordBreakType:d(e,t)}}getBreaks(e){const t=this.getBreaksForRange(e,0,e.length);return e.length&&t.splice(0,0,this.getTextStartWordBreak(e)),t}getBreaksForRange(e,t,n){const r=[];if(!e)return r;let i,o=t;do{i&&(r.push(i),o=i.cp),i=this.getForwardBreakInternal(e,o,n)}while(i);return r}getWordCount(e,t){return this.getWordCountFromWordBreaks(e,t).wordCount}getWordCountInRange(e,t,n){return this.getWordCountAndBreaksInRange(e,t,n).wordCount}getWordCountAndBreaksInRange(e,t,n){const r=this.getBreaksForRange(e,t,n);return r.splice(0,0,this.getTextWordBreak(e,t)),{wordCount:this.getWordCount(r,e),wordBreaks:r}}getWordCountWithBoundariesAndBreaksInRange(e,t,n){const r=this.getBreaksForRange(e,t,n);r.splice(0,0,this.getTextWordBreak(e,t));const i=this.getWordCountFromWordBreaks(r,e);return{wordCount:i.wordCount,wordBoundaries:i.wordBoundaries,wordBreaks:r}}getWordCountFromWordBreaks(e,t){const n={browserWordBreakCount:0,wordCount:0,wordBoundaries:[]};let r;for(let i=0;i<e.length;i+=1){const o=e[i];"AlphaNumeric"===o.wordBreakType||"Undetermined"===o.wordBreakType?("Undetermined"===o.wordBreakType&&(n.browserWordBreakCount+=1),u(i,e,t)&&(n.wordCount+=1,r=o.cp)):(void 0!==r&&(n.wordBoundaries.push({start:r,end:o.cp-1}),r=void 0),"Punctuation"!==o.wordBreakType&&"PuncuationWithoutBreak"!==o.wordBreakType||!c(i,e,t)||(n.wordCount+=1))}return void 0!==r&&n.wordBoundaries.push({start:r,end:t.length-1}),n}getForwardBreakInternal(e,t,n){if(t>=n-1)return;let r=t;for(;r<n;){const t=d(e,r);switch(t){case"Undetermined":case"Ignore":break;case"AlphaNumeric":case"Punctuation":case"WhiteSpace":case"PuncuationWithoutBreak":case"FootnoteEndnotePunctuation":{if(r>=n-1)return;let i=r+1,o=d(e,i);for(;"Ignore"===o;){if(i+=1,i>=n)return;o=d(e,i)}if(t!==o&&l(t,o)&&("Undetermined"!==o||!this.supportsBrowserWordBreaking))return{cp:i,wordBreakType:o};break}}r+=1}}};function l(e,t){return"PuncuationWithoutBreak"===e&&"AlphaNumeric"!==t||"AlphaNumeric"===e&&"PuncuationWithoutBreak"!==t||"Punctuation"===e||"FootnoteEndnotePunctuation"===e||"WhiteSpace"===e}function d(e,t){const n=e.charAt(t).toString();return o.Fc(n)?"AlphaNumeric":function(e){const t=e.charCodeAt(0);return t>=0&&t<=31||32===t||t>=127&&t<=159||160===t||t>=8192&&t<=8202||8239===t||8287===t||9248===t||t>=9250&&t<=9252||12288===t||65282===t}(n)?"WhiteSpace":h(n)?"Punctuation":function(e){return"'"===e||"‘"===e||"’"===e}(n)?"PuncuationWithoutBreak":function(e){return""===e}(n)?"FootnoteEndnotePunctuation":function(e){return"​"===e||"‌"===e}(n)?"Ignore":"Undetermined"}function u(e,t,n){if(!e)return!0;const r=t[e];if(!r.cp)return!0;const i=t[e-1];let o=!0;if("Punctuation"===i.wordBreakType){let e=!1;for(let t=i.cp;t<r.cp;t+=1){const r=n.charAt(t);if("-"===r){if(e)return!0;e=!0}else e=!1;if(o=g(r),o)return!0}}else if("Undetermined"===i.wordBreakType)return!1;return("Undetermined"!==r.wordBreakType||"WhiteSpace"===i.wordBreakType)&&o}function c(e,t,n){const r=t[e];if(g(n.charAt(r.cp)))return!1;if(!e)return!0;if(!r.cp)return!1;const i=t[e-1];return"WhiteSpace"===i.wordBreakType||"FootnoteEndnotePunctuation"===i.wordBreakType}function g(e){return"–"===e||"—"===e}function h(e){return!!a.has(e)||e>="!"&&e<="$"||e>="("&&e<="/"||e>=":"&&e<="@"||e>="["&&e<="`"||e>="{"&&e<="~"||e>="‒"&&e<="―"||e>="‚"&&e<="•"||e>="․"&&e<="…"||e>="☹ "&&e<="☻"||e>="〝 "&&e<="〟"}s=(0,r.__decorate)([(0,i._)()],s)},77145:(e,t,n)=>{"use strict";n.d(t,{x:()=>o});var r=n(23597),i=n(27139);class o{static createEvaluator(e,t,n,r,i){return a=>o.isKey(a,e,t,n,r,i)}static isKey(e,t,n,i,a,s){if(void 0!==n&&e.altKey!==n||void 0!==i&&e.ctrlKey!==i||void 0!==a&&e.metaKey!==a||void 0!==s&&e.shiftKey!==s)return!1;if(Array.isArray(t))return t.some((t=>o.isKey(e,t,n,i,a,s)));if(e.key===t)return!0;if(t in r.c){const n=r.c[t];return e.which===n||e.keyCode===n}return!1}}o.isEnterKey=e=>{const t=i.m.enter;return o.isKey(e,t)},o.isEnterOrSpaceKey=e=>{const t=i.m.enter,n=i.m.space;return o.isKey(e,[t,n])},o.isEscapeKey=e=>{const t=i.m.escape;return o.isKey(e,t)},o.focusIfEscapeKey=e=>{o.isKey(e,i.m.escape)&&(e.currentTarget.focus(),e.stopPropagation())},o.isSpaceKey=e=>{const t=i.m.space;return o.isKey(e,t)}},27139:(e,t,n)=>{"use strict";var r;n.d(t,{m:()=>r}),function(e){e.arrowDown="ArrowDown",e.arrowLeft="ArrowLeft",e.arrowRight="ArrowRight",e.arrowUp="ArrowUp",e.backspace="Backspace",e.delete="Delete",e.control="Control",e.enter="Enter",e.escape="Escape",e.space=" ",e.tab="Tab",e.home="Home",e.end="End",e.j="j",e.r="r",e.t="t",e.J="J",e.R="R",e.T="T"}(r||(r={}))},16715:(e,t,n)=>{"use strict";n.d(t,{d:()=>i});var r=n(38883);const i=(e,t)=>{r.render(t,e)}},69913:(e,t,n)=>{"use strict";var r;n.d(t,{k:()=>r}),function(e){e[e.ContextualCard=0]="ContextualCard"}(r||(r={}))},15863:(e,t,n)=>{"use strict";n.d(t,{h:()=>i});var r=n(4413);function i(){return(0,r.A)()}},71115:(e,t,n)=>{"use strict";n.d(t,{k:()=>o,p:()=>i});var r=n(63837);const i=(0,r.f)("IContainer"),o=(0,r.f)("IResolveNew")},8676:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(9028);class i{constructor(e,t,n){this.injectionIdentifier=e,this.isOptional=t,this.isArray=n}resolveFrom(e){if(!this.shouldSkipResolving(e))return this.isArray?this.resolveArray(e):this.resolveSingular(e)}resolveSingular(e){return this.isOptional?e.getOptional(this.injectionIdentifier):e.get(this.injectionIdentifier)}resolveArray(e){if(!this.isOptional&&!e.isBound(this.injectionIdentifier))throw new Error("No matching bindings found for serviceIdentifier: "+this.injectionIdentifier.toString());return e.getAll(this.injectionIdentifier)}isBoundTo(e){return!!e.isBound(this.injectionIdentifier)}setupBinding(e,t){if(this.isArray&&Array.isArray(t))for(const n of t)this.setupSingleBinding(e,n);else this.setupSingleBinding(e,t)}setupSingleBinding(e,t){const n=e.bind(this.injectionIdentifier);(0,r.C)(t)?n.to(t):n.toValue(t)}toString(){const e={};return e.identifier=this.injectionIdentifier instanceof Function?this.injectionIdentifier.name:this.injectionIdentifier.toString(),this.isOptional&&(e.isOptional=this.isOptional),this.isArray&&(e.isArray=this.isArray),`ConfiguredDep(${JSON.stringify(e)})`}shouldSkipResolving(e){return!!this.isOptional&&!this.isBoundTo(e)}}class o{constructor(e,t){this._isOptional=!1,this._injectionIdentifier=e,this._isArray=t}static on(e){return new o(e,!1)}static onAll(e){return new o(e,!0)}optional(){return this._isOptional=!0,this}build(){return new i(this._injectionIdentifier,this._isOptional,this._isArray)}}},9028:(e,t,n)=>{"use strict";n.d(t,{C:()=>i});const r=new(n(29688).P);function i(e){return e instanceof Function&&!!r.getConstructorMetadata(e).compilerGeneratedMetadata}},37842:(e,t,n)=>{"use strict";n.d(t,{F5:()=>o,KN:()=>a,SM:()=>s});var r=n(19635),i=n(95734);function o(e){const t={};for(const n of Object.keys(e)){const r=e[n];t[n]=r.build()}return t}function a(e){const t=(0,r.G)();return(0,i.useMemo)((()=>{const n={};for(const r of Object.keys(e))n[r]=e[r].resolveFrom(t);return n}),[t,e])}function s(e){const t=(0,r.N)();return(0,i.useMemo)((()=>{const n={};for(const r of Object.keys(e))n[r]=t&&e[r].resolveFrom(t);return n}),[t,e])}},53756:(e,t,n)=>{"use strict";n.d(t,{E:()=>o,r:()=>a});var r=n(42727),i=n(95734);class o extends r.z{constructor(e,t){super(e,t)}onAddModule(e){var t;"configureScopedServices"in e?null===(t=e.configureScopedServices)||void 0===t||t.call(e,this.container):"scopedProviders"in e&&e.scopedProviders&&this.bindProvidersToContainer(this.container,e.scopedProviders)}}const a=(0,i.createContext)(void 0)},42727:(e,t,n)=>{"use strict";n.d(t,{z:()=>Ae});var r="Request",i="Singleton",o="Transient",a={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"},s={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"},l=0;function d(){return l++}var u=function(){function e(e,t){this.id=d(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=a.Invalid,this.constraint=function(e){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.onDeactivation=null,this.dynamicValue=null}return e.prototype.clone=function(){var t=new e(this.serviceIdentifier,this.scope);return t.activated=t.scope===i&&this.activated,t.implementationType=this.implementationType,t.dynamicValue=this.dynamicValue,t.scope=this.scope,t.type=this.type,t.factory=this.factory,t.provider=this.provider,t.constraint=this.constraint,t.onActivation=this.onActivation,t.onDeactivation=this.onDeactivation,t.cache=this.cache,t},e}(),c=n(5e3),g=n(61647),h=n(29688),p={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};function f(e){return e instanceof RangeError||e.message===c.U_}function v(e){return"function"==typeof e?e.name:"symbol"==typeof e?e.toString():e}function m(e,t,n){var r="",i=n(e,t);return 0!==i.length&&(r="\nRegistered bindings:",i.forEach((function(e){var t="Object";null!==e.implementationType&&(t=b(e.implementationType)),r=r+"\n "+t,e.constraint.metaData&&(r=r+" - "+e.constraint.metaData)}))),r}function y(e,t){return null!==e.parentRequest&&(e.parentRequest.serviceIdentifier===t||y(e.parentRequest,t))}function _(e){e.childRequests.forEach((function(e){if(y(e,e.serviceIdentifier)){var t=function(e){return function e(t,n){void 0===n&&(n=[]);var r=v(t.serviceIdentifier);return n.push(r),null!==t.parentRequest?e(t.parentRequest,n):n}(e).reverse().join(" --\x3e ")}(e);throw new Error(c.ML+" "+t)}_(e)}))}function b(e){if(e.name)return e.name;var t=e.toString(),n=t.match(/^function\s*([^\s(]+)/);return n?n[1]:"Anonymous function: "+t}var C=function(){function e(e){this.id=d(),this.container=e}return e.prototype.addPlan=function(e){this.plan=e},e.prototype.setCurrentRequest=function(e){this.currentRequest=e},e}(),S=n(15348),T=function(e,t){this.parentContext=e,this.rootRequest=t},I=function(){function e(e){this._cb=e}return e.prototype.unwrap=function(){return this._cb()},e}(),w=function(){function e(e){this.str=e}return e.prototype.startsWith=function(e){return 0===this.str.indexOf(e)},e.prototype.endsWith=function(e){var t,n=e.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},n)},e.prototype.contains=function(e){return-1!==this.str.indexOf(e)},e.prototype.equals=function(e){return this.str===e},e.prototype.value=function(){return this.str},e}(),E=function(){function e(e,t,n,r){this.id=d(),this.type=e,this.serviceIdentifier=n;var i="symbol"==typeof t?t.toString().slice(7,-1):t;this.name=new w(i||""),this.identifier=t,this.metadata=new Array;var o=null;"string"==typeof r?o=new S.O(g.P7,r):r instanceof S.O&&(o=r),null!==o&&this.metadata.push(o)}return e.prototype.hasTag=function(e){for(var t=0,n=this.metadata;t<n.length;t++)if(n[t].key===e)return!0;return!1},e.prototype.isArray=function(){return this.hasTag(g.jf)},e.prototype.matchesArray=function(e){return this.matchesTag(g.jf)(e)},e.prototype.isNamed=function(){return this.hasTag(g.P7)},e.prototype.isTagged=function(){return this.metadata.some((function(e){return g.eV.every((function(t){return e.key!==t}))}))},e.prototype.isOptional=function(){return this.matchesTag(g.Q2)(!0)},e.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter((function(e){return e.key===g.P7}))[0]:null},e.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter((function(e){return g.eV.every((function(t){return e.key!==t}))})):null},e.prototype.matchesNamedTag=function(e){return this.matchesTag(g.P7)(e)},e.prototype.matchesTag=function(e){var t=this;return function(n){for(var r=0,i=t.metadata;r<i.length;r++){var o=i[r];if(o.key===e&&o.value===n)return!0}return!1}},e}(),x=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};function A(e,t,n,r){var i=e.getConstructorMetadata(n),o=i.compilerGeneratedMetadata;if(void 0===o){var a=c.z4+" "+t+".";throw new Error(a)}var s=i.userGeneratedMetadata,l=Object.keys(s),d=0===n.length&&l.length>0,u=l.length>n.length,g=function(e,t,n,r,i){for(var o=[],a=0;a<i;a++){var s=D(a,e,t,n,r);null!==s&&o.push(s)}return o}(r,t,o,s,d||u?l.length:n.length),h=F(e,n,t);return x(x([],g,!0),h,!0)}function D(e,t,n,r,i){var o=i[e.toString()]||[],a=N(o),l=!0!==a.unmanaged,d=r[e];if((d=a.inject||a.multiInject||d)instanceof I&&(d=d.unwrap()),l){if(!t&&(d===Object||d===Function||void 0===d)){var u=c.Ds+" argument "+e+" in class "+n+".";throw new Error(u)}var g=new E(s.ConstructorArgument,a.targetName,d);return g.metadata=o,g}return null}function k(e,t,n,r){var i=e||t;if(void 0===i){var o=c.z4+" for property "+String(n)+" in class "+r+".";throw new Error(o)}return i}function F(e,t,n){for(var r=e.getPropertiesMetadata(t),i=[],o=Object.getOwnPropertySymbols(r),a=0,l=Object.keys(r).concat(o);a<l.length;a++){var d=l[a],u=r[d],c=N(u),g=c.targetName||d,h=k(c.inject,c.multiInject,d,n),p=new E(s.ClassProperty,g,h);p.metadata=u,i.push(p)}var f=Object.getPrototypeOf(t.prototype).constructor;if(f!==Object){var v=F(e,f,n);i=x(x([],i,!0),v,!0)}return i}function P(e,t){var n=Object.getPrototypeOf(t.prototype).constructor;if(n!==Object){var r=A(e,b(n),n,!0),i=r.map((function(e){return e.metadata.filter((function(e){return e.key===g.Af}))})),o=[].concat.apply([],i).length,a=r.length-o;return a>0?a:P(e,n)}return 0}function N(e){var t={};return e.forEach((function(e){t[e.key.toString()]=e.value})),{inject:t[g.n8],multiInject:t[g.jf],targetName:t[g.LX],unmanaged:t[g.Af]}}var B=function(){function e(e,t,n,r,i){this.id=d(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=n,this.target=i,this.childRequests=[],this.bindings=Array.isArray(r)?r:[r],this.requestScope=null===n?new Map:null}return e.prototype.addChildRequest=function(t,n,r){var i=new e(t,this.parentContext,this,n,r);return this.childRequests.push(i),i},e}();function O(e){return e._bindingDictionary}function R(e,t,n,r,i){var o,a=M(n.container,i.serviceIdentifier);return a.length===p.NoBindingsAvailable&&n.container.options.autoBindInjectable&&"function"==typeof i.serviceIdentifier&&e.getConstructorMetadata(i.serviceIdentifier).compilerGeneratedMetadata&&(n.container.bind(i.serviceIdentifier).toSelf(),a=M(n.container,i.serviceIdentifier)),o=t?a:a.filter((function(e){var t=new B(e.serviceIdentifier,n,r,e,i);return e.constraint(t)})),function(e,t,n,r){switch(t.length){case p.NoBindingsAvailable:if(n.isOptional())return t;var i=v(e),o=c.BT;throw o+=function(e,t){if(t.isTagged()||t.isNamed()){var n="",r=t.getNamedTag(),i=t.getCustomTags();return null!==r&&(n+=r.toString()+"\n"),null!==i&&i.forEach((function(e){n+=e.toString()+"\n"}))," "+e+"\n "+e+" - "+n}return" "+e}(i,n),o+=m(r,i,M),new Error(o);case p.OnlyOneBindingAvailable:return t;case p.MultipleBindingsAvailable:default:if(n.isArray())return t;throw i=v(e),o=c.No+" "+i,o+=m(r,i,M),new Error(o)}}(i.serviceIdentifier,o,i,n.container),o}function L(e,t,n,r,i,o){var s,l;if(null===i){s=R(e,t,r,null,o),l=new B(n,r,null,s,o);var d=new T(r,l);r.addPlan(d)}else s=R(e,t,r,i,o),l=i.addChildRequest(o.serviceIdentifier,s,o);s.forEach((function(t){var n=null;if(o.isArray())n=l.addChildRequest(t.serviceIdentifier,t,o);else{if(t.cache)return;n=l}if(t.type===a.Instance&&null!==t.implementationType){var i=function(e,t){return A(e,b(t),t,!1)}(e,t.implementationType);if(!r.container.options.skipBaseClassChecks){var s=P(e,t.implementationType);if(i.length<s){var d=c.Z_(b(t.implementationType));throw new Error(d)}}i.forEach((function(t){L(e,!1,t.serviceIdentifier,r,n,t)}))}}))}function M(e,t){var n=[],r=O(e);return r.hasKey(t)?n=r.get(t):null!==e.parent&&(n=M(e.parent,t)),n}function q(e){return("object"==typeof e&&null!==e||"function"==typeof e)&&"function"==typeof e.then}function W(e){return!!q(e)||Array.isArray(e)&&e.some(q)}var U,z=function(e,t){return n=void 0,r=void 0,o=function(){var n,r;return function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,t];case 1:return n=i.sent(),e.cache=n,[3,3];case 2:throw r=i.sent(),e.cache=null,e.activated=!1,r;case 3:return[2]}}))},new((i=void 0)||(i=Promise))((function(e,t){function a(e){try{l(o.next(e))}catch(e){t(e)}}function s(e){try{l(o.throw(e))}catch(e){t(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((o=o.apply(n,r||[])).next())}));var n,r,i,o};!function(e){e.DynamicValue="toDynamicValue",e.Factory="toFactory",e.Provider="toProvider"}(U||(U={}));var j=function(){return j=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},j.apply(this,arguments)},H=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},V=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},G=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};function Q(e){var t,n=new((t=e.constr).bind.apply(t,G([void 0],e.constructorInjections,!1)));return e.propertyRequests.forEach((function(t,r){var i=t.target.identifier,o=e.propertyInjections[r];t.target.isOptional()&&void 0===o||(n[i]=o)})),n}function K(e){return H(this,void 0,void 0,(function(){var t,n,r,i;return V(this,(function(o){for(t=[],n=0,r=e;n<r.length;n++)i=r[n],Array.isArray(i)?t.push(Promise.all(i)):t.push(i);return[2,Promise.all(t)]}))}))}function $(e,t){var n=function(e,t){var n,r;if(Reflect.hasMetadata(g.Z_,e)){var i=Reflect.getMetadata(g.Z_,e);try{return null===(r=(n=t)[i.value])||void 0===r?void 0:r.call(n)}catch(t){if(t instanceof Error)throw new Error((0,c.CE)(e.name,t.message))}}}(e,t);return q(n)?n.then((function(){return t})):t}var Z=function(e){return function(t){t.parentContext.setCurrentRequest(t);var n=t.bindings,r=t.childRequests,i=t.target&&t.target.isArray(),o=!(t.parentRequest&&t.parentRequest.target&&t.target&&t.parentRequest.target.matchesArray(t.target.serviceIdentifier));if(i&&o)return r.map((function(t){return Z(e)(t)}));if(!t.target.isOptional()||0!==n.length){var a=n[0];return ee(e,t,a)}}},J=function(e,t){var n=function(e){switch(e.type){case a.Factory:return{factory:e.factory,factoryType:U.Factory};case a.Provider:return{factory:e.provider,factoryType:U.Provider};case a.DynamicValue:return{factory:e.dynamicValue,factoryType:U.DynamicValue};default:throw new Error("Unexpected factory type "+e.type)}}(e);return function(r,i){try{return n.factory.bind(e)(t)}catch(e){throw f(e)&&(e=new Error(c.NF(n.factoryType,t.currentRequest.serviceIdentifier.toString()))),e}}()},X=function(e,t,n){var o,l=t.childRequests;switch(function(e){var t=null;switch(e.type){case a.ConstantValue:case a.Function:t=e.cache;break;case a.Constructor:case a.Instance:t=e.implementationType;break;case a.DynamicValue:t=e.dynamicValue;break;case a.Provider:t=e.provider;break;case a.Factory:t=e.factory}if(null===t){var n=v(e.serviceIdentifier);throw new Error(c.F5+" "+n)}}(n),n.type){case a.ConstantValue:case a.Function:o=n.cache;break;case a.Constructor:o=n.implementationType;break;case a.Instance:o=function(e,t,n,o){!function(e,t){e.scope!==i&&function(e,t){var n="Class cannot be instantiated in "+(e.scope===r?"request":"transient")+" scope.";if("function"==typeof e.onDeactivation)throw new Error((0,c.bQ)(t.name,n));if(Reflect.hasMetadata(g.Vh,t))throw new Error((0,c.Wj)(t.name,n))}(e,t)}(e,t);var a=function(e,t,n){var r;if(t.length>0){var i=function(e,t){return e.reduce((function(e,n){var r=t(n);return n.target.type===s.ConstructorArgument?e.constructorInjections.push(r):(e.propertyRequests.push(n),e.propertyInjections.push(r)),e.isAsync||(e.isAsync=W(r)),e}),{constructorInjections:[],propertyInjections:[],propertyRequests:[],isAsync:!1})}(t,n),o=j(j({},i),{constr:e});r=i.isAsync?function(e){return H(this,void 0,void 0,(function(){var t,n;return V(this,(function(r){switch(r.label){case 0:return[4,K(e.constructorInjections)];case 1:return t=r.sent(),[4,K(e.propertyInjections)];case 2:return n=r.sent(),[2,Q(j(j({},e),{constructorInjections:t,propertyInjections:n}))]}}))}))}(o):Q(o)}else r=new e;return r}(t,n,o);return q(a)?a.then((function(e){return $(t,e)})):$(t,a)}(n,n.implementationType,l,Z(e));break;default:o=J(n,t.parentContext)}return o},Y=function(e,t,n){var o=function(e,t){return t.scope===i&&t.activated?t.cache:t.scope===r&&e.has(t.id)?e.get(t.id):null}(e,t);return null!==o||function(e,t,n){t.scope===i&&function(e,t){e.cache=t,e.activated=!0,q(t)&&z(e,t)}(t,n),t.scope===r&&function(e,t,n){e.has(t.id)||e.set(t.id,n)}(e,t,n)}(e,t,o=n()),o},ee=function(e,t,n){return Y(e,n,(function(){var r=X(e,t,n);return q(r)?r.then((function(e){return te(t,n,e)})):te(t,n,r)}))};function te(e,t,n){var r,i=ne(e.parentContext,t,n),o=ae(e.parentContext.container),a=o.next();do{r=a.value;var s=e.parentContext,l=e.serviceIdentifier,d=oe(r,l);i=q(i)?ie(d,s,i):re(d,s,i),a=o.next()}while(!0!==a.done&&!O(r).hasKey(e.serviceIdentifier));return i}var ne=function(e,t,n){return"function"==typeof t.onActivation?t.onActivation(e,n):n},re=function(e,t,n){for(var r=e.next();!r.done;){if(q(n=r.value(t,n)))return ie(e,t,n);r=e.next()}return n},ie=function(e,t,n){return r=void 0,i=void 0,a=function(){var r,i;return function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(o){switch(o.label){case 0:return[4,n];case 1:r=o.sent(),i=e.next(),o.label=2;case 2:return i.done?[3,4]:[4,i.value(t,r)];case 3:return r=o.sent(),i=e.next(),[3,2];case 4:return[2,r]}}))},new((o=void 0)||(o=Promise))((function(e,t){function n(e){try{l(a.next(e))}catch(e){t(e)}}function s(e){try{l(a.throw(e))}catch(e){t(e)}}function l(t){var r;t.done?e(t.value):(r=t.value,r instanceof o?r:new o((function(e){e(r)}))).then(n,s)}l((a=a.apply(r,i||[])).next())}));var r,i,o,a},oe=function(e,t){var n=e._activations;return n.hasKey(t)?n.get(t).values():[].values()},ae=function(e){for(var t=[e],n=e.parent;null!==n;)t.push(n),n=n.parent;return{next:function(){var e=t.pop();return void 0!==e?{done:!1,value:e}:{done:!0,value:void 0}}}},se=function(e,t){var n=e.parentRequest;return null!==n&&(!!t(n)||se(n,t))},le=function(e){return function(t){var n=function(n){return null!==n&&null!==n.target&&n.target.matchesTag(e)(t)};return n.metaData=new S.O(e,t),n}},de=le(g.P7),ue=function(e){return function(t){var n=null;if(null!==t){if(n=t.bindings[0],"string"==typeof e)return n.serviceIdentifier===e;var r=t.bindings[0].implementationType;return e===r}return!1}},ce=function(){function e(e){this._binding=e}return e.prototype.when=function(e){return this._binding.constraint=e,new ge(this._binding)},e.prototype.whenTargetNamed=function(e){return this._binding.constraint=de(e),new ge(this._binding)},e.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(e){return null!==e&&null!==e.target&&!e.target.isNamed()&&!e.target.isTagged()},new ge(this._binding)},e.prototype.whenTargetTagged=function(e,t){return this._binding.constraint=le(e)(t),new ge(this._binding)},e.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return null!==t&&ue(e)(t.parentRequest)},new ge(this._binding)},e.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return null!==t&&de(e)(t.parentRequest)},new ge(this._binding)},e.prototype.whenParentTagged=function(e,t){return this._binding.constraint=function(n){return null!==n&&le(e)(t)(n.parentRequest)},new ge(this._binding)},e.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return null!==t&&se(t,ue(e))},new ge(this._binding)},e.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return null!==t&&!se(t,ue(e))},new ge(this._binding)},e.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return null!==t&&se(t,de(e))},new ge(this._binding)},e.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return null!==t&&!se(t,de(e))},new ge(this._binding)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._binding.constraint=function(n){return null!==n&&se(n,le(e)(t))},new ge(this._binding)},e.prototype.whenNoAncestorTagged=function(e,t){return this._binding.constraint=function(n){return null!==n&&!se(n,le(e)(t))},new ge(this._binding)},e.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return null!==t&&se(t,e)},new ge(this._binding)},e.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return null!==t&&!se(t,e)},new ge(this._binding)},e}(),ge=function(){function e(e){this._binding=e}return e.prototype.onActivation=function(e){return this._binding.onActivation=e,new ce(this._binding)},e.prototype.onDeactivation=function(e){return this._binding.onDeactivation=e,new ce(this._binding)},e}(),he=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new ce(this._binding),this._bindingOnSyntax=new ge(this._binding)}return e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},e}(),pe=function(){function e(e){this._binding=e}return e.prototype.inRequestScope=function(){return this._binding.scope=r,new he(this._binding)},e.prototype.inSingletonScope=function(){return this._binding.scope=i,new he(this._binding)},e.prototype.inTransientScope=function(){return this._binding.scope=o,new he(this._binding)},e}(),fe=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new ce(this._binding),this._bindingOnSyntax=new ge(this._binding),this._bindingInSyntax=new pe(e)}return e.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},e.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},e.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},e}(),ve=function(){function e(e){this._binding=e}return e.prototype.to=function(e){return this._binding.type=a.Instance,this._binding.implementationType=e,new fe(this._binding)},e.prototype.toSelf=function(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error(""+c.jf);var e=this._binding.serviceIdentifier;return this.to(e)},e.prototype.toConstantValue=function(e){return this._binding.type=a.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=i,new he(this._binding)},e.prototype.toDynamicValue=function(e){return this._binding.type=a.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new fe(this._binding)},e.prototype.toConstructor=function(e){return this._binding.type=a.Constructor,this._binding.implementationType=e,this._binding.scope=i,new he(this._binding)},e.prototype.toFactory=function(e){return this._binding.type=a.Factory,this._binding.factory=e,this._binding.scope=i,new he(this._binding)},e.prototype.toFunction=function(e){if("function"!=typeof e)throw new Error(c.rg);var t=this.toConstantValue(e);return this._binding.type=a.Function,this._binding.scope=i,t},e.prototype.toAutoFactory=function(e){return this._binding.type=a.Factory,this._binding.factory=function(t){return function(){return t.container.get(e)}},this._binding.scope=i,new he(this._binding)},e.prototype.toAutoNamedFactory=function(e){return this._binding.type=a.Factory,this._binding.factory=function(t){return function(n){return t.container.getNamed(e,n)}},new he(this._binding)},e.prototype.toProvider=function(e){return this._binding.type=a.Provider,this._binding.provider=e,this._binding.scope=i,new he(this._binding)},e.prototype.toService=function(e){this.toDynamicValue((function(t){return t.container.get(e)}))},e}(),me=function(){function e(){}return e.of=function(t,n,r,i,o){var a=new e;return a.bindings=t,a.middleware=n,a.deactivations=i,a.activations=r,a.moduleActivationStore=o,a},e}(),ye=function(){function e(){this._map=new Map}return e.prototype.getMap=function(){return this._map},e.prototype.add=function(e,t){if(null==e)throw new Error(c.EC);if(null==t)throw new Error(c.EC);var n=this._map.get(e);void 0!==n?n.push(t):this._map.set(e,[t])},e.prototype.get=function(e){if(null==e)throw new Error(c.EC);var t=this._map.get(e);if(void 0!==t)return t;throw new Error(c.Jk)},e.prototype.remove=function(e){if(null==e)throw new Error(c.EC);if(!this._map.delete(e))throw new Error(c.Jk)},e.prototype.removeIntersection=function(e){var t=this;this.traverse((function(n,r){var i=e.hasKey(n)?e.get(n):void 0;if(void 0!==i){var o=r.filter((function(e){return!i.some((function(t){return e===t}))}));t._setValue(n,o)}}))},e.prototype.removeByCondition=function(e){var t=this,n=[];return this._map.forEach((function(r,i){for(var o=[],a=0,s=r;a<s.length;a++){var l=s[a];e(l)?n.push(l):o.push(l)}t._setValue(i,o)})),n},e.prototype.hasKey=function(e){if(null==e)throw new Error(c.EC);return this._map.has(e)},e.prototype.clone=function(){var t=new e;return this._map.forEach((function(e,n){e.forEach((function(e){return t.add(n,"object"==typeof(r=e)&&null!==r&&"clone"in r&&"function"==typeof r.clone?e.clone():e);var r}))})),t},e.prototype.traverse=function(e){this._map.forEach((function(t,n){e(n,t)}))},e.prototype._setValue=function(e,t){t.length>0?this._map.set(e,t):this._map.delete(e)},e}(),_e=function(){function e(){this._map=new Map}return e.prototype.remove=function(e){if(this._map.has(e)){var t=this._map.get(e);return this._map.delete(e),t}return this._getEmptyHandlersStore()},e.prototype.addDeactivation=function(e,t,n){this._getModuleActivationHandlers(e).onDeactivations.add(t,n)},e.prototype.addActivation=function(e,t,n){this._getModuleActivationHandlers(e).onActivations.add(t,n)},e.prototype.clone=function(){var t=new e;return this._map.forEach((function(e,n){t._map.set(n,{onActivations:e.onActivations.clone(),onDeactivations:e.onDeactivations.clone()})})),t},e.prototype._getModuleActivationHandlers=function(e){var t=this._map.get(e);return void 0===t&&(t=this._getEmptyHandlersStore(),this._map.set(e,t)),t},e.prototype._getEmptyHandlersStore=function(){return{onActivations:new ye,onDeactivations:new ye}},e}(),be=function(){return be=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},be.apply(this,arguments)},Ce=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},Se=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Te=function(){function e(e){var t=e||{};if("object"!=typeof t)throw new Error(""+c.li);if(void 0===t.defaultScope)t.defaultScope=o;else if(t.defaultScope!==i&&t.defaultScope!==o&&t.defaultScope!==r)throw new Error(""+c.KU);if(void 0===t.autoBindInjectable)t.autoBindInjectable=!1;else if("boolean"!=typeof t.autoBindInjectable)throw new Error(""+c.jC);if(void 0===t.skipBaseClassChecks)t.skipBaseClassChecks=!1;else if("boolean"!=typeof t.skipBaseClassChecks)throw new Error(""+c.SW);this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=d(),this._bindingDictionary=new ye,this._snapshots=[],this._middleware=null,this._activations=new ye,this._deactivations=new ye,this.parent=null,this._metadataReader=new h.P,this._moduleActivationStore=new _e}return e.merge=function(t,n){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var o=new e,a=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}([t,n],r,!0).map((function(e){return O(e)})),s=O(o);return a.forEach((function(e){var t;t=s,e.traverse((function(e,n){n.forEach((function(e){t.add(e.serviceIdentifier,e.clone())}))}))})),o},e.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=this._getContainerModuleHelpersFactory(),r=0,i=e;r<i.length;r++){var o=i[r],a=n(o.id);o.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction,a.unbindAsyncFunction,a.onActivationFunction,a.onDeactivationFunction)}},e.prototype.loadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Ce(this,void 0,void 0,(function(){var t,n,r,i,o;return Se(this,(function(a){switch(a.label){case 0:t=this._getContainerModuleHelpersFactory(),n=0,r=e,a.label=1;case 1:return n<r.length?(i=r[n],o=t(i.id),[4,i.registry(o.bindFunction,o.unbindFunction,o.isboundFunction,o.rebindFunction,o.unbindAsyncFunction,o.onActivationFunction,o.onDeactivationFunction)]):[3,4];case 2:a.sent(),a.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},e.prototype.unload=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.forEach((function(t){var n=e._removeModuleBindings(t.id);e._deactivateSingletons(n),e._removeModuleHandlers(t.id)}))},e.prototype.unloadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Ce(this,void 0,void 0,(function(){var t,n,r,i;return Se(this,(function(o){switch(o.label){case 0:t=0,n=e,o.label=1;case 1:return t<n.length?(r=n[t],i=this._removeModuleBindings(r.id),[4,this._deactivateSingletonsAsync(i)]):[3,4];case 2:o.sent(),this._removeModuleHandlers(r.id),o.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))},e.prototype.bind=function(e){var t=this.options.defaultScope||o,n=new u(e,t);return this._bindingDictionary.add(e,n),new ve(n)},e.prototype.rebind=function(e){return this.unbind(e),this.bind(e)},e.prototype.rebindAsync=function(e){return Ce(this,void 0,void 0,(function(){return Se(this,(function(t){switch(t.label){case 0:return[4,this.unbindAsync(e)];case 1:return t.sent(),[2,this.bind(e)]}}))}))},e.prototype.unbind=function(e){if(this._bindingDictionary.hasKey(e)){var t=this._bindingDictionary.get(e);this._deactivateSingletons(t)}this._removeServiceFromDictionary(e)},e.prototype.unbindAsync=function(e){return Ce(this,void 0,void 0,(function(){var t;return Se(this,(function(n){switch(n.label){case 0:return this._bindingDictionary.hasKey(e)?(t=this._bindingDictionary.get(e),[4,this._deactivateSingletonsAsync(t)]):[3,2];case 1:n.sent(),n.label=2;case 2:return this._removeServiceFromDictionary(e),[2]}}))}))},e.prototype.unbindAll=function(){var e=this;this._bindingDictionary.traverse((function(t,n){e._deactivateSingletons(n)})),this._bindingDictionary=new ye},e.prototype.unbindAllAsync=function(){return Ce(this,void 0,void 0,(function(){var e,t=this;return Se(this,(function(n){switch(n.label){case 0:return e=[],this._bindingDictionary.traverse((function(n,r){e.push(t._deactivateSingletonsAsync(r))})),[4,Promise.all(e)];case 1:return n.sent(),this._bindingDictionary=new ye,[2]}}))}))},e.prototype.onActivation=function(e,t){this._activations.add(e,t)},e.prototype.onDeactivation=function(e,t){this._deactivations.add(e,t)},e.prototype.isBound=function(e){var t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t},e.prototype.isCurrentBound=function(e){return this._bindingDictionary.hasKey(e)},e.prototype.isBoundNamed=function(e,t){return this.isBoundTagged(e,g.P7,t)},e.prototype.isBoundTagged=function(e,t,n){var r=!1;if(this._bindingDictionary.hasKey(e)){var i=this._bindingDictionary.get(e),o=function(e,t,n,r){var i=new E(s.Variable,"",t,new S.O(n,r)),o=new C(e);return new B(t,o,null,[],i)}(this,e,t,n);r=i.some((function(e){return e.constraint(o)}))}return!r&&this.parent&&(r=this.parent.isBoundTagged(e,t,n)),r},e.prototype.snapshot=function(){this._snapshots.push(me.of(this._bindingDictionary.clone(),this._middleware,this._activations.clone(),this._deactivations.clone(),this._moduleActivationStore.clone()))},e.prototype.restore=function(){var e=this._snapshots.pop();if(void 0===e)throw new Error(c.U9);this._bindingDictionary=e.bindings,this._activations=e.activations,this._deactivations=e.deactivations,this._middleware=e.middleware,this._moduleActivationStore=e.moduleActivationStore},e.prototype.createChild=function(t){var n=new e(t||this.options);return n.parent=this,n},e.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce((function(e,t){return t(e)}),n)},e.prototype.applyCustomMetadataReader=function(e){this._metadataReader=e},e.prototype.get=function(e){var t=this._getNotAllArgs(e,!1);return this._getButThrowIfAsync(t)},e.prototype.getAsync=function(e){return Ce(this,void 0,void 0,(function(){var t;return Se(this,(function(n){return t=this._getNotAllArgs(e,!1),[2,this._get(t)]}))}))},e.prototype.getTagged=function(e,t,n){var r=this._getNotAllArgs(e,!1,t,n);return this._getButThrowIfAsync(r)},e.prototype.getTaggedAsync=function(e,t,n){return Ce(this,void 0,void 0,(function(){var r;return Se(this,(function(i){return r=this._getNotAllArgs(e,!1,t,n),[2,this._get(r)]}))}))},e.prototype.getNamed=function(e,t){return this.getTagged(e,g.P7,t)},e.prototype.getNamedAsync=function(e,t){return this.getTaggedAsync(e,g.P7,t)},e.prototype.getAll=function(e){var t=this._getAllArgs(e);return this._getButThrowIfAsync(t)},e.prototype.getAllAsync=function(e){var t=this._getAllArgs(e);return this._getAll(t)},e.prototype.getAllTagged=function(e,t,n){var r=this._getNotAllArgs(e,!0,t,n);return this._getButThrowIfAsync(r)},e.prototype.getAllTaggedAsync=function(e,t,n){var r=this._getNotAllArgs(e,!0,t,n);return this._getAll(r)},e.prototype.getAllNamed=function(e,t){return this.getAllTagged(e,g.P7,t)},e.prototype.getAllNamedAsync=function(e,t){return this.getAllTaggedAsync(e,g.P7,t)},e.prototype.resolve=function(e){var t=this.isBound(e);t||this.bind(e).toSelf();var n=this.get(e);return t||this.unbind(e),n},e.prototype._preDestroy=function(e,t){var n,r;if(Reflect.hasMetadata(g.Vh,e))return null===(r=(n=t)[Reflect.getMetadata(g.Vh,e).value])||void 0===r?void 0:r.call(n)},e.prototype._removeModuleHandlers=function(e){var t=this._moduleActivationStore.remove(e);this._activations.removeIntersection(t.onActivations),this._deactivations.removeIntersection(t.onDeactivations)},e.prototype._removeModuleBindings=function(e){return this._bindingDictionary.removeByCondition((function(t){return t.moduleId===e}))},e.prototype._deactivate=function(e,t){var n=this,r=Object.getPrototypeOf(t).constructor;try{if(this._deactivations.hasKey(e.serviceIdentifier)){var i=this._deactivateContainer(t,this._deactivations.get(e.serviceIdentifier).values());if(q(i))return this._handleDeactivationError(i.then((function(){return n._propagateContainerDeactivationThenBindingAndPreDestroyAsync(e,t,r)})),r)}var o=this._propagateContainerDeactivationThenBindingAndPreDestroy(e,t,r);if(q(o))return this._handleDeactivationError(o,r)}catch(e){if(e instanceof Error)throw new Error(c.bQ(r.name,e.message))}},e.prototype._handleDeactivationError=function(e,t){return Ce(this,void 0,void 0,(function(){var n;return Se(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,e];case 1:return r.sent(),[3,3];case 2:if((n=r.sent())instanceof Error)throw new Error(c.bQ(t.name,n.message));return[3,3];case 3:return[2]}}))}))},e.prototype._deactivateContainer=function(e,t){for(var n=this,r=t.next();r.value;){var i=r.value(e);if(q(i))return i.then((function(){return n._deactivateContainerAsync(e,t)}));r=t.next()}},e.prototype._deactivateContainerAsync=function(e,t){return Ce(this,void 0,void 0,(function(){var n;return Se(this,(function(r){switch(r.label){case 0:n=t.next(),r.label=1;case 1:return n.value?[4,n.value(e)]:[3,3];case 2:return r.sent(),n=t.next(),[3,1];case 3:return[2]}}))}))},e.prototype._getContainerModuleHelpersFactory=function(){var e=this,t=function(e,t){e._binding.moduleId=t},n=function(n){return function(r){var i=e.rebind(r);return t(i,n),i}},r=function(t){return function(n,r){e._moduleActivationStore.addActivation(t,n,r),e.onActivation(n,r)}},i=function(t){return function(n,r){e._moduleActivationStore.addDeactivation(t,n,r),e.onDeactivation(n,r)}};return function(o){return{bindFunction:(a=o,function(n){var r=e.bind(n);return t(r,a),r}),isboundFunction:function(t){return e.isBound(t)},onActivationFunction:r(o),onDeactivationFunction:i(o),rebindFunction:n(o),unbindFunction:function(t){return e.unbind(t)},unbindAsyncFunction:function(t){return e.unbindAsync(t)}};var a}},e.prototype._getAll=function(e){return Promise.all(this._get(e))},e.prototype._get=function(e){var t=be(be({},e),{contextInterceptor:function(e){return e},targetType:s.Variable});if(this._middleware){var n=this._middleware(t);if(null==n)throw new Error(c.Y1);return n}return this._planAndResolve()(t)},e.prototype._getButThrowIfAsync=function(e){var t=this._get(e);if(W(t))throw new Error(c.Ft(e.serviceIdentifier));return t},e.prototype._getAllArgs=function(e){return{avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:e}},e.prototype._getNotAllArgs=function(e,t,n,r){return{avoidConstraints:!1,isMultiInject:t,serviceIdentifier:e,key:n,value:r}},e.prototype._planAndResolve=function(){var e=this;return function(t){var n=function(e,t,n,r,i,o,a,s){void 0===s&&(s=!1);var l=new C(t),d=function(e,t,n,r,i,o){var a=e?g.jf:g.n8,s=new S.O(a,n),l=new E(t,"",n,s);if(void 0!==i){var d=new S.O(i,o);l.metadata.push(d)}return l}(n,r,i,0,o,a);try{return L(e,s,i,l,null,d),l}catch(e){throw f(e)&&_(l.plan.rootRequest),e}}(e._metadataReader,e,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints);return function(e){return Z(e.plan.rootRequest.requestScope)(e.plan.rootRequest)}(n=t.contextInterceptor(n))}},e.prototype._deactivateIfSingleton=function(e){var t=this;if(e.activated)return q(e.cache)?e.cache.then((function(n){return t._deactivate(e,n)})):this._deactivate(e,e.cache)},e.prototype._deactivateSingletons=function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];if(q(this._deactivateIfSingleton(r)))throw new Error(c.Y3)}},e.prototype._deactivateSingletonsAsync=function(e){return Ce(this,void 0,void 0,(function(){var t=this;return Se(this,(function(n){switch(n.label){case 0:return[4,Promise.all(e.map((function(e){return t._deactivateIfSingleton(e)})))];case 1:return n.sent(),[2]}}))}))},e.prototype._propagateContainerDeactivationThenBindingAndPreDestroy=function(e,t,n){return this.parent?this._deactivate.bind(this.parent)(e,t):this._bindingDeactivationAndPreDestroy(e,t,n)},e.prototype._propagateContainerDeactivationThenBindingAndPreDestroyAsync=function(e,t,n){return Ce(this,void 0,void 0,(function(){return Se(this,(function(r){switch(r.label){case 0:return this.parent?[4,this._deactivate.bind(this.parent)(e,t)]:[3,2];case 1:return r.sent(),[3,4];case 2:return[4,this._bindingDeactivationAndPreDestroyAsync(e,t,n)];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))},e.prototype._removeServiceFromDictionary=function(e){try{this._bindingDictionary.remove(e)}catch(t){throw new Error(c.fG+" "+v(e))}},e.prototype._bindingDeactivationAndPreDestroy=function(e,t,n){var r=this;if("function"==typeof e.onDeactivation){var i=e.onDeactivation(t);if(q(i))return i.then((function(){return r._preDestroy(n,t)}))}return this._preDestroy(n,t)},e.prototype._bindingDeactivationAndPreDestroyAsync=function(e,t,n){return Ce(this,void 0,void 0,(function(){return Se(this,(function(r){switch(r.label){case 0:return"function"!=typeof e.onDeactivation?[3,2]:[4,e.onDeactivation(t)];case 1:r.sent(),r.label=2;case 2:return[4,this._preDestroy(n,t)];case 3:return r.sent(),[2]}}))}))},e}();const Ie={defaultScope:"Singleton",skipBaseClassChecks:!0};class we{constructor(e){this.container=e}bind(e){return new Ee(this,this.container.bind(e))}rebind(e){return new Ee(this,this.container.rebind(e))}unbind(e){try{return this.container.unbind(e),!0}catch(e){return!1}}get(e){return this.container.get(e)}getOptional(e){return this.container.isBound(e)?this.container.get(e):void 0}getAll(e){return this.container.isBound(e)?this.container.getAll(e):[]}isBound(e){return this.container.isBound(e)}createChildContainer(){return new we(this.container.createChild(Ie))}unbindAll(){this.container.unbindAll()}resolveNew(e){return this.container.resolve(e)}getBindings(){const e=(t=this.container,t._bindingDictionary).getMap();var t;const n=[];for(const[t,r]of e)n.push({token:t,boundServices:r});return n}}class Ee{constructor(e,t){this.container=e,this.bindingTo=t}to(e){this.bindingTo.to(e)}toSelf(){this.bindingTo.toSelf()}toValue(e){this.bindingTo.toConstantValue(e)}toDynamicValue(e){this.bindingTo.toDynamicValue((()=>e(this.container)))}toFactory(e){this.bindingTo.toFactory((()=>e(this.container)))}toExisting(e){this.bindingTo.toService(e)}toTransient(e){this.bindingTo.to(e).inTransientScope()}}var xe=n(9028);class Ae{constructor(e,t){this.addedModuleKeys=new Set,this._addedModuleClassNames=new Set,this._modulesSharingSameModuleKeyButDifferentClassname=new Set,this.container=e,this.generateModuleKey=t}static createContainer(e){return e?e.createChildContainer():function(){const e=new Te(Ie);return new we(e)}()}clear(){this.container.unbindAll(),this.addedModuleKeys.clear(),this._addedModuleClassNames.clear(),this._modulesSharingSameModuleKeyButDifferentClassname.clear()}get addedModuleClassNames(){return this._addedModuleClassNames}get modulesSharingSameModuleKeyButDifferentClassname(){return this._modulesSharingSameModuleKeyButDifferentClassname}addModule(e){var t;const n="function"!=typeof e?e.constructor.name:e.name,r=this.getModuleKey(e);if(this.addedModuleKeys.has(r))return void(this._addedModuleClassNames.has(n)||this._modulesSharingSameModuleKeyButDifferentClassname.add(n));this._addedModuleClassNames.add(n),this.addedModuleKeys.add(r);const i=this.getModuleInstance(e);this.addModules(null!==(t=i.imports)&&void 0!==t?t:[]),this.onAddModule(i)}addModules(e){for(const t of e)t&&(Array.isArray(t)?this.addModules(t):this.addModule(t))}bindProvidersToContainer(e,t){for(const n of t)if(n)if((0,xe.C)(n))e.isBound(n)||e.bind(n).toSelf();else{const t=n.provide;if(!n.multiple&&e.isBound(t))throw new Error(`Duplicate provider type: ${String(t)}`);if("useClass"in n)e.bind(t).to(n.useClass);else if("useDynamicValue"in n)e.bind(t).toDynamicValue(n.useDynamicValue);else if("useExisting"in n)e.bind(t).toExisting(n.useExisting);else{if(!("useValue"in n))throw new Error("Unknown provider type");e.bind(t).toValue(n.useValue)}}}getModuleKey(e){var t,n;const r=this.getModuleInstance(e);return r.uniqueId?r.uniqueId:e instanceof Function&&null!==(n=null===(t=this.generateModuleKey)||void 0===t?void 0:t.call(this,e))&&void 0!==n?n:e}getModuleInstance(e){return e instanceof Function?new e:e}}},13111:(e,t,n)=>{"use strict";n.d(t,{J:()=>o,S:()=>a});var r=n(42727),i=n(95734);class o extends r.z{constructor(e){super(r.z.createContainer(),e)}onAddModule(e){"configureRootServices"in e?e.configureRootServices(this.container):e.providers&&this.bindProvidersToContainer(this.container,e.providers)}}const a=(0,i.createContext)(void 0)},19635:(e,t,n)=>{"use strict";n.d(t,{G:()=>a,N:()=>s});var r=n(53756),i=n(13111),o=n(95734);function a(){const e=s();if(!e)throw new Error("No Injector context available");return e}function s(){const e=(0,o.useContext)(r.r),t=(0,o.useContext)(i.S),n=null!=e?e:t;return null==n?void 0:n.container}},63837:(e,t,n)=>{"use strict";function r(e){return Symbol.for(e)}n.d(t,{f:()=>r})},92037:(e,t,n)=>{"use strict";let r,i;async function o(){try{const e=await Promise.resolve().then(n.bind(n,46546));r=e.makeObservable,i=e.makeAutoObservable}catch(e){}}function a(e,t,n){return r?r(e,t,n):e}n.d(t,{Gn:()=>a,iJ:()=>o})},83240:(e,t,n)=>{"use strict";n.d(t,{C:()=>i});var r=n(63837);(0,r.f)("ICategoryLocalization");const i=(0,r.f)("ICategoryLocalizationSlim")},20311:(e,t,n)=>{"use strict";n.d(t,{B:()=>E});var r=n(51504),i=n(84457),o=n(30206),a=n(26017),s=n(20399),l=n(41260),d=n(62070),u=n(88670),c=n(52996),g=n(49520),h=n(52497),p=n(72131),f=n(92801),v=n(48828),m=n(30122),y=n(90424);let _=class{constructor(e,t,n,r,i,o){this._hostEmitters=e,this._hostSettings=t,this._logger=n,this._oaLogger=r,this._predictionStore=i,this._compositionEventHandler=o,this.onPredictionEvent=e=>{if(this.isDisabledOrComposing())return;if(!e.message.data.tileId)return void this._logger.log(510248457,s.q.Error,"IPrediction message: Received undefined args.");const t=e.message.data,n={eventType:e.message.messageType,tileId:t.tileId,tileVersion:t.tileVersion,prediction:t};this.onEvent(n)}}async initialize(){if(this._hostSettings.enableOrchestration)for(const e of this._hostEmitters)e.on(l.pD.predictionTriggered,this.onPredictionEvent)}shutDown(){}isDisabledOrComposing(){return!this._hostSettings.isTextPredictionEnabled||this._compositionEventHandler.isComposing}async onEvent(e){this.isDisabledOrComposing()||(e.eventType===d.G.NewData?(this._oaLogger.logActivity(f.$,{predictionText:e.prediction.entityType!==a.c.Text?e.prediction.entityType.toString():e.prediction.text,entityType:e.prediction.entityType,replacingExistingPrediction:void 0!==this._predictionStore.getCurrentPrediction()}),e.prediction.isFromAugLoop=!0,await this._predictionStore.updatePrediction(e.prediction)):await this._predictionStore.clearPrediction())}};_=(0,o.__decorate)([(0,v._)(),(0,o.__param)(0,(0,m.t)(l.zJ)),(0,o.__param)(1,(0,y.W)(u.n)),(0,o.__param)(2,(0,y.W)(c.g)),(0,o.__param)(3,(0,y.W)(g.m)),(0,o.__param)(4,(0,y.W)(p.o)),(0,o.__param)(5,(0,y.W)(h.q))],_);var b=n(6526),C=n(77148),S=n(16488),T=n(52669),I=n(30225);let w=class{constructor(e){this.targetWindowFactory=e,this.isComposing=!1,this._isInitalized=!1}async initialize(){var e,t;this._isInitalized||(this._windowEventListener=new S.J(null!==(t=null===(e=this.targetWindowFactory)||void 0===e?void 0:e.call(this))&&void 0!==t?t:window),this._windowEventListener.addListener("compositionstart",this.onCompositionStart),this._windowEventListener.addListener("compositionend",this.onCompositionEnd),this._isInitalized=!0)}shutDown(){var e;null===(e=this._windowEventListener)||void 0===e||e.removeAllListeners(),this._windowEventListener=void 0,this._isInitalized=!1}onCompositionStart(){this.isComposing=!0}onCompositionEnd(){this.isComposing=!1}};w=(0,o.__decorate)([(0,v._)(),(0,o.__param)(0,(0,y.W)(T.cg)),(0,o.__param)(0,(0,I.l)())],w);class E{constructor(){this.imports=[i.d,r.w]}get uniqueId(){return(0,b.z)(507918222)}configureRootServices(e){e.bind(_).toSelf(),e.bind(C.S).toExisting(_),e.bind(p.o).to(p.X),e.bind(h.q).to(w),e.bind(C.S).toExisting(h.q)}}},37890:(e,t,n)=>{"use strict";n.d(t,{R8:()=>s,Tc:()=>r,Vn:()=>o,XG:()=>a,r7:()=>i});const r=(0,n(63837).f)("IPredictionStateStore"),i=0,o=-1,a=-2;var s;!function(e){e[e.NotSeen=0]="NotSeen",e[e.TypeNotMatchingCharacter=1]="TypeNotMatchingCharacter",e[e.ExplicitRejection=2]="ExplicitRejection",e[e.ImplicitRejection=3]="ImplicitRejection"}(s||(s={}))},49278:(e,t,n)=>{"use strict";n.d(t,{p:()=>v});var r=n(30206),i=n(26017),o=n(62070),a=n(85230),s=n(93398),l=n(41260),d=n(24546),u=n(37890),c=n(3327),g=n(78175),h=n(59134),p=n(48828),f=n(47436);let v=class{constructor(e,t,n,r,l,d,g,p,f,v,m,y,_){this._localizer=e,this._hostSettings=t,this._logger=n,this._oaLogger=r,this._predictionStore=l,this._proofingDom=d,this._paragraphTextExtractor=g,this._tileContent=p,this._hostEmitter=f,this._userProfilePictureCache=v,this._inlineSuggestionsRenderer=m,this._nudgeStore=y,this._proofingEmitter=_,this._isActivelyAddingWrappingNewLines=!1,this._predictionUpdate=0,this._multiPredictionMenuOpen=!1,this.supportsPredictionType=e=>e===i.c.Text||e===i.c.PIM||e===i.c.Topic||this.isEntityPrediction(e),this.isEntityPrediction=e=>e===i.c.File||e===i.c.People||e===i.c.Loop||e===i.c.PIM,this.eccStateChanged=e=>{var t;e.messageType===o.G.RemoveData&&(null===(t=this._hostSettings.oaSettings)||void 0===t?void 0:t.enableZeroQueryHintText)&&this._predictionStore.clearPrediction()},this.getPredictionFirstItem=e=>e.entityResults&&e.entityResults.entities[0],this.onPredictionUpdatedInternal=async()=>{var e,t,n,r,i,o,a,s;const l=this._predictionStore.getCurrentPrediction();if(l){if(this.isPredictionDisabledForEntityType(null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.predictions,l.entityType))return void await this._predictionStore.clearPrediction();if((null===(n=null===(t=this._hostSettings.serviceSettings)||void 0===t?void 0:t.predictions)||void 0===n?void 0:n.shouldRenderPrediction)&&!this._hostSettings.serviceSettings.predictions.shouldRenderPrediction(l))return void await this._predictionStore.clearPrediction();if(void 0!==(null===(r=this._inlineSuggestionsRenderer)||void 0===r?void 0:r.getCurrentMenuInfo())&&!l.isHelperText)return void(this._multiPredictionMenuOpen||(this._prediction?await this.clearCurrentPrediction(l,"ECC open",u.R8.ImplicitRejection):await this._predictionStore.clearPrediction()));if(this.isEntityPrediction(l.entityType)){if(!(null===(o=null===(i=this._hostSettings.serviceSettings)||void 0===i?void 0:i.predictions)||void 0===o?void 0:o.onInsertEntityPrediction)||!this._inlineSuggestionsRenderer)return void await this._predictionStore.clearPrediction();if(!await this.prepareEntityPredictions(l))return void await this._predictionStore.clearPrediction()}if((null===(a=this._prediction)||void 0===a?void 0:a.context)&&l.context&&l.context+l.text===this._prediction.context+this._prediction.text&&l.context.startsWith(this._prediction.context))return;(null===(s=this._nudgeStore)||void 0===s?void 0:s.getCurrentNudge())&&await this._nudgeStore.clearNudge()}await this.onPredictionUpdated()},this.prepareEntityPredictions=async e=>{var t,n,r;if(e.entityType===i.c.People){if(e.entityResults){if((null===(t=e.context)||void 0===t?void 0:t.endsWith(e.text))||(null===(n=e.context)||void 0===n?void 0:n.endsWith(e.text+" ")))return!1;for(const t of e.entityResults.entities)t.imageUrl=await(null===(r=this._userProfilePictureCache)||void 0===r?void 0:r.fetchProfilePicture((0,h.u)(t)))}}else e.shouldDismissOnTextChange=!0;return!0},this.checkIfEntityPredictionContextIsValid=(e,t,n)=>(e.entityType===i.c.People&&e.entityResults&&(t.endsWith(" ")||this.prepareEntityPredictionForTextUpdate(e,t)),!0),this.prepareEntityPredictionForTextUpdate=(e,t)=>{var n;if(e.entityType===i.c.People){if(null===(n=e.entityResults)||void 0===n?void 0:n.entities){const n=t.substring(e.startIndex);for(const t of e.entityResults.entities)if(t.text.startsWith(n)){e.text=t.text;break}}e.entityResults=void 0}},this.onEntityDropdownOpened=(e,t)=>{var n;if(!this._prediction)return void this._oaLogger.logDiagnostics("Entity prediction dropdown selected, but no prediction was available");let r=[];const o=this._prediction.entityType;if(o===i.c.File)r=[{entities:this._prediction.entityResults.entities.map((e=>Object.assign(Object.assign({},e),{entityType:i.c.File,text:e.FileName,isBestMatch:!1}))),entityType:this._prediction.entityType}];else if(o===i.c.People){const e=this._prediction;if(!e.entityResults)return void this._oaLogger.logDiagnostics("Entity prediction dropdown selected, but no people prediction items were available");r=[{entities:e.entityResults.entities.map((e=>Object.assign(Object.assign({},e),{entityType:i.c.People,text:e.DisplayName,isBestMatch:!1}))),entityType:this._prediction.entityType}]}else o===i.c.Loop?r=[{entities:this._prediction.entityResults.entities.map((e=>Object.assign(Object.assign({},e),{entityType:i.c.Loop,text:e.text,isBestMatch:!1}))),entityType:this._prediction.entityType}]:o===i.c.PIM&&(r=[{entities:this._prediction.entityResults.entities.map((e=>Object.assign(Object.assign({},e),{entityType:i.c.PIM,isBestMatch:!1}))),entityType:this._prediction.entityType}]);this._multiPredictionMenuOpen=!0,null===(n=this._inlineSuggestionsRenderer)||void 0===n||n.showEntityPrediction(this._prediction.tileId,this._prediction.startIndex,r,this.onApplyEntityPrediction,(()=>{this._multiPredictionMenuOpen=!1}),t.getBoundingClientRect())},this.onApplyEntityPrediction=e=>{this.applyCurrentPrediction(u.Vn,e)},this.handleTextTile=e=>{if(this._prediction&&e.message.messageType===o.G.RemoveData){const t=e.message.data.tileId;this._prediction.tileId!==t&&this._proofingDom.findParagraphNode(this._prediction.tileId)||this.clearCurrentPrediction(this._prediction,"tile removed",u.R8.ImplicitRejection)}},this.hostModelVisualStateChange=e=>{var t,n;const r=null!==(t=this._prediction)&&void 0!==t?t:this._predictionStore.getCurrentPrediction();if(r&&e.message.created){const t=this._proofingDom.findParagraphNode(r.tileId);if(t&&(r.tileId===e.message.tileId||(null===(n=t.parent)||void 0===n?void 0:n.id)===e.message.tileId)){const e=this._predictionUpdate+1;this._predictionUpdate=e,this.determineIfPredictionIsValidAndApply(r,e)}}},this.handleDelta=e=>{var t,n;const r=e.message;if(r.sourceType===a.pf.TileNode)return;if(this.checkForECCHintTextPrediction())return;if(this._isActivelyAddingWrappingNewLines)return;if(!r.delta||!this._prediction)return void(this.lastPredictedTile&&r.tileId!==this.lastPredictedTile.id&&(this.lastPredictedTile=void 0));if(r.delta.deltaType===c.WI.Add&&!r.delta.content)return;if(r.delta.deltaType===c.WI.Update&&!r.delta.content&&!r.delta.length)return;if(r.delta.deltaType===c.WI.Update&&(r.delta.unit===c.OD.Sentence||r.delta.unit===c.OD.Paragraph)&&"\n"===r.delta.content&&0===r.delta.position)return;if((r.delta.unit===c.OD.Sentence||r.delta.unit===c.OD.Paragraph)&&(r.delta.deltaType===c.WI.Add||r.delta.deltaType===c.WI.Update)&&(null!==(n=null===(t=r.delta.content)||void 0===t?void 0:t.length)&&void 0!==n?n:0)>1)return;const i=this._predictionUpdate+1;this._predictionUpdate=i,this.determineIfPredictionIsValidAndApply(this._prediction,i,this._predictionDisplayText,r.tileId,r.changeType,r.delta,r.deletedOrReplacedCharacters)},this.trimLineEnding=e=>e&&"\n"===e[e.length-1]?e.substring(0,e.length-1):e,this.logDisplayedTelemetry=e=>{var t,n;e.isFromAugLoop&&((null===(n=null===(t=this._hostSettings.serviceSettings)||void 0===t?void 0:t.predictions)||void 0===n?void 0:n.onPredictionDisplayed)&&this._hostSettings.serviceSettings.predictions.onPredictionDisplayed(e),this._oaLogger.logActivity("OAPredictionDisplayed",void 0,this.getBasePredictionLogFields(e)))},this.logAcceptedTelemetry=(e,t,n,r,i)=>{var o,a;e.isFromAugLoop&&((null===(a=null===(o=this._hostSettings.serviceSettings)||void 0===o?void 0:o.predictions)||void 0===a?void 0:a.onPredictionAccepted)&&this._hostSettings.serviceSettings.predictions.onPredictionAccepted(e,t,n),this._oaLogger.logActivity("OAPredictionApplied",void 0,[...this.getBasePredictionLogFields(e),...(0,s.W)(["charactersTyped",t],["acceptedViaUserAction",n],["keyPressedForAccept",r],["acceptanceTime",(new Date).toISOString()],["isOpeningECCForEntityPrediction",i])]))},this.logDismissedTelemetry=(e,t,n)=>{var r,i;e.isFromAugLoop&&((null===(i=null===(r=this._hostSettings.serviceSettings)||void 0===r?void 0:r.predictions)||void 0===i?void 0:i.onPredictionDismissed)&&this._hostSettings.serviceSettings.predictions.onPredictionDismissed(e,e.currentEndIndex?e.currentEndIndex-e.startIndex:0,t),void 0!==this._prediction&&this._oaLogger.logActivity("OAPredictionDismissed",void 0,[...this.getBasePredictionLogFields(e),...(0,s.W)(["charactersTyped",e.currentEndIndex?e.currentEndIndex-e.startIndex:0],["dismissalReason",t],["dismissalType",n],["rejectionTime",(new Date).toISOString()])]))},this._predictionStore.setOnUpdatedPrediction(this.onPredictionUpdatedInternal)}get prediction(){return this._prediction}get predictionDisplayText(){return this._predictionDisplayText}get predictionDisplayLocation(){return this._predictionDisplayLocation}get predictionParentElement(){return this._predictionParentElement}get predictionContentEditableParentElement(){return this._predictionContentEditableParentElement}get multiPredictionMenuOpen(){return this._multiPredictionMenuOpen}get predictionFirstDisplayedTime(){return this._predictionFirstDisplayedTime}get localizer(){return this._localizer}async initialize(){this._hostEmitter.on(l.pD.hostModelDelta,this.handleDelta),this._hostEmitter.on(l.pD.hostModelTextTile,this.handleTextTile),this._hostEmitter.on(l.pD.hostModelVisualStateChange,this.hostModelVisualStateChange),this._proofingEmitter.on("eccStateChanged",this.eccStateChanged)}shutDown(){this._predictionParentElement=void 0,this._predictionContentEditableParentElement=void 0}setOnUpdate(e){this._onUpdate=e}async clearCurrentPrediction(e,t,n){this.logDismissedTelemetry(e,t,n),await this._predictionStore.clearPrediction()}isPredictionDisabledForEntityType(e,t){return(null==e?void 0:e.entityConfigs)&&!e.entityConfigs.some((e=>e.enabled&&e.entityType===t))}checkForECCHintTextPrediction(){return!1}async handleRemotePredictionUpdate(e,t,n,r){var i,o,a,s,l;if(e.tileId!==n)return;const d=null!==(i=r.position)&&void 0!==i?i:0,g=e.startIndex+t.length;if(d>=e.startIndex&&d<g)await this.clearCurrentPrediction(e,"remote edit dismissed",u.R8.ImplicitRejection);else{const t=r.deltaType===c.WI.Add?null!==(a=null===(o=r.content)||void 0===o?void 0:o.length)&&void 0!==a?a:0:r.deltaType===c.WI.Delete?-1*r.length:r.deltaType===c.WI.Update?(null!==(l=null===(s=r.content)||void 0===s?void 0:s.length)&&void 0!==l?l:0)-r.length:0,n=this._predictionUpdate+1;this._predictionUpdate=n,await this.determineIfPredictionIsValidAndApply(Object.assign(Object.assign({},e),{startIndex:e.startIndex+t}),n)}}determineIfPredictionTextIsValid(e,t,n){var r,o,a,s,l,h,p,v,m;const y=this._proofingDom.findParagraphNode(e.tileId),_=this.trimLineEnding(this._paragraphTextExtractor.getParagraphText(y)),b=null!==(o=null===(r=this.lastPredictedTile)||void 0===r?void 0:r.predictionContext.length)&&void 0!==o?o:0;if(e.entityType===i.c.Loop&&e.tileId===(null===(a=this.lastPredictedTile)||void 0===a?void 0:a.id)&&e.entityType===this.lastPredictedTile.predictionType&&(null!==(l=null===(s=e.context)||void 0===s?void 0:s.length)&&void 0!==l?l:0)>b+3)return{result:!1};if(t&&e.shouldDismissOnTextChange)return{result:!1};const C=null!==(h=null==t?void 0:t.position)&&void 0!==h?h:0;if(_&&(0,f.l)(y)){const r=_.substring(e.startIndex);t&&this.isEntityPrediction(e.entityType)&&this.prepareEntityPredictionForTextUpdate(e,_);const i=(e.context?e.context.substring(0,e.startIndex):_.substring(0,e.startIndex))+e.text;let o=0;for(let i=0;i<e.text.length;i++){const a=e.text.charAt(i),s=(null==t?void 0:t.deltaType)===c.WI.Delete?1:0;if(i>=r.length||t&&i+e.startIndex>C-s)break;if(t&&t.deltaType===c.WI.Delete&&i+e.startIndex===C-s&&n&&1===n.length&&a===n)break;if(a===r.charAt(i))o++;else{if(!this.allowMiddleOfSentencePredictions()){if(e.shouldDismissOnTextChange)break;return{result:!1}}if(!t)break;if(t.deltaType!==c.WI.Add||!t.content||!(t.content===r.charAt(i)||d.Yv(t.content.charCodeAt(0))&&d.Yv(r.charCodeAt(i))))return{result:!1}}}const a=_.substring(0,e.startIndex+o);if(e.currentEndIndex&&e.currentEndIndex>a.length&&(!t||t.deltaType!==c.WI.Delete||C<e.startIndex))return{result:!1};if(e.currentEndIndex=a.length,e.entityResults&&!this.checkIfEntityPredictionContextIsValid(e,_,o))return{result:!1};if(i.startsWith(a)&&a!==i){const t=a.length,n=this._tileContent.getContainingElement(y);if(!n)return{result:!1,dueToMissingContainingHTMLElement:!0};const r=null!==(p=(0,g.m)(n))&&void 0!==p?p:n;return(null===(v=this.lastPredictedTile)||void 0===v?void 0:v.id)!==e.tileId&&(this.lastPredictedTile={id:e.tileId,predictionType:e.entityType,predictionContext:null!==(m=e.context)&&void 0!==m?m:""}),{paragraphNode:y,paragraphNodeOffset:y.element.offset,insertableTextStart:t,htmlParentElement:n,contentEditableHtmlParentElement:r,predictionText:i}}if(a===i)return this.logAcceptedTelemetry(e,e.text.length,!1,u.r7,!!e.entityResults),{result:!1,dueToEntirePredictionTyped:!0}}return{result:!1}}getBasePredictionLogFields(e){const t=(0,s.W)(["predictionTextLength",e.text.length],["entityType",e.entityType]);return void 0!==this._predictionFirstDisplayedTime&&t.push((0,s.n)("firstDisplayedTime",this._predictionFirstDisplayedTime.toISOString())),t}};v=(0,r.__decorate)([(0,p._)()],v)},51480:(e,t,n)=>{"use strict";n.d(t,{J:()=>s});var r=n(97397),i=n(59901),o=n(63503),a=n(95734);const s=e=>{const{hostSettings:t,themeStore:n}=e,s=(0,o.ZY)(),[l,d]=a.useState(null==n?void 0:n.getComponentActiveTheme(r.yF.predictionContainerComponentName,!0));a.useEffect((()=>{if(!n)return()=>{};const e=()=>{d(n.getComponentActiveTheme(r.yF.predictionContainerComponentName,!0))};return n.subscribe("currentThemeUpdated",e),n.subscribe("defaultThemeUpdated",e),n.subscribe("themesUpdated",e),()=>{n.unsubscribe("currentThemeUpdated",e),n.unsubscribe("defaultThemeUpdated",e),n.unsubscribe("themesUpdated",e)}}),[n]);const u=(e=>{var t,n,r,o,a,s,l;return`\n  .ms-text-prediction {\n    color: ${null==e?void 0:e.text};\n    position: relative;\n    user-select: none;\n  }\n\n  .ms-ghost-text {\n    color: ${null!==(t=null==e?void 0:e.text)&&void 0!==t?t:i.L.colorNeutralForeground4};\n    position: relative;\n    user-select: none;\n    background: ${null!==(n=null==e?void 0:e.highlightColor)&&void 0!==n?n:i.L.colorNeutralBackground5};\n  }\n\n  .ms-entity-prediction {\n    position: relative;\n    user-select: none;\n  }\n\n  .ms-entity-prediction-wrapper {\n    background: ${null!==(r=null==e?void 0:e.background.resting)&&void 0!==r?r:i.L.colorNeutralBackground3};\n    color: ${null!==(o=null==e?void 0:e.entityText.resting)&&void 0!==o?o:i.L.colorNeutralForeground4};\n    border-radius: 4px;\n    padding: 0px 4px;\n    gap: 4px;\n    user-select: none;\n    display: inline-flex;\n    pointer-events: all;\n    cursor: pointer;\n  }\n\n  .ms-entity-prediction-wrapper:hover {\n    background: ${null!==(a=null==e?void 0:e.background.hover)&&void 0!==a?a:i.L.colorNeutralBackground3Hover};\n    color: ${null==e?void 0:e.entityText.hover};\n  }\n\n  .ms-prediction-tab-hint {\n    align-content: center;\n    border-color: ${null!==(s=null==e?void 0:e.tabBorder)&&void 0!==s?s:null==e?void 0:e.text};\n    border-radius: 2px;\n    border-style: solid;\n    border-width: 1px;\n    box-sizing: border-box;\n    color: ${null!==(l=null==e?void 0:e.tabText)&&void 0!==l?l:i.L.colorNeutralForeground4};\n    display: inline-grid;\n    font-size: 0.630em;\n    height: 1.5em;\n    margin-left: 4px;\n    padding: 1px 4px;\n    position: relative;\n    vertical-align: 10%;\n    white-space: nowrap;\n    width: 2.5em;\n  }\n\n  .ms-entity-prediction-icon {\n    align-self: center\n  }\n\n  .ms-entity-prediction-dropdown {\n    align-self: center\n  }\n  `})(l);return a.useEffect((()=>{if(!t.disableInlineStyleTagInCanvas||!s||!u)return;const e=s.getElementById("ms-prediction-style");if(null===e){const e=s.createElement("style");e.type="text/css",e.id="ms-prediction-style",e.appendChild(s.createTextNode(u)),s.head.appendChild(e)}else e.innerText=u}),[t,s,u]),t.disableInlineStyleTagInCanvas?null:a.createElement("style",{type:"text/css"},u)}},68443:(e,t,n)=>{"use strict";n.d(t,{r:()=>y});var r=n(26017),i=n(87579),o=n(95734);const a=o.memo((e=>{const{children:t,predictionDisplayText:n,shouldShowInsertionHelperText:r,showDropdownChevron:a,localizer:s,isMobile:l,onTextMayOverlapLine:d,onDropdownOpened:u,leftPadding:c,parentElement:g,showIconWithMultipleComponents:h}=e,p=o.useRef(null),f=o.useRef(null),v=o.useCallback((()=>{a&&p.current&&u(p.current)}),[p,u,a]),m=o.useCallback((e=>{"Tab"===e.code&&a&&p.current&&u(p.current)}),[p,u,a]);o.useEffect((()=>{if(!f.current)return;let e=0;const t=f.current.getClientRects();1!==t.length&&(e+=t.length-1),d(e)}));const y=parseInt(window.getComputedStyle(g).fontSize,10);return o.createElement(o.Fragment,null,o.createElement("span",{className:"ms-entity-prediction-wrapper",style:{marginLeft:c?c+"px":void 0},ref:p,onClick:v,onKeyDown:m,role:"combobox"},"​‌",(!a||h)&&o.createElement("span",{className:"ms-entity-prediction-icon"},t),o.createElement("span",{id:"textPrediction",className:"ms-entity-prediction",contentEditable:!1,ref:f},n),a?o.createElement("span",{className:"ms-entity-prediction-dropdown"},o.createElement(i.yuG,{style:{width:y-4,height:y-4}})):o.createElement(o.Fragment,null),"​‌"),r?o.createElement("span",{id:"textPredictionTabHint",className:"ms-prediction-tab-hint"},"​‌",s.getMessage(l?"ebx_TextPredictionTapLabel":"ebx_TextPredictionTabLabel"),"​‌"):o.createElement(o.Fragment,null))}));var s=n(15715),l=n(36754);const d=o.memo((e=>{var t,n;const{prediction:r,parentElement:i}=e,d=parseInt(window.getComputedStyle(i).fontSize,10),u=null!==(n=null===(t=r.entityResults.entities[0].FileExtension)||void 0===t?void 0:t.toLocaleLowerCase())&&void 0!==n?n:"",c=Object.prototype.hasOwnProperty.call(l.L,u)?l.L[u].iconType:"Cloud";return o.createElement(a,Object.assign({},e,{showDropdownChevron:r.entityResults.entities.length>1}),o.createElement(s.I,{type:c,style:{width:d,height:d},fontSize:d}))}));var u=n(44358);const c=o.memo((e=>{var t,n;const{prediction:r,parentElement:i}=e,l=parseInt(window.getComputedStyle(i).fontSize,10),d=(0,u.S)(null!==(n=null===(t=r.entityResults.entities[0].icon)||void 0===t?void 0:t.iconName)&&void 0!==n?n:"");return o.createElement(a,Object.assign({},e,{showDropdownChevron:r.entityResults.entities.length>1}),o.createElement(s.I,{type:null!=d?d:"Cloud",style:{width:l,height:l},fontSize:l}))}));var g=n(5817);const h=o.memo((e=>{const{prediction:t,parentElement:n}=e,r=parseInt(window.getComputedStyle(n).fontSize,10);return o.createElement(a,Object.assign({},e,{showDropdownChevron:t.entityResults.entities.length>1,showIconWithMultipleComponents:!0}),o.createElement(g.c,{coinSize:r,text:"",imageUrl:t.entityResults.entities[0].imageUrl,imageInitials:t.entityResults.entities[0].imageInitials}))})),p=o.memo((e=>{const{prediction:t}=e;return o.createElement(a,Object.assign({},e,{showDropdownChevron:t.entityResults.entities.length>1}))}));var f=n(77724);const v="textPrediction",m=o.memo((e=>{const{predictionDisplayText:t,shouldShowInsertionHelperText:n,isPIMPrediction:r,isMobile:i,localizer:a,onTextMayOverlapLine:s,leftPadding:l,onDropdownOpened:d,isHelperText:u,appName:c}=e,g=t.split(" "),h=o.useRef({}),p=o.useCallback((()=>{r&&h.current[0]&&d(h.current[0])}),[d]);if(o.useEffect((()=>{if(!h.current[0]||!h.current[g.length-1])return;let e=0,t=0;for(let n=0;n<g.length;n++){if(!h.current[n])continue;const r=0===n,i=n===g.length-1,o=h.current[n].getBoundingClientRect();if(r?e=o.top:o.top!==e&&(t++,e=o.top),i){const e=h.current[n].getClientRects();1!==e.length&&(t+=e.length-1)}}s(t)})),!g)return o.createElement(o.Fragment,null);const f=["BingAtWork","BizChat"].some((e=>null==c?void 0:c.includes(e)))&&u;return o.createElement(o.Fragment,null,g.map(((e,t,r)=>{const s=0===t,d=t+1===r.length,u=e+(d?"":" ");return o.createElement("span",{key:`${v}-${t}`,id:`${v}-${t}`,className:f?"ms-ghost-text":"ms-text-prediction",style:{paddingLeft:s&&l?l+"px":void 0,whiteSpace:d&&n?"nowrap":void 0,borderRadius:s&&f?"4px 0 0 4px":t===r.length-2?"0 4px 4px 0":void 0},contentEditable:!1,ref:e=>{h.current[t]=e},onMouseOver:p,onFocus:p},"​‌",u,"​‌",d&&n?o.createElement("span",{id:"textPredictionTabHint",className:"ms-prediction-tab-hint"},"​‌",a.getMessage(i?"ebx_TextPredictionTapLabel":"ebx_TextPredictionTabLabel"),"​‌"):o.createElement(o.Fragment,null))})))}));function y(e,t,n,i,a,s,l,u,g,v,y){return o.createElement(f.K,{rtl:n.isRtl()},function(e,t,n,i,a,s,l,u,g,f){var v,y,_,b,C,S,T;return n.entityType===r.c.File&&n.entityResults&&i?o.createElement(d,{predictionDisplayText:i,prediction:n,shouldShowInsertionHelperText:null===(v=n.shouldShowInsertionHelperText)||void 0===v||v,leftPadding:u,localizer:e,isMobile:t,parentElement:a,onTextMayOverlapLine:l,onDropdownOpened:s}):n.entityType===r.c.People&&n.entityResults&&i?o.createElement(h,{predictionDisplayText:i,prediction:n,shouldShowInsertionHelperText:null===(y=n.shouldShowInsertionHelperText)||void 0===y||y,leftPadding:u,localizer:e,isMobile:t,parentElement:a,onTextMayOverlapLine:l,onDropdownOpened:s}):n.entityType===r.c.Loop&&n.entityResults&&i?o.createElement(c,{predictionDisplayText:i,prediction:n,shouldShowInsertionHelperText:null===(_=n.shouldShowInsertionHelperText)||void 0===_||_,leftPadding:u,localizer:e,isMobile:t,parentElement:a,onTextMayOverlapLine:l,onDropdownOpened:s}):n.entityType===r.c.PIM&&i&&g&&(null!==(C=null===(b=n.entityResults)||void 0===b?void 0:b.entities.length)&&void 0!==C?C:0)>1?o.createElement(p,{predictionDisplayText:i,prediction:n,shouldShowInsertionHelperText:null===(S=n.shouldShowInsertionHelperText)||void 0===S||S,leftPadding:u,localizer:e,isMobile:t,parentElement:a,onTextMayOverlapLine:l,onDropdownOpened:s}):[r.c.Text,r.c.People,r.c.PIM,r.c.Topic].includes(n.entityType)&&i?o.createElement(m,{predictionDisplayText:i,shouldShowInsertionHelperText:null===(T=n.shouldShowInsertionHelperText)||void 0===T||T,isPIMPrediction:n.entityType===r.c.PIM,leftPadding:u,localizer:e,isMobile:t,onTextMayOverlapLine:l,onDropdownOpened:s,isHelperText:n.isHelperText,appName:f}):o.createElement(o.Fragment,null)}(e,t,i,a,s,l,u,g,v,y))}},69284:(e,t,n)=>{"use strict";n.d(t,{l:()=>j});var r=n(30206),i=n(85230),o=n(16715),a=n(20399),s=n(71234),l=n(88670),d=n(52996),u=n(49520),c=n(41260),g=n(68081),h=n(46965),p=n(79548),f=n(52497),v=n(55908),m=n(48828),y=n(90424),_=n(30225),b=n(26017),C=n(84622),S=n(28363),T=n(92135),I=n(72131),w=n(87151),E=n(14193),x=n(11966),A=n(43900),D=n(97397),k=n(16488),F=n(77145),P=n(27139),N=n(37890),B=n(51480),O=n(75414),R=n(68443),L=n(95734);const M=L.memo((e=>{var t,n,r,i,o,a,s;const{hostSettings:l,isMobile:d,languageScriptDirectionDetector:u,predictionStateStore:c,themeStore:g}=e,h=c.predictionContentEditableParentElement,p=L.createRef(),[f,v]=L.useState(c.prediction),[m,y]=L.useState(c.predictionDisplayText),_=L.useCallback((()=>{c.prediction&&c.predictionDisplayText&&(v(c.prediction),y(c.predictionDisplayText))}),[c.prediction,c.predictionDisplayText]);L.useEffect((()=>(c.setOnUpdate(_),()=>{c.setOnUpdate(void 0)})),[c,_]);const C=L.useCallback((e=>{c.onEntityDropdownOpened(f,e)}),[c,f]),S=L.useCallback((async e=>{var t,n,r;F.x.isKey(e,P.m.tab)?(e.stopPropagation(),e.preventDefault(),(null===(t=c.prediction)||void 0===t?void 0:t.entityResults)&&c.prediction.entityResults.entities.length>1&&(c.prediction.entityType!==b.c.PIM||(null===(r=null===(n=l.serviceSettings)||void 0===n?void 0:n.predictions)||void 0===r?void 0:r.enablePimMultiPredict))?p.current&&C(p.current):await c.applyCurrentPrediction(e.keyCode)):F.x.isKey(e,[P.m.arrowLeft,P.m.arrowRight,P.m.escape])?await c.clearCurrentPrediction(f,"invalid key press",N.R8.ExplicitRejection):F.x.isKey(e,[P.m.arrowUp,P.m.arrowDown,P.m.enter])&&(c.multiPredictionMenuOpen||await c.clearCurrentPrediction(f,"invalid key press",N.R8.ExplicitRejection))}),[null===(n=null===(t=l.serviceSettings)||void 0===t?void 0:t.predictions)||void 0===n?void 0:n.enablePimMultiPredict,C,f,c,p]),T=L.useCallback((async e=>{e.preventDefault(),e.stopPropagation(),d&&await c.applyCurrentPrediction(N.XG)}),[d,c]),I=L.useCallback((async e=>{if(!p.current)return;let t=Array.from(p.current.getClientRects());t=t.map((e=>{return t=e,new DOMRect(t.x-q,t.y-W,t.width+q+q,t.height+W+W);var t})),t.find((t=>{return n=t,r=e.pageX,i=e.pageY,n.x<=r&&r<=n.x+n.width&&n.y<=i&&i<=n.y+n.height;var n,r,i}))&&(e.preventDefault(),e.stopPropagation(),await c.applyCurrentPrediction(N.XG))}),[p,c]),w=L.useCallback((async e=>{f.isHelperText&&((0,O.m)(e.target)||(0,O.m)(e.relatedTarget))||c.multiPredictionMenuOpen||await c.clearCurrentPrediction(f,"lost focus",N.R8.ImplicitRejection)}),[f,c]),E=L.useCallback((async()=>{await c.isInputPointerAtPrediction()||await c.clearCurrentPrediction(f,"input pointer not at prediction",N.R8.ImplicitRejection)}),[f,c]);L.useEffect((()=>{const e={passive:!0,capture:!0},t=h&&new k.J(h),n=new k.J(document);return null==t||t.addListener("keydown",S),null==t||t.addListener("focusout",w,e),n.addListener("selectionchange",E,e),()=>{null==t||t.removeAllListeners(),n.removeAllListeners()}}),[h,S,w,E]),L.useEffect((()=>{if(!p.current)return;const e=new k.J(p.current),t=new k.J(document);return e.addListener("pointerdown",T,{capture:!0}),d&&t.addListener("pointerdown",I,{capture:!0}),()=>{e.removeAllListeners(),t.removeAllListeners()}}),[I,T,d,p]),L.useEffect((()=>{var e,t,n;null===(n=null===(t=null===(e=l.serviceSettings)||void 0===e?void 0:e.predictions)||void 0===t?void 0:t.onPredictionUpdate)||void 0===n||n.call(t)}),[null===(r=l.serviceSettings)||void 0===r?void 0:r.predictions,m]);const x=L.useCallback((e=>Promise.resolve()),[]);return h?L.createElement("span",{className:"suggestedCompletion",ref:p},L.createElement(B.J,{hostSettings:l,themeStore:g}),(0,R.r)(c.localizer,d,u,f,m,c.predictionParentElement,C,x,f.isHelperText&&"BizChat"===(null===(i=l.hostMetadata)||void 0===i?void 0:i.appName)?4:void 0,null===(a=null===(o=l.serviceSettings)||void 0===o?void 0:o.predictions)||void 0===a?void 0:a.enablePimMultiPredict,null===(s=l.hostMetadata)||void 0===s?void 0:s.appName)):null})),q=20,W=20;var U=n(49278),z=n(38883);let j=class extends U.p{constructor(e,t,n,r,i,o,a,s,l,d,u,c,g,h,p,f,v,m,y){super(e,t,n,r,i,o,a,s,l,d,u,v,f),this._ariaStatusStateStoreFactory=c,this._featureFlagsReader=g,this._themeStore=h,this.languageScriptDirectionDetector=p,this.compositionEventHandler=m,this._isMobile=y,this.shutDown=()=>{this._predictionHTMLElement=void 0,super.shutDown()},this.isInputPointerAtPrediction=async()=>{var e;if(this._prediction&&this._multiPredictionMenuOpen)return!0;const t=await this._tileContent.getTextSelection();return!!t&&!!this._prediction&&t.startPosition===t.endPosition&&(null===(e=t.startParagraphNode)||void 0===e?void 0:e.id)===this._prediction.tileId&&t.endPositionInParagraphNode===this._prediction.currentEndIndex},this.predictionMayOverlapNextLine=e=>Promise.resolve()}allowMiddleOfSentencePredictions(){var e,t,n;return null!==(n=null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.predictions)||void 0===t?void 0:t.allowMiddleOfSentencePredictions)&&void 0!==n&&n}async applyCurrentPrediction(e,t){var n,r,i;if(!this._prediction)return;const o=this._prediction;if(o.isHelperText)return;const a=this.determineIfPredictionTextIsValid(o);if("result"in a)return void await this.clearCurrentPrediction(o,"invalid application",N.R8.ImplicitRejection);const{paragraphNode:s,paragraphNodeOffset:l,insertableTextStart:d,predictionText:u}=a,c=u.substring(d);let g;if(g=this.isEntityPrediction(o.entityType)&&o.entityResults&&d!==o.startIndex?await this._tileContent.getRangeOfNode(s.parent,void 0,l+o.startIndex,d-o.startIndex):await this._tileContent.getNodeInsertionPosition(s.parent,l+d,!0),await this._predictionStore.clearPrediction(),this.isEntityPrediction(o.entityType)&&o.entityResults){const e=null!=t?t:this.getPredictionFirstItem(o);e&&g&&(null===(r=null===(n=this._hostSettings.serviceSettings)||void 0===n?void 0:n.predictions)||void 0===r?void 0:r.onInsertEntityPrediction)&&this._hostSettings.serviceSettings.predictions.onInsertEntityPrediction(o,e,g,s.parent.element)}else await this._tileContent.insert(s.parent,void 0,l+d,c,!0,g,!1,!1),this._featureFlagsReader.flags.enableAriaStatusElement&&(null===(i=this._ariaStatusStateStoreFactory())||void 0===i||i.setStatus(this._localizer.getMessage("ebx_PredictionAppliedMessage",c),"assertive",!1));this.logAcceptedTelemetry(o,d-o.startIndex,!0,e,!!o.entityResults)}async onPredictionUpdated(){var e,t;const n=this._predictionUpdate+1;this._predictionUpdate=n;const r=this._predictionStore.getCurrentPrediction();if(r)await this.determineIfPredictionIsValidAndApply(r,n);else{const n=this._predictionHTMLElement,r=this._predictionParentElement;if(this._prediction=void 0,this._predictionParentElement=void 0,this._predictionContentEditableParentElement=void 0,this._predictionDisplayText=void 0,this._predictionFirstDisplayedTime=void 0,this._predictionHTMLElement=void 0,n)if(z.unmountComponentAtNode(n),null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.predictions)||void 0===t?void 0:t.onDomRemoval)this._hostSettings.serviceSettings.predictions.onDomRemoval(n,r);else{const e=n.parentElement;n.remove(),e&&"div"===e.nodeName.toLowerCase()&&!e.textContent&&0===e.childElementCount&&e.appendChild(e.ownerDocument.createElement("br"))}this._onUpdate&&this._onUpdate()}}async determineIfPredictionIsValidAndApply(e,t,n,r,s,l,d){var u,c,g,h,p,f;if(!this.supportsPredictionType(e.entityType))return void await this.clearCurrentPrediction(e,"unsupported entity type: "+e.entityType,N.R8.NotSeen);if(void 0!==s&&s!==i.Q0.Local&&l&&r&&n)return void await this.handleRemotePredictionUpdate(e,n,r,l);if(r&&r!==e.tileId)return void await this.clearCurrentPrediction(e,"update outside of tile",N.R8.ExplicitRejection);const v=this.determineIfPredictionTextIsValid(e,l,d);if("result"in v){if(v.dueToMissingContainingHTMLElement)return;return void(v.dueToEntirePredictionTyped?await this._predictionStore.clearPrediction():await this.clearCurrentPrediction(e,"invalid delta",N.R8.TypeNotMatchingCharacter))}const{insertableTextStart:m,htmlParentElement:y,contentEditableHtmlParentElement:_,predictionText:b}=v;if(this._prediction=e,this._predictionParentElement=y,this._predictionContentEditableParentElement=_,b.substring(m)!==this._predictionDisplayText){if(this._predictionDisplayText=b.substring(m),!this._predictionHTMLElement){if(null===(u=this.compositionEventHandler)||void 0===u?void 0:u.isComposing)return void(this._predictionHTMLElement=void 0);if(this._predictionHTMLElement=y.ownerDocument.createElement("span"),this._predictionHTMLElement.contentEditable="false",this._predictionHTMLElement.classList.add("ms-prediction"),null===(c=this.compositionEventHandler)||void 0===c?void 0:c.isComposing)return void(this._predictionHTMLElement=void 0);if(t<this._predictionUpdate)return;const n=this._predictionHTMLElement.ownerDocument.getSelection(),r=1===(null==n?void 0:n.rangeCount)?n.getRangeAt(0):void 0;if(!r)return this._logger.log(524882904,a.q.Warn,"Unable to find range of prediction text insertion point in PredictionStateStore."),void await this.clearCurrentPrediction(e,"unable to determine range for prediction",N.R8.NotSeen);{const t=L.createElement(M,{predictionStateStore:this,themeStore:this._themeStore,isMobile:null!==(g=this._isMobile)&&void 0!==g&&g,hostSettings:this._hostSettings,languageScriptDirectionDetector:this.languageScriptDirectionDetector});if((0,o.d)(this._predictionHTMLElement,t),null===(p=null===(h=this._hostSettings.serviceSettings)||void 0===h?void 0:h.predictions)||void 0===p?void 0:p.onDomInsertion){if(!this._hostSettings.serviceSettings.predictions.onDomInsertion(r,this._predictionHTMLElement,y))return void await this.clearCurrentPrediction(e,"host unable to insert prediction",N.R8.NotSeen)}else r.insertNode(this._predictionHTMLElement),n&&n.setBaseAndExtent(r.startContainer,r.startOffset,r.startContainer,r.startOffset)}this._predictionFirstDisplayedTime=new Date,this.logDisplayedTelemetry(e),this._featureFlagsReader.flags.enableAriaStatusElement&&(null===(f=this._ariaStatusStateStoreFactory())||void 0===f||f.setStatus(this._localizer.getMessage(this._isMobile?"ebx_MobilePredictionAvailableMessage":"ebx_PredictionAvailableMessage",e.text),"assertive",!1))}this._onUpdate&&this._onUpdate()}}checkForECCHintTextPrediction(){var e,t,n,r,i,o,a;const s=null===(e=this._inlineSuggestionsRenderer)||void 0===e?void 0:e.getCurrentMenuInfo();if(!s||s.searchBoxGeneratedParagraphId||"InlineSuggestionsResultsUserInitiatedMenuType"!==s.menuType.menuType||s.queryRange.length!==(null!==(n=null===(t=s.queryRange.prefix)||void 0===t?void 0:t.length)&&void 0!==n?n:1)||!(null===(r=this._hostSettings.oaSettings)||void 0===r?void 0:r.enableZeroQueryHintText)&&(!s.enableExpandedECC||!s.enableExpandedECCSearchBar))return!1;const l=this._paragraphTextExtractor.getParagraphText(s.tileId),d=s.queryRange.start+(null!==(o=null===(i=s.queryRange.prefix)||void 0===i?void 0:i.length)&&void 0!==o?o:1),u="BizChat"===(null===(a=this._hostSettings.hostMetadata)||void 0===a?void 0:a.appName)?this.localizer.getMessage("ebx_ECCZeroQueryBizChatHintText")+" ":this.localizer.getMessage("ebx_ECCZeroQueryHintText")+" ";return this._predictionStore.updatePrediction({text:u,context:null==l?void 0:l.substring(0,d),annotationId:"1",tileId:s.tileId,tileVersion:0,entityType:b.c.Text,startIndex:d,length:u.length,shouldDismissOnTextChange:!0,shouldShowInsertionHelperText:!1,isHelperText:!0}),!0}};j=(0,r.__decorate)([(0,m._)(),(0,r.__param)(0,(0,y.W)(s.H)),(0,r.__param)(1,(0,y.W)(l.n)),(0,r.__param)(2,(0,y.W)(d.g)),(0,r.__param)(3,(0,y.W)(u.m)),(0,r.__param)(4,(0,y.W)(I.o)),(0,r.__param)(5,(0,y.W)(E.w)),(0,r.__param)(6,(0,y.W)(x.b)),(0,r.__param)(7,(0,y.W)(A.d)),(0,r.__param)(8,(0,y.W)(c.M5)),(0,r.__param)(9,(0,_.l)()),(0,r.__param)(9,(0,y.W)(C.A)),(0,r.__param)(10,(0,_.l)()),(0,r.__param)(10,(0,y.W)(S.V)),(0,r.__param)(11,(0,y.W)(T.Th)),(0,r.__param)(12,(0,y.W)(g.c)),(0,r.__param)(13,(0,y.W)(D.YQ)),(0,r.__param)(14,(0,y.W)(h.iw)),(0,r.__param)(15,(0,y.W)(p.o)),(0,r.__param)(16,(0,_.l)()),(0,r.__param)(16,(0,y.W)(w.Y)),(0,r.__param)(17,(0,_.l)()),(0,r.__param)(17,(0,y.W)(f.q)),(0,r.__param)(18,(0,_.l)()),(0,r.__param)(18,(0,y.W)(v.n))],j)},43820:(e,t,n)=>{"use strict";n.d(t,{q:()=>w});var r=n(37842),i=n(8676),o=n(37890),a=n(71234),s=n(88670),l=n(46965),d=n(24839),u=n(55908),c=n(16488),g=n(97397),h=n(77145),p=n(27139),f=n(73232),v=n(51480);const m=(e,t)=>{if(!e.parentElement||e===document.body)return document.body;if("absolute"!==t)return e.parentElement;let n=e.parentElement,r=window.getComputedStyle(n);for(;n&&"relative"!==r.position&&n!==document.body;)n=n.parentElement,r=window.getComputedStyle(n);return n},y=()=>!0;var _=n(68443),b=n(95734),C=n(13956);const S=(0,r.F5)({predictionStateStore:i.A.on(o.Tc),localizer:i.A.on(a.H),themeStore:i.A.on(g.YQ).optional(),hostSettings:i.A.on(s.n),languageScriptDirectionDetector:i.A.on(l.iw),safeWindow:i.A.on(d.j),isMobile:i.A.on(u.n).optional()}),T=b.memo((e=>{var t;const{prediction:n,predictionDisplayText:i,targetLocation:a,onApplyCurrentPrediction:s,onClearCurrentPrediction:l,isInputPointerAtPrediction:d,onCurrentPredictionMayOverlapNextLine:u,onEntityDropdownOpened:g,predictionContentEditableParentElement:T,predictionParentElement:I}=e,{hostSettings:w,isMobile:E,languageScriptDirectionDetector:x,localizer:A,predictionStateStore:D,themeStore:k,safeWindow:F}=(0,r.KN)(S),P=b.useRef(null),N=b.useRef(null),B=b.useRef(),O=b.useRef({top:0,left:0}),[R,L]=b.useState({zIndex:"auto",element:void 0,shouldRender:()=>!0,shouldRenderPrediction:()=>!0,shouldObserveSize:()=>[],addHandlers:()=>()=>null,predictionInlineStyles:()=>{},transformPredictionRects:e=>e,getForbiddenRects:()=>[]}),[M,q]=b.useState(!1),[W,U]=b.useState({container:{},overlay:{},anchorStyle:{position:"static"}}),z=Object.assign(Object.assign({},W.overlay),{zIndex:null!==(t=R.zIndex)&&void 0!==t?t:W.overlay.zIndex}),j=b.useCallback((()=>{const e=T.scrollLeft,t=T.scrollTop;P.current&&(P.current.scrollLeft=e,P.current.scrollTop=t)}),[T.scrollLeft,T.scrollTop]),H=b.useCallback((e=>F.requestAnimationFrame(e)),[F]),V=b.useCallback((()=>{const e=(0,f.dB)(T,N.current,O),t=(0,f.Cf)(T);O.current={top:e.top,left:e.left},U((()=>(j(),q(!0),{container:e,overlay:t.overlay,anchorStyle:t.anchor})))}),[T,j]),G=b.useCallback((()=>{H(V)}),[H,V]),Q=()=>(setTimeout((()=>{G(),T.dispatchEvent(new Event("BX-ForceReflow",{bubbles:!0}))}),500),!0),K=()=>{H(j)},$=async e=>{h.x.isKey(e,p.m.tab)?(e.stopPropagation(),e.preventDefault(),await s(e.keyCode)):h.x.isKey(e,[p.m.arrowLeft,p.m.arrowUp,p.m.arrowRight,p.m.arrowDown,p.m.enter,p.m.escape])&&await l("invalid key press",o.R8.ExplicitRejection)},Z=async e=>{e.preventDefault(),e.stopPropagation(),E&&await s(o.XG)},J=()=>{setTimeout((async()=>{D.multiPredictionMenuOpen||await l("lost focus",o.R8.ImplicitRejection)}),100)},X=()=>{F.requestIdleCallback((async()=>{await Y()}),100)},Y=async()=>{await d()||await l("input pointer not at prediction",o.R8.ImplicitRejection)};b.useEffect((()=>{G()}),[G]),b.useEffect((()=>{L(((e,t,n=!0)=>{var r;const i=y,o=y,a=()=>[],s=()=>()=>null,l=()=>{},d=e=>e,u=()=>[];return"body"!==e.tagName.toLowerCase()&&e.parentElement?{element:n?m(e,t):e.parentElement,zIndex:void 0,shouldRender:i,shouldRenderPrediction:o,shouldObserveSize:a,addHandlers:s,predictionInlineStyles:l,transformPredictionRects:d,getForbiddenRects:u}:{element:null!==(r=e.parentElement)&&void 0!==r?r:window.document.body,zIndex:"auto",shouldRender:i,shouldRenderPrediction:o,shouldObserveSize:a,addHandlers:s,predictionInlineStyles:l,transformPredictionRects:d,getForbiddenRects:u}})(T,W.anchorStyle.position))}),[W.anchorStyle.position,T]),b.useEffect((()=>{const e={passive:!0,capture:!0},t=new c.J(window),n=new c.J(document),r=new c.J(T);t.addListener("resize",G,e),t.addListener("hashchange",Q,e),t.addListener("popstate",Q,e),n.addListener("mouseup",Q,e),n.addListener("selectionchange",X,e),r.addListener("paste",Q,e),r.addListener("scroll",K,e),r.addListener("keydown",$),r.addListener("focusout",J,e),(()=>{if(!B.current&&window.ResizeObserver&&(Q(),B.current=new window.ResizeObserver((()=>{G()}))),B.current){B.current.observe(T);for(const e of R.shouldObserveSize(T))B.current.observe(e)}})();const i=R.addHandlers(T,{queueUpdateOverlay:G,updateOverlayAndNotifyInput:Q});return()=>{t.removeAllListeners(),n.removeAllListeners(),r.removeAllListeners(),B.current&&B.current.disconnect(),i()}}),[]),b.useEffect((()=>{if(!N.current)return;const e=new c.J(N.current);return e.addListener("mousedown",Z),()=>{e.removeAllListeners()}}),[N,Z]);const ee=b.useCallback((async e=>{await u(e)}),[u]),te=b.useCallback((e=>{g(e)}),[g]),ne=window.getComputedStyle(T),re=parseInt(ne.paddingLeft,10),ie=parseInt(ne.paddingTop,10),oe=(a.x,a.y-ie);return R.element?b.createElement(C.Ay.div,{className:"ms-editor-text-prediction"},b.createElement(v.J,{hostSettings:w,themeStore:k}),b.createElement("div",{ref:N,style:W.container},b.createElement("div",{id:"ms-editor-text-prediction-overlay",style:z,className:"hc-noadjust"},b.createElement("div",{style:{paddingTop:oe+"px"}}),M&&(0,_.r)(A,null!=E&&E,x,n,i,I,te,ee,re)))):null})),I=(0,r.F5)({predictionStateStore:i.A.on(o.Tc)}),w=()=>{const{predictionStateStore:e}=(0,r.KN)(I),[t,n]=b.useState(),[i,o]=b.useState(),a=()=>{n(e.prediction),o(e.predictionDisplayText)};b.useEffect((()=>(e.setOnUpdate(a),()=>{e.setOnUpdate(void 0)})),[e]);const s=b.useCallback((async t=>{await e.applyCurrentPrediction(t)}),[]),l=b.useCallback((async(t,n)=>{e.prediction&&await e.clearCurrentPrediction(e.prediction,t,n)}),[]),d=b.useCallback((async()=>e.isInputPointerAtPrediction()),[]),u=b.useCallback((async t=>{await e.predictionMayOverlapNextLine(t)}),[]),c=b.useCallback((n=>{e.onEntityDropdownOpened(t,n)}),[]);return t&&e.prediction&&e.predictionDisplayLocation&&e.predictionParentElement&&e.predictionContentEditableParentElement?b.createElement(T,{prediction:t,predictionDisplayText:i,targetLocation:e.predictionDisplayLocation,predictionContentEditableParentElement:e.predictionContentEditableParentElement,predictionParentElement:e.predictionParentElement,onApplyCurrentPrediction:s,onClearCurrentPrediction:l,isInputPointerAtPrediction:d,onCurrentPredictionMayOverlapNextLine:u,onEntityDropdownOpened:c}):null}},98976:(e,t,n)=>{"use strict";n.d(t,{O:()=>w});var r=n(30206),i=n(85230),o=n(48717),a=n(71234),s=n(88670),l=n(52996),d=n(49520),u=n(41260),c=n(79548),g=n(48828),h=n(90424),p=n(30225),f=n(26017),v=n(84622),m=n(28363),y=n(72131),_=n(87151),b=n(14193),C=n(11966),S=n(43900),T=n(37890),I=n(49278);let w=class extends I.p{constructor(e,t,n,r,i,o,a,s,l,d,u,c,g){super(e,t,n,r,i,o,a,l,s,u,c,g,d),this._predictionHasWrappedOntoNewLineCount=0,this.isInputPointerAtPrediction=async()=>{var e,t;if(this._prediction&&this._multiPredictionMenuOpen)return!0;const n=await this._tileContent.getTextSelection();return!!n&&!!this._prediction&&n.startPosition===n.endPosition&&(null===(e=n.startParagraphNode)||void 0===e?void 0:e.id)===this._prediction.tileId&&n.endPositionInParagraphNode===(null===(t=n.endParagraphNode)||void 0===t?void 0:t.element).span-(void 0===this.getNextParagraphAfterPrediction()?0:1)},this.removeWrappingNewLines=async()=>{var e;const t=this.getNextParagraphAfterPrediction();(null===(e=null==t?void 0:t.parent)||void 0===e?void 0:e.element)&&t.element&&0!==this._predictionHasWrappedOntoNewLineCount&&await this.removeNewLines(t.parent,t.element.offset,this._predictionHasWrappedOntoNewLineCount)},this.insertNewLines=async(e,t,n)=>{let r="";for(let e=0;e<n;e++)r+="\n";this._isActivelyAddingWrappingNewLines=!0,await this._tileContent.insert(e,void 0,t,r,!1,void 0,!0,!1),this._isActivelyAddingWrappingNewLines=!1},this.removeNewLines=async(e,t,n)=>{this._isActivelyAddingWrappingNewLines=!0;for(let r=0;r<n;r++)await this._tileContent.remove(e,void 0,t-1,1,!1,void 0,!0,!1);this._isActivelyAddingWrappingNewLines=!1},this.getNextParagraphAfterPrediction=()=>{var e;if(this._prediction){const t=this._proofingDom.findParagraphNode(this._prediction.tileId);if((null==t?void 0:t.parent)&&t.element&&"offset"in t.element){const n=t.element.offset+t.element.span;let r;return null===(e=t.parent.children)||void 0===e||e.forEach((e=>{e.element&&"offset"in e.element&&e.element.offset>=n&&(!r||r.element&&e.element.offset<r.element.offset)&&(r=e)})),r}}}}allowMiddleOfSentencePredictions(){return!1}async applyCurrentPrediction(e,t){var n,r;if(!this._prediction)return;const i=this._prediction,o=this.determineIfPredictionTextIsValid(i);if("result"in o)return void await this.clearCurrentPrediction(i,"invalid application",T.R8.ImplicitRejection);const{paragraphNode:a,paragraphNodeOffset:s,insertableTextStart:l,predictionText:d}=o,u=d.substring(l);this._predictionHasWrappedOntoNewLineAtStartOfTile&&(await this.removeWrappingNewLines(),this._predictionHasWrappedOntoNewLineAtStartOfTile=void 0,this._predictionHasWrappedOntoNewLineCount=0);const c=await this._tileContent.getNodeInsertionPosition(a.parent,s+l,!0);if(await this._predictionStore.clearPrediction(),this.isEntityPrediction(i.entityType)){const e=null!=t?t:this.getPredictionFirstItem(i);e&&c&&(null===(r=null===(n=this._hostSettings.serviceSettings)||void 0===n?void 0:n.predictions)||void 0===r?void 0:r.onInsertEntityPrediction)&&this._hostSettings.serviceSettings.predictions.onInsertEntityPrediction(i,e,c,a.parent.element)}else a.parent&&await this._tileContent.insert(a.parent,void 0,s+l,u,!0,c,!1,!1);this.logAcceptedTelemetry(i,l-i.startIndex,!0,e,!!i.entityResults)}async predictionMayOverlapNextLine(e){var t,n,r;if(!this._prediction||this._prediction.entityType!==f.c.File&&this._prediction.entityType!==f.c.People){if(this._predictionHasWrappedOntoNewLineAtStartOfTile){if(e>this._predictionHasWrappedOntoNewLineCount){const n=this.getNextParagraphAfterPrediction();(null===(t=null==n?void 0:n.parent)||void 0===t?void 0:t.element)&&n.element&&(await this.insertNewLines(n.parent,n.element.offset,e-this._predictionHasWrappedOntoNewLineCount),this._predictionHasWrappedOntoNewLineAtStartOfTile=n.id,this._predictionHasWrappedOntoNewLineCount=e)}else if(e<this._predictionHasWrappedOntoNewLineCount){const t=this.getNextParagraphAfterPrediction();(null===(n=null==t?void 0:t.parent)||void 0===n?void 0:n.element)&&t.element&&(await this.removeNewLines(t.parent,t.element.offset,this._predictionHasWrappedOntoNewLineCount-e),this._predictionHasWrappedOntoNewLineCount=e)}}else if(0!==e){const t=this.getNextParagraphAfterPrediction();(null===(r=null==t?void 0:t.parent)||void 0===r?void 0:r.element)&&t.element&&(this._predictionHasWrappedOntoNewLineAtStartOfTile=t.id,this._predictionHasWrappedOntoNewLineCount=e,await this.insertNewLines(t.parent,t.element.offset,e))}}else 0!==e&&await this.clearCurrentPrediction(this._prediction,"Entity cannot wrap",T.R8.NotSeen)}async onPredictionUpdated(){const e=this._predictionUpdate+1;this._predictionUpdate=e;const t=this._predictionStore.getCurrentPrediction();t?await this.determineIfPredictionIsValidAndApply(t,e):(this._predictionHasWrappedOntoNewLineAtStartOfTile&&await this.removeWrappingNewLines(),this._prediction=void 0,this._predictionParentElement=void 0,this._predictionContentEditableParentElement=void 0,this._predictionDisplayText=void 0,this._predictionDisplayLocation=void 0,this._predictionHasWrappedOntoNewLineAtStartOfTile=void 0,this._predictionHasWrappedOntoNewLineCount=0,this._predictionFirstDisplayedTime=void 0,this._onUpdate&&this._onUpdate())}async determineIfPredictionIsValidAndApply(e,t,n,r,a,s,l){var d;if(!this.supportsPredictionType(e.entityType))return void await this.clearCurrentPrediction(e,"unsupported entity type: "+e.entityType,T.R8.NotSeen);if(void 0!==a&&a!==i.Q0.Local&&s&&r&&n)return void await this.handleRemotePredictionUpdate(e,n,r,s);if(r&&r!==e.tileId)return void await this.clearCurrentPrediction(e,"update outside of tile",T.R8.ExplicitRejection);const u=this.determineIfPredictionTextIsValid(e,s,l);if("result"in u){if(u.dueToMissingContainingHTMLElement)return;return void(u.dueToEntirePredictionTyped?await this._predictionStore.clearPrediction():await this.clearCurrentPrediction(e,"invalid delta",T.R8.ExplicitRejection))}const{paragraphNode:c,paragraphNodeOffset:g,insertableTextStart:h,htmlParentElement:p,contentEditableHtmlParentElement:f,predictionText:v}=u,m=this._paragraphTextExtractor.getParagraphText(e.tileId),y=await this._tileContent.getRangeOfNode(c.parent,void 0,g+h-1,1),_=null==y?void 0:y.commonAncestorContainer.parentElement;if(y&&_){const n=y.getBoundingClientRect(),r=p.getBoundingClientRect();let i=0;if((0,o.C)(_,"HTMLElement")){const e=_.getBoundingClientRect(),t=new Range;t.setStart(_,0),t.setEnd(_,1),i=t.getBoundingClientRect().top-e.top}if(this._predictionHasWrappedOntoNewLineAtStartOfTile&&(null===(d=this.prediction)||void 0===d?void 0:d.annotationId)!==e.annotationId&&(await this.removeWrappingNewLines(),this._predictionHasWrappedOntoNewLineAtStartOfTile=void 0,this._predictionHasWrappedOntoNewLineCount=0),t<this._predictionUpdate)return;if(m!==this._paragraphTextExtractor.getParagraphText(e.tileId)){this._predictionDisplayText=void 0;const t=this._predictionUpdate+1;return this._predictionUpdate=t,void await this.determineIfPredictionIsValidAndApply(e,t)}const a=void 0===this._prediction;if(this._prediction=e,this._predictionParentElement=p,this._predictionContentEditableParentElement=f,this._predictionDisplayLocation={x:n.right-r.left,y:n.top-i-r.top},v.substring(h)===this._predictionDisplayText)return;this._predictionDisplayText=v.substring(h),a&&(this._predictionFirstDisplayedTime=new Date,this.logDisplayedTelemetry(e)),this._onUpdate&&this._onUpdate()}else await this.clearCurrentPrediction(e,"unable to determine range for prediction",T.R8.NotSeen)}};w=(0,r.__decorate)([(0,g._)(),(0,r.__param)(0,(0,h.W)(a.H)),(0,r.__param)(1,(0,h.W)(s.n)),(0,r.__param)(2,(0,h.W)(l.g)),(0,r.__param)(3,(0,h.W)(d.m)),(0,r.__param)(4,(0,h.W)(y.o)),(0,r.__param)(5,(0,h.W)(b.w)),(0,r.__param)(6,(0,h.W)(C.b)),(0,r.__param)(7,(0,h.W)(u.M5)),(0,r.__param)(8,(0,h.W)(S.d)),(0,r.__param)(9,(0,h.W)(c.o)),(0,r.__param)(10,(0,p.l)()),(0,r.__param)(10,(0,h.W)(v.A)),(0,r.__param)(11,(0,p.l)()),(0,r.__param)(11,(0,h.W)(m.V)),(0,r.__param)(12,(0,p.l)()),(0,r.__param)(12,(0,h.W)(_.Y))],w)},11311:(e,t,n)=>{var r={"./af-za/ui-strings.json":[2272,4077],"./am-et/ui-strings.json":[25729,6152],"./ar-sa/ui-strings.json":[67375,7814],"./as-in/ui-strings.json":[20085,9212],"./az-latn-az/ui-strings.json":[33608,4661],"./bg-bg/ui-strings.json":[95589,2263],"./bn-in/ui-strings.json":[14217,1208],"./bs-latn-ba/ui-strings.json":[47202,9551],"./ca-es-valencia/ui-strings.json":[3608,9765],"./ca-es/ui-strings.json":[90544,3629],"./cs-cz/ui-strings.json":[22945,7248],"./cy-gb/ui-strings.json":[10959,2606],"./da-dk/ui-strings.json":[54492,2881],"./de-de/ui-strings.json":[52450,263],"./el-gr/ui-strings.json":[16402,1471],"./en-gb/ui-strings.json":[38020,7377],"./en-us/ui-strings.json":[16279,5398],"./es-es/ui-strings.json":[82232,5133],"./es-mx/ui-strings.json":[26455,8446],"./et-ee/ui-strings.json":[59419,1698],"./eu-es/ui-strings.json":[22254,91],"./fa-ir/ui-strings.json":[6712,9925],"./fi-fi/ui-strings.json":[27590,5867],"./fil-ph/ui-strings.json":[77009,4920],"./fr-ca/ui-strings.json":[44548,3233],"./fr-fr/ui-strings.json":[63868,2625],"./ga-ie/ui-strings.json":[53434,4831],"./gd-gb/ui-strings.json":[55992,8197],"./gl-es/ui-strings.json":[16819,9842],"./gu-in/ui-strings.json":[14985,368],"./he-il/ui-strings.json":[21660,4529],"./hi-in/ui-strings.json":[11934,6075],"./hr-hr/ui-strings.json":[70520,5581],"./hu-hu/ui-strings.json":[57138,9047],"./hy-am/ui-strings.json":[28537,9536],"./id-id/ui-strings.json":[23794,5559],"./is-is/ui-strings.json":[46448,5],"./it-it/ui-strings.json":[61426,2839],"./ja-jp/ui-strings.json":[61887,4230],"./ka-ge/ui-strings.json":[27556,6121],"./kk-kz/ui-strings.json":[43913,9320],"./km-kh/ui-strings.json":[73289,1184],"./kn-in/ui-strings.json":[59456,3077],"./ko-kr/ui-strings.json":[97333,1756],"./kok-in/ui-strings.json":[7656,3109],"./lb-lu/ui-strings.json":[21755,682],"./lo-la/ui-strings.json":[72540,2921],"./lt-lt/ui-strings.json":[99072,7061],"./lv-lv/ui-strings.json":[71280,8597],"./mi-nz/ui-strings.json":[46090,7551],"./mk-mk/ui-strings.json":[78200,189],"./ml-in/ui-strings.json":[94792,6277],"./mr-in/ui-strings.json":[88290,8151],"./ms-my/ui-strings.json":[11566,2067],"./mt-mt/ui-strings.json":[7706,9311],"./nb-no/ui-strings.json":[3201,6024],"./ne-np/ui-strings.json":[7763,3058],"./nl-nl/ui-strings.json":[1428,9881],"./nn-no/ui-strings.json":[38653,9916],"./or-in/ui-strings.json":[96008,2781],"./pa-in/ui-strings.json":[13470,4955],"./pl-pl/ui-strings.json":[37624,2461],"./pt-br/ui-strings.json":[69912,309],"./pt-pt/ui-strings.json":[25288,1149],"./quz-pe/ui-strings.json":[40591,2686],"./ro-ro/ui-strings.json":[35458,903],"./ru-ru/ui-strings.json":[82374,6107],"./sk-sk/ui-strings.json":[8360,4061],"./sl-si/ui-strings.json":[17007,8062],"./sq-al/ui-strings.json":[17823,7278],"./sr-cyrl-ba/ui-strings.json":[39527,6902],"./sr-cyrl-rs/ui-strings.json":[58649,2832],"./sr-latn-rs/ui-strings.json":[28014,6811],"./sv-se/ui-strings.json":[50749,300],"./ta-in/ui-strings.json":[78458,4255],"./te-in/ui-strings.json":[90422,8979],"./th-th/ui-strings.json":[3704,317],"./tr-tr/ui-strings.json":[33848,2413],"./tt-ru/ui-strings.json":[93455,1662],"./ug-cn/ui-strings.json":[14827,8730],"./uk-ua/ui-strings.json":[98766,2659],"./ur-pk/ui-strings.json":[32624,7069],"./uz-latn-uz/ui-strings.json":[65488,9773],"./vi-vn/ui-strings.json":[87565,7572],"./zh-cn/ui-strings.json":[33561,9952],"./zh-tw/ui-strings.json":[37873,2128]};function i(e){if(!n.o(r,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],i=t[0];return n.e(t[1]).then((()=>n.t(i,19)))}i.keys=()=>Object.keys(r),i.id=11311,e.exports=i},29594:(e,t,n)=>{"use strict";n.d(t,{$:()=>o,Y:()=>i});const r=(()=>{const e=(()=>{if("undefined"==typeof globalThis){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window}return globalThis})();return void 0===e.Office&&(e.Office={}),void 0===e.Office.Editor&&(e.Office.Editor={}),e})().Office.Editor;function i(e){r.stringProvider=e}function o(){return r.stringProvider}},86388:(e,t,n)=>{"use strict";var r;n.d(t,{h:()=>r}),function(e){e.Undefined="Undefined",e.Host="Host",e.Authentication="Authentication",e.ExceptionHandling="ExceptionHandling",e.Navigation="Navigation",e.UiRendering="UiRendering",e.FeatureSuppression="FeatureSuppression",e.AtAGlance="AtAGlance",e.BxPromo="BxPromo",e.ContentCreation="ContentCreation",e.CritiqueUpsell="CritiqueUpsell",e.WritingAnalytics="WritingAnalytics",e.TableStyles="TableStyles",e.Similarity="Similarity",e.Goals="Goals",e.Feedback="Feedback",e.PremiumSquigglesPreview="PremiumSquigglesPreview",e.Proofing="Proofing",e.EditorScore="EditorScore",e.PremiumPreview="PremiumPreview",e.TonalRewriteFre="TonalRewriteFre",e.WritersUnblock="WritersUnblock",e.AIFeedback="AIFeedback"}(r||(r={}))},20399:(e,t,n)=>{"use strict";var r;n.d(t,{q:()=>r}),function(e){e[e.Info=0]="Info",e[e.Warn=1]="Warn",e[e.Error=2]="Error",e[e.Debug=3]="Debug"}(r||(r={}))},72896:(e,t,n)=>{"use strict";function r(e){return e instanceof Error?JSON.stringify(e,["name","message","stack"]):JSON.stringify(e)}n.d(t,{v:()=>r})},90935:(e,t,n)=>{"use strict";n.d(t,{C:()=>d,L:()=>l});var r=n(17570),i=n(72896);class o{constructor(e){this._loggerSettings=e}logData(e){this._loggerSettings.logToConsole&&console.log((0,i.v)(e))}}const a=new class{constructor(e=!1){this.useConsoleLogger=e,this._consoleLogger=new o({logToConsole:!0})}logEvent(e,t,n,r,i,o,a,s){const l=`${n}.${t}`;this.useConsoleLogger&&this._consoleLogger.logData({message:l,data:i})}logKpi(e,t,n,r,i){const o=`KPIs.${e}`;this.useConsoleLogger&&this._consoleLogger.logData({kpiEvent:`${o}.${t}`,engagement:n,data:i})}logStandaloneMetric(e,t,n,r,i){this.useConsoleLogger&&this._consoleLogger.logData({standaloneMetric:e})}createActivity(e,t){const n=`${t}.${e}`;return this.useConsoleLogger&&this._consoleLogger.logData({activity:n}),{cv:new r.CV(""),setResult:()=>{},endNow:()=>{},createChildActivity:()=>{throw new Error("Not implemented")},telemetryProperties:{},dataFields:[],eventName:"",eventFlags:{}}}};let s;function l(e){s=e}function d(){return s||a}},97397:(e,t,n)=>{"use strict";n.d(t,{UC:()=>R,YQ:()=>o,h1:()=>j,ZP:()=>xe,SV:()=>r,O1:()=>Ae.O,w:()=>B,Cx:()=>P,iN:()=>O,yF:()=>N});var r,i=n(63837);!function(e){e.light="light",e.dark="dark",e.highContrast="highContrast",e.custom="custom"}(r||(r={}));const o=(0,i.f)("IThemeStore"),a=new Map([[r.light,{fill:{color:"#424242"}}],[r.dark,{fill:{color:"#FFFFFF"}}],[r.highContrast,{fill:{color:"#FFFFFF"}}]]),s="CopilotEccIcon",l=new Map([[r.light,{background:{resting:"#FFFFFF",hover:"#F3F2F1",pressed:"#EDEBE9",disabled:"#A19F9D"},border:"#FFFFFF",text:{resting:"#201F1E",disabled:"#A19F9D"},tag:{resting:"#605E5C"},altText:{resting:"#605E5C"},icon:{resting:"#797775",disabled:"#A19F9D"},altIcon:{resting:"#616161",hover:"#185ABD",pressed:"#185ABD",disabled:"#CCCCCC"},grammarText:{resting:"#3355FF"},refinementText:{resting:"#5A4EBC"},rewriteText:{resting:"#5A4EBC"},suggestionMenuHoverBackground:"#F3F2F1",header:"#3B3A39",subheader:"#605E5C",dialogText:"#605E5C",iconText:"#605E5C",contextText:"#605E5C",errorText:"#FF0000",separator:"#E1DFDD",focusRing:"#201F1E",link:"#1651AA",linkPressed:"#13458F",branding:{type:"IconAndTextButton",background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},icon:{resting:"#185ABD",disabled:"#BDBDBD"},title:{resting:"#185ABD",disabled:"#BDBDBD"},tooltip:{textColor:"#201F1E"},focusRing:"#323130"},addOnFooterBackground:"#F3F2F1",upsellFooterColor:"#EFF6FC",addOnFooterMessage:"#201F1E",premiumEmphasis:"#185ABD",addOnAction:"#185ABD",editorIcon:"#185ABD",correctionHighlight:"#D4EDD4",helpLink:{text:{resting:"#1651AA",hover:"#13458F",pressed:"#13458F",disabled:"#A19F9D"},focusRing:"#201F1E"}}],[r.dark,{background:{resting:"#1B1A19",hover:"#252423",pressed:"#292827",disabled:"#797775"},border:"#1B1A19",text:{resting:"#FAF9F8",disabled:"#797775"},tag:{resting:"#A19F9D"},altText:{resting:"#A19F9D"},icon:{resting:"#A19F9D",disabled:"#797775"},altIcon:{resting:"#616161",hover:"#82ABF1",pressed:"#82ABF1",disabled:"#797775"},grammarText:{resting:"#99AAF5"},refinementText:{resting:"#ADA2F2"},rewriteText:{resting:"#ADA2F2"},suggestionMenuHoverBackground:"#252423",header:"#C8C6C4",subheader:"#A19F9D",dialogText:"#A19F9D",iconText:"#A19F9D",contextText:"#A19F9D",errorText:"#FF0000",separator:"#484644",focusRing:"#C8C6C4",link:"#3D7CE8",linkPressed:"#598FEC",branding:{type:"IconAndTextButton",background:{resting:"#1B1A19",hover:"#383838",pressed:"#2E2E2E",disabled:"#383838"},icon:{resting:"#82ABF1",disabled:"#5C5C5C"},title:{resting:"#82ABF1",disabled:"#5C5C5C"},tooltip:{textColor:"#FFFFFF"},focusRing:"#323130"},addOnFooterBackground:"#252423",upsellFooterColor:"#092C47",addOnFooterMessage:"#FAF9F8",premiumEmphasis:"#598FEC",addOnAction:"#598FEC",editorIcon:"#598FEC",correctionHighlight:"#095E09",helpLink:{text:{resting:"#3D7CE8",hover:"#598FEC",pressed:"#598FEC",disabled:"#797775"},focusRing:"#C8C6C4"}}],[r.highContrast,{background:{resting:"#000000",hover:"#1AEBFF",pressed:"#1AEBFF",disabled:"#000000"},border:"#FFFFFF",text:{resting:"#FFFFFF",hover:"#000000",disabled:"#FFFFFF"},tag:{resting:"#FFFFFF",hover:"#000000"},altText:{resting:"#FFFFFF",hover:"#000000"},icon:{resting:"#FFFFFF",disabled:"#FFFFFF"},altIcon:{resting:"#FFFFFF",hover:"#000000",pressed:"#000000",disabled:"#FFFFFF"},grammarText:{resting:"#FFFFFF",hover:"#000000"},refinementText:{resting:"#FFFFFF",hover:"#000000"},rewriteText:{resting:"#FFFFFF"},suggestionMenuHoverBackground:"#000000",header:"#FFFFFF",subheader:"#FFFFFF",dialogText:"#FFFFFF",iconText:"#FFFFFF",contextText:"#FFFFFF",errorText:"#FFFFFF",separator:"#FFFFFF",focusRing:"#1AEBFF",link:"#FFFF01",linkPressed:"#FFFF01",branding:{type:"IconAndTextButton",background:{resting:"#000000",hover:"#1AEBFF",pressed:"#1AEBFF",disabled:"#000000"},icon:{resting:"#FFFFFF",hover:"#000000",disabled:"#FFFFFF"},title:{resting:"#FFFFFF",hover:"#000000",disabled:"#FFFFFF"},tooltip:{textColor:"#FFFFFF"},focusRing:"#1AEBFF"},addOnFooterBackground:"#000000",upsellFooterColor:"#000000",addOnFooterMessage:"#FFFFFF",premiumEmphasis:"#FFFFFF",addOnAction:"#FFFFFF",editorIcon:"#FFFFFF",correctionHighlight:"#FFFFFF",helpLink:{text:{resting:"#FFFF01",hover:"#FFFF01",pressed:"#FFFF01",disabled:"#FFFF01"},focusRing:"#FFFF01"},callout:{borderColor:"#FFFFFF"}}]]),d="CritiqueCallout";var u,c,g,h=n(80967);!function(e){e.shade30="#004578",e.shade20="#005a9e",e.shade10="#106ebe",e.primary="#0078d4",e.tint10="#2b88d8",e.tint20="#c7e0f4",e.tint30="#deecf9",e.tint40="#eff6fc"}(u||(u={})),function(e){e.black="#000000",e.gray220="#11100f",e.gray210="#161514",e.gray200="#1b1a19",e.gray190="#201f1e",e.gray180="#252423",e.gray170="#292827",e.gray160="#323130",e.gray150="#3b3a39",e.gray140="#484644",e.gray130="#605e5c",e.gray120="#797775",e.gray110="#8a8886",e.gray100="#979593",e.gray90="#a19f9d",e.gray80="#b3b0ad",e.gray70="#bebbb8",e.gray60="#c8c6c4",e.gray50="#d2d0ce",e.gray40="#e1dfdd",e.gray30="#edebe9",e.gray20="#f3f2f1",e.gray10="#faf9f8",e.white="#ffffff"}(c||(c={})),function(e){e.pinkRed10="#750b1c",e.red20="#a4262c",e.red10="#d13438",e.redOrange20="#603d30",e.redOrange10="#da3b01",e.orange30="#8e562e",e.orange20="#ca5010",e.orange10="#ffaa44",e.yellow10="#fce100",e.orangeYellow20="#986f0b",e.orangeYellow10="#c19c00",e.yellowGreen10="#8cbd18",e.green20="#0b6a0b",e.green10="#498205",e.greenCyan10="#00ad56",e.cyan40="#005e50",e.cyan30="#005b70",e.cyan20="#038387",e.cyan10="#00b7c3",e.cyanBlue20="#004e8c",e.cyanBlue10="#0078d4",e.blue10="#4f6bed",e.blueMagenta40="#373277",e.blueMagenta30="#5c2e91",e.blueMagenta20="#8764b8",e.blueMagenta10="#8378de",e.magenta20="#881798",e.magenta10="#c239b3",e.magentaPink20="#9b0062",e.magentaPink10="#e3008c",e.gray40="#393939",e.gray30="#7a7574",e.gray20="#69797e",e.gray10="#a0aeb2"}(g||(g={}));const p=new Map([[r.light,{background:{resting:c.white,hover:"#F5F5F5",pressed:"#CFE4FA"},footerButtonBackground:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},text:{resting:c.gray190,disabled:"#707070"},altIcon:{resting:"#616161",hover:"#185ABD",pressed:"#185ABD",disabled:"#CCCCCC"},actionButtonForeground:{resting:"#0078D4"},highlightingBorderColor:c.gray190,branding:{type:"IconAndTextButton",background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},icon:{resting:"#185ABD",disabled:"#BDBDBD"},title:{resting:"#185ABD",disabled:"#BDBDBD"},tooltip:{textColor:"#201F1E"},focusRing:"#323130"},highlighting:"#EBF3FC",altText:{resting:c.gray130},shimmer:{shimmerColor:c.gray20,shimmerWaveColor:c.gray30},scroll:{thumbColor:"#676767"},tooltip:{directionHint:h.A8.rightCenter},tag:{background:"#EBF3FC",textColor:"#0F6CBD"},headerUnderlineColor:"#106CBD",fallbackIcon:{background:"#EBEBEB"},meetingBanner:{backgroundColor:"#FAF9F8",text:"#424242",iconPrimaryColor:"#616161",borderColor:"#d1d1d1"}}],[r.dark,{background:{resting:"#2E2E2E",hover:"#1F1F1F",pressed:"#0F6CBD"},footerButtonBackground:{resting:"#2E2E2E",hover:"#383838",pressed:"#2E2E2E",disabled:"#383838"},text:{resting:c.white,disabled:"#707070"},highlightingBorderColor:c.white,altText:{resting:"#D6D6D6"},altIcon:{resting:"#FFFFFF",hover:"#82ABF1",pressed:"#82ABF1"},actionButtonForeground:{resting:"#598FEC"},highlighting:"#115EA3",branding:{type:"IconAndTextButton",background:{resting:"#2E2E2E",hover:"#383838",pressed:"#2E2E2E",disabled:"#383838"},icon:{resting:"#82ABF1",disabled:"#5C5C5C"},title:{resting:"#82ABF1",disabled:"#5C5C5C"},tooltip:{textColor:"#FFFFFF"},focusRing:"#323130"},shimmer:{shimmerColor:"#3D3D3D",shimmerWaveColor:"#474747"},scroll:{thumbColor:"#FFFFFF80"},tooltip:{backgroundColor:"#1B1A19",textColor:"#FFFFFF",directionHint:h.A8.rightCenter},tag:{background:"#082338",textColor:"#62ABF5"},headerUnderlineColor:"#106CBD",fallbackIcon:{background:"#3D3D3D"},meetingBanner:{backgroundColor:"#141414",text:"#ffffff",iconPrimaryColor:"#adadad",borderColor:"#666666"},noSuggestions:{descriptionTextColor:"#707070",item:{background:{resting:"#2E2E2E",hover:"#1F1F1F",pressed:"#0F6CBD",disabled:void 0},text:{resting:"#598FEC"},actionButtonForeground:{resting:"#598FEC"},highlighting:"#292929"}}}]]),f="ExpandedInlineSuggestion",v=new Map([[r.light,{background:"linear-gradient(93.85deg, #EEF3FB 58.87%, #EAE9FF 100%)",buttonBackground:"white",textColor:"#323130",linkColor:"#2E6AC5",dismissColor:"#323130",iconColor:"#185ABD",newTag:{shadow:"0px 1.6px 3.56px 0px rgba(0, 0, 0, 0.13)",background:"#FFFFFF",textColor:"#185ABD"},pagination:{textColor:"#185ABD",arrow:{background:{resting:"transparent",hover:"transparent"},disabledButtonColor:"grey"}},tooltip:{background:"#FFFFFF",textColor:"#201F1E"}}],[r.dark,{background:"linear-gradient(93.85deg, #0C2145 58.87%, #0C2145 100%)",buttonBackground:"linear-gradient(93.85deg, #0C2145 58.87%, #0C2145 100%)",textColor:"white",linkColor:"#82ABF1",dismissColor:"white",iconColor:"#82ABF1",newTag:{background:"#82ABF1",textColor:"#0C2145"},pagination:{textColor:"#82ABF1",arrow:{background:{resting:"transparent",hover:"transparent"},disabledButtonColor:"grey"}},tooltip:{background:"#1B1A19",textColor:"#FFFFFF"},shimmer:{shimmerColor:"#052865"}}]]),m="FooterFRE",y=new Map([[r.light,{background:"#0F6CBD",shadow:"0px 4px 8px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)",borderRadius:{default:"4px",disabled:"0px"},display:"flex",width:"32px",height:"32px",color:"#FFFFFF",border:"none",critiqueCategoryText:{fontFamily:"segoeUi",fontSize:"14px",lineHeight:"18px",fontStyle:"normal",padding:"5px",color:"#000000",minWidth:"unset",fontWeight:"600"},critiqueCategoryNumber:{fontFamily:"bahnschrift",font:"bahnschrift",fontSize:"16px",lineHeight:"18px"},indicatorButtonText:{textAlign:"center",fontFamily:"bahnschrift",fontSize:"16px",minWidth:"unset",padding:"12px",fontWeight:"600"},suggestionNumberText:{padding:"3px"}}]]),_="Indicator",b=new Map([[r.light,{background:{resting:"#EBEBEB",hover:"#f5f5f5"},text:{resting:"#616161"}}],[r.dark,{background:{resting:"#EBEBEB",hover:"#f5f5f5"},text:{resting:"#616161"}}],[r.highContrast,{background:{resting:"#000000",hover:"#1AEBFF"},text:{resting:"white",hover:"black"}}]]),C="InlineNudgeBubble",S=new Map([[r.light,{background:{resting:"#FFFFFF",hover:"#F0F0F0"},footerButtonBackground:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},text:{resting:"#201F1E",disabled:"#A19F9D"},altIcon:{resting:"#424242",hover:"#185ABD",pressed:"#185ABD",disabled:"#CCCCCC"},altText:{resting:"#605E5C"},highlightingBorderColor:"#201F1E",actionButtonForeground:{resting:"#0078D4"},highlighting:"#F5F5F5",branding:{type:"IconAndTextButton",background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},icon:{resting:"#185ABD",disabled:"#BDBDBD"},title:{resting:"#185ABD",disabled:"#BDBDBD"},tooltip:{textColor:"#201F1E"},focusRing:"#323130"},shimmer:{shimmerColor:"#F3F2F1",shimmerWaveColor:"#EDEBE9"},scroll:{thumbColor:"#bdbdbd"},tag:{background:"#EBF3FC",textColor:"#0F6CBD"},noSuggestions:{descriptionTextColor:"#616161",item:{background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#F0F0F0"},text:{resting:"#185ABD",disabled:"#707070"},actionButtonForeground:{resting:"#0078D4",disabled:"#707070"},highlighting:"#F5F5F5"}}}],[r.dark,{background:{resting:"#1B1A19",hover:"#3D3D3D",pressed:"#292827",disabled:"#797775"},footerButtonBackground:{resting:"#1B1A19",hover:"#3D3D3D",pressed:"#292827",disabled:"#797775"},text:{resting:"#FAF9F8",disabled:"#797775"},highlightingBorderColor:"#FAF9F8",altText:{resting:"#A19F9D"},altIcon:{resting:"#FFFFFF",hover:"#82ABF1",pressed:"#82ABF1"},actionButtonForeground:{resting:"#598FEC"},highlighting:"#292929",branding:{type:"IconAndTextButton",background:{resting:"#1b1a19",hover:"#383838",pressed:"#2E2E2E",disabled:"#383838"},icon:{resting:"#82ABF1",disabled:"#5C5C5C"},title:{resting:"#82ABF1",disabled:"#5C5C5C"},tooltip:{textColor:"#FFFFFF"},focusRing:"#323130"},shimmer:{shimmerColor:"#3D3D3D",shimmerWaveColor:"#474747"},scroll:{thumbColor:"#D6D6D6"},tooltip:{backgroundColor:"#1B1A19",textColor:"#FFFFFF"},tag:{background:"#082338",textColor:"#62ABF5"},noSuggestions:{descriptionTextColor:"#D6D6D6",item:{background:{resting:"#1b1a19",hover:"#3D3D3D",pressed:"#292827",disabled:"#797775"},text:{resting:"#296FE6",disabled:"#707070"},actionButtonForeground:{resting:"#598FEC"},highlighting:"#292929"}}}],[r.highContrast,{background:{resting:"#000000",hover:"#1AEBFF",pressed:"#1AEBFF",disabled:"#000000"},footerButtonBackground:{resting:"#000000",hover:"#1AEBFF",pressed:"#1AEBFF",disabled:"#000000"},text:{resting:"#FFFFFF",hover:"#000000",disabled:"#FFFFFF"},highlightingBorderColor:"#FFFFFF",altText:{resting:"#FFFFFF",hover:"#000000"},altIcon:{resting:"#FFFFFF",hover:"#000000",pressed:"#000000",disabled:"#FFFFFF"},actionButtonForeground:{resting:"#FFFF01"},highlighting:"#1AEBFF",branding:{type:"IconAndTextButton",background:{resting:"#000000",hover:"#1AEBFF",pressed:"#1AEBFF",disabled:"#000000"},icon:{resting:"#FFFFFF",hover:"#000000",pressed:"#000000",disabled:"#FFFFFF"},title:{resting:"#FFFFFF",hover:"#000000",disabled:"#FFFFFF"},tooltip:{textColor:"#FFFFFF"},focusRing:"#1AEBFF"},shimmer:{shimmerColor:"#FFFFFF",shimmerWaveColor:"#FFFFFF"},scroll:{thumbColor:"#FFFFFF"},tooltip:{backgroundColor:"#000000",textColor:"#FFFFFF"},callout:{border:"1px solid #FFFFFF"},userAvatarBorderColor:"#FFFFFF",noSuggestions:{descriptionTextColor:"#FFFFFF",item:{background:{resting:"#000000",hover:"#1AEBFF",pressed:"#1AEBFF",disabled:"#000000"},text:{resting:"#FFFFFF",hover:"#000000",disabled:"#FFFFFF"},actionButtonForeground:{resting:"#FFFF01"},highlighting:"#1AEBFF"}}}]]),T="InlineSuggestion",I=new Map([[r.light,{background:{resting:"#FFFFFF",hover:"#f3f2f1"},text:{resting:"#605e5c"}}],[r.dark,{background:{resting:"#333333",hover:"#212121"},text:{resting:"#f4f4f4"}}],[r.highContrast,{background:{resting:"#000000",hover:"#1AEBFF"},text:{resting:"white",hover:"black"}}]]),w="NudgeBubble",E=new Map([[r.light,{background:{resting:"#f5f5f5",hover:"#eee8ff"},text:"#605e5c",entityText:{resting:"#707070",hover:"#8230ff"},tabText:"#707070",highlightColor:"#EBEBEB"}],[r.dark,{background:{resting:"#141414",hover:"#4c0aa8"},text:"#a19f9d",entityText:{resting:"#999999",hover:"#a375ff"},tabText:"#999999"}],[r.highContrast,{background:{resting:"#000000",hover:"#8ee3f0"},text:"#3FF23F",entityText:{resting:"#ffffff",hover:"#263b50"},tabText:"#3FF23F"}]]),x="PredictionContainer",A=new Map([[r.light,{background:"#FFFFFF",shadow:"0 4px 8px rgba(0, 0, 0, 0.14), 0 0 2px rgba(0, 0, 0, 0.12)",text:"#424242",altText:"#616161"}],[r.dark,{background:"#1B1A19",shadow:"0 4px 8px rgba(0, 0, 0, 0.14), 0 0 2px rgba(0, 0, 0, 0.12)",text:"#FFFFFF",altText:"#ADADAD"}]]),D="SquiggleTooltip",k=new Map([[r.light,{primaryButtonBackground:{resting:"#0078D4",hover:"#1651AA",pressed:"#0E336A"},primaryButtonText:{resting:"#FFFFFF",disabled:"#A19F9D"},defaultButtonBackground:{resting:"#FFFFFF",hover:"#F3F2F1",pressed:"#EDEBE9"},defaultButtonText:{resting:"#201F1E",disabled:"#A19F9D"},defaultBorder:"1px solid #8A8886",primaryButtonFocusRing:"#FFFFFF",backgroundColor:"#FFFFFF",link:"#1651AA",titleColor:"#201F1E",descriptionColor:"#605E5C",rejectionTextColor:"#201F1E",iconPrimaryColor:"#0078D4",iconSecondaryColor:"#DEECF9",dismissButtonColor:"#000000",highContrast:{iconPrimaryColor:"#000000",iconSecondaryColor:"#FFFFFF"}}],[r.dark,{primaryButtonBackground:{resting:"#2899F5",hover:"#1651AA",pressed:"#0E336A"},primaryButtonText:{resting:"#1B1A19",disabled:"#A19F9D"},defaultButtonBackground:{resting:"#1B1A19",hover:"#484644",pressed:"#979593"},defaultButtonText:{resting:"#FAF9F8",disabled:"#A19F9D"},defaultBorder:"1px solid #8A8886",backgroundColor:"#1B1A19",link:"#2899F5",titleColor:"#FAF9F8",descriptionColor:"#C8C6C4",rejectionTextColor:"#FAF9F8",primaryButtonFocusRing:"#FFFFFF",defaultButtonFocusRing:"#FFFFFF",iconPrimaryColor:"#0078D4",iconSecondaryColor:"#043862",dismissButtonColor:"#FAF9F8",highContrast:{iconPrimaryColor:"#FFFFFF",iconSecondaryColor:"#000000"}}]]),F="TonalFirstRunCard",P=new Map([[d,l],[f,p],[m,v],[T,S],[s,a],[F,k],[w,I],[C,b],[x,E],[D,A],[_,y]]),N={critiqueCalloutComponentName:d,expandedInlineSuggestionComponentName:f,footerFreComponentName:m,inlineSuggestionComponentName:T,copilotEccIconComponentName:s,indicatorComponentName:_,tonalFreComponentName:F,nudgeBubbleComponentName:w,inlineNudgeBubbleComponentName:C,predictionContainerComponentName:x,squiggleTooltipComponentName:D},B=new Map([[w,{}]]),O={critiqueCalloutComponentName:d,footerFreComponentName:m,nudgeBubbleComponentName:w,advancedEditorSettingsDialogComponentName:"AdvancedEditorSettingsDialog"},R=(0,i.f)("IStyleStore");var L=n(30206),M=n(46546);function q(e){return new Map(JSON.parse(JSON.stringify(Array.from(e))))}function W(e){return e&&"object"==typeof e&&Object.keys(e).length?JSON.parse(JSON.stringify(e)):e}var U=n(48828),z=n(92037);let j=class{constructor(){this._styles=new Map,(0,z.Gn)(this)}get components(){return Array.from(this._styles.keys())}getComponentStyle(e){const t=this._styles.get(e);return t&&W(t)}updateComponentStyle(e,t){this._styles.set(e,t)}};(0,L.__decorate)([M.observable],j.prototype,"_styles",void 0),(0,L.__decorate)([M.computed],j.prototype,"components",null),(0,L.__decorate)([M.action],j.prototype,"getComponentStyle",null),(0,L.__decorate)([M.action],j.prototype,"updateComponentStyle",null),j=(0,L.__decorate)([(0,U._)()],j);var H=n(87751);const V=(0,H.a)({semanticColors:{cardShadow:"0px 1px 2.5px 0px rgba(0, 0, 0, 0.12),0px 2px 4px 0px rgba(0, 0, 0, 0.08)",cardShadowHovered:"0 8px 24px 0 rgba(0,0,0,0.1), 0 8px 16px 0 rgba(0,0,0,0.12)",buttonBackground:"#ffffff",buttonBackgroundHovered:"#f5f5f5",buttonBackgroundPressed:"#e0e0e0",buttonBorder:"#e1dfdd",bodyStandoutBackground:"#c4c4c4",buttonText:"#242424",buttonTextDisabled:"#616161",primaryButtonText:"#ffffff",disabledText:"#bdbdbd",disabledBodyText:"#605e5c",errorText:"#a80000",accentButtonText:"#185abd",accentButtonBackground:"#d2e0f4",bodyDivider:"#c7e0f4",focusBorder:"#242424",variantBorder:"#bdbdbd",infoIcon:"#185abd",successBackground:"#d2e0f4",successIcon:"#185ABD",menuDivider:"#e0e0e0",warningBackground:"#d4edd4",warningIcon:"#094609",errorBackground:"#fde5e5",errorIcon:"#3f1011",buttonTextChecked:"#185ABD",buttonBackgroundChecked:"#d2e0f4",buttonTextCheckedHovered:"#185ABD",buttonBackgroundCheckedHovered:"#d2e0f4",actionLink:"#185ABD",actionLinkHovered:"#185ABD",linkHovered:"#185ABD",bodySubtext:"#616161",bodyBackground:"#f5f5f5",cardStandoutBackground:"#ebf3fc",infoBackground:"#F0F0F0",listItemBackgroundHovered:"#f3f2f1",inputBackground:"F5F5F5",primaryButtonBackground:"#185ABD",primaryButtonBackgroundHovered:"#1651AA",primaryButtonBackgroundPressed:"#0E336A"},palette:{themeDarker:"#185abd",themeDark:"#185abd",themeDarkAlt:"#185abd",themePrimary:"#185abd",themeSecondary:"#185abd",themeTertiary:"#185abd",themeLight:"#d2e0f4",themeLighter:"#d2e0f4",black:"#242424",neutralDark:"#242424",neutralPrimary:"#242424",neutralPrimaryAlt:"#242424",neutralSecondary:"#616161",neutralSecondaryAlt:"#616161",neutralTertiary:"#bdbdbd",neutralTertiaryAlt:"#bdbdbd",neutralQuaternary:"#e0e0e0",neutralQuaternaryAlt:"#e0e0e0",neutralLight:"#e0e0e0",neutralLighter:"#f5f5f5",neutralLighterAlt:"#f5f5f5",white:"#ffffff"}}),G=(0,H.a)({semanticColors:{cardShadow:"none",cardShadowHovered:"none",buttonBackground:"#292929",buttonBackgroundHovered:"#3d3d3d",buttonBackgroundPressed:"#1f1f1f",buttonBorder:"#3d3d3d",bodyStandoutBackground:"default",buttonText:"#ffffff",buttonTextDisabled:"#ADADAD",primaryButtonText:"#ffffff",disabledText:"#ADADAD",disabledBodyText:"#d6d6d6",errorText:"#f1707b",accentButtonText:"#82ABF1",accentButtonBackground:"#0c2145",bodyDivider:"#598fec",focusBorder:"#ffffff",variantBorder:"#5c5c5c",infoIcon:"#82ABF1",successBackground:"#071225",successIcon:"#82ABF1",menuDivider:"#666666",warningBackground:"#094609",warningIcon:"#d4edd4",errorBackground:"#3f1011",errorIcon:"#fde5e5",buttonTextChecked:"#82ABF1",buttonBackgroundChecked:"#0c2145",buttonTextCheckedHovered:"#82ABF1",buttonBackgroundCheckedHovered:"#0c2145",actionLink:"#82ABF1",actionLinkHovered:"#82ABF1",linkHovered:"#82ABF1",bodySubtext:"#adadad",bodyBackground:"#141414",cardStandoutBackground:"#3d3d3d",infoBackground:"#292929",listItemBackgroundHovered:"#1651AA",inputBackground:"#141414",primaryButtonBackground:"#1651AA",primaryButtonBackgroundHovered:"#185ABD",primaryButtonBackgroundPressed:"#0E336A"},palette:{themeDarker:"#82abf1",themeDark:"#82abf1",themeDarkAlt:"#82abf1",themePrimary:"#82abf1",themeSecondary:"#82abf1",themeTertiary:"#82abf1",themeLight:"#0c2145",themeLighter:"#071225",black:"#ffffff",neutralDark:"#ffffff",neutralPrimary:"#ffffff",neutralPrimaryAlt:"#ffffff",neutralSecondary:"#adadad",neutralSecondaryAlt:"#adadad",neutralTertiary:"#858585",neutralTertiaryAlt:"#858585",neutralQuaternary:"#666666",neutralQuaternaryAlt:"#5c5c5c",neutralLight:"#1f1f1f",neutralLighter:"#3d3d3d",neutralLighterAlt:"#292929",white:"#141414"},isInverted:!0});var Q;let K;function $(){return null!=K?K:K=(0,M.observable)({theme:V})}!function(e){e.Light="Light",e.Dark="Dark"}(Q||(Q={}));const Z=(0,M.action)((e=>{$().theme=e===Q.Dark?G:V}));(0,M.action)((e=>{$().theme=e}));var J=n(51474);const X={[h.SV.light]:{editorTagResting:"#201F1E",editorAltTextResting:"#605E5C",editorGrammarTextResting:"#3355FF",editorGrammarTextHover:"#3355FF",editorRefinementTextResting:"#5A4EBC",editorRefinementTextHover:"#5A4EBC",editorRewriteTextResting:"#5A4EBC",editorRewriteTextHover:"#5A4EBC",editorPrimaryButtonBackgroundResting:"#2E6AC5",editorPrimaryButtonBackgroundHover:"#1651AA",editorPrimaryButtonBackgroundPressed:"#0E336A",editorPrimaryButtonBackgroundDisabled:"#F3F2F1",editorPrimaryButtonTextResting:"#FFFFFF",editorPrimaryButtonTextDisabled:"#A19F9D",editorHeader:"#3B3A39",editorSubheader:"#605E5C",editorDialogText:"#323130",editorIconText:"#201F1E",editorContextText:"#201F1E",editorErrorText:"red",editorBorder:"#201F1E",editorSeparator:"#E6E6E6",editorFocusRing:"#969696",editorAddOnFooterBackground:J.L.colorBrandBackground2,editorAddOnFooterMessage:"#11100F",editorAddOnHeaderBackground:"#ebf3fc",editorPremiumEmphasis:J.L.colorBrandForeground1,editorAddOnAction:"#2E6AC5",editorEditorIcon:"#185ABD",editorAccessibilityIcon:"#185ABD",editorCorrectionHighlight:"#D4EDD4",editorHelpLinkTextResting:"#1651AA",editorHelpLinkTextHover:"#13458F",editorHelpLinkTextFocused:"#1651AA",editorHelpLinkTextPressed:"#0E336A",editorHelpLinkFocusRing:"#323130",editorBadgeBackground:J.L.colorBrandForeground1,editorBadgeText:"#FFFFFF",editorTonalFreCardIconPrimaryColor:J.L.colorBrandForeground1,editorTonalFreCardIconSecondaryColor:J.L.colorBrandBackground2},[h.SV.dark]:{editorTagResting:c.gray90,editorAltTextResting:c.gray90,editorGrammarTextResting:"#99AAF5",editorGrammarTextHover:"#99AAF5",editorRefinementTextResting:"#ADA2F2",editorRefinementTextHover:"#ADA2F2",editorRewriteTextResting:"#ADA2F2",editorRewriteTextHover:"#ADA2F2",editorHeader:c.gray60,editorSubheader:c.gray90,editorDialogText:c.gray90,editorIconText:c.gray90,editorContextText:c.gray90,editorErrorText:"red",editorBorder:c.gray200,editorSeparator:c.gray140,editorFocusRing:c.gray60,editorAddOnFooterBackground:"#092C47",editorAddOnFooterMessage:c.gray10,editorAddOnHeaderBackground:"#0c2145",editorPremiumEmphasis:"#598FEC",editorAddOnAction:"#598FEC",editorEditorIcon:"#598FEC",editorAccessibilityIcon:"#095E09",editorCorrectionHighlight:"#095E09",editorHelpLinkTextResting:"#3D7CE8",editorHelpLinkTextHover:"#598FEC",editorHelpLinkTextFocused:"#598FEC",editorHelpLinkTextPressed:c.gray120,editorHelpLinkFocusRing:c.gray60,editorBadgeBackground:"#296FE6",editorBadgeText:"#FFFFFF"},[h.SV.highContrast]:{editorTagResting:c.gray90,editorAltTextResting:c.gray90,editorGrammarTextResting:J.L.colorNeutralForeground1,editorGrammarTextHover:J.L.colorNeutralForeground1Hover,editorRefinementTextResting:J.L.colorNeutralForeground1,editorRefinementTextHover:J.L.colorNeutralForeground1Hover,editorRewriteTextResting:J.L.colorNeutralForeground1,editorRewriteTextHover:J.L.colorNeutralForeground1Hover,editorHeader:c.gray60,editorSubheader:c.gray90,editorDialogText:c.gray90,editorIconText:c.gray90,editorContextText:c.gray90,editorErrorText:"red",editorBorder:c.gray200,editorSeparator:c.gray140,editorFocusRing:c.gray60,editorAddOnFooterBackground:J.L.colorBrandBackground2,editorAddOnFooterMessage:c.gray10,editorAddOnHeaderBackground:"#0c2145",editorPremiumEmphasis:J.L.colorBrandForeground1,editorAddOnAction:"#598FEC",editorEditorIcon:"#598FEC",editorAccessibilityIcon:"#095E09",editorCorrectionHighlight:"#095E09",editorHelpLinkTextResting:"#3D7CE8",editorHelpLinkTextHover:"#598FEC",editorHelpLinkTextFocused:"#598FEC",editorHelpLinkTextPressed:c.gray120,editorHelpLinkFocusRing:c.gray60,editorBadgeBackground:"#296FE6",editorBadgeText:"#FFFFFF",editorTonalFreCardIconPrimaryColor:J.L.colorBrandForeground1,editorTonalFreCardIconSecondaryColor:J.L.colorBrandBackground2}},Y={[h.SV.light]:{editorActionButtonForegroundResting:J.L.colorBrandForeground2,editorActionButtonForegroundHover:J.L.colorBrandForeground2Hover,editorActionButtonForegroundPressed:J.L.colorBrandForeground2Pressed,editorActionButtonForegroundDisabled:J.L.colorNeutralForegroundDisabled,editorShimmerColor:"#F3F2F1",editorShimmerWaveColor:"#EDEBE9",editorScrollThumbColor:"#bdbdbd",editorSearchBoxBorderColorResting:"#D1D1D1",editorSearchBoxBorderColorHover:"#D1D1D1",editorSearchBoxBorderBottomColor:"#464FEB",editorSearchBoxIconColor:"#424242",editorTagBackground:"#EBF3FC",editorTagTextColor:"#0F6CBD",editorMeetingBannerBackgroundColor:"#FAF9F8",editorMeetingBannerText:"#424242",editorMeetingBannerIconPrimaryColor:"#616161",editorMeetingBannerBorderColor:"#d1d1d1"},[h.SV.dark]:{editorActionButtonForegroundResting:J.L.colorBrandForeground2,editorActionButtonForegroundHover:J.L.colorBrandForeground2Hover,editorActionButtonForegroundPressed:J.L.colorBrandForeground2Pressed,editorActionButtonForegroundDisabled:J.L.colorNeutralForegroundDisabled,editorShimmerColor:"#3D3D3D",editorShimmerWaveColor:"#474747",editorScrollThumbColor:"#707070",editorTagBackground:"#082338",editorTagTextColor:"#62ABF5",editorMeetingBannerBackgroundColor:"#141414",editorMeetingBannerText:"#ffffff",editorMeetingBannerIconPrimaryColor:"#adadad",editorMeetingBannerBorderColor:"#666666"},[h.SV.highContrast]:{editorNoSuggestionsTextColorResting:J.L.colorNeutralForeground2,editorNoSuggestionsTextColorHover:J.L.colorNeutralForeground2BrandHover,editorActionButtonForegroundResting:J.L.colorBrandForeground2,editorActionButtonForegroundHover:J.L.colorNeutralForeground2BrandHover,editorActionButtonForegroundPressed:J.L.colorNeutralForeground2BrandPressed,editorActionButtonForegroundDisabled:J.L.colorNeutralForegroundDisabled,editorShimmerColor:"#3D3D3D",editorShimmerWaveColor:"#474747",editorScrollThumbColor:"#707070",editorTagBackground:"#082338",editorTagTextColor:"#62ABF5",editorMeetingBannerBackgroundColor:"#141414",editorMeetingBannerText:"#ffffff",editorMeetingBannerIconPrimaryColor:"#adadad",editorMeetingBannerBorderColor:"#666666"}},ee={[h.SV.light]:{editorTextBrandingTextColor:J.L.colorNeutralForeground2,editorIconBrandingIconColor:J.L.colorNeutralForeground2,editorIconButtonBrandingBackgroundResting:J.L.colorNeutralBackground1,editorIconButtonBrandingBackgroundHover:J.L.colorNeutralBackground1Hover,editorIconButtonBrandingBackgroundPressed:J.L.colorNeutralBackground1Pressed,editorIconButtonBrandingBackgroundDisabled:J.L.colorTransparentBackground,editorIconButtonBrandingIconResting:J.L.colorNeutralForeground2,editorIconButtonBrandingIconDisabled:J.L.colorNeutralForegroundDisabled,editorIconButtonBrandingFocusRing:J.L.colorStrokeFocus2,editorIconAndTextButtonBrandingBackgroundResting:J.L.colorNeutralBackground1,editorIconAndTextButtonBrandingBackgroundHover:J.L.colorNeutralBackground1Hover,editorIconAndTextButtonBrandingBackgroundPressed:J.L.colorNeutralBackground1Pressed,editorIconAndTextButtonBrandingBackgroundDisabled:J.L.colorTransparentBackground,editorIconAndTextButtonBrandingIconResting:J.L.colorBrandForeground1,editorIconAndTextButtonBrandingIconDisabled:J.L.colorNeutralForegroundDisabled,editorIconAndTextButtonBrandingTitleResting:J.L.colorBrandForeground1,editorIconAndTextButtonBrandingTitleDisabled:J.L.colorNeutralForegroundDisabled,editorIconAndTextButtonBrandingFocusRing:J.L.colorStrokeFocus2},[h.SV.dark]:{editorTextBrandingTextColor:J.L.colorNeutralForeground2,editorIconBrandingIconColor:J.L.colorNeutralForeground2,editorIconButtonBrandingBackgroundResting:J.L.colorNeutralBackground1,editorIconButtonBrandingBackgroundHover:J.L.colorNeutralBackground1Hover,editorIconButtonBrandingBackgroundPressed:J.L.colorNeutralBackground1Pressed,editorIconButtonBrandingBackgroundDisabled:J.L.colorTransparentBackground,editorIconButtonBrandingIconResting:J.L.colorNeutralForeground2,editorIconButtonBrandingIconDisabled:J.L.colorNeutralForegroundDisabled,editorIconButtonBrandingFocusRing:J.L.colorStrokeFocus2,editorIconAndTextButtonBrandingBackgroundResting:J.L.colorNeutralBackground1,editorIconAndTextButtonBrandingBackgroundHover:J.L.colorNeutralBackground1Hover,editorIconAndTextButtonBrandingBackgroundPressed:J.L.colorNeutralBackground1Pressed,editorIconAndTextButtonBrandingBackgroundDisabled:J.L.colorTransparentBackground,editorIconAndTextButtonBrandingIconResting:J.L.colorBrandForeground1,editorIconAndTextButtonBrandingIconDisabled:J.L.colorNeutralForegroundDisabled,editorIconAndTextButtonBrandingTitleResting:J.L.colorBrandForeground1,editorIconAndTextButtonBrandingTitleDisabled:J.L.colorNeutralForegroundDisabled,editorIconAndTextButtonBrandingFocusRing:J.L.colorStrokeFocus2},[h.SV.highContrast]:{editorTextBrandingTextColor:J.L.colorNeutralForeground2,editorIconBrandingIconColor:J.L.colorNeutralForeground2,editorIconButtonBrandingBackgroundResting:J.L.colorNeutralBackground1,editorIconButtonBrandingBackgroundHover:J.L.colorNeutralBackground1Hover,editorIconButtonBrandingBackgroundPressed:J.L.colorNeutralBackground1Pressed,editorIconButtonBrandingBackgroundDisabled:J.L.colorTransparentBackground,editorIconButtonBrandingIconResting:J.L.colorNeutralForeground2,editorIconButtonBrandingIconDisabled:J.L.colorNeutralForegroundDisabled,editorIconButtonBrandingFocusRing:J.L.colorStrokeFocus2,editorIconAndTextButtonBrandingBackgroundResting:J.L.colorNeutralBackground1,editorIconAndTextButtonBrandingBackgroundHover:J.L.colorNeutralBackground1Hover,editorIconAndTextButtonBrandingBackgroundPressed:J.L.colorNeutralBackground1Pressed,editorIconAndTextButtonBrandingBackgroundDisabled:J.L.colorTransparentBackground,editorIconAndTextButtonBrandingIconResting:J.L.colorBrandForeground1,editorIconAndTextButtonBrandingIconDisabled:J.L.colorNeutralForegroundDisabled,editorIconAndTextButtonBrandingTitleResting:J.L.colorBrandForeground1,editorIconAndTextButtonBrandingTitleDisabled:J.L.colorNeutralForegroundDisabled,editorIconAndTextButtonBrandingFocusRing:J.L.colorStrokeFocus2}};var te=n(19718),ne=n(88670),re=n(90424),ie=n(60970),oe=n(68916),ae=n(75435),se=n(51815),le=n(36934);const de=se.TQ.reduce(((e,t)=>{const n=t.slice(0,1).toUpperCase()+t.slice(1),r={[`colorPalette${n}Background1`]:ae.mY,[`colorPalette${n}Background2`]:ae.mY,[`colorPalette${n}Background3`]:ae.Fn,[`colorPalette${n}Foreground1`]:ae.Fn,[`colorPalette${n}Foreground2`]:ae.Fn,[`colorPalette${n}Foreground3`]:ae.Fn,[`colorPalette${n}BorderActive`]:ae.Si,[`colorPalette${n}Border1`]:ae.Fn,[`colorPalette${n}Border2`]:ae.Fn};return Object.assign(e,r)}),{});de.colorPaletteRedForegroundInverted=ae.Fn,de.colorPaletteGreenForegroundInverted=ae.Fn,de.colorPaletteYellowForegroundInverted=ae.Fn;const ue=se.dt.reduce(((e,t)=>{const n=t.slice(0,1).toUpperCase()+t.slice(1),r={[`colorPalette${n}Background2`]:ae.mY,[`colorPalette${n}Foreground2`]:ae.Fn,[`colorPalette${n}BorderActive`]:ae.Si};return Object.assign(e,r)}),{}),ce={...de,...ue},ge=Object.entries(le.s).reduce(((e,[t,n])=>{const r=t.slice(0,1).toUpperCase()+t.slice(1),i={[`colorStatus${r}Background1`]:ae.mY,[`colorStatus${r}Background2`]:ae.mY,[`colorStatus${r}Background3`]:ae.Fn,[`colorStatus${r}Foreground1`]:ae.Fn,[`colorStatus${r}Foreground2`]:ae.Fn,[`colorStatus${r}Foreground3`]:ae.Fn,[`colorStatus${r}BorderActive`]:ae.Si,[`colorStatus${r}ForegroundInverted`]:ae.Fn,[`colorStatus${r}Border1`]:ae.Fn,[`colorStatus${r}Border2`]:ae.Fn};return Object.assign(e,i)}),{});ge.colorStatusDangerBackground3Hover=ae.Si,ge.colorStatusDangerBackground3Pressed=ae.Si;var he=n(61883),pe=n(54661),fe=n(68106),ve=n(6388),me=n(3442),ye=n(30975),_e=n(83601);const be={...pe.aI,fontFamilyBase:'-apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, "Apple Color Emoji", "Segoe UI Emoji", sans-serif'},Ce={...(()=>{const e={colorNeutralForeground1:ae.Fn,colorNeutralForeground1Hover:ae.fo,colorNeutralForeground1Pressed:ae.fo,colorNeutralForeground1Selected:ae.fo,colorNeutralForeground2:ae.Fn,colorNeutralForeground2Hover:ae.fo,colorNeutralForeground2Pressed:ae.fo,colorNeutralForeground2Selected:ae.fo,colorNeutralForeground2BrandHover:ae.fo,colorNeutralForeground2BrandPressed:ae.fo,colorNeutralForeground2BrandSelected:ae.fo,colorNeutralForeground3:ae.Fn,colorNeutralForeground3Hover:ae.fo,colorNeutralForeground3Pressed:ae.fo,colorNeutralForeground3Selected:ae.fo,colorNeutralForeground3BrandHover:ae.fo,colorNeutralForeground3BrandPressed:ae.fo,colorNeutralForeground3BrandSelected:ae.fo,colorNeutralForeground4:ae.Fn,colorNeutralForegroundDisabled:ae.m4,colorNeutralForegroundInvertedDisabled:ae.m4,colorBrandForegroundLink:ae.aJ,colorBrandForegroundLinkHover:ae.aJ,colorBrandForegroundLinkPressed:ae.aJ,colorBrandForegroundLinkSelected:ae.aJ,colorNeutralForeground2Link:ae.aJ,colorNeutralForeground2LinkHover:ae.aJ,colorNeutralForeground2LinkPressed:ae.aJ,colorNeutralForeground2LinkSelected:ae.aJ,colorCompoundBrandForeground1:ae.Si,colorCompoundBrandForeground1Hover:ae.Si,colorCompoundBrandForeground1Pressed:ae.Si,colorBrandForeground1:ae.Fn,colorBrandForeground2:ae.Fn,colorBrandForeground2Hover:ae.Fn,colorBrandForeground2Pressed:ae.Fn,colorNeutralForeground1Static:ae.mY,colorNeutralForegroundStaticInverted:ae.Fn,colorNeutralForegroundInverted:ae.fo,colorNeutralForegroundInvertedHover:ae.fo,colorNeutralForegroundInvertedPressed:ae.fo,colorNeutralForegroundInvertedSelected:ae.fo,colorNeutralForegroundInverted2:ae.Fn,colorNeutralForegroundOnBrand:ae.p1,colorNeutralForegroundInvertedLink:ae.aJ,colorNeutralForegroundInvertedLinkHover:ae.aJ,colorNeutralForegroundInvertedLinkPressed:ae.aJ,colorNeutralForegroundInvertedLinkSelected:ae.aJ,colorBrandForegroundInverted:ae.Fn,colorBrandForegroundInvertedHover:ae.fo,colorBrandForegroundInvertedPressed:ae.fo,colorBrandForegroundOnLight:ae.p1,colorBrandForegroundOnLightHover:ae.fo,colorBrandForegroundOnLightPressed:ae.fo,colorBrandForegroundOnLightSelected:ae.fo,colorNeutralBackground1:ae.mY,colorNeutralBackground1Hover:ae.Si,colorNeutralBackground1Pressed:ae.Si,colorNeutralBackground1Selected:ae.Si,colorNeutralBackground2:ae.mY,colorNeutralBackground2Hover:ae.Si,colorNeutralBackground2Pressed:ae.Si,colorNeutralBackground2Selected:ae.Si,colorNeutralBackground3:ae.mY,colorNeutralBackground3Hover:ae.Si,colorNeutralBackground3Pressed:ae.Si,colorNeutralBackground3Selected:ae.Si,colorNeutralBackground4:ae.mY,colorNeutralBackground4Hover:ae.Si,colorNeutralBackground4Pressed:ae.Si,colorNeutralBackground4Selected:ae.Si,colorNeutralBackground5:ae.mY,colorNeutralBackground5Hover:ae.Si,colorNeutralBackground5Pressed:ae.Si,colorNeutralBackground5Selected:ae.Si,colorNeutralBackground6:ae.mY,colorNeutralBackgroundInverted:ae.mY,colorNeutralBackgroundStatic:ae.mY,colorNeutralBackgroundAlpha:ae.mY,colorNeutralBackgroundAlpha2:ae.mY,colorSubtleBackground:"transparent",colorSubtleBackgroundHover:ae.Si,colorSubtleBackgroundPressed:ae.Si,colorSubtleBackgroundSelected:ae.Si,colorSubtleBackgroundLightAlphaHover:ae.Si,colorSubtleBackgroundLightAlphaPressed:ae.Si,colorSubtleBackgroundLightAlphaSelected:ae.Si,colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:ae.Si,colorSubtleBackgroundInvertedPressed:ae.Si,colorSubtleBackgroundInvertedSelected:ae.Si,colorTransparentBackground:"transparent",colorTransparentBackgroundHover:ae.Si,colorTransparentBackgroundPressed:ae.Si,colorTransparentBackgroundSelected:ae.Si,colorNeutralBackgroundDisabled:ae.mY,colorNeutralBackgroundInvertedDisabled:ae.mY,colorNeutralStencil1:ae.Fn,colorNeutralStencil2:ae.Fn,colorNeutralStencil1Alpha:ae.Fn,colorNeutralStencil2Alpha:ae.Fn,colorBackgroundOverlay:ae.Q1[50],colorScrollbarOverlay:ae.p6,colorBrandBackground:ae.p6,colorBrandBackgroundHover:ae.Si,colorBrandBackgroundPressed:ae.Si,colorBrandBackgroundSelected:ae.Si,colorCompoundBrandBackground:ae.Si,colorCompoundBrandBackgroundHover:ae.Si,colorCompoundBrandBackgroundPressed:ae.Si,colorBrandBackgroundStatic:ae.mY,colorBrandBackground2:ae.mY,colorBrandBackground2Hover:ae.mY,colorBrandBackground2Pressed:ae.mY,colorBrandBackground3Static:ae.mY,colorBrandBackground4Static:ae.mY,colorBrandBackgroundInverted:ae.p6,colorBrandBackgroundInvertedHover:ae.Si,colorBrandBackgroundInvertedPressed:ae.Si,colorBrandBackgroundInvertedSelected:ae.Si,colorNeutralCardBackground:ae.mY,colorNeutralCardBackgroundHover:ae.Si,colorNeutralCardBackgroundPressed:ae.Si,colorNeutralCardBackgroundSelected:ae.Si,colorNeutralCardBackgroundDisabled:ae.mY,colorNeutralStrokeAccessible:ae.Fn,colorNeutralStrokeAccessibleHover:ae.Si,colorNeutralStrokeAccessiblePressed:ae.Si,colorNeutralStrokeAccessibleSelected:ae.Si,colorNeutralStroke1:ae.Fn,colorNeutralStroke1Hover:ae.Si,colorNeutralStroke1Pressed:ae.Si,colorNeutralStroke1Selected:ae.Si,colorNeutralStroke2:ae.Fn,colorNeutralStroke3:ae.Fn,colorNeutralStrokeSubtle:ae.Fn,colorNeutralStrokeOnBrand:ae.mY,colorNeutralStrokeOnBrand2:ae.Fn,colorNeutralStrokeOnBrand2Hover:ae.Fn,colorNeutralStrokeOnBrand2Pressed:ae.Fn,colorNeutralStrokeOnBrand2Selected:ae.Fn,colorBrandStroke1:ae.Fn,colorBrandStroke2:ae.Fn,colorBrandStroke2Hover:ae.Si,colorBrandStroke2Pressed:ae.Si,colorBrandStroke2Contrast:ae.mY,colorCompoundBrandStroke:ae.Si,colorCompoundBrandStrokeHover:ae.Si,colorCompoundBrandStrokePressed:ae.Si,colorNeutralStrokeDisabled:ae.m4,colorNeutralStrokeInvertedDisabled:ae.m4,colorTransparentStroke:ae.Fn,colorTransparentStrokeInteractive:ae.Si,colorTransparentStrokeDisabled:ae.m4,colorNeutralStrokeAlpha:ae.Fn,colorNeutralStrokeAlpha2:ae.mY,colorStrokeFocus1:ae.mY,colorStrokeFocus2:ae.Si,colorNeutralShadowAmbient:"rgba(0,0,0,0.24)",colorNeutralShadowKey:"rgba(0,0,0,0.28)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.12)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.40)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.48)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"};return{...he.V,...pe.GR,...pe.lm,...pe.aI,...pe.NM,...fe.k,..._e.b,..._e.F,...me.S,...ye.L,...e,...ce,...ge,...(0,ve.t)(e.colorNeutralShadowAmbient,e.colorNeutralShadowKey),...(0,ve.t)(e.colorBrandShadowAmbient,e.colorBrandShadowKey,"Brand")}})(),...be};var Se=n(62056),Te=n(71122);const Ie={...(0,Se.a)(Te.U1),...be};var we=n(93656);const Ee={...(e=>{const t=(e=>({colorNeutralForeground1:ae.ON,colorNeutralForeground1Hover:ae.ON,colorNeutralForeground1Pressed:ae.ON,colorNeutralForeground1Selected:ae.ON,colorNeutralForeground2:ae.Oh[84],colorNeutralForeground2Hover:ae.ON,colorNeutralForeground2Pressed:ae.ON,colorNeutralForeground2Selected:ae.ON,colorNeutralForeground2BrandHover:e[100],colorNeutralForeground2BrandPressed:e[90],colorNeutralForeground2BrandSelected:e[100],colorNeutralForeground3:ae.Oh[68],colorNeutralForeground3Hover:ae.Oh[84],colorNeutralForeground3Pressed:ae.Oh[84],colorNeutralForeground3Selected:ae.Oh[84],colorNeutralForeground3BrandHover:e[100],colorNeutralForeground3BrandPressed:e[90],colorNeutralForeground3BrandSelected:e[100],colorNeutralForeground4:ae.Oh[60],colorNeutralForegroundDisabled:ae.Oh[36],colorNeutralForegroundInvertedDisabled:ae.c8[40],colorBrandForegroundLink:e[100],colorBrandForegroundLinkHover:e[110],colorBrandForegroundLinkPressed:e[90],colorBrandForegroundLinkSelected:e[100],colorNeutralForeground2Link:ae.Oh[84],colorNeutralForeground2LinkHover:ae.ON,colorNeutralForeground2LinkPressed:ae.ON,colorNeutralForeground2LinkSelected:ae.ON,colorCompoundBrandForeground1:e[100],colorCompoundBrandForeground1Hover:e[110],colorCompoundBrandForeground1Pressed:e[90],colorBrandForeground1:e[100],colorBrandForeground2:e[120],colorBrandForeground2Hover:e[130],colorBrandForeground2Pressed:e[160],colorNeutralForeground1Static:ae.Oh[14],colorNeutralForegroundStaticInverted:ae.ON,colorNeutralForegroundInverted:ae.Oh[14],colorNeutralForegroundInvertedHover:ae.Oh[14],colorNeutralForegroundInvertedPressed:ae.Oh[14],colorNeutralForegroundInvertedSelected:ae.Oh[14],colorNeutralForegroundInverted2:ae.Oh[14],colorNeutralForegroundOnBrand:ae.ON,colorNeutralForegroundInvertedLink:ae.ON,colorNeutralForegroundInvertedLinkHover:ae.ON,colorNeutralForegroundInvertedLinkPressed:ae.ON,colorNeutralForegroundInvertedLinkSelected:ae.ON,colorBrandForegroundInverted:e[80],colorBrandForegroundInvertedHover:e[70],colorBrandForegroundInvertedPressed:e[60],colorBrandForegroundOnLight:e[80],colorBrandForegroundOnLightHover:e[70],colorBrandForegroundOnLightPressed:e[50],colorBrandForegroundOnLightSelected:e[60],colorNeutralBackground1:ae.Oh[16],colorNeutralBackground1Hover:ae.Oh[24],colorNeutralBackground1Pressed:ae.Oh[12],colorNeutralBackground1Selected:ae.Oh[22],colorNeutralBackground2:ae.Oh[14],colorNeutralBackground2Hover:ae.Oh[22],colorNeutralBackground2Pressed:ae.Oh[10],colorNeutralBackground2Selected:ae.Oh[20],colorNeutralBackground3:ae.Oh[12],colorNeutralBackground3Hover:ae.Oh[20],colorNeutralBackground3Pressed:ae.Oh[8],colorNeutralBackground3Selected:ae.Oh[18],colorNeutralBackground4:ae.Oh[8],colorNeutralBackground4Hover:ae.Oh[16],colorNeutralBackground4Pressed:ae.Oh[4],colorNeutralBackground4Selected:ae.Oh[14],colorNeutralBackground5:ae.Oh[4],colorNeutralBackground5Hover:ae.Oh[12],colorNeutralBackground5Pressed:ae.Ql,colorNeutralBackground5Selected:ae.Oh[10],colorNeutralBackground6:ae.Oh[20],colorNeutralBackgroundInverted:ae.ON,colorNeutralBackgroundStatic:ae.Oh[24],colorNeutralBackgroundAlpha:ae.ti[50],colorNeutralBackgroundAlpha2:ae.Z1[70],colorSubtleBackground:"transparent",colorSubtleBackgroundHover:ae.Oh[22],colorSubtleBackgroundPressed:ae.Oh[18],colorSubtleBackgroundSelected:ae.Oh[20],colorSubtleBackgroundLightAlphaHover:ae.Xv[80],colorSubtleBackgroundLightAlphaPressed:ae.Xv[50],colorSubtleBackgroundLightAlphaSelected:"transparent",colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:ae.Q1[10],colorSubtleBackgroundInvertedPressed:ae.Q1[30],colorSubtleBackgroundInvertedSelected:ae.Q1[20],colorTransparentBackground:"transparent",colorTransparentBackgroundHover:"transparent",colorTransparentBackgroundPressed:"transparent",colorTransparentBackgroundSelected:"transparent",colorNeutralBackgroundDisabled:ae.Oh[8],colorNeutralBackgroundInvertedDisabled:ae.c8[10],colorNeutralStencil1:ae.Oh[34],colorNeutralStencil2:ae.Oh[20],colorNeutralStencil1Alpha:ae.c8[10],colorNeutralStencil2Alpha:ae.c8[5],colorBackgroundOverlay:ae.Q1[50],colorScrollbarOverlay:ae.c8[60],colorBrandBackground:e[70],colorBrandBackgroundHover:e[80],colorBrandBackgroundPressed:e[40],colorBrandBackgroundSelected:e[60],colorCompoundBrandBackground:e[100],colorCompoundBrandBackgroundHover:e[110],colorCompoundBrandBackgroundPressed:e[90],colorBrandBackgroundStatic:e[80],colorBrandBackground2:e[20],colorBrandBackground2Hover:e[40],colorBrandBackground2Pressed:e[10],colorBrandBackground3Static:e[60],colorBrandBackground4Static:e[40],colorBrandBackgroundInverted:ae.ON,colorBrandBackgroundInvertedHover:e[160],colorBrandBackgroundInvertedPressed:e[140],colorBrandBackgroundInvertedSelected:e[150],colorNeutralCardBackground:ae.Oh[20],colorNeutralCardBackgroundHover:ae.Oh[24],colorNeutralCardBackgroundPressed:ae.Oh[18],colorNeutralCardBackgroundSelected:ae.Oh[22],colorNeutralCardBackgroundDisabled:ae.Oh[8],colorNeutralStrokeAccessible:ae.Oh[68],colorNeutralStrokeAccessibleHover:ae.Oh[74],colorNeutralStrokeAccessiblePressed:ae.Oh[70],colorNeutralStrokeAccessibleSelected:e[100],colorNeutralStroke1:ae.Oh[40],colorNeutralStroke1Hover:ae.Oh[46],colorNeutralStroke1Pressed:ae.Oh[42],colorNeutralStroke1Selected:ae.Oh[44],colorNeutralStroke2:ae.Oh[32],colorNeutralStroke3:ae.Oh[24],colorNeutralStrokeSubtle:ae.Oh[4],colorNeutralStrokeOnBrand:ae.Oh[16],colorNeutralStrokeOnBrand2:ae.ON,colorNeutralStrokeOnBrand2Hover:ae.ON,colorNeutralStrokeOnBrand2Pressed:ae.ON,colorNeutralStrokeOnBrand2Selected:ae.ON,colorBrandStroke1:e[100],colorBrandStroke2:e[50],colorBrandStroke2Hover:e[50],colorBrandStroke2Pressed:e[30],colorBrandStroke2Contrast:e[50],colorCompoundBrandStroke:e[90],colorCompoundBrandStrokeHover:e[100],colorCompoundBrandStrokePressed:e[80],colorNeutralStrokeDisabled:ae.Oh[26],colorNeutralStrokeInvertedDisabled:ae.c8[40],colorTransparentStroke:"transparent",colorTransparentStrokeInteractive:"transparent",colorTransparentStrokeDisabled:"transparent",colorNeutralStrokeAlpha:ae.c8[10],colorNeutralStrokeAlpha2:ae.c8[20],colorStrokeFocus1:ae.Ql,colorStrokeFocus2:ae.ON,colorNeutralShadowAmbient:"rgba(0,0,0,0.24)",colorNeutralShadowKey:"rgba(0,0,0,0.28)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.12)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.40)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.48)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"}))(e);return{...he.V,...pe.GR,...pe.lm,...pe.aI,...pe.NM,...fe.k,..._e.b,..._e.F,...me.S,...ye.L,...t,...we.h,...we.m,...(0,ve.t)(t.colorNeutralShadowAmbient,t.colorNeutralShadowKey),...(0,ve.t)(t.colorBrandShadowAmbient,t.colorBrandShadowKey,"Brand")}})(Te.U1),...be};let xe=class extends te.z{constructor(e){super(),this.hostSettings=e,this._defaultTheme=r.light,this._currentTheme=r.light,this._themes=new Map,this._fluentThemes=new Map,this._isDarkMode=void 0,this._useFluentV9=void 0,(0,z.Gn)(this),this._isDarkMode=this.hostSettings.isDarkMode,this._currentTheme=this.hostSettings.isDarkMode?r.dark:r.light,this._currentTheme===r.dark?Z(Q.Dark):Z(Q.Light),this._useFluentV9=this.hostSettings.useFluentV9}get isDarkMode(){return this._isDarkMode}get defaultTheme(){return this._defaultTheme}get currentTheme(){return this._currentTheme}get components(){return Array.from(this._themes.keys())}getFluentActiveTheme(){let e={};if(!this._fluentThemes.get(this._currentTheme))switch(this._currentTheme){case r.light:e=ie.o;break;case r.dark:e=oe.C;break;case r.highContrast:e=Ce}const t=this._currentTheme===r.light?0:this._currentTheme===r.dark?1:this._currentTheme===r.highContrast?2:0,n=Object.assign(Object.assign(Object.assign({},X[t]),Y[t]),ee[t]);return Object.assign(Object.assign({},e),n)}getComponentActiveTheme(e,t=!1){var n;if(this._useFluentV9&&!t)return;const r=this._themes.get(e),i=W(null==r?void 0:r.get(this._currentTheme)),o=W(null==r?void 0:r.get(this._defaultTheme));return null!==(n=null!=i?i:o)&&void 0!==n?n:void 0}getComponentThemes(e){const t=this._themes.get(e);return t&&q(t)}updateDarkMode(e){this._isDarkMode=e,this.hostSettings.isDarkMode=e,this._currentTheme=e?r.dark:r.light,Z(e?Q.Dark:Q.Light),this.publishEvent("currentThemeUpdated",this._currentTheme)}updateDefaultTheme(e){this._defaultTheme=e,this.publishEvent("defaultThemeUpdated",this._defaultTheme)}updateCurrentTheme(e){this._currentTheme=e,e===r.dark?Z(Q.Dark):Z(Q.Light),this.publishEvent("currentThemeUpdated",this._currentTheme)}updateComponentThemes(e,t){this._themes.set(e,q(t)),this.publishEvent("themesUpdated",{})}updateFluentThemes(e){this._fluentThemes.clear();for(const[t,n]of e)this._fluentThemes.set(t,n);this.publishEvent("fluentThemesUpdated",{})}getExpandedEccFluentTheme(){switch(this._currentTheme){case r.light:default:return Ie;case r.dark:return Ee}}};(0,L.__decorate)([M.observable],xe.prototype,"_defaultTheme",void 0),(0,L.__decorate)([M.observable],xe.prototype,"_currentTheme",void 0),(0,L.__decorate)([M.observable],xe.prototype,"_themes",void 0),(0,L.__decorate)([M.observable],xe.prototype,"_fluentThemes",void 0),(0,L.__decorate)([M.observable],xe.prototype,"_isDarkMode",void 0),(0,L.__decorate)([M.observable],xe.prototype,"_useFluentV9",void 0),(0,L.__decorate)([M.computed],xe.prototype,"isDarkMode",null),(0,L.__decorate)([M.computed],xe.prototype,"defaultTheme",null),(0,L.__decorate)([M.computed],xe.prototype,"currentTheme",null),(0,L.__decorate)([M.computed],xe.prototype,"components",null),(0,L.__decorate)([M.action],xe.prototype,"updateDarkMode",null),(0,L.__decorate)([M.action],xe.prototype,"updateDefaultTheme",null),(0,L.__decorate)([M.action],xe.prototype,"updateCurrentTheme",null),(0,L.__decorate)([M.action],xe.prototype,"updateComponentThemes",null),(0,L.__decorate)([M.action],xe.prototype,"updateFluentThemes",null),xe=(0,L.__decorate)([(0,U._)(),(0,L.__param)(0,(0,re.W)(ne.n))],xe);var Ae=n(7470)},17875:(e,t,n)=>{"use strict";n.d(t,{s:()=>i});var r=n(30915);function i(e,t,n){void 0===n&&(n=!0);var i=!1;if(e&&t)if(n)if(e===t)i=!0;else for(i=!1;t;){var o=(0,r.P)(t);if(o===e){i=!0;break}t=o}else e.contains&&(i=e.contains(t));return i}},97951:(e,t,n)=>{"use strict";n.d(t,{w:()=>i});var r=n(30915);function i(e,t,n){return null!=n||(n=document),!e||e===n.body||e instanceof Document?null:t(e)?e:i((0,r.P)(e),t)}},30915:(e,t,n)=>{"use strict";function r(e,t){var n,r;if(void 0===t&&(t=!0),!e)return null;var i=t&&function(e){var t,n;return e&&(n=e)&&n._virtual&&(t=e._virtual.parent),t}(e);return i||("function"!=typeof e.assignedElements&&(null===(n=e.assignedSlot)||void 0===n?void 0:n.parentNode)?e.assignedSlot:11===(null===(r=e.parentNode)||void 0===r?void 0:r.nodeType)?e.parentNode.host:e.parentNode)}n.d(t,{P:()=>r})},79970:(e,t,n)=>{"use strict";n.d(t,{V:()=>i,r:()=>r});var r="data-portal-element";function i(e){e.setAttribute(r,"true")}},80072:(e,t,n)=>{"use strict";n.d(t,{T:()=>o});var r=n(30206),i=n(31860);function o(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(e&&1===e.length&&e[0]&&!e[0].subComponentStyles&&!(0,i.db)(e[0]))return e[0];for(var n={},a={},s=0,l=e;s<l.length;s++){var d=l[s];if(d&&!(0,i.db)(d))for(var u in d)if(d.hasOwnProperty(u)){if("subComponentStyles"===u&&void 0!==d.subComponentStyles){var c=d.subComponentStyles;for(var g in c)c.hasOwnProperty(g)&&(a.hasOwnProperty(g)?a[g].push(c[g]):a[g]=[c[g]]);continue}var h=n[u],p=d[u];n[u]=void 0===h?p:(0,r.__spreadArray)((0,r.__spreadArray)([],Array.isArray(h)?h:[h],!0),Array.isArray(p)?p:[p],!0)}}if(Object.keys(a).length>0){n.subComponentStyles={};var f=n.subComponentStyles,v=function(e){if(a.hasOwnProperty(e)){var t=a[e];f[e]=function(e){return o.apply(void 0,t.map((function(t){return"function"==typeof t?t(e):t})))}}};for(var g in a)v(g)}return n}},17596:(e,t,n)=>{"use strict";n.d(t,{p:()=>i});var r=n(80072);function i(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var i=[],o=0,a=t;o<a.length;o++){var s=a[o];s&&i.push("function"==typeof s?s(e):s)}return 1===i.length?i[0]:i.length?r.T.apply(void 0,i):{}}},76437:(e,t,n)=>{"use strict";n.d(t,{i:()=>a});var r=n(38106),i=n(83702),o=n(30006);function a(e){var t=i.nr.getInstance(),n=[];for(var a in e)e.hasOwnProperty(a)&&n.push(a,"{",(0,o.bz)((0,r.Iy)(),e[a]),"}");var s=n.join(""),l=t.classNameFromKey(s);if(l)return l;var d=t.getClassName();return t.insertRule("@keyframes ".concat(d,"{").concat(s,"}"),!0),t.cacheClassName(d,s,[],["keyframes",s]),d}},68678:(e,t,n)=>{"use strict";n.d(t,{L:()=>c,l:()=>u});var r=n(30206),i=n(80072),o=n(16288),a=n(38106),s=n(30006),l=n(31860),d=n(83702);function u(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return c(e,(0,a.Iy)())}function c(e,t){var n,a={subComponentStyles:{}},u=void 0;(0,l.db)(e[0])?(u=e[0],n=e[1]):n=e[0],null!=u||(u=null==t?void 0:t.shadowConfig);var c=(0,r.__assign)((0,r.__assign)({},t),{shadowConfig:u});if(!n&&e.length<=1)return{subComponentStyles:{}};var g=d.nr.getInstance(u);c.stylesheet=g;var h=i.T.apply(void 0,e),p=[];for(var f in h)if(h.hasOwnProperty(f)){if("subComponentStyles"===f){a.subComponentStyles=h.subComponentStyles||{};continue}if("__shadowConfig__"===f)continue;var v=h[f],m=(0,o.h)(g,v),y=m.classes,_=m.objects;(null==_?void 0:_.length)?(S=(0,s.GJ)(c||{},{displayName:f},_))&&(p.push(S),a[f]=y.concat([S.className]).join(" ")):a[f]=y.join(" ")}for(var b=0,C=p;b<C.length;b++){var S;(S=C[b])&&(0,s.Ae)(S,null==t?void 0:t.specificityMultiplier,u)}return a}},86318:(e,t,n)=>{"use strict";n.d(t,{Y:()=>o});var r=n(84448),i=n(95734);function o(){var e=i.useRef();return e.current||(e.current=new r.j),i.useEffect((function(){return function(){var t;null===(t=e.current)||void 0===t||t.dispose(),e.current=void 0}}),[]),e.current}},1953:(e,t,n)=>{"use strict";n.d(t,{d:()=>i});var r=n(95734);function i(e){var t=r.useRef();return void 0===t.current&&(t.current={value:"function"==typeof e?e():e}),t.current.value}},85986:(e,t,n)=>{"use strict";n.d(t,{a:()=>o});var r=n(30206),i=n(95734);function o(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=i.useCallback((function(t){n.current=t;for(var r=0,i=e;r<i.length;r++){var o=i[r];"function"==typeof o?o(t):o&&(o.current=t)}}),(0,r.__spreadArray)([],e,!0));return n}},40629:(e,t,n)=>{"use strict";n.d(t,{x:()=>o});var r=n(14394),i=n(95734);function o(e,t,n,o){var a=i.useRef(n);a.current=n,i.useEffect((function(){var n=e&&"current"in e?e.current:e;if(n&&n.addEventListener)return(0,r.on)(n,t,(function(e){return a.current(e)}),o)}),[e,t,o])}},65849:(e,t,n)=>{"use strict";n.d(t,{P:()=>a});var r=n(98414),i=n(95734),o=n(92746);function a(e,t){var n,a,s,l=i.useRef(),d=i.useRef(null),u=(0,o.ox)();if(!e||e!==l.current||"string"==typeof e){var c=null==t?void 0:t.current;if(e)if("string"==typeof e)if(null===(n=null==c?void 0:c.getRootNode())||void 0===n?void 0:n.host)d.current=null!==(s=null===(a=null==c?void 0:c.getRootNode())||void 0===a?void 0:a.querySelector(e))&&void 0!==s?s:null;else{var g=(0,r.Y)(c);d.current=g?g.querySelector(e):null}else d.current="stopPropagation"in e||"getBoundingClientRect"in e?e:"current"in e?e.current:e;l.current=e}return[d,u]}},6722:(e,t,n)=>{"use strict";n.d(t,{i:()=>i});var r=n(95734),i=function(e){var t=r.useRef(e);t.current=e,r.useEffect((function(){return function(){var e;null===(e=t.current)||void 0===e||e.call(t)}}),[])}},74074:(e,t,n)=>{"use strict";n.d(t,{Y:()=>u,FD:()=>c});var r=n(23297);function i(e){return Boolean(null==e?void 0:e.hasOwnProperty(r.o))}var o=n(95734);function a(e,t){return function(n,o,a,s,l){return i(o)?t(function(e,t){return{...t,[r.o]:e}}(n,o),null,a,s,l):i(n)?t(n,o,a,s,l):e(n,o,a,s,l)}}function s(e){const{as:t,[r.o]:n,[r.Y]:i,...o}=e,a=o,s="string"==typeof n&&null!=t?t:n;return"string"!=typeof s&&t&&(a.as=t),{elementType:s,props:a,renderFunction:i}}n(1185);var l=n(86886);const d=n.t(l,2),u=a(d.jsx,((e,t,n)=>{const{elementType:r,renderFunction:i,props:a}=s(e),l={...a,...t};return i?d.jsx(o.Fragment,{children:i(r,l)},n):d.jsx(r,l,n)})),c=a(d.jsxs,((e,t,n)=>{const{elementType:r,renderFunction:i,props:a}=s(e),l={...a,...t};return i?d.jsx(o.Fragment,{children:i(r,{...l,children:d.jsxs(o.Fragment,{children:l.children},void 0)})},n):d.jsxs(r,l,n)}))},39030:(e,t,n)=>{"use strict";n.d(t,{Y:()=>u,FD:()=>c});var r=n(69313);function i(e){return Boolean(null==e?void 0:e.hasOwnProperty(r.on))}var o=n(95734);function a(e,t){return function(n,o,a,s,l){return i(o)?t(function(e,t){return{...t,[r.on]:e}}(n,o),null,a,s,l):i(n)?t(n,o,a,s,l):e(n,o,a,s,l)}}function s(e){const{as:t,[r.b9]:n,[r.on]:i,[r.Y9]:o,...a}=e,s=a,l="string"==typeof i&&null!=t?t:i;return"string"!=typeof l&&t&&(s.as=t),{elementType:l,props:s,renderFunction:o}}n(1185);var l=n(86886);const d=n.t(l,2),u=a(d.jsx,((e,t,n)=>{const{elementType:r,renderFunction:i,props:a}=s(e),l={...a,...t};return i?d.jsx(o.Fragment,{children:i(r,l)},n):d.jsx(r,l,n)})),c=a(d.jsxs,((e,t,n)=>{const{elementType:r,renderFunction:i,props:a}=s(e),l={...a,...t};return i?d.jsx(o.Fragment,{children:i(r,{...l,children:d.jsxs(o.Fragment,{children:l.children},void 0)})},n):d.jsxs(r,l,n)}))},7044:(e,t,n)=>{"use strict";n.d(t,{q:()=>B});var r=n(95734),i=n.t(r,2),o=n(74074),a=n(64671),s=n(10723),l=n(27737),d=n(71057);const u=r.createContext(void 0),c=u.Provider;var g=n(75901),h=n(19821);const p=r.createContext(void 0).Provider,f=r.createContext(void 0),v=f.Provider;var m=n(6313),y=n(48427),_=n(17190),b=n(39366),C=n(35333),S=n(89693),T=n(44877),I=n(51507),w=n(29308),E=n(29944);const x="fui-FluentProvider",A=(0,w.X)({root:{sj55zd:"f19n0e5",De3pzq:"fxugw4r",fsow6f:["f1o700av","fes3tcz"],Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi"}},{d:[".f19n0e5{color:var(--colorNeutralForeground1);}",".fxugw4r{background-color:var(--colorNeutralBackground1);}",".f1o700av{text-align:left;}",".fes3tcz{text-align:right;}",".fk6fouc{font-family:var(--fontFamilyBase);}",".fkhj508{font-size:var(--fontSizeBase300);}",".figsok6{font-weight:var(--fontWeightRegular);}",".f1i3iumi{line-height:var(--lineHeightBase300);}"]}),D=i.useInsertionEffect?i.useInsertionEffect:T.E,k={},F={},P=(e,t)=>{const n=(0,d.Y)(),i=r.useContext(u),o=null!==(a=r.useContext(f))&&void 0!==a?a:{};var a;const s=r.useContext(h.k7)||k,{applyStylesToPortals:l=!0,customStyleHooks_unstable:c,dir:g=n.dir,targetDocument:p=n.targetDocument,theme:v,overrides_unstable:m={}}=e,T=N(i,v),w=N(o,m),E=N(s,c),A=(0,y.J)();var P;const{styleTagId:B,rule:O}=(e=>{const{targetDocument:t,theme:n,rendererAttributes:i}=e,o=r.useRef(),a=(0,I.Bi)(x),s=i,l=r.useMemo((()=>function(e,t){return t?`${e} { ${Object.keys(t).reduce(((e,n)=>`${e}--${n}: ${t[n]}; `),"")} }`:`${e} {}`}(`.${a}`,n)),[n,a]);return function(e,t){r.useState((()=>{if(!e)return;const n=e.getElementById(t);n&&e.head.append(n)}))}(t,a),D((()=>{const e=null==t?void 0:t.getElementById(a);return e?o.current=e:(o.current=((e,t)=>{if(!e)return;const n=e.createElement("style");return Object.keys(t).forEach((e=>{n.setAttribute(e,t[e])})),e.head.appendChild(n),n})(t,{...s,id:a}),o.current&&((e,t)=>{const n=e.sheet;n&&(n.cssRules.length>0&&n.deleteRule(0),n.insertRule(t,0))})(o.current,l)),()=>{var e;null===(e=o.current)||void 0===e||e.remove()}}),[a,t,l,s]),{styleTagId:a,rule:l}})({theme:T,targetDocument:p,rendererAttributes:null!==(P=A.styleElementAttributes)&&void 0!==P?P:F});return{applyStylesToPortals:l,customStyleHooks_unstable:E,dir:g,targetDocument:p,theme:T,overrides_unstable:w,themeClassName:B,components:{root:"div"},root:b.Gk((0,C.g)("div",{...e,dir:g,ref:(0,S.a)(t,(0,_.Y)({targetDocument:p}))}),{elementType:"div"}),serverStyleProps:{cssRule:O,attributes:{...A.styleElementAttributes,id:B}}}};function N(e,t){return e&&t?{...e,...t}:e||t}const B=r.forwardRef(((e,t)=>{const n=P(e,t);(e=>{const t=(0,y.J)(),n=A({dir:e.dir,renderer:t});e.root.className=(0,E.z)(x,e.themeClassName,n.root,e.root.className)})(n);const i=function(e){const{applyStylesToPortals:t,customStyleHooks_unstable:n,dir:i,root:o,targetDocument:a,theme:s,themeClassName:l,overrides_unstable:d}=e,u=r.useMemo((()=>({dir:i,targetDocument:a})),[i,a]),[c]=r.useState((()=>({}))),g=r.useMemo((()=>({textDirection:i})),[i]);return{customStyleHooks_unstable:n,overrides_unstable:d,provider:u,textDirection:i,iconDirection:g,tooltip:c,theme:s,themeClassName:t?o.className:l}}(n);return((e,t)=>((0,a.C)(e),(0,o.Y)(d.K,{value:t.provider,children:(0,o.Y)(c,{value:t.theme,children:(0,o.Y)(g.I,{value:t.themeClassName,children:(0,o.Y)(h.gH,{value:t.customStyleHooks_unstable,children:(0,o.Y)(p,{value:t.tooltip,children:(0,o.Y)(l.e,{dir:t.textDirection,children:(0,o.Y)(m.F,{value:t.iconDirection,children:(0,o.Y)(v,{value:t.overrides_unstable,children:(0,o.FD)(e.root,{children:[(0,s.S)()?null:(0,o.Y)("style",{dangerouslySetInnerHTML:{__html:e.serverStyleProps.cssRule},...e.serverStyleProps.attributes}),e.root.children]})})})})})})})})})))(n,i)}));B.displayName="FluentProvider"},19821:(e,t,n)=>{"use strict";n.d(t,{$e:()=>s,gH:()=>a,k7:()=>i});var r=n(95734);const i=r.createContext(void 0),o=()=>{},a=i.Provider,s=e=>{var t,n;return null!==(n=null===(t=r.useContext(i))||void 0===t?void 0:t[e])&&void 0!==n?n:o}},71057:(e,t,n)=>{"use strict";n.d(t,{K:()=>a,Y:()=>s});var r=n(95734);const i=r.createContext(void 0),o={targetDocument:"object"==typeof document?document:void 0,dir:"ltr"},a=i.Provider;function s(){var e;return null!==(e=r.useContext(i))&&void 0!==e?e:o}},75901:(e,t,n)=>{"use strict";n.d(t,{I:()=>a,q:()=>s});var r=n(95734);const i=r.createContext(void 0),o="",a=i.Provider;function s(){var e;return null!==(e=r.useContext(i))&&void 0!==e?e:o}},63562:(e,t,n)=>{"use strict";n.d(t,{$e:()=>a});var r=n(95734);const i=r.createContext(void 0),o=()=>{},a=(i.Provider,e=>{var t,n;return null!==(n=null===(t=r.useContext(i))||void 0===t?void 0:t[e])&&void 0!==n?n:o})},17190:(e,t,n)=>{"use strict";n.d(t,{Y:()=>u});var r=n(95734),i=n(71057),o=n(54034),a=n(96406);const s="data-fui-focus-visible";function l(e,t){if(d(e))return()=>{};const n={current:void 0},r=(0,a.SQ)(t);function i(e){r.isNavigatingWithKeyboard()&&(0,o.s)(e)&&(n.current=e,e.setAttribute(s,""))}function l(){n.current&&(n.current.removeAttribute(s),n.current=void 0)}r.subscribe((e=>{e||l()}));const u=e=>{l(),i(e.composedPath()[0])},c=t=>{(!t.relatedTarget||(0,o.s)(t.relatedTarget)&&!e.contains(t.relatedTarget))&&l()};return e.addEventListener(a.Oy,u),e.addEventListener("focusout",c),e.focusVisible=!0,e.contains(t.document.activeElement)&&i(t.document.activeElement),()=>{l(),e.removeEventListener(a.Oy,u),e.removeEventListener("focusout",c),delete e.focusVisible,(0,a.bd)(r)}}function d(e){return!!e&&(!!e.focusVisible||d(null==e?void 0:e.parentElement))}function u(e={}){const t=(0,i.Y)(),n=r.useRef(null);var o;const a=null!==(o=e.targetDocument)&&void 0!==o?o:t.targetDocument;return r.useEffect((()=>{if((null==a?void 0:a.defaultView)&&n.current)return l(n.current,a.defaultView)}),[n,a]),n}},64671:(e,t,n)=>{"use strict";function r(e){}n.d(t,{C:()=>r}),n(95734)},23297:(e,t,n)=>{"use strict";n.d(t,{Y:()=>r,o:()=>i});const r=Symbol.for("fui.slotRenderFunction"),i=Symbol.for("fui.slotElementType")},35333:(e,t,n)=>{"use strict";n.d(t,{g:()=>m}),n(95734);const r=(...e)=>{const t={};for(const n of e){const e=Array.isArray(n)?n:Object.keys(n);for(const n of e)t[n]=1}return t},i=r(["onAuxClick","onAnimationEnd","onAnimationStart","onCopy","onCut","onPaste","onCompositionEnd","onCompositionStart","onCompositionUpdate","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onInput","onSubmit","onLoad","onError","onKeyDown","onKeyDownCapture","onKeyPress","onKeyUp","onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting","onClick","onClickCapture","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onMouseUpCapture","onSelect","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onScroll","onWheel","onPointerCancel","onPointerDown","onPointerEnter","onPointerLeave","onPointerMove","onPointerOut","onPointerOver","onPointerUp","onGotPointerCapture","onLostPointerCapture"]),o=r(["accessKey","children","className","contentEditable","dir","draggable","hidden","htmlFor","id","lang","ref","role","style","tabIndex","title","translate","spellCheck","name"]),a=r(["itemID","itemProp","itemRef","itemScope","itemType"]),s=r(o,i,a),l=r(s,["form"]),d=r(s,["height","loop","muted","preload","src","width"]),u=r(d,["poster"]),c=r(s,["start"]),g=r(s,["value"]),h=r(s,["download","href","hrefLang","media","rel","target","type"]),p=r(s,["dateTime"]),f=r(s,["autoFocus","disabled","form","formAction","formEncType","formMethod","formNoValidate","formTarget","type","value"]),v={label:l,audio:d,video:u,ol:c,li:g,a:h,button:f,input:r(f,["accept","alt","autoCorrect","autoCapitalize","autoComplete","checked","dirname","form","height","inputMode","list","max","maxLength","min","minLength","multiple","pattern","placeholder","readOnly","required","src","step","size","type","value","width"]),textarea:r(f,["autoCapitalize","cols","dirname","form","maxLength","placeholder","readOnly","required","rows","wrap"]),select:r(f,["form","multiple","required"]),option:r(s,["selected","value"]),table:r(s,["cellPadding","cellSpacing"]),tr:s,th:r(s,["colSpan","rowSpan","scope"]),td:r(s,["colSpan","headers","rowSpan","scope"]),colGroup:r(s,["span"]),col:r(s,["span"]),fieldset:r(s,["disabled","form"]),form:r(s,["acceptCharset","action","encType","encType","method","noValidate","target"]),iframe:r(s,["allow","allowFullScreen","allowPaymentRequest","allowTransparency","csp","height","importance","referrerPolicy","sandbox","src","srcDoc","width"]),img:r(s,["alt","crossOrigin","height","src","srcSet","useMap","width"]),time:p,dialog:r(s,["open","onCancel","onClose"])};const m=(e,t,n)=>{var r;return function(e,t,n){const r=e&&v[e]||s;return r.as=1,function(e,t,n){const r=Array.isArray(t),i={},o=Object.keys(e);for(const a of o)!(!r&&t[a]||r&&t.indexOf(a)>=0||0===a.indexOf("data-")||0===a.indexOf("aria-"))||n&&-1!==(null==n?void 0:n.indexOf(a))||(i[a]=e[a]);return i}(t,r,n)}(null!==(r=t.as)&&void 0!==r?r:e,t,n)}},39366:(e,t,n)=>{"use strict";n.d(t,{Gk:()=>o,lq:()=>a});var r=n(95734),i=n(23297);function o(e,t){const{defaultProps:n,elementType:o}=t,a=function(e){return"string"==typeof e||"number"==typeof e||Array.isArray(e)||r.isValidElement(e)?{children:e}:e}(e),s={...n,...a,[i.o]:o};return a&&"function"==typeof a.children&&(s[i.Y]=a.children,s.children=null==n?void 0:n.children),s}function a(e,t){if(null!==e&&(void 0!==e||t.renderByDefault))return o(e,t)}},51507:(e,t,n)=>{"use strict";n.d(t,{Bi:()=>l});var r=n(95734),i=n.t(r,2);const o={current:0},a=r.createContext(void 0);const s=r.createContext(void 0);function l(e="fui-",t){const n=null!==(u=r.useContext(a))&&void 0!==u?u:o,l=r.useContext(s)||"",d=i.useId;var u;if(d){const n=d(),i=r.useMemo((()=>n.replace(/:/g,"")),[n]);return t||`${l}${e}${i}`}return r.useMemo((()=>t||`${l}${e}${++n.current}`),[l,e,t,n])}s.Provider},44877:(e,t,n)=>{"use strict";n.d(t,{E:()=>i});var r=n(95734);const i=(0,n(10723).S)()?r.useLayoutEffect:r.useEffect},89693:(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var r=n(95734);function i(...e){const t=r.useCallback((n=>{t.current=n;for(const t of e)"function"==typeof t?t(n):t&&(t.current=n)}),[...e]);return t}},10723:(e,t,n)=>{"use strict";function r(){return"undefined"!=typeof window&&!(!window.document||!window.document.createElement)}n.d(t,{S:()=>r})},54034:(e,t,n)=>{"use strict";function r(e,t){var n;const r=e;var i;return Boolean((null==r||null===(n=r.ownerDocument)||void 0===n?void 0:n.defaultView)&&r instanceof r.ownerDocument.defaultView[null!==(i=null==t?void 0:t.constructorName)&&void 0!==i?i:"HTMLElement"])}n.d(t,{s:()=>r})},62655:(e,t,n)=>{"use strict";function r(e){}n.d(t,{C:()=>r}),n(95734)},69313:(e,t,n)=>{"use strict";n.d(t,{Y9:()=>r,b9:()=>o,on:()=>i});const r=Symbol.for("fui.slotRenderFunction"),i=Symbol.for("fui.slotElementType"),o=Symbol.for("fui.slotClassNameProp")},98131:(e,t,n)=>{"use strict";n.d(t,{g:()=>i}),n(95734);var r=n(86138);const i=(e,t,n)=>{var i;return(0,r._)(null!==(i=t.as)&&void 0!==i?i:e,t,n)}},85414:(e,t,n)=>{"use strict";n.d(t,{Gf:()=>s,Gk:()=>o,lq:()=>a});var r=n(95734),i=n(69313);function o(e,t){const{defaultProps:n,elementType:r}=t,o=s(e),a={...n,...o,[i.on]:r,[i.b9]:null==o?void 0:o.className};return o&&"function"==typeof o.children&&(a[i.Y9]=o.children,a.children=null==n?void 0:n.children),a}function a(e,t){if(null!==e&&(void 0!==e||t.renderByDefault))return o(e,t)}function s(e){return"string"==typeof e||"number"==typeof e||l(e)||r.isValidElement(e)?{children:e}:e}const l=e=>"object"==typeof e&&null!==e&&Symbol.iterator in e},20982:(e,t,n)=>{"use strict";var r;n.d(t,{Bi:()=>s});var i=n(95734),o=n(40209);const a=i.createContext(void 0);function s(e="fui-",t){const s=(0,o.LM)(),l=i.useContext(a)||"",d=(r||(r=n.t(i,2))).useId;if(d){const n=d(),r=i.useMemo((()=>n.replace(/:/g,"")),[n]);return t||`${l}${e}${r}`}return i.useMemo((()=>t||`${l}${e}${++s.current}`),[l,e,t,s])}a.Provider},40209:(e,t,n)=>{"use strict";n.d(t,{LM:()=>s,wR:()=>l});var r=n(95734),i=n(8675);const o={current:0},a=r.createContext(void 0);function s(){var e;return null!==(e=r.useContext(a))&&void 0!==e?e:o}function l(){const e=s()!==o,[t,n]=r.useState(e);return(0,i.S)()&&e&&r.useLayoutEffect((()=>{n(!1)}),[]),t}},8675:(e,t,n)=>{"use strict";function r(){return"undefined"!=typeof window&&!(!window.document||!window.document.createElement)}n.d(t,{S:()=>r})},86138:(e,t,n)=>{"use strict";n.d(t,{_:()=>m,n:()=>y}),n(95734);const r=(...e)=>{const t={};for(const n of e){const e=Array.isArray(n)?n:Object.keys(n);for(const n of e)t[n]=1}return t},i=r(["onAuxClick","onAnimationEnd","onAnimationStart","onCopy","onCut","onPaste","onCompositionEnd","onCompositionStart","onCompositionUpdate","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onInput","onSubmit","onLoad","onError","onKeyDown","onKeyDownCapture","onKeyPress","onKeyUp","onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting","onClick","onClickCapture","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onMouseUpCapture","onSelect","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onScroll","onWheel","onPointerCancel","onPointerDown","onPointerEnter","onPointerLeave","onPointerMove","onPointerOut","onPointerOver","onPointerUp","onGotPointerCapture","onLostPointerCapture"]),o=r(["accessKey","children","className","contentEditable","dir","draggable","hidden","htmlFor","id","lang","ref","role","style","tabIndex","title","translate","spellCheck","name"]),a=r(["itemID","itemProp","itemRef","itemScope","itemType"]),s=r(o,i,a),l=r(s,["form"]),d=r(s,["height","loop","muted","preload","src","width"]),u=r(d,["poster"]),c=r(s,["start"]),g=r(s,["value"]),h=r(s,["download","href","hrefLang","media","rel","target","type"]),p=r(s,["dateTime"]),f=r(s,["autoFocus","disabled","form","formAction","formEncType","formMethod","formNoValidate","formTarget","type","value"]),v={label:l,audio:d,video:u,ol:c,li:g,a:h,button:f,input:r(f,["accept","alt","autoCorrect","autoCapitalize","autoComplete","checked","dirname","form","height","inputMode","list","max","maxLength","min","minLength","multiple","pattern","placeholder","readOnly","required","src","step","size","type","value","width"]),textarea:r(f,["autoCapitalize","cols","dirname","form","maxLength","placeholder","readOnly","required","rows","wrap"]),select:r(f,["form","multiple","required"]),option:r(s,["selected","value"]),table:r(s,["cellPadding","cellSpacing"]),tr:s,th:r(s,["colSpan","rowSpan","scope"]),td:r(s,["colSpan","headers","rowSpan","scope"]),colGroup:r(s,["span"]),col:r(s,["span"]),fieldset:r(s,["disabled","form"]),form:r(s,["acceptCharset","action","encType","encType","method","noValidate","target"]),iframe:r(s,["allow","allowFullScreen","allowPaymentRequest","allowTransparency","csp","height","importance","referrerPolicy","sandbox","src","srcDoc","width"]),img:r(s,["alt","crossOrigin","height","src","srcSet","useMap","width"]),time:p,dialog:r(s,["open","onCancel","onClose"])};function m(e,t,n){const r=e&&v[e]||s;return r.as=1,function(e,t,n){const r=Array.isArray(t),i={},o=Object.keys(e);for(const a of o)!(!r&&t[a]||r&&t.indexOf(a)>=0||0===a.indexOf("data-")||0===a.indexOf("aria-"))||n&&-1!==(null==n?void 0:n.indexOf(a))||(i[a]=e[a]);return i}(t,r,n)}const y=({primarySlotTagName:e,props:t,excludedPropNames:n})=>({root:{style:t.style,className:t.className},primary:m(e,t,[...n||[],"style","className"])})},55713:(e,t,n)=>{"use strict";function r(e,t){return(...n)=>{null==e||e(...n),null==t||t(...n)}}n.d(t,{p:()=>r})},63503:(e,t,n)=>{"use strict";n.d(t,{IF:()=>a,ZY:()=>o});var r=n(95734),i=r.createContext({window:"object"==typeof window?window:void 0}),o=function(){var e;return null===(e=r.useContext(i).window)||void 0===e?void 0:e.document},a=function(e){return r.createElement(i.Provider,{value:e},e.children)}},92746:(e,t,n)=>{"use strict";n.d(t,{ZY:()=>a,_0:()=>i,ox:()=>o});var r=n(95734),i=r.createContext({window:"object"==typeof window?window:void 0}),o=function(){return r.useContext(i).window},a=function(){var e;return null===(e=r.useContext(i).window)||void 0===e?void 0:e.document}},72433:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var r={topLeftEdge:0,topCenter:1,topRightEdge:2,topAutoEdge:3,bottomLeftEdge:4,bottomCenter:5,bottomRightEdge:6,bottomAutoEdge:7,leftTopEdge:8,leftCenter:9,leftBottomEdge:10,rightTopEdge:11,rightCenter:12,rightBottomEdge:13}},85113:(e,t,n)=>{"use strict";n.d(t,{P:()=>Ke});var r,i=n(30206),o=n(95734),a=n(18629),s=n(72433),l=n(84931),d=n(17875),u=n(14394),c=n(40890),g=n(90503),h=n(72195),p=n(6753),f=n(97874),v=n(51055),m=n(14759),y=n(98571),_=n(64525);function b(e,t,n){return{targetEdge:e,alignmentEdge:t,isAuto:n}}var C=((r={})[s.A.topLeftEdge]=b(y.x.top,y.x.left),r[s.A.topCenter]=b(y.x.top),r[s.A.topRightEdge]=b(y.x.top,y.x.right),r[s.A.topAutoEdge]=b(y.x.top,void 0,!0),r[s.A.bottomLeftEdge]=b(y.x.bottom,y.x.left),r[s.A.bottomCenter]=b(y.x.bottom),r[s.A.bottomRightEdge]=b(y.x.bottom,y.x.right),r[s.A.bottomAutoEdge]=b(y.x.bottom,void 0,!0),r[s.A.leftTopEdge]=b(y.x.left,y.x.top),r[s.A.leftCenter]=b(y.x.left),r[s.A.leftBottomEdge]=b(y.x.left,y.x.bottom),r[s.A.rightTopEdge]=b(y.x.right,y.x.top),r[s.A.rightCenter]=b(y.x.right),r[s.A.rightBottomEdge]=b(y.x.right,y.x.bottom),r);function S(e,t){return!(e.top<t.top||e.bottom>t.bottom||e.left<t.left||e.right>t.right)}function T(e,t){var n=[];return e.top<t.top&&n.push(y.x.top),e.bottom>t.bottom&&n.push(y.x.bottom),e.left<t.left&&n.push(y.x.left),e.right>t.right&&n.push(y.x.right),n}function I(e,t){return e[y.x[t]]}function w(e,t,n){return e[y.x[t]]=n,e}function E(e,t){var n=M(t);return(I(e,n.positiveEdge)+I(e,n.negativeEdge))/2}function x(e,t){return e>0?t:-1*t}function A(e,t){return x(e,I(t,e))}function D(e,t,n){return x(n,I(e,n)-I(t,n))}function k(e,t,n,r){void 0===r&&(r=!0);var i=I(e,t)-n,o=w(e,t,n);return r&&(o=w(e,-1*t,I(e,-1*t)-i)),o}function F(e,t,n,r){return void 0===r&&(r=0),k(e,n,I(t,n)+x(n,r))}function P(e,t,n){return A(n,e)>A(n,t)}function N(e,t){for(var n=0,r=0,i=T(e,t);r<i.length;r++){var o=i[r];n+=Math.pow(D(e,t,o),2)}return n}function B(e,t,n,r){return void 0===r&&(r=200),(n===y.x.bottom||n===y.x.top)&&D(e,t,n)>=r}function O(e,t,n,r){for(var i=0,o=e;i<o.length;i++){var a=o[i],s=void 0;r&&r===-1*a?(s=k(t.elementRectangle,a,I(n,a),!1),t.forcedInBounds=!0):P(s=F(t.elementRectangle,n,a),n,-1*a)||(s=k(s,-1*a,I(n,-1*a),!1),t.forcedInBounds=!0),t.elementRectangle=s}return t}function R(e,t,n){var r=M(t).positiveEdge;return k(e,r,n-(E(e,t)-I(e,r)))}function L(e,t,n,r,i){void 0===r&&(r=0);var o=new _.M(e.left,e.right,e.top,e.bottom),a=n.alignmentEdge,s=n.targetEdge,l=i?s:-1*s;return o=i?F(o,t,s,r):function(e,t,n,r){void 0===r&&(r=0);var i=x(-1*n,r);return k(e,-1*n,I(t,n)+i)}(o,t,s,r),o=a?F(o,t,a):R(o,l,E(t,s))}function M(e){return e===y.x.top||e===y.x.bottom?{positiveEdge:y.x.left,negativeEdge:y.x.right}:{positiveEdge:y.x.top,negativeEdge:y.x.bottom}}function q(e,t,n){return n&&Math.abs(D(e,n,t))>Math.abs(D(e,n,-1*t))?-1*t:t}function W(e,t,n,r,i,o,a,s){var l,d={},u=j(t),c=o?n:-1*n,g=i||M(n).positiveEdge;return a&&!function(e,t,n){return void 0!==n&&I(e,t)===I(n,t)}(e,(l=g,-1*l),r)||(g=q(e,g,r)),d[y.x[c]]=D(e,u,c),d[y.x[g]]=D(e,u,g),s&&(d[y.x[-1*c]]=D(e,u,-1*c),d[y.x[-1*g]]=D(e,u,-1*g)),d}function U(e,t,n){var r=E(t,e),i=E(n,e),o=M(e),a=o.positiveEdge,s=o.negativeEdge;return r<=i?a:s}function z(e,t,n,r,i,o,a,s,l){void 0===o&&(o=!1);var d=L(e,t,r,i,l);return S(d,n)?{elementRectangle:d,targetEdge:r.targetEdge,alignmentEdge:r.alignmentEdge}:function(e,t,n,r,i,o,a,s,l){void 0===i&&(i=!1),void 0===a&&(a=0);var d=r.alignmentEdge,u=r.alignTargetEdge,c={elementRectangle:e,targetEdge:r.targetEdge,alignmentEdge:d};s||l||(c=function(e,t,n,r,i,o,a){void 0===i&&(i=!1),void 0===a&&(a=0);var s=[y.x.left,y.x.right,y.x.bottom,y.x.top];(0,f.jI)()&&(s[0]*=-1,s[1]*=-1);for(var l,d=e,u=r.targetEdge,c=r.alignmentEdge,g=u,h=c,p=0;p<4;p++){if(P(d,n,u))return{elementRectangle:d,targetEdge:u,alignmentEdge:c};if(i&&B(t,n,u,o)){switch(u){case y.x.bottom:d.bottom=n.bottom;break;case y.x.top:d.top=n.top}return{elementRectangle:d,targetEdge:u,alignmentEdge:c,forcedInBounds:!0}}var v=N(d,n);(!l||v<l)&&(l=v,g=u,h=c),s.splice(s.indexOf(u),1),s.length>0&&(s.indexOf(-1*u)>-1?u*=-1:(c=u,u=s.slice(-1)[0]),d=L(e,t,{targetEdge:u,alignmentEdge:c},a))}return{elementRectangle:d=L(e,t,{targetEdge:g,alignmentEdge:h},a),targetEdge:g,alignmentEdge:h}}(e,t,n,r,i,o,a));var g=T(c.elementRectangle,n),h=s?-c.targetEdge:void 0;if(g.length>0)if(u)if(c.alignmentEdge&&g.indexOf(-1*c.alignmentEdge)>-1){var p=function(e,t,n,r){var i=e.alignmentEdge,o=e.targetEdge,a=-1*i;return{elementRectangle:L(e.elementRectangle,t,{targetEdge:o,alignmentEdge:a},n,r),targetEdge:o,alignmentEdge:a}}(c,t,a,l);if(S(p.elementRectangle,n))return p;c=O(T(p.elementRectangle,n),c,n,h)}else c=O(g,c,n,h);else c=O(g,c,n,h);return c}(d,t,n,r,o,a,i,s,l)}function j(e){var t=e.getBoundingClientRect();return new _.M(t.left,t.right,t.top,t.bottom)}function H(e,t,n,r,o,a){void 0===o&&(o=!1);var l=e.gapSpace?e.gapSpace:0,d=function(e,t){var n;if(t){if(t.preventDefault){var r=t;n=new _.M(r.clientX,r.clientX,r.clientY,r.clientY)}else if(t.getBoundingClientRect)n=j(t);else{var i=t,o=i.left||i.x,a=i.top||i.y,s=i.right||o,l=i.bottom||a;n=new _.M(o,s,a,l)}if(!S(n,e))for(var d=0,u=T(n,e);d<u.length;d++){var c=u[d];n[y.x[c]]=e[y.x[c]]}}else n=new _.M(0,0,0,0);return n}(n,e.target),u=function(e,t,n,r,i){return e.isAuto&&(e.alignmentEdge=U(e.targetEdge,t,n)),e.alignTargetEdge=i,e}(function(e,t,n){if(void 0===e&&(e=s.A.bottomAutoEdge),n)return{alignmentEdge:n.alignmentEdge,isAuto:n.isAuto,targetEdge:n.targetEdge};var r=(0,i.__assign)({},C[e]);return(0,f.jI)()?(r.alignmentEdge&&r.alignmentEdge%2==0&&(r.alignmentEdge=-1*r.alignmentEdge),void 0!==t?C[t]:r):r}(e.directionalHint,e.directionalHintForRTL,r),d,n,e.coverTarget,e.alignTargetEdge),c=z(j(t),d,n,u,l,o,a,e.directionalHintFixed,e.coverTarget);return(0,i.__assign)((0,i.__assign)({},c),{targetRectangle:d})}function V(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=0),function(e){return Math.sqrt(e*e*2)}(e?t:0)/2+n}function G(e,t,n,r,o,a,s,l){void 0===o&&(o=!1);var d=null!=l?l:(0,v.z)(),u=e.isBeakVisible&&e.beakWidth||0,c=V(e.isBeakVisible,e.beakWidth,e.gapSpace),g=e;g.gapSpace=c;var h,p,f,b,C,S,T,w,x,N=e.bounds?(x=e.bounds,new _.M(x.left,x.right,x.top,x.bottom)):new _.M(0,d.innerWidth-(0,m.XJ)(),0,d.innerHeight),B=H(g,n,N,r,o,a),O=(h=B,p=function(e,t){var n=t.targetRectangle,r=M(t.targetEdge),i=r.positiveEdge,o=r.negativeEdge,a=E(n,t.targetEdge),s=new _.M(e/2,t.elementRectangle.width-e/2,e/2,t.elementRectangle.height-e/2),l=new _.M(0,e,0,e);return P(l=R(l=k(l,-1*t.targetEdge,-e/2),-1*t.targetEdge,a-A(i,t.elementRectangle)),s,i)?P(l,s,o)||(l=F(l,s,o)):l=F(l,s,i),l}(u,B),f=N,b=-1*h.targetEdge,C=new _.M(0,h.elementRectangle.width,0,h.elementRectangle.height),S={},T=q(h.elementRectangle,h.alignmentEdge?h.alignmentEdge:M(b).positiveEdge,f),w=D(h.elementRectangle,h.targetRectangle,b)>Math.abs(I(p,b)),S[y.x[b]]=I(p,b),S[y.x[T]]=D(p,C,T),{elementPosition:(0,i.__assign)({},S),closestEdge:U(h.targetEdge,p,C),targetEdge:b,hideBeak:!w});return(0,i.__assign)((0,i.__assign)({},function(e,t,n,r,i){return{elementPosition:W(e.elementRectangle,t,e.targetEdge,n,e.alignmentEdge,r,i,e.forcedInBounds),targetEdge:e.targetEdge,alignmentEdge:e.alignmentEdge}}(B,t,N,e.coverTarget,s)),{beakPosition:O})}var Q=n(98414),K=n(72203),$=n(23597),Z=n(86318),J=n(40629),X=n(85986),Y=n(92746);function ee(e){var t=e.originalElement,n=e.containsFocus;t&&n&&t!==(0,v.z)()&&setTimeout((function(){var e;null===(e=t.focus)||void 0===e||e.call(t)}),0)}var te=o.forwardRef((function(e,t){var n=(0,c.N)({shouldRestoreFocus:!0,enableAriaHiddenSiblings:!0},e),r=o.useRef(),a=(0,X.a)(r,t);!function(e,t){var n="true"===String(e["aria-modal"]).toLowerCase()&&e.enableAriaHiddenSiblings;o.useEffect((function(){if(n&&t.current)return(0,K.q)(t.current)}),[t,n])}(n,r),function(e,t){var n=e.onRestoreFocus,r=void 0===n?ee:n,i=o.useRef(),a=o.useRef(!1);o.useEffect((function(){return i.current=(0,Q.Y)().activeElement,(0,l.SE)(t.current)&&(a.current=!0),function(){var e;null==r||r({originalElement:i.current,containsFocus:a.current,documentContainsFocus:(null===(e=(0,Q.Y)())||void 0===e?void 0:e.hasFocus())||!1}),i.current=void 0}}),[]),(0,J.x)(t,"focus",o.useCallback((function(){a.current=!0}),[]),!0),(0,J.x)(t,"blur",o.useCallback((function(e){t.current&&e.relatedTarget&&!t.current.contains(e.relatedTarget)&&(a.current=!1)}),[]),!0)}(n,r);var s=n.role,d=n.className,u=n.ariaLabel,h=n.ariaLabelledBy,p=n.ariaDescribedBy,f=n.style,v=n.children,m=n.onDismiss,y=function(e,t){var n=(0,Z.Y)(),r=o.useState(!1),i=r[0],a=r[1];return o.useEffect((function(){return n.requestAnimationFrame((function(){var n;if(!e.style||!e.style.overflowY){var r=!1;if(t&&t.current&&(null===(n=t.current)||void 0===n?void 0:n.firstElementChild)){var o=t.current.clientHeight,s=t.current.firstElementChild.clientHeight;o>0&&s>o&&(r=s-o>1)}i!==r&&a(r)}})),function(){return n.dispose()}})),i}(n,r),_=o.useCallback((function(e){e.which===$.c.escape&&m&&(m(e),e.preventDefault(),e.stopPropagation())}),[m]),b=(0,Y.ox)();return(0,J.x)(b,"keydown",_),o.createElement("div",(0,i.__assign)({ref:a},(0,g.G1)(n,g.JM),{className:d,role:s,"aria-label":u,"aria-labelledby":h,"aria-describedby":p,onKeyDown:_,style:(0,i.__assign)({overflowY:y?"scroll":void 0,outline:"none"},f)}),v)}));te.displayName="Popup";var ne,re=n(53486),ie=n(39454),oe=n(1953),ae=n(65849),se=n(24463),le=((ne={})[y.x.top]=ie.lw.slideUpIn10,ne[y.x.bottom]=ie.lw.slideDownIn10,ne[y.x.left]=ie.lw.slideLeftIn10,ne[y.x.right]=ie.lw.slideRightIn10,ne),de={opacity:0,filter:"opacity(0)",pointerEvents:"none"},ue=["role","aria-roledescription"],ce={preventDismissOnLostFocus:!1,preventDismissOnScroll:!1,preventDismissOnResize:!1,isBeakVisible:!0,beakWidth:16,gapSpace:0,minPagePadding:8,directionalHint:s.A.bottomAutoEdge},ge=(0,re.Z)({disableCaching:!0});function he(e,t,n,r){var i,a=e.calloutMaxHeight,s=e.finalHeight,l=e.directionalHint,d=e.directionalHintFixed,u=e.hidden,c=e.gapSpace,g=e.beakWidth,h=e.isBeakVisible,p=e.coverTarget,f=o.useState(),v=f[0],m=f[1],b=null!==(i=null==r?void 0:r.elementPosition)&&void 0!==i?i:{},C=b.top,S=b.bottom,T=(null==n?void 0:n.current)?function(e){var t,n,r,i,o=e,a=e,s=e,l=null!==(t=s.left)&&void 0!==t?t:s.x,d=null!==(n=s.top)&&void 0!==n?n:s.y,u=null!==(r=s.right)&&void 0!==r?r:l,c=null!==(i=s.bottom)&&void 0!==i?i:d;return o.stopPropagation?new _.M(o.clientX,o.clientX,o.clientY,o.clientY):void 0!==l&&void 0!==d?new _.M(l,u,d,c):j(a)}(n.current):void 0;return o.useEffect((function(){var e,n,i=null!==(e=t())&&void 0!==e?e:{},o=i.top,s=i.bottom;(null==r?void 0:r.targetEdge)===y.x.top&&(null==T?void 0:T.top)&&!p&&(s=T.top-function(e,t,n){return V(e,t,n)}(h,g,c)),"number"==typeof C&&s?n=s-C:"number"==typeof S&&"number"==typeof o&&s&&(n=s-o-S),m(!a&&!u||a&&n&&a>n?n:a||void 0)}),[S,a,s,l,d,t,u,r,C,c,g,h,T,p]),v}function pe(e,t,n,r,a,s){var l,d=o.useState(),u=d[0],c=d[1],g=o.useRef(0),h=o.useRef(),p=(0,Z.Y)(),f=e.hidden,m=e.target,y=e.finalHeight,_=e.calloutMaxHeight,b=e.onPositioned,C=e.directionalHint,S=e.hideOverflow,T=e.preferScrollResizePositioning,I=(0,se.bX)(),w=o.useRef();w.current!==s.current&&(w.current=s.current,l=s.current?null==I?void 0:I.getComputedStyle(s.current):void 0);var E=null==l?void 0:l.overflowY;return o.useEffect((function(){if(!f){var o=p.requestAnimationFrame((function(){var o,s,l,d;if(t.current&&n){var p=(0,i.__assign)((0,i.__assign)({},e),{target:r.current,bounds:a()}),f=n.cloneNode(!0);f.style.maxHeight=_?"".concat(_):"",f.style.visibility="hidden",null===(o=n.parentElement)||void 0===o||o.appendChild(f);var C=h.current===m?u:void 0,w=T&&!(S||"clip"===E||"hidden"===E),x=y?function(e,t,n,r,i){return function(e,t,n,r,i){return G(e,t,n,r,!1,void 0,!0,null!=i?i:(0,v.z)())}(e,t,n,r,i)}(p,t.current,f,C,I):function(e,t,n,r,i,o,a){return G(e,t,n,r,i,void 0,void 0,a)}(p,t.current,f,C,w,0,I);null===(s=n.parentElement)||void 0===s||s.removeChild(f),!u&&x||u&&x&&(d=x,!me((l=u).elementPosition,d.elementPosition)||!me(l.beakPosition.elementPosition,d.beakPosition.elementPosition))&&g.current<5?(g.current++,c(x)):g.current>0&&(g.current=0,null==b||b(u))}}),n);return h.current=m,function(){p.cancelAnimationFrame(o),h.current=void 0}}c(void 0),g.current=0}),[f,C,p,n,_,t,r,y,a,b,u,e,m,S,T,E,I]),u}var fe=o.memo(o.forwardRef((function(e,t){var n=(0,c.N)(ce,e),r=n.styles,a=n.style,s=n.ariaLabel,p=n.ariaDescribedBy,f=n.ariaLabelledBy,v=n.className,m=n.isBeakVisible,y=n.children,_=n.beakWidth,b=n.calloutWidth,C=n.calloutMaxWidth,S=n.calloutMinWidth,T=n.doNotLayer,I=n.finalHeight,w=n.hideOverflow,E=void 0===w?!!I:w,x=n.backgroundColor,A=n.calloutMaxHeight,D=n.onScroll,k=n.shouldRestoreFocus,F=void 0===k||k,P=n.target,N=n.hidden,B=n.onLayerMounted,O=n.popupProps,R=o.useRef(null),L=o.useRef(null),M=(0,X.a)(L,null==O?void 0:O.ref),q=o.useState(null),W=q[0],U=q[1],z=o.useCallback((function(e){U(e)}),[]),j=(0,X.a)(R,t),H=(0,ae.P)(n.target,{current:W}),V=H[0],G=H[1],Q=function(e,t,n){var r=e.bounds,i=e.minPagePadding,a=void 0===i?ce.minPagePadding:i,s=e.target,l=o.useState(!1),d=l[0],u=l[1],c=o.useRef(),g=o.useCallback((function(){if(!c.current||d){var e="function"==typeof r?n?r(s,n):void 0:r;!e&&n&&(e=function(e,t){return function(e,t){var n=void 0;if(t.getWindowSegments&&(n=t.getWindowSegments()),void 0===n||n.length<=1)return{top:0,left:0,right:t.innerWidth,bottom:t.innerHeight,width:t.innerWidth,height:t.innerHeight};var r=0,i=0;if(null!==e&&e.getBoundingClientRect){var o=e.getBoundingClientRect();r=(o.left+o.right)/2,i=(o.top+o.bottom)/2}else null!==e&&(r=e.left||e.x,i=e.top||e.y);for(var a={top:0,left:0,right:0,bottom:0,width:0,height:0},s=0,l=n;s<l.length;s++){var d=l[s];r&&d.left<=r&&d.right>=r&&i&&d.top<=i&&d.bottom>=i&&(a={top:d.top,left:d.left,right:d.right,bottom:d.bottom,width:d.width,height:d.height})}return a}(e,t)}(t.current,n),e={top:e.top+a,left:e.left+a,right:e.right-a,bottom:e.bottom-a,width:e.width-2*a,height:e.height-2*a}),c.current=e,d&&u(!1)}return c.current}),[r,a,s,t,n,d]),h=(0,Z.Y)();return(0,J.x)(n,"resize",h.debounce((function(){u(!0)}),500,{leading:!0})),g}(n,V,G),K=pe(n,R,W,V,Q,M),$=he(n,Q,V,K),Y=function(e,t,n,r,i){var a=e.hidden,s=e.onDismiss,l=e.preventDismissOnScroll,c=e.preventDismissOnResize,g=e.preventDismissOnLostFocus,h=e.dismissOnTargetClick,p=e.shouldDismissOnWindowFocus,f=e.preventDismissOnEvent,v=o.useRef(!1),m=(0,Z.Y)(),y=(0,oe.d)([function(){v.current=!0},function(){v.current=!1}]),_=!!t;return o.useEffect((function(){var e=function(e){_&&!l&&y(e)},t=function(e){c||f&&f(e)||null==s||s(e)},o=function(e){g||y(e)},y=function(e){var t=e.composedPath?e.composedPath():[],o=t.length>0?t[0]:e.target,a=n.current&&!(0,d.s)(n.current,o);if(a&&v.current)v.current=!1;else if(!r.current&&a||e.target!==i&&a&&(!r.current||"stopPropagation"in r.current||h||o!==r.current&&!(0,d.s)(r.current,o))){if(f&&f(e))return;null==s||s(e)}},b=function(e){p&&((!f||f(e))&&(f||g)||(null==i?void 0:i.document.hasFocus())||null!==e.relatedTarget||null==s||s(e))},C=new Promise((function(n){m.setTimeout((function(){if(!a&&i){var r=[(0,u.on)(i,"scroll",e,!0),(0,u.on)(i,"resize",t,!0),(0,u.on)(i.document.documentElement,"focus",o,!0),(0,u.on)(i.document.documentElement,"click",o,!0),(0,u.on)(i,"blur",b,!0)];n((function(){r.forEach((function(e){return e()}))}))}}),0)}));return function(){C.then((function(e){return e()}))}}),[a,m,n,r,i,s,p,h,g,c,l,_,f]),y}(n,K,R,V,G),ee=Y[0],ne=Y[1],re=(null==K?void 0:K.elementPosition.top)&&(null==K?void 0:K.elementPosition.bottom),ie=(0,i.__assign)((0,i.__assign)({},null==K?void 0:K.elementPosition),{maxHeight:$});if(re&&(ie.bottom=void 0),function(e,t,n){var r=e.hidden,i=e.setInitialFocus,a=(0,Z.Y)(),s=!!t;o.useEffect((function(){if(!r&&i&&s&&n){var e=a.requestAnimationFrame((function(){return(0,l.vO)(n)}),n);return function(){return a.cancelAnimationFrame(e)}}}),[r,s,a,n,i])}(n,K,W),o.useEffect((function(){N||null==B||B()}),[N]),!G)return null;var se=E,fe=m&&!!P,me=ge(r,{theme:n.theme,className:v,overflowYHidden:se,calloutWidth:b,positions:K,beakWidth:_,backgroundColor:x,calloutMaxWidth:C,calloutMinWidth:S,doNotLayer:T}),ye=(0,i.__assign)((0,i.__assign)({maxHeight:A||"100%"},a),se&&{overflowY:"hidden"}),_e=n.hidden?{visibility:"hidden"}:void 0;return o.createElement("div",{ref:j,className:me.container,style:_e},o.createElement("div",(0,i.__assign)({},(0,g.G1)(n,g.JM,ue),{className:(0,h.A)(me.root,K&&K.targetEdge&&le[K.targetEdge]),style:K?(0,i.__assign)({},ie):de,tabIndex:-1,ref:z}),fe&&o.createElement("div",{className:me.beak,style:ve(K)}),fe&&o.createElement("div",{className:me.beakCurtain}),o.createElement(te,(0,i.__assign)({role:n.role,"aria-roledescription":n["aria-roledescription"],ariaDescribedBy:p,ariaLabel:s,ariaLabelledBy:f,className:me.calloutMain,onDismiss:n.onDismiss,onMouseDown:ee,onMouseUp:ne,onRestoreFocus:n.onRestoreFocus,onScroll:D,shouldRestoreFocus:F,style:ye},O,{ref:M}),y)))})),(function(e,t){return!(t.shouldUpdateWhenHidden||!e.hidden||!t.hidden)||(0,p.ab)(e,t)}));function ve(e){var t,n,r=(0,i.__assign)((0,i.__assign)({},null===(t=null==e?void 0:e.beakPosition)||void 0===t?void 0:t.elementPosition),{display:(null===(n=null==e?void 0:e.beakPosition)||void 0===n?void 0:n.hideBeak)?"none":void 0});return r.top||r.bottom||r.left||r.right||(r.left=0,r.top=0),r}function me(e,t){for(var n in t)if(t.hasOwnProperty(n)){var r=e[n],i=t[n];if(void 0===r||void 0===i)return!1;if(r.toFixed(2)!==i.toFixed(2))return!1}return!0}function ye(e){return{height:e,width:e}}fe.displayName="CalloutContentBase";var _e={container:"ms-Callout-container",root:"ms-Callout",beak:"ms-Callout-beak",beakCurtain:"ms-Callout-beakCurtain",calloutMain:"ms-Callout-main"},be=(0,a.I)(fe,(function(e){var t,n=e.theme,r=e.className,i=e.overflowYHidden,o=e.calloutWidth,a=e.beakWidth,s=e.backgroundColor,l=e.calloutMaxWidth,d=e.calloutMinWidth,u=e.doNotLayer,c=(0,ie.Km)(_e,n),g=n.semanticColors,h=n.effects;return{container:[c.container,{position:"relative"}],root:[c.root,n.fonts.medium,{position:"absolute",display:"flex",zIndex:u?ie.nA.Layer:void 0,boxSizing:"border-box",borderRadius:h.roundedCorner2,boxShadow:h.elevation16,selectors:(t={},t[ie.up]={borderWidth:1,borderStyle:"solid",borderColor:"WindowText"},t)},(0,ie.QN)(),r,!!o&&{width:o},!!l&&{maxWidth:l},!!d&&{minWidth:d}],beak:[c.beak,{position:"absolute",backgroundColor:g.menuBackground,boxShadow:"inherit",border:"inherit",boxSizing:"border-box",transform:"rotate(45deg)"},ye(a),s&&{backgroundColor:s}],beakCurtain:[c.beakCurtain,{position:"absolute",top:0,right:0,bottom:0,left:0,backgroundColor:g.menuBackground,borderRadius:h.roundedCorner2}],calloutMain:[c.calloutMain,{backgroundColor:g.menuBackground,overflowX:"hidden",overflowY:"auto",position:"relative",width:"100%",borderRadius:h.roundedCorner2},i&&{overflowY:"hidden"},s&&{backgroundColor:s}]}}),void 0,{scope:"CalloutContent"}),Ce=n(10326),Se=n(38883),Te=n(92420),Ie=n(43376),we=n(97061),Ee=n(13537);function xe(e,t){void 0===e&&(e={});var n=Ae(t)?t:function(e){return function(t){return e?(0,i.__assign)((0,i.__assign)({},t),e):t}}(t);return n(e)}function Ae(e){return"function"==typeof e}var De=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onCustomizationChange=function(){return t.forceUpdate()},t}return(0,i.__extends)(t,e),t.prototype.componentDidMount=function(){we.X.observe(this._onCustomizationChange)},t.prototype.componentWillUnmount=function(){we.X.unobserve(this._onCustomizationChange)},t.prototype.render=function(){var e=this,t=this.props.contextTransform;return o.createElement(Ee.z.Consumer,null,(function(n){var r=function(e,t){var n,r,o,a=(t||{}).customizations,s=void 0===a?{settings:{},scopedSettings:{}}:a;return{customizations:{settings:xe(s.settings,e.settings),scopedSettings:(n=s.scopedSettings,r=e.scopedSettings,void 0===n&&(n={}),(Ae(r)?r:(void 0===(o=r)&&(o={}),function(e){var t=(0,i.__assign)({},e);for(var n in o)o.hasOwnProperty(n)&&(t[n]=(0,i.__assign)((0,i.__assign)({},e[n]),o[n]));return t}))(n)),inCustomizerContext:!0}}}(e.props,n);return t&&(r=t(r)),o.createElement(Ee.z.Provider,{value:r},e.props.children)}))},t}(o.Component),ke=n(87751),Fe=(0,re.Z)(),Pe=(0,Te.J9)((function(e,t){return(0,ke.a)((0,i.__assign)((0,i.__assign)({},e),{rtl:t}))})),Ne=o.forwardRef((function(e,t){var n=e.className,r=e.theme,a=e.applyTheme,s=e.applyThemeToBody,l=e.styles,d=Fe(l,{theme:r,applyTheme:a,className:n}),u=o.useRef(null);return function(e,t,n){var r=t.bodyThemed;o.useEffect((function(){if(e){var t=(0,Q.Y)(n.current);if(t)return t.body.classList.add(r),function(){t.body.classList.remove(r)}}}),[r,e,n])}(s,d,u),o.createElement(o.Fragment,null,function(e,t,n,r){var a=t.root,s=e.as,l=void 0===s?"div":s,d=e.dir,u=e.theme,c=(0,g.G1)(e,g.JM,["dir"]),h=function(e){var t=e.theme,n=e.dir,r=(0,f.jI)(t)?"rtl":"ltr",i=(0,f.jI)()?"rtl":"ltr",o=n||r;return{rootDir:o!==r||o!==i?o:n,needsTheme:o!==r}}(e),p=h.rootDir,v=h.needsTheme,m=o.createElement(Ie.N,{providerRef:n},o.createElement(l,(0,i.__assign)({dir:p},c,{className:a,ref:(0,X.a)(n,r)})));return v&&(m=o.createElement(De,{settings:{theme:Pe(u,"rtl"===d)}},m)),m}(e,d,u,t))}));Ne.displayName="FabricBase";var Be,Oe={fontFamily:"inherit"},Re={root:"ms-Fabric",bodyThemed:"ms-Fabric-bodyThemed"},Le=(0,a.I)(Ne,(function(e){var t=e.applyTheme,n=e.className,r=e.preventBlanketFontInheritance,i=e.theme;return{root:[(0,ie.Km)(Re,i).root,i.fonts.medium,{color:i.palette.neutralPrimary},!r&&{"& button":Oe,"& input":Oe,"& textarea":Oe},t&&{color:i.semanticColors.bodyText,backgroundColor:i.semanticColors.bodyBackground},n],bodyThemed:[{backgroundColor:i.semanticColors.bodyBackground}]}}),void 0,{scope:"Fabric"}),Me=n(33594),qe=n(17565),We=n(79970),Ue=n(83745),ze=n(92301),je=(0,re.Z)(),He=o.forwardRef((function(e,t){var n=(0,Ce.u)(),r=o.useRef(null),a=(0,X.a)(r,t),s=o.useRef(),l=o.useRef(null),d=o.useContext(qe.dM),u=o.useState(!1),c=u[0],g=u[1],p=o.useCallback((function(e){var t,n=!!(null==(t=null==d?void 0:d.providerRef)?void 0:t.current)&&t.current.classList.contains(Me.Y2);e&&n&&e.classList.add(Me.Y2)}),[d]),f=e.children,v=e.className,m=e.eventBubblingEnabled,y=e.fabricProps,_=e.hostId,b=e.insertFirst,C=e.onLayerDidMount,S=void 0===C?function(){}:C,T=e.onLayerMounted,I=void 0===T?function(){}:T,w=e.onLayerWillUnmount,E=e.styles,x=e.theme,A=(0,X.a)(l,null==y?void 0:y.ref,p),D=je(E,{theme:x,className:v,isNotHost:!_}),k=function(){null==w||w();var e=s.current;s.current=void 0,e&&e.parentNode&&e.parentNode.removeChild(e)},F=function(){var e,t,n,i,o=(0,Q.Y)(r.current),a=(null===(t=null===(e=r.current)||void 0===e?void 0:e.getRootNode())||void 0===t?void 0:t.host)?null===(n=null==r?void 0:r.current)||void 0===n?void 0:n.getRootNode():void 0;if(o&&(o||a)){var l=function(e,t){var n,r;void 0===t&&(t=null);var i=null!=t?t:e;if(_){var o=(0,Ue.Ao)(_);return o?null!==(n=o.rootRef.current)&&void 0!==n?n:null:null!==(r=i.getElementById(_))&&void 0!==r?r:null}var a=(0,Ue.Ju)(),s=a?i.querySelector(a):null;return s||(s=(0,Ue.tQ)(e,t)),s}(o,a);if(l){l.__tabsterElementFlags||(l.__tabsterElementFlags={}),l.__tabsterElementFlags.noDirectAriaHidden=!0,k();var d=(null!==(i=l.ownerDocument)&&void 0!==i?i:o).createElement("div");d.className=D.root,(0,We.V)(d),function(e,t){var n=e,r=t;n._virtual||(n._virtual={children:[]});var i=n._virtual.parent;if(i&&i!==t){var o=i._virtual.children.indexOf(n);o>-1&&i._virtual.children.splice(o,1)}n._virtual.parent=r||void 0,r&&(r._virtual||(r._virtual={children:[]}),r._virtual.children.push(n))}(d,r.current),b?l.insertBefore(d,l.firstChild):l.appendChild(d),s.current=d,g(!0)}}};return(0,ze.E)((function(){F(),_&&(0,Ue.vh)(_,F);var e=s.current?n(s.current):void 0;return function(){e&&e(),k(),_&&(0,Ue.GU)(_,F)}}),[_]),o.useEffect((function(){s.current&&c&&(null==I||I(),null==S||S(),g(!1))}),[c,I,S]),o.createElement("span",{className:"ms-layer",ref:a},s.current&&Se.createPortal(o.createElement(Ie.N,{layerRoot:!0,providerRef:A},o.createElement(Le,(0,i.__assign)({},!m&&(Be||(Be={},["onClick","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOver","onMouseOut","onMouseUp","onTouchMove","onTouchStart","onTouchCancel","onTouchEnd","onKeyDown","onKeyPress","onKeyUp","onFocus","onBlur","onChange","onInput","onInvalid","onSubmit"].forEach((function(e){return Be[e]=Ve}))),Be),y,{className:(0,h.A)(D.content,null==y?void 0:y.className),ref:A}),f)),s.current))}));He.displayName="LayerBase";var Ve=function(e){e.eventPhase===Event.BUBBLING_PHASE&&"mouseenter"!==e.type&&"mouseleave"!==e.type&&"touchstart"!==e.type&&"touchend"!==e.type&&e.stopPropagation()},Ge={root:"ms-Layer",rootNoHost:"ms-Layer--fixed",content:"ms-Layer-content"},Qe=(0,a.I)(He,(function(e){var t=e.className,n=e.isNotHost,r=e.theme,i=(0,ie.Km)(Ge,r);return{root:[i.root,r.fonts.medium,n&&[i.rootNoHost,{position:"fixed",zIndex:ie.nA.Layer,top:0,left:0,bottom:0,right:0,visibility:"hidden"}],t],content:[i.content,{visibility:"visible"}]}}),void 0,{scope:"Layer",fields:["hostId","theme","styles"]}),Ke=o.forwardRef((function(e,t){var n=e.layerProps,r=e.doNotLayer,a=(0,i.__rest)(e,["layerProps","doNotLayer"]),s=o.createElement(be,(0,i.__assign)({},a,{doNotLayer:r,ref:t}));return r?s:o.createElement(Qe,(0,i.__assign)({},n),s)}));Ke.displayName="Callout"},57579:(e,t,n)=>{"use strict";n.d(t,{l8:()=>c,ne:()=>u});var r=n(30206),i=n(95734),o=n(56584),a=n(92420),s=n(90503),l=n(72195),d=n(39454),u=(0,a.J9)((function(e){var t=(0,d.sW)(e)||{subset:{},code:void 0},n=t.code,r=t.subset;return n?{children:n,iconClassName:r.className,fontFamily:r.fontFace&&r.fontFace.fontFamily,mergeImageProps:r.mergeImageProps}:null}),void 0,!0),c=function(e){var t=e.iconName,n=e.className,a=e.style,d=void 0===a?{}:a,c=u(t)||{},g=c.iconClassName,h=c.children,p=c.fontFamily,f=c.mergeImageProps,v=(0,s.G1)(e,s.vt),m=e["aria-label"]||e.title,y=e["aria-label"]||e["aria-labelledby"]||e.title?{role:f?void 0:"img"}:{"aria-hidden":!0},_=h;return f&&"object"==typeof h&&"object"==typeof h.props&&m&&(_=i.cloneElement(h,{alt:m})),i.createElement("i",(0,r.__assign)({"data-icon-name":t},y,v,f?{title:void 0,"aria-label":void 0}:{},{className:(0,l.A)(o.xD,o.xW.root,g,!t&&o.xW.placeholder,n),style:(0,r.__assign)({fontFamily:p},d)}),_)};(0,a.J9)((function(e,t,n){return c({iconName:e,className:t,"aria-label":n})}))},56584:(e,t,n)=>{"use strict";n.d(t,{$f:()=>o,xD:()=>i,xW:()=>r});var r=(0,n(39454).l8)({root:{display:"inline-block",textDecoration:"inherit"},placeholder:["ms-Icon-placeHolder",{width:"1em"}],image:["ms-Icon-imageContainer",{overflow:"hidden"}]}),i="ms-Icon",o=function(e){var t=e.className,n=e.iconClassName,i=e.isPlaceholder,o=e.isImage,a=e.styles;return{root:[i&&r.placeholder,r.root,o&&r.image,n,t,a&&a.root,a&&a.imageContainer]}}},83745:(e,t,n)=>{"use strict";n.d(t,{$K:()=>u,Ao:()=>d,GU:()=>l,Ju:()=>p,K3:()=>h,a$:()=>c,tQ:()=>g,vh:()=>s});var r={},i={},o="fluent-default-layer-host",a="#".concat(o);function s(e,t){r[e]||(r[e]=[]),r[e].push(t);var n=i[e];if(n)for(var o=0,a=n;o<a.length;o++)a[o].notifyLayersChanged()}function l(e,t){var n=r[e];if(n){var o=n.indexOf(t);o>=0&&(n.splice(o,1),0===n.length&&delete r[e])}var a=i[e];if(a)for(var s=0,l=a;s<l.length;s++)l[s].notifyLayersChanged()}function d(e){var t=i[e];return t&&t[0]||void 0}function u(e,t){(i[e]||(i[e]=[])).unshift(t)}function c(e,t){var n=i[e];if(n){var r=n.indexOf(t);r>=0&&n.splice(r,1),0===n.length&&delete i[e]}}function g(e,t){void 0===t&&(t=null);var n=e.createElement("div");return n.setAttribute("id",o),n.style.cssText="position:fixed;z-index:1000000",t?t.appendChild(n):null==e||e.body.appendChild(n),n}function h(e){r[e]&&r[e].forEach((function(e){return e()}))}function p(){return a}},24463:(e,t,n)=>{"use strict";n.d(t,{LW:()=>o,bX:()=>i});var r=n(92746),i=function(){var e;return null!==(e=(0,r.ox)())&&void 0!==e?e:"undefined"!=typeof window?window:void 0},o=function(e){var t,n;return null!==(n=null===(t=null==e?void 0:e.window)||void 0===t?void 0:t.document)&&void 0!==n?n:"undefined"!=typeof document?document:void 0}},98571:(e,t,n)=>{"use strict";var r,i;n.d(t,{x:()=>r}),function(e){e[e.top=1]="top",e[e.bottom=-1]="bottom",e[e.left=2]="left",e[e.right=-2]="right"}(r||(r={})),function(e){e[e.top=0]="top",e[e.bottom=1]="bottom",e[e.start=2]="start",e[e.end=3]="end"}(i||(i={}))},39454:(e,t,n)=>{"use strict";n.d(t,{lw:()=>Y,s:()=>Z,BO:()=>J,up:()=>ie,fF:()=>X,mm:()=>oe,nr:()=>te.nr,nA:()=>le,TW:()=>Ze.T,pB:()=>Je.p,QN:()=>ce,gm:()=>ue,Km:()=>re,Qg:()=>se,sW:()=>Ge,L6:()=>ae,O4:()=>We,dX:()=>ee,l8:()=>Xe.l,Zq:()=>r.Z,K1:()=>Ve});var r=n(48614),i=n(76437),o="cubic-bezier(.1,.9,.2,1)",a="cubic-bezier(.1,.25,.75,.9)",s="0.167s",l="0.267s",d="0.367s",u="0.467s",c=(0,i.i)({from:{opacity:0},to:{opacity:1}}),g=(0,i.i)({from:{opacity:1},to:{opacity:0,visibility:"hidden"}}),h=H(-10),p=H(-20),f=H(-40),v=H(-400),m=H(10),y=H(20),_=H(40),b=H(400),C=V(10),S=V(20),T=V(-10),I=V(-20),w=G(10),E=G(20),x=G(40),A=G(400),D=G(-10),k=G(-20),F=G(-40),P=G(-400),N=Q(-10),B=Q(-20),O=Q(10),R=Q(20),L=(0,i.i)({from:{transform:"scale3d(.98,.98,1)"},to:{transform:"scale3d(1,1,1)"}}),M=(0,i.i)({from:{transform:"scale3d(1,1,1)"},to:{transform:"scale3d(.98,.98,1)"}}),q=(0,i.i)({from:{transform:"scale3d(1.03,1.03,1)"},to:{transform:"scale3d(1,1,1)"}}),W=(0,i.i)({from:{transform:"scale3d(1,1,1)"},to:{transform:"scale3d(1.03,1.03,1)"}}),U=(0,i.i)({from:{transform:"rotateZ(0deg)"},to:{transform:"rotateZ(90deg)"}}),z=(0,i.i)({from:{transform:"rotateZ(0deg)"},to:{transform:"rotateZ(-90deg)"}});function j(e,t,n){return{animationName:e,animationDuration:t,animationTimingFunction:n,animationFillMode:"both"}}function H(e){return(0,i.i)({from:{transform:"translate3d(".concat(e,"px,0,0)"),pointerEvents:"none"},to:{transform:"translate3d(0,0,0)",pointerEvents:"auto"}})}function V(e){return(0,i.i)({from:{transform:"translate3d(0,".concat(e,"px,0)"),pointerEvents:"none"},to:{transform:"translate3d(0,0,0)",pointerEvents:"auto"}})}function G(e){return(0,i.i)({from:{transform:"translate3d(0,0,0)"},to:{transform:"translate3d(".concat(e,"px,0,0)")}})}function Q(e){return(0,i.i)({from:{transform:"translate3d(0,0,0)"},to:{transform:"translate3d(0,".concat(e,"px,0)")}})}var K,$,Z,J,X,Y=function(e){var t={},n=function(n){var i;e.hasOwnProperty(n)&&Object.defineProperty(t,n,{get:function(){return void 0===i&&(i=(0,r.Z)(e[n]).toString()),i},enumerable:!0,configurable:!0})};for(var i in e)n(i);return t}({slideRightIn10:j("".concat(c,",").concat(h),d,o),slideRightIn20:j("".concat(c,",").concat(p),d,o),slideRightIn40:j("".concat(c,",").concat(f),d,o),slideRightIn400:j("".concat(c,",").concat(v),d,o),slideLeftIn10:j("".concat(c,",").concat(m),d,o),slideLeftIn20:j("".concat(c,",").concat(y),d,o),slideLeftIn40:j("".concat(c,",").concat(_),d,o),slideLeftIn400:j("".concat(c,",").concat(b),d,o),slideUpIn10:j("".concat(c,",").concat(C),d,o),slideUpIn20:j("".concat(c,",").concat(S),d,o),slideDownIn10:j("".concat(c,",").concat(T),d,o),slideDownIn20:j("".concat(c,",").concat(I),d,o),slideRightOut10:j("".concat(g,",").concat(w),d,o),slideRightOut20:j("".concat(g,",").concat(E),d,o),slideRightOut40:j("".concat(g,",").concat(x),d,o),slideRightOut400:j("".concat(g,",").concat(A),d,o),slideLeftOut10:j("".concat(g,",").concat(D),d,o),slideLeftOut20:j("".concat(g,",").concat(k),d,o),slideLeftOut40:j("".concat(g,",").concat(F),d,o),slideLeftOut400:j("".concat(g,",").concat(P),d,o),slideUpOut10:j("".concat(g,",").concat(N),d,o),slideUpOut20:j("".concat(g,",").concat(B),d,o),slideDownOut10:j("".concat(g,",").concat(O),d,o),slideDownOut20:j("".concat(g,",").concat(R),d,o),scaleUpIn100:j("".concat(c,",").concat(L),d,o),scaleDownIn100:j("".concat(c,",").concat(q),d,o),scaleUpOut103:j("".concat(g,",").concat(W),s,a),scaleDownOut98:j("".concat(g,",").concat(M),s,a),fadeIn100:j(c,s,a),fadeIn200:j(c,l,a),fadeIn400:j(c,d,a),fadeIn500:j(c,u,a),fadeOut100:j(g,s,a),fadeOut200:j(g,l,a),fadeOut400:j(g,d,a),fadeOut500:j(g,u,a),rotate90deg:j(U,"0.1s",a),rotateN90deg:j(z,"0.1s",a)});!function(e){e.Arabic="Segoe UI Web (Arabic)",e.Cyrillic="Segoe UI Web (Cyrillic)",e.EastEuropean="Segoe UI Web (East European)",e.Greek="Segoe UI Web (Greek)",e.Hebrew="Segoe UI Web (Hebrew)",e.Thai="Leelawadee UI Web",e.Vietnamese="Segoe UI Web (Vietnamese)",e.WestEuropean="Segoe UI Web (West European)",e.Selawik="Selawik Web",e.Armenian="Segoe UI Web (Armenian)",e.Georgian="Segoe UI Web (Georgian)"}(K||(K={})),function(e){e.Arabic="'".concat(K.Arabic,"'"),e.ChineseSimplified="'Microsoft Yahei UI', Verdana, Simsun",e.ChineseTraditional="'Microsoft Jhenghei UI', Pmingliu",e.Cyrillic="'".concat(K.Cyrillic,"'"),e.EastEuropean="'".concat(K.EastEuropean,"'"),e.Greek="'".concat(K.Greek,"'"),e.Hebrew="'".concat(K.Hebrew,"'"),e.Hindi="'Nirmala UI'",e.Japanese="'Yu Gothic UI', 'Meiryo UI', Meiryo, 'MS Pgothic', Osaka",e.Korean="'Malgun Gothic', Gulim",e.Selawik="'".concat(K.Selawik,"'"),e.Thai="'Leelawadee UI Web', 'Kmer UI'",e.Vietnamese="'".concat(K.Vietnamese,"'"),e.WestEuropean="'".concat(K.WestEuropean,"'"),e.Armenian="'".concat(K.Armenian,"'"),e.Georgian="'".concat(K.Georgian,"'")}($||($={})),function(e){e.size10="10px",e.size12="12px",e.size14="14px",e.size16="16px",e.size18="18px",e.size20="20px",e.size24="24px",e.size28="28px",e.size32="32px",e.size42="42px",e.size68="68px",e.mini="10px",e.xSmall="10px",e.small="12px",e.smallPlus="12px",e.medium="14px",e.mediumPlus="16px",e.icon="16px",e.large="18px",e.xLarge="20px",e.xLargePlus="24px",e.xxLarge="28px",e.xxLargePlus="32px",e.superLarge="42px",e.mega="68px"}(Z||(Z={})),function(e){e.light=100,e.semilight=300,e.regular=400,e.semibold=600,e.bold=700}(J||(J={})),function(e){e.xSmall="10px",e.small="12px",e.medium="16px",e.large="20px"}(X||(X={}));var ee={position:"absolute",width:1,height:1,margin:-1,padding:0,border:0,overflow:"hidden",whiteSpace:"nowrap"},te=n(83702),ne=(0,n(92420).J9)((function(e,t){var n=te.nr.getInstance();return t?Object.keys(e).reduce((function(t,r){return t[r]=n.getClassName(e[r]),t}),{}):e}));function re(e,t,n){return ne(e,void 0!==n?n:t.disableGlobalClassNames)}var ie="@media screen and (-ms-high-contrast: active), screen and (forced-colors: active)",oe=639;function ae(e,t){var n="number"==typeof e?" and (min-width: ".concat(e,"px)"):"",r="number"==typeof t?" and (max-width: ".concat(t,"px)"):"";return"@media only screen".concat(n).concat(r)}function se(){return{forcedColorAdjust:"none",MsHighContrastAdjust:"none"}}var le,de=n(33594);function ue(e,t,n,r,i,o,a,s){return function(e,t){var n,r;void 0===t&&(t={});var i=t.borderRadius,o=t.inset,a=void 0===o?0:o,s=t.width,l=void 0===s?1:s,d=t.position,u=void 0===d?"relative":d,c=t.highContrastStyle,g=t.borderColor,h=void 0===g?e.palette.white:g,p=t.outlineColor,f=void 0===p?e.palette.neutralSecondary:p,v=t.isFocusedOnly,m=void 0===v||v,y=t.pointerEvents;return{outline:"transparent",position:u,selectors:(n={"::-moz-focus-inner":{border:"0"}},n[".".concat(de.Y2," &").concat(m?":focus":"",":after, :host(.").concat(de.Y2,") &").concat(m?":focus":"",":after")]={content:'""',position:"absolute",pointerEvents:y,left:a+1,top:a+1,bottom:a+1,right:a+1,border:"".concat(l,"px solid ").concat(h),outline:"".concat(l,"px solid ").concat(f),zIndex:le.FocusStyle,borderRadius:i,selectors:(r={},r[ie]=c,r)},n)}}(e,"number"!=typeof t&&t?t:{inset:t,position:n,highContrastStyle:r,borderColor:i,outlineColor:o,isFocusedOnly:a,borderRadius:s})}function ce(){return{selectors:{"&::-moz-focus-inner":{border:0},"&":{outline:"transparent"}}}}!function(e){e.Nav=1,e.ScrollablePane=1,e.FocusStyle=1,e.Coachmark=1e3,e.Layer=1e6,e.KeytipLayer=1000001}(le||(le={}));var ge,he=n(30206),pe=n(51055),fe=n(97061),ve=n(54167),me={themeDarker:"#004578",themeDark:"#005a9e",themeDarkAlt:"#106ebe",themePrimary:"#0078d4",themeSecondary:"#2b88d8",themeTertiary:"#71afe5",themeLight:"#c7e0f4",themeLighter:"#deecf9",themeLighterAlt:"#eff6fc",black:"#000000",blackTranslucent40:"rgba(0,0,0,.4)",neutralDark:"#201f1e",neutralPrimary:"#323130",neutralPrimaryAlt:"#3b3a39",neutralSecondary:"#605e5c",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#a19f9d",neutralTertiaryAlt:"#c8c6c4",neutralQuaternary:"#d2d0ce",neutralQuaternaryAlt:"#e1dfdd",neutralLight:"#edebe9",neutralLighter:"#f3f2f1",neutralLighterAlt:"#faf9f8",accent:"#0078d4",white:"#ffffff",whiteTranslucent40:"rgba(255,255,255,.4)",yellowDark:"#d29200",yellow:"#ffb900",yellowLight:"#fff100",orange:"#d83b01",orangeLight:"#ea4300",orangeLighter:"#ff8c00",redDark:"#a4262c",red:"#e81123",magentaDark:"#5c005c",magenta:"#b4009e",magentaLight:"#e3008c",purpleDark:"#32145a",purple:"#5c2d91",purpleLight:"#b4a0ff",blueDark:"#002050",blueMid:"#00188f",blue:"#0078d4",blueLight:"#00bcf2",tealDark:"#004b50",teal:"#008272",tealLight:"#00b294",greenDark:"#004b1c",green:"#107c10",greenLight:"#bad80a"};!function(e){e.depth0="0 0 0 0 transparent",e.depth4="0 1.6px 3.6px 0 rgba(0, 0, 0, 0.132), 0 0.3px 0.9px 0 rgba(0, 0, 0, 0.108)",e.depth8="0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132), 0 0.6px 1.8px 0 rgba(0, 0, 0, 0.108)",e.depth16="0 6.4px 14.4px 0 rgba(0, 0, 0, 0.132), 0 1.2px 3.6px 0 rgba(0, 0, 0, 0.108)",e.depth64="0 25.6px 57.6px 0 rgba(0, 0, 0, 0.22), 0 4.8px 14.4px 0 rgba(0, 0, 0, 0.18)"}(ge||(ge={}));var ye={elevation4:ge.depth4,elevation8:ge.depth8,elevation16:ge.depth16,elevation64:ge.depth64,roundedCorner2:"2px",roundedCorner4:"4px",roundedCorner6:"6px"},_e=n(1798),be="'Segoe UI', '".concat(K.WestEuropean,"'"),Ce={ar:$.Arabic,bg:$.Cyrillic,cs:$.EastEuropean,el:$.Greek,et:$.EastEuropean,he:$.Hebrew,hi:$.Hindi,hr:$.EastEuropean,hu:$.EastEuropean,ja:$.Japanese,kk:$.EastEuropean,ko:$.Korean,lt:$.EastEuropean,lv:$.EastEuropean,pl:$.EastEuropean,ru:$.Cyrillic,sk:$.EastEuropean,"sr-latn":$.EastEuropean,th:$.Thai,tr:$.EastEuropean,uk:$.Cyrillic,vi:$.Vietnamese,"zh-hans":$.ChineseSimplified,"zh-hant":$.ChineseTraditional,hy:$.Armenian,ka:$.Georgian};function Se(e,t,n){return{fontFamily:n,MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontSize:e,fontWeight:t}}var Te,Ie,we,Ee,xe,Ae=(Te=function(e){for(var t in Ce)if(Ce.hasOwnProperty(t)&&e&&0===t.indexOf(e))return Ce[t];return be}((0,n(94991).Z)()),Ie="".concat(Te,", ").concat("'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Helvetica Neue', sans-serif"),{tiny:Se(Z.mini,J.regular,Ie),xSmall:Se(Z.xSmall,J.regular,Ie),small:Se(Z.small,J.regular,Ie),smallPlus:Se(Z.smallPlus,J.regular,Ie),medium:Se(Z.medium,J.regular,Ie),mediumPlus:Se(Z.mediumPlus,J.regular,Ie),large:Se(Z.large,J.regular,Ie),xLarge:Se(Z.xLarge,J.semibold,Ie),xLargePlus:Se(Z.xLargePlus,J.semibold,Ie),xxLarge:Se(Z.xxLarge,J.semibold,Ie),xxLargePlus:Se(Z.xxLargePlus,J.semibold,Ie),superLarge:Se(Z.superLarge,J.semibold,Ie),mega:Se(Z.mega,J.semibold,Ie)});function De(e,t,n,r){e="'".concat(e,"'");var i=void 0!==r?"local('".concat(r,"'),"):"";(0,_e.n)({fontFamily:e,src:i+"url('".concat(t,".woff2') format('woff2'),")+"url('".concat(t,".woff') format('woff')"),fontWeight:n,fontStyle:"normal",fontDisplay:"swap"})}function ke(e,t,n,r,i){void 0===r&&(r="segoeui");var o="".concat(e,"/").concat(n,"/").concat(r);De(t,o+"-light",J.light,i&&i+" Light"),De(t,o+"-semilight",J.semilight,i&&i+" SemiLight"),De(t,o+"-regular",J.regular,i),De(t,o+"-semibold",J.semibold,i&&i+" SemiBold"),De(t,o+"-bold",J.bold,i&&i+" Bold")}!function(e){if(e){var t="".concat(e,"/fonts");ke(t,K.Thai,"leelawadeeui-thai","leelawadeeui"),ke(t,K.Arabic,"segoeui-arabic"),ke(t,K.Cyrillic,"segoeui-cyrillic"),ke(t,K.EastEuropean,"segoeui-easteuropean"),ke(t,K.Greek,"segoeui-greek"),ke(t,K.Hebrew,"segoeui-hebrew"),ke(t,K.Vietnamese,"segoeui-vietnamese"),ke(t,K.WestEuropean,"segoeui-westeuropean","segoeui","Segoe UI"),ke(t,$.Selawik,"selawik","selawik"),ke(t,K.Armenian,"segoeui-armenian"),ke(t,K.Georgian,"segoeui-georgian"),De("Leelawadee UI Web","".concat(t,"/leelawadeeui-thai/leelawadeeui-semilight"),J.light),De("Leelawadee UI Web","".concat(t,"/leelawadeeui-thai/leelawadeeui-bold"),J.semibold)}}((xe=null===(we=(0,pe.z)())||void 0===we?void 0:we.FabricConfig,null!==(Ee=null==xe?void 0:xe.fontBaseUrl)&&void 0!==Ee?Ee:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/assets"));var Fe=n(21608);function Pe(e,t,n,r,i){return void 0===i&&(i=!1),function(e,t){var n="";return!0===t&&(n=" /* @deprecated */"),e.listTextColor=e.listText+n,e.menuItemBackgroundChecked+=n,e.warningHighlight+=n,e.warningText=e.messageText+n,e.successText+=n,e}(Ne(e,t,(0,he.__assign)({primaryButtonBorder:"transparent",errorText:r?"#F1707B":"#a4262c",messageText:r?"#F3F2F1":"#323130",messageLink:r?"#6CB8F6":"#005A9E",messageLinkHovered:r?"#82C7FF":"#004578",infoIcon:r?"#C8C6C4":"#605e5c",errorIcon:r?"#F1707B":"#A80000",blockingIcon:r?"#442726":"#FDE7E9",warningIcon:r?"#C8C6C4":"#797775",severeWarningIcon:r?"#FCE100":"#D83B01",successIcon:r?"#92C353":"#107C10",infoBackground:r?"#323130":"#f3f2f1",errorBackground:r?"#442726":"#FDE7E9",blockingBackground:r?"#442726":"#FDE7E9",warningBackground:r?"#433519":"#FFF4CE",severeWarningBackground:r?"#4F2A0F":"#FED9CC",successBackground:r?"#393D1B":"#DFF6DD",warningHighlight:r?"#fff100":"#ffb900",successText:r?"#92c353":"#107C10"},n),r),i)}function Ne(e,t,n,r,i){void 0===i&&(i=!1);var o={},a=e||{},s=a.white,l=a.black,d=a.themePrimary,u=a.themeDark,c=a.themeDarker,g=a.themeDarkAlt,h=a.themeLighter,p=a.neutralLight,f=a.neutralLighter,v=a.neutralDark,m=a.neutralQuaternary,y=a.neutralQuaternaryAlt,_=a.neutralPrimary,b=a.neutralSecondary,C=a.neutralSecondaryAlt,S=a.neutralTertiary,T=a.neutralTertiaryAlt,I=a.neutralLighterAlt,w=a.accent;return s&&(o.bodyBackground=s,o.bodyFrameBackground=s,o.accentButtonText=s,o.buttonBackground=s,o.primaryButtonText=s,o.primaryButtonTextHovered=s,o.primaryButtonTextPressed=s,o.inputBackground=s,o.inputForegroundChecked=s,o.listBackground=s,o.menuBackground=s,o.cardStandoutBackground=s),l&&(o.bodyTextChecked=l,o.buttonTextCheckedHovered=l),d&&(o.link=d,o.primaryButtonBackground=d,o.inputBackgroundChecked=d,o.inputIcon=d,o.inputFocusBorderAlt=d,o.menuIcon=d,o.menuHeader=d,o.accentButtonBackground=d),u&&(o.primaryButtonBackgroundPressed=u,o.inputBackgroundCheckedHovered=u,o.inputIconHovered=u),c&&(o.linkHovered=c),g&&(o.primaryButtonBackgroundHovered=g),h&&(o.inputPlaceholderBackgroundChecked=h),p&&(o.bodyBackgroundChecked=p,o.bodyFrameDivider=p,o.bodyDivider=p,o.variantBorder=p,o.buttonBackgroundCheckedHovered=p,o.buttonBackgroundPressed=p,o.listItemBackgroundChecked=p,o.listHeaderBackgroundPressed=p,o.menuItemBackgroundPressed=p,o.menuItemBackgroundChecked=p),f&&(o.bodyBackgroundHovered=f,o.buttonBackgroundHovered=f,o.buttonBackgroundDisabled=f,o.buttonBorderDisabled=f,o.primaryButtonBackgroundDisabled=f,o.disabledBackground=f,o.listItemBackgroundHovered=f,o.listHeaderBackgroundHovered=f,o.menuItemBackgroundHovered=f),m&&(o.primaryButtonTextDisabled=m,o.disabledSubtext=m),y&&(o.listItemBackgroundCheckedHovered=y),S&&(o.disabledBodyText=S,o.variantBorderHovered=(null==n?void 0:n.variantBorderHovered)||S,o.buttonTextDisabled=S,o.inputIconDisabled=S,o.disabledText=S),_&&(o.bodyText=_,o.actionLink=_,o.buttonText=_,o.inputBorderHovered=_,o.inputText=_,o.listText=_,o.menuItemText=_),I&&(o.bodyStandoutBackground=I,o.defaultStateBackground=I),v&&(o.actionLinkHovered=v,o.buttonTextHovered=v,o.buttonTextChecked=v,o.buttonTextPressed=v,o.inputTextHovered=v,o.menuItemTextHovered=v),b&&(o.bodySubtext=b,o.focusBorder=b,o.inputBorder=b,o.smallInputBorder=b,o.inputPlaceholderText=b),C&&(o.buttonBorder=C),T&&(o.disabledBodySubtext=T,o.disabledBorder=T,o.buttonBackgroundChecked=T,o.menuDivider=T),w&&(o.accentButtonBackground=w),(null==t?void 0:t.elevation4)&&(o.cardShadow=t.elevation4),!r&&(null==t?void 0:t.elevation8)?o.cardShadowHovered=t.elevation8:o.variantBorderHovered&&(o.cardShadowHovered="0 0 1px "+o.variantBorderHovered),(0,he.__assign)((0,he.__assign)({},o),n)}var Be={s2:"4px",s1:"8px",m:"16px",l1:"20px",l2:"32px"};function Oe(e,t){void 0===e&&(e={}),void 0===t&&(t=!1);var n=!!e.isInverted;return function(e,t){var n,r,i;void 0===t&&(t={});var o=(0,Fe.h)({},e,t,{semanticColors:Ne(t.palette,t.effects,t.semanticColors,void 0===t.isInverted?e.isInverted:t.isInverted)});if((null===(n=t.palette)||void 0===n?void 0:n.themePrimary)&&!(null===(r=t.palette)||void 0===r?void 0:r.accent)&&(o.palette.accent=t.palette.themePrimary),t.defaultFontStyle)for(var a=0,s=Object.keys(o.fonts);a<s.length;a++){var l=s[a];o.fonts[l]=(0,Fe.h)(o.fonts[l],t.defaultFontStyle,null===(i=null==t?void 0:t.fonts)||void 0===i?void 0:i[l])}return o}({palette:me,effects:ye,fonts:Ae,spacing:Be,isInverted:n,disableGlobalClassNames:!1,semanticColors:Pe(me,ye,void 0,n,t),rtl:void 0},e)}var Re=Oe({}),Le=[],Me="theme";function qe(){var e,t,n,r=(0,pe.z)();(null===(t=null==r?void 0:r.FabricConfig)||void 0===t?void 0:t.legacyTheme)?function(e,t){var n;void 0===t&&(t=!1),Re=Oe(e,t),(0,ve.EQ)((0,he.__assign)((0,he.__assign)((0,he.__assign)((0,he.__assign)({},Re.palette),Re.semanticColors),Re.effects),function(e){for(var t={},n=0,r=Object.keys(e.fonts);n<r.length;n++)for(var i=r[n],o=e.fonts[i],a=0,s=Object.keys(o);a<s.length;a++){var l=s[a],d=i+l.charAt(0).toUpperCase()+l.slice(1),u=o[l];"fontSize"===l&&"number"==typeof u&&(u+="px"),t[d]=u}return t}(Re))),fe.X.applySettings(((n={})[Me]=Re,n)),Le.forEach((function(e){try{e(Re)}catch(e){}}))}(r.FabricConfig.legacyTheme):fe.X.getSettings([Me]).theme||((null===(n=null==r?void 0:r.FabricConfig)||void 0===n?void 0:n.theme)&&(Re=Oe(r.FabricConfig.theme)),fe.X.applySettings(((e={})[Me]=Re,e)))}function We(e){return void 0===e&&(e=!1),!0===e&&(Re=Oe({},e)),Re}function Ue(e){console&&console.warn&&console.warn(e)}qe();var ze=n(33732).h.getValue("icons",{__options:{disableWarnings:!1,warnOnMissingIcons:!0},__remapped:{}}),je=te.nr.getInstance();je&&je.onReset&&je.onReset((function(){for(var e in ze)ze.hasOwnProperty(e)&&ze[e].subset&&(ze[e].subset.className=void 0)}));var He=function(e){return e.toLowerCase()};function Ve(e,t){var n=(0,he.__assign)((0,he.__assign)({},e),{isRegistered:!1,className:void 0}),r=e.icons;for(var i in t=t?(0,he.__assign)((0,he.__assign)({},ze.__options),t):ze.__options,r)if(r.hasOwnProperty(i)){var o=r[i],a=He(i);ze[a]?$e(i):ze[a]={code:o,subset:n}}}function Ge(e){var t=void 0,n=ze.__options;if(e=e?He(e):"",e=ze.__remapped[e]||e)if(t=ze[e]){var i=t.subset;i&&i.fontFace&&(i.isRegistered||((0,_e.n)(i.fontFace),i.isRegistered=!0),i.className||(i.className=(0,r.Z)(i.style,{fontFamily:i.fontFace.fontFamily,fontWeight:i.fontFace.fontWeight||"normal",fontStyle:i.fontFace.fontStyle||"normal"})))}else!n.disableWarnings&&n.warnOnMissingIcons&&Ue('The icon "'.concat(e,'" was used but not registered. See https://github.com/microsoft/fluentui/wiki/Using-icons for more information.'));return t}var Qe=[],Ke=void 0;function $e(e){ze.__options.disableWarnings||(Qe.push(e),void 0===Ke&&(Ke=setTimeout((function(){Ue("Some icons were re-registered. Applications should only call registerIcons for any given icon once. Redefining what an icon is may have unintended consequences. Duplicates include: \n"+Qe.slice(0,10).join(", ")+(Qe.length>10?" (+ ".concat(Qe.length-10," more)"):"")),Ke=void 0,Qe=[]}),2e3)))}var Ze=n(80072),Je=n(17596),Xe=n(68678);(0,n(7829).v)("@fluentui/style-utilities","8.12.2"),qe()},87751:(e,t,n)=>{"use strict";n.d(t,{a:()=>A});var r,i={themeDarker:"#004578",themeDark:"#005a9e",themeDarkAlt:"#106ebe",themePrimary:"#0078d4",themeSecondary:"#2b88d8",themeTertiary:"#71afe5",themeLight:"#c7e0f4",themeLighter:"#deecf9",themeLighterAlt:"#eff6fc",black:"#000000",blackTranslucent40:"rgba(0,0,0,.4)",neutralDark:"#201f1e",neutralPrimary:"#323130",neutralPrimaryAlt:"#3b3a39",neutralSecondary:"#605e5c",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#a19f9d",neutralTertiaryAlt:"#c8c6c4",neutralQuaternary:"#d2d0ce",neutralQuaternaryAlt:"#e1dfdd",neutralLight:"#edebe9",neutralLighter:"#f3f2f1",neutralLighterAlt:"#faf9f8",accent:"#0078d4",white:"#ffffff",whiteTranslucent40:"rgba(255,255,255,.4)",yellowDark:"#d29200",yellow:"#ffb900",yellowLight:"#fff100",orange:"#d83b01",orangeLight:"#ea4300",orangeLighter:"#ff8c00",redDark:"#a4262c",red:"#e81123",magentaDark:"#5c005c",magenta:"#b4009e",magentaLight:"#e3008c",purpleDark:"#32145a",purple:"#5c2d91",purpleLight:"#b4a0ff",blueDark:"#002050",blueMid:"#00188f",blue:"#0078d4",blueLight:"#00bcf2",tealDark:"#004b50",teal:"#008272",tealLight:"#00b294",greenDark:"#004b1c",green:"#107c10",greenLight:"#bad80a"};!function(e){e.depth0="0 0 0 0 transparent",e.depth4="0 1.6px 3.6px 0 rgba(0, 0, 0, 0.132), 0 0.3px 0.9px 0 rgba(0, 0, 0, 0.108)",e.depth8="0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132), 0 0.6px 1.8px 0 rgba(0, 0, 0, 0.108)",e.depth16="0 6.4px 14.4px 0 rgba(0, 0, 0, 0.132), 0 1.2px 3.6px 0 rgba(0, 0, 0, 0.108)",e.depth64="0 25.6px 57.6px 0 rgba(0, 0, 0, 0.22), 0 4.8px 14.4px 0 rgba(0, 0, 0, 0.18)"}(r||(r={}));var o,a,s,l,d,u={elevation4:r.depth4,elevation8:r.depth8,elevation16:r.depth16,elevation64:r.depth64,roundedCorner2:"2px",roundedCorner4:"4px",roundedCorner6:"6px"},c=n(1798);!function(e){e.Arabic="Segoe UI Web (Arabic)",e.Cyrillic="Segoe UI Web (Cyrillic)",e.EastEuropean="Segoe UI Web (East European)",e.Greek="Segoe UI Web (Greek)",e.Hebrew="Segoe UI Web (Hebrew)",e.Thai="Leelawadee UI Web",e.Vietnamese="Segoe UI Web (Vietnamese)",e.WestEuropean="Segoe UI Web (West European)",e.Selawik="Selawik Web",e.Armenian="Segoe UI Web (Armenian)",e.Georgian="Segoe UI Web (Georgian)"}(o||(o={})),function(e){e.Arabic="'".concat(o.Arabic,"'"),e.ChineseSimplified="'Microsoft Yahei UI', Verdana, Simsun",e.ChineseTraditional="'Microsoft Jhenghei UI', Pmingliu",e.Cyrillic="'".concat(o.Cyrillic,"'"),e.EastEuropean="'".concat(o.EastEuropean,"'"),e.Greek="'".concat(o.Greek,"'"),e.Hebrew="'".concat(o.Hebrew,"'"),e.Hindi="'Nirmala UI'",e.Japanese="'Yu Gothic UI', 'Meiryo UI', Meiryo, 'MS Pgothic', Osaka",e.Korean="'Malgun Gothic', Gulim",e.Selawik="'".concat(o.Selawik,"'"),e.Thai="'Leelawadee UI Web', 'Kmer UI'",e.Vietnamese="'".concat(o.Vietnamese,"'"),e.WestEuropean="'".concat(o.WestEuropean,"'"),e.Armenian="'".concat(o.Armenian,"'"),e.Georgian="'".concat(o.Georgian,"'")}(a||(a={})),function(e){e.size10="10px",e.size12="12px",e.size14="14px",e.size16="16px",e.size18="18px",e.size20="20px",e.size24="24px",e.size28="28px",e.size32="32px",e.size42="42px",e.size68="68px",e.mini="10px",e.xSmall="10px",e.small="12px",e.smallPlus="12px",e.medium="14px",e.mediumPlus="16px",e.icon="16px",e.large="18px",e.xLarge="20px",e.xLargePlus="24px",e.xxLarge="28px",e.xxLargePlus="32px",e.superLarge="42px",e.mega="68px"}(s||(s={})),function(e){e.light=100,e.semilight=300,e.regular=400,e.semibold=600,e.bold=700}(l||(l={})),function(e){e.xSmall="10px",e.small="12px",e.medium="16px",e.large="20px"}(d||(d={}));var g="'Segoe UI', '".concat(o.WestEuropean,"'"),h={ar:a.Arabic,bg:a.Cyrillic,cs:a.EastEuropean,el:a.Greek,et:a.EastEuropean,he:a.Hebrew,hi:a.Hindi,hr:a.EastEuropean,hu:a.EastEuropean,ja:a.Japanese,kk:a.EastEuropean,ko:a.Korean,lt:a.EastEuropean,lv:a.EastEuropean,pl:a.EastEuropean,ru:a.Cyrillic,sk:a.EastEuropean,"sr-latn":a.EastEuropean,th:a.Thai,tr:a.EastEuropean,uk:a.Cyrillic,vi:a.Vietnamese,"zh-hans":a.ChineseSimplified,"zh-hant":a.ChineseTraditional,hy:a.Armenian,ka:a.Georgian};function p(e,t,n){return{fontFamily:n,MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontSize:e,fontWeight:t}}var f,v,m,y,_,b=n(94991),C=n(51055),S=(f=function(e){for(var t in h)if(h.hasOwnProperty(t)&&e&&0===t.indexOf(e))return h[t];return g}((0,b.Z)()),v="".concat(f,", ").concat("'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Helvetica Neue', sans-serif"),{tiny:p(s.mini,l.regular,v),xSmall:p(s.xSmall,l.regular,v),small:p(s.small,l.regular,v),smallPlus:p(s.smallPlus,l.regular,v),medium:p(s.medium,l.regular,v),mediumPlus:p(s.mediumPlus,l.regular,v),large:p(s.large,l.regular,v),xLarge:p(s.xLarge,l.semibold,v),xLargePlus:p(s.xLargePlus,l.semibold,v),xxLarge:p(s.xxLarge,l.semibold,v),xxLargePlus:p(s.xxLargePlus,l.semibold,v),superLarge:p(s.superLarge,l.semibold,v),mega:p(s.mega,l.semibold,v)});function T(e,t,n,r){e="'".concat(e,"'");var i=void 0!==r?"local('".concat(r,"'),"):"";(0,c.n)({fontFamily:e,src:i+"url('".concat(t,".woff2') format('woff2'),")+"url('".concat(t,".woff') format('woff')"),fontWeight:n,fontStyle:"normal",fontDisplay:"swap"})}function I(e,t,n,r,i){void 0===r&&(r="segoeui");var o="".concat(e,"/").concat(n,"/").concat(r);T(t,o+"-light",l.light,i&&i+" Light"),T(t,o+"-semilight",l.semilight,i&&i+" SemiLight"),T(t,o+"-regular",l.regular,i),T(t,o+"-semibold",l.semibold,i&&i+" SemiBold"),T(t,o+"-bold",l.bold,i&&i+" Bold")}!function(e){if(e){var t="".concat(e,"/fonts");I(t,o.Thai,"leelawadeeui-thai","leelawadeeui"),I(t,o.Arabic,"segoeui-arabic"),I(t,o.Cyrillic,"segoeui-cyrillic"),I(t,o.EastEuropean,"segoeui-easteuropean"),I(t,o.Greek,"segoeui-greek"),I(t,o.Hebrew,"segoeui-hebrew"),I(t,o.Vietnamese,"segoeui-vietnamese"),I(t,o.WestEuropean,"segoeui-westeuropean","segoeui","Segoe UI"),I(t,a.Selawik,"selawik","selawik"),I(t,o.Armenian,"segoeui-armenian"),I(t,o.Georgian,"segoeui-georgian"),T("Leelawadee UI Web","".concat(t,"/leelawadeeui-thai/leelawadeeui-semilight"),l.light),T("Leelawadee UI Web","".concat(t,"/leelawadeeui-thai/leelawadeeui-bold"),l.semibold)}}((_=null===(m=(0,C.z)())||void 0===m?void 0:m.FabricConfig,null!==(y=null==_?void 0:_.fontBaseUrl)&&void 0!==y?y:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/assets"));var w=n(11363),E={s2:"4px",s1:"8px",m:"16px",l1:"20px",l2:"32px"},x=n(10814);function A(e,t){void 0===e&&(e={}),void 0===t&&(t=!1);var n=!!e.isInverted,r={palette:i,effects:u,fonts:S,spacing:E,isInverted:n,disableGlobalClassNames:!1,semanticColors:(0,x.b)(i,u,void 0,n,t),rtl:void 0};return(0,w.z)(r,e)}},11363:(e,t,n)=>{"use strict";n.d(t,{z:()=>o});var r=n(21608),i=n(10814);function o(e,t){var n,o,a;void 0===t&&(t={});var s=(0,r.h)({},e,t,{semanticColors:(0,i.B)(t.palette,t.effects,t.semanticColors,void 0===t.isInverted?e.isInverted:t.isInverted)});if((null===(n=t.palette)||void 0===n?void 0:n.themePrimary)&&!(null===(o=t.palette)||void 0===o?void 0:o.accent)&&(s.palette.accent=t.palette.themePrimary),t.defaultFontStyle)for(var l=0,d=Object.keys(s.fonts);l<d.length;l++){var u=d[l];s.fonts[u]=(0,r.h)(s.fonts[u],t.defaultFontStyle,null===(a=null==t?void 0:t.fonts)||void 0===a?void 0:a[u])}return s}},10814:(e,t,n)=>{"use strict";n.d(t,{B:()=>o,b:()=>i});var r=n(30206);function i(e,t,n,i,a){return void 0===a&&(a=!1),function(e,t){var n="";return!0===t&&(n=" /* @deprecated */"),e.listTextColor=e.listText+n,e.menuItemBackgroundChecked+=n,e.warningHighlight+=n,e.warningText=e.messageText+n,e.successText+=n,e}(o(e,t,(0,r.__assign)({primaryButtonBorder:"transparent",errorText:i?"#F1707B":"#a4262c",messageText:i?"#F3F2F1":"#323130",messageLink:i?"#6CB8F6":"#005A9E",messageLinkHovered:i?"#82C7FF":"#004578",infoIcon:i?"#C8C6C4":"#605e5c",errorIcon:i?"#F1707B":"#A80000",blockingIcon:i?"#442726":"#FDE7E9",warningIcon:i?"#C8C6C4":"#797775",severeWarningIcon:i?"#FCE100":"#D83B01",successIcon:i?"#92C353":"#107C10",infoBackground:i?"#323130":"#f3f2f1",errorBackground:i?"#442726":"#FDE7E9",blockingBackground:i?"#442726":"#FDE7E9",warningBackground:i?"#433519":"#FFF4CE",severeWarningBackground:i?"#4F2A0F":"#FED9CC",successBackground:i?"#393D1B":"#DFF6DD",warningHighlight:i?"#fff100":"#ffb900",successText:i?"#92c353":"#107C10"},n),i),a)}function o(e,t,n,i,o){void 0===o&&(o=!1);var a={},s=e||{},l=s.white,d=s.black,u=s.themePrimary,c=s.themeDark,g=s.themeDarker,h=s.themeDarkAlt,p=s.themeLighter,f=s.neutralLight,v=s.neutralLighter,m=s.neutralDark,y=s.neutralQuaternary,_=s.neutralQuaternaryAlt,b=s.neutralPrimary,C=s.neutralSecondary,S=s.neutralSecondaryAlt,T=s.neutralTertiary,I=s.neutralTertiaryAlt,w=s.neutralLighterAlt,E=s.accent;return l&&(a.bodyBackground=l,a.bodyFrameBackground=l,a.accentButtonText=l,a.buttonBackground=l,a.primaryButtonText=l,a.primaryButtonTextHovered=l,a.primaryButtonTextPressed=l,a.inputBackground=l,a.inputForegroundChecked=l,a.listBackground=l,a.menuBackground=l,a.cardStandoutBackground=l),d&&(a.bodyTextChecked=d,a.buttonTextCheckedHovered=d),u&&(a.link=u,a.primaryButtonBackground=u,a.inputBackgroundChecked=u,a.inputIcon=u,a.inputFocusBorderAlt=u,a.menuIcon=u,a.menuHeader=u,a.accentButtonBackground=u),c&&(a.primaryButtonBackgroundPressed=c,a.inputBackgroundCheckedHovered=c,a.inputIconHovered=c),g&&(a.linkHovered=g),h&&(a.primaryButtonBackgroundHovered=h),p&&(a.inputPlaceholderBackgroundChecked=p),f&&(a.bodyBackgroundChecked=f,a.bodyFrameDivider=f,a.bodyDivider=f,a.variantBorder=f,a.buttonBackgroundCheckedHovered=f,a.buttonBackgroundPressed=f,a.listItemBackgroundChecked=f,a.listHeaderBackgroundPressed=f,a.menuItemBackgroundPressed=f,a.menuItemBackgroundChecked=f),v&&(a.bodyBackgroundHovered=v,a.buttonBackgroundHovered=v,a.buttonBackgroundDisabled=v,a.buttonBorderDisabled=v,a.primaryButtonBackgroundDisabled=v,a.disabledBackground=v,a.listItemBackgroundHovered=v,a.listHeaderBackgroundHovered=v,a.menuItemBackgroundHovered=v),y&&(a.primaryButtonTextDisabled=y,a.disabledSubtext=y),_&&(a.listItemBackgroundCheckedHovered=_),T&&(a.disabledBodyText=T,a.variantBorderHovered=(null==n?void 0:n.variantBorderHovered)||T,a.buttonTextDisabled=T,a.inputIconDisabled=T,a.disabledText=T),b&&(a.bodyText=b,a.actionLink=b,a.buttonText=b,a.inputBorderHovered=b,a.inputText=b,a.listText=b,a.menuItemText=b),w&&(a.bodyStandoutBackground=w,a.defaultStateBackground=w),m&&(a.actionLinkHovered=m,a.buttonTextHovered=m,a.buttonTextChecked=m,a.buttonTextPressed=m,a.inputTextHovered=m,a.menuItemTextHovered=m),C&&(a.bodySubtext=C,a.focusBorder=C,a.inputBorder=C,a.smallInputBorder=C,a.inputPlaceholderText=C),S&&(a.buttonBorder=S),I&&(a.disabledBodySubtext=I,a.disabledBorder=I,a.buttonBackgroundChecked=I,a.menuDivider=I),E&&(a.accentButtonBackground=E),(null==t?void 0:t.elevation4)&&(a.cardShadow=t.elevation4),!i&&(null==t?void 0:t.elevation8)?a.cardShadowHovered=t.elevation8:a.variantBorderHovered&&(a.cardShadowHovered="0 0 1px "+a.variantBorderHovered),(0,r.__assign)((0,r.__assign)({},a),n)}},93656:(e,t,n)=>{"use strict";n.d(t,{h:()=>l,m:()=>d});var r=n(71737),i=n(51815),o=n(36934);const a=i.TQ.reduce(((e,t)=>{const n=t.slice(0,1).toUpperCase()+t.slice(1),i={[`colorPalette${n}Background1`]:r.yd[t].shade40,[`colorPalette${n}Background2`]:r.yd[t].shade30,[`colorPalette${n}Background3`]:r.yd[t].primary,[`colorPalette${n}Foreground1`]:r.yd[t].tint30,[`colorPalette${n}Foreground2`]:r.yd[t].tint40,[`colorPalette${n}Foreground3`]:r.yd[t].tint20,[`colorPalette${n}BorderActive`]:r.yd[t].tint30,[`colorPalette${n}Border1`]:r.yd[t].primary,[`colorPalette${n}Border2`]:r.yd[t].tint20};return Object.assign(e,i)}),{});a.colorPaletteRedForeground3=r.yd.red.tint30,a.colorPaletteRedBorder2=r.yd.red.tint30,a.colorPaletteGreenForeground3=r.yd.green.tint40,a.colorPaletteGreenBorder2=r.yd.green.tint40,a.colorPaletteDarkOrangeForeground3=r.yd.darkOrange.tint30,a.colorPaletteDarkOrangeBorder2=r.yd.darkOrange.tint30,a.colorPaletteRedForegroundInverted=r.yd.red.primary,a.colorPaletteGreenForegroundInverted=r.yd.green.primary,a.colorPaletteYellowForegroundInverted=r.yd.yellow.shade30;const s=i.dt.reduce(((e,t)=>{const n=t.slice(0,1).toUpperCase()+t.slice(1),i={[`colorPalette${n}Background2`]:r.cc[t].shade30,[`colorPalette${n}Foreground2`]:r.cc[t].tint40,[`colorPalette${n}BorderActive`]:r.cc[t].tint30};return Object.assign(e,i)}),{});s.colorPaletteDarkRedBackground2=r.cc.darkRed.shade20,s.colorPalettePlumBackground2=r.cc.plum.shade20;const l={...a,...s},d=Object.entries(o.s).reduce(((e,[t,n])=>{const i=t.slice(0,1).toUpperCase()+t.slice(1),o={[`colorStatus${i}Background1`]:r.Ul[n].shade40,[`colorStatus${i}Background2`]:r.Ul[n].shade30,[`colorStatus${i}Background3`]:r.Ul[n].primary,[`colorStatus${i}Foreground1`]:r.Ul[n].tint30,[`colorStatus${i}Foreground2`]:r.Ul[n].tint40,[`colorStatus${i}Foreground3`]:r.Ul[n].tint20,[`colorStatus${i}BorderActive`]:r.Ul[n].tint30,[`colorStatus${i}ForegroundInverted`]:r.Ul[n].shade10,[`colorStatus${i}Border1`]:r.Ul[n].primary,[`colorStatus${i}Border2`]:r.Ul[n].tint20};return Object.assign(e,o)}),{});d.colorStatusDangerBackground3Hover=r.Ul[o.s.danger].shade10,d.colorStatusDangerBackground3Pressed=r.Ul[o.s.danger].shade20,d.colorStatusDangerForeground3=r.Ul[o.s.danger].tint40,d.colorStatusDangerBorder2=r.Ul[o.s.danger].tint30,d.colorStatusSuccessForeground3=r.Ul[o.s.success].tint40,d.colorStatusSuccessBorder2=r.Ul[o.s.success].tint40,d.colorStatusWarningForegroundInverted=r.Ul[o.s.warning].shade20},61883:(e,t,n)=>{"use strict";n.d(t,{V:()=>r});const r={borderRadiusNone:"0",borderRadiusSmall:"2px",borderRadiusMedium:"4px",borderRadiusLarge:"6px",borderRadiusXLarge:"8px",borderRadiusCircular:"10000px"}},71122:(e,t,n)=>{"use strict";n.d(t,{U1:()=>i,oZ:()=>r});const r={10:"#061724",20:"#082338",30:"#0a2e4a",40:"#0c3b5e",50:"#0e4775",60:"#0f548c",70:"#115ea3",80:"#0f6cbd",90:"#2886de",100:"#479ef5",110:"#62abf5",120:"#77b7f7",130:"#96c6fa",140:"#b4d6fa",150:"#cfe4fa",160:"#ebf3fc"},i={10:"#2b2b40",20:"#2f2f4a",30:"#333357",40:"#383966",50:"#3d3e78",60:"#444791",70:"#4f52b2",80:"#5b5fc7",90:"#7579eb",100:"#7f85f5",110:"#9299f7",120:"#aab1fa",130:"#b6bcfa",140:"#c5cbfa",150:"#dce0fa",160:"#e8ebfa"}},71737:(e,t,n)=>{"use strict";n.d(t,{Ul:()=>a,cc:()=>o,yd:()=>i});var r=n(75435);const i={red:r.wv,green:r.wL,darkOrange:r.je,yellow:r.D9,berry:r.pT,lightGreen:r.EM,marigold:r.KK},o={darkRed:r.ik,cranberry:r.jF,pumpkin:r.Vv,peach:r.WB,gold:r.bK,brass:r.YA,brown:r.Xk,forest:r.CE,seafoam:r.$T,darkGreen:r.AV,lightTeal:r.JW,teal:r.$S,steel:r.s$,blue:r.z1,royalBlue:r.Os,cornflower:r.um,navy:r.Z,lavender:r.Us,purple:r.Zp,grape:r.QH,lilac:r.qn,pink:r.Vu,magenta:r.GC,plum:r.t1,beige:r.Zz,mink:r.QJ,platinum:r.X1,anchor:r.Y3},a={cranberry:r.jF,green:r.wL,orange:r.T_}},75435:(e,t,n)=>{"use strict";n.d(t,{$S:()=>L,$T:()=>P,AV:()=>O,CE:()=>F,D9:()=>x,EM:()=>N,Fn:()=>f,GC:()=>$,JW:()=>R,KK:()=>E,ON:()=>d,Oh:()=>r,Os:()=>W,Q1:()=>o,QH:()=>V,QJ:()=>X,Ql:()=>u,Si:()=>g,T_:()=>I,Us:()=>j,Vu:()=>K,Vv:()=>T,WB:()=>w,X1:()=>Y,Xk:()=>k,Xv:()=>l,Y3:()=>ee,YA:()=>D,Z:()=>z,Z1:()=>s,Zp:()=>H,Zz:()=>J,aJ:()=>c,bK:()=>A,c8:()=>i,fo:()=>v,ik:()=>_,jF:()=>b,je:()=>S,m4:()=>h,mY:()=>p,p1:()=>m,p6:()=>y,pT:()=>G,qn:()=>Q,s$:()=>M,t1:()=>Z,ti:()=>a,um:()=>U,wL:()=>B,wv:()=>C,z1:()=>q});const r={2:"#050505",4:"#0a0a0a",6:"#0f0f0f",8:"#141414",10:"#1a1a1a",12:"#1f1f1f",14:"#242424",16:"#292929",18:"#2e2e2e",20:"#333333",22:"#383838",24:"#3d3d3d",26:"#424242",28:"#474747",30:"#4d4d4d",32:"#525252",34:"#575757",36:"#5c5c5c",38:"#616161",40:"#666666",42:"#6b6b6b",44:"#707070",46:"#757575",48:"#7a7a7a",50:"#808080",52:"#858585",54:"#8a8a8a",56:"#8f8f8f",58:"#949494",60:"#999999",62:"#9e9e9e",64:"#a3a3a3",66:"#a8a8a8",68:"#adadad",70:"#b3b3b3",72:"#b8b8b8",74:"#bdbdbd",76:"#c2c2c2",78:"#c7c7c7",80:"#cccccc",82:"#d1d1d1",84:"#d6d6d6",86:"#dbdbdb",88:"#e0e0e0",90:"#e6e6e6",92:"#ebebeb",94:"#f0f0f0",96:"#f5f5f5",98:"#fafafa"},i={5:"rgba(255, 255, 255, 0.05)",10:"rgba(255, 255, 255, 0.1)",20:"rgba(255, 255, 255, 0.2)",30:"rgba(255, 255, 255, 0.3)",40:"rgba(255, 255, 255, 0.4)",50:"rgba(255, 255, 255, 0.5)",60:"rgba(255, 255, 255, 0.6)",70:"rgba(255, 255, 255, 0.7)",80:"rgba(255, 255, 255, 0.8)",90:"rgba(255, 255, 255, 0.9)"},o={5:"rgba(0, 0, 0, 0.05)",10:"rgba(0, 0, 0, 0.1)",20:"rgba(0, 0, 0, 0.2)",30:"rgba(0, 0, 0, 0.3)",40:"rgba(0, 0, 0, 0.4)",50:"rgba(0, 0, 0, 0.5)",60:"rgba(0, 0, 0, 0.6)",70:"rgba(0, 0, 0, 0.7)",80:"rgba(0, 0, 0, 0.8)",90:"rgba(0, 0, 0, 0.9)"},a={5:"rgba(26, 26, 26, 0.05)",10:"rgba(26, 26, 26, 0.1)",20:"rgba(26, 26, 26, 0.2)",30:"rgba(26, 26, 26, 0.3)",40:"rgba(26, 26, 26, 0.4)",50:"rgba(26, 26, 26, 0.5)",60:"rgba(26, 26, 26, 0.6)",70:"rgba(26, 26, 26, 0.7)",80:"rgba(26, 26, 26, 0.8)",90:"rgba(26, 26, 26, 0.9)"},s={5:"rgba(31, 31, 31, 0.05)",10:"rgba(31, 31, 31, 0.1)",20:"rgba(31, 31, 31, 0.2)",30:"rgba(31, 31, 31, 0.3)",40:"rgba(31, 31, 31, 0.4)",50:"rgba(31, 31, 31, 0.5)",60:"rgba(31, 31, 31, 0.6)",70:"rgba(31, 31, 31, 0.7)",80:"rgba(31, 31, 31, 0.8)",90:"rgba(31, 31, 31, 0.9)"},l={5:"rgba(36, 36, 36, 0.05)",10:"rgba(36, 36, 36, 0.1)",20:"rgba(36, 36, 36, 0.2)",30:"rgba(36, 36, 36, 0.3)",40:"rgba(36, 36, 36, 0.4)",50:"rgba(36, 36, 36, 0.5)",60:"rgba(36, 36, 36, 0.6)",70:"rgba(36, 36, 36, 0.7)",80:"rgba(36, 36, 36, 0.8)",90:"rgba(36, 36, 36, 0.9)"},d="#ffffff",u="#000000",c="#ffff00",g="#1aebff",h="#3ff23f",p="#000000",f="#ffffff",v="#000000",m="#000000",y="#ffffff",_={shade50:"#130204",shade40:"#230308",shade30:"#420610",shade20:"#590815",shade10:"#690a19",primary:"#750b1c",tint10:"#861b2c",tint20:"#962f3f",tint30:"#ac4f5e",tint40:"#d69ca5",tint50:"#e9c7cd",tint60:"#f9f0f2"},b={shade50:"#200205",shade40:"#3b0509",shade30:"#6e0811",shade20:"#960b18",shade10:"#b10e1c",primary:"#c50f1f",tint10:"#cc2635",tint20:"#d33f4c",tint30:"#dc626d",tint40:"#eeacb2",tint50:"#f6d1d5",tint60:"#fdf3f4"},C={shade50:"#210809",shade40:"#3f1011",shade30:"#751d1f",shade20:"#9f282b",shade10:"#bc2f32",primary:"#d13438",tint10:"#d7494c",tint20:"#dc5e62",tint30:"#e37d80",tint40:"#f1bbbc",tint50:"#f8dadb",tint60:"#fdf6f6"},S={shade50:"#230900",shade40:"#411200",shade30:"#7a2101",shade20:"#a62d01",shade10:"#c43501",primary:"#da3b01",tint10:"#de501c",tint20:"#e36537",tint30:"#e9835e",tint40:"#f4bfab",tint50:"#f9dcd1",tint60:"#fdf6f3"},T={shade50:"#200d03",shade40:"#3d1805",shade30:"#712d09",shade20:"#9a3d0c",shade10:"#b6480e",primary:"#ca5010",tint10:"#d06228",tint20:"#d77440",tint30:"#df8e64",tint40:"#efc4ad",tint50:"#f7dfd2",tint60:"#fdf7f4"},I={shade50:"#271002",shade40:"#4a1e04",shade30:"#8a3707",shade20:"#bc4b09",shade10:"#de590b",primary:"#f7630c",tint10:"#f87528",tint20:"#f98845",tint30:"#faa06b",tint40:"#fdcfb4",tint50:"#fee5d7",tint60:"#fff9f5"},w={shade50:"#291600",shade40:"#4d2a00",shade30:"#8f4e00",shade20:"#c26a00",shade10:"#e67e00",primary:"#ff8c00",tint10:"#ff9a1f",tint20:"#ffa83d",tint30:"#ffba66",tint40:"#ffddb3",tint50:"#ffedd6",tint60:"#fffaf5"},E={shade50:"#251a00",shade40:"#463100",shade30:"#835b00",shade20:"#b27c00",shade10:"#d39300",primary:"#eaa300",tint10:"#edad1c",tint20:"#efb839",tint30:"#f2c661",tint40:"#f9e2ae",tint50:"#fcefd3",tint60:"#fefbf4"},x={shade50:"#282400",shade40:"#4c4400",shade30:"#817400",shade20:"#c0ad00",shade10:"#e4cc00",primary:"#fde300",tint10:"#fde61e",tint20:"#fdea3d",tint30:"#feee66",tint40:"#fef7b2",tint50:"#fffad6",tint60:"#fffef5"},A={shade50:"#1f1900",shade40:"#3a2f00",shade30:"#6c5700",shade20:"#937700",shade10:"#ae8c00",primary:"#c19c00",tint10:"#c8a718",tint20:"#d0b232",tint30:"#dac157",tint40:"#ecdfa5",tint50:"#f5eece",tint60:"#fdfbf2"},D={shade50:"#181202",shade40:"#2e2103",shade30:"#553e06",shade20:"#745408",shade10:"#89640a",primary:"#986f0b",tint10:"#a47d1e",tint20:"#b18c34",tint30:"#c1a256",tint40:"#e0cea2",tint50:"#efe4cb",tint60:"#fbf8f2"},k={shade50:"#170e07",shade40:"#2b1a0e",shade30:"#50301a",shade20:"#6c4123",shade10:"#804d29",primary:"#8e562e",tint10:"#9c663f",tint20:"#a97652",tint30:"#bb8f6f",tint40:"#ddc3b0",tint50:"#edded3",tint60:"#faf7f4"},F={shade50:"#0c1501",shade40:"#162702",shade30:"#294903",shade20:"#376304",shade10:"#427505",primary:"#498205",tint10:"#599116",tint20:"#6ba02b",tint30:"#85b44c",tint40:"#bdd99b",tint50:"#dbebc7",tint60:"#f6faf0"},P={shade50:"#002111",shade40:"#003d20",shade30:"#00723b",shade20:"#009b51",shade10:"#00b85f",primary:"#00cc6a",tint10:"#19d279",tint20:"#34d889",tint30:"#5ae0a0",tint40:"#a8f0cd",tint50:"#cff7e4",tint60:"#f3fdf8"},N={shade50:"#031a02",shade40:"#063004",shade30:"#0b5a08",shade20:"#0e7a0b",shade10:"#11910d",primary:"#13a10e",tint10:"#27ac22",tint20:"#3db838",tint30:"#5ec75a",tint40:"#a7e3a5",tint50:"#cef0cd",tint60:"#f2fbf2"},B={shade50:"#031403",shade40:"#052505",shade30:"#094509",shade20:"#0c5e0c",shade10:"#0e700e",primary:"#107c10",tint10:"#218c21",tint20:"#359b35",tint30:"#54b054",tint40:"#9fd89f",tint50:"#c9eac9",tint60:"#f1faf1"},O={shade50:"#021102",shade40:"#032003",shade30:"#063b06",shade20:"#085108",shade10:"#0a5f0a",primary:"#0b6a0b",tint10:"#1a7c1a",tint20:"#2d8e2d",tint30:"#4da64d",tint40:"#9ad29a",tint50:"#c6e7c6",tint60:"#f0f9f0"},R={shade50:"#001d1f",shade40:"#00373a",shade30:"#00666d",shade20:"#008b94",shade10:"#00a5af",primary:"#00b7c3",tint10:"#18bfca",tint20:"#32c8d1",tint30:"#58d3db",tint40:"#a6e9ed",tint50:"#cef3f5",tint60:"#f2fcfd"},L={shade50:"#001516",shade40:"#012728",shade30:"#02494c",shade20:"#026467",shade10:"#037679",primary:"#038387",tint10:"#159195",tint20:"#2aa0a4",tint30:"#4cb4b7",tint40:"#9bd9db",tint50:"#c7ebec",tint60:"#f0fafa"},M={shade50:"#000f12",shade40:"#001b22",shade30:"#00333f",shade20:"#004555",shade10:"#005265",primary:"#005b70",tint10:"#0f6c81",tint20:"#237d92",tint30:"#4496a9",tint40:"#94c8d4",tint50:"#c3e1e8",tint60:"#eff7f9"},q={shade50:"#001322",shade40:"#002440",shade30:"#004377",shade20:"#005ba1",shade10:"#006cbf",primary:"#0078d4",tint10:"#1a86d9",tint20:"#3595de",tint30:"#5caae5",tint40:"#a9d3f2",tint50:"#d0e7f8",tint60:"#f3f9fd"},W={shade50:"#000c16",shade40:"#00172a",shade30:"#002c4e",shade20:"#003b6a",shade10:"#00467e",primary:"#004e8c",tint10:"#125e9a",tint20:"#286fa8",tint30:"#4a89ba",tint40:"#9abfdc",tint50:"#c7dced",tint60:"#f0f6fa"},U={shade50:"#0d1126",shade40:"#182047",shade30:"#2c3c85",shade20:"#3c51b4",shade10:"#4760d5",primary:"#4f6bed",tint10:"#637cef",tint20:"#778df1",tint30:"#93a4f4",tint40:"#c8d1fa",tint50:"#e1e6fc",tint60:"#f7f9fe"},z={shade50:"#00061d",shade40:"#000c36",shade30:"#001665",shade20:"#001e89",shade10:"#0023a2",primary:"#0027b4",tint10:"#173bbd",tint20:"#3050c6",tint30:"#546fd2",tint40:"#a3b2e8",tint50:"#ccd5f3",tint60:"#f2f4fc"},j={shade50:"#120f25",shade40:"#221d46",shade30:"#3f3682",shade20:"#5649b0",shade10:"#6656d1",primary:"#7160e8",tint10:"#8172eb",tint20:"#9184ee",tint30:"#a79cf1",tint40:"#d2ccf8",tint50:"#e7e4fb",tint60:"#f9f8fe"},H={shade50:"#0f0717",shade40:"#1c0e2b",shade30:"#341a51",shade20:"#46236e",shade10:"#532982",primary:"#5c2e91",tint10:"#6b3f9e",tint20:"#7c52ab",tint30:"#9470bd",tint40:"#c6b1de",tint50:"#e0d3ed",tint60:"#f7f4fb"},V={shade50:"#160418",shade40:"#29072e",shade30:"#4c0d55",shade20:"#671174",shade10:"#7a1589",primary:"#881798",tint10:"#952aa4",tint20:"#a33fb1",tint30:"#b55fc1",tint40:"#d9a7e0",tint50:"#eaceef",tint60:"#faf2fb"},G={shade50:"#1f091d",shade40:"#3a1136",shade30:"#6d2064",shade20:"#932b88",shade10:"#af33a1",primary:"#c239b3",tint10:"#c94cbc",tint20:"#d161c4",tint30:"#da7ed0",tint40:"#edbbe7",tint50:"#f5daf2",tint60:"#fdf5fc"},Q={shade50:"#1c0b1f",shade40:"#35153a",shade30:"#63276d",shade20:"#863593",shade10:"#9f3faf",primary:"#b146c2",tint10:"#ba58c9",tint20:"#c36bd1",tint30:"#cf87da",tint40:"#e6bfed",tint50:"#f2dcf5",tint60:"#fcf6fd"},K={shade50:"#24091b",shade40:"#441232",shade30:"#80215d",shade20:"#ad2d7e",shade10:"#cd3595",primary:"#e43ba6",tint10:"#e750b0",tint20:"#ea66ba",tint30:"#ef85c8",tint40:"#f7c0e3",tint50:"#fbddf0",tint60:"#fef6fb"},$={shade50:"#1f0013",shade40:"#390024",shade30:"#6b0043",shade20:"#91005a",shade10:"#ac006b",primary:"#bf0077",tint10:"#c71885",tint20:"#ce3293",tint30:"#d957a8",tint40:"#eca5d1",tint50:"#f5cee6",tint60:"#fcf2f9"},Z={shade50:"#13000c",shade40:"#240017",shade30:"#43002b",shade20:"#5a003b",shade10:"#6b0045",primary:"#77004d",tint10:"#87105d",tint20:"#98246f",tint30:"#ad4589",tint40:"#d696c0",tint50:"#e9c4dc",tint60:"#faf0f6"},J={shade50:"#141313",shade40:"#252323",shade30:"#444241",shade20:"#5d5958",shade10:"#6e6968",primary:"#7a7574",tint10:"#8a8584",tint20:"#9a9594",tint30:"#afabaa",tint40:"#d7d4d4",tint50:"#eae8e8",tint60:"#faf9f9"},X={shade50:"#0f0e0e",shade40:"#1c1b1a",shade30:"#343231",shade20:"#474443",shade10:"#54514f",primary:"#5d5a58",tint10:"#706d6b",tint20:"#84817e",tint30:"#9e9b99",tint40:"#cecccb",tint50:"#e5e4e3",tint60:"#f8f8f8"},Y={shade50:"#111314",shade40:"#1f2426",shade30:"#3b4447",shade20:"#505c60",shade10:"#5f6d71",primary:"#69797e",tint10:"#79898d",tint20:"#89989d",tint30:"#a0adb2",tint40:"#cdd6d8",tint50:"#e4e9ea",tint60:"#f8f9fa"},ee={shade50:"#090a0b",shade40:"#111315",shade30:"#202427",shade20:"#2b3135",shade10:"#333a3f",primary:"#394146",tint10:"#4d565c",tint20:"#626c72",tint30:"#808a90",tint40:"#bcc3c7",tint50:"#dbdfe1",tint60:"#f6f7f8"}},30975:(e,t,n)=>{"use strict";n.d(t,{L:()=>r});const r={curveAccelerateMax:"cubic-bezier(0.9,0.1,1,0.2)",curveAccelerateMid:"cubic-bezier(1,0,1,1)",curveAccelerateMin:"cubic-bezier(0.8,0,0.78,1)",curveDecelerateMax:"cubic-bezier(0.1,0.9,0.2,1)",curveDecelerateMid:"cubic-bezier(0,0,0,1)",curveDecelerateMin:"cubic-bezier(0.33,0,0.1,1)",curveEasyEaseMax:"cubic-bezier(0.8,0,0.2,1)",curveEasyEase:"cubic-bezier(0.33,0,0.67,1)",curveLinear:"cubic-bezier(0,0,1,1)"}},3442:(e,t,n)=>{"use strict";n.d(t,{S:()=>r});const r={durationUltraFast:"50ms",durationFaster:"100ms",durationFast:"150ms",durationNormal:"200ms",durationGentle:"250ms",durationSlow:"300ms",durationSlower:"400ms",durationUltraSlow:"500ms"}},54661:(e,t,n)=>{"use strict";n.d(t,{GR:()=>r,NM:()=>o,aI:()=>a,lm:()=>i});const r={fontSizeBase100:"10px",fontSizeBase200:"12px",fontSizeBase300:"14px",fontSizeBase400:"16px",fontSizeBase500:"20px",fontSizeBase600:"24px",fontSizeHero700:"28px",fontSizeHero800:"32px",fontSizeHero900:"40px",fontSizeHero1000:"68px"},i={lineHeightBase100:"14px",lineHeightBase200:"16px",lineHeightBase300:"20px",lineHeightBase400:"22px",lineHeightBase500:"28px",lineHeightBase600:"32px",lineHeightHero700:"36px",lineHeightHero800:"40px",lineHeightHero900:"52px",lineHeightHero1000:"92px"},o={fontWeightRegular:400,fontWeightMedium:500,fontWeightSemibold:600,fontWeightBold:700},a={fontFamilyBase:"'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif",fontFamilyMonospace:"Consolas, 'Courier New', Courier, monospace",fontFamilyNumeric:"Bahnschrift, 'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif"}},83601:(e,t,n)=>{"use strict";n.d(t,{F:()=>u,b:()=>d});const r="10px",i="12px",o="16px",a="20px",s="24px",l="32px",d={spacingHorizontalNone:"0",spacingHorizontalXXS:"2px",spacingHorizontalXS:"4px",spacingHorizontalSNudge:"6px",spacingHorizontalS:"8px",spacingHorizontalMNudge:r,spacingHorizontalM:i,spacingHorizontalL:o,spacingHorizontalXL:a,spacingHorizontalXXL:s,spacingHorizontalXXXL:l},u={spacingVerticalNone:"0",spacingVerticalXXS:"2px",spacingVerticalXS:"4px",spacingVerticalSNudge:"6px",spacingVerticalS:"8px",spacingVerticalMNudge:r,spacingVerticalM:i,spacingVerticalL:o,spacingVerticalXL:a,spacingVerticalXXL:s,spacingVerticalXXXL:l}},68106:(e,t,n)=>{"use strict";n.d(t,{k:()=>r});const r={strokeWidthThin:"1px",strokeWidthThick:"2px",strokeWidthThicker:"3px",strokeWidthThickest:"4px"}},51815:(e,t,n)=>{"use strict";n.d(t,{TQ:()=>r,dt:()=>i});const r=["red","green","darkOrange","yellow","berry","lightGreen","marigold"],i=["darkRed","cranberry","pumpkin","peach","gold","brass","brown","forest","seafoam","darkGreen","lightTeal","teal","steel","blue","royalBlue","cornflower","navy","lavender","purple","grape","lilac","pink","magenta","plum","beige","mink","platinum","anchor"]},36934:(e,t,n)=>{"use strict";n.d(t,{s:()=>r});const r={success:"green",warning:"orange",danger:"cranberry"}},68916:(e,t,n)=>{"use strict";n.d(t,{C:()=>g});var r=n(93656),i=n(75435),o=n(61883),a=n(54661),s=n(68106),l=n(6388),d=n(3442),u=n(30975),c=n(83601);const g=(e=>{const t=(e=>({colorNeutralForeground1:i.ON,colorNeutralForeground1Hover:i.ON,colorNeutralForeground1Pressed:i.ON,colorNeutralForeground1Selected:i.ON,colorNeutralForeground2:i.Oh[84],colorNeutralForeground2Hover:i.ON,colorNeutralForeground2Pressed:i.ON,colorNeutralForeground2Selected:i.ON,colorNeutralForeground2BrandHover:e[100],colorNeutralForeground2BrandPressed:e[90],colorNeutralForeground2BrandSelected:e[100],colorNeutralForeground3:i.Oh[68],colorNeutralForeground3Hover:i.Oh[84],colorNeutralForeground3Pressed:i.Oh[84],colorNeutralForeground3Selected:i.Oh[84],colorNeutralForeground3BrandHover:e[100],colorNeutralForeground3BrandPressed:e[90],colorNeutralForeground3BrandSelected:e[100],colorNeutralForeground4:i.Oh[60],colorNeutralForegroundDisabled:i.Oh[36],colorNeutralForegroundInvertedDisabled:i.c8[40],colorBrandForegroundLink:e[100],colorBrandForegroundLinkHover:e[110],colorBrandForegroundLinkPressed:e[90],colorBrandForegroundLinkSelected:e[100],colorNeutralForeground2Link:i.Oh[84],colorNeutralForeground2LinkHover:i.ON,colorNeutralForeground2LinkPressed:i.ON,colorNeutralForeground2LinkSelected:i.ON,colorCompoundBrandForeground1:e[100],colorCompoundBrandForeground1Hover:e[110],colorCompoundBrandForeground1Pressed:e[90],colorBrandForeground1:e[100],colorBrandForeground2:e[110],colorBrandForeground2Hover:e[130],colorBrandForeground2Pressed:e[160],colorNeutralForeground1Static:i.Oh[14],colorNeutralForegroundStaticInverted:i.ON,colorNeutralForegroundInverted:i.Oh[14],colorNeutralForegroundInvertedHover:i.Oh[14],colorNeutralForegroundInvertedPressed:i.Oh[14],colorNeutralForegroundInvertedSelected:i.Oh[14],colorNeutralForegroundInverted2:i.Oh[14],colorNeutralForegroundOnBrand:i.ON,colorNeutralForegroundInvertedLink:i.ON,colorNeutralForegroundInvertedLinkHover:i.ON,colorNeutralForegroundInvertedLinkPressed:i.ON,colorNeutralForegroundInvertedLinkSelected:i.ON,colorBrandForegroundInverted:e[80],colorBrandForegroundInvertedHover:e[70],colorBrandForegroundInvertedPressed:e[60],colorBrandForegroundOnLight:e[80],colorBrandForegroundOnLightHover:e[70],colorBrandForegroundOnLightPressed:e[50],colorBrandForegroundOnLightSelected:e[60],colorNeutralBackground1:i.Oh[16],colorNeutralBackground1Hover:i.Oh[24],colorNeutralBackground1Pressed:i.Oh[12],colorNeutralBackground1Selected:i.Oh[22],colorNeutralBackground2:i.Oh[12],colorNeutralBackground2Hover:i.Oh[20],colorNeutralBackground2Pressed:i.Oh[8],colorNeutralBackground2Selected:i.Oh[18],colorNeutralBackground3:i.Oh[8],colorNeutralBackground3Hover:i.Oh[16],colorNeutralBackground3Pressed:i.Oh[4],colorNeutralBackground3Selected:i.Oh[14],colorNeutralBackground4:i.Oh[4],colorNeutralBackground4Hover:i.Oh[12],colorNeutralBackground4Pressed:i.Ql,colorNeutralBackground4Selected:i.Oh[10],colorNeutralBackground5:i.Ql,colorNeutralBackground5Hover:i.Oh[8],colorNeutralBackground5Pressed:i.Oh[2],colorNeutralBackground5Selected:i.Oh[6],colorNeutralBackground6:i.Oh[20],colorNeutralBackgroundInverted:i.ON,colorNeutralBackgroundStatic:i.Oh[24],colorNeutralBackgroundAlpha:i.ti[50],colorNeutralBackgroundAlpha2:i.Z1[70],colorSubtleBackground:"transparent",colorSubtleBackgroundHover:i.Oh[22],colorSubtleBackgroundPressed:i.Oh[18],colorSubtleBackgroundSelected:i.Oh[20],colorSubtleBackgroundLightAlphaHover:i.Xv[80],colorSubtleBackgroundLightAlphaPressed:i.Xv[50],colorSubtleBackgroundLightAlphaSelected:"transparent",colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:i.Q1[10],colorSubtleBackgroundInvertedPressed:i.Q1[30],colorSubtleBackgroundInvertedSelected:i.Q1[20],colorTransparentBackground:"transparent",colorTransparentBackgroundHover:"transparent",colorTransparentBackgroundPressed:"transparent",colorTransparentBackgroundSelected:"transparent",colorNeutralBackgroundDisabled:i.Oh[8],colorNeutralBackgroundInvertedDisabled:i.c8[10],colorNeutralStencil1:i.Oh[34],colorNeutralStencil2:i.Oh[20],colorNeutralStencil1Alpha:i.c8[10],colorNeutralStencil2Alpha:i.c8[5],colorBackgroundOverlay:i.Q1[50],colorScrollbarOverlay:i.c8[60],colorBrandBackground:e[70],colorBrandBackgroundHover:e[80],colorBrandBackgroundPressed:e[40],colorBrandBackgroundSelected:e[60],colorCompoundBrandBackground:e[100],colorCompoundBrandBackgroundHover:e[110],colorCompoundBrandBackgroundPressed:e[90],colorBrandBackgroundStatic:e[80],colorBrandBackground2:e[20],colorBrandBackground2Hover:e[40],colorBrandBackground2Pressed:e[10],colorBrandBackground3Static:e[60],colorBrandBackground4Static:e[40],colorBrandBackgroundInverted:i.ON,colorBrandBackgroundInvertedHover:e[160],colorBrandBackgroundInvertedPressed:e[140],colorBrandBackgroundInvertedSelected:e[150],colorNeutralCardBackground:i.Oh[20],colorNeutralCardBackgroundHover:i.Oh[24],colorNeutralCardBackgroundPressed:i.Oh[18],colorNeutralCardBackgroundSelected:i.Oh[22],colorNeutralCardBackgroundDisabled:i.Oh[8],colorNeutralStrokeAccessible:i.Oh[68],colorNeutralStrokeAccessibleHover:i.Oh[74],colorNeutralStrokeAccessiblePressed:i.Oh[70],colorNeutralStrokeAccessibleSelected:e[100],colorNeutralStroke1:i.Oh[40],colorNeutralStroke1Hover:i.Oh[46],colorNeutralStroke1Pressed:i.Oh[42],colorNeutralStroke1Selected:i.Oh[44],colorNeutralStroke2:i.Oh[32],colorNeutralStroke3:i.Oh[24],colorNeutralStrokeSubtle:i.Oh[4],colorNeutralStrokeOnBrand:i.Oh[16],colorNeutralStrokeOnBrand2:i.ON,colorNeutralStrokeOnBrand2Hover:i.ON,colorNeutralStrokeOnBrand2Pressed:i.ON,colorNeutralStrokeOnBrand2Selected:i.ON,colorBrandStroke1:e[100],colorBrandStroke2:e[50],colorBrandStroke2Hover:e[50],colorBrandStroke2Pressed:e[30],colorBrandStroke2Contrast:e[50],colorCompoundBrandStroke:e[100],colorCompoundBrandStrokeHover:e[110],colorCompoundBrandStrokePressed:e[90],colorNeutralStrokeDisabled:i.Oh[26],colorNeutralStrokeInvertedDisabled:i.c8[40],colorTransparentStroke:"transparent",colorTransparentStrokeInteractive:"transparent",colorTransparentStrokeDisabled:"transparent",colorNeutralStrokeAlpha:i.c8[10],colorNeutralStrokeAlpha2:i.c8[20],colorStrokeFocus1:i.Ql,colorStrokeFocus2:i.ON,colorNeutralShadowAmbient:"rgba(0,0,0,0.24)",colorNeutralShadowKey:"rgba(0,0,0,0.28)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.12)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.40)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.48)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"}))(e);return{...o.V,...a.GR,...a.lm,...a.aI,...a.NM,...s.k,...c.b,...c.F,...d.S,...u.L,...t,...r.h,...r.m,...(0,l.t)(t.colorNeutralShadowAmbient,t.colorNeutralShadowKey),...(0,l.t)(t.colorBrandShadowAmbient,t.colorBrandShadowKey,"Brand")}})(n(71122).oZ)},60970:(e,t,n)=>{"use strict";n.d(t,{o:()=>o});var r=n(62056),i=n(71122);const o=(0,r.a)(i.oZ)},62056:(e,t,n)=>{"use strict";n.d(t,{a:()=>y});var r=n(71737),i=n(51815),o=n(36934);const a=i.TQ.reduce(((e,t)=>{const n=t.slice(0,1).toUpperCase()+t.slice(1),i={[`colorPalette${n}Background1`]:r.yd[t].tint60,[`colorPalette${n}Background2`]:r.yd[t].tint40,[`colorPalette${n}Background3`]:r.yd[t].primary,[`colorPalette${n}Foreground1`]:r.yd[t].shade10,[`colorPalette${n}Foreground2`]:r.yd[t].shade30,[`colorPalette${n}Foreground3`]:r.yd[t].primary,[`colorPalette${n}BorderActive`]:r.yd[t].primary,[`colorPalette${n}Border1`]:r.yd[t].tint40,[`colorPalette${n}Border2`]:r.yd[t].primary};return Object.assign(e,i)}),{});a.colorPaletteYellowForeground1=r.yd.yellow.shade30,a.colorPaletteRedForegroundInverted=r.yd.red.tint20,a.colorPaletteGreenForegroundInverted=r.yd.green.tint20,a.colorPaletteYellowForegroundInverted=r.yd.yellow.tint40;const s=i.dt.reduce(((e,t)=>{const n=t.slice(0,1).toUpperCase()+t.slice(1),i={[`colorPalette${n}Background2`]:r.cc[t].tint40,[`colorPalette${n}Foreground2`]:r.cc[t].shade30,[`colorPalette${n}BorderActive`]:r.cc[t].primary};return Object.assign(e,i)}),{}),l={...a,...s},d=Object.entries(o.s).reduce(((e,[t,n])=>{const i=t.slice(0,1).toUpperCase()+t.slice(1),o={[`colorStatus${i}Background1`]:r.Ul[n].tint60,[`colorStatus${i}Background2`]:r.Ul[n].tint40,[`colorStatus${i}Background3`]:r.Ul[n].primary,[`colorStatus${i}Foreground1`]:r.Ul[n].shade10,[`colorStatus${i}Foreground2`]:r.Ul[n].shade30,[`colorStatus${i}Foreground3`]:r.Ul[n].primary,[`colorStatus${i}ForegroundInverted`]:r.Ul[n].tint30,[`colorStatus${i}BorderActive`]:r.Ul[n].primary,[`colorStatus${i}Border1`]:r.Ul[n].tint40,[`colorStatus${i}Border2`]:r.Ul[n].primary};return Object.assign(e,o)}),{});d.colorStatusDangerBackground3Hover=r.Ul[o.s.danger].shade10,d.colorStatusDangerBackground3Pressed=r.Ul[o.s.danger].shade20,d.colorStatusWarningForeground1=r.Ul[o.s.warning].shade20,d.colorStatusWarningForeground3=r.Ul[o.s.warning].shade20,d.colorStatusWarningBorder2=r.Ul[o.s.warning].shade20;var u=n(75435),c=n(61883),g=n(54661),h=n(68106),p=n(6388),f=n(3442),v=n(30975),m=n(83601);const y=e=>{const t=(e=>({colorNeutralForeground1:u.Oh[14],colorNeutralForeground1Hover:u.Oh[14],colorNeutralForeground1Pressed:u.Oh[14],colorNeutralForeground1Selected:u.Oh[14],colorNeutralForeground2:u.Oh[26],colorNeutralForeground2Hover:u.Oh[14],colorNeutralForeground2Pressed:u.Oh[14],colorNeutralForeground2Selected:u.Oh[14],colorNeutralForeground2BrandHover:e[80],colorNeutralForeground2BrandPressed:e[70],colorNeutralForeground2BrandSelected:e[80],colorNeutralForeground3:u.Oh[38],colorNeutralForeground3Hover:u.Oh[26],colorNeutralForeground3Pressed:u.Oh[26],colorNeutralForeground3Selected:u.Oh[26],colorNeutralForeground3BrandHover:e[80],colorNeutralForeground3BrandPressed:e[70],colorNeutralForeground3BrandSelected:e[80],colorNeutralForeground4:u.Oh[44],colorNeutralForegroundDisabled:u.Oh[74],colorNeutralForegroundInvertedDisabled:u.c8[40],colorBrandForegroundLink:e[70],colorBrandForegroundLinkHover:e[60],colorBrandForegroundLinkPressed:e[40],colorBrandForegroundLinkSelected:e[70],colorNeutralForeground2Link:u.Oh[26],colorNeutralForeground2LinkHover:u.Oh[14],colorNeutralForeground2LinkPressed:u.Oh[14],colorNeutralForeground2LinkSelected:u.Oh[14],colorCompoundBrandForeground1:e[80],colorCompoundBrandForeground1Hover:e[70],colorCompoundBrandForeground1Pressed:e[60],colorBrandForeground1:e[80],colorBrandForeground2:e[70],colorBrandForeground2Hover:e[60],colorBrandForeground2Pressed:e[30],colorNeutralForeground1Static:u.Oh[14],colorNeutralForegroundStaticInverted:u.ON,colorNeutralForegroundInverted:u.ON,colorNeutralForegroundInvertedHover:u.ON,colorNeutralForegroundInvertedPressed:u.ON,colorNeutralForegroundInvertedSelected:u.ON,colorNeutralForegroundInverted2:u.ON,colorNeutralForegroundOnBrand:u.ON,colorNeutralForegroundInvertedLink:u.ON,colorNeutralForegroundInvertedLinkHover:u.ON,colorNeutralForegroundInvertedLinkPressed:u.ON,colorNeutralForegroundInvertedLinkSelected:u.ON,colorBrandForegroundInverted:e[100],colorBrandForegroundInvertedHover:e[110],colorBrandForegroundInvertedPressed:e[100],colorBrandForegroundOnLight:e[80],colorBrandForegroundOnLightHover:e[70],colorBrandForegroundOnLightPressed:e[50],colorBrandForegroundOnLightSelected:e[60],colorNeutralBackground1:u.ON,colorNeutralBackground1Hover:u.Oh[96],colorNeutralBackground1Pressed:u.Oh[88],colorNeutralBackground1Selected:u.Oh[92],colorNeutralBackground2:u.Oh[98],colorNeutralBackground2Hover:u.Oh[94],colorNeutralBackground2Pressed:u.Oh[86],colorNeutralBackground2Selected:u.Oh[90],colorNeutralBackground3:u.Oh[96],colorNeutralBackground3Hover:u.Oh[92],colorNeutralBackground3Pressed:u.Oh[84],colorNeutralBackground3Selected:u.Oh[88],colorNeutralBackground4:u.Oh[94],colorNeutralBackground4Hover:u.Oh[98],colorNeutralBackground4Pressed:u.Oh[96],colorNeutralBackground4Selected:u.ON,colorNeutralBackground5:u.Oh[92],colorNeutralBackground5Hover:u.Oh[96],colorNeutralBackground5Pressed:u.Oh[94],colorNeutralBackground5Selected:u.Oh[98],colorNeutralBackground6:u.Oh[90],colorNeutralBackgroundInverted:u.Oh[16],colorNeutralBackgroundStatic:u.Oh[20],colorNeutralBackgroundAlpha:u.c8[50],colorNeutralBackgroundAlpha2:u.c8[80],colorSubtleBackground:"transparent",colorSubtleBackgroundHover:u.Oh[96],colorSubtleBackgroundPressed:u.Oh[88],colorSubtleBackgroundSelected:u.Oh[92],colorSubtleBackgroundLightAlphaHover:u.c8[70],colorSubtleBackgroundLightAlphaPressed:u.c8[50],colorSubtleBackgroundLightAlphaSelected:"transparent",colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:u.Q1[10],colorSubtleBackgroundInvertedPressed:u.Q1[30],colorSubtleBackgroundInvertedSelected:u.Q1[20],colorTransparentBackground:"transparent",colorTransparentBackgroundHover:"transparent",colorTransparentBackgroundPressed:"transparent",colorTransparentBackgroundSelected:"transparent",colorNeutralBackgroundDisabled:u.Oh[94],colorNeutralBackgroundInvertedDisabled:u.c8[10],colorNeutralStencil1:u.Oh[90],colorNeutralStencil2:u.Oh[98],colorNeutralStencil1Alpha:u.Q1[10],colorNeutralStencil2Alpha:u.Q1[5],colorBackgroundOverlay:u.Q1[40],colorScrollbarOverlay:u.Q1[50],colorBrandBackground:e[80],colorBrandBackgroundHover:e[70],colorBrandBackgroundPressed:e[40],colorBrandBackgroundSelected:e[60],colorCompoundBrandBackground:e[80],colorCompoundBrandBackgroundHover:e[70],colorCompoundBrandBackgroundPressed:e[60],colorBrandBackgroundStatic:e[80],colorBrandBackground2:e[160],colorBrandBackground2Hover:e[150],colorBrandBackground2Pressed:e[130],colorBrandBackground3Static:e[60],colorBrandBackground4Static:e[40],colorBrandBackgroundInverted:u.ON,colorBrandBackgroundInvertedHover:e[160],colorBrandBackgroundInvertedPressed:e[140],colorBrandBackgroundInvertedSelected:e[150],colorNeutralCardBackground:u.Oh[98],colorNeutralCardBackgroundHover:u.ON,colorNeutralCardBackgroundPressed:u.Oh[96],colorNeutralCardBackgroundSelected:u.Oh[92],colorNeutralCardBackgroundDisabled:u.Oh[94],colorNeutralStrokeAccessible:u.Oh[38],colorNeutralStrokeAccessibleHover:u.Oh[34],colorNeutralStrokeAccessiblePressed:u.Oh[30],colorNeutralStrokeAccessibleSelected:e[80],colorNeutralStroke1:u.Oh[82],colorNeutralStroke1Hover:u.Oh[78],colorNeutralStroke1Pressed:u.Oh[70],colorNeutralStroke1Selected:u.Oh[74],colorNeutralStroke2:u.Oh[88],colorNeutralStroke3:u.Oh[94],colorNeutralStrokeSubtle:u.Oh[88],colorNeutralStrokeOnBrand:u.ON,colorNeutralStrokeOnBrand2:u.ON,colorNeutralStrokeOnBrand2Hover:u.ON,colorNeutralStrokeOnBrand2Pressed:u.ON,colorNeutralStrokeOnBrand2Selected:u.ON,colorBrandStroke1:e[80],colorBrandStroke2:e[140],colorBrandStroke2Hover:e[120],colorBrandStroke2Pressed:e[80],colorBrandStroke2Contrast:e[140],colorCompoundBrandStroke:e[80],colorCompoundBrandStrokeHover:e[70],colorCompoundBrandStrokePressed:e[60],colorNeutralStrokeDisabled:u.Oh[88],colorNeutralStrokeInvertedDisabled:u.c8[40],colorTransparentStroke:"transparent",colorTransparentStrokeInteractive:"transparent",colorTransparentStrokeDisabled:"transparent",colorNeutralStrokeAlpha:u.Q1[5],colorNeutralStrokeAlpha2:u.c8[20],colorStrokeFocus1:u.ON,colorStrokeFocus2:u.Ql,colorNeutralShadowAmbient:"rgba(0,0,0,0.12)",colorNeutralShadowKey:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.06)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.07)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.20)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.24)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"}))(e);return{...c.V,...g.GR,...g.lm,...g.aI,...g.NM,...h.k,...m.b,...m.F,...f.S,...v.L,...t,...l,...d,...(0,p.t)(t.colorNeutralShadowAmbient,t.colorNeutralShadowKey),...(0,p.t)(t.colorBrandShadowAmbient,t.colorBrandShadowKey,"Brand")}}},6388:(e,t,n)=>{"use strict";function r(e,t,n=""){return{[`shadow2${n}`]:`0 0 2px ${e}, 0 1px 2px ${t}`,[`shadow4${n}`]:`0 0 2px ${e}, 0 2px 4px ${t}`,[`shadow8${n}`]:`0 0 2px ${e}, 0 4px 8px ${t}`,[`shadow16${n}`]:`0 0 2px ${e}, 0 8px 16px ${t}`,[`shadow28${n}`]:`0 0 8px ${e}, 0 14px 28px ${t}`,[`shadow64${n}`]:`0 0 8px ${e}, 0 32px 64px ${t}`}}n.d(t,{t:()=>r})},51474:(e,t,n)=>{"use strict";n.d(t,{L:()=>r});const r={colorNeutralForeground1:"var(--colorNeutralForeground1)",colorNeutralForeground1Hover:"var(--colorNeutralForeground1Hover)",colorNeutralForeground1Pressed:"var(--colorNeutralForeground1Pressed)",colorNeutralForeground1Selected:"var(--colorNeutralForeground1Selected)",colorNeutralForeground2:"var(--colorNeutralForeground2)",colorNeutralForeground2Hover:"var(--colorNeutralForeground2Hover)",colorNeutralForeground2Pressed:"var(--colorNeutralForeground2Pressed)",colorNeutralForeground2Selected:"var(--colorNeutralForeground2Selected)",colorNeutralForeground2BrandHover:"var(--colorNeutralForeground2BrandHover)",colorNeutralForeground2BrandPressed:"var(--colorNeutralForeground2BrandPressed)",colorNeutralForeground2BrandSelected:"var(--colorNeutralForeground2BrandSelected)",colorNeutralForeground3:"var(--colorNeutralForeground3)",colorNeutralForeground3Hover:"var(--colorNeutralForeground3Hover)",colorNeutralForeground3Pressed:"var(--colorNeutralForeground3Pressed)",colorNeutralForeground3Selected:"var(--colorNeutralForeground3Selected)",colorNeutralForeground3BrandHover:"var(--colorNeutralForeground3BrandHover)",colorNeutralForeground3BrandPressed:"var(--colorNeutralForeground3BrandPressed)",colorNeutralForeground3BrandSelected:"var(--colorNeutralForeground3BrandSelected)",colorNeutralForeground4:"var(--colorNeutralForeground4)",colorNeutralForegroundDisabled:"var(--colorNeutralForegroundDisabled)",colorBrandForegroundLink:"var(--colorBrandForegroundLink)",colorBrandForegroundLinkHover:"var(--colorBrandForegroundLinkHover)",colorBrandForegroundLinkPressed:"var(--colorBrandForegroundLinkPressed)",colorBrandForegroundLinkSelected:"var(--colorBrandForegroundLinkSelected)",colorNeutralForeground2Link:"var(--colorNeutralForeground2Link)",colorNeutralForeground2LinkHover:"var(--colorNeutralForeground2LinkHover)",colorNeutralForeground2LinkPressed:"var(--colorNeutralForeground2LinkPressed)",colorNeutralForeground2LinkSelected:"var(--colorNeutralForeground2LinkSelected)",colorCompoundBrandForeground1:"var(--colorCompoundBrandForeground1)",colorCompoundBrandForeground1Hover:"var(--colorCompoundBrandForeground1Hover)",colorCompoundBrandForeground1Pressed:"var(--colorCompoundBrandForeground1Pressed)",colorNeutralForegroundOnBrand:"var(--colorNeutralForegroundOnBrand)",colorNeutralForegroundInverted:"var(--colorNeutralForegroundInverted)",colorNeutralForegroundInvertedHover:"var(--colorNeutralForegroundInvertedHover)",colorNeutralForegroundInvertedPressed:"var(--colorNeutralForegroundInvertedPressed)",colorNeutralForegroundInvertedSelected:"var(--colorNeutralForegroundInvertedSelected)",colorNeutralForegroundInverted2:"var(--colorNeutralForegroundInverted2)",colorNeutralForegroundStaticInverted:"var(--colorNeutralForegroundStaticInverted)",colorNeutralForegroundInvertedLink:"var(--colorNeutralForegroundInvertedLink)",colorNeutralForegroundInvertedLinkHover:"var(--colorNeutralForegroundInvertedLinkHover)",colorNeutralForegroundInvertedLinkPressed:"var(--colorNeutralForegroundInvertedLinkPressed)",colorNeutralForegroundInvertedLinkSelected:"var(--colorNeutralForegroundInvertedLinkSelected)",colorNeutralForegroundInvertedDisabled:"var(--colorNeutralForegroundInvertedDisabled)",colorBrandForeground1:"var(--colorBrandForeground1)",colorBrandForeground2:"var(--colorBrandForeground2)",colorBrandForeground2Hover:"var(--colorBrandForeground2Hover)",colorBrandForeground2Pressed:"var(--colorBrandForeground2Pressed)",colorNeutralForeground1Static:"var(--colorNeutralForeground1Static)",colorBrandForegroundInverted:"var(--colorBrandForegroundInverted)",colorBrandForegroundInvertedHover:"var(--colorBrandForegroundInvertedHover)",colorBrandForegroundInvertedPressed:"var(--colorBrandForegroundInvertedPressed)",colorBrandForegroundOnLight:"var(--colorBrandForegroundOnLight)",colorBrandForegroundOnLightHover:"var(--colorBrandForegroundOnLightHover)",colorBrandForegroundOnLightPressed:"var(--colorBrandForegroundOnLightPressed)",colorBrandForegroundOnLightSelected:"var(--colorBrandForegroundOnLightSelected)",colorNeutralBackground1:"var(--colorNeutralBackground1)",colorNeutralBackground1Hover:"var(--colorNeutralBackground1Hover)",colorNeutralBackground1Pressed:"var(--colorNeutralBackground1Pressed)",colorNeutralBackground1Selected:"var(--colorNeutralBackground1Selected)",colorNeutralBackground2:"var(--colorNeutralBackground2)",colorNeutralBackground2Hover:"var(--colorNeutralBackground2Hover)",colorNeutralBackground2Pressed:"var(--colorNeutralBackground2Pressed)",colorNeutralBackground2Selected:"var(--colorNeutralBackground2Selected)",colorNeutralBackground3:"var(--colorNeutralBackground3)",colorNeutralBackground3Hover:"var(--colorNeutralBackground3Hover)",colorNeutralBackground3Pressed:"var(--colorNeutralBackground3Pressed)",colorNeutralBackground3Selected:"var(--colorNeutralBackground3Selected)",colorNeutralBackground4:"var(--colorNeutralBackground4)",colorNeutralBackground4Hover:"var(--colorNeutralBackground4Hover)",colorNeutralBackground4Pressed:"var(--colorNeutralBackground4Pressed)",colorNeutralBackground4Selected:"var(--colorNeutralBackground4Selected)",colorNeutralBackground5:"var(--colorNeutralBackground5)",colorNeutralBackground5Hover:"var(--colorNeutralBackground5Hover)",colorNeutralBackground5Pressed:"var(--colorNeutralBackground5Pressed)",colorNeutralBackground5Selected:"var(--colorNeutralBackground5Selected)",colorNeutralBackground6:"var(--colorNeutralBackground6)",colorNeutralBackgroundInverted:"var(--colorNeutralBackgroundInverted)",colorNeutralBackgroundStatic:"var(--colorNeutralBackgroundStatic)",colorNeutralBackgroundAlpha:"var(--colorNeutralBackgroundAlpha)",colorNeutralBackgroundAlpha2:"var(--colorNeutralBackgroundAlpha2)",colorSubtleBackground:"var(--colorSubtleBackground)",colorSubtleBackgroundHover:"var(--colorSubtleBackgroundHover)",colorSubtleBackgroundPressed:"var(--colorSubtleBackgroundPressed)",colorSubtleBackgroundSelected:"var(--colorSubtleBackgroundSelected)",colorSubtleBackgroundLightAlphaHover:"var(--colorSubtleBackgroundLightAlphaHover)",colorSubtleBackgroundLightAlphaPressed:"var(--colorSubtleBackgroundLightAlphaPressed)",colorSubtleBackgroundLightAlphaSelected:"var(--colorSubtleBackgroundLightAlphaSelected)",colorSubtleBackgroundInverted:"var(--colorSubtleBackgroundInverted)",colorSubtleBackgroundInvertedHover:"var(--colorSubtleBackgroundInvertedHover)",colorSubtleBackgroundInvertedPressed:"var(--colorSubtleBackgroundInvertedPressed)",colorSubtleBackgroundInvertedSelected:"var(--colorSubtleBackgroundInvertedSelected)",colorTransparentBackground:"var(--colorTransparentBackground)",colorTransparentBackgroundHover:"var(--colorTransparentBackgroundHover)",colorTransparentBackgroundPressed:"var(--colorTransparentBackgroundPressed)",colorTransparentBackgroundSelected:"var(--colorTransparentBackgroundSelected)",colorNeutralBackgroundDisabled:"var(--colorNeutralBackgroundDisabled)",colorNeutralBackgroundInvertedDisabled:"var(--colorNeutralBackgroundInvertedDisabled)",colorNeutralStencil1:"var(--colorNeutralStencil1)",colorNeutralStencil2:"var(--colorNeutralStencil2)",colorNeutralStencil1Alpha:"var(--colorNeutralStencil1Alpha)",colorNeutralStencil2Alpha:"var(--colorNeutralStencil2Alpha)",colorBackgroundOverlay:"var(--colorBackgroundOverlay)",colorScrollbarOverlay:"var(--colorScrollbarOverlay)",colorBrandBackground:"var(--colorBrandBackground)",colorBrandBackgroundHover:"var(--colorBrandBackgroundHover)",colorBrandBackgroundPressed:"var(--colorBrandBackgroundPressed)",colorBrandBackgroundSelected:"var(--colorBrandBackgroundSelected)",colorCompoundBrandBackground:"var(--colorCompoundBrandBackground)",colorCompoundBrandBackgroundHover:"var(--colorCompoundBrandBackgroundHover)",colorCompoundBrandBackgroundPressed:"var(--colorCompoundBrandBackgroundPressed)",colorBrandBackgroundStatic:"var(--colorBrandBackgroundStatic)",colorBrandBackground2:"var(--colorBrandBackground2)",colorBrandBackground2Hover:"var(--colorBrandBackground2Hover)",colorBrandBackground2Pressed:"var(--colorBrandBackground2Pressed)",colorBrandBackground3Static:"var(--colorBrandBackground3Static)",colorBrandBackground4Static:"var(--colorBrandBackground4Static)",colorBrandBackgroundInverted:"var(--colorBrandBackgroundInverted)",colorBrandBackgroundInvertedHover:"var(--colorBrandBackgroundInvertedHover)",colorBrandBackgroundInvertedPressed:"var(--colorBrandBackgroundInvertedPressed)",colorBrandBackgroundInvertedSelected:"var(--colorBrandBackgroundInvertedSelected)",colorNeutralCardBackground:"var(--colorNeutralCardBackground)",colorNeutralCardBackgroundHover:"var(--colorNeutralCardBackgroundHover)",colorNeutralCardBackgroundPressed:"var(--colorNeutralCardBackgroundPressed)",colorNeutralCardBackgroundSelected:"var(--colorNeutralCardBackgroundSelected)",colorNeutralCardBackgroundDisabled:"var(--colorNeutralCardBackgroundDisabled)",colorNeutralStrokeAccessible:"var(--colorNeutralStrokeAccessible)",colorNeutralStrokeAccessibleHover:"var(--colorNeutralStrokeAccessibleHover)",colorNeutralStrokeAccessiblePressed:"var(--colorNeutralStrokeAccessiblePressed)",colorNeutralStrokeAccessibleSelected:"var(--colorNeutralStrokeAccessibleSelected)",colorNeutralStroke1:"var(--colorNeutralStroke1)",colorNeutralStroke1Hover:"var(--colorNeutralStroke1Hover)",colorNeutralStroke1Pressed:"var(--colorNeutralStroke1Pressed)",colorNeutralStroke1Selected:"var(--colorNeutralStroke1Selected)",colorNeutralStroke2:"var(--colorNeutralStroke2)",colorNeutralStroke3:"var(--colorNeutralStroke3)",colorNeutralStrokeSubtle:"var(--colorNeutralStrokeSubtle)",colorNeutralStrokeOnBrand:"var(--colorNeutralStrokeOnBrand)",colorNeutralStrokeOnBrand2:"var(--colorNeutralStrokeOnBrand2)",colorNeutralStrokeOnBrand2Hover:"var(--colorNeutralStrokeOnBrand2Hover)",colorNeutralStrokeOnBrand2Pressed:"var(--colorNeutralStrokeOnBrand2Pressed)",colorNeutralStrokeOnBrand2Selected:"var(--colorNeutralStrokeOnBrand2Selected)",colorBrandStroke1:"var(--colorBrandStroke1)",colorBrandStroke2:"var(--colorBrandStroke2)",colorBrandStroke2Hover:"var(--colorBrandStroke2Hover)",colorBrandStroke2Pressed:"var(--colorBrandStroke2Pressed)",colorBrandStroke2Contrast:"var(--colorBrandStroke2Contrast)",colorCompoundBrandStroke:"var(--colorCompoundBrandStroke)",colorCompoundBrandStrokeHover:"var(--colorCompoundBrandStrokeHover)",colorCompoundBrandStrokePressed:"var(--colorCompoundBrandStrokePressed)",colorNeutralStrokeDisabled:"var(--colorNeutralStrokeDisabled)",colorNeutralStrokeInvertedDisabled:"var(--colorNeutralStrokeInvertedDisabled)",colorTransparentStroke:"var(--colorTransparentStroke)",colorTransparentStrokeInteractive:"var(--colorTransparentStrokeInteractive)",colorTransparentStrokeDisabled:"var(--colorTransparentStrokeDisabled)",colorNeutralStrokeAlpha:"var(--colorNeutralStrokeAlpha)",colorNeutralStrokeAlpha2:"var(--colorNeutralStrokeAlpha2)",colorStrokeFocus1:"var(--colorStrokeFocus1)",colorStrokeFocus2:"var(--colorStrokeFocus2)",colorNeutralShadowAmbient:"var(--colorNeutralShadowAmbient)",colorNeutralShadowKey:"var(--colorNeutralShadowKey)",colorNeutralShadowAmbientLighter:"var(--colorNeutralShadowAmbientLighter)",colorNeutralShadowKeyLighter:"var(--colorNeutralShadowKeyLighter)",colorNeutralShadowAmbientDarker:"var(--colorNeutralShadowAmbientDarker)",colorNeutralShadowKeyDarker:"var(--colorNeutralShadowKeyDarker)",colorBrandShadowAmbient:"var(--colorBrandShadowAmbient)",colorBrandShadowKey:"var(--colorBrandShadowKey)",colorPaletteRedBackground1:"var(--colorPaletteRedBackground1)",colorPaletteRedBackground2:"var(--colorPaletteRedBackground2)",colorPaletteRedBackground3:"var(--colorPaletteRedBackground3)",colorPaletteRedBorderActive:"var(--colorPaletteRedBorderActive)",colorPaletteRedBorder1:"var(--colorPaletteRedBorder1)",colorPaletteRedBorder2:"var(--colorPaletteRedBorder2)",colorPaletteRedForeground1:"var(--colorPaletteRedForeground1)",colorPaletteRedForeground2:"var(--colorPaletteRedForeground2)",colorPaletteRedForeground3:"var(--colorPaletteRedForeground3)",colorPaletteRedForegroundInverted:"var(--colorPaletteRedForegroundInverted)",colorPaletteGreenBackground1:"var(--colorPaletteGreenBackground1)",colorPaletteGreenBackground2:"var(--colorPaletteGreenBackground2)",colorPaletteGreenBackground3:"var(--colorPaletteGreenBackground3)",colorPaletteGreenBorderActive:"var(--colorPaletteGreenBorderActive)",colorPaletteGreenBorder1:"var(--colorPaletteGreenBorder1)",colorPaletteGreenBorder2:"var(--colorPaletteGreenBorder2)",colorPaletteGreenForeground1:"var(--colorPaletteGreenForeground1)",colorPaletteGreenForeground2:"var(--colorPaletteGreenForeground2)",colorPaletteGreenForeground3:"var(--colorPaletteGreenForeground3)",colorPaletteGreenForegroundInverted:"var(--colorPaletteGreenForegroundInverted)",colorPaletteDarkOrangeBackground1:"var(--colorPaletteDarkOrangeBackground1)",colorPaletteDarkOrangeBackground2:"var(--colorPaletteDarkOrangeBackground2)",colorPaletteDarkOrangeBackground3:"var(--colorPaletteDarkOrangeBackground3)",colorPaletteDarkOrangeBorderActive:"var(--colorPaletteDarkOrangeBorderActive)",colorPaletteDarkOrangeBorder1:"var(--colorPaletteDarkOrangeBorder1)",colorPaletteDarkOrangeBorder2:"var(--colorPaletteDarkOrangeBorder2)",colorPaletteDarkOrangeForeground1:"var(--colorPaletteDarkOrangeForeground1)",colorPaletteDarkOrangeForeground2:"var(--colorPaletteDarkOrangeForeground2)",colorPaletteDarkOrangeForeground3:"var(--colorPaletteDarkOrangeForeground3)",colorPaletteYellowBackground1:"var(--colorPaletteYellowBackground1)",colorPaletteYellowBackground2:"var(--colorPaletteYellowBackground2)",colorPaletteYellowBackground3:"var(--colorPaletteYellowBackground3)",colorPaletteYellowBorderActive:"var(--colorPaletteYellowBorderActive)",colorPaletteYellowBorder1:"var(--colorPaletteYellowBorder1)",colorPaletteYellowBorder2:"var(--colorPaletteYellowBorder2)",colorPaletteYellowForeground1:"var(--colorPaletteYellowForeground1)",colorPaletteYellowForeground2:"var(--colorPaletteYellowForeground2)",colorPaletteYellowForeground3:"var(--colorPaletteYellowForeground3)",colorPaletteYellowForegroundInverted:"var(--colorPaletteYellowForegroundInverted)",colorPaletteBerryBackground1:"var(--colorPaletteBerryBackground1)",colorPaletteBerryBackground2:"var(--colorPaletteBerryBackground2)",colorPaletteBerryBackground3:"var(--colorPaletteBerryBackground3)",colorPaletteBerryBorderActive:"var(--colorPaletteBerryBorderActive)",colorPaletteBerryBorder1:"var(--colorPaletteBerryBorder1)",colorPaletteBerryBorder2:"var(--colorPaletteBerryBorder2)",colorPaletteBerryForeground1:"var(--colorPaletteBerryForeground1)",colorPaletteBerryForeground2:"var(--colorPaletteBerryForeground2)",colorPaletteBerryForeground3:"var(--colorPaletteBerryForeground3)",colorPaletteMarigoldBackground1:"var(--colorPaletteMarigoldBackground1)",colorPaletteMarigoldBackground2:"var(--colorPaletteMarigoldBackground2)",colorPaletteMarigoldBackground3:"var(--colorPaletteMarigoldBackground3)",colorPaletteMarigoldBorderActive:"var(--colorPaletteMarigoldBorderActive)",colorPaletteMarigoldBorder1:"var(--colorPaletteMarigoldBorder1)",colorPaletteMarigoldBorder2:"var(--colorPaletteMarigoldBorder2)",colorPaletteMarigoldForeground1:"var(--colorPaletteMarigoldForeground1)",colorPaletteMarigoldForeground2:"var(--colorPaletteMarigoldForeground2)",colorPaletteMarigoldForeground3:"var(--colorPaletteMarigoldForeground3)",colorPaletteLightGreenBackground1:"var(--colorPaletteLightGreenBackground1)",colorPaletteLightGreenBackground2:"var(--colorPaletteLightGreenBackground2)",colorPaletteLightGreenBackground3:"var(--colorPaletteLightGreenBackground3)",colorPaletteLightGreenBorderActive:"var(--colorPaletteLightGreenBorderActive)",colorPaletteLightGreenBorder1:"var(--colorPaletteLightGreenBorder1)",colorPaletteLightGreenBorder2:"var(--colorPaletteLightGreenBorder2)",colorPaletteLightGreenForeground1:"var(--colorPaletteLightGreenForeground1)",colorPaletteLightGreenForeground2:"var(--colorPaletteLightGreenForeground2)",colorPaletteLightGreenForeground3:"var(--colorPaletteLightGreenForeground3)",colorPaletteAnchorBackground2:"var(--colorPaletteAnchorBackground2)",colorPaletteAnchorBorderActive:"var(--colorPaletteAnchorBorderActive)",colorPaletteAnchorForeground2:"var(--colorPaletteAnchorForeground2)",colorPaletteBeigeBackground2:"var(--colorPaletteBeigeBackground2)",colorPaletteBeigeBorderActive:"var(--colorPaletteBeigeBorderActive)",colorPaletteBeigeForeground2:"var(--colorPaletteBeigeForeground2)",colorPaletteBlueBackground2:"var(--colorPaletteBlueBackground2)",colorPaletteBlueBorderActive:"var(--colorPaletteBlueBorderActive)",colorPaletteBlueForeground2:"var(--colorPaletteBlueForeground2)",colorPaletteBrassBackground2:"var(--colorPaletteBrassBackground2)",colorPaletteBrassBorderActive:"var(--colorPaletteBrassBorderActive)",colorPaletteBrassForeground2:"var(--colorPaletteBrassForeground2)",colorPaletteBrownBackground2:"var(--colorPaletteBrownBackground2)",colorPaletteBrownBorderActive:"var(--colorPaletteBrownBorderActive)",colorPaletteBrownForeground2:"var(--colorPaletteBrownForeground2)",colorPaletteCornflowerBackground2:"var(--colorPaletteCornflowerBackground2)",colorPaletteCornflowerBorderActive:"var(--colorPaletteCornflowerBorderActive)",colorPaletteCornflowerForeground2:"var(--colorPaletteCornflowerForeground2)",colorPaletteCranberryBackground2:"var(--colorPaletteCranberryBackground2)",colorPaletteCranberryBorderActive:"var(--colorPaletteCranberryBorderActive)",colorPaletteCranberryForeground2:"var(--colorPaletteCranberryForeground2)",colorPaletteDarkGreenBackground2:"var(--colorPaletteDarkGreenBackground2)",colorPaletteDarkGreenBorderActive:"var(--colorPaletteDarkGreenBorderActive)",colorPaletteDarkGreenForeground2:"var(--colorPaletteDarkGreenForeground2)",colorPaletteDarkRedBackground2:"var(--colorPaletteDarkRedBackground2)",colorPaletteDarkRedBorderActive:"var(--colorPaletteDarkRedBorderActive)",colorPaletteDarkRedForeground2:"var(--colorPaletteDarkRedForeground2)",colorPaletteForestBackground2:"var(--colorPaletteForestBackground2)",colorPaletteForestBorderActive:"var(--colorPaletteForestBorderActive)",colorPaletteForestForeground2:"var(--colorPaletteForestForeground2)",colorPaletteGoldBackground2:"var(--colorPaletteGoldBackground2)",colorPaletteGoldBorderActive:"var(--colorPaletteGoldBorderActive)",colorPaletteGoldForeground2:"var(--colorPaletteGoldForeground2)",colorPaletteGrapeBackground2:"var(--colorPaletteGrapeBackground2)",colorPaletteGrapeBorderActive:"var(--colorPaletteGrapeBorderActive)",colorPaletteGrapeForeground2:"var(--colorPaletteGrapeForeground2)",colorPaletteLavenderBackground2:"var(--colorPaletteLavenderBackground2)",colorPaletteLavenderBorderActive:"var(--colorPaletteLavenderBorderActive)",colorPaletteLavenderForeground2:"var(--colorPaletteLavenderForeground2)",colorPaletteLightTealBackground2:"var(--colorPaletteLightTealBackground2)",colorPaletteLightTealBorderActive:"var(--colorPaletteLightTealBorderActive)",colorPaletteLightTealForeground2:"var(--colorPaletteLightTealForeground2)",colorPaletteLilacBackground2:"var(--colorPaletteLilacBackground2)",colorPaletteLilacBorderActive:"var(--colorPaletteLilacBorderActive)",colorPaletteLilacForeground2:"var(--colorPaletteLilacForeground2)",colorPaletteMagentaBackground2:"var(--colorPaletteMagentaBackground2)",colorPaletteMagentaBorderActive:"var(--colorPaletteMagentaBorderActive)",colorPaletteMagentaForeground2:"var(--colorPaletteMagentaForeground2)",colorPaletteMinkBackground2:"var(--colorPaletteMinkBackground2)",colorPaletteMinkBorderActive:"var(--colorPaletteMinkBorderActive)",colorPaletteMinkForeground2:"var(--colorPaletteMinkForeground2)",colorPaletteNavyBackground2:"var(--colorPaletteNavyBackground2)",colorPaletteNavyBorderActive:"var(--colorPaletteNavyBorderActive)",colorPaletteNavyForeground2:"var(--colorPaletteNavyForeground2)",colorPalettePeachBackground2:"var(--colorPalettePeachBackground2)",colorPalettePeachBorderActive:"var(--colorPalettePeachBorderActive)",colorPalettePeachForeground2:"var(--colorPalettePeachForeground2)",colorPalettePinkBackground2:"var(--colorPalettePinkBackground2)",colorPalettePinkBorderActive:"var(--colorPalettePinkBorderActive)",colorPalettePinkForeground2:"var(--colorPalettePinkForeground2)",colorPalettePlatinumBackground2:"var(--colorPalettePlatinumBackground2)",colorPalettePlatinumBorderActive:"var(--colorPalettePlatinumBorderActive)",colorPalettePlatinumForeground2:"var(--colorPalettePlatinumForeground2)",colorPalettePlumBackground2:"var(--colorPalettePlumBackground2)",colorPalettePlumBorderActive:"var(--colorPalettePlumBorderActive)",colorPalettePlumForeground2:"var(--colorPalettePlumForeground2)",colorPalettePumpkinBackground2:"var(--colorPalettePumpkinBackground2)",colorPalettePumpkinBorderActive:"var(--colorPalettePumpkinBorderActive)",colorPalettePumpkinForeground2:"var(--colorPalettePumpkinForeground2)",colorPalettePurpleBackground2:"var(--colorPalettePurpleBackground2)",colorPalettePurpleBorderActive:"var(--colorPalettePurpleBorderActive)",colorPalettePurpleForeground2:"var(--colorPalettePurpleForeground2)",colorPaletteRoyalBlueBackground2:"var(--colorPaletteRoyalBlueBackground2)",colorPaletteRoyalBlueBorderActive:"var(--colorPaletteRoyalBlueBorderActive)",colorPaletteRoyalBlueForeground2:"var(--colorPaletteRoyalBlueForeground2)",colorPaletteSeafoamBackground2:"var(--colorPaletteSeafoamBackground2)",colorPaletteSeafoamBorderActive:"var(--colorPaletteSeafoamBorderActive)",colorPaletteSeafoamForeground2:"var(--colorPaletteSeafoamForeground2)",colorPaletteSteelBackground2:"var(--colorPaletteSteelBackground2)",colorPaletteSteelBorderActive:"var(--colorPaletteSteelBorderActive)",colorPaletteSteelForeground2:"var(--colorPaletteSteelForeground2)",colorPaletteTealBackground2:"var(--colorPaletteTealBackground2)",colorPaletteTealBorderActive:"var(--colorPaletteTealBorderActive)",colorPaletteTealForeground2:"var(--colorPaletteTealForeground2)",colorStatusSuccessBackground1:"var(--colorStatusSuccessBackground1)",colorStatusSuccessBackground2:"var(--colorStatusSuccessBackground2)",colorStatusSuccessBackground3:"var(--colorStatusSuccessBackground3)",colorStatusSuccessForeground1:"var(--colorStatusSuccessForeground1)",colorStatusSuccessForeground2:"var(--colorStatusSuccessForeground2)",colorStatusSuccessForeground3:"var(--colorStatusSuccessForeground3)",colorStatusSuccessForegroundInverted:"var(--colorStatusSuccessForegroundInverted)",colorStatusSuccessBorderActive:"var(--colorStatusSuccessBorderActive)",colorStatusSuccessBorder1:"var(--colorStatusSuccessBorder1)",colorStatusSuccessBorder2:"var(--colorStatusSuccessBorder2)",colorStatusWarningBackground1:"var(--colorStatusWarningBackground1)",colorStatusWarningBackground2:"var(--colorStatusWarningBackground2)",colorStatusWarningBackground3:"var(--colorStatusWarningBackground3)",colorStatusWarningForeground1:"var(--colorStatusWarningForeground1)",colorStatusWarningForeground2:"var(--colorStatusWarningForeground2)",colorStatusWarningForeground3:"var(--colorStatusWarningForeground3)",colorStatusWarningForegroundInverted:"var(--colorStatusWarningForegroundInverted)",colorStatusWarningBorderActive:"var(--colorStatusWarningBorderActive)",colorStatusWarningBorder1:"var(--colorStatusWarningBorder1)",colorStatusWarningBorder2:"var(--colorStatusWarningBorder2)",colorStatusDangerBackground1:"var(--colorStatusDangerBackground1)",colorStatusDangerBackground2:"var(--colorStatusDangerBackground2)",colorStatusDangerBackground3:"var(--colorStatusDangerBackground3)",colorStatusDangerBackground3Hover:"var(--colorStatusDangerBackground3Hover)",colorStatusDangerBackground3Pressed:"var(--colorStatusDangerBackground3Pressed)",colorStatusDangerForeground1:"var(--colorStatusDangerForeground1)",colorStatusDangerForeground2:"var(--colorStatusDangerForeground2)",colorStatusDangerForeground3:"var(--colorStatusDangerForeground3)",colorStatusDangerForegroundInverted:"var(--colorStatusDangerForegroundInverted)",colorStatusDangerBorderActive:"var(--colorStatusDangerBorderActive)",colorStatusDangerBorder1:"var(--colorStatusDangerBorder1)",colorStatusDangerBorder2:"var(--colorStatusDangerBorder2)",borderRadiusNone:"var(--borderRadiusNone)",borderRadiusSmall:"var(--borderRadiusSmall)",borderRadiusMedium:"var(--borderRadiusMedium)",borderRadiusLarge:"var(--borderRadiusLarge)",borderRadiusXLarge:"var(--borderRadiusXLarge)",borderRadiusCircular:"var(--borderRadiusCircular)",fontFamilyBase:"var(--fontFamilyBase)",fontFamilyMonospace:"var(--fontFamilyMonospace)",fontFamilyNumeric:"var(--fontFamilyNumeric)",fontSizeBase100:"var(--fontSizeBase100)",fontSizeBase200:"var(--fontSizeBase200)",fontSizeBase300:"var(--fontSizeBase300)",fontSizeBase400:"var(--fontSizeBase400)",fontSizeBase500:"var(--fontSizeBase500)",fontSizeBase600:"var(--fontSizeBase600)",fontSizeHero700:"var(--fontSizeHero700)",fontSizeHero800:"var(--fontSizeHero800)",fontSizeHero900:"var(--fontSizeHero900)",fontSizeHero1000:"var(--fontSizeHero1000)",fontWeightRegular:"var(--fontWeightRegular)",fontWeightMedium:"var(--fontWeightMedium)",fontWeightSemibold:"var(--fontWeightSemibold)",fontWeightBold:"var(--fontWeightBold)",lineHeightBase100:"var(--lineHeightBase100)",lineHeightBase200:"var(--lineHeightBase200)",lineHeightBase300:"var(--lineHeightBase300)",lineHeightBase400:"var(--lineHeightBase400)",lineHeightBase500:"var(--lineHeightBase500)",lineHeightBase600:"var(--lineHeightBase600)",lineHeightHero700:"var(--lineHeightHero700)",lineHeightHero800:"var(--lineHeightHero800)",lineHeightHero900:"var(--lineHeightHero900)",lineHeightHero1000:"var(--lineHeightHero1000)",shadow2:"var(--shadow2)",shadow4:"var(--shadow4)",shadow8:"var(--shadow8)",shadow16:"var(--shadow16)",shadow28:"var(--shadow28)",shadow64:"var(--shadow64)",shadow2Brand:"var(--shadow2Brand)",shadow4Brand:"var(--shadow4Brand)",shadow8Brand:"var(--shadow8Brand)",shadow16Brand:"var(--shadow16Brand)",shadow28Brand:"var(--shadow28Brand)",shadow64Brand:"var(--shadow64Brand)",strokeWidthThin:"var(--strokeWidthThin)",strokeWidthThick:"var(--strokeWidthThick)",strokeWidthThicker:"var(--strokeWidthThicker)",strokeWidthThickest:"var(--strokeWidthThickest)",spacingHorizontalNone:"var(--spacingHorizontalNone)",spacingHorizontalXXS:"var(--spacingHorizontalXXS)",spacingHorizontalXS:"var(--spacingHorizontalXS)",spacingHorizontalSNudge:"var(--spacingHorizontalSNudge)",spacingHorizontalS:"var(--spacingHorizontalS)",spacingHorizontalMNudge:"var(--spacingHorizontalMNudge)",spacingHorizontalM:"var(--spacingHorizontalM)",spacingHorizontalL:"var(--spacingHorizontalL)",spacingHorizontalXL:"var(--spacingHorizontalXL)",spacingHorizontalXXL:"var(--spacingHorizontalXXL)",spacingHorizontalXXXL:"var(--spacingHorizontalXXXL)",spacingVerticalNone:"var(--spacingVerticalNone)",spacingVerticalXXS:"var(--spacingVerticalXXS)",spacingVerticalXS:"var(--spacingVerticalXS)",spacingVerticalSNudge:"var(--spacingVerticalSNudge)",spacingVerticalS:"var(--spacingVerticalS)",spacingVerticalMNudge:"var(--spacingVerticalMNudge)",spacingVerticalM:"var(--spacingVerticalM)",spacingVerticalL:"var(--spacingVerticalL)",spacingVerticalXL:"var(--spacingVerticalXL)",spacingVerticalXXL:"var(--spacingVerticalXXL)",spacingVerticalXXXL:"var(--spacingVerticalXXXL)",durationUltraFast:"var(--durationUltraFast)",durationFaster:"var(--durationFaster)",durationFast:"var(--durationFast)",durationNormal:"var(--durationNormal)",durationGentle:"var(--durationGentle)",durationSlow:"var(--durationSlow)",durationSlower:"var(--durationSlower)",durationUltraSlow:"var(--durationUltraSlow)",curveAccelerateMax:"var(--curveAccelerateMax)",curveAccelerateMid:"var(--curveAccelerateMid)",curveAccelerateMin:"var(--curveAccelerateMin)",curveDecelerateMax:"var(--curveDecelerateMax)",curveDecelerateMid:"var(--curveDecelerateMid)",curveDecelerateMin:"var(--curveDecelerateMin)",curveEasyEaseMax:"var(--curveEasyEaseMax)",curveEasyEase:"var(--curveEasyEase)",curveLinear:"var(--curveLinear)",zIndexBackground:"var(--zIndexBackground, 0)",zIndexContent:"var(--zIndexContent, 1)",zIndexOverlay:"var(--zIndexOverlay, 1000)",zIndexPopup:"var(--zIndexPopup, 2000)",zIndexMessages:"var(--zIndexMessages, 3000)",zIndexFloating:"var(--zIndexFloating, 4000)",zIndexPriority:"var(--zIndexPriority, 5000)",zIndexDebug:"var(--zIndexDebug, 6000)"}},84448:(e,t,n)=>{"use strict";n.d(t,{j:()=>i});var r=n(51055),i=function(){function e(e,t){this._timeoutIds=null,this._immediateIds=null,this._intervalIds=null,this._animationFrameIds=null,this._isDisposed=!1,this._parent=e||null,this._onErrorHandler=t,this._noop=function(){}}return e.prototype.dispose=function(){var e;if(this._isDisposed=!0,this._parent=null,this._timeoutIds){for(e in this._timeoutIds)this._timeoutIds.hasOwnProperty(e)&&this.clearTimeout(parseInt(e,10));this._timeoutIds=null}if(this._immediateIds){for(e in this._immediateIds)this._immediateIds.hasOwnProperty(e)&&this.clearImmediate(parseInt(e,10));this._immediateIds=null}if(this._intervalIds){for(e in this._intervalIds)this._intervalIds.hasOwnProperty(e)&&this.clearInterval(parseInt(e,10));this._intervalIds=null}if(this._animationFrameIds){for(e in this._animationFrameIds)this._animationFrameIds.hasOwnProperty(e)&&this.cancelAnimationFrame(parseInt(e,10));this._animationFrameIds=null}},e.prototype.setTimeout=function(e,t){var n=this,r=0;return this._isDisposed||(this._timeoutIds||(this._timeoutIds={}),r=setTimeout((function(){try{n._timeoutIds&&delete n._timeoutIds[r],e.apply(n._parent)}catch(e){n._logError(e)}}),t),this._timeoutIds[r]=!0),r},e.prototype.clearTimeout=function(e){this._timeoutIds&&this._timeoutIds[e]&&(clearTimeout(e),delete this._timeoutIds[e])},e.prototype.setImmediate=function(e,t){var n=this,i=0,o=(0,r.z)(t);return this._isDisposed||(this._immediateIds||(this._immediateIds={}),i=o.setTimeout((function(){try{n._immediateIds&&delete n._immediateIds[i],e.apply(n._parent)}catch(e){n._logError(e)}}),0),this._immediateIds[i]=!0),i},e.prototype.clearImmediate=function(e,t){var n=(0,r.z)(t);this._immediateIds&&this._immediateIds[e]&&(n.clearTimeout(e),delete this._immediateIds[e])},e.prototype.setInterval=function(e,t){var n=this,r=0;return this._isDisposed||(this._intervalIds||(this._intervalIds={}),r=setInterval((function(){try{e.apply(n._parent)}catch(e){n._logError(e)}}),t),this._intervalIds[r]=!0),r},e.prototype.clearInterval=function(e){this._intervalIds&&this._intervalIds[e]&&(clearInterval(e),delete this._intervalIds[e])},e.prototype.throttle=function(e,t,n){var r=this;if(this._isDisposed)return this._noop;var i,o,a=t||0,s=!0,l=!0,d=0,u=null;n&&"boolean"==typeof n.leading&&(s=n.leading),n&&"boolean"==typeof n.trailing&&(l=n.trailing);var c=function(t){var n=Date.now(),g=n-d,h=s?a-g:a;return g>=a&&(!t||s)?(d=n,u&&(r.clearTimeout(u),u=null),i=e.apply(r._parent,o)):null===u&&l&&(u=r.setTimeout(c,h)),i};return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o=e,c(!0)}},e.prototype.debounce=function(e,t,n){var r=this;if(this._isDisposed){var i=function(){};return i.cancel=function(){},i.flush=function(){return null},i.pending=function(){return!1},i}var o,a,s=t||0,l=!1,d=!0,u=null,c=0,g=Date.now(),h=null;n&&"boolean"==typeof n.leading&&(l=n.leading),n&&"boolean"==typeof n.trailing&&(d=n.trailing),n&&"number"==typeof n.maxWait&&!isNaN(n.maxWait)&&(u=n.maxWait);var p=function(e){h&&(r.clearTimeout(h),h=null),g=e},f=function(t){p(t),o=e.apply(r._parent,a)},v=function(e){var t=Date.now(),n=!1;e&&(l&&t-c>=s&&(n=!0),c=t);var i=t-c,a=s-i,p=t-g,m=!1;return null!==u&&(p>=u&&h?m=!0:a=Math.min(a,u-p)),i>=s||m||n?f(t):null!==h&&e||!d||(h=r.setTimeout(v,a)),o},m=function(){return!!h},y=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a=e,v(!0)};return y.cancel=function(){m()&&p(Date.now())},y.flush=function(){return m()&&f(Date.now()),o},y.pending=m,y},e.prototype.requestAnimationFrame=function(e,t){var n=this,i=0,o=(0,r.z)(t);if(!this._isDisposed){this._animationFrameIds||(this._animationFrameIds={});var a=function(){try{n._animationFrameIds&&delete n._animationFrameIds[i],e.apply(n._parent)}catch(e){n._logError(e)}};i=o.requestAnimationFrame?o.requestAnimationFrame(a):o.setTimeout(a,0),this._animationFrameIds[i]=!0}return i},e.prototype.cancelAnimationFrame=function(e,t){var n=(0,r.z)(t);this._animationFrameIds&&this._animationFrameIds[e]&&(n.cancelAnimationFrame?n.cancelAnimationFrame(e):n.clearTimeout(e),delete this._animationFrameIds[e])},e.prototype._logError=function(e){this._onErrorHandler&&this._onErrorHandler(e)},e}()},43376:(e,t,n)=>{"use strict";n.d(t,{N:()=>o});var r=n(95734),i=n(17565),o=function(e){var t=e.providerRef,n=e.layerRoot,o=r.useState([])[0],a=r.useContext(i.dM),s=void 0!==a&&!n,l=r.useMemo((function(){return s?void 0:{providerRef:t,registeredProviders:o,registerProvider:function(e){o.push(e),null==a||a.registerProvider(e)},unregisterProvider:function(e){null==a||a.unregisterProvider(e);var t=o.indexOf(e);t>=0&&o.splice(t,1)}}}),[t,o,a,s]);return r.useEffect((function(){if(l)return l.registerProvider(l.providerRef),function(){return l.unregisterProvider(l.providerRef)}}),[l]),l?r.createElement(i.dM.Provider,{value:l},e.children):r.createElement(r.Fragment,null,e.children)}},33732:(e,t,n)=>{"use strict";n.d(t,{h:()=>s});var r=n(51055),i="__globalSettings__",o="__callbacks__",a=0,s=function(){function e(){}return e.getValue=function(e,t){var n=l();return void 0===n[e]&&(n[e]="function"==typeof t?t():t),n[e]},e.setValue=function(e,t){var n=l(),r=n[o],i=n[e];if(t!==i){n[e]=t;var a={oldValue:i,value:t,key:e};for(var s in r)r.hasOwnProperty(s)&&r[s](a)}return t},e.addChangeListener=function(e){var t=e.__id__,n=d();t||(t=e.__id__=String(a++)),n[t]=e},e.removeChangeListener=function(e){delete d()[e.__id__]},e}();function l(){var e,t=(0,r.z)()||{};return t[i]||(t[i]=((e={})[o]={},e)),t[i]}function d(){return l()[o]}},23597:(e,t,n)=>{"use strict";n.d(t,{c:()=>r});var r={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pauseBreak:19,capslock:20,escape:27,space:32,pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,del:46,zero:48,one:49,two:50,three:51,four:52,five:53,six:54,seven:55,eight:56,nine:57,colon:58,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,leftWindow:91,rightWindow:92,select:93,zero_numpad:96,one_numpad:97,two_numpad:98,three_numpad:99,four_numpad:100,five_numpad:101,six_numpad:102,seven_numpad:103,eight_numpad:104,nine_numpad:105,multiply:106,add:107,subtract:109,decimalPoint:110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numlock:144,scrollLock:145,semicolon:186,equalSign:187,comma:188,dash:189,period:190,forwardSlash:191,graveAccent:192,openBracket:219,backSlash:220,closeBracket:221,singleQuote:222}},64525:(e,t,n)=>{"use strict";n.d(t,{M:()=>r});var r=function(){function e(e,t,n,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=0),this.top=n,this.bottom=r,this.left=e,this.right=t}return Object.defineProperty(e.prototype,"width",{get:function(){return this.right-this.left},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.bottom-this.top},enumerable:!1,configurable:!0}),e.prototype.equals=function(e){return parseFloat(this.top.toFixed(4))===parseFloat(e.top.toFixed(4))&&parseFloat(this.bottom.toFixed(4))===parseFloat(e.bottom.toFixed(4))&&parseFloat(this.left.toFixed(4))===parseFloat(e.left.toFixed(4))&&parseFloat(this.right.toFixed(4))===parseFloat(e.right.toFixed(4))},e}()},53486:(e,t,n)=>{"use strict";n.d(t,{Z:()=>g});var r=n(83702),i=n(68678),o=n(97874),a=n(51055),s=50,l=5,d=0,u=r.nr.getInstance();u&&u.onReset&&u.onReset((function(){return d++}));var c="__retval__";function g(e){void 0===e&&(e={});var t=new Map,n=0,r=0,u=d;return function(g,h){var f;if(void 0===h&&(h={}),e.useStaticStyles&&"function"==typeof g&&g.__noStyleOverride__)return g(h);r++;var v=g?g.__shadowConfig__:void 0,m=v&&v.window?v.window:"__default__";t.has(m)||t.set(m,new Map);var y=t.get(m),_=h.theme,b=_&&void 0!==_.rtl?_.rtl:(0,o.jI)(),C=e.disableCaching;if(u!==d&&(u=d,t.set(m,new Map),y=t.get(m),n=0),e.disableCaching||(y=p(t.get(m),g),y=p(y,h)),!C&&y[c]||(y[c]=void 0===g?{}:(0,i.L)(["function"==typeof g?g(h):g],{shadowConfig:g.__shadowConfig__,rtl:!!b,specificityMultiplier:e.useStaticStyles?l:void 0}),C||n++),n>(e.cacheSize||s)){var S=(0,a.z)();(null===(f=null==S?void 0:S.FabricConfig)||void 0===f?void 0:f.enableClassNameCacheFullWarning)&&(console.warn("Styles are being recalculated too frequently. Cache miss rate is ".concat(n,"/").concat(r,".")),console.trace()),t.get(m).clear(),n=0,e.disableCaching=!0}return y[c]}}function h(e,t){return t=function(e){switch(e){case void 0:return"__undefined__";case null:return"__null__";default:return e}}(t),e.has(t)||e.set(t,new Map),e.get(t)}function p(e,t){if("function"==typeof t)if(t.__cachedInputs__)for(var n=0,r=t.__cachedInputs__;n<r.length;n++)e=h(e,r[n]);else e=h(e,t);else if("object"==typeof t)for(var i in t)t.hasOwnProperty(i)&&(e=h(e,t[i]));return e}},72195:(e,t,n)=>{"use strict";function r(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=[],r=0,i=e;r<i.length;r++){var o=i[r];if(o)if("string"==typeof o)n.push(o);else if(o.hasOwnProperty("toString")&&"function"==typeof o.toString)n.push(o.toString());else for(var a in o)o[a]&&n.push(a)}return n.join(" ")}n.d(t,{A:()=>r})},97061:(e,t,n)=>{"use strict";n.d(t,{X:()=>l});var r=n(30206),i=n(33732),o={settings:{},scopedSettings:{},inCustomizerContext:!1},a=i.h.getValue("customizations",{settings:{},scopedSettings:{},inCustomizerContext:!1}),s=[],l=function(){function e(){}return e.reset=function(){a.settings={},a.scopedSettings={}},e.applySettings=function(t){a.settings=(0,r.__assign)((0,r.__assign)({},a.settings),t),e._raiseChange()},e.applyScopedSettings=function(t,n){a.scopedSettings[t]=(0,r.__assign)((0,r.__assign)({},a.scopedSettings[t]),n),e._raiseChange()},e.getSettings=function(e,t,n){void 0===n&&(n=o);for(var r={},i=t&&n.scopedSettings[t]||{},s=t&&a.scopedSettings[t]||{},l=0,d=e;l<d.length;l++){var u=d[l];r[u]=i[u]||n.settings[u]||s[u]||a.settings[u]}return r},e.applyBatchedUpdates=function(t,n){e._suppressUpdates=!0;try{t()}catch(e){}e._suppressUpdates=!1,n||e._raiseChange()},e.observe=function(e){s.push(e)},e.unobserve=function(e){s=s.filter((function(t){return t!==e}))},e._raiseChange=function(){e._suppressUpdates||s.forEach((function(e){return e()}))},e}()},13537:(e,t,n)=>{"use strict";n.d(t,{z:()=>r});var r=n(95734).createContext({customizations:{inCustomizerContext:!1,settings:{},scopedSettings:{}}})},91850:(e,t,n)=>{"use strict";n.d(t,{m:()=>a});var r=n(95734),i=n(97061),o=n(13537);function a(e,t){var n,a=(n=r.useState(0)[1],function(){return n((function(e){return++e}))}),s=r.useContext(o.z).customizations,l=s.inCustomizerContext;return r.useEffect((function(){return l||i.X.observe(a),function(){l||i.X.unobserve(a)}}),[l]),i.X.getSettings(e,t,s)}},35232:(e,t,n)=>{"use strict";function r(){return"undefined"!=typeof window&&!(!window.document||!window.document.createElement)}n.d(t,{S:()=>r})},98414:(e,t,n)=>{"use strict";n.d(t,{Y:()=>i});var r=n(35232);function i(e){if((0,r.S)()&&"undefined"!=typeof document){var t=e;return t&&t.ownerDocument?t.ownerDocument:document}}},51055:(e,t,n)=>{"use strict";n.d(t,{z:()=>o});var r=n(35232),i=void 0;try{i=window}catch(e){}function o(e){if((0,r.S)()&&void 0!==i){var t=e;return t&&t.ownerDocument&&t.ownerDocument.defaultView?t.ownerDocument.defaultView:i}}},14394:(e,t,n)=>{"use strict";function r(e,t,n,r){return e.addEventListener(t,n,r),function(){return e.removeEventListener(t,n,r)}}n.d(t,{on:()=>r})},84931:(e,t,n)=>{"use strict";n.d(t,{SE:()=>I,lo:()=>x,vO:()=>v,Ep:()=>D,j5:()=>g,oR:()=>p,nA:()=>A,dm:()=>h,Cm:()=>f,eX:()=>y,yv:()=>m,Z5:()=>T,HC:()=>S,S0:()=>C,F2:()=>b,_l:()=>w});var r=n(97951),i=n(17875),o=n(30915),a=n(51055),s=n(98414),l="data-is-focusable",d="data-is-visible",u="data-focuszone-id",c="data-is-sub-focuszone";function g(e,t,n,r){return y(e,t,!0,!1,!1,n,void 0,void 0,void 0,r)}function h(e,t,n,r){return m(e,t,!0,!1,!0,n,void 0,void 0,r)}function p(e,t,n,r,i){return void 0===r&&(r=!0),y(e,t,r,!1,!1,n,!1,!0,void 0,i)}function f(e,t,n,r,i){return void 0===r&&(r=!0),m(e,t,r,!1,!0,n,!1,!0,i)}function v(e,t,n){var r=y(e,e,!0,!1,!1,!0,void 0,void 0,t,n);return!!r&&(x(r),!0)}function m(e,t,n,r,i,o,a,s,l){var d;if(!t||!a&&t===e)return null;var u=_(t);if(i&&u&&(o||!S(t)&&!T(t))){var c=m(e,t.lastElementChild||l&&(null===(d=t.shadowRoot)||void 0===d?void 0:d.lastElementChild),!0,!0,!0,o,a,s,l);if(c){if(s&&C(c,!0,l)||!s)return c;var g=m(e,c.previousElementSibling,!0,!0,!0,o,a,s,l);if(g)return g;for(var h=c.parentElement;h&&h!==t;){var p=m(e,h.previousElementSibling,!0,!0,!0,o,a,s,l);if(p)return p;h=h.parentElement}}}return n&&u&&C(t,s,l)?t:m(e,t.previousElementSibling,!0,!0,!0,o,a,s,l)||(r?null:m(e,t.parentElement,!0,!1,!1,o,a,s,l))}function y(e,t,n,r,i,o,a,s,l,d){var u;if(!t||t===e&&i&&!a)return null;var c=(l?b:_)(t);if(n&&c&&C(t,s,d))return t;if(!i&&c&&(o||!S(t)&&!T(t))){var g=y(e,t.firstElementChild||d&&(null===(u=t.shadowRoot)||void 0===u?void 0:u.firstElementChild),!0,!0,!1,o,a,s,l,d);if(g)return g}return t===e?null:y(e,t.nextElementSibling,!0,!0,!1,o,a,s,l,d)||(r?null:y(e,t.parentElement,!1,!1,!0,o,a,s,l,d))}function _(e){if(!e||!e.getAttribute)return!1;var t=e.getAttribute(d);return null!=t?"true"===t:0!==e.offsetHeight||null!==e.offsetParent||!0===e.isVisible}function b(e,t){var n=null!=t?t:(0,a.z)();return!!e&&_(e)&&!e.hidden&&"hidden"!==n.getComputedStyle(e).visibility}function C(e,t,n){if(void 0===n&&(n=!0),!e||e.disabled)return!1;var r=0,i=null;e&&e.getAttribute&&(i=e.getAttribute("tabIndex"))&&(r=parseInt(i,10));var o=e.getAttribute?e.getAttribute(l):null,a=null!==i&&r>=0,s=!(!n||!e.shadowRoot||!e.shadowRoot.delegatesFocus),d=!!e&&"false"!==o&&("A"===e.tagName||"BUTTON"===e.tagName||"INPUT"===e.tagName||"TEXTAREA"===e.tagName||"SELECT"===e.tagName||"true"===o||a||s);return t?-1!==r&&d:d}function S(e){return!!(e&&e.getAttribute&&e.getAttribute(u))}function T(e){return!(!e||!e.getAttribute||"true"!==e.getAttribute(c))}function I(e){var t=(0,s.Y)(e),n=t&&t.activeElement;return!(!n||!(0,i.s)(e,n))}function w(e,t,n){return"true"!==function(e,t,n){var i=(0,r.w)(e,(function(e){return e.hasAttribute(t)}),n);return i&&i.getAttribute(t)}(e,t,null!=n?n:(0,s.Y)())}var E=void 0;function x(e){if(e){var t=(0,a.z)(e);t&&(void 0!==E&&t.cancelAnimationFrame(E),E=t.requestAnimationFrame((function(){e&&e.focus(),E=void 0})))}}function A(e,t){for(var n=e,r=0,i=t;r<i.length;r++){var o=i[r],a=n.children[Math.min(o,n.children.length-1)];if(!a)break;n=a}return C(n)&&_(n)?n:y(e,n,!0)||m(e,n)}function D(e,t){for(var n=[];t&&e&&t!==e;){var r=(0,o.P)(t,!0);if(null===r)return[];n.unshift(Array.prototype.indexOf.call(r.children,t)),t=r}return n}},12609:(e,t,n)=>{"use strict";n.d(t,{O:()=>d});var r=n(51055),i=n(83702),o="__currentId__",a="id__",s=(0,r.z)()||{};void 0===s[o]&&(s[o]=0);var l=!1;function d(e){if(!l){var t=i.nr.getInstance();t&&t.onReset&&t.onReset(u),l=!0}var n=s[o]++;return(void 0===e?a:e)+n}function u(e){void 0===e&&(e=0),s[o]=e}},40890:(e,t,n)=>{"use strict";n.d(t,{N:()=>i});var r=n(30206);function i(e,t){for(var n=(0,r.__assign)({},t),i=0,o=Object.keys(e);i<o.length;i++){var a=o[i];void 0===n[a]&&(n[a]=e[a])}return n}},94991:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var r,i=n(98414),o=n(51055),a=n(76183),s="language";function l(e){if(void 0===e&&(e="sessionStorage"),void 0===r){var t=(0,i.Y)(),n="localStorage"===e?function(e){var t=null;try{var n=(0,o.z)();t=n?n.localStorage.getItem(e):null}catch(e){}return t}(s):"sessionStorage"===e?a.G(s):void 0;n&&(r=n),void 0===r&&t&&(r=t.documentElement.getAttribute("lang")),void 0===r&&(r="en")}return r}},92420:(e,t,n)=>{"use strict";n.d(t,{J5:()=>c,J9:()=>u});var r=n(83702),i=!1,o=0,a={empty:!0},s={},l="undefined"==typeof WeakMap?null:WeakMap;function d(){o++}function u(e,t,n){if(void 0===t&&(t=100),void 0===n&&(n=!1),!l)return e;if(!i){var u=r.nr.getInstance();u&&u.onReset&&r.nr.getInstance().onReset(d),i=!0}var c,h=0,p=o;return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var l,d=c;(void 0===c||p!==o||t>0&&h>t)&&(c=g(),h=0,p=o),d=c;for(var u=0;u<r.length;u++){var f=(l=r[u])?"object"==typeof l||"function"==typeof l?l:(s[l]||(s[l]={val:l}),s[l]):a;d.map.has(f)||d.map.set(f,g()),d=d.map.get(f)}return d.hasOwnProperty("value")||(d.value=e.apply(void 0,r),h++),!n||null!==d.value&&void 0!==d.value||(d.value=e.apply(void 0,r)),d.value}}function c(e){if(!l)return e;var t=new l;return function(n){if(!n||"function"!=typeof n&&"object"!=typeof n)return e(n);if(t.has(n))return t.get(n);var r=e(n);return t.set(n,r),r}}function g(){return{map:l?new l:null}}},21608:(e,t,n)=>{"use strict";function r(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0,o=t;r<o.length;r++)i(e||{},o[r]);return e}function i(e,t,n){for(var r in void 0===n&&(n=[]),n.push(t),t)if(t.hasOwnProperty(r)&&"__proto__"!==r&&"constructor"!==r&&"prototype"!==r){var o=t[r];if("object"!=typeof o||null===o||Array.isArray(o))e[r]=o;else{var a=n.indexOf(o)>-1;e[r]=a?o:i(e[r]||{},o,n)}}return n.pop(),e}n.d(t,{h:()=>r})},72203:(e,t,n)=>{"use strict";n.d(t,{q:()=>o});var r=n(98414),i=["TEMPLATE","STYLE","SCRIPT"];function o(e){var t=(0,r.Y)(e);if(!t)return function(){};for(var n=[];e!==t.body&&e.parentElement;){for(var o=0,a=e.parentElement.children;o<a.length;o++){var s=a[o],l=s.getAttribute("aria-hidden");s!==e&&"true"!==(null==l?void 0:l.toLowerCase())&&-1===i.indexOf(s.tagName)&&n.push([s,l])}e=e.parentElement}return n.forEach((function(e){e[0].setAttribute("aria-hidden","true")})),function(){!function(e){e.forEach((function(e){var t=e[0],n=e[1];n?t.setAttribute("aria-hidden",n):t.removeAttribute("aria-hidden")}))}(n),n=[]}}},6753:(e,t,n)=>{"use strict";function r(e,t){if(!e||!t)return!e&&!t;for(var n in e)if(e.hasOwnProperty(n)&&(!t.hasOwnProperty(n)||t[n]!==e[n]))return!1;for(var n in t)if(t.hasOwnProperty(n)&&!e.hasOwnProperty(n))return!1;return!0}function i(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return o.apply(this,[null,e].concat(t))}function o(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];t=t||{};for(var i=0,o=n;i<o.length;i++){var a=o[i];if(a)for(var s in a)!a.hasOwnProperty(s)||e&&!e(s)||(t[s]=a[s])}return t}function a(e,t){var n={};for(var r in e)-1===t.indexOf(r)&&e.hasOwnProperty(r)&&(n[r]=e[r]);return n}n.d(t,{ab:()=>r,cJ:()=>a,kp:()=>i})},90503:(e,t,n)=>{"use strict";n.d(t,{Cq:()=>v,Cs:()=>w,Fo:()=>d,G1:()=>A,Gp:()=>I,JM:()=>x,P4:()=>c,QQ:()=>p,Qf:()=>T,Sg:()=>l,Sh:()=>f,al:()=>y,cr:()=>b,g0:()=>_,k3:()=>C,lA:()=>S,p3:()=>u,q6:()=>s,t0:()=>g,tK:()=>m,uw:()=>h,vt:()=>a,xM:()=>E});var r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n={},r=0,i=e;r<i.length;r++)for(var o=i[r],a=0,s=Array.isArray(o)?o:Object.keys(o);a<s.length;a++)n[s[a]]=1;return n},i=r(["onCopy","onCut","onPaste","onCompositionEnd","onCompositionStart","onCompositionUpdate","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onInput","onSubmit","onLoad","onError","onKeyDown","onKeyDownCapture","onKeyPress","onKeyUp","onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting","onClick","onClickCapture","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onMouseUpCapture","onSelect","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onScroll","onWheel","onPointerCancel","onPointerDown","onPointerEnter","onPointerLeave","onPointerMove","onPointerOut","onPointerOver","onPointerUp","onGotPointerCapture","onLostPointerCapture"]),o=r(["accessKey","children","className","contentEditable","dir","draggable","hidden","htmlFor","id","lang","ref","role","style","tabIndex","title","translate","spellCheck","name"]),a=r(o,i),s=r(a,["form"]),l=r(a,["height","loop","muted","preload","src","width"]),d=r(l,["poster"]),u=r(a,["start"]),c=r(a,["value"]),g=r(a,["download","href","hrefLang","media","rel","target","type"]),h=r(a,["autoFocus","disabled","form","formAction","formEncType","formMethod","formNoValidate","formTarget","type","value"]),p=r(h,["accept","alt","autoCapitalize","autoComplete","checked","dirname","form","height","inputMode","list","max","maxLength","min","minLength","multiple","pattern","placeholder","readOnly","required","src","step","size","type","value","width"]),f=r(h,["autoCapitalize","cols","dirname","form","maxLength","minLength","placeholder","readOnly","required","rows","wrap"]),v=r(h,["form","multiple","required"]),m=r(a,["selected","value"]),y=r(a,["cellPadding","cellSpacing"]),_=a,b=r(a,["rowSpan","scope"]),C=r(a,["colSpan","headers","rowSpan","scope"]),S=r(a,["span"]),T=r(a,["span"]),I=r(a,["acceptCharset","action","encType","encType","method","noValidate","target"]),w=r(a,["allow","allowFullScreen","allowPaymentRequest","allowTransparency","csp","height","importance","referrerPolicy","sandbox","src","srcDoc","width"]),E=r(a,["alt","crossOrigin","height","src","srcSet","useMap","width"]),x=a;function A(e,t,n){for(var r=Array.isArray(t),i={},o=0,a=Object.keys(e);o<a.length;o++){var s=a[o];!(!r&&t[s]||r&&t.indexOf(s)>=0||0===s.indexOf("data-")||0===s.indexOf("aria-"))||n&&-1!==(null==n?void 0:n.indexOf(s))||(i[s]=e[s])}return i}},97874:(e,t,n)=>{"use strict";n.d(t,{jI:()=>l});var r,i=n(98414),o=n(76183),a=n(38106),s="isRTL";function l(e){if(void 0===e&&(e={}),void 0!==e.rtl)return e.rtl;if(void 0===r){var t=(0,o.G)(s);null!==t&&function(e,t){void 0===t&&(t=!1);var n=(0,i.Y)();n&&n.documentElement.setAttribute("dir",e?"rtl":"ltr"),t&&(0,o.S)(s,e?"1":"0"),r=e,(0,a.DU)(r)}(r="1"===t);var n=(0,i.Y)();void 0===r&&n&&(r="rtl"===(n.body&&n.body.getAttribute("dir")||n.documentElement.getAttribute("dir")),(0,a.DU)(r))}return!!r}},14759:(e,t,n)=>{"use strict";n.d(t,{Hc:()=>d,XJ:()=>l});var r,i=n(98414),o=n(48614),a=n(51055),s=((0,o.Z)({overflow:"hidden !important"}),"data-is-scrollable");function l(e){if(void 0===r){var t=null!=e?e:(0,i.Y)(),n=t.createElement("div");n.style.setProperty("width","100px"),n.style.setProperty("height","100px"),n.style.setProperty("overflow","scroll"),n.style.setProperty("position","absolute"),n.style.setProperty("top","-9999px"),t.body.appendChild(n),r=n.offsetWidth-n.clientWidth,t.body.removeChild(n)}return r}function d(e){for(var t=e,n=(0,i.Y)(e);t&&t!==n.body;){if("true"===t.getAttribute(s))return t;t=t.parentElement}for(t=e;t&&t!==n.body;){if("false"!==t.getAttribute(s)){var r=getComputedStyle(t),o=r?r.getPropertyValue("overflow-y"):"";if(o&&("scroll"===o||"auto"===o))return t}t=t.parentElement}return t&&t!==n.body||(t=(0,a.z)(e)),t}},76183:(e,t,n)=>{"use strict";n.d(t,{G:()=>i,S:()=>o});var r=n(51055);function i(e){var t=null;try{var n=(0,r.z)();t=n?n.sessionStorage.getItem(e):null}catch(e){}return t}function o(e,t){var n;try{null===(n=(0,r.z)())||void 0===n||n.sessionStorage.setItem(e,t)}catch(e){}}},33594:(e,t,n)=>{"use strict";n.d(t,{Fy:()=>s,Y2:()=>i});var r=n(51055),i="ms-Fabric--isFocusVisible",o="ms-Fabric--isFocusHidden";function a(e,t){e&&(e.classList.add(t?i:o),e.classList.remove(t?o:i))}function s(e,t,n){var i;n?n.forEach((function(t){return a(t.current,e)})):a(null===(i=(0,r.z)(t))||void 0===i?void 0:i.document.body,e)}},92405:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var r=n(95734),i=n(31860),o=function(){return!1},a=function(){},s=r.createContext({stylesheets:new Map,useAdoptedStylesheetEx:o,useAdoptedStylesheet:o,useShadowConfig:function(){return i.ou},useMergeStylesShadowRootContext:a,useHasMergeStylesShadowRootContext:o,useMergeStylesRootStylesheets:function(){return new Map},useWindow:a,useStyled:a}),l=function(){var e=r.useContext(s);return{useAdoptedStylesheet:e.useAdoptedStylesheet,useAdoptedStylesheetEx:e.useAdoptedStylesheetEx,useShadowConfig:e.useShadowConfig,useMergeStylesShadowRootContext:e.useMergeStylesShadowRootContext,useHasMergeStylesShadowRootContext:e.useHasMergeStylesShadowRootContext,useMergeStylesRootStylesheets:e.useMergeStylesRootStylesheets,useWindow:e.useWindow,useStyled:e.useStyled}}},18629:(e,t,n)=>{"use strict";n.d(t,{I:()=>d});var r=n(30206),i=n(95734),o=n(17596),a=n(92405),s=n(91850),l=["theme","styles"];function d(e,t,n,d,u){var c=(d=d||{scope:"",fields:void 0}).scope,g=d.fields,h=void 0===g?l:g,p=i.forwardRef((function(l,d){var u=i.useRef(),g=(0,s.m)(h,c),p=g.styles,f=(g.dir,(0,r.__rest)(g,["styles","dir"])),v=n?n(l):void 0,m=(0,a.A)().useStyled,y=u.current&&u.current.__cachedInputs__||[],_=l.styles;if(!u.current||p!==y[1]||_!==y[2]){var b=function(e){return(0,o.p)(e,t,p,_)};b.__cachedInputs__=[t,p,_],b.__noStyleOverride__=!p&&!_,u.current=b}return u.current.__shadowConfig__=m(c),i.createElement(e,(0,r.__assign)({ref:d},f,v,l,{styles:u.current}))}));p.displayName="Styled".concat(e.displayName||e.name);var f=u?i.memo(p):p;return p.displayName&&(f.displayName=p.displayName),f}},17565:(e,t,n)=>{"use strict";n.d(t,{MO:()=>f,dM:()=>p});var r,i=n(95734),o=n(51055),a=n(23597),s=((r={})[a.c.up]=1,r[a.c.down]=1,r[a.c.left]=1,r[a.c.right]=1,r[a.c.home]=1,r[a.c.end]=1,r[a.c.tab]=1,r[a.c.pageUp]=1,r[a.c.pageDown]=1,r);function l(e){return!!s[e]}var d=n(33594),u=new WeakMap,c=new WeakMap;function g(e,t){var n,r=u.get(e);return n=r?r+t:1,u.set(e,n),n}function h(e){var t=c.get(e);return t||(t={onMouseDown:function(t){return v(t,e.registeredProviders)},onPointerDown:function(t){return m(t,e.registeredProviders)},onKeyDown:function(t){return y(t,e.registeredProviders)},onKeyUp:function(t){return _(t,e.registeredProviders)}},c.set(e,t),t)}var p=i.createContext(void 0),f=function(e){var t,n;return t=e.rootRef,n=i.useContext(p),i.useEffect((function(){var e,r,i,a,s=(0,o.z)(null==t?void 0:t.current);if(s&&!0!==(null===(e=s.FabricConfig)||void 0===e?void 0:e.disableFocusRects)){var l,d,u,c,p=s;if((null===(r=null==n?void 0:n.providerRef)||void 0===r?void 0:r.current)&&(null===(a=null===(i=null==n?void 0:n.providerRef)||void 0===i?void 0:i.current)||void 0===a?void 0:a.addEventListener)){p=n.providerRef.current;var f=h(n);l=f.onMouseDown,d=f.onPointerDown,u=f.onKeyDown,c=f.onKeyUp}else l=v,d=m,u=y,c=_;var b=g(p,1);return b<=1&&(p.addEventListener("mousedown",l,!0),p.addEventListener("pointerdown",d,!0),p.addEventListener("keydown",u,!0),p.addEventListener("keyup",c,!0)),function(){var e;s&&!0!==(null===(e=s.FabricConfig)||void 0===e?void 0:e.disableFocusRects)&&0===(b=g(p,-1))&&(p.removeEventListener("mousedown",l,!0),p.removeEventListener("pointerdown",d,!0),p.removeEventListener("keydown",u,!0),p.removeEventListener("keyup",c,!0))}}}),[n,t]),null};function v(e,t){(0,d.Fy)(!1,e.target,t)}function m(e,t){"mouse"!==e.pointerType&&(0,d.Fy)(!1,e.target,t)}function y(e,t){l(e.which)&&(0,d.Fy)(!0,e.target,t)}function _(e,t){l(e.which)&&(0,d.Fy)(!0,e.target,t)}},92301:(e,t,n)=>{"use strict";n.d(t,{E:()=>i});var r=n(95734),i=(0,n(35232).S)()?r.useLayoutEffect:r.useEffect},17570:(e,t,n)=>{"use strict";var r;n.d(t,{CV:()=>i,N:()=>o});var i=function(){function e(e){this.value=e,this.nextChild=0}return e.prototype.getNext=function(){return new e("".concat(this.value,".").concat(++this.nextChild))},e}();function o(){if(!r){for(var e=[],t=0;t<22;t++)e.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(Math.floor(64*Math.random())));r=new i(e.join(""))}return r}},109:(e,t,n)=>{"use strict";function r(e,t,n){return a(e,1,t,n)}function i(e,t,n){return a(e,2,t,n)}function o(e,t,n){return a(e,0,t,n)}function a(e,t,n,r){return{name:e,dataType:t,value:n,classification:r||4}}n.d(t,{LK:()=>r,Ug:()=>i,m9:()=>o})},59834:(e,t,n)=>{"use strict";var r;n.d(t,{o:()=>r}),function(e){e.DataClassification={EssentialServiceMetadata:1,AccountData:2,SystemMetadata:4,OrganizationIdentifiableInformation:8,EndUserIdentifiableInformation:16,CustomerContent:32,AccessControl:64,PublicNonPersonalData:128,EndUserPseudonymousInformation:256,PublicPersonalData:512,SupportData:1024,DirectMeasurementData:2048,Everything:65535},e.DataFieldType={String:0,Boolean:1,Int64:2,Double:3,Guid:4},e.SamplingPolicy={NotSet:0,Measure:1,Diagnostics:2,CriticalBusinessImpact:191,CriticalCensus:192,CriticalExperimentation:193,CriticalUsage:194},e.PersistencePriority={NotSet:0,Normal:1,High:2},e.CostPriority={NotSet:0,Normal:1,High:2},e.DataCategories={NotSet:0,SoftwareSetup:1,ProductServiceUsage:2,ProductServicePerformance:4,DeviceConfiguration:8,InkingTypingSpeech:16},e.DiagnosticLevel={ReservedDoNotUse:0,Required:10,BasicEvent:10,Optional:100,FullEvent:100,RequiredServiceData:110,NecessaryServiceDataEvent:110,RequiredServiceDataForEssentialServices:120,AlwaysOnNecessaryServiceDataEvent:120},e.DnmInterval={Hourly:1,Daily:2},e.AllowedPartA={ReleaseAudienceGroup:1,WacRing:2,AppName:3,AppPlatform:4,AppVersion:5},e.CustomerContentType={None:0,MocaAddIn:1},e.LogLevel={Error:0,Warning:1,Info:2,Verbose:3},e.Category={Core:0,Sink:1,Transport:2},e.PrimaryIdentitySpace={UserObjectId:"UserObjectId",MSACID:"MSACID",OrgIdPuid:"OrgIdPuid",OrgIdPUID:"OrgIdPUID",OrgIdCID:"OrgIdCID",MsaPuid:"MsaPuid",MSAPUID:"MSAPUID",WopiAuth:"WopiAuth",ThirdParty:"ThirdParty",Other:"Other"},e.AudienceGroup={Automation:"Automation",Dogfood:"Dogfood",Microsoft:"Microsoft",Insiders:"Insiders",Production:"Production"}}(r||(r={}))},44328:(e,t,n)=>{"use strict";n.d(t,{S:()=>l});var r=n(95734),i=n(46649),o=n(69044),a=n(57585),s=n(77724);class l extends r.PureComponent{constructor(){super(...arguments),this.divRef=r.createRef()}isFocusWithin(){const e=this.divRef.current;return!!e&&(e===document.activeElement||e.contains(document.activeElement))}render(){return r.createElement(s.q.Consumer,null,(e=>r.createElement("div",Object.assign({},this.getRootDivAttributes(e),{ref:this.divRef}),this.props.children)))}focus(e){var t,n,r;e&&(null===(n=null===(t=this.divRef.current)||void 0===t?void 0:t.children[e])||void 0===n||n.focus()),null===(r=this.divRef.current)||void 0===r||r.focus()}el(){return this.divRef.current}getChildItem(e,t=0){const n=this.el(),r=null==n?void 0:n.querySelectorAll(e);return(null==r?void 0:r.length)&&(null==r?void 0:r.length)>=t+1?r[t]:null}getRootDivAttributes(e){const t={style:this.computeStyles(this.props.style,e)};return i.tO(this.props,t),this.props.accessible?(t["aria-hidden"]=!1,t["aria-label"]=this.props.accessibilityLabel,t.role=this.getAccessibilityRole()):!1===this.props.accessible&&(t["aria-hidden"]=!0),void 0!==this.props.accessibleLive&&(t["aria-live"]=this.getAriaLive()),this.props.focusable&&(t.tabIndex=0),this.props.onFocus&&(t.onFocus=this.props.onFocus),t.id=this.props.nativeID,t}computeStyles(e,t){const n={display:"flex",paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0};switch(this.props.direction===o.PR.LeftToRight?n.flexDirection="row":n.flexDirection="column",this.props.align){case o.j5.Stretch:n.alignItems="stretch";break;case o.j5.Center:n.alignItems="center";break;case o.j5.Baseline:n.alignItems="baseline";break;default:n.alignItems="flex-start"}switch(this.props.justifyContent){case o.Pr.Center:n.justifyContent="center";break;case o.Pr.End:n.justifyContent="flex-end";break;case o.Pr.SpaceBetween:n.justifyContent="space-between";break;default:n.justifyContent="flex-start"}if(e){switch(e.flexibleSize&&(n.flexGrow=1,n.flexShrink=1),void 0!==e.paddingStart&&(n.paddingLeft=t?e.paddingEnd:e.paddingStart),void 0!==e.paddingEnd&&(n.paddingRight=t?e.paddingStart:e.paddingEnd),void 0!==e.paddingHorizontal&&(n.paddingRight=e.paddingHorizontal,n.paddingLeft=e.paddingHorizontal),void 0!==e.paddingTop&&(n.paddingTop=e.paddingTop),void 0!==e.paddingBottom&&(n.paddingBottom=e.paddingBottom),void 0!==e.paddingVertical&&(n.paddingTop=n.paddingTop||0+e.paddingVertical,n.paddingBottom=n.paddingBottom||0+e.paddingVertical),void 0!==e.marginTop&&(n.marginTop=e.marginTop),void 0!==e.marginBottom&&(n.marginBottom=e.marginBottom),void 0!==e.marginVertical&&(n.marginTop=(e.marginTop||0)+e.marginVertical,n.marginBottom=(e.marginBottom||0)+e.marginVertical),t?(void 0!==e.marginStart&&(n.marginRight=e.marginStart),void 0!==e.marginEnd&&(n.marginLeft=e.marginEnd)):(void 0!==e.marginStart&&(n.marginLeft=e.marginStart),void 0!==e.marginEnd&&(n.marginRight=e.marginEnd)),void 0!==e.marginHorizontal&&(n.marginLeft=(t?e.marginEnd||0:e.marginStart||0)+e.marginHorizontal,n.marginRight=(t?e.marginStart||0:e.marginEnd||0)+e.marginHorizontal),void 0!==e.gap&&(n.gap=e.gap),void 0!==e.maxWidth&&(n.maxWidth=e.maxWidth),void 0!==e.minWidth&&(n.minWidth=e.minWidth),void 0!==e.width&&(n.width=e.width),void 0!==e.minHeight&&(n.minHeight=e.minHeight),void 0!==e.maxHeight&&(n.maxHeight=e.maxHeight),void 0!==e.height&&(n.height=e.height),e.backgroundColor&&(n.backgroundColor=e.backgroundColor),e.backgroundImage&&(n.backgroundImage=e.backgroundImage),void 0!==e.borderColor&&(n.borderColor=e.borderColor),void 0!==e.borderStyle&&(n.borderStyle=e.borderStyle),typeof e.borderWidth){case"number":n.borderWidth=e.borderWidth;break;case"object":n.borderTopWidth=e.borderWidth.top,n.borderRightWidth=t?e.borderWidth.start:e.borderWidth.end,n.borderBottomWidth=e.borderWidth.bottom,n.borderLeftWidth=t?e.borderWidth.end:e.borderWidth.start}switch(typeof e.borderRadius){case"number":n.borderRadius=(0,a.W)(e);break;case"object":const r=(0,a.W)(e,"topStart",0),i=(0,a.W)(e,"topEnd",0),o=(0,a.W)(e,"bottomStart",0),s=(0,a.W)(e,"bottomEnd",0);n.borderTopLeftRadius=t?i:r,n.borderTopRightRadius=t?r:i,n.borderBottomRightRadius=t?o:s,n.borderBottomLeftRadius=t?s:o}e.hideFocusBox&&(n.outline="none"),e.transform&&(n.transform=e.transform),void 0!==e.zIndex&&(n.zIndex=e.zIndex),e.position&&(n.position=e.position),(e.top||0===e.top)&&(n.top=e.top),(e.bottom||0===e.bottom)&&(n.bottom=e.bottom),(e.right||0===e.right)&&(n.right=e.right),(e.left||0===e.left)&&(n.left=e.left),e.overflow&&(n.overflow=e.overflow),e.boxShadow&&(n.boxShadow=e.boxShadow)}return n}getAccessibilityRole(){switch(this.props.accessibilityRole){case"list":case"listbox":case"menu":case"tablist":case"application":return this.props.accessibilityRole;default:return"group"}}getAriaLive(){return this.props.accessibleLive===o.pq.Polite?"polite":void 0}}},69044:(e,t,n)=>{"use strict";var r,i,o,a;n.d(t,{PR:()=>r,Pr:()=>o,j5:()=>i,pq:()=>a}),function(e){e[e.TopToBottom=0]="TopToBottom",e[e.LeftToRight=1]="LeftToRight"}(r||(r={})),function(e){e[e.Start=0]="Start",e[e.Stretch=1]="Stretch",e[e.Baseline=2]="Baseline",e[e.Center=3]="Center"}(i||(i={})),function(e){e[e.Start=0]="Start",e[e.Center=1]="Center",e[e.SpaceBetween=2]="SpaceBetween",e[e.End=3]="End"}(o||(o={})),function(e){e[e.Polite=0]="Polite",e[e.Off=1]="Off"}(a||(a={}))},93356:(e,t,n)=>{"use strict";n.d(t,{c:()=>l});var r=n(95734),i=n(24050);class o extends r.PureComponent{constructor(e){super(e),this.state={focused:!1},this.onFocus=this.onFocus.bind(this),this.onBlur=this.onBlur.bind(this)}getRunText(e,t){const n=this.props.text.length,r=Math.max(0,Math.min(n,e)),i=Math.max(0,Math.min(n,t));return r<i?this.props.text.substr(r,i-r):""}renderTextRuns(){const e=[];if(this.props.formatting&&this.props.formatting.length>0){let t=0,n=0;const r=this.props.text.length;for(;t<r;)if(n<this.props.formatting.length){const i=this.props.formatting[n],o=i.start,a=o+i.length,s=Math.max(t,Math.min(r,o)),l=Math.max(t,Math.min(r,a));if(s>=l){n+=1;continue}t<s&&(e.push(this.renderTextRun(t,s)),t=s),t<l&&(e.push(this.renderTextRun(t,l,i)),t=l),n+=1}else t<r&&(e.push(this.renderTextRun(t,r)),t=r)}return e}onFocus(){this.setState({focused:!0})}onBlur(){this.setState({focused:!1})}computeTheme(){var e;return null!==(e=this.props.theme)&&void 0!==e?e:o.defaultTheme}computeBorderColor(){const e=this.computeTheme();return this.state.focused?e.focusRing:e.border}computePadding(e){var t,n,r,i,o,a;const s=null!==(t=this.props.style)&&void 0!==t?t:{},l=null!==(r=null===(n=this.props.style)||void 0===n?void 0:n.padding)&&void 0!==r?r:this.props.focusable?1:0,d=(null!==(i=s[e])&&void 0!==i?i:0)+l,u=null!==(a=null===(o=this.props.style)||void 0===o?void 0:o.borderWidth)&&void 0!==a?a:this.props.focusable?1:0;return void 0!==this.computeBorderColor()?d:d+u}computeMargin(e){var t,n,r;const i=null!==(t=this.props.style)&&void 0!==t?t:{};return(null!==(n=i[e])&&void 0!==n?n:0)+(null!==(r=i["marginStart"===e||"marginEnd"===e?"marginHorizontal":"marginVertical"])&&void 0!==r?r:0)}computeBorderWidth(){var e,t;const n=null!==(t=null===(e=this.props.style)||void 0===e?void 0:e.borderWidth)&&void 0!==t?t:this.props.focusable?1:0;return void 0!==this.computeBorderColor()?n:0}getAccessibilityLabel(){return this.props.accessibilityHidden?void 0:this.props.accessibilityLabel?this.props.accessibilityLabel:this.props.text}}o.defaultTheme={focusRing:"#000000"},o.baseFontWeightValuesByType={[i.IT.Bold]:"bold",[i.IT.Normal]:"normal"};var a=n(26386),s=n(77724);class l extends o{constructor(){super(...arguments),this.spanRef=r.createRef()}render(){const e={},t=this.renderTextRuns();if(this.props.focusable&&(e.tabIndex=0,e.onFocus=this.onFocus,e.onBlur=this.onBlur),this.props.onHeightChange&&this.spanRef.current){const e=this.spanRef.current.getBoundingClientRect().height,t=this.computeMargin("marginTop"),n=this.computeMargin("marginBottom");this.props.onHeightChange(e+n+t)}return r.createElement(s.q.Consumer,null,(n=>r.createElement("span",Object.assign({},e,{ref:this.spanRef,style:this.renderRootFormatting(this.props.style,n,t.length>0),"aria-hidden":this.props.accessibilityHidden,"aria-posinset":this.props.accessibilityPositionInSet,"aria-setsize":this.props.accessibilitySetSize,"aria-label":0===t.length?this.getAccessibilityLabel():void 0,"aria-level":this.props.accessibilityHidden||"heading"!==this.props.accessibilityRole?void 0:1,role:this.props.accessibilityHidden?void 0:this.getAccessibilityRole(),"data-automation-id":this.props.accessibilityHidden?void 0:this.props.automationLabel}),0!==t.length?t:this.props.text)))}focus(){this.props.focusable&&this.spanRef.current&&this.spanRef.current.focus()}renderTextRun(e,t,n){return(null==n?void 0:n.hyperlink)?r.createElement(a.R,Object.assign({},n.hyperlink)):r.createElement("span",{key:e,style:this.renderFormatting(n)},this.getRunText(e,t))}computeTheme(){const e=super.computeTheme();return delete e.focusRing,e}renderBold(e,t){e.fontWeight=l.fontWeightValueByType[t]}renderUnderline(e,t){let n=!1;switch(t){case i.RV.Single:e.textDecorationLine="underline",e.textDecorationSkipInk="none";break;case i.RV.Double:e.backgroundImage="url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNXB4IiBoZWlnaHQ9IjNweCIgdmlld0JveD0iMCAwIDUgMyIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggNTUuMiAoNzgxODEpIC0gaHR0cHM6Ly9za2V0Y2hhcHAuY29tIC0tPgogICAgPHRpdGxlPmRvdWJsZV9saW5lPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImRvdWJsZV9saW5lIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBzdHJva2UtbGluZWNhcD0icm91bmQiPgogICAgICAgIDxnIGlkPSJUaWxlLUNvcHkiIHN0cm9rZT0iIzAwMDAwMCI+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLDAuNSBMNSwwLjUiIGlkPSJMaW5lLTItQ29weS0xMCI+PC9wYXRoPgogICAgICAgICAgICA8cGF0aCBkPSJNMCwyLjUgTDUsMi41IiBpZD0iTGluZS0yLUNvcHktMTEiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==')",n=!0;break;case i.RV.SpellingSquiggle:e.backgroundImage="url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNXB4IiBoZWlnaHQ9IjRweCIgdmlld0JveD0iMCAwIDUgNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggNTYuMiAoODE2NzIpIC0gaHR0cHM6Ly9za2V0Y2guY29tIC0tPgogICAgPHRpdGxlPnNwZWxsaW5nX3NxdWlnZ2xlPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IkZsYWdzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTAxMC4wMDAwMDAsIC0yOTYuMDAwMDAwKSIgaWQ9InNwZWxsaW5nX3NxdWlnZ2xlIj4KICAgICAgICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTAxMC4wMDAwMDAsIDI5Ni4wMDAwMDApIj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLDMgQzEuMjUsMyAxLjI1LDEgMi41LDEgQzMuNzUsMSAzLjc1LDMgNSwzIiBpZD0iUGF0aCIgc3Ryb2tlPSIjRUIwMDAwIiBzdHJva2Utd2lkdGg9IjEiPjwvcGF0aD4KICAgICAgICAgICAgICAgIDxyZWN0IGlkPSJSZWN0YW5nbGUiIHg9IjAiIHk9IjAiIHdpZHRoPSI1IiBoZWlnaHQ9IjQiPjwvcmVjdD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+')",n=!0;break;case i.RV.GrammarSquiggle:e.backgroundImage="url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNXB4IiBoZWlnaHQ9IjNweCIgdmlld0JveD0iMCAwIDUgMyIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggNTUuMiAoNzgxODEpIC0gaHR0cHM6Ly9za2V0Y2hhcHAuY29tIC0tPgogICAgPHRpdGxlPmdyYW1tYXJfZG91YmxlX2xpbmU8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZ3JhbW1hcl9kb3VibGVfbGluZSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIj4KICAgICAgICA8ZyBpZD0iR3JhbW1hci1UaWxlLUNvcHkiIHN0cm9rZT0iIzMzNTVGRiI+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLDAuNSBMNSwwLjUiIGlkPSJMaW5lLTItQ29weS0xMCI+PC9wYXRoPgogICAgICAgICAgICA8cGF0aCBkPSJNMCwyLjUgTDUsMi41IiBpZD0iTGluZS0yLUNvcHktMTEiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==')",n=!0;break;case i.RV.CritiqueSquiggle:e.backgroundImage="url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTBweCIgaGVpZ2h0PSIycHgiIHZpZXdCb3g9IjAgMCAxMCAyIiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPgogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA1Ny4xICg4MzA4OCkgLSBodHRwczovL3NrZXRjaC5jb20gLS0+CiAgICA8dGl0bGU+aW5zaWdodF90ZXh0dXJlPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9Imluc2lnaHRfdGV4dHVyZSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9Ikdyb3VwLTItQ29weSI+CiAgICAgICAgICAgIDxyZWN0IGlkPSJSZWN0YW5nbGUiIHg9IjAiIHk9IjAiIHdpZHRoPSIxMCIgaGVpZ2h0PSIyIj48L3JlY3Q+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0xLDEgTDUsMSIgaWQ9IkxpbmUtNCIgc3Ryb2tlPSIjNzE2MEU4IiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCI+PC9wYXRoPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+')",n=!0}n&&(e.backgroundRepeat="repeat-x",e.backgroundPosition="bottom left",e.borderBottom="solid 1px transparent")}renderFormatting(e){const t={};return(null==e?void 0:e.fontWeight)&&this.renderBold(t,e.fontWeight),t.fontFamily=null==e?void 0:e.fontFamily,t.fontSize=null==e?void 0:e.fontSize,t.fontStyle=(null==e?void 0:e.italic)?"italic":void 0,t.color=null==e?void 0:e.cssColor,(null==e?void 0:e.underlineType)&&this.renderUnderline(t,e.underlineType),(null==e?void 0:e.lineHeight)&&(t.lineHeight=e.lineHeight+"px"),(null==e?void 0:e.wrapMode)===i.bd.NoWrap?t.whiteSpace="nowrap":(t.whiteSpace="normal",t.overflowWrap="anywhere"),(null==e?void 0:e.highlightColor)&&(t.background=null==e?void 0:e.highlightColor,(null==e?void 0:e.highlightRadius)&&(t.borderRadius=e.highlightRadius+"px")),t.paddingLeft=null==e?void 0:e.paddingHorizontal,t.paddingRight=null==e?void 0:e.paddingHorizontal,t.marginLeft=null==e?void 0:e.marginHorizontal,t.marginRight=null==e?void 0:e.marginHorizontal,t}renderRootFormatting(e,t,n){var r;const i=this.computeTheme(),o=this.renderFormatting(e),a=this.computeMargin("marginStart"),s=this.computeMargin("marginEnd");return o.backgroundColor=i.background,o.paddingLeft=this.computePadding("paddingHorizontal"),o.paddingRight=this.computePadding("paddingHorizontal"),o.paddingTop=this.computePadding("paddingVertical"),o.paddingBottom=this.computePadding("paddingVertical"),o.marginLeft=t?s:a,o.marginRight=t?a:s,o.marginTop=this.computeMargin("marginTop"),o.marginBottom=this.computeMargin("marginBottom"),o.borderWidth=this.computeBorderWidth(),o.borderColor=this.computeBorderColor(),o.borderRadius=null===(r=this.props.style)||void 0===r?void 0:r.borderRadius,o.borderStyle="solid",o.width=null==e?void 0:e.width,o.height=null==e?void 0:e.height,o.textAlign=null==e?void 0:e.textAlign,void 0!==(null==e?void 0:e.userSelectable)&&(o.userSelect=e.userSelectable?"auto":"none"),(null==e?void 0:e.truncate)&&(o.overflow="hidden",o.textOverflow="ellipsis",o.whiteSpace="nowrap",n&&(o.display="-webkit-box",o.WebkitLineClamp=1,o["-webkit-box-orient"]="vertical")),o}getAccessibilityRole(){return"heading"===this.props.accessibilityRole?this.props.accessibilityRole:"text"}}l.fontWeightValueByType=Object.assign(Object.assign({},o.baseFontWeightValuesByType),{[i.IT.SemiBold]:600})},24050:(e,t,n)=>{"use strict";var r,i,o;n.d(t,{IT:()=>r,RV:()=>i,bd:()=>o}),function(e){e[e.Normal=0]="Normal",e[e.Bold=1]="Bold",e[e.SemiBold=2]="SemiBold"}(r||(r={})),function(e){e[e.None=0]="None",e[e.Single=1]="Single",e[e.Double=2]="Double",e[e.SpellingSquiggle=3]="SpellingSquiggle",e[e.GrammarSquiggle=4]="GrammarSquiggle",e[e.CritiqueSquiggle=5]="CritiqueSquiggle"}(i||(i={})),function(e){e[e.Normal=0]="Normal",e[e.NoWrap=1]="NoWrap"}(o||(o={}))},26386:(e,t,n)=>{"use strict";n.d(t,{R:()=>S});var r=n(95734),i=n(85414),o=n(98131);const a=r.createContext(void 0);a.Provider;var s=n(35985);const l=r.createContext(void 0),d={inline:!1},u=(l.Provider,(e,t)=>{const n=r.useContext(a),{inline:u}=null!==(c=r.useContext(l))&&void 0!==c?c:d;var c;const{appearance:g="default",disabled:h=!1,disabledFocusable:p=!1,inline:f=!1}=e,v=e.as||(e.href?"a":"button"),m={role:"span"===v?"button":void 0,type:"button"===v?"button":void 0,...e,as:v},y={appearance:g,disabled:h,disabledFocusable:p,inline:null!=f?f:!!u,components:{root:v},root:i.Gk((0,o.g)(v,{ref:t,...m}),{elementType:v}),backgroundAppearance:n};return(e=>{const{disabled:t,disabledFocusable:n}=e,{onClick:r,onKeyDown:i,role:o,tabIndex:a}=e.root;"a"===e.root.as&&(e.root.href=t?void 0:e.root.href,(t||n)&&(e.root.role=o||"link")),"a"!==e.root.as&&"span"!==e.root.as||(e.root.tabIndex=null!=a?a:t&&!n?void 0:0),e.root.onClick=e=>{t||n?e.preventDefault():null==r||r(e)},e.root.onKeyDown=r=>{const o=r.key===s.xyI||r.key===s.$xS;(t||n)&&o?(r.preventDefault(),r.stopPropagation()):(null==i||i(r),"span"===e.root.as&&e.root.onClick&&!i&&o&&(r.preventDefault(),r.currentTarget.click()))},e.disabled=t||n,e.root["aria-disabled"]=t||n||void 0,"button"===e.root.as&&(e.root.disabled=t&&!n)})(y),y});var c=n(27760),g=n(63649);const h=(0,c.X)({focusIndicator:{Bttzg6e:"fhgqx19",B3uz8dt:"f1olyrje",B6ihwck:"f1p93eir",g9k6zt:"f1nev41a"},root:{B486eqv:"f2hkw1w",De3pzq:"f3rmtva",B7ck84d:"f1ewtqcl",sj55zd:"fyind8e",Bceei9c:"f1k6fduh",mc9l5x:"f1w7gpdv",Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",jrapky:0,Frg6f3:0,t21cq0:0,B6of3ja:0,B74szlk:"f1s184ao",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1mk8lai",B68tc82:0,Bmxbyg5:0,Bpg54ce:"fnbmjn9",fsow6f:["f1o700av","fes3tcz"],w71qe1:"f1iuv45f",Bkioxbp:"f1cmlufx",ygn44y:"f9n3di6",famaaq:"f1ids18y",Bde5pd6:"f1tx3yz7",Bi91k9c:"f1deo86v",i089h6:"f1eh06m1",lj723h:"f1iescvh"},button:{icvyot:"f1ern45e",vrafjx:["f1n71otn","f1deefiw"],oivjwe:"f1h8hb77",wvpqe5:["f1deefiw","f1n71otn"]},href:{Be2twd7:"fjoy568"},subtle:{sj55zd:"fkfq4zb",Bde5pd6:"f1tx3yz7",Bi91k9c:"fnwyq0v",i089h6:"f1eh06m1",lj723h:"flvvhsy"},inline:{w71qe1:"f13mvf36"},disabled:{w71qe1:"f1iuv45f",sj55zd:"f1s2aq7o",Bceei9c:"fdrzuqr",Bde5pd6:"fbnuktb",Bi91k9c:"fvgxktp",i089h6:"fljg2da",lj723h:"f19wldhg"},inverted:{sj55zd:"f179xftw",Bi91k9c:"f1sk1dtk",lj723h:"f182g21t"}},{d:[".fhgqx19[data-fui-focus-visible]{text-decoration-color:var(--colorStrokeFocus2);}",".f1olyrje[data-fui-focus-visible]{text-decoration-line:underline;}",".f1p93eir[data-fui-focus-visible]{text-decoration-style:double;}",".f1nev41a[data-fui-focus-visible]{outline-style:none;}",".f3rmtva{background-color:transparent;}",".f1ewtqcl{box-sizing:border-box;}",".fyind8e{color:var(--colorBrandForegroundLink);}",".f1k6fduh{cursor:pointer;}",".f1w7gpdv{display:inline;}",".fk6fouc{font-family:var(--fontFamilyBase);}",".fkhj508{font-size:var(--fontSizeBase300);}",".figsok6{font-weight:var(--fontWeightRegular);}",[".f1s184ao{margin:0;}",{p:-1}],[".f1mk8lai{padding:0;}",{p:-1}],[".fnbmjn9{overflow:inherit;}",{p:-1}],".f1o700av{text-align:left;}",".fes3tcz{text-align:right;}",".f1iuv45f{text-decoration-line:none;}",".f1cmlufx{text-decoration-thickness:var(--strokeWidthThin);}",".f9n3di6{text-overflow:inherit;}",".f1ids18y{-webkit-user-select:text;-moz-user-select:text;user-select:text;}",".f1ern45e{border-top-style:none;}",".f1n71otn{border-right-style:none;}",".f1deefiw{border-left-style:none;}",".f1h8hb77{border-bottom-style:none;}",".fjoy568{font-size:inherit;}",".fkfq4zb{color:var(--colorNeutralForeground2);}",".f13mvf36{text-decoration-line:underline;}",".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",".fdrzuqr{cursor:not-allowed;}",".f179xftw{color:var(--colorNeutralForegroundInvertedLink);}"],i:[".f2hkw1w:focus-visible{outline-style:none;}"],h:[".f1tx3yz7:hover{text-decoration-line:underline;}",".f1deo86v:hover{color:var(--colorBrandForegroundLinkHover);}",".fnwyq0v:hover{color:var(--colorNeutralForeground2Hover);}",".fbnuktb:hover{text-decoration-line:none;}",".fvgxktp:hover{color:var(--colorNeutralForegroundDisabled);}",".f1sk1dtk:hover{color:var(--colorNeutralForegroundInvertedLinkHover);}"],a:[".f1eh06m1:active{text-decoration-line:underline;}",".f1iescvh:active{color:var(--colorBrandForegroundLinkPressed);}",".flvvhsy:active{color:var(--colorNeutralForeground2Pressed);}",".fljg2da:active{text-decoration-line:none;}",".f19wldhg:active{color:var(--colorNeutralForegroundDisabled);}",".f182g21t:active{color:var(--colorNeutralForegroundInvertedLinkPressed);}"]});var p=n(39030),f=n(62655),v=n(63562);const m=r.forwardRef(((e,t)=>{const n=u(e,t);return(e=>{const t=h(),{appearance:n,disabled:r,inline:i,root:o,backgroundAppearance:a}=e;e.root.className=(0,g.z)("fui-Link",t.root,t.focusIndicator,"a"===o.as&&o.href&&t.href,"button"===o.as&&t.button,"subtle"===n&&t.subtle,"inverted"===a&&t.inverted,i&&t.inline,r&&t.disabled,e.root.className)})(n),(0,v.$e)("useLinkStyles_unstable")(n),(e=>((0,f.C)(e),(0,p.Y)(e.root,{})))(n)}));m.displayName="Link";var y=n(93356),_=n(24050);class b extends r.PureComponent{constructor(e){super(e),this.state={isFocused:!1,isHovered:!1,isPressed:!1},this.onFocus=this.onFocus.bind(this),this.onBlur=this.onBlur.bind(this),this.onHoverIn=this.onHoverIn.bind(this),this.onHoverOut=this.onHoverOut.bind(this),this.onPressIn=this.onPressIn.bind(this),this.onPressOut=this.onPressOut.bind(this)}computeTextColor(){const e=this.props.theme;return this.state.isPressed&&(null==e?void 0:e.pressedColor)?null==e?void 0:e.pressedColor:this.state.isHovered&&(null==e?void 0:e.hoverColor)?null==e?void 0:e.hoverColor:this.state.isFocused&&(null==e?void 0:e.focusColor)?null==e?void 0:e.focusColor:null==e?void 0:e.color}computeTextStyling(){var e;const t=this.props.style;return{fontSize:t.fontSize,fontWeight:t.fontWeight,cssColor:this.computeTextColor(),underlineType:null!==(e=this.props.style.underlineType)&&void 0!==e?e:_.RV.Single}}renderContents(){return this.props.text?r.createElement(y.c,{text:this.props.text,style:this.props.theme||this.props.style?this.computeTextStyling():void 0}):void 0}onFocus(){this.setState({isFocused:!0})}onBlur(){this.setState({isFocused:!1})}onHoverIn(){this.setState({isHovered:!0})}onHoverOut(){this.setState({isHovered:!1})}onPressIn(){this.setState({isPressed:!0})}onPressOut(){this.setState({isPressed:!1})}}var C=n(7470);class S extends b{constructor(e){super(e)}render(){const{inline:e,url:t,text:n,onClick:i}=this.props;return this.context?r.createElement("div",{style:{display:e?"inline-flex":"block"}},r.createElement(m,{target:"_blank",href:t,style:{boxShadow:"none"},onClick:i},n?r.createElement(y.c,{text:n,style:Object.assign(Object.assign({},this.computeTextStyling()),{cssColor:void 0})}):void 0)):r.createElement("div",{style:{display:e?"inline-flex":"block"}},r.createElement(m,{target:"_blank",href:t,style:this.getStyle(),onMouseEnter:this.onHoverIn,onMouseLeave:this.onHoverOut,onPointerDown:this.onPressIn,onPointerUp:this.onPressOut,onFocus:this.onFocus,onBlur:this.onBlur},this.renderContents()))}getStyle(){return{color:this.computeTextColor(),boxShadow:"none"}}}S.contextType=C.O},44785:(e,t,n)=>{"use strict";n.d(t,{q:()=>i,w:()=>o});var r=n(39454);const i=(e,t)=>void 0!==o(e,t),o=(e,t)=>{const n=`${e}Filled`;return t&&(0,r.sW)(n)?n:(0,r.sW)(e)?e:void 0}},6908:(e,t,n)=>{"use strict";n.d(t,{X:()=>r,Z:()=>i});const r={};function i(e,t){r[e]=t}},20666:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var r=n(95734),i=n(6908),o=n(77724),a=n(4523);function s(e){var t,n;const s=r.useContext(o.q),l=e.type,d=i.X[l];let u;return s&&(u=e.filled&&null!==(t=d.rtlFilled)&&void 0!==t?t:d.rtlRegular),void 0===u&&(u=e.filled&&null!==(n=d.filled)&&void 0!==n?n:d.regular),r.createElement(u,Object.assign({},(0,a.Vm)(e),{pointerEvents:"none"}))}},4523:(e,t,n)=>{"use strict";n.d(t,{Vm:()=>u,j2:()=>l,ku:()=>d});var r=n(93356),i=n(83198),o=n(6908);const a=["Accept","Accessibility","AddToDictionary","ArrowReset","BowTie","Cancel","Checkmark","Cloud","Color","Completed","Copy","Delete","EditorSettings","FirstRowAsHeader","Hide","GiveFeedback","Ignore","IgnoreAll","IgnoreRule","Info","MergeCells","Next","Overflow","Plus","PremiumDiamond","Previous","ReadAloud","ShowExplanation","SplitCells"],s=[...a,"AddBot","AddPeople","Apps","ArrowUpload","ChatBubblesQuestion","Dislike","DropdownChevron","ECCFeedback","Emails","ErrorBadge","Event","EventRecorded","EventSeries","FFXCBulletedList","FFXCCallout","FFXCChecklist","FFXCCodeBlock","FFXCCompleted","FFXCInsertTextBox","FFXCKanbanBoard","FFXCNumberedList","FFXQuestionAnswer","FFXCQuote","FFXCRetroBoard","FFXCStatusTracker","FFXCTable","FFXCVote","Files","Hashtag","Laptop","Location","Like","Link","Meeting","Member","People","Person","PhoneNumber","Record","Repeat","Sparkle","TeamsChat","Undo","Upload"],l=(e,t)=>t?a.some((t=>t===e)):s.some((t=>t===e)),d=e=>void 0!==o.X[e],u=e=>{const{primaryColor:t,fontWeight:n,style:o,fontSize:a}=e;return{primaryFill:t,color:t,"aria-hidden":"true",fontSize:null!=a?a:i.Q.fontSize,style:Object.assign({fontSize:null!=a?a:i.Q.fontSize,margin:null==o?void 0:o.margin},o),fontWeight:n?r.c.fontWeightValueByType[n]:i.Q.fontWeight}}},67895:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(95734),i=n(87579),o=n(4523);function a(e){return r.createElement(i.iNx,Object.assign({},(0,o.Vm)(Object.assign(Object.assign({},e),{primaryColor:"transparent"}))))}},15715:(e,t,n)=>{"use strict";n.d(t,{I:()=>f});var r=n(95734),i=n(7470),o=n(16107),a=n(44785),s=n(57579);function l(e){return r.createElement(s.l8,{iconName:(0,a.w)(e.type,e.filled),style:(0,o.MD)(e),"aria-hidden":!0})}var d=n(4523),u=n(67895),c=n(20666),g=n(40725);const h=r.lazy((()=>Promise.all([n.e(1804),n.e(1519)]).then(n.bind(n,19079)))),p=r.lazy((()=>n.e(490).then(n.bind(n,90732))));class f extends r.Component{static shouldRender(e,t){return(0,g.R)(e,t)}static shouldRenderTypeName(e,t,n){return!!((0,d.j2)(e)||(0,d.ku)(e)||(0,o.tv)(e))||!(null==n?void 0:n.useFluentV9)&&(0,a.q)(e,t)}render(){const e=!!this.context;return f.shouldRender(this.props,{useFluentV9:e})?r.createElement(v,Object.assign({},this.props)):null}}f.contextType=i.O;const v=e=>{const t=r.useContext(i.O),n=r.useContext(i.b),s="Upload"===e.type&&n;return(0,d.j2)(e.type)&&!s?r.createElement(r.Suspense,{fallback:r.createElement(u.A,Object.assign({},e))},r.createElement(h,Object.assign({},e))):(0,d.ku)(e.type)?r.createElement(c.A,Object.assign({},e)):(0,o.tv)(e.type)?r.createElement(r.Suspense,{fallback:r.createElement(u.A,Object.assign({},e))},r.createElement(p,Object.assign({},e))):t?null:(0,a.q)(e.type,e.filled)?r.createElement(l,Object.assign({},e)):null}},16107:(e,t,n)=>{"use strict";n.d(t,{MD:()=>l,tv:()=>s});var r=n(83198),i=n(93356);const o=["ColorfulCopilot","Dot","Editor","EditorSingleColor","EditorWithStars","EditorWithStarsAnimated","EditorWithStarsDarkMode","EditorWithStarsDarkModeAnimated","LocalLanguage","LocaleLanguage","NewFeature"],a=[...o,"AllItems","ClipboardList","CsvFiles","TxtFiles","Excel","Folder","ForwardSlashPromo","ExploreMoreCopilot","LineCopilot","Loop","OneDrive","OneNoteNotebook","Pdf","PowerPoint","QuickSync","SignUpSheet","UnknownFile","Visio","Word"],s=(e,t)=>t?o.some((t=>t===e)):a.some((t=>t===e)),l=e=>{const{primaryColor:t,fontSize:n,fontWeight:o,style:a}=e;return Object.assign({color:t,fontSize:null!=n?n:r.Q.fontSize,width:null!=n?n:r.Q.fontSize,height:null!=n?n:r.Q.fontSize,fontWeight:o?i.c.fontWeightValueByType[o]:r.Q.fontWeight,display:"flex",alignItems:"center",justifyContent:"center"},a)}},83198:(e,t,n)=>{"use strict";n.d(t,{Q:()=>r,S:()=>i});const r={fontSize:20,fontWeight:400};function i(e){return null!=e?e:r.fontSize}},40725:(e,t,n)=>{"use strict";n.d(t,{R:()=>a});var r=n(16107),i=n(44785),o=n(4523);function a(e,t){const n=e.type,a=e.filled;return!!((0,o.j2)(n)||(0,o.ku)(n)||(0,r.tv)(n))||!(null==t?void 0:t.useFluentV9)&&(0,i.q)(n,a)}},5817:(e,t,n)=>{"use strict";n.d(t,{c:()=>Y});var r=n(95734),i=n(39030),o=n(62655),a=n(20982),s=n(85414),l=n(98131),d=n(55713);const u=/[\(\[\{][^\)\]\}]*[\)\]\}]/g,c=/[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/g,g=/^\d+[\d\s]*(:?ext|x|)\s*\d+$/i,h=/\s+/g,p=/[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF\u3040-\u309F\u30A0-\u30FF\u3400-\u4DBF\u4E00-\u9FFF\uF900-\uFAFF]|[\uD840-\uD869][\uDC00-\uDED6]/;var f=n(51485),v=n(49503);v.TTi,v.TTi,v.fGI,v.Ndk,v.qSk,v.qSk;const m={tiny:v.jcT,"extra-small":v.jcT,small:v.NUA,medium:v.B2S,large:v.grK,"extra-large":v.grK},y={tiny:v.qXC,"extra-small":v.qXC,small:v.uO1,medium:v.gNt,large:v.HkI,"extra-large":v.HkI},_={tiny:v.qvE,"extra-small":v.qvE,small:v._E3,medium:v.yQ7,large:v.Vo$,"extra-large":v.Vo$},b={tiny:v.DWd,"extra-small":v.DWd,small:v.Z4e,medium:v.TNE,large:v.mx_,"extra-large":v.mx_},C={tiny:v.U$D,"extra-small":v.U$D,small:v.gC_,medium:v.ORW,large:v.vsS,"extra-large":v.vsS},S={tiny:v.F$H,"extra-small":v.F$H,small:v.hmO,medium:v.fPq,large:v.MxQ,"extra-large":v.MxQ},T={tiny:v.xmy,"extra-small":v.xmy,small:v.X8c,medium:v.dR_,large:v.KCz,"extra-large":v.KCz},I={tiny:v.PM$,"extra-small":v.PM$,small:v.nPn,medium:v.lYg,large:v.omG,"extra-large":v.omG},w={tiny:v.y3Y,"extra-small":v.y3Y,small:v.gNc,medium:v.uOK,large:v.X0b,"extra-large":v.X0b},E={tiny:v.xo$,"extra-small":v.xo$,small:v.$Oq,medium:v.b8q,large:v.ADj,"extra-large":v.ADj},x=(e,t)=>{const{shape:n="circular",size:r="medium",iconPosition:i="before",appearance:o="filled",color:a="brand"}=e;return{shape:n,size:r,iconPosition:i,appearance:o,color:a,components:{root:"div",icon:"span"},root:s.Gk((0,l.g)("div",{ref:t,...e}),{elementType:"div"}),icon:s.lq(e.icon,{elementType:"span"})}},A={busy:"busy","out-of-office":"out of office",away:"away",available:"available",offline:"offline","do-not-disturb":"do not disturb",unknown:"unknown",blocked:"blocked"};var D=n(11612),k=n(27760),F=n(63649);const P=(0,D.y)("r832ydo",null,[".r832ydo{display:inline-flex;box-sizing:border-box;align-items:center;justify-content:center;border-radius:var(--borderRadiusCircular);background-color:var(--colorNeutralBackground1);padding:1px;background-clip:content-box;}"]),N=(0,D.y)("r11ag4qr",null,[".r11ag4qr{display:flex;margin:-1px;}"]),B=(0,k.X)({statusBusy:{sj55zd:"fvi85wt"},statusAway:{sj55zd:"f14k8a89"},statusAvailable:{sj55zd:"fqa5hgp"},statusOffline:{sj55zd:"f11d4kpn"},statusOutOfOffice:{sj55zd:"fdce8r3"},statusUnknown:{sj55zd:"f11d4kpn"},outOfOffice:{sj55zd:"fr0bkrk"},outOfOfficeAvailable:{sj55zd:"fqa5hgp"},outOfOfficeBusy:{sj55zd:"fvi85wt"},outOfOfficeUnknown:{sj55zd:"f11d4kpn"},tiny:{Bubjx69:"f9ikmtg",a9b677:"f16dn6v3",B2eet1l:"f1w2irj7",B5pe6w7:"fab5kbq",p4uzdd:"f1ms1d91"},large:{Bubjx69:"f9ikmtg",a9b677:"f64fuq3",B5pe6w7:"f1vfi1yj",p4uzdd:"f15s34gz"},extraLarge:{Bubjx69:"f9ikmtg",a9b677:"f1w9dchk",B5pe6w7:"f14efy9b",p4uzdd:"fhipgdu"}},{d:[".fvi85wt{color:var(--colorPaletteRedBackground3);}",".f14k8a89{color:var(--colorPaletteMarigoldBackground3);}",".fqa5hgp{color:var(--colorPaletteLightGreenForeground3);}",".f11d4kpn{color:var(--colorNeutralForeground3);}",".fdce8r3{color:var(--colorPaletteBerryForeground3);}",".fr0bkrk{color:var(--colorNeutralBackground1);}",".f9ikmtg{aspect-ratio:1;}",".f16dn6v3{width:6px;}",".f1w2irj7{background-clip:unset;}",".fab5kbq svg{width:6px!important;}",".f1ms1d91 svg{height:6px!important;}",".f64fuq3{width:20px;}",".f1vfi1yj svg{width:20px!important;}",".f15s34gz svg{height:20px!important;}",".f1w9dchk{width:28px;}",".f14efy9b svg{width:28px!important;}",".fhipgdu svg{height:28px!important;}"]});var O=n(63562);const R=r.forwardRef(((e,t)=>{const n=((e,t)=>{const{size:n="medium",status:i="available",outOfOffice:o=!1}=e,a=A[i],l=e.outOfOffice&&"out-of-office"!==e.status?` ${A["out-of-office"]}`:"",d=((e,t,n)=>{switch(e){case"available":return t?y[n]:_[n];case"away":return t?I[n]:m[n];case"blocked":return b[n];case"busy":return t?E[n]:C[n];case"do-not-disturb":return t?T[n]:S[n];case"offline":return t?I[n]:w[n];case"out-of-office":return I[n];case"unknown":return E[n]}})(i,o,n);return{...x({"aria-label":a+l,role:"img",...e,size:n,icon:s.lq(e.icon,{defaultProps:{children:d?r.createElement(d,null):null},renderByDefault:!0,elementType:"span"})},t),status:i,outOfOffice:o}})(e,t);return(e=>{const t=P(),n=N(),r=B(),i="busy"===(o=e.status)||"do-not-disturb"===o||"blocked"===o;var o;e.root.className=(0,F.z)("fui-PresenceBadge",t,i&&r.statusBusy,"away"===e.status&&r.statusAway,"available"===e.status&&r.statusAvailable,"offline"===e.status&&r.statusOffline,"out-of-office"===e.status&&r.statusOutOfOffice,"unknown"===e.status&&r.statusUnknown,e.outOfOffice&&r.outOfOffice,e.outOfOffice&&"available"===e.status&&r.outOfOfficeAvailable,e.outOfOffice&&i&&r.outOfOfficeBusy,e.outOfOffice&&("out-of-office"===e.status||"away"===e.status||"offline"===e.status)&&r.statusOutOfOffice,e.outOfOffice&&"unknown"===e.status&&r.outOfOfficeUnknown,"tiny"===e.size&&r.tiny,"large"===e.size&&r.large,"extra-large"===e.size&&r.extraLarge,e.root.className),e.icon&&(e.icon.className=(0,F.z)("fui-PresenceBadge__icon",n,e.icon.className))})(n),(0,O.$e)("usePresenceBadgeStyles_unstable")(n),(e=>((0,o.C)(e),(0,i.FD)(e.root,{children:["before"===e.iconPosition&&e.icon&&(0,i.Y)(e.icon,{}),e.root.children,"after"===e.iconPosition&&e.icon&&(0,i.Y)(e.icon,{})]})))(n)}));R.displayName="PresenceBadge";var L=n(49294);const M=r.createContext(void 0),q={},W=(M.Provider,{active:"active",inactive:"inactive"}),U=e=>e>=96?"extra-large":e>=64?"large":e>=56?"medium":e>=40?"small":e>=28?"extra-small":"tiny",z=["dark-red","cranberry","red","pumpkin","peach","marigold","gold","brass","brown","forest","seafoam","dark-green","light-teal","teal","steel","blue","royal-blue","cornflower","navy","lavender","purple","grape","lilac","pink","magenta","plum","beige","mink","platinum","anchor"],j=e=>{let t=0;for(let n=e.length-1;n>=0;n--){const r=e.charCodeAt(n),i=n%8;t^=(r<<i)+(r>>8-i)}return t},H=(0,D.y)("r81b29z","r1aatmv",{r:[".r81b29z{display:inline-block;flex-shrink:0;position:relative;vertical-align:middle;border-radius:var(--borderRadiusCircular);font-family:var(--fontFamilyBase);font-weight:var(--fontWeightSemibold);font-size:var(--fontSizeBase300);width:32px;height:32px;}",".r81b29z::before,.r81b29z::after{position:absolute;top:0;left:0;bottom:0;right:0;z-index:-1;margin:calc(-2 * var(--fui-Avatar-ringWidth, 0px));border-radius:inherit;transition-property:margin,opacity;transition-timing-function:var(--curveEasyEaseMax),var(--curveLinear);transition-duration:var(--durationUltraSlow),var(--durationSlower);}",".r81b29z::before{border-style:solid;border-width:var(--fui-Avatar-ringWidth);}",".r1aatmv{display:inline-block;flex-shrink:0;position:relative;vertical-align:middle;border-radius:var(--borderRadiusCircular);font-family:var(--fontFamilyBase);font-weight:var(--fontWeightSemibold);font-size:var(--fontSizeBase300);width:32px;height:32px;}",".r1aatmv::before,.r1aatmv::after{position:absolute;top:0;right:0;bottom:0;left:0;z-index:-1;margin:calc(-2 * var(--fui-Avatar-ringWidth, 0px));border-radius:inherit;transition-property:margin,opacity;transition-timing-function:var(--curveEasyEaseMax),var(--curveLinear);transition-duration:var(--durationUltraSlow),var(--durationSlower);}",".r1aatmv::before{border-style:solid;border-width:var(--fui-Avatar-ringWidth);}"],s:["@media screen and (prefers-reduced-motion: reduce){.r81b29z::before,.r81b29z::after{transition-duration:0.01ms;}}","@media screen and (prefers-reduced-motion: reduce){.r1aatmv::before,.r1aatmv::after{transition-duration:0.01ms;}}"]}),V=(0,D.y)("r136dc0n","rjly0nl",[".r136dc0n{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:inherit;object-fit:cover;vertical-align:top;}",".rjly0nl{position:absolute;top:0;right:0;width:100%;height:100%;border-radius:inherit;object-fit:cover;vertical-align:top;}"]),G=(0,D.y)("rip04v","r31uzil",[".rip04v{position:absolute;box-sizing:border-box;top:0;left:0;width:100%;height:100%;line-height:1;border:var(--strokeWidthThin) solid var(--colorTransparentStroke);display:flex;align-items:center;justify-content:center;vertical-align:center;text-align:center;-webkit-user-select:none;-moz-user-select:none;user-select:none;border-radius:inherit;}",".r31uzil{position:absolute;box-sizing:border-box;top:0;right:0;width:100%;height:100%;line-height:1;border:var(--strokeWidthThin) solid var(--colorTransparentStroke);display:flex;align-items:center;justify-content:center;vertical-align:center;text-align:center;-webkit-user-select:none;-moz-user-select:none;user-select:none;border-radius:inherit;}"]),Q=(0,k.X)({textCaption2Strong:{Be2twd7:"f13mqy1h"},textCaption1Strong:{Be2twd7:"fy9rknc"},textSubtitle2:{Be2twd7:"fod5ikn"},textSubtitle1:{Be2twd7:"f1pp30po"},textTitle3:{Be2twd7:"f1x0m3f5"},squareSmall:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"fq9zq91"},squareMedium:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5"},squareLarge:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f1o0qvyv"},squareXLarge:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f1kijzfu"},activeOrInactive:{Bz10aip:"ftfx35i",Bmy1vo4:"fv0atk9",B3o57yi:"f1iry5bo",Bkqvd7p:"f15n41j8",Hwfdqs:"f1onx1g3"},ring:{Ftih45:"f1wl9k8s"},ringBadgeCutout:{f4a502:"fp2gujx"},ringThick:{of393c:"fq1w1vq"},ringThicker:{of393c:"fzg6ace"},ringThickest:{of393c:"f1nu8p71"},shadow:{Bsft5z2:"f13zj6fq"},shadow4:{Be6vj1x:"fcjn15l"},shadow8:{Be6vj1x:"f1tm8t9f"},shadow16:{Be6vj1x:"f1a1aohj"},shadow28:{Be6vj1x:"fond6v5"},inactive:{abs64n:"fp25eh",Bz10aip:"f1clczzi",Bkqvd7p:"f1l3s34x",Bfgortx:0,Bnvr3x9:0,b2tv09:0,Bucmhp4:0,iayac2:"flkahu5",b6ubon:"fw457kn",Bqinb2h:"f1wmllxl"},badge:{qhf8xq:"f1euv43f",B5kzvoi:"f1yab3r1",j35jbq:["f1e31b4d","f1vgc2s3"]},badgeCutout:{btxmck:"f1eugkqs"},badgeAlign:{Dnlfbu:["f1tlnv9o","f1y9kyih"]},tiny:{Bdjeniz:"f1uwoubl",niu6jh:"fid048z"},"extra-small":{Bdjeniz:"f13ar0e0",niu6jh:"fid048z"},small:{Bdjeniz:"fwwuruf",niu6jh:"fid048z"},medium:{Bdjeniz:"f1af27q5",niu6jh:"fid048z"},large:{Bdjeniz:"f18yy57a",niu6jh:"f924bxt"},"extra-large":{Bdjeniz:"f2jg042",niu6jh:"f924bxt"},icon12:{Be2twd7:"f1ugzwwg"},icon16:{Be2twd7:"f4ybsrx"},icon20:{Be2twd7:"fe5j1ua"},icon24:{Be2twd7:"f1rt2boy"},icon28:{Be2twd7:"f24l1pt"},icon32:{Be2twd7:"ffl51b"},icon48:{Be2twd7:"f18m8u13"}},{d:[".f13mqy1h{font-size:var(--fontSizeBase100);}",".fy9rknc{font-size:var(--fontSizeBase200);}",".fod5ikn{font-size:var(--fontSizeBase400);}",".f1pp30po{font-size:var(--fontSizeBase500);}",".f1x0m3f5{font-size:var(--fontSizeBase600);}",[".fq9zq91{border-radius:var(--borderRadiusSmall);}",{p:-1}],[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],[".f1o0qvyv{border-radius:var(--borderRadiusLarge);}",{p:-1}],[".f1kijzfu{border-radius:var(--borderRadiusXLarge);}",{p:-1}],".ftfx35i{transform:perspective(1px);}",".fv0atk9{transition-property:transform,opacity;}",".f1iry5bo{transition-duration:var(--durationUltraSlow),var(--durationFaster);}",".f15n41j8{transition-timing-function:var(--curveEasyEaseMax),var(--curveLinear);}",'.f1wl9k8s::before{content:"";}',".fp2gujx::before{-webkit-mask-image:radial-gradient(circle at bottom calc(var(--fui-Avatar-badgeRadius) + 2 * var(--fui-Avatar-ringWidth)) var(--fui-Avatar-badgeAlign) calc(var(--fui-Avatar-badgeRadius) + 2 * var(--fui-Avatar-ringWidth)), transparent calc(var(--fui-Avatar-badgeRadius) + var(--fui-Avatar-badgeGap) - 0.25px), white calc(var(--fui-Avatar-badgeRadius) + var(--fui-Avatar-badgeGap) + 0.25px));mask-image:radial-gradient(circle at bottom calc(var(--fui-Avatar-badgeRadius) + 2 * var(--fui-Avatar-ringWidth)) var(--fui-Avatar-badgeAlign) calc(var(--fui-Avatar-badgeRadius) + 2 * var(--fui-Avatar-ringWidth)), transparent calc(var(--fui-Avatar-badgeRadius) + var(--fui-Avatar-badgeGap) - 0.25px), white calc(var(--fui-Avatar-badgeRadius) + var(--fui-Avatar-badgeGap) + 0.25px));}",".fq1w1vq{--fui-Avatar-ringWidth:var(--strokeWidthThick);}",".fzg6ace{--fui-Avatar-ringWidth:var(--strokeWidthThicker);}",".f1nu8p71{--fui-Avatar-ringWidth:var(--strokeWidthThickest);}",'.f13zj6fq::after{content:"";}',".fcjn15l::after{box-shadow:var(--shadow4);}",".f1tm8t9f::after{box-shadow:var(--shadow8);}",".f1a1aohj::after{box-shadow:var(--shadow16);}",".fond6v5::after{box-shadow:var(--shadow28);}",".fp25eh{opacity:0.8;}",".f1clczzi{transform:scale(0.875);}",".f1l3s34x{transition-timing-function:var(--curveDecelerateMin),var(--curveLinear);}",[".flkahu5::before,.flkahu5::after{margin:0;}",{p:-1}],".fw457kn::before,.fw457kn::after{opacity:0;}",".f1wmllxl::before,.f1wmllxl::after{transition-timing-function:var(--curveDecelerateMin),var(--curveLinear);}",".f1euv43f{position:absolute;}",".f1yab3r1{bottom:0;}",".f1e31b4d{right:0;}",".f1vgc2s3{left:0;}",".f1eugkqs{-webkit-mask-image:radial-gradient(circle at bottom var(--fui-Avatar-badgeRadius) var(--fui-Avatar-badgeAlign) var(--fui-Avatar-badgeRadius), transparent calc(var(--fui-Avatar-badgeRadius) + var(--fui-Avatar-badgeGap) - 0.25px), white calc(var(--fui-Avatar-badgeRadius) + var(--fui-Avatar-badgeGap) + 0.25px));mask-image:radial-gradient(circle at bottom var(--fui-Avatar-badgeRadius) var(--fui-Avatar-badgeAlign) var(--fui-Avatar-badgeRadius), transparent calc(var(--fui-Avatar-badgeRadius) + var(--fui-Avatar-badgeGap) - 0.25px), white calc(var(--fui-Avatar-badgeRadius) + var(--fui-Avatar-badgeGap) + 0.25px));}",".f1tlnv9o{--fui-Avatar-badgeAlign:right;}",".f1y9kyih{--fui-Avatar-badgeAlign:left;}",".f1uwoubl{--fui-Avatar-badgeRadius:3px;}",".fid048z{--fui-Avatar-badgeGap:var(--strokeWidthThin);}",".f13ar0e0{--fui-Avatar-badgeRadius:5px;}",".fwwuruf{--fui-Avatar-badgeRadius:6px;}",".f1af27q5{--fui-Avatar-badgeRadius:8px;}",".f18yy57a{--fui-Avatar-badgeRadius:10px;}",".f924bxt{--fui-Avatar-badgeGap:var(--strokeWidthThick);}",".f2jg042{--fui-Avatar-badgeRadius:14px;}",".f1ugzwwg{font-size:12px;}",".f4ybsrx{font-size:16px;}",".fe5j1ua{font-size:20px;}",".f1rt2boy{font-size:24px;}",".f24l1pt{font-size:28px;}",".ffl51b{font-size:32px;}",".f18m8u13{font-size:48px;}"],m:[["@media screen and (prefers-reduced-motion: reduce){.f1onx1g3{transition-duration:0.01ms;}}",{m:"screen and (prefers-reduced-motion: reduce)"}]]}),K=(0,k.X)({16:{a9b677:"fjw5fx7",Bqenvij:"fd461yt"},20:{a9b677:"f64fuq3",Bqenvij:"fjamq6b"},24:{a9b677:"fq4mcun",Bqenvij:"frvgh55"},28:{a9b677:"f1w9dchk",Bqenvij:"fxldao9"},32:{a9b677:"f1szoe96",Bqenvij:"f1d2rq10"},36:{a9b677:"fpdz1er",Bqenvij:"f8ljn23"},40:{a9b677:"feqmc2u",Bqenvij:"fbhnoac"},48:{a9b677:"f124akge",Bqenvij:"ff2sm71"},56:{a9b677:"f1u66zr1",Bqenvij:"fzki0ko"},64:{a9b677:"fa9ln6p",Bqenvij:"f16k9i2m"},72:{a9b677:"fhcae8x",Bqenvij:"f1shusfg"},96:{a9b677:"f1kyr2gn",Bqenvij:"fypu0ge"},120:{a9b677:"fwfqyga",Bqenvij:"fjr5b71"},128:{a9b677:"f1iksgmy",Bqenvij:"fele2au"}},{d:[".fjw5fx7{width:16px;}",".fd461yt{height:16px;}",".f64fuq3{width:20px;}",".fjamq6b{height:20px;}",".fq4mcun{width:24px;}",".frvgh55{height:24px;}",".f1w9dchk{width:28px;}",".fxldao9{height:28px;}",".f1szoe96{width:32px;}",".f1d2rq10{height:32px;}",".fpdz1er{width:36px;}",".f8ljn23{height:36px;}",".feqmc2u{width:40px;}",".fbhnoac{height:40px;}",".f124akge{width:48px;}",".ff2sm71{height:48px;}",".f1u66zr1{width:56px;}",".fzki0ko{height:56px;}",".fa9ln6p{width:64px;}",".f16k9i2m{height:64px;}",".fhcae8x{width:72px;}",".f1shusfg{height:72px;}",".f1kyr2gn{width:96px;}",".fypu0ge{height:96px;}",".fwfqyga{width:120px;}",".fjr5b71{height:120px;}",".f1iksgmy{width:128px;}",".fele2au{height:128px;}"]}),$=(0,k.X)({neutral:{sj55zd:"f11d4kpn",De3pzq:"f18f03hv"},brand:{sj55zd:"fonrgv7",De3pzq:"f1blnnmj"},"dark-red":{sj55zd:"fqjd1y1",De3pzq:"f1vq2oo4"},cranberry:{sj55zd:"fg9gses",De3pzq:"f1lwxszt"},red:{sj55zd:"f23f7i0",De3pzq:"f1q9qhfq"},pumpkin:{sj55zd:"fjnan08",De3pzq:"fz91bi3"},peach:{sj55zd:"fknu15p",De3pzq:"f1b9nr51"},marigold:{sj55zd:"f9603vw",De3pzq:"f3z4w6d"},gold:{sj55zd:"fmq0uwp",De3pzq:"fg50kya"},brass:{sj55zd:"f28g5vo",De3pzq:"f4w2gd0"},brown:{sj55zd:"ftl572b",De3pzq:"f14wu1f4"},forest:{sj55zd:"f1gymlvd",De3pzq:"f19ut4y6"},seafoam:{sj55zd:"fnnb6wn",De3pzq:"f1n057jc"},"dark-green":{sj55zd:"ff58qw8",De3pzq:"f11t05wk"},"light-teal":{sj55zd:"f1up9qbj",De3pzq:"f42feg1"},teal:{sj55zd:"f135dsb4",De3pzq:"f6hvv1p"},steel:{sj55zd:"f151dlcp",De3pzq:"f1lnp8zf"},blue:{sj55zd:"f1rjv50u",De3pzq:"f1ggcpy6"},"royal-blue":{sj55zd:"f1emykk5",De3pzq:"f12rj61f"},cornflower:{sj55zd:"fqsigj7",De3pzq:"f8k7hur"},navy:{sj55zd:"f1nj97xi",De3pzq:"f19gw0ux"},lavender:{sj55zd:"fwctg0i",De3pzq:"ff379vm"},purple:{sj55zd:"fjrsgpu",De3pzq:"f1mzf1e1"},grape:{sj55zd:"f1fiiydq",De3pzq:"f1o4k8oy"},lilac:{sj55zd:"f1res9jt",De3pzq:"f1x6mz1o"},pink:{sj55zd:"fv3fbbi",De3pzq:"fydlv6t"},magenta:{sj55zd:"f1f1fwnz",De3pzq:"f4xb6j5"},plum:{sj55zd:"f8ptl6j",De3pzq:"fqo8e26"},beige:{sj55zd:"f1ntv3ld",De3pzq:"f101elhj"},mink:{sj55zd:"f1fscmp",De3pzq:"f13g8o5c"},platinum:{sj55zd:"f1dr00v2",De3pzq:"fkh7blw"},anchor:{sj55zd:"f1f3ti53",De3pzq:"fu4yj0j"}},{d:[".f11d4kpn{color:var(--colorNeutralForeground3);}",".f18f03hv{background-color:var(--colorNeutralBackground6);}",".fonrgv7{color:var(--colorNeutralForegroundStaticInverted);}",".f1blnnmj{background-color:var(--colorBrandBackgroundStatic);}",".fqjd1y1{color:var(--colorPaletteDarkRedForeground2);}",".f1vq2oo4{background-color:var(--colorPaletteDarkRedBackground2);}",".fg9gses{color:var(--colorPaletteCranberryForeground2);}",".f1lwxszt{background-color:var(--colorPaletteCranberryBackground2);}",".f23f7i0{color:var(--colorPaletteRedForeground2);}",".f1q9qhfq{background-color:var(--colorPaletteRedBackground2);}",".fjnan08{color:var(--colorPalettePumpkinForeground2);}",".fz91bi3{background-color:var(--colorPalettePumpkinBackground2);}",".fknu15p{color:var(--colorPalettePeachForeground2);}",".f1b9nr51{background-color:var(--colorPalettePeachBackground2);}",".f9603vw{color:var(--colorPaletteMarigoldForeground2);}",".f3z4w6d{background-color:var(--colorPaletteMarigoldBackground2);}",".fmq0uwp{color:var(--colorPaletteGoldForeground2);}",".fg50kya{background-color:var(--colorPaletteGoldBackground2);}",".f28g5vo{color:var(--colorPaletteBrassForeground2);}",".f4w2gd0{background-color:var(--colorPaletteBrassBackground2);}",".ftl572b{color:var(--colorPaletteBrownForeground2);}",".f14wu1f4{background-color:var(--colorPaletteBrownBackground2);}",".f1gymlvd{color:var(--colorPaletteForestForeground2);}",".f19ut4y6{background-color:var(--colorPaletteForestBackground2);}",".fnnb6wn{color:var(--colorPaletteSeafoamForeground2);}",".f1n057jc{background-color:var(--colorPaletteSeafoamBackground2);}",".ff58qw8{color:var(--colorPaletteDarkGreenForeground2);}",".f11t05wk{background-color:var(--colorPaletteDarkGreenBackground2);}",".f1up9qbj{color:var(--colorPaletteLightTealForeground2);}",".f42feg1{background-color:var(--colorPaletteLightTealBackground2);}",".f135dsb4{color:var(--colorPaletteTealForeground2);}",".f6hvv1p{background-color:var(--colorPaletteTealBackground2);}",".f151dlcp{color:var(--colorPaletteSteelForeground2);}",".f1lnp8zf{background-color:var(--colorPaletteSteelBackground2);}",".f1rjv50u{color:var(--colorPaletteBlueForeground2);}",".f1ggcpy6{background-color:var(--colorPaletteBlueBackground2);}",".f1emykk5{color:var(--colorPaletteRoyalBlueForeground2);}",".f12rj61f{background-color:var(--colorPaletteRoyalBlueBackground2);}",".fqsigj7{color:var(--colorPaletteCornflowerForeground2);}",".f8k7hur{background-color:var(--colorPaletteCornflowerBackground2);}",".f1nj97xi{color:var(--colorPaletteNavyForeground2);}",".f19gw0ux{background-color:var(--colorPaletteNavyBackground2);}",".fwctg0i{color:var(--colorPaletteLavenderForeground2);}",".ff379vm{background-color:var(--colorPaletteLavenderBackground2);}",".fjrsgpu{color:var(--colorPalettePurpleForeground2);}",".f1mzf1e1{background-color:var(--colorPalettePurpleBackground2);}",".f1fiiydq{color:var(--colorPaletteGrapeForeground2);}",".f1o4k8oy{background-color:var(--colorPaletteGrapeBackground2);}",".f1res9jt{color:var(--colorPaletteLilacForeground2);}",".f1x6mz1o{background-color:var(--colorPaletteLilacBackground2);}",".fv3fbbi{color:var(--colorPalettePinkForeground2);}",".fydlv6t{background-color:var(--colorPalettePinkBackground2);}",".f1f1fwnz{color:var(--colorPaletteMagentaForeground2);}",".f4xb6j5{background-color:var(--colorPaletteMagentaBackground2);}",".f8ptl6j{color:var(--colorPalettePlumForeground2);}",".fqo8e26{background-color:var(--colorPalettePlumBackground2);}",".f1ntv3ld{color:var(--colorPaletteBeigeForeground2);}",".f101elhj{background-color:var(--colorPaletteBeigeBackground2);}",".f1fscmp{color:var(--colorPaletteMinkForeground2);}",".f13g8o5c{background-color:var(--colorPaletteMinkBackground2);}",".f1dr00v2{color:var(--colorPalettePlatinumForeground2);}",".fkh7blw{background-color:var(--colorPalettePlatinumBackground2);}",".f1f3ti53{color:var(--colorPaletteAnchorForeground2);}",".fu4yj0j{background-color:var(--colorPaletteAnchorBackground2);}"]}),Z=(0,k.X)({neutral:{Bic5iru:"f1uuiafn"},brand:{Bic5iru:"f1uuiafn"},"dark-red":{Bic5iru:"f1t2x9on"},cranberry:{Bic5iru:"f1pvshc9"},red:{Bic5iru:"f1ectbk9"},pumpkin:{Bic5iru:"fvzpl0b"},peach:{Bic5iru:"fwj2kd7"},marigold:{Bic5iru:"fr120vy"},gold:{Bic5iru:"f8xmmar"},brass:{Bic5iru:"f1hbety2"},brown:{Bic5iru:"f1vg3s4g"},forest:{Bic5iru:"f1m3olm5"},seafoam:{Bic5iru:"f17xiqtr"},"dark-green":{Bic5iru:"fx32vyh"},"light-teal":{Bic5iru:"f1mkihwv"},teal:{Bic5iru:"fecnooh"},steel:{Bic5iru:"f15hfgzm"},blue:{Bic5iru:"fqproka"},"royal-blue":{Bic5iru:"f17v2w59"},cornflower:{Bic5iru:"fp0q1mo"},navy:{Bic5iru:"f1nlym55"},lavender:{Bic5iru:"f62vk8h"},purple:{Bic5iru:"f15zl69q"},grape:{Bic5iru:"f53w4j7"},lilac:{Bic5iru:"fu2771t"},pink:{Bic5iru:"fzflscs"},magenta:{Bic5iru:"fb6rmqc"},plum:{Bic5iru:"f1a4gm5b"},beige:{Bic5iru:"f1qpf9z1"},mink:{Bic5iru:"f1l7or83"},platinum:{Bic5iru:"fzrj0iu"},anchor:{Bic5iru:"f8oz6wf"}},{d:[".f1uuiafn::before{color:var(--colorBrandStroke1);}",".f1t2x9on::before{color:var(--colorPaletteDarkRedBorderActive);}",".f1pvshc9::before{color:var(--colorPaletteCranberryBorderActive);}",".f1ectbk9::before{color:var(--colorPaletteRedBorderActive);}",".fvzpl0b::before{color:var(--colorPalettePumpkinBorderActive);}",".fwj2kd7::before{color:var(--colorPalettePeachBorderActive);}",".fr120vy::before{color:var(--colorPaletteMarigoldBorderActive);}",".f8xmmar::before{color:var(--colorPaletteGoldBorderActive);}",".f1hbety2::before{color:var(--colorPaletteBrassBorderActive);}",".f1vg3s4g::before{color:var(--colorPaletteBrownBorderActive);}",".f1m3olm5::before{color:var(--colorPaletteForestBorderActive);}",".f17xiqtr::before{color:var(--colorPaletteSeafoamBorderActive);}",".fx32vyh::before{color:var(--colorPaletteDarkGreenBorderActive);}",".f1mkihwv::before{color:var(--colorPaletteLightTealBorderActive);}",".fecnooh::before{color:var(--colorPaletteTealBorderActive);}",".f15hfgzm::before{color:var(--colorPaletteSteelBorderActive);}",".fqproka::before{color:var(--colorPaletteBlueBorderActive);}",".f17v2w59::before{color:var(--colorPaletteRoyalBlueBorderActive);}",".fp0q1mo::before{color:var(--colorPaletteCornflowerBorderActive);}",".f1nlym55::before{color:var(--colorPaletteNavyBorderActive);}",".f62vk8h::before{color:var(--colorPaletteLavenderBorderActive);}",".f15zl69q::before{color:var(--colorPalettePurpleBorderActive);}",".f53w4j7::before{color:var(--colorPaletteGrapeBorderActive);}",".fu2771t::before{color:var(--colorPaletteLilacBorderActive);}",".fzflscs::before{color:var(--colorPalettePinkBorderActive);}",".fb6rmqc::before{color:var(--colorPaletteMagentaBorderActive);}",".f1a4gm5b::before{color:var(--colorPalettePlumBorderActive);}",".f1qpf9z1::before{color:var(--colorPaletteBeigeBorderActive);}",".f1l7or83::before{color:var(--colorPaletteMinkBorderActive);}",".fzrj0iu::before{color:var(--colorPalettePlatinumBorderActive);}",".f8oz6wf::before{color:var(--colorPaletteAnchorBorderActive);}"]}),J=r.forwardRef(((e,t)=>{const n=((e,t)=>{const{dir:n}=(0,L.Y)(),{shape:i,size:o}=null!==(v=r.useContext(M))&&void 0!==v?v:q;var v;const{name:m,size:y=(null!=o?o:32),shape:_=(null!=i?i:"circular"),active:b="unset",activeAppearance:C="ring",idForColor:S}=e;let{color:T="neutral"}=e;var I;"colorful"===T&&(T=z[j(null!==(I=null!=S?S:m)&&void 0!==I?I:"")%z.length]);const w=(0,a.Bi)("avatar-"),E=s.Gk((0,l.g)("span",{role:"img",id:w,...e,ref:t},["name"]),{elementType:"span"}),[x,A]=r.useState(void 0);let D=s.lq(e.image,{defaultProps:{alt:"",role:"presentation","aria-hidden":!0,hidden:x},elementType:"img"});(null==D?void 0:D.src)||(D=void 0),D&&(D.onError=(0,d.p)(D.onError,(()=>A(!0))),D.onLoad=(0,d.p)(D.onLoad,(()=>A(void 0))));let k,F=s.lq(e.initials,{renderByDefault:!0,defaultProps:{children:(P=m,N="rtl"===n,B={firstInitialOnly:y<=16},P?(P=function(e){return(e=(e=(e=e.replace(u,"")).replace(c,"")).replace(h," ")).trim()}(P),p.test(P)||!(null==B?void 0:B.allowPhoneInitials)&&g.test(P)?"":function(e,t,n){let r="";const i=e.split(" ");return 0!==i.length&&(r+=i[0].charAt(0).toUpperCase()),n||(2===i.length?r+=i[1].charAt(0).toUpperCase():3===i.length&&(r+=i[2].charAt(0).toUpperCase())),t&&r.length>1?r.charAt(1)+r.charAt(0):r}(P,N,null==B?void 0:B.firstInitialOnly)):""),id:w+"__initials"},elementType:"span"});var P,N,B;(null==F?void 0:F.children)||(F=void 0),F||D&&!x||(k=s.lq(e.icon,{renderByDefault:!0,defaultProps:{children:r.createElement(f.aUx,null),"aria-hidden":!0},elementType:"span"}));const O=s.lq(e.badge,{defaultProps:{size:U(y),id:w+"__badge"},elementType:R});let H;if(!E["aria-label"]&&!E["aria-labelledby"]&&(m?(E["aria-label"]=m,O&&(E["aria-labelledby"]=E.id+" "+O.id)):F&&(E["aria-labelledby"]=F.id+(O?" "+O.id:"")),"active"===b||"inactive"===b)){const e=W[b];if(E["aria-labelledby"]){const t=w+"__active";E["aria-labelledby"]+=" "+t,H=r.createElement("span",{hidden:!0,id:t},e)}else E["aria-label"]&&(E["aria-label"]+=" "+e)}return{size:y,shape:_,active:b,activeAppearance:C,activeAriaLabelElement:H,color:T,components:{root:"span",initials:"span",icon:"span",image:"img",badge:R},root:E,initials:F,icon:k,image:D,badge:O}})(e,t);return(e=>{const{size:t,shape:n,active:r,activeAppearance:i,color:o}=e,a=H(),s=V(),l=G(),d=Q(),u=K(),c=$(),g=Z(),h=[a,32!==t&&u[t]];if(e.badge&&h.push(d.badgeAlign,d[e.badge.size||"medium"]),t<=24?h.push(d.textCaption2Strong):t<=28?h.push(d.textCaption1Strong):t<=40||(t<=56?h.push(d.textSubtitle2):t<=96?h.push(d.textSubtitle1):h.push(d.textTitle3)),"square"===n&&(t<=24?h.push(d.squareSmall):t<=48?h.push(d.squareMedium):t<=72?h.push(d.squareLarge):h.push(d.squareXLarge)),"active"!==r&&"inactive"!==r||(h.push(d.activeOrInactive),"ring"!==i&&"ring-shadow"!==i||(h.push(d.ring,g[o]),e.badge&&h.push(d.ringBadgeCutout),t<=48?h.push(d.ringThick):t<=64?h.push(d.ringThicker):h.push(d.ringThickest)),"shadow"!==i&&"ring-shadow"!==i||(h.push(d.shadow),t<=28?h.push(d.shadow4):t<=48?h.push(d.shadow8):t<=64?h.push(d.shadow16):h.push(d.shadow28)),"inactive"===r&&h.push(d.inactive)),e.root.className=(0,F.z)("fui-Avatar",...h,e.root.className),e.badge&&(e.badge.className=(0,F.z)("fui-Avatar__badge",d.badge,e.badge.className)),e.image&&(e.image.className=(0,F.z)("fui-Avatar__image",s,c[o],e.badge&&d.badgeCutout,e.image.className)),e.initials&&(e.initials.className=(0,F.z)("fui-Avatar__initials",l,c[o],e.badge&&d.badgeCutout,e.initials.className)),e.icon){let n;n=t<=16?d.icon12:t<=24?d.icon16:t<=40?d.icon20:t<=48?d.icon24:t<=56?d.icon28:t<=72?d.icon32:d.icon48,e.icon.className=(0,F.z)("fui-Avatar__icon",l,n,c[o],e.badge&&d.badgeCutout,e.icon.className)}})(n),(0,O.$e)("useAvatarStyles_unstable")(n),(e=>((0,o.C)(e),(0,i.FD)(e.root,{children:[e.initials&&(0,i.Y)(e.initials,{}),e.icon&&(0,i.Y)(e.icon,{}),e.image&&(0,i.Y)(e.image,{}),e.badge&&(0,i.Y)(e.badge,{}),e.activeAriaLabelElement]})))(n)}));J.displayName="Avatar";var X=n(44328);(0,n(54167).hN)([{rawString:"@-webkit-keyframes fadeIn_04b4b0a2{from{opacity:0}to{opacity:1}}@keyframes fadeIn_04b4b0a2{from{opacity:0}to{opacity:1}}@-webkit-keyframes fadeOut_04b4b0a2{from{opacity:1}to{opacity:0}}@keyframes fadeOut_04b4b0a2{from{opacity:1}to{opacity:0}}.coinFadeIn_04b4b0a2{-webkit-animation:fadeIn_04b4b0a2 var(--animation-time) forwards !important;animation:fadeIn_04b4b0a2 var(--animation-time) forwards !important}.coinFadeOut_04b4b0a2{-webkit-animation:fadeOut_04b4b0a2 var(--animation-time) forwards !important;animation:fadeOut_04b4b0a2 var(--animation-time) forwards !important}"}]);const Y=e=>{var t,n,i,o,a,s,l,d,u;const[c,g]=r.useState(!1),h=r.useRef(void 0),p=r.useRef(void 0);h.current===e.imageUrl||c||g(!0),r.useEffect((()=>(c&&!p.current&&(p.current=setTimeout((()=>{p.current=void 0,h.current=e.imageUrl,g(!1)}),e.animationTimeMs?e.animationTimeMs+200:1e3)),()=>clearTimeout(p.current))),[c,p.current]);const f=Object.assign({left:0,top:0,position:"absolute","--animation-time":`${null!==(t=e.animationTimeMs)&&void 0!==t?t:800}ms`},e.borderColor?{border:`2px solid ${e.borderColor}`,borderRadius:"50%"}:{}),v={animation:"none !important"},m=ee(e.coinSize);return r.createElement(X.S,{style:{position:"relative",width:null!==(n=e.size)&&void 0!==n?n:m,height:null!==(i=e.size)&&void 0!==i?i:m}},c&&r.createElement(J,Object.assign({},e,{image:{src:h.current,style:v},className:"coinFadeOut_04b4b0a2",style:Object.assign({},f),initials:null!==(o=e.initials)&&void 0!==o?o:e.imageInitials,name:e.text,color:null!==(a=e.color)&&void 0!==a?a:"brand",size:null!==(s=e.size)&&void 0!==s?s:m})),r.createElement(J,Object.assign({},e,{image:{src:e.imageUrl,style:v},className:c?"coinFadeIn_04b4b0a2":"",style:Object.assign({},f),initials:null!==(l=e.initials)&&void 0!==l?l:e.imageInitials,name:e.text,color:null!==(d=e.color)&&void 0!==d?d:"brand",size:null!==(u=e.size)&&void 0!==u?u:m})))},ee=e=>e?e<20?16:e<24?20:e<28?24:e<32?28:e<36?32:e<40?36:e<48?40:e<56?48:e<64?56:e<72?64:e<96?72:e<120?96:e<128?120:128:20},77724:(e,t,n)=>{"use strict";n.d(t,{q:()=>o,K:()=>a});var r=n(95734),i=n(97874);const o=r.createContext((0,i.jI)());class a extends r.Component{constructor(e){super(e),this.rtl=e.rtl}render(){return r.createElement(o.Provider,{value:this.rtl},this.props.children)}}},57585:(e,t,n)=>{"use strict";function r(e,t,n=1){var r,i;return void 0===t?void 0===(null==e?void 0:e.borderRadius)||"number"==typeof(null==e?void 0:e.borderRadius)?null!==(r=null==e?void 0:e.borderRadius)&&void 0!==r?r:n:void 0:"object"==typeof(null==e?void 0:e.borderRadius)?null!==(i=e.borderRadius[t])&&void 0!==i?i:0:void 0}n.d(t,{W:()=>r})},7470:(e,t,n)=>{"use strict";n.d(t,{O:()=>i,b:()=>o});var r=n(95734);const i=r.createContext(!1);i.displayName="UseFluentV9Context";const o=r.createContext(!1);o.displayName="UseUiCoherenceContext"},46649:(e,t,n)=>{"use strict";n.d(t,{tO:()=>a});var r=n(94763);const i={ArrowDown:r.h.ArrowDown,ArrowUp:r.h.ArrowUp,ArrowLeft:r.h.ArrowLeft,ArrowRight:r.h.ArrowRight,Enter:r.h.Enter,End:r.h.End,Escape:r.h.Escape,Home:r.h.Home,Tab:r.h.Tab," ":r.h.Space,Down:r.h.ArrowDown,Up:r.h.ArrowUp,Left:r.h.ArrowLeft,Right:r.h.ArrowRight,Spacebar:r.h.Space,Esc:r.h.Escape};function o(e,t,n){void 0!==i[n.key]&&-1!==t.indexOf(i[n.key])&&!1!==e({key:i[n.key],alt:n.altKey,ctrl:n.ctrlKey,shift:n.shiftKey,meta:n.metaKey})&&(n.preventDefault(),n.stopPropagation())}function a(e,t){e.onKeyDown&&e.handledKeys&&(t.onKeyDown=o.bind(void 0,e.onKeyDown,e.handledKeys)),e.onKeyUp&&e.handledKeys&&(t.onKeyUp=o.bind(void 0,e.onKeyUp,e.handledKeys))}},94763:(e,t,n)=>{"use strict";var r;n.d(t,{h:()=>r}),function(e){e[e.ArrowDown=0]="ArrowDown",e[e.ArrowUp=1]="ArrowUp",e[e.ArrowLeft=2]="ArrowLeft",e[e.ArrowRight=3]="ArrowRight",e[e.End=4]="End",e[e.Enter=5]="Enter",e[e.Escape=6]="Escape",e[e.Home=7]="Home",e[e.Space=8]="Space",e[e.Tab=9]="Tab"}(r||(r={}))},72777:(e,t,n)=>{"use strict";var r,i;n.d(t,{L:()=>r,x:()=>i}),function(e){e[e.Retry=0]="Retry",e[e.ClearSearch=1]="ClearSearch"}(r||(r={})),function(e){e[e.Undefined=0]="Undefined",e[e.ClassicAttachment=1]="ClassicAttachment",e[e.OneDriveForBusiness=2]="OneDriveForBusiness",e[e.SharepointOnline=3]="SharepointOnline"}(i||(i={}))},43514:(e,t,n)=>{"use strict";n.d(t,{S:()=>i});const r=Object.freeze({Apps:"Apps"});function i(e){return e&&e in r?r[e]:e}},36754:(e,t,n)=>{"use strict";n.d(t,{L:()=>r,Z:()=>i});const r=Object.freeze({doc:{iconType:"Word"},docx:{iconType:"Word"},dot:{iconType:"Word"},dotx:{iconType:"Word"},docm:{iconType:"Word"},docb:{iconType:"Word"},ppt:{iconType:"PowerPoint"},pptx:{iconType:"PowerPoint"},xls:{iconType:"Excel"},xlm:{iconType:"Excel"},xlsx:{iconType:"Excel"},xlsm:{iconType:"Excel"},xlsb:{iconType:"Excel"},xltx:{iconType:"Excel"},pdf:{iconType:"Pdf"},vsd:{iconType:"Visio"},vsdx:{iconType:"Visio"},loop:{iconType:"Loop"},fluid:{iconType:"Loop"},one:{iconType:"OneNoteNotebook"},wbk:{iconType:"Files"},dotm:{iconType:"Files"},xlb:{iconType:"Files"},xlc:{iconType:"Files"},xlt:{iconType:"Files"},xltm:{iconType:"Files"},xla:{iconType:"Files"},xll:{iconType:"Files"},xlam:{iconType:"Files"},xlw:{iconType:"Files"},odc:{iconType:"Files"},ods:{iconType:"Files"},pot:{iconType:"Files"},potx:{iconType:"Files"},potm:{iconType:"Files"},ppam:{iconType:"Files"},ppsx:{iconType:"Files"},ppsm:{iconType:"Files"},sldx:{iconType:"Files"},rtf:{iconType:"Files"},sldm:{iconType:"Files"},ppa:{iconType:"Files"},htm:{iconType:"Files"},html:{iconType:"Files"},odt:{iconType:"Files"},odp:{iconType:"Files"},csv:{iconType:"CsvFiles"},txt:{iconType:"TxtFiles"},folder:{iconType:"Folder"}});function i(e){var t,n;const i=e.toLocaleLowerCase();return null!==(n=null===(t=r[i])||void 0===t?void 0:t.iconType)&&void 0!==n?n:"UnknownFile"}},80967:(e,t,n)=>{"use strict";var r,i,o,a,s,l,d,u;n.d(t,{A8:()=>l,L9:()=>i,SV:()=>u,_R:()=>a,nH:()=>r,vr:()=>o,z4:()=>d}),function(e){e[e.Text=0]="Text",e[e.Icon=1]="Icon",e[e.MonochromeIcon=2]="MonochromeIcon",e[e.IconButton=3]="IconButton",e[e.IconAndTextButton=4]="IconAndTextButton",e[e.CustomImageAndText=5]="CustomImageAndText"}(r||(r={})),function(e){e[e.Classification=0]="Classification",e[e.Spelling=1]="Spelling",e[e.RepeatedWord=2]="RepeatedWord",e[e.Grammar=3]="Grammar",e[e.Refinement=4]="Refinement",e[e.NeuralRewrite=5]="NeuralRewrite",e[e.SimilarityChecker=6]="SimilarityChecker",e[e.TonalRewrite=7]="TonalRewrite",e[e.Topic=8]="Topic",e[e.DictationCorrection=9]="DictationCorrection",e[e.AccColorChecker=10]="AccColorChecker",e[e.WritersUnblock=11]="WritersUnblock",e[e.AIFeedback=12]="AIFeedback",e[e.TextPenAlternates=13]="TextPenAlternates",e[e.AltText=14]="AltText",e[e.InlineSuggestion=15]="InlineSuggestion",e[e.AddinCritique=16]="AddinCritique",e[e.MergeSplitCell=17]="MergeSplitCell",e[e.MissingTableHeader=18]="MissingTableHeader"}(i||(i={})),function(e){e[e.None=0]="None",e[e.Spelling=1]="Spelling",e[e.Grammar=2]="Grammar",e[e.Refinement=3]="Refinement",e[e.Rewrite=4]="Rewrite",e[e.SimilarityChecker=5]="SimilarityChecker",e[e.AccColorChecker=6]="AccColorChecker",e[e.Modification=7]="Modification",e[e.PremiumEmphasis=8]="PremiumEmphasis",e[e.TrackChangeContent=9]="TrackChangeContent",e[e.TrackChangePlaceholder=10]="TrackChangePlaceholder",e[e.CatchUp=11]="CatchUp"}(o||(o={})),function(e){e[e.Accept=0]="Accept",e[e.ReadAloud=1]="ReadAloud",e[e.SpellOut=2]="SpellOut",e[e.ChangeAll=3]="ChangeAll",e[e.AddToAutoCorrect=4]="AddToAutoCorrect",e[e.AutoCorrectOptions=5]="AutoCorrectOptions",e[e.IgnoreOnce=6]="IgnoreOnce",e[e.IgnoreAll=7]="IgnoreAll",e[e.IgnoreRule=8]="IgnoreRule",e[e.AddToDictionary=9]="AddToDictionary",e[e.Options=10]="Options",e[e.ShowExplanation=11]="ShowExplanation",e[e.ManageLanguages=12]="ManageLanguages",e[e.Next=13]="Next",e[e.Previous=14]="Previous",e[e.ToggleContext=15]="ToggleContext",e[e.ToggleDescription=16]="ToggleDescription",e[e.ReadContext=17]="ReadContext",e[e.ShowMenu=18]="ShowMenu",e[e.Feedback=19]="Feedback",e[e.Report=20]="Report",e[e.Dismiss=21]="Dismiss",e[e.AddOnFooterAction=22]="AddOnFooterAction",e[e.OpenEditorPane=23]="OpenEditorPane",e[e.LearnMore=24]="LearnMore",e[e.Complete=25]="Complete",e[e.IntextCitation=26]="IntextCitation",e[e.FullCitation=27]="FullCitation",e[e.Reject=28]="Reject",e[e.AcceptHoverIn=29]="AcceptHoverIn",e[e.AcceptHoverOut=30]="AcceptHoverOut",e[e.RejectHoverIn=31]="RejectHoverIn",e[e.RejectHoverOut=32]="RejectHoverOut",e[e.OpenCustomDictionary=33]="OpenCustomDictionary",e[e.MoreSources=34]="MoreSources",e[e.SourceSelected=35]="SourceSelected",e[e.Accessibility=36]="Accessibility",e[e.OpenColorPicker=37]="OpenColorPicker",e[e.TurnOffAccChecker=38]="TurnOffAccChecker",e[e.ApplyColor=39]="ApplyColor",e[e.Allow=40]="Allow",e[e.AllowAll=41]="AllowAll",e[e.FixSimilarColors=42]="FixSimilarColors",e[e.FixAllColors=43]="FixAllColors",e[e.AutoGenAltText=44]="AutoGenAltText",e[e.MissingAltText=45]="MissingAltText",e[e.UseFirstRowAsHeader=46]="UseFirstRowAsHeader",e[e.SplitCell=47]="SplitCell",e[e.MergeCells=48]="MergeCells",e[e.MarkAsDecorative=49]="MarkAsDecorative",e[e.MarkAsLayout=50]="MarkAsLayout",e[e.MoreFontColors=51]="MoreFontColors",e[e.ChangeColors=52]="ChangeColors",e[e.ResetGraphic=53]="ResetGraphic",e[e.UndoInsertSummarization=54]="UndoInsertSummarization",e[e.RefreshSummary=55]="RefreshSummary",e[e.Overflow=56]="Overflow",e[e.CatchUp=57]="CatchUp",e[e.Cancel=58]="Cancel",e[e.InsertBelow=59]="InsertBelow",e[e.Regenerate=60]="Regenerate",e[e.StopGenerating=61]="StopGenerating",e[e.ContainerHoverIn=62]="ContainerHoverIn",e[e.ContainerHoverOut=63]="ContainerHoverOut",e[e.LaunchAIRewrite=64]="LaunchAIRewrite",e[e.LaunchAIRewriteHoverIn=65]="LaunchAIRewriteHoverIn",e[e.LaunchAIRewriteHoverOut=66]="LaunchAIRewriteHoverOut"}(a||(a={})),function(e){e[e.Undefined=0]="Undefined",e[e.ClassicAttachment=1]="ClassicAttachment",e[e.OneDriveForBusiness=2]="OneDriveForBusiness",e[e.SharepointOnline=3]="SharepointOnline"}(s||(s={})),function(e){e[e.centered=0]="centered",e[e.rightCenter=1]="rightCenter",e[e.bottomCenter=2]="bottomCenter"}(l||(l={})),function(e){e[e.Location=0]="Location",e[e.Person=1]="Person",e[e.SatoriEntity=2]="SatoriEntity",e[e.Topic=3]="Topic",e[e.File=4]="File"}(d||(d={})),function(e){e[e.light=0]="light",e[e.dark=1]="dark",e[e.highContrast=2]="highContrast",e[e.custom=3]="custom",e[e.teamsLight=4]="teamsLight",e[e.teamsDark=5]="teamsDark"}(u||(u={}))},40313:e=>{function t(e,t,n){var r,i,o,a,s;function l(){var d=Date.now()-a;d<t&&d>=0?r=setTimeout(l,t-d):(r=null,n||(s=e.apply(o,i),o=i=null))}null==t&&(t=100);var d=function(){o=this,i=arguments,a=Date.now();var d=n&&!r;return r||(r=setTimeout(l,t)),d&&(s=e.apply(o,i),o=i=null),s};return d.clear=function(){r&&(clearTimeout(r),r=null)},d.flush=function(){r&&(s=e.apply(o,i),o=i=null,clearTimeout(r),r=null)},d}t.debounce=t,e.exports=t},19846:(e,t,n)=>{"use strict";n.d(t,{OZ:()=>a,Yi:()=>d});var r=n(5e3),i=n(61647);function o(e,t,n,i){var o=function(e){var t=[];if(Array.isArray(e)){var n=function(e){for(var t=new Set,n=0,r=e;n<r.length;n++){var i=r[n];if(t.has(i))return i;t.add(i)}}((t=e).map((function(e){return e.key})));if(void 0!==n)throw new Error(r.YG+" "+n.toString())}else t=[e];return t}(i),a={};Reflect.hasOwnMetadata(e,t)&&(a=Reflect.getMetadata(e,t));var s=a[n];if(void 0===s)s=[];else for(var l=function(e){if(o.some((function(t){return t.key===e.key})))throw new Error(r.YG+" "+e.key.toString())},d=0,u=s;d<u.length;d++)l(u[d]);s.push.apply(s,o),a[n]=s,Reflect.defineMetadata(e,a,t)}function a(e){return function(t,n,a){"number"==typeof a?function(e,t,n,a){!function(e){if(void 0!==e)throw new Error(r.A1)}(t),o(i.Bc,e,n.toString(),a)}(t,n,a,e):function(e,t,n){if(void 0!==e.prototype)throw new Error(r.A1);o(i.b2,e.constructor,t,n)}(t,n,e)}}function s(e,t){Reflect.decorate(e,t)}function l(e,t){return function(n,r){t(n,r,e)}}function d(e,t,n){"number"==typeof n?s([l(n,e)],t):"string"==typeof n?Reflect.decorate([e],t,n):s([e],t)}},90424:(e,t,n)=>{"use strict";n.d(t,{W:()=>i});var r=n(61647),i=(0,n(11650).H)(r.n8)},11650:(e,t,n)=>{"use strict";n.d(t,{H:()=>a});var r=n(5e3),i=n(15348),o=n(19846);function a(e){return function(t){return function(n,a,s){if(void 0===t){var l="function"==typeof n?n.name:n.constructor.name;throw new Error((0,r.bI)(l))}return(0,o.OZ)(new i.O(e,t))(n,a,s)}}}},48828:(e,t,n)=>{"use strict";n.d(t,{_:()=>o});var r=n(5e3),i=n(61647);function o(){return function(e){if(Reflect.hasOwnMetadata(i.O2,e))throw new Error(r.aK);var t=Reflect.getMetadata(i.vI,e)||[];return Reflect.defineMetadata(i.O2,t,e),e}}},30122:(e,t,n)=>{"use strict";n.d(t,{t:()=>i});var r=n(61647),i=(0,n(11650).H)(r.jf)},30225:(e,t,n)=>{"use strict";n.d(t,{l:()=>a});var r=n(61647),i=n(15348),o=n(19846);function a(){return(0,o.OZ)(new i.O(r.Q2,!0))}},5e3:(e,t,n)=>{"use strict";n.d(t,{A1:()=>b,BT:()=>d,CE:()=>x,Ds:()=>c,EC:()=>o,F5:()=>p,Ft:()=>y,Jk:()=>a,KU:()=>T,ML:()=>h,NF:()=>k,No:()=>s,SW:()=>w,U9:()=>f,U_:()=>F,Wj:()=>A,Y1:()=>v,Y3:()=>E,YG:()=>i,Z_:()=>C,aK:()=>r,bI:()=>g,bQ:()=>D,fG:()=>l,jC:()=>I,jf:()=>_,li:()=>S,rg:()=>m,z4:()=>u});var r="Cannot apply @injectable decorator multiple times.",i="Metadata key was used more than once in a parameter:",o="NULL argument",a="Key Not Found",s="Ambiguous match found for serviceIdentifier:",l="Could not unbind serviceIdentifier:",d="No matching bindings found for serviceIdentifier:",u="Missing required @injectable annotation in:",c="Missing required @inject or @multiInject annotation in:",g=function(e){return"@inject called with undefined this could mean that the class "+e+" has a circular dependency problem. You can use a LazyServiceIdentifier to  overcome this limitation."},h="Circular dependency found:",p="Invalid binding type:",f="No snapshot available to restore.",v="Invalid return type in middleware. Middleware must return!",m="Value provided to function binding must be a function!",y=function(e){return"You are attempting to construct '"+e+"' in a synchronous way\n but it has asynchronous dependencies."},_="The toSelf function can only be applied when a constructor is used as service identifier",b="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",C=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"The number of constructor arguments in the derived class "+e[0]+" must be >= than the number of constructor arguments of its base class."},S="Invalid Container constructor argument. Container options must be an object.",T='Invalid Container option. Default scope must be a string ("singleton" or "transient").',I="Invalid Container option. Auto bind injectable must be a boolean",w="Invalid Container option. Skip base check must be a boolean",E="Attempting to unbind dependency with asynchronous destruction (@preDestroy or onDeactivation)",x=function(e,t){return"@postConstruct error in class "+e+": "+t},A=function(e,t){return"@preDestroy error in class "+e+": "+t},D=function(e,t){return"onDeactivation() error in class "+e+": "+t},k=function(e,t){return"It looks like there is a circular dependency in one of the '"+e+"' bindings. Please investigate bindings with service identifier '"+t+"'."},F="Maximum call stack size exceeded"},61647:(e,t,n)=>{"use strict";n.d(t,{Af:()=>o,Bc:()=>d,LX:()=>i,O2:()=>c,P7:()=>r,Q2:()=>a,Vh:()=>p,Z_:()=>h,b2:()=>u,eV:()=>f,jf:()=>l,n8:()=>s,vI:()=>g});var r="named",i="name",o="unmanaged",a="optional",s="inject",l="multi_inject",d="inversify:tagged",u="inversify:tagged_props",c="inversify:paramtypes",g="design:paramtypes",h="post_construct",p="pre_destroy",f=[s,l,i,o,r,a]},15348:(e,t,n)=>{"use strict";n.d(t,{O:()=>i});var r=n(61647),i=function(){function e(e,t){this.key=e,this.value=t}return e.prototype.toString=function(){return this.key===r.P7?"named: "+String(this.value).toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+String(this.value)+" }"},e}()},29688:(e,t,n)=>{"use strict";n.d(t,{P:()=>i});var r=n(61647),i=function(){function e(){}return e.prototype.getConstructorMetadata=function(e){return{compilerGeneratedMetadata:Reflect.getMetadata(r.O2,e),userGeneratedMetadata:Reflect.getMetadata(r.Bc,e)||{}}},e.prototype.getPropertiesMetadata=function(e){return Reflect.getMetadata(r.b2,e)||[]},e}()},46546:(e,t,n)=>{"use strict";function r(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw new Error("number"==typeof e?"[MobX] minified error nr: "+e+(n.length?" "+n.map(String).join(","):"")+". Find the full error at: https://github.com/mobxjs/mobx/blob/main/packages/mobx/src/errors.ts":"[MobX] "+e)}n.r(t),n.d(t,{$mobx:()=>G,FlowCancellationError:()=>vn,ObservableMap:()=>Cr,ObservableSet:()=>Ir,Reaction:()=>kt,_allowStateChanges:()=>$e,_allowStateChangesInsideComputed:()=>Kt,_allowStateReadsEnd:()=>pt,_allowStateReadsStart:()=>ht,_autoAction:()=>Qt,_endAction:()=>Ke,_getAdministration:()=>Gr,_getGlobalState:()=>Ct,_interceptReads:()=>In,_isComputingDerivation:()=>st,_resetGlobalState:()=>St,_startAction:()=>Qe,action:()=>Gt,autorun:()=>Zt,comparer:()=>Z,computed:()=>We,configure:()=>dn,createAtom:()=>$,defineProperty:()=>qn,entries:()=>Bn,extendObservable:()=>un,flow:()=>bn,flowResult:()=>Sn,get:()=>Mn,getAtom:()=>Vr,getDebugName:()=>Qr,getDependencyTree:()=>cn,getObserverTree:()=>hn,has:()=>Ln,intercept:()=>wn,isAction:()=>$t,isBoxedObservable:()=>Ye,isComputed:()=>xn,isComputedProp:()=>An,isFlow:()=>Tn,isFlowCancellationError:()=>mn,isObservable:()=>kn,isObservableArray:()=>mr,isObservableMap:()=>Sr,isObservableObject:()=>Pr,isObservableProp:()=>Fn,isObservableSet:()=>wr,keys:()=>Pn,makeAutoObservable:()=>or,makeObservable:()=>rr,observable:()=>Re,observe:()=>Un,onBecomeObserved:()=>nn,onBecomeUnobserved:()=>rn,onReactionError:()=>Ft,override:()=>ee,ownKeys:()=>Wn,reaction:()=>Yt,remove:()=>Rn,runInAction:()=>Kt,set:()=>On,spy:()=>Lt,toJS:()=>Hn,trace:()=>Vn,transaction:()=>Gn,untracked:()=>ut,values:()=>Nn,when:()=>Qn});var i={};function o(){return"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:i}var a=Object.assign,s=Object.getOwnPropertyDescriptor,l=Object.defineProperty,d=Object.prototype,u=[];Object.freeze(u);var c={};Object.freeze(c);var g="undefined"!=typeof Proxy,h=Object.toString();function p(){g||r("Proxy not available")}function f(e){var t=!1;return function(){if(!t)return t=!0,e.apply(this,arguments)}}var v=function(){};function m(e){return"function"==typeof e}function y(e){switch(typeof e){case"string":case"symbol":case"number":return!0}return!1}function _(e){return null!==e&&"object"==typeof e}function b(e){if(!_(e))return!1;var t=Object.getPrototypeOf(e);if(null==t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n.toString()===h}function C(e){var t=null==e?void 0:e.constructor;return!!t&&("GeneratorFunction"===t.name||"GeneratorFunction"===t.displayName)}function S(e,t,n){l(e,t,{enumerable:!1,writable:!0,configurable:!0,value:n})}function T(e,t,n){l(e,t,{enumerable:!1,writable:!1,configurable:!0,value:n})}function I(e,t){var n="isMobX"+e;return t.prototype[n]=!0,function(e){return _(e)&&!0===e[n]}}function w(e){return null!=e&&"[object Map]"===Object.prototype.toString.call(e)}function E(e){return null!=e&&"[object Set]"===Object.prototype.toString.call(e)}var x=void 0!==Object.getOwnPropertySymbols,A="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:x?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames;function D(e){return null===e?null:"object"==typeof e?""+e:e}function k(e,t){return d.hasOwnProperty.call(e,t)}var F=Object.getOwnPropertyDescriptors||function(e){var t={};return A(e).forEach((function(n){t[n]=s(e,n)})),t};function P(e,t){return!!(e&t)}function N(e,t,n){return n?e|=t:e&=~t,e}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,U(r.key),r)}}function R(e,t,n){return t&&O(e.prototype,t),n&&O(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function L(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return B(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?B(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function M(){return M=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},M.apply(null,arguments)}function q(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,W(e,t)}function W(e,t){return W=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},W(e,t)}function U(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}var z=Symbol("mobx-stored-annotations");function j(e){return Object.assign((function(t,n){if(V(n))return e.decorate_20223_(t,n);H(t,n,e)}),e)}function H(e,t,n){k(e,z)||S(e,z,M({},e[z])),function(e){return e.annotationType_===Y}(n)||(e[z][t]=n)}function V(e){return"object"==typeof e&&"string"==typeof e.kind}var G=Symbol("mobx administration"),Q=function(){function e(e){void 0===e&&(e="Atom"),this.name_=void 0,this.flags_=0,this.observers_=new Set,this.lastAccessedBy_=0,this.lowestObserverState_=tt.NOT_TRACKING_,this.onBOL=void 0,this.onBUOL=void 0,this.name_=e}var t=e.prototype;return t.onBO=function(){this.onBOL&&this.onBOL.forEach((function(e){return e()}))},t.onBUO=function(){this.onBUOL&&this.onBUOL.forEach((function(e){return e()}))},t.reportObserved=function(){return At(this)},t.reportChanged=function(){Et(),Dt(this),xt()},t.toString=function(){return this.name_},R(e,[{key:"isBeingObserved",get:function(){return P(this.flags_,e.isBeingObservedMask_)},set:function(t){this.flags_=N(this.flags_,e.isBeingObservedMask_,t)}},{key:"isPendingUnobservation",get:function(){return P(this.flags_,e.isPendingUnobservationMask_)},set:function(t){this.flags_=N(this.flags_,e.isPendingUnobservationMask_,t)}},{key:"diffValue",get:function(){return P(this.flags_,e.diffValueMask_)?1:0},set:function(t){this.flags_=N(this.flags_,e.diffValueMask_,1===t)}}])}();Q.isBeingObservedMask_=1,Q.isPendingUnobservationMask_=2,Q.diffValueMask_=4;var K=I("Atom",Q);function $(e,t,n){void 0===t&&(t=v),void 0===n&&(n=v);var r=new Q(e);return t!==v&&nn(r,t),n!==v&&rn(r,n),r}var Z={identity:function(e,t){return e===t},structural:function(e,t){return Zr(e,t)},default:function(e,t){return Object.is?Object.is(e,t):e===t?0!==e||1/e==1/t:e!=e&&t!=t},shallow:function(e,t){return Zr(e,t,1)}};function J(e,t,n){return kn(e)?e:Array.isArray(e)?Re.array(e,{name:n}):b(e)?Re.object(e,void 0,{name:n}):w(e)?Re.map(e,{name:n}):E(e)?Re.set(e,{name:n}):"function"!=typeof e||$t(e)||Tn(e)?e:C(e)?bn(e):Qt(n,e)}function X(e){return e}var Y="override",ee=j({annotationType_:Y,make_:function(e,t){return 0},extend_:function(e,t,n,i){r("'"+this.annotationType_+"' can only be used with 'makeObservable'")},decorate_20223_:function(e,t){console.warn("'"+this.annotationType_+"' cannot be used with decorators - this is a no-op")}});function te(e,t){return{annotationType_:e,options_:t,make_:ne,extend_:re,decorate_20223_:ie}}function ne(e,t,n,r){var i;if(null!=(i=this.options_)&&i.bound)return null===this.extend_(e,t,n,!1)?0:1;if(r===e.target_)return null===this.extend_(e,t,n,!1)?0:2;if($t(n.value))return 1;var o=oe(e,this,t,n,!1);return l(r,t,o),2}function re(e,t,n,r){var i=oe(e,this,t,n);return e.defineProperty_(t,i,r)}function ie(e,t){var n=t.kind,i=t.name,o=t.addInitializer,a=this;if("field"!=n){var s,l,d,u,c,g;if("method"==n)return $t(e)||(l=e,e=Ve(null!=(d=null==(u=a.options_)?void 0:u.name)?d:i.toString(),l,null!=(c=null==(g=a.options_)?void 0:g.autoAction)&&c)),null!=(s=this.options_)&&s.bound&&o((function(){var e=this,t=e[i].bind(e);t.isMobxAction=!0,e[i]=t})),e;r("Cannot apply '"+a.annotationType_+"' to '"+String(i)+"' (kind: "+n+"):\n'"+a.annotationType_+"' can only be used on properties with a function value.")}else o((function(){H(this,i,a)}))}function oe(e,t,n,r,i){var o,a,s,l,d,u,c,g;void 0===i&&(i=bt.safeDescriptors),g=r,t.annotationType_,g.value;var h,p=r.value;return null!=(o=t.options_)&&o.bound&&(p=p.bind(null!=(h=e.proxy_)?h:e.target_)),{value:Ve(null!=(a=null==(s=t.options_)?void 0:s.name)?a:n.toString(),p,null!=(l=null==(d=t.options_)?void 0:d.autoAction)&&l,null!=(u=t.options_)&&u.bound?null!=(c=e.proxy_)?c:e.target_:void 0),configurable:!i||e.isPlainObject_,enumerable:!1,writable:!i}}function ae(e,t){return{annotationType_:e,options_:t,make_:se,extend_:le,decorate_20223_:de}}function se(e,t,n,r){var i;if(r===e.target_)return null===this.extend_(e,t,n,!1)?0:2;if(null!=(i=this.options_)&&i.bound&&(!k(e.target_,t)||!Tn(e.target_[t]))&&null===this.extend_(e,t,n,!1))return 0;if(Tn(n.value))return 1;var o=ue(e,this,0,n,!1,!1);return l(r,t,o),2}function le(e,t,n,r){var i,o=ue(e,this,0,n,null==(i=this.options_)?void 0:i.bound);return e.defineProperty_(t,o,r)}function de(e,t){var n,r=t.name,i=t.addInitializer;return Tn(e)||(e=bn(e)),null!=(n=this.options_)&&n.bound&&i((function(){var e=this,t=e[r].bind(e);t.isMobXFlow=!0,e[r]=t})),e}function ue(e,t,n,r,i,o){var a;void 0===o&&(o=bt.safeDescriptors),a=r,t.annotationType_,a.value;var s,l=r.value;return Tn(l)||(l=bn(l)),i&&((l=l.bind(null!=(s=e.proxy_)?s:e.target_)).isMobXFlow=!0),{value:l,configurable:!o||e.isPlainObject_,enumerable:!1,writable:!o}}function ce(e,t){return{annotationType_:e,options_:t,make_:ge,extend_:he,decorate_20223_:pe}}function ge(e,t,n){return null===this.extend_(e,t,n,!1)?0:1}function he(e,t,n,r){return i=n,this.annotationType_,i.get,e.defineComputedProperty_(t,M({},this.options_,{get:n.get,set:n.set}),r);var i}function pe(e,t){var n=this,r=t.name;return(0,t.addInitializer)((function(){var t=Dr(this)[G],i=M({},n.options_,{get:e,context:this});i.name||(i.name="ObservableObject."+r.toString()),t.values_.set(r,new et(i))})),function(){return this[G].getObservablePropValue_(r)}}function fe(e,t){return{annotationType_:e,options_:t,make_:ve,extend_:me,decorate_20223_:ye}}function ve(e,t,n){return null===this.extend_(e,t,n,!1)?0:1}function me(e,t,n,r){var i,o;return this.annotationType_,e.defineObservableProperty_(t,n.value,null!=(i=null==(o=this.options_)?void 0:o.enhancer)?i:J,r)}function ye(e,t){var n=this,r=t.kind,i=t.name,o=new WeakSet;function a(e,t){var r,a,s=Dr(e)[G],l=new Xe(t,null!=(r=null==(a=n.options_)?void 0:a.enhancer)?r:J,"ObservableObject."+i.toString(),!1);s.values_.set(i,l),o.add(e)}if("accessor"==r)return{get:function(){return o.has(this)||a(this,e.get.call(this)),this[G].getObservablePropValue_(i)},set:function(e){return o.has(this)||a(this,e),this[G].setObservablePropValue_(i,e)},init:function(e){return o.has(this)||a(this,e),e}}}var _e="true",be=Ce();function Ce(e){return{annotationType_:_e,options_:e,make_:Se,extend_:Te,decorate_20223_:Ie}}function Se(e,t,n,r){var i,o,a,s;if(n.get)return We.make_(e,t,n,r);if(n.set){var d=Ve(t.toString(),n.set);return r===e.target_?null===e.defineProperty_(t,{configurable:!bt.safeDescriptors||e.isPlainObject_,set:d})?0:2:(l(r,t,{configurable:!0,set:d}),2)}if(r!==e.target_&&"function"==typeof n.value)return C(n.value)?(null!=(s=this.options_)&&s.autoBind?bn.bound:bn).make_(e,t,n,r):(null!=(a=this.options_)&&a.autoBind?Qt.bound:Qt).make_(e,t,n,r);var u,c=!1===(null==(i=this.options_)?void 0:i.deep)?Re.ref:Re;return"function"==typeof n.value&&null!=(o=this.options_)&&o.autoBind&&(n.value=n.value.bind(null!=(u=e.proxy_)?u:e.target_)),c.make_(e,t,n,r)}function Te(e,t,n,r){var i,o,a;return n.get?We.extend_(e,t,n,r):n.set?e.defineProperty_(t,{configurable:!bt.safeDescriptors||e.isPlainObject_,set:Ve(t.toString(),n.set)},r):("function"==typeof n.value&&null!=(i=this.options_)&&i.autoBind&&(n.value=n.value.bind(null!=(a=e.proxy_)?a:e.target_)),(!1===(null==(o=this.options_)?void 0:o.deep)?Re.ref:Re).extend_(e,t,n,r))}function Ie(e,t){r("'"+this.annotationType_+"' cannot be used as a decorator")}var we={deep:!0,name:void 0,defaultDecorator:void 0,proxy:!0};function Ee(e){return e||we}Object.freeze(we);var xe=fe("observable"),Ae=fe("observable.ref",{enhancer:X}),De=fe("observable.shallow",{enhancer:function(e,t,n){return null==e||Pr(e)||mr(e)||Sr(e)||wr(e)?e:Array.isArray(e)?Re.array(e,{name:n,deep:!1}):b(e)?Re.object(e,void 0,{name:n,deep:!1}):w(e)?Re.map(e,{name:n,deep:!1}):E(e)?Re.set(e,{name:n,deep:!1}):void 0}}),ke=fe("observable.struct",{enhancer:function(e,t){return Zr(e,t)?t:e}}),Fe=j(xe);function Pe(e){return!0===e.deep?J:!1===e.deep?X:(t=e.defaultDecorator)&&null!=(n=null==(r=t.options_)?void 0:r.enhancer)?n:J;var t,n,r}function Ne(e,t,n){return V(t)?xe.decorate_20223_(e,t):y(t)?void H(e,t,xe):kn(e)?e:b(e)?Re.object(e,t,n):Array.isArray(e)?Re.array(e,t):w(e)?Re.map(e,t):E(e)?Re.set(e,t):"object"==typeof e&&null!==e?e:Re.box(e,t)}a(Ne,Fe);var Be,Oe,Re=a(Ne,{box:function(e,t){var n=Ee(t);return new Xe(e,Pe(n),n.name,!0,n.equals)},array:function(e,t){var n=Ee(t);return(!1===bt.useProxies||!1===n.proxy?Hr:ur)(e,Pe(n),n.name)},map:function(e,t){var n=Ee(t);return new Cr(e,Pe(n),n.name)},set:function(e,t){var n=Ee(t);return new Ir(e,Pe(n),n.name)},object:function(e,t,n){return Kr((function(){return un(!1===bt.useProxies||!1===(null==n?void 0:n.proxy)?Dr({},n):function(e,t){var n,r;return p(),null!=(r=(n=(e=Dr(e,t))[G]).proxy_)?r:n.proxy_=new Proxy(e,Zn)}({},n),e,t)}))},ref:j(Ae),shallow:j(De),deep:Fe,struct:j(ke)}),Le="computed",Me=ce(Le),qe=ce("computed.struct",{equals:Z.structural}),We=function(e,t){if(V(t))return Me.decorate_20223_(e,t);if(y(t))return H(e,t,Me);if(b(e))return j(ce(Le,e));var n=b(t)?t:{};return n.get=e,n.name||(n.name=e.name||""),new et(n)};Object.assign(We,Me),We.struct=j(qe);var Ue=0,ze=1,je=null!=(Be=null==(Oe=s((function(){}),"name"))?void 0:Oe.configurable)&&Be,He={value:"action",configurable:!0,writable:!1,enumerable:!1};function Ve(e,t,n,r){function i(){return Ge(e,n,t,r||this,arguments)}return void 0===n&&(n=!1),i.isMobxAction=!0,i.toString=function(){return t.toString()},je&&(He.value=e,l(i,"name",He)),i}function Ge(e,t,n,r,i){var o=Qe(0,t);try{return n.apply(r,i)}catch(e){throw o.error_=e,e}finally{Ke(o)}}function Qe(e,t,n,r){var i=bt.trackingDerivation,o=!t||!i;Et();var a=bt.allowStateChanges;o&&(ct(),a=Ze(!0));var s={runAsAction_:o,prevDerivation_:i,prevAllowStateChanges_:a,prevAllowStateReads_:ht(!0),notifySpy_:!1,startTime_:0,actionId_:ze++,parentActionId_:Ue};return Ue=s.actionId_,s}function Ke(e){Ue!==e.actionId_&&r(30),Ue=e.parentActionId_,void 0!==e.error_&&(bt.suppressReactionErrors=!0),Je(e.prevAllowStateChanges_),pt(e.prevAllowStateReads_),xt(),e.runAsAction_&&gt(e.prevDerivation_),bt.suppressReactionErrors=!1}function $e(e,t){var n=Ze(e);try{return t()}finally{Je(n)}}function Ze(e){var t=bt.allowStateChanges;return bt.allowStateChanges=e,t}function Je(e){bt.allowStateChanges=e}var Xe=function(e){function t(t,n,r,i,o){var a;return void 0===r&&(r="ObservableValue"),void 0===i&&(i=!0),void 0===o&&(o=Z.default),(a=e.call(this,r)||this).enhancer=void 0,a.name_=void 0,a.equals=void 0,a.hasUnreportedChange_=!1,a.interceptors_=void 0,a.changeListeners_=void 0,a.value_=void 0,a.dehancer=void 0,a.enhancer=n,a.name_=r,a.equals=o,a.value_=n(t,void 0,r),a}q(t,e);var n=t.prototype;return n.dehanceValue=function(e){return void 0!==this.dehancer?this.dehancer(e):e},n.set=function(e){this.value_,(e=this.prepareNewValue_(e))!==bt.UNCHANGED&&this.setNewValue_(e)},n.prepareNewValue_=function(e){if(Jn(this)){var t=Yn(this,{object:this,type:sr,newValue:e});if(!t)return bt.UNCHANGED;e=t.newValue}return e=this.enhancer(e,this.value_,this.name_),this.equals(this.value_,e)?bt.UNCHANGED:e},n.setNewValue_=function(e){var t=this.value_;this.value_=e,this.reportChanged(),er(this)&&nr(this,{type:sr,object:this,newValue:e,oldValue:t})},n.get=function(){return this.reportObserved(),this.dehanceValue(this.value_)},n.intercept_=function(e){return Xn(this,e)},n.observe_=function(e,t){return t&&e({observableKind:"value",debugObjectName:this.name_,object:this,type:sr,newValue:this.value_,oldValue:void 0}),tr(this,e)},n.raw=function(){return this.value_},n.toJSON=function(){return this.get()},n.toString=function(){return this.name_+"["+this.value_+"]"},n.valueOf=function(){return D(this.get())},n[Symbol.toPrimitive]=function(){return this.valueOf()},t}(Q),Ye=I("ObservableValue",Xe),et=function(){function e(e){this.dependenciesState_=tt.NOT_TRACKING_,this.observing_=[],this.newObserving_=null,this.observers_=new Set,this.runId_=0,this.lastAccessedBy_=0,this.lowestObserverState_=tt.UP_TO_DATE_,this.unboundDepsCount_=0,this.value_=new it(null),this.name_=void 0,this.triggeredBy_=void 0,this.flags_=0,this.derivation=void 0,this.setter_=void 0,this.isTracing_=nt.NONE,this.scope_=void 0,this.equals_=void 0,this.requiresReaction_=void 0,this.keepAlive_=void 0,this.onBOL=void 0,this.onBUOL=void 0,e.get||r(31),this.derivation=e.get,this.name_=e.name||"ComputedValue",e.set&&(this.setter_=Ve("ComputedValue-setter",e.set)),this.equals_=e.equals||(e.compareStructural||e.struct?Z.structural:Z.default),this.scope_=e.context,this.requiresReaction_=e.requiresReaction,this.keepAlive_=!!e.keepAlive}var t=e.prototype;return t.onBecomeStale_=function(){!function(e){e.lowestObserverState_===tt.UP_TO_DATE_&&(e.lowestObserverState_=tt.POSSIBLY_STALE_,e.observers_.forEach((function(e){e.dependenciesState_===tt.UP_TO_DATE_&&(e.dependenciesState_=tt.POSSIBLY_STALE_,e.onBecomeStale_())})))}(this)},t.onBO=function(){this.onBOL&&this.onBOL.forEach((function(e){return e()}))},t.onBUO=function(){this.onBUOL&&this.onBUOL.forEach((function(e){return e()}))},t.get=function(){if(this.isComputing&&r(32,this.name_,this.derivation),0!==bt.inBatch||0!==this.observers_.size||this.keepAlive_){if(At(this),at(this)){var e=bt.trackingContext;this.keepAlive_&&!e&&(bt.trackingContext=this),this.trackAndCompute()&&function(e){e.lowestObserverState_!==tt.STALE_&&(e.lowestObserverState_=tt.STALE_,e.observers_.forEach((function(t){t.dependenciesState_===tt.POSSIBLY_STALE_?t.dependenciesState_=tt.STALE_:t.dependenciesState_===tt.UP_TO_DATE_&&(e.lowestObserverState_=tt.UP_TO_DATE_)})))}(this),bt.trackingContext=e}}else at(this)&&(this.warnAboutUntrackedRead_(),Et(),this.value_=this.computeValue_(!1),xt());var t=this.value_;if(ot(t))throw t.cause;return t},t.set=function(e){if(this.setter_){this.isRunningSetter&&r(33,this.name_),this.isRunningSetter=!0;try{this.setter_.call(this.scope_,e)}finally{this.isRunningSetter=!1}}else r(34,this.name_)},t.trackAndCompute=function(){var e=this.value_,t=this.dependenciesState_===tt.NOT_TRACKING_,n=this.computeValue_(!0),r=t||ot(e)||ot(n)||!this.equals_(e,n);return r&&(this.value_=n),r},t.computeValue_=function(e){this.isComputing=!0;var t,n=Ze(!1);if(e)t=lt(this,this.derivation,this.scope_);else if(!0===bt.disableErrorBoundaries)t=this.derivation.call(this.scope_);else try{t=this.derivation.call(this.scope_)}catch(e){t=new it(e)}return Je(n),this.isComputing=!1,t},t.suspend_=function(){this.keepAlive_||(dt(this),this.value_=void 0)},t.observe_=function(e,t){var n=this,r=!0,i=void 0;return Zt((function(){var o=n.get();if(!r||t){var a=ct();e({observableKind:"computed",debugObjectName:n.name_,type:sr,object:n,newValue:o,oldValue:i}),gt(a)}r=!1,i=o}))},t.warnAboutUntrackedRead_=function(){},t.toString=function(){return this.name_+"["+this.derivation.toString()+"]"},t.valueOf=function(){return D(this.get())},t[Symbol.toPrimitive]=function(){return this.valueOf()},R(e,[{key:"isComputing",get:function(){return P(this.flags_,e.isComputingMask_)},set:function(t){this.flags_=N(this.flags_,e.isComputingMask_,t)}},{key:"isRunningSetter",get:function(){return P(this.flags_,e.isRunningSetterMask_)},set:function(t){this.flags_=N(this.flags_,e.isRunningSetterMask_,t)}},{key:"isBeingObserved",get:function(){return P(this.flags_,e.isBeingObservedMask_)},set:function(t){this.flags_=N(this.flags_,e.isBeingObservedMask_,t)}},{key:"isPendingUnobservation",get:function(){return P(this.flags_,e.isPendingUnobservationMask_)},set:function(t){this.flags_=N(this.flags_,e.isPendingUnobservationMask_,t)}},{key:"diffValue",get:function(){return P(this.flags_,e.diffValueMask_)?1:0},set:function(t){this.flags_=N(this.flags_,e.diffValueMask_,1===t)}}])}();et.isComputingMask_=1,et.isRunningSetterMask_=2,et.isBeingObservedMask_=4,et.isPendingUnobservationMask_=8,et.diffValueMask_=16;var tt,nt,rt=I("ComputedValue",et);!function(e){e[e.NOT_TRACKING_=-1]="NOT_TRACKING_",e[e.UP_TO_DATE_=0]="UP_TO_DATE_",e[e.POSSIBLY_STALE_=1]="POSSIBLY_STALE_",e[e.STALE_=2]="STALE_"}(tt||(tt={})),function(e){e[e.NONE=0]="NONE",e[e.LOG=1]="LOG",e[e.BREAK=2]="BREAK"}(nt||(nt={}));var it=function(e){this.cause=void 0,this.cause=e};function ot(e){return e instanceof it}function at(e){switch(e.dependenciesState_){case tt.UP_TO_DATE_:return!1;case tt.NOT_TRACKING_:case tt.STALE_:return!0;case tt.POSSIBLY_STALE_:for(var t=ht(!0),n=ct(),r=e.observing_,i=r.length,o=0;o<i;o++){var a=r[o];if(rt(a)){if(bt.disableErrorBoundaries)a.get();else try{a.get()}catch(e){return gt(n),pt(t),!0}if(e.dependenciesState_===tt.STALE_)return gt(n),pt(t),!0}}return ft(e),gt(n),pt(t),!1}}function st(){return null!==bt.trackingDerivation}function lt(e,t,n){var r=ht(!0);ft(e),e.newObserving_=new Array(0===e.runId_?100:e.observing_.length),e.unboundDepsCount_=0,e.runId_=++bt.runId;var i,o=bt.trackingDerivation;if(bt.trackingDerivation=e,bt.inBatch++,!0===bt.disableErrorBoundaries)i=t.call(n);else try{i=t.call(n)}catch(e){i=new it(e)}return bt.inBatch--,bt.trackingDerivation=o,function(e){for(var t=e.observing_,n=e.observing_=e.newObserving_,r=tt.UP_TO_DATE_,i=0,o=e.unboundDepsCount_,a=0;a<o;a++){var s=n[a];0===s.diffValue&&(s.diffValue=1,i!==a&&(n[i]=s),i++),s.dependenciesState_>r&&(r=s.dependenciesState_)}for(n.length=i,e.newObserving_=null,o=t.length;o--;){var l=t[o];0===l.diffValue&&It(l,e),l.diffValue=0}for(;i--;){var d=n[i];1===d.diffValue&&(d.diffValue=0,Tt(d,e))}r!==tt.UP_TO_DATE_&&(e.dependenciesState_=r,e.onBecomeStale_())}(e),pt(r),i}function dt(e){var t=e.observing_;e.observing_=[];for(var n=t.length;n--;)It(t[n],e);e.dependenciesState_=tt.NOT_TRACKING_}function ut(e){var t=ct();try{return e()}finally{gt(t)}}function ct(){var e=bt.trackingDerivation;return bt.trackingDerivation=null,e}function gt(e){bt.trackingDerivation=e}function ht(e){var t=bt.allowStateReads;return bt.allowStateReads=e,t}function pt(e){bt.allowStateReads=e}function ft(e){if(e.dependenciesState_!==tt.UP_TO_DATE_){e.dependenciesState_=tt.UP_TO_DATE_;for(var t=e.observing_,n=t.length;n--;)t[n].lowestObserverState_=tt.UP_TO_DATE_}}var vt=["mobxGuid","spyListeners","enforceActions","computedRequiresReaction","reactionRequiresObservable","observableRequiresReaction","allowStateReads","disableErrorBoundaries","runId","UNCHANGED","useProxies"],mt=function(){this.version=6,this.UNCHANGED={},this.trackingDerivation=null,this.trackingContext=null,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!1,this.allowStateReads=!0,this.enforceActions=!0,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1,this.useProxies=!0,this.verifyProxies=!1,this.safeDescriptors=!0},yt=!0,_t=!1,bt=function(){var e=o();return e.__mobxInstanceCount>0&&!e.__mobxGlobals&&(yt=!1),e.__mobxGlobals&&e.__mobxGlobals.version!==(new mt).version&&(yt=!1),yt?e.__mobxGlobals?(e.__mobxInstanceCount+=1,e.__mobxGlobals.UNCHANGED||(e.__mobxGlobals.UNCHANGED={}),e.__mobxGlobals):(e.__mobxInstanceCount=1,e.__mobxGlobals=new mt):(setTimeout((function(){_t||r(35)}),1),new mt)}();function Ct(){return bt}function St(){var e=new mt;for(var t in e)-1===vt.indexOf(t)&&(bt[t]=e[t]);bt.allowStateChanges=!bt.enforceActions}function Tt(e,t){e.observers_.add(t),e.lowestObserverState_>t.dependenciesState_&&(e.lowestObserverState_=t.dependenciesState_)}function It(e,t){e.observers_.delete(t),0===e.observers_.size&&wt(e)}function wt(e){!1===e.isPendingUnobservation&&(e.isPendingUnobservation=!0,bt.pendingUnobservations.push(e))}function Et(){bt.inBatch++}function xt(){if(0==--bt.inBatch){Bt();for(var e=bt.pendingUnobservations,t=0;t<e.length;t++){var n=e[t];n.isPendingUnobservation=!1,0===n.observers_.size&&(n.isBeingObserved&&(n.isBeingObserved=!1,n.onBUO()),n instanceof et&&n.suspend_())}bt.pendingUnobservations=[]}}function At(e){var t=bt.trackingDerivation;return null!==t?(t.runId_!==e.lastAccessedBy_&&(e.lastAccessedBy_=t.runId_,t.newObserving_[t.unboundDepsCount_++]=e,!e.isBeingObserved&&bt.trackingContext&&(e.isBeingObserved=!0,e.onBO())),e.isBeingObserved):(0===e.observers_.size&&bt.inBatch>0&&wt(e),!1)}function Dt(e){e.lowestObserverState_!==tt.STALE_&&(e.lowestObserverState_=tt.STALE_,e.observers_.forEach((function(e){e.dependenciesState_===tt.UP_TO_DATE_&&e.onBecomeStale_(),e.dependenciesState_=tt.STALE_})))}var kt=function(){function e(e,t,n,r){void 0===e&&(e="Reaction"),this.name_=void 0,this.onInvalidate_=void 0,this.errorHandler_=void 0,this.requiresObservable_=void 0,this.observing_=[],this.newObserving_=[],this.dependenciesState_=tt.NOT_TRACKING_,this.runId_=0,this.unboundDepsCount_=0,this.flags_=0,this.isTracing_=nt.NONE,this.name_=e,this.onInvalidate_=t,this.errorHandler_=n,this.requiresObservable_=r}var t=e.prototype;return t.onBecomeStale_=function(){this.schedule_()},t.schedule_=function(){this.isScheduled||(this.isScheduled=!0,bt.pendingReactions.push(this),Bt())},t.runReaction_=function(){if(!this.isDisposed){Et(),this.isScheduled=!1;var e=bt.trackingContext;if(bt.trackingContext=this,at(this)){this.isTrackPending=!0;try{this.onInvalidate_()}catch(e){this.reportExceptionInDerivation_(e)}}bt.trackingContext=e,xt()}},t.track=function(e){if(!this.isDisposed){Et(),this.isRunning=!0;var t=bt.trackingContext;bt.trackingContext=this;var n=lt(this,e,void 0);bt.trackingContext=t,this.isRunning=!1,this.isTrackPending=!1,this.isDisposed&&dt(this),ot(n)&&this.reportExceptionInDerivation_(n.cause),xt()}},t.reportExceptionInDerivation_=function(e){var t=this;if(this.errorHandler_)this.errorHandler_(e,this);else{if(bt.disableErrorBoundaries)throw e;var n="[mobx] uncaught error in '"+this+"'";bt.suppressReactionErrors||console.error(n,e),bt.globalReactionErrorHandlers.forEach((function(n){return n(e,t)}))}},t.dispose=function(){this.isDisposed||(this.isDisposed=!0,this.isRunning||(Et(),dt(this),xt()))},t.getDisposer_=function(e){var t=this,n=function n(){t.dispose(),null==e||null==e.removeEventListener||e.removeEventListener("abort",n)};return null==e||null==e.addEventListener||e.addEventListener("abort",n),n[G]=this,n},t.toString=function(){return"Reaction["+this.name_+"]"},t.trace=function(e){void 0===e&&(e=!1)},R(e,[{key:"isDisposed",get:function(){return P(this.flags_,e.isDisposedMask_)},set:function(t){this.flags_=N(this.flags_,e.isDisposedMask_,t)}},{key:"isScheduled",get:function(){return P(this.flags_,e.isScheduledMask_)},set:function(t){this.flags_=N(this.flags_,e.isScheduledMask_,t)}},{key:"isTrackPending",get:function(){return P(this.flags_,e.isTrackPendingMask_)},set:function(t){this.flags_=N(this.flags_,e.isTrackPendingMask_,t)}},{key:"isRunning",get:function(){return P(this.flags_,e.isRunningMask_)},set:function(t){this.flags_=N(this.flags_,e.isRunningMask_,t)}},{key:"diffValue",get:function(){return P(this.flags_,e.diffValueMask_)?1:0},set:function(t){this.flags_=N(this.flags_,e.diffValueMask_,1===t)}}])}();function Ft(e){return bt.globalReactionErrorHandlers.push(e),function(){var t=bt.globalReactionErrorHandlers.indexOf(e);t>=0&&bt.globalReactionErrorHandlers.splice(t,1)}}kt.isDisposedMask_=1,kt.isScheduledMask_=2,kt.isTrackPendingMask_=4,kt.isRunningMask_=8,kt.diffValueMask_=16;var Pt=100,Nt=function(e){return e()};function Bt(){bt.inBatch>0||bt.isRunningReactions||Nt(Ot)}function Ot(){bt.isRunningReactions=!0;for(var e=bt.pendingReactions,t=0;e.length>0;){++t===Pt&&(console.error("[mobx] cycle in reaction: "+e[0]),e.splice(0));for(var n=e.splice(0),r=0,i=n.length;r<i;r++)n[r].runReaction_()}bt.isRunningReactions=!1}var Rt=I("Reaction",kt);function Lt(e){return console.warn("[mobx.spy] Is a no-op in production builds"),function(){}}var Mt="action",qt="autoAction",Wt="<unnamed action>",Ut=te(Mt),zt=te("action.bound",{bound:!0}),jt=te(qt,{autoAction:!0}),Ht=te("autoAction.bound",{autoAction:!0,bound:!0});function Vt(e){return function(t,n){return m(t)?Ve(t.name||Wt,t,e):m(n)?Ve(t,n,e):V(n)?(e?jt:Ut).decorate_20223_(t,n):y(n)?H(t,n,e?jt:Ut):y(t)?j(te(e?qt:Mt,{name:t,autoAction:e})):void 0}}var Gt=Vt(!1);Object.assign(Gt,Ut);var Qt=Vt(!0);function Kt(e){return Ge(e.name,!1,e,this,void 0)}function $t(e){return m(e)&&!0===e.isMobxAction}function Zt(e,t){var n,r,i,o;void 0===t&&(t=c);var a,s=null!=(n=null==(r=t)?void 0:r.name)?n:"Autorun";if(t.scheduler||t.delay){var l=Xt(t),d=!1;a=new kt(s,(function(){d||(d=!0,l((function(){d=!1,a.isDisposed||a.track(u)})))}),t.onError,t.requiresObservable)}else a=new kt(s,(function(){this.track(u)}),t.onError,t.requiresObservable);function u(){e(a)}return null!=(i=t)&&null!=(i=i.signal)&&i.aborted||a.schedule_(),a.getDisposer_(null==(o=t)?void 0:o.signal)}Object.assign(Qt,jt),Gt.bound=j(zt),Qt.bound=j(Ht);var Jt=function(e){return e()};function Xt(e){return e.scheduler?e.scheduler:e.delay?function(t){return setTimeout(t,e.delay)}:Jt}function Yt(e,t,n){var r,i,o;void 0===n&&(n=c);var a,s,l,d=null!=(r=n.name)?r:"Reaction",u=Gt(d,n.onError?(a=n.onError,s=t,function(){try{return s.apply(this,arguments)}catch(e){a.call(this,e)}}):t),g=!n.scheduler&&!n.delay,h=Xt(n),p=!0,f=!1,v=n.compareStructural?Z.structural:n.equals||Z.default,m=new kt(d,(function(){p||g?y():f||(f=!0,h(y))}),n.onError,n.requiresObservable);function y(){if(f=!1,!m.isDisposed){var t=!1,r=l;m.track((function(){var n=$e(!1,(function(){return e(m)}));t=p||!v(l,n),l=n})),(p&&n.fireImmediately||!p&&t)&&u(l,r,m),p=!1}}return null!=(i=n)&&null!=(i=i.signal)&&i.aborted||m.schedule_(),m.getDisposer_(null==(o=n)?void 0:o.signal)}var en="onBO",tn="onBUO";function nn(e,t,n){return on(en,e,t,n)}function rn(e,t,n){return on(tn,e,t,n)}function on(e,t,n,r){var i="function"==typeof r?Vr(t,n):Vr(t),o=m(r)?r:n,a=e+"L";return i[a]?i[a].add(o):i[a]=new Set([o]),function(){var e=i[a];e&&(e.delete(o),0===e.size&&delete i[a])}}var an="never",sn="always",ln="observed";function dn(e){!0===e.isolateGlobalState&&function(){if((bt.pendingReactions.length||bt.inBatch||bt.isRunningReactions)&&r(36),_t=!0,yt){var e=o();0==--e.__mobxInstanceCount&&(e.__mobxGlobals=void 0),bt=new mt}}();var t,n,i=e.useProxies,a=e.enforceActions;if(void 0!==i&&(bt.useProxies=i===sn||i!==an&&"undefined"!=typeof Proxy),"ifavailable"===i&&(bt.verifyProxies=!0),void 0!==a){var s=a===sn?sn:a===ln;bt.enforceActions=s,bt.allowStateChanges=!0!==s&&s!==sn}["computedRequiresReaction","reactionRequiresObservable","observableRequiresReaction","disableErrorBoundaries","safeDescriptors"].forEach((function(t){t in e&&(bt[t]=!!e[t])})),bt.allowStateReads=!bt.observableRequiresReaction,e.reactionScheduler&&(t=e.reactionScheduler,n=Nt,Nt=function(e){return t((function(){return n(e)}))})}function un(e,t,n,r){var i=F(t);return Kr((function(){var t=Dr(e,r)[G];A(i).forEach((function(e){t.extend_(e,i[e],!n||!(e in n)||n[e])}))})),e}function cn(e,t){return gn(Vr(e,t))}function gn(e){var t,n={name:e.name_};return e.observing_&&e.observing_.length>0&&(n.dependencies=(t=e.observing_,Array.from(new Set(t))).map(gn)),n}function hn(e,t){return pn(Vr(e,t))}function pn(e){var t={name:e.name_};return function(e){return e.observers_&&e.observers_.size>0}(e)&&(t.observers=Array.from(function(e){return e.observers_}(e)).map(pn)),t}var fn=0;function vn(){this.message="FLOW_CANCELLED"}function mn(e){return e instanceof vn}vn.prototype=Object.create(Error.prototype);var yn=ae("flow"),_n=ae("flow.bound",{bound:!0}),bn=Object.assign((function(e,t){if(V(t))return yn.decorate_20223_(e,t);if(y(t))return H(e,t,yn);var n=e,r=n.name||"<unnamed flow>",i=function(){var e,t=arguments,i=++fn,o=Gt(r+" - runid: "+i+" - init",n).apply(this,t),a=void 0,s=new Promise((function(t,n){var s=0;function l(e){var t;a=void 0;try{t=Gt(r+" - runid: "+i+" - yield "+s++,o.next).call(o,e)}catch(e){return n(e)}u(t)}function d(e){var t;a=void 0;try{t=Gt(r+" - runid: "+i+" - yield "+s++,o.throw).call(o,e)}catch(e){return n(e)}u(t)}function u(e){if(!m(null==e?void 0:e.then))return e.done?t(e.value):(a=Promise.resolve(e.value)).then(l,d);e.then(u,n)}e=n,l(void 0)}));return s.cancel=Gt(r+" - runid: "+i+" - cancel",(function(){try{a&&Cn(a);var t=o.return(void 0),n=Promise.resolve(t.value);n.then(v,v),Cn(n),e(new vn)}catch(t){e(t)}})),s};return i.isMobXFlow=!0,i}),yn);function Cn(e){m(e.cancel)&&e.cancel()}function Sn(e){return e}function Tn(e){return!0===(null==e?void 0:e.isMobXFlow)}function In(e,t,n){var r;return Sr(e)||mr(e)||Ye(e)?r=Gr(e):Pr(e)&&(r=Gr(e,t)),r.dehancer="function"==typeof t?t:n,function(){r.dehancer=void 0}}function wn(e,t,n){return m(n)?function(e,t,n){return Gr(e,t).intercept_(n)}(e,t,n):function(e,t){return Gr(e).intercept_(t)}(e,t)}function En(e,t){if(void 0===t)return rt(e);if(!1===Pr(e))return!1;if(!e[G].values_.has(t))return!1;var n=Vr(e,t);return rt(n)}function xn(e){return En(e)}function An(e,t){return En(e,t)}function Dn(e,t){return!!e&&(void 0!==t?!!Pr(e)&&e[G].values_.has(t):Pr(e)||!!e[G]||K(e)||Rt(e)||rt(e))}function kn(e){return Dn(e)}function Fn(e,t){return Dn(e,t)}function Pn(e){return Pr(e)?e[G].keys_():Sr(e)||wr(e)?Array.from(e.keys()):mr(e)?e.map((function(e,t){return t})):void r(5)}function Nn(e){return Pr(e)?Pn(e).map((function(t){return e[t]})):Sr(e)?Pn(e).map((function(t){return e.get(t)})):wr(e)?Array.from(e.values()):mr(e)?e.slice():void r(6)}function Bn(e){return Pr(e)?Pn(e).map((function(t){return[t,e[t]]})):Sr(e)?Pn(e).map((function(t){return[t,e.get(t)]})):wr(e)?Array.from(e.entries()):mr(e)?e.map((function(e,t){return[t,e]})):void r(7)}function On(e,t,n){if(2!==arguments.length||wr(e))Pr(e)?e[G].set_(t,n):Sr(e)?e.set(t,n):wr(e)?e.add(t):mr(e)?("number"!=typeof t&&(t=parseInt(t,10)),t<0&&r("Invalid index: '"+t+"'"),Et(),t>=e.length&&(e.length=t+1),e[t]=n,xt()):r(8);else{Et();var i=t;try{for(var o in i)On(e,o,i[o])}finally{xt()}}}function Rn(e,t){Pr(e)?e[G].delete_(t):Sr(e)||wr(e)?e.delete(t):mr(e)?("number"!=typeof t&&(t=parseInt(t,10)),e.splice(t,1)):r(9)}function Ln(e,t){return Pr(e)?e[G].has_(t):Sr(e)||wr(e)?e.has(t):mr(e)?t>=0&&t<e.length:void r(10)}function Mn(e,t){if(Ln(e,t))return Pr(e)?e[G].get_(t):Sr(e)?e.get(t):mr(e)?e[t]:void r(11)}function qn(e,t,n){if(Pr(e))return e[G].defineProperty_(t,n);r(39)}function Wn(e){if(Pr(e))return e[G].ownKeys_();r(38)}function Un(e,t,n,r){return m(n)?function(e,t,n,r){return Gr(e,t).observe_(n,r)}(e,t,n,r):function(e,t,n){return Gr(e).observe_(t,n)}(e,t,n)}function zn(e,t,n){return e.set(t,n),n}function jn(e,t){if(null==e||"object"!=typeof e||e instanceof Date||!kn(e))return e;if(Ye(e)||rt(e))return jn(e.get(),t);if(t.has(e))return t.get(e);if(mr(e)){var n=zn(t,e,new Array(e.length));return e.forEach((function(e,r){n[r]=jn(e,t)})),n}if(wr(e)){var r=zn(t,e,new Set);return e.forEach((function(e){r.add(jn(e,t))})),r}if(Sr(e)){var i=zn(t,e,new Map);return e.forEach((function(e,n){i.set(n,jn(e,t))})),i}var o=zn(t,e,{});return Wn(e).forEach((function(n){d.propertyIsEnumerable.call(e,n)&&(o[n]=jn(e[n],t))})),o}function Hn(e,t){return jn(e,new Map)}function Vn(){}function Gn(e,t){void 0===t&&(t=void 0),Et();try{return e.apply(t)}finally{xt()}}function Qn(e,t,n){return 1===arguments.length||t&&"object"==typeof t?function(e,t){var n,r,i;if(null!=t&&null!=(n=t.signal)&&n.aborted)return Object.assign(Promise.reject(new Error("WHEN_ABORTED")),{cancel:function(){return null}});var o=new Promise((function(n,o){var a,s=Kn(e,n,M({},t,{onError:o}));r=function(){s(),o(new Error("WHEN_CANCELLED"))},i=function(){s(),o(new Error("WHEN_ABORTED"))},null==t||null==(a=t.signal)||null==a.addEventListener||a.addEventListener("abort",i)})).finally((function(){var e;return null==t||null==(e=t.signal)||null==e.removeEventListener?void 0:e.removeEventListener("abort",i)}));return o.cancel=r,o}(e,t):Kn(e,t,n||{})}function Kn(e,t,n){var r;if("number"==typeof n.timeout){var i=new Error("WHEN_TIMEOUT");r=setTimeout((function(){if(!a[G].isDisposed){if(a(),!n.onError)throw i;n.onError(i)}}),n.timeout)}n.name="When";var o=Ve("When-effect",t),a=Zt((function(t){$e(!1,e)&&(t.dispose(),r&&clearTimeout(r),o())}),n);return a}function $n(e){return e[G]}bn.bound=j(_n);var Zn={has:function(e,t){return $n(e).has_(t)},get:function(e,t){return $n(e).get_(t)},set:function(e,t,n){var r;return!!y(t)&&(null==(r=$n(e).set_(t,n,!0))||r)},deleteProperty:function(e,t){var n;return!!y(t)&&(null==(n=$n(e).delete_(t,!0))||n)},defineProperty:function(e,t,n){var r;return null==(r=$n(e).defineProperty_(t,n))||r},ownKeys:function(e){return $n(e).ownKeys_()},preventExtensions:function(e){r(13)}};function Jn(e){return void 0!==e.interceptors_&&e.interceptors_.length>0}function Xn(e,t){var n=e.interceptors_||(e.interceptors_=[]);return n.push(t),f((function(){var e=n.indexOf(t);-1!==e&&n.splice(e,1)}))}function Yn(e,t){var n=ct();try{for(var i=[].concat(e.interceptors_||[]),o=0,a=i.length;o<a&&((t=i[o](t))&&!t.type&&r(14),t);o++);return t}finally{gt(n)}}function er(e){return void 0!==e.changeListeners_&&e.changeListeners_.length>0}function tr(e,t){var n=e.changeListeners_||(e.changeListeners_=[]);return n.push(t),f((function(){var e=n.indexOf(t);-1!==e&&n.splice(e,1)}))}function nr(e,t){var n=ct(),r=e.changeListeners_;if(r){for(var i=0,o=(r=r.slice()).length;i<o;i++)r[i](t);gt(n)}}function rr(e,t,n){return Kr((function(){var r=Dr(e,n)[G];null!=t||(t=function(e){return k(e,z)||S(e,z,M({},e[z])),e[z]}(e)),A(t).forEach((function(e){return r.make_(e,t[e])}))})),e}var ir=Symbol("mobx-keys");function or(e,t,n){return b(e)?un(e,e,t,n):(Kr((function(){var r=Dr(e,n)[G];if(!e[ir]){var i=Object.getPrototypeOf(e),o=new Set([].concat(A(e),A(i)));o.delete("constructor"),o.delete(G),S(i,ir,o)}e[ir].forEach((function(e){return r.make_(e,!t||!(e in t)||t[e])}))})),e)}var ar="splice",sr="update",lr={get:function(e,t){var n=e[G];return t===G?n:"length"===t?n.getArrayLength_():"string"!=typeof t||isNaN(t)?k(cr,t)?cr[t]:e[t]:n.get_(parseInt(t))},set:function(e,t,n){var r=e[G];return"length"===t&&r.setArrayLength_(n),"symbol"==typeof t||isNaN(t)?e[t]=n:r.set_(parseInt(t),n),!0},preventExtensions:function(){r(15)}},dr=function(){function e(e,t,n,r){void 0===e&&(e="ObservableArray"),this.owned_=void 0,this.legacyMode_=void 0,this.atom_=void 0,this.values_=[],this.interceptors_=void 0,this.changeListeners_=void 0,this.enhancer_=void 0,this.dehancer=void 0,this.proxy_=void 0,this.lastKnownLength_=0,this.owned_=n,this.legacyMode_=r,this.atom_=new Q(e),this.enhancer_=function(e,n){return t(e,n,"ObservableArray[..]")}}var t=e.prototype;return t.dehanceValue_=function(e){return void 0!==this.dehancer?this.dehancer(e):e},t.dehanceValues_=function(e){return void 0!==this.dehancer&&e.length>0?e.map(this.dehancer):e},t.intercept_=function(e){return Xn(this,e)},t.observe_=function(e,t){return void 0===t&&(t=!1),t&&e({observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:"splice",index:0,added:this.values_.slice(),addedCount:this.values_.length,removed:[],removedCount:0}),tr(this,e)},t.getArrayLength_=function(){return this.atom_.reportObserved(),this.values_.length},t.setArrayLength_=function(e){("number"!=typeof e||isNaN(e)||e<0)&&r("Out of range: "+e);var t=this.values_.length;if(e!==t)if(e>t){for(var n=new Array(e-t),i=0;i<e-t;i++)n[i]=void 0;this.spliceWithArray_(t,0,n)}else this.spliceWithArray_(e,t-e)},t.updateArrayLength_=function(e,t){e!==this.lastKnownLength_&&r(16),this.lastKnownLength_+=t,this.legacyMode_&&t>0&&jr(e+t+1)},t.spliceWithArray_=function(e,t,n){var r=this;this.atom_;var i=this.values_.length;if(void 0===e?e=0:e>i?e=i:e<0&&(e=Math.max(0,i+e)),t=1===arguments.length?i-e:null==t?0:Math.max(0,Math.min(t,i-e)),void 0===n&&(n=u),Jn(this)){var o=Yn(this,{object:this.proxy_,type:ar,index:e,removedCount:t,added:n});if(!o)return u;t=o.removedCount,n=o.added}if(n=0===n.length?n:n.map((function(e){return r.enhancer_(e,void 0)})),this.legacyMode_){var a=n.length-t;this.updateArrayLength_(i,a)}var s=this.spliceItemsIntoValues_(e,t,n);return 0===t&&0===n.length||this.notifyArraySplice_(e,n,s),this.dehanceValues_(s)},t.spliceItemsIntoValues_=function(e,t,n){var r;if(n.length<1e4)return(r=this.values_).splice.apply(r,[e,t].concat(n));var i=this.values_.slice(e,e+t),o=this.values_.slice(e+t);this.values_.length+=n.length-t;for(var a=0;a<n.length;a++)this.values_[e+a]=n[a];for(var s=0;s<o.length;s++)this.values_[e+n.length+s]=o[s];return i},t.notifyArrayChildUpdate_=function(e,t,n){var r=!this.owned_&&!1,i=er(this),o=i||r?{observableKind:"array",object:this.proxy_,type:sr,debugObjectName:this.atom_.name_,index:e,newValue:t,oldValue:n}:null;this.atom_.reportChanged(),i&&nr(this,o)},t.notifyArraySplice_=function(e,t,n){var r=!this.owned_&&!1,i=er(this),o=i||r?{observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:ar,index:e,removed:n,added:t,removedCount:n.length,addedCount:t.length}:null;this.atom_.reportChanged(),i&&nr(this,o)},t.get_=function(e){if(!(this.legacyMode_&&e>=this.values_.length))return this.atom_.reportObserved(),this.dehanceValue_(this.values_[e]);console.warn("[mobx] Out of bounds read: "+e)},t.set_=function(e,t){var n=this.values_;if(this.legacyMode_&&e>n.length&&r(17,e,n.length),e<n.length){this.atom_;var i=n[e];if(Jn(this)){var o=Yn(this,{type:sr,object:this.proxy_,index:e,newValue:t});if(!o)return;t=o.newValue}(t=this.enhancer_(t,i))!==i&&(n[e]=t,this.notifyArrayChildUpdate_(e,t,i))}else{for(var a=new Array(e+1-n.length),s=0;s<a.length-1;s++)a[s]=void 0;a[a.length-1]=t,this.spliceWithArray_(n.length,0,a)}},e}();function ur(e,t,n,r){return void 0===n&&(n="ObservableArray"),void 0===r&&(r=!1),p(),Kr((function(){var i=new dr(n,t,r,!1);T(i.values_,G,i);var o=new Proxy(i.values_,lr);return i.proxy_=o,e&&e.length&&i.spliceWithArray_(0,0,e),o}))}var cr={clear:function(){return this.splice(0)},replace:function(e){var t=this[G];return t.spliceWithArray_(0,t.values_.length,e)},toJSON:function(){return this.slice()},splice:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var o=this[G];switch(arguments.length){case 0:return[];case 1:return o.spliceWithArray_(e);case 2:return o.spliceWithArray_(e,t)}return o.spliceWithArray_(e,t,r)},spliceWithArray:function(e,t,n){return this[G].spliceWithArray_(e,t,n)},push:function(){for(var e=this[G],t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.spliceWithArray_(e.values_.length,0,n),e.values_.length},pop:function(){return this.splice(Math.max(this[G].values_.length-1,0),1)[0]},shift:function(){return this.splice(0,1)[0]},unshift:function(){for(var e=this[G],t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.spliceWithArray_(0,0,n),e.values_.length},reverse:function(){return bt.trackingDerivation&&r(37,"reverse"),this.replace(this.slice().reverse()),this},sort:function(){bt.trackingDerivation&&r(37,"sort");var e=this.slice();return e.sort.apply(e,arguments),this.replace(e),this},remove:function(e){var t=this[G],n=t.dehanceValues_(t.values_).indexOf(e);return n>-1&&(this.splice(n,1),!0)}};function gr(e,t){"function"==typeof Array.prototype[e]&&(cr[e]=t(e))}function hr(e){return function(){var t=this[G];t.atom_.reportObserved();var n=t.dehanceValues_(t.values_);return n[e].apply(n,arguments)}}function pr(e){return function(t,n){var r=this,i=this[G];return i.atom_.reportObserved(),i.dehanceValues_(i.values_)[e]((function(e,i){return t.call(n,e,i,r)}))}}function fr(e){return function(){var t=this,n=this[G];n.atom_.reportObserved();var r=n.dehanceValues_(n.values_),i=arguments[0];return arguments[0]=function(e,n,r){return i(e,n,r,t)},r[e].apply(r,arguments)}}gr("at",hr),gr("concat",hr),gr("flat",hr),gr("includes",hr),gr("indexOf",hr),gr("join",hr),gr("lastIndexOf",hr),gr("slice",hr),gr("toString",hr),gr("toLocaleString",hr),gr("toSorted",hr),gr("toSpliced",hr),gr("with",hr),gr("every",pr),gr("filter",pr),gr("find",pr),gr("findIndex",pr),gr("findLast",pr),gr("findLastIndex",pr),gr("flatMap",pr),gr("forEach",pr),gr("map",pr),gr("some",pr),gr("toReversed",pr),gr("reduce",fr),gr("reduceRight",fr);var vr=I("ObservableArrayAdministration",dr);function mr(e){return _(e)&&vr(e[G])}var yr={},_r="add",br="delete",Cr=function(){function e(e,t,n){var i=this;void 0===t&&(t=J),void 0===n&&(n="ObservableMap"),this.enhancer_=void 0,this.name_=void 0,this[G]=yr,this.data_=void 0,this.hasMap_=void 0,this.keysAtom_=void 0,this.interceptors_=void 0,this.changeListeners_=void 0,this.dehancer=void 0,this.enhancer_=t,this.name_=n,m(Map)||r(18),Kr((function(){i.keysAtom_=$("ObservableMap.keys()"),i.data_=new Map,i.hasMap_=new Map,e&&i.merge(e)}))}var t=e.prototype;return t.has_=function(e){return this.data_.has(e)},t.has=function(e){var t=this;if(!bt.trackingDerivation)return this.has_(e);var n=this.hasMap_.get(e);if(!n){var r=n=new Xe(this.has_(e),X,"ObservableMap.key?",!1);this.hasMap_.set(e,r),rn(r,(function(){return t.hasMap_.delete(e)}))}return n.get()},t.set=function(e,t){var n=this.has_(e);if(Jn(this)){var r=Yn(this,{type:n?sr:_r,object:this,newValue:t,name:e});if(!r)return this;t=r.newValue}return n?this.updateValue_(e,t):this.addValue_(e,t),this},t.delete=function(e){var t=this;if(this.keysAtom_,Jn(this)&&!Yn(this,{type:br,object:this,name:e}))return!1;if(this.has_(e)){var n=er(this),r=n?{observableKind:"map",debugObjectName:this.name_,type:br,object:this,oldValue:this.data_.get(e).value_,name:e}:null;return Gn((function(){var n;t.keysAtom_.reportChanged(),null==(n=t.hasMap_.get(e))||n.setNewValue_(!1),t.data_.get(e).setNewValue_(void 0),t.data_.delete(e)})),n&&nr(this,r),!0}return!1},t.updateValue_=function(e,t){var n=this.data_.get(e);if((t=n.prepareNewValue_(t))!==bt.UNCHANGED){var r=er(this),i=r?{observableKind:"map",debugObjectName:this.name_,type:sr,object:this,oldValue:n.value_,name:e,newValue:t}:null;n.setNewValue_(t),r&&nr(this,i)}},t.addValue_=function(e,t){var n=this;this.keysAtom_,Gn((function(){var r,i=new Xe(t,n.enhancer_,"ObservableMap.key",!1);n.data_.set(e,i),t=i.value_,null==(r=n.hasMap_.get(e))||r.setNewValue_(!0),n.keysAtom_.reportChanged()}));var r=er(this),i=r?{observableKind:"map",debugObjectName:this.name_,type:_r,object:this,name:e,newValue:t}:null;r&&nr(this,i)},t.get=function(e){return this.has(e)?this.dehanceValue_(this.data_.get(e).get()):this.dehanceValue_(void 0)},t.dehanceValue_=function(e){return void 0!==this.dehancer?this.dehancer(e):e},t.keys=function(){return this.keysAtom_.reportObserved(),this.data_.keys()},t.values=function(){var e=this,t=this.keys();return Yr({next:function(){var n=t.next(),r=n.done,i=n.value;return{done:r,value:r?void 0:e.get(i)}}})},t.entries=function(){var e=this,t=this.keys();return Yr({next:function(){var n=t.next(),r=n.done,i=n.value;return{done:r,value:r?void 0:[i,e.get(i)]}}})},t[Symbol.iterator]=function(){return this.entries()},t.forEach=function(e,t){for(var n,r=L(this);!(n=r()).done;){var i=n.value,o=i[0],a=i[1];e.call(t,a,o,this)}},t.merge=function(e){var t=this;return Sr(e)&&(e=new Map(e)),Gn((function(){var n,i,o;b(e)?function(e){var t=Object.keys(e);if(!x)return t;var n=Object.getOwnPropertySymbols(e);return n.length?[].concat(t,n.filter((function(t){return d.propertyIsEnumerable.call(e,t)}))):t}(e).forEach((function(n){return t.set(n,e[n])})):Array.isArray(e)?e.forEach((function(e){var n=e[0],r=e[1];return t.set(n,r)})):w(e)?(n=e,i=Object.getPrototypeOf(n),o=Object.getPrototypeOf(i),null!==Object.getPrototypeOf(o)&&r(19,e),e.forEach((function(e,n){return t.set(n,e)}))):null!=e&&r(20,e)})),this},t.clear=function(){var e=this;Gn((function(){ut((function(){for(var t,n=L(e.keys());!(t=n()).done;){var r=t.value;e.delete(r)}}))}))},t.replace=function(e){var t=this;return Gn((function(){for(var n,i=function(e){if(w(e)||Sr(e))return e;if(Array.isArray(e))return new Map(e);if(b(e)){var t=new Map;for(var n in e)t.set(n,e[n]);return t}return r(21,e)}(e),o=new Map,a=!1,s=L(t.data_.keys());!(n=s()).done;){var l=n.value;if(!i.has(l))if(t.delete(l))a=!0;else{var d=t.data_.get(l);o.set(l,d)}}for(var u,c=L(i.entries());!(u=c()).done;){var g=u.value,h=g[0],p=g[1],f=t.data_.has(h);if(t.set(h,p),t.data_.has(h)){var v=t.data_.get(h);o.set(h,v),f||(a=!0)}}if(!a)if(t.data_.size!==o.size)t.keysAtom_.reportChanged();else for(var m=t.data_.keys(),y=o.keys(),_=m.next(),C=y.next();!_.done;){if(_.value!==C.value){t.keysAtom_.reportChanged();break}_=m.next(),C=y.next()}t.data_=o})),this},t.toString=function(){return"[object ObservableMap]"},t.toJSON=function(){return Array.from(this)},t.observe_=function(e,t){return tr(this,e)},t.intercept_=function(e){return Xn(this,e)},R(e,[{key:"size",get:function(){return this.keysAtom_.reportObserved(),this.data_.size}},{key:Symbol.toStringTag,get:function(){return"Map"}}])}(),Sr=I("ObservableMap",Cr),Tr={},Ir=function(){function e(e,t,n){var i=this;void 0===t&&(t=J),void 0===n&&(n="ObservableSet"),this.name_=void 0,this[G]=Tr,this.data_=new Set,this.atom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.dehancer=void 0,this.enhancer_=void 0,this.name_=n,m(Set)||r(22),this.enhancer_=function(e,r){return t(e,r,n)},Kr((function(){i.atom_=$(i.name_),e&&i.replace(e)}))}var t=e.prototype;return t.dehanceValue_=function(e){return void 0!==this.dehancer?this.dehancer(e):e},t.clear=function(){var e=this;Gn((function(){ut((function(){for(var t,n=L(e.data_.values());!(t=n()).done;){var r=t.value;e.delete(r)}}))}))},t.forEach=function(e,t){for(var n,r=L(this);!(n=r()).done;){var i=n.value;e.call(t,i,i,this)}},t.add=function(e){var t=this;if(this.atom_,Jn(this)&&!Yn(this,{type:_r,object:this,newValue:e}))return this;if(!this.has(e)){Gn((function(){t.data_.add(t.enhancer_(e,void 0)),t.atom_.reportChanged()}));var n=er(this),r=n?{observableKind:"set",debugObjectName:this.name_,type:_r,object:this,newValue:e}:null;n&&nr(this,r)}return this},t.delete=function(e){var t=this;if(Jn(this)&&!Yn(this,{type:br,object:this,oldValue:e}))return!1;if(this.has(e)){var n=er(this),r=n?{observableKind:"set",debugObjectName:this.name_,type:br,object:this,oldValue:e}:null;return Gn((function(){t.atom_.reportChanged(),t.data_.delete(e)})),n&&nr(this,r),!0}return!1},t.has=function(e){return this.atom_.reportObserved(),this.data_.has(this.dehanceValue_(e))},t.entries=function(){var e=0,t=Array.from(this.keys()),n=Array.from(this.values());return Yr({next:function(){var r=e;return e+=1,r<n.length?{value:[t[r],n[r]],done:!1}:{done:!0}}})},t.keys=function(){return this.values()},t.values=function(){this.atom_.reportObserved();var e=this,t=0,n=Array.from(this.data_.values());return Yr({next:function(){return t<n.length?{value:e.dehanceValue_(n[t++]),done:!1}:{done:!0}}})},t.intersection=function(e){return E(e)?e.intersection(this):new Set(this).intersection(e)},t.union=function(e){return E(e)?e.union(this):new Set(this).union(e)},t.difference=function(e){return new Set(this).difference(e)},t.symmetricDifference=function(e){return E(e)?e.symmetricDifference(this):new Set(this).symmetricDifference(e)},t.isSubsetOf=function(e){return new Set(this).isSubsetOf(e)},t.isSupersetOf=function(e){return new Set(this).isSupersetOf(e)},t.isDisjointFrom=function(e){return E(e)?e.isDisjointFrom(this):new Set(this).isDisjointFrom(e)},t.replace=function(e){var t=this;return wr(e)&&(e=new Set(e)),Gn((function(){Array.isArray(e)||E(e)?(t.clear(),e.forEach((function(e){return t.add(e)}))):null!=e&&r("Cannot initialize set from "+e)})),this},t.observe_=function(e,t){return tr(this,e)},t.intercept_=function(e){return Xn(this,e)},t.toJSON=function(){return Array.from(this)},t.toString=function(){return"[object ObservableSet]"},t[Symbol.iterator]=function(){return this.values()},R(e,[{key:"size",get:function(){return this.atom_.reportObserved(),this.data_.size}},{key:Symbol.toStringTag,get:function(){return"Set"}}])}(),wr=I("ObservableSet",Ir),Er=Object.create(null),xr="remove",Ar=function(){function e(e,t,n,r){void 0===t&&(t=new Map),void 0===r&&(r=be),this.target_=void 0,this.values_=void 0,this.name_=void 0,this.defaultAnnotation_=void 0,this.keysAtom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.proxy_=void 0,this.isPlainObject_=void 0,this.appliedAnnotations_=void 0,this.pendingKeys_=void 0,this.target_=e,this.values_=t,this.name_=n,this.defaultAnnotation_=r,this.keysAtom_=new Q("ObservableObject.keys"),this.isPlainObject_=b(this.target_)}var t=e.prototype;return t.getObservablePropValue_=function(e){return this.values_.get(e).get()},t.setObservablePropValue_=function(e,t){var n=this.values_.get(e);if(n instanceof et)return n.set(t),!0;if(Jn(this)){var r=Yn(this,{type:sr,object:this.proxy_||this.target_,name:e,newValue:t});if(!r)return null;t=r.newValue}if((t=n.prepareNewValue_(t))!==bt.UNCHANGED){var i=er(this),o=i?{type:sr,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,oldValue:n.value_,name:e,newValue:t}:null;n.setNewValue_(t),i&&nr(this,o)}return!0},t.get_=function(e){return bt.trackingDerivation&&!k(this.target_,e)&&this.has_(e),this.target_[e]},t.set_=function(e,t,n){return void 0===n&&(n=!1),k(this.target_,e)?this.values_.has(e)?this.setObservablePropValue_(e,t):n?Reflect.set(this.target_,e,t):(this.target_[e]=t,!0):this.extend_(e,{value:t,enumerable:!0,writable:!0,configurable:!0},this.defaultAnnotation_,n)},t.has_=function(e){if(!bt.trackingDerivation)return e in this.target_;this.pendingKeys_||(this.pendingKeys_=new Map);var t=this.pendingKeys_.get(e);return t||(t=new Xe(e in this.target_,X,"ObservableObject.key?",!1),this.pendingKeys_.set(e,t)),t.get()},t.make_=function(e,t){if(!0===t&&(t=this.defaultAnnotation_),!1!==t){if(!(e in this.target_)){var n;if(null!=(n=this.target_[z])&&n[e])return;r(1,t.annotationType_,this.name_+"."+e.toString())}for(var i=this.target_;i&&i!==d;){var o=s(i,e);if(o){var a=t.make_(this,e,o,i);if(0===a)return;if(1===a)break}i=Object.getPrototypeOf(i)}Nr(this,0,e)}},t.extend_=function(e,t,n,r){if(void 0===r&&(r=!1),!0===n&&(n=this.defaultAnnotation_),!1===n)return this.defineProperty_(e,t,r);var i=n.extend_(this,e,t,r);return i&&Nr(this,0,e),i},t.defineProperty_=function(e,t,n){void 0===n&&(n=!1),this.keysAtom_;try{Et();var r=this.delete_(e);if(!r)return r;if(Jn(this)){var i=Yn(this,{object:this.proxy_||this.target_,name:e,type:_r,newValue:t.value});if(!i)return null;var o=i.newValue;t.value!==o&&(t=M({},t,{value:o}))}if(n){if(!Reflect.defineProperty(this.target_,e,t))return!1}else l(this.target_,e,t);this.notifyPropertyAddition_(e,t.value)}finally{xt()}return!0},t.defineObservableProperty_=function(e,t,n,r){void 0===r&&(r=!1),this.keysAtom_;try{Et();var i=this.delete_(e);if(!i)return i;if(Jn(this)){var o=Yn(this,{object:this.proxy_||this.target_,name:e,type:_r,newValue:t});if(!o)return null;t=o.newValue}var a=Fr(e),s={configurable:!bt.safeDescriptors||this.isPlainObject_,enumerable:!0,get:a.get,set:a.set};if(r){if(!Reflect.defineProperty(this.target_,e,s))return!1}else l(this.target_,e,s);var d=new Xe(t,n,"ObservableObject.key",!1);this.values_.set(e,d),this.notifyPropertyAddition_(e,d.value_)}finally{xt()}return!0},t.defineComputedProperty_=function(e,t,n){void 0===n&&(n=!1),this.keysAtom_;try{Et();var r=this.delete_(e);if(!r)return r;if(Jn(this)&&!Yn(this,{object:this.proxy_||this.target_,name:e,type:_r,newValue:void 0}))return null;t.name||(t.name="ObservableObject.key"),t.context=this.proxy_||this.target_;var i=Fr(e),o={configurable:!bt.safeDescriptors||this.isPlainObject_,enumerable:!1,get:i.get,set:i.set};if(n){if(!Reflect.defineProperty(this.target_,e,o))return!1}else l(this.target_,e,o);this.values_.set(e,new et(t)),this.notifyPropertyAddition_(e,void 0)}finally{xt()}return!0},t.delete_=function(e,t){if(void 0===t&&(t=!1),this.keysAtom_,!k(this.target_,e))return!0;if(Jn(this)&&!Yn(this,{object:this.proxy_||this.target_,name:e,type:xr}))return null;try{var n;Et();var r,i=er(this),o=this.values_.get(e),a=void 0;if(!o&&i&&(a=null==(r=s(this.target_,e))?void 0:r.value),t){if(!Reflect.deleteProperty(this.target_,e))return!1}else delete this.target_[e];if(o&&(this.values_.delete(e),o instanceof Xe&&(a=o.value_),Dt(o)),this.keysAtom_.reportChanged(),null==(n=this.pendingKeys_)||null==(n=n.get(e))||n.set(e in this.target_),i){var l={type:xr,observableKind:"object",object:this.proxy_||this.target_,debugObjectName:this.name_,oldValue:a,name:e};i&&nr(this,l)}}finally{xt()}return!0},t.observe_=function(e,t){return tr(this,e)},t.intercept_=function(e){return Xn(this,e)},t.notifyPropertyAddition_=function(e,t){var n,r=er(this);if(r){var i=r?{type:_r,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,name:e,newValue:t}:null;r&&nr(this,i)}null==(n=this.pendingKeys_)||null==(n=n.get(e))||n.set(!0),this.keysAtom_.reportChanged()},t.ownKeys_=function(){return this.keysAtom_.reportObserved(),A(this.target_)},t.keys_=function(){return this.keysAtom_.reportObserved(),Object.keys(this.target_)},e}();function Dr(e,t){var n;if(k(e,G))return e;var r=null!=(n=null==t?void 0:t.name)?n:"ObservableObject",i=new Ar(e,new Map,String(r),function(e){var t;return e?null!=(t=e.defaultDecorator)?t:Ce(e):void 0}(t));return S(e,G,i),e}var kr=I("ObservableObjectAdministration",Ar);function Fr(e){return Er[e]||(Er[e]={get:function(){return this[G].getObservablePropValue_(e)},set:function(t){return this[G].setObservablePropValue_(e,t)}})}function Pr(e){return!!_(e)&&kr(e[G])}function Nr(e,t,n){var r;null==(r=e.target_[z])||delete r[n]}var Br,Or,Rr=Ur(0),Lr=function(){var e=!1,t={};return Object.defineProperty(t,"0",{set:function(){e=!0}}),Object.create(t)[0]=1,!1===e}(),Mr=0,qr=function(){};Br=qr,Or=Array.prototype,Object.setPrototypeOf?Object.setPrototypeOf(Br.prototype,Or):void 0!==Br.prototype.__proto__?Br.prototype.__proto__=Or:Br.prototype=Or;var Wr=function(e){function t(t,n,r,i){var o;return void 0===r&&(r="ObservableArray"),void 0===i&&(i=!1),o=e.call(this)||this,Kr((function(){var e=new dr(r,n,i,!0);e.proxy_=o,T(o,G,e),t&&t.length&&o.spliceWithArray(0,0,t),Lr&&Object.defineProperty(o,"0",Rr)})),o}q(t,e);var n=t.prototype;return n.concat=function(){this[G].atom_.reportObserved();for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Array.prototype.concat.apply(this.slice(),t.map((function(e){return mr(e)?e.slice():e})))},n[Symbol.iterator]=function(){var e=this,t=0;return Yr({next:function(){return t<e.length?{value:e[t++],done:!1}:{done:!0,value:void 0}}})},R(t,[{key:"length",get:function(){return this[G].getArrayLength_()},set:function(e){this[G].setArrayLength_(e)}},{key:Symbol.toStringTag,get:function(){return"Array"}}])}(qr);function Ur(e){return{enumerable:!1,configurable:!0,get:function(){return this[G].get_(e)},set:function(t){this[G].set_(e,t)}}}function zr(e){l(Wr.prototype,""+e,Ur(e))}function jr(e){if(e>Mr){for(var t=Mr;t<e+100;t++)zr(t);Mr=e}}function Hr(e,t,n){return new Wr(e,t,n)}function Vr(e,t){if("object"==typeof e&&null!==e){if(mr(e))return void 0!==t&&r(23),e[G].atom_;if(wr(e))return e.atom_;if(Sr(e)){if(void 0===t)return e.keysAtom_;var n=e.data_.get(t)||e.hasMap_.get(t);return n||r(25,t,Qr(e)),n}if(Pr(e)){if(!t)return r(26);var i=e[G].values_.get(t);return i||r(27,t,Qr(e)),i}if(K(e)||rt(e)||Rt(e))return e}else if(m(e)&&Rt(e[G]))return e[G];r(28)}function Gr(e,t){return e||r(29),void 0!==t?Gr(Vr(e,t)):K(e)||rt(e)||Rt(e)||Sr(e)||wr(e)?e:e[G]?e[G]:void r(24,e)}function Qr(e,t){var n;if(void 0!==t)n=Vr(e,t);else{if($t(e))return e.name;n=Pr(e)||Sr(e)||wr(e)?Gr(e):Vr(e)}return n.name_}function Kr(e){var t=ct(),n=Ze(!0);Et();try{return e()}finally{xt(),Je(n),gt(t)}}Object.entries(cr).forEach((function(e){var t=e[0],n=e[1];"concat"!==t&&S(Wr.prototype,t,n)})),jr(1e3);var $r=d.toString;function Zr(e,t,n){return void 0===n&&(n=-1),Jr(e,t,n)}function Jr(e,t,n,r,i){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return!1;if(e!=e)return t!=t;var o=typeof e;if("function"!==o&&"object"!==o&&"object"!=typeof t)return!1;var a=$r.call(e);if(a!==$r.call(t))return!1;switch(a){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:0==+e?1/+e==1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return"undefined"!=typeof Symbol&&Symbol.valueOf.call(e)===Symbol.valueOf.call(t);case"[object Map]":case"[object Set]":n>=0&&n++}e=Xr(e),t=Xr(t);var s="[object Array]"===a;if(!s){if("object"!=typeof e||"object"!=typeof t)return!1;var l=e.constructor,d=t.constructor;if(l!==d&&!(m(l)&&l instanceof l&&m(d)&&d instanceof d)&&"constructor"in e&&"constructor"in t)return!1}if(0===n)return!1;n<0&&(n=-1),i=i||[];for(var u=(r=r||[]).length;u--;)if(r[u]===e)return i[u]===t;if(r.push(e),i.push(t),s){if((u=e.length)!==t.length)return!1;for(;u--;)if(!Jr(e[u],t[u],n-1,r,i))return!1}else{var c,g=Object.keys(e);if(u=g.length,Object.keys(t).length!==u)return!1;for(;u--;)if(!k(t,c=g[u])||!Jr(e[c],t[c],n-1,r,i))return!1}return r.pop(),i.pop(),!0}function Xr(e){return mr(e)?e.slice():w(e)||Sr(e)||E(e)||wr(e)?Array.from(e.entries()):e}function Yr(e){return e[Symbol.iterator]=ei,e}function ei(){return this}["Symbol","Map","Set"].forEach((function(e){void 0===o()[e]&&r("MobX requires global '"+e+"' to be available or polyfilled")})),"object"==typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:Lt,extras:{getDebugName:Qr},$mobx:G})},82009:(e,t,n)=>{"use strict";var r=n(53730);function i(){}function o(){}o.resetWarningCache=i,e.exports=function(){function e(e,t,n,i,o,a){if(a!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:i};return n.PropTypes=n,n}},92949:(e,t,n)=>{e.exports=n(82009)()},53730:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},12709:(e,t,n)=>{"use strict";var r=n(21355),i=n(95734);function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=60106,s=60107,l=60108,d=60114,u=60109,c=60110,g=60112,h=60113,p=60120,f=60115,v=60116,m=60121,y=60117,_=60119,b=60129,C=60131;if("function"==typeof Symbol&&Symbol.for){var S=Symbol.for;a=S("react.portal"),s=S("react.fragment"),l=S("react.strict_mode"),d=S("react.profiler"),u=S("react.provider"),c=S("react.context"),g=S("react.forward_ref"),h=S("react.suspense"),p=S("react.suspense_list"),f=S("react.memo"),v=S("react.lazy"),m=S("react.block"),y=S("react.fundamental"),_=S("react.scope"),b=S("react.debug_trace_mode"),C=S("react.legacy_hidden")}function T(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case s:return"Fragment";case a:return"Portal";case d:return"Profiler";case l:return"StrictMode";case h:return"Suspense";case p:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case c:return(e.displayName||"Context")+".Consumer";case u:return(e._context.displayName||"Context")+".Provider";case g:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case f:return T(e.type);case m:return T(e._render);case v:t=e._payload,e=e._init;try{return T(e(t))}catch(e){}}return null}var I=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w={};function E(e,t){for(var n=0|e._threadCount;n<=t;n++)e[n]=e._currentValue2,e._threadCount=n+1}for(var x=new Uint16Array(16),A=0;15>A;A++)x[A]=A+1;x[15]=0;var D=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,k=Object.prototype.hasOwnProperty,F={},P={};function N(e){return!!k.call(P,e)||!k.call(F,e)&&(D.test(e)?P[e]=!0:(F[e]=!0,!1))}function B(e,t,n,r,i,o,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=a}var O={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){O[e]=new B(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];O[t]=new B(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){O[e]=new B(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){O[e]=new B(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){O[e]=new B(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){O[e]=new B(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){O[e]=new B(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){O[e]=new B(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){O[e]=new B(e,5,!1,e.toLowerCase(),null,!1,!1)}));var R=/[\-:]([a-z])/g;function L(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(R,L);O[t]=new B(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(R,L);O[t]=new B(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(R,L);O[t]=new B(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){O[e]=new B(e,1,!1,e.toLowerCase(),null,!1,!1)})),O.xlinkHref=new B("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){O[e]=new B(e,1,!1,e.toLowerCase(),null,!0,!0)}));var M=/["'&<>]/;function q(e){if("boolean"==typeof e||"number"==typeof e)return""+e;e=""+e;var t=M.exec(e);if(t){var n,r="",i=0;for(n=t.index;n<e.length;n++){switch(e.charCodeAt(n)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#x27;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}i!==n&&(r+=e.substring(i,n)),i=n+1,r+=t}e=i!==n?r+e.substring(i,n):r}return e}function W(e,t){var n,r=O.hasOwnProperty(e)?O[e]:null;return(n="style"!==e)&&(n=null!==r?0===r.type:2<e.length&&("o"===e[0]||"O"===e[0])&&("n"===e[1]||"N"===e[1])),n||function(e,t,n,r){if(null==t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e;default:return!1}}(e,t,n))return!0;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(e,t,r)?"":null!==r?(e=r.attributeName,3===(n=r.type)||4===n&&!0===t?e+'=""':(r.sanitizeURL&&(t=""+t),e+'="'+q(t)+'"')):N(e)?e+'="'+q(t)+'"':""}var U="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},z=null,j=null,H=null,V=!1,G=!1,Q=null,K=0;function $(){if(null===z)throw Error(o(321));return z}function Z(){if(0<K)throw Error(o(312));return{memoizedState:null,queue:null,next:null}}function J(){return null===H?null===j?(V=!1,j=H=Z()):(V=!0,H=j):null===H.next?(V=!1,H=H.next=Z()):(V=!0,H=H.next),H}function X(e,t,n,r){for(;G;)G=!1,K+=1,H=null,n=e(t,r);return Y(),n}function Y(){z=null,G=!1,j=null,K=0,H=Q=null}function ee(e,t){return"function"==typeof t?t(e):t}function te(e,t,n){if(z=$(),H=J(),V){var r=H.queue;if(t=r.dispatch,null!==Q&&void 0!==(n=Q.get(r))){Q.delete(r),r=H.memoizedState;do{r=e(r,n.action),n=n.next}while(null!==n);return H.memoizedState=r,[r,t]}return[H.memoizedState,t]}return e=e===ee?"function"==typeof t?t():t:void 0!==n?n(t):t,H.memoizedState=e,e=(e=H.queue={last:null,dispatch:null}).dispatch=re.bind(null,z,e),[H.memoizedState,e]}function ne(e,t){if(z=$(),t=void 0===t?null:t,null!==(H=J())){var n=H.memoizedState;if(null!==n&&null!==t){var r=n[1];e:if(null===r)r=!1;else{for(var i=0;i<r.length&&i<t.length;i++)if(!U(t[i],r[i])){r=!1;break e}r=!0}if(r)return n[0]}}return e=e(),H.memoizedState=[e,t],e}function re(e,t,n){if(!(25>K))throw Error(o(301));if(e===z)if(G=!0,e={action:n,next:null},null===Q&&(Q=new Map),void 0===(n=Q.get(t)))Q.set(t,e);else{for(t=n;null!==t.next;)t=t.next;t.next=e}}function ie(){}var oe=null,ae={readContext:function(e){var t=oe.threadID;return E(e,t),e[t]},useContext:function(e){$();var t=oe.threadID;return E(e,t),e[t]},useMemo:ne,useReducer:te,useRef:function(e){z=$();var t=(H=J()).memoizedState;return null===t?(e={current:e},H.memoizedState=e):t},useState:function(e){return te(ee,e)},useLayoutEffect:function(){},useCallback:function(e,t){return ne((function(){return e}),t)},useImperativeHandle:ie,useEffect:ie,useDebugValue:ie,useDeferredValue:function(e){return $(),e},useTransition:function(){return $(),[function(e){e()},!1]},useOpaqueIdentifier:function(){return(oe.identifierPrefix||"")+"R:"+(oe.uniqueID++).toString(36)},useMutableSource:function(e,t){return $(),t(e._source)}},se="http://www.w3.org/1999/xhtml";function le(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}var de={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},ue=r({menuitem:!0},de),ce={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ge=["Webkit","ms","Moz","O"];Object.keys(ce).forEach((function(e){ge.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ce[t]=ce[e]}))}));var he=/([A-Z])/g,pe=/^ms-/,fe=i.Children.toArray,ve=I.ReactCurrentDispatcher,me={listing:!0,pre:!0,textarea:!0},ye=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,_e={},be={},Ce=Object.prototype.hasOwnProperty,Se={children:null,dangerouslySetInnerHTML:null,suppressContentEditableWarning:null,suppressHydrationWarning:null};function Te(e,t){if(void 0===e)throw Error(o(152,T(t)||"Component"))}var Ie=function(){function e(e,t,n){i.isValidElement(e)?e.type!==s?e=[e]:(e=e.props.children,e=i.isValidElement(e)?[e]:fe(e)):e=fe(e),e={type:null,domNamespace:se,children:e,childIndex:0,context:w,footer:""};var r=x[0];if(0===r){var a=x,l=2*(r=a.length);if(!(65536>=l))throw Error(o(304));var d=new Uint16Array(l);for(d.set(a),(x=d)[0]=r+1,a=r;a<l-1;a++)x[a]=a+1;x[l-1]=0}else x[0]=x[r];this.threadID=r,this.stack=[e],this.exhausted=!1,this.currentSelectValue=null,this.previousWasTextNode=!1,this.makeStaticMarkup=t,this.suspenseDepth=0,this.contextIndex=-1,this.contextStack=[],this.contextValueStack=[],this.uniqueID=0,this.identifierPrefix=n&&n.identifierPrefix||""}var t=e.prototype;return t.destroy=function(){if(!this.exhausted){this.exhausted=!0,this.clearProviders();var e=this.threadID;x[e]=x[0],x[0]=e}},t.pushProvider=function(e){var t=++this.contextIndex,n=e.type._context,r=this.threadID;E(n,r);var i=n[r];this.contextStack[t]=n,this.contextValueStack[t]=i,n[r]=e.props.value},t.popProvider=function(){var e=this.contextIndex,t=this.contextStack[e],n=this.contextValueStack[e];this.contextStack[e]=null,this.contextValueStack[e]=null,this.contextIndex--,t[this.threadID]=n},t.clearProviders=function(){for(var e=this.contextIndex;0<=e;e--)this.contextStack[e][this.threadID]=this.contextValueStack[e]},t.read=function(e){if(this.exhausted)return null;var t=oe;oe=this;var n=ve.current;ve.current=ae;try{for(var r=[""],i=!1;r[0].length<e;){if(0===this.stack.length){this.exhausted=!0;var a=this.threadID;x[a]=x[0],x[0]=a;break}var s=this.stack[this.stack.length-1];if(i||s.childIndex>=s.children.length){var l=s.footer;if(""!==l&&(this.previousWasTextNode=!1),this.stack.pop(),"select"===s.type)this.currentSelectValue=null;else if(null!=s.type&&null!=s.type.type&&s.type.type.$$typeof===u)this.popProvider(s.type);else if(s.type===h){this.suspenseDepth--;var d=r.pop();if(i){i=!1;var c=s.fallbackFrame;if(!c)throw Error(o(303));this.stack.push(c),r[this.suspenseDepth]+="\x3c!--$!--\x3e";continue}r[this.suspenseDepth]+=d}r[this.suspenseDepth]+=l}else{var g=s.children[s.childIndex++],p="";try{p+=this.render(g,s.context,s.domNamespace)}catch(e){if(null!=e&&"function"==typeof e.then)throw Error(o(294));throw e}r.length<=this.suspenseDepth&&r.push(""),r[this.suspenseDepth]+=p}}return r[0]}finally{ve.current=n,oe=t,Y()}},t.render=function(e,t,n){if("string"==typeof e||"number"==typeof e)return""==(n=""+e)?"":this.makeStaticMarkup?q(n):this.previousWasTextNode?"\x3c!-- --\x3e"+q(n):(this.previousWasTextNode=!0,q(n));if(e=(t=function(e,t,n){function a(i,a){var s=a.prototype&&a.prototype.isReactComponent,l=function(e,t,n,r){if(r&&"object"==typeof(r=e.contextType)&&null!==r)return E(r,n),r[n];if(e=e.contextTypes){for(var i in n={},e)n[i]=t[i];t=n}else t=w;return t}(a,t,n,s),d=[],u=!1,c={isMounted:function(){return!1},enqueueForceUpdate:function(){if(null===d)return null},enqueueReplaceState:function(e,t){u=!0,d=[t]},enqueueSetState:function(e,t){if(null===d)return null;d.push(t)}};if(s){if(s=new a(i.props,l,c),"function"==typeof a.getDerivedStateFromProps){var g=a.getDerivedStateFromProps.call(null,i.props,s.state);null!=g&&(s.state=r({},s.state,g))}}else if(z={},s=a(i.props,l,c),null==(s=X(a,i.props,s,l))||null==s.render)return void Te(e=s,a);if(s.props=i.props,s.context=l,s.updater=c,void 0===(c=s.state)&&(s.state=c=null),"function"==typeof s.UNSAFE_componentWillMount||"function"==typeof s.componentWillMount)if("function"==typeof s.componentWillMount&&"function"!=typeof a.getDerivedStateFromProps&&s.componentWillMount(),"function"==typeof s.UNSAFE_componentWillMount&&"function"!=typeof a.getDerivedStateFromProps&&s.UNSAFE_componentWillMount(),d.length){c=d;var h=u;if(d=null,u=!1,h&&1===c.length)s.state=c[0];else{g=h?c[0]:s.state;var p=!0;for(h=h?1:0;h<c.length;h++){var f=c[h];null!=(f="function"==typeof f?f.call(s,g,i.props,l):f)&&(p?(p=!1,g=r({},g,f)):r(g,f))}s.state=g}}else d=null;if(Te(e=s.render(),a),"function"==typeof s.getChildContext&&"object"==typeof(i=a.childContextTypes)){var v=s.getChildContext();for(var m in v)if(!(m in i))throw Error(o(108,T(a)||"Unknown",m))}v&&(t=r({},t,v))}for(;i.isValidElement(e);){var s=e,l=s.type;if("function"!=typeof l)break;a(s,l)}return{child:e,context:t}}(e,t,this.threadID)).child,t=t.context,null===e||!1===e)return"";if(!i.isValidElement(e)){if(null!=e&&null!=e.$$typeof){if((n=e.$$typeof)===a)throw Error(o(257));throw Error(o(258,n.toString()))}return e=fe(e),this.stack.push({type:null,domNamespace:n,children:e,childIndex:0,context:t,footer:""}),""}var m=e.type;if("string"==typeof m)return this.renderDOM(e,t,n);switch(m){case C:case b:case l:case d:case p:case s:return e=fe(e.props.children),this.stack.push({type:null,domNamespace:n,children:e,childIndex:0,context:t,footer:""}),"";case h:throw Error(o(294));case _:throw Error(o(343))}if("object"==typeof m&&null!==m)switch(m.$$typeof){case g:z={};var S=m.render(e.props,e.ref);return S=X(m.render,e.props,S,e.ref),S=fe(S),this.stack.push({type:null,domNamespace:n,children:S,childIndex:0,context:t,footer:""}),"";case f:return e=[i.createElement(m.type,r({ref:e.ref},e.props))],this.stack.push({type:null,domNamespace:n,children:e,childIndex:0,context:t,footer:""}),"";case u:return n={type:e,domNamespace:n,children:m=fe(e.props.children),childIndex:0,context:t,footer:""},this.pushProvider(e),this.stack.push(n),"";case c:m=e.type,S=e.props;var I=this.threadID;return E(m,I),m=fe(S.children(m[I])),this.stack.push({type:e,domNamespace:n,children:m,childIndex:0,context:t,footer:""}),"";case y:throw Error(o(338));case v:return m=(S=(m=e.type)._init)(m._payload),e=[i.createElement(m,r({ref:e.ref},e.props))],this.stack.push({type:null,domNamespace:n,children:e,childIndex:0,context:t,footer:""}),""}throw Error(o(130,null==m?m:typeof m,""))},t.renderDOM=function(e,t,n){var a=e.type.toLowerCase();if(n===se&&le(a),!_e.hasOwnProperty(a)){if(!ye.test(a))throw Error(o(65,a));_e[a]=!0}var s=e.props;if("input"===a)s=r({type:void 0},s,{defaultChecked:void 0,defaultValue:void 0,value:null!=s.value?s.value:s.defaultValue,checked:null!=s.checked?s.checked:s.defaultChecked});else if("textarea"===a){var l=s.value;if(null==l){l=s.defaultValue;var d=s.children;if(null!=d){if(null!=l)throw Error(o(92));if(Array.isArray(d)){if(!(1>=d.length))throw Error(o(93));d=d[0]}l=""+d}null==l&&(l="")}s=r({},s,{value:void 0,children:""+l})}else if("select"===a)this.currentSelectValue=null!=s.value?s.value:s.defaultValue,s=r({},s,{value:void 0});else if("option"===a){d=this.currentSelectValue;var u=function(e){if(null==e)return e;var t="";return i.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(s.children);if(null!=d){var c=null!=s.value?s.value+"":u;if(l=!1,Array.isArray(d)){for(var g=0;g<d.length;g++)if(""+d[g]===c){l=!0;break}}else l=""+d===c;s=r({selected:void 0,children:void 0},s,{selected:l,children:u})}}if(l=s){if(ue[a]&&(null!=l.children||null!=l.dangerouslySetInnerHTML))throw Error(o(137,a));if(null!=l.dangerouslySetInnerHTML){if(null!=l.children)throw Error(o(60));if("object"!=typeof l.dangerouslySetInnerHTML||!("__html"in l.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=l.style&&"object"!=typeof l.style)throw Error(o(62))}l=s,d=this.makeStaticMarkup,u=1===this.stack.length,c="<"+e.type;e:if(-1===a.indexOf("-"))g="string"==typeof l.is;else switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":g=!1;break e;default:g=!0}for(C in l)if(Ce.call(l,C)){var h=l[C];if(null!=h){if("style"===C){var p=void 0,f="",v="";for(p in h)if(h.hasOwnProperty(p)){var m=0===p.indexOf("--"),y=h[p];if(null!=y){if(m)var _=p;else if(_=p,be.hasOwnProperty(_))_=be[_];else{var b=_.replace(he,"-$1").toLowerCase().replace(pe,"-ms-");_=be[_]=b}f+=v+_+":",v=p,f+=m=null==y||"boolean"==typeof y||""===y?"":m||"number"!=typeof y||0===y||ce.hasOwnProperty(v)&&ce[v]?(""+y).trim():y+"px",v=";"}}h=f||null}p=null,g?Se.hasOwnProperty(C)||(p=N(p=C)&&null!=h?p+'="'+q(h)+'"':""):p=W(C,h),p&&(c+=" "+p)}}d||u&&(c+=' data-reactroot=""');var C=c;l="",de.hasOwnProperty(a)?C+="/>":(C+=">",l="</"+e.type+">");e:{if(null!=(d=s.dangerouslySetInnerHTML)){if(null!=d.__html){d=d.__html;break e}}else if("string"==typeof(d=s.children)||"number"==typeof d){d=q(d);break e}d=null}return null!=d?(s=[],me.hasOwnProperty(a)&&"\n"===d.charAt(0)&&(C+="\n"),C+=d):s=fe(s.children),e=e.type,n=null==n||"http://www.w3.org/1999/xhtml"===n?le(e):"http://www.w3.org/2000/svg"===n&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":n,this.stack.push({domNamespace:n,type:a,children:s,childIndex:0,context:t,footer:l}),this.previousWasTextNode=!1,C},e}();t.renderToString=function(e,t){e=new Ie(e,!1,t);try{return e.read(1/0)}finally{e.destroy()}}},13918:(e,t,n)=>{"use strict";e.exports=n(12709)},13956:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>b});var r=n(95734),i=n(38883),o=n(13918),a=n(92949),s=n.n(a),l="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{};function d(e,t){return e(t={exports:{}},t.exports),t.exports}var u=d((function(e){!function(t){var n=function(e,t,r){if(!l(t)||u(t)||c(t)||g(t)||s(t))return t;var i,o=0,a=0;if(d(t))for(i=[],a=t.length;o<a;o++)i.push(n(e,t[o],r));else for(var h in i={},t)Object.prototype.hasOwnProperty.call(t,h)&&(i[e(h,r)]=n(e,t[h],r));return i},r=function(e){return h(e)?e:(e=e.replace(/[\-_\s]+(.)?/g,(function(e,t){return t?t.toUpperCase():""}))).substr(0,1).toLowerCase()+e.substr(1)},i=function(e){var t=r(e);return t.substr(0,1).toUpperCase()+t.substr(1)},o=function(e,t){return function(e,t){var n=(t=t||{}).separator||"_",r=t.split||/(?=[A-Z])/;return e.split(r).join(n)}(e,t).toLowerCase()},a=Object.prototype.toString,s=function(e){return"function"==typeof e},l=function(e){return e===Object(e)},d=function(e){return"[object Array]"==a.call(e)},u=function(e){return"[object Date]"==a.call(e)},c=function(e){return"[object RegExp]"==a.call(e)},g=function(e){return"[object Boolean]"==a.call(e)},h=function(e){return(e-=0)==e},p=function(e,t){var n=t&&"process"in t?t.process:t;return"function"!=typeof n?e:function(t,r){return n(t,e,r)}},f={camelize:r,decamelize:o,pascalize:i,depascalize:o,camelizeKeys:function(e,t){return n(p(r,t),e)},decamelizeKeys:function(e,t){return n(p(o,t),e,t)},pascalizeKeys:function(e,t){return n(p(i,t),e)},depascalizeKeys:function(){return this.decamelizeKeys.apply(this,arguments)}};e.exports?e.exports=f:t.humps=f}(l)})).decamelize,c=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},g=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()},h=d((function(e){function t(){return e.exports=t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},t.apply(this,arguments)}e.exports=t})),p=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i},f=(0,r.createContext)(null);function v(e){var t=e.children,n=void 0===t?"":t,i=p(e,["children"]);return"string"!=typeof n&&(n=(0,o.renderToString)(n)),r.createElement("template",h({},i,{dangerouslySetInnerHTML:{__html:n}}))}function m(e){var t=e.root,n=e.children;return(0,i.createPortal)(void 0===n?null:n,t)}v.propTypes={children:s().oneOfType([s().string,s().node])},m.propTypes={root:s().object.isRequired,children:s().node};var y=new Map,_=function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"core",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e.children};return new Proxy(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{get:function(n,i){var o=u(i,{separator:"-"}),a="".concat(e,"-").concat(o);return y.has(a)||y.set(a,function(e){var t=(0,r.forwardRef)((function(t,n){var i,o,a=t.mode,s=void 0===a?"open":a,l=t.delegatesFocus,d=void 0!==l&&l,u=t.styleSheets,c=void 0===u?[]:u,y=t.ssr,_=void 0!==y&&y,b=t.children,C=p(t,["mode","delegatesFocus","styleSheets","ssr","children"]),S=(o=(0,r.useRef)((i=n)&&i.current),(0,r.useEffect)((function(){i&&(i.current=o.current)}),[i]),o),T=(0,r.useState)(null),I=g(T,2),w=I[0],E=I[1],x="node_".concat(s).concat(d);return(0,r.useLayoutEffect)((function(){if(S.current)try{if("function"==typeof n&&n(S.current),_){var e=S.current.shadowRoot;return void E(e)}var t=S.current.attachShadow({mode:s,delegatesFocus:d});c.length>0&&(t.adoptedStyleSheets=c),E(t)}catch(e){!function(e){var t=e.error,n=e.styleSheets,r=e.root;if("NotSupportedError"!==t.name)throw t;n.length>0&&(r.adoptedStyleSheets=n)}({error:e,styleSheets:c,root:w})}}),[n,S,c]),r.createElement(r.Fragment,null,r.createElement(e.tag,h({key:x,ref:S},C),(w||_)&&r.createElement(f.Provider,{value:w},_?r.createElement(v,{shadowroot:s,shadowrootmode:s},e.render({root:w,ssr:_,children:b})):r.createElement(m,{root:w},e.render({root:w,ssr:_,children:b})))))}));return t.propTypes={mode:s().oneOf(["open","closed"]),delegatesFocus:s().bool,styleSheets:s().arrayOf(s().instanceOf(globalThis.CSSStyleSheet)),ssr:s().bool,children:s().node},t}({tag:o,render:t})),y.get(a)}})}();const b=_},69207:(e,t,n)=>{var r;!function(e){!function(t){var r="object"==typeof n.g?n.g:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),i=o(e);function o(e,t){return function(n,r){"function"!=typeof e[n]&&Object.defineProperty(e,n,{configurable:!0,writable:!0,value:r}),t&&t(n,r)}}void 0===r.Reflect?r.Reflect=e:i=o(r.Reflect,i),function(e){var t=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,r=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",i=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",o="function"==typeof Object.create,a={__proto__:[]}instanceof Array,s=!o&&!a,l={create:o?function(){return O(Object.create(null))}:a?function(){return O({__proto__:null})}:function(){return O({})},has:s?function(e,n){return t.call(e,n)}:function(e,t){return t in e},get:s?function(e,n){return t.call(e,n)?e[n]:void 0}:function(e,t){return e[t]}},d=Object.getPrototypeOf(Function),u="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,c=u||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){var e={},t=[],n=function(){function e(e,t,n){this._index=0,this._keys=e,this._values=t,this._selector=n}return e.prototype["@@iterator"]=function(){return this},e.prototype[i]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var n=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var n=this._find(e,!0);return this._values[n]=t,this},t.prototype.delete=function(t){var n=this._find(t,!1);if(n>=0){for(var r=this._keys.length,i=n+1;i<r;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new n(this._keys,this._values,r)},t.prototype.values=function(){return new n(this._keys,this._values,o)},t.prototype.entries=function(){return new n(this._keys,this._values,a)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[i]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function r(e,t){return e}function o(e,t){return t}function a(e,t){return[e,t]}}():Map,g=u||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){function e(){this._map=new c}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[i]=function(){return this.keys()},e}():Set,h=new(u||"function"!=typeof WeakMap?function(){var e=16,n=l.create(),r=i();return function(){function e(){this._key=i()}return e.prototype.has=function(e){var t=o(e,!1);return void 0!==t&&l.has(t,this._key)},e.prototype.get=function(e){var t=o(e,!1);return void 0!==t?l.get(t,this._key):void 0},e.prototype.set=function(e,t){return o(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=o(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=i()},e}();function i(){var e;do{e="@@WeakMap@@"+s()}while(l.has(n,e));return n[e]=!0,e}function o(e,n){if(!t.call(e,r)){if(!n)return;Object.defineProperty(e,r,{value:l.create()})}return e[r]}function a(e,t){for(var n=0;n<t;++n)e[n]=255*Math.random()|0;return e}function s(){var t,n=(t=e,"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(t)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(t)):a(new Uint8Array(t),t):a(new Array(t),t));n[6]=79&n[6]|64,n[8]=191&n[8]|128;for(var r="",i=0;i<e;++i){var o=n[i];4!==i&&6!==i&&8!==i||(r+="-"),o<16&&(r+="0"),r+=o.toString(16).toLowerCase()}return r}}():WeakMap);function p(e,t,n){var r=h.get(e);if(T(r)){if(!n)return;r=new c,h.set(e,r)}var i=r.get(t);if(T(i)){if(!n)return;i=new c,r.set(t,i)}return i}function f(e,t,n){if(v(e,t,n))return!0;var r=B(t);return!I(r)&&f(e,r,n)}function v(e,t,n){var r=p(t,n,!1);return!T(r)&&!!r.has(e)}function m(e,t,n){if(v(e,t,n))return y(e,t,n);var r=B(t);return I(r)?void 0:m(e,r,n)}function y(e,t,n){var r=p(t,n,!1);if(!T(r))return r.get(e)}function _(e,t,n,r){p(n,r,!0).set(e,t)}function b(e,t){var n=C(e,t),r=B(e);if(null===r)return n;var i=b(r,t);if(i.length<=0)return n;if(n.length<=0)return i;for(var o=new g,a=[],s=0,l=n;s<l.length;s++){var d=l[s];o.has(d)||(o.add(d),a.push(d))}for(var u=0,c=i;u<c.length;u++)d=c[u],o.has(d)||(o.add(d),a.push(d));return a}function C(e,t){var n=[],r=p(e,t,!1);if(T(r))return n;for(var o=function(e){var t=F(e,i);if(!D(t))throw new TypeError;var n=t.call(e);if(!w(n))throw new TypeError;return n}(r.keys()),a=0;;){var s=P(o);if(!s)return n.length=a,n;var l=s.value;try{n[a]=l}catch(e){try{N(o)}finally{throw e}}a++}}function S(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function T(e){return void 0===e}function I(e){return null===e}function w(e){return"object"==typeof e?null!==e:"function"==typeof e}function E(e,t){switch(S(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var n=3===t?"string":5===t?"number":"default",i=F(e,r);if(void 0!==i){var o=i.call(e,n);if(w(o))throw new TypeError;return o}return function(e,t){if("string"===t){var n=e.toString;if(D(n)&&!w(i=n.call(e)))return i;if(D(r=e.valueOf)&&!w(i=r.call(e)))return i}else{var r;if(D(r=e.valueOf)&&!w(i=r.call(e)))return i;var i,o=e.toString;if(D(o)&&!w(i=o.call(e)))return i}throw new TypeError}(e,"default"===n?"number":n)}function x(e){var t=E(e,3);return"symbol"==typeof t?t:function(e){return""+e}(t)}function A(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function D(e){return"function"==typeof e}function k(e){return"function"==typeof e}function F(e,t){var n=e[t];if(null!=n){if(!D(n))throw new TypeError;return n}}function P(e){var t=e.next();return!t.done&&t}function N(e){var t=e.return;t&&t.call(e)}function B(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===d)return t;if(t!==d)return t;var n=e.prototype,r=n&&Object.getPrototypeOf(n);if(null==r||r===Object.prototype)return t;var i=r.constructor;return"function"!=typeof i||i===e?t:i}function O(e){return e.__=void 0,delete e.__,e}e("decorate",(function(e,t,n,r){if(T(n)){if(!A(e))throw new TypeError;if(!k(t))throw new TypeError;return function(e,t){for(var n=e.length-1;n>=0;--n){var r=(0,e[n])(t);if(!T(r)&&!I(r)){if(!k(r))throw new TypeError;t=r}}return t}(e,t)}if(!A(e))throw new TypeError;if(!w(t))throw new TypeError;if(!w(r)&&!T(r)&&!I(r))throw new TypeError;return I(r)&&(r=void 0),function(e,t,n,r){for(var i=e.length-1;i>=0;--i){var o=(0,e[i])(t,n,r);if(!T(o)&&!I(o)){if(!w(o))throw new TypeError;r=o}}return r}(e,t,n=x(n),r)})),e("metadata",(function(e,t){return function(n,r){if(!w(n))throw new TypeError;if(!T(r)&&!function(e){switch(S(e)){case 3:case 4:return!0;default:return!1}}(r))throw new TypeError;_(e,t,n,r)}})),e("defineMetadata",(function(e,t,n,r){if(!w(n))throw new TypeError;return T(r)||(r=x(r)),_(e,t,n,r)})),e("hasMetadata",(function(e,t,n){if(!w(t))throw new TypeError;return T(n)||(n=x(n)),f(e,t,n)})),e("hasOwnMetadata",(function(e,t,n){if(!w(t))throw new TypeError;return T(n)||(n=x(n)),v(e,t,n)})),e("getMetadata",(function(e,t,n){if(!w(t))throw new TypeError;return T(n)||(n=x(n)),m(e,t,n)})),e("getOwnMetadata",(function(e,t,n){if(!w(t))throw new TypeError;return T(n)||(n=x(n)),y(e,t,n)})),e("getMetadataKeys",(function(e,t){if(!w(e))throw new TypeError;return T(t)||(t=x(t)),b(e,t)})),e("getOwnMetadataKeys",(function(e,t){if(!w(e))throw new TypeError;return T(t)||(t=x(t)),C(e,t)})),e("deleteMetadata",(function(e,t,n){if(!w(t))throw new TypeError;T(n)||(n=x(n));var r=p(t,n,!1);if(T(r))return!1;if(!r.delete(e))return!1;if(r.size>0)return!0;var i=h.get(t);return i.delete(n),i.size>0||h.delete(t),!0}))}(i)}()}(r||(r={}))},86432:(e,t)=>{"use strict";var n=function(e,t){for(var n=!1,r=0;r<e.length;r+=1)e[r]===t&&(n=!0,e.splice(r,1),r-=1);return n},r=function(){function e(){this.anyRegistrations=[],this.registrations={}}return e.prototype.on=function(e,t){this.safelyGetRegistration(e).listeners.push(t)},e.prototype.onFirst=function(e,t){var n=this.safelyGetRegistration(e);void 0!==n.firstArgs&&t.apply(void 0,n.firstArgs),n.firstOnlyListeners.push(t)},e.prototype.onAny=function(e){this.anyRegistrations.push(e)},e.prototype.off=function(e,t){if(void 0!==e)if(void 0!==t){var r=this.safelyGetRegistration(e),i=n(r.listeners,t),o=n(r.firstOnlyListeners,t);if(!i&&!o)throw new Error("Tried to remove a non-existent listener for event name '"+e+"'.")}else this.registrations[e]={firstOnlyListeners:[],listeners:[]};else this.registrations={}},e.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=this.safelyGetRegistration(e);if(void 0===r.firstArgs){for(var i=0,o=r.firstOnlyListeners;i<o.length;i++)o[i].apply(void 0,t);r.firstArgs=t,r.firstOnlyListeners=[]}for(var a=0,s=r.listeners;a<s.length;a++)s[a].apply(void 0,t);for(var l=0,d=this.anyRegistrations;l<d.length;l++)d[l].apply(void 0,[e].concat(t))},e.prototype.waitFor=function(e){var t=this;return new Promise((function(n){var r=function(i){n(i),t.off(e,r)};t.on(e,r)}))},e.prototype.waitForFirst=function(e){var t=this;return new Promise((function(n){var r=function(i){n(i),t.off(e,r)};t.onFirst(e,r)}))},e.prototype.safelyGetRegistration=function(e){return void 0===this.registrations[e]&&(this.registrations[e]={firstOnlyListeners:[],listeners:[]}),this.registrations[e]},e}();t.bk=r},4413:(e,t,n)=>{"use strict";var r;n.d(t,{A:()=>u});var i=new Uint8Array(16);function o(){if(!r&&!(r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(i)}const a=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var s=[],l=0;l<256;++l)s.push((l+256).toString(16).substr(1));const d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(s[e[t+0]]+s[e[t+1]]+s[e[t+2]]+s[e[t+3]]+"-"+s[e[t+4]]+s[e[t+5]]+"-"+s[e[t+6]]+s[e[t+7]]+"-"+s[e[t+8]]+s[e[t+9]]+"-"+s[e[t+10]]+s[e[t+11]]+s[e[t+12]]+s[e[t+13]]+s[e[t+14]]+s[e[t+15]]).toLowerCase();if(!function(e){return"string"==typeof e&&a.test(e)}(n))throw TypeError("Stringified UUID is invalid");return n},u=function(e,t,n){var r=(e=e||{}).random||(e.rng||o)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=r[i];return t}return d(r)}},98288:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o});var r=n(14269),i=n.n(r);function o(){return i()('(()=>{var t={8:t=>{var e=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32},n=-1;e.Diff=function(t,e){return[t,e]},e.prototype.diff_main=function(t,n,i,r){void 0===r&&(r=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+1e3*this.Diff_Timeout);var s=r;if(null==t||null==n)throw new Error("Null input. (diff_main)");if(t==n)return t?[new e.Diff(0,t)]:[];void 0===i&&(i=!0);var h=i,f=this.diff_commonPrefix(t,n),a=t.substring(0,f);t=t.substring(f),n=n.substring(f),f=this.diff_commonSuffix(t,n);var l=t.substring(t.length-f);t=t.substring(0,t.length-f),n=n.substring(0,n.length-f);var g=this.diff_compute_(t,n,h,s);return a&&g.unshift(new e.Diff(0,a)),l&&g.push(new e.Diff(0,l)),this.diff_cleanupMerge(g),g},e.prototype.diff_compute_=function(t,i,r,s){var h;if(!t)return[new e.Diff(1,i)];if(!i)return[new e.Diff(n,t)];var f=t.length>i.length?t:i,a=t.length>i.length?i:t,l=f.indexOf(a);if(-1!=l)return h=[new e.Diff(1,f.substring(0,l)),new e.Diff(0,a),new e.Diff(1,f.substring(l+a.length))],t.length>i.length&&(h[0][0]=h[2][0]=n),h;if(1==a.length)return[new e.Diff(n,t),new e.Diff(1,i)];var g=this.diff_halfMatch_(t,i);if(g){var o=g[0],c=g[1],u=g[2],p=g[3],d=g[4],_=this.diff_main(o,u,r,s),b=this.diff_main(c,p,r,s);return _.concat([new e.Diff(0,d)],b)}return r&&t.length>100&&i.length>100?this.diff_lineMode_(t,i,s):this.diff_bisect_(t,i,s)},e.prototype.diff_lineMode_=function(t,i,r){var s=this.diff_linesToChars_(t,i);t=s.chars1,i=s.chars2;var h=s.lineArray,f=this.diff_main(t,i,!1,r);this.diff_charsToLines_(f,h),this.diff_cleanupSemantic(f),f.push(new e.Diff(0,""));for(var a=0,l=0,g=0,o="",c="";a<f.length;){switch(f[a][0]){case 1:g++,c+=f[a][1];break;case n:l++,o+=f[a][1];break;case 0:if(l>=1&&g>=1){f.splice(a-l-g,l+g),a=a-l-g;for(var u=this.diff_main(o,c,!1,r),p=u.length-1;p>=0;p--)f.splice(a,0,u[p]);a+=u.length}g=0,l=0,o="",c=""}a++}return f.pop(),f},e.prototype.diff_bisect_=function(t,i,r){for(var s=t.length,h=i.length,f=Math.ceil((s+h)/2),a=f,l=2*f,g=new Array(l),o=new Array(l),c=0;c<l;c++)g[c]=-1,o[c]=-1;g[a+1]=0,o[a+1]=0;for(var u=s-h,p=u%2!=0,d=0,_=0,b=0,v=0,m=0;m<f&&!((new Date).getTime()>r);m++){for(var w=-m+d;w<=m-_;w+=2){for(var x=a+w,M=(E=w==-m||w!=m&&g[x-1]<g[x+1]?g[x+1]:g[x-1]+1)-w;E<s&&M<h&&t.charAt(E)==i.charAt(M);)E++,M++;if(g[x]=E,E>s)_+=2;else if(M>h)d+=2;else if(p&&(k=a+u-w)>=0&&k<l&&-1!=o[k]&&E>=(D=s-o[k]))return this.diff_bisectSplit_(t,i,E,M,r)}for(var y=-m+b;y<=m-v;y+=2){for(var D,k=a+y,A=(D=y==-m||y!=m&&o[k-1]<o[k+1]?o[k+1]:o[k-1]+1)-y;D<s&&A<h&&t.charAt(s-D-1)==i.charAt(h-A-1);)D++,A++;if(o[k]=D,D>s)v+=2;else if(A>h)b+=2;else if(!p){var E;if((x=a+u-y)>=0&&x<l&&-1!=g[x])if(M=a+(E=g[x])-x,E>=(D=s-D))return this.diff_bisectSplit_(t,i,E,M,r)}}}return[new e.Diff(n,t),new e.Diff(1,i)]},e.prototype.diff_bisectSplit_=function(t,e,n,i,r){var s=t.substring(0,n),h=e.substring(0,i),f=t.substring(n),a=e.substring(i),l=this.diff_main(s,h,!1,r),g=this.diff_main(f,a,!1,r);return l.concat(g)},e.prototype.diff_linesToChars_=function(t,e){var n=[],i={};function r(t){for(var e="",r=0,h=-1,f=n.length;h<t.length-1;){-1==(h=t.indexOf("\\n",r))&&(h=t.length-1);var a=t.substring(r,h+1);(i.hasOwnProperty?i.hasOwnProperty(a):void 0!==i[a])?e+=String.fromCharCode(i[a]):(f==s&&(a=t.substring(r),h=t.length),e+=String.fromCharCode(f),i[a]=f,n[f++]=a),r=h+1}return e}n[0]="";var s=4e4,h=r(t);return s=65535,{chars1:h,chars2:r(e),lineArray:n}},e.prototype.diff_charsToLines_=function(t,e){for(var n=0;n<t.length;n++){for(var i=t[n][1],r=[],s=0;s<i.length;s++)r[s]=e[i.charCodeAt(s)];t[n][1]=r.join("")}},e.prototype.diff_commonPrefix=function(t,e){if(!t||!e||t.charAt(0)!=e.charAt(0))return 0;for(var n=0,i=Math.min(t.length,e.length),r=i,s=0;n<r;)t.substring(s,r)==e.substring(s,r)?s=n=r:i=r,r=Math.floor((i-n)/2+n);return r},e.prototype.diff_commonSuffix=function(t,e){if(!t||!e||t.charAt(t.length-1)!=e.charAt(e.length-1))return 0;for(var n=0,i=Math.min(t.length,e.length),r=i,s=0;n<r;)t.substring(t.length-r,t.length-s)==e.substring(e.length-r,e.length-s)?s=n=r:i=r,r=Math.floor((i-n)/2+n);return r},e.prototype.diff_commonOverlap_=function(t,e){var n=t.length,i=e.length;if(0==n||0==i)return 0;n>i?t=t.substring(n-i):n<i&&(e=e.substring(0,n));var r=Math.min(n,i);if(t==e)return r;for(var s=0,h=1;;){var f=t.substring(r-h),a=e.indexOf(f);if(-1==a)return s;h+=a,0!=a&&t.substring(r-h)!=e.substring(0,h)||(s=h,h++)}},e.prototype.diff_halfMatch_=function(t,e){if(this.Diff_Timeout<=0)return null;var n=t.length>e.length?t:e,i=t.length>e.length?e:t;if(n.length<4||2*i.length<n.length)return null;var r=this;function s(t,e,n){for(var i,s,h,f,a=t.substring(n,n+Math.floor(t.length/4)),l=-1,g="";-1!=(l=e.indexOf(a,l+1));){var o=r.diff_commonPrefix(t.substring(n),e.substring(l)),c=r.diff_commonSuffix(t.substring(0,n),e.substring(0,l));g.length<c+o&&(g=e.substring(l-c,l)+e.substring(l,l+o),i=t.substring(0,n-c),s=t.substring(n+o),h=e.substring(0,l-c),f=e.substring(l+o))}return 2*g.length>=t.length?[i,s,h,f,g]:null}var h,f,a,l,g,o=s(n,i,Math.ceil(n.length/4)),c=s(n,i,Math.ceil(n.length/2));return o||c?(h=c?o&&o[4].length>c[4].length?o:c:o,t.length>e.length?(f=h[0],a=h[1],l=h[2],g=h[3]):(l=h[0],g=h[1],f=h[2],a=h[3]),[f,a,l,g,h[4]]):null},e.prototype.diff_cleanupSemantic=function(t){for(var i=!1,r=[],s=0,h=null,f=0,a=0,l=0,g=0,o=0;f<t.length;)0==t[f][0]?(r[s++]=f,a=g,l=o,g=0,o=0,h=t[f][1]):(1==t[f][0]?g+=t[f][1].length:o+=t[f][1].length,h&&h.length<=Math.max(a,l)&&h.length<=Math.max(g,o)&&(t.splice(r[s-1],0,new e.Diff(n,h)),t[r[s-1]+1][0]=1,s--,f=--s>0?r[s-1]:-1,a=0,l=0,g=0,o=0,h=null,i=!0)),f++;for(i&&this.diff_cleanupMerge(t),this.diff_cleanupSemanticLossless(t),f=1;f<t.length;){if(t[f-1][0]==n&&1==t[f][0]){var c=t[f-1][1],u=t[f][1],p=this.diff_commonOverlap_(c,u),d=this.diff_commonOverlap_(u,c);p>=d?(p>=c.length/2||p>=u.length/2)&&(t.splice(f,0,new e.Diff(0,u.substring(0,p))),t[f-1][1]=c.substring(0,c.length-p),t[f+1][1]=u.substring(p),f++):(d>=c.length/2||d>=u.length/2)&&(t.splice(f,0,new e.Diff(0,c.substring(0,d))),t[f-1][0]=1,t[f-1][1]=u.substring(0,u.length-d),t[f+1][0]=n,t[f+1][1]=c.substring(d),f++),f++}f++}},e.prototype.diff_cleanupSemanticLossless=function(t){function n(t,n){if(!t||!n)return 6;var i=t.charAt(t.length-1),r=n.charAt(0),s=i.match(e.nonAlphaNumericRegex_),h=r.match(e.nonAlphaNumericRegex_),f=s&&i.match(e.whitespaceRegex_),a=h&&r.match(e.whitespaceRegex_),l=f&&i.match(e.linebreakRegex_),g=a&&r.match(e.linebreakRegex_),o=l&&t.match(e.blanklineEndRegex_),c=g&&n.match(e.blanklineStartRegex_);return o||c?5:l||g?4:s&&!f&&a?3:f||a?2:s||h?1:0}for(var i=1;i<t.length-1;){if(0==t[i-1][0]&&0==t[i+1][0]){var r=t[i-1][1],s=t[i][1],h=t[i+1][1],f=this.diff_commonSuffix(r,s);if(f){var a=s.substring(s.length-f);r=r.substring(0,r.length-f),s=a+s.substring(0,s.length-f),h=a+h}for(var l=r,g=s,o=h,c=n(r,s)+n(s,h);s.charAt(0)===h.charAt(0);){r+=s.charAt(0),s=s.substring(1)+h.charAt(0),h=h.substring(1);var u=n(r,s)+n(s,h);u>=c&&(c=u,l=r,g=s,o=h)}t[i-1][1]!=l&&(l?t[i-1][1]=l:(t.splice(i-1,1),i--),t[i][1]=g,o?t[i+1][1]=o:(t.splice(i+1,1),i--))}i++}},e.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,e.whitespaceRegex_=/\\s/,e.linebreakRegex_=/[\\r\\n]/,e.blanklineEndRegex_=/\\n\\r?\\n$/,e.blanklineStartRegex_=/^\\r?\\n\\r?\\n/,e.prototype.diff_cleanupEfficiency=function(t){for(var i=!1,r=[],s=0,h=null,f=0,a=!1,l=!1,g=!1,o=!1;f<t.length;)0==t[f][0]?(t[f][1].length<this.Diff_EditCost&&(g||o)?(r[s++]=f,a=g,l=o,h=t[f][1]):(s=0,h=null),g=o=!1):(t[f][0]==n?o=!0:g=!0,h&&(a&&l&&g&&o||h.length<this.Diff_EditCost/2&&a+l+g+o==3)&&(t.splice(r[s-1],0,new e.Diff(n,h)),t[r[s-1]+1][0]=1,s--,h=null,a&&l?(g=o=!0,s=0):(f=--s>0?r[s-1]:-1,g=o=!1),i=!0)),f++;i&&this.diff_cleanupMerge(t)},e.prototype.diff_cleanupMerge=function(t){t.push(new e.Diff(0,""));for(var i,r=0,s=0,h=0,f="",a="";r<t.length;)switch(t[r][0]){case 1:h++,a+=t[r][1],r++;break;case n:s++,f+=t[r][1],r++;break;case 0:s+h>1?(0!==s&&0!==h&&(0!==(i=this.diff_commonPrefix(a,f))&&(r-s-h>0&&0==t[r-s-h-1][0]?t[r-s-h-1][1]+=a.substring(0,i):(t.splice(0,0,new e.Diff(0,a.substring(0,i))),r++),a=a.substring(i),f=f.substring(i)),0!==(i=this.diff_commonSuffix(a,f))&&(t[r][1]=a.substring(a.length-i)+t[r][1],a=a.substring(0,a.length-i),f=f.substring(0,f.length-i))),r-=s+h,t.splice(r,s+h),f.length&&(t.splice(r,0,new e.Diff(n,f)),r++),a.length&&(t.splice(r,0,new e.Diff(1,a)),r++),r++):0!==r&&0==t[r-1][0]?(t[r-1][1]+=t[r][1],t.splice(r,1)):r++,h=0,s=0,f="",a=""}""===t[t.length-1][1]&&t.pop();var l=!1;for(r=1;r<t.length-1;)0==t[r-1][0]&&0==t[r+1][0]&&(t[r][1].substring(t[r][1].length-t[r-1][1].length)==t[r-1][1]?(t[r][1]=t[r-1][1]+t[r][1].substring(0,t[r][1].length-t[r-1][1].length),t[r+1][1]=t[r-1][1]+t[r+1][1],t.splice(r-1,1),l=!0):t[r][1].substring(0,t[r+1][1].length)==t[r+1][1]&&(t[r-1][1]+=t[r+1][1],t[r][1]=t[r][1].substring(t[r+1][1].length)+t[r+1][1],t.splice(r+1,1),l=!0)),r++;l&&this.diff_cleanupMerge(t)},e.prototype.diff_xIndex=function(t,e){var i,r=0,s=0,h=0,f=0;for(i=0;i<t.length&&(1!==t[i][0]&&(r+=t[i][1].length),t[i][0]!==n&&(s+=t[i][1].length),!(r>e));i++)h=r,f=s;return t.length!=i&&t[i][0]===n?f:f+(e-h)},e.prototype.diff_prettyHtml=function(t){for(var e=[],i=/&/g,r=/</g,s=/>/g,h=/\\n/g,f=0;f<t.length;f++){var a=t[f][0],l=t[f][1].replace(i,"&amp;").replace(r,"&lt;").replace(s,"&gt;").replace(h,"&para;<br>");switch(a){case 1:e[f]=\'<ins style="background:#e6ffe6;">\'+l+"</ins>";break;case n:e[f]=\'<del style="background:#ffe6e6;">\'+l+"</del>";break;case 0:e[f]="<span>"+l+"</span>"}}return e.join("")},e.prototype.diff_text1=function(t){for(var e=[],n=0;n<t.length;n++)1!==t[n][0]&&(e[n]=t[n][1]);return e.join("")},e.prototype.diff_text2=function(t){for(var e=[],i=0;i<t.length;i++)t[i][0]!==n&&(e[i]=t[i][1]);return e.join("")},e.prototype.diff_levenshtein=function(t){for(var e=0,i=0,r=0,s=0;s<t.length;s++){var h=t[s][0],f=t[s][1];switch(h){case 1:i+=f.length;break;case n:r+=f.length;break;case 0:e+=Math.max(i,r),i=0,r=0}}return e+Math.max(i,r)},e.prototype.diff_toDelta=function(t){for(var e=[],i=0;i<t.length;i++)switch(t[i][0]){case 1:e[i]="+"+encodeURI(t[i][1]);break;case n:e[i]="-"+t[i][1].length;break;case 0:e[i]="="+t[i][1].length}return e.join("\\t").replace(/%20/g," ")},e.prototype.diff_fromDelta=function(t,i){for(var r=[],s=0,h=0,f=i.split(/\\t/g),a=0;a<f.length;a++){var l=f[a].substring(1);switch(f[a].charAt(0)){case"+":try{r[s++]=new e.Diff(1,decodeURI(l))}catch(t){throw new Error("Illegal escape in diff_fromDelta: "+l)}break;case"-":case"=":var g=parseInt(l,10);if(isNaN(g)||g<0)throw new Error("Invalid number in diff_fromDelta: "+l);var o=t.substring(h,h+=g);"="==f[a].charAt(0)?r[s++]=new e.Diff(0,o):r[s++]=new e.Diff(n,o);break;default:if(f[a])throw new Error("Invalid diff operation in diff_fromDelta: "+f[a])}}if(h!=t.length)throw new Error("Delta length ("+h+") does not equal source text length ("+t.length+").");return r},e.prototype.match_main=function(t,e,n){if(null==t||null==e||null==n)throw new Error("Null input. (match_main)");return n=Math.max(0,Math.min(n,t.length)),t==e?0:t.length?t.substring(n,n+e.length)==e?n:this.match_bitap_(t,e,n):-1},e.prototype.match_bitap_=function(t,e,n){if(e.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var i=this.match_alphabet_(e),r=this;function s(t,i){var s=t/e.length,h=Math.abs(n-i);return r.Match_Distance?s+h/r.Match_Distance:h?1:s}var h=this.Match_Threshold,f=t.indexOf(e,n);-1!=f&&(h=Math.min(s(0,f),h),-1!=(f=t.lastIndexOf(e,n+e.length))&&(h=Math.min(s(0,f),h)));var a,l,g=1<<e.length-1;f=-1;for(var o,c=e.length+t.length,u=0;u<e.length;u++){for(a=0,l=c;a<l;)s(u,n+l)<=h?a=l:c=l,l=Math.floor((c-a)/2+a);c=l;var p=Math.max(1,n-l+1),d=Math.min(n+l,t.length)+e.length,_=Array(d+2);_[d+1]=(1<<u)-1;for(var b=d;b>=p;b--){var v=i[t.charAt(b-1)];if(_[b]=0===u?(_[b+1]<<1|1)&v:(_[b+1]<<1|1)&v|(o[b+1]|o[b])<<1|1|o[b+1],_[b]&g){var m=s(u,b-1);if(m<=h){if(h=m,!((f=b-1)>n))break;p=Math.max(1,2*n-f)}}}if(s(u+1,n)>h)break;o=_}return f},e.prototype.match_alphabet_=function(t){for(var e={},n=0;n<t.length;n++)e[t.charAt(n)]=0;for(n=0;n<t.length;n++)e[t.charAt(n)]|=1<<t.length-n-1;return e},e.prototype.patch_addContext_=function(t,n){if(0!=n.length){if(null===t.start2)throw Error("patch not initialized");for(var i=n.substring(t.start2,t.start2+t.length1),r=0;n.indexOf(i)!=n.lastIndexOf(i)&&i.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)r+=this.Patch_Margin,i=n.substring(t.start2-r,t.start2+t.length1+r);r+=this.Patch_Margin;var s=n.substring(t.start2-r,t.start2);s&&t.diffs.unshift(new e.Diff(0,s));var h=n.substring(t.start2+t.length1,t.start2+t.length1+r);h&&t.diffs.push(new e.Diff(0,h)),t.start1-=s.length,t.start2-=s.length,t.length1+=s.length+h.length,t.length2+=s.length+h.length}},e.prototype.patch_make=function(t,i,r){var s,h;if("string"==typeof t&&"string"==typeof i&&void 0===r)s=t,(h=this.diff_main(s,i,!0)).length>2&&(this.diff_cleanupSemantic(h),this.diff_cleanupEfficiency(h));else if(t&&"object"==typeof t&&void 0===i&&void 0===r)h=t,s=this.diff_text1(h);else if("string"==typeof t&&i&&"object"==typeof i&&void 0===r)s=t,h=i;else{if("string"!=typeof t||"string"!=typeof i||!r||"object"!=typeof r)throw new Error("Unknown call format to patch_make.");s=t,h=r}if(0===h.length)return[];for(var f=[],a=new e.patch_obj,l=0,g=0,o=0,c=s,u=s,p=0;p<h.length;p++){var d=h[p][0],_=h[p][1];switch(l||0===d||(a.start1=g,a.start2=o),d){case 1:a.diffs[l++]=h[p],a.length2+=_.length,u=u.substring(0,o)+_+u.substring(o);break;case n:a.length1+=_.length,a.diffs[l++]=h[p],u=u.substring(0,o)+u.substring(o+_.length);break;case 0:_.length<=2*this.Patch_Margin&&l&&h.length!=p+1?(a.diffs[l++]=h[p],a.length1+=_.length,a.length2+=_.length):_.length>=2*this.Patch_Margin&&l&&(this.patch_addContext_(a,c),f.push(a),a=new e.patch_obj,l=0,c=u,g=o)}1!==d&&(g+=_.length),d!==n&&(o+=_.length)}return l&&(this.patch_addContext_(a,c),f.push(a)),f},e.prototype.patch_deepCopy=function(t){for(var n=[],i=0;i<t.length;i++){var r=t[i],s=new e.patch_obj;s.diffs=[];for(var h=0;h<r.diffs.length;h++)s.diffs[h]=new e.Diff(r.diffs[h][0],r.diffs[h][1]);s.start1=r.start1,s.start2=r.start2,s.length1=r.length1,s.length2=r.length2,n[i]=s}return n},e.prototype.patch_apply=function(t,e){if(0==t.length)return[e,[]];t=this.patch_deepCopy(t);var i=this.patch_addPadding(t);e=i+e+i,this.patch_splitMax(t);for(var r=0,s=[],h=0;h<t.length;h++){var f,a,l=t[h].start2+r,g=this.diff_text1(t[h].diffs),o=-1;if(g.length>this.Match_MaxBits?-1!=(f=this.match_main(e,g.substring(0,this.Match_MaxBits),l))&&(-1==(o=this.match_main(e,g.substring(g.length-this.Match_MaxBits),l+g.length-this.Match_MaxBits))||f>=o)&&(f=-1):f=this.match_main(e,g,l),-1==f)s[h]=!1,r-=t[h].length2-t[h].length1;else if(s[h]=!0,r=f-l,g==(a=-1==o?e.substring(f,f+g.length):e.substring(f,o+this.Match_MaxBits)))e=e.substring(0,f)+this.diff_text2(t[h].diffs)+e.substring(f+g.length);else{var c=this.diff_main(g,a,!1);if(g.length>this.Match_MaxBits&&this.diff_levenshtein(c)/g.length>this.Patch_DeleteThreshold)s[h]=!1;else{this.diff_cleanupSemanticLossless(c);for(var u,p=0,d=0;d<t[h].diffs.length;d++){var _=t[h].diffs[d];0!==_[0]&&(u=this.diff_xIndex(c,p)),1===_[0]?e=e.substring(0,f+u)+_[1]+e.substring(f+u):_[0]===n&&(e=e.substring(0,f+u)+e.substring(f+this.diff_xIndex(c,p+_[1].length))),_[0]!==n&&(p+=_[1].length)}}}}return[e=e.substring(i.length,e.length-i.length),s]},e.prototype.patch_addPadding=function(t){for(var n=this.Patch_Margin,i="",r=1;r<=n;r++)i+=String.fromCharCode(r);for(r=0;r<t.length;r++)t[r].start1+=n,t[r].start2+=n;var s=t[0],h=s.diffs;if(0==h.length||0!=h[0][0])h.unshift(new e.Diff(0,i)),s.start1-=n,s.start2-=n,s.length1+=n,s.length2+=n;else if(n>h[0][1].length){var f=n-h[0][1].length;h[0][1]=i.substring(h[0][1].length)+h[0][1],s.start1-=f,s.start2-=f,s.length1+=f,s.length2+=f}return 0==(h=(s=t[t.length-1]).diffs).length||0!=h[h.length-1][0]?(h.push(new e.Diff(0,i)),s.length1+=n,s.length2+=n):n>h[h.length-1][1].length&&(f=n-h[h.length-1][1].length,h[h.length-1][1]+=i.substring(0,f),s.length1+=f,s.length2+=f),i},e.prototype.patch_splitMax=function(t){for(var i=this.Match_MaxBits,r=0;r<t.length;r++)if(!(t[r].length1<=i)){var s=t[r];t.splice(r--,1);for(var h=s.start1,f=s.start2,a="";0!==s.diffs.length;){var l=new e.patch_obj,g=!0;for(l.start1=h-a.length,l.start2=f-a.length,""!==a&&(l.length1=l.length2=a.length,l.diffs.push(new e.Diff(0,a)));0!==s.diffs.length&&l.length1<i-this.Patch_Margin;){var o=s.diffs[0][0],c=s.diffs[0][1];1===o?(l.length2+=c.length,f+=c.length,l.diffs.push(s.diffs.shift()),g=!1):o===n&&1==l.diffs.length&&0==l.diffs[0][0]&&c.length>2*i?(l.length1+=c.length,h+=c.length,g=!1,l.diffs.push(new e.Diff(o,c)),s.diffs.shift()):(c=c.substring(0,i-l.length1-this.Patch_Margin),l.length1+=c.length,h+=c.length,0===o?(l.length2+=c.length,f+=c.length):g=!1,l.diffs.push(new e.Diff(o,c)),c==s.diffs[0][1]?s.diffs.shift():s.diffs[0][1]=s.diffs[0][1].substring(c.length))}a=(a=this.diff_text2(l.diffs)).substring(a.length-this.Patch_Margin);var u=this.diff_text1(s.diffs).substring(0,this.Patch_Margin);""!==u&&(l.length1+=u.length,l.length2+=u.length,0!==l.diffs.length&&0===l.diffs[l.diffs.length-1][0]?l.diffs[l.diffs.length-1][1]+=u:l.diffs.push(new e.Diff(0,u))),g||t.splice(++r,0,l)}}},e.prototype.patch_toText=function(t){for(var e=[],n=0;n<t.length;n++)e[n]=t[n];return e.join("")},e.prototype.patch_fromText=function(t){var i=[];if(!t)return i;for(var r=t.split("\\n"),s=0,h=/^@@ -(\\d+),?(\\d*) \\+(\\d+),?(\\d*) @@$/;s<r.length;){var f=r[s].match(h);if(!f)throw new Error("Invalid patch string: "+r[s]);var a=new e.patch_obj;for(i.push(a),a.start1=parseInt(f[1],10),""===f[2]?(a.start1--,a.length1=1):"0"==f[2]?a.length1=0:(a.start1--,a.length1=parseInt(f[2],10)),a.start2=parseInt(f[3],10),""===f[4]?(a.start2--,a.length2=1):"0"==f[4]?a.length2=0:(a.start2--,a.length2=parseInt(f[4],10)),s++;s<r.length;){var l=r[s].charAt(0);try{var g=decodeURI(r[s].substring(1))}catch(t){throw new Error("Illegal escape in patch_fromText: "+g)}if("-"==l)a.diffs.push(new e.Diff(n,g));else if("+"==l)a.diffs.push(new e.Diff(1,g));else if(" "==l)a.diffs.push(new e.Diff(0,g));else{if("@"==l)break;if(""!==l)throw new Error(\'Invalid patch mode "\'+l+\'" in: \'+g)}s++}}return i},(e.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0}).prototype.toString=function(){for(var t,e=["@@ -"+(0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1)+" +"+(0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2)+" @@\\n"],i=0;i<this.diffs.length;i++){switch(this.diffs[i][0]){case 1:t="+";break;case n:t="-";break;case 0:t=" "}e[i+1]=t+encodeURI(this.diffs[i][1])+"\\n"}return e.join("").replace(/%20/g," ")},t.exports=e,t.exports.diff_match_patch=e,t.exports.DIFF_DELETE=n,t.exports.DIFF_INSERT=1,t.exports.DIFF_EQUAL=0}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var s=e[i]={exports:{}};return t[i](s,s.exports,n),s.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";const t=new(n(8).diff_match_patch);t.Diff_Timeout=0;const e=(t,e)=>t.index>=0?(t.index=e,t):e;addEventListener("message",(n=>{"get-url"!==n.data[0]?(n=>{try{const r=[],s=n.data[0],h=n.data[1],f=n.data[2],a=t.diff_main(s,h);1===a.length&&0===a[0][0]&&n.ports[0].postMessage({result:f});let l=0,g=0,o=0,c=0,u=0,p=0;for(const t of a){const n=t[0],s=t[1].length;switch(n){case 0:u=s,p=s;break;case 1:u=0,p=s;break;case-1:o+=s;continue}g+=o,o=0;for(let t=l;t<f.length;t+=1){const s=(i=f[t]).index>=0?i.index:i;if(s<c)throw new Error("Indices are not sorted!");if(!(s>=c&&s<c+p))break;r[t]=e(f[t],0===n?s+g-c:g),l+=1}if(l===f.length)break;g+=u,c+=p}for(let t=l;t<f.length;t+=1)r[t]=e(f[t],g);n.ports[0].postMessage({result:r})}catch(t){n.ports[0].postMessage({error:t})}var i})(n):n.ports[0].postMessage({url:self.location.href})}),!1)})()})();\n//# sourceMappingURL=index-readjuster-worker.worker.js.map',"Worker",void 0,n.p+"index-readjuster-worker.worker.js")}},14269:e=>{"use strict";e.exports=function(e,t,n,r){var i=self||window;try{try{var o;try{o=new i.Blob([e])}catch(t){(o=new(i.BlobBuilder||i.WebKitBlobBuilder||i.MozBlobBuilder||i.MSBlobBuilder)).append(e),o=o.getBlob()}var a=i.URL||i.webkitURL,s=a.createObjectURL(o),l=new i[t](s,n);return a.revokeObjectURL(s),l}catch(r){return new i[t]("data:application/javascript,".concat(encodeURIComponent(e)),n)}}catch(e){if(!r)throw Error("Inline worker is not supported");return new i[t](r,n)}}}}]);
//# sourceMappingURL=sccserviceciq.js.map