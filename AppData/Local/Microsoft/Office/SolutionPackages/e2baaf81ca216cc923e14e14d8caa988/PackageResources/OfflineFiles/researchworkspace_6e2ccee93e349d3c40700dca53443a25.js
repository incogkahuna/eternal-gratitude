"use strict";(self.webpackChunkTypeScriptModule=self.webpackChunkTypeScriptModule||[]).push([[5163],{77346:(e,t,n)=>{n.r(t),n.d(t,{Research:()=>fa,getLoopCard:()=>F});var o=n(80087),i=n(12227),r=n(60668),a=n(76886),s=n(24060),l=n(39020),c=n(1783),d=n(13345),p=n(89225),u=n(61195),h=n(94596),m=n(78314),g=n(51319),f=n(61600),b=n(66218),y=n(8520),_=n(71995),C=n(78901),v=n(71390),x=n(19663),S=n(58651);const k=new C.I({containerEnvironment:"Staging",localeHint:"en-us"});var P;!function(e){e.PlotlyJson="PlotlyJson",e.PlainText="PlainText"}(P||(P={}));const E={get Disposable(){return this},dispose(){S.log("DummyDisposable disposed")}},T=new _.H;T.register("FluidUrlResolverProvider",Promise.resolve({urlResolver:{resolve:async e=>Promise.resolve(e.url)},get FluidUrlResolverProvider(){return this},get Disposable(){return E}})),T.register("FluidDocumentServiceFactoryProvider",Promise.resolve({documentServiceFactory:{},get FluidDocumentServiceFactoryProvider(){return this},get Disposable(){return E}})),T.register("FluidCodeLoaderFactory",k),T.register("SettingsProvider",new class{constructor(e="Staging"){this.audience=e}getSetting(e,t,n){return"Fluid.Container.MemoryBlobStorageEnabled"===e||("codeBlock.previewPlotlyEnabled"===e||t)}get SettingsProvider(){return this}get Disposable(){return this}dispose(){S.log("MockSettingsProvider disposed")}});const w={HTMLViewable:"HTMLViewable",Disposable:"Disposable",ComponentCanvasProvider:"ComponentCanvasProvider"},I=({htmlData:e="",documentUrl:t="",insertHtmlText:n="",isArtifactData:o=!1,loopCodeArtifactType:i=P.PlainText})=>{S.log(t,n);const r=(0,y.useRef)(null),a=(0,y.useRef)(),s=(0,y.useRef)();return e=D(e,o,i),(0,y.useEffect)((()=>{o||a.current?.ComponentRichTextEditor?.setHtml(""==e?"Draft content will be generated here":e)}),[e]),(0,y.useEffect)((()=>{r.current&&async function(t){try{const n={iframeHostingDiv:t,dependencySynthesizer:T,loopComponentRouterInput:{type:"Fluid",codeDetails:(0,v.oO)()},options:{iframeTitle:"Loop Component"},config:{environment:{audience:"Staging"}},requiredProviderTypes:w},i=(0,x.j)(n),r=await i.component;if(i.addOnDisposeAction((()=>r.Disposable?.dispose())),a.current=await(r.ComponentCanvasProvider?.getCanvasComponent()),s.current=await(r.ComponentCanvasProvider?.getCanvasComponent()),o){const t=s.current?.ComponentEditable;if(!t)throw new Error("ComponentEditable is not available");if(!t.createComponentRange||!t.appendContent)throw new Error("ComponentEditable APIs are not available");const n=e,o=await t.createComponentRange();t.appendContent(""==n?"Draft content will be generated here":n,o,{attribution:void 0})}else a.current?.ComponentRichTextEditor?.setHtml(""==e?"Draft content will be generated here":e);const l=(await(r.HTMLViewable?.getView()))?.HTMLView;i.addOnDisposeAction((()=>l?.dispose())),l?.render(i.getRenderHostingElement())}catch(e){S.error("loadAndRender failed with error:",e)}}(r.current)}),[r,a,s]),y.createElement("div",{ref:r,style:{height:"100%",alignContent:"start"}})},D=(e,t,n)=>{if(!t||null==n)return e;switch(n){case P.PlainText:return'<pre><code class="language-Plain">'+e+"</code></pre>";case P.PlotlyJson:return'<pre><code class="language-Json" preview="Preview">'+e+"</code></pre>";default:return'<pre><code class="language-Plain">'+e+"</code></pre>"}};var R=n(80866),A=n(10466),O=n(80005);const M=(0,R.n)({cardStyle:{padding:"1px",borderRadius:"8px",zIndex:999,maxHeight:"80vh",overflowY:"auto"},cardGap:{...A.Pt.gap("8px")},headerStyle:{marginTop:"20px !important"},paddingBottom:{paddingBottom:"12px"},PinCardsStyle:{padding:"12px",backgroundColor:O.L.colorNeutralBackground2},accordionPanelStyle:{paddingBottom:"12px",...A.Pt.gap("8px")},pinnedMessageStyle:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis",maxHeight:"3em",lineHeight:"1.5em",whiteSpace:"normal"},showMoreCardStyle:{padding:"4px 8px",borderRadius:"8px",backgroundColor:O.L.colorNeutralBackground2}});var N=n(58651);const B=({id:e,content:t,addButtonProps:n,copyButtonProps:_,pinButtonProps:C,aiHelpButtonProps:v,aiSuggestionButtonProps:x,isContentSensitive:S=!1,isArtifactData:k=!1,loopCodeArtifactType:P})=>{const E=M(),T=e=>y.createElement(r.W,{positioning:"above"},y.createElement(a.c,{disableButtonEnhancement:!0},y.createElement(s.$,{size:"small",appearance:"transparent",icon:e?.buttonIcon??y.createElement(y.Fragment,null,e?.buttonIcon)},e?.buttonText)),y.createElement(l.b,null,y.createElement(c.c,null,y.createElement(d.r,null,y.createElement(p.s,null,y.createElement(u.Q,null,e.headerText)),e?.suggestionList.map((e=>y.createElement(y.Fragment,null,y.createElement(h.c,null),y.createElement(m.D,{onClick:()=>e?.onClick(t,e.content,e.responsetype,e.skillName),icon:e.icon},e.content))))))));return y.createElement(o.B,{key:e},y.createElement(i.a,null,((e,t,n)=>{const o=e.replace(/<table/g,'<table style="width:100%; height: 100%;"');return N.log("HtmlContent  ",o),y.createElement(I,{htmlData:e,documentUrl:"documentUrl",key:"loopComponent",insertHtmlText:e,isArtifactData:t,loopCodeArtifactType:n})})(t,k,P)),y.createElement(o.B,{horizontal:!0,className:E.cardGap},n&&y.createElement(s.$,{size:"small",icon:n.icon??y.createElement(g.m61,null),onClick:()=>n.onClick?.(t),disabled:S},n.text),v&&T(v),_&&y.createElement(s.$,{size:"small",appearance:"transparent",icon:_.icon??y.createElement(f.Qvr,null),onClick:()=>_.onClick?.(t),disabled:S}),C&&y.createElement(s.$,{size:"small",appearance:"transparent",icon:C.icon??y.createElement(b.MtV,null),onClick:()=>C.onClick?.(t,e),disabled:S}),x&&T(x)))},F=(e,t,n,o,i,r,a,s,l,c)=>y.createElement(B,{id:e,content:t,addButtonProps:n,copyButtonProps:o,pinButtonProps:i,aiHelpButtonProps:r,aiSuggestionButtonProps:a,isContentSensitive:s,isArtifactData:l,loopCodeArtifactType:c});var G,L=n(35096),H=n(53910),W=n(18792),z=n(96229),U=n(79490),V=n(27118),Q=n(60757),q=n(41743),K=n(87395),$=n(94766),j=n(3117),J=n(23148),Z=n(73672),Y=n(52481),X=n(33799),ee=n(29211),te=n(12402),ne=n(47221),oe=n(31989),ie=n(70083),re=n(73847),ae=n(84549),se=n(12706),le=n(4164),ce=n(52036),de=n(16591),pe=(0,ce.J9)((function(e,t){var n,o,i,r=(0,de.$)(e),a={root:(n={padding:"0 4px",height:"40px",color:e.palette.neutralPrimary,backgroundColor:"transparent",border:"1px solid transparent"},n[le.up]={borderColor:"Window"},n),rootHovered:(o={color:e.palette.themePrimary},o[le.up]={color:"Highlight"},o),iconHovered:{color:e.palette.themePrimary},rootPressed:{color:e.palette.black},rootExpanded:{color:e.palette.themePrimary},iconPressed:{color:e.palette.themeDarker},rootDisabled:(i={color:e.palette.neutralTertiary,backgroundColor:"transparent",borderColor:"transparent"},i[le.up]={color:"GrayText"},i),rootChecked:{color:e.palette.black},iconChecked:{color:e.palette.themeDarker},flexContainer:{justifyContent:"flex-start"},icon:{color:e.palette.themeDarkAlt},iconDisabled:{color:"inherit"},menuIcon:{color:e.palette.neutralSecondary},textContainer:{flexGrow:0}};return(0,le.TW)(r,a,t)})),ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,U.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.styles,n=e.theme;return y.createElement(re.S,(0,U.__assign)({},this.props,{variantClassName:"ms-Button--action ms-Button--command",styles:pe(n,t),onRenderDescription:ae.K}))},t=(0,U.__decorate)([(0,se.T)("ActionButton",["theme","styles"],!0)],t)}(y.Component),he=ue;!function(e){e[e.Normal=0]="Normal",e[e.Divider=1]="Divider",e[e.Header=2]="Header",e[e.SelectAll=3]="SelectAll"}(G||(G={}));var me,ge=function(){function e(){this._size=0}return e.prototype.updateOptions=function(e){for(var t=[],n=[],o=0,i=0;i<e.length;i++){var r=e[i],a=r.itemType,s=r.hidden;a===G.Divider||a===G.Header?(t.push(i),n.push(i)):s?n.push(i):o++}this._size=o,this._displayOnlyOptionsCache=t,this._notSelectableOptionsCache=n,this._cachedOptions=(0,U.__spreadArray)([],e,!0)},Object.defineProperty(e.prototype,"optionSetSize",{get:function(){return this._size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cachedOptions",{get:function(){return this._cachedOptions},enumerable:!1,configurable:!0}),e.prototype.positionInSet=function(e){if(void 0!==e){for(var t=0;e>this._notSelectableOptionsCache[t];)t++;if(this._displayOnlyOptionsCache[t]===e)throw new Error("Unexpected: Option at index ".concat(e," is not a selectable element."));if(this._notSelectableOptionsCache[t]!==e)return e-t+1}},e}(),fe=n(35475),be=n(54004),ye=n(71821),_e=n(28079),Ce=n(53329),ve=n(94833),xe=n(53558),Se=n(77936),ke=n(74023),Pe=n(12738),Ee=n(84896),Te=n(71829),we=n(62162),Ie=n(85298),De=n(37097);!function(e){e[e.smallFluid=0]="smallFluid",e[e.smallFixedFar=1]="smallFixedFar",e[e.smallFixedNear=2]="smallFixedNear",e[e.medium=3]="medium",e[e.large=4]="large",e[e.largeFixed=5]="largeFixed",e[e.extraLarge=6]="extraLarge",e[e.custom=7]="custom",e[e.customNear=8]="customNear"}(me||(me={}));var Re,Ae=n(8039),Oe=n(32401),Me=(0,V.Z)();!function(e){e[e.closed=0]="closed",e[e.animatingOpen=1]="animatingOpen",e[e.open=2]="open",e[e.animatingClosed=3]="animatingClosed"}(Re||(Re={}));var Ne,Be,Fe,Ge,Le,He=function(e){function t(t){var n=e.call(this,t)||this;n._panel=y.createRef(),n._animationCallback=null,n._hasCustomNavigation=!(!n.props.onRenderNavigation&&!n.props.onRenderNavigationContent),n.dismiss=function(e){n.props.onDismiss&&n.isActive&&n.props.onDismiss(e),(!e||e&&!e.defaultPrevented)&&n.close()},n._allowScrollOnPanel=function(e){var t;n._resizeObserver=n._createResizeObserver((function(t){t.length>0&&t[0].target===e&&n._updateFooterPosition()})),e?(null===(t=n._resizeObserver)||void 0===t||t.observe(e),n._allowTouchBodyScroll?(0,ke.K0)(e,n._events):(0,ke.c8)(e,n._events)):n._events.off(n._scrollableContent),n._scrollableContent=e},n._onRenderNavigation=function(e){if(!n.props.onRenderNavigationContent&&!n.props.onRenderNavigation&&!n.props.hasCloseButton)return null;var t=n.props.onRenderNavigationContent,o=void 0===t?n._onRenderNavigationContent:t;return y.createElement("div",{className:n._classNames.navigation},o(e,n._onRenderNavigationContent))},n._onRenderNavigationContent=function(e){var t,o=e.closeButtonAriaLabel,i=e.hasCloseButton,r=e.onRenderHeader,a=void 0===r?n._onRenderHeader:r;if(i){var s=null===(t=n._classNames.subComponentStyles)||void 0===t?void 0:t.closeButton();return y.createElement(y.Fragment,null,!n._hasCustomNavigation&&a(n.props,n._onRenderHeader,n._headerTextId),y.createElement(Ce.K,{styles:s,className:n._classNames.closeButton,onClick:n._onPanelClick,ariaLabel:o,title:o,"data-is-visible":!0,iconProps:{iconName:"Cancel"}}))}return null},n._onRenderHeader=function(e,t,o){var i=e.headerText,r=e.headerTextProps,a=void 0===r?{}:r;return i?y.createElement("div",{className:n._classNames.header},y.createElement("div",(0,U.__assign)({id:o,role:"heading","aria-level":1},a,{className:(0,K.A)(n._classNames.headerText,a.className)}),i)):null},n._onRenderBody=function(e){return y.createElement("div",{className:n._classNames.content},e.children)},n._onRenderFooter=function(e){var t=n.props.onRenderFooterContent,o=void 0===t?null:t;return o?y.createElement("div",{className:n._classNames.footer},y.createElement("div",{className:n._classNames.footerInner},o())):null},n._animateTo=function(e){e===Re.open&&n.props.onOpen&&n.props.onOpen(),n._animationCallback=n._async.setTimeout((function(){n.setState({visibility:e}),n._onTransitionComplete(e)}),200)},n._clearExistingAnimationTimer=function(){null!==n._animationCallback&&n._async.clearTimeout(n._animationCallback)},n._onPanelClick=function(e){n.dismiss(e)},n._onTransitionComplete=function(e){n._updateFooterPosition(),e===Re.open&&n.props.onOpened&&n.props.onOpened(),e===Re.closed&&n.props.onDismissed&&n.props.onDismissed()};var o=n.props.allowTouchBodyScroll,i=void 0!==o&&o;return n._allowTouchBodyScroll=i,(0,Z.f)(n),(0,Pe.A)("Panel",t,{ignoreExternalFocusing:"focusTrapZoneProps",forceFocusInsideTrap:"focusTrapZoneProps",firstFocusableSelector:"focusTrapZoneProps"}),n.state={isFooterSticky:!1,visibility:Re.closed,id:(0,Y.O)("Panel")},n}return(0,U.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){return void 0===e.isOpen?null:!e.isOpen||t.visibility!==Re.closed&&t.visibility!==Re.animatingClosed?e.isOpen||t.visibility!==Re.open&&t.visibility!==Re.animatingOpen?null:{visibility:Re.animatingClosed}:{visibility:Re.animatingOpen}},t.prototype.componentDidMount=function(){this._async=new Ee.j(this),this._events=new Te.g(this);var e=(0,Oe.k_)(this.context),t=(0,Oe.LW)(this.context);this._events.on(e,"resize",this._updateFooterPosition),this._shouldListenForOuterClick(this.props)&&this._events.on(null==t?void 0:t.body,"mousedown",this._dismissOnOuterClick,!0),this.props.isOpen&&this.setState({visibility:Re.animatingOpen})},t.prototype.componentDidUpdate=function(e,t){var n=this._shouldListenForOuterClick(this.props),o=this._shouldListenForOuterClick(e);this.state.visibility!==t.visibility&&(this._clearExistingAnimationTimer(),this.state.visibility===Re.animatingOpen?this._animateTo(Re.open):this.state.visibility===Re.animatingClosed&&this._animateTo(Re.closed));var i=(0,Oe.LW)(this.context);n&&!o?this._events.on(null==i?void 0:i.body,"mousedown",this._dismissOnOuterClick,!0):!n&&o&&this._events.off(null==i?void 0:i.body,"mousedown",this._dismissOnOuterClick,!0)},t.prototype.componentWillUnmount=function(){var e;this._async.dispose(),this._events.dispose(),null===(e=this._resizeObserver)||void 0===e||e.disconnect()},t.prototype.render=function(){var e=this.props,t=e.className,n=void 0===t?"":t,o=e.elementToFocusOnDismiss,i=e.firstFocusableSelector,r=e.focusTrapZoneProps,a=e.forceFocusInsideTrap,s=e.hasCloseButton,l=e.headerText,c=e.headerClassName,d=void 0===c?"":c,p=e.ignoreExternalFocusing,u=e.isBlocking,h=e.isFooterAtBottom,m=e.isLightDismiss,g=e.isHiddenOnDismiss,f=e.layerProps,b=e.overlayProps,_=e.popupProps,C=e.type,v=e.styles,x=e.theme,S=e.customWidth,k=e.onLightDismissClick,P=void 0===k?this._onPanelClick:k,E=e.onRenderNavigation,T=void 0===E?this._onRenderNavigation:E,w=e.onRenderHeader,I=void 0===w?this._onRenderHeader:w,D=e.onRenderBody,R=void 0===D?this._onRenderBody:D,A=e.onRenderFooter,O=void 0===A?this._onRenderFooter:A,M=this.state,N=M.isFooterSticky,B=M.visibility,F=M.id,G=C===me.smallFixedNear||C===me.customNear,L=(0,we.jI)(x)?G:!G,H=C===me.custom||C===me.customNear?{width:S}:{},W=(0,X.G1)(this.props,X.JM),z=this.isActive,V=B===Re.animatingClosed||B===Re.animatingOpen;if(this._headerTextId=l&&F+"-headerText",!z&&!V&&!g)return null;this._classNames=Me(v,{theme:x,className:n,focusTrapZoneClassName:r?r.className:void 0,hasCloseButton:s,headerClassName:d,isAnimating:V,isFooterSticky:N,isFooterAtBottom:h,isOnRightSide:L,isOpen:z,isHiddenOnDismiss:g,type:C,hasCustomNavigation:this._hasCustomNavigation});var Q,q=this._classNames,K=this._allowTouchBodyScroll;return u&&z&&(Q=y.createElement(xe.h,(0,U.__assign)({className:q.overlay,isDarkThemed:!1,onClick:m?P:void 0,allowTouchBodyScroll:K},b))),y.createElement(ve.W,(0,U.__assign)({},f),y.createElement(Se.z,(0,U.__assign)({role:"dialog","aria-modal":u?"true":void 0,ariaLabelledBy:this._headerTextId?this._headerTextId:void 0,onDismiss:this.dismiss,className:q.hiddenPanel,enableAriaHiddenSiblings:!!z},_),y.createElement("div",(0,U.__assign)({"aria-hidden":!z&&V},W,{ref:this._panel,className:q.root}),Q,y.createElement(De.Y,(0,U.__assign)({ignoreExternalFocusing:p,forceFocusInsideTrap:!(!u||g&&!z)&&a,firstFocusableSelector:i,isClickableOutsideFocusTrap:!0},r,{className:q.main,style:H,elementToFocusOnDismiss:o}),y.createElement("div",{className:q.contentInner},y.createElement("div",{ref:this._allowScrollOnPanel,className:q.scrollableContent,"data-is-scrollable":!0},y.createElement("div",{className:q.commands,"data-is-visible":!0},T(this.props,this._onRenderNavigation)),(this._hasCustomNavigation||!s)&&I(this.props,this._onRenderHeader,this._headerTextId),R(this.props,this._onRenderBody),O(this.props,this._onRenderFooter)))))))},t.prototype.open=function(){void 0===this.props.isOpen&&(this.isActive||this.setState({visibility:Re.animatingOpen}))},t.prototype.close=function(){void 0===this.props.isOpen&&this.isActive&&this.setState({visibility:Re.animatingClosed})},Object.defineProperty(t.prototype,"isActive",{get:function(){return this.state.visibility===Re.open||this.state.visibility===Re.animatingOpen},enumerable:!1,configurable:!0}),t.prototype._createResizeObserver=function(e){var t,n=(0,Oe.LW)(this.context),o=null;return(null===(t=null==n?void 0:n.defaultView)||void 0===t?void 0:t.ResizeObserver)&&(o=new n.defaultView.ResizeObserver(e)),o},t.prototype._shouldListenForOuterClick=function(e){return!!e.isBlocking&&!!e.isOpen},t.prototype._updateFooterPosition=function(){var e=this._scrollableContent;if(e){var t=e.clientHeight,n=e.scrollHeight;this.setState({isFooterSticky:t<n})}},t.prototype._dismissOnOuterClick=function(e){var t=this._panel.current;this.isActive&&t&&!e.defaultPrevented&&((0,Ie.s)(t,e.target)||(this.props.onOuterClick?this.props.onOuterClick(e):this.dismiss(e)))},t.defaultProps={isHiddenOnDismiss:!1,isOpen:void 0,isBlocking:!0,hasCloseButton:!0,type:me.smallFixedFar},t.contextType=Ae._0,t}(y.Component),We={root:"ms-Panel",main:"ms-Panel-main",commands:"ms-Panel-commands",contentInner:"ms-Panel-contentInner",scrollableContent:"ms-Panel-scrollableContent",navigation:"ms-Panel-navigation",closeButton:"ms-Panel-closeButton ms-PanelAction-close",header:"ms-Panel-header",headerText:"ms-Panel-headerText",content:"ms-Panel-content",footer:"ms-Panel-footer",footerInner:"ms-Panel-footerInner",isOpen:"is-open",hasCloseButton:"ms-Panel--hasCloseButton",smallFluid:"ms-Panel--smFluid",smallFixedNear:"ms-Panel--smLeft",smallFixedFar:"ms-Panel--sm",medium:"ms-Panel--md",large:"ms-Panel--lg",largeFixed:"ms-Panel--fixed",extraLarge:"ms-Panel--xl",custom:"ms-Panel--custom",customNear:"ms-Panel--customLeft"},ze="100%",Ue="auto",Ve=272,Qe=340,qe=592,Ke=644,$e=940,je="auto",Je=0,Ze=48,Ye=428,Xe=176,et=((Ne={})["@media (min-width: ".concat(le.O7,"px)")]={width:Qe},Ne),tt=((Be={})["@media (min-width: ".concat(le.mu,"px)")]={width:qe},Be["@media (min-width: ".concat(le.af,"px)")]={width:Ke},Be),nt=((Fe={})["@media (min-width: ".concat(le.c3,"px)")]={left:Ze,width:Ue},Fe["@media (min-width: ".concat(le.Ke,"px)")]={left:Ye},Fe),ot=((Ge={})["@media (min-width: ".concat(le.Ke,"px)")]={left:je,width:$e},Ge),it=((Le={})["@media (min-width: ".concat(le.Ke,"px)")]={left:Xe},Le),rt=function(e){var t;switch(e){case me.smallFixedFar:t=(0,U.__assign)({},et);break;case me.medium:t=(0,U.__assign)((0,U.__assign)({},et),tt);break;case me.large:t=(0,U.__assign)((0,U.__assign)((0,U.__assign)({},et),tt),nt);break;case me.largeFixed:t=(0,U.__assign)((0,U.__assign)((0,U.__assign)((0,U.__assign)({},et),tt),nt),ot);break;case me.extraLarge:t=(0,U.__assign)((0,U.__assign)((0,U.__assign)((0,U.__assign)({},et),tt),nt),it)}return t},at={paddingLeft:"24px",paddingRight:"24px"},st=(0,z.I)(He,(function(e){var t,n,o,i,r=e.className,a=e.focusTrapZoneClassName,s=e.hasCloseButton,l=e.headerClassName,c=e.isAnimating,d=e.isFooterSticky,p=e.isFooterAtBottom,u=e.isOnRightSide,h=e.isOpen,m=e.isHiddenOnDismiss,g=e.hasCustomNavigation,f=e.theme,b=e.type,y=void 0===b?me.smallFixedFar:b,_=f.effects,C=f.fonts,v=f.semanticColors,x=(0,le.Km)(We,f),S=y===me.custom||y===me.customNear;return{root:[x.root,f.fonts.medium,h&&x.isOpen,s&&x.hasCloseButton,{pointerEvents:"none",position:"absolute",top:0,left:0,right:0,bottom:0},S&&u&&x.custom,S&&!u&&x.customNear,r],overlay:[{pointerEvents:"auto",cursor:"pointer"},h&&c&&le.lw.fadeIn100,!h&&c&&le.lw.fadeOut100],hiddenPanel:[!h&&!c&&m&&{visibility:"hidden"}],main:[x.main,{backgroundColor:v.bodyBackground,boxShadow:_.elevation64,pointerEvents:"auto",position:"absolute",display:"flex",flexDirection:"column",overflowX:"hidden",overflowY:"auto",WebkitOverflowScrolling:"touch",bottom:0,top:0,left:je,right:Je,width:ze,selectors:(0,U.__assign)((t={},t[le.up]={borderLeft:"3px solid ".concat(v.variantBorder),borderRight:"3px solid ".concat(v.variantBorder)},t),rt(y))},y===me.smallFluid&&{left:Je},y===me.smallFixedNear&&{left:Je,right:je,width:Ve},y===me.customNear&&{right:"auto",left:0},S&&{maxWidth:"100vw"},h&&c&&!u&&le.lw.slideRightIn40,h&&c&&u&&le.lw.slideLeftIn40,!h&&c&&!u&&le.lw.slideLeftOut40,!h&&c&&u&&le.lw.slideRightOut40,a],commands:[x.commands,{backgroundColor:v.bodyBackground,paddingTop:18,selectors:(n={},n["@media (min-height: ".concat(le.O7,"px)")]={position:"sticky",top:0,zIndex:1},n)},g&&{paddingTop:"inherit"}],navigation:[x.navigation,{display:"flex",justifyContent:"flex-end"},g&&{height:"44px"}],contentInner:[x.contentInner,{display:"flex",flexDirection:"column",flexGrow:1,overflowY:"hidden"}],header:[x.header,at,{alignSelf:"flex-start"},s&&!g&&{flexGrow:1},g&&{flexShrink:0}],headerText:[x.headerText,C.xLarge,{color:v.bodyText,lineHeight:"27px",overflowWrap:"break-word",wordWrap:"break-word",wordBreak:"break-word",hyphens:"auto"},l],scrollableContent:[x.scrollableContent,{overflowY:"auto"},p&&{flexGrow:1,display:"inherit",flexDirection:"inherit"}],content:[x.content,at,{paddingBottom:20},p&&{selectors:(o={},o["@media (min-height: ".concat(le.O7,"px)")]={flexGrow:1},o)}],footer:[x.footer,{flexShrink:0,borderTop:"1px solid transparent",transition:"opacity ".concat(le.cs.durationValue3," ").concat(le.cs.easeFunction2),selectors:(i={},i["@media (min-height: ".concat(le.O7,"px)")]={position:"sticky",bottom:0},i)},d&&{backgroundColor:v.bodyBackground,borderTopColor:v.variantBorder}],footerInner:[x.footerInner,at,{paddingBottom:16,paddingTop:16}],subComponentStyles:{closeButton:{root:[x.closeButton,{marginRight:14,color:f.palette.neutralSecondary,fontSize:le.fF.large},g&&{marginRight:0,height:"auto",width:"44px"}],rootHovered:{color:f.palette.neutralPrimary}}}}}),void 0,{scope:"Panel"}),lt=n(65820),ct=n(92763);function dt(e,t){for(var n=[],o=0,i=t;o<i.length;o++){var r=e[i[o]];r&&n.push(r)}return n}var pt=n(7201),ut=n(40906),ht=n(98770),mt=n(90703),gt=(0,V.Z)(),ft=y.forwardRef((function(e,t){var n=e.disabled,o=e.required,i=e.inputProps,r=e.name,a=e.ariaLabel,s=e.ariaLabelledBy,l=e.ariaDescribedBy,c=e.ariaPositionInSet,d=e.ariaSetSize,p=e.title,u=e.checkmarkIconProps,h=e.styles,m=e.theme,g=e.className,f=e.boxSide,b=void 0===f?"start":f,_=(0,pt.B)("checkbox-",e.id),C=y.useRef(null),v=(0,ut.a)(C,t),x=y.useRef(null),S=(0,ht.k)(e.checked,e.defaultChecked,e.onChange),k=S[0],P=S[1],E=(0,ht.k)(e.indeterminate,e.defaultIndeterminate),T=E[0],w=E[1];(0,mt.vk)(C);var I=gt(h,{theme:m,className:g,disabled:n,indeterminate:T,checked:k,reversed:"start"!==b,isUsingCustomLabelRender:!!e.onRenderLabel}),D=y.useCallback((function(e){T?(P(!!k,e),w(!1)):P(!k,e)}),[P,w,T,k]),R=y.useCallback((function(e){return e&&e.label?y.createElement("span",{className:I.text,title:e.title},e.label):null}),[I.text]),A=y.useCallback((function(e){if(x.current){var t=!!e;x.current.indeterminate=t,w(t)}}),[w]);!function(e,t,n,o,i){y.useImperativeHandle(e.componentRef,(function(){return{get checked(){return!!t},get indeterminate(){return!!n},set indeterminate(e){o(e)},focus:function(){i.current&&i.current.focus()}}}),[i,t,n,o])}(e,k,T,A,x),y.useEffect((function(){return A(T)}),[A,T]);var O=e.onRenderLabel||R,M=T?"mixed":void 0,N=(0,U.__assign)((0,U.__assign)({className:I.input,type:"checkbox"},i),{checked:!!k,disabled:n,required:o,name:r,id:_,title:p,onChange:D,"aria-disabled":n,"aria-label":a,"aria-labelledby":s,"aria-describedby":l,"aria-posinset":c,"aria-setsize":d,"aria-checked":M});return y.createElement("div",{className:I.root,title:p,ref:v},y.createElement("input",(0,U.__assign)({},N,{ref:x,title:p,"data-ktp-execute-target":!0})),y.createElement("label",{className:I.label,htmlFor:_},y.createElement("div",{className:I.checkbox,"data-ktp-target":!0},y.createElement(ye.I,(0,U.__assign)({iconName:"CheckMark"},u,{className:I.checkmark}))),O(e,R)))}));ft.displayName="CheckboxBase";var bt=n(58426),yt={root:"ms-Checkbox",label:"ms-Checkbox-label",checkbox:"ms-Checkbox-checkbox",checkmark:"ms-Checkbox-checkmark",text:"ms-Checkbox-text"},_t="20px",Ct="200ms",vt="cubic-bezier(.4, 0, .23, 1)",xt=(0,z.I)(ft,(function(e){var t,n,o,i,r,a,s,l,c,d,p,u,h,m,g,f,b,y,_=e.className,C=e.theme,v=e.reversed,x=e.checked,S=e.disabled,k=e.isUsingCustomLabelRender,P=e.indeterminate,E=C.semanticColors,T=C.effects,w=C.palette,I=C.fonts,D=(0,le.Km)(yt,C),R=E.inputForegroundChecked,A=w.neutralSecondary,O=w.neutralPrimary,M=E.inputBackgroundChecked,N=E.inputBackgroundChecked,B=E.disabledBodySubtext,F=E.inputBorderHovered,G=E.inputBackgroundCheckedHovered,L=E.inputBackgroundChecked,H=E.inputBackgroundCheckedHovered,W=E.inputBackgroundCheckedHovered,z=E.inputTextHovered,V=E.disabledBodySubtext,Q=E.bodyText,q=E.disabledText,K=[(t={content:'""',borderRadius:T.roundedCorner2,position:"absolute",width:10,height:10,top:4,left:4,boxSizing:"border-box",borderWidth:5,borderStyle:"solid",borderColor:S?B:M,transitionProperty:"border-width, border, border-color",transitionDuration:Ct,transitionTimingFunction:vt},t[le.up]={borderColor:"WindowText"},t)];return{root:[D.root,{position:"relative",display:"flex"},v&&"reversed",x&&"is-checked",!S&&"is-enabled",S&&"is-disabled",!S&&[!x&&(n={},n[":hover .".concat(D.checkbox)]=(o={borderColor:F},o[le.up]={borderColor:"Highlight"},o),n[":focus .".concat(D.checkbox)]={borderColor:F},n[":hover .".concat(D.checkmark)]=(i={color:A,opacity:"1"},i[le.up]={color:"Highlight"},i),n),x&&!P&&(r={},r[":hover .".concat(D.checkbox)]={background:H,borderColor:W},r[":focus .".concat(D.checkbox)]={background:H,borderColor:W},r[le.up]=(a={},a[":hover .".concat(D.checkbox)]={background:"Highlight",borderColor:"Highlight"},a[":focus .".concat(D.checkbox)]={background:"Highlight"},a[":focus:hover .".concat(D.checkbox)]={background:"Highlight"},a[":focus:hover .".concat(D.checkmark)]={color:"Window"},a[":hover .".concat(D.checkmark)]={color:"Window"},a),r),P&&(s={},s[":hover .".concat(D.checkbox,", :hover .").concat(D.checkbox,":after")]=(l={borderColor:G},l[le.up]={borderColor:"WindowText"},l),s[":focus .".concat(D.checkbox)]={borderColor:G},s[":hover .".concat(D.checkmark)]={opacity:"0"},s),(c={},c[":hover .".concat(D.text,", :focus .").concat(D.text)]=(d={color:z},d[le.up]={color:S?"GrayText":"WindowText"},d),c)],_],input:(p={position:"absolute",background:"none",opacity:0},p[".".concat(bt.Y2," &:focus + label::before, :host(.").concat(bt.Y2,") &:focus + label::before")]=(u={outline:"1px solid "+C.palette.neutralSecondary,outlineOffset:"2px"},u[le.up]={outline:"1px solid WindowText"},u),p),label:[D.label,C.fonts.medium,{display:"flex",alignItems:k?"center":"flex-start",cursor:S?"default":"pointer",position:"relative",userSelect:"none"},v&&{flexDirection:"row-reverse",justifyContent:"flex-end"},{"&::before":{position:"absolute",left:0,right:0,top:0,bottom:0,content:'""',pointerEvents:"none"}}],checkbox:[D.checkbox,(h={position:"relative",display:"flex",flexShrink:0,alignItems:"center",justifyContent:"center",height:_t,width:_t,border:"1px solid ".concat(O),borderRadius:T.roundedCorner2,boxSizing:"border-box",transitionProperty:"background, border, border-color",transitionDuration:Ct,transitionTimingFunction:vt,overflow:"hidden",":after":P?K:null},h[le.up]=(0,U.__assign)({borderColor:"WindowText"},(0,le.Qg)()),h),P&&{borderColor:M},v?{marginLeft:4}:{marginRight:4},!S&&!P&&x&&(m={background:L,borderColor:N},m[le.up]={background:"Highlight",borderColor:"Highlight"},m),S&&(g={borderColor:B},g[le.up]={borderColor:"GrayText"},g),x&&S&&(f={background:V,borderColor:B},f[le.up]={background:"Window"},f)],checkmark:[D.checkmark,(b={opacity:x&&!P?"1":"0",color:R},b[le.up]=(0,U.__assign)({color:S?"GrayText":"Window"},(0,le.Qg)()),b)],text:[D.text,(y={color:S?q:Q,fontSize:I.medium.fontSize,lineHeight:"20px"},y[le.up]=(0,U.__assign)({color:S?"GrayText":"WindowText"},(0,le.Qg)()),y),v?{marginRight:4}:{marginLeft:4}]}}),void 0,{scope:"Checkbox"}),St=n(80730),kt=n(44145),Pt=(0,V.Z)(),Et={options:[]};var Tt=y.forwardRef((function(e,t){var n=(0,St.N)(Et,e),o=y.useRef(null),i=(0,ut.a)(t,o),r=(0,lt.z)(o,n.responsiveMode),a=function(e){var t,n=e.defaultSelectedKeys,o=e.selectedKeys,i=e.defaultSelectedKey,r=e.selectedKey,a=e.options,s=e.multiSelect,l=(0,kt.Z)(a),c=y.useState([]),d=c[0],p=c[1],u=a!==l;t=s?u&&void 0!==n?n:o:u&&void 0!==i?i:r;var h=(0,kt.Z)(t);return y.useEffect((function(){var e=function(){return a.map((function(e,t){return e.selected?t:-1})).filter((function(e){return-1!==e}))},n=function(e){return(0,Q.SL)(a,(function(t){return null!=e?t.key===e:!!t.selected||!!t.isSelected}))};void 0===t&&l||t===h&&!u||p(function(){if(void 0===t)return s?e():-1!==(a=n(null))?[a]:[];if(!Array.isArray(t))return-1!==(a=n(t))?[a]:[];for(var o=[],i=0,r=t;i<r.length;i++){var a,l=r[i];-1!==(a=n(l))&&o.push(a)}return o}())}),[u,s,l,h,a,t]),[d,p]}(n),s=a[0],l=a[1];return y.createElement(Ot,(0,U.__assign)({},n,{responsiveMode:r,hoisted:{rootRef:i,selectedIndices:s,setSelectedIndices:l}}))}));Tt.displayName="DropdownBase";var wt,It,Dt,Rt,At,Ot=function(e){function t(t){var n,o,i=e.call(this,t)||this;i._host=y.createRef(),i._focusZone=y.createRef(),i._dropDown=y.createRef(),i._scrollIdleDelay=250,i._sizePosCache=new ge,i._requestAnimationFrame=(n=i,function(e){o||(o=new Set,(0,q.i)(n,{componentWillUnmount:function(){o.forEach((function(e){return cancelAnimationFrame(e)}))}}));var t=requestAnimationFrame((function(){o.delete(t),e()}));o.add(t)}),i.dismissMenu=function(){i.state.isOpen&&i.setState({isOpen:!1})},i._onChange=function(e,t,n,o,r){var a=i.props,s=a.onChange,l=a.onChanged;if(s||l){var c=r?(0,U.__assign)((0,U.__assign)({},t[n]),{selected:!o}):t[n];s&&s((0,U.__assign)((0,U.__assign)({},e),{target:i._dropDown.current}),c,n),l&&l(c,n)}},i._getPlaceholder=function(){return i.props.placeholder||i.props.placeHolder},i._getTitle=function(e,t){var n=i.props.multiSelectDelimiter,o=void 0===n?", ":n;return e.map((function(e){return e.text})).join(o)},i._onRenderTitle=function(e){return y.createElement(y.Fragment,null,i._getTitle(e))},i._onRenderPlaceholder=function(e){return i._getPlaceholder()?y.createElement(y.Fragment,null,i._getPlaceholder()):null},i._onRenderContainer=function(e){var t=e.calloutProps,n=e.panelProps,o=i.props,r=o.responsiveMode,a=o.dropdownWidth,s=r<=ct.AR.medium,l={firstFocusableTarget:"#".concat(i._listId,"1")},c=i._classNames.subComponentStyles?i._classNames.subComponentStyles.panel:void 0,d=void 0,p=void 0;return"auto"===a?p=i._dropDown.current?i._dropDown.current.clientWidth:0:d=a||(i._dropDown.current?i._dropDown.current.clientWidth:0),s?y.createElement(st,(0,U.__assign)({closeButtonAriaLabel:"Close",focusTrapZoneProps:l,hasCloseButton:!0,isOpen:!0,isLightDismiss:!0,onDismiss:i._onDismiss,styles:c},n),i._renderFocusableList(e)):y.createElement(oe.P,(0,U.__assign)({isBeakVisible:!1,gapSpace:0,doNotLayer:!1,directionalHintFixed:!1,directionalHint:ie.A.bottomLeftEdge,calloutWidth:d,calloutMinWidth:p},t,{className:i._classNames.callout,target:i._dropDown.current,onDismiss:i._onDismiss,onScroll:i._onScroll,onPositioned:i._onPositioned}),i._renderFocusableList(e))},i._onRenderCaretDown=function(e){return y.createElement(ye.I,{className:i._classNames.caretDown,iconName:"ChevronDown","aria-hidden":!0})},i._onRenderList=function(e){var t=e.onRenderItem,n=void 0===t?i._onRenderItem:t,o={items:[]},r=[],a=function(){var e=o.id?[y.createElement("div",{role:"group",key:o.id,"aria-labelledby":o.id},o.items)]:o.items;r=(0,U.__spreadArray)((0,U.__spreadArray)([],r,!0),e,!0),o={items:[]}};return e.options.forEach((function(e,t){!function(e,t){switch(e.itemType){case G.Header:o.items.length>0&&a();var r=i._id+e.key;o.items.push(n((0,U.__assign)((0,U.__assign)({id:r},e),{index:t}),i._onRenderItem)),o.id=r;break;case G.Divider:t>0&&o.items.push(n((0,U.__assign)((0,U.__assign)({},e),{index:t}),i._onRenderItem)),o.items.length>0&&a();break;default:o.items.push(n((0,U.__assign)((0,U.__assign)({},e),{index:t}),i._onRenderItem))}}(e,t)})),o.items.length>0&&a(),y.createElement(y.Fragment,null,r)},i._onRenderItem=function(e){switch(e.itemType){case G.Divider:return i._renderSeparator(e);case G.Header:return i._renderHeader(e);default:return i._renderOption(e)}},i._renderOption=function(e){var t,n=i.props,o=n.onRenderOption,r=void 0===o?i._onRenderOption:o,a=n.hoisted.selectedIndices,s=void 0===a?[]:a,l=!(void 0===e.index||!s)&&s.indexOf(e.index)>-1,c=e.hidden?i._classNames.dropdownItemHidden:l&&!0===e.disabled?i._classNames.dropdownItemSelectedAndDisabled:l?i._classNames.dropdownItemSelected:!0===e.disabled?i._classNames.dropdownItemDisabled:i._classNames.dropdownItem,d=e.title,p=i._listId+e.index,u=null!==(t=e.id)&&void 0!==t?t:p+"-label",h=i._classNames.subComponentStyles?i._classNames.subComponentStyles.multiSelectItem:void 0;return i.props.multiSelect?y.createElement(xt,{id:p,key:e.key,disabled:e.disabled,onChange:i._onItemClick(e),inputProps:(0,U.__assign)({"aria-selected":l,onMouseEnter:i._onItemMouseEnter.bind(i,e),onMouseLeave:i._onMouseItemLeave.bind(i,e),onMouseMove:i._onItemMouseMove.bind(i,e),role:"option"},{"data-index":e.index,"data-is-focusable":!(e.disabled||e.hidden)}),label:e.text,title:d,onRenderLabel:i._onRenderItemLabel.bind(i,(0,U.__assign)((0,U.__assign)({},e),{id:u})),className:(0,K.A)(c,"is-multi-select"),checked:l,styles:h,ariaPositionInSet:e.hidden?void 0:i._sizePosCache.positionInSet(e.index),ariaSetSize:e.hidden?void 0:i._sizePosCache.optionSetSize,ariaLabel:e.ariaLabel,ariaLabelledBy:e.ariaLabel?void 0:u}):y.createElement(he,{id:p,key:e.key,"data-index":e.index,"data-is-focusable":!e.disabled,disabled:e.disabled,className:c,onClick:i._onItemClick(e),onMouseEnter:i._onItemMouseEnter.bind(i,e),onMouseLeave:i._onMouseItemLeave.bind(i,e),onMouseMove:i._onItemMouseMove.bind(i,e),role:"option","aria-selected":l?"true":"false",ariaLabel:e.ariaLabel,title:d,"aria-posinset":i._sizePosCache.positionInSet(e.index),"aria-setsize":i._sizePosCache.optionSetSize},r(e,i._onRenderOption))},i._onRenderOption=function(e){return y.createElement("span",{className:i._classNames.dropdownOptionText},e.text)},i._onRenderMultiselectOption=function(e){return y.createElement("span",{id:e.id,"aria-hidden":"true",className:i._classNames.dropdownOptionText},e.text)},i._onRenderItemLabel=function(e){var t=i.props.onRenderOption;return(void 0===t?i._onRenderMultiselectOption:t)(e,i._onRenderMultiselectOption)},i._onPositioned=function(e){i._focusZone.current&&i._requestAnimationFrame((function(){var e=i.props.hoisted.selectedIndices;if(i._focusZone.current)if(!i._hasBeenPositioned&&e&&e[0]&&!i.props.options[e[0]].disabled){var t=(0,$.Y)().getElementById("".concat(i._id,"-list").concat(e[0]));t&&i._focusZone.current.focusElement(t),i._hasBeenPositioned=!0}else i._focusZone.current.focus()})),i.state.calloutRenderEdge&&i.state.calloutRenderEdge===e.targetEdge||i.setState({calloutRenderEdge:e.targetEdge})},i._onItemClick=function(e){return function(t){e.disabled||(i.setSelectedIndex(t,e.index),i.props.multiSelect||i.setState({isOpen:!1}))}},i._onScroll=function(){var e=(0,Oe.k_)(i.context);i._isScrollIdle||void 0===i._scrollIdleTimeoutId?i._isScrollIdle=!1:(e.clearTimeout(i._scrollIdleTimeoutId),i._scrollIdleTimeoutId=void 0),i._scrollIdleTimeoutId=e.setTimeout((function(){i._isScrollIdle=!0}),i._scrollIdleDelay)},i._onMouseItemLeave=function(e,t){if(!i._shouldIgnoreMouseEvent()&&i._host.current)if(i._host.current.setActive)try{i._host.current.setActive()}catch(e){}else i._host.current.focus()},i._onDismiss=function(){i.setState({isOpen:!1})},i._onDropdownBlur=function(e){i._isDisabled()||i.state.isOpen||(i.setState({hasFocus:!1}),i.props.onBlur&&i.props.onBlur(e))},i._onDropdownKeyDown=function(e){if(!i._isDisabled()&&(i._lastKeyDownWasAltOrMeta=i._isAltOrMeta(e),!i.props.onKeyDown||(i.props.onKeyDown(e),!e.defaultPrevented))){var t,n=i.props.hoisted.selectedIndices.length?i.props.hoisted.selectedIndices[0]:-1,o=e.altKey||e.metaKey,r=i.state.isOpen;switch(e.which){case j.c.enter:i.setState({isOpen:!r});break;case j.c.escape:if(!r)return;i.setState({isOpen:!1});break;case j.c.up:if(o){if(r){i.setState({isOpen:!1});break}return}i.props.multiSelect?i.setState({isOpen:!0}):i._isDisabled()||(t=i._moveIndex(e,-1,n-1,n));break;case j.c.down:o&&(e.stopPropagation(),e.preventDefault()),o&&!r||i.props.multiSelect?i.setState({isOpen:!0}):i._isDisabled()||(t=i._moveIndex(e,1,n+1,n));break;case j.c.home:i.props.multiSelect||(t=i._moveIndex(e,1,0,n));break;case j.c.end:i.props.multiSelect||(t=i._moveIndex(e,-1,i.props.options.length-1,n));break;case j.c.space:break;default:return}t!==n&&(e.stopPropagation(),e.preventDefault())}},i._onDropdownKeyUp=function(e){if(!i._isDisabled()){var t=i._shouldHandleKeyUp(e),n=i.state.isOpen;i.props.onKeyUp&&(i.props.onKeyUp(e),e.defaultPrevented)||(e.which===j.c.space?(i.setState({isOpen:!n}),e.stopPropagation(),e.preventDefault()):t&&n&&i.setState({isOpen:!1}))}},i._onZoneKeyDown=function(e){var t,n,o;i._lastKeyDownWasAltOrMeta=i._isAltOrMeta(e);var r=e.altKey||e.metaKey;switch(e.which){case j.c.up:r?i.setState({isOpen:!1}):i._host.current&&(o=(0,J.dm)(i._host.current,i._host.current.lastChild,!0));break;case j.c.home:case j.c.end:case j.c.pageUp:case j.c.pageDown:break;case j.c.down:!r&&i._host.current&&(o=(0,J.j5)(i._host.current,i._host.current.firstChild,!0));break;case j.c.escape:i.setState({isOpen:!1});break;case j.c.tab:i.setState({isOpen:!1});var a=(0,$.Y)();a&&(e.shiftKey?null===(t=(0,J.yv)(a.body,i._dropDown.current,!1,!1,!0,!0))||void 0===t||t.focus():null===(n=(0,J.eX)(a.body,i._dropDown.current,!1,!1,!0,!0))||void 0===n||n.focus());break;default:return}o&&o.focus(),e.stopPropagation(),e.preventDefault()},i._onZoneKeyUp=function(e){i._shouldHandleKeyUp(e)&&i.state.isOpen&&(i.setState({isOpen:!1}),e.preventDefault())},i._onDropdownClick=function(e){if(!i.props.onClick||(i.props.onClick(e),!e.defaultPrevented)){var t=i.state.isOpen;i._isDisabled()||i._shouldOpenOnFocus()||i.setState({isOpen:!t}),i._isFocusedByClick=!1}},i._onDropdownMouseDown=function(){i._isFocusedByClick=!0},i._onFocus=function(e){if(!i._isDisabled()){i.props.onFocus&&i.props.onFocus(e);var t={hasFocus:!0};i._shouldOpenOnFocus()&&(t.isOpen=!0),i.setState(t)}},i._isDisabled=function(){var e=i.props.disabled,t=i.props.isDisabled;return void 0===e&&(e=t),e},i._onRenderLabel=function(e){var t=e.label,n=e.required,o=e.disabled,r=i._classNames.subComponentStyles?i._classNames.subComponentStyles.label:void 0;return t?y.createElement(_e.J,{className:i._classNames.label,id:i._labelId,required:n,styles:r,disabled:o},t):null},(0,Z.f)(i);t.multiSelect,t.selectedKey,t.selectedKeys,t.defaultSelectedKey,t.defaultSelectedKeys;var r=t.options;return i._id=t.id||(0,Y.O)("Dropdown"),i._labelId=i._id+"-label",i._listId=i._id+"-list",i._optionId=i._id+"-option",i._isScrollIdle=!0,i._hasBeenPositioned=!1,i._sizePosCache.updateOptions(r),i.state={isOpen:!1,hasFocus:!1,calloutRenderEdge:void 0},i}return(0,U.__extends)(t,e),Object.defineProperty(t.prototype,"selectedOptions",{get:function(){var e=this.props;return dt(e.options,e.hoisted.selectedIndices)},enumerable:!1,configurable:!0}),t.prototype.componentWillUnmount=function(){clearTimeout(this._scrollIdleTimeoutId)},t.prototype.componentDidUpdate=function(e,t){!0===t.isOpen&&!1===this.state.isOpen&&(this._gotMouseMove=!1,this._hasBeenPositioned=!1,this.props.onDismiss&&this.props.onDismiss())},t.prototype.render=function(){var e=this._id,t=this.props,n=t.className,o=t.label,i=t.options,r=t.ariaLabel,a=t.required,s=t.errorMessage,l=t.styles,c=t.theme,d=t.panelProps,p=t.calloutProps,u=t.onRenderTitle,h=void 0===u?this._getTitle:u,m=t.onRenderContainer,g=void 0===m?this._onRenderContainer:m,f=t.onRenderCaretDown,b=void 0===f?this._onRenderCaretDown:f,_=t.onRenderLabel,C=void 0===_?this._onRenderLabel:_,v=t.onRenderItem,x=void 0===v?this._onRenderItem:v,S=t.hoisted.selectedIndices,k=this.state,P=k.isOpen,E=k.calloutRenderEdge,T=k.hasFocus,w=t.onRenderPlaceholder||t.onRenderPlaceHolder||this._getPlaceholder;i!==this._sizePosCache.cachedOptions&&this._sizePosCache.updateOptions(i);var I=dt(i,S),D=(0,X.G1)(t,X.JM),R=this._isDisabled(),A=e+"-errorMessage";this._classNames=Pt(l,{theme:c,className:n,hasError:!!(s&&s.length>0),hasLabel:!!o,isOpen:P,required:a,disabled:R,isRenderingPlaceholder:!I.length,panelClassName:d?d.className:void 0,calloutClassName:p?p.className:void 0,calloutRenderEdge:E});var O=!!s&&s.length>0;return y.createElement("div",{className:this._classNames.root,ref:this.props.hoisted.rootRef,"aria-owns":P?this._listId:void 0},C(this.props,this._onRenderLabel),y.createElement("div",(0,U.__assign)({"data-is-focusable":!R,"data-ktp-target":!0,ref:this._dropDown,id:e,tabIndex:R?-1:0,role:"combobox","aria-haspopup":"listbox","aria-expanded":P?"true":"false","aria-label":r,"aria-labelledby":o&&!r?(0,ee._)(this._labelId,this._optionId):void 0,"aria-describedby":O?this._id+"-errorMessage":void 0,"aria-required":a,"aria-disabled":R,"aria-invalid":O,"aria-controls":P?this._listId:void 0},D,{className:this._classNames.dropdown,onBlur:this._onDropdownBlur,onKeyDown:this._onDropdownKeyDown,onKeyUp:this._onDropdownKeyUp,onClick:this._onDropdownClick,onMouseDown:this._onDropdownMouseDown,onFocus:this._onFocus}),y.createElement("span",{id:this._optionId,className:this._classNames.title,"aria-live":T?"polite":void 0,"aria-atomic":!!T||void 0},I.length?h(I,this._onRenderTitle):w(t,this._onRenderPlaceholder)),y.createElement("span",{className:this._classNames.caretDownWrapper},b(t,this._onRenderCaretDown))),P&&g((0,U.__assign)((0,U.__assign)({},t),{onDismiss:this._onDismiss,onRenderItem:x}),this._onRenderContainer),O&&y.createElement("div",{role:"alert",id:A,className:this._classNames.errorMessage},s))},t.prototype.focus=function(e){this._dropDown.current&&(this._dropDown.current.focus(),e&&this.setState({isOpen:!0}))},t.prototype.setSelectedIndex=function(e,t){var n=this.props,o=n.options,i=n.selectedKey,r=n.selectedKeys,a=n.multiSelect,s=n.notifyOnReselect,l=n.hoisted.selectedIndices,c=void 0===l?[]:l,d=!!c&&c.indexOf(t)>-1,p=[];if(t=Math.max(0,Math.min(o.length-1,t)),void 0===i&&void 0===r){if(a||s||t!==c[0]){if(a)if(p=c?this._copyArray(c):[],d){var u=p.indexOf(t);u>-1&&p.splice(u,1)}else p.push(t);else p=[t];e.persist(),this.props.hoisted.setSelectedIndices(p),this._onChange(e,o,t,d,a)}}else this._onChange(e,o,t,d,a)},t.prototype._copyArray=function(e){for(var t=[],n=0,o=e;n<o.length;n++){var i=o[n];t.push(i)}return t},t.prototype._moveIndex=function(e,t,n,o){var i=this.props.options;if(o===n||0===i.length)return o;n>=i.length?n=0:n<0&&(n=i.length-1);for(var r=0;i[n].itemType===G.Header||i[n].itemType===G.Divider||i[n].disabled;){if(r>=i.length)return o;n+t<0?n=i.length:n+t>=i.length&&(n=-1),n+=t,r++}return this.setSelectedIndex(e,n),n},t.prototype._renderFocusableList=function(e){var t=e.onRenderList,n=void 0===t?this._onRenderList:t,o=e.label,i=e.ariaLabel,r=e.multiSelect;return y.createElement("div",{className:this._classNames.dropdownItemsWrapper,onKeyDown:this._onZoneKeyDown,onKeyUp:this._onZoneKeyUp,ref:this._host,tabIndex:0},y.createElement(fe.R,{ref:this._focusZone,direction:be.E.vertical,id:this._listId,className:this._classNames.dropdownItems,role:"listbox","aria-label":i,"aria-labelledby":o&&!i?this._labelId:void 0,"aria-multiselectable":r},n(e,this._onRenderList)))},t.prototype._renderSeparator=function(e){var t=e.index,n=e.key,o=e.hidden?this._classNames.dropdownDividerHidden:this._classNames.dropdownDivider;return t>0?y.createElement("div",{role:"presentation",key:n,className:o}):null},t.prototype._renderHeader=function(e){var t=this.props.onRenderOption,n=void 0===t?this._onRenderOption:t,o=e.key,i=e.id,r=e.hidden?this._classNames.dropdownItemHeaderHidden:this._classNames.dropdownItemHeader;return y.createElement("div",{id:i,key:o,className:r},n(e,this._onRenderOption))},t.prototype._onItemMouseEnter=function(e,t){this._shouldIgnoreMouseEvent()||t.currentTarget.focus()},t.prototype._onItemMouseMove=function(e,t){var n=(0,Oe.LW)(this.context),o=t.currentTarget;this._gotMouseMove=!0,this._isScrollIdle&&n.activeElement!==o&&o.focus()},t.prototype._shouldIgnoreMouseEvent=function(){return!this._isScrollIdle||!this._gotMouseMove},t.prototype._isAltOrMeta=function(e){return e.which===j.c.alt||"Meta"===e.key},t.prototype._shouldHandleKeyUp=function(e){var t=this._lastKeyDownWasAltOrMeta&&this._isAltOrMeta(e);return this._lastKeyDownWasAltOrMeta=!1,!!t&&!((0,te.c)()||(0,ne.u)())},t.prototype._shouldOpenOnFocus=function(){var e=this.state.hasFocus,t=this.props.openOnKeyboardFocus;return!this._isFocusedByClick&&!0===t&&!e},t.defaultProps={options:[]},t.contextType=Ae._0,t}(y.Component),Mt=n(76341),Nt={root:"ms-Dropdown-container",label:"ms-Dropdown-label",dropdown:"ms-Dropdown",title:"ms-Dropdown-title",caretDownWrapper:"ms-Dropdown-caretDownWrapper",caretDown:"ms-Dropdown-caretDown",callout:"ms-Dropdown-callout",panel:"ms-Dropdown-panel",dropdownItems:"ms-Dropdown-items",dropdownItem:"ms-Dropdown-item",dropdownDivider:"ms-Dropdown-divider",dropdownOptionText:"ms-Dropdown-optionText",dropdownItemHeader:"ms-Dropdown-header",titleIsPlaceHolder:"ms-Dropdown-titleIsPlaceHolder",titleHasError:"ms-Dropdown-title--hasError"},Bt=((wt={})["".concat(le.up,", ").concat(le.hT.replace("@media ",""))]=(0,U.__assign)({},(0,le.Qg)()),wt),Ft={selectors:(0,U.__assign)((It={},It[le.up]=(Dt={backgroundColor:"Highlight",borderColor:"Highlight",color:"HighlightText"},Dt[".".concat(bt.Y2," &:focus:after")]={borderColor:"HighlightText"},Dt),It[".ms-Checkbox-checkbox"]=(Rt={},Rt[le.up]={borderColor:"HighlightText"},Rt),It),Bt)},Gt={selectors:(At={},At[le.up]={borderColor:"Highlight"},At)},Lt=(0,le.L6)(0,le.O7),Ht=(0,z.I)(Tt,(function(e){var t,n,o,i,r,a,s,l,c,d,p,u,h=e.theme,m=e.hasError,g=e.hasLabel,f=e.className,b=e.isOpen,y=e.disabled,_=e.required,C=e.isRenderingPlaceholder,v=e.panelClassName,x=e.calloutClassName,S=e.calloutRenderEdge;if(!h)throw new Error("theme is undefined or null in base Dropdown getStyles function.");var k=(0,le.Km)(Nt,h),P=h.palette,E=h.semanticColors,T=h.effects,w=h.fonts,I={color:E.menuItemTextHovered},D={color:E.menuItemText},R={borderColor:E.errorText},A=[k.dropdownItem,{backgroundColor:"transparent",boxSizing:"border-box",cursor:"pointer",display:"flex",alignItems:"center",padding:"0 8px",width:"100%",minHeight:36,lineHeight:20,height:0,position:"relative",border:"1px solid transparent",borderRadius:0,wordWrap:"break-word",overflowWrap:"break-word",textAlign:"left",".ms-Button-flexContainer":{width:"100%"}}],O=[k.dropdownItemHeader,(0,U.__assign)((0,U.__assign)({},w.medium),{fontWeight:le.BO.semibold,color:E.menuHeader,background:"none",backgroundColor:"transparent",border:"none",height:36,lineHeight:36,cursor:"default",padding:"0 8px",userSelect:"none",textAlign:"left",selectors:(t={},t[le.up]=(0,U.__assign)({color:"GrayText"},(0,le.Qg)()),t)})],M=E.menuItemBackgroundPressed,N=function(e){var t,n;return void 0===e&&(e=!1),{selectors:(t={"&:hover":[{color:E.menuItemTextHovered,backgroundColor:e?M:E.menuItemBackgroundHovered},Ft],"&.is-multi-select:hover":[{backgroundColor:e?M:"transparent"},Ft],"&:active:hover":[{color:E.menuItemTextHovered,backgroundColor:e?E.menuItemBackgroundHovered:E.menuItemBackgroundPressed},Ft]},t[".".concat(bt.Y2," &:focus:after, :host(.").concat(bt.Y2,") &:focus:after")]=(n={left:0,top:0,bottom:0,right:0},n[le.up]={inset:"2px"},n),t[le.up]={border:"none"},t)}},B=(0,U.__spreadArray)((0,U.__spreadArray)([],A,!0),[{backgroundColor:M,color:E.menuItemTextHovered},N(!0),Ft],!1),F=(0,U.__spreadArray)((0,U.__spreadArray)([],A,!0),[{color:E.disabledText,cursor:"default",selectors:(n={},n[le.up]={color:"GrayText",border:"none"},n)}],!1),G=S===Mt.x.bottom?"".concat(T.roundedCorner2," ").concat(T.roundedCorner2," 0 0"):"0 0 ".concat(T.roundedCorner2," ").concat(T.roundedCorner2),L=S===Mt.x.bottom?"0 0 ".concat(T.roundedCorner2," ").concat(T.roundedCorner2):"".concat(T.roundedCorner2," ").concat(T.roundedCorner2," 0 0");return{root:[k.root,f],label:k.label,dropdown:[k.dropdown,le.S8,w.medium,{color:E.menuItemText,borderColor:E.focusBorder,position:"relative",outline:0,userSelect:"none",selectors:(o={},o["&:hover ."+k.title]=[!y&&I,{borderColor:b?P.neutralSecondary:P.neutralPrimary},Gt],o["&:focus ."+k.title]=[!y&&I,{selectors:(i={},i[le.up]={color:"Highlight"},i)}],o["&:focus:after"]=[{pointerEvents:"none",content:"''",position:"absolute",boxSizing:"border-box",top:"0px",left:"0px",width:"100%",height:"100%",border:y?"none":"2px solid ".concat(P.themePrimary),borderRadius:"2px",selectors:(r={},r[le.up]={color:"Highlight"},r)}],o["&:active ."+k.title]=[!y&&I,{borderColor:P.themePrimary},Gt],o["&:hover ."+k.caretDown]=!y&&D,o["&:focus ."+k.caretDown]=[!y&&D,{selectors:(a={},a[le.up]={color:"Highlight"},a)}],o["&:active ."+k.caretDown]=!y&&D,o["&:hover ."+k.titleIsPlaceHolder]=!y&&D,o["&:focus ."+k.titleIsPlaceHolder]=!y&&D,o["&:active ."+k.titleIsPlaceHolder]=!y&&D,o["&:hover ."+k.titleHasError]=R,o["&:active ."+k.titleHasError]=R,o)},b&&"is-open",y&&"is-disabled",_&&"is-required",_&&!g&&{selectors:(s={":before":{content:"'*'",color:E.errorText,position:"absolute",top:-5,right:-10}},s[le.up]={selectors:{":after":{right:-14}}},s)}],title:[k.title,le.S8,{backgroundColor:E.inputBackground,borderWidth:1,borderStyle:"solid",borderColor:E.inputBorder,borderRadius:b?G:T.roundedCorner2,cursor:"pointer",display:"block",height:32,lineHeight:30,padding:"0 28px 0 8px",position:"relative",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},C&&[k.titleIsPlaceHolder,{color:E.inputPlaceholderText}],m&&[k.titleHasError,R],y&&{backgroundColor:E.disabledBackground,border:"none",color:E.disabledText,cursor:"default",selectors:(l={},l[le.up]=(0,U.__assign)({border:"1px solid GrayText",color:"GrayText",backgroundColor:"Window"},(0,le.Qg)()),l)}],caretDownWrapper:[k.caretDownWrapper,{height:32,lineHeight:30,paddingTop:1,position:"absolute",right:8,top:0},!y&&{cursor:"pointer"}],caretDown:[k.caretDown,{color:P.neutralSecondary,fontSize:w.small.fontSize,pointerEvents:"none"},y&&{color:E.disabledText,selectors:(c={},c[le.up]=(0,U.__assign)({color:"GrayText"},(0,le.Qg)()),c)}],errorMessage:(0,U.__assign)((0,U.__assign)({color:E.errorText},h.fonts.small),{paddingTop:5}),callout:[k.callout,{boxShadow:T.elevation8,borderRadius:L,selectors:(d={},d[".ms-Callout-main"]={borderRadius:L},d)},x],dropdownItemsWrapper:{selectors:{"&:focus":{outline:0}}},dropdownItems:[k.dropdownItems,{display:"block"}],dropdownItem:(0,U.__spreadArray)((0,U.__spreadArray)([],A,!0),[N()],!1),dropdownItemSelected:B,dropdownItemDisabled:F,dropdownItemSelectedAndDisabled:[B,F,{backgroundColor:"transparent"}],dropdownItemHidden:(0,U.__spreadArray)((0,U.__spreadArray)([],A,!0),[{display:"none"}],!1),dropdownDivider:[k.dropdownDivider,{height:1,backgroundColor:E.bodyDivider}],dropdownDividerHidden:[k.dropdownDivider,{display:"none"}],dropdownOptionText:[k.dropdownOptionText,{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",minWidth:0,maxWidth:"100%",wordWrap:"break-word",overflowWrap:"break-word",margin:"1px"}],dropdownItemHeader:O,dropdownItemHeaderHidden:(0,U.__spreadArray)((0,U.__spreadArray)([],O,!0),[{display:"none"}],!1),subComponentStyles:{label:{root:{display:"inline-block"}},multiSelectItem:{root:{padding:0},label:{alignSelf:"stretch",padding:"0 8px",width:"100%"},input:{selectors:(p={},p[".".concat(bt.Y2," &:focus + label::before, :host(.").concat(bt.Y2,") &:focus + label::before")]={outlineOffset:"0px"},p)}},panel:{root:[v],main:{selectors:(u={},u[Lt]={width:272},u)},contentInner:{padding:"0 0 20px"}}}}}),void 0,{scope:"Dropdown"});Ht.displayName="Dropdown";var Wt=n(89729),zt=n(56924),Ut=n(22165),Vt=n(64020),Qt=n(47487),qt=n(97107),Kt=n(38459),$t=n(97808),jt=n(66166),Jt=n(58651);const Zt=[H.ck.File,H.ck.Event,H.ck.Message],Yt={settings:{hostAppId:"Word_Online",hostAppName:"Word",hostAppPlatform:"Web",hostAppScenario:"AppChatCopilot",hostDefaultLocale:"en-US",isDogfoodEnvironment:!0,appVersion:"1.0.0",customizedEmptyECCSuggestionsString:"I can't find that file right now. Check the name of the file, or try again in a bit."},telemLogger:{logError:e=>{Jt.log("CIQ Error Log: ",e)}},transformFileMenuTitle:"Suggestions",transformFilePlaceholderText:"Keep typing to search for your files",entitiesSupported:Zt,isExpandedECCEnabled:!0,ciqPlaceholderText:"Start Typing to search",featureFlags:{enableAppGptsInCiq:!0,enableAppPluginsInCiq:!0,enableTopicECC:!0}},Xt={headerText:"Workspace",descriptionText:"Upload Files to Ground and Interact",freImagePath:n(84743),hideGetStartedButton:!1,getStartedButtonText:"Upload Demo Files"},en=()=>{const e={...$t.Xt};return e.list=[],e.headerDescription="",e.addAnotherEntityProps&&e.addAnotherEntityProps.editorConfiguration&&(e.addAnotherEntityProps.editorConfiguration.entitiesEnabled=Zt),e},tn="Create a Synopsis of the Selected Files",nn="Add Synopsis to the Document",on="What are the key points from the meeting and who participated in it?",rn="Create a table using the data in the .xls",an="Select the Table in the Word Document and Click here to bring it to chat",sn="Select the Excel File and deselect rest",ln="Go to the end of the document. Use the insert button to add the chart",cn='Select one or more Word or PowerPoint files and type "Summarize"',dn="Ask Copilot to Regenerate a Longer Summary by clicking the icon next to the Insert button in the Response Card",pn="Pin the longer summary for later use by clicking the Pin icon in the Response Card",un="Explore Questions to Ask by clicking the Light Bulb icon",hn="Demo Mode: ",mn=[{name:tn,isALSignalRequired:!0},{name:nn,isALSignalRequired:!1},{name:on,isALSignalRequired:!0},{name:sn,isALSignalRequired:!1},{name:rn,isALSignalRequired:!0},{name:"Convert this table to a chart",isALSignalRequired:!0},{name:ln,isALSignalRequired:!1},{name:cn,isALSignalRequired:!1},{name:dn,isALSignalRequired:!1},{name:pn,isALSignalRequired:!1},{name:an,isALSignalRequired:!0},{name:un,isALSignalRequired:!1},{name:"END OF DEMO. Please continue to use Copilot Workspace",isALSignalRequired:!1}],gn=[{key:"Shorter",value:"Make it shorter"},{key:"Longer",value:"Make it longer"},{key:"Simpler",value:"Make it simpler"},{key:"Casual",value:"Make it casual"},{key:"Professional",value:"Make it professional"},{key:"Rewrite Content",value:""}],fn=[{key:"generateSummary",value:"Generate Summary"},{key:"generateTable",value:"Generate Table"},{key:"rewriteContent",value:"Rewrite Content"},{key:"generateChartVisualisation",value:"Generate Data Visualization Chart"}],bn=["https://microsoft-my.sharepoint-df.com/:u:/p/sanjibb/EfzcGItZCnJGvGsONGv2ONEBdjaFVDNpyGq31UMsQ6QFMg?e=ilHwGW","https://microsoft-my.sharepoint-df.com/:u:/p/sanjibb/EUOL4IVChQhJlJQztaeyob0B-jELHpXYVFfjh4lOsG4Ubg?e=pj4d5k","https://microsoft-my.sharepoint-df.com/:x:/p/sanjibb/ERMy4YzILZVJvvDmPiI2dVsBSqoR0CJb60d5He9bFficXQ?e=yTQR0d","https://microsoft-my.sharepoint-df.com/:w:/p/sanjibb/EQsn2KTmyWZOn_aX1q2DC_YBRuFVeBZsmymDajU92o12cA?e=u4L8XS","https://microsoft-my.sharepoint-df.com/:p:/p/sanjibb/EbgJpYyyNW1KquSQ6_nqxOYBdE0FtUK_AQHIAcmSNFcNig?e=6QWJC5","https://microsoft-my.sharepoint-df.com/:w:/p/sanjibb/EeQ0GcBCnxtPmsO1ERm7szABLt3-fdFdX0ykbwqLU-k9gA?e=hKualA","https://microsoft-my.sharepoint-df.com/:w:/p/sanjibb/EU-V6hSBkaJGl3zlg1pZv3gBX1-PMpJE_4NQWFu23K4NZQ?e=vmgeeI"],yn=[{checked:!0,url:"https://microsoft-my.sharepoint-df.com/:u:/p/sanjibb/EfzcGItZCnJGvGsONGv2ONEBdjaFVDNpyGq31UMsQ6QFMg?e=ilHwGW",text:"Strategic Focus on Mobile.eml",id:"1",iconUrl:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/brand-icons/product/svg/outlook_24x1.svg"},{checked:!0,url:"https://microsoft-my.sharepoint-df.com/:t:/p/sanjibb/EX7JRovo7o5PpHstG8AOhjIBUXgLZnZ_vYMmHwosIbQarg?e=KwaZwh",text:"Mobile Revolution 2010 Meeting",id:"2",iconUrl:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/brand-icons/product/svg/teams_24x1.svg"},{checked:!0,url:"https://microsoft-my.sharepoint-df.com/:x:/p/sanjibb/ERMy4YzILZVJvvDmPiI2dVsBSqoR0CJb60d5He9bFficXQ?e=yTQR0d",text:"Mobile Market share.xlsx",id:"3",iconUrl:jt.GB.get("xlsx")||""},{checked:!0,url:"https://microsoft-my.sharepoint-df.com/:w:/p/sanjibb/EQsn2KTmyWZOn_aX1q2DC_YBRuFVeBZsmymDajU92o12cA?e=u4L8XS",text:"The Introduction to Mobile.docx",id:"4",iconUrl:jt.GB.get("docx")||""},{checked:!0,url:"https://microsoft-my.sharepoint-df.com/:p:/p/sanjibb/EbgJpYyyNW1KquSQ6_nqxOYBdE0FtUK_AQHIAcmSNFcNig?e=6QWJC5",text:"The Mobile Industry in 2020.ppt",id:"5",iconUrl:jt.GB.get("pptx")||""},{checked:!0,url:"https://microsoft-my.sharepoint-df.com/:w:/p/sanjibb/EeQ0GcBCnxtPmsO1ERm7szABLt3-fdFdX0ykbwqLU-k9gA?e=hKualA",text:"Microsoft's Unfulfilled aspiration",id:"6",iconUrl:jt.GB.get("docx")||""},{checked:!0,url:"https://microsoft-my.sharepoint-df.com/:w:/p/sanjibb/EU-V6hSBkaJGl3zlg1pZv3gBX1-PMpJE_4NQWFu23K4NZQ?e=vmgeeI",text:"History of Mobile Phones",id:"7",iconUrl:jt.GB.get("docx")||""}];var _n;!function(e){e.suggestion="suggestion",e.skillName="skillName",e.operations="operations"}(_n||(_n={}));var Cn,vn,xn,Sn,kn,Pn,En,Tn=n(19447),wn=n(90006),In=n(99951),Dn=n(51229),Rn=n(91150),An=n(43688),On=n(42262),Mn=n(66353);!function(e){e[e.TextChatDavinci002=0]="TextChatDavinci002",e[e.TextDavinci001=1]="TextDavinci001",e[e.TextDavinci002=2]="TextDavinci002",e[e.TextDavinci003=3]="TextDavinci003",e[e.TextCurie001=4]="TextCurie001",e[e.TextBabbage001=5]="TextBabbage001",e[e.TextAda001=6]="TextAda001",e[e.CodeDavinci002=7]="CodeDavinci002",e[e.CodeCushman001=8]="CodeCushman001",e[e.Custom=9]="Custom",e[e.TextSimilarityAda001=10]="TextSimilarityAda001",e[e.TextSimilarityBabbage001=11]="TextSimilarityBabbage001",e[e.TextSimilarityCurie001=12]="TextSimilarityCurie001",e[e.TextSimilarityDavinci001=13]="TextSimilarityDavinci001",e[e.TextSearchAdaDoc001=14]="TextSearchAdaDoc001",e[e.TextSearchAdaQuery001=15]="TextSearchAdaQuery001",e[e.TextSearchBabbageDoc001=16]="TextSearchBabbageDoc001",e[e.TextSearchBabbageQuery001=17]="TextSearchBabbageQuery001",e[e.TextSearchCurieDoc001=18]="TextSearchCurieDoc001",e[e.TextSearchCurieQuery001=19]="TextSearchCurieQuery001",e[e.TextSearchDavinciDoc001=20]="TextSearchDavinciDoc001",e[e.TextSearchDavinciQuery001=21]="TextSearchDavinciQuery001",e[e.CodeSearchAdaCode001=22]="CodeSearchAdaCode001",e[e.CodeSearchAdaText001=23]="CodeSearchAdaText001",e[e.CodeSearchBabbageCode001=24]="CodeSearchBabbageCode001",e[e.CodeSearchBabbageText001=25]="CodeSearchBabbageText001",e[e.TextEmbeddingAda002=26]="TextEmbeddingAda002",e[e.Gpt35Turbo=27]="Gpt35Turbo",e[e.Gpt4_32k=28]="Gpt4_32k",e[e.Gpt4_0203=29]="Gpt4_0203",e[e.Gpt4_0314_4k=30]="Gpt4_0314_4k",e[e.Gpt4_0314_32k=31]="Gpt4_0314_32k",e[e.Gpt4_DV3_FP_Variant=32]="Gpt4_DV3_FP_Variant",e[e.Gpt4_DV3_FP=33]="Gpt4_DV3_FP",e[e.Gpt4_PPO_FP_Variant=34]="Gpt4_PPO_FP_Variant",e[e.Gpt4_PPO_FP=35]="Gpt4_PPO_FP",e[e.GptV=36]="GptV",e[e.Gpt35Turbo16k=37]="Gpt35Turbo16k",e[e.Gpt35TurboInstruct=38]="Gpt35TurboInstruct",e[e.Gpt4Turbo=39]="Gpt4Turbo",e[e.Gpt4=40]="Gpt4",e[e.Gpt4Turbo_0125=41]="Gpt4Turbo_0125",e[e.Gpt35Turbo_1106=42]="Gpt35Turbo_1106",e[e.Gpt35Turbo_0125=43]="Gpt35Turbo_0125",e[e.Gpt35Turbo_Deucalion=44]="Gpt35Turbo_Deucalion",e[e.Gpt4_0613=45]="Gpt4_0613",e[e.TextEmbedding3Small=46]="TextEmbedding3Small",e[e.TextEmbedding3Large=47]="TextEmbedding3Large",e[e.Gpt35Turbo_0613_EditorFineTuned_Japanese=48]="Gpt35Turbo_0613_EditorFineTuned_Japanese",e[e.TextEmbeddingAda002_Substrate=49]="TextEmbeddingAda002_Substrate",e[e.Gpt35Turbo_0125_AOAI=50]="Gpt35Turbo_0125_AOAI",e[e.Gpt4Turbo_0409=51]="Gpt4Turbo_0409",e[e.Gpt4o_0513=52]="Gpt4o_0513",e[e.Gpt4o_AOAI=53]="Gpt4o_AOAI",e[e.Gpt4o_Vision_0513=54]="Gpt4o_Vision_0513",e[e.Gpt4o_Mini=55]="Gpt4o_Mini",e[e.Gpt35Turbo_0125_EditorFineTuned_Japanese=56]="Gpt35Turbo_0125_EditorFineTuned_Japanese",e[e.Gpt4o_0806=57]="Gpt4o_0806",e[e.Gpt4o_Realtime=58]="Gpt4o_Realtime",e[e.GptO1=59]="GptO1",e[e.Dall_e_3=60]="Dall_e_3",e[e.Gpt4o_Canvas=61]="Gpt4o_Canvas",e[e.Gpt4o_Mini_PPT_V4_FT=62]="Gpt4o_Mini_PPT_V4_FT",e[e.Gpt4o_Mini_PPT_V3_FT=63]="Gpt4o_Mini_PPT_V3_FT",e[e.GptO1GA=64]="GptO1GA",e[e.Gpt4o_1120=65]="Gpt4o_1120",e[e.Deepseek_R1_Distill_Qwen_32b=66]="Deepseek_R1_Distill_Qwen_32b",e[e.Gpt_O3_Mini=67]="Gpt_O3_Mini",e[e.Gpt_O1_Mini=68]="Gpt_O1_Mini",e[e.Deepseek_R1_Full=69]="Deepseek_R1_Full",e[e.DeepResearch=70]="DeepResearch",e[e.DeepResearch_Thrall=71]="DeepResearch_Thrall",e[e.GptO1_AOAI=72]="GptO1_AOAI",e[e.GPT45_Preview=73]="GPT45_Preview",e[e.Gpt4o_Realtime_1217=74]="Gpt4o_Realtime_1217",e[e.Gpt4o_Mini_NLXFineTuned_Japanese=75]="Gpt4o_Mini_NLXFineTuned_Japanese",e[e.Diceberry=76]="Diceberry",e[e.Diceberry_01=77]="Diceberry_01",e[e.DevSolutionGenGPT4oMiniSwecFt=78]="DevSolutionGenGPT4oMiniSwecFt",e[e.GPT41=79]="GPT41",e[e.GPT41_LongCo_0414=80]="GPT41_LongCo_0414",e[e.GPT41_ShortCo_0414=81]="GPT41_ShortCo_0414",e[e.Gpt_O3=82]="Gpt_O3",e[e.Gpt_O4_Mini=83]="Gpt_O4_Mini",e[e.GPT41_Mini_0414=84]="GPT41_Mini_0414",e[e.GPT41_Nano_0414=85]="GPT41_Nano_0414",e[e.GPT41_AOAI=86]="GPT41_AOAI",e[e.SolutionGenGPT4oMiniAOAIFt=87]="SolutionGenGPT4oMiniAOAIFt",e[e.GPT4o_gg=88]="GPT4o_gg",e[e.Gpt4oMini_SolutionGenAP_Ft_V1=89]="Gpt4oMini_SolutionGenAP_Ft_V1",e[e.Sora=90]="Sora",e[e.SolutionGenGPT4oMiniAOAIFt_dogfood=91]="SolutionGenGPT4oMiniAOAIFt_dogfood",e[e.Gpt_O3_Pro=92]="Gpt_O3_Pro",e[e.Gpt4o_Realtime_0528=93]="Gpt4o_Realtime_0528",e[e.Gpt4o_chatgpt_imagegen_convo2im=94]="Gpt4o_chatgpt_imagegen_convo2im",e[e.Gpt5_Chat=95]="Gpt5_Chat",e[e.Gpt5_Reasoning=96]="Gpt5_Reasoning",e[e.Gpt5_Auto_Switcher=97]="Gpt5_Auto_Switcher",e[e.GPT5_Chat_202508_CAPI=98]="GPT5_Chat_202508_CAPI",e[e.Gpt5_Chat_Mini=99]="Gpt5_Chat_Mini",e[e.Gpt5_Mini=100]="Gpt5_Mini",e[e.Gpt5_Nano=101]="Gpt5_Nano",e[e.Phi2=10001]="Phi2",e[e.Mixtral_8x7b_Instruct_V01=10002]="Mixtral_8x7b_Instruct_V01",e[e.Mistral_7b_Instruct_V02=10003]="Mistral_7b_Instruct_V02",e[e.Mistral_7b_v01=10004]="Mistral_7b_v01",e[e.Phi3Mini=10005]="Phi3Mini",e[e.Phi3Medium=10006]="Phi3Medium",e[e.Phi3Small=10007]="Phi3Small",e[e.Phi3Vision=10008]="Phi3Vision",e[e.Phi3Small_PPT=10009]="Phi3Small_PPT",e[e.Phi3Vision_PPT=10010]="Phi3Vision_PPT",e[e.Phi35Mini=10011]="Phi35Mini",e[e.Phi35Moe=10012]="Phi35Moe",e[e.Phi3VisionImageAction=10013]="Phi3VisionImageAction",e[e.Phi4=10014]="Phi4",e[e.Phi4Mini=10015]="Phi4Mini",e[e.Phi4MultiModal=10016]="Phi4MultiModal",e[e.DevGPT4oMini01SwecMlFt=10017]="DevGPT4oMini01SwecMlFt",e[e.DevSwecMlSlot13Ft=10018]="DevSwecMlSlot13Ft",e[e.Phi3Small_Doc2PPT_FT=11e3]="Phi3Small_Doc2PPT_FT",e[e.SwecMlSlot11Ft=10019]="SwecMlSlot11Ft",e[e.GPT4oMini05SwecMlFt=10020]="GPT4oMini05SwecMlFt",e[e.DevSwecSlot13Ft=10021]="DevSwecSlot13Ft"}(Cn||(Cn={})),function(e){e.object="object"}(vn||(vn={})),function(e){e.ARRAY="array",e.STRING="string",e.NUMBER="number",e.INTEGER="integer",e.BOOLEAN="boolean",e.OBJECT="object"}(xn||(xn={})),function(e){e.Function="function"}(Sn||(Sn={})),function(e){e.low="low",e.medium="medium",e.high="high"}(kn||(kn={})),function(e){e.text="text",e.jsonObject="json_object"}(Pn||(Pn={})),function(e){e.content="content"}(En||(En={}));var Nn=n(8210),Bn=n(2291),Fn=n(31861),Gn=n(994),Ln=n(7628),Hn=n(76972);const Wn=({onSubmit:e})=>{const[t,n]=(0,y.useState)("");return y.createElement("form",{onSubmit:o=>{o.preventDefault(),e(t),n("")}},y.createElement(o.B,null,y.createElement(i.a,null,y.createElement(y.Fragment,null,y.createElement(Hn.p,{style:{width:"100%",height:"100px"},type:"text",value:t,onChange:e=>n(e.target.value),placeholder:"Enter annotation"}))),y.createElement(i.a,{style:{paddingTop:"20px"}},y.createElement(s.$,{type:"submit"},"Submit"))))};var zn=n(66798);const Un=({audioBlob:e})=>{const[t,n]=(0,y.useState)(!1),[o,i]=(0,y.useState)(0),[r,a]=(0,y.useState)(0),s=(0,y.useRef)(null);(0,y.useEffect)((()=>{if(e){const t=URL.createObjectURL(e);return s.current&&(s.current.src=t),()=>URL.revokeObjectURL(t)}}),[e]);const l=e=>{const t=Math.floor(e/60),n=Math.floor(e%60);return`${t}:${n<10?"0":""}${n}`};return y.createElement("div",{style:{width:"300px",padding:"10px",border:"1px solid #ccc",borderRadius:"5px"}},y.createElement("audio",{ref:s,onTimeUpdate:()=>{s.current&&i(s.current.currentTime)},onLoadedMetadata:()=>{s.current&&a(s.current.duration)}}),y.createElement("button",{onClick:()=>{s.current&&(t?s.current.pause():s.current.play(),n(!t))},style:{padding:"5px 10px",marginBottom:"10px",backgroundColor:"#4CAF50",color:"white",border:"none",borderRadius:"3px",cursor:"pointer"}},t?"Pause":"Play"),y.createElement("input",{type:"range",min:0,max:r,value:o,onChange:e=>{const t=parseFloat(e.target.value);s.current&&(s.current.currentTime=t),i(t)},style:{width:"100%",marginBottom:"10px"}}),y.createElement("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"12px"}},y.createElement("span",null,l(o)),y.createElement("span",null,l(r))))},Vn=(0,R.n)({cardStyle:{padding:"1px",borderRadius:"8px",zIndex:999,maxHeight:"80vh",overflowY:"auto"},cardGap:{...A.Pt.gap("8px")},headerStyle:{marginTop:"20px !important"},paddingBottom:{paddingBottom:"12px"},PinCardsStyle:{padding:"12px",backgroundColor:O.L.colorNeutralBackground2},accordionPanelStyle:{paddingBottom:"12px",...A.Pt.gap("8px")},pinnedMessageStyle:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis",maxHeight:"3em",lineHeight:"1.5em",whiteSpace:"normal"},showMoreCardStyle:{padding:"4px 8px",borderRadius:"8px",backgroundColor:O.L.colorNeutralBackground2}});n(58651);const Qn=({id:e,content:t,addButtonProps:n,copyButtonProps:_,pinButtonProps:C,aiHelpButtonProps:v,aiSuggestionButtonProps:x,isContentSensitive:S=!1,heading:k,filePickerComponent:P,blobData:E})=>{const T=Vn(),w=e=>y.createElement(r.W,{positioning:"above"},y.createElement(a.c,{disableButtonEnhancement:!0},y.createElement(s.$,{size:"small",appearance:"transparent",icon:e?.buttonIcon??y.createElement(y.Fragment,null,e?.buttonIcon)},e?.buttonText)),y.createElement(l.b,null,y.createElement(c.c,null,y.createElement(d.r,null,y.createElement(p.s,null,y.createElement(u.Q,null,e.headerText)),e?.suggestionList.map((e=>y.createElement(y.Fragment,null,y.createElement(h.c,null),y.createElement(m.D,{onClick:()=>e?.onClick(t,e.content,e.responsetype,e.skillName),icon:e.icon},e.content)))))))),I=new Blob([new Uint8Array(E||[])]);return y.createElement(o.B,{key:e},y.createElement(i.a,null,y.createElement(u.Q,null,k)),E&&y.createElement(Un,{audioBlob:I}),P&&y.createElement(i.a,null,P),""===t?y.createElement(zn.y,{label:"Waiting for content..."}):y.createElement(y.Fragment,null,y.createElement(i.a,null,t&&(e=>e.replace(/<table/g,'<table style="width:100%; height: 100%;"'))(t)),y.createElement(o.B,{horizontal:!0,className:T.cardGap},n&&y.createElement(s.$,{size:"small",icon:n.icon??y.createElement(g.m61,null),onClick:()=>n.onClick?.(t),disabled:S},n.text),v&&w(v),_&&y.createElement(s.$,{size:"small",appearance:"transparent",icon:_.icon??y.createElement(f.Qvr,null),onClick:()=>_.onClick?.(t),disabled:S}),C&&y.createElement(s.$,{size:"small",appearance:"transparent",icon:C.icon??y.createElement(b.MtV,null),onClick:()=>C.onClick?.(t,e),disabled:S}),x&&w(x))))};var qn=n(20172),Kn=n(86259),$n=n(79001),jn=n(41341);const Jn=(0,R.n)({cardStyle:{padding:"1px",borderRadius:"8px",zIndex:999,maxHeight:"80vh",overflowY:"auto"},cardGap:{...A.Pt.gap("8px")},headerStyle:{marginTop:"20px !important"},paddingBottom:{paddingBottom:"12px"},PinCardsStyle:{padding:"12px",backgroundColor:O.L.colorNeutralBackground2},accordionPanelStyle:{paddingBottom:"12px",...A.Pt.gap("8px")},pinnedMessageStyle:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis",maxHeight:"3em",lineHeight:"1.5em",whiteSpace:"normal"},showMoreCardStyle:{padding:"4px 8px",borderRadius:"8px",backgroundColor:O.L.colorNeutralBackground2},toggleStyle:{padding:"1px",maxWidth:"100%",overflowX:"auto",...A.Pt.gap("2px"),"&:-ms-overflow-style":"none",scrollbarWidth:"thin","&::-webkit-scrollbar":{display:"none",height:0}}});var Zn=n(58651);const Yn=({id:e,content:t,addButtonProps:n,copyButtonProps:_,pinButtonProps:C,aiHelpButtonProps:v,aiSuggestionButtonProps:x,isContentSensitive:S=!1})=>{const k=Jn(),P=e=>y.createElement(r.W,{positioning:"above"},y.createElement(a.c,{disableButtonEnhancement:!0},y.createElement(s.$,{size:"small",appearance:"transparent",icon:e?.buttonIcon??y.createElement(y.Fragment,null,e?.buttonIcon)},e?.buttonText)),y.createElement(l.b,null,y.createElement(c.c,null,y.createElement(d.r,null,y.createElement(p.s,null,y.createElement(u.Q,null,e.headerText)),e?.suggestionList.map((e=>y.createElement(y.Fragment,null,y.createElement(h.c,null),y.createElement(m.D,{onClick:()=>e?.onClick(t,e.content,e.responsetype,e.skillName),icon:e.icon},e.content))))))));return y.createElement(o.B,{key:e},y.createElement(i.a,null,(e=>{const t=e.replace(/<table/g,'<table style="width:100%; height: 100%;"');return(0,jn.Ay)(t)})(t)),y.createElement(o.B,{horizontal:!0,className:k.cardGap},n&&y.createElement(s.$,{size:"small",icon:n.icon??y.createElement(g.m61,null),onClick:()=>n.onClick?.(t),disabled:S},n.text),v&&P(v),_&&y.createElement(s.$,{size:"small",appearance:"transparent",icon:_.icon??y.createElement(f.Qvr,null),onClick:()=>_.onClick?.(t),disabled:S}),C&&y.createElement(s.$,{size:"small",appearance:"transparent",icon:C.icon??y.createElement(b.MtV,null),onClick:()=>C.onClick?.(t,e),disabled:S}),x&&P(x)))},Xn=(e,t,n)=>(Zn.log("getRegenerateResponseMenuProps shouldSetRewriteSuggestions :",n),t?.push({content:"Generate Audio Summary",onClick:e,icon:y.createElement(qn.gok,null),responsetype:_n.skillName,skillName:Bn.RS.ORGANIZE_FILES_IN_FOLDER}),{buttonText:"",buttonIcon:y.createElement(Kn.mkh,null),headerText:"Regenerate response",suggestionList:n?[{content:"Shorter",onClick:e,icon:y.createElement(qn.gok,null),responsetype:_n.skillName,skillName:Bn.RS.REWRITE_CONTENT},{content:"Longer",onClick:e,icon:y.createElement(qn.lQL,null),responsetype:_n.skillName,skillName:Bn.RS.REWRITE_CONTENT},{content:"Simpler",onClick:e,icon:y.createElement(Kn.b2m,null),responsetype:_n.skillName,skillName:Bn.RS.REWRITE_CONTENT},{content:"Casual",onClick:e,icon:y.createElement(f.bNJ,null),responsetype:_n.skillName,skillName:Bn.RS.REWRITE_CONTENT},{content:"Professional",onClick:e,icon:y.createElement(f.hDC,null),responsetype:_n.skillName,skillName:Bn.RS.REWRITE_CONTENT},...t||[]]:t||[]}),eo=e=>({buttonText:"",headerText:"Suggested from the Workspace",buttonIcon:y.createElement($n.wit,null),suggestionList:e}),to=e=>{switch(e){case"generateSummary":return{text:"Generate Summary",icon:y.createElement(f.Mrw,null)};case"generateTable":return{text:"Generate Table",icon:y.createElement(Kn.PJ4,null)};default:return{text:"Rewrite Content",icon:y.createElement(f.GvE,null)}}};var no,oo,io,ro=n(58651);!function(e){e.PinnedMessages="PinnedMessages",e.GroundingFiles="GroundingFiles"}(no||(no={}));class ao{static saveItem(e,t){if(ao.doesIdExist(e,t.id))return void ao.updateItem(e,t);const n=ao.getItems(e);n.push(t),ao.setItems(e,n)}static updateItem(e,t){const n=ao.getItems(e).map((e=>e.id===t.id?t:e));ao.setItems(e,n)}static deleteItem(e,t){const n=ao.getItems(e).filter((e=>e.id!==t));ao.setItems(e,n)}static getItems(e){try{const t=ao.getItem(e);return null===t?[]:JSON.parse(t)}catch(e){return ro.error("Error getting items from localStorage",e),[]}}static getItemById(e,t){return ao.getItems(e).find((e=>e.id===t))}static getNextAvailableId(e){const t=ao.getItems(e);let n=-1;for(const e of t)e.id>n&&(n=e.id);return n+1}static doesIdExist(e,t){return void 0!==ao.getItemById(e,t)}static getItem(e){try{return localStorage.getItem(e)}catch(e){return ro.error("Error getting from localStorage",e),null}}static setItems(e,t){try{const n=JSON.stringify(t);localStorage.setItem(e,n)}catch(e){e instanceof DOMException&&"QuotaExceededError"===e.name?ro.error("Storage quota exceeded"):ro.error("Error storing to localStorage",e)}}}!function(e){e.OpenAiModel="OpenAiModel",e.FileContentFetchFormat="FileContentFetchFormat",e.CanvasResponseFormat="CanvasResponseFormat"}(oo||(oo={})),function(e){e.String="String",e.CipTree="CipTree",e.CipTreeSummary="CipTreeSummary"}(io||(io={}));class so{static generateId(){return so.operationId++,"CopilotResearch"+so.operationId.toString()}}so.operationId=0;var lo=n(82736),co=n(18551),po=n(56617),uo=n(25332);const ho=e=>gn.some((t=>t.key===e)),mo=e=>{const t=fn.find((t=>t.key===e));return t?.value||""},go=e=>{if(""===e)return"";const t=(e=>JSON.parse(e).listOfSensitiveFiles)(e||""),n=(e=>(JSON.parse(e).listOfFilesWithFailure||[]).map((e=>e?.fileName)))(e||"");let o="";if(t?.length>0){o=`Limited Access. Sensitive files found: ${t.join(", ")}.`}if(n?.length>0){o+=`\nThere is problem in accessing some of the input files. ${n.join(", ")}`}return o};var fo,bo=n(58651);!function(e){e[e.UnSupported=0]="UnSupported",e[e.PlotlyJson=1]="PlotlyJson",e[e.Html=2]="Html"}(fo||(fo={}));class yo extends Tn.h{setDemoMode(e){this.isDemoMode=e}constructor(e,t,n,o,i,r,a,s){super(),this.IsArtifactContentEnabledState=!1,this.isCIPQnAEnabledState=!1,this.isStreamingEnabledState=!1,this.IsDemoToggleHidden=!1,this.isDemoMode=!0,this.isNonDemoSuggestionPillShown=!1,this.fileList=[],this.lastCardContent="",this.payloadResponseData="",this.currentPillsIndex=0,this.isAccordionOpen=!0,this.isLoopEnabled=!1,this.hasActiveSignal=!1,this.pinMessageId=ao.getNextAvailableId(no.PinnedMessages),this.onEntityChanges=e=>{bo.log("Entity Selected called: ",e),this.fileList=[];let t=!1;e.forEach((e=>{e.checked&&(t=t||e.text?.toLocaleLowerCase().endsWith(".xls")||e.text?.toLocaleLowerCase().endsWith(".xlsx"),this.fileList.push(e.url||""))})),bo.log("File List: ",this.fileList),this.setEntityPickerProps((t=>({...t,hvcEntityPickerPropsValue:{...t.hvcEntityPickerPropsValue,list:e,openEntityInputPickerOnStartup:!1,addEntityButtonText:"Add Files"}}))),t&&1===this.fileList.length&&(this.expandAccordion(sn),this.displayNextSuggestionPills(sn)),!1===this.isDemoMode&&this.fileList.length>0&&!this.isNonDemoSuggestionPillShown&&this.setSuggestionsPills([tn])},this.addDemoFiles=()=>{this.fileList=bn,this.setEntityPickerProps((e=>({...e,shouldShowEntityPicker:!0,hvcEntityPickerPropsValue:{...e.hvcEntityPickerPropsValue,list:yn,openEntityInputPickerOnStartup:!1,addEntityButtonText:"Add Files"}})))},this.onArtifactContentStateChanged=e=>{this.IsArtifactContentEnabledState=e},this.onStreamingStateChanged=e=>{this.isStreamingEnabledState=e},this.onFileContentFetchFormatChanged=e=>{this.sendConfigChangeSignal(oo.FileContentFetchFormat,e),this.updateCIPQnAState(e),bo.log("File content fetch format updated to: ",e)},this.getOfficeAIIncubationConfigChangeSignal=(e,t,n)=>{bo.log("research config change tile");let o="";switch(t){case oo.OpenAiModel:o=`{"defaultModelName": "${Cn[n]}"}`;break;case oo.FileContentFetchFormat:o=`{"defaultContentFetchFormat": "${n}"}`}return{query:"",queryId:e,fileId:(0,Ln.A)(),requestType:Bn.d2.SET_CONFIG,userConfig:o}},this.handleGeneratedArtifactResponse=(e,t)=>{bo.log("Inside handleGeneratedArtifactResponse");const n=e?.artifactResponse;if(void 0!==e.isFinalChunk&&e.isFinalChunk)return void t.current?.addResponseMessage({chatCardType:wn._.MarkdownCard,chatMessageData:{markDownCardProps:{message:"Added Artifact response to canvas."}},chatMessageBodyData:{feedbackSectionPosition:In.O.None,shouldShowAIGeneratedIndicator:!1}});if(!n||0!=n?.status)return bo.error("Error in response from Incubation workflow in Copilot Chat!"),void t.current?.addResponseMessage({chatCardType:wn._.MarkdownCard,chatMessageData:{markDownCardProps:{message:"Error processing the response from service! Please try again"}},chatMessageBodyData:{feedbackSectionPosition:In.O.Footer,shouldShowAIGeneratedIndicator:!0}});let o=fo.UnSupported;switch(n.artifactsType){case"code/plotlyJson":default:o=fo.PlotlyJson;break;case"text/html":o=fo.Html}if(n.artifactSummary){const e=n.artifactSummary.trim(),t=F(this.pinMessageId++,e,{text:"Insert",onClick:e=>{this.displayNextSuggestionPills(ln),this.expandAccordion(cn),this.onInsertString&&this.onInsertString(e||"")}},{text:"Copy",onClick:e=>{navigator.clipboard.writeText(e||"")}},{text:"Pin",onClick:this.addPinnedMessageInner},Xn(this.submitSuggestionQuery.bind(this),[],!1),eo([]),""!==this.payloadResponseData,!1);this.copilotChatRef.current?.addResponseMessage({chatCardType:wn._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:"chat",element:t}},chatMessageBodyData:{...this.getChatMessageBodyProps()},stopLoadingUi:!0})}if(n.artifactContent&&o===fo.PlotlyJson){const e=n.artifactContent.trim(),t=F(this.pinMessageId++,e,{text:"Insert",onClick:e=>{this.displayNextSuggestionPills(ln),this.expandAccordion(cn),this.onInsertString&&this.onInsertString(e||"")}},{text:"Copy",onClick:e=>{navigator.clipboard.writeText(e||"")}},{text:"Pin",onClick:this.addPinnedMessageInner},Xn(this.submitSuggestionQuery.bind(this),[],!1),eo([]),""!==this.payloadResponseData,!0,P.PlotlyJson);this.copilotChatRef.current?.addResponseMessage({chatCardType:wn._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:"chat",element:t}},chatMessageBodyData:{...this.getChatMessageBodyProps()},stopLoadingUi:!0})}},this.addPinnedMessageInner=(e,t)=>{this.displayNextSuggestionPills(pn),this.addPinnedMessage?.(e,t),this.copilotChatRef.current?.updateMessage({chatCardType:wn._.ChatCardWrapper,chatMessageBodyData:{messageId:this.pinMessageId.toString()}})},this.handleResponse=e=>{this.validatePodcastResponse(e)},this.alSession=e,this.setEntityPickerProps=t,this.copilotChatRef=n,this.onInsertString=o,this.setSuggestionsPills=i,this.setOnCanvasDataRequested=r,this.setIsDemoToggleShown=a,this.isLoopEnabled=s}cleanup(){yo.instance=void 0}setAddPinnedMessageCallback(e){this.addPinnedMessage=e}getWorkflowsToRegister(){const e=[{workflowAnnotationType:Fn.H6.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0},{workflowAnnotationType:Fn.Vd.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0}];return bo.log("Research:: Registered workflows"),e}async shouldSendRequestToAugloop(e,t,n){return this.IsDemoToggleHidden||this.setIsDemoToggleShown(!1),"dbgal"===e?(this.copilotChatRef.current?.addResponseMessage({chatCardType:wn._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:"chat",element:(o=this.handleResponse,y.createElement(Wn,{onSubmit:o}))}},chatMessageBodyData:{...this.getChatMessageBodyProps()},stopLoadingUi:!0}),!1):(!1!==this.isDemoMode||this.isNonDemoSuggestionPillShown||(this.isNonDemoSuggestionPillShown=!0,this.setSuggestionsPills([])),(!this.isDemoMode||!this.fileChecksForDemoMode(e))&&(e!==mn[this.currentPillsIndex].name||mn[this.currentPillsIndex].isALSignalRequired?(e.toLocaleLowerCase().includes("summarize")&&this.expandAccordion(e.toLocaleLowerCase()),e===an&&(this.copilotChatRef.current?.startLoadingUi(),this.lastCardContent=await this.setOnCanvasDataRequested()),!0):(this.copilotChatRef.current?.addResponseMessage({chatCardType:wn._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:Dn.Q9.Chat,element:mn[this.currentPillsIndex].name===nn?"Synopsis has been added to the document":mn[this.currentPillsIndex].name}},chatMessageBodyData:{...this.getChatMessageBodyProps()}}),this.displayNextSuggestionPills(mn[this.currentPillsIndex].name,!0),e===nn&&this.onInsertString(this.lastCardContent),!1)));var o}expandAccordion(e){if(bo.log("DEBUGLOG: expandAccordion isExpanded:",e),e===sn||e===cn){if(!this.isAccordionOpen){const e=window.document.getElementById("accordionHeaderResearch");if(e){const t=e.querySelector("button");t&&t.click()}}}else if(this.isAccordionOpen){const e=window.document.getElementById("accordionHeaderResearch");if(e){const t=e.querySelector("button");t&&t.click()}}}updateCIPQnAState(e){this.isCIPQnAEnabledState=e===io.CipTreeSummary}getHostSettings(){return{appName:"Testing",appPlatform:"All",devBuild:!0,environment:Rn.D.DEV,sessionId:"",augloopUrl:"https://augloop-dogfood.officeppe.com"}}processFileListFromQueryAnnotations(e,t){const n=[];e?.forEach((e=>{const{name:t,extension:o}=(0,Mn.sV)(e.text);bo.log("Name: ",t,"Extension: ",o),n.push({checked:!0,url:"",text:e.text,id:e.id,iconUrl:jt.GB.get(o)||""})})),t?.forEach(((e,t)=>{e.value&&(this.fileList.push(e.value),n[t].url=e.value)})),n.length>0&&this.setEntityPickerProps((e=>({...e,shouldShowEntityPicker:!0,hvcEntityPickerPropsValue:{...e.hvcEntityPickerPropsValue,list:[...e.hvcEntityPickerPropsValue.list,...n],openEntityInputPickerOnStartup:!1,addEntityButtonText:"Add Files"}})))}isArtifactContentEnabled(){return this.IsArtifactContentEnabledState}isCIPQnAEnabled(){return this.isCIPQnAEnabledState}isStreamingEnabled(){return this.isStreamingEnabledState}createSignal(e,t,n=[],o=Bn.v1.MARKDOWN,i=Bn.d2.GENERATE_DATA,r){const a=this.isArtifactContentEnabled()?Bn.RS.GENERATE_ARTIFACT:this.isCIPQnAEnabled()?Bn.RS.USER_QUERY_CIP:r;return bo.log("createSignal:called: chatInputType ",r),new Gn.i({query:"",queryId:(0,Ln.A)(),requestType:this.isArtifactContentEnabled()?Bn.d2.GENERATE_ARTIFACT:i,isStreaming:this.isStreamingEnabled(),clientRequest:{chatInput:e,chatInputType:a,requestPayload:JSON.stringify({canvasContent:t,contentFormat:o,fileUrls:n})}})}sendConfigChangeSignal(e,t){const n=this.getOfficeAIIncubationConfigChangeSignal((0,Ln.A)(),e,t);bo.log("Created tile for config update signal",n),this.copilotChatRef.current?.submitOperation({operation:new An.g0({parentPath:["Signal",Gn.i.getTypeName()],items:[{id:so.generateId(),body:new Gn.i(n)}]}),workflowAnnotationType:Fn.H6.getTypeName()}),this.copilotChatRef.current?.addResponseMessage({chatCardType:wn._.Default,chatMessageData:{defaultMessageProps:{user:"human",messageHeader:{text:`Updating config "${e}" to "${t}". Please wait...`}}}}),this.copilotChatRef.current?.startLoadingUi()}getDefaultSignalOperation(e,t,n,o,i){bo.log("getDefaultSignalOperation:called: ",this.fileList,e,i);const r=e.replace(/\s+/g,"");let a,s="";for(const e of i??[])s+=e.text.replace(/\s+/g,"");if(bo.log("DEBUGLOG: trimmedMessageText:",r),bo.log("DEBUGLOG: trimmedAnnotationText:",s),r===s&&(e="Create a synopsis of the files "+e),"summarize"===e.toLocaleLowerCase()&&mn[this.currentPillsIndex].name===cn&&this.displayNextSuggestionPills(mn[this.currentPillsIndex].name),e===mn[this.currentPillsIndex].name&&this.displayNextSuggestionPills(mn[this.currentPillsIndex].name,!0),e==tn&&(bo.log("Initial messageText: ",e),e="Create a three page Synopsis and also add a table",bo.log("Converted messageText: ",e)),this.hasActiveSignal)a=this.activeSignal,this.hasActiveSignal=!1;else if(this.processFileListFromQueryAnnotations(i||[],o||[]),e===an)a=this.createSignal(e,this.lastCardContent,[],Bn.v1.HTML,Bn.d2.GENERATE_SUGGESTIONS);else if(e.toLowerCase().includes("generate audio summary"))a=this.createSignal(e,"",this.fileList,Bn.v1.HTML,Bn.d2.PODCAST_CREATION);else{let t=Bn.v1.MARKDOWN;e===rn&&(t=Bn.v1.HTML),a=this.createSignal(e,this.isArtifactContentEnabled()?this.lastCardContent:"",this.fileList,t,Bn.d2.GENERATE_DATA)}const l=["Signal",Gn.i.getTypeName()],c={operation:new An.g0({parentPath:l,items:[{id:so.generateId(),body:a}]}),workflowAnnotationType:Fn.Vd.getTypeName()};return Promise.resolve(c)}displayNextSuggestionPills(e,t=!1){this.isDemoMode&&(this.currentPillsIndex<mn.length-1&&(!e||mn[this.currentPillsIndex].name===e)?this.setSuggestionsPills([mn[++this.currentPillsIndex].name]):t&&this.setSuggestionsPills([]))}displayPreviousSuggestionPills(e,t=!1){this.isDemoMode&&(this.currentPillsIndex>0&&(!e||mn[this.currentPillsIndex].name===e)?this.setSuggestionsPills([mn[--this.currentPillsIndex].name]):t&&this.setSuggestionsPills([]))}submitSuggestionQuery(e,t,n,o){t=t||"";let i="";n===_n.skillName?(ho(t)&&(i=(e=>{const t=gn.find((t=>t.key===e));return t?.value||""})(t)),this.activeSignal=this.createSignal(i,e||"",[],Bn.v1.MARKDOWN,Bn.d2.GENERATE_DATA,o)):this.activeSignal=this.createSignal(t,e||"",[],Bn.v1.MARKDOWN,Bn.d2.GENERATE_DATA),this.hasActiveSignal=!0,this.displayNextSuggestionPills(un),"Longer"===t&&this.displayNextSuggestionPills(dn),ho(t)?this.copilotChatRef.current?.submitUserQuery({text:""===i?"Rewrite Content":i}):this.copilotChatRef.current?.submitUserQuery({text:""===t?"Rewrite Content":t})}handleSetConfigResponse(){this.copilotChatRef.current?.addResponseMessage({chatCardType:wn._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:"chat",element:"Successfully updated the configuration. Please proceed."}},chatMessageBodyData:{...this.getChatMessageBodyProps()},stopLoadingUi:!0})}sendResponseToClient(e){if(bo.log("Item: ",e),e.body?.H_)switch(e.body.H_.T_){case Fn.H6.getTypeName():case Fn.Vd.getTypeName():switch(e.body.responseType){case Bn.d2.GENERATE_ARTIFACT:this.handleGeneratedArtifactResponse(e.body,this.copilotChatRef);break;case Bn.d2.SERVICE_RESPONSE:e.body.requestType==Bn.d2.SET_CONFIG&&this.handleSetConfigResponse();break;case Bn.d2.PODCAST_CREATION:{const t=e.body;bo.log("Podcast response received",t);const n=2e6;let o=new Uint8Array([]);const i=t.podcastResponse;if(!i)return void bo.log("Podcast response is empty");if(i?.blob&&i.blob.sizeBytes<=n){bo.log("Podcast response is within bounds");const e=(i?.blob?.data).data;void 0!==e&&(o=new Uint8Array(e),bo.log("speechData ",o," blobData ",e),this.showPodcastCard(o))}else bo.log("Podcast response is too large"),this.gotBlobReferences(i.blob);bo.log("Speech data blob",o);break}default:{bo.log("Received response from OfficeaiIncubationApp workflow in Copilot Chat");const c=e.body,d=c.generatedDataResponse?.response,p=c.generatedDataResponse?.responsePayload,u=c.generatedDataResponse?.status;let h={content:""};try{d&&"string"==typeof d&&d.length>0?h=JSON.parse(d):"object"==typeof d&&null!==d&&(h=d)}catch(e){bo.error("Error parsing response:",e)}const m=c.generatedSuggestionsResponse?.generatedSuggestions,g=JSON.parse(m||"{}");if(u===Nn.lC.ErrorInExecution)return this.copilotChatRef.current?.addResponseMessage({chatCardType:wn._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:"chat",element:"An error occurred while processing your request. Please try again later."}},chatMessageBodyData:{...this.getChatMessageBodyProps()},stopLoadingUi:!0}),this.lastCardContent="",void this.displayPreviousSuggestionPills(mn[this.currentPillsIndex].name);bo.log("Content: ",h),h?.content&&(c.generatedDataResponse?.chatInput==Bn.RS.GENERATE_DATA_VISUALISATION_CHART?this.lastCardContent='<img src="https://transcriptionserver.blob.core.windows.net/chart/image.png" alt="Chart" width="100%" height="100%">':this.lastCardContent=(e=>{const t=y.createElement(co.$,{remarkPlugins:[uo.A],rehypePlugins:[po.A],components:{a:({node:e,...t})=>y.createElement("a",{...t,target:"_blank",rel:"noopener noreferrer"})}},e);return lo.renderToString(t)})(h?.content),this.payloadResponseData=go(p||""));const f=g?.follow_up_suggestions,b=[];f?.forEach((e=>{b.push({content:e,onClick:this.submitSuggestionQuery.bind(this),responsetype:_n.suggestion})}));const _=[],C=g?.follow_up_chatInputType;let v=!1;C?.forEach((e=>{"rewriteContent"===e&&(v=!0),_.push({content:mo(e),icon:to(e)?.icon||void 0,onClick:this.submitSuggestionQuery.bind(this),responsetype:_n.skillName,skillName:e})}));const x=g?.follow_up_operations;if(x?.forEach((e=>{_.push({content:e||"",icon:to(e)?.icon||void 0,onClick:this.submitSuggestionQuery.bind(this),responsetype:_n.operations})})),this.isStreamingEnabled()&&""!==this.lastCardContent&&h.content.length>0||g?.follow_up_suggestions&&""!==this.lastCardContent){let e;this.isLoopEnabled?e=F(this.pinMessageId++,this.lastCardContent,{text:"Insert",onClick:e=>{this.displayNextSuggestionPills(ln),this.expandAccordion(cn),this.onInsertString&&this.onInsertString(e||"")}},{text:"Copy",onClick:e=>{navigator.clipboard.writeText(e||"")}},{text:"Pin",onClick:this.addPinnedMessageInner},Xn(this.submitSuggestionQuery.bind(this),_,v),eo(b),""!==this.payloadResponseData,!1):(t=this.pinMessageId++,n=this.lastCardContent,o={text:"Insert",onClick:e=>{this.displayNextSuggestionPills(ln),this.expandAccordion(cn),this.onInsertString&&this.onInsertString(e||"")}},i={text:"Copy",onClick:e=>{navigator.clipboard.writeText(e||"")}},r={text:"Pin",onClick:this.addPinnedMessageInner},a=Xn(this.submitSuggestionQuery.bind(this),_,v),s=eo(b),l=""!==this.payloadResponseData,e=y.createElement(Yn,{id:t,content:n,addButtonProps:o,copyButtonProps:i,pinButtonProps:r,aiHelpButtonProps:a,aiSuggestionButtonProps:s,isContentSensitive:l})),this.copilotChatRef.current?.addResponseMessage({chatCardType:wn._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:"chat",element:e}},chatMessageBodyData:{...this.getChatMessageBodyProps()},stopLoadingUi:!0}),""!==this.payloadResponseData&&(this.copilotChatRef.current?.addResponseMessage({chatCardType:wn._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:"chat",element:this.payloadResponseData}},chatMessageBodyData:{...this.getChatMessageBodyProps()}}),this.payloadResponseData="")}this.expandAccordion(mn[this.currentPillsIndex].name);break}}}var t,n,o,i,r,a,s,l}getChatMessageBodyProps(){return{messageId:"text",feedbackSectionPosition:In.O.Footer,shouldShowAIGeneratedIndicator:!0,feedbackData:{feedbackArea:"Commanding Error Card",contextData:{cardMetaData:JSON.stringify({status:"Commanding Error card shown"})}}}}sendEventToClient(e,t){if(e===On.PV.CopilotChatLoaded){const e=en(),t=ao.getItems(no.GroundingFiles),n=0===t.length;if(!n){const e=t[0].list;e?.map((e=>{e.checked&&this.fileList.push(e.url||"")}))}this.setEntityPickerProps((o=>({...o,shouldShowEntityPicker:!n,hvcEntityPickerPropsValue:{list:n?[]:t[0].list,onEntityChange:this.onEntityChanges,addAnotherEntityProps:{editorConfiguration:e.addAnotherEntityProps?.editorConfiguration,alSession:this.alSession},openEntityInputPickerOnStartup:!1,addEntityButtonText:"Add Files"}})))}}fillEntityPickerProps(e,t){const n=t??en(),o=ao.getItems(no.GroundingFiles),i=0===o.length;this.setEntityPickerProps((t=>({...t,shouldShowEntityPicker:e,hvcEntityPickerPropsValue:{list:i?[]:o[0].list,onEntityChange:this.onEntityChanges,addAnotherEntityProps:{editorConfiguration:n.addAnotherEntityProps?.editorConfiguration,alSession:this.alSession},openEntityInputPickerOnStartup:!0,addEntityButtonText:"Add Files"}})))}static getInstance(e,t,n,o,i,r,a,s){return yo.instance||(yo.instance=new yo(e,t,n,o,i,r,a,s)),yo.instance}async getALSession(){return Promise.resolve(this.alSession)}getAuthToken(){return Promise.resolve("")}fileChecksForDemoMode(e){let t="";const n=/summarize/i;switch(e){case tn:0===this.fileList.length&&(t=`${hn}Please select the files to proceed.`);break;case rn:{const e=bn[2];this.fileList.find((t=>t===e))&&1===this.fileList.length||(t=`${hn}Please select the Excel file only to proceed.`);break}case on:{const e=[bn[1],yn[1].url];this.fileList.some((t=>e.includes(t)))||(t=`${hn}Please select the Teams Meeting transcript file to proceed.`);break}default:if(n.test(e)){const e=bn.slice(3,7);this.fileList.some((t=>e.includes(t)))||(t=`${hn}Please select one or more Word or Powerpoint files to proceed.`)}}return""!==t&&(this.copilotChatRef.current?.addResponseMessage({chatCardType:wn._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:"chat",element:t}},chatMessageBodyData:{...this.getChatMessageBodyProps()},stopLoadingUi:!0}),!0)}showPodcastCard(e){var t,n,o,i,r,a,s,l,c,d,p,u;this.copilotChatRef.current?.addResponseMessage({chatCardType:wn._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:"chat",element:(t=this.pinMessageId++,n="Generated podcast",o=void 0,i=void 0,r=void 0,a=void 0,s=void 0,l=void 0,c=void 0,d=void 0,p=e,y.createElement(Qn,{id:t,content:n,addButtonProps:o,copyButtonProps:i,pinButtonProps:r,aiHelpButtonProps:a,aiSuggestionButtonProps:s,isContentSensitive:l,heading:c,filePickerComponent:d,blobData:p,blobVal:u}))}},chatMessageBodyData:{...this.getChatMessageBodyProps()},stopLoadingUi:!0})}async gotBlobReferences(e){const t=await this.alSession.requestBinaryDataForBlob(e);this.showPodcastCard(t)}async validatePodcastResponse(e){var t;let n;await(t=5e3,new Promise((e=>setTimeout(e,t))));const o=JSON.parse(e).podcastResponse,i=o.blob.data;if(void 0!==i&&"string"!=typeof i){if(!o)return void bo.log("Podcast response is empty");if(o.blob.sizeBytes<=2e6){bo.log("Podcast response is within bounds");const e=o.blob.data.data;void 0!==e&&(n=new Uint8Array(e),bo.log("speechData ",n," blobData ",e),this.showPodcastCard(n))}else bo.log("Podcast response is too large"),this.gotBlobReferences(o.blob);bo.log("Speech data blob",n)}}}var _o=n(70877);const Co=(0,R.n)((0,_o.f)({chatFreStack:{height:"calc(100vh - 200px)"},chatUiStack:{top:"20px"}}));var vo=n(67688),xo=n(72289);var So=n(90539),ko=n(86092),Po=n(7971);const Eo="fui-CounterBadge",To="fui-CounterBadge__icon",wo=(0,So.X)({dot:{Bf4jedk:"fgfkb25",a9b677:"f16dn6v3",Bqenvij:"f3mu39s",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1mk8lai"},hide:{mc9l5x:"fjseox"}},{d:[".fgfkb25{min-width:auto;}",".f16dn6v3{width:6px;}",".f3mu39s{height:6px;}",[".f1mk8lai{padding:0;}",{p:-1}],".fjseox{display:none;}"]});var Io=n(4704),Do=n(51468);const Ro=y.forwardRef(((e,t)=>{const n=((e,t)=>{const{shape:n="circular",appearance:o="filled",showZero:i=!1,overflowCount:r=99,count:a=0,dot:s=!1}=e,l={...(0,xo.c)(e,t),shape:n,appearance:o,showZero:i,count:a,dot:s};return 0===a&&!i||s||l.root.children||(l.root.children=a>r?`${r}+`:`${a}`),l})(e,t);return(e=>{const t=wo();e.root.className=(0,ko.z)(Eo,e.dot&&t.dot,!e.root.children&&!e.dot&&t.hide,e.root.className),e.icon&&(e.icon.className=(0,ko.z)(To,e.icon.className)),(0,Po.o)(e)})(n),(0,Io.$e)("useCounterBadgeStyles_unstable")(n),(0,Do.r)(n)}));Ro.displayName="CounterBadge";var Ao=n(63889),Oo=n(19781),Mo=n(13222),No=n(36056),Bo=n(73725),Fo=n(58651);const Go=({contentList:e,itemCounterText:t,title:n,HeaderIcon:o,handleOnToggle:i})=>{const[r,a]=y.useState(e);y.useEffect((()=>{Fo.log("PinnedContent mounted"),a(e)}),[e]);const s=Jn();return 0===r.length?y.createElement(y.Fragment,null):y.createElement(Bo.n,{collapsible:!0,defaultOpenItems:1},y.createElement(Ao.Z,{size:"small",className:s.cardStyle},y.createElement(Oo.A,{value:1},y.createElement(Mo.u,{expandIconPosition:"end",icon:o,expandIcon:y.createElement(vo.W,{horizontal:!0,style:s.cardGap},y.createElement(Ro,{appearance:"filled",color:"informative",count:t}),y.createElement(f.yuG,null)),id:"accordionHeaderResearch",onClick:e=>{e.preventDefault(),i()}},n),y.createElement(No.v,null,r.map(((e,t)=>y.createElement(vo.W,{key:t,style:s.paddingBottom},e)))))))};var Lo=n(84960);function Ho(){return Ho=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Ho.apply(this,arguments)}const Wo=["children","options"],zo="0",Uo="1",Vo="2",Qo="3",qo="4",Ko="5",$o="6",jo="7",Jo="8",Zo="9",Yo="10",Xo="11",ei="12",ti="13",ni="14",oi="15",ii="16",ri="17",ai="18",si="19",li="20",ci="21",di="22",pi="23",ui="24",hi="25",mi="26",gi="27",fi="28",bi="29",yi="30",_i="31",Ci="32",vi="33";var xi,Si;(Si=xi||(xi={}))[Si.MAX=0]="MAX",Si[Si.HIGH=1]="HIGH",Si[Si.MED=2]="MED",Si[Si.LOW=3]="LOW",Si[Si.MIN=4]="MIN";const ki=["allowFullScreen","allowTransparency","autoComplete","autoFocus","autoPlay","cellPadding","cellSpacing","charSet","className","classId","colSpan","contentEditable","contextMenu","crossOrigin","encType","formAction","formEncType","formMethod","formNoValidate","formTarget","frameBorder","hrefLang","inputMode","keyParams","keyType","marginHeight","marginWidth","maxLength","mediaGroup","minLength","noValidate","radioGroup","readOnly","rowSpan","spellCheck","srcDoc","srcLang","srcSet","tabIndex","useMap"].reduce(((e,t)=>(e[t.toLowerCase()]=t,e)),{for:"htmlFor"}),Pi={amp:"&",apos:"'",gt:">",lt:"<",nbsp:"",quot:""},Ei=["style","script"],Ti=/([-A-Z0-9_:]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|(?:\{((?:\\.|{[^}]*?}|[^}])*)\})))?/gi,wi=/mailto:/i,Ii=/\n{2,}$/,Di=/^(\s*>[\s\S]*?)(?=\n{2,})/,Ri=/^ *> ?/gm,Ai=/^ {2,}\n/,Oi=/^(?:( *[-*_])){3,} *(?:\n *)+\n/,Mi=/^\s*(`{3,}|~{3,}) *(\S+)?([^\n]*?)?\n([\s\S]+?)\s*\1 *(?:\n *)*\n?/,Ni=/^(?: {4}[^\n]+\n*)+(?:\n *)+\n?/,Bi=/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/,Fi=/^(?:\n *)*\n/,Gi=/\r\n?/g,Li=/^\[\^([^\]]+)](:(.*)((\n+ {4,}.*)|(\n(?!\[\^).+))*)/,Hi=/^\[\^([^\]]+)]/,Wi=/\f/g,zi=/^---[ \t]*\n(.|\n)*\n---[ \t]*\n/,Ui=/^\s*?\[(x|\s)\]/,Vi=/^ *(#{1,6}) *([^\n]+?)(?: +#*)?(?:\n *)*(?:\n|$)/,Qi=/^ *(#{1,6}) +([^\n]+?)(?: +#*)?(?:\n *)*(?:\n|$)/,qi=/^([^\n]+)\n *(=|-){3,} *(?:\n *)+\n/,Ki=/^ *(?!<[a-z][^ >/]* ?\/>)<([a-z][^ >/]*) ?((?:[^>]*[^/])?)>\n?(\s*(?:<\1[^>]*?>[\s\S]*?<\/\1>|(?!<\1\b)[\s\S])*?)<\/\1>(?!<\/\1>)\n*/i,$i=/&([a-z0-9]+|#[0-9]{1,6}|#x[0-9a-fA-F]{1,6});/gi,ji=/^<!--[\s\S]*?(?:-->)/,Ji=/^(data|aria|x)-[a-z_][a-z\d_.-]*$/,Zi=/^ *<([a-z][a-z0-9:]*)(?:\s+((?:<.*?>|[^>])*))?\/?>(?!<\/\1>)(\s*\n)?/i,Yi=/^\{.*\}$/,Xi=/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,er=/^<([^ >]+@[^ >]+)>/,tr=/^<([^ >]+:\/[^ >]+)>/,nr=/-([a-z])?/gi,or=/^(.*\|.*)\n(?: *(\|? *[-:]+ *\|[-| :]*)\n((?:.*\|.*\n)*))?\n?/,ir=/^\[([^\]]*)\]:\s+<?([^\s>]+)>?\s*("([^"]*)")?/,rr=/^!\[([^\]]*)\] ?\[([^\]]*)\]/,ar=/^\[([^\]]*)\] ?\[([^\]]*)\]/,sr=/(\[|\])/g,lr=/(\n|^[-*]\s|^#|^ {2,}|^-{2,}|^>\s)/,cr=/\t/g,dr=/(^ *\||\| *$)/g,pr=/^ *:-+: *$/,ur=/^ *:-+ *$/,hr=/^ *-+: *$/,mr="((?:\\[.*?\\][([].*?[)\\]]|<.*?>(?:.*?<.*?>)?|`.*?`|~~.*?~~|==.*?==|.|\\n)*?)",gr=new RegExp(`^([*_])\\1${mr}\\1\\1(?!\\1)`),fr=new RegExp(`^([*_])${mr}\\1(?!\\1|\\w)`),br=new RegExp(`^==${mr}==`),yr=new RegExp(`^~~${mr}~~`),_r=/^\\([^0-9A-Za-z\s])/,Cr=/^[\s\S]+?(?=[^0-9A-Z\s\u00c0-\uffff&#;.()'"]|\d+\.|\n\n| {2,}\n|\w+:\S|$)/i,vr=/^\n+/,xr=/^([ \t]*)/,Sr=/\\([^\\])/g,kr=/ *\n+$/,Pr=/(?:^|\n)( *)$/,Er="(?:\\d+\\.)",Tr="(?:[*+-])";function wr(e){return"( *)("+(1===e?Er:Tr)+") +"}const Ir=wr(1),Dr=wr(2);function Rr(e){return new RegExp("^"+(1===e?Ir:Dr))}const Ar=Rr(1),Or=Rr(2);function Mr(e){return new RegExp("^"+(1===e?Ir:Dr)+"[^\\n]*(?:\\n(?!\\1"+(1===e?Er:Tr)+" )[^\\n]*)*(\\n|$)","gm")}const Nr=Mr(1),Br=Mr(2);function Fr(e){const t=1===e?Er:Tr;return new RegExp("^( *)("+t+") [\\s\\S]+?(?:\\n{2,}(?! )(?!\\1"+t+" (?!"+t+" ))\\n*|\\s*\\n*$)")}const Gr=Fr(1),Lr=Fr(2);function Hr(e,t){const n=1===t,o=n?Gr:Lr,i=n?Nr:Br,r=n?Ar:Or;return{match(e,t,n){const i=Pr.exec(n);return i&&(t.list||!t.inline&&!t.simple)?o.exec(e=i[1]+e):null},order:1,parse(e,t,o){const a=n?+e[2]:void 0,s=e[0].replace(Ii,"\n").match(i);let l=!1;return{items:s.map((function(e,n){const i=r.exec(e)[0].length,a=new RegExp("^ {1,"+i+"}","gm"),c=e.replace(a,"").replace(r,""),d=n===s.length-1,p=-1!==c.indexOf("\n\n")||d&&l;l=p;const u=o.inline,h=o.list;let m;o.list=!0,p?(o.inline=!1,m=c.replace(kr,"\n\n")):(o.inline=!0,m=c.replace(kr,""));const g=t(m,o);return o.inline=u,o.list=h,g})),ordered:n,start:a}},render:(t,n,o)=>e(t.ordered?"ol":"ul",{key:o.key,start:t.type===li?t.start:void 0},t.items.map((function(t,i){return e("li",{key:i},n(t,o))})))}}const Wr=new RegExp("^\\[((?:\\[[^\\]]*\\]|[^\\[\\]]|\\](?=[^\\[]*\\]))*)\\]\\(\\s*<?((?:\\([^)]*\\)|[^\\s\\\\]|\\\\.)*?)>?(?:\\s+['\"]([\\s\\S]*?)['\"])?\\s*\\)"),zr=/^!\[(.*?)\]\( *((?:\([^)]*\)|[^() ])*) *"?([^)"]*)?"?\)/,Ur=[Di,Mi,Ni,Vi,qi,Qi,ji,or,Nr,Gr,Br,Lr],Vr=[...Ur,/^[^\n]+(?:  \n|\n{2,})/,Ki,Zi];function Qr(e){return e.replace(/[]/g,"a").replace(/[]/g,"c").replace(/[]/g,"d").replace(/[]/g,"e").replace(/[]/g,"i").replace(/[]/g,"n").replace(/[]/g,"o").replace(/[]/g,"u").replace(/[]/g,"y").replace(/[^a-z0-9- ]/gi,"").replace(/ /gi,"-").toLowerCase()}function qr(e){return hr.test(e)?"right":pr.test(e)?"center":ur.test(e)?"left":null}function Kr(e,t,n,o){const i=n.inTable;n.inTable=!0;let r=e.trim().split(/( *(?:`[^`]*`|<.*?>.*?<\/.*?>(?!<\/.*?>)|\\\||\|) *)/).reduce(((e,i)=>("|"===i.trim()?e.push(o?{type:mi}:{type:gi,text:i}):""!==i&&e.push.apply(e,t(i,n)),e)),[]);n.inTable=i;let a=[[]];return r.forEach((function(e,t){e.type===mi?0!==t&&t!==r.length-1&&a.push([]):(e.type!==gi||null!=r[t+1]&&r[t+1].type!==mi||(e.text=e.text.trimEnd()),a[a.length-1].push(e))})),a}function $r(e,t,n){n.inline=!0;const o=e[2]?e[2].replace(dr,"").split("|").map(qr):[],i=e[3]?function(e,t,n){return e.trim().split("\n").map((function(e){return Kr(e,t,n,!0)}))}(e[3],t,n):[],r=Kr(e[1],t,n,!!i.length);return n.inline=!1,i.length?{align:o,cells:i,header:r,type:hi}:{children:r,type:ci}}function jr(e,t){return null==e.align[t]?{}:{textAlign:e.align[t]}}function Jr(e){return function(t,n){return n.inline?e.exec(t):null}}function Zr(e){return function(t,n){return n.inline||n.simple?e.exec(t):null}}function Yr(e){return function(t,n){return n.inline||n.simple?null:e.exec(t)}}function Xr(e){return function(t){return e.exec(t)}}function ea(e,t,n){if(t.inline||t.simple)return null;if(n&&!n.endsWith("\n"))return null;let o="";e.split("\n").every((e=>!Ur.some((t=>t.test(e)))&&(o+=e+"\n",e.trim())));const i=o.trimEnd();return""==i?null:[o,i]}function ta(e){try{if(decodeURIComponent(e).replace(/[^A-Za-z0-9/:]/g,"").match(/^\s*(javascript|vbscript|data(?!:image)):/i))return null}catch(e){return null}return e}function na(e){return e.replace(Sr,"$1")}function oa(e,t,n){const o=n.inline||!1,i=n.simple||!1;n.inline=!0,n.simple=!0;const r=e(t,n);return n.inline=o,n.simple=i,r}function ia(e,t,n){const o=n.inline||!1,i=n.simple||!1;n.inline=!1,n.simple=!0;const r=e(t,n);return n.inline=o,n.simple=i,r}function ra(e,t,n){const o=n.inline||!1;n.inline=!1;const i=e(t,n);return n.inline=o,i}const aa=(e,t,n)=>({children:oa(t,e[1],n)});function sa(){return{}}function la(){return null}function ca(...e){return e.filter(Boolean).join(" ")}function da(e,t,n){let o=e;const i=t.split(".");for(;i.length&&(o=o[i[0]],void 0!==o);)i.shift();return o||n}function pa(e="",t={}){function n(e,n,...o){const i=da(t.overrides,`${e}.props`,{});return t.createElement(function(e,t){const n=da(t,e);return n?"function"==typeof n||"object"==typeof n&&"render"in n?n:da(t,`${e}.component`,e):e}(e,t.overrides),Ho({},n,i,{className:ca(null==n?void 0:n.className,i.className)||void 0}),...o)}function o(e){e=e.replace(zi,"");let o=!1;t.forceInline?o=!0:t.forceBlock||(o=!1===lr.test(e));const i=c(l(o?e:`${e.trimEnd().replace(vr,"")}\n\n`,{inline:o}));for(;"string"==typeof i[i.length-1]&&!i[i.length-1].trim();)i.pop();if(null===t.wrapper)return i;const r=t.wrapper||(o?"span":"div");let a;if(i.length>1||t.forceWrapper)a=i;else{if(1===i.length)return a=i[0],"string"==typeof a?n("span",{key:"outer"},a):a;a=null}return y.createElement(r,{key:"outer"},a)}function i(e,n){const i=n.match(Ti);return i?i.reduce((function(n,i,r){const a=i.indexOf("=");if(-1!==a){const s=function(e){return-1!==e.indexOf("-")&&null===e.match(Ji)&&(e=e.replace(nr,(function(e,t){return t.toUpperCase()}))),e}(i.slice(0,a)).trim(),l=function(e){const t=e[0];return('"'===t||"'"===t)&&e.length>=2&&e[e.length-1]===t?e.slice(1,-1):e}(i.slice(a+1).trim()),c=ki[s]||s,d=n[c]=function(e,t,n,o){return"style"===t?n.split(/;\s?/).reduce((function(e,t){const n=t.slice(0,t.indexOf(":"));return e[n.trim().replace(/(-[a-z])/g,(e=>e[1].toUpperCase()))]=t.slice(n.length+1).trim(),e}),{}):"href"===t||"src"===t?o(n,e,t):(n.match(Yi)&&(n=n.slice(1,n.length-1)),"true"===n||"false"!==n&&n)}(e,s,l,t.sanitizer);"string"==typeof d&&(Ki.test(d)||Zi.test(d))&&(n[c]=y.cloneElement(o(d.trim()),{key:r}))}else"style"!==i&&(n[ki[i]||i]=!0);return n}),{}):null}t.overrides=t.overrides||{},t.sanitizer=t.sanitizer||ta,t.slugify=t.slugify||Qr,t.namedCodesToUnicode=t.namedCodesToUnicode?Ho({},Pi,t.namedCodesToUnicode):Pi,t.createElement=t.createElement||y.createElement;const r=[],a={},s={[zo]:{match:Yr(Di),order:1,parse:(e,t,n)=>({children:t(e[0].replace(Ri,""),n)}),render:(e,t,o)=>n("blockquote",{key:o.key},t(e.children,o))},[Uo]:{match:Xr(Ai),order:1,parse:sa,render:(e,t,o)=>n("br",{key:o.key})},[Vo]:{match:Yr(Oi),order:1,parse:sa,render:(e,t,o)=>n("hr",{key:o.key})},[Qo]:{match:Yr(Ni),order:0,parse:e=>({lang:void 0,text:e[0].replace(/^ {4}/gm,"").replace(/\n+$/,"")}),render:(e,t,o)=>n("pre",{key:o.key},n("code",Ho({},e.attrs,{className:e.lang?`lang-${e.lang}`:""}),e.text))},[qo]:{match:Yr(Mi),order:0,parse:e=>({attrs:i("code",e[3]||""),lang:e[2]||void 0,text:e[4],type:Qo})},[Ko]:{match:Zr(Bi),order:3,parse:e=>({text:e[2]}),render:(e,t,o)=>n("code",{key:o.key},e.text)},[$o]:{match:Yr(Li),order:0,parse:e=>(r.push({footnote:e[2],identifier:e[1]}),{}),render:la},[jo]:{match:Jr(Hi),order:1,parse:e=>({target:`#${t.slugify(e[1],Qr)}`,text:e[1]}),render:(e,o,i)=>n("a",{key:i.key,href:t.sanitizer(e.target,"a","href")},n("sup",{key:i.key},e.text))},[Jo]:{match:Jr(Ui),order:1,parse:e=>({completed:"x"===e[1].toLowerCase()}),render:(e,t,o)=>n("input",{checked:e.completed,key:o.key,readOnly:!0,type:"checkbox"})},[Zo]:{match:Yr(t.enforceAtxHeadings?Qi:Vi),order:1,parse:(e,n,o)=>({children:oa(n,e[2],o),id:t.slugify(e[2],Qr),level:e[1].length}),render:(e,t,o)=>n(`h${e.level}`,{id:e.id,key:o.key},t(e.children,o))},[Yo]:{match:Yr(qi),order:0,parse:(e,t,n)=>({children:oa(t,e[1],n),level:"="===e[2]?1:2,type:Zo})},[Xo]:{match:Xr(Ki),order:1,parse(e,t,n){const[,o]=e[3].match(xr),r=new RegExp(`^${o}`,"gm"),a=e[3].replace(r,""),s=(l=a,Vr.some((e=>e.test(l)))?ra:oa);var l;const c=e[1].toLowerCase(),d=-1!==Ei.indexOf(c),p=(d?c:e[1]).trim(),u={attrs:i(p,e[2]),noInnerParse:d,tag:p};return n.inAnchor=n.inAnchor||"a"===c,d?u.text=e[3]:u.children=s(t,a,n),n.inAnchor=!1,u},render:(e,t,o)=>n(e.tag,Ho({key:o.key},e.attrs),e.text||t(e.children,o))},[ti]:{match:Xr(Zi),order:1,parse(e){const t=e[1].trim();return{attrs:i(t,e[2]||""),tag:t}},render:(e,t,o)=>n(e.tag,Ho({},e.attrs,{key:o.key}))},[ei]:{match:Xr(ji),order:1,parse:()=>({}),render:la},[ni]:{match:Zr(zr),order:1,parse:e=>({alt:e[1],target:na(e[2]),title:e[3]}),render:(e,o,i)=>n("img",{key:i.key,alt:e.alt||void 0,title:e.title||void 0,src:t.sanitizer(e.target,"img","src")})},[oi]:{match:Jr(Wr),order:3,parse:(e,t,n)=>({children:ia(t,e[1],n),target:na(e[2]),title:e[3]}),render:(e,o,i)=>n("a",{key:i.key,href:t.sanitizer(e.target,"a","href"),title:e.title},o(e.children,i))},[ii]:{match:Jr(tr),order:0,parse:e=>({children:[{text:e[1],type:gi}],target:e[1],type:oi})},[ri]:{match:(e,t)=>t.inAnchor?null:Jr(Xi)(e,t),order:0,parse:e=>({children:[{text:e[1],type:gi}],target:e[1],title:void 0,type:oi})},[ai]:{match:Jr(er),order:0,parse(e){let t=e[1],n=e[1];return wi.test(n)||(n="mailto:"+n),{children:[{text:t.replace("mailto:",""),type:gi}],target:n,type:oi}}},[li]:Hr(n,1),[vi]:Hr(n,2),[si]:{match:Yr(Fi),order:3,parse:sa,render:()=>"\n"},[ci]:{match:ea,order:3,parse:aa,render:(e,t,o)=>n("p",{key:o.key},t(e.children,o))},[di]:{match:Jr(ir),order:0,parse:e=>(a[e[1]]={target:e[2],title:e[4]},{}),render:la},[pi]:{match:Zr(rr),order:0,parse:e=>({alt:e[1]||void 0,ref:e[2]}),render:(e,o,i)=>a[e.ref]?n("img",{key:i.key,alt:e.alt,src:t.sanitizer(a[e.ref].target,"img","src"),title:a[e.ref].title}):null},[ui]:{match:Jr(ar),order:0,parse:(e,t,n)=>({children:t(e[1],n),fallbackChildren:t(e[0].replace(sr,"\\$1"),n),ref:e[2]}),render:(e,o,i)=>a[e.ref]?n("a",{key:i.key,href:t.sanitizer(a[e.ref].target,"a","href"),title:a[e.ref].title},o(e.children,i)):n("span",{key:i.key},o(e.fallbackChildren,i))},[hi]:{match:Yr(or),order:1,parse:$r,render(e,t,o){const i=e;return n("table",{key:o.key},n("thead",null,n("tr",null,i.header.map((function(e,r){return n("th",{key:r,style:jr(i,r)},t(e,o))})))),n("tbody",null,i.cells.map((function(e,r){return n("tr",{key:r},e.map((function(e,r){return n("td",{key:r,style:jr(i,r)},t(e,o))})))}))))}},[gi]:{match:Xr(Cr),order:4,parse:e=>({text:e[0].replace($i,((e,n)=>t.namedCodesToUnicode[n]?t.namedCodesToUnicode[n]:e))}),render:e=>e.text},[fi]:{match:Zr(gr),order:2,parse:(e,t,n)=>({children:t(e[2],n)}),render:(e,t,o)=>n("strong",{key:o.key},t(e.children,o))},[bi]:{match:Zr(fr),order:3,parse:(e,t,n)=>({children:t(e[2],n)}),render:(e,t,o)=>n("em",{key:o.key},t(e.children,o))},[yi]:{match:Zr(_r),order:1,parse:e=>({text:e[1],type:gi})},[_i]:{match:Zr(br),order:3,parse:aa,render:(e,t,o)=>n("mark",{key:o.key},t(e.children,o))},[Ci]:{match:Zr(yr),order:3,parse:aa,render:(e,t,o)=>n("del",{key:o.key},t(e.children,o))}};!0===t.disableParsingRawHTML&&(delete s[Xo],delete s[ti]);const l=function(e){let t=Object.keys(e);function n(o,i){let r=[],a="";for(;o;){let s=0;for(;s<t.length;){const l=t[s],c=e[l],d=c.match(o,i,a);if(d){const e=d[0];o=o.substring(e.length);const t=c.parse(d,n,i);null==t.type&&(t.type=l),r.push(t),a=e;break}s++}}return r}return t.sort((function(t,n){let o=e[t].order,i=e[n].order;return o!==i?o-i:t<n?-1:1})),function(e,t){return n(function(e){return e.replace(Gi,"\n").replace(Wi,"").replace(cr,"    ")}(e),t)}}(s),c=(d=function(e,t){return function(n,o,i){const r=e[n.type].render;return t?t((()=>r(n,o,i)),n,o,i):r(n,o,i)}}(s,t.renderRule),function e(t,n={}){if(Array.isArray(t)){const o=n.key,i=[];let r=!1;for(let o=0;o<t.length;o++){n.key=o;const a=e(t[o],n),s="string"==typeof a;s&&r?i[i.length-1]+=a:null!==a&&i.push(a),r=s}return n.key=o,i}return d(t,e,n)});var d;const p=o(e);return r.length?n("div",null,p,n("footer",{key:"footer"},r.map((function(e){return n("div",{id:t.slugify(e.identifier,Qr),key:e.identifier},e.identifier,c(l(e.footnote,{inline:!0})))})))):p}const ua=e=>{let{children:t="",options:n}=e,o=function(e,t){if(null==e)return{};var n,o,i={},r=Object.keys(e);for(o=0;o<r.length;o++)t.indexOf(n=r[o])>=0||(i[n]=e[n]);return i}(e,Wo);return y.cloneElement(pa(t,n),o)};var ha=n(58651);const ma=({message:e,messageId:t,shouldExpandMessage:n,onMessageExpanded:o,onInsertText:i,removePinnedMessage:r})=>{const a=Jn(),[s,l]=y.useState(n),c=()=>{l(!s),o?.(t||0)};return y.useEffect((()=>{ha.log("PinnedMessageUI mounted"),l(n)}),[n]),s?y.createElement(Ao.Z,{size:"small",className:a.PinCardsStyle},y.createElement(Yn,{id:t||0,content:e||"",addButtonProps:{text:"Insert",onClick:()=>{ha.log("Insert button clicked"),i?.(e||"")},icon:y.createElement(g.m61,null)},...Xn((e=>{ha.log("Regenerate response clicked, message: ",e)})),copyButtonProps:{text:"Copy",onClick:()=>{ha.log("Copy button clicked"),navigator.clipboard.writeText(e||"")},icon:y.createElement(f.Qvr,null)},pinButtonProps:{text:"Pin",onClick:()=>{r(e,t)},icon:y.createElement(b.BMy,{color:"#185ABD"})}})):y.createElement(Ao.Z,{size:"small",className:a.showMoreCardStyle},y.createElement("span",{className:a.pinnedMessageStyle},y.createElement(ua,null,e||"")),y.createElement(Lo.N,{onClick:c},"Read more"))};var ga=n(58651);const fa=({alSession:e,onInsertString:t,theme:n,isTestApp:i,isRehydrationEnabled:s,canvasDataProps:d,isDemoMode:p,isZqmEnabled:u=!1,isLoopEnabled:h=!1})=>{const m=y.useRef(null),g=Co(),[_,C]=y.useState({shouldShowEntityPicker:!1,hvcEntityPickerPropsValue:en()}),[v,x]=y.useState([]),[S,k]=y.useState([]),[P,E]=y.useState(p||!1),[T,w]=y.useState(io.String),[I,D]=y.useState(!0),R=()=>{z.isAccordionOpen=!z.isAccordionOpen,ga.log("DEBUGLOG: isAccordianOpen",z.isAccordionOpen)},A=e=>t(e);y.useEffect((()=>{s||(localStorage.removeItem(no.PinnedMessages),localStorage.removeItem(no.GroundingFiles))}),[]);const[O,M]=y.useState(!1);y.useEffect((()=>{if(_.hvcEntityPickerPropsValue.list.length>0){const e={id:9e5,list:_.hvcEntityPickerPropsValue.list||[],shouldShowEntityPicker:_.shouldShowEntityPicker};ao.saveItem(no.GroundingFiles,e)}}),[_]);const N=Jn(),B=y.useCallback(((e,t)=>{x((e=>e.filter((e=>e.id!==t)))),void 0!==t&&ao.deleteItem(no.PinnedMessages,t)}),[]),F=y.useCallback(((e,t)=>y.createElement(ma,{message:e,messageId:t,onInsertText:e=>{A(e)},removePinnedMessage:(e,t)=>{B(e,t)}})),[A,B]),G=y.useCallback(((e,t)=>{if(v.some((e=>e.id===t)))return;const n={id:t||0,content:F(e,t||0)};x((e=>[...e,n])),ao.saveItem(no.PinnedMessages,{id:t||0,content:e||""})}),[F,v]),z=yo.getInstance(e,C,m,A,k,d.onCanvasDataRequested,D,h),[U,V]=y.useState(!1),[Q,q]=y.useState(!1);y.useEffect((()=>()=>{z.cleanup()}),[]),y.useEffect((()=>{z.setAddPinnedMessageCallback(G),z.setDemoMode(P??!1)}),[G,z,P]),y.useEffect((()=>{const e=ao.getItems(no.PinnedMessages);if(0===v.length&&e.length>0){const t=e.map((e=>({id:e.id,content:F(e.content,e.id)})));x(t)}}),[F,v.length]);const K=y.useMemo((()=>({component:y.createElement(y.Fragment,null,(0,W.p)(_.hvcEntityPickerPropsValue)),isShown:_.shouldShowEntityPicker})),[_]);ga.log("Supply the addPinnedMessage  function in the callback for adding to pinned messages",G);const $={checked:P||!1,disabled:!1,onChange:(e,t)=>{ga.log("demoModeToggle onChange called",t,e),E(!!e?.target?.checked)},label:"Demo Mode"},j={checked:U,disabled:!1,onChange:(e,t)=>{ga.log("artifactContentEnabledToggle onChange called",t,e);const n=!!e?.target?.checked;V(n),z.onArtifactContentStateChanged(n)},label:"Artifacts Enabled"},J={checked:Q,disabled:!1,onChange:(e,t)=>{ga.log("streamingEnabledToggle onChange called",t,e);const n=!!e?.target?.checked;q(n),z.onStreamingStateChanged(n)},label:"Streaming Enabled"},Z=[{key:io.String,text:"String"},{key:io.CipTree,text:"Cip Tree"},{key:io.CipTreeSummary,text:"Cip Tree Summary"}],Y=y.createElement(o.B,{tokens:{childrenGap:8}},y.createElement(Kt.J,{htmlFor:"fileContentFetchFormat"},"File Content Fetch Format"),y.createElement(Ht,{id:"fileContentFetchFormat",selectedKey:T,onChange:(e,t)=>{t&&(w(t.key),z.onFileContentFetchFormatChanged(t.key))},options:Z}));return e?y.createElement(L.zn,{style:g,getHeaderElement:()=>(ga.log("DEBUG: getHeaderElement called"),y.createElement(o.B,{className:`${N.cardGap} ${N.headerStyle}`},y.createElement(o.B,{horizontal:!0,className:`${N.toggleStyle}`},y.createElement(Wt.M,null,y.createElement(zt.$,null,y.createElement(r.W,null,y.createElement(a.c,{disableButtonEnhancement:!0},y.createElement(Ut.I,{icon:y.createElement(Qt.wMk,null),appearance:"subtle"})),y.createElement(l.b,null,y.createElement(c.c,null,y.createElement(Vt.v,null,y.createElement(qt.A,{...J})),y.createElement(Vt.v,null,h&&y.createElement(qt.A,{...j})),y.createElement(Vt.v,null,Y)))))),I&&y.createElement(qt.A,{...$})),_.shouldShowEntityPicker&&y.createElement(Go,{contentList:[K.component],title:"Files",handleOnToggle:R,HeaderIcon:y.createElement(f.tXb,null),itemCounterText:_.hvcEntityPickerPropsValue.list?.length||0}),y.createElement(Go,{contentList:v.map((e=>y.createElement(y.Fragment,null,e.content))),HeaderIcon:y.createElement(b.MtV,null),handleOnToggle:R,title:"Pinned Responses",itemCounterText:v?.length||0}))),chatUiProps:{chatInputV2Props:{pluginsInfo:[],chatPlaceholderMessage:"Start typing here...",editorConfig:Yt},zeroQueryMessageV2Props:O?{promptSuggestionList:[{suggestionCategory:"Add Files",suggestionText:"Create a synopsis based on [File]",iconRegular:f.Bc8,shouldLaunchCIQOnSelection:!0,scopedEntity:H.ck.File,notifyClientOnZQMClicked:e=>{M(!1&&u),ga.log("Zero Query Message clicked, ",e)}}]}:void 0,changeTopicUiProps:{hideChangeTopicButton:!0},freUiProps:{...Xt,getStartedButtonText:P?Xt.getStartedButtonText:"Get Started",onGetStartedButtonClicked(){D(!1),P?(z.addDemoFiles(),k([tn])):z.fillEntityPickerProps(!0,en())}},suggestionPillsUiProps:{suggestionList:S}},copilotCommunicationHandler:z,useALRuntime:!!i,ref:m,firstHeaderComponent:K,theme:n,hostAppAuthTokens:{graphTokenProvider:async e=>({accessToken:"",expirationTime:(new Date).getTime()+36e5}),sharepointTokenProvider:async e=>({accessToken:"",expirationTime:(new Date).getTime()+36e5})}}):(ga.log("alSession is required"),y.createElement(y.Fragment,null))}},84743:(e,t,n)=>{e.exports=n.p+"assets/research-illustration.svg"}}]);
//# sourceMappingURL=researchworkspace.js.map