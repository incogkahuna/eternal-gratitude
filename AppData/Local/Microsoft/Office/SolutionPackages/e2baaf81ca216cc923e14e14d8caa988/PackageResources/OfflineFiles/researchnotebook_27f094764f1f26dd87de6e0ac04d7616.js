/*! For license information please see researchnotebook.js.LICENSE.txt */
"use strict";(self.webpackChunkTypeScriptModule=self.webpackChunkTypeScriptModule||[]).push([[4487],{9150:(e,t,o)=>{o.d(t,{cd:()=>C,a2:()=>x,Xx:()=>u,kt:()=>v,iV:()=>E,AQ:()=>z,Z1:()=>m,iF:()=>g,RL:()=>h,H_:()=>k,uH:()=>S,a0:()=>w,jN:()=>b,pt:()=>B,Cg:()=>N,cu:()=>y});var a=o(53910),r=o(97808),n=o(66166),i=o(24060),l=o(61600),s=o(8520),d=o(15443);const c=({onClick:e})=>{const t=(0,d.mS)();return s.createElement(i.$,{icon:s.createElement(l.$zk,null),onClick:e,className:t.addButtons},"Add Files")};var p=o(58651);const u="Copilot Research",m="https://res-2-sdf.cdn.office.net/files/fabric-cdn-prod_20240411.001/assets/brand-icons/product/svg/copilot_24x1.svg",f=[a.ck.File],g={settings:{hostAppId:"Word_Online",hostAppName:"Word",hostAppPlatform:"Web",hostAppScenario:"AppChatCopilot",hostDefaultLocale:"en-US",isDogfoodEnvironment:!0,appVersion:"1.0.0",customizedEmptyECCSuggestionsString:"I can't find that file right now. Check the name of the file, or try again in a bit."},telemLogger:{logError:e=>{p.log("CIQ Error Log: ",e)}},transformFileMenuTitle:"Suggestions",transformFilePlaceholderText:"Keep typing to search for your files",entitiesSupported:f,isExpandedECCEnabled:!0,ciqPlaceholderText:"Start Typing to search",featureFlags:{enableAppGptsInCiq:!0,enableAppPluginsInCiq:!0,enableTopicECC:!0}},h=()=>{const e={...r.Xt};return e.list=[],e.headerDescription="",e.addAnotherEntityProps&&e.addAnotherEntityProps.editorConfiguration&&(e.addAnotherEntityProps.editorConfiguration.entitiesEnabled=f,e.addAnotherEntityProps.editorConfiguration.appScenario="Copilot"),e.addEntityButtonText="Add Files",e.AddEntityButton=c,e},b=(n.GB.get("docx"),n.GB.get("pptx"),n.GB.get("docx"),n.GB.get("docx"),n.GB.get("docx"),n.GB.get("docx"),!1),x="1738764451731",v={pageTitle:"Welcome to Copilot Research",inputBoxPlaceholder:"Create a new copilot research",myFiles:"My Researches",createNew:"Create New",deleteAll:"Delete All",createNewTooltip:"Create a new research",deleteAllTooltip:"Delete all researches",gridViewTooltip:"Switch to grid view",listViewTooltip:"Switch to list view",deleteConfirmationTitle:"Confirm Deletion",deleteConfirmationContent:"Are you sure you want to delete all researches? This action cannot be undone.",deleteConfirmationButton:"Delete All"},y={ADD_NOTE:"Add Note",STUDY_GUIDE:"Study Guide",RESEARCH_GUIDE:"Research Guide",FAQS:"FAQs",SUMMARIZE:"Summarize",TIMELINE:"Timeline",DELETE_ALL_NOTES:"Delete All Notes",CONVERT_ALL_NOTES_TO_SOURCE:"Convert All Notes to Source"},w="Copilot Research Agent",k="This is an agent curated based on the content from the selected file sources.",S="Provide accurate information about the content in the selected files and reply in a formal tone. User will ask queries from the selected files. It can be to summarize the content, or any question. Try your level best to find the answer from the selected files. If not available, then and then only search outside. If answer is not found in given files, explicitly mention that the answer is not available in the selected files, then give your rest of the answer.",B="Click Add Files above to add pdfs, docx, ppts and more ",N="or click on Add Mails/Chats to add all mails/chats related to a topic.",C=e=>`\nReview my emails and Teams messages of past 7 days related to the following topics:\n\nTOPICS:\n${e.map((e=>`- ${e}`)).join("\n")}\n\nFirst, extract and provide key highlights from these communications (documents provided and chats and mail based on the topic given), focusing on:\n1. Important requests or questions directed to me\n2. Deadlines, milestones, or upcoming events\n3. Decisions that need my input or approval\n4. Unresolved discussions or pending items\n5. Recent updates on ongoing projects\n\nThen, based on these communications, please please identify necessary actions and provide them as a valid JSON response. Don't give any explicit title to this section. Also even if no actions are needed, provide a summary of the key highlights.\n\nYour response should have two parts:\n\n1. Key highlights from my communications of past 7 days about and topics (in markdown format)\n2. A JSON response with recommended actions, structured exactly as specified below and wrapped with <JSON_START> and <JSON_END> tags, dont give any explicit title to this section.\n\n## JSON Structure:\n<JSON_START>\n{\n  "summary": "Brief overview of recommended actions",\n  "actions": [\n    {\n      "type": "email_reply" | "teams_reply" | "todo" | "ado_work_item" | "meeting_schedule" | "follow_up",\n      "priority": "high" | "medium" | "low",\n      "reason": "Explanation for why this action is needed",\n      "context": {\n        // For email_reply\n        "toEmail": ["recipient@microsoft.com"],\n        "toNames": ["Recipient Name"],\n        "subject": "Subject line",\n        "draftContent": "Suggested email content that reflects the original sender's voice and intent",\n\n        // For teams_reply\n        "recipient": "Person Name",\n        "channel": "Channel name",\n        "messageContent": "Suggested message content that reflects the original sender's voice and intent",\n\n        // For todo\n        "task": "Task description",\n        "dueDate": "2025-03-15", // ISO format date\n        "notes": "Additional notes",\n\n        // For ado_work_item\n        "title": "Work item title",\n        "description": "Work item description",\n        "assignee": "recipient@microsoft.com",\n        "workItemType": "bug" | "task" | "user story" | "feature",\n\n        // For meeting_schedule\n        "attendees": ["attendee1@microsoft.com", "attendee2@microsoft.com"],\n        "proposedTimes": ["2025-03-15T14:00:00Z", "2025-03-16T10:00:00Z"], // ISO format dates\n        "agenda": "Meeting agenda",\n        "duration": 30, // minutes\n\n        // For follow_up\n        "contactPerson": "Contact Name",\n        "followUpDate": "2025-03-15", // ISO format date\n        "topic": "Follow-up topic",\n        "details": "Details about the follow-up"\n      },\n      "relatedCommunicationDetails": {\n        "sender": "Sender Name <sender@microsoft.com>",\n        "timestamp": "2025-03-01T10:30:00Z",\n        "subject": "Original message subject or context"\n      }\n    }\n    // Additional actions as needed\n  ]\n}\n<JSON_END>\n\n## RULES:\n- Always search from enterprise\n- ENSURE all email addresses and names of persons are complete and accurate. THIS IS VERY IMPORTANT\n- Include proper full email addresses from enterprise (e.g., alias@microsoft.com) for all people mentioned\n- Include only actions that are clearly needed based on the communications\n- ENSURE all email addresses and names of persons are complete. THIS IS VERY IMPORTANT\n- Prioritize actions based on urgency and importance\n- For email_reply and teams_reply, draft content should match the original communication's style and NOT include signature or name at the end\n- NEVER include "Thanks," or any variation of my name at the end of drafted emails or messages\n- ALWAYS include contactPerson for follow_up actions, if empty, extract it from details\n- For meeting proposals, suggest 2-3 alternative times\n- Return an empty actions array if no clear actions are needed\n- MAKE SURE you figure out minimum 2 actions - 1 for email reply, and 1 for ado work item\n\nProvide the key highlights first in markdown format, followed by the JSON wrapped in <JSON_START> and <JSON_END> tags.\n`,E="I've created an interactive research guide based on your query. Check the Research Guide panel on the right to see your personalized research plan with steps you can explore. Click on any step to get my detailed assistance for that specific stage of your research.",z="copilot-notebooks"},15443:(e,t,o)=>{o.d(t,{Gc:()=>s,Nx:()=>u,YD:()=>f,hi:()=>m,l6:()=>d,mS:()=>g,pZ:()=>p});var a=o(80866),r=o(70877),n=o(18897),i=o(10466),l=o(80005);const s=(0,a.n)((0,r.f)({chatFreStack:{height:"calc(100vh - 300px)"},chatUiStack:{top:"20px",position:"relative"}})),d=(0,a.n)((0,n.Z)({chatCard:{boxShadow:"none",border:"none",borderRadius:"none"}})),c={borderRadius:"20px",...i.Pt.padding("16px"),backgroundColor:l.L.colorNeutralBackground1},p=(0,a.n)({container:{backgroundColor:l.L.colorNeutralBackground2,minHeight:"calc(100vh - 40px)",maxHeight:"calc(100vh - 40px)",display:"flex",flexDirection:"column",padding:"20px",overflow:"hidden"},mainheader:{width:"100%",padding:"16px 24px",fontSize:"20px",fontWeight:"bold",color:l.L.colorNeutralForeground1},content:{display:"flex",flex:1,overflow:"hidden",justifyContent:"center"},sideBarStyles:{...c,transition:"width 0.3s ease-in-out",overflow:"hidden",minWidth:"125px"},chatBarStyles:{...c,flexGrow:1,width:"40%"},toggleButton:{position:"absolute",top:"50%",transform:"translateY(-50%)",backgroundColor:l.L.colorNeutralBackground3,cursor:"pointer"},header:{alignItems:"center",justifyContent:"space-between",width:"100%",...i.Pt.padding("8px","12px")},section:{borderRadius:l.L.borderRadiusMedium,...i.Pt.padding("12px"),boxShadow:"none"},loopContainer:{...i.Pt.padding("12px")},sectionHeader:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"8px"},paneButton:{display:"flex",borderRadius:"16px",fontWeight:"normal"},editor:{...i.Pt.padding("8px"),backgroundColor:l.L.colorNeutralBackground1,borderRadius:l.L.borderRadiusMedium},divider:{flex:"0 1 auto"},dialogSurface:{position:"fixed",top:0,left:0,width:"100%",display:"block",minHeight:"20%",maxHeight:"60%",overflowY:"auto"},spinnerContainer:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},fileUploadDialog:{display:"block"},headerRightSection:{display:"flex",alignItems:"center",gap:"0.5rem"},notesContainer:{marginTop:"5px"},note:{padding:"5px",borderRadius:"8px",cursor:"pointer"},noteHover:{backgroundColor:l.L.colorNeutralBackground2},noteTitle:{fontWeight:"bold",color:l.L.colorNeutralForeground1},noteContent:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis",color:l.L.colorNeutralForeground3},emptyStateContainer:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"24px",backgroundColor:"#fafafa",borderRadius:"8px",textAlign:"center",minHeight:"240px"},emptyStateIcon:{marginBottom:"8px"}}),u=(0,a.n)({parentContainer:{display:"flex",flexDirection:"column",gap:l.L.spacingVerticalM,width:"100%",flexGrow:1,overflow:"hidden"},container:{display:"flex",flexDirection:"column",gap:l.L.spacingVerticalM,width:"100%",padding:`${l.L.spacingVerticalXS} ${l.L.spacingHorizontalXS}`},scrollableContainer:{display:"flex",flexDirection:"column",gap:l.L.spacingVerticalM,padding:`${l.L.spacingVerticalXS} ${l.L.spacingHorizontalXS}`,flexGrow:1,overflowY:"auto",overflowX:"hidden",scrollbarWidth:"thin",scrollbarColor:`${l.L.colorNeutralStroke1} ${l.L.colorNeutralBackground1}`},header:{display:"flex",alignItems:"center",fontSize:l.L.fontSizeBase400,color:l.L.colorNeutralForeground1},menuButton:{border:"none",background:"transparent",cursor:"pointer"},addNoteButton:{gap:l.L.spacingHorizontalXS,padding:"10px 16px",width:"100%",height:"36px",borderRadius:"24px",border:`1px solid ${l.L.colorNeutralStroke2}`,background:l.L.colorNeutralBackground1,fontSize:l.L.fontSizeBase300,opacity:.7,cursor:"pointer",transition:"background 0.2s",boxSizing:"border-box"},smallButtonsContainer:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px"},smallButton:{lineHeight:"1",gap:l.L.spacingHorizontalXS,padding:"10px 16px",width:"100%",height:"36px",borderRadius:"24px",opacity:.7,border:`1px solid ${l.L.colorNeutralStroke2}`,fontSize:l.L.fontSizeBase300,fontWeight:l.L.fontWeightRegular,cursor:"pointer",transition:"background 0.2s",boxSizing:"border-box"},noteCard:{display:"flex",flexDirection:"column",gap:l.L.spacingVerticalXS,padding:"12px 16px",borderRadius:"12px",background:l.L.colorNeutralBackground1,border:`1px solid ${l.L.colorNeutralStroke1}`,fontSize:"14px"},noteHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",fontWeight:l.L.fontWeightSemibold},scrollbar:{"&::-webkit-scrollbar":{width:"8px"},"&::-webkit-scrollbar-thumb":{background:l.L.colorNeutralStroke1,borderRadius:"4px"},"&::-webkit-scrollbar-track":{background:l.L.colorNeutralBackground1}},menuItem:{fontSize:l.L.fontSizeBase300,fontWeight:l.L.fontWeightRegular,color:l.L.colorNeutralForeground3,cursor:"pointer"},menuItemDisabled:{fontSize:l.L.fontSizeBase300,fontWeight:l.L.fontWeightRegular,color:l.L.colorNeutralForegroundDisabled},activeButton:{backgroundColor:l.L.colorBrandBackground,color:l.L.colorNeutralForegroundOnBrand,fontWeight:"600",boxShadow:`0 0 8px ${l.L.colorBrandBackgroundHover}`,"&:hover":{backgroundColor:l.L.colorBrandBackgroundHover}}}),m=(0,a.n)({container:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",marginTop:l.L.spacingVerticalXXL,marginBottom:l.L.spacingVerticalXXL,color:l.L.colorNeutralForeground3},icon:{fontSize:"50px",color:l.L.colorNeutralForeground3,fontWeight:"600",opacity:.8},heading:{fontSize:"14px",fontWeight:"600",color:l.L.colorNeutralForeground3,opacity:.8},subtext:{fontSize:"12px",fontWeight:"400",color:l.L.colorNeutralForeground3,textAlign:"center"}}),f=(0,a.n)({previewIframe:{display:"block",width:"100%",flexGrow:1,border:`1px solid ${l.L.colorNeutralStroke1}`}}),g=(0,a.n)({addButtons:{padding:"10px 16px",width:"100%",height:"36px",borderRadius:"24px",border:`1px solid ${l.L.colorNeutralStroke2}`,background:l.L.colorNeutralBackground1,fontSize:l.L.fontSizeBase300,opacity:.7,cursor:"pointer",transition:"background 0.2s",boxSizing:"border-box",fontWeight:l.L.fontWeightRegular},addTopicInput:{padding:"12px"}});(0,a.n)({container:{maxWidth:"800px",margin:"0 auto",padding:"20px"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},sectionCount:{marginLeft:"10px"},addSection:{marginTop:"20px"},formField:{marginBottom:"15px",display:"flex",flexDirection:"column",gap:"5px"},actionButton:{marginTop:"10px"},deleteButton:{color:l.L.colorPaletteRedForeground1},accordionHeader:{display:"flex",justifyContent:"space-between",width:"100%",alignItems:"center"},headerTitle:{display:"flex",alignItems:"center",gap:"12px"},content:{padding:"10px",lineHeight:"1.5"}})},18897:(e,t,o)=>{function a(e){return{chatCard:e.chatCard??{},suggestedQnATitle:e.suggestedQnATitle??{},suggestedQnAText:e.suggestedQnAText??{},cardContent:e.cardContent??{},tabList:e.tabList??{},tabElement:e.tabElement??{},cardFooter:e.cardFooter??{},divider:e.divider??{},copyButton:e.copyButton??{},feedbackAndDisclaimer:e.feedbackAndDisclaimer??{},showMoreButton:e.showMoreButton??{},cardWrapperCollapsed:e.cardWrapperCollapsed??{},cardWrapperExpanded:e.cardWrapperExpanded??{},cardWrapper:e.cardWrapper??{},accordionHeader:e.accordionHeader??{},title:e.title??{}}}o.d(t,{Z:()=>a})},47809:(e,t,o)=>{o.d(t,{F:()=>l,P:()=>n});var a=o(87990),r=o(15774);const n=(0,a.q)(void 0),i={size:"medium",handleToggleButton:()=>null,handleRadio:()=>null,vertical:!1,checkedValues:{}},l=e=>(0,r.i)(n,((t=i)=>e(t)))},56909:(e,t,o)=>{o.r(t),o.d(t,{COPILOT_RESEARCH:()=>a.Xx,RESEARCH_STORAGE_KEY:()=>a.AQ,ResearchApp:()=>St});var a=o(9150),r=o(8520),n=o.t(r,2),i=o(10051),l=o(66798),s=o(96010),d=o(78402),c=o(43210),p=o(58651);const u=(0,c.P2)("notebook-store",1,{upgrade(e){e.createObjectStore(a.AQ,{keyPath:"notebookId"})}}),m=e=>{const[t,o]=(0,r.useState)([]),[n,i]=(0,r.useState)(""),[l,s]=(0,r.useState)(!1);(0,r.useEffect)((()=>{(async()=>{if(e){const e=await u,t=await e.getAll(a.AQ);p.log("Fetched data from IndexedDB:",t),o(t)}else{const e=localStorage.getItem(a.AQ);e&&o(JSON.parse(e))}s(!0)})()}),[e]),(0,r.useEffect)((()=>{if(!l)return;(async()=>{if(e){p.log("Saving data to IndexedDB:",t);const e=(await u).transaction(a.AQ,"readwrite"),o=e.objectStore(a.AQ);await o.clear(),await Promise.all(t.map((async e=>{await o.add(JSON.parse(JSON.stringify({...e,notebookId:e.notebookId})))}))),await e.done,p.log("Data saved to IndexedDB")}else localStorage.setItem(a.AQ,JSON.stringify(t))})()}),[t,e,l]);const d=(0,r.useCallback)((e=>{""===e||t.find((t=>t.notebookId===e))?i(e):p.error("Notebook not found with id: ",e)}),[t]),c=(0,r.useCallback)(((e,t)=>{o((o=>o.map((o=>o.notebookId===e?{...o,notebookName:t,lastEdited:new Date}:o))))}),[]),m=(0,r.useCallback)(((e,t)=>{o((o=>o.map((o=>o.notebookId===e?{...o,notesData:[...o.notesData,t],lastEdited:new Date}:o))))}),[]),f=(0,r.useCallback)(((e,t)=>{o((o=>o.map((o=>o.notebookId===e?{...o,notesData:o.notesData.filter((e=>e.id!==t)),lastEdited:new Date}:o))))}),[]),g=(0,r.useCallback)((()=>t),[t]),h=(0,r.useCallback)((e=>{o((t=>t.map((t=>t.notebookId===e?{...t,notesData:[],lastEdited:new Date}:t))))}),[]),b=(0,r.useCallback)((e=>{o((t=>t.filter((t=>t.notebookId!==e))))}),[]),x=(0,r.useCallback)((e=>{o((t=>[...t,e]))}),[]),v=(0,r.useCallback)((e=>{o((t=>[...t,e])),i(e.notebookId)}),[]),y=(0,r.useCallback)(((e,t)=>{o((o=>o.map((o=>o.notebookId===e?{...o,sourceFiles:[...t],lastEdited:new Date}:o))))}),[]),w=(0,r.useCallback)(((e,t)=>{o((o=>o.map((o=>o.notebookId===e?{...o,notesData:o.notesData.map((e=>e.id===t.id?t:e)),lastEdited:new Date}:o))))}),[]),k=(0,r.useCallback)((()=>{o([])}),[]);return{initialDataLoaded:l,localStorageData:t,currentlySelectedNotebookId:n,updateCurrentlySelectedNotebookId:d,changeNotebookName:c,addNoteFromLocalStorage:m,removeNoteFromLocalStorage:f,removeAllNotesFromLocalStorage:h,removeNotebook:b,removeAllNotebooks:k,addNewNotebook:x,addAndOpenNewNotebook:v,updateSourceFiles:y,updateNoteFromLocalStorage:w,getAllNotebooks:g}},f=e=>{const{localStorageData:t}=m(e),[o]=(0,r.useState)("Untitled Workspace");return{generateAppName:(0,r.useCallback)((()=>{let e=o,a=1;const r=t.map((e=>e.notebookName));for(;r.includes(e);)a++,e=`${o} (${a})`;return e}),[t,o]),appName:o}};var g,h=o(15443);o(58651);!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(g||(g={}));function b(e,t){if(!1===e||null==e)throw new Error(t)}var x;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(x||(x={}));new Set(["lazy","caseSensitive","path","id","index","children"]);Error;const v=["post","put","patch","delete"],y=(new Set(v),["get",...v]);new Set(y),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");o(58651);const w=r.createContext(null);function k(){return null!=r.useContext(w)}function S(){return k()||b(!1),r.useContext(w).location}r.Component;n.startTransition;new Promise((()=>{}));r.Component;var B=o(94474),N=o(39641),C=o(86226),E=o(67204),z=o(82695),L=o(24060),I=o(35784),T=o(47535),A=o(60964),D=o(53400),j=o(52096),R=o(74116),F=o(69602),P=o(37489),q=o(26068);var M=o(60628),W=o(86303),_=o(72540),V=o(24039);const O=(0,j.A)(R.QGx,R.IOl),H=(0,j.A)(R.XR1,R.FnI),X=(0,j.A)(F.rp8,F.Jtj),$=(e,t)=>{const{appearance:o="inline",characterCount:a,characterCountVisibilityThreshold:n=.1,characterLimitErrorMessage:i="Character limit exceeded",className:l,disabled:s=!1,maxLength:d=500,fluid:c=!0,style:p,onSubmit:u,onChange:m,listbox:f,isInSelectionMode:g,dismissable:h=!1,divider:b,onLineModeChange:x,trapFocus:v=!0,messageBar:y,hideSendWhenEmpty:w=!1,onDefaultValueSet:k,...S}=e,A=(0,_.gY)(e.designVersion),j=r.useRef(null),[R,F]=r.useState(!1),O=r.useRef(""),[H,$]=r.useState(!0),[Y,U]=(0,M.i)({state:a,initialState:O.current.length}),{announce:J}=(0,q.X)(),Q=Y>d,K=(e=>{const{characterLimitErrorMessage:t,characterCountExceeded:o,errorMessage:a,announce:n}=e,i=r.useRef(null),l=o?{children:t}:void 0,s=N.lq(a,{defaultProps:l,renderByDefault:o,elementType:"span"}),d=(0,E.a)(i,null==s?void 0:s.ref);s&&(s.ref=d);const c=r.useRef(!1),p=r.useRef("");return r.useEffect((()=>{var e,r;const l=null===(r=i.current)||void 0===r||null===(e=r.innerText)||void 0===e?void 0:e.trim();l||(p.current=""),o||(c.current=!1),a||!o||c.current?l&&l!==p.current&&(n(l),p.current=l):(n(t),c.current=!0)}),[n,a,o,t]),s})({announce:J,characterLimitErrorMessage:i,characterCountExceeded:Q,errorMessage:e.errorMessage}),[Z,ee]=(0,M.i)({state:e.lineMode,initialState:"next"===A&&(K||e.attachments)?"multiline":"singleline"}),te=r.useCallback((e=>{ee(e),null==x||x({lineMode:e})}),[x,ee]),oe=e.disableSend||s||Q,ae=!!e.attachments,re=!!K,ne=r.useCallback((e=>{if("next"!==A||!ae&&!re){if(j.current){j.current.clientWidth<j.current.scrollWidth||e.includes("\n")?te("multiline"):""===e.trim()&&te("singleline")}}else te("multiline")}),[A,re,ae,te]);r.useEffect((()=>{"next"===A&&ne(O.current)}),[A,ne]);const ie=r.useCallback((e=>{ne(e),O.current=e,$(""===e.trim()),U(e.length)}),[U,ne]),le=r.useCallback(((e,t)=>{null==m||m({},t),ie(t.value)}),[m,ie]),se=N.Gk(e.editor,{defaultProps:{...S,onChange:le,onDefaultValueSet:(0,C.p)(ie,k),disabled:s},elementType:D.m});se.ref=(0,E.a)(t,j);const de=(0,z.V)({tabBehavior:"limited-trap-focus"});const ce=(e.showCount||(d-Y)/d<=n)&&"multiline"===Z?N.lq(e.count,{defaultProps:{children:`${Y} / ${d}`},elementType:"span",renderByDefault:!0}):void 0,pe=N.Gk(e.root,{defaultProps:{...v?de:{},className:l,style:p},elementType:"div"}),ue=N.lq(e.send,{defaultProps:G(A,oe),elementType:V.J,renderByDefault:!w||!H}),me={appearance:o,designVersion:A,disabled:s,fluid:c,divider:b,hasEditorFocus:R,lineMode:Z,listbox:f,components:{root:"div",inputWrapper:"div",editor:D.m,actions:"span",count:"span",send:V.J,dismiss:L.$,attachments:"span",media:"span",errorMessage:"span",errorMessageIcon:"span",messageBar:I.n,status:"div",contentBefore:"span"},editor:se,root:pe,inputWrapper:N.Gk(e.inputWrapper,{elementType:"div"}),attachments:N.lq(e.attachments,{elementType:"span"}),count:ce,media:N.lq(e.media,{elementType:"span"}),actions:N.Gk(e.actions,{elementType:"span"}),send:ue,dismiss:N.lq(e.dismiss,{defaultProps:{appearance:"transparent",icon:r.createElement(X,null),type:"dismiss"},elementType:L.$,renderByDefault:h}),errorMessage:K,errorMessageIcon:N.lq(e.errorMessageIcon,{defaultProps:{children:r.createElement(P.uJ2,null)},renderByDefault:!!K,elementType:"span"}),messageBar:N.lq(e.messageBar,{elementType:I.n,defaultProps:{layout:"auto"}}),status:N.lq(e.status,{elementType:"div",renderByDefault:void 0!==K||void 0!==ce}),contentBefore:N.lq(e.contentBefore,{elementType:"span"})},{onFocus:fe,onBlur:ge}=me.editor;me.editor.onFocus=(0,C.p)(fe,(()=>{F(!0)})),me.editor.onBlur=(0,C.p)(ge,(()=>{F(!1)}));const he=r.useRef(!1),be=r.useRef(null);me.editor.editorRef=(0,E.a)(be,me.editor.editorRef),r.useEffect((()=>{var e;return null===(e=be.current)||void 0===e?void 0:e.registerCommand(W.KEY_ENTER_COMMAND,(()=>(he.current=!0,!1)),W.COMMAND_PRIORITY_CRITICAL)}),[]);const{onKeyDown:xe}=me.editor;me.editor.onKeyDown=(0,T.D)((0,C.p)(xe,(e=>{const{key:t,shiftKey:o}=e;!he.current||e.isPropagationStopped()||e.nativeEvent.isComposing||g||oe||o||t!==B.xyI||(null==u||u(e,{value:O.current}),e.preventDefault()),he.current=!1})));const{onClick:ve}=me.send||{},ye=(0,T.D)((0,C.p)(ve,(e=>{oe&&e.preventDefault(),null==u||u(e,{value:O.current})})));return me.send&&(me.send.onClick=ye),me};function G(e,t){const{dir:o}=(0,A.Y)(),a="next"===e?void 0:"ltr"===o?r.createElement(O,null):r.createElement(H,null);return"next"===e?{disabled:t,disabledFocusable:!!t||void 0,sendIcon:a,"aria-label":"Send"}:{appearance:"transparent",disabled:t,disabledFocusable:!!t||void 0,sendIcon:a,"aria-disabled":!!t||void 0,"aria-label":"Send",type:"submit",tabIndex:t?-1:void 0}}var Y=o(30986),U=o(45078);const J=e=>{const{lineMode:t}=e;return(0,U.C)(e),(0,Y.FD)(e.root,{children:[(0,Y.FD)(e.inputWrapper,{children:[e.media&&(0,Y.Y)(e.media,{}),(0,Y.Y)(e.editor,{}),e.listbox,e.count&&(0,Y.Y)(e.count,{}),(0,Y.FD)(e.actions,{children:[e.actions.children,("multiline"===t||!e.dismiss)&&e.divider,e.send&&(0,Y.Y)(e.send,{}),"singleline"===t&&e.dismiss&&e.divider,"singleline"===t&&e.dismiss&&(0,Y.Y)(e.dismiss,{})]}),e.attachments&&(0,Y.Y)(e.attachments,{}),"multiline"===t&&e.dismiss&&(0,Y.Y)(e.dismiss,{}),e.errorMessage&&(0,Y.FD)(e.errorMessage,{children:[e.errorMessageIcon&&(0,Y.Y)(e.errorMessageIcon,{}),e.errorMessage.children]})]}),e.messageBar&&(0,Y.Y)(e.messageBar,{})]})},Q=e=>{const{lineMode:t}=e;return(0,U.C)(e),(0,Y.FD)(e.root,{children:[(0,Y.FD)(e.inputWrapper,{children:[(0,Y.Y)(e.editor,{}),e.status&&(0,Y.FD)(e.status,{children:[e.count&&(0,Y.Y)(e.count,{}),e.errorMessage&&(0,Y.FD)(e.errorMessage,{children:[e.errorMessageIcon&&(0,Y.Y)(e.errorMessageIcon,{}),e.errorMessage.children]}),e.status.children]}),e.contentBefore&&(0,Y.Y)(e.contentBefore,{}),e.listbox,e.attachments&&(0,Y.Y)(e.attachments,{}),(0,Y.FD)(e.actions,{children:[e.actions.children,e.send&&(0,Y.Y)(e.send,{}),"singleline"===t&&e.dismiss&&e.send&&e.divider,"singleline"===t&&e.dismiss&&(0,Y.Y)(e.dismiss,{})]}),"multiline"===t&&e.dismiss&&(0,Y.Y)(e.dismiss,{})]}),e.messageBar&&(0,Y.Y)(e.messageBar,{})]})};var K=o(45983),Z=o(90539),ee=o(86092);const te="fai-PromptInput",oe="fai-PromptInput__inputWrapper",ae="fai-PromptInput__editor",re="fai-PromptInput__actions",ne="fai-PromptInput__count",ie="fai-PromptInput__send",le="fai-PromptInput__dismiss",se="fai-PromptInput__attachments",de="fai-PromptInput__media",ce="fai-PromptInput__errorMessage",pe="fai-PromptInput__errorMessageIcon",ue="fai-PromptInput__messageBar",me="fai-PromptInput__status",fe="fai-PromptInput__contentBefore",ge=(0,K.y)("r1y0bpiz",null,[".r1y0bpiz{display:flex;flex-direction:column-reverse;position:relative;}"]),he=(0,K.y)("r11g9bea","ri3qboh",{r:['.r11g9bea{box-sizing:border-box;display:grid;grid-template-areas:"media input actions" "attachments attachments attachments" "error error error";grid-template-columns:max-content 1fr max-content;grid-template-rows:auto auto;column-gap:var(--spacingHorizontalXS);align-items:center;width:100%;border:var(--strokeWidthThin) solid var(--colorNeutralStroke1);border-radius:var(--borderRadiusLarge);position:relative;margin:0;padding:var(--spacingVerticalXS) var(--spacingHorizontalMNudge);}',".r11g9bea:focus,.r11g9bea:focus-within{background-color:var(--colorNeutralBackground1);}",'.r11g9bea::after{transform:scaleX(0);box-sizing:border-box;content:"";position:absolute;left:-1px;bottom:-1px;right:-1px;height:var(--borderRadiusLarge);border-bottom-left-radius:var(--borderRadiusLarge);border-bottom-right-radius:var(--borderRadiusLarge);border-bottom:var(--strokeWidthThick) solid var(--colorCompoundBrandStroke);clip-path:inset(calc(100% - var(--strokeWidthThick)) 0 0 0);transition-property:transform;transition-duration:var(--durationUltraFast);transition-delay:var(--curveAccelerateMid);}','.ri3qboh{box-sizing:border-box;display:grid;grid-template-areas:"media input actions" "attachments attachments attachments" "error error error";grid-template-columns:max-content 1fr max-content;grid-template-rows:auto auto;column-gap:var(--spacingHorizontalXS);align-items:center;width:100%;border:var(--strokeWidthThin) solid var(--colorNeutralStroke1);border-radius:var(--borderRadiusLarge);position:relative;margin:0;padding:var(--spacingVerticalXS) var(--spacingHorizontalMNudge);}',".ri3qboh:focus,.ri3qboh:focus-within{background-color:var(--colorNeutralBackground1);}",'.ri3qboh::after{transform:scaleX(0);box-sizing:border-box;content:"";position:absolute;right:-1px;bottom:-1px;left:-1px;height:var(--borderRadiusLarge);border-bottom-right-radius:var(--borderRadiusLarge);border-bottom-left-radius:var(--borderRadiusLarge);border-bottom:var(--strokeWidthThick) solid var(--colorCompoundBrandStroke);clip-path:inset(calc(100% - var(--strokeWidthThick)) 0 0 0);transition-property:transform;transition-duration:var(--durationUltraFast);transition-delay:var(--curveAccelerateMid);}'],s:["@media screen and (prefers-reduced-motion: reduce){.r11g9bea::after{transition-duration:0.01ms;transition-delay:0.01ms;}}","@media screen and (prefers-reduced-motion: reduce){.ri3qboh::after{transition-duration:0.01ms;transition-delay:0.01ms;}}"]}),be=(0,Z.X)({adjustToContentSize:{Bf4jedk:"ftxbdd3",a9b677:"f1acs6jw"}},{d:[".ftxbdd3{min-width:240px;}",".f1acs6jw{width:fit-content;}"]}),xe=(0,Z.X)({root:{zoa1oz:"f8du46m",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f1jxijnj",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1wmopi4",Dlnsje:"f1k17mvf",d9w3h3:["fkmllwf","fqp83s6"],B3778ie:["fqp83s6","fkmllwf"]},elevated:{Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"f88035w"},overflowing:{zoa1oz:"f1uwpau4",Budl1dq:"f17g0uqy"},dismissableOverflowing:{zoa1oz:"fyyj6zv",Budl1dq:"f10xgde3"},messageBar:{Btl43ni:["f13av6d4","f3fg2lr"],B7oj6ja:["f3fg2lr","f13av6d4"]}},{d:['.f8du46m{grid-template-areas:"contentBefore input actions" "attachments attachments attachments" "status status status";}',[".f1jxijnj{border-radius:var(--borderRadius2XL);}",{p:-1}],[".f1wmopi4{padding:var(--spacingVerticalSNudge) var(--spacingHorizontalSNudge);}",{p:-1}],".f1k17mvf::after{height:var(--borderRadius2XL);}",".fkmllwf::after{border-bottom-left-radius:var(--borderRadius2XL);}",".fqp83s6::after{border-bottom-right-radius:var(--borderRadius2XL);}",[".f88035w{border:var(--strokeWidthThin) solid var(--colorTransparentStroke);}",{p:-2}],'.f1uwpau4{grid-template-areas:"input input input" "status status status" "contentBefore attachments actions";}',".f17g0uqy{grid-template-columns:auto 1fr auto;}",'.fyyj6zv{grid-template-areas:"input input input input dismiss" "status status status status ." "contentBefore attachments attachments actions actions";}',".f10xgde3{grid-template-columns:auto 1fr 1fr auto auto;}",".f13av6d4{border-top-left-radius:var(--borderRadiusNone);}",".f3fg2lr{border-top-right-radius:var(--borderRadiusNone);}"]}),ve=(0,Z.X)({overflowing:{zoa1oz:"f1xb1dxl",Budl1dq:"f1787940",a9b677:"fly5x3f"},dismissableOverflowing:{zoa1oz:"f10be46f",Budl1dq:"f10rvxd0",a9b677:"fly5x3f"},inline:{B9xav0g:"f1c1zstj",oetu4i:"f1l4zc64",B9zn80p:"fzjvmt4"},elevated:{icvyot:"f1ern45e",vrafjx:["f1n71otn","f1deefiw"],oivjwe:"f1h8hb77",wvpqe5:["f1deefiw","f1n71otn"],E5pizo:"f1hg901r",Eqx8gd:["f1n6gb5g","f15yvnhg"],By385i5:"fo72kxq",B1piin3:["f15yvnhg","f1n6gb5g"],B1q35kw:"faznu88"},focus:{b1kco5:"f16t1kdf",Ba2ppi3:"fhwpy7i",F2fol1:"f15cmg8x",lck23g:"f491wbe",B1q35kw:"f1jc6hxc",wi16st:"fsrmcvb",ywj3b2:"f1t3k7v9",jgq6uv:"f73i0vf"},disabled:{De3pzq:"f1c21dwh",B4j52fo:"f192inf7",Bekrc4i:["f5tn483","f1ojsxk5"],Bn0qgzm:"f1vxd6vx",ibv6hh:["f1ojsxk5","f5tn483"],icvyot:"fzkkow9",vrafjx:["fcdblym","fjik90z"],oivjwe:"fg706s2",wvpqe5:["fjik90z","fcdblym"],g2u3we:"f1jj8ep1",h3c5rm:["f15xbau","fy0fskl"],B9xav0g:"f4ikngz",zhjwy3:["fy0fskl","f15xbau"],Bcq6wej:"f9dbb4x",Jcjdmf:["f3qs60o","f5u9ap2"],sc4o1m:"fwd1oij",Bosien3:["f5u9ap2","f3qs60o"]}},{d:['.f1xb1dxl{grid-template-areas:"media input input" ". attachments attachments" ". error error" ". count actions";}',".f1787940{grid-template-columns:max-content repeat(2, 1fr);}",".fly5x3f{width:100%;}",'.f10be46f{grid-template-areas:"media input input dismiss" ". attachments attachments attachments" ". error error error" ". count actions actions";}',".f10rvxd0{grid-template-columns:max-content 1fr max-content max-content;}",".f1c1zstj{border-bottom-color:var(--colorNeutralStrokeAccessible);}",".f1ern45e{border-top-style:none;}",".f1n71otn{border-right-style:none;}",".f1deefiw{border-left-style:none;}",".f1h8hb77{border-bottom-style:none;}",".f1hg901r{box-shadow:var(--shadow16);}",".f1n6gb5g::after{left:0;}",".f15yvnhg::after{right:0;}",".fo72kxq::after{bottom:0;}",".faznu88::after{border-bottom-color:transparent;}",".f16t1kdf::after{transform:scaleX(1);}",".fhwpy7i::after{transition-property:transform;}",".f15cmg8x::after{transition-duration:var(--durationNormal);}",".f491wbe::after{transition-delay:var(--curveDecelerateMid);}",".f1jc6hxc::after{border-bottom-color:var(--colorCompoundBrandStroke);}",".f1c21dwh{background-color:var(--colorTransparentBackground);}",".f192inf7{border-top-width:var(--strokeWidthThin);}",".f5tn483{border-right-width:var(--strokeWidthThin);}",".f1ojsxk5{border-left-width:var(--strokeWidthThin);}",".f1vxd6vx{border-bottom-width:var(--strokeWidthThin);}",".fzkkow9{border-top-style:solid;}",".fcdblym{border-right-style:solid;}",".fjik90z{border-left-style:solid;}",".fg706s2{border-bottom-style:solid;}",".f1jj8ep1{border-top-color:var(--colorNeutralStrokeDisabled);}",".f15xbau{border-right-color:var(--colorNeutralStrokeDisabled);}",".fy0fskl{border-left-color:var(--colorNeutralStrokeDisabled);}",".f4ikngz{border-bottom-color:var(--colorNeutralStrokeDisabled);}"],h:[".f1l4zc64:hover{border-bottom-color:var(--colorNeutralStrokeAccessibleHover);}",".fzjvmt4:hover:active{border-bottom-color:var(--colorNeutralForeground2Pressed);}"],m:[["@media screen and (prefers-reduced-motion: reduce){.fsrmcvb::after{transition-duration:0.01ms;}}",{m:"screen and (prefers-reduced-motion: reduce)"}],["@media screen and (prefers-reduced-motion: reduce){.f1t3k7v9::after{transition-delay:0.01ms;}}",{m:"screen and (prefers-reduced-motion: reduce)"}],["@media (forced-colors: active){.f9dbb4x{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f3qs60o{border-right-color:GrayText;}.f5u9ap2{border-left-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fwd1oij{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}]],a:[".f73i0vf:active::after{border-bottom-color:var(--colorCompoundBrandStrokePressed);}"]}),ye=(0,Z.X)({disabled:{Bceei9c:"fdrzuqr"},editorRoot:{Bw0ie65:0,Br312pm:0,nk6f5a:0,Ijaq50:0,Bq1tomu:"frl7btn"},editorMultiLine:{jrapky:0,Frg6f3:0,t21cq0:0,B6of3ja:0,B74szlk:"f16v1fc5"},input:{Huce71:"fv5qcn6",Biipf1f:"f1bftd5k",Bmxbyg5:"f1sil6mw",B68tc82:"f1p9o1ba",icvyot:"f1ern45e",vrafjx:["f1n71otn","f1deefiw"],oivjwe:"f1h8hb77",wvpqe5:["f1deefiw","f1n71otn"],De3pzq:"f3rmtva",B7ck84d:"f1ewtqcl",oeaueh:"f1s6fcnf"},overflowingInput:{Huce71:"fibxuh5",Biipf1f:"f9ijwd5",Bmxbyg5:"f5zp4f",Bxyxcbc:"fkaqm7j"},placeholderValueSingleLine:{B68tc82:"f1p9o1ba",Bmxbyg5:"f1sil6mw",Huce71:"fz5stix",ygn44y:"f1cmbuwj"}},{d:[".fdrzuqr{cursor:not-allowed;}",[".frl7btn{grid-area:input;}",{p:-1}],[".f16v1fc5{margin:var(--spacingVerticalSNudge) var(--spacingHorizontalNone);}",{p:-1}],".fv5qcn6{white-space:pre;}",".f1bftd5k{word-break:normal;}",".f1sil6mw{overflow-y:hidden;}",".f1p9o1ba{overflow-x:hidden;}",".f1ern45e{border-top-style:none;}",".f1n71otn{border-right-style:none;}",".f1deefiw{border-left-style:none;}",".f1h8hb77{border-bottom-style:none;}",".f3rmtva{background-color:transparent;}",".f1ewtqcl{box-sizing:border-box;}",".f1s6fcnf{outline-style:none;}",".fibxuh5{white-space:pre-wrap;}",".f9ijwd5{word-break:break-word;}",".f5zp4f{overflow-y:auto;}",".fkaqm7j{max-height:240px;}",".fz5stix{white-space:nowrap;}",".f1cmbuwj{text-overflow:ellipsis;}"]}),we=(0,Z.X)({multiline:{uwmqm3:["fk8j09s","fdw0yi8"],Byoj8tv:"f14wxoun",jrapky:"f8l5zjj"}},{d:[".fk8j09s{padding-left:var(--spacingHorizontalSNudge);}",".fdw0yi8{padding-right:var(--spacingHorizontalSNudge);}",".f14wxoun{padding-bottom:var(--spacingVerticalXS);}",".f8l5zjj{margin-bottom:var(--spacingVerticalXS);}"]}),ke=(0,K.y)("r1sdbc9y",null,[".r1sdbc9y{grid-area:count;align-self:center;color:var(--colorNeutralForeground4);font-family:var(--fontFamilyBase);font-size:var(--fontSizeBase100);font-weight:var(--fontWeightRegular);line-height:var(--lineHeightBase100);}"]),Se=(0,Z.X)({disabled:{sj55zd:"f1s2aq7o"},error:{sj55zd:"f1oi9n2k"}},{d:[".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",".f1oi9n2k{color:var(--colorStatusDangerForeground3);}"]}),Be=(0,Z.X)({root:{B7salou:"f1pbl6dw",Bw0ie65:0,Br312pm:0,nk6f5a:0,Ijaq50:0,Bq1tomu:"f1ti1u4n"}},{d:[".f1pbl6dw{font-variant-numeric:tabular-nums;}",[".f1ti1u4n{grid-area:unset;}",{p:-1}]]}),Ne=(0,K.y)("r14og9fd",null,[".r14og9fd{grid-area:media;display:flex;align-self:start;align-items:center;min-width:32px;min-height:32px;}"]),Ce=(0,Z.X)({root:{Bw0ie65:0,Br312pm:0,nk6f5a:0,Ijaq50:0,Bq1tomu:"f1m4f10d",mc9l5x:"f22iagw",Bt984gj:"f122n59",qb2dma:"f9h729m",Brf1p80:"f4d9j23"}},{d:[[".f1m4f10d{grid-area:dismiss;}",{p:-1}],".f22iagw{display:flex;}",".f122n59{align-items:center;}",".f9h729m{align-self:start;}",".f4d9j23{justify-content:center;}"]}),Ee=(0,Z.X)({singleLine:{qb2dma:"f7nlbp4"}},{d:[".f7nlbp4{align-self:center;}"]}),ze=(0,K.y)("rg3sac5",null,[".rg3sac5{grid-area:actions;align-self:start;box-sizing:border-box;display:flex;flex-wrap:wrap;width:100%;justify-content:flex-end;align-content:center;}"]),Le=(0,Z.X)({overflow:{Bdqf98w:"f133pu1g",a9b677:"f1acs6jw"}},{d:[".f133pu1g{justify-self:flex-end;}",".f1acs6jw{width:fit-content;}"]}),Ie=(0,K.y)("r38xe26",null,[".r38xe26{grid-area:attachments;margin-top:calc(var(--spacingVerticalM) - var(--spacingVerticalS));margin-bottom:var(--spacingVerticalXS);}"]),Te=(0,Z.X)({root:{B6of3ja:"f10saiw2",jrapky:"f5i1nj6"}},{d:[".f10saiw2{margin-top:var(--spacingVerticalNone);}",".f5i1nj6{margin-bottom:var(--spacingVerticalNone);}"]}),Ae=(0,K.y)("r1dj6k56",null,[".r1dj6k56{grid-area:error;color:var(--colorStatusDangerForeground3);font-family:var(--fontFamilyBase);font-size:var(--fontSizeBase200);font-weight:var(--fontWeightRegular);line-height:var(--lineHeightBase200);display:flex;align-items:center;column-gap:var(--spacingHorizontalXS);margin-top:calc(var(--spacingVerticalM) - var(--spacingVerticalS));}"]),De=(0,Z.X)({root:{Bahqtrf:"fk6fouc",Be2twd7:"fy9rknc",Bhrd7zp:"figsok6",Bg96gwp:"fwrc4pm",B6of3ja:"fyyinyh",qvkko9:"f19e4em6"}},{d:[".fk6fouc{font-family:var(--fontFamilyBase);}",".fy9rknc{font-size:var(--fontSizeBase200);}",".figsok6{font-weight:var(--fontWeightRegular);}",".fwrc4pm{line-height:var(--lineHeightBase200);}",".fyyinyh{margin-top:unset;}",".f19e4em6{grid-areas:unset;}"]}),je=(0,K.y)("r18biwo",null,[".r18biwo{display:inline-flex;align-items:center;}"]),Re=(0,K.y)("r1cp3cl9","r1r5p9jk",[".r1cp3cl9{grid-area:status;display:flex;flex-direction:row;gap:var(--spacingHorizontalS);height:16px;padding-left:var(--spacingHorizontalSNudge);padding-bottom:calc(var(--spacingVerticalXS) + var(--spacingVerticalSNudge));}",".r1r5p9jk{grid-area:status;display:flex;flex-direction:row;gap:var(--spacingHorizontalS);height:16px;padding-right:var(--spacingHorizontalSNudge);padding-bottom:calc(var(--spacingVerticalXS) + var(--spacingVerticalSNudge));}"]),Fe=(0,K.y)("r1gq3615",null,[".r1gq3615{grid-area:contentBefore;}"]),Pe=(0,Z.X)({root:{Btl43ni:["f1thbe99","fk5w73e"],B7oj6ja:["fk5w73e","f1thbe99"],Beyfa6y:["fyowgf4","fzi6hpg"],Bbmb7ep:["fzi6hpg","fyowgf4"],B9xav0g:0,oivjwe:0,Bn0qgzm:0,Bgfg5da:"f1l3jbsk"}},{d:[".f1thbe99{border-top-left-radius:var(--borderRadius2XL);}",".fk5w73e{border-top-right-radius:var(--borderRadius2XL);}",".fyowgf4{border-bottom-left-radius:var(--borderRadiusNone);}",".fzi6hpg{border-bottom-right-radius:var(--borderRadiusNone);}",[".f1l3jbsk{border-bottom:none;}",{p:-1}]]}),qe=r.forwardRef(((e,t)=>{const o=$(e,t);return(e=>{const{appearance:t,designVersion:o,disabled:a,dismiss:r,hasEditorFocus:n,fluid:i,lineMode:l}=e,s=ge(),d=be();e.root.className=(0,ee.z)(te,s,!i&&"singleline"===l&&d.adjustToContentSize,e.root.className);const c=he(),p=ve(),u=xe();e.inputWrapper.className=(0,ee.z)(oe,c,!a&&("elevated"===t?p.elevated:p.inline),a&&p.disabled,!a&&n&&p.focus,"multiline"===l&&(r?p.dismissableOverflowing:p.overflowing),"next"===o&&u.root,"next"===o&&"elevated"===t&&u.elevated,"next"===o&&"multiline"===l&&(r?u.dismissableOverflowing:u.overflowing),"next"===o&&e.messageBar&&u.messageBar,e.inputWrapper.className);const m=ye(),f=we();e.editor.className=(0,ee.z)(m.editorRoot,"multiline"===l&&m.editorMultiLine,"next"===o&&"multiline"===l&&f.multiline,e.editor.className);const g=ke(),h=Se(),b=Be();e.count&&(e.count.className=(0,ee.z)(ne,g,"next"===o&&b.root,a&&h.disabled,e.errorMessage&&h.error,e.count.className));const x=N.Gk(e.editor.input,{elementType:"span"});if(x.className=(0,ee.z)(ae,m.input,"multiline"===l&&m.overflowingInput,a&&m.disabled,x.className),e.editor.input=x,e.editor.placeholderValue){const t=N.Gk(e.editor.placeholderValue,{elementType:"span"});t.className=(0,ee.z)(ae,"singleline"===l&&m.placeholderValueSingleLine,t.className),e.editor.placeholderValue=t}const v=ze(),y=Le();e.actions&&(e.actions.className=(0,ee.z)(re,v,"multiline"===l&&y.overflow,e.actions.className)),e.send&&(e.send.className=(0,ee.z)(ie,e.send.className));const w=Ae(),k=De();e.errorMessage&&(e.errorMessage.className=(0,ee.z)(ce,w,"next"===o&&k.root,e.errorMessage.className));const S=je();e.errorMessageIcon&&(e.errorMessageIcon.className=(0,ee.z)(pe,S,e.errorMessageIcon.className));const B=Ie(),C=Te();e.attachments&&(e.attachments.className=(0,ee.z)(se,B,"next"===o&&C.root,e.attachments.className));const E=Ne();e.media&&(e.media.className=(0,ee.z)(de,E,e.media.className));const z=Ce(),L=Ee();e.dismiss&&(e.dismiss.className=(0,ee.z)(le,z.root,"next"===o&&"singleline"===l&&L.singleLine,e.dismiss.className));const I=Pe();e.messageBar&&(e.messageBar.className=(0,ee.z)(ue,"next"===o&&I.root,e.messageBar.className));const T=Re();e.status&&(e.status.className=(0,ee.z)(me,T,e.status.className));const A=Fe();e.contentBefore&&(e.contentBefore.className=(0,ee.z)(fe,A,e.contentBefore.className))})(o),(e=>"next"===e.designVersion?Q(e):J(e))(o)}));qe.displayName="PromptInput";var Me=o(99751),We=o(73482),_e=o(80005),Ve=o(86259),Oe=o(51319),He=o(61600),Xe=o(23548);const $e=e=>{const t=(new Date).getTime()-e.getTime(),o=Math.floor(t/6e4),a=Math.floor(o/60),r=Math.floor(a/24);return o<60?`${o} ${o<=1?"minute":"minutes"} ago`:a<24?`${a} ${a<=1?"hour":"hours"} ago`:r<7?`${r} ${r<=1?"day":"days"} ago`:e.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})};var Ge=o(60668),Ye=o(76886),Ue=o(39020),Je=o(1783),Qe=o(78314),Ke=o(20372);const Ze=({cardId:e,menuActions:t=[]})=>{const o="More options";return 0===t.length?null:r.createElement(Ge.W,null,r.createElement(Ye.c,{disableButtonEnhancement:!0},r.createElement(We.m,{content:o,relationship:"label",withArrow:!0},r.createElement(L.$,{appearance:"transparent",icon:r.createElement(Ke.cEI,null),"aria-label":o,onClick:e=>{e.stopPropagation()}}))),r.createElement(Ue.b,null,r.createElement(Je.c,null,t.map((t=>r.createElement(Qe.D,{key:t.id,icon:t.icon,disabled:t.disabled,onClick:o=>{o.stopPropagation(),t.onClick(e)}},t.label))))))};var et=o(80866);const tt=(0,et.n)({cardsGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"20px"},card:{backgroundColor:"white",borderRadius:"8px",overflow:"hidden",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)",transition:"transform 0.2s, box-shadow 0.2s",position:"relative",display:"flex",flexDirection:"column","&:hover":{transform:"translateY(-4px)",boxShadow:"0 0 10px 4px rgba(0, 0, 0, 0.15)"},cursor:"pointer"},cardThumbnail:{width:"100%",height:"160px",backgroundColor:_e.L.colorNeutralBackground4,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"40px",color:_e.L.colorNeutralForeground4,overflow:"hidden",position:"relative"},cardContent:{padding:"16px",flexGrow:1,display:"flex",flexDirection:"column",justifyContent:"space-between"},cardTitle:{fontSize:"16px",fontWeight:500,marginBottom:"12px",marginTop:"0px"},cardFooter:{display:"flex",justifyContent:"space-between",alignItems:"center",borderTop:`1px solid ${_e.L.colorNeutralBackground3}`,paddingTop:"12px"},cardAuthor:{display:"flex",alignItems:"center",gap:"8px",fontSize:"12px",color:_e.L.colorNeutralForeground2},authorAvatar:{width:"24px",height:"24px",borderRadius:"50%",backgroundColor:_e.L.colorBrandBackground,display:"flex",alignItems:"center",justifyContent:"center",color:_e.L.colorNeutralForegroundOnBrand,fontSize:"10px",fontWeight:500},cardPlaceholder:{fontSize:"40px",color:_e.L.colorNeutralForeground3},cardLastEdited:{fontSize:"12px",color:_e.L.colorNeutralForeground2,marginBottom:"14px",display:"block"},appNameOverlay:{position:"absolute",bottom:"8px",left:"8px",backgroundColor:"rgba(0, 0, 0, 0.7)",backdropFilter:"blur(4px)",color:"white",fontSize:"12px",fontWeight:500,padding:"4px 8px",borderRadius:"4px",zIndex:1},thumbnailMenu:{position:"absolute",top:"8px",right:"8px",zIndex:2,backgroundColor:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(4px)",borderRadius:"4px",padding:"2px"}}),ot=({cards:e,strings:t={},showCreatedBy:o=!0,showLastEdited:a=!0,showCardMenu:n=!0,formatDate:i,menuActions:l=[]})=>{const s=tt(),d={lastEdited:t.lastEdited||"Last edited",createdBy:t.createdBy||"Created by AI",thumbnailAlt:t.thumbnailAlt||"File thumbnail"},c=i||$e;return r.createElement("div",{className:s.cardsGrid},e.map(((e,t)=>r.createElement("div",{key:t,className:s.card,role:"button",tabIndex:0,onClick:()=>e.onCardClick?.(e.id),onKeyDown:t=>{"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),e.onCardClick?.(e.id))}},r.createElement("div",{className:s.cardThumbnail},e.backgroundImageUrl?r.createElement(Me._,{src:e.backgroundImageUrl,alt:d.thumbnailAlt,fit:"cover"}):r.createElement("div",{className:s.cardPlaceholder},e.placeholder),e.appName&&r.createElement("div",{className:s.appNameOverlay},e.appName),!o&&n&&l.length>0&&r.createElement("div",{className:s.thumbnailMenu},r.createElement(Ze,{cardId:e.id,menuActions:l}))),r.createElement("div",{className:s.cardContent},r.createElement("h3",{className:s.cardTitle},e.name),a&&r.createElement("span",{className:s.cardLastEdited},d.lastEdited," ",c(new Date(e.lastEdited))),o&&r.createElement("div",{className:s.cardFooter},r.createElement("div",{className:s.cardAuthor},r.createElement("div",{className:s.authorAvatar},e.createdBy),r.createElement("span",null,d.createdBy)),n&&l.length>0&&r.createElement(Ze,{cardId:e.id,menuActions:l})))))))};var at=o(22655),rt=o(84377),nt=o(88300),it=o(84216),lt=o(61162),st=o(74549);const dt=({open:e,title:t,content:o,confirmButtonText:a="Confirm",cancelButtonText:n="Cancel",onOpenChange:i,onConfirm:l,confirmButtonAppearance:s="primary",isDestructive:d=!1})=>r.createElement(at.l,{open:e,onOpenChange:(e,t)=>{i(t.open)}},r.createElement(rt.E,{style:{maxWidth:"400px"}},r.createElement(nt.R,null,r.createElement(it.L,null,t),r.createElement(lt.C,null,o),r.createElement(st.i,null,r.createElement(L.$,{appearance:"secondary",onClick:()=>{i(!1)}},n),r.createElement(L.$,{appearance:s,onClick:()=>{l(),i(!1)},style:d?{color:"white",backgroundColor:"#d13438"}:void 0},a)))));var ct=o(89729),pt=o(20798),ut=o(54918),mt=o(9552),ft=o(47487);const gt=(0,et.n)({homeContainer:{minHeight:"100vh",maxHeight:"100vh",overflow:"hidden",backgroundColor:_e.L.colorNeutralBackground2,display:"flex",flexDirection:"column",gap:"20px"},homeButtons:{fontWeight:_e.L.fontWeightRegular},headerAndBanner:{background:"linear-gradient(115deg, #f97794, #6200ff, #3498db)"},header:{width:"100%",padding:"15px",display:"flex",justifyContent:"space-between",alignItems:"center"},headerActions:{display:"flex",alignItems:"center",gap:"15px"},headerTitle:{fontSize:_e.L.fontSizeBase600,fontWeight:_e.L.fontWeightBold,color:"white"},headerButton:{borderRadius:"50%",backgroundColor:"rgba(255, 255, 255, 0.15)",color:"white",border:"none",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",":hover":{backgroundColor:"rgba(255, 255, 255, 0.3)",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",color:"white"},":hover:active":{backgroundColor:"rgba(255, 255, 255, 0.3)",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",color:"white"}},profile:{width:"32px",height:"32px",borderRadius:"50%",backgroundColor:"rgba(255, 255, 255, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:_e.L.fontWeightBold,cursor:"pointer",color:_e.L.colorBrandForegroundInverted,":hover":{backgroundColor:"rgba(255, 255, 255)",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)"},":hover:active":{backgroundColor:"rgba(255, 255, 255)",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)"}},mainContainer:{paddingTop:0,paddingBottom:"50px",paddingRight:"10vw",paddingLeft:"10vw",overflowY:"auto",display:"flex",flexDirection:"column",gap:"16px",scrollbarColor:`${_e.L.colorNeutralBackground3} transparent`,"&::-webkit-scrollbar":{backgroundColor:_e.L.colorNeutralBackground3},"&::-webkit-scrollbar-thumb":{backgroundColor:_e.L.colorNeutralBackground3}},banner:{borderRadius:"10px",width:"calc(100% - 40px)",height:"200px",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",padding:"0 20px 20px",position:"relative",overflow:"hidden"},bannerTitle:{fontSize:_e.L.fontSizeHero800,fontWeight:_e.L.fontWeightBold,color:"white",marginBottom:"35px"},sparkleTopLeft:{position:"absolute",top:"15px",left:"20px",color:"rgba(255, 255, 255, 0.8)",fontSize:_e.L.fontSizeHero700},sparkleTopRight:{position:"absolute",top:"25px",right:"30px",color:"rgba(255, 255, 255, 0.8)",fontSize:_e.L.fontSizeBase500},sparkleBottomLeft:{position:"absolute",bottom:"20px",left:"40px",color:"rgba(255, 255, 255, 0.8)",fontSize:_e.L.fontSizeHero700},sparkleBottomRight:{position:"absolute",bottom:"30px",right:"40px",color:"rgba(255, 255, 255, 0.8)",fontSize:_e.L.fontSizeBase500},sparkleInline:{marginLeft:"10px",color:"rgba(255, 255, 255, 0.9)",fontSize:_e.L.fontSizeBase500,verticalAlign:"text-top"},mainContainerInputBox:{width:"80%",maxWidth:"800px",borderRadius:"8px",backgroundColor:_e.L.colorNeutralBackground1,textAlign:"left"},mainContainerSubtitle:{fontSize:_e.L.fontSizeBase500,margin:0,display:"flex",alignItems:"center"},toggleButtonGroup:{borderRadius:"8px",display:"flex",overflow:"hidden",border:`1px solid ${_e.L.colorNeutralStroke1}`},toggleButton:{display:"flex",alignItems:"center",justifyContent:"center",paddingLeft:"7px",paddingRight:"7px",cursor:"pointer"},mainContainerHeader:{display:"flex",justifyContent:"space-between"},mainContainerActions:{display:"flex",gap:"10px"},mainContainerContent:{display:"flex",flexDirection:"column"},settingsPopoverSurface:{padding:"0px",top:"5px !important",maxWidth:"350px"}}),ht=({showProfile:e=!0,settingsMenu:t,profileContent:o="AI",strings:a={},onProfileClick:n})=>{const i=gt(),l={settings:a.settings||"Settings",profile:a.profile||"Profile",title:a.title||"AI Application"};return r.createElement(ct.M,null,r.createElement("div",{className:i.header},r.createElement("span",{className:i.headerTitle},l.title),r.createElement("div",{className:i.headerActions},r.createElement(pt.A,{positioning:{position:"below"}},r.createElement(ut.W,null,r.createElement(We.m,{content:l.settings,relationship:"label",withArrow:!0},r.createElement(L.$,{icon:r.createElement(ft.mJc,null),appearance:"outline",shape:"circular",className:(0,ee.z)(i.homeButtons,i.headerButton),disabled:!t}))),r.createElement(mt.H,{className:i.settingsPopoverSurface},t&&r.createElement(t,null))),e&&r.createElement(We.m,{content:l.profile,relationship:"label",withArrow:!0},r.createElement("div",{className:i.profile,role:"button",tabIndex:0,onClick:n,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),n?.())}},"string"==typeof o?o:r.createElement(o))))))},bt=({strings:e={},onCreateNew:t,onSubmit:o,onDeleteAll:a,cardsGridProps:n,headerProps:i={}})=>{const l=gt(),[s,d]=(0,r.useState)("grid"),[c,p]=(0,r.useState)(!1),u={pageTitle:e.pageTitle||"Your App Title",inputBoxPlaceholder:e.inputBoxPlaceholder||"Enter your prompt here...",myFiles:e.myFiles||"My App Files",createNew:e.createNew||"Create New",deleteAll:e.deleteAll||"Delete All",createNewTooltip:e.createNewTooltip||"Create a new app file",deleteAllTooltip:e.deleteAllTooltip||"Delete all app files",gridViewTooltip:e.gridViewTooltip||"Grid view",listViewTooltip:e.listViewTooltip||"List view",deleteConfirmationTitle:e.deleteConfirmationTitle||"Delete All Files",deleteConfirmationContent:e.deleteConfirmationContent||"Are you sure you want to delete all files? This action cannot be undone.",deleteConfirmationButton:e.deleteConfirmationButton||"Delete All"},m={...n,cards:n?.cards?.map((e=>({...e,placeholder:e.placeholder||e.name.charAt(0),createdBy:e.createdBy||"AI"})))||[]},f=r.createElement(Me._,{alt:"Copilot",height:24,src:"https://res-2-sdf.cdn.office.net/files/fabric-cdn-prod_20240411.001/assets/brand-icons/product/svg/copilot_24x1.svg",width:24});return r.createElement("div",{className:l.homeContainer},r.createElement("div",{className:l.headerAndBanner},r.createElement(ht,{...i}),r.createElement("div",{className:l.banner},r.createElement(Ve.hw3,{className:l.sparkleTopLeft}),r.createElement(Ve.hw3,{className:l.sparkleTopRight}),r.createElement("div",{className:l.bannerTitle},u.pageTitle,r.createElement(Ve.hw3,{className:l.sparkleInline})),r.createElement(qe,{media:f,appearance:"elevated","aria-label":"Copilot Chat",placeholderValue:u.inputBoxPlaceholder,onSubmit:(e,t)=>o?.(t.value),className:l.mainContainerInputBox,hideSendWhenEmpty:!0}),r.createElement(Ve.hw3,{className:l.sparkleBottomLeft}),r.createElement(Ve.hw3,{className:l.sparkleBottomRight}))),r.createElement("div",{className:l.mainContainer},r.createElement("div",{className:l.mainContainerHeader},r.createElement("div",{className:l.mainContainerSubtitle},u.myFiles),r.createElement("div",{className:l.mainContainerActions},r.createElement(We.m,{content:u.createNewTooltip,relationship:"label",withArrow:!0},r.createElement(L.$,{shape:"circular",appearance:"primary",icon:r.createElement(Oe.on3,null),onClick:()=>t(),className:l.homeButtons},u.createNew)),r.createElement(We.m,{content:u.deleteAllTooltip,relationship:"label",withArrow:!0},r.createElement(L.$,{shape:"circular",icon:r.createElement(He.Sz$,null),onClick:()=>p(!0),disabled:0===m.cards.length,className:l.homeButtons},u.deleteAll)),r.createElement(dt,{open:c,title:u.deleteConfirmationTitle,content:u.deleteConfirmationContent,confirmButtonText:u.deleteConfirmationButton,onOpenChange:p,onConfirm:a,isDestructive:!0}),r.createElement("div",{className:l.toggleButtonGroup},r.createElement(We.m,{content:u.gridViewTooltip,relationship:"label",withArrow:!0},r.createElement(L.$,{className:l.toggleButton,style:{backgroundColor:"grid"===s?_e.L.colorNeutralBackground6:_e.L.colorNeutralBackground1},onClick:()=>d("grid"),icon:r.createElement(Xe.fvM,null),appearance:"subtle","aria-label":"Grid view"})),r.createElement(We.m,{content:u.listViewTooltip,relationship:"label",withArrow:!0},r.createElement(L.$,{className:l.toggleButton,style:{backgroundColor:"list"===s?_e.L.colorNeutralBackground6:_e.L.colorNeutralBackground1},onClick:()=>d("list"),icon:r.createElement(R.BWq,null),appearance:"subtle","aria-label":"List view"}))))),r.createElement("div",{className:l.mainContainerContent},r.createElement(ot,{...m}))))};var xt=o(58651);const vt=({initialQueryRef:e,copilotFeatureFlags:t})=>{const{updateCurrentlySelectedNotebookId:o,addAndOpenNewNotebook:n,localStorageData:i,removeNotebook:l,removeAllNotebooks:s}=(0,d.p)(),{generateAppName:c}=f(t?.shouldStoreResearchDataInIndexDB??!1),p=()=>{xt.log("Create new notebook");const e={notebookId:"Research"+Date.now(),notebookName:c(),notesData:[],sourceFiles:[],lastEdited:new Date};n(e)},u=e=>{xt.log("Delete notebook with id:",e),l(e)},m=e=>{xt.log("Card clicked with id:",e),o(e)},g={strings:a.kt,onCreateNew:p,onSubmit:t=>{""!==t.trim()?(xt.log("Submit event:",t),e.current=t,p()):xt.log("Input is empty, not submitting.")},cardsGridProps:{cards:i.map((e=>({id:e.notebookId,name:e.notebookName,isFavorite:!1,placeholder:e.notebookName.charAt(0),createdBy:"AI",lastEdited:new Date(e.lastEdited),onCardClick:m,onDeleteNotebook:u}))),menuActions:[{id:"delete",label:"Delete",icon:r.createElement(He.y7H,null),onClick:u}],showCreatedBy:!0,showLastEdited:!0,showCardMenu:!0},onDeleteAll:()=>{s()},generateAppName:c,headerProps:{showProfile:!0,profileContent:"AI",strings:{title:a.Xx,settings:"Settings",profile:"Profile"},onProfileClick:()=>xt.log("Profile clicked")}};return r.createElement(bt,{...g})};var yt=o(58651);const wt=r.lazy((()=>Promise.all([o.e(2639),o.e(2024),o.e(7212),o.e(8792),o.e(5047),o.e(5455)]).then(o.bind(o,85455)).then((e=>({default:e.Research}))))),kt=({getALSession:e,theme:t,isTestApp:o,copilotFeatureFlags:a,entityPickerPropsValue:n})=>{const[c,p]=r.useState(void 0),{initialDataLoaded:u,currentlySelectedNotebookId:m,addAndOpenNewNotebook:g,updateCurrentlySelectedNotebookId:b}=(0,d.p)(),x=S();r.useEffect((()=>{c||(async()=>{yt.log("Fetching AL session...");const t=await e();yt.log("AL session fetched:",t),p(t)})()}),[c,e]);const{generateAppName:v}=f(a?.shouldStoreResearchDataInIndexDB??!1),[y,w]=r.useState(!(u&&!n)),k=r.useRef(""),B=(0,h.pZ)();r.useEffect((()=>{if(u){const e=x?.state;if(e?.openFileId)yt.log("Setting currently selected notebook ID from location state:",e.openFileId),b(e.openFileId);else if(n){w(!0);const e={notebookId:"Research"+Date.now(),notebookName:v(),notesData:[],sourceFiles:n.list,lastEdited:new Date};g(e)}w(!1)}}),[u]);const N=r.useCallback((()=>{yt.log("Closing AL session..."),c?.close(),p(void 0)}),[c]);return r.createElement(i.L,{theme:t},r.createElement(s.j,{initialFeatureFlags:a},!u||y?r.createElement(l.y,{labelPosition:"below",label:"Loading Research Data...",className:B.spinnerContainer}):""!==m?c&&c.isConnected?r.createElement(r.Suspense,{fallback:r.createElement(l.y,{label:"Loading Research...",className:B.spinnerContainer})},r.createElement(wt,{key:m,alSession:c,onSessionClose:N,theme:t,isTestApp:o,initialQueryRef:k})):r.createElement(l.y,{labelPosition:"below",label:"Initializing Session...",className:B.spinnerContainer}):r.createElement(vt,{initialQueryRef:k,copilotFeatureFlags:a})))},St=({getALSession:e,theme:t,isTestApp:o,copilotFeatureFlags:a,entityPickerPropsValue:n})=>{const i=m(a?.shouldStoreResearchDataInIndexDB??!1);return r.createElement(d.O.Provider,{value:i},r.createElement(kt,{getALSession:e,theme:t,isTestApp:o,copilotFeatureFlags:a,entityPickerPropsValue:n}))}},78402:(e,t,o)=>{o.d(t,{O:()=>i,p:()=>l});var a=o(8520);const r=()=>{},n={initialDataLoaded:!1,localStorageData:[],currentlySelectedNotebookId:"",updateCurrentlySelectedNotebookId:r,changeNotebookName:r,addNoteFromLocalStorage:r,removeNoteFromLocalStorage:r,removeAllNotesFromLocalStorage:r,removeNotebook:r,removeAllNotebooks:r,addNewNotebook:r,addAndOpenNewNotebook:r,updateSourceFiles:r,updateNoteFromLocalStorage:r,getAllNotebooks:()=>[]},i=a.createContext(n),l=()=>a.useContext(i)},89729:(e,t,o)=>{o.d(t,{M:()=>x});var a=o(8520),r=o(39641),n=o(33912),i=o(47535),l=o(60628),s=o(546);const d=e=>{const[t,o]=(0,l.i)({state:e.checkedValues,defaultState:e.defaultCheckedValues,initialState:{}}),{onCheckedValueChange:a}=e;return[t,(0,i.D)(((e,{name:t,checkedItems:r})=>{a&&a(e,{name:t,checkedItems:r}),o((e=>e?{...e,[t]:r}:{[t]:r}))}))]};var c=o(30986),p=o(45078),u=o(47809);var m=o(90539),f=o(86092);const g="fui-Toolbar",h=(0,m.X)({root:{mc9l5x:"f22iagw",Bt984gj:"f122n59",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1yqiaad"},vertical:{Beiy3e4:"f1vx9l62",a9b677:"f1acs6jw"},small:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fvz760z"},medium:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1yqiaad"},large:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1ms6bdn"}},{d:[".f22iagw{display:flex;}",".f122n59{align-items:center;}",[".f1yqiaad{padding:4px 8px;}",{p:-1}],".f1vx9l62{flex-direction:column;}",".f1acs6jw{width:fit-content;}",[".fvz760z{padding:0px 4px;}",{p:-1}],[".f1yqiaad{padding:4px 8px;}",{p:-1}],[".f1ms6bdn{padding:4px 20px;}",{p:-1}]]});var b=o(4704);const x=a.forwardRef(((e,t)=>{const o=((e,t)=>{const{size:o="medium",vertical:a=!1}=e,l=(0,s.i)({circular:!0,axis:"both"}),c={size:o,vertical:a,components:{root:"div"},root:r.Gk((0,n.g)("div",{role:"toolbar",ref:t,...a&&{"aria-orientation":"vertical"},...l,...e}),{elementType:"div"})},[p,u]=d({checkedValues:e.checkedValues,defaultCheckedValues:e.defaultCheckedValues,onCheckedValueChange:e.onCheckedValueChange});return{...c,handleToggleButton:(0,i.D)(((e,t,o,a)=>{if(t&&o){const r=[...(null==p?void 0:p[t])||[]];a?r.splice(r.indexOf(o),1):r.push(o),null==u||u(e,{name:t,checkedItems:r})}})),handleRadio:(0,i.D)(((e,t,o,a)=>{t&&o&&(null==u||u(e,{name:t,checkedItems:[o]}))})),checkedValues:null!=p?p:{}}})(e,t),a=function(e){const{size:t,handleToggleButton:o,vertical:a,checkedValues:r,handleRadio:n}=e;return{toolbar:{size:t,vertical:a,handleToggleButton:o,handleRadio:n,checkedValues:r}}}(o);return(e=>{const t=h(),{vertical:o,size:a}=e;e.root.className=(0,f.z)(g,t.root,o&&t.vertical,"small"===a&&!o&&t.small,"medium"===a&&!o&&t.medium,"large"===a&&!o&&t.large,e.root.className)})(o),(0,b.$e)("useToolbarStyles_unstable")(o),((e,t)=>((0,p.C)(e),(0,c.Y)(u.P.Provider,{value:t.toolbar,children:(0,c.Y)(e.root,{children:e.root.children})})))(o,a)}));x.displayName="Toolbar"},96010:(e,t,o)=>{o.d(t,{h:()=>l,j:()=>i});var a=o(8520);const r={enableSydneyDAForResearch:!1,enableAdvancedResearch:!1},n=(0,a.createContext)({featureFlags:r,setFeatureFlags:()=>{}}),i=({children:e,initialFeatureFlags:t=r})=>{const[o,i]=(0,a.useState)(t);return a.createElement(n.Provider,{value:{featureFlags:o,setFeatureFlags:i}},e)},l=()=>{const e=(0,a.useContext)(n);if(void 0===e)throw new Error("useFeatureFlags must be used within a FeatureFlagsProvider");return e}}}]);
//# sourceMappingURL=researchnotebook.js.map